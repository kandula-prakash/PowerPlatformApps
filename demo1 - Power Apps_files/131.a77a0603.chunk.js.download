(window.webpackJsonp=window.webpackJsonp||[]).push([[131],{5769:function(e,t,o){"use strict";o.r(t),o.d(t,"getResponseError",(function(){return n})),o.d(t,"hasResponseError",(function(){return s})),o.d(t,"getResponseErrorMessage",(function(){return i})),o.d(t,"getResponseErrorCode",(function(){return l}));var r=o(2812),a=o(5696),n=e=>{return"string"!=typeof e&&e?(t=e.error)?t:(t=Object(r.get)(e,"response.data.error")||Object(r.get)(e,'response.data["odata.error"]'))||void 0:e;var t},s=e=>!!n(e),i=e=>{if(!e)return"";var t=n(e);if("string"==typeof t)return t;var o=Object(a.extractErrorMessage)(t||e);return o||JSON.stringify(t||e)},l=e=>{if("string"==typeof e||!e)return e;var t=e.code||e.status;return t||(t=e.error&&(e.error.code||e.error.status)),t||(t=e.response&&(e.response.code||e.response.status)),JSON.stringify(t||e.error||e)}},8009:function(e,t,o){"use strict";o.r(t),o.d(t,"SolutionHistoryDetails",(function(){return H}));var r=o(687),a=o(719),n=o(245),s=o.n(n),i=o(922),l=o(2882),c=o(5492),d=o(2879),u=o(5583),m=o(5623),p=o(8010),y=o(8011),g=o(5481),b=o(1090),S=o(5601),f=o(1837),h=Object(a.mergeStyleSets)({root:{fontSize:"14px",lineHeight:"20px"},content:{padding:"9px 0"},heading:{color:l.fabricColors.neutralTuatara,fontFamily:c.fonts.segoeUiSemibold},subtext:{color:l.fabricColors.neutralChicago,fontFamily:c.fonts.segoeUi,paddingTop:"5px",wordWrap:"break-word"},errorCode:{color:l.fabricColors.plum,fontFamily:c.fonts.segoeUi,paddingTop:"5px",wordWrap:"break-word"}}),v=(e,t,o,r)=>{var a=t("Model.Solutions.HistoryPage.yes"),n=t("Model.Solutions.HistoryPage.no");return s.a.createElement("div",{className:h.root},s.a.createElement("div",{className:h.content},s.a.createElement("div",{className:h.heading},t("Model.Solutions.HistoryPage.errorCode")),s.a.createElement("div",{className:e.errorCode&&"0"!==e.errorCode?h.errorCode:h.subtext},e.errorCode&&"0"!==e.errorCode?s.a.createElement(b.Link,{href:g.default.getSolutionHistoryErrorCodeLink(e.errorCode),target:"_blank"},e.errorCode):"-")),s.a.createElement("div",{className:h.content},s.a.createElement("div",{className:h.heading},t("Model.Solutions.HistoryPage.exceptionMessage")),s.a.createElement("div",{className:h.subtext},e.exceptionMessage?((e,t,o,r)=>!o&&e.length>100?s.a.createElement(s.a.Fragment,null,s.a.createElement(f.Text,null,"".concat(e.substring(0,100),"...")),s.a.createElement("p",null,s.a.createElement(b.Link,{onClick:()=>r(!0)},t("Model.Solutions.HistoryPage.seeMore")))):s.a.createElement(s.a.Fragment,null,e,e.length>100&&s.a.createElement("p",null,s.a.createElement(b.Link,{onClick:()=>r(!1)},t("Model.Solutions.HistoryPage.seeLess")))))(e.exceptionMessage,t,o,r):"-")),s.a.createElement("div",{className:h.content},s.a.createElement("div",{className:h.heading},t("Model.Solutions.HistoryPage.totalOperationTime")),s.a.createElement("div",{className:h.subtext},Object(S.getFriendlyExactDurationString)(e.totalTime))),s.a.createElement("div",{className:h.content},s.a.createElement("div",{className:h.heading},t("Model.Solutions.HistoryPage.patch")),s.a.createElement("div",{className:h.subtext},e.isPatch?a:n)),s.a.createElement("div",{className:h.content},s.a.createElement("div",{className:h.heading},t("Model.Solutions.HistoryPage.managed")),s.a.createElement("div",{className:h.subtext},e.isManaged?a:n)),s.a.createElement("div",{className:h.content},s.a.createElement("div",{className:h.heading},t("Model.Solutions.HistoryPage.overwriteCustomizations")),s.a.createElement("div",{className:h.subtext},e.isOverWriteCustomizations?a:n)),s.a.createElement("div",{className:h.content},s.a.createElement("div",{className:h.heading},t("Model.Solutions.HistoryPage.activityId")),s.a.createElement("div",{className:h.subtext},e.activityId)))},H=Object(i.translateService)("PowerappsPortal")(e=>{var{selectedItem:t,t:o}=e,[a,i]=Object(n.useState)(!1),{navigate:c}=Object(n.useContext)(u.NavigationContext),g=e=>{c(Object(m.getSolutionComponentsUrlForMode)(e),!0)};return Object(n.useEffect)(()=>{i(!1)},[t]),s.a.createElement("div",{className:"inner-accordion"},s.a.createElement(p.DetailsAccordion,{isHiddenOnDismiss:!0,className:"details-accordion",text:o("Model.Solutions.HistoryPage.details"),onRenderContent:()=>((e,t,o,a)=>{var n=e.result?d.fabricIcons.CompletedSolid:d.fabricIcons.StatusErrorFull;return s.a.createElement("div",{className:h.root},s.a.createElement("div",{className:h.content},s.a.createElement("div",{className:h.heading},t("Model.SolutionsHistory.List.Header.name")),s.a.createElement("div",{className:h.subtext},e.isNavigatable?s.a.createElement(b.Link,{onClick:()=>{a(e.solutionId)}},e.name):s.a.createElement("span",null,e.name))),s.a.createElement("div",{className:h.content},s.a.createElement("div",{className:h.heading},t("Model.SolutionsHistory.List.Header.startTime")),s.a.createElement("div",{className:h.subtext},Object(y.getFormatSolutionDateTimeString)(e.startTime,o))),s.a.createElement("div",{className:h.content},s.a.createElement("div",{className:h.heading},t("Model.SolutionsHistory.List.Header.endTime")),s.a.createElement("div",{className:h.subtext},Object(y.getFormatSolutionDateTimeString)(e.endTime,o))),s.a.createElement("div",{className:h.content},s.a.createElement("div",{className:h.heading},t("Model.SolutionsHistory.List.Header.version")),s.a.createElement("div",{className:h.subtext},e.version)),s.a.createElement("div",{className:h.content},s.a.createElement("div",{className:h.heading},t("Model.SolutionsHistory.List.Header.publisherName")),s.a.createElement("div",{className:h.subtext},e.publisherName)),s.a.createElement("div",{className:h.content},s.a.createElement("div",{className:h.heading},t("Model.SolutionsHistory.List.Header.operation")),s.a.createElement("div",{className:h.subtext},Object(y.getSolutionOperationStatus)(e.operation,t))),s.a.createElement("div",{className:h.content},s.a.createElement("div",{className:h.heading},t("Model.SolutionsHistory.List.Header.subOperation")),s.a.createElement("div",{className:h.subtext},Object(y.getSolutionSubOperationStatus)(e.subOperation,t))),s.a.createElement("div",{className:h.content},s.a.createElement("div",{className:h.heading},t("Model.SolutionsHistory.List.Header.result")),null!==e.result&&s.a.createElement("div",{className:h.subtext},s.a.createElement("span",null,s.a.createElement(r.Icon,{iconName:n,styles:{root:{color:e.result?l.fabricColors.bilbao:l.fabricColors.brightRed,marginRight:"4px"}}})),s.a.createElement("span",null,e.result?t("Model.SolutionsHistory.Result.success"):t("Model.SolutionsHistory.Result.failure")))))})(t,o,e.localeLanguage,g)}),s.a.createElement(p.DetailsAccordion,{isHiddenOnDismiss:!0,className:"more-details-accordion",text:o("Model.Solutions.HistoryPage.moreDetails"),onRenderContent:()=>v(t,o,a,i),checked:!0}))})},8010:function(e,t,o){"use strict";o.r(t),o.d(t,"DetailsAccordion",(function(){return y}));var r=o(545),a=o(719),n=o(245),s=o(2846),i=o(2882),l=o(5492),c=["className","text","onRenderContent","onOpen","onClose"];function d(){return(d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r])}return e}).apply(this,arguments)}function u(e,t){if(null==e)return{};var o,r,a=function(e,t){if(null==e)return{};var o,r,a={},n=Object.keys(e);for(r=0;r<n.length;r++)o=n[r],t.indexOf(o)>=0||(a[o]=e[o]);return a}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(r=0;r<n.length;r++)o=n[r],t.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}var m={root:{cursor:"pointer",minHeight:"52px",fontFamily:l.fonts.segoeUi,selectors:{"&.ba-Accordion-header":{paddingLeft:"0px",fontSize:"16px",lineHeight:"22px",fontFamily:l.fonts.segoeUiSemibold,color:i.fabricColors.neutralTuatara,backgroundColor:i.fabricColors.white},"&.ba-Accordion-header:hover":{backgroundColor:i.fabricColors.white},"&.ba-Accordion-header:active":{backgroundColor:i.fabricColors.white}}},flexContainer:{justifyContent:"flex-start",marginTop:"4px",flexGrow:"1",color:i.fabricColors.mineShaft,minHeight:"35px"},label:{marginRight:"-6px",fontWeight:"400",lineHeight:"22px",fontSize:"16px"},menuIcon:{order:1,transform:"rotate(270deg)",height:"33px",width:"14px",marginLeft:"0px",fontSize:"14px",lineHeight:"14px",display:"flex",alignItems:"center",color:i.fabricColors.neutralTuatara},textContainer:{order:2,paddingLeft:"0px",flexGrow:"unset",marginRight:"10px"},descriptionHovered:{background:i.fabricColors.white}},p=Object(a.mergeStyles)({selectors:{".ba-Accordion-content":{paddingBottom:"12px",paddingRight:"8px"},".ba-Accordion--contentVisible .ms-Button-menuIcon":{transform:"rotate(180deg)",marginLeft:"0px",height:"15px"}}}),y=e=>{var{className:t,text:o,onRenderContent:a,onOpen:i,onClose:l}=e,y=u(e,c);return n.createElement("div",{className:Object(r.css)(p)},n.createElement("div",{className:Object(r.css)(t)},n.createElement(s.Accordion,d({styles:m,text:o,onRenderContent:a,isHiddenOnDismiss:!0,onOpen:()=>{i&&i()},onClose:()=>{l&&l()}},y))))}},8011:function(e,t,o){"use strict";o.r(t),o.d(t,"getSolutionOperationStatus",(function(){return C})),o.d(t,"getSolutionSubOperationStatus",(function(){return x})),o.d(t,"getFormatSolutionDateTimeString",(function(){return N})),o.d(t,"SolutionsHistoryList",(function(){return j}));var r=o(719),a=o(1471),n=o(687),s=o(545),i=o(5629),l=o(3064),c=o(5633),d=o(245),u=o.n(d),m=o(3161),p=o(5628),y=o(2882),g=o(5492),b=o(2879),S=o(1089),f=o(5481),h=o(1090);function v(){return(v=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r])}return e}).apply(this,arguments)}function H(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,r)}return o}function M(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?H(Object(o),!0).forEach((function(t){E(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):H(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function E(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var O=Object(r.mergeStyleSets)({listRoot:{selectors:{".displayName":{color:y.fabricColors.bokaraGrey,fontFamily:g.fonts.segoeUi,fontSize:"14px",lineHeight:"20px"},".is-selected":{selectors:{".displayName":{fontFamily:g.fonts.segoeUiSemibold,color:y.fabricColors.neutralTuatara}}}}}}),C=(e,t)=>{var o;switch(e){case 0:o=t("Model.SolutionsHistory.Operation.import");break;case 1:o=t("Model.SolutionsHistory.Operation.uninstall");break;case 2:o=t("Model.SolutionsHistory.Operation.export");break;default:o=""}return o},x=(e,t)=>{var o;switch(e){case 0:o=t("Model.SolutionsHistory.SubOperation.none");break;case 1:o=t("Model.SolutionsHistory.SubOperation.new");break;case 2:o=t("Model.SolutionsHistory.SubOperation.upgrade");break;case 3:o=t("Model.SolutionsHistory.SubOperation.update");break;case 4:o=t("Model.SolutionsHistory.SubOperation.delete");break;default:o=""}return o},N=(e,t)=>{if(e){var o=new Date(e);return"".concat(o.toLocaleDateString(),", ").concat(o.toLocaleTimeString(t,{hour:"2-digit",minute:"2-digit"}))}return""},k=(e,t,o)=>{var r={columnActionsMode:a.ColumnActionsMode.hasDropdown,onSortClick:L(e,o)},n={ascending:t("Model.SolutionsHistory.List.Header.ascending"),descending:t("Model.SolutionsHistory.List.Header.descending")},s=[];switch(e){case"msdyn_starttime":case"msdyn_endtime":n={ascending:t("Model.SolutionsHistory.List.Header.timeAscending"),descending:t("Model.SolutionsHistory.List.Header.timeDescending")};break;case"msdyn_operation":s.push({key:"operationFilterBy",name:t("Model.SolutionsHistory.List.Header.sortFilterBy"),subMenuProps:{items:[{key:"export",name:t("Model.SolutionsHistory.Operation.export"),onClick:()=>{o({column:e,order:"asc",value:2})}},{key:"import",name:t("Model.SolutionsHistory.Operation.import"),onClick:()=>{o({column:e,order:"asc",value:0})}},{key:"uninstall",text:t("Model.SolutionsHistory.Operation.uninstall"),onClick:()=>{o({column:e,order:"asc",value:1})}}]}});break;case"msdyn_suboperation":s.push({key:"subOperationFilterBy",name:t("Model.SolutionsHistory.List.Header.sortFilterBy"),subMenuProps:{items:[{key:"delete",text:t("Model.SolutionsHistory.SubOperation.delete"),onClick:()=>{o({column:e,order:"asc",value:4})}},{key:"new",text:t("Model.SolutionsHistory.SubOperation.new"),onClick:()=>{o({column:e,order:"asc",value:1})}},{key:"none",text:t("Model.SolutionsHistory.SubOperation.none"),onClick:()=>{o({column:e,order:"asc",value:0})}},{key:"update",text:t("Model.SolutionsHistory.SubOperation.update"),onClick:()=>{o({column:e,order:"asc",value:3})}},{key:"upgrade",text:t("Model.SolutionsHistory.SubOperation.upgrade"),onClick:()=>{o({column:e,order:"asc",value:2})}}]}});break;case"msdyn_result":s.push({key:"subOperationFilterBy",name:t("Model.SolutionsHistory.List.Header.sortFilterBy"),subMenuProps:{items:[{key:"success",text:t("Model.SolutionsHistory.Result.success"),onClick:()=>{o({column:e,order:"asc",value:!0})}},{key:"failure",text:t("Model.SolutionsHistory.Result.failure"),onClick:()=>{o({column:e,order:"asc",value:!1})}}]}});break;case"msdyn_errorcode":n={ascending:t("Model.SolutionsHistory.List.Header.errorCodeAscending"),descending:t("Model.SolutionsHistory.List.Header.errorCodeDescending")}}return M({sortLabels:n,columnMenuItems:s},r)},L=(e,t)=>(o,r)=>(t&&t({order:o?"desc":"asc",column:e}),!0),j=e=>{var t,o,{listItems:r,loadProgress:g,tReady:H,t:E,orderSolutionsHistoryList:L,orderBy:j,searchBy:w,solutionTypeFilter:P,hasNextLink:R,pageNumber:T}=e,F=e.lng,D=new s.Selection({onSelectionChanged:()=>{e.onSelection(D)}}),A=Object(i.isLoading)(g),I=A&&0!==T,W=!r.length&&!A&&!I;return u.a.createElement(u.a.Fragment,null,u.a.createElement(l.DetailsList,v({},Object(c.getDetailsListProps)(E("Common.rowSelectionAriaLabel")),{isLoading:A&&!I,key:"SolutionsHistoryList",items:r,columns:Object(d.useMemo)(()=>((e,t,o,r,s)=>{if(!e)return[];var i={minWidth:40,maxWidth:80,isResizable:!0,isCollapsable:!0,isMultiline:!1,isPadded:!0,isSorted:!1,isSortedDescending:!1,sortAscendingAriaLabel:t("Common.Sorting.ascending"),sortDescendingAriaLabel:t("Common.Sorting.descending")},l=s?[]:[M(M(M({},i),{},{key:"name",minWidth:100,maxWidth:200,name:t("Model.SolutionsHistory.List.Header.name"),fieldName:"name"},k("msdyn_name",t,o)),{},{onRender:e=>u.a.createElement("div",{className:"displayName"},e.name)})];return l=l.concat([M(M({},i),{},{key:"startTime",minWidth:80,maxWidth:100,name:t("Model.SolutionsHistory.List.Header.startTime"),fieldName:"startTime",isSorted:!0,isSortedDescending:!0,onRender:e=>N(e.startTime,r)},k("msdyn_starttime",t,o)),M(M({},i),{},{key:"endTime",minWidth:80,maxWidth:100,name:t("Model.SolutionsHistory.List.Header.endTime"),fieldName:"endTime",onRender:e=>N(e.endTime,r)},k("msdyn_endtime",t,o)),M(M({},i),{},{key:"version",name:t("Model.SolutionsHistory.List.Header.version"),columnActionsMode:a.ColumnActionsMode.disabled,fieldName:"version"}),M(M({},i),{},{key:"publisherName",name:t("Model.SolutionsHistory.List.Header.publisherName"),fieldName:"publisherName"},k("msdyn_publishername",t,o)),M(M({},i),{},{key:"operation",name:t("Model.SolutionsHistory.List.Header.operation"),fieldName:"operation",onRender:e=>C(e.operation,t)},k("msdyn_operation",t,o)),M(M({},i),{},{key:"subOperation",name:t("Model.SolutionsHistory.List.Header.subOperation"),fieldName:"subOperation",onRender:e=>x(e.subOperation,t)},k("msdyn_suboperation",t,o)),M(M({},i),{},{key:"result",name:t("Model.SolutionsHistory.List.Header.result"),fieldName:"result",onRender:e=>{var o=e.result?b.fabricIcons.CompletedSolid:b.fabricIcons.StatusErrorFull;return u.a.createElement(u.a.Fragment,null,null!==e.result&&u.a.createElement("span",null,u.a.createElement(n.Icon,{iconName:o,styles:{root:{color:e.result?y.fabricColors.bilbao:y.fabricColors.brightRed,marginRight:"4px"}}}),u.a.createElement("span",{style:{color:y.fabricColors.neutralChicago}},e.result?t("Model.SolutionsHistory.Result.success"):t("Model.SolutionsHistory.Result.failure"))))}},k("msdyn_result",t,o)),M(M({},i),{},{key:"errorCode",name:t("Model.SolutionsHistory.List.Header.errorCode"),fieldName:"errorCode",onRender:e=>u.a.createElement("span",{style:{color:e.errorCode&&"0"!==e.errorCode?y.fabricColors.plum:y.fabricColors.neutralChicago}},e.errorCode&&"0"!==e.errorCode?u.a.createElement(h.Link,{href:f.default.getSolutionHistoryErrorCodeLink(e.errorCode),target:"_blank"},e.errorCode):"-")},k("msdyn_errorcode",t,o))])})(H,E,L,F,e.currentSolutionName),[H,E,j,w,P]),setKey:"staticKey",selectionMode:s.SelectionMode.single,selection:D,isError:!!e.errorMessage,renderOnError:()=>u.a.createElement(m.EmptyState,{icon:b.fabricIcons.DocumentSet,className:"solutions-history-list-error-message",primaryMessage:E("Common.Request.Failed"),secondaryMessage:[e.errorMessage||""],maxWidth:p.emptyStateMaxWidth}),className:O.listRoot,showLoadMoreButton:R,loadMoreButtonProps:Object(i.isLoading)(g)?{text:H?Object(S.formatResourceString)(E("Model.SolutionsHistory.List.loadingMoreItems"),100):"",disabled:!0}:{text:H?Object(S.formatResourceString)(E("Model.SolutionsHistory.List.loadMoreItems"),100):"",onClick:()=>e.loadMoreSolutionHistories()},filterAnnouncement:e=>Object(S.formatResourceString)(E("search.results"),e),styles:{subComponentStyles:{loadMoreButton:{root:{opacity:"0.8"}}}}})),W&&""===w&&u.a.createElement(m.EmptyState,(t={order:"desc",column:"msdyn_starttime"},o="msdyn_starttime desc"!==j,{icon:b.fabricIcons.DocumentSet,className:"solutions-history-list-empty-message",primaryMessage:H?E("Model.SolutionsHistory.NoSolutionsHistory.message"):"",maxWidth:p.emptyStateMaxWidth,callToActionProps:o&&{onClick:()=>{e.orderSolutionsHistoryList(t)}},callToActionText:o&&E("Model.SolutionsHistory.ErrorOnFilter.resetFilter")})),W&&""!==w&&u.a.createElement(m.EmptyState,{icon:b.fabricIcons.DocumentSet,className:"solutions-history-list-empty-search-message",primaryMessage:E("Common.Search.NoMatch.title"),secondaryMessage:[E("Common.Search.NoMatch.message")],maxWidth:p.emptyStateMaxWidth,callToActionProps:{onClick:()=>{e.onSearchFilterUpdate("")}},callToActionText:E("Model.SolutionsHistory.ErrorOnFilter.resetSearch")}))}}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/131.a77a0603.chunk.js.map