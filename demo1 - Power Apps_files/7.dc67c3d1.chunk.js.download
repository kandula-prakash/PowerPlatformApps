/*! For license information please see 7.dc67c3d1.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{2709:function(e,t,n){"use strict";n.r(t);var r=n(2710);n.d(t,"LinkTile",(function(){return r.LinkTile}));var o=n(2712);n.d(t,"blackTranslucent11",(function(){return o.blackTranslucent11})),n.d(t,"getCardSelectorsStyle",(function(){return o.getCardSelectorsStyle})),n.d(t,"getStyles",(function(){return o.getStyles}));n(2713)},2710:function(e,t,n){"use strict";n.r(t),n.d(t,"LinkTile",(function(){return i}));var r=n(545),o=n(2711),a=n(2712),i=Object(r.styled)(o.LinkTileBase,a.getStyles,void 0,{scope:"LinkTile"})},2711:function(e,t,n){"use strict";n.r(t),n.d(t,"LinkTileBase",(function(){return p}));var r=n(1277),o=n(545),a=n(245),i=["title","time","href","onClick","iconProps","tag","styles","theme"];function s(){return(s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function l(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var c=Object(o.classNamesFunction)(),p=e=>{var{title:t,time:n,href:o,onClick:p,iconProps:u,tag:d,styles:m,theme:g}=e,h=l(e,i),b=c(m,{theme:g});return a.createElement("a",s({},h,{className:b.root,href:o,onClick:p,onAuxClick:e=>{1===e.button&&p()},target:"_blank"}),a.createElement("div",{className:b.iconBox},a.createElement(r.Image,s({role:"presentation",className:b.icon,width:"52px",height:"52px"},u))),a.createElement("div",{className:b.descriptionSection},a.createElement("div",{className:b.title,title:t},t),a.createElement("div",{className:b.descriptionSubsection},a.createElement("div",{className:b.tag},d),a.createElement("div",{className:b.time},a.createElement("div",null,n)))))}},2712:function(e,t,n){"use strict";n.r(t),n.d(t,"blackTranslucent11",(function(){return s})),n.d(t,"getCardSelectorsStyle",(function(){return l})),n.d(t,"getStyles",(function(){return p}));var r=n(719);function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var s="rgba(0, 0, 0, 0.11)";function l(e){return{":hover":{cursor:"pointer",boxShadow:"0px 1.2px 3.6px ".concat(s,", 0px 6.4px 14.4px ").concat(s)},":focus":{outline:"1px solid ".concat(e.neutralDark)}}}var c={root:"ms-LinkTile",iconBox:"ms-LinkTile-iconBox",icon:"ms-LinkTile-icon",descriptionSection:"ms-LinkTile-descriptionSection",title:"ms-LinkTile-title",descriptionSubsection:"ms-LinkTile-descriptionSubsection",tag:"ms-LinkTile-tag",time:"ms-LinkTile-time",clockIcon:"ms-LinkTile-clockIcon"};function p(e){var{theme:t}=e,{fonts:n,palette:o,semanticColors:i}=t,p=Object(r.getGlobalClassNames)(c,t),u=l(o);return{root:[p.root,{display:"flex",flexShrink:"unset",height:"88px",width:"268px",boxShadow:"0px 0.3px 0.9px ".concat(s,", 0px 1.6px 3.6px ").concat(s),borderRadius:"3px",marginBottom:"20px",color:o.neutralPrimary,textDecoration:"none",selectors:a(a({},u),{},{[r.HighContrastSelector]:{border:"1px solid ".concat(s)}})}],iconBox:[p.iconBox,{backgroundColor:o.neutralLight,minWidth:"64px",borderRadius:"3px 0px 0px 3px"}],icon:[p.icon,{margin:"18px 0px 0px 6px"}],title:[p.title,n.medium,{width:"100%",height:"40px",marginBottom:"5px",fontWeight:r.FontWeights.semibold,textOverflow:"ellipsis",overflow:"hidden",display:"-webkit-box","-webkit-box-orient":"vertical","-webkit-line-clamp":"2"}],descriptionSection:[p.descriptionSection,n.small,{width:"100%",display:"block",margin:"10px 15px"}],descriptionSubsection:[p.descriptionSubsection,{width:"100%",display:"flex",justifyContent:"space-between"}],tag:[p.tag,{backgroundColor:o.neutralLight,padding:"3px 6px",borderRadius:"3px"}],time:[p.time,{color:i.bodySubtext,lineHeight:"21px",display:"flex"}],clockIcon:[p.clockIcon,{marginRight:"5px"}]}}},2713:function(e,t,n){"use strict";n.r(t)},3210:function(e,t,n){"use strict";n.r(t);var r=n(245),o=r.lazy(()=>Promise.all([n.e(225).then(n.bind(null,6925))]).then(e=>{var[t]=e;return t}));t.default=e=>r.createElement(r.Suspense,{fallback:r.createElement(r.Fragment,null)},r.createElement(o,e))},7520:function(e,t,n){"use strict";n.r(t),n.d(t,"ReactAppRoot",(function(){return B}));var r=n(245),o=n(5437),a=n(303),i=n(222),s=n(3760),l=n(2868),c=n(7521),p=n(5765),u=n(5630),d=n(7524),m=n(5981),g=n(7509),h=n(7529),b=n(7539),f=n(5871),y=n(7545),S=n(7548),C=n(5787),v=n(2873),w=n(5746),O=n(6541),P=n(5468),E=n(7554),A=n(2870),j=n(6682),L=n(7590),T=n(5487),k=n(5606),R=n(2872),D=n(5593),M=n(5583),N=n(5488),x=n(7516),I=n(7856),F=n(3713);class B extends r.Component{componentDidUpdate(e){if(e.rootProps&&this.props.rootProps&&e.rootProps.currentEnvironment!==this.props.rootProps.currentEnvironment){var t=this.props.rootProps.currentEnvironment,n=Object(c.getSitewideEndpointForEnvironment)(t,R.settings);c.setInstance({baseURL:n,interceptors:[B.getPowerPortalSitewideAuthInterceptor(),B.getPowerPortalSitewideLoggingInterceptor(this.props.telemetryHelpers.loggingSessionId)]})}}constructor(e){super(e),A.HostSettings.SetHostSettings(this.props.hostSettings,!1),j.CustomHostEvents.SetCustomHostEvents(this.props.customHostEvents);var t=[P.sharedMiddlewares.environmentMiddleware(this.props.environmentHelpers),P.sharedMiddlewares.navigateMiddleware(this.props.sharedHelpers.navigate),m.appsMiddlewares.GenericAppActionsMiddleware(),m.appsMiddlewares.AppSpecificActionsMiddleware(),m.appsMiddlewares.AppVersionActionsMiddleware(),g.connectionsMiddlewares.ConnectionActionsMiddleware(this.props.connectionHelpers),d.apisMiddlewares.ApiActionsMiddleware(this.props.apiHelpers),P.sharedMiddlewares.telemetryActionMiddleware(this.props.telemetryHelpers),P.sharedMiddlewares.aadUserMiddleware(this.props.sharedHelpers.getAadUser),P.sharedMiddlewares.rpcMiddleware(this.props.sharedHelpers.rpcService),P.sharedMiddlewares.planMiddleware(this.props.planHelpers),P.sharedMiddlewares.startupMiddleware(this.props.sharedHelpers,this.props.telemetryHelpers.loggingSessionId),h.gatewaysMiddlewares.GenericGatewayActionsMiddleware(),h.gatewaysMiddlewares.GatewaySpecificActionsMiddleware(this.props.gatewayHelpers),b.sampleAppsMiddlewares.SampleAppActionsMiddleware(this.props.sharedHelpers.navigate),f.appModulesMiddlewares.AppModuleGenericActionsMiddleware(),f.appModulesMiddlewares.AppModuleSpecificActionsMiddleware(),w.solutionsMiddlewares.SolutionsActionsMiddleware(),C.solutionComponentsMiddlewares.SolutionComponentsActionsMiddleware(this.props.sharedHelpers.openEntityInExcel),C.solutionComponentsMiddlewares.PowerVaActionsMiddleware(),y.sampleAppModulesMiddlewares.SampleAppModuleActionsMiddleware(),S.solutionCheckerResultsMiddleware.SolutionCheckerResultsActionsMiddleware(),O.powerPortalMiddlewares.PowerPortalSpecificActionsMiddleware(),P.sharedMiddlewares.toastNotificationMiddleware(this.props.toastNotificationHelpers)];this.state={store:E.AppStore.Store(t),environmentId:"",aadUserObjectId:"",hasEnvironmentUpdated:!1};var n=this.props.rootProps.currentEnvironment;k.SagaContextProps.setCurrentEnvironment(n);var r=this.props.sharedHelpers.getAadUser(),o=r?r.objectId:null;x.ABTestingHelper.setUserObjectId(o);var a=Object(c.getSitewideEndpointForEnvironment)(n,R.settings);c.setInstance({baseURL:a,interceptors:[B.getPowerPortalSitewideAuthInterceptor(),B.getPowerPortalSitewideLoggingInterceptor(this.props.telemetryHelpers.loggingSessionId)]}),e.persistentStorage&&v.PersistentStorageInstance.setInstance(e.persistentStorage),e.httpClientHelpers&&l.MetadataClientInstance.setInstance(e.httpClientHelpers.metadataClient)}render(){var e,t,{children:n,rootProps:i,hostSettingsLoaded:l,sharedHelpers:c,pageLoadLoggerProps:p}=this.props,{currentEnvironment:u}=i,d=c.getAadUser(),m=Object(F.getUXContext)(null==u||null===(e=u.properties)||void 0===e?void 0:e.environmentSku);return i.areShellProvidersReady=!!u&&!!d&&!!d.objectId&&l,n||(t=r.createElement(a.Route,{render:e=>r.createElement(L.ReactAppContainer,{location:e.location,pageLoadLoggerProps:p,uxContext:m})})),r.createElement(o.Provider,{store:this.state.store},r.createElement(M.NavigationContext.Provider,{value:{navigate:this.props.sharedHelpers.navigate}},r.createElement(I.MakerTypeProvider,null,r.createElement(N.ModalsProvider,null,r.createElement(s.DispatchProvider,{dispatch:E.AppStore.dispatchAction},r.createElement(T.RootPropsContext.Provider,{value:{rootProps:i}},n||t))))))}componentDidMount(){window.addEventListener(E.FireReduxActionEventName,this._handleFireReduxActionEvent)}componentWillUnmount(){window.removeEventListener(E.FireReduxActionEventName,this._handleFireReduxActionEvent)}_handleFireReduxActionEvent(e){var t=e.detail;t&&E.AppStore.dispatchAction(t)}static getPowerPortalSitewideAuthInterceptor(){return{request:{onFulfilled:e=>{if(e&&e.baseURL){var t=R.settings.powerPortalSitewideServiceResource;return A.HostSettings.getHostToken(t).then(t=>(e.headers.authorization="Bearer "+t.accessToken,e))}return e}}}}static getDuration(e){var t=e[p.RequestStateKeys.clientRequestStart];return t instanceof Date?new Date-t:-1}static getPowerPortalSitewideLoggingInterceptor(e){var t=e=>Object(D.trackInfoTrace)(e.name,e.data);return{request:{onFulfilled:n=>{if(n&&n.baseURL){var r=Object(i.v4)(),o=e,a=(n.method||"").toUpperCase(),s=n.url||"";n[p.RequestStateKeys.clientRequestStart]=new Date,n.headers=n.headers||{},n.headers[p.HeaderKeys.clientRequestId]=r,n.headers[p.HeaderKeys.sessionId]=o;var l={eventType:"TelemetryAction",eventName:"PowerPortalSitewideClientHttpRequests",eventModifier:u.TelemetryPerformanceEventModifier.start,data:{requestId:r,sessionId:o,httpMethod:a,url:s}};t({name:"PowerPortalSitewideClientTelemetry",data:l})}return n}},response:{onFulfilled:e=>{var n=e&&e.config;if(n&&n.url){var r=n.headers[p.HeaderKeys.clientRequestId]||"",o=n.headers[p.HeaderKeys.sessionId]||"",a=(n.method||"").toUpperCase(),i=n.url||"",s=B.getDuration(n),l={eventType:"TelemetryAction",eventName:"PowerPortalSitewideClientHttpRequests",eventModifier:u.TelemetryPerformanceEventModifier.complete,data:{requestId:r,sessionId:o,httpMethod:a,url:i,responseStatusCode:e.status},durationInMilliseconds:s};t({name:"PowerPortalSitewideClientTelemetry",data:l})}return e},onRejected:e=>{var n,r=(n=e.response?e.response:e)&&n.config;if(r&&r.url){var o=r.headers[p.HeaderKeys.clientRequestId]||"",a=r.headers[p.HeaderKeys.sessionId]||"",i=(r.method||"").toUpperCase(),s=r.url||"",l=B.getDuration(r),c={eventType:"TelemetryAction",eventName:"PowerPortalSitewideClientHttpRequests",eventModifier:u.TelemetryPerformanceEventModifier.fail,data:{requestId:o,sessionId:a,httpMethod:i,url:s,responseStatusCode:n.status,errorMessage:n.data&&n.data.Message&&n.data.Message.split("?")[0]||e.message||""},durationInMilliseconds:l};t({name:"PowerPortalSitewideClientTelemetry",data:c})}throw e}}}}}B.getDerivedStateFromProps=(e,t)=>{var n=e.sharedHelpers.getAadUser();n&&n.objectId!==t.aadUserObjectId&&k.SagaContextProps.setAadUser(n);var r,o=!1;if(e.rootProps&&e.rootProps.currentEnvironment&&e.rootProps.currentEnvironment.id!==t.environmentId&&(k.SagaContextProps.setRefreshCurrentEnvironment(e.rootProps.refreshCurrentEnvironment),r=e.rootProps.currentEnvironment,o=!0),e.persistentStorage!==v.PersistentStorageInstance.getInstance(!1)&&v.PersistentStorageInstance.setInstance(e.persistentStorage),o){k.SagaContextProps.setCurrentEnvironment(r),e.httpClientHelpers&&l.MetadataClientInstance.setInstance(e.httpClientHelpers.metadataClient);var a=Object(c.getSitewideEndpointForEnvironment)(r,R.settings);c.setInstance({baseURL:a,interceptors:[B.getPowerPortalSitewideAuthInterceptor(),B.getPowerPortalSitewideLoggingInterceptor(e.telemetryHelpers.loggingSessionId)]})}return{environmentId:r&&r.id,hasEnvironmentUpdated:o,aadUserObjectId:n&&n.objectId||""}}},7521:function(e,t,n){"use strict";n.r(t),n.d(t,"setInstance",(function(){return i})),n.d(t,"getInstance",(function(){return s})),n.d(t,"getSitewideEndpointForEnvironment",(function(){return l}));var r,o=n(252),a=n(7522);function i(e){r=new a.PowerPortalSitewideClient(e)}function s(){if(!r)throw new Error("PowerPortals Sitewide Client has not been initialized");return r}function l(e,t){var{region:n}=Object(o.getSettings)();return"prod"===n||"preview"===n||"preprod"===n?function(e,t){var n=e&&e.location;if(a.sitewideEndpointsMap.has(n))return a.sitewideEndpointsMap.get(n);return t.powerPortalSitewideApiEndpoint}(e,t):t.powerPortalSitewideApiEndpoint}},7522:function(e,t,n){"use strict";n.r(t),n.d(t,"PowerPortalSitewideClient",(function(){return u})),n.d(t,"sitewideEndpointsMap",(function(){return d}));var r=n(5644),o=n(5645),a=n(7523),i=n(2872),s=n(2867),l=n(1085);function c(e,t,n,r,o,a,i){try{var s=e[a](i),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}function p(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){c(a,r,o,i,s,"next",e)}function s(e){c(a,r,o,i,s,"throw",e)}i(void 0)}))}}class u{constructor(e){this.instanceUrl=void 0,this.httpClient=void 0;var t=i.settings,n={baseURL:e.baseURL||t.powerPortalSitewideApiEndpoint,interceptors:e.interceptors};this.instanceUrl=n.baseURL,this.httpClient=new a.HttpClient(n)}createPortal(e){var t=this;return p((function*(){return(yield t.httpClient.post(t.instanceUrl+"/api/v1/powerPortal/ProvisioningPortal",void 0,{params:e})).data}))()}createPortalV2(e){var t=this;return p((function*(){var n=yield t.httpClient.post(t.instanceUrl+"/api/v1/powerPortal/ProvisioningPortal",void 0,{params:e});return JSON.parse(n.data)}))()}retryPortalProvisioning(e){var t=this;return p((function*(){return(yield t.httpClient.post(t.instanceUrl+"/api/v1/powerPortal/RetryPortalProvisioning",void 0,{params:{portalId:e}})).data}))()}isDomainNameAvailable(e){var t=this;return p((function*(){return(yield t.httpClient.get(t.instanceUrl+"/api/v1/powerPortal/CheckDomainNameAvailability",{params:{subDomain:e}})).data}))()}getPortalStatus(e){var t=this;return p((function*(){return(yield t.httpClient.get(t.instanceUrl+"/api/v1/powerPortal/CheckPortalStatus",{params:{portalId:e}})).data}))()}listPortals(e,t){var n=this;return p((function*(){var r="";switch(t){case o.PowerPortalsListFilterType.PortalId:r="PortalId eq '".concat(e,"'");break;case o.PowerPortalsListFilterType.PortalHostName:r="PortalUrl eq '".concat(e,"'");break;case o.PowerPortalsListFilterType.OrgId:r="CrmInstanceId eq '".concat(e,"'")}var a=yield n.httpClient.get(n.instanceUrl+"/api/v1/powerPortal/ListPortals",{params:{filter:r}});return JSON.parse(a.data)}))()}listPortalsByOrgId(e,t){var n=this;return p((function*(){var r=yield n.httpClient.get(n.instanceUrl+"/api/v1/powerPortal/ListPortalsByOrgId",{params:{orgId:e,websiteId:t}});return JSON.parse(r.data)}))()}getPortalById(e){var t=this;return p((function*(){var n=yield t.httpClient.get(t.instanceUrl+"/api/v1/powerPortal/GetPortalById",{params:{portalId:e}});return JSON.parse(n.data)}))()}UpdatePortalName(e,t){var n=this;return p((function*(){return(yield n.httpClient.post(n.instanceUrl+"/api/v1/powerportal/portal/UpdatePortalName",void 0,{params:{portalId:e,name:t}})).data}))()}DeletePortal(e){var t=this;return p((function*(){return(yield t.httpClient.delete(t.instanceUrl+"/api/v1/powerportal/DeletePortal",{params:{portalId:e}})).data}))()}GetPortalPrerequisites(e,t,n,o,a,i,s,l){var c=this;return p((function*(){return(yield c.httpClient.get(c.instanceUrl+"/api/v1/powerportal/IsOperationAllowed",{params:{operation:r.PowerPortalOperationType[e],orgId:t,orgUrl:n,portalId:o,packageName:a,lcid:i,skipPackageChecks:s,skipDuplicatePortalCheck:l}})).data}))()}IsCDSOrg(e){var t=this;return p((function*(){return(yield t.httpClient.get(t.instanceUrl+"/api/v1/powerportal/IsCDSOrg",{params:{orgUrl:e}})).data}))()}ClearPortalCache(e){var t=this;return p((function*(){return(yield t.httpClient.post(t.instanceUrl+"/api/v1/powerportal/ClearCache",void 0,{params:{portalId:e}})).data}))()}UpdateWebsiteIds(e){var t=this;return p((function*(){return(yield t.httpClient.post(t.instanceUrl+"/api/v1/powerportal/UpdateWebsiteIds",JSON.stringify(e),{headers:{"Content-Type":"application/json"}})).data}))()}SetPortalAppSetting(e,t,n,r){var o=this;return p((function*(){return(yield o.httpClient.post(o.instanceUrl+"/api/v1/powerPortal/SetPortalAppSetting",void 0,{params:{tenantId:e,portalId:t,appSettingName:n,appSettingValue:r}})).data}))()}GetPowerBIFeatureSettings(e){var t=this;return p((function*(){return(yield t.httpClient.get(t.instanceUrl+"/api/v1/powerportal/GetPowerBIFeatureSettings",{params:{portalId:e}})).data}))()}}var d=Object(s.Map)([[l.EnvironmentLocations.unitedStates,"https://portalsitewide-nam.portal-infra.dynamics.com"],[l.EnvironmentLocations.southamerica,"https://portalsitewide-sam.portal-infra.dynamics.com"],[l.EnvironmentLocations.canada,"https://portalsitewide-can.portal-infra.dynamics.com"],[l.EnvironmentLocations.europe,"https://portalsitewide-eur.portal-infra.dynamics.com"],[l.EnvironmentLocations.france,"https://portalsitewide-fra.portal-infra.dynamics.com"],[l.EnvironmentLocations.germany,"https://portalsitewide-ger.portal-infra.dynamics.com"],[l.EnvironmentLocations.japan,"https://portalsitewide-jpn.portal-infra.dynamics.com"],[l.EnvironmentLocations.asia,"https://portalsitewide-apj.portal-infra.dynamics.com"],[l.EnvironmentLocations.australia,"https://portalsitewide-oce.portal-infra.dynamics.com"],[l.EnvironmentLocations.india,"https://portalsitewide-ind.portal-infra.dynamics.com"],[l.EnvironmentLocations.unitedkingdom,"https://portalsitewide-gbr.portal-infra.dynamics.com"],[l.EnvironmentLocations.brazil,"https://portalsitewide-sam.portal-infra.dynamics.com"],[l.EnvironmentLocations.uae,"https://portalsitewide-uae.portal-infra.dynamics.com"],[l.EnvironmentLocations.mooncake,"https://portalsitewide-chn.portal-infra.dynamics.cn"]])},7523:function(e,t,n){"use strict";n.r(t),n.d(t,"createAxiosInstance",(function(){return p})),n.d(t,"HttpClient",(function(){return u}));var r=n(498),o=n.n(r);function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t,n,r,o,a,i){try{var s=e[a](i),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}function c(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){l(a,r,o,i,s,"next",e)}function s(e){l(a,r,o,i,s,"throw",e)}i(void 0)}))}}function p(e){var t=o.a.create({baseURL:e.baseURL||void 0,params:e.defaultParams||void 0,withCredentials:e.withCredentials});return e.interceptors&&e.interceptors.forEach(e=>{e.request&&t.interceptors.request.use(e.request.onFulfilled,e.request.onRejected),e.response&&t.interceptors.response.use(e.response.onFulfilled,e.response.onRejected)}),t}class u{constructor(e){this.axiosInstance=void 0,this.defaultNextLinkPropName=void 0,this.axiosInstance=p(e),this.defaultNextLinkPropName=e.defaultNextLinkPropName}get(e,t){var n=this;return c((function*(){return n.request(i(i({url:e},t),{},{method:"get"}))}))()}delete(e,t){var n=this;return c((function*(){return n.request(i(i({url:e},t),{},{method:"delete"}))}))()}head(e,t){var n=this;return c((function*(){return n.request(i(i({url:e},t),{},{method:"delete"}))}))()}post(e,t,n){var r=this;return c((function*(){return r.request(i(i({url:e,data:t},n),{},{method:"post"}))}))()}patch(e,t,n){var r=this;return c((function*(){return r.request(i(i({url:e,data:t},n),{},{method:"patch"}))}))()}request(e){var t=this;return c((function*(){return t.makeRequest(e)}))()}makeRequest(e){var t=this;return c((function*(){try{var n=yield t.axiosInstance.request(e);if(!e.followNextLinks)return n;var r=e.nextLinkPropName||t.defaultNextLinkPropName;return yield t.checkForNextLink(n,r)}catch(o){if(!o)throw{message:"Http Client threw error with no parseable error object",config:e};throw o}}))()}checkForNextLink(e,t){var n=this;return c((function*(){if(t&&e&&e.data&&e.data[t]){var r=e.data.value||[];return n.followContinuationLink(e.data[t],e,r,t)}return Promise.resolve(e)}))()}followContinuationLink(e,t,n,r){var o=this;return c((function*(){if(!e)return Promise.resolve(i(i({},t),{},{data:{value:n}}));var a=i(i({},t.config),{},{url:e});try{var s=yield o.axiosInstance.request(a);return s&&s.data&&s.data.value?!!s.data.value.length?o.followContinuationLink(s.data[r],s,n.concat(s.data.value),r):i(i({},s),{},{data:{value:n}}):t}catch(l){return l&&l.data&&l.data.error?i(i({},t),{},{error:l.data.error}):t}}))()}}},7524:function(e,t,n){"use strict";n.r(t);var r=n(5796);n.d(t,"apisActions",(function(){return r}));var o=n(7525);n.d(t,"apisMiddlewares",(function(){return o}));var a=n(7528),i=n(5807);n.d(t,"apisSelectors",(function(){return i})),t.default=a.reducer},7525:function(e,t,n){"use strict";n.r(t);var r=n(7526);n.d(t,"ApiClientRootSaga",(function(){return r.ApiClientRootSaga}));var o=n(7527);n.d(t,"ApiActionsMiddleware",(function(){return o.ApiActionsMiddleware}));var a=n(5802);n.d(t,"ApiClientSaga",(function(){return a.default}))},7526:function(e,t,n){"use strict";n.r(t),n.d(t,"ApiClientRootSaga",(function(){return a}));var r=n(5749),o=n(7525);function*a(){yield Object(r.all)([Object(r.fork)(o.ApiClientSaga)])}},7527:function(e,t,n){"use strict";n.r(t),n.d(t,"ApiActionsMiddleware",(function(){return a}));var r=n(6866),o=n(5796);function a(e){return t=>n=>a=>{var i=a,{dispatch:s}=t;switch(i.type){case o.ApisActionTypes.DELETE_API:var l=i.payload.api,c=i.payload.callback;e.deleteApi(l).then(()=>{s(Object(r.fetchConnectionsRequest)({forceRefresh:!0})),c()})}return n(a)}}},7528:function(e,t,n){"use strict";n.r(t),n.d(t,"defaultState",(function(){return i})),n.d(t,"reducer",(function(){return s}));var r=n(5796),o=n(5470),a=n(2812),i={apis:new o.CaseInsensitiveNormalized,fetchApisError:""};function s(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case r.ApisActionTypes.FETCH_APIS_FULFILLED:return Object(a.assign)({},e,{apis:Object(o.updateNormalizedData)(e.apis,t.payload.apis,t.payload.environmentId),fetchApisError:""});case r.ApisActionTypes.FETCH_APIS_REJECTED:return Object(a.assign)({},e,{fetchApisError:t.payload.error});default:return e}}},7529:function(e,t,n){"use strict";n.r(t);var r=n(6867);n.d(t,"gatewaysActions",(function(){return r}));var o=n(7530);n.d(t,"gatewaysMiddlewares",(function(){return o}));var a=n(7538),i=n(7537);n.d(t,"gatewaysSelectors",(function(){return i})),t.default=a.reducer},7530:function(e,t,n){"use strict";n.r(t);var r=n(7531);n.d(t,"GatewayClientRootSaga",(function(){return r.GatewayClientRootSaga}));var o=n(7532);n.d(t,"GenericGatewayActionsMiddleware",(function(){return o.GenericGatewayActionsMiddleware}));var a=n(7533);n.d(t,"GatewaySpecificActionsMiddleware",(function(){return a.GatewaySpecificActionsMiddleware}));var i=n(7535);n.d(t,"GatewayClientSaga",(function(){return i.default}))},7531:function(e,t,n){"use strict";n.r(t),n.d(t,"GatewayClientRootSaga",(function(){return a}));var r=n(5749),o=n(7529);function*a(){yield Object(r.all)([Object(r.fork)(o.gatewaysMiddlewares.GatewayClientSaga)])}},7532:function(e,t,n){"use strict";n.r(t),n.d(t,"GenericGatewayActionsMiddleware",(function(){return i}));var r=n(5468),o=n(6867),a=n(2872);function i(){return e=>t=>n=>{var{dispatch:i}=e;switch(n.type){case o.GatewaysActionTypes.CREATE_GATEWAY:i(r.sharedActions.openNewTab({uri:a.settings.gatewayInstallerUrl}));break;case o.GatewaysActionTypes.OPEN_GATEWAY_HELP:i(r.sharedActions.openNewTab({uri:a.settings.gatewayDocumentationUrl}))}return t(n)}}},7533:function(e,t,n){"use strict";n.r(t),n.d(t,"GatewaySpecificActionsMiddleware",(function(){return d}));var r=n(7534),o=n(5637),a=n(5478),i=n(2869),s=n(2880),l=n(2871),c=n(5623),p=n(5468),u=n(6867);function d(e){return t=>n=>d=>{var m,g,{dispatch:h}=t,b=l.featureGates,f=d;switch(f.type){case u.GatewaysActionTypes.OPEN_GATEWAY_DETAILS:m=f.payload.gateway,(g=f.payload.navigate)(Object(c.getGatewayDetailsUrl)(m.id),!0);break;case u.GatewaysActionTypes.DELETE_GATEWAY_REQUEST:m=f.payload.gateway,g=f.payload.navigate;var y=f.payload.redirectUrl,S=Object(i.getResources)();h(p.sharedActions.openConfirmDialog({hidden:!1,title:Object(s.formatResourceString)(S.Controllers.Gateways.Delete.title,Object(r.getDisplayName)(m)),subText:S.Controllers.Gateways.Delete.message,confirmButtonText:S.Common.remove,cancelButtonText:S.Common.cancel,onConfirm:()=>{h(Object(u.deleteGateway)({gateway:m,redirectUrl:y,navigate:g})),h(p.sharedActions.closeConfirmDialog())},hideCancelButton:!1}));break;case u.GatewaysActionTypes.SHARE_GATEWAY:m=f.payload.gateway,Object(o.canUserShareResource)(m)&&(b.showReactGatewaySharing?h(p.sharedActions.panelOpen({panelType:a.PanelToShowType.GatewaySharePanel,panelProps:{selectedGateway:m},stayMountedWhenHidden:!0})):e.shareGateway(m.id));break;case u.GatewaysActionTypes.DELETE_GATEWAY_FULFILLED:d.payload.redirectUrl&&d.payload.navigate(d.payload.redirectUrl,!0)}return n(d)}}},7535:function(e,t,n){"use strict";n.r(t);var r=n(5749),o=n(7536),a=n(5606),i=n(5604),s=n(5603),l=n(5760),c=n(5597),p=n(5470),u=n(5630),d=n(5483),m=n(5623),g=n(6867),h=n(7537),b=n(5768);function*f(e){var t=a.SagaContextProps.getCurrentEnvironment(),n=i.getFilterValueByEnvironment(t),s=e.payload.gateway.id,c=e.payload.navigate,p=a.SagaContextProps.getAadUser(),m={url:Object(d.getQueryUrl)(s,n,p.objectId),method:"DELETE"},h=yield Object(r.call)(l.default,e,m);Object(b.hasResponseError)(h)?yield Object(r.put)(Object(u.logActionFail)(Object(g.deleteGatewayRejected)({error:Object(b.getResponseErrorMessage)(h)}),o.GatewaysDeleteEvents.Fail.eventName,e)):yield Object(r.put)(Object(u.logActionComplete)(Object(g.deleteGatewayFulfilled)({gateway:e.payload.gateway,redirectUrl:e.payload.redirectUrl,navigate:c}),o.GatewaysDeleteEvents.Complete.eventName,e))}function*y(e){var t=a.SagaContextProps.getCurrentEnvironment(),n=yield Object(r.select)(h.gatewaysListCachedSelector,t.id),o=i.getFilterValueByEnvironment(t),s=a.SagaContextProps.getAadUser(),p={url:Object(d.getQueryUrl)(c.gatewaysClusterQueryUrl,o,s&&s.objectId)},u=yield Object(r.call)(l.default,e,p,n);if(!u)return null;Object(b.hasResponseError)(u)?yield Object(r.put)(Object(g.fetchGatewaysRejected)({error:Object(b.getResponseErrorMessage)(u)})):yield Object(r.put)(Object(g.fetchGatewaysFulfilled)({gateways:u.data.value,environmentId:t.id}))}function*S(e){var t=e.payload.gatewayId,n=p.CachedStatusType.None,o=e.payload.state,s=a.SagaContextProps.getCurrentEnvironment(),u=i.getFilterValueByEnvironment(s),m=a.SagaContextProps.getAadUser(),h={url:Object(d.getQueryUrl)(Object(c.gatewayClusterPatchUrl)(t),u,m&&m.objectId),method:"PATCH",data:JSON.stringify({loadBalancingSettings:'{"selector":'.concat(o,"}")}),headers:{"Content-Type":"application/json"}},b=yield Object(r.call)(l.default,e,h,n);if(!b)return null;200!==b.status?yield Object(r.put)(Object(g.patchGatewayRejected)({gatewayId:t,status:b.status})):yield Object(r.put)(Object(g.patchGatewayFulfilled)({gatewayId:t,status:b.status}))}function*C(e){var t=e.payload.gatewayId,n=p.CachedStatusType.None,o=a.SagaContextProps.getCurrentEnvironment(),s=i.getFilterValueByEnvironment(o),u=a.SagaContextProps.getAadUser(),m={url:Object(d.getQueryUrl)(Object(c.gatewayClusterUrl)(),s,u&&u.objectId)},h=yield Object(r.call)(l.default,e,m,n);if(!h)return null;if(Object(b.hasResponseError)(h))yield Object(r.put)(Object(g.fetchGatewayRejected)({gatewayId:t,error:Object(b.getResponseErrorMessage)(h)}));else{var f=h.data.value.find(e=>e.id.endsWith(t)?e:void 0);m={url:Object(d.getQueryUrl)(Object(c.gatewayClusterStatusUrl)(t),s,u&&u.objectId)};var y=(yield Object(r.call)(l.default,e,m,n)).data.clusterStatus;yield Object(r.put)(Object(g.fetchGatewayFulfilled)({gateway:f,environmentId:o.id,gatewayStatus:y}))}}function*v(e){var t=e.payload.gatewayId,n=p.CachedStatusType.None,o=a.SagaContextProps.getCurrentEnvironment(),i=s.getFilterQueryParameters(null,o);s.addFilterToQueryParameter(i,Object(m.getGatewayFilter)(t));var u=a.SagaContextProps.getAadUser(),h={url:Object(d.getQueryUrl)(c.connectionsQueryUrl,i.$filter,u.objectId)},f=yield Object(r.call)(l.default,e,h,n);if(!f)return null;Object(b.hasResponseError)(f)?yield Object(r.put)(Object(g.fetchGatewayConnectionsRejected)({gatewayId:t,error:Object(b.getResponseErrorMessage)(f)})):yield Object(r.put)(Object(g.fetchGatewayConnectionsFulfilled)({gatewayId:t,connections:f.data.value}))}t.default=function*(){yield Object(r.takeLatest)(g.GatewaysActionTypes.DELETE_GATEWAY,f),yield Object(r.takeLatest)(g.GatewaysActionTypes.FETCH_GATEWAYS_REQUEST,y),yield Object(r.takeLatest)(g.GatewaysActionTypes.FETCH_GATEWAY_REQUEST,C),yield Object(r.takeLatest)(g.GatewaysActionTypes.PATCH_GATEWAY_REQUEST,S),yield Object(r.takeLatest)(g.GatewaysActionTypes.FETCH_GATEWAY_CONNECTIONS_REQUEST,v)}},7536:function(e,t,n){"use strict";function r(e){return{resourceType:"gateway",id:e.id,status:e.properties.status}}n.r(t),n.d(t,"getGatewayData",(function(){return r})),n.d(t,"GatewayLoadEvent",(function(){return o})),n.d(t,"GatewaysListLoadEvent",(function(){return a})),n.d(t,"GatewaysDeleteEvents",(function(){return i})),n.d(t,"GatewaysManagementCommandBarEvents",(function(){return s})),n.d(t,"GatewaysListCommandBarEvents",(function(){return l})),n.d(t,"GatewaysListMenuEvents",(function(){return c})),n.d(t,"GatewaysListEvents",(function(){return p})),n.d(t,"GatewayConnectionsLoadEvent",(function(){return u}));var o={eventName:"Gateways.Gateway.Load"},a={eventName:"Gateways.Load"},i={Complete:{eventName:"Gateways.Gateway.Delete.Complete"},Fail:{eventName:"Gateways.Gateway.Delete.Fail"}},s={New:{eventName:"Gateways.Management.CommandBar.New",getData:r},Delete:{eventName:"Gateways.Management.CommandBar.Delete",getData:r}},l={New:{eventName:"Gateways.CommandBar.New"},Delete:{eventName:"Gateways.CommandBar.Delete",getData:r}},c={New:{eventName:"Gateways.Gateway.New"},Details:{eventName:"Gateways.Gateway.Details",getData:r},Delete:{eventName:"Gateways.Gateway.Delete",getData:r},Share:{eventName:"Gateways.Gateway.Share",getData:r}},p={Help:{eventName:"Gateways.Help.Clicked"}},u={eventName:"Gateways.GatewayConnections.Load"}},7537:function(e,t,n){"use strict";n.r(t),n.d(t,"gatewaySelector",(function(){return a})),n.d(t,"gatewayError",(function(){return i})),n.d(t,"gatewayStatusSelector",(function(){return s})),n.d(t,"gatewaysListCachedSelector",(function(){return l})),n.d(t,"gatewaysSelector",(function(){return c})),n.d(t,"isGatewaysListCachedComplete",(function(){return p})),n.d(t,"gatewaysError",(function(){return u})),n.d(t,"isGatewayConnectionsCachedComplete",(function(){return d})),n.d(t,"gatewayConnectionsError",(function(){return m})),n.d(t,"gatewayConnections",(function(){return g}));var r=n(5470),o=n(5626),a=(e,t)=>e.gateways.gateways.byId(t),i=(e,t)=>e.gateways.fetchGatewayErrors[t]||"",s=e=>e.gateways.gatewayStatus,l=(e,t)=>{var n=Object(o.listFetchedSelector)(e);return n&&n[t]&&n[t].gateways||r.CachedStatusType.None},c=(e,t)=>{var n=(e=>e.gateways.gateways)(e);return Object(r.denormalize)(n,t)},p=(e,t)=>l(e,t)===r.CachedStatusType.Done,u=e=>e.gateways.fetchGatewaysError,d=(e,t)=>e.gateways.gatewayConnections.has(t),m=e=>e.gateways.fetchGatewayConnectionsError,g=(e,t)=>e.gateways.gatewayConnections.get(t)},7538:function(e,t,n){"use strict";n.r(t),n.d(t,"GatewayStatus",(function(){return r})),n.d(t,"defaultState",(function(){return d})),n.d(t,"reducer",(function(){return m}));var r,o=n(5470),a=n(6867),i=n(2867),s=n(2812),l=n(5471);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(e){e.Online="Online",e.Offline="Offline"}(r||(r={}));var d={gateways:new o.CaseInsensitiveNormalized,fetchGatewaysError:"",fetchGatewayErrors:{},gatewayConnections:Object(i.Map)(),fetchGatewayConnectionsError:""};function m(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,i=arguments.length>1?arguments[1]:void 0;switch(i.type){case a.GatewaysActionTypes.FETCH_GATEWAYS_FULFILLED:t=i.payload.environmentId;var c=i.payload.gateways.map(e=>(e.properties.environment={id:t,name:Object(l.parseId)(t).environments},e));return p(p({},n),{},{gateways:Object(o.updateNormalizedData)(n.gateways,c,i.payload.environmentId),fetchGatewaysError:""});case a.GatewaysActionTypes.FETCH_GATEWAY_FULFILLED:var u=Object(s.assign)(new o.CaseInsensitiveNormalized,n.gateways);t=i.payload.environmentId,(e=i.payload.gateway).properties.environment={id:t,name:Object(l.parseId)(t).environments};var m="Live"===i.payload.gatewayStatus?r.Online:r.Offline;Object(o.add)(u,e);var g=Object(s.assign)({},n.fetchGatewayErrors);return delete g[i.payload.gateway.id],p(p({},n),{},{gateways:u,fetchGatewayErrors:g,gatewayStatus:m});case a.GatewaysActionTypes.FETCH_GATEWAY_REJECTED:return(g=Object(s.assign)({},n.fetchGatewayErrors))[i.payload.gatewayId]=i.payload.error,p(p({},n),{},{fetchGatewayErrors:g});case a.GatewaysActionTypes.DELETE_GATEWAY_FULFILLED:var h=Object(s.assign)(new o.CaseInsensitiveNormalized,n.gateways);return Object(o.removeResourceById)(h,i.payload.gateway.id),p(p({},n),{},{gateways:h});case a.GatewaysActionTypes.FETCH_GATEWAYS_REJECTED:return p(p({},n),{},{fetchGatewaysError:i.payload.error});case a.GatewaysActionTypes.FETCH_GATEWAY_CONNECTIONS_FULFILLED:return Object(s.assign)({},n,{gatewayConnections:n.gatewayConnections.set(i.payload.gatewayId,i.payload.connections),fetchGatewayConnectionsError:""});case a.GatewaysActionTypes.FETCH_GATEWAY_CONNECTIONS_REJECTED:return Object(s.assign)({},n,{fetchGatewayConnectionsError:i.payload.error});default:return n}}},7539:function(e,t,n){"use strict";n.r(t);var r=n(5654);n.d(t,"sampleAppsActions",(function(){return r}));var o=n(7540);n.d(t,"sampleAppsMiddlewares",(function(){return o}));var a=n(7544),i=n(7490);n.d(t,"sampleAppsSelectors",(function(){return i})),t.default=a.reducer},7540:function(e,t,n){"use strict";n.r(t);var r=n(7541);n.d(t,"SampleAppClientRootSaga",(function(){return r.SampleAppClientRootSaga}));var o=n(7542);n.d(t,"SampleAppActionsMiddleware",(function(){return o.SampleAppActionsMiddleware}));var a=n(7543);n.d(t,"SampleAppClientSaga",(function(){return a.default}))},7541:function(e,t,n){"use strict";n.r(t),n.d(t,"SampleAppClientRootSaga",(function(){return a}));var r=n(5749),o=n(7539);function*a(){yield Object(r.all)([Object(r.fork)(o.sampleAppsMiddlewares.SampleAppClientSaga)])}},7542:function(e,t,n){"use strict";n.r(t),n.d(t,"SampleAppActionsMiddleware",(function(){return c}));var r=n(5606),o=n(5604),a=n(5619),i=n(5468),s=n(5654),l=n(1087);function c(e){return t=>n=>c=>{var p,u,d,m,{dispatch:g}=t,h=c,b=r.SagaContextProps.getCurrentEnvironment();switch(h.type){case s.SampleAppsActionTypes.CUSTOMIZE_VALIDATED_SAMPLE_APP:if(!Object(o.canUserCreatePowerApp)(b)){g(i.sharedActions.openUpsellEnvironmentModal({upsellModal:{message:Object(o.getDefaultCreateEnvironmentMessage)(b)}}));break}switch(p=h.payload.sampleApp,u=h.payload.formFactor,d=h.payload.newAppName,u){case a.phone:p.phone&&(m=Object(l.getSampleAppFromTemplateUri)(b.name,p.phone,d),e(m));break;case a.tablet:default:(p.tablet||p.default)&&(m=Object(l.getSampleAppFromTemplateUri)(b.name,p.tablet,d),e(m))}break;case s.SampleAppsActionTypes.OPEN_VALIDATED_APP_FROM_BLANK:if(!Object(o.canUserCreatePowerApp)(b)){g(i.sharedActions.openUpsellEnvironmentModal({upsellModal:{message:Object(o.getDefaultCreateEnvironmentMessage)(b)}}));break}u=h.payload.formFactor,d=h.payload.newAppName,m=Object(l.getAppFromBlankUri)(b.name,u,null,d),g(i.sharedActions.openNewTab({uri:m}))}return n(c)}}},7543:function(e,t,n){"use strict";n.r(t);var r=n(5749),o=n(5760),a=n(5597),i=n(5648),s=n(5794),l=n(5654),c=n(5768),p=["newAppName"],u=["newAppName"];function d(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function*m(e){var t={url:a.sampleAppQueryUrl},n=yield Object(r.call)(o.default,e,t);Object(c.hasResponseError)(n)?yield Object(r.put)(Object(l.fetchSampleAppsRejected)({error:{responseCode:Object(c.getResponseErrorCode)(n),errorMessage:Object(c.getResponseErrorMessage)(n)}})):yield Object(r.put)(Object(l.fetchSampleAppsFulfilled)({sampleApps:n.data.value}))}function*g(e){if(e.payload.newAppName){var t=Object(i.validateAppDisplayNameRequest)({appDisplayName:e.payload.newAppName});(yield Object(r.call)(s.validateAppDisplayNameSaga,t))&&(yield Object(r.put)(Object(l.customizeValidatedSampleApp)(e.payload)),yield Object(r.put)(Object(l.closeSampleAppModal)()))}else{var n=e.payload,{newAppName:o}=n,a=d(n,p);yield Object(r.put)(Object(l.customizeValidatedSampleApp)(a))}}function*h(e){if(e.payload.newAppName){var t=Object(i.validateAppDisplayNameRequest)({appDisplayName:e.payload.newAppName});(yield Object(r.call)(s.validateAppDisplayNameSaga,t))&&(yield Object(r.put)(Object(l.openValidatedAppFromBlank)(e.payload)),yield Object(r.put)(Object(l.closeSampleAppModal)()))}else{var n=e.payload,{newAppName:o}=n,a=d(n,u);yield Object(r.put)(Object(l.openValidatedAppFromBlank)(a))}}t.default=function*(){yield Object(r.takeEvery)(l.SampleAppsActionTypes.FETCH_SAMPLE_APPS_REQUEST,m),yield Object(r.takeLatest)(l.SampleAppsActionTypes.CUSTOMIZE_SAMPLE_APP,g),yield Object(r.takeLatest)(l.SampleAppsActionTypes.OPEN_APP_FROM_BLANK,h)}},7544:function(e,t,n){"use strict";n.r(t),n.d(t,"defaultState",(function(){return s})),n.d(t,"reducer",(function(){return l}));var r=n(5654),o=n(5470),a=n(5659),i=n(2812),s={sampleApps:new o.CaseInsensitiveNormalized,fetchSampleAppsError:void 0,sampleAppType:a.SampleAppType.None,currentOpenSampleAppModal:void 0};function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case r.SampleAppsActionTypes.FETCH_SAMPLE_APPS_FULFILLED:return Object(i.assign)({},e,{sampleApps:new o.CaseInsensitiveNormalized(t.payload.sampleApps),fetchSampleAppsError:void 0});case r.SampleAppsActionTypes.FETCH_SAMPLE_APPS_REJECTED:return Object(i.assign)({},e,{fetchSampleAppsError:t.payload.error});case r.SampleAppsActionTypes.UPDATE_SAMPLE_APP_TYPE:return Object(i.assign)({},e,{sampleAppType:t.payload.sampleAppType});case r.SampleAppsActionTypes.OPEN_SAMPLE_APP_MODAL:return Object(i.assign)({},e,{currentOpenSampleAppModal:t.payload.sampleApp});case r.SampleAppsActionTypes.CLOSE_SAMPLE_APP_MODAL:return Object(i.assign)({},e,{currentOpenSampleAppModal:void 0});default:return e}}},7545:function(e,t,n){"use strict";n.r(t);var r=n(7546);n.d(t,"sampleAppModulesMiddlewares",(function(){return r}));var o=n(7494);n.d(t,"sampleAppModulesActions",(function(){return o}))},7546:function(e,t,n){"use strict";n.r(t);var r=n(7547);n.d(t,"SampleAppModuleActionsMiddleware",(function(){return r.SampleAppModuleActionsMiddleware}))},7547:function(e,t,n){"use strict";n.r(t),n.d(t,"SampleAppModuleActionsMiddleware",(function(){return d}));var r=n(5606),o=n(5604),a=n(5478),i=n(5876),s=n(2869),l=n(5630),c=n(1086),p=n(5468),u=n(7494);function d(){return e=>t=>n=>{var a,{dispatch:i}=e,s=n,l=r.SagaContextProps.getCurrentEnvironment(),d=o.getCrmInstanceUrl(l);switch(s.type){case u.SampleAppModulesActionTypes.PLAY_SAMPLE_APPMODULE:a=s.payload.appModuleId,!m(i,l)&&d&&a&&i(p.sharedActions.openNewTab({uri:c.getPlayAppModuleUrl(d,a)}));break;case u.SampleAppModulesActionTypes.EDIT_SAMPLE_APPMODULE:a=s.payload.appModuleId,!m(i,l)&&d&&a&&i(p.sharedActions.openNewTab({uri:c.getAppModuleDesignerUrl(d,a)}))}return t(n)}}function m(e,t){var n=o.environmentHasCds2Database(t),r=o.isDatabaseInProvisioningState(t),c=o.canUserCreateDatabase(t),u=Object(s.getResources)();if(r)e(p.sharedActions.openAlertDialog({message:u.Model.Home.SampleApps.DatabaseProvisioning.message}));else if(n||c){if(n||!c)return!1;e(p.sharedActions.openConfirmDialog({hidden:!1,title:u.Model.Home.SampleApps.NoDatabase.title,subText:u.Model.Home.SampleApps.NoDatabase.message,confirmButtonText:u.Controllers.Environments.Create.Database.create,cancelButtonText:u.Controllers.Properties.okButton,onConfirm:()=>{e(Object(l.logAction)(p.sharedActions.panelOpen({panelType:a.PanelToShowType.CreateXrmDatabasePanel,panelProps:null}),i.CreateXrmDatabasePanelEvents.CreatePanelOpened.eventName)),e(p.sharedActions.closeConfirmDialog())},hideCancelButton:!1}))}else e(p.sharedActions.openConfirmDialog({hidden:!1,title:u.Model.Home.SampleApps.NoPermissionsForDatabase.title,subText:u.Model.Home.SampleApps.NoPermissionsForDatabase.message,confirmButtonText:u.MakerDashboard.CreateEnvironment.text,cancelButtonText:u.Controllers.Properties.okButton,onConfirm:()=>{e(Object(l.logAction)(p.sharedActions.panelOpen({panelType:a.PanelToShowType.CreateEnvironmentPanel,panelProps:null}),i.CreateEnvironmentPanelEvents.CreatePanelOpened.eventName)),e(p.sharedActions.closeConfirmDialog())},hideCancelButton:!1}));return!0}},7548:function(e,t,n){"use strict";n.r(t);var r=n(6603);n.d(t,"solutionCheckerResultsActions",(function(){return r}));var o=n(7549);n.d(t,"solutionCheckerResultsMiddleware",(function(){return o}));var a=n(7553),i=n(6602);n.d(t,"solutionCheckerResultsSelectors",(function(){return i})),t.default=a.reducer},7549:function(e,t,n){"use strict";n.r(t);var r=n(7550);n.d(t,"SolutionCheckerResultsClientRootSaga",(function(){return r.SolutionCheckerResultsClientRootSaga}));var o=n(7551);n.d(t,"SolutionCheckerResultsClientSaga",(function(){return o.default}));var a=n(7552);n.d(t,"SolutionCheckerResultsActionsMiddleware",(function(){return a.SolutionCheckerResultsActionsMiddleware}))},7550:function(e,t,n){"use strict";n.r(t),n.d(t,"SolutionCheckerResultsClientRootSaga",(function(){return a}));var r=n(5749),o=n(7548);function*a(){yield Object(r.all)([Object(r.fork)(o.solutionCheckerResultsMiddleware.SolutionCheckerResultsClientSaga)])}},7551:function(e,t,n){"use strict";n.r(t);var r=n(5749),o=n(5606),a=n(5760),i=n(5597),s=n(2868),l=n(2891),c=n(6603),p=n(5768);function*u(e){var t=o.SagaContextProps.getCurrentEnvironment();try{var n=yield s.MetadataClientInstance.getInstance(),a=i.solutionCheckerAnalysisResultsFetchXml.replace(/{REPLACE_MSDYN_ANALYSIS_CREATED_ON}/g,e.payload.createdOn.toISOString()).replace("{REPLACE_MSDYN_ANALYSIS_COMPONENTID}",e.payload.solutionId),l=(yield n.retrieveFetchXmlResults({EntitySetName:"msdyn_analysisresults",fetchXml:a},{scenarioName:s.MCLTelemetryEventsMap.PAPortalPrefix})).value;yield Object(r.put)(Object(c.fetchSolutionCheckerRulesRequest)({environmentId:t.id})),yield Object(r.put)(Object(c.fetchSolutionCheckerResultsFulfilled)({environmentId:t.id,solutionCheckerResults:l}))}catch(u){yield Object(r.put)(Object(c.fetchSolutionCheckerResultsRejected)({environmentId:t.id,error:Object(p.getResponseErrorMessage)(u)}))}}function*d(e){var t=o.SagaContextProps.getCurrentEnvironment();try{var n={url:i.solutionCheckerRulesUrl,data:"",method:"GET",headers:{"Content-Type":"application/json","Accept-Language":Object(l.getCurrentLocale)()}},s=yield Object(r.call)(a.default,e,n,null),u=s.data;if(!u)return null;Object(p.hasResponseError)(s)?yield Object(r.put)(Object(c.fetchSolutionCheckerRulesRejected)({error:Object(p.getResponseErrorMessage)(s),environmentId:t.id})):yield Object(r.put)(Object(c.fetchSolutionCheckerRulesFulfilled)({solutionCheckerRules:u,environmentId:t.id}))}catch(d){yield Object(r.put)(Object(c.fetchSolutionCheckerRulesRejected)({error:d,environmentId:t.id}))}}t.default=function*(){yield Object(r.takeEvery)(c.SolutionCheckerResultsActionTypes.FETCH_SOLUTION_CHECKER_RESULTS_REQUEST,u),yield Object(r.takeEvery)(c.SolutionCheckerResultsActionTypes.FETCH_SOLUTION_CHECKER_RULES_REQUEST,d)}},7552:function(e,t,n){"use strict";n.r(t),n.d(t,"SolutionCheckerResultsActionsMiddleware",(function(){return i}));var r=n(5478),o=n(5468),a=n(6603);function i(){return e=>t=>n=>{var{dispatch:i}=e,s=n;switch(s.type){case a.SolutionCheckerResultsActionTypes.OPEN_SOLUTION_CHECKER_RESULTS_FILTER_PANEL:i(o.sharedActions.panelOpen({panelType:r.PanelToShowType.SolutionCheckerViewResultsFilterPanel}));break;case a.SolutionCheckerResultsActionTypes.OPEN_SOLUTION_CHECKER_RESULT_DETAIL_PANEL:i(o.sharedActions.panelOpen({panelType:r.PanelToShowType.SolutionCheckerViewResultDetailPanel,panelProps:{solutionCheckerResultDetail:s.payload.solutionCheckerResult}}))}return t(n)}}},7553:function(e,t,n){"use strict";n.r(t),n.d(t,"defaultState",(function(){return u})),n.d(t,"reducer",(function(){return d})),n.d(t,"generateSolutionCheckerViewSet",(function(){return m}));var r=n(2867),o=n(6598),a=n(6597),i=n(6603),s=n(2812);function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){p(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var u={solutionCheckerResults:Object(r.Map)(),solutionCheckerViewSets:Object(r.Map)(),solutionCheckerResultsApiStatus:Object(r.Map)(),solutionCheckerResultDetail:null,solutionCheckerRules:Object(r.Map)()};function d(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u,t=arguments.length>1?arguments[1]:void 0,n=null;switch(t.type){case i.SolutionCheckerResultsActionTypes.FETCH_SOLUTION_CHECKER_RESULTS_REQUEST:return c(c({},e),{},{solutionCheckerResultsApiStatus:e.solutionCheckerResultsApiStatus.set(t.payload.environmentId,{loading:!0,success:!1,failed:!1,message:""})});case i.SolutionCheckerResultsActionTypes.FETCH_SOLUTIONS_CHECKER_RESULTS_REJECTED:return c(c({},e),{},{solutionCheckerResultsApiStatus:e.solutionCheckerResultsApiStatus.set(t.payload.environmentId,{loading:!1,success:!1,failed:!0,message:t.payload.error})});case i.SolutionCheckerResultsActionTypes.FETCH_SOLUTIONS_CHECKER_RESULTS_FULFILLED:return c(c({},e),{},{solutionCheckerResults:e.solutionCheckerResults.set(t.payload.environmentId,t.payload.solutionCheckerResults),solutionCheckerViewSets:e.solutionCheckerViewSets.set(t.payload.environmentId,m(t.payload.solutionCheckerResults,o.SolutionCheckerResultsGroupingOptions.ByLocation)),solutionCheckerResultsApiStatus:e.solutionCheckerResultsApiStatus.set(t.payload.environmentId,{loading:!1,success:!0,failed:!1,message:""})});case i.SolutionCheckerResultsActionTypes.CHANGE_GROUPING_SOLUTION_CHECKER_RESULTS:return c(c({},e),{},{solutionCheckerViewSets:e.solutionCheckerViewSets.set(t.payload.environmentId,m(e.solutionCheckerResults.get(t.payload.environmentId),t.payload.groupingOption)),solutionCheckerResultsApiStatus:e.solutionCheckerResultsApiStatus.set(t.payload.environmentId,{loading:!1,success:!0,failed:!1,message:""})});case i.SolutionCheckerResultsActionTypes.OPEN_SOLUTION_CHECKER_RESULT_DETAIL_PANEL:return c(c({},e),{},{solutionCheckerResultDetail:t.payload.solutionCheckerResult});case i.SolutionCheckerResultsActionTypes.FETCH_SOLUTION_CHECKER_RULES_REQUEST:return c(c({},e),{},{solutionCheckerResultsApiStatus:e.solutionCheckerResultsApiStatus.set(t.payload.environmentId,{loading:!0,success:!1,failed:!1,message:""})});case i.SolutionCheckerResultsActionTypes.FETCH_SOLUTIONS_CHECKER_RULES_REJECTED:return c(c({},e),{},{solutionCheckerResultsApiStatus:e.solutionCheckerResultsApiStatus.set(t.payload.environmentId,{loading:!1,success:!1,failed:!0,message:t.payload.error})});case i.SolutionCheckerResultsActionTypes.FETCH_SOLUTIONS_CHECKER_RULES_FULFILLED:return c(c({},e),{},{solutionCheckerRules:e.solutionCheckerRules.set(t.payload.environmentId,t.payload.solutionCheckerRules),solutionCheckerResultsApiStatus:e.solutionCheckerResultsApiStatus.set(t.payload.environmentId,{loading:!1,success:!0,failed:!1,message:""})});case i.SolutionCheckerResultsActionTypes.FILTER_SOLUTION_CHECKER_RESULT_REQUEST:var r=e.solutionCheckerViewSets.get(t.payload.environmentId),a=r.columnGroups.get(t.payload.columnName),s=a.find(e=>e.value===t.payload.columnValue);return s&&(s.isChecked=t.payload.checked),r.columnGroups=r.columnGroups.set(t.payload.columnName,a),c(c({},e),{},{solutionCheckerViewSets:e.solutionCheckerViewSets.set(t.payload.environmentId,m(e.solutionCheckerResults.get(t.payload.environmentId),r.groupingOption,r.columnGroups,r.searchString))});case i.SolutionCheckerResultsActionTypes.CLEAR_FILTER_SOLUTION_CHECKER_RESULT_REQUEST:return c(c({},e),{},{solutionCheckerViewSets:e.solutionCheckerViewSets.set(t.payload.environmentId,m(e.solutionCheckerResults.get(t.payload.environmentId),e.solutionCheckerViewSets.get(t.payload.environmentId).groupingOption)),solutionCheckerResultsApiStatus:e.solutionCheckerResultsApiStatus.set(t.payload.environmentId,{loading:!1,success:!0,failed:!1,message:""})});case i.SolutionCheckerResultsActionTypes.SEARCH_FILTER_SOLUTION_CHECKER_RESULT:return n=e.solutionCheckerViewSets.get(t.payload.environmentId),c(c({},e),{},{solutionCheckerViewSets:e.solutionCheckerViewSets.set(t.payload.environmentId,m(e.solutionCheckerResults.get(t.payload.environmentId),n.groupingOption,n.columnGroups,t.payload.searchString)),solutionCheckerResultsApiStatus:e.solutionCheckerResultsApiStatus.set(t.payload.environmentId,{loading:!1,success:!0,failed:!1,message:""})});case i.SolutionCheckerResultsActionTypes.CLEAR_SEARCH_FILTER_SOLUTION_CHECKER_RESULT:return n=e.solutionCheckerViewSets.get(t.payload.environmentId),c(c({},e),{},{solutionCheckerViewSets:e.solutionCheckerViewSets.set(t.payload.environmentId,m(e.solutionCheckerResults.get(t.payload.environmentId),n.groupingOption,n.columnGroups)),solutionCheckerResultsApiStatus:e.solutionCheckerResultsApiStatus.set(t.payload.environmentId,{loading:!1,success:!0,failed:!1,message:""})});case i.SolutionCheckerResultsActionTypes.ORDER_SOLUTION_CHECKER_RESULTS_CLIENT_SIDE:return n=e.solutionCheckerViewSets.get(t.payload.environmentId),c(c({},e),{},{solutionCheckerViewSets:e.solutionCheckerViewSets.set(t.payload.environmentId,m(e.solutionCheckerResults.get(t.payload.environmentId),n.groupingOption,n.columnGroups,n.searchString,{propertyName:t.payload.orderBy.column,isDescending:"desc"===t.payload.orderBy.order})),solutionCheckerResultsApiStatus:e.solutionCheckerResultsApiStatus.set(t.payload.environmentId,{loading:!1,success:!0,failed:!1,message:""})});default:return e}}function m(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=[];s=e.map((e,t)=>t),s=h(e,s,n,o);var l=Object(a.getSortingOrderPropertyList)(t,i);s=s.sort((t,n)=>Object(a.iterativeCompare)(e[t],e[n],l));var c=Object(a.getGroupingPropertyList)(t),p=Object(a.groupSolutionCheckerResults)(s,e,c.map(e=>e.propertyName)),u=null;return u=n||Object(r.Map)().withMutations(t=>{a.groupingColumnsList.forEach(n=>{t=t.set(n,g(e,n))})}),{groupingOption:t,resultGroups:p,resultIndex:s,resultCount:s?s.length:0,columnGroups:u,searchString:o}}function g(e,t){return s.uniqWith(e,(e,n)=>e[t]===n[t]).map(e=>({value:e[t]?e[t].toString():"",isChecked:!1}))}function h(e,t,n,o){var i=null,s=0;n&&(i=Object(r.Map)().withMutations(e=>{n.forEach((t,n)=>{var r=t.filter(e=>e.isChecked);r&&r.length>0&&(e=e.set(n,r),s++)})}));var l=s>0,c=!!o;return l||c?t.filter(t=>(!l||function(e,t){var n=!0;return t.forEach((t,r)=>{n=n&&t.some(t=>t.isChecked&&(e[r]&&e[r].toString()===t.value||!e[r]&&""===t.value))}),n}(e[t],i))&&(!c||function(e,t){var n=e=>e&&e.toLocaleLowerCase().indexOf(t)>-1;return n(Object(a.getSolutionCheckerResultPropertyValueAsString)("msdyn_category",e))||n(Object(a.getSolutionCheckerResultPropertyValueAsString)("msdyn_severity",e))||n(Object(a.getSolutionCheckerResultPropertyValueAsString)("msdyn_componenttype",e))||n(Object(a.getSolutionCheckerResultPropertyValueAsString)("msdyn_fileuri",e))||n(Object(a.getSolutionCheckerResultPropertyValueAsString)("msdyn_ruleid",e))||n(Object(a.getSolutionCheckerResultPropertyValueAsString)("msdyn_message",e))}(e[t],o))):t}},7554:function(e,t,n){"use strict";n.r(t),n.d(t,"FireReduxActionEventName",(function(){return i})),n.d(t,"AppStore",(function(){return s}));var r=n(7555),o=n(7558),a=n(7589),i="FireReduxAction";class s{static Store(e,t){return s.store||(s.sagaMiddleware=Object(r.default)(),e.push(s.sagaMiddleware),s.store=Object(o.default)(e,t),s.sagaMiddleware.run(a.default)),s.store}static hasStore(){return!!s.store}static dispatchAction(e){s.hasStore()&&s.store.dispatch(e)}}s.store=void 0,s.sagaMiddleware=void 0},7558:function(e,t,n){"use strict";n.r(t);var r=n(5446),o=n(7559),a=n(7560),i=Object(r.combineReducers)({apis:a.apis,apps:a.apps,connections:a.connections,gateways:a.gateways,learn:a.learn,sampleApps:a.sampleApps,solutions:a.solutions,solutionComponents:a.solutionComponents,shared:a.shared,resources:a.resources,sharedata:a.sharedata,apiCallResponse:a.apiCallResponse,envVariableData:a.envVariableData,solutionCheckerResults:a.solutionCheckerResults,powerPortalApps:a.powerPortalApps,flows:a.flows,dataflows:a.dataflows,connectionReferencesData:a.connectionReferencesData,powerBIEntities:a.powerBIEntities});t.default=(e,t)=>Object(r.createStore)(i,t,Object(o.composeWithDevTools)(Object(r.applyMiddleware)(...e)))},7560:function(e,t,n){"use strict";n.r(t);var r=n(5468);n.d(t,"shared",(function(){return r.default}));var o=n(7524);n.d(t,"apis",(function(){return o.default}));var a=n(5981);n.d(t,"apps",(function(){return a.default}));var i=n(7509);n.d(t,"connections",(function(){return i.default}));var s=n(7529);n.d(t,"gateways",(function(){return s.default}));var l=n(7561);n.d(t,"learn",(function(){return l.default}));var c=n(7539);n.d(t,"sampleApps",(function(){return c.default}));var p=n(5746);n.d(t,"solutions",(function(){return p.default}));var u=n(5787);n.d(t,"solutionComponents",(function(){return u.default}));var d=n(6024);n.d(t,"resources",(function(){return d.default}));var m=n(6355);n.d(t,"sharedata",(function(){return m.default}));var g=n(7568);n.d(t,"apiCallResponse",(function(){return g.default}));var h=n(6657);n.d(t,"envVariableData",(function(){return h.default}));var b=n(7548);n.d(t,"solutionCheckerResults",(function(){return b.default}));var f=n(6541);n.d(t,"powerPortalApps",(function(){return f.default}));var y=n(7570);n.d(t,"flows",(function(){return y.default}));var S=n(7574);n.d(t,"dataflows",(function(){return S.default}));var C=n(7578);n.d(t,"connectionReferencesData",(function(){return C.default}));var v=n(7584);n.d(t,"powerBIEntities",(function(){return v.default}))},7561:function(e,t,n){"use strict";n.r(t);var r=n(7562);n.d(t,"learnActions",(function(){return r}));var o=n(7563);n.d(t,"learnMiddlewares",(function(){return o}));var a=n(7566),i=n(7567);n.d(t,"learnSelectors",(function(){return i})),t.default=a.reducer},7562:function(e,t,n){"use strict";function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var a;function i(e){var t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({pollOptions:{shouldPoll:!1,pollStopAction:c()}},e);return{type:a.FETCH_BLOGS_REQUEST,payload:t}}function s(e){return{type:a.FETCH_BLOGS_FULFILLED,payload:e}}function l(e){return{type:a.FETCH_BLOGS_REJECTED,payload:e}}function c(){return{type:a.FETCH_BLOGS_CANCEL_POLL}}n.r(t),n.d(t,"LearnActionTypes",(function(){return a})),n.d(t,"fetchBlogsRequest",(function(){return i})),n.d(t,"fetchBlogsFulfilled",(function(){return s})),n.d(t,"fetchBlogsRejected",(function(){return l})),n.d(t,"fetchBlogsCancelPoll",(function(){return c})),function(e){e.FETCH_BLOGS_REQUEST="maker/learn/FETCH_BLOGS_REQUEST",e.FETCH_BLOGS_FULFILLED="maker/learn/FETCH_BLOGS_FULFILLED",e.FETCH_BLOGS_REJECTED="maker/learn/FETCH_BLOGS_REJECTED",e.FETCH_BLOGS_CANCEL_POLL="maker/learn/FETCH_BLOGS_CANCEL_POLL"}(a||(a={}))},7563:function(e,t,n){"use strict";n.r(t);var r=n(7564);n.d(t,"LearnActionsRootSaga",(function(){return r.LearnActionsRootSaga}));var o=n(7565);n.d(t,"LearnActionsSaga",(function(){return o.default}))},7564:function(e,t,n){"use strict";n.r(t),n.d(t,"LearnActionsRootSaga",(function(){return a}));var r=n(5749),o=n(7561);function*a(){yield Object(r.all)([Object(r.fork)(o.learnMiddlewares.LearnActionsSaga)])}},7565:function(e,t,n){"use strict";n.r(t);var r=n(5749),o=n(5760),a=n(7562);function*i(e){var t=yield Object(r.call)(o.default,e,{url:"https://powerapps.microsoft.com/en-us/blog/feed/",responseType:"text"});if(t.data){var n=[],i=(new DOMParser).parseFromString(t.data,"text/xml"),s=Array.from(i.querySelectorAll("item"));s.forEach(e=>{var t="";e.querySelector("pubDate").textContent.match("\\d{2}.\\w+.\\d{4}")&&(t=e.querySelector("pubDate").textContent.match("\\d{2}.\\w+.\\d{4}")[0]),n.push({Title:e.querySelector("title").textContent||"",Date:t,URL:e.querySelector("link").textContent||"",Description:e.querySelector("description").textContent||""})}),yield Object(r.put)(Object(a.fetchBlogsFulfilled)({blogs:n}))}else yield Object(r.put)(Object(a.fetchBlogsRejected)({error:t.error}))}t.default=function*(){yield Object(r.takeEvery)(a.LearnActionTypes.FETCH_BLOGS_REQUEST,i)}},7566:function(e,t,n){"use strict";n.r(t),n.d(t,"defaultState",(function(){return a})),n.d(t,"reducer",(function(){return i}));var r=n(7562),o=n(2812),a={blogs:[],error:"",isBlogsFetching:!0};function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case r.LearnActionTypes.FETCH_BLOGS_REQUEST:return Object(o.assign)({},e,{isBlogsFetching:!0});case r.LearnActionTypes.FETCH_BLOGS_FULFILLED:return Object(o.assign)({},e,{blogs:t.payload.blogs,error:"",isBlogsFetching:!1});case r.LearnActionTypes.FETCH_BLOGS_REJECTED:return Object(o.assign)({},e,{error:t.payload.error,isBlogsFetching:!1});default:return e}}},7567:function(e,t,n){"use strict";n.r(t),n.d(t,"blogsSelector",(function(){return r})),n.d(t,"blogsListErrorSelector",(function(){return o})),n.d(t,"blogsListIsFetchingSelector",(function(){return a}));var r=e=>e.learn.blogs,o=e=>e.learn.error,a=e=>e.learn.isBlogsFetching},7568:function(e,t,n){"use strict";n.r(t);var r=n(5767);n.d(t,"apiCallActions",(function(){return r}));var o=n(7569),a=n(6470);n.d(t,"apiCallSelectors",(function(){return a})),t.default=o.reducer},7569:function(e,t,n){"use strict";n.r(t),n.d(t,"defaultState",(function(){return l})),n.d(t,"reducer",(function(){return c}));var r=n(5767),o=n(2867);function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var l={ApiCallResponses:Object(o.Map)()};function c(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,t=arguments.length>1?arguments[1]:void 0;if(t.type===r.ApiCallActionTypes.API_CALL_LOADING)return i(i({},e),{},{ApiCallResponses:e.ApiCallResponses.set(t.payload.apiCall,{loading:!0,succeeded:!1,failed:!1,message:""})});if(t.type===r.ApiCallActionTypes.API_CALL_FINISHED){var n=t.payload;return i(i({},e),{},{ApiCallResponses:e.ApiCallResponses.set(n.apiCall,{loading:!1,succeeded:n.success,failed:!n.success,message:n.response})})}if(t.type===r.ApiCallActionTypes.API_CALL_CLEAR){var o=e.ApiCallResponses.withMutations(e=>{for(var n of t.payload.apiCalls)e.delete(n)});return i(i({},e),{},{ApiCallResponses:o})}return e}},7570:function(e,t,n){"use strict";n.r(t);var r=n(5801);n.d(t,"flowsActions",(function(){return r}));var o=n(7571);n.d(t,"flowsMiddlewares",(function(){return o}));var a=n(7573),i=n(5812);n.d(t,"flowsSelectors",(function(){return i})),t.default=a.reducer},7571:function(e,t,n){"use strict";n.r(t);var r=n(7572);n.d(t,"FlowsActionsRootSaga",(function(){return r.FlowsActionsRootSaga}));var o=n(5800);n.d(t,"FlowsActionsSaga",(function(){return o.default}))},7572:function(e,t,n){"use strict";n.r(t),n.d(t,"FlowsActionsRootSaga",(function(){return a}));var r=n(5749),o=n(7570);function*a(){yield Object(r.all)([Object(r.fork)(o.flowsMiddlewares.FlowsActionsSaga)])}},7573:function(e,t,n){"use strict";n.r(t),n.d(t,"defaultState",(function(){return p})),n.d(t,"reducer",(function(){return u}));var r=n(5470),o=n(5801),a=n(2807),i=n(217);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var p={personal:{flows:new r.CaseInsensitiveNormalized,flowsResponseStatus:{failed:!1,success:!1,loading:!0,message:""}},team:{flows:new r.CaseInsensitiveNormalized,flowsResponseStatus:{failed:!1,success:!1,loading:!0,message:""}},fetchFlowsError:""};function u(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case o.FlowsActionTypes.FETCH_FLOWS_REQUEST:return e={failed:!1,success:!1,loading:!0,message:""},Object(i.trackInfoTrace)(a.PortalScope,{eventName:n.type,eventData:{flowsResponseStatus:e}}),l(l({},t),{},{personal:{flows:t.personal.flows,flowsResponseStatus:e},team:{flows:t.team.flows,flowsResponseStatus:e}});case o.FlowsActionTypes.FETCH_FLOWS_FULFILLED:var s=null;switch(n.payload.flowType===o.FlowType.personal&&(s=n.payload.environmentId),e={failed:!1,success:!0,loading:!1,message:""},Object(i.trackInfoTrace)(a.PortalScope,{eventName:n.type,eventData:{flowType:n.payload.flowType,flowsResponseStatus:e}}),n.payload.flowType){case o.FlowType.personal:default:return l(l({},t),{},{personal:{flows:Object(r.updateNormalizedData)(t.personal.flows,n.payload.flowsList.personal.flows,s),flowsResponseStatus:e},fetchFlowsError:""});case o.FlowType.team:return l(l({},t),{},{team:{flows:Object(r.updateNormalizedData)(t.team.flows,n.payload.flowsList.team.flows,s),flowsResponseStatus:e},fetchFlowsError:""})}case o.FlowsActionTypes.FETCH_FLOWS_REJECTED:switch(e={failed:!0,success:!1,loading:!1,message:n.payload.error},Object(i.trackInfoTrace)(a.PortalScope,{eventName:n.type,eventData:{flowType:n.payload.flowType,flowsResponseStatus:e}}),n.payload.flowType){case o.FlowType.personal:default:return l(l({},t),{},{personal:{flows:t.personal.flows,flowsResponseStatus:e},fetchFlowsError:n.payload.error});case o.FlowType.team:return l(l({},t),{},{team:{flows:t.team.flows,flowsResponseStatus:e},fetchFlowsError:n.payload.error})}default:return t}}},7574:function(e,t,n){"use strict";n.r(t);var r=n(5698);n.d(t,"dataflowsActions",(function(){return r}));var o=n(7575);n.d(t,"dataflowsMiddlewares",(function(){return o}));var a=n(7577),i=n(5624);n.d(t,"dataflowsSelectors",(function(){return i})),t.default=a.reducer},7575:function(e,t,n){"use strict";n.r(t);var r=n(7576);n.d(t,"DataflowsActionsRootSaga",(function(){return r.DataflowsActionsRootSaga}));var o=n(5817);n.d(t,"DataflowsActionsSaga",(function(){return o.default}))},7576:function(e,t,n){"use strict";n.r(t),n.d(t,"DataflowsActionsRootSaga",(function(){return a}));var r=n(5749),o=n(5817);function*a(){yield Object(r.all)([Object(r.fork)(o.default)])}},7577:function(e,t,n){"use strict";n.r(t),n.d(t,"defaultState",(function(){return l})),n.d(t,"reducer",(function(){return c}));var r=n(5470),o=n(5698);function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var l={dataflows:new r.CaseInsensitiveNormalized,dataflowsResponseStatus:{failed:!1,success:!1,loading:!0,message:""},fetchDataflowsError:""};function c(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,t=arguments.length>1?arguments[1]:void 0,n=new r.CaseInsensitiveNormalized;switch(t.type){case o.DataflowsActionTypes.FETCH_DATAFLOWS_REQUEST:return i(i({},e),{},{dataflows:e.dataflows,dataflowsResponseStatus:{failed:!1,success:!1,loading:!0,message:""}});case o.DataflowsActionTypes.FETCH_DATAFLOWS_FULFILLED:return Object(r.addAll)(n,t.payload.dataflows),i(i({},e),{},{dataflows:n,dataflowsResponseStatus:{failed:!1,success:!0,loading:!1,message:""},fetchDataflowsError:""});case o.DataflowsActionTypes.FETCH_DATAFLOWS_REJECTED:return i(i({},e),{},{dataflows:e.dataflows,dataflowsResponseStatus:{failed:!0,success:!1,loading:!1,message:t.payload.error},fetchDataflowsError:t.payload.error});default:return e}}t.default=c},7578:function(e,t,n){"use strict";n.r(t);var r=n(5704);n.d(t,"connectionReferenceActions",(function(){return r}));var o=n(7579);n.d(t,"connectionReferenceMiddlewares",(function(){return o}));var a=n(7582),i=n(6383);n.d(t,"connectionReferenceSelectors",(function(){return i})),t.default=a.reducer},7579:function(e,t,n){"use strict";n.r(t);var r=n(7580);n.d(t,"ConnectionReferenceRootSaga",(function(){return r.ConnectionReferenceRootSaga}));var o=n(7581);n.d(t,"ConnectionReferencesSaga",(function(){return o.default}))},7580:function(e,t,n){"use strict";n.r(t),n.d(t,"ConnectionReferenceRootSaga",(function(){return a}));var r=n(5749),o=n(7579);function*a(){yield Object(r.all)([Object(r.fork)(o.ConnectionReferencesSaga)])}},7582:function(e,t,n){"use strict";n.r(t),n.d(t,"defaultState",(function(){return c})),n.d(t,"reducer",(function(){return p})),n.d(t,"getCurrentValueMappingKey",(function(){return u}));var r=n(2812),o=n(5704),a=n(7583);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var c={connectionReferences:new Map,fetchValuesResponse:{loading:!1,success:!1,warning:!1,failed:!1,message:""},createResponse:{loading:!1,success:!1,warning:!1,failed:!1,message:""},modifyResponse:{loading:!1,success:!1,warning:!1,failed:!1,message:""},batchModifyResponse:{loading:!1,success:!1,warning:!1,failed:!1,message:""},modifiedConnectionReferences:[],conRefsNeedUpdate:[]};function p(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case o.ConRefVariableActionTypes.CREATE_CONNECTION_REFERENCE:return s(s({},e),{},{createResponse:{message:"",success:!1,warning:!1,failed:!1,loading:!0}});case o.ConRefVariableActionTypes.CREATE_CONNECTION_REFERENCE_SUCCEEDED:return s(s({},e),{},{createResponse:{message:t.payload.response,success:!0,warning:!1,failed:!1,loading:!1}});case o.ConRefVariableActionTypes.CREATE_CONNECTION_REFERENCE_FAILED:return s(s({},e),{},{createResponse:{message:t.payload.response,success:!1,warning:!1,failed:!0,loading:!1}});case o.ConRefVariableActionTypes.CREATE_CONNECTION_REFERENCE_CLEAR:return s(s({},e),{},{createResponse:{message:"",success:!1,warning:!1,failed:!1,loading:!1}});case o.ConRefVariableActionTypes.FETCH_CONNECTION_REFERENCE_DATA:return Object(r.assign)({},e,s(s({},e),{},{fetchValuesResponse:{message:"",success:!1,warning:!1,failed:!1,loading:!0}}));case o.ConRefVariableActionTypes.FETCH_CONNECTION_REFERENCE_DATA_FINISHED:var n=e.connectionReferences,i=[];return t.payload.connectionReferencesData.forEach(e=>{n=n.set(e.connectionreferenceid,e),r.isEmpty(e.connectionid)&&i.push(e)}),Object(r.assign)({},e,s(s({},e),{},{connectionReferencesData:n,fetchValuesResponse:{message:t.payload.error,success:!t.payload.error,failed:!!t.payload.error,loading:!1},conRefsNeedUpdate:i}));case o.ConRefVariableActionTypes.FETCH_CONNECTION_REFERENCE_DATA_CLEAR:return Object(r.assign)({},e,s(s({},e),{},{fetchValuesResponse:{message:"",success:!1,warning:!1,failed:!1,loading:!1}}));case o.ConRefVariableActionTypes.MODIFY_CONNECTION_REFERENCE:return s(s({},e),{},{modifyResponse:{message:"",success:!1,warning:!1,failed:!1,loading:!0}});case o.ConRefVariableActionTypes.BATCH_MODIFY_CONNECTION_REFERENCE:return s(s({},e),{},{batchModifyResponse:{message:"",success:!1,warning:!1,failed:!1,loading:!0}});case o.ConRefVariableActionTypes.BATCH_MODIFY_CONNECTION_REFERENCE_SUCCEEDED:return s(s({},e),{},{batchModifyResponse:{message:"",success:!0,warning:!1,failed:!1,loading:!1}});case o.ConRefVariableActionTypes.BATCH_MODIFY_CONNECTION_REFERENCE_FAILED:return s(s({},e),{},{batchModifyResponse:{message:t.payload.response,success:!1,warning:!1,failed:!0,loading:!1}});case o.ConRefVariableActionTypes.MODIFY_CONNECTION_REFERENCE_SUCCEEDED:return Object(a.addUpdatedConnectionReference)(t.payload.connectionReference),s(s({},e),{},{modifyResponse:{message:"",success:!0,warning:!1,failed:!1,loading:!1},modifiedConnectionReferences:[t.payload.connectionReference,...e.modifiedConnectionReferences.filter(e=>e.connectionreferenceid!=t.payload.connectionReference.connectionreferenceid)]});case o.ConRefVariableActionTypes.MODIFY_CONNECTION_REFERENCE_FAILED:return s(s({},e),{},{modifyResponse:{message:t.payload.response,success:!1,warning:!1,failed:!0,loading:!1}});case o.ConRefVariableActionTypes.MODIFY_CONNECTION_REFERENCE_CLEAR:return s(s({},e),{},{modifyResponse:{message:"",success:!1,warning:!1,failed:!1,loading:!1}});case o.ConRefVariableActionTypes.MODIFIED_CONNECTION_REFERENCE_CLEAR:return s(s({},e),{},{modifiedConnectionReferences:e.modifiedConnectionReferences.filter(e=>e.connectionreferenceid!=t.payload.connectionReferenceId)});default:return e}}function u(e,t){return"".concat(e,":").concat(t)}},7583:function(e,t,n){"use strict";n.r(t),n.d(t,"addUpdatedConnectionReference",(function(){return a})),n.d(t,"removeUpdatedConnectionReference",(function(){return i})),n.d(t,"getUpdatedConnectionReferences",(function(){return s}));var r=n(1077),o="TrackedUpdatedConnectionReferences";function a(e){var t=r.StorageHelper.transient.getItem(o),n=t?JSON.parse(t):[],a=n.findIndex(t=>t.connectionreferenceid===e.connectionreferenceid);a>=0?n.splice(a,1,e):n.push(e),r.StorageHelper.transient.setItem(o,JSON.stringify(n))}function i(e){var t=r.StorageHelper.transient.getItem(o),n=t?JSON.parse(t):[],a=n.findIndex(t=>t.connectionreferenceid===e.connectionreferenceid);a>=0&&n.splice(a,1),r.StorageHelper.transient.setItem(o,JSON.stringify(n))}function s(){var e=r.StorageHelper.transient.getItem(o);return e?JSON.parse(e):[]}},7584:function(e,t,n){"use strict";n.r(t);var r=n(5706);n.d(t,"powerBIEntitiesActions",(function(){return r}));var o=n(7585);n.d(t,"powerBIEntitiesMiddlewares",(function(){return o}));var a=n(7588),i=n(5707);n.d(t,"powerBIEntitiesSelectors",(function(){return i})),t.default=a.reducer},7585:function(e,t,n){"use strict";n.r(t);var r=n(7586);n.d(t,"PowerBIEntitiesActionsRootSaga",(function(){return r.PowerBIEntitiesActionsRootSaga}));var o=n(7587);n.d(t,"PowerBIEntitiesActionsSaga",(function(){return o.default}))},7586:function(e,t,n){"use strict";n.r(t),n.d(t,"PowerBIEntitiesActionsRootSaga",(function(){return a}));var r=n(5749),o=n(7587);function*a(){yield Object(r.all)([Object(r.fork)(o.default)])}},7587:function(e,t,n){"use strict";n.r(t),n.d(t,"fetchPowerBIGroupsListSaga",(function(){return c})),n.d(t,"fetchPowerBIReportsListSaga",(function(){return p})),n.d(t,"fetchPowerBIDatasetsListSaga",(function(){return u}));var r=n(2868),o=n(2869),a=n(5749),i=n(5706),s=n(5820),l=n(5819);function*c(e){var t=Object(o.getResources)();try{var n=r.MetadataClientInstance.getInstance(),l=yield Object(s.fetchPowerBIWorkspacesList)(n);yield Object(a.put)(Object(i.fetchPowerBIGroupsFulfilled)({groups:l}))}catch(c){yield Object(a.put)(Object(i.fetchPowerBIGroupsRejected)({error:t.Model.Solutions.Components.PowerBIEntities.Error.ErrorGettingGroups}))}}function*p(e){var t=Object(o.getResources)();try{var n=e.payload.workspaceId,c=r.MetadataClientInstance.getInstance(),p=yield Object(s.fetchPowerBIArtifactsList)(c,n,l.PowerBIArtifactSolutionComponentTypes.PowerBIReport);yield Object(a.put)(Object(i.fetchPowerBIReportsFulfilled)({reports:p}))}catch(u){yield Object(a.put)(Object(i.fetchPowerBIReportsRejected)({error:t.Model.Solutions.Components.PowerBIEntities.Error.ErrorGettingReports}))}}function*u(e){var t=Object(o.getResources)();try{var n=e.payload.workspaceId,c=r.MetadataClientInstance.getInstance(),p=yield Object(s.fetchPowerBIArtifactsList)(c,n,l.PowerBIArtifactSolutionComponentTypes.PowerBIDataset);yield Object(a.put)(Object(i.fetchPowerBIDatasetsFulfilled)({datasets:p}))}catch(u){yield Object(a.put)(Object(i.fetchPowerBIDatasetsRejected)({error:t.Model.Solutions.Components.PowerBIEntities.Error.ErrorGettingDatasets}))}}t.default=function*(){yield Object(a.takeLatest)(i.PowerBIEntitiesActionTypes.FETCH_POWER_BI_GROUPS_REQUEST,c),yield Object(a.takeLatest)(i.PowerBIEntitiesActionTypes.FETCH_POWER_BI_REPORTS_REQUEST,p),yield Object(a.takeLatest)(i.PowerBIEntitiesActionTypes.FETCH_POWER_BI_DATASETS_REQUEST,u)}},7588:function(e,t,n){"use strict";n.r(t),n.d(t,"defaultState",(function(){return l})),n.d(t,"reducer",(function(){return c}));var r=n(5706),o=n(5470);function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var l={groups:new o.CaseInsensitiveNormalized,reports:new o.CaseInsensitiveNormalized,datasets:new o.CaseInsensitiveNormalized,fetchGroupsError:"",fetchReportsError:"",fetchDatasetsError:""};function c(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,t=arguments.length>1?arguments[1]:void 0,n=new o.CaseInsensitiveNormalized,a=new o.CaseInsensitiveNormalized,s=new o.CaseInsensitiveNormalized;switch(t.type){case r.PowerBIEntitiesActionTypes.FETCH_POWER_BI_GROUPS_REQUEST:return i(i({},e),{},{reports:a,datasets:s});case r.PowerBIEntitiesActionTypes.FETCH_POWER_BI_GROUPS_FULFILLED:return Object(o.addAll)(n,t.payload.groups),i(i({},e),{},{groups:n,fetchGroupsError:""});case r.PowerBIEntitiesActionTypes.FETCH_POWER_BI_GROUPS_REJECTED:return i(i({},e),{},{groups:e.groups,fetchGroupsError:t.payload.error});case r.PowerBIEntitiesActionTypes.FETCH_POWER_BI_REPORTS_REQUEST:return i(i({},e),{},{reports:e.reports});case r.PowerBIEntitiesActionTypes.FETCH_POWER_BI_REPORTS_FULFILLED:return Object(o.addAll)(a,t.payload.reports),i(i({},e),{},{reports:a,fetchReportsError:""});case r.PowerBIEntitiesActionTypes.FETCH_POWER_BI_REPORTS_REJECTED:return i(i({},e),{},{reports:e.reports,fetchReportsError:t.payload.error});case r.PowerBIEntitiesActionTypes.FETCH_POWER_BI_DATASETS_REQUEST:return i(i({},e),{},{datasets:e.datasets});case r.PowerBIEntitiesActionTypes.FETCH_POWER_BI_DATASETS_FULFILLED:return Object(o.addAll)(s,t.payload.datasets),i(i({},e),{},{datasets:s});case r.PowerBIEntitiesActionTypes.FETCH_POWER_BI_DATASETS_REJECTED:return i(i({},e),{},{datasets:e.datasets,fetchDatasetsError:t.payload.error});default:return e}}t.default=c},7589:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return O}));var r=n(5749),o=n(7524),a=n(5981),i=n(7509),s=n(7529),l=n(7561),c=n(6024),p=n(7539),u=n(6355),d=n(5871),m=n(7570),g=n(7548),h=n(5787),b=n(5746),f=n(6541),y=n(5468),S=n(6657),C=n(7574),v=n(7584),w=n(7578);function*O(){yield Object(r.all)([Object(r.fork)(o.apisMiddlewares.ApiClientRootSaga),Object(r.fork)(a.appsMiddlewares.AppClientRootSaga),Object(r.fork)(i.connectionsMiddlewares.ConnectionClientRootSaga),Object(r.fork)(s.gatewaysMiddlewares.GatewayClientRootSaga),Object(r.fork)(y.sharedMiddlewares.LoggingClientRootSaga),Object(r.fork)(d.appModulesMiddlewares.AppModuleClientRootSaga),Object(r.fork)(l.learnMiddlewares.LearnActionsRootSaga),Object(r.fork)(p.sampleAppsMiddlewares.SampleAppClientRootSaga),Object(r.fork)(b.solutionsMiddlewares.SolutionsClientRootSaga),Object(r.fork)(y.sharedMiddlewares.GraphClientRootSaga),Object(r.fork)(h.solutionComponentsMiddlewares.SolutionComponentsClientRootSaga),Object(r.fork)(c.resourcesMiddlewares.PermissionsClientRootSaga),Object(r.fork)(u.shareMiddlewares.ShareClientRootSaga),Object(r.fork)(y.sharedMiddlewares.EnvironmentClientRootSaga),Object(r.fork)(y.sharedMiddlewares.XrmDatabaseClientRootSaga),Object(r.fork)(y.sharedMiddlewares.P2PlanTrialClientRootSaga),Object(r.fork)(y.sharedMiddlewares.CurrencyClientRootSaga),Object(r.fork)(y.sharedMiddlewares.LanguageClientRootSaga),Object(r.fork)(y.sharedMiddlewares.LocationClientRootSaga),Object(r.fork)(y.sharedMiddlewares.ConsentClientRootSaga),Object(r.fork)(y.sharedMiddlewares.GetTokenRootSaga),Object(r.fork)(g.solutionCheckerResultsMiddleware.SolutionCheckerResultsClientRootSaga),Object(r.fork)(y.sharedMiddlewares.OrgEnabledLanguageRootSaga),Object(r.fork)(f.powerPortalMiddlewares.PowerPortalRootSaga),Object(r.fork)(m.flowsMiddlewares.FlowsActionsRootSaga),Object(r.fork)(S.envVariableMiddlewares.EnvironmentVariableRootSaga),Object(r.fork)(C.dataflowsMiddlewares.DataflowsActionsRootSaga),Object(r.fork)(w.connectionReferenceMiddlewares.ConnectionReferenceRootSaga),Object(r.fork)(v.powerBIEntitiesMiddlewares.PowerBIEntitiesActionsRootSaga)])}},7590:function(e,t,n){"use strict";n.r(t),n.d(t,"ReactAppContainer",(function(){return c}));var r=n(245),o=n.n(r),a=n(5437),i=n(5474),s=n(7591);function l(){return(l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var c=e=>{var{pageLoadLoggerProps:t,uxContext:n}=e,r=Object(a.useDispatch)(),c={initializeAadUser:()=>r(Object(i.aadUserInitialized)()),initializeCurrentPlans:()=>r(Object(i.currentPlansInit)()),initializeOptimizelyFlag:()=>r(Object(i.fetchOptimizelyFlags)()),initializeSessionId:()=>r(Object(i.sessionIdInitialized)()),initializeWhitelistFeatures:()=>r(Object(i.fetchAllowlistFeatures)()),initializeBapWhitelistFeatures:()=>r(Object(i.fetchBapAllowlistFeatures)())};return o.a.createElement(s.ReactApp,l({},c,{pageLoadLoggerProps:t,uxContext:n}))}},7591:function(e,t,n){"use strict";n.r(t),n.d(t,"ReactApp",(function(){return K})),n.d(t,"RouteByUXContext",(function(){return Q}));var r=n(2844),o=n(3666),a=n(245),i=n(303),s=n(7592),l=n(7616),c=n(7636),p=n(7667),u=n(7672),d=n(7679),m=n(7686),g=n(7687),h=n(7691),b=n(7695),f=n(7697),y=n(7832),S=n(7841),C=n(7846),v=n(7853),w=n(7943),O=n(7956),P=n(7957),E=n(7962),A=n(7980),j=n(7992),L=n(8007),T=n(8015),k=n(8022),R=n(2871),D=n(8034),M=n(8036),N=n(8038),x=n(8040),I=n(8041),F=n(5488),B=n(5475),U=n(4184),G=n(8043),z=n(8045),H=n(3831),_=n(8047),W=n(3713),V=n(3833),q=n(9351);class K extends a.Component{constructor(e){super(e)}UNSAFE_componentWillMount(){Object(r.initializePortalIcons)(),this.props.initializeAadUser(),this.props.initializeCurrentPlans(),this.props.initializeOptimizelyFlag(),this.props.initializeSessionId(),this.props.initializeWhitelistFeatures(),this.props.initializeBapWhitelistFeatures()}render(){var{pageLoadLoggerProps:e}=this.props,t=R.featureGates.useNewGatewayDetails?f.GatewayDetailsPageWithResources:y.GatewayManagementPageContainer,n=a.createElement(i.Switch,null,R.featureGates.showSolutionSmartDiff&&a.createElement(i.Route,{path:H.RoutePaths.solutionSmartDiff,component:j.solutionSmartDiffPageContainer}),a.createElement(i.Route,{path:[H.RoutePaths.solutionLayer,H.RoutePaths.entityComponentLayer],component:A.SolutionLayersListPageContainer}),a.createElement(i.Route,{path:H.RoutePaths.solutionHistoryForSelectedSolution,component:L.SolutionsHistoryListPageContainerConnected}),a.createElement(Q,{path:H.RoutePaths.home,render:()=>a.createElement(v.HomePageContainer,e),currentUXContext:this.props.uxContext,unsuppportedUXContexts:[W.UXContext.CDSLiteInPortal]}),a.createElement(Q,{path:H.RoutePaths.learn,component:w.LearnPage,currentUXContext:this.props.uxContext,unsuppportedUXContexts:[W.UXContext.CDSLiteInPortal]}),R.featureGates.showRefreshAppsPage&&a.createElement(Q,{path:H.RoutePaths.refreshApps,component:p.RefreshAppsPage,currentUXContext:this.props.uxContext,unsuppportedUXContexts:[W.UXContext.CDSLiteInPortal]}),a.createElement(Q,{path:H.RoutePaths.appManagement,component:l.AppManagementPageContainer,currentUXContext:this.props.uxContext,unsuppportedUXContexts:[W.UXContext.CDSLiteInPortal]}),a.createElement(Q,{path:H.RoutePaths.appComponentLibraryManagement,component:s.AppComponentLibraryManagementPageContainer,currentUXContext:this.props.uxContext,unsuppportedUXContexts:[W.UXContext.CDSLiteInPortal]}),a.createElement(i.Route,{path:H.RoutePaths.model.solutionAppManagement,component:l.AppManagementPageContainer}),a.createElement(Q,{path:H.RoutePaths.appsList,render:()=>a.createElement(c.AppsListPageContainer,e),currentUXContext:this.props.uxContext,unsuppportedUXContexts:[W.UXContext.CDSLiteInPortal]}),a.createElement(Q,{path:H.RoutePaths.appComponentLibrariesList,render:()=>a.createElement(c.AppsListPageContainer,e),currentUXContext:this.props.uxContext,unsuppportedUXContexts:[W.UXContext.CDSLiteInPortal]}),a.createElement(i.Route,{path:H.RoutePaths.connectionManagement,component:q.ConnectionManagement}),a.createElement(i.Route,{path:H.RoutePaths.newConnection,component:g.NewConnectionPageContainer}),a.createElement(i.Route,{path:H.RoutePaths.connectionsList,component:d.ConnectionsListPage}),a.createElement(Q,{path:H.RoutePaths.gatewayRuns,component:C.RpaRunsListPage,currentUXContext:this.props.uxContext,unsuppportedUXContexts:[W.UXContext.CDSLiteInPortal]}),a.createElement(Q,{path:H.RoutePaths.gatewaysManagement,component:t,currentUXContext:this.props.uxContext,unsuppportedUXContexts:[W.UXContext.CDSLiteInPortal]}),a.createElement(Q,{path:H.RoutePaths.gateways,component:S.GatewaysListPage,currentUXContext:this.props.uxContext,unsuppportedUXContexts:[W.UXContext.CDSLiteInPortal]}),a.createElement(Q,{path:H.RoutePaths.templates,component:k.TemplatesPageContainer,currentUXContext:this.props.uxContext,unsuppportedUXContexts:[W.UXContext.CDSLiteInPortal]}),a.createElement(i.Route,{path:H.RoutePaths.solutionComponentsList,component:E.SolutionComponentsListPageContainer}),a.createElement(i.Route,{path:H.RoutePaths.solutionCheckerResultsList,component:P.SolutionCheckerViewResultsPageContainer}),a.createElement(i.Route,{path:H.RoutePaths.performance,component:_.PerfCheckerLandingPage}),a.createElement(i.Route,{path:H.RoutePaths.solutionsList,component:T.SolutionsListPageContainer}),a.createElement(i.Route,{path:H.RoutePaths.solutionHistory,component:L.SolutionsHistoryListPageContainerConnected}),a.createElement(Q,{path:H.RoutePaths.powerPortalDetailsPage,component:u.PowerPortalDetailsPageContainer,currentUXContext:this.props.uxContext,unsuppportedUXContexts:[W.UXContext.CDSLiteInPortal]}),a.createElement(Q,{path:H.RoutePaths.flows,component:b.FlowsPageContainer,currentUXContext:this.props.uxContext,unsuppportedUXContexts:[W.UXContext.CDSLiteInPortal]}),a.createElement(i.Route,{path:H.RoutePaths.customApis,component:h.CustomApisPageContainer}),R.featureGates.enableSearchResultsPage&&a.createElement(i.Route,{path:H.RoutePaths.search,component:o.SearchResultsPage}),a.createElement(U.RedirectWithParams,{from:H.RoutePaths.widget.project,to:H.RoutePaths.solutionComponent}),a.createElement(U.RedirectWithParams,{from:H.RoutePaths.widget.projects,to:H.RoutePaths.solutionsList}),a.createElement(U.RedirectWithParams,{from:H.RoutePaths.widget.connectionManagement,to:H.RoutePaths.connectionManagement}),a.createElement(U.RedirectWithParams,{from:H.RoutePaths.widget.connections,to:H.RoutePaths.connectionsList}),a.createElement(U.RedirectWithParams,{from:H.RoutePaths.widget.gatewayManagement,to:H.RoutePaths.gatewaysManagement}),a.createElement(U.RedirectWithParams,{from:H.RoutePaths.widget.gateways,to:H.RoutePaths.gateways}));return a.createElement(a.Fragment,null,n,a.createElement(i.Route,{exact:!0,path:H.RoutePaths.createNewConnection,component:m.NewConnectionModal}),a.createElement(i.Route,{path:H.RoutePaths.aiCreateEnvironment,component:M.AiBuilderCreateEnvironmentContainer}),a.createElement(i.Route,{path:H.RoutePaths.aiCreateDatabase,component:D.AiBuilderCreateDatabaseContainer}),a.createElement(i.Route,{path:H.RoutePaths.paCreateDatabase,component:N.ProcessAdvisorCreateDatabaseContainer}),a.createElement(i.Route,{path:H.RoutePaths.appSharing.adminCanvasAppSharing,component:z.SharePanelWrapperPageContainer}),a.createElement(i.Route,{path:H.RoutePaths.appSharing.adminAppModelSharing,component:G.AppModuleSharePanelWrapperPageContainer}),a.createElement(i.Route,{path:H.RoutePaths.appSharing.adminAppCanvasAppSharing,component:z.SharePanelWrapperPageContainer}),a.createElement(i.Route,{path:H.RoutePaths.appSharing.adminAppModelDrivenAppSharing,component:G.AppModuleSharePanelWrapperPageContainer}),a.createElement(i.Route,{path:H.RoutePaths.appSharing.homeCanvasApp,component:z.SharePanelWrapperPageContainer}),a.createElement(i.Route,{path:H.RoutePaths.appSharing.homeModelDrivenApp,component:G.AppModuleSharePanelWrapperPageContainer}),a.createElement(i.Route,{path:H.RoutePaths.entitiesAddSubcomponents,component:I.entityAddSubcomponentsContainer}),a.createElement(B.PanelSelectorContainer,null),a.createElement(x.DialogContainer,null),a.createElement(F.ModalsWrapper,null),a.createElement(O.MiddletierCDSPrefetch,null))}}var Y={[W.UXContext.CDSLiteInPortal]:H.RoutePaths.solutionsList};class Q extends i.Route{render(){var e;return this.props.currentUXContext&&(null===(e=this.props.unsuppportedUXContexts)||void 0===e?void 0:e.find(e=>e===this.props.currentUXContext))?Y[this.props.currentUXContext]?a.createElement(U.RedirectWithParams,{from:this.props.path,to:Y[this.props.currentUXContext]}):a.createElement(V.FourZeroFourPage,null):a.createElement(i.Route,this.props)}}},7592:function(e,t,n){"use strict";n.r(t),n.d(t,"withAppComponentLibraryManagementPageBehavior",(function(){return v})),n.d(t,"AppComponentLibraryManagementPageContainer",(function(){return w}));var r=n(245),o=n.n(r),a=n(5437),i=n(3076),s=n(922),l=n(1200),c=n(5583),p=n(7593),u=n(7594),d=n(3831),m=n(3196),g=n(5596),h=n(5649),b=n(5593),f=n(5648),y=n(5487),S=n(1190),C=n(217);function v(e){return t=>{var n,i,{match:s,navigate:c,environmentClient:p,t:v,tReady:w}=t,{selectedPivot:O,onPivotClick:P}=Object(u.useAppComponentLibraryManagementPivots)(s,c),[E,A]=o.a.useState(!1),[j,L]=o.a.useState(!1),T=(i=(n=t)&&n.match&&n.match.params&&n.match.params.appComponentLibraries||"",Object(g.appNameToId)(i));Object(r.useEffect)(()=>{L(E)},[E]);var k=Object(a.useSelector)(h.deletedComponentLibraryAppId),{appComponentLibraries:R,errorMessage:D}=Object(m.useAppComponentLibrariesListPollingQuery)(p,{},b.PortalScope,v("Common.Request.Failed"),!1,e=>{var t=e&&e.canvasApps;return t&&!!t.find(e=>Object(S.equalsIgnoreCase)(e.id,k))},j);Object(r.useEffect)(()=>{Object(C.trackErrorTrace)(b.PortalScope,{eventName:"pollComponentLibrariesList",eventData:{error:D}})},[D]);var M=null==R?void 0:R.find(e=>Object(S.equalsIgnoreCase)(e.id,T)),N=M||void 0,[x,I]=Object(r.useState)(""),[F,B]=Object(r.useState)(void 0),U=Object(a.useSelector)(h.restoreAppResponse),G=Object(a.useSelector)(h.deleteAppVersionResponse),z=Object(a.useDispatch)(),{rootProps:{areShellProvidersReady:H}}=Object(r.useContext)(y.RootPropsContext);return H?o.a.createElement(e,{selectedPivot:O,onPivotClick:P,appComponentLibraryDisplayName:N&&N.displayName||"",appComponentLibraryId:T,onAppComponentLibrariesBreadcrumbClick:()=>c("/".concat(d.AppPivotUrlStrings.ComponentLibraries),!0),searchFilter:x,setSearchFilter:I,selectedVersion:F,setSelectedVersion:B,restoreAppVersionResponse:U,deleteAppVersionResponse:G,clearDeleteAppVersionResponse:()=>z(Object(f.clearDeleteAppVersionResponse)()),clearRestoreAppVersionResponse:()=>z(Object(f.clearRestoreAppVersionResponse)()),t:v,tReady:w,canRefetch:E,setCanRefetch:A,refetch:j}):o.a.createElement(l.PagePlaceholder,null)}}var w=Object(s.translateService)("PowerappsPortal")(Object(i.withApolloClient)(Object(c.withNavigation)(v(p.AppComponentLibraryManagementPage))))},7593:function(e,t,n){"use strict";n.r(t),n.d(t,"AppComponentLibraryManagementPage",(function(){return b}));var r=n(245),o=n.n(r),a=n(1709),i=n(4792),s=n(4105),l=n(7594),c=n(7595),p=n(7599),u=n(7600),d=n(7604),m=n(7610),g=n(7614),h=n(7615),b=e=>{var t,n,{appComponentLibraryId:b,appComponentLibraryDisplayName:f,selectedPivot:y,onAppComponentLibrariesBreadcrumbClick:S,selectedVersion:C,setSearchFilter:v,t:w,canRefetch:O,setCanRefetch:P,refetch:E}=e,A=Object(r.useMemo)(()=>[{text:w("Apps.AppList.Pivots.componentLibraries"),key:w("Apps.AppList.Pivots.componentLibraries"),onClick:()=>{S()}},{text:f,key:b}],[b,f]);return t=y===l.AppComponentLibraryManagementPivots.Versions&&C?o.a.createElement(g.VersionCommandBarContainer,{selectedVersion:C,onSearchFilterUpdate:v}):o.a.createElement(c.AppComponentLibrariesCommandBarContainer,{appComponentLibraryId:b,isDrilledIn:!0,canRefetch:O,setCanRefetch:P,refetch:E}),y===l.AppComponentLibraryManagementPivots.Details?n=o.a.createElement(u.AppComponentLibraryDetailsContainer,{appComponentLibraryId:b}):y===l.AppComponentLibraryManagementPivots.Versions?n=o.a.createElement(m.VersionsListContainer,{appId:b,onAppVersionSelect:e.setSelectedVersion,searchFilter:e.searchFilter}):y===l.AppComponentLibraryManagementPivots.Components&&(n=o.a.createElement(d.AppComponentLibraryComponentsListContainer,{appComponentLibraryId:b})),o.a.createElement(i.Page,{className:p.appManagementPageStyleClasses.appManagementPage,renderHeader:()=>t,renderTitle:()=>o.a.createElement(s.PageHeader,{titleBreadcrumbProps:{items:A,ariaLabel:w("Apps.AppManagement.Breadcrumbs.apps")}}),spinnerProps:{label:e.restoreAppVersionResponse.loading?w("Apps.Versions.Modal.Restore.inProgress"):e.deleteAppVersionResponse.loading?w("Apps.Versions.Modal.Delete.inProgress"):""},showOverlay:e.restoreAppVersionResponse.loading||e.deleteAppVersionResponse.loading,renderBody:()=>o.a.createElement(o.a.Fragment,null,o.a.createElement(a.Pivot,{defaultSelectedKey:y&&l.AppComponentLibraryManagementPivots[y],onLinkClick:t=>t&&e.onPivotClick(t.props.itemKey,b)},o.a.createElement(a.PivotItem,{itemKey:l.AppComponentLibraryManagementPivots.Details,linkText:w("Apps.AppComponentLibraryManagement.Pivots.details")}),o.a.createElement(a.PivotItem,{itemKey:l.AppComponentLibraryManagementPivots.Versions,linkText:w("Apps.AppComponentLibraryManagement.Pivots.versions")}),o.a.createElement(a.PivotItem,{itemKey:l.AppComponentLibraryManagementPivots.Components,linkText:w("Apps.AppComponentLibraryManagement.Pivots.components")})),n),renderMessageBar:()=>o.a.createElement(o.a.Fragment,null,Object(h.getMessageBar)(e.restoreAppVersionResponse,e.clearRestoreAppVersionResponse),Object(h.getMessageBar)(e.deleteAppVersionResponse,e.clearDeleteAppVersionResponse))})}},7594:function(e,t,n){"use strict";n.r(t),n.d(t,"AppComponentLibraryManagementPivots",(function(){return r})),n.d(t,"useAppComponentLibraryManagementPivots",(function(){return l}));var r,o=n(2812),a=n(3831),i=n(5623);function s(e){var t,n=e&&e.url&&Object(o.last)(e.url.split("/"));return n===a.AppComponentLibraryManagementPivotUrlStrings.Details?t=r.Details:n===a.AppComponentLibraryManagementPivotUrlStrings.Versions?t=r.Versions:n===a.AppComponentLibraryManagementPivotUrlStrings.Components&&(t=r.Components),t}function l(e,t){return{selectedPivot:s(e),onPivotClick:(e,n)=>{t(Object(i.getAppComponentLibrarySubroute)(n,function(e){return e===r.Details?"".concat(a.AppComponentLibraryManagementPivotUrlStrings.Details):e===r.Versions?"".concat(a.AppComponentLibraryManagementPivotUrlStrings.Versions):e===r.Components?"".concat(a.AppComponentLibraryManagementPivotUrlStrings.Components):""}(e)),!0)}}}!function(e){e.Details="Details",e.Versions="Versions",e.Components="Components"}(r||(r={}))},7595:function(e,t,n){"use strict";n.r(t),n.d(t,"withAppComponentLibrariesCommandBarBehavior",(function(){return C})),n.d(t,"mapDispatchToProps",(function(){return v})),n.d(t,"mergeProps",(function(){return w})),n.d(t,"AppComponentLibrariesCommandBarContainer",(function(){return O}));var r=n(1222),o=n(245),a=n(7596),i=n(7598),s=n(3196),l=n(3076),c=n(922),p=n(5593),u=n(5649),d=n(5437),m=n(1190),g=n(5468),h=n(5478),b=n(217);function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){S(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function S(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function C(e){return t=>{var{appComponentLibraryId:n,isDrilledIn:r,environmentClient:l,t:c,onPanelDismiss:g,canRefetch:h,setCanRefetch:f,refetch:y}=t,S=Object(d.useSelector)(u.deletedComponentLibraryAppId),{appComponentLibraries:C,errorMessage:v}=Object(s.useAppComponentLibrariesListPollingQuery)(l,{},p.PortalScope,c("Common.Request.Failed"),!1,e=>{var t=e&&e.canvasApps;return t&&!!t.find(e=>Object(m.equalsIgnoreCase)(e.id,S))},y);Object(o.useEffect)(()=>{Object(b.trackErrorTrace)(p.PortalScope,{eventName:"pollComponentLibrariesList",eventData:{error:v}})},[v]);var w=C&&C.find(e=>Object(m.equalsIgnoreCase)(e.id,n)),O=w||void 0,P=Object(a.useAppComponentLibraryCommands)({context:i.CommandContexts.CommandBar,isItemSelected:!!n,isDrilledIn:r,appComponentLibraryId:n,isEditable:!(null==O||!O.isEditable),isCustomizable:!(null==O||!O.isCustomizable),appComponentLibrary:O,canRefetch:h,setCanRefetch:f,onPanelDismiss:g});return o.createElement(e,{items:P})}}var v=(e,t)=>({dispatchPanelClose:()=>{e(g.sharedActions.panelClose({panelType:h.PanelToShowType.AppComponentLibraryRenamePanel}))}}),w=(e,t,n)=>{var{dispatchPanelClose:r}=t;return y(y({},n),{},{onPanelDismiss:e=>{r(e)}})},O=Object(c.translateService)("PowerappsPortal")(Object(l.withApolloClient)(Object(d.connect)(null,v,w)(C(r.CommandBarWithSearchBox))))},7596:function(e,t,n){"use strict";n.r(t),n.d(t,"useMakeCommand",(function(){return P})),n.d(t,"makeCommands",(function(){return E})),n.d(t,"useAppComponentLibraryCommands",(function(){return j}));var r=n(245),o=n(5437),a=n(545),i=n(5674),s=n(2872),l=n(5761),c=n(6874),p=n(5593),u=n(5669),d=n(5583),m=n(5623),g=n(5487),h=n(5468),b=n(5478),f=n(7597),y=n(5648),S=n(2840);function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(Object(n),!0).forEach((function(t){w(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function w(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var O=e=>v(v({type:void 0,isAppComponentLibrary:!0},e),{},{properties:v({createdBy:void 0,createdByClientVersion:void 0,minClientVersion:void 0,owner:void 0,environment:void 0,createdTime:void 0,lastModifiedTime:void 0,lastModifiedBy:void 0,sharedUsersCount:void 0,sharedGroupsCount:void 0,appOpenProtocolUri:void 0,commitMessage:void 0,canConsumeAppPass:void 0,appVersion:void 0},e)});function P(e,t,n,r,o,a,d,g,h){var b=!o,y=!o||!Object(S.featureGatedIsCustomizable)(a),C=Object(f.useCreateComponentLibrary)();switch(e){case i.CommandKeys.CreateComponentLibrary:return i.appComponentLibraryCommandRepository[e]({onClick:C});case i.CommandKeys.EditComponentLibrary:return i.appComponentLibraryCommandRepository[e]({onClick:()=>{y||(Object(p.trackUserActionClickButton)(u.AppComponentLibraryActionNames.Edit),i.ComponentLibraryCommandActions.onComponentLibraryEditClick(t,n,r))},disabled:y});case i.CommandKeys.ShareComponentLibrary:return i.appComponentLibraryCommandRepository[e]({onClick:()=>{b||(Object(p.trackUserActionClickButton)(u.AppComponentLibraryActionNames.Share),d())},disabled:b});case i.CommandKeys.DeleteComponentLibrary:return i.appComponentLibraryCommandRepository[e]({onClick:()=>{y||(Object(p.trackUserActionClickButton)(u.AppComponentLibraryActionNames.Delete),g())},disabled:y});case i.CommandKeys.RenameComponentLibrary:return i.appComponentLibraryCommandRepository[e]({onClick:()=>{b||(Object(p.trackUserActionClickButton)(u.AppComponentLibraryActionNames.Rename),h())},disabled:y});case i.CommandKeys.Details:return i.appComponentLibraryCommandRepository[e]({onClick:()=>{Object(p.trackUserActionClickButton)(u.AppComponentLibraryActionNames.Details),r(Object(m.getAppComponentLibraryDetailsUrl)(t),!0)}});case i.CommandKeys.Dynamics365:return Object(l.isGcc)(s.settings)?void 0:i.appComponentLibraryCommandRepository[e]({onClick:()=>{Object(p.trackUserActionClickButton)(u.CommonActionNames.D365Command),Object(c.openNewTab)(s.settings.dynamics365PortalUrl)}});default:return i.appComponentLibraryCommandRepository[e]()}}var E=(e,t,n,r,o,a,s,l,c,p,u)=>Object(i.getComponentLibraryCommandKeys)({context:e,isItemSelected:t,isDrilledIn:n}).map(e=>P(e,r,o,a,s,l,c,p,u)).filter(e=>!!e),A=Object(a.memoizeFunction)(E),j=e=>{var{context:t,isItemSelected:n,isDrilledIn:a,appComponentLibraryId:i,appComponentLibrary:s,isEditable:l,isCustomizable:c,canRefetch:p,setCanRefetch:u,onPanelDismiss:m}=e,{navigate:f}=Object(r.useContext)(d.NavigationContext),{rootProps:S}=Object(r.useContext)(g.RootPropsContext),{currentEnvironment:C}=S,v=Object(o.useDispatch)();return A(t,n,a,i,C,f,l,c,()=>v(h.sharedActions.panelOpen({panelType:b.PanelToShowType.ComponentLibrarySharePanel,panelProps:{selectedComponentLibrary:O(s)},stayMountedWhenHidden:!0})),()=>v(y.openDeleteAppDialogue({app:O(s),navigate:f})),()=>v(h.sharedActions.panelOpen({panelType:b.PanelToShowType.AppComponentLibraryRenamePanel,panelProps:{appId:i,selectedApp:O(s),canRefetch:p,setCanRefetch:u,onPanelDismiss:m}})))}},7597:function(e,t,n){"use strict";n.r(t),n.d(t,"useCreateComponentLibrary",(function(){return l}));var r=n(245),o=n(5586),a=n(5669),i=n(5593),s=n(5488),l=()=>{var{setOpenModal:e}=Object(r.useContext)(s.ModalsWrapperContext);return()=>{Object(i.trackUserActionClickButton)(a.AppComponentLibraryActionNames.Create),e({name:o.ModalNames.NewComponentLibrary})}}},7598:function(e,t,n){"use strict";var r;n.r(t),n.d(t,"CommandContexts",(function(){return r})),function(e){e[e.CommandBar=0]="CommandBar",e[e.ContextMenu=1]="ContextMenu"}(r||(r={}))},7600:function(e,t,n){"use strict";n.r(t),n.d(t,"getDetailsProps",(function(){return m})),n.d(t,"withAppComponentLibraryDetailsBehavior",(function(){return g})),n.d(t,"AppComponentLibraryDetailsContainer",(function(){return h}));var r=n(245),o=n.n(r),a=n(7601),i=n(3196),s=n(3076),l=n(922),c=n(5593),p=["appComponentLibraryId","environmentClient","t"];function u(){return(u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function d(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var m=(e,t)=>e?[{title:t("Controllers.Properties.ownerDisplayNameProperty"),content:e.ownerName},{title:t("Common.created"),content:e.createdDate&&new Date(e.createdDate).toLocaleString()||""},{title:t("Common.modified"),content:e.lastModifiedDate&&new Date(e.lastModifiedDate).toLocaleString()||""},{title:t("Directives.AppDetails.appid"),content:e.name}]:[];function g(e){return t=>{var{appComponentLibraryId:n,environmentClient:r,t:a}=t,s=d(t,p),{canvasApp:l}=Object(i.useCanvasAppQuery)(r,{appId:n},c.PortalScope,a("Common.Request.Failed")),g=m(l||void 0,a);return o.a.createElement(e,u({},s,{detailsProps:g}))}}var h=Object(l.translateService)("PowerappsPortal")(Object(s.withApolloClient)(g(a.ResourceDetailList)))},7604:function(e,t,n){"use strict";n.r(t),n.d(t,"withAppComponentLibraryComponentsListBehavior",(function(){return h})),n.d(t,"AppComponentLibraryComponentsListContainer",(function(){return b}));var r=n(245),o=n.n(r),a=n(545),i=n(7605),s=n(5629),l=n(7608),c=n(3076),p=n(922),u=n(5593),d=["appComponentLibraryId","environmentClient","t"];function m(){return(m=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function g(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function h(e){return t=>{var{appComponentLibraryId:n,environmentClient:r,t:i}=t,c=g(t,d),{errorMessage:p,libraryComponents:h}=Object(l.useLibraryComponentsListPollingQuery)(r,{appId:n},u.PortalScope,i("Common.Request.Failed"));return o.a.createElement(e,m({},c,{listItems:h||[],loadProgress:[Object(s.toLoadingState)(void 0!==h,p)],selectionMode:a.SelectionMode.single,t:i}))}}var b=Object(p.translateService)("PowerappsPortal")(Object(c.withApolloClient)(h(i.AppComponentLibraryComponentsList)))},7605:function(e,t,n){"use strict";n.r(t),n.d(t,"AppComponentLibraryComponentsList",(function(){return b}));var r=n(5080),o=n(3064),a=n(3167),i=n(545),s=n(245),l=n.n(s),c=n(7606),p=n(2879),u=n(5633);function d(){return(d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){h(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var b=e=>{var{listItems:t,loadProgress:n,t:m,tReady:h}=e;return l.a.createElement(c.LoadOrderDetailsList,d({},Object(u.getDetailsListProps)(m("Common.rowSelectionAriaLabel")),{listKey:"AppComponentLibrariesList",items:t,loadProgress:n,columns:Object(s.useMemo)(()=>(e=>{var t=Object(o.buildIconColumn)(e=>{var t,n;return{iconUri:null!==(t=e.iconUri)&&void 0!==t?t:"",iconAltText:null!==(n=e.displayName)&&void 0!==n?n:""}},o.RowHeight.medium);t.iconName=p.fabricIcons.WebComponents,t.isIconOnly=!0;var n={isRowHeader:!0,isResizable:!0,isPadded:!0,isMultiline:!1,sortAscendingAriaLabel:e("Common.Sorting.ascending"),sortDescendingAriaLabel:e("Common.Sorting.descending")};return[t,g(g({},n),{},{key:"displayName",fieldName:"displayName",name:e("Common.name"),minWidth:50,maxWidth:200}),g(g({},n),{},{key:"description",fieldName:"description",name:e("Common.description"),minWidth:200,maxWidth:500})]})(m),[]),selectionMode:i.SelectionMode.none,renderOnEmpty:()=>{var e=g(g({},Object(a.getCommonPropsOnErrorOrEmptySearch)()),{},{primaryMessage:h?m("Apps.NoComponents.message"):""});return l.a.createElement(r.EmptyState,e)}}))}},7606:function(e,t,n){"use strict";n.r(t),n.d(t,"ShimmerSubstate",(function(){return r})),n.d(t,"InnerLeastLoadOrderList",(function(){return b})),n.d(t,"LoadOrderDetailsList",(function(){return f}));var r,o=n(245),a=n.n(o),i=n(3064),s=n(3183),l=n(3184),c=n(7607),p=n(5629),u=["items","loadProgress","numberOfItemsToShow","listName","scenarioName","trackContextScenarioProgress","trackMyPartFinished"];function d(){return(d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function m(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}!function(e){e.AllShimmer="All Shimmer",e.Interactive="Interactive"}(r||(r={}));var g=Object(c.withLoadOrderItems)(i.DetailsList),h=[];class b extends a.a.Component{static getDerivedStateFromProps(e){var t={};return Object(p.isLoading)(e.loadProgress)||(t.hasBeenLoadingLong=!1),t}constructor(e){super(e),this.longLoadTime=500,this.shimmerLimit=6,this.onLongLoadTimeout=()=>{this.setState({hasBeenLoadingLong:!0})},this.state={hasBeenLoadingLong:!1,ignoreLoadOrder:!1,itemCount:-1,shimmerCount:-1}}logExtraTelemetry(e){var{itemCount:t,shimmerCount:n,trackContextScenarioProgress:o,trackMyPartFinished:a,listName:i,isFailed:s,errorMessage:c}=e;if(i&&o){var u,d="".concat(i," Shimmers"),m="".concat(t," items, ").concat(n," shimmers");s?u={name:d,state:p.ComponentLoadState.Fail,info:m}:0===t&&n>0?u={name:d,state:p.ComponentLoadState.Loading,subState:r.AllShimmer,info:m}:t>0&&n>0?u={name:d,state:p.ComponentLoadState.Loading,subState:r.Interactive,info:m}:0===n&&(u={name:d,state:p.ComponentLoadState.Complete,info:m}),u&&(o(u),u.state===p.ComponentLoadState.Complete?a(l.CompleteOrFail.Complete):u.state===p.ComponentLoadState.Fail&&a(l.CompleteOrFail.Fail,c))}}componentDidUpdate(e,t){var n={};this.props.onListKeyChange&&e.listKey!==this.props.listKey&&this.props.onListKeyChange(),this.props.filter!==e.filter&&(n.ignoreLoadOrder=!0);var r=0,{loadProgress:o,trackContextScenarioProgress:a,trackMyPartFinished:i,listName:s,items:l,numberOfItemsToShow:c}=this.props,{itemCount:u,shimmerCount:d}=this.state,m=Object(p.isLoading)(o),g=Object(p.hasFailureWithUnexpectedError)(o),h=Object(p.getErrorMessages)(o);if(this.state.hasBeenLoadingLong)if(c){var b=c;c=Math.floor(c/2),r=Math.min(this.shimmerLimit,b-c)}else r=this.shimmerLimit;else m&&(c=0,r=this.shimmerLimit);var f=l&&l.length||0;(f=void 0===c?f:Math.min(f,c))===u&&r===d||(this.logExtraTelemetry({itemCount:f,shimmerCount:r,listName:s,isFailed:g,errorMessage:h.join("; "),trackContextScenarioProgress:a,trackMyPartFinished:i}),n.itemCount=f,n.shimmerCount=r),Object.keys(n).length>0&&this.setState(n)}render(){var e=0,t=this.props,{items:n,loadProgress:r,numberOfItemsToShow:o,listName:i,scenarioName:s,trackContextScenarioProgress:l,trackMyPartFinished:c}=t,b=m(t,u),{hasBeenLoadingLong:f,ignoreLoadOrder:y}=this.state,S=Object(p.isLoading)(r);if(f)if(o){var C=o;o=Math.floor(o/2),e=Math.min(this.shimmerLimit,C-o)}else e=this.shimmerLimit;else S&&(o=0,e=this.shimmerLimit);var v=Object(p.getStoppedLoadingCount)(r),w="".concat(v," ").concat(f);return a.a.createElement(g,d({items:void 0===n?h:n,itemLimit:o,trailingEmptyCount:e,loadOrderItemsState:w,isLoadingComplete:!S,onLongLoadTimeout:this.onLongLoadTimeout,longLoadTime:this.longLoadTime,ignoreLoadOrder:y,useShimmeredList:!0},b))}}var f=e=>{var t=Object(s.useContextScenario)();return a.a.createElement(b,d({},t,e))}},7607:function(e,t,n){"use strict";n.r(t),n.d(t,"withLoadOrderItems",(function(){return l}));var r=n(245),o=n(2812);function a(){return(a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e){return class extends r.Component{static getDerivedStateFromProps(e,t){return!t.ignoreLoadOrder&&e.ignoreLoadOrder?{ignoreLoadOrder:!0}:{}}componentDidMount(){this.props.onLongLoadTimeout&&!this.props.isLoadingComplete&&window.setTimeout(()=>{this.props.isLoadingComplete||this.props.onLongLoadTimeout()},this.props.longLoadTime)}componentDidUpdate(e,t){if(!this.state.ignoreLoadOrder&&null!==this.props.items&&void 0!==this.props.items&&null!==e.items&&void 0!==e.items){var n=this.props.itemLimit;if(this.props.loadOrderItemsState===e.loadOrderItemsState){var r=!1;if(n=0,this.props.items.length<e.items.length&&(r=!0),this.props.items.length>e.items.length&&this.props.isLoadingComplete&&e.isLoadingComplete&&(r=!0),r)return void this.setState({trackedItems:{},ignoreLoadOrder:!0})}if(this.props.items!==e.items||this.props.loadOrderItemsState!==e.loadOrderItemsState){var o=this.sortItems(t.trackedItems,n);o&&this.setState(o)}}}sortItems(e,t){if(!this.state.ignoreLoadOrder){e=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e);var n=[],r=!1;for(var o of(this.props.items.forEach((o,a)=>{if(function(e){return null!=e&&void 0!==e.key&&null!==e.key}(o)){var i=o.key+"";e[o.key]&&e[o.key].oldIndex!==a?(e[o.key].oldIndex=a,r=!0):void 0===e[o.key]&&(void 0===t||n.length<t)&&(n.push({key:i,oldIndex:a}),r=!0)}}),Object.keys(e))){var{oldIndex:a}=e[o];if(!this.props.items[a]||this.props.items[a].key+""!==o)return{trackedItems:{},ignoreLoadOrder:!0}}if(r){var l=Object.keys(e).length;for(var c of n){var{key:p,oldIndex:u}=c;e[p]={oldIndex:u,newIndex:l},l++}return{trackedItems:e,ignoreLoadOrder:!1}}}}constructor(e){if(super(e),this.state={trackedItems:{},ignoreLoadOrder:!1},!e.isLoadingComplete){var t=this.sortItems({});t&&(this.state=t)}}render(){var t=[];return(this.state.ignoreLoadOrder||Object(o.isEmpty)(this.state.trackedItems))&&this.props.items?t=this.props.items:(Object.keys(this.state.trackedItems).forEach(e=>{var{newIndex:n,oldIndex:r}=this.state.trackedItems[e];t[n]=this.props.items[r]}),t=t.filter(e=>!!e)),void 0!==this.props.itemLimit&&(t=t.slice(0,this.props.itemLimit)),this.props.trailingEmptyCount&&(t=t.concat(new Array(this.props.trailingEmptyCount))),r.createElement(e,a({},this.props,{items:t}))}}}},7608:function(e,t,n){"use strict";n.r(t),n.d(t,"useLibraryComponentsListPollingQuery",(function(){return p}));var r=n(217),o=n(245),a=n(3186),i=n(3192),s=n(3197),l=n(3193),c=n(7609);function p(e,t,n,p){var u=l.TelemetryScenarioNames.libraryComponents,[d,m]=Object(o.useState)(),[g,h]=Object(o.useState)(""),{loading:b,data:f}=Object(a.useQuery)(c.LibraryComponentsQuery,{client:e||void 0,pollInterval:s.DefaultPollTimeInMs,fetchPolicy:"no-cache",notifyOnNetworkStatusChange:!0,onCompleted:e=>{d&&(d.complete({componentsLength:e&&e.libraryComponents&&e.libraryComponents.length}),m(void 0))},onError:e=>{if(d){var t=Object(i.getResponseMessageFromApolloError)(e,p);d.failure({error:t,clientError:e&&e.message}),m(void 0),h(t)}},variables:t});return Object(o.useEffect)(()=>{b&&m(Object(r.trackLoadScenario)(n,u))},[b]),{loading:b,errorMessage:g,libraryComponents:f&&f.libraryComponents}}},7609:function(e,t,n){"use strict";n.r(t),n.d(t,"LibraryComponentsQuery",(function(){return s}));var r,o=n(3128);var a,i,s=n.n(o)()(r||(a=["\n  query LibraryComponentsList($appId: String!) {\n    libraryComponents(appId: $appId) {\n      id\n      displayName\n      description\n      iconUri\n    }\n  }\n"],i||(i=a.slice(0)),r=Object.freeze(Object.defineProperties(a,{raw:{value:Object.freeze(i)}}))))},7614:function(e,t,n){"use strict";n.r(t),n.d(t,"mapDispatchToProps",(function(){return u})),n.d(t,"mergeProps",(function(){return d})),n.d(t,"VersionCommandBarContainer",(function(){return m}));var r=n(1222),o=n(5437),a=n(5487),i=n(6607),s=n(5630),l=n(5981),c=n(7612),p=n(5595),u=(e,t)=>({versionCommandActions:{onAppVersionRestoreClick:(t,n)=>e(Object(s.logAction)(l.appsActions.openRestoreAppVersionDialog({appName:t,appVersionListItem:n}),p.CanvasAppVersionsActionEvents.Restore.eventName,p.CanvasAppVersionsActionEvents.Restore.getData(n))),onAppVersionDeleteClick:(t,n)=>e(Object(s.logAction)(l.appsActions.openDeleteAppVersionDialog({appName:t,appVersionListItem:n}),p.CanvasAppVersionsActionEvents.Delete.eventName,p.CanvasAppVersionsActionEvents.Delete.getData(n))),onAppVersionPublishClick:t=>e(Object(s.logAction)(l.appsActions.publishAppVersion({appVersionListItem:t}),p.CanvasAppVersionsActionEvents.Publish.eventName,p.CanvasAppVersionsActionEvents.Publish.getData(t)))}}),d=(e,t,n)=>({items:Object(c.getAppVersionCommands)(n.selectedVersion,t.versionCommandActions),isSearchBoxVisible:!n.selectedVersion,searchBoxProps:Object(i.getSearchBoxProps)(n.onSearchFilterUpdate)}),m=Object(a.withRootProps)(Object(o.connect)(null,u,d)(r.CommandBarWithSearchBox))},7615:function(e,t,n){"use strict";n.r(t),n.d(t,"getMessageBar",(function(){return i}));var r=n(245),o=n.n(r),a=n(1697),i=(e,t)=>e.message&&o.a.createElement(a.MessageBar,{messageBarType:e.success?a.MessageBarType.success:a.MessageBarType.error,isMultiline:!1,dismissButtonAriaLabel:"Cancel",onDismiss:t},e.message)},7636:function(e,t,n){"use strict";n.r(t),n.d(t,"withAppsListPageBehavior",(function(){return d})),n.d(t,"AppsListPageContainer",(function(){return m}));var r=n(245),o=n.n(r),a=n(303),i=n(1200),s=n(7637),l=n(7638),c=n(5487),p=n(922);function u(){return(u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function d(e){return t=>{var n=Object(a.useRouteMatch)(),[l,p]=Object(r.useState)(void 0),[d,m]=Object(r.useState)(""),[g,h]=Object(r.useState)(""),{rootProps:{areShellProvidersReady:b}}=Object(r.useContext)(c.RootPropsContext);return b?o.a.createElement(e,u({},t,{selectedApp:l,appComponentLibraryId:d,searchFilter:g,selectedPivot:Object(s.getSelectedPivot)(n),onGenericAppSelect:p,onAppComponentLibrarySelect:m,onSearchFilterUpdate:h})):o.a.createElement(i.PagePlaceholder,null)}}var m=Object(p.translateService)("PowerappsPortal")(d(l.AppsListPage))},7637:function(e,t,n){"use strict";n.r(t),n.d(t,"AppPivots",(function(){return r})),n.d(t,"getSelectedPivot",(function(){return i})),n.d(t,"getRouteFromPivot",(function(){return s})),n.d(t,"getAppsListPivots",(function(){return l}));var r,o=n(2812),a=n(3831);function i(e){var t,n=e&&e.url&&Object(o.last)(e.url.split("/"));return n===a.AppPivotUrlStrings.Apps?t=r.Apps:n===a.AppPivotUrlStrings.ComponentLibraries&&(t=r.ComponentLibraries),t}function s(e){return e===r.Apps?"/".concat(a.AppPivotUrlStrings.Apps):e===r.ComponentLibraries?"/".concat(a.AppPivotUrlStrings.ComponentLibraries):""}function l(e,t){return{selectedPivot:i(e),onPivotClick:e=>{t(s(e),!0)}}}!function(e){e.Apps="Apps",e.ComponentLibraries="ComponentLibraries"}(r||(r={}))},7638:function(e,t,n){"use strict";n.r(t),n.d(t,"AppsListPage",(function(){return O}));var r=n(4792),o=n(3076),a=n(7639),i=n(2814),s=n(7640),l=n(3185),c=n(245),p=n.n(c),u=n(2871),d=n(7641),m=n(7642),g=n(5593),h=n(5583),b=n(7595),f=n(7644),y=n(7646),S=n(7661),C=n(7662),v=n(7637),w=n(7664),O=e=>{var t,n,O,{selectedApp:P,appComponentLibraryId:E,searchFilter:A,selectedPivot:j,onGenericAppSelect:L,onAppComponentLibrarySelect:T,onSearchFilterUpdate:k,trackEndPageLoad:R,t:D}=e,{environmentClient:M}=Object(c.useContext)(o.ApolloClientContext),{navigate:N}=Object(c.useContext)(h.NavigationContext),[x,I]=p.a.useState(!1),[F,B]=p.a.useState(!1),[U,G]=p.a.useState(!1),z=D("Controllers.Library.appsPageTitle");Object(c.useEffect)(()=>{B(x)},[x]);var{deleteAppModuleById:H,appModule:_,errorMessage:W}=Object(s.useAppModuleDeleteQuery)(M,g.PortalScope,e.t("Common.Request.Failed")),{appModuleSetStateById:V,appModule:q,stateCode:K,errorMessage:Y}=Object(l.useAppModuleSetStateQuery)(M,g.PortalScope,e.t("Common.Request.Failed"));return u.featureGates.showAppComponents&&(t=p.a.createElement(C.AppsListPagePivotsContainer,null)),j===v.AppPivots.Apps?(n=p.a.createElement("div",{className:"apps-list-page-listcontainer"},p.a.createElement(y.AppsListContainer,{selectedApp:P,onGenericAppSelect:L,searchFilter:A,trackEndPageLoad:R,onDeleteAppModule:H,deletedAppModule:_,deleteAppModuleErrorMessage:W,onAppModuleSetState:V,activatedDeactivatedAppModule:q,newStateCode:K,appModuleSetStateErrorMessage:Y})),O=p.a.createElement(S.AppsListCommandBarContainer,{selectedApp:P,onSearchFilterUpdate:k,navigate:N,deleteAppModuleById:H,appModuleSetStateById:V})):j===v.AppPivots.ComponentLibraries&&(n=p.a.createElement(f.AppComponentLibrariesListContainer,{onAppComponentLibrarySelect:T,appComponentLibraryId:E,onPanelDismiss:null,canRefetch:x,setCanRefetch:I,refetch:F}),O=p.a.createElement(b.AppComponentLibrariesCommandBarContainer,{appComponentLibraryId:E,isDrilledIn:!1,canRefetch:x,setCanRefetch:I,refetch:F})),p.a.createElement(p.a.Fragment,null,p.a.createElement(w.MembersIndicatorChecker,{onMembersIndicatorChecked:e=>G(e)}),p.a.createElement(r.Page,{className:a.appsListPageStyleClasses.appsListPage,renderHeader:()=>O,renderTitle:()=>U?p.a.createElement(m.PageHeaderWithMembersIndicator,{adminCenterUrl:i.settings.powerPlatformAdminCenterUrl,headerProps:{title:z,hideEnvironment:!0}}):p.a.createElement(d.PageHeaderWithEnvContainer,{title:z,hideEnvironment:!0}),renderBody:()=>p.a.createElement("div",null,t,n)}))}},7639:function(e,t,n){"use strict";n.r(t),n.d(t,"appsListPageStyleClasses",(function(){return o}));var r=n(719),o=Object(r.mergeStyleSets)({appsListPage:{selectors:{".ba-Pivot":{selectors:{".ms-Pivot":{paddingBottom:"10px"}}},".ba-CommandBar":{selectors:{".ms-CommandBar":{paddingLeft:"32px"}}},".ba-Page-Header":{paddingBottom:"10px"}}}})},7640:function(e,t,n){"use strict";n.r(t),n.d(t,"useAppModuleDeleteQuery",(function(){return c}));var r=n(217),o=n(245),a=n(3186),i=n(3192),s=n(3193),l=n(3194);function c(e,t,n){var c=s.TelemetryScenarioNames.appModuleGraphQl,[p,u]=Object(o.useState)(),[d,m]=Object(o.useState)(""),[g,{loading:h,data:b}]=Object(a.useMutation)(l.DeleteAppModuleQuery,{client:e||void 0,onCompleted:()=>{p&&p.complete(),m("")},onError:e=>{var t=e.message,r=Object(i.getResponseMessageFromApolloError)(e,n);m(r),p&&p.failure({error:r,clientError:t})}});return Object(o.useEffect)(()=>{h&&u(Object(r.trackLoadScenario)(t,c))},[h]),{deleteAppModuleById:g,loading:h,errorMessage:d,appModule:b&&b.deleteAppModuleById.appModuleId}}},7641:function(e,t,n){"use strict";n.r(t),n.d(t,"mergeProps",(function(){return m})),n.d(t,"PageHeaderWithEnvContainer",(function(){return g}));var r=n(4105),o=n(5437),a=n(5487),i=n(2880),s=n(5582),l=["title","hideEnvironment","rootProps"];function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var m=(e,t,n)=>{var r,{title:o,hideEnvironment:a,rootProps:c}=n,u=d(n,l),m=Object(s.currentEnvironmentDisplayName)(n);return r=void 0!==a&&a?o:Object(i.formatResourceString)(n.title,m),p(p({},u),{},{title:r})},g=Object(a.withRootProps)(Object(o.connect)(null,null,m)(r.PageHeader))},7642:function(e,t,n){"use strict";n.r(t),n.d(t,"PageHeaderWithMembersIndicator",(function(){return c}));var r=n(245),o=n.n(r),a=n(719),i=n(7643),s=n(7641),l=Object(a.mergeStyleSets)({membersIndicatorContainer:{position:"absolute",top:10,right:45,width:"100%"},titleAreaContainer:{height:54},titleContainer:{paddingTop:10}}),c=e=>o.a.createElement("div",{className:l.titleAreaContainer},o.a.createElement("div",{className:l.titleContainer},o.a.createElement(s.PageHeaderWithEnvContainer,e.headerProps)),o.a.createElement("div",{className:l.membersIndicatorContainer},o.a.createElement(i.MembersIndicatorLoader,{adminCenterUrl:e.adminCenterUrl})))},7643:function(e,t,n){"use strict";n.r(t),n.d(t,"MembersIndicatorLoader",(function(){return s}));var r=n(1074),o=n(922);function a(e,t,n,r,o,a,i){try{var s=e[a](i),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}function i(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function s(e){a(i,r,o,s,l,"next",e)}function l(e){a(i,r,o,s,l,"throw",e)}s(void 0)}))}}var s=Object(r.default)(i((function*(){var[e]=yield Promise.all([Promise.all([n.e(108),n.e(439),n.e(437),n.e(82)]).then(n.bind(null,29625)),Object(o.loadNamespaces)(["MembersIndicator"])]);return e.MembersIndicatorWrapper})))},7644:function(e,t,n){"use strict";n.r(t),n.d(t,"getSelection",(function(){return L})),n.d(t,"withAppComponentLibrariesListBehavior",(function(){return T})),n.d(t,"mapDispatchToProps",(function(){return k})),n.d(t,"mergeProps",(function(){return R})),n.d(t,"AppComponentLibrariesListContainer",(function(){return D}));var r=n(245),o=n.n(r),a=n(1473),i=n(545),s=n(3076),l=n(922),c=n(7645),p=n(5669),u=n(5629),d=n(7596),m=n(7598),g=n(3196),h=n(5593),b=n(5437),f=n(5649),y=n(1190),S=n(5468),C=n(5478),v=["onAppComponentLibrarySelect","appComponentLibraryId","environmentClient","t","tReady","onPanelDismiss","setCanRefetch","canRefetch","refetch"];function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(Object(n),!0).forEach((function(t){P(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function P(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function E(){return(E=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function A(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var j=Object(u.withLoadTelemetry)(c.AppComponentLibrariesList,p.LoadScenarioNames.AppComponentLibrariesList),L=Object(i.memoizeFunction)(e=>{var t=new a.Selection({onSelectionChanged:()=>{var n,r=t.getSelection().length>0?t.getSelection()[0]:null;e&&e(null!==(n=null==r?void 0:r.id)&&void 0!==n?n:"")},getKey:e=>e.id});return t});function T(e){return t=>{var{onAppComponentLibrarySelect:n,appComponentLibraryId:r,environmentClient:a,t:i,tReady:s,onPanelDismiss:l,setCanRefetch:c,canRefetch:p,refetch:S}=t,C=A(t,v),w=Object(b.useSelector)(f.deletedComponentLibraryAppId),{errorMessage:O,appComponentLibraries:P}=Object(g.useAppComponentLibrariesListPollingQuery)(a,{},h.PortalScope,i("Common.Request.Failed"),!1,e=>{var t=e&&e.canvasApps;return t&&!!t.find(e=>Object(y.equalsIgnoreCase)(e.id,w))},S),j=P&&P.find(e=>Object(y.equalsIgnoreCase)(e.id,r)),T=j||void 0,k=Object(d.useAppComponentLibraryCommands)({context:m.CommandContexts.ContextMenu,isItemSelected:!0,isDrilledIn:!1,appComponentLibraryId:r,isEditable:!(null==T||!T.isEditable),isCustomizable:!(null==T||!T.isCustomizable),appComponentLibrary:T,canRefetch:p,setCanRefetch:c,onPanelDismiss:l});return o.a.createElement(e,E({},C,{listItems:P||[],menuItems:k,selection:L(n),loadProgress:[Object(u.toLoadingState)(void 0!==P,O)],onAppComponentLibrarySelect:n,getKey:e=>e.id,t:i,tReady:s}))}}var k=(e,t)=>({dispatchPanelClose:()=>{e(S.sharedActions.panelClose({panelType:C.PanelToShowType.AppComponentLibraryRenamePanel}))}}),R=(e,t,n)=>{var{dispatchPanelClose:r}=t;return O(O({},n),{},{onPanelDismiss:e=>{r(e)}})},D=Object(l.translateService)("PowerappsPortal")(Object(s.withApolloClient)(Object(b.connect)(null,k,R)(T(j))))},7645:function(e,t,n){"use strict";n.r(t),n.d(t,"AppComponentLibrariesList",(function(){return T}));var r=n(3064),o=n(3161),a=n(3179),i=n(3167),s=n(2752),l=n(687),c=n(545),p=n(245),u=n.n(p),d=n(5606),m=n(5596),g=n(7606),h=n(5593),b=n(5669),f=n(2879),y=n(5481),S=n(5583),C=n(5601),v=n(5633),w=n(5674),O=n(7597),P=n(2840);function E(){return(E=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function A(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?A(Object(n),!0).forEach((function(t){L(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):A(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function L(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var T=e=>{var{listItems:t,menuItems:n,loadProgress:A,selection:L,t:T,tReady:k}=e,{navigate:R}=Object(p.useContext)(S.NavigationContext),D=Object(O.useCreateComponentLibrary)();return u.a.createElement(g.LoadOrderDetailsList,E({},Object(v.getDetailsListProps)(T("Common.rowSelectionAriaLabel")),{listKey:"AppComponentLibrariesList",items:t,loadProgress:A,columns:Object(p.useMemo)(()=>((e,t,n)=>{var o=Object(r.buildMenuColumn)(()=>({items:e,iconAriaLabel:t("Common.commands")})),i=Object(r.buildIconColumn)(e=>({iconUri:e.imageUrl||m.DefaultAppBackgroundImageUri,iconAltText:e.displayName,iconBackgroundColor:e.imageBackgroundColor}),r.RowHeight.medium);i.iconName=f.fabricIcons.AppIconDefault,i.isIconOnly=!0,i.headerClassName=a.appsListStyleClasses.iconHeader;var s={isCollapsable:!0,isResizable:!0,isPadded:!0,isMultiline:!1,sortAscendingAriaLabel:t("Common.Sorting.ascending"),sortDescendingAriaLabel:t("Common.Sorting.descending")};return[i,j(j({},s),{},{isRowHeader:!0,key:"displayName",name:t("Common.name"),fieldName:"displayName",minWidth:50,maxWidth:350,onRender:e=>{var t={onClick:()=>{Object(h.trackUserActionClickButton)(b.AppComponentLibraryActionNames.Details);var t=d.SagaContextProps.getCurrentEnvironment();w.ComponentLibraryCommandActions.onComponentLibraryEditClick(e.id,t,n)},onContextMenu:e=>(e.preventDefault(),!1),disabled:!(e.isEditable&&Object(P.featureGatedIsCustomizable)(e.isCustomizable))};return u.a.createElement(r.DetailsListLink,{linkText:e.displayName,linkProps:t})}}),o,j(j({},s),{},{key:"lastModifiedDate",name:t("Common.modified"),fieldName:"lastModifiedDate",minWidth:100,maxWidth:160,onRender:e=>e.lastModifiedDate?Object(C.getFriendlyRelativeTimeString)(new Date(e.lastModifiedDate)):""}),j(j({},s),{},{key:"ownerName",name:t("Common.owner"),fieldName:"ownerName",minWidth:100,maxWidth:190}),j(j({},s),{},{key:"isEditable",fieldName:"isEditable",name:t("Apps.AppComponentLibrariesList.Columns.editable"),minWidth:60,maxWidth:100,onRender:e=>e.isEditable&&Object(P.featureGatedIsCustomizable)(e.isCustomizable)?t("Apps.AppComponentLibrariesList.Columns.isEditable"):t("Apps.AppComponentLibrariesList.Columns.isNotEditable")})]})(n,T,R),[n,T]),selection:L,renderOnEmpty:()=>{var e=j(j({},Object(i.getCommonPropsOnErrorOrEmptySearch)()),{},{icon:{iconType:l.IconType.image,imageProps:{src:s.default.getPaths().componentLibraryEmptyState,styles:{root:{marginBottom:"20px"}}}},className:"apps-list-empty-message",primaryMessage:k?T("Apps.NoComponentLibraries.message"):"",secondaryMessage:k?T("Apps.NoComponentLibraries.description"):"",learnMoreLabel:k?T("Apps.NoComponentLibraries.learnMore"):"",learnMoreProps:{href:y.default.componentLibraryLearnMoreLink,target:"_blank"},callToActionText:k?T("Apps.NoComponentLibraries.createComponentLibrary"):"",callToActionProps:{onClick:()=>{D()}}});return u.a.createElement(o.EmptyState,e)},selectionMode:c.SelectionMode.single,setKey:"staticKey"}))}},7646:function(e,t,n){"use strict";n.r(t),n.d(t,"AppsListContainer",(function(){return oe})),n.d(t,"createGenericAppListItems",(function(){return le})),n.d(t,"mapStateToProps",(function(){return ce})),n.d(t,"mapDispatchToProps",(function(){return pe})),n.d(t,"mergeProps",(function(){return ue})),n.d(t,"AppsListContainerInternal",(function(){return de}));var r=n(2836),o=n(3156),a=n(3076),i=n(7647),s=n(2810),l=n(3199),c=n(5641),p=n(3185),u=n(3197),d=n(6379),m=n(2830),g=n(922),h=n(2812),b=n(545),f=n(245),y=n.n(f),S=n(5437),C=n(5487),v=n(5604),w=n(5596),O=n(5644),P=n(5645),E=n(5593),A=n(5629),j=n(7648),L=n(5493),T=n(5583),k=n(5601),R=n(5630),D=n(5623),M=n(5648),N=n(5649),x=n(5653),I=n(5667),F=n(5987),B=n(5474),U=n(7493),G=n(5595),z=n(5636),H=n(7651),_=n(5639),W=n(7652),V=n(7655),q=n(7657),K=n(7658),Y=n(7659),Q=["searchFilter","appCommandActions","rootProps","newAppModules"],X=["dispatchPowerPortalStarterSolutionRequest","dispatchPowerPortalAppListCancelPoll","dispatchPowerPortalCancelPoll","dispatchPowerPortalAppListRequest","dispatchAppsListRequest","dispatchAppModulesListRequest","dispatchAppsListCancelPoll","dispatchAppModulesListCancelPoll"],J=["appListFilterType","arePowerPortalsAllowed","powerPortalsLoadState"];function $(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function Z(){return(Z=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function ee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ee(Object(n),!0).forEach((function(t){ne(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ee(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ne(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var re=!1,oe=Object(g.translateService)("PowerappsPortal")(Object(a.withApolloClient)(e=>{var t,n,{environmentClient:r,onGenericAppSelect:o,selectedApp:a}=e,i=Object(f.useContext)(C.RootPropsContext),[s,l]=Object(f.useState)([]),[c,g]=Object(f.useState)(void 0),[h,b]=Object(f.useState)(void 0),S=!Object(v.environmentHasCds2Database)(i.rootProps.currentEnvironment),{solution:O}=Object(d.useSolutionByUniqueName)(r,"msdyn_AppProfileManager",E.PortalScope,"requestFailed",S),P=Object(Y.useIsWrapCommandApplicable)(e.environmentClient,Object(_.isICanvasApp)(a)&&w.isSolutionAware(a),S);return O&&(re=!0),({appModules:t,errorMessage:n}=Object(p.useAppModulesListQuery)(r,E.PortalScope,e.t("Common.Request.Failed"),u.TwoMinutesPollTimeInMs,S,!0)),y.a.useEffect(()=>{t&&l(t)},[t,l]),y.a.useEffect(()=>{e.deleteAppModuleErrorMessage&&g({success:!1,failed:!0,message:e.deleteAppModuleErrorMessage}),e.deletedAppModule&&(l(s.filter(t=>t.id!==e.deletedAppModule)),g({success:!0,failed:!1,message:e.t("AppModules.Delete.successMessage")}))},[e.deletedAppModule,e.deleteAppModuleErrorMessage,l,g]),y.a.useEffect(()=>{e.appModuleSetStateErrorMessage&&g({success:!1,failed:!0,message:e.appModuleSetStateErrorMessage}),e.activatedDeactivatedAppModule&&(l(s.map(t=>t.id===e.activatedDeactivatedAppModule?te(te({},t),{},{statecode:e.newStateCode}):t)),a.id===e.activatedDeactivatedAppModule&&o(te(te({},a),{},{statecode:e.newStateCode})),g({success:!0,failed:!1,message:e.newStateCode===m.StateCodeEnabledDisabled.Enabled?e.t("AppModules.Activate.successMessage"):e.t("AppModules.Deactivate.successMessage")}))},[e.activatedDeactivatedAppModule,e.appModuleSetStateErrorMessage,l,g]),y.a.useEffect(()=>{e.deleteCanvasAppErrorMessage&&b({success:!1,failed:!0,message:e.deleteCanvasAppErrorMessage})},[e.deleteCanvasAppErrorMessage,b]),y.a.createElement(de,Z({},e,i,{newAppModules:s,newAppModulesErrorMessage:n,onDeleteAppModule:e.onDeleteAppModule,newAppModuleActionResponse:c,newDeleteCanvasAppResponse:h,includeWrap:P}))})),ae=Object(b.memoizeFunction)(e=>{var t=e.lastModifiedDate?new Date(e.lastModifiedDate):new Date,n=te(te({},e),{},{imageUrl:L.default.getPaths().appModuleDefaultIcon,key:e.id,owner:e.ownerName,webResourceId:e.webresourceid,displayModifiedDate:Object(k.getFriendlyRelativeTimeString)(t),dateModified:t,appType:o.AppTypes.Model,displayAppTypeName:H.getAppTypeDisplayName(o.AppTypes.Model),isPlayEnabled:c.canAppModuleBePlayedOrShared(e),getGenericApp:()=>te(te({},e),{},{uniquename:e.uniqueName,appmoduleid:e.id,publishedon:e.publishedOn,componentstate:e.componentState,ismanaged:e.isManaged})});return n.filterOn=[n.name,n.displayModifiedDate,n.displayAppTypeName,n.owner],n}),ie=Object(b.memoizeFunction)(e=>{var t=new q.AppListItem(e);return t.filterOn=[t.name,t.displayModifiedDate,t.displayAppTypeName,t.owner],t.key=t.id,t.isPlayEnabled=!0,t}),se=Object(b.memoizeFunction)(e=>{var t=new K.PowerPortalListItem(e);return t.filterOn=[t.name,t.displayModifiedDate,t.displayAppTypeName,t.owner],t.key=t.id,t.isPlayEnabled=!0,t}),le=(e,t,n)=>{var r;r=e?e.map((e,t)=>ae(e)):[];var o=t?t.map((e,t)=>ie(e)):[],a=n?n.map((e,t)=>se(e)):[],i=r.concat(o).concat(a);return H.sortAppsByModifiedDate(i)},ce=(e,t)=>{var{allowListFeatures:n,rootProps:a,newAppModules:s,newAppModulesErrorMessage:l,newAppModuleActionResponse:c,newDeleteCanvasAppResponse:p}=t,u=a.currentEnvironment,d=u&&u.id,m=Object(v.environmentHasCds2Database)(u),g=Object(F.environmentHasCDSOrgSelector)(e,d),h=Object(i.setCanvasAppFetchErrorIsExpected)(N.appsError(e)),b=F.portalListFetchError(e,d),f=F.powerPortalSitewideFetchError(e,d),y=u&&N.filteredApps(e,d);y=y.filter(e=>e.appType!==r.CustomCanvasPage);var S,C=F.powerPortalsListSelector(e,d),w=le(s,y,C),P=m,E=F.powerPortalSitewideListExistsSelector(e,d),{ShowD365PowerPortalTiles:j}=n,L=E!==O.PowerPortalsSitewideState.NotExists&&m&&(g||j&&!g),T=Object(A.toLoadingState)(Object(N.isAppsListCachedComplete)(e,d),h,o.AppTypes.Canvas);S=Object(A.toLoadingState)(void 0!==s,l,o.AppTypes.Model,P);var k=Object(A.toLoadingState)(Object(F.isPowerPortalListCachedComplete)(e,d),b||f,o.AppTypes.PowerPortal,L),R=[T,S,k];return{appListFilterType:N.appsListFilterType(e),appListItems:w,loadProgress:R,logEvent:G.AppListLoadEvent,appModuleActionResponse:c||Object(N.deleteAppModuleResponseStatus)(e),deleteCanvasAppResponse:p||Object(N.deleteCanvasAppResponseStatus)(e),powerPortalsLoadState:k,arePowerPortalsAllowed:L,enableTestStudio:n.EnableTestStudio,isPortalsCDSOrg:!!g,showD365PowerPortalTiles:n.ShowD365PowerPortalTiles,isPortalsCDSOrgError:Object(F.powerPortalFetchIsCDSOrgError)(e,u.id),enablePowerPortalPublicPreview:n.EnablePowerPortalPublicPreview,powerPortalGenericError:Object(F.powerPortalGenericErrorSelector)(e,u.id)}},pe=(e,t)=>({dispatchAppsListRequest:t=>{e(Object(M.fetchAppsRequest)({appsListFilter:t,forceRefresh:!0}))},dispatchAppModulesListRequest:t=>{e(Object(x.fetchAppModulesRequest)({appModuleListFilter:t,forceRefresh:!0}))},dispatchPowerPortalStarterSolutionRequest:()=>{e(Object(I.fetchPowerPortalStarterSolutionRequest)())},dispatchPowerPortalAppListRequest:n=>{e(Object(I.fetchPowerPortalsListRequest)(t.environmentClient,{forceRefresh:!0}))},dispatchAppsListCancelPoll:()=>{e(Object(M.fetchAppsCancelPoll)())},dispatchAppModulesListCancelPoll:()=>{e(Object(x.fetchAppModulesCancelPoll)())},dispatchPowerPortalAppListCancelPoll:()=>{e(Object(I.fetchPowerPortalWebsitesCancelPoll)()),e(Object(I.fetchPowerPortalCancelPoll)())},dispatchPowerPortalCancelPoll:()=>{e(Object(I.fetchPowerPortalCancelPoll)())},onExploreTemplatesClick:()=>t.navigate(D.templateAppsRoute.canvas,!0),onAppsListTypeChange:t=>e(Object(R.logAction)(Object(B.telemetryLogAction)(),G.AppsListTypeChangeEvent.eventName,G.AppsListTypeChangeEvent.getData(t))),dispatchTelemetry:e,clearAppModuleActionResponseMessage:()=>e(Object(M.clearAppModuleResponse)()),clearDeleteCanvasAppResponseMessage:()=>e(Object(M.clearCanvasAppResponse)()),clearPowerPortalGenericErrorMessage:()=>e(Object(I.clearPowerPortalGenericErrorMessage)({environmentId:t.rootProps.currentEnvironment.id})),powerPortalGenericErrors:n=>e(Object(I.powerPortalGenericErrors)({error:n.exception,environmentId:t.rootProps.currentEnvironment.id,messageType:n.messageBarType,powerPortal:n.powerPortal}))}),ue=(e,t,n)=>{var{searchFilter:r,appCommandActions:o,rootProps:a,newAppModules:i}=n,s=$(n,Q),{dispatchPowerPortalStarterSolutionRequest:l,dispatchPowerPortalAppListCancelPoll:c,dispatchPowerPortalCancelPoll:p,dispatchPowerPortalAppListRequest:u,dispatchAppsListRequest:d,dispatchAppModulesListRequest:m,dispatchAppsListCancelPoll:g,dispatchAppModulesListCancelPoll:b}=t,f=$(t,X),{appListFilterType:S,arePowerPortalsAllowed:C,powerPortalsLoadState:w}=e,O=$(e,J),E=a.currentEnvironment,L=w.state===A.ComponentLoadState.Complete,T=Object(H.getUnexpectedErrorMessage)(e.loadProgress);return te(te(te(te({},O),f),s),{},{arePowerPortalsAllowed:C,appListFilterType:S,currentEnvironment:E,searchFilter:r||"",onMount:()=>{E&&(Object(v.environmentHasCds2Database)(E)&&e.showD365PowerPortalTiles&&!e.isPortalsCDSOrg&&!e.isPortalsCDSOrgError&&t.dispatchTelemetry&&t.dispatchTelemetry(Object(I.fetchIsCDSOrgRequest)({orgUrl:v.getCrmInstanceUrl(E)},n.environmentClient)),n.fetchCdsOrgSettings(E.id),d(S),Object(v.environmentHasCds2Database)(E)&&(l(),C&&u(P.PowerPortalListType.Recent)))},onDismount:()=>{g(),Object(v.environmentHasCds2Database)(E)&&(b(),L&&c())},portalOnBlur:()=>{C&&p()},portalOnFocus:()=>{C&&u(P.PowerPortalListType.Recent)},MessageBar:y.a.createElement(y.a.Fragment,null,!Object(h.isEmpty)(e.appListItems)&&!Object(h.isEmpty)(T)&&y.a.createElement(V.ErrorMessageBar,{errorMessage:T}),y.a.createElement(V.PowerPortalMessageBar,{errorProperties:e.powerPortalGenericError,clearErrorMessage:t.clearPowerPortalGenericErrorMessage,t:n.t}),y.a.createElement(V.AppModuleActionMessageBar,{appModuleActionResponse:e.appModuleActionResponse,clearAppModuleActionResponseMessage:t.clearAppModuleActionResponseMessage}),y.a.createElement(V.DeleteCanvasAppMessageBar,{deleteCanvasAppResponse:e.deleteCanvasAppResponse,clearDeleteCanvasAppResponseMessage:t.clearDeleteCanvasAppResponseMessage}),y.a.createElement(j.UpdateEnvVarValuesMessageBarContainer,null)),getMenuColumn:t=>({items:Object(_.getGenericAppContextMenuCommands)({appCommandActions:n.appCommandActions,appModuleCommandActions:n.appModuleCommandActions,powerPortalCommandActions:n.powerPortalCommandActions,genericApp:t.getGenericApp(),currentEnvironment:E,enableTestStudio:e.enableTestStudio,enablePowerPortalPublicPreview:e.enablePowerPortalPublicPreview,profileManagerEnabled:re,onDeleteAppModule:n.onDeleteAppModule,onAppModuleSetState:n.onAppModuleSetState,includeWrap:n.includeWrap}),iconAriaLabel:n.t("Common.commands")}),onTitleClick:e=>Object(z.appsListTitleClick)(e,n.appCommandActions,n.powerPortalCommandActions,n.appModuleCommandActions),selectionChangeLogic:r=>Object(z.appSelectionChange)(r,e.enablePowerPortalPublicPreview,t.powerPortalGenericErrors,t.clearPowerPortalGenericErrorMessage,n.onGenericAppSelect)})},de=Object(l.withAllowListFeatures)(Object(T.withNavigation)(Object(_.withGenericAppCommands)(G.AppContexts.AppsList.ContextMenu)(Object(a.withApolloClient)(Object(U.withSampleAppCommands)(G.AppContexts.AppsList.ContextMenu)(Object(S.connect)(ce,pe,ue)(Object(A.withLoadTelemetry)(W.AppsList,s.LoadScenarioNames.AppsList)))))))},7647:function(e,t,n){"use strict";function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.r(t),n.d(t,"setCanvasAppFetchErrorIsExpected",(function(){return i}));var i=e=>e&&"The Dynamics 365 organization you are attempting to access is currently disabled.  Please contact your system administrator"===e.errorMessage?o(o({},e),{},{isExpected:!0}):e},7648:function(e,t,n){"use strict";n.r(t),n.d(t,"mapStateToProps",(function(){return h})),n.d(t,"mapDispatchToProps",(function(){return b})),n.d(t,"mergeProps",(function(){return f})),n.d(t,"UpdateEnvVarValuesMessageBarContainer",(function(){return y}));var r=n(5437),o=n(5468),a=n(5478),i=n(5816),s=n(6383),l=n(7649),c=n(5693),p=n(5704),u=n(5487);function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){g(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var h=e=>({setEnvVariablesRequired:Object(i.envVariablesNeedValueSelector)(e),setConRefsRequired:Object(s.conRefsNeedUpdateSelector)(e)}),b=e=>({openUpdateEnvVariablePanel:()=>{e(o.sharedActions.panelOpen({panelType:a.PanelToShowType.UpdateEnvVariablesPanel,panelProps:{},stayMountedWhenHidden:!1}))},openUpdateConReferencePanel:()=>{e(o.sharedActions.panelOpen({panelType:a.PanelToShowType.UpdateConRefsPanel,panelProps:{},stayMountedWhenHidden:!1}))},onMount:()=>{e(Object(c.fetchEnvironmentVariableData)({})),e(Object(p.fetchConnectionReferenceData)({}))}}),f=(e,t,n)=>m(m(m({},e),t),{},{currentEnvironment:n.rootProps&&n.rootProps.currentEnvironment}),y=Object(u.withRootProps)(Object(r.connect)(h,b,f)(l.UpdateEnvVarValuesMessageBar))},7649:function(e,t,n){"use strict";n.r(t),n.d(t,"UpdateEnvVarValuesMessageBar",(function(){return m}));var r=n(7650),o=n(245),a=n(1090),i=n(2871),s=n(1697),l=n(2880),c=n(2882),p=n(5675),u=n(5604),d=n(2869);class m extends o.Component{constructor(e){super(e),this.props=e,this.resources=void 0,this.resources=Object(d.getResources)()}componentDidMount(){Object(p.shouldShowEnvironmentVariables)(Object(u.getCrmVersion)(this.props.currentEnvironment))&&this.props.onMount()}render(){if(i.featureGates.enableUpdateConnectionReferencePanel){var{setEnvVariablesRequired:e,setConRefsRequired:t}=this.props;return(e.length>0||t.length>0)&&Object(p.shouldShowEnvironmentVariables)(Object(u.getCrmVersion)(this.props.currentEnvironment))&&o.createElement(s.MessageBar,{messageBarType:s.MessageBarType.severeWarning},this.getFormattedMessageBarTextContent())}var n=this.props.setEnvVariablesRequired.length,r=1===n?this.resources.Model.Solutions.UpdateEnvVarValuesPanel.singularMessageBarText:Object(l.formatResourceString)(this.resources.Model.Solutions.UpdateEnvVarValuesPanel.messageBarText,this.props.setEnvVariablesRequired.length),d=1===n?this.resources.Model.Solutions.UpdateEnvVarValuesPanel.singularMessageBarLink:this.resources.Model.Solutions.UpdateEnvVarValuesPanel.messageBarLink;return this.props.setEnvVariablesRequired.length>0&&Object(p.shouldShowEnvironmentVariables)(Object(u.getCrmVersion)(this.props.currentEnvironment))&&o.createElement(s.MessageBar,{messageBarType:s.MessageBarType.severeWarning},o.createElement("span",null,r)," ",o.createElement(a.Link,{style:{color:c.fabricColors.communicationBlue},onClick:()=>this.props.openUpdateEnvVariablePanel()},d))}getFormattedMessageBarTextContent(){var{setEnvVariablesRequired:e,setConRefsRequired:t}=this.props,{messageBarSingleEnvVariablesLink:n,messageBarEnvVariablesLink:a,messageBarSingleConRefsLink:i,messageBarConRefsLink:s,messageBarBothNeedToUpdateText:p,messageBarSingleNeedToUpdateText:u}=this.resources.Model.Solutions.UpdateEnvVarValuesPanel,d={style:{color:c.fabricColors.communicationBlue},onClick:this.props.openUpdateEnvVariablePanel,text:1===e.length?n:Object(l.formatResourceString)(a,e.length)},m={style:{color:c.fabricColors.communicationBlue},onClick:this.props.openUpdateConReferencePanel,text:1===t.length?i:Object(l.formatResourceString)(s,t.length)};return e.length>0&&t.length>0?o.createElement(r.LinksWithInterpolation,{interpolatedString:p,links:[d,m]}):e.length>0?o.createElement(r.LinksWithInterpolation,{interpolatedString:u,links:[d]}):t.length>0?o.createElement(r.LinksWithInterpolation,{interpolatedString:u,links:[m]}):null}}},7650:function(e,t,n){"use strict";n.r(t),n.d(t,"LinksWithInterpolation",(function(){return l}));var r=n(245),o=n(719),a=n(1259);function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var s=/\{[a-zA-Z$_\d]*\}/g;class l extends r.Component{constructor(){super(...arguments),this.getClassNames=Object(a.classNamesFunction)(),this.getStyles=()=>{var{textColor:e}=this.props;return{text:{color:e||Object(o.getTheme)().palette.neutralDark,selectors:{[o.HighContrastSelector]:{color:"inherit"}}}}}}render(){var{className:e}=this.props;return r.createElement("div",{className:e},this.interpolatedLinks)}get interpolatedLinks(){var{interpolatedString:e,links:t,overrideLinksColor:n}=this.props,l=e.split(s),c=Object(o.getTheme)().palette,p=this.getClassNames(this.getStyles);return 1===l.length&&(l[0]="".concat(l[0]," ")),l.map((e,o)=>r.createElement("span",{key:"span-".concat(o),className:p.text},e,t[o]&&r.createElement(a.Link,i({style:{color:!1===n?void 0:c.themePrimary},key:"link-".concat(o)},t[o],{"data-automation-id":t[o].dataAutomationId}),t[o].text)))}}},7651:function(e,t,n){"use strict";n.r(t),n.d(t,"getAppTypeDisplayName",(function(){return c})),n.d(t,"getAppImageUrl",(function(){return p})),n.d(t,"getAppModulesListFilterType",(function(){return u})),n.d(t,"sortAppsByModifiedDate",(function(){return d})),n.d(t,"getUnexpectedErrorMessage",(function(){return m}));var r=n(2812),o=n(5651),a=n(5596),i=n(2869),s=n(5629),l=n(3155);function c(e){var t=Object(i.getResources)();return l.getAppTypeDisplayName(e,t.Common.model,t.Common.powerportal,t.Common.canvas,t.Common.customCanvasPage)}function p(e,t){return l.getAppImageUri(e,t)}function u(e){switch(e){case a.AppListType.Recent:case a.AppListType.Editable:case a.AppListType.Org:case a.AppListType.SharedWithMe:default:return o.AppModuleListType.Recent}}function d(e){if(e)return Object(r.orderBy)(e,e=>e.dateModified,"desc")}function m(e){return Object(s.getErrors)(e).filter(e=>"401"!==e.responseCode&&"403"!==e.responseCode).map(e=>e.errorMessage).join(";")}},7652:function(e,t,n){"use strict";n.r(t),n.d(t,"AppsList",(function(){return N}));var r=n(3064),o=n(3161),a=n(3156),i=n(3179),s=n(3169),l=n(3167),c=n(3171),p=n(2810),u=n(2813),d=n(2812),m=n(1471),g=n(687),h=n(1240),b=n(790),f=n(545),y=n(245),S=n(2871),C=n(5596),v=n(5644),w=n(5645),O=n(7606),P=n(5629),E=n(2879),A=n(2880),j=n(5633),L=n(7496),T=n(7653);function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function R(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(Object(n),!0).forEach((function(t){D(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function D(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function M(){return(M=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}class N extends y.Component{constructor(e){super(e),this.appsListRef=void 0,this.selection=void 0,this.renderRow=(e,t)=>{if(e.item.appType===a.AppTypes.PowerPortal&&this.props.enablePowerPortalPublicPreview){var n=Object(w.getPortalState)(e.item.app.portalProperties.CategoryBrowse),r=e.item.app&&e.item.app.portalProperties;if(n===w.PowerPortalState.ProvisioningInProgress||n===w.PowerPortalState.ProvisioningComplete&&(r.PackageStatus===v.PowerPortalPackageStatus.None||r.PackageStatus===v.PowerPortalPackageStatus.Installing))return y.createElement("div",{className:i.appsListStyleClasses.disabledRow},t(e))}return t(e)},this.onListKeyChange=()=>{this.props.onMount(),this.props.onAppsListTypeChange(this.props)},this._onDismissSampleAppPreview=()=>{},this.selection=new m.Selection({onSelectionChanged:()=>{var e=this.selection.getSelection().length>0?this.selection.getSelection()[0]:void 0;this.props.selectionChangeLogic(e)},canSelectItem:this.canSelectItem.bind(this)}),this.appsListRef=y.createRef()}canSelectItem(e){if(e&&e.appType===a.AppTypes.PowerPortal){var t=e.portalAppListItemInfo();if(t.portalProvisioningStatus===w.PowerPortalState.ProvisioningInProgress||t.portalProvisioningStatus===w.PowerPortalState.ProvisioningComplete&&(t.portalPackageStatus===v.PowerPortalPackageStatus.None||t.portalPackageStatus===v.PowerPortalPackageStatus.Installing))return!1}return!0}componentDidUpdate(e){var t=Object(u.hasACompletion)(e.loadProgress),n=Object(u.hasACompletion)(this.props.loadProgress);!t&&n&&this.props.trackEndPageLoad&&this.props.trackEndPageLoad(this.props.loadProgress)}componentDidMount(){this.props.onMount(),this.props.clearPowerPortalGenericErrorMessage(),S.featureGates.enablePowerPortalPollingImprovements&&(window.addEventListener("focus",this.handleOnFocus.bind(this)),window.addEventListener("blur",this.handleOnBlur.bind(this)))}componentWillUnmount(){this.props.onDismount(),S.featureGates.enablePowerPortalPollingImprovements&&(window.removeEventListener("focus",this.handleOnFocus.bind(this)),window.removeEventListener("blur",this.handleOnBlur.bind(this)))}getListKey(){return"".concat(this.props.currentEnvironment&&this.props.currentEnvironment.id," ").concat(this.props.appListFilterType," ").concat(this.props.arePowerPortalsAllowed)}handleOnFocus(){this.props.portalOnFocus()}handleOnBlur(){this.props.portalOnBlur()}render(){var e,t,{appListItems:n,loadProgress:r,searchFilter:a,sampleAppCommands:i,numberOfAppsToShow:c,t:m}=this.props,g=Object(P.isLoading)(r),h=Object(d.isEmpty)(n)&&Object(u.hasErrorMessage)(r);return g||(t=()=>{var e=this.getPropsOnEmpty(m);return y.createElement(o.EmptyState,e)}),e=y.createElement("div",{ref:this.appsListRef},this.props.MessageBar,y.createElement(O.LoadOrderDetailsList,M({ariaLabelForGrid:p.LoadScenarioNames.AppsList,listName:p.LoadScenarioNames.AppsList,listKey:this.getListKey(),onListKeyChange:this.onListKeyChange,loadProgress:r,numberOfItemsToShow:c,renderOnEmpty:t,filter:a,renderOnEmptySearch:()=>{var e=Object(l.getPropsOnEmptySearch)(s.appsListEmptyMessageClassName,this.props.t("Common.Search.NoMatch.title"),this.props.t("Common.Search.NoMatch.message"));return y.createElement(o.EmptyState,e)},isError:h,renderOnError:()=>{var e=Object(l.getPropsOnError)(s.appsListEmptyMessageClassName,this.props.loadProgress,m("Common.Request.Failed"));return y.createElement(o.EmptyState,e)},items:n,onRenderRow:this.renderRow,columns:this.buildColumns(),setKey:"set",selectionMode:f.SelectionMode.single,selection:this.selection,filterAnnouncement:e=>Object(A.formatResourceString)(this.props.t("Common.Search.Results"),e)},Object(j.getDetailsListProps)(this.props.t("Common.rowSelectionAriaLabel"))))),y.createElement("div",{className:"apps-list"},e,y.createElement(L.CreateAppModalContainer,{sampleAppCommands:i,onDismissSampleAppPreview:this._onDismissSampleAppPreview}))}buildColumns(){this.props.getMenuColumn.bind(this);var e=Object(r.buildMenuColumn)(this.props.getMenuColumn),t=Object(r.buildIconColumn)(e=>({iconUri:e.imageUrl,iconAltText:e.name,iconBackgroundColor:e.imageBackgroundColor,defaultIconUrl:C.DefaultAppBackgroundImageUri}),r.RowHeight.medium);return this.props.enablePowerPortalPublicPreview&&(t.onRender=this.getAppImage.bind(this)),t.iconName=E.fabricIcons.AppIconDefault,t.isIconOnly=!0,t.headerClassName=i.appsListStyleClasses.iconHeader,[t,{key:"name",name:this.props.t("Common.name"),fieldName:"name",minWidth:50,maxWidth:350,isRowHeader:!0,isResizable:!0,isPadded:!0,isMultiline:!1,sortAscendingAriaLabel:this.props.t("Common.Sorting.ascending"),sortDescendingAriaLabel:this.props.t("Common.Sorting.descending"),onRender:e=>{var t={href:"#",disabled:!e.isPlayEnabled,onClick:()=>this.props.onTitleClick(e),onContextMenu:e=>(e.preventDefault(),!1)};return y.createElement(r.DetailsListLink,{linkText:e.name,linkProps:t})}},e,{key:"dateModified",name:this.props.t("Directives.AppList.Header.modified"),fieldName:"dateModified",minWidth:100,maxWidth:160,isResizable:!0,isCollapsable:!0,isMultiline:!1,isPadded:!0,sortAscendingAriaLabel:this.props.t("Common.Sorting.ascending"),sortDescendingAriaLabel:this.props.t("Common.Sorting.descending"),onRender:e=>e.displayModifiedDate},{key:"owner",name:this.props.t("Common.owner"),fieldName:"owner",minWidth:100,maxWidth:190,isResizable:!0,isCollapsable:!0,isMultiline:!1,isPadded:!0,sortAscendingAriaLabel:this.props.t("Common.Sorting.ascending"),sortDescendingAriaLabel:this.props.t("Common.Sorting.descending")},{key:"appType",name:this.props.t("Common.type"),fieldName:"appType",minWidth:100,maxWidth:100,isResizable:!0,isCollapsable:!0,isMultiline:!1,isPadded:!0,sortAscendingAriaLabel:this.props.t("Common.Sorting.ascending"),sortDescendingAriaLabel:this.props.t("Common.Sorting.descending"),onRender:e=>e.displayAppTypeName}]}getAppImage(e){var t=e.imageUrl||C.DefaultAppBackgroundImageUri;if(e.appType===a.AppTypes.PowerPortal){var n,r=e.portalAppListItemInfo(),o=!(r.portalPackageStatus===v.PowerPortalPackageStatus.Installed&&r.portalProvisioningStatus===w.PowerPortalState.ProvisioningComplete);return r.portalStatus===w.PowerPortalStatus.StateSuspended?n=this.props.t("PowerPortal.Status.StateSuspended.Title"):r.portalProvisioningStatus===w.PowerPortalState.ProvisioningInProgress?n=this.props.t("PowerPortal.Provision.InProgress.Title"):r.portalProvisioningStatus!==w.PowerPortalState.ProvisioningComplete||r.portalPackageStatus!==v.PowerPortalPackageStatus.None&&r.portalPackageStatus!==v.PowerPortalPackageStatus.Installing?(r.portalProvisioningStatus===w.PowerPortalState.RetryProvision||r.portalPackageStatus===v.PowerPortalPackageStatus.InstallFailed)&&(n=this.props.t("PowerPortal.Provision.Failed.Title")):n=this.props.t("PowerPortal.Provision.InProgress.Title"),y.createElement(h.TooltipHost,{calloutProps:{gapSpace:0},content:n,directionalHint:b.DirectionalHint.bottomCenter},y.createElement("div",null,y.createElement("img",{src:t,alt:n||this.props.t("PowerPortal.Status.StatePortalConfigured.Title"),style:{backgroundColor:e.imageBackgroundColor},className:"".concat(i.appsListStyleClasses.appImage," ").concat(o?i.appsListStyleClasses.transparentAppImage:"")}),o&&y.createElement(g.Icon,{iconName:e.iconName,className:"".concat(i.appsListStyleClasses.statusIcon," ").concat(r.portalPackageStatus===v.PowerPortalPackageStatus.InstallFailed||r.portalStatus===w.PowerPortalStatus.StateSuspended||r.portalProvisioningStatus===w.PowerPortalState.RetryProvision&&r.portalPackageStatus===v.PowerPortalPackageStatus.Installing?i.appsListStyleClasses.failIconColor:"")})))}return y.createElement(T.AppIcon,{imageUrl:e.imageUrl,altText:e.name,webResourceId:e.webResourceId,backgroundColor:e.imageBackgroundColor,className:i.appsListStyleClasses.appImage,defaultImageUrl:C.DefaultAppBackgroundImageUri})}getPropsOnEmpty(e){return R(R({},Object(l.getCommonPropsOnErrorOrEmptySearch)()),{},{className:s.appsListEmptyMessageClassName,primaryMessage:e("Apps.NoApps.message"),secondaryMessage:[e("Apps.NoApps.description")],learnMoreLabel:e("Common.learnMore"),learnMoreProps:{href:c.appLinks.canvasAndModelCreateLink,target:"_blank"},callToActionText:e("Apps.NoApps.exploreTemplates"),callToActionProps:{onClick:this.props.onExploreTemplatesClick}})}}},7653:function(e,t,n){"use strict";n.r(t),n.d(t,"AppIcon",(function(){return c}));var r=n(245),o=n.n(r),a=n(3076),i=n(5590),s=n(7654),l=n(2807),c=e=>{var t,{imageUrl:n,defaultImageUrl:c,webResourceId:p,altText:u,className:d,backgroundColor:m}=e;"953b9fac-1e5e-e611-80d6-00155ded156f"==p&&(p=void 0);var{environmentClient:g}=Object(r.useContext)(a.ApolloClientContext),{webResource:h}=Object(i.useWebResourceQuery)(g,{webResourceId:p},l.PortalScope,"",""),b=null!==(t=null!=n?n:c)&&void 0!==t?t:"";if(null!=h&&h.content){var f=Object(s.getFileExtension)(h.name),y=Object(s.getDataURI)(f,h.content,h.webresourcetype);y&&(b=y)}return o.a.createElement("img",{src:b,alt:u,style:{backgroundColor:m},className:d})}},7655:function(e,t,n){"use strict";n.r(t),n.d(t,"ErrorMessageBar",(function(){return m})),n.d(t,"AppModuleActionMessageBar",(function(){return g})),n.d(t,"DeleteCanvasAppMessageBar",(function(){return h})),n.d(t,"PowerPortalMessageBar",(function(){return b})),n.d(t,"getLearnMoreLink",(function(){return f})),n.d(t,"getPowerPortalNotificationMessage",(function(){return y}));var r=n(1697),o=n(1090),a=n(2879),i=n(2880),s=n(245),l=n.n(s),c=n(684),p=n(5645),u=n(7656),d=n(6539);function m(e){return e.errorMessage?l.a.createElement(r.MessageBar,{messageBarType:r.MessageBarType.info,isMultiline:!1,dismissButtonAriaLabel:a.fabricIcons.Cancel},e.errorMessage):l.a.createElement(l.a.Fragment,null)}function g(e){var{failed:t,success:n,message:o}=e.appModuleActionResponse;if(!t&&!n)return null;var i=n?r.MessageBarType.success:r.MessageBarType.error;return l.a.createElement(r.MessageBar,{messageBarType:i,dismissButtonAriaLabel:a.fabricIcons.Cancel,onDismiss:e.clearAppModuleActionResponseMessage},o)}function h(e){var{failed:t,success:n,message:o}=e.deleteCanvasAppResponse;if(!t&&!n)return null;var i=n?r.MessageBarType.success:r.MessageBarType.error;return l.a.createElement(r.MessageBar,{messageBarType:i,dismissButtonAriaLabel:a.fabricIcons.Cancel,onDismiss:e.clearDeleteCanvasAppResponseMessage},o)}var b=e=>{var{clearErrorMessage:t,errorProperties:n,t:o}=e;return void 0===n?l.a.createElement(l.a.Fragment,null):l.a.createElement(r.MessageBar,{messageBarType:n.messageBarType?n.messageBarType:r.MessageBarType.error,isMultiline:!1,dismissButtonAriaLabel:a.fabricIcons.Cancel,onDismiss:t,actions:n.messageBarType?l.a.createElement(c.MessageBarButton,{className:u.appListMessageBarStyles.messageBarBtn,href:n.powerPortal?Object(d.getPowerPortalAdministrationUrl)(n.powerPortal.crmGeo,n.powerPortal.id,n.powerPortal.lcid):void 0,target:"_blank"},o("PowerPortal.Trial.upgradeMyTrial")):l.a.createElement(l.a.Fragment,null)},y(n.exception,n.powerPortal))};function f(e,t){return l.a.createElement(o.Link,{href:Object(p.getPowerPortalLearnMoreLinks)(e),target:"_blank"},t)}function y(e,t){var n;if(e&&(e.errorCode||e.exceptionMessage))if(e.errorCode&&e.errorCode===p.powerPortalMaxLimitReachedErrorCode){var r;n=Object(i.formatResourceString)(e.exceptionMessage,null!==(r=e.licenseCount)&&void 0!==r?r:"")}else{if(t&&e.errorCode===p.powerPortalTrailConversionCode)return t.portalStatus===p.PowerPortalStatus.StateSuspended?Object(i.formatResourceStringToElement)(Object(p.getPowerPortalTrialNotification)(t.portalStatus),(n,r)=>0==r?l.a.createElement(l.a.Fragment,null,t.name):1==r?l.a.createElement(l.a.Fragment,null,t.suspendedPortalDeletingInDays):2==r?f(e,n):l.a.createElement(l.a.Fragment,null)):Object(i.formatResourceStringToElement)(Object(p.getPowerPortalTrialNotification)(t.portalStatus),(n,r)=>0==r?l.a.createElement(l.a.Fragment,null,t.trailExpiringInDays):1==r?f(e,n):l.a.createElement(l.a.Fragment,null));n=Object(p.getPowerPortalLearnMoreLinks)(e)?Object(i.formatResourceStringToElement)(e.exceptionMessage,t=>l.a.createElement(o.Link,{href:Object(p.getPowerPortalLearnMoreLinks)(e),target:"_blank"},t)):""}return n}},7656:function(e,t,n){"use strict";n.r(t),n.d(t,"appListMessageBarStyles",(function(){return o}));var r=n(719),o=Object(r.mergeStyleSets)({messageBarBtn:{whiteSpace:"pre"}})},7657:function(e,t,n){"use strict";n.r(t),n.d(t,"AppListItem",(function(){return s}));var r=n(2836),o=n(5596),a=n(7651),i=n(3156);class s{getGenericApp(){return this.app}get id(){return this.app&&this.app.id||""}get name(){return o.getAppDisplayName(this.app)}get displayAppTypeName(){var e;return a.getAppTypeDisplayName((null===(e=this.app)||void 0===e?void 0:e.appType)===r.CustomCanvasPage?r.CustomCanvasPage:i.AppTypes.Canvas)}get dateModified(){return o.getAppDateModified(this.app)}get displayModifiedDate(){return o.getAppDateModifiedFriendlyString(this.app)}get owner(){return o.getAppOwnerDisplayName(this.app)}get appType(){return i.AppTypes.Canvas}get imageUrl(){return o.getAppBackgroundImageUri(this.app)}get imageBackgroundColor(){return o.getAppBackgroundColor(this.app)}constructor(e){this.app=void 0,this.app=e}}},7658:function(e,t,n){"use strict";n.r(t),n.d(t,"PowerPortalListItem",(function(){return c}));var r=n(5645),o=n(7651),a=n(5493),i=n(5644),s=n(2879),l=n(3156);class c{getGenericApp(){return this.app}portalAppListItemInfo(){return{id:this.id,name:this.name,iconName:this.iconName,imageUrl:this.imageUrl,imageBackgroundColor:this.imageBackgroundColor,portalPackageStatus:this.portalPackageStatus,applicationType:this.applicationType,trailExpiringInDays:this.trailExpiringInDays,portalProvisioningStatus:this.portalProvisioningStatus,portalStatus:this.portalStatus,suspendedPortalDeletingInDays:this.suspendedPortalDeletingInDays,lcid:this.portalLcid,crmGeo:this.crmGeo,portalType:this.app.portalProperties.PortalType}}get id(){return this.app&&this.app.id||""}get applicationType(){return this.app.portalProperties.ApplicationType}get trailExpiringInDays(){return this.app.portalProperties.TrialExpiringInDays}get suspendedPortalDeletingInDays(){return this.app.portalProperties.SuspendedPortalDeletingInDays}get name(){return r.getDisplayName(this.app)}get displayAppTypeName(){return o.getAppTypeDisplayName(l.AppTypes.PowerPortal)}get dateModified(){return r.getModifiedDate(this.app)}get displayModifiedDate(){return r.getAppDateModifiedFriendlyString(this.app)}get owner(){return r.getOwner(this.app)}get appType(){return l.AppTypes.PowerPortal}get imageUrl(){return a.default.getPaths().powerPortalDefaultIcon}get iconName(){var e=this.app.portalProperties,t=r.getPortalState(e.CategoryBrowse),n="";return r.getPortalStatus(this.app)===r.PowerPortalStatus.StateSuspended?n=s.fabricIcons.StateSuspended:t===r.PowerPortalState.ProvisioningInProgress||t===r.PowerPortalState.ProvisioningComplete&&(e.PackageStatus===i.PowerPortalPackageStatus.None||e.PackageStatus===i.PowerPortalPackageStatus.Installing)?n=s.fabricIcons.Sync:t===r.PowerPortalState.RetryProvision&&e.PackageStatus===i.PowerPortalPackageStatus.Installing||e.PackageStatus===i.PowerPortalPackageStatus.InstallFailed?n=s.fabricIcons.StatusErrorFull:e.PackageStatus!==i.PowerPortalPackageStatus.Installed||t!=r.PowerPortalState.NonRetryable&&t!=r.PowerPortalState.RetryProvision||(n=s.fabricIcons.Blocked),n}get portalLcid(){return this.app.portalProperties.Lcid}get crmGeo(){return this.app.portalProperties.CrmGeo}get portalPackageStatus(){return r.getPortalPackageStatus(this.app)}get portalStatus(){return"StateSuspended"===this.app.portalProperties.Status?r.PowerPortalStatus.StateSuspended:void 0}get portalProvisioningStatus(){return r.getPortalState(this.app.portalProperties.CategoryBrowse)}get imageBackgroundColor(){return""}constructor(e){this.app=void 0,this.app=e}}},7659:function(e,t,n){"use strict";n.r(t),n.d(t,"useIsWrapCommandApplicable",(function(){return i}));var r=n(2807),o=n(6379),a=n(7660);function i(e,t,n){var{solution:i}=Object(o.useSolutionByUniqueName)(e,"msdyn_MobileAppsSolution",r.PortalScope,"requestFailed",n);return!!i&&t&&a.featureGates.enableWrapForCanvasApp}},7660:function(e,t,n){"use strict";n.r(t),n.d(t,"featureGates",(function(){return o}));var r=n(250),o=Object(r.createFeatureGatesConfig)({packageName:"powerapps-portal-wrap",features:{enableWrapForCanvasApp:{owner:"pasawant",description:"Enable Wrap feature for canvasApps.",enabledFor:{test:!0,preview:!0,preprod:!1,prod:!1,gov:!1,high:!1,dod:!1,mooncake:!1}}}});t.default=o},7661:function(e,t,n){"use strict";n.r(t),n.d(t,"_AppsListCommandBarContainer",(function(){return w})),n.d(t,"AppsListCommandBarContainer",(function(){return O})),n.d(t,"getFilterAppsItem",(function(){return P}));var r=n(245),o=n.n(r),a=n(5437),i=n(1222),s=n(922),l=n(5487),c=n(6607),p=n(5626),u=n(5595),d=n(5639),m=n(5596),g=n(5981),h=n(2879),b=n(5617),f=n(860),y=n(5987),S=n(3076),C=n(7659),v=n(5604),w=e=>{var{selectedApp:t,onSearchFilterUpdate:n,t:s,appCommandActions:u,appModuleCommandActions:h,powerPortalCommandActions:b,deleteAppModuleById:S,appModuleSetStateById:w}=e,{rootProps:{currentEnvironment:O}}=Object(r.useContext)(l.RootPropsContext),E=Object(a.useSelector)(g.appsSelectors.appsListFilterType),A=Object(a.useSelector)(p.allowListFeaturesSelector),j=A.EnableTestStudio,L=A.EnablePowerPortalPublicPreview,T=Object(a.useDispatch)(),k=e=>T(g.appsActions.updateAppListType({appListType:e})),R=Object(a.useSelector)(y.getPowerPortalFeaturesEnabled),D=!Object(v.environmentHasCds2Database)(O),M=Object(C.useIsWrapCommandApplicable)(e.environmentClient,Object(d.isICanvasApp)(t)&&Object(m.isSolutionAware)(t),D),N=Object(d.useGenericAppCommandBarCommands)({appCommandActions:u,appModuleCommandActions:h,powerPortalCommandActions:b,genericApp:t,currentEnvironment:O,isDrilledIn:!1,enableTestStudio:j,enablePowerPortalPublicPreview:L,onDeleteAppModule:S,onAppModuleSetState:w,includeWrap:M},R),x=[];Object(f.getResponsiveMode)(window)<=f.ResponsiveMode.large?N.push(P(E,k,s)):x.push(P(E,k,s));var I={ariaLabel:s("Common.commands")},F=Object(c.getSearchBoxProps)(n,void 0,void 0,s("Controllers.SearchBox.appsPageAriaLabel"));return o.a.createElement(i.CommandBarWithSearchBox,{items:N,farItems:x,overflowButtonProps:I,isSearchBoxVisible:!t,searchBoxProps:F})},O=Object(s.translateService)("PowerappsPortal")(Object(S.withApolloClient)(Object(d.withGenericAppCommands)(u.AppContexts.AppsList.CommandBar)(w)));function P(e,t,n){var r,o=[{text:n("Library.AppFilter.mine"),key:m.AppListType[m.AppListType.SharedWithMe],onClick:()=>t(m.AppListType.SharedWithMe)},{text:n("Library.AppFilter.orgApps"),key:m.AppListType[m.AppListType.Org],onClick:()=>t(m.AppListType.Org)}];return{key:"Filter",text:e==m.AppListType.SharedWithMe?n("Library.AppFilter.mine"):n("Library.AppFilter.orgApps"),iconProps:{iconName:h.fabricIcons.List,style:{color:null===(r=b.fabricTheme.palette)||void 0===r?void 0:r.themePrimary}},subMenuProps:{items:o}}}},7662:function(e,t,n){"use strict";n.r(t),n.d(t,"withAppsListPagePivotsBehavior",(function(){return l})),n.d(t,"AppsListPagePivotsContainer",(function(){return c}));var r=n(245),o=n(7663),a=n(7637),i=n(5583),s=n(922);function l(e){return class extends r.Component{render(){var{match:t,navigate:n,t:o,tReady:i}=this.props,{selectedPivot:s,onPivotClick:l}=Object(a.getAppsListPivots)(t,n);return r.createElement(e,{selectedPivot:s,onPivotClick:l,t:o,tReady:i})}}}var c=Object(s.translateService)("PowerappsPortal")(Object(i.withNavigation)(l(o.AppsListPagePivots)))},7663:function(e,t,n){"use strict";n.r(t),n.d(t,"AppsListPagePivots",(function(){return i}));var r=n(1709),o=n(245),a=n(7637),i=e=>{var{selectedPivot:t,t:n}=e;return o.createElement(r.Pivot,{defaultSelectedKey:t?a.AppPivots[t]:"",onLinkClick:t=>e.onPivotClick(null==t?void 0:t.props.itemKey)},o.createElement(r.PivotItem,{itemKey:a.AppPivots.Apps,headerText:n("Apps.AppList.Pivots.apps")}),o.createElement(r.PivotItem,{itemKey:a.AppPivots.ComponentLibraries,headerText:n("Apps.AppList.Pivots.componentLibraries")}))}},7664:function(e,t,n){"use strict";n.r(t),n.d(t,"MembersIndicatorEnabledChecker",(function(){return m})),n.d(t,"MembersIndicatorBAPChecker",(function(){return g})),n.d(t,"MembersIndicatorChecker",(function(){return h}));var r=n(245),o=n.n(r),a=n(3076),i=n(2871),s=n(3651),l=n(7665),c=n(1105),p=n(1083),u=n(5593),d=n(7666),m=e=>{var[t,n]=Object(r.useState)(!1),a=i.featureGates.enableMembersIndicator&&!Object(p.isDefaultEnvironment)(e.currentEnvironment)&&Object(p.environmentHasCds2Database)(e.currentEnvironment)&&!Object(p.isTeamsEnvironment)(e.currentEnvironment);return Object(r.useEffect)(()=>{a||t||(e.onMembersIndicatorChecked(!1),n(!0))},[a]),a?o.a.createElement(g,e):null},g=e=>{var t,[n,o]=Object(r.useState)(!1),a=Object(r.useRef)(Object(u.trackCreateScenario)(d.BAPTenantSettingScenario)),{loading:i,errorMessage:c,settings:p}=Object(s.useBapSettings)(null!==(t=e.environmentClient)&&void 0!==t?t:e.genericClient,{tenantSettingNames:[l.MembersIndicatorBAPSetting]},u.PortalScope);return Object(r.useEffect)(()=>{if(!i&&c&&Object(u.trackScenarioFailure)(d.BAPTenantSettingScenario,{errorMessage:c},a.current),!i&&!n){var t,r=!("true"===(null==p||null===(t=p.find(e=>e.settingName===l.MembersIndicatorBAPSetting))||void 0===t?void 0:t.value));Object(u.trackScenarioComplete)(d.BAPTenantSettingScenario,{enabled:r},a.current),e.onMembersIndicatorChecked(r),o(!0)}},[i,c,p]),null},h=Object(c.withEnvironment)(Object(a.withApolloClient)(m))},7665:function(e,t,n){"use strict";n.r(t),n.d(t,"MembersIndicatorBAPSetting",(function(){return r}));var r="powerPlatform.powerApps.disableMembersIndicator"},7666:function(e,t,n){"use strict";n.r(t),n.d(t,"BAPTenantSettingScenario",(function(){return r}));var r="BAPTenantSettingScenario"},7667:function(e,t,n){"use strict";n.r(t),n.d(t,"_RefreshAppsPage",(function(){return m})),n.d(t,"RefreshAppsPage",(function(){return g}));var r=n(245),o=n.n(r),a=n(923),i=n(1144),s=n(1878),l=n(217),c=n(2880),p=n(7668),u=n(7671),d=n(719);function m(){var{t:e}=Object(a.useTranslation)("PowerappsPortal");o.a.useEffect(()=>{Object(l.trackLoadScenario)(u.telemetryScope,"refreshApps")},[]);var t=Object(d.mergeStyleSets)({padding:"30px 40px 40px 40px"}),n=Object(d.mergeStyleSets)({paddingTop:"20px"});return o.a.createElement(o.a.Fragment,null,o.a.createElement(s.Slot,{name:"MessageBar"}),o.a.createElement("div",{style:t},o.a.createElement("h2",null,e("RefreshAppsPage.title")),o.a.createElement("div",{style:n},Object(c.formatResourceStringAsLinks)(e("RefreshAppsPage.details"),["https://office.com/apps"])),o.a.createElement("div",{style:n},o.a.createElement(p.SyncButton,null))))}var g=Object(i.withHttpClient)(m)},7668:function(e,t,n){"use strict";n.r(t),n.d(t,"_SyncButton",(function(){return h})),n.d(t,"SyncButton",(function(){return b}));var r=n(245),o=n.n(r),a=n(923),i=n(684),s=n(1697),l=n(1144),c=n(1878),p=n(217),u=n(7669),d=n(7670),m=n(7671),g=n(719);function h(e){var{status:t,setStatus:n,syncClicked:r}=Object(u.useSyncBehavior)(e),{t:l}=Object(a.useTranslation)("PowerappsPortal"),h=()=>{n(d.SyncButtonStatus.Iddle)},b=Object(g.mergeStyleSets)({root:{animationName:"spin",animationDuration:"5000ms",animationIterationCount:"infinite",animationTimingFunction:"linear"}});return o.a.createElement(o.a.Fragment,null,o.a.createElement(c.Fill,{name:"MessageBar"},t===d.SyncButtonStatus.Running&&o.a.createElement(s.MessageBar,{messageBarType:s.MessageBarType.warning},l("RefreshAppsPage.Status.running")),t===d.SyncButtonStatus.Error&&o.a.createElement(s.MessageBar,{messageBarType:s.MessageBarType.error,dismissButtonAriaLabel:l("Common.close"),onDismiss:h},l("RefreshAppsPage.Status.error")),t===d.SyncButtonStatus.Success&&o.a.createElement(s.MessageBar,{messageBarType:s.MessageBarType.success,dismissButtonAriaLabel:l("Common.close"),onDismiss:h},l("RefreshAppsPage.Status.success"))),o.a.createElement(i.DefaultButton,{text:l("RefreshAppsPage.sync"),iconProps:{iconName:"Sync",styles:t===d.SyncButtonStatus.Running?b:void 0},disabled:t===d.SyncButtonStatus.Running,onClick:()=>{Object(p.trackUserActionClickButton)(m.telemetryScope,"sync"),r()}}))}var b=Object(l.withHttpClient)(h)},7669:function(e,t,n){"use strict";n.r(t),n.d(t,"useSyncBehavior",(function(){return l}));var r=n(245),o=n.n(r),a=n(7670);function i(e,t,n,r,o,a,i){try{var s=e[a](i),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}function s(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function s(e){i(a,r,o,s,l,"next",e)}function l(e){i(a,r,o,s,l,"throw",e)}s(void 0)}))}}function l(e){var{httpClient:t}=e,n=-1,[r,i]=o.a.useState(a.SyncButtonStatus.Iddle),l=o.a.useCallback(s((function*(){try{i(a.SyncButtonStatus.Running);var e=(yield t.post("https://bad-rp/providers/Microsoft.BusinessAppDiscovery/refreshapps?refreshType=hardrefresh")).headers["x-ms-discovery-provision-job-id"];n=window.setTimeout(()=>c(e),5e3)}catch(r){i(a.SyncButtonStatus.Error)}})),[]),c=o.a.useCallback(function(){var e=s((function*(e){try{var r=yield t.get("https://bad-rp/providers/Microsoft.BusinessAppDiscovery/apps?provisionjobid=".concat(e,"&$expand=lastAccessTime,isPinned,timePinned,recentLocations"));202===r.status?n=window.setTimeout(()=>c(e),5e3):200===r.status?i(a.SyncButtonStatus.Success):i(a.SyncButtonStatus.Error)}catch(o){i(a.SyncButtonStatus.Error)}}));return function(t){return e.apply(this,arguments)}}(),[]);return o.a.useEffect(()=>()=>{window.clearTimeout(n)},[]),{status:r,syncClicked:l,setStatus:i}}},7670:function(e,t,n){"use strict";var r;n.r(t),n.d(t,"SyncButtonStatus",(function(){return r})),function(e){e[e.Iddle=0]="Iddle",e[e.Running=1]="Running",e[e.Error=2]="Error",e[e.Success=3]="Success"}(r||(r={}))},7671:function(e,t,n){"use strict";n.r(t),n.d(t,"telemetryScope",(function(){return r}));var r="powerapps-portal/refreshApps"},7672:function(e,t,n){"use strict";n.r(t),n.d(t,"mapStateToProps",(function(){return y})),n.d(t,"mapDispatchToProps",(function(){return S})),n.d(t,"mergeProps",(function(){return C})),n.d(t,"PowerPortalDetailsPageContainer",(function(){return v}));var r=n(5437),o=n(5629),a=n(5623),i=n(5667),s=n(5987),l=n(5668),c=n(7673),p=n(5669),u=n(5583),d=n(5487),m=n(3076);function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){b(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function b(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function f(e){return e&&e.match&&e.match.params&&e.match.params.environmentName||""}function y(e,t){var n=function(e){return e&&e.match&&e.match.params&&e.match.params.portalId||""}(t),r=Object(s.portalByIdSelector)(e,n),a=!!r,i=Object(s.portalFetchErrorByIdSelector)(e,n);return{powerPortal:r,currentEnvironmentName:f(t),loadProgress:[Object(o.toLoadingState)(a,i)],logEvent:l.PowerPortalAppLoadEvent,portalId:n}}var S=(e,t)=>({onAppsBreadcrumbClick:()=>{t.navigate(a.appsRoute.apps,!0)},componentDidMount:n=>{e(Object(i.fetchPowerPortalAppRequest)(t.environmentClient,{powerPortalId:n}))},dispatchTelemetry:e}),C=(e,t,n)=>{var{areShellProvidersReady:r}=n.rootProps;return h(h(h({},e),t),{},{areShellProvidersReady:r})},v=Object(d.withRootProps)(Object(u.withNavigation)(Object(m.withApolloClient)(Object(r.connect)(y,S,C)(Object(o.withLoadTelemetry)(c.PowerPortalDetailsPage,p.LoadScenarioNames.PowerPortalDetailsPage)))))},7673:function(e,t,n){"use strict";n.r(t),n.d(t,"PowerPortalDetailsPage",(function(){return b}));var r=n(4792),o=n(4105),a=n(1201),i=n(245),s=n(303),l=n(1200),c=n(5645),p=n(5629),u=n(3831),d=n(2869),m=n(5623),g=n(7674),h=n(7675);class b extends i.Component{constructor(e){super(e),this.resources=void 0,this.breadCrumbItems=[],this.resources=Object(d.getResources)()}componentDidMount(){void 0===this.props.powerPortal&&this.props.componentDidMount(this.props.portalId)}render(){if(!this.props.areShellProvidersReady)return i.createElement(l.PagePlaceholder,null);switch(Object(p.getTotalLoadingState)(this.props.loadProgress)){case p.ComponentLoadState.Complete:return this.initializeBreadCrumbItem(this.props.powerPortal),i.createElement(r.Page,{className:"app-management-page",renderHeader:()=>i.createElement(g.PowerPortalDetailsPageCommandBarContainer,{selectedPowerPortal:this.props.powerPortal}),renderTitle:()=>i.createElement(o.PageHeader,{wrapperClassName:"app-management-page-breadcrumb",titleBreadcrumbProps:{items:this.breadCrumbItems,ariaLabel:this.resources.PowerPortal.AppList.Details.Breadcrumbs.apps}}),renderBody:()=>i.createElement(h.PowerPortalDetailsPagePivotsContainer,{selectedPowerPortal:this.props.powerPortal})});case p.ComponentLoadState.Fail:var e={fromPattern:u.RoutePaths.powerPortalDetailsPage,toPattern:u.RoutePaths.appsList,toFriendlyRouteName:u.FriendlyRouteNames.apps};return i.createElement(s.Redirect,{push:!0,to:{pathname:Object(m.getAppsListLaunchUri)(this.props.currentEnvironmentName),state:e}});default:return i.createElement("div",{className:"app-management-page"},i.createElement("div",{className:"app-management-page-spinner"},i.createElement(a.Spinner,{size:a.SpinnerSize.large})))}}initializeBreadCrumbItem(e){this.breadCrumbItems=[{text:this.resources.PowerPortal.AppList.Details.Breadcrumbs.apps,key:this.resources.PowerPortal.AppList.Details.Breadcrumbs.apps,onClick:()=>{this.props.onAppsBreadcrumbClick()}},{text:c.getDisplayName(e),key:c.getId(e)}]}}},7674:function(e,t,n){"use strict";n.r(t),n.d(t,"mapStateToProps",(function(){return c})),n.d(t,"mergeProps",(function(){return p})),n.d(t,"PowerPortalDetailsPageCommandBarContainer",(function(){return u}));var r=n(1222),o=n(5437),a=n(5643),i=n(5665),s=n(5668),l=n(5626),c=(e,t)=>({enablePowerPortalPublicPreview:Object(l.allowListFeaturesSelector)(e).EnablePowerPortalPublicPreview}),p=(e,t,n)=>({items:Object(a.getPowerPortalCommandBarCommands)({commandActions:n.powerPortalCommandActions,powerPortal:n.selectedPowerPortal,enablePowerPortalPublicPreview:e.enablePowerPortalPublicPreview}),isSearchBoxVisible:!1,searchBoxProps:void 0}),u=Object(i.withPowerPortalCommands)(s.AppContexts.PowerPortalsDetailsPage.CommandBar)(Object(o.connect)(c,{},p)(r.CommandBarWithSearchBox))},7675:function(e,t,n){"use strict";n.r(t),n.d(t,"mergeProps",(function(){return i})),n.d(t,"PowerPortalDetailsPagePivotsContainer",(function(){return s}));var r=n(5437),o=n(7676),a=n(5645),i=(e,t,n)=>({selectedPowerPortalId:a.getId(n.selectedPowerPortal)}),s=Object(r.connect)(null,{},i)(o.PowerPortalDetailsPagePivots)},7676:function(e,t,n){"use strict";n.r(t),n.d(t,"PowerPortalPivotNames",(function(){return s})),n.d(t,"PowerPortalDetailsPagePivots",(function(){return l}));var r=n(1709),o=n(245),a=n(7677),i=n(2869),s={details:"Details"};class l extends o.Component{constructor(e){super(e),this.resources=void 0,this.resources=Object(i.getResources)()}render(){return o.createElement("div",{className:"app-management-page-pivots"},o.createElement(r.Pivot,{defaultSelectedKey:this.resources.PowerPortal.AppList.Details.Pivots.detailsTab},o.createElement(r.PivotItem,{linkText:this.resources.PowerPortal.AppList.Details.Pivots.detailsTab,itemKey:s.details},o.createElement(a.PowerPortalAppDetailsContainer,{powerPortalId:this.props.selectedPowerPortalId}))))}}},7677:function(e,t,n){"use strict";n.r(t),n.d(t,"mapStateToProps",(function(){return f})),n.d(t,"mergeProps",(function(){return y})),n.d(t,"getConvertTrailToProdMessage",(function(){return S})),n.d(t,"formatString",(function(){return C})),n.d(t,"PowerPortalAppDetailsContainer",(function(){return v}));var r=n(245),o=n(5437),a=n(1697),i=n(1090),s=n(2879),l=n(2869),c=n(7601),p=n(5987),u=n(2880),d=n(5481),m=n(6539),g=n(684),h=n(5645),b=n(7678);function f(e,t){var n=Object(l.getResources)(),r=Object(p.portalByIdSelector)(e,t.powerPortalId),o=h.getCreatedDate(r),a=h.getModifiedDate(r),i={detailsProps:[]};return i.detailsProps.push({title:n.PowerPortal.AppList.Details.portalType,content:h.getPowerPortalType(r)}),(null==r?void 0:r.portalProperties.ApplicationType)==h.PowerPortalApplicationType[h.PowerPortalApplicationType.Trial]&&r.portalProperties.PortalType==h.PowerPortalPortalType[h.PowerPortalPortalType.PowerPortal]&&i.detailsProps.push({title:n.PowerPortal.AppList.Details.convertToProduction.title,content:S(r)}),i.detailsProps.push({title:n.PowerPortal.AppList.Details.ownerDisplayName,content:h.getOwner(r)}),i.detailsProps.push({title:n.Common.created,content:o&&o.toLocaleString()}),i.detailsProps.push({title:n.Common.modified,content:a&&a.toLocaleString()}),i.detailsProps.push({title:n.PowerPortal.AppList.Details.websiteUrl,content:h.getPowerPortalUrl(r)}),i}var y=(e,t,n)=>e;function S(e){return r.createElement("div",null,r.createElement("div",null,r.createElement(a.MessageBar,{messageBarType:a.MessageBarType.warning,className:b.powerPortalAppDetailsStyles.messageBarStyle,dismissButtonAriaLabel:s.fabricIcons.Cancel},h.getPowerPortalDetailPageTrialNotification(e))),r.createElement("div",{className:b.powerPortalAppDetailsStyles.spacingStyles},C(Object(l.getResources)().PowerPortal.AppList.Details.convertToProduction.details)),r.createElement("div",{className:b.powerPortalAppDetailsStyles.spacingStyles},r.createElement(g.PrimaryButton,{href:Object(m.getPowerPortalAdministrationUrl)(e.portalProperties.CrmGeo,e.id,e.portalProperties.Lcid),target:"_blank"},Object(l.getResources)().PowerPortal.Trial.upgradeMyTrial)))}function C(e){return Object(u.formatResourceStringToElement)(e,e=>r.createElement(i.Link,{href:d.default.powerPortalTrialsLearnMoreLink,target:"_blank"},e))}var v=Object(o.connect)(f,{},y)(c.ResourceDetailList)},7678:function(e,t,n){"use strict";n.r(t),n.d(t,"powerPortalAppDetailsStyles",(function(){return o}));var r=n(719),o=Object(r.mergeStyleSets)({spacingStyles:{whiteSpace:"pre-line",marginTop:"10px"},messageBarStyle:{width:"629px"}})},7679:function(e,t,n){"use strict";n.r(t),n.d(t,"ConnectionsListPage",(function(){return g}));var r=n(4792),o=n(245),a=n.n(o),i=n(1200),s=n(7641),l=n(2869),c=n(7680),p=n(7685),u=n(5487),d=n(2816),m=n(5901),g=e=>{var[t,n]=Object(o.useState)(void 0),[g,h]=Object(o.useState)(""),b=Object(m.useEnvironmentCapabilities)(),{rootProps:{areShellProvidersReady:f}}=Object(o.useContext)(u.RootPropsContext),y=Object(l.getResources)().Controllers.Connections.connectionsPageTitle;return Object(o.useEffect)(()=>{var t,n,r=Object(d.parseQueryString)(null!==(t=null===(n=e.location)||void 0===n?void 0:n.search)&&void 0!==t?t:""),o="status:error"===r.searchText?Object(l.getResources)().Controllers.Connections.statusError:r.searchText;h(o)},[]),f?a.a.createElement(r.Page,{className:"connections-list-page",renderHeader:()=>a.a.createElement(p.ConnectionsListCommandBarContainer,{selectedConnection:t,onSearchFilterUpdate:h,environmentCapabilities:b}),renderTitle:()=>a.a.createElement(s.PageHeaderWithEnvContainer,{title:y}),renderBody:()=>a.a.createElement(c.ConnectionsListContainer,{onConnectionSelect:n,searchFilter:g,environmentCapabilities:b})}):a.a.createElement(i.PagePlaceholder,null)}},7680:function(e,t,n){"use strict";n.r(t),n.d(t,"createConnectionsRow",(function(){return A})),n.d(t,"createConnectionListItems",(function(){return j})),n.d(t,"mapStateAndParentPropsToProps",(function(){return L})),n.d(t,"mapDispatchToProps",(function(){return T})),n.d(t,"mergeProps",(function(){return k})),n.d(t,"ConnectionsListContainer",(function(){return R}));var r=n(5437),o=n(5487),a=n(5803),i=n(5804),s=n(5629),l=n(2869),c=n(5601),p=n(5630),u=n(5623),d=n(5796),m=n(5807),g=n(7509),h=n(6866),b=n(5582),f=n(7629),y=n(7634),S=n(7681),C=n(5669),v=n(5583),w=n(5626);function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function P(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach((function(t){E(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function E(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var A=(e,t)=>{if(null===e)return null;var n=i.getConnectionApi(e,t),r=new Date(e.properties.lastModifiedTime),o=new Date(e.properties.createdTime),s=o>r?o:r,p=n?a.getDisplayName(n):i.getConnectionApiName(e),u=a.getApiType(n);i.isConnectionUsingGateway(e)&&(u=Object(l.getResources)().Common.onPremises);var d="",m=i.isConnectionInError(e),g=i.isConnectionInAuthError(e);g?d=Object(l.getResources)().Controllers.Connections.CantSignIn:m&&(d=i.getStatusMessage(e));var h={key:e.id,id:e.id,apiName:p,name:i.getDisplayName(e),user:i.getOwnerEmail(e),dateModified:s,dateModifiedString:s?Object(c.getFriendlyRelativeTimeString)(s):"",imageUrl:i.getIcon(e),statusError:m,isAuthError:g,statusMessage:d||Object(l.getResources)().Controllers.Connection.connected,type:u,connection:e,api:n};return h.filterOn=[h.name,h.apiName,h.dateModifiedString,h.statusMessage,h.type],(h.statusError||h.isAuthError)&&h.filterOn.push(Object(l.getResources)().Controllers.Connections.statusError),h},j=(e,t)=>{var n=t||[];return(e||[]).map(e=>A(e,n))},L=(e,t)=>{var n,r=null!==(n=Object(b.currentEnvironmentIdSelector)(t))&&void 0!==n?n:"",o=g.connectionsSelectors.connectionsListError(e)||m.apisListError(e),a=Object(w.allowListFeaturesSelector)(e);return{connectionsListItems:j(g.connectionsSelectors.connectionsListUiSelectorWithErrorOnTop(e,r),m.apisSelectorForCurrentEnv(e,r)),loadProgress:[Object(s.toLoadingState)(g.connectionsSelectors.isConnectionAndApiListCachedComplete(e,r),o)],errorMessage:o,allowlistFeatures:a,environmentCapabilities:t.environmentCapabilities,searchFilter:t.searchFilter,onConnectionSelect:t.onConnectionSelect,logEvent:y.ConnectionsListLoadEvent}},T=(e,t)=>{var{navigate:n}=t;return{onMount:()=>{e(Object(h.fetchConnectionsRequest)({forceRefresh:!0})),e(Object(d.fetchApisRequest)())},dispatchTelemetry:e,onDismount:()=>{e(Object(h.fetchConnectionsCancelPoll)()),e(Object(d.fetchApisCancelPoll)())},onFixConnection:t=>e(Object(p.logAction)(g.connectionsActions.consentConnection({connection:t,useFirstPartyConsent:!0}),y.ConnectionsListMenuEvents.Consent.eventName)),connectionCommandActions:{onNewConnectionClick:()=>t.navigate(u.newConnectionUrl,!0),onConnectionEditClick:t=>e(Object(p.logAction)(g.connectionsActions.editConnection({connection:t}),y.ConnectionsListMenuEvents.Edit.eventName)),onConnectionShareClick:t=>e(g.connectionsActions.openShareConnectionModal({connection:t,navigate:n})),onConnectionSwitchAccountClick:t=>e(Object(p.logAction)(g.connectionsActions.consentConnection({connection:t}),y.ConnectionsListMenuEvents.Consent.eventName)),onConnectionDeleteClick:t=>e(Object(p.logAction)(g.connectionsActions.deleteConnection({connection:t,navigate:n}),y.ConnectionsListMenuEvents.Delete.eventName)),onConnectionDetailsClick:t=>e(g.connectionsActions.openConnectionPivot({connection:t,selectedPivot:f.ConnectionManagementPivotNames.details,navigate:n}))}}},k=(e,t,n)=>P(P({},e),t),R=Object(v.withNavigation)(Object(o.withRootProps)(Object(r.connect)(L,T,k)(Object(s.withLoadTelemetry)(S.ConnectionsList,C.LoadScenarioNames.ConnectionsList))))},7681:function(e,t,n){"use strict";n.r(t),n.d(t,"ConnectionsList",(function(){return v}));var r=n(3064),o=n(3161),a=n(1090),i=n(1471),s=n(545),l=n(245),c=n(2870),p=n(7682),u=n(5628),d=n(5629),m=n(2879),g=n(5493),h=n(5481),b=n(2869),f=n(2880),y=n(5633),S=n(7684);function C(){return(C=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}class v extends l.Component{constructor(e){super(e),this.resources=void 0,this.selection=void 0,this.columns=void 0,this.connectionsListRef=void 0,this.resources=Object(b.getResources)(),this.connectionsListRef=l.createRef(),this.selection=new i.Selection({onSelectionChanged:()=>{var e=this.selection.getSelection()[0];this.props.onConnectionSelect(e&&e.connection)}}),this.columns=this.buildColumns()}componentDidMount(){this.props.onMount()}componentWillUnmount(){this.props.onDismount()}render(){var e;return e=l.createElement("div",{ref:this.connectionsListRef},!c.HostSettings.getWidgetSettings().isWidgetPage&&l.createElement(p.AppVisualCue,{iconName:m.fabricIcons.custom.brush,buttonText:this.resources.Connections.ConnectionsList.VisualCue.buttonText,description:this.resources.Connections.ConnectionsList.VisualCue.description,link:h.default.connectionsLearnMoreUrl,style:{marginTop:-2}}),l.createElement(r.DetailsList,C({isLoading:Object(d.isLoading)(this.props.loadProgress),renderOnEmpty:()=>{var e=this.getPropsOnEmpty();return l.createElement(o.EmptyState,e)},filter:this.props.searchFilter,renderOnEmptySearch:()=>{var e=this.getPropsOnEmptySearch();return l.createElement(o.EmptyState,e)},isError:!!this.props.errorMessage,renderOnError:()=>{var e=this.getPropsOnError();return l.createElement(o.EmptyState,e)},items:this.props.connectionsListItems,columns:this.columns,setKey:"set",selectionMode:s.SelectionMode.single,selection:this.selection,className:"connections-list-container",styles:{root:{marginTop:20}},filterAnnouncement:e=>Object(f.formatResourceString)(this.resources.Common.Search.Results,e)},Object(y.getDetailsListProps)(this.resources.Common.rowSelectionAriaLabel)))),l.createElement("div",{className:"connections-list"},e)}getPropsOnEmpty(){var e="";return e=c.HostSettings.getWidgetSettings().isWidgetPage?Object(f.formatResourceString)(this.resources.Connections.NoConnections.description,this.resources.Common.ResourceType.flow):Object(f.formatResourceString)(this.resources.Connections.NoConnections.description,this.resources.Common.ResourceType.powerapps),{icon:m.fabricIcons.Globe,className:"connections-list-empty-message",primaryMessage:this.resources.Connections.NoConnections.message,secondaryMessage:[e],learnMoreLabel:this.resources.Connections.NoConnections.learnMore,learnMoreProps:{href:h.default.helpAddConnection,target:"_blank"},callToActionText:this.resources.Connections.NoConnections.createButton,callToActionProps:{onClick:this.props.connectionCommandActions.onNewConnectionClick},maxWidth:u.emptyStateMaxWidth}}getPropsOnEmptySearch(){return{icon:m.fabricIcons.Globe,className:"connections-list-empty-message",primaryMessage:this.resources.Common.Search.NoMatch.title,secondaryMessage:[this.resources.Common.Search.NoMatch.message],maxWidth:u.emptyStateMaxWidth}}getPropsOnError(){return{icon:m.fabricIcons.Globe,className:"connections-list-empty-message",primaryMessage:this.resources.Common.Request.Failed,secondaryMessage:[this.props.errorMessage],maxWidth:u.emptyStateMaxWidth}}buildColumns(){var e=Object(r.buildIconColumn)(e=>({iconUri:e.imageUrl,iconAltText:e.apiName,defaultIconUrl:g.default.getPaths().defaultConnectionIcon}),r.RowHeight.medium),t=Object(r.buildMenuColumn)(e=>({items:Object(S.getConnectionContextMenuCommands)(this.props.connectionCommandActions,this.props.allowlistFeatures,this.props.environmentCapabilities,e.connection,e.api),iconAriaLabel:this.resources.Common.commands}));return[e,{key:"name",name:this.resources.Common.name,fieldName:"name",minWidth:50,maxWidth:350,isRowHeader:!0,isResizable:!0,isPadded:!0,isMultiline:!1,sortAscendingAriaLabel:this.resources.Common.Sorting.ascending,sortDescendingAriaLabel:this.resources.Common.Sorting.descending,onRender:e=>{var t={role:"link",href:"#",onClick:()=>{this.props.connectionCommandActions.onConnectionDetailsClick(e.connection)},onContextMenu:e=>(e.preventDefault(),!1)};return l.createElement(r.DetailsListLink,{linkText:e.name,linkSubheading:e.apiName,linkProps:t})}},t,{key:"dateModified",name:this.resources.Directives.List.Header.modified,fieldName:"dateModified",minWidth:80,maxWidth:140,isResizable:!0,isCollapsable:!0,isMultiline:!1,isPadded:!0,sortAscendingAriaLabel:this.resources.Common.Sorting.ascending,sortDescendingAriaLabel:this.resources.Common.Sorting.descending,onRender:e=>e.dateModifiedString},{key:"status",name:this.resources.Common.status,fieldName:"statusMessage",minWidth:150,maxWidth:200,isResizable:!0,isCollapsable:!0,isMultiline:!1,isPadded:!0,sortAscendingAriaLabel:this.resources.Common.Sorting.ascending,sortDescendingAriaLabel:this.resources.Common.Sorting.descending,onRender:e=>{var t={className:"link",href:"#",onClick:()=>{this.props.onFixConnection(e.connection)}};return l.createElement("span",{className:"connection-status"},e.statusMessage,e.isAuthError?l.createElement(a.Link,C({},t,{className:"connection-auth-link"}),this.resources.Connections.List.fixConnection):null)}}]}}},7682:function(e,t,n){"use strict";n.r(t),n.d(t,"AppVisualCue",(function(){return p}));var r=n(2869),o=n(245),a=n(7683),i=n(4093);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class p extends o.Component{constructor(e){super(e),this.props=e,this.resources=void 0,this.resources=Object(r.getResources)()}render(){return o.createElement(i.TeachingBubbleButton,{iconProps:{iconName:this.props.iconName,styles:{root:{marginRight:4}}},text:this.props.buttonText,style:l({marginLeft:8},this.props.style),teachingBubbleProps:{iconProps:{iconName:this.props.iconName,styles:a.visualCueStyle},primaryButtonProps:{children:this.resources.AppVisualCue.primaryButtonText},secondaryButtonProps:{children:this.resources.AppVisualCue.secondaryButtonText,href:this.props.link,target:"_blank"},closeButtonAriaLabel:this.resources.Common.close}},this.props.description)}}},7683:function(e,t,n){"use strict";n.r(t),n.d(t,"visualCueStyle",(function(){return r}));var r={root:{selectors:{"i &":{fill:"#fff"},svg:{fill:"#fff",width:24,height:24},"& path":{fill:"#fff"}}}}},7684:function(e,t,n){"use strict";n.r(t),n.d(t,"getConnectionCommandBarCommands",(function(){return p})),n.d(t,"getConnectionContextMenuCommands",(function(){return u}));var r=n(777),o=n(5803),a=n(5804),i=n(5617),s=n(2879),l=n(2869);function c(e,t,n,r,i,s,l){var c=[];return o.isApiEditable(i)&&c.push(d.EditConnection(e,r)),o.isApiShareable(t,n,i,r)&&c.push(d.ShareConnection(e,r)),a.isConnectionOauth(r,i)&&c.push(d.SwitchAccount(e,r)),c.push(d.DeleteConnection(e,r)),s&&(l&&c.push(d.Divider()),c.push(d.ConnectionDetails(e,r))),c}function p(e,t,n,r,o,a){if(r){var i=c(e,t,n,r,o,!a,!1);return a?i:[d.NewConnection(e),...i]}return s=e,[d.NewConnection(s)];var s}function u(e,t,n,r,o){return c(e,t,n,r,o,!0,!0)}var d={Divider:()=>({key:"divider",itemType:r.ContextualMenuItemType.Divider}),NewConnection:e=>{var t;return{key:"NewConnection",name:Object(l.getResources)().Directives.ConnectionList.addConnection,onClick:()=>{var t;null===(t=e.onNewConnectionClick)||void 0===t||t.call(e)},iconProps:{iconName:s.fabricIcons.Add,style:{color:null===(t=Object(i.getPortalTheme)().palette)||void 0===t?void 0:t.themePrimary}}}},EditConnection:(e,t)=>{var n;return{key:"EditConnection",name:Object(l.getResources)().Common.edit,onClick:()=>{e.onConnectionEditClick(t)},iconProps:{iconName:s.fabricIcons.Edit,style:{color:null===(n=Object(i.getPortalTheme)().palette)||void 0===n?void 0:n.themePrimary}}}},ShareConnection:(e,t)=>{var n;return{key:"ShareConnection",name:Object(l.getResources)().Common.share,onClick:()=>{e.onConnectionShareClick(t)},iconProps:{iconName:s.fabricIcons.Share,style:{color:null===(n=Object(i.getPortalTheme)().palette)||void 0===n?void 0:n.themePrimary}}}},SwitchAccount:(e,t)=>{var n;return{key:"SwitchAccount",name:Object(l.getResources)().Connections.switchAccount,onClick:()=>{e.onConnectionSwitchAccountClick(t)},iconProps:{iconName:s.fabricIcons.Permissions,style:{color:null===(n=Object(i.getPortalTheme)().palette)||void 0===n?void 0:n.themePrimary}}}},DeleteConnection:(e,t)=>{var n;return{key:"DeleteConnection",name:Object(l.getResources)().Common.delete,onClick:()=>{e.onConnectionDeleteClick(t)},iconProps:{iconName:s.fabricIcons.Delete,style:{color:null===(n=Object(i.getPortalTheme)().palette)||void 0===n?void 0:n.themePrimary}}}},ConnectionDetails:(e,t)=>{var n;return{key:"ConnectionDetails",name:Object(l.getResources)().Directives.AppTile.MenuItems.details,onClick:()=>{e.onConnectionDetailsClick(t)},iconProps:{iconName:s.fabricIcons.Info,style:{color:null===(n=Object(i.getPortalTheme)().palette)||void 0===n?void 0:n.themePrimary}}}}}},7685:function(e,t,n){"use strict";n.r(t),n.d(t,"mapStateToProps",(function(){return b})),n.d(t,"mapDispatchToProps",(function(){return f})),n.d(t,"mergeProps",(function(){return y})),n.d(t,"ConnectionsListCommandBarContainer",(function(){return S}));var r=n(1222),o=n(5437),a=n(5804),i=n(6607),s=n(5630),l=n(5623),c=n(5807),p=n(5626),u=n(7509),d=n(7629),m=n(7634),g=n(7684),h=n(5583),b=(e,t)=>{var n=Object(c.apiSelector)(e,a.getConnectionApiId(t.selectedConnection));return{allowlistFeatures:Object(p.allowListFeaturesSelector)(e),connectionApi:n}},f=(e,t)=>{var{navigate:n}=t;return{connectionCommandActions:{onNewConnectionClick:()=>t.navigate(l.newConnectionUrl,!0),onConnectionEditClick:t=>e(Object(s.logAction)(u.connectionsActions.editConnection({connection:t}),m.ConnectionsListMenuEvents.Edit.eventName)),onConnectionShareClick:t=>e(Object(s.logAction)(u.connectionsActions.openShareConnectionModal({connection:t,navigate:n}),m.ConnectionsListMenuEvents.Share.eventName)),onConnectionSwitchAccountClick:t=>e(Object(s.logAction)(u.connectionsActions.consentConnection({connection:t}),m.ConnectionsListMenuEvents.Consent.eventName)),onConnectionDeleteClick:t=>e(Object(s.logAction)(u.connectionsActions.deleteConnection({connection:t,navigate:n}),m.ConnectionsListMenuEvents.Delete.eventName)),onConnectionDetailsClick:t=>e(Object(s.logAction)(u.connectionsActions.openConnectionPivot({connection:t,selectedPivot:d.ConnectionManagementPivotNames.details,navigate:n}),m.ConnectionsListMenuEvents.Consent.eventName))}}},y=(e,t,n)=>{var r,o=null!==(r=null==n?void 0:n.selectedConnection)&&void 0!==r?r:void 0,a=null==n?void 0:n.environmentCapabilities;return{items:Object(g.getConnectionCommandBarCommands)(t.connectionCommandActions,e.allowlistFeatures,a,o,e.connectionApi,!1),isSearchBoxVisible:!o,searchBoxProps:Object(i.getSearchBoxProps)(n.onSearchFilterUpdate)}},S=Object(h.withNavigation)(Object(o.connect)(b,f,y)(r.CommandBarWithSearchBox))},7686:function(e,t,n){"use strict";n.r(t),n.d(t,"NewConnectionModal",(function(){return s}));var r=n(245),o=n(303),a=n(5437),i=n(7509),s=e=>{var t=Object(o.useLocation)(),n=new URLSearchParams(t.search),[s,l]=Object(r.useState)(!1),c=Object(a.useDispatch)();return Object(r.useEffect)(()=>{var e,t;n.get("apiName")&&!s&&(t=null!==(e=n.get("apiName"))&&void 0!==e?e:"",c(i.connectionsActions.createConnection({apiName:t})),l(!0))},[t.search]),null}},7687:function(e,t,n){"use strict";n.r(t),n.d(t,"withNewConnectionPageBehavior",(function(){return m})),n.d(t,"NewConnectionPageContainer",(function(){return g}));var r=n(245),o=n.n(r),a=n(1200),i=n(5623),s=n(7688),l=n(5583),c=n(5487),p=["navigate"];function u(){return(u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function d(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function m(e){return t=>{var{navigate:n}=t,s=d(t,p),{rootProps:{areShellProvidersReady:l}}=Object(r.useContext)(c.RootPropsContext);return l?o.a.createElement(e,u({},s,{onHeaderClick:()=>n(i.connectionRoute,!0)})):o.a.createElement(a.PagePlaceholder,null)}}var g=Object(l.withNavigation)(m(s.NewConnectionPage))},7688:function(e,t,n){"use strict";n.r(t),n.d(t,"NewConnectionPage",(function(){return p}));var r=n(1222),o=n(4792),a=n(4105),i=n(245),s=n(2869),l=n(6607),c=n(7689);class p extends i.Component{constructor(e){super(e),this.breadCrumbItems=void 0,this.resources=void 0,this.resources=Object(s.getResources)(),this.breadCrumbItems=this.initializeBreadCrumbItem(),this.state={searchFilter:""}}onSearchFilterUpdate(e){this.setState({searchFilter:e})}render(){return i.createElement(o.Page,{renderHeader:()=>i.createElement(r.CommandBarWithSearchBox,{items:[],isSearchBoxVisible:!0,searchBoxProps:Object(l.getSearchBoxProps)(this.onSearchFilterUpdate.bind(this))}),renderTitle:()=>i.createElement(a.PageHeader,{titleBreadcrumbProps:{items:this.breadCrumbItems}}),renderBody:()=>i.createElement(c.ApiListContainer,{searchFilter:this.state.searchFilter})})}initializeBreadCrumbItem(){var e=Object(s.getResources)().Controllers.Connections.availableConnections;return[{text:this.resources.Connections.ConnectionManagement.Breadcrumbs.connections,key:this.resources.Connections.ConnectionManagement.Breadcrumbs.connections,onClick:()=>{this.props.onHeaderClick()}},{text:e,key:"apis"}]}}},7689:function(e,t,n){"use strict";n.r(t),n.d(t,"createApiRow",(function(){return y})),n.d(t,"createApiListItems",(function(){return S})),n.d(t,"mapStateToProps",(function(){return C})),n.d(t,"mapDispatchToProps",(function(){return v})),n.d(t,"mergeProps",(function(){return w})),n.d(t,"ApiListContainer",(function(){return O}));var r=n(5437),o=n(5487),a=n(5803),i=n(5629),s=n(5630),l=n(5796),c=n(5807),p=n(7509),u=n(5582),d=n(7634),m=n(7690),g=n(5669);function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){f(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var y=e=>{if(e){var t=a.isPremiumApi(e),n={key:e.id,id:e.id,name:a.getDisplayName(e),imageUrl:a.getIconUri(e),publisher:a.isApiCustom(e)?a.getOwner(e):a.getPublisher(e),type:a.getApiType(e),api:e,isPremium:t};return n.filterOn=[n.name,n.type],n}},S=e=>(e||[]).map(y).filter(e=>!!e),C=(e,t)=>{var n,r=null!==(n=Object(u.currentEnvironmentIdSelector)(t))&&void 0!==n?n:"",o=c.apisListError(e);return{apiListItems:S(c.apisSelectorForCurrentEnv(e,r)),loadProgress:[Object(i.toLoadingState)(c.isApiListCachedComplete(e,r),o)],errorMessage:o,logEvent:d.ApiListLoadEvent}},v=e=>({onMount:()=>{e(Object(l.fetchApisRequest)())},dispatchTelemetry:e,onDismount:()=>{e(Object(l.fetchApisCancelPoll)())},onAddNewConnection:t=>e(Object(s.logAction)(p.connectionsActions.createConnection({apiName:t.api&&t.api.name}),d.CreateNewConnectionEvent.eventName,d.CreateNewConnectionEvent.getData(t.api)))}),w=(e,t,n)=>b(b(b({},e),t),{},{searchFilter:n.searchFilter}),O=Object(o.withRootProps)(Object(r.connect)(C,v,w)(Object(i.withLoadTelemetry)(m.ApiList,g.LoadScenarioNames.ApiList)))},7690:function(e,t,n){"use strict";n.r(t),n.d(t,"ApiList",(function(){return f}));var r=n(3064),o=n(3161),a=n(684),i=n(1240),s=n(545),l=n(245),c=n(7632),p=n(5628),u=n(5629),d=n(2879),m=n(5493),g=n(2869),h=n(5633);function b(){return(b=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}class f extends l.Component{constructor(e){super(e),this.resources=void 0,this.columns=void 0,this.resources=Object(g.getResources)(),this.columns=this.buildColumns()}componentDidMount(){this.props.onMount()}componentWillUnmount(){this.props.onDismount()}render(){var e;return e=l.createElement(r.DetailsList,b({isLoading:Object(u.isLoading)(this.props.loadProgress),filter:this.props.searchFilter,renderOnEmptySearch:()=>{var e=this.getPropsOnEmptySearch();return l.createElement(o.EmptyState,e)},isError:!!this.props.errorMessage,renderOnError:()=>{var e=this.getPropsOnError();return l.createElement(o.EmptyState,e)},items:this.props.apiListItems,columns:this.columns,setKey:"set",selectionMode:s.SelectionMode.none,className:"api-list-container",onRenderRow:(e,t)=>l.createElement("div",{className:"api-list-row-container",onClick:()=>this.props.onAddNewConnection(null==e?void 0:e.item)},null==t?void 0:t(e))},Object(h.getDetailsListProps)(this.resources.Common.rowSelectionAriaLabel))),l.createElement("div",{className:"api-list"},e)}getPropsOnEmptySearch(){return{icon:d.fabricIcons.Globe,className:"api-list-empty-message",primaryMessage:this.resources.Common.Search.NoMatch.title,secondaryMessage:[this.resources.Common.Search.NoMatch.message],maxWidth:p.emptyStateMaxWidth}}getPropsOnError(){return{icon:d.fabricIcons.Globe,className:"api-list-error-message",primaryMessage:this.resources.Common.Request.Failed,secondaryMessage:[this.props.errorMessage],maxWidth:p.emptyStateMaxWidth}}buildColumns(){return[Object(r.buildIconColumn)(e=>({iconUri:e.imageUrl,iconAltText:e.name,defaultIconUrl:m.default.getPaths().defaultConnectionIcon}),r.RowHeight.large),{key:"name",name:this.resources.Common.name,fieldName:"name",minWidth:200,maxWidth:650,isRowHeader:!0,isResizable:!0,isPadded:!0,isMultiline:!1,onRender:e=>{var t;return e.isPremium&&(t=()=>l.createElement("div",{className:"subheading-container"},l.createElement("span",{className:"subheading"},e.publisher),l.createElement(c.Badge,{text:this.resources.Controllers.Connections.premium,size:c.BadgeSize.small}))),l.createElement(r.DetailsListLink,{linkText:e.name,linkSubheading:e.publisher,linkProps:{role:"link",onContextMenu:e=>(e.preventDefault(),!1)},onRenderSubHeading:t})}},{key:"type",name:this.resources.Directives.List.Header.type,fieldName:"type",minWidth:150,maxWidth:600,isResizable:!0,isCollapsable:!0,isMultiline:!1,isPadded:!0},{key:"action",name:"",fieldName:"",minWidth:48,maxWidth:48,isResizable:!1,isPadded:!1,onRender:e=>{var t=this.resources.Directives.ApiList.Commands.create,n={menuIconProps:{iconName:d.fabricIcons.Add,ariaLabel:t,style:{fontSize:20}},ariaLabel:t};return l.createElement(i.TooltipHost,{content:t}," ",l.createElement(a.IconButton,n))}}]}}},7691:function(e,t,n){"use strict";n.r(t),n.d(t,"mapStateToProps",(function(){return b})),n.d(t,"mapDispatchToProps",(function(){return f})),n.d(t,"mergeProps",(function(){return y})),n.d(t,"CustomApisPageContainer",(function(){return S}));var r=n(5437),o=n(5487),a=n(5630),i=n(5796),s=n(5807),l=n(6866),c=n(5582),p=n(5474),u=n(7692),d=["fetchApis"];function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var b=(e,t)=>({apis:Object(s.apisSelectorIncludingCustom)(e)}),f=e=>({fetchApis:()=>{e(Object(i.fetchApisRequest)())},renewToken:(t,n)=>e(Object(p.getTokenRequest)({resource:t,resolve:n})),confirmDelete:(t,n)=>{e(Object(i.deleteApi)({api:t,callback:n}))},addConnection:t=>e(Object(l.createConnection)({apiName:t})),logActionStart:(t,n)=>Object(a.logActionStart)(e(Object(p.genericTelemetryAction)({})),t,n),logActionComplete:(t,n)=>Object(a.logActionComplete)(e(Object(p.genericTelemetryAction)({})),t,n),logActionFail:(t,n)=>Object(a.logActionFail)(e(Object(p.genericTelemetryAction)({})),t,n)}),y=(e,t,n)=>{var{apis:r}=e,{fetchApis:o}=t,a=h(t,d);return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){g(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({apis:r,environmentId:Object(c.currentEnvironmentName)(n),onMount:()=>{o()}},a)},S=Object(o.withRootProps)(Object(r.connect)(b,f,y)(u.CustomApisPage))},7692:function(e,t,n){"use strict";n.r(t),n.d(t,"CustomApisPage",(function(){return u}));n(7693);var r=n(245),o=n(2870),a=n(7694),i=n(2872),s="flow-customapi-widget-container-shell",l="ON_DELETE_CUSTOMAPI_CLICKED",c="ON_ADD_CONNECTION_CLICKED",p="refreshapis";class u extends r.Component{constructor(e){super(e),this.props=e,this.customApiSdk=void 0,this.appSettings=void 0,this.customApiWidget=void 0,this.appSettings=i.settings,this.customApiSdk=new MsFlowCustomApiSDK({hostName:this.appSettings.powerAppsFlowHostName,locale:o.HostSettings.getDeploymentLocale()})}componentDidMount(){this.props.onMount(),this.initializeCustomApisWidget()}componentDidUpdate(){this.initializeCustomApisWidget()}render(){return r.createElement(r.Fragment,null,r.createElement("div",{id:"flow-customapi-widget-container-shell",className:"fullscreen-widget",style:{display:"flex",flexFlow:"column",flexGrow:1,height:"100%"}}))}initializeCustomApisWidget(){var e=s,t=this.props.environmentId;if(t&&!this.customApiWidget){this.props.logActionStart(a.CustomApisLoad);try{this.customApiWidget=this.customApiSdk.renderWidget({container:e,environmentId:t,widgetStyleSettings:{backgroundColor:"white"}}),this.customApiWidget.callbacks.GET_ACCESS_TOKEN=(e,t)=>{var n=e&&e.data&&e.data.resource;"https://management.core.windows.net/"==n&&(n="https://service.flow.microsoft.com/");var r=(e,t)=>this.props.renewToken(e,t);new Promise((function(e,t){r(n,e)})).then(e=>{t(null,{token:e})})},this.customApiWidget.listen(l,e=>{this.props.logActionStart(a.CustomApisFetchToken);var t=e&&e.data&&e.data.apiName,n=this.props.apis.find(e=>e.name.toUpperCase()===t.toUpperCase());n&&this.props.confirmDelete(n,()=>{this.customApiWidget.notify(p,null)}).then(()=>{this.props.logActionComplete(a.CustomApisFetchToken)}).catch(e=>{this.props.logActionFail(a.CustomApisFetchToken,e),alert(e)})}),this.customApiWidget.listen(c,e=>{var t=e&&e.data&&e.data.apiName;this.props.addConnection(t)}),this.props.logActionComplete(a.CustomApisLoad)}catch(n){this.props.logActionFail(a.CustomApisLoad,n)}}}}},7694:function(e,t,n){"use strict";n.r(t),n.d(t,"FlowsLoad",(function(){return r})),n.d(t,"FlowsFetchToken",(function(){return o})),n.d(t,"CustomApisLoad",(function(){return a})),n.d(t,"CustomApisFetchToken",(function(){return i}));var r={eventName:"Flows.Embed.Load"},o={eventName:"Arm.AcquireFlowEmbedToken"},a={eventName:"CustomApis.Embed.Load"},i={eventName:"Arm.AcquireCustomApiEmbedToken"}},7695:function(e,t,n){"use strict";n.r(t),n.d(t,"mapDispatchToProps",(function(){return u})),n.d(t,"mergeProps",(function(){return d})),n.d(t,"FlowsPageContainer",(function(){return m}));var r=n(5437),o=n(5487),a=n(5630),i=n(5582),s=n(5474),l=n(7696);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var u=e=>({renewToken:(t,n,r)=>e(Object(s.getTokenRequest)({resource:t,resolve:n,reject:r})),logActionStart:(t,n)=>Object(a.logActionStart)(e(Object(s.genericTelemetryAction)({})),t,n),logActionComplete:(t,n)=>Object(a.logActionComplete)(e(Object(s.genericTelemetryAction)({})),t,n),logActionFail:(t,n)=>Object(a.logActionFail)(e(Object(s.genericTelemetryAction)({})),t,n)}),d=(e,t,n)=>function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){p(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({environmentId:Object(i.currentEnvironmentName)(n)},t),m=Object(o.withRootProps)(Object(r.connect)(null,u,d)(l.FlowsPage))},7696:function(e,t,n){"use strict";n.r(t),n.d(t,"FlowsPage",(function(){return l}));n(3570);var r=n(245),o=n(2870),a=n(2871),i=n(7694),s=n(2872);class l extends r.Component{constructor(e){super(e),this.props=e,this.flowSDK=void 0,this.appSettings=void 0,this.flowWidget=void 0,this.appSettings=s.settings,this.flowSDK=new MsFlowSdk({hostName:this.appSettings.powerAppsFlowHostName,locale:o.HostSettings.getDeploymentLocale()})}componentDidMount(){this.initializeFlowsWidget()}componentDidUpdate(){this.initializeFlowsWidget()}render(){return r.createElement("div",{id:"flow-widget-container-shell",className:"flow-widget",style:{display:"flex",flexFlow:"column",flexGrow:1,height:"100%"}})}initializeFlowsWidget(){var e=this.props.environmentId;if(e&&!this.flowWidget){var t=this.props.logActionStart(i.FlowsLoad);try{this.flowWidget=this.flowSDK.renderWidget("flows",{container:"flow-widget-container-shell",environmentId:e,enableRegionalPortal:a.featureGates.enableFlowRegionalPortal,flowsSettings:{createFromBlankTemplateId:this.appSettings.powerAppsFlowCreateFromBlankTemplateId,flowsFilter:"",enableBusinessProcessFlow:!0},templatesSettings:{templateCategory:this.appSettings.powerAppsFlowTemplateCategory},widgetStyleSettings:{backgroundColor:"white"}}),this.flowWidget.listen("GET_ACCESS_TOKEN",(e,t)=>{var n=this.props.logActionStart(i.FlowsFetchToken),r=e&&e.data&&e.data.resource;"https://management.core.windows.net/"==r&&(r="https://service.flow.microsoft.com/");var o=(e,t,n)=>this.props.renewToken(e,t,n);new Promise((function(e,t){o(r,e,t)})).then(e=>{t(null,{token:e}),this.props.logActionComplete(i.FlowsFetchToken,n)}).catch(e=>{var n=e.message||JSON.stringify(e);t(n,null),this.props.logActionFail(i.FlowsFetchToken,n)})}),this.props.logActionComplete(i.FlowsLoad,t)}catch(n){this.props.logActionFail(i.FlowsLoad,n)}}}}},7697:function(e,t,n){"use strict";n.r(t),n.d(t,"GatewayDetailsPageWithResources",(function(){return l}));var r=n(245),o=n(7698),a=n(2869),i=n(2871);function s(){return(s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var l=e=>{var t,n={breadCrumbs:{gateways:(t=Object(a.getResources)()).Common.gateways},commandBar:{delete:t.Common.delete,share:t.Common.share},common:{close:t.Common.close,loading:t.Common.Loading.ellipses,offline:t.Common.offline,online:t.Common.online,refresh:t.Common.refresh,seeAll:t.Common.seeAll},connectionsCard:{connectionFieldName:t.Common.FieldNames.connection,iconFieldName:t.Common.FieldNames.icon,moreConnections:t.Common.More.connections,noConnections:t.Connections.NoConnections.message,ownerFieldName:t.Common.owner,statusFieldName:t.Common.status,title:t.Common.connections},connectionsPanel:{bodyText:t.Connections.ConnectionPanel.description,closeButtonAriaLabel:t.Connections.ConnectionPanel.closeButtonAriaLabel,connectionsLinkText:t.Connections.ConnectionPanel.connectionsLinkText,title:t.Common.connections},clusterCard:{iconFieldName:t.Common.FieldNames.icon,gatewayFieldName:t.Common.gateways,moreGateways:t.Common.More.gateways,statusFieldName:t.Common.status,title:t.Common.Gateway.clusterCount,titleLinkAriaLabel:t.Common.Gateway.seeAllAriaLabel},deleteSurface:{bodyText:t.Controllers.Gateways.Delete.message,cancelButtonText:t.Common.cancel,confirmButtonText:t.Common.remove,titleTextTemplate:t.Controllers.Gateways.Delete.title},detailsCard:{distributionDescription:t.Common.Gateway.Cluster,distributionOffText:t.Controllers.AppSettings.ToggleText.toggleOffText,distributionOnText:t.Controllers.AppSettings.ToggleText.toggleOnText,distributionLabel:t.Common.Gateway.distributionLabel,gatewayClusterLabel:t.Common.Gateway.clusterLabel,gatewayClusterLinkText:t.Common.Gateway.clusterLearnMore,gatewayStatusLabel:t.Common.status,nameLabel:t.Common.name,ownerLabel:t.Common.owner,title:t.Common.details,uiFlowStatusLabel:i.featureGates.renameUIFlowsForGA?t.Common.Gateway.uiFlowStatusLabelGA:t.Common.Gateway.uiFlowStatusLabel},errors:{gatewayNotFound:t.Gateways.NoGateways.notFound},runsCard:{durationFieldLabel:t.UIFlows.durationLabel,noRuns:i.featureGates.renameUIFlowsForGA?t.UIFlows.Empty.gatewayNoRunsGA:t.UIFlows.Empty.gatewayNoRuns,startTimeFieldLabel:i.featureGates.renameUIFlowsForGA?t.UIFlows.requestedLabel:t.UIFlows.startTimeLabel,statusFieldLabel:t.Common.status,allRunsLabel:t.UIFlows.allRunsLabel,statusStrings:{canceled:t.UIFlows.RunStatus.canceled,failed:t.UIFlows.RunStatus.failed,running:t.UIFlows.RunStatus.running,skipped:t.UIFlows.RunStatus.skipped,succeeded:t.UIFlows.RunStatus.succeeded,unknown:t.UIFlows.RunStatus.unknown},title:i.featureGates.renameUIFlowsForGA?t.UIFlows.titleGA:t.UIFlows.title,uiFlowNameFieldLabel:i.featureGates.renameUIFlowsForGA?t.UIFlows.nameLabelGA:t.UIFlows.nameLabel,showMoreLabel:t.UIFlows.showMoreLabel}};return r.createElement(o.GatewayDetailsPage,s({},e,{resourceStrings:n}))}},7698:function(e,t,n){"use strict";n.r(t),n.d(t,"GatewayDetailsPage",(function(){return L}));var r,o=n(245),a=n(545),i=n(7699),s=n(303),l=n(4792),c=n(2903),p=n(7702),u=n(7811),d=n(7813),m=n(7820),g=n(7705),h=n(7755),b=n(7822),f=n(7823),y=n(7826),S=n(2871),C=n(7827),v=n(1697),w=n(5768),O=n(7829),P=n(217),E=n(7708),A=n(7830),j=Object(i.observer)(r=class extends o.Component{constructor(e){super(e),this.getClassNames=Object(c.classNamesFunction)(),this.classNames=this.getClassNames(b.getGatewayDetailsPageStyles),this.gatewayDetailsPageStore=void 0,this.async=new a.Async(this),this.gatewayName=void 0,this.gatewayDetailsPageScenario=void 0,this.totalCards=0,this.totalCardsLoadSuccess=0,this.totalCardsLoadFailure=0,this.lastCardError=void 0,this.renderBody=()=>o.createElement("div",{className:"ms-Grid",dir:"ltr"},o.createElement("div",{className:"ms-Grid-row"},o.createElement("div",{className:"ms-Grid-col ms-lg8 ms-sm12"},o.createElement("div",{className:"ms-Grid-row"},o.createElement("div",{className:"ms-Grid-col ms-sm12"},this.renderDetailsCard())),o.createElement("div",{className:"ms-Grid-row"},o.createElement("div",{className:"ms-Grid-col ms-sm12"},this.renderRunHistoryCard()))),o.createElement("div",{className:"ms-Grid-col ms-lg4 ms-sm12"},o.createElement("div",{className:"ms-Grid-row"},o.createElement("div",{className:"ms-Grid-col ms-lg12 ms-sm12"},this.renderConnectionsCard()),o.createElement("div",{className:"ms-Grid-col ms-lg12 ms-sm12"},this.renderGatewaysInClusterCard()))),o.createElement(O.SurfaceOverlay,null))),this.renderCommandBar=()=>o.createElement(y.GatewayDetailsCommandBar,{gatewayDetailsPageStore:this.gatewayDetailsPageStore}),this.renderMessageBars=()=>o.createElement(o.Fragment,null,o.createElement(A.DesktopFlowMachineMigrationMessageBar,{gatewayDetailsPageStore:this.gatewayDetailsPageStore}),o.createElement(C.GatewayDetailsMessageBar,{gatewayDetailsPageStore:this.gatewayDetailsPageStore})),this.renderTitle=()=>o.createElement(f.GatewayDetailsPageHeader,{gatewayDetailsPageStore:this.gatewayDetailsPageStore}),this.renderDetailsCard=()=>o.createElement(d.GatewayDetailsCard,{gatewayDetailsPageStore:this.gatewayDetailsPageStore,onLoad:this.onLoadCard,onLoadError:this.onLoadCardError}),this.renderConnectionsCard=()=>o.createElement(u.GatewayConnectionsCard,{gatewayDetailsPageStore:this.gatewayDetailsPageStore,onLoad:this.onLoadCard,onLoadError:this.onLoadCardError}),this.renderGatewaysInClusterCard=()=>o.createElement(m.GatewaysInClusterCard,{gatewayDetailsPageStore:this.gatewayDetailsPageStore,onLoad:this.onLoadCard,onLoadError:this.onLoadCardError}),this.renderRunHistoryCard=()=>S.featureGates.enableGatewayDetailsFlowRuns&&o.createElement(p.FlowRunsCard,{gatewayDetailsPageStore:this.gatewayDetailsPageStore,onLoad:this.onLoadCard,onLoadError:this.onLoadCardError}),this.loadGateways=()=>h.gatewayService.loadGateways().then(()=>{if(this.gatewayDetailsPageStore.gateway)return null;var e=this.resourceStrings.errors.gatewayNotFound;return this.gatewayDetailsPageStore.setMessageBarProps({ariaLabel:e,type:v.MessageBarType.error,onRenderBody:()=>e,onDismiss:this.gatewayDetailsPageStore.dismissMessageBar}),new Error(e)}).catch(e=>{var t=Object(w.getResponseErrorMessage)(e);return this.gatewayDetailsPageStore.setMessageBarProps({ariaLabel:t,type:v.MessageBarType.error,onRenderBody:()=>t,onDismiss:this.gatewayDetailsPageStore.dismissMessageBar}),e}),this.loadGatewayConnections=()=>h.gatewayService.loadGatewayConnections(this.gatewayName).then(()=>null).catch(e=>{var t=Object(w.getResponseErrorMessage)(e);return this.gatewayDetailsPageStore.setMessageBarProps({ariaLabel:t,type:v.MessageBarType.error,onRenderBody:()=>t,onDismiss:this.gatewayDetailsPageStore.dismissMessageBar}),e}),this.onLoadCard=()=>{this.totalCardsLoadSuccess++,this.processLoadCompletions()},this.onLoadCardError=e=>{this.lastCardError=e,this.totalCardsLoadFailure++,this.processLoadCompletions()},this.processLoadCompletions=()=>{this.totalCardsLoadSuccess+this.totalCardsLoadFailure===this.totalCards&&(0===this.totalCardsLoadFailure?this.gatewayDetailsPageScenario.complete({status:E.Status.Success,gatewayData:Object(E.getGatewayDetailsEventData)(this.gatewayDetailsPageStore)}):this.gatewayDetailsPageScenario.failure({status:E.Status.Failure,lastCardError:this.lastCardError,gatewayName:this.gatewayDetailsPageStore.gatewayName,gatewayData:Object(E.getGatewayDetailsEventData)(this.gatewayDetailsPageStore)}))},this.gatewayDetailsPageStore=new g.GatewayDetailsPageStore(this.props.resourceStrings,this.props.history.goBack),this.gatewayName=this.props.match.params.gatewayId,this.gatewayDetailsPageStore.setGatewayName(this.gatewayName),this.gatewayDetailsPageScenario=Object(P.trackLoadScenario)(E.gatewayDetailsEventScope,"gatewayDetailsPage",{gatewayName:this.gatewayName})}render(){return o.createElement(l.Page,{className:this.classNames.root,renderTitle:this.renderTitle,renderHeader:this.renderCommandBar,renderMessageBar:this.renderMessageBars,renderBody:this.renderBody})}componentDidMount(){Promise.all([this.loadGateways(),this.loadGatewayConnections()]).then(e=>{var[t,n]=e;t||n?this.gatewayDetailsPageScenario.failure({status:E.Status.Failure,error:t||n,gatewayName:this.gatewayDetailsPageStore.gatewayName}):(this.totalCards=2+(this.gatewayDetailsPageStore.hasUIFlowConnection?1:0)+(this.gatewayDetailsPageStore.gateway.isCluster?1:0),this.async.setTimeout(()=>this.processLoadCompletions(),0))})}componentWillUnmount(){this.async.dispose()}get resourceStrings(){return this.gatewayDetailsPageStore.resourceStrings}})||r,L=Object(s.withRouter)(j)},7702:function(e,t,n){"use strict";n.r(t),n.d(t,"FlowRunsCard",(function(){return P}));var r,o,a=n(245),i=n(7699),s=n(7701),l=n(2903),c=n(1697),p=n(684),u=n(303),d=n(7703),m=n(7797),g=n(7798),h=n(7755),b=n(2869),f=n(5768),y=n(7707),S=n(5623),C=n(2871),v=n(217),w=n(7708);function O(e,t,n,r,o){var a={};return Object.keys(r).forEach((function(e){a[e]=r[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}var P=Object(i.observer)((O((o=class extends a.Component{constructor(e){super(e),this.getClassNames=Object(l.classNamesFunction)(),this.classNames=this.getClassNames(m.getFlowRunsCardStyles),this.resources=Object(b.getResources)(),this.flowRunsCardScenario=void 0,this.renderTitle=()=>a.createElement(a.Fragment,null,this.props.gatewayDetailsPageStore.resourceStrings.runsCard.title),this.renderTitleLink=()=>a.createElement(a.Fragment,null,a.createElement(p.IconButton,{iconProps:{iconName:"Refresh"},title:this.props.gatewayDetailsPageStore.resourceStrings.common.refresh,onClick:this.onTitleLinkClick}),C.featureGates.enableGatewayAllRuns&&a.createElement(u.Link,{to:this.allRunsLink},this.props.gatewayDetailsPageStore.resourceStrings.runsCard.allRunsLabel)),this.renderBody=()=>a.createElement(d.FlowRunsDetailsList,{store:this.props.gatewayDetailsPageStore,disableSelection:!0,maxRunsToDisplay:10}),this.onTitleLinkClick=e=>{Object(v.trackUserActionClickLink)(w.gatewayDetailsEventScope,"flowRunsCard/title",Object(w.getGatewayDetailsEventData)(this.props.gatewayDetailsPageStore)),this.loadFlowRuns(e)},this.loadFlowRuns=e=>{var{gatewayDetailsPageStore:t}=this.props;h.gatewayService.loadGatewayUIFlowRuns({gatewayName:t.gatewayName,forceRefresh:!0}).then(()=>{this.flowRunsCardScenario.complete(),this.props.onLoad()}).catch(e=>{this.flowRunsCardScenario.failure(),this.props.onLoadError(e);var n=Object(f.getResponseErrorMessage)(e);t.setMessageBarProps({ariaLabel:n,type:c.MessageBarType.error,onRenderBody:()=>n,onDismiss:()=>t.setMessageBarProps(null)})})},this.flowRunsCardScenario=Object(v.trackLoadScenario)(w.gatewayDetailsEventScope,"flowRunsCard",{gatewayName:this.props.gatewayDetailsPageStore.gatewayName})}render(){return this.props.gatewayDetailsPageStore.hasUIFlowConnection&&a.createElement(g.DetailsCard,{ariaLabelLoading:this.resources.Common.Loading.ellipses,className:this.classNames.root,isLoading:this.isLoading,renderTitle:this.renderTitle,renderTitleLink:this.renderTitleLink,renderBody:this.renderBody})}componentDidMount(){this.loadFlowRuns()}get isLoading(){return this.props.gatewayDetailsPageStore.isLoadingGatewayRuns}get allRunsLink(){return Object(S.getGatewayRunsListLaunchUri)(Object(y.getCurrentEnvironmentName)(),this.props.gatewayDetailsPageStore.gatewayName)}}).prototype,"isLoading",[s.computed],Object.getOwnPropertyDescriptor(o.prototype,"isLoading"),o.prototype),O(o.prototype,"allRunsLink",[s.computed],Object.getOwnPropertyDescriptor(o.prototype,"allRunsLink"),o.prototype),r=o))||r},7703:function(e,t,n){"use strict";n.r(t),n.d(t,"RunColumns",(function(){return a})),n.d(t,"RunColumnWidths",(function(){return i})),n.d(t,"FlowRunsDetailsList",(function(){return A}));var r,o,a,i,s=n(245),l=n(7699),c=n(7701),p=n(1471),u=n(3064),d=n(3161),m=n(2903),g=n(7704),h=n(7784),b=n(7787),f=n(7789),y=n(7791),S=n(7793),C=n(7795),v=n(1697),w=n(5768),O=n(217),P=n(7796);function E(e,t,n,r,o){var a={};return Object.keys(r).forEach((function(e){a[e]=r[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}!function(e){e.status="status",e.startTime="startTime",e.duration="duration",e.uiFlowName="uiFlowName"}(a||(a={})),function(e){e[e.commonMin=100]="commonMin",e[e.commonMax=400]="commonMax",e[e.smallMin=55]="smallMin",e[e.smallMax=200]="smallMax"}(i||(i={}));var A=Object(l.observer)((E((o=class extends s.Component{constructor(){super(...arguments),this.getClassNames=Object(m.classNamesFunction)(),this.classNames=this.getClassNames(C.getFlowRunsDetailsListStyles),this.onRenderEmptyState=()=>s.createElement(d.EmptyState,{icon:"BulletedList2",className:"gateway-RunsListEmpty",secondaryMessage:this.props.store.resourceStrings.runsCard.noRuns}),this.renderSegmentHandler=(e,t)=>{switch(e.type){case S.FormattableTextSegmentType.LITERAL:return s.createElement("span",{key:t},e.value);case S.FormattableTextSegmentType.PLACEHOLDER:return s.createElement("span",{className:this.classNames.zeroRunContent,key:t},s.createElement("b",null,e.value));default:return null}},this.onLoadMore=()=>{var{store:{gatewayName:e,gatewayUIFlowRuns:t,runFilter:n,setMessageBarProps:r}}=this.props,o=Object(O.trackLoadScenario)(P.gatewayRunsEventScope,P.gatewayMoreRunsEventName,{gatewayName:e,runFilter:n});g.gatewayService.loadMoreGatewayUIFlowRuns({gatewayName:e,status:n,nextLink:t.nextLink}).then(()=>{o.complete({status:P.Status.Success,gatewayName:e,runsFilter:n})}).catch(t=>{var a=Object(w.getResponseErrorMessage)(t);this.props.store.setMessageBarProps({ariaLabel:a,type:v.MessageBarType.error,onRenderBody:()=>a,onDismiss:()=>r(null)}),o.failure({status:P.Status.Failure,error:t,gatewayName:e,runsFilter:n})}),Object(O.trackUserActionClickButton)(P.gatewayRunsEventScope,P.gatewayMoreRunsEventName,{gatewayName:e,runsFilter:n})}}render(){var{store:{gatewayUIFlowRuns:e}}=this.props;return e&&e.length>0?s.createElement("div",{className:this.classNames.root},s.createElement(u.DetailsList,this.detailsListProps)):s.createElement("div",{className:this.classNames.zeroRunContainer},this.isRunsCardList?this.renderZeroRunContent():this.onRenderEmptyState())}get columns(){return[{key:a.startTime,name:this.resourceStrings.runsCard.startTimeFieldLabel,fieldName:a.startTime,minWidth:i.smallMin,maxWidth:i.smallMax,isRowHeader:!0,columnActionsMode:p.ColumnActionsMode.disabled,onRender:e=>s.createElement(f.FlowRunLinkCell,{runId:e})},{key:a.duration,name:this.resourceStrings.runsCard.durationFieldLabel,fieldName:a.duration,minWidth:i.smallMin,maxWidth:i.smallMax,isCollapsable:!0,columnActionsMode:p.ColumnActionsMode.disabled,onRender:e=>s.createElement(b.FlowRunDurationCell,{runId:e})},{key:a.uiFlowName,name:this.resourceStrings.runsCard.uiFlowNameFieldLabel,fieldName:a.status,minWidth:i.smallMin,maxWidth:i.commonMax,isCollapsable:!0,columnActionsMode:p.ColumnActionsMode.disabled,onRender:e=>s.createElement(y.FlowNameCell,{runId:e,errorDisplayString:this.resourceStrings.runsCard.statusStrings.unknown})},{key:a.status,name:this.resourceStrings.runsCard.statusFieldLabel,fieldName:a.status,minWidth:i.commonMin,isCollapsable:!0,columnActionsMode:p.ColumnActionsMode.disabled,onRender:e=>s.createElement(h.FlowRunStatusCell,{resourceStrings:this.resourceStrings.runsCard.statusStrings,runId:e})}]}get detailsListProps(){return{columns:this.columns,isLoading:!1,items:this.runsCollectionItems,checkboxVisibility:this.props.disableSelection?p.CheckboxVisibility.hidden:p.CheckboxVisibility.onHover,showLoadMoreButton:!this.isRunsCardList&&this.props.store.hasMore,loadMoreButtonProps:{text:this.props.store.resourceStrings.runsCard.showMoreLabel,onClick:this.onLoadMore},compact:!0,getKey:e=>e}}get isRunsCardList(){return!!this.props.maxRunsToDisplay}get runsCollectionItems(){var{store:{isLoadingGatewayRuns:e,gatewayUIFlowSortedRunsList:t},maxRunsToDisplay:n}=this.props;return e?[]:n?t.slice(0,n):t}renderZeroRunContent(){return s.createElement(S.FormattableText,{formatText:this.resourceStrings.runsCard.noRuns,onRenderSegment:this.renderSegmentHandler})}get resourceStrings(){return this.props.store.resourceStrings}}).prototype,"columns",[c.computed],Object.getOwnPropertyDescriptor(o.prototype,"columns"),o.prototype),E(o.prototype,"detailsListProps",[c.computed],Object.getOwnPropertyDescriptor(o.prototype,"detailsListProps"),o.prototype),E(o.prototype,"isRunsCardList",[c.computed],Object.getOwnPropertyDescriptor(o.prototype,"isRunsCardList"),o.prototype),E(o.prototype,"runsCollectionItems",[c.computed],Object.getOwnPropertyDescriptor(o.prototype,"runsCollectionItems"),o.prototype),r=o))||r},7704:function(e,t,n){"use strict";n.r(t),n.d(t,"RunFilterStatus",(function(){return r})),n.d(t,"RunStatusCode",(function(){return o})),n.d(t,"gatewayService",(function(){return S}));var r,o,a=n(7705),i=n(7726),s=n(7731),l=n(7754),c=n(7759),p=n(7757),u=n(7711),d=n(7756),m=n(7707),g=n(7761),h=n(7767),b=n(7779);function f(e,t,n,r,o,a,i){try{var s=e[a](i),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}function y(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){f(a,r,o,i,s,"next",e)}function s(e){f(a,r,o,i,s,"throw",e)}i(void 0)}))}}!function(e){e.all="all",e.cancelled="cancelled",e.failed="failed",e.running="running",e.skipped="skipped",e.succeeded="succeeded"}(r||(r={})),function(e){e[e.cancelled=7]="cancelled",e[e.failed=8]="failed",e[e.running=2]="running",e[e.skipped=5]="skipped",e[e.succeeded=4]="succeeded"}(o||(o={}));var S=new class{constructor(){var e=this;this.runFirstPending=Object(p.runFirstPendingFactory)(),this.gatewayHttpClient=new i.GatewayHttpClient,this.xrmHttpClient=new i.XrmHttpClient,this.loadGatewayConnections=function(t){var n,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=Object(m.getCurrentObjectId)(),i=Object(m.getCurrentEnvironmentName)(),s=a.ConnectionsStore.getGatewayCollectionKey(t,i),l=a.connectionsStore.connections.getCollection(s),p=l?l.lastFetched:null;if(r||Object(c.shouldFetch)(p)){var d="loadGatewayConnections-".concat(t);return e.runFirstPending({key:d,action:(n=y((function*(){try{a.connectionsStore.connections.setCollectionLoading(s);for(var n=yield e.gatewayHttpClient.getGatewayConnections({environmentName:i,objectId:o,gatewayName:t}),r=n.data&&n.data.value||[];n.data&&n.data.nextLink;)n=yield e.gatewayHttpClient.getMoreGatewayConnections(n.data.nextLink),r=r.concat(n.data&&n.data.value||[]);a.connectionsStore.connections.setCollectionLoaded(s,r.map(e=>new u.ConnectionEntity(e)),{nextLink:void 0,resetList:!1,replaceDupe:c.alwaysReplace})}catch(l){throw a.connectionsStore.connections.setCollectionError(s,l),l}})),function(){return n.apply(this,arguments)})})}return Promise.resolve()},this.loadGatewayStatus=function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=Object(m.getCurrentObjectId)(),o=Object(m.getCurrentEnvironmentName)(),i=a.gatewaysStore.gatewaysStatus.entities,s=i.entityStatus.get(t),l=s?s.lastFetched:null;if(n||Object(c.shouldFetch)(l)){var p="loadGatewayStatus-".concat(t);return e.runFirstPending({key:p,action:()=>(i.setEntityFetching(t),e.gatewayHttpClient.getGatewayStatus({environmentName:o,objectId:r,gatewayName:t}).then(e=>{i.addEntity(new u.GatewayStatusEntity({name:t,status:e.data.clusterStatus}),c.alwaysReplace),i.setEntitySuccess(t)}).catch(e=>{throw i.setEntityError(t,e),e}))})}return Promise.resolve()},this.followContinuationTokens=function(){var e=y((function*(e,t,n){for(var{data:{nextLink:r,value:o}}=e,a=o.map(e=>new n(e));r;){var i=yield t(r);r=i.data.nextLink,a=a.concat(i.data.value.map(e=>new n(e)))}return a}));return function(t,n,r){return e.apply(this,arguments)}}(),this.loadGateways=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=Object(m.getCurrentObjectId)(),r=Object(m.getCurrentEnvironmentName)(),o=a.GatewaysStore.getEnvironmentCollectionKey(r),i=a.gatewaysStore.gateways.getCollection(o),s=i?i.lastFetched:null;if(t||Object(c.shouldFetch)(s)){var l="loadGateways-".concat(r);return e.runFirstPending({key:l,action:()=>(a.gatewaysStore.gateways.setCollectionLoading(o),e.gatewayHttpClient.getGateways({environmentName:r,objectId:n}).then(e=>{var{data:{value:t,nextLink:n}}=e;a.gatewaysStore.gateways.setCollectionLoaded(o,t?t.map(e=>new u.GatewayEntity(e)):[],{nextLink:n,resetList:!1,replaceDupe:c.alwaysReplace})}).catch(e=>{throw a.gatewaysStore.gateways.setCollectionError(o,e),e}))})}return Promise.resolve()},this.loadGatewayUIFlowRuns=e=>{var{gatewayName:t,status:n,forceRefresh:o}=e,i=Object(m.getCurrentEnvironmentName)(),p=n||r.all,g=a.UIFlowRunsStore.getGatewayCollectionKey(t,i,p),h=a.uiFlowRunsStore.uiFlowRuns.getCollection(g),b=h?h.lastFetched:null;if(o||Object(c.shouldFetch)(b)){var f="loadGatewaysRuns-".concat(t,"-").concat(p);return this.runFirstPending({key:f,action:()=>(a.uiFlowRunsStore.uiFlowRuns.setCollectionLoading(g),d.xrmService.xrmEntityHasAttributes("flowsession",["context","gateway"]).then(e=>e?this.xrmHttpClient.getRuns({filterParams:"$filter=".concat(Object(s.getGatewayFilterString)(t)).concat(Object(s.getRunStatusFilterString)(Object(l.getStatusCode)(p)),"&$orderby=createdon desc")}):Promise.resolve({data:{value:[]},status:200,statusText:"Ok"})).then(e=>{var{data:{value:t}}=e;a.uiFlowRunsStore.uiFlowRuns.setCollectionLoaded(g,t.map(e=>new u.UiFlowRunEntity(e)),{nextLink:e.data["@odata.nextLink"],resetList:!1,replaceDupe:c.alwaysReplace})}).catch(e=>{throw a.uiFlowRunsStore.uiFlowRuns.setCollectionError(g,e),e}))})}return Promise.resolve()},this.showDeleteUI=e=>{Object(g.spawnDeleteGatewaySurface)(a.surfaceStore,e.gatewayName,e.resourceStrings,e.onError,e.onDeleteSuccess)},this.showAllGatewaysUI=e=>{Object(b.spawnGatewayClusterDetailsSurface)(a.surfaceStore,e.gatewayName,e.resourceStrings)},this.updateIsLoadBalanced=(e,t)=>{var n=Object(m.getCurrentObjectId)(),r=Object(m.getCurrentEnvironmentName)(),o="updateIsLoadBalanced-".concat(e,"-").concat(t);return this.runFirstPending({key:o,action:()=>(a.gatewaysStore.gateways.entities.setEntityUpdating(e),a.gatewaysStore.gateways.getEntity(e).setIsGatewayLoadBalanced(t),this.gatewayHttpClient.toggleIsLoadBalanced(e,r,n,t).then(t=>{a.gatewaysStore.gateways.entities.setEntitySuccess(e)}).catch(n=>{throw a.gatewaysStore.gateways.getEntity(e).setIsGatewayLoadBalanced(!t),a.gatewaysStore.gateways.entities.setEntityError(e,n),n}))})},this.deleteGateway=e=>{var t=Object(m.getCurrentEnvironmentName)(),n="delete-".concat(t,"-").concat(e),r=Object(m.getCurrentObjectId)();return this.runFirstPending({key:n,action:()=>(a.gatewaysStore.setGatewayDeleting(e),this.gatewayHttpClient.deleteGateway(e,t,r).then(()=>{a.gatewaysStore.setGatewaySuccess(e)}).catch(t=>{throw a.gatewaysStore.setGatewayError(e,t),t}))})},this.showAllConnectionsUI=e=>{var t=Object(m.getCurrentEnvironmentName)();Object(h.spawnConnectionsListSurface)(a.surfaceStore,a.ConnectionsStore.getGatewayCollectionKey(e.gatewayName,t),()=>this.loadGatewayConnections(e.gatewayName),e.resourceStrings)}}loadMoreGatewayUIFlowRuns(e){var{gatewayName:t,status:n,nextLink:o}=e,i=Object(m.getCurrentEnvironmentName)(),s=n||r.all,l=a.UIFlowRunsStore.getGatewayCollectionKey(t,i,s);return a.uiFlowRunsStore.uiFlowRuns.setCollectionLoading(l),this.runFirstPending({key:"getMoreFlowRuns/environments/".concat(i,"/flows/").concat(t,"/status/").concat(s),action:()=>this.xrmHttpClient.getMoreRuns(o).then(e=>{var{data:{value:t}}=e;a.uiFlowRunsStore.uiFlowRuns.setCollectionLoaded(l,t.map(e=>new u.UiFlowRunEntity(e)),{nextLink:e.data["@odata.nextLink"],resetList:!1,replaceDupe:c.alwaysReplace})}).catch(e=>{throw a.uiFlowRunsStore.uiFlowRuns.setCollectionError(l,e),e})})}}},7705:function(e,t,n){"use strict";n.r(t);var r=n(7706);n.d(t,"GatewayDetailsPageStore",(function(){return r.GatewayDetailsPageStore}));var o=n(7710);n.d(t,"GatewaysStore",(function(){return o.GatewaysStore})),n.d(t,"gatewaysStore",(function(){return o.gatewaysStore}));var a=n(7720);n.d(t,"ConnectionsStore",(function(){return a.ConnectionsStore})),n.d(t,"connectionsStore",(function(){return a.connectionsStore}));var i=n(7721);n.d(t,"SurfaceStore",(function(){return i.SurfaceStore})),n.d(t,"surfaceStore",(function(){return i.surfaceStore}));var s=n(7724);n.d(t,"UIFlowRunsStore",(function(){return s.UIFlowRunsStore})),n.d(t,"uiFlowRunsStore",(function(){return s.uiFlowRunsStore}));var l=n(7725);n.d(t,"WorkflowStore",(function(){return l.WorkflowStore})),n.d(t,"workflowsStore",(function(){return l.workflowsStore}))},7706:function(e,t,n){"use strict";n.r(t),n.d(t,"GatewayDetailsPageStore",(function(){return S}));var r,o,a,i,s,l,c=n(7701),p=n(7705),u=n(7707),d=n(217),m=n(7708),g=n(7704),h=n(7536),b=n(7709);function f(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function y(e,t,n,r,o){var a={};return Object.keys(r).forEach((function(e){a[e]=r[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}var S=(o=y((r=class{constructor(e,t){this.resourceStrings=e,this.onDeleteGateway=t,f(this,"gatewayName",o,this),f(this,"messageBarProps",a,this),f(this,"runFilter",i,this),f(this,"setMessageBarProps",s,this),f(this,"dismissMessageBar",l,this)}get gateway(){return p.gatewaysStore.gateways.entities.entities.get(this.gatewayName)}get gatewayConnections(){return p.connectionsStore.connections.getCollection(p.ConnectionsStore.getGatewayCollectionKey(this.gatewayName,Object(u.getCurrentEnvironmentName)()))}get gatewayUIFlowRuns(){return p.uiFlowRunsStore.uiFlowRuns.getCollection(p.UIFlowRunsStore.getGatewayCollectionKey(this.gatewayName,Object(u.getCurrentEnvironmentName)(),g.RunFilterStatus.all))}get gatewayUIFlowSortedRunsList(){return[...this.isLoadingGatewayRuns?[]:this.gatewayUIFlowRuns.list].sort((e,t)=>{var n=p.uiFlowRunsStore.uiFlowRuns.getEntity(e),r=p.uiFlowRunsStore.uiFlowRuns.getEntity(t);return Object(b.compareUIFlowRunEntity)(n,r)})}get hasUIFlowConnection(){if(this.gatewayConnections&&this.gatewayConnections.length)for(var e of this.gatewayConnections.list){if(p.connectionsStore.connections.getEntity(e).isUiFlowConnection)return!0}return!1}get isLoadingGatewayRuns(){return this.gatewayUIFlowRuns.isCollectionLoading}get isLoadingGateway(){return!p.gatewaysStore.gateways.hasEntity(this.gatewayName)||p.gatewaysStore.gateways.isEntityFetching(this.gatewayName)}get hasMore(){return this.gatewayUIFlowRuns&&this.gatewayUIFlowRuns.hasMore}get isLoadingGatewayConnections(){return!this.gatewayConnections||this.gatewayConnections.isLoadingInitially}setGatewayName(e){this.gatewayName=e}}).prototype,"gatewayName",[c.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=y(r.prototype,"messageBarProps",[c.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),i=y(r.prototype,"runFilter",[c.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y(r.prototype,"gateway",[c.computed],Object.getOwnPropertyDescriptor(r.prototype,"gateway"),r.prototype),y(r.prototype,"gatewayConnections",[c.computed],Object.getOwnPropertyDescriptor(r.prototype,"gatewayConnections"),r.prototype),y(r.prototype,"gatewayUIFlowRuns",[c.computed],Object.getOwnPropertyDescriptor(r.prototype,"gatewayUIFlowRuns"),r.prototype),y(r.prototype,"gatewayUIFlowSortedRunsList",[c.computed],Object.getOwnPropertyDescriptor(r.prototype,"gatewayUIFlowSortedRunsList"),r.prototype),y(r.prototype,"hasUIFlowConnection",[c.computed],Object.getOwnPropertyDescriptor(r.prototype,"hasUIFlowConnection"),r.prototype),y(r.prototype,"isLoadingGatewayRuns",[c.computed],Object.getOwnPropertyDescriptor(r.prototype,"isLoadingGatewayRuns"),r.prototype),y(r.prototype,"isLoadingGateway",[c.computed],Object.getOwnPropertyDescriptor(r.prototype,"isLoadingGateway"),r.prototype),y(r.prototype,"hasMore",[c.computed],Object.getOwnPropertyDescriptor(r.prototype,"hasMore"),r.prototype),y(r.prototype,"setGatewayName",[c.action],Object.getOwnPropertyDescriptor(r.prototype,"setGatewayName"),r.prototype),s=y(r.prototype,"setMessageBarProps",[c.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.messageBarProps=e}}}),l=y(r.prototype,"dismissMessageBar",[c.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{Object(d.trackUserActionClickButton)(m.gatewayDetailsEventScope,"gatewayDetails/messageBar/dismiss",this.gateway?Object(h.getGatewayData)(this.gateway):{gatewayId:this.gatewayName}),this.setMessageBarProps(null)}}}),r)},7707:function(e,t,n){"use strict";n.r(t),n.d(t,"getCurrentSessionId",(function(){return s})),n.d(t,"getCurrentObjectId",(function(){return l})),n.d(t,"getCurrentEnvironmentName",(function(){return c})),n.d(t,"getCurrentXrmUrl",(function(){return p})),n.d(t,"getCurrentLocale",(function(){return u})),n.d(t,"getUiFlowsUrl",(function(){return d}));var r=n(2870),o=n(5606),a=n(5604),i=n(2872);function s(){var e=r.HostSettings.getUserSessionInfo();return e?e.sessionId:void 0}function l(){var e=r.HostSettings.getUserSessionInfo();return e?e.objectId:void 0}function c(){var e=o.SagaContextProps.getCurrentEnvironment();return e?e.name:void 0}function p(){var e=o.SagaContextProps.getCurrentEnvironment();return a.getCrmInstanceUrl(e)}function u(){return r.HostSettings.getDeploymentLocale()}function d(){return i.settings.microsoftFlowUrl.replace("/flows","/uiflows")}},7708:function(e,t,n){"use strict";n.r(t),n.d(t,"gatewayDetailsEventScope",(function(){return a})),n.d(t,"Status",(function(){return r})),n.d(t,"getGatewayDetailsEventData",(function(){return i}));var r,o=n(7536),a="powerappsportal/gatewayDetails";function i(e){return e.gateway?Object(o.getGatewayData)(e.gateway):{gatewayId:e.gatewayName}}!function(e){e.Success="Success",e.Failure="Failure",e.Abort="Abort",e.ValidationError="ValidationError",e.Warning="Warning"}(r||(r={}))},7709:function(e,t,n){"use strict";function r(e,t){return e&&e.createdon?t&&t.createdon&&e.createdon<=t.createdon?1:-1:t&&t.createdon?1:0}n.r(t),n.d(t,"compareUIFlowRunEntity",(function(){return r}))},7710:function(e,t,n){"use strict";n.r(t),n.d(t,"GatewaysStore",(function(){return p})),n.d(t,"gatewaysStore",(function(){return u}));var r,o,a,i=n(7701),s=n(7711);function l(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function c(e,t,n,r,o){var a={};return Object.keys(r).forEach((function(e){a[e]=r[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}var p=(o=c((r=class{constructor(){l(this,"gateways",o,this),l(this,"gatewaysStatus",a,this),Object(i.runInAction)(()=>{this.gateways=new s.Entities({getKey:e=>e.name}),this.gatewaysStatus=new s.Entities({getKey:e=>e.name})})}static getEnvironmentCollectionKey(e){return"environment-".concat(e)}removeGateway(e){this.gateways.removeEntity(e),this.gatewaysStatus.removeEntity(e)}setGatewayDeleting(e){this.gateways.entities.setEntityDeleting(e),this.gatewaysStatus.entities.setEntityDeleting(e)}setGatewaySuccess(e){this.gateways.entities.setEntitySuccess(e),this.gatewaysStatus.entities.setEntitySuccess(e)}setGatewayError(e,t){this.gateways.entities.setEntityError(e,t),this.gatewaysStatus.entities.setEntityError(e,t)}isGatewayDeleting(e){return this.gateways.isEntityDeleting(e)||this.gatewaysStatus.isEntityDeleting(e)}}).prototype,"gateways",[i.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=c(r.prototype,"gatewaysStatus",[i.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c(r.prototype,"removeGateway",[i.action],Object.getOwnPropertyDescriptor(r.prototype,"removeGateway"),r.prototype),c(r.prototype,"setGatewayDeleting",[i.action],Object.getOwnPropertyDescriptor(r.prototype,"setGatewayDeleting"),r.prototype),c(r.prototype,"setGatewaySuccess",[i.action],Object.getOwnPropertyDescriptor(r.prototype,"setGatewaySuccess"),r.prototype),c(r.prototype,"setGatewayError",[i.action],Object.getOwnPropertyDescriptor(r.prototype,"setGatewayError"),r.prototype),r),u=new p},7711:function(e,t,n){"use strict";n.r(t);var r=n(7712);n.d(t,"Entities",(function(){return r.Entities}));var o=n(7713);n.d(t,"EntityCollection",(function(){return o.EntityCollection}));var a=n(7714);n.d(t,"EntityFetchStatus",(function(){return a.EntityFetchStatus})),n.d(t,"EntityMap",(function(){return a.EntityMap}));var i=n(7715);n.d(t,"ConnectionEntity",(function(){return i.ConnectionEntity}));var s=n(7716);n.d(t,"GatewayEntity",(function(){return s.GatewayEntity}));var l=n(7717);n.d(t,"GatewayStatusEntity",(function(){return l.GatewayStatusEntity}));var c=n(7718);n.d(t,"FlowSessionStatusCode",(function(){return c.FlowSessionStatusCode})),n.d(t,"UiFlowRunEntity",(function(){return c.UiFlowRunEntity}));var p=n(7719);n.d(t,"FlowCategory",(function(){return p.FlowCategory})),n.d(t,"UIFlowType",(function(){return p.UIFlowType})),n.d(t,"WorkflowEntity",(function(){return p.WorkflowEntity}))},7712:function(e,t,n){"use strict";n.r(t),n.d(t,"Entities",(function(){return v}));var r,o,a,i,s,l,c,p,u,d,m,g,h,b,f=n(7701),y=n(7711);function S(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function C(e,t,n,r,o){var a={};return Object.keys(r).forEach((function(e){a[e]=r[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}var v=(o=C((r=class{constructor(e){this.options=e,S(this,"entities",o,this),S(this,"collections",a,this),this.getEntity=e=>this.entities.getEntity(e),this.getEntityStatus=e=>this.entities.getEntityStatus(e),this.hasEntity=e=>this.entities.has(e),this.isEntityErrored=e=>this.entities.isEntityErrored(e),this.isEntityDeleting=e=>this.entities.isEntityDeleting(e),this.isEntityFetching=e=>this.entities.isEntityFetching(e),this.isEntityLoading=e=>this.entities.isEntityLoading(e),this.getCollection=e=>this.collections.get(e),S(this,"addEntity",i,this),S(this,"addEntityToCollection",s,this),S(this,"updateEntityInCollection",l,this),S(this,"clearCollection",c,this),S(this,"addKeyToCollection",p,this),S(this,"removeKeyFromCollection",u,this),S(this,"setCollectionLoading",d,this),S(this,"setCollectionLoaded",m,this),S(this,"setCollectionError",g,this),S(this,"removeEntity",h,this),this.isCollectionInitialized=e=>this.collections.has(e)&&!!this.collections.get(e).list,S(this,"addCollectionTypeIfNotAlreadyAdded",b,this),Object(f.runInAction)(()=>{this.collections=new Map,this.entities=new y.EntityMap({getKey:e.getKey}),(e.defaultCollectionTypes||[]).forEach(e=>{this.collections.set(e,new y.EntityCollection)})})}}).prototype,"entities",[f.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=C(r.prototype,"collections",[f.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),i=C(r.prototype,"addEntity",[f.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>this.entities.addEntity(e,t)}}),s=C(r.prototype,"addEntityToCollection",[f.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{var{collectionType:t,entity:n,prepend:r=!1,replaceDupe:o}=e,a=this.entities.addEntity(n,o);this.entities.setEntitySuccess(a),this.isCollectionInitialized(t)&&this.addKeyToCollection(t,a,r)}}}),l=C(r.prototype,"updateEntityInCollection",[f.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,n)=>{if(this.isCollectionInitialized(e)){var r=this.addEntity(t,n);this.addKeyToCollection(e,r,!1)}}}}),c=C(r.prototype,"clearCollection",[f.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{var t=this.getCollection(e);t&&t.list.forEach(e=>{this.removeEntity(e)})}}}),p=C(r.prototype,"addKeyToCollection",[f.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e.addCollectionTypeIfNotAlreadyAdded(t),e.collections.get(t).addEntity(n,r)}}}),u=C(r.prototype,"removeKeyFromCollection",[f.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.addCollectionTypeIfNotAlreadyAdded(e),this.collections.get(e).removeEntity(t)}}}),d=C(r.prototype,"setCollectionLoading",[f.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.addCollectionTypeIfNotAlreadyAdded(e),this.collections.get(e).setLoading(!0)}}}),m=C(r.prototype,"setCollectionLoaded",[f.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,n)=>{var{nextLink:r,resetList:o=!1,replaceDupe:a}=n,i=[];for(var s of(this.addCollectionTypeIfNotAlreadyAdded(e),t)){var l=this.options.getKey(s);i.push(l),this.entities.addEntity(s,a),this.entities.setEntitySuccess(l)}this.collections.get(e).setLoaded(i,{lastFetched:new Date,nextLink:r,resetList:o})}}}),g=C(r.prototype,"setCollectionError",[f.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.addCollectionTypeIfNotAlreadyAdded(e),this.collections.get(e).setError(t)}}}),h=C(r.prototype,"removeEntity",[f.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.collections.forEach(t=>{t.removeEntity(e)}),this.entities.removeEntity(e)}}}),b=C(r.prototype,"addCollectionTypeIfNotAlreadyAdded",[f.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.collections.has(e)||this.collections.set(e,new y.EntityCollection)}}}),r)},7713:function(e,t,n){"use strict";n.r(t),n.d(t,"EntityCollection",(function(){return C}));var r,o,a,i,s,l,c,p,u,d,m,g,h,b=n(7701),f=n(2812);function y(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function S(e,t,n,r,o){var a={};return Object.keys(r).forEach((function(e){a[e]=r[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}var C=(o=S((r=class{constructor(){y(this,"error",o,this),y(this,"isCollectionLoading",a,this),y(this,"list",i,this),y(this,"lastFetched",s,this),y(this,"nextLink",l,this),this.hasEntity=e=>this.list&&-1!==this.list.indexOf(e),y(this,"addEntity",c,this),y(this,"removeEntity",p,this),y(this,"removeAllEntities",u,this),y(this,"clearNextLink",d,this),y(this,"setLoading",m,this),y(this,"setLoaded",g,this),y(this,"setError",h,this)}get hasMore(){return!!this.nextLink}get hasStartedLoading(){return!!this.list}get isLoadingInitially(){return!!this.list&&this.isCollectionLoading&&!this.nextLink}get isLoadingMore(){return this.isCollectionLoading&&!!this.nextLink}get length(){return this.list&&this.list.length}}).prototype,"error",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=S(r.prototype,"isCollectionLoading",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),i=S(r.prototype,"list",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=S(r.prototype,"lastFetched",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=S(r.prototype,"nextLink",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S(r.prototype,"hasMore",[b.computed],Object.getOwnPropertyDescriptor(r.prototype,"hasMore"),r.prototype),S(r.prototype,"hasStartedLoading",[b.computed],Object.getOwnPropertyDescriptor(r.prototype,"hasStartedLoading"),r.prototype),S(r.prototype,"isLoadingInitially",[b.computed],Object.getOwnPropertyDescriptor(r.prototype,"isLoadingInitially"),r.prototype),S(r.prototype,"isLoadingMore",[b.computed],Object.getOwnPropertyDescriptor(r.prototype,"isLoadingMore"),r.prototype),S(r.prototype,"length",[b.computed],Object.getOwnPropertyDescriptor(r.prototype,"length"),r.prototype),c=S(r.prototype,"addEntity",[b.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.list.indexOf(t)<0&&(e.list=n?b.observable.array([t]).concat(e.list):e.list.concat(t))}}}),p=S(r.prototype,"removeEntity",[b.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.list=this.list?this.list.filter(t=>t!==e):void 0}}}),u=S(r.prototype,"removeAllEntities",[b.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.list=[]}}}),d=S(r.prototype,"clearNextLink",[b.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.nextLink=void 0}}}),m=S(r.prototype,"setLoading",[b.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.list?this.isCollectionLoading=e:(this.isCollectionLoading=!0,this.list=[])}}}),g=S(r.prototype,"setLoaded",[b.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{var{lastFetched:n,nextLink:r,resetList:o}=t;this.error=void 0,this.lastFetched=n,this.list=o?Object(f.uniq)(e):Object(f.union)(this.list,e),this.nextLink=r,this.isCollectionLoading=!1}}}),h=S(r.prototype,"setError",[b.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.error=e,this.isCollectionLoading=!1}}}),r)},7714:function(e,t,n){"use strict";n.r(t),n.d(t,"EntityFetchStatus",(function(){return h})),n.d(t,"EntityMap",(function(){return S}));var r,o,a,i,s,l,c,p,u,d,m,g,h,b=n(7701);function f(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function y(e,t,n,r,o){var a={};return Object.keys(r).forEach((function(e){a[e]=r[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}!function(e){e.fetching="fetching",e.creating="creating",e.updating="updating",e.deleting="deleting",e.success="success",e.error="error"}(h||(h={}));var S=(o=y((r=class{constructor(e){this.options=e,f(this,"entities",o,this),f(this,"entityStatus",a,this),this.getEntity=e=>this.entities.get(e),this.getEntityStatus=e=>this.entityStatus.get(e),this.has=e=>this.entities.has(e),this.isEntityErrored=e=>{var t=this.getEntityStatus(e);return!!t&&t.fetchStatus===h.error},this.isEntityLoading=e=>{var t=this.getEntityStatus(e);return!t||t.fetchStatus!==h.success&&t.fetchStatus!==h.error},this.isEntityDeleting=e=>{var t=this.getEntityStatus(e);return!!t&&t.fetchStatus===h.deleting},this.isEntityFetching=e=>{var t=this.getEntityStatus(e);return!!t&&t.fetchStatus===h.fetching},f(this,"addEntity",i,this),f(this,"clear",s,this),f(this,"removeEntity",l,this),f(this,"setEntityFetching",c,this),f(this,"setEntityCreating",p,this),f(this,"setEntityUpdating",u,this),f(this,"setEntityDeleting",d,this),f(this,"setEntitySuccess",m,this),f(this,"setEntityError",g,this)}}).prototype,"entities",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Map}}),a=y(r.prototype,"entityStatus",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Map}}),i=y(r.prototype,"addEntity",[b.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{var n=this.options.getKey(e);return(!this.entities.has(n)||t&&t(this.entities.get(n),e))&&this.entities.set(n,e),n}}}),s=y(r.prototype,"clear",[b.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.entities.clear(),this.entityStatus.clear()}}}),l=y(r.prototype,"removeEntity",[b.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.entities.delete(e),this.entityStatus.delete(e)}}}),c=y(r.prototype,"setEntityFetching",[b.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.entityStatus.set(e,{fetchStatus:h.fetching})}}}),p=y(r.prototype,"setEntityCreating",[b.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.entityStatus.set(e,{fetchStatus:h.creating})}}}),u=y(r.prototype,"setEntityUpdating",[b.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.entityStatus.set(e,{fetchStatus:h.updating})}}}),d=y(r.prototype,"setEntityDeleting",[b.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.entityStatus.set(e,{fetchStatus:h.deleting})}}}),m=y(r.prototype,"setEntitySuccess",[b.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.entityStatus.set(e,{fetchStatus:h.success,lastFetched:new Date})}}}),g=y(r.prototype,"setEntityError",[b.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.entityStatus.set(e,{fetchStatus:h.error,error:t})}}}),r)},7715:function(e,t,n){"use strict";n.r(t),n.d(t,"ConnectionEntity",(function(){return c}));var r,o=n(7701),a=n(2812),i=n(5803),s=n(5804);function l(e,t,n,r,o){var a={};return Object.keys(r).forEach((function(e){a[e]=r[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}var c=(l((r=class{constructor(e){this.id=void 0,this.name=void 0,this.properties=void 0,this.type=void 0,Object(o.extendObservable)(this,e)}toJS(){return Object(a.omit)(Object(o.toJS)(this),"toJS")}get displayName(){return i.getDisplayName(this)}get isUiFlowConnection(){return s.isUIFlowConnection(this)}}).prototype,"displayName",[o.computed],Object.getOwnPropertyDescriptor(r.prototype,"displayName"),r.prototype),l(r.prototype,"isUiFlowConnection",[o.computed],Object.getOwnPropertyDescriptor(r.prototype,"isUiFlowConnection"),r.prototype),r)},7716:function(e,t,n){"use strict";n.r(t),n.d(t,"GatewayEntity",(function(){return p}));var r,o=n(7701),a=n(2812),i=n(7534);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t,n,r,o){var a={};return Object.keys(r).forEach((function(e){a[e]=r[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}var p=(c((r=class{constructor(e){this.id=void 0,this.name=void 0,this.properties=void 0,this.type=void 0,Object(o.extendObservable)(this,e),this.properties.loadBalancingSettings||Object(o.runInAction)(()=>{this.properties.loadBalancingSettings||Object(o.set)(this.properties,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({loadBalancingSettings:null},this.properties))})}toJS(){return Object(a.omit)(Object(o.toJS)(this),"toJS")}get isCluster(){return this.properties&&this.properties.gateways&&this.properties.gateways.length>1}get clusterSize(){return this.isCluster?this.properties.gateways.length:-1}get gatewaysInCluster(){return this.isCluster?this.properties.gateways:void 0}get displayName(){return i.getDisplayName(this)}get description(){return i.getDescription(this)}get contactInformation(){return i.getContactInformation(this)}get versionStatus(){return i.getVersionStatus(this)}get expirationDate(){return i.getExpirationDate(this)}get isGatewayLoadBalanced(){return i.getLoadBalancingSettings(this)}setIsGatewayLoadBalanced(e){var t=e?'{"selector":1}':'{"selector":0}';this.properties.loadBalancingSettings=t}}).prototype,"isCluster",[o.computed],Object.getOwnPropertyDescriptor(r.prototype,"isCluster"),r.prototype),c(r.prototype,"clusterSize",[o.computed],Object.getOwnPropertyDescriptor(r.prototype,"clusterSize"),r.prototype),c(r.prototype,"gatewaysInCluster",[o.computed],Object.getOwnPropertyDescriptor(r.prototype,"gatewaysInCluster"),r.prototype),c(r.prototype,"displayName",[o.computed],Object.getOwnPropertyDescriptor(r.prototype,"displayName"),r.prototype),c(r.prototype,"description",[o.computed],Object.getOwnPropertyDescriptor(r.prototype,"description"),r.prototype),c(r.prototype,"contactInformation",[o.computed],Object.getOwnPropertyDescriptor(r.prototype,"contactInformation"),r.prototype),c(r.prototype,"versionStatus",[o.computed],Object.getOwnPropertyDescriptor(r.prototype,"versionStatus"),r.prototype),c(r.prototype,"expirationDate",[o.computed],Object.getOwnPropertyDescriptor(r.prototype,"expirationDate"),r.prototype),c(r.prototype,"isGatewayLoadBalanced",[o.computed],Object.getOwnPropertyDescriptor(r.prototype,"isGatewayLoadBalanced"),r.prototype),c(r.prototype,"setIsGatewayLoadBalanced",[o.action],Object.getOwnPropertyDescriptor(r.prototype,"setIsGatewayLoadBalanced"),r.prototype),r)},7717:function(e,t,n){"use strict";n.r(t),n.d(t,"GatewayStatusEntity",(function(){return l}));var r,o,a=n(7701),i=n(5638);function s(e,t,n,r,o){var a={};return Object.keys(r).forEach((function(e){a[e]=r[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}var l=(o=s((r=class{constructor(e){var t,n,r,i,{name:s,status:l}=e;this.name=void 0,t=this,n="status",i=this,(r=o)&&Object.defineProperty(t,n,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0}),this.name=s,Object(a.runInAction)(()=>{this.status=l})}get isOnline(){return Object(i.equalsIgnoreCase)(this.status,"live")}}).prototype,"status",[a.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s(r.prototype,"isOnline",[a.computed],Object.getOwnPropertyDescriptor(r.prototype,"isOnline"),r.prototype),r)},7718:function(e,t,n){"use strict";n.r(t),n.d(t,"FlowSessionStatusCode",(function(){return a})),n.d(t,"UiFlowRunEntity",(function(){return i}));var r=n(7701),o=n(2812),a={NotSpecified:0,Paused:1,Running:2,Waiting:3,Succeeded:4,Skipped:5,Suspended:6,Canceled:7,Failed:8,Faulted:9,TimedOut:10,Aborted:11,Ignored:12,Deleted:13,Terminated:14};class i{constructor(e){this.flowsessionid=void 0,this._regardingobjectid_value=void 0,this.startedon=void 0,this.completedon=void 0,this.statecode=void 0,this.statuscode=void 0,this.createdon=void 0,this.modifiedon=void 0,Object(r.extendObservable)(this,e)}toJS(){return Object(o.omit)(Object(r.toJS)(this),"toJS")}}},7719:function(e,t,n){"use strict";n.r(t),n.d(t,"FlowCategory",(function(){return r})),n.d(t,"UIFlowType",(function(){return o})),n.d(t,"WorkflowEntity",(function(){return s}));var r,o,a=n(7701),i=n(2812);!function(e){e[e.Workflow=0]="Workflow",e[e.Dialog=1]="Dialog",e[e.BusinessRule=2]="BusinessRule",e[e.Action=3]="Action",e[e.BusinessProcess=4]="BusinessProcess",e[e.Modern=5]="Modern",e[e.RPA=6]="RPA"}(r||(r={})),function(e){e[e.None=-1]="None",e[e.RpaWin32=0]="RpaWin32",e[e.RpaSelenium=1]="RpaSelenium"}(o||(o={}));class s{constructor(e){this._ownerid_value=void 0,this.category=void 0,this.componentstate=void 0,this.createdon=void 0,this.modifiedon=void 0,this.name=void 0,this.primaryentity=void 0,this.type=void 0,this.workflowid=void 0,Object(a.extendObservable)(this,e)}toJS(){return Object(i.omit)(Object(a.toJS)(this),"toJS")}}},7720:function(e,t,n){"use strict";n.r(t),n.d(t,"ConnectionsStore",(function(){return m})),n.d(t,"connectionsStore",(function(){return g}));var r,o,a=n(7701),i=n(7711);var s,l,c,p,u,d,m=(r=class{constructor(){var e,t,n,r;e=this,t="connections",r=this,(n=o)&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0}),Object(a.runInAction)(()=>{this.connections=new i.Entities({getKey:e=>e.name})})}static getGatewayCollectionKey(e,t){return"gateway-".concat(e,"/environment-").concat(t)}},s=r.prototype,l="connections",c=[a.observable],p={configurable:!0,enumerable:!0,writable:!0,initializer:null},d={},Object.keys(p).forEach((function(e){d[e]=p[e]})),d.enumerable=!!d.enumerable,d.configurable=!!d.configurable,("value"in d||d.initializer)&&(d.writable=!0),d=c.slice().reverse().reduce((function(e,t){return t(s,l,e)||e}),d),u&&void 0!==d.initializer&&(d.value=d.initializer?d.initializer.call(u):void 0,d.initializer=void 0),void 0===d.initializer&&(Object.defineProperty(s,l,d),d=null),o=d,r),g=new m},7721:function(e,t,n){"use strict";n.r(t),n.d(t,"SurfaceStore",(function(){return l})),n.d(t,"surfaceStore",(function(){return c}));var r,o,a=n(7701),i=n(7722);function s(e,t,n,r,o){var a={};return Object.keys(r).forEach((function(e){a[e]=r[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}var l=(o=s((r=class{constructor(){var e,t,n,r;e=this,t="surfaces",r=this,(n=o)&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0}),Object(a.runInAction)(()=>{this.surfaces=[]})}spawn(e){var t=this.getSurface(e.key);if(t)return t.setHidden(!1),t;var n=new i.Surface(e);return this.surfaces.push(n),n}dismissSurface(e){this.surfaces=this.surfaces.filter(t=>t.key!==e)}getSurface(e){return this.surfaces.find(t=>t.key===e)}get visibleSurfaces(){return this.surfaces.filter(e=>!e.isHidden)}get mostRecentlyMadeVisibleSurface(){if(this.visibleSurfaces)return this.visibleSurfaces.sort((e,t)=>e.visibilityChangeTime>t.visibilityChangeTime?-1:1)[0]}}).prototype,"surfaces",[a.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s(r.prototype,"spawn",[a.action],Object.getOwnPropertyDescriptor(r.prototype,"spawn"),r.prototype),s(r.prototype,"dismissSurface",[a.action],Object.getOwnPropertyDescriptor(r.prototype,"dismissSurface"),r.prototype),s(r.prototype,"visibleSurfaces",[a.computed],Object.getOwnPropertyDescriptor(r.prototype,"visibleSurfaces"),r.prototype),s(r.prototype,"mostRecentlyMadeVisibleSurface",[a.computed],Object.getOwnPropertyDescriptor(r.prototype,"mostRecentlyMadeVisibleSurface"),r.prototype),r),c=new l},7722:function(e,t,n){"use strict";n.r(t),n.d(t,"Surface",(function(){return l}));var r,o,a=n(7701),i=n(7723);function s(e,t,n,r,o){var a={};return Object.keys(r).forEach((function(e){a[e]=r[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}var l=(o=s((r=class{constructor(e){var t,n,r,a;t=this,n="isHidden",a=this,(r=o)&&Object.defineProperty(t,n,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(a):void 0}),this.hideOnDismiss=void 0,this.key=void 0,this.render=void 0,this.visibilityChangeTime=void 0;var{hideOnDismiss:s,key:l,render:c}=e;this.hideOnDismiss=!!s,this.key=l,this.render=c,this.visibilityChangeTime=Object(i.performanceNow)()}setHidden(e){this.isHidden=e,this.visibilityChangeTime=Object(i.performanceNow)()}}).prototype,"isHidden",[a.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s(r.prototype,"setHidden",[a.action],Object.getOwnPropertyDescriptor(r.prototype,"setHidden"),r.prototype),r)},7723:function(e,t,n){"use strict";function r(e,t){return Date.now()-t.getTime()>=e}function o(e,t){var n=new Date(e),r=((t?new Date(t):new Date).getTime()-n.getTime())/1e3,o=Math.floor(r%60).toString().padStart(2,"0"),a=Math.floor(r/60%60).toString().padStart(2,"0"),i=Math.floor(r/60/60%24).toString().padStart(2,"0"),s=Math.floor(r/60/60/24),l=s>0?"".concat(s,"d"):"";return"".concat(l," ").concat(i,":").concat(a,":").concat(o)}function a(e,t,n){return e.toLocaleTimeString(n||"en-us",t)}function i(){return"performance"in window&&performance&&performance.now?performance.now():(new Date).getMilliseconds()}n.r(t),n.d(t,"hasMsElapsedSince",(function(){return r})),n.d(t,"getFriendlyTimeDuration",(function(){return o})),n.d(t,"getFriendlyDateTime",(function(){return a})),n.d(t,"performanceNow",(function(){return i}))},7724:function(e,t,n){"use strict";n.r(t),n.d(t,"UIFlowRunsStore",(function(){return m})),n.d(t,"uiFlowRunsStore",(function(){return g}));var r,o,a=n(7701),i=n(7711);var s,l,c,p,u,d,m=(r=class{constructor(){var e,t,n,r;e=this,t="uiFlowRuns",r=this,(n=o)&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0}),Object(a.runInAction)(()=>{this.uiFlowRuns=new i.Entities({getKey:e=>e.flowsessionid})})}static getGatewayCollectionKey(e,t,n){return"gateway-".concat(e,"/environment-").concat(t,"/status-").concat(n)}},s=r.prototype,l="uiFlowRuns",c=[a.observable],p={configurable:!0,enumerable:!0,writable:!0,initializer:null},d={},Object.keys(p).forEach((function(e){d[e]=p[e]})),d.enumerable=!!d.enumerable,d.configurable=!!d.configurable,("value"in d||d.initializer)&&(d.writable=!0),d=c.slice().reverse().reduce((function(e,t){return t(s,l,e)||e}),d),u&&void 0!==d.initializer&&(d.value=d.initializer?d.initializer.call(u):void 0,d.initializer=void 0),void 0===d.initializer&&(Object.defineProperty(s,l,d),d=null),o=d,r),g=new m},7725:function(e,t,n){"use strict";n.r(t),n.d(t,"WorkflowStore",(function(){return m})),n.d(t,"workflowsStore",(function(){return g}));var r,o,a=n(7701),i=n(7711);var s,l,c,p,u,d,m=(r=class{constructor(){var e,t,n,r;e=this,t="workflows",r=this,(n=o)&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0}),Object(a.runInAction)(()=>{this.workflows=new i.Entities({getKey:e=>e.workflowid})})}},s=r.prototype,l="workflows",c=[a.observable],p={configurable:!0,enumerable:!0,writable:!0,initializer:null},d={},Object.keys(p).forEach((function(e){d[e]=p[e]})),d.enumerable=!!d.enumerable,d.configurable=!!d.configurable,("value"in d||d.initializer)&&(d.writable=!0),d=c.slice().reverse().reduce((function(e,t){return t(s,l,e)||e}),d),u&&void 0!==d.initializer&&(d.value=d.initializer?d.initializer.call(u):void 0,d.initializer=void 0),void 0===d.initializer&&(Object.defineProperty(s,l,d),d=null),o=d,r),g=new m},7726:function(e,t,n){"use strict";n.r(t);var r=n(7727);n.d(t,"GatewayHttpClient",(function(){return r.GatewayHttpClient}));var o=n(7751);n.d(t,"XrmHttpClient",(function(){return o.XrmHttpClient}));var a=n(7728);n.d(t,"HttpClient",(function(){return a.HttpClient})),n.d(t,"defaultErrorHandler",(function(){return a.defaultErrorHandler})),n.d(t,"setRequestHeader",(function(){return a.setRequestHeader})),n.d(t,"setRequestParam",(function(){return a.setRequestParam})),n.d(t,"isAxiosError",(function(){return a.isAxiosError})),n.d(t,"isAxiosAbortError",(function(){return a.isAxiosAbortError})),n.d(t,"isAxiosNetworkError",(function(){return a.isAxiosNetworkError}));var i=n(7752);n.d(t,"createBearerTokenRequestInterceptor",(function(){return i.createBearerTokenRequestInterceptor}));var s=n(7753);n.d(t,"createInvokeApiRequestInterceptor",(function(){return s.createInvokeApiRequestInterceptor}));var l=n(7731);n.d(t,"escapeODataString",(function(){return l.escapeODataString})),n.d(t,"getEnvironmentFilterString",(function(){return l.getEnvironmentFilterString})),n.d(t,"getGatewayFilterString",(function(){return l.getGatewayFilterString})),n.d(t,"getRunStatusFilterString",(function(){return l.getRunStatusFilterString})),n.d(t,"getApiIdFilterString",(function(){return l.getApiIdFilterString})),n.d(t,"getExpandObjectIdPermissionsString",(function(){return l.getExpandObjectIdPermissionsString})),n.d(t,"getApiVersionString",(function(){return l.getApiVersionString})),n.d(t,"getApiIdNotInFilterString",(function(){return l.getApiIdNotInFilterString})),n.d(t,"getCdsRecordIdFromODataEntityId",(function(){return l.getCdsRecordIdFromODataEntityId})),n.d(t,"knownExcludedApisConnections",(function(){return l.knownExcludedApisConnections}))},7727:function(e,t,n){"use strict";n.r(t),n.d(t,"GatewayHttpClient",(function(){return p}));var r=n(7728),o=n(7726),a=n(215),i=n(2872),s=n(5597),l=n(7731),c=n(7732);class p{constructor(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new r.HttpClient;this.httpClient=e,this.getGateways=e=>{var{environmentName:t,objectId:n}=e;return this.httpClient.get({url:"".concat(this.getGatewaysUrl({environmentName:t,objectId:n}))})},this.getGatewayConnections=e=>{var{environmentName:t,objectId:n,gatewayName:r}=e;return this.httpClient.get({url:"".concat(this.getGatewayConnectionsUrl({environmentName:t,objectId:n,gatewayName:r}))})},this.getMoreGatewayConnections=e=>this.httpClient.get({url:e}),this.getGatewayStatus=e=>{var{environmentName:t,objectId:n,gatewayName:r}=e;return this.httpClient.get({url:"".concat(this.getGatewayStatusUrl({environmentName:t,objectId:n,gatewayName:r}))})},this.toggleIsLoadBalanced=(e,t,n,r)=>{var o=r?'{"selector":1}':'{"selector":0}';return this.httpClient.patch({url:"".concat(this.getGatewayClusterUrl({gatewayName:e,environmentName:t,objectId:n})),data:{loadBalancingSettings:o},headers:{"Content-Type":"application/json"}})},this.deleteGateway=(e,t,n)=>this.httpClient.delete({url:"".concat(this.getGatewayUrl({gatewayName:e,environmentName:t,objectId:n}))}),this.getGatewayUrl=e=>{var{gatewayName:t,environmentName:n,objectId:r}=e;return encodeURI("https://".concat(i.settings.powerAppsEndpointUrl).concat(Object(s.gatewayUrl)(t),"?").concat(Object(l.getExpandObjectIdPermissionsString)(r),"&$filter=").concat(Object(l.getEnvironmentFilterString)(n),"&").concat(Object(l.getApiVersionString)(i.settings.powerAppsApiVersion)))},this.getGatewayClusterUrl=e=>{var{gatewayName:t,environmentName:n,objectId:r}=e;return encodeURI("https://".concat(i.settings.powerAppsEndpointUrl).concat(Object(s.gatewayClusterPatchUrl)(t),"?").concat(Object(l.getExpandObjectIdPermissionsString)(r),"&$filter=").concat(Object(l.getEnvironmentFilterString)(n),"&").concat(Object(l.getApiVersionString)(i.settings.powerAppsApiVersion)))},this.getGatewaysUrl=e=>{var{environmentName:t,objectId:n}=e;return encodeURI("https://".concat(i.settings.powerAppsEndpointUrl).concat(s.gatewaysClusterQueryUrl,"?").concat(Object(l.getExpandObjectIdPermissionsString)(n),"&$filter=").concat(Object(l.getEnvironmentFilterString)(t),"&").concat(Object(l.getApiVersionString)(i.settings.powerAppsApiVersion)))},this.getGatewayConnectionsUrl=e=>{var{environmentName:t,objectId:n,gatewayName:r}=e;return encodeURI("https://".concat(i.settings.powerAppsEndpointUrl).concat(s.connectionsQueryUrl,"?").concat(Object(l.getExpandObjectIdPermissionsString)(n),"&$filter=").concat(Object(l.getEnvironmentFilterString)(t)," and ").concat(Object(l.getGatewayFilterString)(r)," and ").concat(Object(l.getApiIdNotInFilterString)(l.knownExcludedApisConnections),"&").concat(Object(l.getApiVersionString)(i.settings.powerAppsApiVersion)))},this.getGatewayStatusUrl=e=>{var{environmentName:t,objectId:n,gatewayName:r}=e;return encodeURI("https://".concat(i.settings.powerAppsEndpointUrl).concat(Object(s.gatewayClusterStatusUrl)(r),"?").concat(Object(l.getExpandObjectIdPermissionsString)(n),"&$filter=").concat(Object(l.getEnvironmentFilterString)(t),"&").concat(Object(l.getApiVersionString)(i.settings.powerAppsApiVersion)))};var t=[Object(c.createLoggingRequestInterceptor)(),Object(o.createBearerTokenRequestInterceptor)(()=>Object(a.acquireTokenSilentAsync)(i.settings.powerAppsResource).then(e=>e.accessToken))];for(var n of t)this.httpClient.addRequestInterceptor(n);this.httpClient.addResponseInterceptor(Object(c.createLoggingResponseInterceptor)(),Object(c.createLoggingErrorResponseInterceptor)())}}},7728:function(e,t,n){"use strict";n.r(t),n.d(t,"HttpClient",(function(){return b})),n.d(t,"defaultErrorHandler",(function(){return f})),n.d(t,"setRequestHeader",(function(){return y})),n.d(t,"setRequestParam",(function(){return S})),n.d(t,"isAxiosError",(function(){return C})),n.d(t,"isAxiosAbortError",(function(){return v})),n.d(t,"isAxiosNetworkError",(function(){return w}));var r=n(498),o=n.n(r),a=n(7729),i=["data"],s=["baseURL","cancelToken","data","headers","maxRedirects","method","params","responseType","timeout","url","validateStatus"],l=["baseUrl","cancelToken","headers","maxRedirects","method","params","responseType","timeout","url","validateStatus"],c=["data","headers","status","statusText","url","ok"],p=["config","data","headers","status","statusText"];function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){m(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function g(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function h(e){return e>=200&&e<=299}class b{constructor(e){this.axiosInstance=void 0,this.options=void 0,this.addRequestInterceptor=(e,t)=>this.axiosInstance.interceptors.request.use(t=>e(this.fromAxiosRequest(t)).then(e=>this.toAxiosRequest(e,!1)),t||f),this.addResponseInterceptor=(e,t)=>this.axiosInstance.interceptors.response.use(t=>e(this.fromAxiosResponse(t)).then(this.toAxiosResponse),t||f),this.options=e||{},this.axiosInstance=this.options.axiosInstance||o.a.create()}delete(e){return this.makeAxiosRequest(this.axiosInstance.delete,e)}get(e){return this.makeAxiosRequest(this.axiosInstance.get,e)}head(e){return this.makeAxiosRequest(this.axiosInstance.head,e)}patch(e){return this.makeAxiosRequest(this.axiosInstance.patch,e)}post(e){return this.makeAxiosRequest(this.axiosInstance.post,e)}put(e){return this.makeAxiosRequest(this.axiosInstance.put,e)}request(e){return this.axiosInstance.request(this.toAxiosRequest(e,!0)).then(this.fromAxiosResponse)}removeRequestInterceptor(e){this.axiosInstance.interceptors.request.eject(e)}removeResponseInterceptor(e){this.axiosInstance.interceptors.response.eject(e)}makeAxiosRequest(e,t){switch(e){case this.axiosInstance.patch:case this.axiosInstance.put:case this.axiosInstance.post:var{data:n}=t,r=g(t,i),o=this.toAxiosRequest(r,!0);return e(o.url,n,o).then(this.fromAxiosResponse);default:return e(this.toAxiosRequest(t,!0).url,this.toAxiosRequest(t,!0)).then(this.fromAxiosResponse)}}fromAxiosRequest(e){var{baseURL:t,cancelToken:n,data:r,headers:o,maxRedirects:a,method:i,params:l,responseType:c,timeout:p,url:u,validateStatus:m}=e;return d({baseUrl:t,cancelToken:n,data:r,headers:o,maxRedirects:a,method:i,params:l,responseType:c,timeout:p,url:u,validateStatus:m||h},g(e,s))}toAxiosRequest(e,t){var{baseUrl:n,cancelToken:r,headers:o,maxRedirects:i,method:s,params:c,responseType:p,timeout:u,url:m,validateStatus:h}=e,b=g(e,l),f=t?this.options:{},y=m;return Object.keys(c||{}).forEach(e=>{y=Object(a.removeQueryParameterFromUrl)({url:y,queryParameterName:e})}),d({baseURL:n||f.baseUrl,cancelToken:r,headers:o,maxRedirects:i,method:s,params:c,responseType:p,timeout:u||f.timeout,url:y,validateStatus:h},b)}toAxiosResponse(e){var{data:t,headers:n,status:r,statusText:o,url:a,ok:i}=e;return d({data:t,headers:n,config:{url:a},status:r,statusText:o},g(e,c))}fromAxiosResponse(e){var{config:t,data:n,headers:r,status:o,statusText:a}=e,i=g(e,p);return d({config:t,data:n,headers:r,url:t.url,ok:o>=200&&o<300,status:o,statusText:a},i)}}function f(e){return Promise.reject(e)}function y(e,t,n){var r=d({},e.headers);return r[t.toLowerCase()]=n,d(d({},e),{},{headers:r})}function S(e,t,n){var r=d({},e.params);return r[t.toLowerCase()]=n,d(d({},e),{},{params:r})}function C(e){return e&&e.config&&e.config.method&&e.config.adapter}function v(e){return!(!e||"ECONNABORTED"!==e.code)}function w(e){return!(!e||"Network Error"!==e.message)}},7729:function(e,t,n){"use strict";n.r(t),n.d(t,"removeQueryParameterFromUrl",(function(){return o}));var r=n(7730);function o(e){var{url:t,queryParameterName:n}=e;if(t){for(var o=!0,a=t;o;){var i=a.indexOf("&".concat(n,"="));if(-1===i){var s=a.indexOf("?".concat(n,"="));if(-1===s)o=!1;else{var l=a.indexOf("&",s+1);if(-1===l){a=Object(r.cut)({str:a,cutStart:s}),o=!0;continue}a=(a=Object(r.cut)({str:a,cutStart:s,cutEnd:l})).replace("&","?"),o=!0}}else{var c=a.indexOf("&",i+1);a=Object(r.cut)({str:a,cutStart:i,cutEnd:c}),o=!0}}return a}}},7730:function(e,t,n){"use strict";n.r(t),n.d(t,"cut",(function(){return o}));var r=n(2812);function o(e){var{str:t,cutStart:n,cutEnd:o}=e;if(!Object(r.isNil)(t))return!o||o<=n?t.substring(0,n):t.substring(0,n)+t.substring(o)}},7731:function(e,t,n){"use strict";function r(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/'/g,"''")}function o(e){return"environment eq '".concat(e,"'")}function a(e){return"gateway eq '".concat(e,"'")}function i(e){return e?" and statuscode eq ".concat(e):""}function s(e){var t=(e||[]).map(e=>"'".concat(e,"'")).join(",");return"ApiId in (".concat(t,")")}function l(e){return"$expand=permissions($filter=maxAssignedTo('".concat(e,"'))")}function c(e){return"api-version=".concat(e)}function p(e){var t=(e||[]).map(e=>"'".concat(e,"'")).join(",");return"ApiId not in (".concat(t,")")}function u(e){return e.split("(").pop().split(")")[0]}n.r(t),n.d(t,"escapeODataString",(function(){return r})),n.d(t,"getEnvironmentFilterString",(function(){return o})),n.d(t,"getGatewayFilterString",(function(){return a})),n.d(t,"getRunStatusFilterString",(function(){return i})),n.d(t,"getApiIdFilterString",(function(){return s})),n.d(t,"getExpandObjectIdPermissionsString",(function(){return l})),n.d(t,"getApiVersionString",(function(){return c})),n.d(t,"getApiIdNotInFilterString",(function(){return p})),n.d(t,"getCdsRecordIdFromODataEntityId",(function(){return u})),n.d(t,"knownExcludedApisConnections",(function(){return d}));var d=["shared_logicflows","shared_powerflows"]},7732:function(e,t,n){"use strict";n.r(t),n.d(t,"createLoggingRequestInterceptor",(function(){return h})),n.d(t,"createLoggingResponseInterceptor",(function(){return b})),n.d(t,"createLoggingErrorResponseInterceptor",(function(){return f})),n.d(t,"extractResponseData",(function(){return y}));var r=n(7728),o=n(503),a=n.n(o),i=n(217),s=n(7708),l=n(222),c=n(7733),p=n.n(c),u="x-ms-client-request-id",d="x-ms-client-session-id",m="x-ms-request-id",g="content-length";function h(){return e=>new Promise(t=>{var n={clientRequestId:Object(l.v4)(),sessionId:Object(i.getSessionId)(),url:a()(e.url,e.params)},o=Object(r.setRequestHeader)(e,u,n.clientRequestId);(o=Object(r.setRequestHeader)(o,d,n.sessionId))._flLogData=n;var s=p()(o.headers||{});S(s);var c=n.url?Object(i.getOperationName)(n.url):n.url;Object(i.trackStartOutgoingRequest)((e.method||"").toUpperCase(),n.url||"",c,n.clientRequestId,s,{locale:s["accept-language"]||""}),t(o)})}function b(){return e=>new Promise(t=>{var n=e.config,{_flLogData:{clientRequestId:r,url:o}}=n,a=p()(e.headers);S(a);var s=o?Object(i.getOperationName)(o):o.hostname;Object(i.trackEndOutgoingRequest)((n.method||"").toUpperCase(),o||"",s,e.status,r,a,{response:y(e),data:e.data},n.team),t(e)})}function f(){return e=>{if(Object(r.isAxiosError)(e)){var{response:t}=e;if(t){var n=t.config,{_flLogData:{clientRequestId:o,url:a}}=n,l=p()(n.headers),c=p()(t.headers);S(l),S(c);var u=a?Object(i.getOperationName)(a):a.hostname;Object(i.trackStartOutgoingRequest)((n.method||"").toUpperCase(),a||"",u,o,l,{locale:l["accept-language"]||""}),Object(i.trackEndOutgoingRequest)(n.method||"",a||"",u,t.status,o,c,{response:y(t),data:t.data})}else{if(Object(r.isAxiosAbortError)(e)||Object(r.isAxiosNetworkError)(e))return Promise.reject(e);Object(i.trackErrorTrace)(s.gatewayDetailsEventScope,{eventName:"gatewayDetails/createLoggingErrorResponseInterceptor"},e)}}return Promise.reject(e)}}function y(e){if(!e)return{status:-1};var t={status:e.status},n=e.headers||{};return n.hasOwnProperty(g)&&(t.contentLength=parseInt(n[g],10)),n.hasOwnProperty(m)&&(t.serviceRequestId=n[m]),t}function S(e){e&&e.authorization&&(e.authorization=""),e&&e.Authorization&&(e.Authorization="")}},7751:function(e,t,n){"use strict";n.r(t),n.d(t,"XrmHttpClient",(function(){return s}));var r=n(7728),o=n(7726),a=n(215),i=n(7707);class s{constructor(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new r.HttpClient;this.httpClient=e,this.getXrmEntityAttributes=e=>{var{xrmEntityName:t,attributeNames:n}=e;return this.httpClient.get({url:encodeURI("".concat(Object(i.getCurrentXrmUrl)(),"api/data/v9.0/EntityDefinitions(LogicalName='").concat(t,"')/Attributes").concat(this.getAttributesFilterString(n)))})},this.getWorkflow=e=>{var{workflowEntityId:t}=e;return this.httpClient.get({url:"".concat(Object(i.getCurrentXrmUrl)(),"api/data/v9.0//workflows(").concat(t,")")})},this.getRuns=e=>{var{filterParams:t}=e;return this.httpClient.get({url:"".concat(Object(i.getCurrentXrmUrl)(),"api/data/v9.0/flowsessions?").concat(t),headers:{"odata-maxversion":"4.0","odata-version":"4.0",Prefer:"odata.maxpagesize=50"}})},this.getMoreRuns=e=>this.httpClient.get({url:e,headers:{"odata-maxversion":"4.0","odata-version":"4.0",Prefer:"odata.maxpagesize=50"}});var t=[Object(o.createBearerTokenRequestInterceptor)(()=>Object(a.acquireTokenSilentAsync)(Object(i.getCurrentXrmUrl)()).then(e=>e.accessToken))];for(var n of t)this.httpClient.addRequestInterceptor(n)}getAttributesFilterString(e){if(0==(e||[]).length)return"";for(var t="",n=0;n<e.length;n++)t+=this.getLogicalNameFilterString(e[n]),n<e.length-1&&(t+=" or ");return"?$filter=".concat(t)}getLogicalNameFilterString(e){return"LogicalName eq '".concat(e,"'")}}},7752:function(e,t,n){"use strict";n.r(t),n.d(t,"createBearerTokenRequestInterceptor",(function(){return o}));var r=n(7728);function o(e){return t=>e(t).then(e=>Object(r.setRequestHeader)(t,"authorization","Bearer ".concat(e))).catch(()=>Promise.resolve(t))}},7753:function(e,t,n){"use strict";n.r(t),n.d(t,"createInvokeApiRequestInterceptor",(function(){return o}));var r=n(7728);function o(e){return t=>{var{url:n}=t;return n=n.replace(e,""),t.url="".concat(e,"/api/invoke"),Promise.resolve(Object(r.setRequestHeader)(t,"x-ms-path-query",n))}}},7754:function(e,t,n){"use strict";n.r(t),n.d(t,"parseRunFilterFromQuery",(function(){return a})),n.d(t,"getStatusCode",(function(){return i}));var r=n(7755),o=n(2816);function a(e){switch(Object(o.parseQueryString)(e).filter){case r.RunFilterStatus.cancelled:return r.RunFilterStatus.cancelled;case r.RunFilterStatus.failed:return r.RunFilterStatus.failed;case r.RunFilterStatus.running:return r.RunFilterStatus.running;case r.RunFilterStatus.skipped:return r.RunFilterStatus.skipped;case r.RunFilterStatus.succeeded:return r.RunFilterStatus.succeeded;default:return null}}function i(e){switch(e){case r.RunFilterStatus.cancelled:return r.RunStatusCode.cancelled;case r.RunFilterStatus.failed:return r.RunStatusCode.failed;case r.RunFilterStatus.running:return r.RunStatusCode.running;case r.RunFilterStatus.skipped:return r.RunStatusCode.skipped;case r.RunFilterStatus.succeeded:return r.RunStatusCode.succeeded;default:return null}}},7755:function(e,t,n){"use strict";n.r(t);var r=n(7704);n.d(t,"RunFilterStatus",(function(){return r.RunFilterStatus})),n.d(t,"RunStatusCode",(function(){return r.RunStatusCode})),n.d(t,"gatewayService",(function(){return r.gatewayService}));var o=n(7756);n.d(t,"xrmEntityHasAttributesKey",(function(){return o.xrmEntityHasAttributesKey})),n.d(t,"xrmService",(function(){return o.xrmService}));var a=n(7758);n.d(t,"workflowService",(function(){return a.workflowService}))},7756:function(e,t,n){"use strict";n.r(t),n.d(t,"xrmEntityHasAttributesKey",(function(){return i})),n.d(t,"xrmService",(function(){return s}));var r=n(7757),o=n(7707),a=n(7751);function i(e,t,n){var r="".concat(e,"-").concat(t).toLowerCase(),o=n.map(e=>e.toLowerCase()).sort().join("_");return r+="-".concat(o)}var s=new class{constructor(){var e=this;this.runFirstPending=Object(r.runFirstPendingFactory)(),this.xrmHttpClient=new a.XrmHttpClient,this.entityHasAttributesCache=new Map,this.xrmEntityHasAttributes=function(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=Object(o.getCurrentXrmUrl)(),s=i(a,t,n),l=e.entityHasAttributesCache.has(s);return r||!l?e.runFirstPending({key:"xrmEntityHasAttributes-".concat(s),action:()=>e.xrmHttpClient.getXrmEntityAttributes({xrmEntityName:t,attributeNames:n}).then(t=>{var r=(t.data.value?t.data.value.length:0)===n.length;return e.entityHasAttributesCache.set(s,r),r})}):Promise.resolve(e.entityHasAttributesCache.get(s))}}}},7757:function(e,t,n){"use strict";function r(){var e=new Map;return t=>{var{key:n,action:r}=t;if(!e.has(n)){var o=r();o.then(()=>{e.delete(n)}).catch(t=>{throw e.delete(n),t}),e.set(n,o)}return e.get(n)}}n.r(t),n.d(t,"runFirstPendingFactory",(function(){return r}))},7758:function(e,t,n){"use strict";n.r(t),n.d(t,"workflowService",(function(){return l}));var r=n(7757),o=n(7751),a=n(7725),i=n(7759),s=n(7711);var l=new class{constructor(){var e=this;this.runFirstPending=Object(r.runFirstPendingFactory)(),this.xrmHttpClient=new o.XrmHttpClient,this.loadWorkflow=function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=a.workflowsStore.workflows.entities,o=r.entityStatus.get(t),l=o?o.lastFetched:null;if(n||Object(i.shouldFetch)(l)){var c="loadWorkflow-".concat(t);return e.runFirstPending({key:c,action:()=>(r.setEntityFetching(t),e.xrmHttpClient.getWorkflow({workflowEntityId:t}).then(e=>{r.addEntity(new s.WorkflowEntity(e.data),i.alwaysReplace),r.setEntitySuccess(t)}).catch(e=>{throw r.setEntityError(t,e),e}))})}return Promise.resolve()}}}},7759:function(e,t,n){"use strict";n.r(t),n.d(t,"isDisplayNameMatch",(function(){return a})),n.d(t,"shouldFetch",(function(){return i})),n.d(t,"alwaysReplace",(function(){return s}));var r=n(7723),o=n(7760);function a(e,t){return!(!t||!e)&&(!!e&&e.toUpperCase().indexOf(t.trim().toUpperCase())>=0)}function i(e){return!e||Object(r.hasMsElapsedSince)(o.cacheExpirationInMilliseconds,e)}var s=(e,t)=>!0},7760:function(e,t,n){"use strict";n.r(t),n.d(t,"cacheExpirationInMilliseconds",(function(){return r}));var r=3e5},7761:function(e,t,n){"use strict";n.r(t),n.d(t,"DeleteGatewaySurface",(function(){return b})),n.d(t,"spawnDeleteGatewaySurface",(function(){return f}));var r,o,a=n(245),i=n(7701),s=n(7699),l=n(545),c=n(7762),p=n(7705),u=n(7704),d=n(217),m=n(7708);function g(){return(g=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function h(e,t,n,r,o){var a={};return Object.keys(r).forEach((function(e){a[e]=r[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}var b=Object(s.observer)((h((o=class extends a.Component{constructor(){super(...arguments),this.onDeleteCancel=()=>{Object(d.trackUserActionClickButton)(m.gatewayDetailsEventScope,"deleteGatewaySurface/deleteCancel",{gatewayId:this.props.gatewayName});var{dismiss:e}=this.props;e()},this.onDeleteConfirm=()=>{var{dismiss:e,gatewayName:t,onError:n}=this.props;Object(d.trackUserActionClickButton)(m.gatewayDetailsEventScope,"deleteGatewaySurface/deleteConfirm",{gatewayId:t}),u.gatewayService.deleteGateway(t).then(()=>{e(),p.gatewaysStore.removeGateway(t),this.props.onDeleteSuccess()}).catch(e=>{n(e)})}}render(){var{dismiss:e,resourceStrings:t}=this.props;return a.createElement(c.Dialog,{hidden:!1,maxWidth:400,primaryButtonProps:this.primaryButtonProps,secondaryButtonProps:this.secondaryButtonProps,subText:t.bodyText,title:t.titleText,onDismiss:e})}get gateway(){var{gatewayName:e}=this.props;return p.gatewaysStore.gateways.getEntity(e)}get primaryButtonProps(){return{disabled:this.isDeleting,primary:!0,text:this.props.resourceStrings.confirmButtonText,onClick:this.onDeleteConfirm}}get secondaryButtonProps(){return{disabled:this.isDeleting,text:this.props.resourceStrings.cancelButtonText,onClick:this.onDeleteCancel}}get isDeleting(){return p.gatewaysStore.isGatewayDeleting(this.props.gatewayName)}}).prototype,"gateway",[i.computed],Object.getOwnPropertyDescriptor(o.prototype,"gateway"),o.prototype),h(o.prototype,"primaryButtonProps",[i.computed],Object.getOwnPropertyDescriptor(o.prototype,"primaryButtonProps"),o.prototype),h(o.prototype,"secondaryButtonProps",[i.computed],Object.getOwnPropertyDescriptor(o.prototype,"secondaryButtonProps"),o.prototype),h(o.prototype,"isDeleting",[i.computed],Object.getOwnPropertyDescriptor(o.prototype,"isDeleting"),o.prototype),r=o))||r;function f(e,t,n,r,o){e.spawn({key:Object(l.getId)("delete-Gateway-surface"),render:e=>a.createElement(b,g({gatewayName:t,resourceStrings:n,onError:r,onDeleteSuccess:o},e))})}},7762:function(e,t,n){"use strict";n.r(t),n.d(t,"ContentDisplayMode",(function(){return r})),n.d(t,"DialogType",(function(){return o})),n.d(t,"Dialog",(function(){return h}));var r,o,a=n(245),i=n(7763),s=n(7766),l=n(890),c=n(7764),p=n(6441),u=n(2812),d=n(2903);function m(){return(m=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}!function(e){e[e.visible=0]="visible",e[e.none=1]="none",e[e.hidden=2]="hidden"}(r||(r={})),function(e){e[e.normal=0]="normal",e[e.largeHeader=1]="largeHeader",e[e.close=2]="close"}(o||(o={}));var g={[o.normal]:l.DialogType.normal,[o.largeHeader]:l.DialogType.largeHeader,[o.close]:l.DialogType.close};class h extends a.Component{render(){var{onDismiss:e,hidden:t,className:n,dialogType:r,maxWidth:o}=this.props,i={type:Object(u.isNil)(r)?l.DialogType.close:g[r],title:this.props.title,subText:this.props.subText},s={className:Object(d.css)("fl-Dialog",n),isBlocking:!0,isOpen:!t,onDismiss:e,isDarkOverlay:!0};return a.createElement(l.Dialog,{hidden:t,dialogContentProps:i,modalProps:s,onDismiss:e,maxWidth:o},this.renderSpinner(),this.renderContent())}renderSpinner(){return this.props.isLoading?a.createElement(p.Spinner,{size:p.SpinnerSize.large,text:"Loading"}):null}renderContent(){var e=this.props.contentDisplay||r.visible;return e===r.none?null:a.createElement("div",{style:{display:e===r.hidden?"none":""}},this.props.children,this.renderFooter())}renderFooter(){var{buttonGroupProps:e,primaryButtonProps:t,secondaryButtonProps:n,checkboxProps:r}=this.props;return e||t||n||r?a.createElement(l.DialogFooter,null,r&&a.createElement(s.Checkbox,r),e&&a.createElement(i.ButtonGroup,e),t&&a.createElement(c.DefaultButton,m({primary:!0},t)),n&&a.createElement(c.DefaultButton,n)):null}}},7763:function(e,t,n){"use strict";n.r(t),n.d(t,"ButtonGroup",(function(){return a}));var r=n(245),o=n(7764);class a extends r.Component{render(){var{primaryButtonText:e,primaryButtonAriaLabel:t,primaryButtonDisabled:n,onPrimaryButtonClick:a,style:i}=this.props;return r.createElement("div",{className:"fl-ButtonGroup",style:i},r.createElement(o.DefaultButton,{primary:!0,text:e,ariaLabel:t||e,onClick:a,disabled:n}),this._renderSecondaryButton())}_renderSecondaryButton(){var{secondaryButtonText:e,secondaryButtonAriaLabel:t,secondaryButtonDisabled:n,onSecondaryButtonClick:a}=this.props;return e&&a?r.createElement(o.DefaultButton,{text:e,ariaLabel:t||e,onClick:a,disabled:n}):null}}},7764:function(e,t,n){"use strict";n.r(t),n.d(t,"DefaultButton",(function(){return c}));var r=n(245),o=n(684),a=n(7765),i=["ariaLabel","className","iconName","menuProps","tooltipProps","dataTest"];function s(){return(s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function l(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}class c extends r.PureComponent{render(){var e=this.props,{ariaLabel:t,className:n,iconName:c,menuProps:p,tooltipProps:u,dataTest:d}=e,m=l(e,i),g=r.createElement(o.DefaultButton,s({ariaLabel:t||this.props.text,"aria-describedby":u&&u.id,className:"fl-DefaultButton"+(n?" ".concat(n):""),iconProps:c&&{iconName:c},menuProps:p,"data-test":d},m));return u?r.createElement(a.TextTooltip,s({styles:{root:{display:"inline-block"}}},u),g):g}}},7765:function(e,t,n){"use strict";n.r(t),n.d(t,"Delay",(function(){return r})),n.d(t,"DelayMappings",(function(){return u})),n.d(t,"DirectionalHint",(function(){return p})),n.d(t,"DirectionalHintMappings",(function(){return d})),n.d(t,"TextTooltip",(function(){return m}));var r,o=n(245),a=n(1240),i=n(790);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(e){e[e.zero=0]="zero",e[e.medium=1]="medium",e[e.long=2]="long"}(r||(r={}));var p,u={[r.zero]:a.TooltipDelay.zero,[r.medium]:a.TooltipDelay.medium,[r.long]:a.TooltipDelay.long};!function(e){e[e.bottomAutoEdge=0]="bottomAutoEdge",e[e.bottomCenter=1]="bottomCenter",e[e.bottomLeftEdge=2]="bottomLeftEdge",e[e.bottomRightEdge=3]="bottomRightEdge",e[e.leftBottomEdge=4]="leftBottomEdge",e[e.leftCenter=5]="leftCenter",e[e.leftTopEdge=6]="leftTopEdge",e[e.rightBottomEdge=7]="rightBottomEdge",e[e.rightCenter=8]="rightCenter",e[e.rightTopEdge=9]="rightTopEdge",e[e.topAutoEdge=10]="topAutoEdge",e[e.topCenter=11]="topCenter",e[e.topLeftEdge=12]="topLeftEdge",e[e.topRightEdge=13]="topRightEdge"}(p||(p={}));var d={[p.bottomAutoEdge]:i.DirectionalHint.bottomAutoEdge,[p.bottomCenter]:i.DirectionalHint.bottomCenter,[p.bottomLeftEdge]:i.DirectionalHint.bottomLeftEdge,[p.bottomRightEdge]:i.DirectionalHint.bottomRightEdge,[p.leftBottomEdge]:i.DirectionalHint.leftBottomEdge,[p.leftCenter]:i.DirectionalHint.leftCenter,[p.leftTopEdge]:i.DirectionalHint.leftTopEdge,[p.rightBottomEdge]:i.DirectionalHint.rightBottomEdge,[p.rightCenter]:i.DirectionalHint.rightCenter,[p.rightTopEdge]:i.DirectionalHint.rightTopEdge,[p.topAutoEdge]:i.DirectionalHint.topAutoEdge,[p.topCenter]:i.DirectionalHint.topCenter,[p.topLeftEdge]:i.DirectionalHint.topLeftEdge,[p.topRightEdge]:i.DirectionalHint.topRightEdge};class m extends o.PureComponent{render(){var{delay:e,directionalHint:t,id:n,styles:r,text:i,targetElement:s}=this.props,c=s?{targetElement:s}:{};return o.createElement(a.TooltipHost,{styles:r,content:i,id:n,delay:u[e],directionalHint:d[t],tooltipProps:l({},c)},this.props.children)}}},7766:function(e,t,n){"use strict";n.r(t),n.d(t,"Checkbox",(function(){return a}));var r=n(245),o=n(1362);class a extends r.Component{render(){return r.createElement(o.Checkbox,{checked:!!this.props.checked,label:this.props.label,onChange:this.props.onChange})}}},7767:function(e,t,n){"use strict";n.r(t),n.d(t,"ConnectionsListSurface",(function(){return b})),n.d(t,"spawnConnectionsListSurface",(function(){return f}));var r,o=n(245),a=n(7699),i=n(1573),s=n(303),l=n(4013),c=n(545),p=n(7768),u=n(7778),d=n(5623),m=n(217),g=n(7708);function h(){return(h=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var b=Object(a.observer)(r=class extends o.Component{constructor(){super(...arguments),this.renderBody=()=>{var{resourceStrings:e}=this.props;return o.createElement(o.Fragment,null,o.createElement("span",null,e.bodyText," ",o.createElement(s.Link,{to:Object(d.getConnectionsListUri)(Object(u.getCurrentEnvironmentName)()),onClick:this.onAllConnectionsClick},e.connectionsLinkText)),o.createElement(p.ConnectionDetailsList,{connectionCollection:this.props.connectionCollection,loadConnectionsCallback:this.props.loadConnectionsCallback,resourceStrings:this.props.resourceStrings.connectionDetailsListResourceStrings}))},this.onAllConnectionsClick=()=>{Object(m.trackUserActionClickLink)(g.gatewayDetailsEventScope,"connectionsListSurface/allConnections",{connectionCollection:this.props.connectionCollection})},this.onPanelDismiss=()=>{Object(m.trackUserActionClickButton)(g.gatewayDetailsEventScope,"connectionsListSurface/dismiss",{connectionCollection:this.props.connectionCollection}),this.props.dismiss()}}render(){var{resourceStrings:{closeButtonAriaLabel:e,title:t}}=this.props;return o.createElement(l.Panel,{closeButtonAriaLabel:e,headerText:t,isOpen:!0,onRenderBody:this.renderBody,onDismiss:this.onPanelDismiss,type:i.PanelType.medium})}})||r;function f(e,t,n,r){e.spawn({key:Object(c.getId)("connections-list-surface"),render:e=>o.createElement(b,h({connectionCollection:t,loadConnectionsCallback:n,resourceStrings:r},e))})}},7768:function(e,t,n){"use strict";n.r(t),n.d(t,"ConnectionsColumnWidth",(function(){return a})),n.d(t,"ConnectionColumns",(function(){return i})),n.d(t,"ConnectionDetailsList",(function(){return v}));var r,o,a,i,s=n(245),l=n(7701),c=n(7699),p=n(3064),u=n(2903),d=n(1471),m=n(7769),g=n(7705),h=n(7770),b=n(7775),f=n(7777),y=n(7776);function S(){return(S=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function C(e,t,n,r,o){var a={};return Object.keys(r).forEach((function(e){a[e]=r[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}!function(e){e[e.iconColumn=32]="iconColumn",e[e.displayNameColumnMin=100]="displayNameColumnMin",e[e.displayNameColumnMax=300]="displayNameColumnMax",e[e.creatorEmailMin=150]="creatorEmailMin",e[e.creatorEmailMax=170]="creatorEmailMax",e[e.status=16]="status"}(a||(a={})),function(e){e.icon="icon",e.displayName="displayName",e.creatorEmail="creatorEmail",e.status="status"}(i||(i={}));var v=Object(c.observer)((C((o=class extends s.Component{constructor(){super(...arguments),this.getClassNames=Object(u.classNamesFunction)()}render(){var e=this.getClassNames(y.getConnectionDetailsListStyles);return this.isLoading||this.getDetailsListProps.items.length?!this.isLoading&&s.createElement(p.DetailsList,S({className:e.root},this.getDetailsListProps)):s.createElement("div",null,this.props.resourceStrings.noConnectionsText)}get isLoading(){var e=g.connectionsStore.connections.getCollection(this.props.connectionCollection);return!e||e.isLoadingInitially}get getDetailsListProps(){var{maxVisibleConnections:e}=this.props,t=g.connectionsStore.connections.getCollection(this.props.connectionCollection).list.map(e=>g.connectionsStore.connections.getEntity(e));if(e&&t&&t.length>e){var n={count:t.length-e,properties:{displayName:this.props.resourceStrings.moreConnectionsText}};(t=t.slice(0,e)).push(n)}return{columns:this.getColumns,checkboxVisibility:d.CheckboxVisibility.hidden,isLoading:this.isLoading,items:t,getKey:e=>e&&e.name}}get getColumns(){return[{key:i.icon,name:null,fieldName:this.props.resourceStrings.iconFieldName,minWidth:a.iconColumn,maxWidth:a.iconColumn,isIconOnly:!0,columnActionsMode:d.ColumnActionsMode.disabled,onRender:e=>s.createElement(h.ConnectionIconCell,{item:e})},{key:i.displayName,name:null,fieldName:this.props.resourceStrings.connectionFieldName,minWidth:a.displayNameColumnMin,maxWidth:a.displayNameColumnMax,isCollapsable:!1,columnActionsMode:d.ColumnActionsMode.disabled,onRender:e=>s.createElement(f.ConnectionDisplayNameCell,{item:e})},{key:i.creatorEmail,name:null,fieldName:this.props.resourceStrings.ownerFieldName,minWidth:a.creatorEmailMin,maxWidth:a.creatorEmailMax,isCollapsable:!0,columnActionsMode:d.ColumnActionsMode.disabled,onRender:e=>s.createElement(b.ConnectionCreatorCell,{item:e})},{key:i.status,name:null,fieldName:this.props.resourceStrings.statusFieldName,minWidth:a.status,maxWidth:a.status,isCollapsable:!0,columnActionsMode:d.ColumnActionsMode.disabled,onRender:e=>s.createElement(m.ConnectionStatusCell,{item:e})}]}componentDidMount(){this.props.loadConnectionsCallback()}}).prototype,"isLoading",[l.computed],Object.getOwnPropertyDescriptor(o.prototype,"isLoading"),o.prototype),C(o.prototype,"getDetailsListProps",[l.computed],Object.getOwnPropertyDescriptor(o.prototype,"getDetailsListProps"),o.prototype),C(o.prototype,"getColumns",[l.computed],Object.getOwnPropertyDescriptor(o.prototype,"getColumns"),o.prototype),r=o))||r},7769:function(e,t,n){"use strict";n.r(t),n.d(t,"ConnectionStatus",(function(){return r})),n.d(t,"ConnectionStatusCell",(function(){return l}));var r,o=n(245),a=n(7699),i=n(687),s=n(2844);!function(e){e.Connected="Connected"}(r||(r={}));var l=Object(a.observer)(e=>e.item.id?o.createElement(i.Icon,{iconName:e.item.properties.statuses[0].status===r.Connected?s.fabricIcons.Completed:s.fabricIcons.Error,title:e.item.properties.statuses[0].status===r.Connected?"Connected":"Error"}):null)},7770:function(e,t,n){"use strict";n.r(t),n.d(t,"ConnectionIconCell",(function(){return l}));var r,o=n(245),a=n(7699),i=n(7771),s=n(7773),l=Object(a.observer)(r=class extends o.Component{render(){var{item:e}=this.props;return e.id?o.createElement(i.ApiIcon,{iconUri:e.properties.iconUri,size:i.ApiIconSize.medium}):o.createElement(s.MoreItems,{count:e.count})}})||r},7771:function(e,t,n){"use strict";n.r(t),n.d(t,"ApiIconSize",(function(){return r})),n.d(t,"ApiIcon",(function(){return l}));var r,o=n(245),a=n(2903),i=n(7772),s=n(687);!function(e){e.xxLarge="75",e.xLarge="48",e.large="40",e.medium="32",e.small="24"}(r||(r={}));class l extends o.PureComponent{constructor(){super(...arguments),this.getClassNames=Object(a.classNamesFunction)(),this.classNames=this.getClassNames(i.getApiIconStyles,this.props)}render(){return o.createElement("div",{className:Object(a.css)(this.props.className,this.classNames.root)},this.renderIcon())}renderIcon(){var{iconUri:e,iconName:t}=this.props;return e?o.createElement("div",{className:this.classNames.icon}):o.createElement(s.Icon,{className:this.classNames.icon,iconName:t})}}},7772:function(e,t,n){"use strict";n.r(t),n.d(t,"getApiIconStyles",(function(){return a}));var r=n(3328),o=n(7771),a=e=>{var t=Object(r.getTheme)().palette,{brandColor:n,iconUri:a,size:i=o.ApiIconSize.medium}=e,s="".concat(i,"px"),l="0px 1px 3px rgba(0, 0, 0, 0.15)";return a?{root:["ba-ApiIcon",{borderRadius:3,boxShadow:l,position:"relative"}],icon:["ba-ApiIcon-icon",{height:s,width:s,borderRadius:3,backgroundColor:n||t.black,backgroundImage:"url('".concat(a,"')"),backgroundOrigin:"content-box",backgroundPosition:"center",backgroundRepeat:"no-repeat",backgroundSize:"contain",padding:i===o.ApiIconSize.small?0:4}]}:{root:["ba-ApiIcon",{color:t.white,height:s,width:s,backgroundColor:n||t.black,borderRadius:3,boxShadow:l,display:"flex",alignItems:"center",justifyContent:"center"}],icon:["ba-ApiIcon-icon",{}]}}},7773:function(e,t,n){"use strict";n.r(t),n.d(t,"MoreItems",(function(){return i}));var r=n(245),o=n(7774),a=n(2903);class i extends r.Component{constructor(){super(...arguments),this.getClassNames=Object(a.classNamesFunction)(),this.classNames=this.getClassNames(o.getMoreItemsStyles)}render(){var{count:e}=this.props;return r.createElement("div",{className:this.classNames.root},r.createElement("span",null,"+",e)," ")}}},7774:function(e,t,n){"use strict";n.r(t),n.d(t,"getMoreItemsStyles",(function(){return o}));var r=n(3328),o=()=>{var e=Object(r.getTheme)().palette;return{root:[".ms-MoreItems",{border:"1px solid ".concat(e.themePrimary),borderRadius:"50%",width:"32px",height:"32px",padding:"4px 0",backgroundColor:e.themePrimary,textAlign:"center",fontSize:r.FontSizes.medium,lineHeight:"20px",color:e.white}]}}},7775:function(e,t,n){"use strict";n.r(t),n.d(t,"ConnectionCreatorCell",(function(){return s}));var r=n(245),o=n(7699),a=n(2903),i=n(7776),s=Object(o.observer)(e=>{var t=Object(a.classNamesFunction)()(i.getConnectionDetailsListStyles);return e.item.id?r.createElement("span",{className:t.creatorCell,title:e.item.properties.displayName},e.item.properties.displayName):null})},7776:function(e,t,n){"use strict";n.r(t),n.d(t,"getConnectionDetailsListStyles",(function(){return o}));var r=n(3328),o=()=>{var e=Object(r.getTheme)().palette;return{root:["ms-ConnectionsDetailsList",{selectors:{".ms-DetailsList-headerWrapper":{display:"none"},".ms-FocusZone.ms-DetailsHeader":{borderBottom:"none"},".ms-FocusZone.ms-DetailsRow":{height:"36px",borderTop:"none",color:e.neutralPrimary,selectors:{i:{fontSize:r.FontSizes.icon},'i[data-icon-name="Completed"]':{color:e.green},'i[data-icon-name="Error"]':{color:e.red}}},".ba-EmptyState":{margin:"unset",maxWidth:"unset",alignItems:"unset",selectors:{".ba-EmptyState-PrimaryMessage":{fontWeight:"normal",textAlign:"left",color:e.neutralPrimary}}},".ba-ApiIcon-icon":{padding:0}}}],creatorCell:["ms-ConnectionsCard-creatorCell",{overflow:"hidden",textOverflow:"ellipsis"}],displayNameCell:["ms-ConnectionsCard-displayNameCell",{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"flex-start",overflow:"hidden",selectors:{"span:first-of-type":{overflow:"hidden",fontSize:r.FontSizes.medium,textOverflow:"ellipsis",width:"100%"},"button.ms-Button.ms-Button--action":{fontSize:r.FontSizes.mini,color:e.themePrimary,height:"auto",paddingLeft:0,borderLeft:0,selectors:{".ms-Button-label":{marginLeft:0}}}}}]}}},7777:function(e,t,n){"use strict";n.r(t),n.d(t,"ConnectionDisplayNameCell",(function(){return l}));var r,o=n(245),a=n(7699),i=n(2903),s=n(7776),l=Object(a.observer)(r=class extends o.Component{constructor(){super(...arguments),this.getClassNames=Object(i.classNamesFunction)()}render(){var{item:e}=this.props,t=this.getClassNames(s.getConnectionDetailsListStyles);return o.createElement("div",{className:t.displayNameCell},e.id?o.createElement(o.Fragment,null,o.createElement("span",{title:e.displayName},e.displayName)):o.createElement(o.Fragment,null,o.createElement("span",{className:t.displayNameCell,title:e.properties.displayName},e.properties.displayName),o.createElement("span",null)))}})||r},7778:function(e,t,n){"use strict";n.r(t);var r=n(7760);n.d(t,"cacheExpirationInMilliseconds",(function(){return r.cacheExpirationInMilliseconds}));var o=n(7723);n.d(t,"hasMsElapsedSince",(function(){return o.hasMsElapsedSince})),n.d(t,"getFriendlyTimeDuration",(function(){return o.getFriendlyTimeDuration})),n.d(t,"getFriendlyDateTime",(function(){return o.getFriendlyDateTime})),n.d(t,"performanceNow",(function(){return o.performanceNow}));var a=n(7707);n.d(t,"getCurrentSessionId",(function(){return a.getCurrentSessionId})),n.d(t,"getCurrentObjectId",(function(){return a.getCurrentObjectId})),n.d(t,"getCurrentEnvironmentName",(function(){return a.getCurrentEnvironmentName})),n.d(t,"getCurrentXrmUrl",(function(){return a.getCurrentXrmUrl})),n.d(t,"getCurrentLocale",(function(){return a.getCurrentLocale})),n.d(t,"getUiFlowsUrl",(function(){return a.getUiFlowsUrl}));var i=n(7730);n.d(t,"cut",(function(){return i.cut}));var s=n(7729);n.d(t,"removeQueryParameterFromUrl",(function(){return s.removeQueryParameterFromUrl}))},7779:function(e,t,n){"use strict";n.r(t),n.d(t,"GatewayClusterDetailsSurface",(function(){return w})),n.d(t,"spawnGatewayClusterDetailsSurface",(function(){return O}));var r,o,a=n(245),i=n(7701),s=n(7699),l=n(545),c=n(4013),p=n(7764),u=n(7705),d=n(7780),m=n(217),g=n(7708);function h(){return(h=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var b,f,y,S,C,v,w=Object(s.observer)((o=class extends a.Component{constructor(){super(...arguments),this.renderFooter=()=>a.createElement(p.DefaultButton,{primary:!0,onClick:this.onCloseClick},this.props.resourceStrings.closeButtonText),this.onCloseClick=()=>{Object(m.trackUserActionClickButton)(g.gatewayDetailsEventScope,"gatewayClusterDetailsSurface/close",{gatewayId:this.props.gatewayName});var{dismiss:e}=this.props;e()}}render(){var{dismiss:e,resourceStrings:t}=this.props;return a.createElement(c.Panel,{dismissOnEscape:!0,headerText:t.titleText,isOpen:!0,onDismiss:e,onRenderFooterContent:this.renderFooter},a.createElement(d.GatewayClusterDetailsList,{gateway:this.gateway,resourceStrings:{iconFieldName:t.iconFieldName,gatewayFieldName:t.gatewayFieldName,gatewayStatusFieldName:t.gatewayStatusFieldName,moreGatewaysText:t.moreGatewaysText}}))}get gateway(){var{gatewayName:e}=this.props;return u.gatewaysStore.gateways.getEntity(e)}},b=o.prototype,f="gateway",y=[i.computed],S=Object.getOwnPropertyDescriptor(o.prototype,"gateway"),C=o.prototype,v={},Object.keys(S).forEach((function(e){v[e]=S[e]})),v.enumerable=!!v.enumerable,v.configurable=!!v.configurable,("value"in v||v.initializer)&&(v.writable=!0),v=y.slice().reverse().reduce((function(e,t){return t(b,f,e)||e}),v),C&&void 0!==v.initializer&&(v.value=v.initializer?v.initializer.call(C):void 0,v.initializer=void 0),void 0===v.initializer&&(Object.defineProperty(b,f,v),v=null),r=o))||r;function O(e,t,n){e.spawn({key:Object(l.getId)("gatewayCluster-Details-surface"),render:e=>a.createElement(w,h({gatewayName:t,resourceStrings:n},e))})}},7780:function(e,t,n){"use strict";n.r(t),n.d(t,"GatewaysColumns",(function(){return a})),n.d(t,"GatewaysColumnWidth",(function(){return i})),n.d(t,"GatewayClusterDetailsList",(function(){return b}));var r,o,a,i,s=n(245),l=n(7701),c=n(7699),p=n(1471),u=n(3064),d=n(2903),m=n(7781),g=n(7783);function h(e,t,n,r,o){var a={};return Object.keys(r).forEach((function(e){a[e]=r[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}!function(e){e.icon="icon",e.displayName="displayName",e.status="status"}(a||(a={})),function(e){e[e.iconColumn=32]="iconColumn",e[e.displayNameColumnMin=100]="displayNameColumnMin",e[e.displayNameColumnMax=300]="displayNameColumnMax",e[e.status=16]="status"}(i||(i={}));var b=Object(c.observer)((h((o=class extends s.Component{constructor(){super(...arguments),this.getClassNames=Object(d.classNamesFunction)(),this.classNames=this.getClassNames(g.getGatewayClusterDetailsListStyles)}render(){return s.createElement(u.DetailsList,this.detailsListProps)}get getColumns(){var{resourceStrings:e}=this.props;return[{key:a.icon,name:null,fieldName:e.iconFieldName,minWidth:i.iconColumn,maxWidth:i.iconColumn,isIconOnly:!0,columnActionsMode:p.ColumnActionsMode.disabled,onRender:e=>s.createElement(m.GatewayIconCell,{item:e})},{key:a.displayName,name:null,fieldName:e.gatewayFieldName,minWidth:i.displayNameColumnMin,maxWidth:i.displayNameColumnMax,isCollapsable:!1,columnActionsMode:p.ColumnActionsMode.disabled,onRender:e=>s.createElement("span",{className:this.classNames.displayName,title:e.properties.displayName},e.properties.displayName)}]}get detailsListProps(){var{gateway:e,maxVisibleGateways:t,resourceStrings:{moreGatewaysText:n}}=this.props,r=[e.toJS()].concat(e.gatewaysInCluster.slice(1));if(t&&e.clusterSize>t){var o={count:r.length-t,properties:{displayName:n}};(r=r.slice(0,t)).push(o)}return{className:this.classNames.root,columns:this.getColumns,checkboxVisibility:p.CheckboxVisibility.hidden,isLoading:!1,items:r,getKey:e=>e&&e.name}}}).prototype,"getColumns",[l.computed],Object.getOwnPropertyDescriptor(o.prototype,"getColumns"),o.prototype),h(o.prototype,"detailsListProps",[l.computed],Object.getOwnPropertyDescriptor(o.prototype,"detailsListProps"),o.prototype),r=o))||r},7781:function(e,t,n){"use strict";n.r(t),n.d(t,"GatewayIconCell",(function(){return l}));var r,o=n(245),a=n(7699),i=n(7782),s=n(7773),l=Object(a.observer)(r=class extends o.Component{render(){var{item:e}=this.props;return e.id?o.createElement(i.GatewayIcon,{isMainCluster:!!e.properties.gateways}):o.createElement(s.MoreItems,{count:e.count})}})||r},7782:function(e,t,n){"use strict";n.r(t),n.d(t,"GatewayIcon",(function(){return i}));var r=n(245),o=n(7771),a=()=>r.createElement("svg",{width:"44",height:"40",viewBox:"0 0 44 40",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r.createElement("rect",{width:"44",height:"40",rx:"3",fill:"#CCE0FF"}),r.createElement("rect",{width:"42",height:"40",rx:"3",fill:"#94BFFF"}),r.createElement("rect",{width:"40",height:"40",rx:"3",fill:"#00388C"}),r.createElement("path",{d:"M12.5 12.5H17.5V13.75H12.5V12.5ZM12.5 21.25H17.5V22.5H12.5V21.25ZM12.5 23.75H17.5V25H12.5V23.75ZM27.5 12.5C27.6758 12.5 27.8385 12.5326 27.9883 12.5977C28.138 12.6628 28.2682 12.7539 28.3789 12.8711C28.4961 12.9818 28.5872 13.112 28.6523 13.2617C28.7174 13.4115 28.75 13.5742 28.75 13.75V30H18.75V27.5H10V11.25C10 11.0742 10.0326 10.9115 10.0977 10.7617C10.1628 10.612 10.2507 10.4818 10.3613 10.3711C10.4785 10.2539 10.612 10.1628 10.7617 10.0977C10.9115 10.0326 11.0742 10 11.25 10H18.75C18.9258 10 19.0885 10.0326 19.2383 10.0977C19.388 10.1628 19.5182 10.2539 19.6289 10.3711C19.7461 10.4818 19.8372 10.612 19.9023 10.7617C19.9674 10.9115 20 11.0742 20 11.25V12.5H27.5ZM18.75 26.25V11.25H11.25V26.25H18.75ZM27.5 13.75H20V28.75H27.5V13.75ZM26.25 16.25H21.25V15H26.25V16.25ZM26.25 25H21.25V23.75H26.25V25ZM26.25 27.5H21.25V26.25H26.25V27.5Z",fill:"white"}));class i extends r.PureComponent{render(){return this.props.isMainCluster?r.createElement(a,null):r.createElement(o.ApiIcon,{brandColor:"#0078D4",iconName:"Server",size:o.ApiIconSize.medium})}}},7783:function(e,t,n){"use strict";n.r(t),n.d(t,"getGatewayClusterDetailsListStyles",(function(){return o}));var r=n(3328),o=()=>{var e=Object(r.getTheme)().palette;return{root:["ms-GatewayClusterDetailsList",{selectors:{".ms-DetailsList-headerWrapper":{display:"none"},".ms-FocusZone.ms-DetailsHeader":{borderBottom:"none"},".ms-FocusZone.ms-DetailsRow":{height:"36px",borderTop:"none",color:e.neutralPrimary,selectors:{i:{fontSize:r.FontSizes.icon},'i[data-icon-name="Completed"]':{color:e.green},'i[data-icon-name="Error"]':{color:e.red}}}}}],displayName:["ms-GatewayClusterDetailsList-displayName",{fontSize:r.FontSizes.medium,overflow:"hidden",textOverflow:"ellipsis"}]}}},7784:function(e,t,n){"use strict";n.r(t),n.d(t,"FlowStatus",(function(){return a})),n.d(t,"friendlyStatusMapping",(function(){return m})),n.d(t,"friendlySessionStatusMapping",(function(){return g})),n.d(t,"StatusColor",(function(){return d})),n.d(t,"FlowRunStatusCell",(function(){return h})),n.d(t,"getUiFlowRunFriendlyStatusText",(function(){return b}));var r,o,a,i=n(245),s=n(7699),l=n(7701),c=n(7785),p=n(7724);function u(e,t,n,r,o){var a={};return Object.keys(r).forEach((function(e){a[e]=r[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}!function(e){e[e.canceled=0]="canceled",e[e.failed=1]="failed",e[e.running=2]="running",e[e.skipped=3]="skipped",e[e.succeeded=4]="succeeded",e[e.unknown=5]="unknown"}(a||(a={}));var d,m={notSpecified:a.unknown,paused:a.unknown,suspended:a.unknown,ignored:a.unknown,deleted:a.unknown,terminated:a.unknown,succeeded:a.succeeded,skipped:a.skipped,running:a.running,waiting:a.running,failed:a.failed,faulted:a.failed,timedOut:a.failed,canceled:a.canceled,aborted:a.canceled},g={0:"notSpecified",1:"paused",2:"running",3:"waiting",4:"succeeded",5:"skipped",6:"suspended",7:"canceled",8:"failed",9:"faulted",10:"timedOut",11:"aborted",12:"ignored",13:"deleted",14:"terminated"};!function(e){e.green="rgba(186,216,10,0.2)",e.red="rgba(232,17,35,0.1)",e.none="none"}(d||(d={}));var h=Object(s.observer)((u((o=class extends i.Component{render(){return i.createElement(c.StatusInCell,{color:this.statusColor,width:200},this.statusText)}get flowStatus(){return b(p.uiFlowRunsStore.uiFlowRuns.getEntity(this.props.runId))}get statusText(){var{resourceStrings:e}=this.props;switch(this.flowStatus){case a.succeeded:return e.succeeded;case a.failed:return e.failed;case a.canceled:return e.canceled;case a.running:return e.running;default:return e.unknown}}get statusColor(){switch(this.flowStatus){case a.succeeded:return d.green;case a.failed:case a.canceled:return d.red;default:return d.none}}}).prototype,"flowStatus",[l.computed],Object.getOwnPropertyDescriptor(o.prototype,"flowStatus"),o.prototype),u(o.prototype,"statusText",[l.computed],Object.getOwnPropertyDescriptor(o.prototype,"statusText"),o.prototype),u(o.prototype,"statusColor",[l.computed],Object.getOwnPropertyDescriptor(o.prototype,"statusColor"),o.prototype),r=o))||r;function b(e){return e&&e.statuscode&&g[e.statuscode]?m[g[e.statuscode]]:a.unknown}},7785:function(e,t,n){"use strict";n.r(t),n.d(t,"StatusInCell",(function(){return i}));var r=n(245),o=n(2903),a=n(7786);class i extends r.PureComponent{constructor(){super(...arguments),this.getClassNames=Object(o.classNamesFunction)(),this.classNames=this.getClassNames(a.getStatusInCellStyles,this.props)}render(){return r.createElement("div",{className:this.classNames.status},this.props.children)}}},7786:function(e,t,n){"use strict";n.r(t),n.d(t,"getStatusInCellStyles",(function(){return o}));var r={alignItems:"center",display:"flex",height:"100%",width:"100%",paddingLeft:"8px"},o=e=>{var{color:t}=e;return t?{status:["fl-StatusInCell",r,{backgroundColor:t}]}:{status:["fl-StatusInCell",r]}}},7787:function(e,t,n){"use strict";n.r(t),n.d(t,"FlowRunDurationCell",(function(){return b}));var r,o,a=n(245),i=n(7701),s=n(7699),l=n(7724),c=n(7788);var p,u,d,m,g,h,b=Object(s.observer)((o=class extends a.Component{render(){var e=this.uiFlowRun.startedon||this.uiFlowRun.createdon,t=this.uiFlowRun.completedon||this.uiFlowRun.modifiedon;return a.createElement(c.Duration,{startDateTime:e,endDateTime:t})}get uiFlowRun(){return l.uiFlowRunsStore.uiFlowRuns.getEntity(this.props.runId)}},p=o.prototype,u="uiFlowRun",d=[i.computed],m=Object.getOwnPropertyDescriptor(o.prototype,"uiFlowRun"),g=o.prototype,h={},Object.keys(m).forEach((function(e){h[e]=m[e]})),h.enumerable=!!h.enumerable,h.configurable=!!h.configurable,("value"in h||h.initializer)&&(h.writable=!0),h=d.slice().reverse().reduce((function(e,t){return t(p,u,e)||e}),h),g&&void 0!==h.initializer&&(h.value=h.initializer?h.initializer.call(g):void 0,h.initializer=void 0),void 0===h.initializer&&(Object.defineProperty(p,u,h),h=null),r=o))||r},7788:function(e,t,n){"use strict";n.r(t),n.d(t,"Duration",(function(){return a}));var r=n(245),o=n(7723);class a extends r.PureComponent{render(){var e=Object(o.getFriendlyTimeDuration)(this.props.startDateTime,this.props.endDateTime);return r.createElement("span",{title:e},e)}}},7789:function(e,t,n){"use strict";n.r(t),n.d(t,"FlowRunLinkCell",(function(){return b}));var r,o,a=n(245),i=n(7701),s=n(7699),l=n(1090),c=n(7790),p=n(7707),u=n(7724),d=n(217),m=n(7708),g=n(2871);function h(e,t,n,r,o){var a={};return Object.keys(r).forEach((function(e){a[e]=r[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}var b=Object(s.observer)((h((o=class extends a.Component{constructor(){super(...arguments),this.onRunLinkClick=()=>{Object(d.trackUserActionClickLink)(m.gatewayDetailsEventScope,"flowRunsCard/linkCell/onRun",{flowSessionid:this.uiFlowRun.flowsessionid,runId:this.props.runId})}}render(){var e=g.featureGates.renameUIFlowsForGA?this.uiFlowRun.createdon:this.uiFlowRun.startedon||this.uiFlowRun.createdon;return a.createElement(l.Link,{href:this.runLinkUrl,target:"_blank",onClick:this.onRunLinkClick},a.createElement(c.StartTime,{iso:e,locale:Object(p.getCurrentLocale)()}))}get uiFlowRun(){return u.uiFlowRunsStore.uiFlowRuns.getEntity(this.props.runId)}get runLinkUrl(){return"".concat(Object(p.getUiFlowsUrl)(),"/").concat(this.uiFlowRun._regardingobjectid_value,"/runs/").concat(this.uiFlowRun.flowsessionid)}}).prototype,"uiFlowRun",[i.computed],Object.getOwnPropertyDescriptor(o.prototype,"uiFlowRun"),o.prototype),h(o.prototype,"runLinkUrl",[i.computed],Object.getOwnPropertyDescriptor(o.prototype,"runLinkUrl"),o.prototype),r=o))||r},7790:function(e,t,n){"use strict";n.r(t),n.d(t,"StartTime",(function(){return i}));var r=n(245),o=n(7723),a={month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"};class i extends r.PureComponent{render(){var e=this.getDate();return r.createElement("span",{title:"".concat(e)},e)}getDate(){try{var e=Object(o.getFriendlyDateTime)(new Date(this.props.iso),a,this.props.locale);return"".concat(e)}catch(t){return this.props.iso}}}},7791:function(e,t,n){"use strict";n.r(t),n.d(t,"FlowNameCell",(function(){return O}));var r,o,a,i,s=n(245),l=n(7701),c=n(7699),p=n(687),u=n(1090),d=n(1755),m=n(2903),g=n(7792),h=n(7755),b=n(7705),f=n(5768),y=n(7707),S=n(217),C=n(7708);function v(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function w(e,t,n,r,o){var a={};return Object.keys(r).forEach((function(e){a[e]=r[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}var O=Object(c.observer)((o=class extends s.Component{constructor(){super(...arguments),this.getClassNames=Object(m.classNamesFunction)(),this.classNames=this.getClassNames(g.getFlowNameCellStyles),v(this,"isLoading",a,this),v(this,"errorDetails",i,this),this.onWorkflowNameClick=()=>{Object(S.trackUserActionClickLink)(C.gatewayDetailsEventScope,"flowRunsCard/flowNameCell/workflowName",{workflowId:this.workflow.workflowid,runId:this.props.runId})}}render(){return this.isLoading?this.renderShimmer():this.errorDetails?this.renderError():this.renderName()}renderError(){return s.createElement("div",{className:this.classNames.error},this.props.errorDisplayString," ",s.createElement(p.Icon,{ariaLabel:this.errorDetails,title:this.errorDetails,iconName:"Error"}))}renderName(){return s.createElement(u.Link,{className:this.classNames.root,href:this.uiFlowPropertiesUrl,target:"_blank",onClick:this.onWorkflowNameClick},this.workflow?this.workflow.name:"")}renderShimmer(){return s.createElement("div",{className:this.classNames.shimmer},s.createElement(d.Shimmer,null))}loadWorkflow(){this.setLoading(!0),h.workflowService.loadWorkflow(this.uiWorkflowRun._regardingobjectid_value).then(()=>{this.setLoading(!1)}).catch(e=>{this.setLoading(!1),this.setErrorDetails(Object(f.getResponseErrorMessage)(e))})}get workflow(){return b.workflowsStore.workflows.entities.entities.get(this.uiWorkflowRun._regardingobjectid_value)}get uiWorkflowRun(){var{runId:e}=this.props;return b.uiFlowRunsStore.uiFlowRuns.getEntity(e)}get uiFlowPropertiesUrl(){return this.workflow&&this.workflow.workflowid?"".concat(Object(y.getUiFlowsUrl)(),"/").concat(this.workflow.workflowid,"/details"):""}setErrorDetails(e){this.errorDetails=e}setLoading(e){this.isLoading=e}componentDidMount(){this.loadWorkflow()}},a=w(o.prototype,"isLoading",[l.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),i=w(o.prototype,"errorDetails",[l.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w(o.prototype,"workflow",[l.computed],Object.getOwnPropertyDescriptor(o.prototype,"workflow"),o.prototype),w(o.prototype,"uiWorkflowRun",[l.computed],Object.getOwnPropertyDescriptor(o.prototype,"uiWorkflowRun"),o.prototype),w(o.prototype,"uiFlowPropertiesUrl",[l.computed],Object.getOwnPropertyDescriptor(o.prototype,"uiFlowPropertiesUrl"),o.prototype),w(o.prototype,"setErrorDetails",[l.action],Object.getOwnPropertyDescriptor(o.prototype,"setErrorDetails"),o.prototype),w(o.prototype,"setLoading",[l.action],Object.getOwnPropertyDescriptor(o.prototype,"setLoading"),o.prototype),r=o))||r},7792:function(e,t,n){"use strict";n.r(t),n.d(t,"getFlowNameCellStyles",(function(){return o}));var r=n(3328),o=()=>{var e=Object(r.getTheme)().palette;return{root:["ms-FlowNameCell",{fontSize:r.FontSizes.medium}],shimmer:["ms-FlowNameCell-Shimmer",{height:"100%",width:"100%",selectors:{".ms-Shimmer-container":{display:"flex",alignItems:"center",padding:0,height:"100%",width:"40%",overflow:"unset"}}}],error:["ms-FlowNameCell-error",{display:"flex",fontSize:r.FontSizes.medium,color:e.redDark,selectors:{i:{marginLeft:5}}}]}}},7793:function(e,t,n){"use strict";n.r(t),n.d(t,"FormattableTextSegmentType",(function(){return r})),n.d(t,"renderSegmentHandlerPlaceholderAsBold",(function(){return i})),n.d(t,"FormattableText",(function(){return s}));var r,o=n(245),a=n(7794);function i(e,t){switch(e.type){case r.LITERAL:return o.createElement("span",{key:t},e.value);case r.PLACEHOLDER:return o.createElement("span",{key:t},o.createElement("b",null,e.value));default:return null}}!function(e){e[e.LITERAL=0]="LITERAL",e[e.PLACEHOLDER=1]="PLACEHOLDER"}(r||(r={}));class s extends o.PureComponent{render(){return Object(a.getFormattableTextSegments)(this.props.formatText).map(this.props.onRenderSegment||i)}}},7794:function(e,t,n){"use strict";n.r(t),n.d(t,"getFormattableTextSegments",(function(){return a}));var r=n(7793),o=/\{[a-zA-Z$_\d]+\}/g;function a(e){var t=[];if(!e)return t;for(var n=e.match(o),a=e.split(o),i=0;i<a.length;i++)a[i]&&t.push({type:r.FormattableTextSegmentType.LITERAL,value:a[i]}),n&&i<n.length&&t.push({type:r.FormattableTextSegmentType.PLACEHOLDER,value:n[i].substring(1,n[i].length-1)});return t}},7795:function(e,t,n){"use strict";n.r(t),n.d(t,"getFlowRunsDetailsListStyles",(function(){return o}));var r=n(3328),o=()=>({root:[{selectors:{".ms-FocusZone.ms-DetailsRow":{borderTop:"none",borderBottom:"1px solid",borderWidth:"thin",borderBottomColor:Object(r.getTheme)().palette.neutralLight},".ms-DetailsRow-cell":{padding:"0 0 0 auto",lineHeight:"42px"},".ms-DetailsRow-cell .ms-Link":{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},".ba-DetailsList-container .ms-Button":{border:"none"}}}],zeroRunContainer:["ms-RunsCard-zeroRunContainer"],zeroRunContent:["ms-RunsCard-zeroRun",{fontWeight:r.FontWeights.bold}]})},7796:function(e,t,n){"use strict";n.r(t),n.d(t,"gatewayRunsEventScope",(function(){return o})),n.d(t,"commandBarRunsFilterEventName",(function(){return a})),n.d(t,"headerBreadcrumEventName",(function(){return i})),n.d(t,"messageBarDismissEventName",(function(){return s})),n.d(t,"gatewayMoreRunsEventName",(function(){return l})),n.d(t,"eventNameSectionPrefix",(function(){return c})),n.d(t,"Status",(function(){return r}));var r,o="powerappsportal/gatewayRuns",a="commandBar/runsFilter",i="gatewayRuns/page/header/breadcrumb",s="gatewayRuns/page/messageBar/dismiss",l="gatewayRuns/page/moreRuns",c="gatewayRuns/page";!function(e){e.Success="Success",e.Failure="Failure",e.Abort="Abort",e.ValidationError="ValidationError",e.Warning="Warning"}(r||(r={}))},7797:function(e,t,n){"use strict";n.r(t),n.d(t,"getFlowRunsCardStyles",(function(){return o}));var r=n(3328),o=()=>({root:["ms-FlowRunsCard",{selectors:{".ms-DetailsHeader":{paddingTop:5,paddingBottom:5},".ms-DetailsHeader-cell":{fontSize:r.FontSizes.medium},".ms-DetailsHeader-cellTitle":{padding:0},".ms-DetailsRow-cell":{padding:"0 0 0 0",lineHeight:"20px"}}}],messageBar:["ms-RunsCard-messageBar",{width:"100%",selectors:{"+ div.ms-Shimmer-container":{paddingTop:0,selectors:{".ms-RunsCard-zeroRunContainer":{paddingTop:15}}},".ms-MessageBar-content":{height:32,selectors:{".ms-MessageBar-icon, .ms-MessageBar-text":{marginTop:8,marginBottom:8}}},".ms-MessageBar-dismissal":{margin:0}}}],messageBarLink:["ms-RunsCard-messageBarLink",{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}]})},7798:function(e,t,n){"use strict";n.r(t),n.d(t,"DetailsCard",(function(){return c}));var r=n(245),o=n(7799),a=n(1755),i=n(2903),s=n(7810),l=()=>r.createElement(a.ShimmerElementsGroup,{flexWrap:!0,width:"100%",shimmerElements:[{type:a.ShimmerElementType.gap,width:"100%",height:14},{type:a.ShimmerElementType.line,width:"30%",height:14},{type:a.ShimmerElementType.gap,width:"70%",height:14},{type:a.ShimmerElementType.gap,width:"100%",height:2},{type:a.ShimmerElementType.line,width:"90%",height:14,verticalAlign:"bottom"}]});class c extends r.Component{constructor(){super(...arguments),this.getClassNames=Object(i.classNamesFunction)(),this.classNames=this.getClassNames(s.getDetailsCardStyles)}render(){return r.createElement(o.Card,{className:Object(i.css)(this.classNames.root,this.props.className)},r.createElement(o.CardBody,null,this.renderTitle(),this.renderBody()),this.renderFooter())}renderBody(){var{ariaLabelLoading:e,isLoading:t,renderBody:n}=this.props;return r.createElement(a.Shimmer,{isDataLoaded:!t,ariaLabel:e,customElementsGroup:r.createElement(l,null)},r.createElement("div",{className:this.classNames.body},!t&&n()))}renderFooter(){var{renderFooter:e}=this.props;return e&&r.createElement(o.CardFooter,null," ",e()," ")}renderTitle(){var{renderTitle:e,renderTitleLink:t,renderMessageBar:n}=this.props,o=this.getClassNames(s.getDetailsCardStyles);return r.createElement(r.Fragment,null,r.createElement("div",{className:o.title},r.createElement("span",{className:o.titleMain,role:"heading","aria-level":3},e()),t&&r.createElement("span",{className:o.titleLink},t())),n&&n())}}},7799:function(e,t,n){"use strict";n.r(t),n.d(t,"Card",(function(){return c})),n.d(t,"CardTitle",(function(){return p})),n.d(t,"CardSubTitle",(function(){return u})),n.d(t,"CardImage",(function(){return d}));var r=n(245),o=n(7800),a=n(1277),i=n(2903),s=n(7809);function l(){return(l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}n.d(t,"CardFooter",(function(){return o.CardFooter})),n.d(t,"CardBody",(function(){return o.CardBody}));class c extends r.Component{constructor(){super(...arguments),this.getClassNames=Object(i.classNamesFunction)()}render(){var e=this.getClassNames(s.getStyles);return r.createElement(o.Card,{className:Object(i.css)(this.props.className,e.card)},this.props.children)}}class p extends r.PureComponent{constructor(){super(...arguments),this.getClassNames=Object(i.classNamesFunction)()}render(){var e=this.getClassNames(s.getStyles);return r.createElement("h2",{className:e.cardTitle},this.props.children)}}class u extends r.PureComponent{constructor(){super(...arguments),this.getClassNames=Object(i.classNamesFunction)()}render(){var e=this.getClassNames(s.getStyles);return r.createElement("h3",{className:e.cardSubTitle},this.props.children)}}class d extends r.Component{render(){var e=l({},this.props);return r.createElement(a.Image,l({className:"ba-CardImage",imageFit:a.ImageFit.centerCover,width:"100%",height:"auto",src:this.props.src},e))}}},7800:function(e,t,n){"use strict";n.r(t);var r=n(7801);n.d(t,"Card",(function(){return r.Card}));var o=n(7803);n.d(t,"CardBody",(function(){return o.CardBody}));var a=n(7804);n.d(t,"CardFooter",(function(){return a.CardFooter}));var i=n(7805);n.d(t,"CardImage",(function(){return i.CardImage}));var s=n(7806);n.d(t,"CardSubTitle",(function(){return s.CardSubTitle}));var l=n(7807);n.d(t,"CardTitle",(function(){return l.CardTitle}));n(7808)},7801:function(e,t,n){"use strict";n.r(t),n.d(t,"Card",(function(){return i}));var r=n(545),o=n(245),a=n(7802);class i extends o.Component{constructor(){super(...arguments),this.getClassNames=Object(r.classNamesFunction)()}render(){var e=this.getClassNames(a.getStyles);return o.createElement("div",{className:Object(r.css)(e.root,this.props.className)},this.props.children)}}},7802:function(e,t,n){"use strict";n.r(t),n.d(t,"getStyles",(function(){return o}));var r=n(719),o=e=>{var t=Object(r.getTheme)().palette;return{root:["ba-Card",{backgroundColor:t.white,boxShadow:"0px 0.3px 0.9px rgba(0, 0, 0, 0.108), 0px 1.6px 3.6px rgba(0, 0, 0, 0.108)",display:"flex",justifyContent:"space-between",flexDirection:"column",overflow:"hidden",padding:"20px",margin:"0 0 15px 0",borderRadius:"3px",width:"auto",selectors:{":hover":{boxShadow:"0px 1.2px 3.6px rgba(0, 0, 0, 0.108), 0px 6.4px 14.4px rgba(0, 0, 0, 0.108)",cursor:"pointer"},":focus":{borderColor:t.neutralSecondary}}}],cardTitle:["ba-CardTitle",{fontSize:r.FontSizes.medium,fontWeight:r.FontWeights.semibold,margin:"12px 0 6px",padding:0,lineHeight:"normal",selectors:{":hover":{color:"inherit"},":focus":{color:"inherit"},":active":{color:"inherit"}}}],cardSubTitle:["ba-CardSubTitle",{fontSize:r.FontSizes.small,fontWeight:r.FontWeights.regular,padding:0,margin:0,color:t.neutralSecondary}]}}},7803:function(e,t,n){"use strict";n.r(t),n.d(t,"CardBody",(function(){return o}));var r=n(245);class o extends r.Component{render(){return r.createElement("div",{className:"ba-CardBody"},this.props.children)}}},7804:function(e,t,n){"use strict";n.r(t),n.d(t,"CardFooter",(function(){return o}));var r=n(245);class o extends r.Component{render(){return r.createElement("div",{className:"ba-CardFooter"},this.props.children)}}},7805:function(e,t,n){"use strict";n.r(t),n.d(t,"CardImage",(function(){return i}));var r=n(245),o=n(1277);function a(){return(a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}class i extends r.Component{render(){var e=a({},this.props);return r.createElement(o.Image,a({className:"ba-CardImage",imageFit:o.ImageFit.centerCover,width:"100%",height:"auto"},e))}}},7806:function(e,t,n){"use strict";n.r(t),n.d(t,"CardSubTitle",(function(){return i}));var r=n(545),o=n(245),a=n(7802);class i extends o.PureComponent{constructor(){super(...arguments),this.getClassNames=Object(r.classNamesFunction)()}render(){var e=this.getClassNames(a.getStyles);return o.createElement("h2",{className:e.cardSubTitle},this.props.children)}}},7807:function(e,t,n){"use strict";n.r(t),n.d(t,"CardTitle",(function(){return i}));var r=n(545),o=n(245),a=n(7802);class i extends o.PureComponent{constructor(){super(...arguments),this.getClassNames=Object(r.classNamesFunction)()}render(){var e=this.getClassNames(a.getStyles);return o.createElement("h1",{className:e.cardTitle},this.props.children)}}},7808:function(e,t,n){"use strict";n.r(t)},7809:function(e,t,n){"use strict";n.r(t),n.d(t,"getStyles",(function(){return o}));var r=n(3328),o=e=>{var t=Object(r.getTheme)().palette;return{card:["ba-customCard",{border:"1px solid ".concat(t.neutralLight)}],cardHighContrast:["ba-customCard",{border:"1px solid ".concat(t.black)}],cardTitle:["ba-customCardTitle",{fontSize:r.FontSizes.medium,fontWeight:r.FontWeights.semibold,margin:"12px 0 6px",padding:0,lineHeight:"normal",selectors:{":hover":{color:"inherit"},":focus":{color:"inherit"},":active":{color:"inherit"}}}],cardSubTitle:["ba-customCardSubTitle",{fontSize:r.FontSizes.small,fontWeight:r.FontWeights.regular,padding:0,margin:0,color:t.neutralSecondary,lineHeight:"normal"}]}}},7810:function(e,t,n){"use strict";n.r(t),n.d(t,"getDetailsCardStyles",(function(){return o}));var r=n(3328),o=e=>{var t=Object(r.getTheme)().palette;return{root:["ba-detailsCard",{backgroundColor:t.white,margin:"10px 0",selectors:{"&.ba-Card":{padding:0},"&.ba-Card:hover":{cursor:"default"},".ba-CardFooter":{padding:15},".ms-Shimmer-container":{padding:15,height:"calc(100% - ".concat(40,"px)"),overflowY:"auto",overflowX:"hidden"}}}],title:["ba-detailsCard-Title",{display:"flex",alignItems:"center",borderBottom:"1px solid ".concat(t.neutralLight),padding:"0 15px",width:"100%",height:40}],titleMain:["ba-detailsCard-Title--main",{fontWeight:r.FontWeights.bold,flexGrow:1,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}],titleLink:["ba-detailsCard-Title--link",{display:"flex",alignItems:"center",color:t.blue,selectors:{".ms-Link":{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}}}],body:["ba-detailsCard-Body",{minHeight:40}]}}},7811:function(e,t,n){"use strict";n.r(t),n.d(t,"ConnectionColumns",(function(){return a})),n.d(t,"MaxVisibleConnections",(function(){return C})),n.d(t,"ConnectionsColumnWidth",(function(){return S})),n.d(t,"GatewayConnectionsCard",(function(){return j}));var r,o,a,i=n(245),s=n(7699),l=n(7701),c=n(1090),p=n(2903),u=n(7798),d=n(7812),m=n(7705),g=n(7768),h=n(7755),b=n(7778),f=n(217),y=n(7708);!function(e){e.icon="icon",e.displayName="displayName",e.creatorEmail="creatorEmail",e.status="status"}(a||(a={}));var S,C=3;!function(e){e[e.iconColumn=32]="iconColumn",e[e.displayNameColumnMin=100]="displayNameColumnMin",e[e.displayNameColumnMax=300]="displayNameColumnMax",e[e.creatorEmailMin=150]="creatorEmailMin",e[e.creatorEmailMax=170]="creatorEmailMax",e[e.status=16]="status"}(S||(S={}));var v,w,O,P,E,A,j=Object(s.observer)((o=class extends i.Component{constructor(e){super(e),this.getClassNames=Object(p.classNamesFunction)(),this.gatewayConnectionsCardScenario=void 0,this.renderBody=()=>i.createElement(g.ConnectionDetailsList,{connectionCollection:m.ConnectionsStore.getGatewayCollectionKey(this.props.gatewayDetailsPageStore.gatewayName,Object(b.getCurrentEnvironmentName)()),loadConnectionsCallback:this.onLoadConnections,maxVisibleConnections:C,resourceStrings:{connectionFieldName:this.resourceStrings.connectionsCard.connectionFieldName,iconFieldName:this.resourceStrings.connectionsCard.iconFieldName,moreConnectionsText:this.resourceStrings.connectionsCard.moreConnections,noConnectionsText:this.resourceStrings.connectionsCard.noConnections,ownerFieldName:this.resourceStrings.connectionsCard.ownerFieldName,statusFieldName:this.resourceStrings.connectionsCard.statusFieldName}}),this.renderTitle=()=>i.createElement(i.Fragment,null,this.resourceStrings.connectionsCard.title),this.renderTitleLink=()=>{var e=this.resourceStrings.common.seeAll;return i.createElement(c.Link,{"aria-label":e,onClick:this.seeAllConnectionsOnClick},e)},this.onLoadConnections=()=>{h.gatewayService.loadGatewayConnections(this.props.gatewayDetailsPageStore.gatewayName).then(()=>{this.gatewayConnectionsCardScenario.complete(),this.props.onLoad()}).catch(e=>{this.gatewayConnectionsCardScenario.failure(e),this.props.onLoadError(e)})},this.seeAllConnectionsOnClick=()=>{Object(f.trackUserActionClickLink)(y.gatewayDetailsEventScope,"gatewayConnectionsCard/seeAll",Object(y.getGatewayDetailsEventData)(this.props.gatewayDetailsPageStore)),h.gatewayService.showAllConnectionsUI({gatewayName:this.props.gatewayDetailsPageStore.gatewayName,resourceStrings:{bodyText:this.resourceStrings.connectionsPanel.bodyText,closeButtonAriaLabel:this.resourceStrings.connectionsPanel.closeButtonAriaLabel,closeButtonText:this.resourceStrings.common.close,connectionsLinkText:this.resourceStrings.connectionsPanel.connectionsLinkText,title:this.resourceStrings.connectionsPanel.title,connectionDetailsListResourceStrings:{connectionFieldName:this.resourceStrings.connectionsCard.connectionFieldName,iconFieldName:this.resourceStrings.connectionsCard.iconFieldName,moreConnectionsText:this.resourceStrings.connectionsCard.moreConnections,noConnectionsText:this.resourceStrings.connectionsCard.noConnections,ownerFieldName:this.resourceStrings.connectionsCard.ownerFieldName,statusFieldName:this.resourceStrings.connectionsCard.statusFieldName}}})},this.gatewayConnectionsCardScenario=Object(f.trackLoadScenario)(y.gatewayDetailsEventScope,"gatewayConnectionsCard",{gatewayName:this.props.gatewayDetailsPageStore.gatewayName})}render(){var e=this.getClassNames(d.getGatewayConnectionsCardStyles);return i.createElement(u.DetailsCard,{ariaLabelLoading:this.resourceStrings.common.loading,className:e.root,isLoading:this.isLoading,renderTitle:this.renderTitle,renderTitleLink:this.renderTitleLink,renderBody:this.renderBody})}get isLoading(){return this.props.gatewayDetailsPageStore.isLoadingGatewayConnections}get resourceStrings(){return this.props.gatewayDetailsPageStore.resourceStrings}},v=o.prototype,w="isLoading",O=[l.computed],P=Object.getOwnPropertyDescriptor(o.prototype,"isLoading"),E=o.prototype,A={},Object.keys(P).forEach((function(e){A[e]=P[e]})),A.enumerable=!!A.enumerable,A.configurable=!!A.configurable,("value"in A||A.initializer)&&(A.writable=!0),A=O.slice().reverse().reduce((function(e,t){return t(v,w,e)||e}),A),E&&void 0!==A.initializer&&(A.value=A.initializer?A.initializer.call(E):void 0,A.initializer=void 0),void 0===A.initializer&&(Object.defineProperty(v,w,A),A=null),r=o))||r},7812:function(e,t,n){"use strict";n.r(t),n.d(t,"getGatewayConnectionsCardStyles",(function(){return r}));var r=()=>({root:["ms-ConnectionsCard",{selectors:{".ms-Shimmer-container":{overflow:"hidden"}}}]})},7813:function(e,t,n){"use strict";n.r(t),n.d(t,"GatewayDetailsCard",(function(){return g}));var r,o=n(245),a=n(7699),i=n(1090),s=n(7798),l=n(7814),c=n(7816),p=n(7817),u=n(7818),d=n(217),m=n(7708),g=Object(a.observer)(r=class extends o.Component{constructor(e){super(e),this.gatewayDetailsCardScenario=void 0,this.renderBody=()=>!this.props.gatewayDetailsPageStore.isLoadingGateway&&o.createElement("div",{className:"ms-Grid",dir:"ltr"},o.createElement("div",{className:"ms-Grid-row"},o.createElement("div",{className:"ms-Grid-col ms-lg6 ms-sm12"},this.renderDisplayNameSection(),this.renderStatusSection(),this.renderUIFlowAppStatusSection()),o.createElement("div",{className:"ms-Grid-col ms-lg6 ms-sm12"},this.renderOwnerSection(),this.renderGatewaysClusterSection(),this.renderDistributionSection()))),this.renderTitle=()=>o.createElement(o.Fragment,null,this.resources.detailsCard.title),this.renderDisplayNameSection=()=>o.createElement(l.DetailsCardSection,{titleText:this.resources.detailsCard.nameLabel},o.createElement("div",null,this.props.gatewayDetailsPageStore.gateway.displayName)),this.renderStatusSection=()=>{var{gatewayDetailsPageStore:e}=this.props;return o.createElement(l.DetailsCardSection,{titleText:this.resources.detailsCard.gatewayStatusLabel},o.createElement(u.GatewayStatusSection,{gatewayName:e.gatewayName,loadingText:e.resourceStrings.common.loading,offlineText:e.resourceStrings.common.offline,onlineText:e.resourceStrings.common.online}),o.createElement(c.VersionStatusString,{gatewayDetailsPageStore:e}))},this.renderUIFlowAppStatusSection=()=>null,this.renderOwnerSection=()=>o.createElement(l.DetailsCardSection,{titleText:this.resources.detailsCard.ownerLabel},o.createElement("div",null,this.props.gatewayDetailsPageStore.gateway.contactInformation)),this.renderGatewaysClusterSection=()=>this.props.gatewayDetailsPageStore.gateway.isCluster?null:o.createElement(l.DetailsCardSection,{titleText:this.resources.detailsCard.gatewayClusterLabel},o.createElement("div",null,o.createElement(i.Link,{href:"https://aka.ms/gatewayclusters",target:"_blank",onClick:this.onGatewayClustersLinkClick},this.resources.detailsCard.gatewayClusterLinkText))),this.renderDistributionSection=()=>this.props.gatewayDetailsPageStore.gateway.isCluster&&o.createElement(p.DistributionSection,{gatewayDetailsPageStore:this.props.gatewayDetailsPageStore}),this.onGatewayClustersLinkClick=()=>{Object(d.trackUserActionClickLink)(m.gatewayDetailsEventScope,"gatewayDetailsCard/clustersSection/onGatewayClusters",Object(m.getGatewayDetailsEventData)(this.props.gatewayDetailsPageStore))},this.gatewayDetailsCardScenario=Object(d.trackLoadScenario)(m.gatewayDetailsEventScope,"gatewayDetailsCard",{gatewayName:this.props.gatewayDetailsPageStore.gatewayName})}render(){return o.createElement(s.DetailsCard,{ariaLabelLoading:this.props.gatewayDetailsPageStore.resourceStrings.common.loading,isLoading:this.props.gatewayDetailsPageStore.isLoadingGateway,renderTitle:this.renderTitle,renderBody:this.renderBody})}componentDidMount(){this.gatewayDetailsCardScenario.complete(),this.props.onLoad()}get resources(){return this.props.gatewayDetailsPageStore.resourceStrings}})||r},7814:function(e,t,n){"use strict";n.r(t),n.d(t,"DetailsCardSection",(function(){return i}));var r=n(245),o=n(2903),a=n(7815);class i extends r.Component{constructor(){super(...arguments),this.getClassNames=Object(o.classNamesFunction)()}render(){var{className:e,titleText:t}=this.props,n=this.getClassNames(a.getDetailsCardSectionStyles);return r.createElement("div",{className:Object(o.css)(n.root,e)},t&&r.createElement("div",{className:n.title,role:"heading","aria-level":4},t),r.createElement("div",{className:n.body},this.props.children))}}},7815:function(e,t,n){"use strict";n.r(t),n.d(t,"getDetailsCardSectionStyles",(function(){return o}));var r=n(3328),o=e=>({root:["ba-DetailsCard-Section",{paddingBottom:15,fontSize:r.FontSizes.small}],title:["ba-DetailsCard-Section-Title",{fontWeight:r.FontWeights.semibold,textOverflow:"ellipsis",overflow:"hidden",paddingRight:15}],body:["ba-DetailsCard-Section-Body",{fontSize:r.FontSizes.medium,textOverflow:"ellipsis",overflow:"hidden",lineHeight:20,padding:2}]})},7816:function(e,t,n){"use strict";n.r(t),n.d(t,"VersionStatusString",(function(){return m}));var r,o=n(245),a=n(7699),i=n(2869),s=n(1090),l=n(5481),c=n(2880),p=n(7534),u=n(7708),d=n(217),m=Object(a.observer)(r=class extends o.Component{constructor(){super(...arguments),this.resources=Object(i.getResources)(),this.onUpdateGatewayLinkClick=()=>{Object(d.trackUserActionClickLink)(u.gatewayDetailsEventScope,"gatewayDetailsCard/versionStatus/updateGateway",Object(u.getGatewayDetailsEventData)(this.props.gatewayDetailsPageStore))}}render(){return o.createElement("span",{style:{verticalAlign:"top"}}," | ",this.getVersionStatusString())}getVersionStatusString(){var{gatewayDetailsPageStore:e}=this.props;switch(e.gateway.versionStatus){case p.VersionStatus.Latest:return Object(c.formatResourceStringAsLinks)(this.resources.Common.VersionStatus.latest,[]);case p.VersionStatus.UpdateAvailable:return Object(c.formatResourceStringAsLinks)(this.resources.Common.VersionStatus.updateAvailable,[l.default.updateGateway]);case p.VersionStatus.SupportedUntilDate:return Object(c.formatResourceStringToElement)(this.resources.Common.VersionStatus.supportedUntilDate,(t,n)=>0===n?e.gateway.expirationDate:1===n?o.createElement(s.Link,{href:l.default.updateGateway,target:"_blank",onClick:this.onUpdateGatewayLinkClick},t):void 0);case p.VersionStatus.NotSupported:return Object(c.formatResourceStringAsLinks)(this.resources.Common.VersionStatus.notSupported,[l.default.updateGateway]);default:return Object(c.formatResourceStringAsLinks)("Unknown",[])}}})||r},7817:function(e,t,n){"use strict";n.r(t),n.d(t,"DistributionSection",(function(){return g}));var r,o=n(245),a=n(7699),i=n(7814),s=n(7705),l=n(1864),c=n(7755),p=n(5768),u=n(1697),d=n(7708),m=n(217),g=Object(a.observer)(r=class extends o.Component{constructor(){super(...arguments),this.toggleLoadBalance=()=>{var{gateway:{isGatewayLoadBalanced:e,name:t}}=this.props.gatewayDetailsPageStore;c.gatewayService.updateIsLoadBalanced(t,!e).catch(e=>{var t=Object(p.getResponseErrorMessage)(e);this.props.gatewayDetailsPageStore.setMessageBarProps({ariaLabel:t,type:u.MessageBarType.error,onRenderBody:()=>t,onDismiss:()=>this.props.gatewayDetailsPageStore.setMessageBarProps(null)})}),Object(m.trackUserActionClickButton)(d.gatewayDetailsEventScope,"gatewayDetailsCard/Distribution/Toggle",Object(d.getGatewayDetailsEventData)(this.props.gatewayDetailsPageStore))}}render(){var{gateway:{isGatewayLoadBalanced:e,name:t},resourceStrings:n}=this.props.gatewayDetailsPageStore;return o.createElement(i.DetailsCardSection,{titleText:n.detailsCard.distributionLabel},o.createElement(l.Toggle,{ariaLabel:n.detailsCard.distributionLabel,checked:!!e,onText:n.detailsCard.distributionOnText,offText:n.detailsCard.distributionOffText,onChange:this.toggleLoadBalance,disabled:s.gatewaysStore.gateways.isEntityLoading(t)}))}})||r},7818:function(e,t,n){"use strict";n.r(t),n.d(t,"GatewayStatusSection",(function(){return g}));var r,o,a=n(245),i=n(7701),s=n(7699),l=n(7705),c=n(7755),p=n(2903),u=n(7819),d=n(687);function m(e,t,n,r,o){var a={};return Object.keys(r).forEach((function(e){a[e]=r[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}var g=Object(s.observer)((m((o=class extends a.Component{constructor(){super(...arguments),this.getClassNames=Object(p.classNamesFunction)(),this.classNames=this.getClassNames(u.getGatewayStatusSectionStyles)}render(){var{hideLabel:e}=this.props,{onlineIcon:t,offlineIcon:n,label:r}=this.classNames;return this.isLoadingGatewayStatus?!e&&a.createElement("span",null,this.props.loadingText):this.gatewayStatus&&this.gatewayStatus.status&&a.createElement(a.Fragment,null,a.createElement(d.Icon,{ariaLabel:this.statusText,title:this.statusText,className:this.gatewayStatus.isOnline?t:n,iconName:this.gatewayStatus.isOnline?"Completed":"Error"}),!e&&a.createElement("span",{className:r},this.statusText))}componentDidMount(){c.gatewayService.loadGatewayStatus(this.props.gatewayName)}get statusText(){var{onlineText:e,offlineText:t}=this.props;return!this.isLoadingGatewayStatus&&this.gatewayStatus.isOnline?e:t}get gatewayStatus(){return l.gatewaysStore.gatewaysStatus.getEntity(this.props.gatewayName)}get isLoadingGatewayStatus(){var{gatewayName:e}=this.props;return!l.gatewaysStore.gatewaysStatus.hasEntity(e)||l.gatewaysStore.gatewaysStatus.isEntityFetching(e)}}).prototype,"statusText",[i.computed],Object.getOwnPropertyDescriptor(o.prototype,"statusText"),o.prototype),m(o.prototype,"gatewayStatus",[i.computed],Object.getOwnPropertyDescriptor(o.prototype,"gatewayStatus"),o.prototype),m(o.prototype,"isLoadingGatewayStatus",[i.computed],Object.getOwnPropertyDescriptor(o.prototype,"isLoadingGatewayStatus"),o.prototype),r=o))||r},7819:function(e,t,n){"use strict";n.r(t),n.d(t,"getGatewayStatusSectionStyles",(function(){return o}));var r=n(3328),o=e=>({onlineIcon:["ba-GatewayStatus-Section-Icon",{color:"#107C10",fontSize:r.FontSizes.large}],offlineIcon:["ba-GatewayStatus-Section-Icon",{color:"#A80000",fontSize:r.FontSizes.large}],label:["ba-GatewayStatus-Section-Label",{verticalAlign:"top",marginLeft:"8px"}]})},7820:function(e,t,n){"use strict";n.r(t),n.d(t,"GatewaysInClusterCard",(function(){return y}));var r,o=n(245),a=n(7699),i=n(1090),s=n(2903),l=n(7780),c=n(7798),p=n(7821),u=n(2880),d=n(7704),m=n(7708),g=n(217);function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){f(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var y=Object(a.observer)(r=class extends o.Component{constructor(e){super(e),this.getClassNames=Object(s.classNamesFunction)(),this.classNames=this.getClassNames(p.getGatewaysInClusterCardStyles),this.gatewaysInClusterCardScenario=void 0,this.renderBody=()=>o.createElement(l.GatewayClusterDetailsList,{gateway:this.props.gatewayDetailsPageStore.gateway,maxVisibleGateways:5,resourceStrings:this.detailsResources}),this.renderTitle=()=>o.createElement(o.Fragment,null,this.titleText),this.renderTitleLink=()=>{var{gatewayDetailsPageStore:{gateway:e}}=this.props;return e&&e.clusterSize>5&&o.createElement(i.Link,{"aria-label":this.resources.clusterCard.titleLinkAriaLabel,onClick:this.onAllGatwaysClick},this.resources.common.seeAll)},this.onAllGatwaysClick=()=>{var{gatewayDetailsPageStore:{gatewayName:e}}=this.props;Object(g.trackUserActionClickLink)(m.gatewayDetailsEventScope,"gatewaysInClusterCard/onAllGateways",Object(m.getGatewayDetailsEventData)(this.props.gatewayDetailsPageStore)),d.gatewayService.showAllGatewaysUI({gatewayName:e,resourceStrings:b({titleText:this.titleText,closeButtonText:this.resources.common.close},this.detailsResources)})},this.gatewaysInClusterCardScenario=Object(g.trackLoadScenario)(m.gatewayDetailsEventScope,"gatewaysInClusterCard",{gatewayName:this.props.gatewayDetailsPageStore.gatewayName})}render(){return!this.props.gatewayDetailsPageStore.isLoadingGateway&&this.props.gatewayDetailsPageStore.gateway.isCluster?o.createElement(c.DetailsCard,{className:this.classNames.root,isLoading:!1,renderTitle:this.renderTitle,renderBody:this.renderBody,renderTitleLink:this.renderTitleLink}):null}componentDidMount(){this.gatewaysInClusterCardScenario.complete()}get titleText(){return Object(u.formatResourceString)(this.resources.clusterCard.title,this.props.gatewayDetailsPageStore.gateway.clusterSize)}get detailsResources(){return{iconFieldName:this.resources.clusterCard.iconFieldName,gatewayFieldName:this.resources.clusterCard.gatewayFieldName,gatewayStatusFieldName:this.resources.clusterCard.statusFieldName,moreGatewaysText:this.resources.clusterCard.moreGateways}}get resources(){return this.props.gatewayDetailsPageStore.resourceStrings}})||r},7821:function(e,t,n){"use strict";n.r(t),n.d(t,"getGatewaysInClusterCardStyles",(function(){return r}));var r=()=>({root:["ms-GatewaysInClusterCard",{selectors:{".ms-Shimmer-container":{overflow:"hidden"},".ba-ApiIcon-icon":{padding:0}}}]})},7822:function(e,t,n){"use strict";n.r(t),n.d(t,"getGatewayDetailsPageStyles",(function(){return o}));var r=n(3328),o=()=>({root:["gatewayDetailsPage",{backgroundColor:Object(r.getTheme)().palette.neutralLighterAlt}]})},7823:function(e,t,n){"use strict";n.r(t),n.d(t,"GatewayDetailsPageHeader",(function(){return v}));var r,o,a=n(245),i=n(7699),s=n(7701),l=n(4105),c=n(7824),p=n(5623),u=n(7707),d=n(217),m=n(7708);function g(){return(g=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var h,b,f,y,S,C,v=Object(i.observer)((o=class extends a.Component{constructor(){super(...arguments),this.onBreadcrumbLinkClick=()=>{Object(d.trackUserActionClickLink)(m.gatewayDetailsEventScope,"gatewayDetailsPage/header/breadcrumb",Object(m.getGatewayDetailsEventData)(this.props.gatewayDetailsPageStore))}}render(){return a.createElement(l.PageHeader,{titleBreadcrumbProps:this.breadcrumbProps})}get breadcrumbProps(){var{gatewayDetailsPageStore:{resourceStrings:e,gateway:t}}=this.props;return{onRenderItem:e=>a.createElement(c.BreadcrumbLink,g({},e,{onClick:this.onBreadcrumbLinkClick})),items:[{key:"gateways",text:e.breadCrumbs.gateways,href:Object(p.getGatewaysListLaunchUri)(Object(u.getCurrentEnvironmentName)())},...t?[{key:"gatewayDetails",text:this.props.gatewayDetailsPageStore.gateway.displayName,isCurrentItem:!0}]:[]]}}},h=o.prototype,b="breadcrumbProps",f=[s.computed],y=Object.getOwnPropertyDescriptor(o.prototype,"breadcrumbProps"),S=o.prototype,C={},Object.keys(y).forEach((function(e){C[e]=y[e]})),C.enumerable=!!C.enumerable,C.configurable=!!C.configurable,("value"in C||C.initializer)&&(C.writable=!0),C=f.slice().reverse().reduce((function(e,t){return t(h,b,e)||e}),C),S&&void 0!==C.initializer&&(C.value=C.initializer?C.initializer.call(S):void 0,C.initializer=void 0),void 0===C.initializer&&(Object.defineProperty(h,b,C),C=null),r=o))||r},7824:function(e,t,n){"use strict";n.r(t),n.d(t,"BreadcrumbLink",(function(){return s}));var r=n(245),o=n(303),a=n(2903),i=n(7825);class s extends r.Component{constructor(){super(...arguments),this.getClassNames=Object(a.classNamesFunction)(),this.classNames=this.getClassNames(i.getBreadcrumbLinkStyles)}render(){var{href:e,isCurrentItem:t,key:n,onClick:i,text:s}=this.props,l=Object(a.css)("ms-Link","ms-Breadcrumb-itemLink",this.classNames.root,t?void 0:this.classNames.highlight);return t?r.createElement("div",{className:l,key:n},s):r.createElement(o.Link,{className:l,key:n,to:e,onClick:i},s)}}},7825:function(e,t,n){"use strict";n.r(t),n.d(t,"getBreadcrumbLinkStyles",(function(){return o}));var r=n(3328),o=()=>{var e=Object(r.getTheme)().palette;return{highlight:["ba-BreadcrumbLink-highlight",{selectors:{"&:hover, &:active":{color:"initial",backgroundColor:e.neutralLighter},"&:focus":{border:"1px solid ".concat(e.black)}}}],root:["ba-BreadcrumbLink",{fontSize:r.FontSizes.large,padding:8,textDecoration:"unset"}]}}},7826:function(e,t,n){"use strict";n.r(t),n.d(t,"GatewayDetailsCommandBar",(function(){return h}));var r=n(245),o=n(7699),a=n(7701),i=n(1222),s=n(7755),l=n(1697),c=n(5437),p=n(7529),u=n(5768),d=n(1089),m=n(217),g=n(7708),h=Object(o.observer)(e=>{var t=Object(c.useDispatch)(),n=Object(a.computed)(()=>{var{gatewayDetailsPageStore:n}=e;return{items:[{iconProps:{iconName:"Share"},key:"share",name:n.resourceStrings.commandBar.share,disabled:n.isLoadingGateway,onClick:()=>{Object(m.trackUserActionClickButton)(g.gatewayDetailsEventScope,"commandBar/openShareModal",Object(g.getGatewayDetailsEventData)(n)),t(p.gatewaysActions.openShareGatewayModal({gateway:n.gateway.toJS()}))}},{iconProps:{iconName:"Delete"},key:"delete",name:n.resourceStrings.commandBar.delete,onClick:()=>{Object(m.trackUserActionClickButton)(g.gatewayDetailsEventScope,"commandBar/openDeleteModal",Object(g.getGatewayDetailsEventData)(n)),s.gatewayService.showDeleteUI({gatewayName:n.gatewayName,resourceStrings:{bodyText:n.resourceStrings.deleteSurface.bodyText,cancelButtonText:n.resourceStrings.deleteSurface.cancelButtonText,confirmButtonText:n.resourceStrings.deleteSurface.confirmButtonText,titleText:Object(d.formatResourceString)(n.resourceStrings.deleteSurface.titleTextTemplate,n.gateway.displayName)},onError:t=>{var n=Object(u.getResponseErrorMessage)(t);e.gatewayDetailsPageStore.setMessageBarProps({ariaLabel:n,type:l.MessageBarType.error,onRenderBody:()=>n,onDismiss:()=>e.gatewayDetailsPageStore.dismissMessageBar})},onDeleteSuccess:n.onDeleteGateway})}}]}});return r.createElement(i.CommandBarWithSearchBox,n.get())})},7827:function(e,t,n){"use strict";n.r(t),n.d(t,"GatewayDetailsMessageBar",(function(){return s}));var r,o=n(245),a=n(7699),i=n(7828),s=Object(a.observer)(r=class extends o.Component{render(){var{gatewayDetailsPageStore:{messageBarProps:e}}=this.props;return e?o.createElement(i.MessageBar,e):null}})||r},7828:function(e,t,n){"use strict";n.r(t),n.d(t,"MessageBar",(function(){return a}));var r=n(245),o=n(1697);class a extends r.PureComponent{render(){return r.createElement(o.MessageBar,{className:this.props.className,ariaLabel:this.props.ariaLabel,dismissButtonAriaLabel:this.props.dismissButtonAriaLabel,messageBarType:this.props.type,onDismiss:this.props.onDismiss,actions:this.props.actions},this.props.onRenderBody&&this.props.onRenderBody())}}},7829:function(e,t,n){"use strict";n.r(t),n.d(t,"SurfaceOverlay",(function(){return s}));var r,o=n(245),a=n(7699),i=n(7705),s=Object(a.observer)(r=class extends o.Component{render(){return o.createElement("div",{className:"fl-SurfaceOverlay"},this.renderSurfaces())}renderSurfaces(){return i.surfaceStore.visibleSurfaces.map(e=>{var{render:t,key:n}=e;return o.createElement("div",{key:n},t({dismiss:()=>{e.hideOnDismiss?e.setHidden(!0):i.surfaceStore.dismissSurface(n)},surfaceKey:n}))})}})||r},7830:function(e,t,n){"use strict";n.r(t),n.d(t,"DesktopFlowMachineMigrationMessageBar",(function(){return g}));var r,o=n(245),a=n(7699),i=n(7828),s=n(1697),l=n(1090),c=n(2869),p=n(5481),u=n(7831),d=n(2903),m=n(2871),g=Object(a.observer)(r=class extends o.Component{constructor(){super(...arguments),this.resources=Object(c.getResources)(),this.getClassNames=Object(d.classNamesFunction)(),this.classNames=this.getClassNames(u.getStyles),this.renderBody=()=>o.createElement(o.Fragment,null,o.createElement("b",null,this.resources.UIFlows.DesktopFlowMachineMigrationMessageBar.mainText)," ",this.resources.UIFlows.DesktopFlowMachineMigrationMessageBar.secondaryText,o.createElement(l.Link,{href:p.default.desktopFlowMachineMigrationLink,target:"_blank",underline:!0},this.resources.UIFlows.DesktopFlowMachineMigrationMessageBar.learnMore))}render(){var{gatewayDetailsPageStore:{hasUIFlowConnection:e}}=this.props;return m.featureGates.showDesktopFlowMachineMigrationMessageBarInGWPage&&e?o.createElement(i.MessageBar,{ariaLabel:this.resources.UIFlows.DesktopFlowMachineMigrationMessageBar.ariaLabel,type:s.MessageBarType.info,onRenderBody:this.renderBody,className:this.classNames.root}):null}})||r},7831:function(e,t,n){"use strict";n.r(t),n.d(t,"getStyles",(function(){return r}));var r=()=>({root:[".ms-MessageBar",{backgroundColor:"#E6F0FF"}]})},7832:function(e,t,n){"use strict";n.r(t),n.d(t,"mapStateToProps",(function(){return S})),n.d(t,"mapDispatchToProps",(function(){return C})),n.d(t,"mergeProps",(function(){return v})),n.d(t,"GatewayManagementPageContainer",(function(){return w}));var r=n(5437),o=n(7833),a=n(7537),i=n(6867),s=n(5623),l=n(5629),c=n(7536),p=n(5669),u=n(5583),d=n(5487),m=["fetchGateway"];function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){b(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function b(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function f(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function y(e){return e&&e.match&&e.match.params&&e.match.params.gatewayId||""}function S(e,t){var n=t&&t.match&&t.match.params&&t.match.params.drillInTab||"",r=function(e){var t=y(e);return s.getGatewayClusterId(t)}(t),o=Object(a.gatewaySelector)(e,r),i=Object(a.gatewayError)(e,r);return{gateway:o,selectedPivot:n,errorMessage:i,currentEnvironmentName:t&&t.match&&t.match.params&&t.match.params.environmentName,loadProgress:[Object(l.toLoadingState)(!!o,i)],logEvent:c.GatewayLoadEvent}}var C=(e,t)=>({onHeaderClick:()=>t.navigate(s.gatewaysRoute,!0),fetchGateway:t=>{e(Object(i.fetchGatewayRequest)({gatewayId:t}))},onDismount:()=>{e(Object(i.fetchGatewayCancelPoll)())},dispatchTelemetry:e}),v=(e,t,n)=>{var{fetchGateway:r}=t,o=f(t,m),{areShellProvidersReady:a}=n.rootProps;return h(h(h({onMount:()=>{r(y(n))}},e),o),{},{areShellProvidersReady:a})},w=Object(d.withRootProps)(Object(u.withNavigation)(Object(r.connect)(S,C,v)(Object(l.withLoadTelemetry)(o.GatewayManagementPage,p.LoadScenarioNames.GatewayManagementPage))))},7833:function(e,t,n){"use strict";n.r(t),n.d(t,"GatewayManagementPage",(function(){return h}));var r=n(4792),o=n(1201),a=n(1294),i=n(245),s=n(303),l=n(1200),c=n(5629),p=n(3831),u=n(2869),d=n(5623),m=n(7834),g=n(7840);class h extends i.Component{constructor(e){super(e),this.breadCrumbItems=void 0,this.resources=void 0,this.resources=Object(u.getResources)(),this.state={searchFilter:""}}componentDidMount(){this.props.onMount()}componentWillUnmount(){this.props.onDismount()}onSearchFilterUpdate(e){this.setState({searchFilter:e})}render(){if(!this.props.areShellProvidersReady)return i.createElement(l.PagePlaceholder,null);switch(Object(c.getTotalLoadingState)(this.props.loadProgress)){case c.ComponentLoadState.Complete:return this.initializeBreadCrumbItems(this.props.gateway),i.createElement(r.Page,{className:"gateway-management-page",renderTitle:()=>i.createElement(a.Breadcrumb,{items:this.breadCrumbItems,className:"gateway-management-page-breadcrumb"}),renderHeader:()=>i.createElement(m.GatewayManagementCommandBarContainer,{gateway:this.props.gateway,selectedPivot:this.props.selectedPivot,onSearchFilterUpdate:this.onSearchFilterUpdate.bind(this)}),renderBody:()=>i.createElement(g.GatewayManagementPivotsContainer,{selectedGateway:this.props.gateway,selectedPivot:this.props.selectedPivot})});case c.ComponentLoadState.Fail:var e={fromPattern:p.RoutePaths.gatewaysManagement,toPattern:p.RoutePaths.gateways,toFriendlyRouteName:p.FriendlyRouteNames.gateways};return i.createElement(s.Redirect,{push:!0,to:{pathname:Object(d.getGatewaysListLaunchUri)(this.props.currentEnvironmentName),state:e}});default:return i.createElement("div",{className:"gateway-management-page"},i.createElement("div",{className:"gateway-management-page-spinner"},i.createElement(o.Spinner,{size:o.SpinnerSize.large})))}}initializeBreadCrumbItems(e){this.breadCrumbItems=[],this.breadCrumbItems.push({text:this.resources.Common.gateways,key:this.resources.Common.gateways,onClick:()=>{this.props.onHeaderClick()}}),this.breadCrumbItems.push({text:e.properties.displayName,key:e.id})}}},7834:function(e,t,n){"use strict";n.r(t),n.d(t,"mapDispatchToProps",(function(){return m})),n.d(t,"mergeProps",(function(){return h})),n.d(t,"GatewayManagementCommandBarContainer",(function(){return b}));var r=n(1222),o=n(5437),a=n(6607),i=n(5630),s=n(5623),l=n(7529),c=n(7835),p=n(7536),u=n(7836),d=n(5583),m=(e,t)=>{var{navigate:n}=t;return{gatewayCommandActions:{onGatewayCreateClick:()=>e(Object(i.logAction)(l.gatewaysActions.createGateway(),p.GatewaysManagementCommandBarEvents.New.eventName)),onGatewayDeleteClick:t=>e(Object(i.logAction)(l.gatewaysActions.openDeleteGatewayDialogue({gateway:t,redirectUrl:s.gatewaysRoute,navigate:n}),p.GatewaysManagementCommandBarEvents.Delete.eventName,p.GatewaysManagementCommandBarEvents.Delete.getData(t))),onGatewayShareClick:t=>e(l.gatewaysActions.openShareGatewayModal({gateway:t}))}}};function g(e){return e.selectedPivot===u.GatewayManagementPivotNames.connections}var h=(e,t,n)=>{var r=n.gateway;return{items:Object(c.getGatewayCommandBarCommands)(t.gatewayCommandActions,null,r,!0),isSearchBoxVisible:g(n),searchBoxProps:Object(a.getSearchBoxProps)(n.onSearchFilterUpdate)}},b=Object(d.withNavigation)(Object(o.connect)(null,m,h)(r.CommandBarWithSearchBox))},7835:function(e,t,n){"use strict";n.r(t),n.d(t,"getGatewayCommandBarCommands",(function(){return c})),n.d(t,"getGatewayContextMenuCommands",(function(){return p}));var r=n(777),o=n(5637),a=n(5617),i=n(2879),s=n(2869);function l(e,t,n,r){return[u.ShareGateway(e,t),u.DeleteGateway(e,t),r&&n&&u.Divider(),n&&u.GatewayDetails(e,t)].filter(e=>!!e)}function c(e,t,n,r){if(n){var o=l(e,n,!r,!1);return r?o:[u.CreateGateway(e,t),...o]}return function(e,t){return[u.CreateGateway(e,t)]}(e,t)}function p(e,t){return l(e,t,!0,!0)}var u={Divider:()=>({key:"divider",itemType:r.ContextualMenuItemType.Divider}),CreateGateway:(e,t)=>({key:"CreateGateway",name:Object(s.getResources)().Controllers.Gateways.addButton,onClick:e.onGatewayCreateClick,disabled:!t,iconProps:{iconName:i.fabricIcons.Add,style:{color:a.fabricTheme.palette.themePrimary}}}),ShareGateway:(e,t)=>({key:"ShareGateway",name:Object(s.getResources)().Common.share,disabled:!Object(o.canUserShareResource)(t),onClick:()=>{e.onGatewayShareClick(t)},iconProps:{iconName:i.fabricIcons.Share,style:{color:a.fabricTheme.palette.themePrimary}}}),DeleteGateway:(e,t)=>({key:"DeleteGateway",name:Object(s.getResources)().Common.delete,onClick:()=>{e.onGatewayDeleteClick(t)},iconProps:{iconName:i.fabricIcons.Delete,style:{color:a.fabricTheme.palette.themePrimary}}}),GatewayDetails:(e,t)=>({key:"GatewayDetails",name:Object(s.getResources)().Common.details,onClick:()=>{e.onGatewayDetailsClick(t)},iconProps:{iconName:i.fabricIcons.Info,style:{color:a.fabricTheme.palette.themePrimary}}})}},7836:function(e,t,n){"use strict";n.r(t),n.d(t,"GatewayManagementPivotNames",(function(){return l})),n.d(t,"GatewayManagementPivots",(function(){return c}));var r=n(1709),o=n(245),a=n(2869),i=n(7837),s=n(7838),l={details:"details",connections:"connections",share:"share"};class c extends o.Component{constructor(e){super(e),this.resources=void 0,this._onLinkClick=(e,t)=>{var n=e.props.itemKey;this.props.onPivotClick(n)},this.resources=Object(a.getResources)()}render(){var e=this.sanitizePivot(this.props.selectedPivot);return o.createElement("div",{className:"gateway-management-page-pivots"},o.createElement(r.Pivot,{defaultSelectedKey:e,onLinkClick:this._onLinkClick},o.createElement(r.PivotItem,{linkText:this.resources.Common.details,itemKey:l.details},o.createElement(s.GatewayDetailsContainer,{gateway:this.props.gateway})),o.createElement(r.PivotItem,{linkText:this.resources.Common.connections,itemKey:l.connections},o.createElement(i.GatewayConnectionsListContainer,{gatewayName:this.props.gateway.name}))))}sanitizePivot(e){switch(e){case l.connections:case l.details:return e;default:return l.details}}}},7837:function(e,t,n){"use strict";n.r(t),n.d(t,"mapStateToProps",(function(){return L})),n.d(t,"mapDispatchToProps",(function(){return T})),n.d(t,"mergeProps",(function(){return k})),n.d(t,"GatewayConnectionsListContainer",(function(){return R}));var r=n(5437),o=n(5487),a=n(5803),i=n(5804),s=n(5629),l=n(7628),c=n(2879),p=n(5481),u=n(2869),d=n(5796),m=n(5807),g=n(7509),h=n(6867),b=n(7537),f=n(5582),y=n(7629),S=n(7536),C=n(5669),v=n(5583),w=["connections","apis"];function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function P(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach((function(t){E(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function E(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function A(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function j(e,t){var n=Object(u.getResources)();return{usageResourcesListItems:e&&e.map(e=>function(e,t){if(null===e)return null;var n=i.getConnectionApi(e,t),r=n?a.getDisplayName(n):i.getConnectionApiName(e),o={key:e.id,id:e.id,title:i.getDisplayName(e),subtitle:r,imageUrl:i.getIcon(e),usageResource:e};return o.filterOn=[o.title,o.subtitle],o}(e,t)),emptyPrimaryMessage:n.Gateways.GatewayManagement.Connections.Empty.primaryMessage,emptySecondaryMessage:n.Gateways.GatewayManagement.Connections.Empty.secondaryMessage,emptyIcon:c.fabricIcons.Globe,emptyLink:p.default.helpAddConnectionToApp}}function L(e,t){var n=Object(f.currentEnvironmentIdSelector)(t),r=b.gatewayConnectionsError(e);return{errorMessage:r,loadProgress:[Object(s.toLoadingState)(b.isGatewayConnectionsCachedComplete(e,t.gatewayName),r)],logEvent:S.GatewayConnectionsLoadEvent,connections:b.gatewayConnections(e,t.gatewayName),apis:m.apisSelectorForCurrentEnv(e,n)}}function T(e,t){var{navigate:n}=t;return{onResourceListItemClick:t=>e(g.connectionsActions.openConnectionPivot({connection:t.usageResource,selectedPivot:y.ConnectionManagementPivotNames.details,navigate:n})),onMount:()=>{e(Object(d.fetchApisRequest)()),e(Object(h.fetchGatewayConnectionsRequest)({gatewayId:t.gatewayName}))},onDismount:()=>{e(Object(d.fetchApisCancelPoll)())},dispatchTelemetry:e}}function k(e,t,n){var{connections:r,apis:o}=e,a=A(e,w),i=j(r,o);return P(P(P(P({},a),t),i),{},{searchFilter:""})}var R=Object(v.withNavigation)(Object(o.withRootProps)(Object(r.connect)(L,T,k)(Object(s.withLoadTelemetry)(l.UsageResourcesList,C.LoadScenarioNames.GatewayUsagesList))))},7838:function(e,t,n){"use strict";n.r(t),n.d(t,"mapStateToProps",(function(){return c})),n.d(t,"GatewayDetailsContainer",(function(){return p}));var r=n(5437),o=n(5471),a=n(7534),i=n(6867),s=n(7839),l=n(7537);function c(e,t){var{gateway:n}=t;return{gatewayStatus:Object(l.gatewayStatusSelector)(e),versionStatus:Object(a.getVersionStatus)(n),expirationDate:Object(a.getExpirationDate)(n),description:Object(a.getDescription)(n),contactInfo:Object(a.getContactInformation)(n),gatewayId:Object(o.parseId)(n).gatewayClusters,isGatewayHighAvailable:Object(a.getLoadBalancingSettings)(n)}}var p=Object(r.connect)(c,e=>({enableHighAvailability:t=>e(Object(i.PatchGatewayRequest)(t)),disableHighAvailability:t=>e(Object(i.PatchGatewayRequest)(t))}),void 0)(s.GatewayDetails)},7839:function(e,t,n){"use strict";n.r(t),n.d(t,"GatewayClusterState",(function(){return r})),n.d(t,"GatewayDetails",(function(){return m}));var r,o=n(684),a=n(1362),i=n(1090),s=n(245),l=n(7601),c=n(2869),p=n(5481),u=n(2880),d=n(7534);!function(e){e[e.ON=1]="ON",e[e.OFF=0]="OFF"}(r||(r={}));class m extends s.Component{constructor(e){super(e),this.resources=void 0,this.resources=Object(c.getResources)(),this.state={isHighAvailabilityChecked:this.props.isGatewayHighAvailable,isDisabled:!0},this.onChangeCheckBox=this.onChangeCheckBox.bind(this)}onChangeCheckBox(){this.setState({isHighAvailabilityChecked:!this.state.isHighAvailabilityChecked,isDisabled:!this.state.isDisabled})}render(){var e=this.props.gatewayStatus||this.resources.Common.Loading.ellipses,t=this.props.gatewayId,n=this.state.isHighAvailabilityChecked?{gatewayId:t,state:r.ON}:{gatewayId:t,state:r.OFF},i=this.getVersionStatusString(this.props.versionStatus);return s.createElement("div",null,s.createElement(l.ResourceDetailList,{detailsProps:[{title:this.resources.Common.status,content:e},{title:this.resources.Common.versionStatus,content:i},{title:this.resources.Common.description,content:this.props.description},{title:this.resources.Common.contactInfo,content:this.props.contactInfo}]}),s.createElement("div",null,s.createElement(a.Checkbox,{name:"onOff",styles:{root:{margin:"8px",fontSize:"14px"},label:{fontWeight:"normal",maxWidth:"unset"}},label:this.resources.Common.Gateway.Cluster,checked:!!this.state.isHighAvailabilityChecked,onChange:this.onChangeCheckBox})),s.createElement("div",null,s.createElement(o.PrimaryButton,{text:this.resources.Common.apply,disabled:this.state.isDisabled,checked:this.state.isDisabled,onClick:()=>{this.state.isHighAvailabilityChecked?this.props.enableHighAvailability(n):this.props.disableHighAvailability(n),this.setState({isDisabled:!this.state.isDisabled})},styles:{root:{border:"2px",paddingTop:"6px",paddingRight:"18px",paddingBottom:"6px",paddingLeft:"18px",height:"32px",marginTop:"20px",marginLeft:"8px"},label:{fontSize:"12px",lineHeight:"14px"}}}),s.createElement(o.DefaultButton,{text:this.resources.Common.discard,disabled:this.state.isDisabled,checked:this.state.isDisabled,onClick:this.onChangeCheckBox,styles:{root:{paddingTop:"6px",paddingRight:"18px",paddingBottom:"6px",paddingLeft:"18px",height:"32px",border:"2px",marginTop:"20px",marginLeft:"4px"},label:{fontSize:"12px",lineHeight:"14px"}}})))}getVersionStatusString(e){switch(e){case d.VersionStatus.Latest:return Object(u.formatResourceStringAsLinks)(this.resources.Common.VersionStatus.latest,[]);case d.VersionStatus.UpdateAvailable:return Object(u.formatResourceStringAsLinks)(this.resources.Common.VersionStatus.updateAvailable,[p.default.updateGateway]);case d.VersionStatus.SupportedUntilDate:return Object(u.formatResourceStringToElement)(this.resources.Common.VersionStatus.supportedUntilDate,(e,t)=>0===t?this.props.expirationDate:1===t?s.createElement(i.Link,{href:p.default.updateGateway,target:"_blank"},e):void 0);case d.VersionStatus.NotSupported:return Object(u.formatResourceStringAsLinks)(this.resources.Common.VersionStatus.notSupported,[p.default.updateGateway]);default:return Object(u.formatResourceStringAsLinks)("Unknown",[])}}}},7840:function(e,t,n){"use strict";n.r(t),n.d(t,"mapDispatchToProps",(function(){return s})),n.d(t,"mergeProps",(function(){return l})),n.d(t,"GatewayManagementPivotsContainer",(function(){return c}));var r=n(5437),o=n(5623),a=n(7836),i=n(5583),s=(e,t)=>({navigate:e=>t.navigate(e,!0)}),l=(e,t,n)=>({gateway:n.selectedGateway,selectedPivot:n.selectedPivot,onPivotClick:e=>{t.navigate(Object(o.getGatewaysSubroute)(n.selectedGateway.id,e))}}),c=Object(i.withNavigation)(Object(r.connect)(null,s,l)(a.GatewayManagementPivots))},7841:function(e,t,n){"use strict";n.r(t),n.d(t,"GatewaysListPage",(function(){return m}));var r=n(4792),o=n(245),a=n(1090),i=n(7641),s=n(2869),l=n(7842),c=n(7844),p=n(5481),u=n(2903),d=n(7845);class m extends o.Component{constructor(e){super(e),this.getClassNames=Object(u.classNamesFunction)(),this.classNames=this.getClassNames(d.getGatewaysListPageStyles),this.resources=void 0,this.onRenderBody=()=>o.createElement("div",null,o.createElement(l.GatewaysListContainer,{onGatewaySelect:this.onGatewaySelect.bind(this),searchFilter:this.state.searchFilter}),this.onRenderLearnMoreLinks(),this.onRenderTroubleshootLinks()),this.onRenderTroubleshootLinks=()=>o.createElement("div",{className:Object(u.css)(this.classNames.link,this.props.className)},o.createElement(a.Link,{href:p.default.troubleshootGatewayLink,target:"_blank"},this.resources.Gateways.GatewaysList.troubleshootMissingGateways)),this.onRenderLearnMoreLinks=()=>o.createElement("div",{className:Object(u.css)(this.classNames.link,this.props.className)},o.createElement(a.Link,{href:p.default.learnGatewayLink,target:"_blank"},this.resources.Gateways.GatewaysList.learnAboutGateways)),this.resources=Object(s.getResources)(),this.state={selectedGateway:null,searchFilter:""}}onGatewaySelect(e){this.setState({selectedGateway:e})}onSearchFilterUpdate(e){this.setState({searchFilter:e})}render(){var e=this.resources.Common.gateways;return o.createElement(r.Page,{className:Object(u.css)(this.classNames.root,this.props.className),renderHeader:()=>o.createElement(c.GatewaysListCommandBarContainer,{selectedGateway:this.state.selectedGateway,onSearchFilterUpdate:this.onSearchFilterUpdate.bind(this)}),renderTitle:()=>o.createElement(i.PageHeaderWithEnvContainer,{title:e}),renderBody:this.onRenderBody})}}},7842:function(e,t,n){"use strict";n.r(t),n.d(t,"createGatewaysRow",(function(){return S})),n.d(t,"createGatewayListItems",(function(){return C})),n.d(t,"mapStateToProps",(function(){return v})),n.d(t,"mapDispatchToProps",(function(){return w})),n.d(t,"mergeProps",(function(){return O})),n.d(t,"GatewaysListContainer",(function(){return P}));var r=n(5437),o=n(5487),a=n(5604),i=n(7534),s=n(5629),l=n(5630),c=n(7529),p=n(6867),u=n(7536),d=n(7843),m=n(5582),g=n(5669),h=n(5583);function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){y(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var S=e=>{if(null===e)return null;var t={key:e.id,id:e.id,displayName:i.getDisplayName(e),contactInformation:i.getContactInformation(e),gateway:e};return t.filterOn=[t.displayName,t.contactInformation],t},C=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.filter(e=>null!=e.properties&&"VirtualNetwork"!==e.properties.gatewayType).map(S)},v=(e,t)=>{var n=Object(m.currentEnvironmentIdSelector)(t),r=c.gatewaysSelectors.gatewaysError(e);return{gatewaysListItems:C(c.gatewaysSelectors.gatewaysSelector(e,n)),errorMessage:c.gatewaysSelectors.gatewaysError(e),areGatewaysEnabled:Object(a.areGatewaysEnabled)(t.rootProps.currentEnvironment),loadProgress:[Object(s.toLoadingState)(c.gatewaysSelectors.isGatewaysListCachedComplete(e,n),r)],logEvent:u.GatewaysListLoadEvent}},w=(e,t)=>{var{navigate:n}=t;return{onMount:()=>{e(Object(p.fetchGatewaysRequest)({forceRefresh:!0}))},onDismount:()=>e(Object(p.fetchGatewaysCancelPoll)()),gatewayCommandActions:{onGatewayCreateClick:()=>e(Object(l.logAction)(c.gatewaysActions.createGateway(),u.GatewaysListMenuEvents.New.eventName)),onGatewayDetailsClick:t=>e(Object(l.logAction)(c.gatewaysActions.openGatewayDetails({gateway:t,navigate:n}),u.GatewaysListMenuEvents.Details.eventName,u.GatewaysListMenuEvents.Details.getData(t))),onGatewayDeleteClick:t=>e(Object(l.logActionStart)(c.gatewaysActions.openDeleteGatewayDialogue({gateway:t,navigate:n}),u.GatewaysListMenuEvents.Delete.eventName,u.GatewaysListMenuEvents.Details.getData(t))),onGatewayShareClick:t=>e(Object(l.logAction)(c.gatewaysActions.openShareGatewayModal({gateway:t}),u.GatewaysListMenuEvents.Share.eventName,u.GatewaysListMenuEvents.Details.getData(t)))},onLearnMoreClick:()=>{e(Object(l.logAction)(c.gatewaysActions.openGatewayHelp(),u.GatewaysListEvents.Help.eventName))},dispatchTelemetry:e}},O=(e,t,n)=>{var{searchFilter:r,onGatewaySelect:o}=n;return f(f(f({},e),t),{},{searchFilter:r,onGatewaySelect:o})},P=Object(h.withNavigation)(Object(o.withRootProps)(Object(r.connect)(v,w,O)(Object(s.withLoadTelemetry)(d.GatewaysList,g.LoadScenarioNames.GatewaysList))))},7843:function(e,t,n){"use strict";n.r(t),n.d(t,"GatewaysList",(function(){return S}));var r=n(3064),o=n(3161),a=n(1471),i=n(545),s=n(245),l=n(7682),c=n(5628),p=n(5629),u=n(2879),d=n(5481),m=n(2869),g=n(2880),h=n(5633),b=n(7835),f=n(2870);function y(){return(y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}class S extends s.Component{constructor(e){super(e),this.resources=void 0,this.selection=void 0,this.columns=void 0,this.gatewaysListRef=void 0,this.resources=Object(m.getResources)(),this.selection=new a.Selection({onSelectionChanged:()=>{var e=this.selection.getSelection()[0];this.props.onGatewaySelect(e&&e.gateway)}}),this.columns=this.buildColumns(),this.gatewaysListRef=s.createRef()}componentDidMount(){this.props.onMount()}componentWillUnmount(){this.props.onDismount()}render(){var e;return e=s.createElement("div",{ref:this.gatewaysListRef},!f.HostSettings.getWidgetSettings().isWidgetPage&&s.createElement(l.AppVisualCue,{iconName:u.fabricIcons.custom.brush,buttonText:this.resources.Gateways.GatewaysList.VisualCue.buttonText,description:this.resources.Gateways.GatewaysList.VisualCue.description,link:d.default.connectionsLearnMoreUrl,style:{marginTop:8}}),s.createElement(r.DetailsList,y({isLoading:Object(p.isLoading)(this.props.loadProgress),renderOnEmpty:()=>{var e=this.getPropsOnEmpty();return s.createElement(o.EmptyState,e)},filter:this.props.searchFilter,renderOnEmptySearch:()=>{var e=this.getPropsOnEmptySearch();return s.createElement(o.EmptyState,e)},isError:Object(p.getTotalLoadingState)(this.props.loadProgress)===p.ComponentLoadState.Fail,renderOnError:()=>{var e=this.getPropsOnError();return s.createElement(o.EmptyState,e)},items:this.props.gatewaysListItems,columns:this.columns,setKey:"set",className:"gateways-list-container",styles:{root:{marginTop:20}},selection:this.selection,selectionMode:i.SelectionMode.single,filterAnnouncement:e=>Object(g.formatResourceString)(this.resources.Common.Search.Results,e)},Object(h.getDetailsListProps)(this.resources.Common.rowSelectionAriaLabel)))),s.createElement("div",{className:"gateways-list"},e)}getPropsOnEmpty(){return this.props.areGatewaysEnabled?{className:"gateways-list-empty-message",icon:u.fabricIcons.custom.gateways,primaryMessage:this.resources.Gateways.NoGateways.title,secondaryMessage:[this.resources.Gateways.NoGateways.message],learnMoreLabel:this.resources.Common.learnMore,learnMoreProps:{onClick:this.props.onLearnMoreClick,role:"link"},callToActionText:this.resources.Controllers.Gateways.addButton,callToActionProps:{onClick:this.props.gatewayCommandActions.onGatewayCreateClick},maxWidth:c.emptyStateMaxWidth}:{className:"gateways-list-empty-message",icon:u.fabricIcons.custom.gateways,primaryMessage:this.resources.Gateways.WrongEnvironment.title,secondaryMessage:[this.resources.Gateways.WrongEnvironment.message],learnMoreLabel:this.resources.Common.learnMore,learnMoreProps:{onClick:this.props.onLearnMoreClick,role:"link"},maxWidth:c.emptyStateMaxWidth}}getPropsOnEmptySearch(){return{icon:u.fabricIcons.custom.gateways,className:"gateways-list-empty-message",primaryMessage:this.resources.Common.Search.NoMatch.title,secondaryMessage:[this.resources.Common.Search.NoMatch.message],maxWidth:c.emptyStateMaxWidth}}getPropsOnError(){return{icon:u.fabricIcons.custom.gateways,className:"gateways-list-empty-message",title:this.resources.Common.Request.Failed,secondaryMessage:[this.props.errorMessage],maxWidth:c.emptyStateMaxWidth}}buildColumns(){var e=Object(r.buildMenuColumn)(e=>({items:Object(b.getGatewayContextMenuCommands)(this.props.gatewayCommandActions,e.gateway),iconAriaLabel:this.resources.Common.commands}));return[{key:"displayName",name:this.resources.Common.name,fieldName:"displayName",minWidth:50,maxWidth:350,isRowHeader:!0,isResizable:!0,isPadded:!0,isMultiline:!1,sortAscendingAriaLabel:this.resources.Common.Sorting.ascending,sortDescendingAriaLabel:this.resources.Common.Sorting.descending,onRender:e=>{var t={onClick:()=>{this.props.gatewayCommandActions.onGatewayDetailsClick(e.gateway)},onContextMenu:e=>(e.preventDefault(),!1)};return s.createElement(r.DetailsListLink,{linkText:e.displayName,linkProps:t})}},e,{key:"contactInformation",name:this.resources.Directives.GatewayList.Header.contactInfo,fieldName:"contactInformation",minWidth:50,maxWidth:400,isResizable:!0,isCollapsable:!0,isMultiline:!1,isPadded:!0}]}}},7844:function(e,t,n){"use strict";n.r(t),n.d(t,"mapDispatchToProps",(function(){return m})),n.d(t,"mergeProps",(function(){return g})),n.d(t,"GatewaysListCommandBarContainer",(function(){return h}));var r=n(1222),o=n(5437),a=n(5487),i=n(5604),s=n(6607),l=n(5630),c=n(7529),p=n(7536),u=n(7835),d=n(5583),m=(e,t)=>{var{navigate:n}=t;return{gatewayCommandActions:{onGatewayCreateClick:()=>e(Object(l.logAction)(c.gatewaysActions.createGateway(),p.GatewaysListCommandBarEvents.New.eventName)),onGatewayDetailsClick:t=>e(Object(l.logAction)(c.gatewaysActions.openGatewayDetails({gateway:t,navigate:n}),p.GatewaysListMenuEvents.Details.eventName,p.GatewaysListMenuEvents.Details.getData(t))),onGatewayDeleteClick:t=>e(Object(l.logActionStart)(c.gatewaysActions.openDeleteGatewayDialogue({gateway:t,navigate:n}),p.GatewaysListCommandBarEvents.Delete.eventName,p.GatewaysListMenuEvents.Details.getData(t))),onGatewayShareClick:t=>e(c.gatewaysActions.openShareGatewayModal({gateway:t}))}}},g=(e,t,n)=>{var r=Object(i.areGatewaysEnabled)(n.rootProps.currentEnvironment),o=n&&n.selectedGateway||null;return{items:Object(u.getGatewayCommandBarCommands)(t.gatewayCommandActions,r,o,!1),isSearchBoxVisible:!o,searchBoxProps:Object(s.getSearchBoxProps)(n.onSearchFilterUpdate)}},h=Object(d.withNavigation)(Object(a.withRootProps)(Object(o.connect)(null,m,g)(r.CommandBarWithSearchBox)))},7845:function(e,t,n){"use strict";n.r(t),n.d(t,"getGatewaysListPageStyles",(function(){return o}));var r=n(3328),o=e=>({root:["gateways-list-page",{selectors:{".ms-CommandBar":{paddingLeft:32},".gateways-list-page-header":{paddingBottom:10}}}],link:["gateways-list-page-link",{paddingTop:10,paddingLeft:10,selectors:{".ms-Link":{color:Object(r.getTheme)().palette.blue}}}]})},7846:function(e,t,n){"use strict";n.r(t),n.d(t,"RpaRunsListPage",(function(){return L}));var r,o,a=n(7699),i=n(7701),s=n(245),l=n(4792),c=n(7847),p=n(7755),u=n(5768),d=n(7703),m=n(7848),g=n(7849),h=n(7852),b=n(1697),f=n(2869),y=n(7754),S=n(7796),C=n(217),v=n(2871);var w,O,P,E,A,j,L=Object(a.observer)((o=class extends s.Component{constructor(e){super(e),this.rpaRunsListPageStore=void 0,this.rpaRunsListPageScenario=void 0,this.renderBody=()=>s.createElement(d.FlowRunsDetailsList,{store:this.rpaRunsListPageStore}),this.renderHeader=()=>s.createElement(h.RpaRunsListPageHeader,{rpaRunsListPageStore:this.rpaRunsListPageStore}),this.renderMessageBar=()=>s.createElement(m.RpaRunsListPageMessageBar,{rpaRunsListPageStore:this.rpaRunsListPageStore}),this.renderCommandBar=()=>s.createElement(g.RpaRunsListPageCommandBar,{rpaRunsListPageStore:this.rpaRunsListPageStore}),this.loadGateways=()=>p.gatewayService.loadGateways().then(()=>{if(this.rpaRunsListPageStore.gateway)return null;var e=this.rpaRunsListPageStore.resourceStrings.errors.gatewayNotFound;return this.rpaRunsListPageStore.setMessageBarProps({ariaLabel:e,type:b.MessageBarType.error,onRenderBody:()=>e,onDismiss:this.rpaRunsListPageStore.dismissMessageBar}),new Error(e)}).catch(e=>{var t=Object(u.getResponseErrorMessage)(e);return this.rpaRunsListPageStore.setMessageBarProps({ariaLabel:t,type:b.MessageBarType.error,onRenderBody:()=>t,onDismiss:this.rpaRunsListPageStore.dismissMessageBar}),e}),this.loadFlowRuns=()=>p.gatewayService.loadGatewayUIFlowRuns({gatewayName:this.rpaRunsListPageStore.gatewayName,status:this.rpaRunsListPageStore.runFilter,forceRefresh:!0}).then(()=>null).catch(e=>{var t=Object(u.getResponseErrorMessage)(e);return this.rpaRunsListPageStore.setMessageBarProps({ariaLabel:t,type:b.MessageBarType.error,onRenderBody:()=>t,onDismiss:this.onDismissMessageBar}),e}),this.onDismissMessageBar=()=>{var{gatewayName:e,runFilter:t}=this.rpaRunsListPageStore;Object(C.trackUserActionClickButton)(S.gatewayRunsEventScope,S.messageBarDismissEventName,{gatewayName:e,runsFilter:t}),this.rpaRunsListPageStore.dismissMessageBar()},this.rpaRunsListPageStore=new c.RpaRunsListPageStore(this.createRpaRunsListPageResources,this.props.match.params.gatewayId,this.runFilter),this.rpaRunsListPageScenario=Object(C.trackLoadScenario)(S.gatewayRunsEventScope,S.eventNameSectionPrefix,{gatewayName:this.rpaRunsListPageStore.gatewayName,runFilter:this.rpaRunsListPageStore.runFilter})}render(){return s.createElement(l.Page,{renderHeader:this.renderCommandBar,renderMessageBar:this.renderMessageBar,renderTitle:this.renderHeader,renderBody:this.renderBody,showOverlay:this.rpaRunsListPageStore.isLoadingGatewayRuns})}componentDidMount(){Promise.all([this.loadGateways(),this.loadFlowRuns()]).then(e=>{var[t,n]=e;t||n?this.rpaRunsListPageScenario.failure({status:S.Status.Failure,error:t||n,gatewayName:this.rpaRunsListPageStore.gatewayName,runsFilter:this.rpaRunsListPageStore.runFilter}):this.rpaRunsListPageScenario.complete({status:S.Status.Success,gatewayName:this.rpaRunsListPageStore.gatewayName,runsFilter:this.rpaRunsListPageStore.runFilter})})}componentDidUpdate(e){if(this.props.location.search!==e.location.search){var t=Object(C.trackLoadScenario)(S.gatewayRunsEventScope,S.eventNameSectionPrefix,{gatewayName:this.rpaRunsListPageStore.gatewayName,runFilter:this.rpaRunsListPageStore.runFilter});this.rpaRunsListPageStore.setRunFilter(this.runFilter),this.loadFlowRuns().then(e=>{e?t.failure({status:S.Status.Failure,error:e,gatewayName:this.rpaRunsListPageStore.gatewayName,runsFilter:this.rpaRunsListPageStore.runFilter}):t.complete({status:S.Status.Success,gatewayName:this.rpaRunsListPageStore.gatewayName,runsFilter:this.rpaRunsListPageStore.runFilter})})}}get createRpaRunsListPageResources(){var e=Object(f.getResources)();return{errors:{gatewayNotFound:e.Gateways.NoGateways.notFound},runsCard:{durationFieldLabel:e.UIFlows.durationLabel,noRuns:v.featureGates.renameUIFlowsForGA?e.UIFlows.Empty.gatewayNoRunsGA:e.UIFlows.Empty.gatewayNoRuns,startTimeFieldLabel:v.featureGates.renameUIFlowsForGA?e.UIFlows.requestedLabel:e.UIFlows.startTimeLabel,statusFieldLabel:e.Common.status,runHistoryLabel:e.UIFlows.runHistoryLabel,statusStrings:{canceled:e.UIFlows.RunStatus.canceled,failed:e.UIFlows.RunStatus.failed,running:e.UIFlows.RunStatus.running,skipped:e.UIFlows.RunStatus.skipped,succeeded:e.UIFlows.RunStatus.succeeded,unknown:e.UIFlows.RunStatus.unknown},statusFilter:{all:e.UIFlows.allRunsLabel,cancelled:e.UIFlows.RunFilter.canceled,failed:e.UIFlows.RunFilter.failed,running:e.UIFlows.RunFilter.running,skipped:e.UIFlows.RunStatus.skipped,succeeded:e.UIFlows.RunFilter.succeeded},title:v.featureGates.renameUIFlowsForGA?e.UIFlows.titleGA:e.UIFlows.title,uiFlowNameFieldLabel:v.featureGates.renameUIFlowsForGA?e.UIFlows.nameLabelGA:e.UIFlows.nameLabel,showMoreLabel:e.UIFlows.showMoreLabel}}}get runFilter(){return Object(y.parseRunFilterFromQuery)(this.props.location.search)}},w=o.prototype,O="runFilter",P=[i.computed],E=Object.getOwnPropertyDescriptor(o.prototype,"runFilter"),A=o.prototype,j={},Object.keys(E).forEach((function(e){j[e]=E[e]})),j.enumerable=!!j.enumerable,j.configurable=!!j.configurable,("value"in j||j.initializer)&&(j.writable=!0),j=P.slice().reverse().reduce((function(e,t){return t(w,O,e)||e}),j),A&&void 0!==j.initializer&&(j.value=j.initializer?j.initializer.call(A):void 0,j.initializer=void 0),void 0===j.initializer&&(Object.defineProperty(w,O,j),j=null),r=o))||r},7847:function(e,t,n){"use strict";n.r(t),n.d(t,"RpaRunsListPageStore",(function(){return f}));var r,o,a,i,s,l,c,p=n(7701),u=n(7705),d=n(7707),m=n(7755),g=n(7709);function h(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function b(e,t,n,r,o){var a={};return Object.keys(r).forEach((function(e){a[e]=r[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}var f=(o=b((r=class{constructor(e,t,n){this.resourceStrings=e,h(this,"gatewayName",o,this),h(this,"messageBarProps",a,this),h(this,"runFilter",i,this),h(this,"setMessageBarProps",s,this),h(this,"dismissMessageBar",l,this),h(this,"setRunFilter",c,this),Object(p.runInAction)(()=>{this.gatewayName=t,this.runFilter=n||m.RunFilterStatus.all})}get gatewayUIFlowRuns(){return u.uiFlowRunsStore.uiFlowRuns.getCollection(u.UIFlowRunsStore.getGatewayCollectionKey(this.gatewayName,Object(d.getCurrentEnvironmentName)(),this.runFilter))}get gatewayUIFlowSortedRunsList(){return[...this.isLoadingGatewayRuns?[]:this.gatewayUIFlowRuns.list].sort((e,t)=>{var n=u.uiFlowRunsStore.uiFlowRuns.getEntity(e),r=u.uiFlowRunsStore.uiFlowRuns.getEntity(t);return Object(g.compareUIFlowRunEntity)(n,r)})}get gateway(){return u.gatewaysStore.gateways.entities.entities.get(this.gatewayName)}get isLoadingGatewayRuns(){return!this.gatewayUIFlowRuns||this.gatewayUIFlowRuns.isCollectionLoading}get hasMore(){return this.gatewayUIFlowRuns&&this.gatewayUIFlowRuns.hasMore}setGatewayName(e){this.gatewayName=e}}).prototype,"gatewayName",[p.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=b(r.prototype,"messageBarProps",[p.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),i=b(r.prototype,"runFilter",[p.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b(r.prototype,"gatewayUIFlowRuns",[p.computed],Object.getOwnPropertyDescriptor(r.prototype,"gatewayUIFlowRuns"),r.prototype),b(r.prototype,"gatewayUIFlowSortedRunsList",[p.computed],Object.getOwnPropertyDescriptor(r.prototype,"gatewayUIFlowSortedRunsList"),r.prototype),b(r.prototype,"gateway",[p.computed],Object.getOwnPropertyDescriptor(r.prototype,"gateway"),r.prototype),b(r.prototype,"isLoadingGatewayRuns",[p.computed],Object.getOwnPropertyDescriptor(r.prototype,"isLoadingGatewayRuns"),r.prototype),b(r.prototype,"hasMore",[p.computed],Object.getOwnPropertyDescriptor(r.prototype,"hasMore"),r.prototype),s=b(r.prototype,"setMessageBarProps",[p.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.messageBarProps=e}}}),b(r.prototype,"setGatewayName",[p.action],Object.getOwnPropertyDescriptor(r.prototype,"setGatewayName"),r.prototype),l=b(r.prototype,"dismissMessageBar",[p.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.setMessageBarProps(null)}}}),c=b(r.prototype,"setRunFilter",[p.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.runFilter=e||m.RunFilterStatus.all}}}),r)},7848:function(e,t,n){"use strict";n.r(t),n.d(t,"RpaRunsListPageMessageBar",(function(){return i}));var r=n(7828),o=n(7699),a=n(245),i=Object(o.observer)(e=>e.rpaRunsListPageStore.messageBarProps&&a.createElement(r.MessageBar,e.rpaRunsListPageStore.messageBarProps))},7849:function(e,t,n){"use strict";n.r(t),n.d(t,"ContextualMenuItemType",(function(){return a})),n.d(t,"RpaRunsListPageCommandBar",(function(){return y}));var r,o,a,i,s=n(245),l=n(7699),c=n(7701),p=n(7850),u=n(1222),d=n(5623),m=n(7707),g=n(7755),h=n(7796),b=n(217);function f(e,t,n,r,o){var a={};return Object.keys(r).forEach((function(e){a[e]=r[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}!function(e){e[e.Normal=0]="Normal",e[e.Divider=1]="Divider"}(a||(a={})),function(e){e.details="details",e.filter="filter",e.divider="divider"}(i||(i={}));var y=Object(l.observer)((f((o=class extends s.Component{constructor(){super(...arguments),this.filterKeys=[g.RunFilterStatus.all,i.divider,g.RunFilterStatus.succeeded,g.RunFilterStatus.failed,g.RunFilterStatus.running,g.RunFilterStatus.cancelled],this.getRunLink=e=>Object(d.getGatewayRunsListLaunchUri)(Object(m.getCurrentEnvironmentName)(),this.props.rpaRunsListPageStore.gatewayName,e)}render(){return s.createElement(u.CommandBarWithSearchBox,this.commandBarProps)}get commandBarProps(){return this.commandBarPropsWithNoSelection}get commandBarPropsWithNoSelection(){return{isSearchBoxVisible:!1,items:[],farItems:[this.runFilters]}}get runFilters(){var{rpaRunsListPageStore:{runFilter:e,resourceStrings:t}}=this.props;return{key:i.filter,name:t.runsCard.statusFilter[e],iconProps:{iconName:"Breadcrumb"},subMenuProps:{isBeakVisible:!1,items:this.filterKeys.map(n=>({canCheck:n!==i.divider,checked:n===e,key:n,text:t.runsCard.statusFilter[n],itemType:n===i.divider?a.Divider:a.Normal,href:this.getRunLink(n),onClick:()=>{Object(b.trackUserActionClickButton)(h.gatewayRunsEventScope,h.commandBarRunsFilterEventName,{gatewayName:this.props.rpaRunsListPageStore.gatewayName,runsFilter:n})},onRender:(e,t)=>s.createElement(p.ContextMenuLink,{item:e,dismiss:t})})),directionalHintFixed:!0}}}}).prototype,"commandBarProps",[c.computed],Object.getOwnPropertyDescriptor(o.prototype,"commandBarProps"),o.prototype),f(o.prototype,"commandBarPropsWithNoSelection",[c.computed],Object.getOwnPropertyDescriptor(o.prototype,"commandBarPropsWithNoSelection"),o.prototype),f(o.prototype,"runFilters",[c.computed],Object.getOwnPropertyDescriptor(o.prototype,"runFilters"),o.prototype),r=o))||r},7850:function(e,t,n){"use strict";n.r(t),n.d(t,"ContextMenuLink",(function(){return l}));var r=n(245),o=n(303),a=n(2903),i=n(687),s=n(7851);class l extends r.Component{constructor(){super(...arguments),this.getClassNames=Object(a.classNamesFunction)(),this.classNames=this.getClassNames(s.getContextMenuLinkStyles),this.dismissContextMenu=()=>{this.props.dismiss()}}render(){var{href:e,checked:t,text:n}=this.props.item;return r.createElement(o.Link,{className:this.classNames.root,to:e,onClick:this.dismissContextMenu},r.createElement(i.Icon,{className:this.classNames.icon,iconName:t?"CheckMark":""}),r.createElement("span",{className:this.classNames.text},n))}}},7851:function(e,t,n){"use strict";n.r(t),n.d(t,"getContextMenuLinkStyles",(function(){return o}));var r=n(3328),o=()=>{var e=Object(r.getTheme)().palette;return{root:["ba-ContextMenuLink",{display:"block",width:"100%",height:"100%",lineHeight:"32px",textDecoration:"unset",selectors:{"&:hover, &:active":{backgroundColor:e.neutralLighter},"&:focus":{backgroundColor:e.neutralLighter,border:"1px solid ".concat(e.black)}}}],icon:["ba-ContextMenuIcon",{width:"22px",color:e.black,padding:"0px 4px 0px 4px"}],text:["ba-ContextMenuText",{fontSize:r.FontSizes.medium,color:e.black,padding:"0px 4px 0px 4px"}]}}},7852:function(e,t,n){"use strict";n.r(t),n.d(t,"RpaRunsListPageHeader",(function(){return v}));var r,o,a=n(245),i=n(7701),s=n(7699),l=n(7824),c=n(5623),p=n(7707),u=n(4105),d=n(7796),m=n(217);function g(){return(g=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var h,b,f,y,S,C,v=Object(s.observer)((o=class extends a.Component{constructor(){super(...arguments),this.onBreadcrumbLinkClick=()=>{Object(m.trackUserActionClickLink)(d.gatewayRunsEventScope,d.headerBreadcrumEventName,{gatewayName:this.props.rpaRunsListPageStore.gatewayName})}}render(){return a.createElement(u.PageHeader,{titleBreadcrumbProps:this.breadcrumbProps})}get breadcrumbProps(){var{gateway:e}=this.props.rpaRunsListPageStore;return{onRenderItem:e=>a.createElement(l.BreadcrumbLink,g({},e,{onClick:this.onBreadcrumbLinkClick})),items:[{key:"gateway-list",text:"Gateways",href:Object(c.getGatewaysListLaunchUri)(Object(p.getCurrentEnvironmentName)())},...e?[{key:"gateway-detail",text:e.displayName,href:Object(c.getGatewayDetailLaunchUri)(Object(p.getCurrentEnvironmentName)(),this.props.rpaRunsListPageStore.gatewayName)}]:[],{key:"run-history",text:this.props.rpaRunsListPageStore.resourceStrings.runsCard.runHistoryLabel,isCurrentItem:!0}]}}},h=o.prototype,b="breadcrumbProps",f=[i.computed],y=Object.getOwnPropertyDescriptor(o.prototype,"breadcrumbProps"),S=o.prototype,C={},Object.keys(y).forEach((function(e){C[e]=y[e]})),C.enumerable=!!C.enumerable,C.configurable=!!C.configurable,("value"in C||C.initializer)&&(C.writable=!0),C=f.slice().reverse().reduce((function(e,t){return t(h,b,e)||e}),C),S&&void 0!==C.initializer&&(C.value=C.initializer?C.initializer.call(S):void 0,C.initializer=void 0),void 0===C.initializer&&(Object.defineProperty(h,b,C),C=null),r=o))||r},7853:function(e,t,n){"use strict";n.r(t),n.d(t,"_HomePageContainer",(function(){return c})),n.d(t,"HomePageContainer",(function(){return p}));var r=n(245),o=n.n(r),a=n(3183),i=n(2810),s=n(922),l=n(7854),c=e=>o.a.createElement(a.ContextScenarioProvider,{scenarioName:i.ContextScenarioNames.HomePage,expectedCompletions:3},o.a.createElement(l.HomePage,e)),p=Object(s.translateService)("PowerappsPortal")(c)},7854:function(e,t,n){"use strict";n.r(t),n.d(t,"_HomePage",(function(){return X})),n.d(t,"HomePage",(function(){return J}));var r=n(1090),o=n(1697),a=n(7643),i=n(5675),s=n(3076),l=n(1192),c=n(3311),p=n(4185),u=n(7505),d=n(2698),m=n(2814),g=n(3199),h=n(1141),b=n(1072),f=n(7855),y=n(7856),S=n(245),C=n.n(S),v=n(5437),w=n(303),O=n(2871),P=n(5487),E=n(5604),A=n(7857),j=n(7859),L=n(7664),T=n(5481),k=n(2880),R=n(5623),D=n(5693),M=n(7861),N=n(7866),x=n(7879),I=n(7910),F=n(7911),B=n(5655),U=n(7912),G=n(7917),z=n(7924),H=n(7931),_=n(7932),W=n(7933),V=n(7942);function q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function K(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?q(Object(n),!0).forEach((function(t){Y(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Q=C.a.lazy(()=>Promise.all([n.e(346),n.e(440)]).then(n.bind(null,29682)).then(e=>({default:e.FirstRunExperienceTour}))),X=e=>{var t,{t:n,trackEndPageLoad:y}=e,{rootProps:{currentEnvironment:w}}=Object(S.useContext)(P.RootPropsContext),{getUserSettings:q,setUserSettingsObject:Y}=C.a.useContext(h.UserSettingsContext),X=Object(S.useContext)(s.ApolloClientContext),J=Object(v.useDispatch)(),[$,Z]=Object(S.useState)(!1),[ee,te]=Object(S.useState)(!0),[ne,re]=Object(S.useState)(!1),[oe,ae]=Object(S.useState)(!1),{allowListFeatures:ie}=C.a.useContext(g.AllowListFeaturesContext),se=Object(c.getABTestCaseName)(p.UseSimplifiedAppFromBlankTest,O.featureGates.enableSimplifiedAppFromBlank)===u.SimplifiedAppFromBlankTestCase.Simplified;Object(S.useMemo)(()=>{var t=O.featureGates.enableContactCollectionFormFRE&&ie.EnableContactCollectionFormFRE&&"russia"!==w.location;O.featureGates.forceContactCollectionFormEnabled?te(!0):O.featureGates.enableFirstRunExperience&&e.makerTypeLoadingStatus===b.ProviderLoadingStatus.Loaded&&e.makerType===f.MakerType.NewMaker?q("makerFRX").then(e=>{!e.properties.settings.dismissed?t?te(!0):Z(!0):re(!0)}):te(!1)},[e.makerTypeLoadingStatus]);var le;if(Object(S.useEffect)(()=>{var e;e=w,Object(i.shouldShowEnvironmentVariables)(Object(E.getCrmVersion)(e))&&J(Object(D.fetchEnvironmentVariableData)({})),y?y():Object(d.trackErrorTrace)("InitialLoad",{ClientError:"Missing function trackEndPageLoad"})},[]),(null==w||null===(t=w.properties)||void 0===t?void 0:t.environmentSku)===l.EnvironmentSkuConstants.Trial){var ce=[e=>function(e,t){var n=new Date,r=new Date(e),o=Math.abs(r.getTime()-n.getTime())/1e3,a=Math.floor(o/60/60/24),i=t(1===a?"DateTime.FullUnits.day":"DateTime.FullUnits.days");return"".concat(a," ").concat(i)}(w.properties.expirationTime,n),e=>C.a.createElement(r.Link,{href:m.settings.powerPlatformAdminCenterUrl,target:"_blank",className:H.homePageStyleClasses["home-page-error-link"]},e),e=>C.a.createElement(r.Link,{href:T.default.trialLearnMoreLink,target:"_blank",className:H.homePageStyleClasses["home-page-error-link"]},e)],pe=Object(k.formatResourceStringToElement)(n("Home.MessageBar.trialText"),(e,t)=>ce[t](e));le=C.a.createElement(o.MessageBar,{messageBarType:o.MessageBarType.warning},pe)}var ue=se?H.homePageStyleClasses["home-page-component-simple"]:H.homePageStyleClasses["home-page-component"];return C.a.createElement(C.a.Fragment,null,C.a.createElement(z.HomeBanner,{environmentClient:null==X?void 0:X.environmentClient}),O.featureGates.enableFirstRunExperience&&ne&&C.a.createElement(Q,null),O.featureGates.showTrialExpirationWarning&&le,$&&C.a.createElement(G.FirstRunExperience,{onDismiss:e=>{Z(!1),re(!0),q("makerFRX").then(t=>{Y("makerFRX",K(K({},t.properties.settings),{},{dismissed:!0,finished:e}))})},environmentClient:null==X?void 0:X.environmentClient}),ee&&C.a.createElement(U.ContactCollectionDialog,{onDismiss:()=>{te(!1),Z(!0)},headerText:n("Home.ContactCollectionDialog.headerText"),subHeaderText:n("Home.ContactCollectionDialog.subHeaderText"),submitButtonText:n("Home.ContactCollectionDialog.submitButtonText"),closeButtonAriaLabel:n("Home.ContactCollectionDialog.closeButtonAriaLabel"),iframeAriaLabel:n("Home.ContactCollectionDialog.iFrameAriaLabel")}),C.a.createElement(L.MembersIndicatorChecker,{onMembersIndicatorChecked:e=>ae(e)}),oe&&C.a.createElement("div",{className:H.homePageStyleClasses["members-indicator-container"]},C.a.createElement(a.MembersIndicatorLoader,{adminCenterUrl:m.settings.powerPlatformAdminCenterUrl})),Object(E.isEnvironmentCds1)(w)&&C.a.createElement(o.MessageBar,{messageBarType:o.MessageBarType.severeWarning},C.a.createElement("span",{className:H.homePageStyleClasses["home-cds1-error"]},n("Home.MessageBar.environmentDataverse1ErrorTextPart1")),C.a.createElement("span",null,n("Home.MessageBar.environmentDataverse1ErrorTextPart2")),C.a.createElement(r.Link,{href:T.default.environmentCds1LearnMoreLink,target:"_blank"},n("Home.MessageBar.EnvironmentDataverse1.actionText"))),C.a.createElement("div",{className:ue},(null==w?void 0:w.name)&&W.enablePowerAppsFirstRunTour&&C.a.createElement(W.FirstRunTourHero,{environmentName:w.name,t:n}),C.a.createElement(W.IdentifySampleData,null),C.a.createElement(A.BannerContainer,null),C.a.createElement("div",null,C.a.createElement(j.HeaderContainer,{title:n("Home.Canvas.title"),subtitle:n("Home.Canvas.subtitle"),linkText:n("Home.Canvas.learn"),linkUrl:R.learnRoute.canvas,navigationEventName:V.LearnMoreNavigationEvent.Navigation.eventName}),O.featureGates.enableNewSampleAppExperience&&C.a.createElement(x.PartialModernSampleAppsSectionSimple,{hostPage:F.AppsSectionHostPage.Home,t:n}),!O.featureGates.enableNewSampleAppExperience&&se&&C.a.createElement(F.PartialSampleAppsSectionSimple,{hostPage:F.AppsSectionHostPage.Home,t:n}),!O.featureGates.enableNewSampleAppExperience&&!se&&C.a.createElement(C.a.Fragment,null,C.a.createElement(N.PartialDataSourceAppsSection,{t:n}),C.a.createElement(I.PartialSampleAppsSection,{appListSectionType:B.AppsListSectionName.StartFromBlank,t:n})),C.a.createElement(_.LinkTiles,{isSimpleView:se}),w&&(null==X?void 0:X.environmentClient)&&C.a.createElement(M.PartialAppsList,{numberOfAppsToShow:6,t:n,currentEnvironment:w,environmentClient:X.environmentClient}))))};var J=Object(y.withMakerType)(Object(w.withRouter)(X))},7855:function(e,t,n){"use strict";n.r(t),n.d(t,"USER_PROFILE_KEY",(function(){return a})),n.d(t,"STORAGE_SETTINGS_PREFIX",(function(){return i})),n.d(t,"MAX_VISIT_COUNT",(function(){return s})),n.d(t,"NEW_MAKER_MAX_VISIT_COUNT",(function(){return l})),n.d(t,"POWERAPPS_MAKER_TYPE_SCOPE",(function(){return c})),n.d(t,"TelemetryEvents",(function(){return r})),n.d(t,"MakerType",(function(){return o}));var r,o,a="userProfile",i="UserProfileSettings",s=1e3,l=10,c="powerapps-maker-type";!function(e){e.UserProfileSettingsFailed="UserProfileSettings/Failed",e.UserProfileSettingsNewMaker="UserProfileSettings/NewMaker"}(r||(r={})),function(e){e.NewMaker="NewMaker",e.ReturningMaker="ReturningMaker",e.ActiveMaker="ActiveMaker"}(o||(o={}))},7856:function(e,t,n){"use strict";n.r(t),n.d(t,"resetHasVisited",(function(){return b})),n.d(t,"MakerTypeContext",(function(){return f})),n.d(t,"MakerTypeProvider",(function(){return y})),n.d(t,"withMakerType",(function(){return S}));var r=n(1141),o=n(216),a=n(1072),i=n(1077),s=n(218),l=n(245),c=n(7855);function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var m=()=>({makerTypeLoadingStatus:a.ProviderLoadingStatus.NotLoaded,makerType:void 0});function g(e){return e<c.NEW_MAKER_MAX_VISIT_COUNT?c.MakerType.NewMaker:c.MakerType.ActiveMaker}var h=!1;function b(e){h=e}var f=l.createContext(m()),y=e=>{var{getUserSettings:t,setUserSettingsObject:n}=l.useContext(r.UserSettingsContext),{oid:p}=l.useContext(o.AuthenticatedUserInfoContext),[d,b]=l.useState(m),y="".concat(c.STORAGE_SETTINGS_PREFIX).concat(p);return l.useEffect(()=>{if(!h){h=!0;var e=i.StorageHelper.transientWithGlobalFallback.getItem(y),r=e?JSON.parse(e):void 0;!r||r.makervisitCount<c.MAX_VISIT_COUNT?t(c.USER_PROFILE_KEY).then(e=>{var t=e.properties.settings;n(c.USER_PROFILE_KEY,u(u({},t),{},{makervisitCount:++t.makervisitCount})),i.StorageHelper.transientWithGlobalFallback.setItem(y,JSON.stringify(u(u({},t),{},{lastUpdated:new Date})));var r=g(t.makervisitCount);r===c.MakerType.NewMaker&&Object(s.trackCustomEvent)(c.POWERAPPS_MAKER_TYPE_SCOPE,{eventName:c.TelemetryEvents.UserProfileSettingsNewMaker,eventData:{visitCount:t.makervisitCount}}),b({makerTypeLoadingStatus:a.ProviderLoadingStatus.Loaded,makerType:r})}).catch(e=>{b({makerTypeLoadingStatus:a.ProviderLoadingStatus.Error,makerType:void 0}),Object(s.trackErrorTrace)(c.POWERAPPS_MAKER_TYPE_SCOPE,{eventName:c.TelemetryEvents.UserProfileSettingsFailed},e)}):b({makerTypeLoadingStatus:a.ProviderLoadingStatus.Loaded,makerType:g(r.makervisitCount)})}},[]),l.createElement(f.Provider,{value:d},e.children)},S=Object(a.getWithProviderFunction)(f,"makerTypeLoadingStatus")},7857:function(e,t,n){"use strict";n.r(t),n.d(t,"mapStateToProps",(function(){return s})),n.d(t,"BannerContainer",(function(){return l}));var r=n(5437),o=n(5487),a=n(5604),i=n(7858),s=(e,t)=>({isDevEnvironment:Object(a.isDevEnvironment)(t.rootProps.currentEnvironment)}),l=Object(o.withRootProps)(Object(r.connect)(s)(i.Banner))},7858:function(e,t,n){"use strict";n.r(t),n.d(t,"Banner",(function(){return l}));var r=n(245),o=n(2869),a=n(1697),i=n(5481),s=n(2880);function l(e){return e.isDevEnvironment?r.createElement(c,null):null}function c(){var e=Object(o.getResources)(),t=Object(s.formatResourceStringAsLinks)(e.Home.DevEnvironmentBanner.text,[i.default.devEnvironmentLearnMoreLink]);return r.createElement(a.MessageBar,null,t)}},7859:function(e,t,n){"use strict";n.r(t),n.d(t,"withHeaderBehavior",(function(){return d})),n.d(t,"HeaderContainer",(function(){return m}));var r=n(245),o=n.n(r),a=n(7860),i=n(5593),s=n(6874),l=n(5583),c=["openLinkInNewTab","navigationEventName","navigate"];function p(){return(p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function u(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function d(e){return t=>{var{openLinkInNewTab:n,navigationEventName:r,navigate:a}=t,l=u(t,c);return o.a.createElement(e,p({},l,{onLinkClick:e=>{r&&Object(i.trackUserActionClickLink)(r),n?Object(s.openNewTab)(e):a(e,!0)}}))}}var m=Object(l.withNavigation)(d(a.Header))},7860:function(e,t,n){"use strict";n.r(t),n.d(t,"Header",(function(){return i}));var r=n(1259),o=n(1090),a=n(245);class i extends a.Component{constructor(e){super(e),this.props=e}onLinkKeyDown(e){e.keyCode!==r.KeyCodes.enter&&e.keyCode!==r.KeyCodes.space||this.props.onLinkClick(this.props.linkUrl)}render(){return a.createElement("div",{className:"header-container-section",role:"none"},a.createElement("div",{className:"page-title",role:"heading","aria-level":1},this.props.title),a.createElement("div",{className:"page-subtitle"},this.props.subtitle&&a.createElement("span",null,this.props.subtitle),this.props.linkUrl&&this.props.linkText&&a.createElement(o.Link,{as:"a",tabIndex:0,className:"page-subtitle link",onKeyDown:e=>this.onLinkKeyDown(e),onClick:()=>this.props.onLinkClick(this.props.linkUrl),role:"link"},this.props.linkText)))}}},7861:function(e,t,n){"use strict";n.r(t),n.d(t,"PartialAppsList",(function(){return S}));var r=n(245),o=n.n(r),a=n(5437),i=n(7862),s=n(5623),l=n(7646),c=n(7863),p=n(7864),u=n(7865),d=n(2871),m=n(5649),g=n(5593),h=n(3185),b=n(5604),f=n(7640),y=n(3197),S=e=>{var t,{t:n,onGenericAppSelect:r,numberOfAppsToShow:S,currentEnvironment:C,environmentClient:v,selectedApp:w}=e,O=d.featureGates.useGraphQlAppsList?u.NewAppsListContainer:l.AppsListContainer,P=Object(a.useSelector)(e=>C&&Object(m.hasSharedOrRecentApps)(e,C.id)),E=!Object(b.environmentHasCds2Database)(C),A=(t=Object(h.useAppModulesListQuery)(v,g.PortalScope,e.t("Common.Request.Failed"),y.TwoMinutesPollTimeInMs,E,!0).appModules)&&t.length>0,j=P||A,{deleteAppModuleById:L,appModule:T,errorMessage:k}=Object(f.useAppModuleDeleteQuery)(v,g.PortalScope,e.t("Common.Request.Failed")),{appModuleSetStateById:R,appModule:D,stateCode:M,errorMessage:N}=Object(h.useAppModuleSetStateQuery)(v,g.PortalScope,e.t("Common.Request.Failed"));return o.a.createElement("div",{role:"region","aria-label":n("Home.RecentApps.title")},o.a.createElement("div",{className:p.partialAppsListStyleClasses.recentAppsSectionHeader,role:"heading","aria-level":3},n("Home.RecentApps.title")),o.a.createElement("div",{className:p.partialAppsListStyleClasses.partialAppsListSection},o.a.createElement(O,{selectedApp:w,onGenericAppSelect:r,numberOfAppsToShow:S,trackEndPageLoad:()=>{},onDeleteAppModule:L,deletedAppModule:T,deleteAppModuleErrorMessage:k,onAppModuleSetState:R,activatedDeactivatedAppModule:D,newStateCode:M,appModuleSetStateErrorMessage:N}),j&&o.a.createElement("div",{className:"partial-apps-section-view-all ms-Grid-col"},o.a.createElement(i.NavigationLink,{linkLabel:n("PartialAppsList.seeAllApps"),navigationEvent:c.PartialAppsListEvent.Navigation,navigationRoute:s.appsRoute.apps}))))}},7862:function(e,t,n){"use strict";n.r(t),n.d(t,"NavigationLinkUnconnected",(function(){return p})),n.d(t,"NavigationLink",(function(){return u}));var r=n(687),o=n(1090),a=n(719),i=n(245),s=n(2879),l=n(5593),c=n(5583),p=e=>{var{navigate:t,linkLabel:n,navigationEvent:c,navigationRoute:p,onClick:u}=e;return i.createElement(o.Link,{className:"navigation-link-section-link","aria-label":n,role:"link",onClick:()=>{Object(l.trackUserActionClickButton)(c.eventName),u?u():t(p,!0)}},i.createElement("span",{className:"link-label"},n),i.createElement(r.Icon,{iconName:s.fabricIcons.ChromeBackMirrored,className:Object(a.mergeStyles)({fontSize:"16px",margin:"0 4px 0 6px",height:"16px",lineHeight:"15px",verticalAlign:"middle"})}))},u=Object(c.withNavigation)(p)},7863:function(e,t,n){"use strict";n.r(t),n.d(t,"PartialAppsListEvent",(function(){return r}));var r={Navigation:{eventName:"PartialAppsList.OnAllAppsClicked"}}},7864:function(e,t,n){"use strict";n.r(t),n.d(t,"partialAppsListStyleClasses",(function(){return i}));var r=n(719),o=n(2882),a=n(5492),i=Object(r.mergeStyleSets)({partialAppsListSection:{boxSizing:"border-box",marginBottom:"45px",minHeight:340,selectors:{".partial-apps-section-view-all":{paddingRight:"8px",color:o.fabricColors.neutralPlumLighter,textAlign:"right",float:"right !important"},".apps-list":{padding:"0 10px 15px 0"}}},recentAppsSectionHeader:{fontFamily:a.fonts.segoeUiSemibold,fontSize:"16px",color:o.fabricColors.neutralDark,marginBottom:"15px",lineHeight:"19px",width:"100%"}})},7865:function(e,t,n){"use strict";n.r(t),n.d(t,"NewAppsList",(function(){return s})),n.d(t,"NewAppsListContainer",(function(){return l}));var r=n(3148),o=n(3199),a=n(245),i=n.n(a),s=e=>{var{searchFilter:t,numberOfAppsToShow:n}=e,[o]=Object(a.useState)([]);return i.a.createElement(r.AppsList,{appId:void 0,deletedApps:o,setDeleteModalState:()=>{},onGenericAppSelect:()=>{},searchFilter:t,numberOfAppsToShow:n,canvasAppShareAreaPathUri:"home",modelDrivenAppShareAreaPathUri:"home"})},l=Object(o.withAllowListFeatures)(s)},7866:function(e,t,n){"use strict";n.r(t),n.d(t,"PartialDataSourceAppsSection",(function(){return l}));var r=n(245),o=n(7867),a=n(5655),i=n(7878),s={lowerBound:5,upperBound:5},l=e=>{var{t:t,hideDefaultHeader:n}=e;return r.createElement("div",{role:"region","aria-label":t("Home.SampleApps.StartFromDataSection.ariaLabel"),className:i.partialSampleAppSectionStyleClasses["partial-sample-apps-section"]},r.createElement("div",{role:"presentation"},!n&&r.createElement("div",{className:"partial-sample-apps-section-header ms-Grid-row","aria-label":t("Home.SampleApps.StartFromDataSection.ariaLabel")},r.createElement("div",null,r.createElement("div",{className:"partial-sample-apps-section-header-title ms-lg-8",role:"heading","aria-level":2},t("Home.Samples.startFromDataTitle")))),r.createElement("div",null,r.createElement("div",null,r.createElement(o.SampleAppsListContainer,{numberOfSampleAppsToShow:s,appListSectionType:a.AppsListSectionName.StartFromData})))))}},7867:function(e,t,n){"use strict";n.r(t),n.d(t,"mapStateToProps",(function(){return k})),n.d(t,"mapDispatchToProps",(function(){return D})),n.d(t,"mergeProps",(function(){return M})),n.d(t,"SampleAppsListContainer",(function(){return N}));var r=n(5437),o=n(5604),a=n(5487),i=n(5651),s=n(5659),l=n(5629),c=n(5630),p=n(5654),u=n(7490),d=n(5653),m=n(5626),g=n(7495),h=n(5658),b=n(7491),f=n(5655),y=n(7493),S=n(7868),C=n(5987),v=n(5667),w=n(5669),O=n(5583),P=n(3076),E=["searchFilter","appListSectionType","rootProps"];function A(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?A(Object(n),!0).forEach((function(t){L(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):A(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function L(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function T(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var k=(e,t)=>{var n,r,o,{sampleAppOrdering:a,numberOfBlankSamplesToShow:i,hideNonCanvasApps:s,rootProps:c,enableCanvasAppsInSolutionsByDefault:p}=t,d=Object(m.allowListFeaturesSelector)(e),h=t.numberOfSampleAppsToShow&&t.numberOfSampleAppsToShow.upperBound,b=t.appListSectionType,y=c.currentEnvironment,S=Object(C.environmentHasCDSOrgSelector)(e,y.id),v=Object(f.getCRMStaticSampleApps)(d,S,y),w=Object(C.getPowerPortalFeaturesEnabled)(e);switch(b){case f.AppsListSectionName.StartFromData:o=Object(f.getStaticStartFromDataApps)(!(null===(n=y.properties)||void 0===n||!n.linkedEnvironmentMetadata),p);break;case f.AppsListSectionName.StartFromBlank:o=Object(f.getStaticSampleApps)(b,d,y,s,w);break;case f.AppsListSectionName.Simple:o=Object(f.getStaticSampleAppsSimple)(!(null===(r=y.properties)||void 0===r||!r.linkedEnvironmentMetadata),p);break;default:o=R(v,d,e,b,y,a,i,s,w)}h&&o.length>h&&(o=o.slice(0,h));var O=Object(u.sampleAppsListError)(e),P=[Object(l.toLoadingState)(!0)];return b!==f.AppsListSectionName.StartFromTemplate&&b!==f.AppsListSectionName.None||(P=[Object(l.toLoadingState)(Object(u.isSampleAppsListCachedComplete)(e),O)]),{enableCanvasAppsInSolutionsByDefault:p,sampleApps:o,logEvent:g.GenericSampleAppsEvents.Load,isPortalsCDSOrg:S,isPortalsCDSOrgError:Object(C.powerPortalFetchIsCDSOrgError)(e,y.id),ShowD365PowerPortalTiles:d.ShowD365PowerPortalTiles,loadProgress:P,appListSectionType:b}},R=(e,t,n,r,o,a,i,l,c)=>{var p=[...l?[]:e,...t.BlockSampleApps||l?[]:Object(b.getSampleAppModules)(),...Object(s.getGenericUnsortedSampleAppsToShow)(Object(u.sampleAppsSelector)(n),Object(m.currentPlansSelector)(n))],d=[],g=[];return(r!==f.AppsListSectionName.StartFromTemplate||i)&&(g=Object(f.getStaticSampleApps)(r,t,o,l,c),void 0!==i&&(g=g.slice(0,i))),r!==f.AppsListSectionName.StartFromBlank&&(d=[...Object(h.filterGenericSampleAppsBasedOnType)(p,Object(s.deriveSampleAppTypeBasedOnOptimizely)(Object(m.optimizelyFlagsSelector)(n),Object(u.sampleAppType)(n))).sort(Object(s.getGenericSampleAppSorter)(a))]),[...g,...d]},D=e=>({fetchSampleApps:()=>e(Object(c.logAction)(Object(p.fetchSampleAppsRequest)({forceRefresh:!1}),g.GenericSampleAppsEvents.FetchSampleApps.eventName)),fetchSampleAppModules:()=>e(Object(c.logAction)(Object(d.fetchAppModulesRequest)({appModuleListFilter:i.AppModuleListType.Sample}),g.GenericSampleAppsEvents.FetchSampleAppModules.eventName)),cancelFetchSampleApps:()=>e(Object(p.fetchSampleAppsCancelPoll)()),cancelFetchSampleAppModules:()=>e(Object(d.fetchAppModulesCancelPoll)()),dispatchTelemetry:e}),M=(e,t,n)=>{var{searchFilter:r,appListSectionType:a,rootProps:i}=n,s=T(n,E),l=i.currentEnvironment;return j(j(j({},s),e),{},{searchFilter:r||"",appListSectionType:a,onMount:()=>{t.fetchSampleApps(),n.fetchCdsOrgSettings(l.id),t.dispatchTelemetry(Object(v.fetchPowerPortalFeatures)({environmentClient:n.environmentClient})),void 0!==e.appListSectionType&&e.appListSectionType!==f.AppsListSectionName.StartFromTemplate&&e.appListSectionType!==f.AppsListSectionName.None||Object(o.environmentHasCds2Database)(l)&&(t.fetchSampleAppModules(),!e.ShowD365PowerPortalTiles||e.isPortalsCDSOrg||e.isPortalsCDSOrgError||t.dispatchTelemetry(Object(v.fetchIsCDSOrgRequest)({orgUrl:o.getCrmInstanceUrl(l)},n.environmentClient)))},onUnmount:()=>{void 0!==e.appListSectionType&&e.appListSectionType!==f.AppsListSectionName.StartFromTemplate&&e.appListSectionType!==f.AppsListSectionName.None||(t.cancelFetchSampleApps(),Object(o.environmentHasCds2Database)(l)&&t.cancelFetchSampleAppModules())},dispatchTelemetry:t.dispatchTelemetry})},N=Object(O.withNavigate)(Object(a.withRootProps)(Object(P.withApolloClient)(Object(y.withSampleAppCommands)(g.SampleAppsListContext)(Object(r.connect)(k,D,M)(Object(l.withLoadTelemetry)(S.SampleAppsList,w.LoadScenarioNames.SampleAppsList))))))},7868:function(e,t,n){"use strict";n.r(t),n.d(t,"InnerSampleAppsList",(function(){return P})),n.d(t,"SampleAppsList",(function(){return E}));var r=n(3161),o=n(1235),a=n(245),i=n.n(a),s=n(3183),l=n(3184),c=n(2810),p=n(5659),u=n(5628),d=n(5629),m=n(2879),g=n(2869),h=n(7496),b=n(7869),f=n(5656),y=n(5655),S=n(7874),C=n(3076),v=n(5657);function w(){return(w=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var O=e=>{var{loadProgress:t,numberOfSampleAppsToShow:n,sampleApps:r}=e;return Object(d.isLoading)(t)?n&&n.upperBound||P.defaultShimmerCount:r.length};class P extends i.a.Component{constructor(e){super(e),this.resources=Object(g.getResources)(),this.state={extraTelemetryState:void 0}}componentDidMount(){this.props.onMount()}componentWillUnmount(){this.props.onUnmount()}componentDidUpdate(e,t){if(this.props.trackContextScenarioProgress){var n,r=c.LoadScenarioNames.SampleAppsList;this.props.appListSectionType===y.AppsListSectionName.StartFromBlank?r=c.LoadScenarioNames.SampleAppsListFromBlank:this.props.appListSectionType===y.AppsListSectionName.StartFromData&&(r=c.LoadScenarioNames.SampleAppsListFromData),n=Object(d.hasFailureWithUnexpectedError)(this.props.loadProgress)?{name:r,state:d.ComponentLoadState.Fail,info:Object(d.getErrorMessages)(this.props.loadProgress).join(", ")}:Object(d.isLoading)(this.props.loadProgress)?{name:r,state:d.ComponentLoadState.Loading}:{name:r,state:d.ComponentLoadState.Complete,info:"Sample Apps count: ".concat(O(this.props))},this.state.extraTelemetryState&&this.state.extraTelemetryState.state===n.state&&this.state.extraTelemetryState.info===n.info||(this.props.trackContextScenarioProgress(n),this.setState({extraTelemetryState:n}),n.state===d.ComponentLoadState.Complete?this.props.trackMyPartFinished(l.CompleteOrFail.Complete):n.state===d.ComponentLoadState.Fail&&this.props.trackMyPartFinished(l.CompleteOrFail.Fail,n.info))}}render(){var e=O(this.props),t={numberOfAppsToDisplayOnResize:e,cacheKey:"".concat(e)};return i.a.createElement(o.ResizeGroup,{data:t,onRenderData:this._onRenderData.bind(this),onReduceData:this._onReduceData.bind(this)})}_onRenderData(e){var t,n,r=Object(d.isLoading)(this.props.loadProgress);return r?(t=new Array(e.numberOfAppsToDisplayOnResize).fill(null),n=!1):(0!==(t=this.props.sampleApps.filter(e=>this.shouldDisplaySampleApp(e))).length&&t.length!==e.numberOfAppsToDisplayOnResize&&(t=t.slice(0,e.numberOfAppsToDisplayOnResize)),n=0===t.length),i.a.createElement("div",{className:"sample-apps-list-items ms-Grid-row"},n?this.getEmptySearchState():t.map((e,t)=>{if(this.props.appListSectionType===y.AppsListSectionName.StartFromData||this.props.appListSectionType===y.AppsListSectionName.Simple&&e.uniqueName!==v.StaticSampleAppId.NewApp&&e.uniqueName!==v.StaticSampleAppId.SelectApp){var n={sampleApp:e,sampleAppCommands:e&&this.props.sampleAppCommands(e),isSimpleView:this.props.appListSectionType===y.AppsListSectionName.Simple};return i.a.createElement("div",{key:t,className:"sample-apps-list-tile-container"},i.a.createElement(S.DataSourceAppCard,n))}var r={sampleApp:e,sampleAppCommands:e&&this.props.sampleAppCommands(e),playPreviewFromDeepLink:e&&this.shouldPreviewSampleApp(e),isSimpleView:this.props.appListSectionType===y.AppsListSectionName.Simple,indexPositionInList:t};return i.a.createElement("div",{key:t,className:"sample-apps-list-tile-container"},i.a.createElement(b.SampleAppCardContainer,w({environmentClient:this.props.environmentClient},r)))}),!r&&t.length>0&&i.a.createElement(h.CreateAppModalContainer,{sampleAppCommands:this.props.sampleAppCommands,onDismissSampleAppPreview:()=>this.onDismissSampleAppPreview()}))}_onReduceData(e){return this.props.numberOfSampleAppsToShow&&this.props.numberOfSampleAppsToShow.lowerBound&&e.numberOfAppsToDisplayOnResize>this.props.numberOfSampleAppsToShow.lowerBound?{numberOfAppsToDisplayOnResize:e.numberOfAppsToDisplayOnResize-1,cacheKey:"".concat(e.numberOfAppsToDisplayOnResize-1)}:void 0}shouldDisplaySampleApp(e){return e&&e.app&&Object(p.shouldSampleAppShow)(this.props.searchFilter,[e.displayName,e.description,...e.connectionNames])}getEmptySearchStateProps(e,t){return{icon:m.fabricIcons.PowerAppsLogo,primaryMessage:e,secondaryMessage:[t],maxWidth:u.emptyStateMaxWidth}}getEmptySearchState(){return i.a.createElement(r.EmptyState,this.getEmptySearchStateProps(this.resources.EmptySearchState.noMatch,this.resources.EmptySearchState.tryNewSearch))}shouldPreviewSampleApp(e){if(this.props.sampleAppPreviewDeepLinkData&&e&&e.sampleAppType===f.SampleAppTypes.Canvas&&e.displayName.replace(/\s/g,"").toLocaleLowerCase()===this.props.sampleAppPreviewDeepLinkData.deepLinkPreviewAppName.toLocaleLowerCase())return{formFactor:this.props.sampleAppPreviewDeepLinkData.formFactor,onDismissPreview:this.props.sampleAppPreviewDeepLinkData.onDismissPreview}}onDismissSampleAppPreview(){this.props.sampleAppPreviewDeepLinkData&&this.props.sampleAppPreviewDeepLinkData.onDismissPreview&&this.props.sampleAppPreviewDeepLinkData.onDismissPreview()}}P.defaultShimmerCount=3;var E=e=>{var t=Object(s.useContextScenario)(),n=Object(a.useContext)(C.ApolloClientContext);return i.a.createElement(P,w({},n,t,e))}},7869:function(e,t,n){"use strict";n.r(t),n.d(t,"mapDispatchToProps",(function(){return b})),n.d(t,"SampleAppCardContainer",(function(){return y}));var r=n(5437),o=n(3311),a=n(4185),i=n(5667),s=n(5654),l=n(7870),c=n(5593),p=n(5669),u=n(5658),d=n(2871);function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){h(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var b=(e,t)=>g(g({},t),{},{openSampleAppModal:n=>{f(t.sampleApp,t.indexPositionInList),e(Object(s.openSampleAppModal)({sampleApp:n}))},createAppModal:n=>{f(t.sampleApp,t.indexPositionInList),e(Object(i.openPowerPortalAppModal)({sampleApp:n},t.environmentClient))}}),f=(e,t)=>{var n=Object(o.getABTestCaseName)(a.UseSimplifiedAppFromBlankTest,d.featureGates.enableSimplifiedAppFromBlank);Object(c.trackUserActionClickButton)(p.SampleAppScenarioNames.OpenAppModalClickEvent,{appDisplayName:e.displayName,appType:Object(u.resolveSampleAppType)(e.sampleAppType,e.uniqueName),appUniqueName:e.uniqueName,TestCase:n,indexPositionInList:t})},y=Object(r.connect)(void 0,b)(l.SampleAppCard)},7870:function(e,t,n){"use strict";n.r(t),n.d(t,"SampleAppCardBase",(function(){return h})),n.d(t,"SampleAppCard",(function(){return b}));var r=n(1524),o=n(687),a=n(1277),i=n(1755),s=n(545),l=n(245),c=n(5656),p=n(5657),u=n(5658),d=n(7871),m=n(7872);function g(){return(g=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}class h extends l.Component{constructor(e){super(e),this.classNames=void 0,this.classNames=Object(d.getClassNames)(this.props.styles,{theme:this.props.theme,isStaticApp:!this.props.sampleApp||this.props.sampleApp.sampleAppType===c.SampleAppTypes.Static,isAppFromData:!this.props.sampleApp||Object(u.isSampleAppFromData)(this.props.sampleApp)})}componentDidMount(){this.props.playPreviewFromDeepLink&&this.props.sampleApp&&this.props.sampleAppCommands&&this.props.sampleApp.uniqueName!==p.StaticSampleAppId.NewPowerPortalApp&&this.props.openSampleAppModal(this.props.sampleApp)}onCardClicked(){var{sampleApp:e}=this.props;e&&(Object(u.resolveSampleAppType)(e.sampleAppType,e.uniqueName)!==c.SampleAppTypes.PowerPortal?this.props.openSampleAppModal(e):this.props.createAppModal(e))}render(){var{sampleApp:e,isSimpleView:t}=this.props;return t?l.createElement(m.SampleAppCardSimple,{app:e,onCardClicked:this.onCardClicked.bind(this)}):l.createElement("div",{className:this.classNames.root},l.createElement(r.DocumentCard,{onClick:this.onCardClicked.bind(this),className:this.classNames.card,"data-is-loaded":!!e},this.renderImage(),this.renderContentElement()))}renderImage(){var{sampleApp:e}=this.props;return l.createElement(i.Shimmer,{shimmerElements:[{type:i.ShimmerElementType.line,height:123}],isDataLoaded:!!e},!!e&&l.createElement(a.Image,{src:e.getPreviewImageUrl(),styles:{root:this.classNames.imageContainer,image:this.classNames.image},alt:e.displayName}))}renderContentElement(){var{sampleApp:e}=this.props,t=e?e.getSampleAppTag():{sampleAppIconProps:{},appTypeDisplayName:""};return l.createElement("div",{className:this.classNames.contentRoot},l.createElement("div",{className:this.classNames.contentText},l.createElement(i.Shimmer,{width:150,shimmerElements:[{type:i.ShimmerElementType.line,height:19}],isDataLoaded:!!e,styles:{dataWrapper:[this.classNames.contentText]}},!!e&&e.displayName)),l.createElement("div",{className:this.classNames.appTagContainer},l.createElement(i.Shimmer,{width:134,shimmerElements:[{type:i.ShimmerElementType.line,width:14,height:14},{type:i.ShimmerElementType.gap,width:4},{type:i.ShimmerElementType.line,height:14}],isDataLoaded:!!e},t&&l.createElement(o.Icon,g({className:this.classNames.appTagIcon},t.sampleAppIconProps)),t&&l.createElement("div",{className:this.classNames.appTagText}," ",t.appTypeDisplayName," "))))}}var b=Object(s.styled)(h,d.getStyles)},7871:function(e,t,n){"use strict";n.r(t),n.d(t,"getClassNames",(function(){return g})),n.d(t,"getStyles",(function(){return h}));var r=n(719),o=n(545),a=n(2709),i=n(1259),s=n(2871),l=n(3311),c=n(7505),p=n(4185);function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){m(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var g=Object(o.classNamesFunction)(),h=e=>{var{theme:t}=e,{palette:n,fonts:o}=t,u=Object(a.getCardSelectorsStyle)(n),m=Object(l.getABTestCaseName)(p.UseSimplifiedAppFromBlankTest,s.featureGates.enableSimplifiedAppFromBlank)===c.SimplifiedAppFromBlankTestCase.Simplified;return{root:{padding:"9px"},card:{width:Object(i.getResponsiveMode)(window)<i.ResponsiveMode.medium?"250px":m?"279px":"270px",height:"194px",boxShadow:"0px 0.3px 0.9px ".concat(a.blackTranslucent11,", 0px 1.6px 3.6px ").concat(a.blackTranslucent11),borderRadius:"3px",selectors:d(d({},u),{},{":hover":d(d({},u[":hover"]),{},{border:"0px"}),":after":{border:"0px !important"},"@media (-webkit-min-device-pixel-ratio:0)":{selectors:{":focus":{outlineColor:"-webkit-focus-ring-color",outlineStyle:"auto",outlineWidth:"1px"}}},"@media (-ms-high-contrast: active)":{selectors:{":focus":{border:"0px"}}}})},imageContainer:{backgroundColor:n.neutralLighter,paddingTop:"17px"},image:{maxWidth:"194px",height:e.isAppFromData?"106px":"146px",margin:"auto",boxShadow:e.isStaticApp?"":"0px 1.2px 3.6px ".concat(a.blackTranslucent11,", 0px 6.4px 14.4px ").concat(a.blackTranslucent11)},contentRoot:{top:"117px",left:"0",right:"0",position:"absolute",backgroundColor:n.white,padding:"12px 19px 18px 12px",borderTop:"solid 1px ".concat(n.neutralLighter)},contentText:[o.medium,{color:n.black,fontWeight:r.FontWeights.semibold}],appTagContainer:{paddingTop:"8px",lineHeight:"16px"},appTagIcon:{height:"14px",width:"14px",fontSize:"12px",margin:"1px 4px 0 0",verticalAlign:"top"},appTagText:{fontSize:"12px",lineHeight:"16px",display:"inline",verticalAlign:"top"}}}},7872:function(e,t,n){"use strict";n.r(t),n.d(t,"SampleAppCardSimple",(function(){return l}));var r=n(245),o=n(1524),a=n(1277),i=n(545),s=n(7873),l=Object(i.styled)(e=>{var{app:t,onCardClicked:n,onCardKeyDown:s,styles:l,theme:c}=e,p=Object(i.classNamesFunction)()(l,{theme:c});return r.createElement("div",{className:p.root,onKeyDown:s},r.createElement(o.DocumentCard,{className:p.card,onClick:n,tabIndex:0,role:"button","data-is-focusable":!0,"data-is-loaded":!!t,"data-test-id":t.uniqueName},r.createElement("div",{className:p.iconContainer,style:{backgroundColor:t.backgroundColor}},r.createElement(a.Image,{alt:t.displayName,src:null==t?void 0:t.getPreviewImageUrl(),role:"presentation"})),r.createElement("div",{className:p.title},t.displayName),r.createElement("div",{className:p.description},t.tileDescription)))},s.getStyles)},7873:function(e,t,n){"use strict";n.r(t),n.d(t,"getClassNames",(function(){return c})),n.d(t,"getStyles",(function(){return p}));var r=n(719),o=n(545),a=n(2709);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var c=Object(o.classNamesFunction)(),p=e=>{var{theme:t}=e,{palette:n}=t,o=Object(a.getCardSelectorsStyle)(n);return{root:{padding:"9px"},card:{width:"279px",height:"192px",border:"0px",padding:"20px 35px 20px 24px",boxShadow:"0px 0.3px 0.9px ".concat(a.blackTranslucent11,", 0px 1.6px 3.6px ").concat(a.blackTranslucent11),borderRadius:"3px",selectors:s(s({},o),{},{":hover":s(s({},o[":hover"]),{},{border:"0px"}),":after":{border:"0px !important"},"@media (-webkit-min-device-pixel-ratio:0)":{selectors:{":focus":{outlineColor:"-webkit-focus-ring-color",outlineStyle:"auto",outlineWidth:"1px"}}},"@media (-ms-high-contrast: active)":{selectors:{":focus":{border:"0px"}}}})},iconContainer:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",width:"40px",height:"40px",borderRadius:"4px",selectors:{img:{width:"24px",height:"24px"}}},title:{marginTop:"32px",fontSize:"20px",fontWeight:r.FontWeights.semibold},description:{marginTop:"12px",fontSize:"14px"}}}},7874:function(e,t,n){"use strict";n.r(t),n.d(t,"DataSourceAppCardBase",(function(){return d})),n.d(t,"DataSourceAppCard",(function(){return m}));var r=n(1755),o=n(545),a=n(245),i=n(7875),s=n(7876),l=n(2882),c=n(7877),p=n(7872),u=n(7508),d=e=>{var t=Object(s.getClassNames)(e.styles,{theme:e.theme}),{sampleApp:n,sampleAppCommands:o,isSimpleView:d,theme:m}=e,[g,h]=a.useState(!1),b=e=>{e&&e.keyCode===i.KeyCodes.ENTER&&n&&o&&o.customizeSample&&h(!0)};return a.createElement(a.Fragment,null,d?a.createElement(p.SampleAppCardSimple,{app:n,theme:m,onCardClicked:()=>h(!0),onCardKeyDown:b}):a.createElement("div",{className:t.root},a.createElement("div",{tabIndex:0,role:"button","data-is-focusable":!0,onClick:()=>{h(!0)},onKeyDown:b},a.createElement("div",{className:t.card,"data-is-loaded":!!n},a.createElement(c.DataSourceAppCardIcon,{sampleApp:n,classNames:t,isSimpleView:d}),function(e,t){var n,o={color:(e&&e.backgroundColor)===l.fabricColors.white&&l.fabricColors.neutralPlum};return a.createElement("div",{className:t.contentRoot},a.createElement("div",{className:t.contentText,"data-automation-id":null===(n=e.app)||void 0===n?void 0:n.dataAutomationId},a.createElement(r.Shimmer,{width:50,shimmerElements:[{type:r.ShimmerElementType.line,height:14}],isDataLoaded:!!e,styles:{dataWrapper:[t.contentText]}},a.createElement("span",{style:o},!!e&&e.displayName))))}(n,t)))),g&&a.createElement(u.OpenConnectionsModal,{sampleApp:n,sampleAppCommands:o,onDismiss:()=>h(!1)}))};var m=Object(o.styled)(d,s.getStyles)},7875:function(e,t,n){"use strict";var r;n.r(t),n.d(t,"KeyCodes",(function(){return r})),function(e){e[e.BACKSPACE=8]="BACKSPACE",e[e.TAB=9]="TAB",e[e.ENTER=13]="ENTER",e[e.SHIFT=16]="SHIFT",e[e.CTRL=17]="CTRL",e[e.ALT=18]="ALT",e[e.PAUSE=19]="PAUSE",e[e.CAPS_LOCK=20]="CAPS_LOCK",e[e.ESCAPE=27]="ESCAPE",e[e.SPACE=32]="SPACE",e[e.PAGE_UP=33]="PAGE_UP",e[e.PAGE_DOWN=34]="PAGE_DOWN",e[e.END=35]="END",e[e.HOME=36]="HOME",e[e.LEFT_ARROW=37]="LEFT_ARROW",e[e.UP_ARROW=38]="UP_ARROW",e[e.RIGHT_ARROW=39]="RIGHT_ARROW",e[e.DOWN_ARROW=40]="DOWN_ARROW",e[e.INSERT=45]="INSERT",e[e.DELETE=46]="DELETE",e[e.KEY_0=48]="KEY_0",e[e.KEY_1=49]="KEY_1",e[e.KEY_2=50]="KEY_2",e[e.KEY_3=51]="KEY_3",e[e.KEY_4=52]="KEY_4",e[e.KEY_5=53]="KEY_5",e[e.KEY_6=54]="KEY_6",e[e.KEY_7=55]="KEY_7",e[e.KEY_8=56]="KEY_8",e[e.KEY_9=57]="KEY_9",e[e.KEY_A=65]="KEY_A",e[e.KEY_B=66]="KEY_B",e[e.KEY_C=67]="KEY_C",e[e.KEY_D=68]="KEY_D",e[e.KEY_E=69]="KEY_E",e[e.KEY_F=70]="KEY_F",e[e.KEY_G=71]="KEY_G",e[e.KEY_H=72]="KEY_H",e[e.KEY_I=73]="KEY_I",e[e.KEY_J=74]="KEY_J",e[e.KEY_K=75]="KEY_K",e[e.KEY_L=76]="KEY_L",e[e.KEY_M=77]="KEY_M",e[e.KEY_N=78]="KEY_N",e[e.KEY_O=79]="KEY_O",e[e.KEY_P=80]="KEY_P",e[e.KEY_Q=81]="KEY_Q",e[e.KEY_R=82]="KEY_R",e[e.KEY_S=83]="KEY_S",e[e.KEY_T=84]="KEY_T",e[e.KEY_U=85]="KEY_U",e[e.KEY_V=86]="KEY_V",e[e.KEY_W=87]="KEY_W",e[e.KEY_X=88]="KEY_X",e[e.KEY_Y=89]="KEY_Y",e[e.KEY_Z=90]="KEY_Z",e[e.LEFT_META=91]="LEFT_META",e[e.RIGHT_META=92]="RIGHT_META",e[e.SELECT=93]="SELECT",e[e.NUMPAD_0=96]="NUMPAD_0",e[e.NUMPAD_1=97]="NUMPAD_1",e[e.NUMPAD_2=98]="NUMPAD_2",e[e.NUMPAD_3=99]="NUMPAD_3",e[e.NUMPAD_4=100]="NUMPAD_4",e[e.NUMPAD_5=101]="NUMPAD_5",e[e.NUMPAD_6=102]="NUMPAD_6",e[e.NUMPAD_7=103]="NUMPAD_7",e[e.NUMPAD_8=104]="NUMPAD_8",e[e.NUMPAD_9=105]="NUMPAD_9",e[e.MULTIPLY=106]="MULTIPLY",e[e.ADD=107]="ADD",e[e.SUBTRACT=109]="SUBTRACT",e[e.DECIMAL=110]="DECIMAL",e[e.DIVIDE=111]="DIVIDE",e[e.F1=112]="F1",e[e.F2=113]="F2",e[e.F3=114]="F3",e[e.F4=115]="F4",e[e.F5=116]="F5",e[e.F6=117]="F6",e[e.F7=118]="F7",e[e.F8=119]="F8",e[e.F9=120]="F9",e[e.F10=121]="F10",e[e.F11=122]="F11",e[e.F12=123]="F12",e[e.NUM_LOCK=144]="NUM_LOCK",e[e.SCROLL_LOCK=145]="SCROLL_LOCK",e[e.SEMICOLON=186]="SEMICOLON",e[e.EQUALS=187]="EQUALS",e[e.COMMA=188]="COMMA",e[e.DASH=189]="DASH",e[e.PERIOD=190]="PERIOD",e[e.FORWARD_SLASH=191]="FORWARD_SLASH",e[e.GRAVE_ACCENT=192]="GRAVE_ACCENT",e[e.OPEN_BRACKET=219]="OPEN_BRACKET",e[e.BACK_SLASH=220]="BACK_SLASH",e[e.CLOSE_BRACKET=221]="CLOSE_BRACKET",e[e.SINGLE_QUOTE=222]="SINGLE_QUOTE"}(r||(r={}))},7876:function(e,t,n){"use strict";n.r(t),n.d(t,"getClassNames",(function(){return a})),n.d(t,"getStyles",(function(){return i}));var r=n(545),o=n(2882),a=Object(r.classNamesFunction)(),i=e=>{var{theme:t}=e,{palette:n,fonts:r}=t;return{root:{padding:"10px"},card:{width:"88px",height:"88px",boxShadow:"0px 3px 6px ".concat("rgba(0, 0, 0, 0.11)"),borderRadius:"3px",selectors:{":hover":{cursor:"pointer",border:"0px",color:"red"},":hover div":{color:o.fabricColors.neutralPlum},":after":{border:"0px !important"},":focus":{outline:"1px solid ".concat(o.fabricColors.neutralChicago)},"@media (-webkit-min-device-pixel-ratio:0)":{selectors:{":focus":{outlineColor:o.fabricColors.neutralChicago,outlineStyle:"auto",outlineWidth:"1px"}}}}},iconContainer:{width:"88px",height:"88px",borderRadius:"3px",boxShadow:"0px 0.3px 0.9px rgba(0, 0, 0, 0.108), 0px 4px 4px rgba(0, 0, 0, 0.25)",paddingTop:"25px",textAlign:"center",selectors:{":hover":{boxShadow:"0px 8px 10px ".concat("rgba(0, 0, 0, 0.11)")}}},icon:{lineHeight:"42px",fontSize:"42px"},imageContainer:{width:"88px",height:"88px",borderRadius:"3px",boxShadow:"0px 0.3px 0.9px rgba(0, 0, 0, 0.108), 0px 4px 4px rgba(0, 0, 0, 0.25)",selectors:{":hover":{boxShadow:"0px 8px 10px ".concat("rgba(0, 0, 0, 0.11)")}}},contentRoot:{top:"117px",left:"0",right:"0",paddingTop:"12px",width:"88px"},contentText:[r.medium,{color:n.black,fontSize:"14px",textAlign:"center"}]}}},7877:function(e,t,n){"use strict";n.r(t),n.d(t,"DataSourceAppCardIcon",(function(){return d}));var r=n(687),o=n(1277),a=n(1755),i=n(245),s=n(2882),l=n(3076),c=n(2698),p=n(6711),u=n(922),d=Object(u.translateService)("PowerappsPortal")(e=>{var{environmentClient:t}=i.useContext(l.ApolloClientContext),{loading:n,apis:u}=Object(p.useApisQuery)(t,c.PortalScope,e.t("Common.Request.Failed"),!t);if(!t)return null;var{sampleApp:d,classNames:m}=e,g=d&&"/providers/microsoft.powerapps/apis/shared_commondataservice"==d.apiId.toLowerCase()?"/providers/microsoft.powerapps/apis/shared_commondataserviceforapps":d.apiId,h=u&&g&&u.find(e=>e.id.toLowerCase()==g.toLowerCase());return i.createElement(a.Shimmer,{shimmerElements:[{type:a.ShimmerElementType.line,height:92}],isDataLoaded:!!d&&!n},!!d&&!!h&&i.createElement(o.Image,{src:h&&h.iconUri,width:88,height:88,alt:d.displayName,className:m.imageContainer,role:"presentation"}),!!d&&!h&&(!!d.isImage&&i.createElement(o.Image,{src:null==d?void 0:d.getPreviewImageUrl(),width:88,height:88,alt:d.displayName,className:m.imageContainer,role:"presentation"})||i.createElement(r.Icon,{iconName:d&&d.getPreviewImageUrl(),ariaLabel:d.displayName,styles:{root:[m.iconContainer,{backgroundColor:d&&d.backgroundColor,color:d&&d.backgroundColor==s.fabricColors.white?s.fabricColors.neutralPlum:s.fabricColors.white}]},className:m.icon})))})},7878:function(e,t,n){"use strict";n.r(t),n.d(t,"partialSampleAppSectionStyleClasses",(function(){return u}));var r=n(719),o=n(3311),a=n(4185),i=n(7505),s=n(2871),l=n(2882),c=n(5492),p=Object(o.getABTestCaseName)(a.UseSimplifiedAppFromBlankTest,s.featureGates.enableSimplifiedAppFromBlank)===i.SimplifiedAppFromBlankTestCase.Simplified,u=Object(r.mergeStyleSets)({"partial-sample-apps-section":{margin:"0 0 48px 0",padding:"0",width:p?"auto":"95%",maxWidth:p?"1510px":"auto",selectors:{".partial-sample-apps-section-header":{selectors:{".partial-sample-apps-section-header-title":{fontFamily:c.fonts.segoeUiSemibold,fontSize:"16px",color:l.fabricColors.neutralDark,marginBottom:"15px",lineHeight:"19px",padding:"0 5px 0 10px",width:"100%"},".partial-sample-apps-section-header-title.create":{paddingLeft:"16px"}}},".sample-apps-list-items":{padding:"0",display:"flex",flexWrap:"wrap",selectors:{"> .sample-apps-list-tile-container":{paddingBottom:"10px",marginBottom:"10px !important",selectors:{">div":{selectors:{">div":{selectors:{":focus":{outline:"3px solid ".concat(l.fabricColors.neutralChicago)}}}}}}}}},".partial-sample-apps-section-link":{paddingRight:"8px",color:"lighten(#742774, 4%)",float:"right",textAlign:"right",margin:p?"-12px 0 0 0":"0"}}}})},7879:function(e,t,n){"use strict";n.r(t),n.d(t,"AppsSectionHostPage",(function(){return r})),n.d(t,"PartialModernSampleAppsSectionSimple",(function(){return h}));var r,o=n(1105),a=n(245),i=n(5437),s=n(7862),l=n(5623),c=n(5987),p=n(7880),u=n(7896),d=n(7495),m=n(5655),g=n(7878);!function(e){e.Home="Home",e.Create="Create"}(r||(r={}));var h=e=>{var t,{hostPage:n,t:h}=e,[b,f]=a.useState(!1),{currentEnvironment:y}=a.useContext(o.EnvironmentContext),S=Object(i.useSelector)(e=>Object(c.organizationSettingsSelector)(e)),C=!(!S||!S.enablecanvasappsinsolutionsbydefault),v=n===r.Create?Object(m.getOtherDataSourcesStaticSampleApp)(!(null==y||null===(t=y.properties)||void 0===t||!t.linkedEnvironmentMetadata),C):null;return a.createElement("div",{className:"".concat(g.partialSampleAppSectionStyleClasses["partial-sample-apps-section"]),style:{maxWidth:"auto"},role:"region","aria-label":h("Home.Samples.titleSimple")},a.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},a.createElement("div",{className:"partial-sample-apps-section-header ms-Grid-row"},a.createElement("div",{className:"partial-sample-apps-section-header-title ms-lg-8 ".concat(n===r.Create?"create":""),role:"heading","aria-level":3},a.createElement("div",null,h("Home.Samples.titleSimple"))))),a.createElement(u.ModernSampleAppsList,{sampleApps:Object(m.getModernStaticSampleAppsSimple)(!1,C),appListSectionType:m.AppsListSectionName.Simple,numberOfSampleAppsToShow:{lowerBound:5,upperBound:5}}),a.createElement("div",{className:"partial-sample-apps-section-link"},n===r.Home?a.createElement(s.NavigationLink,{linkLabel:h("PartialSampleAppsList.moreCreateOptions"),navigationEvent:d.PartialSampleAppsSectionEvents.Navigate,navigationRoute:l.templateAppsRoute.canvas}):a.createElement(s.NavigationLink,{linkLabel:h("PartialSampleAppsList.moreDataSources"),navigationEvent:d.PartialSampleAppsSectionEvents.Navigate,onClick:()=>f(!0)})),b&&a.createElement(p.ModernOpenConnectionsModal,{sampleApp:v,onDismiss:()=>f(!1)}))}},7880:function(e,t,n){"use strict";n.r(t),n.d(t,"ModernOpenConnectionsModal",(function(){return y}));var r=n(3788),o=n(3790),a=n(6988),i=n(6741),s=n(1087),l=n(245),c=n(5437),p=n(2871),u=n(5487),d=n(5619),m=n(5583),g=n(7516),h=n(7509),b=n(7881),f=n(5663),y=Object(m.withNavigation)(e=>{var t,{sampleApp:n,onDismiss:m,navigate:y}=e,[S,C]=l.useState(!1),v=Object(f.getDisplayName)(n),w=Object(f.getUrlParameters)(n),{rootProps:O}=l.useContext(u.RootPropsContext),P=Object(c.useDispatch)(),{mutate:E}=Object(b.useCreateSampleAppMutation)({currentEnvironment:O.currentEnvironment,sampleApp:n,newAppName:v,formFactor:Object(s.responsiveAFDTemplateEnabled)()?d.tablet:void 0}),A=null!==(t=null==w?void 0:w.connectorTypeParameter)&&void 0!==t?t:"",j=Object(r.getConnectionTypeByApiId)(A),L=Object(r.getApiNameBasedOnConnectionType)(j),T=l.useCallback(()=>{P(h.connectionsActions.createConnection({apiName:L,isParentReactModalExperience:!0,refreshParentModal:()=>C(!0)})),C(!1)},[L]);return n&&function(e){var t,n=!1;switch(e){case o.ConnectionType.SharePoint:n=p.featureGates.useSharepointAFDConnectionsModal,t=g.ABTestFeatures.UseSharepointAFDConnectionsModal;break;case o.ConnectionType.SqlServer:n=p.featureGates.useSqlServerAFDConnectionsModal,t=g.ABTestFeatures.UseSharepointAFDConnectionsModal;break;default:return!1}return g.ABTestingHelper.enableFeatureForABTesting(n,t)&&Object(i.isOpenSelectConnectionModalEnabled)(e)}(j)?l.createElement(a.SelectConnectionModal,{onDismiss:m,connectionType:j,openCreateConnectionModal:T,refetchConnection:S,isResponsiveAFDTemplateEnabled:Object(s.responsiveAFDTemplateEnabled)(),navigate:y,solutionId:null==w?void 0:w.solutionId}):(n&&E(),m(),l.createElement(l.Fragment,null))})},7881:function(e,t,n){"use strict";n.r(t),n.d(t,"useCreateSampleAppMutation",(function(){return b}));var r=n(245),o=n.n(r),a=n(3916),i=n(5658),s=n(5663),l=n(5656),c=n(7882),p=n(7884),u=n(7885),d=n(7886),m=n(7887);function g(e,t,n,r,o,a,i){try{var s=e[a](i),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}function h(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){g(a,r,o,i,s,"next",e)}function s(e){g(a,r,o,i,s,"throw",e)}i(void 0)}))}}var b=e=>{var{currentEnvironment:t,sampleApp:n,newAppName:r,formFactor:g,solutionId:b,designerTarget:f}=e,[y,S]=o.a.useState("idle"),C=Object(i.resolveSampleAppType)(n.sampleAppType,Object(s.getUniqueName)(n)),{mutate:v,status:w}=Object(m.useTPSSampleAppMutation)({currentEnvironment:t,sampleApp:n}),{mutate:O,status:P}=Object(p.useCanvasSampleAppMutation)({sampleApp:n,newAppName:r,formFactor:g}),{mutate:E,status:A}=Object(c.useAppModuleMutation)({currentEnvironment:t,sampleApp:n,formFactor:g}),{mutate:j,status:L}=Object(u.usePowerPortalSampleAppMutation)({sampleApp:n,newAppName:r}),{mutate:T,status:k}=Object(d.useStaticSampleAppMutation)({currentEnvironment:t,sampleApp:n,formFactor:g,newAppName:r,solutionId:b,designerTarget:f}),{mutate:R}=Object(a.useMutation)(h((function*(){n.sampleAppType===l.SampleAppTypes.TPSModel?v():n.sampleAppType===l.SampleAppTypes.Model?E():n.sampleAppType===l.SampleAppTypes.Canvas?O():n.sampleAppType===l.SampleAppTypes.Static&&C===l.SampleAppTypes.PowerPortal?j():n.sampleAppType===l.SampleAppTypes.Static&&T()})));return o.a.useEffect(()=>{n.sampleAppType===l.SampleAppTypes.TPSModel?S(w):n.sampleAppType===l.SampleAppTypes.Model?S(A):n.sampleAppType===l.SampleAppTypes.Canvas?S(P):n.sampleAppType===l.SampleAppTypes.Static&&C===l.SampleAppTypes.PowerPortal?S(L):n.sampleAppType===l.SampleAppTypes.Static&&S(k)},[w,A,P,L,k]),{mutate:R,status:y}}},7882:function(e,t,n){"use strict";n.r(t),n.d(t,"useAppModuleMutation",(function(){return v}));var r=n(245),o=n.n(r),a=n(3916),i=n(5656),s=n(5437),l=n(7545),c=n(5651),p=n(5663),u=n(5811),d=n(5653),m=n(5604),g=n(5468),h=n(2869),b=n(7883),f=n(7495),y=n(5630);function S(e,t,n,r,o,a,i){try{var s=e[a](i),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}function C(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){S(a,r,o,i,s,"next",e)}function s(e){S(a,r,o,i,s,"throw",e)}i(void 0)}))}}var v=e=>{var{currentEnvironment:t,sampleApp:n,formFactor:r}=e,[S,v]=o.a.useState("idle"),w=Object(s.useSelector)(e=>Object(u.sampleAppModulesSelector)(e,t.id)),O=Object(m.environmentHasCds2Database)(t),P=Object(s.useSelector)(e=>O&&Object(u.appModulesListError)(e,t.id)),E=Object(c.getAppModuleId)(Object(c.getAppModuleByUniqueName)(Object(p.getUniqueName)(n),w)),A=Object(s.useDispatch)(),j=Object(h.getResources)(),{mutate:L}=Object(b.useUpsellEnvironmentDialogMutation)({confirmDialogResponse:{hidden:!1,title:j.Model.Home.SampleApps.NoSampleApps.title,subText:j.Model.Home.SampleApps.NoSampleApps.message,confirmButtonText:j.MakerDashboard.CreateEnvironment.text,cancelButtonText:j.Controllers.Properties.okButton}});o.a.useEffect(()=>{A(Object(d.fetchAppModulesRequest)({appModuleListFilter:c.AppModuleListType.Sample}))},[]);var{mutate:T}=Object(a.useMutation)(C((function*(){n.sampleAppType===i.SampleAppTypes.Model&&(E?A(Object(y.logAction)(l.sampleAppModulesActions.editSampleAppModule({appModuleId:E}),f.SampleAppModuleTileEvents.Customize.eventName,Object(f.getModernSampleAppData)(n,"",r))):P?A(Object(y.logAction)(g.sharedActions.openAlertDialog({message:j.Model.Home.SampleApps.FailedToLoadAppsModule.message}),f.SampleAppModuleTileEvents.UpsellError.eventName,Object(f.getModernSampleAppData)(n,"",r))):L(),v("success"))})));return{mutate:T,status:S}}},7883:function(e,t,n){"use strict";n.r(t),n.d(t,"useUpsellEnvironmentDialogMutation",(function(){return m}));var r=n(3916),o=n(5437),a=n(5478),i=n(5876),s=n(5630),l=n(5474),c=n(7495);function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var m=e=>{var{confirmDialogResponse:t}=e,n=Object(o.useDispatch)(),{status:p,mutate:d}=Object(r.useMutation)(()=>(n(Object(s.logAction)(Object(l.openConfirmDialog)(u(u({},t),{},{onConfirm:()=>{null==t||t.onConfirm(),n(Object(s.logAction)(Object(l.panelOpen)({panelType:a.PanelToShowType.CreateEnvironmentPanel,panelProps:null}),i.CreateEnvironmentPanelEvents.CreatePanelOpened.eventName)),n(Object(l.closeConfirmDialog)())},hideCancelButton:!1})),c.SampleAppModuleTileEvents.UpsellEnvironment.eventName)),Promise.resolve()));return{mutate:d,status:p}}},7884:function(e,t,n){"use strict";n.r(t),n.d(t,"useCanvasSampleAppMutation",(function(){return l}));var r=n(3916),o=n(7539),a=n(5437),i=n(5630),s=n(7495),l=e=>{var{sampleApp:t,newAppName:n,formFactor:l}=e,c=Object(a.useDispatch)(),{status:p,mutate:u}=Object(r.useMutation)(()=>(c(Object(i.logAction)(o.sampleAppsActions.customizeSampleApp({sampleApp:t,formFactor:l,newAppName:n}),s.SampleAppTileEvents.Customize.eventName,Object(s.getModernSampleAppData)(t,"",l))),Promise.resolve()));return{status:p,mutate:u}}},7885:function(e,t,n){"use strict";n.r(t),n.d(t,"usePowerPortalSampleAppMutation",(function(){return m}));var r=n(3144),o=n(2808),a=n(245),i=n(3916),s=n(5437),l=n(5630),c=n(6541),p=n(5987),u=n(7495),d=n(5663),m=e=>{var{sampleApp:t,newAppName:n}=e,m=Object(d.getUniqueName)(t),g=Object(s.useSelector)(e=>Object(p.enableEngagementInsightsSelector)(e)),{environmentClient:h}=Object(a.useContext)(r.ApolloClientContext),b=Object(s.useDispatch)(),f=Object(o.useNavigate)(),{status:y,mutate:S}=Object(i.useMutation)(()=>(b(Object(l.logAction)(c.powerPortalActions.CreatePowerPortalModule({portalName:n,staticSampleAppId:m,navigate:f,environmentClient:h,enableEngagementInsights:g}),Object(u.getStaticAppTileEvents)(m),Object(u.getModernSampleAppData)(t,u.SampleAppsListContext))),Promise.resolve()));return{status:y,mutate:S}}},7886:function(e,t,n){"use strict";n.r(t),n.d(t,"useStaticSampleAppMutation",(function(){return y}));var r=n(1087),o=n(2808),a=n(3916),i=n(5437),s=n(5604),l=n(5630),c=n(5981),p=n(5871),u=n(5468),d=n(7495),m=n(5663),g=n(5657);function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){f(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var y=e=>{var{currentEnvironment:t,sampleApp:n,newAppName:h,formFactor:f,solutionId:y,designerTarget:S}=e,C=Object(i.useDispatch)(),v=Object(o.useNavigate)(),{status:w,mutate:O}=Object(a.useMutation)(()=>{switch(Object(m.getUniqueName)(n)){case g.StaticSampleAppId.NewApp:if(Object(s.canUserCreatePowerApp)(t)){var e=Object(r.getAppFromBlankUri)(t.name,f,y,h);v(e)}else C(u.sharedActions.openUpsellEnvironmentModal({upsellModal:{message:Object(s.getDefaultCreateEnvironmentMessage)(t)}}));break;case g.StaticSampleAppId.NewAppModule:C(Object(l.logAction)(p.appModulesActions.createAppModule({appName:h,designerTarget:S,solutionId:y,navigate:v}),d.StaticAppTileEvents.CreateAppModule.eventName,b(b({},Object(d.getModernSampleAppData)(n,d.SampleAppsListContext)),{},{designerTarget:S,hasSolutionId:!!y})));break;default:C(Object(l.logAction)(c.appsActions.createAnApp({createAppParams:Object(m.getUrlParameters)(n),navigate:v}),d.StaticAppTileEvents.Customize.eventName,Object(d.getModernSampleAppData)(n,d.SampleAppsListContext,f)))}return Promise.resolve()});return{status:w,mutate:O}}},7887:function(e,t,n){"use strict";n.r(t),n.d(t,"useTPSSampleAppMutation",(function(){return f}));var r=n(1087),o=n(2808),a=n(245),i=n.n(a),s=n(3916),l=n(5604),c=n(2869),p=n(5663),u=n(7888),d=n(7889),m=n(7890),g=n(7891),h=n(7893),b=n(7883),f=e=>{var{currentEnvironment:t,sampleApp:n}=e,a=null==t?void 0:t.name,f=null==t?void 0:t.id,[y,S]=i.a.useState("idle"),C=Object(c.getResources)(),v=Object(o.useNavigate)(),{status:w,mutate:O}=Object(b.useUpsellEnvironmentDialogMutation)({confirmDialogResponse:{hidden:!1,title:C.Model.Home.SampleApps.NoSampleApps.title,subText:C.Model.Home.SampleApps.NoSampleApps.message,confirmButtonText:C.MakerDashboard.CreateEnvironment.text,cancelButtonText:C.Controllers.Properties.okButton}}),{sampleAppSolution:P}=Object(m.useFetchSolutionForSampleApp)({solutionUniqueName:n.uniqueName,currentEnvironment:t}),{operationId:E,solutionAlreadyInstalled:A,status:j,mutate:L}=Object(g.useInstallPackageMutation)({packageUniqueName:n.uniqueName,environmentName:a,environmentId:f}),{mutate:T}=Object(s.useMutation)(()=>(Object(l.environmentHasCds2Database)(t)?L():O(),Promise.resolve())),{status:k}=Object(h.usePollInstallPackage)({operationId:E,packageUniqueName:n.uniqueName,environmentName:a,skip:A}),R=!A&&"success"!==k,{status:D,solutionCanvasAppComponents:M}=Object(d.useFetchCanvasAppComponentsForSampleApp)({sampleAppSolution:P,currentEnvironment:t,skip:R});return i.a.useEffect(()=>{if("success"===D&&M.length){var e=Object(r.getEditAppUri)(a,Object(r.getAppId)(Object(p.getDefaultCanvasAppSolutionComponent)(M).msdyn_canvasappuniqueid));v(e,!1)}},[D,M]),i.a.useEffect(()=>{var e=Object(u.getCombinedStatus)([j,...A?[]:[k],D],u.CombinedStatusOperator.And),t=Object(u.getCombinedStatus)([w,e],u.CombinedStatusOperator.Or);S(t)},[w,A,j,k,D]),{status:y,mutate:T}}},7888:function(e,t,n){"use strict";var r;n.r(t),n.d(t,"CombinedStatusOperator",(function(){return r})),n.d(t,"getCombinedStatus",(function(){return o})),function(e){e[e.And=0]="And",e[e.Or=1]="Or"}(r||(r={}));var o=(e,t)=>e.some(e=>"error"===e)?"error":e.some(e=>"loading"===e)?"loading":(t===r.And?e.every(e=>"success"===e):e.some(e=>"success"===e))?"success":"idle"},7889:function(e,t,n){"use strict";n.r(t),n.d(t,"useFetchCanvasAppComponentsForSampleApp",(function(){return p}));var r=n(245),o=n.n(r),a=n(5437),i=n(5686),s=n(5810),l=n(2830),c={logicalName:"canvasapp",typeCode:l.SolutionComponentTypeCode.CanvasApp,extendedTypeCode:l.SolutionComponentTypeCodeExt.CanvasAppsOnly},p=e=>{var{sampleAppSolution:t,currentEnvironment:n,skip:r}=e,[l,p]=o.a.useState("idle"),u=Object(a.useSelector)(e=>Object(s.solutionComponentListSelector)(e,null==t?void 0:t.id,n,[c])),d=Object(a.useDispatch)();return o.a.useEffect(()=>{!r&&t&&d(Object(i.fetchSolutionComponentsRequest)({solutionId:t.id,componentTypes:[c]}))},[r,t]),o.a.useEffect(()=>{!r&&u.length&&p("success")},[r,u]),{status:l,solutionCanvasAppComponents:u}}},7890:function(e,t,n){"use strict";n.r(t),n.d(t,"useFetchSolutionForSampleApp",(function(){return c}));var r=n(245),o=n.n(r),a=n(5437),i=n(5690),s=n(5691),l=n(5676),c=e=>{var{solutionUniqueName:t,currentEnvironment:n}=e,[r,c]=o.a.useState("idle"),p=Object(a.useSelector)(e=>Object(s.solutionsSelector)(e,null==n?void 0:n.id)),u=o.a.useMemo(()=>p.find(e=>e.uniquename===t),[p]),d=Object(a.useDispatch)();return o.a.useEffect(()=>{c("loading"),d(Object(i.fetchSolutionsRequest)({solutionTypeFilterOption:l.SolutionTypeFilterOptions.All,forceRefresh:!0}))},[t]),o.a.useEffect(()=>{u&&c("success")},[u]),{status:r,sampleAppSolution:u}}},7891:function(e,t,n){"use strict";n.r(t),n.d(t,"useInstallPackageMutation",(function(){return c}));var r=n(245),o=n.n(r),a=n(3916),i=n(5437),s=n(5691),l=n(7892),c=e=>{var{packageUniqueName:t,environmentName:n,environmentId:r}=e,[c,p]=o.a.useState(),[u,d]=o.a.useState(!1),m=Object(i.useSelector)(e=>Object(s.solutionsSelector)(e,r)),g=o.a.useMemo(()=>m.find(e=>e.uniquename===t),[m]),{status:h,mutate:b}=Object(a.useMutation)(()=>g?(d(!0),Promise.resolve()):Object(l.installPackageInEnvironmentAPI)({environmentName:n,packageUniqueName:t}).then(e=>p(e.lastOperation.operationId)).catch(e=>{if(!Object(l.isTPSInstallErrorForSolutionAlreadyInstalled)(e))throw e;d(!0)}));return{operationId:c,solutionAlreadyInstalled:u,status:h,mutate:b}}},7892:function(e,t,n){"use strict";n.r(t),n.d(t,"TPS_ALREADY_INSTALLED_ERROR_MESSAGE",(function(){return i})),n.d(t,"installPackageInEnvironmentAPI",(function(){return s})),n.d(t,"isTPSInstallErrorForSolutionAlreadyInstalled",(function(){return l}));var r=n(5604),o=n(5606),a=n(1146),i="The package you are trying to install is already installed in the target org.",s=e=>{var{environmentName:t,packageUniqueName:n}=e;return Object(r.canUserCreatePowerApp)(o.SagaContextProps.getCurrentEnvironment())||Promise.reject(),a.default.post(function(e,t){return"https://ppapi-tenant-level/appmanagement/environments/".concat(e,"/applicationPackages/").concat(t,"/install?api-version=1")}(t,n),{}).then(e=>e.data)},l=e=>{var t,n,r,o;return 400===(null==e||null===(t=e.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.StatusCode)&&(null==e||null===(r=e.response)||void 0===r||null===(o=r.data)||void 0===o?void 0:o.Message)===i}},7893:function(e,t,n){"use strict";n.r(t),n.d(t,"usePollInstallPackage",(function(){return l}));var r=n(3916),o=n(5593),a=n(7894),i=n(7895),s=15e3,l=e=>{var{operationId:t,packageUniqueName:n,environmentName:i,skip:l,pollIntervalInMs:p=s}=e,{data:u,status:d}=Object(r.useQuery)([t],()=>Object(a.pollInstallPackageInEnvironmentAPI)({environmentName:i,operationId:t}).then(e=>{if("success"===c(e))return e;throw new Error("usePollInstallPackageError")}),{enabled:!l&&!!t,retry:(e,r)=>(15==e&&Object(o.trackInfoTrace)("SampleAppPollInstallPackageTimeout",{operationId:t,packageUniqueName:n,error:r,modernExperience:!0}),e<15),retryDelay:Math.max(p,5e3)});return{status:d,data:u}},c=e=>{switch(e.status){case i.TPSPollInstallStatus.Succeeded:return"success";case i.TPSPollInstallStatus.Running:return"loading";case i.TPSPollInstallStatus.NotStarted:return"idle";case i.TPSPollInstallStatus.Failed:default:return"error"}}},7894:function(e,t,n){"use strict";n.r(t),n.d(t,"pollInstallPackageInEnvironmentAPI",(function(){return o}));var r=n(1146),o=e=>{var{operationId:t,environmentName:n}=e;return r.default.get(function(e,t){return"https://ppapi-tenant-level/appmanagement/environments/".concat(e,"/operations/").concat(t,"?api-version=1")}(n,t)).then(e=>e.data)}},7895:function(e,t,n){"use strict";var r;n.r(t),n.d(t,"TPSPollInstallStatus",(function(){return r})),function(e){e.Succeeded="Succeeded",e.Running="Running",e.NotStarted="NotStarted",e.Failed="Failed"}(r||(r={}))},7896:function(e,t,n){"use strict";n.r(t),n.d(t,"ModernSampleAppsList",(function(){return O}));var r=n(245),o=n.n(r),a=n(5898),i=n(923),s=n(2879),l=n(1235),c=n(3161),p=n(5628),u=n(7897),d=n(7899),m=n(7904),g=n(5669),h=n(7906),b=n(5593),f=n(5663),y=n(1795),S=n(7907),C=n(5655),v=n(5657),w=n(7908),O=Object(m.withLazyLoadedSampleApps)(Object(S.withSortedSampleAppsList)(Object(h.withFilteredSampleAppsList)(e=>{var{sampleApps:t,appListSectionType:n,isLoading:r,numberOfSampleAppsToShow:m,loadProgress:h}=e,{t:S}=Object(i.useTranslation)("PowerappsPortal"),[O,P]=o.a.useState();Object(a.useLoadProgressTelemetry)({eventScope:g.LoadScenarioNames.ModernSampleAppsList,scenarioName:g.LoadScenarioNames.ModernSampleAppsList,loadProgress:h});var E=o.a.useCallback(()=>r?m&&m.upperBound||3:t.length,[r,t,3,m,null==m?void 0:m.upperBound])(),A={numberOfAppsToDisplayOnResize:E,cacheKey:"".concat(E)},j=o.a.useCallback((e,t)=>({icon:s.fabricIcons.PowerAppsLogo,primaryMessage:e,secondaryMessage:[t],maxWidth:p.emptyStateMaxWidth}),[]),L=o.a.useCallback(()=>o.a.createElement(c.EmptyState,j(S("EmptySearchState.noMatch"),S("EmptySearchState.tryNewSearch"))),[]),T=o.a.useCallback(e=>{var a,i;return r?(a=new Array(e.numberOfAppsToDisplayOnResize).fill(null),i=!1):i=0===(a=t).length,o.a.createElement(y.Stack,{horizontal:!0,wrap:!0},i?L():a.map((e,r)=>{var a=Object(f.getUniqueName)(e);if(n===C.AppsListSectionName.StartFromData||n===C.AppsListSectionName.Simple&&a!==v.StaticSampleAppId.NewApp&&a!==v.StaticSampleAppId.SelectApp){var i={sampleApp:e,isSimpleView:n===C.AppsListSectionName.Simple};return o.a.createElement("div",{key:Object(f.getDisplayName)(e),className:"sample-apps-list-tile-container"},o.a.createElement(w.ModernDataSourceAppCard,i))}var s,l={sampleApp:e,isSimpleView:n===C.AppsListSectionName.Simple,openSampleAppModal:(s=r,e=>{Object(b.trackUserActionClickButton)(g.SampleAppScenarioNames.OpenAppModalClickEvent,{appDisplayName:Object(f.getDisplayName)(e),appType:e.sampleAppType,appUniqueName:Object(f.getUniqueName)(e),listLocation:s,listSize:t.length,modernExperience:!0}),P(e)})};return o.a.createElement(y.StackItem,{key:a||r},o.a.createElement(u.ModernSampleAppCard,l))}),!r&&!!O&&o.a.createElement(d.ModernCreateAppModal,{sampleApp:O,initialFormFactor:"tablet",onDismissModal:()=>{P(void 0)}}))},[r,t,O]),k=o.a.useCallback(e=>m&&m.lowerBound&&e.numberOfAppsToDisplayOnResize>m.lowerBound?{numberOfAppsToDisplayOnResize:e.numberOfAppsToDisplayOnResize-1,cacheKey:"".concat(e.numberOfAppsToDisplayOnResize-1)}:void 0,[m]);return o.a.createElement(l.ResizeGroup,{data:A,onRenderData:T,onReduceData:k})})))},7897:function(e,t,n){"use strict";n.r(t),n.d(t,"ModernSampleAppCardBase",(function(){return g})),n.d(t,"ModernSampleAppCard",(function(){return h}));var r=n(1524),o=n(687),a=n(1277),i=n(1755),s=n(545),l=n(245),c=n(5656),p=n(5663),u=n(7898),d=n(7871);function m(){return(m=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var g=e=>{var{sampleApp:t,isSimpleView:n,openSampleAppModal:s,styles:g,theme:h}=e,b=Object(d.getClassNames)(g,{theme:h,isStaticApp:!t||t.sampleAppType===c.SampleAppTypes.Static,isAppFromData:!1}),f=Object(p.getDisplayName)(t),y=l.useCallback(()=>{t&&s(t)},[t]),S=l.useCallback(()=>l.createElement(i.Shimmer,{shimmerElements:[{type:i.ShimmerElementType.line,height:123}],isDataLoaded:!!t},!!t&&l.createElement(a.Image,{src:Object(p.getPreviewImageUrl)(t),styles:{root:b.imageContainer,image:b.image},alt:f})),[t,b]),C=l.useCallback(()=>{var e=t?Object(p.getSampleAppTag)(t):{sampleAppIconProps:{},appTypeDisplayName:""};return l.createElement("div",{className:b.contentRoot},l.createElement("div",{className:b.contentText},l.createElement(i.Shimmer,{width:150,shimmerElements:[{type:i.ShimmerElementType.line,height:19}],isDataLoaded:!!t,styles:{dataWrapper:[b.contentText]}},f)),l.createElement("div",{className:b.appTagContainer},l.createElement(i.Shimmer,{width:134,shimmerElements:[{type:i.ShimmerElementType.line,width:14,height:14},{type:i.ShimmerElementType.gap,width:4},{type:i.ShimmerElementType.line,height:14}],isDataLoaded:!!t},e&&l.createElement(o.Icon,m({className:b.appTagIcon},e.sampleAppIconProps)),e&&l.createElement("div",{className:b.appTagText}," ",e.appTypeDisplayName," "))))},[t,b]);return n?l.createElement(u.ModernSampleAppCardSimple,{app:t,onCardClicked:y}):l.createElement("div",{className:b.root},l.createElement(r.DocumentCard,{onClick:y,className:b.card,"data-is-loaded":!!t},S(),C()))},h=Object(s.styled)(g,d.getStyles)},7898:function(e,t,n){"use strict";n.r(t),n.d(t,"ModernSampleAppCardSimple",(function(){return c}));var r=n(1524),o=n(1277),a=n(545),i=n(245),s=n(5663),l=n(7873),c=Object(a.styled)(e=>{var{app:t,onCardClicked:n,onCardKeyDown:l,styles:c,theme:p}=e,u=Object(a.classNamesFunction)()(c,{theme:p});return i.createElement("div",{className:u.root,onKeyDown:l},i.createElement(r.DocumentCard,{className:u.card,onClick:n,tabIndex:0,role:"button","data-is-focusable":!0,"data-is-loaded":!!t},i.createElement("div",{className:u.iconContainer,style:{backgroundColor:Object(s.getBackgroundColor)(t)}},i.createElement(o.Image,{alt:Object(s.getDisplayName)(t),src:Object(s.getPreviewImageUrl)(t),role:"presentation"})),i.createElement("div",{className:u.title},Object(s.getDisplayName)(t)),i.createElement("div",{className:u.description},Object(s.getTileDescription)(t))))},l.getStyles)},7899:function(e,t,n){"use strict";n.r(t),n.d(t,"StyledModernCreateAppModalBase",(function(){return te})),n.d(t,"ModernCreateAppModal",(function(){return ne}));var r=n(4084),o=n(685),a=n(1091),i=n(1697),s=n(860),l=n(1755),c=n(1201),p=n(545),u=n(2703),d=n(2704),m=n(1101),g=n(5642),h=n(923),b=n(217),f=n(5997),y=n(2812),S=n.n(y),C=n(245),v=n(5437),w=n(5487),O=n(5604),P=n(2888),E=n(5644),A=n(5645),j=n(5593),L=n(5669),T=n(5629),k=n(5481),R=n(2869),D=n(2880),M=n(5630),N=n(5985),x=n(6541),I=n(5987),F=n(5468),B=n(5474),U=n(5626),G=n(7900),z=n(7881),H=n(7901),_=n(5656),W=n(5657),V=n(7902),q=n(7495),K=n(5658),Y=n(5663),Q=n(5995),X=n(5991),J=n(7504),$=n(7903);function Z(){return(Z=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function ee(e,t,n,r,o,a,i){try{var s=e[a](i),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}var te=Object(p.styled)(e=>{var t,n,p,{initialFormFactor:u,onDismissModal:y,closeCanvas:te,styles:ne,preloadCanvas:re}=e,[oe,ae]=C.useState(!1),[ie,se]=C.useState(!1),[le,ce]=C.useState(!1),[pe,ue]=C.useState(""),[de,me]=C.useState(""),[ge,he]=C.useState(""),[be,fe]=C.useState(),[ye,Se]=C.useState(g.ModelAppDesignerTarget.Classic),[Ce,ve]=C.useState(),we=Ce||e.sampleApp,Oe=Object(K.resolveSampleAppType)(we.sampleAppType,Object(Y.getUniqueName)(we)),Pe=Object(Y.getDisplayName)(we),Ee=Object(Y.getUniqueName)(we),Ae=Object(R.getResources)(),je=Object(Q.getClassNames)(ne),Le=Object(v.useSelector)(e=>Object(U.allowListFeaturesSelector)(e)),Te=Object(v.useSelector)(e=>Object(I.componentLoadStateSelector)(e)),ke=Object(v.useDispatch)(),{t:Re}=Object(h.useTranslation)("PowerappsPortal"),{rootProps:De}=C.useContext(w.RootPropsContext),Me=Object(v.useSelector)(e=>Object(I.organizationSettingsSelector)(e)),Ne=!(!Me||!Me.enablecanvasappsinsolutionsbydefault),xe=Object(v.useSelector)(e=>Object(I.enableEngagementInsightsSelector)(e)),Ie=Object(v.useSelector)(e=>Object(I.portalCreateModalErrorMessageSelector)(e,De.currentEnvironment.id)),Fe=Object(v.useSelector)(e=>Object(I.portalSubDomainSelector)(e)),Be=Object(v.useSelector)(e=>Object(I.websiteIdSelector)(e,Ge)),Ue=!!Be&&Be.trim().length>0,Ge=O.getCrmInstanceUrl(De.currentEnvironment),ze=null===(t=Object(v.useSelector)(e=>Object(U.orgEnabledLanguagesSelector)(e,Ge)))||void 0===t?void 0:t.filter(e=>Object(A.checkPortalSupportedLanguage)(e.localeId)),He=!!(ze&&ze.length>0),_e=Object(v.useSelector)(e=>x.powerPortalSelectors.environmentHasCDSOrgSelector(e,De.currentEnvironment.id)),We=Object(A.getPowerPortalPackageName)(Ee,_e),Ve=Object(v.useSelector)(e=>Object(I.powerPortalPrerequisitesSelector)(e,De.currentEnvironment.id,E.PowerPortalOperationType.Provision,We)),qe=Oe!==_.SampleAppTypes.PowerPortal||!Ve||Ve.IsPackageInstalled,Ke=null!==(n=De.currentEnvironment)&&void 0!==n&&null!==(p=n.properties)&&void 0!==p&&p.linkedEnvironmentMetadata&&Object(Y.getUniqueName)(we)==W.StaticSampleAppId.NewApp?P.CDS_DEFAULT_SOLUTION_ID:void 0,{mutate:Ye}=Object(H.useOpenCreateNewEnvironmentPanelMutation)({currentEnvironment:De.currentEnvironment}),{mutate:Qe,status:Xe}=Object(z.useCreateSampleAppMutation)({currentEnvironment:De.currentEnvironment,sampleApp:we,newAppName:de||Pe,formFactor:be,solutionId:Ke,designerTarget:ye});C.useEffect(()=>{switch(Xe){case"success":st(!1,!1);break;case"error":he(Ae.Model.Home.SampleApps.FailedToInstallSolution.title),ae(!1)}},[Xe]);var Je=C.useCallback(()=>{y(),Ye()},[y,Ye]),$e=C.useCallback(e=>{if(""!==ge)return!1;if(Oe===_.SampleAppTypes.PowerPortal){var t=He&&!pe&&!!e&&!!Fe&&!oe&&!Ie;return Ee===W.StaticSampleAppId.NewPowerPortalIdeasApp?t&&Ue:t}return!!(Oe===_.SampleAppTypes.Model||null!=we&&we.hideRightPanel)||!!e&&!pe},[we,ge,Oe,He,pe,Fe,oe,Ie,Ee,Ue]),Ze=C.useCallback(e=>{var t,n;$e(e)&&(ae(!0),Object(b.trackInfoTrace)("CreateApp",{eventName:"onCreateNewApp",eventData:{isDataVerseEnvironment:!(null===(t=De.currentEnvironment)||void 0===t||null===(n=t.properties)||void 0===n||!n.linkedEnvironmentMetadata),enableCanvasAppsInSolutionsByDefault:m.featureGates.enableCanvasAppsInSolutionsByDefault,orgSettingsEnableCanvasAppsInSolutionsByDefault:Ne,solutionId:Ke,appDisplayName:e,appUniqueName:Ee,enableEngagementInsights:xe,modernExperience:!0}}),Qe())},[Qe,$e,De,Ke,Ee,xe,Ne]),et=C.useCallback((e,t)=>{0===t.trim().length?ue(Ae.CreateAppModal.FormSection.DisplayName.Validation.Empty.text):e!==_.SampleAppTypes.PowerPortal&&(ue(""),Object(G.validateAppDisplayNameAPI)({appDisplayName:t,environment:De.currentEnvironment}).then(()=>me(t)).catch(e=>{ue(Ae.CreateAppModal.FormSection.DisplayName.Validation.AllowedCharacters.text)}))},[Ae]),tt=C.useCallback(e=>{fe(e)},[]),nt=C.useCallback(e=>{Se(e)},[]),rt=C.useCallback(()=>C.createElement(l.ShimmerElementsGroup,{width:"100%",flexWrap:!0,shimmerElements:[{type:l.ShimmerElementType.line,width:"30%",height:12},{type:l.ShimmerElementType.gap,width:"70%",height:12},{type:l.ShimmerElementType.gap,width:"100%",height:7},{type:l.ShimmerElementType.line,width:"70%",height:12},{type:l.ShimmerElementType.gap,width:"30%",height:12}]}),[]),ot=()=>!S.a.isEmpty(ge)||!S.a.isEmpty(Ie)||!qe&&_e||Ee===W.StaticSampleAppId.NewPowerPortalPartnerApp,at=C.useCallback(()=>be||u,[be,u]),it=C.useCallback(()=>oe?C.createElement(c.Spinner,{size:c.SpinnerSize.small,labelPosition:"right"}):C.createElement(C.Fragment,null),[oe]),st=(e,t)=>{Object(j.trackUserActionClickButton)(L.SampleAppScenarioNames.CloseAppModalClickEvent,{appDisplayName:Pe,appType:Oe,appUniqueName:Ee,modernExperience:!0}),e&&lt()&&te(),y()},lt=()=>we.sampleAppType===_.SampleAppTypes.Canvas,ct=()=>we.sampleAppType===_.SampleAppTypes.Static?ot()?je.formSectionWithErrorMessage:je.formSection:ot()?je.formSectionOthersFromBlankWithErrorMessage:je.formSectionOthersFromBlank,pt=(e,t,n)=>{var r;return r=n&&e?Object(D.formatResourceStringToElement)(e,(e,t)=>n[t](e)):C.createElement(C.Fragment,null,e),{messageBarProps:{messageBarType:t,styles:{root:{width:"calc(100% - "+(Object(Q.isLesserOrEqualToScreenSize)(s.ResponsiveMode.medium)?"20px":"0px")+")"}}},onRenderBody:()=>C.createElement(C.Fragment,null,r)}};if(!we)return null;var ut,dt,mt,gt,ht,bt,ft,yt={onRenderHeader:()=>C.createElement(C.Fragment,null,C.createElement("div",{className:je.backButtonContainer},le&&C.createElement(o.ActionButton,{className:je.backButton,iconProps:{iconName:"Back"},onClick:()=>{se(!0),ce(!1),ve(void 0)}}),C.createElement("div",null,C.createElement("h2",{className:je.header},St?Re(Ae.CreateAppModal.SelectAppTypeSection.title):Pe))))},St=ie||Object(Y.getUniqueName)(we)===W.StaticSampleAppId.SelectApp;if(St)ut=[{className:je.appSelectionSection,onRenderBody:()=>C.createElement(V.ModernSelectAppTypeSection,{onAppSelected:function(){var e,t=(e=function*(e){lt&&te(),se(!1),ce(!0),ve(e)},function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){ee(a,r,o,i,s,"next",e)}function s(e){ee(a,r,o,i,s,"throw",e)}i(void 0)}))});return function(e){return t.apply(this,arguments)}}()})}],dt=null;else{var Ct="";we.sampleAppType===_.SampleAppTypes.Model||we.sampleAppType===_.SampleAppTypes.TPSModel?Ct=Pe:we.sampleAppType===_.SampleAppTypes.Canvas&&(gt=Pe,ht=new Date,bt=ht.getUTCHours(),ft=ht.getUTCMinutes(),Ct="".concat(gt,"_").concat(("0"+bt).slice(-2)).concat(("0"+ft).slice(-2))),ut=(e=>{var t,n={initialDisplayName:e,sampleAppType:Oe,allowedFormFactors:Object(Y.getAllowedFormFactors)(we),selectedFormFactor:at(),selectedModelAppDesignerTarget:ye,connectionReferences:Object(Y.getConnectionReferences)(we),onAppNameChanged:e=>et(we.sampleAppType,e),onFormFactorChanged:e=>tt(e),onModelAppDesignerTargetChanged:e=>nt(e),isGlobalErrorMessagePresent:ot(),fieldErrorMessage:pe,componentLoadState:Te,customShimmerElements:()=>rt()},r=Oe!==_.SampleAppTypes.PowerPortal?C.createElement(X.CreateAppFormSection,Z({},n,{isDisplayNameReadOnly:we.sampleAppType===_.SampleAppTypes.Model||we.sampleAppType===_.SampleAppTypes.TPSModel,componentLoadState:T.ComponentLoadState.Complete})):C.createElement(J.CreatePowerPortalFormSectionContainer,Z({},n,{isDisplayNameReadOnly:oe,sampleAppUniqueName:Ee})),o={className:we.sampleAppType===_.SampleAppTypes.Static?je.detailsSection:je.detailsSectionOthersFromBlank,onRenderBody:()=>C.createElement($.ModernCreateAppDetailsSection,{sampleApp:we,formFactor:be,onPreviewSampleApp:we.sampleAppType===_.SampleAppTypes.Canvas?()=>{ke(Object(M.logAction)(F.sharedActions.openNewTab({uri:Object(N.getLaunchUrlForSampleApp)(we,Le,be,De.currentEnvironment)}),q.SampleAppTileEvents.Preview.eventName,Object(q.getModernSampleAppData)(we,"",be)))}:void 0,onLearnMoreClick:()=>{ke(Object(B.openNewTab)({uri:k.default.getStartedAppModules}))}},Object(Q.isLesserOrEqualToScreenSize)(s.ResponsiveMode.medium)?r:void 0)},a={className:ct(),onRenderBody:()=>r};return t=[o],Object(Q.isLesserOrEqualToScreenSize)(s.ResponsiveMode.medium)||t.push(a),t})(Ct),mt=de||Ct,dt=[{name:Ae.CreateAppModal.Footer.Buttons.createButton,"data-test-id":f.powerPlatformDataIds.canvasAppCreateButtonId,dismissableOnClick:()=>Ze(mt),text:Ae.CreateAppModal.Footer.Buttons.createButton,primary:!0,disabled:!$e(mt)||oe,onRenderIcon:it},{name:Ae.CreateAppModal.Footer.Buttons.cancelButton,dismissableOnClick:()=>st(!0,!0),text:Ae.CreateAppModal.Footer.Buttons.cancelButton,disabled:!1}]}var vt={isOpen:!0,isClickableOutsideFocusTrap:!1,ignoreExternalFocusing:!0,forceFocusInsideTrap:!0,isBlocking:!0,styles:je.subComponentStyles.modalStyles,closeButtonAriaLabel:Ae.Common.cancel,onDismiss:()=>st(!0,!0),header:yt,sections:ut};return C.createElement(r.Modal,Z({key:"".concat(Ee,"-modal"),onLayerDidMount:()=>{lt()&&re((e,t,n,r)=>Object(d.getStudioUrlAndWebAuthoringVersion)(e,t,n,void 0,void 0,r))},showDismissButton:!oe,messageBar:(()=>{if(ge){var e=Object(Q.isLesserOrEqualToScreenSize)(s.ResponsiveMode.medium);return{messageBarProps:{messageBarType:i.MessageBarType.error,styles:{root:{width:"calc(100% - "+(e?"20px":"0px")+")"}}},onRenderBody:()=>C.createElement(C.Fragment,null,ge)}}if(Oe===_.SampleAppTypes.PowerPortal){if(Ie){var t=Object(A.getPowerPortalErrorMessageAndLogTheException)(Ie,_e),n=(()=>{switch(Ie.errorCode){case"D004":return[e=>C.createElement(a.Link,{onClick:Je},e),e=>C.createElement(a.Link,{className:je.removePaddingFromLink,href:k.default.getPowerPortalUnauthorizedLearnMoreLink,target:"_blank"},e)];case"A022":return _e?[()=>C.createElement(C.Fragment,null,Ie.licenseCount),e=>C.createElement(a.Link,{href:"#",className:je.removePaddingFromLink,onClick:Je},e),e=>C.createElement(a.Link,{href:k.default.getPowerPortalLimitExceedLearnMoreLink,target:"_blank"},e)]:[()=>C.createElement(C.Fragment,null,Ie.licenseCount),()=>C.createElement(C.Fragment,null,Object(A.getNonCDSPortalType)(Ee)),e=>C.createElement(a.Link,{href:k.default.getPowerPortalLimitExceedLearnMoreLink,target:"_blank"},e)];case"A023":return[()=>C.createElement(C.Fragment,null,Ie.licenseCount)];case"A011":return[e=>C.createElement(a.Link,{href:k.default.getPowerPortalADDAppRegistrationLearnMoreLink,target:"_blank"},e)];case"A024":return[e=>C.createElement(a.Link,{href:k.default.getPowerPortalBlockedTenantLearnMoreLink,target:"_blank"},e)];case"A026":return[e=>C.createElement(a.Link,{href:k.default.dualWriteSolutions,target:"_blank",style:{paddingLeft:"0px",textDecoration:"underline"}},e)];case"A027":return[e=>C.createElement(a.Link,{href:k.default.ideasPortalTpsLink,target:"_blank"},e)];case"A028":return[e=>C.createElement(a.Link,{href:k.default.fieldServiceAppPortalTpsLink,target:"_blank"},e)];case"A030":return[e=>C.createElement(a.Link,{onClick:Je},e)];case"A031":return[e=>C.createElement(a.Link,{href:k.default.ideasPortalDocsLink,target:"_blank"},e)];default:return[e=>C.createElement(a.Link,{onClick:Je},e)]}})();return pt(t,i.MessageBarType.error,n)}if(!qe&&_e){var r=[e=>C.createElement(a.Link,{onClick:Je},e)],o=Ae.SampleApps.AppModule.createFromBlankPortal.solutionNotInstalled.description;return pt(o,i.MessageBarType.info,r)}}return null})(),footerButtons:dt},vt))},Q.getStyles),ne=Object(u.withOptimizedCanvasHost)(te)},7900:function(e,t,n){"use strict";n.r(t),n.d(t,"validateAppDisplayNameAPI",(function(){return l}));var r=n(1146),o=n(5794),a=n(5761),i=n(2872),s=n(5768),l=e=>{var{environment:t,appDisplayName:n}=e,l=Object(o.validateAppDisplayNameUrl)(t.name),c=Object(a.addEndpointAndVersion)(l,i.settings,t),p={displayName:n};return r.default.post(c,JSON.stringify(p),{headers:{"Content-Type":"application/json"}}).then(e=>{if(Object(s.getValidateAppDisplayNameError)(e))throw new Error("Invalid name");return e.data})}},7901:function(e,t,n){"use strict";n.r(t),n.d(t,"useOpenCreateNewEnvironmentPanelMutation",(function(){return d}));var r=n(3916),o=n(5437),a=n(5478),i=n(5876),s=n(5630),l=n(5981),c=n(5667),p=n(5468),u=n(5656),d=e=>{var{currentEnvironment:t}=e,n=Object(o.useDispatch)(),{status:d,mutate:m}=Object(r.useMutation)(()=>(n(Object(s.logAction)(p.sharedActions.panelOpen({panelType:a.PanelToShowType.CreateEnvironmentPanel,panelProps:{sampleAppType:u.SampleAppTypes.PowerPortal}}),i.CreateEnvironmentPanelEvents.CreatePanelOpened.eventName)),n(l.appsActions.resetValidateAppDisplayNameError()),n(Object(c.resetPowerPortalCreateModalError)({environmentId:t.id})),n(Object(c.resetCreatePowerPortalFields)()),Promise.resolve()));return{mutate:m,status:d}}},7902:function(e,t,n){"use strict";n.r(t),n.d(t,"ModernSelectAppTypeSection",(function(){return A}));var r=n(684),o=n(1524),a=n(687),i=n(1090),s=n(545),l=n(1105),c=n(3767),p=n(923),u=n(245),d=n(5437),m=n(2871),g=n(5593),h=n(5493),b=n(5481),f=n(2869),y=n(5630),S=n(5468),C=n(7499),v=n(5657),w=n(5663),O=n(5655),P=n(7507);function E(){return(E=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var A=e=>{var{onAppSelected:t}=e,n=Object(c.useHideNonCanvasAppCreation)(),{currentEnvironment:A}=Object(u.useContext)(l.EnvironmentContext),{t:j}=Object(p.useTranslation)("PowerappsPortal"),L=Object(P.getStyles)({hideNonCanvasApp:n}),T=Object(s.classNamesFunction)()(L),k=Object(d.useDispatch)(),R=Object(d.useSelector)(e=>e.shared.allowlistFeatures),D=h.default.getPaths(),M=Object(f.getResources)(),N=Object(O.getModernStaticSamplePowerPortalApp)(R),x=Object(O.getModernStaticSampleAppModule)(),I=Object(O.getModernStaticSampleCanvasApp)(),F=Object(d.useSelector)(e=>e.powerPortalApps.isPowerPortalFeaturesEnabled),B=!0;m.featureGates.showPowerPortalTile?m.featureGates.enablePortalForMooncakeRegion&&A.location===l.EnvironmentLocations.mooncake&&(F||(B=!1)):B=!1;var U=e=>{var n;switch(e){case v.StaticSampleAppId.NewPowerPortalApp:n=N;break;case v.StaticSampleAppId.NewAppModule:n=x;break;default:n=I}Object(g.trackUserActionClickButton)("SelectAppTypeSelectButton",{appUniqueName:e}),t(n)},G=e=>{var t=Object(w.getSampleAppTag)(e);return u.createElement("div",{className:T.appTagContainer},u.createElement(a.Icon,E({className:T.appTagIcon},t.sampleAppIconProps)),u.createElement("div",{className:T.appTagText},t.appTypeDisplayName))},z=e=>{var t;switch(e){case v.StaticSampleAppId.NewAppModule:t=b.default.getStartedAppModules;break;case v.StaticSampleAppId.NewPowerPortalApp:t=b.default.getPowerPortalAppsLearnMoreLink;break;default:t=b.default.getStartedCanvasApps}Object(g.trackUserActionClickLink)("SelectAppTypeLearnMoreLink",{appUniqueName:e}),k(Object(y.logAction)(S.sharedActions.openNewTab({uri:t}),C.CreateAppDetailsSectionEvents.LearnMore.eventName))},H=e=>u.createElement(i.Link,{as:"a",tabIndex:0,onKeyDown:t=>((e,t)=>{e.keyCode!==s.KeyCodes.enter&&e.keyCode!==s.KeyCodes.space||z(t)})(t,e),onClick:()=>z(e),role:"link"},j(M.Common.learnMore));return u.createElement(u.Fragment,null,u.createElement("div",{className:T.cardContainer},u.createElement(o.DocumentCard,{className:T.card},u.createElement("picture",null,u.createElement("source",{srcSet:D.fromBlankCanvas1024,media:"(min-width: ".concat(P.appTypeSelectionBreakpoints.ExtraLarge,"px)")}),u.createElement("source",{srcSet:D.fromBlankCanvas640,media:"(min-width: ".concat(P.appTypeSelectionBreakpoints.Large,"px)")}),u.createElement("source",{srcSet:D.fromBlankCanvas480,media:"(min-width: ".concat(P.appTypeSelectionBreakpoints.Medium,"px)")}),u.createElement("img",{src:D.fromBlankCanvas320,role:"presentation"})),u.createElement("div",{className:T.cardDetails},u.createElement("div",{className:T.cardTitle},j(M.CreateAppModal.SelectAppTypeSection.Cards.Titles.blankCanvasApp)),u.createElement("div",{className:T.cardDescription},j(M.CreateAppModal.SelectAppTypeSection.Cards.Descriptions.blankCanvasApp)," ",H(v.StaticSampleAppId.NewApp)),G(I)),u.createElement(r.DefaultButton,{className:T.cardButton,onClick:()=>U(v.StaticSampleAppId.NewApp),ariaLabel:"".concat(j(M.Common.create)," ").concat(Object(w.getSampleAppTag)(I).appTypeDisplayName)},j(M.Common.create))),!n&&u.createElement(o.DocumentCard,{className:T.card},u.createElement("picture",null,u.createElement("source",{srcSet:D.fromBlankModel1024,media:"(min-width: ".concat(P.appTypeSelectionBreakpoints.ExtraLarge,"px)")}),u.createElement("source",{srcSet:D.fromBlankModel640,media:"(min-width: ".concat(P.appTypeSelectionBreakpoints.Large,"px)")}),u.createElement("source",{srcSet:D.fromBlankModel480,media:"(min-width: ".concat(P.appTypeSelectionBreakpoints.Medium,"px)")}),u.createElement("img",{src:D.fromBlankModel320,role:"presentation"})),u.createElement("div",{className:T.cardDetails},u.createElement("div",{className:T.cardTitle},j(M.CreateAppModal.SelectAppTypeSection.Cards.Titles.blankAppDataverse)),u.createElement("div",{className:T.cardDescription},j(M.CreateAppModal.SelectAppTypeSection.Cards.Descriptions.blankAppDataverse)," ",H(v.StaticSampleAppId.NewAppModule)),G(x)),u.createElement(r.DefaultButton,{className:T.cardButton,onClick:()=>U(v.StaticSampleAppId.NewAppModule),ariaLabel:"".concat(j(M.Common.create)," ").concat(Object(w.getSampleAppTag)(x).appTypeDisplayName)},j(M.Common.create))),B&&u.createElement(o.DocumentCard,{className:T.card},u.createElement("picture",null,u.createElement("source",{srcSet:D.fromBlankPortal1024,media:"(min-width: ".concat(P.appTypeSelectionBreakpoints.ExtraLarge,"px)")}),u.createElement("source",{srcSet:D.fromBlankPortal640,media:"(min-width: ".concat(P.appTypeSelectionBreakpoints.Large,"px)")}),u.createElement("source",{srcSet:D.fromBlankPortal480,media:"(min-width: ".concat(P.appTypeSelectionBreakpoints.Medium,"px)")}),u.createElement("img",{src:D.fromBlankPortal320,role:"presentation"})),u.createElement("div",{className:T.cardDetails},u.createElement("div",{className:T.cardTitle},j(M.CreateAppModal.SelectAppTypeSection.Cards.Titles.blankWebsite)),u.createElement("div",{className:T.cardDescription},j(M.CreateAppModal.SelectAppTypeSection.Cards.Descriptions.blankWebsite)," ",H(v.StaticSampleAppId.NewPowerPortalApp)),G(N)),u.createElement(r.DefaultButton,{className:T.cardButton,onClick:()=>U(v.StaticSampleAppId.NewPowerPortalApp),ariaLabel:"".concat(j(M.Common.create)," ").concat(Object(w.getSampleAppTag)(N).appTypeDisplayName)},j(M.Common.create)))))}},7903:function(e,t,n){"use strict";n.r(t),n.d(t,"ModernCreateAppDetailsSectionBase",(function(){return E})),n.d(t,"ModernCreateAppDetailsSection",(function(){return A}));var r=n(245),o=n(790),a=n(2903),i=n(684),s=n(1277),l=n(719),c=n(1090),p=n(545),u=n(826),d=n(1755),m=n(7501),g=n(923),h=n(5619),b=n(2879),f=n(5658),y=n(7502),S=n(2880),C=n(7503),v=n(5663),w=n(688),O=n(2869);function P(){return(P=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var E=e=>{var t,n,{sampleApp:p,formFactor:E,onPreviewSampleApp:A,onLearnMoreClick:j,theme:L,styles:T,className:k,children:R}=e,D=Object(O.getResources)(),{t:M}=Object(g.useTranslation)("PowerappsPortal"),N=r.useRef(null),x=Object(y.getClassNames)(T,{theme:L}),I=Object(v.getSampleAppTag)(p),F=Object(v.getDescription)(p),B=Object(v.getAllowedFormFactors)(p),[U,G]=r.useState(!0),z=()=>{G(e=>!e)},H=()=>r.createElement(o.Callout,{target:N.current,hidden:U,role:"alertdialog",setInitialFocus:!0},r.createElement(u.FocusTrapZone,{isClickableOutsideFocusTrap:!0},r.createElement(i.IconButton,{className:x.appTagCalloutCloseButton,iconProps:{iconName:b.fabricIcons.Cancel},onClick:()=>z(),styles:{icon:{fontSize:"12px"}},"aria-label":M("Common.cancel"),onKeyDown:_}),r.createElement("div",{className:x.appTagCallout},r.createElement("div",{className:x.appTagCalloutHeader,role:"heading","aria-level":2}," ".concat(I.appTypeDisplayName," ")),r.createElement("div",{className:x.appTagCalloutAnnotation},Object(f.getSampleAppAnnotation)(p.sampleAppType)),r.createElement(c.Link,{onClick:()=>j(),onKeyDown:_,role:"link"},M("Common.learnMore"))))),_=e=>{e.keyCode===a.KeyCodes.escape&&(e.preventDefault(),z())};return r.createElement("div",{className:Object(l.mergeStyles)(k,x.section)},r.createElement(d.Shimmer,{isDataLoaded:!0,shimmerElements:[{type:d.ShimmerElementType.line,height:280}]},r.createElement("div",{className:x.imageSection},(n=Object(y.previewLinkStyles)(!!A),r.createElement("div",{className:Object(l.mergeStyles)(n.previewLinkContainer)},A&&r.createElement(c.Link,{role:"link",onClick:()=>A()},D.CreateAppModal.DetailsSection.PreviewLink.preview,r.createElement(w.Icon,{className:Object(l.mergeStyles)(n.previewIcon),iconName:b.fabricIcons.ArrowTallUpRight})))),r.createElement(s.Image,P({},Object(v.getPreviewImageProps)(p,E),{alt:I.appTypeDisplayName})))),r.createElement("div",{className:x.appInfoSection}," ",(t=Object(C.staticSampleAppLearnMoreLink)(Object(v.getUniqueName)(p),""),r.createElement("div",{className:x.dataSection},r.createElement("div",{className:x.appDescriptionText},r.createElement(d.Shimmer,{isDataLoaded:!0,shimmerElements:[{type:d.ShimmerElementType.line,width:100}]},Object(S.formatResourceStringAsLinks)(F,[t]))),r.createElement(d.Shimmer,{isDataLoaded:!0,shimmerElements:[{type:d.ShimmerElementType.line,width:100}],styles:{dataWrapper:x.appTagsSection}},r.createElement("div",{ref:N},r.createElement(i.DefaultButton,{onClick:()=>z(),iconProps:I.sampleAppIconProps,text:I.appTypeDisplayName,styles:Object(l.concatStyleSets)(y.appTypeButtonStyle,Object(m.getSharedButtonStyles)())}),!U&&H()),B&&1===B.length&&r.createElement("div",{className:x.appFormatTag},r.createElement("div",{className:x.appFormatTagText},Object(h.getFormFactorDisplayName)(B[0]))))))," "),R)},A=Object(p.styled)(E,y.getStyles)},7904:function(e,t,n){"use strict";n.r(t),n.d(t,"withLazyLoadedSampleApps",(function(){return c}));var r=n(245),o=n(3916),a=n(7905),i=["queries","sampleApps","isLoading"];function s(){return(s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function l(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function c(e){return t=>{var{queries:n=[],sampleApps:c=[],isLoading:p}=t,u=l(t,i),d=Object(o.useQueries)(n),m=d.reduce((e,t)=>t.isSuccess?e.concat(t.data):e,[...c]),g=d.map((e,t)=>({state:Object(a.statusToComponentLoadState)(e.status),name:n[t].queryName,info:e.isError&&e.error})),h=d.some(e=>e.isLoading);return r.createElement(e,s({},u,{sampleApps:m,isLoading:p||h,loadProgress:g}))}}},7905:function(e,t,n){"use strict";n.r(t),n.d(t,"statusToComponentLoadState",(function(){return o}));var r=n(5898),o=e=>{switch(e){case"error":return r.ComponentLoadState.Fail;case"success":return r.ComponentLoadState.Complete;case"idle":case"loading":default:return r.ComponentLoadState.Loading}}},7906:function(e,t,n){"use strict";n.r(t),n.d(t,"withFilteredSampleAppsList",(function(){return m}));var r=n(2812),o=n(245),a=n(5659),i=n(5593),s=n(7495),l=n(5663),c=n(5656),p=["sampleApps","sampleAppTypeFilter","searchFilter","denyListedDisplayNames"];function u(){return(u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function d(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function m(e){return t=>{var{sampleApps:n,sampleAppTypeFilter:m=a.SampleAppType.All,searchFilter:g="",denyListedDisplayNames:h=[]}=t,b=d(t,p),[f,y]=o.useState([]),S=o.useMemo(()=>Object(r.debounce)(e=>{Object(i.trackInfoTrace)(s.ModernSampleAppsEvents.FilteredSampleApps.eventName,e)},500),[]),C=o.useCallback(e=>e&&Object(a.shouldSampleAppShow)(g,Object(l.getSearchableFields)(e))&&!h.includes(Object(l.getDisplayName)(e)),[g]);return o.useEffect(()=>{var e=n.filter(e=>C(e));switch(m){case a.SampleAppType.Office:y(e.filter(e=>e.sampleAppType===c.SampleAppTypes.Canvas));break;case a.SampleAppType.Dataverse:y(e.filter(e=>e.sampleAppType===c.SampleAppTypes.TPSModel||e.sampleAppType===c.SampleAppTypes.Model));break;default:y(e)}},[n,m,C]),o.useEffect(()=>{g&&S({totalAppCount:n.length,filteredAppCount:f.length,modernExperience:!0})},[g,n,f]),o.createElement(e,u({},b,{sampleApps:f}))}}},7907:function(e,t,n){"use strict";n.r(t),n.d(t,"withSortedSampleAppsList",(function(){return s}));var r=n(245),o=["sampleApps","compareFn"];function a(){return(a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function i(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function s(e){return t=>{var{sampleApps:n,compareFn:s}=t,l=i(t,o),[c,p]=r.useState([]);return r.useEffect(()=>{if(s){var e=n.sort(s);p(e)}},[n,s]),r.createElement(e,a({},l,{sampleApps:s?c:n}))}}},7908:function(e,t,n){"use strict";n.r(t),n.d(t,"ModernDataSourceAppCardBase",(function(){return m})),n.d(t,"ModernDataSourceAppCard",(function(){return g}));var r=n(1755),o=n(545),a=n(245),i=n(2882),s=n(7875),l=n(7880),c=n(5663),p=n(7876),u=n(7909),d=n(7898),m=e=>{var t=Object(p.getClassNames)(e.styles,{theme:e.theme}),{sampleApp:n,isSimpleView:o,theme:m}=e,[g,h]=a.useState(!1),b=e=>{e&&e.keyCode===s.KeyCodes.ENTER&&n&&h(!0)};return a.createElement(a.Fragment,null,o?a.createElement(d.ModernSampleAppCardSimple,{app:n,theme:m,onCardClicked:()=>h(!0),onCardKeyDown:b}):a.createElement("div",{className:t.root},a.createElement("div",{tabIndex:0,role:"button","data-is-focusable":!0,onClick:()=>{h(!0)},onKeyDown:b},a.createElement("div",{className:t.card,"data-is-loaded":!!n},a.createElement(u.ModernDataSourceAppCardIcon,{sampleApp:n,classNames:t}),function(e,t){var n={color:(e&&Object(c.getBackgroundColor)(e))===i.fabricColors.white&&i.fabricColors.neutralPlum};return a.createElement("div",{className:t.contentRoot},a.createElement("div",{className:t.contentText,"data-automation-id":null==e?void 0:e.dataAutomationId},a.createElement(r.Shimmer,{width:50,shimmerElements:[{type:r.ShimmerElementType.line,height:14}],isDataLoaded:!!e,styles:{dataWrapper:[t.contentText]}},a.createElement("span",{style:n},!!e&&Object(c.getDisplayName)(e)))))}(n,t)))),g&&a.createElement(l.ModernOpenConnectionsModal,{sampleApp:n,onDismiss:()=>h(!1)}))};var g=Object(o.styled)(m,p.getStyles)},7909:function(e,t,n){"use strict";n.r(t),n.d(t,"ModernDataSourceAppCardIcon",(function(){return m}));var r=n(687),o=n(1277),a=n(1755),i=n(3076),s=n(2698),l=n(6711),c=n(923),p=n(245),u=n(2882),d=n(5663),m=e=>{var{sampleApp:t,classNames:n}=e,{environmentClient:m}=p.useContext(i.ApolloClientContext),{t:g}=Object(c.useTranslation)("PowerappsPortal"),{loading:h,apis:b}=Object(l.useApisQuery)(m,s.PortalScope,g("Common.Request.Failed"),!m);if(!m)return null;var f=t&&"/providers/microsoft.powerapps/apis/shared_commondataservice"==t.apiId.toLowerCase()?"/providers/microsoft.powerapps/apis/shared_commondataserviceforapps":t.apiId,y=b&&f&&b.find(e=>e.id.toLowerCase()==f.toLowerCase());return p.createElement(a.Shimmer,{shimmerElements:[{type:a.ShimmerElementType.line,height:92}],isDataLoaded:!!t&&!h},!!t&&!!y&&p.createElement(o.Image,{src:y&&y.iconUri,width:88,height:88,alt:Object(d.getDisplayName)(t),className:n.imageContainer,role:"presentation"}),t&&!y&&Object(d.getIsImage)(t)?p.createElement(o.Image,{src:t&&Object(d.getPreviewImageUrl)(t),width:88,height:88,alt:Object(d.getDisplayName)(t),className:n.imageContainer,role:"presentation"}):p.createElement(r.Icon,{iconName:t&&Object(d.getPreviewImageUrl)(t),ariaLabel:Object(d.getDisplayName)(t),styles:{root:[n.iconContainer,{backgroundColor:t&&Object(d.getBackgroundColor)(t),color:t&&Object(d.getBackgroundColor)(t)==u.fabricColors.white?u.fabricColors.neutralPlum:u.fabricColors.white}]},className:n.icon}))}},7910:function(e,t,n){"use strict";n.r(t),n.d(t,"PartialSampleAppsSection",(function(){return u}));var r=n(3767),o=n(245),a=n(7862),i=n(5623),s=n(7867),l=n(7495),c=n(5655),p=n(7878),u=e=>{var{appListSectionType:t,hideDefaultHeader:n,hideNavigationLink:u,t:d}=e,m=Object(r.useHideNonCanvasAppCreation)(),g=t===c.AppsListSectionName.StartFromBlank,h={lowerBound:3,upperBound:g?3:4},b=g?"880px":"1144px";return o.createElement("div",{className:p.partialSampleAppSectionStyleClasses["partial-sample-apps-section"],style:{maxWidth:b},role:"region","aria-label":d("ExcelLanding.Samples.startFromExcelTitle")},o.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},!n&&o.createElement("div",{className:"partial-sample-apps-section-header ms-Grid-row"},o.createElement("div",{className:"partial-sample-apps-section-header-title ms-lg-8",role:"heading","aria-level":3},o.createElement("div",null,d("Home.Samples.newTitle"))))),o.createElement(s.SampleAppsListContainer,{numberOfSampleAppsToShow:h,appListSectionType:t,hideNonCanvasApps:m}),o.createElement("div",{className:"partial-sample-apps-section-link"},!u&&o.createElement(a.NavigationLink,{linkLabel:d("PartialSampleAppsList.seeAllSampleApps"),navigationEvent:l.PartialSampleAppsSectionEvents.Navigate,navigationRoute:i.templateAppsRoute.canvas})))}},7911:function(e,t,n){"use strict";n.r(t),n.d(t,"AppsSectionHostPage",(function(){return r})),n.d(t,"PartialSampleAppsSectionSimple",(function(){return y}));var r,o=n(245),a=n(7862),i=n(5623),s=n(7867),l=n(7495),c=n(7878),p=n(5655),u=n(3767),d=n(5583),m=n(7493),g=n(5487),h=n(3076),b=n(7508),f=n(1105);!function(e){e.Home="Home",e.Create="Create"}(r||(r={}));var y=Object(d.withNavigate)(Object(f.withEnvironment)(Object(g.withRootProps)(Object(h.withApolloClient)(Object(m.withSampleAppCommands)(l.SampleAppsListContext)(e=>{var t,n,{hostPage:d,enableCanvasAppsInSolutionsByDefault:m,sampleAppCommands:g,t:h}=e,f=Object(u.useHideNonCanvasAppCreation)(),[y,S]=o.useState(!1),C=d===r.Create?Object(p.getOtherDataSourcesSampleApp)(!(null===(t=e.currentEnvironment)||void 0===t||null===(n=t.properties)||void 0===n||!n.linkedEnvironmentMetadata),m):null;return o.createElement("div",{className:"".concat(c.partialSampleAppSectionStyleClasses["partial-sample-apps-section"]),style:{maxWidth:"auto"},role:"region","aria-label":h("Home.Samples.titleSimple")},o.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},o.createElement("div",{className:"partial-sample-apps-section-header ms-Grid-row"},o.createElement("div",{className:"partial-sample-apps-section-header-title ms-lg-8 ".concat(d===r.Create?"create":""),role:"heading","aria-level":3},o.createElement("div",null,h("Home.Samples.titleSimple"))))),o.createElement(s.SampleAppsListContainer,{numberOfSampleAppsToShow:{lowerBound:5,upperBound:5},appListSectionType:p.AppsListSectionName.Simple,hideNonCanvasApps:f}),o.createElement("div",{className:"partial-sample-apps-section-link"},d===r.Home?o.createElement(a.NavigationLink,{linkLabel:h("PartialSampleAppsList.moreCreateOptions"),navigationEvent:l.PartialSampleAppsSectionEvents.Navigate,navigationRoute:i.templateAppsRoute.canvas}):o.createElement(a.NavigationLink,{navigationEvent:l.PartialSampleAppsSectionEvents.Navigate,linkLabel:h("PartialSampleAppsList.moreDataSources"),onClick:()=>S(!0)})),y&&o.createElement(b.OpenConnectionsModal,{sampleApp:C,sampleAppCommands:g(C),onDismiss:()=>S(!1)}))})))))},7912:function(e,t,n){"use strict";n.r(t),n.d(t,"_ContactCollectionDialog",(function(){return f})),n.d(t,"ContactCollectionDialog",(function(){return y}));var r=n(245),o=n.n(r),a=n(684),i=n(895),s=n(216),l=n(7913),c=n(5731),p=n(7914),u=n(7916),d=n(3144),m=n(2807),g=n(2869),h=n(2812);function b(){return(b=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var f=e=>{var{tid:t}=Object(r.useContext)(s.AuthenticatedUserInfoContext),[n,d]=o.a.useState(!0),[f,y]=o.a.useState(null),S=Object(r.useRef)(null),{loading:C,errorMessage:v,currentUser:w}=Object(p.useGetCurrentUser)(e.environmentClient,m.PortalScope,Object(g.getResources)().Common.Request.Failed);Object(r.useEffect)(()=>function(){clearTimeout(f)}),Object(r.useMemo)(()=>{S.current=Object(c.sendPerformanceTelemetry)({status:"Form Load Started"},u.featureName,u.ScenarioEventNames.Load)},[]);var O,P=e=>t=>{if(t.origin===u.webFormDomain&&Object(h.isString)(t.data)){var n=JSON.parse(t.data);""!=(null==n?void 0:n.Error)?A(null==n?void 0:n.FormEvent,n.Error,e):E(null==n?void 0:n.FormEvent,e)}},E=(e,t)=>{var r;4==e&&n?(null===(r=S.current)||void 0===r||r.complete({status:"Form Load Succeeded"}),S.current=void 0,d(!1)):e>4&&(Object(c.sendUsageTelemetry)(u.featureName,u.eventMap[e]),6==e&&t())},A=(e,t,n)=>{var r;(d(!0),e>4)?Object(c.sendUsageTelemetry)(u.featureName,u.eventMap[e],Error(t)):(null===(r=S.current)||void 0===r||r.completeWithError({error:t,status:"Form Load Failed",stage:u.eventMap[e]}),S.current=void 0);n()},j=()=>{var t;null===(t=S.current)||void 0===t||t.completeWithError({error:"Unknown Error",status:"Form Load Failed"}),S.current=void 0,Object(c.sendUsageTelemetry)(u.featureName,u.ScenarioEventNames.Dismiss),e.onDismiss()},L=()=>{var t;null===(t=S.current)||void 0===t||t.completeWithError({error:"Iframe load timed out",status:"Form Load Failed"}),S.current=void 0,e.onDismiss()},T=l.contactCollectionModalProps;return n&&(T=l.hiddenModelProps),Object(r.useEffect)(()=>{n&&null===f&&!C?y(setTimeout(L,4e3)):clearTimeout(f)},[n,C]),C?o.a.createElement(o.a.Fragment,null):(v&&(null===(O=S.current)||void 0===O||O.completeWithError({error:v,status:"Graph API Load Failed"}),S.current=void 0,e.onDismiss()),o.a.createElement(i.Modal,b({isOpen:!0,isBlocking:!0,isDarkOverlay:!1,onDismiss:j},T),o.a.createElement(a.IconButton,{onClick:j,iconProps:{iconName:"Cancel"},styles:l.IconButtonStyles,ariaLabel:e.closeButtonAriaLabel,title:e.closeButtonAriaLabel}),o.a.createElement("div",{className:l.contactCollectionDialogStyleClasses.iframeDiv},o.a.createElement("iframe",{"aria-label":e.iframeAriaLabel,onLoad:()=>{var n,r;null===(n=S.current)||void 0===n||n.progress({status:"IFrame Loaded"}),window.addEventListener("message",P(e.onDismiss),!0);var o,a,i=document.getElementById(u.iframeId),s={headerText:e.headerText,subHeaderText:e.subHeaderText,ctaText:e.submitButtonText,tenantID:t,offerID:"CO-RAPIDAPPS-ACCOUNT-POWERAPPS-FRE-OFFERID",userDetails:{givenName:null==w?void 0:w.givenName,surname:null==w?void 0:w.surname,jobTitle:null==w?void 0:w.jobTitle,companyName:null==w?void 0:w.companyName,mail:null!==(r=null==w?void 0:w.email)&&void 0!==r?r:null==w?void 0:w.userPrincipalName}};o=""+JSON.stringify(s),null==(a=i)||a.contentWindow.postMessage(o,"*")},src:u.webFormURL,id:u.iframeId,className:l.contactCollectionDialogStyleClasses.contactCollectionIframe}))))},y=Object(d.withApolloClient)(f)},7913:function(e,t,n){"use strict";n.r(t),n.d(t,"contactCollectionDialogStyleClasses",(function(){return i})),n.d(t,"IconButtonStyles",(function(){return s})),n.d(t,"contactCollectionModalProps",(function(){return l})),n.d(t,"hiddenModelProps",(function(){return c}));var r=n(719),o=n(1199),a=n(2882),i=Object(r.mergeStyleSets)({contactCollectionIframe:{display:"flex",width:"100%",maxwidth:650,height:"100%",padding:"5px"},iframeDiv:{height:"100%",display:"flex","justify-content":"center"}}),s={root:{height:"32px",zIndex:1,marginRight:"7px",marginTop:"7px",position:"absolute",right:"0",top:"0",width:"32px",color:o.PowerAppsPurplePalette.neutralDark},rootHovered:{color:o.PowerAppsPurplePalette.neutralDark}},l={styles:{main:{display:"flex",maxHeight:"620px",height:"90%",width:650}},overlay:{styles:{root:{backgroundColor:a.fabricColors.white,opacity:.85}}}},c={styles:{main:{display:"flex",position:"absolute",left:"-1000px",top:"-1000px",width:"0px",height:"0px",zIndex:-1}},overlay:{styles:{root:{backgroundColor:a.fabricColors.white,opacity:0}}}}},7914:function(e,t,n){"use strict";n.r(t),n.d(t,"useGetCurrentUser",(function(){return c}));var r=n(3192),o=n(245),a=n(217),i=n(7915),s=n(3186),l=n(3193);function c(e,t,n){var[c,p]=Object(o.useState)(),[u,d]=Object(o.useState)(),{loading:m,data:g}=Object(s.useQuery)(i.GetAadCurrentUserGql,{client:e,fetchPolicy:"no-cache",onCompleted:e=>{c&&(c.complete(),p(void 0))},onError:e=>{var t=Object(r.getResponseMessageFromApolloError)(e,n);d(t),c&&(c.failure({error:t,clientError:e.message}),p(void 0))}});return Object(o.useEffect)(()=>{m&&p(Object(a.trackLoadScenario)(t,l.TelemetryScenarioNames.currentUserGraphQl))},[m,t]),{loading:m,errorMessage:u,currentUser:null==g?void 0:g.getCurrentUser}}},7915:function(e,t,n){"use strict";n.r(t),n.d(t,"GetAadCurrentUserGql",(function(){return s}));var r,o=n(3128);var a,i,s=n.n(o)()(r||(a=["\n  query GetCurrentUser {\n    getCurrentUser {\n      displayName\n      email\n      oid\n      userType\n      givenName\n      surname\n      jobTitle\n      companyName\n      userPrincipalName\n    }\n  }\n"],i||(i=a.slice(0)),r=Object.freeze(Object.defineProperties(a,{raw:{value:Object.freeze(i)}}))))},7916:function(e,t,n){"use strict";n.r(t),n.d(t,"ScenarioEventNames",(function(){return r})),n.d(t,"eventMap",(function(){return i})),n.d(t,"webFormDomain",(function(){return s})),n.d(t,"iframeId",(function(){return l})),n.d(t,"graphURL",(function(){return c})),n.d(t,"webFormURL",(function(){return p})),n.d(t,"featureName",(function(){return u}));var r,o=n(922),a=n(2814);!function(e){e.Load="Load",e.Dismiss="Dismiss",e.Submit="Submit",e.CountryDropdownInitialization="CountryDropdownInitialization"}(r||(r={}));var i=["Form-Initialization","Form-Loading","Form-PostMessagesReceived","Form-GraphAPICall","FormLoadComplete",r.CountryDropdownInitialization,r.Submit],s=a.settings.contactCollectionFormDomain,l="contactCollectionForm",c="https://graph.microsoft.com",p="".concat(s,"/").concat(Object(o.getCurrentLocale)(),"/lead-collection/"),u="ContactCollectionWebForm"},7917:function(e,t,n){"use strict";n.r(t),n.d(t,"FirstRunExperience",(function(){return v}));var r=n(245),o=n.n(r),a=n(1372),i=n(1090),s=n(922),l=n(3210),c=n(7918),p=n(252),u=n(7921),d=n(7922),m=n(5731),g=n(7923),h=n(1277);function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){y(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function S(e,t,n,r,o,a,i){try{var s=e[a](i),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}function C(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){S(a,r,o,i,s,"next",e)}function s(e){S(a,r,o,i,s,"throw",e)}i(void 0)}))}}var v=Object(s.translateService)("PowerappsPortal")(e=>{var{environmentClient:t,onDismiss:n,t:b}=e,[y,S]=Object(r.useState)([]),[v,w]=Object(r.useState)([]),[O,P]=Object(r.useState)([]),[E,A]=Object(r.useState)([]),j=Object(s.getCurrentLocale)(),L=j.split("-")[1]||"US",T=Object(r.useRef)(),k=Object(r.useRef)(),R={logError:Object(r.useCallback)((e,t)=>{Object(m.sendUsageTelemetry)(d.featureName,e.event,e.data,t)},[m.sendUsageTelemetry])};Object(r.useEffect)(()=>{I(0,!0)},[y]),Object(r.useMemo)(C((function*(){var e;T.current=Object(m.sendPerformanceTelemetry)({scenarioType:d.FirstLoadScenarioType,carouselIndex:0},d.featureName,d.PerformanceScenarioName);var n="test"===Object(p.getSettings)().region?d.CreativeContentAdUnit.test:d.CreativeContentAdUnit.production,r=Date.now(),s=null!==(e=yield Object(c.getCreativeContent)(t,n,j,L,d.CreativeContentBatchCount,R))&&void 0!==e?e:[];k.current=Date.now()-r,0===s.length&&T.current.completeWithError({irisError:"Zero creatives returned"}),A(s);var l=[],b=[],f=[];s.map((e,t)=>{l.push(o.a.createElement("div",{key:e.ad.CorouselItem.Sequence,className:u.firstRunExperienceStyleClasses["first-run-experience-content-container"]},o.a.createElement(g.Lottie,{url:e.ad.CorouselItem.ImageJson,className:u.firstRunExperienceStyleClasses["first-run-experience-image"],role:"presentation",fallback:o.a.createElement(h.Image,{src:e.ad.CorouselItem.ImageUrl,imageFit:h.ImageFit.cover,className:u.firstRunExperienceStyleClasses["first-run-experience-image"],role:"presentation"})}))),b.push(o.a.createElement("div",{key:e.ad.CorouselItem.Sequence,className:u.firstRunExperienceStyleClasses["first-run-experience-content-container"]},o.a.createElement(a.Label,{className:u.firstRunExperienceStyleClasses["first-run-experience-title"]},e.ad.CorouselItem.Title),o.a.createElement(a.Label,{className:u.firstRunExperienceStyleClasses["first-run-experience-description"]},e.ad.CorouselItem.Description," ",e.ad.CorouselItem.Link1&&o.a.createElement(i.Link,{href:e.ad.CorouselItem.Link1.Url,onClick:()=>D(t),target:"_blank"},e.ad.CorouselItem.Link1.Text)))),f.push({content:e.ad.CorouselItem.Title,id:t+""})}),S(l),w(b),P(f)})),[]);var D=function(){var e=C((function*(e){var n=null==E?void 0:E[e];Object(m.sendUsageTelemetry)(d.featureName,d.IrisActions.LearnMore,{carouselIndex:e}),Object(c.sendActionBeacon)(t,n.actionUrl,d.IrisActions.LearnMore,R)}));return function(t){return e.apply(this,arguments)}}(),M=function(){var e=C((function*(e,r,o){var a=null==E?void 0:E[r],i=e?d.IrisActions.Done:o?d.IrisActions.Skip:d.IrisActions.Dismiss;Object(m.sendUsageTelemetry)(d.featureName,i,{carouselIndex:r}),Object(c.sendActionBeacon)(t,a.actionUrl,i,R),n(e)}));return function(t,n,r){return e.apply(this,arguments)}}(),N=function(){var e=C((function*(e){var n=null==E?void 0:E[e];Object(m.sendUsageTelemetry)(d.featureName,d.IrisActions.Next,{carouselIndex:e}),T.current=Object(m.sendPerformanceTelemetry)({carouselIndex:e+1},d.featureName,d.PerformanceScenarioName),Object(c.sendActionBeacon)(t,n.actionUrl,d.IrisActions.Next,R)}));return function(t){return e.apply(this,arguments)}}(),x=function(){var e=C((function*(e){var n=null==E?void 0:E[e];Object(m.sendUsageTelemetry)(d.featureName,d.IrisActions.Previous,{carouselIndex:e}),T.current=Object(m.sendPerformanceTelemetry)({carouselIndex:e-1},d.featureName,d.PerformanceScenarioName),Object(c.sendActionBeacon)(t,n.actionUrl,d.IrisActions.Previous,R)}));return function(t){return e.apply(this,arguments)}}(),I=function(){var e=C((function*(e,n){var r=null==E?void 0:E[e];if(r){var o,a={};n&&(a={scenarioType:d.FirstLoadScenarioType,irisLoadTime:k.current}),null===(o=T.current)||void 0===o||o.complete(f(f({},a),{},{carouselIndex:e})),T.current=void 0,Object(c.sendImpressionBeacon)(t,r.impressionUrl,R)}}));return function(t,n){return e.apply(this,arguments)}}();return y.length>0&&o.a.createElement(l.default,{onClose:M,onSkip:()=>M(!1,0,!0),onNext:N,onPrevious:x,onItemSelected:I,skipButtonLabel:b("FirstRunCarousel.navSkipButton"),doneButtonLabel:b("FirstRunCarousel.navDoneButton"),navNextButtonLabel:b("FirstRunCarousel.navNextButton"),navPreviousButtonLabel:b("FirstRunCarousel.navPreviousButton"),items:y,subItems:v,modalProps:{styles:u.firstRunExperienceModalStyles,overlay:{styles:u.modalOverlayStyles}},closeButtonAriaLabel:b("FirstRunCarousel.closeButtonAriaLabel"),indicatorTooltips:O})})},7918:function(e,t,n){"use strict";n.r(t),n.d(t,"getCreativeContent",(function(){return s})),n.d(t,"sendImpressionBeacon",(function(){return c})),n.d(t,"sendActionBeacon",(function(){return u}));var r=n(7919),o=n(7920);function a(e,t,n,r,o,a,i){try{var s=e[a](i),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}function i(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function s(e){a(i,r,o,s,l,"next",e)}function l(e){a(i,r,o,s,l,"throw",e)}s(void 0)}))}}function s(e,t,n,r,o,a){return l.apply(this,arguments)}function l(){return(l=i((function*(e,t,n,a,i,s){try{var l,{data:c,errors:p}=yield e.query({query:o.GetCreativeContentGql,variables:{placement:t,locale:n,country:a,batchCount:i}});return p?void(null==s||null===(l=s.logError)||void 0===l||l.call(s,{event:Object(r.errorEventName)(r.ScenarioNames.GetCreativeContent,r.ErrorNames.GraphQLError)},Error("GraphQL Error"))):c.creativeContent.map(e=>({ad:JSON.parse(e.ad),impressionUrl:e.impression.impressionUrl,actionUrl:e.action.actionUrl}))}catch(d){var u;null==s||null===(u=s.logError)||void 0===u||u.call(s,{event:Object(r.errorEventName)(r.ScenarioNames.GetCreativeContent,r.ErrorNames.UnknownError)},d)}}))).apply(this,arguments)}function c(e,t,n){return p.apply(this,arguments)}function p(){return(p=i((function*(e,t,n){try{var a,{errors:i}=yield e.mutate({mutation:o.SendImpressionBeaconGql,variables:{url:t}});if(i)null==n||null===(a=n.logError)||void 0===a||a.call(n,{event:Object(r.errorEventName)(r.ScenarioNames.SendImpressionBeacon,r.ErrorNames.GraphQLError)},Error("GraphQL Error"))}catch(l){var s;null==n||null===(s=n.logError)||void 0===s||s.call(n,{event:Object(r.errorEventName)(r.ScenarioNames.SendImpressionBeacon,r.ErrorNames.UnknownError)},l)}}))).apply(this,arguments)}function u(e,t,n,r){return d.apply(this,arguments)}function d(){return(d=i((function*(e,t,n,a){try{var i,{errors:s}=yield e.mutate({mutation:o.SendActionBeaconGql,variables:{url:t,action:n}});if(s)null==a||null===(i=a.logError)||void 0===i||i.call(a,{event:Object(r.errorEventName)(r.ScenarioNames.SendActionBeacon,r.ErrorNames.GraphQLError)},Error("GraphQL Error"))}catch(c){var l;null==a||null===(l=a.logError)||void 0===l||l.call(a,{event:Object(r.errorEventName)(r.ScenarioNames.SendActionBeacon,r.ErrorNames.UnknownError)},c)}}))).apply(this,arguments)}},7919:function(e,t,n){"use strict";n.r(t),n.d(t,"ScenarioNames",(function(){return r})),n.d(t,"ErrorNames",(function(){return o})),n.d(t,"errorEventName",(function(){return a}));var r,o;!function(e){e.GetCreativeContent="GetCreativeContent",e.SendImpressionBeacon="SendImpressionBeacon",e.SendActionBeacon="SendActionBeacon"}(r||(r={})),function(e){e.GraphQLError="GraphQLError",e.UnknownError="UnknownError"}(o||(o={}));var a=(e,t)=>"".concat("Iris","/").concat(e,"/").concat(t)},7920:function(e,t,n){"use strict";n.r(t),n.d(t,"GetCreativeContentGql",(function(){return c})),n.d(t,"SendImpressionBeaconGql",(function(){return p})),n.d(t,"SendActionBeaconGql",(function(){return u}));var r,o,a,i=n(3128),s=n.n(i);function l(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var c=s()(r||(r=l(["\n  query GetCreativeContent($placement: String!, $locale: String, $country: String, $batchCount: Float) {\n    creativeContent(placement: $placement, locale: $locale, country: $country, batchCount: $batchCount) {\n      version\n      ad\n      action {\n        actionUrl\n      }\n      impression {\n        impressionId\n        impressionUrl\n      }\n    }\n  }\n"]))),p=s()(o||(o=l(["\n  mutation SendImpressionBeacon($url: String!) {\n    impressionBeacon(url: $url)\n  }\n"]))),u=s()(a||(a=l(["\n  mutation SendActionBeacon($url: String!, $action: String!) {\n    actionBeacon(url: $url, action: $action)\n  }\n"])))},7921:function(e,t,n){"use strict";n.r(t),n.d(t,"firstRunExperienceStyleClasses",(function(){return a})),n.d(t,"firstRunExperienceModalStyles",(function(){return i})),n.d(t,"modalOverlayStyles",(function(){return s}));var r=n(719),o=n(2882),a=Object(r.mergeStyleSets)({"first-run-experience-content-container":{display:"flex",alignContent:"center",flexDirection:"column",textAlign:"center",marginBottom:18,color:o.fabricColors.bokaraGrey},"first-run-experience-image":{height:260},"first-run-experience-title":{fontSize:r.FontSizes.size16,fontWeight:r.FontWeights.semibold,paddingTop:0,paddingBottom:12,paddingLeft:24,paddingRight:24},"first-run-experience-description":{fontSize:r.FontSizes.size14,fontWeight:r.FontWeights.regular,paddingBottom:32,paddingLeft:24,paddingRight:24,paddingTop:0,height:60}}),i={main:{display:"flex",width:600}},s={root:{backgroundColor:o.fabricColors.white,opacity:.85}}},7922:function(e,t,n){"use strict";n.r(t),n.d(t,"CreativeContentAdUnit",(function(){return o})),n.d(t,"CreativeContentBatchCount",(function(){return a})),n.d(t,"IrisActions",(function(){return r})),n.d(t,"PerformanceScenarioName",(function(){return i})),n.d(t,"featureName",(function(){return s})),n.d(t,"FirstLoadScenarioType",(function(){return l}));var r,o={production:"88000425",test:"88000427"},a=3;!function(e){e.Click="click",e.Like="like",e.Dismiss="dismiss",e.Skip="skip",e.Next="next",e.Previous="previous",e.Done="done",e.LearnMore="learnMore"}(r||(r={}));var i="CarouselItem/Load",s="FreCarousel",l="FirstLoad"},7923:function(e,t,n){"use strict";n.r(t),n.d(t,"Lottie",(function(){return p}));var r=n(3307),o=n.n(r),a=n(245),i=n.n(a),s=["url","fallback"];function l(){return(l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function c(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var p=e=>{var[t,n]=Object(a.useState)(!0),{url:r,fallback:p}=e,u=c(e,s),d=Object(a.useCallback)(e=>{null!==e&&(r?o.a.loadAnimation({container:e,loop:!0,autoplay:!0,path:r}).addEventListener("data_failed",()=>{n(!1)}):n(!1))},[]);return t?i.a.createElement("div",l({ref:d},u)):null!=p?p:null}},7924:function(e,t,n){"use strict";n.r(t),n.d(t,"HomeBanner",(function(){return v}));var r=n(245),o=n.n(r),a=n(2871),i=n(1749),s=n(1795),l=n(7918),c=n(922),p=n(252),u=n(7925),d=n(7928),m=n(7929),g=n(684),h=n(5731),b=n(7930),f=n(1090);function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function S(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function C(e,t,n,r,o,a,i){try{var s=e[a](i),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}var v=e=>{var{environmentClient:t}=e,n=Object(c.getCurrentLocale)(),v=n.split("-")[1]||"US",[w,O]=Object(r.useState)(!1),[P,E]=Object(r.useState)(),A={logError:Object(r.useCallback)((e,t)=>{Object(h.sendUsageTelemetry)(m.featureName,e.event,e.data,t)},[h.sendUsageTelemetry])},j=Object(r.useCallback)(e=>{var n=Object(b.getAnnouncementType)(e);Object(h.sendUsageTelemetry)(m.featureName,m.IrisActions.Dismiss,n),Object(l.sendActionBeacon)(t,null==e?void 0:e.actionUrl,m.IrisActions.Dismiss,A),O(!1)},[]),L=Object(r.useCallback)((e,n)=>{var r=Object(b.getAnnouncementType)(n);Object(h.sendUsageTelemetry)(m.featureName,m.IrisActions.Click,r),Object(l.sendActionBeacon)(t,null==n?void 0:n.actionUrl,m.IrisActions.Click,A),window.open(e,"_blank"),O(!1)},[]),T=Object(r.useCallback)(e=>{var n=Object(b.getAnnouncementType)(e);Object(h.sendUsageTelemetry)(m.featureName,m.IrisActions.LearnMore,n),Object(l.sendActionBeacon)(t,e.actionUrl,m.IrisActions.LearnMore,A)},[]);return Object(r.useEffect)(()=>{var e;(a.featureGates.isNotificationMessageBarEnabled||a.featureGates.forceNotificationMessageBarEnabled)&&(e=function*(){var e,r=Object(h.sendPerformanceTelemetry)({scenarioType:m.FirstLoadScenarioType},m.featureName,m.PerformanceScenarioName),i=Date.now(),s=a.featureGates.forceNotificationMessageBarEnabled?m.CreativeContentAdUnit.poc:"test"===Object(p.getSettings)().region?m.CreativeContentAdUnit.test:m.CreativeContentAdUnit.production,c=null!==(e=yield Object(l.getCreativeContent)(t,s,n,v,m.CreativeContentBatchCount))&&void 0!==e?e:[],d=Date.now()-i;if(0===c.length&&r.completeWithWarning({scenarioType:m.FirstLoadScenarioType,irisError:"Zero creatives returned",adUnit:s,irisLoadTime:d}),c&&c[0]&&c[0].ad){var C=c[0].ad;E(o.a.createElement(u.NotificationMessageBar,{"data-automation-key":"homePageNotificationMessageBar",title:C.Body.Title,description:C.Body.Description,learnMore:C.Body.LearnMoreLink&&o.a.createElement(f.Link,{href:C.Body.LearnMoreLink.Url,onClick:()=>T(c[0]),target:"_blank",underline:!0},C.Body.LearnMoreLink.Text),actions:o.a.createElement(g.PrimaryButton,{text:C.Actions.ActionButton.Text,onClick:()=>L(C.Actions.ActionButton.Url,c[0])}),dismissCallback:()=>j(c[0]),imageUrl:C.Body.ImageIconURL,backgroundImageUrl:C.Body.BackgroundImageURL})),O(!0);var w=Object(b.getAnnouncementType)(c[0]);r.complete(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){S(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({scenarioType:m.FirstLoadScenarioType,irisLoadTime:d},w)),Object(l.sendImpressionBeacon)(t,c[0].impressionUrl,A)}},function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){C(a,r,o,i,s,"next",e)}function s(e){C(a,r,o,i,s,"throw",e)}i(void 0)}))})()},[]),w&&P?o.a.createElement(o.a.Fragment,null,o.a.createElement(s.Stack,null,o.a.createElement(s.Stack.Item,null,P)),o.a.createElement(i.Separator,{styles:d.separatorStyles})):o.a.createElement(o.a.Fragment,null)}},7925:function(e,t,n){"use strict";n.r(t),n.d(t,"NotificationMessageBar",(function(){return u}));var r=n(245),o=n.n(r),a=n(1795),i=n(1277),s=n(1837),l=n(7926),c=n(684),p=n(7927),u=e=>{var{title:t,description:n,learnMore:u,actions:d,imageUrl:m,dismissCallback:g,backgroundImageUrl:h}=e,b=Object(l.getNotificationMessageBarStyles)(h),[f,y]=Object(r.useState)(!0),S=Object(r.useCallback)(()=>{g(),y(!1)},[g,y]);return f?o.a.createElement(a.Stack,{horizontal:!0,horizontalAlign:"space-between",className:b.topLevelStack,"data-automation-key":"homePageNotificationMessageBar"},o.a.createElement(c.IconButton,{title:"Dismiss",iconProps:{iconName:"Cancel"},className:b.dismissButton,onClick:S}),o.a.createElement(a.Stack.Item,null,o.a.createElement(a.Stack,{className:b.textStack,tokens:l.textStackTokens},o.a.createElement(a.Stack.Item,null,o.a.createElement(s.Text,{className:b.title},t)),o.a.createElement(a.Stack.Item,null,o.a.createElement(s.Text,{className:b.description},Object(p.styleDescriptionText)(n)," ",u)),o.a.createElement(a.Stack.Item,{className:b.action},d))),l.isMediumOrSmallScreen?o.a.createElement(o.a.Fragment,null):o.a.createElement(a.Stack.Item,{align:"center",className:b.imageStack},o.a.createElement(i.Image,{height:"116px",src:m,role:"presentation"}))):o.a.createElement(o.a.Fragment,null)}},7926:function(e,t,n){"use strict";n.r(t),n.d(t,"isMediumOrSmallScreen",(function(){return i})),n.d(t,"getNotificationMessageBarStyles",(function(){return s})),n.d(t,"textStackTokens",(function(){return l})),n.d(t,"descriptionBoldTextStyles",(function(){return c}));var r=n(860),o=n(719),a=Object(o.getTheme)(),i=Object(r.getResponsiveMode)(window)<=r.ResponsiveMode.large;function s(e){return Object(o.mergeStyleSets)({topLevelStack:{position:"relative",backgroundImage:"url('".concat(e,"')"),backgroundColor:"#cccccc",backgroundPosition:"left",backgroundSize:"cover"},textStack:{margin:"12px 0 8px 32px"},imageStack:{marginRight:"32px"},title:{fontWeight:o.FontWeights.semibold,fontSize:o.FontSizes.large,lineHeight:"24px"},description:{fontSize:o.FontSizes.mediumPlus,lineHeight:"22px"},action:{marginTop:"12px !important"},dismissButton:{flexShrink:0,width:32,height:32,selectors:{"& .ms-Button-icon":{color:a.palette.neutralDark,fontSize:o.IconFontSizes.xSmall,lineHeight:"10px"},":hover":{backgroundColor:"transparent"},":active":{backgroundColor:"transparent"}},position:"absolute",top:"0",right:"0"}})}var l={childrenGap:"4"},c=Object(o.mergeStyleSets)({root:{fontWeight:o.FontWeights.semibold}})},7927:function(e,t,n){"use strict";n.r(t),n.d(t,"styleDescriptionText",(function(){return i}));var r=n(245),o=n.n(r),a=n(7926);function i(e){var t=new RegExp(/\[/),n=new RegExp(/\]/),r=e.split(t);if(r.length>1){var i=[];return r.forEach(e=>{var t=e.split(n);1===t.length&&""!==t[0]?i.push({isBold:!1,text:t[0]}):2===t.length&&(i.push({isBold:!0,text:t[0]}),""!==t[1]&&i.push({isBold:!1,text:t[1]}))}),o.a.createElement("div",null,i.map((e,t)=>e.isBold?o.a.createElement("strong",{className:a.descriptionBoldTextStyles.root,key:t},e.text):e.text))}return o.a.createElement("div",null,e)}},7928:function(e,t,n){"use strict";n.r(t),n.d(t,"separatorStyles",(function(){return o}));var r=n(3328),o=Object(r.mergeStyleSets)({root:{marginBottom:"0px",padding:"0px",height:"1px",selectors:{"::before":{top:"0"}}}})},7929:function(e,t,n){"use strict";n.r(t),n.d(t,"CreativeContentAdUnit",(function(){return o})),n.d(t,"CreativeContentBatchCount",(function(){return a})),n.d(t,"IrisActions",(function(){return r})),n.d(t,"featureName",(function(){return i})),n.d(t,"FirstLoadScenarioType",(function(){return s})),n.d(t,"PerformanceScenarioName",(function(){return l}));var r,o={production:"88000552",test:"88000551",poc:"88000550"},a=1;!function(e){e.Click="click",e.Dismiss="dismiss",e.LearnMore="learnMore"}(r||(r={}));var i="NotificationMessageBar",s="FirstLoad",l="Load"},7930:function(e,t,n){"use strict";function r(e){var t;return null!==(t=e.ad.Data)&&void 0!==t&&t.AnnouncementType?{announcementType:e.ad.Data.AnnouncementType}:{announcementType:e.ad.Body.Title.substring(0,25)}}n.r(t),n.d(t,"getAnnouncementType",(function(){return r}))},7931:function(e,t,n){"use strict";n.r(t),n.d(t,"homePageStyleClasses",(function(){return i}));var r=n(719),o=n(5492),a=n(2882),i=Object(r.mergeStyleSets)({"home-cds1-error":{display:"block"},"home-page-error-link":{selectors:{"&:hover":{textDecoration:"underline"}}},"members-indicator-container":{position:"relative",top:"28px",right:"45px",height:"0"},"home-page-component":{padding:"0 0 10px 0",backgroundColor:a.fabricColors.white,height:"100%",width:"95%",maxWidth:"1165px",margin:"auto",selectors:{".header-container-section":{padding:"25px 0 32px 0",marginLeft:"-3px",fontSize:"16px",lineHeight:"19px",selectors:{".page-title":{paddingTop:"20px",marginBottom:"18px",fontFamily:o.fonts.sergoeUiBold,lineHeight:"33px",fontSize:"28px"},".page-subtitle":{marginBottom:"0"},".link":{color:a.fabricColors.plum,textDecoration:"underline",padding:"0 0 0 5px","@media screen and (-ms-high-contrast: active)":{color:"linktext !important"}}}},"@media (max-height: 920px)":{paddingBottom:"100px"},"@media (max-width: 1430px)":{maxWidth:"870px"},"@media (max-width: 1130px)":{maxWidth:"580px"},"@media (max-width: 839px)":{maxWidth:"295px"}}},"home-page-component-simple":{padding:"0 0 10px 0",backgroundColor:a.fabricColors.white,height:"100%",width:"95%",maxWidth:"1550px",margin:"auto",selectors:{".header-container-section":{padding:"25px 0 32px 0",marginLeft:"-3px",fontSize:"16px",lineHeight:"19px",selectors:{".page-title":{paddingTop:"20px",marginBottom:"18px",fontFamily:o.fonts.sergoeUiBold,lineHeight:"33px",fontSize:"28px"},".page-subtitle":{marginBottom:"0"},".link":{color:a.fabricColors.plum,textDecoration:"underline",padding:"0 0 0 5px","@media screen and (-ms-high-contrast: active)":{color:"linktext !important"}}}},"@media (max-height: 920px)":{paddingBottom:"100px"},"@media (max-width: 1430px)":{maxWidth:"970px"},"@media (max-width: 1130px)":{maxWidth:"680px"},"@media (max-width: 839px)":{maxWidth:"295px"}}}})},7932:function(e,t,n){"use strict";n.r(t),n.d(t,"_LinkTiles",(function(){return y})),n.d(t,"LinkTiles",(function(){return S}));var r=n(245),o=n.n(r),a=n(2709),i=n(922),s=n(2698),l=n(2810),c=n(7505),p=n(5493),u=n(2882),d=n(5492),m=n(1259);var g=(e,t,n)=>o.a.createElement(a.LinkTile,{title:e("Home.LearningLinks.Tiles.StartWithPowerApps.title"),time:e("Home.LearningLinks.Tiles.StartWithPowerApps.time"),tag:e("Home.LearningLinks.Tags.beginner"),iconProps:{src:p.default.getPaths().powerButtonMonitorIcon},onClick:()=>{Object(s.trackUserActionClickLink)(l.LinkClickNames.learningLinkTile,{Tile:"StartWithPowerApps",TestCase:n})},href:"https://go.microsoft.com/fwlink/?linkid=2118236","data-automation-id":"freTour-startWithPowerApps",styles:t}),h=(e,t,n)=>o.a.createElement(a.LinkTile,{title:e("Home.LearningLinks.Tiles.AuthorBasicFormula.title"),time:e("Home.LearningLinks.Tiles.AuthorBasicFormula.time"),tag:e("Home.LearningLinks.Tags.beginner"),iconProps:{src:p.default.getPaths().sliderControlsIcon},onClick:()=>{Object(s.trackUserActionClickLink)(l.LinkClickNames.learningLinkTile,{Tile:"AuthorBasicFormula",TestCase:n})},href:"https://go.microsoft.com/fwlink/?linkid=2118330",styles:t}),b=(e,t,n)=>o.a.createElement(a.LinkTile,{title:e("Home.LearningLinks.Tiles.ExternalData.title"),time:e("Home.LearningLinks.Tiles.ExternalData.time"),tag:e("Home.LearningLinks.Tags.intermediate"),iconProps:{src:p.default.getPaths().remoteControlLaptopIcon},onClick:()=>{Object(s.trackUserActionClickLink)(l.LinkClickNames.learningLinkTile,{Tile:"ExternalData",TestCase:n})},href:"https://go.microsoft.com/fwlink/?linkid=2118237",styles:t}),f=(e,t,n)=>o.a.createElement(a.LinkTile,{title:e("Home.LearningLinks.Tiles.ManageShareApps.title"),time:e("Home.LearningLinks.Tiles.ManageShareApps.time"),tag:e("Home.LearningLinks.Tags.beginner"),iconProps:{src:p.default.getPaths().monitorMagnifyIcon},onClick:()=>{Object(s.trackUserActionClickLink)(l.LinkClickNames.learningLinkTile,{Tile:"ManageShareApps",TestCase:n})},href:"https://go.microsoft.com/fwlink/?linkid=2118239",styles:t}),y=e=>{var t,n,{t:r,isSimpleView:a}=e,i=a?c.SimplifiedAppFromBlankTestCase.Simplified:c.SimplifiedAppFromBlankTestCase.Control,s=a?{root:{width:"279px",height:"88px"}}:(t=m.ResponsiveMode.medium,n="250px",Object(m.getResponsiveMode)(window)<t?{root:{width:n}}:{}),l=[g(r,s,i),h(r,s,i),b(r,s,i),f(r,s,i)];return o.a.createElement("div",{role:"region","aria-label":r("Home.LearningLinks.header")},o.a.createElement("div",{style:{fontFamily:d.fonts.segoeUiSemibold,fontSize:"16px",color:u.fabricColors.neutralDark,marginBottom:"15px"},role:"heading","aria-level":3},r("Home.LearningLinks.header")),o.a.createElement("div",{style:{display:"flex",flexWrap:"wrap",width:a?"auto":"95%",justifyContent:a?"left":"space-between",marginLeft:a?"-8px":0}},l.map((e,t)=>o.a.createElement("div",{key:"linkTile-".concat(t),style:{padding:a?"10px":0}},e))))},S=Object(i.translateService)("PowerappsPortal")(y)},7933:function(e,t,n){"use strict";n.r(t);var r=n(7934);n.d(t,"FirstRunTourHeroInternal",(function(){return r.FirstRunTourHeroInternal})),n.d(t,"FirstRunTourHero",(function(){return r.FirstRunTourHero})),n.d(t,"forcePowerAppsFirstRunTour",(function(){return r.forcePowerAppsFirstRunTour})),n.d(t,"enablePowerAppsFirstRunTour",(function(){return r.enablePowerAppsFirstRunTour})),n.d(t,"featureName",(function(){return r.featureName})),n.d(t,"getAppModuleDesignerCreateTour",(function(){return r.getAppModuleDesignerCreateTour})),n.d(t,"firstRunTourBanner",(function(){return r.firstRunTourBanner})),n.d(t,"firstRunTourIconClass",(function(){return r.firstRunTourIconClass}));var o=n(7940);n.d(t,"IdentifySampleData",(function(){return o.IdentifySampleData}))},7934:function(e,t,n){"use strict";n.r(t);var r=n(7935);n.d(t,"FirstRunTourHeroInternal",(function(){return r.FirstRunTourHeroInternal})),n.d(t,"FirstRunTourHero",(function(){return r.FirstRunTourHero}));var o=n(7938);n.d(t,"forcePowerAppsFirstRunTour",(function(){return o.forcePowerAppsFirstRunTour})),n.d(t,"enablePowerAppsFirstRunTour",(function(){return o.enablePowerAppsFirstRunTour})),n.d(t,"featureName",(function(){return o.featureName})),n.d(t,"getAppModuleDesignerCreateTour",(function(){return o.getAppModuleDesignerCreateTour}));var a=n(7939);n.d(t,"firstRunTourBanner",(function(){return a.firstRunTourBanner})),n.d(t,"firstRunTourIconClass",(function(){return a.firstRunTourIconClass}))},7935:function(e,t,n){"use strict";n.r(t),n.d(t,"FirstRunTourHeroInternal",(function(){return S})),n.d(t,"FirstRunTourHero",(function(){return C}));var r=n(245),o=n.n(r),a=n(3916),i=n(687),s=n(1795),l=n(5149),c=n(216),p=n(1105),u=n(2807),d=n(7936),m=n(7934),g=n(5493),h=n(7937),b=n(5593),f=n(860),y=new a.QueryClient,S=e=>{var{t:t,environmentName:n}=e,{oid:a}=Object(r.useContext)(c.AuthenticatedUserInfoContext),[h,y]=o.a.useState(m.forcePowerAppsFirstRunTour),{isLoading:S,error:C,appsList:v}=Object(d.useCuratedAppsApi)(u.PortalScope,m.featureName),{hasDataverse:w,currentEnvironment:O}=Object(p.useHasDataverse)(),P=O&&Object(p.canUserCreateDatabase)(O),E=o.a.createRef(),A=Object(f.useResponsiveMode)(E);Object(r.useEffect)(()=>{y(m.forcePowerAppsFirstRunTour||!(v||[]).some(e=>e.properties.createdBy.id===a))},[v]);var j=!S&&!C&&h&&w&&P||m.forcePowerAppsFirstRunTour;return Object(r.useEffect)(()=>{j&&Object(b.trackCustomEvent)("".concat(m.featureName,"/Shown"))},[j]),j?o.a.createElement("div",{ref:E},o.a.createElement(l.GettingStartedHeroBanner,{styles:Object(m.firstRunTourBanner)(A),header:t("FirstRunTour.Hero.header"),backgroundImageUrl:g.default.getPaths().missionUIBG,content:o.a.createElement(s.Stack,{tokens:{childrenGap:8}},o.a.createElement(s.Stack.Item,null,o.a.createElement(i.FontIcon,{iconName:"GridViewSmall",className:m.firstRunTourIconClass}),t("FirstRunTour.Hero.bulletOne")),o.a.createElement(s.Stack.Item,null,o.a.createElement(i.FontIcon,{iconName:"Play",className:m.firstRunTourIconClass}),t("FirstRunTour.Hero.bulletTwo")),o.a.createElement(s.Stack.Item,null,o.a.createElement(i.FontIcon,{iconName:"CellPhone",className:m.firstRunTourIconClass}),t("FirstRunTour.Hero.bulletThree"))),callToAction:{text:t("FirstRunTour.Hero.callToAction"),onRenderIcon:()=>o.a.createElement(i.FontIcon,{iconName:"Add"}),onClick:()=>{Object(b.trackUserActionClickButton)("".concat(m.featureName,"/BannerClicked")),window.location.href=Object(m.getAppModuleDesignerCreateTour)(n)}}})):o.a.createElement(o.a.Fragment,null)},C=e=>o.a.createElement(h.ErrorBoundary,{name:m.featureName},o.a.createElement(a.QueryClientProvider,{client:y},o.a.createElement(S,e)))},7936:function(e,t,n){"use strict";n.r(t),n.d(t,"useCuratedAppsApi",(function(){return c})),n.d(t,"prefetchCuratedAppsApi",(function(){return p}));var r=n(245),o=n(3916),a=n(1146),i=n(217);function s(e,t,n,r,o,a,i){try{var s=e[a](i),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}function l(){return a.default.get("https://pa-rp/curatedApps?api-version=2021-02-01")}function c(e,t){var n,[a,s]=Object(r.useState)(),c="".concat(t,"/CuratedAppsLoad");Object(r.useEffect)(()=>(!a&&s(Object(i.trackLoadScenario)(e,c)),()=>{s(void 0)}),[]);var{isLoading:p,error:u,data:d}=Object(o.useQuery)("curatedApps",l);return Object(r.useEffect)(()=>{if(a)if(u)a.failure({error:u});else if(!p){var e;a.complete({amountOfApps:null==d||null===(e=d.data)||void 0===e?void 0:e.value.length})}},[p,u,a]),{isLoading:p,error:u,appsList:null==d||null===(n=d.data)||void 0===n?void 0:n.value}}var p=function(){var e,t=(e=function*(e){yield e.prefetchQuery("curatedApps",l)},function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){s(a,r,o,i,l,"next",e)}function l(e){s(a,r,o,i,l,"throw",e)}i(void 0)}))});return function(e){return t.apply(this,arguments)}}()},7937:function(e,t,n){"use strict";n.r(t),n.d(t,"ErrorBoundary",(function(){return i}));var r=n(245),o=n.n(r),a=n(5593);class i extends o.a.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(e,t){var n;Object(a.trackErrorTrace)("ErrorBoundaryError/".concat(null===(n=this.props)||void 0===n?void 0:n.name),{error:e,errorInfo:t})}render(){return this.state.hasError?this.props.onRenderError||o.a.createElement(o.a.Fragment,null):this.props.children}}},7938:function(e,t,n){"use strict";n.r(t),n.d(t,"forcePowerAppsFirstRunTour",(function(){return a})),n.d(t,"enablePowerAppsFirstRunTour",(function(){return i})),n.d(t,"featureName",(function(){return s})),n.d(t,"getAppModuleDesignerCreateTour",(function(){return l}));var r=n(1194),o=n(5877),a=r.featureGates.forcePowerAppsFirstRunTour,i=r.featureGates.enablePowerAppsFirstRunTour||a,s="FirstRunTour",l=e=>Object(o.getAppModuleDesignerCreateUrl)(e)+"?cdsCommon.enablePowerAppsFirstRunTour=true&tour=first-run"},7939:function(e,t,n){"use strict";n.r(t),n.d(t,"firstRunTourBanner",(function(){return s})),n.d(t,"firstRunTourIconClass",(function(){return l}));var r=n(719),o=n(5493),a=n(5617),i=n(860),s=e=>{var t,n,r,s=e<i.ResponsiveMode.xxxLarge;switch(e){case i.ResponsiveMode.xxxLarge:n="url(".concat(o.default.getPaths().missionUIBGRightLarge,")"),r=688;break;case i.ResponsiveMode.xxLarge:n="url(".concat(o.default.getPaths().missionUIBGRightMedium,")"),r=380;break;case i.ResponsiveMode.xLarge:case i.ResponsiveMode.large:case i.ResponsiveMode.medium:case i.ResponsiveMode.small:default:r=48,n=""}return{root:{marginTop:s?32:17,marginBottom:0,background:s?"#852685":"transparent",boxShadow:"none"},container:{selectors:{"::before":{content:'""',backgroundColor:null===(t=a.fabricTheme.palette)||void 0===t?void 0:t.white,width:4,height:4,position:"absolute",right:0,top:18,display:s?"none":""},"::after":{content:'""',borderBottom:0,position:"absolute",right:0,top:18,width:8,height:8,backgroundColor:"#742774",borderRadius:"0 5px 0 0",display:s?"none":""}},backgroundImage:n,backgroundPosition:"right top",backgroundRepeat:"no-repeat",backgroundSize:"contain",paddingTop:s?32:75,position:"relative",paddingRight:r},backgroundImageContainer:{borderRadius:5,backgroundPosition:s?"left top":"left top 18px"}}},l=Object(r.mergeStyles)({height:16,width:16,marginRight:8})},7940:function(e,t,n){"use strict";n.r(t);var r=n(7941);n.d(t,"IdentifySampleData",(function(){return r.IdentifySampleData}))},7941:function(e,t,n){"use strict";n.r(t),n.d(t,"IdentifySampleData",(function(){return c}));var r=n(245),o=n(2698),a=n(3076),i=n(1105),s=n(6379),l=n(5731),c=()=>{var{environmentClient:e}=r.useContext(a.ApolloClientContext),{currentEnvironment:t}=r.useContext(i.EnvironmentContext),n=t&&Object(i.environmentHasCds2Database)(t),c=n&&e,{loading:p,solution:u}=Object(s.useSolutionByUniqueName)(e,"msdyn_SampleApp",o.PortalScope,"SampleAppSolutionCallFailed",!c);return r.useEffect(()=>{p||Object(l.sendUsageTelemetry)("FirstRunTour/Telemetry","SampleAppSolutionLoaded",{hasDataverse:n,hasSampleAppSolution:!!u})},[p]),r.createElement(r.Fragment,null)}},7942:function(e,t,n){"use strict";n.r(t),n.d(t,"getBlankSampleAppData",(function(){return a})),n.d(t,"getSampleAppData",(function(){return i})),n.d(t,"RecentAppListLoadEvent",(function(){return s})),n.d(t,"HomeContexts",(function(){return l})),n.d(t,"SampleAppTileEvents",(function(){return c})),n.d(t,"SampleAppsLoadEvent",(function(){return p})),n.d(t,"HomeP2PlanRenewalEvents",(function(){return u})),n.d(t,"StaticAppTileEvents",(function(){return d})),n.d(t,"PartialSampleAppsListEvents",(function(){return m})),n.d(t,"LearnMoreNavigationEvent",(function(){return g}));var r=n(2812),o=n(5595);function a(e){return{formFactor:e}}function i(e,t){return Object(r.merge)(Object(o.getAppData)(e.default),{formFactor:t,supportsPhone:!!e.phone,supportsTablet:!!e.tablet})}var s={eventName:"Home.RecentApps.Load"},l={RecentAppTile:"Home.RecentAppTile"},c={Preview:{eventName:"Home.SampleApp.Launched.Preview",getData:i},Customize:{eventName:"Home.SampleApp.Launched.Customize",getData:i}},p={eventName:"Home.SampleApps.Load"},u={Load:{eventName:"Home.P2PlanRenewal.Load"}},d={Customize:{eventName:"Home.StaticSampleApp.Launched.Customize",getData:a},Preview:{eventName:"Home.StaticSampleApp.Launched.Preview",getData:a}},m={Navigation:{eventName:"PartialSampleAppsList.OnAllSampleAppsClicked"}},g={Navigation:{eventName:"Home.OnLearnMoreClicked"}}},7943:function(e,t,n){"use strict";n.r(t),n.d(t,"LearnPage",(function(){return g}));var r=n(245),o=n(7944),a=n(7949),i=n(2879),s=n(5481),l=n(2869),c=n(7953),p=n(7955),u=n(7951),d=n(545),m=n(2871);class g extends r.Component{constructor(){super(...arguments),this.resources=void 0}render(){this.resources=Object(l.getResources)();var e=[],t={iconName:i.fabricIcons.Dictionary,title:this.resources.Learn.Generic.LearningTile.GuidedLearning.Title,subtitle:this.resources.Learn.LearningTile.GuidedLearning.Subtitle,buttonText:this.resources.Learn.LearningTile.GuidedLearning.button.text,buttonUrl:s.default.canvasAppsLearnLink};e.push(t);var n={iconName:i.fabricIcons.GridViewMedium,title:this.resources.Learn.LearningTile.Documentation.Title,subtitle:this.resources.Learn.LearningTile.Documentation.Subtitle,buttonText:this.resources.Learn.Generic.LearningTile.Documentation.Button.text,linkText:this.resources.Learn.LearningTile.Documentation.link.text,buttonUrl:s.default.exploreLink,linkUrl:s.default.support};e.push(n);var g={iconName:i.fabricIcons.Family,title:this.resources.Learn.LearningTile.Community.Title,subtitle:this.resources.Learn.LearningTile.Community.Subtitle,buttonText:this.resources.Learn.LearningTile.Community.button.text,linkText:this.resources.Learn.LearningTile.Community.link.text,buttonUrl:s.default.communityLink,linkUrl:s.default.partnerContactLink};e.push(g);var h=e.map(e=>r.createElement("div",{key:e.iconName,className:Object(d.css)("ms-Grid-col ms-md4",u.learningTileStyles["learning-tile-wrapper"])},r.createElement("div",{className:"learning-tile-repeat-container"},r.createElement(a.LearningTileContainer,{iconName:e.iconName,title:e.title,subtitle:e.subtitle,buttonText:e.buttonText,linkText:e.linkText,buttonUrl:e.buttonUrl,linkUrl:e.linkUrl}))));return r.createElement("div",{className:p.learnPageStylesClass["learn-page"]},r.createElement(c.Header,null),r.createElement("div",{className:"learn-page-stripe",role:"banner"},r.createElement("div",{className:"ms-Grid center-learn-page"},r.createElement("div",{className:"ms-Grid-row learn-tile-row"},h))),m.featureGates.showBlogTileList&&r.createElement(o.BlogTileListContainer,{blogsToShow:4}))}}},7944:function(e,t,n){"use strict";n.r(t),n.d(t,"createBlogTileListItems",(function(){return b})),n.d(t,"mapStateAndParentPropsToProps",(function(){return f})),n.d(t,"mapDispatchToProps",(function(){return y})),n.d(t,"mergeProps",(function(){return S})),n.d(t,"BlogTileListContainer",(function(){return C}));var r=n(5437),o=n(5630),a=n(7562),i=n(7567),s=n(5468),l=n(5481),c=n(5629),p=n(7945),u=n(7948),d=n(5669);function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){h(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var b=e=>e?e.map(e=>({title:e.Title,date:e.Date,url:e.URL,description:e.Description})):[],f=(e,t)=>{var n=Object(i.blogsListErrorSelector)(e);return{blogs:b(Object(i.blogsSelector)(e)),blogsToShow:t.blogsToShow,loadProgress:[Object(c.toLoadingState)(!Object(i.blogsListIsFetchingSelector)(e),n)],logEvent:u.LearnEvents.BlogsLoad}},y=e=>({onLoad:()=>e(Object(a.fetchBlogsRequest)()),onDismount:()=>{e(Object(a.fetchBlogsCancelPoll)())},onSeeMoreClicked:()=>e(Object(o.logAction)(s.sharedActions.openNewTab({uri:l.default.blogPostsLink}),u.LearnEvents.BlogTileList.SeeMoreClicked.eventName,{linkUrl:l.default.blogPostsLink})),onBlogTileClicked:t=>e(Object(o.logAction)(s.sharedActions.openNewTab({uri:t}),u.LearnEvents.BlogTileList.BlogTileClickedEvent.eventname,{linkUrl:t})),dispatchTelemetry:e}),S=(e,t)=>g(g({},e),t),C=Object(r.connect)(f,y,S)(Object(c.withLoadTelemetry)(p.BlogTileList,d.LoadScenarioNames.BlogTileList))},7945:function(e,t,n){"use strict";n.r(t),n.d(t,"BlogTileList",(function(){return p}));var r=n(687),o=n(1090),a=n(245),i=n(2869),s=n(7946),l=n(5629);function c(){return(c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}class p extends a.Component{constructor(e){super(e),this.props=e}componentDidMount(){this.props.onLoad()}componentWillUnmount(){this.props.onDismount()}render(){var e=Object(i.getResources)(),t=a.createElement("div",{className:"blog-tile-list-react row",role:"main"},a.createElement("div",{className:"blog-tile-list-left-section ms-md3"},a.createElement(r.Icon,{iconName:"News"}),a.createElement("div",{className:"blog-tile-list-title",role:"heading","aria-level":3},e.Learn.Blog.List.title)),a.createElement("div",{className:"blog-tile-list-right-section ms-md9"},a.createElement("div",{className:"blog-tile-list-blog-list row"},Object(l.isLoading)(this.props.loadProgress)?new Array(this.props.blogsToShow).fill(1).map((e,t)=>a.createElement(s.BlogTilePlaceholder,{key:t})):this.props.blogs.slice(0,this.props.blogsToShow).map((e,t)=>a.createElement(s.BlogTile,c({},e,{onClick:this.props.onBlogTileClicked,key:t})))),a.createElement(o.Link,{className:"blog-tile-list-see-more",onClick:e=>this.props.onSeeMoreClicked(),role:"link",href:"#"},e.Learn.Blog.List.see.more.link)));return a.createElement("div",null,t)}}},7946:function(e,t,n){"use strict";n.r(t),n.d(t,"BlogTile",(function(){return p})),n.d(t,"BlogTilePlaceholder",(function(){return u}));var r=n(1090),o=n(545),a=n(1755),i=n(245),s=n(2869),l=n(2880),c=n(7947),p=e=>{var t=Object(s.getResources)();return i.createElement("div",{className:Object(o.css)(c.blogTileStyles.blogTile,"ms-md12 ms-lg12")},i.createElement("span",{className:"blog-tile-date"}," ",e.date," "),i.createElement(r.Link,{className:"blog-tile-title","aria-label":Object(l.formatResourceString)(t.Learn.Blog.List.ariaLabel,e.title),role:"link"},i.createElement("div",{onClick:()=>e.onClick(e.url)},e.title)),i.createElement("p",{className:"blog-tile-decription",dangerouslySetInnerHTML:{__html:e.description}}))},u=e=>i.createElement("div",{className:Object(o.css)(c.blogTilePlaceholderStyles.blogTile,"ms-md12 ms-lg12")},i.createElement(a.Shimmer,{className:c.blogTilePlaceholderStyles.shimmer,width:70,height:14}),i.createElement(a.Shimmer,{className:c.blogTilePlaceholderStyles.shimmer,width:360}),i.createElement(a.Shimmer,{className:c.blogTilePlaceholderStyles.shimmer}),i.createElement(a.Shimmer,{className:c.blogTilePlaceholderStyles.shimmer}),i.createElement(a.Shimmer,{className:c.blogTilePlaceholderStyles.shimmer}))},7947:function(e,t,n){"use strict";n.r(t),n.d(t,"blogTileStyles",(function(){return p})),n.d(t,"blogTilePlaceholderStyles",(function(){return u}));var r=n(719),o=n(2882),a=n(5492);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var c={marginBottom:"24px",overflow:"auto",paddingLeft:"0",paddingRight:"16px",width:"100%",marginRight:"0"},p=Object(r.mergeStyleSets)({blogTile:s(s({},c),{},{selectors:{"&:hover":{selectors:{".blog-tile-title":{textDecoration:"underline"}}},".blog-tile-date":{color:o.fabricColors.accentGray,display:"block",height:"16px",fontFamily:a.fonts.segoeUi,fontSize:"12px"},".blog-tile-title":{color:o.fabricColors.mineShaft,display:"block",fontFamily:a.fonts.segoeUiSemibold,fontSize:"14px",lineHeight:"19px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",selectors:{"&:focus":{textDecoration:"underline",color:o.fabricColors.mineShaft}}},".blog-tile-decription":{color:o.fabricColors.accentGray,fontFamily:a.fonts.segoeUi,fontSize:"14px"}}})}),u=Object(r.mergeStyleSets)({blogTile:c,shimmer:{marginBottom:3}})},7948:function(e,t,n){"use strict";n.r(t),n.d(t,"LearnEvents",(function(){return r}));var r={BlogsLoad:{eventName:"Learn.Blogs.Load"},BlogTileList:{SeeMoreClicked:{eventName:"Learn.BlogsList.SeeMoreLinkClicked"},BlogTileClickedEvent:{eventname:"Learn.BlogsList.BlogTileClicked"}}}},7949:function(e,t,n){"use strict";n.r(t),n.d(t,"mapStateAndParentPropsToProps",(function(){return l})),n.d(t,"mapDispatchToProps",(function(){return c})),n.d(t,"LearningTileContainer",(function(){return p}));var r=n(5437),o=n(5630),a=n(5468),i=n(7950),s=n(7952),l=(e,t)=>({iconName:t.iconName,title:t.title,subtitle:t.subtitle,buttonText:t.buttonText,linkText:t.linkText,buttonUrl:t.buttonUrl,linkUrl:t.linkUrl}),c=e=>({onButtonClick:t=>e(Object(o.logAction)(a.sharedActions.openNewTab({uri:t}),s.LearnEvents.LearningTiles.OpenNewTab.eventName,{linkUrl:t}))}),p=Object(r.connect)(l,c)(i.LearningTile)},7950:function(e,t,n){"use strict";n.r(t),n.d(t,"LearningTile",(function(){return c}));var r=n(684),o=n(1372),a=n(1090),i=n(687),s=n(245),l=n(7951);class c extends s.Component{constructor(e){super(e),this.props=e}render(){return s.createElement("div",{className:l.learningTileStyles["learning-tile-wrapper"]},s.createElement("div",{className:"learning-tile"},s.createElement(i.Icon,{className:"learning-tile-icon",iconName:this.props.iconName}),s.createElement(o.Label,{title:this.props.title,role:"heading","aria-level":3,className:"learning-tile-title"},this.props.title),s.createElement(o.Label,{className:"learning-tile-subtitle",title:this.props.subtitle},this.props.subtitle),s.createElement(r.PrimaryButton,{className:"learning-tile-button",onClick:()=>this.props.onButtonClick(this.props.buttonUrl),text:this.props.buttonText}),this.props.linkUrl&&this.props.linkText&&s.createElement(a.Link,{className:"learning-tile-link",href:this.props.linkUrl,target:"_blank"},this.props.linkText)))}}},7951:function(e,t,n){"use strict";n.r(t),n.d(t,"learningTileStyles",(function(){return i}));var r=n(719),o=n(2882),a=n(5492),i=Object(r.mergeStyleSets)({"learning-tile-wrapper":{margin:"0",padding:"0",width:"284px",selectors:{"@media (max-width: 1320px)":{width:"100%"},".learning-tile":{height:"295px",overflow:"auto",marginRight:"20px",margin:"0 auto",width:"284px",selectors:{"@media (max-width: 1320px)":{marginBottom:"16px",width:"100%",backgroundColor:o.fabricColors.neutralLighter},"> *":{marginLeft:"auto",marginRight:"auto",textAlign:"center"},".learning-tile-icon":{display:"block",fontSize:"48px",height:"48px",marginTop:"36px",width:"48px"},".learning-tile-title":{display:"block",color:o.fabricColors.black,fontFamily:a.fonts.segoeUiSemibold,fontSize:"21px",marginTop:"13px"},".learning-tile-subtitle":{color:o.fabricColors.accentGray,display:"block",fontFamily:a.fonts.segoeUi,fontSize:"14px",lineHeight:"20px",marginTop:"-7px",fontWeight:"normal",minHeight:"50px"},".learning-tile-button":{border:0,color:o.fabricColors.white,display:"block",fontFamily:a.fonts.segoeUi,fontSize:"17px",height:"40px",marginTop:"21px",width:"160px",selectors:{"&:hover":{backgroundColor:o.fabricColors.brandColorDark},"@media screen and (-ms-high-contrast: white-on-black)":{backgroundColor:o.fabricColors.neutralPlum}}},".learning-tile-link":{display:"block",color:o.fabricColors.neutralPlum,fontFamily:a.fonts.segoeUi,fontSize:"14px",marginTop:"13px"}}}}}})},7952:function(e,t,n){"use strict";n.r(t),n.d(t,"LearnEvents",(function(){return r}));var r={LearningTiles:{OpenNewTab:{eventName:"Learn.LearningTiles.OpenNewTab"}}}},7953:function(e,t,n){"use strict";n.r(t),n.d(t,"Header",(function(){return i}));var r=n(245),o=n(2869),a=n(7954);class i extends r.Component{constructor(e){super(e),this.props=e,this.resources=void 0,this.resources=Object(o.getResources)()}render(){return r.createElement("div",{className:a.headerStylesClass["header-page"],role:"main"},r.createElement("div",{className:"center-header-page header-page-header"},r.createElement("div",{className:"header-page-title",role:"heading","aria-level":2},this.resources.Learn.Generic.title),r.createElement("div",{className:"header-page-subtitle"},r.createElement("span",null,this.resources.Learn.Generic.subtitle," "))))}}},7954:function(e,t,n){"use strict";n.r(t),n.d(t,"headerStylesClass",(function(){return i}));var r=n(719),o=n(2882),a=n(5492),i=Object(r.mergeStyleSets)({"header-page":{backgroundColor:o.fabricColors.white,width:"100%",selectors:{"@media (max-width: 1320px)":{paddingLeft:"0",paddingRight:"0"},".center-header-page":{margin:"0 auto",maxWidth:"1226px",selectors:{"& .header-page-header":{paddingTop:"84px",selectors:{"@media (max-width: 1800px)":{maxWidth:"922px",paddingLeft:"0",paddingRight:"0"},"@media (max-width: 1320px)":{maxWidth:"618px",paddingLeft:"0",paddingRight:"0"},"@media (max-width: 1032px)":{maxWidth:"314px",paddingLeft:"0",paddingRight:"0"},".header-page-title":{color:o.fabricColors.mineShaft,fontFamily:a.fonts.segoeUiSemibold,fontSize:"42px",paddingTop:"0",margin:"0 0 10px 0",lineHeight:"56px",selectors:{"@media (max-width: 1320px)":{fontSize:"30px"}}},".header-page-subtitle":{color:o.fabricColors.mineShaft,fontFamily:a.fonts.segoeUi,fontSize:"17px",lineHeight:"22px"},".header-page-subtitle-link":{fontFamily:a.fonts.segoeUi,color:o.fabricColors.neutralPlum,fontSize:"18px",lineHeight:"22px"}}}}}}}})},7955:function(e,t,n){"use strict";n.r(t),n.d(t,"learnPageStylesClass",(function(){return i}));var r=n(719),o=n(2882),a=n(5492),i=Object(r.mergeStyleSets)({"learn-page":{backgroundColor:o.fabricColors.white,paddingBottom:"124px",width:"100%",selectors:{"@media (max-width: 1320px)":{paddingLeft:"0",paddingRight:"0"},".learn-page-spinner":{paddingTop:"84px"},".center-learn-page":{margin:"0 auto",maxWidth:"1226px",selectors:{"& .learn-page-top-section":{paddingLeft:"15px",paddingRight:"15px",paddingTop:"84px",selectors:{"@media (max-width: 1800px)":{maxWidth:"922px",paddingLeft:"0",paddingRight:"0"},"@media (max-width: 1320px)":{maxWidth:"618px",paddingLeft:"0",paddingRight:"0"},"@media(max-width: 1032px)":{maxWidth:"314px",paddingLeft:"0",paddingRight:"0"},".learn-page-title":{color:o.fabricColors.mineShaft,fontFamily:a.fonts.segoeUiSemibold,fontSize:"42px",paddingTop:"0",marginTop:"0",lineHeight:"56px",selectors:{"@media (max-width: 1320px)":{fontSize:"30px"}}},".learn-page-subtitle":{color:o.fabricColors.mineShaft,fontFamily:a.fonts.segoeUi,fontSize:"17px",lineHeight:"22px"},".learn-page-subtitle-link":{fontFamily:a.fonts.segoeUi,color:o.fabricColors.neutralPlum,lineHeight:"22px"}}},".learn-tile-row":{margin:"0 auto !important",maxWidth:"1052px",selectors:{".learning-tile-repeat-container":{margin:"0 auto",width:"284px",selectors:{":first-child":{marginLeft:"60px"},":last-child":{marginRight:"60px"},"@media (max-width: 1320px)":{width:"100%",selectors:{":first-child":{marginLeft:"0"},":last-child":{marginRight:"0"}}}}}}}}},".blog-tile-list-react":{selectors:{".link-more":{display:"none"}}},".learn-page-stripe":{backgroundColor:o.fabricColors.neutralLighter,marginTop:"48px",paddingLeft:"48px",paddingRight:"48px",selectors:{"@media (max-width: 1320px)":{backgroundColor:o.fabricColors.white,paddingLeft:"0",paddingRight:"0"}}}}}})},7956:function(e,t,n){"use strict";n.r(t),n.d(t,"MiddletierCDSPrefetch",(function(){return d}));var r=n(1071),o=n(3144),a=n(2871),i=n(303),s=n(5593),l=n(6379),c=n(5487),p=n(5604),u=n(2869);var d=Object(r.withServices)((function(e){try{if(!a.featureGates.prefetchCdsPortalData||!Object(p.environmentHasCds2Database)(e.rootProps.currentEnvironment)||!e.environmentClient)return null;var t=p.crmBapSolutionId;if(e.match&&e.match.params&&e.match.params.solutionId&&(t=e.match.params.solutionId),!t)return null;Object(l.useSolution)(e.environmentClient,t,s.PortalScope,Object(u.getResources)().Common.Request.Failed)}catch(n){Object(s.trackErrorTrace)("withMiddleTierCDSPrefetch",n)}return null}),[o.withApolloClient,i.withRouter,c.withRootProps])},7957:function(e,t,n){"use strict";n.r(t),n.d(t,"getSolutionId",(function(){return O})),n.d(t,"getCreatedOn",(function(){return P})),n.d(t,"mapStateToProps",(function(){return E})),n.d(t,"mapDispatchToProps",(function(){return A})),n.d(t,"mergeProps",(function(){return j})),n.d(t,"SolutionCheckerViewResultsPageContainer",(function(){return L}));var r=n(5437),o=n(5478),a=n(5629),i=n(2869),s=n(2880),l=n(5623),c=n(6603),p=n(6602),u=n(5690),d=n(5691),m=n(5468),g=n(5687),h=n(7958),b=n(5487),f=n(5582),y=n(5669),S=n(5583);function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(Object(n),!0).forEach((function(t){w(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function w(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function O(e){return e&&e.match&&e.match.params&&e.match.params.solutionId||""}function P(e){var t=e&&e.match&&e.match.params&&e.match.params.createdOn||"";return t?new Date(t):null}function E(e,t){var n,r,o=Object(f.currentEnvironmentIdSelector)(t),l=O(t)||"",c=P(t)||null,u=d.solutionSelector(e,l);return{solution:u,solutionId:l,createdOn:c,logEvent:g.SolutionCheckerViewResultsPageLoadEvents,loadProgress:[Object(a.toLoadingState)(!!u)],isSolutionCheckerResultsLoading:p.isSolutionCheckerResultsApiLoading(e,o),isSolutionCheckerStatusLoading:d.isSolutionCheckerLoading(e),isSolutionListLoading:d.isSolutionListLoading(e),issuesCountText:(n=p.solutionCheckerResultsListCount(e,o),r=Object(i.getResources)(),1===n?r.Model.Solutions.SolutionCheckerResults.HeaderIssueCount.singular:Object(s.formatResourceString)(r.Model.Solutions.SolutionCheckerResults.HeaderIssueCount.plural,n)),columnGroups:p.solutionCheckerResultsColumnGroups(e,o)}}var A=(e,t)=>{var n=Object(f.currentEnvironmentIdSelector)(t);return{onHeaderClickNavigate:e=>t.navigate(e,!0),onDismissOpenPanels:()=>e(m.sharedActions.panelClose({panelType:o.PanelToShowType.SolutionCheckerViewResultDetailPanel})),loadSolutionCheckerResults:(t,r)=>{e(Object(u.fetchSolutionByIdRequest)({solutionID:t,createdOn:r,includeSolutionCheckerStatus:!0})),e(Object(c.fetchSolutionCheckerResultsRequest)({solutionId:t,createdOn:r,environmentId:n}))},dispatchTelemetry:e}},j=(e,t,n)=>{var{areShellProvidersReady:r}=n.rootProps;return v(v({},e),{},{dispatchTelemetry:t.dispatchTelemetry,onHeaderClick:()=>t.onHeaderClickNavigate(l.solutionListRoute.canvas),onDismissOpenPanels:t.onDismissOpenPanels,loadSolutionCheckerResults:t.loadSolutionCheckerResults,areShellProvidersReady:r})},L=Object(S.withNavigation)(Object(b.withRootProps)(Object(r.connect)(E,A,j)(Object(a.withLoadTelemetry)(h.SolutionCheckerViewResultsPage,y.LoadScenarioNames.SolutionCheckerViewResultsPage))))},7958:function(e,t,n){"use strict";n.r(t),n.d(t,"SolutionCheckerViewResultsPage",(function(){return b}));var r=n(4792),o=n(4105),a=n(719),i=n(687),s=n(245),l=n(1200),c=n(2886),p=n(2879),u=n(2869),d=n(7959),m=n(7960),g=n(6597),h=Object(a.mergeStyleSets)({spanText:{paddingLeft:"9px",fontSize:a.FontSizes.medium},spanTextLocationDot:{fontSize:a.FontSizes.xSmall,paddingLeft:"8px",paddingRight:"8px"},divPadding:{paddingBottom:"20px"}});class b extends s.Component{constructor(e){super(e),this.resources=void 0,this.breadCrumbItems=void 0,this.state={},this.resources=Object(u.getResources)()}componentDidMount(){this.props.loadSolutionCheckerResults(this.props.solutionId,this.props.createdOn)}componentWillUnmount(){this.props.onDismissOpenPanels()}render(){var e=Object(g.populateLocalizedTextValues)(this.props.columnGroups);this.initializeBreadCrumbItem(this.props.solution,e);var t=new Date;return this.props.solution&&this.props.solution.solutionCheckerResults&&this.props.solution.solutionCheckerResults.lastRun&&(t=new Date(this.props.solution.solutionCheckerResults.lastRun.createdon.toString())),this.props.areShellProvidersReady?s.createElement(r.Page,{className:"solution-checker-view-results-page",spinnerProps:{label:this.resources.Model.Solutions.SolutionCheckerResults.Loading.analysisResults},showOverlay:this.props.isSolutionCheckerResultsLoading||this.props.isSolutionCheckerStatusLoading||this.props.isSolutionListLoading,renderTitle:()=>s.createElement(s.Fragment,null,s.createElement(o.PageHeader,{wrapperClassName:"solution-checker-view-results-page-breadcrumb",titleBreadcrumbProps:{items:this.breadCrumbItems,ariaLabel:this.resources.Apps.AppManagement.Breadcrumbs.apps}}),s.createElement("span",{className:h.spanText},Object(c.getLocalizedCompleteText)(t),s.createElement(i.Icon,{iconName:p.fabricIcons.LocationDot,className:h.spanTextLocationDot}),this.props.issuesCountText),s.createElement("div",{className:h.divPadding})),renderHeader:()=>s.createElement(d.SolutionsCheckerViewResultsCommandBarContainer,{solutionId:this.props.solutionId}),renderBody:()=>s.createElement(m.SolutionCheckerResultsListContainer,null)}):s.createElement(l.PagePlaceholder,null)}initializeBreadCrumbItem(e,t){this.breadCrumbItems=[],this.breadCrumbItems.push({text:this.resources.Model.Solutions.ListPage.pageTitle,key:this.resources.Model.Solutions.ListPage.pageTitle,onClick:()=>{this.props.onHeaderClick()}}),this.breadCrumbItems.push({text:Object(c.getSolutionDisplayName)(e),key:Object(c.getSolutionId)(e)}),this.breadCrumbItems.push({text:this.resources.Model.Solutions.SolutionCheckerResults.BreadCrumb.checkResults,key:this.resources.Model.Solutions.SolutionCheckerResults.BreadCrumb.checkResults}),t&&g.groupingColumnsListForBreadCrumb.forEach(e=>{var n=null;t.has(e)&&(n=t.get(e));var r=n?n.filter(e=>e.isChecked):null;if(r&&r.length>0){var o=r.map(e=>e.text).join(this.resources.Common.listSeparator);this.breadCrumbItems.push({text:o,key:o})}})}}},7959:function(e,t,n){"use strict";n.r(t),n.d(t,"mapStateToProps",(function(){return S})),n.d(t,"mapDispatchToProps",(function(){return C})),n.d(t,"mergeProps",(function(){return v})),n.d(t,"SolutionsCheckerViewResultsCommandBarContainer",(function(){return w}));var r=n(5437),o=n(5630),a=n(5746),i=n(5687),s=n(1222),l=n(6598),c=n(5691),p=n(2886),u=n(6602),d=n(6603),m=n(6607),g=n(5487),h=n(5582);function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){y(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var S=(e,t)=>{var n=Object(h.currentEnvironmentIdSelector)(t),r=a.solutionsSelectors.solutionsBeingDownloaded(e,n),o=a.solutionsSelectors.solutionSelector(e,t.solutionId),i=!!o&&Object(p.isSolutionInArray)(o.id,r),s=Object(u.solutionCheckerResultsColumnGroups)(e,n),l=s&&s.some(e=>e.some(e=>e.isChecked));return{isSelectedSolutionCheckerDownloadStarting:i,isSolutionCheckerStatusLoading:c.isSolutionCheckerLoading(e),groupingOptions:u.solutionCheckerResultsGroupOptionsSelector(e,n),searchString:u.solutionCheckerResultsSearchString(e,n),isFilterApplied:l,solution:o}},C=e=>({solutionCommands:{onSolutionCheckerDownloadClick:(t,n)=>e(Object(o.logAction)(a.solutionsActions.solutionCheckerDownload({solution:t,environmentId:n}),i.SolutionCommandEvents.SolutionCheckDownload.eventName)),onSolutionCheckerResultsSortByGroupOption:(t,n)=>e(Object(o.logAction)(Object(d.changeGroupingSolutionCheckerResults)({groupingOption:t,environmentId:n}),i.SolutionCheckerViewResultsListChangeGroupingEvents.eventName)),onSolutionCheckerResultsOpenFilterPanel:()=>e(Object(o.logAction)(Object(d.openSolutionCheckerResultsFilterPanel)(),i.SolutionCheckerViewResultsListFilterPanelEvents.eventName)),onSolutionCheckerResultsSearch:(t,n)=>e(Object(o.logAction)(Object(d.searchFilterSolutionCheckerResult)({searchString:t,environmentId:n}),i.SolutionCheckerViewResultsListSearchBoxEvents.eventName)),onSolutionCheckerResultsClearSearch:t=>e(Object(o.logAction)(Object(d.clearSearchFilterSolutionCheckerResult)({environmentId:t}),i.SolutionCheckerViewResultsListClearSearchBoxEvents.eventName))}}),v=(e,t,n)=>{var r=Object(h.currentEnvironmentIdSelector)(n);return{items:Object(l.getSolutionCheckerViewResultsSpecificCommands)({environmentId:r,solution:e.solution,props:t.solutionCommands,isSolutionCheckerDownloadStarting:e.isSelectedSolutionCheckerDownloadStarting,isSolutionCheckerStatusLoading:e.isSolutionCheckerStatusLoading}),farItems:Object(l.getSolutionCheckerViewResultRightCommands)({props:t.solutionCommands,environmentId:r,groupingOptions:e.groupingOptions,isFilterApplied:e.isFilterApplied}),isSearchBoxVisible:!0,searchBoxProps:f(f({},Object(m.getSearchBoxProps)(e=>t.solutionCommands.onSolutionCheckerResultsSearch(e,r))),{},{onClear:e=>{t.solutionCommands.onSolutionCheckerResultsClearSearch(r)},onEscape:e=>{t.solutionCommands.onSolutionCheckerResultsClearSearch(r)}})}},w=Object(g.withRootProps)(Object(r.connect)(S,C,v)(s.CommandBarWithSearchBox))},7960:function(e,t,n){"use strict";n.r(t),n.d(t,"generateSolutionCheckerResultsItems",(function(){return g})),n.d(t,"getLocalizedMessageFromRule",(function(){return h})),n.d(t,"mapStateToProps",(function(){return f})),n.d(t,"mapDispatchToProps",(function(){return y})),n.d(t,"mergeProps",(function(){return S})),n.d(t,"SolutionCheckerResultsListContainer",(function(){return C}));var r=n(5437),o=n(5487),a=n(6597),i=n(5629),s=n(2880),l=n(6603),c=n(6602),p=n(5582),u=n(5687),d=n(7961),m=n(5669);function g(e,t){return e.map(e=>{var n=function(e,t){return t.find(t=>!!(t&&t.code&&e.msdyn_ruleid)&&t.code.toUpperCase().trim()===e.msdyn_ruleid.toUpperCase().trim())}(e,t);return{location:Object(a.getSolutionCheckerResultPropertyValueAsString)("msdyn_fileuri",e),issue:e.msdyn_ruleid,severity:Object(a.getSolutionCheckerSeverityText)(e.msdyn_severity),componentType:Object(a.getSolutionCheckerComponentTypeText)(e.msdyn_componenttype),category:Object(a.getSolutionCheckerCategoryText)(e.msdyn_category),statement:b(e,n),analysisDetail:e,solutionCheckerRule:n}})}var h=(e,t)=>{if(!(t&&t.messageTemplates&&e&&e.msdyn_messagearguments))return e.msdyn_message||null;var n=t.messageTemplates.find(t=>t.ruleId===e.msdyn_ruleid&&t.messageTemplateId===e.msdyn_messageid);if(!n||!n.messageTemplate)return e.msdyn_message||null;var r=JSON.parse(e.msdyn_messagearguments);return Object(s.formatResourceString)(n.messageTemplate,...r)};function b(e,t){return h(e,t)}var f=(e,t)=>{var n=Object(p.currentEnvironmentIdSelector)(t),r=g(c.solutionCheckerResultsListSelector(e,n),c.solutionCheckerRulesSelector(e,n));return{loadProgress:[Object(i.toLoadingState)(!!r)],resultsItems:r,resultsGroups:c.solutionCheckerGroupsSelector(e,n),logEvent:u.SolutionCheckerViewResultsListLoadEvents,groupingOption:c.solutionCheckerResultsGroupOptionsSelector(e,n),environmentId:n}},y=e=>({dispatchTelemetry:e,onPanelOpen:t=>e(Object(l.openSolutionCheckerResultDetailPanel)({solutionCheckerResult:t})),onItemInvoked:(t,n,r)=>{e(Object(l.openSolutionCheckerResultDetailPanel)({solutionCheckerResult:t}))},orderSolutionCheckerResultsList:(t,n)=>e(Object(l.orderSolutionCheckerResultsClientSide)({orderBy:t,environmentId:n}))}),S=(e,t,n)=>({resultsItems:e.resultsItems,resultsGroups:e.resultsGroups,loadProgress:e.loadProgress,logEvent:e.logEvent,groupingOption:e.groupingOption,dispatchTelemetry:t.dispatchTelemetry,onPanelOpen:t.onPanelOpen,onItemInvoked:t.onItemInvoked,orderSolutionCheckerResultsList:t.orderSolutionCheckerResultsList,environmentId:e.environmentId}),C=Object(o.withRootProps)(Object(r.connect)(f,y,S)(Object(i.withLoadTelemetry)(d.SolutionCheckerResultsList,m.LoadScenarioNames.SolutionCheckerResultsList)))},7961:function(e,t,n){"use strict";n.r(t),n.d(t,"SolutionCheckerResultsList",(function(){return f}));var r=n(3064),o=n(719),a=n(777),i=n(1471),s=n(545),l=n(245),c=n(5629),p=n(2869),u=n(6598),d=n(6597);function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){h(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var b=Object(o.mergeStyleSets)({spanColumnItem:{width:"100%",height:"100%"}});class f extends l.Component{static getDerivedStateFromProps(e,t){return t.unCollapsedGroups&&t.unCollapsedGroups.length>0&&Object(d.setUnCollapsedGroups)(e.resultsGroups,t.unCollapsedGroups),e}constructor(e){super(e),this.resources=void 0,this.columns=void 0,this.selection=void 0,this.onColumnHeaderClick=(e,t)=>{if(t)if(t.columnActionsMode===i.ColumnActionsMode.hasDropdown){var n={items:[{key:t.sortLabels?t.sortLabels.ascending:t.columnMenuItems[0].key,name:t.sortLabels?t.sortLabels.ascending:t.columnMenuItems[0].text,onClick:()=>{this.onColumnMenuItemsClick({column:t.key,order:"asc"}),this.handleColumnMenuSort(!1,t)},canCheck:!0,isChecked:t.isSorted&&!t.isSortedDescending},{key:t.sortLabels?t.sortLabels.descending:t.columnMenuItems[1].key,name:t.sortLabels?t.sortLabels.descending:t.columnMenuItems[1].text,onClick:()=>{this.onColumnMenuItemsClick({column:t.key,order:"desc"}),this.handleColumnMenuSort(!0,t)},canCheck:!0,isChecked:t.isSorted&&t.isSortedDescending}],target:e.currentTarget,directionalHint:a.DirectionalHint.bottomLeftEdge,gapSpace:0,isBeakVisible:!0,onDismiss:this.hideColumnMenu};this.setState({columnMenuProps:n})}else t.columnActionsMode===i.ColumnActionsMode.clickable&&(t.isSorted&&(t.isSortedDescending=!t.isSortedDescending),t.isSorted=!0,this.setState({sortedColumn:t}))},this.handleColumnMenuSort=(e,t)=>{t.isSortedDescending=e,t.isSorted=!0,this.setState({sortedColumn:t})},this.hideColumnMenu=()=>{this.setState({columnMenuProps:void 0})},this.resources=Object(p.getResources)(),this.state={orderBy:void 0,columnMenuProps:void 0,unCollapsedGroups:[]},this.columns=this.buildColumns(this.props.groupingOption),this.selection=new s.Selection({onSelectionChanged:()=>{if(this.selection.getSelectedCount()>0){var e=this.selection.getSelection()[0];this.props.onPanelOpen(e)}}})}componentDidUpdate(e){var t=[];Object(d.getUnCollapsedGroups)(this.props.resultsGroups,t),this.props.groupingOption!==e.groupingOption?(this.setState({sortedColumn:void 0,orderBy:void 0,columnMenuProps:void 0,unCollapsedGroups:t}),this.columns=this.buildColumns(this.props.groupingOption)):this.compareGroups(t,this.state.unCollapsedGroups)||this.setState({unCollapsedGroups:t})}render(){var e,t=this.setSortedStatusOnColumns(this.columns);return e=l.createElement(r.DetailsList,{onColumnHeaderClick:this.onColumnHeaderClick,isLoading:Object(c.isLoading)(this.props.loadProgress),items:this.props.resultsItems,groups:this.props.resultsGroups,columns:t,setKey:"solution-checker-results-set",selectionMode:s.SelectionMode.single,constrainMode:i.ConstrainMode.unconstrained,layoutMode:i.DetailsListLayoutMode.justified,ariaLabel:this.resources.Model.Solutions.ListPage.pageTitle,onItemInvoked:this.props.onItemInvoked,selection:this.selection}),l.createElement("div",null,l.createElement("div",null,e),this.state.columnMenuProps&&l.createElement(a.ContextualMenu,this.state.columnMenuProps))}buildColumns(e){var t=[],n=g(g({key:"msdyn_fileuri",name:this.resources.Model.Solutions.SolutionCheckerResults.List.Header.location,fieldName:"location",minWidth:160,maxWidth:220,isResizable:!0,isCollapsible:!0,isMultiline:!1,isPadded:!0,isSorted:void 0!==this.state.orderBy&&"msdyn_fileuri"===this.state.orderBy.column},this.getColumnSortProperties()),{},{onRender:(e,t,n)=>this.renderColumnItem(e,"location")}),r=g(g({key:"msdyn_ruleid",name:this.resources.Model.Solutions.SolutionCheckerResults.List.Header.issue,fieldName:"issue",minWidth:160,maxWidth:220,isResizable:!0,isCollapsible:!0,isMultiline:!1,isPadded:!0,isSorted:void 0!==this.state.orderBy&&"msdyn_ruleid"===this.state.orderBy.column},this.getColumnSortProperties()),{},{onRender:(e,t,n)=>this.renderColumnItem(e,"issue")}),o=g(g({key:"msdyn_severity",name:this.resources.Model.Solutions.SolutionCheckerResults.List.Header.severity,fieldName:"severity",minWidth:60,maxWidth:80,isResizable:!0,isCollapsible:!0,isPadded:!0,isMultiline:!1,isSorted:void 0!==this.state.orderBy&&"msdyn_severity"===this.state.orderBy.column},this.getColumnSortProperties()),{},{onRender:(e,t,n)=>this.renderColumnItem(e,"severity")});return e!==u.SolutionCheckerResultsGroupingOptions.ByLocation&&t.push(n),e!==u.SolutionCheckerResultsGroupingOptions.ByIssue&&t.push(r),e!==u.SolutionCheckerResultsGroupingOptions.BySeverity&&t.push(o),t.push(g(g({key:"msdyn_category",name:this.resources.Model.Solutions.SolutionCheckerResults.List.Header.category,fieldName:"category",minWidth:80,maxWidth:120,isResizable:!0,isCollapsible:!0,isPadded:!0,isMultiline:!1,isSorted:void 0!==this.state.orderBy&&"msdyn_category"===this.state.orderBy.column},this.getColumnSortProperties()),{},{onRender:(e,t,n)=>this.renderColumnItem(e,"category")}),g(g({key:"msdyn_componenttype",name:this.resources.Model.Solutions.SolutionCheckerResults.List.Header.component,fieldName:"componentType",minWidth:80,maxWidth:100,isResizable:!0,isCollapsible:!0,isPadded:!0,isMultiline:!1,isSorted:void 0!==this.state.orderBy&&"msdyn_componenttype"===this.state.orderBy.column},this.getColumnSortProperties()),{},{onRender:(e,t,n)=>this.renderColumnItem(e,"componentType")}),g(g({key:"msdyn_message",name:this.resources.Model.Solutions.SolutionCheckerResults.List.Header.statement,fieldName:"statement",minWidth:160,maxWidth:240,isResizable:!0,isCollapsible:!0,isPadded:!0,isMultiline:!1,isSorted:void 0!==this.state.orderBy&&"msdyn_message"===this.state.orderBy.column},this.getColumnSortProperties()),{},{onRender:(e,t,n)=>this.renderColumnItem(e,"statement")})),t}setSortedStatusOnColumns(e){return e&&e.map(e=>(this.state.sortedColumn?(e.isSorted=e.key===this.state.sortedColumn.key,e.isSorted&&(e.isSortedDescending=this.state.sortedColumn.isSortedDescending)):e.isSorted=!1,e))}getColumnSortProperties(){return{columnActionsMode:i.ColumnActionsMode.hasDropdown,sortLabels:{ascending:this.resources.Model.Solutions.Components.Header.ascending,descending:this.resources.Model.Solutions.Components.Header.descending}}}renderColumnItem(e,t){return l.createElement("span",{className:b.spanColumnItem},e[t])}onColumnMenuItemsClick(e){this.props.orderSolutionCheckerResultsList(e,this.props.environmentId),this.setState({orderBy:e})}compareGroups(e,t){return!e&&!t||!(!e||!t||e.length!==t.length)&&e.every(e=>t.indexOf(e)>-1)}}},7962:function(e,t,n){"use strict";n.r(t),n.d(t,"getSolutionId",(function(){return L})),n.d(t,"mapStateToProps",(function(){return T})),n.d(t,"mapDispatchToProps",(function(){return k})),n.d(t,"mergeProps",(function(){return R})),n.d(t,"SolutionComponentsListPageContainer",(function(){return D}));var r=n(5691),o=n(5629),a=n(5690),i=n(5583),s=n(5487),l=n(5686),c=n(5810),p=n(5669),u=n(5478),d=n(5766),m=n(7963),g=n(5687),h=n(5767),b=n(6470),f=n(5437),y=n(5468),S=n(5787),C=n(5623),v=n(5746),w=["onHeaderClickNavigate","searchDispatch"];function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function P(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach((function(t){E(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function E(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function A(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function j(){return(j=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function L(e){return(e&&e.match&&e.match.params&&e.match.params.solutionId).toLocaleLowerCase()||""}function T(e,t){var n=t.rootProps.currentEnvironment,a=n&&n.id,i=L(t)||"",s=r.solutionSelector(e,i),l=S.solutionComponentSelectors.solutionComponentListErrorsSelector(e,i,a),p=r.publishCustomizationsStatus(e),u=Object(b.apiCallResponseSelector)(e,d.SolutionComponentApiCalls.PublishComponents),m=r.exportSolutionStatus(e),h=Object(b.apiCallResponseSelector)(e,d.SolutionComponentApiCalls.RibbonCustomization),f=Object(c.deleteComponentsStatus)(e),y=r.cloneSolutionStatus(e),C=r.patchSolutionStatus(e),w=Object(c.shouldShowMissingCreateEntityPrivilegeNotification)(e),O=Object(c.shouldShowMissingCreateOptionSetPrivilegeNotification)(e);return{solution:s,solutionId:i,logEvent:g.SolutionComponentsPageLoadEvents,loadProgress:[Object(o.toLoadingState)(!!s,l)],publishCustomizationsResponse:p,publishComponentsResponse:u,removeComponentsResponse:Object(c.removeComponentsStatus)(e),errorMessage:l,exportSolutionResponse:m,activateResponse:Object(b.apiCallResponseSelector)(e,d.SolutionComponentApiCalls.Activate),deactivateResponse:Object(b.apiCallResponseSelector)(e,d.SolutionComponentApiCalls.Deactivate),deleteComponentsResponse:f,addRequiredComponentResponse:Object(b.apiCallResponseSelector)(e,d.SolutionComponentApiCalls.AddRequiredComponents),deleteSolutionResponse:r.deleteSolutionStatus(e),ribbonCustomizationResponse:h,cloneSolutionResponse:y,patchSolutionResponse:C,exportTranslationResponse:r.exportTranslationsStatus(e),missingPrivilegeNotifications:{createEntity:w,createOptionSet:O},publishTeamsAppSuccessMessage:v.solutionsSelectors.publishTeamsAppSuccessMessageSelector(e),solutionAsyncExportJobs:v.solutionsSelectors.solutionExportJobsSelector(e)}}var k=(e,t)=>({onHeaderClickNavigate:e=>{t.navigate(e,!0)},onMount:()=>{e(Object(a.fetchSolutionsRequest)()),e(Object(a.fetchSolutionActions)()),e(Object(l.fetchSolutionComponentActions)()),e(Object(a.fetchUserPrivileges)()),e(Object(a.fetchAsyncSolutionJobsFromLocalStorage)()),e(Object(a.solutionAsyncOperationPollProgress)())},onDismount:()=>{e(Object(a.fetchSolutionsCancelPoll)()),e(Object(h.apiCallClear)(d.SolutionComponentApiCalls.PublishComponents,d.SolutionComponentApiCalls.Activate,d.SolutionComponentApiCalls.Deactivate,d.SolutionComponentApiCalls.AddRequiredComponents)),e(Object(a.publishAllCustomizationsClear)()),e(Object(l.removeComponentsClear)()),e(Object(l.deleteComponentsClear)()),e(Object(a.deleteSolutionClear)()),e(Object(a.exportSolutionClear)()),e(Object(a.cloneSolutionClear)()),e(Object(a.patchSolutionClear)()),e(Object(a.exportTranslationsSolutionClear)()),e(Object(l.missingCreateEntityPrivilegeNotificationClear)()),e(Object(l.missingCreateOptionSetPrivilegeNotificationClear)()),e(y.sharedActions.panelClose({panelType:u.PanelToShowType.SolutionExportPanel})),e(Object(a.fetchSolutionsCancelPoll)()),e(Object(a.solutionAsyncOperationCancelPollProgress)())},setCurrentSolutionComponentFilter:(t,n,r)=>e(Object(l.setCurrentSolutionFilter)({solutionId:t,componentTypes:n,searchFilter:r})),dispatchTelemetry:e,clearPublishComponentMessage:()=>e(Object(h.apiCallClear)(d.SolutionComponentApiCalls.PublishComponents)),clearPublishCustomizationMessage:()=>e(Object(a.publishAllCustomizationsClear)()),clearRemoveComponentsResponseMessage:()=>{e(Object(l.removeComponentsClear)())},clearDeleteComponentsResponseMessage:()=>{e(Object(l.deleteComponentsClear)())},clearDeleteSolutionResponseMessage:()=>{e(Object(a.deleteSolutionClear)())},searchDispatch:(t,n)=>e(Object(l.searchSolutionComponents)({solutionId:t,searchFilter:n})),clearExportSolutionResponse:()=>{e(Object(a.exportSolutionClear)())},clearRibbonCustomizationResponse:()=>e(Object(h.apiCallClear)(d.SolutionComponentApiCalls.RibbonCustomization)),clearCloneSolutionResponse:()=>e(Object(a.cloneSolutionClear)()),clearPatchSolutionResponse:()=>e(Object(a.patchSolutionClear)()),clearExportTranslationResponse:()=>{e(Object(a.exportTranslationsSolutionClear)())},clearMissingPrivilegeNotifications:{createEntity:()=>e(Object(l.missingCreateEntityPrivilegeNotificationClear)()),createOptionSet:()=>e(Object(l.missingCreateOptionSetPrivilegeNotificationClear)())},clearPublishTeamsAppSuccessMessage:()=>{e(v.solutionsActions.clearPublishTeamsAppSuccessMessage())},clearSolutionAsyncJob:t=>{e(v.solutionsActions.solutionAsyncJobClear({asyncOperationId:t}))}}),R=(e,t,n)=>{var r=j({},e),{onHeaderClickNavigate:o,searchDispatch:a}=t,i=A(t,w),{areShellProvidersReady:s,currentEnvironment:l}=n.rootProps;return P(P(P({onHeaderClick:()=>{o(C.solutionListRoute.canvas)},performServerSideSearch:e=>a(r.solution.id,e)},r),i),{},{areShellProvidersReady:s,currentEnvironment:l})},D=Object(i.withNavigation)(Object(s.withRootProps)(Object(f.connect)(T,k,R)(Object(o.withLoadTelemetry)(m.SolutionComponentsListPageAdapter,p.LoadScenarioNames.SolutionComponentsListPage))))},7963:function(e,t,n){"use strict";n.r(t),n.d(t,"SolutionComponentsListPageAdapterInternal",(function(){return h})),n.d(t,"SolutionComponentsListPageAdapter",(function(){return b}));var r=n(5622),o=n(7964),a=n(3076),i=n(922),s=n(245),l=n.n(s),c=n(6471),p=n(2871),u=n(7979),d=n(5593),m=n(5687);function g(){return(g=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var h=e=>{var t,{environmentClient:n}=Object(s.useContext)(a.ApolloClientContext),{fcbs:i}=Object(u.useCdsPlatformFCBs)(n,["FCB.SolutionSimplification.Maker"],d.PortalScope,e.t("Common.Request.Failed")),h=!p.featureGates.enableDataflowInSolutionExperience||!r.isDataflowsExperienceEnabledOnEnvironment(e.currentEnvironment),{errorMessage:b,customComponentDefinitions:f}=Object(c.useSolutionCustomComponentTypesDefinition)(n,e.t("Common.Request.Failed"),h),y=i.get("FCB.SolutionSimplification.Maker");return Object(s.useEffect)(()=>{(f||b)&&y&&Object(d.trackInfoTrace)(m.SolutionCustomComponentDefinitionsWithFCBLoadEvent.eventName,{definitions:f,error:b,featureGate:p.featureGates.enableCustomSolutionComponents,fcb:y})},[f,b,y]),(p.featureGates.enableCustomSolutionComponents||y&&y.value)&&(t={customComponentDefinitions:f,customComponentDefinitionsError:b}),l.a.createElement(o.SolutionComponentsListPage,g({},e,t))},b=Object(i.translateService)("PowerappsPortal")(h)},7964:function(e,t,n){"use strict";n.r(t),n.d(t,"SolutionComponentsListPage",(function(){return M}));var r=n(4792),o=n(4105),a=n(1697),i=n(1201),s=n(245),l=n(303),c=n(1200),p=n(7965),u=n(2886),d=n(5607),m=n(7968),g=n(5629),h=n(2879),b=n(3831),f=n(2869),y=n(2880),S=n(5623),C=n(7971),v=n(5627),w=n(7972),O=n(7973),P=n(7648),E=n(7974),A=n(5766),j=n(7975),L=n(3713),T=n(2884),k=n(7977),R=n(7978),D=[];class M extends s.Component{constructor(e){super(e),this.breadCrumbItems=void 0,this.resources=void 0,this.state={currentSelectedItems:[],searchFilter:"",componentTypes:null},this.resources=Object(f.getResources)()}componentDidMount(){this.props.onMount(),this.props.setCurrentSolutionComponentFilter(this.props.solutionId,this.state.componentTypes,this.state.searchFilter)}componentWillUnmount(){this.props.onDismount()}onComponentTypeSelect(e){this.setState({componentTypes:e}),this.props.setCurrentSolutionComponentFilter(this.props.solutionId,e,this.state.searchFilter)}render(){if(!this.props.areShellProvidersReady)return s.createElement(c.PagePlaceholder,null);this.initializeBreadCrumbItem(this.props.solution);var e={fromPattern:b.RoutePaths.model.solutionComponentsList,toPattern:b.RoutePaths.model.solutionsList,toFriendlyRouteName:b.FriendlyRouteNames.modelSolutions},t=Object(S.getSolutionListRouteWithEnvironment)(this.props.currentEnvironment.name);if(this.props.deleteSolutionResponse&&this.props.deleteSolutionResponse.success)return s.createElement(l.Redirect,{push:!0,to:{pathname:t,state:e}});if(Object(g.isLoading)(this.props.loadProgress))return s.createElement("div",{className:"solution-components-list-page"},s.createElement("div",{className:"solution-components-list-page-spinner"},s.createElement(i.Spinner,{size:i.SpinnerSize.large})));var n="";if(this.props.publishCustomizationsResponse&&!this.props.publishCustomizationsResponse.originatedFromPanel&&this.props.publishCustomizationsResponse.loading)n=this.resources.Model.Solutions.PublishAllCustomizations.inProgressMessage;else if(this.props.removeComponentsResponse&&this.props.removeComponentsResponse.loading)n=this.resources.Model.Solutions.Components.RemoveComponents.inProgressMessage;else if(this.props.publishComponentsResponse.loading){var C,D=(null===(C=this.state.currentSelectedItems)||void 0===C?void 0:C.map(e=>e.component))||[];n=Object(d.areComponentsOfSameType)(D)?Object(y.formatResourceString)(this.resources.Model.Solutions.Components.PublishCustomizations.inProgressMessage,Object(d.getSolutionComponentTypeDisplayName)(D[0],Object(L.isCdsLiteContext)(this.props.currentEnvironment))):this.resources.Model.Solutions.Components.PublishCustomizations.inProgressDiffTypesMessage}else this.props.activateResponse&&this.props.activateResponse.loading?n=this.resources.Model.Solutions.Components.ActivateComponent.inProgressMessage:this.props.deactivateResponse&&this.props.deactivateResponse.loading?n=this.resources.Model.Solutions.Components.DeactivateComponent.inProgressMessage:this.props.deleteComponentsResponse.loading&&!this.props.deleteComponentsResponse.shouldNotShowInList?n=Object(f.getResources)().Model.Solutions.Components.DeleteComponents.inProgressMessage:this.props.addRequiredComponentResponse&&this.props.addRequiredComponentResponse.loading?n=this.resources.Model.Solutions.Components.AddRequired.Message.inProgressMessage:this.props.deleteSolutionResponse&&this.props.deleteSolutionResponse.loading?n=this.resources.Model.Solutions.Delete.inProgressMessage:this.props.ribbonCustomizationResponse&&this.props.ribbonCustomizationResponse.loading?n=this.resources.Model.Solutions.Components.ApplicationRibbon.inProgressMessage:this.props.exportTranslationResponse.loading?n=this.resources.Model.Solutions.ExportTranslations.inProgressMessage:this.props.deleteComponentsResponse.loading&&!this.props.deleteComponentsResponse.shouldNotShowInList?n=Object(f.getResources)().Model.Solutions.Components.DeleteComponents.inProgressMessage:this.props.addRequiredComponentResponse&&this.props.addRequiredComponentResponse.loading?n=this.resources.Model.Solutions.Components.AddRequired.Message.inProgressMessage:this.props.deleteSolutionResponse&&this.props.deleteSolutionResponse.loading?n=this.resources.Model.Solutions.Delete.inProgressMessage:this.props.ribbonCustomizationResponse&&this.props.ribbonCustomizationResponse.loading?n=this.resources.Model.Solutions.Components.ApplicationRibbon.inProgressMessage:this.props.exportTranslationResponse.loading&&(n=this.resources.Model.Solutions.ExportTranslations.inProgressMessage);return s.createElement(r.Page,{className:"solution-components-list-page",spinnerProps:{label:n},showOverlay:this.props.publishCustomizationsResponse&&!this.props.publishCustomizationsResponse.originatedFromPanel&&this.props.publishCustomizationsResponse.loading||this.props.publishComponentsResponse&&this.props.publishComponentsResponse.loading||this.props.removeComponentsResponse&&this.props.removeComponentsResponse.loading&&!this.props.removeComponentsResponse.shouldNotShowInList||this.props.activateResponse&&this.props.activateResponse.loading||this.props.deactivateResponse&&this.props.deactivateResponse.loading||this.props.deleteComponentsResponse&&this.props.deleteComponentsResponse.loading&&!this.props.deleteComponentsResponse.shouldNotShowInList||this.props.addRequiredComponentResponse&&this.props.addRequiredComponentResponse.loading||this.props.deleteSolutionResponse&&this.props.deleteSolutionResponse.loading||this.props.ribbonCustomizationResponse&&this.props.ribbonCustomizationResponse.loading||this.props.exportTranslationResponse&&this.props.exportTranslationResponse.loading,renderHeader:()=>{var e;return s.createElement(s.Fragment,null,s.createElement(w.SolutionComponentsListCommandBarContainer,{solution:this.props.solution,currentSelectedItems:(null===(e=this.state.currentSelectedItems)||void 0===e?void 0:e.map(e=>e.component))||[],onSearchFilterUpdate:this.onSearchFilterUpdate.bind(this),componentTypes:this.state.componentTypes,onComponentTypeSelect:this.onComponentTypeSelect.bind(this),customComponentDefinitions:this.getCustomComponentDefinitions()}))},renderMessageBar:()=>s.createElement(s.Fragment,null,s.createElement(P.UpdateEnvVarValuesMessageBarContainer,null),s.createElement(R.FlowUpdatesMessageBarContainer,null),Object(u.isSolutionManaged)(this.props.solution)&&s.createElement(a.MessageBar,{messageBarType:a.MessageBarType.warning,isMultiline:!0,dismissButtonAriaLabel:h.fabricIcons.Info},this.resources.Model.Solutions.ManagedSolution.LockDown.warningMessage),this.toggleExportMessageBar(),!this.props.publishCustomizationsResponse.originatedFromPanel&&this.props.publishCustomizationsResponse.message&&s.createElement(a.MessageBar,{messageBarType:this.props.publishCustomizationsResponse.success?a.MessageBarType.success:a.MessageBarType.error,isMultiline:!1,dismissButtonAriaLabel:h.fabricIcons.Cancel,onDismiss:this.props.clearPublishCustomizationMessage},this.props.publishCustomizationsResponse.message),this.props.removeComponentsResponse.message&&!this.props.removeComponentsResponse.shouldNotShowInList&&s.createElement(a.MessageBar,{messageBarType:this.props.removeComponentsResponse.success?a.MessageBarType.success:a.MessageBarType.error,isMultiline:!1,dismissButtonAriaLabel:h.fabricIcons.Cancel,onDismiss:this.props.clearRemoveComponentsResponseMessage},this.props.removeComponentsResponse.message),this.props.deleteComponentsResponse.message&&!this.props.deleteComponentsResponse.shouldNotShowInList&&s.createElement(a.MessageBar,{messageBarType:this.props.deleteComponentsResponse.success?a.MessageBarType.success:a.MessageBarType.error,isMultiline:!1,dismissButtonAriaLabel:h.fabricIcons.Cancel,onDismiss:this.props.clearDeleteComponentsResponseMessage},this.props.deleteComponentsResponse.message),this.props.deleteSolutionResponse.message&&!this.props.deleteSolutionResponse.success&&s.createElement(a.MessageBar,{messageBarType:a.MessageBarType.success,isMultiline:!1,dismissButtonAriaLabel:h.fabricIcons.Cancel,onDismiss:this.props.clearCloneSolutionResponse},this.props.cloneSolutionResponse.message),this.props.patchSolutionResponse&&this.props.patchSolutionResponse.success&&this.props.patchSolutionResponse.message&&s.createElement(a.MessageBar,{messageBarType:a.MessageBarType.success,isMultiline:!1,dismissButtonAriaLabel:h.fabricIcons.Cancel,onDismiss:this.props.clearPatchSolutionResponse},this.props.patchSolutionResponse.message),!Object(u.isSolutionManaged)(this.props.solution)&&Object(u.isSolutionAParentWithPatches)(this.props.solution)&&s.createElement(a.MessageBar,{messageBarType:a.MessageBarType.warning,isMultiline:!0,dismissButtonAriaLabel:h.fabricIcons.Info},this.resources.Model.Solutions.PatchedSolution.LockDown.warningMessage),this.props.exportTranslationResponse.message&&s.createElement(a.MessageBar,{messageBarType:this.props.exportTranslationResponse.success?a.MessageBarType.success:a.MessageBarType.error,isMultiline:!1,dismissButtonAriaLabel:h.fabricIcons.Cancel,onDismiss:this.props.clearExportTranslationResponse},this.props.exportTranslationResponse.message),this.props.missingPrivilegeNotifications.createEntity&&s.createElement(a.MessageBar,{messageBarType:a.MessageBarType.warning,isMultiline:!1,dismissButtonAriaLabel:h.fabricIcons.Cancel,onDismiss:this.props.clearMissingPrivilegeNotifications.createEntity},Object(f.getResources)().DataversePortal.Privileges.missingCreateEntitiesPrivilege),this.props.missingPrivilegeNotifications.createOptionSet&&s.createElement(a.MessageBar,{messageBarType:a.MessageBarType.warning,isMultiline:!1,dismissButtonAriaLabel:h.fabricIcons.Cancel,onDismiss:this.props.clearMissingPrivilegeNotifications.createOptionSet},Object(f.getResources)().DataversePortal.Privileges.missingCreateOptionSetsPrivilege),this.props.solutionAsyncExportJobs&&s.createElement(T.SolutionsListExportMessage,{environmentId:this.props.currentEnvironment.id,solutionExportJobs:this.props.solutionAsyncExportJobs,clearSolutionExportJob:this.props.clearSolutionAsyncJob}),s.createElement(p.ApiCallResponseMessageBarContainer,{apiCallsToShow:[A.SolutionComponentApiCalls.RibbonCustomization,A.SolutionComponentApiCalls.PublishComponents,A.SolutionComponentApiCalls.Activate,A.SolutionComponentApiCalls.Deactivate,A.SolutionComponentApiCalls.AddRequiredComponents]}),this.props.publishTeamsAppSuccessMessage&&s.createElement(j.PublishTeamsAppSuccessMessage,{publishTeamsAppSuccessMessage:this.props.publishTeamsAppSuccessMessage,labels:this.resources.Model.Solutions.PublishTeamsAppPanel.ComponentsAndRoles.Publish,clearPublishTeamsAppSuccessMessage:this.props.clearPublishTeamsAppSuccessMessage})),renderTitle:()=>s.createElement(o.PageHeader,{wrapperClassName:"solution-components-list-page-breadcrumb",titleBreadcrumbProps:{items:this.breadCrumbItems,ariaLabel:this.resources.Apps.AppManagement.Breadcrumbs.apps}}),renderBody:()=>s.createElement(s.Fragment,null,s.createElement("div",{className:O.solutionComponentListPageStyles["solution-components-list-page-listcontainer"]},s.createElement(E.SolutionComponentsListContainer,{solution:this.props.solution,searchFilter:this.state.searchFilter,columnOptions:{showContextMenuColumn:!0,showLinksForNameColumn:!0},componentTypes:this.state.componentTypes,solutionAwareness:v.SolutionAwareness.InSolution,customComponentDefinitions:this.props.customComponentDefinitions,currentSelectedItems:this.state.currentSelectedItems,updateComponentsListItemsSelected:e=>{this.setState({currentSelectedItems:e})}})),s.createElement(m.OptionSetProviderContainer,{solution:this.props.solution}),s.createElement(k.CreateAppInSolutionModal,null))})}onSearchFilterUpdate(e){this.setState({searchFilter:e}),this.props.setCurrentSolutionComponentFilter(this.props.solutionId,this.state.componentTypes,e)}toggleExportMessageBar(){var e,{failed:t,success:n,message:r}=this.props.exportSolutionResponse;return t||n?(e={truncated:t,styles:n&&C.solutionListPanelStyles.solutionExportPanelMessageStyles,messageBarType:n?a.MessageBarType.success:a.MessageBarType.error,onDismiss:this.props.clearExportSolutionResponse},s.createElement(a.MessageBar,e,r)):null}getCustomComponentDefinitions(){return this.props.customComponentDefinitions||D}initializeBreadCrumbItem(e){this.breadCrumbItems=[],this.breadCrumbItems.push({text:this.resources.Model.Solutions.ListPage.pageTitle,key:this.resources.Model.Solutions.ListPage.pageTitle,onClick:()=>{this.props.onHeaderClick()}}),this.breadCrumbItems.push({text:Object(u.getSolutionDisplayName)(e),key:Object(u.getSolutionId)(e)})}}},7965:function(e,t,n){"use strict";n.r(t),n.d(t,"mapStateAndParentPropsToProps",(function(){return d})),n.d(t,"mapDispatchToProps",(function(){return m})),n.d(t,"mergeProps",(function(){return g})),n.d(t,"ApiCallResponseMessageBarContainer",(function(){return h}));var r=n(5437),o=n(5767),a=n(6470),i=n(7966),s=n(7967),l=n(5593);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var d=(e,t)=>{var n=new Map;for(var r of t.apiCallsToShow)n.set(r,Object(a.apiCallResponseSelector)(e,r));return{responses:n}},m=e=>({onDismiss:function(){Object(l.trackUserActionClickButton)(s.ApiCallResponseMessageBarEvents.MessageBarDismissed.eventName),e(Object(o.apiCallClear)(...arguments))}}),g=(e,t,n)=>p(p(p({},e),t),n),h=Object(r.connect)(d,m,g)(i.ApiCallResponseMessageBar)},7966:function(e,t,n){"use strict";n.r(t),n.d(t,"ApiCallResponseMessageBar",(function(){return i}));var r=n(245),o=n(1697),a=n(2879);class i extends r.Component{constructor(e){super(e),this.props=e}componentWillUnmount(){this.props.onDismiss(...this.props.apiCallsToShow)}render(){var e=[];for(var[t,n]of this.props.responses)e.push(this.renderIndividualMessageBar(t,n));return r.createElement("div",null," ",e," ")}renderIndividualMessageBar(e,t){return t.succeeded||t.failed?r.createElement(o.MessageBar,{messageBarType:t.succeeded?o.MessageBarType.success:o.MessageBarType.error,isMultiline:!1,dismissButtonAriaLabel:a.fabricIcons.Cancel,onDismiss:()=>this.props.onDismiss(e)},t.message):null}}},7967:function(e,t,n){"use strict";n.r(t),n.d(t,"ApiCallResponseMessageBarEvents",(function(){return r}));var r={MessageBarDismissed:{eventName:"ApiCallResponseMessageBar.Dismissed"}}},7968:function(e,t,n){"use strict";n.r(t),n.d(t,"mapStateToProps",(function(){return y})),n.d(t,"mapDispatchToProps",(function(){return S})),n.d(t,"mergeProps",(function(){return C})),n.d(t,"OptionSetProviderContainer",(function(){return v}));var r=n(5437),o=n(5687),a=n(5787),i=n(5686),s=n(5630),l=n(5629),c=n(7969),p=n(7970),u=n(5487),d=n(5582),m=n(5669),g=n(5691);function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){f(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function y(e,t){var n,r,i,s=Object(d.currentEnvironmentIdSelector)(t),c=Object(g.safePrivilegeResultSelector)(e,s,"prvWriteOptionSet"),p=a.solutionComponentSelectors.solutionComponentListErrorsSelector(e,t.solution.id,s),u=e.solutionComponents.optionSetDesignerResponse;return u&&(n=u.optionSet,r=u.context,i=u.error),{solution:t.solution,loadProgress:[Object(l.toLoadingState)(!!t.solution,p)],logEvent:o.SolutionComponentsPageLoadEvents,optionSet:n,context:r,error:i,hasUpdateOptionSetPrivilege:c}}var S=e=>({dispatchTelemetry:e,updateOptionSet:(t,n,r,o,a)=>e(Object(s.logAction)(Object(i.updateOptionSetRequest)({solutionName:t,solutionId:n,diff:r,optionSetName:o,updateOptionSet:a}),p.OptionSetDesignerTelemetryEventsMap.EnumerationsUpdate,{})),createOptionSet:(t,n,r)=>e(Object(s.logAction)(Object(i.createOptionSetRequest)({solutionName:t,solutionId:n,optionSet:r}),p.OptionSetDesignerTelemetryEventsMap.EnumerationsCreate)),dismissOptionSetPanel:t=>e(Object(s.logAction)(Object(i.clearOptionSet)({solutionId:t}),p.OptionSetDesignerTelemetryEventsMap.EnumerationDismiss)),clearOptionSetPanelError:()=>e(Object(i.clearOptionSetError)())}),C=(e,t)=>b(b({},e),t),v=Object(u.withRootProps)(Object(r.connect)(y,S,C)(Object(l.withLoadTelemetry)(c.OptionSetProviderWrapper,m.LoadScenarioNames.OptionSetProvider)))},7969:function(e,t,n){"use strict";n.r(t),n.d(t,"OptionSetProviderWrapper",(function(){return a}));var r=n(245),o=n(5823);class a extends r.Component{constructor(e){super(e),this.updateOptionSet=(e,t,n)=>{this.props.updateOptionSet(this.props.solution.uniquename,this.props.solution.id,e,t,n)},this.optionSetDismiss=()=>{this.props.dismissOptionSetPanel(this.props.solution.id)}}render(){return r.createElement("div",null,this.props.context&&this.props.context.optionSetPrefix&&this.props.optionSet&&r.createElement(o.OptionSetProvider,this.optionSetProps()))}optionSetProps(){var{solution:e}=this.props;return{onDismiss:this.optionSetDismiss,onUpdate:this.updateOptionSet,onCreate:this.props.createOptionSet,onClearError:this.props.clearOptionSetPanelError,optionSet:this.props.optionSet,error:this.props.error,environmentNamePrefix:this.props.context.envNamePrefix,optionSetValuePrefix:this.props.context.optionSetPrefix,xrmSolutionId:e.id,environmentId:this.props.context.environmentId,environmentLanguageCode:this.props.context.envLanguageCode,solutionName:e.uniquename,readonly:e.ismanaged,hasUpdateOptionSetsPrivilege:this.props.hasUpdateOptionSetPrivilege,disableOnLoadAnimation:this.props.disableOnLoadAnimation,isLoading:this.props.isLoading}}}},7970:function(e,t,n){"use strict";var r;n.r(t),n.d(t,"OptionSetDesignerTelemetryEventsMap",(function(){return r})),function(e){e.EnumerationsCreate="Enumerations.Create",e.EnumerationsUpdate="Enumerations.Update",e.EnumerationDismiss="Enumerations.Dismiss.Clicked",e.EnumerationsOpen="Enumerations.OpenEnumeration.Clicked",e.EnumerationNew="Enumerations.NewEnumeration.Clicked",e.EnumerationAddMember="Enumerations.AddMember.Clicked",e.EnumerationOpenMember="Enumerations.OpenMember.Clicked",e.EnumerationDeleteMember="Enumerations.DeleteMember.Clicked",e.EnumerationDelete="Enumerations.Delete"}(r||(r={}))},7971:function(e,t,n){"use strict";n.r(t),n.d(t,"errorMessageStyles",(function(){return a})),n.d(t,"solutionListPanelStyles",(function(){return i}));var r=n(719),o=n(2882),a=Object(r.mergeStyleSets)({spans:{display:"block"}}),i={solutionExportPanelMessageStyles:{root:{backgroundColor:o.fabricColors.peppermint},iconContainer:{marginTop:"8px",marginBottom:"8px",marginLeft:"12px",fontSize:"16px",color:o.fabricColors.bilbao},dismissal:{width:"32px",height:"32px",paddingRight:"12px",fontSize:"14px",color:o.fabricColors.neutralChicago},text:{marginTop:"8px",marginBottom:"8px",marginLeft:"8px"},innerText:{padding:"0px",fontFamily:"Segoe UI",lineHeight:"16px",fontSize:"12px",color:o.fabricColors.neutralTuatara}}}},7972:function(e,t,n){"use strict";n.r(t),n.d(t,"mapStateToProps",(function(){return M})),n.d(t,"mapDispatchToProps",(function(){return N})),n.d(t,"mergeProps",(function(){return x})),n.d(t,"SolutionComponentsListCommandBarContainer",(function(){return I}));var r=n(1222),o=n(5437),a=n(5647),i=n(5650),s=n(2886),l=n(5607),c=n(2869),p=n(6607),u=n(5787),d=n(5810),m=n(5691),g=n(5687),h=n(5615),b=n(5635),f=n(5676),y=n(5685),S=n(6615),C=n(5689),v=n(5487),w=n(6617),O=n(5675),P=n(5809),E=n(5604),A=n(5626),j=n(5981),L=n(5583),T=n(5609),k=n(5611),R=n(6616),D=n(860),M=(e,t)=>{var n,r,o=t.rootProps.currentEnvironment,a=o&&o.id;1===(null===(n=t.currentSelectedItems)||void 0===n?void 0:n.length)&&(r=Object(d.getObjectFromSolutionComponent)(e,t.currentSelectedItems[0]));var i,s=!1,c=Object(l.getTypeFromSolutionComponent)(t.currentSelectedItems[0]);1===t.currentSelectedItems.length&&(Object(T.areSameSolutionComponentType)(c,k.StandardSolutionComponentTypes.CanvasApp)||Object(T.areSameSolutionComponentType)(c,k.StandardSolutionComponentTypes.CanvasAppsOnly)||Object(T.areSameSolutionComponentType)(c,k.StandardSolutionComponentTypes.CustomCanvasPage)||Object(T.areSameSolutionComponentType)(c,k.StandardSolutionComponentTypes.ComponentLibrary)?(i={app:r,currentEnvironment:o},s=!!r):Object(T.areSameSolutionComponentType)(c,k.StandardSolutionComponentTypes.AppModule)&&(i={appModule:r}));var p=u.solutionComponentSelectors.objectsBeingChecked(e,a),g=!0;for(var h of t.currentSelectedItems)if(0==Object(l.isComponentInArray)(h,p)){g=!1;break}var f=u.solutionComponentSelectors.objectCheckerRunCompleted(e,t.currentSelectedItems[0]),y=Object(A.allowListFeaturesSelector)(e);return{commands:Object(b.getSolutionComponentCommandBarCommands)({componentsSelected:t.currentSelectedItems,solution:t.solution,commandActions:t.solutionComponentCommandActions,appActions:t.appCommandActions,componentLibraryActions:t.componentLibraryCommandActions,appModuleActions:t.appModuleCommandActions,flowActions:t.flowCommandActions,customConnectorActions:t.customConnectorCommandActions,entityActions:t.entityCommandActions,objectSpecificOptions:i,applicableComponentActions:u.solutionComponentSelectors.solutionComponentActions(e),applicableSolutionActions:m.solutionActions(e),componentTypes:t.componentTypes,isCustomerServiceAppInstalled:m.isCustomerServiceAppInstalled(e),isDualWriteCoreSolutionInstalled:m.isDualWriteCoreSolutionInstalled(e,a),isCustomConnectorSupported:Object(O.isCRMVersionCompatibleForCustomConnector)(Object(E.getCrmVersion)(o)),isComponentLibrariesSupported:Object(P.isCRMVersionCompatibleForComponentLibraries)(Object(E.getCrmVersion)(o)),enableTestStudio:y.EnableTestStudio,currentEnvironment:t.rootProps.currentEnvironment,customComponentDefinitions:t.customComponentDefinitions,isObjectCheckerRunStarting:g,isObjectCheckerRunCompleted:f}),isCustomerServiceAppInstalled:m.isCustomerServiceAppInstalled(e),canvasAppObjectExist:s,isSelectedObjectCheckerRunStarting:g,objectsBeingChecked:p}};function N(e){return{fetchApp:t=>{e(j.appsActions.fetchAppRequest({appName:t}))}}}var x=(e,t,n)=>{var{commands:r,isCustomerServiceAppInstalled:o,canvasAppObjectExist:a}=e,i=Object(s.isSolutionAParentWithPatches)(n.solution),u=n.rootProps.currentEnvironment,d=Object(O.isCRMVersionCompatibleForCustomConnector)(Object(E.getCrmVersion)(u)),m=1===n.currentSelectedItems.length?n.currentSelectedItems[0]:void 0;if(r.forEach(e=>{Object(s.isSolutionManaged)(n.solution)&&e.key!==h.SolutionComponentsCommandKey.ShowDependencies&&e.key!==h.SolutionComponentsCommandKey.ClassicMode&&e.key!==h.SolutionComponentsCommandKey.SeeAnalytics&&e.key!==h.SolutionComponentsCommandKey.Details&&e.key!==h.SolutionComponentsCommandKey.ManagedProperties&&e.key!==f.SolutionCommandKey.SolutionUpgrade&&e.key!==f.SolutionCommandKey.Delete&&e.key!==f.SolutionCommandKey.PublishAllCustomizations&&e.key!==f.SolutionCommandKey.SolutionHistory&&e.key!==h.SolutionComponentsCommandKey.SolutionLayers&&e.key!==h.SolutionComponentsCommandKey.Activate&&e.key!==h.SolutionComponentsCommandKey.Deactivate&&e.key!==h.SolutionComponentsCommandKey.PlayApp&&e.key!==h.SolutionComponentsCommandKey.ShareApp&&e.key!==h.SolutionComponentsCommandKey.MonitorApp&&e.key!=h.SolutionComponentsCommandKey.ObjectChecker?e.disabled=!0:e.key===h.SolutionComponentsCommandKey.Edit?i||n.currentSelectedItems.length>1?e.disabled=!0:e.disabled=!Object(C.isComponentTypeEditable)(Object(l.getTypeFromSolutionComponent)(m)):e.disabled=!!i||e.disabled}),!a&&(Object(l.isOfSolutionComponentType)(m,k.StandardSolutionComponentTypes.CanvasApp)||Object(l.isOfSolutionComponentType)(m,k.StandardSolutionComponentTypes.CanvasAppsOnly)||Object(l.isOfSolutionComponentType)(m,k.StandardSolutionComponentTypes.CustomCanvasPage)||Object(l.isOfSolutionComponentType)(m,k.StandardSolutionComponentTypes.ComponentLibrary))){var g=Object(l.getSolutionComponentCanvasAppId)(m);t.fetchApp(g)}var y=Object(b.getFilterComponentsItem)(n.onComponentTypeSelect,o,d,n.rootProps.currentEnvironment,n.customComponentDefinitions,n.componentTypes),S=[];return Object(D.getResponsiveMode)(window)<=D.ResponsiveMode.large?r.push(y):S.push(y),{items:r.slice(0,5),farItems:S,overflowItems:r.slice(5),overflowButtonProps:{ariaLabel:Object(c.getResources)().Common.commands},isSearchBoxVisible:!0,searchBoxProps:Object(p.getSearchBoxProps)(n.onSearchFilterUpdate)}},I=Object(L.withNavigation)(Object(w.withCustomConnectorCommands)(g.SolutionContexts.ComponentsList.CommandBar)(Object(S.withFlowCommands)(g.SolutionContexts.ComponentsList.CommandBar)(Object(a.withAppCommands)(g.SolutionContexts.ComponentsList.CommandBar)(Object(i.withAppModuleCommands)(g.SolutionContexts.ComponentsList.CommandBar)(Object(y.withEntityCommands)(g.SolutionContexts.ComponentsList.CommandBar)(Object(R.withComponentLibraryCommands)(g.SolutionContexts.ComponentsList.CommandBar)(Object(v.withRootProps)(Object(C.withSolutionComponentCommands)(g.SolutionContexts.ComponentsList.CommandBar)(Object(o.connect)(M,N,x)(r.CommandBarWithSearchBox))))))))))},7973:function(e,t,n){"use strict";n.r(t),n.d(t,"solutionComponentListPageStyles",(function(){return a}));var r=n(719),o=n(2882),a=Object(r.mergeStyleSets)({"solution-components-list-page-listcontainer":{height:"100%",background:o.fabricColors.white,padding:"10px 0"}})},7974:function(e,t,n){"use strict";n.r(t),n.d(t,"SolutionComponentsListContainer",(function(){return i}));var r=n(6614),o=n(5627),a=n(5669),i=Object(r.withSolutionComponentsListBehavior)(o.SolutionComponentsList,a.LoadScenarioNames.SolutionComponentsList)},7975:function(e,t,n){"use strict";n.r(t),n.d(t,"PublishTeamsAppSuccessMessage",(function(){return c}));var r=n(245),o=n(1697),a=n(684),i=n(2879),s=n(3815),l=n(7976),c=e=>{var{labels:t,publishTeamsAppSuccessMessage:n,clearPublishTeamsAppSuccessMessage:c}=e,p=Object(s.formatString)(t.successLink,n.appName);return r.createElement(o.MessageBar,{key:n.appName,messageBarType:o.MessageBarType.success,dismissButtonAriaLabel:i.fabricIcons.Cancel,onDismiss:c},r.createElement("div",null,t.success,r.createElement(a.ActionButton,{href:n.appLink,styles:l.publishTeamsAppSuccessMessageStyles.appLinkButtonStyles},r.createElement("span",{className:l.publishTeamsAppSuccessMessageClasses.publishTeamsAppSuccessMessageLinkText},p))))}},7976:function(e,t,n){"use strict";n.r(t),n.d(t,"publishTeamsAppSuccessMessageClasses",(function(){return a})),n.d(t,"publishTeamsAppSuccessMessageStyles",(function(){return i}));var r=n(719),o=n(2882),a=Object(r.mergeStyleSets)({publishTeamsAppSuccessMessageLinkText:{lineHeight:16,color:o.fabricColors.sharePointBlue}}),i={appLinkButtonStyles:{root:{fontSize:12,fontWeight:400,height:"auto",minWidth:100,paddingLeft:0}}}},7977:function(e,t,n){"use strict";n.r(t),n.d(t,"CreateAppInSolutionModal",(function(){return u}));var r=n(3076),o=n(1071),a=n(245),i=n(5487),s=n(5583),l=n(7493),c=n(5687),p=a.lazy(()=>Promise.resolve().then(n.bind(null,7496)).then(e=>({default:e.CreateAppModalContainer}))),u=Object(o.withServices)(e=>{var{sampleAppCommands:t}=e;return a.createElement(a.Suspense,{fallback:a.createElement(a.Fragment,null)},a.createElement(p,{sampleAppCommands:t,onDismissSampleAppPreview:()=>{}}))},[Object(l.withSampleAppCommands)(c.SolutionContexts.ComponentsList.ContextMenu),r.withApolloClient,s.withNavigation,i.withRootProps])},7978:function(e,t,n){"use strict";n.r(t),n.d(t,"mapStateToProps",(function(){return m})),n.d(t,"mapDispatchToProps",(function(){return g})),n.d(t,"mergeProps",(function(){return h})),n.d(t,"FlowUpdatesMessageBarContainer",(function(){return b}));var r=n(5437),o=n(5487),a=n(5704),i=n(6383),s=n(5468),l=n(5478),c=n(6460);function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var m=e=>{var t=Object(i.modifiedConnectionReferencesSelector)(e);return{objects:[...t?t.map(e=>({objectId:e.connectionreferenceid,displayName:e.connectionreferencedisplayname})):[]]}},g=e=>({onDismissMessage:t=>{e(Object(a.modifiedConnectionReferenceClear)({connectionReferenceId:t}))},openFlowUpdatesPanel:t=>{e(s.sharedActions.panelOpen({panelType:l.PanelToShowType.FlowUpdatesPanel,panelProps:{objectId:t},stayMountedWhenHidden:!1}))}}),h=(e,t,n)=>u(u({},e),t),b=Object(o.withRootProps)(Object(r.connect)(m,g,h)(c.FlowUpdatesMessageBar))},8007:function(e,t,n){"use strict";n.r(t),n.d(t,"SolutionsHistoryListPageContainerBehavior",(function(){return h})),n.d(t,"SolutionsHistoryListPageContainerConnected",(function(){return b}));var r=n(5629),o=n(5583),a=n(922),i=n(245),s=n.n(i),l=n(8008),c=n(5669),p=n(1200),u=n(5487),d=n(5691),m=n(5437);function g(){return(g=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var h=e=>{var t,n=(t=e)&&t.match&&t.match.params&&t.match.params.solutionId&&t.match.params.solutionId.toLocaleLowerCase()||"",r=Object(m.useSelector)(d.normalizedSolutionsSelector),o=Object.keys(r.byId),a=r.byId(n),[c,h]=s.a.useState(a&&a.uniquename||""),[b,f]=s.a.useState(l.SolutionTypeFilterOptions.All),{rootProps:{areShellProvidersReady:y}}=Object(i.useContext)(u.RootPropsContext);return y?s.a.createElement(l.SolutionsHistoryListPage,g({currentSolutionType:b,onSolutionTypeFilterOptionsUpdate:f,onSearchFilterUpdate:h,searchBy:c,solutionIds:o},e)):s.a.createElement(p.PagePlaceholder,null)},b=Object(o.withNavigation)(Object(a.translateService)("PowerappsPortal")(Object(r.withLoadTelemetry)(h,c.LoadScenarioNames.SolutionsHistoryList)))},8015:function(e,t,n){"use strict";n.r(t),n.d(t,"mapStateToProps",(function(){return S})),n.d(t,"mapDispatchToProps",(function(){return C})),n.d(t,"mergeProps",(function(){return v})),n.d(t,"SolutionsListPageContainer",(function(){return w}));var r=n(3829),o=n(922),a=n(5437),i=n(5487),s=n(5604),l=n(5478),c=n(5583),p=n(2869),u=n(5746),d=n(5690),m=n(5582),g=n(5468),h=n(8016);function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){y(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var S=(e,t)=>{var n=t.rootProps.currentEnvironment,r=n&&n.id,o=u.solutionsSelectors.solutionsSelector(e,r),a=Object(p.getResources)(),i=u.solutionsSelectors.solutionStatusListError(e,r);return{hasDatabase:Object(s.environmentHasCds2Database)(n),publishCustomizationsResponse:u.solutionsSelectors.publishCustomizationsStatus(e),publishToSourceControlResponse:u.solutionsSelectors.publishToSourceControlStatus(e),refreshFromSourceControlResponse:u.solutionsSelectors.refreshFromSourceControlStatus(e),exportSolutionResponse:u.solutionsSelectors.exportSolutionStatus(e),deleteSolutionResponse:u.solutionsSelectors.deleteSolutionStatus(e),upgradeSolutionResponse:u.solutionsSelectors.upgradeSolutionStatus(e),analysisErrorResponse:u.solutionsSelectors.analysisRequestsErrorResponses(e,r),downloadErrorResponse:u.solutionsSelectors.downloadResultsErrorResponses(e,r),cancelAnalysisErrorResponse:u.solutionsSelectors.analysisCancelErrorResponses(e,r),installProvisionErrorMessage:u.solutionsSelectors.isErrorSolutionCheckerInstall(e,r)?a.Model.Solutions.MessageBar.installProvision:"",fetchSolutionStatusErrorMessage:i?a.Model.Solutions.MessageBar.fetchSolutionStatus:"",isSolutionCheckerInstalling:u.solutionsSelectors.isSolutionCheckerInstalling(e,r),cloneSolutionResponse:u.solutionsSelectors.cloneSolutionStatus(e),patchSolutionResponse:u.solutionsSelectors.patchSolutionStatus(e),exportTranslationResponse:u.solutionsSelectors.exportTranslationsStatus(e),solutionAsyncImportJobs:u.solutionsSelectors.solutionImportJobsSelector(e),solutionAsyncExportJobs:u.solutionsSelectors.solutionExportJobsSelector(e),publishTeamsAppSuccessMessage:u.solutionsSelectors.publishTeamsAppSuccessMessageSelector(e),solutions:o,navigate:t.navigate}},C=(e,t)=>{var n=Object(m.currentEnvironmentIdSelector)(t);return{dismissAnalysisErrors:()=>{e(u.solutionsActions.solutionCheckerRunClearErrors({environmentId:n}))},dismissDownloadErrors:()=>{e(u.solutionsActions.solutionCheckerDownloadClearErrors({environmentId:n}))},dismissCancelAnalysisErrors:()=>{e(u.solutionsActions.solutionCheckerCancelClearErrors({environmentId:n}))},dismissInstallProvisionErrors:()=>{e(u.solutionsActions.solutionCheckerInstallProvisionClearErrors({environmentId:n}))},dismissFetchSolutionStatusErrors:()=>{e(u.solutionsActions.solutionCheckerFetchStatusClearErrors({environmentId:n}))},clearPublishCustomizationMessage:()=>{e({type:d.SolutionsActionTypes.PUBLISH_ALL_CUSTOMIZATIONS_CLEAR})},clearPublishToSourceControlMessage:()=>{e({type:d.SolutionsActionTypes.PUBLISH_TO_SOURCE_CONTROL_CLEAR})},clearRefreshFromSourceControlMessage:()=>{e({type:d.SolutionsActionTypes.REFRESH_FROM_SOURCE_CONTROL_CLEAR})},clearExportSolutionResponse:()=>{e(u.solutionsActions.exportSolutionClear())},clearDeleteSolutionResponse:()=>{e(u.solutionsActions.deleteSolutionClear())},clearCloneSolutionResponse:()=>{e(u.solutionsActions.cloneSolutionClear())},clearPatchSolutionResponse:()=>{e(u.solutionsActions.patchSolutionClear())},clearUpgradeSolutionResponse:()=>{e(u.solutionsActions.upgradeSolutionClear())},clearExportTranslationResponse:()=>{e(u.solutionsActions.exportTranslationsSolutionClear())},clearSolutionAsyncJob:t=>{e(u.solutionsActions.solutionAsyncJobClear({asyncOperationId:t}))},downloadLogFile:(t,n,r)=>{e(u.solutionsActions.solutionImportDownloadLogFile({importJobId:n,solutionDisplayName:t,errorMessage:r}))},clearPublishTeamsAppSuccessMessage:()=>{e(u.solutionsActions.clearPublishTeamsAppSuccessMessage())},onDismount:()=>{e(g.sharedActions.panelClose({panelType:l.PanelToShowType.SolutionExportPanel})),e(u.solutionsActions.solutionAsyncJobClear()),e(u.solutionsActions.exportSolutionClear()),e(u.solutionsActions.deleteSolutionClear()),e(u.solutionsActions.cloneSolutionClear()),e(u.solutionsActions.patchSolutionClear()),e(u.solutionsActions.upgradeSolutionClear()),e(u.solutionsActions.exportTranslationsSolutionClear()),e(u.solutionsActions.clearPublishTeamsAppSuccessMessage())}}},v=(e,t,n)=>{var{areShellProvidersReady:r}=n.rootProps,o=Object(m.currentEnvironmentIdSelector)(n);return f(f(f({},e),t),{},{enableSolutionTreeViewToggleVisible:n.enableSolutionTreeViewToggleVisible,setEnableSolutionTreeView:n.setEnableSolutionTreeView,enableSolutionTreeView:n.enableSolutionTreeView,t:n.t,tReady:n.tReady,areShellProvidersReady:r,environmentId:o,refreshCurrentEnvironment:n.rootProps.refreshCurrentEnvironment})},w=Object(o.translateService)("PowerappsPortal")(Object(c.withNavigation)(Object(r.withSolutionPageSelectorProvider)(Object(i.withRootProps)(Object(a.connect)(S,C,v)(h.SolutionsListPage)))))},8016:function(e,t,n){"use strict";n.r(t),n.d(t,"SolutionsListPage",(function(){return W}));var r=n(4792),o=n(684),a=n(1090),i=n(1697),s=n(719),l=n(2890),c=n(6332),p=n(3058),u=n(1089),d=n(2814),m=n(1200),g=n(1077),h=n(2867),b=n(2812),f=n(245),y=n(2699),S=n(5606),C=n(2886),v=n(7978),w=n(8017),O=n(7641),P=n(7642),E=n(7664),A=n(7648),j=n(2879),L=n(5481),T=n(2869),k=n(2880),R=n(5623),D=n(5692),M=n(2884),N=n(2878),x=n(5687),I=n(5676),F=n(7975),B=n(8018),U=n(8020),G=n(7971),z=n(5780),H={messageBarStyles:{innerText:{width:"100%"}},downloadButtonStyles:{root:{fontSize:12,fontWeight:600,height:20,backgroundColor:p.fabricColors.white,borderColor:p.fabricColors.gray},label:{color:p.fabricColors.gray,whiteSpace:"nowrap"}}},_=Object(s.mergeStyleSets)({messageBar:[{selectors:{".ms-MessageBar-innerText":{width:"100%"}}}],solutionsListExportMessageInnerContainer:{display:"flex",alignItems:"flex-start",selectors:{".solutionDependenciesMessageTextContainer":{width:"100%"}}}});class W extends f.Component{constructor(e){super(e),this.resources=Object(T.getResources)(),this.getErrorHandler=e=>{var t,n=Object(R.getSolutionDependenciesUrl)(null===(t=this.state.solution)||void 0===t?void 0:t.id),r=S.SagaContextProps.getCurrentEnvironment();return Object(c.hasAllModernSolutionExplorerFixes)(r)&&this.props.enableSolutionTreeView&&"0x8004f01d"===e.serverErrorCode?f.createElement("div",{className:_.solutionsListExportMessageInnerContainer},f.createElement("div",{className:"solutionDependenciesMessageTextContainer"},Object(u.formatResourceStringToElement)(this.props.t("Services.Delete.missingDependencies"),(e,t)=>{var n;if(0===t)return f.createElement("b",null,null===(n=this.state.solution)||void 0===n?void 0:n.friendlyname)}))," ",f.createElement(o.ActionButton,{styles:H.downloadButtonStyles,onClick:()=>{this.props.navigate(n,!0)}},this.props.t("Services.Delete.viewDependencies"))):f.createElement(f.Fragment,null,this.props.deleteSolutionResponse.message)},this.getLocalizedSolutionType=e=>{var t;switch(e){case I.SolutionTypeFilterOptions.All:t=this.props.t("Model.Solutions.Components.Types.all");break;case I.SolutionTypeFilterOptions.Managed:t=this.props.t("Model.Solutions.FilterType.managed");break;case I.SolutionTypeFilterOptions.Unmanaged:t=this.props.t("Model.Solutions.FilterType.unmanaged");break;default:t=e}return t},this.onSolutionTypeSelect=e=>{Object(g.checkSessionStorage)()&&g.StorageHelper.transient.setItem(I.SolutionTypeFilterKey,e),this.setState({solutionType:e})},this.onEnableSolutionTreeViewChecked=e=>{this.props.t("Services.Delete.missingDependencies"),Object(z.announce)(this.props.t("Model.Solutions.EnableSolutionTreeView.Toggle.".concat(e?"ariaOn":"ariaOff")),"assertive"),this.props.setEnableSolutionTreeView(e),this.setState({enableSolutionTreeViewChecked:e})},this.onDimissSeenSolutionTreeViewTeachingBubble=()=>{Object(g.checkSessionStorage)()&&(g.StorageHelper.transientWithGlobalFallback.setItem(I.SeenSolutionTreeViewTeachingBubbleKey,"true"),this.setState({seenSolutionTreeViewTeachingBubble:!0}))};var t=Object(I.getSolutionListFilter)(),n=this.props.enableSolutionTreeView,r=Object(I.getSeenSolutionTreeViewTeachingBubble)();this.state={selectedSolution:null,searchFilter:"",isDatabaseReady:this.props.hasDatabase,solutionType:t,enableSolutionTreeViewChecked:n,seenSolutionTreeViewTeachingBubble:r,solution:null,showMembersIndicator:!1}}componentDidUpdate(e){this.props.hasDatabase&&!e.hasDatabase&&(this.props.refreshCurrentEnvironment(),this.setState({isDatabaseReady:!0}))}componentWillUnmount(){this.props.onDismount(),this.props.clearPublishCustomizationMessage(),this.props.clearPublishToSourceControlMessage(),this.props.clearRefreshFromSourceControlMessage()}onSolutionSelect(e){this.setState({selectedSolution:e}),e&&this.setState({solution:e})}onSearchFilterUpdate(e){this.setState({searchFilter:e})}render(){if(!this.props.areShellProvidersReady)return f.createElement(m.PagePlaceholder,null);var e=this.resources.Model.Solutions.ListPage.pageTitle,t="";return this.props.publishCustomizationsResponse.loading?t=this.resources.Model.Solutions.PublishAllCustomizations.inProgressMessage:this.props.deleteSolutionResponse.loading?t=this.resources.Model.Solutions.Delete.inProgressMessage:this.props.upgradeSolutionResponse.loading?t=this.resources.Model.Solutions.UpgradeSolution.inProgressMessage:this.props.exportTranslationResponse.loading?t=this.resources.Model.Solutions.ExportTranslations.inProgressMessage:this.props.publishToSourceControlResponse.loading?t=this.resources.Model.Solutions.PublishToSourceControl.inProgressMessage:this.props.refreshFromSourceControlResponse.loading&&(t=this.resources.Model.Solutions.RefreshFromSourceControl.inProgressMessage),f.createElement(f.Fragment,null,f.createElement(E.MembersIndicatorChecker,{onMembersIndicatorChecked:e=>this.setState({showMembersIndicator:e})}),f.createElement(r.Page,{className:"solutions-list-page",spinnerProps:{label:t},showOverlay:this.props.publishCustomizationsResponse.loading&&!this.props.publishCustomizationsResponse.originatedFromPanel||this.props.publishToSourceControlResponse.loading||this.props.refreshFromSourceControlResponse.loading||this.props.deleteSolutionResponse.loading||this.props.upgradeSolutionResponse.loading||this.props.exportTranslationResponse.loading||this.props.isSolutionCheckerInstalling,renderHeader:()=>this.props.hasDatabase&&f.createElement(U.SolutionsListCommandBarAdapter,{selectedSolution:this.state.selectedSolution,onSearchFilterUpdate:this.onSearchFilterUpdate.bind(this),currentSolutionType:this.getLocalizedSolutionType(this.state.solutionType),onSolutionTypeSelect:this.onSolutionTypeSelect,enableSolutionTreeViewToggleVisible:this.props.enableSolutionTreeViewToggleVisible,currentEnableSolutionTreeViewChecked:this.state.enableSolutionTreeViewChecked,onEnableSolutionTreeViewChecked:this.onEnableSolutionTreeViewChecked,currentSeenSolutionTreeViewTeachingBubble:this.state.seenSolutionTreeViewTeachingBubble,onDimissSeenSolutionTreeViewTeachingBubble:this.onDimissSeenSolutionTreeViewTeachingBubble,enableSolutionTreeView:this.props.enableSolutionTreeView}),renderMessageBar:()=>this.props.hasDatabase&&f.createElement(f.Fragment,null,f.createElement(A.UpdateEnvVarValuesMessageBarContainer,null),f.createElement(v.FlowUpdatesMessageBarContainer,null),this.showOverlayedMessageBar(),this.toggleExportMessageBar(),this.props.publishCustomizationsResponse.message&&f.createElement(i.MessageBar,{messageBarType:this.props.publishCustomizationsResponse.success?i.MessageBarType.success:i.MessageBarType.error,isMultiline:!1,dismissButtonAriaLabel:j.fabricIcons.Cancel,onDismiss:this.props.clearPublishCustomizationMessage},this.props.publishCustomizationsResponse.message),this.props.publishToSourceControlResponse.message&&f.createElement(i.MessageBar,{messageBarType:this.props.publishToSourceControlResponse.success?i.MessageBarType.success:i.MessageBarType.error,isMultiline:!1,dismissButtonAriaLabel:j.fabricIcons.Cancel,onDismiss:this.props.clearPublishToSourceControlMessage},this.props.publishToSourceControlResponse.message),this.props.refreshFromSourceControlResponse.message&&f.createElement(i.MessageBar,{messageBarType:this.props.refreshFromSourceControlResponse.success?i.MessageBarType.success:i.MessageBarType.error,isMultiline:!1,dismissButtonAriaLabel:j.fabricIcons.Cancel,onDismiss:this.props.clearRefreshFromSourceControlMessage},this.props.refreshFromSourceControlResponse.message),this.props.deleteSolutionResponse.message&&f.createElement(i.MessageBar,{messageBarType:this.props.deleteSolutionResponse.success?i.MessageBarType.success:i.MessageBarType.error,isMultiline:!1,dismissButtonAriaLabel:j.fabricIcons.Cancel,onDismiss:this.props.clearDeleteSolutionResponse,styles:H.messageBarStyles},this.getErrorHandler(this.props.deleteSolutionResponse)),this.props.cloneSolutionResponse&&this.props.cloneSolutionResponse.success&&this.props.cloneSolutionResponse.message&&f.createElement(i.MessageBar,{messageBarType:i.MessageBarType.success,isMultiline:!1,dismissButtonAriaLabel:j.fabricIcons.Cancel,onDismiss:this.props.clearCloneSolutionResponse},this.props.cloneSolutionResponse.message),this.props.patchSolutionResponse&&this.props.patchSolutionResponse.success&&this.props.patchSolutionResponse.message&&f.createElement(i.MessageBar,{messageBarType:i.MessageBarType.success,isMultiline:!1,dismissButtonAriaLabel:j.fabricIcons.Cancel,onDismiss:this.props.clearPatchSolutionResponse},this.props.patchSolutionResponse.message),this.props.upgradeSolutionResponse.message&&f.createElement(i.MessageBar,{messageBarType:this.props.upgradeSolutionResponse.success?i.MessageBarType.success:i.MessageBarType.error,isMultiline:!1,dismissButtonAriaLabel:j.fabricIcons.Cancel,onDismiss:this.props.clearUpgradeSolutionResponse},this.props.upgradeSolutionResponse.message),this.props.exportTranslationResponse.message&&f.createElement(i.MessageBar,{messageBarType:this.props.exportTranslationResponse.success?i.MessageBarType.success:i.MessageBarType.error,isMultiline:!1,dismissButtonAriaLabel:j.fabricIcons.Cancel,onDismiss:this.props.clearExportTranslationResponse},this.props.exportTranslationResponse.message),this.props.solutionAsyncImportJobs&&f.createElement(N.SolutionsListImportMessage,{environmentId:this.props.environmentId,solutionImportJobs:this.props.solutionAsyncImportJobs,clearSolutionImportJob:this.props.clearSolutionAsyncJob,downloadLogFile:this.props.downloadLogFile}),this.props.solutionAsyncExportJobs&&f.createElement(M.SolutionsListExportMessage,{environmentId:this.props.environmentId,solutionExportJobs:this.props.solutionAsyncExportJobs,clearSolutionExportJob:this.props.clearSolutionAsyncJob}),this.props.publishTeamsAppSuccessMessage&&f.createElement(F.PublishTeamsAppSuccessMessage,{publishTeamsAppSuccessMessage:this.props.publishTeamsAppSuccessMessage,labels:this.resources.Model.Solutions.PublishTeamsAppPanel.ComponentsAndRoles.Publish,clearPublishTeamsAppSuccessMessage:this.props.clearPublishTeamsAppSuccessMessage})),renderTitle:()=>this.state.showMembersIndicator?f.createElement(P.PageHeaderWithMembersIndicator,{adminCenterUrl:d.settings.powerPlatformAdminCenterUrl,headerProps:{wrapperClassName:"solutions-list-page-header",title:e}}):f.createElement(O.PageHeaderWithEnvContainer,{wrapperClassName:"solutions-list-page-header",title:e}),renderBody:()=>this.props.hasDatabase&&this.state.isDatabaseReady?f.createElement(B.SolutionsListContainer,{onSolutionSelect:this.onSolutionSelect.bind(this),searchFilter:this.state.searchFilter,solutionTypeFilterOption:this.state.solutionType,enableSolutionTreeView:this.props.enableSolutionTreeView}):this.getNoDatabaseElement()}))}showOverlayedMessageBar(){if(y.featureGates.enableSolutionChecker){if(this.props.analysisErrorResponse&&!this.props.analysisErrorResponse.isEmpty())return this.getDetailedMessageBar(D.SolutionCheckerApiType.AnalysisRequest,this.props.analysisErrorResponse,this.props.dismissAnalysisErrors);if(this.props.downloadErrorResponse&&!this.props.downloadErrorResponse.isEmpty())return this.getDetailedMessageBar(D.SolutionCheckerApiType.DownloadResults,this.props.downloadErrorResponse,this.props.dismissDownloadErrors);if(this.props.cancelAnalysisErrorResponse&&!this.props.cancelAnalysisErrorResponse.isEmpty())return this.getDetailedMessageBar(D.SolutionCheckerApiType.AnalysisCancel,this.props.cancelAnalysisErrorResponse,this.props.dismissCancelAnalysisErrors);if(this.props.installProvisionErrorMessage)return this.getMessageBar(this.props.installProvisionErrorMessage,this.props.dismissInstallProvisionErrors);if(this.props.fetchSolutionStatusErrorMessage)return this.getMessageBar(this.props.fetchSolutionStatusErrorMessage,this.props.dismissFetchSolutionStatusErrors)}return null}getMessageBar(e,t){return e?f.createElement(i.MessageBar,{messageBarType:i.MessageBarType.blocked,isMultiline:!1,onDismiss:()=>{t()},dismissButtonAriaLabel:j.fabricIcons.Cancel,truncated:!0,overflowButtonAriaLabel:j.fabricIcons.SeeMore},f.createElement("span",{className:G.errorMessageStyles.spans},e)):null}getDetailedMessageBar(e,t,n){if(this.props.solutions&&t){var r=[],o=Object(h.Map)(),s=[];return t.forEach((e,t)=>{e.errorDetails?o.has(e.errorDetails.errorCode)?o.get(e.errorDetails.errorCode).solutionIds.push(t):o=o.set(e.errorDetails.errorCode,{helpLink:e.errorDetails.helpLink,message:e.errorDetails.message,solutionIds:[t]}):r.push(t)}),b.isEmpty(r)||s.push(f.createElement("span",null,this.fetchGeneralErrorMessage(e,this.combineSolutionNames(Object(C.getSolutionNamesFromIds)(this.props.solutions,r))))),o.forEach((t,n)=>{var r=this.fetchSpecificErrorMessage(e,n,this.combineSolutionNames(Object(C.getSolutionNamesFromIds)(this.props.solutions,t.solutionIds)));s.push(f.createElement("span",{className:G.errorMessageStyles.spans},r,f.createElement(a.Link,{href:t.helpLink,target:"_blank"},this.resources.Model.Solutions.MessageBar.reviewHelpLinkStatement)))}),b.isEmpty(s)?null:f.createElement(i.MessageBar,{messageBarType:i.MessageBarType.blocked,isMultiline:!1,onDismiss:()=>{n()},dismissButtonAriaLabel:j.fabricIcons.Cancel,truncated:!0,overflowButtonAriaLabel:j.fabricIcons.SeeMore},s)}return null}combineSolutionNames(e){return e&&e.join(this.resources.Model.Solutions.MessageBar.solutionNameSeparator)}fetchGeneralErrorMessage(e,t){var n="";switch(e){case D.SolutionCheckerApiType.AnalysisRequest:n=this.resources.Model.Solutions.MessageBar.analysisRequest;break;case D.SolutionCheckerApiType.DownloadResults:n=this.resources.Model.Solutions.MessageBar.download;break;case D.SolutionCheckerApiType.AnalysisCancel:n=this.resources.Model.Solutions.MessageBar.analysisCancel}return n?Object(k.formatResourceString)(n,t):n}fetchSpecificErrorMessage(e,t,n){var r="",o=this.resources.Model.Solutions.MessageBar;switch(e){case D.SolutionCheckerApiType.AnalysisRequest:switch(t){case l.SolutionCheckerErrorCodes.AccessMode:r=o.DeniedAccessMode.analysisRequest;break;case l.SolutionCheckerErrorCodes.AdminMode:r=o.DeniedAdminMode.analysisRequest;break;case l.SolutionCheckerErrorCodes.NoAssignedRoles:r=o.DeniedNoAssignedRoles.analysisRequest;break;case l.SolutionCheckerErrorCodes.UnsupportedSolutionVersion:r=o.UnsupportedSolutionVersion.analysisRequest;break;case l.SolutionCheckerErrorCodes.NotMemberOfOrg:r=o.DeniedNotMemberOfOrg.analysisRequest;break;case l.SolutionCheckerErrorCodes.AppUserDisabled:r=o.DeniedAppUserDisabled.analysisRequest;break;case l.SolutionCheckerErrorCodes.IsvCodeAbortedOperation:r=o.IsvCodeAbortedOperation.analysisRequest;break;case l.SolutionCheckerErrorCodes.UserNotLicensed:r=o.DeniedUserNotLicensed.analysisRequest;break;case l.SolutionCheckerErrorCodes.MissingPrivileges:r=o.DeniedMissingPrivileges.analysisRequest;break;default:r=o.analysisRequest}break;case D.SolutionCheckerApiType.DownloadResults:switch(t){case l.SolutionCheckerErrorCodes.AccessMode:r=o.DeniedAccessMode.download;break;case l.SolutionCheckerErrorCodes.AdminMode:r=o.DeniedAdminMode.download;break;case l.SolutionCheckerErrorCodes.NoAssignedRoles:r=o.DeniedNoAssignedRoles.download;break;case l.SolutionCheckerErrorCodes.UnsupportedSolutionVersion:r=o.UnsupportedSolutionVersion.download;break;case l.SolutionCheckerErrorCodes.NotMemberOfOrg:r=o.DeniedNotMemberOfOrg.download;break;case l.SolutionCheckerErrorCodes.AppUserDisabled:r=o.DeniedAppUserDisabled.download;break;case l.SolutionCheckerErrorCodes.IsvCodeAbortedOperation:r=o.IsvCodeAbortedOperation.download;break;case l.SolutionCheckerErrorCodes.UserNotLicensed:r=o.DeniedUserNotLicensed.download;break;case l.SolutionCheckerErrorCodes.MissingPrivileges:r=o.DeniedMissingPrivileges.download;break;default:r=o.download}break;case D.SolutionCheckerApiType.AnalysisCancel:switch(t){case l.SolutionCheckerErrorCodes.AccessMode:r=o.DeniedAccessMode.analysisCancel;break;case l.SolutionCheckerErrorCodes.AdminMode:r=o.DeniedAdminMode.analysisCancel;break;case l.SolutionCheckerErrorCodes.NoAssignedRoles:r=o.DeniedNoAssignedRoles.analysisCancel;break;case l.SolutionCheckerErrorCodes.UnsupportedSolutionVersion:r=o.UnsupportedSolutionVersion.analysisCancel;break;case l.SolutionCheckerErrorCodes.NotMemberOfOrg:r=o.DeniedNotMemberOfOrg.analysisCancel;break;case l.SolutionCheckerErrorCodes.AppUserDisabled:r=o.DeniedAppUserDisabled.analysisCancel;break;case l.SolutionCheckerErrorCodes.IsvCodeAbortedOperation:r=o.IsvCodeAbortedOperation.analysisCancel;break;case l.SolutionCheckerErrorCodes.UserNotLicensed:r=o.DeniedUserNotLicensed.analysisCancel;break;case l.SolutionCheckerErrorCodes.MissingPrivileges:r=o.DeniedMissingPrivileges.analysisCancel;break;default:r=o.analysisCancel}}return r?Object(k.formatResourceString)(r,n):r}toggleExportMessageBar(){var e,{failed:t,success:n,message:r}=this.props.exportSolutionResponse;return t||n?(e={truncated:t,styles:n&&G.solutionListPanelStyles.solutionExportPanelMessageStyles,messageBarType:n?i.MessageBarType.success:i.MessageBarType.error,onDismiss:this.props.clearExportSolutionResponse},f.createElement(i.MessageBar,e,r)):null}getNoDatabaseElement(){var e={telemetryEventPrefix:x.SolutionListNoDatabaseEvents.eventName,icon:j.fabricIcons.DocumentSet,databaseProvisioningProps:{primaryMessage:this.resources.Model.Solutions.Message.DatabaseProvisioning.title,secondaryMessage:[this.resources.Model.Solutions.Message.DatabaseProvisioning.description],learnMoreLabel:this.resources.Model.Solutions.Message.DatabaseProvisioning.link,learnMoreProps:{href:L.default.createModelDrivenAppsLearnMoreLink,target:"_blank"}},noPermissionToCreateProps:{primaryMessage:this.resources.Model.Solutions.Message.NoPermissionsForDatabase.title,secondaryMessage:[this.resources.Model.Solutions.Message.NoPermissionsForDatabase.description]},createDatabaseProps:{primaryMessage:this.resources.Model.Solutions.Message.NoDatabase.title,secondaryMessage:[this.resources.Model.Solutions.Message.NoDatabase.description]}};return f.createElement(w.NoDatabaseMessageContainer,e)}}},8017:function(e,t,n){"use strict";n.r(t),n.d(t,"mapStateToProps",(function(){return b})),n.d(t,"mapDispatchToProps",(function(){return f})),n.d(t,"mergeProps",(function(){return y})),n.d(t,"NoDatabaseMessageContainer",(function(){return S}));var r=n(3161),o=n(5437),a=n(5487),i=n(5604),s=n(5876),l=n(5481),c=n(2869),p=n(5630),u=n(5468),d=n(5478);function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){h(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var b=(e,t)=>{var n=t.rootProps.currentEnvironment;return{hasDatabase:i.environmentHasCds2Database(n),hasPermissions:i.canUserCreateDatabase(n),isDatabaseProvisioning:i.isDatabaseInProvisioningState(n)}},f=(e,t)=>({createDatabase:()=>e(Object(p.logAction)(u.sharedActions.panelOpen({panelType:d.PanelToShowType.CreateXrmDatabasePanel,panelProps:{}}),s.CreateEnvironmentPanelEvents.CreateDatabaseClick.eventName)),createEnvironment:()=>{e(Object(p.logAction)(u.sharedActions.panelOpen({panelType:d.PanelToShowType.CreateEnvironmentPanel,panelProps:null}),s.CreateEnvironmentPanelEvents.CreatePanelOpened.eventName))}}),y=(e,t,n)=>{var{hasDatabase:r,hasPermissions:o,isDatabaseProvisioning:a}=e,i=null,s=n.icon,p=Object(c.getResources)();return a?i=g({icon:s,maxWidth:400},n.databaseProvisioningProps):r||o?!r&&o&&(i=g({icon:s,maxWidth:400,callToActionText:p.Model.NoDatabase.Message.NoDatabase.button,callToActionProps:{onClick:t.createDatabase},learnMoreLabel:p.Model.NoDatabase.Message.LearnMore.title,learnMoreProps:{href:l.default.databaseCreateDisclosureLink,target:"_blank"}},n.createDatabaseProps)):i=g({icon:s,maxWidth:400,callToActionText:p.Model.NoDatabase.Message.NoPermissionsForDatabase.button,callToActionProps:{onClick:t.createEnvironment},learnMoreLabel:p.Model.NoDatabase.Message.LearnMore.title,learnMoreProps:{href:l.default.environmentsHelpLink,target:"_blank"}},n.noPermissionToCreateProps),i},S=Object(a.withRootProps)(Object(o.connect)(b,f,y)(r.EmptyState))},8018:function(e,t,n){"use strict";n.r(t),n.d(t,"createSolutionListItems",(function(){return v})),n.d(t,"mapStateToProps",(function(){return w})),n.d(t,"mapDispatchToProps",(function(){return O})),n.d(t,"mergeProps",(function(){return P})),n.d(t,"SolutionsListContainer",(function(){return E}));var r=n(8019),o=n(5487),a=n(7988),i=n(5687),s=n(5676),l=n(5690),c=n(2886),p=n(5746),u=n(5629),d=n(1105),m=n(5669),g=n(5437),h=n(3713),b=n(5604),f=n(5583);function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){C(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function C(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var v=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0,a=arguments.length>5?arguments[5]:void 0;return e.map(e=>{var i=Object(c.isSolutionInArray)(e.id,n),s=Object(c.isSolutionInArray)(e.id,r),l=Object(c.isSolutionInArray)(e.id,o),p=Object(c.getSolutionId)(e);if(!a||p!==d.DEFAULT_SOLUTION_ID){var u={key:p,id:p,name:Object(c.getSolutionDisplayName)(e),dateInstalled:Object(c.getSolutionInstalledDate)(e),dateInstalledString:Object(c.getSolutionInstalledDateString)(e),packageType:Object(c.getSolutionPackageType)(e),publisher:Object(c.getSolutionPublisherName)(e),version:Object(c.getSolutionVersion)(e),solutionCheckerStatus:Object(c.getSolutionCheckerStatus)(e,t,i,l),isSolutionCheckerRunStarting:i,isSolutionCheckerDownloadStarting:s,managed:Object(c.isSolutionManaged)(e),uniqueName:Object(c.getSolutionName)(e),solution:e,isSolutionCheckerCancelStarting:l};return u.filterOn=[u.name,u.uniqueName,u.version],u}}).filter(Boolean)},w=(e,t)=>{var n=t.rootProps.currentEnvironment,r=n&&n.id,o=p.solutionsSelectors.solutionsListError(e,r),a=p.solutionsSelectors.solutionActions(e),s=Object(h.isCDSLiteInPortalUXContext)(n.properties.environmentSku);return{shouldShowSolutionComponentsScenarios:Object(b.shouldShowSolutionComponentsScenarios)(n),searchFilter:t.searchFilter,solutionTypeFilterOption:t.solutionTypeFilterOption,solutionListItems:v(p.solutionsSelectors.solutionsSelector(e,r),p.solutionsSelectors.isSolutionCheckerLoading(e),p.solutionsSelectors.solutionsBeingChecked(e,r),p.solutionsSelectors.solutionsBeingDownloaded(e,r),p.solutionsSelectors.solutionsBeingCanceled(e,r),s),loadProgress:[Object(u.toLoadingState)(p.solutionsSelectors.isSolutionListCacheComplete(e,r)&&!p.solutionsSelectors.isFetchingSolutionsStatus(e),o)],error:o,onSolutionSelect:t.onSolutionSelect,logEvent:i.SolutionListLoadEvents,isSolutionCheckerInstalled:p.solutionsSelectors.isSolutionCheckerInstalled(e),solutionsBeingChecked:p.solutionsSelectors.solutionsBeingChecked(e,r),applicableActions:a,isCDSLiteInPortal:s}},O=(e,t)=>({onMount:()=>e(Object(l.fetchSolutionsRequest)({solutionTypeFilterOption:t.solutionTypeFilterOption,forceRefresh:t.solutionTypeFilterOption==s.SolutionTypeFilterDefault}))&&e(Object(l.fetchSolutionActions)())&&e(Object(l.fetchUserPrivileges)())&&e(Object(l.fetchAsyncSolutionJobsFromLocalStorage)())&&e(Object(l.solutionAsyncOperationPollProgress)()),onDismount:()=>e(Object(l.fetchSolutionsCancelPoll)())&&e(Object(l.solutionAsyncOperationCancelPollProgress)()),filterSolutions:t=>{e(p.solutionsActions.fetchSolutionsRequest({solutionTypeFilterOption:t}))},dispatchTelemetry:e,clearDeleteSolutionResponse:()=>{e(p.solutionsActions.deleteSolutionClear())},clearCloneSolutionResponse:()=>{e(p.solutionsActions.cloneSolutionClear())},clearPatchSolutionResponse:()=>{e(p.solutionsActions.patchSolutionClear())}}),P=(e,t,n)=>{var{solutionCommandActions:r,rootProps:o}=n,a=o.currentEnvironment&&o.currentEnvironment.id;return S(S(S({},e),t),{},{solutionCommandActions:r,environmentId:a})},E=Object(f.withNavigation)(Object(a.withSolutionCommands)(i.SolutionContexts.List.ContextMenu)(Object(o.withRootProps)(Object(g.connect)(w,O,P)(Object(u.withLoadTelemetry)(r.SolutionsList,m.LoadScenarioNames.SolutionsList)))))},8019:function(e,t,n){"use strict";n.r(t),n.d(t,"SolutionsList",(function(){return S}));var r=n(3064),o=n(3161),a=n(1471),i=n(687),s=n(1473),l=n(245),c=n(2699),p=n(5628),u=n(5629),d=n(2879),m=n(2869),g=n(2880),h=n(5633),b=n(5768),f=n(5676);function y(){return(y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}class S extends l.Component{constructor(e){super(e),this.resources=void 0,this.selection=void 0,this.columns=void 0,this.resources=Object(m.getResources)(),this.selection=new a.Selection({onSelectionChanged:()=>{var e=this.selection.getSelection()[0];this.props.onSolutionSelect(e&&e.solution)}})}componentDidMount(){this.props.onMount()}componentWillUnmount(){this.props.onDismount()}componentDidUpdate(e){this.props.solutionTypeFilterOption!==e.solutionTypeFilterOption&&this.props.filterSolutions(this.props.solutionTypeFilterOption?this.props.solutionTypeFilterOption:f.SolutionTypeFilterDefault)}render(){var e;return this.columns=this.buildColumns(this.props.isSolutionCheckerInstalled,this.props.solutionsBeingChecked),e=l.createElement("div",null,l.createElement(r.DetailsList,y({isLoading:Object(u.isLoading)(this.props.loadProgress),renderOnEmpty:()=>{var e=this.getPropsOnEmpty();return l.createElement(o.EmptyState,e)},filter:this.props.searchFilter,renderOnEmptySearch:()=>{var e=this.getEmptySearchProps();return l.createElement(o.EmptyState,e)},isError:Object(u.getTotalLoadingState)(this.props.loadProgress)===u.ComponentLoadState.Fail,renderOnError:()=>{var e=this.getErrorStateProps();return l.createElement(o.EmptyState,e)},items:this.props.solutionListItems,columns:this.columns,setKey:"solution-set",selectionMode:s.SelectionMode.single,selection:this.selection,ariaLabel:this.resources.Model.Solutions.ListPage.pageTitle,filterAnnouncement:e=>Object(g.formatResourceString)(this.resources.Common.Search.Results,e)},Object(h.getDetailsListProps)(this.resources.Common.rowSelectionAriaLabel)))),l.createElement("div",{className:"solutions-list"},e)}buildColumns(e,t){var n=Object(r.buildMenuColumn)(t=>({items:Object(f.getSolutionSpecificCommands)({solution:t.solution,props:this.props.solutionCommandActions,shouldShowSolutionComponentsScenarios:this.props.shouldShowSolutionComponentsScenarios,isSolutionCheckerInstalled:e,isSolutionCheckerRunStarting:t.isSolutionCheckerRunStarting,isSolutionCheckerDownloadStarting:t.isSolutionCheckerDownloadStarting,isSolutionCheckerInstalling:!1,showInstallMenuItem:!1,shownFromContextMenu:!0,environmentId:this.props.environmentId,applicableActions:this.props.applicableActions,isSolutionCheckerCancelStarting:t.isSolutionCheckerCancelStarting,isCDSLiteInPortal:this.props.isCDSLiteInPortal}),iconAriaLabel:this.resources.Common.commands})),o=[{key:"name",name:this.resources.Model.Solutions.List.Header.displayName,fieldName:"name",minWidth:50,maxWidth:300,isRowHeader:!0,isResizable:!0,isPadded:!0,isMultiline:!1,sortAscendingAriaLabel:this.resources.Common.Sorting.ascending,sortDescendingAriaLabel:this.resources.Common.Sorting.descending,onRender:e=>{var t={onClick:()=>{this.props.clearDeleteSolutionResponse(),this.props.clearCloneSolutionResponse(),this.props.clearPatchSolutionResponse(),this.props.shouldShowSolutionComponentsScenarios?this.props.solutionCommandActions.onOpenSolutionComponentsClick(e.solution.id):this.props.solutionCommandActions.onOpenSolutionExplorerClick()},onContextMenu:e=>(e.preventDefault(),!1)};return l.createElement(r.DetailsListLink,{linkText:e.name,linkProps:t})}},n,{key:"uniqueName",name:this.resources.Model.Solutions.List.Header.uniqueName,fieldName:"uniqueName",minWidth:80,maxWidth:120,isResizable:!0,isCollapsable:!0,isMultiline:!1,isPadded:!0,isSorted:!1,isSortedDescending:!0,sortAscendingAriaLabel:this.resources.Common.Sorting.ascending,sortDescendingAriaLabel:this.resources.Common.Sorting.descending},{key:"dateInstalled",name:this.resources.Model.Solutions.List.Header.created,fieldName:"dateInstalled",minWidth:80,maxWidth:120,isResizable:!0,isCollapsable:!0,isMultiline:!1,isPadded:!0,isSorted:!0,isSortedDescending:!0,sortAscendingAriaLabel:this.resources.Common.Sorting.ascending,sortDescendingAriaLabel:this.resources.Common.Sorting.descending,onRender:e=>e.dateInstalledString},{key:"version",name:this.resources.Model.Solutions.List.Header.version,fieldName:"version",minWidth:100,maxWidth:140,isResizable:!0,isCollapsable:!0,isPadded:!0,isMultiline:!1,sortAscendingAriaLabel:this.resources.Common.Sorting.ascending,sortDescendingAriaLabel:this.resources.Common.Sorting.descending},{key:"managed",name:this.resources.Model.Solutions.Components.Header.state,fieldName:"managed",minWidth:100,maxWidth:140,isResizable:!0,isCollapsable:!0,isPadded:!0,isMultiline:!1,sortAscendingAriaLabel:this.resources.Common.Sorting.ascending,sortDescendingAriaLabel:this.resources.Common.Sorting.descending,onRender:e=>{var t=e.managed?"Lock":"Unlock",n=e.managed?this.resources.Model.Solutions.Components.EnvironmentVariable.Panel.DefaultValue.yes:this.resources.Model.Solutions.Components.EnvironmentVariable.Panel.DefaultValue.no;return l.createElement(i.Icon,{iconName:t,ariaLabel:n})}}];return c.featureGates.enableSolutionChecker&&e&&o.push({key:"solutionCheckerStatus",name:this.resources.Model.Solutions.List.Header.solutionChecker,fieldName:"solutionCheckerStatus",minWidth:100,maxWidth:200,isResizable:!0,isCollapsable:!0,isPadded:!0,isMultiline:!1,sortAscendingAriaLabel:this.resources.Common.Sorting.ascending,sortDescendingAriaLabel:this.resources.Common.Sorting.descending}),o}getErrorStateProps(){return{icon:d.fabricIcons.DocumentSet,secondaryMessage:[Object(b.getSolutionsListResponseErrorMessage)(this.props.error)],maxWidth:p.emptyStateMaxWidth}}getEmptySearchProps(){return{icon:d.fabricIcons.DocumentSet,primaryMessage:this.resources.Common.Search.NoMatch.title,secondaryMessage:[this.resources.Common.Search.NoMatch.message],maxWidth:p.emptyStateMaxWidth}}getPropsOnEmpty(){return{icon:d.fabricIcons.DocumentSet,className:"solution-list-empty-message",primaryMessage:this.resources.Solutions.NoSolutions.message,learnMoreLabel:this.resources.Common.learnMore,callToActionText:this.resources.Library.createApp,maxWidth:p.emptyStateMaxWidth}}}},8020:function(e,t,n){"use strict";n.r(t),n.d(t,"SolutionsListCommandBarAdapterInternal",(function(){return u})),n.d(t,"SolutionsListCommandBarAdapter",(function(){return d}));var r=n(3076),o=n(245),a=n.n(o),i=n(7979),s=n(5593),l=n(8021),c=n(922);function p(){return(p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var u=e=>{var{environmentClient:t}=Object(o.useContext)(r.ApolloClientContext),{fcbs:n}=Object(i.useCdsPlatformFCBs)(t,["FCB.SourceControlProofOfConcept"],s.PortalScope,e.t("Common.Request.Failed")),c=null==n?void 0:n.get("FCB.SourceControlProofOfConcept"),u=c&&c.value||!1;return a.a.createElement(l.SolutionsListCommandBarContainer,p({},e,{isSourceControlEnabled:u}))},d=Object(c.translateService)("PowerappsPortal")(u)},8021:function(e,t,n){"use strict";n.r(t),n.d(t,"mapStateToProps",(function(){return C})),n.d(t,"mergeProps",(function(){return v})),n.d(t,"SolutionsListCommandBarContainer",(function(){return w}));var r=n(1222),o=n(5487),a=n(7988),i=n(5676),s=n(3713),l=n(2886),c=n(5687),p=n(5626),u=n(5437),d=n(5582),m=n(2699),g=n(2869),h=n(6607),b=n(5604),f=n(5746),y=n(5583),S=n(860),C=(e,t)=>{var n,r=t.rootProps.currentEnvironment,o=r&&r.id,a=f.solutionsSelectors.solutionsBeingChecked(e,o),i=f.solutionsSelectors.solutionsBeingDownloaded(e,o),c=f.solutionsSelectors.solutionsBeingCanceled(e,o),u=!!t.selectedSolution&&Object(l.isSolutionInArray)(t.selectedSolution.id,i),d=!!t.selectedSolution&&Object(l.isSolutionInArray)(t.selectedSolution.id,a),m=!!t.selectedSolution&&Object(l.isSolutionInArray)(t.selectedSolution.id,c),g=Object(s.getUXContext)(null==r||null===(n=r.properties)||void 0===n?void 0:n.environmentSku);return{isSolutionCheckerInstalled:f.solutionsSelectors.isSolutionCheckerInstalled(e),solutions:f.solutionsSelectors.solutionsSelector(e,o),shouldShowSolutionComponentsScenarios:Object(b.shouldShowSolutionComponentsScenarios)(r),isSelectedSolutionCheckerRunStarting:d,isSelectedSolutionCheckerDownloadStarting:u,isSelectedSolutionCheckerCancelStarting:m,solutionsBeingChecked:a,user:Object(p.aadUserSelector)(e),isSolutionCheckerInstalling:f.solutionsSelectors.isSolutionCheckerInstalling(e,o),applicableActions:f.solutionsSelectors.solutionActions(e),currentUXContext:g}},v=(e,t,n)=>{var r,o=!!n.selectedSolution,a=Object(d.currentEnvironmentIdSelector)(n),c=e.currentUXContext===s.UXContext.CDSLiteInPortal,p=o?Object(i.getSolutionListSpecificCommands)({solution:n.selectedSolution,props:n.solutionCommandActions,shouldShowSolutionComponentsScenarios:e.shouldShowSolutionComponentsScenarios,isSolutionCheckerInstalled:e.isSolutionCheckerInstalled,isSolutionCheckerRunStarting:e.isSelectedSolutionCheckerRunStarting,isSolutionCheckerDownloadStarting:e.isSelectedSolutionCheckerDownloadStarting,isSolutionCheckerInstalling:e.isSolutionCheckerInstalling,showInstallMenuItem:!0,shownFromContextMenu:!1,environmentId:a,applicableActions:e.applicableActions,isSolutionCheckerCancelStarting:e.isSelectedSolutionCheckerCancelStarting,isCDSLiteInPortal:c}):(r=Object(i.getSolutionGenericCommands)(n.solutionCommandActions,e.currentUXContext),c||!m.featureGates.enableSolutionChecker||e.isSolutionCheckerInstalled||r.push(i.solutionCommandRepository.SolutionCheckerInstall(n.solutionCommandActions,e.isSolutionCheckerInstalling,a)),r),u=Object(S.getResponsiveMode)(window)<=S.ResponsiveMode.large,b=[],f=Object(i.getSolutionCheckerStatusCommands)(n.solutionCommandActions);m.featureGates.enableSolutionChecker&&e.isSolutionCheckerInstalled&&e.solutions&&Object(l.isAnySolutionRunning)(e.solutions,e.user.objectId,e.solutionsBeingChecked)&&(u?p=p.concat(f):b=b.concat(f));var y=Object(i.getEnableSolutionTreeViewToggle)(n.currentEnableSolutionTreeViewChecked,n.onEnableSolutionTreeViewChecked,n.currentSeenSolutionTreeViewTeachingBubble,n.onDimissSeenSolutionTreeViewTeachingBubble);n.enableSolutionTreeViewToggleVisible&&(u?p.push(y):b.push(y));var C=Object(i.getFilterSolutionsItem)(n.currentSolutionType,n.onSolutionTypeSelect);(u?p.push(C):b.push(C),n.isSourceControlEnabled)&&Object(i.getSourceControlCommands)(n.solutionCommandActions).forEach(e=>{p.push(e)});var v=Object(i.filterSolutionOverflowCommands)(p);return{items:p.slice(0,6),farItems:b,overflowItems:p.slice(6).concat(v),overflowButtonProps:{title:Object(g.getResources)().Common.commands,ariaLabel:Object(g.getResources)().Common.commands},isSearchBoxVisible:!o,searchBoxProps:Object(h.getSearchBoxProps)(n.onSearchFilterUpdate,void 0,void 0,Object(g.getResources)().Controllers.SearchBox.solutionsPageAriaLabel)}},w=Object(y.withNavigation)(Object(a.withSolutionCommands)(c.SolutionContexts.List.CommandBar)(Object(o.withRootProps)(Object(u.connect)(C,void 0,v)(r.CommandBarWithSearchBox))))},8022:function(e,t,n){"use strict";n.r(t),n.d(t,"TemplatesPageWithTranslation",(function(){return u})),n.d(t,"TemplatesPageContainer",(function(){return d}));var r=n(533),o=n(245),a=n(3183),i=n(2810),s=n(922),l=n(8023),c=n(5483),p=n(5593),u=Object(s.translateService)("PowerappsPortal")(l.TemplatesPage);class d extends o.Component{constructor(e){super(e),this.props=e,this.shouldLogSearchEvent=void 0,this.deepLink=null,this.onSearchFilterUpdate=e=>{this.shouldLogSearchEvent&&(this.shouldLogSearchEvent=!1,Object(p.trackInfoTrace)(i.SearchEventNames.SearchTemplates,{eventName:i.SearchEventNames.SearchTemplates})),this.setState({searchFilter:e})},this.deepLink=this.parseSampleAppPreviewDeepLink(),this.shouldLogSearchEvent=!0,this.state={searchFilter:""}}render(){return o.createElement(a.ContextScenarioProvider,{scenarioName:i.ContextScenarioNames.CreatePage,expectedCompletions:3},o.createElement(u,{deepLink:this.deepLink,searchFilter:this.state.searchFilter,onSearchFilterUpdate:this.onSearchFilterUpdate}))}parseSampleAppPreviewDeepLink(){var e=r.parse(this.props.location.search);return e&&e.sampleapp_preview?{deepLinkPreviewAppName:e.sampleapp_preview,formFactor:e.sampleapp_formfactor,onDismissPreview:()=>this.props.history.push(this.getNewPathName())}:null}getNewPathName(){return Object(c.removeQueryParams)(this.props.location,["sampleapp_preview","sampleapp_formfactor"])}}},8023:function(e,t,n){"use strict";n.r(t),n.d(t,"TemplatesPage",(function(){return s}));var r=n(4792),o=n(245),a=n(8024),i=n(8025),s=e=>o.createElement(r.Page,{className:a.templatePageStyles["templates-page"],renderHeader:()=>o.createElement(o.Fragment,null),renderBody:()=>o.createElement(i.SampleAppsSection,{t:e.t,sampleAppPreviewDeepLinkData:e.deepLink,searchFilter:e.searchFilter,onSearchFilterUpdate:t=>e.onSearchFilterUpdate(t)})})},8024:function(e,t,n){"use strict";n.r(t),n.d(t,"templatePageStyles",(function(){return i}));var r=n(719),o=n(1259),a=Object(o.getResponsiveMode)(window)<o.ResponsiveMode.medium,i=Object(r.mergeStyleSets)({"templates-page":{height:"100%",margin:a?"0":"auto",width:a?"95%":"100%",selectors:{".ba-Pivot":{selectors:{".ms-Pivot":{paddingBottom:"10px"}}},".ba-CommandBar":{selectors:{".ms-CommandBar":{paddingLeft:"32px"}}},".ba-Page-Body":{padding:a?"0":"0 10px 0 32px",marginTop:"32px",width:"100%",selectors:{".sample-apps-section-component":{margin:"auto"},".sample-apps-list-tile-container":{maxWidth:"100%"}}}}}})},8025:function(e,t,n){"use strict";n.r(t),n.d(t,"SampleAppsSection",(function(){return E}));var r=n(4064),o=n(1259),a=n(687),i=n(1240),s=n(3767),l=n(3311),c=n(4185),p=n(7505),u=n(245),d=n(2871),m=n(7859),g=n(2879),h=n(8026),b=n(7866),f=n(7879),y=n(7910),S=n(7911),C=n(7867),v=n(8028),w=n(5655),O=n(8030),P=n(8027),E=e=>{var{t:t}=e,n=Object(s.useHideNonCanvasAppCreation)(),a=Object(o.getResponsiveMode)(window)<o.ResponsiveMode.medium,i=Object(l.getABTestCaseName)(c.UseSimplifiedAppFromBlankTest,d.featureGates.enableSimplifiedAppFromBlank)===p.SimplifiedAppFromBlankTestCase.Simplified;return u.createElement("div",{className:"sample-apps-section-component ms-Grid",style:a?{padding:"0"}:{}},u.createElement("div",{className:"sample-apps-section-component-header ms-Grid-row","aria-label":t("Home.SampleApps.Section.ariaLabel")},i?u.createElement("div",{style:{marginBottom:"42px"}},u.createElement(r.PageHeader,{title:t("TemplatesPage.titleSimplified")})):u.createElement("div",{className:P.sampleAppsSectionStyles.headerContainer},u.createElement(m.HeaderContainer,{title:t("TemplatesPage.titleUpdated")}))),u.createElement("div",null,d.featureGates.enableNewSampleAppExperience&&u.createElement(f.PartialModernSampleAppsSectionSimple,{hostPage:S.AppsSectionHostPage.Create,t:t}),!d.featureGates.enableNewSampleAppExperience&&i&&u.createElement(S.PartialSampleAppsSectionSimple,{hostPage:S.AppsSectionHostPage.Create,t:t}),!d.featureGates.enableNewSampleAppExperience&&!i&&u.createElement(u.Fragment,null,u.createElement("div",null,A(t("TemplatesPage.Sections.startFromBlankTitle"),t("TemplatesPage.Sections.startFromBlankTitleInfo")),L(t)),u.createElement("div",null,A(t("TemplatesPage.Sections.startFromDataTitle"),t("TemplatesPage.Sections.startFromDataTitleInfo")),T(t))),d.featureGates.enableNewSampleAppExperience?u.createElement(O.ModernStartFromTemplateSubsection,e):u.createElement(u.Fragment,null,u.createElement("div",{className:P.sampleAppsSectionStyles.root+" ms-Grid-row",style:a?{margin:"0"}:{}},A(t("TemplatesPage.Sections.startFromTemplatesTitle"),t("TemplatesPage.Sections.startFromTemplatesTitleInfo"),i),k(),R(e)),u.createElement("div",null,j(e,n)))))},A=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=n?P.sampleAppsSectionStyles.headerTitleSimple:P.sampleAppsSectionStyles.headerTitle;return u.createElement("div",{className:r,"aria-level":3},e,u.createElement("div",{className:P.sampleAppsSectionStyles.toolTipIcon},u.createElement(i.TooltipHost,{content:t,styles:{root:P.sampleAppsSectionStyles.headerInfoIcon}},u.createElement("span",{tabIndex:0,"aria-label":t},u.createElement(a.Icon,{iconName:g.fabricIcons.Info,role:"img"})))))},j=(e,t)=>u.createElement("div",null,u.createElement(C.SampleAppsListContainer,{searchFilter:e.searchFilter,sampleAppPreviewDeepLinkData:e.sampleAppPreviewDeepLinkData,appListSectionType:w.AppsListSectionName.StartFromTemplate,hideNonCanvasApps:t})),L=e=>u.createElement("div",null,u.createElement(y.PartialSampleAppsSection,{appListSectionType:w.AppsListSectionName.StartFromBlank,hideNavigationLink:!0,hideDefaultHeader:!0,t:e})),T=e=>u.createElement("div",null,u.createElement(b.PartialDataSourceAppsSection,{t:e,hideDefaultHeader:!0})),k=()=>u.createElement("div",{className:"sample-apps-section-component-header-pivots ms-lg-4",style:{display:"inline-block"}},u.createElement(v.SampleAppPivotsContainer,null)),R=e=>u.createElement("div",{className:P.sampleAppsSectionStyles.searchBoxContainer},u.createElement(h.TemplateAppsSearchBoxContainer,{onSearchFilterUpdate:e.onSearchFilterUpdate}))},8026:function(e,t,n){"use strict";n.r(t),n.d(t,"withTemplateAppsSearchBoxBehavior",(function(){return c})),n.d(t,"TemplateAppsSearchBoxContainer",(function(){return p}));var r=n(245),o=n.n(r),a=n(1252),i=n(2869),s=n(6607),l=n(8027);function c(e){return t=>{var n=Object(s.getSearchBoxProps)(t.onSearchFilterUpdate,Object(i.getResources)().TemplatesPage.SearchBoxUpdated.placeholder);return n.className=l.sampleAppsSectionStyles.searchBox,o.a.createElement(e,n)}}var p=c(a.SearchBox)},8027:function(e,t,n){"use strict";n.r(t),n.d(t,"sampleAppsSectionStyles",(function(){return s}));var r=n(719),o=n(5492),a=n(2882),i=n(1259),s=Object(r.mergeStyleSets)({root:{maxWidth:"1455px",padding:Object(i.getResponsiveMode)(window)<i.ResponsiveMode.medium?"0":"0 0 0 8px",fontFamily:o.fonts.segoeUi,color:a.fabricColors.neutralDark},headerContainer:{fontSize:"28px",fontWeight:"300",lineHeight:"37px"},headerTitle:{fontSize:"16px",fontWeight:"normal",lineHeight:"22px",marginBottom:"15px",padding:"0 5px 0 10px"},headerInfoIcon:{fontSize:"16px",lineHeight:"22px",marginLeft:"11px",verticalAlign:"bottom",cursor:"default"},searchBoxContainer:{float:"right",marginRight:"15px",marginBottom:"32px"},searchBox:{width:"212px",height:"32px",borderWidth:"0px 0px 1px 0px"},toolTipIcon:{display:"inline-block"},headerTitleSimple:{fontFamily:o.fonts.segoeUiSemibold,fontSize:"16px",color:a.fabricColors.neutralDark,marginBottom:"15px",lineHeight:"19px",padding:"0 5px 0 10px",width:"100%"}})},8028:function(e,t,n){"use strict";n.r(t),n.d(t,"mapStateToProps",(function(){return c})),n.d(t,"mapDispatchToProps",(function(){return p})),n.d(t,"SampleAppPivotsContainer",(function(){return u}));var r=n(5437),o=n(5659),a=n(7539),i=n(7490),s=n(5626),l=n(8029),c=e=>({sampleAppType:o.deriveSampleAppTypeBasedOnOptimizely(Object(s.optimizelyFlagsSelector)(e),Object(i.sampleAppType)(e))}),p=e=>({onPivotClicked:t=>e(a.sampleAppsActions.updateSampleAppType({sampleAppType:t}))}),u=Object(r.connect)(c,p)(l.SampleAppsPivots)},8029:function(e,t,n){"use strict";n.r(t),n.d(t,"SampleAppsPivots",(function(){return s}));var r=n(1709),o=n(245),a=n(5659),i=n(2869);class s extends o.Component{constructor(e){super(e),this.sampleAppPivotKeys={All:a.SampleAppType.All,Office:a.SampleAppType.Office,Dataverse:a.SampleAppType.Dataverse},this.resources=void 0,this.resources=Object(i.getResources)()}render(){return o.createElement("div",{className:"sample-apps-section-header-pivots"},o.createElement(r.Pivot,{defaultSelectedKey:a.SampleAppType[this.props.sampleAppType],onLinkClick:e=>this.props.onPivotClicked(this.sampleAppPivotKeys[e.props.itemKey])},o.createElement(r.PivotItem,{linkText:this.resources.SampleTile.Pivot.All.title,itemKey:a.SampleAppType[a.SampleAppType.All]}),o.createElement(r.PivotItem,{linkText:this.resources.SampleTile.Pivot.Office.title,itemKey:a.SampleAppType[a.SampleAppType.Office]})))}}},8030:function(e,t,n){"use strict";n.r(t),n.d(t,"ModernStartFromTemplateSubsection",(function(){return P}));var r=n(1259),o=n(687),a=n(1837),i=n(1240),s=n(923),l=n(245),c=n(5487),p=n(5659),u=n(5593),d=n(2879),m=n(8026),g=n(8031),h=n(8032),b=n(7896),f=n(5664),y=n(8033),S=n(7495),C=n(5663),v=n(7491),w=n(5655),O=n(8027),P=e=>{var{searchFilter:t,onSearchFilterUpdate:n}=e,{t:P}=Object(s.useTranslation)("PowerappsPortal"),[E,A]=l.useState(p.SampleAppType.All),{rootProps:j}=l.useContext(c.RootPropsContext),L=e=>{Object(u.trackUserActionClickButton)(S.ModernSampleAppsEvents.PivotClicked.eventName,{appType:e,modernExperience:!0}),A(e)},T=l.useCallback((e,t)=>{var n=O.sampleAppsSectionStyles.headerTitleSimple;return l.createElement(r.Stack,{horizontal:!0,tokens:{childrenGap:10}},l.createElement(r.StackItem,{shrink:!0},l.createElement(a.Text,{role:"heading",className:n},e)),l.createElement(i.TooltipHost,{content:t},l.createElement("span",{tabIndex:0,"aria-label":t},l.createElement(o.Icon,{iconName:d.fabricIcons.Info,ariaLabel:d.fabricIcons.Info}))))},[]),k=l.useCallback(()=>l.createElement(b.ModernSampleAppsList,{queries:[Object(h.TPSQueryOptions)({allowedPackageUniqueNames:Object.values(f.TPSSampleAppId)}),Object(g.CanvasAppQueryOptions)(j.currentEnvironment)],appListSectionType:w.AppsListSectionName.StartFromTemplate,sampleApps:Object(C.getModernSampleAppModules)(Object(v.getISampleAppModules)()),sampleAppTypeFilter:E,searchFilter:t,denyListedDisplayNames:f.DenyListCanvasApps,compareFn:Object(p.getModernSampleAppSorter)()}),[t,E]),R=l.useCallback(()=>l.createElement(m.TemplateAppsSearchBoxContainer,{onSearchFilterUpdate:n}),[]),D=l.useCallback(()=>l.createElement(y.ModernSampleAppsPivots,{sampleAppType:E,onPivotClicked:L}),[L,E]);return l.createElement(l.Fragment,null,T(P("TemplatesPage.Sections.startFromTemplatesTitle"),P("TemplatesPage.Sections.startFromTemplatesTitleInfo")),l.createElement(r.Stack,{horizontal:!0,wrap:!0,verticalAlign:"center",tokens:{maxWidth:1455}},l.createElement(r.StackItem,{grow:!0},D()),R()),k())}},8031:function(e,t,n){"use strict";n.r(t),n.d(t,"CanvasAppQueryOptions",(function(){return d}));var r=n(1146),o=n(5656),a=n(5597),i=n(5761),s=n(2872),l=n(5659);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var d=e=>({queryKey:"sampleapps_category_canvas",queryName:"sampleapps_category_canvas",queryFn:t=>m(e)}),m=e=>{var t=Object(i.addEndpointAndVersion)(a.sampleAppQueryUrl,s.settings,e);return r.default.get(t).then(e=>Object(l.groupSampleApps)(e.data.value).map(e=>p(p({},e),{},{sampleAppType:o.SampleAppTypes.Canvas})))}},8032:function(e,t,n){"use strict";n.r(t),n.d(t,"TPSQueryOptions",(function(){return l}));var r=n(1146),o=n(5656);function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var l=e=>({queryKey:"sampleapps_category_tps",queryName:"sampleapps_category_tps",queryFn:t=>c(e)}),c=e=>{var{allowedPackageUniqueNames:t}=e;return r.default.get("https://ppapi-tenant-level/appmanagement/applicationPackages?api-version=1").then(e=>e.data.value.filter(e=>t.includes(null==e?void 0:e.uniqueName)).map(e=>i(i({},e),{},{sampleAppType:o.SampleAppTypes.TPSModel})))}},8033:function(e,t,n){"use strict";n.r(t),n.d(t,"ModernSampleAppsPivots",(function(){return l}));var r=n(245),o=n(1709),a=n(5659),i=n(2869),s={All:a.SampleAppType.All,Dataverse:a.SampleAppType.Dataverse,Office:a.SampleAppType.Office},l=e=>{var{sampleAppType:t,onPivotClicked:n}=e,l=Object(i.getResources)();return r.createElement("div",null,r.createElement(o.Pivot,{defaultSelectedKey:a.SampleAppType[t],onLinkClick:e=>n(s[e.props.itemKey])},r.createElement(o.PivotItem,{linkText:l.SampleTile.Pivot.All.title,itemKey:a.SampleAppType[a.SampleAppType.All]}),r.createElement(o.PivotItem,{linkText:l.SampleTile.Pivot.Dataverse.title,itemKey:a.SampleAppType[a.SampleAppType.Dataverse]}),r.createElement(o.PivotItem,{linkText:l.SampleTile.Pivot.Office.title,itemKey:a.SampleAppType[a.SampleAppType.Office]})))}},8034:function(e,t,n){"use strict";n.r(t),n.d(t,"AiBuilderCreateDatabaseContainer",(function(){return s}));var r=n(5437),o=n(8035),a=n(5468),i=n(5478),s=Object(r.connect)(null,e=>({createDatabasePanel:()=>e(a.sharedActions.panelOpen({panelType:i.PanelToShowType.CreateXrmDatabasePanel,panelProps:null}))}))(o.AiBuilderCreateDatabase)},8035:function(e,t,n){"use strict";n.r(t),n.d(t,"AiBuilderCreateDatabase",(function(){return o}));var r=n(245),o=e=>(Object(r.useEffect)(()=>{e.createDatabasePanel()},[]),null)},8036:function(e,t,n){"use strict";n.r(t),n.d(t,"AiBuilderCreateEnvironmentContainer",(function(){return s}));var r=n(5437),o=n(8037),a=n(5468),i=n(5478),s=Object(r.connect)(null,e=>({createEnvironmentPanel:()=>e(a.sharedActions.panelOpen({panelType:i.PanelToShowType.CreateEnvironmentPanel,panelProps:null}))}))(o.AiBuilderCreateEnvironment)},8037:function(e,t,n){"use strict";n.r(t),n.d(t,"AiBuilderCreateEnvironment",(function(){return o}));var r=n(245),o=e=>(Object(r.useEffect)(()=>{e.createEnvironmentPanel()},[]),null)},8038:function(e,t,n){"use strict";n.r(t),n.d(t,"ProcessAdvisorCreateDatabaseContainer",(function(){return s}));var r=n(5437),o=n(8039),a=n(5468),i=n(5478),s=Object(r.connect)(null,e=>({createDatabasePanel:()=>e(a.sharedActions.panelOpen({panelType:i.PanelToShowType.CreateXrmDatabasePanel,panelProps:null}))}))(o.ProcessAdvisorCreateDatabase)},8039:function(e,t,n){"use strict";n.r(t),n.d(t,"ProcessAdvisorCreateDatabase",(function(){return o}));var r=n(245),o=e=>(Object(r.useEffect)(()=>{e.createDatabasePanel()},[]),null)},8040:function(e,t,n){"use strict";n.r(t),n.d(t,"mapStateToProps",(function(){return c})),n.d(t,"mapDispatchToProps",(function(){return p})),n.d(t,"mergeProps",(function(){return u})),n.d(t,"DialogContainer",(function(){return d}));var r=n(5437),o=n(5474),a=n(7985);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var c=e=>s({},e.shared.confirmDialog),p=e=>({onCancel:()=>e(Object(o.closeConfirmDialog)()),onClick:t=>e(Object(o.openNewTab)({uri:t}))}),u=(e,t)=>s(s(s({},e),t),{},{onCancel:()=>{var n;null===(n=e.onCancel)||void 0===n||n.call(e),t.onCancel()}}),d=Object(r.connect)(c,p,u)(a.ConfirmDialog)},8041:function(e,t,n){"use strict";n.r(t),n.d(t,"mapStateToProps",(function(){return p})),n.d(t,"entityAddSubcomponentsContainer",(function(){return u}));var r=n(5437),o=n(5487),a=n(5669),i=n(5583),s=n(5629),l=n(5691),c=n(8042);function p(e,t){var n=function(e){return e&&e.match&&e.match.params&&e.match.params.solutionId||""}(t),r=function(e){return e&&e.match&&e.match.params&&e.match.params.objectId||""}(t),o=Object(l.solutionSelector)(e,n);return{solutionId:n,solutionName:o&&o.uniquename,solutionComponentId:r,loadProgress:[Object(s.toLoadingState)(!0)]}}var u=Object(i.withNavigation)(Object(o.withRootProps)(Object(r.connect)(p)(Object(s.withLoadTelemetry)(c.EntityAddSubcomponents,a.LoadScenarioNames.EntitiesAddSubcomponents))))},8042:function(e,t,n){"use strict";n.r(t),n.d(t,"EntityAddSubcomponents",(function(){return d}));var r=n(245),o=n(5437),a=n(303),i=n(5686),s=n(2868),l=n(5593),c=n(5669);function p(e,t,n,r,o,a,i){try{var s=e[a](i),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}function u(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){p(a,r,o,i,s,"next",e)}function s(e){p(a,r,o,i,s,"throw",e)}i(void 0)}))}}var d=e=>{var{solutionId:t,solutionName:n,solutionComponentId:s}=e,p=Object(o.useDispatch)(),u=Object(a.useHistory)();return Object(r.useEffect)(()=>{(function(e,t){return m.apply(this,arguments)})(t,s).then(e=>{p(i.openDedicatedAddSubcomponentsPanel({solutionId:t,solutionName:n,component:e,onClosePanel:e=>{var t,n=null===(t=u.location.pathname)||void 0===t?void 0:t.replace("/subcomponents/".concat(s),"");e?(u.push("/"),u.replace(n)):u.push(n)}}))}).catch(e=>{Object(l.trackErrorTrace)(c.LoadScenarioNames.EntitiesAddSubcomponents,e)})},[]),null};function m(){return(m=u((function*(e,t){var n=yield s.MetadataClientInstance.getInstance();return(yield n.fetchList("SolutionComponentSummary",{solutionId:e},{filter:"(msdyn_objectid eq ".concat(t,")")},{scenarioName:s.MCLTelemetryEventsMap.PAPortalPrefix})).data[0]}))).apply(this,arguments)}},8043:function(e,t,n){"use strict";n.r(t),n.d(t,"mapStateToProps",(function(){return d})),n.d(t,"mapDispatchToProps",(function(){return m})),n.d(t,"AppModuleSharePanelWrapperPageContainer",(function(){return g}));var r=n(5437),o=n(5487),a=n(5669),i=n(5583),s=n(5629),l=n(5595),c=n(5811),p=n(8044);function u(e){return e&&e.match&&e.match.params&&e.match.params.environmentName||""}function d(e,t){var n=t&&t.match&&t.match.params&&t.match.params.manageTab||"",r=function(e){return e&&e.match&&e.match.params&&e.match.params.apps||""}(t),o=Object(c.appModuleSelector)(e,r),a=u(t),i=a&&Object(c.appModulesListError)(e,a),p=!!o;return{appModule:o,selectedPivot:n,currentEnvironmentName:u(t),loadProgress:[Object(s.toLoadingState)(p,i)],logEvent:l.CanvasAppLoadEvent,appName:r}}var m=e=>({dispatchTelemetry:e}),g=Object(i.withNavigation)(Object(o.withRootProps)(Object(r.connect)(d,m)(Object(s.withLoadTelemetry)(p.AppModuleSharePanelWrapperPage,a.LoadScenarioNames.AppModuleSharePanelWrapperPage))))},8044:function(e,t,n){"use strict";n.r(t),n.d(t,"AppModuleSharePanelWrapperPage",(function(){return c}));var r=n(245),o=n(5437),a=n(7619),i=n(5871),s=n(5651),l=n(303),c=e=>{var{appModule:t,appName:n}=e,[c,p]=Object(r.useState)(!0),u=Object(o.useDispatch)(),d=Object(l.useHistory)();return Object(r.useEffect)(()=>{u(i.appModulesActions.fetchAppModulesRequest({appModuleListFilter:s.AppModuleListType.Recent,forceRefresh:!0}))},[]),Object(r.useEffect)(()=>{n&&p(!0)},[n]),Object(r.useEffect)(()=>{var r;t&&c&&e.selectedPivot===a.AppManagementPivotNames.share&&(r=t,u(i.appModulesActions.shareAppModuleLegacy({appModule:r&&{id:r.id,name:r.name},onClosePanel:()=>{var e;d.replace(null===(e=d.location.pathname)||void 0===e?void 0:e.replace("appModel/".concat(n,"/share"),""))}})),p(!1))},[t&&c]),null}},8045:function(e,t,n){"use strict";n.r(t),n.d(t,"mapStateToProps",(function(){return h})),n.d(t,"mapDispatchToProps",(function(){return b})),n.d(t,"SharePanelWrapperPageContainer",(function(){return f}));var r=n(5629),o=n(5583),a=n(5487),i=n(5649),s=n(5595),l=n(5669),c=n(8046),p=n(5437),u=n(6012),d=n(219),m=n.n(d);function g(e){return e&&e.match&&e.match.params&&e.match.params.apps||""}function h(e,t){var n,o=t&&t.match&&t.match.params&&t.match.params.manageTab||"",a=m()(t.location.search,!0),l=!(null==a||null===(n=a.query)||void 0===n||!n.isadminscope),c=function(e){return e&&e.match&&e.match.params&&e.match.params.environmentName||""}(t),p=g(t),d=Object(u.getAppIdBasedOnScope)(p,c,l),h=Object(i.appSelector)(e,d),b=Object(i.appError)(e,d),f=!!h;return{app:h,selectedPivot:o,errorMessage:b,currentEnvironmentName:c,loadProgress:[Object(r.toLoadingState)(f,b)],logEvent:s.CanvasAppLoadEvent,appName:g(t),isAdminScope:l}}var b=e=>({dispatchTelemetry:e}),f=Object(o.withNavigation)(Object(a.withRootProps)(Object(p.connect)(h,b)(Object(r.withLoadTelemetry)(c.SharePanelWrapperPage,l.LoadScenarioNames.AppManagementPage))))},8046:function(e,t,n){"use strict";n.r(t),n.d(t,"SharePanelWrapperPage",(function(){return c}));var r=n(245),o=n(5437),a=n(7619),i=n(5648),s=n(5981),l=n(303),c=e=>{var{appName:t,app:n,isAdminScope:c}=e,[p,u]=Object(r.useState)(!0),d=Object(l.useHistory)(),m=Object(o.useDispatch)();return Object(r.useEffect)(()=>{var e;t&&(e=t,m(Object(i.fetchAppRequest)({appName:e,isAdminScope:c})),u(!0))},[t]),Object(r.useEffect)(()=>{var r;n&&p&&e.selectedPivot===a.AppManagementPivotNames.share&&(r=n,m(s.appsActions.openShareAppModal({app:r,onClosePanel:()=>{var e;d.replace(null===(e=d.location.pathname)||void 0===e?void 0:e.replace("canvasApp/".concat(t,"/share"),""))},isAdminScope:c})),u(!1))},[n&&p]),null}},9351:function(e,t,n){"use strict";n.r(t),n.d(t,"ConnectionManagement",(function(){return s}));var r=n(245),o=n.n(r),a=n(5901),i=n(9352),s=()=>{var e=Object(a.useEnvironmentCapabilities)();return o.a.createElement(i.ConnectionManagementPageContainer,{environmentCapabilities:e})}},9352:function(e,t,n){"use strict";n.r(t),n.d(t,"connectionUri",(function(){return E})),n.d(t,"mapStateToProps",(function(){return A})),n.d(t,"mapDispatchToProps",(function(){return j})),n.d(t,"mergeProps",(function(){return L})),n.d(t,"ConnectionManagementPageContainer",(function(){return T}));var r=n(5437),o=n(5597),a=n(5629),i=n(2880),s=n(5623),l=n(5796),c=n(5807),p=n(6866),u=n(7514),d=n(7634),m=n(9353),g=n(5669),h=n(5583),b=n(5487),f=["fetchConnectionRequestDispatch","fetchApisRequestDispatch"];function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){C(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function C(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function v(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function w(e){return e&&e.match&&e.match.params&&e.match.params.apiId||""}function O(e){return e&&e.match&&e.match.params&&e.match.params.connectionId||""}function P(e){return e&&e.match&&e.match.params&&e.match.params.tabName||""}var E="/providers/Microsoft.PowerApps/apis/{0}/connections/{1}";function A(e,t){var n=w(t),r=Object(i.formatResourceString)(o.ApiUri,n),s=Object(c.apiSelector)(e,r),l=O(t),p=Object(i.formatResourceString)(E,n,l),m=u.connectionSelector(e,p),g=!!m&&!!s,h=u.connectionErrors(e,p);return{api:s,connection:m,selectedPivot:P(t),errorMessage:h,loadProgress:[Object(a.toLoadingState)(g,h)],logEvent:d.ConnectionsManagementLoadEvent}}var j=(e,t)=>{var{navigate:n}=t;return{onHeaderClick:()=>t.navigate(s.connectionRoute,!0),fetchConnectionRequestDispatch:t=>{e(Object(p.fetchConnectionRequest)({connectionId:t}))},fetchApisRequestDispatch:()=>{e(Object(l.fetchApisRequest)())},onDismount:()=>{e(Object(p.fetchConnectionsCancelPoll)()),e(Object(l.fetchApisCancelPoll)())},openShareConnectionModal:t=>{e(Object(p.openShareConnectionModal)({connection:t,navigate:n}))},dispatchTelemetry:e}},L=(e,t,n)=>{var r,o,{fetchConnectionRequestDispatch:a,fetchApisRequestDispatch:s}=t,l=v(t,f),c=w(n),p=O(n),u=Object(i.formatResourceString)(E,c,p),{areShellProvidersReady:d}=n.rootProps;return S(S(S({onMount:()=>{a(u),s()},currentEnvironmentName:null==n||null===(r=n.match)||void 0===r||null===(o=r.params)||void 0===o?void 0:o.environmentName,environmentCapabilities:n.environmentCapabilities,dispatchTelemetry:t.dispatchTelemetry},e),l),{},{areShellProvidersReady:d})},T=Object(b.withRootProps)(Object(h.withNavigation)(Object(r.connect)(A,j,L)(Object(a.withLoadTelemetry)(m.ConnectionManagementPage,g.LoadScenarioNames.ConnectionManagementPage))))},9353:function(e,t,n){"use strict";n.r(t),n.d(t,"ConnectionManagementPage",(function(){return h}));var r=n(5629),o=n(4792),a=n(4105),i=n(1201),s=n(245),l=n(303),c=n(1200),p=n(3831),u=n(2869),d=n(5623),m=n(9354),g=n(9355);class h extends s.Component{constructor(e){super(e),this.breadCrumbItems=[],this.resources=void 0,this.resources=Object(u.getResources)(),this.state={searchFilter:"",redirectToConnectionsRoute:!1}}onSearchFilterUpdate(e){this.setState({searchFilter:e})}componentDidMount(){this.props.onMount()}componentWillUnmount(){this.props.onDismount()}render(){if(!this.props.areShellProvidersReady)return s.createElement(c.PagePlaceholder,null);var e=Object(r.getTotalLoadingState)(this.props.loadProgress);if(e===r.ComponentLoadState.Complete){if(this.initializeBreadCrumbItem(this.props.connection),this.state.redirectToConnectionsRoute){var t={fromPattern:p.RoutePaths.connectionManagement,toPattern:p.RoutePaths.connectionsList,toFriendlyRouteName:p.FriendlyRouteNames.connections};return s.createElement(l.Redirect,{push:!0,to:{pathname:Object(d.getConnectionsListUri)(this.props.currentEnvironmentName),state:t}})}return s.createElement(o.Page,{className:"connection-management-page",renderHeader:()=>s.createElement(m.ConnectionManagementCommandBarContainer,{connection:this.props.connection,api:this.props.api,selectedPivot:this.props.selectedPivot,onSearchFilterUpdate:this.onSearchFilterUpdate.bind(this),environmentCapabilities:this.props.environmentCapabilities}),renderTitle:()=>s.createElement(a.PageHeader,{wrapperClassName:"connection-management-page-breadcrumb",titleBreadcrumbProps:{items:this.breadCrumbItems,ariaLabel:this.resources.Connections.ConnectionManagement.Breadcrumbs.connections}}),renderBody:()=>s.createElement(g.ConnectionManagementPivotsContainer,{selectedConnection:this.props.connection,api:this.props.api,selectedPivot:this.props.selectedPivot,searchFilter:this.state.searchFilter})})}if(e===r.ComponentLoadState.Fail){var n={fromPattern:p.RoutePaths.connectionManagement,toPattern:p.RoutePaths.connectionsList,toFriendlyRouteName:p.FriendlyRouteNames.connections};return s.createElement(l.Redirect,{push:!0,to:{pathname:Object(d.getConnectionsListUri)(this.props.currentEnvironmentName),state:n}})}return s.createElement("div",{className:"connection-management-page"},s.createElement("div",{className:"connection-management-page-spinner"},s.createElement(i.Spinner,{size:i.SpinnerSize.large})))}initializeBreadCrumbItem(e){this.breadCrumbItems=[{text:this.resources.Connections.ConnectionManagement.Breadcrumbs.connections,key:this.resources.Connections.ConnectionManagement.Breadcrumbs.connections,onClick:()=>{this.props.onHeaderClick(),this.setState({redirectToConnectionsRoute:!0})}},{text:e.properties.displayName,key:e.id}]}}},9354:function(e,t,n){"use strict";n.r(t),n.d(t,"mapStateToProps",(function(){return g})),n.d(t,"mapDispatchToProps",(function(){return h})),n.d(t,"mergeProps",(function(){return b})),n.d(t,"ConnectedCommandBar",(function(){return f})),n.d(t,"ConnectionManagementCommandBarContainer",(function(){return y}));var r=n(1222),o=n(5437),a=n(6607),i=n(5630),s=n(5623),l=n(7509),c=n(7684),p=n(7634),u=n(7629),d=n(5583),m=n(5626),g=(e,t)=>({allowlistFeatures:Object(m.allowListFeaturesSelector)(e)}),h=(e,t)=>{var{navigate:n}=t;return{connectionCommandActions:{onConnectionEditClick:t=>{var n,r;return e(Object(i.logAction)(l.connectionsActions.editConnection({connection:t}),p.ConnectionsListMenuEvents.Edit.eventName,null===(n=(r=p.ConnectionsListMenuEvents.Edit).getData)||void 0===n?void 0:n.call(r,t)))},onConnectionShareClick:t=>{var r,o;return e(Object(i.logAction)(l.connectionsActions.openShareConnectionModal({connection:t,navigate:n}),p.ConnectionsListMenuEvents.Share.eventName,null===(r=(o=p.ConnectionsListMenuEvents.Share).getData)||void 0===r?void 0:r.call(o,t)))},onConnectionSwitchAccountClick:t=>{var n,r;return e(Object(i.logAction)(l.connectionsActions.consentConnection({connection:t}),p.ConnectionsListMenuEvents.Consent.eventName,null===(n=(r=p.ConnectionsListMenuEvents.Consent).getData)||void 0===n?void 0:n.call(r,t)))},onConnectionDeleteClick:t=>{var r,o;return e(Object(i.logAction)(l.connectionsActions.deleteConnection({connection:t,navigate:n,redirectUrl:s.connectionRoute}),p.ConnectionsListMenuEvents.Delete.eventName,null===(r=(o=p.ConnectionsListMenuEvents.Delete).getData)||void 0===r?void 0:r.call(o,t)))},onConnectionDetailsClick:t=>{var r,o;return e(Object(i.logAction)(l.connectionsActions.deleteConnection({connection:t,navigate:n}),p.ConnectionsListMenuEvents.Details.eventName,null===(r=(o=p.ConnectionsListMenuEvents.Details).getData)||void 0===r?void 0:r.call(o,t)))}}}};var b=(e,t,n)=>{var r;return{items:Object(c.getConnectionCommandBarCommands)(t.connectionCommandActions,e.allowlistFeatures,n.environmentCapabilities,n.connection,n.api,!0),isSearchBoxVisible:(r=n.selectedPivot,r===u.ConnectionManagementPivotNames.apps||r===u.ConnectionManagementPivotNames.flows),searchBoxProps:Object(a.getSearchBoxProps)(n.onSearchFilterUpdate)}},f=Object(o.connect)(g,h,b)(r.CommandBarWithSearchBox),y=Object(d.withNavigation)(f)},9355:function(e,t,n){"use strict";n.r(t),n.d(t,"mapDispatchToProps",(function(){return s})),n.d(t,"mergeProps",(function(){return l})),n.d(t,"ConnectionManagementPivotsContainer",(function(){return c}));var r=n(5437),o=n(5623),a=n(7629),i=n(5583),s=(e,t)=>({navigate:e=>t.navigate(e,!0)}),l=(e,t,n)=>{var r=n.selectedConnection;return{connection:r,api:n.api,selectedPivot:n.selectedPivot,onPivotClick:e=>{t.navigate(Object(o.getConnectionSubroute)(r.id,e))},searchFilter:n.searchFilter}},c=Object(i.withNavigation)(Object(r.connect)(null,s,l)(a.ConnectionManagementPivots))}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/7.dc67c3d1.chunk.js.map