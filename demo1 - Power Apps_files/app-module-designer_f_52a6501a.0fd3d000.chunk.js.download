/*! For license information please see app-module-designer~f~52a6501a.0fd3d000.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[348],{12291:function(e,t,o){"use strict";o.r(t);var r=o(12292);t.default=r.default},12292:function(e,t,o){"use strict";var r;o.r(t),o.d(t,"SyncMessageTypes",(function(){return r})),o.d(t,"default",(function(){return n})),function(e){e[e.SyncMessageRequest=0]="SyncMessageRequest",e[e.SyncMessageResponse=1]="SyncMessageResponse",e[e.HandshakeRequest=2]="HandshakeRequest",e[e.HandshakeAck=3]="HandshakeAck"}(r||(r={}));class n{constructor(e,t,o,n){this.Ready=void 0,this._outboundMessageId=void 0,this._targetWindow=void 0,this._targetDomain=void 0,this._channelId=void 0,this._displayName=void 0,this._messageHandler=void 0,this._onReady=void 0,this._outboundMessageHandlers={},this.powerAppsRegExp=/\.powerapps\.com$/,this.listener=void 0,this._targetDomain=t,this._channelId=e,this._targetWindow=n,this._displayName=o,this.Ready=new Promise((e,t)=>{this._onReady={resolve:e,reject:t}}),this._outboundMessageId=1,this.listener=e=>{var t;if(this.validateMessageOrigin(e)&&e.data&&void 0!==e.data.messageType){var o=e.data;switch(o.messageType){case r.HandshakeRequest:if(o.messageData&&o.messageData.channelId===this._channelId){this._targetWindow=e.source;var n=this.createMessage({channelId:this._channelId},r.HandshakeAck);n.sourceId=o.messageId,this._send(n),this._onReady.resolve("")}break;case r.HandshakeAck:o.messageData&&o.messageData.channelId===this._channelId&&o.sourceId&&this._outboundMessageHandlers[o.sourceId]&&(this._outboundMessageHandlers[o.sourceId].resolve(o.messageData),this._onReady.resolve(""));break;case r.SyncMessageRequest:var i=null===(t=this._messageHandler)||void 0===t?void 0:t.call({},o.messageData);null==i||i.then(e=>{var t=this.createMessage(e,r.SyncMessageResponse);t.sourceId=o.messageId,this._send(t)});break;case r.SyncMessageResponse:o.sourceId&&this._outboundMessageHandlers[o.sourceId]&&(this._outboundMessageHandlers[o.sourceId].resolve(o.messageData),delete this._outboundMessageHandlers[o.sourceId]);break;default:throw new Error("Unsupported message type")}}},window.addEventListener("message",this.listener),n&&this.handshake()}teardown(){window.removeEventListener("message",this.listener)}ChannelId(){return this._channelId}send(e){return this.Ready.then(()=>{var t=this.createMessage(e,r.SyncMessageRequest),o=new Promise((e,o)=>{this._outboundMessageHandlers[t.messageId]={resolve:e,reject:o}});return this._send(t),o})}onReceive(e){this._messageHandler=e}validateMessageOrigin(e){return"*"===this._targetDomain?!!this.powerAppsRegExp.test(this.removeTrailingSlash(e.origin)):this.removeTrailingSlash(e.origin)===this.removeTrailingSlash(this._targetDomain)}removeTrailingSlash(e){return e.replace(/\/$/,"")}handshake(){var e={channelId:this._channelId},t=this.createMessage(e,r.HandshakeRequest),o=new Promise((e,o)=>{this._outboundMessageHandlers[t.messageId]={resolve:e,reject:o}});return this._send(t),o}createMessage(e,t){return{messageId:this._outboundMessageId++,messageType:t,messageData:e}}_send(e){if(!this._targetWindow)throw new Error("lost the target window");this._targetWindow.postMessage(e,this._targetDomain)}}},12303:function(e,t,o){"use strict";o.r(t),o.d(t,"UCIPreview",(function(){return p}));o(4135);var r,n=o(217),i=(o(687),o(1864),o(1090),o(1697),o(1201)),s=o(245),a=o(12304),l=o(684),c=o(719);!function(e){e.InitLoading="InitLoading",e.NeedsAccessCheck="NeedsAccessCheck",e.LoadingPostAccessCheck="LoadingPostAccessCheck",e.Failed="LoadingFailed",e.Ready="Ready"}(r||(r={}));var h=Object(c.getTheme)(),d=Object(c.mergeStyleSets)({loadingOverlay:{width:"100%",height:"100%",display:"flex",justifyContent:"center",position:"absolute",backgroundColor:h.palette.white,top:0,left:0,zIndex:10},checkStatusHeading:{marginTop:33,fontWeight:c.FontWeights.semibold,fontSize:c.FontSizes.size18,textAlign:"center"},checkStatusSummary:{marginTop:20,color:h.palette.neutralDark,fontWeight:c.FontWeights.regular,fontSize:c.FontSizes.size14,textAlign:"center"},checkStatusButton:{marginTop:28},spinnerCheckStatusContainer:{position:"absolute",top:"50%",display:"flex",flexDirection:"column",justifyContent:"center",alignContent:"center"},buttonContainer:{marginTop:34,display:"flex",justifyContent:"center"}});class p extends s.PureComponent{constructor(e){var t;super(e),t=this,this.loadingTimeout=void 0,this.renderLoadingScreen=()=>{if(this.state.loadingState===r.Ready)return s.createElement(s.Fragment,null);var e=s.createElement(s.Fragment,null,s.createElement("h1",{id:"checkAccess",className:d.checkStatusHeading},this.props.strings.checkAccessTitle),s.createElement("p",{className:d.checkStatusSummary},this.props.strings.checkAccessContent),s.createElement("div",{className:d.buttonContainer},s.createElement(l.DefaultButton,{primary:!0,ariaLabel:this.props.strings.checkAccessButtonText,onClick:this.onCheckAccess},this.props.strings.checkAccessButtonText))),t=s.createElement(s.Fragment,null,s.createElement("h1",{id:"loadingFailed",className:d.checkStatusHeading},this.props.strings.loadFailedTitle),s.createElement("p",{className:d.checkStatusSummary},this.props.strings.loadFailedContent)),o=s.createElement(i.Spinner,{size:i.SpinnerSize.large,label:this.props.strings.loadingSpinnerLabel});return s.createElement("div",{id:"loadingOverlay",className:d.loadingOverlay},s.createElement("div",{className:d.spinnerCheckStatusContainer},this.state.loadingState===r.Failed?t:o,this.state.loadingState===r.NeedsAccessCheck?e:null))},this.renderDebugMessageBar=()=>s.createElement(s.Fragment,null),this.initializePreview=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],o=Object(n.trackLoadScenario)(t.props.surfaceScope,"UCIPreview/initializePreview",{loadingState:t.state.loadingState}),i=e?t.props.reinitializePreview():t.props.initializePreview(),s=i.then(()=>{o.complete({loadingState:t.state.loadingState}),t.setState({loadingState:r.Ready})}).catch(e=>{o.failure({loadingState:t.state.loadingState,error:null==e?void 0:e.message}),t.setState({loadingState:r.Failed})});return setTimeout(()=>{t.state.loadingState===r.LoadingPostAccessCheck?(o.failure({loadingState:t.state.loadingState,reason:"failed"}),t.setState({loadingState:r.Failed})):t.state.loadingState===r.InitLoading&&(o.failure({reason:"needsAccessCheck",loadingState:t.state.loadingState}),t.setState({loadingState:r.NeedsAccessCheck}))},t.loadingTimeout),s},this.refreshPreview=()=>(Object(n.trackInfoTrace)(this.props.surfaceScope,{eventName:"UCIPreview/refreshPreview"}),this.initializePreview(!0)),this.onVisibilityChange=()=>{Object(n.trackInfoTrace)(this.props.surfaceScope,{eventName:"UCIPreview/onVisibilityChange",eventData:{visible:document.visibilityState}}),"visible"===document.visibilityState&&(this.setState({loadingState:r.LoadingPostAccessCheck}),this.refreshPreview(),document.removeEventListener("visibilitychange",this.onVisibilityChange))},this.onCheckAccess=()=>{Object(n.trackInfoTrace)(this.props.surfaceScope,{eventName:"UCIPreview/onCheckAccess"}),window.open(this.props.orgUrl),document.addEventListener("visibilitychange",this.onVisibilityChange)},this.state={loadingState:r.InitLoading,showLoadingScreen:!0},this.loadingTimeout=e.loadingTimeout||6e4,this.initializePreview()}render(){var e=s.createElement(a.EmbeddedUCI,{uciUrl:this.props.uciUrl,orgUrl:this.props.orgUrl});return s.createElement(s.Fragment,null,e,this.renderDebugMessageBar(),this.state.showLoadingScreen?this.renderLoadingScreen():null)}}p.displayName="UCIPreview"},12304:function(e,t,o){"use strict";o.r(t),o.d(t,"EmbeddedUCI",(function(){return p}));var r=o(245),n=o.n(r),i=o(479),s=o(217);function a(e,t,o,r,n,i,s){try{var a=e[i](s),l=a.value}catch(c){return void o(c)}a.done?t(l):Promise.resolve(l).then(r,n)}function l(e){return function(){var t=this,o=arguments;return new Promise((function(r,n){var i=e.apply(t,o);function s(e){a(i,r,n,s,l,"next",e)}function l(e){a(i,r,n,s,l,"throw",e)}s(void 0)}))}}var c="tokenRequestMessage",h="tokenAckMessage",d="tokenResponseMessage";class p extends n.a.PureComponent{constructor(){var e;super(...arguments),e=this,this.previewIframeRef=n.a.createRef(),this.authenticateUCIScenario=void 0,this.tokenExchangeStarted=!1,this.authenticationCount=1,this.onTokenExchangeMessageReceived=e=>{var t=new URL(this.props.orgUrl),o=new URL(e.origin);if(t.origin===o.origin){var r=e.data;(null==r?void 0:r.message)===h&&(Object(s.trackInfoTrace)("EmbeddedUCI",{eventName:"EmbeddedUCI/tokenAckReceived"}),this.onTokenAck(r.payload)),(null==r?void 0:r.message)===c&&(this.tokenExchangeStarted=!0,Object(s.trackInfoTrace)("EmbeddedUCI",{eventName:"EmbeddedUCI/tokenRequestReceived",eventData:{authenticationCount:this.authenticationCount}}),this.sendToken())}},this.sendToken=l((function*(){var t=yield Object(i.acquireTokenAsync)(e.props.orgUrl,""),o={token:t.accessToken,expiration:t.expiresOn.getTime()},r={message:d,payload:o};if(!e.previewIframeRef.current){var n;throw null===(n=e.authenticateUCIScenario)||void 0===n||n.failure({eventName:"EmbeddedUCI/sendToken",reason:"No preview iframe found"}),new Error("No preview iframe found")}e.previewIframeRef.current.contentWindow.postMessage(r,"*"),Object(s.trackInfoTrace)("EmbeddedUCI",{eventName:"EmbeddedUCI/sendToken",eventData:{expiration:o.expiration}})})),this.onTokenAck=e=>{if(e.success){var t;null===(t=this.authenticateUCIScenario)||void 0===t||t.complete({authenticationCount:this.authenticationCount})}else{var o,r="UCI Token Exchange failed: ".concat(e.error);null===(o=this.authenticateUCIScenario)||void 0===o||o.failure({eventName:"EmbeddedUCI/onTokenAck",reason:r,authenticationCount:this.authenticationCount})}this.authenticationCount++}}componentDidMount(){this.authenticateUCIScenario=Object(s.trackLoadScenario)("EmbeddedUCI","AuthenticateUCI"),window.addEventListener("message",this.onTokenExchangeMessageReceived);setTimeout(()=>{if(!this.tokenExchangeStarted){var e;null===(e=this.authenticateUCIScenario)||void 0===e||e.failure({reason:"No token exchange message received before timeout (2 minutes)"}),window.removeEventListener("message",this.onTokenExchangeMessageReceived)}},12e4)}componentWillUnmount(){window.removeEventListener("message",this.onTokenExchangeMessageReceived)}render(){return n.a.createElement("iframe",{ref:this.previewIframeRef,tabIndex:-1,title:"UCI Preview",style:{height:"100%",width:"100%"},id:"embeddedUCI",src:this.props.uciUrl,role:"presentation","aria-hidden":!0,sandbox:"allow-forms allow-same-origin allow-scripts"})}}},12307:function(e,t,o){"use strict";o.r(t);var r=o(12308);o.d(t,"Canvas",(function(){return r.Canvas}))},12308:function(e,t,o){"use strict";o.r(t),o.d(t,"Canvas",(function(){return s}));var r=o(245),n=o(12309),i=o(12310);class s extends r.Component{constructor(e){super(e)}render(){var{rootCanvasElement:e,scale:t=1,shouldShowAdorners:o,shouldShowScrollbars:s}=this.props,a=e?r.createElement(i.CanvasElementDragSource,e):null,l={position:"absolute",top:0,left:0,width:"100%",height:"100%"};this.props.allowInteractionWithChildren&&(l.pointerEvents="none");var c=r.createElement("div",{style:l},r.createElement(n.CanvasContextProvider,{selectedNodes:this.props.selectedIds,onSelect:this.props.onElementSelected,onScroll:this.props.onScroll,onClickPassThrough:this.props.onClickPassThrough,scale:t,allowDrop:this.props.allowDrop,allowDrag:this.props.allowDrag,shouldShowAdorners:o,shouldShowScrollbars:s,onElementDropped:this.props.onElementMoved,cutNodeId:this.props.cutElementId},a));return r.createElement("div",{style:{width:"100%",height:"100%"}},this.props.children,c)}}},12309:function(e,t,o){"use strict";o.r(t),o.d(t,"StateConsumer",(function(){return s})),o.d(t,"CanvasContextProvider",(function(){return a}));var r=o(245),n={selectNode:()=>{},clickThroughNode:()=>{},onScroll:()=>{},isSelectedNode:()=>!1,isCutNode:()=>!1,draggerSize:6,allowDrop:!0,allowDrag:!0,shouldShowAdorners:!1,shouldShowScrollbars:!1},i=r.createContext(n),s=i.Consumer;class a extends r.Component{constructor(){super(...arguments),this.onScroll=(e,t,o)=>{setTimeout(()=>{this.props.onScroll&&this.props.onScroll(e,t,o)})},this.selectNode=(e,t)=>{this.props.onSelect&&this.props.onSelect(e)},this.clickThroughNode=(e,t)=>{t&&t.clickPassThrough&&setTimeout(()=>{this.props.onClickPassThrough&&this.props.onClickPassThrough(e)})},this.isSelectedNode=e=>!(!this.props.selectedNodes||!this.props.selectedNodes.has(e)),this.isCutNode=e=>this.props.cutNodeId===e}render(){var e={selectNode:this.selectNode,clickThroughNode:this.clickThroughNode,onScroll:this.onScroll,isSelectedNode:this.isSelectedNode,draggerSize:6/this.props.scale,allowDrop:this.props.allowDrop,allowDrag:this.props.allowDrag,onElementDropped:this.props.onElementDropped,shouldShowScrollbars:this.props.shouldShowScrollbars,shouldShowAdorners:this.props.shouldShowAdorners,isCutNode:this.isCutNode};return r.createElement(i.Provider,{value:e},this.props.children)}}},12310:function(e,t,o){"use strict";o.r(t),o.d(t,"CanvasElementDragSource",(function(){return a}));var r=o(3857),n=o(12311),i=o(12312),s={beginDrag:e=>({id:e.id,iconSvgId:e.iconName,label:e.label||""}),endDrag(e,t){var o=t.getDropResult();o&&e.onElementDropped&&e.onElementDropped(o.id,o.position)}},a=Object(r.DragSource)(n.ElementDragSourceType,s,(e,t)=>({connectDragSource:e.dragSource(),isDragging:t.isDragging()}))(i.CanvasElement)},12312:function(e,t,o){"use strict";o.r(t),o.d(t,"CanvasElement",(function(){return v}));var r=o(687),n=o(719),i=o(245),s=o(12313),a=o(12311),l=o(12309),c=o(12310),h=o(12316),d=o(12321),p=o(12322);function u(){return(u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r])}return e}).apply(this,arguments)}var m=Object(n.getTheme)(),g=Object(n.mergeStyleSets)({canvasElement:{position:"absolute"},selectedElement:{borderColor:m.palette.themePrimary,borderWidth:1.5,borderStyle:"solid"},highlightedElement:{backgroundColor:"rgba(237, 202, 237, 0.2)"},markedElement:{borderColor:m.palette.themePrimary,borderStyle:"dashed",borderWidth:1.5},badgeIcon:{position:"absolute",top:0,right:8,fontSize:20}});class v extends i.Component{constructor(){super(...arguments),this.state={draggedItemHoverOnBefore:!1,draggedItemHoverOnAfter:!1,canDropItem:a.DropTargetCompatibility.None},this.itemHoverTimeout=void 0,this.selectElement=e=>{e.selectNode(this.props.id,this.props.behavior)},this.handleOnClick=(e,t)=>{e.stopPropagation(),this.props.interactionId&&this.props.behavior.clickPassThrough&&t.clickThroughNode(this.props.interactionId,this.props.behavior),this.props.behavior&&this.props.behavior.cannotSelect||this.selectElement(t)},this.handleOnKeypress=(e,t)=>{"Enter"!==e.key&&13!==e.which&&13!==e.keyCode||(e.stopPropagation(),this.props.behavior&&this.props.behavior.cannotSelect||this.selectElement(t))}}render(){var{id:e,children:t,dimension:o,scrollContainer:n}=this.props,m=n&&n.scrollHeight||0,v=n&&n.scrollWidth||0,f=n&&n.scrollLeft||0,b=n&&n.scrollTop||0,w={top:o.top,left:o.left,width:o.width,height:o.height,zIndex:o.zIndex},S=g.canvasElement+" ";return i.createElement(l.StateConsumer,null,n=>{var l=u({},n),{shouldShowAdorners:C,shouldShowScrollbars:y}=l,I=!!y&&Math.round(m-o.height)>5,E=!!y&&Math.round(v-o.width)>5,k=t&&t.map(e=>e&&i.createElement(c.CanvasElementDragSource,u({key:"".concat(e.id).concat(e.id===this.props.id?"-sub":"")},e,{onElementDropped:(t,o)=>this.handleElementDropped(l,e.id,t,o)}))),T=l.isSelectedNode(e),D=null;C&&(T&&w.width&&w.height&&!1!==this.props.behavior.boxWhenSelected&&(S+="".concat(g.selectedElement+" "," ")),S+="".concat(this.props.isDragging||l.isCutNode(e)?g.markedElement+" ":""," "),this.props.behavior.badgeName&&(D=i.createElement(r.Icon,{iconName:this.props.behavior.badgeName,styles:{root:g.badgeIcon},style:{top:w.height>40?"6px":"2px"}})));var O=this.state.draggedItemHoverOnBefore||this.state.draggedItemHoverOnAfter;S+="".concat(O&&this.state.canDropItem!==a.DropTargetCompatibility.None?g.highlightedElement:""," ");var N={},P=this.props.behavior.indicateWhenSelected&&T&&C;if(l.allowDrop&&O||P)if(this.state.canDropItem===a.DropTargetCompatibility.AsPeer||P){var x=this.state.draggedItemHoverOnBefore||P;if(this.state.draggedItemHoverOnAfter)switch(this.props.behavior.insertionOrientation){case"row":N.borders={bottom:!0},N.carets={bottomLeft:"right"};break;case"column":N.borders={right:!0},N.carets={bottomRight:"up"}}else if(x)switch(this.props.behavior.insertionOrientation){case"row":N.borders={top:!0},N.carets={topLeft:"right"};break;case"column":N.borders={left:!0},N.carets={bottomLeft:"up"}}}else this.state.canDropItem===a.DropTargetCompatibility.None&&(this.props.behavior.clickPassThrough?N.isClickThroughTarget=!0:N.isInvalidTarget=!0);var R=i.createElement("div",{id:"".concat(d.CanvasDOMIdPrefix).concat(e)+"-".concat(this.props.interactionId),tabIndex:this.props.behavior.cannotFocus?-1:0,key:e,className:S,style:w,onClick:e=>{this.handleOnClick(e,l)},onKeyPress:e=>{this.handleOnKeypress(e,l)},title:this.props.label,"data-id":this.props.dataId,role:this.props.role,"aria-selected":T},i.createElement(s.DropHints,N,l.allowDrop?(e=>i.createElement(i.Fragment,null,i.createElement(h.CanvasElementDropTarget,{position:"before",orientation:e,canvasElementProps:this.props,onItemOverChanged:(e,t,o)=>this.onItemOverDropTargetChanged(e,t,o,"before",l)}),i.createElement(h.CanvasElementDropTarget,{position:"after",orientation:e,canvasElementProps:this.props,onItemOverChanged:(e,t,o)=>this.onItemOverDropTargetChanged(e,t,o,"after",l)})))(this.props.behavior.insertionOrientation||"row"):i.createElement(i.Fragment,null),i.createElement(p.ScrollContainer,{showHScrollbar:E,showVScrollbar:I,scrollHeight:m,scrollWidth:v,scrollLeft:f,scrollTop:b,onScroll:(t,o)=>l.onScroll(this.props.interactionId||e,t,o)}),D,k));return l.allowDrag&&!this.props.behavior.cannotDrag?this.props.connectDragSource(R):R})}handleElementDropped(e,t,o,r){e.onElementDropped&&e.onElementDropped(t,o,r)}onItemOverDropTargetChanged(e,t,o,r,n){var i=Object(h.isValidTarget)(t,o,this.props);"after"===r?this.setState({draggedItemHoverOnAfter:e,canDropItem:i}):this.setState({draggedItemHoverOnBefore:e,canDropItem:i}),e?this.itemHoverTimeout||(this.itemHoverTimeout=window.setTimeout(()=>{(this.state.draggedItemHoverOnBefore||this.state.draggedItemHoverOnAfter)&&n.clickThroughNode(this.props.interactionId||this.props.id,this.props.behavior),this.itemHoverTimeout=void 0},500)):!this.itemHoverTimeout||this.state.draggedItemHoverOnAfter||this.state.draggedItemHoverOnBefore||(clearTimeout(this.itemHoverTimeout),this.itemHoverTimeout=void 0)}}},12316:function(e,t,o){"use strict";o.r(t),o.d(t,"isValidTarget",(function(){return h})),o.d(t,"CanvasElementDropTarget",(function(){return p}));var r=o(719),n=o(245),i=o(3857),s=o(12317),a=o(12311),l=Object(r.mergeStyleSets)({root:{position:"absolute",width:"100%",borderWidth:0},rowTarget:{height:"50%",width:"100%",left:0},columnTarget:{height:"100%",width:"50%",top:0},rowTopTarget:{top:0,borderTopWidth:1.5},rowBottomTarget:{bottom:0,borderBottomWidth:1.5},columnLeftTarget:{left:0,borderLeftWidth:1.5},columnRightTarget:{right:0,borderRightWidth:1.5}});class c extends n.Component{componentDidUpdate(e){this.props.isOverDirectly!==e.isOverDirectly&&this.props.onItemOverChanged&&this.props.onItemOverChanged(this.props.isOverDirectly,this.props.itemType,this.props.item)}render(){var e=l.root;switch(this.props.orientation){case"row":switch(e+=" "+l.rowTarget,this.props.position){case"after":e+=" "+l.rowBottomTarget;break;case"before":e+=" "+l.rowTopTarget}break;case"column":switch(e+=" "+l.columnTarget,this.props.position){case"after":e+=" "+l.columnRightTarget;break;case"before":e+=" "+l.columnLeftTarget}}return this.props.connectDropTarget(n.createElement("div",{className:e}))}}function h(e,t,o){switch(e){case a.ElementDragSourceType:if(t.id===o.id)return a.DropTargetCompatibility.None;if(o.behavior&&o.behavior.canDropElement)return o.behavior.canDropElement(t.id);break;case s.ComponentItemDragSourceType:if(o.behavior&&o.behavior.canDropComponent)return o.behavior.canDropComponent(t.id)}return a.DropTargetCompatibility.None}var d={drop(e,t){if(!t.didDrop())return{id:e.canvasElementProps.id,position:e.position}},canDrop:(e,t)=>h(t.getItemType(),t.getItem(),e.canvasElementProps)!==a.DropTargetCompatibility.None},p=Object(i.DropTarget)([s.ComponentItemDragSourceType,a.ElementDragSourceType],d,(e,t)=>({connectDropTarget:e.dropTarget(),isOver:t.isOver(),canDrop:t.canDrop(),isOverDirectly:t.isOver({shallow:!0}),item:t.getItem(),itemType:t.getItemType()}))(c)},12321:function(e,t,o){"use strict";o.r(t),o.d(t,"CanvasDOMIdPrefix",(function(){return r}));var r="canvas-"},12322:function(e,t,o){"use strict";o.r(t),o.d(t,"ScrollContainer",(function(){return i}));var r=o(245),n=o.n(r),i=e=>{var t=e.showVScrollbar&&e.scrollHeight&&n.a.createElement("div",{style:{width:1,height:e.scrollHeight}}),o=e.showHScrollbar&&e.scrollWidth&&n.a.createElement("div",{style:{width:e.scrollWidth,height:1}});if(t||o){return n.a.createElement("div",{className:"scroll-container",style:s,onScroll:t=>{var o=t.target;e.onScroll&&e.onScroll(o.scrollLeft,o.scrollTop)},onClick:e=>{e.stopPropagation();var t=e.target.parentElement;t&&t.click()}},o,t)}return null},s={position:"absolute",top:0,left:0,height:"100%",width:"100%",overflow:"auto"}},12323:function(e,t,o){"use strict";o.r(t),o.d(t,"CanvasFooter",(function(){return l}));var r=o(719),n=o(245),i=o(8061),s=Object(r.getTheme)(),a=Object(r.mergeStyleSets)({root:{backgroundColor:s.palette.neutralLighter,display:"flex",justifyContent:"space-between",height:28,flexShrink:0,padding:"0px 16px"},leftChild:{flexGrow:1,display:"flex",justifyContent:"flex-start"},rightChild:{flexGrow:1,display:"flex",justifyContent:"flex-end"}});class l extends n.Component{constructor(e){super(e),this.footerAreaRef=void 0,this.observer=void 0,this.footerAreaRef=n.createRef(),this.observer=new i.default(e=>{var t;if(this.props.onWidthChanged&&(null==e?void 0:e.length)>0&&null!==(t=e[0])&&void 0!==t&&t.contentRect){var o,r,n=e[0].contentRect.width;null===(o=(r=this.props).onWidthChanged)||void 0===o||o.call(r,n)}})}componentDidMount(){var e;this.footerAreaRef.current&&(null===(e=this.observer)||void 0===e||e.observe(this.footerAreaRef.current))}componentWillUnmount(){var e;null===(e=this.observer)||void 0===e||e.disconnect()}render(){return n.createElement("div",{ref:this.footerAreaRef,className:a.root},n.createElement("div",{className:a.leftChild},this.props.onRenderLeftContent),n.createElement("div",{className:a.rightChild},this.props.onRenderRightContent))}}},12324:function(e,t,o){"use strict";o.r(t),o.d(t,"viewportHeightDesktop",(function(){return n})),o.d(t,"viewportHeightTablet",(function(){return i})),o.d(t,"viewportHeightPhone",(function(){return s})),o.d(t,"getAvailableViewPorts",(function(){return a}));var r=o(545),n=1080,i=1024,s=731,a=Object(r.memoizeFunction)((e,t)=>({desktop:{name:e("viewPorts.desktop"),size:{height:n,width:1920},iconProps:{iconName:"TVMonitor"}},tablet:{name:e("viewPorts.tablet"),size:{height:768,width:1024},iconProps:{iconName:"Tablet"}},mobile:{name:e("viewPorts.phone"),size:{height:731,width:411},iconProps:{iconName:"CellPhone"}},responsive:{name:e("viewPorts.responsive"),size:t||{height:800,width:800},iconProps:{iconName:"SizeLegacy"}}}))},12325:function(e,t,o){"use strict";o.r(t),o.d(t,"ViewPortSwitcher",(function(){return h}));var r=o(687),n=o(1567),i=o(719),s=o(245),a=Object(i.getTheme)(),l=Object(i.mergeStyleSets)({flexContainer:{display:"flex",flexWrap:"nowrap",alignItems:"center"},icon:{color:a.palette.themePrimary,fontSize:14,lineHeight:16,padding:0,margin:"0px 8px 0px 0px"},slimModeIcon:{color:a.palette.themePrimary,fontSize:14,padding:0}}),c={dropdown:{height:"100%",fontSize:12,selectors:{":focus:after":{outline:"1px solid",outlineColor:a.palette.neutralSecondary,border:"none",borderRadius:0}}},title:{border:"none",backgroundColor:"transparent"},dropdownItem:{fontSize:12},dropdownItemSelected:{fontSize:12},caretDownWrapper:{paddingTop:0}};class h extends s.Component{constructor(){super(...arguments),this.onDropdownChanged=(e,t)=>{this.props.onViewPortChange&&t&&this.props.onViewPortChange(t.key)},this.onRenderTitle=e=>{var t;return e?(t=e.length?e[0]:e,this.props.isSlimMode?s.createElement("div",{className:l.flexContainer},t.data&&t.data.icon&&s.createElement(r.Icon,{className:l.slimModeIcon,iconName:t.data.icon,"aria-hidden":"true"})):this.onRenderOption(t)):s.createElement(s.Fragment,null)},this.onRenderOption=e=>e?s.createElement("div",{className:l.flexContainer},e.data&&e.data.icon&&s.createElement(r.Icon,{className:l.icon,iconName:e.data.icon,"aria-hidden":"true"}),s.createElement("span",null,e.text)):s.createElement(s.Fragment,null),this.onRenderCaretDown=()=>s.createElement(r.Icon,{iconName:"ChevronDown"})}render(){return s.createElement(n.Dropdown,{options:this.getDropdownItems(),selectedKey:this.props.selectedViewPortKey,onChange:this.onDropdownChanged,onRenderTitle:this.onRenderTitle,onRenderOption:this.onRenderOption,onRenderCaretDown:this.onRenderCaretDown,dropdownWidth:"auto",styles:c,disabled:this.props.isDisabled,ariaLabel:this.props.t("viewPortDropdown.viewPortDropdownAriaLabel")})}getViewPortText(e){return e?this.props.t("viewPortDropdown.displayText",{viewPort:e.name,width:e.size.width,height:e.size.height}):""}getDropdownItems(){var e=[];for(var t in this.props.availableViewPorts)if(this.props.availableViewPorts.hasOwnProperty(t)){var o=this.props.availableViewPorts[t],r=this.getViewPortText(o);e.push({key:t,text:r,ariaLabel:r,data:{icon:o.iconProps?o.iconProps.iconName:""}})}return e}}},12326:function(e,t,o){"use strict";o.r(t),o.d(t,"ZoomSlider",(function(){return f}));var r=o(1789),n=o(684),i=o(1782),s=o(719),a=o(245);function l(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,r)}return o}function c(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?l(Object(o),!0).forEach((function(t){h(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):l(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function h(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var d=Object(s.getTheme)(),p=Object(s.mergeStyles)({selectors:{"@media screen and (-ms-high-contrast: active)":{fill:d.palette.white},"@media screen and (-ms-high-contrast: white-on-black)":{fill:d.palette.white},"@media screen and (-ms-high-contrast: black-on-white)":{fill:d.palette.black}}}),u=Object(s.mergeStyleSets)({root:{display:"flex",justifyContent:"flex-end",alignItems:"center",height:"100%",flex:1},sliderContainer:{width:"100%",height:"100%"},text:{fontSize:12,minWidth:35,textAlign:"center",marginLeft:6},iconContainer:{width:14,height:"100%",marginLeft:6}}),m={icon:{fontSize:14,padding:0,margin:0,width:"100%"},root:{padding:0,margin:0,height:"100%",width:14}},g=c(c({},m),{},{icon:{fontSize:10,padding:0,margin:0,color:d.palette.neutralDark}}),v={inactiveSection:{backgroundColor:d.palette.neutralSecondaryAlt},activeSection:{backgroundColor:d.palette.neutralPrimaryAlt}};class f extends a.Component{constructor(){super(...arguments),this.onIncrement=(e,t)=>{this.props.value<400&&this.props.onChange(this.props.value+1)},this.onDecrement=(e,t)=>{this.props.value>10&&this.props.onChange(this.props.value-1)},this.onSpinButtonChange=(e,t)=>{if(t){var o=parseInt(t,10),r=isNaN(o)?void 0:o;void 0!==r&&r>=10&&r<=400&&this.props.onChange(r)}}}render(){var e=this.props.isSlimMode?120:210,t=this.props.isSlimMode?a.createElement(r.SpinButton,{value:this.getDisplayValue(this.props.value),ariaValueNow:Math.round(this.props.value),min:10,max:400,step:1,onChange:this.onSpinButtonChange,onIncrement:this.onIncrement,onDecrement:this.onDecrement,incrementButtonAriaLabel:this.props.t("zoomSlider.zoomIn"),decrementButtonAriaLabel:this.props.t("zoomSlider.zoomOut"),styles:{root:{width:32},input:{fontSize:12},spinButtonWrapper:{height:26}}}):a.createElement(a.Fragment,null,a.createElement(n.IconButton,{ariaLabel:this.props.t("zoomSlider.zoomOut"),title:this.props.t("zoomSlider.zoomOut"),styles:g,iconProps:{iconName:"CalculatorSubtract"},onClick:()=>this.changeValue(-10)}),a.createElement("div",{className:u.sliderContainer},a.createElement(i.Slider,{"aria-label":this.props.t("zoomSlider.slider"),ariaValueText:this.getDisplayValue,min:10,max:400,step:1,value:this.props.value,showValue:!1,onChange:this.props.onChange,styles:v})),a.createElement(n.IconButton,{ariaLabel:this.props.t("zoomSlider.zoomIn"),title:this.props.t("zoomSlider.zoomIn"),styles:g,iconProps:{iconName:"CalculatorAddition"},onClick:()=>this.changeValue(10)}),a.createElement("div",{className:u.text},this.getDisplayValue(this.props.value)));return a.createElement("div",{className:u.root,style:{maxWidth:e}},t,a.createElement("div",{className:u.iconContainer},a.createElement(n.IconButton,{ariaLabel:this.props.t("zoomSlider.fitToScreen"),title:this.props.t("zoomSlider.fitToScreen"),styles:m,className:p,iconProps:{iconName:"ZoomToFit",className:"classNameIcon"},onClick:this.props.onFitToWindowClicked})))}changeValue(e){this.props.onChange(this.props.value+e)}getDisplayValue(e){return"".concat(Math.round(e)," %")}}},12327:function(e,t,o){"use strict";o.r(t);var r=o(12328);o.d(t,"Zoomable",(function(){return r.Zoomable}))},12328:function(e,t,o){"use strict";o.r(t),o.d(t,"Zoomable",(function(){return i}));var r=o(245),n=o(12329);class i extends r.Component{constructor(e){super(e),this.zoomElementRef=void 0,this.zoomElementRef=r.createRef()}render(){var e=Object(n.getZoomableClassNames)(this.props.styles),t=this.props.elementDimensions||this.calculateDimensions(),o=t&&t.height||0,i=t&&t.width||0,s=0===this.props.scale?"hidden":"visible";return r.createElement("div",{className:e.root,style:{height:o*this.props.scale,width:i*this.props.scale,visibility:s}},r.createElement("div",{ref:this.zoomElementRef,className:e.zoomWrapper,style:{transform:"scale(".concat(this.props.scale,")")}},this.props.children))}calculateDimensions(){if(this.zoomElementRef.current)return{height:this.zoomElementRef.current.offsetHeight,width:this.zoomElementRef.current.offsetWidth}}}},12329:function(e,t,o){"use strict";o.r(t),o.d(t,"getZoomableStyles",(function(){return i})),o.d(t,"getZoomableClassNames",(function(){return s}));var r=o(719),n=o(545),i=Object(n.memoizeFunction)(e=>Object(r.concatStyleSets)({root:{overflow:"hidden"},zoomWrapper:{transformOrigin:"0 0",transition:"transform 0.3s",display:"inline-block"}},e)),s=Object(n.memoizeFunction)(e=>Object(r.mergeStyleSets)(i(e)))}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/app-module-designer~f~52a6501a.0fd3d000.chunk.js.map