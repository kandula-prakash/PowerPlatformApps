/*! For license information please see 149.b8be4153.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[149],{5909:function(e,t,r){"use strict";r.r(t);var s=r(5910);r.d(t,"PrincipalType",(function(){return s.PrincipalType}))},5910:function(e,t,r){"use strict";r.r(t),r.d(t,"PrincipalType",(function(){return s})),r.d(t,"getUserRoles",(function(){return p})),r.d(t,"getTeamRoles",(function(){return m})),r.d(t,"getPrincipalDataAndRoles",(function(){return f}));var s,n=r(217),o=r(2867),i=r(5911),a=r(5912),l=r(3192),c=r(3193);function u(e,t,r,s,n,o,i){try{var a=e[o](i),l=a.value}catch(c){return void r(c)}a.done?t(l):Promise.resolve(l).then(s,n)}function d(e){return function(){var t=this,r=arguments;return new Promise((function(s,n){var o=e.apply(t,r);function i(e){u(o,s,n,i,a,"next",e)}function a(e){u(o,s,n,i,a,"throw",e)}i(void 0)}))}}function p(e,t){return h.apply(this,arguments)}function h(){return(h=d((function*(e,t){var r;if(!t)throw new Error("the apolloClient cannot be null");var i,u,{data:d,errors:p}=yield t.query({query:a.cdsUserDataAndRolesQuery,variables:{aadId:e},fetchPolicy:"no-cache"});p?(Object(n.trackErrorTrace)(c.PortalTelemetryScope,{eventData:p,eventName:"GetCDSUser"}),i={addedRoles:Object(o.Map)(),removedRoles:Object(o.Map)()}):i={addedRoles:Object(o.Map)(((null===(u=d.userDataAndRoles)||void 0===u?void 0:u.roles)||[]).map(e=>[e.roleId,!0])),removedRoles:Object(o.Map)()};return{businessUnitId:(null===(r=d.userDataAndRoles)||void 0===r?void 0:r.businessUnitId)||void 0,systemId:void 0,principalType:s.User,roles:i,errors:p?Object(l.getResponseMessageFromGraphQlError)(p):void 0}}))).apply(this,arguments)}function m(e,t){return g.apply(this,arguments)}function g(){return(g=d((function*(e,t){var r,a;if(!t)throw new Error("the apolloClient cannot be null");var u,d,{data:p,errors:h}=yield t.query({query:i.cdsTeamDataAndRolesQuery,variables:{aadId:e},fetchPolicy:"no-cache"});h?(Object(n.trackErrorTrace)(c.PortalTelemetryScope,{eventData:h,eventName:"GetCDSTeam"}),u={addedRoles:Object(o.Map)(),removedRoles:Object(o.Map)()}):u={addedRoles:Object(o.Map)(((null===(d=p.teamDataAndRoles)||void 0===d?void 0:d.roles)||[]).map(e=>[e.roleId,!0])),removedRoles:Object(o.Map)()};return{businessUnitId:null!==(r=null===(a=p.teamDataAndRoles)||void 0===a?void 0:a.businessUnitId)&&void 0!==r?r:void 0,systemId:void 0,principalType:s.Group,roles:u,errors:h?Object(l.getResponseMessageFromGraphQlError)(h):void 0}}))).apply(this,arguments)}function f(e,t,r){return b.apply(this,arguments)}function b(){return(b=d((function*(e,t,r){return r===s.User?p(e,t):m(e,t)}))).apply(this,arguments)}!function(e){e.User="User",e.Group="Group",e.Tenant="Tenant",e.ServicePrincipal="ServicePrincipal",e.NotSpecified="NotSpecified",e.App="App"}(s||(s={}))},5911:function(e,t,r){"use strict";r.r(t),r.d(t,"cdsTeamDataAndRolesQuery",(function(){return a}));var s,n=r(3128);var o,i,a=r.n(n)()(s||(o=["\n  query cdsTeamDataAndRoles($aadId: String) {\n    teamDataAndRoles(input: { aadId: $aadId }) {\n      businessUnitId\n      roles {\n        name\n        roleId\n      }\n    }\n  }\n"],i||(i=o.slice(0)),s=Object.freeze(Object.defineProperties(o,{raw:{value:Object.freeze(i)}}))))},5912:function(e,t,r){"use strict";r.r(t),r.d(t,"cdsUserDataAndRolesQuery",(function(){return a}));var s,n=r(3128);var o,i,a=r.n(n)()(s||(o=["\n  query cdsUserDataAndRoles($aadId: String) {\n    userDataAndRoles(input: { aadId: $aadId }) {\n      businessUnitId\n      roles {\n        name\n        roleId\n      }\n    }\n  }\n"],i||(i=o.slice(0)),s=Object.freeze(Object.defineProperties(o,{raw:{value:Object.freeze(i)}}))))},5927:function(e,t,r){"use strict";r.r(t),r.d(t,"withLocalizedStrings",(function(){return a}));var s=r(923),n=r(245),o=r.n(n);function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e}).apply(this,arguments)}function a(e){return Object(s.translateService)("SharedComponents")((function(t){return o.a.createElement(o.a.Fragment,null,t.tReady&&o.a.createElement(e,i({},t,{strings:c(t.i18n),locale:t.i18n.language})),!t.tReady&&null)}))}var l;function c(e){if(l)return l;var t=e.language,r=e.t("strings",{ns:"SharedComponents",lng:t,returnObjects:!0});"en-US"!==t&&function e(t,r){Object.keys(r).forEach(s=>{if(t.hasOwnProperty(s)){var n=t[s];"object"!=typeof n||Array.isArray(n)||e(n,r[s])}else t[s]=r[s]})}(r,e.t("strings",{ns:"SharedComponents",lng:"en-US",returnObjects:!0}));return l=r}},5942:function(e,t,r){"use strict";r.r(t),r.d(t,"SortType",(function(){return s})),r.d(t,"UserListInternal",(function(){return O})),r.d(t,"userListWithUserItemType",(function(){return C}));var s,n=r(4064),o=r(5910),i=r(5943),a=r.n(i),l=r(684),c=r(1447),u=r(1471),d=r(1265),p=r(1473),h=r(719),m=r(1240),g=r(245),f=r(5927),b=r(5944),v=r(860);function y(){return(y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e}).apply(this,arguments)}function S(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,s)}return r}function P(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?S(Object(r),!0).forEach((function(t){T(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):S(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function T(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}!function(e){e[e.Name=0]="Name",e[e.UserType=1]="UserType"}(s||(s={}));class O extends g.Component{constructor(e){super(e),this.columns=void 0,this.strings=void 0,this.onRenderDetailsHeader=(e,t)=>e&&t?t(P(P({},e),{},{onRenderColumnHeaderTooltip:this.onRenderColumnHeaderTooltip})):null,this.onRenderColumnHeaderTooltip=(e,t)=>{var r;return e&&t?null!==(r=e.id)&&void 0!==r&&r.endsWith("".concat("persona-details","-tooltip"))?this.props.shouldShowSorter?g.createElement(m.TooltipHost,e,this.getSorterContextMenu()):g.createElement(m.TooltipHost,e,g.createElement("span",{className:R.detailsListHeaderName},this.props.title,this.props.titleAdditionalContent)):t(e):null},this.onFilterOptionChange=(e,t)=>{t&&this.setState({currentSortType:t.key})},this.sortUserBy=(e,t)=>{var r,n,o=e.user,i=t.user;switch(this.state.currentSortType){case s.Name:r=o.fullName,n=i.fullName;break;case s.UserType:r=o.role,n=i.role;break;default:var a=this.state.currentSortType;throw new Error("Invalid sort type: ".concat(a))}return r>n?1:-1},this.columns=this.buildColumns(),this.strings=this.props.localizedStrings||this.props.strings,this.state={usersListSize:0,currentSortType:s.Name,selection:e.selection?e.selection:new p.Selection({canSelectItem:e=>!e.user.isOwner,onSelectionChanged:()=>{var t=this.state.selection.getSelection();e.onUsersSelectionChange&&e.onUsersSelectionChange(t.map(e=>e.user))}})}}render(){var e=this.props.users.map(e=>({user:e,key:e.objectId})),t=!!this.props.title&&this.props.selectionMode===p.SelectionMode.multiple;return e.length?g.createElement("div",{className:R.usersListSection,"data-automation-id":this.props.automationId,title:this.props.title},g.createElement(n.DetailsList,{ariaLabelForSelectionColumn:this.props.ariaLabelForSelectionColumn,ariaLabelForSelectAllCheckbox:this.props.ariaLabelForSelectAllCheckbox,className:a()({["".concat(R.detailsList)]:!0,["".concat("is-hidden")]:!t}),isHeaderVisible:!!this.props.title,items:e,columns:this.columns,setKey:this.props.setKey?this.props.setKey:"itemCollection",selection:this.state.selection,selectionMode:this.props.selectionMode,selectionPreservedOnEmptyClick:!0,selectionZoneProps:{isSelectedOnFocus:this.props.isSelectedOnFocus,selection:this.state.selection},constrainMode:u.ConstrainMode.unconstrained,checkboxVisibility:this.props.checkboxVisibility,checkButtonAriaLabel:this.props.ariaLabelRowCheckbox,isLoading:!1,onRenderDetailsHeader:this.onRenderDetailsHeader,onItemInvoked:this.props.onItemInvoked,onShouldVirtualize:()=>Object(v.getResponsiveMode)(window)>v.ResponsiveMode.large})):g.createElement("span",null,this.strings.userList.noUsersFound)}buildColumns(){var{onRenderPersona:e,thumbnails:t}=this.props,r=this.props.shouldShowSorter?{isSorted:!0,sortBy:this.sortUserBy}:void 0;return[P({key:"persona-details",className:R.personaDetailsCell,name:this.props.title,fieldName:"persona-details",minWidth:150,isPadded:!1,isMultiline:!1,columnActionsMode:u.ColumnActionsMode.disabled,onRender:r=>{var s,n,i,{user:a}=r;i=a.principalType===o.PrincipalType.Tenant?a.fullName:a.principalType===o.PrincipalType.Group?a.isGroupEmailEnabled?Object(b.formatResourceString)(this.strings.userList.userAndMail_format,a.fullName,a.email):a.fullName:a.email?Object(b.formatResourceString)(this.strings.userList.userAndMail_format,a.fullName,a.email):a.fullName,e&&e(a);var c=null!==(s=null!==(n=a.imageUrl)&&void 0!==n?n:t&&t[a.objectId])&&void 0!==s?s:"";return g.createElement(g.Fragment,null,g.createElement(m.TooltipHost,{content:i},g.createElement(d.Persona,{"aria-label":a.fullName,imageUrl:c,text:a.fullName,secondaryText:a.role,size:d.PersonaSize.size40,onRenderPersonaCoin:this.props.onRenderPersonaCoin?e=>this.props.onRenderPersonaCoin(a,e):void 0,onRenderInitials:this.props.onRenderInitials?e=>this.props.onRenderInitials(a,e):void 0})),this.props.onUserRemoved&&!a.isOwner&&g.createElement(m.TooltipHost,{content:this.strings.userList.removeThis},g.createElement(l.ActionButton,{ariaLabel:this.strings.userList.removeThis,allowDisabledFocus:!0,menuIconProps:{iconName:"Cancel",style:{fontSize:16}},onClick:()=>this.props.onUserRemoved(a)})),!!this.props.additionalRowAction&&g.createElement(m.TooltipHost,{content:this.props.additionalRowAction.buttonProps.ariaLabel},g.createElement(l.ActionButton,y({},this.props.additionalRowAction.buttonProps,{onClick:()=>{var e;return null===(e=this.props.additionalRowAction)||void 0===e?void 0:e.onClick(a)}}))))}},r)]}getSorterContextMenu(){var e=Object(b.formatResourceString)(this.strings.userList.sortBy_format,this.getSortingOptionDisplayName(this.state.currentSortType));return g.createElement(c.ComboBox,{className:R.comboBox,calloutProps:{className:R.callout},selectedKey:this.state.currentSortType,options:[{key:s.Name,text:Object(b.formatResourceString)(this.strings.userList.sortBy_format,this.getSortingOptionDisplayName(s.Name))},{key:s.UserType,text:Object(b.formatResourceString)(this.strings.userList.sortBy_format,this.getSortingOptionDisplayName(s.UserType))}],ariaLabel:e,onChange:this.onFilterOptionChange})}getSortingOptionDisplayName(e){switch(e){case s.Name:return this.strings.userList.sorterCriteriaName;case s.UserType:return this.strings.userList.sorterCriteriaUserType;default:return""}}}var R=Object(h.mergeStyleSets)({usersListSection:["UserList"],detailsList:{selectors:{".ms-DetailsHeader, .ms-DetailsRow":{borderColor:"transparent"},".ms-DetailsHeader .ms-TooltipHost > *":{paddingLeft:12,paddingRight:8},["&.".concat("is-hidden"," .ms-DetailsHeader .ms-DetailsHeader-cellIsCheck")]:{width:0}}},detailsListHeaderName:{fontSize:h.FontSizes.medium,fontWeight:h.FontWeights.regular},personaDetailsCell:{display:"flex",alignItems:"center",justifyContent:"space-between",selectors:{"& > .ms-TooltipHost":{position:"relative",overflowY:"hidden"},"& > .ms-TooltipHost~.ms-TooltipHost":{overflowY:"unset"}}},comboBox:{display:"flex",alignItems:"center",justifyContent:"space-between",selectors:{".ms-Label":{display:"inline-flex",flex:1,paddingTop:0,marginRight:8,paddingBottom:0,fontSize:h.FontSizes.medium,fontWeight:h.FontWeights.regular},".ms-ComboBox":{display:"inline-flex",width:192,maxWidth:192},".ms-ComboBox-Input":{lineHeight:"100%"},".ms-ComboBox-CaretDown-button":{right:0}}},callout:{selectors:{".ms-ComboBox-option":{overflow:"visible"}}}});function C(){return Object(f.withLocalizedStrings)(O)}},5944:function(e,t,r){"use strict";function s(e,t){return!e&&!t||!(!e||!t)&&e.toUpperCase()===t.toUpperCase()}function n(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),s=1;s<t;s++)r[s-1]=arguments[s];return r&&0!==r.length?e.replace(/\{([^{}]+)\}/g,(t,s,n)=>{var o="";if("{"===e[n-1]&&"}"===e[n+s.length+1])o=s;else{var i=parseInt(s);if(r.length>i){var a=r[i];"string"==typeof a?o=a:"number"==typeof a&&(o=a.toString())}}return o}):e}r.r(t),r.d(t,"equalsIgnoreCase",(function(){return s})),r.d(t,"formatResourceString",(function(){return n}))},5945:function(e,t,r){"use strict";r.r(t),r.d(t,"userSelectionPickerWithUserItemType",(function(){return b}));var s,n=r(2867),o=r(1601),i=r(1288),a=r(1473),l=r(1201),c=r(719),u=r(1240),d=r(245),p=r(5927),h=r(5944),m=r(5946);!function(e){e[e.Loading=0]="Loading",e[e.Failed=1]="Failed"}(s||(s={}));class g extends d.Component{constructor(e){super(e),this.suggestionProps=void 0,this.outlookRegEx=/<[^\]]*>/,this.strings=void 0,this.onItemsChange=e=>{if(e){var t=[],r=[];e.forEach(e=>{this.state.usersToAdd.has(e.searchTerm)?t.push(this.state.usersToAdd.get(e.searchTerm)):this.state.errorUsers.has(e.searchTerm)?r.push(this.state.errorUsers.get(e.searchTerm)):this.props.onNewUserAdded(e.user)}),this.setState({usersToAdd:Object(n.Map)().withMutations(e=>{t.forEach(t=>{e.set(t.searchTerm,t)})}),errorUsers:Object(n.Map)().withMutations(e=>{r.forEach(t=>{e.set(t.searchTerm,t)})})})}},this.onInputChange=e=>{if(this.props.selectionMode!==a.SelectionMode.single&&e&&e.indexOf(";")>-1){var t=e.split(";").filter(e=>e&&e.length>=3).map(e=>{var t=this.getEmailFromOutlookFormat(e);return this.fetchUsersAndGroupsAsync(t),this.createGenericItem(e,t)}),r=this.state.usersToAdd.withMutations(e=>{t.forEach(t=>{e.set(t.searchTerm,t)})});return this.setState({usersToAdd:r}),""}return e.length<3?this.setState({userNotFoundReasonText:"",peoplePickerFilterText:"",announcedMessage:Object(h.formatResourceString)(this.strings.userPicker.notEnoughCharactersAria,3)}):this.setState({announcedMessage:this.strings.userPicker.inputPeoplePickerLoading}),e},this.createGenericItem=(e,t)=>({objectId:"",loadingState:s.Loading,searchTerm:t,inputString:e}),this.renderItem=e=>{var t=e;switch(t.item.loadingState){case s.Loading:return d.createElement(l.Spinner,{size:l.SpinnerSize.small});case s.Failed:return d.createElement("div",{className:f.sharePeoplePickerErrorLabelContainer},d.createElement(u.TooltipHost,{content:t.item.errorMessage,calloutProps:{gapSpace:0}},d.createElement("div",{"aria-label":t.item.errorMessage,className:"sharePeoplePickerErrorLabel"},t.item.inputString,";")));default:var r=t.item.loadingState;throw new Error(r)}},this.onFilterChanged=e=>{if(e&&e.length>=3){var t=this.getEmailFromOutlookFormat(e);return this.setState({peoplePickerFilterText:e}),this.props.fetchUsersAndGroupsBasedOnFilterTextAsync(t,!1).then(r=>{var s=r.filter(e=>!this.isAlreadyAdded(e)).map(e=>({user:e,searchTerm:t,text:e.fullName,secondaryText:e.email,imageUrl:e.imageUrl}));if(this.state.peoplePickerFilterText===e&&0===s.length){var n=Object(h.formatResourceString)(r.length>0?this.strings.userPicker.inputPeoplePickerAlreadyAdded:this.strings.userPicker.inputPeoplePickerNotFoundGeneric,t);this.setState({userNotFoundReasonText:n})}return this.setState({announcedMessage:void 0}),s}).catch(e=>(null!=e&&e.message&&e.errorType===m.NormalizedUserSelectionErrorType.InputTooLong?this.setState({userNotFoundReasonText:e.message,announcedMessage:void 0}):this.setState({userNotFoundReasonText:this.strings.userPicker.inputPeoplePickerFailedLoading,announcedMessage:void 0}),[]))}return[]},this.strings=this.props.localizedStrings||this.props.strings,this.suggestionProps={loadingText:this.strings.userPicker.inputPeoplePickerLoading,suggestionsContainerAriaLabel:this.strings.userPicker.suggestionsContainerAriaLabel,noResultsFoundText:"",className:f.sharePeoplePicker,suggestionsItemClassName:f.sharePanelSuggestionItem},this.state={peoplePickerFilterText:"",userNotFoundReasonText:"",usersToAdd:Object(n.Map)(),errorUsers:Object(n.Map)(),announcedMessage:void 0}}fetchUsersAndGroupsAsync(e){return this.props.fetchUsersAndGroupsBasedOnFilterTextAsync(e,!0).then(t=>{var r=this.state.usersToAdd.get(e);if(r){var n=[];1!==t.length||this.isAlreadyAdded(t[0])?(r.loadingState=s.Failed,r.errorMessage=Object(h.formatResourceString)(t.length>0&&t.every(e=>this.isAlreadyAdded(e))?this.strings.userPicker.inputPeoplePickerAlreadyAdded:this.strings.userPicker.inputPeoplePickerNotFound,e),n.push(r)):this.props.onNewUserAdded(t[0]);var o=this.state.usersToAdd.withMutations(t=>{t.remove(e)}),i=this.state.errorUsers.withMutations(e=>{n.forEach(t=>{e.set(t.searchTerm,t)})});this.setState({usersToAdd:o,errorUsers:i})}})}render(){var{announcedMessage:e,peoplePickerFilterText:t,usersToAdd:r,errorUsers:s}=this.state;this.suggestionProps.noResultsFoundText=this.state.userNotFoundReasonText,t.length>=3?this.suggestionProps.className=f.sharePeoplePicker:this.suggestionProps.className="".concat(f.shareHideCallout," ").concat(f.sharePeoplePicker);var n=r.toArray().concat(s.toArray()),a=this.props.placeholderText,l=0===n.length?a:void 0;return d.createElement(d.Fragment,null,d.createElement(i.Announced,{message:e,"aria-live":e?"assertive":"off"}),d.createElement(o.NormalPeoplePicker,{onResolveSuggestions:this.onFilterChanged,resolveDelay:200,pickerSuggestionsProps:this.suggestionProps,className:f.listPeoplePicker,selectedItems:n,onInputChange:this.onInputChange,onChange:this.onItemsChange,inputProps:{placeholder:l,"aria-label":a},onRenderItem:this.renderItem,disabled:this.props.isDisabled}))}getEmailFromOutlookFormat(e){var t,r=e.match(this.outlookRegEx);return r&&r[0]&&(t=(t=r[0].replace(/(^<|>$)/g,"")).trim()),t||e}isAlreadyAdded(e){return this.props.currentUsers.some(t=>Object(h.equalsIgnoreCase)(t.objectId,e.objectId))}}var f=Object(c.mergeStyleSets)({sharePeoplePicker:{width:"260px",selectors:{".ms-Suggestions-none":{padding:"8px 16px",textAlign:"left",lineHeight:"20px"}}},shareHideCallout:{display:"none"},sharePeoplePickerErrorLabelContainer:{height:"32px",lineHeight:"32px",paddingLeft:"0",fontSize:"12px",paddingRight:"5px",display:"inline-block",selectors:{".sharePeoplePickerErrorLabel":{color:"red"}}},sharePanelSuggestionItem:{selectors:{".ms-Persona-details":{paddingRight:"0"},".ms-Persona":{width:"100%"}}},listPeoplePicker:{selectors:{".ms-BasePicker-text":{borderTop:"none",borderLeft:"none",borderRight:"none"},".ms-BasePicker-input":{fontSize:"12px"}}}});function b(){return Object(p.withLocalizedStrings)(g)}},5946:function(e,t,r){"use strict";var s;r.r(t),r.d(t,"NormalizedUserSelectionErrorType",(function(){return s})),r.d(t,"NormalizedUserSelectionError",(function(){return n})),function(e){e[e.InputTooLong=0]="InputTooLong"}(s||(s={}));class n extends Error{constructor(e,t){super(t),this.errorType=void 0,this.errorType=e,Object.setPrototypeOf(this,n.prototype)}}}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/149.b8be4153.chunk.js.map