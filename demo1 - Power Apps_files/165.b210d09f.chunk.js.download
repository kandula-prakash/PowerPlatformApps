/*! For license information please see 165.b210d09f.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[165],{5987:function(e,t,r){"use strict";r.r(t),r.d(t,"portalSubDomainStatusSelector",(function(){return l})),r.d(t,"enableEngagementInsightsSelector",(function(){return p})),r.d(t,"portalSubDomainSelector",(function(){return c})),r.d(t,"portalLanguageSelector",(function(){return d})),r.d(t,"websiteIdSelector",(function(){return u})),r.d(t,"portalTermsOfServiceSelector",(function(){return m})),r.d(t,"portalCreateModalErrorMessageSelector",(function(){return h})),r.d(t,"powerPortalStarterSolutionStatusSelector",(function(){return g})),r.d(t,"portalStarterSolutionFetchError",(function(){return P})),r.d(t,"portalByIdSelector",(function(){return S})),r.d(t,"portalFetchErrorByIdSelector",(function(){return b})),r.d(t,"portalListFetchError",(function(){return v})),r.d(t,"powerPortalsListSelector",(function(){return f})),r.d(t,"portalCreateInProgressSelector",(function(){return w})),r.d(t,"powerPortalSitewideListSelector",(function(){return C})),r.d(t,"powerPortalSitewideListExistsSelector",(function(){return x})),r.d(t,"powerPortalWebsites",(function(){return E})),r.d(t,"powerPortalWebsiteBindings",(function(){return A})),r.d(t,"powerPortalWebsitesFetchError",(function(){return y})),r.d(t,"powerPortalSettingsUpdateError",(function(){return F})),r.d(t,"powerPortalSettingsUpdateComplete",(function(){return N})),r.d(t,"powerPortalSettingsUiLoaded",(function(){return T})),r.d(t,"powerPortalSitewideFetchError",(function(){return I})),r.d(t,"powerPortalListCachedSelector",(function(){return D})),r.d(t,"appSelector",(function(){return O})),r.d(t,"fetchOrganizationSettingsErrorSelector",(function(){return L})),r.d(t,"organizationSettingsSelector",(function(){return k})),r.d(t,"isPowerPortalListCachedComplete",(function(){return M})),r.d(t,"componentLoadStateSelector",(function(){return j})),r.d(t,"environmentHasCDSOrgSelector",(function(){return W})),r.d(t,"powerPortalPrerequisitesSelector",(function(){return R})),r.d(t,"powerPortalFetchIsCDSOrgError",(function(){return B})),r.d(t,"powerPortalGenericErrorSelector",(function(){return U})),r.d(t,"partnerPortalFieldServiceSelector",(function(){return H})),r.d(t,"partnerPortalProjectServiceSelector",(function(){return V})),r.d(t,"packageName",(function(){return G})),r.d(t,"environmentClient",(function(){return q})),r.d(t,"getPowerPortalFeaturesEnabled",(function(){return z}));var o=r(5470),a=r(5644),s=r(5988),n=r(5626),i=r(5645),l=e=>{var t;return null==e||null===(t=e.powerPortalApps)||void 0===t?void 0:t.portalSubDomainStatus},p=e=>{var t;return null==e||null===(t=e.powerPortalApps)||void 0===t?void 0:t.enableEngagementInsights},c=e=>{var t,r;return(null==e||null===(t=e.powerPortalApps)||void 0===t?void 0:t.portalSubDomainStatus)===s.SubDomainStatus.Accept?null==e||null===(r=e.powerPortalApps)||void 0===r?void 0:r.portalSubDomain:void 0},d=(e,t)=>{var r;return(null==e||null===(r=e.powerPortalApps)||void 0===r?void 0:r.portalSelectedLangauge)||e.shared.orgEnabledLanguages.get(t)&&e.shared.orgEnabledLanguages.get(t)[0].localeId.toString()},u=(e,t)=>e.powerPortalApps.websiteSelectedId||e.powerPortalApps.packageName==i.PowerPortalPackageName.IdeasPortal&&e.shared.portalWebsiteIds.get(t)&&e.shared.portalWebsiteIds.get(t).length>0&&e.shared.portalWebsiteIds.get(t)[0].websiteId.toString(),m=e=>{var t;return null==e||null===(t=e.powerPortalApps)||void 0===t?void 0:t.showTermsOfService},h=(e,t)=>{var r;return null==e||null===(r=e.powerPortalApps)||void 0===r?void 0:r.portalCreateModalErrorMessage[t]},g=(e,t)=>{var r;return null==e||null===(r=e.powerPortalApps)||void 0===r?void 0:r.CdsStarterSolutionInstallationStatusMap.get(t)},P=(e,t)=>{var r;return(null==e||null===(r=e.powerPortalApps)||void 0===r?void 0:r.fetchStarterSolutionErrorByEnvironment[t])||""},S=(e,t)=>{var r,o;return null==e||null===(r=e.powerPortalApps)||void 0===r||null===(o=r.powerPortals)||void 0===o?void 0:o.byId(t)},b=(e,t)=>{var r,o;return null==e||null===(r=e.powerPortalApps)||void 0===r||null===(o=r.powerPortalsAppFetchError)||void 0===o?void 0:o.get(t)},v=(e,t)=>{var r;return(null==e||null===(r=e.powerPortalApps)||void 0===r?void 0:r.powerPortalsFetchErrorByEnvironment[t])||""},f=(e,t)=>{var r=(e=>{var t;return null==e||null===(t=e.powerPortalApps)||void 0===t?void 0:t.powerPortals})(e);return Object(o.denormalize)(r,t)},w=e=>{var t;return null==e||null===(t=e.powerPortalApps)||void 0===t?void 0:t.isPortalCreateInProgress},C=(e,t)=>{var r,o;return null==e||null===(r=e.powerPortalApps)||void 0===r||null===(o=r.powerPortalsFromSitewide)||void 0===o?void 0:o.get(t)},x=(e,t)=>{var r;return(null==e||null===(r=e.powerPortalApps)||void 0===r?void 0:r.powerPortalsFromSitewideExists.get(t))||a.PowerPortalsSitewideState.Unknown},E=(e,t)=>{var r,o;return null==e||null===(r=e.powerPortalApps)||void 0===r||null===(o=r.powerPortalWebsites)||void 0===o?void 0:o.get(t)},A=(e,t)=>{var r,o;return null==e||null===(r=e.powerPortalApps)||void 0===r||null===(o=r.powerPortalWebsiteBindings)||void 0===o?void 0:o.get(t)},y=(e,t)=>{var r,o;return null==e||null===(r=e.powerPortalApps)||void 0===r||null===(o=r.powerPortalWebsitesFetchError)||void 0===o?void 0:o.get(t)},F=e=>{var t;return null==e||null===(t=e.powerPortalApps)||void 0===t?void 0:t.updatePowerPortalSettingsError},N=e=>{var t;return!(null!=e&&null!==(t=e.powerPortalApps)&&void 0!==t&&t.updatePowerPortalSettingsIsInProgress)},T=(e,t)=>{var r,o,a,s;return N(e)&&(null==e||null===(r=e.shared)||void 0===r||null===(o=r.orgEnabledLanguages)||void 0===o?void 0:o.get(t))&&(null==e||null===(a=e.shared)||void 0===a||null===(s=a.orgEnabledLanguages)||void 0===s?void 0:s.get(t).length)>0},I=(e,t)=>{var r;return null==e||null===(r=e.powerPortalApps)||void 0===r?void 0:r.fetchPortalsFromSitewideErrorByEnvironment[t]},D=(e,t)=>{var r=Object(n.listFetchedSelector)(e);return r&&r[t]&&r[t].powerPortalApps||o.CachedStatusType.None},O=(e,t)=>e.apps.powerapps.byId(t),L=(e,t)=>{var r;return null==e||null===(r=e.powerPortalApps)||void 0===r?void 0:r.fetchOrganizationSettingsError[t]},k=e=>{var t;return null==e||null===(t=e.powerPortalApps)||void 0===t?void 0:t.organizationSettings},M=(e,t)=>D(e,t)===o.CachedStatusType.Done,j=e=>{var t;return null==e||null===(t=e.powerPortalApps)||void 0===t?void 0:t.componentLoadState},W=(e,t)=>{var r;return null==e||null===(r=e.powerPortalApps)||void 0===r?void 0:r.environmentHasCDSOrg.get(t)},R=(e,t,r,o)=>{var a,s,n,i;return(null==e||null===(a=e.powerPortalApps)||void 0===a?void 0:a.powerPortalOperationPrerequisites)&&(null==e||null===(s=e.powerPortalApps)||void 0===s?void 0:s.powerPortalOperationPrerequisites.get(t))&&(null==e||null===(n=e.powerPortalApps)||void 0===n?void 0:n.powerPortalOperationPrerequisites.get(t).get(o))&&(null==e||null===(i=e.powerPortalApps)||void 0===i?void 0:i.powerPortalOperationPrerequisites.get(t).get(o).get(r))},B=(e,t)=>{var r;return(null==e||null===(r=e.powerPortalApps)||void 0===r?void 0:r.fetchIsCDSOrgErrorByEnvironment[t])||""},U=(e,t)=>{var r;return null==e||null===(r=e.powerPortalApps)||void 0===r?void 0:r.powerPortalGenericError[t]},H=e=>{var t;return null==e||null===(t=e.powerPortalApps)||void 0===t?void 0:t.enablePartnerPortalFieldService},V=e=>{var t;return null==e||null===(t=e.powerPortalApps)||void 0===t?void 0:t.enablePartnerPortalProjectService},G=e=>{var t;return null==e||null===(t=e.powerPortalApps)||void 0===t?void 0:t.packageName},q=e=>{var t;return null==e||null===(t=e.powerPortalApps)||void 0===t?void 0:t.environmentClient},z=e=>{var t;return null==e||null===(t=e.powerPortalApps)||void 0===t?void 0:t.isPowerPortalFeaturesEnabled}},5988:function(e,t,r){"use strict";r.r(t),r.d(t,"SubDomainStatus",(function(){return o})),r.d(t,"CreatePowerPortalFormSectionBase",(function(){return T})),r.d(t,"CreatePowerPortalFormSection",(function(){return I}));var o,a=r(790),s=r(1567),n=r(687),i=r(684),l=r(1090),p=r(1201),c=r(545),d=r(1429),u=r(1362),m=r(1755),h=r(1795),g=r(245),P=r(2879),S=r(5481),b=r(2869),v=r(2880),f=r(5989),w=r(5991),C=r(2871),x=r(5998),E=r(5657),A=r(5629),y=r(2872),F=r(5645),N=r(1240);!function(e){e[e.Loading=0]="Loading",e[e.Accept=1]="Accept",e[e.Reject=2]="Reject"}(o||(o={}));class T extends g.Component{constructor(e){super(e),this.portalDomain=void 0,this.classNames=void 0,this.resources=void 0,this.partnerPortalPackageInfoCallout=g.createRef(),this.addressLabelId=Object(c.getId)("addressLabel"),this.addressTextBoxId=Object(c.getId)("addressTextBox"),this.renderCustomShimmerElements=()=>g.createElement("div",null,g.createElement(m.ShimmerElementsGroup,{shimmerElements:[{type:m.ShimmerElementType.gap,width:"100%",height:32}]}),this.props.createAppFormSection.customShimmerElements()),this.onPartnerPortalPackageInfoClick=()=>{this.setState({isPartnerPortalPackageInfoCalloutVisible:!this.state.isPartnerPortalPackageInfoCalloutVisible})},this.onPartnerPortalPackageInfoDismis=()=>{this.setState({isPartnerPortalPackageInfoCalloutVisible:!1})},this.portalLanguageSelected=e=>{this.props.onPortalLanguageSelect(e.key.toString())},this.websiteIdSelected=e=>{this.props.onWebsiteIdSelect(e.key.toString())},this.onPartnerPortalFieldServiceChange=(e,t)=>{this.props.onPortalFieldServiceCheck(t)},this.onUseExistingWebsiteChange=(e,t)=>{if(this.setState({onUseExistingWebsiteCheck:t}),t){var r=this.props.portalWebsiteIds||[],o=this.props.selectedWebsiteId?this.props.selectedWebsiteId:r.length>0?r[0].websiteId:void 0;this.props.onWebsiteIdSelect(o)}else this.props.onWebsiteIdSelect("")},this.onPartnerPortalProjectChange=(e,t)=>{this.props.onPortalProjectServiceCheck(t)},this.props.isPublicPreviewEnabled?this.portalDomain="."+y.settings.powerPortalDomainPublicPreview:this.portalDomain="."+y.settings.powerPortalDomain,this.resources=Object(b.getResources)(),this.classNames=Object(x.getClassNames)(this.props.styles,{theme:this.props.theme}),this.state={isAddressInfoCalloutVisible:!1,isPartnerPortalPackageInfoCalloutVisible:!1,portalSubDomain:"",isPortalSubDomainValid:!1,portalSubDomainErrorMessage:"",enableEngagementInsights:!0,onUseExistingWebsiteCheck:!1},this.onPortalAddressBlur=this.onPortalAddressBlur.bind(this),this.onChangeAddressErrorMessage=this.onChangeAddressErrorMessage.bind(this),this.renderAddressLabel=this.renderAddressLabel.bind(this),this.onEIChange=this.onEIChange.bind(this)}componentDidMount(){this.props.fetchOrgEnabledLanguages(),this.props.powerPortalIdeasOrStarterAppListInProgress||this.props.fetchPowerPortalPrerequisitesRequestPortalDialog(this.props.fetchPowerPortalPrerequisitesPayload)}onChangeAddressErrorMessage(e){this.props.onPortalInvalidSubDomainRequest(),0===e.trim().length?this.setState({isPortalSubDomainValid:!1,portalSubDomainErrorMessage:this.resources.PowerPortal.CreateAppModal.FormSection.Address.Validation.Empty.text}):/^[A-Za-z0-9\-]+$/.test(e)?this.setState({isPortalSubDomainValid:!0,portalSubDomainErrorMessage:""}):this.setState({isPortalSubDomainValid:!1,portalSubDomainErrorMessage:this.resources.PowerPortal.CreateAppModal.FormSection.Address.Validation.AllowedCharacters.text})}onPortalAddressBlur(e){this.state.isPortalSubDomainValid&&(this.setState({portalSubDomain:e.target.value}),this.props.onCheckPortalSubDomainAvailability(e.target.value))}onEIChange(e){this.setState({enableEngagementInsights:e.target.checked}),this.props.onPortalEngagementInsightsCheck(e.target.checked)}render(){return g.createElement("div",{className:this.props.createAppFormSection.componentLoadState!==A.ComponentLoadState.Loading&&this.props.createAppFormSection.isGlobalErrorMessagePresent&&this.classNames.section},g.createElement(w.CreateAppFormSection,this.props.createAppFormSection),g.createElement(m.Shimmer,{isDataLoaded:this.props.createAppFormSection.componentLoadState!==A.ComponentLoadState.Loading,customElementsGroup:this.renderCustomShimmerElements()},this.renderAddressField(),this.renderOrgEnabledLanguageDropDown(),this.renderPortalServiceCheckList(),this.renderIdeasPortalServiceCheckList(),this.renderPartnerPortalServiceCheckList(),C.featureGates.enableEngagementInsights?this.renderEngagementInsightEnabled():null,this.renderTermsAggrement(),this.renderPrivacyStatement(),g.createElement(f.PortalTermsOfService,{showModal:this.props.displayPortalTermsOfService,onDismiss:this.props.onPortalTermsOfServiceDismiss})))}renderEngagementInsightEnabled(){return g.createElement("div",{className:this.classNames.eiDiv},g.createElement(u.Checkbox,{checked:this.state.enableEngagementInsights,label:this.resources.PowerPortal.CreateAppModal.FormSection.EI.Checkbox.label,styles:x.eiCheckboxStyles}),g.createElement(N.TooltipHost,{content:this.resources.PowerPortal.CreateAppModal.FormSection.EI.Tooltip.label,directionalHint:a.DirectionalHint.rightCenter},g.createElement(n.Icon,{iconName:P.fabricIcons.Info})))}renderOrgEnabledLanguageDropDown(){var e=this.props.orgEnabledLanguages||[],t=this.props.selectedLanguage?parseInt(this.props.selectedLanguage,10):e.length>0?e[0].localeId:void 0;return e&&g.createElement("div",{className:this.classNames.languageDropDown},g.createElement(s.Dropdown,{defaultSelectedKey:t,role:"combobox",onChanged:this.portalLanguageSelected,label:this.resources.CreateAppModal.FormSection.Language.Label,options:e.filter(e=>Object(F.checkPortalSupportedLanguage)(e.localeId)).map(e=>({key:e.localeId,text:e.label})),disabled:this.props.isPortalCreationInProgress}))}renderAddressField(){return g.createElement("div",{className:this.classNames.address},g.createElement(d.TextField,{maxLength:24,errorMessage:this.state.portalSubDomainErrorMessage,onChange:(e,t)=>this.onChangeAddressErrorMessage(t),suffix:this.portalDomain,label:this.resources.PowerPortal.CreateAppModal.FormSection.Address.Label,"aria-labelledby":this.addressTextBoxId,ariaLabel:this.resources.PowerPortal.CreateAppModal.FormSection.Address.Label+this.portalDomain,onRenderLabel:this.renderAddressLabel,onBlur:this.onPortalAddressBlur,disabled:this.props.isPortalCreationInProgress,styles:this.props.isPortalCreationInProgress?x.createPowerPortalFormSectionTextStyles:x.suffixTextStyle,autoComplete:"email",required:!0}),g.createElement("div",{role:"alert"},this.renderPortalSubDomainAvailability()))}renderTermsAggrement(){var e=[e=>g.createElement(l.Link,{href:S.default.powerPortalTermsAndCondition,target:"_blank"},e),e=>g.createElement(l.Link,{href:"#",onClick:this.props.onTermsOfServiceClick},e)];return g.createElement("div",{className:this.classNames.TermsAggrement},Object(v.formatResourceStringToElement)(this.resources.PowerPortal.CreateAppModal.FormSection.TermsAgree.label,(t,r)=>e[r](t)))}renderAddressLabel(e,t){return g.createElement("div",null,g.createElement("div",{className:this.classNames.addressLabel},g.createElement(h.Stack,{horizontal:!0,verticalAlign:"center",tokens:{childrenGap:-10}},g.createElement("span",{id:this.addressLabelId},t(e)),g.createElement(N.TooltipHost,{content:this.resources.PowerPortal.CreateAppModal.FormSection.Address.Info,calloutProps:{gapSpace:5}},g.createElement(i.IconButton,{iconProps:{iconName:P.fabricIcons.Info},className:this.classNames.infoIcon,ariaLabel:this.resources.PowerPortal.CreateAppModal.FormSection.Address.Info})))))}renderPortalSubDomainAvailability(){var e=this.state.portalSubDomain+this.portalDomain;if(!this.state.isPortalSubDomainValid)return g.createElement(g.Fragment,null);switch(this.props.portalSubDomainAvailability){case o.Loading:return g.createElement("div",{"aria-label":this.resources.PowerPortal.CreateAppModal.FormSection.Address.AriaStatus.inProgress},g.createElement(p.Spinner,{size:p.SpinnerSize.small,label:e,labelPosition:"right",className:this.classNames.spinner}));case o.Accept:return g.createElement("div",{className:this.classNames.addressValidationSuccess},g.createElement(n.Icon,{iconName:P.fabricIcons.Accept}),g.createElement("span",{"aria-label":this.resources.PowerPortal.CreateAppModal.FormSection.Address.AriaStatus.onSuccess,className:this.classNames.addressValidateSuccessMsg},e));case o.Reject:return g.createElement("div",{className:this.classNames.addressValidationError,"aria-label":this.resources.PowerPortal.CreateAppModal.FormSection.Address.AriaStatus.alreadyExist},this.resources.PowerPortal.CreateAppModal.FormSection.Address.Validation.AlreadyInUse.text);default:return g.createElement(g.Fragment,null)}}renderPrivacyStatement(){return g.createElement("div",{className:this.classNames.privacyStatement},g.createElement(l.Link,{href:S.default.powerPortalPrivacyStatement,target:"_blank"},this.resources.PowerPortal.CreateAppModal.FormSection.PrivacyStatement.label))}renderPartnerPortalServiceCheckList(){return this.props.sampleAppUniqueName===E.StaticSampleAppId.NewPowerPortalPartnerApp&&g.createElement("div",{className:this.classNames.checkList},g.createElement("div",null,this.resources.PowerPortal.CreateAppModal.FormSection.PartnerPortal.EnablePackages,g.createElement("span",{ref:this.partnerPortalPackageInfoCallout},g.createElement(i.IconButton,{className:this.classNames.infoIcon,iconProps:{iconName:P.fabricIcons.Info},onClick:this.onPartnerPortalPackageInfoClick,ariaLabel:this.resources.PowerPortal.CreateAppModal.FormSection.infoAriaLabel}))),g.createElement(a.Callout,{className:this.classNames.infoCallout,role:"alert",directionalHint:a.DirectionalHint.rightCenter,gapSpace:0,beakWidth:15,target:this.partnerPortalPackageInfoCallout.current,setInitialFocus:!1,onDismiss:this.onPartnerPortalPackageInfoDismis,hidden:!this.state.isPartnerPortalPackageInfoCalloutVisible},g.createElement("text",null,Object(v.formatResourceStringToElement)(this.resources.PowerPortal.CreateAppModal.FormSection.fieldAndProjectServiceInfo.description,(e,t)=>g.createElement(l.Link,{target:"_blank",href:S.default.partnerPortalServiceLearnMoreLink},e)))),g.createElement("div",{className:this.classNames.FieldService},g.createElement(u.Checkbox,{disabled:!this.props.isFieldServiceInstalled,ariaLabel:this.resources.PowerPortal.CreateAppModal.FormSection.PartnerPortal.EnablePackages+this.resources.PowerPortal.CreateAppModal.FormSection.PartnerPortal.FieldService,label:this.resources.PowerPortal.CreateAppModal.FormSection.PartnerPortal.FieldService,onChange:this.onPartnerPortalFieldServiceChange})),g.createElement("div",{className:this.classNames.ProjectService},g.createElement(u.Checkbox,{disabled:!this.props.isPartnerServiceInstalled,ariaLabel:this.resources.PowerPortal.CreateAppModal.FormSection.PartnerPortal.EnablePackages+this.resources.PowerPortal.CreateAppModal.FormSection.PartnerPortal.ProjectService,label:this.resources.PowerPortal.CreateAppModal.FormSection.PartnerPortal.ProjectService,onChange:this.onPartnerPortalProjectChange})))}renderIdeasPortalServiceCheckList(){var e=this.props.portalWebsiteIds||[],t=this.props.selectedWebsiteId?this.props.selectedWebsiteId:e.length>0?e[0].websiteId:void 0;return this.props.sampleAppUniqueName===E.StaticSampleAppId.NewPowerPortalIdeasApp&&e.length>0&&g.createElement("div",{className:this.classNames.languageDropDown},g.createElement(s.Dropdown,{defaultSelectedKey:t,onChanged:this.websiteIdSelected,label:this.resources.PowerPortal.CreateAppModal.FormSection.WebSiteName.label,options:e.map(e=>({key:e.websiteId,text:e.name})),disabled:this.props.isPortalCreationInProgress}))}renderPortalServiceCheckList(){if(this.props.sampleAppUniqueName!==E.StaticSampleAppId.NewPowerPortalApp||!C.featureGates.enableWebsitesDropdownForStarterPortalInPAhome)return null;var e=this.props.portalWebsiteIds||[],t={root:this.classNames.toolTipHostStyles},r=Object(c.getId)("tooltip"),o=this.props.selectedWebsiteId?this.props.selectedWebsiteId:e.length>0?e[0].websiteId:void 0,a={onRenderContent:()=>g.createElement("div",{className:this.classNames.toolTipHostStyles},this.resources.PowerPortal.CreateAppModal.FormSection.WebSiteNameForStarterPortal.Info,g.createElement(l.Link,{target:"_blank",href:S.default.starterPortalWebsiteLearnMore},this.resources.PowerPortal.CreateAppModal.FormSection.WebSiteNameForStarterPortal.learnMore))};return g.createElement(g.Fragment,null,g.createElement("div",{className:this.classNames.ExistingWebsite},g.createElement("div",null,g.createElement(u.Checkbox,{ariaLabel:this.resources.PowerPortal.CreateAppModal.FormSection.UseExistingWebsite.label,onChange:this.onUseExistingWebsiteChange})),g.createElement("div",{className:this.classNames.ExistingWebsiteLabel},g.createElement("div",null,this.resources.PowerPortal.CreateAppModal.FormSection.UseExistingWebsite.label),g.createElement(N.TooltipHost,{id:r,tooltipProps:a,styles:t},g.createElement(i.IconButton,{"aria-describedby":r,iconProps:{iconName:"Info"},className:this.classNames.iconTooltip})))),e.length>0&&this.state.onUseExistingWebsiteCheck&&g.createElement("div",{className:this.classNames.languageDropDown},g.createElement(s.Dropdown,{defaultSelectedKey:o,placeholder:this.resources.PowerPortal.CreateAppModal.FormSection.WebSiteNameForStarterPortalPlaceholder.title,onChanged:this.websiteIdSelected,label:this.resources.PowerPortal.CreateAppModal.FormSection.WebSiteNameForStarterPortal.label,options:e.map(e=>({key:e.websiteId,text:e.name}))})),0==e.length&&this.state.onUseExistingWebsiteCheck&&g.createElement(g.Fragment,null,g.createElement("div",{className:this.classNames.ExistingWebsiteDropDownLabel},this.resources.PowerPortal.CreateAppModal.FormSection.WebSiteNameForStarterPortal.label),g.createElement("div",{className:this.classNames.NoRecordFoundLabel},this.resources.PowerPortal.CreateAppModal.FormSection.UseExistingWebsite.noRecordFound)))}}var I=Object(c.styled)(T,x.getStyles)},5989:function(e,t,r){"use strict";r.r(t),r.d(t,"PortalTermsOfServiceBase",(function(){return l})),r.d(t,"PortalTermsOfService",(function(){return p}));var o=r(4084),a=r(545),s=r(245),n=r(2869),i=r(5990);class l extends s.Component{constructor(e){super(e),this.resources=void 0,this.classNames=void 0,this.resources=Object(n.getResources)(),this.classNames=Object(i.getClassNames)(this.props.styles,{theme:this.props.theme})}render(){var e=[{className:this.classNames.detailsSection,headerText:this.resources.PowerPortal.TermsOfServices.Header.label,headerClassName:this.classNames.header,onRenderBody:()=>this.renderBody()}],t=[{dismissableOnClick:()=>this.props.onDismiss(),primary:!0,text:this.resources.PowerPortal.TermsOfServices.ok}];return s.createElement(o.Modal,{isOpen:this.props.showModal,closeButtonAriaLabel:this.resources.Common.cancel,isBlocking:!0,onDismiss:this.props.onDismiss,footerButtons:t,styles:this.classNames.subComponentStyles,sections:e})}renderBody(){return s.createElement("div",{className:this.classNames.body},s.createElement("p",null,this.resources.PowerPortal.TermsOfServices.Paragraph1),s.createElement("p",null,this.resources.PowerPortal.TermsOfServices.Paragraph2),s.createElement("p",null,this.resources.PowerPortal.TermsOfServices.Paragraph3),s.createElement("p",null,this.resources.PowerPortal.TermsOfServices.Paragraph4),s.createElement("p",null,this.resources.PowerPortal.TermsOfServices.Paragraph5),s.createElement("p",null,this.resources.PowerPortal.TermsOfServices.Paragraph6),s.createElement("p",null,this.resources.PowerPortal.TermsOfServices.Paragraph7),s.createElement("p",null,this.resources.PowerPortal.TermsOfServices.Paragraph8),s.createElement("p",null,this.resources.PowerPortal.TermsOfServices.Paragraph9),s.createElement("p",null,this.resources.PowerPortal.TermsOfServices.Paragraph10),s.createElement("p",null,this.resources.PowerPortal.TermsOfServices.Paragraph11))}}var p=Object(a.styled)(l,i.getStyles)},5990:function(e,t,r){"use strict";r.r(t),r.d(t,"getClassNames",(function(){return n})),r.d(t,"getStyles",(function(){return i}));var o=r(545),a=r(2882),s=r(5492),n=Object(o.classNamesFunction)(),i=e=>{var{theme:t}=e,{palette:r}=t;return{header:{fontSize:"20px",lineHeight:"28px",fontFamily:s.fonts.segoeUi,color:a.fabricColors.neutralTuatara},detailsSection:{flex:"1 0 380px",fontSize:"14px",lineHeight:"20px",fontFamily:s.fonts.segoeUi,color:a.fabricColors.neutralChicago,borderRight:"none"},body:{height:"352px",overflowY:"auto",padding:"0 11px 0 16px",marginRight:"5px"},subComponentStyles:e=>({container:{width:"680px",height:"476px"},sectionHeader:{width:"624px",height:"28px",margin:"16px 40px 16px 16px"},sectionContent:{height:"396px",padding:"0"},footer:{borderTop:"solid 1px ".concat(r.neutralLighter),height:"63px",padding:"16px 24px"},closeButton:{position:"relative",top:"24px",right:"16px",width:"32px",height:"32px",padding:"0"}})}}},5991:function(e,t,r){"use strict";r.r(t),r.d(t,"CreateAppFormSectionBase",(function(){return b})),r.d(t,"CreateAppFormSection",(function(){return v}));var o=r(1368),a=r(545),s=r(1429),n=r(1755),i=r(245),l=r(5619),p=r(2869),c=r(5656),d=r(5658),u=r(5992),m=r(5994),h=r(5629),g=r(5642),P=r(5996),S=r(5997);class b extends i.Component{constructor(e){super(e),this.classNames=void 0,this.resources=void 0,this.resources=Object(p.getResources)(),this.classNames=Object(m.getClassNames)(this.props.styles,{theme:this.props.theme})}render(){return i.createElement("div",{className:Object(a.css)(this.props.className,this.props.isGlobalErrorMessagePresent?this.classNames.sectionWithErrorMessage:this.classNames.section)},i.createElement(n.Shimmer,{isDataLoaded:this.props.componentLoadState!==h.ComponentLoadState.Loading,customElementsGroup:this.props.customShimmerElements()},this.renderTextField(),this.renderFormFactorField(),this.renderDesignerTargetField(),this.renderConnectionsSection()))}renderTextField(){var e=Object(d.getSampleAppFormSectionTextFieldLabel)(this.props.sampleAppType);return(this.props.sampleAppType!==c.SampleAppTypes.Model||this.props.initialDisplayName)&&i.createElement("div",{className:this.classNames.appNameTextField},i.createElement(s.TextField,{label:e,ariaLabel:e,required:!0,disabled:this.props.isDisplayNameReadOnly,errorMessage:this.props.fieldErrorMessage,defaultValue:this.props.initialDisplayName,onChange:(e,t)=>this.props.onAppNameChanged(t),styles:this.props.sampleAppType===c.SampleAppTypes.PowerPortal&&this.props.isDisplayNameReadOnly?m.createAppFormSectionTextStyles:void 0,autoComplete:"username","data-test-id":S.powerPlatformDataIds.canvasCreateTextId}))}renderFormFactorField(){return this.props.allowedFormFactors&&this.props.allowedFormFactors.length>1&&i.createElement("div",{className:this.classNames.formFactorChoiceGroup},i.createElement(o.ChoiceGroup,{label:this.resources.CreateAppModal.FormSection.ChoiceGroup.format,selectedKey:this.props.selectedFormFactor,options:this.props.allowedFormFactors.map(e=>({key:e,text:Object(l.getFormFactorDisplayName)(e)})),onChange:(e,t)=>this.props.onFormFactorChanged(t.key)}))}renderDesignerTargetField(){return this.props.sampleAppType===c.SampleAppTypes.Model&&!this.props.initialDisplayName&&i.createElement("div",{className:this.classNames.designerTargetChoiceGroup},i.createElement(o.ChoiceGroup,{label:this.resources.CreateAppModal.FormSection.ChoiceGroup.designer,selectedKey:this.props.selectedModelAppDesignerTarget===g.ModelAppDesignerTarget.Modern?g.ModelAppDesignerTarget.Modern:g.ModelAppDesignerTarget.Classic,options:[{key:g.ModelAppDesignerTarget.Modern,text:Object(P.getModelAppDesignerTargetDisplayName)(g.ModelAppDesignerTarget.Modern)},{key:g.ModelAppDesignerTarget.Classic,text:Object(P.getModelAppDesignerTargetDisplayName)(g.ModelAppDesignerTarget.Classic)}],onChange:(e,t)=>this.props.onModelAppDesignerTargetChanged(t.key)}))}renderConnectionsSection(){return this.props.connectionReferences&&this.props.connectionReferences.length>0&&i.createElement("div",{className:this.classNames.appConnectionsSection},i.createElement("div",{className:this.classNames.appConnectionsHeader},this.resources.CreateAppModal.DetailsSection.Connections.connectsTo),i.createElement("div",{className:this.classNames.appConnectionsList},this.props.connectionReferences.map((e,t)=>i.createElement(u.ConnectionTile,{key:t,connectionReference:e,styles:{root:{marginRight:"8px"},image:{borderRadius:"2px",boxShadow:"0px 1px 3px rgba(0, 0, 0, 0.15)",height:"32px",width:"32px"}}}))))}}var v=Object(a.styled)(b,m.getStyles)},5992:function(e,t,r){"use strict";r.r(t),r.d(t,"ConnectionTileBase",(function(){return i})),r.d(t,"ConnectionTile",(function(){return l}));var o=r(687),a=r(545),s=r(245),n=r(5993);class i extends s.Component{constructor(e){super(e),this.classNames=void 0,this.classNames=Object(n.getClassNames)(this.props.styles)}render(){var e=this.props.connectionReference;return e&&s.createElement("div",{key:e.id,className:this.classNames.root},s.createElement(o.Icon,{iconType:o.IconType.image,title:e.displayName,ariaLabel:e.displayName,imageProps:{src:e.iconUri,alt:e.displayName,styles:{image:this.classNames.image}}}))}}var l=Object(a.styled)(i,n.getStyles)},5993:function(e,t,r){"use strict";r.r(t),r.d(t,"getClassNames",(function(){return a})),r.d(t,"getStyles",(function(){return s}));var o=r(545),a=Object(o.classNamesFunction)();function s(e){return{root:{marginRight:"12px"},image:{width:"36px",height:"36px"}}}},5994:function(e,t,r){"use strict";r.r(t),r.d(t,"getClassNames",(function(){return c})),r.d(t,"getStyles",(function(){return u})),r.d(t,"createAppFormSectionTextStyles",(function(){return m}));var o=r(1259),a=r(5492),s=r(2882),n=r(5995);function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){p(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function p(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var c=Object(o.classNamesFunction)(),d={selectors:{[n.mediumWidthSelector]:{paddingTop:"24px"}}},u=e=>{var{theme:t}=e,{palette:r}=t;return{section:l({paddingTop:"10px"},d),sectionWithErrorMessage:l({paddingTop:"0px"},d),appNameTextField:{marginTop:"0px",label:{color:r.neutralPrimary}},formFactorChoiceGroup:{fontFamily:a.fonts.segoeUiSemilight,marginTop:"11px"},designerTargetChoiceGroup:{fontFamily:a.fonts.segoeUiSemilight,marginTop:"11px"},appConnectionsSection:{flex:"1 0 150px",maxWidth:"250px",marginTop:"10px"},appConnectionsHeader:{fontWeight:o.FontWeights.regular,color:r.neutralPrimary,fontSize:"14px",lineHeight:"19px",fontFamily:a.fonts.segoeUi,marginBottom:"5px"},appConnectionsList:{margin:"8px 0",display:"flex",flexFlow:"row wrap"}}},m={field:{color:s.fabricColors.neutralTertiary}}},5995:function(e,t,r){"use strict";r.r(t),r.d(t,"isLesserOrEqualToScreenSize",(function(){return c})),r.d(t,"isEqualToScreenSize",(function(){return d})),r.d(t,"getClassNames",(function(){return u})),r.d(t,"mediumWidthBreakPoint",(function(){return m})),r.d(t,"mediumWidthSelector",(function(){return h})),r.d(t,"getStyles",(function(){return S}));var o=r(545),a=r(5492),s=r(2882),n=r(1259);function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){p(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function p(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function c(e){return Object(n.getResponsiveMode)(window)<=e}function d(e){return Object(n.getResponsiveMode)(window)===e}var u=Object(o.classNamesFunction)(),m=639,h="@media screen and (max-width: ".concat(m,"px)"),g={flex:"1 0 50%",fontSize:"14px",lineHeight:"20px",fontFamily:a.fonts.segoeUi,color:s.fabricColors.neutralTuatara,paddingLeft:"24px",paddingRight:"24px"},P={flex:"1 0 50%",fontSize:"14px",lineHeight:"20px",fontFamily:a.fonts.segoeUi,color:s.fabricColors.neutralChicago,paddingLeft:"24px",paddingRight:"0px"},S=e=>({header:{fontSize:"20px",lineHeight:"28px",fontFamily:a.fonts.segoeUi,color:s.fabricColors.neutralTuatara,marginTop:"20px",marginBottom:"10px"},formSection:l({},g),formSectionWithErrorMessage:l(l({},g),{},{paddingTop:"0px",selectors:{"div[class^='sectionContent']":{paddingTop:"20px"}}}),formSectionOthersFromBlank:l({},g),formSectionOthersFromBlankWithErrorMessage:l(l({},g),{},{paddingTop:"0px",selectors:{"div[class^='sectionContent']":{paddingTop:"20px"}}}),detailsSection:l({},P),detailsSectionOthersFromBlank:l({},P),appSelectionSection:{flex:1,padding:"0px 20px 24px 20px",overflowX:"hidden"},subComponentStyles:{modalStyles:e=>({container:{width:"900px",borderRadius:"2px"},header:{paddingLeft:"24px",paddingRight:"24px"},section:{borderRight:"none"},footer:{borderTop:"none",padding:"24px 20px 24px 24px"},closeButton:{color:s.fabricColors.neutralChicago,marginTop:"24px",marginRight:"-8px",selectors:{":hover":{color:s.fabricColors.neutralChicago},[h]:{marginTop:"20px",marginRight:"16px"}}},sectionContent:{paddingRight:"0px",paddingLeft:"0px"}})},removePaddingFromLink:{paddingLeft:"0px !important"},backButtonContainer:{display:"flex",flexDirection:"row",alignItems:"center"},backButton:{margin:"14px 6px 0 -4px",selectors:{i:{marginLeft:"0px"}}}})},5996:function(e,t,r){"use strict";r.r(t),r.d(t,"getModelAppDesignerTargetDisplayName",(function(){return s}));var o=r(5642),a=r(2869);function s(e){return e===o.ModelAppDesignerTarget.Classic?Object(a.getResources)().ModelAppDesignerTarget.classic:Object(a.getResources)().ModelAppDesignerTarget.modern}},5998:function(e,t,r){"use strict";r.r(t),r.d(t,"getClassNames",(function(){return n})),r.d(t,"getStyles",(function(){return i})),r.d(t,"createPowerPortalFormSectionTextStyles",(function(){return l})),r.d(t,"suffixTextStyle",(function(){return p})),r.d(t,"eiCheckboxStyles",(function(){return c}));var o=r(1259),a=r(2882),s=r(5995),n=Object(o.classNamesFunction)(),i=e=>{var{theme:t}=e,{palette:r}=t;return{section:{overflowY:"auto",maxHeight:350,minHeight:"300px",padding:"4px",selectors:{[s.mediumWidthSelector]:{maxHeight:void 0}}},address:{marginTop:"11px"},addressLabel:{padding:"5px 0"},languageDropDown:{marginTop:"11px"},TermsAggrement:{marginTop:"16px"},privacyStatement:{marginTop:"8px"},infoCallout:{width:"230px",padding:"8px"},infoCalloutDescription:{color:"#adabab"},infoIcon:{height:"100%",marginTop:"3px",color:"#666666"},required:{content:"*",color:r.redDark,paddingLeft:"5px"},spinner:{paddingTop:"8px",justifyContent:"flex-start"},addressValidationError:{paddingTop:"8px",color:r.redDark},addressValidationSuccess:{paddingTop:"8px",color:r.themePrimary},addressValidateSuccessMsg:{paddingLeft:"6px"},checkList:{marginTop:"16px"},checkListTitle:{},FieldService:{marginTop:"12px"},ProjectService:{marginTop:"12px"},eiDiv:{marginTop:"16px"},ExistingWebsite:{marginTop:"12px",display:"flex"},iconTooltip:{height:"22px"},ExistingWebsiteLabel:{marginLeft:"4px",display:"flex"},ExistingWebsiteDropDownLabel:{marginTop:"12px",fontWeight:"600"},NoRecordFoundLabel:{marginTop:"4px"},toolTipHostStyles:{display:"inline-block"},toolTipContainer:{margin:12,padding:0}}},l={field:{color:a.fabricColors.neutralTertiary},suffix:{color:a.fabricColors.neutralTertiary,backgroundColor:a.fabricColors.neutralLight}},p={suffix:{color:a.fabricColors.doveGray,backgroundColor:a.fabricColors.neutralLight}},c={root:{display:"inline-block",marginRight:"5px"}}}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/165.b210d09f.chunk.js.map