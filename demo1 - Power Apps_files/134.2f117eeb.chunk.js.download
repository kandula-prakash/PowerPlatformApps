/*! For license information please see 134.2f117eeb.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[134],{5774:function(e,t,o){"use strict";o.r(t),o.d(t,"CreateEditFormKeys",(function(){return n})),o.d(t,"SolutionNewEditPanel",(function(){return k}));var n,i=o(245),a=o(5148),l=o(2812),s=o(684),r=o(5629),d=o(5127),u=o(4013),c=o(2846),p=o(1697),m=o(1573),b=o(1201),g=o(2882),S=o(1089),P=o(5775),E=o(5617),f=o(2869),y=o(5776),w=o(2699),v=o(1795),h=o(1259),M=o(5777),N=o(5780);function O(){return(O=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e}).apply(this,arguments)}function x(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function R(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?x(Object(o),!0).forEach((function(t){j(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):x(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function j(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}!function(e){e.displayName="displayName",e.name="name",e.version="version",e.publisher="publisher",e.installedOn="installedOn",e.description="description",e.configurationPage="configurationPage"}(n||(n={}));var C=/^[0-9]+\.[0-9]+(\.[0-9]+)?(\.[0-9]+)?$/,T=/[^A-Z0-9_]+/gi,k=e=>{var t,{defaultPanelProps:o}=e,x=Object(f.getResources)(),j=Object(E.getPortalTheme)(),[k,L]=Object(i.useState)(!1),[B,F]=Object(i.useState)(e.isManaged?{publisher:null===(t=l.filter(e.publisherOptions,{key:e.publisher&&e.publisher.publisherId})[0])||void 0===t?void 0:t.key}:{[n.version]:e.version}),[I,A]=Object(i.useState)({displayName:!!e.displayName,name:!!e.name,version:!!e.version,publisher:!!e.publisher&&!!e.publisher.publisherId}),[D,q]=Object(i.useState)(),[z,K]=Object(i.useState)(!0),[W,U]=Object(i.useState)(!0),[_,V]=Object(i.useState)(!1),[G,H]=Object(i.useState)(),J=Object(i.useRef)(),Z=Object(i.useRef)(),{storeFocus:$,restoreFocus:Q}=Object(P.useRestoreFocus)();Object(i.useEffect)(()=>(e.onMount(),()=>{e.onDismount()}),[]),Object(i.useEffect)(()=>{if(e.publisherOptions.length>0){var t,o;if(!D&&null!==(t=e.publisher)&&void 0!==t&&t.publisherId)q(null===(o=e.publisher)||void 0===o?void 0:o.publisherId);H(te(e.publisherOptions))}},[e.publisher,e.publisherOptions]),Object(i.useEffect)(()=>{(!e.isEditMode&&e.createSolutionResponse.failed||e.isEditMode&&e.updateSolutionResponse.failed)&&Q()},[e.isEditMode,e.createSolutionResponse.failed,e.updateSolutionResponse.failed,Q]);var X,Y,ee=()=>{e.onPanelClose()},te=e=>{var t=[];return e&&(t=e.sort((e,t)=>e.text.localeCompare(t.text))),t},oe=(t,o)=>i=>{if(!W||i||e.isEditMode||o===n.publisher){var a=t(i);if(A(R(R({},I),{},{[o]:void 0===a})),o===n.publisher&&i!==D){var l=B;l[o]=i,F(l),q(i),L(!0),U(!1)}return a}},ne=e.isManaged?x.Model.Solutions.NewEditPanel.Managed:x.Model.Solutions.NewEditPanel.Unmanaged,ie=e.isManaged,ae=e.isManaged?x.Model.Solutions.NewEditPanel.Label.Publisher.View:x.Model.Solutions.NewEditPanel.Label.Publisher.Edit,le=e.configurationPage&&l.filter(e.configurationPageOptions,{key:e.configurationPage})[0],se=[{key:"",text:x.Model.Solutions.NewEditPanel.configurationPageNone},...e.configurationPageOptions];if(!e.isEditMode&&e.createSolutionResponse.loading||e.isEditMode&&e.updateSolutionResponse.loading)X={spinnerProps:{size:b.SpinnerSize.large,label:e.createSolutionResponse.loading?x.Model.Solutions.Create.inProgressMessage:x.Model.Solutions.Update.inProgressMessage}};else if(!e.isEditMode&&e.createSolutionResponse.failed||e.isEditMode&&e.updateSolutionResponse.failed)Y={messageBarProps:{messageBarType:p.MessageBarType.error,dismissButtonAriaLabel:x.Common.close,isMultiline:!1,truncated:!0},onRenderBody:()=>i.createElement("span",null,e.createSolutionResponse.message||e.updateSolutionResponse.message||"")};else if(!e.isEditMode&&e.createSolutionResponse.success||e.isEditMode&&e.updateSolutionResponse.success){var re=e.isEditMode?e.updateSolutionResponse.message:e.createSolutionResponse.message;X={spinnerProps:{size:b.SpinnerSize.large,label:e.isEditMode?x.Model.Solutions.Update.inProgressMessage:x.Model.Solutions.Create.inProgressMessage}},Object(N.announce)(re,"assertive",ee)}return Object(r.isLoading)(e.loadProgress)?X={spinnerProps:{size:b.SpinnerSize.large}}:Object(r.getTotalLoadingState)(e.loadProgress)===r.ComponentLoadState.Complete&&!B.configurationPage&&le&&Z.current&&Z.current.setValue(le.key),Object(i.useEffect)(()=>{var t=e.isEditMode?e.updateSolutionResponse.failed:e.createSolutionResponse.failed;_&&t&&V(!1)},[_,e.updateSolutionResponse,e.createSolutionResponse,e.isEditMode]),i.createElement(u.Panel,O({},o,{closeButtonType:u.PanelCloseButtonType.Back,closeButtonAriaLabel:x.Common.close,onDismiss:e.createSolutionResponse.loading||e.updateSolutionResponse.loading?void 0:ee,type:m.PanelType.smallFixedFar,headerText:e.isEditMode?x.Model.Solutions.EditPanel.title:x.Model.Solutions.NewPanel.title,footerButtons:[{primary:!0,ariaLabel:e.isEditMode?x.Model.Solutions.EditPanel.updateButton:x.Model.Solutions.NewPanel.createButton,text:e.isEditMode?x.Model.Solutions.EditPanel.updateButton:x.Model.Solutions.NewPanel.createButton,disabled:e.isEditMode&&!k||!(I.displayName&&I.name&&I.publisher&&I.version)||e.createSolutionResponse.loading||e.updateSolutionResponse.loading||_,type:"submit",dismissableOnClick:()=>{var t=B?R({},B):{};e.isEditMode||!B.displayName||B.name||(t[n.name]=B.displayName.replace(T,"")),V(!0),F(t),$(),e.onSaveClick(t)}},{ariaLabel:x.Common.Save.cancel,text:x.Common.Save.cancel,dismissableOnClick:ee,disabled:e.createSolutionResponse.loading||e.updateSolutionResponse.loading}],loadingOverlay:X,messageBar:Y,className:y.solutionNewEditPanelStyleClasses.newEditSolutionPanel}),i.createElement(d.Form,{onUpdated:(t,o)=>{var i;t===n.name&&o&&o!==(i=B.displayName&&B.displayName.replace(T,""))&&K(!1);var a=B;a[t]=o,F(a),U(!1),e[t]!==o&&L(!0),t===n.displayName&&z&&!e.isEditMode&&(i=B.displayName.replace(T,""),J.current.setValue(i))},showErrorsWhenPristine:!0},i.createElement(d.FormTextInput,{textFieldProps:{className:"newEditSolutionPanel_displayName",label:x.Model.Solutions.NewEditPanel.displayName,required:!0,disabled:ie},inputKey:n.displayName,value:e.displayName,validators:[oe(a.required(Object(S.formatResourceString)(x.Model.Solutions.NewEditPanel.Error.RequiredColumn,x.Model.Solutions.NewEditPanel.displayName)),n.displayName),oe(a.maxLength(256,e=>x.Model.Solutions.NewEditPanel.Error.LessThan256),n.displayName),oe(e=>""===e.trim()?Object(S.formatResourceString)(x.Model.Solutions.NewEditPanel.Error.CannotBeBlank,x.Model.Solutions.NewEditPanel.displayName):void 0,n.displayName)],debounceInterval:10}),i.createElement(d.FormTextInput,{textFieldProps:{className:"newEditSolutionPanel_name",label:x.Model.Solutions.NewEditPanel.name,required:!0,disabled:e.isEditMode||ie},componentRef:J,inputKey:n.name,value:e.name,validators:[oe(a.required(Object(S.formatResourceString)(x.Model.Solutions.NewEditPanel.Error.RequiredColumn,x.Model.Solutions.NewEditPanel.name)),n.name),oe(e=>{if(e&&T.test(e))return x.Model.Solutions.NewEditPanel.Error.nameFormat},n.name),oe(a.maxLength(50,e=>x.Model.Solutions.NewEditPanel.Error.LessThan50),n.name)],debounceInterval:10}),i.createElement(v.Stack,{horizontal:!0,tokens:{childrenGap:2},verticalAlign:"end"},i.createElement("div",{className:"newEditSolutionPanel_comboBox",role:"cell",style:{width:"89%"}},i.createElement(h.ComboBox,{options:G,label:x.Model.Solutions.NewEditPanel.publisher,required:!0,selectedKey:D,placeholder:x.Model.Solutions.NewEditPanel.selectPublisher,styles:y.publisherDropdownStyles,onChange:(e,t)=>{oe(a.required(Object(S.formatResourceString)(x.Model.Solutions.NewEditPanel.Error.RequiredColumn,x.Model.Solutions.NewEditPanel.publisher)),n.publisher)(null==t?void 0:t.key.toString())},disabled:ie,useComboBoxAsMenuWidth:!0,allowFreeform:!0})),i.createElement(s.IconButton,{iconProps:{iconName:e.isManaged?"View":"Edit"},title:ae,ariaLabel:ae,onClick:()=>{e.onEditPublisher(D),w.featureGates.enablePublisherPanel||e.openLegacySolutionPublisherDetailUI(B.publisher)},disabled:!D})),i.createElement(s.ActionButton,{className:"newEditSolutionPanel_addPublisher",iconProps:{iconName:"Add"},ariaLabel:x.Model.Solutions.Settings.addNewPublisherAriaLabel,onClick:e.onCreateNewPublisher,disabled:e.isManaged},x.Model.Solutions.Settings.addNewPublisher),i.createElement(d.FormTextInput,{textFieldProps:{label:x.Model.Solutions.NewEditPanel.version,required:!0,disabled:ie||e.isSolutionParentWithPatches},inputKey:n.version,value:e.version,validators:[oe(a.required(Object(S.formatResourceString)(x.Model.Solutions.NewEditPanel.Error.RequiredColumn,x.Model.Solutions.NewEditPanel.version)),n.version),oe(a.maxLength(256,e=>x.Model.Solutions.NewEditPanel.Error.LessThan256),n.version),oe(a.regex(C,x.Model.Solutions.NewEditPanel.Error.Format),n.version)],debounceInterval:10}),i.createElement(c.Accordion,{text:x.Model.Solutions.NewEditPanel.moreOptions,buttonAs:s.ActionButton,styles:{root:{height:"24px",marginTop:"20px",marginLeft:"0",paddingLeft:"0",backgroundColor:g.fabricColors.white},label:{color:j.palette.themePrimary,fontSize:"16px",marginLeft:"0",verticalAlign:"middle"},menuIcon:{color:j.palette.themePrimary,fontSize:"12px",lineHeight:"16px",marginTop:"4px"}},onRenderContent:()=>i.createElement("div",null,i.createElement(d.FormDatePicker,{datePickerProps:{label:x.Model.Solutions.NewEditPanel.installedOn,disabled:!0},inputKey:n.installedOn,value:e.installedOn||new Date}),i.createElement(d.FormDropdown,{inputKey:n.configurationPage,componentRef:Z,dropdownProps:{options:se,label:x.Model.Solutions.NewEditPanel.configurationPage,defaultSelectedKey:B.configurationPage||le&&le.key,disabled:ie}}),i.createElement(d.FormTextInput,{textFieldProps:{label:x.Model.Solutions.NewEditPanel.description,multiline:!0,rows:4,disabled:ie},value:B.description||e.description,inputKey:n.description,debounceInterval:10}),i.createElement("div",{className:"new-edit-solution-packageType"},i.createElement("div",{className:"new-edit-solution-packageType-header"},i.createElement(M.FieldLabelWithInfoIcon,{customLabelId:x.Model.Solutions.NewEditPanel.PackageType.label+"id",customLabelText:x.Model.Solutions.NewEditPanel.PackageType.label,calloutContent:i.createElement("div",{className:y.solutionNewEditPanelStyleClasses.tooltipContent},x.Model.Solutions.NewEditPanel.PackageType.calloutText)})),i.createElement("div",{className:"new-edit-solution-packageType-value"},ne)))})))}},5775:function(e,t,o){"use strict";o.r(t),o.d(t,"useRestoreFocus",(function(){return i}));var n=o(245),i=()=>{var e=Object(n.useRef)();return{storeFocus:Object(n.useCallback)(()=>{e.current=document.activeElement},[e]),restoreFocus:Object(n.useCallback)(()=>{if(e.current){var t=e.current;e.current=void 0,document.contains(t)&&"function"==typeof t.focus&&t.focus()}},[e])}}},5776:function(e,t,o){"use strict";o.r(t),o.d(t,"publisherDropdownStyles",(function(){return a})),o.d(t,"solutionNewEditPanelStyleClasses",(function(){return l}));var n=o(719),i=o(2882),a={title:{borderRadius:"2px",border:"1px solid ".concat(i.fabricColors.neutralTertiaryAlt),boxSizing:"border-box"},label:{fontWeight:"normal"}},l=Object(n.mergeStyleSets)({newEditSolutionPanel:["new-edit-solution-panel",{selectors:{".ba-Panel-content label":{fontWeight:"normal",paddingTop:"16px",paddingBottom:"8px"},".ba-Panel-content .Stack label":{fontWeight:"normal",paddingTop:"16px",paddingBottom:"8px"},".new-edit-solution-packageType":{display:"block",selectors:{".new-edit-solution-packageType-header":{marginLeft:-6,paddingTop:"16px",paddingBottom:"8px",button:{marginLeft:6}},".new-edit-solution-packageType-value":{fontSize:"14px",lineHeight:"16px",textAlign:"left",color:i.fabricColors.accentGray}}}}}],tooltipContent:{margin:10}})},5780:function(e,t,o){"use strict";function n(e,t,o){var n=document.createElement("div"),i="announce-".concat(Date.now());n.setAttribute("id",i),n.setAttribute("aria-live",t||"polite"),n.setAttribute("style","position: absolute; width: 1px; height: 1px; margin: -1px; padding: 0; border: 0; overflow: hidden;"),n.classList.add("sr-only"),document.body.prepend(n),window.setTimeout(()=>{var t=document.getElementById(i);t&&(t.innerHTML=e)},100),window.setTimeout(()=>{var e=document.getElementById(i);e&&document.body.removeChild(e)},5e3),o&&window.setTimeout(()=>{o()},800)}o.r(t),o.d(t,"announce",(function(){return n}))}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/134.2f117eeb.chunk.js.map