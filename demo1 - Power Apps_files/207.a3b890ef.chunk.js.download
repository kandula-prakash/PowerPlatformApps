(window.webpackJsonp=window.webpackJsonp||[]).push([[207],{6463:function(e,t,s){"use strict";s.r(t),s.d(t,"ImportTranslationPanel",(function(){return T}));var n=s(245),o=s(4013),i=s(1573),r=s(1697),a=s(1201),l=s(684),p=s(2869),m=s(6464),c=s(2885),u=s(6466);function d(){return(d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n])}return e}).apply(this,arguments)}function h(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function f(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?h(Object(s),!0).forEach((function(t){g(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):h(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function g(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class T extends n.Component{static getDerivedStateFromProps(e,t){return t.waitingForResponse&&e.importTranslationResponse&&e.importTranslationResponse.success?{panelOpenIndex:t.panelOpenIndex+1,waitingForResponse:!1}:{}}constructor(e){super(e),this.resources=void 0,this.fileInputRef=void 0,this.getMainPanel=e=>{var t;return this.props.importTranslationResponse&&this.props.importTranslationResponse.failed&&(t={messageBarProps:{messageBarType:r.MessageBarType.error,dismissButtonAriaLabel:this.resources.Common.close},onRenderBody:()=>n.createElement(n.Fragment,null,this.props.importTranslationResponse.message)}),f(f({},e),{},{headerText:this.resources.Model.Solutions.Commands.importTranslation.title,children:this.getImportTranslationForm(),messageBar:t,footerButtons:[{primary:!0,disabled:this.disableImportButton(),navigateableOnClick:e=>(this.props.onImport(this.state.fileContent),this.setState({fileContent:"",fileErrorMessage:"",waitingForResponse:!0}),e),ariaLabel:this.resources.ImportExport.Import.Button.label,text:this.resources.ImportExport.Import.Button.label},{ariaLabel:this.resources.Common.Save.cancel,text:this.resources.Common.Save.cancel,navigateableOnClick:e=>e-1}]})},this.getImportResponsePanel=e=>{var t;return this.props.importTranslationResponse&&this.props.importTranslationResponse.success&&(t={messageBarProps:{messageBarType:r.MessageBarType.success,dismissButtonAriaLabel:this.resources.Common.close},onRenderBody:()=>n.createElement(n.Fragment,null,this.props.importTranslationResponse.message)}),f(f({},e),{},{headerText:this.resources.Model.Solutions.Commands.importTranslation.title,messageBar:t,children:this.getResponseMessage(),footerButtons:[{primary:!0,disabled:!this.props.importTranslationResponse.success,navigateableOnClick:e=>e+1,ariaLabel:this.resources.Model.Solutions.Components.NewCommand.Dialog.closeButtonText,text:this.resources.Model.Solutions.Components.NewCommand.Dialog.closeButtonText}]})},this.onChange=e=>{var t=e.target.files,s=t.length>0?t[0]:void 0,n="";0===t.length?n=this.resources.Model.Solutions.Commands.importTranslation.nofile:"application/x-zip-compressed"!==s.type&&"application/zip"!==s.type&&(n=this.resources.Model.Solutions.Commands.importTranslation.nonzipFile),""===n?Object(c.getBase64String)(s).then(e=>{this.setState({fileContent:e,fileErrorMessage:n,fileName:s.name})}).catch(e=>{throw e}):this.setState({fileErrorMessage:n,fileName:""})},this.handleOnBrowseClick=()=>{if(this.fileInputRef.current){var e=window.navigator.userAgent;if(e.indexOf("Trident/")>0){var t=e.indexOf("rv:");11===parseInt(e.substring(t+3,e.indexOf(".",t)),10)&&(this.fileInputRef.current.value="")}this.fileInputRef.current.click()}},this.getImportTranslationForm=()=>n.createElement(n.Fragment,null,this.resources.Model.Solutions.Commands.importTranslation.subtext,n.createElement("div",{className:u.importTranslationTextPanel.fileSelectionContainer},n.createElement("input",{type:"file",style:{display:"none"},ref:this.fileInputRef,onChange:this.onChange}),n.createElement("div",null,n.createElement("div",{className:u.importTranslationTextPanel.fileTextDiv},n.createElement("label",{className:u.importTranslationTextPanel.fileNameText},this.resources.Model.Solutions.Commands.importTranslation.fileName),n.createElement("label",{className:u.importTranslationTextPanel.requiredText},"*")),n.createElement("div",{className:u.importTranslationTextPanel.fileSelectionDiv},n.createElement(l.DefaultButton,{className:u.importButtonStyles.defaultButtonStyle,onClick:this.handleOnBrowseClick,ariaLabel:"".concat(this.resources.Model.Solutions.Commands.importTranslation.subtext," ").concat(this.resources.Model.Solutions.Commands.importTranslation.fileName)},this.resources.Model.Solutions.Commands.importTranslation.chooseFile),n.createElement("span",{className:u.importTranslationTextPanel.nofilechosenText},this.state.fileName?this.state.fileName:"".concat(this.resources.Model.Solutions.Commands.importTranslation.noFileChosen)))),n.createElement("div",{className:u.importTranslationTextPanel.errorDiv},n.createElement("span",{className:u.importTranslationTextPanel.errorText},this.state.fileErrorMessage)))),this.getResponseMessage=()=>this.props.importTranslationResponse&&this.props.importTranslationResponse.success?n.createElement(n.Fragment,null,this.resources.Model.Solutions.Commands.importTranslation.successBody):null,this.disableImportButton=()=>!(""===this.state.fileErrorMessage||void 0===this.state.fileErrorMessage||null===this.state.fileErrorMessage)||""===this.state.fileContent||void 0===this.state.fileContent||null===this.state.fileContent,this.setPanelOpenIndex=e=>{this.state.panelOpenIndex!==e&&this.setState({panelOpenIndex:e})},this.resources=Object(p.getResources)(),this.fileInputRef=n.createRef(),this.state={panelOpenIndex:0,fileContent:"",fileErrorMessage:"",waitingForResponse:!1,fileName:""}}render(){var e;this.props.importTranslationResponse&&this.props.importTranslationResponse.loading&&(e={spinnerProps:{size:a.SpinnerSize.large,label:this.resources.Model.Solutions.Commands.importTranslation.inProgress}});var t={hasCloseButton:!0,closeButtonType:o.PanelCloseButtonType.Back,closeButtonAriaLabel:this.resources.Common.close,type:i.PanelType.smallFixedFar,loadingOverlay:e},s=[this.getMainPanel(t),this.getImportResponsePanel(t)];return n.createElement(m.MultistepPanel,d({customWidth:void 0,dismissDialog:void 0,dismissOnEscape:void 0,isBlocking:!0,isHiddenOnDismiss:!0,onDismissed:void 0,onLightDismissClick:void 0,showDismissDialog:void 0,isLightDismiss:!1,onOuterClick:void 0,isOpen:void 0},this.props.defaultPanelProps,{onDismiss:this.props.onDismiss,panelsListProps:s,panelOpenIndex:this.state.panelOpenIndex,setPanelOpenIndex:this.setPanelOpenIndex}))}}},6466:function(e,t,s){"use strict";s.r(t),s.d(t,"importButtonStyles",(function(){return r})),s.d(t,"importTranslationTextPanel",(function(){return a}));var n=s(719),o=s(5492),i=s(2882),r=Object(n.mergeStyleSets)({defaultButtonStyle:{height:20,padding:0}}),a=Object(n.mergeStyleSets)({fileSelectionContainer:{marginTop:2},fileTextDiv:{marginBottom:2},fileSelectionDiv:{marginTop:5,marginBottom:5},nofilechosenText:{marginLeft:5,fontSize:12},requiredText:{paddingLeft:5,color:i.fabricColors.brightRed},fileNameText:{fontFamily:o.fonts.segoeUi,fontWeight:n.FontWeights.semibold,fontSize:14,color:i.fabricColors.black},errorDiv:{marginTop:10},errorText:{fontFamily:o.fonts.segoeUi,fontSize:12,color:i.fabricColors.brightRed}})}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/207.a3b890ef.chunk.js.map