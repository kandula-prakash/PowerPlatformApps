(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/13.js?v=1.4.3886-master"]={begin:performance.now()},(window.__wpJsonpUci=window.__wpJsonpUci||[]).push([[13,93],{"+Ljw":function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"c",(function(){return c})),n.d(e,"b",(function(){return l}));var a=n("SAYH"),r=n("jq7Z"),i=n("arV0"),s=n("y60j");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function o(t,e,n=!1){var a;const{entityTypeName:o}=Object(i.j)(t,e),c=Object(s.l)(t,o);if(!n)return c;const l=Object(r.a)(t,e),u=null===(a=null==l?void 0:l.formSelector)||void 0===a?void 0:a.forms;let d=c;if(u&&Object.keys(u).length>0){d=new Object;for(const t in c)u[t]&&!u[t].visible||(d[t]=c[t])}return d}function c(t,e,n){var o,c;const l=Object(r.a)(t,e),u=a.a.toString(n);if(null===(c=null===(o=null==l?void 0:l.formSelector)||void 0===o?void 0:o.forms)||void 0===c?void 0:c[u])return l.formSelector.forms[u].visible;const{entityTypeName:d}=Object(i.j)(t,e);return!!Object(s.k)(t,d,n)||null}function l(t,e){var n;const a=Object(r.a)(t,e);return null===(n=null==a?void 0:a.formSelector)||void 0===n?void 0:n.selectedFormId}},"+aj2":function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return i}));var a=n("bq0x");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const r="quickCreateForm.output";function i(t,e){return{type:"quickCreateForm.output.async",execute({dispatch:n,getState:i}){const s=Object(a.a)(i(),t)||[];return s.push(e),n(function(t,e){return{type:r,payload:{reason:"close",value:e},meta:{pageId:t}}}(t,s)),Promise.resolve(t)}}}},"/5se":function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return i}));var a=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const r="controls.DefaultView";function i(t,e,n,i){const s=Object(a.w)(n);return{type:r,payload:i.guid,meta:{pageId:t,controlName:e,contextKey:s}}}},"/q/W":function(t,e,n){"use strict";n.d(e,"a",(function(){return m}));var a=n("SoKF"),r=n("RrRQ"),i=n("i1f0"),s=n("4UCL"),o=n("zmL5"),c=n("dHD5"),l=n("bT7G"),u=n("jTSi"),d=n("O7zD"),h=n("PUjk"),g=n("arV0"),p=n("odYE");function m(t){return{type:"handle.unsaved.changes.async",execute:({dispatch:e,getState:n},m,b)=>e(Object(a.a)(t)).then(a=>{if(a){const a=Object(o.a)(n(),t),m=a.map(t=>Object(c.j)(n(),t));for(let t=0;t<a.length;t++){const o=a[t],c=m[t],h=Object(i.hc)(n(),o,c),g=Object(l.b)(n(),h),p=(null==g?void 0:g.activeChanges)?Object.keys(g.activeChanges):[];for(const t of p)e(Object(u.b)(c,o,Object(d.d)(o,t)));e(Object(r.c)(o,h,c)),e(Object(s.d)(o,c))}if(!Object(i.Qb)(n(),t)){const a=Object(g.j)(n(),t),i=Object(h.b)(t,a),s=null==i?void 0:i.getBpfEntityLogicalName(),o=null==i?void 0:i.getProcessInstanceId(),c=s&&o?new p.a(s,o):null,u=Object(l.c)(n(),c);(null==u?void 0:u.snapshotId)&&e(Object(r.b)(u.snapshotId))}return!0}return!1})}}},"/q65":function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return i}));var a=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const r="attribute.targets.set";function i(t,e,n,i){const s=Object(a.y)(e);return{type:r,payload:i,meta:{pageId:t,contextKey:s,dataFieldName:n}}}},"0L4T":function(t,e,n){"use strict";n.d(e,"c",(function(){return d})),n.d(e,"a",(function(){return h})),n.d(e,"b",(function(){return g}));var a=n("j2fa"),r=n("YxC/"),i=n("GEBM"),s=n("z8iZ"),o=n("DAWX"),c=n("3/02"),l=n("Lyxw"),u=n("SAYH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function d(t,e,n,a,s){let o=null;if(o=Object(r.b)(t,i.p),"function"==typeof n.get_ErrorCode)switch(n.get_ErrorCode()){case-2147093999:o=Object(r.b)(t,i.q);break;case-2147220960:o=Object(r.b)(t,i.n);break;case-2147164125:o=Object(r.b)(t,i.a);break;case-2147164130:case-2147164126:o=Object(r.b)(t,i.i);break;case-2147217149:o=Object(r.b)(t,i.h);break;case-2147217098:o=Object(r.b)(t,i.w);break;case-2147220969:case-2147187962:o=Object(r.b)(t,i.o);break;default:n.get_Message()&&(o=o+" "+n.get_Message())}h(t,e,o,a,s)}function h(t,e,n,r,i){let d=null;d=function(t){const e=Object(s.a)();return e.ErrorInformation=new o.a,e.ErrorInformation.set_ErrorDescription(t),e}(n),Object(l.f)(t,c.wg)?(e(Object(a.a)(r.getStorageKey(),d)),Object(a.e)(t,e,r.getStorageKey(),i)):(e(Object(a.c)(u.a.toString(r.visualizationId)||u.a.EMPTYGUIDSTRING,u.a.toString(r.viewId)||u.a.EMPTYGUIDSTRING,d)),Object(a.d)(t,e,u.a.toString(r.visualizationId)||u.a.EMPTYGUIDSTRING,u.a.toString(r.viewId)||u.a.EMPTYGUIDSTRING,i))}function g(t,e,n,a,s,o){h(e,n,-2147220960===t?Object(r.b)(e,i.n):a,s,o)}},"0Vvg":function(t,e,n){"use strict";n.d(e,"a",(function(){return p}));var a=n("Nb1E"),r=n("+pAH"),i=n("qpML"),s=n("/oKV"),o=n("ZPAw"),c=n("Uv1Y"),l=n("LbMF"),u=n("5Oca"),d=n("SAYH"),h=n("lY/Z");function g(t,e,n,a){return{type:r.a,payload:{identifier:t,attributeName:e,fileState:{operationType:i.a.Delete,fileProgress:a,pageId:n}}}}function p(t,e,n,r=!1){return{type:"delete.file",async execute({dispatch:p,getState:m},b){const y=b.TraceManager.getTracer("DeleteFile");let f=s.a.Default;const v=Object(o.b)(m(),t,e,r);f=v?s.a.Local:s.a.Remote;const O=[];O.push({name:"IsUpSync",value:r}),O.push({name:"IsOfflineDelete",value:v}),O.push({name:"FileAttributeName",value:e}),O.push({name:"EntityName",value:t.etn}),O.push({name:"RecordId",value:t.id.guid.toString()});try{await p(Object(a.c)(t,e,f,void 0,n));const r=Object(u.h)(m(),t.etn,d.a.toString(t.id)),s=Object(l.b)(e,t.etn,m()),c=Object(o.a)(m(),t,e,s),y=Object(u.A)(m(),t,c,e);return null!=y&&(r.fields[c].list.splice(y,1),p(function(t,e){const n={entities:{[t.etn]:{[d.a.toString(t.id)]:e}}};return{type:h.a,payload:n}}(t,r))),p(g(t,e,n,i.b.Finished)),void b.EventManager.ReportComponentSuccess("DeleteFile",O)}catch(a){p(g(t,e,n,i.b.Failed)),y.error("deleteFile : Failed to delete the file",O);const r=Object(c.c)(a);throw b.EventManager.ReportComponentFailure("DeleteFile",r,"",O),r}}}}},"3HPu":function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return r}));var a=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const r="form.invalidAttributes";function i(t,e,n,i){const s=Object(a.w)(i);return{type:r,payload:{attributeName:e,isValid:n},meta:{pageId:t,attributeName:e,contextKey:s}}}},"3MuQ":function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return i}));var a=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const r="section.label";function i(t,e,n,i){const s=Object(a.w)(e);return{type:r,payload:i,meta:{pageId:t,contextKey:s,sectionName:n}}}},"3c9R":function(t,e,n){"use strict";n.d(e,"a",(function(){return u})),n.d(e,"b",(function(){return d}));var a=n("jRy5"),r=n("dHD5"),i=n("i1f0"),s=n("mIxf"),o=n("bT7G"),c=n("arV0"),l=n("ApeL");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const u="attribute.precision";function d(t,e,n,d){return{type:"attribute.precision.update",sync:!0,execute({dispatch:h,getState:g},p){let m=g();h(function(t,e,n,i){if(e&&e.contextTokenType&&e.contextTokenType===a.a.GridRow)return Object(l.e)(t,e,n,i);const s=Object(r.y)(e);return{type:u,payload:i,meta:{pageId:t,contextKey:s,dataFieldName:n}}}(t,e,n,d)),m=g();let b=null,y=null,f=null,v=null;if(e&&e.contextTokenType&&e.contextTokenType===a.a.GridRow)b=e.entityTypeName?e.entityTypeName:null,y=e.recordId?e.recordId:null,f=Object(r.u)(e),v=Object(r.s)(e);else{const n=Object(c.j)(m,t);b=n&&n.entityTypeName?n.entityTypeName:null,y=n&&n.id?n.id:null,f=null,v=e}const O=Object(i.hc)(m,t,e),C=Object(o.e)(m,O,{etn:b,id:y},n),S={[n]:C};h(Object(s.a)(t,S,!0,!0,b,y?y.guid:null,f,v))}}}},"4U8P":function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return s}));var a=n("dHD5"),r=n("i1f0");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i="header.commandbarvisible";function s(t,e,n){return{type:"header.commandbarvisible.sync",sync:!0,execute({dispatch:s,getState:o},c){const l=Object(r.Hb)(o(),t);s(function(t,e,n){const r=Object(a.w)(e);return{type:i,payload:n,meta:{pageId:t,contextKey:r}}}(t,e,!l&&n))}}}},"65OV":function(t,e,n){"use strict";n.d(e,"a",(function(){return g}));var a=n("ILmX"),r=n("eD3A"),i=n("ZdjS"),s=n("wgH2"),o=n("odYE"),c=n("cUMa"),l=n("6hHv"),u=n("GT4X"),d=n("RD1j"),h=n("yc+y");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function g(t,e,n,g,m,b,y,f,v,O,C,S,j){if(!t||!t.commands||void 0===t.commands[n]||null===t.commands[n])return Promise.reject(void 0);const I=Object(a.l)(t,n,null),T=Object(s.c)(t,n);if(T)T.ContextTypeMask=j;else if(Object(h.c)(n))return Promise.resolve([]);f&&m.length>0&&1===m.length&&m.map(t=>{t.etn!==T.EntityLogicalName&&(T.EntityId=t.id,T.EntityLogicalName=t.etn)});const x=Object.assign({},T);C&&(x.CustomControlType=C);const A=m.map(t=>({EntityReference:t})),_=T.SelectedItems.map(t=>t.EntityReference),N=!0===S||!1===S?S:!Object(c.a)(_,m,o.a.equals);return x.SelectedItems=A,function(t,e,n,r,i,s,o,c,d){if(r)return c(Object(l.e)(e,n,i,s,o)).then(e=>Object(a.c)(t,e,i,s,n.SelectedItems.length>0));const h=Object(u.e)(t,s);return Promise.resolve(Object(a.c)(t,h,i,s,n.SelectedItems.length>0))}(t,I,x,N,e,n,g,b).then(a=>{const s=[];if(y&&y.length>0)y.forEach(t=>{if(a[t]){const r=a[t].Priority;if(!v||null!=r){const r=Object(i.a)(I,x,a[t].CommandType,a[t].CommandId,a[t].ControlId,e,n,g),o={commandId:a[t].CommandId,commandButtonId:t,execute:r,label:a[t].LabelText,canExecute:a[t].CanExecute,shouldBeVisible:a[t].ShouldBeVisible,icon:a[t].Icon,tooltip:a[t].Tooltip,children:[]};s.push(o)}}});else if(O){(function(t,e,n,a,r,i,s){const o=[],c=[];let l=new Array;e.Layout.Tabs.Tab&&(l=l.concat(e.Layout.Tabs.Tab));e.Layout.ContextualTabs.Tab&&(l=l.concat(e.Layout.ContextualTabs.Tab));l.forEach(e=>{e&&e.Groups&&e.Groups.Group&&e.Groups.Group.forEach(e=>{e.Controls.Items.forEach(e=>{const n=Object(d.b)(t,i,e.Id);n&&((e=Object.assign({},e)).Menu=n),c.push(e)})})});for(;c.length>0;){const t=p(c.pop(),n,e,a,r,i,s);t&&o.push(t)}return o})(t,I,a,x,e,n,g).forEach(t=>{s.push(t)})}else for(const t in a)if(a[t].CanExecute){const o=a[t].Priority;if(!v||null!=o){const o=Object(i.a)(I,x,a[t].CommandType,a[t].CommandId,a[t].ControlId,e,n,g),c={commandId:a[t].CommandId,commandButtonId:t,execute:o,label:Object(r.h)(a[t].LabelText),canExecute:a[t].CanExecute,shouldBeVisible:a[t].ShouldBeVisible,icon:a[t].Icon,tooltip:a[t].Tooltip,children:[]};s.push(c)}}return v&&function(t,e){const n=[t];for(;n.length>0;){const t=n.pop();t.sort(e),t.forEach(t=>{t.children&&t.children.length>0&&n.push(t.children)})}}(s,(t,e)=>{const n=a[t.commandButtonId].Priority,r=a[e.commandButtonId].Priority;return n<r?-1:n>r?1:0}),s})}function p(t,e,n,s,o,c,l){let u=null;const d=t&&t.Id&&Object(a.j)(t.Id,null==s?void 0:s.ContextEntityLogicalName);if(t&&t.Id&&d&&e[d]){const a=Object(i.a)(n,s,e[d].CommandType,e[d].CommandId,e[d].ControlId,o,c,l);u={commandId:e[d].CommandId,commandButtonId:d,execute:a,label:Object(r.h)(e[d].LabelText),canExecute:e[d].CanExecute,shouldBeVisible:e[d].ShouldBeVisible,icon:e[d].Icon,tooltip:e[d].Tooltip,children:[],controlType:t.ControlType},"Menu"in t&&t.Menu&&t.Menu.MenuSection&&t.Menu.MenuSection.forEach(t=>{t.Item&&t.Item.Items&&t.Item.Items.forEach(t=>{const a=p(t,e,n,s,o,c,l);a&&u.children.push(a)})})}return u}},"6Qf/":function(t,e,n){"use strict";n.d(e,"f",(function(){return m})),n.d(e,"d",(function(){return b})),n.d(e,"e",(function(){return v})),n.d(e,"a",(function(){return g})),n.d(e,"b",(function(){return p})),n.d(e,"c",(function(){return f}));var a=n("SAYH"),r=n("dHD5"),i=n("BFlg"),s=n("ZJsz"),o=n("P6DH"),c=n("3/02"),l=n("Lyxw"),u=n("ujVH"),d=n("jAuy"),h=n("TFb5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const g="grid.initialize",p="grid.initialize.xrmready";function m(t,e,n){return{type:"grid.preinitialize.sync",sync:!0,execute({dispatch:a,getState:r},s){const o=i.N+".gridPreInitializedAction";try{a(y(null,t,e,n,void 0,void 0,void 0,void 0,null));const r=[{name:"entityTypeName",value:t}];return s.EventManager.ReportComponentSuccess(o,r),Promise.resolve(void 0)}catch(e){const n="Failed for "+t+" with error "+e.message;return s.EventManager.ReportComponentFailure(o,Error(n)),Promise.resolve(void 0)}}}}function b(t,e,n,a,r,d,h,g,p){return t?{type:"grid.initialize.async",execute({dispatch:m,getState:b},f){const v=i.N+".gridInitializedAction";try{let i=null;Object(l.f)(b(),c.Yc)&&(i=function(t,e,n){const a=Object(o.v)(t,e,n),r=Object.assign({},s.a);return a&&(a.filters&&(r.filters=a.filters),a.customFilter&&(r.customFilter=a.customFilter),a.pageNumber&&(r.pageNumber=a.pageNumber),a.pagingRefreshInput&&(r.pagingRefreshInput=a.pagingRefreshInput)),r}(b(),n,a)),m(y(t,e,n,a,r,d,h,g,i,p));const O=[];O.push({name:"entityTypeName",value:e}),f.EventManager.ReportComponentSuccess(v,O);return Object(l.f)(b(),c.pb)&&m(Object(u.b)(n,a)),Promise.resolve(void 0)}catch(t){const n="Grid initialized failed for entity type "+e;return f.EventManager.ReportComponentFailure(v,Error(n)),Promise.reject(void 0)}}}:null}function y(t,e,n,o,c,l,u,h,p,m){const b=c&&c.Parameters?c.Parameters[i.q]:null;try{let c=!0;b&&(c="true"===b);const y=Object(r.v)(o),f={contextKey:y,initialDataSetState:Object.assign(Object.assign(Object.assign({},s.a),p),{viewId:t?t.viewId:null,fetchXml:t?t.fetchXml:null,fetchXmlColumns:O(null==t?void 0:t.fetchXml),relationshipName:l,relationshipRoleOrdinal:u,useRollupView:h||!1,commandManagerId:m||Object(d.d)(n,o),controls:{homepageGrid:{parameters:{0:{Name:i.T,Value:t&&t.viewId?a.a.toString(t.viewId):null},1:{Name:i.q,Value:c},2:{Name:i.K,Value:e}}}}})};return{type:g,payload:f,meta:{pageId:n,contextKey:y}}}catch(t){throw Error(t)}}function f(t,e,n,o){const c=Object(r.v)(o),l=a.a.tryParseOrNull(e),u={contextKey:c,initialDataSetState:Object.assign(Object.assign({},s.a),{viewId:l||null,fetchXml:null,commandManagerId:Object(d.d)(n,o),controls:{homepageGrid:{parameters:{0:{Name:i.T,Value:e||null},1:{Name:i.q,Value:!1},2:{Name:i.K,Value:t}}}}})};return{type:g,payload:u,meta:{pageId:n,contextKey:c}}}function v(t,e,n,a){return e(t.ScriptManager.getContainer(a).getEventManager().loadGridScripts(n,a))}function O(t){if(t){const e=Object(h.w)(t);return Object(h.q)(e)}return[]}},"7TDv":function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const a="formSelector.visible";function r(t,e,n){return{type:a,payload:{visible:n},meta:{pageId:t,formId:e}}}},"7k+e":function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return s})),n.d(e,"c",(function(){return o}));var a=n("dHD5"),r=n("BFlg");const i="chart.drilldownparameters.update",s="ChartDrillDownParameters";function o(t,e,n){return{type:"chart.drilldownparameters.update.async",execute({dispatch:o,getState:c},l){const u=l.TraceManager.getTracer(r.P),d=r.N+".updateChartDrillDownParametersAction";try{u.info("Updating the chart drilldown parameters"),e||(e=Object(a.l)(c(),t));const r=Object(a.w)(e);return o(function(t,e,n){return{type:i,payload:{name:s,value:n},meta:{pageId:t,dataSetContextKey:e}}}(t,r,n)),l.EventManager.ReportComponentSuccess(d),Promise.resolve()}catch(t){const e="Updatation of the chart drilldown parameters failed with error : "+t.message;l.EventManager.ReportComponentFailure(d,Error(e))}}}}},"91Ew":function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return i}));var a=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const r="attribute.option.add";function i(t,e,n,i,s){const o=Object(a.y)(e);return{type:r,payload:{option:i,index:s},meta:{pageId:t,contextKey:o,dataFieldName:n}}}},"95Ij":function(t,e,n){"use strict";n.d(e,"e",(function(){return f})),n.d(e,"a",(function(){return m})),n.d(e,"d",(function(){return O})),n.d(e,"b",(function(){return y})),n.d(e,"c",(function(){return b}));var a=n("iZ7K"),r=n("arV0"),i=n("lY/Z"),s=n("odYE"),o=n("i1f0"),c=n("jq7Z"),l=n("pF61"),u=n("69Qu"),d=n("/oKV"),h=n("Uv1Y"),g=n("SAYH"),p=n("CyDF");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const m="addRecordStatesForBulkEditForm.sync",b="statecode",y=[b];function f(t,e){return{type:"retrieveRecordStatesForBulkEditForm.async",sync:!0,execute({dispatch:e,getState:n}){var c,m;const f=Object(r.j)(n(),t);if(!(null==f?void 0:f.entityTypeName)||!(null===(c=null==f?void 0:f.ids)||void 0===c?void 0:c.length))return;const O=Object(a.h)(n(),f.entityTypeName);if(null===(m=null==O?void 0:O.AttributeNames)||void 0===m?void 0:m.find(t=>t===b)){const a=Object(u.c)(n())?d.a.Remote:void 0;let r=null;for(let c=0;c<f.ids.length;c++){const u=f.ids[c],d=new s.a(f.entityTypeName,u);if(Object(l.m)(n(),t))break;const m=r?r.catch().finally(()=>Object(l.m)(n(),t)?()=>Promise.resolve(null):e(Object(i.e)(d,[...y],null,null,a))):e(Object(i.e)(d,[...y],null,null,a));r=m.then(()=>{if(!Object(l.m)(n(),t)){const a=Object(o.Rb)(n(),f.entityTypeName,u),r={};r[g.a.toString(u)]={isInactive:a,status:p.a.Success},e(v(t,r))}}).catch(a=>{if(!Object(l.m)(n(),t)){const n=Object(h.c)(a),r={};r[g.a.toString(u)]={error:n,status:p.a.Failure},e(v(t,r))}})}}else{const n=f.ids.reduce((t,e)=>(t[g.a.toString(e)]={isInactive:!1,status:p.a.Success},t),{});e(v(t,n))}}}}function v(t,e){return{type:m,payload:e,meta:{pageId:t}}}function O(t,e){var n;return null===(n=Object(c.a)(t,e))||void 0===n?void 0:n.bulkEditRecordStates}},"95wm":function(t,e,n){"use strict";n.d(e,"f",(function(){return m})),n.d(e,"c",(function(){return y})),n.d(e,"d",(function(){return f})),n.d(e,"b",(function(){return b})),n.d(e,"e",(function(){return v})),n.d(e,"a",(function(){return O}));var a=n("SAYH"),r=n("eXjw"),i=n("GEBM"),s=n("haag"),o=n("0L4T"),c=n("iZ7K"),l=n("YxC/"),u=n("69Qu"),d=n("WPtp"),h=n("LbMF"),g=n("/A0C"),p=n("37s6");const m=s.a;function b(t,e,n,r,d,h,g,b=!1){return function(t,e,n){if(!a.a.toString(n.viewId)){const n="viewid is required to call retrieve chart data";throw t.EventManager.ReportComponentFailure(m+".retrieveChartData",Error(n),s.d,e),new Error(n)}return!0}(n,r,d)&&function(t,e,n,r,s){if(!a.a.toString(n.visualizationId)||a.a.toString(n.visualizationId)===a.a.EMPTYGUIDSTRING){const a=t(),u=Object(l.b)(a,i.m),d=Object(c.f)(a,r)||r,h=String.format(u,d);return Object(o.a)(a,e,h,n,s),!1}return!0}(t,e,d,h,g)&&function(t,e,n,a){const r=t();if(Object(p.E)(r)?!Object(u.b)(r):!Object(u.c)(r)){const t=Object(l.b)(r,i.q);return Object(o.a)(r,e,t,n,a),!1}return!0}(t,e,d,g)&&function(t,e,n,a){if(n.isRollUpView){const r=t(),s=Object(l.b)(r,i.i);return Object(o.a)(r,e,s,n,a),!1}return!0}(t,e,d,g)&&(!b||function(t,e,n,a){if(!n.viewXml){const r=Object(l.b)(t(),i.f);return Object(o.a)(t(),e,r,n,a),!1}return!0}(t,e,d,g)&&function(t,e,n,a){if(!n.fetchXml){const r=Object(l.b)(t(),i.n);return Object(o.a)(t(),e,r,n,a),!1}return!0}(t,e,d,g))}function y(t,e,n){const i=new a.a(t),s=a.a.toString(i),o=new a.a(e);return{type:n,payload:{charts:{[s]:{[a.a.toString(o)]:{initialized:r.a.Initializing}}}}}}function f(t,e){return{type:e,payload:{chartData:{[t]:{initialized:r.a.Initializing}}}}}function v(t,e,n){var a;const r=null===(a=null==t?void 0:t.category)||void 0===a?void 0:a.primaryGroupBy,i=null==r?void 0:r.groupAttribute;if(!function(t,e){var n;if(!t)return!1;const a=null===(n=null==t?void 0:t.entity)||void 0===n?void 0:n.entityName,r=null==t?void 0:t.attributeName,i=Object(h.b)(r,a,e);return i===g.a.PickList||i===g.a.State||i===g.a.Status}(i,n))return;if(!t.isOrderPresentOnPrimaryGroupBy())return;const s=i.aliasName,o=new C(s);e.sort(o.comparator),r.descending&&e.reverse()}function O(t){const e=/(Name=\"o\:)(\w+)(,)(\d+)(\")/,n=t.match(new RegExp(e,"g"));let a=[];return n&&n.forEach(t=>{a=t.match(new RegExp(e,"m"))}),a}class C{constructor(t){this._primaryGroupByAttributeAlias=null,this.comparator=(t,e)=>this._getRawValue(t)-this._getRawValue(e),this._primaryGroupByAttributeAlias=t}_getRawValue(t){if(this._primaryGroupByAttributeAlias in t.fields){const e=t.fields[this._primaryGroupByAttributeAlias],n=Object(d.e)(e);return parseInt(n,10)}return-1}}},"9NSo":function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return i}));var a=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const r="form.setLabel";function i(t,e,n){const i=Object(a.w)(e);return{type:r,payload:{label:n},meta:{pageId:t,contextKey:i}}}},"9i5P":function(t,e,n){"use strict";n.d(e,"a",(function(){return v}));var a=n("OQLa"),r=n("SAYH"),i=n("16wZ"),s=n("UqyN"),o=n("L8zx"),c=n("3yqi"),l=n("EOIL"),u=n("P6DH"),d=n("qshH"),h=n("9ksH"),g=n("E7fB"),p=n("n6Qt"),m=n("arV0"),b=n("deGN"),y=n("ZIjf");let f;class v{constructor(t,e,n,a,r,s){const o="ClientApi.XrmGridRow.constructor";t||Object(i.j)(o,"store"),a||Object(i.j)(o,"pageId"),n||Object(i.j)(o,"contextToken"),r||Object(i.j)(o,"entityType"),s||Object(i.j)(o,"entityId"),f=t,this._applicationContext=e,this._pageId=a,this._contextToken=n,this._entityType=r,this._entityId=s}get applicationContext(){return y.a.instance.reportUsage("ClientApi.XrmGridRow.applicationContext_get"),this._applicationContext}get context(){const t="ClientApi.XrmGridRow.context";try{return y.a.instance.reportCall(t),this._globalContext||(this._globalContext=new g.a(f,this._pageId)),y.a.instance.reportSuccess(t),this._globalContext}catch(e){const n=d.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityType",value:this._entityType}),d.a.getInstance().reportFailure(t,e,null,n),e}}get data(){const t="ClientApi.XrmGridRow.data";try{if(y.a.instance.reportCall(t),!this._data){const e=new s.a(f,this._contextToken,this._pageId,this,this._entityType,this._entityId,O,this._applicationContext);this._data=new o.a(f,this._contextToken,this._pageId,this,e);const n=new h.b(f,this._pageId),a=[],i={isEventParam:!0,name:"attributeName",value:""};a.push(i),e.attributes.forEach(e=>{const s=e.getName();i.value=s;const o={Id:s,Label:null,Name:s,ShowLabel:!1,Visible:!0,ClassId:new r.a(h.a),Disabled:!1,DataFieldName:s},c=n.createXrmControl(this._contextToken,o,this,t,a);c&&e.controls.add(c.getName(),c)})}return y.a.instance.reportSuccess(t),this._data}catch(e){const n=d.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityType",value:this._entityType}),d.a.getInstance().reportFailure(t,e,null,n),e}}getData(){try{return y.a.instance.reportUsage("ClientApi.XrmGridRow.getData"),this.data}catch(t){const e=d.a.getInstance().getEventParameters(this._contextToken);throw e.push({name:"entityType",value:this._entityType}),d.a.getInstance().reportFailure("ClientApi.XrmGridRow.getData",t,null,e),t}}get ui(){try{if(y.a.instance.reportCall("ClientApi.XrmGridRow.ui"),!this._ui){const t=new h.b(f,this._pageId);this._ui=new l.a(f,this._contextToken,this._pageId,this,this._entityType,t)}return y.a.instance.reportSuccess("ClientApi.XrmGridRow.ui"),this._ui}catch(t){const e=d.a.getInstance().getEventParameters(this._contextToken);throw e.push({name:"entityType",value:this._entityType}),d.a.getInstance().reportFailure("ClientApi.XrmGridRow.ui",t,null,e),t}}getControl(t){const e="ClientApi.XrmGridRow.getControl";try{y.a.instance.reportCall(e);const n=this.ui.controls.get(t);return y.a.instance.reportSuccess(e),n}catch(t){const n=d.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityType",value:this._entityType}),d.a.getInstance().reportFailure(e,t,null,n),t}}getAttribute(t){const e="ClientApi.XrmGridRow.getAttribute";try{if(y.a.instance.reportCall(e),this.data.entity){const n=this.data.entity.attributes.get(t);return y.a.instance.reportSuccess(e),n}return y.a.instance.reportSuccess(e),null}catch(t){const n=d.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityType",value:this._entityType}),d.a.getInstance().reportFailure(e,t,null,n),t}}getUrl(t){const e="ClientApi.XrmGridRow.getUrl";try{y.a.instance.reportCall(e);const n=this.data.entity.getEntityReference();this._internal=new p.a(f,this._applicationContext,this.context,this._pageId);const i=Object(m.j)(f.getState(),this._pageId),s={entityTypeName:n.entityType,etn:n.name,id:r.a.fromExternalGuid(n.id),entityTypeCode:this._internal.getEntityCode(n.entityType),languageId:this.context.userSettings.languageId,recordSetQueryKey:i.recordSetQueryKey};if(1===t){const t=f.dispatch(Object(a.a)(c.a.EditForm,s));return y.a.instance.reportSuccess(e),t}const o=Object(b.a)(f,this._pageId),l=f.dispatch(Object(a.c)(o,c.a.EditForm,s));return y.a.instance.reportSuccess(e),l}catch(t){const n=d.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityType",value:this._entityType}),d.a.getInstance().reportFailure(e,t,null,n),t}}get entityReference(){try{return this.data.entity.getEntityReference()}catch(t){const e=d.a.getInstance().getEventParameters(this._contextToken);throw e.push({name:"entityType",value:this._entityType}),d.a.getInstance().reportFailure("ClientApi.XrmGridRow.entityReference",t,null,e),t}}}function O(t,e,n){const a=Object(u.E)(f.getState(),{id:n},e.parentContextToken);return a||(t.TraceManager.getTracer("ClientApi.XrmGridRow.getAttributeNames").error("Grid attributes was null"),[])}},"9ksH":function(t,e,n){"use strict";n.d(e,"b",(function(){return Nt})),n.d(e,"a",(function(){return At}));var a=n("AF/G"),r=n("arV0"),i=n("HcnX"),s=n("i1f0"),o=n("TsER"),c=n("qshH"),l=n("ZIjf");let u;class d extends i.a{constructor(t,e,n,a,r,i){super(t,e,n,a,r,i),u=t}refresh(){const t="ClientApi.XrmControlTimer.refresh";try{l.a.instance.reportCall(t),u.dispatch(Object(o.b)(this.pageId,this.contextToken,this.name)),l.a.instance.reportSuccess(t)}catch(e){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(t,e,null,n),e}}getState(){const t="ClientApi.XrmControlTimer.getState";try{l.a.instance.reportCall(t);const e=Object(s.fb)(u.getState(),this.pageId,this.contextToken),n=e.controls[this.getName()].parameters.timerState;return l.a.instance.reportSuccess(t),n}catch(e){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(t,e,null,n),e}}getControlType(){return l.a.instance.reportUsage("ClientApi.XrmControlTimer.getControlType"),"timercontrol"}}var h=n("lJW1"),g=n("1kth"),p=n("16wZ"),m=n("PUjk"),b=n("fh2P");let y;class f extends i.a{constructor(t,e,n,a,r,i){super(t,e,n,a,r,i),y=t,this.registerObserversForControlStateChange()}addOnClick(t){const e="ClientApi.XrmControlButton.addOnClick";t||Object(p.j)(e,"handler");try{l.a.instance.reportCall(e),y.dispatch(Object(g.b)(this.contextToken,this.pageId,this.name,t)),l.a.instance.reportSuccess(e)}catch(t){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(e,t,null,n),t}}removeOnClick(t){const e="ClientApi.XrmControlButton.removeOnClick";t||Object(p.j)(e,"handler");try{l.a.instance.reportCall(e),y.dispatch(Object(g.x)(this.contextToken,this.pageId,this.name,t)),l.a.instance.reportSuccess(e)}catch(t){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(e,t,null,n),t}}getControlType(){return l.a.instance.reportUsage("ClientApi.XrmControlButton.getControlType"),"button"}registerObserversForControlStateChange(){if(this.getName().startsWith(b.b)){const t=Object(m.a)(this.pageId);t&&this.controlStateObservable.registerObserver(t)}}}var v=n("0nOn"),O=n("yl9a"),C=n("NjDY"),S=n("3mEc");let j;class I extends i.a{constructor(t,e,n,a,r,i){super(t,e,n,a,r,i),j=t;const s=[{name:"controlName",value:r,isEventParam:!0}];this._clientApiExecutorWebResource=new v.a(t,"ClientApi.XrmControlWebResource.",n,e,s)}getSrc(){return this._clientApiExecutorWebResource.execute("getSrc",()=>{const t=j.getState(),e=Object(C.x)(t)+Object(s.Bb)(t,{controlName:this.name,id:this.pageId},this.contextToken);return Object(S.c)(t,this.pageId,this.name,this.contextToken,e)})}getContentWindow(){return this._clientApiExecutorWebResource.executeAsync("getContentWindow",(t,e)=>{const n=this.formContext.applicationContext.TraceManager.getTracer(t),a=()=>{const t=Object(s.Cb)(j.getState(),this.pageId,this.getName());if(t){let a=null;try{return a=t.contentWindow,"complete"===a.document.readyState?Promise.resolve(a):(e.push({name:"readyState",value:a.document.readyState}),n.info("Frame content window not ready",e),Promise.reject({message:"Frame element not ready.",errorCode:111,contentWindow:a}))}catch(t){return a?(e.push({name:"Error",value:t.message}),n.warn("Error getting Frame content window readyState",e),Promise.resolve(a)):Promise.reject(t)}}else n.info("Frame DOM element not ready",e);return Promise.reject({message:"Frame element could not be found.",errorCode:111})};return a().then(t=>t).catch(t=>{if(111!==t.errorCode)throw t;const r=this.contextToken,i=this.pageId,s=this.getName();return new Promise((t,o)=>{const c=()=>{Object(g.I)(r,i,c,s),a().then(e=>{t(e)}).catch(a=>{a.contentWindow?(n.err("Frame content window readyState should be complete after OnReadyStateComplete",e),t(a.contentWindow)):o&&(111===a.errorCode?(n.err("Frame Element not found after OnReadyStateComplete",e),o(new Error("Frame element could not be found."))):o(a))})};j.dispatch(Object(g.m)(r,i,c,s))})})})}getObject(){return this._clientApiExecutorWebResource.execute("getObject",()=>Object(s.Cb)(j.getState(),this.pageId,this.name))}setSrc(t){return this._clientApiExecutorWebResource.execute("getControlType",()=>{Object(p.a)(t)||j.dispatch(Object(O.b)(this.pageId,this.name,this.contextToken,t))})}getControlType(){return this._clientApiExecutorWebResource.execute("getControlType",()=>"webresource")}addOnReadyStateComplete(t){return this._clientApiExecutorWebResource.execute("addOnReadyStateComplete",()=>{j.dispatch(Object(g.m)(this.contextToken,this.pageId,t,this.getName()))},[{name:"handler",value:t,isRequired:!0}])}removeOnReadyStateComplete(t){return this._clientApiExecutorWebResource.execute("removeOnReadyStateComplete",()=>{j.dispatch(Object(g.I)(this.contextToken,this.pageId,t,this.getName()))},[{name:"handler",value:t,isRequired:!0}])}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let T;class x extends I{constructor(t,e,n,a,r,i){super(t,e,n,a,r,i),T=t}getInitialUrl(){const t="ClientApi.XrmControlIFrame.getInitialUrl";try{l.a.instance.reportCall(t);const e=Object(s.xb)(T.getState(),{controlName:this.name,id:this.pageId},this.contextToken);return l.a.instance.reportSuccess(t),e}catch(e){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(t,e,null,n),e}}getControlType(){return l.a.instance.reportUsage("ClientApi.XrmControlIFrame.getControlType"),"iframe"}getSrc(){const t="ClientApi.XrmControlIFrame.getSrc";try{l.a.instance.reportCall(t);const e=T.getState(),n=this.getInitialUrl(),a=Object(S.c)(e,this.pageId,this.name,this.contextToken,n);return l.a.instance.reportSuccess(t),a}catch(e){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(t,e,null,n),e}}}var A=n("bGh0"),_=n("/5se"),N=n("xorU"),E=n("fREn"),P=n("hA8P"),w=n("SAYH"),F=n("/q65");let k;class D extends A.a{constructor(t,e,n,a,r,i){super(t,e,n,a,r,i),k=t,this._clientApiExecutorLookup=new v.a(t,"ClientApi.XrmControlLookup.",n,e,[{name:"controlName",value:r,isEventParam:!0}])}addCustomView(t,e,n,a,r,i){this._clientApiExecutorLookup.execute("addCustomView",(s,o)=>{const c=w.a.tryParseOrNull(t);c||Object(p.k)(s,"guid","viewId",o),k.dispatch(Object(E.a)(this.pageId,this.name,c,e,this.contextToken,n,a,r)),i&&this.setDefaultView(t)},[{name:"viewId",value:t,isRequired:!0,isEventParam:!0,expectedDataType:"guid"},{name:"entityLogicalName",value:e,isRequired:!0,isEventParam:!0},{name:"viewDisplayName",value:n,isRequired:!0},{name:"fetchXml",value:a,isRequired:!0},{name:"layoutXml",value:r,isRequired:!0},{name:"isDefault",value:i,isRequired:!0}])}addCustomFilter(t,e){const n="ClientApi.XrmControlLookup.addCustomFilter";Object(p.a)(t)&&Object(p.j)(n,"fetchXmlFilter"),Object(p.b)(t)||Object(p.l)(n);try{l.a.instance.reportCall(n),k.dispatch(Object(N.d)(this.pageId,this.name,e,this.contextToken,t)),this.controlStateObservable.notifyObservers(this.controlDescriptor),l.a.instance.reportSuccess(n)}catch(t){const e=c.a.getInstance().getEventParameters(this.contextToken);throw e.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(n,t,null,e),t}}get disableMru(){const t="ClientApi.XrmControlLookup.getDisableMru";try{l.a.instance.reportCall(t);const e=Object(s.z)(k.getState(),{id:this.pageId,controlName:this.name},this.contextToken);return l.a.instance.reportSuccess(t),e}catch(e){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(t,e,null,n),e}}set disableMru(t){const e="ClientApi.XrmControlLookup.setDisableMru";try{l.a.instance.reportCall(e),k.dispatch(Object(P.b)(k.getState(),this.pageId,this.name,this.contextToken,t)),l.a.instance.reportSuccess(e)}catch(t){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(e,t,null,n),t}}startCustomFilter(){const t="ClientApi.XrmControlLookup.startCustomFilter";try{l.a.instance.reportCall(t),k.dispatch(Object(N.f)(this.pageId,this.name,this.contextToken)),this.controlStateObservable.notifyObservers(this.controlDescriptor),l.a.instance.reportSuccess(t)}catch(e){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(t,e,null,n),e}}endCustomFilter(){const t="ClientApi.XrmControlLookup.endCustomFilter";try{l.a.instance.reportCall(t),k.dispatch(Object(N.e)(this.pageId,this.name,this.contextToken)),this.controlStateObservable.notifyObservers(this.controlDescriptor),l.a.instance.reportSuccess(t)}catch(e){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(t,e,null,n),e}}getDefaultView(){return this._clientApiExecutorLookup.execute("getDefaultView",()=>{const t=Object(s.R)(k.getState(),this.pageId,this.name,this.contextToken);return t?w.a.externalGuid(new w.a(t)):null})}setDefaultView(t){this._clientApiExecutorLookup.execute("setDefaultView",(e,n)=>{const a=w.a.tryParseOrNull(t);a||Object(p.k)(e,"guid","id",n),k.dispatch(Object(_.b)(this.pageId,this.name,this.contextToken,a))},[{name:"defaultViewId",value:t,isRequired:!0,isEventParam:!0,expectedDataType:"guid"}])}addOnLookupTagClick(t){const e="ClientApi.XrmControlLookup.addOnLookupTagClick";t||Object(p.j)(e,"handler");try{l.a.instance.reportCall(e),k.dispatch(Object(g.g)(this.contextToken,this.pageId,this.name,t)),l.a.instance.reportSuccess(e)}catch(t){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(e,t,null,n),t}}addPreSearch(t){const e="ClientApi.XrmControlLookup.addPreSearch";t||Object(p.j)(e,"handler");try{l.a.instance.reportCall(e),k.dispatch(Object(g.u)(this.contextToken,this.pageId,this.name,t)),l.a.instance.reportSuccess(e)}catch(t){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(e,t,null,n),t}}removeOnLookupTagClick(t){const e="ClientApi.XrmControlLookup.removeOnLookupTagClick";t||Object(p.j)(e,"handler");try{l.a.instance.reportCall(e),k.dispatch(Object(g.C)(this.contextToken,this.pageId,this.name,t)),l.a.instance.reportSuccess(e)}catch(t){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(e,t,null,n),t}}removePreSearch(t){const e="ClientApi.XrmControlLookup.removePreSearch";t||Object(p.j)(e,"handler");try{l.a.instance.reportCall(e),k.dispatch(Object(g.Q)(this.contextToken,this.pageId,this.name,t)),l.a.instance.reportSuccess(e)}catch(t){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(e,t,null,n),t}}getControlType(){return l.a.instance.reportUsage("ClientApi.XrmControlLookup.getControlType"),"lookup"}getEntityTypes(){const t="ClientApi.XrmControlLookup.getEntityTypes";try{l.a.instance.reportCall(t);const e=Object(s.Vb)(k.getState(),this.pageId,this.contextToken,this._dataFieldName);return l.a.instance.reportSuccess(t),e}catch(e){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(t,e,null,n),e}}setEntityTypes(t){const e="ClientApi.XrmControlLookup.setEntityTypes";t||Object(p.j)(e,"entityTypes");const n=[];try{l.a.instance.reportCall(e),t=Array.from(new Set(t));const a=Object(s.Wb)(k.getState(),this.pageId,this.contextToken,this._dataFieldName),r={};a.forEach(t=>{r[t]=!0}),t.forEach(t=>{r[t]||n.push(t)})}catch(t){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(e+".validation",t,null,n),t}n.length>0&&Object(p.h)(e,"entityType",n[0]);try{k.dispatch(Object(F.b)(this.pageId,this.contextToken,this._dataFieldName,t)),l.a.instance.reportSuccess(e)}catch(t){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(e,t,null,n),t}}get _dataFieldName(){return this.controlDescriptor&&this.controlDescriptor.DataFieldName?this.controlDescriptor.DataFieldName:this.name}}var M=n("91Ew"),L=n("KnyI"),R=n("tvJg");let X;class V extends A.a{constructor(t,e,n,a,r,i){super(t,e,n,a,r,i),X=t;const s=[{name:"controlName",value:r,isRequired:!0,isEventParam:!0,expectedDataType:"string"}];this._clientApiExecutorOptionsetBase=new v.a(t,"ClientApi.XrmControlOptionSetBase.",n,e,s)}addOption(t,e){this._clientApiExecutorOptionsetBase.execute("addOption",()=>{const n=this._options.length;Object(p.a)(e)||isNaN(e)||e>=n?e=n:e<=0?e=0:e-=1,X.dispatch(Object(M.b)(this.pageId,this.contextToken,this.controlDescriptor.DataFieldName,{Color:null,Label:t.text,Value:t.value},e))},[{name:"optionSetItem",value:t,isRequired:!0},{name:"optionSetItem.value",value:null==t?void 0:t.value,isRequired:!0,expectedDataType:"number"}])}clearOptions(){this._clientApiExecutorOptionsetBase.execute("clearOptions",()=>{X.dispatch(Object(R.b)(this.pageId,this.contextToken,this.controlDescriptor.DataFieldName))})}removeOption(t){return this._clientApiExecutorOptionsetBase.execute("removeOption",()=>{X.dispatch(Object(L.b)(this.pageId,this.contextToken,this.controlDescriptor.DataFieldName,t))},[{name:"value",value:t,isRequired:!0}])}getOptions(){return this._clientApiExecutorOptionsetBase.execute("getOptions",()=>this._options)}get _options(){const t=new Array,e=Object(s.D)(X.getState(),this.pageId,this.contextToken,this.name);if(e){e.length&&t.push({text:"",value:NaN});for(const n in e)t.push({text:e[n].Label,value:e[n].Value})}return t}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class U extends V{getControlType(){return l.a.instance.reportUsage("ClientApi.XrmControlOptionSet.getControlType"),"optionset"}}var G=n("cf3Y");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let B;class Y extends A.a{constructor(t,e,n,a,r,i){super(t,e,n,a,r,i),this._isDateFormatDateTime=!1,B=t,this._clientApiExecutorDateTime=new v.a(t,"ClientApi.XrmControlDateTime.",n,e,[{name:"controlName",value:r,isEventParam:!0}]),this._clientApiExecutorDateTime.execute("constructor",(t,e)=>{this._isDateFormatDateTime=this._getShowTime(t,e)},null,!1)}getShowTime(){return this._clientApiExecutorDateTime.execute("getShowTime",(t,e)=>this._getShowTime(t,e))}setShowTime(t){this._clientApiExecutorDateTime.execute("setShowTime",(e,n)=>{if(this._getShowTime(e,n)!==t){const e=t&&this._isDateFormatDateTime?"datetime":"date";B.dispatch(Object(G.b)(this.pageId,this.contextToken,this.name,e))}})}_getShowTime(t,e){const n=this.getAttrDescriptor(t,e,this._clientApiExecutorDateTime);return!n||"datetime"===n.Format}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class z extends V{getControlType(){return l.a.instance.reportUsage("ClientApi.XrmControlMultiSelectOptionSet.getControlType"),"multiselectoptionset"}}var H=n("izYK"),q=n("zgeC"),W=n("dHD5"),K=n("HAeo"),Q=n("ghNp"),Z=n("P6DH");let J;class $ extends i.a{constructor(t,e,n,a,r){super(t,e,n,a,a.Name,r);const i=Object(W.e)(e,a.Name);t.dispatch(Object(Q.a)(this,n,i)),J=t,this._clientApiExecutorControlstream=new v.a(t,"ClientApi.XrmControlStream.",n,e)}get clientApiExecutor(){return this._clientApiExecutorControlstream}_getGridControls(){if(!this._underlyingGridControls){this._underlyingGridControls=[];const t=this.controlDescriptor.Parameters&&this.controlDescriptor.Parameters[0]&&this.controlDescriptor.Parameters[0].StreamObjects;if(t){const e=t.StreamObjectCollection;if(e){const t=e.ShowAsTiles?[!0,!1]:[!0];for(const n of e)for(const e of t){const t=Object(W.p)(this.contextToken,this.getName(),n.Id,e),a=new K.a(J,t,this.pageId,!1,3,!0,this.formContext.applicationContext,t.controlName);this._underlyingGridControls.push({contextToken:t,gridControl:a})}}}}return this._underlyingGridControls}refresh(){this.clientApiExecutor.execute("refresh",()=>{const t=[];for(const{contextToken:e,gridControl:n}of this._getGridControls()){if(Object(Z.kb)(J.getState(),this.pageId,e,e.controlName))try{n.refresh()}catch(e){t.push(e)}}if(t.length>0){const e=[...c.a.getInstance().getEventParameters(this.contextToken),{name:"count",value:t.length}];Object(p.e)(this.clientApiExecutor.getComponentName("refresh"),"Some grids in stream failed to refresh",null,e)}})}}var tt=n("odYE"),et=n("6QGX"),nt=n("tpZ5"),at=n("E7fB"),rt=n("jq7Z"),it=n("zsAz"),st=n("IaGr");let ot;class ct extends i.a{constructor(t,e,n,a,r,i){super(t,e,n,a,a.Name,r),ot=t,this._clientApiExecutor=new v.a(t,"ClientApi.XrmControlSubFormBase.",n,e,[{name:"controlName",value:null==a?void 0:a.Name,isEventParam:!0}]),this._xrmControlFactory=i}getParentComponent(){return Object(rt.a)(ot.getState(),this.pageId)}get context(){return this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.context",()=>this._form?this._form.context:null)}get _parentFormContext(){return this.formContext}get _form(){if(this._tryGetSubFormInstanceId(),!this._isSubFormMetadataLoaded())throw Object(it.d)("SUBFORM_METADATA_NOT_LOADED",2415919107);const t=this._subFormControlContextToken;if(t&&this._formInstance)return this._formInstance;const e=this._getValueInternal(),n=Object(et.d)(e);if(t)return this._formInstance=ot.dispatch(Object(Q.b)(this._subFormInstanceId,t)),this._formInstance||n&&n.length>0&&(this._formInstance=ot.dispatch(this._createXrmForm(t,this._subFormInstanceId,n[0].entityType,new w.a(n[0].id)))),this._formInstance&&!this._formInstance.context&&(this._formInstance.context=this._parentFormContext.context),this._formInstance;return c.a.getInstance().getEventParameters(this.contextToken).push({name:"controlName",value:this.getName()}),st.a.getInstance().traceManager.getTracer("ClientApi.XrmControlSubFormBase._form").info("XrmControlSubForm._form is null"),null}_createXrmForm(t,e,n,a){const r=this._xrmControlFactory;return{type:"clientapi.create.xrmform",sync:!0,execute(i,s){const o=new nt.a(i,{etn:n,id:a},r,t,e);o.applicationContext=s;const c=new at.a(i,e);return o.context=c,o}}}get _subFormControlContextToken(){const t=this._getValueInternal(),e=Object(et.d)(t);return e&&e[0]&&e[0].id?this._entityRecordId!==e[0].id&&(this._entityType=e[0].entityType,this._entityRecordId=e[0].id,this._subFormContextToken&&ot.dispatch(Object(Q.h)(this._subFormInstanceId,this._subFormContextToken)),this._subFormContextToken=this._getSubFormContextToken(this.contextToken,this.name,this._entityType),this._formInstance=null):this._subFormContextToken&&(ot.dispatch(Object(Q.h)(this._subFormInstanceId,this._subFormContextToken)),this._subFormContextToken=void 0,this._entityType=void 0,this._entityRecordId=void 0,this._formInstance=null),this._subFormContextToken}get data(){return this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.data",()=>this._form?this._form.data:null)}get ui(){return this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.ui",()=>this._form?this._form.ui:null)}get entityReference(){return l.a.instance.reportUsage("ClientApi.XrmControlSubFormBase.entityReference"),null}getControl(t){return this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.getControl",()=>this._form?this._form.getControl(t):null)}getAttribute(t){return this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.getAttribute",()=>this._form?this._form.getAttribute(t):null)}getUrl(){return this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.getUrl",()=>this._form?this._form.getUrl():null)}refresh(){this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.refresh",()=>{this.data&&this.data.refresh()})}_getValueInternal(){const t=this._parentFormContext.data.entity.getEntityName(),e=this._parentFormContext.data.entity.getId(),n=e?new tt.a(t,new w.a(e)):new tt.a(t),a=Object(s.hc)(ot.getState(),this._subFormInstanceId,this.contextToken);return Object(s.ab)(ot.getState(),this._subFormInstanceId,this._subFormContextToken,a,n,this.controlDescriptor.DataFieldName)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let lt;class ut extends ct{constructor(t,e,n,a,r,i){super(t,e,n,a,r,i),lt=t}_getSubFormContextToken(t,e,n){return Object(W.m)(this.contextToken,this.name,this._entityType)}getSubFormInstanceId(){return this.pageId}_isSubFormMetadataLoaded(){return!!this._subFormInstanceId}_tryGetSubFormInstanceId(){}get _subFormInstanceId(){return this.pageId}isLoaded(){const t="ClientApi.XrmControlQuickForm.isLoaded";try{l.a.instance.reportCall(t);const e=Object(s.pc)(lt.getState(),this.getSubFormInstanceId(),this._subFormControlContextToken);return l.a.instance.reportSuccess(t),!!e}catch(e){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(t,e,null,n),e}}getControlType(){return l.a.instance.reportUsage("ClientApi.XrmControlQuickForm.getControlType"),"quickform"}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let dt;class ht extends A.a{constructor(t,e,n,a,r,i){t||Object(p.j)("ClientApi.XrmStandardDataControl.constructor","store"),super(t,e,n,a,r,i),dt=t}getValue(){const t="ClientApi.XrmStandardDataControl.getValue";try{l.a.instance.reportCall(t);const e=Object(s.H)(dt.getState(),{controlName:this.name,id:this.pageId},this.contextToken);return l.a.instance.reportSuccess(t),e}catch(e){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),c.a.getInstance().reportFailure(t,e,null,n),e}}addOnKeyPress(t){const e="ClientApi.XrmStandardDataControl.addOnKeyPress";t||Object(p.j)(e,"handler");try{l.a.instance.reportCall(e),dt.dispatch(Object(g.e)(this.contextToken,this.pageId,this.name,t)),l.a.instance.reportSuccess(e)}catch(t){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),c.a.getInstance().reportFailure(e,t,null,n),t}}removeOnKeyPress(t){const e="ClientApi.XrmStandardDataControl.removeOnKeyPress";t||Object(p.j)(e,"handler");try{l.a.instance.reportCall(e),dt.dispatch(Object(g.A)(this.contextToken,this.pageId,this.name,t)),l.a.instance.reportSuccess(e)}catch(t){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),c.a.getInstance().reportFailure(e,t,null,n),t}}fireOnKeyPress(){const t="ClientApi.XrmStandardDataControl.fireOnKeyPress";try{l.a.instance.reportCall(t),dt.dispatch(Object(g.T)(this.contextToken,this.pageId,this.name,this)),l.a.instance.reportSuccess(t)}catch(e){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),c.a.getInstance().reportFailure(t,e,null,n),e}}}var gt=n("ywwS"),pt=n("VqBP"),mt=n("w92Z");class bt extends U{constructor(t,e,n,a,r,i){super(t,e,n,a,r,i),this._clientApiExecutorDependentOptionSet=new v.a(t,"ClientApi.XrmControlDependentOptionSet.",n,e,[{name:"controlName",value:r,isEventParam:!0}])}addOption(t,e){return this._clientApiExecutorDependentOptionSet.execute("addOption",(t,e)=>{Object(p.i)(t,"DependentOptionSet.addOption",e)})}clearOptions(){return this._clientApiExecutorDependentOptionSet.execute("clearOptions",(t,e)=>{Object(p.i)(t,"DependentOptionSet.clearOptions",e)})}removeOption(t){return this._clientApiExecutorDependentOptionSet.execute("removeOption",(t,e)=>{Object(p.i)(t,"DependentOptionSet.removeOption",e)})}setDisabled(t){return this._clientApiExecutorDependentOptionSet.execute("setDisabled",(t,e)=>{Object(p.i)(t,"DependentOptionSet.setDisabled",e)})}setVisible(t){return this._clientApiExecutorDependentOptionSet.execute("setVisible",(t,e)=>{Object(p.i)(t,"DependentOptionSet.setVisible",e)})}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class yt extends z{constructor(t,e,n,a,r,i){super(t,e,n,a,r,i),this._clientApiExecutorDependentOptionSet=new v.a(t,"ClientApi.XrmControlMultiSelectDependentOptionSet.",n,e,[{name:"controlName",value:r,isEventParam:!0}])}addOption(t,e){return this._clientApiExecutorDependentOptionSet.execute("addOption",(t,e)=>{Object(p.i)(t,"MultiSelectDependentOptionSet.addOption",e)})}clearOptions(){return this._clientApiExecutorDependentOptionSet.execute("clearOptions",(t,e)=>{Object(p.i)(t,"MultiSelectDependentOptionSet.clearOptions",e)})}removeOption(t){return this._clientApiExecutorDependentOptionSet.execute("removeOption",(t,e)=>{Object(p.i)(t,"MultiSelectDependentOptionSet.removeOption",e)})}setDisabled(t){return this._clientApiExecutorDependentOptionSet.execute("setDisabled",(t,e)=>{Object(p.i)(t,"MultiSelectDependentOptionSet.setDisabled",e)})}setVisible(t){return this._clientApiExecutorDependentOptionSet.execute("setVisible",(t,e)=>{Object(p.i)(t,"MultiSelectDependentOptionSet.setVisible",e)})}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class ft extends ht{setDisabled(t){const e="ClientApi.XrmDependentOptionSetGridControl.setDisabled";l.a.instance.reportUsage(e),Object(p.e)(e,String.format("Can not execute {0} for dependent option set control","setDisabled"))}}var vt=n("LbMF"),Ot=n("3/02"),Ct=n("Lyxw"),St=n("Z/4N"),jt=n("BoVI");let It;class Tt extends ct{constructor(t,e,n,a,r,i){super(t,e,n,a,r,i),this._formInstanceId=this._getSubFormInstanceId(),this._formComponentClientApiExecutor=new v.a(t,"ClientApi.XrmControlFormComponent.",this._formInstanceId),this._formComponentClientApiExecutor.addEventParameter({name:"controlName",value:a.Name,isEventParam:!0}),It=t}_getSubFormInstanceId(){var t,e;const n=null===(e=null===(t=this.getParentComponent())||void 0===t?void 0:t.formInstances)||void 0===e?void 0:e.formInstanceIdsByControlName[this.controlDescriptor.Name];return null==n?void 0:n[n.length-1]}_tryGetSubFormInstanceId(){this._formInstanceId||(this._formInstanceId=this._getSubFormInstanceId())}_isSubFormMetadataLoaded(){return!!this._subFormInstanceId}_getSubFormContextToken(t,e,n){return Object(W.h)(n)}get _subFormInstanceId(){return this._tryGetSubFormInstanceId(),this._formInstanceId}isLoaded(){return this._isSubFormMetadataLoaded()&&this._formComponentClientApiExecutor.execute("ClientApi.XrmControlFormComponent.isLoaded",()=>!!Object(s.Hc)(It.getState(),this._subFormInstanceId,this._subFormControlContextToken))}setInitializationIntent(t="fullload"){this._formComponentClientApiExecutor.execute("setInitializationIntent",e=>{"nothing"!==t&&"fullload"!==t&&Object(p.h)(e,t,"intent"),It.dispatch(
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(t,e,n,a){const r=Object(W.w)(n);return{type:jt.d,payload:a,meta:{pageId:t,controlName:e,contextKey:r}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(this.pageId,this.name,this.contextToken,t))},[{name:"intent",value:t,isEventParam:!0,expectedDataType:"string"}])}getControlType(){return l.a.instance.reportUsage("ClientApi.XrmControlFormComponent.getControlType"),"formcomponent"}}var xt=n("CYtR");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const At="3d180de6-b456-4d90-9d5a-9899936baf44";let _t;class Nt{constructor(t,e){this._pageId=e,_t=t}createXrmControl(t,e,n,s,o){Object(p.g)(e,s,"control");try{o.push({name:"controlClassId",value:e&&e.ClassId?e.ClassId.guid:""}),o.push({name:"controlName",value:e?e.Name:""}),o.push({name:"controlDataFieldName",value:e?e.DataFieldName:""}),o.push({name:"pageId",value:this._pageId});const l=Object(r.p)(_t.getState(),this._pageId);o.push({name:"pageType",value:l});let u=!1,g=null,p=!1;const m=this._getControlType(e,n,t,s,o);switch(m){case a.i.guid:g=new f(_t,t,this._pageId,e,e.Name,n);break;case H.a.KbContent:case H.a.KbArticle:case a.C.guid:case a.I.guid:g=new x(_t,t,this._pageId,e,e.Name,n);break;case H.a.LookupRegarding:case H.a.LookupCustomer:case H.a.LookupMultiEntity:case H.a.LookupOwner:case H.a.LookupSimple:case H.a.LookupPartyList:case a.M.guid:case a.fb.guid:case a.S.guid:case a.l.guid:const r=Object(rt.b)(_t.getState(),this._pageId,t);if(Object(St.c)(_t.getState(),e.UniqueId,r)===xt.c){g=new Tt(_t,t,this._pageId,e,n,this);break}g=new D(_t,t,this._pageId,e,e.Name,n);break;case H.a.OptionSet:case a.U.guid:if(p=Object(Ct.f)(_t.getState(),Ot.pb),1==p){const a=this._getEntityNameForControl(e,n);if(Object(vt.m)(_t.getState(),a,e.DataFieldName)){g=new bt(_t,t,this._pageId,e,e.Name,n);break}}case H.a.EntityNameOptionSet:case H.a.TwoOptions:case H.a.StatusOptionSet:case a.sb.guid:case a.K.guid:case a.W.guid:case a.V.guid:case a.hb.guid:case a.n.guid:case a.N.guid:g=new U(_t,t,this._pageId,e,e.Name,n);break;case H.a.MultiSelectPicklist:case a.Q.guid:if(p=Object(Ct.f)(_t.getState(),Ot.pb),p){const a=this._getEntityNameForControl(e,n);if(Object(vt.m)(_t.getState(),a,e.DataFieldName)){g=new yt(_t,t,this._pageId,e,e.Name,n);break}}g=new z(_t,t,this._pageId,e,e.Name,n);break;case H.a.QuickForm:case a.cb.guid:case a.ab.guid:case a.Z.guid:const l=new ut(_t,t,this._pageId,e,n,this);n.ui.quickForms.add(e.Name,l);break;case H.a.SearchWidget:case H.a.ReferencePanelSearchWidget:case a.db.guid:case a.kb.guid:g=new h.a(_t,t,this._pageId,e,e.Name,n);break;case H.a.TimelineWall:case a.qb.guid:g=_t.dispatch(Object(Q.f)(this._pageId,Object(W.q)(t,e.Name))),g||(g=new gt.a(_t,t,this._pageId,e,e.Name,e.LabelId,n,n.applicationContext));break;case H.a.DateAndTimeDateOnly:case H.a.DateAndTimeDateAndTime:case a.q.guid:g=new Y(_t,t,this._pageId,e,e.Name,n);break;case H.a.Grid:case a.eb.guid:case a.E.guid:const b=Object(W.q)(t,e.Name),y=_t.dispatch(Object(Q.c)(this._pageId,b));y&&(y.getName||3!==y.getGridType()?g=y:(c.a.getInstance().reportFailure(s,new Error("Main grid found in cache - converting to a subgrid."),null,o),_t.dispatch(Object(Q.h)(this._pageId,b)))),g||(g=new q.a(_t,t,this._pageId,e.Name,Object(Z.Ab)(_t.getState(),this._pageId,t,e.Name),n,e,n.applicationContext));break;case H.a.Timer:case a.rb.guid:g=new d(_t,t,this._pageId,e,e.Name,n);break;case H.a.WebResourceHtmlControl:case a.ub.guid:case a.vb.guid:g=new I(_t,t,this._pageId,e,e.Name,n);break;case a.mb.guid:g=new $(_t,t,this._pageId,e,n);break;case a.z.guid:case a.G.guid:break;case At:if(p=Object(Ct.f)(_t.getState(),Ot.pb),p&&Object(vt.m)(_t.getState(),t.entityTypeName,e.Name)){g=new ft(_t,t,this._pageId,e,e.Name,n);break}case H.a.AppliedFilters:case H.a.BusinessProcessFlow:case H.a.Card:case H.a.Currency:case H.a.Dashboard:case H.a.Decimal:case H.a.EmailEngagementActions:case H.a.EmailEngagementRecipientActivity:case H.a.FP:case H.a.GlobalFilter:case H.a.MicrosoftFlow:case H.a.Multiple:case H.a.PowerBI:case H.a.ReferencePanel:case H.a.Search:case H.a.SingleLineAddress:case H.a.SingleLineEmail:case H.a.SingleLinePhone:case H.a.SingleLineText:case H.a.SingleLineTextArea:case H.a.SingleLineTickerSymbol:case H.a.SingleLineURL:case H.a.SocialInsightsControl:case H.a.WholeDuration:case H.a.WholeLanguage:case H.a.WholeNone:case H.a.WholeTimeZone:case a.a.guid:case a.b.guid:case a.c.guid:case a.d.guid:case a.e.guid:case a.f.guid:case a.g.guid:case a.h.guid:case a.j.guid:case a.k.guid:case a.m.guid:case a.p.guid:case a.r.guid:case a.s.guid:case a.t.guid:case a.u.guid:case a.v.guid:case a.w.guid:case a.x.guid:case a.y.guid:case a.A.guid:case a.B.guid:case a.D.guid:case a.H.guid:case a.J.guid:case a.L.guid:case a.O.guid:case a.P.guid:case a.R.guid:case a.T.guid:case a.X.guid:case a.Y.guid:case a.bb.guid:case a.gb.guid:case a.ib.guid:case a.jb.guid:case a.lb.guid:case a.mb.guid:case a.nb.guid:case a.ob.guid:case a.pb.guid:case a.tb.guid:case a.wb.guid:u=!0;default:g=e.DataFieldName?new ht(_t,t,this._pageId,e,e.Name,n):new i.a(_t,t,this._pageId,e,e.Name,n),u||(o.push({name:"controlType",value:m}),st.a.getInstance().traceManager.getTracer(s).error("Unknown Form Control",o))}return g}catch(t){return c.a.getInstance().reportFailure(s+".createXrmControl",t,null,o),null}}_getControlType(t,e,n,r,i){if(w.a.equals(t.ClassId,a.o)){const a=this._getCustomControlType(t,e,n);return a||st.a.getInstance().traceManager.getTracer(r+".controlPrimaryType").error("Control primary type could not be determined",i),i.push({name:"manifestControlType",value:a}),a}return t.ClassId.guid}_getCustomControlType(t,e,n){var a,r,i;const o=Object(rt.b)(_t.getState(),this._pageId,n);let c=Object(pt.c)(_t.getState(),t,o);if(!c){const l=Object(s.i)(),u=(null===(r=null===(a=e.data)||void 0===a?void 0:a.entity)||void 0===r?void 0:r.getEntityName())||"";let d=l(_t.getState(),t,this._pageId,o,u);if(d||(d=Object(mt.a)(_t.getState(),t,this._pageId,n)),null==d?void 0:d.Parameters)for(const t in d.Parameters)if(null===(i=d.Parameters[t])||void 0===i?void 0:i.Primary){c=d.Parameters[t].Type;break}}return c}_getEntityNameForControl(t,e){let n="";if(t.Relationship)n=Object(s.W)(_t.getState(),this._pageId,t.Relationship);else{const a=e.getAttribute(t.DataFieldName);a&&a.getParent()&&(n=a.getParent().getEntityName())}return n}}},AE7n:function(t,e,n){"use strict";n.d(e,"b",(function(){return S})),n.d(e,"a",(function(){return j}));var a=n("iZ7K"),r=n("vNXc"),i=n("q/4y"),s=n("GxhD"),o=n("hQd/"),c=n("SAYH"),l=n("i1f0"),u=n("dHD5"),d=n("arV0"),h=n("P6DH"),g=n("fILV"),p=n("aF0N"),m=n("P+kM"),b=n("3/02"),y=n("Lyxw"),f=n("HfZT"),v=n("E8F2"),O=n("jq7Z"),C=n("iB7y");function S(t,e,n,S,j,I,T=!1,x,A){return{type:"embeddedEntity.save",execute(S,_){const N=S.getState(),E=new c.a(n),P=Object(u.f)(x,E,e);let w;switch(Object(d.p)(N,t)){case g.a:w=Object(h.T)(N,t,P);break;default:w=Object(l.hc)(N,t,P)}const F=Object(p.c)(N),k=Object(p.b)(N);if((F||k)&&"Dashboard"!==Object(d.p)(N,t)){const e=_.ScriptManager.getContainer(t).getEventManager();if(S.dispatch(e.runOnSave(x,1,null,n)))return Promise.reject(Object(v.b)(N,t,2200000005,""))}const D=Object(O.a)(N,t);return Object(l.Mb)(D,N,t,P)?S.dispatch(Object(C.b)(w,T,j,null,null,null,A)).then(l=>{const u=Object(h.tb)(N,new c.a(I),t),d=Object(a.h)(N,e),g=r.a.fromXmlAndSql(u.fetchXML,u.offlineSqlQuery,u.viewId,null,u.entityLogicalName,S.getState);return g.where(new i.a("eq",new s.a(e,d.PrimaryIdAttribute),new o.a(n))),S.dispatch(Object(f.e)(g.getQueryState(),t)).then(()=>l)}).catch(t=>{throw Object(y.e)(N,b.Wc)&&w&&S.dispatch(Object(m.b)(w,!1)),t}):Promise.reject(!1)}}}function j(t,e,n,S,j=!1,I){return{type:"embeddedEntity.save",execute(T,x){let A=T.getState();const _=[],N=Object(p.c)(A),E=Object(p.b)(A);for(const n of e){const e=Object(u.f)(I,n.id,n.etn),a=Object(O.a)(A,t);if(!Object(l.Mb)(a,A,t,e))return Promise.reject(!1);let r;switch(Object(d.p)(A,t)){case g.a:r=Object(h.T)(A,t,e);break;default:r=Object(l.hc)(A,t,e)}if(_.push(r),(N||E)&&"Dashboard"!==Object(d.p)(A,t)){const e=x.ScriptManager.getContainer(t).getEventManager();if(T.dispatch(e.runOnSave(I,1,null,n.id.guid)))return Promise.reject(Object(v.b)(A,t,2200000005,""))}}return T.dispatch(Object(C.c)(_,j,n)).then(e=>{if(0===e.length)return[];A=T.getState();let n=e[0].etn;const l=Object(h.tb)(A,new c.a(S),t),u=Object(a.h)(A,n);u.IsActivity&&(n="activitypointer");const d=r.a.fromXmlAndSql(l.fetchXML,l.offlineSqlQuery,l.viewId,null,l.entityLogicalName,T.getState),g=e.map(t=>new i.a("eq",new s.a(n,u.PrimaryIdAttribute),new o.a(t.id.guid)));return d.where(new i.a("or",...g)),T.dispatch(Object(f.e)(d.getQueryState(),t)).then(()=>e)}).catch(t=>{throw _.forEach(t=>{Object(y.e)(A,b.Wc)&&t&&T.dispatch(Object(m.b)(t,!1))}),t})}}}},AbXy:function(t,e,n){"use strict";n.d(e,"a",(function(){return f}));var a=n("P6DH"),r=n("Sbn7"),i=n("9i5P"),s=n("16wZ"),o=n("dHD5"),c=n("SAYH"),l=n("5Oca"),u=n("odYE"),d=n("WPtp"),h=n("qshH"),g=n("1kth"),p=n("ZIjf"),m=n("Uv1Y"),b=n("IaGr");let y;class f{constructor(t,e,n,a,r,i,o,c){const l="ClientApi.XrmControlGrid.constructor";if(a||Object(s.j)(l,"pageId"),n||Object(s.j)(l,"contextToken"),t||Object(s.j)(l,"store"),r||Object(s.j)(l,"gridEntity"),Object(s.a)(i)&&Object(s.j)(l,"isEditable"),y=t,this._applicationContext=e,this._contextToken=n,this._pageId=a,this._gridEntityName=r,this.controlName=o,this._isEditable=i,this._isModernDataSet=c,!this._contextToken.contextTokenType){const t=h.a.getInstance().getEventParameters(this._contextToken);t.push({name:"controlName",value:this.controlName}),t.push({name:"gridEntityName",value:this._gridEntityName}),h.a.getInstance().reportFailure(l,new m.a("context token passed to grids with empty context token type"),null,t)}}get _isEditable(){const t=Object(a.Y)(y.getState(),this._pageId,this._gridEntityName,this._contextToken,this.controlName);if(null===t){const t="ClientApi.XrmControlGrid._isEditable_get",e=h.a.getInstance().getEventParameters(this._contextToken);return e.push({name:"controlName",value:this.controlName}),e.push({name:"gridEntityName",value:this._gridEntityName}),b.a.getInstance().eventManager.ReportComponentFailure(t,new m.a("control configuration parameters not found"),null,e),this._isGridEditable}return t}set _isEditable(t){this._isGridEditable=t}get applicationContext(){return p.a.instance.reportUsage("ClientApi.XrmControlGrid.applicationContext_get"),this._applicationContext}set applicationContext(t){p.a.instance.reportUsage("ClientApi.XrmControlGrid.applicationContext_set")}getTotalRecordCount(){const t="ClientApi.XrmControlGrid.getTotalRecordCount";try{p.a.instance.reportCall(t);const e=Object(a.bb)(y.getState(),this._pageId,this._contextToken);if(e){const n=JSON.parse(e),a=n&&n.totalResultCount?n.totalResultCount:0;return p.a.instance.reportSuccess(t),a}return p.a.instance.reportSuccess(t),0}catch(e){const n=h.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.controlName}),h.a.getInstance().reportFailure(t,e,null,n),e}}getRows(){const t="ClientApi.XrmControlGrid.getRows";try{p.a.instance.reportCall(t);const e=new r.a(t),n=y.getState(),s=Object(a.J)(n,this.contextToken,{id:this.pageId});if(s)for(let t=0;t<s.length;t++){const n=s[t].identifier.id,a=this._getRowEntityName(s[t],n),r=new i.a(y,this._applicationContext,Object(o.f)(this.contextToken,n,a),this.pageId,a,n),c=s[t].identifier.id.guid;e.add(c,r)}return p.a.instance.reportSuccess(t),e}catch(e){const n=h.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.controlName}),h.a.getInstance().reportFailure(t,e,null,n),e}}getSelectedRows(){const t="ClientApi.XrmControlGrid.getSelectedRows";try{p.a.instance.reportCall(t);const e=new r.a(t),n=Object(a.ib)(y.getState(),this.pageId,this.contextToken);if(n){const t=Object(a.S)(y.getState(),this.pageId,this.contextToken);for(let r=0;r<n.length;r++){let s;if(t)s=t;else{const t=y.getState(),e=Object(a.v)(t,this.pageId,this.contextToken),i=(e&&e.queryKey&&Object(l.r)(t,e.queryKey,null,null,!0)||[]).find(t=>t.identifier&&c.a.equals(t.identifier.id,n[r]));s=this._getRowEntityName(i,n[r])}const u=new i.a(y,this._applicationContext,Object(o.f)(this.contextToken,n[r],s),this.pageId,s,n[r]),d=n[r].guid;e.add(d,u)}}return p.a.instance.reportSuccess(t),e}catch(e){const n=h.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.controlName}),h.a.getInstance().reportFailure(t,e,null,n),e}}addOnRecordSelect(t){const e="ClientApi.XrmControlGrid.addOnRecordSelect";if(this._isEditable||this._isModernDataSet){t||Object(s.j)(e,"handler");try{p.a.instance.reportCall(e),y.dispatch(Object(g.n)(this.contextToken,this.pageId,t,this.controlName)),p.a.instance.reportSuccess(e)}catch(t){const n=h.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.controlName}),h.a.getInstance().reportFailure(e,t,null,n),t}}}removeOnRecordSelect(t){const e="ClientApi.XrmControlGrid.removeOnRecordSelect";if(this._isEditable){t||Object(s.j)(e,"handler");try{p.a.instance.reportCall(e),y.dispatch(Object(g.J)(this.contextToken,this.pageId,t,this.controlName)),p.a.instance.reportSuccess(e)}catch(t){const n=h.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.controlName}),h.a.getInstance().reportFailure(e,t,null,n),t}}}_getRowEntityName(t,e){const n=t&&t.identifier?t.identifier.etn:this._gridEntityName;if("activitypointer"===n){const t="activitytypecode",n=Object(l.j)(y.getState(),new u.a(this._gridEntityName,e),t);if(Object(d.j)(n))return n.value}return n}get pageId(){return this._pageId}get contextToken(){return this._contextToken}}},B9jE:function(t,e,n){"use strict";n.d(e,"a",(function(){return N}));var a=n("P6DH"),r=n("Utin");var i=n("Uv1Y"),s=n("SAYH"),o=n("eXjw"),c=n("a72m"),l=n("KBcj"),u=n("d0w6"),d=n("dQnL"),h=n("WK+4"),g=n("CngE"),p=n("iZ7K"),m=n("69Qu"),b=n("BzGi"),y=n("BFlg"),f=n("s+OO"),v=n("7k+e");var O=n("LAGg"),C=n("RrRu"),S=n("jRHm"),j=n("uCpV"),I=n("X37l"),T=n("ujVH"),x=n("3/02"),A=n("Lyxw"),_=n("+QYJ");function N(t,e,n,N,P,w){return{type:"grid.refresh.async",execute({dispatch:F,getState:k},D){const M=D.TraceManager.getTracer(y.P),L=y.N+".refreshGridAction";try{const R=k(),X=s.a.tryParseOrNull(N);if(X){const V=w||(n?u.a.SUB_GRID:u.a.MAIN_APPLICATION_VIEW);return function(t,e,n,r,d,h,g,p){const b=Object(a.tb)(e,p,n);if(b&&b.initialized===o.a.Initialized&&(Object(m.c)(e)||!Object(_.b)(b.offlineSqlQuery)))return Promise.resolve(p);const y=h||Object(a.H)(e,n,r,d),f=Object(l.f)(e,y,g),v=Object(l.f)(e,y,u.a.MAIN_APPLICATION_VIEW);let O=f&&f[s.a.toString(p)]&&f[s.a.toString(p)].isUserView?u.b.userview:u.b.savedview;v&&v[s.a.toString(p)]&&v[s.a.toString(p)].isUserView&&(O=u.b.userview);return t(Object(c.a)(y,g,O,p)).then(t=>{if(!t)throw new i.a("View retrieval failed");return t})}(F,R,t,e,n,P,V,X).then(i=>{M.info("Refreshing the grid with new view id - {0}"+X);const c=Object(a.V)(R,t,e);F(function(t,e,n,a){return Object(r.b)(t,e,"ViewId",n,a)}(t,n,N,e)),function(t,e,n,r,i,c,u,d,h){let g=function(t,e,n,r,i){return t||Object(a.H)(e,n,r,i)}(n,t,i,c,u);const p=Object(a.tb)(t,r,i);if(p&&p.initialized===o.a.Initialized){const n=Object(l.f)(t,g,d),a=n&&n[s.a.toString(r)]&&n[s.a.toString(r)].isUserView;if(g===y.a&&(g=p.entityLogicalName?p.entityLogicalName:g),!p.title){const t=[];t.push({name:"view.title",value:"View title doesn't contains value"}),t.push({name:"ViewId",value:"ViewId: "+r}),t.push({name:"View",value:E(p)}),t.push({name:"entityTypeName",value:g}),h.EventManager.ReportComponentFailure("RefreshGrid",new Error("Title for recent item is null or empty."),"Analyze event parameters to understand why title is empty.",t)}const i={RecordType:I.a.Grid,EntityTypeName:g,LastAccessed:new Date,ObjectId:r,IsUserView:a,Title:p.title};e(Object(j.b)(i))}}(k(),F,P,i,t,e,n,V,D);Object(A.f)(k(),x.pb)&&F(Object(T.b)(t,e)),P&&F(function(t,e,n,a){return Object(r.b)(t,e,"TargetEntityType",n,a)}(t,n,P,e)),F(Object(O.b)(t,e)),F(Object(C.b)(t,e,[])),F(Object(S.b)(t,e,null));const _=[];P&&_.push({name:"entityName",value:P}),Object(a.lb)(R,t,e)?F(function(t,e,n,r,i,o){return{type:"chart.refresh.async",execute({dispatch:c,getState:O},C){const S=y.N+".refreshChartAction",j=O();if(!n)return Promise.resolve();if(!Object(m.c)(j))return Promise.resolve();const I=Object(l.c)(j,n);if(!(i=I&&I.entityLogicalName?I.entityLogicalName:null))return Promise.resolve();if(o===u.a.QUICKFIND_SEARCH&&(c(Object(v.c)(t,e,[])),c(Object(f.c)(t,e,"{}"))),!s.a.equals(r,n)){c(Object(v.c)(t,e,[])),c(Object(f.c)(t,e,"{}"));const n=Object(a.r)(j,t,e,i),r=Object(g.a)(j,n),o=r&&r.PrimaryEntityTypeCode,l=o&&Object(p.m)(j,parseInt(o,10));if(l&&i!==l)return c(Object(d.a)(i,b.a.savedvisualization)).then(n=>{let a=s.a.toString(n);return a||(a=s.a.EMPTYGUIDSTRING),c(Object(h.b)(t,e,a)).then(()=>{C.EventManager.ReportComponentSuccess(S)})})}return C.EventManager.ReportComponentSuccess(S),Promise.resolve()}}}(t,e,X,c,P,w)).then(()=>{F(Object(O.b)(t,e)),D.EventManager.ReportComponentSuccess(L,_)}).catch(t=>{D.EventManager.ReportComponentFailure(L,Error(t))}):D.EventManager.ReportComponentSuccess(L,_)})}if(Object(a.v)(k(),t,e)){M.info("Refreshing the grid."),F(Object(O.b)(t,e)),F(Object(C.b)(t,e,[])),F(Object(S.b)(t,e,null));const n=[];P&&n.push({name:"entityName",value:P}),D.EventManager.ReportComponentSuccess(L,n)}return Promise.resolve()}catch(t){let e="Refresh action for grid failed";t&&t.message&&(e+="with the error message as : "+t.message),D.EventManager.ReportComponentFailure(L,Error(e))}}}}function E(t){if(!t)return"View is "+t;const e={initialized:t.initialized,viewId:t.viewId,entityLogicalName:t.entityLogicalName,queryApi:t.queryApi,columnXML:t.columnXML,idColumName:t.idColumName,queryType:t.queryType,layoutXML:t.layoutXML,isUserView:t.isUserView,versionNumber:t.versionNumber,OverallVersionNumber:t.OverallVersionNumber,OverallUserVersionNumber:t.OverallUserVersionNumber};return JSON.stringify(e)}},BXEF:function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var a=n("sX6v"),r=n("bT7G"),i=n("Uv1Y");function s(t,e){return{type:"dataSnapshot.undoChanges.async",execute({dispatch:n,getState:a},s){const c=Object(r.b)(a(),t);if(c){if(0===Object.keys(c.activeChanges).length)return Promise.resolve();let a={};if(e&&e.length>0){if(a=Object.keys(c.activeChanges).reduce((t,n)=>(-1===e.indexOf(n)&&(t[n]=c.activeChanges[n]),t),a),Object.keys(a).length===Object.keys(c.activeChanges).length)return Promise.resolve();n(o(t,a))}else n(o(t,a));return Promise.resolve()}return Promise.reject(new i.a("Snapshot does not exist"))}}}function o(t,e){return{type:a.a,payload:e,meta:{snapshotId:t,flavor:1}}}},COKI:function(t,e,n){"use strict";n.d(e,"a",(function(){return E}));var a=n("i1f0"),r=n("pF61"),i=n("Sbn7"),s=n("ScMg"),o=n("ldWj"),c=n("TYIz"),l=n("16wZ"),u=n("1kth"),d=n("mhYf"),h=n("PbI6"),g=n("FHmp"),p=n("qshH"),m=n("ZIjf"),b=n("ABCl");let y;class f extends s.a{constructor(t,e,n,a,r,i){Object(l.g)(r,"ClientApi.XrmTab.constructor","parent"),Object(l.g)(t,"ClientApi.XrmTab.constructor","store"),super(t,e,a,n),y=t,this._parent=r,this._formContext=i,this._iConnectedTabProps={tabName:this.name,tabId:this._getTabId(),id:this.pageId,showTab:!0},this._clientApiExecutor=new b.b(y,"ClientApi.XrmTab.",e)}get sections(){const t="ClientApi.XrmTab.sections";try{if(m.a.instance.reportCall(t),!this._sections){this._sections=new i.a(t);const e=y.getState(),n=Object(a.Pc)(e,this.pageId,this.name,this.contextToken);for(let t=0;t<n.Columns.length;t++){const r=Object(a.r)(e,{id:this.pageId,tabName:n.Id,columnIndex:t},this.contextToken);let i=null;for(let t=0;t<r.SectionNames.length;t++)i=new o.a(y,this.contextToken,this.pageId,r.SectionNames[t],this,this._formContext),this._sections.add(i.getName(),i)}}return m.a.instance.reportSuccess(t),this._sections}catch(e){const n=p.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),p.a.getInstance().reportFailure(t,e,null,n),e}}addTabStateChange(t){const e="ClientApi.XrmTab.addTabStateChange";Object(l.g)(t,e,"handler");try{m.a.instance.reportCall(e),y.dispatch(Object(u.t)(this.contextToken,this.pageId,this.name,t)),m.a.instance.reportSuccess(e)}catch(t){const n=p.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),p.a.getInstance().reportFailure(e,t,null,n),t}}removeTabStateChange(t){const e="ClientApi.XrmTab.removeTabStateChange";Object(l.g)(t,e,"handler");try{m.a.instance.reportCall(e),y.dispatch(Object(u.P)(this.contextToken,this.pageId,this.name,t)),m.a.instance.reportSuccess(e)}catch(t){const n=p.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),p.a.getInstance().reportFailure(e,t,null,n),t}}getDisplayState(){const t="ClientApi.XrmTab.getDisplayState";try{m.a.instance.reportCall(t);const e=Object(a.Mc)(y.getState(),this._getTabId(),this.pageId,this.contextToken)?"collapsed":"expanded";return m.a.instance.reportSuccess(t),e}catch(e){const n=p.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),p.a.getInstance().reportFailure(t,e,null,n),e}}getParent(){return m.a.instance.reportUsage("ClientApi.XrmTab.getParent"),this._parent}setDisplayState(t){const e="ClientApi.XrmTab.setDisplayState";try{m.a.instance.reportCall(e);let n=!1;switch(t){case"collapsed":n=!0;break;case"expanded":n=!1;break;default:Object(l.h)(e,"TabDisplayState",t)}n||y.dispatch(Object(c.b)(this.pageId,this._getTabId(),this.contextToken)),m.a.instance.reportSuccess(e)}catch(t){const n=p.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),p.a.getInstance().reportFailure(e,t,null,n),t}}setFocus(){try{m.a.instance.reportCall("ClientApi.XrmTab.setFocus"),y.dispatch(Object(c.b)(this.pageId,this._getTabId(),this.contextToken)),m.a.instance.reportSuccess("ClientApi.XrmTab.setFocus")}catch(t){const e=p.a.getInstance().getEventParameters(this.contextToken);throw e.push({name:"controlName",value:this.name}),p.a.getInstance().reportFailure("ClientApi.XrmTab.setFocus",t,null,e),t}}setVisible(t){const e="ClientApi.XrmTab.setVisible";try{m.a.instance.reportCall(e),y.dispatch(Object(d.b)(this.pageId,this._getTabId(),this.contextToken,!0===t)),m.a.instance.reportSuccess(e)}catch(t){const n=p.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),p.a.getInstance().reportFailure(e,t,null,n),t}}getLabel(){try{m.a.instance.reportCall("ClientApi.XrmTab.getLabel");const t=Object(a.Qc)(y.getState(),this._getTabId(),this._iConnectedTabProps.id,this.contextToken)||"";return m.a.instance.reportSuccess("ClientApi.XrmTab.getLabel"),t}catch(t){const e=p.a.getInstance().getEventParameters(this.contextToken);throw e.push({name:"controlName",value:this.name}),p.a.getInstance().reportFailure("ClientApi.XrmTab.getLabel",t,null,e),t}}getVisible(){const t="ClientApi.XrmTab.getVisible";try{m.a.instance.reportCall(t);const e=Object(a.Tc)(y.getState(),this._getTabId(),this._iConnectedTabProps.id,this.contextToken);return m.a.instance.reportSuccess(t),e}catch(e){const n=p.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),p.a.getInstance().reportFailure(t,e,null,n),e}}setLabel(t){const e="ClientApi.XrmTab.setLabel";Object(l.g)(t,e,"label");try{m.a.instance.reportCall(e),y.dispatch(Object(g.b)(this.pageId,this.contextToken,this._getTabId(),t)),m.a.instance.reportSuccess(e)}catch(t){const n=p.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),p.a.getInstance().reportFailure(e,t,null,n),t}}_getTabId(){const t=y.getState(),e=Object(a.Pc)(t,this.pageId,this.name,this.contextToken);if(e&&e.Id)return e.Id}setContentType(t){return this._clientApiExecutor.execute("setContentType",()=>{let e;switch(t){case"default":case"cardSections":e="cardSections";break;case"expandAvailableSpace":case"singleComponent":e="singleComponent";break;default:Object(l.h)("setContentType","TabContentType",t)}y.dispatch(Object(h.b)(this.pageId,this._getTabId(),this.contextToken,e))},[{name:"tabContentType",value:t,isRequired:!0,expectedDataType:"string"}])}getContentType(){return this._clientApiExecutor.execute("getContentType",()=>{var t;return null===(t=Object(a.Sc)(y.getState(),this._iConnectedTabProps.id,this._getTabId(),this.contextToken))||void 0===t?void 0:t.contentType})}}var v=n("SAYH"),O=n("rQHy"),C=n("jRy5"),S=n("y60j"),j=n("arV0"),I=n("3yqi"),T=n("0nOn"),x=n("zmL5"),A=n("jq7Z"),_=n("IaGr");let N;class E{constructor(t,e,n,a,r,i,s){const o=Object(j.p)(t.getState(),n),c=[{name:"store",value:t,isRequired:!0},{name:"contextToken",value:e,isRequired:!0},{name:"pageId",value:n,isRequired:!0,isEventParam:!0},{name:"pageType",value:o,isEventParam:!0},{name:"formContext",value:a,isRequired:!0},{name:"entityName",value:r,isEventParam:!0},{name:"formSelectorType",value:s,isRequired:!0}];this._clientApiExecutor=new T.a(t,"ClientApi.XrmFormUIBase.",n,e,c),this._pageId=n,N=t,this._formContext=a,this._entityName=r,this._contextToken=e,this._formSelectorType=s,this.xrmControlFactory=i}get controls(){return this._clientApiExecutor.execute("controls_get",(t,e)=>{if(!this._controls){this._controls=new i.a(t);const n=function(t,e,n){const r=Object(A.b)(N.getState(),t,e),i=Object(x.b)(N.getState(),t),s=v.a.equals(r,i),o=Object(j.p)(N.getState(),t)===I.a.Dialog,c=Object(S.w)(N.getState(),r),l=c&&c.reduce((t,e)=>(t.add(e),t),new Set);return(r,i)=>{const c=Object(a.u)(N.getState(),{controlName:r,id:t},e),u=Object(a.dd)(N.getState(),t,c);s&&u&&!o?l&&l.has(c.DataFieldName)&&Object(a.vd)(N.getState(),t,c,e)&&n.add(r,i):n.add(r,i)}}(this.pageId,this.contextToken,this._controls),r=this.getFormDescriptor(t,e);if(r){const a={isEventParam:!0,name:"controlName",value:""},i={isEventParam:!0,name:"controlType",value:""};e.push(a),e.push(i);for(const s in r.Controls){const o=r.Controls[s];a.value=s,i.value=o&&o.ClassId?o.ClassId.guid:"";const c=this.xrmControlFactory.createXrmControl(this.contextToken,o,this._formContext,t,e);c&&n(c.getName(),c)}}}return this._controls})}get formSelector(){return this._clientApiExecutor.execute("formSelector_get",(t,e)=>{if(!this._formSelector){const n=this.getFormDescriptor(t,e);n&&(this._formSelector=new this._formSelectorType(N,this._contextToken,n.Id,this._entityName,this._pageId))}return this._formSelector})}get tabs(){return this._clientApiExecutor.execute("tabs_get",(t,e)=>{if(!this._tabs){this._tabs=new i.a(t);const n=this.getFormDescriptor(t,e);if(n){const t=Object(a.sb)(N.getState(),n.Id,this.pageId);for(const e in t){const n=new f(N,this._contextToken,t[e].Name,this._pageId,this,this._formContext);this._tabs.add(n.getName(),n)}}}return this._tabs})}get pageId(){return this._pageId}refreshRibbon(t=!1){this._clientApiExecutor.executeAsync("refreshRibbon",()=>N.dispatch(Object(O.a)(this._pageId,null,t)))}get contextToken(){return this._contextToken}get formContext(){return this._clientApiExecutor.execute("formContext",()=>this._formContext)}getControls(){if(!this._controls&&this.contextToken.contextTokenType===C.a.GridRow){const t=this._clientApiExecutor.getComponentName("getControls");return this._controls=new i.a(t),this._controls}return this.controls}getFormDescriptor(t,e){const n=Object(a.ib)(N.getState(),{id:this._pageId},this._contextToken);if(!n){const n="Form descriptor not found";if(Object(r.m)(N.getState(),this._pageId))_.a.getInstance().traceManager.getTracer(t).error(n+": Page is dead",e);else if(this.contextToken.contextTokenType===C.a.GridRow)_.a.getInstance().traceManager.getTracer(t).error(n,e);else{if(!this._clientApiExecutor.isPageReadyForClientAPIAccess(t))return null;const a=new Error(n);this._clientApiExecutor.reportFailure(t,a,e)}}return n}}},CyDF:function(t,e,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var a;n.d(e,"a",(function(){return a})),function(t){t[t.Success=0]="Success",t[t.Failure=1]="Failure"}(a||(a={}))},DAWX:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class a{get_ErrorType(){return this._errorType}set_ErrorType(t){this._errorType=t}get_ErrorDescription(){return this._errorDescription}set_ErrorDescription(t){this._errorDescription=t}}},"DuO/":function(t,e,n){"use strict";n.d(e,"a",(function(){return k}));var a=n("odYE"),r=n("dHD5"),i=n("i1f0"),s=n("bT7G"),o=n("arV0"),c=n("WY/A"),l=n("Dea/"),u=n("vr5N"),d=n("YxC/"),h=n("RrRQ"),g=n("Uv1Y"),p=n("EY5k"),m=n("qTme"),b=n("uNLT"),y=n("E8F2"),f=n("tT9w"),v=n("gQ5I"),O=n("cUbT"),C=n("jCkl"),S=n("yJdb"),j=n("hTZE"),I=n("BXEF"),T=n("Zn5P"),x=n("0kGT"),A=n("rzkc"),_=n("95Ij"),N=n("iZ7K"),E=n("lY/Z"),P=n("SAYH"),w=n("CyDF"),F=n("wL2W");function k(t){return{type:"saveAndClose.saveBulkEditFormAction.async",async execute({dispatch:e,getState:_},N,E){var P,w,k;await e(Object(p.e)(u.n));const M=_(),L=Object(d.e)(M,u.n),R=Object(o.j)(M,t);if(!(null===(P=null==R?void 0:R.ids)||void 0===P?void 0:P.length))return;const X=Object(r.j)(M,t),V=Object(r.y)(X),U=Object(i.hc)(M,t,X),G=Object(s.b)(M,U),B=Object.keys(G.activeChanges);if(Object(F.a)()&&n.e(81).then(n.bind(null,"vqYC")).then(n=>{e(n.requiredFieldValidationChecker(t,X,"Required field validation is supressed on bulk edit form. This is by design.",void 0))}),!(null==G?void 0:G.activeChanges)||!(null==B?void 0:B.length))return;const Y=[];Y.push({name:"bulkEditAttributesToSave",value:JSON.stringify(B)}),Y.push({name:"entityTypeName",value:R.entityTypeName}),Y.push({name:"entityIds",value:R.ids.map(t=>t.guid).toString()}),Y.push({name:"totalRecordsToBulkEdit",value:null===(w=null==R?void 0:R.ids)||void 0===w?void 0:w.length});const z=B.filter(t=>Object(i.hd)(M,R.entityTypeName,t));(null==z?void 0:z.length)&&e(Object(I.a)(U,z));const H=_(),q=Object(s.b)(H,U);if(!(null==q?void 0:q.activeChanges)||!(null===(k=Object.keys(q.activeChanges))||void 0===k?void 0:k.length))return;if(!e(Object(j.a)(t)))throw Object(y.b)(H,t,2200000007);const W=[],K=Object(d.c)(L,u.m);try{for(let n=0;n<R.ids.length;n++){const r=R.ids[n],i=String.format(K,n+1,R.ids.length);Object(x.c)(M)?e(Object(A.c)(t,!0)):e(Object(C.b)(i));const s=new a.a(R.entityTypeName,r),o=await D(e,t,n,_,R,L);if(o){W.push({recordId:r,error:o});continue}const u=Object(c.b)(M,s,q.activeChanges,V,l.a.Update),d=u.payload.snapshotId;e(u),e(Object(m.b)(t,d,X)),await e(Object(b.e)(t,1,!0)).then(t=>{W.push({recordId:r})}).catch(t=>{W.push({recordId:r,error:Object(g.c)(t)})}).finally(()=>{e(Object(h.b)(d)),e(Object(m.b)(t,U,X))})}}finally{e(Object(A.c)(t,!1)),e(Object(S.b)())}const Q=W.filter(t=>t.error),Z=null==Q?void 0:Q.length;if(e(Object(T.c)(Z?1:0)),Z){const n=Q[0].error,a=Object(g.c)(n),r=Object(g.d)(a),i=Object(d.c)(L,u.h),s=String.format(i,Q.length,W.length,Q.map(t=>t.recordId.guid).join(","),r);throw function(t,e,n){e.blockErrorReporting=!1,t.EventManager.ReportComponentFailure("Forms.BulkEdit.SaveAndClose",e,null,n)}(N,a,Y),a.message=s.split("\\r\\n").join("\r\n"),await e(Object(f.b)(a,!0,t)),await e(Object(O.a)(R.entityTypeName)),await e(Object(v.e)(t)),a}return N.EventManager.ReportComponentSuccess("Forms.BulkEdit.SaveAndClose",Y),await e(Object(O.a)(R.entityTypeName)),W}}}async function D(t,e,n,r,s,o){var c,l;try{const h=s.ids[n],p=new a.a(s.entityTypeName,h),m=null===(c=Object(_.d)(r(),e))||void 0===c?void 0:c[P.a.toString(h)];let b;if(m){if(m.status!==w.a.Success)return m.error;b=m.isInactive}else{const e=Object(N.h)(r(),null==p?void 0:p.etn);if(!(null===(l=null==e?void 0:e.AttributeNames)||void 0===l?void 0:l.find(t=>t===_.c)))return null;await t(Object(E.e)(p,[..._.b]));const n=r();b=Object(i.Rb)(n,s.entityTypeName,h)}if(b){return new g.a(Object(d.c)(o,u.l),2153976070,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,!0)}}catch(t){return Object(g.c)(t)}return null}},E5qG:function(t,e,n){"use strict";n.d(e,"b",(function(){return A})),n.d(e,"c",(function(){return N})),n.d(e,"a",(function(){return w}));var a=n("SAYH"),r=n("FZDd"),i=n("FETf"),s=n("FCvT"),o=n("y60j"),c=n("iZ7K"),l=n("odYE"),u=n("Lohl"),d=n("S6h3"),h=n("NAAR"),g=n("dyr5"),p=n("LE5i"),m=n("zDpi"),b=n("Lyxw"),y=n("E5IU"),f=n("bwbe"),v=n("84PK");function O(t,e,n){return{type:"recentitemsbyentity.retrieve.async",execute({dispatch:a,getState:r},s){const o=s.DataSource,c=[];return c.push(t),function(t,e,n,a,r,s,o,c,l,u,d){const h=v.a.tryCreate(Object(y.k)(n));return t.getRecentItems(h,r,c,l,u,d,null).nativePromise().then(g,p);function g(t){const n=t.map(f.d),r=C(n,o,a,e,s);if(r&&e(Object(i.t)(s,r)),n&&n.length>0&&o&&o.entityTypeName){const t={};t[o.entityTypeName]=n,e(Object(i.s)(s,t))}return n}function p(t){return a.TraceManager.getTracer("Recents").error("Retrieving recent items from data source failed with error: "+t.get_Message()),Promise.reject(t)}}(o,a,r,s,c,e,n)}}}function C(t,e,n,a,r){if(t&&e&&e.id&&e.id.guid){const s=t.filter(t=>t.ObjectId.guid===e.id.guid);if(1===s.length){if(s[0].LastAccessed){const t=new Date(s[0].LastAccessed);if(t)return t.toJSON()}}else s.length>1&&(a(Object(i.v)(r,!0)),Object(g.e)(null,n,"TimelineWall.getLastAccessedTimeStamp","recentitemsbyentity.retrieve.async","more than one recent item found for current record."))}return null}var S=n("BJ7u"),j=n("3hnk");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const I={},T={};let x;function A(t,e,n,a,r,i){return{type:"timelinewall.init.async",execute({dispatch:s,getState:o},c){n.info("initFormTimelineWall started.",a);const l=o();if(Object(b.f)(l,h.y.TimelineWallMultipleInstance)){const o=Object.keys(t).filter(t=>t.startsWith("notescontrol")).map(n=>s(_(t[n],e,n,r,i)));return Promise.all(o).then(()=>{n.info("initFormTimelineWall completed.",a)})}return s(_(t.notescontrol,e,"notescontrol",r,i)).then(()=>{n.info("initFormTimelineWall completed.",a)})}}}function _(t,e,n,y,f){return{type:"timelinewall.load.metadata.async",execute({dispatch:v,getState:A},_){const F=A();I[h.c.PostsEntity]=h.y.TimelineWallPosts,I[h.c.ActivityPointerEntity]=h.y.TimelineWallActivities,I[h.c.AnnotationEntity]=h.y.TimelineWallNotes,function(t){let e;for(e in I)T[e]=Object(b.f)(t,I[e])}(F),x=Object(b.f)(F,h.y.TimelineWall);const k=Object(b.f)(F,h.y.TimelineWallWhatsChanged);if(N())return Promise.resolve();const D=t;let M=null;const L=w(F,D.LabelId,e);v(Object(i.r)(L,Object(d.c)(F,L),n)),k&&null!==y&&null!==y.pageType&&y.pageType!==h.l&&(M=C(f,y,_,v,L),null!=M&&v(Object(i.t)(L,M)));const R=function(t,e,n,r,s){const c=w(t,e.LabelId,s),d=Object(m.a)(e.Parameters[h.x.UClientActivityCardMap]),p=[];if(T[h.c.ActivityPointerEntity])for(let e=0;e<d.length;e++){const s=d[e],h=s.formId,m=s.logicalName;if(h&&m)try{const e=new a.a(h);if(!Object(o.h)(t,e)){const t=new l.a(m),a=n(Object(u.d)(t,e,Object(S.a)(11)));p.push(a)}}catch(t){n(Object(i.v)(c,!0));const e=t.message;Object(g.e)(null,r,"TimelineWall.loadCardFormsMetadata","timelinewall.load.metadata",e)}}return Promise.all(p).then(()=>{Promise.resolve()},t=>{n(Object(i.v)(c,!0)),Object(g.e)(t,r,"TimelineWall.loadCardFormsMetadata","retrieveForm"),Promise.resolve()})}(F,D,v,_,e),X=T[h.c.ActivityPointerEntity]&&!Object(g.c)(F)?function(t,e,n,a){let r=[];const i=t.Parameters[h.x.UClientActivities];if(i){r=i.split(",");if(Object(g.a)(e,h.p.SecondStage)){const t=[];for(const n of r)Object(j.b)(e,n)&&t.push(n);return t}}else{const t=Object(c.a)(e);if(t&&t!=={})for(const n in t)Object(j.b)(e,n)&&r.push(n)}return r}(t,F):[],V=function(t,e,n,a,i){return function(t,e,n,a){if(T[h.c.PostsEntity]&&!Object(g.c)(t)){Object(b.f)(t,h.y.TimelineWallUserPosts)&&n.push(h.n),n.push(s.a)}const i={};h.z.SupportedModules.forEach(e=>{const r=e.entityName;if(T[r]&&(!Object(g.c)(t)||r.indexOf(h.c.AnnotationEntity)>-1)){const s=function(t,e){switch(t.entityName.toLowerCase()){case h.c.AnnotationEntity:case h.c.PostsEntity:return[t.sortByPrimary];case h.c.ActivityPointerEntity:return[null!=e.Parameters[h.x.UClientSortActivitiesByValue]?e.Parameters[h.x.UClientSortActivitiesByValue]:t.sortByPrimary,t.sortBySecondary]}}(e,a);n.push(r),i[r]=s,r===h.c.ActivityPointerEntity&&Object(g.d)(t,a)&&n.push(h.s.Incident)}});let o=0;const c=n.reduce((t,e)=>{const n=function(t,e){var n;if(t===h.c.Annotations||t===h.c.PostsEntity||t===h.n){const n=Object(m.b)(e.Parameters[t===h.c.Annotations?h.x.UClientNotesConfigurationJSON:h.x.UClientPostsConfigurationJSON]);return!!(null==n?void 0:n.fieldsConfig)&&E(n.fieldsConfig)}const a=Object(m.b)(e.Parameters[h.x.UClientActivitiesConfigurationJSON]),r=Object(m.a)(e.Parameters[h.x.UClientActivityCardMap]).reduce((t,e)=>(t.set(e.logicalName,e.formId),t),new Map);if(a&&(null===(n=a[t])||void 0===n?void 0:n.fieldsConfig)&&""===r.get(t))return E(a[t].fieldsConfig);return!1}(e,a),r=n?h.d[e]:h.w[e];if(n&&(e===h.c.Annotations||e===h.c.PostsEntity)){const t=Object(m.b)(a.Parameters[e===h.c.Annotations?h.x.UClientNotesConfigurationJSON:h.x.UClientPostsConfigurationJSON]);(null==t?void 0:t.fieldsConfig)&&(P(t.fieldsConfig.header)&&t.fieldsConfig.header.dataFieldName&&!(null==r?void 0:r.includes(t.fieldsConfig.header.dataFieldName))&&r.push(t.fieldsConfig.header.dataFieldName),P(t.fieldsConfig.footer)&&t.fieldsConfig.footer.dataFieldName&&!(null==r?void 0:r.includes(t.fieldsConfig.footer.dataFieldName))&&r.push(t.fieldsConfig.footer.dataFieldName))}return e===s.a?t[e]=[s.c,s.b]:t[e]=null==r?n?[h.c.ModifiedOn,h.c.Description,h.c.OwnerId]:[]:r,null!==i[e]&&void 0!==i[e]&&(t[e]=t[e].concat(i[e])),o++,t},{});if(o)return e(Object(r.e)(c));return Promise.resolve()}(t,e,n,a).then(()=>{if(T[h.c.PostsEntity])return e(Object(s.f)(a));Promise.resolve()},t=>{Object(g.e)(t,i,"TimelineWall.loadTimelineConfigAndMetaData","timelinewall.load.metadata.async")})}(F,v,X,D,_),U=function(t,e,n,a,r,s,o){let c=Promise.resolve();if(s&&null!==r&&null!==r.pageType&&r.pageType!==h.l&&null==o){const s=function(t,e,n){if(e&&e.entityTypeName){const a=Object(d.c)(t,n);if(a){return a[e.entityTypeName]||null}}return null}(t,r,a);null==s?r&&r.entityTypeName&&(c=e(O(r.entityTypeName,a,r))):(o=C(s,r,n,e,a))&&e(Object(i.t)(a,o))}return c.catch(t=>{Object(g.e)(t,n,"TimelineWall.getRecentItemsForEntity","RETRIEVE_RECENT_ITEMS_BY_ENTITY_ACTION")})}(A(),v,_,L,y,k,M);return Promise.all([R,V,U]).then(()=>{v(Object(i.p)(L,p.a.Metadata,2,null))},t=>{v(Object(i.v)(L,!0)),Object(g.e)(t,_,"TimelineWall.loadTimelineConfigAndMetaData","timelinewall.load.metadata.async")})}}}function N(){return!x||!function(){let t,e;for(e in t=!1,I)t=t||T[e];return t}()}function E(t){return!(!P(t.header)&&!P(t.footer))||(t.body&&t.body.forEach(t=>{if(P(t))return!0}),!1)}function P(t){var e;return!(!t||(null===(e=t.displayOption)||void 0===e?void 0:e.toLowerCase())===h.u.Hide.toLowerCase())&&(t.labelOption&&t.labelOption.toLowerCase()!==h.v.Hide.toLowerCase())}function w(t,e,n){return Object(b.f)(t,h.y.TimelineWallSingletonFix)?e+n:e}},EOIL:function(t,e,n){"use strict";n.d(e,"a",(function(){return it}));var a=n("0nOn"),r=n("i1f0"),i=n("ZIjf"),s=n("Sbn7"),o=n("Bj/n"),c=n("jTSi"),l=n("9NSo"),u=n("SAYH"),d=n("uOtn"),h=n("+zjj"),g=n("N+Ya"),p=n("dIqG"),m=n("16wZ"),b=n("qshH"),y=n("meVR"),f=n("TYIz"),v=n("dHD5");var O=n("IqkD");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let C;class S{constructor(t,e,n,a){const r="ClientApi.XrmNavigationItem.constructor";t||Object(m.j)(r,"store"),n||Object(m.j)(r,"pageId"),e||Object(m.j)(r,"contextToken"),Object(m.a)(a)&&Object(m.j)(r,"id"),C=t,this._pageId=n,this._id=a,this._contextToken=e}getId(){return i.a.instance.reportUsage("ClientApi.XrmNavigationItem.getId"),this._id}getLabel(){const t="ClientApi.XrmNavigationItem.getLabel";try{i.a.instance.reportCall(t);const e=Object(r.Xb)(C.getState(),this._pageId,this._id);return i.a.instance.reportSuccess(t),e}catch(e){const n=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(t,e,null,n),e}}getVisible(){const t="ClientApi.XrmNavigationItem.getVisible";try{i.a.instance.reportCall(t);const e=!Object(r.Hb)(C.getState(),this._pageId)&&Object(r.ac)(C.getState(),this._pageId,this._id);return i.a.instance.reportSuccess(t),e}catch(e){const n=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(t,e,null,n),e}}setFocus(){const t="ClientApi.XrmNavigationItem.setFocus";try{i.a.instance.reportCall(t),Object(r.Hb)(C.getState(),this._pageId)||C.dispatch((e=this._pageId,n=this._contextToken,a=this._id,{type:"forms.selectnavigationtab",sync:!0,execute({dispatch:t,getState:r},i,s){const o=Object(h.d)(r(),e,a);if(o){o.isSelected=!0;const a=Object(v.a)(n,o.relationshipName,o.ordinal);t(Object(f.b)(e,void 0,n)),t(Object(y.a)(e,a,o))}else i.TraceManager.getTracer("Forms.SelectNavigationTab").error("Could not find relatedEntityInfo to select")}})),i.a.instance.reportSuccess(t)}catch(e){const n=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(t,e,null,n),e}var e,n,a}setLabel(t){const e="ClientApi.XrmNavigationItem.setLabel";try{if(i.a.instance.reportCall(e),!Object(m.a)(t)&&!Object(r.Hb)(C.getState(),this._pageId)){const e=Object(O.s)(C.getState());C.dispatch(Object(g.b)(this._pageId,this._id,t,e))}i.a.instance.reportSuccess(e)}catch(t){const n=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(e,t,null,n),t}}setVisible(t){const e="ClientApi.XrmNavigationItem.setVisible";try{i.a.instance.reportCall(e),Object(r.Hb)(C.getState(),this._pageId)||C.dispatch(Object(p.b)(this._pageId,this._id,!0===t)),i.a.instance.reportSuccess(e)}catch(t){const n=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(e,t,null,n),t}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let j;class I{constructor(t,e,n){n||Object(m.j)("ClientApi.XrmFormNavigation.constructor","pageId"),t||Object(m.j)("ClientApi.XrmFormNavigation.constructor","store"),j=t,this._pageId=n,this._contextToken=e}get items(){const t="ClientApi.XrmFormNavigation.items";try{if(i.a.instance.reportCall(t),!this._items){this._items=new s.a(t);const e=Object(h.f)()(j.getState(),{id:this._pageId});e&&e.forEach(t=>{t&&t.relatedItems&&t.relatedItems.forEach(t=>{t&&t.id&&this._items.add(t.id,new S(j,this._contextToken,this._pageId,t.id))})})}return i.a.instance.reportSuccess(t),this._items}catch(e){const n=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(t,e,null,n),e}}}var T=n("ldWj"),x=n("PidC"),A=n("4U8P"),_=n("NtHU"),N=n("FhIR"),E=n("ABCl"),P=n("zmL5");let w;class F extends T.a{constructor(t,e,n,a){super(t,e,n,F.NAME,null,a),w=t,this._clientApiExecutor=new E.b(w,"ClientApi.XrmHeaderSection.",e)}getLabel(){return i.a.instance.reportUsage("ClientApi.XrmHeaderSection.getLabel"),""}getVisible(){return i.a.instance.reportUsage("ClientApi.XrmHeaderSection.getVisible"),!0}setLabel(t){i.a.instance.reportUsage("ClientApi.XrmHeaderSection.setLabel")}setVisible(t){i.a.instance.reportUsage("ClientApi.XrmHeaderSection.setVisible")}getControlsDescriptor(t){const e=Object(P.b)(t,this.pageId),n=Object(r.yb)(t,{id:this.pageId},this.contextToken,e),a={};if(n)for(let t=0;t<n.length;t++){const e=n[t];a[e.Name]=e}return a}setCommandBarVisible(t){this._clientApiExecutor.execute("setCommandBarVisible",()=>{w.dispatch(Object(A.b)(this.pageId,this.contextToken,t))},[{name:"visible",value:t,isRequired:!0,expectedDataType:"boolean"}])}getCommandBarVisible(){return this._clientApiExecutor.execute("getCommandBarVisible",()=>{var t;return null===(t=Object(x.e)(w.getState(),this.pageId,this.contextToken))||void 0===t?void 0:t.commandBarVisible})}setBodyVisible(t){this._clientApiExecutor.execute("setBodyVisible",()=>{w.dispatch(Object(_.b)(this.pageId,this.contextToken,t))},[{name:"visible",value:t,isRequired:!0,expectedDataType:"boolean"}])}getBodyVisible(){return this._clientApiExecutor.execute("getCommandBarVisible",()=>{var t;return null===(t=Object(x.e)(w.getState(),this.pageId,this.contextToken))||void 0===t?void 0:t.bodyVisible})}setTabNavigatorVisible(t){this._clientApiExecutor.execute("setTabNavigatorVisible",()=>{w.dispatch(Object(N.b)(this.pageId,this.contextToken,t))},[{name:"visible",value:t,isRequired:!0,expectedDataType:"boolean"}])}getTabNavigatorVisible(){return this._clientApiExecutor.execute("getTabNavigatorVisible",()=>{var t;return null===(t=Object(x.e)(w.getState(),this.pageId,this.contextToken))||void 0===t?void 0:t.tabNavigatorVisible})}}F.NAME="Header";var k=n("5iTp"),D=n("m+2h");let M;class L extends T.a{constructor(t,e,n,a){super(t,e,n,L.NAME,null,a),M=t,this._clientApiExecutor=new E.b(M,"ClientApi.XrmFooterSection.",e)}getLabel(){return i.a.instance.reportUsage("ClientApi.XrmFooterSection.getLabel"),""}getVisible(){return this._clientApiExecutor.execute("getVisible",()=>{var t;return!Object(k.b)(M.getState())&&(null===(t=Object(k.a)(M.getState(),this.pageId,this.contextToken))||void 0===t?void 0:t.visible)})}setLabel(t){Object(k.b)(M.getState())||i.a.instance.reportUsage("ClientApi.XrmFooterSection.setLabel")}setVisible(t){this._clientApiExecutor.execute("setVisible",()=>{Object(k.b)(M.getState())||M.dispatch(Object(D.b)(this.pageId,this.contextToken,t))},[{name:"visible",value:t,isRequired:!0,expectedDataType:"boolean"}])}getControlsDescriptor(t){if(!Object(k.b)(M.getState())){const e=Object(r.cb)(t,{id:this.pageId},this.contextToken),n={};if(e)for(let t=0;t<e.length;t++){const a=e[t];n[a.Name]=a}return n}return null}}L.NAME="Footer";var R=n("gQ5I"),X=n("arV0"),V=n("PUjk"),U=n("r/aD"),G=n("bpBl"),B=n("IaGr");let Y;class z{constructor(t,e,n,a){const r="ClientApi.XrmProcessControlUI.constructor";a||Object(m.j)(r,"entity"),e||Object(m.j)(r,"contextToken"),n||Object(m.j)(r,"pageId"),t||Object(m.j)(r,"store"),Y=t,this._pageId=n;let i=!1;if(Object(U.d)(Y.getState(),this._pageId,r)){const t=Object(X.j)(Y.getState(),this._pageId);this._processManager=Object(V.b)(this._pageId,t),i=!0}this._contextToken=e;const s=Object(U.b)(n,t.getState(),i);B.a.getInstance().eventManager.ReportComponentSuccess(r,s)}getDisplayState(){const t="ClientApi.XrmProcessControlUI.getDisplayState";try{if(i.a.instance.reportCall(t),!Object(U.d)(Y.getState(),this._pageId,t))return i.a.instance.reportSuccess(t),null;const e=this._getProcessManager().getDisplayState();return i.a.instance.reportSuccess(t),e}catch(e){const n=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(t,e,null,n),e}}getVisible(){const t="ClientApi.XrmProcessControlUI.getVisible";try{if(i.a.instance.reportCall(t),!Object(U.d)(Y.getState(),this._pageId,t))return i.a.instance.reportSuccess(t),!1;const e=this._getProcessManager().isVisible();return i.a.instance.reportSuccess(t),e}catch(e){const n=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(t,e,null,n),e}}setDisplayState(t){const e="ClientApi.XrmProcessControlUI.setDisplayState";try{if(i.a.instance.reportCall(e),!Object(U.d)(Y.getState(),this._pageId,e))return void i.a.instance.reportSuccess(e);t!==G.a.collapsed&&t!==G.a.expanded&&t!==G.a.floating||this._getProcessManager().setDisplayState(t),i.a.instance.reportSuccess(e)}catch(t){const n=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(e,t,null,n),t}}setVisible(t){const e="ClientApi.XrmProcessControlUI.setVisible";try{if(i.a.instance.reportCall(e),!Object(U.d)(Y.getState(),this._pageId,e))return void i.a.instance.reportSuccess(e);this._getProcessManager().setVisible(t),i.a.instance.reportSuccess(e)}catch(t){const n=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(e,t,null,n),t}}reflow(t,e,n){const a="ClientApi.XrmProcessControlUI.reflow";try{if(i.a.instance.reportCall(a),!Object(U.d)(Y.getState(),this._pageId,a))return void i.a.instance.reportSuccess(a);this._getProcessManager().reflow(t,e,n,"ClientAPI"),i.a.instance.reportSuccess(a)}catch(t){const e=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(a,t,null,e),t}}_getProcessManager(){return this._processManager||(this._processManager=Object(U.c)(this._processManager,Y,this._pageId,"ClientApi.XrmProcessControlUI.getProcessManager")),this._processManager}}var H=n("1kth"),q=n("uNLT"),W=n("bT7G"),K=n("Dea/"),Q=n("Fij2"),Z=n("pF61"),J=n("COKI"),$=n("zJiL"),tt=n("wL2W"),et=n("4aOd"),nt=n("pEXn"),at=n("+Qpx");let rt;class it extends J.a{constructor(t,e,n,r,i,s){rt=t,super(t,e,n,r,i,s,d.a),this._clientApiExecutorFormUI=new a.a(t,"ClientApi.XrmFormUI.",n,e),this._clientApiExecutorFormUI.addEventParameter({name:"entityName",value:i,isEventParam:!0})}get headerSection(){const t="ClientApi.XrmFormUI.headerSection";try{return i.a.instance.reportCall(t),this._headerSection||(this._headerSection=new F(rt,this.contextToken,this.pageId,this.formContext)),i.a.instance.reportSuccess(t),this._headerSection}catch(e){throw this._reportFailure(t,e)}}get footerSection(){const t="ClientApi.XrmFormUI.footerSection";try{return i.a.instance.reportCall(t),this._footerSection||(this._footerSection=new L(rt,this.contextToken,this.pageId,this.formContext)),i.a.instance.reportSuccess(t),this._footerSection}catch(e){throw this._reportFailure(t,e)}}addControls(t){const e=b.a.getInstance().getEventParameters(this.contextToken),n={name:"controlName",value:""};e.push(n);for(const a in t)if(t[a]){n.value=a;const r=this.xrmControlFactory.createXrmControl(this.contextToken,t[a],this.formContext,"ClientApi.XrmFormUI.addControls",e);r&&this.controls.add(r.getName(),r)}}get navigation(){const t="ClientApi.XrmFormUI.navigation";try{return i.a.instance.reportCall(t),this._navigation||(this._navigation=new I(rt,this.contextToken,this.pageId)),i.a.instance.reportSuccess(t),this._navigation}catch(e){throw this._reportFailure(t,e)}}get process(){const t="ClientApi.XrmFormUI.process_get";try{i.a.instance.reportCall(t);const e=!!this._process;!this._process&&this.formContext.data&&this.formContext.data.entity&&(this._process=new z(rt,this.contextToken,this.pageId,this.formContext.data.entity));const n=Object(U.a)(this.pageId,rt.getState(),e,!(!this.formContext.data||!this.formContext.data.entity));return B.a.getInstance().eventManager.ReportComponentSuccess(t,n),i.a.instance.reportSuccess(t),this._process}catch(e){throw this._reportFailure(t,e)}}set process(t){const e=Object(U.a)(this.pageId,rt.getState(),!!this._process,!(!this.formContext.data||!this.formContext.data.entity));B.a.getInstance().eventManager.ReportComponentSuccess("ClientApi.XrmFormUI.process_set",e),this._process=t}get quickForms(){const t="ClientApi.XrmFormUI.quickForms";try{return i.a.instance.reportCall(t),this._quickForms||(this._quickForms=new s.a(t),this.controls),i.a.instance.reportSuccess(t),this._quickForms}catch(e){throw this._reportFailure(t,e)}}clearFormNotification(t){const e="ClientApi.XrmFormUI.clearFormNotification";try{i.a.instance.reportCall(e);const n=rt.dispatch(Object(c.b)(this.contextToken,this.pageId,t));return i.a.instance.reportSuccess(e),n}catch(t){throw this._reportFailure(e,t)}}close(){try{i.a.instance.reportCall("ClientApi.XrmFormUI.close"),Object(Q.a)(Object(Z.b)(rt.getState())===this.pageId)||rt.dispatch(Object(R.e)(this.pageId)),i.a.instance.reportSuccess("ClientApi.XrmFormUI.close")}catch(t){throw this._reportFailure("ClientApi.XrmFormUI.close",t)}}getFormType(){return this._clientApiExecutorFormUI.execute("getFormType",(t,e)=>{if(Object(r.Hb)(rt.getState(),this.pageId))return 6;const n=this.getFormDescriptor(t,e);if(n){const a=this.formContext;if(a&&a.data&&a.data.entity&&Object(r.Rb)(rt.getState(),a.data.entity.getEntityName(),u.a.tryParse(a.data.entity.getId())))return 4;if(Object(r.nb)(rt.getState(),{id:this.pageId},this.contextToken))return 3;if(6===n.FormType)return 3;const i=Object(r.hc)(rt.getState(),this.pageId,this.contextToken);if(i){const n=Object(W.b)(rt.getState(),i);return n?n.mode===K.a.Create?1:2:(e.push({name:"snapshotID",value:i}),this._clientApiExecutorFormUI.reportFailure(t+".getSnapshot",new Error("Snapshot is null or undefined"),e),0)}return a&&a.data&&a.data.entity&&!u.a.tryParseOrNull(a.data.entity.getId())?1:2}return 0})}isDialog(){return this._clientApiExecutorFormUI.execute("isDialog",()=>Object(X.h)(rt.getState(),this.pageId))}getViewPortHeight(){const t="ClientApi.XrmFormUI.getViewPortHeight";try{i.a.instance.reportCall(t);const e=Object(r.vb)(rt.getState(),{id:this.pageId},this.contextToken);return i.a.instance.reportSuccess(t),e}catch(e){throw this._reportFailure(t,e)}}getViewPortWidth(){const t="ClientApi.XrmFormUI.getViewPortWidth";try{i.a.instance.reportCall(t);const e=Object(r.wb)(rt.getState(),{id:this.pageId},this.contextToken);return i.a.instance.reportSuccess(t),e}catch(e){throw this._reportFailure(t,e)}}setFormEntityName(t){const e="ClientApi.XrmFormUI.setFormEntityName";Object(m.g)(t,e,"name");try{i.a.instance.reportCall(e),rt.dispatch(Object(l.b)(this.pageId,this.contextToken,t)),i.a.instance.reportSuccess(e)}catch(t){throw this._reportFailure(e,t)}}setFormNotification(t,e,n,a,r){return this._clientApiExecutorFormUI.execute("setFormNotification",(i,s)=>{var c,l,u,d;let h;switch(Object(m.a)(n)&&(n="Random_String_"+Math.random()),e){case"ERROR":h=$.a;break;case"WARNING":h=$.e;break;case"INFORMATION":case"INFO":h=$.b;break;default:Object(m.h)(i,"notificationLevel",e,s)}if(!Object(m.a)(t)&&"string"==typeof t)return rt.dispatch(Object(o.c)(this.contextToken,this.pageId,t,h,n,a,r)),!0;if(Object(tt.a)()){let e=null;try{e=null!==(u=null!==(c=JSON.stringify(t))&&void 0!==c?c:null===(l=null==t?void 0:t.toString)||void 0===l?void 0:l.call(t))&&void 0!==u?u:t}catch(t){e="<Unable to stringify>"}const n=[{name:"Client API Method Name",value:"formContext.ui.setFormNotification"},{name:"Client API Method Documentation link",value:"https://docs.microsoft.com/en-us/powerapps/developer/model-driven-apps/clientapi/reference/formcontext-ui/setformnotification"},{name:"Invalid Parameter Name",value:"message"},{name:"Expected Invalid Parameter Type",value:"string"},{name:"Provided Invalid Parameter Type",value:typeof t},{name:"Invalid Parameter Value",value:e}],a=new et.a(new Error);n.push({name:"callStack",value:a.getStackTrace()}),null===(d=B.a.getInstance().traceManager.getTracer(`${at.u}${at.A}`))||void 0===d||d.error(at.B,[{name:nt.l,value:at.A},{name:at.A,value:JSON.stringify(n)}])}return!1})}addOnLoad(t){const e="ClientApi.XrmFormUI.addOnLoad";Object(m.g)(t,e,"handler");try{i.a.instance.reportCall(e),rt.dispatch(Object(H.f)(this.contextToken,this.pageId,t)),i.a.instance.reportSuccess(e)}catch(t){throw this._reportFailure(e,t)}}removeOnLoad(t){const e="ClientApi.XrmFormUI.removeOnLoad";Object(m.g)(t,e,"handler");try{i.a.instance.reportCall(e),rt.dispatch(Object(H.B)(this.contextToken,this.pageId,t)),i.a.instance.reportSuccess(e)}catch(t){throw this._reportFailure(e,t)}}refresh(){const t="ClientApi.XrmFormUI.refresh";try{if(i.a.instance.reportCall(t),Object(r.Hb)(rt.getState(),this.pageId))return null;const e=Object(X.p)(rt.getState(),this.pageId);return rt.dispatch(Object(q.f)(this.pageId,e,!0,1,!0,!0)).then(e=>(Object(Q.b)(this.formContext.data.entity),i.a.instance.reportSuccess(t),e)).catch(e=>{const n=b.a.getInstance().getEventParameters(this.contextToken);return Object(m.d)(rt,e,t+".saveFormAndNavigate",n)})}catch(e){const n=b.a.getInstance().getEventParameters(this.contextToken);return Object(m.d)(rt,e,t,n)}}_reportFailure(t,e){const n=b.a.getInstance().getEventParameters(this.contextToken);return b.a.getInstance().reportFailure(t,e,null,n),e}}},FCvT:function(t,e,n){"use strict";n.d(e,"f",(function(){return S})),n.d(e,"e",(function(){return I})),n.d(e,"a",(function(){return f})),n.d(e,"c",(function(){return v})),n.d(e,"b",(function(){return O})),n.d(e,"d",(function(){return C}));var a=n("x0oY"),r=n("Nb1E"),i=n("iZ7K"),s=n("LbMF"),o=n("lY/Z"),c=n("odYE"),l=n("nxXM"),u=n("dyr5"),d=n("5Oca"),h=n("a72m"),g=n("d0w6"),p=n("Lyxw"),m=n("NAAR"),b=n("KBcj"),y=n("FZDd");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const f="msdyn_postconfig",v="msdyn_entityname",O="msdyn_configurewall",C="statecode";function S(t){return{type:"postconfigs.retrieve.async",execute({dispatch:t,getState:e},n){const a=Object(d.i)(e(),f);if(a){const e=[];for(const t in a)e.push(a[t].identifier);return t(Object(l.c)(e)),Promise.resolve()}const i=function(){const t=sessionStorage.getItem("PostConfigs");if(null!=t)return JSON.parse(t)}();return i?(T(i,t,e),Promise.resolve()):t(Object(r.e)(f,"?$select=msdyn_configurewall,statecode,msdyn_entityname")).then(n=>{!function(t){try{sessionStorage.setItem("PostConfigs",JSON.stringify(t))}catch(t){}}(n),T(n,t,e)},t=>{Object(u.e)(t,n,"TimelineWall.retrievePostConfigs","postconfigs.retrieve.async")})}}}function j(t,e){return new Promise(n=>{t(function(t){return{type:"postconfigquickfindviews.retrieve.async",execute:({dispatch:e,getState:n},a)=>e(Object(h.a)(t,g.a.QUICKFIND_SEARCH,g.b.savedview)).then(t=>{let e=null;return t&&(e=Object(b.c)(n(),t)),e},t=>{Object(u.e)(t,a,"TimelineWall.retrieveQuickFindViewDescriptor","postconfigquickfindviews.retrieve.async")})}}(e)).then(t=>{n(t)})})}function I(t,e,n){const a={};return null==e||!Object(p.f)(n,m.y.TimelineWallPostsEnhancedMentions)&&Object(p.f)(n,m.y.TimelineWallShouldDisablePostMentionImprovements)||t.forEach(t=>{a[t]=()=>j(e,t)}),a}function T(t,e,n){var r;const u=n();if(t.value&&t.value.length>0){const n=[v,C,O],d=Object(i.h)(u,f),h=Object(s.d)(u,f),g=t.value.length,p=[],m={};for(let r=0;r<g;r++){const i=t.value[r];(null==i?void 0:i.msdyn_entityname)&&0===(null==i?void 0:i.statecode)&&(m[i.msdyn_entityname]=[]);const s=Object(a.d)(u,i,d,h,n,null,null),l=c.a.fromLegacyEntityReference(s.get_identifier());e(Object(o.h)(u,l,s)),p.push(l)}m&&(null===(r=Object.keys(m))||void 0===r?void 0:r.length)>0&&e(Object(y.e)(m)),p.length>0&&e(Object(l.c)(p))}}},FHmp:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return i}));var a=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const r="tab.setlabel";function i(t,e,n,i){const s=Object(a.w)(e);return{type:r,payload:i,meta:{pageId:t,contextKey:s,tabId:n}}}},FhIR:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return i}));var a=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const r="header.tabnavigatorvisible";function i(t,e,n){const i=Object(a.w)(e);return{type:r,payload:n,meta:{pageId:t,contextKey:i}}}},G0J3:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var a=n("ghNp"),r=n("i1f0"),i=n("0nOn");let s;class o{constructor(t,e,n,r,o,c){this._clientApiExecutor=new i.a(t,"ClientApi.XrmFormBase.",r,n,[{name:"store",value:t,isRequired:!0},{name:"entityName",value:this._entityName,isEventParam:!0},{name:"pageId",value:r,isRequired:!0,isEventParam:!0},{name:"contextToken",value:n,isRequired:!0},{name:"getUiType",value:o,isRequired:!0}]),s=t,this.pageId=r,this.contextToken=n,this._entityName=e,this._getUiType=o,this._xrmControlFactory=c,s.dispatch(Object(a.a)(this,r,n))}get ui(){return this._clientApiExecutor.execute("ui_get",()=>{if(!this._ui){const t={id:this.pageId},e=Object(r.ib)(s.getState(),t,this.contextToken),n=e&&e.FormType,a=this._getUiType(n);this._ui=new a(s,this.contextToken,this.pageId,this,this._entityName,this._xrmControlFactory)}return this._ui})}getControl(t){const e=[{name:"entityName",value:this._entityName,isRequired:!1,isEventParam:!0}];return this._clientApiExecutor.execute("getControl",()=>this.ui.controls.get(t),e)}}},GEBM:function(t,e,n){"use strict";n.d(e,"d",(function(){return a})),n.d(e,"c",(function(){return r})),n.d(e,"u",(function(){return i})),n.d(e,"b",(function(){return s})),n.d(e,"e",(function(){return o})),n.d(e,"x",(function(){return c})),n.d(e,"y",(function(){return l})),n.d(e,"v",(function(){return u})),n.d(e,"l",(function(){return d})),n.d(e,"n",(function(){return h})),n.d(e,"p",(function(){return g})),n.d(e,"q",(function(){return p})),n.d(e,"s",(function(){return m})),n.d(e,"r",(function(){return b})),n.d(e,"m",(function(){return y})),n.d(e,"f",(function(){return f})),n.d(e,"z",(function(){return _})),n.d(e,"t",(function(){return v})),n.d(e,"i",(function(){return O})),n.d(e,"a",(function(){return C})),n.d(e,"h",(function(){return S})),n.d(e,"w",(function(){return j})),n.d(e,"o",(function(){return I})),n.d(e,"g",(function(){return T})),n.d(e,"j",(function(){return x})),n.d(e,"k",(function(){return A}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const a="Web.Visualization.AxisTitle",r="Web.Visualization.AxisTitle.DateGrouping",i="Web.Visualization.EmptyAxisLabel",s="Web.Visualization.AxisTitle.CurrencySymbol",o="Calendar_Short_Months",c="Web.Visualization.Year.Quarter",l="Web.Visualization.Year.Week",u="FiscalYear_Format_String_NoSpace",d="Chart_NoData_Message",h="Chart_NoReadPrivilege",g="Chart_Retrieve_Error_Message",p="Chart_UnavailableOffline",m="Chart_Unsupported_Title",b="Chart_Unsupported_Message",y="Visualization_EmptyGridMessage",f="Error_Message_0x80061721",v="Error_Message_Generic_Mobile_Client",O="Visualization_QueryApiMessage",C="Error_Message_0x8004e023",S="Web.Visualization_Invalid_Attribute",j="Error_Message_Visualization_SQLArithmeticOverflow",I="Error_Message_Visualization_Not_Found",T="Web.Visualization_Invalid_Aggregate_Type",x="Error_Message_Visualization_Navigation",A="Error_Message_Visualization_Navigation_Detail",_=["ActivityContainerControl.SubjectEllipsesText",a,r,i,"Web.Visualization.AxisTitle.AVG","Web.Visualization.AxisTitle.SUM","Web.Visualization.AxisTitle.COUNT","Web.Visualization.AxisTitle.COUNTCOLUMN",s,"Web.Visualization.AxisTitle.DateGrouping.DAY","Web.Visualization.AxisTitle.DateGrouping.FISCALPERIOD","Web.Visualization.AxisTitle.DateGrouping.FISCALYEAR","Web.Visualization.AxisTitle.DateGrouping.MONTH","Web.Visualization.AxisTitle.DateGrouping.QUARTER","Web.Visualization.AxisTitle.DateGrouping.WEEK","Web.Visualization.AxisTitle.DateGrouping.YEAR",o,c,l,u,"PageLoadingMessage",d,h,g,p,"Chart_UnreadableDefinition_Title","Chart_UnreadableDefinition_Message",m,b,"CRM_Personal_Visualization_Group_Name","CRM_System_Visualization_Group_Name",y,"ChartAttributeValueMissing",f,"Error_Message_0x80040226","Error_Message_0x80048306",v,O,C,S,j,I,T,x,A]},GxhD:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));class a{constructor(t,e){this._etn=null,this._attributeName=null,this._etn=t,this._attributeName=e}get etn(){return this._etn}set etn(t){this._etn=t}get attributeName(){return this._attributeName}set attributeName(t){this._attributeName=t}}},H523:function(t,e,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var a;n.d(e,"a",(function(){return a})),function(t){t.error="ERROR",t.recommendation="RECOMMENDATION",t.information="INFORMATION"}(a||(a={}))},HAeo:function(t,e,n){"use strict";n.d(e,"a",(function(){return P})),n.d(e,"b",(function(){return w}));var a=n("0nOn"),r=n("arV0"),i=n("3yqi"),s=n("AbXy"),o=n("SAYH"),c=n("B9jE"),l=n("16wZ"),u=n("P6DH"),d=n("qshH"),h=n("i1f0"),g=n("Uv1Y"),p=n("dHD5"),m=n("ZIjf"),b=n("IaGr");let y;class f{constructor(t,e,n,r,i){this._pageId=n,y=t,this._contextToken=e,this._controlName=r,this._gridType=i,this._clientApiExecutor=new a.a(t,"ClientApi.XrmViewSelector.",n,e,[{name:"controlName",value:r,isEventParam:!0},{name:"gridType",value:i,isEventParam:!0,isRequired:!0},{name:"contextToken",value:e,isRequired:!0},{name:"store",value:t,isRequired:!0}])}setCurrentView(t){this._clientApiExecutor.executeAsync("setCurrentView",(e,n)=>t&&t.id?y.dispatch(Object(c.a)(this._pageId,this._contextToken,this._controlName,t.id)):(n.push({name:"validationError",value:"true"}),b.a.getInstance().traceManager.getTracer(e).error("View ID is required",n),Promise.resolve()))}getCurrentView(){const t="ClientApi.XrmViewSelector.getCurrentView";try{m.a.instance.reportCall(t);const e=Object(u.kb)(y.getState(),this._pageId,this._contextToken,this._controlName);let n=null,a=null;if(e)a=e.ViewId;else if(3===this._gridType){const e={id:this._pageId},n=Object(h.ib)(y.getState(),e,this._contextToken.parentContextToken),r="ViewId";if(!(n&&n.Controls&&n.Controls[this._controlName]&&n.Controls[this._controlName].Parameters&&n.Controls[this._controlName].Parameters[r])){let e;n?n.Controls?n.Controls[this._controlName]?n.Controls[this._controlName].Parameters?n.Controls[this._controlName].Parameters[r]||(e="formDescriptor.Controls[this._controlName].Parameters[propertyViewId] is null or undefined"):e="formDescriptor.Controls[this._controlName].Parameters is null or undefined":e="formDescriptor.Controls[this._controlName] is null or undefined":e="formDescriptor.Controls is null or undefined":e="formDescriptor is null or undefined";const a=d.a.getInstance().getEventParameters(this._contextToken);return a.push({name:"controlName",value:this._controlName}),d.a.getInstance().reportFailure(t,new g.a(e),null,a),null}a=n.Controls[this._controlName].Parameters[r]}if(a){if(n=Object(u.tb)(y.getState(),o.a.parse(a),this._pageId),n){const e={entityType:Object(u.rb)(y.getState(),a,this._pageId),id:o.a.externalGuid(n.viewId),name:n.title};return m.a.instance.reportSuccess(t),e}const e=[];return e.push({name:"controlName",value:this._controlName}),e.push({name:"contextKey",value:Object(p.w)(this._contextToken)}),d.a.getInstance().reportFailure(t,new Error("ViewDescriptor is coming as null"),null,e),null}const r=[];return r.push({name:"controlName",value:this._controlName}),r.push({name:"contextKey",value:Object(p.w)(this._contextToken)}),d.a.getInstance().reportFailure(t,new Error("viewId is coming as null or undefined"),null,r),null}catch(e){const n=d.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"controlName",value:this._controlName}),d.a.getInstance().reportFailure(t,e,null,n),e}}isVisible(){const t="ClientApi.XrmViewSelector.isVisible";try{if(m.a.instance.reportCall(t),Object(l.a)(this._isVisible)){const e=Object(u.kb)(y.getState(),this._pageId,this._contextToken,this._controlName);if(e)this._isVisible=e.EnableViewPicker;else{const e={id:this._pageId},n=Object(h.ib)(y.getState(),e,this._contextToken.parentContextToken),a="EnableViewPicker";if(!(n&&n.Controls&&n.Controls[this._controlName]&&n.Controls[this._controlName].Parameters&&n.Controls[this._controlName].Parameters[a])){const e=d.a.getInstance().getEventParameters(this._contextToken);return e.push({name:"controlName",value:this._controlName}),d.a.getInstance().reportFailure(t,new g.a("FormDescriptor is null"),null,e),!1}this._isVisible=n.Controls[this._controlName].Parameters[a]}}return m.a.instance.reportSuccess(t),this._isVisible}catch(e){const n=d.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"controlName",value:this._controlName}),d.a.getInstance().reportFailure(t,e,null,n),e}}}var v=n("ghNp"),O=n("OQLa"),C=n("rQHy"),S=n("iOrn"),j=n("iZ7K"),I=n("d0w6"),T=n("deGN"),x=n("Lyxw"),A=n("3/02"),_=n("whN/"),N=n("+6s6");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
let E;class P{constructor(t,e,n,r,i,s,o,c,u){this._relationship=null;const d=N.c+"constructor";t||Object(l.j)(d,"store"),e||Object(l.j)(d,"contextToken"),n||Object(l.j)(d,"pageId"),E=t,this._pageId=n,this._contextToken=e,this._controlName=c,this._isEditable=r,this._isModernDataSet=u,this._gridType=i,this._applicationContext=o,s||E.dispatch(Object(v.a)(this,n,e)),this._clientApiExecutor=new a.a(t,N.c,n,e),this._clientApiExecutor.addEventParameter({name:"controlName",value:c,isEventParam:!0}),this._clientApiExecutor.addEventParameter({name:"isEditable",value:r,isEventParam:!0}),this._clientApiExecutor.addEventParameter({name:"isCallFromSubgrid",value:s,isEventParam:!0}),this._clientApiExecutor.addEventParameter({name:"gridType",value:i,isEventParam:!0})}get _connectedControlProps(){return{controlName:this._controlName,id:this._pageId}}setFilterXml(t){this._clientApiExecutor.executeAsync("setFilterXml",()=>{const e=(new Date).getTime();return E.dispatch(Object(S.b)(t,1,this._pageId,this._contextToken,e))})}getFilterXml(){const t=N.c+"getFilterXml";try{m.a.instance.reportCall(t);const e=Object(u.u)(E.getState(),this._pageId,this._contextToken);return m.a.instance.reportSuccess(t),e}catch(e){const n=d.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"controlName",value:this._controlName}),d.a.getInstance().reportFailure(t,e,null,n),e}}getFetchXml(){const t=N.c+"getFetchXml";try{m.a.instance.reportCall(t);const e=Object(u.B)(E.getState(),this._contextToken,{id:this._pageId});return m.a.instance.reportSuccess(t),e}catch(e){const n=d.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"controlName",value:this._controlName}),d.a.getInstance().reportFailure(t,e,null,n),e}}getGrid(){const t=N.c+"getGrid";try{return m.a.instance.reportCall(t),!this._grid&&this.getEntityName()&&(this._grid=new s.a(E,this._applicationContext,this._contextToken,this._pageId,this.getEntityName(),this._isEditable,this._controlName,this._isModernDataSet)),m.a.instance.reportSuccess(t),this._grid}catch(e){const n=d.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"controlName",value:this._controlName}),d.a.getInstance().reportFailure(t,e,null,n),e}}getViewSelector(){const t=N.c+"getViewSelector";try{return m.a.instance.reportCall(t),this._viewSelector||(this._viewSelector=new f(E,this._contextToken,this._pageId,this._controlName,this._gridType)),m.a.instance.reportSuccess(t),this._viewSelector}catch(e){const n=d.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"controlName",value:this._controlName}),d.a.getInstance().reportFailure(t,e,null,n),e}}getTeamTemplateId(){const t=N.c+"getTeamTemplateId";try{m.a.instance.reportCall(t);let e=null;const n=E.getState();if(Object(x.f)(n,A.d)){if(this.getEntityName()&&3===this._gridType){const t=Object(h.ib)(n,this._connectedControlProps,this._contextToken.parentContextToken),a="TeamTemplateId";t&&t.Controls&&t.Controls[this._controlName]&&t.Controls[this._controlName].Parameters&&t.Controls[this._controlName].Parameters[a]&&(e=t.Controls[this._controlName].Parameters[a])}}return m.a.instance.reportSuccess(t),e}catch(e){const n=d.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"controlName",value:this._controlName}),d.a.getInstance().reportFailure(t,e,null,n),e}}getEntityName(){return this._clientApiExecutor.execute("getEntityName",(t,e)=>{if(!this._entityName){if(this._entityName=Object(u.H)(E.getState(),this._pageId,this._contextToken,this._controlName),!this._entityName&&3===this._gridType){const n=Object(h.ib)(E.getState(),this._connectedControlProps,this._contextToken.parentContextToken),a="TargetEntityType";if(!(n&&n.Controls&&n.Controls[this._controlName]&&n.Controls[this._controlName].Parameters&&n.Controls[this._controlName].Parameters[a])){let r;return n?n.Controls?n.Controls[this._controlName]?n.Controls[this._controlName].Parameters?n.Controls[this._controlName].Parameters[a]||(r="formDescriptor.Controls[this.name].Parameters[targetEntityType] is null or undefined"):r="formDescriptor.Controls[this.name].Parameters is null or undefined":r="formDescriptor.Controls[this.name] is null or undefined":r="formDescriptor.Controls is null or undefined":r="formDescriptor is null or undefined",this._clientApiExecutor.reportFailure(t,new g.a(r),e),null}this._entityName=n.Controls[this._controlName].Parameters[a]}if(!this._entityName)return this._clientApiExecutor.reportFailure(t,new g.a("Logical name of the entity type is coming as null or undefined."),e),null}return this._entityName})}refresh(){this._clientApiExecutor.executeAsync("refresh",()=>E.dispatch(Object(c.a)(this._pageId,this._contextToken,this._controlName)))}refreshRibbon(){this._clientApiExecutor.executeAsync("refreshRibbon",()=>E.dispatch(Object(C.a)(this._pageId,Object(u.w)(E.getState(),this._pageId,this._contextToken))))}getUrl(t){const e=N.c+"getUrl";try{m.a.instance.reportCall(e);let n=null,a=null;const r=this._getCurrentView();a={entityTypeName:this.getEntityName()},r&&(a.viewType="savedquery"===r.entityType?I.b.savedview:I.b.userview,a.viewId=new o.a(r.id)),n=i.a.Grid;let s=null;if(1===t)s=E.dispatch(Object(O.a)(n,a));else{const t=Object(T.a)(E,this._pageId);s=E.dispatch(Object(O.c)(t,n,a))}return m.a.instance.reportSuccess(e),s}catch(t){const n=d.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"controlName",value:this._controlName}),d.a.getInstance().reportFailure(e,t,null,n),t}}getRecordSetQueryKey(){return this._clientApiExecutor.execute("getRecordSetQueryKey",()=>Object(u.fb)(E.getState(),this._contextToken,{id:this._pageId}))}getGridType(){return m.a.instance.reportUsage(N.c+"getGridType"),this._gridType}getRelationship(){return this._clientApiExecutor.execute("getRelationship",(t,e)=>{if(!this._relationship){const n=Object(u.v)(E.getState(),this._pageId,this._contextToken);if(n){const t=n.relationshipName;if(t&&(this._relationship=w(t,this.getEntityName()),n.relationshipRoleOrdinal)){const t=n.relationshipRoleOrdinal===_.a.Referencing?1:2;this._relationship.roleType=t}}else b.a.getInstance().traceManager.getTracer(t).error("Grid dataset was null",e)}return this._relationship})}getParentForm(){const t=N.c+"getParentForm";try{m.a.instance.reportCall(t);const e=this._contextToken&&this._contextToken.parentContextToken?E.dispatch(Object(v.b)(this._pageId,this._contextToken.parentContextToken)):null;return m.a.instance.reportSuccess(t),e}catch(e){const n=d.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"controlName",value:this._controlName}),d.a.getInstance().reportFailure(t,e,null,n),e}}getRollupType(){return this._clientApiExecutor.execute("getRollupType",()=>Object(u.hb)(E.getState(),this._pageId,this._contextToken))}_getCurrentView(){let t=null;const e=this.getViewSelector().getCurrentView();if(e)return t="savedquery"===e.entityType?"savedquery":"userquery",{entityType:t,id:e.id};const n=Object(r.j)(E.getState(),this._pageId);if(n.viewType&&n.viewId){const e=n.viewId?o.a.externalGuid(n.viewId):void 0;if(t=n.viewType===I.b.savedview?"savedquery":"userquery",t&&e)return{entityType:t,id:e}}return null}}function w(t,e){const n={};n.name=t;const a=Object(j.h)(E.getState(),e);if(a){let e;if(a.OneToManyRelationships&&a.OneToManyRelationships[t]?e=a.OneToManyRelationships[t]:a.ManyToOneRelationships&&a.ManyToOneRelationships[t]&&(e=a.ManyToOneRelationships[t]),e)n.attributeName=e.ReferencingAttribute,n.relationshipType=0,n.navigationPropertyName=e.ReferencingEntityNavigationPropertyName;else if(a.ManyToManyRelationships&&a.ManyToManyRelationships[t]){const e=a.ManyToManyRelationships[t];n.relationshipType=1,1===n.roleType?(n.attributeName=e.Entity1IntersectAttribute,n.navigationPropertyName=e.Entity1NavigationPropertyName):(n.attributeName=e.Entity2IntersectAttribute,n.navigationPropertyName=e.Entity2NavigationPropertyName)}}return n}},HRnw:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var a=n("hAdb"),r=n("BFlg");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function i(t,e){if((null==e?void 0:e.CustomControlId)===r.y)return!0;if(null==e?void 0:e.CustomControlId){return Object(a.c)(t,"ModernDataSet")===e.CustomControlId.replace(/[.]/g,"_").toLowerCase()}return!1}},HhsT:function(t,e,n){"use strict";n.d(e,"a",(function(){return O}));var a=n("uNLT"),r=n("odYE"),i=n("Uv1Y"),s=n("cUbT"),o=n("gQ5I"),c=n("+aj2"),l=n("YxC/"),u=n("ZUzm"),d=n("sHzf"),h=n("bvqZ"),g=n("FdXt"),p=n("dHD5"),m=n("i1f0"),b=n("bT7G"),y=n("DuO/"),f=n("arV0"),v=n("hTZE");function O(t){return{type:"saveAndClose.saveAndCloseFormDialogAction.async",execute({dispatch:e,getState:n},O,C){const S=n(),j=Object(p.j)(S,t),I=Object(m.hc)(S,t,j);if(!Object(b.h)(S,I)){if(!e(Object(v.a)(t)))return}const T=Object(m.Hb)(S,t);return(T?e(Object(y.a)(t)).then(e=>{if(!(null==e?void 0:e.length))return null;const n=Object(f.j)(S,t);return new r.a(null==n?void 0:n.entityTypeName,null==e?void 0:e[0].recordId)}):e(Object(a.e)(t,2))).then(n=>{const a=Object(m.Ob)(S,t),r=a?"Forms.MainFormDialogRoot.SaveAndClose":"Forms.QuickCreateFormRoot.SaveAndClose";if(n){const i=[{name:"isEntityRefNull",value:!1},{name:"entityTypeName",value:n.etn}];O.EventManager.ReportComponentSuccess(r,i);return(a||T?Promise.resolve(t):e(Object(c.b)(t,n))).then(t=>(T||(e(Object(s.a)(n.etn)),function(t,e,n){const a="quickcreate_",r=Object(l.e)(e,[g.h,g.c]),i={actionLabel:Object(l.c)(r,g.h),eventHandler:()=>{t(Object(u.a)(n)),t(Object(d.removeToastNotification)(a+n.id.guid))}},s=null,o={id:a+n.id.guid,type:1,level:1,message:Object(l.c)(r,g.c),title:null,action:i,onCloseHandler:s};t(Object(h.addToastNotification)(o))}(e,S,n)),e(Object(o.e)(t,"save")).then(()=>n)))}if(!T){const t=[{name:"isEntityRefNull",value:!0}];throw O.EventManager.ReportComponentSuccess(r,t),new i.a("Record is not created")}})}}}},Khp3:function(t,e,n){"use strict";n.d(e,"a",(function(){return u})),n.d(e,"b",(function(){return d}));var a=n("jRy5"),r=n("dHD5"),i=n("ApeL"),s=n("jTSi"),o=n("i1f0"),c=n("Qn2w"),l=n("O7zD");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const u="control.notification.set";function d(t,e,n,d){return{type:"control.notification.set.clear.form.notification",sync:!0,execute(h,g){h.dispatch(function(t,e,n,s){if(s&&s.contextTokenType&&s.contextTokenType===a.a.GridRow)return Object(i.d)(t,s,e,n);let o={};o=n?{[n.uniqueId]:n}:null;const c=Object(r.y)(s);return{type:u,payload:o,meta:{pageId:t,contextKey:c,controlName:e}}}(t,e,n,d)),Object(o.ed)(h.getState(),t,d,e)||(h.dispatch(Object(c.b)(t,e,!0,d)),h.dispatch(Object(s.b)(d,t,Object(l.d)(t,e))))}}}},KnyI:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return i}));var a=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const r="attribute.removeOption";function i(t,e,n,i){const s=Object(a.y)(e);return{type:r,payload:i,meta:{pageId:t,contextKey:s,dataFieldName:n}}}},L8zx:function(t,e,n){"use strict";n.d(e,"a",(function(){return at})),n.d(e,"b",(function(){return rt}));var a=n("SAYH"),r=n("i1f0"),i=n("UqyN"),s=n("ABCl"),o=n("0nOn"),c=n("odYE"),l=n("hvSt"),u=n("a8GW"),d=n("5Oca"),h=n("CPoS"),g=n("qshH"),p=n("16wZ"),m=n("ZIjf");class b{constructor(t,e,n){const a="ClientApi.XrmProcessStep.constructor";e||Object(p.j)(a,"step"),n||Object(p.j)(a,"processManager"),t||Object(p.j)(a,"store"),this._step=e,this._processManager=n}isRequired(){const t="ClientApi.XrmProcessStep.isRequired";try{m.a.instance.reportCall(t);const e=this._step.get_isProcessRequired();return m.a.instance.reportSuccess(t),e}catch(e){throw g.a.getInstance().reportFailure(t,e),e}}getAttribute(){const t="ClientApi.XrmProcessStep.getAttribute";try{if(m.a.instance.reportCall(t),!this._attribute){const t=this._step.get_Steps().get_item(0);this._attribute=!t||t.get_isSystemControl()?null:t.get_dataFieldName()}return m.a.instance.reportSuccess(t),this._attribute}catch(e){throw g.a.getInstance().reportFailure(t,e),e}}getName(){const t="ClientApi.XrmProcessStep.getName";try{m.a.instance.reportCall(t);const e=this._step.get_Name();return m.a.instance.reportSuccess(t),e}catch(e){throw g.a.getInstance().reportFailure(t,e),e}}getProgress(){const t="ClientApi.XrmProcessStep.getProgress";try{m.a.instance.reportCall(t);let e=4;if(this._step.get_Steps()&&this._step.get_Steps().get_item(0)){if(this._step.get_Steps().get_item(0)instanceof Microsoft.Crm.Workflow.ObjectModel.ActionStep&&this._processManager){const t=this._processManager.getActionLog(new a.a(this._step.get_Id()));e=t?t.status:0}}return m.a.instance.reportSuccess(t),e}catch(e){throw g.a.getInstance().reportFailure(t,e),e}}setProgress(t,e){const n="ClientApi.XrmProcessStep.setProgress";try{m.a.instance.reportCall(n);let a="invalid";switch(t){case 0:case 1:case 2:case 3:case 4:a=this._setProgressInternal(t,e)}return m.a.instance.reportSuccess(n),a}catch(t){throw g.a.getInstance().reportFailure(n,t),t}}_setProgressInternal(t,e){if(this._step.get_Steps()&&this._step.get_Steps().get_item(0)){if(this._step.get_Steps().get_item(0)instanceof Microsoft.Crm.Workflow.ObjectModel.ActionStep){const n=this._processManager.updateActionLog(new a.a(this._step.get_Id()),{actionLogId:void 0,status:t,message:e});if(n)return n}}return"invalid"}}var y=n("Sbn7");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class f{constructor(t,e){this._processManager=e,null!=this._processManager&&this._processManager.shouldReInitializeNavigationBehavior()&&this._processManager.setBpfNavigationBehavior({allowCreateNew:this._allowCreateNew})}get allowCreateNew(){return m.a.instance.reportUsage("ClientApi.XrmProcessNavigationBehavior.getAllowCreateNew"),this._allowCreateNew}set allowCreateNew(t){const e="ClientApi.XrmProcessNavigationBehavior.setAllowCreateNew";try{m.a.instance.reportCall(e),this._allowCreateNew=t,null!=this._processManager&&this._processManager.setBpfNavigationBehavior({allowCreateNew:this._allowCreateNew}),m.a.instance.reportSuccess(e)}catch(t){throw g.a.getInstance().reportFailure(e,t),t}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let v;class O{constructor(t,e,n,a,r){v=t,this._entityTypeName=n,this._activeStageId=a,this._stageStep=e,new f(t,r),r&&(this._processManager=r)}getCategory(){const t="ClientApi.XrmProcessStage.getCategory";try{m.a.instance.reportCall(t);const e=this._stageStep.get_stageCategory(),n={getValue(){let t=parseInt(e,10);return Number.isNaN(t)&&(t=-1),t}};return m.a.instance.reportSuccess(t),n}catch(e){throw g.a.getInstance().reportFailure(t,e),e}}getId(){const t="ClientApi.XrmProcessStage.getId";try{m.a.instance.reportCall(t);const e=this._stageStep.get_Id();return m.a.instance.reportSuccess(t),e}catch(e){throw g.a.getInstance().reportFailure(t,e),e}}getEntityName(){return m.a.instance.reportUsage("ClientApi.XrmProcessStage.getEntityName"),this._entityTypeName}getStatus(){const t="ClientApi.XrmProcessStage.getStatus";try{m.a.instance.reportCall(t);const e=this.getId()===this._activeStageId?"active":"inactive";return m.a.instance.reportSuccess(t),e}catch(e){throw g.a.getInstance().reportFailure(t,e),e}}getName(){const t="ClientApi.XrmProcessStage.getName";try{m.a.instance.reportCall(t);const e=this._stageStep.get_Description();return m.a.instance.reportSuccess(t),e}catch(e){throw g.a.getInstance().reportFailure(t,e),e}}getSteps(){const t="ClientApi.XrmProcessStage.getSteps";try{if(m.a.instance.reportCall(t),!this._steps&&(this._steps=new y.a(t),null!=this._stageStep.get_Steps()&&this._stageStep.get_Steps().get_Count()>0))for(let t=0;t<this._stageStep.get_Steps().get_Count();t++){const e=this._stageStep.get_Steps().get_item(t);if(e instanceof Microsoft.Crm.Workflow.ObjectModel.StepStep){const t=e.get_Steps().get_item(0);t&&(t instanceof Microsoft.Crm.Workflow.ObjectModel.ControlStep||t instanceof Microsoft.Crm.Workflow.ObjectModel.ActionStep||t instanceof Microsoft.Crm.Workflow.ObjectModel.FlowStep)&&this._steps.add(e.get_Id(),new b(v,e,this._processManager))}}return m.a.instance.reportSuccess(t),this._steps}catch(e){throw g.a.getInstance().reportFailure(t,e),e}}getNavigationBehavior(){const t="ClientApi.XrmProcessStage.getNavigationBehavior";try{m.a.instance.reportCall(t);const e=this._processManager.getBpfNavigationBehavior();return m.a.instance.reportSuccess(t),e}catch(e){throw g.a.getInstance().reportFailure(t,e),e}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let C;class S{constructor(t,e,n,a,r){const i="ClientApi.XrmBusinessProcessFlow.constructor";e||Object(p.j)(i,"workflowStep"),a||Object(p.j)(i,"activeStageId"),r||Object(p.j)(i,"processManager"),t||Object(p.j)(i,"store"),Object(p.a)(n)&&Object(p.j)(i,"isRendered"),C=t,this._isRendered=n,this._workflowStep=e,this._activeStageId=a,this._processManager=r}getName(){const t="ClientApi.XrmBusinessProcessFlow.getName";try{m.a.instance.reportCall(t);const e=this._workflowStep.get_Name();return m.a.instance.reportSuccess(t),e}catch(e){throw g.a.getInstance().reportFailure(t,e),e}}getId(){const t="ClientApi.XrmBusinessProcessFlow.getId";try{m.a.instance.reportCall(t);const e=this._workflowStep.get_Id();return m.a.instance.reportSuccess(t),e}catch(e){throw g.a.getInstance().reportFailure(t,e),e}}isRendered(){return m.a.instance.reportUsage("ClientApi.XrmBusinessProcessFlow.isRendered"),this._isRendered}getStages(){const t="ClientApi.XrmBusinessProcessFlow.getStages";try{if(m.a.instance.reportCall(t),!this._stages){this._stages=new y.a(t);for(let t=0;t<this._workflowStep.get_Steps().get_Count();t++){const e=this._workflowStep.get_Steps().get_item(t);if(e instanceof Microsoft.Crm.Workflow.ObjectModel.EntityStep){const t=e;for(let e=0;e<t.get_Steps().get_Count();e++){const n=t.get_Steps().get_item(e);this._stages.add(n.get_Id(),new O(C,n,t.get_EntityLogicalName(),this._activeStageId,this._processManager))}}}}return m.a.instance.reportSuccess(t),this._stages}catch(e){throw g.a.getInstance().reportFailure(t,e),e}}}var j,I=n("1kth"),T=n("cZbt"),x=n("blB4"),A=n("UuJw");!function(t){t.success="success",t.invalid="invalid"}(j||(j={}));var _=n("Uv1Y"),N=n("r/aD"),E=n("iF9X"),P=n("37s6"),w=n("69Qu"),F=n("IaGr"),k=n("arV0"),D=n("2Ct/"),M=n("ycdb"),L=n("ruPX"),R=n("cfbi"),X=n("Lyxw"),V=n("dpM5"),U=n("pEXn"),G=n("+Qpx"),B=n("wL2W");let Y;class z{constructor(t,e,n,r,i){this._clientApiExecutor=new o.a(t,"ClientApi.XrmProcessControlData.",n,e);const s=this._clientApiExecutor.getComponentName("constructor");n||Object(p.j)(s,"pageId"),r||Object(p.j)(s,"entity"),e||Object(p.j)(s,"contextToken"),t||Object(p.j)(s,"store"),Y=t,this._pageId=n,this._entity=r;let l=!1;Object(N.d)(Y.getState(),this._pageId,s,!0)&&(this._processManager=i,l=!0),this._contextToken=e;const u=r.getEntityReference();this._entityRef=new c.a(u.entityType,a.a.tryParseOrNull(u.id),u.name);const d=Object(N.b)(n,t.getState(),l);F.a.getInstance().eventManager.ReportComponentSuccess(s,d)}getActiveProcess(){const t="ClientApi.XrmProcessControlData.getActiveProcess";try{if(m.a.instance.reportCall(t),!Object(N.d)(Y.getState(),this._pageId,t))return m.a.instance.reportSuccess(t),null;const e=this._getProcessManager().getProcess();let n=null;if(e){const t=this._getProcessManager().getActiveStageId();n=new S(Y,e,!0,t,this._getProcessManager())}return m.a.instance.reportSuccess(t),n}catch(e){const n=g.a.getInstance().getEventParameters(this._contextToken);throw g.a.getInstance().reportFailure(t,e,null,n),e}}setStatus(t,e){const n="ClientApi.XrmProcessControlData.setStatus";try{if(m.a.instance.reportCall(n),!Object(N.d)(Y.getState(),this._pageId,n))return void m.a.instance.reportSuccess(n);if(!t||this.getStatus()&&t===this.getStatus())return void m.a.instance.reportSuccess(n);let a;if(t===T.a.active)a=l.a.Active;else if(t===T.a.finished)a=l.a.Finished;else{if(t!==T.a.aborted)return void m.a.instance.reportSuccess(n);a=l.a.Aborted}this._getProcessManager().setStatus(a).then(()=>{this._callback(e,t,n),m.a.instance.reportSuccess(n)}).catch(a=>{var r;if(Object(B.a)()){const e=[{name:"OriginalStatus",value:this.getStatus()},{name:"NewStatus",value:t},{name:"Error",value:Object(_.d)(a)},{name:"ComponentName",value:n}];null===(r=F.a.getInstance().traceManager.getTracer(`${G.b}${G.g}`))||void 0===r||r.error(G.d,[{name:U.l,value:G.g},{name:G.g,value:JSON.stringify(e)}])}this._callback(e,T.a.invalid,n)})}catch(t){const e=g.a.getInstance().getEventParameters(this._contextToken);throw g.a.getInstance().reportFailure(n,t,null,e),t}}getStatus(){const t="ClientApi.XrmProcessControlData.getStatus";try{if(m.a.instance.reportCall(t),!Object(N.d)(Y.getState(),this._pageId,t))return m.a.instance.reportSuccess(t),null;const e=this._convertToXrmProcessInstanceStatus(this._getProcessManager().getStatus());return m.a.instance.reportSuccess(t),e}catch(e){const n=g.a.getInstance().getEventParameters(this._contextToken);throw g.a.getInstance().reportFailure(t,e,null,n),e}}getInstanceName(){const t="ClientApi.XrmProcessControlData.getInstanceName";try{if(m.a.instance.reportCall(t),!Object(N.d)(Y.getState(),this._pageId,t))return m.a.instance.reportSuccess(t),null;let e=this._getProcessManager().getProcessInstanceName();if(!e){const t=Object(d.e)(Y.getState(),this._entityRef);e=Object(h.c)(Y.getState(),t)}return m.a.instance.reportSuccess(t),e}catch(e){const n=g.a.getInstance().getEventParameters(this._contextToken);throw g.a.getInstance().reportFailure(t,e,null,n),e}}getInstanceId(){const t="ClientApi.XrmProcessControlData.getInstanceId";try{if(m.a.instance.reportCall(t),!Object(N.d)(Y.getState(),this._pageId,t))return m.a.instance.reportSuccess(t),null;const e=this._getProcessManager().getProcessInstanceId(),n=e?a.a.toString(e):null;return m.a.instance.reportSuccess(t),n}catch(e){const n=g.a.getInstance().getEventParameters(this._contextToken);throw g.a.getInstance().reportFailure(t,e,null,n),e}}getProcessInstances(t){const e="ClientApi.XrmProcessControlData.getProcessInstances";try{m.a.instance.reportCall(e);const n=Object(k.j)(Y.getState(),this._pageId);if(!Object(N.d)(Y.getState(),this._pageId,e)||Object(D.h)(Y.getState(),null==n?void 0:n.entityTypeName))return;"function"==typeof t&&this._getProcessManager().getProcessInstances().then(n=>{if(n&&n.value&&n.value.length>0){const a={};n.value.forEach(t=>{t.businessprocessflowinstanceid&&(a[t.businessprocessflowinstanceid]={CreatedOnDate:t.createdon?new Date(t.createdon):null,ProcessDefinitionID:t._processid_value,ProcessDefinitionName:t.name,ProcessInstanceID:t.businessprocessflowinstanceid,ProcessInstanceName:t.name,StatusCodeName:this._convertToXrmProcessInstanceStatus(t.Process_x002e_statuscode),CreatedOn:t.createdon?new Date(t.createdon).toLocaleDateString():"",ProcessDefintionID:t._processid_value,ProcessDefintionName:t.name})}),Object(s.c)(e,[],()=>{t(a)})}m.a.instance.reportSuccess(e)}).catch(t=>{const n=g.a.getInstance().getEventParameters(this._contextToken);return Object(p.d)(Y,t,e+".getProcessInstances",n)})}catch(t){const n=g.a.getInstance().getEventParameters(this._contextToken);throw g.a.getInstance().reportFailure(e,t,null,n),t}}setActiveProcess(t,e){this._clientApiExecutor.executeAsync("setActiveProcess",(n,i)=>{const s=a.a.tryParseOrNull(t),o=Object(r.kd)(Y.getState(),this._pageId);if(s&&a.a.equals(s,a.a.EMPTY)){if(o){const t=new c.a(this._entity.getEntityName(),a.a.EMPTY);return Y.dispatch(Object(M.b)(!0,t)),F.a.getInstance().eventManager.ReportComponentSuccess(n,i),Promise.resolve().then(()=>{this._callback(e,j.success,n,i)}).catch(t=>{throw this._callback(e,j.invalid,n,i),t})}return Promise.resolve().then(()=>{this._callback(e,j.invalid,n,i)})}const l=Object(k.j)(Y.getState(),this._pageId);if(!Object(N.d)(Y.getState(),this._pageId,n,!0)||Object(D.h)(Y.getState(),null==l?void 0:l.entityTypeName))return Promise.resolve();return this._getProcessManager().setActiveProcess(t,"ClientAPI").then(()=>{this._callback(e,j.success,n,i);const a=this.getActiveProcess();a&&a.getId().toUpperCase()===t.toUpperCase()||this._reloadPage(n,this._getProcessManager().getCurrentFormEntity(),t)}).catch(t=>{throw this._callback(e,j.invalid,n,i),t})},[{name:"processId",value:t,isRequired:!0,expectedDataType:"guid"}])}setActiveProcessInstance(t,e){this._clientApiExecutor.executeAsync("setActiveProcessInstance",(n,a)=>{const r=Object(k.j)(Y.getState(),this._pageId);return!Object(N.d)(Y.getState(),this._pageId,n)||Object(D.h)(Y.getState(),null==r?void 0:r.entityTypeName)?Promise.resolve():this._getProcessManager().setActiveProcessInstance(t,"ClientAPI").then(r=>{this._callback(e,j.success,n,a);this.getInstanceId()!==t&&this._reloadPage(n,this._getProcessManager().getCurrentFormEntity(),r,t)}).catch(t=>{throw this._callback(e,j.invalid,n,a),t})},[{name:"processInstanceId",value:t,isRequired:!0,expectedDataType:"guid"}])}getEnabledProcesses(t){const e="ClientApi.XrmProcessControlData.getEnabledProcesses";try{if(m.a.instance.reportCall(e),!Object(N.d)(Y.getState(),this._pageId,e,!0))return void m.a.instance.reportSuccess(e);const n=Y.getState();if(Object(E.g)(n)&&Object(P.D)(n)&&!Object(w.c)(n)){const n={};return void("function"==typeof t&&Object(s.c)(e,[],()=>{t(n)}))}this._getProcessManager().getEnabledProcesses().then(n=>{const a={};n&&n.length>0&&n.forEach(t=>{a[t.workflowId]=t.name}),"function"==typeof t&&Object(s.c)(e,[],()=>{t(a)}),m.a.instance.reportSuccess(e)}).catch(t=>{const n=g.a.getInstance().getEventParameters(this._contextToken);return Object(p.d)(Y,t,e+".getEnabledProcesses",n)})}catch(t){const n=g.a.getInstance().getEventParameters(this._contextToken);throw g.a.getInstance().reportFailure(e,t,null,n),t}}switchProcess(){const t="ClientApi.XrmProcessControlData.switchProcess";try{m.a.instance.reportCall(t);const e=Object(k.j)(Y.getState(),this._pageId);if(!Object(N.d)(Y.getState(),this._pageId,t)||Object(D.h)(Y.getState(),null==e?void 0:e.entityTypeName))return;this._getProcessManager().switchProcess(),m.a.instance.reportSuccess(t)}catch(e){const n=g.a.getInstance().getEventParameters(this._contextToken);throw g.a.getInstance().reportFailure(t,e,null,n),e}}abandonProcess(){const t="ClientApi.XrmProcessControlData.abandonProcess";try{if(m.a.instance.reportCall(t),!Object(N.d)(Y.getState(),this._pageId,t)||Object(r.kd)(Y.getState(),this._pageId))return void m.a.instance.reportSuccess(t);this._getProcessManager().abandonProcess().then(()=>{m.a.instance.reportSuccess(t)}).catch(e=>{const n=g.a.getInstance().getEventParameters(this._contextToken);return Object(p.d)(Y,e,t+".abandonProcess",n)})}catch(e){const n=g.a.getInstance().getEventParameters(this._contextToken);throw g.a.getInstance().reportFailure(t,e,null,n),e}}reactivateProcess(){const t="ClientApi.XrmProcessControlData.reactivateProcess";try{if(m.a.instance.reportCall(t),!Object(N.d)(Y.getState(),this._pageId,t)||Object(r.kd)(Y.getState(),this._pageId))return void m.a.instance.reportSuccess(t);this._getProcessManager().reactivateProcess().then(()=>{m.a.instance.reportSuccess(t)}).catch(e=>{const n=g.a.getInstance().getEventParameters(this._contextToken);return Object(p.d)(Y,e,t+".reactivateProcess",n)})}catch(e){const n=g.a.getInstance().getEventParameters(this._contextToken);throw g.a.getInstance().reportFailure(t,e,null,n),e}}completeProcess(){const t="ClientApi.XrmProcessControlData.completeProcess";try{if(m.a.instance.reportCall(t),!Object(N.d)(Y.getState(),this._pageId,t)||Object(r.kd)(Y.getState(),this._pageId))return void m.a.instance.reportSuccess(t);this._getProcessManager().completeProcess().then(()=>{m.a.instance.reportSuccess(t)}).catch(e=>{const n=g.a.getInstance().getEventParameters(this._contextToken);return Object(p.d)(Y,e,t+".completeProcess",n)})}catch(e){const n=g.a.getInstance().getEventParameters(this._contextToken);throw g.a.getInstance().reportFailure(t,e,null,n),e}}getActiveStage(){const t="ClientApi.XrmProcessControlData.getActiveStage";try{if(m.a.instance.reportCall(t),!Object(N.d)(Y.getState(),this._pageId,t))return m.a.instance.reportSuccess(t),null;const e=this._getProcessManager().getActiveStage();let n=null;return e&&(n=new O(Y,e,this._getProcessManager().getCurrentFormEntity().etn,e.get_Id(),this._getProcessManager())),m.a.instance.reportSuccess(t),n}catch(e){const n=g.a.getInstance().getEventParameters(this._contextToken);throw g.a.getInstance().reportFailure(t,e,null,n),e}}getActivePath(){const t="ClientApi.XrmProcessControlData.getActivePath";try{if(m.a.instance.reportCall(t),!Object(N.d)(Y.getState(),this._pageId,t))return m.a.instance.reportSuccess(t),null;const e=this._getProcessManager().getActivePathStages();let n=null;if(e){const a=this._getProcessManager().getActiveStageId(),r=new y.a(t);e.forEach(t=>{const e=t.get_parent().get_EntityLogicalName();r.add(t.get_stageId(),new O(Y,t,e,a,this._getProcessManager()))}),n=r}return m.a.instance.reportSuccess(t),n}catch(e){const n=g.a.getInstance().getEventParameters(this._contextToken);throw g.a.getInstance().reportFailure(t,e,null,n),e}}setActiveStage(t,e){const n="ClientApi.XrmProcessControlData.setActiveStage";try{if(m.a.instance.reportCall(n),this._entity.getIsDirty()||Object(r.kd)(Y.getState(),this._pageId))m.a.instance.reportSuccess(n),this._callback(e,x.a.dirtyForm,n);else{if(!Object(N.d)(Y.getState(),this._pageId,n))return void m.a.instance.reportSuccess(n);this._getProcessManager().setActiveStage(t,!0).then(t=>{0===(null==t?void 0:t.status)&&!0===t.preventDefault?this._callback(e,this._getStageInvalidReason(new u.g),n):Object(X.f)(Y.getState(),V.c)?this._loadActiveStageEntity(n).then(()=>{this._callback(e,this._getStageInvalidReason(null),n)}).catch(t=>{var a;Object(B.a)()&&(null===(a=F.a.getInstance().traceManager.getTracer(`${G.b}${G.f}`))||void 0===a||a.error(G.d,[{name:U.l,value:G.f},{name:G.f,value:JSON.stringify({Error:Object(_.d)(t)})}])),this._callback(e,t?this._getStageInvalidReason(t):A.a.invalid,n)}):(this._callback(e,this._getStageInvalidReason(null),n),this._loadActiveStageEntity(n)),m.a.instance.reportSuccess(n)}).catch(t=>{this._callback(e,t?this._getStageInvalidReason(t):A.a.invalid,n)})}}catch(t){const e=g.a.getInstance().getEventParameters(this._contextToken);throw g.a.getInstance().reportFailure(n,t,null,e),t}}moveNext(t){const e="ClientApi.XrmProcessControlData.moveNext";try{const n=!0;if(m.a.instance.reportCall(e),this._entity.getIsDirty()||Object(r.kd)(Y.getState(),this._pageId))m.a.instance.reportSuccess(e),this._callback(t,x.a.dirtyForm,e);else{if(!Object(N.d)(Y.getState(),this._pageId,e))return void m.a.instance.reportSuccess(e);if(this._getProcessManager().isCrossEntityNavigation(n))return this._callback(t,x.a.crossEntity,e),void m.a.instance.reportSuccess(e);this._getProcessManager().moveToNextStage(!0,"ClientAPI").then(()=>{this._callback(t,this._getNavigationStatus(null),e),m.a.instance.reportSuccess(e)}).catch(n=>{const a=n?this._getNavigationStatus(n):x.a.invalid;if(this._callback(t,a,e),a===x.a.invalid){const t=g.a.getInstance().getEventParameters(this._contextToken);return Object(p.d)(Y,n,e+".moveToNextStage",t)}m.a.instance.reportSuccess(e)})}}catch(t){const n=g.a.getInstance().getEventParameters(this._contextToken);throw g.a.getInstance().reportFailure(e,t,null,n),t}}movePrevious(t){const e="ClientApi.XrmProcessControlData.movePrevious";try{const n=!0;if(m.a.instance.reportCall(e),this._entity.getIsDirty()||Object(r.kd)(Y.getState(),this._pageId))m.a.instance.reportSuccess(e),this._callback(t,x.a.dirtyForm,e);else{if(!Object(N.d)(Y.getState(),this._pageId,e))return void m.a.instance.reportSuccess(e);const a=Object(k.j)(Y.getState(),this._pageId);if(Object(D.h)(Y.getState(),null==a?void 0:a.entityTypeName)&&this._getProcessManager().isCrossEntityNavigation(!n))return this._callback(t,x.a.crossEntity,e),void m.a.instance.reportSuccess(e);this._getProcessManager().moveToPreviousStage(!0,"ClientAPI").then(n=>{0===(null==n?void 0:n.status)&&!0===n.preventDefault?this._callback(t,this._getStageInvalidReason(new u.g),e):(this._callback(t,this._getNavigationStatus(null),e),this._loadActiveStageEntity(e)),m.a.instance.reportSuccess(e)}).catch(n=>{const a=n?this._getNavigationStatus(n):x.a.invalid;if(this._callback(t,a,e),a===x.a.invalid){const t=g.a.getInstance().getEventParameters(this._contextToken);return Object(p.d)(Y,n,e+".moveToPreviousStage",t)}m.a.instance.reportSuccess(e)})}}catch(t){const n=g.a.getInstance().getEventParameters(this._contextToken);throw g.a.getInstance().reportFailure(e,t,null,n),t}}getSelectedStage(){const t="ClientApi.XrmProcessControlData.getSelectedStage";try{if(m.a.instance.reportCall(t),!Object(N.d)(Y.getState(),this._pageId,t))return m.a.instance.reportSuccess(t),null;const e=this._getProcessManager().getSelectedStage();let n=null;if(e){const t=this._getProcessManager().getActiveStageId();n=new O(Y,e,this._getProcessManager().getCurrentFormEntity().etn,t,this._getProcessManager())}return m.a.instance.reportSuccess(t),n}catch(e){const n=g.a.getInstance().getEventParameters(this._contextToken);throw g.a.getInstance().reportFailure(t,e,null,n),e}}addOnStageChange(t){const e="ClientApi.XrmProcessControlData.addOnStageChange";t||Object(p.j)(e,"handler");try{if(m.a.instance.reportCall(e),!Object(N.d)(Y.getState(),this._pageId,e))return void m.a.instance.reportSuccess(e);Y.dispatch(Object(I.r)(this._contextToken,this._pageId,t)),m.a.instance.reportSuccess(e)}catch(t){const n=g.a.getInstance().getEventParameters(this._contextToken);throw g.a.getInstance().reportFailure(e,t,null,n),t}}addOnPreStageChange(t){const e="ClientApi.XrmProcessControlData.addOnPreStageChange";Object(p.g)(t,e,"handler");try{if(m.a.instance.reportCall(e),!Object(N.d)(Y.getState(),this._pageId,e))return void m.a.instance.reportSuccess(e);Y.dispatch(Object(I.k)(this._contextToken,this._pageId,t)),m.a.instance.reportSuccess(e)}catch(t){const n=g.a.getInstance().getEventParameters(this._contextToken);throw g.a.getInstance().reportFailure(e,t,null,n),t}}removeOnStageChange(t){const e="ClientApi.XrmProcessControlData.removeOnStageChange";t||Object(p.j)(e,"handler");try{if(m.a.instance.reportCall(e),!Object(N.d)(Y.getState(),this._pageId,e))return void m.a.instance.reportSuccess(e);Y.dispatch(Object(I.N)(this._contextToken,this._pageId,t)),m.a.instance.reportSuccess(e)}catch(t){const n=g.a.getInstance().getEventParameters(this._contextToken);throw g.a.getInstance().reportFailure(e,t,null,n),t}}removeOnPreStageChange(t){const e="ClientApi.XrmProcessControlData.removeOnPreStageChange";Object(p.g)(t,e,"handler");try{if(m.a.instance.reportCall(e),!Object(N.d)(Y.getState(),this._pageId,e))return void m.a.instance.reportSuccess(e);Y.dispatch(Object(I.G)(this._contextToken,this._pageId,t)),m.a.instance.reportSuccess(e)}catch(t){const n=g.a.getInstance().getEventParameters(this._contextToken);throw g.a.getInstance().reportFailure(e,t,null,n),t}}addOnStageSelected(t){const e="ClientApi.XrmProcessControlData.addOnStageSelected";t||Object(p.j)(e,"handler");try{if(m.a.instance.reportCall(e),!Object(N.d)(Y.getState(),this._pageId,e))return void m.a.instance.reportSuccess(e);Y.dispatch(Object(I.s)(this._contextToken,this._pageId,t)),m.a.instance.reportSuccess(e)}catch(t){const n=g.a.getInstance().getEventParameters(this._contextToken);throw g.a.getInstance().reportFailure(e,t,null,n),t}}removeOnStageSelected(t){const e="ClientApi.XrmProcessControlData.removeOnStageSelected";t||Object(p.j)(e,"handler");try{if(m.a.instance.reportCall(e),!Object(N.d)(Y.getState(),this._pageId,e))return void m.a.instance.reportSuccess(e);Y.dispatch(Object(I.O)(this._contextToken,this._pageId,t)),m.a.instance.reportSuccess(e)}catch(t){const n=g.a.getInstance().getEventParameters(this._contextToken);throw g.a.getInstance().reportFailure(e,t,null,n),t}}addOnProcessStatusChange(t){const e="ClientApi.XrmProcessControlData.addOnProcessStatusChange";t||Object(p.j)(e,"handler");try{if(m.a.instance.reportCall(e),!Object(N.d)(Y.getState(),this._pageId,e))return void m.a.instance.reportSuccess(e);Y.dispatch(Object(I.l)(this._contextToken,this._pageId,t)),m.a.instance.reportSuccess(e)}catch(t){const n=g.a.getInstance().getEventParameters(this._contextToken);throw g.a.getInstance().reportFailure(e,t,null,n),t}}addOnPreProcessStatusChange(t){const e="ClientApi.XrmProcessControlData.addOnPreProcessStatusChange";Object(p.g)(t,e,"handler");try{if(m.a.instance.reportCall(e),!Object(N.d)(Y.getState(),this._pageId,e))return void m.a.instance.reportSuccess(e);Y.dispatch(Object(I.j)(this._contextToken,this._pageId,t)),m.a.instance.reportSuccess(e)}catch(t){const n=g.a.getInstance().getEventParameters(this._contextToken);throw g.a.getInstance().reportFailure(e,t,null,n),t}}removeOnProcessStatusChange(t){const e="ClientApi.XrmProcessControlData.removeOnProcessStatusChange";t||Object(p.j)(e,"handler");try{if(m.a.instance.reportCall(e),!Object(N.d)(Y.getState(),this._pageId,e))return void m.a.instance.reportSuccess(e);Y.dispatch(Object(I.H)(this._contextToken,this._pageId,t)),m.a.instance.reportSuccess(e)}catch(t){const n=g.a.getInstance().getEventParameters(this._contextToken);throw g.a.getInstance().reportFailure(e,t,null,n),t}}removeOnPreProcessStatusChange(t){const e="ClientApi.XrmProcessControlData.removeOnPreProcessStatusChange";Object(p.g)(t,e,"handler");try{if(m.a.instance.reportCall(e),!Object(N.d)(Y.getState(),this._pageId,e))return void m.a.instance.reportSuccess(e);Y.dispatch(Object(I.F)(this._contextToken,this._pageId,t)),m.a.instance.reportSuccess(e)}catch(t){const n=g.a.getInstance().getEventParameters(this._contextToken);throw g.a.getInstance().reportFailure(e,t,null,n),t}}_getStageInvalidReason(t){return t?t.stageInvalidReason||A.a.invalid:x.a.success}_getNavigationStatus(t){return t?t.navigationStatus||x.a.invalid:x.a.success}_convertToXrmProcessInstanceStatus(t){if(t){if(t===l.a.Active)return T.a.active;if(t===l.a.Finished)return T.a.finished;if(t===l.a.Aborted)return T.a.aborted}return null}_callback(t,e,n,a){const r=n+".Callback";a||(a=g.a.getInstance().getEventParameters(this._contextToken)),a.push({name:"Status",value:e}),Object(s.c)(r,a,()=>{"function"==typeof t&&t(e)})}_reloadPage(t,e,n,a){if(e){const i=Object(r.kd)(Y.getState(),this._pageId),s={entityTypeName:e.etn,id:i?void 0:e.id,processId:n,processInstanceId:a},o={replaceState:!0};return Y.dispatch(Object(L.a)(R.b,s,this._pageId,o)).then(e=>{if(0!==e.status)return Object(p.d)(Y,e.error,t+".navigateTo.INavigationFailure")}).catch(e=>Object(p.d)(Y,e,t+".navigateTo."))}return Promise.resolve()}_loadActiveStageEntity(t){const e=this._getProcessManager().getActiveStageEntityRef();return e&&e.etn!==this._getProcessManager().getCurrentFormEntity().etn?this._reloadPage(t,e,this.getActiveProcess().getId(),this.getInstanceId()):Promise.resolve()}_getProcessManager(){return this._processManager||(this._processManager=Object(N.c)(this._processManager,Y,this._pageId,"ClientApi.XrmProcessControlData.getProcessManager")),this._processManager}}var H=n("uNLT"),q=n("/q/W"),W=n("jRy5"),K=n("Fij2"),Q=n("HhsT"),Z=n("E8F2"),J=n("PUjk"),$=n("AE7n"),tt=n("P6DH"),et=n("d4Lp");let nt;class at{constructor(t,e,n,a,r){this._entity=null;const i="ClientApi.XrmFormData.constructor";t||Object(p.j)(i,"store"),n||Object(p.j)(i,"pageId"),e||Object(p.j)(i,"contextToken"),a||Object(p.j)(i,"formContext"),nt=t,this._pageId=n,this._formContext=a,this._contextToken=e,this._entity=r}get entity(){return m.a.instance.reportUsage("ClientApi.XrmFormData.entity"),this._entity}get process(){const t="ClientApi.XrmFormData.process_get";try{const e=Object(D.g)(nt.getState());m.a.instance.reportCall(t);const n=!!this._process;if((!e&&!this._process||e)&&this._entity){const t=Object(k.j)(nt.getState(),this._pageId),e=Object(J.b)(this._pageId,t);this._entity&&(this._process=new z(nt,this._contextToken,this._pageId,this.entity,e))}m.a.instance.reportSuccess(t);const a=Object(N.a)(this._pageId,nt.getState(),n,!!this._entity);return F.a.getInstance().eventManager.ReportComponentSuccess(t,a),this._process}catch(e){const n=g.a.getInstance().getEventParameters(this._contextToken);throw g.a.getInstance().reportFailure(t,e,null,n),e}}set process(t){const e=Object(N.a)(this._pageId,nt.getState(),!!this._process,!!this._entity);F.a.getInstance().eventManager.ReportComponentSuccess("ClientApi.XrmFormData.process_set",e),this._process=t}getEntity(){return m.a.instance.reportUsage("ClientApi.XrmFormData.getEntity"),this._entity}getIsDirty(){var t,e,n;const a="ClientApi.XrmFormData.getIsDirty";try{m.a.instance.reportCall(a);let r=!1;if(this._entity&&this._entity.getIsDirty())r=!0;else{for(let t=0;t<this.attributes.getLength();t++){const e=this.attributes.get(t);if("never"!==e.getSubmitMode()&&e.getIsDirty()){r=!0;break}}if(!r&&(null===(e=null===(t=this._formContext)||void 0===t?void 0:t.ui)||void 0===e?void 0:e.controls))for(let t=0;t<this._formContext.ui.controls.getLength();t++){const e=this._formContext.ui.controls.get(t);if("formcomponent"===e.getControlType()&&e.isLoaded()&&(null===(n=e.data)||void 0===n?void 0:n.getIsDirty())){r=!0;break}}}return m.a.instance.reportSuccess(a),r}catch(t){const e=g.a.getInstance().getEventParameters(this._contextToken);throw g.a.getInstance().reportFailure(a,t,null,e),t}}get attributes(){const t="ClientApi.XrmFormData.attributes";try{if(m.a.instance.reportCall(t),!this._unboundAttributes){this._unboundAttributes=new y.a(t);const e=Object(r.Xc)(nt.getState(),this._pageId);if(e)for(const t in e){const n=e[t],a=t,r=Object(i.b)(nt,this._contextToken,this._pageId,a,this.entity,this._formContext.ui,n);this._unboundAttributes.add(r.getName(),r)}}return m.a.instance.reportSuccess(t),this._unboundAttributes}catch(e){const n=g.a.getInstance().getEventParameters(this._contextToken);throw g.a.getInstance().reportFailure(t,e,null,n),e}}_refreshEntity(t){return this.entity.refresh().then(()=>{Object(H.d)(nt.dispatch,this._contextToken,this._pageId),t&&nt.dispatch(Object(I.S)(this._contextToken,this._pageId,3,this.entity)),Object(K.b)(this.entity)})}refresh(t){const e="ClientApi.XrmFormData.refresh";try{if(m.a.instance.reportCall(e),Object(r.Hb)(nt.getState(),this._pageId))return Promise.resolve({});if(this.entity){const n=Object(r.nb)(nt.getState(),{id:this._pageId},this._contextToken);return!n&&t&&this.entity.getIsDirty()?this.save().then(t=>(m.a.instance.reportSuccess(e),{})).catch(t=>{const n=g.a.getInstance().getEventParameters(this._contextToken);return Object(p.d)(nt,t,e+".save",n)}):!n&&this.entity.getIsDirty()?nt.dispatch(Object(q.a)(this._pageId)).then(t=>{if(t)return this._refreshEntity(!0).then(()=>(m.a.instance.reportSuccess(e),{})).catch(t=>{const n=g.a.getInstance().getEventParameters(this._contextToken);return Object(p.d)(nt,t,e+".handleUnsavedChanges.refreshEntity",n)})}).catch(t=>{const n=g.a.getInstance().getEventParameters(this._contextToken);return Object(p.d)(nt,t,e+".handleUnsavedChanges",n)}):this._refreshEntity(!0).then(()=>(m.a.instance.reportSuccess(e),{})).catch(t=>{const n=g.a.getInstance().getEventParameters(this._contextToken);return Object(p.d)(nt,t,e+".handleUnsavedChanges.refreshEntity",n)})}const n=new _.a("Refresh action cannot be executed since form entity is null",2147746581);return F.a.getInstance().traceManager.getTracer(e).info("Refreshing on a non entity page"),Object(p.d)(nt,n,e+".entity")}catch(t){const n=g.a.getInstance().getEventParameters(this._contextToken);return Object(p.d)(nt,t,e,n)}}save(t){const e="ClientApi.XrmFormData.save",n=g.a.getInstance().getEventParameters(this._contextToken);if(!this._entity){const t=new _.a("Save action cannot be executed since form entity is null",2147746581);return Object(p.d)(nt,t,e+".entity")}try{m.a.instance.reportCall(e);let i=1;t&&t.saveMode&&(i=t.saveMode);return rt(this._pageId,nt,i,n,this._contextToken,this.entity,!0,!0).then(t=>{if(t){const i={entityType:t.etn,id:a.a.toString(t.id),name:t.name};return Object(r.Qb)(nt.getState(),this._pageId)?(m.a.instance.reportSuccess(e),{savedEntityReference:i}):this._refreshEntity(!1).then(()=>(m.a.instance.reportSuccess(e),{savedEntityReference:i})).catch(t=>Object(p.d)(nt,t,e+".refresh",n))}if(Object(r.Hb)(nt.getState(),this._pageId))throw Object(Z.b)(nt.getState(),this._pageId,2200000006);if(Object(r.nb)(nt.getState(),{id:this._pageId},this._contextToken)||!this.entity.getIsDirty()){const t=this.entity.getEntityReference();return m.a.instance.reportSuccess(e),{savedEntityReference:t}}const i=new _.a("Save action was not executed and the form is dirty.",2147879192);return Object(p.d)(nt,i,e+".NoReference",null,!1)}).catch(t=>{if(t&&(2200000006===t.errorCode||2200000004===t.errorCode)){const t=this.entity.getEntityReference();return m.a.instance.reportSuccess(e),{savedEntityReference:t}}return Object(p.d)(nt,t,e,n)})}catch(t){return Object(p.d)(nt,t,e,n)}}isValid(){var t,e,n;const a="ClientApi.XrmFormData.isValid";try{m.a.instance.reportCall(a);let r=!0;if(this.entity&&!this.entity.isValid())r=!1;else if(this.attributes)for(let t=0;t<this.attributes.getLength();t++)if(!this.attributes.get(t).isValid()){r=!1;break}if(r&&(null===(e=null===(t=this._formContext)||void 0===t?void 0:t.ui)||void 0===e?void 0:e.controls))for(let t=0;t<this._formContext.ui.controls.getLength();t++){const e=this._formContext.ui.controls.get(t);if("formcomponent"===e.getControlType()&&e.isLoaded()&&!(null===(n=e.data)||void 0===n?void 0:n.isValid())){r=!1;break}}return r||nt.dispatch(Object(et.b)(this._pageId,this._contextToken)),m.a.instance.reportSuccess(a),r}catch(t){const e=g.a.getInstance().getEventParameters(this._contextToken);throw g.a.getInstance().reportFailure(a,t,null,e),t}}addOnLoad(t){const e="ClientApi.XrmFormData.addOnLoad";t||Object(p.j)(e,"handler");try{m.a.instance.reportCall(e),nt.dispatch(Object(I.c)(this._contextToken,this._pageId,t)),m.a.instance.reportSuccess(e)}catch(t){const n=g.a.getInstance().getEventParameters(this._contextToken);throw g.a.getInstance().reportFailure(e,t,null,n),t}}removeOnLoad(t){const e="ClientApi.XrmFormData.removeOnLoad";t||Object(p.j)(e,"handler");try{m.a.instance.reportCall(e),nt.dispatch(Object(I.y)(this._contextToken,this._pageId,t)),m.a.instance.reportSuccess(e)}catch(t){const n=g.a.getInstance().getEventParameters(this._contextToken);throw g.a.getInstance().reportFailure(e,t,null,n),t}}}function rt(t,e,n,i,s,o,c,l){const u=e.getState(),d=a.a.tryParseOrNull(o.getId());if(s.contextTokenType===W.a.GridRow){const n=[],a=Object(tt.V)(u,t,s.parentContextToken,s.parentContextToken.controlName);return o.attributes.forEach(t=>n.push(t.getName())),i.push({name:"functionName",value:"saveEmbeddedEntity"}),e.dispatch(Object($.b)(t,o.getEntityName(),null==d?void 0:d.guid,null,n,null==a?void 0:a.guid,!1,s.parentContextToken,2))}const h=Object(r.Qb)(u,t),g=Object(r.Hb)(u,t);if(h||g)return i.push({name:"functionName",value:"saveAndCloseFormDialogAction"}),e.dispatch(Object(Q.a)(t));if(d&&!a.a.equals(d,a.a.EMPTY))return i.push({name:"functionName",value:"saveForm"}),e.dispatch(Object(H.e)(t,n));const p=Object(k.p)(e.getState(),t);return i.push({name:"functionName",value:"saveFormAndNavigate"}),e.dispatch(Object(H.f)(t,p,l,n,!1,c))}},LLfG:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return i}));var a=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const r="attribute.submitmode";function i(t,e,n,i){const s=Object(a.y)(e);return{type:r,payload:i,meta:{pageId:t,contextKey:s,dataFieldName:n}}}},"N+Ya":function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const a="navigation.item.label";function r(t,e,n,r){return{type:a,payload:{label:n,currentLanguageId:r},meta:{pageId:t,navigationItemId:e}}}},NAAR:function(t,e,n){"use strict";n.d(e,"c",(function(){return v})),n.d(e,"d",(function(){return O})),n.d(e,"w",(function(){return C})),n.d(e,"h",(function(){return j})),n.d(e,"y",(function(){return I})),n.d(e,"x",(function(){return T})),n.d(e,"q",(function(){return x})),n.d(e,"z",(function(){return A})),n.d(e,"t",(function(){return s})),n.d(e,"g",(function(){return o})),n.d(e,"k",(function(){return c})),n.d(e,"f",(function(){return l})),n.d(e,"n",(function(){return u})),n.d(e,"r",(function(){return d})),n.d(e,"o",(function(){return h})),n.d(e,"a",(function(){return g})),n.d(e,"m",(function(){return p})),n.d(e,"b",(function(){return m})),n.d(e,"j",(function(){return E})),n.d(e,"l",(function(){return b})),n.d(e,"p",(function(){return y})),n.d(e,"e",(function(){return P})),n.d(e,"v",(function(){return _})),n.d(e,"u",(function(){return N})),n.d(e,"i",(function(){return S})),n.d(e,"s",(function(){return f}));var a=n("x3V2"),r=n("Lyxw"),i=n("3/02");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const s="notescontrol",o="DashboardControl",c="OneNoteIntegration",l="Personal",u="postcomment",d="regardingrecords",h="systemusers",g="activityfileattachment",p="Posts",m=-2147164125,b="dashboard",y={PerfOrgDbOrgSettings:"EnableActivitiesTimeLinePerfImprovement",FirstStage:1,SecondStage:3},f={Account:"account",Contact:"contact",RollupModule:"Rollups",Incident:"incident",Subject:"subject",ModifiedOn:"modifiedon",OwnerId:"ownerid",CustomerId:"customerid",Description:"description",Title:"title"},v={Email:"email",Task:"task",PhoneCall:"phonecall",Appointment:"appointment",Letter:"letter",Fax:"fax",RecurringAppointment:"recurringappointmentmaster",SocialActivity:"socialactivity",CampaignActivity:"campaignactivity",OpportunityClose:"opportunityclose",OrderClose:"orderclose",QuoteClose:"quoteclose",IncidentResolution:"incidentresolution",Annotations:"annotation",User:"systemuser",OwnerId:"ownerid",ScheduledStart:"scheduledstart",ScheduleEnd:"scheduleend",Description:"description",Owner:"owner",Subject:"subject",Organizer:"organizer",ActualStart:"actualstart",ModifiedOn:"modifiedon",ModifiedBy:"modifiedby",ActualRevenue:"actualrevenue",From:"from",StatusCode:"statuscode",Notes:"annotation",UserName:"username",RegardingObjectId:"regardingobject",CreatedOn:"createdon",NoteText:"notetext",Text:"text",ActivityModule:"Activities",RollupModule:"Rollups",NotesModule:"Notes",PostsModule:"Posts",AnnotationEntity:"annotation",PostsEntity:"post",PostCommentEntity:"postcomment",ActivityPointerEntity:"activitypointer",PatternStartDate:"patternstartdate",AllParties:"allparties",PartyId:"partyid",Incident:"incident",AutoPost:"autopost",UserPost:"manualpost",CreatedBy:"createdby",FileName:"filename",FileSize:"filesize",IsDocument:"isdocument",MimeType:"mimetype"},O={letter:[v.From,v.ModifiedOn,v.Description],fax:[v.From,v.ModifiedOn,v.Description],email:[v.From,v.ModifiedOn,v.Description],task:[v.ModifiedBy,v.ModifiedOn,v.Description],phonecall:[v.From,v.ModifiedOn,v.Description],appointment:[v.Organizer,v.ScheduledStart,v.Description],RecurringAppointment:[v.OwnerId,v.PatternStartDate,v.Description],opportunityclose:[v.OwnerId,v.ModifiedOn,v.Subject,v.ActualRevenue],incidentresolution:[v.CreatedBy,v.ModifiedOn,v.Subject,v.Description],annotation:[v.ModifiedOn,v.NoteText,v.CreatedBy,v.CreatedOn,v.FileName,v.FileSize,v.IsDocument,v.MimeType,v.ModifiedBy],post:[v.CreatedBy,v.CreatedOn,v.Text],postcomment:[v.CreatedBy,v.CreatedOn,v.Text]},C={annotation:[v.NoteText,v.CreatedBy,v.CreatedOn,v.FileName,v.FileSize,v.IsDocument,v.MimeType,v.ModifiedBy],incident:[f.ModifiedOn,f.Title,f.CustomerId,f.OwnerId,f.Description]},S=["systemuser","contact","competitor","lead","account","incident","opportunity","knowledgearticle"],j={bigint:a.a.Number,boolean:a.a.Boolean,customer:Object(a.c)(),datetime:a.a.DateTime,decimal:a.a.Number,double:a.a.Number,entityname:a.a.String,integer:a.a.Number,lookup:Object(a.d)(),memo:a.a.String,money:a.a.Number,owner:Object(a.e)(),partylist:a.a.PartyList,picklist:Object(a.d)(),state:a.a.String,status:a.a.String,string:a.a.String,uniqueidentifier:a.a.UniqueIdentifier,virtual:a.a.Virtual},I={TimelineWallActivities:"TimelineWallActivities",TimelineWallNotes:"TimelineWallNotes",TimelineWallPosts:"TimelineWallPosts",TimelineWallUserPosts:"TimelineWallUserPosts",TimelineWallFilters:"TimelineWallFilters",TimelineWallWhatsChanged:"TimelineWallWhatsChanged",TimelineWall:"TimelineWall",TimelineWallNotesAnalysis:"NotesAnalysisFeature",TimelineWallPostsEnhancedMentions:"TimelineWallPostsEnhancedMentions",TimelineWallContextualEmail:"ContextualEmailExperience",TimelineWallNotesOffline:"EnableNotesOnTimelineWallInOffline",TimelineWallContexual2020Update:"ContextualTimeline2020Update",TimelineWallKeywordSearch:"TimelineWallKeywordSearch",TimelineWallAvoidDirectWebAPI:"TimelineWallAvoidDirectWebAPI",TimelineWallFilterPerfImprovements:"TimelineWallFilterPerfImprovements",TimelineWallShouldDisablePostMentionImprovements:"TimelineWallShouldDisablePostMentionImprovements",EnableUserPostsInCDS:"EnableUserPostsInCDS",TimelineWallMDLNotes:"TimelineWallMDLNotes",TimelineWallOfflineMDLAPI:"TimelineWallOfflineMDLAPI",TimelineWallUnbatchedRequests:"TimelineWallUnbatchedRequests",TimelineWallSingletonFix:"TimelineWallSingletonFix",TimelineWallMultipleInstance:"TimelineWallMultipleInstance",TimelineWallRollupRecords:"TimelineWallRollupRecords"},T={Label:"Label",UClientUniqueName:"UClientUniqueName",UClientModules:"UClientModules",UClientShowFilterPane:"UClientShowFilterPane",UClientExpandFilterPane:"UClientExpandFilterPane",UClientEnableSearch:"UClientEnableSearch",UClientActivities:"UClientActivities",UClientActivityRollupType:"UClientActivityRollupType",UClientCreateActivityUsing:"UClientCreateActivityUsing",UClientDisplayActivityUsing:"UClientDisplayActivityUsing",UClientRecordPerPage:"UClientRecordPerPage",UClientOrderBy:"UClientOrderBy",UClientSortActivitiesByValue:"UClientSortActivitiesByValue",UClientActivityCardMap:"UClientActivityCardMap",UClientDisplayActivityHeaderUsing:"UClientDisplayActivityHeaderUsing",UClientDefaultModuleForCreateExperience:"UClientDefaultModuleForCreateExperience",UClientExpandRecord:"UClientExpandRecord",UClientShowPersona:"UClientShowPersona",UClientEnableWhatsNewFilter:"UClientEnableWhatsNewFilter",UClientActivitiesConfigurationJSON:"UClientActivitiesConfigurationJSON",UClientNotesConfigurationJSON:"UClientNotesConfigurationJSON",UClientPostsConfigurationJSON:"UClientPostsConfigurationJSON",UClientDefaultFilterJSON:"UClientDefaultFilterJSON",UClientRecordSourcesJSON:"UClientRecordSourcesJSON",UClientScrollRefreshLevel:"UClientScrollRefreshLevel",UClientShowTimelineLabel:"UClientShowTimelineLabel",UClientOpenActivityUsing:"UClientOpenActivityUsing",UClientRollupCardMap:"UClientRollupCardMap",UClientRollupsConfigurationJSON:"UClientRollupsConfigurationJSON",UClientEnableConversationMode:"UClientEnableConversationMode"},x={Read:"Read",Create:"Create",Write:"Write",Delete:"Delete",Assign:"Assign",Share:"Share",Append:"Append",AppendTo:"AppendTo"},A={SortActivitiesByValueDefault:"modifiedon",Timeline:"Timeline",OrderByDefault:"descending",CreateActivityDefault:"quickcreateform",OpenActivityDefault:"mainform",DisplayActivityDefault:"defaultfields",DisplayActivityHeaderDefault:"defaultformat",PostsModule:"Posts",RollupsModule:"Rollups",UserPostsModule:"UserPosts",ActivitiesModule:"Activities",NotesModule:"Notes",ActivitiesListSupported:function(t){return[v.Task,v.Email,v.PhoneCall,v.Appointment,v.Letter,v.Fax,v.RecurringAppointment,v.SocialActivity,v.CampaignActivity,v.OpportunityClose,v.OrderClose,v.QuoteClose,v.IncidentResolution].filter(e=>{switch(e){case v.RecurringAppointment:return Object(r.f)(t,i.Cd);case v.Letter:case v.Fax:return Object(r.f)(t,i.Xd);default:return!0}})},SupportedModules:[{moduleName:"Notes",entityName:"annotation",sortByPrimary:"modifiedon"},{moduleName:"Posts",entityName:"post",sortByPrimary:"modifiedon"},{moduleName:"Activities",entityName:"activitypointer",sortByPrimary:"modifiedon",sortBySecondary:"activityid"}],DefaultModuleForCreateExperience:"Notes"},_={Hide:"Hide",Show:"Show",ShowOnHover:"ShowOnHover"},N={Hide:"Hide",AlwaysShow:"AlwaysShow",ShowOnExpand:"ShowOnExpand"};const E={Forbidden:"Forbidden"},P={PanelHeight:600,PanelWidth:840,SupportedUnifiedClientApps:["msdynce_saleshub"]}},NUHF:function(t,e,n){"use strict";n.d(e,"b",(function(){return S})),n.d(e,"a",(function(){return x}));var a=n("arV0"),r=n("jRy5"),i=n("dHD5"),s=n("LbMF"),o=n("TAgK"),c=n("Zpd/"),l=n("mIxf"),u=n("i1f0"),d=n("odYE"),h=n("D9jM"),g=n("H523"),p=n("Khp3"),m=n("YxC/"),b=n("bJSG"),y=n("quej"),f=n("ldGr"),v=n("ApeL"),O=n("P6DH"),C=n("/A0C");function S(t,e,n,i,o,c,h,g,p){return{type:"dependentFields.update.value",sync:!0,execute({dispatch:m,getState:b},y){const f=b(),v=Object(a.j)(f,t);let O,I=null;const A=Object(u.hc)(f,t,e);e.contextTokenType===r.a.RelatedEntity?(I=Object(u.W)(f,t,e.relationshipName),O=Object(u.wc)(f,{id:t},e)[e.relationshipName]):e.contextTokenType===r.a.GridRow?(I=e.entityTypeName,O=new d.a(I,e.recordId)):(I=v.entityTypeName,O=new d.a(I,v.id));const _=Object(s.e)(f,I,Object.keys(i));for(const a in i){let d=[];const b=T(i[a],_[a]);d=j(f,m,t,e,O,a,b,_);for(const a of d)if(!i.hasOwnProperty(a)){const i={},d=Object(s.a)(f,I,a),y=T(Object(u.ab)(f,t,e,A,O,a),d);if(n)x(f,t,e,d,I,b,y)||(i[a]={fieldName:a,value:d.Type.toUpperCase()===C.a.MultiSelectPickList.toUpperCase()?[]:null},m(Object(l.a)(t,i,o,c,h,g,p,e.contextTokenType===r.a.GridRow?e.parentContextToken:e)));else{const r=Object(u.ab)(f,t,e,A,O,a);i[a]=r||(d.Type.toUpperCase()===C.a.MultiSelectPickList.toUpperCase()?[]:null),m(S(t,e,n,i))}}}}}}function j(t,e,n,a,i,s,c,l){const u=l[s],d=a.contextTokenType!==r.a.GridRow?String.format(Object(m.b)(t,b.b),u.DisplayName):null,p=c||a.contextTokenType===r.a.GridRow?null:Object(f.b)(t,[d],g.a.information),y=u&&u.ChildPicklistLogicalNames?u.ChildPicklistLogicalNames:[];for(const s of y){if(c&&a.contextTokenType!==r.a.GridRow){const r=Object(h.a)(t,i.etn,s,c);e(Object(o.b)(n,a,s,r))}I(t,e,n,a,i,s,c,p)}return y}function I(t,e,n,a,s,o,l,d){if(a.contextTokenType===r.a.GridRow){Object(O.Q)(t,n,a,o)&&e(Object(v.c)(n,a,o,!l))}else{const r=Object(i.x)(a);Object(u.B)(t,n,r,o,a.relationshipName).forEach(i=>{const o=Object(u.u)(t,{id:n,controlName:i},r);o&&!o.Disabled&&(e(Object(c.b)(n,i,r,!l)),l?function(t,e,n,a,r,i){const s=Object(u.C)(t,{controlName:a,id:n},r);if(s){const t=Object.keys(s);if(t&&t.length>0)for(const o of t)if(s[o].notificationLevel===i){const t={uniqueId:o,messages:null,notificationLevel:null,actions:null};e(Object(p.b)(n,a,t,r))}}}(t,e,n,i,a,g.a.information):e(Object(p.b)(n,i,d,a)),Object(u.bd)(i)&&e(Object(y.b)(s)))})}}function T(t,e){let n=null;return e.Type===C.a.PickList&&t&&t.valueString?n=parseInt(t.valueString,10):e.Type===C.a.MultiSelectPickList&&t&&t.value&&(n=t.value.split(",")),n}function x(t,e,n,a,r,i,s){if(a&&!a.ParentPicklistLogicalName||!s)return!0;const o=Object(h.a)(t,r,a.LogicalName,i);if(o&&o.length>0){if(a.Type===C.a.PickList)return o.some(t=>t.Value===s);if(a.Type===C.a.MultiSelectPickList)return s.every(t=>o.some(e=>e.Value===t))}return!1}},NtHU:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return i}));var a=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const r="header.bodyvisible";function i(t,e,n){const i=Object(a.w)(e);return{type:r,payload:n,meta:{pageId:t,contextKey:i}}}},PbI6:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return i}));var a=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const r="tab.contentType";function i(t,e,n,i){const s=Object(a.w)(n);return{type:r,payload:i,meta:{pageId:t,tabId:e,contextKey:s}}}},S6h3:function(t,e,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function a(t,e){if(!t||!t.data||!e)return null;const n=t.data;if(!n.timelineWalls)return null;const a=n.timelineWalls[e];return a||null}function r(t,e,n){if(!t||!t.data||!e)return null;const a=t.data;if(!a.timelineWalls)return null;const r=a.timelineWalls[e];return r?r.requestStatusMap[n]?r.requestStatusMap[n].status:0:null}function i(t,e){if(!t||!t.data||!e)return{};const n=t.data;if(!n.timelineWalls)return{};const a=n.timelineWalls[e];return a&&a.entityRecentItems?a.entityRecentItems:{}}function s(t,e){if(!t||!t.data||!e)return!0;const n=t.data;if(!n.timelineWalls)return!0;const a=n.timelineWalls[e];return a?a.isMetadataRetrievalError:void 0}n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return a})),n.d(e,"c",(function(){return i})),n.d(e,"d",(function(){return s}))},SoKF:function(t,e,n){"use strict";n.d(e,"a",(function(){return x}));var a=n("+BIz"),r=n("tICD"),i=n("YxC/"),s=n("EY5k"),o=n("uNLT"),c=n("dHD5"),l=n("i1f0"),u=n("LbMF"),d=n("arV0"),h=n("odYE"),g=n("+pAH"),p=n("qpML"),m=n("Lyxw"),b=n("3/02"),y=n("dpM5"),f=n("/A0C");var v=n("1fn7"),O=n("0kGT"),C=n("5sJC"),S=n("AULO"),j=n("wL2W"),I=n("DuO/"),T=n("HhsT");function x(t,e,n){const x=[{name:"message",value:e}];return{type:"show.unsaved.changes.dialog.async",execute:({dispatch:_,getState:N},E,P)=>_(Object(s.e)(A)).then(()=>{const s=E.TraceManager.getTracer("Forms.UnsavedChangesDialog"),P=Object(O.c)(N()),{header:w,message:F,ok:k,cancel:D}=function(t,e){const n=Object(O.c)(t),a=Object(l.kd)(t,e),r=Object(i.e)(t,A);if(n)return a?{header:Object(i.c)(r,"UnSavedChanges_TitleUpdated"),message:Object(i.c)(r,"Discard_Message_Create")||"Are you sure you want to discard this new record?",ok:Object(i.c)(r,"Button_Label_Keep_Editing")||"Keep editing",cancel:Object(i.c)(r,v.b)}:{header:Object(i.c)(r,"UnSavedChanges_TitleUpdated"),message:Object(i.c)(r,"Discard_Message_Edit")||"Are you sure you want to discard your changes?",ok:Object(i.c)(r,"Button_Label_Keep_Editing")||"Keep editing",cancel:Object(i.c)(r,"Dialog_Button_DiscardChanges")};return{header:Object(i.c)(r,"UnSavedChanges_TitleUpdated"),message:Object(i.c)(r,"Web._forms.styles.FORM.crm.htc_TitleUpdated"),ok:Object(i.c)(r,"Button_Label_SaveContinue"),cancel:Object(i.c)(r,"Dialog_Button_DiscardChanges")}}(N(),t),M=Object(l.Hb)(N(),t),L=Object(l.Qb)(N(),t),R=null!=e?e:F,X=null!=n?n:w;return x.push({name:"unsavedChangesDialogMessageLabel",value:R}),Object(j.a)()&&_(Object(C.a)(S.a)),_(Object(a.a)(R,{allowNativeDialog:!0},X,t,"",k,D)).then(e=>{if(0===e.status)return _(Object(r.a)(e.pageId)).then(e=>{if(e.value.confirmed){if(P)return!1;if(null!=t){return _(M?Object(I.a)(t):L?Object(T.a)(t):Object(o.e)(t,2)).then(()=>!0).catch(t=>!1)}return!0}return"close"===e.reason&&(null!=t&&(s.info("Dispatched Cancellation for File/Image Inprogress Upload due to discard changes",x),_(function(t){return{type:"form.cancelInprogressFileImageUpload.async",execute({dispatch:e,getState:n}){const a=Object(c.j)(n(),t),r=n(),i=Object(m.f)(r,b.Od)&&Object(m.f)(r,y.l),s=Object(m.f)(r,b.Qd)&&Object(m.f)(r,y.l),o=Object(l.ib)(r,{id:t},a),v=i?Object(u.f)(r,o.EntityLogicalName,f.a.File):{},O=s?Object(u.f)(r,o.EntityLogicalName,f.a.Image):{},C=Object.assign(v,O),S=Object(l.hb)(r,t,a),j=Object(d.j)(r,t);if(Object.keys(C).length>0)for(const n in S){const a=S[n].dataFieldName;if(C[a]&&j&&j.id&&a){const n=new h.a(o.EntityLogicalName,j.id,a);e(Object(g.b)(n,a,p.b.Cancelled,t))}}return Promise.resolve()}}}(t)),Object(j.a)()&&Object(S.d)()),!0)});throw e.error})}),getFailureParameters:(t,e)=>x}}const A=["UnSavedChanges_Title","UnSavedChanges_TitleUpdated","Web._forms.styles.FORM.crm.htc_Title","Web._forms.styles.FORM.crm.htc_TitleUpdated","Dialog_Button_Ok","Button_Label_SaveContinue","Button_Label_Cancel","Dialog_Button_DiscardChanges","UnSavedChangesWarning",v.b,"Button_Label_Continue","Button_Label_Keep_Editing","Discard_Message_Edit","Discard_Message_Create"]},TAgK:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return i}));var a=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const r="attribute.options.set";function i(t,e,n,i){const s=Object(a.w)(e);return{type:r,payload:i,meta:{pageId:t,contextKey:s,dataFieldName:n}}}},Tg1Y:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return i}));var a=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const r="form.tab.selectPrevious";function i(t,e){const n=Object(a.w)(e);return{type:r,payload:null,meta:{pageId:t,contextKey:n}}}},TsER:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return i}));var a=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const r="refresh.timer";function i(t,e,n){const i=Object(a.y)(e);return{type:r,payload:null,meta:{pageId:t,contextKey:i,controlName:n}}}},UqyN:function(t,e,n){"use strict";n.d(e,"a",(function(){return Dt})),n.d(e,"b",(function(){return Mt}));var a=n("/A0C"),r=n("0nOn"),i=n("SAYH"),s=n("WPtp"),o=n("odYE"),c=n("ZIjf"),l=n("LbMF"),u=n("UJfx"),d=n("bT7G"),h=n("mlKL"),g=n("LLfG"),p=n("i1f0"),m=n("BvQu"),b=n("Sbn7"),y=n("mIxf"),f=n("1kth"),v=n("16wZ"),O=n("qshH"),C=n("dHD5"),S=n("iZ7K"),j=n("3tOH"),I=n("z5LE"),T=n("3HPu"),x=n("jTSi"),A=n("jq7Z"),_=n("fU7K"),N=n("O7zD"),E=n("504W"),P=n("5Oca");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const w="ClientApi.XrmEntityAttribute.";let F;class k{constructor(t,e,n,a,i,s){F=t,this._clientApiExecutorAttribute=new r.a(t,w,n,e),this._clientApiExecutorAttribute.addEventParameter({name:"attributeName",value:a,isEventParam:!0});const o=this._clientApiExecutorAttribute.getComponentName("constructor");a||Object(v.j)(o,"attributeName"),t||Object(v.j)(o,"store"),n||Object(v.j)(o,"pageId"),e||Object(v.j)(o,"contextToken"),s||Object(v.j)(o,"xrmFormUi"),this._attributeName=a,this._parentEntity=i,this._pageId=n,this.xrmFormUi=s,this._contextToken=e}get controls(){return this._clientApiExecutorAttribute.execute("controls",(t,e)=>{if(!this._controls){this._controls=new b.a(t);const e=Object(p.B)(F.getState(),this._pageId,this.contextToken,this._attributeName);if(e){this.xrmFormUi.getControls();const t=this.xrmFormUi.controls;for(let n=0;n<e.length;n++){const a=e[n],r=t.get(a);r&&this._controls.add(a,r)}}}return this._controls})}addOnChange(t){const e=w+"addOnChange";t||Object(v.j)(e,"handler");try{c.a.instance.reportCall(e),F.dispatch(Object(f.a)(this.contextToken,this._pageId,this.getName(),t)),c.a.instance.reportSuccess(e)}catch(t){const n=O.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"attributeName",value:this._attributeName}),O.a.getInstance().reportFailure(e,t,null,n),t}}fireOnChange(){const t=w+"fireOnChange";try{c.a.instance.reportCall(t),F.dispatch(Object(f.R)(this.contextToken,this._pageId,this.getName())),c.a.instance.reportSuccess(t)}catch(e){const n=O.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"attributeName",value:this._attributeName}),O.a.getInstance().reportFailure(t,e,null,n),e}}getAttributeType(){const t=w+"getAttributeType";try{c.a.instance.reportCall(t);const e=this.getAttrDescriptor().Type;return c.a.instance.reportSuccess(t),e}catch(e){const n=O.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"attributeName",value:this._attributeName}),O.a.getInstance().reportFailure(t,e,null,n),e}}getFormat(){return this._clientApiExecutorAttribute.execute("getFormat",()=>{const t=this.getAttrDescriptor();if(!t||!t.Format)return null;const e=t.Format.toLowerCase();let n=e;switch(this.getAttrDescriptor().Type){case a.a.String:"text"===n||"email"===n||"phone"===n||"url"===n||"tickersymbol"===n||"1"!==e&&"2"!==e||(n="textarea");break;case a.a.Integer:"duration"!==n&&(n="none");break;case a.a.Lookup:"0"===e&&(n="none");break;case a.a.Memo:"2"!==e&&"1"!==e||(n="textarea");break;default:"0"===e?n="none":void 0===n&&(n=null)}return n})}getIsDirty(){const t=w+"getIsDirty";try{c.a.instance.reportCall(t);const e=Object(p.Pb)(F.getState(),this.getPageId(),this.dataContextToken,this.getName())&&Object(d.f)(F.getState(),Object(p.hc)(F.getState(),this.getPageId(),this.dataContextToken),this.getName());return c.a.instance.reportSuccess(t),e}catch(e){const n=O.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"attributeName",value:this._attributeName}),O.a.getInstance().reportFailure(t,e,null,n),e}}getName(){return c.a.instance.reportUsage(w+"getName"),this._attributeName}getParent(){return c.a.instance.reportUsage(w+"getParent"),this._parentEntity}getRequiredLevel(){const t=w+"getRequiredLevel";try{c.a.instance.reportCall(t);const e=Object(p.xc)(F.getState(),this._pageId,this.dataContextToken,this.getName());let n;switch(e){case 2:case 1:n="required";break;case-1:case 0:n="none";break;case 3:n="recommended";break;default:Object(v.h)(t,"RequiredLevel",e)}return c.a.instance.reportSuccess(t),n}catch(e){const n=O.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"attributeName",value:this._attributeName}),O.a.getInstance().reportFailure(t,e,null,n),e}}getSubmitMode(){const t=w+"getSubmitMode";try{c.a.instance.reportCall(t);const e=Object(p.Ic)(F.getState(),this._pageId,this.contextToken,this.getName());let n;switch(e){case m.a.Dirty:n="dirty";break;case m.a.Always:n="always";break;case m.a.Never:n="never";break;default:Object(v.h)(t,"SubmitMode",e)}return c.a.instance.reportSuccess(t),n}catch(e){const n=O.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"attributeName",value:this._attributeName}),O.a.getInstance().reportFailure(t,e,null,n),e}}getUserPrivilege(){const t=w+"getUserPrivilege";try{c.a.instance.reportCall(t);let e=null;if(F.getState()&&this._parentEntity&&this._attributeName){const t=Object(u.a)(F.getState(),this._parentEntity.getEntityName(),i.a.fromExternalGuid(this._parentEntity.getId()),this._attributeName);t&&(e={canCreate:t.canCreate,canRead:t.canRead,canUpdate:t.canUpdate})}return c.a.instance.reportSuccess(t),e}catch(e){const n=O.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"attributeName",value:this._attributeName}),O.a.getInstance().reportFailure(t,e,null,n),e}}getValue(){const t=w+"getValue";try{c.a.instance.reportCall(t);const e=this.getValueInternal();let n=null;return Object(v.a)(e)||(Object(s.j)(e)?n=e.value:Object(v.k)(t,"isPlainValue","value")),c.a.instance.reportSuccess(t),n}catch(e){const n=O.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"attributeName",value:this._attributeName}),O.a.getInstance().reportFailure(t,e,null,n),e}}getRecordIdFromContextToken(){var t;return c.a.instance.reportUsage(w+"getRecordIdFromContextToken"),null===(t=this._contextToken.recordId)||void 0===t?void 0:t.guid}removeOnChange(t){const e=w+"removeOnChange";t||Object(v.j)(e,"handler");try{c.a.instance.reportCall(e),F.dispatch(Object(f.w)(this.contextToken,this._pageId,this.getName(),t)),c.a.instance.reportSuccess(e)}catch(t){const n=O.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"attributeName",value:this._attributeName}),O.a.getInstance().reportFailure(e,t,null,n),t}}setRequiredLevel(t){const e=w+"setRequiredLevel";t||Object(v.j)(e,"requiredLevel"),"none"!==t&&"recommended"!==t&&"required"!==t&&Object(v.h)(e,"RequiredLevel",t);try{let n;switch(c.a.instance.reportCall(e),t){case"none":n=0;break;case"recommended":n=3;break;case"required":n=2}F.dispatch(Object(h.b)(this._pageId,this.dataContextToken,this._attributeName,n)),c.a.instance.reportSuccess(e)}catch(t){const n=O.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"attributeName",value:this._attributeName}),O.a.getInstance().reportFailure(e,t,null,n),t}}setSubmitMode(t){const e=w+"setSubmitMode";t||Object(v.j)(e,"mode"),"dirty"!==t&&"always"!==t&&"never"!==t&&Object(v.h)(e,"SubmitMode",t);try{let n;switch(c.a.instance.reportCall(e),t){case"dirty":n=m.a.Dirty;break;case"always":n=m.a.Always;break;case"never":n=m.a.Never}F.dispatch(Object(g.b)(this._pageId,this.contextToken,this.getName(),n)),c.a.instance.reportSuccess(e)}catch(t){const n=O.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"attributeName",value:this._attributeName}),O.a.getInstance().reportFailure(e,t,null,n),t}}setValue(t){const e=w+"setValue";try{c.a.instance.reportCall(e),this.setValueInternal(t),c.a.instance.reportSuccess(e)}catch(t){const n=O.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"attributeName",value:this._attributeName}),O.a.getInstance().reportFailure(e,t,null,n),t}}setIsValid(t,e){return this._clientApiExecutorAttribute.execute("setIsValid",(n,a)=>{t?(F.dispatch(Object(T.b)(this._pageId,this._attributeName,!0,this.contextToken)),F.dispatch(Object(x.b)(this.contextToken,this._pageId,Object(N.d)(this._pageId,this._attributeName))),F.dispatch(Object(I.b)(F.getState(),this._pageId,this._attributeName,null,this.contextToken))):this._addNotification(e)})}_addNotification(t){F.dispatch(Object(T.b)(this._pageId,this._attributeName,!1,this.contextToken));const e={messages:[t],notificationLevel:j.a.error};F.dispatch(Object(I.b)(F.getState(),this._pageId,this._attributeName,e,this.contextToken))}isValid(){const t=w+"isValid";try{c.a.instance.reportCall(t);const e=this.getValueInternal(),n=this.getParent();if(n){const a=Object(S.h)(F.getState(),n.getEntityName());if(a){if((a.PrimaryIdAttribute!==this.getName()||n.getId()!==i.a.EMPTYSTRING)&&"required"===this.getRequiredLevel()&&Object(P.E)(e,F.getState(),n.getEntityName(),this.getName()))return c.a.instance.reportSuccess(t),!1}}let a=!0;return this.hasErrorNotification()?a=!1:e&&e.validationResult&&(a=e.validationResult.isValueValid),c.a.instance.reportSuccess(t),a}catch(e){const n=O.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"attributeName",value:this._attributeName}),O.a.getInstance().reportFailure(t,e,null,n),e}}hasErrorNotification(){const t=Object(C.w)(this.contextToken),e=F.getState(),n=Object(A.a)(e,this._pageId);if(n.forms&&n.forms[t]&&(n.forms[t].invalidControls||n.forms[t].invalidAttributes)){return!0===n.forms[t].invalidControls[this.getName()]||!0===n.forms[t].invalidAttributes[this.getName()]}return!1}getPageId(){return this._pageId}getAttrDescriptor(){if(this.getParent()){let t=Object(p.t)(F.getState(),this.getParent().getEntityName(),this.getName(),this._pageId,this.contextToken);return t||(t=Object(l.a)(F.getState(),this.getParent().getEntityName(),this.getName())),t}return Object(p.Wc)(F.getState(),this.getPageId(),this.getName())}getDataXmlInternal(){const t=this.getValue(),e=Object(E.a)(t)?"":Object(_.CrmXmlEncode)(t);return`<${Object(_.CrmXmlEncode)(this.getName())}>${e}</${Object(_.CrmXmlEncode)(this.getName())}>`}setValueInternal(t){const e=this.getName(),n={};n[e]={fieldName:e,value:t},F.dispatch(Object(y.a)(this._pageId,n,!1,!0,this.getParent()?this.getParent().getEntityName():null,this.getParent()?this.getParent().getId():null,Object(C.u)(this._contextToken),this.contextToken))}get parentEntityReference(){let t,e;return this.getParent()?(t=this.getParent().getEntityName(),e=this.getParent().getId()):this.contextToken.formId&&(t=this.contextToken.formId.guid),e?new o.a(t,new i.a(e)):new o.a(t)}getValueInternal(){const t=Object(p.hc)(F.getState(),this.getPageId(),this.dataContextToken);return Object(p.ab)(F.getState(),this._pageId,this._contextToken,t,this.parentEntityReference,this._attributeName,F.dispatch)}get contextToken(){return Object(C.s)(this._contextToken)}get dataContextToken(){return this._contextToken}}var D=n("6QGX");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class M extends k{getOption(t){const e="ClientApi.XrmEntityAttributeOptionSetBase.getOption";if(Object(v.a)(t))return null;const n="number"==typeof t?t:parseInt(t,10);isNaN(n)&&Object(v.k)(e,"number","value");try{c.a.instance.reportCall(e);const n=this.getAttrDescriptor().OptionSet;let a=null;for(let e=0;e<n.length;e++)n[e].Value===t&&(a={text:n[e].Label,value:n[e].Value});return c.a.instance.reportSuccess(e),a}catch(t){throw O.a.getInstance().getEventParameters(this.contextToken).push({name:"attributeName",value:this.getName()}),O.a.getInstance().reportFailure(e,t),t}}getOptions(){const t="ClientApi.XrmEntityAttributeOptionSetBase.getOptions";try{c.a.instance.reportCall(t);const e=this.getAttrDescriptor().OptionSet.map(t=>({text:t.Label,value:t.Value}));return c.a.instance.reportSuccess(t),e}catch(e){throw O.a.getInstance().getEventParameters(this.contextToken).push({name:"attributeName",value:this.getName()}),O.a.getInstance().reportFailure(t,e),e}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let L,R;class X extends M{constructor(t,e,n,a,r,i){super(t,e,n,a,r,i),L=t}getInitialValue(){const t="ClientApi.XrmEntityAttributeBoolean.getInitialValue";try{c.a.instance.reportCall(t);const e=Object(P.j)(L.getState(),this.parentEntityReference,this.getName()),n=Object(p.kd)(L.getState(),this.getPageId());let a;const r=e?parseInt(e.valueString,10):null;if(n){const t=this.getAttrDescriptor();a=(null!=r?r:t&&t.DefaultValue)?1:0}else a=r;return c.a.instance.reportSuccess(t),a}catch(e){const n=O.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),O.a.getInstance().reportFailure(t,e,null,n),e}}getValue(){const t="ClientApi.XrmEntityAttributeBoolean.getValue";try{c.a.instance.reportCall(t);const e=this.getValueInternal(),n=Object(D.a)(e);return c.a.instance.reportSuccess(t),n}catch(e){const n=O.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),O.a.getInstance().reportFailure(t,e,null,n),e}}setValue(t){const e="ClientApi.XrmEntityAttributeBoolean.setValue";Object(v.a)(t)||"boolean"!=typeof t&&Object(v.k)(e,"boolean","value");try{c.a.instance.reportCall(e),this.setValueInternal(t),c.a.instance.reportSuccess(e)}catch(t){const n=O.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),O.a.getInstance().reportFailure(e,t,null,n),t}}getAttributeType(){return c.a.instance.reportUsage("ClientApi.XrmEntityAttributeBoolean.getAttributeType"),"boolean"}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class V extends M{constructor(t,e,n,a,r,i){super(t,e,n,a,r,i),R=t}getInitialValue(){const t="ClientApi.XrmEntityAttributeMultiSelectOptionSet.getInitialValue";try{c.a.instance.reportCall(t);const e=Object(P.j)(R.getState(),this.parentEntityReference,this.getName()),n=Object(D.e)(e);return c.a.instance.reportSuccess(t),n}catch(e){const n=O.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),O.a.getInstance().reportFailure(t,e,null,n),e}}getSelectedOption(){const t="ClientApi.XrmEntityAttributeMultiSelectOptionSet.getSelectedOption";try{c.a.instance.reportCall(t);let e=null;const n=this.getValue();return n&&(e=[],n.forEach(t=>{const n=this.getOption(t);n&&e.push(n)})),c.a.instance.reportSuccess(t),e}catch(e){const n=O.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),O.a.getInstance().reportFailure(t,e,null,n),e}}getText(){const t="ClientApi.XrmEntityAttributeMultiSelectOptionSet.getText";try{c.a.instance.reportCall(t);let e=null;const n=this.getSelectedOption();return n&&(e=[],n.forEach(t=>{e.push(t.text)})),c.a.instance.reportSuccess(t),e}catch(e){const n=O.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),O.a.getInstance().reportFailure(t,e,null,n),e}}getValue(){const t="ClientApi.XrmEntityAttributeMultiSelectOptionSet.getValue";try{c.a.instance.reportCall(t);const e=this.getValueInternal();let n=null;return e&&(n=Object(D.e)(e)),c.a.instance.reportSuccess(t),n}catch(e){const n=O.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),O.a.getInstance().reportFailure(t,e,null,n),e}}getAttributeType(){return c.a.instance.reportUsage("ClientApi.XrmEntityAttributeMultiSelectOptionSet.getAttributeType"),"multiselectoptionset"}setValue(t){const e="ClientApi.XrmEntityAttributeMultiSelectOptionSet.setValue";try{c.a.instance.reportCall(e),Array.isArray(t)?this.setValueInternal(t):this.setValueInternal([]),c.a.instance.reportSuccess(e)}catch(t){const n=O.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),O.a.getInstance().reportFailure(e,t,null,n),t}}}var U=n("Xd5/"),G=n("xkcG"),B=n("MXaZ"),Y=n("Ae6N");let z;class H extends k{constructor(t,e,n,a,r,i){super(t,e,n,a,r,i),z=t}getDataXmlInternal(){let t=this.getValue();null!==t&&(t=new Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes()));const e=Object(_.CrmXmlEncode)(this.getName());let n="";return n+=`<${e}>`,n+=""+(null===t?"":Object(_.CrmXmlEncode)(t.format("s"))),n+=`</${e}>`,n}getValue(){const t="ClientApi.XrmEntityAttributeDateTime.getValue";try{c.a.instance.reportCall(t);const e=this.getValueInternal();let n=null;if(Object(s.j)(e)&&!Object(v.a)(e.formatted)){const t=this.getAttrDescriptor();n=Object(D.b)(z.getState(),t,e)}return c.a.instance.reportSuccess(t),n}catch(e){const n=O.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),O.a.getInstance().reportFailure(t,e,null,n),e}}_userSettings(){return this.xrmFormUi.formContext.context?this.xrmFormUi.formContext.context.userSettings:new G.a(z)}getUtcValue(){const t="ClientApi.XrmEntityAttributeDateTime.getUtcValue";try{c.a.instance.reportCall(t);const e=this.getValue();return c.a.instance.reportSuccess(t),e}catch(e){const n=O.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),O.a.getInstance().reportFailure(t,e,null,n),e}}setValue(t){const e="ClientApi.XrmEntityAttributeDateTime.setValue";Object(v.a)(t)||("[object Date]"!==Object.prototype.toString.call(t)||isNaN(t.getTime()))&&Object(v.k)(e,"Date","value");try{if(c.a.instance.reportCall(e),Object(v.a)(t))this.setValueInternal(t);else{let e=new Date(t.getTime());const n=new Date,a=this.getAttrDescriptor(),r=Object(U.A)(z.getState(),a),i=6e4*this._userSettings().getTimeZoneOffsetMinutes(),s=Object(B.s)(new Date(n.getFullYear(),n.getMonth(),n.getDate()),r.userSettings.timeZoneAdjusters)-Object(B.s)(t,r.userSettings.timeZoneAdjusters),o=6e4*t.getTimezoneOffset();switch(r.controlAttributes.Behavior){case Y.a.UserLocal:e=new Date(t.getTime()+o+i-s);break;default:e=new Date(t.getTime())}this.setValueInternal(e)}c.a.instance.reportSuccess(e)}catch(t){const n=O.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),O.a.getInstance().reportFailure(e,t,null,n),t}}setUtcValue(t){const e="ClientApi.XrmEntityAttributeDateTime.setUtcValue";try{c.a.instance.reportCall(e),this.setValue(t),c.a.instance.reportSuccess(e)}catch(t){const n=O.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),O.a.getInstance().reportFailure(e,t,null,n),t}}getAttributeType(){return c.a.instance.reportUsage("ClientApi.XrmEntityAttributeDateTime.getAttributeType"),"datetime"}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let q;class W extends k{constructor(t,e,n,a,r,i){super(t,e,n,a,r,i),q=t}getIsPartyList(){return c.a.instance.reportUsage("ClientApi.XrmEntityAttributeLookup.getIsPartyList"),!1}getDataXmlInternal(){const t=this.getValue();let e="";if(null!==t&&t.length>0)e+=this.getLookupDataXml(this.getName(),t[0]);else{const t=Object(_.CrmXmlEncode)(this.getName());e+=`<${t}>`,e+=`</${t}>`}return e.toString()}getLookupDataXml(t,e){const n=Object(_.CrmXmlEncode)(t);let a="<"+n;const r=this.getEntityTypeCode(e.entityType);return r>0&&(a+=` type="${Object(_.CrmXmlAttributeEncode)(r.toString())}"`),e.entityType&&(a+=` typeName="${Object(_.CrmXmlAttributeEncode)(e.entityType)}"`),Object(v.a)(e.name)||(a+=` name="${Object(_.CrmXmlAttributeEncode)(e.name)}"`),a+=`>${Object(_.CrmXmlEncode)(e.id)}</${n}>`,a}getEntityTypeCode(t){return Object(S.p)(q.getState(),t)}setValue(t){const e="ClientApi.XrmEntityAttributeLookup.setValue";let n=null;if(t&&Array.isArray(t)&&t.length>0){let a;t.length>1?Object(v.k)(e,"LookupValue[] of size not more than one.","value"):t[0].entityType?t[0].id?i.a.tryParseOrNull(t[0].id)||Object(v.h)(e,"guid",t[0].id):Object(v.j)(e,"value[0].id"):Object(v.j)(e,"value[0].entityType");try{a=Object(p.Vb)(q.getState(),this.getPageId(),this.dataContextToken,this.getName())}catch(t){const n=O.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),O.a.getInstance().reportFailure(e+".getLookupTargets",t,null,n),t}if(a&&!(a.indexOf(t[0].entityType)>-1)){const n=O.a.getInstance().getEventParameters(this.contextToken);n.push({name:"attributeName",value:this.getName()}),n.push({name:"actualValue",value:t[0].entityType}),Object(v.k)(e,"entityType","value[0].entityType",n)}try{c.a.instance.reportCall(e),a?a.indexOf(t[0].entityType)>-1&&(n=new o.a(t[0].entityType,new i.a(t[0].id),t[0].name),this.setValueInternal(n)):this.setValueInternal(n),c.a.instance.reportSuccess(e)}catch(t){const n=O.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),O.a.getInstance().reportFailure(e,t,null,n),t}}else this.setValueInternal(n)}getValue(){const t="ClientApi.XrmEntityAttributeLookup.getValue";try{c.a.instance.reportCall(t);const e=this.getValueInternal(),n=Object(D.d)(e);return c.a.instance.reportSuccess(t),n}catch(e){const n=O.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),O.a.getInstance().reportFailure(t,e,null,n),e}}getAttributeType(){return c.a.instance.reportUsage("ClientApi.XrmEntityAttributeLookup.getAttributeType"),"lookup"}}var K=n("3c9R"),Q=n("IaGr"),Z=n("arV0");let J,$;class tt extends k{constructor(t,e,n,a,i,s){super(t,e,n,a,i,s),J=t,this._clientApiExecutorAttributeNumber=new r.a(t,"ClientApi.XrmEntityAttributeNumber.",n,e,[{name:"attributeName",value:a,isEventParam:!0}])}getMax(){return this._clientApiExecutorAttributeNumber.execute("getMax",()=>this.getAttrDescriptor().MaxValue)}getMin(){return this._clientApiExecutorAttributeNumber.execute("getMin",()=>this.getAttrDescriptor().MinValue)}getPrecision(){return this._clientApiExecutorAttributeNumber.execute("getPrecision",()=>Object(p.m)(J.getState(),this.getPageId(),this.dataContextToken,this.getName()))}setPrecision(t){return this._clientApiExecutorAttributeNumber.execute("setPrecision",(e,n)=>{var a,r,i;"integer"===this.getAttributeType()&&Object(v.e)(e,"setPrecision is not valid on integer attributes",void 0,n);const s=Object(Z.j)(J.getState(),this.getPageId()),o=null!==(r=null===(a=this.getParent())||void 0===a?void 0:a.getEntityName())&&void 0!==r?r:null===(i=s)||void 0===i?void 0:i.entityTypeName,c=Object(l.a)(J.getState(),o,this.getName());(t<0||t>c.Precision)&&(n.push({name:"metadataPrecision",value:c.Precision}),Object(v.h)(e,"precision",t.toString(),n)),J.dispatch(Object(K.b)(this.getPageId(),this.dataContextToken,this.getName(),t))},[{name:"precision",value:t,isRequired:!0,expectedDataType:"number"}])}getValue(){return this._clientApiExecutorAttributeNumber.execute("getValue",()=>{const t=this.getValueInternal();return Object(D.f)(t,this.getAttributeType(),this.getPrecision())})}setValue(t){return this._clientApiExecutorAttributeNumber.execute("setValue",()=>{this.setValueInternal(t)},[{name:"value",value:t,expectedDataType:"number"}])}getAttributeType(){return this._clientApiExecutorAttributeNumber.execute("getAttributeType",(t,e)=>{const n=this.getAttrDescriptor().Type;switch(n){case a.a.Decimal:return"decimal";case a.a.Double:return"double";case a.a.Integer:return"integer";case a.a.Money:return"money";default:return e.push({name:"attributeType",value:n}),n?this._clientApiExecutorAttributeNumber.reportFailure(t,new Error("Unexpected number attribute type."),e):Q.a.getInstance().traceManager.getTracer(t).error("Number attribute type was not defined in metadata.",e),super.getAttributeType()}})}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class et extends M{constructor(t,e,n,a,r,i){super(t,e,n,a,r,i),$=t}getInitialValue(){const t="ClientApi.XrmEntityAttributeOptionSet.getInitialValue";try{c.a.instance.reportCall(t);const e=Object(P.j)($.getState(),this.parentEntityReference,this.getName());let n;if(Object(p.kd)($.getState(),this.getPageId())){const t=this.getAttrDescriptor();n=Object(D.g)(e)||t&&t.DefaultFormValue?t.DefaultFormValue:null}else n=Object(D.g)(e);return c.a.instance.reportSuccess(t),n}catch(e){const n=O.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),O.a.getInstance().reportFailure(t,e,null,n),e}}getSelectedOption(){const t="ClientApi.XrmEntityAttributeOptionSet.getSelectedOption";try{c.a.instance.reportCall(t);const e=this.getOption(this.getValue());return c.a.instance.reportSuccess(t),e}catch(e){const n=O.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),O.a.getInstance().reportFailure(t,e,null,n),e}}getText(){const t="ClientApi.XrmEntityAttributeOptionSet.getText";try{c.a.instance.reportCall(t);const e=this.getSelectedOption();let n=null;return e&&(n=e.text),c.a.instance.reportSuccess(t),n}catch(e){const n=O.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),O.a.getInstance().reportFailure(t,e,null,n),e}}getValue(){const t="ClientApi.XrmEntityAttributeOptionSet.getValue";try{c.a.instance.reportCall(t);const e=this.getValueInternal(),n=Object(D.g)(e),a=Object(v.a)(n)?Object(D.f)(e,this.getAttributeType(),0):n;return c.a.instance.reportSuccess(t),a}catch(e){const n=O.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),O.a.getInstance().reportFailure(t,e,null,n),e}}setValue(t){const e="ClientApi.XrmEntityAttributeOptionSet.setValue";t&&isNaN(t)&&Object(v.k)(e,"number","value");let n=!1;try{if(t&&this.getParent()){const e=this.getAttrDescriptor();for(const a in e.OptionSet)if(t===e.OptionSet[a].Value){n=!0;break}}else n=!0}catch(t){const n=O.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),O.a.getInstance().reportFailure(e+".getAttributeDescriptor",t,null,n),t}n||Object(v.h)(e,"OptionSetValue",t);try{c.a.instance.reportCall(e),this.setValueInternal(t),c.a.instance.reportSuccess(e)}catch(t){const n=O.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),O.a.getInstance().reportFailure(e,t,null,n),t}}getAttributeType(){return c.a.instance.reportUsage("ClientApi.XrmEntityAttributeOptionSet.getAttributeType"),"optionset"}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class nt extends k{getMaxLength(){const t="ClientApi.XrmEntityAttributeString.getMaxLength";try{c.a.instance.reportCall(t);const e=this.getAttrDescriptor().MaxLength;return c.a.instance.reportSuccess(t),e}catch(e){const n=O.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),O.a.getInstance().reportFailure(t,e,null,n),e}}getValue(){const t="ClientApi.XrmEntityAttributeString.getValue";try{c.a.instance.reportCall(t);const e=this.getValueInternal(),n=Object(D.i)(e);return c.a.instance.reportSuccess(t),n}catch(e){const n=O.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),O.a.getInstance().reportFailure(t,e,null,n),e}}setValue(t){const e="ClientApi.XrmEntityAttributeString.setValue";Object(v.a)(t)||"string"!=typeof t&&Object(v.k)(e,"string","value");try{c.a.instance.reportCall(e),this.setValueInternal(t),c.a.instance.reportSuccess(e)}catch(t){const n=O.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),O.a.getInstance().reportFailure(e,t,null,n),t}}getAttributeType(){const t="ClientApi.XrmEntityAttributeString.getAttributeType";try{let e;c.a.instance.reportCall(t);const n=this.getAttrDescriptor().Type;switch(n){case a.a.Memo:e="memo";break;case a.a.String:e="string";break;default:const r=O.a.getInstance().getEventParameters(this.contextToken);r.push({name:"attributeName",value:this.getName()}),r.push({name:"attributeType",value:n}),O.a.getInstance().reportFailure(t,new Error("Unexpected string attribute type."),null,r),e=super.getAttributeType()}return c.a.instance.reportSuccess(t),e}catch(e){const n=O.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),O.a.getInstance().reportFailure(t,e,null,n),e}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class at extends k{constructor(t,e,n,a,i,s){super(t,e,n,a,i,s),this._clientApiExecutor=new r.a(t,"ClientApi.XrmEntityAttributeUniqueIdentifier.",n,e),this._clientApiExecutor.addEventParameter({name:"attributeName",value:a,isEventParam:!0})}setValue(t){this._clientApiExecutor.execute("setValue",()=>{this.setValueInternal(i.a.tryParseOrNull(t))},[{name:"value",value:t,expectedDataType:"guid"}])}getValue(){return this._clientApiExecutor.execute("getValue",()=>{const t=this.getValueInternal();return Object(D.j)(t)})}getAttributeType(){return this._clientApiExecutor.execute("getAttributeType",()=>"string")}}var rt=n("8a7L");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let it;class st extends W{constructor(t,e,n,a,r,i){super(t,e,n,a,r,i),it=t}getDataXmlInternal(){const t=Object(_.CrmXmlEncode)(this.getName()),e=this.getValue();let n="";return n+=`<${t}>`,e.forEach(t=>{n+="<activityparty>",n+=this.getLookupDataXml("partyid",t),n+="</activityparty>"}),n+=`</${t}>`,n.toString()}setValue(t){const e="ClientApi.XrmEntityAttributePartyList.setValue",n=O.a.getInstance().getEventParameters(this.contextToken);let a;n.push({name:"attributeName",value:this.getName()}),t&&(Array.isArray(t)||Object(v.k)(e,"LookupValue[]","value",n));const r=new Array;try{a=Object(p.Vb)(it.getState(),this.getPageId(),this.dataContextToken,this.getName())}catch(t){throw O.a.getInstance().reportFailure(e+".getLookupTargets",t,null,n),t}t&&a&&(a.push("unresolvedaddress"),t.forEach(t=>{a.indexOf(t.entityType)>-1||(n.push({name:"entityType",value:t.entityType}),Object(v.e)(e,`LookupValue[] with invalid entity type. Entity type "${t.entityType}" is invalid.`,"LookupValue[] with invalid entity type",n))}));try{c.a.instance.reportCall(e),t?(a?t.forEach(t=>{a.indexOf(t.entityType)>-1&&r.push(new rt.a(t.entityType,t.id,t.name))}):t.forEach(t=>{r.push(new rt.a(t.entityType,t.id,t.name))}),this.setValueInternal(r)):this.setValueInternal([]),c.a.instance.reportSuccess(e)}catch(t){throw O.a.getInstance().reportFailure(e,t,null,n),t}}getValue(){const t="ClientApi.XrmEntityAttributePartyList.getValue";try{c.a.instance.reportCall(t);const e=this.getValueInternal(),n=Object(D.h)(e);return c.a.instance.reportSuccess(t),n}catch(e){const n=O.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),O.a.getInstance().reportFailure(t,e,null,n),e}}getIsPartyList(){return c.a.instance.reportUsage("ClientApi.XrmEntityAttributePartyList.getIsPartyList"),!0}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class ot extends k{constructor(t,e,n,a,i,s){super(t,e,n,a,i,s),this._clientApiExecutorAttributeFile=new r.a(t,"ClientApi.XrmEntityFile.",n,e,[{name:"attributeName",value:a,isEventParam:!0}])}getValue(){return this._clientApiExecutorAttributeFile.execute("getValue",()=>{const t=this.getValueInternal();return Object(D.c)(t)})}setValue(t){this._clientApiExecutorAttributeFile.execute("setValue",()=>{this.setValueInternal(t)})}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let ct;class lt extends k{constructor(t,e,n,a,r,i){super(t,e,n,a,r,i),ct=t}getValue(){const t="ClientApi.XrmEntityAttributeEntityName.getValue";try{c.a.instance.reportCall(t);const e=this.getValueInternal(),n=Object(l.a)(ct.getState(),this.getParent().getEntityName(),this.getName());let a=null;return n.IsEntityReferenceStored&&Object(s.j)(e)&&(a=e.value),c.a.instance.reportSuccess(t),a}catch(e){const n=O.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),O.a.getInstance().reportFailure(t,e,null,n),e}}setValue(t){const e="ClientApi.XrmEntityAttributeEntityName.setvalue";Object(v.a)(t)||"string"==typeof t||Object(v.k)(e,"string","value");try{c.a.instance.reportCall(e),this.setValueInternal(t),c.a.instance.reportSuccess(e)}catch(t){const n=O.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),O.a.getInstance().reportFailure(e,t,null,n),t}}getAttributeType(){return c.a.instance.reportUsage("ClientApi.XrmEntityAttributeEntityName.getAttributeType"),"entityname"}}var ut=n("aOhN"),dt=n("Pcet"),ht=n("WY/A"),gt=n("qTme"),pt=n("Dea/"),mt=n("NPZ3"),bt=n("bGh0"),yt=n("srnJ"),ft=n("Fij2"),vt=n("pF61"),Ot=n("ruPX"),Ct=n("cfbi"),St=n("P6DH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function jt(t,e,n,a){const r=Object(p.B)(t,e,n,a,n.relationshipName);if(!r||0===r.length)return!0;for(let a=0;a<r.length;a++)if(!Object(p.v)(t,{controlName:r[a],id:e},n))return!0;return!1}function It(t,e,n,a,r,i){if(!Object(St.M)(t,e,n,a,null==i?void 0:i.id))return!1;const s=Object(St.z)(t,n,e);if(!r||!s)return!1;if(s&&0===s[a])return!1;if(null===r.ParentPicklistLogicalName)return!0;const o=Object(p.hc)(t,e,n),c=Object(p.ab)(t,e,n,o,i,r.ParentPicklistLogicalName);return!(!c||!c.label)}var Tt=n("jRy5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let xt;class At extends et{constructor(t,e,n,a,r,i){super(t,e,n,a,r,i),xt=t}setValue(t){const e="ClientApi.XrmEntityAttributeDependentOptionSet.setValue";let n;try{c.a.instance.reportCall(e),n=this.contextToken.contextTokenType===Tt.a.MainGrid||this.contextToken.contextTokenType===Tt.a.SubGrid||this.contextToken.contextTokenType===Tt.a.AssociatedGrid?It(xt.getState(),this.getPageId(),this.contextToken,this.getName(),this.getAttrDescriptor(),this.parentEntityReference):jt(xt.getState(),this.getPageId(),this.contextToken,this.getName()),c.a.instance.reportSuccess(e)}catch(t){const n=O.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),O.a.getInstance().reportFailure(e,t,null,n),t}n?super.setValue(t):Object(v.e)("ClientApi.XrmEntityAttributeDependentOptionSet.setValue","Can not execute setValue for dependent option set attribute since it is disabled.")}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let _t;class Nt extends V{constructor(t,e,n,a,r,i){super(t,e,n,a,r,i),_t=t}setValue(t){const e="ClientApi.XrmEntityAttributeMultiSelectDependentOptionSet.setValue";let n;try{c.a.instance.reportCall(e),n=this.contextToken.contextTokenType===Tt.a.MainGrid||this.contextToken.contextTokenType===Tt.a.SubGrid||this.contextToken.contextTokenType===Tt.a.AssociatedGrid?It(_t.getState(),this.getPageId(),this.contextToken,this.getName(),this.getAttrDescriptor(),this.parentEntityReference):jt(_t.getState(),this.getPageId(),this.contextToken,this.getName()),c.a.instance.reportSuccess(e)}catch(t){const n=O.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),O.a.getInstance().reportFailure(e,t,null,n),t}n?super.setValue(t):Object(v.e)(e,"Can not execute setValue for dependent option set attribute since it is disabled.")}}var Et=n("3/02"),Pt=n("Lyxw"),wt=n("L8zx"),Ft=n("Exmh");let kt;class Dt{constructor(t,e,n,a,i,s,o,c){kt=t;const l=[{name:"pageId",value:n,isEventParam:!0,isRequired:!0,expectedDataType:"string"},{name:"entityType",value:i,isEventParam:!0,isRequired:!1,expectedDataType:"string"},{name:"store",value:t,isRequired:!0},{name:"contextToken",value:e,isRequired:!0},{name:"xrmForm",value:a,isRequired:!0}];this._clientApiExecutor=new r.a(t,"ClientApi.XrmEntity.",n,e,l),this._pageId=n,this._xrmForm=a,this._contextToken=e,this._entityType=i,this._entityId=s,this._getAttributeNames=o,this._applicationContext=c}get attributes(){return this._clientApiExecutor.execute("attributes",(t,e)=>{if(!this._attributes){this._attributes=new b.a(t);const n=this._getAttributeNames(this._applicationContext,this._contextToken,this._pageId);if(!n)return this._clientApiExecutor.reportFailure(t,new Error("Entity attribute names array was null or undefined"),e),this._attributes;0===n.length&&this._clientApiExecutor.reportFailure(t,new Error("Entity attribute names array was empty."),e),n.forEach(t=>{const e=Object(l.a)(kt.getState(),this.getEntityName(),t);if(e){const n=Mt(kt,this._contextToken,this._pageId,t,this,this._xrmForm.ui,e);this._attributes.add(t,n)}})}return this._attributes})}get relatedEntities(){const t="ClientApi.XrmEntity.relatedEntities";try{if(c.a.instance.reportCall(t),!this._relatedEntities){this._relatedEntities=new b.a(t);const e=Object(p.wc)(kt.getState(),{id:this._pageId},this._contextToken);for(const t in e)if(e[t]){const n=Object(C.n)(this._contextToken,t),a=new Dt(kt,n,this._pageId,this._xrmForm,e[t].etn,e[t].id,this._getAttributeNames,this._applicationContext);this._relatedEntities.add(t,a),this._updateControl(a,t)}const n=Object(p.vc)(kt.getState(),{id:this._pageId}),a={};for(const t in n){const e=n[t];a[e.referencingAttribute]||(a[e.referencingAttribute]={}),a[e.referencingAttribute][e.referencedEntity]=t}for(const t in a)kt.dispatch(Object(f.a)(this._contextToken,this._pageId,t,e=>{for(const e in a[t]){const n=this._relatedEntities.get(a[t][e]);n&&this._relatedEntities.remove(n)}const n=e.getEventSource().getValue();if(n&&n.length>0){const e=n[0],r=a[t][e.entityType],s=Object(C.n)(this._contextToken,r),o=new Dt(kt,s,this._pageId,this._xrmForm,e.entityType,i.a.tryParse(e.id),this._getAttributeNames,this._applicationContext);this._relatedEntities.add(r,o),this._updateControl(o,r)}},!0))}return c.a.instance.reportSuccess(t),this._relatedEntities}catch(e){const n=O.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityName",value:this.getEntityName()}),O.a.getInstance().reportFailure(t,e,null,n),e}}_updateControl(t,e){this._xrmForm&&this._xrmForm.ui&&this._xrmForm.ui.controls&&this._xrmForm.ui.controls.forEach(n=>{n instanceof bt.a&&n.updateAttribute(t,e)})}addOnSave(t){const e="ClientApi.XrmEntity.addOnSave";t||Object(v.j)(e,"handler");try{c.a.instance.reportCall(e),kt.dispatch(Object(f.p)(this._contextToken,this._pageId,t)),c.a.instance.reportSuccess(e)}catch(t){const n=O.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityName",value:this.getEntityName()}),O.a.getInstance().reportFailure(e,t,null,n),t}}addOnPostSave(t){const e="ClientApi.XrmEntity.addOnPostSave";t||Object(v.j)(e,"handler");try{c.a.instance.reportCall(e),kt.dispatch(Object(f.h)(this._contextToken,this._pageId,t)),c.a.instance.reportSuccess(e)}catch(t){const n=O.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityName",value:this.getEntityName()}),O.a.getInstance().reportFailure(e,t,null,n),t}}getDataXml(){const t="ClientApi.XrmEntity.getDataXml";try{c.a.instance.reportCall(t);let e="";return this.attributes.forEach(t=>{t.getIsDirty()&&(e+=t.getDataXmlInternal())}),e="<"+Object(_.CrmXmlEncode)(this.getEntityName())+">"+e+"</"+Object(_.CrmXmlEncode)(this.getEntityName())+">",c.a.instance.reportSuccess(t),e}catch(e){const n=O.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityName",value:this.getEntityName()}),O.a.getInstance().reportFailure(t,e,null,n),e}}getEntityReference(){const t="ClientApi.XrmEntity.getEntityReference";try{c.a.instance.reportCall(t);const e={entityType:this.getEntityName(),id:this.getId(),name:this.getPrimaryAttributeValue()};return c.a.instance.reportSuccess(t),e}catch(e){const n=O.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityName",value:this.getEntityName()}),O.a.getInstance().reportFailure(t,e,null,n),e}}getEntityName(){const t="ClientApi.XrmEntity.getEntityName";try{return c.a.instance.reportCall(t),c.a.instance.reportSuccess(t),this._entityType}catch(e){const n=O.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityName",value:this.getEntityName()}),O.a.getInstance().reportFailure(t,e,null,n),e}}getId(){const t="ClientApi.XrmEntity.getId";try{if(c.a.instance.reportCall(t),!this._entityId||this._entityId&&this._entityId.guid===i.a.EMPTYGUIDSTRING){const t=Object(Z.m)(kt.getState(),this._pageId);if(t&&t.value){const e=t.value;this._entityId=e.id}else{const t=Object(p.hc)(kt.getState(),this._pageId,this._contextToken);if(t){const e=Object(d.b)(kt.getState(),t);e&&e.identifier&&(this._entityId=e.identifier.id)}}}return this._entityId&&this._entityId.guid===i.a.EMPTYGUIDSTRING?(c.a.instance.reportSuccess(t),i.a.EMPTYSTRING):(c.a.instance.reportSuccess(t),i.a.externalGuid(this._entityId))}catch(e){const n=O.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityName",value:this.getEntityName()}),O.a.getInstance().reportFailure(t,e,null,n),e}}getPrimaryAttributeValue(){return this._clientApiExecutor.execute("getPrimaryAttributeValue",(t,e)=>{let n="";const a=Object(S.h)(kt.getState(),this.getEntityName());if(a){if(!a.PrimaryNameAttribute)return n="PrimaryNameAttribute was not defined",Q.a.getInstance().traceManager.getTracer(t).error(n,e),"";{const t=Object(p.hc)(kt.getState(),this._pageId,this._contextToken),e=this.getId()?new o.a(this.getEntityName(),new i.a(this.getId())):new o.a(this.getEntityName()),r=Object(p.ab)(kt.getState(),this._pageId,this._contextToken,t,e,a.PrimaryNameAttribute);if(!r)return"";if(Object(s.j)(r))return r.value;n="PrimaryAttribute value was not an IPlainValue"}}else n="Entity descriptor could not be retrieved.";return O.a.getInstance().reportFailure(t,new Error(n),null,e),""})}getIsDirty(){const t="ClientApi.XrmEntity.getIsDirty";try{c.a.instance.reportCall(t);for(let e=0;e<this.attributes.getLength();e++){const n=this.attributes.get(e);if("never"!==n.getSubmitMode()&&n.getIsDirty())return c.a.instance.reportSuccess(t),!0}for(let e=0;e<this.relatedEntities.getLength();e++){if(this.relatedEntities.get(e).getIsDirty())return c.a.instance.reportSuccess(t),!0}return c.a.instance.reportSuccess(t),!1}catch(e){const n=O.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityName",value:this.getEntityName()}),O.a.getInstance().reportFailure(t,e,null,n),e}}removeOnSave(t){const e="ClientApi.XrmEntity.removeOnSave";t||Object(v.j)(e,"handler");try{c.a.instance.reportCall(e),kt.dispatch(Object(f.L)(this._contextToken,this._pageId,t)),c.a.instance.reportSuccess(e)}catch(t){const n=O.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityName",value:this.getEntityName()}),O.a.getInstance().reportFailure(e,t,null,n),t}}removeOnPostSave(t){const e="ClientApi.XrmEntity.removeOnPostSave";t||Object(v.j)(e,"handler");try{c.a.instance.reportCall(e),kt.dispatch(Object(f.D)(this._contextToken,this._pageId,t)),c.a.instance.reportSuccess(e)}catch(t){const n=O.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityName",value:this.getEntityName()}),O.a.getInstance().reportFailure(e,t,null,n),t}}save(t){this._clientApiExecutor.executeAsync("save",(e,n)=>{let a=1;if(t)if("string"==typeof t)switch(t){case"save":a=1;break;case"saveandclose":a=2;break;case"saveandnew":a=59}else t.saveMode&&(a=t.saveMode);const r=kt.getState();return Object(wt.b)(this._pageId,kt,a,n,this._contextToken,this,!1,"saveandclose"!==t).then(e=>this._performAfterSaveLogic(r,e,t))})}isValid(){const t="ClientApi.XrmEntity.isValid";try{if(c.a.instance.reportCall(t),this.attributes)for(let e=0;e<this.attributes.getLength();e++){const n=this.attributes.get(e);if(this._attributeHasActiveControl(n)&&!n.isValid()||n.hasErrorNotification())return c.a.instance.reportSuccess(t),!1}if(this.relatedEntities)for(let e=0;e<this.relatedEntities.getLength();e++)if(!this.relatedEntities.get(e).isValid())return c.a.instance.reportSuccess(t),!1;return c.a.instance.reportSuccess(t),!0}catch(e){const n=O.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityName",value:this.getEntityName()}),O.a.getInstance().reportFailure(t,e,null,n),e}}setRecordId(t){const e="ClientApi.XrmEntity.setRecordId";t||Object(v.j)(e,"id");try{if(c.a.instance.reportCall(e),this.getId()&&this._entityId.guid!==i.a.EMPTYGUIDSTRING)c.a.instance.reportSuccess(e);else{const n=i.a.tryParse(t);i.a.isNullOrEmpty(n)&&Object(v.j)(e,"id");const a={},r=kt.getState(),s=Object(p.hc)(r,this._pageId,this._contextToken),l=Object(C.y)(this._contextToken);if(s){const t=new o.a(this.getEntityName(),n);kt.dispatch(Object(dt.b)(s,t)),c.a.instance.reportSuccess(e)}else{const t=Object(ht.b)(r,new o.a(this.getEntityName(),n),a,l,pt.a.Create),i=t.payload.snapshotId;kt.dispatch(t),kt.dispatch(Object(gt.b)(this._pageId,i,this._contextToken)).then(()=>{c.a.instance.reportSuccess(e)}).catch(t=>{const n=O.a.getInstance().getEventParameters(this._contextToken);n.push({name:"entityName",value:this.getEntityName()}),O.a.getInstance().reportFailure(e+".setDataSnapshotId",t,null,n)})}}}catch(t){const n=O.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityName",value:this.getEntityName()}),O.a.getInstance().reportFailure(e,t,null,n),t}}refresh(){const t="ClientApi.XrmEntity.refresh";try{if(c.a.instance.reportCall(t),this.getId()){const e=new o.a(this.getEntityName(),new i.a(this.getId())),n=[],a=[];for(let t=0;t<this.attributes.getLength();t++)a.push(this.attributes.get(t).getName());const r=Object(mt.a)(kt.getState(),e.etn);if(r&&a.push(...r),n.push(kt.dispatch(Object(yt.a)(this._pageId,e,a,new Ft.a(o.a.toLegacyEntityReference(e),null,null)))),this.relatedEntities)for(let t=0;t<this.relatedEntities.getLength();t++)n.push(this.relatedEntities.get(t).refresh());return Promise.all(n).then(()=>{Object(ft.b)(this),c.a.instance.reportSuccess(t)}).catch(e=>{const n=O.a.getInstance().getEventParameters(this._contextToken);return n.push({name:"entityName",value:this.getEntityName()}),Object(v.d)(kt,e,t,n)})}return c.a.instance.reportSuccess(t),Promise.resolve(null)}catch(e){const n=O.a.getInstance().getEventParameters(this._contextToken);return n.push({name:"entityName",value:this.getEntityName()}),Object(v.d)(kt,e,t,n)}}getRecordIdFromContextToken(){var t;return c.a.instance.reportUsage("ClientApi.XrmEntity.getRecordIdFromContextToken"),null===(t=this._contextToken.recordId)||void 0===t?void 0:t.guid}_attributeHasActiveControl(t){if(t&&t.controls){const e=t.controls.getLength();for(let n=0;n<e;n++)if(!t.controls.get(n).getDisabled())return!0}return!1}_performAfterSaveLogic(t,e,n){const a=Object(p.nb)(kt.getState(),{id:this._pageId},this._contextToken);if((e||!this.getIsDirty()||a)&&!Object(p.Hb)(kt.getState(),this._pageId))if(Object(ft.b)(this),"saveandclose"===n){if(!Object(ft.a)(Object(vt.b)(kt.getState())===this._pageId)){const e=Object(p.Qb)(t,this._pageId),n=Object(p.Ob)(t,this._pageId);if(!e&&!n)return kt.dispatch(Object(ut.b)(this._pageId))}}else if("saveandnew"===n){const t={entityTypeName:this.getEntityName()};return kt.dispatch(Object(Ot.a)(Ct.b,t,this._pageId))}return Promise.resolve()}}function Mt(t,e,n,r,i,s,o){let c=null,u=!1;switch(o.Type){case a.a.DateTime:c=new H(t,e,n,r,i,s);break;case a.a.Decimal:case a.a.Double:case a.a.Integer:case a.a.Money:c=new tt(t,e,n,r,i,s);break;case a.a.Lookup:case a.a.Owner:case a.a.Customer:c=new W(t,e,n,r,i,s);break;case a.a.PartyList:c=new st(t,e,n,r,i,s);break;case a.a.Memo:case a.a.String:c=new nt(t,e,n,r,i,s);break;case a.a.PickList:if(u=Object(Pt.f)(t.getState(),Et.pb),u&&Object(l.m)(t.getState(),o.EntityLogicalName,r)){c=new At(t,e,n,r,i,s);break}case a.a.OptionSet:case a.a.State:case a.a.Status:c=new et(t,e,n,r,i,s);break;case a.a.Boolean:c=new X(t,e,n,r,i,s);break;case a.a.EntityName:c=new lt(t,e,n,r,i,s);break;case a.a.UniqueIdentifier:c=new at(t,e,n,r,i,s);break;case a.a.MultiSelectPickList:u=Object(Pt.f)(t.getState(),Et.pb),c=u&&Object(l.m)(t.getState(),o.EntityLogicalName,r)?new Nt(t,e,n,r,i,s):new V(t,e,n,r,i,s);break;case a.a.File:c=new ot(t,e,n,r,i,s);break;default:c=new k(t,e,n,r,i,s)}return c}},Utin:function(t,e,n){"use strict";n.d(e,"b",(function(){return s})),n.d(e,"a",(function(){return i}));var a=n("dHD5"),r=n("BFlg");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i="control.update.parameter";function s(t,e,n,s,o){return{type:"control.update.parameter.async",execute({dispatch:c,getState:l},u){const d=r.N+".updateControlParameterAction";c(function(t,e,n,s,o){const c=Object(a.w)(o);return{type:i,payload:{name:n,value:s},meta:{pageId:t,dataSetContextKey:c,controlName:r.w}}}(t,0,n,s,o));const h=[];return h.push({name:"controlName",value:e}),h.push({name:"paramName",value:""+n}),u.EventManager.ReportComponentSuccess(d,h),Promise.resolve()}}}},UuJw:function(t,e,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var a;n.d(e,"a",(function(){return a})),function(t){t.crossEntity="crossEntity",t.invalid="invalid",t.unreachable="unreachable",t.dirtyForm="dirtyForm",t.invalidProcess="invalidProcess",t.preventDefault="preventDefault"}(a||(a={}))},"WK+4":function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return s}));var a=n("dHD5"),r=n("BFlg");const i="chart.visualizationid.update";function s(t,e,n){return{type:"chart.visualizationid.update.async",execute({dispatch:s,getState:o},c){const l=c.TraceManager.getTracer(r.P),u=r.N+".updateVisualizationIdAction";try{l.info("Updating the chart visualization id"),e||(e=Object(a.l)(o(),t));const r=Object(a.w)(e);return s(function(t,e,n){return{type:i,payload:{name:"VisualizationId",value:n},meta:{pageId:t,dataSetContextKey:e}}}(t,r,n)),c.EventManager.ReportComponentSuccess(u),Promise.resolve()}catch(t){const e="Updatation of the chart visualization id failed with error : "+t.message;c.EventManager.ReportComponentFailure(u,Error(e))}}}}},ZJsz:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const a={queryKey:null,pageNumber:1,isNewPageRequested:!1,selectedRows:[],selectedRelatedEntity:null,filters:{},rowProperties:{records:[]},fetchXml:"",fetchXmlColumns:[],controls:{},refreshCounter:0,pagingRefreshInput:0,pagingData:"",relationshipName:null,relationshipRoleOrdinal:null,showChart:null,isChartOnTheRightSide:!1,useRollupView:!1,chartVisualizationType:null,dependentOptionSetColumnStatus:{},chartDrillDownParameters:[]}},ZUzm:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var a=n("cfbi"),r=n("ruPX");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function i(t,e,n,i,s,o,c,l,u){const d={entityTypeName:t.etn,id:t.id,formId:n,data:i,processId:s,processInstanceId:o,selectedStageId:c,isCrossEntityNavigate:l,recordSetQueryKey:u};return Object(r.a)(a.b,d,e)}},ZXdP:function(t,e,n){"use strict";n.d(e,"a",(function(){return u})),n.d(e,"c",(function(){return d})),n.d(e,"b",(function(){return p}));var a=n("i1f0"),r=n("nC8a"),i=n("uNLT"),s=n("E8F2"),o=n("9wSR"),c=n("/q/W"),l=n("KXSk");function u(t,e){const n=[];return{type:"configure.save.async",sync:!0,execute({dispatch:r,getState:u},d,m){const b=p(u(),t);g(n,b,m),b&&r(h(t,e)),Object(l.a)(t)||d.Router.registerPreNavigationHandler(l=>new Promise(h=>{Object(o.g)(t);const g={id:t};Object(a.Kb)(l,g,e)||!Object(a.Ub)(l,g.id,e)||Object(a.Hb)(u(),t)?h(!0):b&&!Object(a.kd)(l,t)?r(Object(i.e)(t,2,!1,null,"This save action is triggered automatically because a page navigation is requested when the form is dirty.")).then(e=>{h(!!e||r(Object(c.a)(t)))},e=>{Object(s.h)(u(),t,e,n,d,"Forms.ConfigureSave.Navigate.Save"),h(r(Object(c.a)(t)))}):h(r(Object(c.a)(t)))}),t)},getFailureParameters:(t,e)=>(Object(s.a)(t,n),n)}}function d(t,e){return{type:"configure.save.async",sync:!0,execute({dispatch:n,getState:a},r,i){p(a(),t)&&(n(Object(o.g)(t)),n(h(t,e)))}}}function h(t,e){let n=[];return{type:"configure.save.async",sync:!0,execute({dispatch:r,getState:c},l,u){o.f[t]=setTimeout((function d(){if(Object(a.Ub)(c(),t,e)&&!Object(a.pb)(c(),{id:t},e)){const e=r(Object(i.c)(t));e&&e.then(t=>{},e=>{!function(t){return t&&(2200000004===t.errorCode||2200000005===t.errorCode||2200000006===t.errorCode||2200000007===t.errorCode)}(e)?r(Object(o.e)(t)):r(Object(o.g)(t));const i=Object(a.ad)(c());n=[],g(n,i,u),Object(s.h)(c(),t,e,n,l,"Forms.ConfigureSave.AutoSave")})}o.f[t]=setTimeout(d,Object(a.n)(c(),t))}),Object(a.n)(c(),t))}}}function g(t,e,n){t.push({name:"CorrelationId",value:n.correlationId},{name:"ContextId",value:n.contextId},{name:"ActionStack",value:n.stack},{name:"autoSaveEnabled",value:e})}function p(t,e){return Object(a.ad)(t)&&!Object(r.a)(t,e)&&!Object(a.Hb)(t,e)}},Zw8F:function(t,e,n){"use strict";n.d(e,"a",(function(){return p}));var a=n("SAYH"),r=n("qshH"),i=n("arV0"),s=n("16wZ"),o=n("ZIjf"),c=n("rs6x"),l=n("7TDv"),u=n("+Ljw"),d=n("0nOn"),h=n("+6s6");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
let g;class p{constructor(t,e,n,a){this._id=t,this._label=e,g=n,this._pageId=a,this.clientApiExecutor=new d.a(g,h.b,a)}getId(){const t=h.b+"getId";try{o.a.instance.reportCall(t);const e=a.a.toString(this._id);return o.a.instance.reportSuccess(t),e}catch(e){throw r.a.getInstance().reportFailure(t,e),e}}getLabel(){return o.a.instance.reportUsage(h.b+"getLabel"),this._label}getPageId(){return o.a.instance.reportUsage(h.b+"getPageId"),this._pageId}setVisible(t){this.clientApiExecutor.execute("setVisible",()=>{g.dispatch(Object(l.b)(this._pageId,a.a.toString(this._id),t))},[{name:"form",value:{id:a.a.toString(this._id),label:this._label},isClientAPICheckerParam:!0},{name:"visible",value:t?"true - this API call will show the form in form selector":"false - this API call will hide the form in form selector",isClientAPICheckerParam:!0}],!0,!0)}getVisible(){const t=h.b+"getVisible";try{o.a.instance.reportCall(t);const e=Object(u.c)(g.getState(),this._pageId,this._id);return o.a.instance.reportSuccess(t),e}catch(e){throw r.a.getInstance().reportFailure(t,e),e}}navigate(){const t=h.b+"navigate";try{this._pageId||Object(s.j)(t,"PageId"),o.a.instance.reportCall(t);const e=Object(i.j)(g.getState(),this._pageId),n=e&&e.id?e.id.guid:"",a=Object(i.p)(g.getState(),this._pageId);g.dispatch(Object(c.a)(this._id.guid,this._pageId,a,n)).then(()=>{o.a.instance.reportSuccess(t)}).catch(e=>Object(s.d)(g,e,t+".changeForm"))}catch(e){throw r.a.getInstance().reportFailure(t,e),e}}}},a8GW:function(t,e,n){"use strict";n.d(e,"d",(function(){return i})),n.d(e,"i",(function(){return s})),n.d(e,"a",(function(){return o})),n.d(e,"f",(function(){return c})),n.d(e,"e",(function(){return l})),n.d(e,"h",(function(){return u})),n.d(e,"c",(function(){return d})),n.d(e,"b",(function(){return h})),n.d(e,"g",(function(){return g}));var a=n("blB4"),r=n("UuJw");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class i extends Error{constructor(t){super(t),this.navigationStatus=a.a.invalid,this.stageInvalidReason=r.a.invalid,Object.setPrototypeOf(this,i.prototype)}}Error;class s extends Error{constructor(t){super(t),this.stageInvalidReason=r.a.unreachable,Object.setPrototypeOf(this,s.prototype)}}class o extends Error{constructor(t){super(t),this.navigationStatus=a.a.dirtyForm,this.stageInvalidReason=r.a.dirtyForm,Object.setPrototypeOf(this,o.prototype)}}class c extends Error{constructor(t){super(t),this.navigationStatus=a.a.end,Object.setPrototypeOf(this,c.prototype)}}class l extends Error{constructor(t){super(t),this.navigationStatus=a.a.beginning,Object.setPrototypeOf(this,l.prototype)}}class u extends Error{constructor(t){super(t),this.navigationStatus=a.a.stageGate,Object.setPrototypeOf(this,u.prototype)}}class d extends Error{constructor(t){super(t),this.navigationStatus=a.a.invalidProcess,this.stageInvalidReason=r.a.invalidProcess,Object.setPrototypeOf(this,d.prototype)}}class h extends Error{constructor(t){super(t),this.navigationStatus=a.a.dirtyForm,this.stageInvalidReason=r.a.dirtyForm,Object.setPrototypeOf(this,h.prototype)}}class g extends Error{constructor(t){super(t),this.stageInvalidReason=r.a.preventDefault,Object.setPrototypeOf(this,g.prototype)}}},bGh0:function(t,e,n){"use strict";n.d(e,"a",(function(){return v}));var a=n("PUjk"),r=n("HcnX"),i=n("odYE"),s=n("Khp3");class o{constructor(t,e,n,a){this.eventName="BusinessRuleRecommendation_"+t,this.eventParameters=[{name:"EntityTypeName",value:e},{name:"FieldName",value:n},{name:"Title",value:a}]}}var c=n("qshH"),l=n("16wZ"),u=n("i1f0"),d=n("LbMF"),h=n("Qn2w"),g=n("SAYH"),p=n("uhZ3"),m=n("IaGr");var b=n("ZIjf"),y=n("fh2P");let f;class v extends r.a{constructor(t,e,n,a,r,i){super(t,e,n,a,r,i),this._entityAttribute=null,f=t,this.registerObserversForControlStateChange()}getAttribute(){const t="ClientApi.XrmDataControl.getAttribute";try{if(b.a.instance.reportCall(t),!this._entityAttribute){let t;if(this.formContext&&this.formContext.data&&this.formContext.data.entity&&(t=this.controlDescriptor&&this.controlDescriptor.Relationship?this.formContext.data.entity.relatedEntities.get(this.controlDescriptor.Relationship):this.formContext.data.entity),this.controlDescriptor&&this.controlDescriptor.DataFieldName&&this.formContext&&this.formContext.data)if(this.controlDescriptor.IsUnbound)this._entityAttribute=this.formContext.data.attributes.get(this.controlDescriptor.DataFieldName);else{const e=t?t.attributes:this.formContext.data.attributes;this._entityAttribute=e.get(this.controlDescriptor.DataFieldName)}}return b.a.instance.reportSuccess(t),this._entityAttribute}catch(e){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(t,e,null,n),e}}updateAttribute(t,e){const n="ClientApi.XrmDataControl.updateAttribute";try{if(b.a.instance.reportCall(n),t&&e&&this.controlDescriptor&&this.controlDescriptor.Relationship===e){this._entityAttribute=null;const e=t.attributes;e&&(this._entityAttribute=e.get(this.controlDescriptor.DataFieldName))}this._entityAttribute&&this._entityAttribute.controls.add(this.name,this),b.a.instance.reportSuccess(n)}catch(t){const e=c.a.getInstance().getEventParameters(this.contextToken);throw e.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(n,t,null,e),t}}addNotification(t){const e="ClientApi.XrmDataControl.addNotification";try{if(b.a.instance.reportCall(e),this._isValidNotification(t)&&this.getVisible()){const n={uniqueId:t.uniqueId?t.uniqueId:"",messages:t.messages,notificationLevel:t.notificationLevel,actions:t.actions};return"RECOMMENDATION"===t.notificationLevel?this._reportAddNotificationEvent(t):f.dispatch(Object(h.b)(this.pageId,this.getName(),!1,this.contextToken)),f.dispatch(Object(s.b)(this.pageId,this.getName(),n,this.contextToken)),b.a.instance.reportSuccess(e),!0}return b.a.instance.reportSuccess(e),!1}catch(t){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(e,t,null,n),t}}_clearControlNotification(t){const e=Object(u.C)(f.getState(),{controlName:this.name,id:this.pageId},this.contextToken);if(e){const n=Object.keys(e);let a=null;if(t){if(a=e[t],!(a&&a.messages&&a.notificationLevel))return!1;this._clearNotification(a)}else(Object(l.a)(t)||0===t.trim().length)&&n.forEach(t=>{a=e[t],this._clearNotification(a)});return!0}return!1}_clearNotification(t){t.actions=null,t.messages=null,t.notificationLevel=null,f.dispatch(Object(s.b)(this.pageId,this.name,t,this.contextToken))}clearNotification(t){const e="ClientApi.XrmDataControl.clearNotification";try{b.a.instance.reportCall(e);const n=!!this._clearControlNotification(t);return b.a.instance.reportSuccess(e),n}catch(t){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(e,t,null,n),t}}setNotification(t,e){const n="ClientApi.XrmDataControl.setNotification";try{b.a.instance.reportCall(n);const a={uniqueId:e,messages:[t],priority:0,notificationLevel:"ERROR",actions:[{actions:[function(){}],message:""}]};return b.a.instance.reportSuccess(n),this.addNotification(a)}catch(t){const e=c.a.getInstance().getEventParameters(this.contextToken);throw e.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(n,t,null,e),t}}_isValidNotification(t){return!(!t||!t.messages||Object(p.b)(t.messages[0]))&&("RECOMMENDATION"===t.notificationLevel||"ERROR"===t.notificationLevel)}_reportAddNotificationEvent(t){if(!this._isValidNotification(t))return;const e=t.messages[0],n=new o("Added",this.contextToken.entityTypeName,this.getName(),e);var a;f.dispatch((a=n,{type:"report.xrm.event",execute(t,e){try{c.a.getInstance().reportEvent(a)}catch(t){const e="ClientApi.ReportXrmEventAction.reportXrmEvent";m.a.getInstance().eventManager.ReportComponentFailure(e,t),Object(l.j)(e,"XrmReporting")}return Promise.resolve()}}))}getEntityReference(){const t=this.formContext.entityReference,e=t.id?new g.a(t.id):null;return new i.a(t.entityType,e)}registerObserversForControlStateChange(){if(this.getName().startsWith(y.b)){const t=Object(a.a)(this.pageId);t&&this.controlStateObservable.registerObserver(t)}}getAttrDescriptor(t,e,n){const a=this.getEntityReference().etn;let r=Object(u.t)(f.getState(),a,this.name,this.pageId,this.contextToken);return r||(this.controlDescriptor?this.controlDescriptor.DataFieldName?(m.a.getInstance().traceManager.getTracer(t).warn("ControlAttributeDescriptor was not found, falling back to the attribute descriptor.",e),r=Object(d.a)(f.getState(),a,this.controlDescriptor.DataFieldName),r||(e.push({name:"attributeName",value:this.controlDescriptor.DataFieldName}),e.push({name:"entityName",value:a}),n.reportFailure(t,new Error("Attribute descriptor was not found"),e))):n.reportFailure(t,new Error("Control descriptor did not have a DataFieldName"),e):n.reportFailure(t,new Error("Control descriptor was not found"),e)),r}}},blB4:function(t,e,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var a;n.d(e,"a",(function(){return a})),function(t){t.success="success",t.crossEntity="crossEntity",t.beginning="beginning",t.end="end",t.invalid="invalid",t.dirtyForm="dirtyForm",t.stageGate="stageGate",t.invalidProcess="invalidProcess"}(a||(a={}))},bq0x:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var a=n("i1f0");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function r(t,e){const n=Object(a.gc)(t,e);return n&&n.output?n.output.value:null}},bvqZ:function(t,e,n){"use strict";n.r(e),n.d(e,"addToastNotification",(function(){return o}));var a=n("f+LF"),r=n("DsuF"),i=n("ScZZ");async function s(t,e){const a=function(t){let e;switch(t.level){case 1:e=r.b.Success;break;case 2:e=r.b.Error;break;case 3:e=r.b.Warning;break;case 4:e=r.b.Info;break;default:e=r.b.Info}const n={actions:t.action&&[{title:t.action.actionLabel,data:{action:"primary",dismiss:!0}}],hideCloseButton:!1===t.showCloseButton,createdOnAgo:""},a={id:t.id,title:t.title,body:t.message,data:JSON.stringify(n),priority:r.c.Normal,iconType:e,toastType:r.d.Timed,createdOn:(new Date).toISOString()},i={};return i.primary=t.action&&t.action.eventHandler,i.close=t.onCloseHandler,{appNotification:a,actionHandlers:i}}(e),i=a.appNotification.id,s={};s[i]=a.appNotification;const o=await n.e(92).then(n.bind(null,"Sz0D")),c=await n.e(92).then(n.bind(null,"Y5kq"));t(o.addAppNotifications(s)),t(c.addNotificationToastsV2(i,a.actionHandlers))}function o(t){const e=[];return{type:"add.toastNotification.async",execute({dispatch:n,getState:r}){switch(e.push({name:"type",value:t.type}),e.push({name:"level",value:t.level}),e.push({name:"hasTitle",value:!!t.title}),e.push({name:"hasAction",value:!!t.action}),e.push({name:"hasOnCloseHandler",value:!!t.onCloseHandler}),e.push({name:"hasImageSrc",value:!!t.imageSrc}),e.push({name:"showCloseButton",value:!1!==t.showCloseButton}),t.level){case 1:case 2:case 3:case 4:break;default:return Promise.reject(new Error(`Notification Level ${t.level} is not supported`))}const o=Object(a.j)(r());if(e.push({name:"isAppNotificationEnabled",value:o}),o)return s(n,t);const c={type:i.a,payload:{props:t}};return Promise.resolve(n(c))},getFailureParameters:(t,n)=>e,getSuccessParameters:(t,n,a)=>e}}},cf3Y:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return i}));var a=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const r="attribute.format";function i(t,e,n,i){const s=Object(a.y)(e);return{type:r,payload:i,meta:{pageId:t,contextKey:s,dataFieldName:n}}}},dIqG:function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const a="navigation.item.visibility";function r(t,e,n){return{type:a,payload:{show:n},meta:{pageId:t,navigationItemId:e}}}},dQnL:function(t,e,n){"use strict";n.d(e,"a",(function(){return S}));var a=n("SAYH"),r=n("eXjw"),i=n("95wm"),s=n("CngE"),o=n("haag"),c=n("BzGi"),l=n("K7RF"),u=n("Nb1E"),d=n("odYE"),h=n("2XFH"),g=n("Uv1Y"),p=n("Tezb"),m=n("/oKV"),b=n("iJGp"),y=n("g03H"),f=n("3/02"),v=n("Lyxw"),O=n("69Qu"),C=n("37s6");function S(t,e=c.a.savedvisualization,n){const h=[];return h.push({name:o.f,value:t}),h.push({name:o.i,value:e}),h.push({name:o.h,value:a.a.toString(n)}),{type:"chart.retrieve.async",execute({dispatch:p,getState:y},O){try{const C=y();let S=P(C);const j=O.TraceManager.getTracer(o.d),T=O.DataSource;let _=n;if(j.info(o.d+"entityTypeName:"+t+"visualizationType:"+e+"visualizationId:"+n),!t){const t="entityTypeName is null";return O.EventManager.ReportComponentFailure(i.f+".retrieveChart",Error(t),o.d,h),Promise.reject(t)}a.a.isNullOrEmpty(_)&&(_=Object(s.j)(C,t));const w=Object(v.f)(y(),f.Q);if(!a.a.isNullOrEmpty(_)){const n=Object(s.f)(C,_),a=Object(s.g)(C,_),y=()=>{const n=Object(s.a)(C,_),a=function(t,e,n,a){const r=c.a[n],i=Object(s.i)(t,e);return i&&i.chartTypes&&i.chartTypes[r]&&i.chartTypes[r][a.guid]}(C,t,e,_),r=a&&!a.IsUserChart;switch(Object(l.d)(C,r,n,()=>a)){case 1:S=m.a.Remote;break;case 2:p(function(t,e,n){const a=[];return a.push({name:"entityTypeName",value:e}),a.push({name:"visualizationType",value:n}),{type:"chartselector.retrieve.async",execute({dispatch:t,getState:r},s){try{const a=P(r());return t(Object(l.b)(c.a[n],null,e,null,!0,b.a.OnDemandWithContext,null,null,[],null,a)).catch(g.b)}catch(t){throw s.EventManager.ReportComponentFailure(i.f+"._retrieveChartSelector",Error(t),o.e,a),t}}}}(0,t,e))}};if(n===r.a.Initialized){if(y(),S!==m.a.LocalAndRemote)return x(p,T,t,_,e,S,O,h);if(w&&a===r.a.Uninitialized){const t=new d.a(e===c.a.savedvisualization?"savedqueryvisualization":"userqueryvisualization",_),n=Object(s.a)(C,_);return p(I(_,r.a.Initialized)),p(Object(u.d)(t)).catch(g.b).then(t=>(A(n,t),p(N(t)),O.EventManager.ReportComponentSuccess(i.f+".retrieveChartOData"),_),t=>(E(p,t,_.guid,n,O,h),_))}return Promise.resolve(_)}return x(p,T,t,_,e,S,O,h)}return x(p,T,t,_,e,S,O,h)}catch(t){throw O.EventManager.ReportComponentFailure(i.f+".retrieveChart",Error(t),o.d,h),t}}}}function j(t){return{type:"chart.dependencies.update.async",execute({dispatch:e,getState:n},r){const i=[];for(const e in t)i.push(t[e]+":name");if(i.length>0){return e(Object(h.a)(i)).then(()=>{const r=new Map,i=n();for(const e in t){const n=t[e],o=Object(s.a)(i,new a.a(n));o&&n&&i.metadata.labels&&i.metadata.labels[n]&&i.metadata.labels[n].name&&(o.Name=i.metadata.labels[n].name,r.set(n,o))}r.size>0&&e(function(t){const e={};t.forEach((t,n)=>{e[n]=t});return{type:"chart.descriptor.update",payload:{charts:e}}}(r))},g.b)}return Promise.resolve()}}}function I(t,e){const n=a.a.isNullOrEmpty(t)?null:{charts:{[a.a.toString(t)]:{initialized:e,oDataInitialized:r.a.Initializing}}};return{type:p.f,payload:n}}function T(t,e,n,s=c.a.savedvisualization,h){const p=[];return p.push({name:o.f,value:e}),p.push({name:o.i,value:s}),p.push({name:o.h,value:a.a.toString(n)}),{type:"chart.retrieve.async",execute:({dispatch:t,getState:o},m)=>Object(v.f)(o(),f.Q)?n?function(t,e,n,s,o,h,p){const m=new d.a(s===c.a.savedvisualization?"savedqueryvisualization":"userqueryvisualization",n);return t(I(n,r.a.Initializing)),Promise.all([t(Object(l.b)(c.a[s],null,e,a.a.toLegacyGuid(n),!0,b.a.OnDemandWithContext,null,null,[],null,o)).catch(g.b),t(Object(u.d)(m)).catch(g.c)]).then(e=>(e[1].constructor===g.a?E(t,e[1],n.guid,e[0].charts[n.guid],h,p):(A(e[0].charts[n.guid],e[1]),t(N(e[1])),h.EventManager.ReportComponentSuccess(i.f+".retrieveChartOData")),e[0]))}(t,e,n,s,h,m,p):function(t,e,n,s,o,h,p){return t(Object(l.b)(c.a[s],null,e,a.a.toLegacyGuid(n),!0,b.a.OnDemandWithContext,null,null,[],null,o)).catch(g.b).then(e=>{const n=new a.a(Object.keys(e.charts)[0]),o=new d.a(s===c.a.savedvisualization?"savedqueryvisualization":"userqueryvisualization",n);return t(I(n,r.a.Initializing)),t(Object(u.d)(o)).catch(g.b).then(a=>(A(e.charts[n.guid],a),t(N(a)),h.EventManager.ReportComponentSuccess(i.f+".retrieveChartOData"),e),a=>(E(t,a,n.guid,e.charts[n.guid],h,p),e))})}(t,e,n,s,h,m,p):function(t,e,n,r,i){return t(Object(l.b)(c.a[r],null,e,a.a.toLegacyGuid(n),!0,b.a.OnDemandWithContext,null,null,[],null,i)).catch(g.b)}(t,e,n,s,h)}}function x(t,e,n,s,c,l,u,d){return t(function(t){const e=a.a.isNullOrEmpty(t)?null:{charts:{[a.a.toString(t)]:{initialized:r.a.Initializing}}};return{type:p.b,payload:e}}(s)),t(T(0,n,s,c,l)).then(e=>{e&&e.chartSelectors&&!e.chartSelectors[n]&&(e.chartSelectors[n]={initialized:r.a.Initialized,chartTypes:{}});const o=[];for(const t in e.charts)o.push(t);return t(j(o)).then(()=>(t(_(e)),a.a.isNullOrEmpty(s)&&(s=e.chartDefaults[n]),u.EventManager.ReportComponentSuccess(i.f+".retrieveChart"),s),g.b)},e=>{const c=e&&!Object(y.l)(e.errorCode)&&e.errorCode,l={chartSelectors:{[n]:{initialized:r.a.Initialized,chartTypes:{}}}};if(t(_(l)),Object(y.l)(c))return u.EventManager.ReportComponentFailure(i.f+".retrieveChart",Error(e),o.d,d),Object(g.b)(e);{const e={charts:{[a.a.toString(s)]:{initialized:r.a.Error,errorCode:c}}};t(_(e))}})}function A(t,e){t.PresentationDescription=e.presentationdescription.replace(/(\r\n\s*)/g,""),t.oDataInitialized=r.a.Initialized}function _(t){return{type:p.b,payload:t}}function N(t){return{type:p.f,payload:t}}function E(t,e,n,a,s,c){t(N({charts:{[n]:{initialized:a.initialized,oDataInitialized:r.a.Error}}})),s.EventManager.ReportComponentFailure(i.f+".retrieveChartOData",Error(e),o.c,c)}function P(t){return Object(C.E)(t)&&(Object(O.b)(t)||Object(O.c)(t))?m.a.Remote:m.a.LocalAndRemote}},dyr5:function(t,e,n){"use strict";n.d(e,"e",(function(){return l})),n.d(e,"a",(function(){return u})),n.d(e,"c",(function(){return h})),n.d(e,"b",(function(){return g})),n.d(e,"d",(function(){return d}));var a=n("NAAR"),r=n("NjDY"),i=n("Lyxw"),s=n("69Qu"),o=n("37s6"),c=n("zDpi");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function l(t,e,n,r,i=null){const s=e.XrmObject;let o=null!=i?i:"",c="NA",l="NA",u=!0;try{t&&t.reason&&(t.reason.get_textStatus()===a.j.Forbidden&&(u=!1),c=null!=t.reason.get_organizationServiceFault().get_innerFault().get_callStack()?t.reason.get_organizationServiceFault().get_innerFault().get_callStack():"NA",l=null!=t.reason.get_textStatus()?t.reason.get_textStatus():"NA",o=null!=t.reason.get_message()?t.reason.get_message():t.reason.get_organizationServiceFault().get_messages().get_Items().toString())}catch(t){o=t.message}try{u&&s&&s.Reporting&&s.Reporting.reportFailure(n,{name:"error",message:o},"",[{name:"Action",value:r},{name:"StackTrace",value:c},{name:"Status",value:l}])}catch(t){}}function u(t,e){const n=Object(r.D)(t);return!!n.enableActivitiesTimeLinePerfImprovement&&(n.enableActivitiesTimeLinePerfImprovement&e)===e}function d(t,e){const n=Object(c.b)(e.Parameters[a.x.UClientRollupsConfigurationJSON]);if(n&&Object(i.f)(t,a.y.TimelineWallRollupRecords)){const t=Object.keys(n);for(let e=0;e<t.length;e++){const a=t[e];if(a&&n[a]&&n[a].isEnabled)return!0}}return!1}function h(t){return!(Object(o.E)(t)?Object(s.b)(t):Object(s.c)(t))&&Object(i.e)(t,a.y.TimelineWallNotesOffline)}function g(t){return Object(i.f)(t,a.y.TimelineWallKeywordSearch)}},fKWG:function(t,e,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var a;n.d(e,"a",(function(){return a})),function(t){t[t.DAY=0]="DAY",t[t.WEEK=1]="WEEK",t[t.MONTH=2]="MONTH",t[t.QUARTER=3]="QUARTER",t[t.YEAR=4]="YEAR",t[t.FISCAL_PERIOD=5]="FISCAL_PERIOD",t[t.FISCAL_YEAR=6]="FISCAL_YEAR"}(a||(a={}))},fREn:function(t,e,n){"use strict";n.d(e,"a",(function(){return c})),n.d(e,"b",(function(){return u}));var a=n("eXjw"),r=n("dHD5"),i=n("37s6"),s=n("a8zb"),o=n("BoVI");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function c(t,e,n,i,s,c,u,d){const h=Object(r.w)(s),g=function(t,e){if(!t)return null;const n=new DOMParser,a=t?n.parseFromString(t,"text/xml"):null;if(!a)return null;const r=a.documentElement?a.documentElement.children?a.documentElement.children:a.documentElement.childNodes:void 0;if(!r)return null;const i=r,s=[];for(let t=0;t<i.length;t++){if(!i[t].getAttribute)continue;const a=i[t]?i[t].children?i[t].children:i[t].childNodes:void 0,r=[];let o=null;for(let t=0;t<a.length;t++){const i=a[t];if(!i.getAttribute)continue;const s=i.getAttribute("name");let c;({relatedEntityName:c,fetchXmlDocument:o}=l(s,o,n,e)),r.push({name:s,width:parseInt(i.getAttribute("width"),10),relatedEntityName:c,disableMetaDataBinding:"1"===i.getAttribute("disableMetaDataBinding"),labelId:i.getAttribute("labelId"),isHidden:"1"===i.getAttribute("isHidden"),disableSorting:"1"===i.getAttribute("disableSorting"),addedBy:i.getAttribute("addedBy"),desc:i.getAttribute("desc"),cellType:i.getAttribute("cellType"),imageProviderWebresource:i.getAttribute("imageProviderWebresource"),imageProviderFunctionName:i.getAttribute("imageProviderFunctionName")})}const c={name:i[t].getAttribute("name"),id:i[t].getAttribute("id"),cells:r,multiObjectIdField:i[t].getAttribute("multiObjectIdField"),layoutStyle:i[t].getAttribute("multiObjectIdField")};s.push(c)}return{name:a.documentElement.getAttribute("name"),object:parseInt(a.documentElement.getAttribute("object"),10),rows:s,customControlDescriptions:null,jump:a.documentElement.getAttribute("jump"),select:"1"===a.documentElement.getAttribute("select"),icon:"1"===a.documentElement.getAttribute("icon"),preview:"1"===a.documentElement.getAttribute("preview"),iconRenderer:null}}(d,u),p={initialized:a.a.Initialized,viewId:n,fetchXML:u,entityLogicalName:i,title:c,layoutXML:d,grid:g,isCustomView:!0};return{type:o.a,payload:{views:{[n.guid]:p}},meta:{pageId:t,controlName:e,contextKey:h}}}function l(t,e,n,a){let r="";if(t.indexOf(".")>0){const i=t.split(".")[0];e||(e=n.parseFromString(a,"text/xml"));const s=e.querySelector('link-entity[alias="'+i+'"]');s&&(r=s.getAttribute("name")||"")}return{relatedEntityName:r,fetchXmlDocument:e}}function u(t){return{type:o.f,execute:(e,n)=>(Object(i.D)(e.getState())?s.a.createSqlfromFetchXMLAsync(e,t.fetchXML):Promise.resolve(null)).then(e=>t.offlineSqlQuery=e)}}},hA8P:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return i}));var a=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const r="control.mrudisabled";function i(t,e,n,i,s){const o=Object(a.w)(i);return{type:r,payload:s,meta:{pageId:e,controlName:n,contextKey:o}}}},"hQd/":function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));class a{constructor(t){this._value=null,this._value=t}get value(){return this._value}set value(t){this._value=t}}},hSDL:function(t,e,n){"use strict";n.d(e,"e",(function(){return s})),n.d(e,"b",(function(){return o})),n.d(e,"f",(function(){return c})),n.d(e,"g",(function(){return l})),n.d(e,"d",(function(){return u})),n.d(e,"c",(function(){return h})),n.d(e,"a",(function(){return d})),n.d(e,"l",(function(){return m})),n.d(e,"i",(function(){return b})),n.d(e,"m",(function(){return y})),n.d(e,"n",(function(){return f})),n.d(e,"k",(function(){return v})),n.d(e,"h",(function(){return O})),n.d(e,"o",(function(){return p})),n.d(e,"j",(function(){return C}));var a=n("dHD5"),r=n("BFlg"),i=n("504W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const s="grid.applyFilter",o="grid.applyActivityTypeFilter",c="grid.applyJumpBarFilter",l="grid.applyQuickFindFilter",u="grid.applyFilterCurrentValue",d="grid.applyActivityTypeFilterCurrentValue",h="grid.applyAdvancedFindFilter";function g(t,e,n,i){return{type:"grid.applyFilter.async",execute({dispatch:s},o){const c=o.TraceManager.getTracer(r.P),l=r.N+".applyGridFilterAction",u=Object(a.w)(i),d=[];d.push({name:r.v,value:t}),d.push({name:r.j,value:u});try{return c.info("Applying the filter expression to the grid. "),s(function(t,e,n,a){return{type:t,payload:e,meta:{pageId:n,dataSetContextKey:a}}}(t,e,n,u)),o.EventManager.ReportComponentSuccess(l,d),Promise.resolve()}catch(t){const e="Applying the filter expression to the grid failed ";o.EventManager.ReportComponentFailure(l,Error(e),"",d)}}}}function p(t,e,n){const r=Object(a.w)(n);return{type:c,payload:t,meta:{pageId:e,dataSetContextKey:r}}}const m=(t,e,n)=>g(s,t,e,n),b=(t,e,n)=>g(o,t,e,n),y=(t,e,n)=>g(c,t,e,n),f=(t,e,n)=>g(l,Object(i.a)(t)?t:t.trim(),e,n),v=(t,e,n)=>g(u,t,e,n),O=(t,e,n)=>g(d,t,e,n),C=(t,e,n)=>g(h,t,e,n)},hTZE:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var a=n("dHD5"),r=n("i1f0"),i=n("Bj/n"),s=n("3tOH"),o=n("O7zD");function c(t){return{type:"cancel.quickCreateFormAction.async",sync:!0,execute({dispatch:e,getState:n},c){const l=n(),u=Object(a.j)(l,t),d=Object(r.Fb)(l,t,u);if(d&&Object.keys(d).length>0){for(const n in d){const a=d[n].label,r=d[n].errorMessage,c=e(Object(i.b)(a,r));e(Object(i.c)(u,t,c,s.a.error,Object(o.d)(t,n),void 0,void 0,n))}return!1}return!0}}}},haag:function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"g",(function(){return r})),n.d(e,"h",(function(){return i})),n.d(e,"f",(function(){return s})),n.d(e,"i",(function(){return o})),n.d(e,"d",(function(){return c})),n.d(e,"e",(function(){return l})),n.d(e,"b",(function(){return u})),n.d(e,"c",(function(){return d}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const a="Chart.Component",r="ViewId",i="visualizationId",s="entity Type",o="chart visualization type",c="RETRIEVECHART",l="RETRIEVECHARTTS_RETRIEVECHARTSELECTOR",u="RETRIEVECHARTTS_RETRIEVECHARTDATA",d="RETRIEVECHARTTS_RETRIEVECHARTODATA"},hwt8:function(t,e,n){"use strict";n.d(e,"e",(function(){return g})),n.d(e,"f",(function(){return d})),n.d(e,"d",(function(){return h})),n.d(e,"a",(function(){return m})),n.d(e,"g",(function(){return b})),n.d(e,"c",(function(){return l})),n.d(e,"b",(function(){return u}));var a=n("lcrw"),r=n("zh0k"),i=n("Xd5/");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const s=/(.*)(((0|#),)?(0|#)+,*(\.(0|#)+)?)(.*)/,o=/(((0|#),)?(0|#)+,*(\.(0|#)+)?)/,c=/^(c|C|d|D|f|F|n|N|p|P)\d*$/;function l(t,e,n,a){return n?d(n)?Object(r.b)(t,n,e):h(n)?m(t,b(n),e):void 0:a&&Object(i.D)(a)?("money"===a.controlAttributes.Type&&(a.controlAttributes.Type="float",a.controlAttributes.Precision=e.numberFormat.CurrencyDecimalDigits),Object(i.y)(t,a)):t.toString()}function u(t,e,n){return isNaN(t.valueOf())?"":Object(a.a)(t,n,e)}function d(t){return c.test(t)}function h(t){return s.test(t)}function g(t){if(h(t)){const{prefix:e,suffix:n}=y(t);return e.indexOf("%")>=0&&p(e).isSingleQuoted||n.indexOf("%")>=0&&p(n).isSingleQuoted}return!1}function p(t){if(!t)return{isSingleQuoted:!1};let[e,n]=[0,t.length-1];for(;e<n;)if(" "!==t.charAt(e)){if(" "!==t.charAt(n)){if("'"===t.charAt(e)&&"'"===t.charAt(n)){return{isSingleQuoted:!0,stripQuote:t.slice(0,e)+t.slice(e+1,n)+t.slice(n+1)}}break}n--}else e++;return{isSingleQuoted:!1}}function m(t,e,n){if(!e||!n)return t.toString();let a=e.positiveValueFormat;if(t<0&&e.negativeValueFormat?a=e.negativeValueFormat:0===t&&e.zeroValueFormat&&(a=e.zeroValueFormat),!a||!n)return t.toString();t*=Math.pow(10,a.numberScalingFactor);let i=Object(r.a)(Math.abs(t),a.decimalPrecision,n.numberFormat.NumberGroupSizes,n.numberFormat.NumberGroupSeparator,n.numberFormat.NumberDecimalSeparator);return 0==+i&&(a=e.zeroValueFormat?e.zeroValueFormat:a,i="0",0===a.minNumberOfIntegerDigits&&(i="")),a.integerZeroPlaceHolder&&a.minNumberOfIntegerDigits&&(i=function(t,e,n,a){const[i,s]=t.split(a);return null==s?Object(r.c)(i,e,!0):Object(r.c)(i,e,!0)+a+s}(""+i,a.minNumberOfIntegerDigits,0,n.numberFormat.NumberDecimalSeparator)),i=function(t,e,n,a){const r=t.indexOf(a),i=-1===r?0:t.length-r-1;let s=0;if(n)e-i>0&&(-1===r&&(t+=a),t+="0".repeat(e-i));else{for(let e=0;e<i&&"0"===t.charAt(t.length-1-e);e++)s++;t.charAt(t.length-s-1)===a&&s++}return t.substring(0,t.length-s)}(i,a.decimalPrecision,a.decimalZeroPlaceholder,n.numberFormat.NumberDecimalSeparator),t<0&&a.addNegativeSymbol&&(i=n.numberFormat.NegativeSign+i),a.prefix+i+a.suffix}function b(t){if(!t||!h(t))return null;const e=t.split(";"),n={};return n.positiveValueFormat=f(e[0]),n.negativeValueFormat=f(e[1]),n.negativeValueFormat&&(n.negativeValueFormat.addNegativeSymbol=!1),n.zeroValueFormat=f(e[2]),n}function y(t){let[e,n]=t.replace(o,";").split(";");return e=e&&"#"!==e.trim()&&"0"!==e.trim()?e:"",n=n&&"#"!==n.trim()&&"0"!==n.trim()?n:"",{prefix:e,suffix:n}}function f(t){if(null==t)return null;let e=!1,n=0,a=!1,r=0,i=0,s=!1;const{prefix:o,suffix:c}=y(t);o&&(t=t.substring(o.length)),c&&(t=t.substring(0,t.length-c.length));let l=!1,u=0,d=!1,h=!1;for(let r=0;r<t.length;r++){switch(t.charAt(r)){case"0":l||h&&(h=!1,u=0,e=!0),u++,d=!0;break;case"#":l?u++:h&&(h=!1,u=0,e=!0);break;case",":h=!0;break;case".":n=u,a=d,l=!0,d=!1,u=0;break;default:continue}0!==u&&l?(i=u,s=d):0!==u&&(n=u,a=d)}r=0;let g=t;l&&(g=t.split(/\.(.+)/)[0]);for(let t=g.length-1;t>0&&","===g.charAt(t);t--)r+=-3;const{isSingleQuoted:m,stripQuote:b}=p(o);r+=m?0:2*(o.split("%").length-1);const{isSingleQuoted:f,stripQuote:v}=p(c);return r+=f?0:2*(c.split("%").length-1),{decimalPrecision:i,decimalZeroPlaceholder:s,useGroup:e,minNumberOfIntegerDigits:n,integerZeroPlaceHolder:a,numberScalingFactor:r,prefix:b||o,suffix:v||c,addNegativeSymbol:!0}}},iOrn:function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return s}));var a=n("dHD5"),r=n("BFlg");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i="grid.setCustomFilter";function s(t,e,n,s,o){return{type:"grid.setCustomFilter.async",execute({dispatch:c,getState:l},u){const d=u.TraceManager.getTracer(r.P),h=r.N+".setCustomFilterAction";try{return d.info("Adding a custom filter for the grid. "),c(function(t,e,n,r,s){let o=null;if(null!=t){o={customFilterXml:t,source:e,timeStamp:s||null}}const c=Object(a.z)(r),l=Object(a.w)(r);return{type:i,payload:o,meta:{pageId:n,contextKey:c,dataSetContextKey:l}}}(t,e,n,s,o)),u.EventManager.ReportComponentSuccess(h),Promise.resolve()}catch(t){const e="Adding a custom filter for the grid failed";u.EventManager.ReportComponentFailure(h,Error(e))}}}}},iTMV:function(t,e,n){"use strict";n.d(e,"c",(function(){return i})),n.d(e,"b",(function(){return c})),n.d(e,"a",(function(){return l}));var a=n("WPtp");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let r={};function i(t){var e;for(const n in t){const a={"Control Name":n,"Control Value":s(t[n]),"Source of the default value":t[n].source,"Call stack if applicable":null!==(e=t[n].callStack)&&void 0!==e?e:"N/A"};r[n]?(r[n].push(a),o(n)):r[n]=[a]}}function s(t){var e;const n=Object(a.g)(t.value)?null===(e=t.value)||void 0===e?void 0:e.name:t.value,r=Object(a.c)(n);return void 0!==r?r:null}function o(t){var e;const n=null===(e=r[t])||void 0===e?void 0:e.length;2===n?(r[t][0]["Update Sequence"]=1,r[t][1]["Update Sequence"]=2):r[t][n-1]["Update Sequence"]=n}function c(){return r}function l(){r={}}},j2fa:function(t,e,n){"use strict";n.d(e,"b",(function(){return jt})),n.d(e,"d",(function(){return It})),n.d(e,"e",(function(){return Tt})),n.d(e,"c",(function(){return xt})),n.d(e,"a",(function(){return At}));var a=n("Wgxh"),r=n("SAYH"),i=n("eXjw"),s=n("95wm");var o=n("fKWG");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var c=n("odYE"),l=n("+QYJ"),u=n("MXaZ");function d(t,e){return new Date(t,e,0).getDate()}class h{constructor(){this._dataPointAggregators=new Array(0),this._dataPointDateTimeRangeAggregatorInfoMap=new Map,this._dataPointFiscalPeriodAggregators=new Array(0),this._dataPointFiscalYearAggregators=new Array(0)}addAggregator(t,e,n,a,i){if(n>=o.a.DAY&&n<o.a.FISCAL_PERIOD)this._addDateTimeRangeAggregatorInfo(t,e,n,a,i);else if(n===o.a.FISCAL_PERIOD)this._addDataPointFiscalPeriodAggregator(t,e,a,i);else if(n===o.a.FISCAL_YEAR)this._addDataPointFiscalYearAggregator(t,e,a,i);else{const n=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(t){return{FieldName:t&&t.FieldName||null,EntityName:t&&t.EntityName||null,LinkEntityExpressionArray:t&&t.LinkEntityExpressionArray||null,Value:t&&t.Value||null,DisplayName:t&&t.DisplayName||null,EntityLogicalName:t&&t.EntityLogicalName||null}}();if(n.FieldName=t,n.EntityName=a,n.LinkEntityExpressionArray=i,Object(l.c)(e))n.Value=null;else if(e instanceof c.a){const t=e;n.Value=t.id.guid,n.DisplayName=t.name,n.EntityLogicalName=t.etn}else e instanceof r.a?n.Value=r.a.toString(e):n.Value=e.toString();this._dataPointAggregators.push(n)}}_addDataPointFiscalPeriodAggregator(t,e,n,a){const r=function(t){return{FieldName:t&&t.FieldName||null,EntityName:t&&t.EntityName||null,LinkEntityExpressionArray:t&&t.LinkEntityExpressionArray||null,FiscalType:t&&t.FiscalType||null,Year:t&&t.Year||0,Period:t&&t.Period||0}}();if(r.FiscalType="in-fiscal-period-and-year",r.FieldName=t,r.EntityName=n,r.LinkEntityExpressionArray=a,!e)return void this._dataPointFiscalPeriodAggregators.push(r);if("string"!=typeof e)throw new Error("value should be string");if(e.indexOf("-")<=0)throw new Error("value should have xxxx-yy format");const i=e.split("-");r.Year=Number(i[0]),r.Period=Number(i[1]),this._dataPointFiscalPeriodAggregators.push(r)}_addDataPointFiscalYearAggregator(t,e,n,a){const r=function(t){return{FieldName:t&&t.FieldName||null,EntityName:t&&t.EntityName||null,LinkEntityExpressionArray:t&&t.LinkEntityExpressionArray||null,FiscalType:t&&t.FiscalType||null,Year:t&&t.Year||0}}();if(r.FiscalType="in-fiscal-year",r.FieldName=t,r.EntityName=n,r.LinkEntityExpressionArray=a,e){if("number"!=typeof e)throw new Error("value should be number");r.Year=Number(e),this._dataPointFiscalYearAggregators.push(r)}else this._dataPointFiscalYearAggregators.push(r)}_addDateTimeRangeAggregatorInfo(t,e,n,a,r){let i=null;switch(this._dataPointDateTimeRangeAggregatorInfoMap.has(t)?i=this._dataPointDateTimeRangeAggregatorInfoMap.get(t):(i=function(t){return{dateTimeAggregatorDay:(null==t?void 0:t.dateTimeAggregatorDay)||null,dateTimeAggregatorWeek:(null==t?void 0:t.dateTimeAggregatorWeek)||null,dateTimeAggregatorMonth:(null==t?void 0:t.dateTimeAggregatorMonth)||null,dateTimeAggregatorYear:(null==t?void 0:t.dateTimeAggregatorYear)||null,dateTimeAggregatorFieldName:(null==t?void 0:t.dateTimeAggregatorFieldName)||null,dateTimeAggregatorEntityName:(null==t?void 0:t.dateTimeAggregatorEntityName)||null,dateTimeAggregatorLinkEntityExpressionArr:(null==t?void 0:t.dateTimeAggregatorLinkEntityExpressionArr)||null,dateTimeAggregatorPrecision:(null==t?void 0:t.dateTimeAggregatorPrecision)||o.a.YEAR}}({dateTimeAggregatorFieldName:t}),this._dataPointDateTimeRangeAggregatorInfoMap.set(t,i)),i.dateTimeAggregatorEntityName||(i.dateTimeAggregatorEntityName=a),i.dateTimeAggregatorLinkEntityExpressionArr||(i.dateTimeAggregatorLinkEntityExpressionArr=r),n){case o.a.DAY:i.dateTimeAggregatorDay=Number(e);break;case o.a.WEEK:i.dateTimeAggregatorWeek=Number(e);break;case o.a.MONTH:i.dateTimeAggregatorMonth=Number(e);break;case o.a.QUARTER:i.dateTimeAggregatorMonth=3*Number(e);break;case o.a.YEAR:i.dateTimeAggregatorYear=Number(e);break;default:throw new Error("DateTime Group type not supported")}i.dateTimeAggregatorPrecision=Math.min(n,i.dateTimeAggregatorPrecision)}_getDataPointDateTimeRangeAggregators(t,e){const n=new Array(0);return 0===this._dataPointDateTimeRangeAggregatorInfoMap.size||this._dataPointDateTimeRangeAggregatorInfoMap.forEach((a,r)=>{const i={FieldName:(null==s?void 0:s.FieldName)||null,EntityName:(null==s?void 0:s.EntityName)||null,LinkEntityExpressionArray:(null==s?void 0:s.LinkEntityExpressionArray)||null,MinDate:(null==s?void 0:s.MinDate)||null,MaxDate:(null==s?void 0:s.MaxDate)||null};var s;if(i.FieldName=a.dateTimeAggregatorFieldName,i.EntityName=a.dateTimeAggregatorEntityName,i.LinkEntityExpressionArray=a.dateTimeAggregatorLinkEntityExpressionArr,a.dateTimeAggregatorYear){switch(a.dateTimeAggregatorMonth=a.dateTimeAggregatorMonth?a.dateTimeAggregatorMonth:12,a.dateTimeAggregatorDay=a.dateTimeAggregatorDay?a.dateTimeAggregatorDay:d(a.dateTimeAggregatorYear,a.dateTimeAggregatorMonth),i.MaxDate=new Date(a.dateTimeAggregatorYear,a.dateTimeAggregatorMonth-1,a.dateTimeAggregatorDay),a.dateTimeAggregatorPrecision){case o.a.DAY:g(i.MaxDate),i.MinDate=new Date(i.MaxDate.getFullYear(),i.MaxDate.getMonth(),i.MaxDate.getDate());break;case o.a.WEEK:{e===u.e.FirstFullWeekOfTheYear&&(e=u.e.FirstDayOfTheYear);let n=Object(u.w)(a.dateTimeAggregatorYear,a.dateTimeAggregatorWeek,t,e),r=Object(u.w)(a.dateTimeAggregatorYear,a.dateTimeAggregatorWeek+1,t,e);if(r.setDate(r.getDate()-1),e===u.e.FirstDayOfTheYear){if(r>=new Date(a.dateTimeAggregatorYear+1,0,1))r=new Date(a.dateTimeAggregatorYear+1,0,0);else if(1===a.dateTimeAggregatorWeek){const t=new Date(a.dateTimeAggregatorYear,0,1);n<t&&(n=t)}}i.MinDate=n,i.MaxDate=r,g(i.MaxDate),g(i.MinDate);break}case o.a.MONTH:i.MinDate=new Date(i.MaxDate.getFullYear(),i.MaxDate.getMonth()-1,d(a.dateTimeAggregatorYear,i.MaxDate.getMonth())+1),g(i.MaxDate),g(i.MinDate);break;case o.a.QUARTER:i.MinDate=new Date(i.MaxDate.getFullYear(),i.MaxDate.getMonth()-3,d(a.dateTimeAggregatorYear,i.MaxDate.getMonth()-2)+1),g(i.MaxDate),g(i.MinDate);break;case o.a.YEAR:g(i.MaxDate),i.MinDate=new Date(i.MaxDate.getFullYear()-1,i.MaxDate.getMonth(),i.MaxDate.getDate()+1);break;default:throw new Error("DateTime Group type not supported")}n.push(i)}else n.push(i)}),n}getAggregators(t,e){let n=this._dataPointAggregators;const a=this._getDataPointDateTimeRangeAggregators(t,e);return a&&a.length>0&&(n=n.concat(a)),this._dataPointFiscalPeriodAggregators&&this._dataPointFiscalPeriodAggregators.length>0&&(n=n.concat(this._dataPointFiscalPeriodAggregators)),this._dataPointFiscalYearAggregators&&this._dataPointFiscalYearAggregators.length>0&&(n=n.concat(this._dataPointFiscalYearAggregators)),n}}function g(t){t.getTimezoneOffset()<0&&t.setDate(t.getDate()+1)}var p=n("YxC/"),m=n("GEBM"),b=n("IqkD"),y=n("Xd5/"),f=n("nfCs"),v=n("/A0C"),O=n("NjDY"),C=n("LbMF"),S=n("S70w"),j=n("Ae6N");function I(t,e){const n=Object(C.a)(t,e.entity.entityName,e.attributeName);let a=n?n.DisplayName:null;a||(a=e.attributeName);let r=a;if(e.dateTimeGrouping){const n=f.c(e.dateTimeGrouping.groupingType).replace("-","").toUpperCase();r=String.format(Object(p.b)(t,m.c),Object(p.b)(t,`${m.c}.${n.toUpperCase()}`),a)}else e.hasAggregate&&e.aggregateType&&(r=String.format(Object(p.b)(t,m.d),Object(p.b)(t,`${m.d}.${e.aggregateType.toUpperCase()}`),a));if(n&&n.Type===v.a.Money){let a="",i=null;const s=Object(O.D)(t);n.IsBaseCurrency?s&&s.baseCurrencyId&&s.transactionCurrencyById&&(i=s.transactionCurrencyById[s.baseCurrencyId.guid]):e.hasAggregate&&(i=Object(b.b)(t)),i&&(a=s&&s.currencyDisplayOption===S.a.CurrencyCode?i.currencyCode:i.currencySymbol),a&&(r=String.format(Object(p.b)(t,m.b),r,a))}return r}function T(t,e,n){return n>0?String.format(Object(p.b)(t,m.x),n,e):String.format(Object(p.b)(t,m.v),e)}function x(t,e,n,a,r){const i=r<1&&a>=1&&n<1,s=r<1&&a<1&&n>=1,o=a<1&&n<1;if(r>=1&&a<1&&n>=1){const a=new Date(e,n-1,r),{formatInfoCultureName:i,numberFormatInfo:s,dateFormatInfo:o}=Object(b.x)(t),c=new Sys.CultureInfo(i,s,o);return Object(y.r)(a,c,j.a.None)}return i?String.format(Object(p.b)(t,m.y),a,e):s?String.format("{0} {1}",function(t){const e=Object(p.b)(t,m.e).split(",");if(!e||12!==e.length)throw new Error("Expect 12 months! Actual: "+e.length);return e}(t)[n-1],e):o?String(e):""}function A(t){return Object(p.b)(t,m.u)}var _=n("WPtp"),N=n("16wZ");function E(t,e,n){let a=!1;n&&n.groupAttribute&&n.groupAttribute.dateTimeGrouping&&(a=!0);return{attribute:e,primaryGroupBy:n,aliasName:e.aliasName||e.attributeName,state:t,isDateTimeChart:a}}function P(t,e){let n=t.isDateTimeChart?function(t,e){if(!e.fields||!Object(_.c)(e.fields[t.aliasName]))return"";switch(t.attribute.dateTimeGrouping.groupingType){case o.a.DAY:return function(t,e){const n=Object(_.e)(e.fields[t.aliasName]),a=Object(_.e)(e.fields[t.primaryGroupBy.extendedGroupBys[0].aliasName]),r=Object(_.e)(e.fields[t.primaryGroupBy.extendedGroupBys[1].aliasName]);return x(t.state,r,a,-1,n)}(t,e);case o.a.WEEK:return function(t,e){const n=Object(_.e)(e.fields[t.aliasName]),a=Object(_.e)(e.fields[t.primaryGroupBy.extendedGroupBys[0].aliasName]);return x(t.state,a,-1,n,-1)}(t,e);case o.a.MONTH:return function(t,e){const n=Object(_.e)(e.fields[t.aliasName]),a=Object(_.e)(e.fields[t.primaryGroupBy.extendedGroupBys[0].aliasName]);return x(t.state,a,n,-1,-1)}(t,e);case o.a.QUARTER:return function(t,e){const n=Object(_.e)(e.fields[t.aliasName]),a=Object(_.e)(e.fields[t.primaryGroupBy.extendedGroupBys[0].aliasName]);return T(t.state,a,n)}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(t,e);case o.a.FISCAL_PERIOD:return function(t,e){return Object(_.e)(e.fields[t.aliasName])}(t,e);case o.a.YEAR:return function(t,e){const n=Object(_.e)(e.fields[t.aliasName]);return x(t.state,n,-1,-1,-1)}(t,e);case o.a.FISCAL_YEAR:return function(t,e){const n=Object(_.e)(e.fields[t.aliasName]);return T(t.state,n,-1)}(t,e);default:return Object(_.c)(e.fields[t.attribute.attributeName])}}(t,e):null;return n||(n=Object(_.c)(e.fields[t.aliasName]),n=n||""),0===n.length?Object(p.b)(t.state,m.u):n}function w(t,e){if(!t.attribute||!Object(C.a)(t.state,t.attribute.entity.entityName,t.attribute.attributeName))return P(t,e);switch(Object(C.a)(t.state,t.attribute.entity.entityName,t.attribute.attributeName).Type){case v.a.PickList:case v.a.Status:case v.a.State:case v.a.Boolean:{let n=Object(_.e)(e.fields[t.aliasName]);return n=Object(N.a)(n)?-1:Number(n),n}case v.a.DateTime:return function(t,e){let n=-1,a=-1,r=-1;switch(t.attribute.dateTimeGrouping.groupingType){case o.a.DAY:n=Object(_.e)(e.fields[t.aliasName]),a=Object(_.e)(e.fields[t.primaryGroupBy.extendedGroupBys[0].aliasName]),r=Object(_.e)(e.fields[t.primaryGroupBy.extendedGroupBys[1].aliasName]);break;case o.a.MONTH:a=Object(_.e)(e.fields[t.aliasName]),r=Object(_.e)(e.fields[t.primaryGroupBy.extendedGroupBys[0].aliasName]);break;case o.a.YEAR:r=Object(_.e)(e.fields[t.aliasName]);break;case o.a.QUARTER:a=Object(_.e)(e.fields[t.aliasName]),r=Object(_.e)(e.fields[t.primaryGroupBy.extendedGroupBys[0].aliasName]);break;case o.a.WEEK:n=1+7*(Object(_.e)(e.fields[t.aliasName])-1),r=Object(_.e)(e.fields[t.primaryGroupBy.extendedGroupBys[0].aliasName]);break;default:return P(t,e)}return new Date(r,a-1,n).getTime()}(t,e);default:return P(t,e)}}function F(t){return{Enabled:t&&t.Enabled||!1,X:t&&t.X||0,Y:t&&t.Y||0,Align:t&&t.Align||"left",VerticalAlign:t&&t.VerticalAlign||"middle",LabelFormatter:t&&t.LabelFormatter||null,Color:t&&t.Color||"",FontFamily:t&&t.FontFamily||"",FontSize:t&&t.FontSize||""}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function k(t){return{Value:t&&t.Value||0,FormattedValue:t&&t.FormattedValue||null,Aggregators:t&&t.Aggregators||null}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class D extends Error{constructor(t,e,n){super(t),Object.setPrototypeOf(this,D.prototype),this.title=e,this.description=n}}var M=n("Lyxw"),L=n("3/02"),R=n("zh0k"),X=n("hwt8"),V=n("504W");function U(){return this.point.formattedValue}function G(t){return function(){return Highcharts.numberFormat(parseFloat(this.point.y)/t*100)+"%"}}class B{constructor(){this.isInitialized=!1}get primaryGroupBy(){return this.chartDataDescription&&this.chartDataDescription.category&&this.chartDataDescription.category.primaryGroupBy}get queryModel(){return this._queryModel}initialize(t,e,n,a,r,i,s,o,c,l){this.getState=t,this.chartData=e,this.chartDataDescription=n,this.categoryColumn=this.chartDataDescription.categoryColumns,this.chartPresentationSeries=a,this.chartPresentationXAxis=r,this.chartPresentationYAxis=i,this.chartPresentationArea3DStyle=s,this.chartPresentationAreaGradientStyle=o,this._queryModel=c,this.chartPresentationAnnotationList=l,this._isChartCustomizationParityFCBEnabled()&&this._validateChartAggregateAttributes(),this.isInitialized=!0}setXAxisMajorGridAndMajorTickProperties(t,e=0){var n,a,r,i,s,o,c,l;return t.AxisMajorGridColor=null===(a=null===(n=this.chartPresentationXAxis)||void 0===n?void 0:n[e])||void 0===a?void 0:a.AxisMajorGridColor,t.AxisMajorGridEnabled=null===(i=null===(r=this.chartPresentationXAxis)||void 0===r?void 0:r[e])||void 0===i?void 0:i.AxisMajorGridEnabled,t.AxisMajorTickMarkColor=null===(o=null===(s=this.chartPresentationXAxis)||void 0===s?void 0:s[e])||void 0===o?void 0:o.AxisMajorTickMarkColor,t.AxisMajorTickMarkEnabled=null===(l=null===(c=this.chartPresentationXAxis)||void 0===c?void 0:c[e])||void 0===l?void 0:l.AxisMajorTickMarkEnabled,t}setYAxisMajorGridAndMajorTickProperties(t,e=0){var n,a,r,i,s,o,c,l;return t.AxisMajorGridColor=null===(a=null===(n=this.chartPresentationYAxis)||void 0===n?void 0:n[e])||void 0===a?void 0:a.AxisMajorGridColor,t.AxisMajorGridEnabled=null===(i=null===(r=this.chartPresentationYAxis)||void 0===r?void 0:r[e])||void 0===i?void 0:i.AxisMajorGridEnabled,t.AxisMajorTickMarkColor=null===(o=null===(s=this.chartPresentationYAxis)||void 0===s?void 0:s[e])||void 0===o?void 0:o.AxisMajorTickMarkColor,t.AxisMajorTickMarkEnabled=null===(l=null===(c=this.chartPresentationYAxis)||void 0===c?void 0:c[e])||void 0===l?void 0:l.AxisMajorTickMarkEnabled,t}retrieveChartArea3DStyle(){const t={};return t.Enable3D=this.chartPresentationArea3DStyle.Enable3D,t}retrieveChartAreaGradientStyle(){const t={};return t.BackColor=this.chartPresentationAreaGradientStyle.BackColor,t.BackSecondaryColor=this.chartPresentationAreaGradientStyle.BackSecondaryColor,t.BackGradientStyle=this.chartPresentationAreaGradientStyle.BackGradientStyle,t}setYAxisOppositeProperty(t){var e,n,a,r;return this._isChartCustomizationParityFCBEnabled()&&(null===(n=null===(e=this.chartPresentationXAxis)||void 0===e?void 0:e[0])||void 0===n?void 0:n.IsReversed)&&(t.Opposite=null===(r=null===(a=this.chartPresentationXAxis)||void 0===a?void 0:a[0])||void 0===r?void 0:r.IsReversed),t}setXAxisIsReversedProperty(t){var e,n,a,r;return this._isChartCustomizationParityFCBEnabled()&&(null===(n=null===(e=this.chartPresentationXAxis)||void 0===e?void 0:e[0])||void 0===n?void 0:n.IsReversed)&&(t.IsReversed=null===(r=null===(a=this.chartPresentationXAxis)||void 0===a?void 0:a[0])||void 0===r?void 0:r.IsReversed),t}retrieveChartYAxis(){const t=new Array(1);if(t[0]={},!this._queryModel.SeriesList)return t;const e=(t,e,n)=>{this.chartPresentationYAxis&&this.chartPresentationYAxis.length>e&&this.chartPresentationYAxis[e]&&this.chartPresentationYAxis[e].Title?t.Title=this.chartPresentationYAxis[e].Title:1===n&&(t.Title=this._queryModel.SeriesList[e].Title)};let n=0,a=-1,r=-1,i=!1,s=!1;for(let t=0;t<this.chartPresentationSeries.length;t++)this.chartPresentationSeries[t].SecondaryYAxis?(n++,r=-1===r?t:r,s=s||this.shouldDisableAllowDecimals(t)):(a=-1===a?t:a,i=i||this.shouldDisableAllowDecimals(t));return e(t[0],a,this.chartPresentationSeries.length-n),t[0].Opposite=!1,i&&(t[0].AllowDecimals=!1),0===n&&(t[0]=this.setYAxisOppositeProperty(t[0])),n>0&&(t[1]={},e(t[1],r,n),t[1].Opposite=!0,s&&(t[1].AllowDecimals=!1)),t.forEach((t,e)=>{var n,a,r,i,s,o,c,l,u,d,h,g,p,m,b,y,f,v;t.Disabled=this.chartPresentationYAxis&&this.chartPresentationYAxis[e]&&this.chartPresentationYAxis[e].Disabled,t.LabelForeColor=null===(a=null===(n=this.chartPresentationYAxis)||void 0===n?void 0:n[e])||void 0===a?void 0:a.LabelForeColor,t.LabelFontFamily=null===(i=null===(r=this.chartPresentationYAxis)||void 0===r?void 0:r[e])||void 0===i?void 0:i.LabelFontFamily,t.LabelFontSize=null===(o=null===(s=this.chartPresentationYAxis)||void 0===s?void 0:s[e])||void 0===o?void 0:o.LabelFontSize,t.AxisLineColor=null===(l=null===(c=this.chartPresentationYAxis)||void 0===c?void 0:c[e])||void 0===l?void 0:l.AxisLineColor,t.AxisTitleForeColor=null===(d=null===(u=this.chartPresentationYAxis)||void 0===u?void 0:u[e])||void 0===d?void 0:d.AxisTitleForeColor,t.LabelDisabled=null===(g=null===(h=this.chartPresentationYAxis)||void 0===h?void 0:h[e])||void 0===g?void 0:g.LabelDisabled,t.AxisInterval=null===(m=null===(p=this.chartPresentationYAxis)||void 0===p?void 0:p[e])||void 0===m?void 0:m.AxisInterval,t.AxisMinimum=null===(y=null===(b=this.chartPresentationYAxis)||void 0===b?void 0:b[e])||void 0===y?void 0:y.AxisMinimum,t.AxisMaximum=null===(v=null===(f=this.chartPresentationYAxis)||void 0===f?void 0:f[e])||void 0===v?void 0:v.AxisMaximum,t=this.setYAxisMajorGridAndMajorTickProperties(t,e)}),this.chartPresentationYAxis&&this.chartPresentationYAxis[0]&&this.chartPresentationYAxis[0].FormatString?t[0].FormatString=this.chartPresentationYAxis[0].FormatString:t[0].FormatterProperties=this.getFormatterPropertiesForAttribute(this.chartDataDescription.category.measureCollections[0].measures[0].measureAttribute),n>0&&(this.chartPresentationYAxis&&this.chartPresentationYAxis[1]&&this.chartPresentationYAxis[1].FormatString?t[1].FormatString=this.chartPresentationYAxis[1].FormatString:t[1].FormatterProperties=this.getFormatterPropertiesForAttribute(this.chartDataDescription.category.measureCollections[r].measures[0].measureAttribute)),t}_isChartCustomizationParityFCBEnabled(){return Object(M.e)(this.getState(),L.H,L.jf,L.M)}retrieveChartAnnotations(){const t=new Array(this.chartPresentationAnnotationList.length);for(let e=0;e<this.chartPresentationAnnotationList.length;e++){const n={};n.X=this.chartPresentationAnnotationList[e].X,n.Y=this.chartPresentationAnnotationList[e].Y,n.Text=this.chartPresentationAnnotationList[e].Text,n.ForeColor=this.chartPresentationAnnotationList[e].ForeColor,t[e]=n}return t}retrieveChartCategory(){var t,e,n,a,r,i,s,o,c,l;const u=new Array(1);let d=null;this.categoryColumn.length>0&&(d=E(this.getState(),this.categoryColumn[0],this.chartDataDescription.category.primaryGroupBy)),u[0]={};const h=new Array(this.chartData.length);for(let t=0;t<this.chartData.length;t++){const e=this.chartData[t];if(d){if(h[t]=P(d,e),!d.isDateTimeChart&&"number"==typeof Object(_.e)(e.fields[d.aliasName])&&this.chartPresentationXAxis&&this.chartPresentationXAxis[0]&&this.chartPresentationXAxis[0].FormatString){const n=Object(b.x)(this.getState());h[t]=Object(X.c)(Object(_.e)(e.fields[d.aliasName]),Object(y.c)(n),this.chartPresentationXAxis[0].FormatString)}}else h[t]=A(this.getState())}return u[0].Title=this.retrieveChartCategoryTitle(d),u[0].Values=h,u[0].Disabled=this.chartPresentationXAxis&&this.chartPresentationXAxis[0]&&this.chartPresentationXAxis[0].Disabled,u[0].LabelForeColor=null===(e=null===(t=this.chartPresentationXAxis)||void 0===t?void 0:t[0])||void 0===e?void 0:e.LabelForeColor,u[0].LabelFontFamily=null===(a=null===(n=this.chartPresentationXAxis)||void 0===n?void 0:n[0])||void 0===a?void 0:a.LabelFontFamily,u[0].LabelFontSize=null===(i=null===(r=this.chartPresentationXAxis)||void 0===r?void 0:r[0])||void 0===i?void 0:i.LabelFontSize,u[0].AxisLineColor=null===(o=null===(s=this.chartPresentationXAxis)||void 0===s?void 0:s[0])||void 0===o?void 0:o.AxisLineColor,u[0].AxisTitleForeColor=null===(l=null===(c=this.chartPresentationXAxis)||void 0===c?void 0:c[0])||void 0===l?void 0:l.AxisTitleForeColor,u[0].LabelDisabled=this.chartPresentationXAxis&&this.chartPresentationXAxis[0]&&this.chartPresentationXAxis[0].LabelDisabled,u[0]=this.setXAxisMajorGridAndMajorTickProperties(u[0]),u[0]=this.setXAxisIsReversedProperty(u[0]),u}retrieveChartCategoryTitle(t){return this.chartPresentationXAxis&&this.chartPresentationXAxis.length>0&&this.chartPresentationXAxis[0].Title?this.chartPresentationXAxis[0].Title:t?I((e=t).state,e.attribute):"";var e}retrieveChartSeries(t){const e=new Array(this.chartPresentationSeries.length);for(let n=0;n<this.chartPresentationSeries.length;n++){const a=this.chartDataDescription.category.measureCollections[n].measures[0].measureAttribute,r=a.aliasName?a.aliasName:a.attributeName,i=this.chartPresentationSeries[n].IsValueShownAsLabel,s=this.chartPresentationSeries[n].LabelFormat;let o=null;s&&Object(X.d)(s)&&(o=Object(X.g)(s));let c=!1;this.chartPresentationSeries[n].Label&&"#percent"===this.chartPresentationSeries[n].Label.toLowerCase()&&(c=!0);let l=!1;s&&Y(this.chartPresentationSeries[n].ChartType)&&Object(X.e)(s)&&(l=!0);let u=null;const d=I(this.getState(),a);e[n]=this.cloneBlueprintSeriesStyle(this.chartPresentationSeries[n]),this.chartPresentationSeries[n].SecondaryYAxis&&(e[n].YAxisNumber=1),this.primaryGroupBy&&(u=[],u.push(this.primaryGroupBy.groupAttribute),this.primaryGroupBy.extendedGroupBys&&this.primaryGroupBy.extendedGroupBys.forEach(t=>{u.push(t)}));const h=new Array(this.chartData.length),g=r;let p=0;for(let t=0;t<this.chartData.length;t++){const e=this.chartData[t];h[t]=k();const a=Object(_.e)(e.fields[r]);if(h[t].Value=a||0,p+=a||0,s){const a=Object(b.x)(this.getState()),r=Object(y.c)(a);Object(X.f)(s)?h[t].FormattedValue=Object(R.b)(h[t].Value,this.chartPresentationSeries[n].LabelFormat,r):Object(X.d)(s)&&!l?h[t].FormattedValue=Object(X.a)(h[t].Value,o,r):h[t].FormattedValue=Object(_.c)(e.fields[g])||0}else h[t].FormattedValue=Object(_.c)(e.fields[g])||0;this.attachAggregators(h[t],e,u)}const m=F();i?(m.Enabled=!0,m.LabelFormatter=U):c&&(m.Enabled=!0,m.LabelFormatter=G(p)),m.Color=this.chartPresentationSeries[n].LabelForeColor,m.FontFamily=this.chartPresentationSeries[n].FontFamily,m.FontSize=this.chartPresentationSeries[n].FontSize,e[n].DataLabels=m,e[n].DataPoints=h,e[n].Title=this.getChartTitleFromPresentationSeries(d,n),e[n].XAxisNumber=t,e[n].HideInLegend=this.chartPresentationSeries[n].HideInLegend,e[n].Stack=this.chartPresentationSeries[n].Stack}const n=Object(b.x)(this.getState()),a=Object(y.c)(n),r=this.chartPresentationSeries[0].IsValueShownAsLabel,i=this.chartPresentationSeries[0].LabelFormat;if(r&&Y(this.chartPresentationSeries[0].ChartType)&&Object(X.e)(i)){const t=z(i,a);for(let n=0;n<e[0].DataPoints.length;n++)t(0,n,0,e)}return e}getChartTitleFromPresentationSeries(t,e=0){return Object(V.b)(this.chartPresentationSeries[e].LegendText)?Object(V.b)(this.chartPresentationSeries[e].Name)?t:this.chartPresentationSeries[e].Name:this.chartPresentationSeries[e].LegendText}shouldDisableAllowDecimals(t){const e=this.chartDataDescription.category.measureCollections[t].measures[0].measureAttribute;return"count"===e.aggregateType||"countcolumn"===e.aggregateType}cloneBlueprintSeriesStyle(t){const e={DataPoints:n&&n.DataPoints||null,DataLabels:n&&n.DataLabels||null,ChartType:n&&n.ChartType||"line",YAxisNumber:n&&n.YAxisNumber||0,XAxisNumber:n&&n.XAxisNumber||0,Title:n&&n.Title||"",Color:n&&n.Color||"",BorderColor:n&&n.BorderColor||"",BorderWidth:n&&n.BorderWidth||0,CustomProperties:n&&n.CustomProperties||null,Stack:n&&n.Stack||null};
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n;return e.ChartType=t.ChartType,e.Color=t.Color,e.BorderColor=t.BorderColor,e.BorderWidth=t.BorderWidth,e.CustomProperties=t.CustomProperties,e}attachAggregators(t,e,n){if(n){const r=new h;for(let t=0;t<n.length;t++){const i=n[t],s=new Array;i.entity.baseEntity&&i.entity.baseEntity.linkedEntities&&i.entity.baseEntity.linkedEntities.forEach(t=>{const e={name:n&&n.name||null,from:n&&n.from||null,to:n&&n.to||null,linkType:n&&n.linkType||null,alias:n&&n.alias||null};var n;e.name=t.entityName,e.from=t.linkFromAttribute,e.to=t.linkToAttribute,e.linkType=t.joinType.toString(),e.alias=t.alias,s.push(e)}),r.addAggregator(i.attributeName,Object(_.e)(e.fields[(a=i,a.aliasName&&a.aliasName.trim()?a.aliasName:a.attributeName)]),i.dateTimeGrouping?i.dateTimeGrouping.groupingType:-1,i.entity.entityName,s)}const i=Object(b.x)(this.getState()),s=this._getFirstDayOfWeekFromUserSettings(i),o=this._getCalendarWeekRuleFromUserSettings(i);t.Aggregators=r.getAggregators(s,o)}var a}_getFirstDayOfWeekFromUserSettings(t){var e;return(null===(e=t.dateFormatInfo)||void 0===e?void 0:e.FirstDayOfWeek)||0}_getCalendarWeekRuleFromUserSettings(t){var e;return(null===(e=t.dateFormatInfo)||void 0===e?void 0:e.CalendarWeekRule)||0}getFormatterPropertiesForAttribute(t){return Object(y.A)(this.getState(),Object(C.a)(this.getState(),t.entity.entityName,t.attributeName))}isChartDrillable(){if(!this._isGroupByDrillable(this.chartDataDescription.category.primaryGroupBy))return!1;for(const t of this.chartDataDescription.category.measureCollections)for(const e of t.secondaryGroupBys)if(!this._isGroupByDrillable(e))return!1;return!!this.chartDataDescription.entityExpression.hasAggregate}_isGroupByDrillable(t){return!this.chartDataDescription.isGroupByFromNestedLinkEntity()&&(!(!t||!t.groupAttribute.hasGroupBy)&&this._isAttributeDrillable(t.groupAttribute))}_isAttributeDrillable(t){var e;const n=null===(e=null==t?void 0:t.entity)||void 0===e?void 0:e.entityName,a=null==t?void 0:t.attributeName;return Object(C.b)(a,n,this.getState())!==v.a.Memo}_validateChartAggregateAttributes(){var t,e,n,a;for(let r=0;r<(null===(n=null===(e=null===(t=this.chartDataDescription)||void 0===t?void 0:t.entityExpression)||void 0===e?void 0:e.aggregateAttributes)||void 0===n?void 0:n.length);r++){const t=this.chartDataDescription.entityExpression.aggregateAttributes[r],e=null===(a=null==t?void 0:t.entity)||void 0===a?void 0:a.entityName,n=null==t?void 0:t.attributeName,i=Object(C.b)(n,e,this.getState());if(!(i!==v.a.Date&&i!==v.a.DateTime||"min"!==t.aggregateType&&"max"!==t.aggregateType)){const t=String.format(Object(p.b)(this.getState(),m.g),n);throw new D("ChartError",t,t)}}}}function Y(t){return!!t&&("stackedbar100"===t.toLowerCase()||"stackedcolumn100"===t.toLowerCase()||"stackedarea100"===t.toLowerCase())}function z(t,e){return function n(a,r,i,s){if(a===s.length)return i;const o=s[a].DataPoints[r];return i=n(++a,r,i+(o&&o.Value?o.Value:0),s),o&&o.Value&&(o.FormattedValue=Object(X.a)(o.Value/i*100,Object(X.g)(t),e)),i}}var H=n("iZ7K");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class q extends B{parse(){var t,e,n,a,r,i,s,o;if(!this.isInitialized)throw new Error("The instance of the ComparisonChartDataParser class is not properly initialized.");const c=new Array(0),l=new Map,u=this.chartDataDescription.category,d=u.measureCollections[0];if(d.secondaryGroupBys.length<=0)throw new Error("Comparison chart can only be plotted with secondary groups's");if(d.measures&&d.measures.length>0&&d.measures[0].parentCategory&&d.measures[0].parentCategory.primaryGroupBy&&(d.measures[0].parentCategory.primaryGroupBy.groupAttribute&&c.push(d.measures[0].parentCategory.primaryGroupBy.groupAttribute),d.measures[0].parentCategory.primaryGroupBy.extendedGroupBys))for(let t=0;t<d.measures[0].parentCategory.primaryGroupBy.extendedGroupBys.length;t++)c.push(d.measures[0].parentCategory.primaryGroupBy.extendedGroupBys[t]);if(1!==this.chartPresentationSeries.length)throw new Error("Comparison chart should have only one series");const h=this._addSecondaryGroupByToFieldAggregators(d,c),g=d.measures[0].measureAttribute,p=g.aliasName?g.aliasName:g.attributeName,m=p,f=u.primaryGroupBy.groupAttribute,v=E(this.getState(),this._getGroupByAttribute(f,u.primaryGroupBy),u.primaryGroupBy),O=new Array,C=new Array,S=new Map;for(let t=0;t<this.chartData.length;t++){const e=this.chartData[t],n=P(v,e);let a,r=P(h,e);null==r?(r=A(this.getState()),a=r):a=w(h,e),l.set(a,r),C.indexOf(n)<0&&C.push(n),O.indexOf(a)<0&&O.push(a)}O.forEach(t=>{const e=new Array(C.length);S.set(t,e)});const j=Object(b.x)(this.getState()),I=this.chartPresentationSeries[0].LabelFormat;let T=!1;this.chartPresentationSeries[0].Label&&"#percent"===this.chartPresentationSeries[0].Label.toLowerCase()&&(T=!0);let x=!1;I&&Y(this.chartPresentationSeries[0].ChartType)&&Object(X.e)(I)&&(x=!0);for(let t=0;t<this.chartData.length;t++){const e=this.chartData[t];let n=w(h,e);Object(N.a)(n)&&(n=A(this.getState()));const a=S.get(n),r=P(v,e),i=C.indexOf(r);if(this.chartPresentationXAxis&&this.chartPresentationXAxis[0]&&this.chartPresentationXAxis[0].FormatString&&(C[i]=Object(X.c)(Object(_.e)(e.fields[v.aliasName]),Object(y.c)(j),this.chartPresentationXAxis[0].FormatString)),a[i]=k(),a[i].Value=Object(_.e)(e.fields[p]),I){const n=Object(y.c)(j);Object(X.f)(I)?a[i].FormattedValue=Object(R.b)(a[t].Value,I,n):Object(X.d)(I)&&!x?a[i].FormattedValue=Object(X.a)(a[i].Value,Object(X.g)(I),n):a[i].FormattedValue=Object(_.c)(e.fields[m])||0}else a[i].FormattedValue=Object(_.c)(e.fields[m])||0;this.attachAggregators(a[i],e,c)}O.forEach(t=>{const e=S.get(t);for(let t=0;t<C.length;t++)e[t]||(e[t]=k())});const D=new Array(1);D[0]={},D[0].Title=this.retrieveChartCategoryTitle(v),D[0].Values=C,D[0].LabelForeColor=null===(t=this.chartPresentationXAxis[0])||void 0===t?void 0:t.LabelForeColor,D[0].LabelFontFamily=null===(n=null===(e=this.chartPresentationXAxis)||void 0===e?void 0:e[0])||void 0===n?void 0:n.LabelFontFamily,D[0].LabelFontSize=null===(r=null===(a=this.chartPresentationXAxis)||void 0===a?void 0:a[0])||void 0===r?void 0:r.LabelFontSize,D[0].AxisLineColor=null===(i=this.chartPresentationXAxis[0])||void 0===i?void 0:i.AxisLineColor,D[0].AxisTitleForeColor=null===(s=this.chartPresentationXAxis[0])||void 0===s?void 0:s.AxisTitleForeColor,D[0].LabelDisabled=null===(o=this.chartPresentationXAxis[0])||void 0===o?void 0:o.LabelDisabled,D[0]=this.setXAxisMajorGridAndMajorTickProperties(D[0]),D[0]=this.setXAxisIsReversedProperty(D[0]),this._sortComparisonCodes(d,O);const M=new Array(O.length),L=this.chartPresentationSeries[0]&&this.chartPresentationSeries[0].IsValueShownAsLabel,V=this.chartPresentationSeries[0]?this.chartPresentationSeries[0].LabelForeColor:null,B=this.chartPresentationSeries[0]&&this.chartPresentationSeries[0].HideInLegend,H=this.getChartTitleFromPresentationSeries(this.chartPresentationSeries[0].Name);for(let t=0;t<O.length;t++){const e=O[t];if(M[t]=this.cloneBlueprintSeriesStyle(this.chartPresentationSeries[0]),M[t].Title=H||l.get(e),M[t].DataPoints=S.get(e),M[t].HideInLegend=B,L){const e=F();e.Enabled=!0,e.LabelFormatter=U,e.FontFamily=this.chartPresentationSeries[0].FontFamily,e.FontSize=this.chartPresentationSeries[0].FontSize,M[t].DataLabels=e,e.Color=V}else if(T){let e=0;M[t].DataPoints.forEach(t=>{e+=t&&t.Value?t.Value:0});const n=F();n.Enabled=!0,n.LabelFormatter=G(e),n.FontFamily=this.chartPresentationSeries[0].FontFamily,n.FontSize=this.chartPresentationSeries[0].FontSize,M[t].DataLabels=n,n.Color=V}}if(L&&x){const t=z(I,Object(y.c)(j));for(let e=0;e<D[0].Values.length;e++)t(0,e,0,M)}this.queryModel.Area3DStyle=this.retrieveChartArea3DStyle(),this.queryModel.AreaGradientStyle=this.retrieveChartAreaGradientStyle(),this.queryModel.XAxes=D,this.queryModel.YAxes=this._retrieveChartYAxis(g),this.queryModel.SeriesList=M,this.queryModel.EnableDrilldown=this.isChartDrillable(),this.queryModel.Annotations=this.retrieveChartAnnotations()}_sortComparisonCodes(t,e){t.secondaryGroupBys[0].descending?e.sort((t,e)=>"number"==typeof t&&"number"==typeof e?e-t:e.localeCompare(t)):e.sort((t,e)=>"number"==typeof t&&"number"==typeof e?t-e:t.localeCompare(e))}_getGroupByAttribute(t,e){return t.attributeName!==Object(H.h)(this.getState(),t.entity.entityName).PrimaryIdAttribute?t:e.extendedGroupBys&&e.extendedGroupBys.length>0?e.extendedGroupBys[0]:t}_addSecondaryGroupByToFieldAggregators(t,e){const n=t.secondaryGroupBys[0].groupAttribute,a=E(this.getState(),this._getGroupByAttribute(n,t.secondaryGroupBys[0]),t.secondaryGroupBys[0]);if(n&&e.push(n),t.secondaryGroupBys[0].extendedGroupBys)for(let n=0;n<t.secondaryGroupBys[0].extendedGroupBys.length;n++)e.push(t.secondaryGroupBys[0].extendedGroupBys[n]);return a}_retrieveChartYAxis(t){var e,n,a,r,i,s,o,c;const l=new Array(1);return l[0]={},this.chartPresentationYAxis&&this.chartPresentationYAxis.length>0&&this.chartPresentationYAxis[0].Title?l[0].Title=this.chartPresentationYAxis[0].Title:l[0].Title=I(this.getState(),t),this.chartPresentationYAxis[0].FormatString?l[0].FormatString=this.chartPresentationYAxis[0].FormatString:l[0].FormatterProperties=this.getFormatterPropertiesForAttribute(this.chartDataDescription.category.measureCollections[0].measures[0].measureAttribute),this.chartPresentationYAxis[0]&&this.chartPresentationYAxis[0].LabelForeColor&&(l[0].LabelForeColor=this.chartPresentationYAxis[0].LabelForeColor),this.chartPresentationYAxis[0]&&this.chartPresentationYAxis[0].LabelFontFamily&&(l[0].LabelFontFamily=this.chartPresentationYAxis[0].LabelFontFamily),this.chartPresentationYAxis[0]&&this.chartPresentationYAxis[0].LabelFontSize&&(l[0].LabelFontSize=this.chartPresentationYAxis[0].LabelFontSize),this.chartPresentationYAxis[0]&&this.chartPresentationYAxis[0].AxisLineColor&&(l[0].AxisLineColor=this.chartPresentationYAxis[0].AxisLineColor),this.chartPresentationYAxis[0]&&this.chartPresentationYAxis[0].AxisTitleForeColor&&(l[0].AxisTitleForeColor=this.chartPresentationYAxis[0].AxisTitleForeColor),this.chartPresentationYAxis[0]&&this.chartPresentationYAxis[0].LabelDisabled&&(l[0].LabelDisabled=null===(n=null===(e=this.chartPresentationYAxis)||void 0===e?void 0:e[0])||void 0===n?void 0:n.LabelDisabled),l[0].AxisInterval=null===(r=null===(a=this.chartPresentationYAxis)||void 0===a?void 0:a[0])||void 0===r?void 0:r.AxisInterval,l[0].AxisMinimum=null===(s=null===(i=this.chartPresentationYAxis)||void 0===i?void 0:i[0])||void 0===s?void 0:s.AxisMinimum,l[0].AxisMaximum=null===(c=null===(o=this.chartPresentationYAxis)||void 0===o?void 0:o[0])||void 0===c?void 0:c.AxisMaximum,this.shouldDisableAllowDecimals(0)&&(l[0].AllowDecimals=!1),l[0]=this.setYAxisMajorGridAndMajorTickProperties(l[0]),l[0]=this.setYAxisOppositeProperty(l[0]),l}}class W extends B{parse(){if(!this.isInitialized)throw new Error("The instance of the DateTimeChartDataParser class is not properly initialized.");this.categoryColumn&&0!==this.categoryColumn.length&&(this.queryModel.Area3DStyle=this.retrieveChartArea3DStyle(),this.queryModel.AreaGradientStyle=this.retrieveChartAreaGradientStyle(),this.queryModel.XAxes=this.retrieveChartCategory(),this.queryModel.SeriesList=this.retrieveChartSeries(0),this.queryModel.YAxes=this.retrieveChartYAxis(),this.queryModel.EnableDrilldown=this.isChartDrillable(),this.queryModel.Annotations=this.retrieveChartAnnotations())}retrieveChartCategory(){var t,e,n,a,r,i,s,o,c,l,u,d;const h=new Array(1);if(this.chartData.length<1)return h;const g=this.primaryGroupBy.groupAttribute;h[0]={};const f=new Array(this.chartData.length),v=E(this.getState(),g,this.primaryGroupBy);h[0].Title=this.retrieveChartCategoryTitle(v),h[0].LabelForeColor=null===(e=null===(t=this.chartPresentationXAxis)||void 0===t?void 0:t[0])||void 0===e?void 0:e.LabelForeColor,h[0].LabelFontFamily=null===(a=null===(n=this.chartPresentationXAxis)||void 0===n?void 0:n[0])||void 0===a?void 0:a.LabelFontFamily,h[0].LabelFontSize=null===(i=null===(r=this.chartPresentationXAxis)||void 0===r?void 0:r[0])||void 0===i?void 0:i.LabelFontSize,h[0].AxisLineColor=null===(o=null===(s=this.chartPresentationXAxis)||void 0===s?void 0:s[0])||void 0===o?void 0:o.AxisLineColor,h[0].AxisTitleForeColor=null===(l=null===(c=this.chartPresentationXAxis)||void 0===c?void 0:c[0])||void 0===l?void 0:l.AxisTitleForeColor,h[0].LabelDisabled=null===(d=null===(u=this.chartPresentationXAxis)||void 0===u?void 0:u[0])||void 0===d?void 0:d.LabelDisabled,h[0]=this.setXAxisMajorGridAndMajorTickProperties(h[0]),h[0]=this.setXAxisIsReversedProperty(h[0]);for(let t=0;t<this.chartData.length;t++){const e=this.chartData[t];f[t]=P(v,e),v.isDateTimeChart&&this.chartPresentationXAxis&&this.chartPresentationXAxis[0]&&this.chartPresentationXAxis[0].FormatString&&f[t]!==Object(p.b)(v.state,m.u)&&(f[t]=Object(X.b)(new Date(f[t]),Object(y.c)(Object(b.x)(this.getState())),this.chartPresentationXAxis[0].FormatString))}return h[0].Values=f,h}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class K extends B{parse(){if(!this.isInitialized)throw new Error("The instance of the NormalChartDataParser class is not properly initialized.");this.categoryColumn&&0!==this.categoryColumn.length&&(this.queryModel.Area3DStyle=this.retrieveChartArea3DStyle(),this.queryModel.AreaGradientStyle=this.retrieveChartAreaGradientStyle(),this.queryModel.XAxes=this.retrieveChartCategory(),this.queryModel.SeriesList=this.retrieveChartSeries(0),this.queryModel.YAxes=this.retrieveChartYAxis(),this.queryModel.EnableDrilldown=this.isChartDrillable(),this.queryModel.Annotations=this.retrieveChartAnnotations())}}var Q=n("DAWX");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Z(t){const e={};try{if(t){const n=/\w+=\w+/;t.split(/\s*,\s*/).forEach(t=>{if(t&&n.test(t)){const[n,a]=t.split("=");e[n]=a}})}}catch(e){throw`Failed to parse chart custom properties, value: ${t} `}return{BarLabelStyle:(null==e?void 0:e.BarLabelStyle)||null,FunnelNeckHeight:null!=(null==e?void 0:e.FunnelNeckHeight)?Number(e.FunnelNeckHeight):0,FunnelNeckWidth:null!=(null==e?void 0:e.FunnelNeckWidth)?Number(e.FunnelNeckWidth):10,InnerSize:null!=(null==e?void 0:e.InnerSize)?Number(e.InnerSize):null,MinPointLength:null!=(null==e?void 0:e.MinPointLength)?Number(e.MinPointLength):3,StackedGroupName:(null==e?void 0:e.StackedGroupName)||null}}var J=n("g03H");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const $=["COLUMN","STACKEDCOLUMN","STACKEDCOLUMN100","BAR","STACKEDBAR","STACKEDBAR100","AREA","STACKEDAREA","STACKEDAREA100","LINE","PIE","FUNNEL","TAG","DOUGHNUT","POINT"];function tt(t,e,n){const a=(new DOMParser).parseFromString(e,"text/xml");!function(t,e){const n=t.getElementsByTagName("parsererror");if(n&&n.length>0)throw new D("ChartError",Object(p.b)(e,m.s),Object(p.b)(e,m.r))}(a,t);return{chartPresentationSeries:et(t,a,n),chartPresentationLegendList:rt(a),colorsList:at(a),chartPresentationArea3DStyle:lt(a),chartPresentationAreaGradientStyle:ut(a),chartPresentationXAxis:st(a),chartPresentationYAxis:ot(a),chartPresentationAnnotationList:it(a)}}function et(t,e,n){const a=new Array,r=e.querySelectorAll("Chart Series Series"),i=new XMLSerializer;for(let e=0;e<r.length;e++){const s=r[e],o={},c=s.getAttribute("ChartType")||"Column";if(-1===$.indexOf(c.toUpperCase()))throw new D("ChartError",Object(p.b)(t,m.s),Object(p.b)(t,m.s));o.ChartType=c;const l=s.getAttribute("Color");o.Color=l?dt(l):null;const u=s.getAttribute("Font");o.FontFamily=u?u.split(/\s*,\s*/)[0]:null,o.FontSize=u?u.split(/\s*,\s*/)[1]:null;const d=s.getAttribute("LegendText");o.LegendText=d||null;const h=s.getAttribute("CustomProperties");o.CustomProperties=Z(h);const g=s.getAttribute("BorderColor");o.BorderColor=g?dt(g):null;const b=s.getAttribute("BorderWidth");o.BorderWidth=b?Number(b):null;const y=s.getAttribute("IsValueShownAsLabel");o.IsValueShownAsLabel=y&&"true"===y.toLowerCase()||!1,o.Label=s.getAttribute("Label");const f=s.getAttribute("YAxisType");o.SecondaryYAxis=f&&"secondary"===f.toLowerCase();const v=s.getAttribute("IsVisibleInLegend");o.HideInLegend=v&&"false"===v.toLowerCase();const O=s.getAttribute("LabelForeColor");o.LabelForeColor=O?dt(O):null,o.LabelFormat=s.getAttribute("LabelFormat");const C=nt(t,s.outerHTML||i.serializeToString(s),n);o.Name=C||null,o.Stack=o.CustomProperties.StackedGroupName,a.push(o)}return a}function nt(t,e,n){const a=Object(s.a)(e);if(Object(J.l)(a)||a.length<5)return"";const r=a[2].toLowerCase(),i=a[4];let o="";const c=r.substring(0,n.length);if(c!==n)return"";const l=r.substring(n.length+1,r.length),u=Object(C.a)(t,c,l);return u&&u.OptionSet&&(o=u.OptionSet.filter(t=>t.Value.toString().toLowerCase()===i.toLowerCase())[0].Label),o}function at(t){const e=new Array,n=t.querySelector("Chart").getAttribute("PaletteCustomColors");return null!==n&&n.split(";").forEach(t=>{if(t){const n=dt(t);e.push(n)}}),e}function rt(t){const e=new Array,n=t.querySelectorAll("Chart Legends Legend");for(let t=0;t<n.length;t++){const a={},r=n[t].getAttribute("Enabled");a.Enabled=null===r||"True"===r,e.push(a)}return e}function it(t){const e=new Array,n=t.querySelectorAll("Chart Annotations TextAnnotation");for(let t=0;t<n.length;t++){const a=n[t],r={},i=a.getAttribute("X");r.X=i?Number(i):null;const s=a.getAttribute("Y");r.Y=s?Number(s):null,r.Text=a.getAttribute("Text");const o=a.getAttribute("ForeColor");r.ForeColor=o?dt(o):null,e.push(r)}return e}function st(t){const e=new Array,n=t.querySelectorAll("Chart ChartAreas ChartArea AxisX");for(let a=0;a<n.length;a++){const r=n[a],i={};ct(i,t.querySelectorAll("Chart ChartAreas ChartArea AxisX MajorGrid")[0],t.querySelectorAll("Chart ChartAreas ChartArea AxisX MajorTickMark")[0]),i.Title=r.getAttribute("Title");const s=t.querySelectorAll("Chart ChartAreas ChartArea AxisX LabelStyle")[0];if(s){const t=null==s?void 0:s.getAttribute("ForeColor"),e=null==s?void 0:s.getAttribute("Enabled"),n=null==s?void 0:s.getAttribute("Font");i.LabelFontFamily=n?n.split(/\s*,\s*/)[0]:null,i.LabelFontSize=n?n.split(/\s*,\s*/)[1]:null,i.LabelForeColor=t?dt(t):null,i.LabelDisabled=e&&"false"===e.toLowerCase(),i.FormatString=s.getAttribute("Format")}const o=r.getAttribute("Enabled"),c=r.getAttribute("LineColor"),l=r.getAttribute("TitleForeColor");i.Disabled=o&&"false"===o.toLowerCase(),i.AxisLineColor=c?dt(c):null,i.AxisTitleForeColor=l?dt(l):null,i.Disabled=o&&"false"===o.toLowerCase();const u=r.getAttribute("IsReversed");i.IsReversed=u&&"true"===u.toLowerCase(),e.push(i)}return e}function ot(t){const e=new Array,n=(t,n)=>{var a,r,i;const s={};if(!t)return void e.splice(n,0,s);const o=t;s.Title=o.getAttribute("Title");ct(s,o.querySelectorAll("MajorGrid")[0],o.querySelectorAll("MajorTickMark")[0]);const c=o.getAttribute("Enabled");s.Disabled=c&&"false"===c.toLowerCase();const l=o.getAttribute("Interval"),u=o.getAttribute("Minimum"),d=o.getAttribute("Maximum");s.AxisInterval=l?Number(l):null,s.AxisMinimum=u?Number(u):null,s.AxisMaximum=d?Number(d):null;const h=o.querySelectorAll("LabelStyle");h&&h[0]&&h[0].getAttribute("Format")&&(s.FormatString=h[0].getAttribute("Format"));const g=null===(a=null==h?void 0:h[0])||void 0===a?void 0:a.getAttribute("Font");s.LabelFontFamily=g?g.split(/\s*,\s*/)[0]:null,s.LabelFontSize=g?g.split(/\s*,\s*/)[1]:null;const p=null===(r=null==h?void 0:h[0])||void 0===r?void 0:r.getAttribute("ForeColor");s.LabelForeColor=p?dt(p):null;const m=null===(i=null==h?void 0:h[0])||void 0===i?void 0:i.getAttribute("Enabled");s.LabelDisabled=m&&"false"===m.toLowerCase();const b=o.getAttribute("LineColor");s.AxisLineColor=b?dt(b):null;const y=o.getAttribute("TitleForeColor");s.AxisTitleForeColor=y?dt(y):null,e.splice(n,0,s)};let a=t.querySelectorAll("Chart ChartAreas ChartArea AxisY");return a&&n(a[0],0),a=t.querySelectorAll("Chart ChartAreas ChartArea AxisY2"),a&&n(a[0],1),e}function ct(t,e,n){if(t){if(e){const n=e.getAttribute("LineColor"),a=e.getAttribute("Enabled");t.AxisMajorGridColor=n?dt(n):null,t.AxisMajorGridEnabled=a&&"true"===a.toLowerCase()}if(n){const e=n.getAttribute("LineColor"),a=n.getAttribute("Enabled");t.AxisMajorTickMarkColor=e?dt(e):null,t.AxisMajorTickMarkEnabled=a&&"true"===a.toLowerCase()}return t}}function lt(t){const e=t.querySelector("Chart ChartAreas ChartArea Area3DStyle"),n={};return n.Enable3D=!!e&&"true"===e.getAttribute("Enable3D").toLowerCase(),n}function ut(t){const e=t.querySelector("Chart ChartAreas ChartArea"),n={};return n.BackColor=e?e.getAttribute("BackColor"):"",n.BackSecondaryColor=e?e.getAttribute("BackSecondaryColor"):"",n.BackGradientStyle=e?e.getAttribute("BackGradientStyle"):"",n}function dt(t){if(!t)return null;if(function(t){return/^([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])\s*,\s*([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])\s*,\s*([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])$/.test(t)}(t=t.trim()))return String.format("rgb({0})",t);if(function(t){return/#[0-9a-fA-F]{6}/.test(t)}(t))return t;if(function(t){return/^([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])\s*,(\s*([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])\s*,){2}\s*([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])$/.test(t)}(t)){const e=[];t.split(",").forEach(t=>e.push(t.trim()));const n=e.shift(),a=parseFloat(n)/255,r=e.slice();return r.push(a.toString()),String.format("rgba({0})",r.join(","))}return t}var ht=n("z8iZ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function gt(t){return{Text:t&&t.Text||"",HorizontalAlignment:t&&t.HorizontalAlignment||"center",VerticalAlignment:t&&t.VerticalAlignment||null}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class pt{constructor(t,e,n,a,r,i,s,o){this._getState=t,this._chartData=r,this._viewRecord=e,this._visualizationRecord=n,this._chartDataDescription=a,this._chartPresentationXML=i,this._drilldownChartType=s,this._entityLogicalName=o}buildChartModel(){if(this._chartQueryModel=Object(ht.a)(),this._chartData.length>0){this._buildChartHeading();try{this._buildChartPresentation(),this._buildChart()}catch(t){if(!(t instanceof D))throw t;this._buildErrorMessage(t)}}else this._buildDataEmptyMessage();return this._chartQueryModel}_buildDataEmptyMessage(){const t=Object(p.b)(this._getState(),m.l),e=gt();e.Text=this._visualizationRecord&&this._visualizationRecord.get_DisplayName()?this._visualizationRecord.get_DisplayName():t,e.HorizontalAlignment="center",e.VerticalAlignment="middle",this._chartQueryModel.Title=e,this._chartQueryModel.SubTitle=this._viewRecord.get_DisplayName(),this._chartQueryModel.DisplayMode=1,this._chartQueryModel.ErrorInformation=new Q.a,this._chartQueryModel.ErrorInformation.set_ErrorType(null),this._chartQueryModel.ErrorInformation.set_ErrorDescription(t)}_buildErrorMessage(t){this._chartQueryModel.Title=gt(),this._chartQueryModel.SubTitle=this._viewRecord.get_DisplayName(),this._chartQueryModel.DisplayMode=1,this._chartQueryModel.ErrorInformation=new Q.a,this._chartQueryModel.ErrorInformation.set_ErrorType(t.title),this._chartQueryModel.ErrorInformation.set_ErrorDescription(t.description)}_buildChartHeading(){const t=this._visualizationRecord.get_DisplayName();this._chartQueryModel.Title=gt(),this._chartQueryModel.Title.Text=t,this._chartQueryModel.SubTitle=this._viewRecord.get_DisplayName()}_buildChartPresentation(){var t;this._chartPresentationParser=tt(this._getState(),this._chartPresentationXML,this._entityLogicalName),this._drilldownChartType&&this._chartPresentationParser.chartPresentationSeries.forEach(t=>{t.ChartType=this._drilldownChartType}),this._chartPresentationSeries=this._chartPresentationParser.chartPresentationSeries,this._chartPresentationXAxis=this._chartPresentationParser.chartPresentationXAxis,this._chartPresentationYAxis=this._chartPresentationParser.chartPresentationYAxis,this._chartPresentationAnnotationList=this._chartPresentationParser.chartPresentationAnnotationList,this._chartPresentationArea3DStyle=this._chartPresentationParser.chartPresentationArea3DStyle,this._chartPresentationAreaGradientStyle=this._chartPresentationParser.chartPresentationAreaGradientStyle,this._chartQueryModel.Legend={Enabled:t&&t.Enabled||!1},this._chartPresentationParser.chartPresentationLegendList.length>0?this._chartQueryModel.Legend.Enabled=this._chartPresentationParser.chartPresentationLegendList[0].Enabled:this._chartQueryModel.Legend.Enabled=!1,this._colors=this._chartPresentationParser.colorsList}_buildChart(){this._chartParserType=this._getChartParserType();const t=function(t){let e=null;switch(t){case 2:e=new q;break;case 3:e=new W;break;case 1:default:e=new K}return e}(this._chartParserType);t.initialize(this._getState,this._chartData,this._chartDataDescription,this._chartPresentationSeries,this._chartPresentationXAxis,this._chartPresentationYAxis,this._chartPresentationArea3DStyle,this._chartPresentationAreaGradientStyle,this._chartQueryModel,this._chartPresentationAnnotationList),this._chartQueryModel.Colors=this._colors,t.parse()}_getChartParserType(){return this._chartDataDescription.isComparisonChart?2:this._chartDataDescription.category.primaryGroupBy.groupAttribute.dateTimeGrouping?3:1}}var mt=n("haag"),bt=n("0L4T"),yt=n("nxXM"),ft=n("ddoO"),vt=n("q/7h"),Ot=n("Tezb"),Ct=n("WF3G"),St=n("4r2D");function jt(t,e,n){return{type:"chartData.retrieve.core.async",execute({dispatch:a,getState:i},o,c){const l=[];try{const u=i();if(!Object(s.b)(i,a,o,l,t,e,n,!0))return Promise.resolve();const d=new Ct.a(t.fetchXml);d.set_NoLock(!0),d.set_PageSize(t.dataDefinition.entityExpression.top);const h=function(t){const e={};if(null!=t){const n=new Ct.a(t);n.set_PageSize(0),n.set_NoLock(!0),e[""]=n}return e}(t.viewXml);return function(t,e,n,a){const i=new St.a(r.a.toString(r.a.newGuid()),a&&a.isPreloadCall);return t.retrieveEntitiesForAggregateQuery(e,n,i).nativePromise()}(o.DataSource,d,h,c).then(o=>{const c=function(e,n,a){const r=new _t(t.viewTitle,t.viewEntityLogicalName),i=new _t(t.chartName,t.chartPrimaryEntityTypeCode),o=t.dataDefinition,c=Object(vt.a)(e,n());Object(s.e)(o,c,n());const l=t,u=new pt(n,r,i,o,c,t.presentationXml,l.drillDownChartType?l.drillDownChartType:null,a);return u.buildChartModel()}(o,i,e);Object(M.f)(u,L.wg)?(a(At(t.getStorageKey(),c)),Tt(u,a,t.getStorageKey(),n)):(a(xt(r.a.toString(t.visualizationId),r.a.toString(t.viewId),c)),It(u,a,r.a.toString(t.visualizationId),r.a.toString(t.viewId),n))}).catch(e=>{Object(bt.c)(u,a,e,t,n)})}catch(t){return o.EventManager.ReportComponentFailure(s.f+".retrieveChartDataCore",Error(t),mt.b,l),Promise.reject(t)}}}}function It(t,e,n,i,s){if(t){const o=new r.a(n),c=r.a.toString(o),l=new r.a(i),u=r.a.toString(l),d={},h={};if(h[u]=function(t,e,n,r){if(!t)return null;if(r&&""!==r){const i=Object(ft.c)(t,e,n),s=i&&i.slice();return Object(a.a)(s,r)}return null}(t,c,u,s),h[u]){d[c]=h;const t={entities:null,lists:null,charts:d};e(Object(yt.b)(t))}}}function Tt(t,e,n,r){if(t){const i={};if(i[n]=function(t,e,n){if(!t)return null;if(n){const r=Object(ft.b)(t,e),i=r&&r.slice();return Object(a.a)(i,n)}return null}(t,n,r),i[n]){const t={entities:null,lists:null,charts:null,chartData:i};e(Object(yt.b)(t))}}}function xt(t,e,n){const a=new r.a(t),s=r.a.toString(a),o=new r.a(e),c={charts:{[s]:{[r.a.toString(o)]:{initialized:i.a.Initialized,chartConfigObject:n}}}};return{type:Ot.d,payload:c}}function At(t,e){const n={chartData:{[t]:{initialized:i.a.Initialized,chartConfigObject:e}}};return{type:Ot.d,payload:n}}class _t{constructor(t,e){this._displayName=t,this._associatedEntityLogicalName=e,Object.freeze(this)}get_DisplayName(){return this._displayName}get_AssociatedEntityLogicalName(){return this._associatedEntityLogicalName}}},ldGr:function(t,e,n){"use strict";n.d(e,"b",(function(){return S})),n.d(e,"a",(function(){return v})),n.d(e,"c",(function(){return y}));var a=n("SAYH"),r=n("i1f0"),i=n("jRy5"),s=n("dHD5"),o=n("Zpd/"),c=n("NUHF"),l=n("arV0"),u=n("odYE"),d=n("H523"),h=n("Khp3"),g=n("kWiz"),p=n("YxC/"),m=n("bJSG"),b=n("WePp");function y(t,e,n){return{type:"initialize.dependentOptionSet.fields",sync:!0,execute({dispatch:a,getState:r},i,s){const o=f.bind(this,r(),a,t,e,n);!function(t,e,n,a,r){const i=[],s=t.TraceManager.getTracer("initialize.dependentOptionSet.fields");t.TraceManager.setLogLevel(g.a.Info,"initialize.dependentOptionSet.fields"),i.push({name:"CorrelationId",value:e.correlationId},{name:"ContextId",value:e.contextId},{name:"ActionStack",value:e.stack},{name:"PageId",value:a},{name:"EntityTypeName",value:n}),s.info("Executing initialize dependent option set fields action.",i);const o=r(),c={name:"NumCompleteDependentOptionSetChains",value:o[0]},l={name:"CompleteChainsDepth",value:o[1]};i.push(c,o[2],l);const u=new b.a("initialize.dependentOptionSet.fields");u.addEventParameter("NumCompleteDependentOptionSetChains",o[0]),u.addEventParameter("NumPartialDependentOptionSetChainFields",o[2].value),u.addEventParameter("CompleteChainsDepth",o[1]),t.EventManager.ReportEvent(u),s.info("Executed initialize dependent option set fields action successfully.",i)}(i,s,t,e,o)}}}function f(t,e,n,a,o){const c={name:"NumPartialDependentOptionSetChainFields",value:0},d=[];let h=0;const g=Object(s.x)(o),p=Object(r.S)(t,g,n,a),m=function(t,e,n,a){let s;if(e.contextTokenType===i.a.RelatedEntity)s=Object(r.wc)(t,{id:n},e)[e.relationshipName];else{const e=Object(l.j)(t,n);s=new u.a(a,e.id)}return s}(t,o,a,n);for(const r in p){const i=p[r];if(null===i.ParentPicklistLogicalName){const i={name:r,value:0};v(t,o,a,n,p,r,i)?C(t,e,g,a,p,r,o.relationshipName,c):(O(t,e,o,a,m,r),h++,d.push(i))}else void 0===p[i.ParentPicklistLogicalName]&&C(t,e,g,a,p,r,o.relationshipName,c)}return[h,d,c]}function v(t,e,n,a,i,o,c){if(void 0===i[o])return!0;if(function(t,e,n,a,i){const o=Object(l.j)(t,n);if(!Object(r.id)(t,a,null==o?void 0:o.id,n,i))return!0;const c=Object(s.x)(e),u=Object(r.B)(t,n,c,i,e.relationshipName);for(let e=0;e<u.length;e++){const a=Object(r.u)(t,{id:n,controlName:u[e]},c);if(a&&!a.Disabled&&a.Visible)return!1}return!0}(t,e,n,a,o))return!0;const u=i[o].ChildPicklistLogicalNames;if(null!==u)for(let r=0;r<u.length;r++){const s={name:o,value:0};if(v(t,e,n,a,i,u[r],s))return!0;c.value=Math.max(c.value,s.value)}return c.value=c.value+1,!1}function O(t,e,n,a,i,s){const o={},l=Object(r.hc)(t,a,n);o[s]=Object(r.ab)(t,a,n,l,i,s),e(Object(c.b)(a,n,!1,o))}function C(t,e,n,a,i,s,c,l){if(void 0===i[s])return;const u=S(t,[String.format(Object(p.b)(t,m.a))],d.a.information);Object(r.B)(t,a,n,s,c).forEach(t=>{e(Object(o.b)(a,t,n,!0)),e(Object(h.b)(a,t,u,n)),l.value=l.value+1});const g=i[s].ChildPicklistLogicalNames;if(g)for(let r=0;r<g.length;r++)C(t,e,n,a,i,g[r],c,l)}function S(t,e,n){return{uniqueId:a.a.toString(a.a.newGuid()),messages:e,notificationLevel:n,actions:null}}},ldWj:function(t,e,n){"use strict";n.d(e,"a",(function(){return m}));var a=n("0nOn"),r=n("ScMg"),i=n("i1f0"),s=n("Sbn7"),o=n("16wZ"),c=n("vlcQ"),l=n("3MuQ"),u=n("qshH"),d=n("ZIjf"),h=n("IaGr"),g=n("zmL5");let p;class m extends r.a{constructor(t,e,n,r,i,s){super(t,e,n,r),this._parent=i,p=t,this._formContext=s,this._iConnectedSectionProp={sectionName:this.name,id:this.pageId},this._clientApiExecutorTabSection=new a.a(t,"ClientApi.XrmTabSection.",n,e),this.clientApiExecutor.addEventParameter({name:"controlName",value:r,isEventParam:!0})}get clientApiExecutor(){return this._clientApiExecutorTabSection}get controls(){return this.clientApiExecutor.execute("controls",(t,e)=>{if(!this._controls){const n=p.getState();this._controls=new s.a(t);const a=this.getControlsDescriptor(n);if(!a)return this._controls;for(const n in a){const a=this._formContext.ui.controls.get(n);if(a)this._controls.add(a.getName(),a);else{const a=e.slice();a.push({name:"controlKey",value:n}),h.a.getInstance().traceManager.getTracer(t).warn("Section control was not found in the form controls collection",a)}}}return this._controls})}getParent(){return d.a.instance.reportUsage("ClientApi.XrmTabSection.getParent"),this._parent}getVisible(){const t="ClientApi.XrmTabSection.getVisible";try{d.a.instance.reportCall(t);const e=Object(i.Bc)(p.getState(),this._iConnectedSectionProp,this.contextToken),n=Object(o.a)(e)?this._getSectionDescriptorValues().Visible:e;return d.a.instance.reportSuccess(t),n}catch(e){const n=u.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),u.a.getInstance().reportFailure(t,e,null,n),e}}getLabel(){const t="ClientApi.XrmTabSection.getLabel";try{d.a.instance.reportCall(t);const e=Object(i.zc)(p.getState(),this._iConnectedSectionProp,this.contextToken),n=Object(o.a)(e)?this._getSectionDescriptorValues().Label?this._getSectionDescriptorValues().Label:"":e;return d.a.instance.reportSuccess(t),n}catch(e){const n=u.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),u.a.getInstance().reportFailure(t,e,null,n),e}}_getSectionDescriptorValues(){var t;try{const e=Object(g.b)(p.getState(),this.pageId);return Object(i.yc)(p.getState(),e,null===(t=this._iConnectedSectionProp)||void 0===t?void 0:t.sectionName,this.pageId,this.contextToken)}catch(t){const e=u.a.getInstance().getEventParameters(this.contextToken);throw e.push({name:"controlName",value:this.name}),u.a.getInstance().reportFailure("ClientApi.XrmTabSection._getSectionDescriptorValues",t,null,e),t}}getControlsDescriptor(t){try{return Object(i.K)(t,this._iConnectedSectionProp,this.contextToken)}catch(t){const e=u.a.getInstance().getEventParameters(this.contextToken);throw e.push({name:"controlName",value:this.name}),u.a.getInstance().reportFailure("ClientApi.XrmTabSection.getControlsDescriptor",t,null,e),t}}setVisible(t){const e="ClientApi.XrmTabSection.setVisible";try{d.a.instance.reportCall(e),p.dispatch(Object(c.c)(this.pageId,this.contextToken,this.name,!0===t)),d.a.instance.reportSuccess(e)}catch(t){const n=u.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),u.a.getInstance().reportFailure(e,t,null,n),t}}setLabel(t){const e="ClientApi.XrmTabSection.setLabel";Object(o.a)(t)&&Object(o.j)(e,"label");try{d.a.instance.reportCall(e),p.dispatch(Object(l.b)(this.pageId,this.contextToken,this.name,t)),d.a.instance.reportSuccess(e)}catch(t){const n=u.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),u.a.getInstance().reportFailure(e,t,null,n),t}}}},"m+2h":function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return i}));var a=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const r="footer.visible";function i(t,e,n){const i=Object(a.w)(e);return{type:r,payload:n,meta:{pageId:t,contextKey:i}}}},mFPv:function(t,e,n){"use strict";n.d(e,"a",(function(){return h})),n.d(e,"b",(function(){return d})),n.d(e,"c",(function(){return l})),n.d(e,"d",(function(){return u}));var a=n("65OV"),r=n("odYE"),i=n("SAYH"),s=n("dHD5"),o=n("pGYJ"),c=n("wgH2");function l(t,e,n,l,d,h,g,p,m,b){return{type:"retrieve.recordCommand.async",execute({dispatch:y,getState:f},v){const O=[];for(const t in e)if(-1!==d.indexOf(t)){const n=e[t].getNamedReference();O.push(new r.a(n.entityName,new i.a(n.id),n.name))}return Object(a.a)(f(),t,n,Object(s.w)(l),O,y,h,false,g,p,m,b).then(t=>u(t,y),t=>{const e=Object(c.c)(f(),n),a=(e?e.CustomControlType:o.a)+".CustomControl.Commanding.retrieveRecordCommand";throw v.EventManager.ReportComponentFailure(a,t,"retrieveRecordCommand failure",[{name:"APIName",value:o.a+".Actions.retrieveRecordCommand"},{name:"commandManagerId",value:n},{name:"contextToken",value:JSON.stringify(l)},{name:"records",value:JSON.stringify(d)},{name:"commandButtonIds",value:JSON.stringify(h)},{name:"filterByPriority",value:g},{name:"useNestedFormat",value:JSON.stringify(p)},{name:"controlConstructorName",value:m},{name:"refreshAllRules",value:JSON.stringify(b)}]),t})}}}function u(t,e){const n=[];for(let a=0;a<t.length;a++){const r=t[a];n.push({commandButtonId:r.commandButtonId,commandId:r.commandId,label:r.label,canExecute:r.canExecute,shouldBeVisible:r.shouldBeVisible,tooltip:r.tooltip,icon:r.icon,children:u(r.children,e),controlType:r.controlType,execute:()=>e(r.execute)})}return n}function d(t,e,n,a,r){return{type:"initialize.customControl.command",payload:{contextKey:Object(s.w)(e),commandManagerId:a,controlId:n,ribbonId:r},meta:{pageId:t}}}function h(t,e,n,a){return{type:"pending.customControl.command",payload:{contextKey:Object(s.w)(e),commandManagerId:a,controlId:n},meta:{pageId:t}}}},mIxf:function(t,e,n){"use strict";n.d(e,"a",(function(){return tt}));var a=n("sX6v"),r=n("BXEF"),i=n("WPtp"),s=n("arV0"),o=n("i1f0"),c=n("mL5Q"),l=n("f/sd"),u=n("odYE"),d=n("WY/A"),h=n("RrRQ"),g=n("bT7G"),p=n("qTme"),m=n("4UCL"),b=n("SAYH"),y=n("Dea/"),f=n("JP46"),v=n("dHD5"),O=n("3tOH"),C=n("Bj/n"),S=n("YxC/"),j=n("EY5k"),I=n("ZPAw"),T=n("3hnk"),x=n("aF0N"),A=n("LbMF"),_=n("/A0C"),N=n("y60j"),E=n("504W"),P=n("NUHF"),w=n("Zzxs"),F=n("3/02"),k=n("dpM5"),D=n("Lyxw"),M=n("5Oca"),L=n("3HPu"),R=n("qpML"),X=n("jTSi"),V=n("qLnS"),U=n("ZXdP"),G=n("xy1J"),B=n("zmL5"),Y=n("O7zD"),z=n("0Vvg"),H=n("+Zk2"),q=n("wL2W"),W=n("AULO"),K=n("iTMV"),Q=n("4aOd"),Z=n("jq7Z"),J=n("5sJC"),$=n("5iTp");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function tt(t,e,n,I,L,R,X,Y,nt=!1){return{type:H.d,sync:!0,execute({dispatch:at,getState:rt},it){var st;const ot=rt();let ct,lt;const ut=Object(s.j)(ot,t),dt=X&&L&&R,ht=!!L;let gt;if(dt){const e=Object(x.c)(ot),n=Object(x.b)(ot);(e||n)&&"Dashboard"!==Object(s.p)(ot,t)||(I=!0),lt=Object(v.f)(Y,new b.a(R),L),ct=new u.a(L,new b.a(R))}else ht?(lt=Y,ct=new u.a(L,R?new b.a(R):b.a.EMPTY),gt=lt.relationshipName):(lt=Y||Object(v.j)(ot,t),ct=new u.a(ut.entityTypeName,ut.id));let pt=Object(o.hc)(ot,t,lt),mt=!n||ut.isOfflineSyncError;mt&&!ut.isOfflineSyncError&&(Object(c.a)(ot,t)<l.a.OnLoadReady||Object(o.pb)(ot,{id:t},lt))&&(mt=!1);const bt=mt?function(t,e,n,a){const r={};for(const i in e)r[i]=Object(g.e)(t,a,n,i);return r}(ot,e,ct,pt):void 0,yt=Object(f.a)(ot,pt,ct,e,!0,Object(v.t)(lt),it.TraceManager.getTracer(H.e),t,at,gt,n,!1,nt),ft=Object.keys(yt);if(0===ft.length)return;if(ut.isOfflineSyncError){let e=!0;for(let n=0;n<Object.keys(yt).length;n++){const a=Object(B.b)(ot,t);if(!Object(E.a)(a)){const t=Object(N.h)(ot,a);if(!Object(E.a)(t)&&Object(E.a)(t.Controls[Object.keys(yt)[n]])){e=!1;break}}if(e=Object(o.kd)(ot,t)?Object(T.f)(ot,ct.etn,Object.keys(yt)[n],V.a.CanCreate,null==ct?void 0:ct.id):Object(T.f)(ot,ct.etn,Object.keys(yt)[n],V.a.CanUpdate,null==ct?void 0:ct.id),!e)break}let n="LOCID_RESOLVE_INFO_TEXT",a=O.a.information;e||(n="LOCID_RESOLVE_WARNING_TEXT",a=O.a.warning),at(Object(j.e)([n])).then(()=>{at(Object(C.c)(lt,t,Object(S.b)(rt(),n),a,w.d))})}const vt=b.a.isNullOrEmpty(ct.id)?y.a.Create:y.a.Update,Ot=Object(v.w)(lt),Ct=Object(g.b)(ot,pt),St=Object.keys(e),jt=[],It=Object(A.d)(ot,ct.etn),Tt=Object(D.f)(ot,F.Od)&&Object(D.f)(ot,k.l),xt=Object(D.f)(ot,F.Qd)&&Object(D.f)(ot,k.l),At=Object(o.kd)(ot,t);for(const n of St){const a=It[n];if(!At||a&&(a.Type===_.a.MultiSelectPickList||a.Type===_.a.Image||a.Type===_.a.File)){const r=Object(M.j)(ot,ct,n);if((yt[n]&&!Object(f.b)(r,yt[n],ot,!0)||!Tt&&a&&a.Type===_.a.File||!xt&&a&&a.Type===_.a.Image)&&jt.push(n),(Tt&&a&&a.Type===_.a.File||xt&&a&&a.Type===_.a.Image)&&yt[n]&&e&&e[n])if(e[n].value){if("string"!=typeof e[n].value){const a=e[n].value;et(rt,a,n,at,lt,t,ct,it)}}else at(Object(z.a)(ct,n,t))}}if(pt&&Ct&&(u.a.equals(ct,Ct.identifier)||vt===y.a.Create))at(Object(a.b)(ot,pt,yt));else{pt&&at(Object(h.c)(t,pt,lt));const e=Object(d.b)(ot,ct,yt,Ot,vt),n=e.payload.snapshotId;at(e),at(Object(p.b)(t,n,lt)),pt=n}const _t={Label:Object(S.b)(ot,G.n),Handler:()=>{at(Object(J.a)(W.b))}};if(mt&&(at(Object(m.c)(t,lt,bt)),Object(q.a)()&&(!function(t,e,n,a,r){var s,c,l;const u=new Q.a(new Error);let d=null==u?void 0:u.getStackTrace();(null==d?void 0:d.includes("onOutputChanged"))&&(d="The change was manually done by the user.");const h=null===(s=Object.keys(r))||void 0===s?void 0:s[0],g=Object(o.B)(t,n,e,h),p=Object(i.c)(null===(c=Object.values(r))||void 0===c?void 0:c[0]),m=a?Object(i.c)(a[h]):null,b=Object(Z.b)(t,n,e),y=null===(l=Object(N.h)(t,b))||void 0===l?void 0:l.Name,f=Object(W.h)(y,h);Object(W.f)(y,h)[h]=p,f.push({message:`Attribute with name '${h}' has been modified. The change could be coming from any of the below controls:`,controlNames:g,previousValue:m,newValue:p,callStack:d})}(ot,lt,t,bt,yt),Object($.b)(ot)&&at(Object(C.c)(lt,t,Object(S.b)(ot,G.o),O.a.information,w.e,[_t])))),Object(q.a)()){const t=new Q.a(new Error),e=null==t?void 0:t.getStackTrace();if(null==e?void 0:e.includes("setValueInternal")){const t={};for(const n in yt)t[n]={value:yt[n],source:"Value passed in a client API script",callStack:e};Object(K.c)(t)}}if(Object(D.f)(ot,F.pb)){const e=function(t,e,n){const a=Object(A.e)(t,e,Object.keys(n)),r={};if(a&&Object.keys(a).length>0){for(const t in a)r[t]=n[t];if(Object.keys(a).length>1)for(const t in a)a[t].ParentPicklistLogicalName&&delete r[t]}return r}(ot,ct.etn,yt);at(Object(P.b)(t,lt,!0,e,n,I,L,R,X))}if(!I){if(!it.ScriptManager.containerExists(t)){const e=JSON.stringify(ft),n=[{name:"pageId",value:t},{name:"changeKeys",value:e}],a=`Could not get container or event manager. pageId: ${t}, changesKeys ${e}.`;it.EventManager.ReportComponentFailure(H.e,Error(a),void 0,n)}const n=it.ScriptManager.getContainer(t).getEventManager();for(const t in e)yt[t]&&yt[t].validationResult&&(yt[t].validationResult.isValueValid||yt[t].validationResult.errorId===H.a)&&at(n.runOnChange(dt?Y:lt,t,void 0,dt?R:void 0))}if(jt.length>0&&pt&&at(Object(r.a)(pt,jt)),e[H.c]){const e=Object(A.d)(ot,ut.entityTypeName),n={};for(const t in e){const a=e[t];a.Type.toLowerCase()===_.a.Money&&(n[a.LogicalName]=Object(g.e)(ot,pt,ct,a.LogicalName))}if(Object(q.a)()&&(null===(st=Object.keys(n))||void 0===st?void 0:st.length)>0){const t={};for(const e in n)t[e]={value:n[e],source:"Updated based on the current currency symbol"};Object(K.c)(t)}at(tt(t,n,!0,!0,L,R,X,lt))}at(Object(U.c)(t,lt))}}}function et(t,e,n,a,r,i,s,o){const c=t(),l=Object(A.a)(c,s.etn,n),u=l.Type===_.a.File?String.format(Object(S.b)(t(),G.f),l.DisplayName):String.format(Object(S.b)(t(),G.i),l.DisplayName);nt(c,a,r,n,i,!1,O.a.information,u);const d=[];d.push({name:"Attribute Type",value:l.Type});const h=o.TraceManager.getTracer(H.b);return h.info("Uploaded started for file/image type attribute.",d),a(Object(I.c)(e,n,s,i)).then(()=>{h.info("Uploaded successfully completed for file/image type attribute.",d);const e=t();Object(M.k)(t(),s,n)===R.b.Finished&&nt(e,a,r,n,i,!0)}).catch(e=>{const o=Object(M.k)(t(),s,n),c=t();if(o===R.b.Failed){d.push({name:"Error",value:e.message}),h.error("Uploaded failed for file/image type attribute.",d);const s=String.format(Object(S.b)(t(),G.h),l.DisplayName);nt(c,a,r,n,i,!0,O.a.warning,s)}else if(o===R.b.Cancelled){h.info("Uploaded cancelled for file/image type attribute.",d);const e=l.Type===_.a.File?String.format(Object(S.b)(t(),G.g),l.DisplayName):String.format(Object(S.b)(t(),G.j),l.DisplayName);nt(c,a,r,n,i,!0,O.a.information,e)}else nt(c,a,r,n,i,!0);throw e})}function nt(t,e,n,a,i,s,c,l){if(e(Object(L.b)(i,a,s,n)),s){const s=[];s.push(a);const c=Object(o.hc)(t,i,n);e(Object(r.a)(c,s)),e(Object(X.b)(n,i,Object(Y.d)(i,a)))}l&&c&&e(Object(C.c)(n,i,l,c,Object(Y.d)(i,a)))}},meVR:function(t,e,n){"use strict";n.d(e,"a",(function(){return x}));var a=n("+zjj"),r=n("+Ajx"),i=n("6Qf/"),s=n("P6DH"),o=n("d0w6"),c=n("KBcj"),l=n("vNXc"),u=n("a72m"),d=n("BFlg"),h=n("pEXn"),g=n("5R5s"),p=n("hSDL"),m=n("aF0N"),b=n("Ii8m"),y=n("69Qu"),f=n("jAuy"),v=n("eXjw"),O=n("Lyxw"),C=n("3/02");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const S=`${d.N}.${d.L}`;function j(t,e,n,a,r,o,u,d,h,m){const b=T(a,u,h),v=Object(c.c)(e,n);if(!v)return Promise.resolve(null);const S=l.a.fromXmlAndSql(v.fetchXML,v.offlineSqlQuery,n).getQueryState(),j=m||Object(s.gb)(e,a,u),x=Object(f.c)(r,o);let A=!1;Object(y.c)(e)&&Object(f.h)(e,o.relationshipName,!0)&&(A=!0);const _=Object(s.xb)(e,a);if(_||"activitypointer"===a||A){const n=e.user&&e.user.userId,s=Object(O.f)(e,C.ag),c=Object(g.a)(a,n,o,s,_);return t(c.getFilterOptionsAction()).then(n=>{if(n&&n.length>0){const e=n.filter(t=>t.isDefault);if(e&&e.length>0){const n=c.getFilterExpression(e[0].value);t(Object(p.l)(n,r,o))}}return t(Object(i.d)(S,a,r,o,null,u,j,A,x)).then(n=>I(t,n,e,a,r,b,d))})}return t(Object(i.d)(S,a,r,o,null,u,j,void 0,x)).then(n=>I(t,n,e,a,r,b,d))}function I(t,e,n,a,r,o,c){const l=Object(m.c)(n),u=Object(m.b)(n);return(l||u)&&Object(s.vb)(n,a)&&Object(i.e)(c,t,a,r),c.EventManager.ReportComponentSuccess("Forms.OpenRelatedGrid.initializeRelatedGrid",o),c.EventManager.ReportComponentSuccess(S,o),e}function T(t,e,n){return[{name:h.a.CorrelationId,value:n.correlationId},{name:h.a.ContextId,value:n.contextId},{name:h.a.ActionStack,value:n.stack},{name:"entityName",value:t},{name:"relationshipName",value:e}]}function x(t,e,n){const i=[{name:"EntityName",value:n.entityName}];return{type:"form.related.openGrid",execute({dispatch:i,getState:l},d,g){const p=l(),m=Object(a.e)(p,{id:t},e.parentContextToken),y=T(n.entityName,n.relationshipName,g);if(i(Object(r.b)(t,e,n)),null!==m&&m.id===n.id&&m.isSelected===n.isSelected&&m.relationshipName===n.relationshipName||i(Object(r.b)(t,e.parentContextToken,n)),i(Object(b.a)(t,n)),n&&!n.url){const a=function(t,e){return[{name:h.a.CorrelationId,value:t.correlationId},{name:h.a.ContextId,value:t.contextId},{name:h.a.ActionStack,value:t.stack},{name:"hasViewId",value:!0},{name:"entityName",value:e}]}(g,n.entityName);if(!Object(s.v)(p,t,e)){i(Object(u.b)(n.entityName,o.a.MAIN_APPLICATION_VIEW));const r=Object(c.a)(p,n.entityName,o.a.SUB_GRID),s=Object(c.c)(p,r);return s&&s.initialized===v.a.Initialized?(j(i,p,r,n.entityName,t,e,n.relationshipName,d,g,n.ordinal).catch(t=>{d.EventManager.ReportComponentFailure(S,t,null,y)}),d.EventManager.ReportComponentSuccess("Forms.OpenRelatedGrid",a),Promise.resolve(r)):i(Object(u.a)(n.entityName,o.a.SUB_GRID)).then(r=>{const s=l();return j(i,s,r,n.entityName,t,e,n.relationshipName,d,g,n.ordinal).catch(t=>{d.EventManager.ReportComponentFailure(S,t,null,y)}),d.EventManager.ReportComponentSuccess("Forms.OpenRelatedGrid",a),r},t=>{d.EventManager.ReportComponentFailure(S,t,null,y)})}}return Promise.resolve(null)},getFailureParameters:(t,e)=>i}}},mhYf:function(t,e,n){"use strict";n.d(e,"a",(function(){return h})),n.d(e,"b",(function(){return g}));var a=n("dHD5"),r=n("i1f0"),i=n("TYIz"),s=n("+zjj"),o=n("wL2W"),c=n("4aOd"),l=n("pEXn"),u=n("+Qpx"),d=n("tWr6");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const h="tab.visible";function g(t,e,n,g,p){return{type:"tab.visible.sync",sync:!0,execute({dispatch:m,getState:b},y){var f;const v=b();m(function(t,e,n,r){const i=Object(a.w)(n);return{type:h,payload:r,meta:{pageId:t,tabId:e,contextKey:i}}}(t,e,n,g));const O=Object(r.Ec)(v,{id:t},n),C=Object(s.e)(v,{id:t},n);if(O||(null==C?void 0:C.isSelected)||!g){if(O===e&&!g){const a=Object(r.ib)(v,{id:t},n);let s=!1;if(a){const o=Object(r.o)(v,a,t);for(const a of o)if(a.Id!==e&&Object(r.Tc)(v,a.Id,t,n)){s=!0,m(Object(i.b)(t,a.Id,n));break}}s||m(Object(i.b)(t,void 0,n))}}else m(Object(i.b)(t,e,n));if(Object(o.a)()){const a=b(),i=null===(f=null==y?void 0:y.TraceManager)||void 0===f?void 0:f.getTracer(`${u.u}${u.H}`),s=Object(r.Tc)(v,e,t,n),o=Object(r.Tc)(a,e,t,n),h=Object(d.a)(a,t);h.push({name:"tabId",value:e}),h.push({name:"tabName",value:Object(r.Rc)(a,e,t,n)}),h.push({name:"tabLabel",value:Object(r.Qc)(a,e,t,n)}),h.push({name:"visible state before change",value:null==s?void 0:s.toString()}),h.push({name:"visible state after change",value:null==o?void 0:o.toString()}),p&&h.push({name:"reason",value:p}),h.push({name:"callstack",value:new c.a(new Error).getStackTrace()}),null==i||i.warn(u.B,[{name:l.l,value:u.H+".visible"},{name:u.H,value:JSON.stringify(h)}])}}}}},mlKL:function(t,e,n){"use strict";n.d(e,"a",(function(){return d})),n.d(e,"b",(function(){return h}));var a=n("arV0"),r=n("jRy5"),i=n("dHD5"),s=n("ApeL"),o=n("i1f0"),c=n("mIxf"),l=n("bT7G"),u=n("WPtp");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const d="attribute.requiredLevel";function h(t,e,n,h){return{type:"attribute.requiredLevel.validation",sync:!0,execute(g,p){const m=g.getState();if(h!==Object(o.xc)(m,t,e,n)){g.dispatch(function(t,e,n,a){if(e&&e.contextTokenType&&e.contextTokenType===r.a.GridRow)return Object(s.f)(t,e,n,a);const o=Object(i.y)(e);return{type:d,payload:a,meta:{pageId:t,contextKey:o,dataFieldName:n}}}(t,e,n,h));const p=Object(o.hc)(m,t,e),b=Object(l.b)(m,p);if((0===h||3===h)&&b&&b.activeChanges&&b.activeChanges[n]||e&&e.contextTokenType&&e.contextTokenType===r.a.GridRow){let s=null,d=null,h=null,b=null;if(e&&e.contextTokenType&&e.contextTokenType===r.a.GridRow)s=e.entityTypeName?e.entityTypeName:null,d=e.recordId?e.recordId:null,h=Object(i.u)(e),b=Object(i.s)(e);else{const n=Object(a.j)(m,t);s=n&&n.entityTypeName?n.entityTypeName:null,d=n&&n.id?n.id:null,h=null,b=e}const y=Object(l.e)(m,p,{etn:s,id:d},n);if(Object(o.gd)(y)){const e={[n]:{fieldName:n,value:y?y.formatted?y:Object(u.e)(y):y}};g.dispatch(Object(c.a)(t,e,!0,!0,s,d?d.guid:null,h,b))}}}}}}},nfCs:function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return s})),n.d(e,"a",(function(){return r}));var a=n("fKWG");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function r(t){if(t<a.a.DAY||t>a.a.FISCAL_YEAR)throw new RangeError("Argunment out of range");return{groupingType:t}}function i(t){if(!t)return-1;switch(t){case"day":return a.a.DAY;case"week":return a.a.WEEK;case"month":return a.a.MONTH;case"year":return a.a.YEAR;case"quarter":return a.a.QUARTER;case"fiscal-period":return a.a.FISCAL_PERIOD;case"fiscal-year":return a.a.FISCAL_YEAR;default:return-1}}function s(t){switch(t){case a.a.DAY:return"day";case a.a.WEEK:return"week";case a.a.MONTH:return"month";case a.a.YEAR:return"year";case a.a.QUARTER:return"quarter";case a.a.FISCAL_PERIOD:return"fiscal-period";case a.a.FISCAL_YEAR:return"fiscal-year";default:return null}}},pp6D:function(t,e,n){"use strict";n.d(e,"b",(function(){return M})),n.d(e,"a",(function(){return D})),n.d(e,"c",(function(){return R})),n.d(e,"e",(function(){return X})),n.d(e,"d",(function(){return V}));var a=n("2yvP"),r=n("SAYH"),i=n("jRy5"),s=n("IaGr"),o=n("9ksH"),c=n("tpZ5"),l=n("G0J3"),u=n("COKI"),d=n("uOtn"),h=n("OtHk"),g=n("Zw8F"),p=n("pnQK"),m=n("0nOn"),b=n("+baL");let y;class f extends g.a{constructor(t,e,n,a){super(t,e,n,a),this._dashboardId=t,y=n,this.clientApiExecutor=new m.a(n,"ClientApi.XrmDashboardSelectorItem.",a)}_getEventParams(){return this._commonEventParams||(this._commonEventParams=[{name:"dashboardId",value:r.a.toString(this._dashboardId),isRequired:!1,isEventParam:!0}])}get isBoundDashboard(){return this.clientApiExecutor.execute("isBoundDashboard_get",()=>{const t=Object(p.a)(y.getState(),this._dashboardId);return!t||1032==+t.Type},this._getEventParams())}get isUserDashboard(){return this.clientApiExecutor.execute("isUserDashboard_get",()=>{const t=Object(p.a)(y.getState(),this._dashboardId);return Object(p.c)(t)},this._getEventParams())}navigate(){this.clientApiExecutor.executeAsync("navigate",()=>y.dispatch(Object(b.a)(null,this._dashboardId,null,null,null,null,this.getPageId())),this._getEventParams())}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class v extends d.b{constructor(t,e,n,a,r){let i=h.c;if(a){const e=t.getState(),r=Object(h.g)(e,a);r&&r[n.guid]&&(i=h.g)}super(t,e,n,a,r,i,f)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class O extends u.a{constructor(t,e,n,a,r,i){super(t,e,n,a,r,i,v)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let C;class S extends l.a{constructor(t,e,n,a,r,i){super(t,e&&e.etn,a,r,()=>O,n),C=t,this._getCommands=i,this._apiExecutor=new m.a(t,"ClientApi.XrmDashboard.",r,a)}get commands(){return this._apiExecutor.execute("commands_get",()=>this._commands||(this._commands=this._getCommands(C,this.contextToken,this.pageId)))}}var j=n("HAeo"),I=n("zgeC"),T=n("ywwS"),x=n("ghNp"),A=n("i1f0"),_=n("qshH"),N=n("E7fB"),E=n("16wZ"),P=n("T6Zt"),w=n("WePp"),F=n("HRnw"),k=n("Z/4N");function D(t,e,n,a){return L((n,r)=>new S(n,r,new o.b(n,e),t,e,a),"clientapi.create.xrmdashboard","ClientApi.XrmCommandObjectFactory.createXrmDashboard",t,e,n,!1)}function M(t,e,n,a){return L((n,a)=>new c.a(n,a,new o.b(n,e),t,e),"clientapi.create.xrmform","ClientApi.XrmCommandObjectFactory.createXrmForm",t,e,n,!0,a)}function L(t,e,n,i,o,c,l,u){return{type:e,sync:!0,execute(e,d){Object(E.g)(i,n,"contextToken"),Object(E.g)(o,n,"pageId"),l&&Object(E.g)(c,n,"entityTypeName");try{let n=e.dispatch(Object(x.b)(o,i));if(!n||n.entityReference.id!==r.a.toString(u)){if(n){const t=new w.a("clientapi.removecache.xrmform");s.a.getInstance().eventManager.ReportEvent(t),e.dispatch(Object(x.h)(o,i))}n=t(e,{etn:c,id:u}),n.applicationContext=d;const r=new N.a(e,o);if(n.context=r,!i.parentContextToken){const t=d.ClientApiManager.getClientApiEntry(o);Object(a.b)("form.initialization",()=>{t.xrmInstance.Page=n}),t.primaryContextToken=i}}return n}catch(t){const e=_.a.getInstance().getEventParameters(i);throw e.push({name:"entityTypeName",value:c}),s.a.getInstance().eventManager.ReportComponentFailure(n,t,null,e),t}}}}function R(t,e,n,a,r,o){const c="ClientApi.XrmCommandObjectFactory.createXrmGrid";return{type:"clientapi.create.xrmgrid",sync:!0,execute(l,u){Object(E.g)(t,c,"contextToken"),Object(E.g)(e,c,"pageId");const d=Object(F.a)(l.getState(),Object(k.e)(l.getState(),o));try{let o=l.dispatch(Object(x.c)(e,t));if(!o){if(3===a){const i=Object(A.u)(l.getState(),{id:e,controlName:r},t.parentContextToken);if(i){const a=l.dispatch(Object(x.b)(e,t.parentContextToken));return new I.a(l,t.parentContextToken,e,r,n,a,i,u,d)}const o=_.a.getInstance().getEventParameters(t);o.push({name:"controlName",value:r}),o.push({name:"gridType",value:a}),s.a.getInstance().eventManager.ReportComponentFailure(c,new Error("Control descriptor could not be found for subgrid control"),null,o)}if(o=new j.a(l,t,e,n,a,!1,u,r,d),!t.parentContextToken&&t.contextTokenType===i.a.MainGrid){u.ClientApiManager.getClientApiEntry(e).primaryContextToken=t}}return o}catch(e){const n=_.a.getInstance().getEventParameters(t);throw n.push({name:"controlName",value:r}),n.push({name:"gridType",value:a}),s.a.getInstance().eventManager.ReportComponentFailure(c,e,null,n),e}}}}function X(t,e,n,a){const r="ClientApi.XrmCommandObjectFactory.registerNewControl";return{type:"clientapi.create.xrmTimeline",sync:!0,execute(i,o){Object(E.g)(t,r,"contextToken"),Object(E.g)(e,r,"pageId"),Object(E.g)(n,r,"controlName"),Object(E.g)(a,r,"controlId");try{const c=i.dispatch(Object(x.b)(e,t.parentContextToken));let l=null;const u=n.split(".");if("notescontrol"===u[u.length-1]){if(l=i.dispatch(Object(x.f)(e,t)),!l){const r=Object(A.u)(i.getState(),{id:e,controlName:"notescontrol"},t.parentContextToken);l=new T.a(i,t.parentContextToken,e,r,n,a,c,o)}}else{const e=_.a.getInstance().getEventParameters(t);e.push({name:"controlName",value:n}),s.a.getInstance().eventManager.ReportComponentFailure(r,new Error("Failed to create and return the control"),null,e)}return l}catch(e){const a=_.a.getInstance().getEventParameters(t);throw a.push({name:"controlName",value:n}),s.a.getInstance().eventManager.ReportComponentFailure(r,e,null,a),e}}}}function V(t,e){const n="ClientApi.XrmCommandObjectFactory.createXrmKBSearch";return{type:"clientapi.create.xrmkbsearch",sync:!0,execute(a,r){Object(E.g)(t,n,"contextToken"),Object(E.g)(e,n,"pageId");try{let n=a.dispatch(Object(x.g)(e,t));if(!n&&(n=new P.a(a,t,e),!t.parentContextToken)){const a=r.ClientApiManager.getClientApiEntry(e);a.xrmInstance.Page=n,a.primaryContextToken=t}return n}catch(e){const a=_.a.getInstance().getEventParameters(t);throw s.a.getInstance().eventManager.ReportComponentFailure(n,e,null,a),e}}}}},"r/aD":function(t,e,n){"use strict";n.d(e,"d",(function(){return u})),n.d(e,"c",(function(){return d})),n.d(e,"a",(function(){return h})),n.d(e,"b",(function(){return g}));var a=n("i1f0"),r=n("arV0"),i=n("PUjk"),s=n("IaGr"),o=n("2Ct/"),c=n("odYE"),l=n("g6bs");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function u(t,e,n,i=!1){if(!t)return s.a.getInstance().traceManager.getTracer(n).error("isXrmProcessControlClientApiSupportedOnForm invoked with unexpected null state object"),!1;if(!e)return s.a.getInstance().traceManager.getTracer(n).error("isXrmProcessControlClientApiSupportedOnForm invoked with unexpected null pageId object"),!1;const u=function(t,e){const n=Object(r.j)(t,e);if(!n)return null;const{entityTypeName:a,id:i}=n;return new c.a(a,i)}(t,e),d=!Object(a.Qb)(t,e)&&(Object(o.e)(t)||!Object(o.h)(t,null==u?void 0:u.etn))&&(i||!Object(l.d)(t,u,e)),h=p(e,t);return h.push({name:"xrmProcessControlClientApiIsSupported",value:d}),s.a.getInstance().eventManager.ReportComponentSuccess(n,h),d}function d(t,e,n,a){if(!t&&(s.a.getInstance().traceManager.getTracer(a).error("getProcessManagerWithJitInitIfNeeded invoked with unexpected null processManager",p(n,e.getState())),u(e.getState(),n,a))){s.a.getInstance().traceManager.getTracer(a).error("getProcessManagerWithJitInitIfNeeded invoking JIT initialization of process manager",p(n,e.getState()));const t=Object(r.j)(e.getState(),n);return Object(i.b)(n,t)}return t}function h(t,e,n,a){return[{name:"pageId",value:t},{name:"formType",value:Object(r.p)(e,t)},{name:"InitialXrmProcessControlIsNotNull",value:n},{name:"XrmEntityIsNotNull",value:a}]}function g(t,e,n){return[{name:"pageId",value:t},{name:"formType",value:Object(r.p)(e,t)},{name:"getProcessManagerInvoked",value:n}]}function p(t,e){return[{name:"pageId",value:t},{name:"formType",value:Object(r.p)(e,t)}]}},rs6x:function(t,e,n){"use strict";n.d(e,"a",(function(){return v}));var a=n("SAYH"),r=n("arV0"),i=n("ruPX"),s=n("kX6F"),o=n("Nb1E"),c=n("odYE"),l=n("iZ7K"),u=n("504W"),d=n("lEFU"),h=n("IqkD"),g=n("69Qu"),p=n("i1f0"),m=n("nC8a"),b=n("E8F2"),y=n("SoKF"),f=n("dHD5");function v(t,e,n,c){const v=[{name:"formId",value:t},{name:"pageName",value:n}];return{type:"form.change",async execute({dispatch:C,getState:S},j,I){const T=S();if(Object(m.a)(T,e))throw Object(b.b)(T,e,2200000016);const{entityTypeName:x,id:A,recordSetQueryKey:_,data:N,createFromRelationship:E,initWithEntity:P,ids:w}=Object(r.j)(T,e);v.push({name:"entityTypeName",value:x});const F=a.a.tryParse(t),k={entityTypeName:x,formId:F,id:c?a.a.tryParse(c):A,recordSetQueryKey:_,data:N,createFromRelationship:E,initWithEntity:P,ids:w},D=F.guid.toString(),M=`<MRUForm><Form Type="Main" Id="${D}" /></MRUForm>`,L=Object(d.c)(T,x),R=Object(f.j)(T,e);if(Object(p.Ub)(T,e,R)&&Object(p.Hb)(S(),e))try{if(!await C(Object(y.a)(e)))return{status:1,pageId:e}}catch(t){return{status:1,pageId:e}}return C(Object(i.a)(n,k,e,{replaceState:!0})).then(t=>{var e,n;if(0===t.status)if(Object(g.c)(S()))null==L||L===a.a.EMPTY?function(t,e,n,r,i,c,d,g){const p=Object(l.p)(r,t),m=Object(h.q)(r),b="?$select=userentityuisettingsid&$filter=objecttypecode eq {0} and _ownerid_value eq '{1}'&$top=1",y=String.format(b,p.toString(),m.guid.toString());i(Object(o.e)("userentityuisettings",y)).then(h=>{h.value&&h.value.length>0&&(n=h.value[0].userentityuisettingsid?new a.a(h.value[0].userentityuisettingsid):a.a.EMPTY),Object(u.a)(n)||Object(u.a)(c)||Object(u.a)(t)||0===t.length||a.a.isNullOrEmpty(n)?null!=n&&n!==a.a.EMPTY||function(t,e,n,r,i,c,d){let h=a.a.EMPTY;const g=Object(l.p)(n,t),p="userentityuisettings";r(Object(o.b)(p,{objecttypecode:g,lastviewedformxml:e})).then(e=>{if(h=e,!(Object(u.a)(h)||Object(u.a)(i)||Object(u.a)(t)||0===t.length||a.a.isNullOrEmpty(h))){const e=d.TraceManager.getTracer("Forms.FormSelectorChange"),n="Created an entry for selected form successfully formid : "+i;e.info(n),r(Object(s.b)(t,i,h))}}).catch(e=>{if(-2147093999===e.errorCode)return Object(u.a)(i)||Object(u.a)(t)||0===t.length||r(Object(s.b)(t,i,h)),{};const n=[{name:"CorrelationId",value:c.correlationId},{name:"ContextId",value:c.contextId},{name:"ActionStack",value:c.stack},{name:"entityName",value:t},{name:"reason",value:e&&e.message?e.message:JSON.stringify(e)}],a="Catch block of ChangeForm.oDataCreate, for formid: "+i;d.EventManager.ReportComponentFailure("Forms.FormSelectorChange",Error(a),void 0,n),d.TraceManager.getTracer("Forms.FormSelectorChange").error(a,n)})}(t,e,r,i,c,d,g):O(t,e,n,r,i,c,d,g)}).catch(e=>{if(-2147093999===e.errorCode)return Object(u.a)(c)||Object(u.a)(t)||0===t.length||i(Object(s.b)(t,c,n)),{};const a=[{name:"CorrelationId",value:d.correlationId},{name:"ContextId",value:d.contextId},{name:"ActionStack",value:d.stack},{name:"entityName",value:t},{name:"reason",value:e&&e.message?e.message:JSON.stringify(e)}],r="Catch block of ChangeForm.oDataRetrieve, for formid: "+c;g.EventManager.ReportComponentFailure("Forms.FormSelectorChange",Error(r),void 0,a),g.TraceManager.getTracer("Forms.FormSelectorChange").error(r,a)})}(x,M,L,S(),C,F,I,j):O(x,M,L,S(),C,F,I,j);else{Object(u.a)(F)||Object(u.a)(x)||0===x.length||C(Object(s.b)(x,F,L));const t=null===(e=null==j?void 0:j.TraceManager)||void 0===e?void 0:e.getTracer("Forms.FormSelectorChange"),n="Selected form did not save in the UserEntityUiSetting table, for formid: "+F;null==t||t.info(n)}else if(1===t.status){const t=null===(n=null==j?void 0:j.TraceManager)||void 0===n?void 0:n.getTracer("Forms.FormSelectorChange"),e=`Could not change to form with id ${D} due to a navigation failure or because navigation was cancelled`;null==t||t.info(e,v)}return t})},getFailureParameters:(t,e)=>v}}function O(t,e,n,r,i,l,d,h){const g=new c.a("userentityuisettings",n);i(Object(o.f)(g,{lastviewedformxml:e})).then(()=>{if(!(Object(u.a)(n)||Object(u.a)(l)||Object(u.a)(t)||0===t.length||a.a.isNullOrEmpty(n))){const e=h.TraceManager.getTracer("Forms.FormSelectorChange"),a="Updated selected form successfully to : "+l;e.info(a),i(Object(s.b)(t,l,n))}}).catch(e=>{if(-2147093999===e.errorCode)return Object(u.a)(l)||Object(u.a)(t)||0===t.length||i(Object(s.b)(t,l,n)),{};const a=[{name:"CorrelationId",value:d.correlationId},{name:"ContextId",value:d.contextId},{name:"ActionStack",value:d.stack},{name:"entityName",value:t},{name:"reason",value:e&&e.message?e.message:JSON.stringify(e)}],r="Catch block of ChangeForm.oDataUpdate, for formid: "+l;h.EventManager.ReportComponentFailure("Forms.FormSelectorChange",Error(r),void 0,a),h.TraceManager.getTracer("Forms.FormSelectorChange").error(r,a)})}},rzkc:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"c",(function(){return s})),n.d(e,"b",(function(){return i}));var a=n("jq7Z");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const r="IsBulkEditSaving.set";function i(t,e){var n;return null===(n=Object(a.a)(t,e))||void 0===n?void 0:n.isBulkEditSaving}function s(t,e){return{type:r,payload:e,meta:{pageId:t}}}},"s+OO":function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return s})),n.d(e,"c",(function(){return o}));var a=n("dHD5"),r=n("BFlg");const i="chart.filterexpression.update",s="ChartFilterExpression";function o(t,e,n){return{type:"chart.filterexpression.update.async",execute({dispatch:o,getState:c},l){const u=l.TraceManager.getTracer(r.P),d=r.N+".updateFilterExpressionAction";try{u.info("Updating the chart filter expression"),e||(e=Object(a.l)(c(),t));const r=Object(a.w)(e);return o(function(t,e,n){return{type:i,payload:{name:s,value:n},meta:{pageId:t,dataSetContextKey:e}}}(t,r,n)),l.EventManager.ReportComponentSuccess(d),Promise.resolve()}catch(t){const e="Updatation of the chart filter expression failed with error : "+t.message;l.EventManager.ReportComponentFailure(d,Error(e))}}}}},srnJ:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var a=n("lY/Z"),r=n("dHD5"),i=n("pF61"),s=n("UqQu"),o=n("nC8a");function c(t,e,n,c){const l=[{name:"pageId",value:t},{name:"numRefreshColumns",value:n?n.length:null}];return{type:"refreshdataandtriggeronchange.async",execute({dispatch:u,getState:d},h,g){const p=d();return u(Object(a.d)(e,n,c)).then(()=>{const n=d();if(!Object(i.m)(n,t)||Object(o.a)(n,t)){const n=Object(r.j)(d(),t);return u(Object(s.a)(t,p,n,e.etn,e.id)).then(()=>{h.EventManager.ReportComponentSuccess("Forms.RefreshDataAndTriggerOnChange",l)},t=>{throw l.push({name:"originalErrorForTriggerOnchangeHandlers",value:JSON.stringify(t)}),h.EventManager.ReportComponentFailure("Forms.RefreshDataAndTriggerOnChange",t,null,l),t})}h.EventManager.ReportComponentSuccess("Forms.RefreshDataAndTriggerOnChange",l)},t=>{throw l.push({name:"originalErrorForRefreshRecordData",value:JSON.stringify(t)}),h.EventManager.ReportComponentFailure("Forms.RefreshDataAndTriggerOnChange",t,null,l),t})},getFailureParameters:(t,e)=>l}}},tpZ5:function(t,e,n){"use strict";n.d(e,"a",(function(){return I}));var a=n("0nOn"),r=n("OQLa"),i=n("arV0"),s=n("UqyN"),o=n("L8zx"),c=n("ZIjf"),l=n("3yqi"),u=n("EOIL"),d=n("i1f0"),h=n("Bo7t"),g=n("Tg1Y"),p=n("16wZ"),m=n("qshH");let b;class y extends u.a{constructor(t,e,n,a,r,i){super(t,e,n,a,r,i),b=t}getDefaultNextPageName(){const t="ClientApi.XrmNavigableFormUi.getDefaultNextPageName";try{c.a.instance.reportCall(t);const e=Object(d.P)(b.getState(),this.pageId,this.contextToken);return c.a.instance.reportSuccess(t),e}catch(e){const n=m.a.getInstance().getEventParameters(this.contextToken);throw m.a.getInstance().reportFailure(t,e,null,n),e}}movePrevious(){const t="ClientApi.XrmNavigableFormUi.movePrevious";try{c.a.instance.reportCall(t),b.dispatch(Object(g.b)(this.pageId,this.contextToken)),c.a.instance.reportSuccess(t)}catch(e){const n=m.a.getInstance().getEventParameters(this.contextToken);throw m.a.getInstance().reportFailure(t,e,null,n),e}}moveTo(t){const e="ClientApi.XrmNavigableFormUi.moveTo";let n;try{if(c.a.instance.reportCall(e),t&&this.tabs){const e=Object(d.Pc)(b.getState(),this.pageId,t,this.contextToken);n=this.tabs.get(null==e?void 0:e.Name),n&&b.dispatch(Object(h.b)(this.pageId,this.contextToken,null==e?void 0:e.Id))}c.a.instance.reportSuccess(e)}catch(t){const n=m.a.getInstance().getEventParameters(this.contextToken);throw m.a.getInstance().reportFailure(e,t,null,n),t}n||Object(p.h)(e,"pageName",t)}get taskProcess(){return c.a.instance.reportUsage("ClientApi.XrmNavigableFormUi.taskProcess"),this}}var f=n("SAYH"),v=n("n6Qt"),O=n("deGN"),C=n("G0J3"),S=n("504W");let j;class I extends C.a{constructor(t,e,n,r,i){super(t,e&&e.etn,r,i,t=>10===t||12===t?y:u.a,n);const s=[{name:"pageId",value:i,isRequired:!0,isEventParam:!0,expectedDataType:"string"}];this._clientApiExecutorForm=new a.a(t,"ClientApi.XrmForm.",i,r,s),j=t,this._entityReference=e}get applicationContext(){return this._applicationContext}set applicationContext(t){this._applicationContext=t}get context(){try{return c.a.instance.reportCall("ClientApi.XrmForm.context"),c.a.instance.reportSuccess("ClientApi.XrmForm.context"),this._globalContext}catch(t){throw this._reportFailure("ClientApi.XrmForm.context",t)}}set context(t){this._globalContext=t}get entityReference(){return this._clientApiExecutorForm.execute("entityReference_get",()=>({id:f.a.externalGuid(this._entityReference.id),entityType:this._entityReference.etn}))}get data(){try{if(c.a.instance.reportCall("ClientApi.XrmForm.data"),!this._data){let t;const e=Object(i.p)(j.getState(),this.pageId);e!==l.a.Dialog&&e!==l.a.ModalDialog&&this._entityReference&&(t=new s.a(j,this.contextToken,this.pageId,this,this._entityReference.etn,this._entityReference.id,T,this._applicationContext)),this._data=new o.a(j,this.contextToken,this.pageId,this,t)}return c.a.instance.reportSuccess("ClientApi.XrmForm.data"),this._data}catch(t){throw this._reportFailure("ClientApi.XrmForm.data",t)}}getAttribute(t){return this._clientApiExecutorForm.execute("getAttribute",()=>{var e,n;let a=null;return this.data&&this.data.entity&&(a=this.data.entity.attributes.get(t)),a?Object(S.a)(t)&&(a=a.concat(this.data.attributes.get(t))):a=null===(n=null===(e=this.data)||void 0===e?void 0:e.attributes)||void 0===n?void 0:n.get(t),a})}getUrl(t){try{c.a.instance.reportCall("ClientApi.XrmForm.getUrl");let e=null,n=null;if(this.contextToken.parentContextToken){const t=this.data.entity.getEntityReference(),a={entityTypeName:t.entityType,etn:t.name,id:f.a.fromExternalGuid(t.id)};e=l.a.EditForm,n=a}else e=Object(i.p)(j.getState(),this.pageId),n=Object(i.j)(j.getState(),this.pageId);switch(e){case l.a.EditForm:{const t=new v.a(j,this.applicationContext,this.context,this.pageId);n={entityTypeName:n.entityTypeName,etn:n.etn,id:n.id,entityTypeCode:t.getEntityCode(n.entityTypeName),languageId:this._globalContext.userSettings.languageId,recordSetQueryKey:n.recordSetQueryKey};break}case l.a.Grid:{const t=new v.a(j,this.applicationContext,this.context,this.pageId);n={entityTypeName:n.entityTypeName,pageType:n.pageType,entityTypeCode:t.getEntityCode(n.entityTypeName)};break}}let a=null;if(1===t)a=j.dispatch(Object(r.a)(e,n));else{const t=Object(O.a)(j,this.pageId);a=j.dispatch(Object(r.c)(t,e,n))}return c.a.instance.reportSuccess("ClientApi.XrmForm.getUrl"),a}catch(t){throw this._reportFailure("ClientApi.XrmForm.getUrl",t)}}_reportFailure(t,e){const n=m.a.getInstance().getEventParameters(this.contextToken);return n.push({name:"entityName",value:this._entityReference.etn}),m.a.getInstance().reportFailure(t,e,null,n),e}}function T(t,e,n){const a=Object(d.eb)(j.getState(),n,e);return a||t.TraceManager.getTracer("ClientApi.XrmForm.getAttributeNames").error("Form attributes was null"),a}},tvJg:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return i}));var a=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const r="attribute.options.clear";function i(t,e,n){const i=Object(a.y)(e);return{type:r,payload:void 0,meta:{pageId:t,contextKey:i,dataFieldName:n}}}},uOtn:function(t,e,n){"use strict";n.d(e,"a",(function(){return u})),n.d(e,"b",(function(){return l}));var a=n("Sbn7"),r=n("Zw8F"),i=n("y60j"),s=n("SAYH"),o=n("0nOn");let c;class l{constructor(t,e,n,a,s,l=i.l,u=r.a){this._formId=n,c=t,this._entityName=a,this._pageId=s,this._getSelectorItems=l,this._selectorItemType=u,this.clientApiExecutor=new o.a(t,"ClientApi.XrmControlFormSelector.",s,e)}get items(){return this.clientApiExecutor.execute("items_get",t=>{if(!this._items){this._items=new a.a(t);const e=this._getSelectorItems(c.getState(),this._entityName);if(e)for(const t in e){const n=e[t],a=n.name||n.DisplayName,r=new this._selectorItemType(new s.a(t),a,c,this._pageId);this._items.add(r.getId(),r)}}return this._items})}getCurrentItem(){return this.clientApiExecutor.execute("getCurrentItem",()=>{const t=this.items;for(let e=0;e<t.getLength();e++){const n=t.get(e);if(n.getId()===s.a.toString(this._formId))return n}return null})}}class u extends l{}},ujVH:function(t,e,n){"use strict";n.d(e,"a",(function(){return u})),n.d(e,"b",(function(){return d}));var a=n("dHD5"),r=n("BFlg"),i=n("P6DH"),s=n("3hnk"),o=n("kWiz"),c=n("WePp"),l=n("qLnS");const u="dataset.dependentoptionset.column.status";function d(t,e){const n=[];return{type:"dependentoptionset.column.status",sync:!0,execute({dispatch:s,getState:l},d,m){const b=d.TraceManager.getTracer(r.P),y=r.N+".SetDependentOptionSetColumnStatusAction";d.TraceManager.setLogLevel(o.a.Info,y);try{const r=Object(a.w)(e),o=l();let f=null;const v=Object(i.S)(l(),t,e),O={};if(v)f=v;else{const n=Object(i.U)(l(),{id:t},e);n&&n.entityLogicalName&&(f=n.entityLogicalName)}if(f){n.push({name:"CorrelationId",value:m.correlationId},{name:"ContextId",value:m.contextId},{name:"ActionStack",value:m.stack},{name:"PageId",value:t},{name:"EntityTypeName",value:f}),b.info("Executing initialize dependent option set column status action in grid.",n);const a={name:"NumPartialDependentOptionSetChainAttributesInGrid",value:0},r=[];let s=0;const l=Object(i.A)(o,e,f,t);for(const n in l){const i=l[n];if(null===i.ParentPicklistLogicalName){const i={name:n,value:0};h(o,e,t,f,l,n,i)?g(l,n,O,a):(p(l,n,O),s++,r.push(i))}else void 0===l[i.ParentPicklistLogicalName]&&g(l,n,O,a)}const u={name:"NumCompleteDependentOptionSetChainsInGrid",value:s},v={name:"CompleteChainsMaxDepthInGrid",value:r};n.push(u,a,v);const C=new c.a(y);C.addEventParameter("NumCompleteDependentOptionSetChainsInGrid",s),C.addEventParameter("NumPartialDependentOptionSetChainAttributesInGrid",a.value),C.addEventParameter("CompleteChainsMaxDepthInGrid",r),d.EventManager.ReportEvent(C),d.EventManager.ReportComponentSuccess(y),b.info("Executed initialize dependent option set column status action successfully.",n)}Object.keys(O).length>0&&s(function(t,e,n){return{type:u,payload:n,meta:{pageId:t,dataSetContextKey:e}}}(t,r,O))}catch(t){const e="creating dependent option set column status node in state tree failed.";d.EventManager.ReportComponentFailure(y,Error(e))}}}}function h(t,e,n,a,r,i,o){if(void 0===r[i])return!0;if(function(t,e,n,a,r){if(!Object(s.f)(t,r,a,l.a.CanUpdate)||!n[a].IsValidForUpdate)return!0;return!1}(t,0,r,i,a))return!0;const c=r[i].ChildPicklistLogicalNames;if(null!==c)for(let s=0;s<c.length;s++){const l={name:i,value:0};if(h(t,e,n,a,r,c[s],l))return!0;o.value=Math.max(o.value,l.value)}return o.value=o.value+1,!1}function g(t,e,n,a){if(void 0===t[e])return;n[e]=0,a.value=a.value+1;const r=t[e].ChildPicklistLogicalNames;if(r)for(let e=0;e<r.length;e++)g(t,r[e],n,a)}function p(t,e,n){n[e]=1;const a=t[e].ChildPicklistLogicalNames;if(a)for(let e=0;e<a.length;e++)p(t,a[e],n)}},x3V2:function(t,e,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var a,r;function i(){return[{LinkEntity:"account",IdAttribute:"accountid",DisplayAttribute:"name"},{LinkEntity:"contact",IdAttribute:"contactid",DisplayAttribute:"name"}]}function s(){return{LinkEntity:"systemuser",IdAttribute:"systemuserid",DisplayAttribute:"fullname"}}function o(){return[]}n.d(e,"c",(function(){return i})),n.d(e,"e",(function(){return s})),n.d(e,"d",(function(){return o})),n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return a})),function(t){t[t.Header=0]="Header",t[t.Body=1]="Body",t[t.Footer=2]="Footer"}(a||(a={})),function(t){t[t.String=0]="String",t[t.Number=1]="Number",t[t.Boolean=2]="Boolean",t[t.DateTime=3]="DateTime",t[t.PartyList=4]="PartyList",t[t.UniqueIdentifier=5]="UniqueIdentifier",t[t.Virtual=6]="Virtual"}(r||(r={}))},xorU:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"d",(function(){return o})),n.d(e,"c",(function(){return i})),n.d(e,"f",(function(){return c})),n.d(e,"b",(function(){return s})),n.d(e,"e",(function(){return l}));var a=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const r="controls.addCustomFilter",i="controls.startCustomFilter",s="controls.endCustomFilter";function o(t,e,n,i,s){const o=Object(a.w)(i);return{type:r,payload:{customFilter:s,entityLogicalName:n},meta:{pageId:t,controlName:e,contextKey:o}}}function c(t,e,n){const r=Object(a.w)(n);return{type:i,payload:{},meta:{pageId:t,controlName:e,contextKey:r}}}function l(t,e,n){const r=Object(a.w)(n);return{type:s,payload:{},meta:{pageId:t,controlName:e,contextKey:r}}}},yl9a:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return i}));var a=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const r="control.setSrc";function i(t,e,n,i){const s=Object(a.w)(n);return{type:r,payload:{Url:i,isCustomSrc:!0},meta:{pageId:t,controlName:e,contextKey:s}}}},ywwS:function(t,e,n){"use strict";n.d(e,"a",(function(){return C}));var a=n("0nOn"),r=n("P6DH"),i=n("HcnX"),s=n("AbXy"),o=n("FETf"),c=n("LE5i"),l=n("16wZ"),u=n("NAAR"),d=n("qshH"),h=n("HAeo"),g=n("ghNp"),p=n("dHD5"),m=n("ZIjf"),b=n("FZDd"),y=n("SAYH"),f=n("E5qG");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const v="ClientApi.XrmControlTimeline.";let O;class C extends i.a{constructor(t,e,n,r,i,s,o,c){super(t,e,n,r,i,o),this._defaultLabel=u.z.Timeline,O=t,this._applicationContext=c,this._controlId=s,this._traceManager=c.TraceManager,this._subgridToken=Object(p.q)(e,i),this._clientApiExecutorTimeline=new a.a(t,v,n,e),this._clientApiExecutorTimeline.addEventParameter({name:"controlName",value:i,isEventParam:!0,expectedDataType:"string"}),this._clientApiExecutorTimeline.addEventParameter({name:"controlId",value:s,isEventParam:!0,expectedDataType:"string"}),this._gridControl=new h.a(t,this._subgridToken,n,!1,3,!0,c,i),t.dispatch(Object(g.a)(this,n,this._subgridToken))}getControlType(){return m.a.instance.reportUsage(v+"getControlType"),"timelinewall"}getName(){return this.clientApiExecutor.execute("getName",()=>this.controlDescriptor&&this.controlDescriptor.Parameters&&this.controlDescriptor.Parameters[u.x.UClientUniqueName]?this.controlDescriptor.Parameters[u.x.UClientUniqueName]:u.z.Timeline)}getLabel(){const t=v+"getLabel";try{m.a.instance.reportCall(t);const e=this.controlDescriptor&&this.controlDescriptor.Parameters&&!Object(l.a)(this.controlDescriptor.Parameters[u.x.Label])?this.controlDescriptor.Parameters[u.x.Label]:this._defaultLabel?this._defaultLabel:"";return m.a.instance.reportSuccess(t),e}catch(e){const n=d.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),d.a.getInstance().reportFailure(t,e,null,n),e}}setLabel(t){const e=v+"setLabel";try{m.a.instance.reportCall(e),super.setLabel(t),this.controlDescriptor&&this.controlDescriptor.Parameters?this.controlDescriptor.Parameters[u.x.Label]=t:this._defaultLabel=t,m.a.instance.reportSuccess(e)}catch(t){const n=d.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),d.a.getInstance().reportFailure(e,t,null,n),t}}openEmail(t,e="openEmail"){const n=v+"openEmail";try{m.a.instance.reportCall(n);const a=O.getState(),r=Object(f.a)(a,this._controlId,this.pageId);O.dispatch(Object(o.u)(r,t,e)),O.dispatch(Object(o.p)(r,c.a.ContextualDialogEntity,2,y.a.toString(y.a.newGuid()))),m.a.instance.reportSuccess(n)}catch(t){const e=d.a.getInstance().getEventParameters(this.contextToken);throw e.push({name:"controlName",value:this.getName()}),d.a.getInstance().reportFailure(n,t,null,e),t}}refresh(t){let e=v+"refresh";t&&t.modules&&(e+="-modules"),t&&t.activities&&(e+="-activities");try{m.a.instance.reportCall(e),t&&this.controlDescriptor&&this.controlDescriptor.Parameters&&(t.modules&&(this.controlDescriptor.Parameters[u.x.UClientModules]=t.modules),t.activities&&(this.controlDescriptor.Parameters[u.x.UClientActivities]=t.activities));const n=O.getState(),a=Object(f.a)(n,this._controlId,this.pageId);O.dispatch(Object(o.p)(a,c.a.InitiateRefresh,1,y.a.toString(y.a.newGuid()))),m.a.instance.reportSuccess(e)}catch(t){const n=d.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),d.a.getInstance().reportFailure(e,t,null,n),t}}setTargetEntity(t,e,n=!0){const a=v+"setTargetEntity";try{m.a.instance.reportCall(a);const r={etn:t,id:e,isAPI:!0},i={};i[t]=[];const s=O.getState(),l=Object(f.a)(s,this._controlId,this.pageId);return O.dispatch(Object(o.x)(l,r)),O.dispatch(Object(b.e)(i)).catch(e=>{const n=d.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),n.push({name:"entityName",value:t}),d.a.getInstance().reportFailure(a+"-retrieveEntities",e,null,n),e}).then(()=>{n&&O.dispatch(Object(o.p)(l,c.a.InitiateRefresh,1,y.a.toString(y.a.newGuid()))),m.a.instance.reportSuccess(a)})}catch(t){const e=d.a.getInstance().getEventParameters(this.contextToken);throw e.push({name:"controlName",value:this.getName()}),d.a.getInstance().reportFailure(a,t,null,e),t}}getGrid(){const t=v+"getGrid";try{return m.a.instance.reportCall(t),this._grid||(this._grid=new s.a(O,this._applicationContext,this._subgridToken,this.pageId,this.getEntityName(),!1,this.name)),m.a.instance.reportSuccess(t),this._grid}catch(e){const n=d.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),d.a.getInstance().reportFailure(t,e,null,n),e}}getRecordSetQueryKey(){return this.clientApiExecutor.execute("getRecordSetQueryKey",()=>Object(r.fb)(O.getState(),this._subgridToken,{id:this.pageId}))}getGridType(){return m.a.instance.reportUsage(v+"getGridType"),3}getRollupType(){return this.clientApiExecutor.execute("getRollupType",()=>Object(r.hb)(O.getState(),this.pageId,this.contextToken))}getParentForm(){const t=v+"getParentForm";try{m.a.instance.reportCall(t);const e=this._gridControl.getParentForm();return m.a.instance.reportSuccess(t),e}catch(e){const n=d.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),d.a.getInstance().reportFailure(t,e,null,n),e}}refreshRibbon(){const t=v+"refreshRibbon";try{m.a.instance.reportCall(t),this._gridControl.refreshRibbon(),m.a.instance.reportSuccess(t)}catch(e){const n=d.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),d.a.getInstance().reportFailure(t,e,null,n),e}}getEntityName(){return m.a.instance.reportUsage(v+"getEntityName"),"activitypointer"}getUrl(){const t=d.a.getInstance().getEventParameters(this.contextToken);return t.push({name:"controlName",value:this.getName()}),t.push({name:"validationError",value:"true"}),this._traceManager.getTracer("ClientApi.XrmControlTimeline.getUrl").warn("Not Supported in Timeline control",t),m.a.instance.reportUsage("ClientApi.XrmControlTimeline.getUrl"),""}getFilterXml(){const t=v+"getFilterXml",e=d.a.getInstance().getEventParameters(this.contextToken);return e.push({name:"controlName",value:this.getName()}),e.push({name:"validationError",value:"true"}),this._traceManager.getTracer(t).warn("Not Supported in Timeline control",e),m.a.instance.reportUsage(t),""}getFetchXml(){const t=v+"getFetchXml",e=d.a.getInstance().getEventParameters(this.contextToken);return e.push({name:"controlName",value:this.getName()}),e.push({name:"validationError",value:"true"}),this._traceManager.getTracer(t).warn("Not Supported in Timeline control",e),m.a.instance.reportUsage(t),""}getViewSelector(){const t=v+"getViewSelector",e=d.a.getInstance().getEventParameters(this.contextToken);return e.push({name:"controlName",value:this.getName()}),e.push({name:"validationError",value:"true"}),this._traceManager.getTracer(t).warn("Not Supported in Timeline control",e),m.a.instance.reportUsage(t),null}getTeamTemplateId(){return null}getRelationship(){const t=v+"getRelationship",e=d.a.getInstance().getEventParameters(this.contextToken);return e.push({name:"controlName",value:this.getName()}),e.push({name:"validationError",value:"true"}),this._traceManager.getTracer(t).warn("Not Supported in Timeline control",e),m.a.instance.reportUsage(t),null}setFilterXml(t){const e=v+"setFilterXml",n=d.a.getInstance().getEventParameters(this.contextToken);n.push({name:"controlName",value:this.getName()}),n.push({name:"validationError",value:"true"}),this._traceManager.getTracer(e).warn("Not Supported in Timeline control",n),m.a.instance.reportUsage(e)}addOnLoad(t){const e=d.a.getInstance().getEventParameters(this.contextToken);e.push({name:"controlName",value:this.getName()}),e.push({name:"validationError",value:"true"}),this._traceManager.getTracer("ClientApi.XrmControlTimeline.addOnLoad").warn("Not Supported in Timeline control",e),m.a.instance.reportUsage("ClientApi.XrmControlTimeline.addOnLoad")}removeOnLoad(t){const e=v+"removeOnLoad",n=d.a.getInstance().getEventParameters(this.contextToken);n.push({name:"controlName",value:this.getName()}),n.push({name:"validationError",value:"true"}),this._traceManager.getTracer(e).warn("Not Supported in Timeline control",n),m.a.instance.reportUsage(e)}openRelatedGrid(){const t=v+"openRelatedGrid",e=d.a.getInstance().getEventParameters(this.contextToken);e.push({name:"controlName",value:this.getName()}),e.push({name:"validationError",value:"true"}),this._traceManager.getTracer(t).warn("Not Supported in Timeline control",e),m.a.instance.reportUsage(t)}}},z5LE:function(t,e,n){"use strict";n.d(e,"a",(function(){return s})),n.d(e,"b",(function(){return o}));var a=n("jRy5"),r=n("dHD5"),i=n("ApeL");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const s="attribute.notification.update";function o(t,e,n,o,c){return{type:"attribute.notification.add.clear.form.notification",sync:!0,execute(t,l){t.dispatch(function(t,e,n,o){if(o&&o.contextTokenType&&o.contextTokenType===a.a.GridRow)return Object(i.d)(t,o,e,n);const c=Object(r.y)(o);return{type:s,payload:n,meta:{pageId:t,contextKey:c,dataFieldName:e}}}(e,n,o,c))}}}},z8iZ:function(t,e,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function a(t){return{Title:t&&t.Title||null,Legend:t&&t.Legend||null,Area3DStyle:t&&t.Area3DStyle||null,AreaGradientStyle:t&&t.AreaGradientStyle||null,XAxes:t&&t.XAxes||null,YAxes:t&&t.YAxes||null,SeriesList:t&&t.SeriesList||null,SubTitle:t&&t.SubTitle||null,Colors:t&&t.Colors||null,DisplayMode:t&&t.DisplayMode||0,ErrorInformation:t&&t.ErrorInformation||null,EnableDrilldown:t&&t.EnableDrilldown||!0,Annotations:t&&t.Annotations||null}}n.d(e,"a",(function(){return a}))},zDpi:function(t,e,n){"use strict";n.d(e,"d",(function(){return E})),n.d(e,"c",(function(){return $})),n.d(e,"a",(function(){return J})),n.d(e,"b",(function(){return F}));var a=n("SAYH"),r=n("iZ7K"),i=n("x3V2"),s=n("NAAR"),o=n("Lyxw");function c(t,e){return t.timelineCards[e.toLowerCase()]?t.timelineCards[e.toLowerCase()]:t.defaultCustomActivityCard}function l(t,e){const n={timelineCards:{}};for(const a in e){if(e[a].IsActivity&&(e[a].IsCustomEntity||s.z.ActivitiesListSupported(t).indexOf(a)>=0)){const t=d(a);t&&h(n.timelineCards,t)}if(a===s.s.Incident&&Object(o.f)(t,s.y.TimelineWallRollupRecords)&&e[a]){const t=u(a);t&&h(n.timelineCards,t)}}return h(n.timelineCards,g(s.c.NotesModule,s.c.Annotations,s.c.ModifiedBy,i.a.String,s.c.ModifiedOn,i.a.DateTime,s.c.Subject,i.a.String,s.c.NoteText,i.a.String)),h(n.timelineCards,g(s.c.PostsModule,s.c.AutoPost,s.c.RegardingObjectId,i.a.String,s.c.CreatedOn,i.a.DateTime,s.c.Subject,i.a.String,s.c.Text,i.a.String)),h(n.timelineCards,g(s.c.PostsModule,s.c.UserPost,s.c.CreatedBy,i.a.String,s.c.CreatedOn,i.a.DateTime,s.c.Subject,i.a.String,s.c.Text,i.a.String)),h(n.timelineCards,g(s.c.PostCommentEntity,s.c.PostCommentEntity,s.c.CreatedBy,i.a.String,s.c.CreatedOn,i.a.DateTime,s.c.Subject,i.a.String,s.c.Text,i.a.String)),n.defaultCustomActivityCard=g("_default","_default",s.c.OwnerId,Object(i.e)(),s.c.ModifiedOn,i.a.DateTime,s.c.Subject,i.a.String,s.c.Description,i.a.String),h(n.timelineCards,n.defaultCustomActivityCard),n}function u(t){switch(t){case s.s.Incident:return function(t,e,n,a,r,i,s,o,c,l,u,d){const h={activityType:e,moduleName:t},g={dataFieldName:n,dataType:a},p={dataFieldName:r,dataType:i},m={dataFieldName:s,dataType:o},b={dataFieldName:c,dataType:l},y={dataFieldName:u,dataType:d};return h.headerFields=[g,p],h.bodyFields=[m,b,y],h}(s.s.RollupModule,s.s.Incident,s.s.Title,i.a.String,s.s.ModifiedOn,i.a.DateTime,s.s.OwnerId,i.a.String,s.s.CustomerId,i.a.String,s.s.Description,i.a.String);default:return null}}function d(t){switch(t){case s.c.Email:return g(s.c.ActivityModule,s.c.Email,s.c.From,i.a.PartyList,s.c.ModifiedOn,i.a.DateTime,s.c.Subject,i.a.String,s.c.Description,i.a.String);case s.c.PhoneCall:return g(s.c.ActivityModule,s.c.PhoneCall,s.c.From,i.a.PartyList,s.c.ModifiedOn,i.a.DateTime,s.c.Subject,i.a.String,s.c.Description,i.a.String);case s.c.Task:return g(s.c.ActivityModule,s.c.Task,s.c.ModifiedBy,i.a.String,s.c.ModifiedOn,i.a.DateTime,s.c.Subject,i.a.String,s.c.Description,i.a.String);case s.c.Appointment:return g(s.c.ActivityModule,s.c.Appointment,s.c.Organizer,i.a.PartyList,s.c.ScheduledStart,i.a.DateTime,s.c.Subject,i.a.String,s.c.Description,i.a.String);case s.c.RecurringAppointment:return g(s.c.ActivityModule,s.c.RecurringAppointment,s.c.Organizer,i.a.PartyList,s.c.ScheduledStart,i.a.DateTime,s.c.Subject,i.a.String,s.c.Description,i.a.String);case s.c.Letter:return g(s.c.ActivityModule,s.c.Letter,s.c.From,i.a.PartyList,s.c.ModifiedOn,i.a.DateTime,s.c.Subject,i.a.String,s.c.Description,i.a.String);case s.c.Fax:return g(s.c.ActivityModule,s.c.Fax,s.c.From,i.a.PartyList,s.c.ModifiedOn,i.a.DateTime,s.c.Subject,i.a.String,s.c.Description,i.a.String);case s.c.OpportunityClose:return g(s.c.ActivityModule,s.c.OpportunityClose,s.c.OwnerId,i.a.PartyList,s.c.ModifiedOn,i.a.DateTime,s.c.ActualRevenue,i.a.Number,s.c.Subject,i.a.String);case s.c.IncidentResolution:return g(s.c.ActivityModule,s.c.IncidentResolution,s.c.CreatedBy,i.a.String,s.c.ModifiedOn,i.a.DateTime,s.c.Subject,i.a.String,s.c.Description,i.a.String);default:return null}}function h(t,e){t[e.activityType.toLowerCase()]=e}function g(t,e,n,a,r,i,s,o,c,l){const u={activityType:e,moduleName:t},d={dataFieldName:n,dataType:a},h={dataFieldName:r,dataType:i},g={dataFieldName:s,dataType:o},p={dataFieldName:c,dataType:l};return u.headerFields=[d,h],u.bodyFields=[g,p],u}var p=n("y60j"),m=n("LbMF"),b=n("IqkD"),y=n("LE5i"),f=n("S6h3"),v=n("NjDY"),O=n("5Oca"),C=n("FCvT"),S=n("ybGo"),j=n("37s6"),I=n("3hnk"),T=n("dyr5"),x=n("E5IU"),A=n("b8TU"),_=n("9fGf"),N=n("3/02");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function E(t,e,n,a,r,i,s){const o=Object(f.b)(t,a,y.a.Metadata);let c;return Object(f.d)(t,a)?(c=P(t,e,n,a,r,i,s),c):2!==o?null:(c=P(t,e,n,a,r,i,s),c)}function P(t,e,n,a,i,c,l){let u=[],d=[];const h=Object(T.a)(t,s.p.SecondStage);h&&(u=Y(t,e.Parameters[s.x.UClientActivities])),d=function(t,e){const n=F(e),a=[],i=[];for(const t in n)n[t]&&n[t].isEnabled&&i.push(t);return i.forEach(e=>{if(Object(I.b)(t,e)){const n=Object(r.h)(t,e);a.push(K(n,e))}}),a}(t,e.Parameters[s.x.UClientRollupsConfigurationJSON]);let g=n.entityTypeName;c&&c.target&&c.target.etn&&(g=c.target.etn);const p=function(t){const e=Object(O.i)(t,C.a);if(!e)return Object(o.f)(t,s.y.EnableUserPostsInCDS)?s.i:[];const n=[];for(const a in e){const i=e[a],s=i&&i.fields&&i.fields[C.c]?i.fields[C.c].value:"";if(s){const e=Object(r.h)(t,s);e&&e.IsEnabledInUnifiedInterface&&i.fields.statecode&&"0"===i.fields.statecode.valueString&&n.push(s)}}return n}(t);return{TimelineWallConfiguration:{SortActivitiesByValue:null!=e.Parameters[s.x.UClientSortActivitiesByValue]?e.Parameters[s.x.UClientSortActivitiesByValue]:s.z.SortActivitiesByValueDefault,DefaultModuleForCreateExperience:null!=e.Parameters[s.x.UClientDefaultModuleForCreateExperience]?e.Parameters[s.x.UClientDefaultModuleForCreateExperience]:s.z.DefaultModuleForCreateExperience,OrderBy:null!=e.Parameters[s.x.UClientOrderBy]?e.Parameters[s.x.UClientOrderBy]:s.z.OrderByDefault,RecordPerPage:null!=e.Parameters[s.x.UClientRecordPerPage]?e.Parameters[s.x.UClientRecordPerPage]:10,Label:e.Parameters[s.x.Label],DisplayLabel:L(e.Parameters[s.x.UClientShowTimelineLabel],!0),ShowFilterPane:R(t,e),ExpandFilterPane:L(e.Parameters[s.x.UClientExpandFilterPane],!1),DefaultFilters:F(e.Parameters[s.x.UClientDefaultFilterJSON]),EnableSearch:L(e.Parameters[s.x.UClientEnableSearch],!0),EnableWhatsChanged:L(e.Parameters[s.x.UClientEnableWhatsNewFilter],D(t)),ExpandRecord:L(e.Parameters[s.x.UClientExpandRecord],!1),ShowPersona:e.Parameters[s.x.UClientShowPersona],ShowOneNotePane:V(t,n),ShowContextualEmail:G(t),ShowRichTextNotes:B(t),IsAutoDataCaptureV2Enabled:U(t),Activities:h?u:Y(t,e.Parameters[s.x.UClientActivities]),Modules:X(t,e.Parameters[s.x.UClientModules],g,i.ContextType),DisplayActivityHeaderUsing:null!=e.Parameters[s.x.UClientDisplayActivityHeaderUsing]?e.Parameters[s.x.UClientDisplayActivityHeaderUsing]:s.z.DisplayActivityHeaderDefault,CreateActivityUsing:null!=e.Parameters[s.x.UClientCreateActivityUsing]?e.Parameters[s.x.UClientCreateActivityUsing]:s.z.CreateActivityDefault,OpenActivityUsing:null!=e.Parameters[s.x.UClientOpenActivityUsing]?e.Parameters[s.x.UClientOpenActivityUsing]:s.z.OpenActivityDefault,DisplayActivityUsing:null!=e.Parameters[s.x.UClientDisplayActivityUsing]?e.Parameters[s.x.UClientDisplayActivityUsing]:s.z.DisplayActivityDefault,ActivityCardMap:tt(t,e,u),ActivityRollupType:e.Parameters[s.x.UClientActivityRollupType],ActivitiesConfigMap:F(e.Parameters[s.x.UClientActivitiesConfigurationJSON]),NotesConfigurations:F(e.Parameters[s.x.UClientNotesConfigurationJSON]),PostsConfigurations:F(e.Parameters[s.x.UClientPostsConfigurationJSON]),RollupsConfigMap:F(e.Parameters[s.x.UClientRollupsConfigurationJSON]),RollupCardMap:w(t,d),PostsEnabledEntities:p,RecordSourcesConfig:k(e),PostsEnabledEntitiesQFVRetrievalList:Object(C.e)(p,l,t),ScrollRefreshLevel:e.Parameters[s.x.UClientScrollRefreshLevel],isMetadataError:Object(f.d)(t,a),upSyncStatus:Object(S.b)(t),offlineAvailableForUse:Object(j.D)(t),isNotesAnalysisEnabled:M(t,n),enableActivitiesTimeLinePerfImprovement:Object(v.D)(t).enableActivitiesTimeLinePerfImprovement,IsConversationModeEnabled:L(e.Parameters[s.x.UClientEnableConversationMode],!1)},ContextType:i&&i.ContextType?i.ContextType:null,Type:s.t,EntitiesMetadata:z(t)}}function w(t,e){const n=l(t,Object(r.g)(t)),a={timelineCards:{}},i={};let s,o,u,d,g;for(let n=0;n<e.length;n++){const a=e[n];if(null!==a&&null!==a.ObjectTypeCode){const r=Object(m.d)(t,e[n].LogicalName);a.AttributesMetadata={};for(const t in r){const e=r[t];a.AttributesMetadata[e.LogicalName]=e}i[a.LogicalName]=a}}for(const t in i)s=i[t],o=s.LogicalName,u=c(n,o),d=u.headerFields,g=u.bodyFields,null!==s.AttributesMetadata&&void 0!==s.AttributesMetadata&&(rt(d,o,s.AttributesMetadata),rt(g,o,s.AttributesMetadata)),h(a.timelineCards,u);return a}function F(t){if(t)try{return JSON.parse(t)}catch(t){return null}return null}function k(t){const e=F(t.Parameters[s.x.UClientRecordSourcesJSON]);if(e&&e.recordSources)return e.recordSources}function D(t){return!Object(o.f)(t,N.jf)}function M(t,e){return!!Object(o.f)(t,s.y.TimelineWallNotesAnalysis)&&function(t){return t&&t.entityTypeName&&("contact"===t.entityTypeName||"opportunity"===t.entityTypeName||"lead"===t.entityTypeName||"account"===t.entityTypeName||"case"===t.entityTypeName)}(e)}function L(t,e){return null!=t?"true"===t:e}function R(t,e){const n=Object(o.f)(t,s.y.TimelineWallFilters),a=Object(T.c)(t),r=L(e.Parameters[s.x.UClientShowFilterPane],!0);return n&&r&&!a}function X(t,e,n,a){const i=[],c=n?Object(r.h)(t,n):null;a!==s.f&&c&&c.HasNotes&&i.push(s.z.NotesModule),(a===s.f||c&&c.HasActivities)&&i.push(s.z.ActivitiesModule),(a===s.f||function(t,e){if(Object(o.f)(t,s.y.EnableUserPostsInCDS))return!0;const n=Object(O.i)(t,C.a);if(n)for(const t in n){const a=n[t];if(a.fields&&a.fields[C.c]&&a.fields[C.c].value===e)return a.fields[C.d]&&"1"!==a.fields[C.d].valueString}return!1}(t,n))&&i.push(s.z.PostsModule);let l=[];if(null!=e&&""!==e){const t=e.split(",");l=i.filter(e=>t.indexOf(e)>=0)}else l=i;return l.reduce((e,n)=>(function(t,e){switch(e){case s.z.ActivitiesModule:return Object(o.f)(t,s.y.TimelineWallActivities);case s.z.NotesModule:return Object(o.f)(t,s.y.TimelineWallNotes);case s.z.PostsModule:return Object(o.f)(t,s.y.TimelineWallPosts);case s.z.UserPostsModule:return Object(o.f)(t,s.y.TimelineWallUserPosts);default:return!1}}(t,n)&&e.push(n),e),[])}function V(t,e){if(e&&e.entityTypeName){const n=Object(v.D)(t),a=Object(b.x)(t),i=Object(r.h)(t,e.entityTypeName);if(Object(o.f)(t,s.k)&&Object(o.f)(t,N.Mg)&&0===n.sharePointDeploymentType&&a.isLive&&i.IsDocumentManagementEnabled&&i.IsOneNoteIntegrationEnabled)return!0}return!1}function U(t){return Object(v.D)(t).isAutoDataCaptureV2Enabled}function G(t){const e=Object(v.D)(t),n=Object(x.n)(t),a=Object(_.b)(t),r=Object(A.b)(t),i=Object(A.c)(t),c=s.e.SupportedUnifiedClientApps;return!!(Object(o.e)(t,s.y.TimelineWallContextualEmail)&&n&&e.isContextualEmailEnabled&&(c.indexOf(n)>=0||Object(o.f)(t,s.y.TimelineWallContexual2020Update))&&a===_.a.Web&&r>s.e.PanelHeight&&i>s.e.PanelWidth)}function B(t){return Object(v.D)(t).isRichTextNotesEnabled}function Y(t,e){const n=[],a=[];let i=null;const o=Object(T.a)(t,s.p.SecondStage);if(e)i=e.split(","),i.forEach(e=>{if(!o||Object(I.b)(t,e)){Q(Object(r.h)(t,e),e,a,n)}});else{const e=Object(r.g)(t);for(const i in e)if(e[i].IsActivity&&(!o||Object(I.b)(t,i))&&(e[i].IsCustomEntity||s.z.ActivitiesListSupported(t).indexOf(i)>=0)){Q(Object(r.h)(t,i),i,a,n)}}return n.sort(Z).concat(a.sort(Z))}function z(t){const e=Object(r.g)(t),n={},a=Object(b.v)(t);for(const r in e){const i=e[r],o=K(i,r);if(o.Privileges={},H(a,i.Privileges,o.Privileges),i.IsActivity||s.z.SupportedModules.findIndex(t=>t.entityName===r)>=0||r===s.n){const e=Object(m.d)(t,r);o.AttributesMetadata=e}n[r]=o}return n}function H(t,e,n){if(e)for(let a=0;a<e.length;a++){const r=e[a];if(r){n[q(r.PrivilegeType)]=W(t,r.PrivilegeId)}}}function q(t){let e=t.toString();switch(t){case 1:e=s.q.Create;break;case 2:e=s.q.Read;break;case 3:e=s.q.Write;break;case 4:e=s.q.Delete;break;case 5:e=s.q.Assign;break;case 6:e=s.q.Share;break;case 7:e=s.q.Append;break;case 8:e=s.q.AppendTo}return e}function W(t,e){if(e&&""!==e&&t){const n=t[e];if(n&&n.privilegeDepth>=0)return!0}return!1}function K(t,e){const n={};return n.LogicalName=e,n.DisplayName=t.DisplayName,n.ObjectTypeCode=t.ObjectTypeCode,n.IsCustomEntity=t.IsCustomEntity,n.EntitySetName=t.EntitySetName,n.ActivityTypeMask=t.ActivityTypeMask,n.IsReadOnlyInMobileClient=t.IsReadOnlyInMobileClient,n.IsVisibleInMobileClient=t.IsVisibleInMobileClient,n.IsActivityParty=t.IsActivityParty,n.IconVectorName=t.IconVectorName,n}function Q(t,e,n,a){t&&t.hasOwnProperty("IsActivity")&&t.IsActivity&&(t.IsCustomEntity?n.push(K(t,e)):a.push(K(t,e)))}function Z(t,e){if(t&&e&&t.DisplayName&&e.DisplayName){const n=null==t.DisplayName.UserLocalizedLabel?t.DisplayName:t.DisplayName.UserLocalizedLabel.Label,a=null==e.DisplayName.UserLocalizedLabel?e.DisplayName:e.DisplayName.UserLocalizedLabel.Label;return n.localeCompare(a)}return-1}function J(t){let e=[];if(t){e=t.split(",").map(t=>{const e=t.split(":");return{logicalName:e[0],objectTypeCode:e[1],formId:e[2]}})}return e}function $(t,e){if(t&&t.dashboardId&&e.indexOf(s.g)>=0){const t=e.split(".");return t[t.length-1]}return e}function tt(t,e,n){const a=l(t,Object(r.g)(t));Object(T.a)(t,s.p.SecondStage)&&n||(n=Y(t,e.Parameters[s.x.UClientActivities]));const i=function(t,e,n){var a;const r={};for(let i=0;i<e.length;i++){const s=e[i];if(null!==s&&null!==s.ObjectTypeCode){const o=Object(m.d)(t,e[i].LogicalName);s.AttributesMetadata={};for(const t in o){const e=o[t];s.AttributesMetadata[e.LogicalName]=e}const c=n.find(t=>t.logicalName===s.LogicalName);s.FormId=null!==(a=null==c?void 0:c.formId)&&void 0!==a?a:"";const l=s.LogicalName;r&&(r[l]=s)}}return r}(t,n,J(e.Parameters[s.x.UClientActivityCardMap]));if(it(t,s.c.Annotations,i),it(t,s.c.PostsEntity,i),it(t,s.c.PostCommentEntity,i),null!=i)for(const n in i){let r;const o=i[n],l=n===s.c.PostsEntity?s.c.UserPost:o.LogicalName;if(""===o.FormId||void 0===o.FormId||null===o.FormId){r=c(a,l);const t=r.headerFields,n=r.bodyFields;l!==s.c.UserPost&&l!==s.c.PostCommentEntity&&l!==s.c.Annotations||et(e,t,l),null!==o.AttributesMetadata&&void 0!==o.AttributesMetadata&&(rt(t,l,o.AttributesMetadata),rt(n,l,o.AttributesMetadata))}else r=nt(t,o.FormId,l,i);null!=r&&h(a.timelineCards,r)}return a}function et(t,e,n){var a,r,i,o;const c=F(t.Parameters[n===s.c.Annotations?s.x.UClientNotesConfigurationJSON:s.x.UClientPostsConfigurationJSON]);(null===(r=null===(a=null==c?void 0:c.fieldsConfig)||void 0===a?void 0:a.header)||void 0===r?void 0:r.dataFieldName)&&(e[0].dataFieldName=c.fieldsConfig.header.dataFieldName),(null===(o=null===(i=null==c?void 0:c.fieldsConfig)||void 0===i?void 0:i.footer)||void 0===o?void 0:o.dataFieldName)&&(e[1].dataFieldName=c.fieldsConfig.footer.dataFieldName)}function nt(t,e,n,r){let s,o={activityType:n,moduleName:"Activities",headerFields:[],bodyFields:[],formId:e};if(void 0===e||""===e||null===e)return null;if(s=new a.a(e),s){const e=Object(p.r)(t,s,"CardHeader"),n=Object(p.r)(t,s,"CardDetails");let a,c;return null!=e&&(c=e.Rows,c.forEach(t=>{a=t.Cells,null!=a&&(o=at(a,i.b.Header,o,r))})),null!=n&&(c=n.Rows,c.forEach(t=>{a=t.Cells,null!=a&&(o=at(a,i.b.Body,o,r))})),o}}function at(t,e,n,a){for(let r=0;r<t.length;r++){const o={},c=t[r].ControlName;if(null!=c){const t=c,r=a[n.activityType];if(null!=t&&null!=r&&null!=r.AttributesMetadata&&null!=r.AttributesMetadata[t]){o.dataFieldName=t,o.label=r.AttributesMetadata[t].DisplayName;const a=r.AttributesMetadata[t].Type;o.dataType=s.h[a.toLowerCase()],e===i.b.Body?n.bodyFields.push(o):n.headerFields.push(o)}}}return n}function rt(t,e,n){for(let e=0;e<t.length;e++){const a=t[e],r=a.dataFieldName;r&&n[r]&&(a.label=n[r].DisplayName)}}function it(t,e,n){const a=Object(m.d)(t,e),r={LogicalName:e,AttributesMetadata:{}};for(const t in a){const e=a[t];r.AttributesMetadata[e.LogicalName]=e}n&&(n[e]=r)}},zgeC:function(t,e,n){"use strict";n.d(e,"a",(function(){return O}));var a=n("0nOn"),r=n("P6DH"),i=n("SAYH"),s=n("HcnX"),o=n("1kth"),c=n("dHD5"),l=n("meVR"),u=n("qshH"),d=n("+zjj"),h=n("w92Z"),g=n("whN/"),p=n("HAeo"),m=n("ghNp"),b=n("ZIjf"),y=n("IaGr");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const f="ClientApi.XrmControlSubGrid.";let v;class O extends s.a{constructor(t,e,n,r,i,s,o,l,u){super(t,e,n,o,r,s),this._relationship=null,v=t,this._subgridToken=Object(c.q)(e,r),this._clientApiExecutorSubGrid=new a.a(t,f,n,this._subgridToken),this.clientApiExecutor.addEventParameter({name:"controlName",value:r,isEventParam:!0}),this.clientApiExecutor.addEventParameter({name:"isEditable",value:i,isEventParam:!0}),this._gridControl=new p.a(t,this._subgridToken,n,i,3,!0,l,r,u),t.dispatch(Object(m.a)(this,n,this._subgridToken))}get clientApiExecutor(){return this._clientApiExecutorSubGrid}setFilterXml(t){const e=f+"setFilterXml";try{b.a.instance.reportCall(e),this._gridControl.setFilterXml(t),b.a.instance.reportSuccess(e)}catch(t){const n=u.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),u.a.getInstance().reportFailure(e,t,null,n),t}}getFilterXml(){const t=f+"getFilterXml";try{b.a.instance.reportCall(t);const e=this._gridControl.getFilterXml();return b.a.instance.reportSuccess(t),e}catch(e){const n=u.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),u.a.getInstance().reportFailure(t,e,null,n),e}}refresh(){const t=f+"refresh";try{b.a.instance.reportCall(t),this._gridControl.refresh(),b.a.instance.reportSuccess(t)}catch(e){const n=u.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),u.a.getInstance().reportFailure(t,e,null,n),e}}getFetchXml(){const t=f+"getFetchXml";try{b.a.instance.reportCall(t);const e=this._gridControl.getFetchXml();return b.a.instance.reportSuccess(t),e}catch(e){const n=u.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),u.a.getInstance().reportFailure(t,e,null,n),e}}getGrid(){const t=f+"getGrid";try{b.a.instance.reportCall(t);const e=this._gridControl.getGrid();return b.a.instance.reportSuccess(t),e}catch(e){const n=u.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),u.a.getInstance().reportFailure(t,e,null,n),e}}getViewSelector(){const t=f+"getViewSelector";try{b.a.instance.reportCall(t);const e=this._gridControl.getViewSelector();return b.a.instance.reportSuccess(t),e}catch(e){const n=u.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),u.a.getInstance().reportFailure(t,e,null,n),e}}getTeamTemplateId(){const t=f+"getTeamTemplateId";try{b.a.instance.reportCall(t);const e=this._gridControl.getTeamTemplateId();return b.a.instance.reportSuccess(t),e}catch(e){const n=u.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),u.a.getInstance().reportFailure(t,e,null,n),e}}addOnLoad(t){this.clientApiExecutor.execute("addOnLoad",()=>{v.dispatch(Object(o.d)(this._subgridToken,this.pageId,t,this.name))},[{name:"handler",value:t,isRequired:!0,isEventParam:!1}])}removeOnLoad(t){this.clientApiExecutor.execute("removeOnLoad",()=>{v.dispatch(Object(o.z)(this._subgridToken,this.pageId,t,this.name))},[{name:"handler",value:t,isRequired:!0,isEventParam:!1}])}getEntityName(){const t=f+"getEntityName";try{b.a.instance.reportCall(t);const e=this._gridControl.getEntityName();return b.a.instance.reportSuccess(t),e}catch(e){const n=u.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),u.a.getInstance().reportFailure(t,e,null,n),e}}getControlType(){return this.clientApiExecutor.execute("getControlType",()=>{const t=Object(h.a)(v.getState(),this.controlDescriptor,this.pageId,this.contextToken);return t?"customsubgrid:"+t.Name:"subgrid"})}getRelationship(){return this.clientApiExecutor.execute("getRelationship",(t,e)=>{var n,a;if(!this._relationship){if(null===(a=null===(n=this.controlDescriptor)||void 0===n?void 0:n.Parameters)||void 0===a?void 0:a.RelationshipName){const t=this.controlDescriptor.Parameters.RelationshipName,e=this.controlDescriptor.Parameters.RelationshipRoleOrdinal,n=this.controlDescriptor.Parameters.TargetEntityType;this._relationship=Object(p.b)(t,n),this._relationship.roleType=e}this._relationship||(this._relationship=this._gridControl.getRelationship())}return this._relationship})}getRecordSetQueryKey(){return this.clientApiExecutor.execute("getRecordSetQueryKey",()=>Object(r.fb)(v.getState(),this._subgridToken,{id:this.pageId}))}getGridType(){return b.a.instance.reportUsage(f+"getGridType"),3}getRollupType(){return this.clientApiExecutor.execute("getRollupType",()=>Object(r.hb)(v.getState(),this.pageId,this.contextToken))}openRelatedGrid(){this.clientApiExecutor.executeAsync("openRelatedGrid",(t,e)=>{const n=this.getRelationship();if(!n)return y.a.getInstance().traceManager.getTracer(t).error("Can't open related grid: the relationship was not retrieved from the inner grid.",e),Promise.resolve(i.a.EMPTY);const a=Object(d.c)(v.getState(),this.pageId);let r=null;for(let t=0;t<a.length;t++)if(a[t].relationshipName===n.name){r=a[t];break}if(!r)return e.push({name:"relationshipName",value:n.name}),y.a.getInstance().traceManager.getTracer(t).error("Can't open related grid: no relationship was found with the specified name.",e),Promise.resolve(i.a.EMPTY);const s={id:r.id,title:r.title,entityName:this.getEntityName(),relationshipName:n.name,isSelected:!0,show:r.show},o=Object(c.a)(this._subgridToken.parentContextToken,n.name,n.roleType?1===n.roleType?g.a.Referencing:g.a.AssociationEntity:void 0);return v.dispatch(Object(l.a)(this.pageId,o,s))})}refreshRibbon(){const t=f+"refreshRibbon";try{b.a.instance.reportCall(t),this._gridControl.refreshRibbon(),b.a.instance.reportSuccess(t)}catch(e){const n=u.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),u.a.getInstance().reportFailure(t,e,null,n),e}}getUrl(){const t=f+"getUrl";try{b.a.instance.reportCall(t);const e=this._gridControl.getUrl();return b.a.instance.reportSuccess(t),e}catch(e){const n=u.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),u.a.getInstance().reportFailure(t,e,null,n),e}}getParentForm(){const t=f+"getParentForm";try{b.a.instance.reportCall(t);const e=this._gridControl.getParentForm();return b.a.instance.reportSuccess(t),e}catch(e){const n=u.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),u.a.getInstance().reportFailure(t,e,null,n),e}}}}}]),window.bundleExecutionMarkers["scripts/13.js?v=1.4.3886-master"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();