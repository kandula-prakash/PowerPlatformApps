/*! For license information please see 267.00ed5a0c.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[267],{8047:function(e,t,a){"use strict";a.r(t),a.d(t,"PerfCheckerLandingPage",(function(){return Y}));var n=a(245),r=a.n(n),i=a(1294),o=a(1471),s=a(1709),l=a(1463),c=a(1795),d=a(545),u=a(923),m=a(2898),p=a(1240),g=a(222),v=a(687),f=a(8048),h=a(8050),b=a(1201),y=a(3161),S=a(4795),E=a(4799),w=a(8051),C=a(217),O=a(3185),x=a(3076),k=a(216),D=a(1090),T=a(684),R=a(8052),j=a(1144),N=a(3313),I=a(777),A=a(790),L=a(2844),M=a(1567),P=a(1105),B=a(8053),F=a(860),W=a(9344),z=a(3745),U=a(1101);function _(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function H(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?_(Object(a),!0).forEach((function(t){V(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):_(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function V(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function G(e,t,a,n,r,i,o){try{var s=e[i](o),l=s.value}catch(c){return void a(c)}s.done?t(l):Promise.resolve(l).then(n,r)}function q(e){return function(){var t=this,a=arguments;return new Promise((function(n,r){var i=e.apply(t,a);function o(e){G(i,n,r,o,s,"next",e)}function s(e){G(i,n,r,o,s,"throw",e)}o(void 0)}))}}var Y=Object(j.withHttpClient)(Object(z.withMetadataClient)(Object(u.translateService)("PerfChecker")(e=>{var t,u,j,z,_,V,G,Y,Z,K,Q,X,{currentEnvironment:J}=Object(n.useContext)(P.EnvironmentContext),$=Object(P.getCrmInstanceUrl)(J),{trackEndPageLoad:ee}=e,{match:te}=e,{tid:ae}=r.a.useContext(k.AuthenticatedUserInfoContext),ne=(null!==(t=null==te||null===(u=te.params)||void 0===u?void 0:u.environmentId)&&void 0!==t?t:"").toLocaleLowerCase(),re=null!==(j=null==te||null===(z=te.params)||void 0===z?void 0:z.uniqueName)&&void 0!==j?j:"",ie=null!==(_=null==te||null===(V=te.params)||void 0===V?void 0:V.origin)&&void 0!==_?_:"",oe=null!==(G=null==te||null===(Y=te.params)||void 0===Y?void 0:Y.readable)&&void 0!==G?G:"",se=(null!==(Z=null==te||null===(K=te.params)||void 0===K?void 0:K.appId)&&void 0!==Z?Z:"").toLocaleLowerCase(),le=null!==(Q=null==te||null===(X=te.params)||void 0===X?void 0:X.type)&&void 0!==Q?Q:"",ce=Object(h.buildReturnUrl)(ne,le),de=Object(n.useContext)(x.ApolloClientContext),[ue,me]=r.a.useState(Object(g.v4)()),[pe,ge]=r.a.useState({details:!1,ratings:!1,performance:!1}),[ve,fe]=r.a.useState(ie),[he,be]=r.a.useState({complete:!1,empty:!0,logged:!1}),ye={setRatingsCompletedData:be,setSelectedPivot:fe},Se=Object(n.useRef)(null),Ee=Object(h.utcOffset)(0,new Date),we=Object(h.utcOffset)(7,Ee),[Ce,Oe]=r.a.useState(Object(h.utcOffset)(0,Ee)),[xe,ke]=r.a.useState(Object(h.utcOffset)(-1,Ee)),[De,Te]=r.a.useState(Object(h.utcOffset)(0,Ee)),[Re,je]=r.a.useState(),[Ne,Ie]=r.a.useState([{key:"",text:""}]),[Ae,Le]=r.a.useState(e.t("Common.SelectInsights")),[Me,Pe]=r.a.useState(!1),[Be,Fe]=r.a.useState(!1),[We,{setTrue:ze,setFalse:Ue}]=Object(m.useBoolean)(!1),[_e,He]=r.a.useState(!1),[Ve,Ge]=r.a.useState(!1),[qe,Ye]=r.a.useState(!1),[Ze,Ke]=r.a.useState(!1),[Qe,Xe]=r.a.useState(!1),[Je,$e]=r.a.useState(!1),[et,tt]=r.a.useState(),[at,nt]=r.a.useState({primary:"",secondary:""}),[rt,it]=r.a.useState(""),[ot,st]=r.a.useState(!1),[lt,ct]=r.a.useState(!1),dt=Object(f.useStackControlClassStyles)(),ut=Object(f.usePanelClassStyles)(),mt=Object(f.useScreenControlStyles)(),pt=Object(f.useBreadcrumbPivotsStyles)(),gt=Object(f.useIconColumnStyles)(),vt=Object(f.useDetailsStyles)(),[ft,ht]=r.a.useState(!1),bt=r.a.lazy(()=>Promise.all([a.e(442),a.e(441)]).then(a.bind(null,29684))),[yt,St]=r.a.useState([{title:e.t("DetailsTitles.Owner"),value:"",type:h.DetailTypes.Text}]),{appModule:Et}=Object(O.useAppModuleQuery)(de.environmentClient,{appModuleId:se},w.PerfCheckerScope,e.t("RequestMessages.Failed"),e.t("RequestMessages.Failed")),[wt,Ct]=r.a.useState(),[Ot,xt]=r.a.useState(""),kt={environmentId:ne,appModuleName:re,appType:le,startTime:Ce,endTime:xe,tid:ae,appId:se,requestId:ue},[Dt,Tt]=r.a.useState([]);Object(n.useEffect)(()=>{Me||q((function*(){try{var t=yield Object(R.getAppModuleInsightListAsync)(e.httpClient,kt);Ct(t)}catch(a){xt(a.statusCode)}}))()},[Me]),Object(n.useEffect)(()=>{if("Ratings"===ve&&!pe.ratings){Object(C.trackPageLoadEvent)(w.TelemetryPageNames.Rating,N.Team.Rating);var e=pe;e.ratings=!0,ge(e)}if("Ratings"===ve&&he.complete&&!he.logged){var t={ratingEmptyState:he.empty};Object(C.trackCustomEvent)(w.RatingScope,{eventName:w.TelemetryEventNames.RatingsRequestComplete,eventData:t});var a=he;a.logged=!0,be(a)}},[ve]),Object(n.useEffect)(()=>{if("Ratings"===ve&&he.complete&&!he.logged){var e={ratingEmptyState:he.empty};Object(C.trackCustomEvent)(w.RatingScope,{eventName:w.TelemetryEventNames.RatingsRequestComplete,eventData:e});var t=he;t.logged=!0,be(t)}},[he]);var[Rt,jt]=r.a.useState([{}]);function Nt(t){Ae===e.t("Common.SelectInsights")&&t.length>0?(Le(function(t){var a=t.substring(8,10),n=new Date(t).toLocaleString("default",{month:"short",timeZone:"UTC"});return e.t("Common.DropDownText",{month:n,day:a})}(t[0])),Xe(!1)):0===t.length&&Xe(!0);var a,n,r=[{key:"",text:""}];r.pop(),t.map(t=>{a=t.substring(8,10),n=new Date(t).toLocaleString("default",{month:"short",timeZone:"UTC"}),r.push({key:t,text:e.t("Common.DropDownText",{month:n,day:a})})}),Ie(r)}Object(n.useEffect)(()=>{var t=null!=Et&&Et.createdDate?String(new Date(parseInt(Et.createdDate,10)).toLocaleString()):"",a=null!=Et&&Et.lastModifiedDate?String(new Date(Et.lastModifiedDate).toLocaleString()):"";St([{title:e.t("DetailsTitles.Owner"),value:null!=Et&&Et.ownerName?Et.ownerName:"",type:h.DetailTypes.Text},{title:e.t("DetailsTitles.Created"),value:t,type:h.DetailTypes.Text},{title:e.t("DetailsTitles.Modified"),value:a,type:h.DetailTypes.Text},{title:e.t("DetailsTitles.WebLink"),value:null!=Et&&Et.webresourceid?Et.webresourceid:"",type:h.DetailTypes.Link},{title:e.t("DetailsTitles.AppID"),value:se,type:h.DetailTypes.Text},{title:e.t("DetailsTitles.LicenseDesignation"),value:e.t("Common.LicenseDesignation"),type:h.DetailTypes.License}])},[Et]),Object(n.useEffect)(()=>{(null==wt?void 0:wt.responseStatus)===h.APIStatus.Succeeded&&(Pe(!0),Fe(!0),ct(!0),ca.current=wt.insights,jt(wt.insights)),(null==wt?void 0:wt.responseStatus)===h.APIStatus.SucceededWithNoData&&(Ge(!0),Pe(!0),Fe(!0)),(null==wt?void 0:wt.responseStatus)===h.APIStatus.Failed&&(Pe(!0),He(!0),Fe(!0))},[wt]),Object(n.useEffect)(()=>{Ve&&nt({primary:e.t("EmptyState.PrimaryMessage"),secondary:e.t("EmptyState.SecondaryMessage")})},[Ve]),Object(n.useEffect)(()=>{Qe&&nt({primary:e.t("EmptyState.PrimaryMessage"),secondary:e.t("EmptyState.SecondaryMessage")})},[Qe]),Object(n.useEffect)(()=>{if(qe&&!Qe){var e=!1;Ne.map(t=>{t.text===Ae&&(e=!0)}),e||$e(!0)}},[Ne]),Object(n.useEffect)(()=>{Je&&(tt(""),nt({primary:e.t("EmptyState.PrimaryFlushed"),secondary:e.t("EmptyState.SecondaryFlushed")}))},[Je]),Object(n.useEffect)(()=>{if(lt&&!qe){var e=!1;Rt.map(t=>{if(!Object(h.checkAvailableDates)(t)&&t.details&&t.checkDate&&(Nt(t.details),e=!0,Ke(!0)),t.severity){var a=h.Severity[t.severity];t.iconName=Object(h.getIconName)(a)}return t}),ee&&!ft&&(ee(),ht(!0)),Ye(e)}},[Rt]),Object(n.useEffect)(()=>{qe&&jt(Rt.filter(h.checkAvailableDates))},[qe]),Object(n.useEffect)(()=>{ot?""!==Ot&&He(!0):st(!0)},[Ot]),Object(n.useEffect)(()=>{Oe(Object(h.utcOffset)(0,De)),ke(Object(h.utcOffset)(-1,De))},[De]),Object(n.useEffect)(()=>{me(Object(g.v4)())},[xe]),Object(n.useEffect)(()=>{Re&&(Oe(Re),ke(Re))},[Re]),Object(n.useEffect)(()=>{Me&&Pe(!1)},[ue]);var[It,At]=r.a.useState({});Object(n.useEffect)(()=>{It.details&&Tt(It.details)},[It]);var Lt=[{title:e.t("PanelTitles.Severity"),key:"severity"},{title:e.t("PanelTitles.Area"),key:"area"},{title:e.t("PanelTitles.Category"),key:"category"},{title:e.t("PanelTitles.Motivation"),key:"insightDescription"},{title:e.t("PanelTitles.Insight"),key:"insight"},{title:e.t("PanelTitles.Recommendation"),key:"recommendation"},{title:e.t("PanelTitles.HowToImprove"),key:"how"},{title:e.t("PanelTitles.Data"),key:"details"},{title:e.t("PanelTitles.InsightId"),key:"insightId"},{title:e.t("PanelTitles.Date"),key:"checkDate"}],Mt=new Set;Mt.add("area"),Mt.add("category"),Mt.add("insightDescription"),Mt.add("recommendation"),Mt.add("insightId");var Pt=[{text:e.t("Common.Apps"),key:"AppsList",href:ce},{text:oe,key:"App",isCurrentItem:!0}],[Bt,Ft]=r.a.useState({severity:!0,category:!0,insight:!0,recommendation:!0,area:!0}),Wt=[{isIconOnly:!0,key:"severityIcon",minWidth:16,maxWidth:16,name:"icon",fieldName:"icon",className:gt.cell,onRender:e=>e.severity===h.Severity.Informational?r.a.createElement(v.FontIcon,{className:gt.iconInfo,iconName:e.iconName}):e.severity===h.Severity.Warning?r.a.createElement(v.FontIcon,{className:gt.iconWarning,iconName:e.iconName}):e.severity===h.Severity.Critical?r.a.createElement(v.FontIcon,{className:gt.iconCritical,iconName:e.iconName}):null},{minWidth:100,maxWidth:110,key:"severity",isResizable:!0,isSorted:!1,isSortedDescending:!1,columnActionsMode:o.ColumnActionsMode.hasDropdown,sortAscendingAriaLabel:e.t("AriaLabels.Ascending"),sortDescendingAriaLabel:e.t("AriaLabels.Descending"),name:e.t("Columns.Severity"),fieldName:"severity",headerClassName:"severityColumn",onColumnClick:()=>{Ft({severity:!1,category:!0,insight:!0,recommendation:!0,area:!0})}},{minWidth:100,maxWidth:150,key:"category",isResizable:!0,isSorted:!1,isSortedDescending:!1,columnActionsMode:o.ColumnActionsMode.hasDropdown,sortAscendingAriaLabel:e.t("AriaLabels.Ascending"),sortDescendingAriaLabel:e.t("AriaLabels.Descending"),name:e.t("Columns.Category"),fieldName:"category",headerClassName:"categoryColumn",onColumnClick:()=>{Ft({severity:!0,category:!1,insight:!0,recommendation:!0,area:!0})}},{minWidth:100,maxWidth:450,key:"insight",isResizable:!0,isSorted:!1,isSortedDescending:!1,columnActionsMode:o.ColumnActionsMode.hasDropdown,sortAscendingAriaLabel:e.t("AriaLabels.Ascending"),sortDescendingAriaLabel:e.t("AriaLabels.Descending"),name:e.t("Columns.Insight"),fieldName:"insight",headerClassName:"insightColumn",onColumnClick:()=>{Ft({severity:!0,category:!0,insight:!1,recommendation:!0,area:!0})}},{minWidth:100,key:"recommendation",isResizable:!0,isSorted:!1,isSortedDescending:!1,columnActionsMode:o.ColumnActionsMode.hasDropdown,sortAscendingAriaLabel:e.t("AriaLabels.Ascending"),sortDescendingAriaLabel:e.t("AriaLabels.Descending"),name:e.t("Columns.Recommendation"),fieldName:"recommendation",headerClassName:"recommendationColumn",onColumnClick:()=>{Ft({severity:!0,category:!0,insight:!0,recommendation:!1,area:!0})}},{minWidth:100,key:"area",isResizable:!0,isSorted:!1,isSortedDescending:!1,columnActionsMode:o.ColumnActionsMode.hasDropdown,sortAscendingAriaLabel:e.t("AriaLabels.Ascending"),sortDescendingAriaLabel:e.t("AriaLabels.Descending"),name:e.t("Columns.Area"),fieldName:"area",headerClassName:"areaColumn",onColumnClick:()=>{Ft({severity:!0,category:!0,insight:!0,recommendation:!0,area:!1})}}],[zt,Ut]=r.a.useState(""),[_t,Ht]=r.a.useState(""),Vt={isSorted:"",isSortedDescending:"",severityAscending:"",severityDescending:""},[Gt,qt]=r.a.useState(Vt),[Yt,Zt]=r.a.useState(Vt);Object(n.useEffect)(()=>{qt(zt!==_t?Vt:Yt)},[zt]);var Kt=e=>{var t=sa.slice(),a=t.filter(e=>zt===e.key)[0];t.forEach(t=>{t===a?(a.isSortedDescending=!e,a.isSorted=!0):(t.isSorted=!1,t.isSortedDescending=!0)}),la(t)},{width:Qt}=Object(h.useWindowDimensions)(),[Xt,Jt]=r.a.useState(E.PaneSize.small);Object(n.useEffect)(()=>{Jt(Qt>=1800?E.PaneSize.medium:E.PaneSize.small)},[Qt]);var $t=(e,t)=>{t?(qt(e?{isSorted:"CheckMark",isSortedDescending:"",severityAscending:"",severityDescending:""}:{isSorted:"",isSortedDescending:"CheckMark",severityAscending:"",severityDescending:""}),Zt(e?{isSorted:"CheckMark",isSortedDescending:"",severityAscending:"",severityDescending:""}:{isSorted:"",isSortedDescending:"CheckMark",severityAscending:"",severityDescending:""})):(qt(e?{isSorted:"",isSortedDescending:"",severityAscending:"CheckMark",severityDescending:""}:{isSorted:"",isSortedDescending:"",severityAscending:"",severityDescending:"CheckMark"}),Zt(e?{isSorted:"",isSortedDescending:"",severityAscending:"CheckMark",severityDescending:""}:{isSorted:"",isSortedDescending:"",severityAscending:"",severityDescending:"CheckMark"}))},ea=e=>{$t(e,!0),Kt(e),jt(e?Rt.slice(0).sort((e,t)=>e[zt].localeCompare(t[zt])):Rt.slice(0).sort((e,t)=>t[zt].localeCompare(e[zt]))),Ht(zt)},ta=e=>{$t(e,!1),Kt(e),jt(e?Rt.slice(0).sort((e,t)=>Object(h.severityWeight)(e[zt]).localeCompare(Object(h.severityWeight)(t[zt]))):Rt.slice(0).sort((e,t)=>Object(h.severityWeight)(t[zt]).localeCompare(Object(h.severityWeight)(e[zt])))),Ht(zt)},aa=[{key:"az",text:e.t("AriaLabels.Ascending"),onClick:()=>{ea(!0)},iconProps:{iconName:Gt.isSorted}},{key:"za",text:e.t("AriaLabels.Descending"),onClick:()=>{ea(!1)},iconProps:{iconName:Gt.isSortedDescending}}],na=[{key:"severityLow",text:e.t("AriaLabels.Ascending"),onClick:()=>{ta(!0)},iconProps:{iconName:Gt.severityAscending}},{key:"severityHigh",text:e.t("AriaLabels.Descending"),onClick:()=>{ta(!1)},iconProps:{iconName:Gt.severityDescending}}],ra=()=>{Ft({severity:!0,category:!0,insight:!0,recommendation:!0,area:!0}),Ut("")},ia=()=>{$e(!1),Ye(!1),Ie([{key:"",text:""}]),He(!1),Ge(!1),qt(Vt),Zt(Vt);var e=sa.slice(),t=e.filter(e=>zt===e.key)[0];e.forEach(e=>{e===t?(t.isSortedDescending=!1,t.isSorted=!1):(e.isSorted=!1,e.isSortedDescending=!1)}),la(e)},oa={dropdown:{width:Object(F.getResponsiveMode)(window)<=F.ResponsiveMode.large?"":200}},[sa,la]=r.a.useState(Wt),ca=r.a.useRef(Rt),da=Object(m.useId)("titleTooltip"),ua=Object(m.useId)("licenseTooltip"),ma={iconName:"Info"},pa={gapSpace:0},ga={onRenderContent:()=>r.a.createElement("div",{className:dt.tooltip},e.t("Common.TooltipInfo"),r.a.createElement(D.Link,{href:"https://go.microsoft.com/fwlink/?linkid=2162551",target:"_blank"},e.t("Common.LearnMore")))},[va,fa]=r.a.useState(""),[ha,ba]=Object(n.useState)(!1);Object(n.useEffect)(()=>{Se&&null!=Se&&Se.current&&ha&&(Se.current.link.click(),ba(!1))},[ha]);var ya=function(){var e=q((function*(e,t){var a=yield function(e,t){return Sa.apply(this,arguments)}(e,t);fa(a),ba(!0)}));return function(t,a){return e.apply(this,arguments)}}();function Sa(){return(Sa=q((function*(t,a){var n=H(H({},kt),{},{startTime:new Date(t),insightId:a});return yield Object(R.getInsightDetailAsync)(e.httpClient,n)}))).apply(this,arguments)}return r.a.createElement("div",{className:mt.full},r.a.createElement("div",{className:mt.main},r.a.createElement(i.Breadcrumb,{className:pt.bread,items:Pt,maxDisplayedItems:2}),r.a.createElement(s.Pivot,{className:pt.pivots,selectedKey:ve,onLinkClick:e=>{var t,a;null!=e&&null!==(t=e.props)&&void 0!==t&&t.itemKey&&fe(e.props.itemKey),"Analytics"!==(null==e||null===(a=e.props)||void 0===a?void 0:a.itemKey)&&Ue()},styles:{itemContainer:{height:"100%",width:"100%",overflow:"hidden",overflowY:"auto",display:"flex"}}},r.a.createElement(s.PivotItem,{headerText:e.t("Pivot.Details"),itemKey:"Details"},Et&&yt.map(t=>r.a.createElement("div",{className:vt.all,key:t.title},r.a.createElement("div",{className:vt.title},t.title),t.type===h.DetailTypes.License&&r.a.createElement(c.Stack,{horizontal:!0},r.a.createElement(c.Stack.Item,null,r.a.createElement("div",{className:vt.iconData},t.value)),r.a.createElement(c.Stack.Item,null,r.a.createElement("div",{className:vt.icon},r.a.createElement(p.TooltipHost,{content:e.t("Common.LicenseTooltip"),id:ua,calloutProps:pa},r.a.createElement(T.IconButton,{iconProps:ma,"aria-label":e.t("Common.Info")}))))),t.type===h.DetailTypes.Link&&r.a.createElement("div",{className:vt.link},r.a.createElement(D.Link,{href:Object(h.buildWebLink)(ne,se,$),underline:!1},Object(h.buildWebLink)(ne,se,$))),t.type===h.DetailTypes.Text&&r.a.createElement("div",{className:vt.data},t.value))),!Et&&r.a.createElement(b.Spinner,{className:vt.spinner,size:b.SpinnerSize.large})),Object(B.RatingPivot)(e,ye),r.a.createElement(s.PivotItem,{headerText:e.t("Pivot.Performance"),itemKey:"Analytics",style:{width:"100%"}},r.a.createElement(c.Stack,null,r.a.createElement(c.Stack,{horizontal:!0,className:dt.all},r.a.createElement(c.Stack.Item,{align:"start",grow:!1},r.a.createElement("h2",{className:dt.title},e.t("Common.Title"))),r.a.createElement(c.Stack.Item,null,r.a.createElement("div",{className:dt.icon},r.a.createElement(p.TooltipHost,{tooltipProps:ga,id:da,calloutProps:pa,closeDelay:200},r.a.createElement(T.IconButton,{iconProps:ma})))),r.a.createElement(c.Stack.Item,{align:"stretch",grow:!0},r.a.createElement(r.a.Fragment,null)),r.a.createElement(c.Stack.Item,{align:"end",styles:{root:{width:Object(F.getResponsiveMode)(window)<=F.ResponsiveMode.large?150:""}}},Ze&&Be&&r.a.createElement(M.Dropdown,{placeholder:Ae,options:Ne,styles:oa,isDisabled:Qe,defaultSelectedKey:et,onChange:(e,t,a)=>{t&&(tt(String(t.key)),Le(t.text),je(new Date(t.key)),ia())}})),r.a.createElement(c.Stack.Item,{align:"end"},!Ze&&Be&&r.a.createElement(l.DatePicker,{value:De,minDate:we,maxDate:Ee,isMonthPickerVisible:!1,onSelectDate:e=>{e&&(Te(Object(h.utcOffset)(0,e)),ia())}})))),Me&&!Qe&&!Je&&!Ve&&!_e&&r.a.createElement("div",{className:dt.all},r.a.createElement(o.DetailsList,{columns:sa,items:Rt,className:dt.list,layoutMode:o.DetailsListLayoutMode.justified,selectionMode:1,onRowDidMount:(e,t)=>{e&&0===t&&At(e),ze()},onActiveItemChanged:e=>{Object(C.trackCustomEvent)(w.PerfCheckerScope,{eventName:w.TelemetryEventNames.ClickInsight,eventData:e}),null!=e&&e.insightId&&it(e.insightId+"_Details.csv"),e&&At(e),ze()}})),_e&&r.a.createElement("div",{className:dt.all},r.a.createElement("div",{className:dt.empty},r.a.createElement(y.EmptyState,{icon:"Clear",primaryMessage:e.t("EmptyState.PrimaryMessageError"),secondaryMessage:e.t("EmptyState.SecondaryMessageError",{requestId:ue,errorMessage:Ot}),maxWidth:600}))),!Bt.severity&&r.a.createElement(I.ContextualMenu,{items:na,target:".severityColumn",onDismiss:ra,onMenuOpened:()=>Ut("severity"),directionalHint:A.DirectionalHint.bottomLeftEdge}),[{target:".categoryColumn",key:"category"},{target:".insightColumn",key:"insight"},{target:".recommendationColumn",key:"recommendation"},{target:".areaColumn",key:"area"}].map(e=>!Bt[e.key]&&r.a.createElement("div",{key:e.key},r.a.createElement(I.ContextualMenu,{items:aa,target:e.target,onDismiss:ra,onMenuOpened:()=>Ut(e.key),directionalHint:A.DirectionalHint.bottomLeftEdge}))),!Me&&!_e&&r.a.createElement("div",{className:dt.all},r.a.createElement(o.DetailsList,{columns:sa,className:dt.list,items:[]}),r.a.createElement(b.Spinner,{size:b.SpinnerSize.large})),(Ve||Je||Qe)&&Me&&!_e&&r.a.createElement("div",{className:dt.all},r.a.createElement("div",{className:dt.empty},r.a.createElement(y.EmptyState,{icon:L.fabricIcons.Chart,primaryMessage:at.primary,secondaryMessage:at.secondary,learnMoreLabel:e.t("Common.LearnMore"),learnMoreProps:{href:"https://go.microsoft.com/fwlink/?linkid=2162551",target:"_blank"},maxWidth:600})))),U.featureGates.enableRecordingsPivot&&!Object(d.isIE11)()&&r.a.createElement(s.PivotItem,{headerText:e.t("Pivot.Recordings"),itemKey:"Recordings",style:{height:"100%",width:"100%"}},r.a.createElement(bt,e)))),r.a.createElement(S.Pane,{isOpen:We,onDismiss:Ue,hasCloseButton:!0,headerText:e.t("PanelTitles.Title"),closeButtonAriaLabel:e.t("AriaLabels.Close"),type:Xt},r.a.createElement("br",null),Lt.map(t=>{return It[t.key]||"how"===t.key?r.a.createElement("div",{key:t.key},"severity"===t.key&&r.a.createElement("div",null,r.a.createElement("div",{className:ut.subtitle},t.title),r.a.createElement("div",{className:ut.itemSpacing},r.a.createElement(c.Stack,{horizontal:!0},r.a.createElement(c.Stack.Item,{align:"start",grow:!1},It[t.key]),r.a.createElement(c.Stack.Item,null,r.a.createElement("div",{className:ut.icon},r.a.createElement(v.FontIcon,{className:(a=It.severity,a===h.Severity.Informational?gt.iconInfo:a===h.Severity.Warning?gt.iconWarning:a===h.Severity.Critical?gt.iconCritical:gt.empty),iconName:It.iconName})))))),"details"===t.key&&""!==Dt[0]&&r.a.createElement("div",null,r.a.createElement("div",{className:ut.subtitle},t.title),""!==It.reference_link2&&r.a.createElement("div",null,It.reference_link2),r.a.createElement("div",{className:ut.itemSpacing},r.a.createElement(o.DetailsList,{items:Dt,selectionMode:0}))),"how"===t.key&&r.a.createElement("div",null,r.a.createElement("div",{className:ut.subtitle},t.title),r.a.createElement("div",{className:ut.itemSpacing},r.a.createElement(D.Link,{href:"https://aka.ms/"+It.insightId,underline:!0,target:"_blank"},e.t("PanelTitles.GetTheGuide")))),"checkDate"===t.key&&r.a.createElement("div",{className:ut.date},e.t("PanelTitles.CheckDate",{checkDate:String(It[t.key]).split("T")[0]})),"insight"===t.key&&r.a.createElement("div",null,r.a.createElement("div",{className:ut.subtitle},t.title),""!==It.reference_link1&&r.a.createElement("div",{className:ut.itemSpacing},r.a.createElement("div",null,It[t.key]," ",r.a.createElement(D.Link,{underline:!0,onClick:e=>ya(It.checkDate||Ee,It.insightId||"")},"Download the detailed list."),r.a.createElement(W.CSVLink,{data:va,filename:rt,className:"hidden",ref:Se,target:"_blank"}))),""===It.reference_link1&&r.a.createElement("div",{className:ut.itemSpacing},It[t.key])),Mt.has(t.key)&&r.a.createElement("div",null,r.a.createElement("div",{className:ut.subtitle},t.title),r.a.createElement("div",{className:ut.itemSpacing},It[t.key]))):null;var a})))})));t.default=Object(C.withPageLoadLogger)(Y,w.TelemetryPageNames.Insight,N.Team.PerfChecker,!0)},8048:function(e,t,a){"use strict";a.r(t),a.d(t,"useStackControlClassStyles",(function(){return i})),a.d(t,"usePanelClassStyles",(function(){return o})),a.d(t,"useScreenControlStyles",(function(){return s})),a.d(t,"useBreadcrumbPivotsStyles",(function(){return l})),a.d(t,"useIconColumnStyles",(function(){return c})),a.d(t,"useDetailsStyles",(function(){return d}));var n=a(719),r=a(8049),i=()=>{var e=Object(r.useTheme)();return Object(n.mergeStyleSets)({all:{padding:"16px 16px 0 8px"},title:{fontSize:"16px",fontWeight:"500",padding:"4px 0 0 0"},icon:{fontSize:"16px"},list:{borderTopStyle:"solid",borderWidth:"1px",borderColor:e.palette.neutralLight},empty:{width:"100%",padding:"16px 0 0 0",borderTopStyle:"solid",borderWidth:"1px",borderColor:e.palette.neutralLight},tooltip:{padding:"8px 8px 8px 8px"}})},o=()=>{var e=Object(r.useTheme)();return Object(n.mergeStyleSets)({subtitle:{color:e.palette.neutralSecondary,fontSize:"12px"},date:{color:e.palette.neutralSecondary,fontSize:"10px",wordWrap:"break-word"},itemSpacing:{padding:"0 0 14px 0",fontSize:"14px",lineHeight:"16px",wordWrap:"break-word"},icon:{padding:"0 0 0 8px"}})},s=()=>Object(n.mergeStyleSets)({full:{position:"relative",display:"flex",width:"100%"},main:{height:"100%",width:"100%",overflow:"auto",display:"flex",flexDirection:"column"}}),l=()=>Object(n.mergeStyleSets)({bread:{padding:"0 0 0 16px"},pivots:{padding:"0 0 0 16px",height:"100%",overflow:"hidden",display:"flex",flexDirection:"column"}}),c=()=>{var e=Object(r.useTheme)();return Object(n.mergeStyleSets)({cell:{textAlign:"center",selectors:{"&:before":{content:".",display:"inline-block",verticalAlign:"middle",height:"100%",width:"0px",visibility:"hidden"}}},iconInfo:{verticalAlign:"middle",fontSize:"16px",color:e.palette.neutralSecondary},iconWarning:{verticalAlign:"middle",fontSize:"16px",color:e.palette.orange},iconCritical:{verticalAlign:"middle",fontSize:"16px",color:e.palette.redDark},empty:{fontSize:"12px"}})},d=()=>{var e=Object(r.useTheme)();return Object(n.mergeStyleSets)({all:{margin:"0 0 0 8px"},title:{fontSize:"14px",padding:"0 0 6px 0"},data:{fontSize:"12px",color:e.palette.neutralSecondary,wordWrap:"break-word",margin:"0 0 20px 0"},spinner:{padding:"32px 90% 0 0"},icon:{fontSize:"18px",color:e.palette.purple},iconData:{padding:"6px 0 0 0",fontSize:e.fonts.small,color:e.palette.neutralSecondary,wordWrap:"break-word"},link:{padding:"0 0 20px 0",fontSize:"12px",color:e.palette.purple}})}},8049:function(e,t,a){"use strict";a.r(t),a.d(t,"useTheme",(function(){return s})),a.d(t,"withTheme",(function(){return l}));var n=a(245),r=a(719),i=a(545);function o(){return(o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function s(){return n.useContext(i.CustomizerContext).customizations.settings.theme||Object(r.getTheme)()}function l(e){return function(t){var a=s();return n.createElement(e,o({},t,{theme:a}))}}},8050:function(e,t,a){"use strict";a.r(t),a.d(t,"Severity",(function(){return n})),a.d(t,"DetailTypes",(function(){return r})),a.d(t,"utcOffset",(function(){return l})),a.d(t,"getIconName",(function(){return c})),a.d(t,"buildWebLink",(function(){return d})),a.d(t,"buildReturnUrl",(function(){return u})),a.d(t,"checkAvailableDates",(function(){return m})),a.d(t,"AppTypes",(function(){return i})),a.d(t,"APIStatus",(function(){return o})),a.d(t,"AppModuleMaxLength",(function(){return p})),a.d(t,"EnvIdMaxLength",(function(){return g})),a.d(t,"EnvIdMinLength",(function(){return v})),a.d(t,"dummyGuid",(function(){return f})),a.d(t,"severityWeight",(function(){return h})),a.d(t,"useWindowDimensions",(function(){return y}));var n,r,i,o,s=a(245);function l(e,t){return new Date(Date.UTC(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()-e,t.getUTCHours(),t.getUTCMinutes()))}function c(e){switch(e){case n.Informational:return"InfoSolid";case n.Warning:return"WarningSolid";case n.Critical:return"StatusErrorFull";default:return""}}function d(e,t,a){return a+"designer/app/00000001-0000-0000-0001-00000000009b/"+t+"/AppDesignerCanvas/"+t+"#/AppDesignerCanvas/"+t}function u(e,t){var a="/environments/"+e+"/apps",n=window.location.href.split("/"+t)[1].split("?")[1];return n?a+"?"+n:a}function m(e){return"InsightAvailableDates"!==e.insightId}!function(e){e.Informational="Informational",e.Warning="Warning",e.Critical="Critical"}(n||(n={})),function(e){e.Text="text",e.Link="link",e.License="license"}(r||(r={})),function(e){e.Canvas="Canvas",e.Model="Model"}(i||(i={})),function(e){e.Succeeded="Succeeded",e.Failed="Failed",e.SucceededWithNoData="SucceededWithNoData"}(o||(o={}));var p=2e3,g=500,v=32,f="00000000-0000-0000-0000-000000000000",h=e=>{switch(e){case"Critical":return"c";case"Warning":return"b";case"Informational":return"a";default:return"z"}};function b(){var{innerWidth:e,innerHeight:t}=window;return{width:e,height:t}}function y(){var[e,t]=Object(s.useState)(b());return Object(s.useEffect)(()=>{function e(){t(b())}return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),e}},8051:function(e,t,a){"use strict";a.r(t),a.d(t,"PerfCheckerScope",(function(){return o})),a.d(t,"RatingScope",(function(){return s})),a.d(t,"TelemetryScenarioNames",(function(){return n})),a.d(t,"TelemetryEventNames",(function(){return r})),a.d(t,"TelemetryPageNames",(function(){return i}));var n,r,i,o="perfchecker",s="rating";!function(e){e.GetPerfCheckerInsights="PerfChecker.Scenario.GetInsights",e.GetPerfCheckerInsightDetail="PerfChecker.Scenario.GetInsightDetail",e.LoadInsightPage="PerfChecker.Scenario.LoadInsightPage",e.LoadDetailPanel="PerfChecker.Scenario.LoadDetailPanel"}(n||(n={})),function(e){e.ClickInsight="ClickInsight",e.RatingsTabEntered="RatingsTabEntered",e.RatingsRequestComplete="RatingsRequestComplete"}(r||(r={})),function(e){e.Insight="/insight",e.Rating="/rating"}(i||(i={}))},8052:function(e,t,a){"use strict";a.r(t),a.d(t,"getAppModuleInsightListAsync",(function(){return c})),a.d(t,"getInsightDetailAsync",(function(){return u}));var n=a(217),r=a(8051),i=a(222),o=a(8050);function s(e,t,a,n,r,i,o){try{var s=e[i](o),l=s.value}catch(c){return void a(c)}s.done?t(l):Promise.resolve(l).then(n,r)}function l(e){return function(){var t=this,a=arguments;return new Promise((function(n,r){var i=e.apply(t,a);function o(e){s(i,n,r,o,l,"next",e)}function l(e){s(i,n,r,o,l,"throw",e)}o(void 0)}))}}function c(e,t){return d.apply(this,arguments)}function d(){return(d=l((function*(e,t){var a,o,s=r.TelemetryScenarioNames.GetPerfCheckerInsights,l=Object(n.trackLoadScenario)(r.PerfCheckerScope,s);try{if(g(t)){var c=p(t);if(v(a=yield e.get(c,{headers:{"x-ms-client-request-id":t.requestId||Object(i.v4)()}}),t.environmentId))return a.data;throw{statusCode:"003",message:"Invalid response"}}throw{statusCode:"002",message:"Invalid request"}}catch(f){var d;throw o=f,{statusCode:f.statusCode||(null===(d=f.request)||void 0===d?void 0:d.status),message:f.message}}finally{var u,m;if(o)l.completeWithError({error:o&&(o.response||o.message),request:t,response:a&&(null===(u=a)||void 0===u?void 0:u.data)});else l.complete({request:t,response:null===(m=a)||void 0===m?void 0:m.data})}}))).apply(this,arguments)}function u(e,t){return m.apply(this,arguments)}function m(){return(m=l((function*(e,t){var a,o,s=r.TelemetryScenarioNames.GetPerfCheckerInsightDetail,l=Object(n.trackLoadScenario)(r.PerfCheckerScope,s);try{if(f(t)){var c=p(t);if(h(a=yield e.get(c,{headers:{"x-ms-client-request-id":t.requestId||Object(i.v4)()}}),t.environmentId))return a.data.details;throw{statusCode:"003",message:"Invalid response"}}throw{statusCode:"002",message:"Invalid request"}}catch(g){var d;return o=g,'{"Result Status": "\'Something went wrong. We couldn’t get the detail. Please try again.", "requestId": "'.concat(t.requestId,'", "statusCode": "').concat(g.statusCode||(null===(d=g.request)||void 0===d?void 0:d.status),'"}')}finally{var u,m;if(o)l.completeWithError({error:o&&(o.response||o.message),request:t,response:a&&(null===(u=a)||void 0===u?void 0:u.data)});else l.complete({request:t,response:null===(m=a)||void 0===m?void 0:m.data})}}))).apply(this,arguments)}function p(e){var t=e.startTime.toISOString(),a=e.endTime.toISOString(),n=null!=o.AppTypes[e.appType]?e.appType:"",r=e.appModuleName.substr(0,o.AppModuleMaxLength),i=e.appId?e.appId:o.dummyGuid,s=e.insightId?"/".concat(e.insightId,"/Details"):"",l=localStorage.getItem("language")||navigator.language||"en-US";return"https://perfchecker/api/AppModuleInsights".concat(s,"?EnvId=").concat(e.environmentId,"&TId=").concat(e.tid,"&AppModuleName=").concat(encodeURIComponent(r),"&Language=").concat(l,"&AppType=").concat(n,"&AppId=").concat(i,"&StartTime=").concat(t,"&EndTime=").concat(a)}function g(e){return!(!y(e.environmentId)||!e.appModuleName||e.appId&&!b(e.appId))}function v(e,t){var a;return!!(null!=e&&null!==(a=e.data)&&void 0!==a&&a.envId&&e.data.envId===t&&e.data.insights&&(e.data.insights.length>0||e.data.responseStatus!==o.APIStatus.Failed))}function f(e){return!(!y(e.environmentId)||!e.appModuleName||e.appId&&!b(e.appId)||!e.insightId)}function h(e,t){var a;return!(null==e||null===(a=e.data)||void 0===a||!a.envId||e.data.envId!==t||!e.data.details||e.data.responseStatus===o.APIStatus.Failed)}function b(e){if(e){return!!/^(\{){0,1}[0-9a-fA-F]{8}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{12}(\}){0,1}$/.test(e)}return!1}function y(e){return!!(e&&e.length>=o.EnvIdMinLength&&e.length<o.EnvIdMaxLength)}},8053:function(e,t,a){"use strict";a.r(t),a.d(t,"RatingPivot",(function(){return V}));var n=a(245),r=a.n(n),i=a(1709),o=a(1101),s=a(8054),l=a(8055),c=a.n(l),d=a(684),u=a(8056),m=a.n(u),p=a(8057),g=a.n(p),v=a(8058),f=a.n(v),h=a(8059),b=a(8062),y=a(8063),S=a(8064),E=a(8065),w=a(5117),C=a(1259),O=a(8060),x=a(8049),k=a(3161),D=a(1090),T=a(1201),R=a(687),j=a(1240),N=a(2898),I=a(8066),A=a(1105),L=a(8068),M=a(9043),P=a(9044),B=a(9312),F=a(9344),W=a(8067),z=a(217),U=a(9350);function _(e,t,a,n,r,i,o){try{var s=e[i](o),l=s.value}catch(c){return void a(c)}s.done?t(l):Promise.resolve(l).then(n,r)}function H(e){return function(){var t=this,a=arguments;return new Promise((function(n,r){var i=e.apply(t,a);function o(e){_(i,n,r,o,s,"next",e)}function s(e){_(i,n,r,o,s,"throw",e)}o(void 0)}))}}var V=(e,t)=>{var a,l,u,p,{match:v}=e,[_,V]=Object(O.useResizeObserver)(),{currentEnvironment:G}=Object(n.useContext)(A.EnvironmentContext),q=Object(A.getCrmInstanceUrl)(G),Y=v.params.environmentId.toLocaleLowerCase(),Z=v.params.type,K=v.params.readable,Q=Object(O.buildSolutionUrl)(Y,Z),X=v.params.appId.toLocaleLowerCase(),J=(new Date).toLocaleString(navigator.language,{dateStyle:"short"}),$={poor:e.t("Rating.Scores.Poor"),fair:e.t("Rating.Scores.Fair"),good:e.t("Rating.Scores.Good"),world:e.t("Rating.Scores.World"),none:e.t("Rating.Scores.None"),score:e.t("Rating.Scores.Score")},ee={vDis:e.t("Rating.Metrics.VDis"),dis:e.t("Rating.Metrics.Dis"),sat:e.t("Rating.Metrics.Sat"),vSat:e.t("Rating.Metrics.VSat")},te={Chrome:e.t("Rating.Browsers.Chrome"),Safari:e.t("Rating.Browsers.Safari"),Edge:e.t("Rating.Browsers.Edge"),Firefox:e.t("Rating.Browsers.Firefox"),IE:e.t("Rating.Browsers.IE"),Opera:e.t("Rating.Browsers.Opera"),Android:e.t("Rating.Browsers.Android"),EdgeLegacy:e.t("Rating.Browsers.EdgeLegacy"),SamsungInternet:e.t("Rating.Browsers.SamsungInternet"),UCBrowser:e.t("Rating.Browsers.UC Browser"),Unknown:e.t("Rating.Browsers.Unknown"),Web:e.t("Rating.Platforms.Web"),Mobile:e.t("Rating.Platforms.Mobile")},[ae,ne]=Object(n.useState)("".concat(e.t("Rating.Rating")).concat(J).concat(K)),[re,ie]=Object(n.useState)(O.preRequestTemplate),[oe,se]=Object(n.useState)(),[le,ce]=Object(n.useState)(),[de,ue]=Object(n.useState)(24),[me,pe]=Object(n.useState)(!1),[ge,ve]=Object(n.useState)(Object(b.getGaugeOptions)(0,$)),[fe,he]=Object(n.useState)(Object(y.getGaugeLegend)($,!1)),[be,ye]=Object(n.useState)(Object(y.getSatisfactionBarOptions)({vDis:[0],dis:[0],sat:[0],vSat:[0]},ee,!1)),[Se,Ee]=Object(n.useState)(Object(S.getColumnDeviceOptions)([{device:"",score:0}])),[we,Ce]=Object(n.useState)(Object(S.getColumnBrowserOptions)([{browser:"",score:0}])),Oe=Object(n.useRef)(null),xe=Object(O.buildMonitorUrl)(Y,X,q,K),ke="https://go.microsoft.com/fwlink/?linkid=2174293",[De,Te]=r.a.useState(""),[Re,je]=r.a.useState(!1),[Ne,Ie]=r.a.useState({primary:e.t("Rating.Empty.Primary"),secondary:" ",href:ke}),Ae=Object(n.useRef)(null);Object(n.useEffect)(()=>{null!=Ae&&Ae.current&&Re&&(Ae.current.link.click(),je(!1))},[Re]),Object(n.useEffect)(()=>{oe&&ce(oe.slice(0,de))},[oe]),Object(n.useEffect)(()=>{le&&oe&&(le.length<oe.length?pe(!0):pe(!1))},[le]),Object(n.useEffect)(()=>{24!==de&&oe&&ce(oe.slice(0,de))},[de]),Object(n.useEffect)(()=>{if(re.complete&&(t.setRatingsCompletedData({complete:!0,empty:re.empty,logged:!1}),ne("".concat(ae).concat(Object(A.getEnvironmentDisplayName)(G),".csv"))),re.complete&&!re.empty){re.comments&&ta(re.reviewData),Oe.current=Object(E.getScoreLineChartOptions)(re.scores,re.oldestDate.year,re.oldestDate.month);var e=!1;null!=He&&He.isZoom&&(e=He.isZoom),ve(Object(b.getGaugeOptions)(re.recentScore,$)),he(Object(y.getGaugeLegend)($,e)),ye(Object(y.getSatisfactionBarOptions)({vDis:[re.allScores.vDis],dis:[re.allScores.dis],sat:[re.allScores.sat],vSat:[re.allScores.vSat]},ee,e)),Ce(Object(S.getColumnBrowserOptions)(re.browsers)),Ee(Object(S.getColumnDeviceOptions)(re.devices))}},[re]);var Le=X,Me=null==G||null===(a=G.properties.linkedEnvironmentMetadata)||void 0===a?void 0:a.instanceUrl,Pe=r.a.useMemo(()=>G?e.getMetadataClient(G):void 0,[G,e.getMetadataClient]),Be=(null==G||null===(l=G.properties)||void 0===l?void 0:l.linkedEnvironmentMetadata)&&parseInt(G.properties.linkedEnvironmentMetadata.baseLanguage,10)||1033,Fe=r.a.useMemo(()=>Me?L.MetadataCache.getInstance(Me,Be):void 0,[null==G||null===(u=G.properties.linkedEnvironmentMetadata)||void 0===u?void 0:u.instanceUrl]),We=r.a.useMemo(()=>Pe&&Me&&Fe?new M.MDLMetadataProvider(Pe,Fe,Me):void 0,[Fe,Pe,null==G||null===(p=G.properties.linkedEnvironmentMetadata)||void 0===p?void 0:p.instanceUrl]),ze=r.a.useMemo(()=>We?Promise.resolve(We):void 0,[We]),Ue=r.a.useRef(P.ModelDataProvider.getInstance(G,ze));Object(n.useEffect)(()=>{function t(){return(t=H((function*(){try{var t,a,n=Object(I.getRatingFetchMetadataXML)(Le),r=B.ModernQueryBuilder.fromXml(n);r.pageSize=5e3;var i=yield null==Ue||null===(t=Ue.current)||void 0===t?void 0:t.retrieveGridData(r.getQueryState()),o=null==i||null===(a=i.entities)||void 0===a?void 0:a[W.RATING_ETN],s=[];if(o)for(var[l,c]of Object.entries(o)){var d,u,m,p,g,v,f,h,b,y,S,E,w=l,C=null==c?void 0:c.fields;if(C)s.push({userratingid:w,dateCreated:null!==(d=null==C||null===(u=C[W.ATTRIBUTE_DATE_CREATED])||void 0===u?void 0:u.value)&&void 0!==d?d:"",score:null!==(m=null==C||null===(p=C[W.ATTRIBUTE_SCORE])||void 0===p?void 0:p.value)&&void 0!==m?m:"",browser:null!==(g=null==C||null===(v=C[W.ATTRIBUTE_BROWSER])||void 0===v?void 0:v.value)&&void 0!==g?g:"",comment:null!==(f=null==C||null===(h=C[W.ATTRIBUTE_COMMENT])||void 0===h?void 0:h.value)&&void 0!==f?f:"",appmoduleId:null!==(b=null==C||null===(y=C[W.ATTRIBUTE_APP_MODULE_ID])||void 0===y?void 0:y.value)&&void 0!==b?b:"",device:null!==(S=null==C||null===(E=C[W.ATTRIBUTE_DEVICE])||void 0===E?void 0:E.value)&&void 0!==S?S:""})}ie(Object(O.processRequestData)(s,te))}catch(k){if(k instanceof Error){var x=Object.create(re);k.message.includes("is neither system admin nor the app owner")?(Ie({primary:e.t("Rating.Permission.Primary"),secondary:e.t("Rating.Permission.Secondary"),href:ke}),x.complete=!0,ie(x)):k.message.includes("Could not find any AppModuleEntity")?(Ie({primary:e.t("Rating.Permission.NotPublished"),secondary:" ",href:ke}),x.complete=!0,ie(x)):k.message.includes("There is no data in your app or the appModuleId is missing")?(Ie({primary:e.t("Rating.Empty.Primary"),secondary:"",href:ke}),x.complete=!0,ie(x)):(Ie({primary:e.t("Rating.Permission.Unknown"),secondary:k.message,href:ke}),x.complete=!0,ie(x))}}}))).apply(this,arguments)}if(o.featureGates.enableRatingsPivot)!function(){t.apply(this,arguments)}();else{var a=re;a.complete=!0,ie(a)}},[]);var{width:_e}=Object(O.useWindowDimensions)(),[He,Ve]=r.a.useState(),[Ge,qe]=r.a.useState("300px"),Ye=Object(x.useTheme)(),Ze=Object(O.getColumnSizes)(_e-O.adjustments.menuOpen),Ke=Object(O.getCardSizes)(_e-O.adjustments.menuOpen),Qe=Object(O.getImproveFormat)(_e-O.adjustments.menuOpen),[Xe,Je]=Object(n.useState)(!1),[$e,et]=Object(n.useState)(Ze),[tt,at]=Object(n.useState)(Object(h.changeColumnOne)(Ze.one,Ye)),[nt,rt]=Object(n.useState)(Object(h.changeColumnTwo)(Ze.two,Ye,Ze.space)),[it,ot]=Object(n.useState)(Object(h.changeColumnThree)(Ze.three,Ye,Qe)),[st,lt]=Object(n.useState)(Object(h.changeColumnThreeAlt)(Ze.three,_e-O.adjustments.menuOpen,Qe,Ye,Ze.space)),[ct,dt]=Object(n.useState)(Qe),[ut,mt]=Object(n.useState)(Object(h.changeReviewFilterRow)($e.size)),[pt,gt]=Object(n.useState)(Ke),[vt,ft]=Object(n.useState)(Object(h.changeReviewCard)(Ke,Ye)),[ht,bt]=Object(n.useState)(!0),[yt,St]=Object(n.useState)(!1),Et=Object(h.useRowControl)(),[wt,Ct]=Object(n.useState)(Object(h.useLowData)(!1)),Ot=Object(h.useModal)(),xt=Object(h.useRatingControl)(),kt=Object(h.useWaitEmpty)(),[Dt,Tt]=Object(n.useState)("ViewAll"),[Rt,jt]=Object(n.useState)(""),[Nt,{setTrue:It,setFalse:At}]=Object(N.useBoolean)(!1),Lt=0,Mt=1,Pt=2;function Bt(e){var t=!1;null!=He&&He.isZoom&&(t=He.isZoom),ve(Object(b.getGaugeOptions)(re.recentScore,$)),he(Object(y.getGaugeLegend)($,t)),ye(Object(y.getSatisfactionBarOptions)({vDis:[re.allScores.vDis],dis:[re.allScores.dis],sat:[re.allScores.sat],vSat:[re.allScores.vSat]},ee,t))}m()(s),g()(s),f()(s),Object(n.useEffect)(()=>{var e=function(e){var t=e-O.adjustments.menuClosed-16,a=e<=O.sizes.tiny;if(a){var n=t-16;qe(Object(O.toPixles)(n))}else qe("300px");return Ct(Object(h.useLowData)(a)),Ve({width:t,isZoom:a}),{width:t,isZoom:a}}(_e);e.isZoom&&re.complete?(gt(Object(O.getCardSizes)(e.width)),et(Object(O.getColumnSizes)(e.width)),Bt(e.width)):null!=V&&V.width&&re.complete&&(gt(Object(O.getCardSizes)(V.width)),et(Object(O.getColumnSizes)(V.width)),Bt(V.width))},[null==V?void 0:V.width]),Object(n.useEffect)(()=>{var e=$e.size;null!=He&&He.isZoom&&He.isZoom&&(e=O.formatValues.tiny),dt(e),at(Object(h.changeColumnOne)($e.one,Ye));var t=e===O.formatValues.tiny||e===O.formatValues.small;if(rt(Object(h.changeColumnTwo)($e.two,Ye,t)),e>O.formatValues.large&&null!=V&&V.width){var a=Object(O.getColumnSizes)(V.width);lt(Object(h.changeColumnThreeAlt)(a.three,V.width,e,Ye,a.space))}else ot(Object(h.changeColumnThree)($e.three,Ye,e));var n=Pt;e===O.formatValues.medium?n=Mt:e===O.formatValues.large&&(n=Lt),mt(Object(h.changeReviewFilterRow)(n)),Je(!0)},[$e]),Object(n.useEffect)(()=>{Tt(ht?"ViewAll":"List")},[ht]),Object(n.useEffect)(()=>{Xe&&(s.charts.forEach(e=>{null==e||e.reflow()}),Je(!1))},[Xe]),Object(n.useEffect)(()=>{ft(Object(h.changeReviewCard)(pt,Ye))},[pt]);var Ft="-1",Wt="4",zt="3",Ut="2",_t="1",Ht=[{key:Ft,text:e.t("Rating.Metrics.All")},{key:Wt,text:e.t("Rating.Metrics.VSat")},{key:zt,text:e.t("Rating.Metrics.Sat")},{key:Ut,text:e.t("Rating.Metrics.Dis")},{key:_t,text:e.t("Rating.Metrics.VDis")}],[Vt,Gt]=Object(n.useState)({text:"",dateAsc:!1,satisfaction:Ft}),[qt,Yt]=Object(n.useState)(e.t("Rating.Reviews.Filter.NewOld")),[Zt,Kt]=Object(n.useState)(Ft),[Qt,Xt]=Object(n.useState)("");function Jt(e,t,a){var n=re.reviewData;if(t){if(Kt(t),t!==Ft)n=ea(t,n);else Vt.satisfaction=t;0!==Vt.text.length&&(n=$t(Vt.text,n)),n=na(Vt.dateAsc,n)}if(a||""===a){Xt(a),""!==a&&(n=$t(a,n));var r=Vt;r.text=a,Gt(r),n=ea(null,n),n=na(Vt.dateAsc,n)}null!==e&&(""!==Vt.text&&(n=$t(Vt.text,n)),n=na(e,n=ea(null,n))),ta(n)}function $t(e,t){return t.filter(t=>t.review.toLowerCase().includes(e.toLowerCase()))}function ea(e,t){var a=Vt,n=Vt.satisfaction;return e&&(a.satisfaction=e,Gt(a)),n!==Ft||e?(e&&(n=e),t.filter(e=>e.satisfaction.toString()===n)):t}function ta(e){e&&0!==e.length?(St(!1),se(e.filter(aa))):(St(!0),se([]))}function aa(e){return""!==e.review}function na(t,a){var n=Vt;return t?(n.dateAsc=!0,Gt(n),Yt(e.t("Rating.Reviews.Filter.OldNew")),a.sort(O.dateSortAsc)):(n.dateAsc=!1,Gt(n),Yt(e.t("Rating.Reviews.Filter.NewOld")),a.sort(O.dateSortDesc))}var ra={items:[{key:"newOld",text:e.t("Rating.Reviews.Filter.NewOld"),onClick:()=>Jt(!1,null,null)},{key:"oldNew",text:e.t("Rating.Reviews.Filter.OldNew"),onClick:()=>Jt(!0,null,null)}]},ia={items:[{key:"Tile",text:"Card View",iconProps:{iconName:"ViewAll"},onClick:()=>bt(!0)},{key:"Line",text:"List View",iconProps:{iconName:"List"},onClick:()=>bt(!1)}]},oa={iconName:Dt},sa=Object(N.useId)("satScoreTooltip"),la=Object(N.useId)("scoreTrendTooltip"),ca={gapSpace:0,maxWidth:600},da={iconName:"Info"},ua={root:{color:Ye.palette.neutralPrimary,margin:"4px 2px 0 auto"},rootHovered:{color:Ye.palette.neutralDark}},ma=e=>1===e?ee.vDis:2===e?ee.dis:3===e?ee.sat:4===e?ee.vSat:"",pa=e=>{if(1===e)window.open(Q,"_blank");else if(2===e)t.setSelectedPivot("Analytics");else if(3===e)window.open(xe,"_blank");else{if(4!==e)return;window.open(O.improveAppUrl,"_blank")}var a={buttonClicked:e};Object(z.trackUserActionClickButton)(U.RatingScope,U.TelemetryEventNames.RatingsButtonClicked,a)},ga={onRenderContent:()=>r.a.createElement("div",{className:tt.tooltip},e.t("Common.SatisfactionScoreTooltip"),r.a.createElement(D.Link,{href:ke,target:"_blank"},e.t("Common.LearnMore")))},va={onRenderContent:()=>r.a.createElement("div",{className:tt.tooltip},e.t("Common.ScoreTrendTooltip"),r.a.createElement(D.Link,{href:ke,target:"_blank"},e.t("Common.LearnMore")))};function fa(){return(fa=H((function*(){if(re.empty)return"";var t=[];return t.push([e.t("Rating.Card.Headers.SatScore"),re.recentScore.toString()]),t.push([""]),t.push([e.t("Rating.Download.ReviewDate"),e.t("Rating.Download.ReviewScore"),e.t("Rating.Download.ReviewComment"),e.t("Rating.Download.ReviewDevice"),e.t("Rating.Download.ReviewBrowser")]),re.reviewData.map(e=>{t.push([e.date,ma(e.satisfaction),e.review,e.device,ba(e.device,e.browser,!1)])}),t}))).apply(this,arguments)}var ha=function(){var e=H((function*(){var e=yield function(){return fa.apply(this,arguments)}();Te(e),je(!0)}));return function(){return e.apply(this,arguments)}}(),ba=(e,t,a)=>{var n=" • "+t;return a||(n=t),"Mobile"!==e?n:""};return o.featureGates.enableRatingsPivot?r.a.createElement(i.PivotItem,{headerText:e.t("Pivot.Ratings"),itemKey:"Ratings",className:xt.whole},!re.empty&&re.complete&&r.a.createElement("div",{ref:_},r.a.createElement("div",{className:Et.spacer},re.lowData&&r.a.createElement("div",{className:wt.space},r.a.createElement(C.Stack,{horizontal:!0},r.a.createElement(R.FontIcon,{iconName:"Warning",className:wt.icon}),r.a.createElement("p",{className:wt.message},e.t("Rating.Empty.LowData")),r.a.createElement(D.Link,{href:ke,underline:!1,target:"_blank"},e.t("Common.LearnMore")))),r.a.createElement("div",{className:Et.row,role:"main"},r.a.createElement(C.Stack,{horizontal:!0,wrap:!0},r.a.createElement("div",{className:tt.space},r.a.createElement("div",{className:tt.gauge,role:"region","aria-label":e.t("Rating.Card.Headers.SatScore")},r.a.createElement(C.Stack,{horizontal:!0},r.a.createElement(C.Stack.Item,{align:"start",grow:!0,className:xt.whole},r.a.createElement("div",{className:Et.header},r.a.createElement("p",null,e.t("Rating.Card.Headers.SatScore")))),r.a.createElement(C.Stack.Item,{align:"end"},r.a.createElement("div",{className:tt.icon},r.a.createElement(j.TooltipHost,{id:sa,calloutProps:ca,tooltipProps:ga,closeDelay:200},r.a.createElement(d.IconButton,{iconProps:da,className:Et.icon,role:"tooltip","aria-label":e.t("Common.SatisfactionScoreTooltip")}))))),r.a.createElement("div",{className:Et.separator},r.a.createElement(c.a,{highcharts:s,options:ge,allowChartUpdate:!0})),r.a.createElement(c.a,{highcharts:s,options:fe,allowChartUpdate:!0}),r.a.createElement("div",{className:tt.reviewCount},e.t("Rating.ReviewNumber",{reviewCount:re.allScores.count})),r.a.createElement(c.a,{highcharts:s,options:be,allowChartUpdate:!0})),r.a.createElement("div",{className:tt.line,role:"region","aria-label":e.t("Rating.Card.Headers.Trend")},r.a.createElement(C.Stack,{horizontal:!0},r.a.createElement(C.Stack.Item,{align:"start",grow:!0,className:xt.whole},r.a.createElement("div",{className:Et.header},r.a.createElement("p",null,e.t("Rating.Card.Headers.Trend")))),r.a.createElement(C.Stack.Item,{align:"end"},r.a.createElement("div",{className:tt.icon},r.a.createElement(j.TooltipHost,{id:la,calloutProps:ca,tooltipProps:va,closeDelay:200},r.a.createElement(d.IconButton,{iconProps:da,className:Et.icon,role:"tooltip","aria-label":e.t("Common.ScoreTrendTooltip")}))))),r.a.createElement("div",{className:Et.separator},r.a.createElement("div",{className:Et.graphSpaceLine},r.a.createElement(c.a,{highcharts:s,options:Oe.current,allowChartUpdate:!0}))))),r.a.createElement("div",{className:nt.space},r.a.createElement("div",{className:nt.device,role:"region","aria-label":e.t("Rating.Card.Headers.SatDevice")},r.a.createElement("div",{className:Et.header},r.a.createElement("p",null,e.t("Rating.Card.Headers.SatDevice"))),r.a.createElement("div",{className:Et.separator},r.a.createElement("div",{className:Et.graphSpace},r.a.createElement(c.a,{highcharts:s,options:Se,allowChartUpdate:!0})))),r.a.createElement("div",{className:nt.browser,role:"region","aria-label":e.t("Rating.Card.Headers.SatBrowser")},r.a.createElement("div",{className:Et.header},r.a.createElement("p",null,e.t("Rating.Card.Headers.SatBrowser"))),r.a.createElement("div",{className:Et.separator},r.a.createElement("div",{className:Et.graphSpace},r.a.createElement(c.a,{highcharts:s,options:we,allowChartUpdate:!0}))))),ct<=0&&r.a.createElement("div",{className:it.space},r.a.createElement("div",{className:it.full,role:"region","aria-label":e.t("Rating.Card.Headers.ImproveApp")},r.a.createElement("div",{className:Et.header},r.a.createElement("p",null,e.t("Rating.Card.Headers.ImproveApp"))),r.a.createElement("div",{className:Et.separator},r.a.createElement(C.Stack,{horizontal:!0,wrap:!0},r.a.createElement("div",{className:it.item},r.a.createElement("p",{className:it.description},e.t("Rating.Card.Description.First")),r.a.createElement(d.DefaultButton,{text:e.t("Rating.Card.Button.First"),className:it.action,onClick:()=>pa(1)})),r.a.createElement("div",{className:it.item},r.a.createElement("p",{className:it.description},e.t("Rating.Card.Description.Second")),r.a.createElement(d.DefaultButton,{text:e.t("Rating.Card.Button.Second"),className:it.action,onClick:()=>pa(2)})),r.a.createElement("div",{className:it.item},r.a.createElement("p",{className:it.description},e.t("Rating.Card.Description.Third")),r.a.createElement(d.DefaultButton,{text:e.t("Rating.Card.Button.Third"),className:it.action,onClick:()=>pa(3)})),r.a.createElement("div",{className:it.item},r.a.createElement("p",{className:it.description},e.t("Rating.Card.Description.Fourth")),r.a.createElement(d.DefaultButton,{text:e.t("Rating.Card.Button.Fourth"),className:it.action,onClick:()=>pa(4)})))))),ct>0&&r.a.createElement("div",{className:st.space},r.a.createElement("div",{className:st.full,role:"region","aria-label":e.t("Rating.Card.Headers.ImproveApp")},r.a.createElement("div",{className:Et.header},r.a.createElement("p",null,e.t("Rating.Card.Headers.ImproveApp"))),r.a.createElement("div",{className:Et.separator},r.a.createElement(C.Stack,{horizontal:!0,wrap:!0},r.a.createElement("div",{className:st.item},r.a.createElement("p",{className:st.description},e.t("Rating.Card.Description.First")),r.a.createElement(d.DefaultButton,{text:e.t("Rating.Card.Button.First"),className:st.action,onClick:()=>pa(1)})),r.a.createElement("div",{className:st.item},r.a.createElement("p",{className:st.description},e.t("Rating.Card.Description.Second")),r.a.createElement(d.DefaultButton,{text:e.t("Rating.Card.Button.Second"),onClick:()=>pa(2),className:st.action})),r.a.createElement("div",{className:st.item},r.a.createElement("p",{className:st.description},e.t("Rating.Card.Description.Third")),r.a.createElement(d.DefaultButton,{text:e.t("Rating.Card.Button.Third"),className:st.action,onClick:()=>pa(3)})),r.a.createElement("div",{className:st.item},r.a.createElement("p",{className:st.description},e.t("Rating.Card.Description.Fourth")),r.a.createElement(d.DefaultButton,{text:e.t("Rating.Card.Button.Fourth"),className:st.action,onClick:()=>pa(4)})))))))),re.comments&&r.a.createElement("div",null,r.a.createElement("div",{role:"region","aria-label":e.t("Rating.Reviews.Title")},r.a.createElement("h2",{className:ut.title},e.t("Rating.Reviews.Title")),r.a.createElement("div",{className:ut.space},r.a.createElement(C.Stack,{horizontal:!0,wrap:!0},r.a.createElement(C.Stack.Item,{align:"start",grow:!1},r.a.createElement("div",{className:ut.gap},r.a.createElement(w.FilterSearchBox,{strings:{searchBoxPlaceholder:e.t("Rating.Reviews.Filter.Placeholder")},searchText:Qt,onSearchTextChange:(e,t)=>Jt(null,null,function(e){return void 0===e||0===e.length?"":e}(t)),filters:Ht,selectedFilterKey:Zt,onFilterChange:e=>Jt(null,e,null),styles:{root:{width:Ge}}}))),r.a.createElement(C.Stack.Item,null,r.a.createElement(d.CommandBarButton,{text:qt,menuProps:ra,className:ut.newOld})),r.a.createElement(C.Stack.Item,null,r.a.createElement(d.IconButton,{menuProps:ia,iconProps:oa,title:"Tile"})),r.a.createElement(C.Stack.Item,{align:"stretch",grow:!0},r.a.createElement(r.a.Fragment,null)),r.a.createElement(C.Stack.Item,{align:"end"},r.a.createElement(D.Link,{underline:!1,onClick:e=>ha(),className:ut.download,role:"link","aria-label":e.t("Rating.Download.Button")},e.t("Rating.Download.Button")),r.a.createElement(F.CSVLink,{data:De,filename:ae,className:"hidden","aria-hidden":"true",tabIndex:-1,ref:Ae,target:"_blank"}))))),r.a.createElement(C.Modal,{isOpen:Nt,onDismiss:At,isModeless:!0,containerClassName:Ot.container},r.a.createElement("div",{className:Ot.header},r.a.createElement(d.IconButton,{iconProps:{iconName:"Cancel"},onClick:At,styles:ua})),r.a.createElement("div",{className:Ot.body},r.a.createElement("p",null,Rt))),ht&&r.a.createElement(C.Stack,{horizontal:!0,wrap:!0},null==le?void 0:le.map(t=>r.a.createElement(C.Stack.Item,{key:t.key,className:xt.font},r.a.createElement("div",{className:vt.card},r.a.createElement("div",{className:vt.space},r.a.createElement("h5",null,ma(t.satisfaction)),r.a.createElement("div",{className:vt.meta},t.date+" • ",t.device,ba(t.device,t.browser,!0)),r.a.createElement("br",null),r.a.createElement("p",{className:vt.review},t.review),t.more&&r.a.createElement(D.Link,{underline:!1,onClick:()=>(e=>{jt(e),It()})(t.review),className:Ot.more},e.t("Rating.Reviews.More"))))))),!ht&&r.a.createElement(C.Stack,{horizontal:!1,wrap:!0,className:xt.whole},null==le?void 0:le.map(e=>r.a.createElement(C.Stack.Item,{key:e.key},r.a.createElement("div",{className:vt.listSpace},r.a.createElement("h4",null,ma(e.satisfaction)),r.a.createElement("div",{className:vt.meta},e.date+" • ",e.device,ba(e.device,e.browser,!0)),r.a.createElement("div",{className:vt.listReview},e.review))))),yt&&r.a.createElement("div",{className:vt.center},r.a.createElement("h3",{className:vt.noMatch},e.t("Rating.Reviews.NoMatch")),r.a.createElement("div",{className:vt.buffer})),me&&r.a.createElement("div",null,r.a.createElement(d.DefaultButton,{text:e.t("Rating.ShowMore"),onClick:()=>ue(de+24),className:vt.showMore}),r.a.createElement("div",{className:vt.buffer}))))),re.empty&&re.complete&&r.a.createElement("div",{className:kt.emptySpinner},r.a.createElement(k.EmptyState,{icon:"Feedback",primaryMessage:Ne.primary,secondaryMessage:Ne.secondary,learnMoreLabel:e.t("Common.LearnMore"),learnMoreProps:{href:Ne.href,target:"_blank"},maxWidth:600})),!re.complete&&r.a.createElement(T.Spinner,{className:kt.emptySpinner,size:T.SpinnerSize.large})):null}},8059:function(e,t,a){"use strict";a.r(t),a.d(t,"universalFont",(function(){return c})),a.d(t,"changeColumnOne",(function(){return d})),a.d(t,"changeColumnTwo",(function(){return u})),a.d(t,"changeColumnThree",(function(){return m})),a.d(t,"changeColumnThreeAlt",(function(){return p})),a.d(t,"changeReviewCard",(function(){return g})),a.d(t,"useRatingControl",(function(){return v})),a.d(t,"useRowControl",(function(){return f})),a.d(t,"useWaitEmpty",(function(){return h})),a.d(t,"changeReviewFilterRow",(function(){return b})),a.d(t,"useLowData",(function(){return y})),a.d(t,"useModal",(function(){return S}));var n=a(719),r=a(8049),i=a(8060);function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){l(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var c='"Segoe UI"';function d(e,t){return Object(n.mergeStyleSets)({space:{display:"block",width:e,height:"530px",margin:"0 10px 0 0 !important"},gauge:{height:"330px",position:"relative",borderStyle:"solid",borderWidth:"1px",borderRadius:"2px",boxShadow:"1px 1.5px 4px "+t.palette.neutralLight,borderColor:t.palette.neutralLight},line:{height:"170px",position:"relative",marginTop:"25px",borderStyle:"solid",borderRadius:"2px",boxShadow:"1px 1.5px 4px "+t.palette.neutralLight,borderWidth:"1px",borderColor:t.palette.neutralLight},icon:{fontSize:"20px",color:t.palette.purple},tooltip:{padding:"8px 8px 8px 8px",maxWidth:"600px"},reviewCount:{fontSize:"12px",fontWeight:700,paddingTop:"8px",marginLeft:"5%"}})}function u(e,t,a){var r="0";return a&&(r="25px"),Object(n.mergeStyleSets)({space:{display:"block",width:e,height:"530px",margin:"0 10px 0 0 !important"},device:{height:"250px",position:"relative",marginTop:r,borderStyle:"solid",borderRadius:"2px",boxShadow:"1px 1.5px 4px "+t.palette.neutralLight,borderWidth:"1px",borderColor:t.palette.neutralLight},browser:{height:"250px",position:"relative",marginTop:"25px",borderStyle:"solid",borderRadius:"2px",boxShadow:"1px 1.5px 4px "+t.palette.neutralLight,borderWidth:"1px",borderColor:t.palette.neutralLight}})}function m(e,t,a){var r="0";return-1===a&&(r="50px"),Object(n.mergeStyleSets)({space:{display:"block",width:e,height:"530px"},full:{marginTop:r,height:"525px",position:"relative",borderStyle:"solid",borderRadius:"2px",boxShadow:"1px 1.5px 4px "+t.palette.neutralLight,borderWidth:"1px",borderColor:t.palette.neutralLight},description:{width:"50%",marginRight:"5px"},action:{display:"block",margin:"0 auto 0 auto"},item:{width:"100%",display:"flex",padding:"0 4% 0 4%",marginTop:"7.5% !important"}})}function p(e,t,a,r,o){var s="25px";o&&(s="50px");var l=function(e){var t=e;t=e<i.sizes.medium?e*i.adjustments.twoCards:e*i.adjustments.fourCards;return Object(i.toPixles)(t)}(t),c=function(e){return e!==i.formatValues.small?{space:"230px",full:"225px"}:{space:"345px",full:"340px"}}(a);return Object(n.mergeStyleSets)({space:{display:"block",width:e,height:c.space},full:{marginTop:s,borderStyle:"solid",borderRadius:"2px",boxShadow:"1px 1.5px 4px "+r.palette.neutralLight,borderWidth:"1px",borderColor:r.palette.neutralLight,height:c.full,position:"relative"},description:{padding:"5px 5px 5px 5px",height:"60px",textAlign:"center"},action:{display:"block",margin:"8px auto 0 auto"},item:{width:l,display:"block",paddingTop:"40px",marginLeft:"8px"}})}function g(e,t){return Object(n.mergeStyleSets)({space:{margin:"10px 16px 24px 16px"},listSpace:{margin:"0 0 24px 0"},card:{width:e,height:"200px",margin:"0 20px 24px 0",borderStyle:"solid",borderRadius:"2px",boxShadow:"1px 1.5px 4px "+t.palette.neutralLight,borderWidth:"1px",borderColor:t.palette.neutralLight},meta:{color:t.palette.neutralSecondary,fontSize:"12px"},listReview:{marginTop:"8px",width:"60%",minWidth:"400px !important"},review:s(s({display:"-webkit-box",overflow:"hidden",textOverflow:"ellipsis"},{"-webkit-line-clamp":"5"}),{"-webkit-box-orient":"vertical"}),showMore:{display:"block",margin:"0 auto 0 auto"},center:{textAlign:"center"},noMatch:{color:t.palette.neutralSecondary,textAlign:"left",display:"inline-block",marginBotton:"16px"},buffer:{height:"16px"}})}var v=()=>Object(n.mergeStyleSets)({whole:{fontFamily:c,width:"100%"},font:{fontFamily:c}}),f=()=>{var e=Object(r.useTheme)();return Object(n.mergeStyleSets)({spacer:{paddingTop:"25px !important"},row:{width:"100%",display:"flex"},header:{padding:"4px 12px 4px 12px",fontWeight:600},icon:{maxHeight:"26px"},separator:{borderTopStyle:"solid",borderWidth:"1px",borderColor:e.palette.neutralLight},graphSpace:{paddingTop:"25px !important"},graphSpaceLine:{padding:"25px 16px 0 16px 0 !important"}})},h=()=>Object(n.mergeStyleSets)({emptySpinner:{margin:"10% auto 0 auto"}}),b=e=>{var t="18px";return e>0&&(t=Object(i.toPixles)(18+25*e)),Object(n.mergeStyleSets)({space:{paddingTop:"16px",marginBottom:"16px"},title:{marginTop:t,display:"block"},gap:{marginRight:"24px"},download:{marginRight:"4%",marginBottom:"8px",width:"150px"},newOld:{marginRight:"24px",marginTop:"8px"}})},y=e=>{var t=e?"10px !important":"16px !important";return Object(n.mergeStyleSets)({space:{height:"25px",fontSize:t},icon:{paddingTop:"3px",marginRight:"4px"},message:{marginRight:"6px"}})},S=()=>{var e=Object(r.useTheme)();return Object(n.mergeStyleSets)({container:{width:"50%",fontSize:"14px",display:"flex",flexFlow:"column nowrap",alignItems:"stretch"},header:{flex:"1 1 auto",borderTop:"4px solid",borderColor:e.palette.themePrimary,display:"flex",fontWeight:600,padding:"12px 12px 14px 24px"},body:{flex:"4 4 auto",padding:"0 24px 24px 24px",overflowY:"hidden",selectors:{p:{margin:"14px 0"},"p:first-child":{marginTop:0},"p:last-child":{marginBottom:0}}},more:{float:"right",margin:"4px 4px 0 0"}})}},8060:function(e,t,a){"use strict";a.r(t),a.d(t,"sizes",(function(){return o})),a.d(t,"adjustments",(function(){return s})),a.d(t,"formatValues",(function(){return l})),a.d(t,"improveAppUrl",(function(){return c})),a.d(t,"preRequestTemplate",(function(){return m})),a.d(t,"useResizeObserver",(function(){return p})),a.d(t,"useWindowDimensions",(function(){return g})),a.d(t,"toPixles",(function(){return v})),a.d(t,"getColumnSizes",(function(){return f})),a.d(t,"getCardSizes",(function(){return h})),a.d(t,"getImproveFormat",(function(){return b})),a.d(t,"buildMonitorUrl",(function(){return y})),a.d(t,"buildSolutionUrl",(function(){return S})),a.d(t,"dateSortDesc",(function(){return E})),a.d(t,"dateSortAsc",(function(){return w})),a.d(t,"getTranslatedString",(function(){return x})),a.d(t,"processRequestData",(function(){return R}));var n=a(245),r=a(8061),i=a(2898),o={tiny:640,small:690,medium:1e3,large:1480,cardMedium:1040,cardLarge:1440},s={oneCol:.98,twoCol:.48,threeCol:.333,oneCard:.88,twoCards:.47,threeCards:.31,fourCards:.235,threeMinus:.32,menuClosed:48,menuOpen:200},l={tiny:-1,large:0,medium:1,small:2},c="https://docs.microsoft.com/powerapps/maker/model-driven-apps/design-productive-forms";function d(){var{innerWidth:e,innerHeight:t}=window;return{width:e,height:t}}var u={vDis:0,dis:0,sat:0,vSat:0,count:0,month:0,year:0,totalScore:0},m={complete:!1,empty:!0,comments:!1,lowData:!0,oldestDate:{month:-1,year:-1},recentScore:0,allScores:Object.create(u),scores:[],devices:[],browsers:[],reviewData:[]},p=e=>{var[t,a]=Object(n.useState)(e);return[Object(i.useRefEffect)(e=>{var t=new r.default(e=>{a(e[0].target.getBoundingClientRect())});return t.observe(e),()=>t.disconnect()}),t]};function g(){var[e,t]=Object(n.useState)(d());return Object(n.useEffect)(()=>{function e(){t(d())}return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),e}function v(e){return e.toString()+"px"}function f(e){var t=v(e*s.oneCol),a=v(e*s.twoCol),n=v(e*s.threeCol),r=v(e*s.threeMinus);return e<o.medium?{one:t,two:t,three:t,space:!0,size:l.small}:e<o.large?{one:a,two:a,three:t,space:!1,size:l.medium}:{one:n,two:r,three:r,space:!1,size:l.large}}function h(e){var t=v(e*s.oneCard),a=v(e*s.twoCards),n=v(e*s.threeCards),r=v(e*s.fourCards);return e<=o.tiny?t:e<=o.cardMedium?a:e<o.cardLarge?n:r}function b(e){return e<=o.tiny?l.tiny:e<=o.medium?l.small:e<o.large?l.medium:l.large}function y(e,t,a,n){return"/e/".concat(e,"/diag#source=ratings&appType=model&appUrl=").concat(a,"main.aspx?appid=").concat(t,"&displayName=").concat(n,"&appId=").concat(t)}function S(e,t){var a="/environments/"+e+"/solutions",n=window.location.href.split("/"+t)[1].split("?")[1];return n?a+"?"+n:a}function E(e,t){var a=new Date(e.date).getTime();return new Date(t.date).getTime()>a?1:-1}function w(e,t){return new Date(e.date).getTime()>new Date(t.date).getTime()?1:-1}function C(e,t){var a=0,n=0;return t?(a=Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds()),n=Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()-28,e.getHours(),e.getMinutes(),e.getSeconds())):(a=Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds()),n=Date.UTC(e.getFullYear()-1,e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds())),{start:a,end:n}}function O(e,t){var a=Date.UTC(t.getFullYear(),t.getMonth(),t.getDate());return a>=e.end&&a<=e.start}function x(e,t){switch(e){case"Chrome":return t.Chrome;case"Safari":return t.Safari;case"Edge":return t.Edge;case"Firefox":return t.Firefox;case"IE":return t.IE;case"Opera":return t.Opera;case"Android":return t.Android;case"Edge Legacy":return t.EdgeLegacy;case"Samsung Internet":return t.SamsungInternet;case"UC Browser":return t.UCBrowser;case"Web":return t.Web;case"Mobile":return t.Mobile;default:return t.Unknown}}function k(e,t,a){if(a){var n=a;switch(e){case 1:n.vDis++;break;case 2:n.dis++;break;case 3:n.sat++;break;case 4:n.vSat++}return n}return{device:t,vSat:4===e?1:0,sat:3===e?1:0,dis:2===e?1:0,vDis:1===e?1:0}}function D(e,t,a){if(a){var n=a;switch(e){case 1:n.vDis++;break;case 2:n.dis++;break;case 3:n.sat++;break;case 4:n.vSat++}return n}return{browser:t,vSat:4===e?1:0,sat:3===e?1:0,dis:2===e?1:0,vDis:1===e?1:0}}function T(e){var t=e.vDis+e.dis+e.sat+e.vSat;return{totalScore:Math.round(e.vSat/t*100-(e.dis/t*100+e.vDis/t*100)+100),count:t}}function R(e,t){var a={complete:!0,empty:!0,comments:!1,lowData:!0,oldestDate:{month:-1,year:-1},recentScore:0,allScores:Object.create(u),devices:Array(),browsers:Array(),reviewData:Array(),scores:Array()};if(!(e.length>0))return a;a.empty=!1;var n=function(){var e=[],t=new Date,a=t.getFullYear(),n=t.getMonth();e.push({vSat:0,sat:0,dis:0,vDis:0,count:0,month:n,year:a,totalScore:0});for(var r=0;r<12;r++)n-1==-1&&(n=12,a--),e.unshift({vSat:0,sat:0,dis:0,vDis:0,count:0,month:n-1,year:a,totalScore:0}),n--;return e}(),r=Object.create(u),i=new Date,o=C(i,!0),s=C(i,!1),l=Object.create(null),c=Object.create(null),d=x("",t),m=0,p="",g="";for(var v of(e.map(e=>{p=x(e.browser,t),g=x(e.device,t);var i,d={key:++m,satisfaction:e.score,date:(i=e.dateCreated,new Date(i).toLocaleString(navigator.language,{dateStyle:"short"})),device:g,browser:p,review:"",more:!1};if(e.comment&&(d.review=e.comment,d.more=e.comment.length>252),a.reviewData.push(d),e.comment&&!a.comments&&(a.comments=!0),a.lowData&&a.allScores.vDis+a.allScores.dis+a.allScores.sat+a.allScores.vSat>3&&(a.lowData=!1),O(o,new Date(e.dateCreated))&&(l[p]?l[p]=D(e.score,p,l[p]):l[p]=D(e.score,p,null),c[g]?c[g]=k(e.score,g,c[g]):c[g]=k(e.score,g,null)),e.dateCreated&&O(s,new Date(e.dateCreated))){if(O(o,new Date(e.dateCreated))){switch(e.score){case 1:r.vDis++;break;case 2:r.dis++;break;case 3:r.sat++;break;case 4:r.vSat++}r.count++}var u=function(e,t){for(var a=new Date(t),n=a.getFullYear(),r=a.getMonth(),i=0;i<e.length;i++)if(e[i].year===n&&e[i].month===r)return i;return-1}(n,e.dateCreated),v=n[u];switch(e.score){case 1:a.allScores.vDis++,v.vDis++;break;case 2:a.allScores.dis++,v.dis++;break;case 3:a.allScores.sat++,v.sat++;break;case 4:a.allScores.vSat++,v.vSat++}a.allScores.count++,v.count++,n[u]=v}}),Object.keys(l)))v!==d&&a.browsers.push({browser:v,score:T(l[v]).totalScore});for(var f of Object.keys(c))f!==d&&a.devices.push({device:f,score:T(c[f]).totalScore});0!==r.count?a.recentScore=T(r).totalScore:a.recentScore=-1,a.comments&&(a.reviewData=a.reviewData.sort(E));for(var h=0;h<=12;h++){if(0!==n[0].count){a.oldestDate={month:n[0].month,year:n[0].year};break}n.shift()}return n.length>0&&n.map(e=>{var t=T(e);a.scores.push(t.totalScore)}),a}},8062:function(e,t,a){"use strict";a.r(t),a.d(t,"getDialValue",(function(){return s})),a.d(t,"getGaugeOptions",(function(){return l})),a.d(t,"getQuantifier",(function(){return c}));var n=a(8059),r=100,i=140,o=160;function s(e){var t=0;return e<r?e/2:e>=r&&e<i?(t=(e/=2)-50,50+(t*=2.5)):e>=i&&e<o?(t=(e/=1.4)-100,100+(t*=3.5)):(t=e-160,150+(t*=1.25))}function l(e,t){var a=!0,r=e,i="",o="100%";-1===e&&(a=!1,r=0,o="0");var l=s(r),d=c(r,t),u="".concat(t.score," ").concat(r.toString()," ").concat(d);return i=a?'<div style="text-align:center"><span style="font-size:30px">'+r+'</span><br/><span style="10px;font-size:15x">'+d+"</span></div>":'<div style="text-align:center"><span style="font-size:10px">'+t.none+"</span></div>",{chart:{type:"solidgauge",height:155,style:{fontFamily:n.universalFont}},accessibility:{series:{typeDescription:"Gauge"},keyboardNavigation:{order:["series"]},landmarkVerbosity:"one"},title:null,pane:{center:["50%","85%"],size:"160%",startAngle:-90,endAngle:90,background:[{from:0,to:50,backgroundColor:"#efb5b9",innerRadius:"70%",outerRadius:"100%",shape:"ark"},{from:50,to:100,backgroundColor:"#f0e199",innerRadius:"70%",outerRadius:"100%",shape:"ark"},{from:100,to:150,backgroundColor:"#a0d1ff",innerRadius:"70%",outerRadius:"100%",shape:"ark"},{from:150,to:200,backgroundColor:"#76cd8c",innerRadius:"70%",outerRadius:"100%",shape:"ark"}]},tooltip:{enabled:!1},yAxis:{min:0,max:200,lineWidth:0,minorTickInterval:null,tickAmount:2,labels:{enabled:!1}},plotOptions:{gauge:{pivot:{radius:0}},series:{dataLabels:{borderWidth:0,y:.1,align:"center"}}},credits:{enabled:!1},legend:{enabled:!0,symbolHeight:12,symbolWidth:12,symbolRadius:6},series:[{name:"Speed",type:"gauge",data:[{y:l,name:"score",accessibility:{description:u}}],dial:{radius:o,baseWidth:3,rearLength:"-70%",baseLength:"100%"},dataLabels:{useHTML:!0,format:i}}]}}function c(e,t){return e<100?t.poor:e>=100&&e<140?t.fair:e>=140&&e<160?t.good:t.world}},8063:function(e,t,a){"use strict";a.r(t),a.d(t,"getSatisfactionBarOptions",(function(){return r})),a.d(t,"getGaugeLegend",(function(){return i}));var n=a(8059);function r(e,t,a){var r="12px";return a&&(r="8px"),{chart:{type:"bar",height:80},title:{text:null},xAxis:{labels:{enabled:!1},gridLineWidth:0},accessibility:{keyboardNavigation:{order:["series","legend"]},landmarkVerbosity:"one"},yAxis:{min:0,labels:{enabled:!1},title:{text:null},gridLineWidth:0},pane:{center:["50%","50%"],size:"20%"},legend:{reversed:!0,itemStyle:{fontWeight:"normal",fontFamily:n.universalFont,fontSize:r}},plotOptions:{series:{stacking:"percent",pointWidth:15,events:{legendItemClick:()=>!1}}},credits:{enabled:!1},tooltip:{useHTML:!0,headerFormat:"<table>",pointFormat:'<tr><td style="color: {series.color}">{series.name}: </td><td>{point.y}</td></tr>',footerFormat:"</table>"},series:[{name:t.vSat,color:"#784ebf",data:e.vSat},{name:t.sat,color:"#df45a7",data:e.sat},{name:t.dis,color:"#680275",data:e.dis},{name:t.vDis,color:"#e66d37",data:e.vDis}]}}function i(e,t){var a="12px";return t&&(a="8px"),{chart:{type:"bar",height:40},accessibility:{keyboardNavigation:{order:["legend"]},landmarkVerbosity:"one"},title:{text:null},xAxis:{visible:!1},yAxis:{visible:!1},credits:{enabled:!1},plotOptions:{series:{events:{legendItemClick:()=>!1}}},legend:{padding:0,margin:0,verticalAlign:"middle",maxHeight:200,itemStyle:{fontWeight:"normal",fontFamily:n.universalFont,fontSize:a,cursor:"auto"},itemHoverStyle:{color:"#333333"}},series:[{name:"0-100 ".concat(e.poor),color:"#efb5b9",data:[]},{name:"100-140 ".concat(e.fair),color:"#f0e199",data:[]},{name:"140-160 ".concat(e.good),color:"#a0d1ff",data:[]},{name:"160-200 ".concat(e.world),color:"#76cd8c",data:[]}]}}},8064:function(e,t,a){"use strict";a.r(t),a.d(t,"getColumnDeviceOptions",(function(){return r})),a.d(t,"getColumnBrowserOptions",(function(){return i}));var n=a(8059);function r(e){var t=[];return e.map(e=>{t.push([e.device,e.score])}),{chart:{type:"column",height:180,style:{fontFamily:n.universalFont}},title:{text:null},xAxis:{type:"category"},yAxis:{min:0,title:{text:null}},accessibility:{keyboardNavigation:{order:["series","legend"]},landmarkVerbosity:"one"},legend:{enabled:!1},pane:{center:["50%","50%"],size:"20%"},plotOptions:{column:{pointPadding:.2,borderWidth:0}},credits:{enabled:!1},tooltip:{useHTML:!0,headerFormat:"<table>",pointFormat:'<tr><td style="color: {series.color}">{point.name}: </td><td>{point.y}</td></tr>',footerFormat:"</table>"},series:[{name:"Device",colorByPoint:!0,colors:["#a1a3d8"],data:t}]}}function i(e){var t=[];return e.map(e=>{t.push([e.browser,e.score])}),{chart:{type:"column",height:180,style:{fontFamily:n.universalFont}},title:{text:null},xAxis:{type:"category"},yAxis:{min:0,title:{text:null}},accessibility:{keyboardNavigation:{order:["series"]},landmarkVerbosity:"one"},legend:{enabled:!1},pane:{center:["50%","50%"],size:"20%"},plotOptions:{column:{pointPadding:.2,borderWidth:0}},credits:{enabled:!1},tooltip:{useHTML:!0,headerFormat:"<table>",pointFormat:'<tr><td style="color: {series.color}">{point.name}: </td><td>{point.y}</td></tr>',footerFormat:"</table>"},series:[{name:"Browsers",colorByPoint:!0,colors:["#a1a3d8"],data:t}]}}},8065:function(e,t,a){"use strict";a.r(t),a.d(t,"getScoreLineChartOptions",(function(){return r}));var n=a(8059);function r(e,t,a){var r=0;e.forEach(e=>{e&&r++});var i=1===r;return{chart:{height:100,style:{fontFamily:n.universalFont}},title:{text:null,enabled:!1},accessibility:{keyboardNavigation:{order:["series"]},landmarkVerbosity:"one"},plotOptions:{series:{connectNulls:!0,pointStart:Date.UTC(t,a,1),pointIntervalUnit:"month",pointInterval:1}},yAxis:{title:{enabled:!1}},xAxis:{type:"datetime",labels:{formatter(){var e=new Date(this.value);return 1!==e.getDate()&&(e=2===e.getDate()?new Date(e.getFullYear(),e.getMonth(),1):new Date(e.getFullYear(),e.getMonth()+1,1)),e.toLocaleString(navigator.language,{month:"short",year:"2-digit"})}}},series:[{name:null,data:e,marker:{enabled:i}}],credits:{enabled:!1},legend:{enabled:!1},tooltip:{useHTML:!0,headerFormat:"<table>",pointFormat:"<tr><td>{point.y}</td></tr>",footerFormat:"</table>"},responsive:{rules:[{condition:{maxWidth:500,maxHeight:150},chartOptions:{legend:{layout:"horizontal",align:"center",verticalAlign:"bottom"}}}]}}}},8066:function(e,t,a){"use strict";a.r(t),a.d(t,"getRatingFetchMetadataXML",(function(){return r}));var n=a(8067),r=e=>"<fetch mapping='logical'>"+"<entity name='".concat(n.RATING_ETN,"'>")+"<attribute name='statecode'/>"+"<attribute name='".concat(n.ATTRIBUTE_SCORE,"'/>")+"<attribute name='".concat(n.ATTRIBUTE_BROWSER,"'/>")+"<attribute name='".concat(n.ATTRIBUTE_COMMENT,"'/>")+"<attribute name='".concat(n.ATTRIBUTE_DEVICE,"'/>")+"<attribute name='".concat(n.ATTRIBUTE_RATING_ID,"'/>")+"<attribute name='".concat(n.ATTRIBUTE_DATE_CREATED,"'/>")+"<attribute name='".concat(n.ATTRIBUTE_APP_MODULE_ID,"'/>")+"<filter type='and'>"+"<condition attribute='".concat(n.ATTRIBUTE_APP_MODULE_ID,"' operator='eq' value='").concat(e,"'/>")+"</filter></entity></fetch>"},8067:function(e,t,a){"use strict";a.r(t),a.d(t,"RATING_ETN",(function(){return n})),a.d(t,"ATTRIBUTE_SCORE",(function(){return r})),a.d(t,"ATTRIBUTE_APP_MODULE_ID",(function(){return i})),a.d(t,"ATTRIBUTE_BROWSER",(function(){return o})),a.d(t,"ATTRIBUTE_COMMENT",(function(){return s})),a.d(t,"ATTRIBUTE_DEVICE",(function(){return l})),a.d(t,"ATTRIBUTE_RATING_ID",(function(){return c})),a.d(t,"ATTRIBUTE_DATE_CREATED",(function(){return d}));var n="userrating",r="score",i="appmoduleid",o="browser",s="comment",l="device",c="userratingid",d="createdon"},9350:function(e,t,a){"use strict";a.r(t),a.d(t,"RatingScope",(function(){return r})),a.d(t,"TelemetryEventNames",(function(){return n}));var n,r="rating";!function(e){e.RatingsButtonClicked="RatingsButtonClicked"}(n||(n={}))}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/267.00ed5a0c.chunk.js.map