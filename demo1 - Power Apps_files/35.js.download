(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/35.js?v=1.4.3886-master"]={begin:performance.now()},(window.__wpJsonpUci=window.__wpJsonpUci||[]).push([[35],{"+95i":function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n;Object.defineProperty(t,"__esModule",{value:!0}),t.ClientHost=void 0,function(e){e[e.Browser=1]="Browser",e[e.MobileApplication=2]="MobileApplication",e[e.MailApp=3]="MailApp",e[e.Unknown=4]="Unknown"}(n||(n={})),t.ClientHost=n},"+Axb":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseXmlDocument=t.create=void 0;var n=r("2Dq5"),a=r("SWMH"),i=r("T+vN"),o=r("6EES"),s=r("nf9M"),u=r("9byC"),l=o.XmlEvaluatorType.undefined;function c(){return l}function d(e){return l=e,e}t.create=function(e){return s.IsNullOrUndefined(e)?null:(c()===o.XmlEvaluatorType.undefined&&function(e){if(function(e){var t=document.evaluate,r=document.createNSResolver&&document.createNSResolver(e),n=!1;return!s.IsNullOrUndefined(t)&&r&&!n}(e)){var t=new i.XPathEvaluatorWrapper(e);try{t.selectSingleNode("/root"),d(0)}catch(e){}}c()===o.XmlEvaluatorType.undefined&&(r=window.DOMParser,s.IsNullOrUndefined(r)||d(o.XmlEvaluatorType.domParser));var r;c()===o.XmlEvaluatorType.undefined&&n.throwOnNullOrUndefinedArgument(c(),"PreferredXmlEvaluator")}(e),c()?new a.DOMParserNodeWrapper(e):new i.XPathEvaluatorWrapper(e))},t.parseXmlDocument=function(e){var t=u.ParseXml(e);if(null!=t){var r=t.getElementsByTagName("parsererror");!s.IsNullOrUndefined(r)&&r.length>0&&(t=null)}return t}},"+MPC":function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.getPositiveErrorCodeFromErrorCode=t.getNegativeErrorCodeFromErrorCode=t.isErrorStatus=t.convertErrorAndRethrow=t.convertToErrorStatus=t.ErrorStatus=void 0;var a=r("tcxr"),i=r("ZFvc"),o=r("nf9M"),s=function(){function e(t,r,n,i,o,s,u,l,c,d,p,f,y,m,h,g,E,b,O){void 0===f&&(f=!1),void 0===y&&(y=-1),void 0===m&&(m=null);var v=r||e.DEFAULT_ERROR_CODE,_=d,T=a.createUciError(t,v,l,c,_,p,f);return T.message||(T.message=v.toString()),T.errorParameters||(T.errorParameters=[]),u&&T.errorParameters.push({name:"ErrorDetails",value:u}),s&&T.errorParameters.push({name:"ErrorFault",value:s}),o&&T.errorParameters.push({name:"ErrorSource",value:o}),n&&T.errorParameters.push({name:"Exception",value:n.message}),p&&T.errorParameters.push({name:"ErrorStack",value:p}),T._errorSource=o,T._exception=n,T._innerError=i,T._errorFault=s,T._details=u,T.blockErrorReporting=f,T.faultedRequestIndex=y,T.faultedSnapshotId=m,T.httpStatusCode=h,T.clientRequestId=g,T.serverResponseId=E,T.retryAfter=b,e._addErrorStatusProps(T),T}return e.fromErrorCode=function(t,r){for(var n=[],a=2;a<arguments.length;a++)n[a-2]=arguments[a];var i=e._getErrorMessage(t,r,n),o=new e(i,r);return o},e.fromExistingError=function(t){var r=t;return r.name||(r.name=a.UCI_ERROR_NAME),void 0===r.errorCode&&(r.errorCode=e.DEFAULT_ERROR_CODE),void 0===r.blockErrorReporting&&(r.blockErrorReporting=!1),void 0===r.faultedRequestIndex&&(r.faultedRequestIndex=-1),e._addErrorStatusProps(r),r},e._addErrorStatusProps=function(t){var r,a,i=Object.getOwnPropertyNames(e.prototype);try{for(var o=n(i),s=o.next();!s.done;s=o.next()){var u=s.value,l=Object.getOwnPropertyDescriptor(e.prototype,u);Object.defineProperty(t,u,l)}}catch(e){r={error:e}}finally{try{s&&!s.done&&(a=o.return)&&a.call(o)}finally{if(r)throw r.error}}},e.createEmpty=function(){return new e("ErrorStatus created with no information",this.DEFAULT_ERROR_CODE)},e._getErrorMessageResourceId=function(e){var t=e;return t<0&&(t=t+4294967295+1),"Error_Message_0x"+t.toString(16)},e._getErrorMessage=function(t,r){for(var n=[],a=2;a<arguments.length;a++)n[a-2]=arguments[a];return e._getErrorMessageResourceId(r)},e.toLegacyErrorStatus=function(t){if(!t)return null;var r=i.LegacyErrorStatus.FromMessage(t.message,null);return r.set_ErrorCode(t.errorCode),r.set_ErrorFault(t.errorFault),r.set_Exception(t.exception),r.set_Stack(t.stack),r.set_InnerError(e.toLegacyErrorStatus(t.innerError)),r.set_BlockErrorReporting(t.blockErrorReporting),r.set_isRequestTooLong(t._isRequestTooLong),r},e.fromLegacyErrorStatus=function(t,r){if(!t)return null;var n=t.get_Stack();if(!n){var a=t.get_ErrorFault();a&&a.get_innerFault()&&(n=a.get_innerFault().get_callStack())}var i=t.get_ErrorCode(),s=t.get_Message();o.IsNullOrUndefinedOrEmptyString(s)&&null!=r&&(s=e._getErrorMessage(r,i));var u=-1;void 0!==t.get_FaultedRequestIndex&&(u=t.get_FaultedRequestIndex());var l=new e(s,i,t.get_Exception(),e.fromLegacyErrorStatus(t.get_InnerError()),t.get_ErrorSource(),t.get_ErrorFault(),n,null,null,null,n,t.get_BlockErrorReporting(),u,null,t.get_HttpStatusCode(),t.get_ClientRequestId(),t.get_ServerResponseId(),t.get_RetryAfter(),t.get_ErrorFault()?t.get_ErrorFault().get_annotations():null);return l._isRequestTooLong=t.get_isRequestTooLong(),l},Object.defineProperty(e.prototype,"errorFault",{get:function(){return this._errorFault},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"details",{get:function(){return this._details},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"exception",{get:function(){return this._exception},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"innerError",{get:function(){return this._innerError},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"errorSource",{get:function(){return this._errorSource},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"localizedMessage",{get:function(){if(this.message){var e=/, Error details: (.*)$/gi.exec(this.message);if(e&&e.length>1){var t=e[1];return"'"===t[0]&&"'"===t[t.length-1]?t.substring(1,t.length-1):t}}return null},enumerable:!1,configurable:!0}),e.prototype.containsErrorCode=function(e){return this.getNegativeErrorCode()===e||!!this._innerError&&this._innerError.containsErrorCode(e)},e.prototype.getNegativeErrorCode=function(){return u(this.errorCode)},e.DEFAULT_ERROR_MESSAGE_ID="Error_Message_Generic_Mobile_Client",e.DEFAULT_ERROR_CODE=0,e}();function u(e){var t=e;return e>0&&(t=~~e),t}function l(e){return e?e instanceof Error?s.fromExistingError(e):e:s.createEmpty()}t.ErrorStatus=s,t.getNegativeErrorCodeFromErrorCode=u,t.getPositiveErrorCodeFromErrorCode=function(e){var t=e;return e<0&&(t=1+~e),t},t.convertErrorAndRethrow=function(e){throw l(e)},t.convertToErrorStatus=l,t.isErrorStatus=function(e){return e instanceof Error&&e.name===a.UCI_ERROR_NAME}},"+hYO":function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n;Object.defineProperty(t,"__esModule",{value:!0}),t.isOfflineError=t.CrmErrorCodes=void 0,function(e){e[e.InvalidEntity=-2147098612]="InvalidEntity",e[e.NoUserPrivilege=-2146088112]="NoUserPrivilege",e[e.NoMinimumRequiredPrivilegesForTabletApp=-2147094001]="NoMinimumRequiredPrivilegesForTabletApp",e[e.dataSourceInitializeFailedErrorCode=-2147094e3]="dataSourceInitializeFailedErrorCode",e[e.DataSourceOfflineErrorCode=-2147093999]="DataSourceOfflineErrorCode",e[e.retrieveRecordOfflineErrorCode=-2147093997]="retrieveRecordOfflineErrorCode",e[e.cannotSaveRecordInOfflineErrorCode=-2147093996]="cannotSaveRecordInOfflineErrorCode",e[e.GeneralAuthorizationErrorCode=-2147093995]="GeneralAuthorizationErrorCode",e[e.SignOutFailed=-2147093993]="SignOutFailed",e[e.viewNotAvailableForMobileOffline=-2147093989]="viewNotAvailableForMobileOffline",e[e.DataStoreKeyNotFoundErrorCode=-2147093987]="DataStoreKeyNotFoundErrorCode",e[e.cantUpdateOnlineRecord=-2147093980]="cantUpdateOnlineRecord",e[e.cannotDeleteOnlineRecord=-2147093944]="cannotDeleteOnlineRecord",e[e.LocalDataSourceError=-2147015599]="LocalDataSourceError",e[e.unknownBadRequestError=-2147015424]="unknownBadRequestError",e[e.UnknownUnauthorizedError=-2147015423]="UnknownUnauthorizedError",e[e.unknownForbiddenError=-2147015422]="unknownForbiddenError",e[e.unknownNotFoundError=-2147015421]="unknownNotFoundError",e[e.UnknownTooManyRequestsError=-2147015420]="UnknownTooManyRequestsError",e[e.unknownInternalServerError=-2147015419]="unknownInternalServerError",e[e.unknownNotImplementedServerError=-2147015418]="unknownNotImplementedServerError",e[e.unknownBadGatewayError=-2147015417]="unknownBadGatewayError",e[e.unknownServiceUnavailableError=-2147015416]="unknownServiceUnavailableError",e[e.unknownGatewayTimeoutError=-2147015415]="unknownGatewayTimeoutError",e[e.UnknownUnexpectedGenericError=-2147015414]="UnknownUnexpectedGenericError",e[e.concurrencyVersionMismatch=-2147088254]="concurrencyVersionMismatch",e[e.concurrencyVersionNotProvided=-2147088253]="concurrencyVersionNotProvided",e[e.duplicateRecordDetected=-2147220685]="duplicateRecordDetected",e[e.ObjectDoesNotExist=-2147220969]="ObjectDoesNotExist",e[e.PrivilegeDenied=-2147220960]="PrivilegeDenied",e[e.UserDisabled=-2147220955]="UserDisabled",e[e.duplicateRecord=-2147220937]="duplicateRecord",e[e.isvAborted=-2147220891]="isvAborted",e[e.isvUnexpected=-2147220956]="isvUnexpected",e[e.BusinessUnitDisabled=-2147220692]="BusinessUnitDisabled",e[e.OrganizationDisabled=-2147180284]="OrganizationDisabled",e[e.MetadataNoMapping=-2147217919]="MetadataNoMapping",e[e.UserWithoutRoles=-2147209463]="UserWithoutRoles",e[e.UserWithoutPrivileges=-2147209460]="UserWithoutPrivileges",e[e.UserNotAssignedLicense=-2147167669]="UserNotAssignedLicense",e[e.UserDoesNotHaveAdminOnlyModePermissions=-2147180269]="UserDoesNotHaveAdminOnlyModePermissions",e[e.UserNotMemberOfOrg=-2147015328]="UserNotMemberOfOrg",e[e.crmSqlGovernorDatabaseRequestDenied=-2147180543]="crmSqlGovernorDatabaseRequestDenied",e[e.AggregateQueryRecordLimitExceeded=-2147164125]="AggregateQueryRecordLimitExceeded",e[e.InvalidFilterCriteriaForVisualization=-2147164130]="InvalidFilterCriteriaForVisualization",e[e.InsufficientColumnsInSubQuery=-2147164126]="InsufficientColumnsInSubQuery",e[e.InvalidAppModuleSiteMap=-2147155696]="InvalidAppModuleSiteMap",e[e.QueryBuilderNoAttribute=-2147217149]="QueryBuilderNoAttribute",e[e.SqlArithmeticOverflowError=-2147217098]="SqlArithmeticOverflowError",e[e.unManagedIdsAccessDenied=-2147187962]="unManagedIdsAccessDenied",e[e.invalidFetchXml=-2147220733]="invalidFetchXml",e[e.requiredFieldMissing=-2147220992]="requiredFieldMissing"}(n=t.CrmErrorCodes||(t.CrmErrorCodes={})),t.isOfflineError=function(e){return e===n.retrieveRecordOfflineErrorCode||e===n.DataSourceOfflineErrorCode}},"+wex":function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.PlaybackManager=t.getRequestType=t.buildBatchResponse=t.extractIndividualResponsesFromBatchResponse=t.getViewIdValue=t.getAvailableOfflineValue=t.getBooleanValue=t.PolicyManager=t.ODataExecutor=t.getMaxPageSizeFromPrefer=t.convertSearchStringToSQL=t.trimWildCards=t.getClientType=t.ConsoleTraceManager=t.ConsoleEventManager=void 0;var n=r("xB8/");Object.defineProperty(t,"ConsoleEventManager",{enumerable:!0,get:function(){return n.ConsoleEventManager}});var a=r("dCSa");Object.defineProperty(t,"ConsoleTraceManager",{enumerable:!0,get:function(){return a.ConsoleTraceManager}});var i=r("7l03");Object.defineProperty(t,"getClientType",{enumerable:!0,get:function(){return i.getClientType}}),Object.defineProperty(t,"trimWildCards",{enumerable:!0,get:function(){return i.trimWildCards}}),Object.defineProperty(t,"convertSearchStringToSQL",{enumerable:!0,get:function(){return i.convertSearchStringToSQL}}),Object.defineProperty(t,"getMaxPageSizeFromPrefer",{enumerable:!0,get:function(){return i.getMaxPageSizeFromPrefer}});var o=r("Msg1");Object.defineProperty(t,"ODataExecutor",{enumerable:!0,get:function(){return o.ODataExecutor}});var s=r("ogvk");Object.defineProperty(t,"PolicyManager",{enumerable:!0,get:function(){return s.PolicyManager}});var u=r("YEmJ");Object.defineProperty(t,"getBooleanValue",{enumerable:!0,get:function(){return u.getBooleanValue}}),Object.defineProperty(t,"getAvailableOfflineValue",{enumerable:!0,get:function(){return u.getAvailableOfflineValue}}),Object.defineProperty(t,"getViewIdValue",{enumerable:!0,get:function(){return u.getViewIdValue}});var l=r("8GlG");Object.defineProperty(t,"extractIndividualResponsesFromBatchResponse",{enumerable:!0,get:function(){return l.extractIndividualResponsesFromBatchResponse}});var c=r("xHQC");Object.defineProperty(t,"buildBatchResponse",{enumerable:!0,get:function(){return c.buildBatchResponse}});var d=r("tUL6");Object.defineProperty(t,"getRequestType",{enumerable:!0,get:function(){return d.getRequestType}});var p=r("bZIc");Object.defineProperty(t,"PlaybackManager",{enumerable:!0,get:function(){return p.PlaybackManager}})},"/jqC":function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.getOfflineProfileAvailableEntities=void 0,t.getOfflineProfileAvailableEntities=function(e){return e&&e.offline&&e.offline.server&&e.offline.server.profileAvailableEntities?e.offline.server.profileAvailableEntities:null}},"0Xad":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CachePriority=void 0,function(e){e[e.Workspace=0]="Workspace",e[e.Medium=1]="Medium",e[e.NotCached=2]="NotCached"}(t.CachePriority||(t.CachePriority={}))},"0ksK":function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.getRequestSource=t.OPERATION_TYPE=t.OPERATION_SOURCE=t.UNKNOWN_TYPE=t.OPERATION=void 0;var n=r("fKp2");t.OPERATION={TYPE:n.EVENT_PARAMETERS.OPERATION_TYPE,SUB_TYPE:n.EVENT_PARAMETERS.OPERATION_SUB_TYPE,SOURCE:n.EVENT_PARAMETERS.OPERATION_SOURCE},t.UNKNOWN_TYPE="Unknown",t.OPERATION_SOURCE={Default:"Default"},t.OPERATION_TYPE={UPDATE:"Update",CREATE:"Create",DELETE:"Delete",RETRIEVE:"Retrieve",RETRIEVE_MULTIPLE:"RetrieveMultiple",Execution_Multiple:"ExecutionMultiple",ACTION:"Action",FUNCTION:"Function",GCM:"GetClientMetadata",SCM:"SyncClientMetadata",ENTITY_DEFINITION:"EntityDefinition",EXTERNAL_SEARCH:"ExternalSearch"},t.getRequestSource=function(e){var r=t.OPERATION_SOURCE.Default;return e.OperationSource&&(r=e.OperationSource),r}},"1NvT":function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return u}));var n=r("7l03"),a=r("fKp2");
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
const i=/--batch_.*/;function o(e,t,r){const a=e.body,o=[];if(Object(n.isNullOrUndefinedOrEmptyString)(a))return o;const l=a.split(i);for(const e of l){const a=/^\s*Content-Type: .*boundary=(.*)\r?\n/gi.exec(e);if(a){if(a.length<=1||!a[1].trim())throw new Error("Error when parsing batch requests. Expected Changeset boundary is missing.");const i=a[1].trim(),l=e.indexOf("--"+i),c=u(i,e.slice(l));for(const e of c){if(0===e.trim().length)continue;const a=s(e,t,r);Object(n.isNullOrUndefined)(a)||o.push(a)}}else{if(0===e.trim().length)continue;const a=s(e,t,r);Object(n.isNullOrUndefined)(a)||o.push(a)}}return o}function s(e,t,r){let n="",i="",o="";const s={},u=e.split(/[\r\n]\s*[\r\n]/g),l=u.length>0?u[0].trim():"",c=u.length>1?u[1].trim():"";o=u.length>2?u[2].trim():"";const d=[...c.split("\n"),...l.split("\n")];for(let e of d)if(0!==e.trim().length&&/\S/.test(e.trim()))if(e=e.trim(),e.startsWith("GET")||e.startsWith("PUT")||e.startsWith("PATCH")||e.startsWith("POST")||e.startsWith("DELETE")){const t=e.split(/\s+/);n=t[0],i=t[1]}else{const t=e.split(":");if(!t||t.length<2)continue;s[t[0].trim()]=t[1].trim()}return i&&n?{url:i,method:n,additionalHeaders:s,body:o}:(r.push({name:"url",value:i}),r.push({name:"method",value:n}),r.push({name:"urlPart",value:c}),t.error((p?`[${p}]`:`[${a.FILE_PREFIX.BatchRequestParser}]`)+" could not parse an individual request. Skipping",r),null);var p}function u(e,t){if(!t)return[];let r="--"+e+"\r\n";0===t.indexOf(r)||(r="--"+e+"\n");const n=t.split(r);if(n.splice(0,1),n.length>0){const t=n[n.length-1],r=t.indexOf("--"+e);n[n.length-1]=t.substring(0,r)}return n}},"1SUZ":function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.isFeatureEnabledByFCBName=void 0,t.isFeatureEnabledByFCBName=function(e,t){var r=e?e.fcbs:void 0;if(r){var n=r.clientFCBs;if(n)return t in n&&(n[t]||function(e,t){var r=e.fcbs;if(r){var n=r.nativeFCBContext;if(n&&t in n)return n[t]}return!1}(e,t))}return!1}},"1eye":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UpSyncResponse=void 0;
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n=function(){function e(){this._errorCode=0}return Object.defineProperty(e.prototype,"message",{get:function(){return this._message},set:function(e){this._message=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"errorDetail",{get:function(){return this._errorDetail},set:function(e){this._errorDetail=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"errorCode",{get:function(){return this._errorCode},set:function(e){this._errorCode=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"errorTime",{get:function(){return this._errorTime},set:function(e){this._errorTime=e},enumerable:!1,configurable:!0}),e}();t.UpSyncResponse=n},"27cS":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OfflineMainLog=void 0;
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n=function(){function e(e,t,r){this._SID=0,this._OperationType=0,this._SID=e,this._LogTableID=t,this._OperationType=r}return Object.defineProperty(e.prototype,"SID",{get:function(){return this._SID},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"logTableID",{get:function(){return this._LogTableID},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"operationType",{get:function(){return this._OperationType},enumerable:!1,configurable:!0}),e}();t.OfflineMainLog=n},"2Dq5":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.throwOnAssert=t.throwOnOutOfRange=t.throwOnNotEquals=t.throwOnNullOrEmptyArgument=t.throwOnUndefinedArgument=t.throwOnNullOrUndefinedArgument=t.throwOnNullArgument=void 0;var n=r("nf9M");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */t.throwOnNullArgument=function(e,t){if(null===e)throw Error(t+"Argument can't be null")},t.throwOnNullOrUndefinedArgument=function(e,t){if(n.IsNullOrUndefined(e))throw Error(t+"Argument can't be null or undefined")},t.throwOnUndefinedArgument=function(e,t){if(void 0===e)throw Error(t+"Argument can't be undefined")},t.throwOnNullOrEmptyArgument=function(e,t){if(!e||!e.length)throw Error(t+"Argument can't be null or empty")},t.throwOnNotEquals=function(e,t,r){if(e!==t)throw Error(r+"Argument is "+e+"but should be equal to "+t)},t.throwOnOutOfRange=function(e,t,r,n){if(e<t||e>r)throw Error(n)},t.throwOnAssert=function(e,t){if(!e)throw Error("ExceptionHelpers.ThrowOnAssert("+t+")")}},"4Qkk":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TransactionCommandData=void 0;var n=r("JWCx"),a=function(){function e(e,t){this._commandType=n.CommandType.transaction}return Object.defineProperty(e.prototype,"commandType",{get:function(){return this._commandType},enumerable:!1,configurable:!0}),e}();t.TransactionCommandData=a},"4oeN":function(e,t,r){"use strict";r.r(t),r.d(t,"LegacyGuid",(function(){return i}));var n=r("7l03"),a=r("yNq8");class i{constructor(e,t){if(this._formattedGuid="",t)this._rawGuid=e;else if(this._rawGuid=i._GetParsedString(e),Object(n.isNullOrUndefinedOrEmptyString)(this._rawGuid))throw new Error("Not a valid guid")}static get_empty(){return i._empty||(i._empty=new i("00000000000000000000000000000000",!0))}static createFromObjectData(e){return new i(e.rawguid)}static tryCreate(e){const t=i._GetParsedString(e);return Object(n.isNullOrUndefinedOrEmptyString)(t)?i.get_empty():new i(t)}static createFromFormattedGuidStringAndSkipParsing(e){return typeof e!==a.AttributeType.String||Object(n.isNullOrUndefinedOrEmptyString)(e)?i.get_empty():new i(e.replace(i._get_GuidStripperPattern(),""),!0)}static isNullOrEmpty(e){return!(!Object(n.isNullOrUndefined)(e)&&e.length)||!!new i(e).equals(i._empty)}static newGuid(){for(let e=0;e<36;e++)if(14!==e){if(8!==e&&13!==e&&18!==e&&23!==e){if(19===e){const e=Math.floor(16*Math.random());"0123456789abcdef".substr(3&e|8,1)}"".concat("0123456789abcdef".substr(Math.floor(16*Math.random()),1))}}else"".concat("4");return new i("".toString(),!0)}static _get_BraceAndHyphenGuidVerifierPattern(){return i._braceAndHyphenGuidVerifierPattern||(i._braceAndHyphenGuidVerifierPattern=new RegExp("^{(\\d|[a-f]){8}-(\\d|[a-f]){4}-(\\d|[a-f]){4}-(\\d|[a-f]){4}-(\\d|[a-f]){12}}$"))}static _get_GuidStripperPattern(){return i._guidStripperPattern||(i._guidStripperPattern=new RegExp("{|}|-","g"))}static _get_HyphenGuidVerifierPattern(){return i._hyphenGuidVerifierPattern||(i._hyphenGuidVerifierPattern=new RegExp("^(\\d|[a-f]){8}-(\\d|[a-f]){4}-(\\d|[a-f]){4}-(\\d|[a-f]){4}-(\\d|[a-f]){12}$"))}static _get_ContiguousGuidVerifierPattern(){return i._contiguousGuidVerifierPattern||(i._contiguousGuidVerifierPattern=new RegExp("^(\\d|[a-f]){32}$"))}static _GetParsedString(e){return Object(n.isNullOrUndefinedOrEmptyString)(e)?"":(e=e.toLowerCase(),i._get_HyphenGuidVerifierPattern().test(e)||i._get_BraceAndHyphenGuidVerifierPattern().test(e)?e.replace(i._get_GuidStripperPattern(),""):i._get_ContiguousGuidVerifierPattern().test(e)?e:"")}getObjectData(){return{rawguid:this._rawGuid}}equals(e){if(e instanceof i)return e._rawGuid===this._rawGuid;if("string"==typeof e)try{return new i(e)._rawGuid===this._rawGuid}catch(e){return!1}return!1}toString(){return this._formattedGuid||(this._formattedGuid=this._rawGuid.substring(0,8)+"-"+this._rawGuid.substring(8,12)+"-"+this._rawGuid.substring(12,16)+"-"+this._rawGuid.substring(16,20)+"-"+this._rawGuid.substring(20,32)),this._formattedGuid}}i.__typeName="Microsoft.Crm.Client.Core.Framework.Guid"},"53uT":function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.deserializeErrorResponse=void 0;var n=r("hER9"),a=r("fKp2"),i=r("nf9M"),o=r("+MPC"),s=r("ykA9"),u=r("Wc7r"),l=r("Rv4a"),c=r("aTRZ"),d=r("+hYO");function p(e,t,r){var n,a,s,u,l,c,d,y=null===(n=e.code)||void 0===n?void 0:n.toString();if(i.IsNullOrUndefinedOrEmptyString(y)&&(y=null===(a=e.ErrorCode)||void 0===a?void 0:a.toString(),i.IsNullOrUndefinedOrEmptyString(y)?r.error("Unexpected server error response - no error code"):r.error("Unexpected server error response - error code provided as ErrorCode")),!i.IsNullOrUndefinedOrEmptyString(y)){var m=y.toLowerCase().startsWith("0x")?16:10;d=parseInt(y.toString(),m)}var h=null===(s=e.message)||void 0===s?void 0:s.toString();i.IsNullOrUndefinedOrEmptyString(h)&&(h=null===(u=e.Message)||void 0===u?void 0:u.toString(),i.IsNullOrUndefinedOrEmptyString(h)?r.error("Unexpected server error response - no message"):r.error("Unexpected server error response - message provided as Message"));var g=null===(l=e.stacktrace)||void 0===l?void 0:l.toString();i.IsNullOrUndefinedOrEmptyString(g)&&(g=null===(c=e.StackTrace)||void 0===c?void 0:c.toString(),i.IsNullOrUndefinedOrEmptyString(g)||r.error("Unexpected server error response - message provided as Message"));var E=e.innererror,b=null;i.IsNullOrUndefined(E)||(b=p(E,t,r));var O=f(d,t.status);return new o.ErrorStatus(h,O,null,b,null,null,null,null,null,null,g)}function f(e,t){if(0!==e)return e;switch(t){case 400:return c.ErrorCodes.unknownBadRequestError;case 401:return c.ErrorCodes.UnknownUnauthorizedError;case 403:return c.ErrorCodes.unknownForbiddenError;case 404:return c.ErrorCodes.unknownNotFoundError;case 429:return c.ErrorCodes.UnknownTooManyRequestsError;case 500:return c.ErrorCodes.unknownInternalServerError;case 501:return c.ErrorCodes.unknownNotImplementedServerError;case 502:return c.ErrorCodes.unknownBadGatewayError;case 503:return c.ErrorCodes.unknownServiceUnavailableError;case 504:return c.ErrorCodes.unknownGatewayTimeoutError;default:return c.ErrorCodes.UnknownUnexpectedGenericError}}t.deserializeErrorResponse=function(e,t,r,c){var y,m=(null==e?void 0:e.toLowerCase().indexOf("<!doctype html"))>-1;(y=401===t.status?new o.ErrorStatus(e,d.CrmErrorCodes.UnknownUnauthorizedError):m?function(e,t,r){var n=f(0,t.status);return new o.ErrorStatus(e,n)}(e,t):function(e,t,r,n){try{var s=JSON.parse(e),u=s.error,l=void 0;return i.IsNullOrUndefined(u)?(r.error("Unexpected server error response - no error at top level",n),l=p(s,t,r)):l=p(u,t,r),l}catch(u){return n.push({name:a.EVENT_PARAMETERS.ERROR_COMPLETE_TEXT,value:e}),r.error("Failure during error parsing: "+u.message,n),new o.ErrorStatus(e,f(0,t.status))}}(e,t,c,r)).httpStatusCode=t.status;var h=t.headers?s.getHttpHeader(t.headers,u.HEADER.RETRY_AFTER):null;y.retryAfter=h;var g=t.headers?s.getHttpHeader(t.headers,u.HEADER.CONTENT_ID):null;if(g){var E=Number.parseInt(g,10);E>-1&&(y.faultedRequestIndex=E)}var b=t.headers?s.getHttpHeader(t.headers,u.HEADER.SERVER_REQUEST_ID):n.UNKNOWN,O=t.headers?s.getHttpHeader(t.headers,u.HEADER.CLIENT_REQUEST_ID):n.UNKNOWN;y.serverResponseId=b,y.clientRequestId=O;var v=t&&0===t.status;return r.push({name:l.MDS_EVENT_PARAMETERS.ODATA_ERROR_RESPONSE_IS_HTML_TYPE,value:m}),r.push({name:l.MDS_EVENT_PARAMETERS.IS_ERROR_IN_OFFLINE,value:v}),y}},"57fN":function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0})},"5ht9":function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.GetClientMetadataRequest=void 0;var o=i(r("fzfk")),s=function(){function e(){}return e.prototype.getMetadata=function(){return{boundParameter:null,operationName:"GetClientMetadata",operationType:o.ODataOperationType.Function,parameterTypes:{ClientMetadataQuery:{typeName:"Microsoft.Dynamics.CRM.MetadataQuery",structuralProperty:o.ODataStructuralProperty.ComplexType}}}},e}();t.GetClientMetadataRequest=s},"5sph":function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.buildBatchRequest=void 0;var a=r("hER9"),i=r("Wc7r");function o(e,t){var r,a,i="",o=1;try{for(var u=n(t),l=u.next();!l.done;l=u.next()){var c=l.value;if(c.serializationFailure)throw c.serializationFailure;i+="--"+e+"\n",i+="Content-Type: application/http\nContent-Transfer-Encoding: binary\n",i+="Content-ID: "+o+++"\n",i+="\n",i+=s(c)}}catch(e){r={error:e}}finally{try{l&&!l.done&&(a=u.return)&&a.call(u)}finally{if(r)throw r.error}}return i+="--"+e+"--\n"}function s(e){var t=e.method+" "+e.urlParameters+" HTTP/1.1\n";for(var r in e.additionalHeaders)r!==a.HEADER.CONTENT_TYPE&&"GET"!==e.method&&(t+=r+": "+e.additionalHeaders[r]+"\n");return"GET"!==e.method&&(t+=a.HEADER.CONTENT_TYPE+": application/json;type=entry\n"),t+="\n",e.body&&(t+=e.body,t+="\n"),t}function u(e){return e+"_"+new Date(Date.now()).getTime()}t.buildBatchRequest=function(e,t,r){var l,c,d;if(!e||!e.length)return{serializationFailure:"Attempted to create an OData batch with empty list of requests"};var p="";r||(r=u("batch"));try{for(var f=n(e),y=f.next();!y.done;y=f.next()){var m=y.value;p+="--"+r+"\n";var h="";if(Array.isArray(m)){var g=m,E=u("changeset");h=o(E,g),p+="Content-Type: multipart/mixed;boundary="+E+"\n"}else{var b=m;if(b.serializationFailure)return b;h=s(b),p+="Content-Type: application/http\nContent-Transfer-Encoding: binary\n"}p+="\n",p+=h,p+="\n"}}catch(e){l={error:e}}finally{try{y&&!y.done&&(c=f.return)&&c.call(f)}finally{if(l)throw l.error}}var O="--"+r+"--\r\n\0";return p.endsWith(O+"\n")?p=p.substr(0,p.length-1):p+=O,{urlParameters:"$batch",additionalHeaders:(d={},d[a.HEADER.CONTENT_TYPE]="multipart/mixed;boundary="+r,d.Accept=i.HEADER_VALUES.APPLICATION_JSON,d),body:p,method:"POST"}}},"6EES":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XmlEvaluatorType=void 0,function(e){e[e[void 0]=-1]="undefined",e[e.xPath=0]="xPath",e[e.domParser=1]="domParser"}(t.XmlEvaluatorType||(t.XmlEvaluatorType={}))},"6JO4":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NonCrudCommandData=void 0;var n=r("JWCx"),a=function(){function e(e,t,r,a,i){this._commandType=0,this._commandType=n.CommandType.nonCrud,this.commandId=e,this.command=t,this.entitiesInCommand=r,this.associatedCommandMainLogs=a,this.associatedCommandEntityLogs=i}return Object.defineProperty(e.prototype,"commandType",{get:function(){return this._commandType},enumerable:!1,configurable:!0}),e}();t.NonCrudCommandData=a},"6QHb":function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
var n,a,i,o,s,u,l,c,d,p,f,y,m,h,g;r.r(t),r.d(t,"OptionSetType",(function(){return n})),r.d(t,"DateTimeFormat",(function(){return a})),r.d(t,"ImeMode",(function(){return i})),r.d(t,"StringFormat",(function(){return o})),r.d(t,"AttributeTypeCode",(function(){return s})),r.d(t,"AttributeRequiredLevel",(function(){return u})),r.d(t,"SecurityTypes",(function(){return l})),r.d(t,"RelationshipType",(function(){return c})),r.d(t,"AssociatedMenuBehavior",(function(){return d})),r.d(t,"AssociatedMenuGroup",(function(){return p})),r.d(t,"OwnershipTypes",(function(){return f})),r.d(t,"CascadeType",(function(){return y})),r.d(t,"PrivilegeType",(function(){return m})),r.d(t,"EntityKeyIndexStatus",(function(){return h})),r.d(t,"AttributeType",(function(){return g})),function(e){e[e.Picklist=0]="Picklist",e[e.State=1]="State",e[e.Status=2]="Status",e[e.Boolean=3]="Boolean"}(n||(n={})),function(e){e[e.DateOnly=0]="DateOnly",e[e.DateAndTime=1]="DateAndTime"}(a||(a={})),function(e){e[e.Auto=0]="Auto",e[e.Inactive=1]="Inactive",e[e.Active=2]="Active",e[e.Disabled=3]="Disabled"}(i||(i={})),function(e){e[e.Email=0]="Email",e[e.Text=1]="Text",e[e.TextArea=2]="TextArea",e[e.Url=3]="Url",e[e.TickerSymbol=4]="TickerSymbol",e[e.PhoneticGuide=5]="PhoneticGuide",e[e.VersionNumber=6]="VersionNumber",e[e.Phone=7]="Phone"}(o||(o={})),function(e){e[e.Boolean=0]="Boolean",e[e.Customer=1]="Customer",e[e.DateTime=2]="DateTime",e[e.Decimal=3]="Decimal",e[e.Double=4]="Double",e[e.Integer=5]="Integer",e[e.Lookup=6]="Lookup",e[e.Memo=7]="Memo",e[e.Money=8]="Money",e[e.Owner=9]="Owner",e[e.PartyList=10]="PartyList",e[e.Picklist=11]="Picklist",e[e.State=12]="State",e[e.Status=13]="Status",e[e.String=14]="String",e[e.Uniqueidentifier=15]="Uniqueidentifier",e[e.CalendarRules=16]="CalendarRules",e[e.Virtual=17]="Virtual",e[e.BigInt=18]="BigInt",e[e.ManagedProperty=19]="ManagedProperty",e[e.EntityName=20]="EntityName",e[e.AliasedValue=21]="AliasedValue",e[e.ArrayOfString=22]="ArrayOfString",e[e.EntityImage=23]="EntityImage",e[e.MultiSelectPicklist=24]="MultiSelectPicklist",e[e.File=25]="File",e[e.NavigationProperty=26]="NavigationProperty"}(s||(s={})),function(e){e[e.None=0]="None",e[e.SystemRequired=1]="SystemRequired",e[e.ApplicationRequired=2]="ApplicationRequired",e[e.Recommended=3]="Recommended",e[e.Unknown=-1]="Unknown"}(u||(u={})),function(e){e[e.None=0]="None",e[e.Append=1]="Append",e[e.ParentChild=2]="ParentChild",e[e.Pointer=4]="Pointer",e[e.Inheritance=8]="Inheritance"}(l||(l={})),function(e){e[e.OneToManyRelationship=0]="OneToManyRelationship",e[e.ManyToManyRelationship=1]="ManyToManyRelationship",e[e.ManyToOneRelationship=2]="ManyToOneRelationship",e[e.None=-1]="None"}(c||(c={})),function(e){e[e.UseCollectionName=0]="UseCollectionName",e[e.UseLabel=1]="UseLabel",e[e.DoNotDisplay=2]="DoNotDisplay"}(d||(d={})),function(e){e[e.Details=0]="Details",e[e.Sales=1]="Sales",e[e.Service=2]="Service",e[e.Marketing=3]="Marketing"}(p||(p={})),function(e){e[e.None=0]="None",e[e.UserOwned=1]="UserOwned",e[e.TeamOwned=2]="TeamOwned",e[e.BusinessOwned=4]="BusinessOwned",e[e.OrganizationOwned=8]="OrganizationOwned",e[e.BusinessParented=16]="BusinessParented"}(f||(f={})),function(e){e[e.NoCascade=0]="NoCascade",e[e.Cascade=1]="Cascade",e[e.Active=2]="Active",e[e.UserOwned=3]="UserOwned",e[e.RemoveLink=4]="RemoveLink",e[e.Restrict=5]="Restrict"}(y||(y={})),function(e){e[e.None=0]="None",e[e.Create=1]="Create",e[e.Read=2]="Read",e[e.Write=3]="Write",e[e.Delete=4]="Delete",e[e.Assign=5]="Assign",e[e.Share=6]="Share",e[e.Append=7]="Append",e[e.AppendTo=8]="AppendTo"}(m||(m={})),function(e){e[e.Pending=0]="Pending",e[e.InProgress=1]="InProgress",e[e.Active=2]="Active",e[e.Failed=3]="Failed"}(h||(h={})),function(e){e.Boolean="boolean",e.Unknown="unknown",e.Customer="customer",e.Date="date",e.DateTime="datetime",e.Decimal="decimal",e.Double="double",e.Image="image",e.Integer="integer",e.Lookup="lookup",e.ManagedProperty="managedproperty",e.Memo="memo",e.Money="money",e.OptionSet="optionset",e.Owner="owner",e.PartyList="partylist",e.PickList="picklist",e.State="state",e.Status="status",e.String="string",e.UniqueIdentifier="uniqueidentifier",e.CalendarRules="calendarrules",e.Virtual="virtual",e.BigInt="bigint",e.EntityName="entityname",e.EntityImage="entityimage",e.AliasedValue="aliasedvalue",e.Regarding="regarding",e.MultiSelectPickList="multiselectpicklist",e.File="file",e.NavigationProperty="navigationproperty"}(g||(g={}))},"74cx":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.KeyValuePair=void 0;
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n=function(){function e(e,t){this._key=e,this._value=t}return e.prototype.get_key=function(){return this._key},e.prototype.get_value=function(){return this._value},e}();t.KeyValuePair=n},"7ABV":function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.extractIfMatchHeaderForConcurrency=t.buildUpdateRequest=void 0;var n=r("UxT/"),a=r("Wc7r"),i=r("TsoX"),o=r("oBfj");t.extractIfMatchHeaderForConcurrency=function(e,t){return e===i.ConcurrencyBehavior.IfRowVersionMatches&&t?'W/"'+t+'"':"*"},t.buildUpdateRequest=function(e,t,r,i,s,u,l,c,d,p,f){var y;void 0===s&&(s=!0);var m,h=n.getEntitySetName(e,t);m=r?h+"("+r+")":""+h,c&&(m+=c);var g={urlParameters:m,method:"PATCH",additionalHeaders:(y={},y[a.HEADER.MSCRM_SUPPRESS_DUPLICATION_DETECTION]=s.toString(),y[a.HEADER.IF_MATCH]=u||"*",y[a.HEADER.AUTO_DISASSOCIATE]="true",y),body:p?i:JSON.stringify(i)};return d&&Object.assign(g.additionalHeaders,d),l&&g.additionalHeaders&&(g.additionalHeaders[o.RETRIEVE_ROW_VERSION_HEADER]="true"),g&&g.additionalHeaders&&f&&(g.additionalHeaders[a.HEADER.MSCRM_SOLUTION_UNIQUE_NAME]=f),g}},"7l03":function(e,t,r){"use strict";r.r(t),r.d(t,"mapToValues",(function(){return d})),r.d(t,"throwOnNullOrUndefinedArgument",(function(){return p})),r.d(t,"loadBehaviorFromCrmSoap",(function(){return f})),r.d(t,"behaviorToCrmSoap",(function(){return y})),r.d(t,"loadRequiredLevelFromCrmSoap",(function(){return m})),r.d(t,"getClientType",(function(){return C})),r.d(t,"getErrorMessage",(function(){return w})),r.d(t,"convertSearchStringToSQL",(function(){return M})),r.d(t,"handleEscapeCharacters",(function(){return I})),r.d(t,"trimWildCards",(function(){return A})),r.d(t,"getMaxPageSizeFromPrefer",(function(){return D})),r.d(t,"getEntitySetNameFromUrl",(function(){return L})),r.d(t,"isUpsyncRequest",(function(){return U})),r.d(t,"isInternalRequest",(function(){return F})),r.d(t,"isEntityLogTable",(function(){return x})),r.d(t,"getEntityNameForEntityLogTable",(function(){return k})),r.d(t,"isOfflineOnlyEntity",(function(){return j})),r.d(t,"isOfflineLogTable",(function(){return q})),r.d(t,"getClientRequestId",(function(){return B})),r.d(t,"addClientRequestIdToSqlQueryRequests",(function(){return $})),r.d(t,"COMPOSITE_INDEX_DELIMITER",(function(){return u.COMPOSITE_INDEX_DELIMITER})),r.d(t,"encodeURIComponentForOData",(function(){return h})),r.d(t,"buildBatchRequest",(function(){return g})),r.d(t,"parseBatchResponse",(function(){return E})),r.d(t,"getHttpHeader",(function(){return b})),r.d(t,"isNullOrUndefined",(function(){return O})),r.d(t,"isNullOrUndefinedOrEmptyString",(function(){return _})),r.d(t,"buildODataResponseFromError",(function(){return S})),r.d(t,"isNullOrUndefinedOrEmpty",(function(){return v})),r.d(t,"getViewLocalStoreId",(function(){return T})),r.d(t,"isUserContextMetadataRequest",(function(){return N})),r.d(t,"convertErrorToLocalError",(function(){return P}));var n,a=r("Ln9p"),i=r("yNq8"),o=r("fnSt");!function(e){e[e.unknown=-1]="unknown",e[e.none=0]="none",e[e.systemRequired=1]="systemRequired",e[e.applicationRequired=2]="applicationRequired",e[e.recommended=3]="recommended"}(n||(n={}));var s=r("FedD"),u=r("hER9"),l=r("OJ1H"),c=r("lSoY");function d(e,t){return e?Object.keys(e).reduce((r,n)=>(r[n]=t(e[n]),r),{}):{}}function p(e,t){if(O(e))throw Error("Argument = ${argumentName} can't be null or undefined")}function f(e){switch(e){case"None":return o.DateTimeFieldBehavior.None;case"UserLocal":return o.DateTimeFieldBehavior.UserLocal;case"DateOnly":return o.DateTimeFieldBehavior.DateOnly;case"TimeZoneIndependent":return o.DateTimeFieldBehavior.TimeZoneIndependent;default:return o.DateTimeFieldBehavior.UserLocal}}function y(e){switch(e){case o.DateTimeFieldBehavior.None:return"None";case o.DateTimeFieldBehavior.UserLocal:return"UserLocal";case o.DateTimeFieldBehavior.DateOnly:return"DateOnly";case o.DateTimeFieldBehavior.TimeZoneIndependent:return"TimeZoneIndependent";default:return"UserLocal"}}function m(e){switch(e){case"None":return n.none;case"ApplicationRequired":return n.applicationRequired;case"Recommended":return n.recommended;case"SystemRequired":return n.systemRequired;default:return n.unknown}}function h(e){return e}function g(e){return e[0]}async function E(e){return[e]}function b(e,t){if(!e)return null;let r=e.get(t);return r||(r=e.get(t.toLowerCase())),r}function O(e){return null==e}function v(e){return!(e instanceof Promise)&&(O(e)||_(e)||0===Object.keys(e).length)}function _(e){return!!O(e)||typeof e===i.AttributeType.String&&""===e.trim()}function T(e){return c.MetadataType.savedView+u.COMPOSITE_INDEX_DELIMITER+e}function S(e,t,r,n){const a=r||0,i=e?e.message:"Unknown Error",o=e?e.stack:void 0,u=e?e.name:void 0;return Object(s.a)(a,t,new l.a(i,n,o,u))}function N(e){return!(O(e)||!O(e.MetadataType)||O(e.DependencyDepth)||"usercontext"!==e.DependencyDepth.toLowerCase())}function C(e,t,r=[]){let n=u.CLIENT_TYPE.remote;return e&&e.additionalHeaders&&e.additionalHeaders[u.HINT.executionStrategy]?[u.EXECUTION_HINTS.OFFLINE,u.EXECUTION_HINTS.ONLINE].includes(e.additionalHeaders[u.HINT.executionStrategy])?n=e.additionalHeaders[u.HINT.executionStrategy]===u.EXECUTION_HINTS.OFFLINE?u.CLIENT_TYPE.local:u.CLIENT_TYPE.remote:t&&t.warn("[Utils.getClientType] Unsupported execution strategy, default to remote client",r):t&&t.warn("[Utils.getClientType] No execution strategy provided, default to remote client",r),n}function P(e){let t=u.UNKNOWN,r=u.ErrorCode.UnknownUnexpectedGenericError,n=u.UNKNOWN;return O(e)||(R(e)?(t=_(e._message)?t:e._message,r=_(e._errorCode)?r:e._errorCode,n=_(e._stack)?n:e._stack):(t=_(e.message)?t:e.message,n=_(e.stack)?n:e.stack)),new l.a(t,r,n)}function R(e){return!v(e)&&void 0!==e.get_Message}function w(e){return R(e)?e._message?e._message:null:e?e.message?e.message:e:null}function M(e){const t=[];for(let r=0;r<e.length;r++)switch(e.charAt(r)){case"[":t.push("[[]");break;case"_":t.push("[_]");break;case"%":t.push("[%]");break;case"*":t.push("%");break;default:t.push(e.charAt(r))}return e.length&&e.endsWith("*")||t.push("%"),t.join("")}function I(e){return e.replace("'","''")}function A(e){let t=e;if(!t)return t;"*"===t[0]&&(t=t.substring(1));return"*"===t[t.length-1]&&(t=t.substring(0,t.length-1)),t}function D(e){let t=null;const r=new RegExp("odata.maxpagesize=(\\d+)"),n=e.additionalHeaders&&e.additionalHeaders.Prefer?e.additionalHeaders.Prefer.match(r):null;return n&&n.length>=2&&(t=Number(n[1])),t}function L(e){const t=e.url.split("/");return t[t.length-1].split("(")[0].split("?")[0]}function U(e,t){var r;return"true"===(null===(r=e.additionalHeaders)||void 0===r?void 0:r[u.HINT.UPSYNC_REQUEST_HINT])}function F(e,t){return t=t||L(e).slice(0,-1),U(e)&&(q(t)||j(t))}function x(e){return null==e?void 0:e.startsWith(u.offlineLogPrefix)}function k(e){return e.substring(u.offlineLogPrefix.length)}function j(e){return u.offlineOnlyTables.indexOf(e)>-1||e===u.norSyncMainLogTableName}function q(e){return x(e)||e===u.norSyncMainLogTableName}function B(e){return e&&e.additionalHeaders?e.additionalHeaders[u.HEADER.CLIENT_REQUEST_ID]:void 0}function $(e,t,r){let n=t.clientRequestId;const i=t.commonEventParameters||[];return _(n)&&(n=a.Guid.toString(a.Guid.newGuid()),r.warn("No client request found in executionContext, generated local request id: "+n,i)),e.additionalParameters?e.additionalParameters[u.HEADER.CLIENT_REQUEST_ID]=n:e.additionalParameters={[u.HEADER.CLIENT_REQUEST_ID]:n},e}},"7uPY":function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return a(t,e),t},o=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(a,i){function o(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((n=n.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var r,n,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(a=2&i[0]?n.return:i[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,i[1])).done)return a;switch(n=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,n=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],n=0}finally{r=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},u=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,a,i=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)o.push(n.value)}catch(e){a={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(a)throw a.error}}return o},c=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(l(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0}),t.PlaybackBatchManager=void 0;var d=r("Umyr"),p=r("Gw0Q"),f=r("e5ro"),y=r("bZIc"),m=r("JWCx"),h=r("YIL4"),g=i(r("8w73")),E=r("rljN"),b=r("dlGf"),O=r("1eye"),v=r("nf9M"),_=r("Ln9p"),T=r("+MPC"),S=r("yNq8"),N=r("rW8f"),C=r("4oeN"),P=r("f7K7"),R=r("ODI4"),w=r("+hYO"),M=r("UWtl"),I=function(){function e(e,t,r){this._syncErrorRetryLimit=1,this._startTransaction=!1,this._endTransaction=!1,this.hasNetworkIssueDuringUpsync=!1,this._participationTypeMasktoType={1:"from",2:"to",3:"cc",4:"bcc",5:"requiredattendees",6:"optionalattendees",7:"organizer",10:"resources",11:"customer",12:"partner"},this.playbackQueue=[],this._entityReferenceMap={},this._offlineLogHelper=e,this.hasNetworkIssueDuringUpsync=!1,this._actionDataList=[],this._rowVersionMap={},this._sidToDelete=[],this._syncErrorSid=[],this._entityLogTables=[],this._commandId=C.LegacyGuid.get_empty(),this._startTransaction=!1,this._endTransaction=!1,this._applicationContext=t,this._tracer=this._applicationContext.TraceManager.getTracer(g.upsyncComponentName),this._config=r}return e.prototype.processBatchForUpSync=function(){return o(this,void 0,void 0,(function(){var e,t;return s(this,(function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),this.hasNetworkIssueDuringUpsync?(this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackBatchManager.ProcessBatchForUpSync.NetworkFailure","ProcessPlaybackQueue Stopped")),this.playbackQueue=[],[2,!1]):[3,1];case 1:return this.playbackQueue.length?[3,3]:(this._sidToDelete.length>0&&this._offlineLogHelper.clearOfflineLogs(this._sidToDelete,this._entityLogTables,this._commandId),[4,this._ProcessActionDataList(!0)]);case 2:return r.sent(),this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackBatchManager.ProcessBatchForUpSync.Success","ProcessPlaybackQueue Completed")),[2,!0];case 3:return e=this.playbackQueue.shift(),[4,this._ProcessUpSyncDataList(e,0)];case 4:return r.sent(),e.length>0&&this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackBatchManager.ProcessBatchForUpSync.Success","Total Number of "+(e[0].commandType?"Non ":"")+"CRUD Commands for current batch is "+e.length)),this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackBatchManager.ProcessBatchForUpSync.Success","BatchItem Processed")),[2,!0];case 5:throw t=r.sent(),t=T.convertToErrorStatus(t),this._tracer.error(E.addPrefix("OfflineUpSync.PlaybackBatchManager.ProcessBatchForUpSync.Failure",t.message)),t;case 6:return[2]}}))}))},e.prototype._ProcessUpSyncDataList=function(e,t){return o(this,void 0,void 0,(function(){var r;return s(this,(function(n){switch(n.label){case 0:if(this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackBatchManager._ProcessUpSyncDataList","ProcessUpSyncDataList Started")),v.IsNullOrUndefined(e)||e.length===t)return this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackBatchManager._ProcessUpSyncDataList.Success","ProcessUpSyncDataList Completed")),[2,!0];if(this.hasNetworkIssueDuringUpsync)return this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackBatchManager._ProcessUpSyncDataList.Success","ProcessUpSyncDataList Completed due to network issues during upsync cycle")),[2,!0];n.label=1;case 1:return n.trys.push([1,4,,5]),[4,this._ProcessUpSyncDataItem(e[t])];case 2:return n.sent(),[4,this._ProcessUpSyncDataList(e,++t)];case 3:return n.sent(),[2,!0];case 4:throw r=n.sent(),r=T.convertToErrorStatus(r),this._tracer.error(E.addPrefix("OfflineUpSync.PlaybackBatchManager._ProcessUpSyncDataList.Failure",r.message)),r;case 5:return[2]}}))}))},e.prototype._ProcessUpSyncDataItem=function(e){return o(this,void 0,void 0,(function(){var t,r;return s(this,(function(n){switch(n.label){case 0:if(this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackBatchManager._ProcessUpSyncDataItem.Started","ProcessUpSyncDataList Started")),v.IsNullOrUndefined(e))return this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackBatchManager._ProcessUpSyncDataItem.Success","ProcessUpSyncDataList Completed")),[2,!0];(t=[]).push({name:"CommandType",value:null==e?void 0:e.commandType}),n.label=1;case 1:return n.trys.push([1,12,,13]),[4,this._ExecuteActionDataListIfRequired(e)];case 2:return!n.sent()||this.hasNetworkIssueDuringUpsync?[3,10]:e.commandType?[3,6]:this._isFileOrImageTypeOperation(e)?(t.push({name:"IsFileImage",value:!0}),this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackBatchManager._ProcessUpSyncDataItem","ProcessCRUDItem for file attachment or image"),t),[4,this._ProcessFileOrImageTypeItem(e)]):[3,4];case 3:return n.sent(),this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackBatchManager._ProcessUpSyncDataItem.Success","File/image upsync Completed"),t),[2,!0];case 4:return t.push({name:"IsFileImage",value:!1}),[4,this._ProcessCRUDItem(e)];case 5:return n.sent(),this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackBatchManager._ProcessUpSyncDataItem.Success","ProcessUpSyncDataList Completed"),t),[2,!0];case 6:if(e.commandType!==m.CommandType.transaction)return[3,7];if(!this._startTransaction&&e.associatedMainLog.logTableID.toLowerCase()===g.norSyncUpSyncTransactionBeginLog.toLowerCase())return this._startTransaction=!0,this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackBatchManager._ProcessUpSyncDataItem.Success","ProcessUpSyncDataList Completed"),t),[2,!0];if(this._startTransaction===this._endTransaction)return this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackBatchManager._ProcessUpSyncDataItem.Success","ProcessUpSyncDataList Completed"),t),[2,!0];throw new T.ErrorStatus("Invalid Transaction");case 7:return[4,this._ProcessNonCRUDItem(e)];case 8:return n.sent(),this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackBatchManager._ProcessUpSyncDataItem.Success","ProcessUpSyncDataList Completed"),t),[2,!0];case 9:return[3,11];case 10:return this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackBatchManager._ProcessUpSyncDataItem.Success","ProcessUpSyncDataList Completed"),t),[2,!0];case 11:return[3,13];case 12:throw r=n.sent(),r=T.convertToErrorStatus(r),this._tracer.error(E.addPrefix("OfflineUpSync.PlaybackBatchManager._ProcessUpSyncDataItem.Failure",r.message),t),r;case 13:return[2]}}))}))},e.prototype._ExecuteActionDataListIfRequired=function(e){this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackBatchManager._ExecuteActionDataListIfRequired","ExecuteActionDataListIfRequired Started"));var t=e.associatedMainLog.logTableID;if(y.PlaybackManager.getSkipTables().indexOf(t)>=0)return this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackBatchManager._ExecuteActionDataListIfRequired.Success","ExecuteActionDataListIfRequired Completed")),this._AddOfflineLogToDelete(e.associatedMainLog),Promise.resolve(!1);if(e.commandType===m.CommandType.transaction)return t===g.norSyncUpSyncTransactionEndLog&&(this._endTransaction=!0),this._AddOfflineLogToDelete(e.associatedMainLog),this._ProcessActionDataList(!0);if(e.commandType)return this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackBatchManager._ExecuteActionDataListIfRequired.Non-CRUDActionEncountered","ExecuteActionDataListIfRequired Completed")),this._ProcessActionDataList(!0);var r=E.getEntityNameFromOfflineLog(e.associatedMainLog);return this._isFileOrImageTypeOperation(e)?(this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackBatchManager._ExecuteActionDataListIfRequired.FileOrImageTypeOperationEncountered","ExecuteActionDataListIfRequired Completed")),this._ProcessActionDataList(!0)):""===r||this._actionDataList.length!==y.PlaybackManager.get_DefaultInstance().getMaxBatchSize()||this._startTransaction?(this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackBatchManager.CheckActionDataListForExecution.Success","CheckActionDataListForExecution Completed")),Promise.resolve(!0)):(this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackBatchManager._ExecuteActionDataListIfRequired.Success","ExecuteActionDataListIfRequired Completed")),this._ProcessActionDataList(!0))},e.prototype._isFileOrImageTypeOperation=function(e){var t=this,r=!1;if(e.sqlOperation===h.SQLOperationType.Update){var n=e.entityRecord;if(!n)return this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackBatchManager._isFileOrImageTypeOperation","upSyncEntityRecord is null")),!1;var a=n.get_fieldTypes();if(a){var i=n.get_changedFieldNames();i.forEach((function(e){a[e]!==S.AttributeType.Image&&a[e]!==S.AttributeType.File||(t._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackBatchManager._isFileOrImageTypeOperation","Found a file or image type operation. Changed field count = "+i.length)),r=!0)}))}else this._tracer.error(E.addPrefix("OfflineUpSync.PlaybackBatchManager._isFileOrImageTypeOperation","fieldTypes value is null"))}return r},e.prototype._ProcessCRUDItem=function(e){var t,r;return o(this,void 0,void 0,(function(){var n,a,i,o,u,l;return s(this,(function(s){switch(s.label){case 0:(n=[]).push({name:"CommandType",value:null==e?void 0:e.commandType}),this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackBatchManager._ProcessCRUDItem","ProcessCRUDItem Started")),s.label=1;case 1:return s.trys.push([1,2,,4]),e.entityRecord.get_identifier().LogicalName===g.activityParty?(this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackBatchManager._ProcessCRUDItem.Success","ProcessCRUDItem Completed")),[2,this.HandleActivityParty(e)]):(this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackBatchManager._ProcessCRUDItem.Success","ProcessCRUDItem Completed")),this._actionDataList.push(e),[3,4]);case 2:return a=s.sent(),e&&e?e.entityRecord?e.entityRecord.get_identifier()?(n.push({name:"LogicalName",value:e.entityRecord.get_identifier().LogicalName}),n.push({name:"Id",value:null===(r=null===(t=e.entityRecord.get_identifier())||void 0===t?void 0:t.Id)||void 0===r?void 0:r.toString()})):n.push({name:"Reason",value:"upSyncDataItem.entityRecord.get_identifier is null"}):n.push({name:"Reason",value:"upSyncDataItem.entityRecord is null"}):n.push({name:"Reason",value:"upSyncDataItem is null"}),n.push({name:"Error",value:a}),this._tracer.error(E.addPrefix("OfflineUpSync.PlaybackBatchManager._ProcessCRUDItem.Error","ProcessCRUDItem failed due to runtime exception"),n),i=[],o=new p.RollBackHandler(this._offlineLogHelper,this._applicationContext),u=new T.ErrorStatus("Unknown error occurred",null,null,null,null,null,a),l=this._BuildUpsyncResponse(u),i.push(o.handle(e,l)),[4,Promise.all(i)];case 3:return s.sent(),[3,4];case 4:return[2,this._ProcessActionDataList(!1)]}}))}))},e.prototype._ProcessActionDataList=function(e){return o(this,void 0,void 0,(function(){var t,r;return s(this,(function(n){switch(n.label){case 0:return this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackBatchManager._ProcessActionDataList","ProcessActionDataList Started")),this._actionDataList.length>0?e&&this._startTransaction===this._endTransaction?(this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackBatchManager._ProcessActionDataList.Success","CRUD Criteria satisfied for Execution")),[4,this._ExecuteCUDBatch()]):[3,2]:[3,10];case 1:return n.sent(),[2,!0];case 2:if(this._actionDataList.length!==y.PlaybackManager.get_DefaultInstance().getMaxBatchSize()||this._startTransaction)return[3,9];t=void 0,n.label=3;case 3:return n.trys.push([3,5,,6]),[4,this._IsLastLogActivity()];case 4:return t=n.sent(),[3,6];case 5:throw r=n.sent(),r=T.convertToErrorStatus(r),this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackBatchManager._ProcessActionDataList.Failure",r.message)),r;case 6:return t?[3,8]:(this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackBatchManager._ProcessActionDataList.Success","CRUD Criteria satisfied for Execution")),[4,this._ExecuteCUDBatch()]);case 7:return n.sent(),[2,!0];case 8:case 9:case 10:return this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackBatchManager._ProcessActionDataList.Success","ProcessActionDataList Completed")),[2,!0]}}))}))},e.prototype._ExecuteCUDBatch=function(){this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackBatchManager._ProcessActionDataList.Success","Execution Started"));return this._ProcessCrudCommandAction(),this._executeCommand(0,[])},e.prototype._ProcessCrudCommandAction=function(){var e=[];this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackBatchManager._ProcessCrudCommandAction","ProcessCrudCommandAction Started"));for(var t=0;t<this._actionDataList.length;t++){var r=this._actionDataList[t];if(!v.IsNullOrUndefined(r))if(e.indexOf(r.entityRecord.get_key())>=0)g.versionNumber in r.entityRecord.fields&&(delete r.entityRecord.fields[g.versionNumber],r.sqlOperation===h.SQLOperationType.Delete&&r.entityRecord.get_identifier().set_rowVersion(""));else{var n=r.entityRecord.get_key();if(e.push(n),n in this._rowVersionMap){r.entityRecord.initializeValue(g.versionNumber,this._rowVersionMap[n].toString(),S.AttributeType.String),r.entityRecord.get_identifier().set_rowVersion(this._rowVersionMap[n].toString());var a=r.entityRecord.get_changedFieldNames().indexOf(g.versionNumber);a>=0&&r.entityRecord.get_changedFieldNames().splice(a,1)}}}this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackBatchManager._ProcessCrudCommandAction.Success","ProcessCrudCommandAction Completed"))},e.prototype._IsLastLogActivity=function(){var e,t;return o(this,void 0,void 0,(function(){var r,n,a;return s(this,(function(i){switch(i.label){case 0:return r=this._actionDataList[this._actionDataList.length-1],v.IsNullOrUndefined(r)?[3,2]:(n=r.entityRecord.get_identifier().LogicalName,[4,null===(t=null===(e=this._applicationContext.DataLayerConfiguration.MetadataProvider)||void 0===e?void 0:e.retrieveEntity)||void 0===t?void 0:t.call(e,n)]);case 1:return(null==(a=i.sent())?void 0:a.IsActivity)?[2,!0]:[2,!1];case 2:return[2,!1]}}))}))},e.prototype.HandleActivityParty=function(e){var t,r,n;return o(this,void 0,void 0,(function(){var a,i,o,u,l,c,d,p,f;return s(this,(function(s){switch(s.label){case 0:this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackBatchManager._HandleActivityParty","HandleActivityParty Started")),s.label=1;case 1:return s.trys.push([1,7,,8]),this._actionDataList.length?[3,2]:(this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackBatchManager._HandleActivityParty","HandleActivityParty Completed as there are no ActionDataList")),[2,!0]);case 2:return e.sqlOperation===h.SQLOperationType.Delete?[3,5]:(a=this._actionDataList.length-1)>=0&&!v.IsNullOrUndefined(this._actionDataList[a])?(i=this._actionDataList[a],v.IsNullOrUndefined(i)?[3,4]:(o=i.entityRecord,u=o.get_identifier().LogicalName,[4,null===(r=null===(t=this._applicationContext.DataLayerConfiguration.MetadataProvider)||void 0===t?void 0:t.retrieveEntity)||void 0===r?void 0:r.call(t,u)])):[3,4];case 3:(null==(l=s.sent())?void 0:l.IsActivity)&&(i.associatedActivityParties.push(e),c=e.entityRecord,o.hasField("activityid")&&(d=null===(n=c.getValue("activityid"))||void 0===n?void 0:n.Id.toString(),p=o.getValue("activityid").toString(),d===p&&this._AddActivityPartyToActivity(c,o))),this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackBatchManager._HandleActivityParty","HandleActivityParty Completed")),s.label=4;case 4:return[3,6];case 5:e.sqlOperation===h.SQLOperationType.Delete&&this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackBatchManager._HandleActivityParty","HandleActivityParty(Delete) Completed")),s.label=6;case 6:return[2,!0];case 7:throw f=s.sent(),f=T.convertToErrorStatus(f),this._tracer.error(E.addPrefix("OfflineUpSync.PlaybackBatchManager._HandleActivityParty.Failure",f.message)),f;case 8:return[2]}}))}))},e.prototype._AddActivityPartyToActivity=function(e,t){var r=e.getValue("participationtypemask").get_value(),n="";(r&&(n=this._participationTypeMasktoType[r.toString()]),v.IsNullOrUndefinedOrEmptyString(n))||(this._tracer.info(E.addPrefix("OfflineUpSync.PlaybackBatchManager._AddActivityPartyToActivity","Adding activity part to activity "+t.getValue("activitytypecode"))),t.hasField(n)&&!v.IsNullOrUndefined(t.getValue(n))?t.getValue(n).add(e):(t.initializeValue(n,new M.EntityCollection([e],!1,1,!1),S.AttributeType.PartyList),t.get_changedFieldNames().push(n)))},e.prototype._ProcessNonCRUDItem=function(e){return this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackBatchManager._ProcessNonCRUDItem","ProcessNonCRUDItem Started")),this._actionDataList.push(e),this._executeCommand(e.commandType,[])},e.prototype._executeCommand=function(e,t,r){return o(this,void 0,void 0,(function(){var n,a,i;return s(this,(function(o){switch(o.label){case 0:n=_.Guid.newGuid().guid,t.push({name:g.UpsyncParameters.upsyncRequestId,value:n}),t.push({name:g.UpsyncParameters.commandType,value:E.getUpsyncCommandTypeName(e)}),t.push({name:g.UpsyncParameters.isCrudTransactionBatch,value:this._startTransaction&&this._endTransaction}),t.push({name:g.UpsyncParameters.upsyncId,value:y.PlaybackManager.getUpsyncId()}),o.label=1;case 1:return o.trys.push([1,4,6,7]),[4,this._CommandExecutor(e,t,r)];case 2:return a=o.sent(),[4,this._HandleSuccessResponse(a,e,t,r)];case 3:return o.sent(),[3,7];case 4:return i=o.sent(),[4,this._HandleICrmErrorResponse(i,e,t,r)];case 5:return o.sent(),[3,7];case 6:return this._HandleCommandAfterExecution(),[7];case 7:return[2,!0]}}))}))},e.prototype._CommandExecutor=function(e,t,r){return o(this,void 0,void 0,(function(){var n;return s(this,(function(a){switch(a.label){case 0:this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackBatchManager._CommandExecutor.Success","CommandExecutor Started")),n=new Date,a.label=1;case 1:return a.trys.push([1,,5,6]),r?[4,b.UpSyncManager.get_instance(this._applicationContext,this._config).upSyncFileOrImage(this._actionDataList,t)]:[3,3];case 2:return[2,a.sent()];case 3:return[4,b.UpSyncManager.get_instance(this._applicationContext,this._config).upSync(this._actionDataList,this._startTransaction&&this._endTransaction,e,t)];case 4:return[2,a.sent()];case 5:return t.push({name:g.UpsyncParameters.responseTime,value:+new Date-+n}),[7];case 6:return[2]}}))}))},e.prototype._HandleCommandAfterExecution=function(){this._commandId=C.LegacyGuid.get_empty(),this._actionDataList=[],this._sidToDelete=[],this._entityLogTables=[],this._syncErrorSid=[],this._startTransaction&&this._endTransaction&&(this._startTransaction=!1,this._endTransaction=!1)},e.prototype._processSuccessResponseForNonCUD=function(e){return o(this,void 0,void 0,(function(){var t,r,n;return s(this,(function(a){switch(a.label){case 0:if(this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackBatchManager.ProcessSuccessResponseForNonCUD","ProcessSuccessResponseForNonCUD Started")),this._entityReferenceMap={},t=[],this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackBatchManager.ProcessSuccessResponseForNonCUD.Success","Command Execution Succeeded At Server")),!e.length)return[2,!0];for(r=0;r<e.length;r++)t.push(this._processSuccessMultipleResponseItemForNonCUD(this._actionDataList[0],e[r],r));a.label=1;case 1:return a.trys.push([1,4,,5]),[4,Promise.all(t)];case 2:return a.sent(),[4,this._ProcessReturnedRowVersions()];case 3:return a.sent(),this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackBatchManager.ProcessSuccessResponseForNonCUD.Success","Processing Success Response succeeded")),[2,!0];case 4:throw n=a.sent(),n=T.convertToErrorStatus(n),this._tracer.error(E.addPrefix("OfflineUpSync.PlaybackBatchManager.ProcessSuccessResponseForNonCUD.Fail",n.message)),n;case 5:return[2]}}))}))},e.prototype._processSuccessMultipleResponseItemForNonCUD=function(e,t,r){return o(this,void 0,void 0,(function(){var n,a,i,o,u,l,c,d,p;return s(this,(function(s){switch(s.label){case 0:n=e.entitiesInCommand,this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackBatchManager.ProcessSuccessMultipleResponseItemForNonCUD","ProcessSuccessMultipleResponseItemForNonCUD Started")),s.label=1;case 1:return s.trys.push([1,6,,7]),r?[3,3]:(a=new O.UpSyncResponse,v.IsNullOrUndefined(e)||v.IsNullOrUndefined(e.associatedMainLog)?(this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackBatchManager.ProcessSuccessMultipleResponseItemForNonCUD.Success","Empty Data")),[2,!1]):((i=e.associatedMainLog.SID).toString()in y.PlaybackManager.syncErrorRetryCountMap&&delete y.PlaybackManager.syncErrorRetryCountMap[i.toString()],[4,new f.SuccessHandler(this._offlineLogHelper,this._applicationContext).handle(e,a)]));case 2:return s.sent(),this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackBatchManager.ProcessSuccessMultipleResponseItemForNonCUD.Success","ProcessSuccessMultipleResponseItem Completed")),[2,!0];case 3:return this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackBatchManager.ProcessSuccessMultipleResponseItemForNonCUD.Success","ProcessSuccessMultipleResponseItemForNonCUD Completed")),[4,t.json()];case 4:return o=s.sent(),v.IsNullOrUndefined(o)?[2,!1]:(u=n[r-1],l=o[g.versionNumber],c=u.id,d=new N.LegacyEntityReference(u.entityLogicalName,_.Guid.toLegacyGuid(new _.Guid(c)),void 0,l),v.IsNullOrUndefined(l)||v.IsNullOrUndefined(c)||(this._entityReferenceMap[d.get_key()]=d),[2,!0]);case 5:return[3,7];case 6:throw p=s.sent(),p=T.convertToErrorStatus(p),this._tracer.error(E.addPrefix("OfflineUpSync.PlaybackBatchManager.ProcessSuccessMultipleResponseItemForNonCUD.Failure",p.message)),p;case 7:return[2]}}))}))},e.prototype._ProcessFailureResponseForNonCUD=function(e,t){return o(this,void 0,void 0,(function(){var r,n,a,i,o;return s(this,(function(s){switch(s.label){case 0:for(this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackBatchManager._ProcessFailureResponseForNonCUD.Start","Processing Failure Response Started")),new O.UpSyncResponse,r=this._BuildUpsyncResponse(e),n=[],a=this._actionDataList.length-1;a>=0;a--)this._IsSyncError(this._actionDataList[a])?(this._ManageSyncError(this._actionDataList[a].associatedMainLog.SID,this._tracer,t),this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackBatchManager.ProcessFailureResponse.Warning","One Sync Error Entity Failed to Upsync"))):(i=new p.RollBackHandler(this._offlineLogHelper,this._applicationContext),n.push(i.handle(this._actionDataList[a],r)));this._addEventParametersForFaultedUpSyncResponse(r,t),this._applicationContext.EventManager.ReportComponentFailure(g.upsyncComponentName,new T.ErrorStatus(r.message),"sync error returned from server for nonCrud command",t),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,Promise.all(n)];case 2:return s.sent(),this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackBatchManager._ProcessFailureResponseForNonCUD.Success","Processing Failure Response succeeded")),[2,!0];case 3:throw o=s.sent(),o=T.convertToErrorStatus(o),this._tracer.error(E.addPrefix("OfflineUpSync.PlaybackBatchManager._ProcessFailureResponseForNonCUD.Fail",o.message)),o;case 4:return[2]}}))}))},e.prototype._HandleSuccessResponse=function(e,t,r,n){return o(this,void 0,void 0,(function(){var a,i;return s(this,(function(o){switch(o.label){case 0:a=!1,o.label=1;case 1:switch(o.trys.push([1,9,,10]),t){case m.CommandType.crud:return[3,2];case m.CommandType.nonCrud:return[3,6]}return[3,8];case 2:return n?(this._addEventParametersForCrudCommandData(this._actionDataList[0],r),this._applicationContext.EventManager.ReportComponentSuccess(g.upsyncComponentName,r),a=!0,[3,5]):[3,3];case 3:return[4,this._processSuccessResponseForCrud(t,e,r)];case 4:a=o.sent(),o.label=5;case 5:return[3,8];case 6:return this._applicationContext.EventManager.ReportComponentSuccess(g.upsyncComponentName,r),[4,this._processSuccessResponseForNonCUD(e)];case 7:return a=o.sent(),[3,8];case 8:return[3,10];case 9:throw i=o.sent(),i=T.convertToErrorStatus(i),this._tracer.error(E.addPrefix("OfflineUpSync.PlaybackBatchManager._HandleSuccessResponse.Fail."+E.getUpsyncCommandTypeName(t),i.message)),i;case 10:return a?[4,this._ProcessActionDataListToDelete()]:[3,12];case 11:return o.sent(),[2,!0];case 12:return[2,!1]}}))}))},e.prototype._HandleICrmErrorResponse=function(e,t,r,n){return o(this,void 0,void 0,(function(){var a,i,o;return s(this,(function(s){switch(s.label){case 0:return v.IsNullOrUndefined(e)?(this._tracer.error("OfflineUpSync.PlaybackBatchManager._HandleCrmErrorResponse:Error response is null",r),i=!0,[3,6]):[3,1];case 1:return r.push({name:"ErrorHttpStatus",value:e.httpStatusCode}),r.push({name:"ErrorMessage",value:e.message}),r.push({name:"ErrorCode",value:e.errorCode}),503===e.httpStatusCode||0===e.httpStatusCode&&e.errorCode===w.CrmErrorCodes.DataSourceOfflineErrorCode?(this._tracer.warn("OfflineUpSync.PlaybackBatchManager._HandleCrmErrorResponse.:Error response offline error",r),this.hasNetworkIssueDuringUpsync=!0,i=!1,[3,6]):[3,2];case 2:a=t===m.CommandType.nonCrud?this._ProcessFailureResponseForNonCUD(e,r):this._processFailureResponseForCUD(e,r),s.label=3;case 3:return s.trys.push([3,5,,6]),[4,a];case 4:return status=s.sent(),[3,6];case 5:if(o=s.sent(),!n)throw o=T.convertToErrorStatus(o),this._tracer.error(E.addPrefix("OfflineUpSync.PlaybackBatchManager._HandleICrmErrorResponse.Fail."+E.getUpsyncCommandTypeName(t),o.message),r),o;return this._tracer.error(E.addPrefix("OfflineUpSync.PlaybackBatchManager._HandleCrmErrorResponse.Fail.FileImage."+E.getUpsyncCommandTypeName(t),o.message),r),i=!0,[3,6];case 6:return r.push({name:"DeleteActionDatalistFromLogTable",value:i}),this._tracer.warn("OfflineUpSync.PlaybackBatchManager._HandleCrmErrorResponse.: Completed",r),i?[4,this._ProcessActionDataListToDelete()]:[3,8];case 7:return s.sent(),[2,!0];case 8:return[2,!1]}}))}))},e.prototype._processFailureResponseForCUD=function(e,t){return o(this,void 0,void 0,(function(){var r,n,a,i,o,u;return s(this,(function(s){switch(s.label){case 0:for(this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackBatchManager.ProcessFailureResponse.Start","Processing Failure Response Started"),t),new O.UpSyncResponse,r=this._BuildUpsyncResponse(e),n=[],a=this._actionDataList.length-1;a>=0;a--)i=t.concat([]),this._IsSyncError(this._actionDataList[a])?(this._ManageSyncError(this._actionDataList[a].associatedMainLog.SID,this._tracer,t),this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackBatchManager.ProcessFailureResponse.Warning","One Sync Error Entity Failed to Upsync"),i)):(o=new p.RollBackHandler(this._offlineLogHelper,this._applicationContext),n.push(o.handle(this._actionDataList[a],r))),this._actionDataList[a]instanceof d.CrudCommandData&&this._addEventParametersForCrudCommandData(this._actionDataList[a],i),this._addEventParametersForFaultedUpSyncResponse(r,i),this._applicationContext.EventManager.ReportComponentFailure("Upsync",new T.ErrorStatus(r.message),"sync error returned from server for the whole crud batch",i);s.label=1;case 1:return s.trys.push([1,3,,4]),[4,Promise.all(n)];case 2:return s.sent(),this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackBatchManager.ProcessFailureResponse.Success","Processing Failure Response succeeded"),t),[2,!0];case 3:throw u=s.sent(),u=T.convertToErrorStatus(u),this._tracer.error(E.addPrefix("OfflineUpSync.PlaybackBatchManager.ProcessFailureResponse.Fail",u.message),t),u;case 4:return[2]}}))}))},e.prototype._processSuccessResponseForCrud=function(t,r,n){return o(this,void 0,void 0,(function(){var a,i,o,l,c,d,f,y,m,h,b,O,_,S,N,C,P;return s(this,(function(s){switch(s.label){case 0:if(this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackBatchManager.ProcessSuccessResponse","ProcessSuccessResponse Started")),this._entityReferenceMap={},a=[],!r.length)return this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackBatchManager.ProcessSuccessResponse.Success","Command Execution Succeeded At Server")),[2,!0];i=!1;try{for(o=u(r),l=o.next();!l.done;l=o.next())if(!(h=l.value).ok){i=!0;break}}catch(e){C={error:e}}finally{try{l&&!l.done&&(P=o.return)&&P.call(o)}finally{if(C)throw C.error}}if(c=this._startTransaction&&this._endTransaction,d=!1,c)for(m=r.length-1;m>=0;m--)if(!(h=r[m]).ok){for(d=!0,b=this._BuildUpsyncResponse(h),f=0;f<this._actionDataList.length;f++)this._actionDataList[f]&&(_=new p.RollBackHandler(this._offlineLogHelper,this._applicationContext),a.push(_.handle(this._actionDataList[f],b)),S=n.concat([]),this._addEventParametersForCrudCommandData(this._actionDataList[f],S),this._addEventParametersForFaultedUpSyncResponse(b,S),this._applicationContext.EventManager.ReportComponentFailure("Upsync",new T.ErrorStatus(b.message),"sync error returned from server for crud transactionBatch",S));break}if(i||d)for(this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackBatchManager.ProcessSuccessResponse.ServerFailure","Few Command Execution failed At Server")),m=r.length-1;m>=0;m--)(h=r[m]).ok?(h=h,a.push(this._processSuccessMultipleResponseItem(t,this._actionDataList[m],h)),S=n.concat([]),this._addEventParametersForCrudCommandData(this._actionDataList[m],S),this._applicationContext.EventManager.ReportComponentSuccess(g.upsyncComponentName,S)):(h=h,b=this._BuildUpsyncResponse(h),v.IsNullOrUndefined(this._actionDataList[m])||(this._IsSyncError(this._actionDataList[m])?(h.errorCode===g.CrmErrorCodes.PrivilegeDenied&&(O=h,this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackBatchManager.ProcessSuccessResponse.ServerFailure",O.message)),e.overallSyncErrorMessage=O.message),this._ManageSyncError(this._actionDataList[m].associatedMainLog.SID,this._tracer,n)):(_=new p.RollBackHandler(this._offlineLogHelper,this._applicationContext),a.push(_.handle(this._actionDataList[m],b))),S=n.concat([]),this._addEventParametersForCrudCommandData(this._actionDataList[m],S),this._addEventParametersForFaultedUpSyncResponse(b,S),this._applicationContext.EventManager.ReportComponentFailure("Upsync",new T.ErrorStatus(b.message),"sync error returned from server for single crud command",S)));else for(this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackBatchManager.ProcessSuccessResponse.Success","Command Execution Succeeded At Server")),y=0;y<r.length;y++)h=r[y],a.push(this._processSuccessMultipleResponseItem(t,this._actionDataList[y],h)),S=n.concat([]),this._addEventParametersForCrudCommandData(this._actionDataList[y],S),this._applicationContext.EventManager.ReportComponentSuccess(g.upsyncComponentName,S);if(!a.length)return[2,!0];s.label=1;case 1:return s.trys.push([1,4,,5]),[4,Promise.all(a)];case 2:return s.sent(),[4,this._ProcessReturnedRowVersions()];case 3:return s.sent(),this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackBatchManager.ProcessSuccessResponse.Success","Processing Success Response succeeded")),[2,!0];case 4:throw N=s.sent(),N=T.convertToErrorStatus(N),this._tracer.error(E.addPrefix("OfflineUpSync.PlaybackBatchManager.ProcessSuccessResponse.Fail",N.message)),N;case 5:return[2]}}))}))},e.prototype._addEventParametersForCrudCommandData=function(e,t){var r,n,a;t.push({name:g.UpsyncParameters.operationType,value:E.getSqlCommandName(e.sqlOperation)}),t.push({name:g.UpsyncParameters.EntityName,value:(null===(n=null===(r=e.entityRecord)||void 0===r?void 0:r.get_identifier())||void 0===n?void 0:n.LogicalName)||"unknown"}),t.push({name:g.UpsyncParameters.RecordId,value:(null===(a=e.entityRecord)||void 0===a?void 0:a.get_key())||"unknown"})},e.prototype._addEventParametersForFaultedUpSyncResponse=function(e,t){t.push({name:g.UpsyncParameters.errorMessage,value:e.message}),t.push({name:g.UpsyncParameters.errorCode,value:e.errorCode})},e.prototype._processSuccessMultipleResponseItem=function(e,t,r){return o(this,void 0,void 0,(function(){var n,a,i,o,u;return s(this,(function(s){switch(s.label){case 0:if(this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackBatchManager.ProcessSuccessMultipleResponseItem","ProcessSuccessMultipleResponseItem Started")),n=new O.UpSyncResponse,v.IsNullOrUndefined(t)||v.IsNullOrUndefined(t.associatedMainLog))return this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackBatchManager.ProcessSuccessMultipleResponseItem.Success","Empty Data")),[2,!1];(a=t.associatedMainLog.SID).toString()in y.PlaybackManager.syncErrorRetryCountMap&&delete y.PlaybackManager.syncErrorRetryCountMap[a.toString()],i=new f.SuccessHandler(this._offlineLogHelper,this._applicationContext),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,i.handle(t,n)];case 2:return s.sent(),this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackBatchManager.ProcessSuccessMultipleResponseItem.Success","ProcessSuccessMultipleResponseItem Completed")),e||t.associatedMainLog.operationType!==g.createOperation&&t.associatedMainLog.operationType!==g.updateOperation||((o=t.entityRecord.get_identifier()).set_rowVersion(R.parseResponseForRowVersion(r)),this._entityReferenceMap[o.get_key()]=o),[2,!0];case 3:throw u=s.sent(),u=T.convertToErrorStatus(u),this._tracer.error(E.addPrefix("OfflineUpSync.PlaybackBatchManager.ProcessSuccessMultipleResponseItem.Failure",u.message)),u;case 4:return[2]}}))}))},e.prototype._ProcessReturnedRowVersions=function(){return o(this,void 0,void 0,(function(){var e,t,r,n,a,i,o,l,d,p,f;return s(this,(function(s){switch(s.label){case 0:if(this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackBatchManager._ProcessReturnedRowVersions.Start","Process Returned Row Versions Started")),e=[],!Object.keys(this._entityReferenceMap).length)return this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackBatchManager._ProcessReturnedRowVersions.Success","Process Returned Row Versions succeeded")),[2,!0];for(t in this._entityReferenceMap)e.push(this._UpdateRowVersion(t));r=[],s.label=1;case 1:return s.trys.push([1,5,,6]),[4,Promise.all(e)];case 2:n=s.sent();try{for(a=u(n),i=a.next();!i.done;i=a.next())o=i.value,v.IsNullOrUndefined(o)||(l=o,r.push.apply(r,c(l)))}catch(e){p={error:e}}finally{try{i&&!i.done&&(f=a.return)&&f.call(a)}finally{if(p)throw p.error}}return r.length?[4,this._offlineLogHelper.performOperations(r,!0)]:[3,4];case 3:s.sent(),s.label=4;case 4:return this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackBatchManager._ProcessReturnedRowVersions.Success","Updating of Row Version Succeeded")),[2,!0];case 5:throw d=s.sent(),d=T.convertToErrorStatus(d),this._tracer.error(E.addPrefix("OfflineUpSync.PlaybackBatchManager._ProcessReturnedRowVersions.Fail",d.message)),d;case 6:return[2]}}))}))},e.prototype._UpdateRowVersion=function(e){var t,r;return o(this,void 0,void 0,(function(){var n,a,i,o,u;return s(this,(function(s){switch(s.label){case 0:if(this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackBatchManager._UpdateRowVersion.Start","Updating of Row Version started")),n=this._entityReferenceMap[e],v.IsNullOrUndefined(n)||v.IsNullOrUndefined(n.get_rowVersion()))return this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackBatchManager._UpdateRowVersion.Success","Updation of Row Version Succeeded")),[2,null];s.label=1;case 1:return s.trys.push([1,3,,4]),[4,null===(r=null===(t=this._applicationContext.DataLayerConfiguration.MetadataProvider)||void 0===t?void 0:t.retrieveEntity)||void 0===r?void 0:r.call(t,n.LogicalName)];case 2:return a=s.sent(),this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackBatchManager._UpdateRowVersion.Success","Updation of Row Version Succeeded")),(i={})[g.versionNumber]=n.get_rowVersion(),i[(null==a?void 0:a.PrimaryIdAttribute)||n.LogicalName+"id"]=n.get_identifier(),this._rowVersionMap[n.get_key()]=n.get_rowVersion(),o=new P.ODataUpdateRequest(n.LogicalName,n.get_identifier(),i),[2,[o]];case 3:throw u=s.sent(),u=T.convertToErrorStatus(u),this._tracer.error(E.addPrefix("OfflineUpSync.PlaybackBatchManager._UpdateRowVersion.Fail",u.message)),u;case 4:return[2]}}))}))},e.prototype._BuildUpsyncResponse=function(e){var t=new O.UpSyncResponse;return t.errorDetail=e.details,t.errorCode=e.errorCode,t.message=e.message,t.errorTime=e.date||new Date,t},e.prototype._ProcessActionDataListToDelete=function(){return o(this,void 0,void 0,(function(){var e,t,r,n,a,i;return s(this,(function(o){switch(o.label){case 0:this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackBatchManager._ProcessActionDataListToDelete","ProcessActionDataListToDelete Started"));try{for(e=u(this._actionDataList),t=e.next();!t.done;t=e.next())switch((r=t.value).commandType){case 0:this._ProcessCRUDItemForDelete(r);break;case m.CommandType.nonCrud:this._ProcessNonCRUDItemForDelete(r);break;case m.CommandType.transaction:this._AddOfflineLogToDelete(r.associatedMainLog)}}catch(e){a={error:e}}finally{try{t&&!t.done&&(i=e.return)&&i.call(e)}finally{if(a)throw a.error}}o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this._offlineLogHelper.clearOfflineLogs(this._sidToDelete,this._entityLogTables,this._commandId)];case 2:return o.sent(),this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackBatchManager._ProcessActionDataListToDelete.Success","ProcessActionDataListToDelete Completed")),[2,!0];case 3:throw n=o.sent(),n=T.convertToErrorStatus(n),this._tracer.error(E.addPrefix("OfflineUpSync.PlaybackBatchManager._ProcessActionDataListToDelete.Failure","ProcessActionDataListToDelete Failed")),n;case 4:return[2]}}))}))},e.prototype._ProcessCRUDItemForDelete=function(e){var t,r;if(this._AddOfflineLogToDelete(e.associatedMainLog),!v.IsNullOrUndefined(e.associatedActivityParties))try{for(var n=u(e.associatedActivityParties),a=n.next();!a.done;a=n.next()){var i=a.value;v.IsNullOrUndefined(i)||this._AddOfflineLogToDelete(i.associatedMainLog)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}},e.prototype._ProcessNonCRUDItemForDelete=function(e){var t,r;if(this._AddOfflineLogToDelete(e.associatedMainLog),!v.IsNullOrUndefined(e.associatedCommandMainLogs)){this._commandId=e.commandId;try{for(var n=u(e.associatedCommandMainLogs),a=n.next();!a.done;a=n.next()){var i=a.value;this._AddOfflineLogToDelete(i)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}}},e.prototype._AddOfflineLogToDelete=function(e){if(!v.IsNullOrUndefined(e)&&this._syncErrorSid.indexOf(e.SID)<0){this._sidToDelete.push(e.SID);var t=e.logTableID.toLowerCase()===g.norSyncUpSyncTransactionBeginLog.toLowerCase()||e.logTableID.toLowerCase()===g.norSyncUpSyncTransactionEndLog.toLowerCase();this._entityLogTables.indexOf(e.logTableID)<0&&!t&&this._entityLogTables.push(e.logTableID)}},e.prototype._IsSyncError=function(e){return!v.IsNullOrUndefined(e)&&!v.IsNullOrUndefined(e.associatedMainLog)&&E.getTableNameFromNorSyncMainLog(e.associatedMainLog)===g.syncErrorLogTable},e.prototype._ManageSyncError=function(e,t,r){var n=e.toString()in y.PlaybackManager.syncErrorRetryCountMap?y.PlaybackManager.syncErrorRetryCountMap[e.toString()]:this._syncErrorRetryLimit;n>0?(y.PlaybackManager.syncErrorRetryCountMap[e.toString()]=--n,t.error("Sync error upsync failed for sid "+e+". Number of retries left = "+n,r),this._syncErrorSid.push(e)):(t.error("Sync error upsync failed for sid "+e+". No more retries left. Sync error will be deleted from log table",r),delete y.PlaybackManager.syncErrorRetryCountMap[e.toString()])},e.prototype._ProcessFileOrImageTypeItem=function(e){return this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackBatchManager._ProcessFileOrImageTypeItem","_ProcessFileOrImageTypeItem Started")),this._actionDataList.push(e),this._executeCommand(e.commandType,[],!0)},e}();t.PlaybackBatchManager=I},"87in":function(e,t,r){"use strict";r.r(t),r.d(t,"columnDelimiter",(function(){return n})),r.d(t,"systemUser",(function(){return a})),r.d(t,"modifiedOn",(function(){return i})),r.d(t,"modifiedBy",(function(){return o})),r.d(t,"activityId",(function(){return s})),r.d(t,"activityTypeCode",(function(){return u})),r.d(t,"activityPartyId",(function(){return l})),r.d(t,"partyId",(function(){return c})),r.d(t,"versionNumber",(function(){return d})),r.d(t,"stateCode",(function(){return p})),r.d(t,"statusCode",(function(){return f})),r.d(t,"createdOn",(function(){return y})),r.d(t,"createdBy",(function(){return m})),r.d(t,"ownerId",(function(){return h})),r.d(t,"firstName",(function(){return g})),r.d(t,"lastName",(function(){return E})),r.d(t,"middleName",(function(){return b})),r.d(t,"fullName",(function(){return O})),r.d(t,"fullNameComponents",(function(){return v})),r.d(t,"id",(function(){return _})),r.d(t,"logicalName",(function(){return T})),r.d(t,"name",(function(){return S})),r.d(t,"objectId",(function(){return N})),r.d(t,"objectTypeCode",(function(){return C})),r.d(t,"value",(function(){return P})),r.d(t,"ownerParty",(function(){return R})),r.d(t,"isPartyDeleted",(function(){return w})),r.d(t,"partyObjectTypeCode",(function(){return M})),r.d(t,"addressUsed",(function(){return I})),r.d(t,"activityParty",(function(){return A})),r.d(t,"isRegularActivity",(function(){return D})),r.d(t,"participationMasks",(function(){return L})),r.d(t,"participationTypeValue",(function(){return U})),r.d(t,"participationTypeNames",(function(){return F})),r.d(t,"defaultFieldsForCreate",(function(){return x})),r.d(t,"stateAndStatusFields",(function(){return k})),r.d(t,"defaultFields",(function(){return j}));
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
const n="!",a="systemuser",i="modifiedon",o="modifiedby",s="activityid",u="activitytypecode",l="activitypartyid",c="partyid",d="versionnumber",p="statecode",f="statuscode",y="createdon",m="createdby",h="ownerid",g="firstname",E="lastname",b="middlename",O="fullname",v=[g,b,E],_="id",T="logicalname",S="name",N="objectid",C="objecttypecode",P="value",R="owner",w="ispartydeleted",M="partyobjecttypecode",I="addressused",A="activityparty",D="isregularactivity",L="participationtypemask",U={from:"1",to:"2",cc:"3",bcc:"4",requiredattendees:"5",optionalattendees:"6",organizer:"7",regarding:"8",owner:"9",resources:"10",customer:"11",partner:"12"},F={1:"from",2:"to",3:"cc",4:"bcc",5:"requiredattendees",6:"optionalattendees",7:"organizer",8:"regarding",9:"owner",10:"resources",11:"customer",12:"partner"},x=[y,m,h,i,o],k=[p,f],j=[i,o]},"8GlG":function(e,t,r){"use strict";r.r(t),r.d(t,"extractIndividualResponsesFromBatchResponse",(function(){return i})),r.d(t,"FetchLikeHeaders",(function(){return l}));var n=r("7l03"),a=r("1NvT");
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
function i(e){return e.text().then(t=>{const r=[];let i="";if(e.headers){const t=/boundary=(.*)/,r=Object(n.getHttpHeader)(e.headers,"Content-Type");if(r){const e=r.match(t);i=e?e[1]:""}}else i=t.substr(t.indexOf("batchresponse"),t.indexOf("\r\n")-2);const s=Object(a.b)(i,t);for(const e of s){const t=/^\s*Content-Type: .*boundary=(.*)\r?\n/gi.exec(e);if(t){const n=t[1],i=e.indexOf("--"+n),s=e.slice(i),u=Object(a.b)(n,s).map(o);r.push(...u)}else{const t=o(e);r.push(t)}}if(0===r.length){const n=u(e.status,e.statusText,e.headers,t);r.push(n)}return r})}function o(e){const t=-1!==e.indexOf("\r\n\r\n"),r=e.trim().split(t?"\r\n\r\n":"\n\n");let n=0,a=new l({}),i=null,o="",c="";if(r.length>0){let e=null;r.length>1&&(e=r[1].split(t?"\r\n":"\n"));let u=[];null!=e&&(u=e.slice(1),i=/(HTTP\/\d\.\d) (\d+) (.*)/gi.exec(e[0]));const d=r[0].split(t?"\r\n":"\n");if(null!=d)for(const e of d)0===e.toLowerCase().indexOf("content-id:")&&u.push(e);n=i&&i.length>=3?Number(i[2]):0,a=new l(u.reduce(s,{})),r.length>1&&(c=r[2]),null!=i&&i.length>2&&(o=i[3])}return u(n,o,a,c)}function s(e,t){const r=t.indexOf(":");if(r>=0){const n=t.substring(0,r),a=t.substring(r+1).trim();e[n]=a}return e}function u(e,t,r,n){return{status:e,ok:e>=200&&e<=299,statusText:t,headers:r,clone(){return Object.assign({},this)},json:()=>Promise.resolve(n?JSON.parse(n):null),text:()=>Promise.resolve(n)}}class l{constructor(e){this._headers=e}append(e,t){this._headers[e]=t}get(e){return this._headers[e]}has(e){return this._headers.hasOwnProperty(e)}delete(e){delete this._headers[e]}set(e,t){this._headers[e]=t}forEach(e){for(const t in this._headers)e(this._headers[t],t,this)}}},"8w73":function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.traversedPathAttribute=t.syncErrorErrorDetail=t.syncErrorErrorType=t.syncErrorErrorCode=t.syncErrorRequestData=t.syncErrorLogErrorTime=t.syncErrorLogActionData=t.syncErrorLogErrorMessage=t.syncErrorLogRegardingObjectTypeCode=t.syncErrorLogRegardingObjectidName=t.syncErrorLogRegardingObjectId=t.syncErrorLogAction=t.syncErrorLogEntityName=t.syncErrorLogTable=t.dataArgumentname=t.commandArgumentName=t.crudCommandActionDataArgumentName=t.sqLiteResultsTimeStampColumnName=t.sqLiteResultsOperationTypeColumnName=t.sqLiteResultsLogTableIDColumnName=t.sqLiteResultsDeviceIdColumnName=t.sqLiteResultsSidColumnName=t.lastSuccessfulSaveOnCrmKey=t.updateOperation=t.createOperation=t.offline=t.offlineLogPrefix=t.offlineLogTypeColumnName=t.norSyncTableIdColumnName=t.offlineLogSIdColumnName=t.norSyncSIdColumnName=t.norSyncMainLogTableName=t.norSyncUpSyncTransactionEndLog=t.norSyncUpSyncTransactionBeginLog=t.norSyncCommandOperationLog=t.norSyncCommandLog=t.norSyncBusinessProcessFlowInstanceLog=t.businessProcessFlowInstancePrimaryAttributeId=t.businessProcessFlowInstanceTableName=t.commandOperationTableName=t.commandTableName=t.commandOperationEntityNameColumnName=t.commandOperationOperationColumnName=t.commandOperationCommandIdColumnName=t.commandOperationIdColumnName=t.commandCreatedOnColumnName=t.commandActionDataColumnName=t.commandStatusColumnName=t.commandNameColumnName=t.commandIdColumnName=void 0,t.upsyncSkipTables=t.unwantedEntityLogAttribute=t.upsyncComponentName=t.CrmErrorCodes=t.UpsyncParameters=t.versionNumber=t.activityParty=t.syncErrorsFailureKey=t.modifiedOn=t.changeProcessAndStageCommandName=t.processIdAttribute=t.entityIdAttribute=t.entityLogicalNameAttribute=t.stageIdAttribute=void 0,t.commandIdColumnName="Id",t.commandNameColumnName="Name",t.commandStatusColumnName="Status",t.commandActionDataColumnName="ActionData",t.commandCreatedOnColumnName="CreatedOn",t.commandOperationIdColumnName="Id",t.commandOperationCommandIdColumnName="CommandId",t.commandOperationOperationColumnName="Operation",t.commandOperationEntityNameColumnName="EntityName",t.commandTableName="command",t.commandOperationTableName="commandoperation",t.businessProcessFlowInstanceTableName="businessprocessflowinstance",t.businessProcessFlowInstancePrimaryAttributeId="businessprocessflowinstanceid",t.norSyncBusinessProcessFlowInstanceLog="_NORSYNC_LOG_businessprocessflowinstance",t.norSyncCommandLog="_NORSYNC_LOG_Command",t.norSyncCommandOperationLog="_NORSYNC_LOG_commandoperation",t.norSyncUpSyncTransactionBeginLog="_NORSYNC_LOG__upsynctransaction_begin",t.norSyncUpSyncTransactionEndLog="_NORSYNC_LOG__upsynctransaction_end",t.norSyncMainLogTableName="_NORSYNC_MAIN_LOG_TABLE",t.norSyncSIdColumnName="NORSYNC_SID",t.offlineLogSIdColumnName="NORSYNC_LOG_SID",t.norSyncTableIdColumnName="NORSYNC_TABLE_ID",t.offlineLogTypeColumnName="NORSYNC_LOG_TYPE",t.offlineLogPrefix="_NORSYNC_LOG_",t.offline="norsync",t.createOperation=1,t.updateOperation=3,t.lastSuccessfulSaveOnCrmKey="lastsuccessfulsaveoncrm",t.sqLiteResultsSidColumnName="SID",t.sqLiteResultsDeviceIdColumnName="DEVICE_ID",t.sqLiteResultsLogTableIDColumnName="LOG_TABLE_ID",t.sqLiteResultsOperationTypeColumnName="OPERATION_TYPE",t.sqLiteResultsTimeStampColumnName="TIME_STAMP",t.crudCommandActionDataArgumentName="crudCommandActionData",t.commandArgumentName="commandName",t.dataArgumentname="data",t.syncErrorLogTable="_NORSYNC_LOG_syncerror",t.syncErrorLogEntityName="name",t.syncErrorLogAction="action",t.syncErrorLogRegardingObjectId="regardingobjectid",t.syncErrorLogRegardingObjectidName="regardingobjectidname",t.syncErrorLogRegardingObjectTypeCode="regardingobjecttypecode",t.syncErrorLogErrorMessage="errormessage",t.syncErrorLogActionData="actiondata",t.syncErrorLogErrorTime="errortime",t.syncErrorRequestData="requestdata",t.syncErrorErrorCode="errorcode",t.syncErrorErrorType="errortype",t.syncErrorErrorDetail="errordetail",t.traversedPathAttribute="traversedpath",t.stageIdAttribute="stageid",t.entityLogicalNameAttribute="entitylogicalname",t.entityIdAttribute="entityid",t.processIdAttribute="processid",t.changeProcessAndStageCommandName="ChangeProcessAndStage",t.modifiedOn="_MODIFIED_ON",t.syncErrorsFailureKey="SyncErrorFailureMap",t.activityParty="activityparty",t.versionNumber="versionnumber",t.UpsyncParameters={EntityName:"EntityName",RecordId:"RecordId",commandType:"CommandType",operationType:"OperationType",upsyncRequestId:"UpsyncRequestId",upsyncId:"UpsyncId",errorCode:"ErrorCode",errorMessage:"ErrorMessage",isCrudTransactionBatch:"IsCrudTransactionBatch",syncErrorCount:"SyncErrorCount",responseTime:"ResponseTime",clientRequestId:"Client-Request-Id"},t.CrmErrorCodes={PrivilegeDenied:-2147220960},t.upsyncComponentName="Upsync",t.unwantedEntityLogAttribute=[t.norSyncSIdColumnName,t.offlineLogSIdColumnName,t.norSyncTableIdColumnName,t.offlineLogTypeColumnName],t.upsyncSkipTables=[t.norSyncCommandOperationLog,t.norSyncBusinessProcessFlowInstanceLog]},"9YKP":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PlaybackResponse=void 0;var n=function(){function e(e,t,r){this._errorCount=0,this._status=e,this._errorCount=t,this._lastSuccessfulSaveOnCrm=r}return Object.defineProperty(e.prototype,"errorCount",{get:function(){return this._errorCount},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"status",{get:function(){return this._status},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastSuccessfulSaveOnCrm",{get:function(){return this._lastSuccessfulSaveOnCrm},enumerable:!1,configurable:!0}),e.prototype.get_errorCount=function(){return this._errorCount},e.prototype.get_lastSuccessfulSaveOnCrm=function(){return this._lastSuccessfulSaveOnCrm},e}();t.PlaybackResponse=n},"9byC":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addFilters=t.ParseXml=t.getAttributesMapFromFetch=t.getColumnSetFromFetch=t.setFetchXmlParameters=t.addContextFilter=t.createManyToManyContextFilter=t.createOneToManyContextFilter=t.removeOrderElements=t.createOrderElement=t.findLinkEntitySort=t.addSort=t.addChildCountAttribute=t.buildLinkedEntityNode=t.addLinkedEntity=t.addColumns=t.isFetchAll=t.getEntityFromFetch=t.getColumnNamesFromFetch=t.getNodeAttributeValueByName=t.parseFetchXmlFromString=t.compress=void 0;
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n=r("nf9M"),a=r("iLQe"),i=r("Zwof"),o=r("+Axb"),s=r("RVOy");function u(e){return(new DOMParser).parseFromString(e,"text/xml")}function l(e,t){if(!n.IsNullOrUndefined(e)&&!n.IsNullOrUndefined(e.attributes)){var r=e.attributes.getNamedItem(t);if(!n.IsNullOrUndefined(r))return null==r?void 0:r.nodeValue}return null}function c(e,t,r){var n=e.createAttribute(t);return n.value=r,n}function d(e,t,r){return l(e,r)===l(t,r)}function p(e){var t,r,a;if(n.IsNullOrUndefined(e)||null==e)return null;if(f(e))return null;for(var i=[],o=e.getElementsByTagName("attribute"),s=0;s<o.length;s++){var u=o[s],l=null===(t=u.attributes.getNamedItem("name"))||void 0===t?void 0:t.nodeValue;if("link-entity"!==(null===(r=u.parentNode)||void 0===r?void 0:r.nodeName)||n.IsNullOrUndefined(u.parentNode.attributes.getNamedItem("alias")))i[s]=l;else{var c=null===(a=u.parentNode.attributes.getNamedItem("alias"))||void 0===a?void 0:a.nodeValue;i[s]=c+"."+l}}return i}function f(e){return!!e&&e.getElementsByTagName("all-attributes").length>0}function y(e,t,r){for(var n,a,i=e.getElementsByTagName("link-entity"),o=0;o<i.length;o++){var s=i[o];if(s.attributes.getNamedItem("alias")&&(null===(n=s.attributes.getNamedItem("alias"))||void 0===n?void 0:n.nodeValue)===t)for(var u=s.childNodes,l=0;l<u.length;l++){var c=u[l];if("attribute"===c.nodeName&&(null===(a=c.attributes.getNamedItem("name"))||void 0===a?void 0:a.nodeValue)===r)return s}}return null}function m(e,t,r){var n=e.createElement("order");return n.attributes.setNamedItem(c(e,"attribute",t)),n.attributes.setNamedItem(c(e,"descending",r.toString())),n}function h(e,t,r,n){return'<link-entity name="'+e+'" from="'+t+'" to="'+r+'" alias="bb">\n\t<filter type="and">\n\t\t<condition attribute="'+(n||t)+'" operator="eq" uitype="'+e+'" />\n\t</filter>\n\t</link-entity>'}t.compress=function(e){return e.replace(/[\r\n\t]/g,"").replace(/ \/>/g,"/>")},t.parseFetchXmlFromString=u,t.getNodeAttributeValueByName=l,t.getAttributesMapFromFetch=function(e){var t,r,a=o.parseXmlDocument(e);if(!a)return{};for(var i=a.getElementsByTagName("entity")[0].getAttribute("name"),u=((t={})[i]=[],t),l=a.getElementsByTagName("attribute"),c=0;c<l.length;c++){var d=l[c],p=null===(r=d.attributes.getNamedItem("name"))||void 0===r?void 0:r.nodeValue;if(d&&d.parentNode&&"link-entity"===d.parentNode.nodeName&&!n.IsNullOrUndefined(d.parentNode.getAttribute("name"))){var f=d.parentNode.getAttribute("name"),y=d.getAttribute("name");f&&y&&s.addAttributes(u,f,[y])}else i&&s.addAttributes(u,i,[p])}return u},t.getColumnNamesFromFetch=p,t.getEntityFromFetch=function(e){var t=e.getElementsByTagName("entity");return n.IsNullOrUndefined(t)||n.IsNullOrUndefined(t[0])?null:t[0].getAttribute("name")},t.isFetchAll=f,t.addColumns=function(e,t){if(!n.IsNullOrUndefined(t)&&t.length&&!n.IsNullOrUndefined(e)){var r=p(e),a=e.getElementsByTagName("entity");if(a&&a[0])for(var i=a[0].firstChild,o=0;o<t.length;o++)if(-1===(null==r?void 0:r.indexOf(t[o]))){var s=e.createElement("attribute");s.attributes.setNamedItem(c(e,"name",t[o])),a[0].insertBefore(s,i)}}},t.buildLinkedEntityNode=function(e,t){var r='<link-entity name="'+e.name+'" from="'+e.from+'" to="'+e.to+'"';if(r+=e.linkType?' link-type="'+e.linkType+'"':"",r+=e.alias?' alias="'+e.alias+'"':"",0===t.length)return r+=" />";r+=">";for(var n=0;n<t.length;n++)r+='<attribute name="'+t[n]+'" />';return r+="</link-entity>"},t.addLinkedEntity=function(e,t){if(!n.IsNullOrUndefinedOrEmptyString(t)){var r=e.getElementsByTagName("entity")[0],a=!1,i=u(t),o=e.getElementsByTagName("link-entity");if(!n.IsNullOrUndefined(o))for(var s=["alias","name","from","to","link-type"],l=function(e){if(s.every((function(t){return d(o[e],i.documentElement,t)}))){for(var t=0;t<i.documentElement.childNodes.length;t++)o[e].appendChild(i.documentElement.childNodes[t].cloneNode());a=!0}},c=0;c<o.length;c++)l(c);a||n.IsNullOrUndefined(r)||r.appendChild(i.documentElement)}},t.addChildCountAttribute=function(e,t){var r=e.createElement("attribute");r.attributes.setNamedItem(c(e,"name",t)),r.attributes.setNamedItem(c(e,"rowaggregate","CountChildren")),r.attributes.setNamedItem(c(e,"alias","HierarchyDataChildCount6dcd9e4c001441b09237d51a34853d55")),e.getElementsByTagName("entity")[0].appendChild(r)},t.addFilters=function(e,t){if(!e)throw new Error("Invalid fetch xml document is passed");var r=o.parseXmlDocument(t),n=e.getElementsByTagName("entity")[0];r&&n.appendChild(r.firstChild)},t.addSort=function(e,t,r){var n;if(-1===t.indexOf("."))n=e.getElementsByTagName("entity")[0];else{var a=t.split(".");if(2===a.length)n=y(e,a[0],t=a[1])}if(n){for(var i=n.getElementsByTagName("order"),o=m(e,t,r),s=!1,u=0;u<i.length;u++)if(d(i[u],o,"attribute")){s=!0,i[u].setAttribute("descending",r?"true":"false");break}s||n.appendChild(o)}},t.findLinkEntitySort=y,t.createOrderElement=m,t.removeOrderElements=function(e){for(var t,r=e.getElementsByTagName("order");r.length;){var n=r[0];null===(t=n.parentNode)||void 0===t||t.removeChild(n)}},t.createOneToManyContextFilter=h,t.createManyToManyContextFilter=function(e,t,r,n,a,i){return'<link-entity name="'+e+'" intersect="true" visible="false" to="'+t+'" from="'+i+'">\n\t'+h(n,a,r)+"\n</link-entity>"},t.addContextFilter=function(e,t,r){if(!n.IsNullOrUndefinedOrEmptyString(r)&&!n.IsNullOrUndefinedOrEmptyString(t)){var a=e.getElementsByTagName("entity")[0],i=u(t),o=i.getElementsByTagName("condition")[0];n.IsNullOrUndefined(o)||o.attributes.setNamedItem(c(i,"value",r)),n.IsNullOrUndefined(a)||a.appendChild(i.firstChild)}},t.setFetchXmlParameters=function(e,t,r,a,i){if(e){if(e&&e.firstChild&&"fetch"!==e.firstChild.nodeName)return;n.IsNullOrUndefined(e.firstChild.attributes.getNamedItem("returntotalrecordcount"))&&e.firstChild.attributes.setNamedItem(c(e,"returntotalrecordcount",a.toString())),e.firstChild.attributes.setNamedItem(c(e,"page",r.toString())),e.firstChild.attributes.setNamedItem(c(e,"count",t.toString())),e.firstChild.attributes.setNamedItem(c(e,"no-lock",i.toString()))}},t.getColumnSetFromFetch=function(e){if(f(e))return a.AllColumns.get_instance();var t=o.create(e),r=[],n=null==t?void 0:t.selectNodes("/fetch/entity/attribute");if(n&&n.get_count())for(var s=0;s<n.get_count();s++){var u=n.get_item(s);u&&r.push(u.getAttribute("name"))}return new i.LegacyColumnSet(r)},t.ParseXml=function(e){if(window.hasOwnProperty("DOMParser"))return(new DOMParser).parseFromString(e,"text/xml");if(window.hasOwnProperty("ActiveXObject")){var t=new window.ActiveXObject("Microsoft.XMLDOM");return t.async=!1,t.loadXML(e),t}return null}},AlX3:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.BatchRequestForLongFetchXml=t.ModernDataLayerDev=t.OfflineByDefault=t.MDLBrowserOfflineEnabledForTest=t.BrowserOfflineEnabledForTest=t.GCMOptimizationByEntityMetadataReduction=t.IsGetClientMetadataExEnabled=void 0,t.IsGetClientMetadataExEnabled="IsGetClientMetadataExEnabled",t.GCMOptimizationByEntityMetadataReduction="GCMOptimizationByEntityMetadataReduction",t.BrowserOfflineEnabledForTest="BrowserOfflineEnabledForTest",t.MDLBrowserOfflineEnabledForTest="MDLBrowserOfflineEnabledForTest",t.OfflineByDefault="OfflineByDefault",t.ModernDataLayerDev="ModernDataLayerDev",t.BatchRequestForLongFetchXml="BatchRequestForLongFetchXml"},B5SO:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.getIsCodeCacheReady=t.getIsCacheModeEnabled=void 0;var n=r("zrAn"),a=r("xKvi");t.getIsCacheModeEnabled=function(e){var t;return!!(null===(t=e.cache)||void 0===t?void 0:t.isCacheEnabled)},t.getIsCodeCacheReady=function(e){var t;return!!n.isBrowserOfflineEnabled(e)||(null===(t=e.cache)||void 0===t?void 0:t.codeCacheState)===a.CodeCacheState.Ready}},D7ZV:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},a=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,a,i=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)o.push(n.value)}catch(e){a={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(a)throw a.error}}return o},i=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(a(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0}),t.getAttributeBindForOData=t.encodeURIComponentForOData=t.getEnumValueMetadata=t.serializeEntityType=t.transformToODataValue=t.buildEntityPayload=t.OutputFormat=t.ODataPrimitives=void 0;var o,s=r("yNq8"),u=r("fnSt"),l=r("Ln9p"),c=r("x0cL"),d=r("nf9M"),p=r("k1iK"),f=r("cj/A"),y=r("LTKH"),m=r("EHm6"),h=r("UxT/");function g(e){var t=encodeURIComponent(e);if(-1!==t.indexOf("'")){return t.replace(/\'/g,"''")}return t}function E(e,t){var r=h.getActivityPartyNavigationPropertyRelationship(e,t);if(r&&r.ReferencedEntityNavigationPropertyName)return r.ReferencedEntityNavigationPropertyName}function b(e,t,r,n,a){var i,m,g,b;void 0===a&&(a=o.Server);var _=n.getValue(r);if(!e||!t||!r||void 0===_||a===o.Client&&null===_)return{};var T=null,S={},N=n.get_fieldTypes(),C=null;if(N[r]===s.AttributeType.AliasedValue){var P=_;T=P.get_attributeType(),S[r+"@OData.Community.Display.V1.AttributeName"]=P.get_attributeLogicalName(),C=y.getAttributeDescriptor(e,P.get_entityLogicalName(),P.get_attributeLogicalName()),_=P.get_value()}else{if(!(C=y.getAttributeDescriptor(e,t,r)))return{};T=C.Type}switch(T){case s.AttributeType.MultiSelectPickList:if(d.IsNullOrUndefined(_))return{};var R=_.length>0?Array.isArray(_)?_.join(","):_:null;if(R&&a===o.Client){var w=C.OptionSet?null==C?void 0:C.OptionSet.length:0;S[p.getFormattedValueAnnotation(r)]=_.map((function(e){for(var t,r,n,a,i=0;i<w;i++)if(e===(null===(r=null===(t=null==C?void 0:C.OptionSet)||void 0===t?void 0:t[i])||void 0===r?void 0:r.Value))return null===(a=null===(n=null==C?void 0:C.OptionSet)||void 0===n?void 0:n[i])||void 0===a?void 0:a.Label;return""})).join(";")}return S[r]=R,S;case s.AttributeType.PartyList:if(d.IsNullOrUndefined(_))return{};var M=_.get_entities(),I=E(e,t);if(!I)return{};var A=f.getParticipationTypeMask(t,r),D=M.map((function(t){var r=t.getValue("partyid"),n=t.getValue("activitypartyid"),a=n?n.toString():null,i=c.EntityReference.fromLegacyEntityReference(r);return v(e,A,i,a)}));return S[I]=D,S;case s.AttributeType.Boolean:if(d.IsNullOrUndefined(_))return{};var L=_.get_ValueString();return a===o.Client&&(S[p.getFormattedValueAnnotation(r)]=_.get_Label()),S[r]="0"===L||"1"===L?"1"===L:null,S;case s.AttributeType.PickList:case s.AttributeType.State:case s.AttributeType.Status:return d.IsNullOrUndefined(_)?{}:(a===o.Client&&(S[p.getFormattedValueAnnotation(r)]=_.get_Label()),S[r]=_.getValue("value"),S);case s.AttributeType.Customer:case s.AttributeType.Lookup:case s.AttributeType.Owner:var U=p.getLookupPropertyName(r);if(d.IsNullOrUndefined(_))return(i={})[U]=null,i;var F=_,x=h.getEntitySetName(e,F.LogicalName),k=null===(g=l.Guid.fromLegacyGuid(F.Id))||void 0===g?void 0:g.guid,j=null;if(T===s.AttributeType.Owner&&(j=h.getManyToOneRelationshipByReferencedEntity(e,t,"owner",r)),d.IsNullOrUndefined(j)&&(j=h.getManyToOneRelationshipByReferencedEntity(e,t,F.LogicalName,r)),T===s.AttributeType.Owner&&d.IsNullOrUndefined(j))return{};if(d.IsNullOrUndefined(j))throw new Error("Unable to find many-to-one relationship, entity: "+t+", referenced entity: "+F.LogicalName+", field: "+r);return a===o.Server?S[O(j.ReferencingEntityNavigationPropertyName)]="/"+x+"("+k+")":(S[p.getFormattedValueAnnotation(U)]=F.Name,S[p.getLookupLogicalNameAnnotation(U)]=F.LogicalName,S[U]=k),S;case s.AttributeType.UniqueIdentifier:return d.IsNullOrUndefined(_)?{}:(S[r]=null===(b=l.Guid.fromLegacyGuid(_))||void 0===b?void 0:b.guid,S);case s.AttributeType.Date:case s.AttributeType.DateTime:if(d.IsNullOrUndefined(_))return(m={})[r]=null,m;if(C.Behavior===u.DateTimeFieldBehavior.DateOnly&&"function"==typeof _.toISOString){var q=_.toISOString().match(/(\d{4}-\d{2}-\d{2})T\d{2}\:\d{2}\:\d{2}\.\d{3}[+-Z]/i);q[1]&&(a===o.Client&&(S[p.getFormattedValueAnnotation(r)]=n.getFormattedValue(r)),S[r]=q[1])}else a===o.Client?(S[p.getFormattedValueAnnotation(r)]=n.getFormattedValue(r),S[r]=_.toISOString().replace(/.\d{3}Z/,"Z")):S[r]=_;return S;case s.AttributeType.Money:case s.AttributeType.Decimal:case s.AttributeType.Double:case s.AttributeType.Integer:case s.AttributeType.BigInt:if(a===o.Client){if(d.IsNullOrUndefined(_))return{};S[p.getFormattedValueAnnotation(r)]=n.getNumericFormattedValue(r)}return S[r]=_,S;default:return S[r]=_,S}}function O(e){return e+"@odata.bind"}function v(e,t,r,n){var a,i=r.id.guid,o=r.etn;if("unresolvedaddress"===o){var s={addressused:r.name,participationtypemask:t};return d.IsNullOrUndefined(n)||(s.activitypartyid=n),s}var u=h.getEntitySetName(e,o),l=h.getActivityPartyNavigationPropertyRelationship(e,o);if(d.IsNullOrUndefined(l))throw new Error("Unable to find one-to-many relationship, entity: "+o+", referencing entity: activityparty");var c=((a={})[l.ReferencingEntityNavigationPropertyName+"@odata.bind"]="/"+u+"("+i+")",a.participationtypemask=t,a);return d.IsNullOrUndefined(n)||(c.activitypartyid=n),c}t.ODataPrimitives=["Edm.Boolean","Edm.String","Edm.Byte","Edm.Decimal","Edm.Double","Edm.Int16","Edm.Int32","Edm.Int64","Edm.SByte","Edm.Single","Edm.Date","Edm.Guid","Edm.DateTimeOffset","Edm.Duration","Edm.Stream","Edm.Binary","Edm.TimeOfDay","Edm.Geography","Edm.GeographyPoint","Edm.GeographyLineString","Edm.GeographyPolygon","Edm.GeographyMultiPoint","Edm.GeographyMultiLineString","Edm.GeographyMultiPolygon","Edm.GeographyCollection","Edm.Geometry","Edm.GeometryPoint","Edm.GeometryLineString","Edm.GeometryPolygon","Edm.GeometryMultiPoint","Edm.GeometryMultiLineString","Edm.GeometryMultiPolygon","Edm.GeometryCollection"],function(e){e[e.Server=0]="Server",e[e.Client=1]="Client"}(o||(o={})),t.OutputFormat=o,t.serializeEntityType=function(e,t,r,n){if(void 0===r&&(r=!1),void 0===n&&(n=!1),d.IsNullOrUndefined(t))return"null";if("object"==typeof t&&"entityType"in t&&"id"in t){var a=function(e,t,r){var n;if(r){var a=h.getEntityDescriptor(e,t.entityType);return(n={"@odata.type":"Microsoft.Dynamics.CRM."+t.entityType})[a.PrimaryKeyName]=l.Guid.fromExternalGuid(t.id).guid,n}return{"@odata.id":h.getEntitySetName(e,t.entityType)+"("+l.Guid.fromExternalGuid(t.id).guid+")"}}(e,t,r),i=JSON.stringify(a);return n?g(i):i}var o=JSON.stringify(t);return n?g(o):o},t.encodeURIComponentForOData=g,t.getEnumValueMetadata=function(e,t){return null!=e&&t&&t.enumProperties&&t.enumProperties.length?t.enumProperties.filter((function(t){return t.value===e}))[0]:null},t.buildEntityPayload=function e(t,r,a){var s,u,d,p;void 0===a&&(a=o.Server);var y=r.get_identifier(),g=y.LogicalName,O=[];if(r)if(a===o.Server){var _=r.get_changedFieldNames();_&&(O=_)}else O=r.get_fieldNames();var T=O.reduce((function(e,n){var i=b(t,g,n,r,a),o=Object.keys(e),s=Object.keys(i)[0];return o&&-1!==o.indexOf(s)&&i[s]&&i[s].length?(e[s]=e[s].concat(i[s]),e):Object.assign(i,e)}),{}),S=h.getEntityDescriptor(t,g);if(S&&S.IsActivity){var N=f.getPartyListAttributeNames(g),C=O.filter((function(e){return N.indexOf(e)>-1})),P=N.filter((function(e){return-1===C.indexOf(e)}));if(C.length&&P.length){var R=[],w=null===(p=m.createRecordSelector(c.EntityReference.fromLegacyEntityReference(y)))||void 0===p?void 0:p(t,g);if(w&&w.fields){try{for(var M=n(P),I=M.next();!I.done;I=M.next()){var A=I.value;if(A in w.fields){var D=w.fields[A].list.map((function(e){var r,n,a,i,o,s=(null===(r=e.fields)||void 0===r?void 0:r.participationtypemask)?Number((null===(n=e.fields)||void 0===n?void 0:n.participationtypemask).valueString):0,u=null===(a=e.fields)||void 0===a?void 0:a.partyid,d=null===(i=e.fields)||void 0===i?void 0:i.activitypartyid,p=d&&!l.Guid.isNullOrEmpty(d.id)?l.Guid.toString(d.id):void 0,f=u?u.reference:new c.EntityReference("unresolvedaddress",l.Guid.EMPTY,(null===(o=e.fields)||void 0===o?void 0:o.addressused).value);return v(t,s,f,p)}));R.push.apply(R,i(D))}}}catch(e){s={error:e}}finally{try{I&&!I.done&&(u=M.return)&&u.call(M)}finally{if(s)throw s.error}}}var L=E(t,g);L&&(T[L]?(d=T[L]).push.apply(d,i(R)):0!==R.length&&(T[L]=R))}}var U=r.get_relatedEntities();return a===o.Client&&U&&U.get_entityCollections()&&U.get_entityCollections().forEach((function(r){var n=r.get_value().get_entities().map((function(r){return e(t,r,a)})),i=n&&1===n.length&&h.getManyToOneRelationshipByNavigationProperty(t,g,r.get_key().get_schemaName())?n[0]:n;T[r.get_key().get_schemaName()]=i})),T},t.transformToODataValue=b,t.getAttributeBindForOData=O},DDfC:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FilterExpression=void 0;var n=r("JOkt"),a=r("v7pd"),i=r("csAi"),o=r("nf9M"),s=function(){function e(e,t,r,n){this._FilterOperator=0,this._IsQuickFindFields=!1,this._set_filterOperator(e),this.set_filterExpressionId(t),this._set_filterExpressions([]),o.IsNullOrUndefined(r)?this._set_isQuickFindFields(!1):this._set_isQuickFindFields(r),o.IsNullOrUndefined(n)?this._set_hint(null):this._set_hint(n)}return e.prototype.get_filterExpressionId=function(){return this._FilterExpressionId},e.prototype.set_filterExpressionId=function(e){this._FilterExpressionId=e},e.prototype.get_filterOperator=function(){return this._FilterOperator},e.prototype._set_filterOperator=function(e){return this._FilterOperator=e,e},e.prototype.get_isQuickFindFields=function(){return this._IsQuickFindFields},e.prototype._set_isQuickFindFields=function(e){return this._IsQuickFindFields=e,e},e.prototype.get_hint=function(){return this._Hint},e.prototype._set_hint=function(e){this._Hint=e},e.prototype.get_conditions=function(){return this._Conditions},e.prototype._set_conditions=function(e){return this._Conditions=e,e},e.prototype.get_filterExpressions=function(){return this._FilterExpressions},e.prototype._set_filterExpressions=function(e){return this._FilterExpressions=e,e},e.prototype.addCondition=function(e,t,r,a,i){r=r,i=o.IsNullOrUndefined(i)?"":i;var s=new n.Condition(e,t,r);return s.set_entityName(a),s.set_conditionName(i),this.get_conditions()||this._set_conditions([]),this.get_conditions().push(s),this},e.prototype.addFilterExpression=function(e){return e?(this.get_filterExpressions()||this._set_filterExpressions([]),this.get_filterExpressions().push(e),this):this},e.prototype.clone=function(){var t=new e(this.get_filterOperator(),this.get_filterExpressionId());if(this.get_conditions()){t._set_conditions([]);for(var r=0;r<this.get_conditions().length;r++)t.get_conditions().push(this.get_conditions()[r].clone())}else t._set_conditions(null);if(this.get_filterExpressions()){t._set_filterExpressions([]);for(r=0;r<this.get_filterExpressions().length;r++)t.get_filterExpressions().push(this.get_filterExpressions()[r].clone())}else t._set_filterExpressions(null);return t},e.prototype.toFetchXml=function(){return e._CreateXmlFilter(this)},e._CreateXmlFilter=function(t){var r="";if(!t||!(t.get_filterExpressions()&&t.get_filterExpressions().length||t.get_conditions()&&t.get_conditions().length))return r;if(t.get_conditions()){t.get_conditions().length>0&&(r+='<filter type="'+a.LogicalOperator[t.get_filterOperator()].toLowerCase()+'"',t.get_isQuickFindFields()&&(r+=' isquickfindfields="1"'),r+=">",o.IsNullOrUndefinedOrEmptyString(t.get_hint())||(r+=' hint="'+t.get_hint().toLowerCase()+'"'));for(var n=0;n<t.get_conditions().length;n++){var s=t.get_conditions()[n];if(r+="<condition ",o.IsNullOrUndefinedOrEmptyString(s.get_entityName())||(r+='entityname="'+s.get_entityName()+'" '),s.get_value())if("string"==typeof s.get_value())r+='attribute="'+s.get_attributeName()+'" operator="'+s.get_operator()+'" value="'+i.xmlAttributeEncode(s.get_value())+'" />';else{var u=s.get_value();r+='attribute="'+s.get_attributeName()+'" operator="'+s.get_operator()+'">';for(var l=0;l<u.length;l++)r+="<value>"+i.xmlEncode(u[l])+"</value>";r+="</condition>"}else r+='attribute="'+s.get_attributeName()+'" operator="'+s.get_operator()+'"/>'}t.get_conditions().length>0&&(r+="</filter>")}else{t.get_filterExpressions().length>1&&(r+='<filter type="'+a.LogicalOperator[t.get_filterOperator()].toLowerCase()+'"',t.get_hint()&&(r+=' hint="'+t.get_hint().toLowerCase()+'"'),r+=">");for(n=0;n<t.get_filterExpressions().length;n++)r+=e._CreateXmlFilter(t.get_filterExpressions()[n]);t.get_filterExpressions().length>1&&(r+="</filter>")}return r},e}();t.FilterExpression=s},DiyU:function(e,t,r){"use strict";var n=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.QueryOptionsFormat=t.Expression=void 0;
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var a,i=r("uVVg"),o=r("v7pd"),s=r("DDfC"),u=r("Ln9p"),l=r("M2g1"),c=function(){function e(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];this._hint="",this._operator=e,this._terms=t}return Object.defineProperty(e.prototype,"operator",{get:function(){return this._operator},set:function(e){this._operator=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hint",{get:function(){return this._hint},set:function(e){this._hint=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"terms",{get:function(){return this._terms},set:function(e){this._terms=e},enumerable:!1,configurable:!0}),e._isSimpleCondition=function(e){return e.terms.every((function(e){return!i.isExpression(e)}))},e._toLegacyConditionParameters=function(e){var t,r,a,o="",s="";try{for(var u=n(e.terms),l=u.next();!l.done;l=u.next()){var c=l.value;i.isAttributeTerm(c)?o=c.attributeName:i.isValueTerm(c)?a=c.value:i.isEntityNameTerm(c)&&(s=c.entityName)}}catch(e){t={error:e}}finally{try{l&&!l.done&&(r=u.return)&&r.call(u)}finally{if(t)throw t.error}}return{attributeName:o,operator:e.operator,value:a,entityName:s}},e.toLegacyFilterExpression=function(t,r){var a,i,l="or"===t.operator?o.LogicalOperator.Or:o.LogicalOperator.And,c=u.Guid.newGuid().guid,d=new s.FilterExpression(l,c,null,r?null:t.hint);if(e._isSimpleCondition(t)){var p=e._toLegacyConditionParameters(t),f=p.attributeName,y=p.operator,m=p.value,h=p.entityName;d.addCondition(f,y,m,h)}else{var g=r;try{for(var E=n(t.terms),b=E.next();!b.done;b=E.next()){var O=b.value;d.addFilterExpression(e.toLegacyFilterExpression(O,g)),g=g||!!O.hint}}catch(e){a={error:e}}finally{try{b&&!b.done&&(i=E.return)&&i.call(E)}finally{if(a)throw a.error}}}return d},e.isSimpleCondition=function(e){return e.terms.every((function(e){return!i.isExpression(e)}))},e.getHintFromExpression=function(e,t){var r;void 0===t&&(t=a.Hints);var n="";if(!(null==e?void 0:e.terms)||0===e.terms.length)return"";if(this.isSimpleCondition(e))return this.getODataUriForSimpleCondition(e,t);if(1===e.terms.length){var i=null===(r=e.operator)||void 0===r?void 0:r.toLowerCase();switch(i){case l.LogicalOperatorString.and:case l.LogicalOperatorString.or:return this.getHintFromExpression(e.terms[0],t);case l.LogicalOperatorString.not:return n=""+this.getHintFromExpression(e.terms[0],t),this.isSimpleCondition(e.terms[0])||(n="("+n+")"),n;default:throw new Error("Invalid logical operator "+i+".")}}else{n=this.getHintFromExpression(e.terms[0],t),this.isSimpleCondition(e.terms[0])||(n="("+n+")");for(var o=1;o<e.terms.length;o++){var s=this.getHintFromExpression(e.terms[o],t);this.isSimpleCondition(e.terms[o])||(s="("+s+")"),n=n+" "+e.operator+" "+s}}return n},e.getODataUriForSimpleCondition=function(e,t){var r,n=e.terms.find((function(e){return i.isAttributeTerm(e)})),o=e.terms.find((function(e){return i.isValueTerm(e)}));if(t===a.Hints)return this.getHintsForSimpleCondition(e);switch(e.operator){case"like":r="Contains";break;case"in":r="In";break;case"equalsUserId":r="EqualUserId"}switch(e.operator){case"eq":case"ne":case"gt":case"ge":case"lt":case"le":var s="number"==typeof(null==o?void 0:o.value)?o.value:"'"+(null==o?void 0:o.value)+"'";return n.attributeName+" "+e.operator+" "+s;case"like":case"in":case"equalsUserId":var u=["PropertyName=@p1"],l=["&@p1='"+n.attributeName+"'"];if(o){var c=void 0;Array.isArray(o.value)?(u.push("PropertyValues=@p2"),c="&@p2=["+o.value.map((function(e){return"'"+e+"'"})).join(",")+"]"):(u.push("PropertyValue=@p2"),c="&@p2='"+o.value+"'"),l.push(c)}return"Microsoft.Dynamics.CRM."+r+"("+u.join(",")+")"+l.join("");default:throw Error("Unsupported expression operation type "+e.operator)}},e.getHintsForSimpleCondition=function(e){var t=e.terms.find((function(e){return i.isAttributeTerm(e)})),r=e.terms.find((function(e){return i.isValueTerm(e)}));return(null==r?void 0:r.value)?t.attributeName+" "+e.operator+" '"+r.value+"'":t.attributeName+" "+e.operator},e}();t.Expression=c,function(e){e[e.Hints=0]="Hints",e[e.ODataUri=1]="ODataUri"}(a=t.QueryOptionsFormat||(t.QueryOptionsFormat={}))},EHm6:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return a(t,e),t},o=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.FieldValueRetrievalBehavior=t.getFormattedFieldValue=t.getRelatedEntityRecordByNavigationProperty=t.getRelatedEntityRecordsByNavigationProperty=t.isEmptyField=t.getRelatedEntityLogicalNames=t.getAttributeNamesWithNoMetadata=t.getListPageSize=t.getLegacyValueForField=t.getListTotalRecordsCount=t.getPagingCookie=t.getListInitializedState=t.getList=t.getListPageRecords=t.getFieldValue=t.getRecordInitState=t.getCurrentBusinessProcessFlowInstanceId=t.getCurrentBusinessProcessFlowId=t.createRecordSelector=t.getListPageRecordIds=t.getEntityRecordById=t.getEntityRecords=t.getData=void 0;var s,u=r("yNq8"),l=i(r("6QHb")),c=r("Ln9p"),d=r("juXS"),p=r("x0cL"),f=r("KkiZ"),y=r("nf9M"),m=r("UWtl"),h=r("WHxM"),g=r("s+yA"),E=r("WIpw"),b=r("II95"),O=r("LTKH"),v=r("UxT/");function _(e){return e?e.data:null}function T(e,t){var r=_(e);return r&&r.entities&&r.entities.hasOwnProperty(t)?r.entities[t]:null}function S(e,t,r){var n=T(e,t);return n?n[r]:null}function N(e,t,r){var n=S(e,t.etn,c.Guid.toString(t.id));if(n&&n.fields&&n.fields.hasOwnProperty(r)){var a=n.fields[r];if(a)return a.list}return null}function C(e){return function(t){var r=T(t,e.etn);if(r){var n=c.Guid.toString(e.id);if(r.hasOwnProperty(n))return r[n]}return null}}function P(e,t){var r=_(e);return r&&r.lists&&r.lists.hasOwnProperty(t)?r.lists[t]:null}function R(e,t,r,n){var a=P(e,t);if(a){if(n)return a.records;if(a.pages&&r&&r>0){var i=a.pages[r];if(i&&a.records)return a.records.slice(i.startIndex,i.startIndex+a.pageSize)}}return null}function w(e,t,r,n){var a,i,s,u={initialized:t.initialized,identifier:r,fields:{}};if(t&&u&&u.fields)if(n&&n.length)try{for(var l=o(n),c=l.next();!c.done;c=l.next()){var d=c.value;u.fields[d]=null===(s=t.fields)||void 0===s?void 0:s[d]}}catch(e){a={error:e}}finally{try{c&&!c.done&&(i=l.return)&&i.call(l)}finally{if(a)throw a.error}}else u.fields=t.fields;return u}function M(e,t){return void 0===t&&(t=s.LatestEntered),t===s.LastValid?e.value:e.validationResult.userInput||e.value}function I(e,t,r,n){var a,i;switch(void 0===n&&(n=s.LatestEntered),r){case u.AttributeType.PartyList:var l=[],f=t;try{for(var y=o(f.list),g=y.next();!g.done;g=y.next()){var v=g.value,_={},T={},S={},N={};for(var C in v.fields){var P=v.fields[C],R=A(e,"activityparty",C,P);if(R){_[C]=R;var w=O.getAttributeDescriptor(e,"activityparty",C);if(w&&(T[C]=w.Type,b.isPlainValue(P))){var I=P;S[C]=I.formatted||null,N[C]=I.formatted||null}}}var D=new h.EntityRecord(p.EntityReference.toLegacyEntityReference(v.identifier),_,T,S,N,new E.RelatedEntityCollection([]));l.push(D)}}catch(e){a={error:e}}finally{try{g&&!g.done&&(i=y.return)&&i.call(y)}finally{if(a)throw a.error}}return new m.EntityCollection(l,!1,l.length,!1,null,null);case u.AttributeType.Date:case u.AttributeType.DateTime:var L=M(t,n),U=Date.parse(L);return isNaN(U)?L:new Date(U);case u.AttributeType.PickList:case u.AttributeType.Boolean:case u.AttributeType.State:case u.AttributeType.Status:var F=t,x=F?F.label:null,k=F?parseInt(F.valueString,10):null;return k&&isNaN(k)&&(k=null),new d.OptionMetadata(x,k,-1,-1,[],null,null);case u.AttributeType.Customer:case u.AttributeType.Lookup:case u.AttributeType.Owner:var j=t;return j&&j.reference?p.EntityReference.toLegacyEntityReference(j.reference):null;case u.AttributeType.UniqueIdentifier:var q=t;return c.Guid.toLegacyGuid(q.id);case u.AttributeType.MultiSelectPickList:var B=M(t,n);return-1===B||null===B||!Array.isArray(B)&&"string"!=typeof B?null:Array.isArray(B)?B:B.split(",").map((function(e){return parseInt(e,10)}));case u.AttributeType.Decimal:case u.AttributeType.Double:case u.AttributeType.Integer:case u.AttributeType.String:case u.AttributeType.BigInt:case u.AttributeType.Unknown:case u.AttributeType.Memo:case u.AttributeType.Money:case u.AttributeType.CalendarRules:case u.AttributeType.Virtual:default:return M(t,n)}}function A(e,t,r,n,a){if(void 0===a&&(a=s.LatestEntered),b.isAliasedValue(n)){var i=new g.LegacyAliasedValue(n.entityLogicalName,n.attributeLogicalName,u.AttributeType.AliasedValue);return n.innerType===u.AttributeType.Integer?i.set_value(I(e,n.innerValue,u.AttributeType.Integer,a)):i.set_value(A(e,n.entityLogicalName,n.attributeLogicalName,n.innerValue)),i}var o=O.getAttributeDescriptor(e,t,r);if(!o||!o.Type)return null;var l=o.Type;return n?I(e,n,l,a):l===u.AttributeType.PartyList?new m.EntityCollection([],!1,0,!1):null}t.getData=_,t.getEntityRecords=T,t.getEntityRecordById=S,t.getRelatedEntityRecordsByNavigationProperty=N,t.getRelatedEntityRecordByNavigationProperty=function(e,t,r,n){var a,i,s=N(e,t,r);if(s){var u=v.getRelationshipTypeByNavigationProperty(e,t.etn,r);if(u===l.RelationshipType.OneToManyRelationship)try{for(var c=o(s),d=c.next();!d.done;d=c.next()){var p=d.value;if(p&&p.fields){var f=p.fields.hasOwnProperty("regardingfieldname")?p.fields.regardingfieldname:null;if(n===b.getFormattedValueFromField(f))return p}}}catch(e){a={error:e}}finally{try{d&&!d.done&&(i=c.return)&&i.call(c)}finally{if(a)throw a.error}}else if(u===l.RelationshipType.ManyToOneRelationship)return s[0]}return null},t.createRecordSelector=C,t.getRecordInitState=function(e,t){var r;if(C(t)){var n=null===(r=C(t))||void 0===r?void 0:r(e,t.etn);return n&&n.hasOwnProperty("initialized")?n.initialized:null}return null},t.getFieldValue=function(e,t,r){var n;if(t&&C(t)){var a=null===(n=C(t))||void 0===n?void 0:n(e,t.etn);if(a&&a.fields){if(a.fields.hasOwnProperty(r))return a.fields[r];if("productidname"===r&&-1!==["opportunityproduct","quotedetail","salesorderdetail","invoicedetail"].indexOf(t.etn)){var i=a.fields.productid;if(i){var o=i.reference;if(o&&o.hasOwnProperty("name"))return o.name}}}}return null},t.getFormattedFieldValue=function(e,t,r){return{value:e,timestamp:t||new Date,validationResult:r||{isValueValid:!0,errorMessage:null,errorId:null,userInput:""}}},t.getCurrentBusinessProcessFlowId=function(e,t){var r;if(C(t)){var n=null===(r=C(t))||void 0===r?void 0:r(e,t.etn);if(n&&n.businessProcessFlowId)return n.businessProcessFlowId}return null},t.getCurrentBusinessProcessFlowInstanceId=function(e,t){var r;if(C(t)){var n=null===(r=C(t))||void 0===r?void 0:r(e,t.etn);if(n&&n.businessProcessFlowInstanceId)return n.businessProcessFlowInstanceId}return null},t.getList=P,t.getListInitializedState=function(e,t){var r=P(e,t);return r?r.initialized:f.InitState.Uninitialized},t.getListPageRecordIds=R,t.getListPageRecords=function(e,t,r,n,a){var i,s,u=R(e,t,r,a),l=[];if(!u)return null;try{for(var c=o(u),d=c.next();!d.done;d=c.next()){var p=d.value,f=C(p);if(f){var y=f(e,p.etn);if(y){var m=w(0,y,p,n);l.push(m)}}}}catch(e){i={error:e}}finally{try{d&&!d.done&&(s=c.return)&&s.call(c)}finally{if(i)throw i.error}}return l},t.getListTotalRecordsCount=function(e,t){var r=P(e,t);return r?r.totalRecordCount:null},t.getPagingCookie=function(e,t,r){var n=P(e,t);return n&&n.pages&&n.pages[r]&&n.pages[r].pagingCookie?n.pages[r].pagingCookie:null},function(e){e[e.LatestEntered=0]="LatestEntered",e[e.LastValid=1]="LastValid"}(s||(s={})),t.FieldValueRetrievalBehavior=s,t.isEmptyField=function e(t,r,n,a,i){if(void 0===i&&(i=s.LatestEntered),!t)return!0;if(b.isAliasedValue(t))return e(t.innerValue,r,n,a,i);var o=O.getAttributeDescriptor(r,n,a);if(!o||!o.Type)return function e(t){return b.isPicklistValue(t)?!t.valueString:b.isGuidValue(t)?c.Guid.isNullOrEmpty(t.id):b.isReferenceValue(t)?!t.reference:b.isPlainValue(t)?!t.value:b.isAliasedValue(t)?e(t.innerValue):!!b.isPartylistValue(t)&&!t.list}(t);var l=!1;switch(o.Type){case u.AttributeType.PartyList:var d=t;d&&d.list&&d.list.length>0&&(l=!0);break;case u.AttributeType.Boolean:var p=t;!p||"1"!==p.valueString&&"0"!==p.valueString||(l=!0);break;case u.AttributeType.PickList:case u.AttributeType.State:case u.AttributeType.Status:var f=t;f&&"-1"!==f.valueString&&!y.IsNullOrUndefinedOrEmptyString(f.valueString)&&(l=!0);break;case u.AttributeType.MultiSelectPickList:var m=M(t,i);-1===m||y.IsNullOrUndefinedOrEmptyString(m)||(l=!0);break;case u.AttributeType.Customer:case u.AttributeType.Lookup:case u.AttributeType.Owner:var h=t;h&&!y.IsNullOrUndefinedOrEmptyString(h.reference)&&(l=!0);break;case u.AttributeType.UniqueIdentifier:var g=t;g&&!y.IsNullOrUndefinedOrEmptyString(g.id)&&(l=!0);break;case u.AttributeType.Date:case u.AttributeType.DateTime:case u.AttributeType.Decimal:case u.AttributeType.Double:case u.AttributeType.Integer:case u.AttributeType.String:case u.AttributeType.BigInt:case u.AttributeType.Unknown:case u.AttributeType.Memo:case u.AttributeType.Money:case u.AttributeType.CalendarRules:case u.AttributeType.Virtual:default:var E=M(t,i);y.IsNullOrUndefinedOrEmptyString(E)||(l=!0)}return!l},t.getLegacyValueForField=A,t.getListPageSize=function(e,t){var r=P(e,t);return r&&r.pageSize?r.pageSize:null},t.getAttributeNamesWithNoMetadata=function(e,t){var r=t.get_identifier(),n=O.getAttributesForEntity(e,r.LogicalName);if(n){var a=Object.keys(n);return t.get_fieldNames().filter((function(e){return a&&-1===a.indexOf(e)}))}return t.get_fieldNames()},t.getRelatedEntityLogicalNames=function(e,t){var r,n,a,i,s=t.get_identifier(),l=t.get_fieldNames(),c=O.getAttributesForEntity(e,s.LogicalName),d=new Set;try{for(var p=o(l),f=p.next();!f.done;f=p.next()){var y=f.value,m=c[y];if(!m)throw new Error("The metadata for "+y+" attribute is missing in the state tree.");if(m.Type===u.AttributeType.PartyList){var h=t.getValue(y).get_entities();try{for(var g=(a=void 0,o(h)),E=g.next();!E.done;E=g.next()){var b=E.value;d.add(b.get_identifier().LogicalName)}}catch(e){a={error:e}}finally{try{E&&!E.done&&(i=g.return)&&i.call(g)}finally{if(a)throw a.error}}}if(m.Type===u.AttributeType.Lookup||m.Type===u.AttributeType.Customer||m.Type===u.AttributeType.Owner){var v=t.getValue(y);v&&v.LogicalName&&d.add(v.LogicalName)}}}catch(e){r={error:e}}finally{try{f&&!f.done&&(n=p.return)&&n.call(p)}finally{if(r)throw r.error}}return Array.from(d)}},ERDA:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.GetClientMetadataExRequest=void 0;var o=i(r("fzfk")),s=function(){function e(){}return e.prototype.getMetadata=function(){return{boundParameter:null,operationName:"GetClientMetadataEx",operationType:o.ODataOperationType.Function,parameterTypes:{ClientMetadataQuery:{typeName:"Microsoft.Dynamics.CRM.MetadataQuery",structuralProperty:o.ODataStructuralProperty.ComplexType}}}},e}();t.GetClientMetadataExRequest=s},EyO3:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DOMParserNodeListWrapper=void 0;var n=r("kgGf"),a=r("nf9M"),i=function(){function e(e){n.assert(!a.IsNullOrUndefined(e),"Node list obj should not be null"),this._list=e}return e.prototype.get_count=function(){return this._list.length},e.prototype.get_item=function(e){return this._list[e]},e}();t.DOMParserNodeListWrapper=i},FKn0:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return a(t,e),t},o=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.ErrorType=t.SyncError=t.createEntityRecord=void 0;
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var s,u=r("4oeN"),l=r("rW8f"),c=r("WHxM"),d=r("yNq8"),p=r("nf9M"),f=r("juXS"),y=r("WIpw"),m=r("+MPC"),h=i(r("8w73")),g=r("+hYO");t.createEntityRecord=function(e,r,n,a,i,E,b,O,v,_,T,S){var N,C,P=function(e){var t;switch(e=m.getNegativeErrorCodeFromErrorCode(e)){case g.CrmErrorCodes.ObjectDoesNotExist:t=s.recordNotFound;break;case g.CrmErrorCodes.duplicateRecordDetected:case g.CrmErrorCodes.duplicateRecord:t=s.recordAlreadyExists;break;case g.CrmErrorCodes.concurrencyVersionMismatch:case g.CrmErrorCodes.concurrencyVersionNotProvided:t=0;break;default:t=s.others}return t}(v),R=P!==s.recordNotFound&&"create"!==r.toLowerCase()?new l.LegacyEntityReference(e,n,a):null,w={},M={},I=new Array(0);I.push(h.syncErrorLogEntityName),w[h.syncErrorLogEntityName]=d.AttributeType.String,M[h.syncErrorLogEntityName]=e,I.push(h.syncErrorLogAction),w[h.syncErrorLogAction]=d.AttributeType.String,M[h.syncErrorLogAction]=r,p.IsNullOrUndefined(R)||(I.push(h.syncErrorLogRegardingObjectId),w[h.syncErrorLogRegardingObjectId]=d.AttributeType.Lookup,M[h.syncErrorLogRegardingObjectId]=R),I.push(h.syncErrorLogActionData),w[h.syncErrorLogActionData]=d.AttributeType.String,M[h.syncErrorLogActionData]=null==E?void 0:E.substring(0,9999),I.push(h.syncErrorLogErrorTime),w[h.syncErrorLogErrorTime]=d.AttributeType.DateTime,M[h.syncErrorLogErrorTime]=b||new Date,I.push(h.syncErrorRequestData),w[h.syncErrorRequestData]=d.AttributeType.String,M[h.syncErrorRequestData]=O,I.push(h.syncErrorErrorCode),w[h.syncErrorErrorCode]=d.AttributeType.String,M[h.syncErrorErrorCode]=null==v?void 0:v.toString();var A={};A.value=P,I.push(h.syncErrorErrorType),w[h.syncErrorErrorType]=d.AttributeType.PickList,M[h.syncErrorErrorType]=f.OptionMetadata.createFromObjectData(A),I.push(h.syncErrorLogErrorMessage),w[h.syncErrorLogErrorMessage]=d.AttributeType.String,I.push(h.syncErrorErrorDetail),w[h.syncErrorErrorDetail]=d.AttributeType.String;var D={};D[h.syncErrorLogErrorMessage]=i,D[h.syncErrorErrorDetail]=_;try{var L=function(e,t){for(var r in t){var n=e[r],a=t[r];!p.IsNullOrUndefined(n)&&!p.IsNullOrUndefined(a)&&n.MaxLength&&a.length>n.MaxLength&&(t[r]=a.substring(0,n.MaxLength))}return t}(T,D);for(var U in L)M[U]=L[U]}catch(e){M[h.syncErrorErrorDetail]="Empty Error details as RetreiveAttributeMetadata failed for UpSyncConstants.SyncErrorErrorDetail",M[h.syncErrorLogErrorMessage]="Empty Error message as RetreiveAttributeMetadata failed for UpSyncConstants.SyncErrorLogErrorMessage"}var F=S;p.IsNullOrUndefined(F)&&(F=new l.LegacyEntityReference(t.SyncError,u.LegacyGuid.newGuid()));var x=new c.EntityRecord(F,M,w,{},{},new y.RelatedEntityCollection(new Array(0))),k=x.get_fieldNames();try{for(var j=o(k),q=j.next();!q.done;q=j.next()){var B=q.value;x.markFieldChanged(B)}}catch(e){N={error:e}}finally{try{q&&!q.done&&(C=j.return)&&C.call(j)}finally{if(N)throw N.error}}return x},t.SyncError="syncerror",function(e){e[e.conflict=0]="conflict",e[e.recordNotFound=1]="recordNotFound",e[e.recordAlreadyExists=2]="recordAlreadyExists",e[e.others=3]="others"}(s=t.ErrorType||(t.ErrorType={}))},FedD:function(e,t,r){"use strict";r.d(t,"d",(function(){return c})),r.d(t,"e",(function(){return d})),r.d(t,"b",(function(){return f})),r.d(t,"a",(function(){return y})),r.d(t,"c",(function(){return b}));var n=r("hER9"),a=r("7l03"),i=r("fKp2"),o=r("yNq8"),s=r("YEmJ"),u=r("dJUv"),l=r("d61F");
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
function c(e){return!(!(e&&e.additionalHeaders&&e.additionalHeaders.Prefer)||-1===e.additionalHeaders.Prefer.indexOf(n.HEADER_VALUES.ANNOTATIONS)&&-1===e.additionalHeaders.Prefer.indexOf(n.HEADER_VALUES.ANNOTATIONS_NOQUOTES))}function d(e){return!!(e&&e.additionalHeaders&&e.additionalHeaders.Prefer&&-1!==e.additionalHeaders.Prefer.indexOf(n.HEADER_VALUES.PREFER_REPRESENTATION))}function p(e){return e>=200&&e<=299}function f(e,t,r,i){return function(e,t,r){if(!Object(a.isNullOrUndefined)(r)&&p(r)){if(Object(a.isNullOrUndefined)(e)||Object(a.isNullOrUndefined)(t))return;Object(a.isNullOrUndefined)(e.get(n.HEADER.CONTENT_LENGTH))&&e.set(n.HEADER.CONTENT_LENGTH,""+t.length)}}(r,i,e),{status:e,ok:p(e),statusText:n.HTTP_STATUS_TEXTS[e]||"",headers:r,url:t,clone(){return Object.assign({},this)},json:()=>Promise.resolve(i?JSON.parse(i):null),text:()=>Promise.resolve(i||"")}}function y(e,t,r,i){const o={},s={};s[n.STRING_CONSTANTS.ErrorCode]=r.code?r.code:n.ErrorCode.DataSourceOfflineErrorCode,s[n.STRING_CONSTANTS.Message]=r.message,s[n.STRING_CONSTANTS.StackTrace]=r.stack;const u={};u[n.STRING_CONSTANTS.ErrorCode]=r.code,u[n.STRING_CONSTANTS.Message]=r.message,u[n.STRING_CONSTANTS.StackTrace]=r.stack,s[n.STRING_CONSTANTS.InnerError]=u,o.error=s;const l=JSON.stringify(o);return Object(a.isNullOrUndefined)(i)&&(i=new Headers),f(e,t,i,l)}function m(e){return e+"@OData.Community.Display.V1.FormattedValue"}function h(e){if(-1!==e.search("!")){const t=e.split("!"),r=t[0],n=t[1];let a="";return a=-1!==r.search("\\.")?r:`_${r}_value`,"id"===n?a:"name"===n?m(a):"logicalname"===n?function(e){return e+"@Microsoft.Dynamics.CRM.lookuplogicalname"}(a):e}return e}function g(e,t){return e.find(e=>e.Value===t)}function E(e){const t=e.split(u.p.dot);return{alias:t[0],attributeName:t[1]}}async function b(e,t,r,n,c={},d=[],p){const f=e.TraceManager.getTracer(i.COMPONENT_NAMES.ResponseHandler),y=await Object(s.getAttributeTypes)(e,[],r),b=await Object(s.getAttributesMetadata)(e,r,[]),O={},v=[];!async function(e,t,r,n,a={}){var i;const l=[];for(const e in t){let t=n[e];if(e.indexOf(u.p.dot)>-1){const n=E(e);if(a[n.alias]){const e=a[n.alias],i=n.attributeName;t=(await Object(s.getAttributeTypes)(r,[],e))[i]}}switch(t){case o.AttributeType.Decimal:case o.AttributeType.Integer:case o.AttributeType.BigInt:case o.AttributeType.DateTime:case o.AttributeType.Double:case o.AttributeType.Money:l.push(e)}}await(null===(i=r.Formatter)||void 0===i?void 0:i.ensureMetadataPresent(e,l))}(r,t,e,y);let _=0;for(const i in t)if(i){const l=t[i];if(!Object(a.isNullOrUndefined)(l)||p){let p=y[i],S=i,N=b;if(i.indexOf(u.p.dot)>-1){const t=E(i);if(O[(T=i,T+"@OData.Community.Display.V1.AttributeName")]=t.attributeName,c[t.alias]){const r=c[t.alias];S=t.attributeName,N=await Object(s.getAttributesMetadata)(e,r,[]);p=(await Object(s.getAttributeTypes)(e,[],r))[S]}}if(-1!==i.search("!")){O[h(i)]=l}else{const s=m(i);switch(p){case o.AttributeType.Decimal:case o.AttributeType.Integer:case o.AttributeType.BigInt:case o.AttributeType.DateTime:case o.AttributeType.Double:case o.AttributeType.Money:O[i]=l;let u=null;p===o.AttributeType.Money&&t["transactioncurrencyid!id"]&&(u=t["transactioncurrencyid!id"]),n&&!Object(a.isNullOrUndefined)(l)&&(e.Formatter?O[s]=e.Formatter.getFormattedvalue(r,i,p,l,u):(f.error("Formatter is not available when returnAnnotationsFormat = true",d),O[s]=l));break;case o.AttributeType.MultiSelectPickList:if(O[i]=l,n&&!Object(a.isNullOrUndefined)(N[S])&&!Object(a.isNullOrUndefined)(N[S].OptionSet)){const e=N[S].OptionSet,t=[];if(!Object(a.isNullOrUndefined)(l)){l.split(",").forEach(r=>{const n=e.find(e=>String(e.Value)===r.trim());n&&n.Label&&t.push(n.Label)})}const r=t.length>0?t.join("; "):void 0;O[s]=r}break;case o.AttributeType.Status:case o.AttributeType.State:case o.AttributeType.Boolean:case o.AttributeType.PickList:if(Object(a.isNullOrUndefined)(l)||p!==o.AttributeType.Boolean?O[i]=l:O[i]=0!==l,!Object(a.isNullOrUndefined)(l)&&n&&!Object(a.isNullOrUndefined)(N[S])&&!Object(a.isNullOrUndefined)(N[S].OptionSet)){const e=N[S].OptionSet;if(!Object(a.isNullOrUndefined)(e)&&e.length>0){const t=g(e,l);Object(a.isNullOrUndefined)(t)||(O[s]=t.Label)}}break;case o.AttributeType.PartyList:O[i]=l;break;case o.AttributeType.String:case o.AttributeType.UniqueIdentifier:case o.AttributeType.Memo:O[i]=l;break;default:O[i]=l,_+=1,v.push({name:`key${_}, attributeType${_}`,value:`${i}, ${p}`})}}}}var T;return _>0&&f.warn(`Default case for formatter values for ${_} keys`,Object(l.b)(d,v)),O}},G5wq:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(a,i){function o(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((n=n.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var r,n,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(a=2&i[0]?n.return:i[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,i[1])).done)return a;switch(n=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,n=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],n=0}finally{r=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},o=this&&this.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]])}return r};Object.defineProperty(t,"__esModule",{value:!0}),t.toGCMResponse=t.addAnnotationsHeader=t.isSerializedRequestSupportedOffline=t.addAuthHeader=t.getClientRequestId=t.addRequestId=t.fromFunctionalOdataContract=t.fromODataContract=t.convertToBatchRequest=t.convertQueryStateToODataRequest=t.fromQueryState=void 0;var s=r("hER9"),u=r("Ln9p"),l=r("nf9M"),c=r("dozL"),d=r("pCZI"),p=r("UxT/"),f=r("Wc7r"),y=r("5sph"),m=r("f7K7"),h=r("+MPC"),g=r("DiyU"),E=r("zorh"),b=r("mA3E"),O=r("xnbY"),v=r("+95i"),_=r("Rv4a"),T=r("rx97"),S=r("GBvQ");function N(e){return{type:"odatabuilder.fromodatacontract.async",execute:function(t,r){var n=t.getState,o=t.dispatch;return a(this,void 0,void 0,(function(){var t,s;return i(this,(function(u){switch(u.label){case 0:return r.TraceManager.getTracer(c.MDL_COMPONENT_NAMES.ODataBuilder).info(I()+" Create a SerializedRequest from OData Contract."),t=n(),"ExecuteMultiple"!==e.getMetadata().operationName?[3,2]:[4,o((l=e,{type:"odatabuilder.fromexecutemutipleodatacontract.async",execute:function(e,t){var r=e.dispatch;return a(this,void 0,void 0,(function(){var e,n,o,s=this;return i(this,(function(u){switch(u.label){case 0:return e=l.requests,n=e.map((function(e){return a(s,void 0,void 0,(function(){var t=this;return i(this,(function(n){switch(n.label){case 0:return d.isODataContract(e)?[4,r(N(e))]:[3,2];case 1:return[2,n.sent()];case 2:return d.isChangeSet(e)?[4,Promise.all(e.map((function(e){return a(t,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return[4,r(N(e))];case 1:return[2,t.sent()]}}))}))})))]:[3,4];case 3:return[2,n.sent()];case 4:throw Error("value should be of type OData contract or Changeset")}}))}))})),[4,Promise.all(n)];case 1:return o=u.sent(),[2,y.buildBatchRequest(o,t)]}}))}))}}))];case 1:return s=u.sent(),[3,3];case 2:s=d.buildRequest(t,e),u.label=3;case 3:return[2,C(t,r,s)]}var l}))}))}}}function C(e,t,r,n){var o,c;return a(this,void 0,void 0,(function(){var a,d,p,y,m,h,g,E;return i(this,(function(i){switch(i.label){case 0:return l.IsNullOrUndefined(r.additionalHeaders)&&(r.additionalHeaders={}),[4,R(t,r)];case 1:return i.sent(),r&&r.additionalHeaders&&!r.additionalHeaders.hasOwnProperty(f.HEADER.CONTENT_TYPE)&&(r.additionalHeaders[f.HEADER.CONTENT_TYPE]=f.HEADER_VALUES.APPLICATION_JSON),w(r),a=b.getCurrentAppId(e),r&&r.additionalHeaders&&!r.additionalHeaders.hasOwnProperty(f.HEADER.APP_ID)&&(r.additionalHeaders[f.HEADER.APP_ID]=null!=a?a:""),d=b.getCurrentAppUniqueNameOrDefault(e),r&&r.additionalHeaders&&!r.additionalHeaders.hasOwnProperty(f.HEADER.APP_NAME)&&(r.additionalHeaders[f.HEADER.APP_NAME]=null!=d?d:""),t.DataLayerConfiguration.useConsistencyStrong&&(r.additionalHeaders[f.HEADER.CONSISTENCY]=f.HEADER_VALUES.STRONG),r&&r.additionalHeaders&&!r.additionalHeaders.hasOwnProperty(f.HEADER.CLIENT_REQUEST_ID)&&(p=s.UNKNOWN,p=n&&n.RequestId()?n.RequestId():u.Guid.newGuid().guid,r.additionalHeaders[f.HEADER.CLIENT_REQUEST_ID]=p),(E={})[f.HEADER.SESSION_ID]=t.EventManager.getCurrentSessionId(),E[f.HEADER.CORRELATION_ID]=t.EventManager.getActivityId(),y=E,Object.assign(r.additionalHeaders,y),m=null===(o=null==t?void 0:t.DataLayerConfiguration.AuthenticationProvider)||void 0===o?void 0:o.getUserObjectId(),r&&r.additionalHeaders&&!r.additionalHeaders.hasOwnProperty(f.HEADER.OBJECT_ID)&&(r.additionalHeaders[f.HEADER.OBJECT_ID]=null!=m?m:""),h=null===(c=null==t?void 0:t.DataLayerConfiguration.AuthenticationProvider)||void 0===c?void 0:c.getTenantId(),r&&r.additionalHeaders&&!r.additionalHeaders.hasOwnProperty(f.HEADER.OBJECT_ID)&&(r.additionalHeaders[f.HEADER.TENANT_ID]=null!=h?h:""),g=function(e,t){var r=O.getClientHost(e),n=O.getClientHostName(e),a=r===v.ClientHost.Browser?n:n+" - "+O.getClientHostSubtypeNameForTelemetry(e)+" - "+O.getClientHostVersionString(e);return"PowerApps-UCI/"+window.VERSION_NUMERIC_VALUE+" ("+a+"; AppName="+t+")"}(e,d),r&&r.additionalHeaders&&!r.additionalHeaders.hasOwnProperty(f.HEADER.MS_USER_AGENT)&&(r.additionalHeaders[f.HEADER.MS_USER_AGENT]=g),P(t,r),[2,r]}}))}))}function P(e,t){if(!l.IsNullOrUndefined(t.urlParameters)){var r=t.endpoint||f.WEB_API_URL_FRAGMENT,n=e.DataLayerConfiguration.baseUri.replace(/\/$/,"");t.urlParameters=""+n+r+t.urlParameters,t.urlParameters=t.urlParameters.replace(/\t|\r|\n/g,"")}return t}function R(e,t){var r,n;return a(this,void 0,void 0,(function(){var a,o;return i(this,(function(i){switch(i.label){case 0:return[4,null===(n=null===(r=e.DataLayerConfiguration)||void 0===r?void 0:r.AuthenticationProvider)||void 0===n?void 0:n.getAuthToken()];case 1:return(a=i.sent())&&t&&t.additionalHeaders&&(o="Bearer "+a,t.additionalHeaders[f.HEADER.AUTHORIZATION_HEADER]=o),[2,t]}}))}))}function w(e){void 0!==e.additionalHeaders&&null!==e.additionalHeaders||(e.additionalHeaders={}),e.additionalHeaders.hasOwnProperty(f.HEADER.PREFER)?e.additionalHeaders[f.HEADER.PREFER].indexOf("odata.include-annotations=")<0?e.additionalHeaders[f.HEADER.PREFER]=e.additionalHeaders[f.HEADER.PREFER]+","+f.HEADER_VALUES.ANNOTATIONS:e.additionalHeaders[f.HEADER.PREFER]=e.additionalHeaders[f.HEADER.PREFER].replace(/odata\.include-annotations="[^"]+"/,f.HEADER_VALUES.ANNOTATIONS):e.additionalHeaders[f.HEADER.PREFER]=f.HEADER_VALUES.ANNOTATIONS}function M(e,t,r){return r&&r.AppendCallStack("OdataBuilder.parseGetClientMetadataResponse"),t?e&&e.OtherMetadata?function(e,t){t&&t.AppendCallStack("OdataBuilder.parseGetClientMetadataExResponse");e.OtherMetadata;var r=o(e,["OtherMetadata"]),a=JSON.parse(e.OtherMetadata);if(Object.assign(r,a),r.Entities){var i=[];r.Entities.forEach((function(e){var t=n(n({},e.EntityMetadata),e.AttributeNames);i.push(t)})),r.Entities=i}if(r.RelationshipNavigationEntities){var s=[];r.RelationshipNavigationEntities.forEach((function(e){var t=n(n({},e.EntityMetadata),e.AttributeNames);s.push(t)})),r.RelationshipNavigationEntities=s}return r}(e,r):[]:JSON.parse(e)}function I(e){return"["+(e||c.PREFIX.ODataBuilder)+"]"}t.fromQueryState=function(e){return{type:"odatabuilder.fromquerystate.async",execute:function(t,r){var n=t.getState;return a(this,void 0,void 0,(function(){var t,a,o,l,d;return i(this,(function(i){if(r.TraceManager.getTracer(c.MDL_COMPONENT_NAMES.ODataBuilder).info(I()+" Create a SerializedRequest from Query State."),t=e.viewId&&u.Guid.toString(e.viewId),!(a=p.getEntitySetName(n(),e.entityLogicalName)))throw new h.ErrorStatus("unable to send query without entity set name. Key: "+e.key);return o=e.fetchXml?encodeURIComponent(e.fetchXml):"",function(e,t,r){e&&e.additionalHeaders&&(t.viewId&&(e.additionalHeaders[f.HEADER.VIEW_ID_HINT]=u.Guid.toString(t.viewId)),t.pageSize&&(e.additionalHeaders[f.HEADER.PAGESIZE_HINT]=t.pageSize.toFixed()),t.pageNumber&&(e.additionalHeaders[f.HEADER.PAGE_NUMBER_HINT]=t.pageNumber.toFixed()),t.searchString&&(e.additionalHeaders[f.HEADER.SEARCH_HINT]=t.searchString),t.wheres&&t.wheres.length>0&&(e.additionalHeaders[f.HEADER.FILTER_HINT]=t.wheres.toString()),t.sorts&&t.sorts.length>0&&(e.additionalHeaders[f.HEADER.ORDERBY_HINT]=t.sorts.toString()),t.selects&&t.selects.length>0&&(e.additionalHeaders[f.HEADER.SELECT_HINT]=t.selects.toString()),t.linkEntities&&t.linkEntities.length>0&&(e.additionalHeaders[f.HEADER.LINK_HINT]=t.linkEntities.toString()))}(l={urlParameters:a+"?fetchXml="+o,additionalHeaders:(d={},d[f.HEADER.PREFER]=f.HEADER_VALUES.ANNOTATIONS,d[f.HEADER.ACCEPT]=f.HEADER_VALUES.APPLICATION_JSON,d[f.HEADER.SOURCE_ID]=null!=t?t:s.UNKNOWN,d),method:"GET"},e),[2,C(n(),r,l)]}))}))}}},t.convertQueryStateToODataRequest=function(e,t,r){var n=t.entityLogicalName,a=function(e,t,r){var n={};e===c.ODataRequestType.RetrieveWithUrlParams&&t.selects&&t.selects.length>0&&!t.isAllColumns&&(n.select=t.selects.toString());e===c.ODataRequestType.RetrieveWithUrlParams&&t.sorts&&t.sorts.length>0&&(n.orderby=t.sorts.toString());if(t.expression)try{n.filter=g.Expression.getHintFromExpression(t.expression,g.QueryOptionsFormat.ODataUri)}catch(e){null==r||r.error(I()+" Failed to add Filter hint with error: "+(null==e?void 0:e.message)+".")}return"?"+Object.keys(n).map((function(e){return"$"+e+"="+n[e]})).join("&")}(e,t);if(e===c.ODataRequestType.RetrieveWithUrlParams)return new m.ODataRetrieveWithUrlParamsRequest(n,void 0,a);if(e===c.ODataRequestType.Update)return new m.ODataUpdateRequest(n,void 0,r,a);if(e===c.ODataRequestType.DeleteWithUrlParams)return new m.ODataDeleteWithUrlParamsRequest(n,void 0,a);throw new Error("ConvertQueryStateToODataRequest cannot handle request type "+e)},t.convertToBatchRequest=function(e,t){var r=y.buildBatchRequest([t],e);return r.additionalHeaders=n(n({},t.additionalHeaders),r.additionalHeaders),P(e,r),r},t.fromODataContract=N,t.fromFunctionalOdataContract=function(e,t){return{type:"odatabuilder.fromfunctionalodatacontract.async",execute:function(r,n){var a=r.getState;n.TraceManager.getTracer(c.MDL_COMPONENT_NAMES.ODataBuilder).info(I()+" Create a SerializedRequest from a functional OData Contract.");var i=E.buildFunctionRequest(a(),e);return Promise.resolve(C(a(),n,i,t))}}},t.addRequestId=function(e,t){null!=e&&null!=t&&(null==e.additionalHeaders||e.additionalHeaders.hasOwnProperty(f.HEADER.CLIENT_REQUEST_ID)||(e.additionalHeaders[f.HEADER.CLIENT_REQUEST_ID]=t))},t.getClientRequestId=function(e){var t;return(null===(t=null==e?void 0:e.additionalHeaders)||void 0===t?void 0:t[f.HEADER.CLIENT_REQUEST_ID])||s.UNKNOWN},t.addAuthHeader=R,t.isSerializedRequestSupportedOffline=function(e,t){if(t.urlParameters&&t.urlParameters.includes("$batch"))return!0;var r=S.getEntityNameFromRequest(e,t);return r&&T.isEntityAvailableForOfflineUsage(e,r)},t.addAnnotationsHeader=w,t.toGCMResponse=function(e,t,r,n){return{type:"odatabuilder.togcmresponse.async",execute:function(o,s){o.getState;return a(this,void 0,void 0,(function(){var a;return i(this,(function(i){switch(i.label){case 0:return[4,_.parseJsonResponse(e,n,r)];case 1:return(a=i.sent()).Metadata?[2,M(a.Metadata,t,r)]:[2,a]}}))}))}}}},GBvQ:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.getEntityNameFromRequest=t.getEntitySetNameFromRequest=void 0;var n=r("UxT/"),a=r("Wc7r");function i(e){var t=e.urlParameters;if(!t)return null;"PATCH"===e.method&&t.indexOf(a.UPLOAD_FILENAME_URL_FRAGMENT)>0&&(t=t.substring(0,t.lastIndexOf("/")));var r=t.substring(t.lastIndexOf("/")+1),n=r.indexOf("("),i=r.indexOf("?"),o=-1;return n>0&&i>0?o=Math.min(n,i):n>0?o=n:i>0?o=i:n<0&&"DELETE"===e.method&&(o=(r=(t=t.substr(0,t.lastIndexOf("/"))).substring(t.lastIndexOf("/")+1)).indexOf("(")),o>0?r.substring(0,o):r}t.getEntitySetNameFromRequest=i,t.getEntityNameFromRequest=function(e,t){var r=i(t);return r&&n.getEntityLogicalNameFromSetName(e,r)}},"GF+Z":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CommandReplayStatus=void 0,function(e){e[e.Draft=0]="Draft",e[e.InProgress=1]="InProgress",e[e.Completed=2]="Completed",e[e.Failed=3]="Failed",e[e.NetworkError=4]="NetworkError"}(t.CommandReplayStatus||(t.CommandReplayStatus={}))},Gcp0:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.isOfflineByDefaultAvailableForUse=t.getIsOfflineEnabled=t.isOfflineAvailableForUse=t.getOfflineStatus=t.getOfflineFeatureStatus=t.getOfflineClient=void 0;var n=r("nf9M"),a=r("LisS"),i=r("Oqhm"),o=r("mA3E"),s=r("B5SO"),u=r("b30f");function l(e){var t;return null===(t=null==e?void 0:e.offline)||void 0===t?void 0:t.client}function c(e){var t=l(e);return t&&!n.IsNullOrUndefined(t.offlineFeatureStatus)?t.offlineFeatureStatus:null}function d(e){var t=l(e);return t&&!n.IsNullOrUndefined(t.status)?t.status:null}function p(e){return c(e)===a.MobileOfflineFeatureStatus.Enabled&&d(e)===i.OfflineStatus.Available&&s.getIsCodeCacheReady(e)}t.getOfflineClient=l,t.getOfflineFeatureStatus=c,t.getOfflineStatus=d,t.isOfflineAvailableForUse=p,t.getIsOfflineEnabled=function(e){return c(e)!==a.MobileOfflineFeatureStatus.Disabled&&u.getIsMocaOfflineFeatureEnabled(e)},t.isOfflineByDefaultAvailableForUse=function(e){return o.isOfflineByDefaultEnabledForApp(e)&&p(e)}},GokG:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DescriptorFormat=void 0,function(e){e[e.Json=0]="Json",e[e.FetchXml=1]="FetchXml",e[e.Sql=2]="Sql",e[e.LayoutXml=3]="LayoutXml"}(t.DescriptorFormat||(t.DescriptorFormat={}))},Gw0Q:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&a(t,e,r);return i(t,e),t},s=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(a,i){function o(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((n=n.apply(e,t||[])).next())}))},u=this&&this.__generator||function(e,t){var r,n,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(a=2&i[0]?n.return:i[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,i[1])).done)return a;switch(n=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,n=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],n=0}finally{r=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},l=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},c=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,a,i=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)o.push(n.value)}catch(e){a={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(a)throw a.error}}return o},d=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(c(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0}),t.RollBackHandler=void 0;var p=o(r("8w73")),f=o(r("R1Ow")),y=r("rljN"),m=r("bZIc"),h=r("+MPC"),g=r("nf9M"),E=r("frZE"),b=r("4oeN"),O=r("YIL4"),v=r("FKn0"),_=r("f7K7"),T=r("D7ZV"),S=r("PFOI"),N=r("DiyU"),C=r("ZYnM"),P=r("G5wq"),R=r("x0cL"),w=r("dozL"),M=r("aAjD"),I=r("Ln9p"),A=r("7l03"),D=function(){function e(e,t){this._offlineLogHelper=e,this._applicationContext=t,this._tracer=t.TraceManager.getTracer(p.upsyncComponentName)}return e.prototype.handle=function(e,t){var r;return s(this,void 0,void 0,(function(){var n,a,i;return u(this,(function(o){switch(o.label){case 0:n=!1,(a=[]).push({name:"CommandType",value:y.getUpsyncCommandTypeName(e.commandType)}),a.push({name:"UpSyncErrorMessage",value:null==t?void 0:t.message}),a.push({name:"UpSyncErrorCode",value:null==t?void 0:t.errorCode}),a.push({name:"UpSyncErrorDetail",value:null==t?void 0:t.errorDetail}),a.push({name:"UpSyncErrorTime",value:null==t?void 0:t.errorTime}),a.push({name:"UpSyncOperationType",value:null===(r=null==e?void 0:e.associatedMainLog)||void 0===r?void 0:r.operationType}),this._tracer.warn("OfflineUpSync.RollBackHandler.Handle : Rollback Started",a),o.label=1;case 1:return o.trys.push([1,6,,7]),e.commandType?[3,3]:[4,this._RollbackCRUDCommand(e)];case 2:return o.sent(),[3,5];case 3:return[4,this._RollbackNonCRUDCommand(e)];case 4:o.sent(),o.label=5;case 5:return[3,7];case 6:return o.sent(),this._tracer.error("OfflineUpSync.RollBackHandler.Handle : Rollback command failed",a),[3,7];case 7:return o.trys.push([7,9,,10]),this._tracer.warn("OfflineUpSync.RollBackHandler.Handle : Rollback command Succeeded. Creating sync error log",a),[4,this._AddRecordSyncErrorLog(e,t)];case 8:return n=o.sent(),m.PlaybackManager.IncrementSyncErrorsCount(),this._tracer.warn("OfflineUpSync.RollBackHandler.Handle : Rollback Succeeded",a),[2,n];case 9:throw i=o.sent(),i=h.convertToErrorStatus(i),a.push({name:"UpSyncErrorRollbackError",value:i}),this._tracer.error("OfflineUpSync.RollBackHandler.Handle : Rollback failed to create sync error log",a),i;case 10:return[2]}}))}))},e.prototype._RollbackCRUDCommand=function(e){return s(this,void 0,void 0,(function(){var t,r,n,a,i,o,s,c;return u(this,(function(u){switch(u.label){case 0:if(t=[],r=[],!e.rollBackEntityRecord)throw new Error("Cannot process rollback crud operation without entityRecord");if(r.push(this._RollbackOperation(e.rollBackEntityRecord,e.rollBackEntityRecord.get_identifier().LogicalName,e.sqlOperation)),!g.IsNullOrUndefined(e.associatedActivityParties)&&e.associatedActivityParties.length>0)try{for(n=l(e.associatedActivityParties),a=n.next();!a.done;a=n.next())i=a.value,r.push(this._RollbackOperation(i.rollBackEntityRecord,p.activityParty,i.sqlOperation))}catch(e){s={error:e}}finally{try{a&&!a.done&&(c=n.return)&&c.call(n)}finally{if(s)throw s.error}}return[4,Promise.all(r)];case 1:return o=u.sent(),g.IsNullOrUndefined(o)?[3,3]:(t.push.apply(t,d(o)),[4,this._offlineLogHelper.performOperations(t,!0)]);case 2:return u.sent(),[2,!0];case 3:return[2,!1]}}))}))},e.prototype._RollbackNonCRUDCommand=function(e){return s(this,void 0,void 0,(function(){var t,r,n,a,i,o,s,c,d,p,f,m,h,b,O,v;return u(this,(function(u){switch(u.label){case 0:for(t=e.command,r=e.associatedCommandMainLogs,n=e.associatedCommandEntityLogs,a=[],i=[],o=r.length-1;o>=0;o--)s=r[o],c=n[s.SID.toString()],d=y.getEntityNameFromOfflineLog(s),i.push(this._RollbackOperation(c,d,s.operationType));return[4,Promise.all(i)];case 1:p=u.sent();try{for(f=l(p),m=f.next();!m.done;m=f.next())h=m.value,g.IsNullOrUndefined(h)||a.push(h)}catch(e){O={error:e}}finally{try{m&&!m.done&&(v=f.return)&&v.call(f)}finally{if(O)throw O.error}}return(b=this._offlineLogHelper.updateCommandStatus(t,E.CommandStatus.failed))&&a.push(b),[4,this._offlineLogHelper.performOperations(a,!0)];case 2:return u.sent(),[2,!0]}}))}))},e.prototype._AddRecordSyncErrorLog=function(e,t){var r,n;return s(this,void 0,void 0,(function(){var a,i,o,s,l,c,d,p,f,m;return u(this,(function(u){switch(u.label){case 0:if(this._tracer.warn(y.addPrefix("OfflineUpSync.RollBackHandler._AddRecordSyncErrorLog.Start","Sync Error Creation Started")),!e.commandType)return[2,this._CreateSyncErrorLog(e,t)];i=(a=e).command,o="",s=b.LegacyGuid.get_empty(),c="",u.label=1;case 1:return u.trys.push([1,4,,5]),d=a.associatedCommandMainLogs[a.associatedCommandMainLogs.length-1],p=a.associatedCommandEntityLogs[d.SID.toString()],o=y.getEntityNameFromOfflineLog(d),A.isOfflineOnlyEntity(o)?[2,!1]:[4,null===(n=null===(r=this._applicationContext.DataLayerConfiguration.MetadataProvider)||void 0===r?void 0:r.retrieveEntity)||void 0===n?void 0:n.call(r,o)];case 2:return l=u.sent(),f=l.PrimaryIdAttribute||o+"id",s=b.LegacyGuid.tryCreate(p.getValue(f).toString()),[4,this._CreateSyncErrorRecordAndLog(o,i.name,s,o,t.message,c,t.errorTime,"",t.errorCode,t.errorDetail)];case 3:return[2,u.sent()];case 4:throw m=u.sent(),m=h.convertToErrorStatus(m),this._tracer.error(y.addPrefix("OfflineUpSync.RollBackHandler._AddRecordSyncErrorLog.Fail",m.message)),m;case 5:return[2]}}))}))},e.prototype._CreateSyncErrorRecordAndLog=function(e,t,r,n,a,i,o,l,c,d){var p,f,m,g,E,b,O,N,C,P,R,w;return s(this,void 0,void 0,(function(){var s,A,D,L,U,F;return u(this,(function(u){switch(u.label){case 0:return[4,null===(f=null===(p=this._applicationContext.DataLayerConfiguration.MetadataProvider)||void 0===p?void 0:p.retrieveEntityAttributes)||void 0===f?void 0:f.call(p,v.SyncError,null)];case 1:s=u.sent(),A=v.createEntityRecord(e,t,r,n,a,i,o,l,c,d,s),(D={}).OperationSource="Upsync",u.label=2;case 2:return u.trys.push([2,5,,10]),[4,null===(g=null===(m=this._applicationContext.DataLayerConfiguration.MetadataProvider)||void 0===m?void 0:m.requestAdditionalMetadataForEntityRecord)||void 0===g?void 0:g.call(m,A)];case 3:return u.sent(),U=new _.ODataCreateRequest(A.get_identifier().LogicalName,T.buildEntityPayload(null===(b=null===(E=this._applicationContext.DataLayerConfiguration.StateProvider)||void 0===E?void 0:E.getStore)||void 0===b?void 0:b.call(E).getState(),A)),[4,null===(N=null===(O=this._applicationContext.DataLayerConfiguration.DataProvider)||void 0===O?void 0:O.execute)||void 0===N?void 0:N.call(O,U,S.RetrievalStrategy.Local,D,new M.UCIContext(I.Guid.newGuid().guid))];case 4:return u.sent(),this._tracer.warn(y.addPrefix("OfflineUpSync.RollBackHandler._AddRecordSyncErrorLog.Success","Sync Error Creation Succeeded")),[2,!0];case 5:L=u.sent(),L=h.convertToErrorStatus(L),this._tracer.error(y.addPrefix("OfflineUpSync.RollBackHandler._AddRecordSyncErrorLog.Fail: CreateSyncErrorLog Failed on local, retry on remote",L.message)),u.label=6;case 6:return u.trys.push([6,8,,9]),U=new _.ODataCreateRequest(A.get_identifier().LogicalName,T.buildEntityPayload(null===(P=null===(C=this._applicationContext.DataLayerConfiguration.StateProvider)||void 0===C?void 0:C.getStore)||void 0===P?void 0:P.call(C).getState(),A)),[4,null===(w=null===(R=this._applicationContext.DataLayerConfiguration.DataProvider)||void 0===R?void 0:R.execute)||void 0===w?void 0:w.call(R,U,S.RetrievalStrategy.Remote,D,new M.UCIContext(I.Guid.newGuid().guid))];case 7:return u.sent(),this._tracer.warn(y.addPrefix("OfflineUpSync.RollBackHandler._AddRecordSyncErrorLog.Success","Sync Error Creation Succeeded on remote after failing on local")),[2,!0];case 8:throw F=u.sent(),F=h.convertToErrorStatus(F),this._tracer.error(y.addPrefix("OfflineUpSync.RollBackHandler._AddRecordSyncErrorLog.Fail: CreateSyncErrorLog Failed on remote",F.message)),F;case 9:return[3,10];case 10:return[2]}}))}))},e.prototype._CreateSyncErrorLog=function(e,t){var r,n;return s(this,void 0,void 0,(function(){var a,i,o,s,l,c,d,p,m,h,E,b,v,_;return u(this,(function(u){switch(u.label){case 0:return a=y.getTableNameFromNorSyncMainLog(e.associatedMainLog),i=y.getEntityNameFromOfflineLogTableName(a),[4,null===(n=null===(r=this._applicationContext.DataLayerConfiguration.MetadataProvider)||void 0===r?void 0:r.retrieveEntity)||void 0===n?void 0:n.call(r,i)];case 1:return o=u.sent(),s=e.entityRecord,g.IsNullOrUndefined(s)?[3,3]:(l=s.get_identifier().Id,c=(null==o?void 0:o.IsActivity)||i===f.activityParty,d=e.sqlOperation,p=e.entityPayload?this._ConvertDictionaryToJsonString(e.entityPayload):"",[4,this._CreateRequestData(e,o,l.toString(),d)]);case 2:if(m=u.sent(),m=this._IsRequestDataRequired(d)?m:"",c&&(h=this._GetActivityPartySyncErrorDetails(e,d,o),g.IsNullOrUndefined(h.ActivityPartyActionData)||(p+=h.ActivityPartyActionData),this._IsRequestDataRequired(d)&&!g.IsNullOrUndefined(h.ActivityPartyCollection))){for(v in E=JSON.parse(m),b=h.ActivityPartyCollection)_={key:v,value:b[v]},E[_.key]=_.value;m=this._ConvertDictionaryToJsonString(E)}return[2,this._CreateSyncErrorRecordAndLog(i,O.SQLOperationType[d],l,g.IsNullOrUndefined(s.getValue(null==o?void 0:o.PrimaryNameAttribute))?"":s.getValue(null==o?void 0:o.PrimaryNameAttribute),t.message,p,t.errorTime,m,t.errorCode,t.errorDetail)];case 3:return[2,Promise.resolve(!1)]}}))}))},e.prototype._GetActivityPartySyncErrorDetails=function(t,r,n){var a,i,o=t.associatedActivityParties,s="",u={},c={},d=t.entityRecord;try{for(var p=l(o),y=p.next();!y.done;y=p.next()){var m=y.value,h=m.associatedMainLog,E=m.entityRecord;if(!n.IsActivity||r!==O.SQLOperationType.Create||!this._IsOwnerActivityParty(E)){if(d.hasField(f.activityId)){var b=E.getValue(f.activityId),v=d.getValue(f.activityId);b.Id.toString()===v.toString()&&(s+=this._GetActivityPartyData(E)+"\r\n")}if(this._IsRequestDataRequired(r)&&h.operationType!==O.SQLOperationType.Delete){var _=E.getValue(f.participationTypeMask);if(!g.IsNullOrUndefined(_)&&!g.IsNullOrUndefined(_.Value)){var T=f.participationTypeMasktoType[_.Value.toString()],S=E.getValue(e._PartyIdAttributeName);if(!g.IsNullOrUndefined(S)){var N=S.getObjectData();g.IsNullOrUndefined(c[T])&&(c[T]=[]),c[T].push(N)}}}}}}catch(e){a={error:e}}finally{try{y&&!y.done&&(i=p.return)&&i.call(p)}finally{if(a)throw a.error}}return u.ActivityPartyCollection=c,u.ActivityPartyActionData=s,u},e.prototype._IsOwnerActivityParty=function(e){var t=e.getValue(f.participationTypeMask);if(!g.IsNullOrUndefined(t)&&!g.IsNullOrUndefined(t.Value)&&f.participationTypeMasktoType[t.Value.toString()]===f.ownerParty)return!0;return!1},e.prototype._GetActivityPartyData=function(t){var r=t.getValue(f.participationTypeMask);if(!g.IsNullOrUndefined(r)&&!g.IsNullOrUndefined(r.Value)){var n=f.participationTypeMasktoType[r.Value.toString()],a=t.getValue(e._PartyIdAttributeName);if(!g.IsNullOrUndefined(a)){var i=a;return n+e._ActionDataDelimiter+i.Name}}return""},e.prototype._RollbackOperation=function(e,t,r){return s(this,void 0,void 0,(function(){var n;return u(this,(function(a){switch(a.label){case 0:return n=null,r!==O.SQLOperationType.Create?[3,1]:(n=this._RollBackCreateOperation(e,t),[3,5]);case 1:return r!==O.SQLOperationType.Delete?[3,3]:[4,this._RollBackDeleteOperation(e,t)];case 2:return n=a.sent(),[3,5];case 3:return r!==O.SQLOperationType.Update?[3,5]:[4,this._RollBackUpdateOperation(e,t)];case 4:n=a.sent(),a.label=5;case 5:return[2,n]}}))}))},e.prototype._RollBackCreateOperation=function(e,t){if(y.getPrimaryAttributeNameForNonCrmTable(t)){var r=new N.Expression("in",{attributeName:p.commandIdColumnName,value:[e.getValue(p.commandIdColumnName).toString()]}),n=C.ModernQueryBuilder.fromState({}).where(r).from(t);return P.convertQueryStateToODataRequest(w.ODataRequestType.DeleteWithUrlParams,n.getQueryState(!0))}return new _.ODataDeleteRequest(R.EntityReference.legacyToExternalEntityReference(e.get_identifier()))},e.prototype._RollBackUpdateOperation=function(e,t){var r,n,a,i,o,l;return s(this,void 0,void 0,(function(){var s,c;return u(this,(function(u){switch(u.label){case 0:return y.getPrimaryAttributeNameForNonCrmTable(t)?(s=new N.Expression("in",{attributeName:p.commandIdColumnName,value:[e.getValue(p.commandIdColumnName).toString()]}),c=C.ModernQueryBuilder.fromState({}).where(s).from(t),[2,P.convertQueryStateToODataRequest(w.ODataRequestType.Update,c.getQueryState(!0),T.buildEntityPayload(null===(n=null===(r=this._applicationContext.DataLayerConfiguration.StateProvider)||void 0===r?void 0:r.getStore)||void 0===n?void 0:n.call(r).getState(),e))]):[4,null===(i=null===(a=this._applicationContext.DataLayerConfiguration.MetadataProvider)||void 0===a?void 0:a.requestAdditionalMetadataForEntityRecord)||void 0===i?void 0:i.call(a,e)];case 1:return u.sent(),[2,new _.ODataUpdateRequest(t,e.get_identifier().Id.toString(),T.buildEntityPayload(null===(l=null===(o=this._applicationContext.DataLayerConfiguration.StateProvider)||void 0===o?void 0:o.getStore)||void 0===l?void 0:l.call(o).getState(),e))]}}))}))},e.prototype._RollBackDeleteOperation=function(e,t){var r,n,a,i;return s(this,void 0,void 0,(function(){return u(this,(function(o){switch(o.label){case 0:return[4,null===(n=null===(r=this._applicationContext.DataLayerConfiguration.MetadataProvider)||void 0===r?void 0:r.requestAdditionalMetadataForEntityRecord)||void 0===n?void 0:n.call(r,e)];case 1:return o.sent(),[2,new _.ODataCreateRequest(t,T.buildEntityPayload(null===(i=null===(a=this._applicationContext.DataLayerConfiguration.StateProvider)||void 0===a?void 0:a.getStore)||void 0===i?void 0:i.call(a).getState(),e))]}}))}))},e.prototype._CreateRequestData=function(e,t,r,a){return s(this,void 0,void 0,(function(){var i;return u(this,(function(o){return this._tracer.warn(y.addPrefix("RollbackHandler:CreateRequestData","Started")),i=e.entityPayload?n({},e.entityPayload):{},a===O.SQLOperationType.Create&&(i[t.PrimaryIdAttribute]=r),i[f.regardingEntityId]=r,i[f.entityLogicalNameLowerCase]=t.EntityLogicalName,this._tracer.warn(y.addPrefix("RollbackHandler:CreateRequestData","Completed"+i.toString())),[2,this._ConvertDictionaryToJsonString(i)]}))}))},e.prototype._ConvertDictionaryToJsonString=function(e){return JSON.stringify(e)},e.prototype._IsRequestDataRequired=function(e){return e===O.SQLOperationType.Create||e===O.SQLOperationType.Update},e._PartyIdAttributeName="partyid",e._ActionDataDelimiter=" - ",e}();t.RollBackHandler=D},H5aA:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OptionMetadata=void 0;var n=function(){function e(e,t,r,n,a,i,o){this._val=0,this._state=0,this._defaultStatus=0,this._allowedStatusTransitions=null,this._color=null,this._invariantName=null,this._label=e,this._val=t,this._state=r,this._defaultStatus=n,this._allowedStatusTransitions=a,this._color=i,this._invariantName=o}return e.prototype.get_Label=function(){return this._label},e.prototype.set_Label=function(e){return this._label=e,e},e.prototype.get_ValueString=function(){return this._val.toString()},e.prototype.get_allowedStatusTransitions=function(){return this._allowedStatusTransitions},e.prototype.get_color=function(){return this._color},e.prototype.get_value=function(){return this._val},e.prototype.get_state=function(){return this._state},e.prototype.get_defaultStatus=function(){return this._defaultStatus},e.prototype.get_invariantName=function(){return this._invariantName},e.prototype.getObjectData=function(){return{label:this._label,value:this._val,state:this._state,defaultstatus:this._defaultStatus,allowedstatustransitions:this._allowedStatusTransitions,color:this._color,invariantname:this._invariantName}},e.prototype.getODataObject=function(){return{Value:this._val,Color:this._color,Label:this._label,DefaultStatus:this._defaultStatus,State:this._state,TransitionData:this._allowedStatusTransitions,InvariantName:this._invariantName}},e.createFromPicklistItem=function(t){if(t instanceof e)return t;return new e(t.get_Label(),+t,-1,-1,null,null,null)},e.createFromObjectData=function(t){return new e(t.label,t.value,"state"in t?t.state:-1,"defaultstatus"in t?t.defaultstatus:-1,"allowedstatustransitions"in t?t.allowedstatustransitions:null,"color"in t?t.color:null,t.invariantname)},e.createFromOData=function(t){return new e(t.Label,t.Value,"State"in t?t.State:-1,"DefaultStatus"in t?t.DefaultStatus:-1,"TransitionData"in t?t.TransitionData:null,"Color"in t?t.Color:null,t.Description)},e}();t.OptionMetadata=n,n.__typeName="Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.OptionMetadata"},II95:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),a=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)},i=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.getEntityReferenceFromField=t.getEntityReferenceIdFromField=t.getRawValueFromField=t.getPickListValueFromField=t.getFormattedValueFromField=t.isPartylistValue=t.isAliasedValue=t.isPlainValue=t.isReferenceValue=t.isGuidValue=t.isPicklistValue=void 0;var o=r("Ln9p");a(r("57fN"),t);function s(e){return!!e&&e.hasOwnProperty("label")}function u(e){return!!e&&e.hasOwnProperty("id")}function l(e){return!!e&&e.hasOwnProperty("reference")}function c(e){return!!e&&e.hasOwnProperty("value")}function d(e){return!!e&&e.hasOwnProperty("innerValue")}function p(e){return!!e&&e.hasOwnProperty("list")}function f(e){return e?e.toString():null}function y(e){return e&&s(e)?e.valueString:null}t.getFormattedValueFromField=function e(t){var r,n;if(t){if(c(t)){if(t.validationResult&&!t.validationResult.isValueValid){var a=t.validationResult.userInput;return a&&(null==a?void 0:a.toString())}return t.formatted||t.value&&t.value.toString()}if(s(t))return t.label;if(u(t))return o.Guid.toString(t.id);if(l(t))return t.reference&&t.reference.name||null;if(d(t))return e(t.innerValue);if(p(t)){var y="";try{for(var m=i(t.list),h=m.next();!h.done;h=m.next()){var g=h.value,E=void 0;g.fields&&(E=g.fields.partyid?g.fields.partyid:g.fields.addressused?g.fields.addressused:null)&&(y=""!==y?y+", "+e(E):e(E))}}catch(e){r={error:e}}finally{try{h&&!h.done&&(n=m.return)&&n.call(m)}finally{if(r)throw r.error}}return y}return f(t)}return null},t.getRawValueFromField=function e(t){return t?c(t)?t.value:s(t)?y(t):u(t)?t.id:l(t)?t.reference:d(t)?e(t.innerValue):p(t)?t.list:f(t):null},t.isPicklistValue=s,t.isGuidValue=u,t.isReferenceValue=l,t.isPlainValue=c,t.isAliasedValue=d,t.isPartylistValue=p,t.getPickListValueFromField=y,t.getEntityReferenceIdFromField=function(e){return e&&l(e)&&e.reference&&e.reference.id||null},t.getEntityReferenceFromField=function(e){return l(e)&&e.reference||null}},IMw2:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PlaybackExecutionStatus=void 0,function(e){e[e.failure=0]="failure",e[e.success=1]="success"}(t.PlaybackExecutionStatus||(t.PlaybackExecutionStatus={}))},JOkt:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Condition=void 0;var n=r("nf9M"),a=function(){function e(e,t,r){this._set_attributeName(e),this.set_operator(t),this.set_value(r)}return e.prototype.get_entityName=function(){return n.IsNullOrUndefined(this._entityName)&&(this._entityName=""),this._entityName},e.prototype.set_entityName=function(e){return this._entityName=e,e},e.prototype.get_attributeName=function(){return this._AttributeName},e.prototype._set_attributeName=function(e){return this._AttributeName=e,e},e.prototype.get_operator=function(){return this._Operator},e.prototype.set_operator=function(e){return this._Operator=e,e},e.prototype.get_value=function(){return this._Value},e.prototype.set_value=function(e){this._Value=e},e.prototype._get_conditionName=function(){return this._ConditionName},e.prototype.set_conditionName=function(e){return this._ConditionName=e,e},e.prototype.clone=function(){var t=new e(this.get_attributeName(),this.get_operator(),this.get_value());return t.set_entityName(this.get_entityName()),t.set_conditionName(this._get_conditionName()),t},e}();t.Condition=a},JWCx:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CommandType=void 0,function(e){e[e.crud=0]="crud",e[e.nonCrud=1]="nonCrud",e[e.transaction=3]="transaction"}(t.CommandType||(t.CommandType={}))},KijC:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n;Object.defineProperty(t,"__esModule",{value:!0}),t.ClientHostSubtype=void 0,function(e){e[e.Phone=1]="Phone",e[e.Tablet=2]="Tablet",e[e.Unknown=3]="Unknown"}(n||(n={})),t.ClientHostSubtype=n},KkiZ:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n;Object.defineProperty(t,"__esModule",{value:!0}),t.isDataUsable=t.InitState=void 0,function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized",e[e.Refreshing=3]="Refreshing",e[e.Error=4]="Error",e[e.Partial=5]="Partial"}(n||(n={})),t.InitState=n,t.isDataUsable=function(e){return e===n.Initialized||e===n.Refreshing}},LN30:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.buildDeleteRequest=void 0;var n=r("UxT/"),a=r("Wc7r");t.buildDeleteRequest=function(e,t,r,i){var o=n.getEntitySetName(e,t.etn)+"("+t.id.guid+")";i&&(o=o+"/"+i);var s={urlParameters:o,method:"DELETE"};return i||(void 0!==s.additionalHeaders&&null!==s.additionalHeaders||(s.additionalHeaders={}),s.additionalHeaders[a.HEADER.IF_MATCH]=r||"*"),s}},LTKH:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.getAttributeType=t.isDependentOptionSetAttribute=t.getEntityAttributesByType=t.getDependentOptionSetAttributes=t.getPrimaryAttributeName=t.getSelectedAttributesForEntity=t.getAttributeTypes=t.getMissingAttributes=t.getAttributeDescriptor=t.getUnboundAttributes=t.getAttributesForEntity=void 0;var n=r("yNq8"),a=r("UxT/");function i(e,t){var r,n;return e&&(null==e?void 0:e.metadata)&&(null===(r=null==e?void 0:e.metadata)||void 0===r?void 0:r.attributes)?null===(n=null==e?void 0:e.metadata)||void 0===n?void 0:n.attributes[t]:null}function o(e,t,r){var n=i(e,t);if(!n)return null;if(0===r.length)return n;var a={};return r.forEach((function(e){n.hasOwnProperty(e)&&(a[e]=n[e])})),a}function s(e,t,r){var n=i(e,t);return n&&n.hasOwnProperty(r)?n[r]:null}t.getAttributesForEntity=i,t.getMissingAttributes=function(e,t,r){if(!r||!r.length)return[];var n=i(e,t);if(!n)return r;for(var a=[],o=0;o<r.length;o++)n[r[o]]||a.push(r[o]);return a},t.getSelectedAttributesForEntity=o,t.getUnboundAttributes=function(e,t){return i(e,t)},t.getAttributeDescriptor=s,t.getAttributeTypes=function(e,t,r){var n={},a=i(r,t);return a&&(e&&e.length?e.forEach((function(e){a[e]&&(n[e]=a[e].Type)})):Object.keys(a).forEach((function(e){n[e]=a[e].Type}))),n},t.getAttributeType=function(e,t,r){var n=i(r,t);return n&&n[e]?n[e].Type:null},t.getPrimaryAttributeName=function(e,t){var r=a.getEntityDescriptor(e,t);return r&&r.PrimaryNameAttribute?r.PrimaryNameAttribute:null},t.getDependentOptionSetAttributes=function(e,t,r){if(!r||0===r.length)return null;var a=o(e,t,r);if(!a)return null;var i={};for(var s in a){var u=a[s];u.Type!==n.AttributeType.PickList&&u.Type!==n.AttributeType.MultiSelectPickList||!(u.ParentPicklistLogicalName||u.ChildPicklistLogicalNames&&u.ChildPicklistLogicalNames.length>0)||(i[s]=u)}return i},t.getEntityAttributesByType=function(e,t,r){var n,a,i={};if((null==e?void 0:e.metadata)&&(null===(n=null==e?void 0:e.metadata)||void 0===n?void 0:n.attributes)){var o=null===(a=null==e?void 0:e.metadata)||void 0===a?void 0:a.attributes[t];for(var s in o)o[s].Type===r&&(i[s]=o[s])}return i},t.isDependentOptionSetAttribute=function(e,t,r){var n=s(e,t,r);return!(!n||!(n.ParentPicklistLogicalName||n.ChildPicklistLogicalNames&&n.ChildPicklistLogicalNames.length>0))}},LgaX:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(a,i){function o(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((n=n.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var r,n,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(a=2&i[0]?n.return:i[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,i[1])).done)return a;switch(n=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,n=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],n=0}finally{r=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},o=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.constructODataRequestForNonCUD=void 0;var s=r("87in"),u=r("x0cL"),l=r("f7K7"),c=r("Ln9p");function d(e,t,r,n){var o,s;return a(this,void 0,void 0,(function(){var a;return i(this,(function(i){switch(i.label){case 0:return[4,null===(s=null===(o=n.DataLayerConfiguration.MetadataProvider)||void 0===o?void 0:o.retrieveEntityAttributes)||void 0===s?void 0:s.call(o,e,[t])];case 1:return i.sent(),a=[t],[2,new l.ODataRetrieveRequest(u.EntityReference.toExternalEntityReference(new u.EntityReference(e,r)),a)]}}))}))}t.constructODataRequestForNonCUD=function(e,t){var r,u,p;return a(this,void 0,void 0,(function(){var a,f,y,m,h,g,E,b,O,v,_,T,S,N,C,P,R;return i(this,(function(i){switch(i.label){case 0:for(g in a=JSON.parse(e.command.actionData),f=e.command.name,y=e.entitiesInCommand,m=JSON.parse(a.body),h=function(e){var t={boundParameter:null,parameterTypes:{ActivityId:{typeName:"Edm.Guid",structuralProperty:1},ActivityEntityName:{typeName:"Edm.String",structuralProperty:1},TargetEntity:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5},TargetEntityName:{typeName:"Edm.String",structuralProperty:1},CreateCampaignResponse:{typeName:"Edm.Boolean",structuralProperty:1}},operationName:"ConvertActivity",operationType:0},r={boundParameter:null,parameterTypes:{IncidentId:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5},Status:{typeName:"Edm.Int32",structuralProperty:1},BillableTime:{typeName:"Edm.Int32",structuralProperty:1},Resolution:{typeName:"Edm.String",structuralProperty:1},Remarks:{typeName:"Edm.String",structuralProperty:1}},operationName:"ResolveIncident",operationType:0},n={boundParameter:"entity",parameterTypes:{entity:{typeName:"Microsoft.Dynamics.CRM.lead",structuralProperty:5},CreateAccount:{typeName:"Edm.Boolean",structuralProperty:1},CreateContact:{typeName:"Edm.Boolean",structuralProperty:1},CreateOpportunity:{typeName:"Edm.Boolean",structuralProperty:1},OpportunityCurrencyId:{typeName:"Microsoft.Dynamics.CRM.transactioncurrency",structuralProperty:5},OpportunityCustomerId:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5},SourceCampaignId:{typeName:"Microsoft.Dynamics.CRM.campaign",structuralProperty:5},Status:{typeName:"Edm.Int32",structuralProperty:1},ProcessInstanceId:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5},SuppressDuplicateDetection:{typeName:"Edm.Boolean",structuralProperty:1}},operationName:"QualifyLead",operationType:0},a={boundParameter:null,parameterTypes:{OpportunityClose:{typeName:"Microsoft.Dynamics.CRM.opportunityclose",structuralProperty:5},Status:{typeName:"Edm.Int32",structuralProperty:1}},operationName:"WinOpportunity",operationType:0},i={boundParameter:null,parameterTypes:{OpportunityClose:{typeName:"Microsoft.Dynamics.CRM.opportunityclose",structuralProperty:5},Status:{typeName:"Edm.Int32",structuralProperty:1}},operationName:"LoseOpportunity",operationType:0};switch(e){case"WinOpportunity":return a;case"LoseOpportunity":return i;case"QualifyLead":return n;case"ResolveIncident":return r;case"ConvertActivity":return t;default:throw new Error("Invalid command name")}}(f),m)"Edm.Guid"===(null===(r=h.parameterTypes[g])||void 0===r?void 0:r.typeName)?m[g]={guid:m[g]}:"Microsoft.Dynamics.CRM.lead"===(null===(u=h.parameterTypes[g])||void 0===u?void 0:u.typeName)&&(m[g]={entityType:"lead",id:m[g].leadid});if(E=n({getMetadata:function(){return h}},m),(null===(p=a.additionalHeaders)||void 0===p?void 0:p.OfflineData)&&(b=JSON.parse(a.additionalHeaders.OfflineData),E.offlineData=b),(O=[]).push(E),!y)return[3,8];i.label=1;case 1:i.trys.push([1,6,7,8]),v=o(y),_=v.next(),i.label=2;case 2:return _.done?[3,5]:(T=_.value,N=(S=O).push,[4,d(T.entityLogicalName,s.versionNumber,new c.Guid(T.id),t)]);case 3:N.apply(S,[i.sent()]),i.label=4;case 4:return _=v.next(),[3,2];case 5:return[3,8];case 6:return C=i.sent(),P={error:C},[3,8];case 7:try{_&&!_.done&&(R=v.return)&&R.call(v)}finally{if(P)throw P.error}return[7];case 8:return[2,new l.ODataExecuteMultipleRequest(O,!1)]}}))}))}},LisS:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MobileOfflineFeatureStatus=void 0,function(e){e[e.Default=0]="Default",e[e.Enabled=1]="Enabled",e[e.Disabled=2]="Disabled"}(t.MobileOfflineFeatureStatus||(t.MobileOfflineFeatureStatus={}))},Ln9p:function(e,t,r){"use strict";r.r(t),r.d(t,"Guid",(function(){return u}));var n=r("fKp2"),a=r("yNq8"),i=r("4oeN");const o=/^({?)((\d|[a-fA-F]){8}-(\d|[a-fA-F]){4}-(\d|[a-fA-F]){4}-(\d|[a-fA-F]){4}-(\d|[a-fA-F]){12})(}?)$/,s=/^([a-fA-F\d]{8})([a-fA-F\d]{4})([a-fA-F\d]{4})([a-fA-F\d]{4})([a-fA-F\d]{12})$/;class u{constructor(e,t=!1){if(t)this.guid=e;else{const t=u._formatGuidString(e);if(!t)throw new Error(e+" is not a valid Guid value.");this.guid=t}Object.freeze(this)}static externalGuid(e){return e&&e.guid?"{"+e.guid.toUpperCase()+"}":u.EMPTYSTRING}static fromExternalGuid(e,t){return typeof e===a.AttributeType.String&&e.trim().length>0?new u(e.replace(/[\{\}]/gi,"")):(t&&t.warn(n.FILE_PREFIX.Common+" Empty string or invalid object used to form GUID. Returning empty GUID."),u.EMPTY)}static validate(e){return null!=e&&null!==o.exec(e)}static toString(e){return e?e.guid:null}static tryParse(e){return u.tryParseOrNull(e)||u.EMPTY}static tryParseOrNull(e){const t=u._formatGuidString(e);return t?new u(t,!0):null}static parse(e){return new u(e)}static toLegacyGuid(e){return e?i.LegacyGuid.createFromFormattedGuidStringAndSkipParsing(e.guid):null}static fromLegacyGuid(e){if(e){const t=e.toString();if(t)return new u(t,!0)}return null}static equals(e,t){return null==e||null==t?e===t:u.toString(e)===u.toString(t)}static isNullOrEmpty(e){return!e||u.equals(e,u.EMPTY)}static newGuid(){let e="";for(let t=0;t<36;t++)if(14===t)e+="4";else if(8===t||13===t||18===t||23===t)e+="-";else if(19===t){const t=Math.floor(16*Math.random());e+="0123456789abcdef".substr(3&t|8,1)}else e+="0123456789abcdef".substr(Math.floor(16*Math.random()),1);return new u(e,!0)}static _formatGuidString(e){if(!e||"string"!=typeof e)return null;e=e.toLowerCase();const t=o.exec(e);if(t)return t[1].length!==t[8].length?null:t[2];{const t=s.exec(e);if(t)return t.filter((e,t)=>t>0).join("-")}return null}}u.EMPTYGUIDSTRING="00000000-0000-0000-0000-000000000000",u.EMPTY=new u(u.EMPTYGUIDSTRING,!0),u.EMPTYSTRING=""},M2g1:function(e,t,r){"use strict";r.r(t),r.d(t,"TokenType",(function(){return n})),r.d(t,"LogicalOperator",(function(){return a})),r.d(t,"LogicalOperatorString",(function(){return i})),r.d(t,"LogicalOperatorPriority",(function(){return o})),r.d(t,"FunctionOperator",(function(){return s})),r.d(t,"ConditionalOperator",(function(){return u})),r.d(t,"JoinType",(function(){return l})),r.d(t,"JoinTypeSQL",(function(){return c})),r.d(t,"getTokenType",(function(){return p}));var n,a,i,o,s,u,l,c,d=r("dJUv");
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */function p(e){switch(e.toLowerCase()){case d.p.openParenthesis:return n.openBracket;case d.p.closeParenthesis:return n.closeBracket;case i.and:case i.or:case i.not:return n.logicalOperator;default:return n.operand}}!function(e){e[e.openBracket=0]="openBracket",e[e.closeBracket=1]="closeBracket",e[e.logicalOperator=2]="logicalOperator",e[e.operand=3]="operand"}(n||(n={})),function(e){e[e.and=0]="and",e[e.or=1]="or",e[e.not=2]="not"}(a||(a={})),function(e){e.and="and",e.or="or",e.not="not"}(i||(i={})),function(e){e[e.not=1]="not",e[e.and=2]="and",e[e.or=3]="or"}(o||(o={})),function(e){e.functionIn="Microsoft.Dynamics.CRM.In",e.contains="contains",e.functionContains="Microsoft.Dynamics.CRM.Contains"}(s||(s={})),function(e){e.equal="eq",e.notEqual="ne",e.in="in",e.like="like",e.greaterThan="gt",e.greaterThanEqual="ge",e.lessThan="lt",e.lessThanEqual="le",e.equalsUserId="eq-userid",e.notIn="not-in",e.null="null",e.notNull="not-null",e.notLike="not-like",e.beginsWith="begins-with",e.notBeginWith="not-begin-with",e.endsWith="ends-with",e.notEndWith="not-end-with",e.notEqualsUserId="ne-userid",e.equalsUserTeams="eq-userteams",e.equalsUserOrUserTeams="eq-useroruserteams",e.between="between",e.notBetween="not between"}(u||(u={})),function(e){e[e.inner=0]="inner",e[e.outer=1]="outer",e[e.natural=2]="natural",e[e.matchfirstrowusingcrossapply=3]="matchfirstrowusingcrossapply",e[e.in=4]="in",e[e.exists=5]="exists"}(l||(l={})),function(e){e.inner="inner",e.leftouter="left outer"}(c||(c={}))},McwX:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(a,i){function o(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((n=n.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var r,n,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(a=2&i[0]?n.return:i[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,i[1])).done)return a;switch(n=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,n=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],n=0}finally{r=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},i=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.retrieveEntityMetadataErrorEnd=t.retrieveEntities=t.retrieveEntity=t.getUpdatedEntityRefCount=t.RETRIEVE_ENTITY_ACTION=t.ENTITY_TYPE=t.RETRIEVE_ENTITY_ASYNC=void 0;var o=r("KkiZ"),s=r("eDM3"),u=r("LTKH"),l=r("UxT/"),c=r("+MPC"),d=r("WkZn"),p=r("b1WC"),f=r("rxGJ"),y=r("xQ7h");t.RETRIEVE_ENTITY_ASYNC="entity.retrieve.async";var m=["activityparty"];function h(e,t,r){return n(this,void 0,void 0,(function(){var n,i,o;return a(this,(function(a){switch(a.label){case 0:if(!(n=t.DataLayerConfiguration.MetadataProvider))return[3,5];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,n.retrieveEntities(r)];case 2:return i=a.sent(),e((u=i,{type:s.GET_CLIENT_METADATA,payload:u})),[2,i];case 3:throw o=a.sent(),e(v(Object.keys(r))),o;case 4:return[3,6];case 5:throw new c.ErrorStatus("No metadata provider, GCM scenario is not yet supported");case 6:return[2]}var u}))}))}function g(e,t,r,n,a){var i,s,c={},p={};for(var f in r){var y=void 0,m=r[f],h=l.getEntityDescriptor(e,f);if(E(f)){var g=b(e,f,n,a,null===(i=n.DataLayerConfiguration.GarbageCollectionProvider)||void 0===i?void 0:i.getCurrentPage());g&&(p[f]=g)}h&&h.Initialized!==o.InitState.Uninitialized&&h.Initialized!==o.InitState.Partial?(y=u.getMissingAttributes(e,f,null!==(s=null!=m?m:h.AttributeNames)&&void 0!==s?s:[])).length>0&&(c[f]=y&&y.sort().filter((function(e,t,r){return r.indexOf(e)===t}))):c[f]=m&&m.sort().filter((function(e,t,r){return r.indexOf(e)===t}))}return Object.keys(p).length>0&&t(d.updateGCMetadataRefCount(p)),c}function E(e){return-1===m.indexOf(e)}function b(e,t,r,n,a){var i,o;if(!e)return null;if(!a&&(a=null===(i=r.DataLayerConfiguration.GarbageCollectionProvider)||void 0===i?void 0:i.getCurrentPage(),n)){var s=r.TraceManager.getTracer("RetrieveEntity"),u="getUpdatedEntityRefCount() called without pageId, action stack is : "+n.stack;s.info(u);var l=[];l.push({name:"errorString",value:u}),r.EventManager.ReportComponentSuccess("RetrieveEntity",l)}if(a&&""!==a){var c=f.getGCEntityMetadataRefCount(e,t),d=null==c?void 0:c.slice();return null!==(o=p.addReference(d,a))&&void 0!==o?o:null}return null}function O(e,t){var r,n,a={entities:{},attributes:{}};try{for(var o=i(t),s=o.next();!s.done;s=o.next()){var c=s.value;a.entities&&(a.entities[c]=l.getEntityDescriptor(e,c)),a.attributes&&(a.attributes[c]=u.getAttributesForEntity(e,c))}}catch(e){r={error:e}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return a}function v(e){var t={};e.forEach((function(e){t[e]={Initialized:o.InitState.Error}}));var r={entities:t};return y.retrieveEntityMetadata(r)}t.ENTITY_TYPE="entity",t.RETRIEVE_ENTITY_ACTION="entity.retrieve",t.getUpdatedEntityRefCount=b,t.retrieveEntity=function(e,r,i){return{type:t.RETRIEVE_ENTITY_ASYNC,execute:function(t,o,s){var u=t.dispatch,l=t.getState;return n(this,void 0,void 0,(function(){var t,n,c;return a(this,(function(a){return(c={})[e]=r?null:null!=i?i:[],t=c,n=g(l(),u,t,o,s),0===Object.keys(n).length?[2,O(l(),[e])]:[2,h(u,o,n)]}))}))}}},t.retrieveEntities=function(e){return{type:t.RETRIEVE_ENTITY_ASYNC,execute:function(t,r,i){var o=t.dispatch,s=t.getState;return n(this,void 0,void 0,(function(){var t;return a(this,(function(n){try{return e&&0!==Object.keys(e).length?(t=g(s(),o,e,r,i),0===Object.keys(t).length?[2,O(s(),Object.keys(e))]:[2,h(o,r,t)]):[2,Promise.resolve({})]}catch(e){c.convertErrorAndRethrow(e)}return[2]}))}))}}},t.retrieveEntityMetadataErrorEnd=v},Msg1:function(e,t,r){"use strict";r.r(t),r.d(t,"ODataExecutor",(function(){return na}));var n=r("hER9"),a=r("d61F"),i=r("7l03");class o{constructor(){this._startMarker=new Map,this._perfMeasure=new Map,this._perfStatistic=new Map}startMarker(e){this._startMarker.set(e,this.getTimeNow())}endMarker(e){const t=this.getTimeNow();let r=0;try{this._startMarker.has(e)&&(r=this._startMarker.get(e)||r);const n=t-r,a={name:e,startTime:r,endTime:t,duration:n};this.updatedStatistic(e,n),this._perfMeasure.set(e,a)}catch(e){return}}getTimeNow(){return performance.now()}getPerformanceEntry(e){try{if(this._perfMeasure.has(e)&&this._perfStatistic.has(e)){const t=this._perfMeasure.get(e),r=this._perfStatistic.get(e);if(t&&r)return{name:e,performanceMeasure:t,performanceStatistic:r}}}catch(e){return null}return null}updatedStatistic(e,t){let r=t,n=1,a=t,i={};try{if(this._perfStatistic.has(e)){const i=this._perfStatistic.get(e);n=i?i.count+n:n,r=i?i.totalDuration+t:t,a=r/n}i={name:e,count:n,totalDuration:r,averageDuration:a},this._perfStatistic.set(e,i)}catch(e){return}}}var s=r("fKp2"),u=r("tUL6");function l(){return{name:"ConnectivityRetry",condition:(e,t)=>
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
function(e,t){return"GET"===e.method&&"remote"===Object(i.getClientType)(e)&&0===t.status}(e,t),retryCount:1}}var c=r("ogvk");
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */class d{constructor(e){this._promiseCache={},this._tracer=e.TraceManager.getTracer(s.COMPONENT_NAMES.ODataExecutor)}contains(e){return this._promiseCache[e]?(this._tracer.info(p()+" Promise in cache"),!0):(this._tracer.info(p()+" Promise not in cache"),!1)}get(e){return this._tracer.info(p()+" --- Get Promise Key"),this._promiseCache[e]}put(e,t){this._tracer.info(p()+" --- Put Promise key"),this._promiseCache[e]=t}remove(e){this._tracer.info(p()+" --- Remove Promise key"),delete this._promiseCache[e]}}function p(e){return e?`[${e}]`:`[${s.FILE_PREFIX.PromiseCache}]`}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */class f{constructor(e,t,r,n,a){this._applicationContext=e,this._interceptors=t,this._index=n||0,this._call=0,this.request=r,this.executionContext=a||{}}async proceed(e){if(this._index<this._interceptors.length){e||(e=this.request),this._call+=1;const t=new f(this._applicationContext,this._interceptors,e,this._index+1,this.executionContext),r=this._interceptors[this._index],n=await r.intercept(t);return 1!==t._call&&this._index+1!==this._interceptors.length?Promise.reject(new Error("interceptor "+r.constructor.name+" must call proceed() at least once")):n}return Promise.reject(new Error("Interceptor out of range"))}clone(e){return new f(this._applicationContext,this._interceptors,e||this.request,this._index,this.executionContext)}terminate(){this._call+=1}}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */class y{constructor(e){this.applicationContext=e,this.tracer=e.TraceManager.getTracer(s.COMPONENT_NAMES.ODataExecutor)}}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */class m extends y{constructor(e,t,r){super(r),this._retryCount=t,this._policyManager=e}async intercept(e){return await this.executeWithPolicy(e)}async executeWithPolicy(e){let t=e,r=0,n=0;const a={};let o=this._retryCount;const s=e.executionContext?e.executionContext.commonEventParameters:[];for(;;){await this.timeout(n);const u=t.request;try{const i=await t.proceed(),l=this._policyManager.getRetryPolicy(u,i);if(null===l)return i;const c=l.name;if(c&&c in a?o=a[l.name]:(a[c]=l.retryCount,o=l.retryCount),!(r<this._retryCount&&o>0))return this.tracer.warn(`${this.getPolicyRetryInterceptorPrefix()} Retry the request for ${r} time(s). Failed to retry with policy ${c}.`,s),i;{const i=l.action?await l.action(u):u;t=e.clone(i),r++,a[c]=a[c]-1,n=l.delay||0,this.tracer.warn(`${this.getPolicyRetryInterceptorPrefix()} Retry the request with retry policy: ${c} and current retry count is: ${r}.`,s)}}catch(e){const t="Retry with count "+r+" failed";return e.message=e&&e.message?`${e.message}.${t}`:t,this.tracer.warn(`${this.getPolicyRetryInterceptorPrefix()} ${t}`,s),Object(i.buildODataResponseFromError)(e,u.url)}}}getPolicyRetryInterceptorPrefix(e){return e?`[${e}]`:`[${s.FILE_PREFIX.PolicyRetryInterceptor}]`}async timeout(e){return new Promise(t=>{setTimeout(()=>{t()},e)})}}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */class h extends y{constructor(e,t){super(t),this._promiseCache=e}async intercept(e){const t=e.request;if(this._promiseCache.contains(t.url))return e.terminate(),this._promiseCache.get(t.url);{const r=e.proceed();return this._promiseCache.put(t.url,r),r.then(()=>{this._promiseCache.remove(t.url)},()=>{this._promiseCache.remove(t.url)}),r}}}var g=r("jkZo"),E=r("ZXCs");
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
class b extends y{constructor(e,t){super(t),this._t=e,this._timeout=0,this._eventParameters=[],this._timeoutBuffer=5e3}intercept(e){this._eventParameters=e.executionContext?e.executionContext.commonEventParameters:this._eventParameters;const t=Promise.race([this.timeOut(),e.proceed()]);return t.then(()=>{clearTimeout(this._timeout)},()=>{clearTimeout(this._timeout)}),t}timeOut(){return new Promise((e,t)=>{this.tracer.info(`${this.getTimeoutInterceptorPrefix()} Set time out with time ${this._t}`);const r=Date.now();this._timeout=window.setTimeout(()=>{const e=Date.now();Object(E.n)(this.applicationContext,g.c)&&e-r>this._t+this._timeoutBuffer?(this.tracer.warn(this.getTimeoutInterceptorPrefix()+" Retrying timeout to see if request can be completed",this._eventParameters),clearTimeout(this._timeout),this._timeout=window.setTimeout(()=>{this._logErrorAndRejectPromise(t)},this._t)):this._logErrorAndRejectPromise(t)},this._t)})}_logErrorAndRejectPromise(e){this.tracer.error(`${this.getTimeoutInterceptorPrefix()} Timeout with time ${this._t}`,this._eventParameters),e(new Error("request failed with timeout"))}getTimeoutInterceptorPrefix(e){return e?`[${e}]`:`[${s.FILE_PREFIX.TimeoutInterceptor}]`}setExtraTimeout(e){this._timeoutBuffer=e}}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */class O{constructor(e,t){this.applicationContext=t,this._timeout=e&&e.timeout||3e5,this._policyManager=e&&e.PolicyManager||this.getDefaultPolicyManager(this.applicationContext),this._retryCount=e&&e.RetryCount||3,this._promiseCache=new d(this.applicationContext),this._customizedInterceptors=[],this.interceptors=[]}getDefaultPolicyManager(e){const t=new c.PolicyManager(e);return t.addRetryPolicy(l()),t}build(){return this.applicationContext&&this.applicationContext.AdditionalParameters&&this.applicationContext.AdditionalParameters.SingletonExecutor||(this.interceptors.push(new h(this._promiseCache,this.applicationContext)),this.interceptors.push(new b(this._timeout,this.applicationContext)),this.interceptors=this.interceptors.concat(this._customizedInterceptors),this.interceptors.push(new m(this._policyManager,this._retryCount,this.applicationContext))),this.interceptors.push(this.executeRequestInterceptor),this}describe(){const e=[];return this.interceptors.forEach(t=>{e.push(t.constructor.name)}),e}setExecuteRequestInterceptor(e){return this.executeRequestInterceptor=e,this}addInterceptor(e){return this._customizedInterceptors.push(e),this}execute(e,t){return new f(this.applicationContext,this.interceptors,e,0,t).proceed()}}var v=r("OJ1H"),_=r("YEmJ"),T=r("yNq8");function S(e){return e?`[${e}]`:`[${s.FILE_PREFIX.FileExecutor}]`}var N=r("FedD"),C=r("xHQC");
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
async function P(e,t,r,o,s,u=[],l){let c;const d=new Headers;r.info(R()+" Processing the retrieve response",u),d.set(n.HEADER.CONTENT_TYPE,n.HEADER_VALUES.APPLICATION_JSON);const p=o;if(p&&p.length>0){const o=await async function(e,t,r,n,i,o=[],s){let u="",l={};const c=[],d=s?s.BPFEntityLogicalName:"";if(!d||0===d.length)return"";c.push({name:"EntityLogicalName",value:d});const p=n[0].rows.item(0);if(p){let r=!1;Object(N.d)(e)&&(r=!0),l=await Object(N.c)(t,p,d,r),t.EventManager.ReportComponentSuccess(R(),Object(a.b)(o,c));const n={};l["@odata.type"]=d,n.GlobalNavigationData=l,i&&(n.Entity=i),n["@odata.context"]=e.url,u=JSON.stringify(n)}return u}(e,t,0,p,s,u,l);Object(i.isNullOrUndefinedOrEmptyString)(o)?(r.error(R()+" No response retrieved from offline DB for this request",u),c=Object(N.a)(n.HTTP_STATUS_CODES.Unknown,e.url,new v.a("No response retrieved from offline DB for this request"),d)):c=Object(N.b)(n.HTTP_STATUS_CODES.Ok,e.url,d,o)}else r.error(R()+" No response retrieved from offline DB for this request",u),c=Object(N.a)(n.HTTP_STATUS_CODES.Unknown,e.url,new v.a("No response retrieved from offline DB for this request"),d);return c}function R(e){return e?`[${e}]`:`[${s.FILE_PREFIX.BPFResponseHandler}]`}var w,M=r("Ln9p");!function(e){e[e.None=0]="None",e[e.UserOwned=1]="UserOwned",e[e.TeamOwned=2]="TeamOwned",e[e.BusinessOwned=4]="BusinessOwned",e[e.OrganizationOwned=8]="OrganizationOwned",e[e.BusinessParented=16]="BusinessParented"}(w||(w={}));var I=r("dJUv");
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */async function A(e,t,r,o={},u=!1){const l=t.TraceManager.getTracer(s.COMPONENT_NAMES.SQLExecutor),c=o.commonEventParameters||[],d=[];e=Object(i.addClientRequestIdToSqlQueryRequests)(e,o,l),d.push({name:"NoOfSQLStatements",value:e&&e.sqlStatements?e.sqlStatements.length:0}),l.info(D()+" ExecuteSQLBatch - starting ExecuteSQLBatch",Object(a.b)(c,d));try{let p;return r===n.OPERATION.GetClientMetadata?(o.performanceControl&&o.performanceControl.startMarker(s.FILE_PREFIX.MetadataSQLExecutor),p=await t.SqlExecutor.executeSqlStatementsOnMetadataDB(e)):(o.performanceControl&&o.performanceControl.startMarker(s.FILE_PREFIX.DataSQLExecutor),u&&(e.sqlStatements.unshift(I.u),e.sqlParameters.unshift([]),e.sqlStatements.push(I.t),e.sqlParameters.push([])),p=await t.SqlExecutor.executeSqlStatementsOnOfflineDB(e)),(Object(i.isNullOrUndefinedOrEmpty)(p)||0===p.length)&&(d.push({name:s.EVENT_PARAMETERS.SQL_QUERY,value:e.sqlStatements.toString()}),l.warn(D()+" ExecuteSQLBatch did not return a result",Object(a.b)(c,d))),l.info(D()+" SQL Executor successfully completed",Object(a.b)(c,d)),o.performanceControl&&(r===n.OPERATION.GetClientMetadata?o.performanceControl.endMarker(s.FILE_PREFIX.MetadataSQLExecutor):o.performanceControl.endMarker(s.FILE_PREFIX.DataSQLExecutor)),Promise.resolve(p)}catch(t){const r=Object(i.convertErrorToLocalError)(t),o=r.message;return r.message=Object(a.g)(o),Object(a.a)(t,d),d.push({name:s.EVENT_PARAMETERS.SQL_ERROR_CODE,value:r.code||n.ErrorCode.UnknownUnexpectedGenericError}),d.push({name:s.EVENT_PARAMETERS.SQL_ERROR_MESSAGE,value:o}),Object(a.f)(e,d),l.error(D()+" Error on SQL Executor rejecting with data source offline error code",Object(a.b)(c,d)),Promise.reject(r)}}function D(e){return e?`[${e}]`:`[${s.FILE_PREFIX.SQLExecutor}]`}var L=r("87in"),U=r("gpz4"),F=r("lSoY"),x=r("1NvT"),k=r("PUb4"),j=r("4oeN");function q(e,t){switch(e){case"form":return{type:F.MetadataType.form,subtype:B("form",t)};case"workspace":case"systemworkspace":case"userworkspace":return{type:F.MetadataType.workspace,subtype:B(e,"dashboard")};case"formselector":return{type:F.MetadataType.formSelector,subtype:B(e,t)};case"bpfselector":return{type:F.MetadataType.bpfSelector,subtype:F.MetadataSubtype.none};case"dashboardselector":return{type:F.MetadataType.dashboardSelector,subtype:B(e,"dashboard")};case"search":return{type:F.MetadataType.searchConfiguration,subtype:F.MetadataSubtype.none};case"customcontrol":return{type:F.MetadataType.customControl,subtype:F.MetadataSubtype.none};case"resourcestring":return{type:F.MetadataType.resourceString,subtype:F.MetadataSubtype.none};case"visualizationselector":return{type:F.MetadataType.visualizationSelector,subtype:F.MetadataSubtype.none};case"savedvisualization":return{type:F.MetadataType.savedQueryVisualization,subtype:F.MetadataSubtype.none};case"uservisualization":return{type:F.MetadataType.userQueryVisualization,subtype:F.MetadataSubtype.none};case"label":return{type:F.MetadataType.label,subtype:F.MetadataSubtype.none};case"displaystring":return{type:F.MetadataType.displayString,subtype:F.MetadataSubtype.none};case"webresource":return{type:F.MetadataType.webResource,subtype:B(e,t)};case"webresourcedescriptor":return{type:F.MetadataType.webResourceDescriptor,subtype:F.MetadataSubtype.none};case"customcontroldefaultconfig":return{type:F.MetadataType.homePageConfiguration,subtype:F.MetadataSubtype.none};case"optionset":return{type:F.MetadataType.optionSet,subtype:F.MetadataSubtype.none};case"quickcreatemenu":return{type:F.MetadataType.quickCreateMenu,subtype:F.MetadataSubtype.none};case"businessprocessflow":return{type:F.MetadataType.businessProcessFlow,subtype:F.MetadataSubtype.none};case"dialog":return{type:F.MetadataType.dialog,subtype:F.MetadataSubtype.none};case"taskbasedflow":return{type:F.MetadataType.taskBasedFlow,subtype:F.MetadataSubtype.none};case"taskbasedflowglobalmenu":return{type:F.MetadataType.taskBasedFlowGlobalMenu,subtype:F.MetadataSubtype.none};case"sitemap":return{type:F.MetadataType.siteMap,subtype:F.MetadataSubtype.none};case"viewselector":return{type:F.MetadataType.viewSelector,subtype:B(e,t)};case"savedview":return{type:F.MetadataType.savedView,subtype:B(e,t)};case"userview":return{type:F.MetadataType.userView,subtype:B(e,t)};case"ribbon":return{type:F.MetadataType.command,subtype:F.MetadataSubtype.none};case"appmodules":return{type:F.MetadataType.appModule,subtype:F.MetadataSubtype.none};case"appmoduleselector":return{type:F.MetadataType.appModuleSelector,subtype:F.MetadataSubtype.none};case"metadataversion":return{type:F.MetadataType.overallMetadataVersion,subtype:F.MetadataSubtype.none};case"complexcontrol":return{type:F.MetadataType.complexControl,subtype:F.MetadataSubtype.none};case"isactivityflags":return{type:F.MetadataType.isActivityFlags,subtype:F.MetadataSubtype.none};case"appmoduleofflinemetadata":return{type:F.MetadataType.appModuleOfflineMetadata,subtype:F.MetadataSubtype.none};case"dependencies":return{type:F.MetadataType.dependencies,subtype:F.MetadataSubtype.none};default:return{type:F.MetadataType.none,subtype:F.MetadataSubtype.none}}}function B(e,t){let r;switch(e){case"form":case"formselector":case"dashboardselector":r=
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
function(e){let t=F.MetadataSubtype.none;if(!Object(i.isNullOrUndefined)(e))switch(e.toLowerCase()){case"appointmentbook":t=F.MetadataSubtype.appointment;break;case"hardcoded":t=F.MetadataSubtype.hardcoded;break;case"main":t=F.MetadataSubtype.main;break;case"minicampaignbo":t=F.MetadataSubtype.miniCampaignBO;break;case"preview":t=F.MetadataSubtype.preview;break;case"dashboard":t=F.MetadataSubtype.dashboard;break;case"quick":t=F.MetadataSubtype.quick;break;case"mobile":t=F.MetadataSubtype.mobile;break;case"read":t=F.MetadataSubtype.read;break;case"quickcreate":t=F.MetadataSubtype.quickCreate;break;case"dialog":t=F.MetadataSubtype.dialog;break;case"card":t=F.MetadataSubtype.card;break;case"taskbasedform":t=F.MetadataSubtype.taskBased;break;case"interactioncentricdashboard":t=F.MetadataSubtype.interactionCentricDashboard;break;default:t=F.MetadataSubtype.none}return t}(t);break;case"viewselector":case"savedview":case"userview":r=function(e){let t=F.MetadataSubtype.none;if(!Object(i.isNullOrUndefined)(e))switch(e.toUpperCase()){case"MAIN_APPLICATION_VIEW":t=F.MetadataSubtype.main;break;case"ADVANCED_SEARCH":t=F.MetadataSubtype.advancedSearch;break;case"SUB_GRID":t=F.MetadataSubtype.subGrid;break;case"QUICKFIND_SEARCH":t=F.MetadataSubtype.quickFindSearch;break;case"REPORTING":t=F.MetadataSubtype.reporting;break;case"OFFLINE_FILTERS":t=F.MetadataSubtype.offlineFilters;break;case"MA_SEARCH":t=F.MetadataSubtype.maSearch;break;case"LOOKUP_VIEW":t=F.MetadataSubtype.lookup;break;case"SM_APPOINTMENTBOOK_VIEW":t=F.MetadataSubtype.smAppointmentBook;break;case"OUTLOOK_FILTERS":t=F.MetadataSubtype.outlookFilters;break;case"ADDRESSBOOK_FILTERS":t=F.MetadataSubtype.addressbookFilters;break;case"SAVEDQUERYTYPE_OTHER":t=F.MetadataSubtype.savedQueryTypeOther;break;case"INTERACTIVE_WORKFLOW_VIEW":t=F.MetadataSubtype.interactiveWorkFlow;break;case"OFFLINE_TEMPLATE":t=F.MetadataSubtype.offlineTemplate;break;case"OUTLOOK_TEMPLATE":t=F.MetadataSubtype.outlookTemplate;break;case"CUSTOM_DEFINED_VIEW":t=F.MetadataSubtype.customDefined;break;default:t=F.MetadataSubtype.none}return t}(t);break;case"workspace":case"systemworkspace":case"userworkspace":r=F.MetadataSubtype.dashboard;break;case"webresource":r=function(e){let t=0;if(!Object(i.isNullOrUndefined)(e))switch(e.toUpperCase()){case"HTML":t=10;break;case"CSS":t=6;break;case"JSCRIPT":t=5;break;case"XML":t=11;break;case"PNG":t=7;break;case"JPG":t=8;break;case"RESX":t=12;break;case"GIF":case"SILVERLIGHT":case"XSL":case"ICO":default:t=0}return t}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */(t);break;default:r=F.MetadataSubtype.none}return r}class ${constructor(e){if(Object(i.isNullOrUndefinedOrEmptyString)(e))throw new Error("Undefined path parameter to KeyPath");this._path=e}static get_id(){return $._id}get_path(){return this._path}}$._id=new $("id");
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
const V=new $(k.i.METADATA_TYPE),H=(new $(k.i.SOURCE_ID),new $(k.i.METADATA_TYPE+i.COMPOSITE_INDEX_DELIMITER+k.i.SOURCE_ID)),G=new $(k.i.METADATA_TYPE+i.COMPOSITE_INDEX_DELIMITER+k.i.ASSOCIATED_ENTITY_LOGICAL_NAME),Q=new $(k.i.METADATA_TYPE+i.COMPOSITE_INDEX_DELIMITER+k.i.METADATA_SUBTYPE+i.COMPOSITE_INDEX_DELIMITER+k.i.ASSOCIATED_ENTITY_LOGICAL_NAME),X=new $(k.i.METADATA_TYPE+i.COMPOSITE_INDEX_DELIMITER+k.i.DISPLAY_NAME);
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class W{constructor(e,t,r,n,a,o,s,u){if(this._metadataType=0,this._metadataSubtype=0,this._formFactor=0,this._isDefault=!1,this._applicationMetadataType=0,this._isDefaultSpecified=!1,!e)throw new Error("Invalid application metadata type");this._metadataType=e,this._formFactor=t,this._associatedEntityLogicalName=r,this._applicationMetadataType=Object(i.isNullOrUndefined)(n)?F.ApplicationMetadataType.systemApplicationMetadata:n,this._isDefaultSpecified=!Object(i.isNullOrUndefined)(a),this._isDefault=!!this._isDefaultSpecified&&a,this._sourceId=o||"",this._metadataSubtype=s||0,this._normalizedDisplayName=u||""}checkApplicationMetadata(e){return(!this.get_metadataType()||e.metadatatype===this.get_metadataType())&&(!(!Object(i.isNullOrUndefined)(this.get_metadataSubtype())&&this.get_metadataSubtype()!==F.MetadataSubtype.none&&e.metadatasubtype!==this.get_metadataSubtype())&&(!(!Object(i.isNullOrUndefinedOrEmptyString)(this.get_sourceId())&&e.sourceid!==this.get_sourceId())&&(!(!Object(i.isNullOrUndefinedOrEmptyString)(this.get_associatedEntityLogicalName())&&e.associatedentitylogicalname!==this.get_associatedEntityLogicalName())&&(!(this.get_formFactor()>0&&e.formfactor!==this.get_formFactor())&&(!(this._isDefaultSpecified&&this._isDefault&&Object(i.isNullOrUndefined)(e.isdefault||!e.isdefault))&&(!(this._applicationMetadataType===F.ApplicationMetadataType.userApplicationMetadata&&!e.isuserrecord)&&!(!Object(i.isNullOrUndefinedOrEmptyString)(this.get_normalizedDisplayName())&&this.get_normalizedDisplayName()!==e.displayname.toUpperCase())))))))}get_keyPath(){return Object(i.isNullOrUndefinedOrEmptyString)(this.get_sourceId())?Object(i.isNullOrUndefinedOrEmptyString)(this.get_normalizedDisplayName())?Object(i.isNullOrUndefinedOrEmptyString)(this.get_associatedEntityLogicalName())||Object(i.isNullOrUndefined)(this.get_metadataSubtype())?Object(i.isNullOrUndefinedOrEmptyString)(this.get_associatedEntityLogicalName())?V:G:Q:X:H}get_keyValue(){const e=this.get_metadataType().toString(),t=this.get_keyPath();if(t===H)return e+i.COMPOSITE_INDEX_DELIMITER+this.get_sourceId();if(t===G)return e+i.COMPOSITE_INDEX_DELIMITER+this.get_associatedEntityLogicalName();if(t===Q){const t=this.get_metadataSubtype().toString();return e+i.COMPOSITE_INDEX_DELIMITER+t+i.COMPOSITE_INDEX_DELIMITER+this.get_associatedEntityLogicalName()}return t===X?e+i.COMPOSITE_INDEX_DELIMITER+this.get_normalizedDisplayName():this.get_metadataType()}get_metadataType(){return this._metadataType}get_metadataSubtype(){return this._metadataSubtype}get_formFactor(){return this._formFactor}get_associatedEntityLogicalName(){return this._associatedEntityLogicalName}get_sourceId(){return this._sourceId}get_normalizedDisplayName(){return this._normalizedDisplayName}}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */function z(e,t,r,n,a,o){let s="";e=Object(i.isNullOrUndefined)(e)?"":e,r=Object(i.isNullOrUndefined)(r)?"":r,n=Object(i.isNullOrUndefined)(n)?"":n,o=Object(i.isNullOrUndefined)(o)?"":o;const u=Object(i.isNullOrUndefined)(a)?"":a.toString();switch(t){case F.MetadataType.overallMetadataVersion:s=""+k.c;break;case F.MetadataType.quickCreateMenu:s=`${t}_quickcreatemenu_${o}`;break;case F.MetadataType.searchConfiguration:s=t+"_searchconfiguration";break;case F.MetadataType.taskBasedFlowGlobalMenu:s=t+"_taskbasedflowglobalmenu";break;case F.MetadataType.siteMap:s=`${t}_sitemap_${o}`;break;case F.MetadataType.appModule:s=`${t}_appmodules_${o}`;break;case F.MetadataType.appModuleOfflineMetadata:s=t+"_appmoduleofflinemetadata";break;case F.MetadataType.taskBasedFlow:case F.MetadataType.customControl:case F.MetadataType.resourceString:case F.MetadataType.complexControl:s=`${t}_${n}`;break;case F.MetadataType.dialog:s=`${t}_${n.toLowerCase()}`;break;case F.MetadataType.label:s=`${t}_${r}_${n}`;break;case F.MetadataType.homePageConfiguration:s=`${t}_${e}`;break;case F.MetadataType.optionSet:s=`${t}_${Object(i.isNullOrUndefinedOrEmptyString)(r)?n:r}`;break;case F.MetadataType.appModuleSelector:s=`${t}_${u}`;break;case F.MetadataType.viewSelector:case F.MetadataType.formSelector:case F.MetadataType.dashboardSelector:case F.MetadataType.visualizationSelector:s=`${t}_${e}_${u}_${o}`;break;case F.MetadataType.bpfSelector:s=`${t}_${e}_${o}`;break;case F.MetadataType.command:s=`${t}_${n}_${e}`;break;case F.MetadataType.isActivityFlags:case F.MetadataType.webResource:case F.MetadataType.webResourceDescriptor:s=`${t}_${n}`;break;case F.MetadataType.businessProcessFlow:case F.MetadataType.form:case F.MetadataType.savedQueryVisualization:case F.MetadataType.displayString:default:s=`${t}_${r}`}return s}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */async function Y(e,t,r,o={}){const s=o.commonEventParameters||[],u=[];u.push({name:"ClientMetadataQuery",value:JSON.stringify(r)});try{const u=await async function(e,t,r,o){const s=q(r.MetadataType,r.MetadataSubtype),u=s.subtype,l=s.type;let c="";r.MetadataId&&(c=r.MetadataId.toString());if(r.MetadataType===F.QueriedMetadataType.entity)return async function(e,t,r,n=[]){const o=[],s=t.MetadataSubtype.replace(/\\\"/g,'"'),u=JSON.parse(s),l=[],c=Object.keys(u);o.push({name:"Entities",value:null==c?void 0:c.join(",")});for(const t of c)l.push(Object(_.getEntityMetadata)(e,t,n));const d=[],p={};for(let e=0;e<(null==c?void 0:c.length);e++)try{const t=await l[e];d.push(t)}catch(t){p[c.push[e]]=Object(i.getErrorMessage)(t)}Object.keys(p).length>0&&(o.push({name:"MissingEntities",value:JSON.stringify(p)}),r.warn(`${te()} Could not fetch metadata for ${Object.keys(p).length} entities. Other entities in the query may return results`,Object(a.b)(n,o)));return d}(e,r,t,o.commonEventParameters);if(r.MetadataType===F.QueriedMetadataType.savedView||r.MetadataType===F.QueriedMetadataType.form||r.MetadataType===F.QueriedMetadataType.workspace||r.MetadataType===F.QueriedMetadataType.systemWorkspace||r.MetadataType===F.QueriedMetadataType.userWorkspace||r.MetadataType===F.QueriedMetadataType.savedVisualization)return async function(e,t,r,n){const a=n.commonEventParameters||[],o=k.h[r.MetadataType];if(!Object(i.isNullOrUndefined)(r.MetadataId)||r.MetadataNames&&r.MetadataNames.length){if(k.g[r.DependencyDepth]===k.g.OnDemandWithContext){const i=await Promise.all(J(e,t,r,o,n));return await ee(e,t,i,o,a)}{const i=o.slice(1,o.length),s=Z(e,r,i,t,n),u=await Promise.all(s);return await ee(e,t,u,i,a)}}if(Object(i.isNullOrUndefined)(r.GetDefault)||!r.GetDefault)throw new Error("A query with empty MetadataId and non-true GetDefault parameters is considered invalid.");if(Object(i.isNullOrUndefined)(r.EntityLogicalName)&&r.MetadataType!==F.QueriedMetadataType.workspace&&r.MetadataType!==F.QueriedMetadataType.systemWorkspace&&r.MetadataType!==F.QueriedMetadataType.userWorkspace)throw new Error("This query requests defaults and/or selectors, but does not specify the context. This query is considered invalid.");return Promise.all(J(e,t,r,o,n)).then(e=>{if(Object(i.isNullOrUndefined)(e)||e.length<2)throw new Error("The local store does not contain metadata fragments or selectors for the specified query.");const t=e[0][0],n=o[0],a=function(e){const t=e.data.SelectorItems;if(!Object(i.isNullOrUndefined)(t)&&t.length>0){for(let e=0;e<t.length;e++){const r=t[e];if(r.IsDefault)return r}return t[0]}return{}}(t);if(Object(i.isNullOrUndefined)(a))throw new Error("The default selector item cannot be found.");const s=[];for(let t=1;t<e.length;++t){const r=e[t],i=o[t];for(let e=0;e<r.length;e++){const t=r[e];a[n.uniqueKey]===t.data[i.uniqueKey]&&s.push(t)}}return k.g[r.DependencyDepth]===k.g.OnDemandWithContext&&s.push(t),s})}(e,t,r,o);if(r.MetadataType===F.QueriedMetadataType.dialog||r.MetadataType===F.QueriedMetadataType.taskBasedFlow)return async function(e,t,r,n,o){const s=o.commonEventParameters||[],u=[];let l=[];if(!Object(i.isNullOrUndefined)(r.MetadataNames)&&r.MetadataNames.length>0){const i=r.MetadataNames;for(let r=0;r<i.length;++r){const c=z("",t,"",i[r]),d=await Yr(e,c,void 0,o);if(l=[],l.push({name:"MetadataType",value:F.MetadataType[t]}),l.push({name:"DialogKey",value:c}),d){u.push(d);const r=d.data.FormId,i=z("",F.MetadataType.form,r,""),p=await Yr(e,i,void 0,o);p?u.push(p):(l.push({name:"FormKey",value:i}),n.warn(`${te()} Unable to find dependent form metadata for dialog: ${c} form: ${i} for type ${F.MetadataType[t]}`,Object(a.b)(s,l)))}else n.error(`${te()} Unable to find the dialog root ${c} for type ${F.MetadataType[t]}`,Object(a.b)(s,l))}}else n.error(te()+" Dialog metadata requested without MetadataNames",Object(a.b)(s,l));return u}(e,l,r,t,o);if((l===F.MetadataType.resourceString||l===F.MetadataType.label)&&r.MetadataNames&&r.MetadataNames.length>0)return async function(e,t,r,n,o){const s=o.commonEventParameters||[];let u=[];r.MetadataNames=function(e){e.sort();const t=[];let r="";for(const n of e)n!==r&&(r=n,t.push(n));return t}(r.MetadataNames);const l=[];for(const e of r.MetadataNames)if(u=[],t===F.MetadataType.label){const r=e.split(":");r&&2===r.length?l.push(z("",t,r[0],r[1])):(u.push({name:"MetadataName",value:e}),n.error(`${te()} Invalid label name ${e}`,Object(a.b)(s,u)))}else l.push(z("",t,"",e));const c=t===F.MetadataType.resourceString;if(0===l.length)return[];{const d=await async function(e,t,r,n,a={}){const o=a.commonEventParameters||[],s=[];let u="";for(let e=0;e<r.length;e++)u+=" ?,";u.length>0&&(u=u.substr(0,u.length-1));const l={sqlStatements:[],sqlParameters:[]},c=`SELECT ${k.i.JSON} FROM ${k.b} WHERE ${t.get_path()} IN (${u})`;l.sqlStatements.push(c),l.sqlParameters.push([...r]);const d=await Object(U.a)(e,l,a);if(Jr(e,d),!Object(i.isNullOrUndefined)(d)&&d.length>0)for(let e=0;e<d[0].rows.length;e++){const t=JSON.parse(d[0].rows.item(e)[k.i.JSON]);s.push(t)}else n.warn(Zr()+" result returned form getBatchSQLResult is empty in retrieveMultipleApplicationMetadataByKeys}",o);return s}(e,$.get_id(),l,n,o);if(c&&d.length!==l.length){const e=function(e,t){const r=t.filter(e=>e).map(e=>e.data.Key);let n="";for(const t of e.MetadataNames){let e=!1;for(const n of r)if(t===n){e=!0;break}e||(n=Object(i.isNullOrUndefinedOrEmptyString)(n)?t:n+", "+t)}return n}(r,d);u.push({name:"MissingKeys",value:e}),n.info(`${te()} Not able to find ${l.length-d.length} keys out of ${l.length} of type ${F.MetadataType[t]}, Missing Keys ${e}`,Object(a.b)(s,u))}return d}}(e,l,r,t,o);if((l===F.MetadataType.optionSet||l===F.MetadataType.webResource||l===F.MetadataType.webResourceDescriptor||l===F.MetadataType.complexControl)&&r.MetadataNames&&r.MetadataNames.length>0)return async function(e,t,r,n,o){const s=o.commonEventParameters||[],u=[];for(const l of r.MetadataNames){const c=z(r.EntityLogicalName,t,"",l),d=[];d.push({name:"MetadataIdString",value:c});try{const r=await Yr(e,c,void 0,o);d.push({name:"MetadataType",value:F.MetadataType[t]}),Object(i.isNullOrUndefinedOrEmpty)(r)?n.error(`${te()} Not able to find some of the keys for type ${F.MetadataType[t]} ${c}`,Object(a.b)(s,d)):u.push(r)}catch(e){throw n.error(`${te()} ${e.message||"Failed to Retrieve resource metadata"}`,Object(a.b)(s,d)),e}}return u}(e,l,r,t,o);if(l===F.MetadataType.command&&r.MetadataNames&&r.MetadataNames.length>0)return async function(e,t,r,n){const o=n.commonEventParameters||[],s=z(t.EntityLogicalName,F.MetadataType.command,"",t.MetadataNames[0]),u=[];u.push({name:"MetadataIdString",value:s});try{const t=await Yr(e,s,void 0,n);return Object(i.isNullOrUndefinedOrEmpty)(t)?(r.error(`${te()} Not able to find the key ${s} for type ${F.MetadataType[F.MetadataType.command]}`,Object(a.b)(o,u)),[]):[t]}catch(e){throw r.error(`${te()} Error when retrieving command metadata ${t.MetadataNames[0]}`,Object(a.b)(o,u)),e}}(e,r,t,o);if(l!==F.MetadataType.appModule||Object(i.isNullOrUndefinedOrEmptyString)(c)){if(l===F.MetadataType.appModuleOfflineMetadata)return async function(e,t,r){const n=r.commonEventParameters||[],a=z("",F.MetadataType.appModuleOfflineMetadata,"","",0);try{const t=await Yr(e,a,void 0,r);return t?[t]:[]}catch(e){throw t.error(`${te()} Error when attempting to retrieve application metadata for type ${F.MetadataType[F.MetadataType.appModuleOfflineMetadata]} ${a} ${e.message}`,n),e}}(e,t,o);if(!Object(i.isNullOrUndefinedOrEmptyString)(c)||l!==F.MetadataType.resourceString&&r.MetadataNames&&r.MetadataNames.length>0||l===F.MetadataType.taskBasedFlowGlobalMenu||l===F.MetadataType.quickCreateMenu||l===F.MetadataType.searchConfiguration||l===F.MetadataType.siteMap)return async function(e,t,r,o,s){const u=s.commonEventParameters||[];let l="";const c=[];r.MetadataId&&(l=r.MetadataId.toString());const d=r.AppId&&r.AppId!==j.LegacyGuid.get_empty().toString()?r.AppId.toString():void 0;l=z(r.EntityLogicalName,t,l,Object(i.isNullOrUndefined)(r.MetadataNames)?"":r.MetadataNames[0],0,d),c.push({name:"MetadataIdString",value:l}),c.push({name:"AppId",value:d||""});try{const r=await Yr(e,l,void 0,s);if(Object(i.isNullOrUndefinedOrEmpty)(r)){const e=new v.a(`Not able to find the key ${l} for type ${F.MetadataType[t]}`,n.ErrorCode.DataStoreKeyNotFoundErrorCode);return o.error(`${te()} ${e.message}`,Object(a.b)(u,c)),[]}return[r]}catch(e){throw o.error(`${te()} Error when attempting to retrieve application metadata for type ${F.MetadataType[t]} ${l} ${e.message}`,Object(a.b)(u,c)),e}}(e,l,r,t,o);if(l===F.MetadataType.isActivityFlags)return async function(e,t,r){const n=r.commonEventParameters||[],o=z("",F.MetadataType.isActivityFlags,"",k.d),s=[];s.push({name:"MetadataIdString",value:o});try{const u=await Yr(e,o,void 0,r);if(Object(i.isNullOrUndefinedOrEmpty)(u)){const e=`GetClientMetadata: Not able to find the key ${o} for type ${F.MetadataType[F.MetadataType.isActivityFlags]}`;throw t.error(`${te()} ${e}`,Object(a.b)(n,s)),new Error(e)}return[u]}catch(e){throw t.error(`${te()} Error when retrieving activity flag metadata. ${e.message}`,Object(a.b)(n,s)),e}}(e,t,o);if(l===F.MetadataType.viewSelector)return async function(e,t,r,n,o,s){const u=s.commonEventParameters||[],l=[],c=n.AppId&&n.AppId!==j.LegacyGuid.get_empty().toString()?n.AppId.toString():n.MetadataId?n.MetadataId.toString():void 0,d=z(n.EntityLogicalName,F.MetadataType.viewSelector,"","",r,c);l.push({name:"MetadataIdString",value:d}),l.push({name:"AppId",value:c||""});try{const r=await Yr(e,d,void 0,s);return Object(i.isNullOrUndefinedOrEmpty)(r)?(o.error(`${te()} Not able to find the key ${d} for type ${F.MetadataType[t]}`,Object(a.b)(u,l)),[]):[r]}catch(e){throw o.error(`${te()} Error when retrieving view selector metadata for entity ${n.EntityLogicalName} and appid ${c}. ${e.message}`,Object(a.b)(u,l)),e}}(e,l,u,r,t,o);if(l===F.MetadataType.homePageConfiguration)return async function(e,t,r,n){const o=n.commonEventParameters||[],s=z(t.EntityLogicalName,F.MetadataType.homePageConfiguration,"","",0,""),u=[];u.push({name:"MetadataIdString",value:s});try{const t=await Yr(e,s,void 0,n);return Object(i.isNullOrUndefinedOrEmpty)(t)?(r.error(`${te()} Not able to find the key ${s} for type ${F.MetadataType[F.MetadataType.homePageConfiguration]}`,Object(a.b)(o,u)),[]):[t]}catch(e){throw r.error(`${te()} Error when retrieving home page configuration metadata. ${e.message}`,Object(a.b)(o,u)),e}}(e,r,t,o);if(l===F.MetadataType.none&&u===F.MetadataSubtype.none&&Object(i.isNullOrUndefinedOrEmptyString)(r.EntityLogicalName)&&k.g[r.DependencyDepth]===k.g.UserContext){return[{userid:M.Guid.EMPTY}]}return async function(e,t,r,n,a,i){const o=i.commonEventParameters||[];let s="";n.MetadataId&&(s=n.MetadataId.toString());const u=new W(t,k.f.Desktop,n.EntityLogicalName,0,n.GetDefault,s,r,void 0);try{const r=await Kr(e,u,a,i);return r&&r.length?r:(a.warn(`${te()} Not able to find the key ${s} for type ${F.MetadataType[t]}`,o),[])}catch(e){throw a.error(`${te()} error retrieving metadata by query for ${s}. ${e.message}`,o),e}}(e,l,u,r,t,o)}return async function(e,t,r,n){const o=n.commonEventParameters||[],s=t.AppId&&t.AppId!==j.LegacyGuid.get_empty().toString()?t.AppId.toString():t.MetadataId.toString(),u=z(t.EntityLogicalName,F.MetadataType.appModule,Object(i.isNullOrUndefinedOrEmptyString)(t.MetadataId)?"":t.MetadataId.toString(),Object(i.isNullOrUndefined)(t.MetadataNames)?"":t.MetadataNames[0],0,s),l=[];l.push({name:"MetadataIdString",value:u});try{const t=await Yr(e,u,void 0,n);return Object(i.isNullOrUndefinedOrEmpty)(t)?(r.error(`${te()} Not able to find the key ${u} for type ${F.MetadataType[F.MetadataType.appModule]}`,Object(a.b)(o,l)),[]):[t]}catch(e){throw r.error(`${te()} Error when retrieving app module metadata for appID: ${s}. ${e.message}`,Object(a.b)(o,l)),e}}(e,r,t,o)}(e,t,r,o);return function(e,t,r,n=[]){const a={};for(const r of t)if(Array.isArray(r))for(const t of r)K(e,t,a,n);else K(e,r,a,n);return e.info(`${te()} found ${Object.keys(a).length} root nodes for ${r.MetadataType}:${r.MetadataSubtype}`),a}(t,u,r,s)}catch(r){if(Object(a.a)(r,u),t.error(te()+" Error when attempting to find root nodes.",Object(a.b)(s,u)),await Object(_.isFeatureEnabled)(e,I.h.ModernDataLayerMatchServerGCM)&&!Object(i.isNullOrUndefined)(r.code))throw r}return{}}function K(e,t,r,n=[]){let a="",o="",s=F.MetadataType.none,u=!0;if(function(e){return Object.keys(e).indexOf("metadatatype")>=0}(t))s=(t=t).metadatatype,o=t.id,Object(i.isNullOrUndefinedOrEmptyString)(t.sourceid)||(u=!1,a=t.sourceid);else if(function(e){return Object.keys(e).indexOf("userid")>=0}(t))o=k.j,s=F.MetadataType.userContext;else{if(t=t,Object(i.isNullOrUndefined)(t.Id))return void e.error(te()+" Entity Descriptor with missing ID found",n);o=Object(i.isNullOrUndefined)(t.EntityLogicalName)?"":t.EntityLogicalName,s=F.MetadataType.entity}r[o]={dependenciesFetched:u,queryGenerated:!1,sourceId:a,id:o,metadataType:s}}function J(e,t,r,n,a){const o=B(r.MetadataType,r.MetadataSubtype),s=n[0];let u=[];if(Object(i.isNullOrUndefined)(r.EntityLogicalName)&&r.MetadataType!==F.QueriedMetadataType.workspace&&r.MetadataType!==F.QueriedMetadataType.systemWorkspace&&r.MetadataType!==F.QueriedMetadataType.userWorkspace){const r=Kr(e,new W(s.metadataType,k.f.Desktop,"",0,!1,"",o),t,a);u.push(r)}else{const n=z(r.EntityLogicalName,s.metadataType,"","",o,r.AppId&&r.AppId!==j.LegacyGuid.get_empty().toString()?r.AppId.toString():void 0);u.push(async function(e,t,r,n,a){const o=a.commonEventParameters||[];try{const s=await Yr(e,r,void 0,a);return Object(i.isNullOrUndefinedOrEmpty)(s)?(t.error(`${te()} Not able to find the key ${r} for type ${F.MetadataType[n]}`,o),[]):[s]}catch(e){throw t.error(`${te()} Error when retrieving application metadata for id ${r}. ${e.message}`,o),e}}(e,t,n,s.metadataType,a))}return u=Z(e,r,n.slice(1,n.length),t,a,u),u}function Z(e,t,r,n,a,o){Object(i.isNullOrUndefined)(o)&&(o=[]);const s=B(t.MetadataType,t.MetadataSubtype);for(let i=0;i<r.length;++i){const u=r[i].metadataType,l=t.MetadataId?new W(u,k.f.Desktop,t.EntityLogicalName,0,!1,t.MetadataId.toString()):new W(u,k.f.Desktop,t.EntityLogicalName,0,!1,void 0,s);o.push(Kr(e,l,n,a))}return o}async function ee(e,t,r,o,s=[]){let u=[];if(Object(i.isNullOrUndefined)(r)||!r.length){const r=new v.a("The local store does not contain metadata fragments or selectors for the specified query.",n.ErrorCode.DataStoreKeyNotFoundErrorCode);if(t.error(`${te()} ${r.message}`,Object(a.b)(s,u)),await Object(_.isFeatureEnabled)(e,I.h.ModernDataLayerMatchServerGCM))throw r;return[]}const l=[],c=[];for(let e=0;e<r.length;++e){const t=r[e],n=o[e];for(let e=0;e<t.length;e++){const r=t[e];l.push(r),c.push(n.payloadKey)}}for(let r=0;r<o.length;++r){const i=o[r];if(u=[],u.push({name:"PayLoadKey",value:i.payloadKey}),-1===c.indexOf(i.payloadKey)){const r=new v.a(`The local store does not contain ${i.payloadKey} requested metadata.`,n.ErrorCode.DataStoreKeyNotFoundErrorCode);if(t.warn(`${te()} ${r.message}`,Object(a.b)(s,u)),await Object(_.isFeatureEnabled)(e,I.h.ModernDataLayerMatchServerGCM))return t.info(te()+" Returning empty array to match server response for selectable metadata",Object(a.b)(s,u)),[];throw r}}return l}function te(e){return e?`[${e}]`:`[${s.FILE_PREFIX.RootFinder}]`}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */let re=!0;const ne=[F.QueriedMetadataType.form.toString()];async function ae(e,t,r,a={}){const o=a.commonEventParameters||[],s=ie(e,r,o),u=await Y(t,r,s,a);if(r.info(`${se()} found root nodes ${Object.keys(u)} for ${s.MetadataType}`),re=re&&t.AdditionalParameters&&t.AdditionalParameters.EnableOptimizedDependency,-1!==ne.indexOf(s.MetadataType)){if(re)try{await async function(e,t,r={}){var a,i;const o={sqlStatements:[],sqlParameters:[]};o.sqlStatements.push(`SELECT ${k.i.METADATA_TYPE} FROM ${t} LIMIT 1`),o.sqlParameters.push([]);const s=await A(o,e,n.OPERATION.GetClientMetadata,r);return s&&(null===(i=null===(a=s[0])||void 0===a?void 0:a.rows)||void 0===i?void 0:i.length)>0}(t,k.a,a)||(re=!1,r.warn(se()+" Dependency view is empty, continuing without optimizing dependencies"))}catch(e){re=!1,r.warn(`${se()} Error validating the dependency view, continuing without optimizing dependencies: ${Object(i.getErrorMessage)(e)}`)}if(re&&function(e){return Object.keys(e).some(t=>!e[t].dependenciesFetched)}(u))try{await async function(e,t,r,a,o={}){const s=Object.keys(t).filter(e=>!t[e].dependenciesFetched),u=s.map(e=>z(r,F.MetadataType.dependencies,t[e].sourceId,"")),l=await async function(e,t,r,a={}){const o={sqlStatements:[],sqlParameters:[]},s=[],u=Object(i.isNullOrUndefinedOrEmptyString)(r)?$.get_id().get_path():r;for(const e of t)Wr(o,u,e);const l=await A(o,e,n.OPERATION.GetClientMetadata,a);if(l){Jr(e,l);for(const e of l)e.rows.length>0&&s.push(JSON.parse(e.rows.item(0)[k.i.JSON]))}return s}(e,u,void 0,o);if(l.length<u.length){const e=l.map(e=>e.id),t=u.filter(t=>-1===e.indexOf(t));a.warn(`${se()} Requested ${u.length} dependency records, found ${l.length} dependency records: ${t}`)}for(const e of s)t[e].dependenciesFetched=!0;for(const e in l)if(!Object(i.isNullOrUndefinedOrEmpty)(l[e])&&!Object(i.isNullOrUndefinedOrEmpty)(l[e].data)){const r=l[e];for(const e of r.data.children)t.hasOwnProperty(e)||(t[e]={dependenciesFetched:!0,queryGenerated:!1,sourceId:e,metadataType:F.MetadataType.none})}}(t,u,s.EntityLogicalName,r,a)}catch(e){re=!1,r.warn(`${se()} Error retrieving dependencies, continuing without optimizing dependencies: ${Object(i.getErrorMessage)(e)}`)}}return Object(i.isNullOrUndefinedOrEmpty)(u)?{sqlStatements:[],sqlParameters:[]}:await function(e,t,r=[],n){const a={sqlStatements:[],sqlParameters:[]},o=[];if(n)!function(e,t,r,n=[]){let a=`SELECT ${k.i.METADATA_TYPE}, ${k.i.JSON} FROM ${k.a} WHERE ${L.id} IN (`;const o=")",s=new Set;for(const o in e)if(!Object(i.isNullOrUndefined)(e[o])){const u=e[o];u.metadataType===F.MetadataType.userContext?(t.sqlStatements.push(`SELECT ${k.i.JSON} FROM ${k.k} WHERE ${L.id} = ?`),t.sqlParameters.push([u.id?u.id:k.j])):Object(i.isNullOrUndefinedOrEmptyString)(u.sourceId)?Object(i.isNullOrUndefinedOrEmptyString)(u.id)?r.error(`${se()} Invalid candidate - no ID or source ID for candidate ${u.metadataType}. Skipping query generation`,n):(a+=s.size>0?",?":"?",s.add(u.id)):(a+=s.size>0?",?":"?",s.add(u.sourceId))}s.size>0&&(a+=o,t.sqlStatements.push(a),t.sqlParameters.push([...s]))}(e,a,t,r);else for(const n in e)if(!Object(i.isNullOrUndefined)(e[n])){oe(e[n],a,o,t,r)}t.info(`${se()} Returning ${a.sqlStatements.length} queries`),Object(i.isNullOrUndefined)(a.additionalParameters)&&(a.additionalParameters={});return a.additionalParameters[k.i.METADATA_TYPE]=o,a}(u,r,o,re&&-1!==ne.indexOf(s.MetadataType))}function ie(e,t,r=[]){const n=[],o=e.url.match(/@ClientMetadataQuery=(.*\})/i);if(n.push({name:"url",value:e.url}),Object(i.isNullOrUndefined)(o)){const e="URL does not have a ClientMetadataQuery param";throw t.error(`${se()} ${e}`,Object(a.b)(r,n)),new Error(e)}return JSON.parse(decodeURIComponent(o[1]))}function oe(e,t,r,n,a=[]){e.metadataType===F.MetadataType.userContext?(r.push(e.metadataType),t.sqlStatements.push(`SELECT ${k.i.JSON} FROM ${k.k} WHERE ${L.id} = ?`),t.sqlParameters.push([e.id?e.id:k.j])):e.metadataType===F.MetadataType.entity?Object(i.isNullOrUndefinedOrEmptyString)(e.id)?n.warn(se()+" No ID found for candidate of type entity metadata. Skipping query generation",a):(r.push(e.metadataType),t.sqlStatements.push(`SELECT ${L.id}, ${k.i.JSON} FROM [${k.e}] WHERE [${L.logicalName}] = ?`),t.sqlParameters.push([e.id])):Object(i.isNullOrUndefinedOrEmptyString)(e.id)?n.warn(`${se()} Invalid candidate - no ID found for candidate ${e.metadataType}. Skipping query generation`,a):(r.push(e.metadataType),t.sqlStatements.push(`SELECT ${k.i.METADATA_TYPE}, ${k.i.JSON} FROM ${k.b} WHERE ${L.id} = ?`),t.sqlParameters.push([e.id]))}function se(e){return e?`[${e}]`:`[${s.FILE_PREFIX.GCMGenerator}]`}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
async function ue(e,t,r,n,a){const o=a.commonEventParameters||[],s=await async function(e,t,r){const n=await Object(_.getAttributesMetadata)(r,e,[]);let a=null;const o=[];o.push("createdby"),o.push("modifiedby"),o.push("createdonbehalfbyname"),o.push("modifiedonbehalfbyname");for(const e of Object.keys(n)){const r=n[e];if(!(o.indexOf(r.LogicalName)>=0)&&(r.Type===T.AttributeType.Lookup&&!Object(i.isNullOrUndefined)(r.Targets)&&1===r.Targets.length&&r.Targets[0]===t)){if(!r.IsCustomAttribute){a=r;break}r.LogicalName.startsWith("bpf_")&&(Object(i.isNullOrUndefined)(a)||a.ColumnNumber&&r.ColumnNumber&&a.ColumnNumber>r.ColumnNumber)&&(a=r)}}if(Object(i.isNullOrUndefined)(a))throw Error("OfflineDataStore.getEntityIdAttributeFromBpfEntity.Fail : Cannot find an attribute that matches the lookup target in the entity ");return a.LogicalName}(t,e.entityLogicalName,r),u=`${I.c.where} ${I.p.openSQBracket}${s+L.columnDelimiter+L.id}${I.p.closeSQBracket} ${I.p.equal} ${I.p.question} ${I.c.orderBy} ${L.modifiedOn} ${I.s.DESC}`,l=await le(t,u,[e.id.guid],r,a);if(!Object(i.isNullOrUndefined)(l.rows)&&l.rows.length>0){n.info(`${pe()} BPF data present for ${t}`,o);return ce(t,l.rows.item(0),r,o)}return n.info(`${pe()} No BPF instance found for ${t}`,o),null}async function le(e,t,r,a,o){const s=`${I.c.select} ${I.p.asterisk} ${I.c.from} ${e} ${t}`,u={sqlStatements:[],sqlParameters:[]};u.sqlStatements.push(s),u.sqlParameters.push(r);const l=await A(u,a,n.OPERATION.Retrieve,o);if(!Object(i.isNullOrUndefined)(l)&&l.length>0)return l[0];throw new Error("results is null")}async function ce(e,t,r,n){if(!Object(i.isNullOrUndefined)(t))try{const a=await Object(_.getEntityMetadata)(r,e,n),i=a.PrimaryIdAttribute?a.PrimaryIdAttribute:"",o=M.Guid.tryParse(t["processid!id"]);return{entityLogicalName:e,id:o,modifiedon:new Date(t.modifiedon),primaryIdAttribute:i,primaryIdValue:M.Guid.tryParse(t[i])}}catch(e){throw new Error("Error when forming a BPF record")}throw new Error("Error when forming a BPF record")}async function de(e,t,r,n){const a=n.commonEventParameters||[],i=q(t.MetadataType,t.MetadataSubtype),o=i.subtype,s=i.type;let u="";t.MetadataId&&(u=t.MetadataId.toString());const l=new W(s,k.f.Desktop,t.EntityLogicalName,0,t.GetDefault,u,o,void 0);try{const t=await Kr(e,l,r,n);return t&&t.length?t:(r.warn(`${pe()} Not able to find the key ${u} for type ${F.MetadataType[s]}`,a),[])}catch(e){throw r.error(`${pe()} error retrieving metadata by query for ${u}. ${e.message}`,a),e}}function pe(e){return e?`[${e}]`:`[${s.FILE_PREFIX.RetrieveGenerator}]`}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */async function fe(e,t,r,n,a,o,s){const u=s.commonEventParameters||[];try{const u=await async function(e,t,r,n,a){const o=a.commonEventParameters||[];if(!await Object(_.isFeatureEnabled)(r,"EnableBPFOffline")||!t||Object(i.isNullOrUndefined)(e))return null;const s=await async function(e,t,r){const n={target:{entityLogicalName:"",id:M.Guid.EMPTY},processId:M.Guid.EMPTY,processInstanceId:M.Guid.EMPTY};if(Object(i.isNullOrUndefined)(e.url.match("/api/data/(.*)/RetrieveProcessControlData"))||-1===e.url.indexOf("?"))throw new Error("Incorrect BPF request url");const a=e.url.split(/\?(.+)/),o=a[0].match(/\/api\/data\/.*\/RetrieveProcessControlData\((.*)\)/);if(!o||o.length<2)throw new Error("Incorrect BPF request url");const s=o[1].split(","),u={};for(const e of s){const t=e.split("=");u[t[0]]=t[1]}const l=new URLSearchParams(a[1]),c=l.get(u.ProcessId);c&&(n.processId=M.Guid.tryParse(c));const d=l.get(u.ProcessInstanceId);d&&(n.processInstanceId=M.Guid.tryParse(d));const p=l.get(u.Target);if(p){const e=p.split(":")[1].match(/\"(.*)\((.*)\)\"/);e&&3===e.length&&(n.target.entityLogicalName=await Object(_.getEntityLogicalName)(t,e[1],r),n.target.id=M.Guid.tryParse(e[2]))}return n}(e,r,o),u=await async function(e,t,r,n){const a=n.commonEventParameters||[];if(Object(i.isNullOrUndefined)(e))return[];if(null!==e.processId&&!M.Guid.isNullOrEmpty(e.processId))try{const o=await async function(e,t,r,n){const a={MetadataType:"businessprocessflow",MetadataSubtype:null,EntityLogicalName:"workflow",MetadataId:e.guid,MetadataNames:[],GetDefault:!1,DependencyDepth:"OnDemandWithContext",ChangedAfter:null,Exclude:[],AppId:null,IsPreloadCall:!1};try{const o=await de(t,a,r,n)[0];let s=null;const u=o.data;return Object(i.isNullOrUndefined)(u)||Object(i.isNullOrUndefined)(u.BusinessProcessFlowUniqueName)||(s=u.BusinessProcessFlowUniqueName),r.info(`${me()} Successfully retrieve uniquename for BPF  ${e.guid}`),s}catch(e){return null}}(e.processId,r,t,n);return Object(i.isNullOrUndefinedOrEmptyString)(o)?(t.warn(`${me()} Unique name not found for ${e.processId}`,a),[]):[o]}catch(r){t.warn(`${me()} Error while retriving bpf unique names by process id ${e.processId}`,a)}if(Object(i.isNullOrUndefined)(e.target)||Object(i.isNullOrUndefinedOrEmptyString)(e.target))return t.warn(me()+" BPF request must have participating entity logical name",a),[];const o=function(e){return Object(i.isNullOrUndefined)(e.AdditionalParameters)||Object(i.isNullOrUndefined)(e.AdditionalParameters.AppId)?M.Guid.EMPTY:M.Guid.tryParse(e.AdditionalParameters.AppId)}(r),s={MetadataType:"bpfselector",MetadataSubtype:null,EntityLogicalName:e.target.entityLogicalName,MetadataId:null,MetadataNames:[],GetDefault:!1,DependencyDepth:"OnDemandWithContext",ChangedAfter:null,Exclude:[],AppId:o.guid,IsPreloadCall:!1},u=await de(r,s,t,n);if(Object(i.isNullOrUndefined)(u)||0===u.length)return[];const l=u[0].data;if(!Object(i.isNullOrUndefined)(l)&&l.SelectorItems){const r=l.SelectorItems;if(!Object(i.isNullOrUndefined)(r)&&r.length>0){const n=r.map(e=>e.UniqueName);return t.info(`${me()} Successfully retrieve all BPF uniquenames for participating entity ${e.target}`),n}}return[]}(s,n,r,a);if(Object(i.isNullOrUndefined)(u)||!u.length)return null;const l=[];null===s.processId||M.Guid.isNullOrEmpty(s.processId)||null===s.processInstanceId||M.Guid.isNullOrEmpty(s.processInstanceId)?u.forEach(e=>{l.push(ue(s.target,e,r,n,a)),n.info(`${me()}  'Retriev multiple BPF instances ${JSON.stringify(s)}`,o)}):(l.push(async function(e,t,r,n,a){const o=a.commonEventParameters||[],s="WHERE [businessprocessflowinstanceid]="+I.p.question,u=await le(t,s,[e.guid],n,a);if(!Object(i.isNullOrUndefined)(u.rows)&&u.rows.length>0)return r.info(`${pe()} data present for ${t}`,o),await ce(t,u.rows.item(0),n,o);return r.info(`${pe()} No BPF instance found for ${t}`,o),null}(s.processInstanceId,u[0],n,r,a)),n.info(`${me()} Retrieve BPF instance from ${u[0]} ${JSON.stringify(s)}`,o));try{const e=await Promise.all(l);let t=new Date("1700-01-01T00:00:00Z"),r={entityLogicalName:"",id:M.Guid.EMPTY,modifiedon:t,primaryIdAttribute:"",primaryIdValue:M.Guid.EMPTY};return e.forEach(e=>{if(null!==e){const n=e.modifiedon;(null===t||n>t)&&(r=e,t=n)}}),n.error(me()+" Successfully retrieved multiple BPF instances",o),r}catch(e){throw n.error(me()+" Error when attempting to retrieve global navigation data",o),e}}(r,!!n.IsBusinessProcessEnabled&&n.IsBusinessProcessEnabled,a,o,s),l=Object(i.isNullOrUndefined)(u)||M.Guid.isNullOrEmpty(u.id)?null:u.id,c=await async function(e,t,r,n,a){const o=[];if(!e)return r.info(me()+" processID is null in get business process flow control data"),o;const s=await async function(e,t,r,n,a,o){let s;if(M.Guid.isNullOrEmpty(e)){if(t&&r||n.error(me()+" The entityLogicalName must be either Workflow or participating entity name."),!await Object(_.isFeatureEnabled)(a,"EnableBPFOffline"))return Promise.resolve(null);s=async function(e,t,r,n){const a=n.commonEventParameters||[],o=(await async function(e,t,r){const n=r.commonEventParameters||[],a={MetadataType:"bpfselector",MetadataSubtype:null,EntityLogicalName:null,MetadataId:null,GetDefault:!1,DependencyDepth:"OnDemandWithoutContext",ChangedAfter:null,Exclude:[],MetadataNames:[],AppId:null,IsPreloadCall:!1},o=await de(t,a,e,r);if(Object(i.isNullOrUndefined)(o)||0===o.length)throw e.error(me()+" error when fetching bpf selector",n),new Error("error when fetching bpf selector");return o[0]}(t,r,n)).data;if(!o||!o.SelectorItems||!o.SelectorItems[0]||M.Guid.isNullOrEmpty(o.SelectorItems[0].Id))throw t.error(`${me()} unable to find default BPF step for ${e}`,a),new Error("Unable to find default bpf step for "+e);const s=o.SelectorItems[0].Id;return ye("workflow",s,t,r,n)}(t,n,a,o)}else s=ye(t="workflow",e,n,a,o);return await s}(e,t,M.Guid.EMPTY,r,n,a);if(Object(i.isNullOrUndefined)(s)||Object(i.isNullOrUndefined)(s.data))throw new Error("Retrieved empty BPF metadata for");const u=s.data;for(const e of u.BusinessProcessFlowEntities)if(e.EntityLogicalName===t)for(const t of e.Stage.Steps)Object(i.isNullOrUndefinedOrEmptyString)(t.Name)||o.push(t.Name);return o}(l,e,o,a,s);if(!Object(i.isNullOrUndefined)(c)&&c.length)for(const e of c)-1===t.indexOf(e)&&t.push(e);return u}catch(e){return o.error(`${me()} something went wrong when adding BPF columns ${e.message}`,u),null}}async function ye(e,t,r,n,a){const o=a.commonEventParameters||[],s={MetadataType:"businessprocessflow",MetadataSubtype:null,EntityLogicalName:null,MetadataId:t.guid,GetDefault:!1,DependencyDepth:"OnDemandWithoutContext",ChangedAfter:null,Exclude:[],MetadataNames:[],AppId:null,IsPreloadCall:!1},u=await de(n,s,r,a);if(Object(i.isNullOrUndefined)(u)||0===u.length)throw r.error(me()+" error when fetching bpf",o),new Error("error when fetching bpf");return u[0]}function me(e){return e?`[${e}]`:`[${s.FILE_PREFIX.RetrieveGenerator}]`}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */function he(e){return e?`[${e}]`:`[${s.FILE_PREFIX.RetrieveGenerator}]`}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */async function ge(e,t,r,a={},o){const s=a.commonEventParameters||[],u=await cn(e,t,r,s),l=dn(e.url,r,s);if(Object(i.isNullOrUndefined)(l)){const e=new Error("Retrieve Generator was unable to extract GUID from url");throw r.error(`${Te()} ${e.message}`,s),e}const c=await Object(_.getEntityMetadata)(t,u),d=await Object(_.getAttributeTypes)(t,[],u,s),p=await async function(e,t,r,n){const a=[];let o=[];if(Object(i.isNullOrUndefinedOrEmptyString)(e))throw r.error(he()+" Empty URL for retrieve request",n),new Error("Empty url for retrieve request");if(-1===e.indexOf("?"))r.info(he()+" No $select parameter. Returning all columns for entity",n);else{const t=new URLSearchParams(e.split(/\?(.+)/)[1]).get("$select");Object(i.isNullOrUndefinedOrEmptyString)(t)?r.info(he()+" No $select parameter. Returning all columns for entity",n):o=t.split(",")}o&&0!==o.length||r.info(he()+" No $select parameter. Returning all columns for entity",n);for(const e of o){const r=nn(e.trim());t[r]===T.AttributeType.Owner||t[r]===T.AttributeType.Lookup||t[r]===T.AttributeType.Customer?(a.push(r+L.columnDelimiter+L.id),a.push(r+L.columnDelimiter+L.name),a.push(r+L.columnDelimiter+L.logicalName)):a.push(r)}return r.info(`${he()} requested for ${a.length} columns`,n),a}(e.url,d,r,s);await function(e,t){if(Object(i.isNullOrUndefined)(t)||0===t.length)return t;const r=[e.PrimaryIdAttribute,e.PrimaryNameAttribute];for(const e of r)Object(i.isNullOrUndefined)(e)||-1!==t.indexOf(e)||t.push(e);return t}(c,p);let f=null;Object(i.isNullOrUndefined)(o)||(f=await fe(u,p,o,c,t,r,a));let y=await async function(e,t,r,n,a,o,s){const u={sqlStatements:[],sqlParameters:new Array,additionalParameters:{}},l=t.PrimaryIdAttribute,c=await Object(_.getAttributeTypes)(s,[],e,o);if(Object(i.isNullOrUndefinedOrEmptyString)(l))throw a.error(Te()+" Invalid parameters when generating RETRIEVE query",o),new Error("Invalid primary id attribute");let d="";d=Object(i.isNullOrUndefined)(n)||0===n.length?I.p.asterisk:n.map(e=>`[${ve(c,e)}]`).join(`${I.p.comma}${I.p.space}`);return u.sqlStatements.push(I.c.select+I.p.space+d+I.p.space+I.c.from+I.p.space+I.p.openSQBracket+e+I.p.closeSQBracket+I.p.space+I.c.where+I.p.space+I.p.openSQBracket+l+I.p.closeSQBracket+I.p.equal+I.p.space+I.p.question+I.p.space+I.c.collateNoCase),u.sqlParameters.push([r.guid]),u}(u,c,l,p,r,s,t);Object(i.isNullOrUndefined)(f)||(y=await async function(e,t){if(!Object(i.isNullOrUndefinedOrEmptyString)(e.entityLogicalName)){const r=`${I.c.select} ${I.p.asterisk} ${I.c.from} [${e.entityLogicalName}] ${I.c.where} [${e.primaryIdAttribute}]${I.p.equal}${I.c.placeholder}`;t.sqlStatements.push(r),t.sqlParameters.push([e.primaryIdValue.guid]),Object(i.isNullOrUndefined)(t.additionalParameters)&&(t.additionalParameters={}),t.additionalParameters.BPFEntityLogicalName=e.entityLogicalName,t.additionalParameters.BPFQueryIndex=t.sqlStatements.length-1}return t}(f,y)),c.IsActivity&&(y=await async function(e,t,r,n,a){let o=!1;const s={};for(const e in t)t[e]===T.AttributeType.PartyList&&(s[L.participationTypeValue[e]]=e,o=!0);if(!o)return n.warn(Te()+" Activity entity does not have party type attributes",a.commonEventParameters),r;n.info(`${Te()} Attempting to retrieve ${s.length} activity parties`,a.commonEventParameters);const u=[L.participationMasks,L.activityId+I.p.exclamation+L.id,L.activityId+I.p.exclamation+L.name,L.activityId+I.p.exclamation+L.logicalName,L.activityPartyId,L.partyId+I.p.exclamation+L.id,L.partyId+I.p.exclamation+L.name,L.partyId+I.p.exclamation+L.logicalName,L.isPartyDeleted,L.partyObjectTypeCode,L.addressUsed];return function(e,t,r,n,a,o){if(Object(i.isNullOrUndefined)(t)||0===t.length)return a.error(Te()+" Empty list of columns received. Not generating activity party query",o.commonEventParameters),n;let s="";for(let e=0;e<t.length;e++)s+=I.p.openSQBracket+t[e]+I.p.closeSQBracket+I.p.comma;s=s.substr(0,s.length-1);let u=`${I.c.placeholder}${I.p.comma}`.repeat(Object.keys(r).length);u=u.substr(0,u.length-1);const l=I.p.openSQBracket+L.activityId+L.columnDelimiter+L.id+I.p.closeSQBracket+I.p.equal+I.p.question+I.p.space+I.c.and+I.p.space+I.p.openSQBracket+L.participationMasks+I.p.closeSQBracket+I.p.space+I.c.in+I.p.space+I.p.openParenthesis+u+I.p.closeParenthesis,c=I.c.select+I.p.space+s+I.p.space+I.c.from+I.p.space+I.p.openSQBracket+L.activityParty+I.p.closeSQBracket+I.p.space+I.c.where+I.p.space+l+I.c.collateNoCase+I.p.space+I.c.orderBy+I.p.space+I.p.openSQBracket+L.participationMasks+I.p.closeSQBracket;n.sqlStatements.push(c),n.sqlParameters.push([e.guid.toString(),...Object.keys(r)]),Object(i.isNullOrUndefined)(n.additionalParameters)&&(n.additionalParameters={});return n.additionalParameters.ContainsActivityPartyQuery=!0,n.additionalParameters.ParticipationMasks=r,n.additionalParameters.ActivityPartyQueryIndex=n.sqlStatements.length-1,n}(e,u,s,r,n,a)}(l,d,y,r,a));const m=await async function(e,t,r){const n={};if(!e||-1===e.indexOf("?")||-1===e.indexOf("$expand"))return t.info(he()+" Url is empty or does not contain $expand parameter",r),n;const a=new URLSearchParams(e.split(/\?(.+)/)[1]).get("$expand");if(Object(i.isNullOrUndefinedOrEmptyString)(a))return n;const o=/([a-zA-Z0-9_]+)\(\$filter=Microsoft\.Dynamics\.CRM\.In\(PropertyName='([a-z0-9_,]+)',PropertyValues=\[(.*)\]\)\)?/,s=/([a-zA-Z0-9_\s]+)(\(\$select=([a-z0-9_,\s]+)\)?)/,u=/([a-zA-Z0-9_\s]+)/,l=a.split(/\)\s*,/gi).map(e=>e.trim());for(const e of l){let t=e.match(o);Object(i.isNullOrUndefined)(t)?(t=e.match(s)||e.match(u),Object(i.isNullOrUndefined)(t)||(t.length<3||Object(i.isNullOrUndefinedOrEmptyString)(t[3])?n[t[1]]={values:[],clause:I.c.select}:n[t[1]]={values:t[3].split(",").map(e=>e.trim()),clause:I.c.select})):n[t[1]]={values:t[3].split(",").map(e=>e.replace(/['"]+/g,"")),clause:I.c.in,propertyName:t[2]}}return n}(e.url,r,s);return Object.keys(m).length>0&&(y=await async function(e,t,r,a,o,s,u){if(Object.keys(r).length>0){Object(i.isNullOrUndefined)(a.additionalParameters)&&(a.additionalParameters={}),a.additionalParameters[n.EXPAND_PROPERTIES]=[],o.info(Te()+" Requested for expansions",s);for(const n in r)a=await Ee(e,n,r[n],t,a,u)}return a}(l,c,m,y,r,s,t)),y}async function Ee(e,t,r,n,a,o){Object(i.isNullOrUndefined)(a.additionalParameters)&&(a.additionalParameters={});let s=!1;if(n.OneToManyRelationships)for(const i in n.OneToManyRelationships){const u=n.OneToManyRelationships[i];u.ReferencedEntityNavigationPropertyName===t&&(s=!0,await be(u,e,t,r,n,a,o))}if(!s&&n.ManyToOneRelationships)for(const i in n.ManyToOneRelationships){const s=n.ManyToOneRelationships[i];s.ReferencingEntityNavigationPropertyName===t&&await Oe(s,e,t,r,n,a,o)}return a}async function be(e,t,r,a,o,s,u){Object(i.isNullOrUndefined)(s.additionalParameters)&&(s.additionalParameters={}),Object(i.isNullOrUndefined)(s.additionalParameters[n.EXPAND_PROPERTIES])&&(s.additionalParameters[n.EXPAND_PROPERTIES]=[]);const l=e.ReferencedAttribute,c=e.ReferencingAttribute,d=e.ReferencingEntity,p=await Object(_.getAttributeTypes)(u,[],d),f=ve(p,c),y={ExpandValueType:n.EXPAND_VALUES.MULTI_VALUE,ExpandPropertyName:r,ExpandQueryIndex:s.sqlStatements.length,ReferencedOrReferencingEntityName:d};if(s.additionalParameters[n.EXPAND_PROPERTIES].push(y),a.clause===I.c.select){let e="*";if(a.values.length>0){const t=(await Object(_.getEntityMetadata)(u,d)).PrimaryIdAttribute;t&&a.values.push(t),d===n.FILE_ATTACHMENT&&a.values.push(n.DEVICE_FILE_PATH),e=a.values.map(e=>`[${ve(p,e)}]`).join(",")}s.sqlStatements.push(`SELECT ${e} FROM [${d}] WHERE [${f}] = (SELECT [${l}] FROM [${o.EntityLogicalName}] WHERE [${o.PrimaryIdAttribute}]=?)`),s.sqlParameters.push([t.guid])}else if(a.clause===I.c.in){let e="?,".repeat(a.values.length);e=e.substring(0,e.length-1),s.sqlStatements.push(`SELECT * FROM [${d}] WHERE [${a.propertyName}] IN (${e}) AND [${f}]=(SELECT [${l}] FROM [${o.EntityLogicalName}] WHERE [${o.PrimaryIdAttribute}]=?)`),s.sqlParameters.push([...a.values,t.guid])}}async function Oe(e,t,r,a,o,s,u){Object(i.isNullOrUndefined)(s.additionalParameters)&&(s.additionalParameters={}),Object(i.isNullOrUndefined)(s.additionalParameters[n.EXPAND_PROPERTIES])&&(s.additionalParameters[n.EXPAND_PROPERTIES]=[]);const l=e.ReferencedAttribute,c=e.ReferencingAttribute,d=e.ReferencedEntity,p=e.ReferencingEntity,f=await Object(_.getAttributeTypes)(u,[],d),y=await Object(_.getAttributeTypes)(u,[],p),m=ve(f,l),h=ve(y,c),g={ExpandValueType:n.EXPAND_VALUES.SINGLE_VALUE,ExpandPropertyName:r,ExpandQueryIndex:s.sqlStatements.length,ReferencedOrReferencingEntityName:d};if(s.additionalParameters[n.EXPAND_PROPERTIES].push(g),a.clause===I.c.select){let e="*";if(a.values.length>0){const t=(await Object(_.getEntityMetadata)(u,d)).PrimaryIdAttribute;t&&a.values.push(t),d===n.IMAGE_DESCRIPTOR?(a.values.push(n.DEVICE_FILE_PATH),a.values.push(n.DEVICE_THUMBNAIL_PATH),e=a.values.map(e=>`${n.IMAGE_DESCRIPTOR}.[${ve(f,e)}]`).join(","),e=`${e},${n.FILE_ATTACHMENT}.[${n.FILE_NAME}]`):e=a.values.map(e=>`[${ve(f,e)}]`).join(",")}d===n.IMAGE_DESCRIPTOR?s.sqlStatements.push(`SELECT ${e} FROM [${d}] JOIN [${n.FILE_ATTACHMENT}] on ${n.IMAGE_DESCRIPTOR}.${n.IMAGE_DESCRIPTOR_ID} = ${n.FILE_ATTACHMENT}.[objectid!id] WHERE [${m}] = (SELECT [${c}] FROM [${o.EntityLogicalName}] WHERE [${o.PrimaryIdAttribute}]=?)`):s.sqlStatements.push(`SELECT ${e} FROM [${d}] WHERE [${m}] = (SELECT [${h}] FROM [${o.EntityLogicalName}] WHERE [${o.PrimaryIdAttribute}]=?)`),s.sqlParameters.push([t.guid])}else if(a.clause===I.c.in){let e="?,".repeat(a.values.length);e=e.substring(0,e.length-1),s.sqlStatements.push(`SELECT * FROM [${d}] WHERE [${m}] = (SELECT [${h}] FROM [${o.EntityLogicalName}] WHERE [${o.PrimaryIdAttribute}]=?) AND [${a.propertyName}] IN (${e})`),s.sqlParameters.push([t.guid,...a.values])}}function ve(e,t){const r=nn(t),n=e[r];return n===T.AttributeType.Owner||n===T.AttributeType.Lookup||n===T.AttributeType.Customer?`${r}${L.columnDelimiter}${L.id}`:r}function _e(e,t,r,n,a,i){const o={sqlStatements:[],sqlParameters:new Array(e),additionalParameters:{}};try{const a=[r,n];o.sqlStatements.push(function(e,t,r,n){let a="",i="";for(let e=0;e<t.length;e++){a+=`${e>0?I.p.comma:""}[${t[e]}]`}for(let t=0;t<e;t++){i+=`${t>0?" OR":""}[${n}] = ? COLLATE NOCASE`}return`SELECT ${a} FROM ${r} WHERE ${i}`}(e.length,a,t,r))}catch(r){a.warn(`${Te()} Unable to retrieve lookup data with error ${r} for entity ${t} with ids: \n ${e}`,i)}return o}function Te(e){return e?`[${e}]`:`[${s.FILE_PREFIX.RetrieveGenerator}]`}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */async function Se(e,t,r,a={}){const i=Object(x.a)(e,r,a.commonEventParameters);return function(e,t){for(const r of e){if(Object(u.getRequestType)(r,t)===n.OPERATION.Retrieve)return!0}return!1}(i,t)?(r.info(Ce+" found batch retrieve request"),[await Ne(i,r,t,a)]):await async function(e,t,r,n){const a=[];for(let t=0;t<e.length;t++){const i={requestType:n.requestType,commonEventParameters:n.commonEventParameters,performanceControl:n.performanceControl,internalRequest:n.internalRequest,clientRequestId:n.clientRequestId||""};a.push(Hr(e[t],r,i))}return Promise.all(a)}(i,0,t,a)}async function Ne(e,t,r,n){const a=e&&e.length>0?e[0]:void 0,i=e&&e.length>1?e[1]:void 0;if(!a)throw t.error(Ce+" Unsupported Retrieve request. MDL offline only supports retrieve+bpf request"),new Error("Unsupported offline batch request");return ge(a,r,t,n,i)}function Ce(e){return e?`[${e}]`:`[${s.FILE_PREFIX.BatchGenerator}]`}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */async function Pe(e,t,r,a={}){const o=a.commonEventParameters||[],s=await cn(e,t,r,o),u=await Object(_.getAttributeTypes)(t,[],s,o),l=await pn(e.body,u,s,t,r,o);return async function(e,t,r,a,i=[]){let o=function(e){const t={sqlStatements:[],sqlParameters:new Array,additionalParameters:{[n.ADDITIONAL_PARAMETERS.RecordId]:e.id.guid.toString()}};let r="",a="";const i=[];let o=0;for(const t in e.values)if(t){const n=o>0?",":"";r+=n+"["+t+"]",a+=n+"?",i.push(e.values[t]),o+=1}return t.sqlStatements.push(I.c.insert+I.p.space+I.c.into+I.p.space+I.p.openSQBracket+e.entityLogicalName+I.p.closeSQBracket+I.p.space+I.p.openParenthesis+r+I.p.closeParenthesis+I.p.space+I.c.values+I.p.space+I.p.openParenthesis+a+I.p.closeParenthesis),t.sqlParameters.push(i),t}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */(r);const s=await Object(_.getEntityMetadata)(t,a);s.IsActivity&&(o=await gn(t,r,o,i));s&&e&&e.additionalHeaders&&e.additionalHeaders.Prefer&&-1!==e.additionalHeaders.Prefer.indexOf(n.HEADER_VALUES.PREFER_REPRESENTATION)&&(o=hn(t,o,a,r.id,s.PrimaryIdAttribute,i));return o}(e,t,await
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
async function(e,t,r,n,a,o,s={}){const u=await Object(_.getAttributeTypes)(n,[],e,o),l=await async function(e,t,r,n=[]){const a={},o=await Object(_.getAttributesMetadata)(r,e,t,n);for(const e in o){if(Object(i.isNullOrUndefined)(o[e]))continue;const t=o[e];if(t.Type!==T.AttributeType.Boolean||Object(i.isNullOrUndefined)(t.DefaultValue)){if(t.Type===T.AttributeType.PickList&&!Object(i.isNullOrUndefined)(t.DefaultFormValue)){const e=t.DefaultFormValue;-1!==e&&(a[t.LogicalName]=e)}}else t.DefaultValue?a[t.LogicalName]=1:a[t.LogicalName]=0}return a}(e,[],n,o);let c={id:M.Guid.EMPTY,entityLogicalName:e,attributeTypes:u,values:l};c=await rn(c,t,u,r,n,a,o,s);const d=await Object(_.getEntityMetadata)(n,e);if(c=await sn(n,c,d,r,o,s),e===I.a&&r===I.v.create&&Object.keys(c.values).indexOf(L.objectId)>=0){const e=c.values[L.objectId];Object(i.isNullOrUndefined)(e)||(c.values[L.objectTypeCode]=e)}if(c.values[L.versionNumber]="0",r===I.v.create){if(!d.PrimaryIdAttribute){const e="entity metadata does not have primary id attribute";throw a.error(`${En()} ${e}`,o),new Error(e)}d.PrimaryIdAttribute in c.values||(c.values[d.PrimaryIdAttribute]=M.Guid.newGuid().guid),c.id=new M.Guid(c.values[d.PrimaryIdAttribute]),!Object(i.isNullOrUndefined)(d)&&d.IsActivity&&(Object(i.isNullOrUndefined)(c.activityParties)&&(c.activityParties=[]),c.activityParties.push({partyId:await Object(_.getUserId)(n,o),partyName:await Object(_.getUserName)(n,o),partyLogicalName:L.systemUser,participationType:L.participationTypeValue.owner}))}return c}(s,l,I.v.create,t,r,o,a),s,o)}function Re(e,t,r,n,o=[]){const u=[];if(u.push({name:"logicalName",value:e}),u.push({name:"attribute",value:t}),Object(i.isNullOrUndefinedOrEmptyString)(e)||Object(i.isNullOrUndefinedOrEmptyString)(t))throw n.error(`${l?`[${l}]`:`[${s.FILE_PREFIX.SQLModifier}]`} ${I.g.invalidParameter}`,Object(a.b)(o,u)),new Error(I.g.invalidParameter);var l;
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */return I.c.select+I.p.space+I.p.openSQBracket+t+I.p.closeSQBracket+I.p.space+I.c.from+I.p.space+I.p.openSQBracket+e+I.p.closeSQBracket+I.p.space+I.c.where+I.p.space+I.p.openSQBracket+t+I.p.closeSQBracket+I.p.space+I.p.equal+I.p.space+I.p.question+I.p.space+I.c.collateNoCase}class we{constructor(e){this.alphaNumericRegex=new RegExp("[a-zA-Z1-9]","g"),this.whiteSpaceRegex=I.x,this.text=e,this.textLength=e.length,this.textPosition=0,this.currentchar=this.textPosition<this.textLength?this.text.charAt(this.textPosition):"\0",this.token={text:"",position:0,kind:0}}nextToken(){return this.NextTokenImplementation()}NextTokenImplementation(){this.skipWhiteSpace();const e=this.textPosition;return this.token.kind=this.getExpressionTokenKind(),this.token.text=this.text.substr(e,this.textPosition-e),this.token.position=e,this.token}isValidWhiteSpace(){const e=this.currentchar.toString().match(this.whiteSpaceRegex);return!("\0"===this.currentchar||!e||e.length<0)}getPosition(){return this.token.position}getToken(){return this.token}isValidCharForIdentifier(){const e=this.currentchar.toString().match(this.alphaNumericRegex);return"\0"!==this.currentchar&&(!Object(i.isNullOrUndefinedOrEmptyString)(e)&&1===e.length||"_"===this.currentchar||"$"===this.currentchar)}skipWhiteSpace(){for(;this.isValidWhiteSpace();)this.nextChar()}getExpressionTokenKind(){let e=0;switch(this.currentchar){case I.p.openParenthesis:this.nextChar(),e=Me.openParenthesis;break;case I.p.closeParenthesis:this.nextChar(),e=Me.closeParenthesis;break;case I.p.comma:this.nextChar(),e=Me.comma;break;default:if(this.isValidWhiteSpace()){this.skipWhiteSpace(),e=0;break}if(this.isValidCharForIdentifier()){this.parseIdentifier(),e=Me.identifier;break}if(this.textPosition===this.textLength){e=Me.end;break}throw new Error("Unknown CharacterType Received")}return e}nextChar(){this.textPosition<this.textLength&&this.textPosition++,this.currentchar=this.textPosition===this.textLength?"\0":this.text.charAt(this.textPosition)}parseIdentifier(){do{this.nextChar()}while(this.isValidCharForIdentifier())}advanceThroughBalancedParentheticalExpression(){const e=this.getPosition();this.advanceThroughBalancedExpression(I.p.openParenthesis,I.p.closeParenthesis);return this.text.substr(e,this.textPosition-e)}advanceThroughBalancedExpression(e,t){let r=1;for(;r>0;)this.currentchar===e?r++:this.currentchar===t&&r--,this.nextChar()}}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */var Me;!function(e){e[e.unknown=0]="unknown",e[e.end=1]="end",e[e.equal=2]="equal",e[e.openParenthesis=3]="openParenthesis",e[e.closeParenthesis=4]="closeParenthesis",e[e.comma=5]="comma",e[e.question=6]="question",e[e.identifier=7]="identifier"}(Me||(Me={}));class Ie{constructor(e){this.lexer=e}parseTerm(){const e=this.lexer.getToken().text;return this.lexer.nextToken(),e}}function Ae(e,t,r=[],n){const a=new Ie(e).parseTerm();if(Object(i.isNullOrUndefinedOrEmpty)(a)){const e=`property ${a} with value Relationship name is undefined`;throw t.error(`${Le()} ${e}`,r),new Error(e)}let o=null;return e.getToken().kind===Me.openParenthesis&&(o=e.advanceThroughBalancedParentheticalExpression(),e.nextToken()),function(e,t,r,n=[],a){Object(i.isNullOrUndefinedOrEmptyString)(t)||(t=(t=function(e){const t=e.startsWith("("),r=e.endsWith(")");return t&&(e=e.substring(1,e.length)),r&&(e=e.substring(0,e.length-1)),e.trim()}(t=t.replace(I.x,""))).startsWith(I.p.question)?t:`${I.p.question}${t}`);const o=Fe(t,r,n,a),s={navigationProperty:e};for(const e in o)if(e===Ue.select)s.selectOption=ln(o[Ue.select]);else{const t=`Query option ${o[e]} is not supported within $expand of Client API OData Query request`;r.warn(`${Le()} ${t}`,n)}return s}(a,o,t,r,n)}function De(e){let t="$expand="+e.navigationProperty;return e.selectOption&&!Object(i.isNullOrUndefinedOrEmpty)(e.selectOption)&&(t+=`($select=${e.selectOption.join(",")})`),t}function Le(e){return e?`[${e}]`:`[${s.FILE_PREFIX.ExpandParser}]`}const Ue={skipToken:"$skiptoken",orderBy:"$orderby",top:"$top",select:"$select",expand:"$expand",filter:"$filter",oDataNextLink:"@odata.nextLink",getOnlyRelatedEntity:"$getOnlyRelatedEntity",savedQuery:"savedQuery"};function Fe(e,t,r,n){const a={};if(Object(i.isNullOrUndefinedOrEmptyString)(e)){const e="Unable to process OData query to hint with undefined or empty query";return t.warn(`${ke()} ${e}`,r),a}let o,s,u=1;for(;u<e.length;){if(o=n?e.indexOf("&$",u):e.indexOf("&",u),-1===o&&(o=e.length),s=e.indexOf("=",u),s>o&&(s=-1),-1!==s&&s<o){const n=e.substr(u,s-u),i=e.substr(s+1,o-s-1);n in a?t.warn(`${ke()} Multiple occurrence of ${n} option found in uri input, therefore skip adding duplication key`,r):a[n]=i}u=o+1}return a}function xe(e,t,r,n){const a=Fe(e,t,r,n),i={};if(a)a[Ue.expand]&&(i.expand=function(e,t,r=[],n){const a=[],i=new we(e);if(i.nextToken(),i.getToken().kind===Me.end)throw new Error("'Invalid Expand Expression passed");for(a.push(Ae(i,t,r,n));i.getToken().kind===Me.comma&&(i.nextToken(),i.getToken().kind!==Me.end);)a.push(Ae(i,t,r,n));if(i.getToken().kind!==Me.end)throw new Error("Improper Expand string provided");return a}(a[Ue.expand],t,r,n)),a[Ue.select]&&(i.select=ln(a[Ue.select]).join(",")),a[Ue.orderBy]&&(i.orderBy=ln(a[Ue.orderBy]).join(",")),a[Ue.top]&&(i.top=a[Ue.top]),a[Ue.filter]&&(i.filter=a[Ue.filter]),a[Ue.skipToken]&&(i.pageNumber=a[Ue.skipToken]),a[Ue.savedQuery]&&(i.viewId=a[Ue.savedQuery]);else{const e="No odata query tokens passed via ODataURI";t.warn(`${ke()} ${e}`,r)}return i.select||(i.select="*"),i}function ke(e){return e?`[${e}]`:`[${s.FILE_PREFIX.ODataQueryParser}]`}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */class je{constructor(e,t){this._filterExpressionId="",this._filterOperator=0,this._conditions=[],this._filterExpressions=[],this.setFilterOperator(e),this.setFilterExpressionId(t),this.setFilterExpressions([])}getFilterExpressionId(){return this._filterExpressionId}setFilterExpressionId(e){return this._filterExpressionId=e,e}getFilterOperator(){return this._filterOperator}setFilterOperator(e){return this._filterOperator=e,e}getConditions(){return this._conditions}setConditions(e){return this._conditions=e,e}getFilterExpressions(){return this._filterExpressions}setFilterExpressions(e){return this._filterExpressions=e,e}addCondition(e,t,r,n){const a={attributeName:e,operator:t,value:r=Object(i.isNullOrUndefined)(r)?null:r,entityName:n};return this.getConditions()||this.setConditions([]),this.getConditions().push(a),this}addFilterExpression(e){return e?(this.getFilterExpressions().push(e),this):this}}function qe(e){return 0===e.getFilterExpressions().length}var Be,$e,Ve=r("M2g1");
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */function He(e,t){var r;if(!Object(i.isNullOrUndefined)(e)&&!Object(i.isNullOrUndefined)(e.attributes)){const n=e.attributes.getNamedItem(t);if(!Object(i.isNullOrUndefined)(n))return null!==(r=null==n?void 0:n.nodeValue)&&void 0!==r?r:""}return""}function Ge(e,t,r,n,a){const o=He(e,$e.name),s=He(e,$e.from),u=He(e,$e.to),l=He(e,$e.alias),c=function(e,t,r,n){const a=Ke(e);return a.linkToAttribute="",a.linkFromAttribute="",a.conditionOperator="",a.entityName=t,a.attributes=new Array(0),a.attributesByName={},a.orderByAttributes=new Array(0),a.groupByAttributes=new Array(0),a.aggregateAttributes=new Array(0),a.linkedEntities=new Array(0),a.parentEntity=r,r&&(a.baseEntity=r.baseEntity,a.tableAlias=ze(a,a.entityName),a.joinType=Object(i.isNullOrUndefined)(n)?Ve.JoinType.inner:n),a}(r,o,t);return function(e,t,r,n,a,i){e.linkFromAttribute=t,e.linkToAttribute=r,e.conditionOperator=n,e.joinType=a,e.alias=i}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */(c,s,u,Ve.ConditionalOperator.equal,function(e,t,r){const n=He(e,$e.linkType);if(!n)return Ve.JoinType.inner;switch(n){case Ve.JoinType[Ve.JoinType.natural]:return Ve.JoinType.natural;case Ve.JoinType[Ve.JoinType.inner]:return Ve.JoinType.inner;case Ve.JoinType[Ve.JoinType.outer]:return Ve.JoinType.outer;case Ve.JoinType[Ve.JoinType.matchfirstrowusingcrossapply]:return Ve.JoinType.matchfirstrowusingcrossapply;case Ve.JoinType[Ve.JoinType.exists]:return Ve.JoinType.exists;case Ve.JoinType[Ve.JoinType.in]:return Ve.JoinType.in;default:const e="Invalid join type";throw t.error(`${Ye()} ${e}`,r),new v.a(e)}}(e,n,a),l),Xe(e,c,r,n,a),c}function Qe(e,t,r,n){var a,o;const s=e.childNodes;for(let e=0;e<s.length;e++){const u=s[e];if(Object(i.isNullOrUndefined)(u.tagName))continue;const l=u.tagName.toLocaleLowerCase();switch(l){case Be.filter:const e=He(u,$e.type);let s;switch(e&&e.toLowerCase()){case Ve.LogicalOperatorString.and:s=Ve.LogicalOperator.and;break;case Ve.LogicalOperatorString.or:s=Ve.LogicalOperator.or;break;case Ve.LogicalOperatorString.not:s=Ve.LogicalOperator.not;break;default:const t="Unsupported filter operator: "+e;throw r.error(`${Ye()} ${t}`,n),new v.a(t)}let c=new je(s,"tempValue");c=Qe(u,c,r,n),t.addFilterExpression(c);break;case Be.condition:const d=He(u,$e.attribute),p=He(u,$e.operator),f=He(u,$e.value),y=He(u,$e.uitype);if(Object(i.isNullOrUndefinedOrEmptyString)(f)){const e=u.childNodes;if(e.length>0){const r=[];for(let t=0;t<e.length;t++){const n=e[t];Object(i.isNullOrUndefined)(null===(a=null==n?void 0:n.firstChild)||void 0===a?void 0:a.nodeValue)||r.push(null===(o=null==n?void 0:n.firstChild)||void 0===o?void 0:o.nodeValue)}t.addCondition(d,p,r,y)}else t.addCondition(d,p,void 0,y)}else t.addCondition(d,p,f);break;default:const m="Unsupported filter node name: "+l;throw r.error(`${Ye()} ${m}`,n),new v.a(m)}}return t}function Xe(e,t,r,n,a){var o;t.hasAggregate="true"===He(e,$e.aggregate);const s=He(e,$e.count);s&&r.Formatter&&(t.count=r.Formatter.parseIntegerValue(s));const u=He(e,$e.page);u&&r.Formatter&&(t.pageNumber=null!==(o=r.Formatter.parseIntegerValue(u))&&void 0!==o?o:t.pageNumber);const l=He(e,$e.top);if(l&&r.Formatter&&(t.top=r.Formatter.parseIntegerValue(l)),t.top&&t.count){const e="Providing both count and top in the fetchXml is invalid";throw n.error(`${Ye()} ${e}`,a),new v.a(e)}const c=null==e?void 0:e.getElementsByTagName(Be.entity);let d=c&&c[0];if(Object(i.isNullOrUndefined)(d)&&e.tagName===Be.linkEntity&&(d=e),Object(i.isNullOrUndefined)(t.parentEntity)){const e=He(c[0],$e.name);t.tableAliasCount=0,t.tableAliases=[],t.tableAlias=ze(t,e),t.baseEntity=t}!function(e,t,r,n){t.entityName=He(e,$e.name);const a=e.childNodes;for(let e=0;e<a.length;e++){const o=a[e];if(Object(i.isNullOrUndefined)(o.tagName))continue;const s=o.tagName.toLocaleLowerCase();switch(s){case Be.attribute:const e=He(o,$e.name),a=He(o,$e.alias),i={name:e,entity:t};t.attributesByName[a||e]=i,t.attributes.push(i);He(o,$e.aggregate)&&(t.aggregateAttributes[t.aggregateAttributes.length]=i);const u=He(o,$e.groupby);u&&"true"===u&&(t.groupByAttributes[t.groupByAttributes.length]=i);break;case Be.allAttributes:t.allAttributesRequested=!0;break;case Be.order:const l=He(o,$e.attribute),c=He(o,$e.descending),d={name:l,descending:!!c&&"true"===c,entity:t};t.orderByAttributes.push(d);break;case Be.linkEntity:t.linkedEntities.push(Ge(o,t,t.applicationContext,r,n));break;case Be.filter:const p=He(o,$e.type),f=p&&p.toLowerCase()===Ve.LogicalOperatorString.or?Ve.LogicalOperator.or:Ve.LogicalOperator.and;t.filterExpression=new je(f,t.entityName),t.filterExpression=Qe(o,t.filterExpression,r,n);break;default:const y="Unsupported node type for fetch xml: "+s;throw r.error(`${Ye()} ${y}`,n),new v.a(y)}}}(d,t,n,a)}function We(e,t,r,a){const i=function(e){return(new DOMParser).parseFromString(e,"text/xml")}(e);if(!i)throw r.error(Ye()+" Invalid fetch XML",a),new v.a("Invalid fetch XML");const o=i.getElementsByTagName(Be.parsererror);if(o&&o.length>0){const e="Invalid fetch XML - XML parsing error.";throw r.error(`${Ye()} ${e}`,a),new v.a(e,n.ErrorCode.InvalidXml)}const s=i.getElementsByTagName(Be.fetch);if(s&&s.length>1){const e="Invalid fetch XML - more than one fetch node.";throw r.error(`${Ye()} ${e}`,a),new v.a(e)}if(!s||0===s.length){const e="Invalid fetch XML - no fetch node.";throw r.error(`${Ye()} ${e}`,a),new v.a(e)}t.fetchXmlDoc=s[0],Xe(t.fetchXmlDoc,t,t.applicationContext,r,a)}function ze(e,t){if(!Object(i.isNullOrUndefinedOrEmptyString)(t)){const r=`${t}${e.tableAliasCount++}`;return e.tableAliases.push(r),r}return""}function Ye(e){return e?`[${e}]`:`[${s.FILE_PREFIX.FetchXmlParser}]`}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */!function(e){e.fetch="fetch",e.entity="entity",e.linkEntity="link-entity",e.attribute="attribute",e.allAttributes="all-attributes",e.order="order",e.filter="filter",e.condition="condition",e.parsererror="parsererror"}(Be||(Be={})),function(e){e.aggregate="aggregate",e.name="name",e.attribute="attribute",e.alias="alias",e.count="count",e.page="page",e.top="top",e.from="from",e.to="to",e.linkType="link-type",e.groupby="groupby",e.descending="descending",e.type="type",e.operator="operator",e.value="value",e.uitype="uitype"}($e||($e={}));function Ke(e,t,r,n){const a={pageNumber:1,entityName:null!=t?t:"",tableAliasCount:0,tableAliases:[],attributes:new Array(0),attributesByName:{},allAttributesRequested:!1,orderByAttributes:new Array(0),groupByAttributes:new Array(0),aggregateAttributes:new Array(0),linkedEntities:new Array(0),alias:"",parentEntity:r,applicationContext:e,useLimitStatement:!0};return a.tableAlias=ze(a,null!=t?t:""),r?(a.baseEntity=r.baseEntity,a.joinType=Object(i.isNullOrUndefined)(n)?Ve.JoinType.inner:n):a.baseEntity=a,a}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */var Je,Ze;async function et(e,t,r,n,a=[]){const i=await async function(e,t,r,n=[]){const a=await Object(_.getEntityMetadata)(e,t);if(!a||!a.OneToManyRelationships)return null;return a.OneToManyRelationships}(e,t,0,a);return i&&i[r]?i[r]:null}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
async function tt(e,t,r,n,a){try{if(!e)return null==n||n.warn(rt()+" Entity logical name is empty. Can not check for attributes",a),!1;const i=(await Object(_.getEntityMetadata)(r,e)).AttributeNames,o=t.filter(e=>!i.includes(e));if((null==o?void 0:o.length)>0){const t=`Requested attributes ${o.join(",")} not present on entity ${e}`;return null==n||n.warn(`${rt()} ${t}`,a),a.push({name:s.EVENT_PARAMETERS.ERROR_DETAIL,value:t}),!1}}catch(e){null==n||n.warn(rt()+" Error when checking for attribute validity. Returning true",a)}return!0}function rt(e){return e?`[${e}]`:`[${s.FILE_PREFIX.Validator}]`}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */async function nt(e,t,r,a,o,s){const u=s?s.commonEventParameters:[],l=e.url;let c,d,p;if(-1===l.indexOf(I.p.question)&&o.warn(pt()+" Request URL does not contain FetchXML nor ODataQuery",u),-1!==e.url.indexOf(n.FETCH_PREFIX)){p=function(e,t,r,n,a=[]){if(Object(i.isNullOrUndefinedOrEmptyString)(e)){const e="FetchXml string is empty or null";throw n.error(`${pt()} ${e}`,a),new v.a(e)}const o=Ke(r);try{We(e,o,n,a)}catch(e){const t="Exception in creating the entity query expression from fetchXml";throw n.error(`${pt()} ${t}: ${Object(i.getErrorMessage)(e)}`,a),new v.a((null==e?void 0:e.message)?e.message:t,null==e?void 0:e.code,null==e?void 0:e.stack,null==e?void 0:e.name)}if(t!==o.entityName){const e="Request URL entity name does not match fetchXml entity name";throw n.error(`${pt()} ${e}`,a),new v.a(e)}return o}(decodeURIComponent(l.substring(l.indexOf(n.FETCH_PREFIX)+n.FETCH_PREFIX.length,l.length)),t,a,o,u),c=await async function(e,t,r,n){var a;if(await Object(_.isFeatureEnabled)(t,I.h.ModernDataLayerRMValidations)){if(!await st(e,t,r,n)){const e=new Error("One or more requested attributes is invalid. Check event context for more details");throw r.error(`${pt()} ${e.message}`,n),e}}let o,s,u;o=e.allAttributesRequested||!e.attributes||0===e.attributes.length?I.p.asterisk:e.attributes.map(e=>e.name).toString();(null===(a=e.orderByAttributes)||void 0===a?void 0:a.length)>0&&(s=e.orderByAttributes.map(e=>`${e.name} ${e.descending?I.s.DESC:I.s.ASC}`).toString());e.filterExpression&&(u=ot(e.filterExpression,r,n));const l={select:o,orderBy:s,filter:u,pageNumber:e.pageNumber,top:e.top,count:e.count},c=[];await async function e(t,r,n,a,o,s){var u,l;const c=(null===(u=t)||void 0===u?void 0:u.alias)||t.entityName+"0";if((null===(l=t.linkedEntities)||void 0===l?void 0:l.length)>0)for(let u=0;u<t.linkedEntities.length;u++){const l=t.linkedEntities[u],{relationshipName:d,roleOrdinal:p,entityNameForHint:f}=await dt(a,t.entityName||"",l.entityName||"",l.linkFromAttribute||"",l.linkToAttribute||"",o,s);Object(i.isNullOrUndefinedOrEmptyString)(l.alias)&&(l.alias=`${l.entityName}${n.length+1}`);const y=[];for(const e of l.attributes){!!l.entityName&&await bn(a,l.entityName,e.name,o,s)||y.push(`${l.alias}.${e.name}`)}y.length>0&&(r.select=`${r.select},${y.toString()}`);const m=[];for(const e of l.orderByAttributes){!!l.entityName&&await bn(a,l.entityName,e.name,o,s)||m.push(`${l.alias}.${e.name} ${e.descending?I.s.DESC:I.s.ASC}`)}m.length>0&&(r.orderBy=`${r.orderBy},${m.toString()}`);let h="";l.filterExpression&&(h=ot(l.filterExpression,o,s)),h?n.push(`${f} ${c} ${d} ${p} ${l.alias} ${Ve.JoinType[l.joinType]} (${h})`):n.push(`${f} ${c} ${d} ${p} ${l.alias} ${Ve.JoinType[l.joinType]}`),await e(l,r,n,a,o,s)}}(e,l,c,t,r,n),c.length>0&&(l.linkEntity=c.join(";"));return l}(p,a,o,u)}else d=I.p.question,-1!==l.indexOf(I.p.question)?await Object(_.isFeatureEnabled)(a,I.h.CustomPageOffline)?(d=l.substring(l.indexOf(I.p.question),l.length),d=d.indexOf(I.p.plus)>-1&&d.indexOf(encodeURIComponent(I.p.dollar))>-1?decodeURIComponent(d.replace(/\+/g," ")):decodeURIComponent(d)):d=decodeURIComponent(l.substring(l.indexOf(I.p.question),l.length)):o.warn(pt()+" No ODataQuery part found in client api retrieve multiple request for OData query, Default query to '?'",u),r[n.ADDITIONAL_PARAMETERS.ODataQuery]=d,c=xe(d,o,u,Object(i.isUpsyncRequest)(e));!function(e,t,r){const n=5e3;let a;const o=Object(i.getMaxPageSizeFromPrefer)(t);o?(e.maxPageSize=o,a=o<n?o:n):a=n;if(r&&e.top&&e.top<a)a=e.top;else if(!r&&Object(i.isNullOrUndefined)(o)){const t=e.count&&e.count<n?e.count:n;a=e.top&&t>e.top?e.top:t}e.pageSize=a}(c,e,!!d),function(e,t,r,a){if(!t||!t.additionalHeaders)return void r.warn(pt()+" Unable to add hints to client api request with null header ",a);e.select&&(t.additionalHeaders[n.HINT.select]=e.select);e.orderBy&&(t.additionalHeaders[n.HINT.orderBy]=e.orderBy);e.filter&&(t.additionalHeaders[n.HINT.filter]=e.filter);e.linkEntity&&(t.additionalHeaders[n.HINT.linkEntity]=e.linkEntity,t.additionalHeaders[n.HINT.contextFilter]&&delete t.additionalHeaders[n.HINT.contextFilter]);e.pageNumber&&(t.additionalHeaders[n.HINT.pageNumber]=e.pageNumber.toString());e.pageSize&&(t.additionalHeaders[n.HINT.pageSize]=e.pageSize.toString());e.viewId&&(t.additionalHeaders[n.HINT.viewId]=e.viewId)}(c,e,o,u),function(e,t){e.top&&(t[n.ADDITIONAL_PARAMETERS.Top]=e.top);e.expand&&(t[n.ADDITIONAL_PARAMETERS.Expand]=e.expand);e.maxPageSize&&(t[n.ADDITIONAL_PARAMETERS.MaxPageSize]=e.maxPageSize)}(c,r)}function at(e,t,r,n){if(-1!==e.indexOf(I.p.question)){return xe(decodeURIComponent(e.substring(e.indexOf(I.p.question),e.length)),t,r,n)}return{}}function it(e){let t="";return t=e.value?`${e.attributeName} ${e.operator} '${e.value}'`:`${e.attributeName} ${e.operator}`,t}function ot(e,t,r){let n="";if(!e)return"";const a=e.getConditions();(null==a?void 0:a.length)>0&&(n=function(e,t,r,n){let a="";if(1===e.length)return a=it(e[0]),t===Ve.LogicalOperator.not&&(a=`${Ve.LogicalOperator[Ve.LogicalOperator.not]} (${a})`),a;if(e.length>1){a=it(e[0]);for(let r=1;r<e.length;r++){const n=it(e[r]);a=`${a} ${Ve.LogicalOperator[t]} ${n}`}return a}if(0===e.length){const e="No values for condition";throw r.error(`${pt()} ${e}`,n),new v.a(e)}return a}(a,e.getFilterOperator(),t,r));const o=e.getFilterExpressions(),s=Ve.LogicalOperator[e.getFilterOperator()];if(!o||0===o.length)return n;{let e;if(Object(i.isNullOrUndefinedOrEmptyString)(n)||(n=`${n} ${s} `),1===o.length)switch(e=ot(o[0],t,r),s){case Ve.LogicalOperatorString.and:case Ve.LogicalOperatorString.or:return`${n}(${e})`;case Ve.LogicalOperatorString.not:return`${n}${s} (${e})`;default:const a=`Invalid logical operator ${s}.`;throw t.error(`${pt()} ${a}`,r),new v.a(a)}else{e=ot(o[0],t,r),n=qe(o[0]||o[0].getConditions().length>1)?`${n}${e}`:`${n}(${e})`;for(let a=1;a<o.length;a++)e=ot(o[a],t,r),(!qe(o[a])||o[a].getConditions().length>1)&&(e=`(${e})`),n=`${n} ${s} ${e}`}}return n}async function st(e,t,r,n){const a=await tt(e.entityName,ut(e),t,r,n),i=await async function e(t,r,n,a){var i;if(!t||!t.linkedEntities||0===t.linkedEntities.length)return!0;if((null===(i=t.linkedEntities)||void 0===i?void 0:i.length)>0)for(let i=0;i<t.linkedEntities.length;i++){const o=t.linkedEntities[i];if((await dt(r,t.entityName||"",o.entityName||"",o.linkFromAttribute||"",o.linkToAttribute||"",n,a)).isManyToManyRelationship){if(!st(o.linkedEntities[0],r,n,a))return!1;continue}const s=ut(o);if(o.linkFromAttribute&&s.push(o.linkFromAttribute),!await tt(o.entityName,s,r,n,a)||!e(o,r,n,a))return!1}return!0}(e,t,r,n);return a&&i}function ut(e){var t,r;return e?[...null===(t=e.attributes)||void 0===t?void 0:t.map(e=>e.name),...null===(r=e.orderByAttributes)||void 0===r?void 0:r.map(e=>e.name),...lt(e.filterExpression),...ct(e)]:[]}function lt(e){var t;if(!e)return[];const r=[];if(e.getConditions()&&r.push(...e.getConditions().map(e=>e.attributeName)),(null===(t=e.getFilterExpressions())||void 0===t?void 0:t.length)>0)for(const t of e.getFilterExpressions())r.push(...lt(t));return r}function ct(e){var t;if(!e||!e.linkedEntities||0===e.linkedEntities.length)return[];const r=[];if((null===(t=e.linkedEntities)||void 0===t?void 0:t.length)>0)for(let t=0;t<e.linkedEntities.length;t++){const n=e.linkedEntities[t];Object(i.isNullOrUndefinedOrEmptyString)(n.linkToAttribute)||r.push[n.linkToAttribute]}return r}async function dt(e,t,r,n,a,i,o){const s=await Object(_.getEntityMetadata)(e,t);if(s){if(s.OneToManyRelationships)for(const e in s.OneToManyRelationships){const i=s.OneToManyRelationships[e];if(i.ReferencingEntity===r&&i.ReferencingAttribute===n&&i.ReferencedAttribute===a)return{entityNameForHint:t,relationshipName:e,roleOrdinal:Ze.Referencing}}if(s.ManyToOneRelationships)for(const e in s.ManyToOneRelationships){const i=s.ManyToOneRelationships[e];if(i.ReferencedEntity===r&&i.ReferencedAttribute===n&&i.ReferencingAttribute===a)return{entityNameForHint:t,relationshipName:e,roleOrdinal:Ze.Referencing}}if(s.ManyToManyRelationships)for(const e in s.ManyToManyRelationships){const i=s.ManyToManyRelationships[e];if(i.IntersectEntityName===r&&i.Entity2IntersectAttribute===n&&i.Entity2IntersectAttribute===a)return{entityNameForHint:t,relationshipName:e,roleOrdinal:Ze.Referencing,isManyToManyRelationship:!0};if(i.IntersectEntityName===t&&i.Entity1IntersectAttribute===n&&i.Entity1IntersectAttribute===a)return{entityNameForHint:i.Entity1LogicalName,relationshipName:e,roleOrdinal:Ze.AssociationEntity,isManyToManyRelationship:!0}}}const u=`Relationship not found for entity ${t} to link entity ${r} with from=${n} and to=${a}.`;throw i.error(`${pt()} ${u}`,o),new v.a(u)}function pt(e){return e?`[${e}]`:`[${s.FILE_PREFIX.DetermineHints}]`}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */!function(e){e[e.Referencing=1]="Referencing",e[e.AssociationEntity=2]="AssociationEntity"}(Je||(Je={})),function(e){e.Referencing="referencing",e.AssociationEntity="associationentity"}(Ze||(Ze={}));class ft{constructor(e,t){this.executionContext=e,this.commonEventParameters=this.executionContext.commonEventParameters,this.tracer=t,this.operatorStack=[],this.operandStack=[]}parse(e){const t=new RegExp("'.*?'|[^()\\s]+|[()]","g"),r=e.match(t)||[];for(let e=0;e<r.length;e++){const t=r[e],n={type:Object(Ve.getTokenType)(t),value:t.toLowerCase()};switch(n.type){case Ve.TokenType.openBracket:this.operatorStack.push(n);break;case Ve.TokenType.closeBracket:this.evaluateStack(!0);break;case Ve.TokenType.logicalOperator:this.checkPrecendenceWithLastOperator(n.value)&&this.evaluateStack(!1),this.operatorStack.push(n);break;case Ve.TokenType.operand:try{e+=this.extractOperand(e,t,r)}catch(e){const t=`Improper Input string with ${null==e?void 0:e.message}, exception raised after '${n.value}'`;throw this.tracer.error(`${rr()} ${t}`,this.commonEventParameters),new v.a(t)}break;default:const a=`Unsupported token type '${n.type}'`;throw this.tracer.error(`${rr()} ${a}`,this.commonEventParameters),new v.a(a)}}if(this.evaluateStack(!0),1!==this.operandStack.length){const e="FilterParser: Error while evaluating expression : Input Expression seems to have improper construct";throw this.tracer.error(`${rr()} ${e}`,this.commonEventParameters),new v.a(e)}const n=this.operandStack.pop(),a=new je(0,M.Guid.newGuid().guid);return this.addToFilterExpression(a,n),a}evaluateStack(e){for(;this.operatorStack.length>0;){const t=this.operatorStack.pop();if(Object(i.isNullOrUndefined)(t)){const e="FilterParser:EvaluateExpression Error While Evaluating Stack";throw this.tracer.error(`${rr()} ${e}`,this.commonEventParameters),new v.a(e)}{const r=t;if(!r.type){e||this.operatorStack.push(r);break}if(r.type===Ve.TokenType.logicalOperator){const e=this.getLogicalOperator(r.value);let t;t=e===Ve.LogicalOperator.not?this.createFilterExpressionWithOperands(e,1):this.createFilterExpressionWithOperands(e,2),this.operandStack.push(t)}}}}extractOperand(e,t,r){return"("===r[e+1]?r[e+2].indexOf("=")>0?this.extractOperandForFunctionWithParams(e,r):this.extractOperandForFunction(e,r):this.extractOperandForOperator(e,t,r)}extractOperandForOperator(e,t,r){const n=r[e+1]&&Jt(r[e+1]),a=n?1:2;if(e+a>=r.length)throw new v.a("Invalid filter with operator");const i=r[e+1],o=n?null:this.trimSingleQuotes(r[e+2]),s={attributeName:t,operator:this.getConditionalOperator(i),value:o};return this.operandStack.push(s),a}extractOperandForFunction(e,t){if(e+3>=t.length)throw new v.a("Invalid filter with function");const r=t[e],n=t[e+2],a=n.split(",")[0],i=n.split(",")[1],o={attributeName:a,operator:this.getConditionalOperatorFromFunction(r),value:this.trimSingleQuotes(i)};return this.operandStack.push(o),3}extractOperandForFunctionWithParams(e,t){if(e+4>=t.length)throw new v.a("Invalid filter with function");const r=t[e],n=this.parseParameters(t[e+2],","),a=this.parseParameters(t[e+4],"&","@"),i=this.trimSingleQuotes(a[n.PropertyName]);let o;n.PropertyValues?(o=a[n.PropertyValues],o=o.substring(1,o.length-1).split(",").map(e=>this.trimSingleQuotes(e)).join(",")):n.PropertyValue&&(o=a[n.PropertyValue],o=this.trimSingleQuotes(o));const s={attributeName:i,operator:this.getConditionalOperatorFromFunction(r),value:o};return this.operandStack.push(s),4}parseParameters(e,t,r=""){const n=e.split(t+r).filter(e=>""!==e).map(e=>{const t=e.indexOf("=");return{[`${r}${e.substr(0,t)}`]:e.substr(t+1)}});return Object.assign({},...n)}createFilterExpressionWithOperands(e,t){if(this.operandStack.length<t){const e="FilterParser:EvaluateExpression Error While Evaluating Stack :  Input Expression seems to have improper construct";throw this.tracer.error(`${rr()} ${e}`,this.commonEventParameters),new v.a(e)}const r=new je(e,M.Guid.newGuid().guid);for(let e=0;e<t;e++){const e=this.operandStack.pop();this.addToFilterExpression(r,e)}return r}addToFilterExpression(e,t){void 0!==t&&(t instanceof je?e.addFilterExpression(t):e.addCondition(t.attributeName,t.operator,t.value))}trimSingleQuotes(e){return e.startsWith("'")&&e.endsWith("'")&&(e=(e=e.substring(1,e.length)).substring(0,e.length-1)),e}checkPrecendenceWithLastOperator(e){let t=!1;if(!this.operatorStack.length)return t;const r=this.peek(this.operatorStack);if(!Object(i.isNullOrUndefined)(r)){const n=r;if(n.type){if(n.type===Ve.TokenType.logicalOperator){const r=this.getLogicalOperatorPriority(n.value.toLowerCase());this.getLogicalOperatorPriority(e.toLowerCase())>r&&(t=!0)}}else t=!1}return t}getLogicalOperatorPriority(e){switch(e.toLowerCase()){case Ve.LogicalOperatorString.not:return Ve.LogicalOperatorPriority.not;case Ve.LogicalOperatorString.and:return Ve.LogicalOperatorPriority.and;case Ve.LogicalOperatorString.or:return Ve.LogicalOperatorPriority.or;default:const t=`An invalid logical operator ${e} passed as input parameter.`;throw this.tracer.error(`${rr()} ${t}`,this.commonEventParameters),new v.a(t)}}getConditionalOperator(e){switch(e.toLowerCase()){case Ve.ConditionalOperator.equal:case Ve.ConditionalOperator.notEqual:case Ve.ConditionalOperator.greaterThan:case Ve.ConditionalOperator.lessThan:case Ve.ConditionalOperator.like:case Ve.ConditionalOperator.notLike:case Ve.ConditionalOperator.in:case Ve.ConditionalOperator.notIn:case Ve.ConditionalOperator.greaterThanEqual:case Ve.ConditionalOperator.lessThanEqual:case Ve.ConditionalOperator.beginsWith:case Ve.ConditionalOperator.endsWith:case Ve.ConditionalOperator.notBeginWith:case Ve.ConditionalOperator.notEndWith:case Ve.ConditionalOperator.equalsUserId:case Ve.ConditionalOperator.notEqualsUserId:case Ve.ConditionalOperator.equalsUserTeams:case Ve.ConditionalOperator.equalsUserOrUserTeams:case Ve.ConditionalOperator.null:case Ve.ConditionalOperator.notNull:case Ve.ConditionalOperator.between:case Ve.ConditionalOperator.notBetween:case I.e.on:case I.e.onOrBefore:case I.e.onOrAfter:case I.e.today:case I.e.yesterday:case I.e.tomorrow:case I.e.lastWeek:case I.e.thisWeek:case I.e.nextWeek:case I.e.lastMonth:case I.e.thisMonth:case I.e.nextMonth:case I.e.lastYear:case I.e.thisYear:case I.e.nextYear:case I.e.last7Days:case I.e.next7Days:case I.e.lastXDays:case I.e.nextXDays:case I.e.lastXWeeks:case I.e.nextXWeeks:case I.e.lastXMonths:case I.e.nextXMonths:case I.e.lastXYears:case I.e.nextXYears:return e.toLowerCase();default:const t=`FilterParser: An invalid conditional operator ${e} passed as input parameter.`;throw this.tracer.error(`${rr()} ${t}`,this.commonEventParameters),new v.a(t)}}getConditionalOperatorFromFunction(e){switch(e){case Ve.FunctionOperator.contains:case Ve.FunctionOperator.functionContains:return Ve.ConditionalOperator.like;case Ve.FunctionOperator.functionIn:return Ve.ConditionalOperator.in;default:const t=`FilterParser: An invalid conditional operator ${e} passed as input parameter.`;throw this.tracer.error(`${rr()} ${t}`,this.commonEventParameters),new v.a(t)}}getLogicalOperator(e){switch(e.toLowerCase()){case Ve.LogicalOperatorString.and:return Ve.LogicalOperator.and;case Ve.LogicalOperatorString.or:return Ve.LogicalOperator.or;case Ve.LogicalOperatorString.not:return Ve.LogicalOperator.not;default:const t=`An invalid logical operator ${e} passed as input parameter.`;throw this.tracer.error(`${rr()} ${t}`,this.commonEventParameters),new v.a(t)}}peek(e){const t=e.pop();return Object(i.isNullOrUndefined)(t)||e.push(t),t}}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */class yt{constructor(e){this._sqlClause=[],this._logicalOperator=null,this._conditionCount=0,this._logicalOperator=e,this._sqlClause=[],this._conditionCount=0}appendCondition(e){Object(i.isNullOrUndefinedOrEmptyString)(e)||(this._conditionCount>0&&this._sqlClause.push(` ${this._logicalOperator} `),this._logicalOperator===Ve.LogicalOperatorString.not?this._sqlClause.push(`${this._logicalOperator} ${e}`):this._sqlClause.push(e),this._conditionCount++)}getSql(){return this._sqlClause.join("").length>0?"("+this._sqlClause.join("")+")":""}}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */class mt{constructor(){this.conditionBuilders=[],this.whereClause=[],this.conditionBuilders=[]}beginWritingFilter(e){this.conditionBuilders.push(this.createConditionBuilder(e))}endWritingFilter(){const e=this.conditionBuilders[this.conditionBuilders.length-1];if(this.conditionBuilders.splice(this.conditionBuilders.length-1,1),this.conditionBuilders.length>0)this.conditionBuilders[this.conditionBuilders.length-1].appendCondition(e.getSql());else{const t=e.getSql();this.getWhereClause().join("").length>0&&t.length>0&&this.getWhereClause().push(`${I.p.space}${Ve.LogicalOperatorString.and}${I.p.space}`),this.getWhereClause().push(t)}}createConditionBuilder(e){if(!(e in[Ve.LogicalOperator.and,Ve.LogicalOperator.or,Ve.LogicalOperator.not]))throw new Error(`This logical operator for ${e} is not supported`);return new yt(Ve.LogicalOperator[e])}appendCondition(e){this.conditionBuilders[this.conditionBuilders.length-1].appendCondition(e)}getWhereClause(){return this.whereClause}}var ht=r("fnSt");
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */let gt;function Et(e){const t=function(e){const t=new Date(Date.now()),r=6e4*t.getTimezoneOffset(),n=6e4*e.timezoneutcoffsetminutes;return new Date(t.getTime()+r+n)}(e),r=bt(t,St(e.timezoneadjusters));return new Date(t.getTime()+r)}function bt(e,t){if(!t)return 0;let r=null;const n=new Date(e.getTime());n.setHours(0),n.setMinutes(0),n.setSeconds(0),n.setMilliseconds(0);for(let e=0;e<t.length;e++){const a=t[e].datestart,i=t[e].dateend;if(n>=a&&n<=i){r=t[e];break}}return r?function(e,t){const r=t.getFullYear(),n=Ot(e.daylightstart,r),a=Ot(e.daylightend,r);if(a<n){if(t>n||t<a)return e.delta}else if(t>n&&t<a)return e.delta;return 0}(r,e):0}function Ot(e,t){if(e.isfixeddaterule)return new Date(t,e.month,e.day,e.timeofday.getHours(),e.timeofday.getMinutes(),e.timeofday.getSeconds());const r=7*e.week-6,n=new Date(t,e.month,1).getDay();let a;return a=n>e.dayofweek?r+(7-n+e.dayofweek):r+(e.dayofweek-n),a>function(e,t){if(/8|3|5|10/.test(e.toString()))return 30;if(1!==e)return 31;return function(e){return e%4==0&&e%100!=0||e%400==0}(t)?29:28}(e.month,t)&&(a-=7),new Date(t,e.month,a,e.timeofday.getHours(),e.timeofday.getMinutes(),e.timeofday.getSeconds())}function vt(e){return t=e.getFullYear(),r=e.getMonth()+1,n=e.getDate(),a=e.getHours(),i=e.getMinutes(),o=e.getSeconds(),s=e.getMilliseconds(),`'${t}-${r<10?"0"+r:r}-${n<10?"0"+n:n} ${a<10?"0"+a:a}:${i<10?"0"+i:i}:${o<10?"0"+o:o}.${s<100?s<10?"00"+s:"0"+s:s}'`;var t,r,n,a,i,o,s}function _t(e,t){return vt(Tt(e,t))}function Tt(e,t){let r=6e4*e.timezoneutcoffsetminutes;r+=bt(t,St(e.timezoneadjusters));return new Date(t.getTime()-r)}function St(e){return e.map(e=>({datestart:new Date(e.datestart),dateend:new Date(e.dateend),daylightstart:{day:e.daylightstart.day,month:e.daylightstart.month,dayofweek:e.daylightstart.dayofweek,week:e.daylightstart.week,timeofday:new Date(e.daylightstart.timeofday),isfixeddaterule:e.daylightstart.isfixeddaterule},delta:e.delta,daylightend:{day:e.daylightend.day,month:e.daylightend.month,dayofweek:e.daylightend.dayofweek,week:e.daylightend.week,timeofday:new Date(e.daylightend.timeofday),isfixeddaterule:e.daylightend.isfixeddaterule}}))}function Nt(e){return e.setHours(0,0,0,0),e}function Ct(e){const t=Nt(e);return t.setDate(1),t}function Pt(e){return Math.trunc(e.timezoneutcoffsetminutes/60)}function Rt(e){return e.timezoneutcoffsetminutes%60}function wt(e,t){try{const r=e.datetimeformatinfo.FirstDayOfWeek;return(t=new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0)).getDay()<r?Dt(t,r-t.getDay()-7):Dt(t,r-t.getDay())}catch(e){throw new Error("Failed to getWorkWeekStartDateFromUserSettings "+e)}}function Mt(e,t){return Dt(e,7*t)}function It(e,t){const r=new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds());return r.setMonth(e.getMonth()+t),r}function At(e,t){const r=new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds());return r.setFullYear(e.getFullYear()+t),r}function Dt(e,t){const r=new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds());return r.setDate(e.getDate()+t),r}async function Lt(e,t,r,n=[]){switch(t){case ht.DateTimeFieldBehavior.DateOnly:return xt(e);case ht.DateTimeFieldBehavior.TimeZoneIndependent:return e;case ht.DateTimeFieldBehavior.UserLocal:return await async function(e,t,r){try{return Tt(await Object(_.getUserSettings)(t,r),e)}catch(e){const t=Object(i.getErrorMessage)(e)||"Failed to substitute date time placeholder";throw new v.a(t)}}(e,r,n);default:return Promise.reject(new v.a("The Attribute's DateTime Behavior is Undefined!"))}}function Ut(e,t,r,n){const a=`rtrim([{${e}}].[{${t}}])`,i=vt(r);return` ${a} >= ${i} and ${i} < ${vt(n)} `}function Ft(e){if(Object(i.isNullOrUndefinedOrEmpty)(e))throw new v.a("DateTime input value is null");if(e instanceof Date)return e;let t=e;const r=new RegExp("[-]","ig");return t=t.replace(r,"/"),t=t.replace(gt||(gt=new RegExp("[Z,T]","ig"))," "),t=t.lastIndexOf(".")>-1?t.substr(0,t.lastIndexOf(".")):t,new Date(Date.parse(t))}function xt(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate())}async function kt(e,t=[]){try{return Et(await Object(_.getUserSettings)(e,t))}catch(e){const t=Object(i.getErrorMessage)(e)||"Failed to substitute date time placeholder";throw new Error(t)}}function jt(e){let t=e.trim();t=t.replace(/[/]/gi,"-");const r=t.match(/[Z,T]/gi);if(r&&!Object(i.isNullOrUndefinedOrEmptyString)(r)&&2===r.length&&r.indexOf("Z")>0&&r.indexOf("T")>0&&!isNaN(Date.parse(t)))return t;t=t.replace(/[Z,T]/gi," ").trim();const n=t.split(" ");return n.length>1?t=`${qt(n[0],e)}T${function(e,t){let r="";return e.split(":").forEach(e=>{r+=Bt(e,t)+":"}),r=r.substring(0,r.length-1),r}(n[1],e)}Z`:1===n.length&&(t=qt(n[0],e)+"T00:00:00.000Z"),isNaN(Date.parse(t))&&$t(e),t}function qt(e,t){let r="";return e.split("-").forEach(e=>{r+=4!==e.length?Bt(e,t)+"-":e+"-"}),r=r.substring(0,r.length-1),r}function Bt(e,t){return-1===e.indexOf(".")?(e.length>2&&$t(t),e.length<2?"0"+e:e):(e.length>10&&$t(t),e.split(".")[0].length<2?"0"+e:e)}function $t(e){throw new Error("Incorrect datetime string format"+(e?": "+e:""))}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */async function Vt(e,t,r,n,a,o,s,u=[]){try{const l=await async function(e,t,r,n,a=[]){const o=await Object(_.getAttributesMetadata)(r,t,[],a);if(Object(i.isNullOrUndefinedOrEmpty)(o)){const e="Unable to get attribute metadata descriptor that associated to entity: "+t;return n.warn(`${Gt()} ${e}`,a),Promise.reject(e)}{const r=o[e];if(Object(i.isNullOrUndefinedOrEmpty)(r)){const e=`Attribute metadata descriptor that is associated to entity: ${t} does not exist in DB`;return n.warn(`${Gt()} ${e}`,a),Promise.reject(e)}if(!r.Type||r.Type!==T.AttributeType.DateTime){const e="Attribute Type is not DateTime though the given condition operator is of DateTime type.";return n.warn(`${Gt()} ${e}`,a),Promise.reject(e)}return r.Behavior?r.Behavior:ht.DateTimeFieldBehavior.None}}(e,r,o,s,u);switch(a){case I.e.onOrBefore:case I.e.onOrAfter:return await async function(e,t,r,n,a,i,o,s=[]){try{return function(e,t,r,n){const a=`rtrim([${e}].[${t}])`,i=vt(r);let o="";return n===I.e.onOrBefore?o="<":I.e.onOrAfter&&(o=">="),` ${a} ${o} ${i} `}(t,e,await async function(e,t,r,n,a=[]){let i=Ft(e);i=xt(i),r===I.e.onOrBefore&&(i=Dt(i,1));return await Lt(i,t,n,a)}(r,n,a,i,s),a)}catch(e){return o.error(`${Gt()} Failed to generate query for DateTimeType: ${a} with ${e.message||e}`),Promise.reject(new v.a(e))}}(e,t,n,l,a,o,s,u);case I.e.lastXDays:case I.e.lastXWeeks:case I.e.lastXMonths:case I.e.lastXYears:case I.e.last7Days:return await async function(e,t,r,n,a,i,o,s=[]){I.e.last7Days&&(r="7");const u=Ht(r),l=await async function(e,t,r=[]){let n=await kt(t,r);const a=await Lt(n,e,t,r);n=new Date(n.getFullYear(),n.getMonth(),n.getDate(),0,0,0);const i=await Lt(n,e,t,r);return{endUTCDate:a,currentUTCDateMidnight:i}}(n,i,s);let c;if(!l.currentUTCDateMidnight||!l.endUTCDate)return o.warn(`${Gt()} skip generated sqlite query string for DateTimeLastXOperator with currUTCDateMidnight: ${l.currentUTCDateMidnight} and endUTCDate: ${l.endUTCDate}..`),"";switch(a){case I.e.lastXDays:case I.e.last7Days:c=Dt(l.currentUTCDateMidnight,-1*u);break;case I.e.lastXWeeks:c=Mt(l.currentUTCDateMidnight,-1*u);break;case I.e.lastXMonths:c=It(l.currentUTCDateMidnight,-1*u);break;case I.e.lastXYears:c=At(l.currentUTCDateMidnight,-1*u);break;default:return""}return function(e,t,r,n){const a=`rtrim([{${e}}].[{${t}}])`,i=vt(r);return` ${a} >= ${i} and ${i} <= ${vt(n)} `}(t,e,c,l.endUTCDate)}(e,t,n,l,a,o,s,u);case I.e.nextXDays:case I.e.nextXWeeks:case I.e.nextXMonths:case I.e.nextXYears:case I.e.next7Days:return await async function(e,t,r,n,a,i,o,s=[]){I.e.next7Days&&(r="7");const u=Ht(r),l=await async function(e,t,r=[]){let n=await kt(t,r);const a=await Lt(n,e,t,r);(n.getHours()||n.getMinutes()||n.getSeconds()||n.getMilliseconds())&&(n=Dt(n,1));n=new Date(n.getFullYear(),n.getMonth(),n.getDate(),0,0,0);const i=await Lt(n,e,t,r);return{startUTCDate:a,currentUTCDateMidnight:i}}(n,i,s);let c;if(!l.currentUTCDateMidnight||!l.startUTCDate)return o.warn(`${Gt()} skip generated sqlite query string for DateTimeNextXOperator with currUTCDateMidnight: ${l.currentUTCDateMidnight} and startUTCDate: ${l.startUTCDate}..`),"";switch(a){case I.e.nextXDays:case I.e.next7Days:c=Dt(l.currentUTCDateMidnight,u);break;case I.e.nextXWeeks:c=Mt(l.currentUTCDateMidnight,u);break;case I.e.nextXMonths:c=It(l.currentUTCDateMidnight,u);break;case I.e.nextXYears:c=At(l.currentUTCDateMidnight,u);break;default:return""}return Ut(t,e,l.startUTCDate,c)}(e,t,n,l,a,o,s,u);case I.e.on:case I.e.today:case I.e.yesterday:case I.e.tomorrow:case I.e.lastWeek:case I.e.thisWeek:case I.e.nextWeek:case I.e.lastMonth:case I.e.thisMonth:case I.e.nextMonth:case I.e.lastYear:case I.e.thisYear:case I.e.nextYear:return await async function(e,t,r,n,a,o,s=[]){let u;switch(a){case I.e.today:case I.e.yesterday:case I.e.tomorrow:case I.e.on:u=await async function(e,t,r,n=[]){const a=await kt(r,n);let o=null;switch(e){case I.e.today:o=0;break;case I.e.yesterday:o=-1;break;case I.e.tomorrow:o=1;break;case I.e.on:break;default:throw new v.a("getStartTimeAndEndTimeForDayOperator does not support DateTimeType: "+e)}Object(i.isNullOrUndefined)(o)||(t=Dt(a,o));let s=Ft(t);s=xt(s);const u=Dt(s,1);return{startDate:s,endDate:u}}(a,r,o,s);break;case I.e.thisWeek:case I.e.lastWeek:case I.e.nextWeek:u=await async function(e,t,r=[]){let n,a=await async function(e,t=[]){try{const r=await Object(_.getUserSettings)(e,t);return wt(r,Et(r))}catch(e){const t=Object(i.getErrorMessage)(e)||"Failed to substitute date time placeholder";throw new Error(t)}}(t,r);switch(e){case I.e.thisWeek:n=1;break;case I.e.lastWeek:n=-1;break;case I.e.nextWeek:a=Mt(a,1),n=1;break;default:throw new v.a("getStartTimeAndEndTimeForWeekOperator does not support DateTimeType: "+e)}const o=Mt(a,n);return{startDate:a,endDate:o}}(a,o,s);break;case I.e.thisMonth:case I.e.lastMonth:case I.e.nextMonth:u=await async function(e,t,r=[]){const n=await kt(t,r);let a,i=new Date(n.getFullYear(),n.getMonth(),1);switch(e){case I.e.thisMonth:a=1;break;case I.e.lastMonth:a=-1;break;case I.e.nextMonth:i=It(i,1),a=1;break;default:throw new v.a("getStartTimeAndEndTimeForMonthOperator does not support DateTimeType: "+e)}const o=It(i,a);return{startDate:i,endDate:o}}(a,o,s);break;case I.e.thisYear:case I.e.lastYear:case I.e.nextYear:u=await async function(e,t,r=[]){const n=await kt(t,r);let a,i=new Date(n.getFullYear(),0,1);switch(e){case I.e.thisYear:a=1;break;case I.e.lastYear:a=-1;break;case I.e.nextYear:i=At(i,1),a=1;break;default:throw new v.a("getStartTimeAndEndTimeForYearOperator does not support DateTimeType: "+e)}const o=At(i,a);return{startDate:i,endDate:o}}(a,o,s);break;default:throw new v.a("generateSQLiteQueryForDateOperator does not support DateTimeType: "+a)}const l=await Lt(u.startDate,n,o,s),c=await Lt(u.endDate,n,o,s);return Ut(t,e,l,c)}(e,t,n,l,a,o,u);default:const r="GenerateDateTimeQueryString does not support DateTimeType of "+a;return s.error(`${Gt()} ${r}`),Promise.reject(new v.a(r))}}catch(e){return s.error(`${Gt()} ${e.message||e}`),Promise.reject(new v.a(e))}}function Ht(e){if(Object(i.isNullOrUndefinedOrEmpty)(e))throw new v.a("X input Value is null or undefined");const t=Number(e);if(t<1)throw new v.a("X input Value cannot be negative");return t}function Gt(e){return e?`[${e}]`:`[${s.FILE_PREFIX.DateTimeOperators}]`}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */const Qt={[T.AttributeType.UniqueIdentifier]:[Ve.ConditionalOperator.null,Ve.ConditionalOperator.notNull,Ve.ConditionalOperator.in,Ve.ConditionalOperator.notIn,Ve.ConditionalOperator.equal,Ve.ConditionalOperator.notEqual,Ve.ConditionalOperator.greaterThan,Ve.ConditionalOperator.greaterThanEqual,Ve.ConditionalOperator.lessThan,Ve.ConditionalOperator.lessThanEqual,Ve.ConditionalOperator.equalsUserId,Ve.ConditionalOperator.notEqualsUserId],[T.AttributeType.Boolean]:[Ve.ConditionalOperator.null,Ve.ConditionalOperator.notNull,Ve.ConditionalOperator.equal,Ve.ConditionalOperator.notEqual,Ve.ConditionalOperator.like,Ve.ConditionalOperator.notLike,Ve.ConditionalOperator.beginsWith,Ve.ConditionalOperator.notBeginWith,Ve.ConditionalOperator.endsWith,Ve.ConditionalOperator.notEndWith,Ve.ConditionalOperator.in,Ve.ConditionalOperator.notIn],[T.AttributeType.String]:[Ve.ConditionalOperator.null,Ve.ConditionalOperator.notNull,Ve.ConditionalOperator.equal,Ve.ConditionalOperator.notEqual,Ve.ConditionalOperator.like,Ve.ConditionalOperator.notLike,Ve.ConditionalOperator.beginsWith,Ve.ConditionalOperator.notBeginWith,Ve.ConditionalOperator.endsWith,Ve.ConditionalOperator.notEndWith],[T.AttributeType.PickList]:[Ve.ConditionalOperator.null,Ve.ConditionalOperator.notNull,Ve.ConditionalOperator.equal,Ve.ConditionalOperator.notEqual,Ve.ConditionalOperator.like,Ve.ConditionalOperator.notLike,Ve.ConditionalOperator.beginsWith,Ve.ConditionalOperator.notBeginWith,Ve.ConditionalOperator.endsWith,Ve.ConditionalOperator.notEndWith,Ve.ConditionalOperator.in,Ve.ConditionalOperator.notIn],[T.AttributeType.State]:[Ve.ConditionalOperator.null,Ve.ConditionalOperator.notNull,Ve.ConditionalOperator.equal,Ve.ConditionalOperator.notEqual,Ve.ConditionalOperator.like,Ve.ConditionalOperator.notLike,Ve.ConditionalOperator.beginsWith,Ve.ConditionalOperator.notBeginWith,Ve.ConditionalOperator.endsWith,Ve.ConditionalOperator.notEndWith,Ve.ConditionalOperator.in,Ve.ConditionalOperator.notIn],[T.AttributeType.Status]:[Ve.ConditionalOperator.null,Ve.ConditionalOperator.notNull,Ve.ConditionalOperator.equal,Ve.ConditionalOperator.notEqual,Ve.ConditionalOperator.like,Ve.ConditionalOperator.notLike,Ve.ConditionalOperator.beginsWith,Ve.ConditionalOperator.notBeginWith,Ve.ConditionalOperator.endsWith,Ve.ConditionalOperator.notEndWith,Ve.ConditionalOperator.in,Ve.ConditionalOperator.notIn],[T.AttributeType.EntityName]:[Ve.ConditionalOperator.null,Ve.ConditionalOperator.notNull,Ve.ConditionalOperator.equal,Ve.ConditionalOperator.notEqual,Ve.ConditionalOperator.like,Ve.ConditionalOperator.notLike,Ve.ConditionalOperator.beginsWith,Ve.ConditionalOperator.notBeginWith,Ve.ConditionalOperator.endsWith,Ve.ConditionalOperator.notEndWith,Ve.ConditionalOperator.in,Ve.ConditionalOperator.notIn],[T.AttributeType.Customer]:[Ve.ConditionalOperator.null,Ve.ConditionalOperator.notNull,Ve.ConditionalOperator.equal,Ve.ConditionalOperator.notEqual,Ve.ConditionalOperator.in,Ve.ConditionalOperator.notIn],[T.AttributeType.Lookup]:[Ve.ConditionalOperator.null,Ve.ConditionalOperator.notNull,Ve.ConditionalOperator.in,Ve.ConditionalOperator.notIn,Ve.ConditionalOperator.equal,Ve.ConditionalOperator.notEqual,Ve.ConditionalOperator.equalsUserId,Ve.ConditionalOperator.notEqualsUserId],[T.AttributeType.Owner]:[Ve.ConditionalOperator.null,Ve.ConditionalOperator.notNull,Ve.ConditionalOperator.in,Ve.ConditionalOperator.notIn,Ve.ConditionalOperator.equal,Ve.ConditionalOperator.notEqual,Ve.ConditionalOperator.equalsUserId,Ve.ConditionalOperator.notEqualsUserId,Ve.ConditionalOperator.equalsUserTeams,Ve.ConditionalOperator.equalsUserOrUserTeams],[T.AttributeType.Integer]:[Ve.ConditionalOperator.equal,Ve.ConditionalOperator.notEqual,Ve.ConditionalOperator.null,Ve.ConditionalOperator.notNull,Ve.ConditionalOperator.greaterThan,Ve.ConditionalOperator.greaterThanEqual,Ve.ConditionalOperator.lessThan,Ve.ConditionalOperator.lessThanEqual],[T.AttributeType.BigInt]:[Ve.ConditionalOperator.equal,Ve.ConditionalOperator.notEqual,Ve.ConditionalOperator.null,Ve.ConditionalOperator.notNull,Ve.ConditionalOperator.greaterThan,Ve.ConditionalOperator.greaterThanEqual,Ve.ConditionalOperator.lessThan,Ve.ConditionalOperator.lessThanEqual],[T.AttributeType.Double]:[Ve.ConditionalOperator.equal,Ve.ConditionalOperator.notEqual,Ve.ConditionalOperator.null,Ve.ConditionalOperator.notNull,Ve.ConditionalOperator.greaterThan,Ve.ConditionalOperator.greaterThanEqual,Ve.ConditionalOperator.lessThan,Ve.ConditionalOperator.lessThanEqual],[T.AttributeType.Decimal]:[Ve.ConditionalOperator.equal,Ve.ConditionalOperator.notEqual,Ve.ConditionalOperator.null,Ve.ConditionalOperator.notNull,Ve.ConditionalOperator.greaterThan,Ve.ConditionalOperator.greaterThanEqual,Ve.ConditionalOperator.lessThan,Ve.ConditionalOperator.lessThanEqual],[T.AttributeType.Money]:[Ve.ConditionalOperator.equal,Ve.ConditionalOperator.notEqual,Ve.ConditionalOperator.null,Ve.ConditionalOperator.notNull,Ve.ConditionalOperator.greaterThan,Ve.ConditionalOperator.greaterThanEqual,Ve.ConditionalOperator.lessThan,Ve.ConditionalOperator.lessThanEqual,Ve.ConditionalOperator.in,Ve.ConditionalOperator.notIn],[T.AttributeType.DateTime]:[I.e.onOrAfter,I.e.on,I.e.onOrBefore,I.e.today,I.e.tomorrow,I.e.yesterday,I.e.next7Days,I.e.last7Days,I.e.nextWeek,I.e.lastWeek,I.e.thisWeek,I.e.nextMonth,I.e.lastMonth,I.e.thisMonth,I.e.nextYear,I.e.lastYear,I.e.thisYear,I.e.lastXDays,I.e.nextXDays,I.e.lastXWeeks,I.e.nextXWeeks,I.e.lastXMonths,I.e.nextXMonths,I.e.lastXYears,I.e.nextXYears,I.e.anyTime,Ve.ConditionalOperator.null,Ve.ConditionalOperator.notNull,Ve.ConditionalOperator.equal,Ve.ConditionalOperator.notEqual,Ve.ConditionalOperator.greaterThan,Ve.ConditionalOperator.greaterThanEqual,Ve.ConditionalOperator.lessThan,Ve.ConditionalOperator.lessThanEqual]};
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */async function Xt(e,t,r,n,a,o,s=!1){try{const u=s?e:e+"0",l=await Yt(e,u,r,n,a,o);if(Object(i.isNullOrUndefinedOrEmptyString)(l))return t;return Wt(t,`${I.c.where} ${l} ${I.c.collateNoCase} `)}catch(e){return a.error(`${rr()} Failed to apply filter clause: ${Object(i.getErrorMessage)(e)}`,o.commonEventParameters),t}}function Wt(e,t){const r=e.split(I.l.WHERE_START);if(2===r.length){const n=r[1].replace(/where/i,`${t} ${Ve.LogicalOperatorString.and}`);e=`${r[0]} ${I.l.WHERE_START}${n}`}else if(1===r.length){const r=e.split(I.l.ORDERBY_START);e=2===r.length?`${r[0]} ${I.l.WHERE_START}${t}${I.l.WHERE_END} ${I.l.ORDERBY_START}${r[1]}`:`${e} ${I.l.WHERE_START}${t}${I.l.WHERE_END}`}return e}function zt(e,t){return Wt(e,I.c.where+I.p.space+I.p.openSQBracket+t+I.p.closeSQBracket+I.p.space+I.p.equal+I.p.space+I.p.question+I.p.space+I.c.collateNoCase)}async function Yt(e,t,r,n,a,o){const s=o.commonEventParameters,u=new ft(o,a).parse(r);if(Object(i.isNullOrUndefined)(u))return a.error(rr()+" Failed to apply filter clause: Empty FilterExpression",s),"";let l=new mt;return l=await async function e(t,r,n,a,o,s,u){if(Object(i.isNullOrUndefined)(t))return a;try{if(a.beginWritingFilter(t.getFilterOperator()),!Object(i.isNullOrUndefined)(t.getConditions()))for(const e of t.getConditions())if(tr(e.operator)){a.beginWritingFilter(Ve.LogicalOperator.or),a=await Kt(e,a,n,r,o,s,u);const t={attributeName:e.attributeName,operator:Ve.ConditionalOperator.null,value:e.value};(a=await Kt(t,a,n,r,o,s,u)).endWritingFilter()}else a=await Kt(e,a,n,r,o,s,u);if(!Object(i.isNullOrUndefined)(t.getFilterExpressions()))for(const i of t.getFilterExpressions())a=await e(i,r,n,a,o,s,u);return a.endWritingFilter(),a}catch(e){const t="Failed to visitFilterExpression: "+Object(i.getErrorMessage)(e);return s.error(`${rr()} ${t}`,u.commonEventParameters),Promise.reject(new v.a(t))}}(u,t,e,l,n,a,o),l.getWhereClause().join("").length<1?(a.error(rr()+" Failed to generate filter clause: Empty WhereClause",s),""):l.getWhereClause().join("")}async function Kt(e,t,r,n,a,o,s){let u;const l=[];let c="";const d=s.commonEventParameters;if(Object(i.isNullOrUndefined)(e.value)&&!Jt(e.operator)){const e="This conditional operator is not support null/undefined compared value";return o.warn(`${rr()} ${e}`,d),Promise.reject(new v.a(e))}const p=e.operator,f=e.attributeName,y=await On(f,r,a,o,s);switch(await async function(e,t,r,n,a,o){if(o.internalRequest)return;const s=await Object(_.getAttributesMetadata)(n,t,[],o.commonEventParameters);if(Object(i.isNullOrUndefinedOrEmpty)(s)||Object(i.isNullOrUndefinedOrEmpty)(s[e])){const r=`Unable to get attribute metadata descriptor that associated to entity: ${t}. Return the given attributeName: ${e}`;return a.error(`${rr()} ${r}`,o.commonEventParameters),Promise.reject(new Error(r))}const u=s[e].Type;if(u in Qt){if(Qt[u].indexOf(r)<0){const t=`Condition Operation: ${r} is not supported on Attribute Type: ${u} of Attribute: ${e}`;return a.error(`${rr()} ${t}`,o.commonEventParameters),Promise.reject(new Error(t))}}return}(f,r,p,a,o,s),p){case Ve.ConditionalOperator.in:case Ve.ConditionalOperator.notIn:const t=[];u=e.value.split(",");for(let e=0;e<u.length;e++)t.join("").length>0&&t.push(", "),t.push(`'${await Zt(f,r,u[e],a,o,s)}'`);c=`(${t.join("")})`,l.push(await er(n,f,y,r,p,c,a,o,s));break;case Ve.ConditionalOperator.between:case Ve.ConditionalOperator.notBetween:u=e.value.split(","),c=`'${await Zt(f,r,u[0],a,o,s)}' and\n        '${await Zt(f,r,u[1],a,o,s)}'`,l.push(await er(n,f,y,r,p,c,a,o,s));break;case Ve.ConditionalOperator.beginsWith:case Ve.ConditionalOperator.endsWith:case Ve.ConditionalOperator.notBeginWith:case Ve.ConditionalOperator.notEndWith:p===Ve.ConditionalOperator.beginsWith||p===Ve.ConditionalOperator.notBeginWith?c=`'${await Zt(f,r,e.value,a,o,s)}%'`:p!==Ve.ConditionalOperator.endsWith&&p!==Ve.ConditionalOperator.notEndWith||(c=`'%${await Zt(f,r,e.value,a,o,s)}'`),l.push(await er(n,f,y,r,p,c,a,o,s));break;case Ve.ConditionalOperator.equalsUserId:case Ve.ConditionalOperator.notEqualsUserId:c=`'${await Object(_.getUserId)(a,d)}'`,l.push(await er(n,f,y,r,p,c,a,o,s));break;case Ve.ConditionalOperator.equalsUserTeams:case Ve.ConditionalOperator.equalsUserOrUserTeams:c=await async function(e,t,r,n,a){const i=await Object(_.getUserId)(n,a);let o=`(SELECT TeamId FROM TeamMembership WHERE SystemUserId = '${i}')`;"eq-useroruserteams"===e&&(o+=` or ${t}.[${r}] = '${i}'`);return o}(p,n,y,a,d),l.push(await er(n,f,y,r,p,c,a,o,s));break;case I.e.on:case I.e.onOrBefore:case I.e.onOrAfter:case I.e.today:case I.e.yesterday:case I.e.tomorrow:case I.e.lastWeek:case I.e.thisWeek:case I.e.nextWeek:case I.e.lastMonth:case I.e.thisMonth:case I.e.nextMonth:case I.e.lastYear:case I.e.thisYear:case I.e.nextYear:case I.e.last7Days:case I.e.next7Days:case I.e.lastXDays:case I.e.nextXDays:case I.e.lastXWeeks:case I.e.nextXWeeks:case I.e.lastXMonths:case I.e.nextXMonths:case I.e.lastXYears:case I.e.nextXYears:l.push(await Vt(y,n,r,e.value,p,a,o,d));break;case Ve.ConditionalOperator.null:l.push(`[${n}].[${y}] is null `);break;case Ve.ConditionalOperator.notNull:l.push(`[${n}].[${y}] is not null `);break;default:c=`'${await Zt(f,r,e.value,a,o,s)}'`,l.push(await er(n,f,y,r,p,c,a,o,s))}return t.appendCondition(l.join("")),t}function Jt(e){return function(e){switch(e){case Ve.ConditionalOperator.equalsUserId:case Ve.ConditionalOperator.notEqualsUserId:case Ve.ConditionalOperator.equalsUserTeams:case Ve.ConditionalOperator.equalsUserOrUserTeams:return!0;default:return!1}}(e)||function(e){switch(e){case I.e.lastXDays:case I.e.nextXDays:case I.e.last7Days:case I.e.next7Days:case I.e.yesterday:case I.e.today:case I.e.tomorrow:case I.e.on:case I.e.onOrAfter:case I.e.onOrBefore:case I.e.nextWeek:case I.e.lastWeek:case I.e.thisWeek:case I.e.lastXWeeks:case I.e.nextXWeeks:case I.e.lastXMonths:case I.e.nextXMonths:case I.e.lastMonth:case I.e.nextMonth:case I.e.thisMonth:case I.e.lastXYears:case I.e.nextXYears:case I.e.lastYear:case I.e.nextYear:case I.e.thisYear:case I.e.anyTime:return!0;default:return!1}}(e)||function(e){switch(e){case Ve.ConditionalOperator.null:case Ve.ConditionalOperator.notNull:return!0;default:return!1}}(e)}async function Zt(e,t,r,n,a,o){if(o.internalRequest)return r;const s=await Object(_.getAttributesMetadata)(n,t,[],o.commonEventParameters);if(Object(i.isNullOrUndefinedOrEmpty)(s)){const e="Unable to get attribute metadata descriptor that associated to entity: "+t;return a.warn(`${rr()} ${e}`,o.commonEventParameters),Promise.reject(e)}{const u=s[e];if(Object(i.isNullOrUndefinedOrEmpty)(u)){const e=`Attribute metadata descriptor that is associated to entity: ${t} does not exist in DB`;return a.warn(`${rr()} ${e}`,o.commonEventParameters),Promise.reject(e)}let l=r;return u.Type===T.AttributeType.EntityName&&(a.warn(`${rr()} Encountered attribute for entity type with value ${r}, ignore\n          entity logical name of ${u.EntityLogicalName} and get logical name from entity type instead`,o.commonEventParameters),l=await Object(_.getEntityLogicalNameFromOtc)(n,parseInt(r,10),o.commonEventParameters)),function(e,t){if(!Object(i.isNullOrUndefined)(e))switch(t){case T.AttributeType.Lookup:case T.AttributeType.Customer:case T.AttributeType.Owner:case T.AttributeType.UniqueIdentifier:const t=new M.Guid(e.toString());e=t.guid;break;case T.AttributeType.DateTime:e=jt(e)}return e}(l,u.Type)}}async function er(e,t,r,n,a,o,s,u,l){try{let i;if(i=l.internalRequest?null:await async function(e,t,r,n){const a=await Object(_.getAttributesMetadata)(r,t,[],n);if(a&&a[e]){const t=a[e];if(t.AttributeOf){const e=a[t.AttributeOf];switch(e.Type){case T.AttributeType.Boolean:case T.AttributeType.PickList:case T.AttributeType.State:case T.AttributeType.Status:return e}}}return null}(t,n,s,l.commonEventParameters),i){const t=[];return function(e,t,r){const n=e.OptionSet;if(n&&0!==n.length){t.push(`case [${r}].[${e.LogicalName}]`);for(let e=0;e<n.length;e++)t.push(` when ${n[e].Value} then '${n[e].Label}'`);t.push(" else null"),t.push(" end ")}else t.push(" null ")}(i,t,e),t.join("")}return`[${e}].[${r}] ${vn(a)} ${o}`}catch(e){return u.error(`${rr()} Failed to getQueryForCondition for attribute: ${t} and entity ${n} with  ${Object(i.getErrorMessage)(e)}`),Promise.reject(new v.a(e))}}function tr(e){switch(e){case"ne":case"not-in":case"not-like":case"not-begin-with":case"not-end-with":return!0;default:return!1}}function rr(e){return e?`[${e}]`:`[${s.FILE_PREFIX.ApplyFilterSQLGenerator}]`}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */async function nr(e,t,r,n={}){const o=n.commonEventParameters||[],s=[],u=await cn(e,t,r,o,n),l={sqlStatements:[],sqlParameters:[]};let c=ar(u,r,o);if(n.internalRequest){const d=at(e.url,r,s,Object(i.isUpsyncRequest)(e));if(!(null==d?void 0:d.filter))throw r.error(`${ir()} ${I.g.invalidHints}`,Object(a.b)(o,s)),new Error(I.g.invalidHints);c=await Xt(u,c,d.filter,t,r,n,!0),l.sqlStatements.push(c)}else{const n=function(e){let t="";Object(i.isNullOrUndefinedOrEmptyString)(e)||(t=e.substring(e.lastIndexOf("(")+1,e.length-1));return t}(e.url),d=await Object(_.getEntityMetadata)(t,u);if(!d||Object(i.isNullOrUndefinedOrEmptyString)(d.PrimaryIdAttribute))throw r.error(`${ir()} ${I.g.primaryIdAttribute}`,o),new Error(I.g.primaryIdAttribute);if(Object(i.isNullOrUndefinedOrEmptyString)(n))throw r.error(`${ir()} ${I.g.referencedId}`,Object(a.b)(o,s)),new Error(I.g.referencedId);if(l.sqlStatements.push(Re(u,d.PrimaryIdAttribute,0,r,o)),l.sqlParameters.push([n]),c=zt(c,d.PrimaryIdAttribute),l.sqlStatements.push(c),l.sqlParameters.push([n]),d.IsActivity){const e=L.activityId+I.p.exclamation+"id";let t=ar(L.activityParty,r,o);t=zt(t,e),l.sqlStatements.push(t),l.sqlParameters.push([n])}}return r.info(`${ir()} SQL Query Request: \n  SQL Statement: ${l.sqlStatements}`),Promise.resolve(l)}function ar(e,t,r=[]){const n=[];if(n.push({name:"logicalName",value:e}),Object(i.isNullOrUndefinedOrEmptyString)(e))throw t.error(`${ir()} ${I.g.invalidParameter}`,Object(a.b)(r,n)),new Error(I.g.invalidParameter);return I.c.delete+I.p.space+I.c.from+I.p.space+I.p.openSQBracket+e+I.p.closeSQBracket+I.p.space}function ir(e){return e?`[${e}]`:`[${s.FILE_PREFIX.DeleteGenerator}]`}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */function or(e,t){if(!t||0===t.length)return e;let r=e;return t.forEach(e=>{const t=new RegExp("\\"+e,"g");r=r.replace(t,"\\"+e)}),r}function sr(e,t){const r=or(e,["/","*"])+"([\\S\\s]*)"+or(t,["/","*"]);return new RegExp(r,"i")}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */var ur;!function(e){e[e.string=0]="string",e[e.integer=1]="integer",e[e.currency=2]="currency",e[e.dateTime=3]="dateTime",e[e.float=4]="float"}(ur||(ur={}));async function lr(e,t,r,n,a,o){const s=o.commonEventParameters;let u=function(e,t,r,n){const a=sr(I.l.QUICKFIND_START,I.l.QUICKFIND_END),i=e.match(a);if(i&&i.length>0)return i[1];const o="Could not locate the QuickFind tokens in SQL query";throw r.error(`${yr()} ${o}`,n.commonEventParameters),new Error(o)}(e,0,a,o);if(!u){const t="No internal QuickFind query found:\n"+e;return a.error(`${yr()} ${t}`,s),Promise.reject(t)}const l=await Object(_.getEntityMetadata)(n,r,s),c=u.split("UNION"),d=function(e){const t=new RegExp("SELECT [\\S\\s]* FROM [\\S\\s]* WHERE [\\S\\s]* IN \\(SELECT [\\S\\s]* FROM [\\S\\s]* WHERE ([\\S\\s]*)\\)","i"),r=new RegExp("SELECT [\\S\\s]* FROM [\\S\\s]* WHERE ([\\S\\s]*)","i"),n=[],a=[],i={};let o=e[e.length-1].match(r);o&&a.push(...o[1].split("OR"));for(let a=0;a<e.length-1;a++)o=e[a].match(t),o||(o=e[a].match(r)),o?n.push(o[1]):n.push("");return i.lookup=n,i.other=a,i}(c),p=d.lookup?d.lookup:[],f=d.other?d.other:[];if(!p.length&&!f.length){if(!l.PrimaryNameAttribute)return a.warn(`${yr()} Could not extract search conditions from the QuickFind query:\n${e}`,s),e;u=`SELECT ${l.PrimaryNameAttribute} FROM ${r} WHERE ${l.PrimaryNameAttribute} LIKE {0}`}return"*"===t?(c.splice(0,p.length),p.length=0,f.length=0,cr(e,c,f,n,a,s)):(function(e,t,r,n,a,o,s){const u=Object(i.trimWildCards)(e);e=Object(i.convertSearchStringToSQL)(e),e=Object(i.handleEscapeCharacters)(e);const l={};if(l[ur[0]]=`'${e}'`,!a.Formatter){const e="Formatter is not available";throw o.error(`${yr()} ${e}`,s),new Error(e)}{const e=a.Formatter.parseIntegerValue(u);!isNaN(e)&&isFinite(e)&&e.toString()===u&&(l[ur[ur.integer]]=e.toString());const i=a.Formatter.parseDecimalValue(u);!isNaN(i)&&isFinite(i)&&(l[ur[ur.float]]=l[ur[ur.currency]]=i.toString());const o=a.Formatter?a.Formatter.parseInvariant(u):new Date(u);o&&(l[ur[ur.dateTime]]=`'${o.toString()}'`),dr(t,!0,r,l),dr(t,!1,n,l)}}(t,c,p,f,n,a,s),cr(e,c,f,n,a,s))}function cr(e,t,r,n,a,i){if(0===t.length){const e="Could not locate the QuickFInd tokens in SQL query";throw a.error(`${yr()} ${e}`,i),new Error(e)}mr(t),mr(r);const o=t[t.length-1].split("where");if(0===o.length){const e="The QuickFind query does not contain 'WHERE' clause";throw a.error(`${yr()} ${e}`,i),new Error(e)}const s=o[0]+(r.length>0?" where "+r.join(" OR "):"");return e.replace(t[t.length-1],s)}function dr(e,t,r,n){for(let a=0;a<r.length;a++){const i=r[a].match(new RegExp("({\\d})"));if(!i)continue;const o=pr(i[1]);fr(t,r,e,a,i[1],o in n,o in n?n[o].toString():null)}}function pr(e){let t="";switch(e){case"{4}":t=ur[ur.float];break;case"{3}":t=ur[ur.dateTime];break;case"{2}":t=ur[ur.currency];break;case"{1}":t=ur[ur.integer];break;case"{0}":t=ur[0]}return t}function fr(e,t,r,n,a,i,o){if(i){const i=a?a.replace("}","\\}").replace("{","\\{"):a,s=new RegExp(i,"g"),u=t[n].replace(s,o);e&&(r[n]=r[n].replace(t[n],u)),t[n]=u}else t[n]="",e&&(r[n]="")}function yr(e){return e?`[${e}]`:`[${s.FILE_PREFIX.QuickFindSQLGenerator}]`}function mr(e){for(let t=0;t<e.length;t++)Object(i.isNullOrUndefinedOrEmptyString)(e[t])&&(e.splice(t,1),t--)}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */function hr(e,t,r,n=!0){const a=sr(t,r),i=e.match(a);return i&&i.length>0?n?`${t}${i[1]}${r}`:i[1]:null}function gr(e){return e?`[${e}]`:`[${s.FILE_PREFIX.MergeQuickFindSQLGenerator}]`}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */async function Er(e,t,r,n=[]){try{const r=await Object(_.getUserSettings)(e,n),a=Et(r);return t=(t=(t=(t=(t=(t=(t=(t=(t=t.replace(new RegExp(I.e.startOfCurrentHourUTC,"g"),_t(r,function(e){return e.setMinutes(0,0,0),e}(a)))).replace(new RegExp(I.e.startOfTodayUTC,"g"),_t(r,Nt(a)))).replace(new RegExp(I.e.startOfWorkWeekUTC,"g"),_t(r,wt(r,a)))).replace(new RegExp(I.e.startOfMonthUTC,"g"),_t(r,Ct(a)))).replace(new RegExp(I.e.startOfYearUTC,"g"),_t(r,function(e){const t=Ct(e);return t.setMonth(0),t}(a)))).replace(new RegExp(I.e.userTimezoneHourOffset,"g"),Pt(r).toString())).replace(new RegExp(I.e.userTimezoneMinuteOffset,"g"),Rt(r).toString())).replace(new RegExp(I.e.UTCHourOffset,"g"),function(e){return-1*Pt(e)}(r).toString())).replace(new RegExp(I.e.UTCMinuteOffset,"g"),function(e){return-1*Rt(e)}(r).toString())}catch(e){const t=Object(i.getErrorMessage)(e)||"Failed to substitute date time placeholder";throw r.warn(`${br()} ${t}`,n),new Error(t)}}function br(e){return e?`[${e}]`:`[${s.FILE_PREFIX.ApplyFinalModifiedSQLGenerator}]`}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */async function Or(e,t,r,n,o,s=[]){const u=[];if(u.push({name:"SQLStatement",value:t}),u.push({name:"columnNames",value:r?r.toString():""}),Object(i.isNullOrUndefinedOrEmptyString)(t)||!r||0===r.length)throw o.error(`${vr()} ${I.g.invalidParameter}`,Object(a.b)(s,u)),new Error(I.g.invalidParameter);const l=t.lastIndexOf(I.l.ORDERBY_START),c=t.lastIndexOf(I.l.ORDERBY_END);let d;if(-1===l&&-1===c)d=t;else{if(-1===l||-1===c){const e="Cannot find matching sort start and end token - return base offline sql";return o.warn(`${vr()} ${e}`,Object(a.b)(s,u)),t}d=t.substr(0,l)}try{const i=await async function(e,t,r,n,i=[]){let o="",s="",u="";for(const l of t){const t=[];t.push({name:"ColumnSortPair",value:l}),o.length>0&&(o+=I.p.comma+I.p.space+I.p.doubleQuote);const c=l.trim().split(I.p.space);let d=r+"0";if(2===c.length){if(![I.s.ASC,I.s.DESC].includes(c[1])){const e="Invalid sort direction. The provided sort direction is not support, only 'asc' and 'desc' type are support.";throw n.error(`${vr()} ${e}`,Object(a.b)(i,t)),new Error(e)}u=c[1].toUpperCase()}else{if(1!==c.length){const e="OrderBy hint contains invalid format";throw n.error(`${vr()} ${e}`,Object(a.b)(i,t)),new Error(e)}u=I.s.ASC.toUpperCase()}s=c[0];const p=s.split(I.p.dot);2===p.length&&(d=p[0],s=p[1]);s=await bn(e,r,s,n,i)?I.p.openSQBracket+s+I.p.exclamation+"name"+I.p.closeSQBracket:s,o+=d+I.p.doubleQuote+I.p.dot+s+I.p.space+u}return o}(e,r,n,o,s);t=d+I.l.ORDERBY_START+I.c.orderBy+I.p.space+I.p.doubleQuote+i+I.l.ORDERBY_END,o.info(`${vr()} SQL Query with Modified SORT Clause:\n ${t}`)}catch(e){const t="Failed to createOrderByQuery because of "+e;o.warn(`${vr} ${t}`,Object(a.b)(s,u))}return t}function vr(e){return e?`[${e}]`:`[${s.FILE_PREFIX.ApplyOrderBySQLGenerator}]`}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */async function _r(e,t,r,n,o,s=[]){const u=[];if(u.push({name:"SQLStatement",value:t}),u.push({name:"columnNames",value:r?r.toString():""}),Object(i.isNullOrUndefinedOrEmptyString)(t)||!r||0===r.length)return o.error(`${Sr()} Failed to add select due to ${I.g.invalidParameter}`,Object(a.b)(s,u)),t;const l=t.lastIndexOf(I.l.SELECT_START),c=t.lastIndexOf(I.l.SELECT_END);if(-1===l||-1===c){const e="Cannot find select SQL Token or mismatch select start/end tokens - Return input SQL: \n "+t;return o.warn(`${Sr()} ${e}`,Object(a.b)(s,u)),t}const d=t.substr(0,l),p=t.substr(l,c-l),f=t.lastIndexOf(I.l.FROM_START);let y,m="";return-1!==f&&(m=t.substr(f)),y=1===r.length&&"*"===r[0].trim()?`${I.l.SELECT_START}${I.c.select} *`:await async function(e,t,r,n,a,i=[]){for(const o of r){t.length>0&&(t+=I.p.comma+I.p.space+I.p.doubleQuote);const r=nn(o);let s=n+"0",u=r;const l=u.split(I.p.dot);2===l.length&&(s=l[0],u=l[1]);await bn(e,n,r,a,i)?t=Tr(t,s,u,r):t+=s+I.p.doubleQuote+I.p.dot+I.p.openSQBracket+u+I.p.closeSQBracket+I.p.space+I.c.as+I.p.space+I.p.doubleQuote+r+I.p.doubleQuote}return t}(e,p,r,n,o,s),t=d+y+I.l.SELECT_END+I.p.space+I.p.space+m,o.info(`${Sr()} SQL Query with SELECT Clause:\n ${t}`),t}function Tr(e,t,r,n){const a=["id","logicalname","name"];for(let i=0;i<a.length;i++){const o=`${r}${I.p.exclamation}${a[i]}`,s=`${n}${I.p.exclamation}${a[i]}`;e+=t+I.p.doubleQuote+I.p.dot+I.p.openSQBracket+o+I.p.closeSQBracket+I.p.space+I.c.as+I.p.space+I.p.doubleQuote+s+I.p.doubleQuote,i<a.length-1&&(e+=I.p.comma+I.p.space+I.p.doubleQuote)}return e}function Sr(e){return e?`[${e}]`:`[${s.FILE_PREFIX.ApplySelectSQLGenerator}]`}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */async function Nr(e,t,r,n,a,i,o){let s,u;if(s=await async function(e,t,r,n,a=[]){const i=await Object(_.getEntityMetadata)(e,t);return i&&i.ManyToOneRelationships&&i.ManyToOneRelationships[r]?i.ManyToOneRelationships[r]:null}(a,r,t,0,o),s){const t=s;u={id:e,OneToMany:{fromEntity:t.ReferencedEntity,fromAttribute:t.ReferencedAttribute,toAttribute:t.ReferencingAttribute}}}else if(await et(a,r,t,0,o)){const n=await et(a,r,t,0,o),i=await Object(_.getEntityMetadata)(a,n.ReferencingEntity);u={id:e,OneToMany:{fromEntity:n.ReferencedEntity,fromAttribute:n.ReferencingAttribute,toAttribute:n.ReferencedAttribute,primaryAttribute:i.PrimaryIdAttribute}}}else{if(s=await async function(e,t,r,n,a=[]){const i=await Object(_.getEntityMetadata)(e,t);return i&&i.ManyToManyRelationships&&i.ManyToManyRelationships[r]?i.ManyToManyRelationships[r]:null}(a,r,t,0,o),!s)throw new Error("Cannot identify type of relationship of request context filter hint");{const t=s,l=t.IntersectEntityName;let c,d,p,f;f=t.Entity1LogicalName===t.Entity2LogicalName?n:t.Entity1LogicalName===r?Je.AssociationEntity:Je.Referencing,f===Je.Referencing?(c=t.Entity1LogicalName,p=t.Entity1IntersectAttribute,d=t.Entity2IntersectAttribute):(c=t.Entity2LogicalName,p=t.Entity2IntersectAttribute,d=t.Entity1IntersectAttribute);u={id:e,ManyToMany:{intersectName:l,targetEntityPrimaryKey:await Pr(a,r,i,o),toIntersectAttribute:p,fromEntity:c,fromEntityAttribute:await Pr(a,c,i,o),fromIntersectAttribute:d}}}}return u}function Cr(e){switch(e){case Ze.Referencing:return Je.Referencing;case Ze.AssociationEntity:return Je.AssociationEntity;default:throw new Error("Unsupported apply context filter hint for roleOrdinal: "+e)}}async function Pr(e,t,r,n){const a=await Object(_.getEntityMetadata)(e,t);if(!a)throw new Error(`Cannot apply context filter because the metadata cache has no metadata for the ${t} entity.`);const i=a.PrimaryIdAttribute;if(!i)throw new Error(`Cannot apply context filter because the primary key for the ${t} entity is missing from the metadata cache.`);return i}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */async function Rr(e,t,r,n,a,i,o,s,u){let l="",c="";const d=n.name;c=i?d+"2":n.alias;const p=await On(n.to,e,o,s,u),f=await On(n.from,d,o,s,u),y=d+" AS "+c+" ON ("+a+I.p.dot+(p===n.to?p:`[${p}]`)+" = "+c+I.p.dot+(f===n.from?f:`[${f}]`);let m;return m=n.type?n.type.toUpperCase()+" JOIN":"JOIN",l=!i&&t?` ${I.l.JOIN_START}${m} ${y} ${I.c.collateNoCase} ${r} ${t})${I.l.JOIN_END} `:` ${I.l.JOIN_START}${m} ${y} ${I.c.collateNoCase} )${I.l.JOIN_END}`,l}function wr(e,t,r){const n=`"${e}0"`,a=`${n}${I.p.space}`,i=t.lastIndexOf(a),o=t.lastIndexOf(I.l.FROM_END);if(o>0){const e=t.substring(0,o),n=t.substring(o+I.l.FROM_END.length,t.length);t=`${e} ${r.join(""+I.p.space)}${I.l.FROM_END} ${n}`}else if(i>0){const e=t.substring(0,i),o=t.substring(i+a.length,t.length);t=`${e}${n}${r.join(""+I.p.space)}${I.l.FROM_END}${o}`}else t+=r.join(""+I.p.space);return t}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */async function Mr(e,t,r,n,a,i){const o=i.commonEventParameters,s=ln(r);if(s.length<1)return a.warn(Ar()+" Failed to apply context Filter - No apply context filter hint found",o),t;try{const r=await async function(e,t,r,n,a){const i=[];try{for(const o of e){const e=o.trim().split(I.p.space);if(3!==e.length)throw new v.a("Context Filter item in the hint is not in correct format.");const s=e[1],u=e[0],l=Cr(e[2]);i.push(await Nr(s,u,t,l,r,n,a))}return i.length<1?Promise.reject(new v.a("Failed to apply context filter - No Context Filter item is being generated")):i}catch(e){throw new v.a("Failed to buildContextFilters - "+e)}}(s,e,n,a,o);t=wr(e,t,await async function(e,t,r,n,a){const i=`"${t}0"`,o=Ve.LogicalOperatorString.and,s=Ve.ConditionalOperator.equal,u="bb";let l,c;const d=[];for(const p of e){let e="";const f=p.id;if(p.ManyToMany){c={attributeName:p.ManyToMany.fromEntityAttribute,operator:s,value:f},l={name:p.ManyToMany.intersectName,from:p.ManyToMany.fromIntersectAttribute,to:p.ManyToMany.targetEntityPrimaryKey,alias:u},e=await Rr(t,"",o,l,i,!0,r,n,a),t=l.name,l={name:p.ManyToMany.fromEntity,from:p.ManyToMany.fromEntityAttribute,to:p.ManyToMany.toIntersectAttribute,alias:u};const d=Ir(l,c);e=e+I.p.space+await Rr(t,d,o,l,t+"2",!1,r,n,a)}else{if(!p.OneToMany)return Promise.reject(new Error("Context filter type is not supported"));{c={attributeName:p.OneToMany.primaryAttribute||p.OneToMany.fromAttribute,operator:s,value:f},l={name:p.OneToMany.fromEntity,from:p.OneToMany.fromAttribute,to:p.OneToMany.toAttribute,alias:u};const d=Ir(l,c);e=await Rr(t,d,o,l,i,!1,r,n,a)}}d.push(e)}return d}(r,e,n,a,i))}catch(e){a.warn(`${Ar()} Failed to apply context Filter - ${e}`,o)}return t}function Ir(e,t){let r="";return r=`(( ${e.alias}.${t.attributeName} ${vn(t.operator)} '${t.value}' ${I.c.collateNoCase}${I.p.space}))`,r}function Ar(e){return e?`[${e}]`:`[${s.FILE_PREFIX.ApplyContextFilterSQLGenerator}]`}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */async function Dr(e,t,r,n,a){const o=t+"0";let u;if(Object(i.isOfflineLogTable)(t))u=t+"id";else{const e=await Object(_.getEntityMetadata)(r,t);u=e&&e.PrimaryIdAttribute?e.PrimaryIdAttribute:t+"id"}const l=`${I.l.SELECT_START}select  [${o}].[${u}] as [${u}]${I.l.SELECT_END}${I.l.FROM_START}from  [${t}] as [${o}]${I.l.FROM_END}`;var c;
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */return n.info(`${c?`[${c}]`:`[${s.FILE_PREFIX.GenerateBaseSQL}]`} Generated base SQL ${l}}`),l}async function Lr(e,t,r,n,a,i){const o=i.commonEventParameters||[],s=r.split(";").map(e=>e.trim());if(s.length<1)return a.warn(xr()+" Failed to apply link entity - No link entity hint found",o),t;try{t=wr(e,t,await async function(e,t,r,n,a,i){const o=`[${t}0]`,s=Ve.LogicalOperatorString.and,u=await async function(e,t,r,n){const a=[];for(const i of e){const{entityLogicalName:e,entityAlias:o,relationshipName:s,roleOrdinal:u,alias:l,joinType:c}=Ur(i,r,n),d=await Object(_.getEntityMetadata)(t,e),{linkEntityName:p,from:f,to:y}=Fr(d,s,u,r,n),m={name:p,from:f,to:y,alias:l,parentEntity:e,parentEntityTableAlias:o};c&&(m.type=c);const h=i.indexOf(I.p.openParenthesis);if(h>-1&&i.charAt(i.length-1)===I.p.closeParenthesis){const e=i.substring(h+1,i.length-1);m.filter=e}a.push(m)}return a}(e,r,n,a);let l="";const c=[];for(let e=0;e<u.length;e++){const a=u[e];let d="";a.filter&&(d=await Yt(a.name,a.alias,a.filter,r,n,i)),a.alias=`[${a.alias}]`,l=await Rr(a.parentEntity||t,d,s,a,`[${a.parentEntityTableAlias}]`||o,!1,r,n,i),c.push(l)}return c}(s,e,n,a,o,i))}catch(e){a.warn(`${xr()} Failed to apply link entity - ${null==e?void 0:e.message}`,o)}return t}function Ur(e,t,r){const n=e.trim().split(I.p.space,6);if(6!==n.length){const e="Incorrect link entity format";throw t.error(`${xr()} ${e}`,r),new v.a(e)}return{entityLogicalName:n[0],entityAlias:n[1],relationshipName:n[2],roleOrdinal:Cr(n[3]),alias:n[4],joinType:function(e,t,r){switch(e){case Ve.JoinType[Ve.JoinType.inner]:return Ve.JoinTypeSQL.inner;case Ve.JoinType[Ve.JoinType.outer]:return Ve.JoinTypeSQL.leftouter;default:const n="Invalid join operator type "+e;throw t.error(`${En()} ${n}`,r),new v.a(n)}}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */(n[5],t,r)}}function Fr(e,t,r,n,a){var i,o,s;let u="",l="",c="";if(null===(i=e.OneToManyRelationships)||void 0===i?void 0:i[t])c=e.OneToManyRelationships[t].ReferencingEntity,u=e.OneToManyRelationships[t].ReferencingAttribute,l=e.OneToManyRelationships[t].ReferencedAttribute;else if(null===(o=e.ManyToOneRelationships)||void 0===o?void 0:o[t])c=e.ManyToOneRelationships[t].ReferencedEntity,u=e.ManyToOneRelationships[t].ReferencedAttribute,l=e.ManyToOneRelationships[t].ReferencingAttribute;else{if(!(null===(s=e.ManyToManyRelationships)||void 0===s?void 0:s[t])){const e=`Relationship name not found: ${t}.`;throw n.error(`${xr()} ${e}`,a),new v.a(e)}r===Je.Referencing?(c=e.ManyToManyRelationships[t].IntersectEntityName,u=e.ManyToManyRelationships[t].Entity2IntersectAttribute,l=e.ManyToManyRelationships[t].Entity2IntersectAttribute):(c=e.ManyToManyRelationships[t].Entity2LogicalName,u=e.ManyToManyRelationships[t].Entity1IntersectAttribute,l=e.ManyToManyRelationships[t].Entity1IntersectAttribute)}return{linkEntityName:c,from:u,to:l}}function xr(e){return e?`[${e}]`:`[${s.FILE_PREFIX.ApplyLinkEntitySQLGenerator}]`}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */async function kr(e,t,r,o={}){const u=o.commonEventParameters||[],l=[];r.info(qr()+" Building SQL Query For RetrieveMultipleRecords is processing",Object(a.b)(u,l));const c=await cn(e,t,r,u,o),d=await Object(_.isFeatureEnabled)(t,I.h.SqlTokensAvailable,u);if(l.push({name:"sqlTokensSwitch",value:d}),!d){const e="Offline SQL Token Switch is OFF - Legacy SQL generator is not supported in Modern Data Layer";return r.error(`${qr()} ${e}`,Object(a.b)(u,l)),Promise.reject(new v.a(e))}const p={};if(e.additionalHeaders){let d;if(e.additionalHeaders[n.HINT.viewId]){const o=e.additionalHeaders[n.HINT.viewId];if(d=await jr(o,c,t,u),Object(i.isNullOrUndefinedOrEmptyString)(d)){l.push({name:"ViewId",value:o});const e="Raw offline sql from metadata cache is null";return r.error(`${qr()} ${e}`,Object(a.b)(u,l)),{sqlStatements:[],sqlParameters:[]}}}else{l.push({name:"IsClientApiRequest",value:!0});try{if(await nt(e,c,p,t,r,o),e.additionalHeaders[n.HINT.viewId]){const r=e.additionalHeaders[n.HINT.viewId];d=await jr(r,c,t,u),l.push({name:"SavedQuery",value:r})}else d=await Dr(0,c,t,r);if(Object(i.isNullOrUndefinedOrEmptyString)(d)){const e="Unable to modify the base sql since it is empty.";return r.error(`${qr()} ${e}`,Object(a.b)(u,l)),Promise.reject(new v.a(e))}}catch(e){const t="Failed to execute client api for retrieve multiple";return r.error(`${qr()} ${t}: ${Object(i.getErrorMessage)(e)}`,Object(a.b)(u,l)),Promise.reject(new v.a((null==e?void 0:e.message)?e.message:t,null==e?void 0:e.code,null==e?void 0:e.stack,null==e?void 0:e.name))}}if(u.push({name:s.EVENT_PARAMETERS.BASE_OFFLINE_SQL,value:d}),e.additionalHeaders[n.HINT.mergeQuickFind]){const i=e.additionalHeaders[n.HINT.mergeQuickFind],s=(await Object(_.getViewMetadata)(t,i,c,u)).offlineSqlQuery;if(!s){l.push({name:"mergeQuickFindViewId",value:i});const e="Failed to merge offline lookup since quick find sql from metadata cache is null for this view id "+i;return r.error(`${qr()} ${e}`,Object(a.b)(u,l)),Promise.reject(new v.a(e))}d=await async function(e,t,r,n,a){const i=a.commonEventParameters||[];if(!e||!t){const e="Lookup view sql query or quick find sql query is empty";return n.error(`${gr()} ${e}`,i),Promise.reject(new v.a(e))}let o;const s=hr(e,I.l.SELECT_START,I.l.FROM_END);if(!s){const r=`Failed to merge lookup query:\n${e}\nwith quick find query:\n${t}\nsince no viewQuerySelectPart found`;return n.error(`${gr()} ${r}`,i),Promise.reject(new v.a(r))}const u=hr(t,I.l.CTE_START,I.l.CTE_END);let l=hr(t,I.l.WHERE_START,I.l.WHERE_END,!1),c=hr(e,I.l.WHERE_START,I.l.WHERE_END,!1);c?(c=c.toLowerCase().replace("where",""),l=`${I.l.WHERE_START}${l}`):l=`${I.l.WHERE_START}${l}${I.l.WHERE_END}`;const d=hr(t,I.l.ORDERBY_START,I.l.ORDERBY_END);return o=u?`${u} ${s} ${l}`:`${s} ${l}`,c&&(o+=` and (${c})${I.l.WHERE_END}`),d&&(o+=" "+d),o}(d,s,0,r,o)}if(e.additionalHeaders[n.HINT.search]){const a=e.additionalHeaders[n.HINT.search];d=await lr(d,a,c,t,r,o)}e.additionalHeaders[n.HINT.select]&&(d=await _r(t,d,ln(e.additionalHeaders[n.HINT.select]),c,r,u)),e.additionalHeaders[n.HINT.orderBy]&&(d=await Or(t,d,ln(e.additionalHeaders[n.HINT.orderBy]),c,r,u)),e.additionalHeaders[n.HINT.contextFilter]&&(d=await Mr(c,d,e.additionalHeaders[n.HINT.contextFilter],t,r,o)),e.additionalHeaders[n.HINT.filter]&&(d=await Xt(c,d,e.additionalHeaders[n.HINT.filter],t,r,o)),e.additionalHeaders[n.HINT.linkEntity]&&(d=await Lr(c,d,e.additionalHeaders[n.HINT.linkEntity],t,r,o)),d=await async function(e,t,r,o,s,u=[]){const l=[];e=function(e,t,r){const n=1+t,a=t*(r-1);return e+I.p.space+I.c.limit+I.p.space+n+I.p.space+I.c.offset+I.p.space+a}(e,Number(o[n.HINT.pageSize]||I.d.PageSize),Number(o[n.HINT.pageNumber]||I.d.PageNumber));const c=await Object(_.getUserId)(r,u);l.push({name:"UserId",value:c}),Object(i.isNullOrUndefinedOrEmptyString)(c)?s.warn(qr()+" userId is null or empty",Object(a.b)(u,l)):e=function(e,t,r,n=[]){if(typeof t===T.AttributeType.String&&t.trim().length>0)return t.replace(new RegExp(I.w,"g"),I.p.singleQuote+e+I.p.singleQuote+I.p.space+I.c.collateNoCase);{const e=br()+" attempted to substitute user id placeholder in empty sql statement";throw r.error(e,n),new Error(e)}}(c,e,s,u);try{e=await Er(r,e,s,u)}catch(e){const t=Object(i.getErrorMessage)(e)||"Failed to substitute date time placeholder";s.warn(`${qr()} ${t}`,Object(a.b)(u,l))}return e=await async function(e,t,r,n=[]){try{const r=await Object(_.getUserSettings)(e,n),a=await Object(_.getLanguageCode)(e,n);t=(t=(t=(t=t.replace(new RegExp(I.k.userLanguage,"g"),r.languageid.toString())).replace(new RegExp(I.k.basedLanguage,"g"),a.toString())).replace(new RegExp(I.k.columnName0,"g"),"6")).replace(new RegExp(I.k.columnName1,"g"),"6")}catch(e){const t="Failed to substitueUserLanguage with "+(Object(i.getErrorMessage)(e)||"Unknown");r.warn(`${br()} ${t}`,n)}return t}(r,e,s,u)}(d,0,t,e.additionalHeaders,r,u),p[n.ADDITIONAL_PARAMETERS.PageSize]=e.additionalHeaders[n.HINT.pageSize]||I.d.PageSize,p[n.ADDITIONAL_PARAMETERS.PageNumber]=e.additionalHeaders[n.HINT.pageNumber]||I.d.PageNumber,function(e,t,r,n){for(const i of I.m)if(e.includes(i))return r.push({name:"Final-Offline-SQL",value:e}),void t.error(`${qr()} Final offline sql still contain place holders: ${i}`,Object(a.b)(n,r))}(d,r,l,u);return{sqlStatements:[d],sqlParameters:[],additionalParameters:p}}{const e="Failed to build the SQL Query For RetrieveMultiple - Cannot find request additional headers";return r.error(`${qr()} ${e}`,Object(a.b)(u,l)),Promise.reject(new v.a(e))}}async function jr(e,t,r,n){const a=await Object(_.getViewMetadata)(r,e,t,n);return a?a.offlineSqlQuery:void 0}function qr(e){return e?`[${e}]`:`[${s.FILE_PREFIX.RetrieveMultipleGenerator}]`}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */async function Br(e,t,r,a={}){const o=a.commonEventParameters||[],s=await cn(e,t,r,o,a);if(a.internalRequest)return async function(e,t,r,n,a={},o=[]){if(Object(i.isNullOrUndefinedOrEmptyString)(e.body)){const e="Invalid request. Empty request body";throw n.error(`${Vr()} ${e}`,o),new Error(e)}const s={id:M.Guid.newGuid(),entityLogicalName:t,values:JSON.parse(e.body)},u=at(e.url,n,o,Object(i.isUpsyncRequest)(e));if(null==u?void 0:u.filter){const e=$r(s,n,o);return{sqlStatements:[await Xt(t,e.sqlStatements[0],u.filter,r,n,a,!0)],sqlParameters:[e.sqlParameters[0]]}}throw n.error(`${Vr()} Failure in upsync pipeline-${I.g.invalidParameter}`,o),new Error(I.g.invalidParameter)}(e,s,t,r,a,o);const u=await Object(_.getAttributeTypes)(t,[],s,o),l=await pn(e.body,u,s,t,r,o),c=dn(e.url,r,o);if(Object(i.isNullOrUndefined)(c)){const e=new Error("Update Generator was unable to extract GUID from url");throw r.error(`${Vr()} ${e.message}`,o),e}let d={id:c,entityLogicalName:s,attributeTypes:u,values:{}};const p=await Object(_.getEntityMetadata)(t,s);return d=await rn(d,l,u,I.v.update,t,r,o,a),d=await sn(t,d,p,I.v.update,o,a),async function(e,t,r,a,o,s,u=[]){if(!a||!a.PrimaryIdAttribute)throw new Error(I.g.primaryIdAttribute);let l={sqlStatements:[],sqlParameters:[],additionalParameters:{[n.ADDITIONAL_PARAMETERS.RecordId]:r.id.guid.toString()}};l.sqlStatements.push(Re(o,a.PrimaryIdAttribute,0,s,u)),l.sqlParameters.push([r.id.guid]),l=function(e,t,r,n,a,o=[]){if(Object(i.isNullOrUndefined)(a))throw n.error(Vr()+" Invalid parameters when creating update query",o),new Error("Invalid parameters for update query generation");const s=$r(t,n,o);if(s.sqlStatements.length>0){const r=zt(s.sqlStatements[0],a),n=s.sqlParameters[0];n.push(t.id.guid),e.sqlStatements.push(r),e.sqlParameters.push(n)}return e}(l,r,0,s,a.PrimaryIdAttribute,u),a.IsActivity&&(l=await async function(e,t,r,n=[]){Object(i.isNullOrUndefined)(t.activityParties)||(r=function(e,t){if(Object(i.isNullOrUndefined)(e.activityParties))return t;return t.sqlStatements.push(I.c.delete+I.p.space+I.c.from+I.p.space+I.p.openSQBracket+L.activityParty+I.p.closeSQBracket+I.p.space+I.c.where+I.p.space+I.p.openSQBracket+L.activityId+L.columnDelimiter+L.id+I.p.closeSQBracket+I.p.space+I.p.equal+I.p.space+I.p.question+I.p.space+I.c.collateNoCase),t.sqlParameters.push([e.id.guid]),t}(t,r),r=await gn(e,t,r,n));return r}(t,r,l,u));a&&e&&e.additionalHeaders&&e.additionalHeaders.Prefer&&-1!==e.additionalHeaders.Prefer.indexOf(n.HEADER_VALUES.PREFER_REPRESENTATION)&&(l=hn(t,l,o,r.id,a.PrimaryIdAttribute,u));return l}(e,t,d,p,s,r,o)}function $r(e,t,r=[]){if(Object(i.isNullOrUndefined)(e))throw t.error(Vr()+" Invalid parameters when creating update query",r),new Error("Invalid parameters for update query generation");let n="";const a=[];let o=0;for(const t in e.values)if(!Object(i.isNullOrUndefinedOrEmptyString)(t)){n+=`${o>0?",":""}[${t}] = ?`,a.push(e.values[t]),o+=1}if(!Object(i.isNullOrUndefinedOrEmptyString)(n)&&a.length>0){return{sqlStatements:[I.c.update+I.p.space+e.entityLogicalName+I.p.space+I.c.set+I.p.space+n+I.p.space],sqlParameters:[a]}}return{sqlStatements:[],sqlParameters:[]}}function Vr(e){return e?`[${e}]`:`[${s.FILE_PREFIX.UpdateGenerator}]`}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */async function Hr(e,t,r={}){const a=t.TraceManager.getTracer(s.COMPONENT_NAMES.SQLGenerator),i=r.commonEventParameters||[];var o;switch(a.info((o?`[${o}]`:`[${s.FILE_PREFIX.SQLGenerator}]`)+" Query Generator start processing.",i),Object(u.getRequestType)(e,t)){case n.OPERATION.Create:return Pe(e,t,a,r);case n.OPERATION.RetrieveMultiple:return kr(e,t,a,r);case n.OPERATION.Update:return Br(e,t,a,r);case n.OPERATION.Delete:return nr(e,t,a,r);case n.OPERATION.GetClientMetadata:return ae(e,t,a,r);case n.OPERATION.Retrieve:return ge(e,t,a,r);case n.OPERATION.Batch:return Se(e,t,a,r);default:throw new Error("Query Generator Failed with Unsupported request type")}}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
class Gr extends y{async intercept(e){const t=e.executionContext||{},r=e.request,o=t.requestType||Object(u.getRequestType)(r,this.applicationContext),l=this.applicationContext.TraceManager.getTracer(s.COMPONENT_NAMES.LocalODataExecutor);let c,d,p,f=[],y="Query Generator",m="";const h=t.commonEventParameters||[],g=[];try{if(t.performanceControl&&t.performanceControl.startMarker(s.FILE_PREFIX.SQLGenerator),c=await function(e,t,r={}){return Hr(e,t,r)}(r,this.applicationContext,t),t.performanceControl&&t.performanceControl.endMarker(s.FILE_PREFIX.SQLGenerator),c){if(Array.isArray(c)){const e=c;if(0===e.length)return Hn(r,o,this.applicationContext,t);y="SQL Executor",l.info(Qr()+" Query Generator Completed. SQL Executor is processing",Object(a.b)(h,g)),f=await async function(e,t,r,i,o,s){var l;const c=Object(x.a)(e,o,s),d="true"===(null===(l=e.additionalHeaders)||void 0===l?void 0:l[n.HINT.SUPPRESS_TRIGGERS_HINT]),p=r.commonEventParameters||[];if(d){const e={sqlStatements:[],sqlParameters:[]};for(let r=0;r<t.length;r++){const n=t[r].sqlParameters;for(let e=t[r].sqlParameters.length;e<t[r].sqlStatements.length;e++)n.push([]);e.sqlStatements.push(...t[r].sqlStatements),e.sqlParameters.push(...n)}const n=await A(e,i,"CRUD",r,!0),l=[];if(n){let e=1;for(let r=0;r<t.length;r++){l.push([]);for(let i=0;i<t[r].sqlStatements.length;i++)n[e]?l[r].push(n[e]):o.error(`${Qr()} No SQL results response for child query ${Object(u.getRequestType)(c[r])} of batch`,Object(a.b)(p,s)),e++}}return l}const f=[];for(let e=0;e<t.length;e++){const n=t[e],l=c[e],d=Object(u.getRequestType)(l);if(n&&n.sqlStatements&&0!==n.sqlStatements.length){const e=A(n,i,d,r);e?f.push(e):o.error(`${Qr()} No SQL results response for child query ${Object(u.getRequestType)(l)} of batch`,Object(a.b)(p,s))}else o.error(`${Qr()} No SQL queries generated for child query ${d} of batch`,Object(a.b)(p,s)),f.push(Promise.resolve([]))}return await Promise.all(f)}(r,e,t,this.applicationContext,l,Object(a.b)(h,g)),p=function(e){const t=[];for(let r=0;r<e.length;r++){let n=null;n=e[r].additionalParameters,n?t.push(n):t.push(void 0)}return t}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */(e)}else{const e=c;if(!e.sqlStatements||0===e.sqlStatements.length)return Hn(r,o,this.applicationContext,t);y="SQL Executor",l.info(Qr()+" Query Generator Completed. SQL Executor is processing",Object(a.b)(h,g)),p=e.additionalParameters,f=await async function(e,t,r,a,o,s,u){var l;let c,d;if(t===n.OPERATION.GetClientMetadata){c=ie(e,s,u).MetadataType,u.push({name:"MetadataType",value:c})}const p="true"===(null===(l=e.additionalHeaders)||void 0===l?void 0:l[n.HINT.SUPPRESS_TRIGGERS_HINT]);!function(e,t,r){if(Object(i.isNullOrUndefinedOrEmptyString)(r)||Object(i.isNullOrUndefinedOrEmpty)(e)||Object(i.isNullOrUndefinedOrEmptyString)(t))return!1;const a=F.QueriedMetadataType[r.toLowerCase()],o=[F.QueriedMetadataType.customControl,F.QueriedMetadataType.complexControl,F.QueriedMetadataType.formSelector,F.QueriedMetadataType.viewSelector,F.QueriedMetadataType.ribbon];return t===n.OPERATION.GetClientMetadata&&Xr(e)&&!Object(i.isNullOrUndefined)(e.AdditionalParameters)&&e.AdditionalParameters.response&&-1!==o.indexOf(a)}(o,t,c)||Object(i.isNullOrUndefined)(o.AdditionalParameters)?(d=await A(r,o,t,a,p),p&&d.length>r.sqlStatements.length&&(d.shift(),d.pop())):d=o.AdditionalParameters.response;return d}(r,o,e,t,this.applicationContext,l,Object(a.b)(h,g))}f?(y="Response Handler",l.info(Qr()+" SQL Executor Completed.Response Handler is processing",g),d=await Vn(r,o,this.applicationContext,f,void 0,p,t)):(m="ExecuteSQLBatch returned empty sql response",l.warn(`${Qr()} ${m}`,Object(a.b)(h,g)),d=await Vn(r,o,this.applicationContext,void 0,void 0,void 0,t))}else l.warn(Qr()+" ExecuteOfflineSqlGenerator returned empty query, So will return empty response",Object(a.b)(h,g)),d=await Vn(r,o,this.applicationContext,void 0,void 0,void 0,t)}catch(e){m=e&&e.message?e.message:"Unknown";const n=e.code;g.push({name:"OperationStep",value:y}),Object(a.a)(e,g),l.error(`${Qr()} Exception in SQLRequestInterceptor at OperationStep['${y}'] - ${m}`,Object(a.b)(h,g)),d=await Vn(r,o,this.applicationContext,void 0,new v.a(m,n,e.stack,y),void 0,t)}return l.info(Qr()+" Exiting SQLRequestInterceptor and returning local OData response",Object(a.b)(h,g)),d}}function Qr(e){return e?`[${e}]`:`[${s.FILE_PREFIX.SQLRequestInterceptor}]`}function Xr(e){return!Object(i.isNullOrUndefined)(e.AdditionalParameters)&&!0!==e.AdditionalParameters.EnableOptimizedDependency}function Wr(e,t,r){const n=`SELECT ${k.i.METADATA_TYPE}, ${k.i.JSON} from ${k.b} where ${t} = ?`;e.sqlStatements.push(n),e.sqlParameters.push([r])}async function zr(e,t,r,a,i={}){const o=await Object(_.getEntityMetadata)(e,t),s=o.PrimaryNameAttribute,u=o.PrimaryIdAttribute;if(!s||!u)return"";const l={sqlStatements:[`SELECT ${s} FROM ${t} WHERE ${u} = ?`],sqlParameters:[[r]]};try{const t=await A(l,e,n.OPERATION.Retrieve,i);if(!t||t.length<=0||!t[0].rows||!t[0].rows.item||t[0].rows.item.length<=0||!s)return"";return t[0].rows.item(0)[s]}catch(e){return a.error(`${Zr()} error when retrieving activity party name. Setting as empty ${e}`,i.commonEventParameters),I.d.EmptyString}}async function Yr(e,t,r,n={}){const a=`SELECT ${k.i.METADATA_TYPE}, ${k.i.JSON} FROM ${k.b} WHERE ${Object(i.isNullOrUndefinedOrEmptyString)(r)?$.get_id().get_path():r} = ?`,o=await Object(U.b)(e,a,[t],n.commonEventParameters,n);Jr(e,o);for(const e of o)if(e.rows.length>0)return JSON.parse(e.rows.item(0)[k.i.JSON]);return{}}async function Kr(e,t,r,n={}){const a={sqlStatements:[],sqlParameters:[]},o=n.commonEventParameters||[];Wr(a,t.get_keyPath().get_path(),t.get_keyValue().toString());const s=await Object(U.a)(e,a,n);(Object(i.isNullOrUndefined)(s)||s.length<1)&&r.warn(Zr()+" result returned form getBatchSQLResult is empty in retrieveMultipleApplicationMetadataByKeys}",o),Jr(e,s);const u=[];for(let e=0;e<s.length;e++)if(s[e].rows.length>0)for(let r=0;r<s[e].rows.length;r++){const n=JSON.parse(s[e].rows.item(r)[k.i.JSON]);t.checkApplicationMetadata(n)&&u.push(n)}return u}function Jr(e,t){Xr(e)&&!Object(i.isNullOrUndefined)(t)&&Array.isArray(t)&&t.length>0&&(Object(i.isNullOrUndefined)(e.AdditionalParameters)&&(e.AdditionalParameters={}),!Object(i.isNullOrUndefined)(e.AdditionalParameters.response)&&Array.isArray(e.AdditionalParameters.response)?e.AdditionalParameters.response=e.AdditionalParameters.response.push(...t):e.AdditionalParameters.response=t)}function Zr(e){return e?`[${e}]`:`[${s.FILE_PREFIX.DataSQLExecutor}]`}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */function en(e,t,r,n){t=t?t.trim():"",r=r?r.trim():"",n=n?n.trim():"";let a="";r.length>0&&(a=r.substring(0,1));let i="";switch(e){case 0:i=n.length>0&&t.length>0?n+", "+t:n+" "+t;break;case I.i.firstLast:i=t+" "+n;break;case I.i.lastFirstMiddleInitial:i=function(e,t,r){let n="";t.length>0&&(n=t);t.length>0&&(e.length>0||r.length>0)&&(n+=",");e.length>0&&(n=n+" "+e);r.length>0&&(n=n+" "+r+".");return n.toString().trim()}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */(t,n,a);break;case I.i.firstMiddleInitialLast:i=t,r.length>0&&(i=i+" "+a+"."),i=i+" "+n;break;case I.i.lastFirstMiddle:n.length>0&&(i=n),n.length>0&&(t.length>0||r.length>0)&&(i+=","),t.length>0&&(i=i+" "+t),r.length>0&&(i=i+" "+r);break;case I.i.firstMiddleLast:i=t,r.length>0&&(i=i+" "+r),i=i+" "+n;break;case I.i.lastSpaceFirst:i=n+" "+t;break;case I.i.lastNoSpaceFirst:i=n+t;break;default:i=n}return i.toString().trim()}function tn(e,t,r,n){e.values[t]=r,e.attributeTypes&&!(t in e.attributeTypes)&&(e.attributeTypes[t]=n)}async function rn(e,t,r,a,o,u,l,c={}){null==l||l.push({name:s.EVENT_PARAMETERS.ENTITY_NAME,value:null==e?void 0:e.entityLogicalName});for(let a=0;a<t.columnNames.length;a++){const s=nn(t.columnNames[a]);if(r[s]===T.AttributeType.PartyList){Object(i.isNullOrUndefined)(e.activityParties)&&(e.activityParties=[]);const r=t.columnValues[a].match(/(\w+)\(([0-9a-fA-F]{8}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{12})\)/);if(null===r){const e=`Parsing a party list attribute ${t.columnNames[a]} failed: ${t.columnValues[a]}`;throw u.error(`${En()} ${e}`,l),new v.a(e,n.ErrorCode.UnknownBadRequestError)}const d=await Object(_.getEntityLogicalName)(o,r[1],l);e.activityParties.push({partyId:r[2],partyName:await zr(o,d,r[2],u,c),partyLogicalName:d,participationType:L.participationTypeValue[s]})}else if(r[s]===T.AttributeType.Owner||r[s]===T.AttributeType.Lookup||r[s]===T.AttributeType.Customer)if(t.columnValues[a]&&""!==t.columnValues[a].trim()){const r=t.columnValues[a].match(/(\w+)\(([0-9a-fA-F]{8}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{12})\)(\/(.*)):?/);if(null===r){const e=`Parsing a lookup or customer reference attribute ${t.columnNames[a]} failed: ${t.columnValues[a]}`;throw u.error(`${En()} ${e}`,l),new v.a(e,n.ErrorCode.UnknownBadRequestError)}const c=un(T.AttributeType.UniqueIdentifier,r[2]);tn(e,s+L.columnDelimiter+L.id,c,T.AttributeType.UniqueIdentifier);const d=await Object(_.getEntityLogicalName)(o,r[1],l);tn(e,s+L.columnDelimiter+L.logicalName,d,T.AttributeType.String);let p=I.d.EmptyString;p=5!==r.length||Object(i.isNullOrUndefinedOrEmptyString)(r[4])?await zr(o,d,c,u):r[4],tn(e,s+L.columnDelimiter+L.name,p,T.AttributeType.String)}else tn(e,s+L.columnDelimiter+L.id,null,T.AttributeType.UniqueIdentifier),tn(e,s+L.columnDelimiter+L.logicalName,null,T.AttributeType.String),tn(e,s+L.columnDelimiter+L.name,null,T.AttributeType.String);else tn(e,s,un(r[s],t.columnValues[a]),r[s])}return e}function nn(e){let t=e;return e.startsWith("_")&&e.endsWith("_value")&&(t=e.substr(1,e.length-7)),t}async function an(e,t,r,n,a=[],o={}){const s=[];if(t===I.v.create){const t=[...L.defaultFieldsForCreate];t.push(...L.stateAndStatusFields);const n=t.indexOf(L.ownerId);n>=0&&!Object(i.isNullOrUndefined)(r)&&!Object(i.isNullOrUndefined)(r.OwnershipType)&&r.OwnershipType.valueOf()===w.OrganizationOwned&&t.splice(n,1);for(const r of t)e.values[r]||s.push(r);!Object(i.isNullOrUndefined)(r)&&r.IsActivity&&(e.values[L.activityTypeCode]||tn(e,L.activityTypeCode,r.EntityLogicalName,T.AttributeType.String),e.values[L.isRegularActivity]||tn(e,L.isRegularActivity,function(e,t){switch(e){case I.n:case I.o:case I.q:case I.j:case I.b:case I.r:return!1;default:return!!t}}(r.ObjectTypeCode,r.ActivityTypeMask)?"1":"0",T.AttributeType.Boolean))}if(t===I.v.create||t===I.v.update){for(const t of L.defaultFields)e.values[t]||-1!==s.indexOf(t)||(s[s.length]=t);const u=await Object(_.getAttributesMetadata)(n,e.entityLogicalName,[],a);if(!Object(i.isNullOrUndefined)(u)&&function(e,t){if(e[t])return!0;return!1}(u,L.fullName))for(const s in e.values)if(L.fullNameComponents.indexOf(s)>=0&&!e.values[L.fullName]){let s={};t===I.v.update&&(s=await on(n,e,r,o,a)),s[L.firstName]=Object(i.isNullOrUndefinedOrEmptyString)(e.values[L.firstName])?s[L.firstName]:e.values[L.firstName],s[L.middleName]=Object(i.isNullOrUndefinedOrEmptyString)(e.values[L.middleName])?s[L.middleName]:e.values[L.middleName],s[L.lastName]=Object(i.isNullOrUndefinedOrEmptyString)(e.values[L.lastName])?s[L.lastName]:e.values[L.lastName],tn(e,L.fullName,en(await Object(_.getfullnameconventioncode)(n,a),s[L.firstName],s[L.middleName],s[L.lastName]),T.AttributeType.String);break}if(t===I.v.create){const t=Object.keys(u);for(const r of t)if(u[r]){const t=u[r];(!Object(i.isNullOrUndefined)(t.DefaultValue)||!Object(i.isNullOrUndefined)(t.DefaultFormValue))&&Object(i.isNullOrUndefined)(e.values[t.LogicalName])&&s.indexOf(t.LogicalName)<0&&(s[s.length]=t.LogicalName)}}return s}return s}async function on(e,t,r,n={},a=[]){const o=e.TraceManager.getTracer(s.COMPONENT_NAMES.SQLGenerator),u={sqlStatements:[I.c.select+I.p.space+L.firstName+I.p.comma+L.middleName+I.p.comma+L.lastName+I.p.space+I.c.from+I.p.space+t.entityLogicalName+I.p.space+I.c.where+I.p.space+r.PrimaryIdAttribute+I.p.equal+I.c.placeholder],sqlParameters:[[t.id.guid]]};try{const t=await A(u,e,void 0,n);if(!Object(i.isNullOrUndefined)(t)&&1===t.length)return t[0].rows.item(0)}catch(e){o.error(`${En()} Unable to get name parts for ${t.entityLogicalName} from DB. Error: ${e.errorMessage}`,a)}return{}}async function sn(e,t,r,n,a=[],o={}){const s=await an(t,n,r,e,a,o);return t=await async function(e,t,r,n,a=[]){const o=await Object(_.getAttributesMetadata)(n,e.entityLogicalName,t,a);for(const s in o){if(Object(i.isNullOrUndefined)(o[s]))continue;const u=o[s];if(!Object(i.isNullOrUndefined)(u))switch(u.LogicalName){case L.stateCode:if(r.HasStateCode&&tn(e,u.LogicalName,Object(i.isNullOrUndefined)(u.DefaultFormValue)?0:u.DefaultFormValue,T.AttributeType.State),-1!==t.indexOf(L.statusCode)&&!Object(i.isNullOrUndefined)(e.values[L.stateCode])){const t=e.values[L.stateCode];let r=0;if(u&&u.OptionSet&&Object.keys(u.OptionSet).length>0){const e=u.OptionSet.find(e=>e.Value===t);r=e?e.DefaultStatus:0}tn(e,L.statusCode,r,T.AttributeType.Status)}break;case L.statusCode:break;case L.createdOn:case L.modifiedOn:tn(e,u.LogicalName,new Date(Date.now()),T.AttributeType.DateTime);break;case L.createdBy:case L.modifiedBy:case L.ownerId:if(u.LogicalName!==L.ownerId||!Object(i.isNullOrUndefined)(r.OwnershipType)&&r.OwnershipType.valueOf()===w.UserOwned){const t=await Object(_.getUserId)(n,a),r=await Object(_.getUserName)(n,a);if(Object(i.isNullOrUndefinedOrEmpty)(t))throw new Error("User ID fetched from metadata cache was empty");if(Object(i.isNullOrUndefinedOrEmpty)(r))throw new Error("User Name fetched from metadata cache was empty");tn(e,u.LogicalName+L.columnDelimiter+L.id,Object(i.isNullOrUndefinedOrEmpty)(t)?null:t,T.AttributeType.UniqueIdentifier),tn(e,u.LogicalName+L.columnDelimiter+L.logicalName,L.systemUser,T.AttributeType.String),tn(e,u.LogicalName+L.columnDelimiter+L.name,Object(i.isNullOrUndefinedOrEmpty)(r)?null:r,T.AttributeType.String)}break;default:u.Type!==T.AttributeType.PickList||Object(i.isNullOrUndefined)(u.DefaultFormValue)||tn(e,u.LogicalName,u.DefaultFormValue,u.Type),u.Type||!u.DefaultFormValue&&!u.DefaultValue||tn(e,u.LogicalName,Object(i.isNullOrUndefined)(u.DefaultFormValue)?u.DefaultValue?1:0:u.DefaultFormValue,u.Type)}}return e}(t,s,r,e,a)}function un(e,t){switch(e){case T.AttributeType.UniqueIdentifier:return M.Guid.parse(t).guid;case T.AttributeType.PickList:case T.AttributeType.State:case T.AttributeType.Status:return t;case T.AttributeType.Boolean:return!0===t?"1":"0";case T.AttributeType.DateTime:return t;case T.AttributeType.PartyList:throw Error("No SQL representation for party list");case T.AttributeType.Owner:case T.AttributeType.Lookup:case T.AttributeType.Customer:throw Error("No SQL representation for complex types");default:return t}}function ln(e){return e.split(",").map(e=>e.trim())}async function cn(e,t,r,n=[],a={}){if(!e.url)throw r.error(En()+" Error when attempting to extract entity name from URL",n),new Error("Empty url is not valid");const o=Object(i.getEntitySetNameFromUrl)(e);return Object(i.isInternalRequest)(e,o.substring(0,o.length-1))?(a.internalRequest=!0,o.substring(0,o.length-1)):(a.internalRequest=!1,await Object(_.getEntityLogicalName)(t,o,n))}function dn(e,t,r=[]){if(!e)throw t.error(En()+" Error when attempting to extract entity name from URL",r),new Error("Empty url is not valid");const n=e.split("/"),a=n[n.length-1].split("(")[1];if(Object(i.isNullOrUndefinedOrEmptyString)(a))return null;const o=a.split(")")[0];return M.Guid.parse(o)}async function pn(e,t,r,n,a,o=[]){if(Object(i.isNullOrUndefinedOrEmptyString)(e)||Object(i.isNullOrUndefinedOrEmpty)(t)){const e="Invalid request. Empty request body";throw a.error(`${En()} ${e}`,o),new Error(e)}const s=JSON.parse(e),u=[],l=[],c=await Object(_.getEntityMetadata)(n,r);for(const e in s)if(e.indexOf("@odata.bind")>0)mn(e,s,c,t,u,l,a,o);else if(e.indexOf("activity_parties")>0)yn(e,s,u,l,a,o);else if(-1===e.toLowerCase().indexOf("@odata")){u.push(e);const r=nn(e);if(!t[r]){const e="Unknown attribute "+r;a.warn(`${En()} ${e}`,o)}l.push(Object(i.isNullOrUndefined)(s[e])?fn(t[r],r,a):s[e])}return{columnNames:u,columnValues:l}}function fn(e,t,r,n=[]){switch(e){case T.AttributeType.PickList:case T.AttributeType.State:case T.AttributeType.Status:case T.AttributeType.Lookup:case T.AttributeType.Owner:case T.AttributeType.Customer:case T.AttributeType.BigInt:case T.AttributeType.Decimal:case T.AttributeType.Double:case T.AttributeType.Integer:case T.AttributeType.Money:return r.warn(En()+" Column value cleared, setting default value to null for attribute type "+t,n),null;default:return r.warn(En()+" Column value cleared, setting default value to empty string for attribute type "+t,n),I.d.EmptyString}}function yn(e,t,r,n,a,i){const o=t[e];a.info(`${En} Found ${o.length} activity parties`,i);for(const e of o)for(const t in e)t.indexOf("@odata.bind")>0?n.push(e[t]):"participationtypemask"===t&&r.push(L.participationTypeNames[e[t]])}function mn(e,t,r,a,o,s,u,l){const c=e.split("@odata.bind")[0],d=Object(i.isNullOrUndefinedOrEmptyString)(t[e])?t[e]:t[e]+"/"+(t[c+"@OData.Community.Display.V1.FormattedValue"]||I.d.EmptyString);let p=!1;if(r&&r.ManyToOneRelationships)for(const e in r.ManyToOneRelationships){const t=r.ManyToOneRelationships[e];if(t.ReferencingEntityNavigationPropertyName===c&&t.ReferencingAttribute){o.push(t.ReferencingAttribute),s.push(d),p=!0;break}}if(!p){const e=new v.a(`${En()} No navigation properties found for attribute ${c} in entity ${r.EntityLogicalName}`,n.ErrorCode.UnknownBadRequestError,(new Error).stack);throw u.error(e.message,l),e}}function hn(e,t,r,a,o,u=[]){const l=e.TraceManager.getTracer(s.COMPONENT_NAMES.SQLGenerator);if(Object(i.isNullOrUndefinedOrEmptyString)(o)||M.Guid.equals(a,M.Guid.EMPTY))return l.error(`${En()} Invalid parameters when creating query for ${n.HEADER_VALUES.PREFER_REPRESENTATION}`,u),t;const c=`select * from ${r} where ${o}=?`;t.sqlStatements.push(c);const d=[];return d.push(a.guid.toString()),t.sqlParameters.push(d),t}async function gn(e,t,r,n=[]){if(!Object(i.isNullOrUndefined)(t.activityParties)){const a=await Object(_.getAttributesMetadata)(e,L.activityParty,[L.isPartyDeleted],n),o=Object(i.isNullOrUndefined)(a)||Object(i.isNullOrUndefined)(a[L.isPartyDeleted])?"0":a[L.isPartyDeleted].DefaultValue?"1":"0";for(const e of t.activityParties)r.sqlStatements.push(I.c.insert+I.p.space+I.c.into+I.p.space+I.p.openSQBracket+L.activityParty+I.p.closeSQBracket+I.p.space+I.p.openParenthesis+I.p.openSQBracket+L.activityPartyId+I.p.closeSQBracket+I.p.comma+I.p.openSQBracket+L.activityId+I.p.exclamation+L.id+I.p.closeSQBracket+I.p.comma+I.p.openSQBracket+L.activityId+I.p.exclamation+L.name+I.p.closeSQBracket+I.p.comma+I.p.openSQBracket+L.activityId+I.p.exclamation+L.logicalName+I.p.closeSQBracket+I.p.comma+I.p.openSQBracket+L.participationMasks+I.p.closeSQBracket+I.p.comma+I.p.openSQBracket+L.partyId+I.p.exclamation+L.id+I.p.closeSQBracket+I.p.comma+I.p.openSQBracket+L.partyId+I.p.exclamation+L.name+I.p.closeSQBracket+I.p.comma+I.p.openSQBracket+L.partyId+I.p.exclamation+L.logicalName+I.p.closeSQBracket+I.p.comma+I.p.openSQBracket+L.isPartyDeleted+I.p.closeSQBracket+I.p.closeParenthesis+I.p.space+I.c.values+I.p.space+I.p.openParenthesis+I.p.question+I.p.comma+I.p.question+I.p.comma+I.p.question+I.p.comma+I.p.question+I.p.comma+I.p.question+I.p.comma+I.p.question+I.p.comma+I.p.question+I.p.comma+I.p.question+I.p.comma+I.p.question+I.p.closeParenthesis),r.sqlParameters.push([M.Guid.newGuid().guid,t.id.guid,Object(i.isNullOrUndefinedOrEmptyString)(t.values[L.name])?"":t.values[L.name],t.entityLogicalName,e.participationType,e.partyId,e.partyName,e.partyLogicalName,o])}return r}function En(e){return e?`[${e}]`:`[${s.FILE_PREFIX.Common}]`}async function bn(e,t,r,n,a=[]){const o=await Object(_.getAttributesMetadata)(e,t,[],a);if(Object(i.isNullOrUndefinedOrEmpty)(o)){const e="Unable to get attribute metadata descriptor that associated to entity: "+t;return n.warn(`${En()} ${e}`,a),Promise.reject(e)}return!(!o[r]||o[r].Type!==T.AttributeType.Lookup&&o[r].Type!==T.AttributeType.Customer&&o[r].Type!==T.AttributeType.Owner)}async function On(e,t,r,n,a){if(a.internalRequest)return e;const o=await Object(_.getAttributesMetadata)(r,t,[],a.commonEventParameters);if(Object(i.isNullOrUndefinedOrEmpty)(o)||Object(i.isNullOrUndefinedOrEmpty)(o[e])){const r=`Unable to get attribute metadata descriptor that associated to entity: ${t}. Return the given attributeName: ${e}`;n.warn(`${En()} ${r}`,a.commonEventParameters)}else{const t=o[e];if(t.Type===T.AttributeType.Lookup||t.Type===T.AttributeType.Customer||t.Type===T.AttributeType.Owner)e=`[${e}${I.p.exclamation}id]`;else if(t.AttributeOf){const r=o[t.AttributeOf];Object(i.isNullOrUndefinedOrEmpty)(r)||r.Type!==T.AttributeType.Lookup&&r.Type!==T.AttributeType.Customer&&r.Type!==T.AttributeType.Owner||(e=t.Type===T.AttributeType.EntityName?`[${t.AttributeOf}${I.p.exclamation}logicalname]`:`[${t.AttributeOf}${I.p.exclamation}name]`)}}return e.endsWith("]")&&e.startsWith("[")&&(e=e.substring(1,e.length-1)),e}function vn(e){switch(e.toLowerCase()){case Ve.ConditionalOperator.equal:case Ve.ConditionalOperator.equalsUserId:return"=";case Ve.ConditionalOperator.notEqual:case Ve.ConditionalOperator.notEqualsUserId:return"!=";case Ve.ConditionalOperator.greaterThan:return">";case Ve.ConditionalOperator.greaterThanEqual:return">=";case Ve.ConditionalOperator.lessThan:return"<";case Ve.ConditionalOperator.lessThanEqual:return"<=";case Ve.ConditionalOperator.like:case Ve.ConditionalOperator.beginsWith:case Ve.ConditionalOperator.endsWith:return"like";case Ve.ConditionalOperator.notLike:case Ve.ConditionalOperator.notBeginWith:case Ve.ConditionalOperator.notEndWith:return"not like";case Ve.ConditionalOperator.in:case Ve.ConditionalOperator.equalsUserTeams:case Ve.ConditionalOperator.equalsUserOrUserTeams:return"in";case Ve.ConditionalOperator.notIn:return"not in";case Ve.ConditionalOperator.between:return"between";case Ve.ConditionalOperator.notBetween:return"not between";case Ve.ConditionalOperator.notNull:return"is not null";case Ve.ConditionalOperator.null:return"is null";default:const t="Invalid condition operator type "+e;throw new v.a(t)}}async function _n(e,t,r,a,i=[],o){let s;const u=new Headers;u.set(n.HEADER.CONTENT_TYPE,n.HEADER_VALUES.APPLICATION_JSON),r.info(Sn()+" Processing the retrieve response",i);const l=a;if(l&&l.length>0){const a=await async function(e,t,r,n,a=[],i){let o="";const s=await Tn(e,t,r,n,a,i);return s["@odata.context"]=e.url,o=JSON.stringify(s),o}(e,t,r,l,i,o);s=Object(N.b)(n.HTTP_STATUS_CODES.Ok,e.url,u,a)}else r.error(Sn()+" No response retrieved from offline DB for this request",i),s=Object(N.a)(n.HTTP_STATUS_CODES.Unknown,e.url,new v.a("No response retrieved from offline DB for this request",n.ErrorCode.DataStoreKeyNotFoundErrorCode));return s}async function Tn(e,t,r,o,s=[],u){let l={};const c=[],d=await cn(e,t,r,s);c.push({name:"EntityLogicalName",value:d});const p=o[0].rows.item(0);if(p){let f=!1;Object(N.d)(e)&&(f=!0),l=await Object(N.c)(t,p,d,f),l["@odata.type"]=d,u&&u.ContainsActivityPartyQuery&&async function(e,t,r,n,a){if(t.length>0){const i={};for(let e=0;e<t.length;e++){const r=await Object(N.c)(a,t.item(e),L.activityParty,n);i[r[L.participationMasks]]?i[r[L.participationMasks]].push(r):i[r[L.participationMasks]]=[r]}for(const t in i)if(i[t]&&r[+t]){const n=i[t];e[r[+t]]={entities:n,morerecords:!1,totalrecordcount:n.length,totalRecordCountLimitExceeded:!1}}}}(l,o[u.ActivityPartyQueryIndex].rows,u.ParticipationMasks,f,t),u&&u[n.EXPAND_PROPERTIES]&&await async function(e,t,r,a,o,s,u=[]){let l=0;for(;l<o[n.EXPAND_PROPERTIES].length;){const c=o[n.EXPAND_PROPERTIES][l],d=c.ExpandPropertyName,p=c.ExpandValueType,f=c.ExpandQueryIndex,y=c.ReferencedOrReferencingEntityName,m=t[f].rows;if(m)if(p===n.EXPAND_VALUES.MULTI_VALUE){let t=0;const n=[];for(;t<m.length;){const o=m.item(t++);if(!Object(i.isNullOrUndefined)(o.regardingfieldname)&&!Object(i.isNullOrUndefined)(o.fileattachmentid)){const t=o.regardingfieldname,r=e[t];if(o.fileattachmentid!==r){s.warn(`${Sn()} fileattachmentid on fileattachment record doesn't match with attribute ${t} value on parent entity record.`,u);continue}}const l=await Object(N.c)(a,o,y,r);n.push(l)}e[d]=n}else{const t=m.item(0);if(t){const n=await Object(N.c)(a,t,y,r);e[d]=n}else s.warn(`${Sn()} data for expand property ${d} is null.`,u)}l++}}(l,o,f,t,u,r),t.EventManager.ReportComponentSuccess(Sn(),Object(a.b)(s,c))}else r.error(Sn()+" No response retrieved from offline DB for this request",s);return l}function Sn(e){return e?`[${e}]`:`[${s.FILE_PREFIX.BPFResponseHandler}]`}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */async function Nn(e,t,r,i,o=[],l,c={}){const d=e.url;let p;const f=[];try{const a=Object(x.a)(e,r,o);i?!function(e,t){for(const r of e){if(Object(u.getRequestType)(r,t)===n.OPERATION.Retrieve)return!0}return!1}(a,t)?(f.push({name:"BatchResponseStatus",value:"Generating valid batch response"}),p=await async function(e,t,r,a,i,o={}){if(!a||!t)return Object(N.b)(n.HTTP_STATUS_CODES.NoContent,e);const s=[];for(let e=0;e<t.length;e++){const l=t[e],c=a.length>e&&a[e]?a[e]:null,d=i?i[e]:[];if(!c){s.push(Object(N.b)(n.HTTP_STATUS_CODES.InternalServerError,l.url));continue}const p=Object(u.getRequestType)(l);p?s.push(await Vn(l,p,r,c,void 0,d,o)):s.push(Object(N.b)(n.HTTP_STATUS_CODES.BadRequest,l.url))}return await Object(C.buildBatchResponse)(s)}(d,a,t,i,l,c)):!i||i.length<1?(f.push({name:"BatchResponseStatus",value:"Batch retrieve request returning empty response"}),p=Object(N.b)(n.HTTP_STATUS_CODES.NoContent,d)):(f.push({name:"BatchResponseStatus",value:"Batch retrieve request returning proper response"}),p=await async function(e,t,r,n,a=[],i){const o=e&&e.length>0?e[0]:void 0;let s;if(i&&i.BPFEntityLogicalName){const t=i&&i.BPFQueryIndex?i.BPFQueryIndex:1;s=e&&e.length>1?e[t]:void 0}if(!o)throw new Error("Unsupported offline batch request");const u=await Tn(o,t,r,n,a,i),l=await _n(o,t,r,n,a,i);if(s){const e=i&&i.BPFQueryIndex?i.BPFQueryIndex:1,o=await P(s,t,r,n&&n.length>e?n.slice(e,e+1):[],u,a,i);return await Object(C.buildBatchResponse)([l,o])}return await Object(C.buildBatchResponse)([l])}(a,t,r,i[0],o,l&&l.length>=1?l[0]:[])):(f.push({name:"BatchResponseStatus",value:"RawResponse is null or empty"}),p=Object(N.b)(n.HTTP_STATUS_CODES.NoContent,d))}catch(e){const t=e&&e.message?e.message:"Unknown";throw Object(a.a)(e,f),r.error(`${y?`[${y}]`:`[${s.FILE_PREFIX.BatchResponseHandler}]`} Exception in batchResponseHandler - ${t}`,Object(a.b)(o,f)),e}var y;
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */return p}async function Cn(e,t,r,a,i,o=[]){const s=e.url;let u,l="",c=null;i&&i[n.ADDITIONAL_PARAMETERS.RecordId]&&(c=i[n.ADDITIONAL_PARAMETERS.RecordId]);const d=new Headers;if(null!=c){const i=e.url+"("+c+")";d.append(n.HEADER.ODADTA_ENTITY_ID,i),r.info(Pn()+" Processing the create response"),l=await async function(e,t,r,n,a=[]){let i="";const o=n;let s={};if(Object(N.e)(e)&&o&&o.length>1&&o[1].rows.length>0){const n=o[1].rows.item(0);if(n){const o=await cn(e,t,r,a);let u=!1;Object(N.d)(e)&&(u=!0),s=await Object(N.c)(t,n,o,u),i=JSON.stringify(s)}}return i}(e,t,r,a,o),u=Object(N.b)(n.HTTP_STATUS_CODES.NoContent,s,d,l)}else r.error(Pn()+" Guid returned from sql executor is null",o),u=Object(N.a)(n.HTTP_STATUS_CODES.Unknown,s,new v.a("Guid returned from sql executor is null"));return u}function Pn(e){return e?`[${e}]`:`[${s.FILE_PREFIX.CreateResponseHandler}]`}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */function Rn(e,t,r,o,u=[]){const l=e.url,c=[];let d;if(Object(i.isUpsyncRequest)(e)||Object(i.isNullOrUndefined)(o)||!Object(i.isNullOrUndefined)(o[0])&&o[0].rows.length)d=Object(N.b)(n.HTTP_STATUS_CODES.NoContent,l,new Headers);else{const t=new v.a("You cannot delete this record because it doesn't exist in the offline mode",n.ErrorCode.CannotDeleteOnlineRecord);Object(a.a)(t,c),r.error((p?`[${p}]`:`[${s.FILE_PREFIX.DeleteResponseHandler}]`)+" You cannot delete this record because it doesn't exist in the offline mode",Object(a.b)(u,c)),d=Object(N.a)(n.HTTP_STATUS_CODES.BadRequest,e.url,t)}var p;
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */return d}async function wn(e,t,r,o,s=[],u){const l=e.url;r.info(Ln()+" Executing getClientMetadataResponseHandler.");const c=await async function(e,t,r,n,o=[],s){let u="";const l=n,c={},d={};let p=[];const f=ie(t,r);if(p.push({name:"RequestUrl",value:t.url}),p.push({name:"MetadataType",value:f.MetadataType}),p.push({name:"DependencyDepth",value:f.DependencyDepth}),p.push({name:"MetadataSubtype",value:f.MetadataSubtype}),r.info(Ln()+" Executing getGCMOperationResponseData",Object(a.b)(o,p)),l&&l.length>0)for(let e=0;e<l.length;e++)if(p=[],p.push({name:"NoOfResponsesReturnedFromDb",value:l.length}),p.push({name:"Index",value:e}),p.push({name:"RequestUrl",value:t.url}),l[e]&&l[e].rows.length>0)for(let t=0;t<l[e].rows.length;t++){const n=l[e].rows.item(t);if(n&&n.json){const t=n.json;let u;const l=Dn(n,JSON.parse(t),e,s);if(u=Mn(l,f),p.push({name:"MetadataType",value:l}),Object(i.isNullOrUndefined)(u))r.error(Ln()+" MetadataTypeKey evaluated to be null or empty",Object(a.b)(o,p));else{p.push({name:"MetadataTypeKey",value:u});const e=In(t,l,f);if(An(l))r.info(Ln()+" Creating response node for current MetaDataType."+u+". Taking response as it is as the response is already in required format",Object(a.b)(o,p)),d[u]=e;else if(d[u]){if(l===F.MetadataType.resourceString){const t=d[u][0];t.push(e),d[u]=[t]}else d[u].push(e);p.push({name:"NoOfMetadataForThisMetadataTypeKey",value:d[u].length}),r.info(Ln()+" Adding response for current MetaDataType."+u,Object(a.b)(o,p))}else d[u]=[e],l===F.MetadataType.resourceString&&(d[u]=[d[u]]),p.push({name:"NoOfMetadataForThisMetadataTypeKey",value:1}),r.info(Ln()+" Creating new response node for current MetaDataType."+u,Object(a.b)(o,p))}}else r.warn(Ln()+" Response returned from offline db has empty json.",Object(a.b)(o,p))}else r.warn(Ln()+" Response returned from offline db is empty at current index.",Object(a.b)(o,p));else r.warn(Ln()+" Response returned from offline db is empty",Object(a.b)(o,p));return c.Metadata=JSON.stringify(d),u=JSON.stringify(c),u}(0,e,r,o,s,u);return Object(N.b)(n.HTTP_STATUS_CODES.Ok,l,new Headers,c)}function Mn(e,t){let r;if(Object(i.isUserContextMetadataRequest)(t))r="UserContext";else switch(e){case F.MetadataType.none:r="none";break;case F.MetadataType.workspace:r="Dashboards";break;case F.MetadataType.form:r="Forms";break;case F.MetadataType.component:r="Component";break;case F.MetadataType.entityCard:r="EntityCard";break;case F.MetadataType.quickCreateForm:r="QuickCreateForm";break;case F.MetadataType.customization:r="Customization";break;case F.MetadataType.listQuery:r="ListQuery";break;case F.MetadataType.grid:r="Grid";break;case F.MetadataType.command:r="Ribbons";break;case F.MetadataType.siteMap:r="Sitemap";break;case F.MetadataType.list:r="List";break;case F.MetadataType.dialog:r="Dialogs";break;case F.MetadataType.gridForm:r="GridForm";break;case F.MetadataType.inlineCreateForm:r="InlineCreateForm";break;case F.MetadataType.processControl:r="ProcessControl";break;case F.MetadataType.fetchXml:r="FetchXml";break;case F.MetadataType.chartDrilldownForm:r="ChartDrilldownForm";break;case F.MetadataType.entity:r="Entities";break;case F.MetadataType.attribute:r="Attributes";break;case F.MetadataType.webResource:r="WebResourcesContent";break;case F.MetadataType.applicationMetadata:r="ApplicationMetadata";break;case F.MetadataType.mainFormDialog:r="QuickEditForm";break;case F.MetadataType.chart:r="Chart";break;case F.MetadataType.uiStrings:r="UIStrings";break;case F.MetadataType.businessLogic:r="BusinessLogic";break;case F.MetadataType.searchPage:r="SearchPage";break;case F.MetadataType.globalApplicationMetadata:r="GlobalApplicationMetadata";break;case F.MetadataType.applicationMetadataUserContext:r="ApplicationMetadataUserContext";break;case F.MetadataType.staticJSFile:r="StaticJSFile";break;case F.MetadataType.layoutXml:r="LayoutXml";break;case F.MetadataType.draftsPage:r="DraftsPage";break;case F.MetadataType.duplicateRecordsPage:r="DuplicateRecordsPage";break;case F.MetadataType.applicationMetadataSettings:r="ApplicationMetadataSettings";break;case F.MetadataType.senderFormPage:r="SenderFormPage";break;case F.MetadataType.setRegarding:r="SetRegarding";break;case F.MetadataType.senderCreateFormPage:r="SenderCreateFormPage";break;case F.MetadataType.interactionCentricWorkspace:r="Dashboards";break;case F.MetadataType.taskBasedFlowGlobalMenu:r="TaskBasedFlowGlobalMenu";break;case F.MetadataType.taskBasedFlow:r="TaskBasedFlows";break;case F.MetadataType.interactionCentricForm:r="InteractionCentricForm";break;case F.MetadataType.cardForm:r="CardForm";break;case F.MetadataType.controlConfiguration:r="ControlConfiguration";break;case F.MetadataType.commandXaml:r="CommandXaml";break;case F.MetadataType.documentTemplate:r="DocumentTemplate";break;case F.MetadataType.viewSelector:r="ViewSelectors";break;case F.MetadataType.customControl:r="CustomControls";break;case F.MetadataType.formSelector:r="FormSelectors";break;case F.MetadataType.resourceString:r="ResourceStrings";break;case F.MetadataType.savedQueryVisualization:r="SavedQueryVisualizations";break;case F.MetadataType.label:r="Labels";break;case F.MetadataType.userView:case F.MetadataType.savedView:r="Views";break;case F.MetadataType.viewDefault:r="ViewDefault";break;case F.MetadataType.homePageConfiguration:r="CustomControlConfigurations";break;case F.MetadataType.optionSet:r="OptionSets";break;case F.MetadataType.quickCreateMenu:r="QuickCreateMenu";break;case F.MetadataType.userContext:r="UserContext";break;case F.MetadataType.businessProcessFlow:r="BusinessProcessFlowMetadata";break;case F.MetadataType.searchConfiguration:r="Search";break;case F.MetadataType.userQueryVisualization:r="UserQueryVisualizations";break;case F.MetadataType.visualizationSelector:r="VisualizationSelectors";break;case F.MetadataType.dashboardSelector:r="DashboardSelectors";break;case F.MetadataType.overallMetadataVersion:r="MetadataVersion";break;case F.MetadataType.appModule:r="AppModulePublished";break;case F.MetadataType.complexControl:r="ComplexControls";break;case F.MetadataType.displayString:r="DisplayStrings";break;case F.MetadataType.webResourceDescriptor:r="WebResources";break;case F.MetadataType.isActivityFlags:r="IsActivityFlags";break;case F.MetadataType.appModuleOfflineMetadata:r="AppModules";break;case F.MetadataType.appModuleSelector:r="AppModuleSelector";break;case F.MetadataType.bpfSelector:r="BPFSelectors";break;case F.MetadataType.dependencies:r="dependencies"}return r}function In(e,t,r){let n;const a=JSON.parse(e);if(Object(i.isUserContextMetadataRequest)(r))n=a;else switch(t){case F.MetadataType.attribute:case F.MetadataType.entity:n=a;break;case F.MetadataType.searchConfiguration:n=a.data.Search;break;case F.MetadataType.quickCreateMenu:n=a.data.QuickCreateMenu;break;default:n=a.data}return n}function An(e){switch(e){case F.MetadataType.quickCreateMenu:case F.MetadataType.searchConfiguration:return!0;default:return!1}}function Dn(e,t,r,n){let a=F.MetadataType.none;return a=e.metadatatype?e.metadatatype:t.metadatatype?t.metadatatype:n&&n[k.i.METADATA_TYPE]&&Array.isArray(n[k.i.METADATA_TYPE])&&r<n[k.i.METADATA_TYPE].length?n[k.i.METADATA_TYPE][r]:F.MetadataType.entity,a}function Ln(e){return e?`[${e}]`:`[${s.FILE_PREFIX.GetClientMetadataResponseHandler}]`}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */async function Un(e,t,r,a,o,s,u){const l=u.commonEventParameters||[];if(r<=0)return;const c={},d=[];try{for(let n=0;n<r;n++){const r=Fn(e[n]);if(Object(i.isNullOrUndefinedOrEmpty)(r))continue;const o=await Object(_.getAttributeTypes)(a,Object.keys(r),t,l);await xn(a,d,c,o,r,l)}if(0===d.length)return;const p={},f={};await async function(e,t,r,a,i,o){const s=o.commonEventParameters||[];for(const u in e){const l=await Object(_.getEntityMetadata)(a,u),c=l&&l.PrimaryIdAttribute?l.PrimaryIdAttribute:`${u}${L.id}`,d=l&&l.PrimaryNameAttribute?l.PrimaryNameAttribute:L.name,p=await _e(e[u],u,c,d,i,s);let f=[];p.sqlStatements&&p.sqlStatements.length>0&&(f=await A(p,a,n.OPERATION.Retrieve,o)),(null==f?void 0:f.length)>0&&(null==f?void 0:f[0].rows.length)>0&&(t[u]=f,r[u]={id:c,name:d})}}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */(c,p,f,a,o,u);const y={};for(const e in p){const t=p[e];for(let r=0;r<t[0].rows.length;r++){const n=t[0].rows.item(r),a=Object.keys(n);n&&f[e]&&a.includes(f[e].id)&&a.includes(f[e].name)&&(y[n[f[e].id].toUpperCase()]=n[f[e].name])}}if(Object(i.isNullOrUndefinedOrEmpty)(y))return void o.warn(s+" Unable to map refresh lookup data to the existing record. Skip refreshing lookup data.",l);for(let t=0;t<r;t++){const r=e[t],n=Object.keys(r);for(const a of d){const o=`${a}${I.p.exclamation}${L.id}`;n.includes(o)&&r[o]&&!Object(i.isNullOrUndefinedOrEmpty)(y[r[o].toUpperCase()])&&(e[t][`${a}${I.p.exclamation}${L.name}`]=y[r[o].toUpperCase()])}}}catch(e){o.warn(`${s} Failed to refreshRetrieveMultipleLookupData with ${e}`,l)}}function Fn(e){const t={},r=Object.keys(e);for(const n of r){const r=n.split(L.columnDelimiter),a=Object(i.isNullOrUndefined)(r[0])?"":r[0];2===r.length&&r[1]&&[L.id,L.logicalName,L.name].includes(r[1])&&(t[a]?t[a][r[1]]=e[n]:t[a]={[""+r[1]]:e[n]})}return t}async function xn(e,t,r,n,a,o=[]){const s=await Object(_.getOfflineAvailableEntities)(e,o);for(const e in n){const o=n[e];if(o===T.AttributeType.Lookup||o===T.AttributeType.Customer||o===T.AttributeType.Owner&&e in a){const n=a[e];if(Object(i.isNullOrUndefinedOrEmpty)(n))continue;if(s.includes(n.logicalname)){t.indexOf(e)<0&&t.push(e);const a=n.logicalname in r?r[n.logicalname]:[];a.indexOf(n.id.toUpperCase())<0&&(a.push(n.id.toUpperCase()),r[n.logicalname]=a)}}}}async function kn(e,t,r,o,s,u={}){const l=u.commonEventParameters||[],c=e.url;let d;const p=[];let f="",y=await cn(e,t,r,l,u),m=!1;if(u.internalRequest&&(Object(i.isEntityLogTable)(y)&&(y=Object(i.getEntityNameForEntityLogTable)(y),m=!0),Object(i.isOfflineOnlyEntity)(y)))return function(e,t,r,i=[]){const o=e.url;let s;const u=[];let l="",c=0;const d=r,p=[],f={};if(d&&d.length>0){c=d[0].rows.length;for(let e=0;e<c;e++)p.push(d[0].rows.item(e))}return f["@Microsoft.Dynamics.CRM.totalrecordcount"]=c,f.value=p,l=JSON.stringify(f),u.push({name:"NoOfRecordsReturned",value:c}),t.EventManager.ReportComponentSuccess(Bn(),Object(a.b)(i,u)),s=Object(N.b)(n.HTTP_STATUS_CODES.Ok,o,new Headers,l),s}(e,t,o,l);let h=0,g=0,E=!1,b=!1,O=Number(I.d.PageNumber),v=-1,T=[];const S=o,C={},P=[];if(S&&S.length>0){const o=await Object(_.getEntityMetadata)(t,y),c=o&&o.PrimaryIdAttribute?o.PrimaryIdAttribute:y+"id";s&&!Object(i.isNullOrUndefined)(s[n.ADDITIONAL_PARAMETERS.PageSize])?h=Number(s[n.ADDITIONAL_PARAMETERS.PageSize]):r.warn(Bn()+" Paging size is not passed in additional parameters",Object(a.b)(l,p)),s&&s[n.ADDITIONAL_PARAMETERS.PageNumber]&&(O=Number(s[n.ADDITIONAL_PARAMETERS.PageNumber])),s&&s[n.ADDITIONAL_PARAMETERS.Expand]&&(T=s[n.ADDITIONAL_PARAMETERS.Expand]),s&&s[n.ADDITIONAL_PARAMETERS.Top]&&(v=s[n.ADDITIONAL_PARAMETERS.Top]),S[0].rows.length>h?(E=!0,b=!0,g=h):g=S[0].rows.length,jn(e)&&v>0&&h<v&&v-h*O<0&&(g=v-(O-1)*h);const d=[];for(let e=0;e<g;e++)d.push(S[0].rows.item(e));await Un(d,y,g,t,r,Bn(),u);let f={};e.additionalHeaders&&e.additionalHeaders[n.HINT.linkEntity]&&(f=await async function(e,t,r,n=[]){const a={};if(!Object(i.isNullOrUndefinedOrEmptyString)(e)){const i=e.split(";").map(e=>e.trim());if(i)for(const e of i)try{const i=Ur(e,r,n),o=await Object(_.getEntityMetadata)(t,i.entityLogicalName),{linkEntityName:s}=Fr(o,i.relationshipName,i.roleOrdinal,r,n);a[i.alias]=s}catch(e){r.warn(Bn()+" Link entities map cannot be built from the link entities hint",n)}}return a}(e.additionalHeaders[n.HINT.linkEntity],t,r,l));for(let r=0;r<g;r++){const n=d[r];let a={},o=!1;Object(N.d)(e)&&(o=!0),n&&(a=await Object(N.c)(t,n,y,o,f,[],m),!Object(i.isNullOrUndefined)(T)&&T.length>0&&qn(a,T,y,c),P.push(a))}}return C["@Microsoft.Dynamics.CRM.totalrecordcount"]=g,C["@Microsoft.Dynamics.CRM.totalrecordcountlimitexceeded"]=b,C["@Microsoft.Dynamics.CRM.morerecords"]=E,C.value=P,s&&function(e,t){if(jn(e)&&t[n.ADDITIONAL_PARAMETERS.ODataQuery])return!0;return!1}(e,s)&&E&&function(e,t,r,a,o,s,u,l=[],c){if(!s[n.ADDITIONAL_PARAMETERS.MaxPageSize])return;const d=s[n.ADDITIONAL_PARAMETERS.MaxPageSize],p=s[n.ADDITIONAL_PARAMETERS.ODataQuery];if(o<0||a*r<o){let r;if(-1===p.indexOf(Ue.skipToken))r=`${p}&${Ue.skipToken}=${a+1}`;else{const e=Fe(p,u,l,c);for(const t in e)Object(i.isNullOrUndefinedOrEmptyString)(r)?r=I.p.question:r+="&",t===Ue.skipToken&&(e[t]=a+1),r+=`${t}=${e[t]}`}e[Ue.oDataNextLink]={API:"{Xrm.Mobile.offline}.{retrieveRecord}",entityType:t,options:r,maxPageSize:d}}}(C,y,h,O,v,s,r,l,Object(i.isUpsyncRequest)(e)),f=JSON.stringify(C),p.push({name:"NoOfRecordsReturned",value:g}),p.push({name:"TotalRecordCountLimitExceeded",value:b}),p.push({name:"MoreRecords",value:E}),p.push({name:"PageSize",value:h}),t.EventManager.ReportComponentSuccess(Bn(),Object(a.b)(l,p)),d=Object(N.b)(n.HTTP_STATUS_CODES.Ok,c,new Headers,f),d}function jn(e){return!(!e.additionalHeaders||e.additionalHeaders[n.HINT.viewId])}function qn(e,t,r,n){if(!Object(i.isNullOrUndefined)(t)&&t.length>0)for(let a=0;a<t.length;a++)e[`${t[a].navigationProperty}${Ue.oDataNextLink}`]={API:"{Xrm.Mobile.offline}.{retrieveRecord}",id:e[""+n].toString(),entityType:r,option:`?$select=${n}&${De(t[a])}&$getOnlyRelatedEntity=true`},e[t[a].navigationProperty]={}}function Bn(e){return e?`[${e}]`:`[${s.FILE_PREFIX.RetrieveMultipleResponseHandler}]`}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */function $n(e,t,r,a,o=[],u={}){let l;if(Object(i.isUpsyncRequest)(e)||Object(i.isNullOrUndefined)(a)||!Object(i.isNullOrUndefined)(a[0])&&a[0].rows.length){const t=new Headers;t.append(n.HEADER.ODADTA_ENTITY_ID,e.url),l=Object(N.b)(n.HTTP_STATUS_CODES.NoContent,e.url,t)}else r.error((c?`[${c}]`:`[${s.FILE_PREFIX.UpdateResponseHandler}]`)+" You cannot update this record because it doesn't exist in the offline mode",o),l=Object(N.a)(n.HTTP_STATUS_CODES.BadRequest,e.url,new v.a("You cannot update this record because it doesn't exist in the offline mode",n.ErrorCode.CannotUpdateOnlineRecord));var c;
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */return l}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
async function Vn(e,t,r,a,i,o,u={}){let l;u.performanceControl&&u.performanceControl.startMarker(s.FILE_PREFIX.ResponseHandler);const c=r.TraceManager.getTracer(s.COMPONENT_NAMES.ResponseHandler),d=u.commonEventParameters||[];if(i)c.info((p?`[${p}]`:`[${s.FILE_PREFIX.ResponseHandler}]`)+" Executing error response handler",d),l=Object(N.a)(n.HTTP_STATUS_CODES.InternalServerError,e.url,i);else switch(t){case n.OPERATION.Create:l=await Cn(e,r,c,a,o,d);break;case n.OPERATION.Batch:l=await Nn(e,r,c,a,d,o,u);break;case n.OPERATION.Update:l=$n(e,0,c,a,d);break;case n.OPERATION.Retrieve:l=await _n(e,r,c,a,d,o);break;case n.OPERATION.RetrieveMultiple:l=await kn(e,r,c,a,o,u);break;case n.OPERATION.GetClientMetadata:l=await wn(e,0,c,a,d,o);break;case n.OPERATION.Delete:case n.OPERATION.FileDelete:l=Rn(e,0,c,a,d);break;case n.OPERATION.Upload:l=function(e,t,r,a,i){const o=e.url;let s;return s=Object(N.b)(n.HTTP_STATUS_CODES.NoContent,o),s}(e);break;default:l=Object(N.b)(n.HTTP_STATUS_CODES.BadRequest,e.url)}var p;
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */return u.performanceControl&&u.performanceControl.endMarker(s.FILE_PREFIX.ResponseHandler),l}async function Hn(e,t,r,n){return await Vn(e,t,r,void 0,void 0,void 0,n)}class Gn extends y{async intercept(e){const t=e.executionContext||{},r=e.request,a=t.requestType||Object(u.getRequestType)(r,this.applicationContext),o=this.applicationContext.TraceManager.getTracer(s.COMPONENT_NAMES.FileExecutor),l=t.commonEventParameters||[];let c;o.info(Qn()+" File Executor is processing");try{switch(a){case n.OPERATION.Upload:await async function(e,t,r={}){const a=t.TraceManager.getTracer(s.COMPONENT_NAMES.FileExecutor);a.info(S()+" ExecuteFileUploadRequest - File Executor Started");const o=r.commonEventParameters||[];if(!e.url)throw a.error(S()+" url is invalid",o),new Error("Empty url is not valid");if(!e.additionalHeaders)throw a.error(S()+" additionalHeaders is invalid",o),new Error("additionalHeaders not valid");const u=e.url.split("/"),l=u[u.length-1].split("(")[0].split("?")[0],c=e.url.indexOf("x-ms-file-name="),d=e.url.substring(c+"x-ms-file-name=".length),p=u[u.length-2],f=p.split("(")[0],y=await Object(_.getEntityLogicalName)(t,f,o),m=p.substring(p.lastIndexOf("(")+1,p.lastIndexOf(")")),h=e.additionalHeaders[n.HINT.MIME_TYPE],g=+e.additionalHeaders[n.HINT.FILE_SIZE],E=e.additionalHeaders[n.HINT.FILE_URL];try{const e=await Object(_.getAttributeTypes)(t,[l],y);if(o.push({name:"EntityName",value:y}),o.push({name:"EntityId",value:m}),o.push({name:"FileSize",value:g}),o.push({name:"AttributeName",value:l}),!e||!e[l]||e[l]!==T.AttributeType.File&&e[l]!==T.AttributeType.Image){const t=e&&e[l]?e[l]:"Unknown",r=e&&e[l]?"Attribute type is not valid for file or image upload":"Attribute metadata not found for given attribute type";o.push({name:"MetadataType",value:t});const n=new v.a(r);throw a.error(r,o),n}if(e[l]===T.AttributeType.File){const e={entityId:m,entityLogicalName:y,entityFieldName:l,canMove:!0,fileUrl:{filename:d,resourceUrl:E,mimeType:h,size:g}},r=JSON.stringify(e);await t.SqlExecutor.attachFileToEntity(r)}else{const e=await Object(_.getAttributesMetadata)(t,y,[l],o);if(!e){const e="Unable to get attribute metadata descriptor that associated to entity: "+y;return a.warn(`${S()} ${e}`,o),Promise.reject(e)}{const r={entityId:m,entityLogicalName:y,entityFieldName:e[l].AttributeOf,canMove:!0,fileUrl:{filename:d,resourceUrl:E,mimeType:h,size:g},imageMetadata:{}},n=JSON.stringify(r);await t.SqlExecutor.attachImageToEntity(n)}}}catch(e){const t=Object(i.convertErrorToLocalError)(e);throw a.error("Offline File upload failed",o),t}}(r,this.applicationContext,t);break;case n.OPERATION.FileDelete:await async function(e,t,r={}){const n=t.TraceManager.getTracer(s.COMPONENT_NAMES.FileExecutor);n.info(S()+" ExecuteFileDeleteRequest - File Executor Started");const a=r.commonEventParameters||[];if(!e.url)throw n.error(S()+" url is invalid",a),new Error("Empty url is not valid");const o=e.url.split("/"),u=o[o.length-1],l=o[o.length-2],c=l.split("(")[0],d=await Object(_.getEntityLogicalName)(t,c,a),p=l.substring(l.lastIndexOf("(")+1,l.lastIndexOf(")"));try{const e=await Object(_.getAttributeTypes)(t,[u],d);if(a.push({name:"EntityName",value:d}),a.push({name:"EntityId",value:p}),a.push({name:"AttributeName",value:u}),!e||!e[u]||e[u]!==T.AttributeType.File&&e[u]!==T.AttributeType.Image){const t=e&&e[u]?e[u]:"Unknown",r=e&&e[u]?"Attribute type is not valid for file or image upload":"Attribute metadata not found for given attribute type";a.push({name:"MetadataType",value:t});const i=new v.a(r);throw n.error(`${S()} ${r}`,a),i}{const r=e[u],i=r===T.AttributeType.File?"File":"Image",o=await Object(_.getAttributesMetadata)(t,d,[u],a);if(!o||!o[u]){const e="Unable to get attribute metadata descriptor that associated to entity: "+d;return n.warn(`${S()} ${e}`,a),Promise.reject(e)}{const e=o[u].AttributeOf,n={entityId:p,entityLogicalName:d,entityFieldName:r===T.AttributeType.File?u:e,attachmentType:i},a=JSON.stringify(n);await t.SqlExecutor.deleteAttachment(a)}}}catch(e){const t=Object(i.convertErrorToLocalError)(e);throw n.error("Offline File delete failed",a),t}}(r,this.applicationContext,t);break;default:throw new Error("Request type is not supported")}}catch(e){const n={name:e.name?e.name:"File Executor",message:e.message?e.message:JSON.stringify(e)};return c=await Vn(r,a,this.applicationContext,void 0,n,void 0,t),o.error(`${Qn()} File Local OData Client return back error response \n status code: ${c.status}\n error message: ${c.statusText}`,l),c}return o.info(Qn()+" Response Handler is processing"),c=await Vn(r,a,this.applicationContext,void 0,void 0,void 0,t),o.info(`${Qn()} File Local OData Client return back response\n status code: ${c.status}\n url: ${c.url}`),c}}function Qn(e){return e?`[${e}]`:`[${s.FILE_PREFIX.FileRequestInterceptor}]`}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */class Xn extends O{constructor(e,t){super(e,t),this.setExecuteRequestInterceptor(new Gn(this.applicationContext)).build()}}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */class Wn extends O{constructor(e,t){super(e,t),this.setExecuteRequestInterceptor(new Gr(this.applicationContext)).build()}}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */class zn{constructor(e,t){this._applicationContext=t,this._sqlLocalODataClient=new Wn(e,t),this._fileLocalODataClient=new Xn(e,t)}getLocalODataClient(e,t=[]){let r="";const a=this._applicationContext.TraceManager.getTracer(s.COMPONENT_NAMES.ODataExecutor);if(r=Object(u.getRequestType)(e,this._applicationContext),a.info(`${Yn()} URL Parser Handler returns ${r} request type`),n.SQLQuerySupportedList.indexOf(r)>-1)return a.info(Yn()+" Local OData Client Manager called SQL Local Client"),this._sqlLocalODataClient;if(n.FileQuerySupportedList.indexOf(r)>-1)return a.info(Yn()+" Local OData Client Manager called File Local Client"),this._fileLocalODataClient;{const e="No LocalODataClient type matched with request";throw a.error(`${Yn()} ${e}`,t),new Error(e)}}}function Yn(e){return e?`[${e}]`:`[${s.FILE_PREFIX.LocalODataClientManager}]`}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */class Kn extends y{async execute(e,t){throw new Error("execute function is not implemented")}async preprocessing(e){return e}async postprocessing(e,t){return e}async intercept(e){const t=e.executionContext,r=e.request,n=await this.preprocessing(r);this.tracer.info(`${this.getExecuteRequestInterceptorPrefix()} Execute request start ${n.url}`);const a=await this.execute(n,t);this.tracer.info(`${this.getExecuteRequestInterceptorPrefix()} Execute request finish ${a.status}`);return await this.postprocessing(a,r)}getExecuteRequestInterceptorPrefix(e){return e?`[${e}]`:`[${s.FILE_PREFIX.ExecuteRequestInterceptor}]`}}var Jn=r("bzGb");
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */class Zn extends Kn{async execute(e,t){const r=new Headers,o=this.applicationContext.TraceManager.getTracer(s.COMPONENT_NAMES.RemoteODataExecutor),u=this._stripHintsFromHeader(e,o),l=u.additionalHeaders,c=[];if(Object(a.c)(u,c),l)for(const e in l)Object(i.getHttpHeader)(r,e)&&r.delete(e),r.append(e,l[e]);const d=new Request(u.url,{method:u.method,credentials:"same-origin",headers:r,body:u.body});try{t&&t.performanceControl&&t.performanceControl.startMarker(s.FILE_PREFIX.FetchRequest);const e=await fetch(d);return t&&t.performanceControl&&t.performanceControl.endMarker(s.FILE_PREFIX.FetchRequest),e}catch(e){const t=e&&e.message?e.message:"Failed to fetch",r="Failed to fetch"===t?n.ErrorCode.NetworkIssue:e.code;return e.message=t,e.code=r,c.push({name:s.EVENT_PARAMETERS.REQUEST_URL,value:Object(Jn.b)(u.url)}),Object(a.a)(e,c),o.error(`${this.getHttpExecutorInterceptorPrefix()} ${t}`,c),Object(i.buildODataResponseFromError)(e,u.url,void 0,r)}}getHttpExecutorInterceptorPrefix(e){return e?`[${e}]`:`[${s.FILE_PREFIX.HttpExecutorInterceptor}]`}_stripHintsFromHeader(e,t){try{if(e.additionalHeaders)for(const t in n.HINT)delete e.additionalHeaders[n.HINT[t]]}catch(e){const r="Exception in _stripHintsFromHeader";e.message=r,t.error(`${this.getHttpExecutorInterceptorPrefix()} ${r}`)}return e}}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */class ea extends y{async intercept(e){let t=e.request;const r=Object(i.encodeURIComponentForOData)(t.url),n="GET"===t.method&&r.length>1800,o=this.applicationContext.TraceManager.getTracer(s.COMPONENT_NAMES.RemoteODataExecutor),u=e.executionContext?e.executionContext.commonEventParameters:[],l=[];l.push({name:"UrlRequestLength",value:r.length}),o.info(this.getLongRequestInterceptorPrefix()+" Start Execute Remote Request ",Object(a.b)(u,l)),n&&(t=Object(i.buildBatchRequest)([t]),o.warn(this.getLongRequestInterceptorPrefix()+" Built batch request for long request",Object(a.b)(u,l)));let c=await e.proceed(t);if(n){c=(await Object(i.parseBatchResponse)(c))[0],o.warn(this.getLongRequestInterceptorPrefix()+" Parsed batch request for long request",Object(a.b)(u,l))}return o.info(this.getLongRequestInterceptorPrefix()+" Finish Execute Remote Request",Object(a.b)(u,l)),c}getLongRequestInterceptorPrefix(e){return e?`[${e}]`:`[${s.FILE_PREFIX.LongRequestInterceptor}]`}}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */class ta{constructor(e,t){this._applicationContext=t,this._HttpODataClient=new O(e,this._applicationContext).addInterceptor(new ea(this._applicationContext)).setExecuteRequestInterceptor(new Zn(this._applicationContext)).build()}getRemoteODataClient(e){return this._HttpODataClient}}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */class ra{constructor(e,t){this._remoteODataClient=new ta(e,t),this._localODataClient=new zn(e,t),this._applicationContext=t}getODataClient(e){const t=this._applicationContext.TraceManager.getTracer(s.COMPONENT_NAMES.ODataExecutor),r=[];Object(a.c)(e,r);return Object(i.getClientType)(e,t,r)===n.CLIENT_TYPE.local?this._localODataClient.getLocalODataClient(e,r):this._remoteODataClient.getRemoteODataClient(e)}getODataClientManagerPrefix(e){return e?`[${e}]`:`[${s.FILE_PREFIX.ODataClientManager}]`}}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */class na{constructor(e,t){this._applicationContext=t,this._oDataClientManager=new ra(e||{},this._applicationContext)}async execute(e,t){var r,l,c;const d=new o;d.startMarker(s.FILE_PREFIX.ODataExecutor);const p=this._applicationContext.TraceManager.getTracer(s.COMPONENT_NAMES.ODataExecutor);let f=[];Object(a.c)(e,f);try{const o=this._oDataClientManager.getODataClient(e),c=Object(u.getRequestType)(e,this._applicationContext),y={requestType:c,commonEventParameters:f,performanceControl:d,clientRequestId:Object(i.getClientRequestId)(e)||""},m=await o.execute(e,y);d.startMarker(s.FILE_PREFIX.CloneRequest);const h=m.clone();if(d.endMarker(s.FILE_PREFIX.CloneRequest),d.endMarker(s.FILE_PREFIX.ODataExecutor),m.ok){Object(a.d)(h,f);const o=Object(i.getClientType)(e,p,f);let u=[s.FILE_PREFIX.ODataExecutor,s.FILE_PREFIX.ResponseHandler,s.FILE_PREFIX.CloneRequest];o===n.CLIENT_TYPE.local?u=u.concat([s.FILE_PREFIX.SQLGenerator,s.FILE_PREFIX.MetadataSQLExecutor,s.FILE_PREFIX.DataSQLExecutor]):u.push(s.FILE_PREFIX.FetchRequest);const l=Object(a.h)(d,u);!Object(i.isNullOrUndefinedOrEmpty)(l)&&t&&(t.eventParameters=Object(a.b)(t.eventParameters,l)),(null===(r=this._applicationContext.AdditionalParameters)||void 0===r?void 0:r.EnabledODataExecutorTrace)&&this._applicationContext.EventManager.ReportComponentSuccess(s.COMPONENT_NAMES.ODataExecutor,Object(a.b)(f,l))}else if(null===(l=this._applicationContext.AdditionalParameters)||void 0===l?void 0:l.EnabledODataExecutorTrace){f=await Object(a.e)(h,f,c);const e=m.status;if(p.warn(`[${s.FILE_PREFIX.ODataExecutor}] Request returns Error Response with status code: ${e}`,f),n.UNEXPECTED_STATUS_CODE.includes(e)){let e="Request Failed",t=0;for(;t<f.length;t++)if(f[t].name===s.EVENT_PARAMETERS.ERROR_MESSAGE&&f[t].value!==s.EVENT_PARAMETERS.EMPTY_STRING){e=f[t].value;break}p.warn(`[${s.FILE_PREFIX.ODataExecutor}] ${e}`,f)}}return m}catch(t){const r=t&&t.message?t.message:"OData Request Failed";return t&&(t.message=r),(null===(c=this._applicationContext.AdditionalParameters)||void 0===c?void 0:c.EnabledODataExecutorTrace)&&(Object(a.a)(t,f),p.error(`[${s.FILE_PREFIX.ODataExecutor}] ${r}`,f)),Object(i.buildODataResponseFromError)(t,e.url)}}}},ODI4:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(a,i){function o(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((n=n.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var r,n,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(a=2&i[0]?n.return:i[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,i[1])).done)return a;switch(n=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,n=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],n=0}finally{r=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},i=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},o=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,a,i=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)o.push(n.value)}catch(e){a={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(a)throw a.error}}return o},s=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(o(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0}),t.parseResponseForRowVersion=t._splitByBoundary=t.parseBatchResponse=t.getEntityIdFromResponse=t.parseResponseAsGuid=t.getEntityReferenceFromResponse=void 0;var u=r("Ln9p"),l=r("kJz0"),c=r("ykA9"),d=r("rW8f");function p(e){var t=c.getHttpHeader(e.headers,"OData-EntityId");if(t){var r=t.indexOf("(")+1,n=t.substring(r,t.length-1);return u.Guid.tryParse(n)}return null}function f(e,t){if(!t)return[];var r="--"+e+"\r\n";0===t.indexOf(r)||(r="--"+e+"\n");var n=t.split(r);if(n.splice(0,1),n.length>0){var a=n[n.length-1],i=a.indexOf("--"+e);n[n.length-1]=a.substring(0,i)}return n}function y(e,t){var r=t.indexOf(":");if(r>=0){var n=t.substring(0,r),a=t.substring(r+1).trim();e[n]=a}return e}function m(e){var t,r,n=-1!==e.indexOf("\r\n\r\n"),a=e.trim().split(n?"\r\n\r\n":"\n\n"),o=-1,s=null,u=null,c="",d="";if(a.length>0){var p=null;a.length>1&&(p=a[1].split(n?"\r\n":"\n"));var f=null;null!=p&&(f=p.slice(1),u=/(HTTP\/\d\.\d) (\d+) (.*)/gi.exec(p[0]));var m=a[0].split(n?"\r\n":"\n");if(null!=m)try{for(var g=i(m),E=g.next();!E.done;E=g.next()){var b=E.value;0===b.toLowerCase().indexOf("content-id:")&&(null==f||f.push(b))}}catch(e){t={error:e}}finally{try{E&&!E.done&&(r=g.return)&&r.call(g)}finally{if(t)throw t.error}}if(o=u&&u.length>=3?Number(u[2]):0,f){var O=f.reduce(y,{});s=new l.FetchLikeHeaders(O)}a.length>1&&(d=a[2]),null!=u&&u.length>2&&(c=u[3])}return h(o,c,s,d)}function h(e,t,r,n){return{status:e,ok:200<=e&&299>=e,statusText:t,headers:r,clone:function(){return Object.assign({},this)},json:function(){return Promise.resolve(n?JSON.parse(n):null)},text:function(){return Promise.resolve(n)}}}function g(e){var t=c.getHttpHeader(e.headers,"ETag");if(!t)return null;var r=t.indexOf('"')+1;return t.substring(r,t.length-1)}t.parseResponseAsGuid=p,t.getEntityReferenceFromResponse=function(e,t){var r=p(e),n=g(e);return new d.LegacyEntityReference(t,u.Guid.toLegacyGuid(r),void 0,n)},t.getEntityIdFromResponse=function(e,t){return n(this,void 0,void 0,(function(){var r,n;return a(this,(function(a){switch(a.label){case 0:return(r=p(t))?[3,2]:[4,t.json()];case 1:return n=a.sent(),[2,u.Guid.tryParse(n[e])];case 2:return[2,r]}}))}))},t._splitByBoundary=f,t.parseBatchResponse=function(e,t){return n(this,void 0,void 0,(function(){var r,n,o,u,l,d,p,y,g,E,b,O,v,_,T,S,N,C,P;return a(this,(function(a){switch(a.label){case 0:return null==t||t.AppendCallStack("Parsers.parseBatchResponse"),[4,e.text()];case 1:r=a.sent(),n=[],e.headers?(u=/boundary=(.*)/,l=c.getHttpHeader(e.headers,"Content-Type"),d=l&&u.test(l)&&u&&l.match(u),o=d&&d.length>1?d[1]:""):o=r.substr(r.indexOf("batchresponse"),r.indexOf("\r\n")-2),p=f(o,r);try{for(y=i(p),g=y.next();!g.done;g=y.next())E=g.value,(b=/^\s*Content-Type: .*boundary=(.*)\r?\n/gi.exec(E))?(O=b[1],v=E.indexOf("--"+O),_=E.slice(v),T=f(O,_),S=T.map(m),n.push.apply(n,s(S))):(N=m(E),n.push(N))}catch(e){C={error:e}}finally{try{g&&!g.done&&(P=y.return)&&P.call(y)}finally{if(C)throw C.error}}return 0===n.length&&(N=h(e.status,e.statusText,e.headers,r),n.push(N)),[2,n]}}))}))},t.parseResponseForRowVersion=g},OJ1H:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
class n{constructor(e,t,r,n){this.message=e,this.code=t,this.stack=r,this.name=n}}},OTPx:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DependencyType=t.EncodeRule=t.RollupType=t.TargetFieldType=t.OrderType=t.LogicalOperator=t.JoinOperator=t.DependencyDepth=t.ConditionOperator=void 0,function(e){e[e.Equal=0]="Equal",e[e.NotEqual=1]="NotEqual",e[e.GreaterThan=2]="GreaterThan",e[e.LessThan=3]="LessThan",e[e.GreaterEqual=4]="GreaterEqual",e[e.LessEqual=5]="LessEqual",e[e.Like=6]="Like",e[e.NotLike=7]="NotLike",e[e.In=8]="In",e[e.NotIn=9]="NotIn",e[e.Between=10]="Between",e[e.NotBetween=11]="NotBetween",e[e.Null=12]="Null",e[e.NotNull=13]="NotNull",e[e.Yesterday=14]="Yesterday",e[e.Today=15]="Today",e[e.Tomorrow=16]="Tomorrow",e[e.Last7Days=17]="Last7Days",e[e.Next7Days=18]="Next7Days",e[e.LastWeek=19]="LastWeek",e[e.ThisWeek=20]="ThisWeek",e[e.NextWeek=21]="NextWeek",e[e.LastMonth=22]="LastMonth",e[e.ThisMonth=23]="ThisMonth",e[e.NextMonth=24]="NextMonth",e[e.On=25]="On",e[e.OnOrBefore=26]="OnOrBefore",e[e.OnOrAfter=27]="OnOrAfter",e[e.LastYear=28]="LastYear",e[e.ThisYear=29]="ThisYear",e[e.NextYear=30]="NextYear",e[e.LastXHours=31]="LastXHours",e[e.NextXHours=32]="NextXHours",e[e.LastXDays=33]="LastXDays",e[e.NextXDays=34]="NextXDays",e[e.LastXWeeks=35]="LastXWeeks",e[e.NextXWeeks=36]="NextXWeeks",e[e.LastXMonths=37]="LastXMonths",e[e.NextXMonths=38]="NextXMonths",e[e.LastXYears=39]="LastXYears",e[e.NextXYears=40]="NextXYears",e[e.EqualUserId=41]="EqualUserId",e[e.NotEqualUserId=42]="NotEqualUserId",e[e.EqualBusinessId=43]="EqualBusinessId",e[e.NotEqualBusinessId=44]="NotEqualBusinessId",e[e.ChildOf=45]="ChildOf",e[e.Mask=46]="Mask",e[e.NotMask=47]="NotMask",e[e.MasksSelect=48]="MasksSelect",e[e.Contains=49]="Contains",e[e.DoesNotContain=50]="DoesNotContain",e[e.EqualUserLanguage=51]="EqualUserLanguage",e[e.NotOn=52]="NotOn",e[e.OlderThanXMonths=53]="OlderThanXMonths",e[e.BeginsWith=54]="BeginsWith",e[e.DoesNotBeginWith=55]="DoesNotBeginWith",e[e.EndsWith=56]="EndsWith",e[e.DoesNotEndWith=57]="DoesNotEndWith",e[e.ThisFiscalYear=58]="ThisFiscalYear",e[e.ThisFiscalPeriod=59]="ThisFiscalPeriod",e[e.NextFiscalYear=60]="NextFiscalYear",e[e.NextFiscalPeriod=61]="NextFiscalPeriod",e[e.LastFiscalYear=62]="LastFiscalYear",e[e.LastFiscalPeriod=63]="LastFiscalPeriod",e[e.LastXFiscalYears=64]="LastXFiscalYears",e[e.LastXFiscalPeriods=65]="LastXFiscalPeriods",e[e.NextXFiscalYears=66]="NextXFiscalYears",e[e.NextXFiscalPeriods=67]="NextXFiscalPeriods",e[e.InFiscalYear=68]="InFiscalYear",e[e.InFiscalPeriod=69]="InFiscalPeriod",e[e.InFiscalPeriodAndYear=70]="InFiscalPeriodAndYear",e[e.InOrBeforeFiscalPeriodAndYear=71]="InOrBeforeFiscalPeriodAndYear",e[e.InOrAfterFiscalPeriodAndYear=72]="InOrAfterFiscalPeriodAndYear",e[e.EqualUserTeams=73]="EqualUserTeams",e[e.EqualUserOrUserTeams=74]="EqualUserOrUserTeams",e[e.Under=75]="Under",e[e.NotUnder=76]="NotUnder",e[e.UnderOrEqual=77]="UnderOrEqual",e[e.Above=78]="Above",e[e.AboveOrEqual=79]="AboveOrEqual",e[e.EqualUserOrUserHierarchy=80]="EqualUserOrUserHierarchy",e[e.EqualUserOrUserHierarchyAndTeams=81]="EqualUserOrUserHierarchyAndTeams",e[e.OlderThanXYears=82]="OlderThanXYears",e[e.OlderThanXWeeks=83]="OlderThanXWeeks",e[e.OlderThanXDays=84]="OlderThanXDays",e[e.OlderThanXHours=85]="OlderThanXHours",e[e.OlderThanXMinutes=86]="OlderThanXMinutes"}(t.ConditionOperator||(t.ConditionOperator={})),function(e){e[e.Unknown=0]="Unknown",e[e.OnDemandWithContext=1]="OnDemandWithContext",e[e.OnDemandWithoutContext=2]="OnDemandWithoutContext",e[e.OnDemandContextOnly=3]="OnDemandContextOnly",e[e.Offline=4]="Offline",e[e.Mobile=5]="Mobile",e[e.UserContext=6]="UserContext"}(t.DependencyDepth||(t.DependencyDepth={})),function(e){e[e.Inner=0]="Inner",e[e.LeftOuter=1]="LeftOuter",e[e.Natural=2]="Natural",e[e.MatchFirstRowUsingCrossApply=3]="MatchFirstRowUsingCrossApply",e[e.In=4]="In",e[e.Exists=5]="Exists"}(t.JoinOperator||(t.JoinOperator={})),function(e){e[e.And=0]="And",e[e.Or=1]="Or",e[e.Not=2]="Not"}(t.LogicalOperator||(t.LogicalOperator={})),function(e){e[e.Ascending=0]="Ascending",e[e.Descending=1]="Descending"}(t.OrderType||(t.OrderType={})),function(e){e[e.All=0]="All",e[e.ValidForCreate=1]="ValidForCreate",e[e.ValidForUpdate=2]="ValidForUpdate",e[e.ValidForRead=3]="ValidForRead"}(t.TargetFieldType||(t.TargetFieldType={})),function(e){e[e.None=0]="None",e[e.Related=1]="Related",e[e.Extended=2]="Extended"}(t.RollupType||(t.RollupType={})),function(e){e[e.None=0]="None",e[e.SingleQuotesURL=1]="SingleQuotesURL",e[e.DoubleQuotesURL=2]="DoubleQuotesURL",e[e.NoQuotesURL=3]="NoQuotesURL",e[e.Contract=4]="Contract",e[e.JsonifyURL=5]="JsonifyURL"}(t.EncodeRule||(t.EncodeRule={})),function(e){e[e.NewData=1]="NewData",e[e.ExistingData=2]="ExistingData"}(t.DependencyType||(t.DependencyType={}))},Oqhm:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OfflineStatus=void 0,function(e){e[e.NotAvailable=0]="NotAvailable",e[e.Initializing=1]="Initializing",e[e.Available=2]="Available"}(t.OfflineStatus||(t.OfflineStatus={}))},PFOI:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RetrievalStrategy=void 0,function(e){e[e.Local=0]="Local",e[e.Remote=1]="Remote",e[e.LocalAndRemote=2]="LocalAndRemote",e[e.Default=3]="Default"}(t.RetrievalStrategy||(t.RetrievalStrategy={}))},PUb4:function(e,t,r){"use strict";r.d(t,"h",(function(){return a})),r.d(t,"g",(function(){return i})),r.d(t,"f",(function(){return o})),r.d(t,"c",(function(){return s})),r.d(t,"i",(function(){return u})),r.d(t,"b",(function(){return l})),r.d(t,"e",(function(){return d})),r.d(t,"d",(function(){return y})),r.d(t,"a",(function(){return c})),r.d(t,"k",(function(){return p})),r.d(t,"j",(function(){return f}));var n=r("lSoY");
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */const a={};var i,o;a.form=[{metadataType:n.MetadataType.formSelector,uniqueKey:"Id",payloadKey:"FormSelectors"},{metadataType:n.MetadataType.form,uniqueKey:"FormId",payloadKey:"Forms"}],a.savedview=[{metadataType:n.MetadataType.viewSelector,uniqueKey:"ViewId",payloadKey:"ViewSelectors"},{metadataType:n.MetadataType.savedView,uniqueKey:"ViewId",payloadKey:"Views"}],a.workspace=[{metadataType:n.MetadataType.dashboardSelector,uniqueKey:"Id",payloadKey:"DashboardSelectors"},{metadataType:n.MetadataType.form,uniqueKey:"FormId",payloadKey:"Forms"},{metadataType:n.MetadataType.workspace,uniqueKey:"FormId",payloadKey:"Dashboards"},{metadataType:n.MetadataType.interactionCentricWorkspace,uniqueKey:"FormId",payloadKey:"Dashboards"}],a.systemworkspace=[{metadataType:n.MetadataType.dashboardSelector,uniqueKey:"Id",payloadKey:"DashboardSelectors"},{metadataType:n.MetadataType.form,uniqueKey:"FormId",payloadKey:"Forms"},{metadataType:n.MetadataType.workspace,uniqueKey:"FormId",payloadKey:"Dashboards"},{metadataType:n.MetadataType.interactionCentricWorkspace,uniqueKey:"FormId",payloadKey:"Dashboards"}],a.userworkspace=[{metadataType:n.MetadataType.dashboardSelector,uniqueKey:"Id",payloadKey:"DashboardSelectors"},{metadataType:n.MetadataType.form,uniqueKey:"FormId",payloadKey:"Forms"},{metadataType:n.MetadataType.workspace,uniqueKey:"FormId",payloadKey:"Dashboards"},{metadataType:n.MetadataType.interactionCentricWorkspace,uniqueKey:"FormId",payloadKey:"Dashboards"}],a.savedvisualization=[{metadataType:n.MetadataType.visualizationSelector,uniqueKey:"Id",payloadKey:"VisualizationSelectors"},{metadataType:n.MetadataType.savedQueryVisualization,uniqueKey:"Id",payloadKey:"SavedQueryVisualizations"}],function(e){e[e.Unknown=0]="Unknown",e[e.OnDemandWithContext=1]="OnDemandWithContext",e[e.OnDemandWithoutContext=2]="OnDemandWithoutContext",e[e.OnDemandContextOnly=3]="OnDemandContextOnly",e[e.Offline=4]="Offline",e[e.Mobile=5]="Mobile",e[e.UserContext=6]="UserContext"}(i||(i={})),function(e){e[e.None=0]="None",e[e.Slate=1]="Slate",e[e.Phone=2]="Phone",e[e.Desktop=3]="Desktop",e[e.MailApp=4]="MailApp"}(o||(o={}));const s="applicationmetadataversionstamp";var u;!function(e){e.METADATA_TYPE="metadatatype",e.SOURCE_ID="sourceid",e.ASSOCIATED_ENTITY_LOGICAL_NAME="associatedentitylogicalname",e.METADATA_SUBTYPE="metadatasubtype",e.DISPLAY_NAME="displayname",e.JSON="json"}(u||(u={}));const l="applicationmetadata",c="metadatadependency",d="entitymetadata",p="usercontext",f="contextkey",y="entitydefinitionstype"},PaRk:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.areValuesEqual=void 0;var n=r("4oeN");t.areValuesEqual=function e(t,r){return!t&&!r||!(!t&&r||t&&!r)&&(t instanceof n.LegacyGuid&&r instanceof n.LegacyGuid||t.equals&&r.equals?t.equals(r):t.get_ValueString&&t.get_Label&&r.get_ValueString&&r.get_Label?t.get_ValueString()===r.get_ValueString()&&t.get_Label()===r.get_Label():t.get_value&&r.get_value?e(t.get_value(),r.get_value()):(t instanceof Date&&r instanceof Date&&(t=t.valueOf(),r=r.valueOf()),t===r))}},Qg9G:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.isServerAvailableInternal=void 0,t.isServerAvailableInternal=function(e){var t;return!!e.serverStatus&&(null===(t=e.serverStatus.isAvailable)||void 0===t||t)}},R1Ow:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.entityReference=t.addressUsed=t.partyObjectTypeCode=t.isPartyDeleted=t.ownerParty=t.partyId=t.participationTypeMask=t.activityId=t.activityPartyId=t.imageDescriptor=t.fileAttachment=t.activityParty=t.value=t.objectTypeCode=t.objectId=t.Name=t.logicalName=t.id=t.oDataContext=t.attributeTypeCombinedCases=t.entitySettings=t.initialDataDownloadStatus=t.initialDataDownloadETAInMinutes=t.lastDataSyncTime=t.aliasedValueFieldName=t.aliasedValueEntity=t.aliasedValueDescriptors=t.entityLogicalNameCombinedCases=t.entityLogicalNameLowerCase=t.entityLogicalName=t.attributeLogicalNameCombinedCases=t.fullNameComponents=t.fullName=t.middleName=t.lastName=t.firstName=t.ownerId=t.createdBy=t.createdOn=t.statusCode=t.stateCode=t.rowVersion=t.versionNumber=t.modifiedBy=t.modifiedOn=t.create=t.regardingEntityId=t.activityAttachment=t.systemUser=t.columnDelimiter=void 0,t.participationTypeMasktoType=t.participationType=t.partyAttributes=t.isRegularActivity=t.activityTypeCode=t.resolvedParties=t.values=t.columns=void 0,t.columnDelimiter="!",t.systemUser="systemuser",t.activityAttachment="activityattachment",t.regardingEntityId="syncerror__regardingentityid",t.create="create",t.modifiedOn="modifiedon",t.modifiedBy="modifiedby",t.versionNumber="versionnumber",t.rowVersion="RowVersion",t.stateCode="statecode",t.statusCode="statuscode",t.createdOn="createdon",t.createdBy="createdby",t.ownerId="ownerid",t.firstName="firstname",t.lastName="lastname",t.middleName="middlename",t.fullName="fullname",t.fullNameComponents=[t.firstName,t.middleName,t.lastName],t.attributeLogicalNameCombinedCases="attributeLogicalname",t.entityLogicalName="EntityLogicalName",t.entityLogicalNameLowerCase="entitylogicalname",t.entityLogicalNameCombinedCases="entityLogicalName",t.aliasedValueDescriptors="aliasedValueDescriptors",t.aliasedValueEntity="aliasedValueEtn",t.aliasedValueFieldName="aliasedValueFieldName",t.lastDataSyncTime="LastDataSyncTime",t.initialDataDownloadETAInMinutes="InitialDataDownloadETAInMinutes",t.initialDataDownloadStatus="InitialDataDownloadStatus",t.entitySettings="entitysettings",t.attributeTypeCombinedCases="attributeType",t.oDataContext="@odata.context",t.id="id",t.logicalName="logicalname",t.Name="name",t.objectId="objectid",t.objectTypeCode="objecttypecode",t.value="value",t.activityParty="activityparty",t.fileAttachment="fileattachment",t.imageDescriptor="imagedescriptor",t.activityPartyId="activitypartyid",t.activityId="activityid",t.participationTypeMask="participationtypemask",t.partyId="partyid",t.ownerParty="owner",t.isPartyDeleted="ispartydeleted",t.partyObjectTypeCode="partyobjecttypecode",t.addressUsed="addressused",t.entityReference="entityreference",t.columns="columns",t.values="values",t.resolvedParties="resolvedparties",t.activityTypeCode="activitytypecode",t.isRegularActivity="isregularactivity",t.partyAttributes=[t.participationTypeMask,t.activityId,t.activityPartyId,t.partyId,t.isPartyDeleted,t.partyObjectTypeCode,t.addressUsed],t.participationType={from:"1",to:"2",cc:"3",bcc:"4",requiredattendees:"5",optionalattendees:"6",organizer:"7",regarding:"8",owner:"9",resources:"10",customer:"11",partner:"12"},t.participationTypeMasktoType={1:"from",2:"to",3:"cc",4:"bcc",5:"requiredattendees",6:"optionalattendees",7:"organizer",8:"regarding",9:"owner",10:"resources",11:"customer",12:"partner"}},RVOy:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return a(t,e),t},o=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(a,i){function o(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((n=n.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var r,n,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(a=2&i[0]?n.return:i[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,i[1])).done)return a;switch(n=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,n=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],n=0}finally{r=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},u=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.addAttributes=t.requestAdditionalMetadataForRequest=t.executeOData=t.EXECUTE_ODATA_OPERATION=void 0;var l=r("fKp2"),c=r("Ln9p"),d=r("aAjD"),p=r("Rv4a"),f=i(r("fzfk")),y=r("k1iK"),m=r("D7ZV"),h=r("+MPC"),g=r("pCZI"),E=r("McwX");t.EXECUTE_ODATA_OPERATION="executeOData.execute";function b(e,t,r){e.hasOwnProperty(t)?e[t]&&(e[t]=r?Array.from(new Set(e[t].concat(r))):null):e[t]=r}function O(e,t){var r,n;if(g.isChangeSet(t))return t.reduce(O,{});if(g.isODataContract(t)){var a=null;if(!t||"function"!=typeof t.getMetadata||!(a=t.getMetadata()))return e;if("ExecuteMultiple"===a.operationName)return t.requests.reduce(O,{});if("Create"===a.operationName){var i=t,o=y.determineReturnedColumns(i.payload);b(e,i.etn,o)}else if("Update"===a.operationName){var s=t;o=y.determineReturnedColumns(s.payload);b(e,s.etn,o)}else if("Delete"===a.operationName){b(e,t.entityReference.entityType,[])}else{var l=function e(t){var r,n,a,i,o,s,l=null,c=null;if(!t||"function"!=typeof t.getMetadata||!(l=t.getMetadata())||!(c=l.parameterTypes))return[];var d=new Set;try{for(var p=u(Object.keys(t)),y=p.next();!y.done;y=p.next()){var h=y.value,g=t[h];if(null!=g)if(l.boundParameter===h)c[h].structuralProperty===f.ODataStructuralProperty.Collection?d.add(g):d.add(g.entityType);else if(c[h])switch(c[h].structuralProperty){case f.ODataStructuralProperty.Collection:if(g&&g.length)if(g[0].getMetadata){var E=g;try{for(var b=(a=void 0,u(E)),O=b.next();!O.done;O=b.next()){e(O.value).forEach((function(e){return d.add(e)}))}}catch(e){a={error:e}}finally{try{O&&!O.done&&(i=b.return)&&i.call(b)}finally{if(a)throw a.error}}}else if(-1===m.ODataPrimitives.indexOf(c[h].typeName)){var v=g;try{for(var _=(o=void 0,u(v)),T=_.next();!T.done;T=_.next()){var S=T.value;"object"==typeof S&&"entityType"in S&&"id"in S&&d.add(S.entityType)}}catch(e){o={error:e}}finally{try{T&&!T.done&&(s=_.return)&&s.call(_)}finally{if(o)throw o.error}}}break;case f.ODataStructuralProperty.EntityType:"object"==typeof g&&"entityType"in g&&"id"in g&&d.add(g.entityType);break;case f.ODataStructuralProperty.ComplexType:e(g).forEach((function(e){return d.add(e)}))}}}catch(e){r={error:e}}finally{try{y&&!y.done&&(n=p.return)&&n.call(p)}finally{if(r)throw r.error}}return Array.from(d)}(t);try{for(var c=u(l),d=c.next();!d.done;d=c.next()){b(e,d.value,[])}}catch(e){r={error:e}}finally{try{d&&!d.done&&(n=c.return)&&n.call(c)}finally{if(r)throw r.error}}}return e}throw new h.ErrorStatus("unsupported request")}t.executeOData=function(e,r){var n=[];return{type:t.EXECUTE_ODATA_OPERATION,execute:function(t){var a=t.dispatch;return o(this,void 0,void 0,(function(){var t;return s(this,(function(i){return t=new d.UCIContext(c.Guid.newGuid().guid),n.push({name:l.EVENT_PARAMETERS.CLIENT_REQUEST_ID,value:t.RequestId()}),r&&r.push({name:l.EVENT_PARAMETERS.CLIENT_REQUEST_ID,value:t.RequestId()}),[2,a(p.execute(e,n))]}))}))},getFailureParameters:function(){return n}}},t.requestAdditionalMetadataForRequest=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return{type:"executeOData.requestAdditionalMetadata.async",execute:function(t,r){var n=t.dispatch;t.getState;return o(this,void 0,void 0,(function(){var t;return s(this,(function(r){switch(r.label){case 0:return e?(t=e.reduce(O,{}),[4,n(E.retrieveEntities(t))]):[2];case 1:return r.sent(),[2]}}))}))}}},t.addAttributes=b},RXZ1:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.MetadataQuery=void 0;var o=i(r("fzfk")),s=function(){function e(){}return e.prototype.getMetadata=function(){return{boundParameter:null,operationName:null,operationType:null,parameterTypes:{MetadataType:{typeName:"Edm.String",structuralProperty:o.ODataStructuralProperty.PrimitiveType},MetadataSubtype:{typeName:"Edm.String",structuralProperty:o.ODataStructuralProperty.PrimitiveType},EntityLogicalName:{typeName:"Edm.String",structuralProperty:o.ODataStructuralProperty.PrimitiveType},MetadataId:{typeName:"Edm.Guid",structuralProperty:o.ODataStructuralProperty.PrimitiveType},MetadataName:{typeName:"Edm.String",structuralProperty:o.ODataStructuralProperty.PrimitiveType},MetadataNames:{typeName:"Edm.String",structuralProperty:o.ODataStructuralProperty.Collection},GetDefault:{typeName:"Edm.Boolean",structuralProperty:o.ODataStructuralProperty.PrimitiveType},DependencyDepth:{typeName:"Microsoft.Dynamics.CRM.DependencyDepth",structuralProperty:o.ODataStructuralProperty.EnumerationType,enumProperties:[,{name:"Unknown",value:0},{name:"OnDemandWithContext",value:1},{name:"OnDemandWithoutContext",value:2},{name:"OnDemandContextOnly",value:3},{name:"Offline",value:4},{name:"Mobile",value:5},{name:"UserContext",value:6}]},ChangedAfter:{typeName:"Edm.String",structuralProperty:o.ODataStructuralProperty.PrimitiveType},Exclude:{typeName:"Edm.Guid",structuralProperty:o.ODataStructuralProperty.Collection},AppId:{typeName:"Edm.Guid",structuralProperty:o.ODataStructuralProperty.PrimitiveType}}}},e}();t.MetadataQuery=s},Rv4a:function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(a,i){function o(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((n=n.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var r,n,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(a=2&i[0]?n.return:i[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,i[1])).done)return a;switch(n=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,n=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],n=0}finally{r=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},o=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.parseJsonResponse=t._sendRequest=t.retrieveMultipleRecords=t.retrieve=t.retrieveMultiple=t.execute=t.initializeExpressionRuntime=t.MDS_EVENT_PARAMETERS=void 0;
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var s=r("hER9"),u=r("fKp2"),l=r("tUL6"),c=r("Msg1"),d=r("RVOy"),p=r("McwX"),f=r("Wc7r"),y=r("G5wq"),m=r("53uT"),h=r("ODI4"),g=r("cv57"),E=r("xtAd"),b=r("k1iK"),O=r("z87Q"),v=r("+MPC"),_=r("9byC"),T=r("ykA9"),S=r("aTRZ"),N=r("dozL"),C=r("D7ZV"),P=r("pCZI"),R=r("PFOI"),w=r("ZFvc"),M=r("+hYO"),I=r("Qg9G"),A=r("mA3E"),D=r("tnR8"),L=r("p0t1"),U=r("Gcp0"),F=r("1SUZ"),x=r("AlX3"),k=r("7l03"),j=r("xnbY"),q=r("0ksK"),B=r("+95i");function $(e,t,r){return a(this,void 0,void 0,(function(){var n,a;return i(this,(function(i){switch(i.label){case 0:return n={TraceManager:r.TraceManager,EventManager:r.EventManager,SqlExecutor:{},ApplicationState:{}},a=Y(e),null==t||t.info(J()+" Execute the request in Modern Data Layer Component"),[4,new c.ODataExecutor({},n).execute(a)];case 1:return[2,i.sent()]}}))}))}function V(e,t,r,o,l,c,d,p){var m,h;return void 0===o&&(o=R.RetrievalStrategy.Default),void 0===c&&(c=!1),void 0===d&&(d=[]),void 0===p&&(p=!1),a(this,void 0,void 0,(function(){var a,g,E,b,O,_,T;return i(this,(function(i){switch(i.label){case 0:return a=performance.now(),g=null===(h=(m=l.EventManager).getScenarioTracker)||void 0===h?void 0:h.call(m,u.ScenarioType.Load,"Storage:ModernDataLayer"),function(e,t,r,a,i){var o;void 0===r&&(r=R.RetrievalStrategy.Default);void 0===a&&(a=!1);try{t.additionalHeaders||(t.additionalHeaders={});var u=void 0;if(e&&e.serverStatus)switch(r){case R.RetrievalStrategy.Local:if(!a&&!G(e,t)){var l=H(e);throw w.LegacyErrorStatus.fromErrorCodeAndMessage(M.CrmErrorCodes.DataSourceOfflineErrorCode,"Can't execute 'Offline' request as "+l)}u=f.EXECUTION_HINTS.OFFLINE;break;case R.RetrievalStrategy.Remote:if(!a&&!I.isServerAvailableInternal(e))throw w.LegacyErrorStatus.FromMessage("Can't execute 'Online' request as server is NOT available");u=f.EXECUTION_HINTS.ONLINE;break;case R.RetrievalStrategy.Default:if(t.additionalHeaders[f.HEADER.EXECUTION_HINT])return;if(A.isOfflineByDefaultEnabledForApp(e)&&I.isServerAvailableInternal(e)&&G(e,t)){t.additionalHeaders.clientType=s.CLIENT_TYPE.local;var c=((o={})[D.IS_OFFLINE_BY_DEFAULT_REQUEST]=!0,o);t.additionalParameters=t.additionalParameters?n(n({},t.additionalParameters),c):c,u=f.EXECUTION_HINTS.OFFLINE}else if(I.isServerAvailableInternal(e))u=f.EXECUTION_HINTS.ONLINE;else{if(!G(e,t)){var d=H(e);throw w.LegacyErrorStatus.fromErrorCodeAndMessage(M.CrmErrorCodes.DataSourceOfflineErrorCode,"Can't execute 'Default' request as the server is NOT available and "+d)}u=f.EXECUTION_HINTS.OFFLINE}break;default:throw w.LegacyErrorStatus.FromMessage("Currently MDL does not support the strategy: "+r)}else u=r===R.RetrievalStrategy.Local?f.EXECUTION_HINTS.OFFLINE:f.EXECUTION_HINTS.ONLINE;t.additionalHeaders[f.HEADER.EXECUTION_HINT]=u}catch(r){var p=[];W(t,p);var y=v.ErrorStatus.toLegacyErrorStatus(v.convertToErrorStatus(r));throw L._reportMDSFailure(i,p,y,e,N.MDL_COMPONENT_NAMES.ModernDataSource),r}}(t(),e,o,c,l),F.isFeatureEnabledByFCBName(t(),x.ModernDataLayerDev)&&e.expressionRuntimeSupportedRequest?(W(e,E=[]),(O=undefined)?[4,undefined(e)]:[3,2]):[3,3];case 1:O=i.sent(),i.label=2;case 2:if(b=O)return[2,X(t,b,e,o,a,l,r,!0,g,E)];r.warn(J()+" No Data Component handled this request - Response is Null",E),i.label=3;case 3:return _=e,(p=p||function(e){return"GET"===e.method&&C.encodeURIComponentForOData(e.urlParameters).length>16300}(e)||function(e,t){return F.isFeatureEnabledByFCBName(e(),x.BatchRequestForLongFetchXml)&&"GET"===t.method&&"remote"===k.getClientType(Y(t))&&t.additionalParameters&&t.additionalParameters[q.OPERATION.TYPE]===q.OPERATION_TYPE.RETRIEVE_MULTIPLE&&j.getClientHost(e())===B.ClientHost.MobileApplication&&C.encodeURIComponentForOData(t.urlParameters).length>1500}(t,e))&&(d.push({name:"isConvertToBatchRequestNeeded",value:p}),_=y.convertToBatchRequest(l,e)),W(e,d),[4,$(_,r,l)];case 4:return T=i.sent(),p?[4,Q(T,r,d)]:[3,6];case 5:T=i.sent(),i.label=6;case 6:return[2,X(t,T,e,o,a,l,r,!1,g,d)]}}))}))}function H(e){return U.getIsOfflineEnabled(e)?U.isOfflineAvailableForUse(e)?"related entity is not enabled for offline":"offline is not yet available":"the app is not offline enabled"}function G(e,t){return U.getIsOfflineEnabled(e)&&U.isOfflineAvailableForUse(e)&&y.isSerializedRequestSupportedOffline(e,t)}t.MDS_EVENT_PARAMETERS={CRM_ERROR_CODE:"Crm-Error-Code",CRM_ERROR_MESSAGE:"Crm-Error-Message",CRM_CALL_STACK:"Crm-Call-Stack",IS_BATCH_REQUEST:"IsBatchRequest",IS_EXPRESSION_RUNTIME_REQUEST:"IS_EXPRESSION_RUNTIME_REQUEST",IS_ERROR_IN_OFFLINE:"ErrorInOffline",ODATA_ERROR_RESPONSE_IS_HTML_TYPE:"Odata-Error-Response-Is-Html-Type"},t.initializeExpressionRuntime=function(e,t,r){return a(this,void 0,void 0,(function(){return i(this,(function(e){return[2,null]}))}))},t.execute=function(e,t,r){return{type:"modernDataSource.execute.odata.async",execute:function(t,r){var n=t.getState,o=t.dispatch;return a(this,void 0,void 0,(function(){var t;return i(this,(function(a){switch(a.label){case 0:return(t=r.TraceManager.getTracer(N.MDL_COMPONENT_NAMES.ModernDataSource)).info(J()+" Execute legacy request."),[4,o(d.requestAdditionalMetadataForRequest(e))];case 1:return a.sent(),[4,o(y.fromODataContract(e))];case 2:return[2,V(a.sent(),n,t,R.RetrievalStrategy.Default,r)]}}))}))}}},t.retrieveMultiple=function(e){return{type:"moderndatasource.retrievemultiple.async",execute:function(t,r){var n=t.getState,o=t.dispatch;return a(this,void 0,void 0,(function(){var t,a,s,u,l;return i(this,(function(i){switch(i.label){case 0:return(t=r.TraceManager.getTracer(N.MDL_COMPONENT_NAMES.ModernDataSource)).info(J()+" Retrieve multiple is executing"),a=_.getAttributesMapFromFetch(null==e?void 0:e.fetchXml),[4,o(p.retrieveEntities(a))];case 1:return i.sent(),[4,o(y.fromQueryState(e))];case 2:return s=i.sent(),u=g.parseFetchXmlForAliasedValues(null==e?void 0:e.fetchXml),[4,V(s,n,t,R.RetrievalStrategy.Default,r)];case 3:return[4,K(i.sent(),t)];case 4:return l=i.sent(),[2,g.deserializeEntityCollection(n(),e,u,l)]}}))}))}}},t.retrieve=function(e,t){return{type:"moderndatasource.retrieve.async",execute:function(r,n){var o=r.getState,s=r.dispatch;return a(this,void 0,void 0,(function(){var r,a;return i(this,(function(i){switch(i.label){case 0:return(r=n.TraceManager.getTracer(N.MDL_COMPONENT_NAMES.ModernDataSource)).info(J()+" Retrieve is executing"),[4,s(p.retrieveEntity(e.etn,!0))];case 1:return i.sent(),[4,s(y.fromODataContract(E.buildRetrieveContract(o(),e,t)))];case 2:return[4,V(i.sent(),o,r,R.RetrievalStrategy.Default,n)];case 3:return[4,K(i.sent(),r)];case 4:return a=i.sent(),[4,s(b.createEntityRecordFromResponseAsync(a,e.etn,t,void 0,void 0,void 0,r))];case 5:return[2,i.sent()]}}))}))}}},t.retrieveMultipleRecords=function(e,t){return{type:"moderndatasource.retrieve.records.async",execute:function(r,n){var s=r.getState,u=r.dispatch;return a(this,void 0,void 0,(function(){var r,a,l,c,d,f,y,m,h,g,O,_,T;return i(this,(function(i){switch(i.label){case 0:if((r=n.TraceManager.getTracer(N.MDL_COMPONENT_NAMES.ModernDataSource)).info(J()+" Retrieve records is executing"),!e||0===e.length)throw new v.ErrorStatus("Invalid identifiers");return[4,u(p.retrieveEntity(e[0].etn,!0))];case 1:i.sent(),a=[];try{for(l=o(e),c=l.next();!c.done;c=l.next())d=c.value,f=E.buildRetrieveContract(s(),d,t),a.push(f)}catch(e){_={error:e}}finally{try{c&&!c.done&&(T=l.return)&&T.call(l)}finally{if(_)throw _.error}}return[4,u(P.executeMultiple(a))];case 2:y=i.sent(),m=[],h=0,i.label=3;case 3:return h<y.length?[4,K(y[h],r)]:[3,7];case 4:return g=i.sent(),[4,u(b.createEntityRecordFromResponseAsync(g,e[h].etn,t,void 0,void 0,void 0,r))];case 5:O=i.sent(),m.push(O),i.label=6;case 6:return h++,[3,3];case 7:return[2,m]}}))}))}}},t._sendRequest=V;function Q(e,t,r){return a(this,void 0,void 0,(function(){var n;return i(this,(function(a){switch(a.label){case 0:return[4,h.parseBatchResponse(e)];case 1:return(n=a.sent())&&n.length>0?[2,n[0]]:(t.warn(J()+" Invalid response list returned from parseBatchResponse",r),[2,e])}}))}))}function X(e,r,n,o,l,c,d,p,m,g){return void 0===o&&(o=R.RetrievalStrategy.Default),void 0===g&&(g=[]),a(this,void 0,void 0,(function(){var a,o,E,b,v;return i(this,(function(i){switch(i.label){case 0:return a=performance.now()-l,g.push({name:u.EVENT_PARAMETERS.RESPONSE_TIME,value:a}),function(e,r,n,a){void 0===a&&(a=!1);var i=e.headers?T.getHttpHeader(e.headers,f.HEADER.SERVER_REQUEST_ID):s.UNKNOWN,o=e.status?e.status:null,l=e.type?e.type:null,c=e.statusText?e.statusText:s.UNKNOWN,d=e.url?O.trimUrl(e.url):s.UNKNOWN,p=e.headers?T.getHttpHeader(e.headers,f.HEADER.CONTENT_LENGTH):s.UNKNOWN;O.canLogDetailsOfRequest(e.url)&&r.push({name:u.EVENT_PARAMETERS.RESPONSE_URL,value:d});r.push({name:u.EVENT_PARAMETERS.HTTP_STATUS_CODE,value:o}),r.push({name:u.EVENT_PARAMETERS.HTTP_RESPONSE_TYPE,value:l}),r.push({name:u.EVENT_PARAMETERS.HTTP_RESPONSE_STATUS_TEXT,value:c}),r.push({name:u.EVENT_PARAMETERS.SERVER_REQUEST_ID,value:i||s.UNKNOWN}),r.push({name:u.EVENT_PARAMETERS.RESPONSE_SIZE_IN_BYTES,value:p||s.UNKNOWN}),r.push({name:t.MDS_EVENT_PARAMETERS.IS_BATCH_REQUEST,value:a}),r.push({name:t.MDS_EVENT_PARAMETERS.IS_EXPRESSION_RUNTIME_REQUEST,value:n})}(r,g,p,"$batch"===n.urlParameters),r.ok?(null==m||m.complete(g),c.EventManager.ReportComponentSuccess("Storage:ModernDataLayer",g),[2,r]):[3,1];case 1:if(401!==r.status)return[3,7];null==d||d.error(J()+" Modern Data Layer : 401 response from server.",g),o=c.DataLayerConfiguration.RemoteRetryHandler,i.label=2;case 2:return i.trys.push([2,5,,6]),o?[4,o.handleAuthError(n)]:[2,z(r,c,g,d,m)];case 3:return i.sent(),null==d||d.error(J()+" Modern Data Layer : 401 response from server, handleAuthError() was successful, retrying the request.",g),[4,y.addAuthHeader(e,n)];case 4:return i.sent(),[2,$(n,e,c)];case 5:throw E=i.sent(),d&&d.error(J()+" Error in 401 error handling",g),E;case 6:return[3,10];case 7:return r.url&&-1!==r.url.indexOf("$batch")||n&&n.urlParameters&&-1!==n.urlParameters.indexOf("$batch")?[4,h.parseBatchResponse(r)]:[3,9];case 8:return(b=i.sent()).length>0&&(v=b.find((function(e){return!e.ok})))?[2,z(v,c,g,d,m)]:(d&&d.error("Batch response parsing has failed",g),[2,z(r,c,g,d,m)]);case 9:return null==d||d.error(J()+" Modern Data Layer component returns Error Response - Convert error to CRM Error.",g),[2,z(r,c,g,d,m)];case 10:return[2]}}))}))}function W(e,t){t.push({name:u.EVENT_PARAMETERS.CLIENT_REQUEST_ID,value:Z(e)}),t.push({name:u.EVENT_PARAMETERS.CLIENT_TYPE,value:"remote"});var r=l.getRequestType(Y(e));t.push({name:u.EVENT_PARAMETERS.OPERATION_TYPE,value:r})}function z(e,r,n,o,u){return a(this,void 0,void 0,(function(){var a,l,c,d,p,f;return i(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,e.text()];case 1:return l=i.sent(),a=m.deserializeErrorResponse(l,e,n,o),O.canLogDetailsOfRequest(e.url)&&(n.push({name:"Odata-Error-Response-Complete-text",value:l}),n.push({name:"Crm-Error-Response-From-OdataResponse",value:JSON.stringify(a)})),c=a.message||"Request Failure",n.push({name:t.MDS_EVENT_PARAMETERS.CRM_ERROR_CODE,value:a.errorCode}),a.stack&&n.push({name:t.MDS_EVENT_PARAMETERS.CRM_CALL_STACK,value:a.stack}),n.push({name:t.MDS_EVENT_PARAMETERS.CRM_ERROR_MESSAGE,value:c}),d=e?e.status:null,[400,404,500,503].indexOf(d)>-1&&!S.isNonReportableErrorCode(a.errorCode)?(p=new v.ErrorStatus(c,a.errorCode,void 0,null,null,null,null,n,null,null,null,!1,-1,null,d,a.clientRequestId,a.serverResponseId),null==u||u.failure(n),r.EventManager.ReportComponentFailure("Storage:ModernDataLayer",p,void 0,n)):null==o||o.error(c,n),[3,3];case 2:throw i.sent(),null==o||o.error(J()+" Modern Data Layer component : Exception occurred while creating error response.",n),f=S.ErrorCodes.unknownInternalServerError,new v.ErrorStatus(s.UNKNOWN,f);case 3:throw a}}))}))}function Y(e){return{url:e.urlParameters,method:e.method,additionalHeaders:e.additionalHeaders,body:e.body}}function K(e,t,r){return a(this,void 0,void 0,(function(){var n;return i(this,(function(a){if(null==r||r.AppendCallStack("WebAPIService.parseJsonResponse"),e)return(n=T.getHttpHeader(e.headers,f.HEADER.CONTENT_TYPE))&&n.indexOf("text/html")>-1?(null==r||r.AppendCallStack("WebAPIService.response.text"),[2,e.text().then((function(r){throw m.deserializeErrorResponse(r,e,[],t)}))]):(null==r||r.AppendCallStack("WebAPIService.response.json"),[2,e.json()]);throw new v.ErrorStatus("Null response from server")}))}))}function J(e){return"["+(e||N.PREFIX.ModernDataSource)+"]"}function Z(e){var t;return(null===(t=null==e?void 0:e.additionalHeaders)||void 0===t?void 0:t[f.HEADER.CLIENT_REQUEST_ID])||s.UNKNOWN}t.parseJsonResponse=K},SKhN:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XPathResultType=void 0,function(e){e[e.ANY_TYPE=0]="ANY_TYPE",e[e.NUMBER_TYPE=1]="NUMBER_TYPE",e[e.STRING_TYPE=2]="STRING_TYPE",e[e.BOOLEAN_TYPE=3]="BOOLEAN_TYPE",e[e.UNORDERED_NODE_ITERATOR_TYPE=4]="UNORDERED_NODE_ITERATOR_TYPE",e[e.ORDERED_NODE_ITERATOR_TYPE=5]="ORDERED_NODE_ITERATOR_TYPE",e[e.UNORDERED_NODE_SNAPSHOT_TYPE=6]="UNORDERED_NODE_SNAPSHOT_TYPE",e[e.ORDERED_NODE_SNAPSHOT_TYPE=7]="ORDERED_NODE_SNAPSHOT_TYPE",e[e.ANY_UNORDERED_NODE_TYPE=8]="ANY_UNORDERED_NODE_TYPE",e[e.FIRST_ORDERED_NODE_TYPE=9]="FIRST_ORDERED_NODE_TYPE"}(t.XPathResultType||(t.XPathResultType={}))},SWMH:function(e,t,r){"use strict";var n,a=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),i=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,a,i=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)o.push(n.value)}catch(e){a={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(a)throw a.error}}return o},o=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(i(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0}),t.DOMParserNodeWrapper=void 0;var s=r("az3V"),u=r("kgGf"),l=r("EyO3"),c=r("nf9M"),d=function(e){function t(t,r){var n=e.call(this)||this;return u.assert(!c.IsNullOrUndefined(t),"The element should not be null"),n._element=t,n._namespaces=c.IsNullOrUndefined(r)?{}:r,n}return a(t,e),t.prototype.get_innerText=function(){return this._element.hasChildNodes()?this._element.firstChild.nodeValue:null},t.prototype.get_outerXml=function(){return(new XMLSerializer).serializeToString(this._element)},t.prototype.get_tagName=function(){return this._element.nodeName},t.prototype.get_domParserElement=function(){return this._element},t.prototype.getAttribute=function(e){return this._element.getAttribute(e)},t.prototype.addNamespace=function(e,t){this._namespaces[e]=t},t.prototype.selectSingleNode=function(e){var t=this._SelectDOMParserElements(e,!0);if(t.get_count())return t.get_item(0)},t.prototype.selectNodes=function(e){return this._SelectDOMParserElements(e,!1)},t.prototype.getElementsByTagName=function(e){var r,n=this;r=c.IsNullOrUndefined(this._element.ownerDocument)?this._element.getElementsByTagName(e):this._element.ownerDocument.getElementsByTagName(e);for(var a=[],i=0;i<r.length;i++)a.push(r[i]);var s=this._GetElementsByTagNameWithDefaultNamespace(e);a.push.apply(a,o(s));var u=a.map((function(e){return new t(e,n._namespaces)}));return new l.DOMParserNodeListWrapper(u)},t.prototype.childNodes=function(){for(var e=[],r=0,n=this._element.childNodes.length;r<n;r++)e.push(new t(this._element.childNodes[r],this._namespaces));return new l.DOMParserNodeListWrapper(e)},t.prototype.hasChildNodes=function(){return this._element.hasChildNodes()},t.prototype._SelectDOMParserElements=function(e,r){var n=this,a=[];if(e.startsWith("// ")||e.startsWith(".// ")){var i=2,s=!1;e.startsWith(".")&&(i++,s=!0);var u=(e=e.substr(i)).indexOf("/"),d=void 0,p=void 0;u<0?(d=e,p=null):(d=e.substr(0,u),p=e.substr(u+1));var f=void 0,y=void 0;(u=d.indexOf("["))<0?(f=d,y=null):(f=d.substr(0,u),u=(y=d.substr(u+1)).indexOf("]"),y=y.substr(0,u));var m=void 0;m=s||c.IsNullOrUndefined(this._element.ownerDocument)?this._element.getElementsByTagName(f):this._element.ownerDocument.getElementsByTagName(f);for(var h=[],g=0;g<m.length;g++)h.push(m[g]);var E=this._GetElementsByTagNameWithDefaultNamespace(f);h.push.apply(h,o(E));var b=h;h.length>0&&null!==y&&(b=this._FilterDOMParserElementList(h,y)),a=b.length&&null!==p?this._SearchDOMParserElementList(b,p,r):b}else e.startsWith("/")?(c.IsNullOrUndefined(this._element.ownerDocument)?a.push(this._element):a.push(this._element.ownerDocument),a=this._SearchDOMParserElementList(a,e.substr(1),r)):(a.push(this._element),a=this._SearchDOMParserElementList(a,e,r));var O=a.map((function(e){return new t(e,n._namespaces)}));return new l.DOMParserNodeListWrapper(O)},t.prototype._SearchDOMParserElementList=function(e,t,r){return r?this._SearchSingleNodeDOMParserElementList(e,t):this._SearchNodesDOMParserElementList(e,t)},t.prototype._SearchSingleNodeDOMParserElementList=function(e,t){if(c.IsNullOrUndefined(t)||t.length<1)return e;for(var r=[],n=0;n<e.length;n++){var a=this._SearchSingleNodeDOMParserElement(e[n],t);if(a){r.push(a);break}}return r},t.prototype._SearchSingleNodeDOMParserElement=function(e,t){if(c.IsNullOrUndefined(t)||t.length<1)return e;var r,n,a,i,o=t.indexOf("/");o<0?(r=t,n=null):(r=t.substr(0,o),n=t.substr(o+1)),(o=r.indexOf("["))<0?(a=r,i=null):(a=r.substr(0,o),o=(i=r.substr(o+1)).indexOf("]"),i=i.substr(0,o));for(var s=null,u=0,l=e.childNodes.length;u<l;u++)if(this._IsNodeNameEqual(e.childNodes[u],a)){var d=[e.childNodes[u]],p=d;if(null!==i&&(p=this._FilterDOMParserElementList(d,i)),p.length>0){if(null===n){s=p[0];break}if(s=this._SearchSingleNodeDOMParserElement(p[0],n))break}}return s},t.prototype._SearchNodesDOMParserElementList=function(e,t){if(c.IsNullOrUndefined(t)||t.length<1)return e;var r,n,a=t.indexOf("/");a<0?(r=t,n=null):(r=t.substr(0,a),n=t.substr(a+1));for(var i,s=[],u=0;u<e.length;u++)(i=this._SearchDOMParserElement(e[u],r)).length>0&&s.push.apply(s,o(i));return s.length&&null!==n?this._SearchNodesDOMParserElementList(s,n):s},t.prototype._SearchDOMParserElement=function(e,t){var r,n,a=t.indexOf("[");a<0?(r=t,n=null):(r=t.substr(0,a),a=(n=t.substr(a+1)).indexOf("]"),n=n.substr(0,a));for(var i=[],o=0,s=e.childNodes.length;o<s;o++)this._IsNodeNameEqual(e.childNodes[o],r)&&i.push(e.childNodes[o]);var u=i;return i.length>0&&null!==n&&(u=this._FilterDOMParserElementList(i,n)),u},t.prototype._FilterDOMParserElementList=function(e,t){var r=t.startsWith("@");r&&(t=t.substr(1));var n,a,i=t.indexOf("=");i<0?(n=t,a=null):(n=t.substr(0,i),a=(a=(a=t.substr(i+1)).substr(1)).substr(0,a.length-1));for(var o=[],s=0;s<e.length;s++){var u=e[s];(r&&this._FilterDOMParserElementAttribute(u,n,a)||this._FilterDOMParserElementChildElement(u,n,a))&&o.push(u)}return o},t.prototype._FilterDOMParserElementAttribute=function(e,t,r){return null===r?e.hasAttribute(t):r===e.getAttribute(t)},t.prototype._FilterDOMParserElementChildElement=function(e,t,r){for(var n,a,i,o=0,s=null===(n=null==e?void 0:e.childNodes)||void 0===n?void 0:n.length;o<s;o++)if(this._IsNodeNameEqual(e.childNodes[o],t)){if(null===r)return!0;if((null===(i=null===(a=e.childNodes[o])||void 0===a?void 0:a.firstChild)||void 0===i?void 0:i.nodeValue)===r)return!0}return!1},t.prototype._GetElementsByTagNameWithDefaultNamespace=function(e){var t=[],r=this._GetNamespaceForFullName(e);if(c.IsNullOrUndefined(r)||r.length<1)return t;var n,a=this._GetLocalNameForFullName(e);n=c.IsNullOrUndefined(this._element.ownerDocument)?this._element.getElementsByTagName(a):this._element.ownerDocument.getElementsByTagName(a);for(var i=0;i<n.length;i++)n[i].namespaceURI===r&&t.push(n[i]);return t},t.prototype._GetNamespaceForFullName=function(e){var t=e.indexOf(":");if(t<0)return"";var r=e.substr(0,t);return this._namespaces[r]},t.prototype._GetLocalNameForFullName=function(e){var t=e.indexOf(":");return t<0?e:e.substr(t+1)},t.prototype._IsNodeNameEqual=function(e,t){if(e.nodeName===t||"*"===t)return!0;var r=this._GetNamespaceForFullName(t);if(c.IsNullOrUndefined(r)||r.length<1)return!1;var n=this._GetLocalNameForFullName(t);return e.namespaceURI===r&&e.localName===n},t}(s.XmlNode);t.DOMParserNodeWrapper=d},Szbx:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
var n;r.d(t,"a",(function(){return n})),function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized",e[e.Refreshing=3]="Refreshing",e[e.Error=4]="Error",e[e.Partial=5]="Partial"}(n||(n={}))},"T+vN":function(e,t,r){"use strict";var n,a=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.XPathEvaluatorWrapper=void 0;var i=r("az3V"),o=r("kgGf"),s=r("SKhN"),u=r("e3CE"),l=r("nf9M"),c=function(e){function t(t,r,n){var a=e.call(this)||this;return a._namespaces=null,a._evaluator=null,a._element=null,o.assert(!l.IsNullOrUndefined(t),"The XPathEvaluator should not be null"),a._evaluator=t,a._element=l.IsNullOrUndefined(r)?t:r,a._namespaces=l.IsNullOrUndefined(n)?{}:n,a}return a(t,e),t.prototype.get_innerText=function(){var e,t,r;return(null===(e=this._element)||void 0===e?void 0:e.hasChildNodes())?null===(r=null===(t=this._element)||void 0===t?void 0:t.firstChild)||void 0===r?void 0:r.nodeValue:null},t.prototype.get_outerXml=function(){return(new XMLSerializer).serializeToString(this._element)},t.prototype.get_tagName=function(){var e;return null===(e=this._element)||void 0===e?void 0:e.tagName},t.prototype.get_domParserElement=function(){return this._element},t.prototype.addNamespace=function(e,t){this._namespaces&&(this._namespaces[e]=t)},t.prototype.selectSingleNode=function(e){var r,n=null===(r=this._evaluator)||void 0===r?void 0:r.evaluate(e,this._element,null,s.XPathResultType.FIRST_ORDERED_NODE_TYPE,null);return l.IsNullOrUndefined(null==n?void 0:n.singleNodeValue)?null:new t(this._evaluator,null==n?void 0:n.singleNodeValue,this._namespaces)},t.prototype.selectNodes=function(e){var t;return new u.NodeSnapshotWrapper(this._evaluator,null===(t=this._evaluator)||void 0===t?void 0:t.evaluate(e,this._element,null,s.XPathResultType.ORDERED_NODE_SNAPSHOT_TYPE,null),this._namespaces)},t.prototype.getAttribute=function(e){var t;return null===(t=this._element)||void 0===t?void 0:t.getAttribute(e)},t.prototype.getElementsByTagName=function(e){var t;return new u.NodeSnapshotWrapper(this._evaluator,null===(t=this._element)||void 0===t?void 0:t.getElementsByTagName(e),this._namespaces)},t.prototype.childNodes=function(){var e;return new u.NodeSnapshotWrapper(this._evaluator,null===(e=this._element)||void 0===e?void 0:e.childNodes,this._namespaces)},t.prototype.hasChildNodes=function(){var e;return null===(e=this._element)||void 0===e?void 0:e.hasChildNodes()},t}(i.XmlNode);t.XPathEvaluatorWrapper=c},Tpz3:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.SupportedLookupProperties=void 0;var n=r("yNq8");t.SupportedLookupProperties=[n.AttributeType.Owner,n.AttributeType.Customer,n.AttributeType.Lookup]},TsR9:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return a(t,e),t},o=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(a,i){function o(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((n=n.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var r,n,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(a=2&i[0]?n.return:i[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,i[1])).done)return a;switch(n=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,n=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],n=0}finally{r=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},u=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,a,i=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)o.push(n.value)}catch(e){a={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(a)throw a.error}}return o},c=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(l(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0}),t.OfflineLogHelper=void 0;var d=r("DiyU"),p=r("ZYnM"),f=r("PFOI"),y=r("f7K7"),m=r("4oeN"),h=r("nf9M"),g=r("G5wq"),E=i(r("8w73")),b=i(r("rljN")),O=r("+MPC"),v=r("aAjD"),_=r("Ln9p"),T=r("dozL"),S=function(){function e(e){this._applicationContext=e,this._tracer=e.TraceManager.getTracer(E.upsyncComponentName)}return e.prototype.getNorSyncMainLogsOnSID=function(e){var t,r;return o(this,void 0,void 0,(function(){var n,a,i,o;return s(this,(function(s){switch(s.label){case 0:return n=new d.Expression("gt",{attributeName:E.sqLiteResultsSidColumnName,value:e}),a=p.ModernQueryBuilder.fromState({}).selectAll().where(n).from(E.norSyncMainLogTableName),(i={}).OperationSource="Upsync",[4,null===(r=null===(t=this._applicationContext.DataLayerConfiguration.DataProvider)||void 0===t?void 0:t.retrieveMultiple)||void 0===r?void 0:r.call(t,a.getQueryState(!0),f.RetrievalStrategy.Local,i)];case 1:return o=s.sent(),[2,b.convertEntityRecordsToNorSyncMainLog(o)]}}))}))},e.prototype.getNorSyncEntityLogs=function(e,t){var r,n;return o(this,void 0,void 0,(function(){var a,i,o;return s(this,(function(s){switch(s.label){case 0:return a=b.getOfflineLogTableNameForEntity(t),i=e.from(a),(o={}).OperationSource="Upsync",[4,null===(n=null===(r=this._applicationContext.DataLayerConfiguration.DataProvider)||void 0===r?void 0:r.retrieveMultiple)||void 0===n?void 0:n.call(r,i.getQueryState(!0),f.RetrievalStrategy.Local,o)];case 1:return[2,s.sent()]}}))}))},e.prototype.getNorSyncEntityLogsOnSID=function(e,t,r){return o(this,void 0,void 0,(function(){var n,a,i;return s(this,(function(o){switch(o.label){case 0:return n=new d.Expression("ge",{attributeName:E.offlineLogSIdColumnName,value:e}),a=new d.Expression("le",{attributeName:E.offlineLogSIdColumnName,value:t}),i=p.ModernQueryBuilder.fromState({}).selectAll().where(n).where(a),[4,this.getNorSyncEntityLogs(i,r)];case 1:return[2,o.sent()]}}))}))},e.prototype.performOperations=function(e,t){var r,n;return void 0===t&&(t=!0),o(this,void 0,void 0,(function(){var a,i;return s(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),(a={}).OperationSource="Upsync",a.SuppressTriggers=t,[4,null===(n=null===(r=this._applicationContext.DataLayerConfiguration.DataProvider)||void 0===r?void 0:r.executeMultiple)||void 0===n?void 0:n.call(r,new y.ODataExecuteMultipleRequest(e,!0),f.RetrievalStrategy.Local,a,new v.UCIContext(_.Guid.newGuid().guid))];case 1:return o.sent(),[2,!0];case 2:throw i=o.sent(),i=O.convertToErrorStatus(i),this._tracer.error(b.addPrefix("OfflineUpSync.PlaybackManager.UpdateRowVersion.Fail",i.message)),i;case 3:return[2]}}))}))},e.prototype.clearOfflineLogs=function(e,t,r){return o(this,void 0,void 0,(function(){var n,a,i,o,l,p,f,y;return s(this,(function(s){switch(s.label){case 0:if(!e.length)return[2,!0];n=[],a=new d.Expression("in",{attributeName:E.sqLiteResultsSidColumnName,value:e}),i=new d.Expression("in",{attributeName:E.offlineLogSIdColumnName,value:e});try{for(o=u(t),l=o.next();!l.done;l=o.next())p=l.value,n.push(this._deleteNorSyncEntityLog(p,i))}catch(e){f={error:e}}finally{try{l&&!l.done&&(y=o.return)&&y.call(o)}finally{if(f)throw f.error}}return n.push(this._deleteNorSyncMainLogs(a)),r.equals(m.LegacyGuid.get_empty())||n.push.apply(n,c(this._DeleteCommand(r))),[4,this.performOperations(n)];case 1:return s.sent(),[2,!0]}}))}))},e.prototype.updateCommandStatus=function(e,t){var r;if(h.IsNullOrUndefined(e))return null;var n=e.toDictionary(),a=((r={})[E.commandStatusColumnName]=t,r),i=new d.Expression("in",{attributeName:E.commandIdColumnName,value:[n[E.commandIdColumnName]]}),o=p.ModernQueryBuilder.fromState({}).where(i).from(E.commandTableName);return g.convertQueryStateToODataRequest(T.ODataRequestType.Update,o.getQueryState(!0),a)},e.prototype._DeleteCommand=function(e){var t=[],r=p.ModernQueryBuilder.fromState({}).where(new d.Expression("in",{attributeName:E.commandIdColumnName,value:[e.toString()]})).from(E.commandTableName);t.push(g.convertQueryStateToODataRequest(T.ODataRequestType.DeleteWithUrlParams,r.getQueryState(!0)));var n=p.ModernQueryBuilder.fromState({}).where(new d.Expression("in",{attributeName:E.commandOperationCommandIdColumnName,value:[e.toString()]})).from(E.commandOperationTableName);return t.push(g.convertQueryStateToODataRequest(T.ODataRequestType.DeleteWithUrlParams,n.getQueryState(!0))),t},e.prototype._deleteNorSyncMainLogs=function(e){var t=p.ModernQueryBuilder.fromState({}).where(e).from(E.norSyncMainLogTableName);return g.convertQueryStateToODataRequest(T.ODataRequestType.DeleteWithUrlParams,t.getQueryState(!0))},e.prototype._deleteNorSyncEntityLog=function(e,t){var r=p.ModernQueryBuilder.fromState({}).where(t).from(e);return g.convertQueryStateToODataRequest(T.ODataRequestType.DeleteWithUrlParams,r.getQueryState(!0))},e}();t.OfflineLogHelper=S},TsoX:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConcurrencyBehavior=void 0,function(e){e[e.Default=0]="Default",e[e.IfRowVersionMatches=1]="IfRowVersionMatches",e[e.AlwaysOverwrite=2]="AlwaysOverwrite"}(t.ConcurrencyBehavior||(t.ConcurrencyBehavior={}))},UWtl:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EntityCollection=void 0;var n=r("WHxM"),a=r("nf9M"),i=r("g/kV"),o=r("2Dq5"),s=function(){function e(e,t,r,n,a,i){var s,u;if(this._moreRecords=!1,this._totalRecordCount=0,this._totalRecordCountLimitExceeded=!1,o.throwOnNullOrUndefinedArgument(e,"entities"),this._moreRecords=t,this._totalRecordCount=r,this._totalRecordCountLimitExceeded=n,this._entities=e,this._query=a,i){var l=null===(u=null===(s=this._entities)||void 0===s?void 0:s[0])||void 0===u?void 0:u.get_clientRetrieveOptions();l&&this.set_clientRetrieveOptions(l)}}return e.prototype.get_entities=function(){return this._entities},e.prototype.get_moreRecords=function(){return this._moreRecords},e.prototype.get_totalRecordCountLimitExceeded=function(){return this._totalRecordCountLimitExceeded},e.prototype.get_totalRecordCount=function(){return this._totalRecordCount},e.prototype.get_count=function(){return this.get_entities().length},e.prototype.get_query=function(){return this._query},e.prototype.set_query=function(e){this._query=e},e.prototype.get_key=function(){return!a.IsNullOrUndefined(this._query)&&this._query.get_key?this._query.get_key():""},e.prototype.get_clientRetrieveOptions=function(){return this._clientRetrieveOptions},e.prototype.set_clientRetrieveOptions=function(e){if(this._clientRetrieveOptions=e,!a.IsNullOrUndefined(this._clientRetrieveOptions))for(var t=0;t<this._entities.length;t++)a.IsNullOrUndefined(this._entities[t].get_clientRetrieveOptions())&&this._entities[t].set_clientRetrieveOptions(this._clientRetrieveOptions)},e.prototype.get_item=function(e){return this.get_entities()[e]},e.prototype.getObjectData=function(){for(var e={},t=new Array(this.get_entities().length),r=0;r<this.get_entities().length;r++)t[r]=this.get_entities()[r].getObjectData();return e.entities=t,e.morerecords=this._moreRecords,e.totalrecordcount=this._totalRecordCount,e.totalRecordCountLimitExceeded=this._totalRecordCountLimitExceeded,a.IsNullOrUndefined(this._clientRetrieveOptions)||(e.clientretrieveoptions=this._clientRetrieveOptions.getObjectData()),e},e.prototype.add=function(e){this._entities.push(e)},e.createFromObjectData=function(t){for(var r=new Array(0),a=t.entities,o=0;o<a.length;o++)r[o]=n.EntityRecord.createFromObjectData(a[o]);return new e(r,t.morerecords,t.totalrecordcount,"totalRecordCountLimitExceeded"in t&&t.totalRecordCountLimitExceeded,null,"clientretrieveoptions"in t?i.ClientRetrieveOptions.createFromObjectData(t.clientretrieveoptions):null)},e}();t.EntityCollection=s,s.__typeName="Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.EntityCollection"},Umyr:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CrudCommandData=void 0;var n=function(){function e(e,t,r){this._commandType=0,this.sqlOperation=0,this._commandType=0,this.sqlOperation=e,this.entityRecord=t,this.rollBackEntityRecord=r,this.associatedActivityParties=[]}return Object.defineProperty(e.prototype,"commandType",{get:function(){return this._commandType},enumerable:!1,configurable:!0}),e}();t.CrudCommandData=n},"UxT/":function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return a(t,e),t},o=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.getRelationShipByNavigationProperty=t.getRelationshipTypeByNavigationProperty=t.getEntityIconVectorName=t.getManyToManyRelationships=t.getPrimaryNameAttribute=t.getAttributeNamesFromEntityMetadata=t.getPrimaryIdAttribute=t.getRelationshipType=t.getManyToManyRelationship=t.getManyToOneRelationship=t.getManyToOneRelationshipByNavigationProperty=t.getManyToOneRelationshipByReferencedEntity=t.getOnetoManyRelationShipByNavigationProperty=t.getAllOneToManyRelationshipByReferencingEntity=t.getManyToOneRelationShipByNavigationProperty=t.getActivityPartyNavigationPropertyRelationship=t.getOneToManyRelationship=t.getHasStateCode=t.getManyToOneRelationships=t.getOneToManyRelationships=t.getDisplayName=t.getDisplayCollectionName=t.getIsIntersectFlag=t.getIsActivityFlag=t.getActivities=t.getEntitySetName=t.getEntitiesDescriptors=t.getEntityDescriptor=t.getEntityTypeCode=t.getEntityInitState=t.getEntityLogicalNameFromSetName=void 0;var s=r("KkiZ"),u=i(r("6QHb")),l={systemuser:"systemusers",team:"teams"};function c(e,t){return e&&(null==e?void 0:e.metadata)&&(null==e?void 0:e.metadata.entities)?null==e?void 0:e.metadata.entities[t]:null}function d(e,t){var r=c(e,t);return!(!r||!r.hasOwnProperty("IsActivity"))&&r.IsActivity}function p(e){return e&&(null==e?void 0:e.metadata)?null==e?void 0:e.metadata.entities:null}function f(e,t){var r=c(e,t);return r&&r.OneToManyRelationships?r.OneToManyRelationships:null}function y(e,t){var r=c(e,t);return r?r.ManyToOneRelationships:null}function m(e,t,r){var n=f(e,t);return n&&n.hasOwnProperty(r)?n[r]:null}function h(e,t,r){var n=c(e,t);return n&&n.ManyToOneRelationships&&n.ManyToOneRelationships.hasOwnProperty(r)?n.ManyToOneRelationships[r]:null}function g(e,t,r,n){var a=c(e,t);if(a&&a.ManyToOneRelationships)for(var i in a.ManyToOneRelationships){var o=a.ManyToOneRelationships[i];if(o.ReferencedEntity===r&&o.ReferencingAttribute===n)return o}return null}function E(e,t,r){var n=c(e,t);return n&&n.ManyToManyRelationships&&n.ManyToManyRelationships.hasOwnProperty(r)?n.ManyToManyRelationships[r]:null}function b(e,t,r){var n,a,i=f(e,t);if(i)try{for(var s=o(Object.keys(i)),u=s.next();!u.done;u=s.next()){var l=i[u.value];if(l.ReferencedEntityNavigationPropertyName===r)return l}}catch(e){n={error:e}}finally{try{u&&!u.done&&(a=s.return)&&a.call(s)}finally{if(n)throw n.error}}return null}function O(e,t,r){var n,a,i=y(e,t);if(i)try{for(var s=o(Object.keys(i)),u=s.next();!u.done;u=s.next()){var l=i[u.value];if(l.ReferencingEntityNavigationPropertyName===r)return l}}catch(e){n={error:e}}finally{try{u&&!u.done&&(a=s.return)&&a.call(s)}finally{if(n)throw n.error}}return null}t.getEntityDescriptor=c,t.getEntityInitState=function(e,t){var r=c(e,t);return r?r.Initialized:s.InitState.Uninitialized},t.getEntityLogicalNameFromSetName=function(e,t){if(!e||!(null==e?void 0:e.metadata)||!(null==e?void 0:e.metadata.entities))return null;var r=null==e?void 0:e.metadata.entities;for(var n in r)if(r[n].EntitySetName===t)return r[n].EntityLogicalName;return null},t.getEntityTypeCode=function(e,t){var r;return null==c(e,t)?null:null===(r=c(e,t))||void 0===r?void 0:r.ObjectTypeCode},t.getEntitySetName=function(e,t){var r=c(e,t);if(r&&r.EntitySetName)return r.EntitySetName;var n=l[t];return n||null},t.getActivities=function(e){var t=p(e),r={};for(var n in t)d(e,n)&&(r[n]=t[n]);return r},t.getIsActivityFlag=d,t.getHasStateCode=function(e,t){var r=c(e,t);return!(!r||!r.hasOwnProperty("HasStateCode"))&&r.HasStateCode},t.getIsIntersectFlag=function(e,t){var r=c(e,t);return!(!r||!r.hasOwnProperty("IsIntersect"))&&r.IsIntersect},t.getEntitiesDescriptors=p,t.getDisplayCollectionName=function(e,t){var r=c(e,t);return r&&r.DisplayCollectionName?r.DisplayCollectionName:null},t.getDisplayName=function(e,t){var r=c(e,t);return r&&r.DisplayName?r.DisplayName:null},t.getOneToManyRelationships=f,t.getManyToOneRelationships=y,t.getOneToManyRelationship=m,t.getAllOneToManyRelationshipByReferencingEntity=function(e,t,r){var n=f(e,t);if(!n)return null;var a=[];for(var i in n){var o=n[i];o.ReferencedEntity===t&&o.ReferencingEntity===r&&a.push(o)}return a},t.getManyToOneRelationship=h,t.getManyToOneRelationshipByReferencedEntity=function(e,t,r,n){var a=g(e,t,r,n);if(!a){var i=c(e,t);i&&i.ManyToOneRelationships&&i.IsActivity&&(a=g(e,"activitypointer",r,n))}return a},t.getActivityPartyNavigationPropertyRelationship=function(e,t){var r=f(e,t);if(!r)return null;var n=[];for(var a in r){var i=r[a];if(i.ReferencedEntity===t&&"activityparty"===i.ReferencingEntity){if("campaignactivity"===t&&"campaignactivity_activity_parties"!==a||"bulkoperation"===t&&"bulkoperation_activity_parties"!==a)continue;n.push(i)}}return 1===n.length?n[0]:null},t.getManyToOneRelationshipByNavigationProperty=function(e,t,r){var n=c(e,t);if(n&&n.ManyToOneRelationships)for(var a in n.ManyToOneRelationships){var i=n.ManyToOneRelationships[a];if(i.ReferencingEntityNavigationPropertyName===r)return i}return null},t.getManyToManyRelationship=E,t.getRelationshipType=function(e,t,r){return m(e,t,r)?u.RelationshipType.OneToManyRelationship:E(e,t,r)?u.RelationshipType.ManyToManyRelationship:h(e,t,r)?u.RelationshipType.None:null},t.getOnetoManyRelationShipByNavigationProperty=b,t.getManyToOneRelationShipByNavigationProperty=O,t.getRelationShipByNavigationProperty=function(e,t,r){var n=O(e,t,r);return n||b(e,t,r)},t.getRelationshipTypeByNavigationProperty=function(e,t,r){return b(e,t,r)?u.RelationshipType.OneToManyRelationship:O(e,t,r)?u.RelationshipType.ManyToOneRelationship:u.RelationshipType.None},t.getPrimaryIdAttribute=function(e,t){return e&&(null==e?void 0:e.metadata)&&(null==e?void 0:e.metadata.entities)&&t&&(null==e?void 0:e.metadata.entities[t])?null==e?void 0:e.metadata.entities[t].PrimaryIdAttribute:null},t.getAttributeNamesFromEntityMetadata=function(e,t){var r=c(e,t);return r?new Set(r.AttributeNames):null},t.getPrimaryNameAttribute=function(e,t){var r=t?c(e,t):null;return r&&r.PrimaryNameAttribute?r.PrimaryNameAttribute:null},t.getManyToManyRelationships=function(e,t){var r=c(e,t);return r&&r.ManyToManyRelationships?r.ManyToManyRelationships:null},t.getEntityIconVectorName=function(e,t){var r=c(e,t);return r&&r.IconVectorName?r.IconVectorName:null}},VmTk:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.setConsistencyStrong=t.PREVIEW_SET_CONSISTENCY_STRONG_ACTION=void 0;t.PREVIEW_SET_CONSISTENCY_STRONG_ACTION="preview.form.setConsistencyStrong",t.setConsistencyStrong=function(e){return{type:"preview.form.setConsistencyStrong",payload:e}}},WHxM:function(e,t,r){"use strict";var n=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.EntityRecord=void 0;var a=r("yNq8"),i=r("4oeN"),o=r("x0cL"),s=r("nf9M"),u=r("LTKH"),l=r("EHm6"),c=r("PaRk"),d=r("2Dq5"),p=r("iLQe"),f=r("Zwof"),y=r("g/kV"),m=r("UWtl"),h=r("s+yA"),g=r("rW8f"),E=r("H5aA"),b=r("WIpw"),O=function(){function e(t,r,n,a,i,o,u,l){this._accessRights=0,t instanceof e?(r=t._fields,n=t._fieldTypes,a=t._formattedValues,i=t._numericFormattedValues,o=t._relatedEntities,l=t._clientRetrieveOptions,this._identifier=t._identifier):this._identifier=t,d.throwOnNullOrUndefinedArgument(this._identifier,"identifier"),d.throwOnNullOrUndefinedArgument(r,"fields"),d.throwOnNullOrUndefinedArgument(n,"fieldTypes"),d.throwOnNullOrUndefinedArgument(a,"formattedValues"),d.throwOnNullOrUndefinedArgument(i,"numericFormattedValues"),d.throwOnNullOrUndefinedArgument(o,"relatedEntities"),this._fields=r,this._fieldTypes=n,this._formattedValues=a,this._numericFormattedValues=i,this._relatedEntities=o,this._columnSet=s.IsNullOrUndefined(u)?new f.LegacyColumnSet(new Array(0)):u,this.updateColumnSet(this.get_fieldNames()),this._changedFieldNames=[],this._cleanFields={},this._clientRetrieveOptions=l,this._accessRights=0;var c=this.getValue("activitytypecode");"activitypointer"===this._identifier.LogicalName&&c?this._actionableIdentifier=new g.LegacyEntityReference(c,this._identifier.Id):this._actionableIdentifier=this._identifier,this._userSharedAttributePrivileges={}}return Object.defineProperty(e.prototype,"fields",{get:function(){return this._fields},enumerable:!1,configurable:!0}),e.prototype.get_identifier=function(){return this._identifier},e.prototype.get_actionableIdentifier=function(){return this._actionableIdentifier},e.prototype.get_fieldTypes=function(){return this._fieldTypes},e.prototype.get_formattedValues=function(){return this._formattedValues},e.prototype.get_numericFormattedValues=function(){return this._numericFormattedValues},e.prototype.get_relatedEntities=function(){return this._relatedEntities},e.prototype.get_fieldNames=function(){var e=[],t=this._fields;for(var r in t){var n={key:r,value:t[r]};e.push(n.key)}return e},e.prototype.get_changedFieldNames=function(){return this._changedFieldNames},e.prototype.get_columnSet=function(){return this._columnSet},e.prototype.get_key=function(){return this.get_identifier().get_key()},e.prototype.get_clientRetrieveOptions=function(){return this._clientRetrieveOptions},e.prototype.set_clientRetrieveOptions=function(e){var t,r;this._clientRetrieveOptions=e;try{for(var a=n(this._relatedEntities.get_entityCollections()),i=a.next();!i.done;i=a.next()){i.value.get_value().set_clientRetrieveOptions(e)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}},e.prototype.get_accessRights=function(){return this._accessRights},e.prototype.set_accessRights=function(e){this._accessRights=e},e.prototype.get_userSharedAttributePrivileges=function(){return this._userSharedAttributePrivileges},e.prototype.set_userSharedAttributePrivileges=function(e){this._userSharedAttributePrivileges=e},e.prototype.get_entityRecordForProcess=function(){return this._entityRecordForProcess},e.prototype.set_entityRecordForProcess=function(e){return this._entityRecordForProcess=e,e},e.prototype.get_globalNavigationData=function(){return this._globalNavigationData},e.prototype.set_globalNavigationData=function(e){this._globalNavigationData=e},e.prototype.isDirty=function(){return this.get_changedFieldNames().length>0},e.prototype.clone=function(){var t=this.getObjectData(),r=t.columnset;s.IsNullOrUndefined(r)||(r.columns=r.columns.slice());var n=t.formattedfields,a={};for(var i in n){a[(c={key:i,value:n[i]}).key]=c.value}var o=t.numericformattedfields,u={};for(var l in o){var c;u[(c={key:l,value:o[l]}).key]=c.value}return t.formattedfields=a,t.numericformattedfields=u,e.createFromObjectData(t)},e.prototype.getObjectData=function(){var e=this._columnSet instanceof p.AllColumns;return{identifier:this._identifier.getObjectData(),fields:this._GetFieldsObjectData(),fieldtypes:{},formattedfields:this._formattedValues,numericformattedfields:this._numericFormattedValues,allcolumns:e,columnset:e?void 0:this._columnSet.getObjectData(),clientretrieveoptions:s.IsNullOrUndefined(this._clientRetrieveOptions)?void 0:this._clientRetrieveOptions.getObjectData(),accessrights:this._accessRights,sharedattributeprivileges:{},entityrecordforprocess:s.IsNullOrUndefined(this.get_entityRecordForProcess())?void 0:this.get_entityRecordForProcess().getObjectData(),globalnavigationdata:s.IsNullOrUndefined(this.get_globalNavigationData())?void 0:this.get_globalNavigationData().getObjectData()}},e.prototype._GetFieldsObjectData=function(){var e=this;return Object.keys(this._fields).reduce((function(t,r){return t[r]=e.getFieldObjectData(r),t}),{})},e.prototype.getFieldObjectData=function(t){return e.InternalGetFieldObjectData(this.getValue(t),this._fieldTypes[t])},e.prototype.getFields=function(){return this._GetFieldsObjectData()},e.prototype.hasValue=function(e){return e in this._fields},e.prototype.hasField=function(e){return e in this._fieldTypes},e.prototype.getValue=function(e){return this._fields[e]},e.prototype.getFormattedValue=function(e){return s.IsNullOrUndefined(this.get_formattedValues()[e])?this.get_fieldTypes()[e]===a.AttributeType.AliasedValue?this.getValue(e).get_value():this.getValue(e):this.get_formattedValues()[e]},e.prototype.getNumericFormattedValue=function(e){return this._numericFormattedValues[e]||this.getFormattedValue(e)},e.prototype.setValue=function(e,t){if(!(e in this.get_fieldTypes()))throw Error(e);t&&t.get_Label&&t.get_ValueString?this._fields[e]=E.OptionMetadata.createFromPicklistItem(t):this._fields[e]=t,this.updateColumnSet([e])},e.prototype.markFieldChanged=function(e){var t,r;if(this.get_changedFieldNames().indexOf(e)<0&&(this._cleanFields[e]=this._fields[e],this.get_changedFieldNames().push(e),this._fields[e]instanceof m.EntityCollection))try{for(var a=n(this._fields[e].get_entities()),i=a.next();!i.done;i=a.next()){i.value._MarkAllFieldsChanged()}}catch(e){t={error:e}}finally{try{i&&!i.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}},e.prototype._MarkAllFieldsChanged=function(){var e,t;try{for(var r=n(this.get_fieldNames()),a=r.next();!a.done;a=r.next()){var i=a.value;this.markFieldChanged(i)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}},e.prototype.resetChanges=function(){this._changedFieldNames=[],this._cleanFields={}},e.prototype.mergeChanges=function(e){s.IsNullOrUndefined(this._clientRetrieveOptions)?this._clientRetrieveOptions=e._clientRetrieveOptions:this._clientRetrieveOptions.update(e._clientRetrieveOptions),this.set_accessRights(e.get_accessRights()),this.mergeEntityRecordFields(e),this._entityRecordForProcess=e._entityRecordForProcess,this._globalNavigationData=e._globalNavigationData},e.prototype.mergeEntityRecordFields=function(e){var t=e._fields;for(var r in t){(u={key:r,value:t[r]}).key in this._fields&&c.areValuesEqual(this._fields[u.key],u.value)||(this._fields[u.key]=u.value)}var n=e._fieldTypes;for(var a in n){var i=(u={key:a,value:n[a]}).key;i in this._fieldTypes||(this._fieldTypes[i]=e._fieldTypes[i]),i in this._fields&&!(i in e._fields)&&(delete this._fields[i],delete this._formattedValues[i],delete this._numericFormattedValues[i])}var o=e._formattedValues;for(var s in o){var u;(u={key:s,value:o[s]}).key in this._formattedValues&&c.areValuesEqual(this._formattedValues[u.key],u.value)||(this._formattedValues[u.key]=u.value)}e.get_columnSet()instanceof p.AllColumns?this.updateColumnSet(e.get_columnSet()):this.updateColumnSet(this.get_fieldNames())},e.prototype.initializeValue=function(e,t,r){this._fields[e]=t,e in this._fieldTypes||(this._fieldTypes[e]=r),this.updateColumnSet([e])},e.prototype.updateColumnSet=function(e,t){var r,a,i,o,u,l;if(e=e,!(this.get_columnSet()instanceof p.AllColumns)){if(e instanceof p.AllColumns)this._columnSet=p.AllColumns.get_instance();else{var c=void 0;c=e instanceof f.LegacyColumnSet?e.get_Columns():e;var d=this._columnSet;try{for(var y=n(c),m=y.next();!m.done;m=y.next()){var h=m.value;d.get_Columns().indexOf(h)<0&&d.get_Columns().push(h)}}catch(e){r={error:e}}finally{try{m&&!m.done&&(a=y.return)&&a.call(y)}finally{if(r)throw r.error}}}if(!s.IsNullOrUndefined(t)&&t&&(null==t?void 0:t.length)>0)try{for(var g=n(t),E=g.next();!E.done;E=g.next()){var b=E.value,O=this.get_relatedEntities().getByRelationship(b.get_relationship());if(O)try{for(var v=(u=void 0,n(O.get_entities())),_=v.next();!_.done;_=v.next()){_.value.updateColumnSet(b.get_ColumnSet())}}catch(e){u={error:e}}finally{try{_&&!_.done&&(l=v.return)&&l.call(v)}finally{if(u)throw u.error}}}}catch(e){i={error:e}}finally{try{E&&!E.done&&(o=g.return)&&o.call(g)}finally{if(i)throw i.error}}}},e.createFromObjectData=function(t){var r,n,a={},i=t.identifier&&g.LegacyEntityReference.createFromObjectData(t.identifier),o=e.createFieldsFromObjectData(t.fields,a);r=t.allcolumns?p.AllColumns.get_instance():f.LegacyColumnSet.createFromObjectData(t.columnset),t.clientretrieveoptions&&(n=y.ClientRetrieveOptions.createFromObjectData(t.clientretrieveoptions));var u=new e(i,o,a,t.formattedfields,t.numericformattedfields,new b.RelatedEntityCollection(new Array(0)),r,n);u.set_accessRights(t.accessrights);var l=t.entityrecordforprocess;s.IsNullOrUndefined(l)||u.set_entityRecordForProcess(e.createFromObjectData(l));var c=t.globalnavigationdata;return s.IsNullOrUndefined(c)||u.set_globalNavigationData(e.createFromObjectData(c)),u},e.createSingleFieldFromObjectData=function(t,r){return e.InternalCreateFieldFromObjectData(t,r)},e.createFieldsFromObjectData=function(t,r){var n={};for(var a in t){var i={key:a,value:t[a]};n[i.key]=e.InternalCreateFieldFromObjectData(i.value,r[i.key])}return n},e.InternalCreateFieldFromObjectData=function(e,t){if(s.IsNullOrUndefined(e))return null;switch(t){case a.AttributeType.AliasedValue:return h.LegacyAliasedValue.createFromObjectData(e);case a.AttributeType.Customer:case a.AttributeType.Lookup:case a.AttributeType.Owner:return g.LegacyEntityReference.createFromObjectData(e);case a.AttributeType.UniqueIdentifier:return i.LegacyGuid.createFromObjectData(e);case a.AttributeType.DateTime:return new Date(Date.parse(e));case a.AttributeType.Status:case a.AttributeType.State:case a.AttributeType.Boolean:case a.AttributeType.PickList:return E.OptionMetadata.createFromObjectData(e);case a.AttributeType.PartyList:return m.EntityCollection.createFromObjectData(e);default:return e}},e.InternalGetFieldObjectData=function(e,t){if(s.IsNullOrUndefined(e))return null;switch(t){case a.AttributeType.AliasedValue:return e.getObjectData();case a.AttributeType.Customer:case a.AttributeType.Lookup:case a.AttributeType.Owner:case a.AttributeType.UniqueIdentifier:return e.getObjectData();case a.AttributeType.DateTime:return e.toString();case a.AttributeType.Status:case a.AttributeType.State:case a.AttributeType.Boolean:case a.AttributeType.PickList:case a.AttributeType.PartyList:return e.getObjectData();default:return e}},e.recordDataToLegacyEntityRecord=function(t,r,n,a,i,s){void 0===s&&(s=l.FieldValueRetrievalBehavior.LatestEntered);var c=new e(o.EntityReference.toLegacyEntityReference(r),{},{},{},{},new b.RelatedEntityCollection([]));for(var d in n){var p=u.getAttributeDescriptor(t,r.etn,d);if(p){var f=l.getLegacyValueForField(t,r.etn,d,n[d],s);c.initializeValue(d,f,p.Type),c.markFieldChanged(d)}else{var y="Attribute "+d+" for entity "+r.etn+" could not be found.";i.warn("EntityRecord "+y)}}return c},e}();t.EntityRecord=O},WIpw:function(e,t,r){"use strict";var n=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.RelatedEntityCollection=void 0;var a=r("74cx"),i=r("2Dq5"),o=function(){function e(e){i.throwOnNullOrUndefinedArgument(e,"entityCollections"),this._entityCollections=e,this._relatedEntityQueries=this._entityCollections.map((function(e){return e.get_value().get_query()}))}return e.prototype.get_entityCollections=function(){return this._entityCollections},e.prototype.get_relatedEntityQueries=function(){return this._relatedEntityQueries},e.prototype.getObjectData=function(){var e,t,r={},a=[];try{for(var i=n(this._entityCollections),o=i.next();!o.done;o=i.next()){var s=o.value,u={};u.key=s.get_key().getObjectData(),u.value=s.get_value().getObjectData(),a.push(u)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}return r.entitycollections=a,r},e.prototype.getByRelationship=function(e){var t,r;try{for(var a=n(this._entityCollections),i=a.next();!i.done;i=a.next()){var o=i.value;if(o.get_key().equals(e))return o.get_value()}}catch(e){t={error:e}}finally{try{i&&!i.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}return null},e.prototype.addRelationship=function(e,t){for(var r=0;r<this._entityCollections.length;r++)if(this._entityCollections[r].get_key().equals(e))return void(this._entityCollections[r]=new a.KeyValuePair(e,t));this._entityCollections.push(new a.KeyValuePair(e,t))},e}();t.RelatedEntityCollection=o},WkZn:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.GARBAGE_COLLECT_METADATA_ACTION_SYNC=t.UPDATE_GC_METADATA_REFCOUNT_ACTION=t.updateGCMetadataRefCount=t.GC_REMOVE_METADATA=t.replaceEntityWithPlaceholder=t.gcRemoveMetadata=t.garbageCollectMetadata=void 0;var n=r("b1WC"),a=r("KkiZ"),i=r("UxT/"),o=r("rxGJ");t.GARBAGE_COLLECT_METADATA_ACTION_SYNC="garbage.collect.metadata.sync";t.GC_REMOVE_METADATA="gc.metadata.remove";function s(e,t,r,n){var o=i.getEntityDescriptor(e,t);if(o){var s={Initialized:a.InitState.Uninitialized,EntityLogicalName:o.EntityLogicalName,IsActivity:o.IsActivity};r[t]=s,n[t]=null}}function u(e){return{type:"gc.metadata.remove",payload:e}}function l(e,t){return{type:"gc.metadata.update.refcount",payload:{entities:e,ribbons:t}}}t.UPDATE_GC_METADATA_REFCOUNT_ACTION="gc.metadata.update.refcount",t.garbageCollectMetadata=function(e){return{type:"garbage.collect.metadata.sync",sync:!0,execute:function(t,r){var a,i=t.dispatch,c=(0,t.getState)(),d={},p={},f={},y=o.getGCEntitiesMetadata(c);for(var m in y){var h=null===(a=y[m])||void 0===a?void 0:a.slice(),g=h&&n.removeReference(h,e);g&&(0===g.length?s(c,m,d,p):f[m]=g)}var E={};((Object.keys(E).length>0||Object.keys(f).length>0)&&i(l(f,E)),Object.keys(d).length>0)&&i(u({entities:d,attributes:p}))}}},t.replaceEntityWithPlaceholder=s,t.gcRemoveMetadata=u,t.updateGCMetadataRefCount=l},XZ3b:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.getConsistencyStrong=void 0,t.getConsistencyStrong=function(e){return!!(e&&e.metadata&&e.metadata.consistencyStrong)&&e.metadata.consistencyStrong}},YEmJ:function(e,t,r){"use strict";r.r(t),r.d(t,"metadataCache",(function(){return V})),r.d(t,"getEntityLogicalName",(function(){return H})),r.d(t,"getEntityLogicalNameFromOtc",(function(){return G})),r.d(t,"getAttributeTypes",(function(){return Q})),r.d(t,"getUserSettings",(function(){return X})),r.d(t,"getOrganizationSettings",(function(){return W})),r.d(t,"getfullnameconventioncode",(function(){return z})),r.d(t,"getLanguageCode",(function(){return Y})),r.d(t,"getUserId",(function(){return K})),r.d(t,"getUserName",(function(){return J})),r.d(t,"isFeatureEnabled",(function(){return Z})),r.d(t,"getViewMetadata",(function(){return ee})),r.d(t,"getEntityMetadata",(function(){return te})),r.d(t,"populateAllEntityMetadata",(function(){return re})),r.d(t,"getAttributesMetadata",(function(){return ne})),r.d(t,"getAttributesMetadataFromStateAndMetadataCache",(function(){return ae})),r.d(t,"getOfflineAvailableEntities",(function(){return ie})),r.d(t,"fromNumberAttributeType",(function(){return de})),r.d(t,"getViewSqlResults",(function(){return we})),r.d(t,"getEntitySqlResults",(function(){return Me})),r.d(t,"getAttributesSqlResults",(function(){return Ie})),r.d(t,"getUserContextResults",(function(){return Ae})),r.d(t,"getBooleanValue",(function(){return Le})),r.d(t,"getAvailableOfflineValue",(function(){return Ue})),r.d(t,"getViewIdValue",(function(){return Fe})),r.d(t,"getEntity1NavigationPropertyNameValue",(function(){return xe})),r.d(t,"getEntity2NavigationPropertyNameValue",(function(){return ke})),r.d(t,"getIntersectEntityNameValue",(function(){return je})),r.d(t,"getReferencedEntityNavigationPropertyNameValue",(function(){return qe})),r.d(t,"getRelationShipTypeValue",(function(){return Be}));var n,a=r("6QHb"),i=r("fKp2"),o=r("OJ1H"),s=r("gpz4"),u=r("7l03"),l=r("yNq8"),c=r("4oeN");
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
class d{constructor(e,t,r,n,a,i,o){this._privilegeType=0,this._canBeBasic=!1,this._canBeLocal=!1,this._canBeDeep=!1,this._canBeGlobal=!1,Object(u.throwOnNullOrUndefinedArgument)(e,"name"),Object(u.throwOnNullOrUndefinedArgument)(t,"privilegeId"),this._name=e,this._privilegeId=t,this._privilegeType=r,this._canBeBasic=n,this._canBeLocal=a,this._canBeDeep=i,this._canBeGlobal=o}static getPrivilegeTypeKey(e){return e.toString()}static createFromObjectData(e){const t=e.name,r=c.LegacyGuid.createFromObjectData(e.privilegeid),n=e.privilegetype,a=e.canbebasic,i=e.canbelocal,o=e.canbedeep,s=e.canbeglobal;return new d(t,r,n,a,i,o,s)}static createFromOData(e){const t=e.Name,r=c.LegacyGuid.tryCreate(e.PrivilegeId),n=e.PrivilegeType,a=e.CanBeBasic,i=e.CanBeLocal,o=e.CanBeDeep,s=e.CanBeGlobal;return new d(t,r,n,a,i,o,s)}get_privilegeId(){return this._privilegeId}get_privilegeType(){return this._privilegeType}get_privilegeTypeKey(){return d.getPrivilegeTypeKey(this.get_privilegeType())}get_canBeGlobal(){return this._canBeGlobal}getObjectData(){const e={};return e.name=this._name,e.privilegeid=this._privilegeId.getObjectData(),e.privilegetype=this._privilegeType,e.canbebasic=this._canBeBasic,e.canbelocal=this._canBeLocal,e.canbedeep=this._canBeDeep,e.canbeglobal=this.get_canBeGlobal(),e}getODataObject(){const e={};return e.Name=this._name,e.PrivilegeId=this._privilegeId.toString(),e.PrivilegeType=this._privilegeType,e.CanBeBasic=this._canBeBasic,e.CanBeLocal=this._canBeLocal,e.CanBeDeep=this._canBeDeep,e.CanBeGlobal=this.get_canBeGlobal(),e}}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */class p{constructor(e,t,r,n,a,i,o,s,l,d,p,f,y,m,h,g,E,b,O,v,_,T,S,N,C,P,R,w,M,I,A,D,L,U,F,x,k,j,q,B,$,V,H,G,Q,X,W,z,Y,K,J,Z){this._objectTypeCode=0,this._hasChanged=!1,this._isActivity=!1,this._isReadOnlyForMobileClient=!1,this._isVisibleInMobileClient=!1,this._isOfflineInMobileClient=!1,this._isOptimisticConcurrencyEnabled=!1,this._isChildEntity=!1,this._primaryKeyName="",this._autoRouteToOwnerQueue=!1,this._canTriggerWorkflow=!1,this._displayCollectionName="",this._description="",this._isValidForAdvancedFind=!1,this._isMailMergeEnabled=!1,this._isConnectionsEnabled=!1,this._isCustomizable=!1,this._isActivityParty=!1,this._isImportable=!1,this._isEnabledForCharts=!1,this._isCustomEntity=!1,this._isStateModelAware=!1,this._enforceStateTransitions=!1,this._activityTypeMask=0,this._ownershipType=0,this._isCollaboration=!1,this._hasSecuredAttributes=!1,this._hasStateCode=!1,this._isBusinessProcessEnabled=!1,this._isDocumentManagementEnabled=!1,this._isOneNoteIntegrationEnabled=!1,this._isMSTeamsIntegrationEnabled=!1,this._isIntersect=!1,this._hasActivities=!1,this._isInteractionCentricEnabled=!1,this._isQuickCreateEnabled=!1,this._entityClientSetting={AllowMainFormDialogForCreate:!1,AllowMainFormDialogForEdit:!1},this._isKnowledgeManagementEnabled=!1,this._isDocumentRecommendationsEnabled=!1,this._hasNotes=!1,this._usesBusinessDataLabelTable=!1,this._isBPFEntity=!1,this._oneToManyRelationships=[],this._manyToOneRelationships=[],this._manyToManyRelationships=[],this._dataProviderId=c.LegacyGuid.get_empty(),this._versionNumber=0,this._overallVersionNumber=0,Object(u.throwOnNullOrUndefinedArgument)(e,"id"),Object(u.throwOnNullOrUndefinedArgument)(t,"logicalName"),this._id=e,this._logicalName=t,this._displayName=r,this._entitySetName=n,this._objectTypeCode=a,this._primaryIdAttribute=i,this._primaryNameAttribute=o,this._primaryImageAttribute=s,this._isReadOnlyForMobileClient=d,this._isVisibleInMobileClient=p,this._isOfflineInMobileClient=f,this._isOptimisticConcurrencyEnabled=y,this._hasChanged=m,this._isActivity=h,this._isChildEntity=g,this._parentEntityLogicalName=E,this._parentEntityReferencingAttribute=b,this._isValidForAdvancedFind=O,this._isMailMergeEnabled=v,this._isConnectionsEnabled=_,this._isCustomizable=T,this._isActivityParty=S,this._isImportable=N,this._isEnabledForCharts=C,this._isCustomEntity=P,this._isStateModelAware=R,this._enforceStateTransitions=w,this._isCollaboration=M,this._activityTypeMask=I,this._ownershipType=A,this._hasSecuredAttributes=D,this._hasStateCode=L,this._isBusinessProcessEnabled=U,this._isDocumentManagementEnabled=F,this._isOneNoteIntegrationEnabled=x,this._isMSTeamsIntegrationEnabled=k,this._hasActivities=j,this._entityColor=q,this._isInteractionCentricEnabled=B,this._isQuickCreateEnabled=$,this._entityClientSetting=V,this._isKnowledgeManagementEnabled=H,this._isDocumentRecommendationsEnabled=G,this._isIntersect=Q,this._hasNotes=X,this._usesBusinessDataLabelTable=W,this._iconVectorName=z,this._isBPFEntity=Y,this._versionNumber=K,this._overallVersionNumber=J,this._attributeNames=Z,this._privilegesByType={};for(const e of l)this._privilegesByType[e.get_privilegeTypeKey()]=e}static extractKey(e){return c.LegacyGuid.createFromObjectData(e[p._idPath]).toString()}static createFromObjectData(e){if(!Object(u.isNullOrUndefinedOrEmptyString)(e.MetadataId)){e=p.createFromOData(e).getObjectData()}const t=c.LegacyGuid.createFromObjectData(e[p._idPath]),r=e[p.logicalNamePath],n=e.displayname,a=e.entitysetname,i=e.objecttypecode,o=e.primaryidattribute,s=e.primarynameattribute,l=e.primaryimageattribute,f=e.isreadonlyformobileclient,y=e.isvisibleinmobileclient,m=e.isofflineinmobileclient,h=e.isoptimisticconcurrencyenabled,g=e.haschanged,E=e.isactivity,b=e.ischildentity,O=e.parententitylogicalname,v=e.parententityreferencingattribute,_=e.isvalidforadvancedfind,T=e.ismailmergeenabled,S=e.isconnectionsenabled,N=e.iscustomizable,C=e.isactivityparty,P=e.isimportable,R=e.isenabledforcharts,w=e.iscustomentity,M=e.isstatemodelaware,I=e.enforcestatetransitions,A=e.iscollaboration,D=e.activitytypemask,L=e.ownershiptype,U=e.hassecuredattributes,F=e.hasstatecode,x=e.isbusinessprocessenabled,k=e.isdocumentmanagementenabled,j=e.isonenoteintegrationenabled,q=e.ismsteamsintegrationenabled,B=e.hasactivities,$=e.entitycolor,V=e.isinteractioncentricenabled,H=e.isQuickCreateEnabled,G=e.entityClientSetting,Q=e.isKnowledgeManagementEnabled,X=e.IsDocumentRecommendationsEnabled,W=e.isIntersect,z=e.hasnotes,Y=e.usesBusinessDataLabelTable,K=e.iconVectorName,J=e.isbpfentity,Z=Object(u.isNullOrUndefinedOrEmptyString)(e.dataProviderId)?c.LegacyGuid.get_empty():c.LegacyGuid.tryCreate(e.dataProviderId),ee=e.primaryKeyName,te=e.autoRouteToOwnerQueue,re=e.canTriggerWorkflow,ne=e.displayCollectionName,ae=e.description,ie=e.oneToManyRelationships,oe=e.manyToOneRelationships,se=e.manyToManyRelationships;let ue=-1,le=-1;e.VersionNumber&&(ue=e.VersionNumber),e.OverallVersionNumber&&(le=e.OverallVersionNumber);const ce=e.AttributeNames,de=e.privileges.map(e=>d.createFromObjectData(e)),pe=new p(t,r,n,a,i,o,s,l,de,f,y,m,h,g,E,b,O,v,_,T,S,N,C,P,R,w,M,I,A,D,L,U,F,x,k,j,q,B,$,V,H,G,Q,X,W,z,Y,K,J,ue,le,ce);return pe._primaryKeyName=ee,pe._autoRouteToOwnerQueue=te,pe._canTriggerWorkflow=re,pe._displayCollectionName=ne,pe._description=ae,pe._dataProviderId=Z,pe._oneToManyRelationships=ie,pe._manyToManyRelationships=se,pe._manyToOneRelationships=oe,pe}static getLabelString(e){return Object(u.isNullOrUndefined)(e.UserLocalizedLabel)?"":e.UserLocalizedLabel.Label}static convertToLabel(e){const t={UserLocalizedLabel:{}};return t.UserLocalizedLabel.Label=e,t}static createFromOData(e){const t=c.LegacyGuid.tryCreate(e.MetadataId),r=e.LogicalName,n=p.getLabelString(e.DisplayName),a=e.EntitySetName,i=e.ObjectTypeCode,o=e.PrimaryIdAttribute,s=e.IconVectorName,l=e.PrimaryKeyName,f=e.AutoRouteToOwnerQueue,y=e.CanTriggerWorkflow,m=e.PrimaryNameAttribute,h=e.PrimaryImageAttribute,g=e.IsReadOnlyInMobileClient,E=e.IsVisibleInMobileClient,b=e.IsOfflineInMobileClient,O=e.IsOptimisticConcurrencyEnabled,v=e.HasChanged,_=e.IsActivity,T=e.IsChildEntity,S=e.ParentEntityLogicalName,N=e.ParentEntityReferencingAttribute,C=e.IsValidForAdvancedFind,P=e.IsMailMergeEnabled,R=e.IsConnectionsEnabled,w=e.IsCustomizable,M=e.IsActivityParty,I=e.IsImportable,A=e.IsEnabledForCharts,D=e.IsCustomEntity,L=e.IsStateModelAware,U=e.EnforceStateTransitions,F=e.IsValidForQueue,x=e.ActivityTypeMask,k=e.OwnershipType,j=e.IsBusinessProcessEnabled,q=e.IsDocumentManagementEnabled,B=e.IsOneNoteIntegrationEnabled,$=e.IsMSTeamsIntegrationEnabled,V=e.EntityColor,H=e.IsInteractionCentricEnabled,G=e.IsQuickCreateEnabled,Q=e.entityClientSetting,X=e.IsKnowledgeManagementEnabled,W=e.IsDocumentManagementEnabled,z=e.IsBPFEntity,Y=e.OneToManyRelationships,K=e.ManyToOneRelationships,J=e.ManyToManyRelationships,Z=p.getLabelString(e.DisplayCollectionName),ee=p.getLabelString(e.Description),te=Object(u.isNullOrUndefinedOrEmptyString)(e.DataProviderId)?c.LegacyGuid.get_empty():c.LegacyGuid.tryCreate(e.DataProviderId);let re=-1,ne=-1;e.VersionNumber&&(re=e.VersionNumber),e.OverallVersionNumber&&(ne=e.OverallVersionNumber);let ae=!1;const ie=e.AttributeNames;for(let e=0;e<ie.length;e++)if("statecode"===ie[e]){ae=!0;break}const oe=e.IsIntersect,se=e.Privileges.map(e=>d.createFromOData(e)),ue=new p(t,r,n,a,i,o,m,h,se,g,E,b,O,v,_,T,S,N,C,P,R,w,M,I,A,D,L,U,F,x,k,!1,ae,j,q,B,$,!1,V,H,G,Q,X,W,oe,!1,!1,s,z,re,ne,ie);return ue._primaryKeyName=l,ue._autoRouteToOwnerQueue=f,ue._canTriggerWorkflow=y,ue._displayCollectionName=Z,ue._description=ee,ue._dataProviderId=te,ue._oneToManyRelationships=Y,ue._manyToOneRelationships=K,ue._manyToManyRelationships=J,ue}get_attributeNames(){return this._attributeNames}get_id(){return this._id}get_logicalName(){return this._logicalName}get_displayName(){return this._displayName}set_entitySetName(e){return this._entitySetName=e,e}get_objectTypeCode(){return this._objectTypeCode}get_primaryIdAttribute(){return this._primaryIdAttribute}get_primaryNameAttribute(){return this._primaryNameAttribute}get_isOptimisticConcurrencyEnabled(){return this._isOptimisticConcurrencyEnabled}get_isActivity(){switch(this._logicalName){case"phonecall":case"email":case"task":case"appointment":case"activitypointer":return!0;default:return this._isActivity}}get_isChildEntity(){return this._isChildEntity}get_parentEntityLogicalName(){return this._parentEntityLogicalName}get_parentEntityReferencingAttribute(){return this._parentEntityReferencingAttribute}get_isCustomEntity(){return this._isCustomEntity}get_activityTypeMask(){return this._activityTypeMask}get_ownershipType(){return this._ownershipType}get_hasSecuredAttributes(){return this._hasSecuredAttributes}get_hasStateCode(){return this._hasStateCode}get_isBusinessProcessEnabled(){return this._isBusinessProcessEnabled}get_isIntersect(){return this._isIntersect}get_usesBusinessDataLabelTable(){return this._usesBusinessDataLabelTable}get_isBPFEntity(){return this._isBPFEntity}getEntityCanBeUsedInBusinessProcess(){return this._isBusinessProcessEnabled||this._isBPFEntity}getODataObject(){const e={},t=this._id.toString();e.Id=t,e.MetadataId=t,e.LogicalName=this._logicalName,e.DisplayName=p.convertToLabel(this._displayName),e.EntitySetName=this._entitySetName,e.ObjectTypeCode=this._objectTypeCode,e.PrimaryKeyName=this._primaryKeyName,e.AutoRouteToOwnerQueue=this._autoRouteToOwnerQueue,e.CanTriggerWorkflow=this._canTriggerWorkflow,e.Description=p.convertToLabel(this._description),e.DisplayCollectionName=p.convertToLabel(this._displayCollectionName),e.PrimaryIdAttribute=this._primaryIdAttribute,e.PrimaryNameAttribute=this._primaryNameAttribute,e.PrimaryImageAttribute=this._primaryImageAttribute,e.IsReadOnlyInMobileClient=this._isReadOnlyForMobileClient,e.IsVisibleInMobileClient=this._isVisibleInMobileClient,e.IsOfflineInMobileClient=this._isOfflineInMobileClient,e.IsOptimisticConcurrencyEnabled=this._isOptimisticConcurrencyEnabled,e.HasChanged=this._hasChanged,e.IsActivity=this._isActivity,e.IsChildEntity=this._isChildEntity,e.ParentEntityLogicalName=this._parentEntityLogicalName,e.ParentEntityReferencingAttribute=this._parentEntityReferencingAttribute,e.IsValidForAdvancedFind=this._isValidForAdvancedFind,e.IsMailMergeEnabled=this._isMailMergeEnabled,e.IsConnectionsEnabled=this._isConnectionsEnabled,e.IsCustomizable=this._isCustomizable,e.IsActivityParty=this._isActivityParty,e.IsImportable=this._isImportable,e.IsEnabledForCharts=this._isEnabledForCharts,e.IsCustomEntity=this._isCustomEntity,e.IsStateModelAware=this._isStateModelAware,e.EnforceStateTransitions=this._enforceStateTransitions,e.IsValidForQueue=this._isCollaboration,e.ActivityTypeMask=this._activityTypeMask,e.OwnershipType=this._ownershipType,e.HasStateCode=this._hasStateCode,e.IsBusinessProcessEnabled=this._isBusinessProcessEnabled,e.IsDocumentManagementEnabled=this._isDocumentManagementEnabled,e.EntityColor=this._entityColor,e.IsInteractionCentricEnabled=this._isInteractionCentricEnabled,e.isQuickCreateEnabled=this._isQuickCreateEnabled,e.entityClientSetting=this._entityClientSetting,e.IsKnowledgeManagementEnabled=this._isKnowledgeManagementEnabled,e.OneToManyRelationships=this._oneToManyRelationships,e.ManyToOneRelationships=this._manyToOneRelationships,e.ManyToManyRelationships=this._manyToManyRelationships,e.IconVectorName=this._iconVectorName,e.IsBPFEntity=this._isBPFEntity,e.DataProviderId=this._dataProviderId?this._dataProviderId.toString():"",e.IsDocumentRecommendationsEnabled=this._isDocumentRecommendationsEnabled,e.IsIntersect=this._isIntersect,e.IsMSTeamsIntegrationEnabled=this._isMSTeamsIntegrationEnabled,e.VersionNumber=this._versionNumber,e.OverallVersionNumber=this._overallVersionNumber,e.AttributeNames=this._attributeNames,e.Privileges=[];for(const t in this._privilegesByType)this._privilegesByType.hasOwnProperty(t)&&e.Privileges.push(this._privilegesByType[t].getODataObject());return e}getObjectData(){const e={};e[p._idPath]=this._id.getObjectData(),e[p.logicalNamePath]=this._logicalName,e.displayname=this._displayName,e.entitysetname=this._entitySetName,e.objecttypecode=this._objectTypeCode,e.primaryidattribute=this._primaryIdAttribute,e.primarykeyname=this._primaryKeyName,e.displayCollectionName=this._displayCollectionName,e.autoRouteToOwnerQueue=this._autoRouteToOwnerQueue,e.canTriggerWorkflow=this._canTriggerWorkflow,e.primarynameattribute=this._primaryNameAttribute,e.primaryimageattribute=this._primaryImageAttribute,e.description=this._description,e.oneToManyRelationships=this._oneToManyRelationships,e.manyToOneRelationships=this._manyToOneRelationships,e.manyToManyRelationships=this._manyToManyRelationships,e.isreadonlyformobileclient=this._isReadOnlyForMobileClient,e.isvisibleinmobileclient=this._isVisibleInMobileClient,e.isofflineinmobileclient=this._isOfflineInMobileClient,e.isoptimisticconcurrencyenabled=this._isOptimisticConcurrencyEnabled,e.haschanged=this._hasChanged,e.isactivity=this._isActivity,e.ischildentity=this._isChildEntity,e.parententitylogicalname=this._parentEntityLogicalName,e.parententityreferencingattribute=this._parentEntityReferencingAttribute,e.isvalidforadvancedfind=this._isValidForAdvancedFind,e.ismailmergeenabled=this._isMailMergeEnabled,e.isconnectionsenabled=this._isConnectionsEnabled,e.iscustomizable=this._isCustomizable,e.isactivityparty=this._isActivityParty,e.isimportable=this._isImportable,e.isenabledforcharts=this._isEnabledForCharts,e.iscustomentity=this._isCustomEntity,e.isstatemodelaware=this._isStateModelAware,e.enforcestatetransitions=this._enforceStateTransitions,e.iscollaboration=this._isCollaboration,e.activitytypemask=this._activityTypeMask,e.ownershiptype=this._ownershipType,e.hassecuredattributes=this._hasSecuredAttributes,e.hasstatecode=this._hasStateCode,e.isbusinessprocessenabled=this._isBusinessProcessEnabled,e.isdocumentmanagementenabled=this._isDocumentManagementEnabled,e.isonenoteintegrationenabled=this._isOneNoteIntegrationEnabled,e.ismsteamsintegrationenabled=this._isMSTeamsIntegrationEnabled,e.hasactivities=this._hasActivities,e.entitycolor=this._entityColor,e.isinteractioncentricenabled=this._isInteractionCentricEnabled,e.isQuickCreateEnabled=this._isQuickCreateEnabled,e.entityClientSetting=this._entityClientSetting,e.isKnowledgeManagementEnabled=this._isKnowledgeManagementEnabled,e.isDocumentRecommendationsEnabled=this._isDocumentRecommendationsEnabled,e.isIntersect=this._isIntersect,e.hasnotes=this._hasNotes,e.iconVectorName=this._iconVectorName,e.usesBusinessDataLabelTable=this._usesBusinessDataLabelTable,e.isbpfentity=this._isBPFEntity,e.dataProviderId=this._dataProviderId?this._dataProviderId.toString():"",e.VersionNumber=this._versionNumber,e.OverallVersionNumber=this._overallVersionNumber,e.AttributeNames=this._attributeNames;const t=[],r=this._privilegesByType;for(const e in r)if(r.hasOwnProperty(e)){const n={key:e,value:r[e]};t.push(n.value.getObjectData())}return e.privileges=t,e}}function f(e){switch(e){case n.Boolean:return l.AttributeType.Boolean;case n.Customer:return l.AttributeType.Customer;case n.DateTime:return l.AttributeType.DateTime;case n.Decimal:return l.AttributeType.Decimal;case n.Double:return l.AttributeType.Double;case n.Integer:return l.AttributeType.Integer;case n.Lookup:return l.AttributeType.Lookup;case n.Memo:return l.AttributeType.Memo;case n.Money:return l.AttributeType.Money;case n.Owner:return l.AttributeType.Owner;case n.PartyList:return l.AttributeType.PartyList;case n.Picklist:return l.AttributeType.PickList;case n.State:return l.AttributeType.State;case n.Status:return l.AttributeType.Status;case n.String:return l.AttributeType.String;case n.UniqueIdentifier:return l.AttributeType.UniqueIdentifier;case n.CalendarRules:return l.AttributeType.CalendarRules;case n.Virtual:return l.AttributeType.Virtual;case n.BigInt:return l.AttributeType.BigInt;case n.ManagedProperty:return l.AttributeType.ManagedProperty;case n.EntityName:return l.AttributeType.EntityName;case n.AliasedValue:return l.AttributeType.AliasedValue;case n.EntityImage:return l.AttributeType.EntityImage;case n.MultiSelectPicklist:return l.AttributeType.MultiSelectPickList;case n.File:return l.AttributeType.File;case n.NavigationProperty:return l.AttributeType.NavigationProperty;default:return l.AttributeType.Unknown}}function y(e){switch(e){case l.AttributeType.Boolean:return n.Boolean;case l.AttributeType.Customer:return n.Customer;case l.AttributeType.DateTime:return n.DateTime;case l.AttributeType.Decimal:return n.Decimal;case l.AttributeType.Double:return n.Double;case l.AttributeType.Integer:return n.Integer;case l.AttributeType.Lookup:return n.Lookup;case l.AttributeType.Memo:return n.Memo;case l.AttributeType.Money:return n.Money;case l.AttributeType.Owner:return n.Owner;case l.AttributeType.PartyList:return n.PartyList;case l.AttributeType.PickList:return n.Picklist;case l.AttributeType.State:return n.State;case l.AttributeType.Status:return n.Status;case l.AttributeType.String:return n.String;case l.AttributeType.UniqueIdentifier:return n.UniqueIdentifier;case l.AttributeType.CalendarRules:return n.CalendarRules;case l.AttributeType.Virtual:return n.Virtual;case l.AttributeType.BigInt:return n.BigInt;case l.AttributeType.ManagedProperty:return n.ManagedProperty;case l.AttributeType.EntityName:return n.EntityName;case l.AttributeType.AliasedValue:return n.AliasedValue;case l.AttributeType.EntityImage:return n.EntityImage;case l.AttributeType.MultiSelectPickList:return n.MultiSelectPicklist;case l.AttributeType.File:return n.File;case l.AttributeType.NavigationProperty:return n.NavigationProperty;default:return n.Unknown}}p.logicalNamePath="logicalname",p._idPath="id",function(e){e[e.Unknown=-1]="Unknown",e[e.Boolean=0]="Boolean",e[e.Customer=1]="Customer",e[e.DateTime=2]="DateTime",e[e.Decimal=3]="Decimal",e[e.Double=4]="Double",e[e.Integer=5]="Integer",e[e.Lookup=6]="Lookup",e[e.Memo=7]="Memo",e[e.Money=8]="Money",e[e.Owner=9]="Owner",e[e.PartyList=10]="PartyList",e[e.Picklist=11]="Picklist",e[e.State=12]="State",e[e.Status=13]="Status",e[e.String=14]="String",e[e.UniqueIdentifier=15]="UniqueIdentifier",e[e.CalendarRules=16]="CalendarRules",e[e.Virtual=17]="Virtual",e[e.BigInt=18]="BigInt",e[e.ManagedProperty=19]="ManagedProperty",e[e.EntityName=20]="EntityName",e[e.AliasedValue=21]="AliasedValue",e[e.EntityImage=23]="EntityImage",e[e.MultiSelectPicklist=24]="MultiSelectPicklist",e[e.File=25]="File",e[e.NavigationProperty=26]="NavigationProperty"}(n||(n={}));var m=r("juXS");
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */class h{constructor(e){this._optionsInDisplayOrder=e,this._options=h._CreateDictionaryFromOptionsInDisplayOrder(e)}static createFromObjectData(e){const t=e&&e.optionsindisplayorder?e.optionsindisplayorder:{};return new h(Object(u.mapToValues)(t,e=>m.OptionMetadata.createFromObjectData(e)))}static createFromOData(e){const t={};for(let r=0;r<e.length;++r){const n=m.OptionMetadata.createFromOData(e[r]);t[r.toString()]=n}return new h(t)}static _CreateDictionaryFromOptionsInDisplayOrder(e){const t={};for(const r in e)if(e.hasOwnProperty(r)){const n={key:r,value:e[r]}.value;t[n.get_ValueString()]=n}return t}get_options(){return this._options}get_optionsInDisplayOrder(){return this._optionsInDisplayOrder}getObjectData(){return Object(u.isNullOrUndefined)(this._optionsInDisplayOrder)?{}:{optionsindisplayorder:Object(u.mapToValues)(this._optionsInDisplayOrder,e=>e.getObjectData())}}getODataObject(){if(Object(u.isNullOrUndefined)(this.get_optionsInDisplayOrder()))return{};const e={},t=[],r=this.get_optionsInDisplayOrder();for(const e in r)if(r.hasOwnProperty(e)){const n={key:e,value:r[e]};t.push(n.value.getODataObject())}return e.Options=t,e}}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */class g{constructor(e,t,r,n,a,i,o,s,c,d,p,f,y,m,h,g,E,b,O,v,_,T,S,N,C,P,R,w,M,I,A){this._type=l.AttributeType.Boolean,this._sourceType=0,this._formatName="",this._attributeTypeName="",this._description="",this._columnNumber=0,this._sourceTypeMask=0,this._isSecured=!1,this._isValidForCreate=!1,this._isValidForRead=!1,this._isValidForUpdate=!1,this._requiredLevel=0,this._maxLength=0,this._minValue=0,this._maxValue=0,this._precision=0,this._precisionSource=0,this._behavior=0,this._defaultFormValue=0,this._defaultValue=!1,this._isBaseCurrency=!1,this._hasChanged=!1,this._isSortableEnabled=!1,this._imeMode=0,this._isLocalizable=!1,this._isCustomAttribute=!1,Object(u.throwOnNullOrUndefinedArgument)(e,"logicalName"),Object(u.throwOnNullOrUndefinedArgument)(t,"id"),Object(u.throwOnNullOrUndefinedArgument)(n,"type"),Object(u.throwOnNullOrUndefinedArgument)(d,"requiredLevel"),Object(u.throwOnNullOrUndefinedArgument)(i,"isSecured"),Object(u.throwOnNullOrUndefinedArgument)(o,"isValidForCreate"),Object(u.throwOnNullOrUndefinedArgument)(s,"isValidForRead"),Object(u.throwOnNullOrUndefinedArgument)(c,"isValidForUpdate"),this._logicalName=e,this._id=t,this._entityLogicalName=r,this._type=n,this._sourceType=w||0,this._displayName=a,this._isSecured=i,this._isValidForCreate=o,this._isValidForRead=s,this._isValidForUpdate=c,this._requiredLevel=d,this._maxLength=p,this._minValue=f,this._maxValue=y,this._precision=m,this._precisionSource=h,this._format=g,this._behavior=E,this._defaultFormValue=b,this._defaultValue=O,this._optionSet=v,this._targets=T,this._isBaseCurrency=_,this._attributeOf=S,this._hasChanged=N,this._isSortableEnabled=P||!1,this._imeMode=C||0,this._inheritsFrom=R||"",this._isLocalizable=M||!1,this._isCustomAttribute=I||!1,this._columnNumber=A||0}static extractKey(e){return c.LegacyGuid.createFromObjectData(e.id).toString()}static addValueWrapper(e){const t={};return t.Value=e,t}static removeValueWrapper(e){return e?e.Value:null}static createFromObjectData(e){if(!Object(u.isNullOrUndefinedOrEmptyString)(e.MetadataId)){e=g.createFromODataResponse(e).getObjectData()}const t=new g(e.logicalname,c.LegacyGuid.createFromObjectData(e.id),e.entitylogicalname,f(e.type),e.displayname,e.issecured,e.isvalidforcreate,e.isvalidforread,e.isvalidforupdate,e.requiredlevel,e.maxlength,e.minvalue,e.maxvalue,e.precision,e.precisionsource,e.format,e.behavior,e.defaultformvalue,e.defaultvalue,h.createFromObjectData(e.optionset),e.isbasecurrency,e.targets,e.attributeof,e.haschanged,e.imemode,e.issortableenabled,e.inheritsfrom,e.sourcetype,e.islocalizable,e.IsCustomAttribute,e.columnNumber);return t._formatName=e.formatName,t._description=e.description,t._sourceTypeMask=e.sourceTypeMask,t._attributeTypeName=e.attributeTypeName,t}static createFromODataResponse(e){const t=e.LogicalName,r=c.LegacyGuid.tryCreate(e.MetadataId),n=e.EntityLogicalName,a=f(e.AttributeType);let i=g.removeValueWrapper(e.AttributeTypeName);const o=new RegExp("Type","g");if(Object(u.isNullOrUndefinedOrEmptyString)(i))throw new Error(`Null or empty attribute type name in attribute metadata for entity ${n} attribute type ${a}`);i=i.replace(o,"").toLowerCase(),"float"===i&&(i="double");const s=e.SourceType,l=p.getLabelString(e.Description),d=p.getLabelString(e.DisplayName),y=g.removeValueWrapper(e.RequiredLevel);let m;m="string"==typeof y?Object(u.loadRequiredLevelFromCrmSoap)(y):y;const E=e.IsSecured,b=e.IsValidForCreate,O=e.IsValidForUpdate,v=e.IsValidForRead,_=e.ColumnNumber,T=e.SourceTypeMask,S=e.MaxLength,N=e.MinValue,C=e.MaxValue,P=e.Precision,R=e.PrecisionSource,w=e.Format;let M=null;Object(u.isNullOrUndefined)(w)||(M=w.toString());const I=g.removeValueWrapper(e.FormatName),A=g.removeValueWrapper(e.DateTimeBehavior);let D=0;Object(u.isNullOrUndefined)(A)||(D=Object(u.loadBehaviorFromCrmSoap)(A));const L=e.DefaultFormValue,U=e.DefaultValue,F=e.IsBaseCurrency,x=e.AttributeOf,k=e.HasChanged,j=g.removeValueWrapper(e.IsSortableEnabled),q=e.ImeMode,B=e.InheritsFrom,$=e.IsLocalizable,V=e.IsCustomAttribute;let H=null;const G=e.OptionSet;if(!Object(u.isNullOrUndefined)(G)){const e=G.Options;if(Object(u.isNullOrUndefined)(e)){const e=G.TrueOption,t=[G.FalseOption,e];H=h.createFromOData(t)}else H=h.createFromOData(e)}const Q=e.Targets,X=new g(t,r,n,a,d,E,b,v,O,m,S,N,C,P,R,M,D,L,U,H,F,Q,x,k,q,j,B,s,$,V,_);return X._formatName=I,X._description=l,X._sourceTypeMask=T,X._attributeTypeName=i,X}get_id(){return this._id}get_logicalName(){return this._logicalName}get_entityLogicalName(){return this._entityLogicalName}get_type(){return this._type}get_sourceType(){return this._sourceType}get_displayName(){return this._displayName}get_isValidForCreate(){return this._isValidForCreate}get_isSecured(){return this._isSecured}get_isValidForUpdate(){return this._isValidForUpdate}get_isValidForRead(){return this._isValidForRead}get_requiredLevel(){return this._requiredLevel}get_maxLength(){return this._maxLength}get_minValue(){return this._minValue}get_maxValue(){return this._maxValue}get_precision(){return this._precision}get_precisionSource(){return this._precisionSource}get_format(){return this._format}get_formatName(){return this._formatName}get_behavior(){return this._behavior}get_isBaseCurrency(){return this._isBaseCurrency}get_defaultFormValue(){return this._defaultFormValue}get_defaultValue(){return this._defaultValue}get_optionSet(){return this._optionSet}get_targets(){return this._targets}get_attributeOf(){return this._attributeOf}get_hasChanged(){return this._hasChanged}get_isSortableEnabled(){return this._isSortableEnabled}get_imeMode(){return this._imeMode}get_inheritsFrom(){return this._inheritsFrom}get_isLocalizable(){return this._isLocalizable}get_isCustomAttribute(){return this._isCustomAttribute}get_columnNumber(){return this._columnNumber}getObjectData(){return{[g.logicalNamePath]:this._logicalName,id:this._id.getObjectData(),[g.entityLogicalNamePath]:this._entityLogicalName,[g.entityAttributeLogicalNamesPath]:this._entityLogicalName+u.COMPOSITE_INDEX_DELIMITER+this._logicalName,type:y(this._type),sourcetype:this._sourceType,displayname:this._displayName,issecured:this._isSecured,issortableenabled:this._isSortableEnabled,isvalidforcreate:this._isValidForCreate,isvalidforupdate:this._isValidForUpdate,isvalidforread:this._isValidForRead,requiredlevel:this._requiredLevel,maxlength:this._maxLength,minvalue:this._minValue,maxvalue:this._maxValue,precision:this._precision,precisionsource:this._precisionSource,defaultformvalue:this._defaultFormValue,defaultvalue:this._defaultValue,format:this._format,behavior:this._behavior,isbasecurrency:this._isBaseCurrency,attributeof:this._attributeOf,haschanged:this._hasChanged,imemode:this._imeMode,inheritsfrom:this._inheritsFrom,islocalizable:this._isLocalizable,formatName:this._formatName,description:this._description,columnNumber:this._columnNumber,sourceTypeMask:this._sourceTypeMask,attributeTypeName:this._attributeTypeName,IsCustomAttribute:this._isCustomAttribute,optionset:Object(u.isNullOrUndefined)(this._optionSet)?void 0:this._optionSet.getObjectData(),targets:Object(u.isNullOrUndefined)(this._targets)?void 0:this._targets}}getODataObject(){return{LogicalName:this._logicalName,MetadataId:this._id.toString(),EntityLogicalName:this._entityLogicalName,EntityAttributeLogicalNames:this._entityLogicalName+u.COMPOSITE_INDEX_DELIMITER+this._logicalName,AttributeType:y(this._type),AttributeTypeName:g.addValueWrapper(("double"===this._attributeTypeName?"Float":this._attributeTypeName)+"Type"),Description:p.convertToLabel(this._description),ColumnNumber:this._columnNumber,FormatName:g.addValueWrapper(this._formatName),SourceTypeMask:this._sourceTypeMask,OptionSet:!Object(u.isNullOrUndefined)(this._optionSet)&&this._optionSet.getODataObject(),SourceType:this._sourceType,DisplayName:p.convertToLabel(this._displayName),IsSecured:this._isSecured,IsSortableEnabled:g.addValueWrapper(this._isSortableEnabled),IsValidForCreate:this._isValidForCreate,IsValidForUpdate:this._isValidForUpdate,IsValidForRead:this._isValidForRead,RequiredLevel:g.addValueWrapper(this._requiredLevel),MaxLength:this._maxLength,MinValue:this._minValue,MaxValue:this._maxValue,Precision:this._precision,PrecisionSource:this._precisionSource,DefaultFormValue:this._defaultFormValue,DefaultValue:this._defaultValue,Format:!Object(u.isNullOrUndefined)(this._format)&&parseInt(this._format,10),DateTimeBehavior:g.addValueWrapper(Object(u.behaviorToCrmSoap)(this._behavior)),IsBaseCurrency:this._isBaseCurrency,AttributeOf:this._attributeOf,HasChanged:this._hasChanged,ImeMode:this._imeMode,InheritsFrom:this._inheritsFrom,IsLocalizable:this._isLocalizable,IsCustomAttribute:this._isCustomAttribute,Targets:!Object(u.isNullOrUndefined)(this._targets)&&this._targets}}}g.entityLogicalNamePath="entitylogicalname",g.logicalNamePath="logicalname",g.entityAttributeLogicalNamesPath="entitylogicalname_logicalname";var E=r("fnSt"),b=r("dJUv"),O=r("Ln9p"),v=r("d61F");
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
function _(e,t,r){return r}function T(e,t,r){return e&&t&&Object(u.isNullOrUndefined)(r)?a.AssociatedMenuBehavior.DoNotDisplay:r}function S(e,t,r){return e&&t&&Object(u.isNullOrUndefined)(r)?a.AssociatedMenuGroup.Details:r}function N(e,t,r){return e&&t&&Object(u.isNullOrUndefined)(r)?"":r}function C(e,t,r){return e&&t&&Object(u.isNullOrUndefined)(r)?a.CascadeType.NoCascade:r}function P(e,t,r){return!!(e&&t&&Object(u.isNullOrUndefined)(r.IsManaged))||r.IsManaged}function R(e,t,r,n){return e&&t&&Object(u.isNullOrUndefined)(r.ReferencedEntity)?n.LogicalName:r.ReferencedEntity}function w(e,t,r,n){return e&&t&&Object(u.isNullOrUndefined)(r.ReferencingEntity)?n.LogicalName:r.ReferencingEntity}function M(e,t,r){return e&&t&&Object(u.isNullOrUndefined)(r.ReferencingEntityNavigationPropertyName)?r.ReferencingAttribute:r.ReferencingEntityNavigationPropertyName}function I(e,t,r){return!(e&&t&&Object(u.isNullOrUndefined)(r))&&r}function A(e,t,r){var n;return r&&r.UserLocalizedLabel?e&&t&&Object(u.isNullOrUndefined)(r.UserLocalizedLabel.Label)?"":null!==(n=r.UserLocalizedLabel.Label)&&void 0!==n?n:null:null}function D(e,t,r){return e&&t&&Object(u.isNullOrUndefined)(r)?a.OptionSetType.Picklist:r}function L(e){return e&&e.AdditionalParameters&&e.AdditionalParameters.isEntityPayloadReductionRequested}function U(e){return e&&e.AdditionalParameters&&e.AdditionalParameters.isSecondPhasePayloadReductionEnabled}var F=r("hER9"),x=r("jkZo"),k=r("ZXCs"),j=r("zjpj"),q=r("Szbx"),B=r("lSoY"),$=r("PUb4");
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
const V={views:{},entities:{},attributes:{},userContext:{}};async function H(e,t,r=[]){let n;const a=performance.now(),s=e.TraceManager.getTracer(i.COMPONENT_NAMES.MetadataCache);if(n=k.c(e,t,r),Object(u.isNullOrUndefinedOrEmptyString)(n)){let a=V.entities;if(n=Object(j.c)(a,t,s,r),Object(u.isNullOrUndefined)(n)&&(a=await re(e,s,r),n=Object(j.c)(a,t,s,r),Object(u.isNullOrUndefined)(n))){const e=`Entity with entity set name ${t} not found in offline metadata`;return s.error(`${De()} ${e}`,Object(v.b)(r,r)),Promise.reject(new o.a(e,F.ErrorCode.QueryBuilderNoEntity))}}return $e("getEntityLogicalName",a,e,r),n}async function G(e,t,r=[]){const n=performance.now(),a=e.TraceManager.getTracer(i.COMPONENT_NAMES.MetadataCache);let s=k.d(e,t,r);if(Object(u.isNullOrUndefinedOrEmptyString)(s)){let n=V.entities;if(s=Object(j.d)(n,t,a,r),Object(u.isNullOrUndefined)(s)&&(n=await re(e,a,r),s=Object(j.d)(n,t,a,r),Object(u.isNullOrUndefined)(s))){const e=`Entity with object type code ${t} not found in offline metadata`;return a.error(`${De()} ${e}`,Object(v.b)(r,r)),Promise.reject(new o.a(e,F.ErrorCode.QueryBuilderNoEntity))}}return $e("getEntityLogicalNameFromOtc",n,e,r),s}async function Q(e,t,r,n=[]){const a=performance.now(),o=e.TraceManager.getTracer(i.COMPONENT_NAMES.MetadataCache);let s={};const l=await k.a(e,t,r,n);if(null!==l)s=l;else{const a=await ne(e,r,t,n);if(Object(u.isNullOrUndefined)(a))o.error(De()+" Retrieved null or undefined attribute metadata",n);else if(a&&Object.keys(a).length>0)if(t.length>0){for(const e of t)if(a[e]){const t=a[e];s[e]=t.Type}}else{const e=Object.keys(a);for(const t of e)if(a[t]){const e=a[t];s[t]=e.Type}}}return $e("getAttributeTypes",a,e,n),s}async function X(e,t=[]){let r;const n=performance.now();try{const n=await k.l(e,t);if(null!==n)r=n;else{if(!V.userContext||!V.userContext.userSettings||!V.userContext.userSettings.languageid||Object(u.isNullOrUndefined)(V.userContext.userSettings.timezoneutcoffsetminutes)||Object(u.isNullOrUndefined)(V.userContext.userSettings.timezoneadjusters)||Object(u.isNullOrUndefined)(V.userContext.userSettings.datetimeformatinfo))return async function(e,t=[]){if(await Re(e,t),V.userContext&&V.userContext.userSettings&&V.userContext.userSettings.languageid&&!Object(u.isNullOrUndefined)(V.userContext.userSettings.timezoneutcoffsetminutes)&&!Object(u.isNullOrUndefined)(V.userContext.userSettings.timezoneadjusters)&&!Object(u.isNullOrUndefined)(V.userContext.userSettings.datetimeformatinfo))return V.userContext.userSettings;{const e="UserSettings is empty or does not contains all required dependencies";return Promise.reject(new o.a(e))}}(e,t);r=V.userContext.userSettings}}catch(e){return Promise.reject(e)}return $e("getUserSettings",n,e,t),r}async function W(e,t=[]){let r;const n=performance.now();try{const n=await k.i(e,t);r=n||(V.userContext&&V.userContext.organizationSettings&&V.userContext.organizationSettings.fullnameconventioncode&&V.userContext.organizationSettings.languageCode?V.userContext.organizationSettings:await async function(e,t=[]){if(await Re(e,t),Object(u.isNullOrUndefined)(V.userContext.organizationSettings)||Object(u.isNullOrUndefined)(V.userContext.organizationSettings.fullnameconventioncode)||Object(u.isNullOrUndefined)(V.userContext.organizationSettings.languageCode)){const e="OrganizationSettings is empty or does not contains all required dependencies";return Promise.reject(new o.a(e))}return V.userContext.organizationSettings}(e,t))}catch(e){return Promise.reject(e)}return $e("getOrganizationSettings",n,e,t),r}async function z(e,t=[]){let r;const n=performance.now();try{const n=await k.f(e,t);r=n||(V.userContext&&V.userContext.organizationSettings&&V.userContext.organizationSettings.fullnameconventioncode?V.userContext.organizationSettings.fullnameconventioncode:await async function(e,t=[]){if(await Re(e,t),Object(u.isNullOrUndefined)(V.userContext.organizationSettings)||Object(u.isNullOrUndefined)(V.userContext.organizationSettings.fullnameconventioncode)){const e="fullnameconventioncode is empty";return Promise.reject(new o.a(e))}return V.userContext.organizationSettings.fullnameconventioncode}(e,t))}catch(e){return Promise.reject(e)}return $e("getfullnameconventioncode",n,e,t),r}async function Y(e,t=[]){let r;const n=performance.now();try{const n=await k.g(e,t);r=n||(V.userContext&&V.userContext.organizationSettings&&V.userContext.organizationSettings.languageCode?V.userContext.organizationSettings.languageCode:await async function(e,t=[]){if(await Re(e,t),Object(u.isNullOrUndefined)(V.userContext.organizationSettings)||Object(u.isNullOrUndefined)(V.userContext.organizationSettings.languageCode)){const e="languageCode is empty";return Promise.reject(new o.a(e))}return V.userContext.organizationSettings.languageCode}(e,t))}catch(e){return Promise.reject(e)}return $e("getLanguageCode",n,e,t),r}async function K(e,t=[]){let r;const n=performance.now();try{const n=await k.j(e,t);r=n?O.Guid.toString(n):V.userContext&&V.userContext.userid?O.Guid.toString(V.userContext.userid):await async function(e,t=[]){if(await Re(e,t),Object(u.isNullOrUndefined)(V.userContext.userid)){const e="userid is empty";return Promise.reject(new o.a(e))}return O.Guid.toString(V.userContext.userid)}(e,t)}catch(e){return Promise.reject(e)}return $e("getUserId",n,e,t),r}async function J(e,t=[]){let r;const n=performance.now();try{const n=await k.k(e,t);r=n||(V.userContext&&V.userContext.username?V.userContext.username:await async function(e,t=[]){if(await Re(e,t),Object(u.isNullOrUndefined)(V.userContext.username)){const e="username is empty";return Promise.reject(new o.a(e))}return V.userContext.username}(e,t))}catch(e){return Promise.reject(e)}return $e("getUserName",n,e,t),r}async function Z(e,t,r=[]){let n;const a=performance.now(),o=e.TraceManager.getTracer(i.COMPONENT_NAMES.MetadataCache),s=await k.n(e,t,r);if(null!==s)n=s;else if(V.userContext&&V.userContext.fcbContext&&!Object(u.isNullOrUndefined)(V.userContext.fcbContext[t])){const e=V.userContext.fcbContext[t];n=void 0===e.value?e:e.value}else n=await async function(e,t,r=[]){if(await Re(e,r),Object(u.isNullOrUndefined)(V.userContext.fcbContext)||Object(u.isNullOrUndefined)(V.userContext.fcbContext[t]))return!1;{const e=V.userContext.fcbContext[t];return void 0===e.value?e:e.value}}(e,t,r);return o.info(`${De()} The fcbContext for ${t} return ${n} value.`),$e("isFeatureEnabled",a,e,r),n}async function ee(e,t,r,n=[]){let a;const i=performance.now();try{const i=await k.m(e,t,r,n);a=i||(V.views&&V.views[t]?V.views[t]:await async function(e,t,r=[]){const n=await async function(e,t,r=[]){const n=await we(e,t,r),a=n&&n.length&&n[0].rows&&n[0].rows.item(0);if(!a){throw new Error("requested view metadata not found, ViewId = "+t)}const i=JSON.parse(a.json);return i.data}(e,t,r),a={viewId:new O.Guid(n.ViewId),fetchXML:n.FetchXml,entityLogicalName:n.EntityLogicalName,queryApi:n.QueryApi,columnXML:n.ColumnXml,title:n.Title,idColumName:n.IdColumnName,queryType:n.QueryType,layoutXML:n.LayoutXml,offlineSqlQuery:n.OfflineSqlQuery?n.OfflineSqlQuery:null,versionNumber:n.VersionNumber,OverallVersionNumber:n.OverallVersionNumber,OverallUserVersionNumber:n.OverallUserVersionNumber,isUserView:n.IsUserView};return V.views=Object.assign({},V.views,{[t]:a}),a}(e,t,n))}catch(e){return Promise.reject(e)}return $e("getViewMetadata",i,e,n),a}async function te(e,t,r=[]){let n;const a=performance.now();if(Object(u.isNullOrUndefinedOrEmpty)(e)||Object(u.isNullOrUndefinedOrEmptyString)(t))throw new o.a("Invalid parameters",F.ErrorCode.UnknownBadRequestError);r.push({name:"entity",value:t});try{const a=await k.e(e,t,r);if(a)n=a;else if(V.entities&&V.entities[t])n=V.entities[t];else{if(n=await async function(e,t,r=[]){const n=await async function(e,t,r=[]){const n=null==e?void 0:e.TraceManager.getTracer(i.COMPONENT_NAMES.MetadataCache),a=await Me(e,t,r);if(!a||!a.length){throw new Error("requested entity metadata not found for entity = "+t)}let o;if(a[0].rows&&a[0].rows.length>0){const e=a[0].rows.item(0),t=JSON.parse(e.json);o=p.createFromObjectData(t).getODataObject()}else n.warn(`${De()} Got 0 result rows for entity metadata ${t}`,r);return o}(e,t,r);let a;n&&(a=await ye(e,n,t));return a}(e,t,r),!V.entities||!V.entities[t]){const e="Entity metadata is not available";return Promise.reject(new o.a(e,F.ErrorCode.QueryBuilderNoEntity))}n=V.entities[t]}}catch(e){return Promise.reject(e)}return $e("entityMetadata",a,e,r),n}async function re(e,t,r=[]){var n,a;const i=await async function(e,t=[]){const r="select logicalname from entitymetadata",n=[],a=await Object(s.b)(e,r,n,t);if(!a||!a.length){throw new Error("requested  metadata not found for entity")}return a[0].rows}(e,r),l=[];let c=0;const d={sqlStatements:[],sqlParameters:new Array,additionalParameters:{}};if(!Object(u.isNullOrUndefined)(i)&&i.length>0){for(c=0;c<i.length;c++){const e=[i.item(c).logicalname];d.sqlStatements.push("SELECT id, json FROM [entitymetadata] WHERE [logicalname] = ?"),d.sqlParameters.push(e)}l.push({name:"MetadataRequestedForEntityNames",value:d.sqlParameters.toString()}),l.push({name:"NoOfEntityMetadataRequested",value:d.sqlParameters.length});const o=await Object(s.a)(e,d);if(!o||!o.length){const e="requested entity metadata not found";throw t.error(De()+" requested entity metadata was not returned from offline DB.",Object(v.b)(r,l)),new Error(e)}const f=[],y=[];let m=0;for(c=0;c<o.length;c++){const i=o[c].rows.item(0),s=JSON.parse(i.json),h=p.createFromObjectData(s).getODataObject();if(ye(e,h,h.LogicalName),Object(u.isNullOrUndefined)(h.LogicalName)){m++;const e=null===(a=null===(n=d.sqlParameters)||void 0===n?void 0:n[c])||void 0===a?void 0:a.toString();y.push(e);const i=Object(v.b)(r,l);i.push({name:"ResultIndex",value:c}),i.push({name:"EntityNameRequested",value:e}),i.push({name:"RawDetails",value:h}),t.error(De()+" Entity LogicalName is null for requested metadata at index",i)}else f.push(h.LogicalName)}return l.push({name:"NoOfEntityMetadataReturned",value:o.length}),l.push({name:"MetadataReturnedForEntityNames",value:f.toString()}),l.push({name:"ErroredEntityNames",value:y.toString()}),l.push({name:"NoOfErrors",value:m}),t.warn(De()+" All entity metadata populated.",Object(v.b)(r,l)),V.entities}{const e="No entities returned from entity metadata db when populating all entity metadata";return t.error(`${De()} ${e}`,Object(v.b)(r,l)),Promise.reject(new o.a(e))}}async function ne(e,t,r,n=[]){let a;const o=performance.now();try{const o=await async function(e,t,r,n=[]){let a=[...r];const o=e.TraceManager.getTracer(i.COMPONENT_NAMES.MetadataCache),s=(await te(e,t)).AttributeNames;r&&r.length||(a=s);s&&s.length>0?(s.indexOf("statecode")>=0&&a.indexOf("statecode")<0&&a.push("statecode"),s.indexOf("statuscode")>=0&&a.indexOf("statuscode")<0&&a.push("statuscode")):o.warn(`${De()} No entity attributes are found for entity = ${t},\n      and requested attributes = ${a.join(",")}, return empty list`,n);if(await k.n(e,x.a)){const r=k.b(e,t),n=V.attributes&&V.attributes[t]?V.attributes[t]:{};return Object(j.a)(r,n,a)}const u=V.attributes&&V.attributes[t]?V.attributes[t]:{},l=[];for(let e=0;e<a.length;e++)u[a[e]]||l.push(a[e]);return l}(e,t,r,n),s=await async function(e,t,r,n=[]){const a={};if(r.length){const o=await async function(e,t,r,n=[]){const a=e.TraceManager.getTracer(i.COMPONENT_NAMES.MetadataCache),o=await Ie(e,t,r,n);if(!o||!o.length){const e=`requested attributes metadata not found for entity = ${t}, attributes = ${r.join()}`;throw new Error(e)}if(o.length>1){const e="Results[] returned from getAttributesSqlResults() has length = "+o.length;a.warn(`${De()} ${e}`,n)}const s={},u=o[0];for(let e=0;e<u.rows.length;e++){const t=u.rows.item(e),r=JSON.parse(t.json);try{const e=g.createFromObjectData(r);s[e.get_logicalName()]=e.getODataObject()}catch(e){throw e}}return s}(e,t,r,n);if(o&&Object.keys(o).length>0)for(const t in o)if(o.hasOwnProperty(t)){const r=oe(e,o[t]);a[t]=r}}return a}(e,t,o,n);if(V.attributes[t]=Object.assign({},V.attributes[t],s),a=await k.n(e,x.a)?ae(e,t,r):V.attributes[t],r&&r.length>0){const e={};r.forEach(t=>{e[t]=a[t]}),a=e}}catch(e){return Promise.reject(e)}return $e("getAttributesMetadata",o,e,n),a}function ae(e,t,r){var n,a,o;const s=null===(n=e.TraceManager)||void 0===n?void 0:n.getTracer(i.COMPONENT_NAMES.MetadataCache),u=null===(o=null===(a=e.ApplicationState)||void 0===a?void 0:a.metadata)||void 0===o?void 0:o.attributes,l={},c=[];if(!r||!r.length)return Object.assign({},(null==u?void 0:u[t])?Object(j.b)(u[t]):{},V.attributes[t]?V.attributes[t]:{});if(r.forEach(e=>{u&&u[t]&&u[t][e]&&u[t][e].Initialized===q.a.Initialized?l[e]=u[t][e]:V.attributes&&V.attributes[t]&&V.attributes[t][e]?l[e]=V.attributes[t][e]:c.push(e)}),c.length>=1){const e=[];e.push({name:"MissingAttributesInStateAndMetadataCache",value:c.join(",")}),s.warn(`${De()} Did not find attribute metadata in neither the injected state nor the metadataCache for entity '${t}'. Check event context for the missing attributes.`,e)}return l}async function ie(e,t){var r;let n;const a=performance.now();try{const a=await k.h(e,t);n=a||(V.userContext&&V.userContext.offlineProfile&&V.userContext.offlineProfile.offlineAvailableEntities?null===(r=V.userContext.offlineProfile)||void 0===r?void 0:r.offlineAvailableEntities:await async function(e,t){const r=e.TraceManager.getTracer(i.COMPONENT_NAMES.MetadataCache);return await Re(e,t),Object(u.isNullOrUndefined)(V.userContext)||Object(u.isNullOrUndefined)(V.userContext.offlineProfile)||Object(u.isNullOrUndefined)(V.userContext.offlineProfile.offlineAvailableEntities)?(r.warn(De()+" No offline available entities are found, return empty list",t),[]):V.userContext.offlineProfile.offlineAvailableEntities}(e,t))}catch(e){return Promise.reject(e)}return $e("getOfflineAvailableEntities",a,e,t),n}function oe(e,t){const r=t;let n=E.DateTimeFieldBehavior.None;if(r.DateTimeBehavior)for(const e in r.DateTimeBehavior)if(r.DateTimeBehavior.hasOwnProperty(e))switch(r.DateTimeBehavior[e]){case"None":n=E.DateTimeFieldBehavior.None;break;case"DateOnly":n=E.DateTimeFieldBehavior.DateOnly;break;case"TimeZoneIndependent":n=E.DateTimeFieldBehavior.TimeZoneIndependent;break;case"UserLocal":n=E.DateTimeFieldBehavior.UserLocal;break;default:n=E.DateTimeFieldBehavior.None}const a=L(e),i=U(e);return{LogicalName:t.LogicalName,Id:O.Guid.tryParseOrNull(t.MetadataId),EntityLogicalName:r.EntityLogicalName,Type:pe(t),DisplayName:A(a,i,r.DisplayName),Description:A(a,i,r.Description),IsGlobalFilterEnabled:!!r.IsGlobalFilterEnabled&&r.IsGlobalFilterEnabled.Value,IsSecured:r.IsSecured,IsSortableEnabled:!!r.IsSortableEnabled&&r.IsSortableEnabled.Value,IsEntityReferenceStored:r.IsEntityReferenceStored,IsValidForAdvancedFind:!!r.IsValidForAdvancedFind&&r.IsValidForAdvancedFind.Value,IsValidForCreate:r.IsValidForCreate,IsValidForRead:r.IsValidForRead,IsValidForUpdate:r.IsValidForUpdate,IsRetrievable:_(0,0,r.IsRetrievable),IsCustomAttribute:_(0,0,r.IsCustomAttribute),ColumnNumber:r.ColumnNumber,MaxLength:r.MaxLength,MinValue:r.MinValue,MaxValue:r.MaxValue,Precision:r.Precision,PrecisionSource:r.PrecisionSource,Format:ce(r),Behavior:n,DefaultFormValue:r.DefaultFormValue,DefaultValue:"number"==typeof r.DefaultFormValue?r.DefaultFormValue:_(0,0,r.DefaultValue),IsBaseCurrency:_(0,0,r.IsBaseCurrency),Targets:r.Targets,AttributeOf:r.AttributeOf,HasChanged:_(0,0,r.HasChanged),ImeMode:le(r.ImeMode),OptionSetId:r.OptionSet&&r.OptionSet.MetadataId?r.OptionSet.MetadataId:null,OptionSetName:r.OptionSet&&r.OptionSet.Name?r.OptionSet.Name:null,OptionSetType:r.OptionSet?D(a,i,r.OptionSet.OptionSetType):null,OptionSet:se(e,r.OptionSet),ParentPicklistLogicalName:r.OptionSet&&r.ParentPicklistLogicalName?r.ParentPicklistLogicalName:null,ChildPicklistLogicalNames:r.OptionSet&&r.ChildPicklistLogicalNames?r.ChildPicklistLogicalNames:null,RequiredLevel:fe(r.RequiredLevel),SourceType:r.SourceType,SourceTypeMask:r.SourceTypeMask,InheritsFrom:r.InheritsFrom,CanBeSecuredForCreate:_(0,0,r.CanBeSecuredForCreate),CanBeSecuredForRead:_(0,0,r.CanBeSecuredForRead),CanBeSecuredForUpdate:_(0,0,r.CanBeSecuredForUpdate)}}function se(e,t){let r=[];if(t&&(r=[],t.FalseOption&&r.push(ue(e,t.FalseOption)),t.TrueOption&&r.push(ue(e,t.TrueOption)),t.Options)){const n=t.Options;for(const t of n)r.push(ue(e,t))}return r}function ue(e,t){const r=L(e),n=U(e),a=t.TransitionData;return{Color:t.Color,Label:A(r,n,t.Label),Value:t.Value,DefaultStatus:t.DefaultStatus,State:t.State,TransitionData:a?[]:null,InvariantName:t.InvariantName,ParentValues:t.ParentValues}}function le(e){if("string"!=typeof e)return"number"==typeof e?e:null;switch(e){case"Auto":return 0;case"Inactive":return 1;case"Active":return 2;case"Disabled":return 3;default:return null}}function ce(e){const t=e,r=t.FormatName?t.FormatName.Value:null;return function(e,t,r){if(t)return t;let n="";if(null==r)n=r;else if(e&&e===l.AttributeType.DateTime)switch(r){case b.f.DateOnly:n=l.AttributeType.Date;break;case b.f.DateAndTime:n=l.AttributeType.DateTime;break;default:n=r.toString()}else n=r.toString();return n}(de(t.AttributeType),r,t.Format)}function de(e){switch(e){case n.Boolean:return l.AttributeType.Boolean;case n.Customer:return l.AttributeType.Customer;case n.DateTime:return l.AttributeType.DateTime;case n.Decimal:return l.AttributeType.Decimal;case n.Double:return l.AttributeType.Double;case n.Integer:return l.AttributeType.Integer;case n.Lookup:return l.AttributeType.Lookup;case n.Memo:return l.AttributeType.Memo;case n.Money:return l.AttributeType.Money;case n.Owner:return l.AttributeType.Owner;case n.PartyList:return l.AttributeType.PartyList;case n.Picklist:return l.AttributeType.PickList;case n.State:return l.AttributeType.State;case n.Status:return l.AttributeType.Status;case n.String:return l.AttributeType.String;case n.UniqueIdentifier:return l.AttributeType.UniqueIdentifier;case n.CalendarRules:return l.AttributeType.CalendarRules;case n.Virtual:return l.AttributeType.Virtual;case n.BigInt:return l.AttributeType.BigInt;case n.ManagedProperty:return l.AttributeType.ManagedProperty;case n.EntityName:return l.AttributeType.EntityName;case n.AliasedValue:return l.AttributeType.AliasedValue;case n.EntityImage:return l.AttributeType.EntityImage;case n.MultiSelectPicklist:return l.AttributeType.MultiSelectPickList;case n.File:return l.AttributeType.File;case n.NavigationProperty:return l.AttributeType.NavigationProperty;default:return l.AttributeType.Unknown}}function pe(e){if(!e)return l.AttributeType.Unknown;let t=l.AttributeType.Unknown;return"AttributeTypeName"in e&&e.AttributeTypeName.Value?t=e.AttributeTypeName.Value.replace(/Type/g,""):"AttributeType"in e&&e.AttributeType&&"string"==typeof e.AttributeType&&(t=e.AttributeType),t?"Float"===t?l.AttributeType.Double:t.toLowerCase():l.AttributeType.Unknown}function fe(e){if(!Object(u.isNullOrUndefined)(e)){let t;if(t=Object(u.isNullOrUndefined)(e.Value)?e:e.Value,"string"==typeof t)switch(e){case"None":return a.AttributeRequiredLevel.None;case"SystemRequired":return a.AttributeRequiredLevel.SystemRequired;case"ApplicationRequired":return a.AttributeRequiredLevel.ApplicationRequired;case"Recommended":return a.AttributeRequiredLevel.Recommended;default:return a.AttributeRequiredLevel.Unknown}if("number"==typeof t)return t}return-1}async function ye(e,t,r){const n=L(e),a=U(e),i={Id:O.Guid.tryParseOrNull(t.Id),EntityLogicalName:t.LogicalName,DisplayName:A(n,a,t.DisplayName),EntitySetName:t.EntitySetName,PrimaryKeyName:t.PrimaryIdAttribute,ObjectTypeCode:t.ObjectTypeCode,PrimaryIdAttribute:t.PrimaryIdAttribute,PrimaryNameAttribute:t.PrimaryNameAttribute,PrimaryImageAttribute:t.PrimaryImageAttribute,EntityColor:N(n,a,t.EntityColor),ActivityTypeMask:t.ActivityTypeMask,AutoRouteToOwnerQueue:_(0,0,t.AutoRouteToOwnerQueue),DisplayCollectionName:A(n,a,t.DisplayCollectionName),CanTriggerWorkflow:_(0,0,t.CanTriggerWorkflow),Description:A(n,a,t.Description),IsDocumentManagementEnabled:_(0,0,t.IsDocumentManagementEnabled),IsOneNoteIntegrationEnabled:_(0,0,t.IsOneNoteIntegrationEnabled),IsMSTeamsIntegrationEnabled:_(0,0,t.IsMSTeamsIntegrationEnabled),IsDocumentRecommendationsEnabled:_(0,0,t.IsDocumentRecommendationsEnabled),IsInteractionCentricEnabled:_(0,0,t.IsInteractionCentricEnabled),IsKnowledgeManagementEnabled:_(0,0,t.IsKnowledgeManagementEnabled),IsActivity:_(0,0,t.IsActivity),IsActivityParty:_(0,0,t.IsActivityParty),IsChildEntity:_(0,0,t.IsChildEntity),IsCollaboration:Pe(t.IsValidForQueue),IsConnectionsEnabled:Pe(t.IsConnectionsEnabled),IsCustomEntity:_(0,0,t.IsCustomEntity),IsBusinessProcessEnabled:_(0,0,t.IsBusinessProcessEnabled),IsCustomizable:Pe(t.IsCustomizable),IsOptimisticConcurrencyEnabled:_(0,0,t.IsOptimisticConcurrencyEnabled),IsImportable:_(0,0,t.IsImportable),IsIntersect:_(0,0,t.IsIntersect),IsMailMergeEnabled:Pe(t.IsMailMergeEnabled),IsEnabledForCharts:_(0,0,t.IsEnabledForCharts),IsValidForAdvancedFind:_(0,0,t.IsValidForAdvancedFind),IsVisibleInMobileClient:Pe(t.IsVisibleInMobileClient),IsReadOnlyInMobileClient:Pe(t.IsReadOnlyInMobileClient),IsOfflineInMobileClient:Pe(t.IsOfflineInMobileClient),IsQuickCreateEnabled:_(0,0,t.IsQuickCreateEnabled),EntityClientSetting:t.EntityClientSetting,OwnershipType:t.OwnershipType,HasChanged:_(0,0,t.HasChanged),HasStateCode:Ce(t),IsStateModelAware:_(0,0,t.IsStateModelAware),EnforceStateTransitions:_(0,0,t.EnforceStateTransitions),Privileges:t.Privileges||[],IconVectorName:t.IconVectorName,IsBPFEntity:_(0,0,t.IsBPFEntity),DataProviderId:O.Guid.tryParseOrNull(t.DataProviderId),IsEnabledInUnifiedInterface:!!Object(u.isNullOrUndefined)(t.IsVisibleInMobileClient)||(t.IsVisibleInMobileClient.Value||t.IsVisibleInMobileClient.CanBeChanged),VersionNumber:t.VersionNumber,OverallVersionNumber:t.OverallVersionNumber,AttributeNames:t.AttributeNames,IsAuditEnabled:t.IsAuditEnabled};return t.OneToManyRelationships&&(i.OneToManyRelationships=Ne(e,t.OneToManyRelationships,t,!1,Te),i.HasActivities=me(i.OneToManyRelationships,"activitypointer","regardingobjectid"),i.HasNotes=me(i.OneToManyRelationships,"annotation","objectid")),t.ManyToOneRelationships&&(i.ManyToOneRelationships=Ne(e,t.ManyToOneRelationships,t,!1,Te)),t.ManyToManyRelationships&&(i.ManyToManyRelationships=Ne(e,t.ManyToManyRelationships,t,!1,Se)),V.entities=Object.assign({},V.entities,{[r]:i}),i}function me(e,t,r){if(null===e)return!1;for(const n in e)if(e[n].ReferencingEntity===t&&e[n].ReferencingAttribute===r)return!0;return!1}function he(e,t,r){if(Object(u.isNullOrUndefined)(t))return null;const n=L(e),a=U(e);return{Behavior:r?ge(t.Behavior):T(n,a,t.Behavior),Group:r?Ee(t.Group):S(n,a,t.Group),Label:A(n,a,t.Label),Order:t.Order,AvailableOffline:Ue(n,t.AvailableOffline),Icon:t.Icon,IsCustomizable:Le(n,t.IsCustomizable),MenuId:t.MenuId,QueryApi:t.QueryApi,ViewId:Fe(n,O.Guid.tryParseOrNull(t.ViewId)),ExtensionData:t.ExtensionData}}function ge(e){if("string"!=typeof e)return"number"==typeof e?e:0;switch(e){case"UseCollectionName":return 0;case"UseLabel":return 1;case"DoNotDisplay":return 2;default:return 0}}function Ee(e){if("string"!=typeof e)return"number"==typeof e?e:0;switch(e){case"Details":return 0;case"Sales":return 1;case"Service":return 2;case"Marketing":return 3;default:return 0}}function be(e){if("string"!=typeof e)return"number"==typeof e?e:0;switch(e){case"NoCascade":return 0;case"Cascade":return 1;case"Active":return 2;case"UserOwned":return 3;case"RemoveLink":return 4;case"Restrict":return 5;default:return 0}}function Oe(e){if("string"!=typeof e)return"number"==typeof e?e:0;switch(e){case"None":return 0;case"Append":return 1;case"ParentChild":return 2;case"Pointer":return 4;case"Inheritance":return 8;default:return 0}}function ve(e){if("string"!=typeof e)return"number"==typeof e?e:-1;switch(e){case"OneToManyRelationship":return 0;case"ManyToManyRelationship":return 1;default:return-1}}function _e(e,t,r){const n=L(e),a=U(e);return{IsCustomRelationship:t.IsCustomRelationship,IsCustomizable:Pe(t.IsCustomizable),IsValidForAdvancedFind:t.IsValidForAdvancedFind,SchemaName:t.SchemaName,SecurityTypes:r?Oe(t.SecurityTypes):t.SecurityTypes,IsManaged:P(n,a,t),RelationshipType:r?ve(t.RelationshipType):Be(n,t.RelationshipType),IntroducedVersion:t.IntroducedVersion}}function Te(e,t,r,n){const a=he(e,t.AssociatedMenuConfiguration,n),i=function(e,t,r){const n=L(e),a=U(e);return r?{Assign:be(t.Assign),Delete:be(t.Delete),Merge:be(t.Merge),Reparent:be(t.Reparent),Share:be(t.Share),Unshare:be(t.Unshare),ExtensionData:t.ExtensionData}:{Assign:C(n,a,null==t?void 0:t.Assign),Delete:C(n,a,t.Delete),Merge:C(n,a,t.Merge),Reparent:C(n,a,t.Reparent),Share:C(n,a,t.Share),Unshare:C(n,a,t.Unshare),ExtensionData:t.ExtensionData}}(e,t.CascadeConfiguration,n),o=L(e),s=U(e);return Object.assign({AssociatedMenuConfiguration:a,CascadeConfiguration:i,ReferencedAttribute:t.ReferencedAttribute,ReferencedEntity:R(o,s,t,r),ReferencingAttribute:t.ReferencingAttribute,ReferencingEntity:w(o,s,t,r),IsHierarchical:I(o,s,t.IsHierarchical),ReferencedEntityNavigationPropertyName:qe(o,t),ReferencingEntityNavigationPropertyName:M(o,s,t)},_e(e,t,n))}function Se(e,t,r,n){const a=L(e);return Object.assign({Entity1AssociatedMenuConfiguration:he(e,t.Entity1AssociatedMenuConfiguration,n),Entity2AssociatedMenuConfiguration:he(e,t.Entity2AssociatedMenuConfiguration,n),Entity1LogicalName:t.Entity1LogicalName,Entity2LogicalName:t.Entity2LogicalName,IntersectEntityName:je(a,t),Entity1IntersectAttribute:t.Entity1IntersectAttribute,Entity2IntersectAttribute:t.Entity2IntersectAttribute,Entity1NavigationPropertyName:xe(a,t),Entity2NavigationPropertyName:ke(a,t)},_e(e,t,n))}function Ne(e,t,r,n,a){if(!t)return null;const i={};for(const o of t){const t=a(e,o,r,n);i[o.SchemaName]=t}return i}function Ce(e){if(!e||!e.AttributeNames)return!1;for(const t of e.AttributeNames)if("statecode"===t.toLowerCase())return!0;return!1}function Pe(e){return e?e.Value:null}async function Re(e,t=[]){const r=await Ae(e,t);if(Object(u.isNullOrUndefined)(r)||Object(u.isNullOrUndefined)(r[0])||Object(u.isNullOrUndefined)(r[0].rows)||Object(u.isNullOrUndefined)(r[0].rows.item(0))){const e="user context returned from Database is empty";return Promise.reject(new o.a(e))}{const e=r[0].rows.item(0),t=JSON.parse(e.json);return V.userContext=Object.assign({},V.userContext,{userid:new O.Guid(t.userid.rawguid),username:t.username,fcbContext:t.fcbcontext,userSettings:t.usersettings,organizationSettings:t.organizationsettings?{languageCode:t.organizationsettings.languagecode,fullnameconventioncode:t.organizationsettings.fullnameconventioncode}:t.organizationsettings,offlineProfile:t.offlineprofile?{offlineAvailableEntities:t.offlineprofile.offlineavailableentities,profileId:t.offlineprofile.profileid,profileVersion:t.offlineprofile.profileversion}:t.offlineprofile}),t}}async function we(e,t,r=[]){const n=[Object(u.getViewLocalStoreId)(t)];return await Object(s.b)(e,"select * from applicationmetadata where id = ?",n,r)}async function Me(e,t,r=[]){const n=[t];return await Object(s.b)(e,"SELECT id, json FROM [entitymetadata] WHERE [logicalname] = ?",n,r)}async function Ie(e,t,r,n=[]){let a="select * from attributemetadata where entitylogicalname = ? and logicalname in (";for(let e=0;e<r.length-1;e++)a+="?,";a+="?)";const i=[t,...r];return await Object(s.b)(e,a,i,n)}async function Ae(e,t){const r={};r[$.i.METADATA_TYPE]=[B.MetadataType.userContext];return await Object(s.b)(e,"select * from usercontext",[],t,void 0,r)}function De(e){return e?`[${e}]`:`[${i.FILE_PREFIX.MetadataCache}]`}function Le(e,t){return(!e||!Object(u.isNullOrUndefined)(t))&&t}function Ue(e,t){return!(!e||!Object(u.isNullOrUndefined)(t))||t}function Fe(e,t){return e&&Object(u.isNullOrUndefined)(t)?O.Guid.EMPTY:t}function xe(e,t){return e&&Object(u.isNullOrUndefined)(t.Entity1NavigationPropertyName)?t.SchemaName:t.Entity1NavigationPropertyName}function ke(e,t){return e&&Object(u.isNullOrUndefined)(t.Entity2NavigationPropertyName)?t.SchemaName:t.Entity2NavigationPropertyName}function je(e,t){return e&&Object(u.isNullOrUndefined)(t.IntersectEntityName)?t.SchemaName:t.IntersectEntityName}function qe(e,t){return e&&Object(u.isNullOrUndefined)(t.ReferencedEntityNavigationPropertyName)?t.SchemaName:t.ReferencedEntityNavigationPropertyName}function Be(e,t){return e&&Object(u.isNullOrUndefined)(t)?a.RelationshipType.OneToManyRelationship:t}function $e(e,t,r,n=[]){var a;const o=performance.now()-t,s=[];s.push({name:i.EVENT_PARAMETERS.RESPONSE_TIME,value:o}),s.push({name:i.EVENT_PARAMETERS.METADATA_CACHE_OPERATION,value:e}),null===(a=null==r?void 0:r.EventManager)||void 0===a||a.ReportComponentSuccess(De(),Object(v.b)(n,s))}},YIL4:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SQLOperationType=void 0,function(e){e[e.Create=1]="Create",e[e.Delete=2]="Delete",e[e.Update=3]="Update",e[e.Retrieve=4]="Retrieve"}(t.SQLOperationType||(t.SQLOperationType={}))},Yxto:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.getUserMetadataVersionState=t.getUserMetadataVersion=void 0;var n=r("KkiZ");function a(e){return e&&e.metadata&&e.metadata.userMetadataVersion?e.metadata.userMetadataVersion:null}t.getUserMetadataVersion=a,t.getUserMetadataVersionState=function(e){var t=a(e);return t?t.initialized:n.InitState.Uninitialized}},ZFvc:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,a,i=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)o.push(n.value)}catch(e){a={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(a)throw a.error}}return o},a=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(n(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0}),t.LegacyErrorStatus=void 0;var i=r("nf9M"),o=r("+hYO"),s=r("oCZx"),u=r("7l03"),l=function(){function e(e){this._errorCode=0,this._errorFault=null,this._errorSource=0,this._blockErrorReporting=!1,this._faultedRequestIndex=0,this._httpStatusCode=0,this._message=e,this._errorSource=0,this._blockErrorReporting=!1,this._isRequestTooLong=!1}return e.prototype.get_ErrorCode=function(){return this._errorCode},e.prototype.set_ErrorCode=function(e){return this._errorCode=e,e},e.prototype.get_Message=function(){return this._message},e.prototype.set_Message=function(e){return this._message=e,e},e.prototype.get_Exception=function(){return this._exception},e.prototype.set_Exception=function(e){return this._exception=e,e},e.prototype.get_InnerError=function(){return this._innerError},e.prototype.set_InnerError=function(e){return this._innerError=e,e},e.prototype.get_ErrorFault=function(){return this._errorFault},e.prototype.set_ErrorFault=function(e){return this._errorFault=e,e},e.prototype.get_ErrorSource=function(){return this._errorSource},e.prototype.get_BlockErrorReporting=function(){return this._blockErrorReporting},e.prototype.set_BlockErrorReporting=function(e){return this._blockErrorReporting=e,e},e.prototype.get_Stack=function(){return this._stack},e.prototype.set_Stack=function(e){return this._stack=e,e},e.prototype.get_FaultedRequestIndex=function(){return this._faultedRequestIndex},e.prototype.set_FaultedRequestIndex=function(e){return this._faultedRequestIndex=e,e},e.prototype.get_ServerResponseId=function(){return this._serverResponseId},e.prototype.set_ServerResponseId=function(e){return this._serverResponseId=e,e},e.prototype.get_ClientRequestId=function(){return this._clientRequestId},e.prototype.set_ClientRequestId=function(e){return this._clientRequestId=e,e},e.prototype.get_HttpStatusCode=function(){return this._httpStatusCode},e.prototype.set_HttpStatusCode=function(e){return this._httpStatusCode=e,e},e.prototype.get_RetryAfter=function(){return this._retryAfter},e.prototype.set_RetryAfter=function(e){return this._retryAfter=e,e},e.prototype.get_isRequestTooLong=function(){return this._isRequestTooLong},e.prototype.set_isRequestTooLong=function(e){return this._isRequestTooLong=e,e},e.prototype.chainError=function(e){this.set_Message(this.get_Message()+"\nInner Error Message:\n"+e.get_Message()),this.set_InnerError(e)},e.prototype.getObjectData=function(){var e={};return e.errorcode=this.get_ErrorCode(),e.message=this.get_Message(),i.IsNullOrUndefined(this.get_InnerError())||(e.innererror=this.get_InnerError().getObjectData()),e},e.FromMessage=function(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var o="";return i.IsNullOrUndefinedOrEmptyString(t)||(o=!i.IsNullOrUndefined(r)&&r.length>0?s.String.Format.apply(s.String,a([t],r)):t),new e(o)},e.fromGenericError=function(t){var r=i.IsNullOrUndefined(t)?e.fromErrorCode(1):e.FromMessage(t.message);return r._blockErrorReporting=t.blockErrorReporting,i.IsNullOrUndefined(t.errorCode)||(r._errorCode=t.errorCode),i.IsNullOrUndefined(t.stack)||(r._stack=t.stack),r},e.fromErrorCode=function(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var a=new e(u.getErrorMessage(t));return a.set_ErrorCode(t),a},e.fromErrorCodeAndMessage=function(t,r){var n=new e("");return n.set_ErrorCode(t),n.set_Message(r),n},e.fromLocalStoreError=function(t,r){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var o=new e(s.String.Format.apply(s.String,a([r],n)));return o._errorCode=t,o},e.isAuthenticationErrorCode=function(e){return e===o.CrmErrorCodes.UserWithoutRoles||e===o.CrmErrorCodes.UserWithoutPrivileges||e===o.CrmErrorCodes.BusinessUnitDisabled||e===o.CrmErrorCodes.GeneralAuthorizationErrorCode||e===o.CrmErrorCodes.PrivilegeDenied||e===o.CrmErrorCodes.NoUserPrivilege||e===o.CrmErrorCodes.UserDisabled},e}();t.LegacyErrorStatus=l},"ZKH/":function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.toMetadataQuery=t.MetadataType=void 0;var n,a=r("Ln9p"),i=r("RXZ1");!function(e){e.BusinessProcessFlow="businessprocessflow",e.MetadataVersion="metadataversion",e.UserMetadataVersion="usermetadataversion",e.BPFSelector="bpfselector"}(n||(n={})),t.MetadataType=n,t.toMetadataQuery=function(e){var t,r=e&&Array.isArray(e.Exclude)&&e.Exclude.map(a.Guid.fromLegacyGuid)||[],n=new i.MetadataQuery;return n.MetadataType=(t=e.MetadataType)&&o[t]?o[t]:t,n.MetadataSubtype=e.MetadataSubtype,n.EntityLogicalName=e.EntityLogicalName,n.MetadataId=a.Guid.fromLegacyGuid(e.MetadataId),n.MetadataNames=e.MetadataNames,n.GetDefault=e.GetDefault,n.DependencyDepth=e.DependencyDepth,n.ChangedAfter=e.ChangedAfter,n.Exclude=r,n.AppId=e.AppId&&a.Guid.fromLegacyGuid(e.AppId)||null,n};var o={webresourcedescriptor:"webresource"}},ZXCs:function(e,t,r){"use strict";r.d(t,"c",(function(){return l})),r.d(t,"b",(function(){return S})),r.d(t,"a",(function(){return c})),r.d(t,"d",(function(){return T})),r.d(t,"e",(function(){return v})),r.d(t,"f",(function(){return y})),r.d(t,"g",(function(){return m})),r.d(t,"h",(function(){return _})),r.d(t,"i",(function(){return f})),r.d(t,"j",(function(){return h})),r.d(t,"k",(function(){return g})),r.d(t,"l",(function(){return d})),r.d(t,"m",(function(){return O})),r.d(t,"n",(function(){return E}));var n=r("Szbx"),a=r("jkZo"),i=r("7l03"),o=r("fKp2"),s=r("Ln9p"),u=r("zjpj");
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
function l(e,t,r=[]){var n,i,s;if(!b(e.ApplicationState,a.a))return null;const l=null===(n=e.TraceManager)||void 0===n?void 0:n.getTracer(o.COMPONENT_NAMES.MetadataCache),c=null===(s=null===(i=e.ApplicationState)||void 0===i?void 0:i.metadata)||void 0===s?void 0:s.entities;if(c){const e=Object(u.c)(c,t,l,r);if(e)return e}return l.info(P()+" entity metadata not found on state"),null}async function c(e,t,r,n=[]){var s,u,l,c,d,p,f,y,m,h;if(!b(e.ApplicationState,a.a))return null;const g=null===(s=e.TraceManager)||void 0===s?void 0:s.getTracer(o.COMPONENT_NAMES.MetadataCache);let E=null===(c=null===(l=null===(u=e.ApplicationState)||void 0===u?void 0:u.metadata)||void 0===l?void 0:l.attributes)||void 0===c?void 0:c[r];if(Object(i.isNullOrUndefined)(E)&&await C(e,r,t,n),E=null===(f=null===(p=null===(d=e.ApplicationState)||void 0===d?void 0:d.metadata)||void 0===p?void 0:p.attributes)||void 0===f?void 0:f[r],Object(i.isNullOrUndefined)(E))return g.warn(`${P()} state does not contain entity metadata even after refresh ${r}`),null;const O=Object.keys(E),v={};if(0===t.length){for(const e of O)v[e]=E[e].Type;return v}if(!t.every(e=>O.includes(e))){const a=t.filter(e=>O.indexOf(e)<0);n.push({name:"MissingAttributesInState",value:a.join(",")}),g.warn(P()+" Not all attributes requested have metadata present in the injected state.",n),await C(e,r,t,n)}if(E=null===(h=null===(m=null===(y=e.ApplicationState)||void 0===y?void 0:y.metadata)||void 0===m?void 0:m.attributes)||void 0===h?void 0:h[r],Object(i.isNullOrUndefined)(E))return g.warn(`${P()} state does not contain entity metadata even after refresh ${r}`),null;for(const e of t)E[e]&&(v[e]=E[e].Type);return v}async function d(e,t=[]){if(!b(e.ApplicationState,a.a))return null;const r=p(e);return r||(await N(e,t),p(e))}function p(e){var t,r,n,a,o,s,u,l,c,d,p,f,y;if((null===(n=null===(r=null===(t=e.ApplicationState)||void 0===t?void 0:t.user)||void 0===r?void 0:r.userSettings)||void 0===n?void 0:n.languageId)&&!Object(i.isNullOrUndefined)(null===(s=null===(o=null===(a=e.ApplicationState)||void 0===a?void 0:a.user)||void 0===o?void 0:o.userSettings)||void 0===s?void 0:s.timeZoneUtcOffsetMinutes)&&!Object(i.isNullOrUndefined)(null===(c=null===(l=null===(u=e.ApplicationState)||void 0===u?void 0:u.user)||void 0===l?void 0:l.userSettings)||void 0===c?void 0:c.timeZoneAdjusters)&&!Object(i.isNullOrUndefined)(null===(f=null===(p=null===(d=e.ApplicationState)||void 0===d?void 0:d.user)||void 0===p?void 0:p.userSettings)||void 0===f?void 0:f.dateFormatInfo)){const t=e.ApplicationState.user.userSettings,r={timezoneutcoffsetminutes:t.timeZoneUtcOffsetMinutes,timezoneadjusters:[],datetimeformatinfo:t.dateFormatInfo,languageid:t.languageId};return r.timezoneadjusters=null===(y=t.timeZoneAdjusters)||void 0===y?void 0:y.map(e=>({dateend:e.dateEnd,datestart:e.dateStart,daylightend:{day:e.daylightEnd.day,dayofweek:e.daylightEnd.dayOfWeek,month:e.daylightEnd.month,week:e.daylightEnd.week,timeofday:e.daylightEnd.timeOfDay,isfixeddaterule:e.daylightEnd.isFixedDateRule},daylightstart:{day:e.daylightStart.day,dayofweek:e.daylightStart.dayOfWeek,month:e.daylightStart.month,week:e.daylightStart.week,timeofday:e.daylightStart.timeOfDay,isfixeddaterule:e.daylightStart.isFixedDateRule},delta:e.delta})),r}return null}async function f(e,t=[]){var r,n,i,o;if(!b(e.ApplicationState,a.a))return null;let s=null===(n=null===(r=e.ApplicationState)||void 0===r?void 0:r.organization)||void 0===n?void 0:n.organizationSettings;if(s&&s.fullNameConventionCode&&s.languageCode){return{fullnameconventioncode:s.fullNameConventionCode,languageCode:s.languageCode}}if(await N(e,t),s=null===(o=null===(i=e.ApplicationState)||void 0===i?void 0:i.organization)||void 0===o?void 0:o.organizationSettings,s&&s.fullNameConventionCode&&s.languageCode){return{fullnameconventioncode:s.fullNameConventionCode,languageCode:s.languageCode}}return null}async function y(e,t=[]){if(!b(e.ApplicationState,a.a))return null;const r=await f(e,t);return r&&!Object(i.isNullOrUndefined)(r.fullnameconventioncode)?r.fullnameconventioncode:null}async function m(e,t=[]){if(!b(e.ApplicationState,a.a))return null;const r=await f(e,t);return r&&!Object(i.isNullOrUndefined)(r.languageCode)?r.languageCode:null}async function h(e,t=[]){var r,n,o,s;if(!b(e.ApplicationState,a.a))return null;let u=null===(n=null===(r=e.ApplicationState)||void 0===r?void 0:r.user)||void 0===n?void 0:n.userId;return Object(i.isNullOrUndefined)(u)?(await N(e,t),u=null===(s=null===(o=e.ApplicationState)||void 0===o?void 0:o.user)||void 0===s?void 0:s.userId,Object(i.isNullOrUndefined)(u)?null:u):u}async function g(e,t=[]){var r,n,o,s;if(!b(e.ApplicationState,a.a))return null;let u=null===(n=null===(r=e.ApplicationState)||void 0===r?void 0:r.user)||void 0===n?void 0:n.userDisplayName;return Object(i.isNullOrUndefined)(u)?(await N(e,t),u=null===(s=null===(o=e.ApplicationState)||void 0===o?void 0:o.user)||void 0===s?void 0:s.userDisplayName,Object(i.isNullOrUndefined)(u)?null:u):u}async function E(e,t,r=[]){var n,i,o,s,u,l,c,d;if(!b(e.ApplicationState,a.a))return null;let p=null===(i=null===(n=e.ApplicationState)||void 0===n?void 0:n.fcbs)||void 0===i?void 0:i.clientFCBs,f=null===(s=null===(o=e.ApplicationState)||void 0===o?void 0:o.fcbs)||void 0===s?void 0:s.nativeFCBContext;return p&&void 0!==p[t]?p[t]:f&&void 0!==f[t]?f[t]:(await N(e,r),p=null===(l=null===(u=e.ApplicationState)||void 0===u?void 0:u.fcbs)||void 0===l?void 0:l.clientFCBs,f=null===(d=null===(c=e.ApplicationState)||void 0===c?void 0:c.fcbs)||void 0===d?void 0:d.nativeFCBContext,p&&void 0!==p[t]?p[t]:f&&void 0!==f[t]?f[t]:null)}function b(e,t){const r=e?e.fcbs:void 0;if(r){const n=r.clientFCBs;if(n)return t in n&&(n[t]||function(e,t){const r=e?e.fcbs:void 0;if(r){const e=r.nativeFCBContext;if(e&&t in e)return e[t]}return!1}(e,t))}return!1}async function O(e,t,r,i=[]){var u,l,c,d;if(!b(e.ApplicationState,a.a))return null;let p=null===(l=null===(u=e.ApplicationState)||void 0===u?void 0:u.metadata)||void 0===l?void 0:l.views;return p&&p[t]&&p[t].initialized===n.a.Initialized?p[t]:(await async function(e,t,r,n=[]){var i,u,l;const c=null===(i=e.TraceManager)||void 0===i?void 0:i.getTracer(o.COMPONENT_NAMES.MetadataCache),d=s.Guid.tryParseOrNull(r);if(b(e.ApplicationState,a.b)&&t&&d){const r=null===(u=e.StateProvider)||void 0===u?void 0:u.getStore(),a=null===(l=e.StateProvider)||void 0===l?void 0:l.getActions().retrieveView;r&&a?await r.dispatch(a(t,void 0,void 0,d)):c.warn(P()+" Unable to view descriptor metadata, no store or retrieve view action",n)}}(e,r,t,i),p=null===(d=null===(c=e.ApplicationState)||void 0===c?void 0:c.metadata)||void 0===d?void 0:d.views,p&&p[t]&&p[t].initialized===n.a.Initialized?p[t]:null)}async function v(e,t,r=[]){var i,o;if(!b(e.ApplicationState,a.a))return null;const s=null===(o=null===(i=e.ApplicationState)||void 0===i?void 0:i.metadata)||void 0===o?void 0:o.entities;return s&&s[t]&&s[t].Initialized===n.a.Initialized?s[t]:null}async function _(e,t=[]){var r,n,o,s,u,l;if(!b(e.ApplicationState,a.a))return null;let c=null===(o=null===(n=null===(r=e.ApplicationState)||void 0===r?void 0:r.user)||void 0===n?void 0:n.userSettings)||void 0===o?void 0:o.offlineProfileAvailableEntities;return Object(i.isNullOrUndefined)(c)?(await N(e,t),c=null===(l=null===(u=null===(s=e.ApplicationState)||void 0===s?void 0:s.user)||void 0===u?void 0:u.userSettings)||void 0===l?void 0:l.offlineProfileAvailableEntities,Object(i.isNullOrUndefined)(c)?null:c):c}function T(e,t,r=[]){var n,i;if(!b(e.ApplicationState,a.a))return null;const o=null===(i=null===(n=e.ApplicationState)||void 0===n?void 0:n.metadata)||void 0===i?void 0:i.entitiesByTypeCode;return o&&o[t]?o[t]:null}function S(e,t){var r,n;const a=null===(n=null===(r=e.ApplicationState)||void 0===r?void 0:r.metadata)||void 0===n?void 0:n.attributes;return a&&a[t]?a[t]:{}}async function N(e,t=[]){var r,n,i;const s=null===(r=e.TraceManager)||void 0===r?void 0:r.getTracer(o.COMPONENT_NAMES.MetadataCache);if(b(e.ApplicationState,a.b)){const r=null===(n=e.StateProvider)||void 0===n?void 0:n.getStore(),a=null===(i=e.StateProvider)||void 0===i?void 0:i.getActions().retrieveUserContext;r&&a?await r.dispatch(a()):null==s||s.warn(P()+" Unable to refresh user context metadata, no store or retrieve user context action",t)}}async function C(e,t,r,n=[]){var i,s,u;const l=null===(i=e.TraceManager)||void 0===i?void 0:i.getTracer(o.COMPONENT_NAMES.MetadataCache);if(b(e.ApplicationState,a.b)){const a=null===(s=e.StateProvider)||void 0===s?void 0:s.getStore(),i=null===(u=e.StateProvider)||void 0===u?void 0:u.getActions().retrieveEntity;a&&i?await a.dispatch(i(t,!r||0===r.length,r)):l.warn(P()+" Unable to refresh entity metadata, no store or retrieve entity action",n)}}function P(){return`[${o.FILE_PREFIX.MetadataStateAccessor}]`}},ZYnM:function(e,t,r){"use strict";var n=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,a,i=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)o.push(n.value)}catch(e){a={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(a)throw a.error}}return o},a=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(n(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0}),t.buildContextFilter=t.ModernQueryBuilder=void 0;var i=r("9byC"),o=r("Ln9p"),s=r("qV+U"),u=r("tcxr"),l=r("DiyU"),c=r("M2g1"),d=function(){function e(e){this._query=e?Object.assign({},e):{},this._query.selects=this._query.selects||[],this._selectsInKey=this._query.selects?this._query.selects.map((function(e){return!0})):[],this._query.linkEntities=this._query.linkEntities||[],this._query.sorts=this._query.sorts||[],this._query.wheres=this._query.wheres||[],this._query.contextFiltersAndIds=this._query.contextFiltersAndIds||[],this._query.searchString=this._query.searchString||"",this._query.isQuickFindSearch=this._query.isQuickFindSearch||!1,this._childCountAttributes=[],this._isFetchXmlParsed=!1,this._query.isFetchXmlModified=this._query.isFetchXmlModified||!1,this._resetSort=!1}return Object.defineProperty(e.prototype,"fetchDocument",{get:function(){return this._isFetchXmlParsed||this._parseFetchXmlFromString(this._query.fetchXml),this._fetchDocument},enumerable:!1,configurable:!0}),e.prototype._parseFetchXmlFromString=function(e){e&&(this._fetchDocument=i.parseFetchXmlFromString(e),this._isFetchXmlParsed=!0)},e.fromView=function(t,r){var n=new e;return n._query.viewId=t,n._query.searchString=r||"",n},e.fromXml=function(t,r,n){var a=new e;return a._query.fetchXml=t,a._query.viewId=r,a._query.searchString=n,a},e.fromState=function(t){return new e(t)},e.prototype.select=function(){for(var e,t,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];for(var i=[],o=0;o<r.length;o++)this._query.selects&&-1===this._query.selects.indexOf(r[o])&&i.push(r[o]);return this._query.selects&&(e=this._query.selects).push.apply(e,a(i)),(t=this._selectsInKey).push.apply(t,a(i.map((function(e){return!0})))),this},e.prototype.selectAll=function(){return this._query.isAllColumns=!0,this},e.prototype.from=function(e){return this._query.entityLogicalName=e,this},e.prototype.selectInternal=function(e,t){return void 0===t&&(t=!0),this._query.selects&&-1===this._query.selects.indexOf(e)&&(this._query.selects.push(e),this._selectsInKey.push(t)),this},e.prototype.addLinkedEntity=function(e,t){var r=i.buildLinkedEntityNode(e,t);return this._query.linkEntities&&this._query.linkEntities.push(r),this},e.prototype.orderBy=function(e,t,r){return void 0===t&&(t=!1),void 0===r&&(r=!0),this._query.sorts&&this._query.sorts.push(e+(t?" desc":" asc")),this._resetSort=r,this},e.prototype.addChildCountAttribute=function(e){return this._childCountAttributes.push(e),this},e.prototype.applyContextFilter=function(e,t,r,n){void 0===n&&(n=s.RelationshipRoleOrdinal.Referencing);var a=p(e,this._query.entityLogicalName||i.getEntityFromFetch(this.fetchDocument),n,r),u=o.Guid.toString(t);return this._query.contextFiltersAndIds&&this._query.contextFiltersAndIds.push(u+"="+a),this},e.prototype.toFetchXml=function(e){if(function(e){e&&!e.pageNumber&&(e.pageNumber=1);e&&!e.pageSize&&(e.pageSize=25);e&&(e.useModernQueryBuilder=!0)}(this._query),!this.fetchDocument){if(!e)throw u.createUciError("ModernQueryBuilder: getState function not provided");if(!this._query.viewId)throw Error("ModernQueryBuilder: view id not provided to retrieve fetch xml for the view")}if(!this.fetchDocument)throw Error("ModernQueryBuilder: fetch xml not provided");return this._query.isFetchXmlModified||this._applyModificationsToFetchXml(),i.setFetchXmlParameters(this.fetchDocument,this._query.pageSize,this._query.pageNumber,true,false),(new XMLSerializer).serializeToString(this.fetchDocument)},e.prototype.getQueryState=function(e,t){return void 0===e&&(e=!1),e||(this._query.fetchXml=this.toFetchXml(t),this._query.entityLogicalName||(this._query.entityLogicalName=i.getEntityFromFetch(this.fetchDocument)),this._query.key=this.getKey()),this._query},Object.defineProperty(e.prototype,"pageSize",{get:function(){return this._query.pageSize},set:function(e){this._query.pageSize=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pageNumber",{get:function(){return this._query.pageNumber},set:function(e){this._query.pageNumber=e},enumerable:!1,configurable:!0}),e.prototype.getKey=function(){var e=this;return this._query.selects?this._getBaseKey()+": "+this._query.selects.filter((function(t,r){return e._selectsInKey[r]}))+": "+this._query.wheres+": "+this._query.sorts+": "+this._query.contextFiltersAndIds+": "+this._query.linkEntities+": "+this._query.isQuickFindSearch+": "+this._query.searchString+": "+this._query.pageSize:null},e.prototype.getPublicKey=function(){var e=this;return this._query.selects?this._getBaseKey()+": "+this._query.selects.filter((function(t,r){return e._selectsInKey[r]}))+": "+this._query.sorts+": "+this._query.contextFiltersAndIds+": "+this._query.linkEntities+": "+this._query.pageSize:null},e.prototype._getBaseKey=function(){return this._query.viewId?this._query.entityLogicalName+"-"+o.Guid.toString(this._query.viewId):o.Guid.toString(this._query.viewId)},e.prototype._applyModificationsToFetchXml=function(){var e=this;this._query.selects&&this._query.selects.length>0&&(i.isFetchAll(this.fetchDocument)||i.addColumns(this.fetchDocument,this._query.selects)),this._query.linkEntities&&this._query.linkEntities.length>0&&this._query.linkEntities.forEach((function(t){return i.addLinkedEntity(e.fetchDocument,t)})),this._query.wheres&&this._query.wheres.length>0&&this._query.wheres.forEach((function(t){return i.addFilters(e.fetchDocument,t)})),this._resetSort&&i.removeOrderElements(this.fetchDocument),this._query.sorts&&this._query.sorts.length>0&&this._query.sorts.forEach((function(t){var r=t.split(" ");i.addSort(e.fetchDocument,r[0],"desc"===r[1])})),this._childCountAttributes.length>0&&this._childCountAttributes.forEach((function(t){return i.addChildCountAttribute(e.fetchDocument,t)})),this._query.contextFiltersAndIds&&this._query.contextFiltersAndIds.length>0&&this._query.contextFiltersAndIds.forEach((function(t){var r=t.indexOf("="),n=t.substring(0,r),a=t.substring(r+1,t.length);i.addContextFilter(e.fetchDocument,a,n)})),this._query.isFetchXmlModified=!0},e.prototype.applyRollupContextFilter=function(){throw new Error("Not implemented")},e.prototype.where=function(e,t,r){var n=l.Expression.toLegacyFilterExpression(e,r).toFetchXml();return this._query&&(t?this._query.wheres=[n]:this._query.wheres&&this._query.wheres.push(n)),this._query.expression?this._query.expression.terms.push(e):this._query.expression=new l.Expression(c.LogicalOperatorString.and,e),this},e.prototype.setDefaultPageSize=function(){throw new Error("Not implemented")},e.prototype.getFirstError=function(){throw new Error("Not implemented")},e.prototype.addExistingContextFilterToKey=function(){throw new Error("Not implemented")},e.prototype.validateLinkedEntity=function(){throw new Error("Not implemented")},Object.defineProperty(e.prototype,"fetchXml",{get:function(){throw new Error("Not implemented")},enumerable:!1,configurable:!0}),e}();function p(e,t,r,n){return null}t.ModernQueryBuilder=d,t.buildContextFilter=p},Zwof:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LegacyColumnSet=void 0;var n=r("iLQe"),a=function(){function e(e){this._columns=e}return e.prototype.get_Columns=function(){return this._columns},e.prototype.get_isEmpty=function(){return!(this._columns.length>0)},e.prototype.getObjectData=function(){var e={};return e.columns=this._columns,e},e.prototype.getDifference=function(t){var r=this;return t instanceof n.AllColumns?t:new e(t.get_Columns().filter((function(e){return r.get_Columns().indexOf(e)<0})))},e.createFromObjectData=function(t){return new e(t.columns)},e}();t.LegacyColumnSet=a},aAjD:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n,a=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.UCIContext=void 0;var i=function(e){function t(t,r){void 0===r&&(r=!1);var n=e.call(this,t)||this;return n._isPreloadCall=!1,n.requestId=t,n._isPreloadCall=r,n}return a(t,e),t.prototype.RequestId=function(){return this.requestId},t.prototype.IsPreloadCall=function(){return this._isPreloadCall},t.prototype.toString=function(){return"["+this.RequestId()+"]"},t}(r("kCYo").CallingContext);t.UCIContext=i},aTRZ:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.isSLAImpactingError=t.isNonReportableErrorCode=t.ErrorCodes=void 0;var n,a=r("+hYO"),i=r("cXeo"),o=r("dozL"),s=r("tnR8"),u=r("+MPC");!function(e){e[e.MetadataNoMapping=2147749377]="MetadataNoMapping",e[e.ObjectDoesNotExist=2147746327]="ObjectDoesNotExist"}(n||(n={})),function(e){e[e.InvalidEntity=2147868684]="InvalidEntity",e[e.unknownBadRequestError=2147951697]="unknownBadRequestError",e[e.UnknownUnauthorizedError=2147951872]="UnknownUnauthorizedError",e[e.unknownForbiddenError=2147951873]="unknownForbiddenError",e[e.unknownNotFoundError=2147951874]="unknownNotFoundError",e[e.UnknownTooManyRequestsError=2147951875]="UnknownTooManyRequestsError",e[e.unknownInternalServerError=2147951876]="unknownInternalServerError",e[e.unknownNotImplementedServerError=2147951877]="unknownNotImplementedServerError",e[e.unknownBadGatewayError=2147951878]="unknownBadGatewayError",e[e.unknownServiceUnavailableError=2147951879]="unknownServiceUnavailableError",e[e.unknownGatewayTimeoutError=2147951880]="unknownGatewayTimeoutError",e[e.UnknownUnexpectedGenericError=2147951881]="UnknownUnexpectedGenericError"}(t.ErrorCodes||(t.ErrorCodes={})),t.isNonReportableErrorCode=function(e){e<0&&(e=4294967295+e+1);var t=[n.MetadataNoMapping,n.ObjectDoesNotExist];return null!=e&&t.indexOf(e)>-1},t.isSLAImpactingError=function(e,t,r){return function(e,t,r){switch(e){case o.MDL_COMPONENT_NAMES.ModernDataSource:case o.MDL_COMPONENT_NAMES.ModernDataSourceGCM:case s.WEB_API_SERVICE_COMPONENT:return function(e){var t=u.getNegativeErrorCodeFromErrorCode(e),r=[a.CrmErrorCodes.MetadataNoMapping,a.CrmErrorCodes.ObjectDoesNotExist,a.CrmErrorCodes.isvAborted,a.CrmErrorCodes.isvUnexpected];if(null!=t&&r.indexOf(t)>-1)return!1;return!0}(t);case s.OfflineDatSyncComponent:return function(e,t){var r=u.getNegativeErrorCodeFromErrorCode(e),n=[i.DataSyncServiceErrorCodes.InvalidSubscription,i.DataSyncServiceErrorCodes.InvalidMetadata,i.DataSyncServiceErrorCodes.AuthenticationError,i.DataSyncServiceErrorCodes.InvalidSubscriptionInLoop,i.DataSyncServiceErrorCodes.SyncHandlerNotAvailable,a.CrmErrorCodes.DataSourceOfflineErrorCode],o=["Synchronization interrupted by the user!"];if(null!=r&&n.indexOf(r)>-1||o.indexOf(t)>-1)return!1;return!0}(t,r);default:return!0}}(e,t,r)}},agGS:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Command=void 0;
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n=r("8w73"),a=function(){function e(e,t,r,n){this.status=0,this._id=e,this.name=t,this.status=r,this.actionData=n,this.createdOn=new Date}return e.prototype.toDictionary=function(){var e={};return e[n.commandIdColumnName]=this._id,e[n.commandNameColumnName]=this.name,e[n.commandStatusColumnName]=this.status,e[n.commandActionDataColumnName]=this.actionData,e[n.commandCreatedOnColumnName]=this.createdOn,e},e}();t.Command=a},az3V:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XmlNode=void 0;var n=function(){function e(){}return e.createAttribute=function(e,t,r){if(e){var n=e.createAttribute(t);return n.value=r,n}return null},e}();t.XmlNode=n},b1WC:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.removeReference=t.addReference=void 0,t.addReference=function(e,t){if(e||(e=[]),-1===e.indexOf(t))return e.push(t),e},t.removeReference=function(e,t){if(e){var r=e.indexOf(t);return-1!==r?1===e.length?[]:(e.splice(r,1),e):void 0}}},b30f:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.getIsMocaOfflineFeatureEnabled=void 0;var n=r("nf9M"),a=r("zrAn");t.getIsMocaOfflineFeatureEnabled=function(e){return e&&e.offline&&e.offline.server&&!n.IsNullOrUndefined(e.offline.server.isMocaOfflineFeatureEnabled)?e.offline.server.isMocaOfflineFeatureEnabled||a.isBrowserOfflineEnabled(e):!!a.isBrowserOfflineEnabled(e)}},bZIc:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return a(t,e),t},o=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(a,i){function o(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((n=n.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var r,n,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(a=2&i[0]?n.return:i[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,i[1])).done)return a;switch(n=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,n=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],n=0}finally{r=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},u=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,a,i=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)o.push(n.value)}catch(e){a={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(a)throw a.error}}return o},c=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(l(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0}),t.PlaybackManager=void 0;var d=r("iiR4"),p=r("7uPY"),f=i(r("8w73")),y=r("rljN"),m=r("9YKP"),h=r("TsR9"),g=r("IMw2"),E=r("nf9M"),b=r("Ln9p"),O=r("+MPC"),v=function(){function e(t,r){this._lastSID=0,this._commandOperationsLength=0,this._hasInCompleteNonCrudCommand=!1,this._hasInCompleteTransaction=!1,this._validateApplicationContextForUpsync(t),this._applicationContext=t,this._tracer=this._applicationContext.TraceManager.getTracer(f.upsyncComponentName),this._offlineLogHelper=new h.OfflineLogHelper(this._applicationContext),e._defaultInstance=this,this._config=r}return e.prototype._validateApplicationContextForUpsync=function(e){var t=e.DataLayerConfiguration.DataProvider,r=e.DataLayerConfiguration.MetadataProvider,n=t&&t.executeMultiple&&t.retrieveMultiple&&t.retrieveSession&&t.saveSession&&t.executeFileImageUpsync,a=r&&r.requestAdditionalMetadataForEntityRecord&&r.retrieveEntity&&r.retrieveEntityAttributes;if(!n||!a||!e.DataLayerConfiguration.StateProvider)throw new O.ErrorStatus("Invalid application context fo playback manager")},e.prototype.getMaxBatchSize=function(){return 10},e.prototype.startPlayback=function(){var t,r,n,a,i,u;return o(this,void 0,void 0,(function(){var o,l,c,d;return s(this,(function(s){switch(s.label){case 0:p.PlaybackBatchManager.overallSyncErrorMessage="",e.syncErrorsCount=0,e.setUpsyncId(),this._lastSID=0,this._tracer.warn(y.addPrefix("OfflineUpSync.PlaybackManager.StartPlayback","Started Upsync")),s.label=1;case 1:return s.trys.push([1,9,,10]),[4,this._InitializeSyncErrorRetryStatus()];case 2:s.sent(),s.label=3;case 3:return s.trys.push([3,5,6,8]),[4,this._ProcessPlayBack()];case 4:return s.sent(),null===(r=null===(t=this._applicationContext.DataLayerConfiguration.DataProvider)||void 0===t?void 0:t.saveSession)||void 0===r||r.call(t,f.syncErrorsFailureKey,e.syncErrorRetryCountMap),this._tracer.warn(y.addPrefix("OfflineUpSync.PlaybackManager.StartPlayback","Total number of Sync Errors is "+Object.keys(e.syncErrorRetryCountMap).length)),[3,8];case 5:throw o=s.sent(),null===(a=null===(n=this._applicationContext.DataLayerConfiguration.DataProvider)||void 0===n?void 0:n.saveSession)||void 0===a||a.call(n,f.syncErrorsFailureKey,e.syncErrorRetryCountMap),o;case 6:return[4,null===(u=null===(i=this._applicationContext.DataLayerConfiguration.DataProvider)||void 0===i?void 0:i.retrieveSession)||void 0===u?void 0:u.call(i,f.lastSuccessfulSaveOnCrmKey)];case 7:return(l=s.sent())&&Object.keys(l).length>0&&(e.lastSuccessfulSaveOnCrm=l[f.lastSuccessfulSaveOnCrmKey]),[7];case 8:return c=!E.IsNullOrUndefined(this._playbackBatchManager)&&this._playbackBatchManager.hasNetworkIssueDuringUpsync?0:g.PlaybackExecutionStatus.success,[2,new m.PlaybackResponse(c,e.syncErrorsCount,e.lastSuccessfulSaveOnCrm)];case 9:throw d=s.sent(),d=O.convertToErrorStatus(d),this._tracer.error(y.addPrefix("OfflineUpSync.PlaybackManager.StartPlayback.Failure",d.message)),d;case 10:return[2]}}))}))},e.prototype.hasItemsToUpsync=function(){return o(this,void 0,void 0,(function(){var e,t;return s(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this._offlineLogHelper.getNorSyncMainLogsOnSID(this._lastSID)];case 1:return e=r.sent(),E.IsNullOrUndefined(e)||!e.length?(this._tracer.warn(y.addPrefix("OfflineUpSync.PlaybackManager.HasPlayBackQueueItems.Success","No Items found for upsync")),[2,!1]):(this._tracer.warn(y.addPrefix("OfflineUpSync.PlaybackManager.HasPlayBackQueueItems.Success","Found items for upsync")),[2,!0]);case 2:throw t=r.sent(),t=O.convertToErrorStatus(t),this._tracer.error(y.addPrefix("OfflineUpSync.PlaybackManager.HasPlayBackQueueItems.Failure",t.message)),t;case 3:return[2]}}))}))},e.prototype._InitializeSyncErrorRetryStatus=function(){var t,r;return o(this,void 0,void 0,(function(){var n;return s(this,(function(a){switch(a.label){case 0:return[4,null===(r=null===(t=this._applicationContext.DataLayerConfiguration.DataProvider)||void 0===t?void 0:t.retrieveSession)||void 0===r?void 0:r.call(t,f.syncErrorsFailureKey)];case 1:return n=a.sent(),e.syncErrorRetryCountMap=E.IsNullOrUndefined(n)?{}:n,[2,!0]}}))}))},e.prototype._ProcessPlayBack=function(){return o(this,void 0,void 0,(function(){var e;return s(this,(function(t){switch(t.label){case 0:this._tracer.warn(y.addPrefix("OfflineUpSync.PlaybackManager._ProcessPlayBack.Success","I Pass Completed")),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,this._StartPass()];case 2:return t.sent()?this._playbackBatchManager.hasNetworkIssueDuringUpsync?(this._tracer.warn(y.addPrefix("OfflineUpSync.PlaybackManager._ProcessPlayBack.NetworkFailure","II Pass Not Started due to Network Issue")),[2,!1]):(this._tracer.warn(y.addPrefix("OfflineUpSync.PlaybackManager._ProcessPlayBack","II Pass Started")),[4,this._StartPass()]):[3,4];case 3:return t.sent(),this._tracer.warn(y.addPrefix("OfflineUpSync.PlaybackManager._ProcessPlayBack.Success","II Pass Completed")),[2,!0];case 4:return this._tracer.warn(y.addPrefix("OfflineUpSync.PlaybackManager._ProcessPlayBack.Success","Completed")),[2,!0];case 5:throw e=t.sent(),e=O.convertToErrorStatus(e),this._tracer.error(y.addPrefix("OfflineUpSync.PlaybackManager._ProcessPlayBack.Failure",e.message)),e;case 6:return[2]}}))}))},e.prototype._StartPass=function(){return o(this,void 0,void 0,(function(){var e;return s(this,(function(t){switch(t.label){case 0:this._tracer.warn(y.addPrefix("OfflineUpSync.PlaybackManager._StartPass","Started")),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,this.hasItemsToUpsync()];case 2:return t.sent()?(this._playbackBatchManager=new p.PlaybackBatchManager(this._offlineLogHelper,this._applicationContext,this._config),[4,this.upSync()]):[3,4];case 3:return t.sent(),this._playbackBatchManager.hasNetworkIssueDuringUpsync?this._tracer.warn(y.addPrefix("OfflineUpSync.PlaybackManager._StartPass.NetworkFaliure","Faliure")):this._tracer.warn(y.addPrefix("OfflineUpSync.PlaybackManager._StartPass.Success","StartPass Finished")),[2,!0];case 4:return this._tracer.warn(y.addPrefix("OfflineUpSync.PlaybackManager._StartPass.Success","StartPass Completed")),[2,!1];case 5:throw e=t.sent(),e=O.convertToErrorStatus(e),this._tracer.error(y.addPrefix("OfflineUpSync.PlaybackManager._StartPass.Failure",e.message)),e;case 6:return[2]}}))}))},e.prototype.upSync=function(){return o(this,void 0,void 0,(function(){var e,t,r;return s(this,(function(n){switch(n.label){case 0:this._tracer.warn(y.addPrefix("OfflineUpSync.PlaybackManager.UpSync","UpSync Started")),(e=[]).push(this._playbackBatchManager.processBatchForUpSync()),e.push(this._PrepareNextBatch()),n.label=1;case 1:return n.trys.push([1,6,,7]),[4,Promise.all(e)];case 2:return n.sent(),this._playbackBatchManager.hasNetworkIssueDuringUpsync?(this._tracer.warn(y.addPrefix("OfflineUpSync.PlaybackManager.UpSync.Warning","NetWork Issue Encountered while upsync")),[2,!1]):this._playbackBatchManager.playbackQueue.length?[3,4]:(this._tracer.warn(y.addPrefix("OfflineUpSync.PlaybackManager.UpSync.Info","ManagePlayBackQueue PlayBack All Remaining Requests Started")),[4,this._playbackBatchManager.processBatchForUpSync()]);case 3:return n.sent(),[2,!0];case 4:return[4,this.upSync()];case 5:return t=n.sent(),this._tracer.warn(y.addPrefix("OfflineUpSync.PlaybackManager.UpSync.Success","ManagePlayBackQueue Finished")),[2,t];case 6:throw r=n.sent(),r=O.convertToErrorStatus(r),this._tracer.error(y.addPrefix("OfflineUpSync.PlaybackManager.UpSync.Failure",r.message)),r;case 7:return[2]}}))}))},e.prototype._PrepareNextBatch=function(){return o(this,void 0,void 0,(function(){var e,t;return s(this,(function(r){switch(r.label){case 0:this._tracer.warn(y.addPrefix("OfflineUpSync.PlaybackManager._PrepareNextBatch","ProcessBatch Started")),r.label=1;case 1:return r.trys.push([1,4,,5]),[4,this._RetrieveBatch(!0)];case 2:return r.sent(),E.IsNullOrUndefined(this._batchLogs)||!this._batchLogs.length?(this._tracer.warn(y.addPrefix("OfflineUpSync.PlaybackManager._PrepareNextBatch.Success","ProcessBatch Completed")),[2,!1]):[4,this._CreateBatchData()];case 3:return e=r.sent(),!E.IsNullOrUndefined(e)&&e.length>0&&(this._tracer.warn(y.addPrefix("OfflineUpSync.PlaybackManager._PrepareNextBatch","Batch Added to PlayBackBatchManager")),this._playbackBatchManager.playbackQueue.push(e)),this._tracer.warn(y.addPrefix("OfflineUpSync.PlaybackManager._PrepareNextBatch.Success","ProcessBatch Finished")),[2,!0];case 4:throw t=r.sent(),t=O.convertToErrorStatus(t),this._tracer.error(y.addPrefix("OfflineUpSync.PlaybackManager._PrepareNextBatch.Failure",t.message)),t;case 5:return[2]}}))}))},e.prototype._PrepareBatchAndValidateBatchReadyforUpSync=function(e){for(var t=0,r=!e;t<this._norSyncMainLogs.length&&(this._batchLogs.length<this.getMaxBatchSize()||r);){var n=y.getTableNameFromNorSyncMainLog(this._norSyncMainLogs[t]),a=y.getEntityNameFromOfflineLogTableName(n);this._batchLogs.push(this._norSyncMainLogs[t]),this._entityList.indexOf(a)<0&&this._entityList.push(a),r?this._hasInCompleteNonCrudCommand?n.toLowerCase()===f.norSyncCommandOperationLog.toLowerCase()?this._commandOperationsLength++:(this._commandOperationsLength--,this._commandOperationsLength<=0&&(r=!1,this._hasInCompleteNonCrudCommand=!1,this._commandOperationsLength=0)):this._hasInCompleteTransaction&&n.toLowerCase()===f.norSyncUpSyncTransactionEndLog.toLowerCase()&&(r=!1,this._hasInCompleteTransaction=!1):n.toLowerCase()===f.norSyncCommandLog.toLowerCase()?(r=!0,this._hasInCompleteNonCrudCommand=!0,this._commandOperationsLength=0):n.toLowerCase()===f.norSyncUpSyncTransactionBeginLog.toLowerCase()&&(r=!0,this._hasInCompleteTransaction=!0),t++}return this._lastSID=this._batchLogs[this._batchLogs.length-1].SID,this._norSyncMainLogs.splice(0,t),r},e.prototype._PrepareEntityLogs=function(){return o(this,void 0,void 0,(function(){var e,t,r,n,a,i,o,l,c,d,p,m,h,g,b;return s(this,(function(s){switch(s.label){case 0:this._tracer.warn(y.addPrefix("OfflineUpSync.PlaybackManager._PrepareEntityLogs","_PrepareEntityLogs Started")),(e=[]).push({name:"LastSID",value:this._lastSID}),this._entityLogMap={},t=[];try{for(r=u(this._entityList),n=r.next();!n.done;n=r.next())(o=n.value)!==y.getEntityNameFromOfflineLogTableName(f.norSyncUpSyncTransactionBeginLog)&&o!==y.getEntityNameFromOfflineLogTableName(f.norSyncUpSyncTransactionEndLog)&&t.push(this._offlineLogHelper.getNorSyncEntityLogsOnSID(this._batchLogs[0].SID,this._lastSID,o))}catch(e){g={error:e}}finally{try{n&&!n.done&&(b=r.return)&&b.call(r)}finally{if(g)throw g.error}}s.label=1;case 1:return s.trys.push([1,3,,4]),[4,Promise.all(t)];case 2:for(a=s.sent(),e.push({name:"NoOfResults",value:a.length}),e.push({name:"EntityListLength",value:this._entityList.length}),this._tracer.warn(y.addPrefix("OfflineUpSync.PlaybackManager.RetrieveEntityLogs.Success","RetrieveEntityLogs Completed"),e),i=0;i<this._entityList.length;i++)if(o=this._entityList[i],E.IsNullOrUndefined(a[i]))e.push({name:"EntityLogicalName",value:o}),this._tracer.error(y.addPrefix("OfflineUpSync.PlaybackManager._PrepareEntityLogs","Entity record from entity log table is null"),e),this._entityLogMap[o]=null;else{for(l=a[i],c={},d=0;d<l.length;d++)p=l[d],(m=p.getValue(f.offlineLogSIdColumnName).toString()in c?c[p.getValue(f.offlineLogSIdColumnName).toString()]:[]).push(p),c[p.getValue(f.offlineLogSIdColumnName).toString()]=m;this._entityLogMap[o]=c}return[2,!0];case 3:throw h=s.sent(),h=O.convertToErrorStatus(h),this._tracer.error(y.addPrefix("OfflineUpSync.PlaybackManager.RetrieveEntityLogs.Failure",h.message),e),h;case 4:return[2]}}))}))},e.prototype._CreateBatchData=function(){return o(this,void 0,void 0,(function(){var e,t,r,n,a,i;return s(this,(function(o){switch(o.label){case 0:for(this._tracer.warn(y.addPrefix("OfflineUpSync.PlaybackManager._CreateBatchData","CreateBatchData Started")),e=[],t=0,r=0,n=!1;t<this._batchLogs.length;)a=y.getTableNameFromNorSyncMainLog(this._batchLogs[t]),n?a.toLowerCase()===f.norSyncCommandOperationLog.toLowerCase()?(r++,t++):(t+=a.toLowerCase()!==f.norSyncBusinessProcessFlowInstanceLog.toLowerCase()||r?r:1,n=!1,r=0):(a.toLowerCase()===f.norSyncCommandLog.toLowerCase()&&(n=!0,r=0),e.push(new d.UpSyncDataBuilder(this._batchLogs,this._entityLogMap,this._applicationContext).createCommandData(t)),t++);o.label=1;case 1:return o.trys.push([1,3,,4]),[4,Promise.all(e)];case 2:return[2,o.sent()];case 3:throw i=o.sent(),i=O.convertToErrorStatus(i),this._tracer.error(y.addPrefix("OfflineUpSync.PlaybackManager._CreateBatchData.Failure",i.message)),i;case 4:return[2]}}))}))},e.prototype._GetBatch=function(e){return o(this,void 0,void 0,(function(){var t,r,n,a;return s(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),(t=[]).push({name:"NumberOfLogsToFetch",value:e}),t.push({name:"LastSID",value:this._lastSID}),[4,this._offlineLogHelper.getNorSyncMainLogsOnSID(this._lastSID)];case 1:return r=i.sent(),t.push({name:"NoOfMainLogsReturned",value:null==r?void 0:r.length}),this._tracer.warn(y.addPrefix("OfflineUpSync.PlaybackManager._GetBatch.Success","GetBatch Completed.")),E.IsNullOrUndefined(this._norSyncMainLogs)?this._norSyncMainLogs=r:(a=this._norSyncMainLogs).push.apply(a,c(r)),[2,!0];case 2:throw n=i.sent(),n=O.convertToErrorStatus(n),this._tracer.warn(y.addPrefix("OfflineUpSync.PlaybackManager._GetBatch.Fail",n.message)),n;case 3:return[2]}}))}))},e.prototype._RetrieveBatch=function(e){return o(this,void 0,void 0,(function(){var t,r;return s(this,(function(n){switch(n.label){case 0:this._tracer.warn(y.addPrefix("OfflineUpSync.PlaybackManager._RetrieveBatch","RetrieveBatch Started.")),e&&(this._batchLogs=[],this._entityList=[]),t=this.getMaxBatchSize(),!E.IsNullOrUndefined(this._norSyncMainLogs)&&this._norSyncMainLogs.length>0&&(t-=this._norSyncMainLogs.length,this._lastSID=this._norSyncMainLogs[this._norSyncMainLogs.length-1].SID),n.label=1;case 1:return n.trys.push([1,7,,8]),[4,this._GetBatch(t)];case 2:return n.sent(),!E.IsNullOrUndefined(this._norSyncMainLogs)&&this._norSyncMainLogs.length?[3,3]:[2,!0];case 3:return this._PrepareBatchAndValidateBatchReadyforUpSync(e)?[4,this._RetrieveBatch(!1)]:[3,5];case 4:return n.sent(),this._tracer.warn(y.addPrefix("OfflineUpSync.PlaybackManager._RetrieveBatch.Force.Success","Force RetrieveBatch Completed.")),[2,!0];case 5:return[4,this._PrepareEntityLogs()];case 6:return n.sent(),this._tracer.warn(y.addPrefix("OfflineUpSync.PlaybackManager._RetrieveBatch.Success","RetrieveBatch Completed.")),[2,!0];case 7:throw r=n.sent(),r=O.convertToErrorStatus(r),this._tracer.error(y.addPrefix("OfflineUpSync.PlaybackManager._RetrieveBatch.Failure",r.message)),r;case 8:return[2]}}))}))},e.setUpsyncId=function(){e._upsyncId=b.Guid.newGuid().guid},e.getUpsyncId=function(){return e._upsyncId},e.get_DefaultInstance=function(){return e._defaultInstance},e.getSkipTables=function(){return[f.norSyncCommandOperationLog,f.norSyncBusinessProcessFlowInstanceLog]},e.IncrementSyncErrorsCount=function(){e.syncErrorsCount+=1},e.syncErrorsCount=0,e.syncErrorRetryCountMap={},e}();t.PlaybackManager=v},bzGb:function(e,t,r){"use strict";r.d(t,"b",(function(){return o})),r.d(t,"a",(function(){return s}));var n=r("7l03"),a=r("dJUv"),i=r("hER9");
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
function o(e){if(Object(n.isNullOrUndefinedOrEmptyString)(e))return e;if(s(e))return e;if(-1!==e.indexOf(i.FETCH_PREFIX)){const t=e.indexOf(i.FETCH_PREFIX),r=decodeURIComponent(e.substring(e.indexOf(i.FETCH_PREFIX)+i.FETCH_PREFIX.length,e.length));return`${e.substring(0,t+i.FETCH_PREFIX.length)}${function(e){const t=new DOMParser,r=new XMLSerializer,n="X";if(e){const a=t.parseFromString(e,"text/xml");if(a){const e=Array.prototype.slice.call(a.getElementsByTagName("condition"));return e&&e.forEach(e=>{e.getAttribute("value")&&e.setAttribute("value",n),e.getAttribute("uiname")&&e.setAttribute("uiname",n);const t=Array.prototype.slice.call(e.getElementsByTagName("value"));t&&t.forEach(e=>{e.getAttribute("uiname")&&e.setAttribute("uiname",n),e.textContent=n})}),r.serializeToString(a)}return null}return null}(r)}`}const t=e.indexOf(a.p.question);if(-1===t){const t=e.indexOf(a.p.equal);return-1===t?e:e.substring(0,t)}return e.substring(0,t)}function s(e){return!Object(n.isNullOrUndefinedOrEmptyString)(e)&&(-1!==e.indexOf("GetClientMetadata")||-1!==e.indexOf("EntityDefinitions")||-1!==e.indexOf("SyncClientMetadata"))}},cXeo:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DataSyncServiceErrorCodes=void 0,function(e){e[e.InvalidSubscription=-2147220969]="InvalidSubscription",e[e.InvalidMetadata=-2147015408]="InvalidMetadata",e[e.AuthenticationError=-2147093995]="AuthenticationError",e[e.InvalidSubscriptionInLoop=-2147015405]="InvalidSubscriptionInLoop",e[e.SyncHandlerNotAvailable=-6]="SyncHandlerNotAvailable"}(t.DataSyncServiceErrorCodes||(t.DataSyncServiceErrorCodes={}))},"cj/A":function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n;Object.defineProperty(t,"__esModule",{value:!0}),t.getPartyListAttributeNames=t.getParticipationTypeMask=t.ParticipationTypeMask=void 0,function(e){e[e.Sender=1]="Sender",e[e.ToRecipient=2]="ToRecipient",e[e.CCRecipient=3]="CCRecipient",e[e.BccRecipient=4]="BccRecipient",e[e.RequiredAttendee=5]="RequiredAttendee",e[e.OptionalAttendee=6]="OptionalAttendee",e[e.Organizer=7]="Organizer",e[e.Regarding=8]="Regarding",e[e.Owner=9]="Owner",e[e.Resource=10]="Resource",e[e.Customer=11]="Customer",e[e.Partner=12]="Partner"}(n||(n={})),t.ParticipationTypeMask=n,t.getPartyListAttributeNames=function(e){switch(e){case"campaignactivity":return["partners","from"];case"fax":return["from","to"];case"email":case"letter":return["from","to","cc","bcc"];case"phonecall":return["from","to"];case"appointment":return["optionalattendees","organizer","requiredattendees"];case"campaignresponse":return["customer","partner","from"];case"recurringappointmentmaster":return["optionalattendees","organizer","requiredattendees"];case"serviceappointment":return["customers","resources"];default:return["bcc","cc","customers","optionalattendees","organizer","requiredattendees","resources","sendermailboxid","to","from"]}},t.getParticipationTypeMask=function(e,t){switch((e+"."+t).toLowerCase()){case"campaignactivity.from":case"campaignresponse.from":case"fax.from":case"email.from":case"letter.from":case"phonecall.from":return n.Sender;case"email.to":case"fax.to":case"letter.to":case"phonecall.to":return n.ToRecipient;case"email.cc":return n.CCRecipient;case"email.bcc":case"letter.bcc":return n.BccRecipient;case"appointment.optionalattendees":case"recurringappointmentmaster.optionalattendees":return n.OptionalAttendee;case"appointment.organizer":case"recurringappointmentmaster.organizer":return n.Organizer;case"appointment.requiredattendees":case"recurringappointmentmaster.requiredattendees":return n.RequiredAttendee;case"campaignresponse.customer":case"serviceappointment.customer":return n.Customer;case"serviceappointment.resources":return n.Resource;case"campaignactivity.partners":case"campaignresponse.partner":return n.Partner;default:return function(e){switch(e){case"bcc":return n.BccRecipient;case"cc":return n.CCRecipient;case"customers":return n.Customer;case"partners":return n.Partner;case"optionalattendees":return n.OptionalAttendee;case"organizer":return n.Organizer;case"requiredattendees":return n.RequiredAttendee;case"resources":return n.Resource;case"sendermailboxid":case"from":return n.Sender;case"to":return n.ToRecipient;case"regarding":return n.Regarding;case"owner":return n.Owner;default:return}}(t)}}},csAi:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.urlEncode=t.xmlEncode=t.xmlAttributeEncode=void 0;var n=r("nf9M");function a(e){return"CRMEntityReferenceOpen"+(1024*(e.charCodeAt(0)-55296)+(1023&e.charCodeAt(1))+65536).toString(16)+"CRMEntityReferenceClose"}function i(e,t){if(n.IsNullOrUndefinedOrEmptyString(e))return e;if("string"!=typeof e&&(e=e),null!=t){t.length>1&&(t=t.charAt(0));var r=o(t),i=new RegExp(t,"g");return e.replace(i,r)}return function(e,t){return(e=(e=t(e=(e=e.replace(new RegExp("([\\uD800-\\uDBFF][\\uDC00-\\uDFFF])","g"),a)).replace(new RegExp("[\\uD800-\\uDFFF]","g"),""))).replace(/CRMEntityReferenceOpen/g,"&#x")).replace(/CRMEntityReferenceClose/g,";")}(e,o)}function o(e){return function(e){var t,r="",n="",a=0;if(null===e)return null;if(""===e)return"";for(var i=0;i<e.length;i++)n+=(t=e.charCodeAt(i))>96&&t<123||t>64&&t<91||32===t||t>47&&t<58||46===t||44===t||45===t||95===t?String.fromCharCode(t):"&#"+t+";",500==++a&&(r+=n,n="",a=0);return n.length&&(r+=n),r}(e)}t.xmlAttributeEncode=function(e){return n.IsNullOrUndefined(e)?"":i(e)},t.xmlEncode=function(e){return n.IsNullOrUndefined(e)?"":i(e)},t.urlEncode=function(e){return""}},cv57:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseFetchXmlForAliasedValues=t.deserializeEntityCollection=t.parseQueryForAliasedValues=void 0;var n=r("nf9M"),a=r("UWtl"),i=r("+Axb"),o=r("vUwf"),s=r("RVOy"),u=r("LTKH"),l=r("UxT/"),c=r("9byC"),d=r("k1iK");function p(e){for(var t={},r={},n=(new DOMParser).parseFromString(e,"text/xml"),a=n.getElementsByTagName("link-entity"),i=0;i<a.length;++i){var o=a[i],u=o.getAttribute("alias"),l=o.getAttribute("name"),c=o.getElementsByTagName("attribute");if(c.length)for(var d=0;d<c.length;++d){var p=c.item(d),f=u+"."+(b=p?p.getAttribute("name"):null),y=u+"_x002e_"+b;t[f]={alias:u,aliasedEtn:l,aliasedValueFieldName:b,oDataAlias:[f,y],oDataSeparator:[".","_x002e_"]},t[y]={alias:u,aliasedEtn:l,aliasedValueFieldName:b,oDataAlias:[y,f],oDataSeparator:["_x002e_","."]},s.addAttributes(r,l,[b])}}var m=n.querySelectorAll("entity > attribute[alias]"),h=n.getElementsByTagName("entity"),g=h&&h[0]?h[0].getAttribute("name"):"";for(i=0;i<m.length;++i){var E=m[i],b=(u=E.getAttribute("alias"),E.getAttribute("name")),O=E.getAttribute("rowaggregate");t[""+b]={alias:u,aliasedValueEtn:g,aliasedValueFieldName:b,oDataAlias:[""+u],oDataSeparator:[""],isAttributeAlias:!0,rowaggregate:O}}return{aliasedValueDescriptors:t,entity2AttributesMap:r}}t.deserializeEntityCollection=function(e,t,r,s,p,f,y,m,h,g){void 0===m&&(m=d.PayloadFormat.OData);var E=t instanceof o.LegacyQuery?null==t?void 0:t.get_EntityLogicalName():null==t?void 0:t.entityLogicalName,b=l.getEntityDescriptor(e,E),O=u.getAttributesForEntity(e,E),v=i.parseXmlDocument(t instanceof o.LegacyQuery?null==t?void 0:t.get_FetchXml():null==t?void 0:t.fetchXml),_=t instanceof o.LegacyQuery?null==t?void 0:t.GetColumnNamesFromFetch():c.getColumnNamesFromFetch(v),T=function(e,t){var r=[];if(t===d.PayloadFormat.SQL&&e.rows&&e.rows.length){r=[];for(var n=0;n<e.rows.length;n++)r.push(e.rows.item(n))}else r=t===d.PayloadFormat.OData&&e&&e.value&&e.value.length?e.value:[];return r}(s,m).map((function(n){return d.createEntityRecordFromResponse(e,n,b,O,_,t instanceof o.LegacyQuery?null==t?void 0:t.get_ColumnSet():c.getColumnSetFromFetch(v),null,r,y,m)}));return function(e,t,r,i,s,u,l){n.IsNullOrUndefined(l)&&(l=e["@Microsoft.Dynamics.CRM.totalrecordcountlimitexceeded"]||!1);l?i=-1:n.IsNullOrUndefined(i)&&(i=e["@Microsoft.Dynamics.CRM.totalrecordcount"]||r.length);n.IsNullOrUndefined(u)&&(u=e["@Microsoft.Dynamics.CRM.morerecords"]);s&&t instanceof o.LegacyQuery&&(null==t||t.set_PagingCookie(s));return new a.EntityCollection(r,u,i,l,t instanceof o.LegacyQuery?t:null)}(s,t,T,p,f,h,g)},t.parseQueryForAliasedValues=function(e){return p(null==e?void 0:e.get_FetchXml())},t.parseFetchXmlForAliasedValues=p},d61F:function(e,t,r){"use strict";r.d(t,"b",(function(){return l})),r.d(t,"c",(function(){return c})),r.d(t,"d",(function(){return d})),r.d(t,"a",(function(){return p})),r.d(t,"f",(function(){return f})),r.d(t,"e",(function(){return y})),r.d(t,"h",(function(){return h})),r.d(t,"g",(function(){return g}));var n=r("8GlG"),a=r("tUL6"),i=r("hER9"),o=r("fKp2"),s=r("bzGb"),u=r("7l03");
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
function l(e,t=[]){return t.concat(e)}function c(e,t,r){t.push({name:i.HEADER.CLIENT_REQUEST_ID,value:Object(u.getClientRequestId)(e)||o.EVENT_PARAMETERS.EMPTY_STRING}),t.push({name:o.EVENT_PARAMETERS.CLIENT_REQUEST_ID,value:Object(u.getClientRequestId)(e)||o.EVENT_PARAMETERS.EMPTY_STRING}),t.push({name:o.EVENT_PARAMETERS.END_POINT,value:e.endpoint||i.UNKNOWN}),t.push({name:o.EVENT_PARAMETERS.METHOD,value:e.method||i.UNKNOWN}),t.push({name:o.EVENT_PARAMETERS.REQUEST_URL,value:Object(s.b)(e.url||"")});const n=Object(u.getClientType)(e);t.push({name:o.EVENT_PARAMETERS.CLIENT_TYPE,value:n}),r=r||Object(a.getRequestType)(e),t.push({name:o.EVENT_PARAMETERS.OPERATION_TYPE,value:""+r})}function d(e,t){const r=e.status||o.EVENT_PARAMETERS.EMPTY_STRING,n=e.statusText||o.EVENT_PARAMETERS.EMPTY_STRING,a=Object(s.b)(e.url)||o.EVENT_PARAMETERS.EMPTY_STRING;if(!Object(u.isNullOrUndefined)(e.headers)){const r=e.headers,n=Object(u.getHttpHeader)(r,i.HEADER.SERVER_REQUEST_ID)||o.EVENT_PARAMETERS.EMPTY_STRING;t.push({name:o.EVENT_PARAMETERS.SERVER_REQUEST_ID,value:n});const a=Object(u.getHttpHeader)(r,i.HEADER.CONTENT_LENGTH)||o.EVENT_PARAMETERS.EMPTY_STRING;t.push({name:o.EVENT_PARAMETERS.RESPONSE_SIZE_IN_BYTES,value:a})}t.push({name:o.EVENT_PARAMETERS.HTTP_STATUS_CODE,value:r}),t.push({name:o.EVENT_PARAMETERS.HTTP_RESPONSE_STATUS_TEXT,value:n}),t.push({name:o.EVENT_PARAMETERS.RESPONSE_URL,value:a})}function p(e,t,r=!1){Object(u.isNullOrUndefined)(e)||(t.push({name:o.EVENT_PARAMETERS.ERROR_CODE,value:e[i.STRING_CONSTANTS.ErrorCode]||o.EVENT_PARAMETERS.EMPTY_STRING}),t.push({name:o.EVENT_PARAMETERS.ERROR_STACK,value:e[i.STRING_CONSTANTS.StackTrace]||e[i.STRING_CONSTANTS.Stack]||o.EVENT_PARAMETERS.EMPTY_STRING}),t.push({name:o.EVENT_PARAMETERS.ERROR_MESSAGE,value:e[i.STRING_CONSTANTS.Message]||o.EVENT_PARAMETERS.EMPTY_STRING}),r&&t.push({name:o.EVENT_PARAMETERS.ERROR_COMPLETE_TEXT,value:JSON.stringify(e)}))}function f(e,t){if(!Object(u.isNullOrUndefined)(e)&&!Object(u.isNullOrUndefined)(e.sqlStatements)){const r=/'\w+.*?\'/g;for(let n=0;n<e.sqlStatements.length;n++){const a=Object(u.isNullOrUndefined)(e.sqlStatements[n])?"":e.sqlStatements[n].replace(r,"'X'");t.push({name:o.EVENT_PARAMETERS.SQL_QUERY+n,value:a})}}}async function y(e,t,r){try{if(r===i.OPERATION.Batch){const r=await Object(n.extractIndividualResponsesFromBatchResponse)(e);for(const n of r)if(!n.ok){m(n,t),d(e,t);break}}else m(e,t),d(e,t);return t}catch(e){return t}}async function m(e,t){const r=await e.text();let n={},a=!1;try{n=JSON.parse(r).error||{},a=Object(s.a)(e.url)}catch(e){n[i.STRING_CONSTANTS.Message]=r}p(n,t,a)}function h(e,t){const r=[];for(const n in t){const a=e.getPerformanceEntry(t[n]);a&&a.performanceMeasure&&a.performanceStatistic&&(1===a.performanceStatistic.count?(r.push({name:t[n]+"-startTime",value:a.performanceMeasure.startTime||0}),r.push({name:t[n]+"-endTime",value:a.performanceMeasure.endTime||0})):a.performanceStatistic.count>1&&(r.push({name:t[n]+"-totalDuration",value:a.performanceStatistic.totalDuration||0}),r.push({name:t[n]+"-averageDuration",value:a.performanceStatistic.averageDuration||0}),r.push({name:t[n]+"-executionCount",value:a.performanceStatistic.count||0})))}return r}function g(e){let t="";try{if(!Object(u.isNullOrUndefinedOrEmptyString)(e)){const r=JSON.parse(e);if(!Object(u.isNullOrUndefinedOrEmpty)(r.results))for(const e of r.results)e.result&&(Array.isArray(e.result)&&e.result.length>0&&!Object(u.isNullOrUndefinedOrEmptyString)(e.result[0].message)?t=t+e.result[0].message+";\n":Object(u.isNullOrUndefinedOrEmptyString)(e.result.message)||(t=t+e.result.message+";\n"))}}catch(r){t=e}return t}},dCSa:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
var n,a;r.r(t),r.d(t,"ConsoleTraceManager",(function(){return s})),function(e){e[e.Off=0]="Off",e[e.Error=1]="Error",e[e.Warning=2]="Warning",e[e.Info=3]="Info",e[e.Verbose=4]="Verbose"}(n||(n={})),function(e){e[e.High=0]="High",e[e.Low=1]="Low"}(a||(a={}));var i=r("fKp2");
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */class o{constructor(e){this._name=e}log(e,t,r){console.log(`${t}: ${String(this._name+"                        ").slice(0,24)} --- ${e} \n ${r?JSON.stringify(r):i.EVENT_PARAMETERS.EMPTY_STRING}`)}warn(e,t){this.log(e,"warn",t)}info(e,t){this.log(e,"info",t)}error(e,t){this.log(e,"error",t)}debug(e,t){this.log(e,"error",t)}getLogLevel(){return n.Info}}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */class s{getTracer(e){return new o(e||i.MDL_COMPONENT_NAME)}getLogLevel(e){return n.Info}setLogLevel(e,t){}addDefaultTransport(e){}setTraceAreas(e){}}},dJUv:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
var n,a;r.d(t,"a",(function(){return i})),r.d(t,"i",(function(){return o})),r.d(t,"v",(function(){return s})),r.d(t,"f",(function(){return u})),r.d(t,"b",(function(){return l})),r.d(t,"j",(function(){return c})),r.d(t,"n",(function(){return d})),r.d(t,"o",(function(){return p})),r.d(t,"q",(function(){return f})),r.d(t,"r",(function(){return y})),r.d(t,"s",(function(){return m})),r.d(t,"p",(function(){return h})),r.d(t,"l",(function(){return g})),r.d(t,"d",(function(){return E})),r.d(t,"h",(function(){return b})),r.d(t,"g",(function(){return O})),r.d(t,"c",(function(){return v})),r.d(t,"e",(function(){return _})),r.d(t,"w",(function(){return T})),r.d(t,"k",(function(){return S})),r.d(t,"m",(function(){return N})),r.d(t,"x",(function(){return C})),r.d(t,"u",(function(){return P})),r.d(t,"t",(function(){return R})),function(e){e[e.Raw=0]="Raw",e[e.Numeric=1]="Numeric",e[e.Label=2]="Label",e[e.Value=3]="Value",e[e.State=4]="State",e[e.Id=5]="Id",e[e.Name=6]="Name",e[e.LogicalName=7]="LogicalName",e[e.AllowedStatusTransitions=8]="AllowedStatusTransitions",e[e.DefaultStatus=9]="DefaultStatus",e[e.Color=10]="Color"}(n||(n={})),function(e){e[e.Unknown=-1]="Unknown",e[e.Boolean=0]="Boolean",e[e.Customer=1]="Customer",e[e.DateTime=2]="DateTime",e[e.Decimal=3]="Decimal",e[e.Double=4]="Double",e[e.Integer=5]="Integer",e[e.Lookup=6]="Lookup",e[e.Memo=7]="Memo",e[e.Money=8]="Money",e[e.Owner=9]="Owner",e[e.PartyList=10]="PartyList",e[e.Picklist=11]="Picklist",e[e.State=12]="State",e[e.Status=13]="Status",e[e.String=14]="String",e[e.UniqueIdentifier=15]="UniqueIdentifier",e[e.CalendarRules=16]="CalendarRules",e[e.Virtual=17]="Virtual",e[e.BigInt=18]="BigInt",e[e.ManagedProperty=19]="ManagedProperty",e[e.EntityName=20]="EntityName",e[e.AliasedValue=21]="AliasedValue",e[e.EntityImage=23]="EntityImage",e[e.MultiSelectPicklist=24]="MultiSelectPicklist",e[e.File=25]="File",e[e.NavigationProperty=26]="NavigationProperty"}(a||(a={}));const i="annotation";var o,s,u;!function(e){e[e.lastFirst=0]="lastFirst",e[e.firstLast=1]="firstLast",e[e.lastFirstMiddleInitial=2]="lastFirstMiddleInitial",e[e.firstMiddleInitialLast=3]="firstMiddleInitialLast",e[e.lastFirstMiddle=4]="lastFirstMiddle",e[e.firstMiddleLast=5]="firstMiddleLast",e[e.lastSpaceFirst=6]="lastSpaceFirst",e[e.lastNoSpaceFirst=7]="lastNoSpaceFirst"}(o||(o={})),function(e){e[e.create=0]="create",e[e.update=1]="update",e[e.delete=3]="delete"}(s||(s={})),function(e){e[e.DateOnly=0]="DateOnly",e[e.DateAndTime=1]="DateAndTime"}(u||(u={}));const l=4406,c=4206,d=4208,p=4209,f=4211,y=4251,m={ASC:"asc",DESC:"desc"},h={dot:".",closeSQBracket:"]",comma:",",doubleQuote:'"',openSQBracket:"[",singleQuote:"'",space:" ",exclamation:"!",equal:"=",question:"?",openParenthesis:"(",closeParenthesis:")",asterisk:"*",dollar:"$",plus:"+"},g={QUICKFIND_START:"/*QuickFindStart*/",QUICKFIND_END:"/*QuickFindEnd*/",SELECT_START:"/*SelectStart*/",SELECT_END:"/*SelectEnd*/",FROM_START:"/*FromStart*/",FROM_END:"/*FromEnd*/",CTE_START:"/*CTEStart*/",CTE_END:"/*CTEEnd*/",WHERE_START:"/*WhereStart*/",WHERE_END:"/*WhereEnd*/",ORDERBY_START:"/*OrderByStart*/",ORDERBY_END:"/*OrderByEnd*/",JOIN_START:"/*JoinStart*/",JOIN_END:"/*JoinEnd*/"},E={PageSize:"25",PageNumber:"1",EmptyString:""},b={SqlTokensAvailable:"UseOfflineSqlTokens",MdlUsesDependencyInformation:"MDLUsesDependencyInformation",ModernDataLayerMatchServerGCM:"ModernDataLayerMatchServerGCM",ModernDataLayerRMValidations:"ModernDataLayerRMValidations",CustomPageOffline:"CustomPageOffline"},O={primaryIdAttribute:"Entity metadata does not have primary id attribute",referencedId:"Missing ID of the referenced entity record.",invalidParameter:"Invalid parameters",invalidHints:"Invalid hint"},v={insert:"INSERT",select:"SELECT",update:"UPDATE",set:"SET",where:"WHERE",delete:"DELETE",orderBy:"ORDER BY",collateNoCase:"COLLATE NOCASE",limit:"LIMIT",offset:"OFFSET",from:"FROM",as:"AS",in:"IN",and:"AND",into:"INTO",values:"VALUES",placeholder:"?"};var _;!function(e){e.on="on",e.onOrAfter="on-or-after",e.onOrBefore="on-or-before",e.yesterday="yesterday",e.today="today",e.tomorrow="tomorrow",e.last7Days="last-seven-days",e.next7Days="next-seven-days",e.lastWeek="last-week",e.thisWeek="this-week",e.nextWeek="next-week",e.lastMonth="last-month",e.thisMonth="this-month",e.nextMonth="next-month",e.lastYear="last-year",e.thisYear="this-year",e.nextYear="next-year",e.lastXDays="last-x-days",e.nextXDays="next-x-days",e.lastXWeeks="last-x-weeks",e.nextXWeeks="next-x-weeks",e.lastXMonths="last-x-months",e.nextXMonths="next-x-months",e.lastXYears="last-x-years",e.nextXYears="next-x-years",e.anyTime="not-null",e.startOfCurrentHourUTC="'!start-of-current-hour-utc!'",e.startOfTodayUTC="'!start-of-today-utc!'",e.startOfWorkWeekUTC="'!start-of-work-week-utc!'",e.startOfMonthUTC="'!start-of-month-utc!'",e.startOfYearUTC="'!start-of-year-utc!'",e.userTimezoneHourOffset="!user-timezone-hour-offset!",e.userTimezoneMinuteOffset="!user-timezone-minute-offset!",e.UTCHourOffset="!utc-hour-offset!",e.UTCMinuteOffset="!utc-minute-offset!"}(_||(_={}));const T='"!eq-userid!"',S={userLanguage:"@LanguageId0",basedLanguage:"@LanguageId1",columnName0:"@ObjectColumnName0",columnName1:"@ObjectColumnName1"},N=[T,S.userLanguage,S.basedLanguage,S.columnName0,S.columnName1,_.startOfCurrentHourUTC,_.startOfTodayUTC,_.startOfYearUTC,_.startOfMonthUTC,_.startOfWorkWeekUTC,_.userTimezoneHourOffset,_.userTimezoneMinuteOffset,_.UTCHourOffset,_.UTCMinuteOffset],C=new RegExp("\\s+","g"),P="INSERT INTO _NORSYNC_SUPPRESS_TRIGGERS(value) VALUES(1)",R="DELETE FROM _NORSYNC_SUPPRESS_TRIGGERS"},dlGf:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(a,i){function o(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((n=n.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var r,n,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(a=2&i[0]?n.return:i[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,i[1])).done)return a;switch(n=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,n=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],n=0}finally{r=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.UpSyncManager=void 0;var i=r("h1w0"),o=r("+MPC"),s=r("4oeN"),u=r("PFOI"),l=r("aAjD"),c=r("8w73"),d=r("JWCx"),p=r("LgaX"),f=function(){function e(e,t){this._applicationContext=e,this._tracer=this._applicationContext.TraceManager.getTracer(c.upsyncComponentName),this._config=t}return e.prototype.upSyncFileOrImage=function(e,t){var r,i;return n(this,void 0,void 0,(function(){var n,s;return a(this,(function(a){switch(a.label){case 0:n=e[0],a.label=1;case 1:return a.trys.push([1,3,,4]),[4,null===(i=null===(r=this._applicationContext.DataLayerConfiguration.DataProvider)||void 0===r?void 0:r.executeFileImageUpsync)||void 0===i?void 0:i.call(r,n.entityRecord,t)];case 2:return[2,a.sent()];case 3:throw s=a.sent(),s=o.convertToErrorStatus(s),t.push({name:c.UpsyncParameters.errorMessage,value:s.message}),this._tracer.error("Upsync.FileOrImageRequestExecution.Failed",t),s;case 4:return[2]}}))}))},e.prototype.upSync=function(e,t,r,i){var d,p;return n(this,void 0,void 0,(function(){var n,f,y,m,h,g;return a(this,(function(a){switch(a.label){case 0:i.push({name:"NoOfCommands",value:null==e?void 0:e.length}),i.push({name:"CommandType",value:r}),i.push({name:"IsTransactionBatch",value:t}),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this._constructODataRequest(e,!t,r,this._applicationContext,this._config)];case 2:return n=a.sent(),[3,4];case 3:throw f=a.sent(),f=o.convertToErrorStatus(f),i.push({name:c.UpsyncParameters.errorMessage,value:f.message}),this._tracer.error("Upsync.ConstructRequest.Failed",i),f;case 4:return a.trys.push([4,6,,7]),y=s.LegacyGuid.newGuid().toString(),i.push({name:c.UpsyncParameters.clientRequestId,value:y}),(m={}).OperationSource="Upsync",[4,null===(p=null===(d=this._applicationContext.DataLayerConfiguration.DataProvider)||void 0===d?void 0:d.executeMultiple)||void 0===p?void 0:p.call(d,n,u.RetrievalStrategy.Remote,m,new l.UCIContext(y))];case 5:return h=a.sent(),this._tracer.warn("Upsync.RequestExecution succeeded",i),[2,h];case 6:throw g=a.sent(),g=o.convertToErrorStatus(g),i.push({name:c.UpsyncParameters.errorMessage,value:g.message}),this._tracer.error("Upsync.RequestExecution.Failed",i),g;case 7:return[2]}}))}))},e.get_instance=function(t,r){return e._defaultInstance||(e._defaultInstance=new e(t,r)),e._defaultInstance},e.prototype._constructODataRequest=function(e,t,r,n,a){return r===d.CommandType.crud?i.constructODataRequestForCUD(e,t,this._applicationContext,a):p.constructODataRequestForNonCUD(e[0],n)},e}();t.UpSyncManager=f},dozL:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.ODataRequestType=t.RETRIEVE_GRID_DATA=t.PREFIX=t.MDL_COMPONENT_NAMES=t.MDL_ID=void 0,t.MDL_ID="ModernDataLayer",t.MDL_COMPONENT_NAMES={ODataBuilder:t.MDL_ID+".ODataBuilder",ModernDataSource:t.MDL_ID+".ModernDataSource",ExpressionRuntime:t.MDL_ID+".ExpressionRuntime",QueryBuilder:t.MDL_ID+".QueryBuilder",UserContext:t.MDL_ID+".UserContext",AuthenticationProvider:t.MDL_ID+".AuthenticationProvider",ModernDataSourceGCM:t.MDL_ID+".ModernDataSourceGCM"},t.PREFIX={ODataBuilder:"ODataBuilder",ModernDataSource:"ModernDataSource",ExpressionRuntimeHost:"ExpressionRuntimeHost",ModernQueryBuilder:"ModernQueryBuilder"},t.RETRIEVE_GRID_DATA="RetrieveGridData",function(e){e.Create="Create",e.Update="Update",e.Delete="Delete",e.DeleteWithUrlParams="DeleteWithUrlParams",e.Retrieve="Retrieve",e.RetrieveWithUrlParams="RetrieveWithUrlParams"}(t.ODataRequestType||(t.ODataRequestType={}))},e3CE:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NodeSnapshotWrapper=void 0;var n=r("kgGf"),a=r("T+vN"),i=r("nf9M"),o=function(){function e(e,t,r){if(n.assert(!i.IsNullOrUndefined(e),"XPathEvaluator should not be null"),n.assert(!i.IsNullOrUndefined(t),"Node list obj should not be null"),this._list=[],t instanceof XPathResult)for(var o=t,s=0;s<o.snapshotLength;s++)this._list.push(new a.XPathEvaluatorWrapper(e,o.snapshotItem(s),r));else{var u=t;for(s=0;s<u.length;s++)this._list.push(new a.XPathEvaluatorWrapper(e,u[s],r))}}return e.prototype.get_count=function(){return this._list.length},e.prototype.get_item=function(e){return this._list[e]},e}();t.NodeSnapshotWrapper=o},e5ro:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(a,i){function o(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((n=n.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var r,n,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(a=2&i[0]?n.return:i[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,i[1])).done)return a;switch(n=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,n=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],n=0}finally{r=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.SuccessHandler=void 0;var i=r("frZE"),o=r("8w73"),s=r("nf9M"),u=function(){function e(e,t){this._offlineLogHelper=e,this._applicationContext=t}return e.prototype.handle=function(e,t){return n(this,void 0,void 0,(function(){var t,r,n;return a(this,(function(a){switch(a.label){case 0:return e.commandType?(t=e.command,s.IsNullOrUndefined(t)?[3,2]:(r=[],n=this._offlineLogHelper.updateCommandStatus(t,i.CommandStatus.completed),r.push(n),[4,this._offlineLogHelper.performOperations(r,!0)])):(this._SetLastSuccessfulSaveOnCrmKey(),[2,!0]);case 1:return a.sent(),this._SetLastSuccessfulSaveOnCrmKey(),[2,!0];case 2:return[2,!1]}}))}))},e.prototype._SetLastSuccessfulSaveOnCrmKey=function(){var e,t,r=new Date,n={};n[o.lastSuccessfulSaveOnCrmKey]=r.toString(),null===(t=null===(e=this._applicationContext.DataLayerConfiguration.DataProvider)||void 0===e?void 0:e.saveSession)||void 0===t||t.call(e,o.lastSuccessfulSaveOnCrmKey,n)},e}();t.SuccessHandler=u},eDM3:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.REMOVE_ENTITY_RECORD_ACTION=t.REFRESH_RECORD_DATA_ACTION=t.RETRIEVE_RECORD_DATA_ACTION=t.RETRIEVE_LOOKUP_DATA_ACTION=t.GET_CLIENT_METADATA=t.GC_REMOVE_DATA_ACTION=t.RETRIEVE_ENTITY_METADATA=t.RETRIEVE_GRID_DATA_ACTION=void 0,t.RETRIEVE_GRID_DATA_ACTION="retrieve.grid.data.action",t.RETRIEVE_ENTITY_METADATA="retrieve.entity.metadata",t.GC_REMOVE_DATA_ACTION="gc.remove.data.action",t.GET_CLIENT_METADATA="get.client.metadata",t.RETRIEVE_LOOKUP_DATA_ACTION="retrieve.lookup.data.action",t.RETRIEVE_RECORD_DATA_ACTION="retrieve.record.data.action",t.REFRESH_RECORD_DATA_ACTION="refresh.record.data.action",t.REMOVE_ENTITY_RECORD_ACTION="remove.entity.record.action"},f7K7:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.ODataDeleteWithUrlParamsRequest=t.ODataExecuteMultipleRequest=t.ODataRetrieveWithUrlParamsRequest=t.ODataRetrieveRequest=t.ODataDeleteRequest=t.ODataUpdateRequest=t.ODataCreateRequest=void 0;var o=i(r("fzfk")),s=function(){function e(e,t,r,n,a,i){void 0===r&&(r=!0),void 0===n&&(n=!1),this.etn=e,this.payload=t,this.suppressDupeDetection=r,this.returnRowVersion=n,this.offlineData=a,this.solutionUniqueName=i}return e.prototype.getMetadata=function(){return{boundParameter:void 0,parameterTypes:{},operationName:"Create",operationType:o.ODataOperationType.CRUD}},e}();t.ODataCreateRequest=s;var u=function(){function e(e,t,r,n,a,i,o,s,u,l,c){this.etn=e,this.id=t,this.payload=r,this.urlParams=n,this.headers=a,this.isBinaryPayload=i,this.suppressDupeDetection=o,this.ifMatch=s,this.returnRowVersion=u,this.offlineData=l,this.solutionUniqueName=c}return e.prototype.getMetadata=function(){return{boundParameter:void 0,parameterTypes:{},operationName:"Update",operationType:o.ODataOperationType.CRUD}},e}();t.ODataUpdateRequest=u;var l=function(){function e(e,t,r,n){this.entityReference=e,this.attributeName=t,this.ifMatch=r,this.offlineData=n}return e.prototype.getMetadata=function(){return{boundParameter:void 0,parameterTypes:{entityReference:{typeName:"mscrm.crmbaseentity",structuralProperty:o.ODataStructuralProperty.EntityType}},operationName:"Delete",operationType:o.ODataOperationType.CRUD}},e}();t.ODataDeleteRequest=l;var c=function(){function e(e,t,r){this.entityReference=e,this.columns=t,this.navigationPropertyDetails=r}return e.prototype.getMetadata=function(){return{boundParameter:void 0,parameterTypes:{},operationName:"Retrieve",operationType:o.ODataOperationType.CRUD}},e}();t.ODataRetrieveRequest=c;var d=function(){function e(e,t,r,n,a){this.etn=e,this.id=t,this.urlParams=r,this.headers=n,this.maxPageSize=a}return e.prototype.getMetadata=function(){return{boundParameter:void 0,parameterTypes:{},operationName:"RetrieveWithUrlParams",operationType:o.ODataOperationType.CRUD}},e}();t.ODataRetrieveWithUrlParamsRequest=d;var p=function(){function e(e,t){void 0===t&&(t=!1),this.requests=e,this.continueOnError=t}return e.prototype.getMetadata=function(){return{boundParameter:void 0,parameterTypes:{},operationName:"ExecuteMultiple",operationType:o.ODataOperationType.ExecuteMultiple}},e}();t.ODataExecuteMultipleRequest=p;var f=function(){function e(e,t,r,n,a){this.etn=e,this.id=t,this.urlParams=r,this.ifMatch=n}return e.prototype.getMetadata=function(){return{boundParameter:void 0,parameterTypes:{},operationName:"DeleteWithUrlParams",operationType:o.ODataOperationType.CRUD}},e}();t.ODataDeleteWithUrlParamsRequest=f},fKp2:function(e,t,r){"use strict";r.r(t),r.d(t,"MDL_COMPONENT_NAME",(function(){return n})),r.d(t,"FILE_PREFIX",(function(){return a})),r.d(t,"COMPONENT_NAMES",(function(){return i})),r.d(t,"EVENT_PARAMETERS",(function(){return o})),r.d(t,"ScenarioType",(function(){return s}));
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
const n="ModernDataLayer",a={GetSqlResults:"GetSqlResults",MetadataCache:"MetadataCache",MetadataStateAccessor:"MetadataStateAccessor",MetadataUtil:"MetadataUtil",SQLGenerator:"SQLGenerator",PolicyManager:"PolicyManager",PromiseCache:"PromiseCache",CreateResponseHandler:"CreateResponseHandler",DeleteResponseHandler:"DeleteResponseHandler",GetClientMetadataResponseHandler:"GetClientMetadataResponseHandler",UpdateResponseHandler:"UpdateResponseHandler",RetrieveResponseHandler:"RetrieveResponseHandler",BatchResponseHandler:"BatchResponseHandler",BPFResponseHandler:"BPFResponseHandler",RetrieveMultipleResponseHandler:"RetrieveMultipleResponseHandler",FileExecutor:"FileExecutor",QueryGenerator:"QueryGenerator",ResponseHandler:"ResponseHandler",SQLExecutor:"SQLExecutor",UrlParserHandler:"UrlParserHandler",LocalODataClientManager:"LocalODataClientManager",ODataClientManager:"ODataClientManager",ODataExecutor:"ODataExecutor",DeleteGenerator:"DeleteGenerator",RetrieveMultipleGenerator:"RetrieveMultipleGenerator",SQLModifier:"SQLModifier",UpdateGenerator:"UpdateGenerator",PolicyRetryInterceptor:"PolicyRetryInterceptor",TimeoutInterceptor:"TimeoutInterceptor",ExecuteRequestInterceptor:"ExecuteRequestInterceptor",RequestResponseInterceptor:"RequestResponseInterceptor",LongRequestInterceptor:"LongRequestInterceptor",FileRequestInterceptor:"FileRequestInterceptor",SQLRequestInterceptor:"SQLRequestInterceptor",HttpExecutorInterceptor:"HttpExecutorInterceptor",PromiseCacheInterceptor:"PromiseCacheInterceptor",GCMGenerator:"GCMGenerator",Common:"Common",BatchRequestParser:"BatchRequestParser",RootFinder:"RootFinder",MetadataSQLExecutor:"MetadataSQLExecutor",DataSQLExecutor:"DataSQLExecutor",CreateGenerator:"CreateGenerator",BatchGenerator:"BatchGenerator",QuickFindSQLGenerator:"QuickFindSQLGenerator",MergeQuickFindSQLGenerator:"MergeQuickFindSQLGenerator",RetrieveGenerator:"RetrieveGenerator",ApplyFilterSQLGenerator:"ApplyFilterSQLGenerator",ApplyFinalModifiedSQLGenerator:"ApplyFinalModifiedSQLGenerator",ApplySelectSQLGenerator:"ApplySelectSQLGenerator",ApplyOrderBySQLGenerator:"ApplyOrderBySQLGenerator",ApplyLinkEntitySQLGenerator:"ApplyLinkEntitySQLGenerator",ApplyContextFilterSQLGenerator:"ApplyContextFilterSQLGenerator",CloneRequest:"CloneRequest",FetchRequest:"FetchRequest",GenerateBaseSQL:"GenerateBaseSQL",DetermineHints:"DetermineHints",ODataQueryParser:"ODataQueryParser",ExpandParser:"ExpandParser",FetchXmlParser:"FetchXmlParser",DateTimeOperators:"DateTimeOperators",Validator:"Validator"},i={ODataExecutor:`${n}.${a.ODataExecutor}`,RemoteODataExecutor:n+".RemoteODataExecutor",LocalODataExecutor:n+".LocalODataExecutor",SQLExecutor:`${n}.${a.SQLExecutor}`,FileExecutor:`${n}.${a.FileExecutor}`,SQLGenerator:`${n}.${a.QueryGenerator}`,ResponseHandler:`${n}.${a.ResponseHandler}`,UrlParserHandler:`${n}.${a.UrlParserHandler}`,MetadataCache:`${n}.${a.MetadataCache}`},o={HTTP_STATUS_CODE:"HTTP-Status-Code",HTTP_RESPONSE_TYPE:"HTTP-Response-Type",HTTP_RESPONSE_STATUS_TEXT:"HTTP-Response-Status-Text",RESPONSE_URL:"Response-Url",RESPONSE_SIZE_IN_BYTES:"Response-Size-In-Bytes",ERROR_CODE:"Error-Code",ERROR_MESSAGE:"Error-Message",ERROR_STACK:"Error-Stack",ERROR_COMPLETE_TEXT:"Error-Complete-Text",CLIENT_TYPE:"Client-Type",RESPONSE_TIME:"Response-Time",CLIENT_REQUEST_ID:"Client-Request-Id",SERVER_REQUEST_ID:"Server-Request-Id",OPERATION_TYPE:"Operation-Type",OPERATION_SUB_TYPE:"Operation-SubType",OPERATION_SOURCE:"Operation-Source",END_POINT:"EndPoint",METHOD:"Method",EMPTY_STRING:"",SQL_ERROR_CODE:"SqlErrorCode",SQL_ERROR_MESSAGE:"SqlErrorMessage",REQUEST_URL:"Request-Url",BASE_OFFLINE_SQL:"BaseOfflineSQL",ENTITY_NAME:"Entity-Name",IS_OFFLINE_BY_DEFAULT_REQUEST:"Is-Offline-By-Default-Request",EXECUTION_HINT:"Execution_Hint",SQL_QUERY:"SqlQuery",ERROR_DETAIL:"Error-Detail",METADATA_CACHE_OPERATION:"Metadata-Cache-Operation",STATE_TREE_ACCESS:"State-Tree-Access"};var s;!function(e){e.Create="Create",e.Delete="Delete",e.Load="Load",e.Update="Update"}(s||(s={}))},fnSt:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
var n;r.r(t),r.d(t,"DateTimeFieldBehavior",(function(){return n})),function(e){e[e.None=0]="None",e[e.UserLocal=1]="UserLocal",e[e.DateOnly=2]="DateOnly",e[e.TimeZoneIndependent=3]="TimeZoneIndependent"}(n||(n={}))},frZE:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CommandStatus=void 0,function(e){e[e.draft=0]="draft",e[e.inProgress=1]="inProgress",e[e.completed=2]="completed",e[e.failed=3]="failed"}(t.CommandStatus||(t.CommandStatus={}))},fzfk:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.ODataOperationType=t.ODataStructuralProperty=void 0,function(e){e[e.Unknown=0]="Unknown",e[e.PrimitiveType=1]="PrimitiveType",e[e.ComplexType=2]="ComplexType",e[e.EnumerationType=3]="EnumerationType",e[e.Collection=4]="Collection",e[e.EntityType=5]="EntityType"}(t.ODataStructuralProperty||(t.ODataStructuralProperty={})),function(e){e[e.Action=0]="Action",e[e.Function=1]="Function",e[e.CRUD=2]="CRUD",e[e.ExecuteMultiple=3]="ExecuteMultiple"}(t.ODataOperationType||(t.ODataOperationType={}))},"g/kV":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ClientRetrieveOptions=void 0;var n=r("0Xad"),a=r("PFOI"),i=r("nf9M"),o=function(){function e(e,t,r){this._cachePriority=0,this._retrievalStrategy=0,this._cachePriority=e,this._retrievalStrategy=t,this._timestamp=r||new Date}return e.prototype.get_timestamp=function(){return this._timestamp},e.prototype.get_cachePriority=function(){return this._cachePriority},e.prototype.set_cachePriority=function(e){return this._cachePriority=e,e},e.prototype.get_retrievalStrategy=function(){return this._retrievalStrategy},e.prototype.set_retrievalStrategy=function(e){return this._retrievalStrategy=e,e},e.prototype.get_sortableTimestamp=function(){return e.getSortableString(this._timestamp)},e.prototype.getObjectData=function(){var t={};return t[e.timestampPath]=this.get_sortableTimestamp(),t.priority_timestamp=e.priorityTimestampKey(this._cachePriority,this._timestamp),t},e.prototype.update=function(e){i.IsNullOrUndefined(e)||(this._timestamp=e._timestamp,e._cachePriority<this._cachePriority&&(this._cachePriority=e._cachePriority))},e.shouldBeCached=function(e){return!i.IsNullOrUndefined(e)&&e.get_cachePriority()!==n.CachePriority.NotCached},e.getSortableString=function(e){return e.toDateString()},e.priorityTimestampKey=function(t,r){return t+"|"+e.getSortableString(r)},e.createFromObjectData=function(t){var r=new Date(t[e.timestampPath]);return new e(+t.priority_timestamp.substr(0,1),a.RetrievalStrategy.LocalAndRemote,r)},e.timestampPath="timestamp",e.embeddedPriorityTimestampPath="clientretrieveoptions.priority_timestamp",e}();t.ClientRetrieveOptions=o},ghob:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.shouldCacheMetadataRequest=void 0;var n=r("ZKH/"),a=r("vf6J");t.shouldCacheMetadataRequest=function(e,t){return e!==n.MetadataType.BusinessProcessFlow&&e!==n.MetadataType.MetadataVersion&&e!==n.MetadataType.UserMetadataVersion&&t!==a.LegacyDependencyDepth.UserContext}},gpz4:function(e,t,r){"use strict";r.d(t,"b",(function(){return s})),r.d(t,"a",(function(){return u}));var n=r("d61F"),a=r("hER9"),i=r("7l03"),o=r("fKp2");
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
async function s(e,t,r,n=[],s={},u={}){const c=e.TraceManager.getTracer(o.COMPONENT_NAMES.MetadataCache),d=[...n];c.info(l()+" Starting getSqlResults",d);let p={sqlStatements:[],sqlParameters:new Array,additionalParameters:u};return p.sqlStatements.push(t),p.sqlParameters.push(r),p=Object(i.addClientRequestIdToSqlQueryRequests)(p,s,c),e.SqlExecutor.executeSqlStatementsOnMetadataDB(p).then(e=>{var t,r,n,a;return c.info(l()+" Completed getSqlResults"),(Object(i.isNullOrUndefinedOrEmpty)(e)||!(null===(t=e[0])||void 0===t?void 0:t.rows)||(null===(r=e[0])||void 0===r?void 0:r.rows.length)<=0)&&d.push({name:"ExecuteSQLQuery",value:p.sqlStatements.toString()}),Object(i.isNullOrUndefinedOrEmpty)(e)?c.warn(l()+" executeSqlStatementOnMetadataDB returned no result in getSqlResults.",d):(!(null===(n=e[0])||void 0===n?void 0:n.rows)||(null===(a=e[0])||void 0===a?void 0:a.rows.length)<=0)&&c.warn(l()+" executeSqlStatementOnMetadataDB returned 0 rows getSqlResults.",d),e}).catch(e=>{const t=Object(i.convertErrorToLocalError)(e);return d.push({name:a.STRING_CONSTANTS.Message,value:t.message}),d.push({name:a.STRING_CONSTANTS.ErrorCode,value:t.code?t.code:a.UNKNOWN}),d.push({name:a.STRING_CONSTANTS.StackTrace,value:t.stack?t.stack:a.UNKNOWN}),c.error(`${l()} Exception in getSqlResults. Error message = ${e.message}`,d),Promise.reject(t)})}async function u(e,t,r={}){const s=e.TraceManager.getTracer(o.COMPONENT_NAMES.MetadataCache),u=r.commonEventParameters||[],c=[];return t=Object(i.addClientRequestIdToSqlQueryRequests)(t,r,s),c.push({name:"NoOfSQLStatements",value:t&&t.sqlStatements?t.sqlStatements.length:0}),s.info(l()+" Starting getBatchSqlResults. ",Object(n.b)(u,c)),e.SqlExecutor.executeSqlStatementsOnMetadataDB(t).then(e=>(s.info(l()+" Completed getBatchSqlResults",Object(n.b)(u,c)),Object(i.isNullOrUndefinedOrEmpty)(e)&&s.warn(l()+" getBatchSqlResults return empty result",Object(n.b)(u,c)),e)).catch(e=>{const t=Object(i.convertErrorToLocalError)(e);return c.push({name:a.STRING_CONSTANTS.Message,value:t.message}),c.push({name:a.STRING_CONSTANTS.ErrorCode,value:t.code?t.code:a.UNKNOWN}),c.push({name:a.STRING_CONSTANTS.StackTrace,value:t.stack?t.stack:a.UNKNOWN}),s.error(`${l()} Exception in getBatchSqlResults. Error message = ${e.message}`,Object(n.b)(u,c)),Promise.reject(t)})}function l(e){return e?`[${e}]`:`[${o.FILE_PREFIX.GetSqlResults}]`}},h1w0:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(a,i){function o(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((n=n.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var r,n,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(a=2&i[0]?n.return:i[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,i[1])).done)return a;switch(n=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,n=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],n=0}finally{r=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},i=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},o=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,a,i=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)o.push(n.value)}catch(e){a={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(a)throw a.error}}return o},s=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(o(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0}),t.constructODataRequestForCUD=void 0;var u=r("TsoX"),l=r("f7K7"),c=r("x0cL"),d=r("D7ZV"),p=r("7ABV"),f=r("YIL4");function y(e,t,r){var i,o,s,y,m,h;return n(this,void 0,void 0,(function(){var n,g,E,b,O,v,_,T,S,N,C,P,R;return a(this,(function(a){switch(a.label){case 0:if(g=e.entityRecord,E=e.sqlOperation,!g)throw new Error("Cannot process crud upsync without entity record");return b=g.get_identifier().LogicalName,[4,null===(o=null===(i=t.DataLayerConfiguration.MetadataProvider)||void 0===i?void 0:i.retrieveEntity)||void 0===o?void 0:o.call(i,b)];case 1:return O=a.sent(),v=(null==O?void 0:O.PrimaryIdAttribute)||b+"id",(R={})[v]=g.get_identifier().Id.toString(),_=R,T="",S={},N=!1,E!==f.SQLOperationType.Update&&E!==f.SQLOperationType.Delete||(C=(null==O?void 0:O.IsOptimisticConcurrencyEnabled)&&r?u.ConcurrencyBehavior.IfRowVersionMatches:u.ConcurrencyBehavior.Default,T=p.extractIfMatchHeaderForConcurrency(C,g.getValue("versionnumber"))),E!==f.SQLOperationType.Update&&E!==f.SQLOperationType.Create?[3,4]:g.isDirty()?[4,null===(y=null===(s=t.DataLayerConfiguration.MetadataProvider)||void 0===s?void 0:s.requestAdditionalMetadataForEntityRecord)||void 0===y?void 0:y.call(s,g)]:[3,3];case 2:a.sent(),P=null===(h=null===(m=t.DataLayerConfiguration.StateProvider)||void 0===m?void 0:m.getStore)||void 0===h?void 0:h.call(m).getState(),S=d.buildEntityPayload(P,g),a.label=3;case 3:N=!0,e.entityPayload=S,a.label=4;case 4:switch(E){case f.SQLOperationType.Update:n=new l.ODataUpdateRequest(g.get_identifier().LogicalName,g.get_identifier().Id.toString(),S,null,null,void 0,void 0,T,N,_);break;case f.SQLOperationType.Delete:n=new l.ODataDeleteRequest(c.EntityReference.legacyToExternalEntityReference(g.get_identifier()),void 0,T,_);break;case f.SQLOperationType.Create:n=new l.ODataCreateRequest(g.get_identifier().LogicalName,S,void 0,N,_);break;default:throw new Error("unexpected operation type")}return[2,n]}}))}))}t.constructODataRequestForCUD=function(e,t,r,o){return n(this,void 0,void 0,(function(){var n,u,c,d,p,f,m,h,g;return a(this,(function(a){switch(a.label){case 0:n=[],u=[];try{for(c=i(e),d=c.next();!d.done;d=c.next())p=d.value,f=p,u.push(y(f,r,o.isConflictDetectionEnabled))}catch(e){h={error:e}}finally{try{d&&!d.done&&(g=c.return)&&g.call(c)}finally{if(h)throw h.error}}return[4,Promise.all(u)];case 1:return m=a.sent(),n.push.apply(n,s(m)),[2,new l.ODataExecuteMultipleRequest(n,t)]}}))}))}},hER9:function(e,t,r){"use strict";r.r(t),r.d(t,"OPERATION",(function(){return n})),r.d(t,"HTTP_REQUEST_METHOD",(function(){return a})),r.d(t,"SQLQuerySupportedList",(function(){return i})),r.d(t,"FileQuerySupportedList",(function(){return o})),r.d(t,"HTTP_STATUS_CODES",(function(){return s})),r.d(t,"HTTP_STATUS_TEXTS",(function(){return u})),r.d(t,"UNEXPECTED_STATUS_CODE",(function(){return l})),r.d(t,"ADDITIONAL_PARAMETERS",(function(){return c})),r.d(t,"HINT",(function(){return d})),r.d(t,"HEADER",(function(){return p})),r.d(t,"HEADER_VALUES",(function(){return f})),r.d(t,"ErrorCode",(function(){return y})),r.d(t,"APP_ENTITY",(function(){return m})),r.d(t,"WEB_API_URL_FRAGMENT",(function(){return h})),r.d(t,"STRING_CONSTANTS",(function(){return g})),r.d(t,"COMPOSITE_INDEX_DELIMITER",(function(){return E})),r.d(t,"UNKNOWN",(function(){return b})),r.d(t,"CLIENT_TYPE",(function(){return O})),r.d(t,"EXECUTION_HINTS",(function(){return v})),r.d(t,"EXPAND_VALUES",(function(){return _})),r.d(t,"EXPAND_PROPERTIES",(function(){return T})),r.d(t,"FILE_ATTACHMENT",(function(){return S})),r.d(t,"DEVICE_FILE_PATH",(function(){return N})),r.d(t,"DEVICE_THUMBNAIL_PATH",(function(){return C})),r.d(t,"IMAGE_DESCRIPTOR",(function(){return P})),r.d(t,"IMAGE_DESCRIPTOR_ID",(function(){return R})),r.d(t,"FILE_NAME",(function(){return w})),r.d(t,"FETCH_PREFIX",(function(){return M})),r.d(t,"norSyncMainLogTableName",(function(){return I})),r.d(t,"offlineOnlyTables",(function(){return A})),r.d(t,"offlineLogPrefix",(function(){return D}));
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
const n={Create:"Create",Batch:"Batch",Retrieve:"Retrieve",RetrieveMultiple:"RetrieveMultiple",GetClientMetadata:"GetClientMetadata",Update:"Update",Delete:"Delete",Download:"Download",Upload:"Upload",FileDelete:"FileDelete"},a={Post:"POST",Get:"GET",Patch:"PATCH",Delete:"DELETE"},i=[n.Create,n.Delete,n.Batch,n.GetClientMetadata,n.Update,n.Retrieve,n.RetrieveMultiple],o=[n.Download,n.Upload,n.FileDelete],s={Ok:200,Accepted:202,NoContent:204,PartialContent:206,BadRequest:400,Unauthorized:401,NotFound:404,Unknown:420,InternalServerError:500,ServiceUnavailable:503},u={[s.Ok]:"OK",[s.Accepted]:"Accepted",[s.NoContent]:"No Content",[s.PartialContent]:"Partial Content",[s.BadRequest]:"Bad Request",[s.Unauthorized]:"Bad Request",[s.NotFound]:"Not Found",[s.Unknown]:"Unknown",[s.InternalServerError]:"Internal Server Error",[s.ServiceUnavailable]:"Service Unavailable"},l=[s.BadRequest,s.InternalServerError,s.NotFound,s.ServiceUnavailable],c={RecordId:"RecordId",PageSize:"PageSize",PageNumber:"PageNumber",MetadataTypes:"MetadataTypes",Top:"Top",Expand:"Expand",ODataQuery:"ODataQuery",FetchXmlQuery:"FetchXmlQuery",MaxPageSize:"MaxPageSize"},d={select:"x-ms-mdl-select",pageSize:"x-ms-mdl-pageSize",pageNumber:"x-ms-mdl-pageNumber",filter:"x-ms-mdl-filter",linkEntity:"x-ms-mdl-link",viewId:"x-ms-mdl-viewId",rawFetch:"x-ms-mdl-rawFetchXml",mergeQuickFind:"x-ms-mdl-mergeQuickFind",contextFilter:"x-ms-mdl-contextFilter",executionStrategy:"x-ms-mdl-execution-hints",search:"x-ms-mdl-search",orderBy:"x-ms-mdl-orderby",MIME_TYPE:"x-ms-mdl-mimeType",FILE_SIZE:"x-ms-mdl-fileSize",FILE_URL:"x-ms-mdl-fileUrl",SUPPRESS_TRIGGERS_HINT:"x-ms-mdl-suppress-triggers",UPSYNC_REQUEST_HINT:"x-ms-mdl-upsync-request",ETN_NAME:"x-ms-mdl-etn-name"},p={ACCEPT:"Accept",PREFER:"Prefer",AUTO_DISASSOCIATE:"AutoDisassociate",IF_MATCH:"If-match",MSCRM_SUPPRESS_DUPLICATION_DETECTION:"MSCRM.SuppressDuplicateDetection",MSCRM_RETURN_NOTIFICATIONS:"MSCRM.ReturnNotifications",APP_ENTITY:"appmodules",AUTHORIZATION:"Authorization",CONTENT_TYPE:"Content-Type",ODADTA_ENTITY_ID:"OData-EntityId",CONTENT_LENGTH:"Content-Length",CLIENT_REQUEST_ID:"x-ms-client-request-id",SERVER_REQUEST_ID:"x-ms-service-request-id",SESSION_ID:"x-ms-client-session-id",CORRELATION_ID:"x-ms-correlation-id",SOURCE_ID:"x-ms-source-id",USER_AGENT:"x-ms-user-agent",APP_ID:"x-ms-app-id",APP_NAME:"x-ms-app-name",OBJECT_ID:"x-ms-sw-objectid",TENANT_ID:"x-ms-sw-tenantid",CONTENT_ID:"Content-ID",CONTENT_TRANSFER_ENCODING:"Content-Transfer-Encoding",PREFERENCE_APPLIED:"Preference-Applied",LOCATION:"Location",REQ_ID:"REQ_ID"},f={APPLICATION_JSON:"application/json",APPLICATION_HTTP:"application/http",BINARY:"binary",ANNOTATIONS:'odata.include-annotations="*"',ANNOTATIONS_NOQUOTES:"odata.include-annotations=*",PREFER_REPRESENTATION:"return=representation"},y={CannotUpdateOnlineRecord:-2147093980,CannotDeleteOnlineRecord:-2147093944,DataSourceOfflineErrorCode:-2147093999,InvalidXml:-2147220991,UnknownUnexpectedGenericError:-2147015414,UnknownBadRequestError:-2147015424,DataStoreKeyNotFoundErrorCode:-2147093987,QueryBuilderNoEntity:-2147217150,NetworkIssue:-2147094268},m="appmodules",h="/api/data/v9.0/",g={ErrorCode:"code",Message:"message",StackTrace:"stacktrace",Stack:"stack",InnerError:"innererror"},E="_",b="Unknown",O={local:"local",remote:"remote"},v={ONLINE:"Online",OFFLINE:"Offline"},_={MULTI_VALUE:"MultiValue",SINGLE_VALUE:"SingleValue"},T="ExpandProperties",S="fileattachment",N="devicefilepath",C="devicethumbnailpath",P="imagedescriptor",R="imagedescriptorid",w="filename",M="fetchXml=",I="_NORSYNC_MAIN_LOG_TABLE",A=["businessprocessflowinstance","command","commandoperation"],D="_NORSYNC_LOG_"},iLQe:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AllColumns=void 0;var n=r("Zwof"),a=function(){function e(){}return e.prototype.get_isEmpty=function(){return!1},e.prototype.getDifference=function(e){return new n.LegacyColumnSet(new Array(0))},e.get_instance=function(){return e._instance||(e._instance=new e)},e._instance=null,e}();t.AllColumns=a},iiR4:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return a(t,e),t},o=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(a,i){function o(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((n=n.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var r,n,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(a=2&i[0]?n.return:i[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,i[1])).done)return a;switch(n=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,n=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],n=0}finally{r=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.UpSyncDataBuilder=void 0;var u=r("+MPC"),l=i(r("8w73")),c=r("rW8f"),d=r("4oeN"),p=r("WHxM"),f=r("WIpw"),y=r("4Qkk"),m=r("bZIc"),h=r("Umyr"),g=r("6JO4"),E=r("rljN"),b=function(){function e(e,t,r){this._BatchLogs=e,this._EntityLogMap=t,this._applicationContext=r,this._tracer=this._applicationContext.TraceManager.getTracer(l.upsyncComponentName)}return e.prototype.createCommandData=function(e){return o(this,void 0,void 0,(function(){var t,r;return s(this,(function(n){switch(n.label){case 0:if(e>=this._BatchLogs.length)throw new u.ErrorStatus("Invalid index specified for batch logs");return t=this._BatchLogs[e],[4,t.logTableID.toLowerCase()!==l.norSyncCommandLog.toLowerCase()?t.logTableID.toLowerCase()===l.norSyncUpSyncTransactionBeginLog.toLowerCase()||t.logTableID.toLowerCase()===l.norSyncUpSyncTransactionEndLog.toLowerCase()?this._GetTransactionCommandData(e):this._GetCrudCommandData(e):this._GetNonCrudCommandData(e)];case 1:return(r=n.sent()).associatedMainLog=t,r.associatedEntityLog=E.getPrimaryEntityLogFromEntityMap(t,this._EntityLogMap),[2,r]}}))}))},e.prototype._GetTransactionCommandData=function(e){var t=this._BatchLogs[e],r=t.operationType,n=new c.LegacyEntityReference(E.getEntityNameFromOfflineLog(t),d.LegacyGuid.newGuid()),a=new p.EntityRecord(n,{},{},{},{},new f.RelatedEntityCollection(new Array(0)));return Promise.resolve(new y.TransactionCommandData(r,a))},e.prototype._GetCrudCommandData=function(e){return o(this,void 0,void 0,(function(){var t,r,n;return s(this,(function(a){switch(a.label){case 0:return t=this._BatchLogs[e],r=t.operationType,[4,E.getEntityRecordsForUpsyncAndRollback(t,this._EntityLogMap,this._applicationContext)];case 1:return n=a.sent(),[2,Promise.resolve(new h.CrudCommandData(r,n[0],n[1]))]}}))}))},e.prototype._GetNonCrudCommandData=function(e){return o(this,void 0,void 0,(function(){var t,r,n,a;return s(this,(function(i){switch(i.label){case 0:return t=this._BatchLogs[e],this._EntitiesInNonCrud=[],this._AssociatedNonCrudMainLogs=[],this._AssociatedNonCrudEntityLogs={},r=E.getPrimaryEntityLogFromEntityMap(t,this._EntityLogMap),n=d.LegacyGuid.tryCreate(r.getValue(l.commandIdColumnName).toString()),a=E.getCommandFromCommandLog(r),[4,this._ProcessEntitiesInNonCrudCommand(e,a)];case 1:return i.sent(),[2,new g.NonCrudCommandData(n,a,this._EntitiesInNonCrud,this._AssociatedNonCrudMainLogs,this._AssociatedNonCrudEntityLogs)]}}))}))},e.prototype._GetCommandOperationsCount=function(e){for(var t=0;e<this._BatchLogs.length;){if(this._BatchLogs[e].logTableID.toLowerCase()!==l.norSyncCommandOperationLog.toLowerCase())break;t++,e++}return t},e.prototype._ProcessEntitiesInNonCrudCommand=function(e,t){return o(this,void 0,void 0,(function(){var r,n,a,i,o;return s(this,(function(s){switch(s.label){case 0:if(t.name.toLowerCase()===l.changeProcessAndStageCommandName.toLowerCase())return e+1>=this._BatchLogs.length?[2,!0]:(r=this._BatchLogs[e+1],E.getTableNameFromNorSyncMainLog(r)===l.norSyncBusinessProcessFlowInstanceLog?(this._AssociatedNonCrudMainLogs.push(r),this._AssociatedNonCrudEntityLogs[r.SID.toString()]=E.getPrimaryEntityLogFromEntityMap(r,this._EntityLogMap),[2,!0]):[2,!0]);for(n=this._GetCommandOperationsCount(e+1),a=[],i=1;i<=2*n;i++)a.push(this._PopulateEntitiesInNonCrud(e+i));s.label=1;case 1:return s.trys.push([1,3,,4]),[4,Promise.all(a)];case 2:return s.sent(),this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackManager.ProcessEntitiesInNonCrud.Success","Processing of Entities in NonCrud Succeeded")),[2,!0];case 3:throw o=s.sent(),o=u.convertToErrorStatus(o),this._tracer.error(E.addPrefix("OfflineUpSync.PlaybackManager.ProcessEntitiesInNonCrud.Fail",o.message)),o;case 4:return[2]}}))}))},e.prototype._PopulateEntitiesInNonCrud=function(e){var t,r;return o(this,void 0,void 0,(function(){var n,a,i,o,l,c;return s(this,(function(s){switch(s.label){case 0:return this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackManager._PopulateEntitiesInNonCrud.Start","Population of Entities in NonCrud Started")),e>=this._BatchLogs.length?(this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackManager._PopulateEntitiesInNonCrud.Success","Population of Entities in NonCrud Succeeded")),[2,!1]):(n=this._BatchLogs[e],a=n.logTableID,i=E.getEntityNameFromOfflineLog(n),[4,E.getEntityRecordsForUpsyncAndRollback(n,this._EntityLogMap,this._applicationContext)]);case 1:if(!(o=s.sent()[1]))return this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackManager._PopulateEntitiesInNonCrud.Skipped","Population of Entities in NonCrud is skipped due to missing table "+a)),[2,!1];if(this._AssociatedNonCrudMainLogs.push(n),this._AssociatedNonCrudEntityLogs[n.SID.toString()]=o,m.PlaybackManager.getSkipTables().indexOf(a)>=0)return this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackManager._PopulateEntitiesInNonCrud.Skipped","Population of Entities in NonCrud is skipped due to skip table "+a)),[2,!0];s.label=2;case 2:return s.trys.push([2,4,,5]),[4,null===(r=null===(t=this._applicationContext.DataLayerConfiguration.MetadataProvider)||void 0===t?void 0:t.retrieveEntity)||void 0===r?void 0:r.call(t,i)];case 3:return(null==(l=s.sent())?void 0:l.PrimaryIdAttribute)&&o.getValue(l.PrimaryIdAttribute)&&(this._EntitiesInNonCrud.map((function(e){return e.id})).indexOf(o.getValue(l.PrimaryIdAttribute).toString())<0&&this._EntitiesInNonCrud.push({entityLogicalName:i,id:o.getValue(l.PrimaryIdAttribute).toString()}),this._tracer.warn(E.addPrefix("OfflineUpSync.PlaybackManager._PopulateEntitiesInNonCrud.Success","Population of Entities in NonCrud Succeeded for entity "+i))),[2,!0];case 4:throw c=s.sent(),c=u.convertToErrorStatus(c),this._tracer.error(E.addPrefix("OfflineUpSync.PlaybackManager._PopulateEntitiesInNonCrud.Fail",c.message)),c;case 5:return[2]}}))}))},e}();t.UpSyncDataBuilder=b},jkZo:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"c",(function(){return a})),r.d(t,"b",(function(){return i}));
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
const n="MDLUseStateOverMetadataCache",a="RetryMdlCacheTimeout",i="MDLUseStateOverMetadataCachePhase2"},juXS:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
var n;r.r(t),r.d(t,"OptionMetadata",(function(){return d})),function(e){e[e.Raw=0]="Raw",e[e.Numeric=1]="Numeric",e[e.Label=2]="Label",e[e.Value=3]="Value",e[e.State=4]="State",e[e.Id=5]="Id",e[e.Name=6]="Name",e[e.LogicalName=7]="LogicalName",e[e.AllowedStatusTransitions=8]="AllowedStatusTransitions",e[e.DefaultStatus=9]="DefaultStatus",e[e.Color=10]="Color"}(n||(n={}));
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
const a=c(n.Label),i=c(n.Value),o=c(n.State),s=c(n.DefaultStatus),u=c(n.AllowedStatusTransitions),l=c(n.Color);function c(e){return"!"+n[e]}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */class d{constructor(e,t,r,n,a,i,o){this._val=0,this._state=0,this._defaultStatus=0,this._label=e,this._val=t,this._state=r,this._defaultStatus=n,this._allowedStatusTransitions=a,this._color=i,this._invariantName=o}static createFromPicklistItem(e){if(e instanceof d)return e;{const t=e.get_Label(),r=Number(e.get_ValueString());return new d(t,r,-1,-1,[],"","")}}static createFromObjectData(e){const t=e.label,r=e.value,n="state"in e?e.state:-1,a="defaultstatus"in e?e.defaultstatus:-1,i="allowedstatustransitions"in e?e.allowedstatustransitions:[],o="color"in e?e.color:"",s=e.invariantname;return new d(t,r,n,a,i,o,s)}static createFromOData(e){const t=e.Label,r=e.Value,n="State"in e?e.State:-1,a="DefaultStatus"in e?e.DefaultStatus:-1,i="TransitionData"in e?e.TransitionData:[],o="Color"in e?e.Color:"",s=e.Description;return new d(t,r,n,a,i,o,s)}get_Label(){return this._label}set_Label(e){return this._label=e,e}get_ValueString(){return this._val.toString()}get_allowedStatusTransitions(){return this._allowedStatusTransitions}get_color(){return this._color}get_value(){return this._val}get_state(){return this._state}get_defaultStatus(){return this._defaultStatus}get_invariantName(){return this._invariantName}getObjectData(){return{label:this._label,value:this._val,state:this._state,defaultstatus:this._defaultStatus,allowedstatustransitions:this._allowedStatusTransitions,color:this._color,invariantname:this._invariantName}}getODataObject(){return{Value:this._val,Color:this._color,Label:this._label,DefaultStatus:this._defaultStatus,State:this._state,TransitionData:this._allowedStatusTransitions,InvariantName:this._invariantName}}getValue(e){if(e===a||"label"===e)return this.get_Label();if(e===i||"value"===e)return this.get_value();if(e===o||"state"===e)return this.get_state();if(e===s||"defaultstatus"===e)return this._defaultStatus;if(e===u||"allowedstatustransitions"===e)return this.get_allowedStatusTransitions();if(e===l||"color"===e)return this.get_color();throw new Error("fieldName = ${fieldName} is out of range")}}d.__typeName="Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.OptionMetadata"},k1iK:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return a(t,e),t},o=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(a,i){function o(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((n=n.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var r,n,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(a=2&i[0]?n.return:i[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,i[1])).done)return a;switch(n=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,n=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],n=0}finally{r=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},u=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.uniqueMerge=t.PayloadFormat=t.getFormattedValueAnnotation=t.getLookupLogicalNameAnnotation=t.getLookupPropertyName=t.determineReturnedColumn=t.determineReturnedColumns=t.createEntityRecordFromResponseAsync=t.createEntityRecordFromResponse=t.REMOVE_NOTIFICATIONS=t.ADD_NOTIFICATIONS=void 0;var l,c=r("yNq8"),d=i(r("6QHb")),p=r("Ln9p"),f=r("RVOy"),y=r("McwX"),m=r("x0cL"),h=r("nf9M"),g=r("UWtl"),E=r("WHxM"),b=r("s+yA"),O=r("H5aA"),v=r("WIpw"),_=r("cj/A"),T=r("LTKH"),S=r("UxT/"),N=r("fnSt");function C(e,t,r,n,a,i,o,s,f,y,g){void 0===y&&(y=l.OData);var b=o||r?r.PrimaryIdAttribute:void 0;a||(a=R(t,y)),-1===a.indexOf("versionnumber")&&t.hasOwnProperty("@odata.etag")&&a.push("versionnumber");var O=b&&"string"==typeof t[b]?new p.Guid(t[b]):p.Guid.EMPTY,N=new m.EntityReference(r.EntityLogicalName,O),C=m.EntityReference.toLegacyEntityReference(N),P=null;s&&!h.IsNullOrUndefined(s)&&(P=s.aliasedValueDescriptors);var w=function(e,t,r,n,a,i,o,s,f){var y,g,b;void 0===f&&(f=l.OData);var O={fieldTypes:{},formattedValues:{},numericFormattedValues:{},fields:{}},N=function(t){if(h.IsNullOrUndefinedOrEmptyString(t)){var y=[{name:"EntityLogicalName",value:null!=r?r.EntityLogicalName:"null"}];return o&&o.warn("Empty field name encountered while trying to construct entity record",y),"continue"}if("versionnumber"===t){var g=c.AttributeType.BigInt;O.fields[t]=D(e,a,t,g,r,n,!1,i,o,f),O.fieldTypes[t]=g}else if(s&&a&&a.hasOwnProperty(t)&&a[t]&&s.filter((function(e){return e.get_relationShipName()===t})).length>0)!function(e,t,r,n,a,i,o){var s,l,f,y,h,g,b,O;if(o)try{for(var _=u(o),N=_.next();!N.done;N=_.next()){var C=N.value,P=void 0,R=C.get_relationShipName();if(R===t){var w=S.getRelationShipByNavigationProperty(e,r.EntityLogicalName,R);if(w){var M=S.getRelationshipTypeByNavigationProperty(e,r.EntityLogicalName,R),I=M===d.RelationshipType.OneToManyRelationship?w.ReferencingEntity:w.ReferencedEntity,A=C.get_columnNames(),L=T.getAttributesForEntity(e,I);if(L){var U=[],F=S.getEntityDescriptor(e,I),x=null==F?void 0:F.PrimaryKeyName;if(M===d.RelationshipType.OneToManyRelationship){var k=n[R];try{for(var j=(f=void 0,u(k)),q=j.next();!q.done;q=j.next()){var B=q.value,$={fieldTypes:{},formattedValues:{},numericFormattedValues:{},fields:{}},V=new p.Guid(B[x]),H=new m.EntityReference(null==F?void 0:F.EntityLogicalName,V),G=m.EntityReference.toLegacyEntityReference(H);if(A)try{for(var Q=(h=void 0,u(A)),X=Q.next();!X.done;X=Q.next()){var W=X.value;if(L.hasOwnProperty(W)){var z=D(e,B,W,P=L[W].Type,F,L,!1,null,i);$.fields[W]=z,$.fieldTypes[W]=P}}}catch(e){h={error:e}}finally{try{X&&!X.done&&(g=Q.return)&&g.call(Q)}finally{if(h)throw h.error}}var Y=new E.EntityRecord(G,$.fields,$.fieldTypes,$.formattedValues,$.numericFormattedValues,new v.RelatedEntityCollection([]));U.push(Y)}}catch(e){f={error:e}}finally{try{q&&!q.done&&(y=j.return)&&y.call(j)}finally{if(f)throw f.error}}}else if(M===d.RelationshipType.ManyToOneRelationship){B=n[R],$={fieldTypes:{},formattedValues:{},numericFormattedValues:{},fields:{}},V=new p.Guid(B[x]),H=new m.EntityReference(null==F?void 0:F.EntityLogicalName,V),G=m.EntityReference.toLegacyEntityReference(H);if(A)try{for(var K=(b=void 0,u(A)),J=K.next();!J.done;J=K.next()){W=J.value;if(L.hasOwnProperty(W)){P=L[W].Type;z=D(e,n[t],W,P,F,L,!1,null,i);$.fields[W]=z,$.fieldTypes[W]=P}}}catch(e){b={error:e}}finally{try{J&&!J.done&&(O=K.return)&&O.call(K)}finally{if(b)throw b.error}}Y=new E.EntityRecord(G,$.fields,$.fieldTypes,$.formattedValues,$.numericFormattedValues,new v.RelatedEntityCollection([]));U.push(Y)}a.fields[R]=U,a.fieldTypes[R]=c.AttributeType.NavigationProperty}}}}}catch(e){s={error:e}}finally{try{N&&!N.done&&(l=_.return)&&l.call(_)}finally{if(s)throw s.error}}}(e,t,r,a,O,o,s);else{var N=!1,C=!!i&&i.hasOwnProperty(t);if(!C&&null==n[t])return"continue";var P=a.hasOwnProperty(L(t,a,i,C));if(P||(P=a.hasOwnProperty(F(t,f,C))),!P){var R=U(e,t,r,a,i,C);N=P=R&&a.hasOwnProperty(R)&&a[R].filter((function(e){return e.participationtypemask===_.getParticipationTypeMask(C&&i?i[t].aliasedValueEtn:r.EntityLogicalName,C&&i?i[t].aliasedValueFieldName:t)})).length>0}if(P){g=C?c.AttributeType.AliasedValue:n[t].Type;var w=!(!i||!(null===(b=i[t])||void 0===b?void 0:b.isAttributeAlias)),M=L(t,a,i,C&&w),I=!!(C&&i&&i[t]&&i[t].oDataAlias.length>1),x=L(t,a,i,I);O.fields[M]=D(e,a,x,g,r,n,N,C?i:null,o,f),O.fieldTypes[M]=g,function(e,t,r,n,a,i,o){if(a===l.OData){var s=A(t);n.hasOwnProperty(s)&&(r.formattedValues[t]=n[s])}}(0,x,O,a,f)}}};try{for(var C=u(t),P=C.next();!P.done;P=C.next()){N(P.value)}}catch(e){y={error:e}}finally{try{P&&!P.done&&(g=C.return)&&g.call(C)}finally{if(y)throw y.error}}return O}(e,a,r,n,t,P,f,g,y);return new E.EntityRecord(C,w.fields,w.fieldTypes,w.formattedValues,w.numericFormattedValues,new v.RelatedEntityCollection([]),i)}function P(e,t){var r,n,a=new Set(e||[]),i=e&&e.slice(0)?e.slice(0):[];if(t)try{for(var o=u(t),s=o.next();!s.done;s=o.next()){var l=s.value;a.has(l)||i.push(l)}}catch(e){r={error:e}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return i}function R(e,t){void 0===t&&(t=l.OData);var r=Object.keys(e).reduce((function(e,r){return-1===r.indexOf("@")&&e.add(w(r,t)),e}),new Set);return Array.from(r)}function w(e,t){void 0===t&&(t=l.OData);var r=null;return(r=t===l.OData?e.match(/_(\w+)_value/i):e.match(/(\w+\.?\w+)!(id|name|logicalname)$/i))&&r[1]?r[1]:e}!function(e){e[e.OData=0]="OData",e[e.SQL=1]="SQL"}(l||(l={})),t.PayloadFormat=l,t.createEntityRecordFromResponse=C,t.createEntityRecordFromResponseAsync=function(e,t,r,n,a,i,c,p,m){return void 0===p&&(p=l.OData),{type:"CREATE_ENTITY_RECORD_FROM_RESPONSE_ASYNC",execute:function(l,h){var g=l.getState,E=l.dispatch;return o(this,void 0,void 0,(function(){var o,l,h,b,O;return s(this,(function(s){switch(s.label){case 0:return o=R(e,p),l=function(e,t,r,n,a,i){var o,s,l,c,p=P(r,n).filter((function(e){return-1===e.indexOf(".")}));p&&p.length>0?a?(c=a.entity2AttributesMap?a.entity2AttributesMap:{},f.addAttributes(c,t,p)):((o={})[t]=p,c=o):c={};if(i)try{for(var y=u(i),m=y.next();!m.done;m=y.next()){var h=m.value,g=h.get_relationShipName(),E=S.getRelationShipByNavigationProperty(e,t,g);if(E){var b=S.getRelationshipTypeByNavigationProperty(e,t,g)===d.RelationshipType.OneToManyRelationship?E.ReferencingEntity:E.ReferencedEntity,O=h.get_columnNames();f.addAttributes(c,b,O)}}}catch(e){s={error:e}}finally{try{m&&!m.done&&(l=y.return)&&l.call(y)}finally{if(s)throw s.error}}return c}(g(),t,r,o,i,m),[4,E(y.retrieveEntities(l))];case 1:return s.sent(),h=T.getAttributesForEntity(g(),t),b=S.getEntityDescriptor(g(),t),O=(r||[]).concat(l[t]?l[t].filter((function(e){return h.hasOwnProperty(e)})):[]),[2,C(g(),e,b,h,O,n,a,i,c,p,m)]}}))}))}}},t.uniqueMerge=P,t.determineReturnedColumns=R,t.determineReturnedColumn=w;t.ADD_NOTIFICATIONS="notifications.add";function M(e){return"_"+e+"_value"}function I(e){return e+"@Microsoft.Dynamics.CRM.lookuplogicalname"}function A(e){return e+"@OData.Community.Display.V1.FormattedValue"}function D(e,t,r,n,a,i,o,s,u,d){var f;void 0===d&&(d=l.OData);var y,E=F(r,d);if("versionnumber"===r&&d===l.OData&&t["@odata.etag"]){var v=t["@odata.etag"].match(/W\/\"([0-9a-zA-Z]+)\"/);if(v&&v[1])return v[1]}if(!(o||t.hasOwnProperty(r)||t.hasOwnProperty(E)||s))return null;var P=null;if(i&&i[r]&&-1!==[c.AttributeType.Lookup,c.AttributeType.Customer,c.AttributeType.Owner].indexOf(i[r].Type))s&&s.hasOwnProperty(r)&&(E=F(r,d,!0)),y=t[E];else if(i&&i[r]){var R=x(s,t,r),w=s&&s[r]&&s[r].oDataAlias&&s[r].oDataAlias[R]||r;if(P=s&&s[r]&&s[r].rowaggregate||null,y=t[w],s&&s[r]&&s[r].isAttributeAlias&&h.IsNullOrUndefined(P))return y}else y=t[r];if(!o&&null===y)return null;switch(n){case c.AttributeType.AliasedValue:if(s){var M=s[r],L=M.aliasedValueEtn,k=M.aliasedValueFieldName,j=S.getEntityDescriptor(e,L),q=T.getAttributeDescriptor(e,L,k),B=void 0;B=P&&"CountChildren"===P?c.AttributeType.Integer:null==q?void 0:q.Type;var $=new b.LegacyAliasedValue(L,k,B);return null==(y=D(e,t,r,B,j,((f={})[r]=q,f),o,s,u,d))?null:($.set_value(y),$)}return null;case c.AttributeType.Customer:case c.AttributeType.Lookup:case c.AttributeType.Owner:var V=t[function(e,t,r){void 0===r&&(r=l.OData);return r===l.OData?I(t):e+"!logicalname"}(r,E,d)],H=t[function(e,t,r){void 0===r&&(r=l.OData);return r===l.OData?A(t):e+"!name"}(r,E,d)];if(V&&y)return m.EntityReference.toLegacyEntityReference(new m.EntityReference(V,new p.Guid(y),H));var G=[];return G.push({name:"EntityLogicalName",value:null==i[r]?"null":i[r].EntityLogicalName}),G.push({name:"Attribute Name",value:null==i[r]?"null":i[r].LogicalName}),G.push({name:"Lookup Field EntityLogicalName",value:null==V?"null":V}),G.push({name:"FieldValue",value:null==y?"null":y}),G.push({name:"lookupFormattedValue",value:null==H?"null":H}),function(e,t,r){null==r||r.error(e,t)}("_constructFieldValue: Lookup Field EntityLogicalName or FieldValue is null",G),null;case c.AttributeType.UniqueIdentifier:var Q=p.Guid.tryParseOrNull(y);return Q?p.Guid.toLegacyGuid(Q):null;case c.AttributeType.DateTime:var X=void 0;return d===l.OData&&(X=i&&i[r]&&i[r].Behavior===N.DateTimeFieldBehavior.TimeZoneIndependent?y.replace(/-\d{2}:\d{2}$/,"Z"):y),h.IsNullOrUndefinedOrEmptyString(y)?null:new Date(Date.parse(X));case c.AttributeType.Status:case c.AttributeType.State:case c.AttributeType.Boolean:case c.AttributeType.PickList:var W=t[A(r)],z=void 0,Y=i[r].OptionSet;return Y&&(null==y&&Y.DefaultValue&&-1!==Y.DefaultValue&&(y=Y.DefaultValue),null!=y&&(z=Y.find((function(e){return Number(e.Value)===Number(y)})))),z?new O.OptionMetadata(W||z.Label,z.Value,null,null,null,z.Color,null):new O.OptionMetadata(W,y,null,null,null,null,null);case c.AttributeType.PartyList:return function(e,t,r,n,a,i){void 0===i&&(i=!1);if(n&&n.OneToManyRelationships){var o=U(e,t,n,r,a,i);if(!o)return null;var s=r[o];if(!s)return null;var u=S.getEntityDescriptor(e,"activityparty"),l=T.getAttributesForEntity(e,"activityparty"),c=Object.keys(l),d=s.filter((function(e){return e.participationtypemask===_.getParticipationTypeMask(i?a[t].aliasedValueEtn:n.EntityLogicalName,i?a[t].aliasedValueFieldName:t)})).map((function(t){return C(e,t,u,l,c)}));return new g.EntityCollection(d,!1,d.length,!1,null,null)}return new g.EntityCollection([],!1,0,!1,null,null)}(e,r,t,a,s,null!=s&&null!=s[r]);default:return y}}function L(e,t,r,n){if(void 0===n&&(n=!1),n&&r&&r[e]){var a=x(r,t,e);return r[e].oDataAlias[a]}return e}function U(e,t,r,n,a,i){void 0===i&&(i=!1);var o=i?a[t].aliasedValueEtn:r.EntityLogicalName,s=S.getActivityPartyNavigationPropertyRelationship(e,o);if(!s)return null;if(i){var u=x(a,n,t);return""+a[t].alias+a[t].oDataSeparator[u]+s.ReferencedEntityNavigationPropertyName}return""+s.ReferencedEntityNavigationPropertyName}function F(e,t,r){return void 0===t&&(t=l.OData),void 0===r&&(r=!1),t===l.OData?r?e:M(e):e+"!id"}function x(e,t,r){if(e&&e.hasOwnProperty(r)&&e[r].oDataAlias.length>0)for(var n=0;n<e[r].oDataAlias.length;n++)if(t.hasOwnProperty(e[r].oDataAlias[n]))return n;return 0}t.REMOVE_NOTIFICATIONS="notification.remove",t.getLookupPropertyName=M,t.getLookupLogicalNameAnnotation=I,t.getFormattedValueAnnotation=A},kCYo:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CallingContext=void 0;var n=r("nf9M"),a=function(){function e(t,r,a){this._callerPriority=0,this._callerName=n.IsNullOrUndefinedOrEmptyString(r)?e.unknown:r,this._callerPriority=a}return e.prototype.get_callerName=function(){return this._callerName},e.prototype.get_Stack=function(){return this._stack},e.prototype.AppendCallStack=function(e){n.IsNullOrUndefined(e)||(n.IsNullOrUndefined(this._stack)?this._stack=e:this._stack=this._stack+":"+e)},e.prototype.get_callerPriority=function(){return this._callerPriority},e.prototype.IsPreloadCall=function(){return!1},e.unknown="unknown",e}();
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */t.CallingContext=a},kJz0:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.FetchLikeHeaders=void 0;var n=function(){function e(e){this._headers=e}return e.prototype[Symbol.iterator]=function(){throw new Error("Method not implemented.")},e.prototype.entries=function(){throw new Error("Method not implemented.")},e.prototype.keys=function(){throw new Error("Method not implemented.")},e.prototype.values=function(){throw new Error("Method not implemented.")},e.prototype.append=function(e,t){this._headers[e]=t},e.prototype.get=function(e){return this._headers[e]},e.prototype.has=function(e){return this._headers.hasOwnProperty(e)},e.prototype.delete=function(e){delete this._headers[e]},e.prototype.set=function(e,t){this._headers[e]=t},e.prototype.forEach=function(e){for(var t in this._headers)e(this._headers[t],t,this)},e}();t.FetchLikeHeaders=n},kgGf:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.assert=void 0,t.assert=function(e,t){}},lSoY:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
var n,a,i,o;r.r(t),r.d(t,"ApplicationMetadataType",(function(){return n})),r.d(t,"MetadataType",(function(){return a})),r.d(t,"MetadataSubtype",(function(){return o})),r.d(t,"QueriedMetadataType",(function(){return i})),function(e){e[e.all=0]="all",e[e.systemApplicationMetadata=1]="systemApplicationMetadata",e[e.userApplicationMetadata=2]="userApplicationMetadata"}(n||(n={})),function(e){e[e.none=0]="none",e[e.workspace=1]="workspace",e[e.form=2]="form",e[e.component=3]="component",e[e.entityCard=4]="entityCard",e[e.quickCreateForm=5]="quickCreateForm",e[e.customization=6]="customization",e[e.listQuery=7]="listQuery",e[e.grid=8]="grid",e[e.command=9]="command",e[e.siteMap=10]="siteMap",e[e.list=11]="list",e[e.dialog=12]="dialog",e[e.gridForm=13]="gridForm",e[e.inlineCreateForm=14]="inlineCreateForm",e[e.processControl=15]="processControl",e[e.fetchXml=16]="fetchXml",e[e.chartDrilldownForm=17]="chartDrilldownForm",e[e.entity=18]="entity",e[e.attribute=19]="attribute",e[e.webResource=20]="webResource",e[e.applicationMetadata=21]="applicationMetadata",e[e.mainFormDialog=22]="mainFormDialog",e[e.chart=23]="chart",e[e.uiStrings=24]="uiStrings",e[e.businessLogic=25]="businessLogic",e[e.searchPage=26]="searchPage",e[e.globalApplicationMetadata=27]="globalApplicationMetadata",e[e.applicationMetadataUserContext=28]="applicationMetadataUserContext",e[e.staticJSFile=29]="staticJSFile",e[e.layoutXml=30]="layoutXml",e[e.draftsPage=31]="draftsPage",e[e.duplicateRecordsPage=32]="duplicateRecordsPage",e[e.applicationMetadataSettings=33]="applicationMetadataSettings",e[e.senderFormPage=34]="senderFormPage",e[e.setRegarding=35]="setRegarding",e[e.senderCreateFormPage=36]="senderCreateFormPage",e[e.interactionCentricWorkspace=37]="interactionCentricWorkspace",e[e.taskBasedFlowGlobalMenu=38]="taskBasedFlowGlobalMenu",e[e.taskBasedFlow=39]="taskBasedFlow",e[e.interactionCentricForm=40]="interactionCentricForm",e[e.cardForm=41]="cardForm",e[e.controlConfiguration=42]="controlConfiguration",e[e.commandXaml=43]="commandXaml",e[e.documentTemplate=44]="documentTemplate",e[e.viewSelector=45]="viewSelector",e[e.customControl=46]="customControl",e[e.formSelector=47]="formSelector",e[e.resourceString=48]="resourceString",e[e.savedQueryVisualization=49]="savedQueryVisualization",e[e.label=50]="label",e[e.userView=51]="userView",e[e.savedView=52]="savedView",e[e.viewDefault=53]="viewDefault",e[e.homePageConfiguration=54]="homePageConfiguration",e[e.optionSet=56]="optionSet",e[e.quickCreateMenu=57]="quickCreateMenu",e[e.userContext=58]="userContext",e[e.businessProcessFlow=59]="businessProcessFlow",e[e.searchConfiguration=60]="searchConfiguration",e[e.userQueryVisualization=61]="userQueryVisualization",e[e.visualizationSelector=62]="visualizationSelector",e[e.dashboardSelector=63]="dashboardSelector",e[e.overallMetadataVersion=64]="overallMetadataVersion",e[e.appModule=65]="appModule",e[e.complexControl=66]="complexControl",e[e.displayString=67]="displayString",e[e.webResourceDescriptor=68]="webResourceDescriptor",e[e.isActivityFlags=69]="isActivityFlags",e[e.appModuleOfflineMetadata=70]="appModuleOfflineMetadata",e[e.appModuleSelector=71]="appModuleSelector",e[e.bpfSelector=72]="bpfSelector",e[e.dependencies=73]="dependencies"}(a||(a={})),function(e){e.entity="entity",e.savedView="savedview",e.form="form",e.workspace="workspace",e.systemWorkspace="systemworkspace",e.userWorkspace="userworkspace",e.savedVisualization="savedvisualization",e.dialog="dialog",e.taskBasedFlow="taskbasedflow",e.customControl="customcontrol",e.complexControl="complexcontrol",e.formSelector="formselector",e.viewSelector="viewselector",e.ribbon="ribbon"}(i||(i={})),function(e){e[e.none=0]="none",e[e.main=1]="main",e[e.appointment=2]="appointment",e[e.hardcoded=3]="hardcoded",e[e.miniCampaignBO=4]="miniCampaignBO",e[e.preview=5]="preview",e[e.dashboard=6]="dashboard",e[e.quick=7]="quick",e[e.quickCreate=8]="quickCreate",e[e.mobile=9]="mobile",e[e.read=10]="read",e[e.card=11]="card",e[e.dialog=12]="dialog",e[e.taskBased=14]="taskBased",e[e.interactionCentricDashboard=15]="interactionCentricDashboard",e[e.advancedSearch=16]="advancedSearch",e[e.subGrid=17]="subGrid",e[e.quickFindSearch=18]="quickFindSearch",e[e.reporting=19]="reporting",e[e.offlineFilters=20]="offlineFilters",e[e.maSearch=21]="maSearch",e[e.lookup=22]="lookup",e[e.smAppointmentBook=23]="smAppointmentBook",e[e.outlookFilters=24]="outlookFilters",e[e.addressbookFilters=25]="addressbookFilters",e[e.savedQueryTypeOther=26]="savedQueryTypeOther",e[e.interactiveWorkFlow=27]="interactiveWorkFlow",e[e.offlineTemplate=28]="offlineTemplate",e[e.outlookTemplate=29]="outlookTemplate",e[e.customDefined=30]="customDefined",e[e.jScript=31]="jScript",e[e.css=32]="css",e[e.png=33]="png",e[e.jpg=34]="jpg",e[e.gif=35]="gif",e[e.advancedFind=36]="advancedFind"}(o||(o={}))},lwwF:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DescriptorSet=void 0;
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n=r("lSoY"),a=r("nf9M"),i=r("x+vU"),o=r("GokG"),s=function(){function e(){this._descriptors={}}return e.prototype.get_descriptors=function(){return this._descriptors},e.prototype.tryGetDescriptor=function(e){return a.IsNullOrUndefined(this._descriptors[o.DescriptorFormat[e]])?"":this._descriptors[o.DescriptorFormat[e]].Data},e.prototype.updateDescriptorSet=function(e,t){o.DescriptorFormat[e]in this.get_descriptors()?this._descriptors[o.DescriptorFormat[e]].Data=t:this._descriptors[o.DescriptorFormat[e]]=new i.DescriptorData(e,t)},e.createFromFetchXml=function(t){var r=new e;return r._descriptors[o.DescriptorFormat[o.DescriptorFormat.FetchXml]]=new i.DescriptorData(o.DescriptorFormat.FetchXml,t),r},e.createDescriptorSet=function(t,r,a){var s=new e;if(r===n.MetadataType.fetchXml)if(t instanceof Array)for(var u=0;u<t.length;u++){var l=t[u];(l.Format!==o.DescriptorFormat.Sql||a)&&(s.get_descriptors()[o.DescriptorFormat[l.Format]]=new i.DescriptorData(l.Format,l.Data))}else"string"==typeof t&&(s.get_descriptors()[o.DescriptorFormat[o.DescriptorFormat.FetchXml]]=new i.DescriptorData(o.DescriptorFormat.FetchXml,t));else s.get_descriptors()[o.DescriptorFormat[0]]=new i.DescriptorData(0,t);return s},e}();t.DescriptorSet=s},mA3E:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.isOfflineByDefaultEnabledForApp=t.getCurrentAppAppSetting=t.getCurrentAppUniqueNameOrDefault=t.getCurrentAppId=t.getAppContext=t.getAppDescriptor=void 0;var n=r("AlX3"),a=r("1SUZ");function i(e){return e&&e.metadata&&e.metadata.appContext?e.metadata.appContext:null}function o(e){var t=i(e);return t&&t.app?t.app:null}function s(e,t){var r,n,a=o(t);return void 0===(null===(n=null===(r=null==a?void 0:a.appSettings)||void 0===r?void 0:r[e])||void 0===n?void 0:n.value)?null:a.appSettings[e].value}t.getAppDescriptor=i,t.getAppContext=o,t.getCurrentAppId=function(e){var t=o(e);return t&&t.appId?t.appId:null},t.getCurrentAppUniqueNameOrDefault=function(e){var t=o(e);return t&&t.uniqueName?t.uniqueName:e&&e.configuration&&e.configuration.isD365DefaultApp?"d365custom":"__ unavailable__"},t.getCurrentAppAppSetting=s,t.isOfflineByDefaultEnabledForApp=function(e){return!1===s("ServerMode",e)&&a.isFeatureEnabledByFCBName(e,n.OfflineByDefault)}},nf9M:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.isUrl=t.IsNullOrUndefinedOrEmptyString=t.IsNullOrUndefined=void 0;var n=/(http|https):\/\/(\w+:{0,1}\w*)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%!\-\/]))?/,a=/(dynamicsxrm):\/\/(\w+:{0,1}\w*)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%!\-\/]))?/,i=/^\/([0-9a-zA-Z_]+\/)?main.aspx/;function o(e){return null==e}t.IsNullOrUndefined=o,t.IsNullOrUndefinedOrEmptyString=function(e){return!!o(e)||"string"==typeof e&&""===e.trim()},t.isUrl=function(e){return n.test(e)||a.test(e)||i.test(e)}},oBfj:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(a,i){function o(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((n=n.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var r,n,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(a=2&i[0]?n.return:i[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,i[1])).done)return a;switch(n=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,n=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],n=0}finally{r=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.RETRIEVE_ROW_VERSION_HEADER=t.requestAdditionalMetadataForEntityRecord=t.buildCreateRequest=void 0;var i=r("McwX"),o=r("EHm6"),s=r("UxT/"),u=r("Wc7r");t.RETRIEVE_ROW_VERSION_HEADER="ReturnRowVersion",t.buildCreateRequest=function(e,t,r,n,a,i){var o;void 0===n&&(n=!0);var l={urlParameters:""+s.getEntitySetName(e,t),body:JSON.stringify(r),additionalHeaders:(o={},o[u.HEADER.ACCEPT]=u.HEADER_VALUES.APPLICATION_JSON,o[u.HEADER.MSCRM_SUPPRESS_DUPLICATION_DETECTION]=n.toString(),o),method:"POST"};return l&&l.additionalHeaders&&a&&(l.additionalHeaders.ReturnRowVersion="true"),l&&l.additionalHeaders&&i&&(l.additionalHeaders[u.HEADER.MSCRM_SOLUTION_UNIQUE_NAME]=i),l},t.requestAdditionalMetadataForEntityRecord=function(e){return{type:"REQUEST_ADDITIONAL_METADATA_FOR_ENTITY_RECORD",execute:function(t,r){var s=t.dispatch,u=t.getState;return n(this,void 0,void 0,(function(){var t;return a(this,(function(r){switch(r.label){case 0:return(t=o.getRelatedEntityLogicalNames(u(),e).reduce((function(e,t){return e[t]=[],e}),{}))[e.get_identifier().LogicalName]=o.getAttributeNamesWithNoMetadata(u(),e),[4,s(i.retrieveEntities(t))];case 1:return r.sent(),[2]}}))}))}}}},oCZx:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.IsNullOrWhiteSpace=function(e){try{return null==e||"undefined"==e||e.toString().replace(/\s/g,"").length<1}catch(e){return console.log(e),!1}},e.Join=function(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];try{var a=r[0];if(Array.isArray(a)||a instanceof Array){for(var i=e.Empty,o=0;o<a.length;o++){var s=a[o];o<a.length-1?i+=s+t:i+=s}return i}if("object"==typeof a){var u=e.Empty,l=a,c=Object.keys(a);return c.forEach((function(e){u+=l[e]+t})),u=u.slice(0,u.length-t.length)}var d=r;return e.join.apply(e,[t].concat(d))}catch(t){return console.log(t),e.Empty}},e.Format=function(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];try{return t.match(e.regexNumber)?e.format(e.regexNumber,t,r):t.match(e.regexObject)?e.format(e.regexObject,t,r,!0):t}catch(t){return console.log(t),e.Empty}},e.format=function(t,r,n,a){return void 0===a&&(a=!1),r.replace(t,(function(t,r){var i,o=t.split(":");return o.length>1&&(r=o[0].replace("{",""),t=o[1].replace("}","")),null==(i=a?n[0][r]:n[r])||null==i||t.match(/{\d+}/)||void 0!==(i=e.parsePattern(t,i))&&null!=i?i:e.Empty}))},e.parsePattern=function(t,r){switch(t){case"L":return r=r.toLowerCase();case"U":return r=r.toUpperCase();case"d":if("string"==typeof r)return e.getDisplayDateFromString(r);if(r instanceof Date)return e.Format("{0:00}.{1:00}.{2:0000}",r.getDate(),r.getMonth(),r.getFullYear());break;case"s":if("string"==typeof r)return e.getSortableDateFromString(r);if(r instanceof Date)return e.Format("{0:0000}-{1:00}-{2:00}",r.getFullYear(),r.getMonth(),r.getDate());break;case"n":"string"!=typeof r&&(r=r.toString());var n=r.replace(/,/g,".");if(isNaN(parseFloat(n))||n.length<=3)break;var a=n.split(/[^0-9]+/g),i=a;a.length>1&&(i=[e.join.apply(e,[""].concat(a.splice(0,a.length-1))),a[a.length-1]]);var o=i[0],s=o.length%3,u=s>0?o.substring(0,s):e.Empty,l=o.substring(s).match(/.{3}/g);return r=(u=u+"."+e.Join(".",l))+(i.length>1?","+i[1]:"")}return"number"!=typeof r&&isNaN(r)||isNaN(+t)||e.IsNullOrWhiteSpace(r)?r:e.formatNumber(r,t)},e.getDisplayDateFromString=function(e){var t;if((t=e.split("-")).length<=1)return e;var r=t[t.length-1],n=t[t.length-2],a=t[t.length-3];return(r=(r=r.split("T")[0]).split(" ")[0])+"."+n+"."+a},e.getSortableDateFromString=function(t){var r=t.replace(",","").split(".");if(r.length<=1)return t;var n=r[r.length-1].split(" "),a=e.Empty;n.length>1&&(a=n[n.length-1]);var i=r[r.length-1].split(" ")[0]+"-"+r[r.length-2]+"-"+r[r.length-3];return!e.IsNullOrWhiteSpace(a)&&a.length>1?i+="T"+a:i+="T00:00:00",i},e.formatNumber=function(e,t){var r=t.length,n=e.toString();if(r<=n.length)return n;var a=r-n.length;return new Array(a+=1).join("0")+n},e.join=function(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];for(var a=e.Empty,i=0;i<r.length;i++)if(!("string"==typeof r[i]&&e.IsNullOrWhiteSpace(r[i])||"number"!=typeof r[i]&&"string"!=typeof r[i])){var o=""+r[i];a+=o;for(var s=i+1;s<r.length;s++)if(!e.IsNullOrWhiteSpace(r[s])){a+=t,i=s-1;break}}return a},e.regexNumber=/{(\d+(:\w*)?)}/g,e.regexObject=/{(\w+(:\w*)?)}/g,e.Empty="",e}();t.String=n;var a=function(){function e(e){void 0===e&&(e=n.Empty),this.Values=[],this.Values=new Array(e)}return e.prototype.ToString=function(){return this.Values.join("")},e.prototype.Append=function(e){this.Values.push(e)},e.prototype.AppendFormat=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];this.Values.push(n.Format.apply(n,[e].concat(t)))},e.prototype.Clear=function(){this.Values=[]},e}();t.StringBuilder=a},ogvk:function(e,t,r){"use strict";r.r(t),r.d(t,"PolicyManager",(function(){return a}));var n=r("fKp2");
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */class a{constructor(e,t){this._policyByName={},t&&this.addRetryPolicies(t),this._tracer=e.TraceManager.getTracer(n.COMPONENT_NAMES.ODataExecutor)}addRetryPolicy(e){e.name in this._policyByName&&this._tracer.warn(`${i()} Same retry policy name: ${e.name} is provided again. Ignore adding this repeated policy name to retry policy list.`),e.action||(e.action=async e=>e),this._policyByName[e.name]=e}addRetryPolicies(e){e&&e.length>0&&e.forEach(e=>{this.addRetryPolicy(e)})}getRetryPolicy(e,t){for(const r in this._policyByName)if(Object.prototype.hasOwnProperty.call(this._policyByName,r)){const n=this._policyByName[r];if(n.condition(e,t))return this._tracer.info(`${i()} Fit Policy ${n.name}`),n}return null}}function i(e){return e?`[${e}]`:`[${n.FILE_PREFIX.PolicyManager}]`}},p0t1:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(a,i){function o(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((n=n.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var r,n,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(a=2&i[0]?n.return:i[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,i[1])).done)return a;switch(n=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,n=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],n=0}finally{r=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t._reportMDSFailure=t.getClientMetadata=t.GET_CLIENT_METADATA_ACTION_ASYNC=void 0;var i=r("PFOI"),o=r("dozL"),s=r("ZKH/"),u=r("Ln9p"),l=r("mA3E"),c=r("Wc7r"),d=r("1SUZ"),p=r("AlX3"),f=r("5ht9"),y=r("ERDA"),m=r("aAjD"),h=r("OTPx"),g=r("nf9M"),E=r("7l03"),b=r("G5wq"),O=r("ghob"),v=r("Yxto"),_=r("wjOh"),T=r("tnR8"),S=r("XZ3b"),N=r("VmTk"),C=r("Qg9G"),P=r("Gcp0"),R=r("fKp2"),w=r("z87Q"),M=r("zrAn"),I=r("McwX"),A=r("ZFvc"),D=r("+hYO"),L=r("+MPC"),U=r("rx97"),F=r("x/rv"),x=r("aTRZ"),k=r("Rv4a"),j=r("B5SO");t.GET_CLIENT_METADATA_ACTION_ASYNC="moderndatasource.getclientmetadata.async";var q;function B(e,t,r,n,a,i){var o=L.ErrorStatus.fromLegacyErrorStatus(r,n);(t.push({name:T.CRM_ERROR_CODE,value:o.errorCode}),x.isSLAImpactingError(a,o.errorCode))?e.EventManager.ReportComponentFailure(a,o,"",t):e.TraceManager.getTracer(a).error(V()+" "+(i||r.get_Message()),t)}function $(e){return{url:e.urlParameters,method:e.method,additionalHeaders:e.additionalHeaders,body:e.body}}function V(e){return"["+(e||o.PREFIX.ModernDataSource)+"]"}!function(e){e[e.None=0]="None",e[e.EntityMetadataReduction=1]="EntityMetadataReduction",e[e.UserContextMetadataReduction=2]="UserContextMetadataReduction"}(q||(q={})),t.getClientMetadata=function(e,r,x){return void 0===x&&(x=i.RetrievalStrategy.LocalAndRemote),{type:t.GET_CLIENT_METADATA_ACTION_ASYNC,execute:function(t,H){var G=t.dispatch,Q=t.getState;return n(this,void 0,void 0,(function(){var t,X,W,z,Y,K,J,Z,ee,te,re,ne,ae,ie,oe,se,ue,le,ce;return a(this,(function(de){switch(de.label){case 0:return(t=H.TraceManager.getTracer(o.MDL_COMPONENT_NAMES.ModernDataSource)).info(V()+" Get Client Metadata is executing"),null==r||r.AppendCallStack(V()+".getClientMetadata"),X=s.toMetadataQuery(e),!(W=Q())&&e.MetadataType&&t.warn(V()+" Trying to execute a "+e.MetadataType+" GCM call with depth "+e.DependencyDepth+" when state is null"),null===u.Guid.tryParseOrNull(l.getCurrentAppId(W))&&e.MetadataType===c.APP_ENTITY&&(X.AppId=u.Guid.fromLegacyGuid(e.MetadataId)),z=d.isFeatureEnabledByFCBName(W,p.IsGetClientMetadataExEnabled),(Y=z?new y.GetClientMetadataExRequest:new f.GetClientMetadataRequest).ClientMetadataQuery=X,[4,G(b.fromFunctionalOdataContract(Y,r))];case 1:(K=de.sent()).urlParameters&&O.shouldCacheMetadataRequest(e.MetadataType,e.DependencyDepth)&&(J=v.getUserMetadataVersion(W),Z=_.getMetadataVersion(W),ee=(null==J?void 0:J.currentVersion)?J.currentVersion:-1,te=(null==Z?void 0:Z.currentVersion)?Z.currentVersion:-1,K.urlParameters=K.urlParameters+"&umv="+ee.toString()+"&mv="+te.toString()),K.urlParameters=K.urlParameters+T.API_FRAGMENT_9_1,S.getConsistencyStrong(W)&&(K.additionalHeaders.Consistency="Strong",G(N.setConsistencyStrong(!1))),d.isFeatureEnabledByFCBName(W,p.GCMOptimizationByEntityMetadataReduction)&&(K.additionalHeaders["x-ms-metadatareductionlevel"]=q.EntityMetadataReduction.toString()),re=j.getIsCacheModeEnabled(W),ne=C.isServerAvailableInternal(W),ae=[],g.IsNullOrUndefined(r)&&(ie=b.getClientRequestId(K),r=new m.UCIContext(ie,!1)),ae.push({name:"InputRetrievalStrategy",value:i.RetrievalStrategy[x]}),ae.push({name:T.REQUEST_DETAILS,value:JSON.stringify(e)}),ae.push({name:"LocalDSAvailable",value:re}),ae.push({name:"RemoteDSAvailable",value:ne}),function(e,t){var r,n,a,i=M.getOperationType(e);t.push({name:T.CLIENT_REQUEST_ID,value:b.getClientRequestId(e)}),t.push({name:R.EVENT_PARAMETERS.CLIENT_TYPE,value:E.getClientType($(e))}),t.push({name:R.EVENT_PARAMETERS.OPERATION_TYPE,value:i.type}),t.push({name:R.EVENT_PARAMETERS.OPERATION_TYPE,value:i.type,forceOwnColumn:!0}),t.push({name:R.EVENT_PARAMETERS.OPERATION_SUB_TYPE,value:i.subType}),t.push({name:R.EVENT_PARAMETERS.OPERATION_SOURCE,value:i.source}),t.push({name:R.EVENT_PARAMETERS.IS_OFFLINE_BY_DEFAULT_REQUEST,value:(null===(r=e.additionalParameters)||void 0===r?void 0:r[T.IS_OFFLINE_BY_DEFAULT_REQUEST])||!1}),t.push({name:R.EVENT_PARAMETERS.ENTITY_NAME,value:(null===(n=e.additionalParameters)||void 0===n?void 0:n[T.ENTITY_NAME])||"Unknown"}),t.push({name:R.EVENT_PARAMETERS.EXECUTION_HINT,value:(null===(a=e.additionalHeaders)||void 0===a?void 0:a[c.HEADER.EXECUTION_HINT])||"Unknown"});var o=e.urlParameters?w.trimUrl(e.urlParameters):null;t.push({name:T.REQUEST_URL,value:o}),t.push({name:T.REQUEST_METHOD,value:e.method||"Unknown"})}(K,ae),(oe=e.DependencyDepth===h.DependencyDepth.UserContext)&&(K.additionalHeaders["x-ms-metadatareductionlevel"]=q.UserContextMetadataReduction.toString()),se=function(e,s){return function(e,t,r,s,u,l,c,d,p,f){return n(this,void 0,void 0,(function(){var n,y,m,h;return a(this,(function(a){switch(a.label){case 0:p.push({name:"FinalRetrievalStrategy",value:i.RetrievalStrategy[r]}),a.label=1;case 1:return a.trys.push([1,4,,5]),null==d||d.AppendCallStack(V()+"._sendGCMRequestInternal"),[4,k._sendRequest(e,t,l,r,c,!0,p)];case 2:return n=a.sent(),[4,u(b.toGCMResponse(n,s,d,l))];case 3:return y=a.sent(),!g.IsNullOrUndefined(y)&&Object.keys(y).length>0&&!f&&(y.finalRetrievalStrategy=r),[2,y];case 4:return m=a.sent(),h=L.ErrorStatus.toLegacyErrorStatus(L.convertToErrorStatus(m)),l.error(V()+" Get Client Metadata failed with error: "+h.get_Message(),p),B(c,p,h,t(),o.MDL_COMPONENT_NAMES.ModernDataSourceGCM,"getClientMetadata failed (known allowed error)"),[2,Promise.reject(h)];case 5:return[2]}}))}))}(e,Q,s,z,G,t,H,r,ae,oe)};try{x===i.RetrievalStrategy.LocalAndRemote&&P.isOfflineByDefaultAvailableForUse(W)&&C.isServerAvailableInternal(W)&&(e.EntityLogicalName?x=U.isEntityAvailableForOfflineUsage(W,e.EntityLogicalName)?i.RetrievalStrategy.Local:i.RetrievalStrategy.Remote:e.MetadataType===I.ENTITY_TYPE&&(x=0===Object.keys(JSON.parse(F.unescapeClientMetadataQueryValue(e.MetadataSubtype))).filter((function(e){return!U.isEntityAvailableForOfflineUsage(W,e)})).length?i.RetrievalStrategy.Local:i.RetrievalStrategy.Remote))}catch(e){throw ce=A.LegacyErrorStatus.fromGenericError(e),B(H,ae,ce,Q(),o.MDL_COMPONENT_NAMES.ModernDataSourceGCM,"getClientMetadata failed (known allowed error)"),ce}if(x!==i.RetrievalStrategy.LocalAndRemote)return[3,8];if(!re)return[3,6];de.label=2;case 2:return de.trys.push([2,4,,5]),[4,se(K,i.RetrievalStrategy.Local)];case 3:if(le=de.sent(),(g.IsNullOrUndefined(le)||0===Object.keys(le).length)&&!oe)throw ce=A.LegacyErrorStatus.fromErrorCode(D.CrmErrorCodes.DataStoreKeyNotFoundErrorCode);return[2,le];case 4:if(ue=de.sent(),t.warn(V()+" error in local data source GCM, retrying with remote data source. Error is: "+E.getErrorMessage(ue),ae),ne)return[2,se(K,i.RetrievalStrategy.Remote)];throw(ce=A.LegacyErrorStatus.fromErrorCode(D.CrmErrorCodes.DataSourceOfflineErrorCode)).set_InnerError(ue),ce.set_Stack(r.get_Stack()),t.error(V()+" remote data source is not available and error in local data source GCM",ae),B(H,ae,ce,Q(),o.MDL_COMPONENT_NAMES.ModernDataSourceGCM,"getClientMetadata failed (known allowed error)"),ce;case 5:return[3,7];case 6:if(ne)return[2,se(K,i.RetrievalStrategy.Remote)];throw(ce=A.LegacyErrorStatus.fromErrorCode(D.CrmErrorCodes.DataSourceOfflineErrorCode)).set_Stack(r.get_Stack()),t.error(V()+" remote and local data sources are not available so error in GCM",ae),B(H,ae,ce,Q(),o.MDL_COMPONENT_NAMES.ModernDataSourceGCM,"getClientMetadata failed (known allowed error)"),ce;case 7:return[3,12];case 8:return x!==i.RetrievalStrategy.Local?[3,11]:re?[4,se(K,i.RetrievalStrategy.Local)]:[3,10];case 9:return le=de.sent(),!g.IsNullOrUndefined(le)&&0!==Object.keys(le).length||oe?[2,le]:((ce=A.LegacyErrorStatus.fromErrorCode(D.CrmErrorCodes.DataStoreKeyNotFoundErrorCode)).set_Stack(r.get_Stack()),t.error(V()+" Not in local store "+e.MetadataType+" "+e.MetadataSubtype,ae),[2,{}]);case 10:return t.warn(V()+" local data source is not available and retrieval strategy is Local.",ae),[2,{}];case 11:if(x===i.RetrievalStrategy.Remote&&ne)return[2,se(K,i.RetrievalStrategy.Remote)];throw(ce=A.LegacyErrorStatus.fromErrorCode(D.CrmErrorCodes.DataSourceOfflineErrorCode)).set_Stack(r.get_Stack()),t.error(V()+" Remote data source is not available and retrieval strategy is remote, so error in GCM",ae),B(H,ae,ce,Q(),o.MDL_COMPONENT_NAMES.ModernDataSourceGCM,"getClientMetadata failed (known allowed error)"),ce;case 12:return[2]}}))}))}}},t._reportMDSFailure=B},pCZI:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return a(t,e),t},o=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(a,i){function o(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((n=n.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var r,n,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(a=2&i[0]?n.return:i[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,i[1])).done)return a;switch(n=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,n=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],n=0}finally{r=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.isODataContract=t.isChangeSet=t.buildRequest=t.executeMultiple=void 0;var u=r("x0cL"),l=r("Rv4a"),c=r("oBfj"),d=r("LN30"),p=i(r("fzfk")),f=r("f7K7"),y=r("ODI4"),m=r("xtAd"),h=r("7ABV"),g=r("zorh");t.executeMultiple=function(e){return{type:"executeOData.batch.async",execute:function(t){var r=t.dispatch;return o(this,void 0,void 0,(function(){var t,n;return s(this,(function(a){switch(a.label){case 0:return t=new f.ODataExecuteMultipleRequest(e),[4,r(l.execute(t))];case 1:return n=a.sent(),[2,y.parseBatchResponse(n)]}}))}))}}},t.buildRequest=function(e,t){if(!t)return{serializationFailure:"Cannot build the serialized request: the request object is empty"};if(!t.getMetadata())return{serializationFailure:"Cannot build the serialized request: the request object does not contain metadata definition"};switch(t.getMetadata().operationType){case p.ODataOperationType.Function:return g.buildFunctionRequest(e,t);case p.ODataOperationType.CRUD:return function(e,t){switch(t.getMetadata().operationName){case"Create":var r=t;return c.buildCreateRequest(e,r.etn,r.payload,r.suppressDupeDetection,r.returnRowVersion,r.solutionUniqueName);case"RetrieveWithUrlParams":var n=t;return m.buildRetrieveRequestWithURLParams(e,n.etn,n.id,n.urlParams,n.maxPageSize,n.headers);case"Update":var a=t;return h.buildUpdateRequest(e,a.etn,a.id,a.payload,a.suppressDupeDetection,null,!1,a.urlParams,a.headers,a.isBinaryPayload);case"Delete":var i=t,o=u.EntityReference.fromExternalEntityReference(i.entityReference);return d.buildDeleteRequest(e,o,null,i.attributeName);default:return{serializationFailure:"Cannot convert ODataContract with "+t.getMetadata().operationName+" operation into a serialized request"}}}(e,t);default:return{serializationFailure:"Cannot build the serialized request: the operation type is not supported"}}},t.isODataContract=function(e){return e&&e.getMetadata},t.isChangeSet=function(e){return e&&Array.isArray(e)&&e.length>0&&e[0].getMetadata}},"qV+U":function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n;Object.defineProperty(t,"__esModule",{value:!0}),t.RelationshipRoleOrdinal=void 0,function(e){e[e.Referencing=1]="Referencing",e[e.AssociationEntity=2]="AssociationEntity"}(n||(n={})),t.RelationshipRoleOrdinal=n},rW8f:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LegacyEntityReference=void 0;var n=r("2Dq5"),a=r("nf9M"),i=r("4oeN"),o=function(){function e(e,t,r,i){this.TypeCode=0,n.throwOnNullOrUndefinedArgument(e,"logicalName"),n.throwOnNullOrUndefinedArgument(t,"id"),this.LogicalName=e,t&&(this.Id=t),a.IsNullOrUndefined(r)||(this.Name=r),a.IsNullOrUndefined(i)||this.set_rowVersion(i),this.TypeName=e,this.TypeDisplayName=e}return e.prototype.get_key=function(){return this.Id.toString()},e.prototype.get_identifier=function(){return this.Id.toString()},e.prototype.get_modelType=function(){return this.LogicalName},e.prototype.get_rowVersion=function(){return this.__RowVersion},e.prototype.set_rowVersion=function(e){return this.__RowVersion=e,e},e.prototype.getObjectData=function(){return{logicalname:this.LogicalName,id:this.Id.getObjectData(),name:this.Name,rowversion:!a.IsNullOrUndefined(this.get_rowVersion())&&this.get_rowVersion()}},e.prototype.equals=function(t){if(t instanceof e){var r=t;return r.LogicalName===this.LogicalName&&this.Id.equals(r.Id)&&this.Name===r.Name}return!1},e.prototype.toString=function(){return this.LogicalName+this.Id.toString()},e.prototype.getValue=function(t){return this[e._UppercaseFirstCharacter(t)]},e.prototype.setValue=function(t,r){this[e._UppercaseFirstCharacter(t)]=r},e.get_empty=function(){return e._empty||(e._empty=new e("",i.LegacyGuid.get_empty(),""))},e.createFromObjectData=function(t){var r=t.logicalname,n=i.LegacyGuid.createFromObjectData(t.id),a=t.name;return t.rowversion?new e(r,n,a,t.rowversion):new e(r,n,a)},e._UppercaseFirstCharacter=function(e){return e.substr(0,1).toUpperCase()+e.substr(1)},e}();t.LegacyEntityReference=o},rljN:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return a(t,e),t},o=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(a,i){function o(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((n=n.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var r,n,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(a=2&i[0]?n.return:i[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,i[1])).done)return a;switch(n=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,n=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],n=0}finally{r=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},u=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.getPrimaryAttributeNameForNonCrmTable=t.addPrefix=t.getUpsyncCommandTypeName=t.getSqlCommandName=t.getCommandFromCommandLog=t.getSecondaryEntityLogFromEntityMap=t.getEntityNameFromOfflineLog=t.getPrimaryEntityLogFromEntityMap=t.getEntityRecordsForUpsyncAndRollback=t.getEntityNameFromOfflineLogTableName=t.getTableNameFromNorSyncMainLog=t.convertEntityRecordsToNorSyncMainLog=t.getOfflineLogTableNameForEntity=void 0;var l=r("GF+Z"),c=r("YIL4"),d=r("8w73"),p=r("agGS"),f=r("27cS"),y=r("JWCx"),m=r("nf9M"),h=r("4oeN"),g=r("7l03"),E=r("yNq8"),b=r("juXS"),O=i(r("87in"));function v(e){return e.logTableID}function _(e,t,r){var n,a;if(!t)throw new Error("shouldPopulateChangeForCreate:Entity record is null");if(O.defaultFieldsForCreate.indexOf(e)>0&&e!==O.ownerId||e===O.versionNumber)return!1;var i=t.get_fieldTypes()[e],o=t.getValue(e),s=null==r?void 0:r[e];if(g.isNullOrUndefined(o)||g.isNullOrUndefined(i))return!1;if(i===E.AttributeType.Boolean||i===E.AttributeType.PickList||i===E.AttributeType.State){var u=o.get_value();if(!m.IsNullOrUndefined(null==s?void 0:s.DefaultValue)||!m.IsNullOrUndefined(null==s?void 0:s.DefaultFormValue))return!((m.IsNullOrUndefined(null==s?void 0:s.DefaultFormValue)?(null==s?void 0:s.DefaultValue)?1:0:null==s?void 0:s.DefaultFormValue)===u)}else if(i===E.AttributeType.Status&&!m.IsNullOrUndefined(s)){var l=t.getValue(O.stateCode).get_value();return!((u=l)===(null===(a=null===(n=null==s?void 0:s.OptionSet)||void 0===n?void 0:n[l])||void 0===a?void 0:a.DefaultStatus))}return!0}function T(e,t,r,n){if(!t)throw new Error("shouldPopulateChangeForUpdate:Entity record is null");if(O.defaultFieldsForCreate.indexOf(e)>0&&e!==O.ownerId||e===O.versionNumber)return!1;var a=t.get_fieldTypes()[e]||r.get_fieldTypes()[e],i=t.getValue(e),o=r.getValue(e);if(g.isNullOrUndefined(a))return!1;if(g.isNullOrUndefined(i)||g.isNullOrUndefined(o)){if(!m.IsNullOrUndefined(a)&&a===E.AttributeType.Image&&!m.IsNullOrUndefined(n)){var s=null==n?void 0:n[e];if(!m.IsNullOrUndefined(n)){var u=null==s?void 0:s.AttributeOf;if(!m.IsNullOrUndefined(u)&&void 0!==u)if((t.getValue(u)?t.getValue(u).toString():null)!==(r.getValue(u)?r.getValue(u).toString():null))return!0}}if(i===o)return!1;var l=a===E.AttributeType.PickList?b.OptionMetadata.createFromOData({Value:null,Label:""}):null;return g.isNullOrUndefined(i)?t.fields[e]=l:r.fields[e]=l,!0}return a===E.AttributeType.Boolean||a===E.AttributeType.PickList||a===E.AttributeType.State||a===E.AttributeType.Status?!(i.get_value()===o.get_value()):a===E.AttributeType.UniqueIdentifier||a===E.AttributeType.Owner||a===E.AttributeType.Lookup||a===E.AttributeType.Customer||a===E.AttributeType.Image?!(i.toString()===o.toString()):a===E.AttributeType.Date||a===E.AttributeType.DateTime?!(i.getTime()===o.getTime()):!(i===o)}function S(e,t){if(m.IsNullOrUndefined(e))return null;var r=N(e),n=e.SID;if(m.IsNullOrUndefined(r)||m.IsNullOrUndefined(t)||!(r in t))return null;var a=t[r];return m.IsNullOrUndefined(a)||m.IsNullOrUndefined(a[n.toString()])?null:a[n.toString()][0]}function N(e){return v(e).replace(d.offlineLogPrefix,"")}function C(e,t){if(m.IsNullOrUndefined(e))return null;var r=N(e),n=e.SID,a=e.operationType;if(a===c.SQLOperationType.Create||a===c.SQLOperationType.Delete||m.IsNullOrUndefined(r)||m.IsNullOrUndefined(t)||!(r in t))return null;var i=t[r][n.toString()];return m.IsNullOrUndefined(i)?null:i[1]}t.getOfflineLogTableNameForEntity=function(e){return d.offlineLogPrefix+e},t.convertEntityRecordsToNorSyncMainLog=function(e){for(var t=new Array(e.length),r=0;r<e.length;r++){var n=e[r],a=n.getValue(d.sqLiteResultsSidColumnName),i=n.getValue(d.sqLiteResultsLogTableIDColumnName).toString(),o=n.getValue(d.sqLiteResultsOperationTypeColumnName),s=new f.OfflineMainLog(a,i,o);t[r]=s}return t},t.getTableNameFromNorSyncMainLog=v,t.getEntityNameFromOfflineLogTableName=function(e){return e.replace(d.offlineLogPrefix,"")},t.getEntityRecordsForUpsyncAndRollback=function(e,t,r){var n,a;return o(this,void 0,void 0,(function(){var i,o,l,p,f,y,m,h,g,E,b,O,v,P,R,w,M,I,A;return s(this,(function(s){switch(s.label){case 0:return i=S(e,t),o=C(e,t),l=e.operationType,i?d.upsyncSkipTables.indexOf(e.logTableID)>=0?[2,[null,i]]:(m=N(e),[4,null===(a=null===(n=r.DataLayerConfiguration.MetadataProvider)||void 0===n?void 0:n.retrieveEntityAttributes)||void 0===a?void 0:a.call(n,m,p)]):(r.TraceManager.getTracer("upsync").error("getEntityRecordsForUpsyncAndRollback:primary entity log is empty"),[2,[null,null]]);case 1:switch(h=s.sent(),l){case c.SQLOperationType.Create:case c.SQLOperationType.Delete:p=i.get_fieldNames().filter((function(e){return d.unwantedEntityLogAttribute.indexOf(e)<0}));try{for(g=u(p),E=g.next();!E.done;E=g.next())_(R=E.value,i,h)&&i.markFieldChanged(R)}catch(e){w={error:e}}finally{try{E&&!E.done&&(M=g.return)&&M.call(g)}finally{if(w)throw w.error}}f=i,y=i;break;case c.SQLOperationType.Update:b=i.get_fieldNames(),O=o.get_fieldNames(),p=b.concat(O.filter((function(e){return b.indexOf(e)<0}))).filter((function(e){return d.unwantedEntityLogAttribute.indexOf(e)<0}));try{for(v=u(p),P=v.next();!P.done;P=v.next())T(R=P.value,i,o,h)&&(i.markFieldChanged(R),null==o||o.markFieldChanged(R))}catch(e){I={error:e}}finally{try{P&&!P.done&&(A=v.return)&&A.call(v)}finally{if(I)throw I.error}}f=o,y=i}return[2,[f,y]]}}))}))},t.getPrimaryEntityLogFromEntityMap=S,t.getEntityNameFromOfflineLog=N,t.getSecondaryEntityLogFromEntityMap=C,t.getCommandFromCommandLog=function(e){if(!m.IsNullOrUndefined(e)){var t=e.getValue(d.commandIdColumnName),r=e.getValue(d.commandNameColumnName).toString(),n=e.getValue(d.commandStatusColumnName),a=e.getValue(d.commandActionDataColumnName).toString();return new p.Command(t,r,n,a)}return new p.Command(h.LegacyGuid.get_empty(),"unknown",l.CommandReplayStatus.InProgress,"unknown")},t.getSqlCommandName=function(e){var t="";switch(e){case c.SQLOperationType.Create:t="create";break;case c.SQLOperationType.Delete:t="Delete";break;case c.SQLOperationType.Update:t="update";break;case c.SQLOperationType.Retrieve:t="retrieve"}return t},t.getUpsyncCommandTypeName=function(e){var t="";switch(e){case y.CommandType.crud:t="crud";break;case y.CommandType.nonCrud:t="nonCrud"}return t},t.addPrefix=function(e,t){return"["+e+"] "+t},t.getPrimaryAttributeNameForNonCrmTable=function(e){var t={};return t[d.commandOperationTableName]=d.commandOperationCommandIdColumnName,t[d.commandTableName]=d.commandIdColumnName,t[d.businessProcessFlowInstanceTableName]=d.businessProcessFlowInstancePrimaryAttributeId,t[e]}},rx97:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.isEntityAvailableForOfflineUsage=t.getOfflineEnabledEntities=t.getOfflineDisabledEntities=void 0;var n=r("/jqC"),a=r("Gcp0");function i(e){return e&&e.offline&&e.offline.client&&e.offline.client.offlineDisabledEntities?e.offline.client.offlineDisabledEntities:null}function o(e){var t=n.getOfflineProfileAvailableEntities(e)||[],r=i(e)||[];return t.filter((function(e){return-1===r.indexOf(e)}))}t.getOfflineDisabledEntities=i,t.getOfflineEnabledEntities=o,t.isEntityAvailableForOfflineUsage=function(e,t){return a.isOfflineAvailableForUse(e)&&-1!==o(e).indexOf(t)}},rxGJ:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function n(e){return e&&e.garbageCollector?e.garbageCollector.metadata:null}function a(e){return e&&e.garbageCollector?e.garbageCollector.data:null}Object.defineProperty(t,"__esModule",{value:!0}),t.getGCListQueryDataRefCount=t.getGCListsData=t.getGCChartStorageKeyRefCount=t.getGCChartVisualizationViewRefCount=t.getGCChartDataByStorageKey=t.getGCChartsData=t.getGCEntityRecordDataRefCount=t.getGCEntitiesData=t.getGCEntityMetadataRefCount=t.getGCEntitiesMetadata=t.getGCRibbonMetadataRefCount=t.getGCRibbonsMetadata=void 0,t.getGCRibbonsMetadata=function(e){var t,r=n(e);return r&&null!==(t=r.ribbons)&&void 0!==t?t:null},t.getGCRibbonMetadataRefCount=function(e,t){var r=n(e);return r&&r.ribbons?r.ribbons[t]:null},t.getGCEntitiesMetadata=function(e){var t,r=n(e);return r&&null!==(t=r.entities)&&void 0!==t?t:null},t.getGCEntityMetadataRefCount=function(e,t){var r=n(e);return r&&r.entities?r.entities[t]:null},t.getGCEntitiesData=function(e){var t=a(e);return t&&t.entities?t.entities:null},t.getGCEntityRecordDataRefCount=function(e,t,r){var n=a(e);return n&&n.entities&&n.entities[t]?n.entities[t][r]:null},t.getGCChartsData=function(e){var t=a(e);return t&&t.charts?t.charts:null},t.getGCChartDataByStorageKey=function(e){var t=a(e);return t&&t.chartData?t.chartData:null},t.getGCChartVisualizationViewRefCount=function(e,t,r){var n=a(e);return n&&n.charts&&n.charts[t]?n.charts[t][r]:null},t.getGCChartStorageKeyRefCount=function(e,t){var r=a(e);return r&&r.chartData&&r.chartData[t]?r.chartData[t]:null},t.getGCListsData=function(e){var t=a(e);return t&&t.lists?t.lists:null},t.getGCListQueryDataRefCount=function(e,t){var r=a(e);return r&&r.lists&&r.lists[t]?r.lists[t]:null}},"s+yA":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LegacyAliasedValue=void 0;var n=r("WHxM"),a=function(){function e(e,t,r){this._entityLogicalName=e,this._attributeLogicalName=t,this._attributeType=r}return e.prototype.get_entityLogicalName=function(){return this._entityLogicalName},e.prototype.get_attributeLogicalName=function(){return this._attributeLogicalName},e.prototype.get_attributeType=function(){return this._attributeType},e.prototype.get_value=function(){return this._innerValue},e.prototype.set_value=function(e){return this._innerValue=e,e},e.prototype.getObjectData=function(){return{entityLogicalName:this._entityLogicalName,attributeLogicalName:this._attributeLogicalName,attributeType:this._attributeType,value:n.EntityRecord.InternalGetFieldObjectData(this._innerValue,this._attributeType)}},e.createFromObjectData=function(t){var r=t.attributeLogicalName,a=t.entityLogicalName,i=t.attributeType,o=t.value,s=i,u=new e(a,r,s);return u.set_value(n.EntityRecord.InternalCreateFieldFromObjectData(o,s)),u},e}();t.LegacyAliasedValue=a,a.__typeName="Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.AliasedValue"},tUL6:function(e,t,r){"use strict";r.r(t),r.d(t,"getRequestType",(function(){return s}));var n=r("hER9"),a=r("d61F"),i=r("fKp2");
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
const o={};function s(e,t){const r=t?t.TraceManager.getTracer(i.COMPONENT_NAMES.UrlParserHandler):null,s=[];Object(a.c)(e,s,n.UNKNOWN);let u="";switch(e.method){case n.HTTP_REQUEST_METHOD.Post:u=-1!==e.url.indexOf("/$batch")?o[e.method].Batch:-1!==e.url.indexOf("/$ref")?o[e.method].Update:o[e.method].Create;break;case n.HTTP_REQUEST_METHOD.Get:if(e.url.match("/GetClientMetadata"))u=o[e.method].GetClientMetadata;else{const t=e.url.indexOf("("),r=e.url.indexOf("?");-1===t&&-1===r&&(u=o[e.method].RetrieveMultiple),u=-1!==t&&-1!==r?t<r?o[e.method].Retrieve:o[e.method].RetrieveMultiple:-1===t?o[e.method].RetrieveMultiple:o[e.method].Retrieve}break;case n.HTTP_REQUEST_METHOD.Patch:u=e.additionalHeaders&&"application/octet-stream"===e.additionalHeaders["Content-Type"]?o[e.method].Upload:o[e.method].Patch;break;case n.HTTP_REQUEST_METHOD.Delete:u=e.url.lastIndexOf(")")+1>=e.url.length||e.url.indexOf("$filter")>=0||-1!==e.url.indexOf("/$ref")?o[e.method].Delete:o[e.method].FileDelete;break;default:const t="Request type is not supported";if(r)throw r.error(`${l?`[${l}]`:`[${i.FILE_PREFIX.UrlParserHandler}]`} ${t}`,s),new Error(t);u=n.UNKNOWN}var l;return u}o[n.HTTP_REQUEST_METHOD.Post]={Batch:n.OPERATION.Batch,Create:n.OPERATION.Create,Update:n.OPERATION.Update},o[n.HTTP_REQUEST_METHOD.Get]={GetClientMetadata:n.OPERATION.GetClientMetadata,RetrieveMultiple:n.OPERATION.RetrieveMultiple,Retrieve:n.OPERATION.Retrieve},o[n.HTTP_REQUEST_METHOD.Patch]={Patch:n.OPERATION.Update,Upload:n.OPERATION.Upload},o[n.HTTP_REQUEST_METHOD.Delete]={Delete:n.OPERATION.Delete,FileDelete:n.OPERATION.FileDelete}},tcxr:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.isINavigationErrorStatus=t.addErrorParameters=t.cloneUciError=t.createUciError=t.UCI_ERROR_NAME=void 0;t.UCI_ERROR_NAME="UciError";t.createUciError=function(e,t,r,n,a,i,o){void 0===o&&(o=!1);var s=new Error(e);return s.name="UciError",s.errorCode=t,s.errorParameters=r,s.displayTitle=n,s.displayMessage=a,s.blockErrorReporting=o,i&&(s.stack=i),s},t.cloneUciError=function(e){if(!e){var t=new Error("Received blank error object");return t.name="UciError",t.errorCode=2147746581,t}var r=new Error(e.message);return r.name="UciError",r.errorCode=e.errorCode||2147746581,r.errorParameters=e.errorParameters,r.displayTitle=e.displayTitle,r.displayMessage=e.displayMessage,r.blockErrorReporting=e.blockErrorReporting,r.innerError=e.innerError,e.stack&&(r.stack=e.stack),r},t.addErrorParameters=function(e,t){e&&t&&(e.errorParameters?e.errorParameters=e.errorParameters.concat(t):e.errorParameters=t)},t.isINavigationErrorStatus=function(e){return e&&e.errorCode}},tnR8:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.OfflineDatSyncComponent=t.WEB_API_SERVICE_COMPONENT=t.CRM_ERROR_CODE=t.CLIENT_REQUEST_ID=t.IS_OFFLINE_BY_DEFAULT_REQUEST=t.ENTITY_NAME=t.REQUEST_METHOD=t.REQUEST_URL=t.REQUEST_DETAILS=t.UNKNOWN=t.API_FRAGMENT_9_1=void 0,t.API_FRAGMENT_9_1="&api-version=9.1",t.UNKNOWN="Unknown",t.REQUEST_DETAILS="Request-Details",t.REQUEST_URL="Request-Url",t.REQUEST_METHOD="Method",t.ENTITY_NAME="Entity-Name",t.IS_OFFLINE_BY_DEFAULT_REQUEST="Is-Offline-By-Default-Request",t.CLIENT_REQUEST_ID="Client-Request-Id",t.CRM_ERROR_CODE="Crm-Error-Code",t.WEB_API_SERVICE_COMPONENT="Storage:WebAPIService",t.OfflineDatSyncComponent="OfflineDataSync"},uVVg:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isExpression=t.isEntityNameTerm=t.isValueTerm=t.isAttributeTerm=void 0,t.isAttributeTerm=function(e){return!!e.attributeName},t.isValueTerm=function(e){return null!==e.value&&void 0!==e.value},t.isEntityNameTerm=function(e){return!!e.entityName},t.isExpression=function(e){return!!e.terms}},v7pd:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LogicalOperator=void 0,function(e){e[e.And=0]="And",e[e.Or=1]="Or",e[e.Not=2]="Not"}(t.LogicalOperator||(t.LogicalOperator={}))},vUwf:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.LegacyQuery=void 0;var n=r("+Axb"),a=r("iLQe"),i=r("Zwof"),o=r("GokG"),s=r("x+vU"),u=r("az3V"),l=r("lwwF"),c=r("nf9M"),d=r("9byC"),p=function(){function e(e){this._columnSet=null,this._descriptorSet=null,this._noLock=!1,this._pageNumber=1,this._pageSize=1,this._entityLogicalName=null,this._returnTotalRecordCount=!1,this._status=[],this._pagingCookie="",c.IsNullOrUndefined(e)||this._CreateQuery(e)}return e.prototype.get_ColumnSet=function(){return this._columnSet},e.prototype.set_ColumnSet=function(e){return this._columnSet=e,e},e.prototype.set_ColumnNames=function(e){return this._columnNames=e,e},e.prototype.get_DescriptorSet=function(){return this._descriptorSet},Object.defineProperty(e.prototype,"queryStatus",{get:function(){return this._status},enumerable:!1,configurable:!0}),e.prototype._set_DescriptorSet=function(e){return this._descriptorSet=e,e},e.prototype.get_FetchXml=function(){var t,r,a,i=this.rawFetchXmlDoc;return i&&i.firstChild&&(null===(t=i.firstChild)||void 0===t?void 0:t.nodeName)&&(null===(r=i.firstChild)||void 0===r?void 0:r.nodeName)!==e._FetchXmlNodeName?this.get_rawFetchXml():(d.setFetchXmlParameters(this.rawFetchXmlDoc,this.get_PageSize(),this.get_PageNumber(),!0,this._get_NoLock()),i&&!c.IsNullOrUndefinedOrEmptyString(this.get_PagingCookie())&&i.firstChild.attributes.setNamedItem(u.XmlNode.createAttribute(i,e._PagingCookieXmlAttributeName,this.get_PagingCookie())),null===(a=n.create(i))||void 0===a?void 0:a.get_outerXml())},e.prototype.set_FetchXml=function(t){if(c.IsNullOrUndefinedOrEmptyString(t)||"<"!==t.substr(0,1))this.set_ColumnSet(new i.LegacyColumnSet(new Array(0)));else{var r=n.parseXmlDocument(t);if(this.rawFetchXmlDoc=r,!c.IsNullOrUndefined(r)){var o=n.create(r),s=null==o?void 0:o.selectSingleNode("/"+e._FetchXmlNodeName);if(s&&!c.IsNullOrUndefined(s)){var u=s.getAttribute(e._PageNumberXmlAttributeName);c.IsNullOrUndefined(u)||this.set_PageNumber(+u),u=s.getAttribute(e._PageSizeXmlAttributeName),c.IsNullOrUndefined(u)||this.set_PageSize(+u),u=s.getAttribute(e._PagingCookieXmlAttributeName),c.IsNullOrUndefined(u)||this.set_PagingCookie(u);var l=null==o?void 0:o.selectSingleNode("/fetch/entity");if(l&&!c.IsNullOrUndefined(l)&&this.set_EntityLogicalName(l.getAttribute("name")),o&&!c.IsNullOrUndefined(o.selectSingleNode("/fetch/entity/all-attributes")))this.set_ColumnSet(a.AllColumns.get_instance());else{var d=[],p=null==o?void 0:o.selectNodes("/fetch/entity/attribute");if(p)for(var f=0;f<p.get_count();f++){var y=p.get_item(f);if(y&&y.getAttribute("name")){var m=y.getAttribute("name");d.push(m)}}this.set_ColumnSet(new i.LegacyColumnSet(d))}var h=!!r&&r.firstChild.attributes.getNamedItem(e._ReturnTotalRecordCountAttributeName);this._returnTotalRecordCount=c.IsNullOrUndefined(h)?e._DefaultReturnTotalRecordCountValue:"true"===h}}}return t},e.prototype.get_PageNumber=function(){return this._pageNumber},e.prototype.set_PageNumber=function(e){if(e<1)throw Error("PageNumber cannot be less than 1");return this._pageNumber=e,e},e.prototype._get_NoLock=function(){return this._noLock},e.prototype.set_NoLock=function(e){return this._noLock=e,e},e.prototype.get_PageSize=function(){return this._pageSize},e.prototype.set_PageSize=function(e){return this._pageSize=e,e},e.prototype.get_PagingCookie=function(){return this._pagingCookie},e.prototype.set_PagingCookie=function(e){return c.IsNullOrUndefinedOrEmptyString(e)&&(this._pagingCookie=""),this._pagingCookie=e,e},e.prototype.get_EntityLogicalName=function(){return this._entityLogicalName},e.prototype.set_EntityLogicalName=function(e){return this._entityLogicalName=e,e},e.prototype.get_returnTotalRecordCount=function(){return this._returnTotalRecordCount},e.prototype.get_id=function(){return this.get_rawFetchXml()},e.prototype.get_RawSql=function(){var e;return null===(e=this.get_DescriptorSet())||void 0===e?void 0:e.tryGetDescriptor(o.DescriptorFormat.Sql)},e.prototype.set_RawSql=function(e){var t;return c.IsNullOrUndefined(this._descriptorSet)||null===(t=this._descriptorSet)||void 0===t||t.updateDescriptorSet(o.DescriptorFormat.Sql,e),e},e.prototype.get_rawFetchXml=function(){var e;return this.rawFetchXmlDoc?null===(e=n.create(this.rawFetchXmlDoc))||void 0===e?void 0:e.get_outerXml():""},e.prototype.get_FetchXmlForAliasedValues=function(){return this._fetchXmlForAliasedValues},e.prototype.set_FetchXmlForAliasedValues=function(e){this._fetchXmlForAliasedValues=e},e.prototype._CreateQuery=function(e){if(e instanceof l.DescriptorSet)for(var t in this._descriptorSet=new l.DescriptorSet,e.get_descriptors()){var r=e.get_descriptors()[t];this._descriptorSet.get_descriptors()[o.DescriptorFormat[r.Format]]=new s.DescriptorData(r.Format,r.Data),r.Format===o.DescriptorFormat.FetchXml&&this.set_FetchXml(r.Data)}else this.set_FetchXml(e.toString()),this._set_DescriptorSet(l.DescriptorSet.createFromFetchXml(e.toString()))},e.prototype.toString=function(){return"Query: "+this.get_rawFetchXml()},e.prototype.GetColumnNamesFromFetch=function(){return c.IsNullOrUndefined(this._columnNames)?d.getColumnNamesFromFetch(this.rawFetchXmlDoc):this._columnNames},e.prototype.generateOfflineAttributeName=function(e,t,r){return t},e.get_empty=function(){return new e("")},e._PageNumberXmlAttributeName="page",e._PageSizeXmlAttributeName="count",e._PagingCookieXmlAttributeName="paging-cookie",e._ReturnTotalRecordCountAttributeName="returntotalrecordcount",e._FetchXmlNodeName="fetch",e._DefaultReturnTotalRecordCountValue=!0,e}();t.LegacyQuery=p},vf6J:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LegacyDependencyDepth=void 0,function(e){e[e.Unknown=0]="Unknown",e[e.OnDemandWithContext=1]="OnDemandWithContext",e[e.OnDemandWithoutContext=2]="OnDemandWithoutContext",e[e.OnDemandContextOnly=3]="OnDemandContextOnly",e[e.Offline=4]="Offline",e[e.Mobile=5]="Mobile",e[e.UserContext=6]="UserContext"}(t.LegacyDependencyDepth||(t.LegacyDependencyDepth={}))},wjOh:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.getMetadataVersionState=t.getMetadataVersion=void 0;var n=r("KkiZ");function a(e){return e&&e.metadata&&e.metadata.metadataVersion?e.metadata.metadataVersion:null}t.getMetadataVersion=a,t.getMetadataVersionState=function(e){var t=a(e);return t?t.initialized:n.InitState.Uninitialized}},"x+vU":function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.DescriptorData=void 0;var n=function(e,t){this.Format=0,this.Format=e,this.Data=t};t.DescriptorData=n},"x/rv":function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.unescapeClientMetadataQueryValue=void 0,t.unescapeClientMetadataQueryValue=function(e){return null==e?void 0:e.replace(/\\"/gi,'"')}},x0cL:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.EntityReference=void 0;var n=r("Ln9p"),a=r("rW8f"),i=function(){function e(e,t,r){this.etn=e,this.id=t||n.Guid.EMPTY,this.name=r,Object.freeze(this)}return e.toString=function(e){return e.etn+":"+n.Guid.toString(e.id)},e.equals=function(t,r){var n=e.equalsIgnoreName(t,r);return t&&r?(t.name&&r.name&&(n=n&&t.name===r.name),n):n},e.equalsIgnoreName=function(e,t){return!e&&!t||!(!e||!t)&&(e.etn===t.etn&&n.Guid.equals(e.id,t.id))},e.toLegacyEntityReference=function(e){return new a.LegacyEntityReference(e.etn,n.Guid.toLegacyGuid(e.id),e.name)},e.fromLegacyEntityReference=function(t){return new e(t.LogicalName,n.Guid.fromLegacyGuid(t.Id),t.Name)},e.fromExternalEntityReference=function(t){return new e(t.entityType,n.Guid.fromExternalGuid(t.id))},e.legacyToExternalEntityReference=function(e){return{id:n.Guid.externalGuid(n.Guid.fromLegacyGuid(e.Id)),entityType:e.LogicalName}},e.toExternalEntityReference=function(e){return{id:n.Guid.externalGuid(e.id),entityType:e.etn}},e.EMPTY=new e(""),e}();t.EntityReference=i},"xB8/":function(e,t,r){"use strict";r.r(t),r.d(t,"ConsoleEventManager",(function(){return a}));var n=r("fKp2");
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */class a{getCurrentSessionId(){return""}getActivityId(){return""}ReportComponentPerformance(e,t,r,n,a){this._dispatchEvent("performance",e,t+": "+r,n)}ReportComponentSuccess(e,t){this._dispatchEvent("success",e,void 0,t)}ReportComponentFailure(e,t,r,n){this._dispatchEvent("failure",e,JSON.stringify(t),n)}ReportEvent(e,t){}_dispatchEvent(e,t,r,a){console.log(`${e}: ${String(t+"                        ").slice(0,24)} --- ${r||n.EVENT_PARAMETERS.EMPTY_STRING} \n ${a?JSON.stringify(a):n.EVENT_PARAMETERS.EMPTY_STRING}`)}}},xHQC:function(e,t,r){"use strict";r.r(t),r.d(t,"buildBatchResponse",(function(){return a}));var n=r("hER9");
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */async function a(e,t){let r="";t||(t="batch_"+(new Date).getTime());for(let a=0;a<e.length;a++){const s=e[a];r+="--"+t+"\n";let u="";if(Array.isArray(s)){const e=s,o=`changeset_${t}-${a}`;u=await i(o,e),r+=`${n.HEADER.CONTENT_TYPE}: multipart/mixed;boundary=${o}\n`}else{const e=s;u=await o(e),r+=`${n.HEADER.CONTENT_TYPE}: ${n.HEADER_VALUES.APPLICATION_HTTP}\n${n.HEADER.CONTENT_TRANSFER_ENCODING}: ${n.HEADER_VALUES.BINARY}\n`}r+="\n",r+=u,r+="\n"}const a=`--${t}--\r\n\0`;r.endsWith(a+"\n")?r=r.substr(0,r.length-1):r+=a;return function(e,t,r){let a=!0,i=200,o="OK";for(const t of e)if(Array.isArray(t)){const e=t.filter(e=>!e.ok);if(e.length>0){a=!1,i=e[0].status,o=e[0].statusText;break}}else if(!t.ok){a=!1,i=t.status,o=t.statusText;break}return{ok:a,status:i,statusText:o,clone(){return Object.assign({},this)},json:()=>Promise.resolve(t||{}),text:()=>Promise.resolve(t||""),headers:new Headers({[n.HEADER.CONTENT_TYPE]:"multipart/mixed;boundary="+r}),url:"$batch"}}(e,r,t)}async function i(e,t){let r="",a=1;for(const i of t)r+="--"+e+"\n",r+=`${n.HEADER.CONTENT_TYPE}: ${n.HEADER_VALUES.APPLICATION_HTTP}\n${n.HEADER.CONTENT_TRANSFER_ENCODING}: ${n.HEADER_VALUES.BINARY}\n`,i.ok?r+=`${n.HEADER.CONTENT_ID}: ${a}\n`:r+=`${n.HEADER.CONTENT_ID}: ${i.headers.get(n.HEADER.CONTENT_ID)}`,a++,r+="\n",r+=await o(i),r+="\n";return r+="--"+e+"--\n",r}async function o(e){let t=`HTTP/1.1 ${e.status} ${e.statusText}\n`;if([n.HEADER.REQ_ID,n.HEADER.CONTENT_TYPE,n.HEADER.PREFERENCE_APPLIED,n.HEADER.ODADTA_ENTITY_ID,n.HEADER.LOCATION].forEach(r=>{e.headers.has(r)&&(t+=`${r}: ${e.headers.get(r)}\n`)}),e.headers.get(n.HEADER.CONTENT_TYPE)===n.HEADER_VALUES.APPLICATION_JSON){const r=await e.json();t+="\n"+JSON.stringify(r)}return t}},xKvi:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.CodeCacheState=void 0,function(e){e[e.Waiting=1]="Waiting",e[e.Initializing=2]="Initializing",e[e.Ready=3]="Ready",e[e.Error=4]="Error"}(t.CodeCacheState||(t.CodeCacheState={}))},xQ7h:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.retrieveEntityMetadata=t.RETRIEVE_ENTITY_METADATA=void 0;t.RETRIEVE_ENTITY_METADATA="entityMetadata.retrieve",t.retrieveEntityMetadata=function(e){return{type:"entityMetadata.retrieve",payload:e}}},xnbY:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.getClientHostSubtypeNameForTelemetry=t.getClientHostVersionString=t.getClientHostName=t.getClientHost=void 0;var n=r("hER9"),a=r("+95i"),i=r("KijC");function o(e){return e&&e.clientHost?e.clientHost.type:a.ClientHost.Unknown}function s(e){switch(function(e){return e&&e.clientHost?e.clientHost.subtype:i.ClientHostSubtype.Unknown}(e)){case i.ClientHostSubtype.Phone:return"Phone";case i.ClientHostSubtype.Tablet:return"Tablet";default:return n.UNKNOWN}return""}t.getClientHost=o,t.getClientHostName=function(e){return function(e){switch(e){case a.ClientHost.Browser:return"Browser";case a.ClientHost.MobileApplication:return"MobileApplication";case a.ClientHost.MailApp:return"MailApp";default:return n.UNKNOWN}return n.UNKNOWN}(o(e))},t.getClientHostVersionString=function(e){var t=function(e){return e&&e.clientHost?e.clientHost.version:null}(e);return t&&t.version?t.version+"."+t.build+" ("+t.revision+","+t.nativeRevision+")":""},t.getClientHostSubtypeNameForTelemetry=function(e){var t,r=null===(t=null==e?void 0:e.session)||void 0===t?void 0:t.hostSubtype;return r||s(e)}},xtAd:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return a(t,e),t},o=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.buildRetrieveRequestWithURLParams=t.buildRetrieveContract=void 0;var s=r("yNq8"),u=i(r("6QHb")),l=r("Ln9p"),c=r("nf9M"),d=r("cj/A"),p=r("UxT/"),f=r("+MPC"),y=r("Tpz3"),m=r("Wc7r"),h=r("f7K7"),g=r("LTKH");t.buildRetrieveContract=function(e,t,r,n,a){var i,E,b,O,v,_=[],T=[];try{for(var S=o(r),N=S.next();!N.done;N=S.next()){var C=N.value,P=g.getAttributeDescriptor(e,t.etn,C);if(!P)throw new f.ErrorStatus("Cannot serialize a request with no attribute metadata for "+t.etn+"."+C);if(P.Type===s.AttributeType.PartyList){if(!(v=p.getActivityPartyNavigationPropertyRelationship(e,t.etn))){O="The relationship for the partylist attribute "+C+" is not found in the state tree or is invalid";break}var R=d.getParticipationTypeMask(t.etn,C);if(void 0===R)throw new f.ErrorStatus("Unknown participation type mask for attribute "+C);T.push(R)}else P&&-1!==y.SupportedLookupProperties.indexOf(P.Type)?_.push("_"+C+"_value"):_.push(C)}}catch(e){i={error:e}}finally{try{N&&!N.done&&(E=S.return)&&E.call(S)}finally{if(i)throw i.error}}var w="";if(T.length){var M="$filter=Microsoft.Dynamics.CRM.In(PropertyName='participationtypemask',PropertyValues=["+T.map((function(e){return"'"+e+"'"}))+"])";w="&$expand="+v.ReferencedEntityNavigationPropertyName+"("+M+")"}var I=function(e,t,r,n){var a,i,l,f,m,h="",E=[];if(n){var b="";try{for(var O=o(n),v=O.next();!v.done;v=O.next()){var _=v.value,T=_.get_relationShipName(),S=_.get_columnNames(),N=[],C=p.getRelationShipByNavigationProperty(e,t.etn,T);if(C){var P=p.getRelationshipTypeByNavigationProperty(e,t.etn,T)===u.RelationshipType.OneToManyRelationship?C.ReferencingEntity:C.ReferencedEntity;try{for(var R=(l=void 0,o(S)),w=R.next();!w.done;w=R.next()){var M=w.value,I=g.getAttributeDescriptor(e,P,M);if(!I){m="Cannot serialize a request with no attribute metadata for "+P+"."+M;break}if(I.Type===s.AttributeType.PartyList){if(!p.getActivityPartyNavigationPropertyRelationship(e,P)){m="The relationship for the partylist attribute "+M+" is not found in the state tree or is invalid";break}var A=d.getParticipationTypeMask(P,M);if(void 0===A){m="Unknown participation type mask for attribute "+M;break}E.push(A)}else I&&-1!==y.SupportedLookupProperties.indexOf(I.Type)?N.push("_"+M+"_value"):N.push(M)}}catch(e){l={error:e}}finally{try{w&&!w.done&&(f=R.return)&&f.call(R)}finally{if(l)throw l.error}}}N&&N.length>0&&(b=c.IsNullOrUndefinedOrEmptyString(b)?T+"($select="+N.join(",")+")":b+","+T+"($select="+N.join(",")+")")}}catch(e){a={error:e}}finally{try{v&&!v.done&&(i=O.return)&&i.call(O)}finally{if(a)throw a.error}}h="&$expand="+b}if(m&&r){r.TraceManager.getTracer("RetrieveRequestSerializer").error(m)}return h}(e,t,n,a),A=new h.ODataRetrieveWithUrlParamsRequest(t.etn,l.Guid.toString(t.id),"?$select="+_.join(",")+w+I,((b={})[m.HEADER.PREFER]=m.HEADER_VALUES.ANNOTATIONS,b[m.HEADER.ACCEPT]=m.HEADER_VALUES.APPLICATION_JSON,b[m.HEADER.MSCRM_RETURN_NOTIFICATIONS]="true",b));return O&&n&&n.TraceManager.getTracer("RetrieveRequestSerializer").error(O),A},t.buildRetrieveRequestWithURLParams=function(e,t,r,n,a,i){var o,s=a&&"number"==typeof a?",odata.maxpagesize="+a:"",u={urlParameters:""+p.getEntitySetName(e,t)+(r&&l.Guid.isNullOrEmpty(l.Guid.tryParse(r))?"":"("+r+")")+(n||""),additionalHeaders:(o={},o[m.HEADER.PREFER]=""+m.HEADER_VALUES.ANNOTATIONS+s,o[m.HEADER.ACCEPT]=m.HEADER_VALUES.APPLICATION_JSON,o[m.HEADER.MSCRM_RETURN_NOTIFICATIONS]="true",o),method:"GET"};return i&&"object"==typeof i&&Object.assign(u.additionalHeaders,i),u}},yNq8:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
var n;r.r(t),r.d(t,"AttributeType",(function(){return n})),function(e){e.Boolean="boolean",e.Unknown="unknown",e.Customer="customer",e.Date="date",e.DateTime="datetime",e.Decimal="decimal",e.Double="double",e.Image="image",e.Integer="integer",e.Lookup="lookup",e.ManagedProperty="managedproperty",e.Memo="memo",e.Money="money",e.Owner="owner",e.PartyList="partylist",e.PickList="picklist",e.State="state",e.Status="status",e.String="string",e.UniqueIdentifier="uniqueidentifier",e.CalendarRules="calendarrules",e.Virtual="virtual",e.BigInt="bigint",e.EntityName="entityname",e.EntityImage="entityimage",e.AliasedValue="aliasedvalue",e.Regarding="regarding",e.MultiSelectPickList="multiselectpicklist",e.File="file",e.NavigationProperty="navigationproperty"}(n||(n={}))},ykA9:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.getHttpHeader=void 0,t.getHttpHeader=function(e,t){if(!e)return null;var r=e.get(t);return r||(r=e.get(t.toLowerCase())),r}},z4R1:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.serializeComplexTypeParameter=t.serializeIntoURLFragment=t.getODataUrlForFunction=t.serializeContract=void 0;var o=i(r("fzfk")),s=r("Ln9p"),u=r("UxT/"),l=r("OTPx"),c=r("D7ZV"),d=r("RXZ1"),p={COLON:encodeURIComponent(":"),OPEN_BRACKET:encodeURIComponent("{"),CLOSED_BRACKET:encodeURIComponent("}"),COMMA:encodeURIComponent(","),EQUAL:encodeURIComponent("=")};function f(e,t){var r=t.getMetadata().boundParameter,n=[],a=Object.keys(t).filter((function(e){return e!==r})).map((function(r){var a=t.getMetadata().parameterTypes[r],i=b(e,t,r,!1,!0);return void 0!==a&&o.ODataStructuralProperty.EnumerationType===a.structuralProperty?r+"="+i:(n.push("@"+r+"="+i),r+"=@"+r)}));return n.length?"("+a.join(",")+")?"+n.join("&"):"("+a.join(",")+")"}function y(e,t,r,n){switch(e){case"Edm.String":return m(e,t,r,n);case"Edm.Guid":return m(e,t.guid,r,n);case"Edm.DateTimeOffset":if("object"==typeof t&&"function"==typeof t.toISOString)return m(e,t.toISOString(),r,n);default:return m("Edm.UndefinedType",t,r,n)}}function m(e,t,r,n){switch(function(e,t,r){var n=r?t?l.EncodeRule.DoubleQuotesURL:l.EncodeRule.NoQuotesURL:l.EncodeRule.Contract;return n===l.EncodeRule.Contract?"Edm.UndefinedType"===e?n=l.EncodeRule.None:"Edm.String"===e&&(n=l.EncodeRule.JsonifyURL):n===l.EncodeRule.NoQuotesURL&&"Edm.String"===e?n=l.EncodeRule.SingleQuotesURL:n===l.EncodeRule.DoubleQuotesURL&&"Edm.UndefinedType"===e&&(n=l.EncodeRule.NoQuotesURL),n}(e,r,n)){case l.EncodeRule.JsonifyURL:return JSON.stringify(t);case l.EncodeRule.SingleQuotesURL:return"'"+c.encodeURIComponentForOData(t)+"'";case l.EncodeRule.DoubleQuotesURL:return'"'+c.encodeURIComponentForOData(t)+'"';case l.EncodeRule.NoQuotesURL:return c.encodeURIComponentForOData(t);case l.EncodeRule.Contract:return'"'+t+'"';default:return t}}function h(e,t,r,n){if(void 0===n&&(n=!1),t){var a="{",i="",o=n?p.COLON:":";if(r){var s=t.getMetadata().typeName;s&&r.typeName!==s&&(a+='"@odata.type"'+o+'"'+s+'"',i=",")}for(var u in t)if("function"!=typeof t[u]){var l=b(e,t,u,!0,n);if(g(t,u,l))continue;a+=i+'"'+u+'"'+o+l,i||(i=",")}return a+"}"}return"null"}function g(e,t,r){if(e instanceof d.MetadataQuery){if([null,"null","[]",""].indexOf(r)>=0)return!0;if("DependencyDepth"===t&&e[t]===l.DependencyDepth.OnDemandWithoutContext)return!0}return!1}function E(e,t,r,n){var a=c.getEnumValueMetadata(e,t);return null==a?"":r?m(t.typeName,a.name,r,n):t.typeName+"'"+a.name+"'"}function b(e,t,r,n,a){void 0===n&&(n=!1),void 0===a&&(a=!1);var i=t.getMetadata(),s=t[r];if(r&&0===r.indexOf("@odata."))return'"'+s+'"';var u=i.parameterTypes[r];if(void 0===u)return null;switch(u.structuralProperty){case o.ODataStructuralProperty.PrimitiveType:return null==s?null:"MetadataSubtype"===r&&"Edm.String"===u.typeName?'"'+s+'"':y(u.typeName,s,n,a);case o.ODataStructuralProperty.EntityType:return c.serializeEntityType(e,s,n,a);case o.ODataStructuralProperty.ComplexType:return h(e,s,u,a);case o.ODataStructuralProperty.EnumerationType:return E(s,u,n,a);case o.ODataStructuralProperty.Collection:return s?s.length?s[0].getMetadata?"["+s.map((function(t){return h(e,t,void 0,a)})).join(",")+"]":-1!==c.ODataPrimitives.indexOf(u.typeName)?"["+s.map((function(e){return y(u.typeName,e,n,a)})).join(",")+"]":u.enumProperties?"["+s.map((function(e){return E(e,u,n,a)})).join(",")+"]":"number"==typeof s[0]?"["+s.map((function(e){return y("Edm.String",e,n,a)})).join(",")+"]":"["+s.map((function(t){return c.serializeEntityType(e,t,n,a)})).join(",")+"]":"[]":"null";default:return null}}t.serializeIntoURLFragment=f,t.serializeContract=h,t.serializeComplexTypeParameter=b,t.getODataUrlForFunction=function(e,t){return""+function(e,t,r){if(!t)throw new Error("Cannot generate base URL for the OData call: the routine name is empty.");if(!r)throw new Error("Cannot generate base URL for the OData call: the request is empty.");if(!r.getMetadata())throw new Error("Cannot generate base URL for the OData call: the request metadata is empty.");var n=r.getMetadata().boundParameter;if(n){var a=r.getMetadata();if(!a||!a.parameterTypes||!a.parameterTypes[n])return null;if(a.parameterTypes[n].structuralProperty===o.ODataStructuralProperty.Collection){var i=a.parameterTypes[n].typeName&&a.parameterTypes[n].typeName.split(".").pop();return i&&(l=u.getEntitySetName(e,i))?l+"/Microsoft.Dynamics.CRM."+t:null}var l,c=r[n];return(l=u.getEntitySetName(e,c.entityType))+"("+s.Guid.fromExternalGuid(c.id).guid+")/Microsoft.Dynamics.CRM."+t}return""+t}(e,t.getMetadata().operationName,t)+f(e,t)}},z87Q:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.canLogDetailsOfRequest=t.trimUrl=void 0;var n=r("nf9M");function a(e){return!n.IsNullOrUndefined(e)&&(-1!==e.indexOf("GetClientMetadata")||-1!==e.indexOf("EntityDefinitions")||-1!==e.indexOf("SyncClientMetadata"))}t.trimUrl=function(e){if(n.IsNullOrUndefined(e))return e;if(a(e))return e;if(-1!==e.indexOf("fetchXml=")){var t=e.indexOf("fetchXml="),r=decodeURIComponent(e.substring(e.indexOf("fetchXml=")+"fetchXml=".length,e.length));return e.substring(0,t+"fetchXml=".length)+function(e){var t=new DOMParser,r=new XMLSerializer,n="X";if(e){var a=t.parseFromString(e,"text/xml");if(a){var i=Array.prototype.slice.call(a.getElementsByTagName("condition"));return i&&i.forEach((function(e){e.getAttribute("value")&&e.setAttribute("value",n),e.getAttribute("uiname")&&e.setAttribute("uiname",n);var t=Array.prototype.slice.call(e.getElementsByTagName("value"));t&&t.forEach((function(e){e.getAttribute("uiname")&&e.setAttribute("uiname",n),e.textContent=n}))})),r.serializeToString(a)}return null}return null}(r)}var i=e.indexOf("?");if(-1===i){var o=e.indexOf("=");return-1===o?e:e.substring(0,o)}return e.substring(0,i)},t.canLogDetailsOfRequest=a},zjpj:function(e,t,r){"use strict";r.d(t,"c",(function(){return o})),r.d(t,"d",(function(){return s})),r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return l}));var n=r("Szbx"),a=r("7l03"),i=r("fKp2");
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
function o(e,t,r,n=[]){if(!Object(a.isNullOrUndefined)(e))for(const i in e)if(i){const o=e[i];if(o&&o.EntitySetName===t){const e=o.EntityLogicalName;return Object(a.isNullOrUndefined)(e)&&r.error(`${c()} entity set name ${t} exits in the state but its entityLogicalName is null or undefined.`,n),e}}return null}function s(e,t,r,n=[]){if(!Object(a.isNullOrUndefined)(e))for(const i in e)if(i){const o=e[i];if(o&&o.ObjectTypeCode===t){const e=o.EntityLogicalName;return Object(a.isNullOrUndefined)(e)&&r.error(`${c()} entity with object type code ${t} exits in the state but its entityLogicalName is null or undefined.`,n),e}}return null}function u(e,t,r){const a=[];for(let i=0;i<r.length;i++)t[r[i]]||e[r[i]]&&e[r[i]].Initialized===n.a.Initialized||a.push(r[i]);return a}function l(e){const t={};for(const r of Object.keys(e))e[r].Initialized===n.a.Initialized&&(t[r]=e[r]);return t}function c(){return`[${i.FILE_PREFIX.MetadataUtil}]`}},zorh:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.buildFunctionRequest=void 0;var n=r("Wc7r"),a=r("z4R1"),i=r("0ksK");t.buildFunctionRequest=function(e,t,r){var o,s;void 0===r&&(r={});try{var u=a.getODataUrlForFunction(e,t),l=i.OPERATION_TYPE.FUNCTION,c=t.getMetadata().operationName||i.UNKNOWN_TYPE;c===i.OPERATION_TYPE.GCM&&(l=i.OPERATION_TYPE.GCM);var d=i.getRequestSource(r);return{urlParameters:u,additionalHeaders:(o={},o[n.HEADER.ACCEPT]=n.HEADER_VALUES.APPLICATION_JSON,o[n.HEADER.PREFER]=n.HEADER_VALUES.ANNOTATIONS,o),method:"GET",additionalParameters:(s={},s[i.OPERATION.TYPE]=l,s[i.OPERATION.SUB_TYPE]=c,s[i.OPERATION.SOURCE]=d,s)}}catch(e){return{serializationFailure:e.message}}}},zrAn:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.getOperationType=t.isBrowserOfflineEnabled=void 0;var n=r("+95i"),a=r("xnbY"),i=r("1SUZ"),o=r("AlX3"),s=r("0ksK");t.isBrowserOfflineEnabled=function(e){return(i.isFeatureEnabledByFCBName(e,o.BrowserOfflineEnabledForTest)||i.isFeatureEnabledByFCBName(e,o.MDLBrowserOfflineEnabledForTest))&&(t="openDatabase",void 0!==window.self[t])&&a.getClientHost(e)===n.ClientHost.Browser&&-1!==window.navigator.userAgent.indexOf("Chrome");var t},t.getOperationType=function(e){var t,r,n;return{type:(null===(t=e.additionalParameters)||void 0===t?void 0:t[s.OPERATION.TYPE])||s.UNKNOWN_TYPE,subType:(null===(r=e.additionalParameters)||void 0===r?void 0:r[s.OPERATION.SUB_TYPE])||s.UNKNOWN_TYPE,source:(null===(n=e.additionalParameters)||void 0===n?void 0:n[s.OPERATION.SOURCE])||s.OPERATION_SOURCE.Default}}}}]),window.bundleExecutionMarkers["scripts/35.js?v=1.4.3886-master"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();