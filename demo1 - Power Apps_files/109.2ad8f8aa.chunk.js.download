/*! For license information please see 109.2ad8f8aa.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[109],{5436:function(e,t,n){"use strict";n.r(t),n.d(t,"SolutionImportPanel",(function(){return W})),n.d(t,"SolutionImportPanelContainer",(function(){return q})),n.d(t,"buildSolutionComponentsList",(function(){return z})),n.d(t,"logStageSolutionTelemetry",(function(){return Q}));var o=n(1573),r=n(245),a=n(5437),i=n(5466),s=n(5468),l=n(5478),c=n(922),p=n(3076),u=n(6900),d=n(6376),m=n(6903),b=n(6906),g=n(6914),y=n(6916),S=n(6918),f=n(6754),h=n(6911),O=n(2868),C=n(6920),v=n(6921),P=n(6922),E=n(5690),T=n(2873),j=n(6924),A=n(217),R=n(6375),I=n(6710),w=n(6701),D=n(545),N=n(5611),L=n(2871),M=n(5613),x=n(1105),k=n(3713),F=n(3829);function _(){return(_=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}function U(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function V(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?U(Object(n),!0).forEach((function(t){B(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):U(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function B(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function H(e,t,n,o,r,a,i){try{var s=e[a](i),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(o,r)}function G(e){return function(){var t=this,n=arguments;return new Promise((function(o,r){var a=e.apply(t,n);function i(e){H(a,o,r,i,s,"next",e)}function s(e){H(a,o,r,i,s,"throw",e)}i(void 0)}))}}var W=Object(c.translateService)("PowerappsPortal")(e=>{var t,n,s=Object(r.useRef)(),l=Object(j.getSolutionImportPanelLabels)(e),c=()=>{e.onPanelClose()},{currentEnvironment:E}=Object(r.useContext)(x.EnvironmentContext),{environmentClient:N}=Object(r.useContext)(p.ApolloClientContext),{enableSolutionTreeView:M}=Object(F.useSolutionPageSelectorProvider)(),[U,B]=Object(r.useState)(d.SolutionImportPanelSteps.fileSelection),[H,W]=Object(r.useState)(void 0),[q,K]=Object(r.useState)(!1),[Y,J]=Object(r.useState)(!1),[X,Z]=Object(r.useState)(void 0),[$,ee]=Object(r.useState)(new Map),[te,ne]=Object(r.useState)(void 0),[oe,re]=Object(r.useState)(void 0),[ae,ie]=Object(r.useState)(void 0),[se,le]=Object(r.useState)(void 0),[ce,pe]=Object(r.useState)(void 0),ue=new D.Selection({getKey:e=>e.key,onSelectionChanged:()=>{var e,t=[];null==ue||null===(e=ue.getItems())||void 0===e||e.forEach(e=>{ue.isKeySelected(e.key)||t.push(e.key)}),le(t)}}),[de,me]=Object(r.useState)(ue),be=Object(a.useDispatch)(),[ge,ye]=Object(r.useState)(void 0),Se=Object(k.getUXContext)(null==E||null===(t=E.properties)||void 0===t?void 0:t.environmentSku),{connectionTypes:fe,loadConnectionTypesErrorMessage:he,loadConnectionsErrorMessage:Oe,isLoadingConnections:Ce,isLoadingConnectionTypes:ve,onRefreshConnections:Pe,onChangeConnectionSelection:Ee}=Object(I.useConnectionReferenceBehavior)(N,ee,te,ne,l.Errors.StandardErrorMessages,{environmentVariableDefinitions:oe,setEnvironmentVariableDefinitions:re},!0);function Te(){return(Te=G((function*(e){var t=yield O.MetadataClientInstance.getInstance().executeAction("StageSolution","StageSolution",void 0,{CustomizationFile:e}),n=yield Object(S.getExistingConnectionReferences)(N,t),{existingEnvironmentVariableValuesFromStagingResponse:o,existingEnvironmentVariableDefinitions:r}=yield Object(f.getExistingEnvironmentVariableValuesAndDefinitions)(t,O.MetadataClientInstance.getInstance());return ye(r),pe(t),V(V({},t),{},{ExistingConnectionReferences:n,ExistingEnvironmentVariableValues:o})}))).apply(this,arguments)}Object(r.useEffect)(()=>{ae?(de.setItems(ae,!1),ae.forEach(e=>{de.setKeySelected(e.key,!0,!1)}),me(de)):me(ue)},[ae]),Object(r.useEffect)(()=>{if(ce){var e=z(ce.SolutionComponentsDetails,l);ie(e)}else ie(void 0)},[ce]);var{_onStageSolution:je,isStagingOngoing:Ae,extendedStageSolutionResults:Re,stageSolutionResultsError:Ie,stageSolutionResultsWarning:we}=Object(u.useStageSolutionHook)(H,(function(){Z(void 0),K(!1),J(!1),ne(void 0),re(void 0)}),(function(e){return Te.apply(this,arguments)}),(function(){K(!0),Object(h.shouldShowAdvancedSettings)(Re)&&(Object(h.isUnmanagedUpdate)(Re.SolutionDetails)?Z(d.SolutionActionsKeys.update):Z(d.SolutionActionsKeys.upgrade)),Object(h.isConvertComponentsToManagedWarning)(we)&&J(!0);var e=Object(f.getEnvironmentVariableDefinitionsToBeUpdatedByUser)(Re,ge),t=Object(w.getConnectionReferencesToBeUpdatedByUser)(Re,e);re(e),ne(t)}),R.SolutionEventScope);Object(r.useEffect)(()=>{if(Ae)Z(void 0),K(!1),J(!1),ne(void 0),re(void 0);else{K(!0),Object(h.shouldShowAdvancedSettings)(Re)&&(Object(h.isUnmanagedUpdate)(Re.SolutionDetails)?Z(d.SolutionActionsKeys.update):Z(d.SolutionActionsKeys.upgrade)),Object(h.isConvertComponentsToManagedWarning)(we)&&J(!0);var e=Object(f.getEnvironmentVariableDefinitionsToBeUpdatedByUser)(Re,ge),t=Object(w.getConnectionReferencesToBeUpdatedByUser)(Re,e);re(e),ne(t),Q(e,Re)}},[Ae]);var{stageSolutionErrorMessage:De,fullStageSolutionErrorMessage:Ne}=Object(h.formatStageSolutionErrorMessage)(Ie,Re,l.ValidationResultsPanel.ValidationErrors,l.Errors.StandardErrorMessages),Le=Object(h.formatStageSolutionWarningMessage)(we,Re,l.ValidationResultsPanel.ValidationErrors);var{isRequestOngoing:Me,importRequestError:xe,_requestSolutionImport:ke}=Object(v.useImportSolutionHook)(Re&&Re.StageSolutionUploadId,H,(function(t){var n=Object(w.getConnectionReferencesFromExistingSolution)(Re),o=Object(f.getEnvironmentVariableDefinitionsFromExistingSolution)(Re),r=Object(P.generateImportSolutionContract)(t,X,q,Y,te,n,oe,o,ae,se,l,Se),a=Object(k.isCDSLiteUXContext)(Se)?(null==H?void 0:H.name)||"":Re&&Re.SolutionDetails&&Re.SolutionDetails.SolutionFriendlyName||"";return O.MetadataClientInstance.getInstance().executeAction("ImportSolution",X==d.SolutionActionsKeys.upgrade?"StageAndUpgradeSolutionAsync":"ImportSolutionAsync",void 0,r).then(t=>{var n=V(V({},t),{},{solutionDisplayName:a});return Object(T.putAsyncSolutionJobIntoStorage)(e.environmentId,V({type:"import"},n)),Object(A.trackUserActionClickButton)(R.SolutionEventScope,R.EventNames.SendImportRequest,{importJobKey:n.ImportJobKey}),e.solutionImportJobRegister(V({type:"import"},n)),e.solutionImportPollProgress(),c(),t})}),R.SolutionEventScope),Fe=Object(P.formatImportSolutionErrorMessage)(xe,l.Errors.StandardErrorMessages),_e={hasCloseButton:!0,closeButtonAriaLabel:l.close,type:o.PanelType.medium,headerText:Object(k.isCDSLiteUXContext)(Se)&&L.featureGates.enableTeamsSolutionImportV2?l.selectiveImportTitle:l.title,onRenderSubHeader:Object(k.isCDSLiteUXContext)(Se)?void 0:()=>{var e,t;return r.createElement("div",{style:{fontSize:"11px"}},r.createElement("div",{style:{fontWeight:600}},l.environment),r.createElement("div",null,null!==(e=null==E||null===(t=E.properties)||void 0===t?void 0:t.displayName)&&void 0!==e?e:null==E?void 0:E.name))}};var Ue,Ve=[Object(m.getFileSelectionPanel)(_e,l,H,W,s,(function(){s.current&&s.current.click()}),je),Object(b.getValidationResultsPanel)(e.t,_e,l,null==H?void 0:H.name,Object(k.isCDSLiteUXContext)(Se)?(null==H?void 0:H.name)||"":(null==Re||null===(Ue=Re.SolutionDetails)||void 0===Ue?void 0:Ue.SolutionFriendlyName)||"",Ae,Re,De,Ne,Le,X,Z,q,K,te,oe,ke,de,ae,be,M,Se,null==Ie||null===(n=Ie.Message)||void 0===n?void 0:n.includes("Some dependencies are missing.")),Object(g.useConnectionReferencesPanel)(_e,l,te,$,fe,Ee,Pe,he||Oe,Ce||ve,oe,ke),Object(y.getEnvironmentVariablesPanel)(_e,l,oe,re,ke),Object(C.useImportRequestPanel)(_e,l,Me,Fe)],Be={title:l.DismissPanel.title,confirmButtonText:l.DismissPanel.confirmButtonText,cancelButtonText:l.DismissPanel.cancelButtonText};return r.createElement(i.MultistepPanel,_({customWidth:void 0,dismissOnEscape:void 0,isBlocking:!0,isHiddenOnDismiss:!0,onDismissed:void 0,onLightDismissClick:void 0,isLightDismiss:!1,onOuterClick:void 0,isOpen:void 0},e.defaultPanelProps,{onDismiss:()=>{Object(A.trackUserActionClickButton)(R.SolutionEventScope,R.EventNames.Dismiss,V(V(V({currentStep:R.FriendlySolutionImportPanelSteps.get(U)},Object(R.getConnectionReferencesTelemetryData)(te,$)),Object(R.getEnvironmentVariableTelemetryData)(oe)),Object(R.getSolutionImportValidationResultsTelemetryData)(Re,De,Le,X,q))),c()},showDismissDialog:!0,dismissDialog:Be,panelsListProps:Ve,panelOpenIndex:U,setPanelOpenIndex:B,hideLeftHeaderBackButton:U==d.SolutionImportPanelSteps.fileSelection||U==d.SolutionImportPanelSteps.validationResults||U==d.SolutionImportPanelSteps.import,onLeftHeaderBackButtonClicked:(e,t)=>{var n;return n=e==d.SolutionImportPanelSteps.environmentVariables&&(!te||te.length<1)?d.SolutionImportPanelSteps.validationResults:e-1,Object(A.trackUserActionClickButton)(R.SolutionEventScope,R.EventNames.GoBack,{currentStep:R.FriendlySolutionImportPanelSteps.get(e),nextStep:R.FriendlySolutionImportPanelSteps.get(n)}),n}}))}),q=e=>{var t=Object(a.useDispatch)();return r.createElement(W,{defaultPanelProps:e.defaultPanelProps,environmentId:e.environmentId,onPanelClose:()=>{t(s.sharedActions.panelClose({panelType:l.PanelToShowType.SolutionImportPanel}))},solutionImportJobRegister:e=>{t(Object(E.solutionAsyncJobRegister)({asyncJob:e}))},solutionImportPollProgress:()=>{t(Object(E.solutionAsyncOperationPollProgress)())}})};function z(e,t){var n=[];return e.forEach(e=>{var o=e.ComponentTypeName.toLowerCase();if(!function(e){return![N.StandardSolutionComponentTypes.CanvasApp.logicalName,N.StandardSolutionComponentTypes.Entity.logicalName,N.StandardSolutionComponentTypes.Flow.logicalName,M.KnownCustomSolutionComponentTypes.bot.logicalName].includes(e)}(o)){var r,a=e.Attributes.has("displayname")?e.Attributes.get("displayname"):e.ComponentName;switch(o){case N.StandardSolutionComponentTypes.CanvasApp.logicalName:r=t.ComponentType.CanvasApp;break;case N.StandardSolutionComponentTypes.Entity.logicalName:r=t.ComponentType.Table;break;case N.StandardSolutionComponentTypes.Flow.logicalName:r=t.ComponentType.Flow;break;case M.KnownCustomSolutionComponentTypes.bot.logicalName:r=t.ComponentType.Chatbot;break;default:throw new Error("unsupported component type")}n.push({key:e.ComponentName,Items:a,Type:r,componentDetail:e})}}),n}function Q(e,t){var n=(e||[]).filter(e=>!e.displayname).map(e=>({type:e.type}));n.length>0&&Object(A.trackWarningTrace)(R.SolutionEventScope,{eventName:R.EventNames.StageSolution,eventData:{stageSolutionUploadId:null==t?void 0:t.StageSolutionUploadId,environmentVariablesWithNoDisplayName:n}})}},5468:function(e,t,n){"use strict";n.r(t);var o=n(5469),r=n(5474);n.d(t,"sharedActions",(function(){return r}));var a=n(5626);n.d(t,"sharedSelectors",(function(){return a}));var i=n(6868);n.d(t,"sharedMiddlewares",(function(){return i})),t.default=o.reducer},5469:function(e,t,n){"use strict";n.r(t),n.d(t,"defaultState",(function(){return E})),n.d(t,"reducer",(function(){return T}));var o=n(5470),r=n(5472),a=n(5473),i=n(5474),s=n(5475),l=n(5796),c=n(5653),p=n(5648),u=n(6866),d=n(5801),m=n(6867),b=n(2867),g=n(5667),y=n(6691),S=n(5654),f=n(5690),h=n(2812),O=n(6016);function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(Object(n),!0).forEach((function(t){P(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function P(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var E={tokens:{},aadUser:null,currentPlans:[],currentPlansMetaData:null,environments:new o.CaseInsensitiveNormalized,environmentCachedListMap:{},locations:[],locationsError:"",countries:[],countriesError:"",newEnvironment:null,newEnvironmentInProgress:!1,newEnvironmentError:"",newXrmDatabaseRequestFulfilled:!1,newXrmDatabaseInProgress:!1,newXrmDatabaseError:"",currencies:[],currenciesError:"",languages:[],languagesError:"",newP2TrialPlan:null,newP2TrialPlanInProgress:!1,newP2TrialPlanError:"",premiumResourceType:y.PremiumResourceType.General,optimizelyFlags:null,activeOptimizelyExperiments:null,panels:[],allowlistFeatures:r.allowlistFeaturesDefaults,bapAllowlistFeatures:a.bapAllowlistFeaturesDefaults,graphAadTenantDirectoryObjects:Object(b.Map)(),graphAadTenantDirectoryObjectsError:Object(b.Map)(),graphAadTenantThumbnailPhotoUri:Object(b.Map)(),graphAadTenantThumbnailPhotoUriInProgress:Object(b.Map)(),graphAadTenantThumbnailPhotoUriError:Object(b.Map)(),graphAadTenantDomains:[],graphAadTenantDomainsError:"",graphAadUsers:Object(b.Map)(),graphAadUsersError:Object(b.Map)(),graphAadGroups:Object(b.Map)(),graphAadGroupsError:Object(b.Map)(),graphTenantDetails:Object(b.Map)(),graphTenantDetailsRequestError:Object(b.Map)(),clientSessionId:null,confirmDialog:{hidden:!0},orgEnabledLanguages:Object(b.Map)(),portalWebsiteIds:Object(b.Map)(),powerPortalIdeasOrStarterAppListInProgress:!1,powerPortalIdeasOrStarterAppListFulfilled:!1};function T(){var e,t,n,r,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E,y=arguments.length>1?arguments[1]:void 0;switch(y.type){case i.SharedActionTypes.FETCH_LOCATIONS_REQUEST:return Object(h.assign)({},a,v({},a));case i.SharedActionTypes.FETCH_LOCATIONS_REJECTED:return Object(h.assign)({},a,v(v({},a),{},{locationsError:y.payload.error}));case i.SharedActionTypes.FETCH_LOCATIONS_FULFILLED:var C=y.payload.locations;return Object(h.assign)({},a,v(v({},a),{},{locations:C,locationsError:""}));case i.SharedActionTypes.FETCH_COUNTRIES_REQUEST:return a;case i.SharedActionTypes.FETCH_COUNTRIES_REJECTED:return Object(h.assign)({},a,v(v({},a),{},{countriesError:y.payload.error}));case i.SharedActionTypes.FETCH_COUNTRIES_FULFILLED:var P=y.payload.countries;return Object(h.assign)({},a,v(v({},a),{},{countries:P,countriesError:""}));case i.SharedActionTypes.FETCH_CURRENCIES_REQUEST:return Object(h.assign)({},a,v({},a));case i.SharedActionTypes.FETCH_CURRENCIES_REJECTED:return Object(h.assign)({},a,v(v({},a),{},{currenciesError:y.payload.error}));case i.SharedActionTypes.FETCH_CURRENCIES_FULFILLED:var T=y.payload.currencies;return Object(h.assign)({},a,v(v({},a),{},{currencies:T,currenciesError:""}));case i.SharedActionTypes.FETCH_LANGUAGES_REQUEST:return Object(h.assign)({},a,v({},a));case i.SharedActionTypes.FETCH_LANGUAGES_REJECTED:return Object(h.assign)({},a,v(v({},a),{},{languagesError:y.payload.error}));case i.SharedActionTypes.FETCH_LANGUAGES_FULFILLED:var j=y.payload.languages;return Object(h.assign)({},a,v(v({},a),{},{languages:j,languagesError:""}));case i.SharedActionTypes.CREATE_ENVIRONMENT_REQUEST:return Object(h.assign)({},a,v(v({},a),{},{newEnvironmentInProgress:!0}));case i.SharedActionTypes.CREATE_ENVIRONMENT_REJECTED:return Object(h.assign)({},a,v(v({},a),{},{newEnvironmentInProgress:!1,newEnvironmentError:y.payload.error}));case i.SharedActionTypes.CREATE_ENVIRONMENT_FULFILLED:var A=y.payload.newEnvironment;return Object(h.assign)({},a,v(v({},a),{},{newEnvironment:A,newEnvironmentInProgress:!1,newEnvironmentError:""}));case i.SharedActionTypes.RESET_CREATE_ENVIRONMENT_PANEL_STATUS:return v(v({},a),{},{newEnvironment:null,newEnvironmentError:"",newEnvironmentInProgress:!1});case i.SharedActionTypes.RESET_TRIAL_EXTENSION_PANEL_STATUS:return v(v({},a),{},{newP2TrialPlan:null,newP2TrialPlanError:"",newP2TrialPlanInProgress:!1});case i.SharedActionTypes.CREATE_XRM_DATABASE_REQUEST:return Object(h.assign)({},a,v(v({},a),{},{newXrmDatabaseRequestFulfilled:!1,newXrmDatabaseInProgress:!0}));case i.SharedActionTypes.CREATE_XRM_DATABASE_REJECTED:return Object(h.assign)({},a,v(v({},a),{},{newXrmDatabaseInProgress:!1,newXrmDatabaseError:y.payload.error}));case i.SharedActionTypes.CREATE_XRM_DATABASE_FULFILLED:return Object(h.assign)({},a,v(v({},a),{},{newXrmDatabaseRequestFulfilled:!0,newXrmDatabaseInProgress:!1,newXrmDatabaseError:""}));case i.SharedActionTypes.RESET_CREATE_XRM_DATABASE_PANEL_STATUS:return v(v({},a),{},{newXrmDatabaseRequestFulfilled:!1,newXrmDatabaseInProgress:!1,newXrmDatabaseError:""});case i.SharedActionTypes.SIGN_UP_FOR_P2_TRIAL_REQUEST:return Object(h.assign)({},a,v(v({},a),{},{newP2TrialPlanInProgress:!0}));case i.SharedActionTypes.SIGN_UP_FOR_P2_TRIAL_REJECTED:return Object(h.assign)({},a,v(v({},a),{},{newP2TrialPlanInProgress:!1,newP2TrialPlanError:y.payload.error}));case i.SharedActionTypes.SIGN_UP_FOR_P2_TRIAL_FULFILLED:return n=a.currentPlans.slice(),r=y.payload.newP2TrialPlan,n.push(r),Object(h.assign)({},a,v(v({},a),{},{newP2TrialPlan:r,currentPlans:n,newP2TrialPlanInProgress:!1,newP2TrialPlanError:""}));case i.SharedActionTypes.EXTEND_TRIAL_REQUEST:return Object(h.assign)({},a,v(v({},a),{},{newP2TrialPlanInProgress:!0}));case i.SharedActionTypes.EXTEND_TRIAL_REJECTED:return Object(h.assign)({},a,v(v({},a),{},{newP2TrialPlanInProgress:!1,newP2TrialPlanError:y.payload.error}));case i.SharedActionTypes.EXTEND_TRIAL_FULFILLED:return n=a.currentPlans.slice(),r=y.payload.newP2TrialPlan,n.push(r),Object(h.assign)({},a,v(v({},a),{},{newP2TrialPlan:r,currentPlans:n,newP2TrialPlanInProgress:!1,newP2TrialPlanError:""}));case i.SharedActionTypes.REQUEST_P2_PLAN_RENEWAL:return Object(h.assign)({},a,v(v({},a),{},{premiumResourceType:y.payload}));case i.SharedActionTypes.OPEN_CONFIRM_DIALOG:case i.SharedActionTypes.CLOSE_CONFIRM_DIALOG:return v(v({},a),{},{confirmDialog:y.payload});case i.SharedActionTypes.RESOURCE_TOKEN_UPDATED:var R=Object(h.assign)({},a.tokens);return R[y.payload.resource]=y.payload.token,v(v({},a),{},{tokens:R});case i.SharedActionTypes.AAD_USER_UPDATED:return v(v({},a),{},{aadUser:y.payload});case i.SharedActionTypes.PANEL_OPEN:var I=a.panels.slice(),w=y.payload;return w.panelHeight||(w.panelHeight=s.PanelHeight.Window),I.push(w),v(v({},a),{},{panels:I});case i.SharedActionTypes.PANEL_CLOSE:return v(v({},a),{},{panels:a.panels.filter(e=>e.panelType!==y.payload.panelType)});case i.SharedActionTypes.PANEL_CLOSE_ALL:return v(v({},a),{},{panels:[]});case i.SharedActionTypes.PANEL_TOGGLE:var D=a.panels,N=y.payload,L=D.slice();return D.find(e=>e.panelType===N.panelType)?L=L.filter(e=>e.panelType!==N.panelType):L.push(N),v(v({},a),{},{panels:L});case i.SharedActionTypes.UPDATE_CURRENT_PLANS:return v(v({},a),{},{currentPlans:y.payload});case i.SharedActionTypes.UPDATE_CURRENT_PLANS_METADATA:return v(v({},a),{},{currentPlansMetaData:y.payload});case i.SharedActionTypes.FETCH_OPTIMIZELY_FLAGS_FULFILLED:return v(v({},a),{},{optimizelyFlags:y.payload.optimizelyFlags,activeOptimizelyExperiments:y.payload.activeOptimizelyExperiments});case i.SharedActionTypes.UPDATE_OPTIMIZELY_FLAG:return v({},a);case i.SharedActionTypes.UPDATE_OPTIMIZELY_FLAG_FULFILLED:return v(v({},a),{},{activeOptimizelyExperiments:y.payload.updatedActiveOptimizelyExperiments,optimizelyFlags:y.payload.updatedOptimizelyFlags});case p.AppsActionTypes.FETCH_APPS_FULFILLED:case d.FlowsActionTypes.FETCH_FLOWS_FULFILLED:case u.ConnectionsActionTypes.FETCH_CONNECTIONS_FULFILLED:case f.SolutionsActionTypes.FETCH_CONFIGURATION_PAGES_FULFILLED:case l.ApisActionTypes.FETCH_APIS_FULFILLED:case m.GatewaysActionTypes.FETCH_GATEWAYS_FULFILLED:case c.AppModulesActionTypes.FETCH_APPMODULES_FULFILLED:case f.SolutionsActionTypes.FETCH_SOLUTIONS_FULFILLED:case f.SolutionsActionTypes.FETCH_PUBLISHERS_FULFILLED:case g.PowerPortalActionTypes.FETCH_POWER_PORTALS_FULFILLED:return y.payload&&void 0!==y.payload.normalizedResourceType?v(v({},a),{},{environmentCachedListMap:Object(o.updateEnvironmentCachedListMap)(a.environmentCachedListMap,y.payload.environmentId,y.payload.normalizedResourceType,o.CachedStatusType.Done)}):a;case S.SampleAppsActionTypes.FETCH_SAMPLE_APPS_FULFILLED:return y.payload&&void 0!==y.payload.normalizedResourceType?v(v({},a),{},{environmentCachedListMap:Object(o.updateEnvironmentCachedListMap)(a.environmentCachedListMap,o.EnvironmentAgnosticKey,y.payload.normalizedResourceType,o.CachedStatusType.Done)}):a;case i.SharedActionTypes.FETCH_ALLOWLIST_FEATURES_FULFILLED:return v(v({},a),{},{allowlistFeatures:y.payload.allowlistFeatures});case i.SharedActionTypes.FETCH_BAP_ALLOWLIST_FEATURES_FULFILLED:return v(v({},a),{},{bapAllowlistFeatures:y.payload.bapAllowlistFeatures});case i.SharedActionTypes.FETCH_GRAPH_TENANTS_DIRECTORY_OBJECTS_FULFILLED:var M;e=a.graphAadTenantDirectoryObjectsError;var x=Object(b.Map)().withMutations(e=>{y.payload.directoryObjects.forEach(t=>{e.set(t.objectId,t)})});return M=a.graphAadTenantDirectoryObjects.withMutations(t=>{(y.payload.objectIds||[]).forEach(n=>{x.has(n)?t.set(n,x.get(n)):t.set(n,null),e=e.remove(n)})}),v(v({},a),{},{graphAadTenantDirectoryObjects:M,graphAadTenantDirectoryObjectsError:e});case i.SharedActionTypes.FETCH_GRAPH_TENANTS_DIRECTORY_OBJECTS_REJECTED:return(y.payload.objectIds||[]).forEach(t=>{e=a.graphAadTenantDirectoryObjectsError.withMutations(e=>{e.set(t,y.payload.error)})}),v(v({},a),{},{graphAadTenantDirectoryObjectsError:e});case i.SharedActionTypes.FETCH_GRAPH_TENANT_THUMBNAIL_PHOTO:return t=y.payload.objectId,v(v({},a),{},{graphAadTenantThumbnailPhotoUriInProgress:a.graphAadTenantThumbnailPhotoUriInProgress.set(t,!0)});case i.SharedActionTypes.FETCH_GRAPH_TENANT_THUMBNAIL_PHOTO_FULFILLED:return t=y.payload.objectId,v(v({},a),{},{graphAadTenantThumbnailPhotoUri:a.graphAadTenantThumbnailPhotoUri.set(t,Object(O.getBase64ImageUri)(y.payload.aadTenantThumbnailPhotoBuffer)),graphAadTenantThumbnailPhotoUriInProgress:a.graphAadTenantThumbnailPhotoUriInProgress.set(t,!1),graphAadTenantThumbnailPhotoUriError:a.graphAadTenantThumbnailPhotoUriError.remove(t)});case i.SharedActionTypes.FETCH_GRAPH_TENANT_THUMBNAIL_PHOTO_REJECTED:return v(v({},a),{},{graphAadTenantThumbnailPhotoUriInProgress:a.graphAadTenantThumbnailPhotoUriInProgress.set(t,!1),graphAadTenantThumbnailPhotoUriError:a.graphAadTenantThumbnailPhotoUriError.set(y.payload.objectId,y.payload.error)});case i.SharedActionTypes.FETCH_GRAPH_TENANT_DOMAINS_FULFILLED:return v(v({},a),{},{graphAadTenantDomains:y.payload.graphAadTenantDomains});case i.SharedActionTypes.FETCH_GRAPH_TENANT_DOMAINS_REJECTED:return v(v({},a),{},{graphAadTenantDomainsError:y.payload.error});case i.SharedActionTypes.FETCH_GRAPH_USERS_BY_EMAIL_ADDRESS_OR_DISPLAY_NAME_MATCH_FULFILLED:var k=y.payload.emailAddressOrDisplayName;return v(v({},a),{},{graphAadUsers:a.graphAadUsers.set(k,y.payload.users),graphAadUsersError:a.graphAadUsersError.remove(k)});case i.SharedActionTypes.FETCH_GRAPH_USERS_BY_EMAIL_ADDRESS_OR_DISPLAY_NAME_MATCH_REJECTED:return v(v({},a),{},{graphAadUsersError:a.graphAadUsersError.set(y.payload.emailAddressOrDisplayName,y.payload.error)});case i.SharedActionTypes.FETCH_GRAPH_GROUPS_BY_EMAIL_ADDRESS_OR_DISPLAY_NAME_MATCH_FULFILLED:var F=y.payload.displayName;return v(v({},a),{},{graphAadGroups:a.graphAadGroups.set(F,y.payload.groups),graphAadGroupsError:a.graphAadGroupsError.remove(F)});case i.SharedActionTypes.FETCH_GRAPH_GROUPS_BY_EMAIL_ADDRESS_OR_DISPLAY_NAME_MATCH_REJECTED:return v(v({},a),{},{graphAadGroupsError:a.graphAadGroupsError.set(y.payload.displayName,y.payload.error)});case i.SharedActionTypes.FETCH_GRAPH_TENANT_DETAIL_FULFILLED:var _=y.payload.tenantId;return v(v({},a),{},{graphTenantDetails:a.graphTenantDetails.set(_,y.payload.data),graphTenantDetailsRequestError:a.graphTenantDetailsRequestError.remove(_)});case i.SharedActionTypes.FETCH_GRAPH_TENANT_DETAIL_REJECTED:var U=y.payload.tenantId;return v(v({},a),{},{graphTenantDetailsRequestError:a.graphTenantDetailsRequestError.set(U,y.payload.error)});case i.SharedActionTypes.SESSION_ID_UPDATED:return v(v({},a),{},{clientSessionId:y.payload});case i.SharedActionTypes.FETCH_ORG_ENABLED_LANGUAGES_FULFILLED:var V=y.payload.environment;return v(v({},a),{},{orgEnabledLanguages:a.orgEnabledLanguages.set(V,y.payload.orgEnabledLanguages)});case i.SharedActionTypes.FETCH_POWER_PORTAL_IDEAS_OR_STARTER_APP_LIST_IN_PROGRESS:return v(v({},a),{},{powerPortalIdeasOrStarterAppListInProgress:!0,powerPortalIdeasOrStarterAppListFulfilled:!1});case i.SharedActionTypes.FETCH_POWER_PORTAL_IDEAS_OR_STARTER_APP_LIST_FULFILLED:return v(v({},a),{},{powerPortalIdeasOrStarterAppListInProgress:!1,powerPortalIdeasOrStarterAppListFulfilled:!0});case i.SharedActionTypes.FETCH_ORG_ENABLED_WEBSITES_FULFILLED:var B=y.payload.environment;return v(v({},a),{},{portalWebsiteIds:a.portalWebsiteIds.set(B,y.payload.portalWebsiteIds)});default:return a}}},5472:function(e,t,n){"use strict";n.r(t),n.d(t,"allowlistFeaturesDefaults",(function(){return o}));var o={DataRuntimeService:!1,WebAuthoring:!1,CDSDataIntegration:!1,PowerAppsChampions:!1,BlockSampleApps:!1,AIAD:!1,AIADNOV:!1,AIADDEC:!1,AIADJAN:!1,AIADFEB:!1,AIADMAR:!1,AIADAPR:!1,PowerAiAccess:!1,PartnersTraining:!1,PartnersImplementation:!1,EnablePowerPortalPublicPreview:!0,EnableTestStudio:!1,ShowD365PowerPortalTiles:!0,ShowFieldServiceAppPowerPortalTile:!1,ShowIdeasPowerPortalTile:!1,ShowSCMCustomerPowerPortalTile:!1,ShowIOMOrderReturnsPowerPortalTile:!1,EnableIdentityAndAccessManagement:!1,BlockTenantPermissions:!1,EnableDesktopFlowConnectionSharing:!1}},5473:function(e,t,n){"use strict";n.r(t),n.d(t,"bapAllowlistFeaturesDefaults",(function(){return o}));var o={AllowProvisioningOfCDS2Databases:!1,EnableCdsEventFunctions:!1,CdsMigrationEnabled:!1,ExpireTrialEnvironments:!1,HideModelDrivenMakerUxForDefault:!1}},5475:function(e,t,n){"use strict";n.r(t),n.d(t,"PanelHeight",(function(){return o})),n.d(t,"mapStateToProps",(function(){return s})),n.d(t,"mapDispatchToProps",(function(){return l})),n.d(t,"PanelSelectorContainer",(function(){return c}));var o,r=n(5468),a=n(5476),i=n(5437);!function(e){e[e.Window=0]="Window",e[e.Page=1]="Page"}(o||(o={}));var s=e=>({panels:r.sharedSelectors.panelsSelector(e)}),l=e=>({onDismissPanel:t=>{e(r.sharedActions.panelClose({panelType:t}))}}),c=Object(i.connect)(s,l)(a.PanelSelector)},5476:function(e,t,n){"use strict";n.r(t),n.d(t,"PagePanelsLayersId",(function(){return ie})),n.d(t,"PanelSelector",(function(){return se}));var o=n(245),r=n(2812),a=n(5477),i=n(5475),s=n(5733),l=n(5745),c=n(5773),p=n(5785),u=n(5866),d=n(5869),m=n(5904),b=n(5949),g=n(5977),y=n(5980),S=n(6002),f=n(6005),h=n(6367),O=n(6369),C=n(6384),v=n(6391),P=n(6447),E=n(6452),T=n(6453),j=n(6457),A=n(6461),R=n(6462),I=n(804),w=n(6467),D=n(6474),N=n(5478),L=n(6515),M=n(6518),x=n(6538),k=n(6558),F=n(6559),_=n(6595),U=n(6600),V=n(6604),B=n(6665),H=n(6667),G=n(6675),W=n(6679),q=n(6680),z=n(5436),Q=n(6685),K=n(6686),Y=n(6692),J=n(6755),X=n(2871),Z=n(6758),$=n(5595),ee=n(5732),te=n(5731),ne=n(6856),oe=n(6861),re=n(6862);function ae(){return(ae=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}var ie="pagePanels-layer-id";class se extends o.Component{constructor(e){super(e),this.props=e,this.successBannerState=void 0,this.successBannerState=new oe.CreateBillingPlanState}render(){var e;return e=this.hasPageHeightPanels()?this.renderPagePanels():this.getMountedPanels(this.getFullHeightPanels(this.props.panels)),o.createElement("div",{className:"panels-container"},e)}getMountedPanels(e){if(r.isEmpty(e))return[];var t=e.length-1;return e.filter((e,n)=>e.stayMountedWhenHidden||n===t).map((e,n)=>this.getPanelComponent(e,n,{isOpen:!0,isLightDismiss:n===t,onOuterClick:()=>{}}))}renderPagePanels(){var e=this.getMountedPanels(this.getPageHeightPanels(this.props.panels));return e.length?o.createElement(o.Fragment,null,o.createElement(I.LayerHost,{id:ie,style:{position:"fixed",top:"48px",bottom:"0",left:"0",right:"0",zIndex:1}}),e[0]):null}getFullHeightPanels(e){return e.filter(e=>void 0===e.panelHeight||e.panelHeight===i.PanelHeight.Window)}getPageHeightPanels(e){return e.filter(e=>e.panelHeight===i.PanelHeight.Page)}hasPageHeightPanels(){var{panels:e}=this.props,t=e.filter(e=>e.panelHeight===i.PanelHeight.Page);return t&&t.length>0}getPanelComponent(e,t,n){switch(e.panelType){case N.PanelToShowType.AppSettingsPanel:return e.panelProps.openAppSettingsPanelScenario=e.panelProps.startTelemetry?Object(te.sendPerformanceTelemetry)($.CanvasAppSettingsLoadEvent.getData(e.panelProps.selectedAppId),ee.featureName,ee.AppSettingsTelemetryScenarios.Open):null,o.createElement(S.AppSettingsPanelContainer,ae({key:t,defaultPanelProps:n,panelType:e.panelType},e.panelProps,{billingSuccess:this.successBannerState}));case N.PanelToShowType.AppWrapPanel:return o.createElement(b.AppWrapPanelContainer,ae({},e.panelProps,{key:t,onDismiss:()=>this.props.onDismissPanel(N.PanelToShowType.AppWrapPanel)}));case N.PanelToShowType.AppSharePanel:return o.createElement(f.CanvasAppSharePanelContainer,ae({key:t,defaultPanelProps:n},e.panelProps));case N.PanelToShowType.ComponentLibrarySharePanel:return o.createElement(h.ComponentLibrarySharePanelContainer,ae({key:t,defaultPanelProps:n},e.panelProps));case N.PanelToShowType.AppComponentLibraryRenamePanel:return o.createElement(ne.RenamePanelContainer,ae({key:t,defaultPanelProps:n},e.panelProps));case N.PanelToShowType.CanvasAppTeamsExportPanel:return o.createElement(a.CanvasAppTeamExportPanelConnected,ae({key:t,defaultPanelProps:n},e.panelProps));case N.PanelToShowType.AppModuleTeamsExportPanel:return o.createElement(a.AppModuleTeamExportPanelConnected,ae({key:t,defaultPanelProps:n},e.panelProps));case N.PanelToShowType.AppModuleSettingsPanel:return o.createElement(d.AppModuleSettingsPanel,ae({key:t,defaultPanelProps:n},e.panelProps,{panelType:e.panelType,billingSuccess:this.successBannerState}));case N.PanelToShowType.AppModuleSharePanel:return X.featureGates.enableModelDrivenSharing?o.createElement(m.AppModuleSharePanel,ae({key:t+""},n,e.panelProps,{onDismiss:()=>{this.props.onDismissPanel(N.PanelToShowType.AppModuleSharePanel),e.panelProps.onClosePanel&&e.panelProps.onClosePanel()}})):o.createElement(g.AppModuleSharePanelContainer,ae({key:t,defaultPanelProps:n},e.panelProps));case N.PanelToShowType.LegacyAppModuleSharePanel:return o.createElement(g.AppModuleSharePanelContainer,ae({key:t,defaultPanelProps:n},e.panelProps));case N.PanelToShowType.PowerPortalSharePanel:return o.createElement(k.PowerPortalsSharePanel,{key:t});case N.PanelToShowType.PermissionInstructionPanel:return o.createElement(L.PermissionInstructionPanelContainer,ae({key:t,defaultPanelProps:n},e.panelProps));case N.PanelToShowType.AppRenamePanel:return o.createElement(y.AppRenamePanelContainer,ae({key:t,defaultPanelProps:n},e.panelProps));case N.PanelToShowType.GatewaySharePanel:return o.createElement(A.GatewaySharePanelContainer,ae({key:t},e.panelProps));case N.PanelToShowType.SolutionComponentAddExistingPanel:return o.createElement(V.SolutionComponentAddExistingPanelContainer,ae({key:t,defaultPanelProps:n},e.panelProps));case N.PanelToShowType.SolutionEditPanel:return o.createElement(c.SolutionEditPanelContainer,ae({key:t,defaultPanelProps:n},e.panelProps));case N.PanelToShowType.SolutionNewPanel:return o.createElement(Q.SolutionNewPanelContainer,{key:t,defaultPanelProps:n});case N.PanelToShowType.PublisherNewEditPanel:return o.createElement(s.PublisherPanelContainer,ae({key:t,defaultPanelProps:n},e.panelProps));case N.PanelToShowType.CreateEnvironmentPanel:return o.createElement(C.CreateEnvironmentPanelContainer,ae({key:t,defaultPanelProps:n},e.panelProps));case N.PanelToShowType.CreateXrmDatabasePanel:return o.createElement(P.CreateXrmDatabasePanelContainer,ae({key:t,defaultPanelProps:n},e.panelProps));case N.PanelToShowType.TrialExtensionPanel:return o.createElement(K.TrialExtensionPanelContainer,ae({key:t,defaultPanelProps:n},e.panelProps));case N.PanelToShowType.SolutionClonePanel:return o.createElement(l.SolutionClonePanelContainer,ae({key:t,defaultPanelProps:n},e.panelProps));case N.PanelToShowType.ImportTranslationPanel:return o.createElement(R.ImportTranslationPanelContainer,ae({key:t,defaultPanelProps:n},e.panelProps));case N.PanelToShowType.SolutionCheckerViewResultsFilterPanel:return o.createElement(U.SolutionCheckerViewResultsFilterPanelContainer,ae({key:t,defaultPanelProps:n},e.panelProps));case N.PanelToShowType.ObjectCheckerPanel:return o.createElement(D.ObjectCheckerPanelContainer,ae({key:t,defaultPanelProps:n},e.panelProps));case N.PanelToShowType.SolutionCheckerViewResultDetailPanel:return o.createElement(_.SolutionCheckerViewResultDetailPanelContainer,ae({key:t,defaultPanelProps:n},e.panelProps));case N.PanelToShowType.VersionPublishPanel:return o.createElement(J.VersionPublishPanelContainer,ae({key:t,defaultPanelProps:n},e.panelProps));case N.PanelToShowType.SolutionExportPanel:return o.createElement(G.SolutionExportPanelContainer,ae({key:t,defaultPanelProps:n},e.panelProps));case N.PanelToShowType.ManagedProperties:return o.createElement(w.ManagedPropertiesPanelContainer,ae({key:t,defaultPanelProps:n},e.panelProps));case N.PanelToShowType.AddSubcomponentsPanel:return o.createElement(H.SolutionComponentAddSubcomponentsPanelContainer,ae({key:t,defaultPanelProps:n},e.panelProps));case N.PanelToShowType.AddRequiredComponentsPanel:return o.createElement(B.SolutionComponentAddRequiredComponentsPanelContainer,ae({key:t,defaultPanelProps:n},e.panelProps));case N.PanelToShowType.AddSLAPanel:return o.createElement(p.AddSLAPanelContainer,ae({key:t,defaultPanelProps:n},e.panelProps));case N.PanelToShowType.AdvancedCustomizationPanel:return o.createElement(u.AdvancedCustomizationsPanelContainer,ae({key:t,defaultPanelProps:n},e.panelProps));case N.PanelToShowType.PowerPortalSettingPanel:return o.createElement(x.PowerPortalSettingsPanelContainer,ae({key:t,defaultPanelProps:n},e.panelProps,{billingSuccess:this.successBannerState}));case N.PanelToShowType.CreateEnvironmentVariablePanel:return o.createElement(v.CreateEnvironmentVariablePanelContainer,ae({key:t,defaultPanelProps:n},e.panelProps));case N.PanelToShowType.EditEnvironmentVariablePanel:return o.createElement(T.EditEnvironmentVariablePanelContainer,ae({key:t,defaultPanelProps:n},e.panelProps));case N.PanelToShowType.UpdateEnvVariablesPanel:return o.createElement(Y.UpdateEnvVariablesPanelContainer,ae({key:t,defaultPanelProps:n},e.panelProps));case N.PanelToShowType.UpdateConRefsPanel:return o.createElement(re.UpdateConRefsPanelContainer,ae({key:t,defaultPanelProps:n},e.panelProps));case N.PanelToShowType.FeedbackPanel:return o.createElement(W.SolutionFeedbackPanel,ae({key:t.toString()},e.panelProps));case N.PanelToShowType.SolutionImportPanel:return o.createElement(z.SolutionImportPanelContainer,ae({key:t,defaultPanelProps:n},e.panelProps));case N.PanelToShowType.SolutionImportDependenciesPanel:return o.createElement(q.SolutionImportDependenciesPanel,ae({key:t,defaultPanelProps:n},e.panelProps));case N.PanelToShowType.CreatePowerBIDashboardPanel:return o.createElement(M.PowerBIDashboardPanel,ae({key:t,defaultPanelProps:n,panelType:N.PanelToShowType.CreatePowerBIDashboardPanel,dashboardId:null},e.panelProps));case N.PanelToShowType.EditPowerBIDashboardPanel:return o.createElement(M.PowerBIDashboardPanel,ae({key:t,defaultPanelProps:n,panelType:N.PanelToShowType.EditPowerBIDashboardPanel},e.panelProps));case N.PanelToShowType.PublishTeamsApp:return o.createElement(F.PublishTeamsAppPanel,ae({key:t,defaultPanelProps:n},e.panelProps));case N.PanelToShowType.CreateConnectionReferencePanel:return o.createElement(O.CreateConnectionReferencePanelContainer,ae({key:t,defaultPanelProps:n},e.panelProps));case N.PanelToShowType.EditConnectionReferencePanel:return o.createElement(E.EditConnectionReferencePanelContainer,ae({key:t,defaultPanelProps:n},e.panelProps));case N.PanelToShowType.FlowUpdatesPanel:return o.createElement(j.FlowUpdatesPanelContainer,ae({key:t,defaultPanelProps:n},e.panelProps));case N.PanelToShowType.BillingWizardPanel:return o.createElement(Z.BillingWizardPanelContainer,ae({key:t,defaultPanelProps:n},e.panelProps,{billingSuccess:this.successBannerState}));default:return null}}}},5477:function(e,t,n){"use strict";n.r(t),n.d(t,"CanvasAppTeamsExportPanel",(function(){return f})),n.d(t,"AppModuleTeamsExportPanel",(function(){return h})),n.d(t,"CanvasAppTeamExportPanelConnected",(function(){return O})),n.d(t,"AppModuleTeamExportPanelConnected",(function(){return C}));var o=n(4013),r=n(245),a=n.n(r),i=n(922),s=n(5437),l=n(5468),c=n(5478),p=n(5479),u=n(5484),d=n(1201),m=n(5637),b=n(2871),g=n(5595),y=n(5593);function S(){return(S=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}var f=e=>{var t,n,r=Object(s.useDispatch)(),i=null!==(t=e.panelClose)&&void 0!==t?t:()=>r(l.sharedActions.panelClose({panelType:c.PanelToShowType.CanvasAppTeamsExportPanel})),{errorMessage:f,loading:h,response:O,appUI:C,getTeamsPackage:P,getTrustedSideLoadingDeepLink:E,setIsWebsiteUrlInvalid:T,isWebsiteUrlInvalid:j,setIsTermsOfUseUrlInvalid:A,isTermsOfUseUrlInvalid:R,setIsPrivacyUrlInvalid:I,isPrivacyUrlInvalid:w,setAdvancedCollapsed:D,advancedCollapsed:N,onUpdateAdvancedSettings:L,getAdvancedSettingsValue:M}=Object(u.useTeamsExportPanelBehaviorForCanvasApp)(e.selectedApp),x=[{ariaLabel:b.featureGates.enableTrustedSideLoading?O&&e.t("TeamsExportPanel.close")||e.t("TeamsExportPanel.download"):e.t("TeamsExportPanel.cancel"),text:b.featureGates.enableTrustedSideLoading?O&&e.t("TeamsExportPanel.close")||e.t("TeamsExportPanel.download"):O&&e.t("TeamsExportPanel.close")||e.t("TeamsExportPanel.cancel"),disabled:h||j||R||w,dismissableOnClick:b.featureGates.enableTrustedSideLoading?O?()=>{i()}:()=>(Object(y.trackUserActionClickButton)(g.CanvasAppTeamsExportEvents.clickDownloadButton),P()):()=>{i()}}];O||x.unshift({primary:!0,ariaLabel:b.featureGates.enableTrustedSideLoading?e.t("TeamsExportPanel.addToTeams"):e.t("TeamsExportPanel.download"),text:b.featureGates.enableTrustedSideLoading?e.t("TeamsExportPanel.addToTeams"):e.t("TeamsExportPanel.download"),disabled:h||j||R||w,dismissableOnClick:b.featureGates.enableTrustedSideLoading?E:()=>(Object(y.trackUserActionClickButton)(g.CanvasAppTeamsExportEvents.clickDownloadButton),P())});var k=h?{loadingText:e.t("TeamsExportPanel.packageLoading"),spinnerProps:{size:d.SpinnerSize.large}}:void 0,F=Object(m.canUserEditResource)(e.selectedApp);return a.a.createElement(o.Panel,S({},e.defaultPanelProps,{closeButtonAriaLabel:e.t("TeamsExportPanel.cancel"),onDismiss:()=>i(),headerText:e.t("TeamsExportPanel.title"),footerButtons:x,isOpen:null===(n=e.defaultPanelProps)||void 0===n?void 0:n.isOpen,loadingOverlay:k,styles:v}),!O&&a.a.createElement(p.AppTeamsExportPanelDefault,S({t:e.t,setAdvancedCollapsed:D,advancedCollapsed:N,setIsWebsiteUrlInvalid:T,isWebsiteUrlInvalid:j,setIsTermsOfUseUrlInvalid:A,isTermsOfUseUrlInvalid:R,setIsPrivacyUrlInvalid:I,isPrivacyUrlInvalid:w,onUpdateAdvancedSettings:L,getAdvancedSettingsValue:M,error:null!=f?f:"",canUserEdit:F},C)),O&&a.a.createElement(p.AppTeamsExportPanelFinished,{teamsPackageUrl:O,t:e.t}))},h=e=>{var t,n,r=Object(s.useDispatch)(),i=null!==(t=e.panelClose)&&void 0!==t?t:()=>r(l.sharedActions.panelClose({panelType:c.PanelToShowType.AppModuleTeamsExportPanel})),{errorMessage:m,loading:f,response:h,appUI:O,getAppModuleTeamsPackage:C,getTrustedSideLoadingDeepLink:P,setIsWebsiteUrlInvalid:E,isWebsiteUrlInvalid:T,setIsTermsOfUseUrlInvalid:j,isTermsOfUseUrlInvalid:A,setIsPrivacyUrlInvalid:R,isPrivacyUrlInvalid:I,setAdvancedCollapsed:w,advancedCollapsed:D,onUpdateAdvancedSettings:N,getAdvancedSettingsValue:L}=Object(u.useTeamsExportPanelBehaviorForAppModule)(e.selectedApp,e.solutionId,e.selectedAppAppId,e.selectedAppUniqueName),M=[{ariaLabel:b.featureGates.enableTrustedSideLoading?h&&e.t("TeamsExportPanel.close")||e.t("TeamsExportPanel.download"):e.t("TeamsExportPanel.cancel"),text:b.featureGates.enableTrustedSideLoading?h&&e.t("TeamsExportPanel.close")||e.t("TeamsExportPanel.download"):h&&e.t("TeamsExportPanel.close")||e.t("TeamsExportPanel.cancel"),dismissableOnClick:b.featureGates.enableTrustedSideLoading?h?()=>{i()}:()=>(Object(y.trackUserActionClickButton)(g.AppModuleTeamsExportEvents.clickDownloadButton),C()):()=>{i()}}];h||M.unshift({primary:!0,ariaLabel:b.featureGates.enableTrustedSideLoading?e.t("TeamsExportPanel.addToTeams"):e.t("TeamsExportPanel.download"),text:b.featureGates.enableTrustedSideLoading?e.t("TeamsExportPanel.addToTeams"):e.t("TeamsExportPanel.download"),disabled:f||T||A||I,dismissableOnClick:b.featureGates.enableTrustedSideLoading?P:()=>(Object(y.trackUserActionClickButton)(g.AppModuleTeamsExportEvents.clickDownloadButton),C())});var x=f?{loadingText:e.t("TeamsExportPanel.packageLoading"),spinnerProps:{size:d.SpinnerSize.large}}:void 0;return a.a.createElement(o.Panel,S({},e.defaultPanelProps,{closeButtonAriaLabel:e.t("TeamsExportPanel.cancel"),onDismiss:()=>i(),headerText:e.t("TeamsExportPanel.title"),footerButtons:M,isOpen:null===(n=e.defaultPanelProps)||void 0===n?void 0:n.isOpen,loadingOverlay:x,styles:v}),!h&&a.a.createElement(p.AppTeamsExportPanelDefault,S({t:e.t,setAdvancedCollapsed:w,advancedCollapsed:D,setIsWebsiteUrlInvalid:E,isWebsiteUrlInvalid:T,setIsTermsOfUseUrlInvalid:j,isTermsOfUseUrlInvalid:A,setIsPrivacyUrlInvalid:R,isPrivacyUrlInvalid:I,onUpdateAdvancedSettings:N,getAdvancedSettingsValue:L,error:null!=m?m:"",canUserEdit:!0},O)),h&&a.a.createElement(p.AppTeamsExportPanelFinished,{teamsPackageUrl:h,t:e.t}))},O=Object(i.translateService)("PowerappsPortal")(f),C=Object(i.translateService)("PowerappsPortal")(h),v={footerInner:{display:"flex",justifyContent:"space-around",paddingTop:"16px",paddingLeft:"0px !important",paddingRight:"0px !important",paddingBottom:"0px !important"}}},5479:function(e,t,n){"use strict";n.r(t),n.d(t,"AppTeamsExportPanelDefault",(function(){return y})),n.d(t,"AppTeamsExportPanelAdvancedSettings",(function(){return f})),n.d(t,"AppTeamsExportPanelFinished",(function(){return h}));var o=n(5480),r=n(5481),a=n(2880),i=n(1090),s=n(687),l=n(1697),c=n(1749),p=n(1429),u=n(245),d=n.n(u),m=n(2879),b=n(2871),g=n(5483),y=e=>{var{t:t,displayName:n,description:r,backgroundColor:a,backgroundImageUri:s,editUrl:p,isAppModule:u,error:m,isWebsiteUrlInvalid:g,isTermsOfUseUrlInvalid:y,isPrivacyUrlInvalid:h,setIsWebsiteUrlInvalid:O,setIsTermsOfUseUrlInvalid:C,setIsPrivacyUrlInvalid:v,setAdvancedCollapsed:P,advancedCollapsed:E,onUpdateAdvancedSettings:T,getAdvancedSettingsValue:j,canUserEdit:A}=e;return d.a.createElement("div",{className:o.appTeamsExportContainerStyles.panelContent},m&&d.a.createElement(l.MessageBar,{messageBarType:l.MessageBarType.error},t(m)),!b.featureGates.enableTrustedSideLoading&&d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{className:o.appTeamsExportContainerStyles.instructions,"data-test":"instructions"},d.a.createElement("h4",null,t("TeamsExportPanel.instructionTitle")),d.a.createElement("p",null,t("TeamsExportPanel.instructions1")),d.a.createElement("p",null,t("TeamsExportPanel.instructions2"))),d.a.createElement(c.Separator,null)),d.a.createElement("h4",null,t("TeamsExportPanel.appDetails")),d.a.createElement("p",null,t("TeamsExportPanel.appDetailsSubheader")),d.a.createElement("div",{className:o.appTeamsExportContainerStyles.appSection},d.a.createElement("img",{alt:t("TeamsExportPanel.appIcon"),style:{backgroundColor:a},src:S(s,u)}),d.a.createElement("p",null,n)),d.a.createElement("h4",null,t("TeamsExportPanel.appDescription")),d.a.createElement("p",null,r||t("TeamsExportPanel.noDescription")),A&&d.a.createElement(i.Link,{className:o.appTeamsExportContainerStyles.editLink,target:"_self",href:p},d.a.createElement("span",null,t("TeamsExportPanel.editLink"))),d.a.createElement(f,{t:t,setAdvancedCollapsed:P,advancedCollapsed:E,setIsWebsiteUrlInvalid:O,isWebsiteUrlInvalid:g,setIsTermsOfUseUrlInvalid:C,isTermsOfUseUrlInvalid:y,setIsPrivacyUrlInvalid:v,isPrivacyUrlInvalid:h,onUpdateAdvancedSettings:T,getAdvancedSettingsValue:j}))};function S(e,t){return t&&e?"data:image/png;base64, "+e:e}var f=e=>{var{t:t,setAdvancedCollapsed:n,advancedCollapsed:l,onUpdateAdvancedSettings:u,getAdvancedSettingsValue:b,setIsWebsiteUrlInvalid:y,setIsTermsOfUseUrlInvalid:S,setIsPrivacyUrlInvalid:f}=e;var h=(e,t)=>u(e&&e.target.name,t);return d.a.createElement("div",null,d.a.createElement(c.Separator,null),d.a.createElement(i.Link,{className:o.appTeamsExportContainerStyles.advancedSettingsLink,onClick:()=>n(!l)},d.a.createElement("span",null,t("TeamsExportPanel.advancedSettingsLink")),d.a.createElement(s.Icon,{iconName:l?m.fabricIcons.ChevronUp:m.fabricIcons.ChevronDown})),l&&[d.a.createElement("div",{className:o.appTeamsExportContainerStyles.advancedAll,key:"settingsSection1"},d.a.createElement("h4",null,t("TeamsExportPanel.advancedSettingsSubheader1")),d.a.createElement("p",null,t("TeamsExportPanel.advancedSettingsSubheader1Details")),d.a.createElement("h4",null,t("TeamsExportPanel.advanceSettingsNameLabel")),d.a.createElement(p.TextField,{placeholder:t("TeamsExportPanel.inputTextPlaceholder"),name:"developerName",onChange:h,value:b("developerName")}),d.a.createElement("h4",null,t("TeamsExportPanel.advanceSettingsWebsiteLabel")),d.a.createElement(p.TextField,{placeholder:t("TeamsExportPanel.inputURLPlaceholder"),name:"websiteUrl",onChange:h,onGetErrorMessage:function(e){var n="";return e&&!Object(g.isValidHttpsUrl)(e)?(n=t("TeamsExportPanel.urlError"),y(!0)):y(!1),n},value:b("websiteUrl")}),d.a.createElement("h4",null,t("TeamsExportPanel.advanceSettingsTermsOfUseLabel")),d.a.createElement(p.TextField,{placeholder:t("TeamsExportPanel.inputURLPlaceholder"),name:"termsOfUseUrl",onChange:h,onGetErrorMessage:function(e){var n="";return e&&!Object(g.isValidHttpsUrl)(e)?(n=t("TeamsExportPanel.urlError"),S(!0)):S(!1),n},value:b("termsOfUseUrl")}),d.a.createElement("h4",null,t("TeamsExportPanel.advanceSettingsPrivacyPolicyLabel")),d.a.createElement(p.TextField,{placeholder:t("TeamsExportPanel.inputURLPlaceholder"),name:"privacyUrl",onChange:h,onGetErrorMessage:function(e){var n="";return e&&!Object(g.isValidHttpsUrl)(e)?(n=t("TeamsExportPanel.urlError"),f(!0)):f(!1),n},value:b("privacyUrl")})),d.a.createElement("div",{className:o.appTeamsExportContainerStyles.advancedMPN,key:"settingsSection2"},d.a.createElement("h4",null,t("TeamsExportPanel.advancedSettingsSubheader2")),d.a.createElement("p",null,Object(a.formatResourceStringAsLinks)(t("TeamsExportPanel.advancedSettingsSubheader2Details"),[r.default.teamsExportAddPartnersLearn])),d.a.createElement("h4",null,t("TeamsExportPanel.advanceSettingsMPNIdLabel")),d.a.createElement(p.TextField,{placeholder:t("TeamsExportPanel.inputTextPlaceholder"),name:"mpnId",onChange:h,value:b("mpnId")}))])},h=e=>{var{t:t,teamsPackageUrl:n}=e;return d.a.createElement("div",{className:o.appTeamsExportContainerStyles.panelContent},d.a.createElement("h3",null,t("TeamsExportPanel.afterExportTitle")),d.a.createElement("p",null,t("TeamsExportPanel.afterExport1")),d.a.createElement("p",null,Object(a.formatResourceStringAsLinks)(t("TeamsExportPanel.afterExport2"),[r.default.teamsExportLearn])),d.a.createElement("iframe",{width:"1",height:"1",frameBorder:"0",src:n}))}},5480:function(e,t,n){"use strict";n.r(t),n.d(t,"appTeamsExportContainerStyles",(function(){return r}));var o=n(719),r=Object(o.mergeStyleSets)({instructions:{selectors:{"p:first-child":{marginBottom:"16px"},"h4:first-child":{marginBottom:"16px"}}},advancedAll:{selectors:{"h4:first-child":{marginBottom:"5px"}}},advancedMPN:{selectors:{"h4:first-of-type":{marginTop:"24px"},"h4:first-child":{marginBottom:"5px"}}},panelContent:{marginTop:"26px",selectors:{p:{marginBottom:"12px"},h3:{marginBottom:"5px"},h4:{marginTop:"12px",marginBottom:"5px",fontWeight:"600"},a:{marginTop:"24px"}}},appSection:{width:"100%",padding:"12px 0px",selectors:{p:{marginTop:"5px"},img:{borderRadius:"2px",boxShadow:"0px 0.3px 0.9px rgba(0, 0, 0, 0.11), 0px 1.6px 3.6px rgba(0, 0, 0, 0.13)",float:"left",width:"32px",height:"32px",marginRight:"20px"}}},editLink:{marginBottom:"20px",display:"block",selectors:{i:{marginLeft:"5px",fontSize:"16px",marginTop:"2px"}}},advancedSettingsLink:{display:"block",marginBottom:"20px",selectors:{i:{marginLeft:"5px",fontSize:"12px",marginTop:"2px"}}}})},5484:function(e,t,n){"use strict";n.r(t),n.d(t,"useTeamsExportPanelBehaviorForCanvasApp",(function(){return P})),n.d(t,"useTeamsExportPanelBehaviorForAppModule",(function(){return E}));var o=n(5485),r=n(245),a=n(5487),i=n(3076),s=n(5488),l=n(5586),c=n(3196),p=n(3185),u=n(5587),d=n(5590),m=n(5582),b=n(5593),g=n(2869),y=n(5594),S=n(5595),f=n(1086),h=n(1087);function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function C(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach((function(t){v(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function P(e){var t,{setOpenModal:n}=Object(r.useContext)(s.ModalsWrapperContext),[p,u]=Object(r.useState)(!1),[d,f]=Object(r.useState)(!1),[O,v]=Object(r.useState)(!1),[P,E]=Object(r.useState)(!1),[T,j]=Object(r.useState)(!1),[A,R]=Object(r.useState)(!1),[I,w]=Object(r.useState)({}),[D,N]=Object(r.useState)(void 0);Object(r.useEffect)(()=>{p&&(n({name:l.ModalNames.RefreshAppDetails,appId:e.id,setRefreshApp:f}),u(!1))},[p]);var L=Object(r.useContext)(i.ApolloClientContext),{getTeamsPackage:M,loading:x,response:k,errorMessage:F}=Object(o.useLazyTeamsExportQuery)(L.environmentClient,{appName:e.name,developerInfo:JSON.stringify(I)},b.PortalScope,Object(g.getResources)().Common.Request.Failed);D!=Object(g.getResources)().TeamsExportPanel.appExportError&&F&&N(Object(g.getResources)().TeamsExportPanel.appExportError);var _=Object(r.useContext)(a.RootPropsContext),U=null!==(t=Object(m.currentEnvironmentName)(_))&&void 0!==t?t:"",{canvasApp:V}=Object(c.useCanvasAppQuery)(L.environmentClient,{appId:e.id},b.PortalScope,Object(g.getResources)().Common.Request.Failed,!1,d),B=V&&Object(h.getEditAppUri)(U,V.id,void 0);return{errorMessage:D,loading:x,response:k,appUI:V&&{displayName:V.displayName,description:V.description,backgroundColor:V.imageBackgroundColor,backgroundImageUri:V.imageUrl,editUrl:B,isAppModule:!1},getTeamsPackage:M,getTrustedSideLoadingDeepLink:()=>{var t=Object(y.generateTrustedSideLoadingDeepLink)(e.name,U);Object(b.trackUserActionClickButton)(S.CanvasAppTeamsExportEvents.clickAddToTeamsButton);try{window.open(t,"_blank")}catch(n){N(Object(g.getResources)().TeamsExportPanel.appExportError),Object(b.trackErrorTrace)(S.CanvasAppTeamsExportEvents.deepLinkOpenError,{error:n})}},setIsWebsiteUrlInvalid:E,isWebsiteUrlInvalid:P,setIsTermsOfUseUrlInvalid:j,isTermsOfUseUrlInvalid:T,setIsPrivacyUrlInvalid:R,isPrivacyUrlInvalid:A,setAdvancedCollapsed:v,advancedCollapsed:O,onUpdateAdvancedSettings:(e,t)=>{if(!I.hasOwnProperty(e)&&t||I[e]!==t){var n=C(C({},I),{},{[e]:t});t||delete n[e],w(n)}},getAdvancedSettingsValue:e=>e in I?I[e]:""}}function E(e,t,n,c){var h,O,v,{setOpenModal:P}=Object(r.useContext)(s.ModalsWrapperContext),[E,T]=Object(r.useState)(!1),[,j]=Object(r.useState)(!1),[A,R]=Object(r.useState)(!1),[I,w]=Object(r.useState)(!1),[D,N]=Object(r.useState)(!1),[L,M]=Object(r.useState)(!1),[x,k]=Object(r.useState)({}),[F,_]=Object(r.useState)(void 0),U=null!==(h=null==e?void 0:e.id)&&void 0!==h?h:n,V=null!==(O=null==e?void 0:e.uniquename)&&void 0!==O?O:c;Object(r.useEffect)(()=>{E&&(P({name:l.ModalNames.RefreshAppDetails,appId:U,setRefreshApp:j}),T(!1))},[E]);var{environmentClient:B}=Object(r.useContext)(i.ApolloClientContext),H=Object(r.useContext)(a.RootPropsContext),G=null!==(v=Object(m.currentEnvironmentName)(H))&&void 0!==v?v:"",{getAppModuleTeamsPackage:W,loading:q,response:z,errorMessage:Q}=Object(o.useLazyTeamsExportModelDrivenAppQuery)(B,{environmentName:G,appIdentifier:V,developerInfo:JSON.stringify(x)},b.PortalScope,Object(g.getResources)().Common.Request.Failed),{appModule:K}=Object(p.useAppModuleQuery)(B,{appModuleId:U},b.PortalScope,Object(g.getResources)().Common.Request.Failed,Object(g.getResources)().Common.Request.Failed),{webResource:Y}=Object(d.useWebResourceQuery)(B,{webResourceId:null==K?void 0:K.webresourceid},b.PortalScope,Object(g.getResources)().Common.Request.Failed,Object(g.getResources)().Common.Request.Failed);F!=Object(g.getResources)().TeamsExportPanel.appExportError&&Q&&_(Object(g.getResources)().TeamsExportPanel.appExportError);var{unifiedApp:J}=Object(u.useUnifiedApp)({queryOptions:{client:B,variables:{logicalName:V},fetchPolicy:"cache-and-network",skip:!V},telemetryScope:b.PortalScope,defaultErrorMessage:Object(g.getResources)().Common.Request.Failed});return{errorMessage:F,loading:q,response:z,appUI:K&&{displayName:K.displayName,description:K.description,backgroundColor:K.imageBackgroundColor,backgroundImageUri:null==Y?void 0:Y.content,editUrl:f.getAppModuleDesignerUrl(H.rootProps.currentEnvironment.properties.linkedEnvironmentMetadata.instanceUrl,K.id,t),isAppModule:!0},getAppModuleTeamsPackage:W,getTrustedSideLoadingDeepLink:()=>{var e=Object(y.generateTrustedSideLoadingDeepLink)(null==J?void 0:J.name,G);Object(b.trackUserActionClickButton)(S.AppModuleTeamsExportEvents.clickAddToTeamsButton);try{window.open(e,"_blank")}catch(t){_(Object(g.getResources)().TeamsExportPanel.appExportError),Object(b.trackErrorTrace)(S.AppModuleTeamsExportEvents.deepLinkOpenError,{error:t})}},setLinkClicked:T,setIsWebsiteUrlInvalid:w,isWebsiteUrlInvalid:I,setIsTermsOfUseUrlInvalid:N,isTermsOfUseUrlInvalid:D,setIsPrivacyUrlInvalid:M,isPrivacyUrlInvalid:L,setAdvancedCollapsed:R,advancedCollapsed:A,onUpdateAdvancedSettings:(e,t)=>{if(!x.hasOwnProperty(e)&&t||x[e]!==t){var n=C(C({},x),{},{[e]:t});t||delete n[e],k(n)}},getAdvancedSettingsValue:e=>e in x?x[e]:""}}},5485:function(e,t,n){"use strict";n.r(t),n.d(t,"useLazyTeamsExportQuery",(function(){return c})),n.d(t,"useLazyTeamsExportModelDrivenAppQuery",(function(){return p}));var o=n(3152),r=n(217),a=n(245),i=n(3192),s=n(3193),l=n(5486);function c(e,t,n,c){var p=s.TelemetryScenarioNames.teamsExport,[u,d]=Object(a.useState)(),[m,{loading:b,error:g,data:y}]=Object(o.useLazyQuery)(l.TeamsExportQuery,{fetchPolicy:"no-cache",client:e||void 0,onCompleted:e=>{u&&u.complete()},onError:e=>{var t=Object(i.getResponseMessageFromApolloError)(e,c);null==u||u.failure({error:t,clientError:e&&e.message})},variables:t});return Object(a.useEffect)(()=>{b&&d(Object(r.trackLoadScenario)(n,p))},[b]),{getTeamsPackage:m,loading:b,errorMessage:g&&Object(i.getResponseMessageFromApolloError)(g,c),response:y&&y.teamsPackage&&y.teamsPackage.response}}function p(e,t,n,c){var p,u=s.TelemetryScenarioNames.modelDrivenAppTeamsExport,[d,m]=Object(a.useState)(),[b,{loading:g,error:y,data:S}]=Object(o.useLazyQuery)(l.AppModuleTeamsExportQuery,{fetchPolicy:"no-cache",client:e||void 0,onCompleted:e=>{null==d||d.complete()},onError:e=>{var t=Object(i.getResponseMessageFromApolloError)(e,c);null==d||d.failure({error:t,clientError:e&&e.message})},variables:t});return Object(a.useEffect)(()=>{g&&m(Object(r.trackLoadScenario)(n,u))},[g]),{getAppModuleTeamsPackage:b,loading:g,errorMessage:y&&Object(i.getResponseMessageFromApolloError)(y,c),response:null==S||null===(p=S.appModuleTeamsPackage)||void 0===p?void 0:p.response}}},5486:function(e,t,n){"use strict";n.r(t),n.d(t,"TeamsExportQuery",(function(){return l})),n.d(t,"AppModuleTeamsExportQuery",(function(){return c}));var o,r,a=n(3128),i=n.n(a);function s(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var l=i()(o||(o=s(["\n  query TeamsExportLink($appName: String!, $developerInfo: String) {\n    teamsPackage(appName: $appName, developerInfo: $developerInfo) {\n      response\n    }\n  }\n"]))),c=i()(r||(r=s(["\n  query appModuleTeamsExportLink($environmentName: String!, $appIdentifier: String!, $developerInfo: String) {\n    appModuleTeamsPackage(\n      environmentName: $environmentName\n      appIdentifier: $appIdentifier\n      developerInfo: $developerInfo\n    ) {\n      response\n    }\n  }\n"])))},5488:function(e,t,n){"use strict";n.r(t),n.d(t,"ModalsWrapperContext",(function(){return l})),n.d(t,"useModalsWrapperContext",(function(){return c})),n.d(t,"ModalsWrapper",(function(){return p})),n.d(t,"ModalsProvider",(function(){return u}));var o=n(245),r=n.n(o),a=n(5489),i=n(5584),s=n(5586),l=r.a.createContext(null),c=()=>r.a.useContext(l),p=()=>r.a.createElement(l.Consumer,null,e=>{var{openModal:t,setOpenModal:n}=e,o=()=>n(void 0);if(t)switch(t.name){case s.ModalNames.NewComponentLibrary:return r.a.createElement(a.NewComponentLibraryModalContainer,{onDismiss:o});case s.ModalNames.RefreshAppDetails:return r.a.createElement(i.RefreshAppDetailsModalConnected,{appId:t.appId,setRefreshApp:t.setRefreshApp,onDismiss:o});default:return r.a.createElement(r.a.Fragment,null)}return r.a.createElement(r.a.Fragment,null)}),u=e=>{var[t,n]=Object(o.useState)(void 0);return r.a.createElement(l.Provider,{value:{openModal:t,setOpenModal:n}},e.children)};t.default=l},5489:function(e,t,n){"use strict";n.r(t),n.d(t,"withNewComponentLibraryModal",(function(){return c})),n.d(t,"NewComponentLibraryModalContainer",(function(){return p}));var o=n(245),r=n(5490),a=n(5487),i=n(5582),s=n(5583),l=n(1087);function c(e){return t=>{var n,[r,a]=Object(o.useState)(""),[s,c]=Object(o.useState)(""),p=null!==(n=Object(i.currentEnvironmentName)(t))&&void 0!==n?n:"",{navigate:u}=t;return o.createElement(e,{onDismiss:t.onDismiss,name:r,setName:a,nameErrorMessage:s,setNameErrorMessage:c,onCreateComponentLibrary:e=>{var t=Object(l.getNewComponentLibraryUri)(p,e,void 0);u(t)}})}}var p=Object(s.withNavigate)(Object(a.withRootProps)(c(r.NewComponentLibraryModal)))},5490:function(e,t,n){"use strict";n.r(t),n.d(t,"ComponentLibraryNameMaxLength",(function(){return d})),n.d(t,"ComponentLibraryNameRegex",(function(){return m})),n.d(t,"NewComponentLibraryModalBase",(function(){return b})),n.d(t,"NewComponentLibraryModal",(function(){return f}));var o=n(4084),r=n(545),a=n(245),i=n(5491),s=n(1429),l=n(2880),c=n(5481),p=n(5493),u=n(922),d=64,m=/^(?!\s)[^\\\/.:*?"<>|]+$/,b=e=>{var{t:t}=e,n=Object(i.getClassNames)(e.styles);return a.createElement(o.Modal,{key:"createComponentLibraryModal",isClickableOutsideFocusTrap:!0,isOpen:!0,onDismiss:e.onDismiss,closeButtonAriaLabel:t("Common.cancel"),isBlocking:!0,sections:[g(e.styles,t),y(e.styles,e.nameErrorMessage,e.setName,e.setNameErrorMessage,t)],footerButtons:S(e.name,e.nameErrorMessage,e.onDismiss,e.onCreateComponentLibrary,t),styles:n.subComponentStyles.modalStyles})};function g(e,t){var n=Object(i.getClassNames)(e);return{className:n.detailsSection,headerText:t("CreateComponentLibraryModal.title"),headerClassName:n.header,onRenderBody:()=>a.createElement("div",null,a.createElement("img",{className:n.imageSection,src:p.default.getPaths().createComponentLibrary,alt:t("CreateComponentLibraryModal.title")}),a.createElement("div",{className:n.descriptionSection},a.createElement("div",{className:n.descriptionText},Object(l.formatResourceStringAsLinks)(t("CreateComponentLibraryModal.descriptionWithLearnMoreLink"),[c.default.componentLibraryLearnMoreLink]))))}}function y(e,t,n,o,r){var l=Object(i.getClassNames)(e);return{className:l.formSection,onRenderBody:()=>a.createElement("div",{className:l.section},a.createElement(s.TextField,{label:r("CreateComponentLibraryModal.nameFieldLabel"),ariaLabel:r("CreateComponentLibraryModal.nameFieldLabel"),required:!0,errorMessage:t,onChange:(e,t)=>{var a=null!=t?t:"";!function(e,t,n){e.trim().length>d?t(n("CreateComponentLibraryModal.Validation.MaxLength.text")):m.test(e)?t(""):t(n("CreateComponentLibraryModal.Validation.AllowedCharacters.text"))}(a,o,r),n(a)}}))}}function S(e,t,n,o,r){return[{dismissableOnClick:()=>{o(e),n()},text:r("CreateComponentLibraryModal.Footer.Buttons.createButton"),primary:!0,disabled:!e||!!t},{dismissableOnClick:n,text:r("CreateComponentLibraryModal.Footer.Buttons.cancelButton")}]}var f=Object(u.translateService)("PowerappsPortal")(Object(r.styled)(b,i.getStyles))},5491:function(e,t,n){"use strict";n.r(t),n.d(t,"getClassNames",(function(){return i})),n.d(t,"getStyles",(function(){return s}));var o=n(545),r=n(5492),a=n(2882),i=Object(o.classNamesFunction)(),s=e=>({header:{fontSize:"20px",lineHeight:"28px",fontFamily:r.fonts.segoeUi,color:a.fabricColors.neutralTuatara,marginTop:"20px",marginBottom:"10px"},formSection:{flex:"1 0 380px",fontSize:"14px",lineHeight:"20px",fontFamily:r.fonts.segoeUi,color:a.fabricColors.neutralTuatara},section:{paddingTop:"70px"},detailsSection:{flex:"1 0 380px",fontSize:"14px",lineHeight:"20px",fontFamily:r.fonts.segoeUi,color:a.fabricColors.neutralChicago},subComponentStyles:{modalStyles:e=>({container:{width:"900px",borderRadius:"2px"},section:{borderRight:"none",height:"516px",overflow:"hidden"},footer:{borderTop:"none",paddingRight:"20px",paddingLeft:"24px"},closeButton:{marginTop:"24px",marginRight:"20px"},sectionContent:{paddingRight:"24px",paddingLeft:"24px"}})},descriptionSection:{margin:"16px 0px 11px 0px ",display:"flex",flexFlow:"row nowrap",flex:"1 0 180px",maxWidth:"412px",marginRight:"57px",marginTop:"16px"},imageSection:{height:"300px",width:"400px",marginTop:"20px"},descriptionText:{fontFamily:r.fonts.segoeUi,fontSize:"14px",lineHeight:"18px"}})},5584:function(e,t,n){"use strict";n.r(t),n.d(t,"RefreshAppDetailsModal",(function(){return l})),n.d(t,"RefreshAppDetailsModalConnected",(function(){return c}));var o=n(4084),r=n(245),a=n(922),i=n(2880),s=n(5585),l=e=>{var{t:t,onDismiss:n,setRefreshApp:a}=e,l=[{dismissableOnClick:()=>{a(!0),n()},text:t("TeamsExportPanel.refreshApp"),primary:!0},{dismissableOnClick:n,text:t("TeamsExportPanel.cancel")}];return r.createElement(o.Modal,{key:"createComponentLibraryModal",isClickableOutsideFocusTrap:!0,isOpen:!0,onDismiss:n,closeButtonAriaLabel:t("TeamsExportPanel.cancel"),isBlocking:!0,footerButtons:l,className:s.refreshAppDetailsModalStyles.refreshAppModal,sections:[{headerText:t("TeamsExportPanel.modalTitle"),onRenderBody:()=>r.createElement("p",null,Object(i.formatResourceStringToElement)(t("TeamsExportPanel.modalDescription"),(e,t)=>r.createElement("span",{className:s.refreshAppDetailsModalStyles.appDetailsBold},e)))}]})},c=Object(a.translateService)("PowerappsPortal")(l)},5585:function(e,t,n){"use strict";n.r(t),n.d(t,"refreshAppDetailsModalStyles",(function(){return r}));var o=n(719),r=Object(o.mergeStyleSets)({refreshAppModal:{selectors:{p:{margin:"16px 0px"},h2:{marginTop:"16px"}}},appDetailsBold:{fontWeight:"bold"}})},5586:function(e,t,n){"use strict";var o;n.r(t),n.d(t,"ModalNames",(function(){return o})),function(e){e.NewComponentLibrary="NewComponentLibraryModal",e.RefreshAppDetails="RefreshAppDetails"}(o||(o={}))},5587:function(e,t,n){"use strict";n.r(t),n.d(t,"useUnifiedApp",(function(){return p}));var o=n(3192),r=n(3193),a=n(5588),i=n(5589);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p(e){var t=Object(i.useQueryWithTelemetryScenario)(l(l({},e),{},{query:a.UnifiedAppQuery,scenarioName:r.TelemetryScenarioNames.unifiedAppGraphQl,getScenarioCompletionData:e=>({unifiedAppName:null==e?void 0:e.unifiedAppByLogicalName.name})})),{loading:n,data:s,error:c}=t;return{loading:n,errorMessage:c&&Object(o.getResponseMessageFromApolloError)(c,e.defaultErrorMessage),unifiedApp:s&&s.unifiedAppByLogicalName}}},5588:function(e,t,n){"use strict";n.r(t),n.d(t,"UnifiedAppQuery",(function(){return s}));var o,r=n(3128);var a,i,s=n.n(r)()(o||(a=["\n  query UnifiedApp($logicalName: String!) {\n    unifiedAppByLogicalName(logicalName: $logicalName) {\n      id\n      name\n      logicalName\n      appLocation\n      appModuleId\n    }\n  }\n"],i||(i=a.slice(0)),o=Object.freeze(Object.defineProperties(a,{raw:{value:Object.freeze(i)}}))))},5594:function(e,t,n){"use strict";n.r(t),n.d(t,"generateTrustedSideLoadingDeepLink",(function(){return a}));var o=n(2814),r=n(1197);function a(e,t){return"".concat(r.settings.teamsEndpoint,"/l/app/").concat(o.settings.teamsPowerAppsId,"?templateInstanceId=").concat(e,"&environment=").concat(t)}},5733:function(e,t,n){"use strict";n.r(t),n.d(t,"PublisherPanelContainer",(function(){return s}));var o=n(5734),r=n(245),a=n.n(r);function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}var s=e=>{var{onPanelDismiss:t,isCreateMode:n,publisherId:r}=e,s={panelDetails:{isCreateMode:n,publisherId:r,onPanelDismiss:t}};return a.a.createElement(o.PublisherPanel,i({defaultPanelProps:e.defaultPanelProps},s))}},5745:function(e,t,n){"use strict";n.r(t),n.d(t,"mapStateToProps",(function(){return C})),n.d(t,"mapDispatchToProps",(function(){return v})),n.d(t,"mergeProps",(function(){return P})),n.d(t,"SolutionClonePanelContainer",(function(){return E})),n.d(t,"mapToSolution",(function(){return T}));var o=n(5437),r=n(5687),a=n(5478),i=n(5629),s=n(5630),l=n(5746),c=n(5690),p=n(5691),u=n(5468),d=n(5771),m=n(5487),b=n(5582),g=n(5669),y=["rootProps"];function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(Object(n),!0).forEach((function(t){h(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function O(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var C=(e,t)=>{var n=Object(b.currentEnvironmentIdSelector)(t),o=t.cloneType===p.SolutionsCloneType.CloneSolution?Object(p.cloneSolutionStatus)(e):Object(p.patchSolutionStatus)(e),a=l.solutionsSelectors.solutionSelector(e,t.solutionId),s=t.cloneType===p.SolutionsCloneType.CloneSolution?[]:l.solutionsSelectors.solutionsSelector(e,n);return{cloneResponse:o,solution:T(a),solutions:(s||[]).map(T),logEvent:r.SolutionClonePanelLoad,loadProgress:[Object(i.toLoadingState)(!!a,t.cloneType===p.SolutionsCloneType.CloneSolution?!!c.cloneSolutionClear&&g.CommonErrors.UnspecifiedError:!!c.patchSolutionClear&&"")]}},v=(e,t)=>({onDismiss:()=>{e(u.sharedActions.panelClose({panelType:a.PanelToShowType.SolutionClonePanel}))},clearCloneResponse:()=>{t.cloneType===p.SolutionsCloneType.CloneSolution?e(Object(c.cloneSolutionClear)()):e(Object(c.patchSolutionClear)())},onSolutionCloneSaveClick:t=>e(Object(s.logAction)(l.solutionsActions.solutionCloneRequest(t),r.SolutionCommandEvents.Clone.eventName)),dispatchTelemetry:e}),P=(e,t,n)=>{var{rootProps:o}=n,r=O(n,y);return f(f(f(f({},e),t),r),{},{dispatchTelemetry:t.dispatchTelemetry,defaultPanelProps:n.defaultPanelProps})},E=Object(m.withRootProps)(Object(o.connect)(C,v,P)(d.SolutionClonePanel));function T(e){if(e)return{id:e.solutionid,parentId:e._parentsolutionid_value,version:e.version,createdOn:e.createdon,friendlyName:e.friendlyname,uniqueName:e.uniquename,isManaged:e.ismanaged}}},5746:function(e,t,n){"use strict";n.r(t);var o=n(5690);n.d(t,"solutionsActions",(function(){return o}));var r=n(5747);n.d(t,"solutionsMiddlewares",(function(){return r}));var a=n(5692),i=n(5691);n.d(t,"solutionsSelectors",(function(){return i})),t.default=a.reducer},5747:function(e,t,n){"use strict";n.r(t);var o=n(5748);n.d(t,"SolutionsClientRootSaga",(function(){return o.SolutionsClientRootSaga}));var r=n(5755);n.d(t,"SolutionsClientSaga",(function(){return r.default}));var a=n(5770);n.d(t,"SolutionsActionsMiddleware",(function(){return a.SolutionsActionsMiddleware}))},5748:function(e,t,n){"use strict";n.r(t),n.d(t,"SolutionsClientRootSaga",(function(){return a}));var o=n(5749),r=n(5746);function*a(){yield Object(o.all)([Object(o.fork)(r.solutionsMiddlewares.SolutionsClientSaga)])}},5755:function(e,t,n){"use strict";n.r(t),n.d(t,"createSolution",(function(){return F})),n.d(t,"deleteSolutionSaga",(function(){return J})),n.d(t,"fetchAsyncSolutionJobsFromLocalStorage",(function(){return se}));var o=n(2866),r=n(5756),a=n(5757),i=n(5749),s=n(5746),l=n(5676),c=n(5604),p=n(2886),u=n(5758),d=n(5760),m=n(2873),b=n(5597),g=n(2868),y=n(2869),S=n(2880),f=n(5474),h=n(5626),O=n(5690),C=n(5691),v=n(2885),P=n(5606),E=n(5766),T=n(5767),j=n(5768),A=n(2699),R=n(2888),I=n(217),w=n(2807);function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function N(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(Object(n),!0).forEach((function(t){L(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function L(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function*M(e){e.payload&&!e.payload.forceRefresh&&(yield Object(i.put)(Object(O.fetchSolutionsLoading)()));var t=P.SagaContextProps.getCurrentEnvironment();try{var n=g.MetadataClientInstance.getInstance(),o="",r=e&&e.payload&&e.payload.solutionTypeFilterOption&&e.payload.solutionTypeFilterOption!==l.SolutionTypeFilterOptions.All?"ismanaged eq ".concat(e.payload.solutionTypeFilterOption===l.SolutionTypeFilterOptions.Managed?"true":"false"):void 0,a="endswith(uniquename, '".concat(p.PowerAppsCheckerNamePattern,"')"),d="uniquename eq '".concat(R.CUSTOMER_SERVICE_APP,"'");o=r?"(".concat("isvisible eq true"," and ").concat(r,")"):"".concat("isvisible eq true"),o+=" or ".concat(a," or ").concat(d);var m=yield n.fetchList("Solution",void 0,{filter:o,expand:{publisherid:{columns:["uniquename","publisherid","friendlyname","customizationprefix","customizationoptionvalueprefix"]}}},{scenarioName:g.MCLTelemetryEventsMap.PAPortalPrefix},{timeout:15e3}),b=[],y=!1;(e&&e.payload||{}).pollOptions&&(yield Object(i.spawn)(u.setupPolling,e));var S=null;if(m.data){for(b=m.data.map(e=>N(N({},e),{},{id:e.solutionid,stampedEnvironmentIdentifier:c.getEnvironmentIdentifier(t)}));m.hasNext;)yield m.next(),b=b.concat(m.data.map(e=>N(N({},e),{},{id:e.solutionid,stampedEnvironmentIdentifier:c.getEnvironmentIdentifier(t)})));var f=b.findIndex(e=>e.uniquename.endsWith(p.PowerAppsCheckerNamePattern));f>-1?(y=!0,S=b[f],b[f].isvisible&&e.payload.solutionTypeFilterOption!==l.SolutionTypeFilterOptions.Unmanaged||(S=b.splice(f,1)[0])):e.payload.solutionTypeFilterOption===l.SolutionTypeFilterOptions.Unmanaged&&(y=yield Object(i.select)(s.solutionsSelectors.isSolutionCheckerInstalled))}yield Object(i.put)(Object(O.fetchSolutionsFulfilled)({environmentId:t.id,solutions:b.filter(e=>e.isvisible||e.uniquename!==R.CUSTOMER_SERVICE_APP),solutionCheckerSolution:S,solutionTypeFilterOption:e.payload.solutionTypeFilterOption,isSolutionCheckerInstalled:y,isCustomerServiceAppInstalled:!!b.find(e=>e.uniquename===R.CUSTOMER_SERVICE_APP)})),A.featureGates.enableSolutionChecker&&y&&e.payload.solutionTypeFilterOption!==l.SolutionTypeFilterOptions.Managed&&(yield Object(i.put)(Object(O.solutionCheckerFetchStatus)({})))}catch(h){yield Object(i.put)(Object(O.fetchSolutionsRejected)({environmentId:t.id,error:{responseCode:Object(j.getResponseErrorCode)(h),errorMessage:Object(j.getResponseErrorMessage)(h)}}))}finally{yield Object(i.put)(Object(O.fetchSolutionsLoaded)())}}function*x(e){var t=P.SagaContextProps.getCurrentEnvironment();try{var n=yield g.MetadataClientInstance.getInstance(),o=yield n.fetchPublishersList({shouldShowFirstPartyPublisher:!0,shouldShowMicrosoftPublisher:!0,shouldShowReadOnlyPublisher:!0}),r=[];(e&&e.payload||{}).pollOptions&&(yield Object(i.spawn)(u.setupPolling,e)),o&&o.data&&o.data.length>0&&(r=o.data.map(e=>({id:e.publisherid,publisher:e}))),yield Object(i.put)(Object(O.fetchPublishersFulfilled)({publishers:r,environmentId:t.id}))}catch(a){yield Object(i.put)(Object(O.fetchPublishersRejected)({error:Object(j.getResponseErrorMessage)(a),environmentId:t.id}))}}function*k(e){var t=P.SagaContextProps.getCurrentEnvironment();try{var n=yield g.MetadataClientInstance.getInstance(),o=yield n.fetchListView("WebResource","ActiveHTML",void 0,{filter:"ismanaged eq false"},{scenarioName:g.MCLTelemetryEventsMap.PAPortalPrefix}),r=[];o&&o.data&&o.data.length>0&&(r=o.data.map(e=>({id:e.webresourceid,webResource:e}))),yield Object(i.put)(Object(O.fetchConfigurationPagesFulfilled)({configurationPages:r,environmentId:t.id}))}catch(a){yield Object(i.put)(Object(O.fetchConfigurationPagesRejected)({error:Object(j.getResponseErrorMessage)(a),environmentId:t.id}))}}function*F(e){var t=Object(y.getResources)();try{var n=yield g.MetadataClientInstance.getInstance(),o={uniquename:e.payload.name,friendlyname:e.payload.displayName,_publisherid_value:e.payload.publisher,version:e.payload.version,_configurationpageid_value:e.payload.configurationPage,installedon:e.payload.installedOn,description:e.payload.description};yield n.executeAction("Solution","Create",void 0,o,{scenarioName:g.MCLTelemetryEventsMap.PAPortalPrefix}),yield Object(i.put)(Object(O.createSolutionSucceeded)({response:t.Model.Solutions.Create.successMessage}));var r=Object(l.getSolutionListFilter)();yield Object(i.put)(Object(O.fetchSolutionsRequest)({forceRefresh:!0,solutionTypeFilterOption:r}))}catch(a){yield Object(i.put)(Object(O.createSolutionFailed)({response:Object(S.formatResourceString)(t.Model.Solutions.Create.failureMessage,Object(j.getResponseErrorMessage)(a))}))}}function*_(e){var t=Object(y.getResources)();try{var n=yield g.MetadataClientInstance.getInstance(),o={solutionid:e.payload.solution.id,uniquename:e.payload.name,friendlyname:e.payload.displayName,_publisherid_value:e.payload.publisher,_configurationpageid_value:e.payload.configurationPage,installedon:e.payload.installedOn,description:e.payload.description,ismanaged:e.payload.solution.ismanaged};if(e.payload.solution.version!==e.payload.version&&(o.version=e.payload.version),""!==Object(p.getSolutionConfigurationPageId)(e.payload.solution)&&""===e.payload.configurationPage){var r=yield n.createBatch({scenarioName:g.MCLTelemetryEventsMap.PAPortalPrefix+"."+g.MCLTelemetryEventsMap.SolutionUpdate});r.executeAction("Solution","RemoveConfigurationPage",void 0,e.payload.solution),r.executeAction("Solution","Update",void 0,o,void 0),yield r.submit({solutionName:""})}else yield n.executeAction("Solution","Update",void 0,o,{scenarioName:g.MCLTelemetryEventsMap.PAPortalPrefix});yield Object(i.put)(Object(O.updateSolutionSucceeded)({response:t.Model.Solutions.Update.successMessage}));var a=Object(l.getSolutionListFilter)();yield Object(i.put)(Object(O.fetchSolutionsRequest)({forceRefresh:!0,solutionTypeFilterOption:a})),e&&e.payload&&e.payload.exportSolution&&(yield Object(i.put)(Object(O.exportSolution)({solution:e.payload.solution,asManaged:e.payload.exportSolution.asManaged,version:e.payload.version})))}catch(s){yield Object(i.put)(Object(O.updateSolutionFailed)({response:Object(S.formatResourceString)(t.Model.Solutions.Update.failureMessage,Object(j.getResponseErrorMessage)(s))})),e&&e.payload&&e.payload.exportSolution&&Object(O.exportSolutionError)({message:Object(S.formatResourceString)(Object(y.getResources)().Model.Solutions.SolutionExportProgress.failureMessage,s.message)}),yield Object(i.put)(Object(O.solutionExportPanelResponseClear)())}}function*U(e){var t,n=P.SagaContextProps.getCurrentEnvironment(),o=P.SagaContextProps.getAadUser(),r=yield Object(i.select)(h.clientSessionId),a=yield Object(i.select)(C.solutionCheckerSolutionSelector),s=e.payload.solution;try{t=Object(I.trackLoadScenario)(w.PortalScope,"SolutionChecker/RunRequest");var l=c.getCrmInstanceUrl(n);if(!l)throw new Error(Object(y.getResources)().Model.Home.Apps.NoDatabase.message);var p={solutions:[{ID:s.solutionid,Name:s.uniquename}]},u={url:b.solutionCheckerRunUrl,data:JSON.stringify(p),method:"POST",responseType:"text",headers:{"Content-Type":"application/json","x-ms-orgurl":l,"x-ms-requestorid":o.objectId,"x-ms-organization-id":s._organizationid_value,"x-ms-tenant-id":o.tenantId,"x-ms-client-session-id":r}};a&&(u.headers["x-ms-pa-checker-version"]=a.version);var m=yield Object(i.call)(d.default,e,u);if(!m)return t.complete(),null;if(m.data&&m.data.runcorrelationid)t.complete(),yield Object(i.put)(Object(O.solutionCheckerRunSucceeded)({response:m,solutionId:s.solutionid,environmentId:n.id}));else{var g=Object(j.getResponseError)(m);t.failure({exception:g}),yield Object(i.put)(Object(O.solutionCheckerRunFailed)({errorObject:m,exception:g,solutionId:s.solutionid,environmentId:n.id}))}}catch(g){t.failure({exception:g}),yield Object(i.put)(Object(O.solutionCheckerRunFailed)({exception:g,solutionId:s.solutionid,environmentId:n.id}))}}function*V(e){var t,n=P.SagaContextProps.getCurrentEnvironment(),o=P.SagaContextProps.getAadUser(),r=yield Object(i.select)(h.clientSessionId),a=e.payload.solution;try{t=Object(I.trackLoadScenario)(w.PortalScope,"SolutionChecker/DownloadResults");var s=c.getCrmInstanceUrl(n);if(!s)throw new Error(Object(y.getResources)().Model.Home.Apps.NoDatabase.message);var{customdetails:l}=a.solutionCheckerResults.lastRun,p=l?JSON.parse(l):null,u=p&&p.RegionUriHint||"",m=""!==u?"https://"+u+b.solutionCheckerDownloadRequestUrl:b.solutionCheckerDownloadRequestUrl,g={url:m="".concat(m,"?componentId=").concat(a.solutionid),method:"GET",headers:{"Content-Type":"application/json","x-ms-orgurl":s,"x-ms-requestorid":o.objectId,"x-ms-organization-id":a._organizationid_value,"x-ms-tenant-id":o.tenantId,"x-ms-client-session-id":r}},S=yield Object(i.call)(d.default,e,g);if(!S)return t.complete(),null;if(S.data&&S.data.downloadurl)t.complete(),yield Object(i.put)(Object(O.solutionCheckerDownloadSucceeded)({solutionId:a.solutionid,environmentId:n.id})),yield Object(i.put)(Object(O.solutionCheckerDownloadUrl)({url:S.data.downloadurl}));else{var f=S.status;t.failure({exception:f}),yield Object(i.put)(Object(O.solutionCheckerDownloadFailed)({errorObject:S,exception:f,solutionId:a.solutionid,environmentId:n.id}))}}catch(f){t.failure({exception:f}),yield Object(i.put)(Object(O.solutionCheckerDownloadFailed)({exception:f,solutionId:a.solutionid,environmentId:n.id}))}}function*B(e){var t,n=P.SagaContextProps.getCurrentEnvironment(),o=P.SagaContextProps.getAadUser(),r=yield Object(i.select)(h.clientSessionId),a=e.payload.solution;try{t=Object(I.trackLoadScenario)(w.PortalScope,"SolutionChecker/RunCancel");var s=c.getCrmInstanceUrl(n);if(!s)throw new Error(Object(y.getResources)().Model.Home.Apps.NoDatabase.message);var l={componentid:a.solutionid},p={url:b.solutionCheckerCancelRequestUrl,data:JSON.stringify(l),method:"PATCH",responseType:"text",headers:{"Content-Type":"application/json","x-ms-orgurl":s,"x-ms-requestorid":o.objectId,"x-ms-organization-id":a._organizationid_value,"x-ms-tenant-id":o.tenantId,"x-ms-client-session-id":r}},u=yield Object(i.call)(d.default,e,p);if(!u)return t.complete(),null;if(u.data&&u.data.runcorrelationid)t.complete(),yield Object(i.put)(Object(O.solutionCheckerCancelSucceeded)({solutionId:a.solutionid,environmentId:n.id}));else{var m=Object(j.getResponseError)(u);t.failure({exception:m}),yield Object(i.put)(Object(O.solutionCheckerCancelFailed)({errorObject:u,exception:m,solutionId:a.solutionid,environmentId:n.id}))}}catch(m){t.failure({exception:m}),yield Object(i.put)(Object(O.solutionCheckerCancelFailed)({exception:m,solutionId:a.solutionid,environmentId:n.id}))}}function*H(e){var t,n=P.SagaContextProps.getAadUser(),o=P.SagaContextProps.getCurrentEnvironment(),r=yield Object(i.select)(h.clientSessionId),a=c.getCrmInstanceUrl(o);try{t=Object(I.trackLoadScenario)(w.PortalScope,"SolutionChecker/InstallProvision");var s=yield Object(i.select)(C.solutionsSelector,o&&o.id),l="";s&&s.length>0&&(l=s[0]._organizationid_value);var p={tenantid:n.tenantId},u={url:b.solutionCheckerInstallProvisionUrl,data:JSON.stringify(p),method:"POST",responseType:"text",headers:{"Content-Type":"application/json","x-ms-orgurl":a,"x-ms-organization-id":l,"x-ms-requestorid":n.objectId,"x-ms-tenant-id":n.tenantId,"x-ms-client-session-id":r}},m=yield Object(i.call)(d.default,e,u);if(!m)return t.complete(),null;if(Object(j.hasResponseError)(m)){var g=Object(j.getResponseError)(m);t.failure({exception:g}),yield Object(i.put)(Object(O.solutionCheckerInstallProvisionFailed)({environmentId:o.id,exception:g}))}else t.complete(),yield Object(i.put)(Object(O.solutionCheckerInstallProvisionSucceeded)({environmentId:o.id}))}catch(g){t.failure({exception:g}),yield Object(i.put)(Object(O.solutionCheckerInstallProvisionFailed)({environmentId:o.id,exception:g.message}))}}function*G(e){yield Object(i.put)(Object(T.apiCallClear)(E.SolutionComponentApiCalls.PublishComponents));try{var t=yield g.MetadataClientInstance.getInstance();yield t.publishAllCustomizations({scenarioName:g.MCLTelemetryEventsMap.PAPortalPrefix}),yield Object(i.put)(Object(O.publishAllCustomizationsSucceeded)({response:Object(y.getResources)().Model.Solutions.PublishAllCustomizations.successMessage,originatedFromPanel:e.payload.originatedFromPanel}))}catch(n){yield Object(i.put)(Object(O.publishAllCustomizationsFailed)({exception:Object(S.formatResourceString)(Object(y.getResources)().Model.Solutions.PublishAllCustomizations.failureMessage,Object(j.getResponseErrorMessage)(n)),originatedFromPanel:e.payload.originatedFromPanel}))}}function*W(e){yield Object(i.put)(Object(T.apiCallClear)(E.SolutionComponentApiCalls.PublishToSourceControl));try{var t=yield g.MetadataClientInstance.getInstance();yield t.publishToSourceControl({scenarioName:g.MCLTelemetryEventsMap.PAPortalPrefix}),yield Object(i.put)(Object(O.publishToSourceControlSucceeded)({response:Object(y.getResources)().Model.Solutions.PublishToSourceControl.successMessage,originatedFromPanel:e.payload.originatedFromPanel}))}catch(n){yield Object(i.put)(Object(O.publishToSourceControlFailed)({exception:Object(S.formatResourceString)(Object(y.getResources)().Model.Solutions.PublishToSourceControl.failureMessage,Object(j.getResponseErrorMessage)(n)),originatedFromPanel:e.payload.originatedFromPanel}))}}function*q(e){yield Object(i.put)(Object(T.apiCallClear)(E.SolutionComponentApiCalls.RefreshFromSourceControl));try{var t=yield g.MetadataClientInstance.getInstance();yield t.refreshFromSourceControl({scenarioName:g.MCLTelemetryEventsMap.PAPortalPrefix}),yield Object(i.put)(Object(O.refreshFromSourceControlSucceeded)({response:Object(y.getResources)().Model.Solutions.RefreshFromSourceControl.successMessage,originatedFromPanel:e.payload.originatedFromPanel}))}catch(n){yield Object(i.put)(Object(O.refreshFromSourceControlFailed)({exception:Object(S.formatResourceString)(Object(y.getResources)().Model.Solutions.RefreshFromSourceControl.failureMessage,Object(j.getResponseErrorMessage)(n)),originatedFromPanel:e.payload.originatedFromPanel}))}}function*z(e){var t=Object(y.getResources)();try{var n=yield g.MetadataClientInstance.getInstance();yield n.executeAction("Solution","UpgradeSolution",void 0,e.payload.solution,{scenarioName:g.MCLTelemetryEventsMap.PAPortalPrefix}),yield Object(i.put)(Object(O.upgradeSolutionSucceeded)({response:t.Model.Solutions.UpgradeSolution.successMessage}));var o=Object(l.getSolutionListFilter)();yield Object(i.put)(Object(O.fetchSolutionsRequest)({forceRefresh:!0,solutionTypeFilterOption:o}))}catch(r){yield Object(i.put)(Object(O.upgradeSolutionFailed)({exception:Object(S.formatResourceString)(t.Model.Solutions.UpgradeSolution.failureMessage,Object(j.getResponseErrorMessage)(r))}))}}function*Q(e){var t,n=P.SagaContextProps.getCurrentEnvironment();try{t=Object(I.trackLoadScenario)(w.PortalScope,"SolutionChecker/Status");var o,r=yield g.MetadataClientInstance.getInstance(),a=Object(b.getSolutionCheckerFetchXml)(),s=yield r.retrieveFetchXmlResults({EntitySetName:"msdyn_analysiscomponents",fetchXml:a},{scenarioName:g.MCLTelemetryEventsMap.PAPortalPrefix}),l=yield Object(i.select)(C.solutionsSelector,n&&n.id),c=yield Object(i.select)(C.solutionCheckerResultsMap);s.value&&(o=c.withMutations(e=>{l.forEach(t=>{var n=Object(p.getSolutionSpecificSolutionCheckerResults)(t,s.value);t.solutionCheckerResults=n,e.set(t.id,n)})})),t.complete(),yield Object(i.put)(Object(O.solutionCheckerFetchStatusFulfilled)({environmentId:n.id,solutions:l})),yield Object(i.put)(Object(O.solutionCheckerFetchStatusSucceeded)({solutionCheckerResultMap:o}))}catch(u){t.failure({exception:u}),yield Object(i.put)(Object(O.solutionCheckerFetchStatusRejected)({environmentId:n.id,error:Object(j.getResponseErrorMessage)(u)}))}}function*K(e){var t,n=P.SagaContextProps.getCurrentEnvironment();try{t=Object(I.trackLoadScenario)(w.PortalScope,"SolutionChecker/IssueSummary");var o=yield g.MetadataClientInstance.getInstance(),r=yield Object(i.select)(C.solutionCheckerResult,e.payload.solution.id),a=r.lastRun&&r.lastRun.createdon?new Date(r.lastRun.createdon):null,s=yield o.retrieveFetchXmlResults({EntitySetName:"msdyn_analysisresults",fetchXml:Object(b.solutionCheckerIssueSummaryXml)(a)},{scenarioName:g.MCLTelemetryEventsMap.PAPortalPrefix});s.value&&(t.complete(),yield Object(i.put)(Object(O.solutionCheckerFetchIssueSummarySucceeded)({environmentId:n.id,solutionId:e.payload.solution.id,createdOn:a,issueSummary:s.value[0].severitycount})))}catch(l){console.log(l),t.failure({exception:l})}}function*Y(e){try{var t=yield g.MetadataClientInstance.getInstance(),n=Object(p.getSolutionName)(e.payload.solution),o=N(N({},yield t.executeAction("ExportSolution","ExportSolutionAsync",void 0,{SolutionName:n,Managed:e.payload.asManaged},{scenarioName:g.MCLTelemetryEventsMap.PAPortalPrefix})),{},{solutionId:e.payload.solution.solutionid,solutionDisplayName:Object(p.getSolutionDisplayName)(e.payload.solution),solutionDetails:{solutionUniqueName:n,asManaged:e.payload.asManaged,version:e.payload.version}});Object(m.putAsyncSolutionJobIntoStorage)(P.SagaContextProps.getCurrentEnvironment().id,N({type:"export"},o)),yield Object(i.put)(Object(O.solutionAsyncJobRegister)({asyncJob:N({type:"export"},o)})),yield Object(i.put)(Object(O.solutionAsyncOperationPollProgress)())}catch(u){if("0x80040315"==u.serverErrorCode)try{var r=yield g.MetadataClientInstance.getInstance(),a=yield r.executeAction("Solution","Export",{managed:e.payload.asManaged},{uniquename:e.payload.solution.uniquename},{scenarioName:g.MCLTelemetryEventsMap.PAPortalPrefix}),s=Object(p.getExportFileName)({solutionUniqueName:e.payload.solution.uniquename,asManaged:e.payload.asManaged,version:e.payload.version}),l=atob(a.ExportSolutionFile),c=Object(v.createBlobFromData)(l,"application/zip");return Object(v.triggerFileDownloadFromBlob)(c,s),void(yield Object(i.put)(Object(O.exportSolutionSuccess)({message:Object(S.formatResourceString)(Object(y.getResources)().Model.Solutions.ExportPanel.exportSuccess,Object(p.getSolutionDisplayName)(e.payload.solution))})))}catch(d){Object(O.exportSolutionError)({message:Object(S.formatResourceString)(Object(y.getResources)().Model.Solutions.Export.failed,d.message)})}else yield Object(i.put)(Object(O.exportSolutionError)({message:Object(S.formatResourceString)(Object(y.getResources)().Model.Solutions.SolutionExportProgress.failureMessage,u.message)}))}finally{yield Object(i.put)(Object(O.solutionExportPanelResponseClear)()),yield Object(i.put)(Object(O.solutionExportPanelClosed)())}}function*J(e){yield Object(i.put)(Object(f.closeConfirmDialog)());var t=Object(y.getResources)();try{var n=yield g.MetadataClientInstance.getInstance();yield n.executeAction("Solution","Delete",void 0,e.payload.solution,{scenarioName:g.MCLTelemetryEventsMap.PAPortalPrefix}),yield Object(i.put)(Object(O.deleteSolutionSucceeded)({response:t.Model.Solutions.Delete.successMessage}));var o=Object(l.getSolutionListFilter)();yield Object(i.put)(Object(O.fetchSolutionsRequest)({forceRefresh:!0,solutionTypeFilterOption:o}))}catch(r){yield Object(i.put)(Object(O.deleteSolutionFailed)({response:Object(S.formatResourceString)(t.Model.Solutions.Delete.failureMessage,Object(j.getResponseErrorMessage)(r)),serverErrorCode:null==r?void 0:r.serverErrorCode}))}}function*X(e){var t=Object(y.getResources)();try{var n=yield g.MetadataClientInstance.getInstance();yield n.executeAction("Solution",e.payload.cloneType===C.SolutionsCloneType.CloneSolution?"CloneAsSolution":"CloneAsPatch",{displayName:e.payload.displayName,versionNumber:e.payload.versionNumber},[{uniquename:e.payload.solution.uniquename,ismanaged:e.payload.solution.ismanaged,_parentsolutionid_value:e.payload.solution._parentsolutionid_value}],{scenarioName:g.MCLTelemetryEventsMap.PAPortalPrefix}),yield Object(i.put)(e.payload.cloneType===C.SolutionsCloneType.CloneSolution?Object(O.cloneSolutionSucceeded)({response:t.Model.Solutions.CloneSolution.successMessage}):Object(O.patchSolutionSucceeded)({response:t.Model.Solutions.PatchSolution.successMessage}));var o=Object(l.getSolutionListFilter)();yield Object(i.put)(Object(O.fetchSolutionsRequest)({forceRefresh:!0,solutionTypeFilterOption:o}))}catch(r){yield Object(i.put)(e.payload.cloneType===C.SolutionsCloneType.CloneSolution?Object(O.cloneSolutionFailed)({response:Object(S.formatResourceString)(t.Model.Solutions.CloneSolution.failureMessage,Object(j.getResponseErrorMessage)(r))}):Object(O.patchSolutionFailed)({response:Object(S.formatResourceString)(t.Model.Solutions.PatchSolution.failureMessage,Object(j.getResponseErrorMessage)(r))}))}}function*Z(e){try{var t=yield g.MetadataClientInstance.getInstance(),n=yield t.executeAction("Solution","ExportTranslation",void 0,{uniquename:e.payload.solutionUniqueName},{scenarioName:g.MCLTelemetryEventsMap.PAPortalPrefix}),o=e.payload.exportTranslationFileName,r=atob(n.ExportTranslationFile),a=Object(v.createBlobFromData)(r,"application/zip");Object(v.triggerFileDownloadFromBlob)(a,o),yield Object(i.put)(Object(O.exportTranslationsSolutionSucceeded)({response:Object(y.getResources)().Model.Solutions.ExportTranslations.successMessage})),e.payload.handleResponse&&e.payload.handleResponse(!0)}catch(s){yield Object(i.put)(Object(O.exportTranslationsSolutionFailed)({exception:Object(S.formatResourceString)(Object(y.getResources)().Model.Solutions.ExportTranslations.failureMessage,Object(j.getResponseErrorMessage)(s))})),e.payload.handleResponse&&e.payload.handleResponse(!1)}}function*$(e){try{var t=Object(y.getResources)(),n=yield g.MetadataClientInstance.getInstance();yield n.executeAction("Solution","ImportTranslation",void 0,{TranslationFile:e.payload.importFile},{scenarioName:g.MCLTelemetryEventsMap.PAPortalPrefix}),yield Object(i.put)(Object(O.importTranslationSuccess)(t.Model.Solutions.Commands.importTranslation.success))}catch(o){yield Object(i.put)(Object(O.importTranslationFailed)(Object(j.getResponseErrorMessage)(o)))}}function*ee(){try{var e=yield g.MetadataClientInstance.getInstance(),t=yield e.describeActions("Solution");if(!t)return null;yield Object(i.put)(Object(O.fetchSolutionActionsFulfilled)({applicableSolutionActions:t}))}catch(n){return null}}function*te(){var e=P.SagaContextProps.getCurrentEnvironment().id;if(null==(yield Object(i.select)(C.privilegeResultsSelector,e))){yield Object(i.put)(Object(O.fetchUserPrivilegesPending)({environmentId:e}));try{var t=yield g.MetadataClientInstance.getInstance(),n=P.SagaContextProps.getAadUser(),o=yield t.checkUserPrivileges({azureactivedirectoryobjectid:n.objectId});o?yield Object(i.put)(Object(O.fetchUserPrivilegesFulfilled)({privilegeResultsMap:o,environmentId:e})):yield Object(i.put)(Object(O.fetchUserPrivilegesFailed)({environmentId:e}))}catch(r){yield Object(i.put)(Object(O.fetchUserPrivilegesFailed)({environmentId:e}))}}}function*ne(e){var t=P.SagaContextProps.getCurrentEnvironment();try{var n,o=yield g.MetadataClientInstance.getInstance(),r=yield o.fetch("Solution",{solutionId:e.payload.solutionID});if(!r)throw new Error("No solution with that ID found");n=[N(N({},r),{},{id:r.solutionid})],yield Object(i.put)(Object(O.fetchSolutionsFulfilled)({environmentId:t.id,solutions:n,solutionCheckerSolution:null,isSolutionCheckerInstalled:!1,isCustomerServiceAppInstalled:!1})),e.payload.includeSolutionCheckerStatus&&(yield Object(i.put)(Object(O.solutionCheckerFetchStatusByIdRequest)({solutionId:e.payload.solutionID,createdOn:e.payload.createdOn})))}catch(a){yield Object(i.put)(Object(O.fetchSolutionsRejected)({environmentId:t.id,error:{responseCode:Object(j.getResponseErrorCode)(a),errorMessage:Object(j.getResponseErrorMessage)(a)}}))}finally{yield Object(i.put)(Object(O.fetchSolutionsLoaded)())}}function*oe(e){var t,n=P.SagaContextProps.getCurrentEnvironment();try{t=Object(I.trackLoadScenario)(w.PortalScope,"SolutionChecker/StatusByCreatedOn");var o=yield g.MetadataClientInstance.getInstance(),r=Object(b.getSolutionCheckerFetchXml)(e.payload.solutionId,e.payload.createdOn),a=yield o.retrieveFetchXmlResults({EntitySetName:"msdyn_analysiscomponents",fetchXml:r},{scenarioName:g.MCLTelemetryEventsMap.PAPortalPrefix}),s=yield Object(i.select)(C.solutionSelector,e.payload.solutionId);if(a.value){var l=Object(p.getSolutionSpecificSolutionCheckerResults)(s,a.value);s.solutionCheckerResults=l}t.complete(),yield Object(i.put)(Object(O.solutionCheckerFetchStatusFulfilled)({environmentId:n.id,solutions:[s]}))}catch(c){t.failure({exception:c}),yield Object(i.put)(Object(O.solutionCheckerFetchStatusRejected)({environmentId:n.id,error:Object(j.getResponseErrorMessage)(c)}))}}function*re(e){var t=yield g.MetadataClientInstance.getInstance(),n=yield Object(i.select)(C.solutionAsyncJobsSelector),s=P.SagaContextProps.getCurrentEnvironment(),c=n&&n.toIndexedSeq().toArray()||[],p=[];for(var d of c){var b=yield ae(s.id,d,t);b&&p.push(b)}var y=p.filter(e=>e.payload.jobStatus!==o.AsyncOperationStatus.Succeeded);for(var S of y)yield Object(i.put)(S);var f=p.filter(e=>e.payload.jobStatus===o.AsyncOperationStatus.Succeeded),h=f.filter(e=>e.payload.operationType==m.AsyncSolutionOperationType.SolutionImport);for(var v of(yield function*(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3e4;if(e.length>0){var n=Object(l.getSolutionListFilter)();yield Object(i.put)(Object(O.fetchSolutionsRequest)({forceRefresh:!0,solutionTypeFilterOption:n}));for(var o=Object(r.createTimer)(),s=P.SagaContextProps.getCurrentEnvironment(),c=function*(){var n=yield Object(i.select)(C.solutionsSelector,s&&s.id);return e.every(e=>n.findIndex(t=>t.friendlyname===e.payload.solutionDisplayName)>-1)||o()>t?"break":void(yield Object(a.wait)(250))};;){var p=yield*c();if("break"===p)break}}}(h),f))yield Object(i.put)(v);e.payload.pollOptions&&(yield Object(i.spawn)(u.setupPolling,e))}function ae(e,t,n){return new Promise((r,a)=>{if(Object(m.isSolutionAsyncJobInEndState)(t.status))r(null);else{try{n.executeAction("AsyncOperation","GetAsyncOperation",void 0,{AsyncOperationId:t.AsyncOperationId}).then(o=>{if(o){if(Object(m.isSolutionAsyncJobInEndState)(o.statuscode)){if(Object(m.removeAsyncSolutionJobFromStorage)(e,t.AsyncOperationId),Object(m.isAsyncExportSolutionJob)(t))try{n.executeAction("ExportSolution","DownloadSolutionExportData",void 0,{ExportJobId:t.ExportJobId}).then(e=>{var n=Object(p.getExportFileName)(t.solutionDetails),o=atob(e.ExportSolutionFile),r=Object(v.createBlobFromData)(o,"application/zip");Object(v.triggerFileDownloadFromBlob)(r,n)})}catch(a){Object(i.put)(Object(O.exportSolutionError)({message:Object(S.formatResourceString)(Object(y.getResources)().Model.Solutions.SolutionExportProgress.downloadFailureMessage,a.message)}))}}else Object(m.updateAsyncSolutionJobIntoStorage)(e,t.AsyncOperationId,o.statuscode,o.friendlymessage,o.errorcode);r(Object(O.solutionAsyncUpdateProgress)({solutionDisplayName:t.solutionDisplayName,asyncOperationId:t.AsyncOperationId,jobStatus:o.statuscode,message:o.friendlymessage,errorCode:o.errorcode,operationType:Object(m.isAsyncImportSolutionJob)(t)?m.AsyncSolutionOperationType.SolutionImport:m.AsyncSolutionOperationType.SolutionExport}))}else r(null)},n=>{Object(m.isAsyncImportSolutionJob)(t)&&(Object(m.removeAsyncSolutionJobFromStorage)(e,t.AsyncOperationId),r(Object(O.solutionAsyncUpdateProgress)({solutionDisplayName:t.solutionDisplayName,asyncOperationId:t.AsyncOperationId,jobStatus:o.AsyncOperationStatus.Failed,message:n.message,errorCode:n.code,operationType:m.AsyncSolutionOperationType.SolutionImport})))})}catch(s){r(null)}}})}function*ie(e){var t=yield g.MetadataClientInstance.getInstance();try{var n=e.payload.solutionDisplayName+"_import.xml";t.executeAction("ImportSolution","GetImportLog",void 0,{ImportJobId:e.payload.importJobId}).then(e=>{Object(v.triggerFileDownloadFromText)(e.FormattedResults,n)}).catch(t=>{Object(v.triggerFileDownloadFromText)("<xml>".concat(e.payload.errorMessage,"</xml>"),n)})}catch(o){}}function*se(e){var t=P.SagaContextProps.getCurrentEnvironment(),n=yield Object(m.getAsyncSolutionJobsFromStorage)(t.id);yield Object(i.put)(Object(O.fetchAsyncSolutionJobsFromLocalStorageFulfilled)({asyncSolutionJobs:n,environmentId:t.id}))}t.default=function*(){yield Object(i.takeEvery)(O.SolutionsActionTypes.FETCH_SOLUTIONS_REQUEST,M),yield Object(i.takeEvery)(O.SolutionsActionTypes.FETCH_ASYNC_SOLUTION_JOBS_FROM_LOCAL_STORAGE,se),yield Object(i.takeEvery)(O.SolutionsActionTypes.FETCH_PUBLISHERS_REQUEST,x),yield Object(i.takeEvery)(O.SolutionsActionTypes.UPDATE_SOLUTION,_),yield Object(i.takeEvery)(O.SolutionsActionTypes.FETCH_CONFIGURATION_PAGES_REQUEST,k),yield Object(i.takeEvery)(O.SolutionsActionTypes.CREATE_SOLUTION,F),yield Object(i.takeEvery)(O.SolutionsActionTypes.PUBLISH_ALL_CUSTOMIZATIONS,G),yield Object(i.takeEvery)(O.SolutionsActionTypes.PUBLISH_TO_SOURCE_CONTROL,W),yield Object(i.takeEvery)(O.SolutionsActionTypes.REFRESH_FROM_SOURCE_CONTROL,q),yield Object(i.takeEvery)(O.SolutionsActionTypes.EXPORT_SOLUTION,Y),yield Object(i.takeLatest)(O.SolutionsActionTypes.SOLUTION_CHECKER_FETCH_STATUS,Q),yield Object(i.takeLatest)(O.SolutionsActionTypes.SOLUTION_CHECKER_FETCH_ISSUE_SUMMARY,K),yield Object(i.takeEvery)(O.SolutionsActionTypes.SOLUTION_CHECKER_RUN,U),yield Object(i.takeEvery)(O.SolutionsActionTypes.SOLUTION_CHECKER_DOWNLOAD,V),yield Object(i.takeEvery)(O.SolutionsActionTypes.SOLUTION_CHECKER_CANCEL,B),yield Object(i.takeEvery)(O.SolutionsActionTypes.SOLUTION_CHECKER_INSTALL_PROVISION_REQUEST,H),yield Object(i.takeEvery)(O.SolutionsActionTypes.DELETE_SOLUTION,J),yield Object(i.takeEvery)(O.SolutionsActionTypes.SOLUTION_CLONE_REQUEST,X),yield Object(i.takeEvery)(O.SolutionsActionTypes.UPGRADE_SOLUTION,z),yield Object(i.takeEvery)(O.SolutionsActionTypes.EXPORT_TRANSLATIONS_SOLUTION,Z),yield Object(i.takeEvery)(O.SolutionsActionTypes.IMPORT_TRANSLATIONS_REQUEST,$),yield Object(i.takeLatest)(O.SolutionsActionTypes.FETCH_SOLUTION_ACTIONS_REQUEST,ee),yield Object(i.takeLatest)(O.SolutionsActionTypes.FETCH_USER_PRIVILEGES_REQUEST,te),yield Object(i.takeEvery)(O.SolutionsActionTypes.FETCH_SOLUTION_BY_ID_REQUEST,ne),yield Object(i.takeEvery)(O.SolutionsActionTypes.SOLUTION_CHECKER_FETCH_STATUS_BY_ID_REQUEST,oe),yield Object(i.takeEvery)(O.SolutionsActionTypes.SOLUTION_ASYNC_OPERATION_POLL_PROGRESS,re),yield Object(i.takeEvery)(O.SolutionsActionTypes.SOLUTION_IMPORT_DOWNLOAD_LOG_FILE,ie)}},5756:function(e,t,n){"use strict";function o(){var e=Date.now();return()=>Date.now()-e}n.r(t),n.d(t,"createTimer",(function(){return o}))},5757:function(e,t,n){"use strict";function o(e){return new Promise(t=>{setTimeout(t,e)})}n.r(t),n.d(t,"wait",(function(){return o}))},5758:function(e,t,n){"use strict";n.r(t),n.d(t,"setupPolling",(function(){return c}));var o=n(2812),r=n(5749),a=n(5759),i={};function*s(e){for(;;)e.payload.pollOptions.waitForActionTypes&&(yield Object(r.take)(e.payload.pollOptions.waitForActionTypes)),yield Object(r.delay)(i[e.type].payload.pollOptions.pollTime),yield l(),yield Object(r.put)(i[e.type])}function*l(){for(;"hidden"===document.visibilityState;)yield Object(r.delay)(2e3)}function*c(e){if(!(e&&e.type&&e.payload&&e.payload.pollOptions&&e.payload.pollOptions.shouldPoll))return null;var t=Object(o.cloneDeep)(e),n=void 0===i[t.type];t.payload.pollOptions.shouldPoll=!1,t.payload.forceRefresh=!0,t.payload.pollOptions.pollTime=t.payload.pollOptions.pollTime||a.DefaultPollTimeInMs,i[t.type]=t,n&&(yield Object(r.race)({task:Object(r.call)(s,t),cancel:Object(r.take)(t.payload.pollOptions.pollStopAction.type)}),delete i[t.type])}},5759:function(e,t,n){"use strict";n.r(t),n.d(t,"DefaultPollTimeInMs",(function(){return o}));var o=6e4},5760:function(e,t,n){"use strict";n.r(t),n.d(t,"createFetchConfig",(function(){return f})),n.d(t,"requestSaga",(function(){return h})),n.d(t,"renewToken",(function(){return C}));var o=n(5749),r=n(2870),a=n(5606),i=n(5468),s=n(5474),l=n(5761),c=n(5762),p=n(5763),u=n(5765),d=n(5470),m=n(5758),b=n(2872);function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){S(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function S(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function f(e,t){var{url:n,data:o="",headers:r={},method:a="GET",responseType:i="text"}=e;t&&(r.authorization="Bearer ".concat(t));var s={method:a,headers:r};return n&&n.indexOf(c.Constants.refreshAccessTokenUri)>-1&&(s.credentials="same-origin"),o&&(/post/i.test(a)||/put/i.test(a)||/patch/i.test(a))&&(s.body=o),{url:n,payload:s}}function*h(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0,i=e&&e.payload||{},s=y({responseType:"json",method:"GET"},t);return i.pollOptions&&(yield Object(o.spawn)(m.setupPolling,e)),i.forceRefresh||d.CachedStatusType.Done!==n?yield Object(o.call)(O,e,s,r,a):null}function*O(e,t,n,s){var c=e&&e.payload||{},{url:u}=t,d=null,m=!1,g=null,y=b.settings;n=n||r.HostSettings.isLoggingDisabled(),c.authOptions?(m=c.authOptions.shouldAddAuthHeader,g=c.authOptions.endpointUrl||Object(l.getResourceForEndpoint)(u,y)):(m=Object(l.shouldAddAuthHeaderToEndpoint)(u,y),g=Object(l.getResourceForEndpoint)(u,y));var S=a.SagaContextProps.getCurrentEnvironment();if(t.url=Object(l.addEndpointAndVersion)(u,y,S,s),m&&(!(d=yield Object(o.select)(i.sharedSelectors.resourceTokenSelector,g))||Object(p.isTokenExpired)(d))){var f=yield Object(o.call)(C,g);return f&&f.data?yield Object(o.call)(n?E:P,t,f.data):{error:f&&f.error}}return yield Object(o.call)(n?E:P,t,d)}function*C(e){return r.HostSettings.shouldUseHostToken()?yield Object(o.call)(T,e):yield Object(o.call)(j,e)}function*v(e,t,n){var{url:a,data:i="",headers:s={},method:l="GET",responseType:c="text"}=e;e={url:a,data:i,headers:s,method:l,responseType:c};var p=r.HostSettings.getHttpClient();return t&&(e.headers.authorization="Bearer ".concat(t)),e.page=!0,yield Object(o.call)(p.request,e)}function*P(e,t){var n=Object(u.addRequestLoggingData)(f(e,t)),r=Object(u.clientHttpOutgoingRequestStart)(n);r&&(yield Object(o.put)(Object(s.logEventRequest)({event:r})));try{var a=yield v(e,t);a.config=n;var i=a.error?Object(u.clientHttpOutgoingRequestError)(a):Object(u.clientHttpOutgoingRequestEnd)(a);return i&&(yield Object(o.put)(Object(s.logEventRequest)({event:i}))),a}catch(c){c.config=n;var l=Object(u.clientHttpOutgoingRequestError)(c);return l&&(yield Object(o.put)(Object(s.logEventRequest)({event:l}))),c}}function*E(e,t){var n=f(e,t);try{var o=yield v(e,t);return o.config=n,o}catch(r){return r.config=n,r}}function*T(e){if(!r.HostSettings.shouldUseHostToken()){throw console.error("Renewing tokens through the host only - do not use for any other scenarios"),Error("Acquire token should be set in the host in order to be used here - otherwise obtain the token through regular means")}try{var t=yield r.HostSettings.getHostToken(e),n=t&&t.accessToken;return yield Object(o.put)(Object(s.resourceTokenUpdated)({resource:e,token:n})),{data:n}}catch(a){throw Error("Error trying to get the token through the host with error="+a)}}function*j(e){var t=r.HostSettings.getAntiForgeryHeader(),n=t?t.name:"",a=t?t.value:"",i={};i[n]=a,i["Content-Type"]="application/json";for(var l="".concat(c.Constants.refreshAccessTokenUri,"?audience=").concat(encodeURIComponent(e)),p=3;p>0;){var u=yield Object(o.call)(P,{url:l,headers:i,method:"POST"});if(u&&u.data){var d=JSON.parse(u.data);return yield Object(o.put)(Object(s.resourceTokenUpdated)({resource:e,token:d.accessToken})),{data:d.accessToken}}if(0===p)return u;p--}}t.default=h},5762:function(e,t,n){"use strict";n.r(t),n.d(t,"Constants",(function(){return o}));var o={signInUri:"/Authentication/SignIn",signOutUri:"/Authentication/SignOut",refreshTokenUri:"/Authentication/RefreshToken",refreshAccessTokenUri:"/Authentication/RefreshAccessToken",refreshSessionUri:"/Refresh",redirect:{idToken:"id_token",refreshToken:"refresh_token",error:"error_description",user:"user_hash",tenantDisplayName:"tenant_display_name",loggedIn:"logged_in"},cookies:{idToken:"PowerAppsIdTokenCookie",refreshToken:"PowerAppsRefreshTokenCookie"},jwtToken:{audience:"aud",name:"name",upn:"upn",email:"email",expiry:"exp",tenantId:"tid",objectId:"oid",puid:"puid"},cacheKeys:{startPage:"POWERAPPS.AUTHSTARTPAGE",savedSearch:"POWERAPPS.SAVEDSEARCH",idToken:"POWERAPPS.IDTOKEN",refreshToken:"POWERAPPS.REFRESHTOKEN",loginError:"POWERAPPS.LOGINERROR",sessionId:"POWERAPPS.SESSIONID",userHash:"POWERAPPS.USERHASH",hasPlan:"POWERAPPS.HASPLAN",userObjectId:"POWERAPPS.USEROBJECTID",isTenantWhitelisted:"POWERAPPS.TENANTWHITELISTED",whitelistedFeatures:"POWERAPPS.WHITELISTEDFEATURES",bapWhitelistedFeatures:"POWERAPPS.BAPWHITELISTEDFEATURES",tenantPermissions:"POWERAPPS.TENANTPERMISSIONS",tenantCountryCode:"POWERAPPS.TENANTCOUNTRYCODE",enrollmentOptions:"POWERAPPS.ENROLLMENTOPTIONS",isGccTenant:"POWERAPPS.GCCTENANT",enrollment:"POWERAPPS.ENROLLMENT"},logEventType:{info:"AuthInfo",warn:"AuthWarning",error:"AuthError"},logEventName:{idRefresh:"ID Refresh",tokenRefresh:"Token Refresh",login:"Login",logout:"Logout",cache:"Cache",enrollment:"Enrollment",redirectToUnknownTenant:"RedirectedToUnknownTenant",redirectToMarketingSite:"RedirectedToMarketingSite",SuccessfulLogin:"SuccessfulLogin",CallingLoginController:"CallingLoginController",EnvironmentsFailed:"EnvironmentsFailed"},tenantPermissions:{SetDLPPolicy:"SetDLPPolicy",ManageServicePlans:"ManageServicePlans"}}},5763:function(e,t,n){"use strict";n.r(t),n.d(t,"isTokenExpired",(function(){return a}));var o=n(5764),r=n(5762);function a(e,t){t=t||120;var n=parseInt(Object(o.getTokenClaim)(e,r.Constants.jwtToken.expiry),10);return!(n&&n>Math.round((new Date).getTime()/1e3)-t)}},5764:function(e,t,n){"use strict";function o(e){var t=function(e){var t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);if(!t||t.length<4)throw new Error("The returned token is not parseable");return{header:t[1],jwsPayload:t[2],jwsSig:t[3]}}(e);if(!t)return null;var n=function(e){if(e=function(e){e.length%4==2?e+="==":e.length%4==3&&(e+="=");return e=(e=e.replace(/-/g,"+")).replace(/_/g,"/")}(e),window.atob)return decodeURIComponent(window.escape(window.atob(e)));return null}(t.jwsPayload);return n?JSON.parse(n):null}function r(e,t){return o(e)[t]}n.r(t),n.d(t,"extractJwtTokenPayload",(function(){return o})),n.d(t,"getTokenClaim",(function(){return r}))},5765:function(e,t,n){"use strict";n.r(t),n.d(t,"HeaderKeys",(function(){return r})),n.d(t,"RequestStateKeys",(function(){return a})),n.d(t,"isContentUrl",(function(){return i})),n.d(t,"parseResponseHeaders",(function(){return s})),n.d(t,"isClientTraceUrl",(function(){return l})),n.d(t,"sanitizeUrl",(function(){return c})),n.d(t,"getOriginalUrlIfInvokeApi",(function(){return p})),n.d(t,"addRequestLoggingData",(function(){return u})),n.d(t,"clientHttpOutgoingRequestStart",(function(){return d})),n.d(t,"clientHttpOutgoingRequestEnd",(function(){return m})),n.d(t,"clientHttpOutgoingRequestError",(function(){return b}));var o=n(222);class r{}r.clientRequestId="x-ms-client-request-id",r.sessionId="x-ms-client-session-id",r.correlationId="x-ms-correlation-request-id",r.serviceRequestId="x-ms-request-id",r.routingRequestId="x-ms-routing-request-id";class a{}function i(e){return!!e&&new RegExp("((^/app/)|(^/content/)).+","i").test(e)}function s(e){return{correlationId:e&&e.headers&&e.headers[r.correlationId]||"",serviceRequestId:e&&e.headers&&e.headers[r.serviceRequestId]||"",routingRequestId:e&&e.headers&&e.headers[r.routingRequestId]||""}}function l(e){return(e||"").toLowerCase().includes("/logging/LogTrace")}function c(e){return(e||"").toLowerCase().includes("refreshtoken")&&(e=e.split("?")[0]),e}function p(e,t){return e.endsWith("/api/invoke")?e.substr(0,e.length-"/api/invoke".length)+(t&&t.headers&&t.headers["x-ms-path-query"]||""):e}function u(e){if(e.url&&e.payload){var t=Object(o.v4)();e.payload[a.clientRequestId]=t,e.payload[a.clientRequestStart]=new Date,e.payload.headers=e.payload.headers||{},e.payload.headers[r.clientRequestId]=t}return e}function d(e){if(e&&e.url&&e.payload){var t=c(p(e.url,e.payload));if(!l(t)&&!i(t))return{name:"ClientHttpOutgoingRequestStart",data:{httpMethod:e.payload.method,url:e.url,clientRequestId:e.payload[a.clientRequestId]}}}return null}function m(e){if(e&&e.config&&e.config.url&&e.config.payload){var t=e.config.payload,n=t[a.clientRequestId],o=t[a.clientRequestStart],r=c(p(e.config.url)),u=o instanceof Date?Date.now()-o.getTime():-1,d=s(e);if(!l(r)&&!i(r))return{name:"ClientHttpOutgoingRequestEnd",data:{httpMethod:(t.method||"").toUpperCase(),url:r,durationInMilliseconds:u,responseStatusCode:e.status,responseBodyOnError:null,clientRequestId:n,correlationId:d.correlationId,serviceRequestId:d.serviceRequestId,routingRequestId:d.routingRequestId}}}return null}function b(e){if(e&&e.config&&e.config.url&&e.config.payload){var t=e.config.payload,n=t[a.clientRequestId],o=t[a.clientRequestStart],r=c(p(e.config.url)),u=o instanceof Date?Date.now()-o.getTime():-1,d=s(e);if(!l(r)){var m=(t.method||"").toUpperCase();return i(r)?{name:"ClientHttpOutgoingRequest",data:{httpMethod:m,url:r,durationInMilliseconds:u,responseStatusCode:e.status,responseBodyOnError:null,clientRequestId:n,correlationId:d.correlationId,serviceRequestId:d.serviceRequestId,routingRequestId:d.routingRequestId}}:{name:"ClientHttpOutgoingRequestEnd",data:{httpMethod:m,url:r,durationInMilliseconds:u,responseStatusCode:e.status,responseBodyOnError:null,clientRequestId:n,correlationId:d.correlationId,serviceRequestId:d.serviceRequestId,routingRequestId:d.routingRequestId}}}}return null}a.clientRequestId="clientRequestId",a.clientRequestStart="clientRequestStart"},5766:function(e,t,n){"use strict";var o;n.r(t),n.d(t,"SolutionComponentApiCalls",(function(){return o})),function(e){e[e.RibbonCustomization=0]="RibbonCustomization",e[e.PublishComponents=1]="PublishComponents",e[e.Activate=2]="Activate",e[e.Deactivate=3]="Deactivate",e[e.AddRequiredComponents=4]="AddRequiredComponents",e[e.FetchManagedProperties=5]="FetchManagedProperties",e[e.UpdateManagedProperties=6]="UpdateManagedProperties",e[e.ObjectCheckerRun=7]="ObjectCheckerRun",e[e.PublishToSourceControl=8]="PublishToSourceControl",e[e.RefreshFromSourceControl=9]="RefreshFromSourceControl"}(o||(o={}))},5767:function(e,t,n){"use strict";var o;function r(e){return{type:o.API_CALL_LOADING,payload:e}}function a(e){return{type:o.API_CALL_FINISHED,payload:e}}function i(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return{type:o.API_CALL_CLEAR,payload:{apiCalls:t}}}n.r(t),n.d(t,"ApiCallActionTypes",(function(){return o})),n.d(t,"apiCallLoading",(function(){return r})),n.d(t,"apiCallFinished",(function(){return a})),n.d(t,"apiCallClear",(function(){return i})),function(e){e.API_CALL_LOADING="maker/model/apiCall/API_CALL_FULFILLED",e.API_CALL_FINISHED="maker/model/apiCall/API_CALL_FINISHED",e.API_CALL_CLEAR="maker/model/apiCall/API_CALL_CLEAR"}(o||(o={}))},5770:function(e,t,n){"use strict";n.r(t),n.d(t,"SolutionsActionsMiddleware",(function(){return E}));var o=n(5604),r=n(5605),a=n(1086),i=n(5690),s=n(2886),l=n(5481),c=n(5478),p=n(5606),u=n(5687),d=n(5474),m=n(2871),b=n(2880),g=n(2869),y=n(5623),S=n(5630),f=n(2872),h=n(5468),O=n(5746);function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(Object(n),!0).forEach((function(t){P(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function P(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function E(){return e=>t=>n=>{var{dispatch:C}=e,P=p.SagaContextProps.getCurrentEnvironment(),E=o.getCrmInstanceUrl(P),T=Object(g.getResources)();if(!E)return t(n);var j=n,A="";switch(j.type){case i.SolutionsActionTypes.CREATE_SOLUTION_LEGACY:A=r.getCreateSolutionUrl(E),C(h.sharedActions.openNewTab({uri:A}));break;case i.SolutionsActionTypes.IMPORT_SOLUTION:if(m.featureGates.enableNewSolutionImport){C(h.sharedActions.panelOpen({panelType:c.PanelToShowType.SolutionImportPanel,panelProps:{environmentId:P&&P.id}}));break}A=r.getImportSolutionUrl(E),C(h.sharedActions.openNewTab({uri:A,features:{width:550,height:350}}));break;case i.SolutionsActionTypes.OPEN_SOLUTION_MARKETPLACE:C(h.sharedActions.openNewTab({uri:l.default.appSourceLink}));break;case i.SolutionsActionTypes.OPEN_SOLUTION_CLASSIC_MODE:A=r.getCrmAllSolutionsUrl(E),C(h.sharedActions.panelOpen({panelType:c.PanelToShowType.FeedbackPanel,panelProps:{exitUrl:A}}));break;case i.SolutionsActionTypes.OPEN_LEGACY_SOLUTION_EXPLORER:A=r.getSolutionExplorerUrl(E),C(h.sharedActions.panelOpen({panelType:c.PanelToShowType.FeedbackPanel,panelProps:{exitUrl:A}}));break;case i.SolutionsActionTypes.SHOW_SOLUTION_DEPENDENCIES:A=a.getShowSolutionDependenciesUrl(E,j.payload.solutionId),C(h.sharedActions.openNewTab({uri:A,features:{width:1e3,height:600}}));break;case i.SolutionsActionTypes.SOLUTION_CLONE:C(h.sharedActions.panelOpen({panelType:c.PanelToShowType.SolutionClonePanel,panelProps:{solutionId:j.payload.solutionId,cloneType:j.payload.cloneType}}));break;case i.SolutionsActionTypes.IMPORT_TRANSLATIONS_SOLUTION:C(h.sharedActions.panelOpen({panelType:c.PanelToShowType.ImportTranslationPanel,panelProps:{solutionId:j.payload.solutionId}}));break;case i.SolutionsActionTypes.SOLUTION_CHECKER_RUN_SUCCEEDED:case i.SolutionsActionTypes.SOLUTION_CHECKER_RUN_FAILED:case i.SolutionsActionTypes.SOLUTION_CHECKER_CANCEL_SUCCEEDED:case i.SolutionsActionTypes.SOLUTION_CHECKER_CANCEL_FAILED:C(O.solutionsActions.solutionCheckerFetchStatus(n));break;case i.SolutionsActionTypes.SOLUTION_CHECKER_DOWNLOAD_URL:C(h.sharedActions.openNewTab({uri:j.payload.url,windowName:"_self"}));break;case i.SolutionsActionTypes.OPEN_DELETE_DIALOG:var R=j.payload.solution,I=Object(s.isSolutionManaged)(j.payload.solution);C(h.sharedActions.openConfirmDialog({hidden:!1,title:T.Model.Solutions.Delete.Dialog.title,subText:I?T.Model.Solutions.Delete.Dialog.subtext:T.Model.Solutions.Delete.Dialog.Unmanaged.subtext,cancelButtonText:T.Model.Solutions.Delete.Dialog.cancel,confirmButtonText:T.Model.Solutions.Delete.Dialog.confirmation,onConfirm:()=>{C(Object(S.logAction)(Object(i.deleteSolution)({solution:R}),u.SolutionCommandEvents.Delete.eventName))},isDestructive:!0}));break;case i.SolutionsActionTypes.OPEN_WAITING_FOR_NEW_PUBLISHER_DIALOG:C(h.sharedActions.openConfirmDialog({hidden:!1,title:T.Model.Solutions.Settings.createPublisherInProgressTitle,subText:T.Model.Solutions.Settings.createPublisherInProgressText,confirmButtonText:T.Model.Solutions.Settings.done,onConfirm:()=>{C(Object(i.fetchPublishersRequest)()),C(Object(d.closeConfirmDialog)())},hideCancelButton:!0}));break;case i.SolutionsActionTypes.OPEN_WAITING_FOR_EDIT_PUBLISHER_DIALOG:C(h.sharedActions.openConfirmDialog({hidden:!1,title:T.Model.Solutions.Settings.editPublisherInProgressTitle,subText:T.Model.Solutions.Settings.editPublisherInProgressText,confirmButtonText:T.Model.Solutions.Settings.done,onConfirm:()=>{C(Object(i.fetchPublishersRequest)()),C(Object(d.closeConfirmDialog)())},hideCancelButton:!0}));break;case i.SolutionsActionTypes.OPEN_NEW_PANEL:C(h.sharedActions.panelOpen({panelType:c.PanelToShowType.SolutionNewPanel,stayMountedWhenHidden:!0}));break;case i.SolutionsActionTypes.OPEN_EDIT_PANEL:C(h.sharedActions.panelOpen({panelType:c.PanelToShowType.SolutionEditPanel,panelProps:v({},j.payload),stayMountedWhenHidden:!0}));break;case i.SolutionsActionTypes.OPEN_PUBLISHER_PANEL:C(h.sharedActions.panelOpen({panelType:c.PanelToShowType.PublisherNewEditPanel,panelProps:v({},j.payload)}));break;case i.SolutionsActionTypes.SOLUTION_CHECKER_INSTALL_PROVISION_SUCCEEDED:A=f.settings.solutionCheckerInstallEndpoint,C(Object(S.logAction)(h.sharedActions.openNewTab({uri:A}),u.SolutionCommandEvents.solutionCheckerInstallOpenDialog.eventName)),C(h.sharedActions.openConfirmDialog({hidden:!1,onConfirm:()=>{C(Object(S.logAction)(O.solutionsActions.fetchSolutionsRequest({forceRefresh:!0}),u.SolutionCommandEvents.solutionCheckerCloseRefreshSolutionListDialog.eventName)),C(Object(d.closeConfirmDialog)())},confirmButtonText:T.Model.Solutions.SolutionChecker.InstallDialog.done,title:T.Model.Solutions.SolutionChecker.InstallDialog.title,subText:T.Model.Solutions.SolutionChecker.InstallDialog.subtext,hideCancelButton:!0,isDestructive:!1}));break;case i.SolutionsActionTypes.OPEN_SOLUTION_CHECKER_VIEW_RESULTS_LIST:var w=j.payload.solution.solutionCheckerResults&&j.payload.solution.solutionCheckerResults.lastRun.createdon?new Date(j.payload.solution.solutionCheckerResults.lastRun.createdon):null;A=Object(y.getSolutionCheckerResultsListUrl)(j.payload.solution.id,w),j.payload.navigate(A,!0);break;case i.SolutionsActionTypes.OPEN_LEGACY_SOLUTION_PUBLISHER:A=a.getSolutionPublisherUrl(E,j.payload.publisherId,j.payload.solutionId),C(h.sharedActions.openNewTab({uri:A}));break;case i.SolutionsActionTypes.SOLUTION_EXPORT_PANEL_CLOSED:C(h.sharedActions.panelClose({panelType:c.PanelToShowType.SolutionExportPanel}));break;case i.SolutionsActionTypes.CREATE_NEW_PUBLISHER:A=a.getCreateNewPublisherUrl(E),C(h.sharedActions.openNewTab({uri:A,features:{width:1e3,height:600}}));break;case i.SolutionsActionTypes.EXPORT_SOLUTION_REQUEST:C(O.solutionsActions.solutionExportPanelPreparing({message:Object(b.formatResourceString)(Object(g.getResources)().Model.Solutions.ExportPanel.exportInProgress,Object(s.getSolutionDisplayName)(n.payload.solution))})),Object(s.isSolutionDefault)(j.payload.solution)?C(O.solutionsActions.exportSolution({solution:j.payload.solution,asManaged:j.payload.asManaged,version:j.payload.version})):C(O.solutionsActions.updateSolution({solution:j.payload.solution,version:j.payload.version,exportSolution:{asManaged:j.payload.asManaged}}));break;case i.SolutionsActionTypes.CREATE_APP_TEMPLATE_FOR_TEAMS:C(h.sharedActions.panelOpen({panelType:c.PanelToShowType.PublishTeamsApp,panelProps:v({},j.payload)}));break;case i.SolutionsActionTypes.OPEN_SOLUTION_CHECKER_VIEW_RESULTS_DIALOG:var D=j.payload.solution,N=j.payload.navigate;C(h.sharedActions.openConfirmDialog({hidden:!1,title:T.Model.Solutions.Export.BeforeExport.Dialog.title,subText:T.Model.Solutions.Export.BeforeExport.Dialog.subText,cancelButtonText:T.Model.Solutions.Export.BeforeExport.Dialog.cancel,confirmButtonText:T.Model.Solutions.Export.BeforeExport.Dialog.confirmation,onConfirm:()=>{C(Object(d.closeConfirmDialog)()),C(Object(S.logAction)(O.solutionsActions.openSolutionCheckerViewResultsList({solution:D,navigate:N}),u.SolutionCommandEvents.SolutionCheckViewResults.eventName))},isDestructive:!0}))}return t(n)}}},5773:function(e,t,n){"use strict";n.r(t),n.d(t,"mapStateToProps",(function(){return T})),n.d(t,"mapDispatchToProps",(function(){return j})),n.d(t,"mergeProps",(function(){return A})),n.d(t,"SolutionEditPanelContainer",(function(){return R}));var o=n(5687),r=n(5629),a=n(5774),i=n(5487),s=n(5690),l=n(5691),c=n(5781),p=n(2886),u=n(5746),d=n(5669),m=n(5478),b=n(5437),g=n(5582),y=n(5630),S=n(5468),f=n(2699),h=["selectedSolution"],O=["onSaveClick"];function C(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function P(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach((function(t){E(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function E(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var T=(e,t)=>{var n=Object(g.currentEnvironmentIdSelector)(t),a=u.solutionsSelectors.solutionSelector(e,t.solutionId),i=Object(p.getSolutionPublisher)(a),s=Object(p.getSolutionPublisherId)(a),m=u.solutionsSelectors.publishersSelector(e,n)||c.emptyList,b=Object(c.makePublisherOptions)(m,s),y=u.solutionsSelectors.configurationPagesSelector(e,n).map(e=>({key:e.webResource.webresourceid,text:e.webResource.displayname})),S=Object(p.isSolutionManaged)(a)?{success:!0,failed:!1}:u.solutionsSelectors.publishersStatusSelector(e,n),f=u.solutionsSelectors.configurationPagesStatusSelector(e,n);return{displayName:Object(p.getSolutionDisplayName)(a),name:Object(p.getSolutionName)(a),publisher:{publisherId:null==i?void 0:i.publisherid},configurationPageOptions:y,version:Object(p.getSolutionVersion)(a),installedOn:Object(p.getSolutionInstalledDate)(a),configurationPage:Object(p.getSolutionConfigurationPageId)(a),description:Object(p.getSolutionDescription)(a),logEvent:o.SolutionEditPanelLoadEvents,loadProgress:[Object(r.toLoadingState)(S&&S.success&&f&&f.success,S&&S.failed&&f&&f.failed&&d.CommonErrors.UnspecifiedError)],publisherOptions:b,createSolutionResponse:Object(l.createSolutionStatus)(e),updateSolutionResponse:Object(l.updateSolutionStatus)(e),selectedSolution:a,isManaged:Object(p.isSolutionManaged)(a)}},j=(e,t)=>{var n=t=>{e(S.sharedActions.panelClose({panelType:m.PanelToShowType.PublisherNewEditPanel})),t&&e(u.solutionsActions.fetchPublishersRequest())};return{onPanelClose:()=>{e(S.sharedActions.panelClose({panelType:m.PanelToShowType.SolutionEditPanel})),e(u.solutionsActions.updateSolutionClear())},onMount:()=>{e(u.solutionsActions.fetchPublishersRequest()),e(u.solutionsActions.fetchConfigurationPagesRequest())},onConstruct:()=>{e(u.solutionsActions.updateSolutionClear())},onSaveClick:t=>n=>{e(u.solutionsActions.updateSolution(P({solution:t},n)))},openLegacySolutionPublisherDetailUI:n=>{e(Object(s.openLegacySolutionPublisherDetail)({publisherId:n,solutionId:t.solutionId}))},dispatchTelemetry:e,onCreateNewPublisher:()=>{f.featureGates.enablePublisherPanel?e(Object(y.logAction)(u.solutionsActions.openPublisherPanel({isCreateMode:!0,onPanelDismiss:n}),o.NewPublisherPanelLoadEvents.eventName)):(e(Object(s.openWaitingForNewPublisherDialog)()),e(Object(s.createNewPublisher)()))},onEditPublisher:t=>{f.featureGates.enablePublisherPanel?e(Object(y.logAction)(u.solutionsActions.openPublisherPanel({isCreateMode:!1,onPanelDismiss:n,publisherId:t}),o.EditPublisherPanelLoadEvents.eventName)):e(Object(s.openWaitingForEditPublisherDialog)())},onDismount:()=>e(Object(s.fetchPublishersCancelPoll)())}},A=(e,t,n)=>{var{selectedSolution:o}=e,r=C(e,h),{onSaveClick:a}=t,i=C(t,O);return P(P(P({},r),i),{},{defaultPanelProps:n.defaultPanelProps,isEditMode:!0,onSaveClick:a(o),isSolutionParentWithPatches:Object(p.isSolutionAParentWithPatches)(o)})},R=Object(i.withRootProps)(Object(b.connect)(T,j,A)(a.SolutionNewEditPanel))},5781:function(e,t,n){"use strict";n.r(t),n.d(t,"emptyList",(function(){return i})),n.d(t,"makePublisherOptions",(function(){return s}));var o=n(545),r=n(2871),a=n(5782),i=[],s=Object(o.memoizeFunction)((e,t)=>l(e,t).map(e=>({key:e.publisher.publisherid,text:"".concat(e.publisher.friendlyname," (").concat(e.publisher.uniquename,")")}))),l=(e,t)=>e.filter(e=>!(!t||e.id!==t)||e.id!==a.microsoftPublisherId&&(!(!r.featureGates.showFirstPartyPublisher&&e.id===a.firstPartyPublisherId)&&!e.publisher.isreadonly))},5785:function(e,t,n){"use strict";n.r(t),n.d(t,"mapStateToProps",(function(){return f})),n.d(t,"mapDispatchToProps",(function(){return h})),n.d(t,"mergeProps",(function(){return O})),n.d(t,"AddSLAPanelContainer",(function(){return C}));var o=n(5437),r=n(5687),a=n(5629),i=n(5786),s=n(5686),l=n(5468),c=n(5478),p=n(5787),u=n(5487),d=n(5582),m=["rootProps"];function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){y(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function S(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var f=(e,t)=>{var n=Object(d.currentEnvironmentIdSelector)(t),o=p.solutionComponentSelectors.solutionSLAEnabledEntitiesSelector(e,n).map(e=>({key:e.entity.ObjectTypeCode,text:e.entity.DisplayName.UserLocalizedLabel.Label})),i=p.solutionComponentSelectors.solutionSLAEnabledEntitiesStatusSelector(e,n);return{entitiesLoadingError:p.solutionComponentSelectors.solutionSLAEnabledEntitiesError(e,n),entityOptions:o,logEvent:r.AddSLAPanelLoad,loadProgress:[Object(a.toLoadingState)(i&&i.success,i&&i.failed&&"Unspecified error")]}},h=(e,t)=>({onDismiss:()=>{e(l.sharedActions.panelClose({panelType:c.PanelToShowType.AddSLAPanel}))},onMount:()=>{e(p.solutionComponentsActions.fetchSolutionSLAEnabledEntitiesRequest({solutionId:t.solution.id}))},onAddSLACreateClick:t=>{e(Object(s.addSLARequest)(t)),e(l.sharedActions.panelClose({panelType:c.PanelToShowType.AddSLAPanel}))},dispatchTelemetry:e}),O=(e,t,n)=>{var{rootProps:o}=n,r=S(n,m);return g(g(g(g({},e),t),r),{},{defaultPanelProps:n.defaultPanelProps})},C=Object(u.withRootProps)(Object(o.connect)(f,h,O)(i.AddSLAPanel))},5786:function(e,t,n){"use strict";n.r(t),n.d(t,"CreateFormKeys",(function(){return o})),n.d(t,"AddSLAPanel",(function(){return y}));var o,r=n(4013),a=n(5629),i=n(245),s=n(2869),l=n(1201),c=n(1697),p=n(5127),u=n(5148);function d(){return(d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){g(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(e){e.name="name",e.entity="entity"}(o||(o={}));class y extends i.Component{constructor(e){super(e),this.resources=void 0,this.entityField=void 0,this.defaultEntityKey="@@@ClearKey@@@",this.isFirstRender=!0,this.onDismiss=()=>{this.props.onDismiss()},this._onUpdate=(e,t)=>{e===o.entity&&t===this.defaultEntityKey?this.entityField.current.setValue(t):this.setState({formResults:b(b({},this.state.formResults),{},{[e]:t})})},this.resources=Object(s.getResources)(),this.state={formResults:{},isValidForm:{}}}componentDidMount(){this.props.onMount()}componentDidUpdate(){this.isFirstRender=!1}render(){var e,t;Object(a.isLoading)(this.props.loadProgress)&&(e={spinnerProps:{size:l.SpinnerSize.large}}),this.props.entitiesLoadingError&&(t={messageBarProps:{messageBarType:c.MessageBarType.error,dismissButtonAriaLabel:this.resources.Common.close},onRenderBody:()=>i.createElement(i.Fragment,null,this.props.entitiesLoadingError)});var n=i.createElement("div",null,i.createElement("p",null,this.resources.Model.Solutions.Components.AddSLA.Panel.subTitle),i.createElement(p.Form,{onUpdated:this._onUpdate,showErrorsWhenPristine:!0},i.createElement(p.FormTextInput,{textFieldProps:{label:this.resources.Model.Solutions.Components.AddSLA.Panel.name,required:!0},inputKey:o.name,value:this.state.formResults.name,validators:[this.valueConditionalValidator(u.maxLength(256,()=>this.resources.Model.Solutions.Components.AddSLA.Error.LessThan256),o.name),this.valueConditionalValidator(u.required(this.resources.Model.Solutions.Components.AddSLA.Error.Required),o.name)],debounceInterval:10}),i.createElement(p.FormDropdown,{inputKey:o.entity,componentRef:this.entityField,dropdownProps:{options:this.props.entityOptions,label:this.resources.Model.Solutions.Components.AddSLA.Panel.entity,required:!0,defaultSelectedKey:this.state.formResults.entity?this.state.formResults.entity:this.defaultEntityKey,role:"listbox"},validators:[this.valueConditionalValidator(u.required(this.resources.Model.Solutions.Components.AddSLA.Error.Required),o.entity)]})));return i.createElement(r.Panel,d({},this.props.defaultPanelProps,{headerText:this.resources.Model.Solutions.Components.AddSLA.Panel.title,onDismiss:this.onDismiss,closeButtonType:r.PanelCloseButtonType.Back,closeButtonAriaLabel:this.resources.Common.close,footerButtons:this.getFooterButtons(),loadingOverlay:e,messageBar:t}),n)}getFooterButtons(){return[{primary:!0,dismissableOnClick:()=>this.onCreate(),ariaLabel:this.resources.Model.Solutions.Components.AddSLA.create,text:this.resources.Model.Solutions.Components.AddSLA.create,disabled:!this.state.isValidForm.entity||!this.state.isValidForm.name},{primary:!1,ariaLabel:this.resources.Common.close,text:this.resources.Common.close,dismissableOnClick:()=>this.onDismiss()}]}onCreate(){this.props.onAddSLACreateClick({solutionId:this.props.solution.solutionid,name:this.state.formResults.name,entityId:this.state.formResults.entity})}valueConditionalValidator(e,t){return n=>{if(!this.isFirstRender){var o=e(n);return this.setState({isValidForm:b(b({},this.state.isValidForm),{},{[t]:void 0===o})}),o}}}}},5787:function(e,t,n){"use strict";n.r(t);var o=n(5686);n.d(t,"solutionComponentsActions",(function(){return o}));var r=n(5788);n.d(t,"solutionComponentsMiddlewares",(function(){return r}));var a=n(5808),i=n(5810);n.d(t,"solutionComponentSelectors",(function(){return i}));var s=n(5766);n.d(t,"solutionComponentResponses",(function(){return s})),t.default=a.reducer},5788:function(e,t,n){"use strict";n.r(t);var o=n(5789);n.d(t,"SolutionComponentsActionsMiddleware",(function(){return o.SolutionComponentsActionsMiddleware}));var r=n(5791);n.d(t,"SolutionComponentsClientRootSaga",(function(){return r.SolutionComponentsClientRootSaga}));var a=n(5792);n.d(t,"SolutionComponentsClientSaga",(function(){return a.default}));var i=n(5863);n.d(t,"PowerVaActionsMiddleware",(function(){return i.PowerVaActionsMiddleware}))},5789:function(e,t,n){"use strict";n.r(t),n.d(t,"SolutionComponentsActionsMiddleware",(function(){return F}));var o=n(2880),r=n(5604),a=n(5478),i=n(5481),s=n(2869),l=n(5623),c=n(5605),p=n(5468),u=n(5686),d=n(5630),m=n(5607),b=n(3713),g=n(5790),y=n(2886),S=n(5474),f=n(5687),h=n(2871),O=n(1101),C=n(5606),v=n(1086),P=n(5691),E=n(5609),T=n(2807),j=n(5612),A=n(5693),R=n(2815),I=n(5655),w=n(5654),D=n(1087),N=["solutionId"];function L(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function M(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?L(Object(n),!0).forEach((function(t){x(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):L(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function x(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function k(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function F(e){return t=>n=>L=>{var x,F,_,U,V,{dispatch:B}=t,H=L,G=C.SagaContextProps.getCurrentEnvironment(),W=r.getEnvironmentOrgId(G),q=r.getCrmInstanceUrl(G),z=null,Q=Object(s.getResources)();switch(H.type){case u.SolutionComponentsActionTypes.OPEN_SOLUTION_COMPONENT_CLASSIC_MODE:F=c.getSolutionExplorerUrl(q,H.payload.solutionId),B(p.sharedActions.panelOpen({panelType:a.PanelToShowType.FeedbackPanel,panelProps:{exitUrl:F}}));break;case u.SolutionComponentsActionTypes.OPEN_HOW_TO_REGISTER_PLUG_IN:B(p.sharedActions.openNewTab({uri:i.default.howToRegisterPlugin}));break;case u.SolutionComponentsActionTypes.ADD_REQUIRED_COMPONENT_DIALOG:H.payload.components&&H.payload.components.length>1?B(p.sharedActions.openAlertDialog({message:Q.Model.Solutions.Components.Commands.moreThanOneError})):B(p.sharedActions.openConfirmDialog({hidden:!1,title:Q.Model.Solutions.Components.AddRequired.Dialog.title,subText:Q.Model.Solutions.Components.AddRequired.Dialog.subtext,cancelButtonText:Q.Model.Solutions.Components.AddRequired.DialogFooter.cancel,confirmButtonText:Q.Model.Solutions.Components.AddRequired.DialogFooter.ok,onConfirm:()=>{B(Object(u.addRequiredComponentsRequest)(H.payload))}}));break;case u.SolutionComponentsActionTypes.OPEN_HOW_TO_REGISTER_STEPS:B(p.sharedActions.openNewTab({uri:i.default.howToRegisterSteps}));break;case u.SolutionComponentsActionTypes.OPEN_HOW_TO_REGISTER_ENDPOINTS:B(p.sharedActions.openNewTab({uri:i.default.howToRegisterEndpoints}));break;case u.SolutionComponentsActionTypes.OPEN_COMPONENT_MANAGE_DEPENDENCIES:var K=H.payload,{solutionId:Y}=K,J=k(K,N),X=c.getComponentManagePropertiesUrl(q,Y,Object(b.getSolutionComponentObjectId)(H.payload.component),Object(b.getSolutionComponentEntityTypeCode)(H.payload.component));h.featureGates.showNewManagedPropertiesPanel?B(p.sharedActions.panelOpen({panelType:a.PanelToShowType.ManagedProperties,panelProps:M({},J)})):B(p.sharedActions.openNewTab({uri:X,features:{width:600,height:400}}));break;case u.SolutionComponentsActionTypes.OPEN_SHOW_COMPONENT_DEPENDENCIES:var Z=v.getShowComponentDependenciesUrl(q,H.payload.solutionId,Object(b.getSolutionComponentId)(H.payload.component),Object(b.getSolutionComponentEntityTypeCode)(H.payload.component));B(p.sharedActions.openNewTab({uri:Z,features:{width:800,height:526}}));break;case u.SolutionComponentsActionTypes.OPEN_ENABLE_SECURITY_ROLES:var $=c.getEnableSecurityRolesUrl(q,H.payload.solutionId,H.payload.componentId,H.payload.componentSubType);B(p.sharedActions.openNewTab({uri:$,features:{width:800,height:550}}));break;case u.SolutionComponentsActionTypes.OPEN_ADD_EXISTING_PANEL:B(p.sharedActions.panelOpen({panelType:a.PanelToShowType.SolutionComponentAddExistingPanel,panelProps:M({},H.payload),stayMountedWhenHidden:!0}));break;case u.SolutionComponentsActionTypes.ENTITY_GET_DATA_FROM_EXCEL:H.payload.navigate(Object(l.getEntityGetDataFromExcelUrl)(W,H.payload.entityName),!0);break;case u.SolutionComponentsActionTypes.ENTITY_EXPORT_DATA:H.payload.navigate(Object(l.getEntityExportDataUrl)(W,H.payload.entityName),!0);break;case u.SolutionComponentsActionTypes.ENTITY_OPEN_IN_EXCEL:e(W,H.payload.entityName);break;case u.SolutionComponentsActionTypes.OPEN_CUSTOMCONNECTOR_DETAILS:B(p.sharedActions.openNewTab({uri:Object(R.getCustomConnectorDetailsPageUrl)(G.name,H.payload.connectorInternalId)}));break;case u.SolutionComponentsActionTypes.OPEN_CUSTOMCONNECTOR_EDIT:z=Object(m.getSolutionComponentTypeDisplayName)(H.payload.currentSelectedComponent,Object(b.isCdsLiteContext)(G));var ee=Object(m.getSolutionConnectorInternalId)(H.payload.currentSelectedComponent);B(Object(S.openConfirmDialog)({hidden:!1,title:Object(o.formatResourceString)(Q.Model.Solutions.Components.Edit.Dialog.title,z),subText:Object(o.formatResourceString)(Q.Model.Solutions.Components.Edit.Dialog.subtext,z),confirmButtonText:Q.Model.Solutions.Components.NewCommand.Dialog.closeButtonText,onConfirm:()=>{B(Object(S.closeConfirmDialog)()),B(Object(u.refreshComponentsList)())},hideCancelButton:!0})),B(p.sharedActions.openNewTab({uri:Object(l.getCustomConnectorEditPageUrl)(G.name,ee)}));break;case u.SolutionComponentsActionTypes.OPEN_FLOW_DETAILS:U={logicalName:Object(m.getSolutionComponentTypeLogicalName)(H.payload.currentSelectedComponent),typeCode:Object(m.getSolutionComponentTypeCode)(H.payload.currentSelectedComponent),extendedTypeCode:Object(m.getSolutionComponentExtendedTypeCode)(H.payload.currentSelectedComponent)},Object(E.areSameSolutionComponentType)(U,b.StandardSolutionComponentTypes.Flow)?B(p.sharedActions.openNewTab({uri:Object(l.getFlowDetailsPageUrl)(G.name,H.payload.flowName,T.FlowsDataType.FlOWS,H.payload.solutionId)})):Object(E.areSameSolutionComponentType)(U,b.StandardSolutionComponentTypes.UIFlow)&&B(p.sharedActions.openNewTab({uri:Object(l.getFlowDetailsPageUrl)(G.name,Object(b.getSolutionComponentObjectId)(H.payload.currentSelectedComponent),T.FlowsDataType.UIFLOWS,H.payload.solutionId)}));break;case u.SolutionComponentsActionTypes.OPEN_FLOW_SHARE:B(p.sharedActions.openNewTab({uri:c.getProcessShareUrl(q,H.payload.componentId,H.payload.solutionId)}));break;case u.SolutionComponentsActionTypes.OPEN_FLOW_EDIT:z=Object(m.getSolutionComponentTypeDisplayName)(H.payload.currentSelectedComponent,Object(b.isCdsLiteContext)(G));var te=Object(b.getSolutionComponentId)(H.payload.currentSelectedComponent),ne=Object(m.getSolutionComponentFlowId)(H.payload.currentSelectedComponent);B(Object(S.openConfirmDialog)({hidden:!1,title:Object(o.formatResourceString)(Q.Model.Solutions.Components.Edit.Dialog.title,z),subText:Object(o.formatResourceString)(Q.Model.Solutions.Components.Edit.Dialog.subtext,z),confirmButtonText:Q.Model.Solutions.Components.NewCommand.Dialog.closeButtonText,onConfirm:()=>{B(Object(S.closeConfirmDialog)()),B(Object(u.refreshComponentsList)())},hideCancelButton:!0})),U={logicalName:Object(m.getSolutionComponentTypeLogicalName)(H.payload.currentSelectedComponent),typeCode:Object(m.getSolutionComponentTypeCode)(H.payload.currentSelectedComponent),extendedTypeCode:Object(m.getSolutionComponentExtendedTypeCode)(H.payload.currentSelectedComponent)},Object(E.areSameSolutionComponentType)(U,b.StandardSolutionComponentTypes.Flow)?B(p.sharedActions.openNewTab({uri:Object(l.getFlowEditPageUrl)(G.name,ne,T.FlowsDataType.FlOWS,te)})):Object(E.areSameSolutionComponentType)(U,b.StandardSolutionComponentTypes.UIFlow)&&B(p.sharedActions.openNewTab({uri:Object(l.getFlowEditPageUrl)(G.name,Object(b.getSolutionComponentObjectId)(H.payload.currentSelectedComponent),T.FlowsDataType.UIFLOWS,te)}));break;case u.SolutionComponentsActionTypes.OPEN_FLOW_ANALYTICS:B(p.sharedActions.openNewTab({uri:Object(l.getFlowAnalyticsPageUrl)(G.name,H.payload.flowName,H.payload.solutionId)}));break;case u.SolutionComponentsActionTypes.OPEN_ENTITY_DETAILS:var oe=H.payload.entityName,re=Object(r.getEnvironmentOrgId)(G);x=H.payload.solutionId,H.payload.navigate(Object(l.getEntityDetailsSolutionPageUrl)(G.name,re,oe,x),!0);break;case u.SolutionComponentsActionTypes.OPEN_DASHBOARD:var ae=H.payload.dashboardId;x=H.payload.solutionId,B(p.sharedActions.openNewTab({uri:c.getDashboardDesignerUrl(q,ae,x)}));break;case u.SolutionComponentsActionTypes.OPEN_PROCESS:var ie=H.payload.processId;x=H.payload.solutionId,B(p.sharedActions.openNewTab({uri:c.getProcessDesignerUrl(q,ie,x)}));break;case u.SolutionComponentsActionTypes.OPEN_SOLUTION_COMPONENT:var se=H.payload.componentId,le=H.payload.componentType;x=Object(y.getSolutionId)(H.payload.solution),Object(E.areSameSolutionComponentType)(le,b.StandardSolutionComponentTypes.AppModule)?B(p.sharedActions.openNewTab({uri:v.getAppModuleDesignerUrl(q,se,x)})):Object(E.areSameSolutionComponentType)(le,b.StandardSolutionComponentTypes.Report)?B(p.sharedActions.openNewTab({uri:c.getReportDesignerUrl(q,se,x)})):Object(E.areSameSolutionComponentBaseType)(le,b.StandardSolutionComponentTypes.WebResource)?B(p.sharedActions.openNewTab({uri:c.getWebResourceDesignerUrl(q,se,x)})):Object(E.areSameSolutionComponentType)(le,b.StandardSolutionComponentTypes.SiteMap)?B(p.sharedActions.openNewTab({uri:c.getSiteMapDesignerUrl(q,se,x)})):Object(E.areSameSolutionComponentType)(le,b.StandardSolutionComponentTypes.ConnectionRole)?B(p.sharedActions.openNewTab({uri:c.getConnectionRoleDesignerUrl(q,se,x)})):Object(E.areSameSolutionComponentType)(le,b.StandardSolutionComponentTypes.Template)?B(p.sharedActions.openNewTab({uri:c.getEmailTemplateDesignerUrl(q,se,x)})):Object(E.areSameSolutionComponentType)(le,b.StandardSolutionComponentTypes.MailMergeTemplate)?B(p.sharedActions.openNewTab({uri:c.getMailMergeTemplateDesignerUrl(q,se,x)})):Object(E.areSameSolutionComponentType)(le,b.StandardSolutionComponentTypes.Role)?B(p.sharedActions.openNewTab({uri:c.getSecurityRoleDesignerUrl(q,se,x)})):Object(E.areSameSolutionComponentType)(le,b.StandardSolutionComponentTypes.FieldSecurityProfile)?B(p.sharedActions.openNewTab({uri:c.getFieldSecurityProfileDesignerUrl(q,se,x)})):Object(E.areSameSolutionComponentType)(le,b.StandardSolutionComponentTypes.KbArticleTemplate)?B(p.sharedActions.openNewTab({uri:c.getArticleTemplateUrl(q,x,se)})):Object(E.areSameSolutionComponentType)(le,b.StandardSolutionComponentTypes.RoutingRule)?B(p.sharedActions.openNewTab({uri:Object(g.getRoutingRuleSetsUrl)(q,x,se)})):Object(E.areSameSolutionComponentType)(le,b.StandardSolutionComponentTypes.ConvertRule)?B(p.sharedActions.openNewTab({uri:c.getRecordCreationAndUpdateRuleUrl(q,x,se)})):Object(E.areSameSolutionComponentType)(le,b.StandardSolutionComponentTypes.SLA)?B(p.sharedActions.openNewTab({uri:c.getSLAUrl(q,x,se)})):Object(E.areSameSolutionComponentType)(le,b.StandardSolutionComponentTypes.OptionSet)?B(Object(u.fetchOptionSetRequest)({solutionId:x,optionSetId:H.payload.componentId,context:{optionSetPrefix:Object(y.getSolutionOptionSetPrefix)(H.payload.solution),envNamePrefix:Object(y.getSolutionResourceNamePrefix)(H.payload.solution),envLanguageCode:r.getEnvironmentLanguageCode(G),environmentId:G.id},booleanOptionSet:H.payload.componentContext.isBoolean})):Object(E.areSameSolutionComponentType)(le,b.StandardSolutionComponentTypes.EnvironmentVariableDefinition)?B(p.sharedActions.panelOpen({panelType:a.PanelToShowType.EditEnvironmentVariablePanel,panelProps:{solution:Object(A.toEnvironmentVariablePanelSolution)(H.payload.solution),definitionId:H.payload.componentId}})):Object(E.isKnownCustomSolutionComponentType)(le)&&Object(j.knownCustomSolutionComponentTypeOpenSolutionComponentMiddleware)(le.logicalName)?Object(j.knownCustomSolutionComponentTypeOpenSolutionComponentMiddleware)(le.logicalName)(B):!Object(E.isStandardSolutionComponentType)(le)&&le.logicalName&&B(p.sharedActions.openNewTab({uri:Object(g.getCustomSolutionComponentUrl)(q,le.logicalName,se)}));break;case u.SolutionComponentsActionTypes.CREATE_NEW_SOLUTION_COMPONENT:var ce=H.payload.componentType;x=Object(y.getSolutionId)(H.payload.solution),V=Object(y.getSolutionName)(H.payload.solution);var pe=!0;if(!q)return n(L);if(Object(E.areSameSolutionComponentType)(ce,b.StandardSolutionComponentTypes.RoutingRule))B(p.sharedActions.openNewTab({uri:c.getCreateNewRoutingRuleUrl(q,x)}));else if(Object(E.areSameSolutionComponentType)(ce,b.StandardSolutionComponentTypes.KbArticleTemplate))B(p.sharedActions.openNewTab({uri:c.getCreateNewArticleTemplateUrl(q,x)}));else if(Object(E.areSameSolutionComponentType)(ce,b.StandardSolutionComponentTypes.Flow))B(p.sharedActions.openNewTab({uri:Object(l.getNewFlowPageUrl)(G.name,T.FlowsDataType.FlOWS,x)}));else if(Object(E.areSameSolutionComponentType)(ce,b.StandardSolutionComponentTypes.UIFlow))B(p.sharedActions.openNewTab({uri:Object(l.getNewFlowPageUrl)(G.name,T.FlowsDataType.UIFLOWS,x)}));else if(Object(E.areSameSolutionComponentType)(ce,b.StandardSolutionComponentTypes.Connector))B(p.sharedActions.openNewTab({uri:Object(l.getNewCustomConnectorPageUrl)(G.name,x)}));else if(Object(E.areSameSolutionComponentType)(ce,b.StandardSolutionComponentTypes.CustomCanvasPage))F=Object(D.getCustomCanvasPageUri)(G.name,x),H.payload.navigate(F),pe=!1;else if(Object(E.areSameSolutionComponentType)(ce,b.StandardSolutionComponentTypes.CanvasApp)){var ue,de;if(null!==(ue=H.payload.options)&&void 0!==ue&&ue.isAppComponentLibrary)F=Object(D.getNewComponentLibraryUri)(G.name,void 0,x),H.payload.navigate(F),pe=!1;else if(null!==(de=H.payload.options)&&void 0!==de&&de.formFactor)F=Object(D.getAppFromBlankUri)(G.name,H.payload.options.formFactor,x,void 0),H.payload.navigate(F),pe=!1;else{var me=Object(I.getStaticSampleCanvasApp)();me.solutionId=x,B(Object(w.openSampleAppModal)({sampleApp:me})),pe=!1}}else if(Object(E.areSameSolutionComponentType)(ce,b.StandardSolutionComponentTypes.ComponentLibrary))F=Object(D.getNewComponentLibraryUri)(G.name,void 0,x),H.payload.navigate(F),pe=!1;else if(Object(E.isKnownCustomSolutionComponentType)(ce)&&Object(j.knownCustomSolutionComponentTypeNewComponentUrl)(ce.logicalName,G.name,x))F=Object(j.knownCustomSolutionComponentTypeNewComponentUrl)(ce.logicalName,G.name,x),B(p.sharedActions.openNewTab({uri:F}));else if(Object(E.isKnownCustomSolutionComponentType)(ce)&&Object(j.knownCustomSolutionComponentTypeOnCreateClicked)(ce.logicalName))B(Object(j.knownCustomSolutionComponentTypeOnCreateClicked)(ce.logicalName)(H.payload.solution));else if(Object(E.areSameSolutionComponentType)(ce,b.StandardSolutionComponentTypes.Template))F=Object(g.getNewComponentUrl)(q,Object(r.getCrmVersion)(G),x,V,ce,H.payload.options),B(p.sharedActions.openNewTab({uri:F,features:{height:200,width:400}}));else if(Object(E.areSameSolutionComponentType)(ce,b.StandardSolutionComponentTypes.OptionSet)){var be=Object(P.safePrivilegeResultSelector)(t.getState(),G.id,"prvCreateOptionSet");B(be?Object(u.openCreateOptionSet)({context:{optionSetPrefix:Object(y.getSolutionOptionSetPrefix)(H.payload.solution),envLanguageCode:r.getEnvironmentLanguageCode(G),envNamePrefix:Object(y.getSolutionResourceNamePrefix)(H.payload.solution),environmentId:G.id}}):Object(u.showMissingCreateOptionSetPrivilegeNotification)())}else if(Object(E.areSameSolutionComponentType)(ce,b.StandardSolutionComponentTypes.Entity)){Object(P.safePrivilegeResultSelector)(t.getState(),G.id,"prvCreateEntity")?H.payload.navigate(Object(l.getCreateEntityUrlModel)(G.name,x),!0):B(Object(u.showMissingCreateEntityPrivilegeNotification)())}else Object(E.areSameSolutionComponentType)(ce,b.StandardSolutionComponentTypes.EnvironmentVariableDefinition)?B(p.sharedActions.panelOpen({panelType:a.PanelToShowType.CreateEnvironmentVariablePanel,panelProps:{solution:Object(A.toEnvironmentVariablePanelSolution)(H.payload.solution)}})):Object(E.areSameSolutionComponentType)(ce,b.StandardSolutionComponentTypes.ConvertRule)?B(p.sharedActions.openNewTab({uri:c.getCreateNewRecordCreationAndUpdateRuleUrl(q,x)})):Object(E.areSameSolutionComponentType)(ce,b.StandardSolutionComponentTypes.Dataflow)?B(p.sharedActions.openNewTab({uri:Object(l.getNewDataflowPageUrl)(G.name,x)})):Object(E.areSameSolutionComponentType)(ce,b.StandardSolutionComponentTypes.PowerBIDashboard)?B(p.sharedActions.panelOpen({panelType:a.PanelToShowType.CreatePowerBIDashboardPanel,panelProps:{solution:H.payload.solution}})):Object(E.areSameSolutionComponentType)(ce,b.StandardSolutionComponentTypes.AppModule)&&O.featureGates.enableEditInShellAppDesigner?(B(Object(w.openSampleAppModal)({sampleApp:Object.assign(Object(I.getStaticSampleAppModule)(),{solutionId:x})})),pe=!1):(F=Object(g.getNewComponentUrl)(q,Object(r.getCrmVersion)(G),x,V,ce,H.payload.options),B(p.sharedActions.openNewTab({uri:F})));Object(E.areSameSolutionComponentType)(ce,b.StandardSolutionComponentTypes.Entity)||Object(E.areSameSolutionComponentType)(ce,b.StandardSolutionComponentTypes.OptionSet)||Object(E.areSameSolutionComponentType)(ce,b.StandardSolutionComponentTypes.ProcessNoFlow)||Object(E.areSameSolutionComponentType)(ce,b.StandardSolutionComponentTypes.HierarchyRule)||Object(E.areSameSolutionComponentType)(ce,b.StandardSolutionComponentTypes.EnvironmentVariableDefinition)||Object(E.areSameSolutionComponentType)(ce,b.StandardSolutionComponentTypes.PowerBIDashboard)||Object(j.knownCustomSolutionComponentTypeOnCreateClicked)(ce.logicalName)||(_=Object(E.getTypeStringFromSolutionComponentType)(ce,!1,!0),Object(E.areSameSolutionComponentType)(ce,b.StandardSolutionComponentTypes.ComponentLibrary)&&H.payload.options.isAppComponentLibrary&&(_=Q.Model.Solutions.Components.Types.componentLibrary.toLocaleLowerCase()),pe&&B(Object(S.openConfirmDialog)({hidden:!1,title:Object(o.formatResourceString)(Q.Model.Solutions.Components.NewCommand.Dialog.title,_),subText:Object(o.formatResourceString)(Q.Model.Solutions.Components.NewCommand.Dialog.subtext,_),confirmButtonText:Q.Model.Solutions.Components.NewCommand.Dialog.closeButtonText,onConfirm:()=>{B(Object(S.closeConfirmDialog)()),B(Object(u.refreshComponentsList)())},hideCancelButton:!0})));break;case u.SolutionComponentsActionTypes.OPEN_REMOVE_DIALOG:B(p.sharedActions.openConfirmDialog({hidden:!1,title:H.payload.components.length>1?Q.Model.Solutions.Components.Remove.Dialog.titleMulti:Q.Model.Solutions.Components.Remove.Dialog.title,subText:H.payload.components.length>1?Q.Model.Solutions.Components.Remove.Dialog.subTextMulti:Q.Model.Solutions.Components.Remove.Dialog.subtext,cancelButtonText:Q.Model.Solutions.Components.Remove.Dialog.cancel,confirmButtonText:Q.Model.Solutions.Components.Remove.Dialog.confirm,onConfirm:()=>{B(Object(d.logAction)(Object(u.removeComponents)({components:H.payload.components,solutionId:H.payload.solutionId,solutionName:H.payload.solutionName,shouldNotShowInList:H.payload.shouldNotShowInList}),f.SolutionComponentsCommandEvents.Remove.eventName,f.SolutionComponentsCommandEvents.Remove.getData(H.payload.solutionId,H.payload.components)))},isDestructive:!0}));break;case u.SolutionComponentsActionTypes.OPEN_DELETE_DIALOG:B(p.sharedActions.openConfirmDialog({hidden:!1,title:H.payload.components.length>1?Q.Model.Solutions.Components.Delete.Dialog.titleMulti:Q.Model.Solutions.Components.Delete.Dialog.title,subText:H.payload.components.length>1?Q.Model.Solutions.Components.Delete.Dialog.subtextMulti:Q.Model.Solutions.Components.Delete.Dialog.subtext,cancelButtonText:Q.Model.Solutions.Components.Delete.Dialog.cancel,confirmButtonText:Q.Model.Solutions.Components.Delete.Dialog.confirmation,onConfirm:()=>{B(Object(d.logAction)(Object(u.deleteComponents)({components:H.payload.components,customComponentDefinitions:H.payload.customComponentDefinitions,solutionId:H.payload.solutionId,shouldNotShowInList:H.payload.shouldNotShowInList}),f.SolutionComponentsCommandEvents.Delete.eventName,f.SolutionComponentsCommandEvents.Delete.getData(H.payload.solutionId,H.payload.components)))},isDestructive:!0}));break;case u.SolutionComponentsActionTypes.ADD_SLA:B(p.sharedActions.panelOpen({panelType:a.PanelToShowType.AddSLAPanel,panelProps:{solution:H.payload.solution}}));break;case u.SolutionComponentsActionTypes.ADD_SLA_REQUEST:x=H.payload.solutionId,_=Object(E.getTypeStringFromSolutionComponentType)(b.StandardSolutionComponentTypes.SLA,!1,!0),B(p.sharedActions.openNewTab({uri:c.getCreateNewSLAUrl(q,x,H.payload.name,H.payload.entityId)})),B(Object(S.openConfirmDialog)({hidden:!1,title:Object(o.formatResourceString)(Q.Model.Solutions.Components.NewCommand.Dialog.title,_),subText:Object(o.formatResourceString)(Q.Model.Solutions.Components.NewCommand.Dialog.subtext,_),confirmButtonText:Q.Model.Solutions.Components.NewCommand.Dialog.closeButtonText,onConfirm:()=>{B(Object(S.closeConfirmDialog)()),B(Object(u.refreshComponentsList)())},hideCancelButton:!0}))}return n(L)}}},5791:function(e,t,n){"use strict";n.r(t),n.d(t,"SolutionComponentsClientRootSaga",(function(){return i}));var o=n(5749),r=n(5792),a=n(5822);function*i(){yield Object(o.all)([Object(o.fork)(r.default),Object(o.fork)(a.default)])}},5792:function(e,t,n){"use strict";n.r(t),n.d(t,"refreshSolutionComponentsSaga",(function(){return me})),n.d(t,"fetchSolutionComponentsNotInSolutionSaga",(function(){return fe})),n.d(t,"makeSolutionUnawareCanvasAppsRequest",(function(){return Oe})),n.d(t,"makeSolutionUnawareFlowsRequest",(function(){return Ce})),n.d(t,"makeSolutionUnawareCustomConnectorsRequest",(function(){return ve})),n.d(t,"addSolutionUnawarePowerBIArtifactsSaga",(function(){return Pe})),n.d(t,"addSolutionUnawareComponentSaga",(function(){return Ee})),n.d(t,"deleteSolutionComponentsSaga",(function(){return Ne}));var o=n(2867),r=n(2812),a=n(5749),i=n(5793),s=n(5604),l=n(5608),c=n(5675),p=n(5607),u=n(5596),d=n(5760),m=n(5597),b=n(2868),g=n(5478),y=n(2869),S=n(2880),f=n(5470),h=n(5648),O=n(5794),C=n(5800),v=n(5802),P=n(5468),E=n(5474),T=n(5690),j=n(5686),A=n(5808),R=n(5810),I=n(5634),w=n(5606),D=n(5483),N=n(5801),L=n(5813),M=n(5766),x=n(5767),k=n(5768),F=n(5669),_=n(5593),U=n(5816),V=n(5817),B=n(5698),H=n(5599),G=n(5609),W=n(3713),q=n(5612),z=n(1088),Q=n(5819),K=n(222),Y=n(5796),J=n(5820),X=n(2871);function Z(e,t,n,o,r,a,i){try{var s=e[a](i),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(o,r)}function $(e){return function(){var t=this,n=arguments;return new Promise((function(o,r){var a=e.apply(t,n);function i(e){Z(a,o,r,i,s,"next",e)}function s(e){Z(a,o,r,i,s,"throw",e)}i(void 0)}))}}function ee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ee(Object(n),!0).forEach((function(t){ne(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ee(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ne(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var oe={},re={};function ae(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(e)return(new Array).concat([{column:"msdyn_name",value:e},{column:"msdyn_displayname",value:e},{column:"msdyn_componenttypename",value:e},{column:"msdyn_ismanagedname",value:e}]).concat(t.map(t=>({column:t,value:e})))}function ie(e){if(e)return"(msdyn_objectid eq ".concat(e,")")}function se(e){var t=e.subcomponentType;return Object(G.areSameSolutionComponentType)(t,W.StandardSolutionComponentTypes.BusinessRule)?l.SolutionComponentTypeCodeExt.Workflow:Object(G.areSameSolutionComponentType)(t,W.StandardSolutionComponentTypes.AllDashboards)||Object(G.areSameSolutionComponentType)(t,W.StandardSolutionComponentTypes.FormsOnly)?l.SolutionComponentTypeCodeExt.SystemForm:Object(G.areSameSolutionComponentType)(t,W.StandardSolutionComponentTypes.Commands)?e.objectTypeCode:t.extendedTypeCode}function*le(e){var t=w.SagaContextProps.getCurrentEnvironment(),n=Object(A.getSolutionComponentMappingKey)(t.id,e.payload.solutionId,e.payload.componentTypes,e.payload.entityName);try{if(!oe[n].next)return void(yield Object(a.call)(de,Object(j.fetchSolutionComponentsRequest)(e.payload)));yield oe[n].next(),yield Object(a.put)(Object(j.pageSolutionComponentsFulfilled)({environmentId:t.id,solutionId:e.payload.solutionId,componentTypes:e.payload.componentTypes,solutionComponents:oe[n].data,hasNextLink:oe[n].hasNext}))}catch(o){yield Object(a.put)(Object(j.pageSolutionComponentsRejected)({environmentId:t.id,solutionId:e.payload.solutionId,componentTypes:e.payload.componentTypes,error:Object(k.getResponseErrorMessage)(o)}))}}function*ce(e){var t=w.SagaContextProps.getCurrentEnvironment(),n=Object(A.getSolutionComponentMappingKey)(t.id,e.payload.solutionId,e.payload.componentTypes,e.payload.entityName);try{if(!re[n]||!re[n].next)return void(yield Object(a.call)(fe,Object(j.fetchSolutionComponentsNotInSolutionRequest)(e.payload)));yield re[n].next(),yield Object(a.put)(Object(j.pageSolutionComponentsNotInSolutionFulfilled)({environmentId:t.id,solutionId:e.payload.solutionId,componentTypes:e.payload.componentTypes,entityName:e.payload.entityName,solutionComponents:re[n].data,hasNextLink:re[n].hasNext}))}catch(o){yield Object(a.put)(Object(j.pageSolutionComponentsNotInSolutionRejected)({environmentId:t.id,solutionId:e.payload.solutionId,componentTypes:e.payload.componentTypes,entityName:e.payload.entityName,error:Object(k.getResponseErrorMessage)(o)}))}}function*pe(e){var t=w.SagaContextProps.getCurrentEnvironment(),n=_e(e.payload.componentTypes);try{var o=yield b.MetadataClientInstance.getInstance(),r=yield o.fetchList("SolutionComponentSummary",te({solutionId:e.payload.solutionId},Ue(n)),{search:e.payload.searchFilter?ae(e.payload.searchFilter):void 0,filter:e.payload.componentId?ie(e.payload.componentId):void 0,orderby:e.payload.orderBy?[e.payload.orderBy]:void 0,pagesize:I.PAGESIZE},{scenarioName:b.MCLTelemetryEventsMap.PAPortalPrefix});if(!r)return null;oe[Object(A.getSolutionComponentMappingKey)(t.id,e.payload.solutionId,e.payload.componentTypes,e.payload.entityName)]=r,yield Object(a.put)(Object(j.fetchSolutionComponentsFulfilled)({environmentId:t.id,solutionId:e.payload.solutionId,componentTypes:e.payload.componentTypes,solutionComponents:r.data,hasNextLink:r.hasNext,solutionName:e.payload.solutionName}))}catch(i){yield Object(a.put)(Object(j.fetchSolutionComponentsRejected)({environmentId:t.id,solutionId:e.payload.solutionId,componentTypes:e.payload.componentTypes,error:Object(k.getResponseErrorMessage)(i)}))}}function*ue(e){var t=w.SagaContextProps.getCurrentEnvironment();try{var n,o=e.payload.solutionComponents.filter(e=>e.msdyn_componenttype===W.StandardSolutionComponentTypes.Entity.typeCode),r=Object(G.getObjectTypeCodesTypeNamesAndIdsFromEntities)(o);if((null==r||null===(n=r.objectIds)||void 0===n?void 0:n.length)<1)return null;var i="";null==r||r.objectTypeCodes.filter(e=>!!e).forEach(e=>{i+="<value>".concat(e,"</value>")});var s=Object(S.formatResourceString)(m.entitiesSystemFormsFetchXml,i),l=yield b.MetadataClientInstance.getInstance(),c=yield l.retrieveFetchXmlResults({EntitySetName:"systemforms",fetchXml:s},{scenarioName:b.MCLTelemetryEventsMap.PAPortalPrefix}),p="";null==r||r.objectTypeNames.filter(e=>!!e).forEach(e=>{p+="<value>".concat(e,"</value>")});var u=Object(S.formatResourceString)(m.solutionComponentSummaryAppActionsFetchXml,p),d=yield l.retrieveFetchXmlResults({EntitySetName:"msdyn_solutioncomponentsummaries",fetchXml:u},{scenarioName:b.MCLTelemetryEventsMap.PAPortalPrefix});if(!c&&!d)return null;var g=[],y=[];c&&c.value.forEach(e=>{var t=Object(I.solutionComponentGenerator)(e);g.push(t),y.push(t.msdyn_objectid)}),d&&d.value.forEach(e=>{var t=e;g.push(t),y.push(t.msdyn_objectid)}),yield Object(a.put)(Object(j.fetchSolutionSubComponentsFullfilled)({environmentId:t.id,objectIds:y,subComponents:g,solutionId:e.payload.solutionId,solutionName:e.payload.solutionName}))}catch(f){yield Object(a.put)(Object(j.fetchSolutionSubComponentsFailed)({environmentId:t.id,error:Object(k.getResponseErrorMessage)(f),solutionId:e.payload.solutionId,solutionName:e.payload.solutionName}))}return null}function*de(e){var t=w.SagaContextProps.getCurrentEnvironment();yield Object(a.put)(Object(j.fetchSolutionComponentsRequestLoading)({environmentId:t.id,solutionId:e.payload.solutionId,componentTypes:e.payload.componentTypes})),yield Object(a.fork)(pe,Object(j.fetchSolutionComponentsRequest)(e.payload)),Object(c.shouldShowEnvironmentVariables)(Object(s.getCrmVersion)(t))&&(yield Object(a.fork)(pe,Object(j.fetchSolutionComponentsRequest)({solutionId:b.DefaultCrmSolutionId,componentTypes:[W.StandardSolutionComponentTypes.EnvironmentVariableDefinition]})))}function*me(){var e=yield Object(a.select)(R.currentSolutionFilter);if(e){var t=te({},e);yield Object(a.fork)(de,Object(j.fetchSolutionComponentsRequest)(t))}}function*be(){var e={appsListFilter:u.AppListType.SolutionUnaware};yield Object(a.fork)(O.fetchAppListSaga,Object(h.fetchAppsRequest)(e))}function*ge(){yield Object(a.fork)(C.fetchFlowsListSaga,Object(N.fetchFlowsRequest)({flowType:N.FlowType.personal}))}function*ye(){yield Object(a.fork)(V.fetchDataflowsListSaga,Object(B.fetchDataflowsRequest)())}function*Se(){yield Object(a.fork)(v.fetchApisSaga,Object(Y.fetchApisRequest)())}function*fe(e){var t,n,o=w.SagaContextProps.getCurrentEnvironment(),r=F.SagaScenarioNames.fetchSolutionComponentsNotInSolutionSaga,i=Object(_.trackLoadScenario)(r),s=_e(e.payload.componentTypes);try{var l,c=yield b.MetadataClientInstance.getInstance();Object(_.trackScenarioProgress)(r,{CurrentStep:"MCL instance retrieved"},i),e.payload&&e.payload.searchFilter&&(l=e.payload.entityName?ae(e.payload.searchFilter,["msdyn_fieldtype"]):ae(e.payload.searchFilter),Object(G.areSameSolutionComponentType)(s[0],W.StandardSolutionComponentTypes.DisplayString)&&(l=l.filter(e=>"msdyn_fieldtype"!==e.column&&"msdyn_displayname"!==e.column)));var p,u=e.payload.applyCustomizationFilter&&{filter:"(msdyn_iscustomizable eq 'true')"};try{var d;p=yield c.fetchComponentsNotInSolution(te(te({solutionId:e.payload.solutionId},Ue(s)),{},{entityName:e.payload.entityName}),te({search:l,orderby:e.payload.orderBy?[e.payload.orderBy]:[{column:"msdyn_displayname",order:"asc"}],pagesize:null!==(d=e.payload.pageSize)&&void 0!==d?d:I.PAGESIZE},u),{scenarioName:b.MCLTelemetryEventsMap.PAPortalPrefix})}catch(y){var m;if("500"!==(null==y?void 0:y.code)||"0x80041102"!==(null==y||null===(m=y.errorAnnotations)||void 0===m?void 0:m.code))throw y;p={get data(){return[]},get hasNext(){return!1},get hasChanged(){return!1},get nextLink(){},next:(n=$((function*(){return Promise.resolve(!1)})),function(){return n.apply(this,arguments)}),reset:(t=$((function*(){return Promise.resolve(!1)})),function(){return t.apply(this,arguments)})}}if(Object(_.trackScenarioProgress)(r,{CurrentStep:"List fetched"},i),!p)throw Error();var g=p.data;s&&Object(G.areSameSolutionComponentType)(s[0],W.StandardSolutionComponentTypes.EnvironmentVariableDefinition)&&g&&(yield function*(e){for(var t=0;t<e.length;t++){var n=yield Object(a.select)(U.envVariableSelector,e[t].msdyn_objectid);e[t]=te(te({},e[t]),{},{extendedIsRequired:n.isrequired,extendedDataType:n.type,extendedDefaultValue:n.defaultvalue,extendedCurrentValueId:n.environmentvariabledefinition_environmentvariablevalue&&n.environmentvariabledefinition_environmentvariablevalue[0]?n.environmentvariabledefinition_environmentvariablevalue[0].environmentvariablevalueid:void 0})}}(g),Object(_.trackScenarioProgress)(r,{CurrentStep:"mergePropertiesForEnvVariableDefinitions"},i)),re[Object(A.getSolutionComponentMappingKey)(o.id,e.payload.solutionId,s,e.payload.entityName)]=p,Object(_.trackScenarioComplete)(r,{solutionComponentsLength:g?g.length:0},i),yield Object(a.put)(Object(j.fetchSolutionComponentsNotInSolutionFulfilled)({environmentId:o.id,solutionId:e.payload.solutionId,componentTypes:s,entityName:e.payload.entityName,solutionComponents:g,hasNextLink:p.hasNext}))}catch(y){Object(_.trackScenarioFailure)(r,{error:Object(k.getResponseErrorMessage)(y)},i),yield Object(a.put)(Object(j.fetchSolutionComponentsNotInSolutionRejected)({environmentId:o.id,solutionId:e.payload.solutionId,componentTypes:s,entityName:e.payload.entityName,error:Object(k.getResponseErrorMessage)(y)}))}}function*he(e){try{var t=yield b.MetadataClientInstance.getInstance(),n=yield t.describeActions("SolutionComponentSummary");if(!n)return null;yield Object(a.put)(Object(j.fetchSolutionComponentActionsFulfilled)({applicableComponentActions:n}))}catch(o){return null}}function*Oe(e,t,n){var o,r=f.CachedStatusType.None,a=e.payload.canvasApps.map(u.getAppName);if(0===a.length)return null;if(1===a.length)o={url:Object(m.getMakeSolutionAwareUri)(t,a[0]),method:"POST",data:JSON.stringify({solutionId:n}),headers:{"Content-Type":"application/json"}};else{var i=a.map(e=>{var o=Object(m.getMakeSolutionAwareUri)(t,e);return{httpMethod:"POST",relativeUrl:o=Object(D.addSearchParam)(o,"api-version",z.RpApiVersion),content:{solutionId:n}}});o={url:m.batchUri,method:"POST",data:JSON.stringify({requests:i}),headers:{"Content-Type":"application/json"}}}return yield Object(d.default)(e,o,r,!1,z.RpApiVersion)}function*Ce(e,t,n){var o,r=f.CachedStatusType.None,a=e.payload.flows.map(L.getFlowName);if(0===a.length)return null;var i={flowsToMigrate:a};return o={url:Object(m.getMakeSolutionAwareFlowsUri)(t,n),method:"POST",data:JSON.stringify(i),headers:{"Content-Type":"application/json"}},yield Object(d.default)(e,o,r,!1,"2018-10-01")}function*ve(e,t,n){var o=e.payload.apisToMigrate,r=f.CachedStatusType.None;if(0===o.length)return null;var a={apisToMigrate:o},i={url:Object(m.getMakeApiSolutionAwareUri)(t,n),method:"POST",data:JSON.stringify(a),headers:{"Content-Type":"application/json"}};return yield Object(d.default)(e,i,r,!1,"2016-11-01")}function*Pe(e){var t,n,o=w.SagaContextProps.getCurrentEnvironment(),r=Object(s.getNameFromCurrentEnvironment)(o),i=e.payload.solutionId;try{for(var l=yield b.MetadataClientInstance.getInstance(),c=0;c<e.payload.artifacts.length;c++){var p=e.payload.artifacts[c],u=(t=e.payload.publisher.customizationprefix,n=void 0,n=Object(K.v4)().toString().replace(/-/g,""),t+"_"+n);X.featureGates.enablePowerBIArtifactNewCreationExperience?yield Object(J.createPowerBIArtifact)(l,e.payload.solutionUniqueName,e.payload.artifactsType,p.id,p.properties.workspaceId,u):yield l.executeAction(e.payload.artifactsType,"Create",{solutionName:e.payload.solutionUniqueName},{name:p.name,datasetobjectid:e.payload.artifactsType===Q.PowerBIArtifactSolutionComponentTypes.PowerBIDataset?p.id:void 0,reportobjectid:e.payload.artifactsType===Q.PowerBIArtifactSolutionComponentTypes.PowerBIReport?p.id:void 0,workspaceobjectid:p.properties.workspaceId,uniquename:u})}yield Object(a.put)(Object(j.addSolutionUnawarePowerBIArtifactsFulfilled)({solutionId:e.payload.solutionId,environmentId:r}))}catch(d){yield Object(a.put)(Object(j.addSolutionComponentsRejected)({solutionId:i,environmentId:r,error:d.message}))}}function*Ee(e){var t,n,o=e.payload.solutionId,i=w.SagaContextProps.getCurrentEnvironment(),l=Object(s.getNameFromCurrentEnvironment)(i);if(e.type===j.SolutionComponentsActionTypes.ADD_UNAWARE_CANVAS_APPS_REQUEST?t=yield Oe(e,l,o):e.type===j.SolutionComponentsActionTypes.ADD_UNAWARE_FLOWS_REQUEST?t=yield Ce(e,l,o):e.type===j.SolutionComponentsActionTypes.ADD_UNAWARE_CUSTOM_CONNECTORS_REQUEST?t=yield ve(e,l,o):e.type===j.SolutionComponentsActionTypes.ADD_UNAWARE_DATAFLOWS_REQUEST&&(t=yield function*(e,t,n,o){var r,i,s,l,c=f.CachedStatusType.None;try{r=Object(H.getPowerQueryOnlineEndpoint)(o)}catch(p){return p.message}return e.payload.authOptions={shouldAddAuthHeader:!0,endpointUrl:Object(H.getPowerQueryOnlineResource)()},0===e.payload.dataflows.length?null:yield Object(a.call)(d.default,e,(i=e.payload.dataflows.map(e=>e.id),s=m.powerQueryDataflowUrl,l={dataflowIds:i,environmentId:t,solutionId:n},{url:"".concat(r).concat(s),method:"PUT",data:JSON.stringify(l),headers:{"Content-Type":"application/json"}}),c,!1)}(e,l,o,i.location)),!t)return null;if(e.type===j.SolutionComponentsActionTypes.ADD_UNAWARE_FLOWS_REQUEST){var c=t&&t.data&&t.data.statuses;n=Object.keys(c).map(e=>c[e])}else n=t&&t.data&&t.data.responses||t.response&&[t.response.data]||(t.status?t:[]);var p=e=>e>=200&&e<300,u=Object(r.filter)(n,e=>p(e.status)||p(e.httpStatusCode)||(e=>"Success"===e)(e.status)).length,b=(n.length||1)-u;if(b>0){var g;if(u>0||b>1)g=n.map(e=>e.error&&e.error.message||e.content&&e.content.error&&e.content.error.message).join(" ");else{var y=n[0];g=(y.error||y.content&&y.content.error).message}yield Object(a.put)(Object(j.addSolutionComponentsRejected)({solutionId:o,environmentId:l,error:g}))}u>0&&(e.type===j.SolutionComponentsActionTypes.ADD_UNAWARE_CANVAS_APPS_REQUEST?(0===b&&(yield Object(a.put)(Object(j.addSolutionUnawareCanvasAppsFulfilled)({solutionId:o,environmentId:l}))),yield Object(a.fork)(be)):e.type===j.SolutionComponentsActionTypes.ADD_UNAWARE_FLOWS_REQUEST?(0===b&&(yield Object(a.put)(Object(j.addSolutionUnawareFlowsFulfilled)({solutionId:o,environmentId:l}))),yield Object(a.fork)(ge)):e.type===j.SolutionComponentsActionTypes.ADD_UNAWARE_DATAFLOWS_REQUEST?(0===b&&(yield Object(a.put)(Object(j.addSolutionUnawareDataflowsFulfilled)({solutionId:o,environmentId:l}))),yield Object(a.fork)(ye)):e.type===j.SolutionComponentsActionTypes.ADD_UNAWARE_CUSTOM_CONNECTORS_REQUEST&&(0===b&&(yield Object(a.put)(Object(j.addSolutionUnawareCustomConnectorsFulfilled)({solutionId:o,environmentId:l}))),yield Object(a.fork)(Se)),yield Object(a.fork)(me))}function*Te(e){var t=w.SagaContextProps.getCurrentEnvironment();try{var n=yield b.MetadataClientInstance.getInstance(),i=Object(o.Map)();e.payload.componentsWithSubcomponents.forEach(e=>{var t=Object(r.pick)(e.component,["msdyn_objectid","msdyn_componenttype"]),n=JSON.stringify(Object(r.pick)(e,["includeSubcomponents","includeEntityMetadata"])),o=i.get(n);o||(o=[],i=i.set(n,o)),o.push(t),!e.includeSubcomponents&&e.subcomponents&&e.subcomponents.forEach(e=>{o.push({msdyn_objectid:e.objectId,msdyn_componenttype:se(e)})})});var s=[];i.forEach((t,o)=>{Object(r.isEmpty)(t)||s.push(n.addSolutionComponents(t,te({solutionName:e.payload.solutionName,addRequiredComponents:e.payload.addRequiredComponents},JSON.parse(o)),{scenarioName:b.MCLTelemetryEventsMap.PAPortalPrefix}))}),yield Object(a.all)(s),yield Object(a.put)(Object(j.addSolutionComponentsFulfilled)({environmentId:t.id,solutionId:e.payload.solutionId,componentsWithSubcomponents:e.payload.componentsWithSubcomponents,componentType:e.payload.componentType})),yield Object(a.fork)(me)}catch(l){yield Object(a.put)(Object(j.addSolutionComponentsRejected)({environmentId:t.id,solutionId:e.payload.solutionId,error:Object(k.getResponseErrorMessage)(l)}))}}function*je(e,t){var n=e.filter(e=>e.msdyn_componenttype===l.SolutionComponentTypeCode.EnvironmentVariableDefinition);if(0===n.length)return e;for(var o=new Set,r=0;r<n.length;r++){var i=yield Object(a.select)(U.envVariableSelector,e[r].msdyn_objectid),s=i.environmentvariabledefinition_environmentvariablevalue&&i.environmentvariabledefinition_environmentvariablevalue[0]&&i.environmentvariabledefinition_environmentvariablevalue[0].environmentvariablevalueid;s&&o.add(s)}if(0===o.size)return e;var c=[],p=w.SagaContextProps.getCurrentEnvironment();return(yield Object(a.select)(R.solutionComponentListWithValuesSelector,t,p.id)).filter(e=>e.msdyn_componenttype===l.SolutionComponentTypeCode.EnvironmentVariableValue).forEach(e=>{o.has(e.msdyn_objectid)&&c.push(e)}),c.concat(e)}function*Ae(e){yield Object(a.put)(Object(E.closeConfirmDialog)());var t=Object(y.getResources)(),n=Object(I.replaceEnvVariableDefinitionWithValue)(e.payload.components);n=yield je(n,e.payload.solutionId);try{var o=yield b.MetadataClientInstance.getInstance();yield o.removeSolutionComponents(n,{solutionName:e.payload.solutionName},{scenarioName:b.MCLTelemetryEventsMap.PAPortalPrefix}),yield Object(a.put)(Object(j.removeComponentsSucceeded)({response:t.Model.Solutions.Components.RemoveComponents.successMessage,shouldNotShowInList:e.payload.shouldNotShowInList})),yield Object(a.fork)(me),yield Object(a.put)(Object(j.forceSolutionComponentsListDeselect)())}catch(r){yield Object(a.put)(Object(j.removeComponentsFailed)({response:t.Model.Solutions.Components.RemoveComponents.failureMessage,shouldNotShowInList:e.payload.shouldNotShowInList}))}}function*Re(e){yield Object(a.put)(Object(T.publishAllCustomizationsClear)());var t=Object(y.getResources)();yield Object(a.put)(Object(x.apiCallLoading)({apiCall:M.SolutionComponentApiCalls.PublishComponents}));try{var n=yield b.MetadataClientInstance.getInstance();yield n.publishCustomizations(e.payload,{scenarioName:b.MCLTelemetryEventsMap.PAPortalPrefix}),yield Object(a.put)(Object(x.apiCallFinished)({apiCall:M.SolutionComponentApiCalls.PublishComponents,response:t.Model.Solutions.Components.PublishCustomizations.successMessage,success:!0}))}catch(o){yield Object(a.put)(Object(x.apiCallFinished)({apiCall:M.SolutionComponentApiCalls.PublishComponents,response:Object(S.formatResourceString)(t.Model.Solutions.Components.PublishCustomizations.failureMessage,Object(k.getResponseErrorMessage)(o)),success:!1}))}}function*Ie(e){var t=Object(y.getResources)();try{yield Object(a.put)(Object(x.apiCallLoading)({apiCall:M.SolutionComponentApiCalls.Activate}));var n=yield b.MetadataClientInstance.getInstance();yield n.batchActivateDeactivateComponents(e.payload.components,null,!0,{scenarioName:b.MCLTelemetryEventsMap.PAPortalPrefix}),yield Object(a.put)(Object(x.apiCallFinished)({apiCall:M.SolutionComponentApiCalls.Activate,response:t.Model.Solutions.Components.ActivateComponent.successMessage,success:!0})),yield Object(a.fork)(me),yield Object(a.put)(Object(j.forceSolutionComponentsListDeselect)()),e.payload.handleResponse&&e.payload.handleResponse(!0)}catch(o){yield Object(a.put)(Object(x.apiCallFinished)({apiCall:M.SolutionComponentApiCalls.Activate,response:Object(S.formatResourceString)(t.Model.Solutions.Components.ActivateComponent.failureMessage,Object(k.getResponseErrorMessage)(o)),success:!1})),e.payload.handleResponse&&e.payload.handleResponse(!1)}}function*we(e){var t=Object(y.getResources)();try{yield Object(a.put)(Object(x.apiCallLoading)({apiCall:M.SolutionComponentApiCalls.Deactivate}));var n=yield b.MetadataClientInstance.getInstance();yield n.batchActivateDeactivateComponents(e.payload.components,null,!1,{scenarioName:b.MCLTelemetryEventsMap.PAPortalPrefix}),yield Object(a.put)(Object(x.apiCallFinished)({apiCall:M.SolutionComponentApiCalls.Deactivate,response:t.Model.Solutions.Components.DeactivateComponent.successMessage,success:!0})),yield Object(a.fork)(me),yield Object(a.put)(Object(j.forceSolutionComponentsListDeselect)()),e.payload.handleResponse&&e.payload.handleResponse(!0)}catch(o){yield Object(a.put)(Object(x.apiCallFinished)({apiCall:M.SolutionComponentApiCalls.Deactivate,response:Object(S.formatResourceString)(t.Model.Solutions.Components.DeactivateComponent.failureMessage,Object(k.getResponseErrorMessage)(o)),success:!1})),e.payload.handleResponse&&e.payload.handleResponse(!1)}}function*De(e){var t=Object(y.getResources)();try{yield Object(a.put)(Object(x.apiCallLoading)({apiCall:M.SolutionComponentApiCalls.RibbonCustomization}));var n=yield b.MetadataClientInstance.getInstance();yield n.addRibbonCustomizationToSolution({solutionName:e.payload.solutionName},{scenarioName:b.MCLTelemetryEventsMap.PAPortalPrefix}),yield Object(a.put)(Object(x.apiCallFinished)({apiCall:M.SolutionComponentApiCalls.RibbonCustomization,response:t.Model.Solutions.Components.ApplicationRibbon.successMessage,success:!0})),yield Object(a.fork)(me)}catch(o){yield Object(a.put)(Object(x.apiCallFinished)({apiCall:M.SolutionComponentApiCalls.RibbonCustomization,response:Object(S.formatResourceString)(t.Model.Solutions.Components.ApplicationRibbon.failureMessage,Object(k.getResponseErrorMessage)(o)),success:!1}))}}function*Ne(e){yield Object(a.put)(Object(E.closeConfirmDialog)());var t=Object(y.getResources)(),n=[],o=[];e.payload.components.forEach(e=>{var t=Object(p.getTypeFromSolutionComponent)(e);Object(G.isKnownCustomSolutionComponentType)(t)&&Object(q.knownCustomSolutionComponentTypeDeleteFromEnvironmentSaga)(t.logicalName)?n.push(e):o.push(e)});try{for(var i of n){var s=Object(p.getTypeFromSolutionComponent)(i);yield Object(q.knownCustomSolutionComponentTypeDeleteFromEnvironmentSaga)(s.logicalName)(d.default,i,t)}if(!Object(r.isEmpty)(o)){var l=Object(I.replaceEnvVariableDefinitionWithValue)(o),c=Ve(l=yield je(l,e.payload.solutionId),e.payload.customComponentDefinitions),u=yield b.MetadataClientInstance.getInstance();yield u.batchDeleteComponents(c,{scenarioName:b.MCLTelemetryEventsMap.PAPortalPrefix})}yield Object(a.put)(Object(j.deleteComponentsSucceeded)({response:t.Model.Solutions.Components.DeleteComponents.successMessage,shouldNotShowInList:e.payload.shouldNotShowInList})),yield Object(a.fork)(me),yield Object(a.put)(Object(j.forceSolutionComponentsListDeselect)())}catch(m){yield Object(a.put)(Object(j.deleteComponentsFailed)({response:Object(S.formatResourceString)(t.Model.Solutions.Components.DeleteComponents.failureMessage,Object(k.getResponseErrorMessage)(m)),shouldNotShowInList:e.payload.shouldNotShowInList}))}}function*Le(e){yield Object(a.put)(Object(E.closeConfirmDialog)()),yield Object(a.put)(Object(x.apiCallLoading)({apiCall:M.SolutionComponentApiCalls.AddRequiredComponents}));try{var t=yield b.MetadataClientInstance.getInstance(),n=e.payload.components.map(e=>({msdyn_objectid:e.msdyn_objectid,msdyn_componenttype:e.msdyn_componenttype}));yield t.addSolutionComponents(n,{solutionName:e.payload.solutionName,addRequiredComponents:e.payload.addRequiredComponents,includeSubcomponents:void 0===e.payload.includeSubcomponents||e.payload.includeSubcomponents},{scenarioName:b.MCLTelemetryEventsMap.PAPortalPrefix}),yield Object(a.put)(Object(x.apiCallFinished)({apiCall:M.SolutionComponentApiCalls.AddRequiredComponents,response:Object(y.getResources)().Model.Solutions.Components.AddRequired.Message.success,success:!0})),yield Object(a.fork)(me)}catch(o){yield Object(a.put)(Object(x.apiCallFinished)({apiCall:M.SolutionComponentApiCalls.AddRequiredComponents,response:Object(S.formatResourceString)(Object(y.getResources)().Model.Solutions.Components.AddRequired.Message.failed,o.message),success:!1}))}}function*Me(e){try{var t=yield b.MetadataClientInstance.getInstance(),n=Ve([e.payload.component],e.payload.customComponentDefinitions)[0],o=(yield t.fetchManagedProperties(n)).Properties;yield Object(a.put)(Object(j.fetchComponentManagedPropertiesSuccess)({properties:o})),yield Object(a.put)(Object(x.apiCallFinished)({apiCall:M.SolutionComponentApiCalls.FetchManagedProperties,response:null,success:!0}))}catch(r){yield Object(a.put)(Object(x.apiCallFinished)({apiCall:M.SolutionComponentApiCalls.FetchManagedProperties,response:r.message,success:!1}))}}function*xe(e){try{var t=yield b.MetadataClientInstance.getInstance(),n=Ve([e.payload.component],e.payload.customComponentDefinitions)[0];yield t.executeAction("SolutionComponentSummary","UpdateManagedProperties",te({solutionName:e.payload.solutionName},n),{IsReadOnly:e.payload.isReadOnly,Properties:e.payload.properties}),yield Object(a.put)(Object(x.apiCallFinished)({apiCall:M.SolutionComponentApiCalls.UpdateManagedProperties,response:null,success:!0})),yield Object(a.put)(Object(E.panelClose)({panelType:g.PanelToShowType.ManagedProperties}))}catch(o){yield Object(a.put)(Object(x.apiCallFinished)({apiCall:M.SolutionComponentApiCalls.UpdateManagedProperties,response:o.message,success:!1}))}}function*ke(e){yield function*t(n){var o,s=new Promise(e=>{o=e});yield Object(a.put)(P.sharedActions.panelOpen({panelType:g.PanelToShowType.AddSubcomponentsPanel,panelProps:{solutionId:e.payload.solutionId,componentName:Object(p.getSolutionComponentName)(e.payload.component),componentDisplayName:Object(p.getSolutionComponentDisplayName)(e.payload.component),defaultSelectedKey:e.payload.defaultSelectedKey,onSelectionConfirmed:o,onClosePanel:e.payload.onClosePanel,displayErrorMessage:n}}));var l=yield s;if(l){yield Object(a.put)(Object(j.addSubcomponentsStarted)());var c=r.flatten(l.map((e,t)=>e.getSelection().map(e=>{var n=0,o=i.SubcomponentTypes[t];return n=Object(G.areSameSolutionComponentType)(o,W.StandardSolutionComponentTypes.Commands)?e.objectTypeCode:se(e),{msdyn_objectid:e.objectId,msdyn_componenttype:n}})).toArray());if(Object(r.isEmpty)(c))yield Object(a.put)(Object(j.addSubcomponentsCanceled)());else{try{var u=yield b.MetadataClientInstance.getInstance();yield u.addSolutionComponents(c,{solutionName:e.payload.solutionName},{scenarioName:b.MCLTelemetryEventsMap.PAPortalPrefix})}catch(m){return yield Object(a.put)(Object(j.addSubcomponentsCanceled)()),void(yield t(Object(k.getResponseErrorMessage)(m)))}var d=w.SagaContextProps.getCurrentEnvironment();yield Object(a.put)(Object(j.addSubcomponentsFulfilled)({environmentId:d.id,solutionId:e.payload.solutionId,component:e.payload.component}))}}else yield Object(a.put)(Object(j.addSubcomponentsCanceled)())}(null)}function*Fe(e){var t=w.SagaContextProps.getCurrentEnvironment();try{var n=yield b.MetadataClientInstance.getInstance(),o=yield n.fetchListView("Entity","All",{solutionId:e.payload.solutionId},{columns:["ObjectTypeCode","LogicalName","DisplayName"],filter:"IsSLAEnabled eq true"},{scenarioName:b.MCLTelemetryEventsMap.PAPortalPrefix}),r=[];o&&o.data&&o.data.length>0&&(r=o.data.map(e=>({id:e.ObjectTypeCode.toString(),entity:e}))),yield Object(a.put)(Object(j.fetchSolutionSLAEnabledEntitiesFulfilled)({entities:r,environmentId:t.id}))}catch(i){yield Object(a.put)(Object(j.fetchSolutionSLAEnabledEntitiesRejected)({error:i.message,environmentId:t.id}))}}function _e(e){var t=Object(W.getComponentTypesEnabledForHost)(!0);return t?e?e.filter(e=>t.findIndex(t=>t.typeCode===e.typeCode)>-1):t:e}function Ue(e){if(e&&e.length>0){var t=[],n=[];return e.forEach(e=>{Object(G.isStandardSolutionComponentType)(e)?t.push(e.extendedTypeCode):n.push(e.typeCode)}),te(te({},t&&t.length>0?{extendedTypeCodes:t}:void 0),n&&n.length>0?{typeCodes:n}:void 0)}}function Ve(e,t){return e.map(e=>{if(!Object(p.isStandardSolutionComponent)(e)){var n=Object(p.getTypeFromSolutionComponent)(e),o=t.find(e=>Object(G.areSameSolutionComponentType)(e,n));return te(te({},e),{},{msdyn_entitysetname:o.entitySetName})}return e})}t.default=function*(){yield Object(a.takeLatest)([j.SolutionComponentsActionTypes.FETCH_SOLUTION_COMPONENTS_REQUEST,j.SolutionComponentsActionTypes.ORDER_SOLUTION_COMPONENTS,j.SolutionComponentsActionTypes.SEARCH_SOLUTION_COMPONENTS],de),yield Object(a.takeLatest)([j.SolutionComponentsActionTypes.FETCH_SOLUTION_COMPONENTS_FULFILLED],ue),yield Object(a.takeLatest)([j.SolutionComponentsActionTypes.FETCH_SOLUTION_COMPONENTS_NOT_IN_SOLUTION_REQUEST,j.SolutionComponentsActionTypes.SEARCH_SOLUTION_COMPONENTS_NOT_IN_SOLUTION],fe),yield Object(a.takeLatest)(j.SolutionComponentsActionTypes.FETCH_SOLUTION_COMPONENT_ACTIONS_REQUEST,he),yield Object(a.takeLatest)(j.SolutionComponentsActionTypes.PAGE_SOLUTION_COMPONENTS,le),yield Object(a.takeLatest)(j.SolutionComponentsActionTypes.PAGE_SOLUTION_COMPONENTS_NOT_IN_SOLUTION,ce),yield Object(a.takeLatest)(j.SolutionComponentsActionTypes.REMOVE_COMPONENTS,Ae),yield Object(a.takeLatest)(j.SolutionComponentsActionTypes.ADD_SOLUTION_COMPONENTS_REQUEST,Te),yield Object(a.takeLatest)(j.SolutionComponentsActionTypes.ADD_UNAWARE_CANVAS_APPS_REQUEST,Ee),yield Object(a.takeLatest)(j.SolutionComponentsActionTypes.ADD_UNAWARE_CUSTOM_CONNECTORS_REQUEST,Ee),yield Object(a.takeLatest)(j.SolutionComponentsActionTypes.PUBLISH_CUSTOMIZATIONS_REQUEST,Re),yield Object(a.takeLatest)(j.SolutionComponentsActionTypes.ACTIVATE_COMPONENT_REQUEST,Ie),yield Object(a.takeLatest)(j.SolutionComponentsActionTypes.DEACTIVATE_COMPONENT_REQUEST,we),yield Object(a.takeLatest)(j.SolutionComponentsActionTypes.ADD_REQUIRED_COMPONENT_REQUEST,Le),yield Object(a.takeLatest)(j.SolutionComponentsActionTypes.DELETE_COMPONENTS,Ne),yield Object(a.takeLatest)(j.SolutionComponentsActionTypes.RIBBON_CUSTOMIZATION_REQUEST,De),yield Object(a.takeLatest)(j.SolutionComponentsActionTypes.FETCH_COMPONENT_MANAGED_PROPERTIES,Me),yield Object(a.takeLatest)(j.SolutionComponentsActionTypes.UPDATE_COMPONENT_MANAGED_PROPERTIES,xe),yield Object(a.takeLatest)(j.SolutionComponentsActionTypes.OPEN_DEDICATED_ADD_SUBCOMPONENTS_PANEL,ke),yield Object(a.takeLatest)(j.SolutionComponentsActionTypes.FETCH_SOLUTION_SLA_ENABLED_ENTITIES_REQUEST,Fe),yield Object(a.takeLatest)(j.SolutionComponentsActionTypes.ADD_UNAWARE_FLOWS_REQUEST,Ee),yield Object(a.takeLatest)(j.SolutionComponentsActionTypes.ADD_UNAWARE_DATAFLOWS_REQUEST,Ee),yield Object(a.takeLatest)(j.SolutionComponentsActionTypes.REFRESH_COMPONENTS_LIST,me),yield Object(a.takeLatest)(j.SolutionComponentsActionTypes.ADD_UNAWARE_POWER_BI_ARTIFACTS_REQUEST,Pe)}},5794:function(e,t,n){"use strict";n.r(t),n.d(t,"embedReportUri",(function(){return P})),n.d(t,"getAppId",(function(){return E})),n.d(t,"appConnectionsApiUrl",(function(){return T})),n.d(t,"appVersionsApiUrl",(function(){return j})),n.d(t,"appPermissionsUrl",(function(){return A})),n.d(t,"publishedAppSettingsUrl",(function(){return R})),n.d(t,"unpublishedAppSettingsUrl",(function(){return I})),n.d(t,"unpublishedAppDefinitionUrl",(function(){return w})),n.d(t,"renameAppUrl",(function(){return D})),n.d(t,"validateAppDisplayNameUrl",(function(){return N})),n.d(t,"appReportsUri",(function(){return L})),n.d(t,"appReportEmbedUri",(function(){return M})),n.d(t,"fetchAppListSaga",(function(){return x})),n.d(t,"fetchComponentLibrariesListSaga",(function(){return k})),n.d(t,"validateAppDisplayNameSaga",(function(){return K}));var o=n(5649),r=n(5596),a=n(5648),i=n(5795),s=n(5597),l=n(5749),c=n(5474),p=n(5768),u=n(5630),d=n(5470),m=n(5606),b=n(5796),g=n(2880),y=n(5797),S=n(5623),f=n(5604),h=n(5483),O=n(2869),C=n(5799),v=n(5760),P="{0}/generateEmbeddedReport";function E(e){return Object(g.formatResourceString)(s.appUrl,e)}function T(e){return"".concat(Object(g.formatResourceString)(s.appUrl,e),"/connections")}function j(e){return Object(g.formatResourceString)(s.appUrl,e)+"/versions"}function A(e){return"".concat(Object(g.formatResourceString)(s.appUrl,e),"/permissions")}function R(e){return"".concat(e,"/publishedSettings")}function I(e){return"".concat(e,"/unpublishedSettings")}function w(e){return"".concat(e,"?").concat("&$expand=unpublishedAppDefinition")}function D(e){return"".concat(e,"/displayName")}function N(e){return"/providers/Microsoft.PowerApps/environments/".concat(e,"/validateAppDisplayName")}function L(e){return Object(S.getListReportsPath)(e,"PowerApps")}function M(e){return Object(g.formatResourceString)(P,e.id)}function*x(e){var t,n=e.payload.appsListFilter,i=m.SagaContextProps.getCurrentEnvironment();try{switch(n){case r.AppListType.Editable:t=yield Object(l.select)(o.editableAppsListCachedStatusSelector,i.id);break;case r.AppListType.Org:t=yield Object(l.select)(o.orgAppsListCachedStatusSelector,i.id);break;case r.AppListType.SharedWithMe:t=yield Object(l.select)(o.sharedAppsListCachedStatusSelector,i.id);break;case r.AppListType.Recent:t=yield Object(l.select)(o.myAppsListCachedStatusSelector,i.id);break;case r.AppListType.SolutionUnaware:t=yield Object(l.select)(o.solutionUnawareAppsListCachedStatusSelector,i.id);break;default:t=null}var c=Object(r.getAppParameters)(i,n).$filter,u=m.SagaContextProps.getAadUser(),d={url:Object(h.getQueryUrl)(s.appQueryUrl,c,u.objectId)},b=yield Object(l.call)(v.default,e,d,t);if(!b)return null;Object(p.hasResponseError)(b)?yield Object(l.put)(Object(a.fetchAppsRejected)({error:{responseCode:Object(p.getResponseErrorCode)(b),errorMessage:Object(p.getResponseErrorMessage)(b)}})):yield Object(l.put)(Object(a.fetchAppsFulfilled)({apps:b&&b.data&&b.data.value,environmentId:i.id,appListType:n}))}catch(g){yield Object(l.put)(Object(a.fetchAppsRejected)({error:{responseCode:Object(p.getResponseErrorCode)(g),errorMessage:Object(p.getResponseErrorMessage)(g)}}))}}function*k(e){var t=m.SagaContextProps.getCurrentEnvironment(),n=yield Object(l.select)(o.componentLibrariesCachedStatusSelector,null==t?void 0:t.id);try{var i,c,u=Object(r.getComponentLibrariesParameters)(t).$filter,d={url:Object(h.getQueryUrl)(s.appQueryUrl,u,null===(i=m.SagaContextProps.getAadUser())||void 0===i?void 0:i.objectId)},b=yield Object(l.call)(v.default,e,d,n);if(!b)return null;Object(p.hasResponseError)(b)?yield Object(l.put)(Object(a.fetchComponentLibrariesRejected)({error:Object(p.getResponseErrorMessage)(b)})):yield Object(l.put)(Object(a.fetchComponentLibrariesFulfilled)({componentLibraries:null==b||null===(c=b.data)||void 0===c?void 0:c.value,environmentId:null==t?void 0:t.id}))}catch(g){yield Object(l.put)(Object(a.fetchComponentLibrariesRejected)({error:Object(p.getResponseErrorMessage)(g)}))}}function*F(e){yield Object(l.fork)(_,e),yield Object(l.put)(Object(a.fetchAppConnectionsRequest)({appName:e.payload.appName})),yield Object(l.put)(Object(b.fetchApisRequest)())}function*_(e){var t=e.payload.appName,n=e.payload.isAdminScope,i=E(t),c=yield Object(l.select)(o.appSelector,i),u=d.CachedStatusType.None;c&&(u=d.CachedStatusType.Done);var b,g=m.SagaContextProps.getCurrentEnvironment(),y=Object(r.getAppParameters)(g).$filter,S=m.SagaContextProps.getAadUser();if(n){var O=Object(f.getNameFromCurrentEnvironment)(g);b=Object(h.getQueryUrl)(Object(s.getAdminScopeAppUri)(O,t),"",S.objectId)}else b=Object(h.getQueryUrl)(i,y,S.objectId);var C={url:b},P=yield Object(l.call)(v.default,e,C,u);if(!P)return null;Object(p.hasResponseError)(P)?(yield Object(l.put)(Object(a.fetchAppRejected)({error:Object(p.getResponseErrorMessage)(P),appId:i})),yield Object(l.put)(Object(a.fetchAppDetailsRejected)({error:Object(p.getResponseErrorMessage)(P)}))):(yield Object(l.put)(Object(a.fetchAppFulfilled)({app:P.data})),yield Object(l.put)(Object(a.fetchAppDetailsFulfilled)({app:P.data})))}function*U(e){var t=e.payload.appName,n=yield Object(l.select)(o.appWithUnpublishedDraftSelector,t),r=d.CachedStatusType.None;n&&(r=d.CachedStatusType.Done);var i={url:w(t)},s=yield Object(l.call)(v.default,e,i,r);if(!s)return null;Object(p.hasResponseError)(s)?yield Object(l.put)(Object(a.fetchUnpublishedAppDefinitionRejected)({error:Object(p.getResponseErrorMessage)(s)})):yield Object(l.put)(Object(a.fetchUnpublishedAppDefinitionFulfilled)({app:s.data}))}function*V(e){var t=e.payload.appName,n=yield Object(l.select)(o.appConnectionIds,t),r=d.CachedStatusType.None;void 0===n||e.payload&&e.payload.forceRefresh||(r=d.CachedStatusType.Done);var i=m.SagaContextProps.getAadUser(),s={url:Object(h.getQueryUrl)(T(t),null,i.objectId)},c=yield Object(l.call)(v.default,e,s,r);if(!c)return null;Object(p.hasResponseError)(c)?yield Object(l.put)(Object(a.fetchAppConnectionsRejected)({appName:t,error:Object(p.getResponseErrorMessage)(c)})):yield Object(l.put)(Object(a.fetchAppConnectionsFulfilled)({appName:t,connections:c.data.value}))}function*B(e){var t=e.payload.appName,n=yield Object(l.select)(o.appVersionsSelector,t),r=d.CachedStatusType.None;void 0!==n&&(r=d.CachedStatusType.Done);var i={url:j(t)},s=yield Object(l.call)(v.default,e,i,r);if(!s)return null;Object(p.hasResponseError)(s)?yield Object(l.put)(Object(a.fetchAppVersionsRejected)({appName:t,error:Object(p.getResponseErrorMessage)(s)})):yield Object(l.put)(Object(a.fetchAppVersionsFulfilled)({appName:t,appVersions:s.data.value}))}function*H(e){yield Object(l.put)(Object(c.closeConfirmDialog)());var t=e.payload.appVersionListItem,n=Object(s.promoteAppVersionQueryUrl)(Object(y.getAppVersionId)(t&&t.appVersion)),o=Object(O.getResources)();try{var r={url:n,method:"POST"},i=yield Object(l.call)(v.default,e,r);if(!i)return null;Object(p.hasResponseError)(i)?yield Object(l.put)(Object(a.restoreAppVersionRejected)({message:Object(g.formatResourceString)(o.Apps.Versions.Modal.Restore.failure,Object(p.getResponseErrorMessage)(i))})):(yield Object(l.put)(Object(a.fetchAppVersionsRequest)({appName:e.payload&&e.payload.appName,forceRefresh:!0})),yield Object(l.put)(Object(a.restoreAppVersionFulfilled)({message:o.Apps.Versions.Modal.Restore.success})))}catch(u){yield Object(l.put)(Object(a.restoreAppVersionRejected)({message:Object(g.formatResourceString)(o.Apps.Versions.Modal.Restore.failure,Object(p.getResponseErrorMessage)(u))}))}}function*G(e){yield Object(l.put)(Object(c.closeConfirmDialog)());var t=e.payload.appVersionListItem,n=Object(y.getAppVersionId)(t&&t.appVersion),o=Object(O.getResources)();try{var r={url:n,method:"DELETE"},i=yield Object(l.call)(v.default,e,r);if(!i)return null;Object(p.hasResponseError)(i)?yield Object(l.put)(Object(a.deleteAppVersionRejected)({message:Object(g.formatResourceString)(o.Apps.Versions.Modal.Delete.failure,Object(p.getResponseErrorMessage)(i))})):(yield Object(l.put)(Object(a.fetchAppVersionsRequest)({appName:e.payload&&e.payload.appName,forceRefresh:!0})),yield Object(l.put)(Object(a.deleteAppVersionFulfilled)({message:o.Apps.Versions.Modal.Delete.success})))}catch(s){yield Object(l.put)(Object(a.deleteAppVersionRejected)({message:Object(g.formatResourceString)(o.Apps.Versions.Modal.Delete.failure,Object(p.getResponseErrorMessage)(s))}))}}function*W(e){var t=d.CachedStatusType.None,n={url:L(m.SagaContextProps.getCurrentEnvironment().name)},o=yield Object(l.call)(v.default,e,n,t);if(!o)return null;Object(p.hasResponseError)(o)?yield Object(l.put)(Object(a.fetchAppReportsRejected)({appName:e.payload.appName,error:Object(p.getResponseErrorMessage)(o)})):yield Object(l.put)(Object(a.fetchAppReportsFulfilled)({appName:e.payload.appName,appReports:o.data.value}))}function*q(e){var t=d.CachedStatusType.None,n=M(e.payload.appReport),o={aggregationValue:i.aggregationValue,aggregationType:i.aggregationType,resourceId:Object(g.formatResourceString)(s.appUrl,e.payload.appName)},r={url:n,method:"POST",data:JSON.stringify(o),headers:{"Content-Type":"application/json"}},c=yield Object(l.call)(v.default,e,r,t);if(!c)return null;Object(p.hasResponseError)(c)?yield Object(l.put)(Object(a.fetchAppReportEmbedDataRejected)({appName:e.payload.appName,error:Object(p.getResponseErrorMessage)(c)})):yield Object(l.put)(Object(a.fetchAppReportEmbedDataFulfilled)({currentEmbedData:{appName:e.payload.appName,report:e.payload.appReport,embedUrl:c.data.embedUrl,accessToken:c.data.accessToken}}))}function*z(e){var t=d.CachedStatusType.None,n=e&&e.payload,r=n&&n.appSettingsToUpdate,i=n&&n.appId,s=yield Object(l.select)(o.appWithUnpublishedDraftSelector,i),c=0,u=[R(i)];s&&u.push(I(i));for(var m=0;m<u.length;m++){var b={url:u[m],method:"PUT",data:JSON.stringify(r),headers:{"Content-Type":"application/json"}},g=yield Object(l.call)(v.default,e,b,t);if(!g)return null;Object(p.hasResponseError)(g)?yield Object(l.put)(Object(a.updateAppSettingsRejected)({error:Object(p.getResponseErrorMessage)(g)})):yield Object(l.put)(Object(a.updateAppSettingsFulFilled)({appId:i,appSettings:r,numberOfCalls:u.length,numberOfFulFilled:++c}))}}function*Q(e){var t,n=d.CachedStatusType.None;t=D(e.payload.appId);var o={displayName:e.payload.appDisplayName},r={url:t,method:"PUT",data:JSON.stringify(o),headers:{"Content-Type":"application/json"}},i=yield Object(l.call)(v.default,e,r,n);if(!i)return null;Object(p.hasResponseError)(i)?yield Object(l.put)(Object(a.renameAppRejected)({error:Object(p.getResponseErrorMessage)(i)})):yield Object(l.put)(Object(a.renameAppFulfilled)({appId:e.payload.appId,appDisplayName:e.payload.appDisplayName}))}function*K(e){var t=N(m.SagaContextProps.getCurrentEnvironment().name),n={displayName:e.payload.appDisplayName},o={url:t,method:"POST",data:JSON.stringify(n),headers:{"Content-Type":"application/json"}},r=yield Object(l.call)(v.default,e,o,d.CachedStatusType.None);return r?Object(p.hasResponseError)(r)?(yield Object(l.put)(Object(a.validateAppDisplayNameRejected)({error:Object(p.getResponseErrorMessage)(r)})),!1):Object(p.getValidateAppDisplayNameError)(r)?(yield Object(l.put)(Object(a.validateAppDisplayNameRejected)({error:Object(p.getValidateAppDisplayNameError)(r)})),!1):(yield Object(l.put)(Object(a.validateAppDisplayNameFulfilled)({appDisplayName:e.payload.appDisplayName})),!0):null}function*Y(e){var t=d.CachedStatusType.None,n={url:e.payload.appId,method:"DELETE",headers:{"Content-Type":"application/json"}},o=yield Object(l.call)(v.default,e,n,t);if(!o)return null;Object(p.hasResponseError)(o)?yield Object(l.put)(Object(a.deleteAppRejected)({errorMessage:Object(p.getResponseErrorMessage)(o)})):yield Object(l.put)(Object(a.deleteAppFulfilled)({appId:e.payload.appId,redirectUrl:e.payload.redirectUrl,navigate:e.payload.navigate}))}function*J(e){var t=d.CachedStatusType.None,n=e.payload.appName,o=C.publishAppVersion.eventName,r=Object(u.logScenarioActionStart)(e,C.publishAppVersion.eventName,C.publishAppVersion.getData(n)),i={url:"/providers/Microsoft.PowerApps/apps/".concat(n,"/publish"),method:"POST",headers:{"Content-Type":"application/json"}},s=yield Object(l.call)(v.default,e,i,t);if(!s)return yield Object(l.put)(Object(u.logActionFail)(Object(c.telemetryLogAction)(),o,r)),null;Object(p.hasResponseError)(s)?(yield Object(l.put)(Object(a.publishAppVersionRejected)({error:Object(p.getResponseErrorMessage)(s)})),yield Object(l.put)(Object(u.logActionFail)(Object(c.telemetryLogAction)(),o,r))):(yield Object(l.put)(Object(a.fetchAppVersionsRequest)({appName:n,forceRefresh:!0})),yield Object(l.put)(Object(a.publishAppVersionFulfilled)()),yield Object(l.put)(Object(u.logActionComplete)(Object(c.telemetryLogAction)(),o,r)))}t.default=function*(){yield Object(l.takeLatest)(a.AppsActionTypes.FETCH_APPS_REQUEST,x),yield Object(l.takeLatest)(a.AppsActionTypes.FETCH_COMPONENT_LIBRARIES,k),yield Object(l.takeLatest)(a.AppsActionTypes.FETCH_APP_REQUEST,_),yield Object(l.takeEvery)(a.AppsActionTypes.FETCH_APP_DETAILS_REQUEST,F),yield Object(l.takeEvery)(a.AppsActionTypes.FETCH_APP_CONNECTIONS_REQUEST,V),yield Object(l.takeEvery)(a.AppsActionTypes.FETCH_APP_VERSIONS_REQUEST,B),yield Object(l.takeEvery)(a.AppsActionTypes.FETCH_APP_REPORTS_REQUEST,W),yield Object(l.takeEvery)(a.AppsActionTypes.FETCH_CURRENT_REPORT_EMBED_DATA_REQUEST,q),yield Object(l.takeEvery)(a.AppsActionTypes.UPDATE_APP_SETTINGS_REQUEST,z),yield Object(l.takeEvery)(a.AppsActionTypes.FETCH_UNPUBLISHED_APP_DEFINITION_REQUEST,U),yield Object(l.takeEvery)(a.AppsActionTypes.RENAME_APP_REQUEST,Q),yield Object(l.takeLatest)(a.AppsActionTypes.VALIDATE_APP_DISPLAY_NAME_REQUEST,K),yield Object(l.takeEvery)(a.AppsActionTypes.DELETE_APP,Y),yield Object(l.takeEvery)(a.AppsActionTypes.RESTORE_APP_VERSION,H),yield Object(l.takeEvery)(a.AppsActionTypes.DELETE_APP_VERSION,G),yield Object(l.takeLatest)(a.AppsActionTypes.PUBLISH_APP_VERSION_REQUEST,J)}},5795:function(e,t,n){"use strict";n.r(t),n.d(t,"aggregationValue",(function(){return o})),n.d(t,"aggregationType",(function(){return r}));var o=30,r="Daily"},5796:function(e,t,n){"use strict";n.r(t),n.d(t,"ApisActionTypes",(function(){return o})),n.d(t,"fetchApisRequest",(function(){return s})),n.d(t,"fetchApisFulfilled",(function(){return l})),n.d(t,"fetchApisRejected",(function(){return c})),n.d(t,"fetchApisCancelPoll",(function(){return p})),n.d(t,"deleteApi",(function(){return u}));var o,r=n(5470);function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e){var t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({pollOptions:{shouldPoll:!0,pollStopAction:p()}},e);return{type:o.FETCH_APIS_REQUEST,payload:t}}function l(e){return e.normalizedResourceType=r.NormalizedResourceType.Apis,{type:o.FETCH_APIS_FULFILLED,payload:e}}function c(e){return{type:o.FETCH_APIS_REJECTED,payload:e}}function p(){return{type:o.FETCH_APIS_CANCEL_POLL}}function u(e){return{type:o.DELETE_API,payload:e}}!function(e){e.FETCH_APIS_REQUEST="maker/apis/FETCH_APIS_REQUEST",e.FETCH_APIS_FULFILLED="maker/apis/FETCH_APIS_FULFILLED",e.FETCH_APIS_REJECTED="maker/apis/FETCH_APIS_REJECTED",e.FETCH_APIS_CANCEL_POLL="maker/apis/FETCH_APIS_CANCEL_POLL",e.DELETE_API="maker/apis/DELETE_API"}(o||(o={}))},5797:function(e,t,n){"use strict";n.r(t),n.d(t,"getAppVersionId",(function(){return s})),n.d(t,"getAppIdFromAppVersion",(function(){return l})),n.d(t,"getLastModifiedByDisplayName",(function(){return c})),n.d(t,"getVersionLocaleString",(function(){return p})),n.d(t,"getClientVersion",(function(){return u})),n.d(t,"getLastPublishTime",(function(){return d})),n.d(t,"getCommitMessage",(function(){return m})),n.d(t,"getApp",(function(){return b})),n.d(t,"getActionableVersionsIndices",(function(){return g})),n.d(t,"isPublished",(function(){return y})),n.d(t,"isDraft",(function(){return S})),n.d(t,"getAppDefinition",(function(){return f})),n.d(t,"getPublishedAppSettings",(function(){return h})),n.d(t,"getAppName",(function(){return O})),n.d(t,"getStrippedAppVersion",(function(){return C})),n.d(t,"isAppVersionOld",(function(){return P}));var o=n(2812),r=n(5601),a=n(5798),i=n(5596);function s(e){return e&&e.id||""}function l(e){return v(e)&&e.properties.appDefinition&&e.properties.appDefinition.id?e.properties.appDefinition.id:""}function c(e){return v(e)&&e.properties.appDefinition&&e.properties.appDefinition.properties&&e.properties.appDefinition.properties.lastModifiedBy&&e.properties.appDefinition.properties.lastModifiedBy.displayName?e.properties.appDefinition.properties.lastModifiedBy.displayName:""}function p(e){return v(e)&&e.properties.appVersion?new Date(e.properties.appVersion).toLocaleString():""}function u(e){return v(e)?e.properties.createdByClientVersion:null}function d(e,t){return v(e)&&e.properties.lastPublishTime?Object(r.getSimpleDateString)(new Date(e.properties.lastPublishTime),t):""}function m(e){var t=f(e);return t?i.getAppCommitMessage(t):""}function b(e){return v(e)&&e.properties.appDefinition}function g(e){var t=Object(o.orderBy)(e,e=>v(e)?e.properties.appVersion:"","desc"),n=Object(o.findIndex)(t,y),r=Object(o.findIndex)(t,S),a=r>-1&&r<n;return{live:-1===n?-1:t.length-n,draft:a?t.length-r:-1}}function y(e){return v(e)&&e.properties.lifeCycleId===a.LifeCycleIdConstants.Published}function S(e){return v(e)&&e.properties.lifeCycleId===a.LifeCycleIdConstants.Draft}function f(e){return v(e)&&e.properties.appDefinition||null}function h(e){var t=f(e);return t?{displayName:i.getAppDisplayName(t),backgroundImageUri:i.getAppBackgroundImageUri(t),backgroundColor:i.getAppBackgroundColor(t),description:i.getAppDescription(t),imageUris:i.getAppImageUris(t),categoryDisplayNames:i.getAppCategoryDisplayNames(t)}:null}function O(e){return v(e)&&e.properties.appName||""}function C(e){return v(e)&&e.properties.appVersion&&e.properties.appVersion.replace(/:|-/g,"")||""}function v(e){return e&&!!e.properties}function P(e){if(e){var t=new Date(e.appVersion.properties.appVersion);return t.setMonth(t.getMonth()+6),t<new Date}return!1}},5798:function(e,t,n){"use strict";n.r(t),n.d(t,"LifeCycleIdConstants",(function(){return o}));var o={NotSpecified:"NotSpecified",AutoSaved:"AutoSaved",Draft:"Draft",Published:"Published"}},5799:function(e,t,n){"use strict";n.r(t),n.d(t,"publishAppVersion",(function(){return o})),n.d(t,"editAppSettingsClicked",(function(){return r})),n.d(t,"navigateToHelp",(function(){return a}));var o={eventName:"Apps.App.PublishModal.Publish",getData:e=>({appId:e})},r={eventName:"Apps.App.PublishModal.EditDetails.Clicked",getData:e=>({appId:e})},a={eventName:"Apps.App.PublishModal.LearnMore.Clicked",getData:e=>({appId:e})}},5800:function(e,t,n){"use strict";n.r(t),n.d(t,"fetchFlowsListSaga",(function(){return g}));var o=n(5749),r=n(5606),a=n(5597),i=n(5760),s=n(2880),l=n(5801),c=n(2872),p=n(5768),u=n(5593),d=n(5669);function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function b(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function*g(e){var t=r.SagaContextProps.getCurrentEnvironment(),n=e.payload.flowType,g={url:Object(s.formatResourceString)(a.flowsUri,t.name,n,c.settings.flowApiVersion)},y=d.SagaScenarioNames.fetchFlowsListSaga,S=Object(u.trackLoadScenario)(y,e.payload),f=yield Object(o.call)(i.default,e,g);try{if(!f)return null;if(f.error){var h=Object(p.getResponseErrorMessage)(f.error);yield Object(o.put)(Object(l.fetchFlowsRejected)({flowType:n,error:h})),Object(u.trackScenarioFailure)(y,{error:h},S)}else{switch(n){case l.FlowType.personal:default:yield Object(o.put)(Object(l.fetchFlowsFulfilled)({flowsList:{personal:{flows:f&&f.data&&f.data.value}},flowType:e.payload.flowType,environmentId:t.id}));break;case l.FlowType.team:yield Object(o.put)(Object(l.fetchFlowsFulfilled)({flowsList:{team:{flows:f&&f.data&&f.data.value}},flowType:e.payload.flowType,environmentId:t.id}))}Object(u.trackScenarioComplete)(y,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){b(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e.payload),S)}}catch(C){var O=Object(p.getResponseErrorMessage)(C);yield Object(o.put)(Object(l.fetchFlowsRejected)({flowType:n,error:O})),Object(u.trackScenarioFailure)(y,{error:O},S)}}t.default=function*(){yield Object(o.takeEvery)(l.FlowsActionTypes.FETCH_FLOWS_REQUEST,g)}},5801:function(e,t,n){"use strict";n.r(t),n.d(t,"FlowsActionTypes",(function(){return o})),n.d(t,"FlowType",(function(){return r})),n.d(t,"fetchFlowsRequest",(function(){return i})),n.d(t,"fetchFlowsFulfilled",(function(){return s})),n.d(t,"fetchFlowsRejected",(function(){return l}));var o,r,a=n(5470);function i(e){return{type:o.FETCH_FLOWS_REQUEST,payload:e}}function s(e){return e.normalizedResourceType=a.NormalizedResourceType.Flows,{type:o.FETCH_FLOWS_FULFILLED,payload:e}}function l(e){return{type:o.FETCH_FLOWS_REJECTED,payload:e}}!function(e){e.FETCH_FLOWS_REQUEST="maker/model/flows/FETCH_FLOWS_REQUEST",e.FETCH_FLOWS_FULFILLED="maker/model/flows/FETCH_FLOWS_FULFILLED",e.FETCH_FLOWS_REJECTED="maker/model/flows/FETCH_FLOWS_REJECTED"}(o||(o={})),function(e){e.personal="personal",e.team="team"}(r||(r={}))},5802:function(e,t,n){"use strict";n.r(t),n.d(t,"fetchApisSaga",(function(){return m}));var o=n(5749),r=n(5606),a=n(5604),i=n(5803),s=n(5760),l=n(5597),c=n(5483),p=n(5796),u=n(5807),d=n(5768);function*m(e){var t,n,m=r.SagaContextProps.getCurrentEnvironment(),b=yield Object(o.select)(u.apisListCachedStatusSelector,m.id),g=(null===(t=e.payload)||void 0===t||null===(n=t.requestOptions)||void 0===n?void 0:n.additionalFilters)||[];g.push(a.getFilterValueByEnvironment(m));var y=[...new Set(g)].join(" and "),S=r.SagaContextProps.getAadUser(),f={url:Object(c.getQueryUrl)(l.apisQueryUrl,y,S.objectId,{showApisWithToS:"true"})},h=yield Object(o.call)(s.default,e,f,b);if(!h)return null;if(Object(d.hasResponseError)(h))yield Object(o.put)(Object(p.fetchApisRejected)({error:Object(d.getResponseErrorMessage)(h)}));else{var O=h.data.value||[];O=O.filter(e=>!Object(i.isApiComposite)(e)),yield Object(o.put)(Object(p.fetchApisFulfilled)({apis:O,environmentId:m.id}))}}t.default=function*(){yield Object(o.takeLatest)(p.ApisActionTypes.FETCH_APIS_REQUEST,m)}},5816:function(e,t,n){"use strict";n.r(t),n.d(t,"createEnvVarResponseSelector",(function(){return s})),n.d(t,"modifyEnvVarResponseSelector",(function(){return l})),n.d(t,"createCurrentValueSelector",(function(){return c})),n.d(t,"modifyCurrentValueSelector",(function(){return p})),n.d(t,"envVariableSelector",(function(){return u})),n.d(t,"envVariablesNeedValueSelector",(function(){return d})),n.d(t,"envVariablesValuesInSolutionSelector",(function(){return m})),n.d(t,"envVariablesValuesNotInSolutionSelector",(function(){return b})),n.d(t,"fetchValuesResponseSelector",(function(){return g})),n.d(t,"fetchVarDataResponseSelector",(function(){return y}));var o=n(2812),r=n(2903),a=n(5810),i=n(5611),s=e=>e.envVariableData.createResponse,l=e=>e.envVariableData.modifyEnvironmentVariableResponse,c=e=>e.envVariableData.createCurrentValueResponse,p=e=>e.envVariableData.modifyCurrentValueResponse,u=(e,t)=>e.envVariableData.envVariableDefs.get(t),d=e=>e.envVariableData.envVariablesNeedValue,m=Object(r.memoizeFunction)((e,t,n,r)=>Object(o.filter)(e.envVariableData.envVariableValues.get(r),r=>Object(o.findIndex)(Object(a.solutionComponentListWithValuesSelector)(e,t,n,[i.StandardSolutionComponentTypes.EnvironmentVariableValue]),{msdyn_objectid:r.environmentvariablevalueid})>-1)),b=Object(r.memoizeFunction)((e,t,n,r)=>Object(o.filter)(e.envVariableData.envVariableValues.get(r),r=>!(Object(o.findIndex)(Object(a.solutionComponentListWithValuesSelector)(e,t,n,[i.StandardSolutionComponentTypes.EnvironmentVariableValue]),{msdyn_objectid:r.environmentvariablevalueid})>-1))),g=e=>e.envVariableData.fetchValuesResponse,y=e=>e.envVariableData.fetchVarDataResponse},5817:function(e,t,n){"use strict";n.r(t),n.d(t,"fetchDataflowsListSaga",(function(){return u}));var o=n(5749),r=n(5606),a=n(5760),i=n(5698),s=n(5768),l=n(5599),c=n(5597),p=n(5818);function*u(e){var t,n=r.SagaContextProps.getCurrentEnvironment();try{t=Object(l.getPowerQueryOnlineEndpoint)(n.location)}catch(b){return b.message}var u={url:"".concat(t).concat(c.powerQueryDataflowUrl,"?groupId=").concat(n.name)};e.payload.authOptions={shouldAddAuthHeader:!0,endpointUrl:Object(l.getPowerQueryOnlineResource)()};var d=yield Object(o.call)(a.default,e,u);if(!d||!d.data)return null;if(Object(s.hasResponseError)(d))yield Object(o.put)(Object(i.fetchDataflowsRejected)({error:Object(s.getResponseErrorMessage)(d.error)}));else{var m=d.data.map(e=>Object(p.addDataflowName)(e));yield Object(o.put)(Object(i.fetchDataflowsFulfilled)({dataflows:m,environmentId:n.id}))}}t.default=function*(){yield Object(o.takeEvery)(i.DataflowsActionTypes.FETCH_DATAFLOWS_REQUEST,u)}},5818:function(e,t,n){"use strict";function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e){return e&&e.properties&&e.properties.dataflowName||s(e)}function s(e){return e&&e.name||""}function l(e){return e&&e.id}function c(e){return r(r({},e),{},{properties:{dataflowName:e.name}})}n.r(t),n.d(t,"getDataflowDisplayName",(function(){return i})),n.d(t,"getDataflowName",(function(){return s})),n.d(t,"getDataflowId",(function(){return l})),n.d(t,"addDataflowName",(function(){return c}))},5822:function(e,t,n){"use strict";n.r(t),n.d(t,"createOptionBatch",(function(){return f})),n.d(t,"addOptionBatch",(function(){return h}));var o=n(2831),r=n(5749),a=n(5606),i=n(2868),s=n(5823),l=n(5686),c=n(5768),p=n(5792);function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){m(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function*b(e){var t,n=a.SagaContextProps.getCurrentEnvironment(),o=yield i.MetadataClientInstance.getInstance(),s=["BooleanOptionSet",{id:e.payload.optionSetId,solutionId:e.payload.solutionId},{columns:["Name","DisplayName","Description","MetadataId","IsCustomizable","IsCustomOptionSet","IsGlobal","IsManaged","IntroducedVersion","ExternalTypeName","OptionSetType","TrueOption","FalseOption"]}],p=["PicklistOptionSet",{id:e.payload.optionSetId,solutionId:e.payload.solutionId},{columns:["Name","DisplayName","Description","MetadataId","IsCustomizable","IsCustomOptionSet","IsGlobal","IsManaged","IntroducedVersion","ExternalTypeName","OptionSetType","Options"]}];if(e.payload.booleanOptionSet?t=o.fetch.apply(o,s):e.payload.booleanOptionSet||(t=o.fetch.apply(o,p)),t)try{var u=yield t;if(!u)return null;yield Object(r.put)(Object(l.fetchOptionSetFulfilled)({optionSet:u,context:e.payload.context}))}catch(b){yield Object(r.put)(Object(l.fetchOptionSetRejected)({environmentId:n.id,solutionId:e.payload.solutionId,error:Object(c.getResponseErrorMessage)(b)}))}else try{var d,m=yield[o.fetch.apply(o,p),o.fetch.apply(o,s)];if(!m)return null;d="Boolean"!==m[0].OptionSetType?m[0]:m[1],yield Object(r.put)(Object(l.fetchOptionSetFulfilled)({optionSet:d,context:e.payload.context}))}catch(b){yield Object(r.put)(Object(l.fetchOptionSetRejected)({environmentId:n.id,solutionId:e.payload.solutionId,error:Object(c.getResponseErrorMessage)(b)}))}}function*g(e){yield Object(r.put)(Object(l.fetchOptionSetFulfilled)({optionSet:Object(s.defaultOptionSet)(e.payload.context.envLanguageCode),context:e.payload.context}))}function*y(e){var t=a.SagaContextProps.getCurrentEnvironment();try{var n=yield i.MetadataClientInstance.getInstance();if(!(yield n.executeAction("PicklistOptionSet","Create",{solutionName:e.payload.solutionName},[d(d({},e.payload.optionSet),{},{OptionSetType:o.OptionSetType.Picklist})],{scenarioName:i.MCLTelemetryEventsMap.PAPortalPrefix})))return null;yield Object(r.all)([Object(r.put)(Object(l.clearOptionSet)({solutionId:e.payload.solutionId})),Object(r.fork)(p.refreshSolutionComponentsSaga)])}catch(s){yield Object(r.put)(Object(l.createOptionSetRejected)({environmentId:t.id,solutionId:e.payload.solutionId,error:Object(c.getResponseErrorMessage)(s)}))}}function*S(e){var t=a.SagaContextProps.getCurrentEnvironment();try{var n=yield i.MetadataClientInstance.getInstance();if(!f(n,e.payload.diff,e.payload.solutionName,e.payload.optionSetName,e.payload.updateOptionSet).submit({solutionName:e.payload.solutionName}))return null;yield Object(r.all)([Object(r.put)(Object(l.clearOptionSet)({solutionId:e.payload.solutionId})),Object(r.fork)(p.refreshSolutionComponentsSaga)])}catch(o){yield Object(r.put)(Object(l.updateOptionSetRejected)({environmentId:t.id,solutionId:e.payload.solutionId,error:Object(c.getResponseErrorMessage)(o)}))}}t.default=function*(){yield Object(r.takeLatest)(l.SolutionComponentsActionTypes.FETCH_OPTION_SET_REQUEST,b),yield Object(r.takeLatest)(l.SolutionComponentsActionTypes.UPDATE_OPTION_SET_REQUEST,S),yield Object(r.takeLatest)(l.SolutionComponentsActionTypes.CREATE_OPTION_SET_REQUEST,y),yield Object(r.takeLatest)(l.SolutionComponentsActionTypes.OPEN_CREATE_OPTION_SET,g)};var f=function(e,t,n,r,a){var s=i.MCLTelemetryEventsMap.PAPortalPrefix+"."+i.MCLTelemetryEventsMap.OptionSetUpdate;a&&a.OptionSetType===o.OptionSetType.Boolean?s+=".Boolean":a&&(s+=".Picklist");var l=e.createBatch({scenarioName:s});return a&&(a.OptionSetType===o.OptionSetType.Boolean?l.executeAction("BooleanOptionSet","Update",{solutionName:n},a):l.executeAction("PicklistOptionSet","Update",{solutionName:n},a)),h(l,t.create,"Create",r,n),h(l,t.update,"Update",r,n),h(l,t.del,"Delete",r,n),l};function h(e,t,n,o,r){t.forEach(t=>{e.executeAction("Option",n,{solutionName:r},d(d({},t),{},{OptionSetName:o}))})}},5823:function(e,t,n){"use strict";n.r(t),n.d(t,"OptionSetProvider",(function(){return S})),n.d(t,"defaultOptionSet",(function(){return f})),n.d(t,"toModel",(function(){return h})),n.d(t,"returnDiff",(function(){return C})),n.d(t,"toOption",(function(){return v}));var o=n(1697),r=n(3713),a=n(5824),i=n(5825),s=n(5826),l=n(5862),c=n(1105),p=n(245),u=n(2869);function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){b(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function b(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function g(){return(g=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}var y=Object(l.makeCDSTelemetryCallbacks)("powerapps-portal-option-set-provider"),S=e=>{var t,n,[l]=Object(p.useState)(Object(a.loaded)(function(e){return{name:e.Name,displayName:P(e.DisplayName)||e.Name,description:e.Description&&P(e.Description)||void 0,isCustom:e.IsCustomOptionSet,isCustomizable:(t=e.IsCustomizable,{value:t.Value,canBeChanged:t.CanBeChanged,managedPropertyLogicalName:t.ManagedPropertyLogicalName}),metadataId:e.MetadataId,scope:e.IsGlobal?"global":"local",isManaged:e.IsManaged,introducedVersion:e.IntroducedVersion,isBoolean:"Boolean"===e.OptionSetType,members:O(e,"Boolean"===e.OptionSetType)};var t}(e.optionSet))),{currentEnvironment:d}=Object(p.useContext)(c.EnvironmentContext),m=()=>!e.hasUpdateOptionSetsPrivilege&&!!e.optionSet&&!!e.optionSet.MetadataId&&"update"===b(),b=()=>e.optionSet.Name?"update":"create";return e.optionSet?p.createElement(s.OptionSetDesigner,g({},e,{optionSet:l,onUpdate:(t,n)=>{var o,{environmentLanguageCode:r}=e;t.description===n.description&&t.displayName===n.displayName||(o=h(t,r));var a=C(t.members,n.members,r);e.onUpdate(a,n.name,o)},onFetch:()=>{},useCdsLiteUX:Object(r.isCdsLiteContext)(d),notifications:(t=e.error,n=[],t&&n.push({contents:t,type:o.MessageBarType.error}),m()&&n.push({contents:Object(u.getResources)().DataversePortal.Privileges.missingUpdateOptionSetsPrivilege,type:o.MessageBarType.warning,isUndismissable:!0}),n),optionSetNameList:Object(a.loaded)([]),onSave:t=>{var{environmentLanguageCode:n,solutionName:o,environmentNamePrefix:r,xrmSolutionId:a}=e,s=h(Object(i.applyPrefix)(t,r),n);e.onCreate(o,a,s)},onDismiss:()=>{e.onDismiss&&e.onDismiss()},designerContext:b(),disableEditsForMissingUpdatePrivilege:m(),telemetryCallbacks:y})):null};function f(e){return{MetadataId:"",Name:"",DisplayName:E("",e),Description:E("",e),ExternalTypeName:"",IsCustomizable:T({managedPropertyLogicalName:void 0,value:!0,canBeChanged:!0}),IsCustomOptionSet:!0,IsGlobal:!0,IsManaged:!0,IntroducedVersion:"",OptionSetType:"Picklist",Options:[]}}function h(e,t){var n={Name:e.name,DisplayName:E(e.displayName,t),Description:e.description&&E(e.description,t)||void 0,IsCustomOptionSet:e.isCustom,IsCustomizable:T(e.isCustomizable),MetadataId:e.metadataId||void 0,IsManaged:e.isManaged,IntroducedVersion:e.introducedVersion,IsGlobal:"global"===e.scope,ExternalTypeName:e.externalTypeName};return e.isBoolean?m(m({},n),{},{OptionSetType:"Boolean",TrueOption:v(e.members[0],t),FalseOption:v(e.members[1],t)}):m(m({},n),{},{OptionSetType:"Picklist",Options:e.members.map(e=>v(e,t))})}function O(e,t){if(t){var n=e;return[n.TrueOption,n.FalseOption].map(e=>({value:e.Value,displayName:P(e.Label)||"",isManaged:e.IsManaged,description:e.Description?P(e.Description):void 0,color:e.Color,externalValue:e.ExternalValue}))}return e.Options.map(e=>({value:e.Value,displayName:P(e.Label)||"",isManaged:e.IsManaged,description:e.Description?P(e.Description):void 0,color:e.Color,externalValue:e.ExternalValue}))}function C(e,t,n){var o={create:[],update:[],del:[]},r={};return t.forEach(e=>{r[e.value]=e}),e.forEach(e=>{var t=r[e.value];t?t.displayName!==e.displayName?(o.update.push(v(e,n)),delete r[e.value]):delete r[e.value]:o.create.push(v(e,n))}),Object.keys(r).forEach(e=>{o.del.push(v(r[Number(e)],n))}),o}function v(e,t){return{Value:e.value,Label:E(e.displayName,t),Color:e.color,ExternalValue:e.externalValue,Description:e.description?E(e.description,t):void 0,IsManaged:void 0}}function P(e){return e.UserLocalizedLabel?e.UserLocalizedLabel.Label:void 0}function E(e,t){return{LocalizedLabels:[{Label:e,LanguageCode:t,MetadataId:void 0}],UserLocalizedLabel:void 0}}function T(e){return{Value:e.value,CanBeChanged:e.canBeChanged,ManagedPropertyLogicalName:e.managedPropertyLogicalName}}},5862:function(e,t,n){"use strict";n.r(t),n.d(t,"makeCDSTelemetryCallbacks",(function(){return a})),n.d(t,"makeLogCdsDataCallback",(function(){return i})),n.d(t,"makeLogCdsPortalErrorCallback",(function(){return s}));var o=n(217),r=n(241);function a(e){var t=s(e);return{logData:i(e),logError:t,trackScenarioStart:(t,n)=>n===r.ScenarioType.Create?Object(o.trackCreateScenario)(e,t):n===r.ScenarioType.Update?Object(o.trackUpdateScenario)(e,t):n===r.ScenarioType.Delete?Object(o.trackDeleteScenario)(e,t):Object(o.trackLoadScenario)(e,t),trackScenarioEnd:(e,t,n)=>{n?e.failure(t.data):e.complete(t.data)}}}var i=e=>t=>{Object(o.trackCustomEvent)(e,{eventName:t.eventName,eventData:t.data})},s=e=>t=>{Object(o.trackErrorTrace)(e,{eventName:t.eventName,eventData:t.data},new Error(t.data.errorMessage))}},5863:function(e,t,n){"use strict";n.r(t),n.d(t,"PowerVaActionsMiddleware",(function(){return g}));var o=n(5864),r=n(2837),a=n(5606),i=n(3713),s=n(2868),l=n(5468),c=n(5686);function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function m(e,t,n,o,r,a,i){try{var s=e[a](i),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(o,r)}function b(e){return function(){var t=this,n=arguments;return new Promise((function(o,r){var a=e.apply(t,n);function i(e){m(a,o,r,i,s,"next",e)}function s(e){m(a,o,r,i,s,"throw",e)}i(void 0)}))}}function g(){return e=>t=>function(){var n=b((function*(n){var s,p,d,m,b,g,S,f,h,O,C,v,P,E,T,j,A,R,I,w,D,N,L,M,x,{dispatch:k}=e,F=n,_=a.SagaContextProps.getCurrentEnvironment();switch(F.type){case c.SolutionComponentsActionTypes.OPEN_POWERVA_EDIT:M=yield y(),x=null!==(s=null==_||null===(p=_.properties)||void 0===p||null===(d=p.createdBy)||void 0===d?void 0:d.tenantId)&&void 0!==s?s:"";var U={pvaDomain:Object(o.getPvaDomainFromRealm)(M,x),cdsBotId:Object(i.getSolutionComponentObjectId)(null===(m=F.payload)||void 0===m?void 0:m.currentSelectedComponent),sourcePage:r.PowerAppsPage.solutions,environmentId:null!==(b=null==_?void 0:_.name)&&void 0!==b?b:"",targetPage:r.PvaPage.home,sourceElement:"row"};k(l.sharedActions.openNewTab({uri:Object(r.getPvaDeeplinkUrl)(null!==(g=F.payload)&&void 0!==g&&null!==(S=g.solution)&&void 0!==S&&S.ismanaged?U:u(u({},U),{},{action:r.DeeplinkAction.edit,solutionId:null!==(f=null===(h=F.payload)||void 0===h||null===(O=h.solution)||void 0===O?void 0:O.solutionid)&&void 0!==f?f:"",solutionUniqueName:null!==(C=null===(v=F.payload)||void 0===v||null===(P=v.solution)||void 0===P?void 0:P.uniquename)&&void 0!==C?C:""}))}));break;case c.SolutionComponentsActionTypes.CREATE_POWERVA_BOT:M=yield y(),x=null!==(E=null==_||null===(T=_.properties)||void 0===T||null===(j=T.createdBy)||void 0===j?void 0:j.tenantId)&&void 0!==E?E:"",k(l.sharedActions.openNewTab({uri:Object(r.getPvaDeeplinkUrl)({pvaDomain:Object(o.getPvaDomainFromRealm)(M,x),sourcePage:r.PowerAppsPage.solutions,environmentId:null!==(A=null==_?void 0:_.name)&&void 0!==A?A:"",targetPage:r.PvaPage.home,sourceElement:"solutionExplorer_newButton",action:r.DeeplinkAction.create,solutionId:null!==(R=null===(I=F.payload)||void 0===I||null===(w=I.solution)||void 0===w?void 0:w.solutionid)&&void 0!==R?R:"",solutionUniqueName:null!==(D=null===(N=F.payload)||void 0===N||null===(L=N.solution)||void 0===L?void 0:L.uniquename)&&void 0!==D?D:""})}))}return t(n)}));return function(e){return n.apply(this,arguments)}}()}var y=function(){var e=b((function*(){var e=s.MetadataClientInstance.getInstance(),t="";try{var n,r=yield e.retrieveFetchXmlResults({EntitySetName:"environmentvariabledefinitions",fetchXml:o.fetchXml});t=null==r||null===(n=r.value[0])||void 0===n?void 0:n.pvaRealm}catch(a){}return t}));return function(){return e.apply(this,arguments)}}()},5866:function(e,t,n){"use strict";n.r(t),n.d(t,"mapDispatchToProps",(function(){return d})),n.d(t,"mergeProps",(function(){return m})),n.d(t,"AdvancedCustomizationsPanelContainer",(function(){return b}));var o=n(5437),r=n(5487),a=n(5478),i=n(5474),s=n(5867),l=n(5583);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var d=(e,t)=>({onDismiss:()=>{e(Object(i.panelClose)({panelType:a.PanelToShowType.AdvancedCustomizationPanel}))},navigateToLearnMore:e=>{t.navigate(e,!0)}}),m=(e,t,n)=>{var{defaultPanelProps:o,rootProps:r}=n;return p(p(p({},e),t),{},{defaultPanelProps:o,currentEnvironment:r.currentEnvironment})},b=Object(l.withNavigation)(Object(r.withRootProps)(Object(o.connect)(null,d,m)(s.AdvancedCustomizationsPanel)))},5867:function(e,t,n){"use strict";n.r(t),n.d(t,"AdvancedCustomizationsPanel",(function(){return m}));var o=n(245),r=n(4013),a=n(687),i=n(1573),s=n(1090),l=n(2869),c=n(5604),p=n(5868),u=n(3831);function d(){return(d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}class m extends o.Component{constructor(e){super(e),this.resources=void 0,this.getFooterButtons=()=>[{primary:!0,ariaLabel:this.resources.Common.close,text:this.resources.Common.close,dismissableOnClick:this.props.onDismiss}],this.getLinks=()=>[{icon:"People",label:this.resources.AdvancedPane.CrmLink.Label.users,section:this.resources.AdvancedPane.CrmLink.Section.users,text:this.resources.AdvancedPane.CrmLink.Text.users,url:Object(c.getSecurityRolesUrl)(this.props.currentEnvironment)},{icon:"Lock",label:this.resources.AdvancedPane.CrmLink.Label.securityRoles,section:this.resources.AdvancedPane.CrmLink.Section.securityRoles,text:this.resources.AdvancedPane.CrmLink.Text.securityRoles,url:Object(c.getSecurityUsersUrl)(this.props.currentEnvironment)},{icon:"Color",label:this.resources.AdvancedPane.CrmLink.Label.themes,section:this.resources.AdvancedPane.CrmLink.Section.themes,text:this.resources.AdvancedPane.CrmLink.Text.themes,url:Object(c.getAllThemesUrl)(this.props.currentEnvironment)},{icon:"PreviewLink",label:this.resources.AdvancedPane.CrmLink.Label.publishers,section:this.resources.AdvancedPane.CrmLink.Section.publishers,text:this.resources.AdvancedPane.CrmLink.Text.publishers,url:Object(c.getAllPublishersUrl)(this.props.currentEnvironment)},{icon:"DeveloperTools",label:this.resources.AdvancedPane.CrmLink.Label.devResources,section:this.resources.AdvancedPane.CrmLink.Section.devResources,text:this.resources.AdvancedPane.CrmLink.Text.devResources,url:Object(c.getDevResourcesUrl)(this.props.currentEnvironment)}],this.onLearnMoreClick=()=>{this.props.navigateToLearnMore(u.RoutePaths.model.learn)},this.resources=Object(l.getResources)()}render(){var e,t,n;return this.props.currentEnvironment&&(Object(c.environmentHasCds2Database)(this.props.currentEnvironment)?(n=this.getLinks(),e=this.resources.AdvancedPane.LearnMore.Info.Dataverse2Db.text,t=this.resources.AdvancedPane.LearnMore.Link.text):(n=null,e=Object(c.canUserCreateDatabase)(this.props.currentEnvironment)?this.resources.AdvancedPane.LearnMore.Info.NoDataverse2Db.text:this.resources.AdvancedPane.LearnMore.Info.NoPermissionsForDb.text,t=null)),o.createElement(r.Panel,d({},this.props.defaultPanelProps,{headerText:this.resources.AdvancedPane.Subtitle.advancedCustomizations,onDismiss:this.props.onDismiss,closeButtonType:r.PanelCloseButtonType.Back,closeButtonAriaLabel:this.resources.Common.close,loadingOverlay:void 0,messageBar:void 0,type:i.PanelType.smallFixedFar,footerButtons:this.getFooterButtons()}),o.createElement("div",{className:p.customizationPanelStyles.container},o.createElement("div",{className:p.customizationPanelStyles.subHeadingSection},o.createElement("span",null," ",e," "),t&&o.createElement(s.Link,{href:"#",onClick:this.onLearnMoreClick},t)),n&&n.map((e,t)=>o.createElement("div",{key:t,className:p.customizationPanelStyles.linkContentSection},o.createElement("div",{className:p.customizationPanelStyles.titleSection},o.createElement("div",{className:p.customizationPanelStyles.titleSectionLeft},o.createElement(a.Icon,{iconName:e.icon,className:p.customizationPanelStyles.icon})),o.createElement("div",{className:p.customizationPanelStyles.titleSectionRight},e.label)),o.createElement("div",{className:p.customizationPanelStyles.contentSection},e.section),o.createElement("div",{className:p.customizationPanelStyles.linkSection},o.createElement(s.Link,{href:e.url,target:"_blank"},e.text," ",o.createElement(a.Icon,{className:p.customizationPanelStyles.icon,iconName:"NavigateExternalInline",title:e.text})))))))}}},5868:function(e,t,n){"use strict";n.r(t),n.d(t,"customizationPanelStyles",(function(){return i}));var o=n(719),r=n(5492),a=n(2882),i=Object(o.mergeStyleSets)({container:{fontFamily:r.fonts.segoeUi,lineHeight:"normal",fontSize:"14px"},subHeadingSection:{color:a.fabricColors.emperor},linkContentSection:{color:a.fabricColors.mineShaft,marginTop:"16px"},icon:{width:"16px",height:"16px",color:a.fabricColors.neutralPlum},titleSection:{color:a.fabricColors.mineShaft},titleSectionLeft:{marginTop:"2px",float:"left"},titleSectionRight:{marginBottom:"8px",marginLeft:"27px",fontWeight:"600"},contentSection:{paddingLeft:"25px",color:a.fabricColors.doveGray,marginTop:"4px"},linkSection:{paddingLeft:"25px",marginTop:"5px"}})},5869:function(e,t,n){"use strict";n.r(t),n.d(t,"_AppModuleSettingsPanel",(function(){return q})),n.d(t,"AppModuleSettingsPanel",(function(){return z}));var o=n(4013),r=n(245),a=n.n(r),i=n(1201),s=n(684),l=n(5583),c=n(5478),p=n(1864),u=n(5870),d=n(5871),m=n(2879),b=n(2871),g=n(5492),y=n(2880),S=n(5481),f=n(5468),h=n(5437),O=n(5880),C=n(5885),v=n(3144),P=n(5889),E=n(5890),T=n(923),j=n(5893),A=n(2807),R=n(1259),I=n(3185),w=n(2869),D=n(5896),N=n(5695),L=n(5898),M=n(5731),x=n(5732),k=n(1105),F=n(5901),_=n(5881);function U(){return(U=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}function V(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function B(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?V(Object(n),!0).forEach((function(t){H(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):V(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function H(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function G(e,t,n,o,r,a,i){try{var s=e[a](i),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(o,r)}function W(e){return function(){var t=this,n=arguments;return new Promise((function(o,r){var a=e.apply(t,n);function i(e){G(a,o,r,i,s,"next",e)}function s(e){G(a,o,r,i,s,"throw",e)}i(void 0)}))}}var q=e=>{var t=x.AppType.ModelApp,{t:n}=Object(T.useTranslation)("PowerappsPortal"),[l,C]=Object(r.useState)(!0),[v,P]=Object(r.useState)(!0),[E,D]=Object(r.useState)(!1),[V,H]=Object(r.useState)(!1),[G,q]=Object(r.useState)(!1),[z,Y]=Object(r.useState)(!1),J=Object(F.useAppModuleVersion)(),X=Object(w.getResources)(),Z=[{primary:!0,ariaLabel:n("Common.Save.save"),text:n("Common.Save.save"),dismissableOnClick:()=>{C(!0),he()},disabled:l},{ariaLabel:n("Common.Save.cancelAriaLabel"),text:n("Common.Save.cancel"),dismissableOnClick:()=>pe()}],{appModuleSetting:$,loading:ee,errorMessage:te}=Object(I.useRetrieveAppModuleSetting)("EnablePerAppLicenseBilling",e.selectedAppModuleUniqueName,e.selectedAppModuleId,A.PortalScope,X.Common.Request.Failed),{currentEnvironment:ne}=a.a.useContext(k.EnvironmentContext),oe=ne&&Object(k.checkVersions)(Object(k.getCrmVersion)(ne)||"","9.2.21101.00101")&&J,{powerSettings:re,loading:ae,errorMessage:ie}=Object(j.usePowerSettings)({variables:{appUniqueName:e.selectedAppModuleUniqueName,retrieveHidden:!0},telemetryScope:"PowerPlatformSettings",fetchPolicy:"no-cache"},e.selectedAppModuleId),{saveAppSetting:se,error:le}=Object(j.useSaveAppSetting)(A.PortalScope),{publishAppModule:ce}=Object(I.usePublishAppModule)(e.selectedAppModuleId,A.PortalScope,X.Common.Request.Failed),pe=Object(r.useCallback)(()=>{var t;e.billingSuccess.setValue(!1),null===(t=e.onClosePanel)||void 0===t||t.call(e),fe(f.sharedActions.panelClose({panelType:c.PanelToShowType.AppModuleSettingsPanel}))},[]);a.a.useEffect(()=>{e.isPayGoBehaviorEnabled&&function(e){return Q.apply(this,arguments)}(e.environmentClient).then(e=>{H(e)})},[]);var ue=[Object(L.toLoadingState)({isComplete:!1})];e.selectedAppModuleId&&e.selectedAppModuleName&&(ue=e.isPayGoBehaviorEnabled?[Object(L.toLoadingState)({isComplete:oe?!ae:!ee,errorMessage:oe?ie:te,name:"AppModuleSettingsLoad"}),Object(L.toLoadingState)({isComplete:!e.billingPolicyLoading,name:"BillingPolicyLoad"}),Object(L.toLoadingState)({isComplete:!e.loading,name:"AppPassesLoad"}),Object(L.toLoadingState)({isComplete:void 0!==V,name:"AdminAccessLoad"})]:[Object(L.toLoadingState)({isComplete:!0})]),Object(L.useLoadProgressTelemetry)({eventScope:A.PortalScope,scenarioName:Object(M.getFullTelemetryName)(x.featureName,x.AppSettingsTelemetryScenarios.Open),loadProgress:ue,generalInfo:{appType:t,appId:e.selectedAppModuleId}});var de,me,be,ge,ye,Se,fe=Object(h.useDispatch)(),he=function(){var n=W((function*(){if(Y(!1),e.isPayGoBehaviorEnabled&&E){q(!0);var n={appType:t,appId:e.selectedAppModuleId,perAppSetting:v},o=Object(M.sendPerformanceTelemetry)(B(B({},n),{},{stage:"SaveAndPublishStarted"}),x.featureName,x.AppSettingsTelemetryScenarios.Save);try{var r,a;yield null==se?void 0:se({variables:{settingName:"EnablePerAppLicenseBilling",value:"".concat(v),appUniqueName:e.selectedAppModuleUniqueName,solutionUniqueName:e.solutionUniqueName}}),o.progress(B(B({},n),{},{stage:"SaveCompleted"}));var i=yield null==ce?void 0:ce({variables:{appModuleId:e.selectedAppModuleId}});(null==i||null===(r=i.data)||void 0===r||null===(a=r.publishAppModuleById)||void 0===a?void 0:a.appModuleId)!==e.selectedAppModuleId?(o.completeWithError(B(B({},n),{},{stage:"PublishFailed",error:null==i?void 0:i.errors})),P(oe?K(null!=re?re:[],"EnablePerAppLicenseBilling"):Boolean(JSON.parse($.SettingDetail.Value))),fe(d.appModulesActions.saveAppModuleSettings({appModuleId:e.selectedAppModuleId}))):(o.complete(B(B({},n),{},{stage:"PublishCompleted"})),C(!0)),Y(!0)}catch(s){o.completeWithError(B(B({},n),{},{stage:"SaveAndPublishFailed",error:s}))}finally{q(!1)}}else pe()}));return function(){return n.apply(this,arguments)}}(),Oe=Object(r.useCallback)((e,t)=>{P(!!t),D(!0),C(!1)},[]);return Object(r.useMemo)(()=>{oe?!ae&&re&&P(K(null!=re?re:[],"EnablePerAppLicenseBilling")):!ee&&$&&P(Boolean(JSON.parse($.SettingDetail.Value)))},[ee,$,ae,re]),e.isPayGoBehaviorEnabled&&(te||le)&&(me=a.a.createElement(R.MessageBar,{messageBarType:R.MessageBarType.error,truncated:!0,isMultiline:!1},te||Object(N.extractErrorMessage)(le))),de=Object(L.isLoading)(ue)||G?a.a.createElement("div",{className:"app-settings-Spinner"},a.a.createElement(i.Spinner,{size:i.SpinnerSize.large,ariaLabel:n(G?"Controllers.App.Settings.savingAriaLabel":"Controllers.App.Settings.loadingAriaLabel"),role:"alert"})):a.a.createElement("div",{className:u.appModuleSettingsPanelStyleClasses.appSettings},a.a.createElement("div",{className:"app-settings-section"},a.a.createElement("label",{id:"lblAppDisplayName"},n("Controllers.AppSettings.appName")),a.a.createElement("div",{className:"app-name","aria-labelledby":"lblAppDisplayName"},e.selectedAppModuleName),a.a.createElement("div",{className:"app-settings-edit-app"},a.a.createElement(s.ActionButton,{href:"#",role:"link",onClick:()=>{return t=e.selectedAppModuleId,void fe(d.appModulesActions.editAppModule({appModuleId:t,solutionId:void 0,navigate:e.navigate,skipComponentsRefresh:e.skipComponentsRefresh}));var t},menuIconProps:{iconName:m.fabricIcons.OpenInNewWindow}},n("Controllers.AppSettings.AppName.editLinkModelDriven")))),e.isPayGoBehaviorEnabled?(ge=e.hasPerAppPlans||e.hasPerAppPlansForTeams,ye=e.billingPolicy,Se="Enabled"===(null==ye||null===(be=ye.powerAppsPolicy)||void 0===be?void 0:be.payAsYouGoState)&&ye.status!=_.BillingPolicyStatus.ProvisioningFailed,a.a.createElement(O.LicensingAndBillingSection,{appType:t,appId:e.selectedAppModuleId,isLoading:Object(L.isLoading)(ue),isPremium:!0,isAdmin:V,policy:ye,onCreateBillingPlan:()=>{return t=e.selectedAppModuleName,fe(f.sharedActions.panelOpen({panelType:c.PanelToShowType.BillingWizardPanel,panelProps:{appName:t}}));var t},toggle:Ce(ge,Se),hasPerAppPlan:ge,canConsumeAppPass:!0,isPayGo:Se,billingSuccess:e.billingSuccess})):b.featureGates.enablePerAppPlans&&a.a.createElement("div",{className:"app-settings-section"},a.a.createElement("div",{className:"app-settings-seperator"}),a.a.createElement("div",{className:"app-settings-header"},n("Controllers.AppSettings.PerAppPasses.title")),a.a.createElement("div",{className:"section-description"},Object(y.formatResourceStringAsLinks)(n("Controllers.AppSettings.PerAppPasses.description"),[S.default.perAppPlanLearnMore])),Ce())),a.a.createElement(o.Panel,U({},e.defaultPanelProps,{closeButtonAriaLabel:n("Common.close"),onDismiss:()=>{pe()},headerText:n("Controllers.App.Settings.title"),footerButtons:Z}),me,z&&a.a.createElement(R.MessageBar,{messageBarType:R.MessageBarType.success,isMultiline:!1,role:"alert",dismissButtonAriaLabel:n("Common.close"),onDismiss:()=>{Y(!1)}},n("Controllers.App.Settings.saveSuccess")),de);function Ce(t,o){return a.a.createElement(p.Toggle,{label:!e.isPayGoBehaviorEnabled&&n("Controllers.AppSettings.PerAppPasses.toggleHeader"),defaultChecked:!e.isPayGoBehaviorEnabled||v,onText:e.isPayGoBehaviorEnabled?n("Controllers.AppSettings.LicensingAndBilling.Toggle.onText"):n("Controllers.AppSettings.ToggleText.toggleOnText"),offText:e.isPayGoBehaviorEnabled?n("Controllers.AppSettings.LicensingAndBilling.Toggle.offText"):n("Controllers.AppSettings.ToggleText.toggleOffText"),onChange:Oe,styles:{label:{fontSize:"14px",fontFamily:g.fonts.segoeUiSemibold+" !important"}},disabled:!e.isPayGoBehaviorEnabled,ariaLabel:e.isPayGoBehaviorEnabled?n("Controllers.AppSettings.ToggleText.descriptionPerAppPasses"):n("Controllers.AppSettings.ToggleText.descriptionPayGo")})}},z=Object(P.withPayGoBehavior)(Object(v.withApolloClient)(Object(E.withBillingPolicyDetails)(Object(C.withLicenseBehavior)(Object(l.withNavigation)(q)))));function Q(){return(Q=W((function*(e){return yield Object(D.checkPermission)(e)}))).apply(this,arguments)}function K(e,t){var n="True",o=t.toLowerCase();return e.find(e=>{var t,r,a,i;null!=e&&null!==(t=e.name)&&void 0!==t&&null!==(r=t.toLowerCase())&&void 0!==r&&r.includes(o)&&(n=null!=e&&null!==(a=e.appOverrides[0])&&void 0!==a&&a.publishedValue?null==e||null===(i=e.appOverrides[0])||void 0===i?void 0:i.publishedValue:null==e?void 0:e.defaultValue)}),Boolean(JSON.parse(n))}},5870:function(e,t,n){"use strict";n.r(t),n.d(t,"appModuleSettingsPanelStyleClasses",(function(){return i}));var o=n(719),r=n(5492),a=n(2882),i=Object(o.mergeStyleSets)({appSettings:{selectors:{".app-settings-spinner .spinner":{top:"auto"},label:{font:"14px ".concat(r.fonts.segoeUi),maxWidth:"none",marginBottom:"5px"},".app-name":{marginTop:"8px",color:a.fabricColors.neutralChicago},".app-settings-section":{marginBottom:"12px"},".app-settings-header":{fontFamily:r.fonts.segoeUi,fontWeight:600,color:a.fabricColors.black,marginBottom:"5px"},".section-description":{fontSize:"14px",marginBottom:"8px",selectors:{a:{color:a.fabricColors.plum}}},".app-settings-seperator":{borderBottom:"1px solid ".concat(a.fabricColors.lighterGray),marginTop:"18px",marginBottom:"18px"},".app-settings-edit-app Button":{paddingLeft:"0",selectors:{".ms-Button-label":{marginLeft:"0",color:a.fabricColors.plum},i:{color:a.fabricColors.plum}}}}}})},5871:function(e,t,n){"use strict";n.r(t);var o=n(5653);n.d(t,"appModulesActions",(function(){return o}));var r=n(5872);n.d(t,"appModulesMiddlewares",(function(){return r}));var a=n(5811);n.d(t,"appModulesSelectors",(function(){return a}))},5872:function(e,t,n){"use strict";n.r(t);var o=n(5873);n.d(t,"AppModuleClientRootSaga",(function(){return o.AppModuleClientRootSaga}));var r=n(5874);n.d(t,"AppModuleClientSaga",(function(){return r.default}));var a=n(5875);n.d(t,"AppModuleGenericActionsMiddleware",(function(){return a.AppModuleGenericActionsMiddleware}));var i=n(5879);n.d(t,"AppModuleSpecificActionsMiddleware",(function(){return i.AppModuleSpecificActionsMiddleware}))},5873:function(e,t,n){"use strict";n.r(t),n.d(t,"AppModuleClientRootSaga",(function(){return a}));var o=n(5749),r=n(5871);function*a(){yield Object(o.all)([Object(o.fork)(r.appModulesMiddlewares.AppModuleClientSaga)])}},5874:function(e,t,n){"use strict";n.r(t),n.d(t,"appModuleSaga",(function(){return S}));var o=n(5749),r=n(5606),a=n(5604),i=n(5651),s=n(5758),l=n(2868),c=n(2869),p=n(2880),u=n(5653),d=n(5593),m=n(5669),b=n(5768),g=n(2831),y=i.AppModuleListType.Recent;function*S(e){y=e.payload.appModuleListFilter;var t=r.SagaContextProps.getCurrentEnvironment(),n=m.SagaScenarioNames.appModuleSaga,i=Object(d.trackLoadScenario)(n);try{var c=yield l.MetadataClientInstance.getInstance();Object(d.trackScenarioProgress)(n,{CurrentStep:"MCL instance retrieved"},i);var p=yield c.fetchList("AppModule",void 0,{columns:["uniquename","name","description","modifiedon","_createdby_value","publishedon","componentstate","statecode"]},{scenarioName:l.MCLTelemetryEventsMap.PAPortalPrefix});Object(d.trackScenarioProgress)(n,{CurrentStep:"List fetched"},i),(e&&e.payload).pollOptions&&(yield Object(o.spawn)(s.setupPolling,e));var g=[];if(p.data)for(g=p.data.map(e=>({id:e.appmoduleid,appmoduleid:e.appmoduleid,modifiedon:e.modifiedon,createdby:e["_createdby_value@OData.Community.Display.V1.FormattedValue"],stampedEnvironmentIdentifier:a.getEnvironmentIdentifier(t),uniquename:e.uniquename,name:e.name,publishedon:e.publishedon,componentstate:e.componentstate,statecode:e.statecode}));p.hasNext;)yield p.next(),g=p.data.map(e=>({id:e.appmoduleid,appmoduleid:e.appmoduleid,modifiedon:e.modifiedon,createdby:e["_createdby_value@OData.Community.Display.V1.FormattedValue"],stampedEnvironmentIdentifier:a.getEnvironmentIdentifier(t),uniquename:e.uniquename,name:e.name,publishedon:e.publishedon,statecode:e.statecode}));y=e.payload.appModuleListFilter,Object(d.trackScenarioComplete)(n,{appModulesLength:g.length},i),yield Object(o.put)(Object(u.fetchAppModulesFulfilled)({environmentId:t.id,appModules:g,appModuleListType:y}))}catch(S){Object(d.trackScenarioFailure)(n,{error:Object(b.getResponseErrorMessage)(S)},i),"403"===S.code?(y=e.payload.appModuleListFilter,yield Object(o.put)(Object(u.fetchAppModulesFulfilled)({environmentId:t.id,appModules:[],appModuleListType:y}))):yield Object(o.put)(Object(u.fetchAppModulesRejected)({environmentId:t.id,error:{responseCode:Object(b.getResponseErrorCode)(S),errorMessage:Object(b.getResponseErrorMessage)(S)}}))}}function*f(e){var t=Object(c.getResources)();try{var n=yield l.MetadataClientInstance.getInstance();yield n.executeAction("AppModule","Delete",void 0,e.payload.appModule,{scenarioName:l.MCLTelemetryEventsMap.PAPortalPrefix}),yield Object(o.put)(Object(u.deleteAppModuleSucceeded)({message:t.AppModules.Delete.successMessage,appModuleId:Object(i.getAppModuleId)(e.payload.appModule)})),yield Object(o.put)(Object(u.fetchAppModulesRequest)({appModuleListFilter:i.AppModuleListType.Recent}))}catch(r){yield Object(o.put)(Object(u.deleteAppModuleError)({message:Object(p.formatResourceString)(t.AppModules.Delete.errorMessage,Object(b.getResponseErrorMessage)(r))}))}}function*h(e){var t=Object(c.getResources)();try{var n=yield l.MetadataClientInstance.getInstance();yield n.executeAction("AppModule","Activate",void 0,{appmoduleid:e.payload.appModule.appmoduleid},{scenarioName:l.MCLTelemetryEventsMap.ModelDrivenAppActivate}).then(()=>{var t=[],o={msdyn_objectid:e.payload.appModule.appmoduleid,msdyn_componenttype:g.SolutionComponentTypeCode.AppModule,msdyn_subtype:"",msdyn_name:""};t.push(o),n.publishCustomizations(t,{scenarioName:l.MCLTelemetryEventsMap.ModelDrivenAppActivate})}),yield Object(o.put)(Object(u.activateAppModuleSucceeded)({message:t.AppModules.Activate.successMessage,appModuleId:Object(i.getAppModuleId)(e.payload.appModule)})),yield Object(o.put)(Object(u.fetchAppModulesRequest)({appModuleListFilter:i.AppModuleListType.Recent}))}catch(r){yield Object(o.put)(Object(u.activateAppModuleError)({message:Object(p.formatResourceString)(t.AppModules.Activate.errorMessage,Object(b.getResponseErrorMessage)(r))}))}}function*O(e){var t=Object(c.getResources)();try{var n=yield l.MetadataClientInstance.getInstance();yield n.executeAction("AppModule","Deactivate",void 0,{appmoduleid:e.payload.appModule.appmoduleid},{scenarioName:l.MCLTelemetryEventsMap.ModelDrivenAppDeactivate}).then(()=>{var t=[],o={msdyn_objectid:e.payload.appModule.appmoduleid,msdyn_componenttype:g.SolutionComponentTypeCode.AppModule,msdyn_subtype:"",msdyn_name:""};t.push(o),n.publishCustomizations(t,{scenarioName:l.MCLTelemetryEventsMap.ModelDrivenAppDeactivate})}),yield Object(o.put)(Object(u.deactivateAppModuleSucceeded)({message:t.AppModules.Deactivate.successMessage,appModuleId:Object(i.getAppModuleId)(e.payload.appModule)})),yield Object(o.put)(Object(u.fetchAppModulesRequest)({appModuleListFilter:i.AppModuleListType.Recent}))}catch(r){yield Object(o.put)(Object(u.deactivateAppModuleError)({message:Object(p.formatResourceString)(t.AppModules.Deactivate.errorMessage,Object(b.getResponseErrorMessage)(r))}))}}t.default=function*(){yield Object(o.takeEvery)(u.AppModulesActionTypes.FETCH_APPMODULES_REQUEST,S),yield Object(o.takeEvery)(u.AppModulesActionTypes.DELETE_APPMODULE,f),yield Object(o.takeEvery)(u.AppModulesActionTypes.ACTIVATE_APPMODULE,h),yield Object(o.takeEvery)(u.AppModulesActionTypes.DEACTIVATE_APPMODULE,O)}},5875:function(e,t,n){"use strict";n.r(t),n.d(t,"AppModuleGenericActionsMiddleware",(function(){return I}));n(303);var o=n(5656),r=n(5658),a=n(5606),i=n(5604),s=n(5478),l=n(5876),c=n(2869),p=n(2880),u=n(1101),d=n(5630),m=n(5605),b=n(1086),g=n(5877),y=n(5654),S=n(5468),f=n(5474),h=n(5653),O=n(2872),C=n(5609),v=n(5686),P=n(5611),E=n(5878),T=n(2868),j=n(5642),A=n(5731),R=n(5732);function I(){return e=>t=>n=>{var s,{dispatch:l}=e,d=n,T=e.getState(),I=a.SagaContextProps.getCurrentEnvironment(),D=i.getCrmInstanceUrl(I),N=Object(c.getResources)();switch(d.type){case h.AppModulesActionTypes.CREATE_APPMODULES:var L,M;if(!w(l,I,d.payload&&d.payload.sampleApp,T)&&D)if(u.featureGates.enableEditInShellAppDesigner&&d.payload.designerTarget===j.ModelAppDesignerTarget.Modern&&d.payload.navigate&&!d.payload.appName&&!d.payload.sampleApp)d.payload.navigate(Object(g.getAppModuleDesignerCreateUrl)(I.name,d.payload.solutionId));else l(S.sharedActions.openNewTab({uri:Object(m.getCreateNewAppModuleUrl)(D,null===(L=d.payload)||void 0===L?void 0:L.appName,null===(M=d.payload)||void 0===M?void 0:M.solutionId)}));d.payload&&d.payload.sampleApp&&Object(r.resolveSampleAppType)(d.payload.sampleApp.sampleAppType,d.payload.sampleApp.uniqueName)!==o.SampleAppTypes.PowerPortal&&l(Object(y.closeSampleAppModal)());break;case h.AppModulesActionTypes.PLAY_APPMODULE:s=d.payload.appModuleId,!w(l,I)&&D&&s&&l(S.sharedActions.openNewTab({uri:b.getPlayAppModuleUrl(D,s)}));break;case h.AppModulesActionTypes.ANALYTICS_APPMODULE:d.payload.navigate(Object(g.getMDAMakerEngagementHubLink)("Analytics",d.payload.appModule),!0);break;case h.AppModulesActionTypes.DETAILS_APPMODULE:d.payload.navigate(Object(g.getMDAMakerEngagementHubLink)("Details",d.payload.appModule),!0);break;case h.AppModulesActionTypes.RATINGS_APPMODULE:d.payload.navigate("insights/"+d.payload.appModule.appmoduleid+"/"+d.payload.appModule.uniquename+"/Ratings/"+d.payload.appModule.name+"/Model/",!0);break;case h.AppModulesActionTypes.RECORDINGS_APPMODULE:d.payload.navigate("insights/"+d.payload.appModule.appmoduleid+"/"+d.payload.appModule.uniquename+"/Recordings/"+d.payload.appModule.name+"/Model/",!0);break;case h.AppModulesActionTypes.EDIT_APPMODULE:if(s=d.payload.appModuleId,!w(l,I)&&D&&s){var x=d.payload.solutionId;if(u.featureGates.enableEditInShellAppDesigner&&d.payload.designerTarget===j.ModelAppDesignerTarget.Modern&&d.payload.navigate)d.payload.navigate(Object(g.getAppModuleDesignerEditUrl)(I.name,x,s));else{l(S.sharedActions.openNewTab({uri:b.getAppModuleDesignerUrl(D,s)}));var k=Object(C.getTypeStringFromSolutionComponentType)(P.StandardSolutionComponentTypes.AppModule,!1,!0);d.payload.skipComponentsRefresh||l(Object(f.openConfirmDialog)({hidden:!1,title:Object(p.formatResourceString)(N.Model.Solutions.Components.Edit.Dialog.title,k),subText:Object(p.formatResourceString)(N.Model.Solutions.Components.Edit.Dialog.subtext,k),confirmButtonText:N.Model.Solutions.Components.NewCommand.Dialog.closeButtonText,onConfirm:()=>{l(Object(f.closeConfirmDialog)()),l(Object(v.refreshComponentsList)())},hideCancelButton:!0}))}}break;case h.AppModulesActionTypes.SAVE_APPMODULE_SETTINGS:s=d.payload.appModuleId,D&&s&&l(Object(f.openConfirmDialog)({hidden:!1,title:N.Model.Solutions.Components.SaveAppModuleSettings.Dialog.title,subText:N.Model.Solutions.Components.SaveAppModuleSettings.Dialog.subText,confirmButtonText:N.Model.Solutions.Components.SaveAppModuleSettings.Dialog.confirmButtonText,cancelButtonText:N.Model.Solutions.Components.SaveAppModuleSettings.Dialog.cancelButtonText,onConfirm:()=>{Object(A.sendUsageTelemetry)(R.featureName,R.AppSettingsTelemetryScenarios.PublishNow,{appType:R.AppType.ModelApp,appId:s}),l(S.sharedActions.openNewTab({uri:b.getAppModuleDesignerUrl(D,s)})),l(Object(f.closeConfirmDialog)()),l(Object(v.refreshComponentsList)())},onCancel:()=>{Object(A.sendUsageTelemetry)(R.featureName,R.AppSettingsTelemetryScenarios.DoItLater,{appType:R.AppType.ModelApp,appId:s})},hideCancelButton:!1}));break;case h.AppModulesActionTypes.TEST_APPMODULE:var F=O.settings.testStudioEndpoint;l(S.sharedActions.openNewTab({uri:F}));break;case h.AppModulesActionTypes.MONITOR_APPMODULE:s=d.payload.appModuleId;var _=d.payload.displayName;if(!w(l,I)&&D&&s){var U=b.getPlayAppModuleUrl(D,s),V=Object(E.getLaunchAppInMonitorUrl)(I,"model",U,_,s);l(S.sharedActions.openNewTab({uri:V}))}}return t(n)}}function w(e,t,n,a){var p=i.environmentHasCds2Database(t),u=i.isDatabaseInProvisioningState(t),m=i.canUserCreateDatabase(t),b=Object(c.getResources)(),g=n&&Object(r.resolveSampleAppType)(n.sampleAppType,n.uniqueName),f=!1;try{T.MetadataClientInstance.getInstance()&&(f=!0)}catch(h){f=!1}if(u||p&&!f)e(S.sharedActions.openConfirmDialog({hidden:!1,title:b.Model.Home.Apps.DatabaseProvisioning.title,subText:b.Model.Home.Apps.DatabaseProvisioning.message,confirmButtonText:b.Controllers.Properties.okButton,onConfirm:()=>{e(S.sharedActions.closeConfirmDialog())},hideCancelButton:!0}));else if(p||m)if(!p&&m)e(S.sharedActions.openConfirmDialog({hidden:!1,title:b.Model.Home.Apps.NoDatabase.title,subText:b.Model.Home.Apps.NoDatabase.message,confirmButtonText:b.Controllers.Environments.Create.Database.create,cancelButtonText:b.Controllers.Properties.okButton,onConfirm:()=>{e(Object(d.logAction)(S.sharedActions.panelOpen({panelType:s.PanelToShowType.CreateXrmDatabasePanel,panelProps:{sampleAppType:g}}),l.CreateXrmDatabasePanelEvents.CreatePanelOpened.eventName)),e(S.sharedActions.closeConfirmDialog())},hideCancelButton:!1}));else{if(!p||!n||g!==o.SampleAppTypes.PowerPortal)return!1;e(Object(y.openSampleAppModal)({sampleApp:n}))}else e(S.sharedActions.openConfirmDialog({hidden:!1,title:b.Model.Home.Apps.NoPermissionsForDatabase.title,subText:b.Model.Home.Apps.NoPermissionsForDatabase.message,confirmButtonText:b.MakerDashboard.CreateEnvironment.text,cancelButtonText:b.Controllers.Properties.okButton,onConfirm:()=>{e(Object(d.logAction)(S.sharedActions.panelOpen({panelType:s.PanelToShowType.CreateEnvironmentPanel,panelProps:{sampleAppType:g}}),l.CreateEnvironmentPanelEvents.CreatePanelOpened.eventName)),e(S.sharedActions.closeConfirmDialog())},hideCancelButton:!1}));return!0}},5876:function(e,t,n){"use strict";n.r(t),n.d(t,"uiContextAdminMode",(function(){return o})),n.d(t,"CreateEnvironmentPanelEvents",(function(){return r})),n.d(t,"CreateXrmDatabasePanelEvents",(function(){return a}));var o={admin:"Admin Portal",maker:"Maker Portal"},r={CreatePanelOpened:{eventName:"Environments.Create.Modal.Opened"},CreatePanelClosed:{eventName:"Environments.Create.Modal.Closed"},CreateEnvironmentClick:{eventName:"Environments.Create.Modal.CreateEnvironment.Clicked"},CreateDatabaseClick:{eventName:"Environments.Create.Modal.CreateDatabase.Clicked"},InlineTrialSignUpClick:{eventName:"Inline.Trial.SignUp.Clicked"},FetchCdsOrgSettings:{eventName:"Environments.CdsOrgSettings.Fetch"}},a={CreatePanelOpened:{eventName:"XrmDatabases.Create.Modal.Opened"},CreatePanelClosed:{eventName:"XrmDatabases.Create.Modal.Closed"},CreateXrmDatabaseClicked:{eventName:"XrmDatabases.Create.CreateDatabase.Clicked"},InlineTrialSignUpClick:{eventName:"Inline.Trial.SignUp.Clicked"}}},5878:function(e,t,n){"use strict";n.r(t),n.d(t,"getLaunchAppInMonitorUrl",(function(){return r}));var o=n(2807);function r(e,t,n,r,a){return Object(o.getLaunchAppInMonitorUrl)(e.name,t,n,r,a)}},5879:function(e,t,n){"use strict";n.r(t),n.d(t,"AppModuleSpecificActionsMiddleware",(function(){return i}));var o=n(5478),r=n(5474),a=n(5653);function i(){return e=>t=>n=>{var i,s=n,{dispatch:l}=e;switch(s.type){case a.AppModulesActionTypes.SHARE_APPMODULE:i=s.payload.onClosePanel,l(r.panelOpen({panelType:o.PanelToShowType.AppModuleSharePanel,panelProps:{appModule:s.payload.appModule,onClosePanel:i}}));break;case a.AppModulesActionTypes.SHARE_APPMODULE_LEGACY:i=s.payload.onClosePanel,l(r.panelOpen({panelType:o.PanelToShowType.LegacyAppModuleSharePanel,panelProps:{appModule:s.payload.appModule,onClosePanel:i}}));break;case a.AppModulesActionTypes.OPEN_APPMODULE_SETTINGS:l(r.panelOpen({panelType:o.PanelToShowType.AppModuleSettingsPanel,panelProps:{selectedAppModuleId:s.payload.appModuleId,selectedAppModuleName:s.payload.appModuleName,selectedAppModuleUniqueName:s.payload.appModuleUniqueName,solutionUniqueName:s.payload.solutionUniqueName}}));break;case a.AppModulesActionTypes.EXPORT_APPMODULE_TEAMS:l(r.panelOpen({panelType:o.PanelToShowType.AppModuleTeamsExportPanel,panelProps:{selectedApp:s.payload.appModule,solutionId:s.payload.solutionId}}))}return t(n)}}},5880:function(e,t,n){"use strict";n.r(t),n.d(t,"LicensingAndBillingSection",(function(){return S}));var o=n(1259),r=n(245),a=n.n(r),i=n(2869),s=n(2880),l=n(5481),c=n(2879),p=n(5731),u=n(5732),d=n(5597),m=n(3199),b=n(2871),g=n(5881),y=n(5883),S=e=>{var t=Object(i.getResources)(),n=t.Controllers.AppSettings.LicensingAndBilling,{appType:S,appId:f,isLoading:h,isPremium:O,isAdmin:C,policy:v,hasPerAppPlan:P,canConsumeAppPass:E,isPayGo:T}=e,{allowListFeatures:j}=a.a.useContext(m.AllowListFeaturesContext),[A,R]=Object(r.useState)(!1),I=Object(r.useRef)(null);Object(r.useEffect)(()=>{h||Object(p.sendUsageTelemetry)(u.featureName,u.AppSettingsTelemetryScenarios.LicensingAndBillingSectionOpen,{appType:S,appId:f,isPremiumApp:O,isAdminUser:C,billingPolicyId:null==v?void 0:v.id,hasPerAppPlan:P,canConsumeAppPass:E,isPayGo:T})},[h]),Object(r.useEffect)(()=>{var e;(I.current||(I.current=Object(p.sendPerformanceTelemetry)(void 0,u.featureName,u.AppSettingsTelemetryScenarios.BillingPolicyStatus)),!h&&I.current)&&(v?v.status===g.BillingPolicyStatus.ProvisioningFailed?I.current.completeWithError({billingPolicyId:null==v?void 0:v.id,billingPolicyStatus:null==v?void 0:v.status,BillingPolicyProvisioningError:null==v||null===(e=v.billingInstrument)||void 0===e?void 0:e.provisioningError}):v.status===g.BillingPolicyStatus.Enabled&&I.current.complete({billingPolicyId:null==v?void 0:v.id,billingPolicyStatus:null==v?void 0:v.status}):I.current.complete())},[h,v]);var w,D=Object(r.useCallback)(()=>{e.onCreateBillingPlan&&e.onCreateBillingPlan(),Object(p.sendUsageTelemetry)(u.featureName,u.AppSettingsTelemetryScenarios.CreateBillingPlan,{appType:S,isPremiumApp:O,isAdminUser:C})},[h]),N=Object(r.useCallback)(e=>{Object(p.sendUsageTelemetry)(u.featureName,u.AppSettingsTelemetryScenarios.LearnMore,{appType:S,learnMoreLink:e})},[]),L=Object(r.useCallback)(()=>{Object(p.sendUsageTelemetry)(u.featureName,u.AppSettingsTelemetryScenarios.SeeBillingDetails,{appType:S,isPremiumApp:O,isAdminUser:C,billingPolicyId:null==v?void 0:v.id})},[h]),M=(e,t,n)=>a.a.createElement("div",{className:"section-description","data-automation-key":n},a.a.createElement("div",{className:"app-settings-header"},e),a.a.createElement("div",{className:"section-description"},t));return a.a.createElement("div",{className:"app-settings-section","data-automation-key":"licensing-billing-section"},!e.isSubSection&&a.a.createElement("div",{className:"app-settings-seperator"}),((n,r)=>{var i,s;if(b.featureGates.enablePayGoV1PolicyAPI&&j.EnablePayGoGAFeatures){var l,c;if((null==e||null===(l=e.policy)||void 0===l?void 0:l.status)===g.BillingPolicyStatus.Provisioning)return n||r(!0),a.a.createElement(o.MessageBar,{messageBarType:o.MessageBarType.success,isMultiline:!0,dismissButtonAriaLabel:t.Common.close},t.Controllers.AppSettings.LicensingAndBilling.SuccessBanner.connectingText);if((null==e||null===(c=e.policy)||void 0===c?void 0:c.status)==g.BillingPolicyStatus.ProvisioningFailed)return a.a.createElement(o.MessageBar,{messageBarType:o.MessageBarType.error,isMultiline:!0,dismissButtonAriaLabel:t.Common.close,onDismiss:()=>{e.billingSuccess.setValue(!1)}},a.a.createElement("span",null,t.Controllers.AppSettings.LicensingAndBilling.ErrorBanner.ErrorText,a.a.createElement(y.StyledAccordion,{text:t.Common.Request.SeeDetails,onRenderContent:()=>{var t,n;return a.a.createElement("div",null,null===(t=e.policy)||void 0===t||null===(n=t.billingInstrument)||void 0===n?void 0:n.provisioningError)}})))}if((null!=e&&null!==(i=e.billingSuccess)&&void 0!==i&&i.getValue()||n)&&(null==e||null===(s=e.policy)||void 0===s?void 0:s.status)===g.BillingPolicyStatus.Enabled)return a.a.createElement(o.MessageBar,{messageBarType:o.MessageBarType.success,isMultiline:!0,dismissButtonAriaLabel:t.Common.close,onDismiss:()=>{e.billingSuccess.setValue(!1)}},t.Controllers.AppSettings.LicensingAndBilling.SuccessBanner.connectedText);return null})(A,R),!T&&P&&(w=a.a.createElement(a.a.Fragment,null,n.AppPasses.Title.text,a.a.createElement(o.TooltipHost,{content:n.AppPasses.Title.tooltip},a.a.createElement(o.IconButton,{iconProps:{iconName:c.fabricIcons.Info},ariaLabel:"app-passes-description"}))),M(w,e.toggle)),(()=>{var t,r=n.PayGoSection.Title.text,i=a.a.createElement(o.TooltipHost,{content:O?n.PayGoSection.Title.Tooltip.premiumText:n.PayGoSection.Title.Tooltip.standardText},a.a.createElement(o.IconButton,{iconProps:{iconName:c.fabricIcons.Info},ariaLabel:O?n.PayGoSection.Title.Tooltip.premiumText:n.PayGoSection.Title.Tooltip.standardText})),p=Object(s.formatResourceStringAsLinks)(n.PayGoSection.Description.text,[l.default.payGoLearnMore],{onClick:()=>N(l.default.payGoLearnMore),target:"_blank","aria-label":n.PayGoSection.Description.learnMoreAriaLabel}),u=T?n.PayGoSection.ActionButton.PayGo.text:C?n.PayGoSection.ActionButton.NoPayGo.admin:n.PayGoSection.ActionButton.NoPayGo.nonAdmin,m=T?L:D;t=T&&Object(d.getBillingPoliciesPageUrl)(v.id,j.EnableBillingPoliciesUrlChange);var y,S={iconName:T?c.fabricIcons.Edit:c.fabricIcons.custom.caseSetting},f=!C;b.featureGates.enablePayGoV1PolicyAPI&&j.EnablePayGoGAFeatures&&(f=f||(null==e||null===(y=e.policy)||void 0===y?void 0:y.status)===g.BillingPolicyStatus.Provisioning);return a.a.createElement(a.a.Fragment,null,M(a.a.createElement(a.a.Fragment,null,r," ",i),a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{className:"section-description"},p),T&&e.toggle,(!T||C)&&a.a.createElement(o.ActionButton,{disabled:f,iconProps:S,onClick:m,href:T&&t,target:"_blank",style:{textAlign:"left"}},u))))})())}},5881:function(e,t,n){"use strict";n.r(t),n.d(t,"BillingPolicyApiVersion",(function(){return o})),n.d(t,"BillingPolicyStatus",(function(){return r})),n.d(t,"useGetAllBillingPolicies",(function(){return u})),n.d(t,"useAddBillingPolicy",(function(){return d})),n.d(t,"useAddBillingPolicyAndLinkEnvironments",(function(){return m}));var o,r,a=n(5882),i=n(217),s=n(245),l=n(3186),c=n(3192),p=n(3193);!function(e){e.v0_1_alpha="v0.1-alpha",e.v1_0="v1.0"}(o||(o={})),function(e){e.NotSpecified="NotSpecified",e.Enabled="Enabled",e.Disabled="Disabled",e.DisabledBySubscription="DisabledBySubscription",e.Deleted="Deleted",e.Provisioning="Provisioning",e.ProvisioningFailed="ProvisioningFailed"}(r||(r={}));var u=(e,t,n,o)=>{var[r,u]=Object(s.useState)(),[d,m]=Object(s.useState)(),{loading:b,data:g}=Object(l.useQuery)(a.GetAllBillingPoliciesGql,{client:e,variables:{apiVersion:t},fetchPolicy:"no-cache",onCompleted:e=>{var t;r&&(r.complete({billingPoliciesCount:null===(t=e.allBillingPolicies)||void 0===t?void 0:t.length}),u(void 0))},onError:e=>{var t=Object(c.getResponseMessageFromApolloError)(e,o);m(t),r&&(r.failure({error:t,clientError:e.message}),u(void 0))}});return Object(s.useEffect)(()=>{b&&u(Object(i.trackLoadScenario)(n,p.TelemetryScenarioNames.allBillingPoliciesGraphQl))},[b]),{loading:b,errorMessage:d,allBillingPolicies:null==g?void 0:g.allBillingPolicies}};function d(e,t,n,o,r){var[u,d]=Object(s.useState)(),[m,b]=Object(s.useState)(),[g,{loading:y,data:S}]=Object(l.useMutation)(a.PostAddBillingPolicyGql,{client:e,variables:{billingPolicy:t,apiVersion:n},onCompleted:e=>{u&&(u.complete({billingPolicy:t,data:e.addBillingPolicy}),d(void 0))},onError:e=>{var n=Object(c.getResponseMessageFromApolloError)(e,r);b(n),u&&(u.failure({error:n,clientError:e.message,billingPolicy:t}),d(void 0))}});return Object(s.useEffect)(()=>{y&&d(Object(i.trackLoadScenario)(o,p.TelemetryScenarioNames.addBillingPolicyGraphQl))},[y]),{loading:y,errorMessage:m,mutate:g,addBillingPolicy:null==S?void 0:S.addBillingPolicy}}var m=(e,t,n,o,r,u)=>{var[d,m]=Object(s.useState)(),[b,g]=Object(s.useState)(),[y,S]=Object(s.useState)(!1),[f,{loading:h}]=Object(l.useMutation)(a.PostAddBillingPolicyAndLinkEnvironmentsGql,{client:e,variables:{billingPolicy:t,environmentList:n,apiVersion:o},onCompleted:()=>{d&&(d.complete({billingPolicy:t,environmentList:n}),S(!0),m(void 0))},onError:e=>{var t=Object(c.getResponseMessageFromApolloError)(e,u);g(t),d&&(d.failure({error:t,clientError:e.message}),m(void 0))}});return Object(s.useEffect)(()=>{h&&m(Object(i.trackLoadScenario)(r,p.TelemetryScenarioNames.addBillingPolicyGraphQl))},[h]),{loading:h,errorMessage:b,addBillingPolicyAndLinkEnvironments:f,success:y}}},5882:function(e,t,n){"use strict";n.r(t),n.d(t,"GetAllBillingPoliciesGql",(function(){return c})),n.d(t,"PostAddBillingPolicyGql",(function(){return p})),n.d(t,"PostAddBillingPolicyAndLinkEnvironmentsGql",(function(){return u}));var o,r,a,i=n(3128),s=n.n(i);function l(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var c=s()(o||(o=l(["\n  query GetAllBillingPolicies($apiVersion: String!) {\n    allBillingPolicies(apiVersion: $apiVersion) {\n      id\n      name\n      type\n      status\n      powerAppsPolicy {\n        payAsYouGoState\n      }\n      billingInstrument {\n        subscriptionId\n        resourceGroup\n        location\n      }\n    }\n  }\n"]))),p=s()(r||(r=l(["\n  mutation PostAddBillingPolicy($billingPolicy: BillingPolicyInput!, $apiVersion: String!) {\n    addBillingPolicy(billingPolicy: $billingPolicy, apiVersion: $apiVersion) {\n      id\n      name\n      type\n      status\n      powerAppsPolicy {\n        payAsYouGoState\n      }\n      billingInstrument {\n        subscriptionId\n        resourceGroup\n        location\n        id\n        provisioningStatus\n        provisioningError\n      }\n    }\n  }\n"]))),u=s()(a||(a=l(["\n  mutation PostAddBillingPolicyAndLinkEnvironments(\n    $billingPolicy: BillingPolicyInput!\n    $environmentList: EnvironmentListInput!\n    $apiVersion: String!\n  ) {\n    addBillingPolicyAndLinkEnvironments(\n      billingPolicy: $billingPolicy\n      environmentList: $environmentList\n      apiVersion: $apiVersion\n    )\n  }\n"])))},5883:function(e,t,n){"use strict";n.r(t),n.d(t,"StyledAccordion",(function(){return i}));var o=n(5080),r=n(545),a=n(5884),i=Object(r.styled)(o.Accordion,a.styles)},5884:function(e,t,n){"use strict";n.r(t),n.d(t,"styles",(function(){return o}));var o=()=>({header:{fontSize:"10px",fontWeight:600,padding:0,background:"none",selectors:{"&:hover":{background:"none"},"&:active":{background:"none"}}},label:{margin:"0 8px"},content:{paddingTop:"10px"},menuIcon:{order:-1,fontWeight:600,margin:0,color:"#000"}})},5885:function(e,t,n){"use strict";n.r(t),n.d(t,"withLicenseBehavior",(function(){return u}));var o=n(245),r=n.n(o),a=n(5886),i=n(5888),s=n(2871),l=n(5593),c=n(2869);function p(){return(p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}function u(e){return function(t){var n,o=!1,u=null;if(s.featureGates.enablePerAppPlans){var d=Object(a.useEnvironmentAllocationQuery)(t.environmentClient,l.PortalScope,Object(c.getResources)().Common.Request.Failed);u=d.errorMessage,o=d.loading,n=d.environmentAllocation}return r.a.createElement(e,p({},t,{hasPerAppPlans:!u&&Object(i.hasAllocation)(n,a.AllocationEnvironmentCurrencyType.AppPass),hasPerAppPlansForTeams:!u&&Object(i.hasAllocation)(n,a.AllocationEnvironmentCurrencyType.AppPassForTeams),loading:o}))}}},5886:function(e,t,n){"use strict";n.r(t),n.d(t,"AllocationEnvironmentCurrencyType",(function(){return o})),n.d(t,"useEnvironmentAllocationQuery",(function(){return p}));var o,r=n(217),a=n(245),i=n(3186),s=n(3192),l=n(3193),c=n(5887);function p(e,t,n){var o=l.TelemetryScenarioNames.environmentAllocationGraphQl,[p,u]=Object(a.useState)(),[d,m]=Object(a.useState)(""),{loading:b,data:g}=Object(i.useQuery)(c.EnvironmentAllocationQueryService,{client:e||void 0,onCompleted:e=>{p&&(p.complete({environmentAllocationId:e&&e.environmentAllocation&&e.environmentAllocation.environmentId}),u(void 0))},onError:e=>{if(p){var t=Object(s.getResponseMessageFromApolloError)(e,n);p.failure({error:t,clientError:e&&e.message}),u(void 0),m(t)}}});return Object(a.useEffect)(()=>{u(Object(r.trackLoadScenario)(t,o))},[b]),{loading:b,errorMessage:d,environmentAllocation:g&&g.environmentAllocation}}!function(e){e.AppPass="AppPass",e.AppPassForTeams="AppPassForTeams",e.AI="AI",e.PortalLogins="PortalLogins",e.PortalViews="PortalViews",e.PerFlowPass="PerFlowPass",e.ApiCalls="ApiCalls"}(o||(o={}))},5887:function(e,t,n){"use strict";n.r(t),n.d(t,"EnvironmentAllocationQueryService",(function(){return s}));var o,r=n(3128);var a,i,s=n.n(r)()(o||(a=["\n  query environmentAllocation {\n    environmentAllocation {\n      environmentId\n      currencyAllocations {\n        currencyType\n        allocated\n      }\n    }\n  }\n"],i||(i=a.slice(0)),o=Object.freeze(Object.defineProperties(a,{raw:{value:Object.freeze(i)}}))))},5888:function(e,t,n){"use strict";function o(e,t){var n,o;return null!==(n=null==e||null===(o=e.currencyAllocations)||void 0===o?void 0:o.some(e=>e.allocated>0&&e.currencyType===t))&&void 0!==n&&n}n.r(t),n.d(t,"hasAllocation",(function(){return o}))},5889:function(e,t,n){"use strict";n.r(t),n.d(t,"withPayGoBehavior",(function(){return p}));var o=n(245),r=n.n(o),a=n(3199),i=n(2871),s=n(1105),l=n(5478);function c(){return(c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}function p(e){return function(t){var{allowListFeatures:n}=r.a.useContext(a.AllowListFeaturesContext),{currentEnvironment:o}=r.a.useContext(s.EnvironmentContext),p=t,u=p&&p.panelType,d=!1;u===l.PanelToShowType.AppModuleSettingsPanel&&(d=o&&Object(s.checkVersions)(Object(s.getCrmVersion)(o)||"","9.2.21082.00125"));var m=u===l.PanelToShowType.AppSettingsPanel?i.featureGates.enablePayGoForCanvasApp&&n.EnablePayGoForCanvasAppInMakerPortal:u===l.PanelToShowType.AppModuleSettingsPanel?i.featureGates.enablePayGoForModelApp&&n.EnablePayGoForModelAppInMakerPortal&&d:i.featureGates.enablePayGoForPortalApp&&n.EnablePayGoForPortalsAppInMakerPortal;return r.a.createElement(e,c({},p,{isPayGoBehaviorEnabled:i.featureGates.forceEnablePayGo||m&&(Object(s.isProdEnvironment)(o)||Object(s.isSandboxEnvironment)(o))}))}}},5890:function(e,t,n){"use strict";n.r(t),n.d(t,"withBillingPolicyDetails",(function(){return d}));var o=n(245),r=n.n(o),a=n(2871),i=n(5891),s=n(2807),l=n(2869),c=n(5881),p=n(3199);function u(){return(u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}function d(e){return function(t){var n,d,m,b,g,y,S=c.BillingPolicyApiVersion.v0_1_alpha,[f,h]=Object(o.useState)(!1),{allowListFeatures:O}=r.a.useContext(p.AllowListFeaturesContext);a.featureGates.enablePayGoV1PolicyAPI&&O.EnablePayGoGAFeatures&&(S=c.BillingPolicyApiVersion.v1_0,f||(y=15e3));var C=Object(i.useGetBillingPolicyForCurrentEnvironment)(t.environmentClient,S,y,s.PortalScope,Object(l.getResources)().Common.Request.Failed);return m=C.loading,b=C.errorMessage,g=C.billingPolicyForEnvironment,m||f||null==C||null===(n=C.billingPolicyForEnvironment)||void 0===n||!n.status||(null==C||null===(d=C.billingPolicyForEnvironment)||void 0===d?void 0:d.status)==c.BillingPolicyStatus.Provisioning||h(!0),r.a.createElement(e,u({},t,{billingPolicy:!b&&g,billingPolicyLoading:m}))}}},5891:function(e,t,n){"use strict";n.r(t),n.d(t,"useAddEnvironmentsToBillingPolicy",(function(){return p})),n.d(t,"useGetBillingPolicyForCurrentEnvironment",(function(){return u}));var o=n(5892),r=n(217),a=n(245),i=n(3186),s=n(3192),l=n(3193),c=n(3152);function p(e,t,n,i,p,u){var d=l.TelemetryScenarioNames.addEnvironmentsToBillingPolicyGraphQl,[m,b]=Object(a.useState)(),[g,y]=Object(a.useState)(""),[S,{loading:f}]=Object(c.useMutation)(o.PostAddEnvironmentsToBillingPolicyGql,{client:e,variables:{billingPolicyId:t,environmentList:n,apiVersion:i},onCompleted:()=>{m&&(m.complete({billingPolicyId:t,environmentList:n}),b(void 0))},onError:e=>{var o=Object(s.getResponseMessageFromApolloError)(e,u);y(o),m&&(m.failure({error:o,clientError:e&&e.message,billingPolicyId:t,environmentList:n}),b(void 0))}});return Object(a.useEffect)(()=>{f&&b(Object(r.trackLoadScenario)(p,d))},[f]),{loading:f,errorMessage:g,mutate:S}}function u(e,t,n,c,p){var[u,d]=Object(a.useState)(),[m,b]=Object(a.useState)(),{loading:g,data:y}=Object(i.useQuery)(o.GetBillingPolicyForEnvironmentGql,{client:e,variables:{apiVersion:t},fetchPolicy:"no-cache",pollInterval:n,onCompleted:e=>{u&&(u.complete({data:e.billingPolicyForEnvironment}),d(void 0))},onError:e=>{var t=Object(s.getResponseMessageFromApolloError)(e,p);b(t),u&&(u.failure({error:t,clientError:e.message}),d(void 0))}});return Object(a.useEffect)(()=>{g&&d(Object(r.trackLoadScenario)(c,l.TelemetryScenarioNames.billingPolicyForEnvironment))},[g,c]),{loading:g,errorMessage:m,billingPolicyForEnvironment:null==y?void 0:y.billingPolicyForEnvironment}}},5892:function(e,t,n){"use strict";n.r(t),n.d(t,"PostAddEnvironmentsToBillingPolicyGql",(function(){return l})),n.d(t,"GetBillingPolicyForEnvironmentGql",(function(){return c}));var o,r,a=n(3128),i=n.n(a);function s(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var l=i()(o||(o=s(["\n  mutation PostAddEnvironmentsToBillingPolicy(\n    $billingPolicyId: String!\n    $environmentList: EnvironmentListInput!\n    $apiVersion: String!\n  ) {\n    addEnvironmentsToBillingPolicy(\n      billingPolicyId: $billingPolicyId\n      environmentList: $environmentList\n      apiVersion: $apiVersion\n    )\n  }\n"]))),c=i()(r||(r=s(["\n  query GetBillingPolicyForEnvironment($apiVersion: String!) {\n    billingPolicyForEnvironment(apiVersion: $apiVersion) {\n      id\n      name\n      type\n      status\n      powerAppsPolicy {\n        payAsYouGoState\n      }\n      billingInstrument {\n        subscriptionId\n        resourceGroup\n        location\n        id\n        provisioningStatus\n        provisioningError\n      }\n    }\n  }\n"])))},5896:function(e,t,n){"use strict";n.r(t),n.d(t,"checkPermission",(function(){return i}));var o=n(5897);function r(e,t,n,o,r,a,i){try{var s=e[a](i),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(o,r)}function a(e){return function(){var t=this,n=arguments;return new Promise((function(o,a){var i=e.apply(t,n);function s(e){r(i,o,a,s,l,"next",e)}function l(e){r(i,o,a,s,l,"throw",e)}s(void 0)}))}}function i(e){return s.apply(this,arguments)}function s(){return(s=a((function*(e){var{data:t}=yield e.query({query:o.BapCheckAccessAPIQuery,variables:{permissionNameList:{accessPermissions:[{name:"AdminReadEnvironment"}]}}});return null==t?void 0:t.checkAccess.accessPermissions[0].hasAccess}))).apply(this,arguments)}},5897:function(e,t,n){"use strict";n.r(t),n.d(t,"BapCheckAccessAPIQuery",(function(){return s}));var o,r=n(3128);var a,i,s=n.n(r)()(o||(a=["\n  query BapCheckAccess($permissionNameList: BapCheckAccessInput!) {\n    checkAccess(permissionNameList: $permissionNameList) {\n      accessPermissions {\n        name\n        hasAccess\n        displayName\n        errorCode\n      }\n    }\n  }\n"],i||(i=a.slice(0)),o=Object.freeze(Object.defineProperties(a,{raw:{value:Object.freeze(i)}}))))},5901:function(e,t,n){"use strict";n.r(t),n.d(t,"useEnvironmentCapabilities",(function(){return c})),n.d(t,"useAppModuleVersion",(function(){return p}));var o=n(245),r=n(3076),a=n(1105),i=n(5902),s=n(3193),l=n(5805),c=()=>{var{environmentClient:e}=Object(o.useContext)(r.ApolloClientContext),{currentEnvironment:t}=Object(o.useContext)(a.EnvironmentContext),[n,c]=Object(o.useState)(new Map),p=t&&Object(a.environmentHasCds2Database)(t)&&e,{solutionVersionMap:u}=Object(i.useCdsOrganizationInfoSolutions)(e,l.FEATURE_SOLUTION_UNIQUE_NAMES,s.PortalTelemetryScope,void 0,!p);return Object(o.useEffect)(()=>{c(Object(l.convertToEnvironmentCapabilities)(u))},[u]),n},p=()=>{var{environmentClient:e}=Object(o.useContext)(r.ApolloClientContext),{currentEnvironment:t}=Object(o.useContext)(a.EnvironmentContext),n=t&&Object(a.environmentHasCds2Database)(t)&&e,{solutionVersionMap:c}=Object(i.useCdsOrganizationInfoSolutions)(e,l.APP_MODULE_SOLUTION_UNIQUE_NAMES,s.PortalTelemetryScope,void 0,!n);return Object(l.isAppModuleVersionSupported)(c)}},5902:function(e,t,n){"use strict";n.r(t),n.d(t,"useCdsOrganizationInfoSolutions",(function(){return c}));var o=n(217),r=n(245),a=n(3186),i=n(3192),s=n(3193),l=n(5903);function c(e,t,n,c){var p=arguments.length>4&&void 0!==arguments[4]&&arguments[4],u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"cache-first";p=p||!e||!t||0===t.size;var d=s.TelemetryScenarioNames.cdsOrganizationInfoSolutions,[m,b]=Object(r.useState)(),[g,y]=Object(r.useState)(""),[S,f]=Object(r.useState)(new Map),{loading:h}=Object(a.useQuery)(l.organizationInfoSolutionsQuery,{client:e||void 0,skip:p,fetchPolicy:u,onCompleted:e=>{var n;m&&(m.complete({solutionsSize:null==e||null===(n=e.organizationInfoSolutions)||void 0===n?void 0:n.length}),b(void 0));var o=null==e?void 0:e.organizationInfoSolutions;if(o){var r=new Map;o.forEach(e=>{e.solutionUniqueName&&e.solutionUniqueName.length>0&&e.versionNumber&&e.versionNumber.length>0&&t.has(e.solutionUniqueName)&&r.set(e.solutionUniqueName,e.versionNumber)}),f(r)}},onError:e=>{var t=Object(i.getResponseMessageFromApolloError)(e,c);y(t),m&&(m.failure({error:t,clientError:e&&e.message}),b(void 0))}});return Object(r.useEffect)(()=>{h&&b(Object(o.trackLoadScenario)(n,d))},[h]),{loading:h,errorMessage:g,solutionVersionMap:S}}},5903:function(e,t,n){"use strict";n.r(t),n.d(t,"organizationInfoSolutionsQuery",(function(){return s}));var o,r=n(3128);var a,i,s=n.n(r)()(o||(a=["\n  query getOrganizationInfoSolutions {\n    organizationInfoSolutions {\n      versionNumber\n      solutionUniqueName\n    }\n  }\n"],i||(i=a.slice(0)),o=Object.freeze(Object.defineProperties(a,{raw:{value:Object.freeze(i)}}))))},5949:function(e,t,n){"use strict";n.r(t);var o=n(5950);n.d(t,"AppWrapPanelContainer",(function(){return o.AppWrapPanelContainer})),n.d(t,"AppWrapPanel",(function(){return o.AppWrapPanel}))},5950:function(e,t,n){"use strict";n.r(t),n.d(t,"AppWrapPanelContainer",(function(){return D})),n.d(t,"AppWrapPanel",(function(){return x}));var o=n(5080),r=n(1259),a=n(2812),i=n(1654),s=n(719),l=n(1144),c=n(2836),p=n(245),u=n.n(p),d=n(5951),m=n(5952),b=n(5966),g=n(5968),y=n(5953),S=n(5969),f=n(5970),h=n(5972),O=n(5973),C=n(5974),v=n(5976);function P(){return(P=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}function E(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function T(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?E(Object(n),!0).forEach((function(t){j(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function j(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function A(e,t,n,o,r,a,i){try{var s=e[a](i),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(o,r)}function R(e){return function(){var t=this,n=arguments;return new Promise((function(o,r){var a=e.apply(t,n);function i(e){A(a,o,r,i,s,"next",e)}function s(e){A(a,o,r,i,s,"throw",e)}i(void 0)}))}}Object(i.initializeIcons)();var I=/\/([\w-]+)$/;function w(e){var t,n="string"==typeof e?e:e.id,o=null===(t=n.match(I))||void 0===t?void 0:t[1];return e&&!o&&Object(y.logError)("FailedToGetAppId",{appOrString:e,idStringToParse:n}),o}var D=Object(l.withHttpClient)(e=>{var{httpClient:t,onDismiss:n,canvasApps:o,selectedApp:r}=e,[a,i]=Object(p.useState)(!0),[s,l]=Object(p.useState)(void 0),[f,h]=Object(p.useState)(void 0),O=w(r.id),[C,v]=Object(p.useState)(void 0),[P,E]=Object(p.useState)(void 0),[T,j]=Object(p.useState)("none"),A=function(){var e=R((function*(e,n,o){try{if(O){j("saving"),null!=s&&s.msdyn_mobileappid?Object(y.logInfo)("UpdateMobileRecordAndImages_Start"):Object(y.logInfo)("CreateMobileRecordAndImages_Start");var r=yield Object(b.createOrUpdateMobileAppRecord)(t,e,O,n,o,null==s?void 0:s.msdyn_mobileappid),a=yield Object(b.uploadImages)(t,r.msdyn_mobileappid,e);l(r),h(a),Object(y.logInfo)("CreateOrUpdateMobileRecordAndImages_Success",{appId:O,mobileAppRecord:r,images:a}),j("saved")}else{Object(y.logError)("CreateOrUpdateMobileRecordAndImages_Failed",{appId:O,errorMessage:"Failed to save. No app id found."}),alert("Failed to save. No app id found."),j("failed")}}catch(i){Object(y.logError)("CreateOrUpdateMobileRecordAndImages_Failed",{appId:O,error:i}),alert("Failed to save: ".concat(Object(d.responseErrorMessageOrError)(i))),j("failed")}}));return function(t,n,o){return e.apply(this,arguments)}}(),I=function(){var e=R((function*(e,n){if(s)try{j("building"),Object(y.logInfo)("BuildCreate_Start",{androidApiToken:!!e,iOSApiToken:!!n});var o=yield Object(b.triggerBuild)(t,null==s?void 0:s.msdyn_mobileappid,e,n);E(o),Object(y.logInfo)("BuildCreate_Success",{androidApiToken:!!e,iOSApiToken:!!n,newBuildWithHistory:o}),j("built")}catch(a){Object(y.logError)("BuildCreate_Failed",{androidApiToken:!!e,iOSApiToken:!!n,existingRecord:s,error:a}),j("failed"),alert("Failed to create build: ".concat(Object(d.responseErrorMessageOrError)(a)))}else{var r="Failed to create build. No mobile app record exists.";Object(y.logError)("BuildCreationFailed_NoExistingRecord",{androidApiToken:!!e,iOSApiToken:!!n,existingRecord:s,errorMessage:r}),alert(r),j("failed")}}));return function(t,n){return e.apply(this,arguments)}}();Object(p.useEffect)(()=>{function e(){return(e=R((function*(e){var n,o,r,a;try{n=yield Object(b.getMobileAppRecord)(t,e),a=yield Object(m.getDefaultImageBlobs)(),v(a),n?(o=yield Object(b.getExistingImages)(t,n.msdyn_mobileappid,n),h(o),l(n),i(!1),r=yield Object(b.getAllBuildsForMobileApp)(t,n.msdyn_mobileappid),E(r),Object(y.logInfo)("LoadedExistingRecords",{appId:e,mobileAppRecord:n,imageRecords:o,buildRecords:r,buildCount:r.iOS.length+r.Android.length})):(E({iOS:[],Android:[]}),i(!1))}catch(s){Object(y.logError)("FailedToLoadExistingRecords",{appId:e,mobileAppRecord:n,imageRecords:o,buildRecords:r,gatheredDefaultImageBlobs:a,error:s}),E({iOS:[],Android:[]}),alert("An error occured. Failed to load form: ".concat(Object(d.responseErrorMessageOrError)(s)))}}))).apply(this,arguments)}Object(y.logInfo)("PanelOpened"),O?(Object(y.logInfo)("LoadingExistingRecords",{appId:O}),function(t){e.apply(this,arguments)}(O)):(Object(y.logInfo)("NotLoadingExistingRecords_NoAppId",{appId:O}),i(!1))},[]);var D=Object(p.useMemo)(()=>s&&f?Object(g.mapRecordsToUi)(s,f):void 0,[s,f]),N=Object(p.useMemo)(()=>!!D&&Object(S.areBuildRequirementsMet)(D),[D]),L=Object(p.useMemo)(()=>o.filter(e=>w(e.id)!==O&&function(e){var t;return(null==e||null===(t=e.properties)||void 0===t?void 0:t.almMode)===c.AlmModeType.Solution}(e)).map(e=>({text:e.properties.displayName||"",key:w(e.id)||""})),[o]);return u.a.createElement(x,{onDismiss:n,isLoading:a,saveStatus:T,existingRecord:D,onSave:A,isBuildEnabled:N,onBuild:I,builds:P,secondaryAppOptions:L,defaultDisplayName:r.properties.displayName,defaultImageBlobs:C})}),N=[{size:1024,blobColumn:"msdyn_appicon1024x1024",nameColumn:"msdyn_appicon1024x1024_name"},{size:180,blobColumn:"msdyn_appicon180x180",nameColumn:"msdyn_appicon180x180_name"},{size:167,blobColumn:"msdyn_appicon167x167",nameColumn:"msdyn_appicon167x167_name"},{size:152,blobColumn:"msdyn_appicon152x152",nameColumn:"msdyn_appicon152x152_name"},{size:120,blobColumn:"msdyn_appicon120x120",nameColumn:"msdyn_appicon120x120_name"}],L=[{size:192,blobColumn:"msdyn_appiconxxxhdpi",nameColumn:"msdyn_appiconxxxhdpi_name"},{size:144,blobColumn:"msdyn_appiconxxhdpi",nameColumn:"msdyn_appiconxxhdpi_name"},{size:96,blobColumn:"msdyn_appiconxdpi",nameColumn:"msdyn_appiconxdpi_name"},{size:72,blobColumn:"msdyn_appiconmdpi",nameColumn:"msdyn_appiconmdpi_name"},{size:48,blobColumn:"msdyn_appiconhdpi",nameColumn:"msdyn_appiconhdpi_name"}],M=[{label:"Background fill color",property:"msdyn_fillcolor"},{label:"Button fill color",property:"msdyn_buttoncolor"},{label:"Heading text color",property:"msdyn_headingtextcolor"},{label:"Hyperlink text color",property:"msdyn_hyperlinkcolor"}],x=e=>{var{secondaryAppOptions:t,onSave:n,onBuild:i,isLoading:l,saveStatus:c,isBuildEnabled:g,builds:S,onDismiss:E,existingRecord:j,defaultDisplayName:A,defaultImageBlobs:I}=e,[w,D]=Object(p.useState)(!0),[x,k]=Object(p.useState)(!0),[F,_]=Object(p.useState)(!0),[U,V]=Object(p.useState)(!0),B=Object(s.getTheme)(),[H,G]=Object(p.useState)({msdyn_displayname:A,msdyn_tenantsplashimage_name:"",msdyn_tenantwelcomeimage_name:""}),[W,q]=Object(p.useState)({msdyn_fillcolor:O.DEFAULT_COLOR_HEX,msdyn_buttoncolor:O.DEFAULT_COLOR_HEX,msdyn_headingtextcolor:O.DEFAULT_COLOR_HEX,msdyn_hyperlinkcolor:O.DEFAULT_COLOR_HEX}),[z,Q]=Object(p.useState)(!1),[K,Y]=Object(p.useState)(!1),J=e=>{G(t=>T(T({},t),e))},X=()=>{null==i||i(H.msdyn_androidappcenterapitoken,H.msdyn_iosappcenterapitoken)},Z=Object(p.useRef)(null),$=Object(p.useRef)(null),ee=function(){var e=R((function*(e,t,n,o,r){var a,i=null===(a=e.target.files)||void 0===a?void 0:a[0];if(i)try{o&&(yield Object(m.validateImageSize)(i,o)),G(e=>T(T({},e),{},{[t]:i.name,[n]:i})),Object(y.logInfo)("SetImage")}catch(s){Object(y.logError)("FailedToSetImage",{error:s,imageType:i.type})}finally{r.current&&(r.current.value="")}}));return function(t,n,o,r,a){return e.apply(this,arguments)}}(),te=()=>{null==n||n(T(T(T({},I),H),{},{msdyn_secondaryapps:re.join(",")}),{iOS:z,android:K},W)},ne=Object(p.useRef)(!1);Object(p.useEffect)(()=>{var e;j&&!ne.current&&(J(T({},j)),q({msdyn_fillcolor:j.msdyn_fillcolor||O.DEFAULT_COLOR_HEX,msdyn_buttoncolor:j.msdyn_buttoncolor||O.DEFAULT_COLOR_HEX,msdyn_headingtextcolor:j.msdyn_headingtextcolor||O.DEFAULT_COLOR_HEX,msdyn_hyperlinkcolor:j.msdyn_hyperlinkcolor||O.DEFAULT_COLOR_HEX}),Y("NotSpecified"===j.msdyn_platformtype||"Android"===j.msdyn_platformtype),Q("NotSpecified"===j.msdyn_platformtype||"iOS"===j.msdyn_platformtype),ae((null===(e=j.msdyn_secondaryapps)||void 0===e?void 0:e.split(","))||[]),Object(y.logInfo)("LoadedFormWithExistingRecords"),ne.current=!0)},[j]);var oe=Object(p.useMemo)(()=>!(Object(a.isEmpty)(H)&&Object(a.isEmpty)(W)&&!z&&!K),[z,K,H,W]),[re,ae]=Object(p.useState)([]),ie=(e,t)=>{t&&ae(t.selected?[...re,t.key]:re.filter(e=>e!==t.key))},se=Object(p.useMemo)(()=>{var e=T(T(T({},H),W),{},{msdyn_secondaryapps:re.length?re.join(","):void 0,msdyn_platformtype:Object(b.platformStringFromPlatforms)({iOS:z,android:K})});return Object(d.checkIsDirty)(j,e,O.DIRTY_FIELD_EXCLUSIONS)&&!l},[j,H,W,z,K,l,re]),le=!!g&&"saving"!==c&&"building"!==c,ce=l?{loadingText:"Loading"}:void 0;return"saving"===c?ce={loadingText:"Saving"}:"building"===c&&(ce={loadingText:"Creating build"}),u.a.createElement(o.Panel,{tooltipText:"Cancel",isOpen:!0,headerText:"Wrap (preview)",loadingOverlay:ce,onRenderSubHeader:()=>u.a.createElement("p",{style:O.styles.panelHeaderSubtitle},"Customize your app experience."," ",u.a.createElement("a",{style:O.styles.panelHeaderSubtitleLink,href:O.learnMoreUris.wrap,target:"_blank"},"Learn More")),onDismiss:()=>{var e=!0;se&&(e=confirm("You have unsaved changes. Are you sure you want to close the panel?")),e&&(null==E||E(),Object(y.logInfo)("DismissFromPanel"))},onRenderFooterContent:()=>u.a.createElement(u.a.Fragment,null,"saved"===c&&!se&&u.a.createElement("p",{style:O.styles.savedContainer},u.a.createElement(r.Icon,{iconName:"Checkmark",styles:{root:O.styles.checkmark}}),"All changes are saved."),u.a.createElement(r.DefaultButton,{primary:!0,onClick:te,style:{marginRight:8},theme:B,disabled:!oe||"saving"===c||"building"===c||!se,"data-testid":O.TestId.SaveButton},"Save"),u.a.createElement(r.DefaultButton,{onClick:X,disabled:!le,theme:B},"Build")),customWidth:"500px",type:r.PanelType.custom},u.a.createElement(u.a.Fragment,null,u.a.createElement(o.Accordion,{checked:w,toggle:!0,text:"General",styles:w?O.accordionStyles:O.accordionStylesClosed,isOpen:w,onOpen:()=>D(!0),onClose:()=>D(!1),onRenderContent:()=>u.a.createElement(r.Stack,{tokens:T(T({},O.DEFAULT_STACK_CHILD_GAP),{},{maxWidth:O.FIELD_MAX_WIDTH})},u.a.createElement(r.TextField,{label:"Display name",required:!0,styles:O.textFieldDefaultStyles,value:H.msdyn_displayname,onChange:(e,t)=>{(!t||t.length<=30)&&J({msdyn_displayname:t})},"data-testid":O.TestId.DisplayNameInput}),u.a.createElement(r.Dropdown,{styles:O.dropdownDefaultStyles,options:t||[],multiSelect:!0,label:"Secondary apps",onChange:ie,selectedKeys:re,onRenderLabel:e=>Object(v.onRenderLabelWithTooltip)(e,u.a.createElement(u.a.Fragment,null,u.a.createElement("p",{style:O.styles.tooltipLink},"Select additional canvas apps to include in your app. ",u.a.createElement(r.Link,{href:O.learnMoreUris.secondaryApps,target:"_blank",style:O.styles.tooltipLink},"Learn more"))),!0)}),u.a.createElement(r.Stack,{tokens:O.APP_PLATFORM_CHILD_GAP},u.a.createElement(C.CustomLabel,{customLabelStyles:O.labelAppPlatformStyles,id:"App platform(s)",label:"App platform(s)",calloutContent:u.a.createElement(u.a.Fragment,null,u.a.createElement("p",{style:O.styles.tooltipLink},"Select target platforms for your app. ",u.a.createElement(r.Link,{href:O.learnMoreUris.appsPlatform,target:"_blank",style:O.styles.tooltipLink},"Learn more"))),translationFile:"Wrap",fluentLabel:{required:!0}}),u.a.createElement(r.Checkbox,{label:"iOS",checked:z,onChange:(e,t)=>Q(t),theme:B,inputProps:{"data-testid":O.TestId.IosButton}}),u.a.createElement(r.Checkbox,{label:"Android",checked:K,onChange:(e,t)=>Y(t),theme:B,inputProps:{"data-testid":O.TestId.AndroidButton}})),u.a.createElement("div",{className:"app-settings-infoButton"},u.a.createElement(r.TextField,{label:"Bundle ID",required:!0,styles:O.textFieldDefaultStyles,value:H.msdyn_bundleidentifier,onChange:(e,t)=>J({msdyn_bundleidentifier:t}),"data-testid":O.TestId.BundleIdInput,onRenderLabel:e=>Object(v.onRenderLabelWithTooltip)(e,u.a.createElement(u.a.Fragment,null,u.a.createElement("p",{style:O.styles.tooltipLink},"Define a permanent app identifier for your app. ",u.a.createElement(r.Link,{href:O.learnMoreUris.bundleId,target:"_blank",style:O.styles.tooltipLink},"Learn more"))),!0)})),u.a.createElement(r.TextField,{label:"AAD Client ID",required:!0,styles:O.textFieldDefaultStyles,value:H.msdyn_adalclientid,onChange:(e,t)=>J({msdyn_adalclientid:t}),"data-testid":O.TestId.AadClientIdInput,onRenderLabel:e=>Object(v.onRenderLabelWithTooltip)(e,u.a.createElement(u.a.Fragment,null,u.a.createElement("p",{style:O.styles.tooltipLink},"Provide the client ID from Azure Portal. ",u.a.createElement(r.Link,{href:O.learnMoreUris.azureADClientId,target:"_blank",style:O.styles.tooltipLink},"Learn more"))),!0)}),K&&u.a.createElement(r.TextField,{label:"AAD Client Redirect URI",required:!0,styles:O.textFieldDefaultStyles,value:H.msdyn_adalredirecturi,onChange:(e,t)=>J({msdyn_adalredirecturi:t}),"data-testid":O.TestId.AadClientRedirectInput,onRenderLabel:e=>Object(v.onRenderLabelWithTooltip)(e,u.a.createElement(u.a.Fragment,null,u.a.createElement("p",{style:O.styles.tooltipLink},"Provide the client redirect URI from Azure Portal. ",u.a.createElement(r.Link,{href:O.learnMoreUris.azureADClientRedirectUri,target:"_blank",style:O.styles.tooltipLink},"Learn more"))),!0)}))}),u.a.createElement(o.Accordion,{checked:w,toggle:!0,text:"Display options",styles:x?O.accordionStyles:O.accordionStylesClosed,isOpen:x,onOpen:()=>k(!0),onClose:()=>k(!1),onRenderContent:()=>u.a.createElement(r.Stack,{tokens:T(T({},O.DEFAULT_STACK_CHILD_GAP),{},{maxWidth:O.FIELD_MAX_WIDTH})},z&&u.a.createElement("section",null,u.a.createElement(C.CustomLabel,{customLabelStyles:O.labelDisplayOptionStyles,id:"iOS app icons",label:"iOS app icons",calloutContent:u.a.createElement(u.a.Fragment,null,u.a.createElement("p",{style:O.styles.tooltipLink},"Select target platforms for your app. ",u.a.createElement(r.Link,{href:O.learnMoreUris.iosAppIcon,target:"_blank",style:O.styles.tooltipLink},"Learn more"))),translationFile:"Wrap",fluentLabel:{required:!0}}),u.a.createElement(r.Stack,{horizontal:!0,wrap:!0,tokens:{maxWidth:O.FIELD_MAX_WIDTH},style:O.styles.uploadSectionContainer},N.map(e=>{var{size:t,nameColumn:n,blobColumn:o}=e;return u.a.createElement(h.UploadSquare,{blobColumnName:o,key:o,size:t,onSetImage:(e,r)=>ee(e,n,o,t,r),blob:H[o]||(null==I?void 0:I[o])})}))),K&&u.a.createElement("section",null,u.a.createElement(C.CustomLabel,{customLabelStyles:O.labelDisplayOptionStyles,id:"Android app icons",label:"Android app icons",calloutContent:u.a.createElement(u.a.Fragment,null,u.a.createElement("p",{style:O.styles.tooltipLink},"Upload icons to use for your Android app. ",u.a.createElement(r.Link,{href:O.learnMoreUris.androidAppIcon,target:"_blank",style:O.styles.tooltipLink},"Learn more"))),translationFile:"Wrap",fluentLabel:{required:!0}}),u.a.createElement(r.Stack,{tokens:T(T({},O.APP_ICON_UPLOAD_CHILD_GAP),{},{maxWidth:O.FIELD_MAX_WIDTH})},u.a.createElement(r.Stack,{horizontal:!0,wrap:!0},L.map(e=>{var{size:t,nameColumn:n,blobColumn:o}=e;return u.a.createElement(h.UploadSquare,{blobColumnName:o,key:o,size:t,onSetImage:(e,r)=>ee(e,n,o,t,r),blob:H[o]||(null==I?void 0:I[o])})})))),u.a.createElement(r.TextField,{label:"Splash screen image",styles:O.textFieldDefaultStyles,readOnly:!0,value:H.msdyn_tenantsplashimage_name,onRenderLabel:e=>Object(v.onRenderLabelWithTooltip)(e,u.a.createElement(u.a.Fragment,null,u.a.createElement("p",{style:O.styles.tooltipLink},"Upload a splash screen image for your app. ",u.a.createElement(r.Link,{href:O.learnMoreUris.splashScreenImage,target:"_blank",style:O.styles.tooltipLink},"Learn more"))),!0)}),u.a.createElement("label",{style:O.styles.uploadButtonHorizontal,htmlFor:"splash-image"},u.a.createElement(r.Icon,{iconName:"Upload",styles:{root:O.styles.uploadIconHorizontal}}),"Upload image",u.a.createElement("input",{type:"file",hidden:!0,accept:".png",id:"splash-image",ref:Z,onChange:e=>ee(e,"msdyn_tenantsplashimage_name","msdyn_tenantsplashimage",144,Z)})),u.a.createElement(r.TextField,{label:"Welcome screen image",styles:O.textFieldDefaultStyles,readOnly:!0,value:H.msdyn_tenantwelcomeimage_name,onRenderLabel:e=>Object(v.onRenderLabelWithTooltip)(e,u.a.createElement(u.a.Fragment,null,u.a.createElement("p",{style:O.styles.tooltipLink},"Upload a welcome screen image for your app. ",u.a.createElement(r.Link,{href:O.learnMoreUris.splashScreenImage,target:"_blank",style:O.styles.tooltipLink},"Learn more"))),!0)}),u.a.createElement("label",{style:O.styles.uploadButtonHorizontal,htmlFor:"welcome-image"},u.a.createElement(r.Icon,{iconName:"Upload",styles:{root:O.styles.uploadIconHorizontal}}),"Upload image",u.a.createElement("input",{type:"file",hidden:!0,accept:".png",id:"welcome-image",ref:$,onChange:e=>ee(e,"msdyn_tenantwelcomeimage_name","msdyn_tenantwelcomeimage",286,$)})),M.map(e=>{var{label:t,property:n}=e;return u.a.createElement(o.ColorInput,P({label:t},O.colorInputDefaultProps,{key:t,colorPickerProps:{color:W[n],onChange:(e,t)=>q(e=>T(T({},e),{},{[n]:t}))}}))}),u.a.createElement(r.Dropdown,{options:[{text:"Light",key:"light"},{text:"Dark",key:"dark"}],label:"Status bar text theme",styles:O.dropdownDefaultStyles,selectedKey:H.msdyn_statusbarcontentcolormode,onChange:(e,t)=>J({msdyn_statusbarcontentcolormode:null==t?void 0:t.key}),onRenderLabel:e=>Object(v.onRenderLabelWithTooltip)(e,u.a.createElement(u.a.Fragment,null,u.a.createElement("p",{style:O.styles.tooltipLink},"Customize the color palette for your app. ",u.a.createElement(r.Link,{href:O.learnMoreUris.statusbarTextTheme,target:"_blank",style:O.styles.tooltipLink},"Learn more"))),!0)}))}),u.a.createElement(o.Accordion,{checked:w,toggle:!0,text:"Publishing settings",styles:F?O.accordionStyles:O.accordionStylesClosed,isOpen:F,onOpen:()=>_(!0),onClose:()=>_(!1),onRenderContent:()=>u.a.createElement(r.Stack,{tokens:T(T({},O.DEFAULT_STACK_CHILD_GAP),{},{maxWidth:O.FIELD_MAX_WIDTH})},z&&u.a.createElement(u.a.Fragment,null,u.a.createElement(r.TextField,{label:"iOS App Center URL",required:!0,styles:O.textFieldDefaultStyles,value:H.msdyn_appcenterappidipa,onChange:(e,t)=>J({msdyn_appcenterappidipa:t}),"data-testid":O.TestId.AppCenterUrlIos,onRenderLabel:e=>Object(v.onRenderLabelWithTooltip)(e,u.a.createElement(u.a.Fragment,null,u.a.createElement("p",{style:O.styles.tooltipLink},"Provide an App Center location to save your iOS builds. ",u.a.createElement(r.Link,{href:O.learnMoreUris.iosAppCenterUrl,target:"_blank",style:O.styles.tooltipLink},"Learn more"))),!0)}),u.a.createElement(r.TextField,{label:"iOS API token",required:!0,styles:O.textFieldDefaultStyles,value:H.msdyn_iosappcenterapitoken,onChange:(e,t)=>J({msdyn_iosappcenterapitoken:t}),"data-testid":O.TestId.AppCenterUrlIos,type:"password",onRenderLabel:e=>Object(v.onRenderLabelWithTooltip)(e,u.a.createElement(u.a.Fragment,null,u.a.createElement("p",{style:O.styles.tooltipLink},"Provide the API token to enable saving to App Center. ",u.a.createElement(r.Link,{href:O.learnMoreUris.appCenterApiToken,target:"_blank",style:O.styles.tooltipLink},"Learn more"))),!0)})),K&&u.a.createElement(u.a.Fragment,null,u.a.createElement(r.TextField,{label:"Android App Center URL",required:!0,styles:O.textFieldDefaultStyles,value:H.msdyn_appcenterappidapk,onChange:(e,t)=>J({msdyn_appcenterappidapk:t}),"data-testid":O.TestId.AppCenterUrlAndroid,onRenderLabel:e=>Object(v.onRenderLabelWithTooltip)(e,u.a.createElement(u.a.Fragment,null,u.a.createElement("p",{style:O.styles.tooltipLink},"Provide an App Center location to save your Android builds. ",u.a.createElement(r.Link,{href:O.learnMoreUris.androidAppCenterUrl,target:"_blank",style:O.styles.tooltipLink},"Learn more"))),!0)}),u.a.createElement(r.TextField,{label:"Android API token",required:!0,styles:O.textFieldDefaultStyles,value:H.msdyn_androidappcenterapitoken,onChange:(e,t)=>J({msdyn_androidappcenterapitoken:t}),"data-testid":O.TestId.AppCenterUrlAndroid,type:"password",onRenderLabel:e=>Object(v.onRenderLabelWithTooltip)(e,u.a.createElement(u.a.Fragment,null,u.a.createElement("p",{style:O.styles.tooltipLink},"Provide the API token to enable saving to App Center. ",u.a.createElement(r.Link,{href:O.learnMoreUris.appCenterApiToken,target:"_blank",style:O.styles.tooltipLink},"Learn more"))),!0)})))}),u.a.createElement(o.Accordion,{checked:w,toggle:!0,text:"Builds",styles:U?O.accordionStyles:O.accordionStylesClosed,isOpen:U,onOpen:()=>V(!0),onClose:()=>V(!1),onRenderContent:()=>u.a.createElement(u.a.Fragment,null,void 0===S?u.a.createElement(r.Spinner,null):u.a.createElement(f.SortableDetailsList,{builds:S}))})))}},5951:function(e,t,n){"use strict";n.r(t),n.d(t,"checkIsDirty",(function(){return r})),n.d(t,"responseErrorMessageOrError",(function(){return a}));var o=n(2812);function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;if(Object(o.isEmpty)(e)&&!Object(o.isEmpty)(t))return!0;var r={};return[...Object.keys(e),...Object.keys(t)].forEach(o=>{if(!n.has(o)){var a=e[o],i=t[o];if(!(null==a)||!(null==i))if(o.endsWith("color"))("object"==typeof a?a.str:a)!==("object"==typeof i?i.str:i)&&(r[o]={recordOne:a,recordTwo:i});else a!==i&&(r[o]={recordOne:a,recordTwo:i})}}),!!Object.keys(r).length&&r}function a(e){var t,n,o;return(null==e||null===(t=e.response)||void 0===t||null===(n=t.data)||void 0===n||null===(o=n.error)||void 0===o?void 0:o.message)||(null==e?void 0:e.message)||e}},5952:function(e,t,n){"use strict";n.r(t),n.d(t,"validateImageSize",(function(){return w})),n.d(t,"getDefaultImageBlobs",(function(){return D}));var o=n(5953),r=n(5954),a=n.n(r),i=n(5955),s=n.n(i),l=n(5956),c=n.n(l),p=n(5957),u=n.n(p),d=n(5958),m=n.n(d),b=n(5959),g=n.n(b),y=n(5960),S=n.n(y),f=n(5961),h=n.n(f),O=n(5962),C=n.n(O),v=n(5963),P=n.n(v),E=n(5964),T=n.n(E),j=n(5965),A=n.n(j);function R(e,t,n,o,r,a,i){try{var s=e[a](i),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(o,r)}function I(e){return function(){var t=this,n=arguments;return new Promise((function(o,r){var a=e.apply(t,n);function i(e){R(a,o,r,i,s,"next",e)}function s(e){R(a,o,r,i,s,"throw",e)}i(void 0)}))}}function w(e,t){return new Promise((n,r)=>{var a=new FileReader;a.readAsDataURL(e),a.onload=e=>{var a=new Image;a.src=e.target.result,a.onload=function(){this.height!==t||this.width!==t?(alert("Height and width must be ".concat(t,"px")),r("Height and width must be ".concat(t,"px")),Object(o.logWarning)("WrongImageSize",{attemptedUploadSize:{height:this.height,width:this.width},validatidationSize:t})):n(!0)}}})}function D(){return N.apply(this,arguments)}function N(){return(N=I((function*(){var e={msdyn_tenantwelcomeimage:A.a,msdyn_tenantsplashimage:T.a,msdyn_appicon120x120:g.a,msdyn_appicon152x152:S.a,msdyn_appicon167x167:h.a,msdyn_appicon180x180:C.a,msdyn_appicon1024x1024:P.a,msdyn_appiconmdpi:a.a,msdyn_appiconhdpi:s.a,msdyn_appiconxdpi:c.a,msdyn_appiconxxhdpi:u.a,msdyn_appiconxxxhdpi:m.a},t={msdyn_tenantwelcomeimage:null,msdyn_tenantsplashimage:null,msdyn_appicon120x120:null,msdyn_appicon152x152:null,msdyn_appicon167x167:null,msdyn_appicon180x180:null,msdyn_appicon1024x1024:null,msdyn_appiconmdpi:null,msdyn_appiconhdpi:null,msdyn_appiconxdpi:null,msdyn_appiconxxhdpi:null,msdyn_appiconxxxhdpi:null},n=[];return Object.keys(e).forEach(o=>{n.push(fetch(e[o]).then(e=>e.blob()).then(e=>t[o]=e))}),yield Promise.all(n),t}))).apply(this,arguments)}},5953:function(e,t,n){"use strict";n.r(t),n.d(t,"logInfo",(function(){return r})),n.d(t,"logWarning",(function(){return a})),n.d(t,"logError",(function(){return i}));var o=n(217);function r(e,t){Object(o.trackInfoTrace)("ShrinkWrap",{eventName:e,eventData:t})}function a(e,t){Object(o.trackWarningTrace)("ShrinkWrap",{eventName:e,eventData:t})}function i(e,t){Object(o.trackErrorTrace)("ShrinkWrap",{eventName:e,eventData:t})}},5954:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAfUSURBVHgB7VlZjxxFEv4y6+hzZow89prdZXdl7cKud19XPCL+Bfw2xAs/gzckLiEk4IH7EsYPQI/Hnu7ps44kMvKorOqu7vIYybLkmOnpruo8IuL7IjKiRmx+Xio8xSLxlMszA560/CEGKOXCKHw3LwW1a0Iw9vEkxhVEKyyECBR39/mvv9ZjxI7x7jO91e5dRTob0FRiW3m1c07bWEZGtc/vatBBA9o81KaUFLtZWaqSFWYn0I/GRqGka/lI+z6yAbuU0Ivrz2Vpr61CerOCfqIoZj4JKWpe1nOKvKghGUWRmSv57w6l9ThxdQPcZryhVb4oC0x/m+K9Nz/EL1/8gjuv3sELd15AlEoMnx9geHOAJE7YQONpmlMUOL97jnff+ADrizVefu1lpHGKpB/j5MUjpMMUkYyC+DBKK0atXb+9WcgrjoDPVpkv3v4K81/nGJ+O8edXbgGpQjbNcfH1DIsHS2zyDRugjc3zHNPJDB+99TE28w2GpwOMXuqj3JRYP9xg8sk5j2nuVxmhHh2BUGFHE/2rN1rNV3j40wVGpyOMbo2QHpO3B2TYGdGjFJh+OUP8/xgqNuBrg394/0eiicTR6RH++/p/yHWEzZhoNSE6rkrMJwuIm4KR05M0coygM8LStJMBtYwTpHa9YFkqzM4uMbo+4oA9/vsRJCkme8T/vxbIviaPLwiJry5w8tIJT5x8e4bFr0sc3zime8cYXOvTXFo/LpHPC95ndX9FDhlynEglt4JXtMTBTgNqvEcdQkUbaK5rT2qvpH3DXR2M5Q1SnlAo7paYfT5Hcp1QSBSmdy8xvj4mIyVu/u+G8bKWglBbGgNUAaZbpKIqMQTxEFKqEwLOEO11TpBB5pH9COObhD9tKskYZccmSYLsHzk29zYoFiXO3n+A9J8J+qM+1EhhcLtn0CLkcqJVNqHXIjM8G+ospWpZLaRNWzqVuxGoG8KZhzbULzZGKPRvpegTFXppj5TI2Xtak4i8LP4tkM0zTo2p7KF/0kfypxgitY6nsToTLX5eIltmbFz0HClsg74szLujL5/YLaVHCwKVAS4O9KIclJFEb5QyNeSaqENL5KREdr6GjCXScYLj20eI1wlO/nKCaBixh1fRAnEcIxYxGzf77BJyQGiMFXq3aUxGCAsNKu1D1EqEScOamp7BO0AQuxqapuc3GaW+58eIkshQStNJZwgpOKjnX55j+vkZw3zj1b8hvt7z8/X3WiIyXNNn+WDFBjvnnL9zD2pZYvTicxj+6xoHt3aWoDOyn1rKSWmR6BgDnvu2PCgj4mIsGEtehF4RLaoD2q5t7iuTLdyGJvBMeWHOUy7tKkXopl4nJ687vug5GsnNYo2ETnSNwD5pPcgkK6j46Ne5X9cstaykrEpcy9iSwdU5rKDw5YXJ62aIW5crVWnniso8k3GIUVnOScNnwJbTeO854DxVFO5AqTZiT3pjjeLSqGCR4C9IN2u0cDHltDF5BjxPwgBrzx67F9dSXinsNGLvOcCfaREN5/3JGeI09ga6d0lnwLxcYr5aGCXuTTDuX7M1jMksbmN9vbpcI19lPjCn0xnKnBwU0SF2OeN7OXk/oWBnZmF/Rbq3mHMTNU91VhiORta4sjqhdTycKmx6M1Z0mFAxNxzaZiaoZfgjxUcWIRe5v7+kNAv6HR1RSTIY8JiVWAGbolYLtRmx9yBzRphMIDgNGv4LH+iCAzri7CFscMd80laYh4jGFJilLCv6RZLR4DWiyO5HrySu0bhNDlajvKAOVNseCut1d/o6Bd2L55i7NjNVzpCW2zIYz6jY9aVdzzVFtRhokdYYCN9hA6x02cdXiPBptXYNVIHujTCFgTM+3KuGOA81Adylrez8VMI4r1JIX8qWNlOnR6tHoHDdKQ5Nn/FU0Cvr+yVqRrbJwSB2HmbHSxEyogquRvPBBV9bANp49nRzgAaZyh14+4LXyUEEfC6xOby2ufOmNqw09DLVZmNTi5iZ26CNNEiFZbOyVsrHoZCrVUwp7TxTfRcGLiw6rpNCw8hmTNU8q8xBWDuh+UisYmuftFKo+WRAYZuLW89yXM3glJTS87xqUeGzjxPzdKM6HKnroK4MQHsrfNiAunLCUkj5DUPPhvcR0oGbIbuC97hrWkq/tGlXG+lWqNYeIJRWCoUQu1rNKavhDtEIKaKajxZFPR06lKpsJPya9TWE/+5KBoSwV51RvVR2SKiQYmo7yLWE5bmb7x4UNM8CrvyATlnocAyIKnP4jVGVxWaIpZgrRtX2w1/TWanaGg6JrdgRvnQ6KN3SqBDY9SA27M7CJ3ehcc2xu6Q5tpm9HssA7QVdgM0eTBE+reDJlk78HngzVDTkdlMh73k9RMHH1nq94SLPO2+PHHw2qgsr/bhken+K7z/9jp9h1mKDNiioSZ8nK1Zm+XCCi28WNiuG3bgJzHydochKnxyWI/MIMr84R5xRw0/KDwdD9E56nRAQ+/5LGUK6Wq0wn8+x3qyp6Va26mqMR/22EgGNVWCH370+XyPQ7/cxHo3ZaYf6YS2dGhotemG96BaXnVJOQXu9nVlQC1RNG6GCHlrB0yayfUEX6fT/Acdf7aHwgatTZtdmzThoBnCYqbZio6PynQ0IxQXloc0OKbXVc1xRnv2b9UnLMwOetDz1Bugs1KFtuLI8XorpIL8D7LTCIzbx0w4AAAAASUVORK5CYII="},5955:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAYAAABV7bNHAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAA8uSURBVHgB7Vxbj1xHEa7uc+a6d6+FnWAi4ggRooQHIBJIiBceeeKVXwnKH+CBCPKAiEwSEWKCc5GdBMd79+7MnHOarqqu7uozszszu5MIiWlnvTPn0t31ddVXX/U5sRl/du5g3S5tFtbtyrYGaE5bAzSnrQGa09YAzWlrgOa0bwGgoCKc8//liqL9na9N101dH85ffv/qWwkrbjhpY4w6YuIxE87zh1n3hjvU/XJvBE39zZ8cfZVr8rFv3lbkQWnFM2NcvtptcMQWOgczrlXfL2sI+2VjrqLdCKA0KZia4KVhoo5npxxMrb58n2m0SV4za4xVAXbtELtqAleFER92U8bh96ZpZo4hnxEv6trki0JgYSiHAcWrpN+bhN7SACWDAJy7/HxTN5nRwhViDHGSNYrD887aAMr9bRAax+NYazOPwx881l7IZYFaCqB8RfNVl8/CJ3Vdwxf/+BIev/cE9r+3D/sv7QdEDZTDAvq7PTCNgaIokmFN8jzpB39jX48/eAIHnxzCYKsPd165wzD5c91hF3p7veglCIo1dmboRRvCIq0UoMsGy1bN/0GQcFXf/cMDeO+t9yOAv/jdz2Fzc4uuKWwBJ/0z2PvRDrgOeJBs4qDgZQhWQ+BU8OCt9+DB7/8OYtOPf/MG3L33AocqnIPtWuqr0y851IorSF0834SBVgGQBkdnDH1OVqxuavj4L/+Gh3/8F/Q2euQh5VYJt9/ch8mnNdRHNXgIoR7XcPLoFDZf3qBp0OqHnIHgYD8I7sfvPKK+hjtDOtff7cO9X3pwjixMvqzIxmpUweGHx7D/xi40hhcEPYnCDxIX5XNfoQddlbo1OMg7k6qCR3/+FPqb/Xjd/V9/n6/5Tg3V0woK/wcn//yzcyi3PSi3+lCWJeVUNAjP4fXHT0/g0dufUF/CQa/99ocAHW/crj/yhMfE46OnIzj/+gKG+wMOIWemcJgm/RV7UC7YknbB47ji+HP8xRE0kwZ6m72Yivde2fX3NWALzz/3/Mo/rCLBHn9wCsWbPA0ECQGqfFhVHuhP3/ncs733Gs87eO3t1/Zh+942h2GBN3hPO6ujd4wOR9DZ7bD3eE8iLqIwnAZi0ex2LZKOaZyRoskjX+DP+PkEBtuDCE45KKHsd2iyxgPU+JW3+96TntQ08cm4gpOPTmDn1a2QeQoPdAP/+egpnDw+geHu0IdcA4Xv54Wf3vWZz9LQlBA63sDKxMUaH078tTXNB72UwHGGOU3UvOLMlXlQO30KMBQOwKSMzFf7Va+rGvrbfeITNKIclkSMyEVRAtzzAH3lDbxwdO/ZP32o7ZUwuOPD0nvP6GwMzx4eUGiJvrn9s33oDrpQ+n7QQ9DD0PBm3ESuQV7DRUIOmwWAJBKjVxdW4EHacyQ0oghUdRBODjNJf4NDgrSJDwXynpCCKTq6fn3vVzB+t44p/eRvZ2B/ZSh0Dh4e+XsKT/IFzb93pwOD/R6BUxQlm4Rjnnmyv6jBmWC0lezXJKFqIKvXFk3vSwE0S/ITKGFgJEpK5/58sV2SB2muwixTlsgNhox0/nN1y/PQXe9Jn9XEM5OjCRw9OAH7oveOU/ZC8h7PM5svDwkYmnBRcIbz2mj8zHOVD1HJWHZDCN47op9TlA8wW1WLKr8RQLEAVQUpfsRJynentihMaaB7q+PDJ01ocuxDrTfxhnTZED/xstOBEr3o87FHJ3jgJw0MhgMi5dj3fhNLEwQJCRyFY3XqQ/GrEXu04RCze5JEHPGWMyZGUFueLNrmAqQ7bitn0SpknP+N5IrzKfYtFEed2AfyRO0zW10gqIY8Dqm26HkCf72A8z+NCPSt+1vQGXbiolQdT7qe7wtUx/4HgUHDK//75MEZZUtZsOHrnveGrKNwXng9eiaKUhKnppjipUUy2eIepAiaQAmqGSeNxCyf6Z6igdHGBfSqHnEJZpLm1As6W1Emc8EI6vuWn9x3G+hWfdi4vxHrLST/sfVp25Qcpp6ULS7QyMHBXw/h9IMzur/oW+j9oAudV8s4N5wHARQagiREnorYBNJVzcx7cNgWV+Ix5OreiP7ewIdPGcUdeUjjuaFmTytx5fzvg7cfw8TrFCJSf93eT+5C98UhEUGFK14hQfNCoMcgQAgMGooG1qMaLg4v2BsvajqLUJ6+/zU05xMaq393E7Zfv01zQM3lqgY1CHlPEbIf/hZgVpbmI0DhD4IxHk9g+6UdKMowYEjr9Nn5TFOo7QlmSpowZTNOOJ6HShaQPnWZnqHPUoSWhqdG8gBLD1tT9V/4LFn0GXQKVQR8zB5hMXkFcUgX+OtRBlWTmnhPV/my4PNAmrthlomrhgcmDeIpxhQWssoGB0cytUXcfohbEeG89NOEayXHWLkWoab7CzI2KE5aAKekBV/P4RMXkAeJQhLC2OPxKOdR18CibaEdxTZJU6iZsBJhVZzKmWmlCjKETiHRFmHlIMkzTP1xXwd4j8hAvjDG6O8uVvsMIChPNXEOsig4Fi4oEbxj77fGTtl2WVt8uwOSAKu9y9auSi4qEwYIzMBbGNGdKfQCaIa9Lhlv6VzAOu3XGA45NhpPVuGeVIRK6NJXa+QweSdEkIGyHiaSTtmJoCy6cbYwQOTkOFErynR6Q4rBMnGSRk/GhUxoRE+Fm+J5l22TCnicxl2sp+S8lAwujIGeKHoscgzNM9+vIkytzmQ3LDXa2xxU50By+aQlIJG03AuQjLcs8/WWbXuMCLoGPgCOhkYuDMynUzd7cOo0zDJuwtEcXTtzrSCLiYFxypYJ8vCrYzh6fgKbt7ciB2hjhVck3s+2LuD4o4M49bMPx7C7cRdkEXkfyEX9n4WK/6kuvHI+HnENFrZmm/PKb8M+jnXhpj928SxU8JYXY/Tc6zHTga2NzSkvhFUUq1mH2NeECbDT9XvBfltjb28vnnehiJVULauFhvb8xpjx4pFXFWBjZwd2b+17r6sVATPSnGUSKSNcY691LsxFmotvdXcCdf+U+As73drZg/7Opiwt/X1qTv2WCJc3klnzmhJuBlDWoeNNrclkQhqm6+upDm5yhacTU8CEVEu4eoIsbYe9DaW//97p4PCdWD8JKHifpP3IZX5h6rLODDO+kO11hHh9T75WKxUR00KS1qqzsmJRkYhtbprPGB8zWM0bXfHRTUjjQpYBRzbMJFbg1C2fQ0y6tAjQClEIfUT5EDO4ImznYuZzTmrEYJiUGkFikJIuln9OurQHkdGFoawRDYSUwWTzjFK01hsgoWpD+pYTfBwNEI8Ddc6G8S20CkuliyQBQAzTJl5LYjRkXuKuQls3n4MWhlS7p2QFAJeBSNeEiaJIhBAiGkQsQ/k3pG2SVgaMXie85/gpB4VyuFfME5bn6aidRDWnmXIkjgY3B8iYFghFHsft0NITsiatrHNiDJ8XEIMeUH0kT+KMFXYjHShdlIx08sAylCAyLs2RlLrNqvsmCNdF2oIelJAmUBolVVQIGsg9wIk8EO8LqZeJm8lYjkejQ4kiYBmryhMRkOGRsjE2F5cm5zBxcgSQiN/adO0C3rMEQEkYklEWEgfN4AXRTgVtVdh4PHKPLgXkq9xn0ntEtl1XuSQG2xxG1ymwRF3H7OBCglkwey0NULxBXF2eo0PKGC6+qACgC1to8VPUTKpF4BzvOTG1mHgsZU1IwjX2YbIMGV+YUJ6NTe8FLdqu9/qLqmfSJloIBwEEIOMpa/K3xCy+tAAtpe5ab2SEEIT2daG/xqS9cixFmpCUDFiAuIeeOFTmvExbKovFiYrbRvJ0aWVdessCm379JXEQAFsTwiYAK6HRNGosSIXmVPZxvDsg7mNigkjZS9/SritXClCWsQL3yIrqd3P0ddqDmrDZRq+7JNUXQ1ATqKx4+q5XPvcC2Waha2QeQa9Z9T1Jk+VCbGkP0ntA4QC4LO3m12uzJByzCdCGev7Ckw4zfb14h7Upm+WZyynOVhwYQJb3hpZpS5N0VNY68/DslVHaSBPDiJ+sJnEoJYKNoZVIPgyW6Rdd47lYvrHOcVrX6GwaCFyewnxjWWxWx1GggdI8wBLARU5JGYWL0MBNdfKMRoVYuJj7a5qkmhuVCdkfQ/nQqIxoMg5K4hZgVq23SFs6xMI8+JfwBts0pUNoACHxVn/MGzZmJxoDcp6QcxkPsR7INZFJwChJFn/rtV3Wg66d5h3XBPxcnDbQXRKSSlRi42fnnMWgiV3QyhOw4aWGqH2UIY14kvKIeC5kRiFho0CQ8A6yk9P/N5nmYzN8F1ccKZXqyevH0/o4ZRwr6tiwFhLVa/It3PikVnkQ861ku6CuRRJYEwk6AzFm3eXDaymAEhkD12LAISWPU8JFCRirtzrS303kpFx5xzdkJTQLfhoqMeIikaRsqoUnOJMpAFk4q0LTwLfhQRA0hjGZIMyFZKqwaRCTNthEo4jwi/WYMiy7P/xo5e4U6wpPyTtLOryiWLRp7G8MoCn3nDEYCeTgFcRLSkA2KrOIYTHDQA64AKYrcBlBiF2HIxlipB5LqV30WpyHucSWK9rS1Ty/Ncb88fz4LDsnIg8cRDEXS48sC5lYarAeysWgXC/kHYRMIPVpvQOQdgJceLNNvKcaTaIH68fhKwdIJs82Gdqwf35wDl88ekLeMqvOafOKELVTG2KglLN4H/Ja9owtCEt+Xp+EYhNet0Helq1eNp7HfPb0GUzGE3pZK9aBSzaz7P83LwaPqzGcnZ7Bs2cHcH5xzi82uTrxaCBFeX+QXrYcVxFg07X8o558ynvSoERn7KdubZ2Gj7V/HBQ5rfQb8x1W7Piq3nA4pMdSGxsb0PWPqfJwXaxdSwfhhEpbwmAwgP1bFkYXFzCpJvQMPFgb1CNaN21UquPU+VA2JMkLEMlIicmM0U3rOkhFKgIy6A+g1+/R04xlBaK0pQHSXNPr9ug5Wa/f5Rc5W5tg8Vk4pBc+EzjqQpskhBQR2ZjhJsl8WlfpzB031Qp+BYdew8H3IYvr/4+V1/YgPVGqkpFbrIuTxtDJ9nAcG0h8U3M40THjMi+I6djk0kFKi/j4CEzyHBJloX8SkCYqbL0V860BJE1nNknJ2ihddmTGFnnKF4+U612mnt00UMrgtnSQY3wAbgQOdbH+x02ubtdS0v9PbQ3QnLYGaE5bAzSnrQGa09YAzWlrgOa0NUBz2hqgOW3l/zzOitr/jLr/L0I+r93YIfTsAAAAAElFTkSuQmCC"},5956:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAYAAADimHc4AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAABjXSURBVHgB7V1JsyPHcc6qxvL24QxFDkVK3DSyGRRtH2SZ9snhCPviv+D/5D/huy6++CRfpAjLi8IWg5SCHEoiNSRFk7O9HVuXK9fKauCNBw8Y4oJ8gQHQXV1dleuXWdWYMP79RYItbYwibGmjtBXAhmkrgA3TVgAbpq0ANkxbAWyYtgLYMG0FsGHaCmDD9I0KICVMupN95u8gx/zn+r20gye2q9uU+ywYSXXvxW2+GerBN0I8wWD/JgghVELQ7769Zyqey00Am4TA/fCx+l0phFD1q9+7zPZfF13/rOkZWUBhLDOZJ5qq76maZJcxixigTVRwnunzjE1z717Yegw/+378uav6XietVQBl0Kp984ycY7q06ba7iqHdez2JOYuY2D3mhdm9T1fA+rdOWqsAukrbtrVWdd0EUVJGtFWMsNPKsFAf0+/mysTqlEH63mWid33+XJvvX89lgUuj267XNa05BrB/X+zXYU5ja/8NZj0JWp6sno88eQhFQ5UR1fcAlRCQqdQHxhwIlbDwe9u21VhqquewyB2tI06sRQBd/+kH7f2sTrgrCM8U0+z8N2tn0MTIvp/+YYMlBms8KB/qcyIM1WxiuPuM7WKI9RwCmKDQep/E4G5wvy6tJIAnabo/7rWHtFK43IrboeMtayszihFPzMyfTKf0zufa+l7CMOojiNYj4+idrYjuwTc3xuNfExqYpAkLQeJQjA1ZX1RBu7FHUoRa0bTNKkJYQQDzDPffjVEyNmZEMiv4/P0v4L9//D9w/5MHMNwbwp0f3YFX3n7Frse/4eEQDl/dg2bYCIOiCYkYjl0Fp/ViKTMSLMDl6SW8/y8fwMc//Q2MT8bw0vdfgjvv3oHh/hCaXkP36e/2YHCjD4evHOTrptniGurb+3qzXidwb+1mctegcJ0lyUWo4Sor8J+nsymkrKF3f/Yx/Ps//Se0M54UMrLNf3/5D+/C4e5R6U+EfHTnEHZvZaY1DX1HJpUZOITTsuBmsxmMzsfwk3/8V3j4ySN2b4Fd0Hf//Dvw9l/9ANJlqgJ1/6AHt95+jhiM91G3eRVMnWPkNa3g2hawKJiqHy8WICqaCZmCDD/++hje++f3oTfskUYTAzPj3vjr1+HFH34Lxr+dQntWI5rjj04gvhOypQwgNNkKErsZ0sgU6EPKGooMnuX3WXZbv/zxL+Hi4SUMDgbUP45r9+YuvPX3fwz9vQbGdyeQpmKh+XV5fwTHvzuB/WxxGPTRDZHbcfFG531VkncdurYAun5Q3U0N9YCE0CZlzgw+/MldYga6gSSBbng0gDf+5jUSUng5wfTXUwit63+S4PjDE7jxzhEMQl88j+QOgd2b+nxk/u9/8Rl88cGXJGTuIDdrAnzvb9+A/mGfrA2ey8e/BItJyOizexew+9IOtCG7sJisfw8MdL4FBnsvALCsK1paAF38zPMrUNDweKqTHWQuuqBHnzyGwf6guM38fvPNm/l8y0PPRhG/nRHQ71rSQLQa1MjJwymcf3YBIYeJXo+tJ0Ao6EcC+enDM/j03z6Fwe6gGtPzb92CF37wLall5BO7WVjjmWk5XT9t4ezzczh87QB6oUfCwSDtA32wgopC42D5TxLw8EwFUG4UFsLJbjsNvKj9j+49pgkTc4T5yNxbd27miQZLoZrnMlMO8nWPGPXMpjOa8Nndc+jdwHN54Oin87UYD8i95XuggO/9x73MyESBHSIzKu5GePkvvs2DYpUF2Of8AoXAh1lQ48cT6ocEjFYYSz5hzF9QX/oGYgCr7MJsttsylaRdEQS6m9HpiLTfDxbPDbILwmtQs2ky6CRey0I7zq/RzCwhziKcfnAON3/Uz0zPwTj/oTtRC/v6owfw+NMTcm80DgnKt3/4AuxkRBWyNmNegTC3ya8xTPIAQgEDmcZfA31vG9Z+HB/FKs0tIM0ngR1oDEvAmiUEEK5EPJ7sOINvZr7g/+nlFAZ7A8ty1f/2d/qEwQmTS27U38ku4M0sgPcS+2wAsoT2qxzIPzqFw+/tiy9mdpw/voD//dVXZF2+74Pv7MON14/EWiIjKbQYSjRyuzH3re5mNplZTElNnUz6OCcsmc952uWsYeVMeK4i2dEAxs/sL/u7fRjuDqtslfvIvMhBUrE5XZf9cfNc1vEXsxA+k5JB4P4uPrqE4e0+NBnNoHZi/Hh491HW6obcDUjS3Ow0cPRHh9Dr97LL6mUhMOpCISBaaictISFlMGl7LxITdT7e9fBBMFirimRzvwZdOwZ0mW3a0dYDCQoR86vJqKS/17dkjAJgbt9mTB6OuB6kVtBkhmFW27weYfpl1sqLUrdJs4yKfnEKB+/ukfQuvryAywcj6puyX2Rkhqu7rw7J4pBJDQZuYdZkMmWWjoE03itM048VkCDrzX+YOT+JH4qYli3WLSWAKvi4BLByO3Jc3Q5qWuIyIvRv9MwF2XXIsGlivwziUjK275EA8tQHLfTemsH4v9rSHvv9Q44Nd3O7V3pZACMKuh6zh5zP7dweknU16t6AYXHMrmd0PoXJgwnFDo091P9+mYov1vkSChUHHfONP7B8QF4qCIvLLUmSC0w6GDPnxIG3yZo4nUqtZxBywM0WMOpklZd0sbOMBk0J+j0UQmb0rcD5wW9nNnns+/yD7IrigIQFjWNG/hxfZAsj5jcNMR6DMLZBlDPNAkQ3h8ImVyTz6b/Igg/A11uNCkshCEldZdYYb24IlqalgnARbKlcauBxzSzw4t80m7tpV27Xfz5P8AG30wmiS5mcTUj7uM7TkvtpJZmjAP1m1uB7U5idt4ZEmhtNxut9SDuJtLoVC0lH2a30EjFchsRloizMaQ7kOJazX50TwvI5TNzLAvtWAymVQiH2GSWRY/TE0LQqcUNa2vVcQwBF7L7kQOhBGKkaTGVfCVbeKkhTdvOE9nOa33LAxYSHBn+eoeTOjEysCShUFi5aUDsLVJBr/iTC+Kcj0tqwG2D/zj7EgTAZNRPRzSAzeSejraZvmoluMDi3ePzeCYy+GpeZibLc/Lsbxkh0TajxEceOLqoVIbdSLQ0L4CcsX55YuRYUxazVEjBb1KwUky8SjHwnP4r+d28EO5PdfPNeQVD4OsuJ0d6MmSVhRjUW1TI+n13Ad3MQ/XgCN//0JvQOe6UuE6kmAZfxPHsgLR0rWkG3w9p+/OsTePTzYxs3KUZ2jTt/lqHwfiDGD3p9zi3UJeJcZIxR0ZJk0CgUk8E1krElqqFsAYvKDMp8RAvEsPw+ONyxJIkKnhg4Zy1NEAUzy364D9l/x771cfrBfcbmYUooBo8NX9yH3vNDqylNs9to77Vw8OZh5T6QprmcPEkjclmYKSOSwibk3vIHLGWMvhiRcHlcAcZfnUHvpUCWhCU4zEkOvn8L8BsiJyAXGEgpYuCYolBWYaiuFVDCtiQtZQHdOlCVnGAZeErpKRy+/By5DtIgX6oARRacuVKwdRn28c8+E8SCVU4W3iAHxaOXbsr9uc4fXi9xRsfB5xHx3KD7IrKh+2SBXcwu6DbDO1kp3kwEi3XMj3+e48pDdEcYbPORnVwcfGfH+fgy9+mELRr7pszc1ZFCWLwt5v+jJURWJxxd7cf3Sdbq/dsHUqFM1SKKcigKiullM+eBRmBXwU0YPSkaCvzScoaP9YHr9qx1oWgigCtpkKO2jFlXy9C6OL3ia1sXp2KVWNW1LiBEN61gtwbhtEz9wdG1YsCi7G88nZAZN/3G3I5OPIHLKmNZdmwaXu9FRpSMMwhqSbzilUow1ro/yFqDLuazAKMII4klRGOJuYigizyaNOHSZLZUzRHkvqz9UK9zUEIBtNqmAZpW5cQ1dVfQ1i4AH9mrxXWEmlkrppMJ+W+dhAfKXGaOtkjT2kJNsMSItQnRheQb1kVwXRWBq/DY7QY3NtlBB7ogBOAK+raMyV3HKqniYdcVT3CzIBiLzM9FPHZx86hnWRT01C7IEjDXudXkhVqt6ftj6rK8zzZd52DGuFvcUPJJNn9CwfCrCMPvOfJu0S+KYIypGeGEGRZtN0l1zEq+FpSoP13Zs2vTImEBPG1t6OldkINaqvla7lUryPZc0ECytFmYoWbO+36Y8ck6tuU/uYexLdR7RjlLTmxtIiyNA/iGSIsRijCzAxFD6Ohc0HVfoGKdv7dm9MRkcW/I/FlgIegcvGvlC+GpE7OnD8KdxQe/0UknyQIBQ0Y6CXoXAZRFbpGN+Gu1MNPYUDJtvS6lEle82yFNl5kHB5UTH6o13STifbUcrawBbJ6mUE6oqaNYep0F/6ekpYFr17d5KMYaGo0ZpD3SHNdqk/URdcSghTqttdBhSAUJqQOQ5MdYpnEIgJGJ9BdiCaiQSjBVn+cXUxQSW5YuV9ZKEEp/qAShRCIv2NrSnh4RXWtNWG9U+0GGaKePT/JieB98eTq4iSs81eIXmi7XkjKM7WHZ2ddnAM4en0J/tA8aGXh7VkFZvl7fplITCtL3dDSFy9FlCSzUcUkqLy8uYToeM3TO4xge7MI4f/ewMsl88cMMS9nNgGpDleCWcDtwPQEUxgNAJXnE1YhKHj84o2W+oxdukJ9HeKlahq3LVsAkxbaWKpkqjPbFBs4/PDHGIuS7+GSUy9EHVXDUGSe3oyHqFkaxRhRCLy/wYOZ8fnZOV3Ab3SkHJOzjrx7JXDgOxFzWPjk74f4hSV7Awhpd5Cw7V3abg4PKBeuSZerwaM0CENZ1UAJNrOHgNRwOYC8P7iC/FIf7nMBnjDTwpnGCxEWZDGWHI5ch5/LwwRCODo/4OqknsdCg5AJSOVWcT4Wzhpkyy8W5ZtQ4ECBWhHC4mcJ4sCeQlse2u7cP+wdHFZSmRBBzkZRzhjHvngtX6Puy9aClytHet/kaCFaqkGmICnr9vOw4HJo/Ni3VhEY0p02p02vW2JhXzHoDQzY06dzvYDAATbAUWHERrDBJBR0kYOpIc4aSxzOrjlmBrp+Vpj/gfhtmKN4LX0ngr3e508ts3y0jMGysMHdRYvq0tFQQroOVQy0RLNjFucQkGpS064MEUScERTWRIF00jZ6/d6j69glQkCA96/Rdoxoo5wxFhaIIKYAfld2fL7DchxbwZ7OKF34D79PS0ijI38AgWCpuSC3DFmVS2fmsMNWvMpUAJwwPsk1E72XCLHhd60IFycDcvcAJxgSZOrWdpIvxWtOSeCVttK8Y6gKkVzKPhPwS5tPSWnZFKEIQ0G3uR7WqbLqCEkzFEmKVNbPmUmnC0uIwl9Q1vuwbgsucC/xU5WjdOOk9OhwpuYUOQa+pNDklsMJJMCxrJYximeoin1kMKBPxlVA6BpoJgmmeah3+q/7est+2tVIDmXEItvM5qfBCqOF0cltHvACk75707fjJC0KKemA+QYpiUVpOmEs2nWUmn1MkqFCQ8QaWp2s9I9YNPJaIOW31Zhk16OU8gcw6Km7nz8ZQH2NIwK25qcqVyWztESTt28UNXlgPVZwAFWpgNKT1JOGs1KuKS1SGtpXCJQrYOvfoLOE6ErieCxJNU8bh5Kk8K8gBUr0WrJuzCN2I2QeHr7slDTV76lN9Os8SdOJ8HQdrditFI62/AE5LSynbJKgxSHIKUIuQe1UQObjESyuqoSxHykWwLF3vKUkZaIXtcedwKkkRNyu+X5lfkcSLEmwZRpo/x3Md5nvUU2YfOt+lH1ceUPeokJjbeIuTe8qijUdKXrAguyIArgc7u7TCY6qFEUV7Zf3X7Y+MjmGKeHSCQfZqKrODajwUmBmDVW9qRkAo1UsLsNG0Gsn3bbEhQKkpyZjN9QVGc3Xo0Sw5WKZLWW/bHc/1aOXnhFMqPh3MH4K5GdtB4LUdRCCuoKYVx+DQjz7VyIKLxS8712YMVmt0fQHAHIMEx1hglkYg7p1v7SxH51NAQSpBG2Al5hPLYAVSrVVUAC2/c7AEG6BfQK+TtIKU6BwUXG/xoq0Lb60Gez3fwfUqfe92fEC1MRTeWzC1QBrm50kBO3BQ1yBew7Tr0UoCKMFRTJXXRYxSx48qIqFHkRTOur66WXaFMsBuNe+jAVwSV/fdjTve/2t/ymBKyKrNxcXF6Dh0mdNyghVpLQ9qm88G5ovi/fkCnDzdFUouEVLdj8f4vE+/NLDKIwD4PKTC4g62Bnd/zXgJxMjzZGD5Sc8YC3K+cYXCkuH6/ADWwf/VY0A3GVGznMlWxRjrbd28u0E2zsqmWSR1U+qyaMkvNjWikvP6SBKe0xf3jfdidfAMLP2XbfGFeYE2APv7e7fJ2t8UjVfGr4H5SCtbgOJt+y7Hmqj+qFiAT/WVgd716JMpxDyAqr5u+07lfHcMpe8SX3yyyO6Pg61VUgUIUOk6FMRTTUbgkvVFME/EvAYrWNkCkMpEAUrpGSy50TYhln2k3WLdnHtpywZful4fL4IiZG1LcNStP2hWXLvA1mKKwmSuvLpHiwwfBbuPErlCdZlr0n6k9fxaimWG+KVg7m5ylFy10O+nTHouOVcjGtY4oSVN0hbAQN837+mUvuP8QpDlXpZ5+1GDLJPqniOwaxKkNeCemtaQB7h1WRldo5XQ1AFrwgQLapbEKSovhThdrJ+50jS5H7eDwr9Km2Tw076HWGW02lbwc3noQ7agMJICKVP7yboseE2iWD0Ix8BPMYoCaZA0xqg7QRKBdLNkcyPAMFILfHoOoPj0qm9Q2XlfL++gt2zN/dTXgMSAVPadstkCgCaQtZXhg4TBzXPjKEhLEPqTLyC1oG6JwGud/v6PzwH4Yb22civVMmaoN/lWfYsWU98WvMFijyIjj3AUDrPggwVmvWeMfs+RE4K6Kpc1r0qrJ2IBHNxLatX8TZBGtUMaGIr6UsRUkydFG85V8AJ6Ms33gZomoHFGGa7uT/vGHXsAlgdwH42LA1lwvbpwV1bZ3ONWNsXrb0NcRKujoOR8qINyNFF5iEH9d3SbpvDYTLS+EZxtSCQl95M0SRZOCjKhDNcWcASGOmvT+1HfTWNKEp0FVAJ2pZMyzoKItD7FluX2NQl55VqW1gJDDV1wqZESm2A1GTALsJqQTL7n9ofqxEsBLhUGgttbKgU4SKVEsKje5BMxdm8l+QoOBunCjboyPlXvuLA5tut1PzQvWIHM9FowLQniJlpX6TQyvxoLIlG/jk+8t7OqX/xXn5S02o7smKju7xhVMuxkrkw3ZPE13D64sbBShBoGizBUuTjjloOCnFbRfBsvrEA2gFgCo9VcBLMr8lFkohNUJoJDS7pzLnSAOs05xmpt1gsPIFUw07aLOHdoGN/5/nIsVA/bARS0FKrEuMBWs4YVaT15gMsBkKzgVRpVjG9TvUBu2wpD152ECsJy32VTF5K3NH0iU/ci6VjMh0tekKrfCA3Wj+YBySxBt8/EYjlSdvfb6VehtW1LoYXqwL/tg+QXRXzqqaGtDnD8XR/i4Md/+Fh3iZL6Lv7BUBO4BXtaFi0O3cZZ3ov2syWlMmaod93xLQW26gYDue46T0V2aW3rAZoPnN4/FQ0v9R9x4uXH8Nz1/NhqW1cog2wZAbeSJu31nfovtYKqb+1mJhbh4j74AVMAj3yF+nTd4aFuSd0bdjAejbldDJXLXYXWsCLGZok/NYPPTY3OR/Dg869L9dIwPuP91iVcfucZSD++7yS/4aPFOVuClDatoBvqW7e8aN+qBFD7cYUwVhJJLmsWv87uB6C4pwQP7z+A6XgC/X6fn6Bv6nzkurSWcnQUBNPL2H1ndwe+/M0f4PH9Y7j96m1oBr1SF0rqmlpweQ25C9S80WQM04CCE5MnRkUYX4xYi+kZvmDQVUmTtWgbcyWDptJG7vdyZAHVGIZeazyFSZiVHCC/99sptZfR0brEyeMTuDy/gJu3bvITkZIVr6MUEVb9rwwt8cGn2LMWjkYjODs9g9OTUzi7OIdJ1prWSsvlZyyZQd15+BmZ59doYUwtLWoh6Pmr2hned9f4Nv67lj9Q43ezUh0cHsL+/j7s7uyQpWt+sqoLWs+SZODf2cTstd/rw97+HpWE0RrUNVgdRanwd16Tusf8d68u3h+FK6696vrwhONQBIAPlA+GA2I8CqNpmrUxH2ltP1nmNQY/40MUO8Oh/WDHXCUS1Cf4vhYCJz5ejMdOlKAsvJSETbfHKIMDWErAfft+tVFnHHiMBCBP4/cHzPwY1lI8MFqbBSBZ0U3KD/SbCqmzJaXjIvyyY3L5glECW7Wy+3WCdWFsvXlqkY/uXmt1nU57Bgex/IpuT54L6BQWV6W1/v8BVTYcWqhq+gtMP6VaEJVQuu3ls99aaN8d0xcVymg8s7KdpOsKraq74D+cUHgcIKyV8UrP7D/xWZSkqMbpZ6Su5vt3386TZ1D3oQjPJH8tarCOS4HD3P1jWtjPs2C80jMRwFUDvmpSdZa63OSflI0+aRxPuv83SeuNKFtamrYC2DBtBbBh2gpgw7QVwIZpK4AN01YAG6atADZMWwFsmLYC2DBtBbBh2gpgw7QVwIaJf+F6Sxuj/wPEG72A9j0S0AAAAABJRU5ErkJggg=="},5957:function(e,t,n){e.exports=n.p+"static/media/App-Icon-Android-144.4ea1a426.png"},5958:function(e,t,n){e.exports=n.p+"static/media/App-Icon-Android-192.1d9e9978.png"},5959:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHgAAAB4CAYAAAA5ZDbSAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAACRzSURBVHgB7V15j1zHca/uN8ceXEqUKMeWZCuyJCh2DAfIYedA/gmQL5L/8mkCA/k3+R5BAjuOgcCBkcuIHSey5dgSRVviihT3npnXna7qqurqnhmK3HlDCostarUz7+p+Xfev6r11s/fOIlzTlSUP13Sl6ZrBV5yuGXzF6ZrBV5yuGXzF6ZrBV5yuGXzF6ZrBV5yuGXzF6ZrBV5yuGXzFaQSfcYoxQ+XOueq7bGv3t+fY48Hhf+a49E++rxunvYbdb8f8rNJnWIPrGogu+NpjIh+TF96tuIbj6yjDYrm2Mov349e8LdJ5bsX5lfA85n08bXomDI78b2l7tWBrtKPSGqu1zW/eX2t2OV2Y2jLL6Cozk7fhsZCZLj+r7szeS77ms9XyZ2CiY1kHc++Wua1mCCNwTUNYNsmteV6nYa1JX2V62/PkuFXXxFOsoLQ8b825dQlPi56aBpcFXWbGKlMni1Nr2Wpf/Dgms2XoOibWDHNr/Ww+Znl+7Rzs3By4tfe7Ldo6g1sm2oUrP83x6V+Igb6HENZfC+JyIPWIeVgSjVq1T77jHPrQ6zgypj2mDeJaai2DFZqnweitm+h1GtD6wOqcJrJda76NQbCCIOOuYqqQHE8M4+iajrefzXmVoPE5EI2gxHre69zBkuXYstneGoMftbjrTOrjSrRdVDnPmtX2Wq0fXZ5ssQbESMcb89lL59IYEWBd+lQuGznyXjF/e0325W0aNwRthcGftuD2uHXbVkq9K74sa4+NnuPS+faa7Vxay9K6Efzx3hPDifGxaLDjf0i4H4+zc1TZYBm0Q63K3e16WXcwBA3K4E8zSWuPZTOFi6gLGbIPxO24gOQLzaJX/oyH8J0vwcwa07dKEISJdjtuw/GXcmaj2d7nERZ94NzbVcFhMzLAI+Zjz1klgJel4RhspfARptYyxgZNGlilz5gK4b+7P/4VHP78EHYPduHgpQPYf34/56Mh0uLicd2uh8neGLppR0JBJFrEa6QCV3hTRbUiZCExygZRd390F+793yHsHezDwe00/nN7JYNn/ztOY4/3ujx+Iu+8CtpynLE6W5D7h8fzUE9EgzC4SHlc6Wvl86dJKGlmYtrRR0fwz3/zfbjzow8qjX3r99+Ct//0bWIQMsP5zOxRN4Lp7QkcfHGftiHhQmOOgL/xGOvnaCFxPV2kfbK4gZgS4DAx9dvf+kc4vncCne+yJUnzffObb8Ibf/AGXQO3ZzqDvu/hxsv7cOOVPRozLrKlad0U3Tv7ZWgCSWHu42YFj0sbM3j1ZKL6xjpwKZS1Nd8wXgMXCenhvSP49l99B84+Pofp3lRNN/6+96uP4Mvd6+DP8+LKQi76BSzuLqCf9XDzjYMMK/psugOrtYtstqPNyZjXUeYQ4MGd+/Cdb/0TzE7mMNmd0GFJP+n3xx8ewldefBsWh4HGEqFBITq9c0bCcvOLN0hwcFhism/chfHLbazSav0QZnpQH9xGt0iVhDrjb6AELpHMcqCf7/719+DieAbdpIOxH2dtZc3+47/8I9i5NYXZzxMzTzLTkcmydme/Pgc3dbD/hd1sQhMzSZMZV3Y5TNVxs4kOOvbFyQV8/29/QOdNdiaV8O7e2oVv/MXvQfe8h/nDxNw5VP4emXr0i2MY7Xc0Rxw2ojCx2yBGr7Bi67R1KCZvDHQsJfLg1ib3VltsMIPai79/+a/vweJsQYuL2uPHHrpxYvTOGF79xiswujmiY0cvZx/Xz3tifJgHYnTsI5y9dw6z07kyzUa/gZkpiyfjogXAzz/5h/9NwnWRhWt3DKPpCCb7eS5v/vkbML45Tsf20KXxcUwKBBdZ+HAukP57+M4xXavn8SVnXgWIrEslW9e2CW2gwTmKWZfLrirFIVmplahZNPjOD+8SM+kc9K1+pOd//uu/odcIo5AW2cHsZz0JABkN9qX9ooejd5Lv/Jon04rjkVB0I511WPRkI4Xh6M/vpWDuzr9/kAK2iQpgCp+IGbe/+iJ87rdv87zThjS+S+42HOU4gJiNu5K6zJNpv7h/AdNbO2Q9cGzy1w6KuY6uTqeatWs/b0IbMHgZKxYSM91WjCzzRcNEk47vn8DJhycwmoyKaeJFmBxM4OarB7Wg3Ew/B3mRJUKWgGz+8RxO3j+D/Vd3iYnIXBrLxWKmU9olUOT8fA7v/P1PSWMpKJN5JqGZ3pzCK3/48vI9HKTfD3KwpxTyvE/vnsPouTH44KDruiLsTaq1XIvOef2qXPmydGkGtxOoJgUF510pABpMoITP6fPZ4RmMp+O83deVooMv3CAGdSOcbjHv49c6mP14ATDLTFvMF2Q28fzTd9P1bnWUxgSfzanMNcSi7Shcv/iX9yHMIpliybWRcN8r3/wCTG9MmEk++9bkCrqbHSxiTyYaiYQr5vB8dq+4iOye/HIKvCqNW2L45n740gxu/UUbCeaDSrRcEUupRM6oRWcPzsg8yo1r8JK0Yu+lPYUPJWgi7Rsl8/daCnp+1GsgRcf1WbOOfnwCz/3uQdIkNJGBmRB0TPST9945hI/f+Zh8rowpuPOt33wenn/zORIYYTodg9eZJL990WuqRufwfeLYZJqT9npmer12RVPtesZHpJmXpY2i6FbSJJ3JG0HzTftdoDhhrkh6nzQBTWQdlGUGT5+b5JQD/3H64yHnufFmOj6553C3wHxisuf3FnD87ikcfNkR+NCFTgMeZPD5w3P46L8PCaSwqBjuH+2O4MWvvkATJ/DCofZiTh0Ku5KLDueB9lnUi4QgbYdxEX4cD32xlBnp3pv1EsizMDsLwiZaPJiJzhtBNWlJ+mIJvPrY6zUItcIbQF/LqYkVGFwUZA5uQ42g8UhryOYmxUzHvJpM/YcLiBdNGpL+nb1zDjufn8IooU2Un2r1KcLh/9xPdh1gujvlbUEtxHNfOYDJjYSQoWAk1+Bc0d4o+PQsZGvhMnMj+2DMvTGnJqaGPG436pZ8bwWpRrZ2VfBVvlyWyYMCHasY225TNAlyECM30CXtVQ3GyDQtEObB9D0QdEG+DJlNYt0hNNnDOC0+BVJvJVP9n73Cfoox9w6O/uMYbn4zARBeYMaUs75/DKcfnsFop4yJvhV/73xuCvuv7MMoXZsELDG18wV+zMiWJ+HA9EyQLmESCeQYCpADTbEDVuPlulZu9dpehjb2wUKV7wVYBjzsd2O2JVVBbcHFxhQCt2HAJeYyLMRso1XOGqwRKOLR6B9fSIx+OZnC90KFYCHT5km7T356BtPXk6lPF1mcp1TqvRMSKBImBlLQVPuxg70v7SgwIszVAI1bhmLSXjTPpLW+xpNDF0iYCnjF1ih2NU7OcKmN3GUtbYVqk2BrYxP9afuWUgQ2ZRLIOMbtxgcjTVPaYgAssknGKNVrCpU1Gs02AhV0M693ML+bIKaLupCBJvTsJ+nc2+m0XUcpFI7T7XY6RwrA0Gq8nLLnnREJAvpcCq5EE9XiJDdzVOBKtDAKySbCAgjl2XyfOEe7NrbIgURa74z/NZnCo9Cux6FLI1mrNNju0x8wiy0+yGhgyGoK3Y2OomhErxD6JRQrIUr4g7AgpUCSQtEpufJEvjmZUTSnaBYnXxsrukRKjD+ILCZ06/jfzuD8cAZw6vTaKFT4GzVu9GISslujXAbEyNm5gicLk/leLn45KwBLH3O6FPN4O1+cUp5tUzpFtcx6STAolkrXMTbrukEqvBUNRtIWF5kcY8rCcJTaxWJhTFHCf2+PoX8QKskW6DM8TOdMyzkUReNhPIzn3Ll7MQViryYN+3lfm85Ei/sLGD8YE1qmbTbiq0fp960FfUdhscBJjqQZak0MXSzmMPtgluDJzNQWZ/YvFGxA1gK1mH5jdQpYY3leZLVkmdYEqE/dB8tkgPyL9Q9R/ZTOjxmqpTlDUmnCs31Cp+AMU5KuMYvpuNNIzOWB0zX7AhSA00Wcz+cwfjOZ7TtzWJwwCIGeu3Ow+9pu9u1Q/ByZx/Qv3EiCM8mMpDqz74wQAOXMgl2fvXsBi+OeNFeyBvxZhAXsvDUFv5vNek8MzUEgCmKX7itl3zRPjLDlPCvIds00XYzx2UTROgmAldGzMjWYwr7LJk3+ZbiSPVtiAqS8Fk5BJV5RJVyQ07Qw+72aeEe5sZj89Fk6QBKjRl9PzP5eFghMy/Z/Yx/2XtujhbYoG5rvfpzKjZN5DoJyAJAiYfT7QMhVz3AkCvLskxk8/MERRdB2DXCuoxRH7PzWlHFnz3EUDpgFVhwiCkrV8uN8ZW2E2Zapz0yD22BAJik4M5ikniJM1liECWl7r9FXDkqmeeW6PvlHlzFkYmAKZPwiaeZZMtOJK2iSO9RcBQRCSXdQW26nva8lPvw0aUwq4d14O6dJlI+yXyN3MQ5w6hN2zOkQCQw1CeBvBChyjIDnzB/O4d7f3aeCAmHM5jqQZGf6JxMFNzyBOSigga+XfTCBJt7rZ9TqfPt53TxLgVy7RQqflDbOg1fBk1QtkeCBuylQanXSUMABnAHmqulO03/JVOJPSjMuFmew43ZzLowmMy3E4jz5yPO0nCmq7keLVFXqebFQSdLijBFUwBgtUi669zu7cHx4Are+egumL001LaGFYsz6YnGec900LgVqPptziRkIhUpp1ekvzuHhfx3ldqEb3CWCYBrO+6XE3LdT9SjNIV4EEl6qeHGRw7mePmOpceSLSacyI2SEq6xNrHzyxvzZ5E13VeQHtbnSWixmOSmNcRMPOy/sEeZL2hqjmnbnM3iBVxEIM5vJEoCRBn10BofffR/ycMwoPu/Gl2/BrW98ngH/vL+XZjhmlkarEh1bQCE6MseSFqHWPfzgE9oeTQIvY0ux5PiHH8HFBydkfbL252Ds9p99KaVL7O8hazHFhIihn2ULIEKFJChdxWC2Dpc1z0iDdHSURSwBlWgvMtfvjeDG57iVJoIuhqYQiz5rNUXZ4iMd4dNAx/UZ76UINgcpmlfz/3IAlHuqpF/LsT+NYkmYJKcuMURe2A68BjwhLmh8EYQ8VYZI88c0Ts8NCyHnzS4jbhBLGdR5iVEytErReWJ8wAYBrofT/Tio8mDbmmvd4JPSIFClY38DJZCmVGCOpcD0b//WLm3GRe2cM5Bd/r+Yq07aXmMBDhylKgJGOPW3wAAJ/esc49WZEZK3ynfJZ4Gi7T5rk0S/OQymY4TE7XjvKgviXG6VpfvTKNfLoCRgaLJpG5iWXlevFW1M852fz8ocOBXK+ffqosNlaKCWHZYwsxDZTKftCfobjUc6Q1uOy5INenOekSM1VYg7Q9R9ggJJ0T6vLV8viJZmLUJhodTLO06rMsM9VXSAmYyC0WkODXw8aZAX/NvpHNREM2Nl0UUDVXDp/iSFysdUQI/zqu1keVjj5R5lfUq70eVN9CUZ3IpTCfklMCEgYzbPfpQOEe2LS9E3QYLMBKsdYhad2adggrTD6vjFt1JhIERlBJBfK+ZOFlj2ZROezawISYy1SXQm35XrZJRLBA9AfLNw1ZmVImFypWCBx/RpjeYpt68iZjOuNdFWkZ6ELsngOjcr5itXeyhiDrkGWh7aYtBCs6JYBWfSDVECmlp7xHzxwOVc4DQGYrVNjo2MRIHJK4VZJY0r0b31hZaiiR2AzaZzYi/MsVG+R10pDdFsXgvcNsRrZDXXrqt8F1fxpDRYPC4TpACn49Spj4TmWH8qjBBTnNXHaCK5J85HQUyqgAB8s/ZJQjaZ2KIqoL7TNEMYnRlDeaeU/WheZfFLQSCb99rpiUCDctVTaiO7HaN3TlMdqnspDBsr7Rd/QUqwKAyWNdFMwgjiUwc64hqvT8ydxapjMk+eH+3wJZEXxqMfdGq2ECY0K8+aLwyK6g9ZE5kZXsp+UquF4rfzmPV8cwqWWZefLQKdjyh2hXjlT/zdVn7K9UizvbgTUxGCpkIE3I/NgiZRPiqHNDeU4zZrhB+mmuTKNimaJ8RCmVtuDGTlygTY/wKb444XXoEG7pLIqVExUzo8a7b440rjjUkWvyqMV7ABitCJiZS0x7qTmvh+vNOA0PpecTXRQK3ZMnUKS8p9aC3YZeWQdWxx6cvSRia6mBww2ujZbHKOK8GLmaR2NDATsmnvq8BGeems2ZN8UnwvaIAj+SY1nfe9wo55DrHSBPGnYgqtX6RFcaVJvw2swByZ69q9+uO8TdbGmFdOt4Lm3+Va+pSFCJTZV6xVWbknpWEePjMDq+b40kdF0a0ublCpF6L8mLFdYUbWsg7ETQsTpSEg87cOtJCou0MYgufEunnNznMkY5rtHUOfEOOSO5GxXImZGXWSScYyV+c1nSNwg6+rMsvIlgi1Wjnvlsak7c/CB2t0G522j0aOSIH3H917CLN+BjvP7UIF8gujOYpdFSm2N4nacrJzAbPDMxBwBNj8Hr17CuH1cSr6C3gf1PeRgIHTXipNaxrLknlRTO3xJ8egtyPHOI6mkREJ6Xrw/q9hcTo3/jKl/rd2oDv+BNyFU0skuJQ8+4YgBywi7O7sUvxQTLeMU1eUnpkP1gmEWIER0glxcXoBp0en1PVPTI8FuaGnAricSOB/dBpsSFtPlQumony3N9LxBPSg54tOUgH+YsHXM73Ygb1FzOYz0rWDjq1RfMwmG2MI0j2Zn0TvIKkNWw2EKGd5XLm+mFlHvV15ab2YDwBlNB4zu8CGgYVi37JPqmdyz5vSIG2zwmTEne12DCqw63FnZwd293apohJjeXhb0qQqJ84XV7MeotXuVHDY3U+Vozk1yCmMx49q7u/fgPENfraITT2WB22MIE12onFQ4iLSXvs8cL9fnlooUXMWLCoauAVcTBCGLS1KeL3p3j5ppg0+wZh1/K+/SDDuPJR+b0a1sPiwqgnvqZvoMnETYKXJ4nNA80VCsIKnFAYXGNOgvXTTNt+j8wAq5qopM1Ew8MIRcJ9+T8YT2JlMjT9z9GgKRs8702Qa+dmmfDlXuwWAEgsYRmmkixSBhSDCdDIrqRL7U+svF3MPk9GkzJ1xaZpjEmqpmPFliTp+xOV8NE4Wfp6x664GcuwrJS6LYAkN2hctT9PJIgnIP+rqJxa010nTFy4kgDPRcvGFAiNaZMKbNIccW7T5sRQruJpjSnVgol2q5cYOJAqTYEtSM2nwy90j5Rgv1gCYqRp4FXRMrItKYgQ9TyBOFHy0airwbjlNemY+WKjN1zKAny+L2rsUOECp+cYlZpXFkfRKGesKEx1/V1RMPkO7IF6DqsDRjphvQqvA2ThcF9/7FskqbkSFymUMnT56x4E095fxd1ZrEKHLp3nVbEHsQNBUI5zVeBuY6I0YXJlXKOZL+7CCLDKbRgxMQqjMHN0f13Al4sylQfMiEwAtFjjV+lCPL8JiQAyBNSsfT9bFE5gRuOojKZQwVmBV8ZyRgzCZS5S6NVoIAA0M5V5cLOkPmJiEuSirZSJzVwWTsToHLs1cWg+4JNlFbM0JzpUgN2AUyTC04MXOmOyuSYdiZbZEILTPizXdOWcY73LOC8BRtK5yNUfVUKiDHzxWcGpbG45QL3TJ0Z1i67SPtdZzkGb9ugUuRFhU6CVG8PU823MvS4P54CowQsI1dqKSxZ/amwgC+BvtydIcNGctz9hyv7KJVjM2nS+d66pRG8xz2ysQ0wVkoPk2wL5oWIDGBMtxjRYVS1D7ab0/yGZYcnTPYIqMqT7YZAh+lJ+q6EZ+5dpuQhsyeHkCKu3ecfOdYMVswqiNxdZQ+YViHBRhT7QsCq0/L7gVbCktSm+xmEMp3BdzV54F1los1NoeeOFtG1D2Ag1DOVpy5j7V1US7IkYjAZTRuVWJzTfE8iQjHoPPXnUlBrFavIl5RtqQwU41sPWHJLFcGaGAgvucRUPIj7G57rGhXaJr0SJqHiiakvNmMP7YZVSo8XHSzJ41ptP9WSTMm/JCybVtcAc28nXiR0HdTMaHPQlqDhZdnT4xQFJpXyzXyvCmCSqN6wga/IG5p81osKY7uSGcKD5d0Eqh5LES0Xp+zhZvkJgvplJMsolkRUhEiIL6V9qbe5D5WpkX3KWpD2VnruVXRoTsa7uindp8Llpr/SOYofJs6LrOdnNIMAegubllja6N+lwnl8rHs/b6LbzdebArepOkI4lmCzlTkvOuKX5DiTjbyFE0OvCigjN9W5yjSo4J1pJwZFpqt17nJc3yOjfx5dJjHYMKSvXGOjX9fM9rgkwJpqKuja8eB9VgNJq8m7ltY44haMCODoAayGDfCzXzJIpWX2gYLbVhK+m200IRHtknkSo31uWPxeTJGGL28niy2Hxq56uIVqJ6mW/l313N1DZFJFjUOX1VA/n4UF72JseV8ySVkwrc8nU3pe28L9qJZkkPU95c9RzF0tHRagA9AWCeqRWTbklNomoyFPMXo7bHCuIERWGqZ54C5+p2GzEmTyi7Fyl6OLEM1a3mcUNJy2ygZNNCi+aJv6dYYeSV0Xk/DEbDvoyUCYOMoOU6AFu4thIaVoAeNCkOyJCqmixkcEGuwx9AwAoBJ6wwtOOKjywN7E7PWRoTap/qjGURrdMp6Dsp8bzyumOLSLVxSdbanCLpi17UasAgNIiJbv1m6W1mkwYr8sfmDiyYwRvq6+pi+soS5GDXKYAg3SFZGOrjkLSrgsfA83rWcjW//FnaaB3UAiX5uzJQmhT0fVi1qRX/r9mGfcqiD2YtYrWOQ9CgYZtKq6+hNzCSbH8UbIDij8VsCzBP+4C1ykkOY8bj3/Jsj8QAYI4sCFg2mQKqyPjeuIoK7ACoXpjKH4rvByhpGee2MRh/CyKkUaN5AWk0JfNQAjjjqoaiwXyw9aPaANe54pO8rzQZSXqnrOa2/hhJiwBZbQwD2fe58vSiNYtdw2gnY3YZ5Qryri6oTbikYXhM+34N0lZffC+hZng9farC3KOr18Y58+YDkwEoIrYFGrQvugoigJ/0lyQflpkni2cL6pZEmyvzbg/gKgySvkPLnNvOT46LIWhdVjTY2TFFWFbMWcqgOkasNVUi8tLwX8Yvr4Mw75G2Gr1m7pvQ8Jk1lKDKScjRC2QYLKpXBVtIap5N7ik5ZH6Kr9dOEI1CpfLEUaxosj7fIwLi3FKAJz637a7MY3ZLTxxYC0HftVIFFUMl3aF77vvqPhzPWXNIKO6phSmHoK0wWGE/KH5HTKZnzZWbFkB+VVrRNUC95pZ97uDIzyHx21yxCwNKgCdWQXyuzY/tOEj04LdrQAtTsrTWwR7jfHmCIneuyPe6epUFIJrz6wY7C5O2mr8pDf/Gd2NqIptQQbnI70mt1UnvMVAy1Tafy/Uk+OmlBGiK61nby7uu7AvLdA6sgZ4b51tTqBptU6hogiK9Rnm81UKP8joGsVIK8phriKBHZiTeqloF7kQtEfewGjxokFXMoQQOoMEKLbIcm0/IkawJpIrUdyCVIGlvUebEJtXiQKcq1tto3JQFZbnbfucYoza715oXNP0RIELujeYMxQVI5iBFEajGWU4lxWcLKGQj+CFpMAZXEazN82QgflVBeTlLRpD05SnWt8UmZeEn98X0juj9lNwea/PRWPtxPI60T8djxjTaClBy5TJmqAQBtPIj3SR5kzzJIZoohX8BLGJT/BcBYFnN18f16obXXqTBfHAroZkpBYRQSTc3YZkbQh0IWaZTnZij3r5fKPzYdk1YUxdiaaKzzwZbhhKjpfguAaAZv0Tw5fwCRkAxzZnvRWDacUz50OtzSbFE38PzVWkrQVbdflJrs/Wxmp86rivzIlcmGHIw00sTnu9MEGfSCzbB4oc7U25UxrqS64IGbH2ZN9RrXTTcXkfmZ559Mu/Rspi3upnO13Nt06N6mQalrSBZOQuoo2gwaQ+olpeFEfOrAIIxYVV5EWKVN+qDXcY6rCrNiR8OJsWx0bY8Ngo81zZgbAU2P/4JVTRMAgi+4NfOBlbltQ18QVkdkFKhXcehaFCgA0kZwb9Ko5k51oD6AjTwyZwe5b/NALFUnEDNdt31DwwN0l82CeV1g5UrADHhoOiWM2NKy07mX9Qyn+Sm5R7BzNtD5q1hmAgKgHEzbWQu8xa/DoobbCOSHtQHF5Pq9HUNBY7jG4UaHQJXUJ+qlQVyalR8ly/Bj0TJHL2SfwaTfhkfDiZgsl0awghrHQRMEY2T6BjAWB8ADZ5Yl/VlMcLsIju+0mKxAJpzF4utpcKhaXCokqS4D1pwj7Cc57XBEe/ID5EtFpr6RM6ZbSmvj0VDOqnShPKskWdgo7iLAlS0xff8usG+NOLzPJxGy2WO3gkToVikCPqgnEWhQpAA0HBw1XqZTKGFK4eiwTU4578mmAF+pCWEpRKebVK3ApDjmgij8Tjjwnwd0aIiQIIP+6pYT8fCcr3ZCpczWLRcGz91KkyZg7lH26nv1muosrk6eMJ3aHZOcecQTLSsGUVkuLKJJz7rGly+lI85+Q/5byuE8oY5vSk9jieE+et4xIzMlR89hs0tLqL4WhvYZd8ZC7O4cSAYzFjG0Ncm8Xer+W1zfn7brI0jxGcGyO/VkrKi+GxXmWMpJUq6J23CFFvFLeZIMHAUXflW2pB/6P3Ifa8BTZ0L54K7nB8jaEuqmFX7BL6YYvxdAQix5KMC7EunZbEUfGyo4UaaRwjq8xc8V2Gic7Cktdk6eHObrgAY0VbAaotlCxtey2ywNRoUi27BDEWHoH4dgr5aKZbnjoSZGcBvzmdAInBQ5g04UZOr/kiGpF10nhmThMCZLk8RFPbhMk+kNo3Kt1biBhDBiRK42b4rOZ5XITZon4Ept2Geaf4wIFk/vFRZcfb9TzXggCQv3aYAixddUhuJviWFkTRmeQJQd1ACmKY7J4dovdY+CGcj5yKkJdCSS1jhlZeO2v4ssIGZX+7JqhnpMgdMlD10oDV4V2WB64rZwpd9KbZLpgkKk60W8PnUnN4xK5nJSAJohFj6iNUuIoUCL2rbrJjnFQvXGUAEzfZo1OTYGvyUNMgKgrU0QrovQhV8ZXmU765kVQ1YMrQmD45FV9s4Rz375LREofngcnyTs9KkfCno2wY5BECc8J2Ta+v3V8p+LIAJGA3xvn3oug4UQ9WcUOewqpW+7gRRzANK2pNTtOYvt6X/zs/PSg4ehmes0FaCLEmV6G+jpIVczBZw770PNYLGBbePshS/ZF7x4Fwdf0TJqjmk4QCoYMn1AunjLWBydMmD7XFsppf+tpGz1S0JzPjsSsljhdaRYLDfzXFCVOER6/LJ4X0AfvViLoduB8VCGhyLrsxVl0t2mM8evn8P7r3/UWGyIYmUS6tOMcdI1od6Zx4GB5PDOmOOXXl9BBjNJaNg/Kw0/ck1av8LIO+nLsNHtSz4S4R0CUsO5bFYOV+s0oOP78Px0TGMJ2N6tYXnP9e3LQ0evKNDP/Mdo5ROpxNYzKdw92d34N4HH8Hec/uws7dTpDaSQHMKVHd0ZKYUN3t6+gDO46lqeHCZ6fQapzu/Ajf2hfEtkCxmFriBwOXPwjRBoyIn1ef3z5fOp7yea9P41vaT6TnY+AoFax5OYf7hPc0g5GnE46MTatw/uHEA051JfqOO5N6+g23QRn+zYRVZLUDYEZ/NxXdCnZ+fJ+acwtnZGcxmc9qXTVYwvtFEHtFohQQ0rEUkCGB2g/ng1vwGgKV8U02xjdXWHVymIMcrEhabwZ0BOthNjUYdTJKg7053YXdvD3Z2d2A6mWRQx9X94UPSVqJoIWmaQ3Mk5nGcbmo+mykSZf+AdOWHLAeZIjPXbNDtklOuOi5avykmlxGk6GL5boWiOdfGC+2c9N5jbaoloMK/GINNeePxBCZpLZDR48RYatRz2zPPSFt5+MwGKPI37NEkoR8iyHJnR1+aFrhsFlttgxXfV9IKSXiSfXZcXzT0iS8n15Bj1Pdml4EPmI38iJ67wjUZj8bQ/vmcbTB6O08XQqPJ/HeB3NTp2+AnccKBVI1+kfZFKRtmqK/STGcDq7ZIYTRMLD1rM5l1F2uGCo/tedYqgM2BJUaIZR6xnlO5+XL98lfayt+kkMh5NfgxLG2NwUglGuX3NkZT+uPF0ReKrtEaZZARAGsy1Rxb7cLhpCDkjekHV40lwVUVBcfV41uzr9ui2eeKAOk+ZqrMTdfB+aU8fFu0VQYjFVw2rxyaqd71ZZG71RCdLJLZwCeYSFeOsxolmt3ZCLpco7pu63MjVBaiGhdqDW7fJwkG5LBCaS1MlWW44WHJVbR1BgtZRsurDZFsivIosmZ0pUBUwMT6Pw+3xEDz2T5h/yjgYZVrWNoPTUDYjL/u2kPTU2OwUMsk+6Tg496wBe+tL24b2h9nHhZbbue2LnK2xyDZsqXuh+0z73HoqTPY0mWledV5m16rPWfd9lXHfJZpK33R1/TZoWsGX3G6ZvAVp2sGX3G6ZvAVp2sGX3G6ZvAVp2sGX3G6ZvAVp2sGX3G6ZvAVp2sGX3G6ZvAVp2sGX3G6ZvAVp2sGX3F6pgX/Z0jbb4b6jND/A6YoLt408Qa2AAAAAElFTkSuQmCC"},5960:function(e,t,n){e.exports=n.p+"static/media/App-Icon-iOS-152.659a6e24.png"},5961:function(e,t,n){e.exports=n.p+"static/media/App-Icon-iOS-167.2038b918.png"},5962:function(e,t,n){e.exports=n.p+"static/media/App-Icon-iOS-180.6dec2fcd.png"},5963:function(e,t,n){e.exports=n.p+"static/media/App-Icon-iOS-1024.9c2d8d0a.png"},5964:function(e,t,n){e.exports=n.p+"static/media/Splash-384.bc478348.png"},5965:function(e,t,n){e.exports=n.p+"static/media/Welcome-1355.78b96eba.png"},5966:function(e,t,n){"use strict";n.r(t),n.d(t,"platformStringFromPlatforms",(function(){return y})),n.d(t,"createOrUpdateMobileAppRecord",(function(){return S})),n.d(t,"getMobileAppRecord",(function(){return h})),n.d(t,"uploadImages",(function(){return C})),n.d(t,"getImage",(function(){return P})),n.d(t,"getExistingImages",(function(){return T})),n.d(t,"triggerBuild",(function(){return R})),n.d(t,"getAllBuildsForMobileApp",(function(){return w}));var o=n(222),r=n(5967),a=n(5953);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t,n,o,r,a,i){try{var s=e[a](i),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(o,r)}function p(e){return function(){var t=this,n=arguments;return new Promise((function(o,r){var a=e.apply(t,n);function i(e){c(a,o,r,i,s,"next",e)}function s(e){c(a,o,r,i,s,"throw",e)}i(void 0)}))}}var u="https://cds-org/api/data/v9.1",d=/https:\/\/appcenter.ms\/orgs\/(.+)\/app/,m=/.+\/(.+)$/,b="".concat(u,"/msdyn_mobileapps"),g="".concat(u,"/msdyn_MobileAppBuildStatus ");function y(e){return e.android&&e.iOS?"NotSpecified":e.android?"Android":e.iOS?"iOS":void 0}function S(e,t,n,o,r,a){return f.apply(this,arguments)}function f(){return(f=p((function*(e,t,n,r,i,l){var c,p,u,g,S,f,h,O,C,v,P,E,T=null===(c=t.msdyn_appcenterappidipa)||void 0===c||null===(p=c.match(d))||void 0===p?void 0:p[1],j=null===(u=t.msdyn_appcenterappidapk)||void 0===u||null===(g=u.match(d))||void 0===g?void 0:g[1],A=null===(S=t.msdyn_appcenterappidipa)||void 0===S||null===(f=S.match(m))||void 0===f?void 0:f[1],R=null===(h=t.msdyn_appcenterappidapk)||void 0===h||null===(O=h.match(m))||void 0===O?void 0:O[1],I="".concat(b),w="".concat(b,"(").concat(l,")"),D={msdyn_adalredirecturi:t.msdyn_adalredirecturi,msdyn_bundleidentifier:t.msdyn_bundleidentifier,msdyn_adalclientid:t.msdyn_adalclientid,msdyn_displayname:t.msdyn_displayname,msdyn_appcenterappidipa:null==A?void 0:A.replace(/\/$/,""),msdyn_appcenterappidapk:null==R?void 0:R.replace(/\/$/,""),msdyn_platformtype:y(r),msdyn_orgname:T||j,msdyn_statusbarcontentcolormode:t.msdyn_statusbarcontentcolormode,msdyn_secondaryapps:t.msdyn_secondaryapps,msdyn_androidappcenterapitoken:t.msdyn_androidappcenterapitoken,msdyn_iosappcenterapitoken:t.msdyn_iosappcenterapitoken,msdyn_fillcolor:"string"==typeof i.msdyn_fillcolor?i.msdyn_fillcolor:null===(C=i.msdyn_fillcolor)||void 0===C?void 0:C.str,msdyn_buttoncolor:"string"==typeof i.msdyn_buttoncolor?i.msdyn_buttoncolor:null===(v=i.msdyn_buttoncolor)||void 0===v?void 0:v.str,msdyn_headingtextcolor:"string"==typeof i.msdyn_headingtextcolor?i.msdyn_headingtextcolor:null===(P=i.msdyn_headingtextcolor)||void 0===P?void 0:P.str,msdyn_hyperlinkcolor:"string"==typeof i.msdyn_hyperlinkcolor?i.msdyn_hyperlinkcolor:null===(E=i.msdyn_hyperlinkcolor)||void 0===E?void 0:E.str},N={"msdyn_primaryPublishedAppName@odata.bind":"/canvasapps(".concat(n,")"),msdyn_mobileappid:l,msdyn_actionbuttonhighlight:"highlight",msdyn_uniquename:"new_com.test.shrinkWrap1-".concat(Object(o.v4)(),"-primary"),name:"com.test.shrinkWrap"},L=l?D:s(s({},D),N),M=l?"PATCH":"POST",x=l?w:I,k=yield e(x,{method:M,data:L,headers:{prefer:"return=representation"}});return Object(a.logInfo)("Response_CreateOrUpdateMobileAppRecord",{response:k}),k.data}))).apply(this,arguments)}function h(e,t){return O.apply(this,arguments)}function O(){return(O=p((function*(e,t){var n,o,r=yield e("".concat(b,"?$filter=(_msdyn_primarypublishedappname_value eq ").concat(t,")"));return(null===(n=r.data.value)||void 0===n?void 0:n.find(e=>{var t;return null===(t=e.msdyn_uniquename)||void 0===t?void 0:t.endsWith("primary")}))||(null===(o=r.data.value)||void 0===o?void 0:o[0])}))).apply(this,arguments)}function C(e,t,n){return v.apply(this,arguments)}function v(){return(v=p((function*(e,t,n){var o=A(n);yield Promise.all(o.map(function(){var o=p((function*(o){return yield e("".concat(b,"(").concat(t,")/").concat(o),{method:"PATCH",data:n[o],headers:{"x-ms-file-name":encodeURI(n["".concat(o,"_name")]),"Content-Type":"application/octet-stream"}})}));return function(e){return o.apply(this,arguments)}}()));var a={};return r.imageBlobColumns.map(e=>a[e]=n[e]),a}))).apply(this,arguments)}function P(e,t,n){return E.apply(this,arguments)}function E(){return(E=p((function*(e,t,n){var o=yield e("".concat(b,"(").concat(t,")/").concat(n,"/$value"),{responseType:"arraybuffer"});return Object(a.logInfo)("Response_GetImage",{response:o}),o.data}))).apply(this,arguments)}function T(e,t,n){return j.apply(this,arguments)}function j(){return(j=p((function*(e,t,n){var o=A(n);return yield Promise.all(o.map(n=>P(e,t,n))).then(e=>{var t={};return o.forEach((n,o)=>{var r=new Blob([e[o]],{type:"image/png"});t[n]=r}),t})}))).apply(this,arguments)}function A(e){var t=[];return r.imageBlobColumns.forEach(n=>{e[n]&&t.push(n)}),t}function R(e,t,n,o){return I.apply(this,arguments)}function I(){return(I=p((function*(e,t,n,o){var r={msdyn_MobileApp:"msdyn_mobileapps(".concat(t,")"),AppCenterApiToken:JSON.stringify({androidAppCenterAPIToken:n,iOSAppCenterAPIToken:o})},i=yield e("".concat(u,"/msdyn_MobileAppBuild"),{method:"POST",data:r});return Object(a.logInfo)("Response_TriggerBuild",{response:i}),N(i.data.Result)}))).apply(this,arguments)}function w(e,t){return D.apply(this,arguments)}function D(){return(D=p((function*(e,t){var n=yield e(g,{method:"POST",data:{msdyn_MobileApp:"msdyn_mobileapps(".concat(t,")"),OperationId:""}});return Object(a.logInfo)("Response_GetAllBuildsForMobileApp",{response:n}),N(n.data.Result)}))).apply(this,arguments)}function N(e){var t=JSON.parse(e);return{iOS:L(null==t?void 0:t.iOS),Android:L(null==t?void 0:t.Android)}}function L(e){return e?Array.isArray(e)?e:[e]:[]}},5967:function(e,t,n){"use strict";n.r(t),n.d(t,"imageBlobColumns",(function(){return o})),n.d(t,"imageNameColumns",(function(){return r}));var o=["msdyn_tenantwelcomeimage","msdyn_tenantsplashimage","msdyn_appicon120x120","msdyn_appicon152x152","msdyn_appicon167x167","msdyn_appicon180x180","msdyn_appicon1024x1024","msdyn_appiconmdpi","msdyn_appiconhdpi","msdyn_appiconxdpi","msdyn_appiconxxhdpi","msdyn_appiconxxxhdpi"],r=["msdyn_tenantwelcomeimage_name","msdyn_tenantsplashimage_name","msdyn_appicon120x120_name","msdyn_appicon152x152_name","msdyn_appicon167x167_name","msdyn_appicon180x180_name","msdyn_appicon1024x1024_name","msdyn_appiconmdpi_name","msdyn_appiconhdpi_name","msdyn_appiconxdpi_name","msdyn_appiconxxhdpi_name","msdyn_appiconxxxhdpi_name"]},5968:function(e,t,n){"use strict";function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){if(e&&t)return"https://appcenter.ms/orgs/".concat(e,"/app/").concat(t)}function s(e,t){return r(r(r({},e),t),{},{msdyn_appcenterappidapk:i(e.msdyn_orgname,e.msdyn_appcenterappidapk),msdyn_appcenterappidipa:i(e.msdyn_orgname,e.msdyn_appcenterappidipa)})}n.r(t),n.d(t,"mapRecordsToUi",(function(){return s}))},5969:function(e,t,n){"use strict";n.r(t),n.d(t,"areBuildRequirementsMet",(function(){return s}));var o={presence:["msdyn_adalclientid","msdyn_displayname","msdyn_orgname"]},r={presence:["msdyn_appiconhdpi","msdyn_appiconmdpi","msdyn_appiconxdpi","msdyn_appiconxxhdpi","msdyn_appiconxxxhdpi","msdyn_appcenterappidapk","msdyn_androidappcenterapitoken","msdyn_adalredirecturi"]},a={presence:["msdyn_appicon1024x1024","msdyn_appicon120x120","msdyn_appicon152x152","msdyn_appicon167x167","msdyn_appicon180x180","msdyn_appcenterappidipa","msdyn_iosappcenterapitoken"]},i={Android:{presence:[...o.presence,...r.presence]},iOS:{presence:[...o.presence,...a.presence]},NotSpecified:{presence:[...r.presence,...a.presence]}};function s(e){return function(e){var t;return!!e.msdyn_platformtype&&(null===(t=i[e.msdyn_platformtype])||void 0===t?void 0:t.presence.every(t=>{var n=e[t];return"string"==typeof n?null==n?void 0:n.length:n}))}(e)}},5970:function(e,t,n){"use strict";n.r(t),n.d(t,"SortableDetailsList",(function(){return m}));var o=n(1259),r=n(1471),a=n(245),i=n.n(a),s=n(5971),l=n.n(s);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var d=[{displayName:"App1",status:"Pending",platform:"iOS",date:"11/15/2021 at 1:31 PM"},{displayName:"App2",status:"Successful",platform:"Android",date:"11/15/2021 at 12:03 PM"},{displayName:"App3",status:"Successful",platform:"iOS",date:"10/1/2021 at 11:17 AM"},{displayName:"App4",status:"Successful",platform:"Android",date:"10/1/2021 at 10:34 AM"}];function m(e){var{builds:t}=e,[n,s]=Object(a.useState)(b(d,"date",!0)),[c,u]=Object(a.useState)([{key:"Build",name:"Build",fieldName:"buildRegion",minWidth:75,maxWidth:75,isSortedDescending:!1,onColumnClick:()=>m("build")},{key:"Status",name:"Status",fieldName:"state",minWidth:75,isSortedDescending:!1,onColumnClick:()=>m("status")},{key:"Platform",name:"Platform",fieldName:"platform",minWidth:75,isSortedDescending:!1,onColumnClick:()=>m("platform")},{key:"Date",name:"Date",fieldName:"createdDate",minWidth:150,isSortedDescending:!0,onColumnClick:()=>m("date")}]);function m(e){var t=[...c],o=!1;t.forEach(t=>{e===t.fieldName?(t.isSortedDescending=!t.isSortedDescending,o=t.isSortedDescending):t.isSortedDescending=!1});var r=b([...n],e,o);u(t),s(r)}var y=Object(a.useMemo)(()=>{var e,n;return b([...(null==t||null===(e=t.iOS)||void 0===e?void 0:e.map(e=>p(p({},e.buildResponse),{},{buildId:e.buildId,platform:"iOS",state:g(e),buildRegion:"".concat(e.buildResponse.buildRegion||"us","-").concat(e.buildId),createdDate:l()(e.buildResponse.createdDate).format("L[,] LT")})))||[],...(null==t||null===(n=t.Android)||void 0===n?void 0:n.map(e=>p(p({},e.buildResponse),{},{buildId:e.buildId,platform:"Android",state:g(e),buildRegion:"".concat(e.buildResponse.buildRegion||"us","-").concat(e.buildId),createdDate:l()(e.buildResponse.createdDate).format("L[,] LT")})))||[]],"createdDate",!0)},[t]);return i.a.createElement(o.DetailsList,{items:y,layoutMode:r.DetailsListLayoutMode.justified,selectionMode:0,columns:c,styles:{root:{marginTop:-16}}})}function b(e,t,n){return e.sort((e,o)=>{var r=e[t]||"",a=o[t]||"";return n?r.localeCompare(a):a.localeCompare(r)})}function g(e){var t,n=e.buildResponse.result,r=n?"".concat((t=n)[0].toUpperCase()).concat(t.slice(1)):"InProgress";if("Failed"===r){var a;if((null===(a=e.buildResponse.buildErrors)||void 0===a?void 0:a.messages.length)>0){var s,l=function(e){for(var t=[],n=0;n<e.length;n++)switch(e[n]){case"Send Android AAB to App center":case"Send Android Apk to App center":case"Send iOS archive to App center":t.push("Publishing to App Center failed. Please check your App Center configuration and try again.");break;default:t.push("Build failed. Please check your project configuration and try again.")}return t}(null===(s=e.buildResponse.buildErrors)||void 0===s?void 0:s.messages).join("\r\n");return i.a.createElement(o.Link,{onClick:()=>function(e){alert(e)}(l)},r)}return r}return r}},5972:function(e,t,n){"use strict";n.r(t),n.d(t,"UploadSquare",(function(){return l}));var o=n(1259),r=n(245),a=n.n(r),i=n(5953),s=n(5973);function l(e){var{blob:t,size:n,onSetImage:l,blobColumnName:c}=e,p=Object(r.useRef)(null),[u,d]=Object(r.useState)(null);Object(r.useLayoutEffect)(()=>{if(t)try{var e=URL.createObjectURL(t);d(e)}catch(n){Object(i.logWarning)("DisplayImageInForm_Failed")}return()=>{u&&URL.revokeObjectURL(u)}},[t]);var m=()=>{var e;null===(e=p.current)||void 0===e||e.click()};return a.a.createElement("div",{style:s.styles.uploadSquareButtonContainer},u?a.a.createElement("img",{src:u,style:s.styles.uploadSquareImage,onClick:m}):a.a.createElement(o.DefaultButton,{styles:{root:s.styles.uploadSquareButton},onClick:m},a.a.createElement(o.Icon,{iconName:"Upload"})),a.a.createElement("label",{style:s.styles.uploadLabel,htmlFor:c},n,"px"),a.a.createElement("input",{type:"file",hidden:!0,accept:".png",id:c,onChange:e=>l(e,p),ref:p}))}},5973:function(e,t,n){"use strict";n.r(t),n.d(t,"DEFAULT_STACK_CHILD_GAP",(function(){return c})),n.d(t,"APP_ICON_UPLOAD_CHILD_GAP",(function(){return p})),n.d(t,"APP_PLATFORM_CHILD_GAP",(function(){return u})),n.d(t,"learnMoreUris",(function(){return d})),n.d(t,"FIELD_MAX_WIDTH",(function(){return m})),n.d(t,"DEFAULT_COLOR_HEX",(function(){return b})),n.d(t,"DIRTY_FIELD_EXCLUSIONS",(function(){return g})),n.d(t,"TestId",(function(){return l})),n.d(t,"styles",(function(){return S})),n.d(t,"labelAppPlatformStyles",(function(){return f})),n.d(t,"labelDisplayOptionStyles",(function(){return h})),n.d(t,"accordionStyles",(function(){return O})),n.d(t,"accordionStylesClosed",(function(){return C})),n.d(t,"textFieldDefaultStyles",(function(){return v})),n.d(t,"colorInputDefaultProps",(function(){return P})),n.d(t,"dropdownDefaultStyles",(function(){return E}));var o=n(719),r=n(5967);function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var l,c={childrenGap:21},p={childrenGap:18},u={childrenGap:8},d={wrap:"https://go.microsoft.com/fwlink/?linkid=2187212",statusbarTextTheme:"https://go.microsoft.com/fwlink/?linkid=2188752",backgroundFillColor:"https://go.microsoft.com/fwlink/?linkid=2188842",buttonFillColor:"https://go.microsoft.com/fwlink/?linkid=2188842",headingTextColor:"https://go.microsoft.com/fwlink/?linkid=2188842",hyperLinkTextColor:"https://go.microsoft.com/fwlink/?linkid=2188842",splashScreenImage:"https://go.microsoft.com/fwlink/?linkid=2188751",welComeScreenImage:"https://go.microsoft.com/fwlink/?linkid=2188751",androidAppIcon:"https://go.microsoft.com/fwlink/?linkid=2188841",iosAppIcon:"https://go.microsoft.com/fwlink/?linkid=2188840",azureADClientRedirectUri:"https://go.microsoft.com/fwlink/?linkid=2188839",azureADClientId:"https://go.microsoft.com/fwlink/?linkid=2188838",bundleId:"https://go.microsoft.com/fwlink/?linkid=2188750",appCenterApiToken:"https://go.microsoft.com/fwlink/?linkid=2188749",androidAppCenterUrl:"https://go.microsoft.com/fwlink/?linkid=2188837",iosAppCenterUrl:"https://go.microsoft.com/fwlink/?linkid=2188837",googlePlayStoreAppCenterUrl:"https://go.microsoft.com/fwlink/?linkid=2188837",appsPlatform:"https://go.microsoft.com/fwlink/?linkid=2188748",secondaryApps:"https://go.microsoft.com/fwlink/?linkid=2188836"},m=308,b="#82c7fc",g=new Set(["@odata.context","@odata.etag","iscustomizable","modifiedon","versionnumber","msdyn_builddetails","msdyn_mobileappdefinitionios","msdyn_launchappresources","msdyn_recentbuild",...r.imageNameColumns]);!function(e){e.DisplayNameInput="DisplayNameInput",e.BundleIdInput="BundleIdInput",e.AadClientIdInput="AadClientIdInput",e.AadClientRedirectInput="AadClientRedirectInput",e.AppCenterUrlIos="AppCenterUrlIos",e.AppCenterUrlAndroid="AppCenterUrlAndroid",e.AppCenterUrlForPlayStore="AppCenterUrlForPlayStore",e.SaveButton="SaveButton",e.IosButton="IosButton",e.AndroidButton="AndroidButton",e.ForPlayStoreButton="ForPlayStoreButton"}(l||(l={}));var y=Object(o.getTheme)(),S={savedContainer:{display:"flex",alignItems:"center",marginBottom:10},checkmark:{color:"green",marginRight:5},panelHeaderSubtitle:{color:y.palette.neutralSecondary,fontSize:16,lineHeight:"22px",margin:0,marginBottom:29},panelHeaderSubtitleLink:{color:"#8C2F8D"},label:{lineHeight:20,paddingTop:0},uploadSectionContainer:{marginBottom:-18},uploadButtonHorizontal:{background:"none",border:"none",alignSelf:"flex-start",padding:0,color:y.palette.themeDarkAlt,cursor:"pointer",fontSize:14,lineHeight:"20px",marginTop:18,display:"flex",alignItems:"center"},uploadSquareButtonContainer:{width:"33%",marginBottom:18},uploadSquareButton:{width:48,height:48,display:"flex",justifyContent:"center",alignItems:"center",cursor:"pointer",boxSizing:"border-box",minWidth:"auto",marginBottom:2,color:y.palette.themeDarkAlt},uploadSquareImage:{width:48,height:48,display:"flex",justifyContent:"center",alignItems:"center",cursor:"pointer",minWidth:"auto",marginBottom:2},uploadIconHorizontal:{color:y.palette.themeDarkAlt,marginRight:8},uploadLabel:{color:y.palette.themeDarkAlt,fontSize:14,lineHeight:"20px",paddingBottom:0},tooltipLink:{marginTop:"5px !important",alignItems:"left",align:"left"}},f={root:{lineHeight:"20px"}},h={root:{marginBottom:3,lineHeight:"20px"}},O={container:{marginBottom:29},header:{background:"none",fontSize:16,padding:0,":hover":{background:"none"},":active":{background:"none"}},flexContainer:{flexFlow:"row-reverse"},menuIcon:{margin:0},label:{marginLeft:16},content:{marginTop:26}},C=i(i({},O),{},{container:{marginBottom:0}}),v={subComponentStyles:{label:{root:S.label}}},P={tooltipIconProps:{style:{display:"none"}},styles:{colorBox:{marginRight:4},container:{maxWidth:"100%"}}},E={root:{marginTop:0},label:{lineHeight:"20px",paddingTop:0}}},5974:function(e,t,n){"use strict";n.r(t),n.d(t,"CustomLabel",(function(){return b}));var o=n(245),r=n.n(o),a=n(1372),i=n(684),s=n(1795),l=n(3036),c=n(3040),p=n(790),u=n(923),d=n(5975);function m(){return(m=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}var b=e=>{var{translationFile:t,label:n,calloutContent:o,id:b,isDropdownLabel:g,iconButtonStyles:y,customLabelStyles:S,labelCalloutStackStyles:f,fluentLabel:h}=e,{t:O}=Object(u.useTranslation)(t),[C,{toggle:v}]=Object(l.useBoolean)(!1),P=Object(c.useId)("description"),E=Object(c.useId)("iconButton"),T={childrenGap:g?0:5},j=S||(g?d.dropdownLabelStyles:d.labelStyles);return r.a.createElement(r.a.Fragment,null,r.a.createElement(s.Stack,{horizontal:!0,tokens:T,styles:j},r.a.createElement("span",{id:"".concat(b,"-label")},h&&r.a.createElement(a.Label,m({},h,{htmlFor:b||"labelId",styles:d.fluentLabelStyles}),n)||n,o&&r.a.createElement(i.IconButton,{id:E,iconProps:{iconName:"Info"},title:O("Common.Info"),ariaLabel:O("Common.Info"),onClick:v,styles:h?d.iconButtonWithFluentLabelStyles:y||d.iconButtonStyles}))),C&&o&&r.a.createElement(p.FocusTrapCallout,{target:"#"+E,setInitialFocus:!0,onDismiss:v,focusTrapProps:{isClickableOutsideFocusTrap:!0},ariaDescribedBy:P,role:"alertdialog",directionalHint:p.DirectionalHint.topCenter,gapSpace:5,ariaLabel:n},r.a.createElement(i.IconButton,{onClick:v,iconProps:{iconName:"Cancel"},ariaLabel:O("Common.Close"),title:O("Common.Close"),styles:d.iconButtonCloseStyles}),r.a.createElement(s.Stack,{tokens:T,horizontalAlign:"center",styles:f||d.labelCalloutStackStyles},o)))}},5975:function(e,t,n){"use strict";n.r(t),n.d(t,"iconButtonStyles",(function(){return s})),n.d(t,"iconButtonWithFluentLabelStyles",(function(){return l})),n.d(t,"iconButtonCloseStyles",(function(){return c})),n.d(t,"labelStyles",(function(){return p})),n.d(t,"dropdownLabelStyles",(function(){return u})),n.d(t,"labelCalloutStackStyles",(function(){return d})),n.d(t,"fluentLabelStyles",(function(){return m}));var o,r,a,i=n(3176),s={root:{marginLeft:5,width:20,height:20,fontSize:12,lineHeight:16,color:(null===i.fabricTheme||void 0===i.fabricTheme||null===(o=i.fabricTheme.palette)||void 0===o?void 0:o.neutralPrimary)||"#323130"},icon:{fontSize:12}},l={root:{marginLeft:"-5px",width:20,height:20,fontSize:12,lineHeight:16,color:(null===i.fabricTheme||void 0===i.fabricTheme||null===(r=i.fabricTheme.palette)||void 0===r?void 0:r.neutralPrimary)||"#323130"},icon:{fontSize:12}},c={root:{float:"right",right:0,width:32,color:(null===i.fabricTheme||void 0===i.fabricTheme||null===(a=i.fabricTheme.palette)||void 0===a?void 0:a.neutralPrimary)||"#323130"},icon:{fontSize:12}},p={root:{marginLeft:6}},u={root:{fontWeight:600,padding:"5px 0"}},d={root:{padding:"8px 0 8px 8px",maxWidth:250,textAlign:"left",fontSize:12,lineHeight:16}},m={root:{margin:0,paddingRight:"5px",fontWeight:600,display:"inline-block"}}},5976:function(e,t,n){"use strict";n.r(t),n.d(t,"onRenderLabelWithTooltip",(function(){return i}));var o=n(245),r=n.n(o),a=n(5974),i=(e,t,n)=>r.a.createElement(a.CustomLabel,{id:(null==e?void 0:e.id)||"labelId",label:null==e?void 0:e.label,calloutContent:t,translationFile:"Wrap",isDropdownLabel:!!n,fluentLabel:{disabled:(null==e?void 0:e.disabled)||!1,required:(null==e?void 0:e.required)||!1}})},5977:function(e,t,n){"use strict";n.r(t),n.d(t,"mapDispatchToProps",(function(){return b})),n.d(t,"mergeProps",(function(){return g})),n.d(t,"AppModuleSharePanelContainer",(function(){return y}));var o=n(5437),r=n(5487),a=n(5478),i=n(5468),s=n(5978),l=n(922),c=["rootProps"];function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function m(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var b=(e,t)=>({onDismiss:()=>{e(i.sharedActions.panelClose({panelType:a.PanelToShowType.AppModuleSharePanel})),e(i.sharedActions.panelClose({panelType:a.PanelToShowType.LegacyAppModuleSharePanel})),t.onClosePanel&&t.onClosePanel()}}),g=(e,t,n)=>{var{rootProps:o}=n,r=m(n,c);return u(u(u({},t),r),{},{currentEnvironment:o.currentEnvironment,t:n.t,tReady:n.tReady})},y=Object(l.translateService)("PowerappsPortal")(Object(r.withRootProps)(Object(o.connect)(null,b,g)(s.AppModuleSharePanel)))},5978:function(e,t,n){"use strict";n.r(t),n.d(t,"AppModuleSharePanel",(function(){return b}));var o=n(4013),r=n(1090),a=n(1573),i=n(245),s=n(5604),l=n(5481),c=n(2880),p=n(5605),u=n(5979),d=n(1086);function m(){return(m=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}class b extends i.Component{constructor(e){super(e)}render(){var e=this.props.t("Model.AppsList.Share.learnMore"),t=l.default.shareModelDrivenAppsLearnMoreLink,n=Object(s.getCrmInstanceUrl)(this.props.currentEnvironment);return i.createElement(o.Panel,m({},this.props.defaultPanelProps,{headerText:this.props.t("Model.AppsList.Share.title"),onDismiss:this.props.onDismiss,dismissOnEscape:!0,closeButtonType:o.PanelCloseButtonType.Back,closeButtonAriaLabel:this.props.t("Common.close"),type:a.PanelType.medium,footerButtons:this.getFooterButtons(),className:u.appModuleSharePanelStyles["app-module-share-panel"],headerClassName:"panel-header"}),i.createElement("div",{className:"app-module-share-panel-content"},i.createElement("div",{className:"panel-subtitle"},this.props.t("Model.AppsList.Share.subtitle")),i.createElement("div",{className:"panel-step"},i.createElement("div",{className:"panel-step-heading"},"1. ",this.props.t("Model.AppsList.Share.Step1.title")),i.createElement("div",{className:"panel-step-message"},i.createElement("p",null,Object(c.formatResourceStringAsLinks)(this.props.t("Model.AppsList.Share.Step1.message"),[Object(p.getCrmAdminSecurityRolesUrl)(n)])))),i.createElement("div",{className:"panel-step"},i.createElement("div",{className:"panel-step-heading"},"2. ",this.props.t("Model.AppsList.Share.Step2.title")),i.createElement("div",{className:"panel-step-message"},i.createElement("p",null,Object(c.formatResourceStringAsLinks)(this.props.t("Model.AppsList.Share.Step2.message"),[Object(p.getCrmAdminSecurityUsersUrl)(n)])))),i.createElement("div",{className:"panel-step"},i.createElement("div",{className:"panel-step-heading"},"3. ",this.props.t("Model.AppsList.Share.Step3.title")),i.createElement("div",{className:"panel-step-message"},i.createElement("p",null,Object(c.formatResourceStringAsLinks)(this.props.t("Model.AppsList.Share.Step3.message"),[Object(p.getCrmMyAppsUrl)(n)])))),i.createElement("div",{className:"panel-step"},i.createElement("div",{className:"panel-step-heading"},"4. ",this.props.t("Model.AppsList.Share.Step4.title")),i.createElement("div",{className:"panel-step-message"},d.getPlayAppModuleUrl(n,this.props.appModule.id))),i.createElement("div",{className:"panel-step"},i.createElement(r.Link,{href:t,target:"_blank"},e))))}getFooterButtons(){return[{primary:!0,ariaLabel:this.props.t("Common.close"),text:this.props.t("Common.close"),dismissableOnClick:()=>this.props.onDismiss()}]}}},5979:function(e,t,n){"use strict";n.r(t),n.d(t,"appModuleSharePanelStyles",(function(){return i}));var o=n(719),r=n(5492),a=n(2882),i=Object(o.mergeStyleSets)({"app-module-share-panel":{selectors:{".ba-Panel-headerContainer":{paddingTop:"15px !important",paddingLeft:"24px !important"},".ms-Panel-content, .ms-Panel-footer":{paddingLeft:"24px !important"},".panel-header":{fontFamily:r.fonts.segoeUi,fontSize:"21px",lineHeight:"normal",color:"".concat(a.fabricColors.mineShaft," !important"),letterSpacing:"-0.0102px",fontWeight:"normal"},".app-module-share-panel-content":{fontFamily:r.fonts.segoeUi,fontSize:"14px",lineHeight:"normal",marginTop:"20px",selectors:{".panel-subtitle":{color:a.fabricColors.emperor,letterSpacing:"-0.0068px"},".panel-step":{marginTop:"16px",selectors:{".panel-step-heading":{color:a.fabricColors.mineShaft,letterSpacing:"-0.00825714px"},".panel-step-message":{marginTop:"4px",paddingLeft:"15px",color:a.fabricColors.doveGray,letterSpacing:"-0.0068px"}}}}}}}})},5980:function(e,t,n){"use strict";n.r(t),n.d(t,"mapStateToProps",(function(){return g})),n.d(t,"mapDispatchToProps",(function(){return y})),n.d(t,"mergeProps",(function(){return S})),n.d(t,"AppRenamePanelContainer",(function(){return f}));var o=n(5437),r=n(5596),a=n(5478),i=n(5629),s=n(5981),l=n(5649),c=n(5468),p=n(5595),u=n(6001);function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){b(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function b(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var g=(e,t)=>{var n,o=Object(l.appSelector)(e,t.selectedAppId),a=null!==(n=Object(l.appRenameError)(e))&&void 0!==n?n:"";return{appDisplayName:r.getAppDisplayName(o),logEvent:p.CanvasAppSettingsLoadEvent,loadProgress:[Object(i.toLoadingState)(Object(l.appRenameComplete)(e),a)],errorMessage:a}},y=e=>({onPanelClose:()=>e(c.sharedActions.panelClose({panelType:a.PanelToShowType.AppRenamePanel})),onSaveClick:(t,n)=>e(s.appsActions.renameAppRequest({appId:t,appDisplayName:n})),resetRenameAppError:()=>e(s.appsActions.resetRenameAppError()),dispatchTelemetry:e}),S=(e,t,n)=>{var o=n.selectedAppId;return m(m({},e),{},{defaultPanelProps:n.defaultPanelProps,onPanelClose:()=>t.onPanelClose(),onSaveClick:e=>t.onSaveClick(o,e),dispatchTelemetry:t.dispatchTelemetry,resetRenameAppError:()=>t.resetRenameAppError()})},f=Object(o.connect)(g,y,S)(u.AppRenamePanel)},5981:function(e,t,n){"use strict";n.r(t);var o=n(5648);n.d(t,"appsActions",(function(){return o}));var r=n(5982);n.d(t,"appsMiddlewares",(function(){return r}));var a=n(6e3),i=n(5649);n.d(t,"appsSelectors",(function(){return i})),t.default=a.reducer},5982:function(e,t,n){"use strict";n.r(t);var o=n(5983);n.d(t,"AppClientRootSaga",(function(){return o.AppClientRootSaga}));var r=n(5794);n.d(t,"AppClientSaga",(function(){return r.default}));var a=n(5984);n.d(t,"AppSpecificActionsMiddleware",(function(){return a.AppSpecificActionsMiddleware}));var i=n(5986);n.d(t,"GenericAppActionsMiddleware",(function(){return i.GenericAppActionsMiddleware}));var s=n(5999);n.d(t,"AppVersionActionsMiddleware",(function(){return s.AppVersionActionsMiddleware}))},5983:function(e,t,n){"use strict";n.r(t),n.d(t,"AppClientRootSaga",(function(){return a}));var o=n(5749),r=n(5981);function*a(){yield Object(o.all)([Object(o.fork)(r.appsMiddlewares.AppClientSaga)])}},5984:function(e,t,n){"use strict";n.r(t),n.d(t,"AppSpecificActionsMiddleware",(function(){return T}));var o=n(5606),r=n(5604),a=n(5596),i=n(5637),s=n(5478),l=n(2869),c=n(2880),p=n(5630),u=n(5623),d=n(5985),m=n(5468),b=n(5648),g=n(2872),y=n(5878),S=n(2807),f=n(1087),h=n(5649),O=n(2840),C=n(5981);function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function P(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach((function(t){E(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function E(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function T(){return e=>t=>n=>{var v,E,T,j,A,R,{dispatch:I}=e,w=Object(l.getResources)(),D=n,N=o.SagaContextProps.getCurrentEnvironment(),L=e.getState(),M=N?C.appsSelectors.filteredApps(L,N.id):[];switch(D.type){case b.AppsActionTypes.PLAY_APP:Object(d.launchAppInWebPlayer)(D.payload.app,N,n.payload.allowlistFeatures);break;case b.AppsActionTypes.EDIT_SOLUTION_COMPONENT_APP:if(E=D.payload.appId,T=D.payload.solutionId,D.payload.isComponentLibrary||(v=Object(h.appsSelector)(e.getState(),null==N?void 0:N.id).find(e=>e.name===E)),v||(v=Object(h.componentLibrariesSelector)(e.getState(),null==N?void 0:N.id).find(e=>e.name===E)),Object(i.canUserEditResource)(v)&&Object(O.isCanvasAppCustomizable)(v)){var x=Object(f.getEditAppUri)(null==N?void 0:N.name,v.id,T);D.payload.navigate(x)}break;case b.AppsActionTypes.EDIT_APP:if(v=D.payload.app,T=D.payload.solutionId,Object(i.canUserEditResource)(v)){var k=Object(f.getEditAppUri)(N.name,v.id,T);D.payload.navigate(k)}break;case b.AppsActionTypes.TEST_APP:j=g.settings.testStudioEndpoint,I(m.sharedActions.openNewTab({uri:j}));break;case b.AppsActionTypes.SHARE_APP:v=D.payload.app;var F=D.payload.onClosePanel;(D.payload.isAdminScope||Object(i.canUserShareResource)(v))&&(v.isAppComponentLibrary?I(m.sharedActions.panelOpen({panelType:s.PanelToShowType.ComponentLibrarySharePanel,panelProps:{selectedComponentLibrary:P(P({},v),{},{isAppComponentLibrary:!0})},stayMountedWhenHidden:!0})):I(m.sharedActions.panelOpen({panelType:s.PanelToShowType.AppSharePanel,panelProps:{selectedApp:v,onClosePanel:F},stayMountedWhenHidden:!0})));break;case b.AppsActionTypes.OPEN_APP_ANALYTICS:v=D.payload.app,D.payload.navigate(Object(u.getAppAnalyticsUrl)(Object(a.parseAppId)(v).apps),!0);break;case b.AppsActionTypes.OPEN_APP_SETTINGS:v=D.payload.app,I(m.sharedActions.panelOpen({panelType:s.PanelToShowType.AppSettingsPanel,panelProps:{selectedAppId:v.id,startTelemetry:!0,openAppSettingsPanelScenario:null}}));break;case b.AppsActionTypes.OPEN_APP_WRAP:v=D.payload.app,I(m.sharedActions.panelOpen({panelType:s.PanelToShowType.AppWrapPanel,panelProps:{canvasApps:M,selectedApp:v}}));break;case b.AppsActionTypes.OPEN_APP_RENAME:E=D.payload.appId,I(m.sharedActions.panelOpen({panelType:s.PanelToShowType.AppRenamePanel,panelProps:{selectedAppId:E}}));break;case b.AppsActionTypes.OPEN_APP_DETAILS:v=D.payload.app,D.payload.navigate(Object(u.getAppDetailsUrl)(Object(a.parseAppId)(v).apps),!0);break;case b.AppsActionTypes.OPEN_APP_DETAILS_BY_ID:E=D.payload.appId,T=D.payload.solutionId,D.payload.navigate(Object(u.getCanvasAppDetailsSolutionPageUrl)(N.name,E,T),!0);break;case b.AppsActionTypes.EXPORT_APP:v=D.payload.app,Object(r.canUserCreatePowerApp)(N)&&D.payload.navigate(Object(u.getAppExportUrl)(Object(a.parseAppId)(v).apps),!0);break;case b.AppsActionTypes.EXPORT_APP_TEAMS:I(m.sharedActions.panelOpen({panelType:s.PanelToShowType.CanvasAppTeamsExportPanel,panelProps:{selectedApp:D.payload.app}}));break;case b.AppsActionTypes.OPEN_DELETE_APP_DIALOGUE:v=D.payload.app,A=D.payload.redirectUrl,R=D.payload.navigate,I(m.sharedActions.openConfirmDialog({hidden:!1,title:Object(c.formatResourceString)(w.Apps.DeleteAppDiaglogue.title,Object(a.getAppDisplayName)(v)),subText:v.isAppComponentLibrary?w.Apps.DeleteAppDiaglogue.componentLibraryMessage:w.Apps.DeleteAppDiaglogue.appMessage,cancelButtonText:w.Common.cancel,confirmButtonText:w.Apps.DeleteAppDiaglogue.confirm,onConfirm:()=>{I(Object(p.logAction)(Object(b.deleteApp)({appId:v.id,redirectUrl:A,navigate:R}),S.CanvasAppCommands.Delete)),I(m.sharedActions.closeConfirmDialog())},isDestructive:!0}));break;case b.AppsActionTypes.DELETE_APP_FULFILLED:n.payload.redirectUrl&&D.payload.navigate(n.payload.redirectUrl,!0);break;case b.AppsActionTypes.MONITOR:var _=Object(d.getLaunchUrl)(D.payload.app,n.payload.allowlistFeatures,!1,N),U=Object(y.getLaunchAppInMonitorUrl)(N,"canvas",_,D.payload.app.properties.displayName||"",D.payload.app.id);I(m.sharedActions.openNewTab({uri:U}))}return t(n)}}},5985:function(e,t,n){"use strict";n.r(t),n.d(t,"launchAppInWebPlayer",(function(){return u})),n.d(t,"getIFrameUrl",(function(){return d})),n.d(t,"getLaunchUrl",(function(){return m})),n.d(t,"getLaunchUrlForSampleApp",(function(){return g}));var o=n(2812),r=n(5604),a=n(5596),i=n(2871),s=n(5483),l=n(5623),c=n(5619),p={source:"portal"};function u(e,t,n,o,r){var a=m(e,n,!1,t,o,r);window.open(a,"_blank")}function d(e,t,n,a,i){i=b(e,t,a,i);var c=Object(r.getNameFromCurrentEnvironment)(n);return Object(s.addSearchParams)(Object(l.getAppIframeLaunchUri)(c,e.name),Object(o.merge)({},p,i))}function m(e,t,n,r,i,l){l=b(e,t,i,l);var c=!n;return Object(s.addSearchParams)(Object(a.getAppWebLink)(e,c),Object(o.merge)({},p,l))}function b(e,t,n,r){var s,l=(s=i.featureGates).useWebPlayerIntBits?"webplayer-int":s.useWebPlayerMasterBits?"webplayer-master":s.useWebPlayerProdBits?"webplayer-prod":null;if(l){var c={webPlayerBits:l};r=Object(o.merge)({},c,r)}var p=Object(a.getAppBackgroundColor)(e);if(p){var u={screenColor:p};r=Object(o.merge)({},u,r)}return n&&(r=Object(o.merge)({},{correlationId:n},r)),r}function g(e,t,n,o,r,a){return m(n===c.phone&&e.phone?e.phone:e.tablet||e.default,t,!0,0,r,a)}},5986:function(e,t,n){"use strict";n.r(t),n.d(t,"GenericAppActionsMiddleware",(function(){return b}));var o=n(5606),r=n(5604),a=n(2869),i=n(5623),s=n(1087),l=n(5468),c=n(5654),p=n(5648),u=n(2872),d=n(5655),m=n(5987);function b(){return e=>t=>n=>{var{dispatch:b,getState:g}=e,y=Object(a.getResources)(),S=n,f=Object(m.organizationSettingsSelector)(g());switch(S.type){case p.AppsActionTypes.CREATE_AN_APP:var h,O,C=o.SagaContextProps.getCurrentEnvironment();if(Object(r.canUserCreatePowerApp)(C))if(null!==(h=S.payload)&&void 0!==h&&h.createAppParams&&null!==(O=S.payload)&&void 0!==O&&O.navigate){var v=Object(s.getAppFromDataUri)(C.name,S.payload.createAppParams,!(!f||!f.enablecanvasappsinsolutionsbydefault));S.payload.navigate(v)}else{var P=Object(d.getStaticSampleApps)(d.AppsListSectionName.StartFromBlank,null,null,!0);b(Object(c.openSampleAppModal)({sampleApp:P[0]}))}else b(l.sharedActions.openUpsellEnvironmentModal({upsellModal:{message:Object(r.getDefaultCreateEnvironmentMessage)(C)}})),b(Object(c.closeSampleAppModal)());break;case p.AppsActionTypes.IMPORT_PACKAGE:Object(r.canUserCreatePowerApp)(o.SagaContextProps.getCurrentEnvironment())?S.payload.navigate(i.appImportRoute,!0):b(l.sharedActions.openUpsellEnvironmentModal({upsellModal:{message:y.Import.Package.Environment.No.Write.Permission.message}}));break;case p.AppsActionTypes.OPEN_DYNAMICS_365:b(l.sharedActions.openNewTab({uri:u.settings.dynamics365PortalUrl}));break;case p.AppsActionTypes.EXPLORE_APP_TEMPLATES:S.payload.navigate(i.templateAppsRoute.canvas,!0)}return t(n)}}},5999:function(e,t,n){"use strict";n.r(t),n.d(t,"AppVersionActionsMiddleware",(function(){return u}));var o=n(5595),r=n(5797),a=n(5478),i=n(2869),s=n(2880),l=n(5630),c=n(5468),p=n(5648);function u(){return e=>t=>n=>{var{dispatch:u}=e,d=n,m=n.payload&&n.payload.appVersionListItem,b=Object(i.getResources)();switch(d.type){case p.AppsActionTypes.OPEN_RESTORE_APP_VERSION_DIALOG:u(c.sharedActions.openConfirmDialog({hidden:!1,title:Object(s.formatResourceString)(b.Apps.Versions.Modal.Restore.title,m&&m.currentIndex),subText:Object(s.formatResourceString)(b.Apps.Versions.Modal.Restore.confirmation,m&&m.newIndex),cancelButtonText:b.Apps.Versions.Modal.cancelButton,confirmButtonText:b.Apps.Versions.Modal.Restore.restoreButton,onConfirm:()=>{u(Object(l.logAction)(Object(p.restoreAppVersion)({appName:n.payload.appName,appVersionListItem:n.payload.appVersionListItem}),o.AppCommandEvents.Version.Restore.eventName))}}));break;case p.AppsActionTypes.OPEN_DELETE_APP_VERSION_DIALOG:u(c.sharedActions.openConfirmDialog({hidden:!1,title:Object(s.formatResourceString)(b.Apps.Versions.Modal.Delete.title,m&&m.currentIndex),subText:Object(s.formatResourceString)(b.Apps.Versions.Modal.Delete.confirmation,m&&m.newIndex),cancelButtonText:b.Apps.Versions.Modal.cancelButton,confirmButtonText:b.Apps.Versions.Modal.Delete.deleteButton,onConfirm:()=>{u(Object(l.logAction)(Object(p.deleteAppVersion)({appName:n.payload.appName,appVersionListItem:n.payload.appVersionListItem}),o.AppCommandEvents.Version.Delete.eventName))}}));break;case p.AppsActionTypes.PUBLISH_APP_VERSION:m=d.payload.appVersionListItem;var g=Object(r.getPublishedAppSettings)(m&&m.appVersion),y=m&&m.currentIndex,S=Object(r.getApp)(m&&m.appVersion);e.dispatch(c.sharedActions.panelOpen({panelType:a.PanelToShowType.VersionPublishPanel,panelProps:{publishedAppSettings:g,appVersionListItemIndex:y,app:S}}))}return t(n)}}},6e3:function(e,t,n){"use strict";n.r(t),n.d(t,"defaultState",(function(){return d})),n.d(t,"reducer",(function(){return m}));var o=n(5648),r=n(5470),a=n(5596),i=n(5653),s=n(2867),l=n(2812);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var d={powerapps:new r.CaseInsensitiveNormalized,componentLibraries:new r.CaseInsensitiveNormalized,fetchComponentLibrariesError:void 0,xrm:new r.CaseInsensitiveNormalized,appConnectionIds:Object(s.Map)(),fetchAppsError:void 0,appListType:a.AppListType.SharedWithMe,fetchAppErrorsByAppId:{},fetchAppErrorsByEnvironment:{},appVersions:Object(s.Map)(),appReports:Object(s.Map)(),currentEmbedData:null,fetchAppReportsIsLoading:!1,fetchAppConnectionsError:"",fetchAppConnectionsIsLoading:!1,restoreAppVersionResponse:{failed:!1,success:!1,loading:!1,message:""},deleteAppVersionResponse:{failed:!1,success:!1,loading:!1,message:""},fetchAppVersionsError:"",fetchAppVersionsIsLoading:!1,fetchAppReportsError:"",appsWithUnpublishedDraft:Object(s.Map)(),fetchAppWithUnpublishedDraftError:"",fetchAppWithUnpublishedDraftIsLoading:!1,updateAppSettingsError:"",updateAppSettingsIsInProgress:!1,renameAppError:"",renameAppIsInProgress:!1,validateAppDisplayNameError:"",validateAppDisplayNameIsInProgress:!1,publishAppVersionResponse:{failed:!1,success:!1,loading:!1,message:""},appModuleActionResponse:{success:!1,failed:!1,message:null},deleteCanvasAppResponse:{success:!1,failed:!1,message:null},deletedComponentLibraryAppId:""};function m(){var e,t,n,s,c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,u=arguments.length>1?arguments[1]:void 0;switch(u.type){case o.AppsActionTypes.FETCH_APPS_FULFILLED:var m=null;return u.payload.appListType===a.AppListType.Org&&(m=u.payload.environmentId),p(p({},c),{},{powerapps:Object(r.updateNormalizedData)(c.powerapps,u.payload.apps,m),fetchAppsError:void 0});case o.AppsActionTypes.FETCH_APPS_REJECTED:return p(p({},c),{},{fetchAppsError:u.payload.error});case o.AppsActionTypes.FETCH_COMPONENT_LIBRARIES_FULFILLED:var b=Object(r.updateNormalizedData)(c.componentLibraries,u.payload.componentLibraries);return p(p({},c),{},{componentLibraries:b,fetchComponentLibrariesError:""});case o.AppsActionTypes.FETCH_COMPONENT_LIBRARIES_REJECTED:return p(p({},c),{},{fetchComponentLibrariesError:u.payload.error});case o.AppsActionTypes.FETCH_APP_REQUEST:return c;case o.AppsActionTypes.FETCH_APP_FULFILLED:return t=Object(l.assign)(new r.CaseInsensitiveNormalized,c.powerapps),Object(r.add)(t,u.payload.app),delete(s=p({},c.fetchAppErrorsByAppId))[u.payload.app.id],p(p({},c),{},{powerapps:t,fetchAppErrorsByAppId:s});case o.AppsActionTypes.FETCH_APP_REJECTED:return(s=p({},c.fetchAppErrorsByAppId))[u.payload.appId]=u.payload.error,p(p({},c),{},{fetchAppErrorsByAppId:s});case o.AppsActionTypes.DELETE_APP_FULFILLED:var g=Object(l.assign)(new r.CaseInsensitiveNormalized,c.powerapps),y=u.payload.appId;return Object(r.removeResourceById)(g,y),p(p({},c),{},{powerapps:g,deletedComponentLibraryAppId:y});case o.AppsActionTypes.FETCH_APP_DETAILS_FULFILLED:return t=Object(l.assign)(new r.CaseInsensitiveNormalized,c.powerapps),Object(r.add)(t,u.payload.app),p(p({},c),{},{powerapps:t});case o.AppsActionTypes.FETCH_APP_DETAILS_REJECTED:return c;case o.AppsActionTypes.FETCH_APP_CONNECTIONS_REQUEST:return p(p({},c),{},{fetchAppConnectionsIsLoading:!1});case o.AppsActionTypes.FETCH_APP_CONNECTIONS_FULFILLED:return p(p({},c),{},{appConnectionIds:c.appConnectionIds.set(u.payload.appName,Object(r.resourcesToIdArray)(u.payload.connections)),fetchAppConnectionsError:"",fetchAppConnectionsIsLoading:!1});case o.AppsActionTypes.FETCH_APP_CONNECTIONS_REJECTED:return p(p({},c),{},{fetchAppConnectionsError:u.payload.error,fetchAppConnectionsIsLoading:!1});case o.AppsActionTypes.FETCH_APP_VERSIONS_REQUEST:return p(p({},c),{},{fetchAppVersionsIsLoading:!1});case o.AppsActionTypes.FETCH_APP_VERSIONS_REJECTED:return p(p({},c),{},{fetchAppVersionsError:u.payload.error,fetchAppVersionsIsLoading:!1});case o.AppsActionTypes.FETCH_APP_VERSIONS_FULFILLED:return p(p({},c),{},{appVersions:c.appVersions.set(u.payload.appName,u.payload.appVersions),fetchAppVersionsError:"",fetchAppVersionsIsLoading:!1});case o.AppsActionTypes.FETCH_APP_REPORTS_REQUEST:return p(p({},c),{},{fetchAppReportsIsLoading:!1});case o.AppsActionTypes.FETCH_APP_REPORTS_FULFILLED:return p(p({},c),{},{fetchAppReportsIsLoading:!1,appReports:c.appReports.set(u.payload.appName,u.payload.appReports)});case o.AppsActionTypes.FETCH_APP_REPORTS_REJECTED:return p(p({},c),{},{fetchAppReportsIsLoading:!1});case o.AppsActionTypes.FETCH_CURRENT_REPORT_EMBED_DATA_FULFILLED:return p(p({},c),{},{currentEmbedData:{appName:u.payload.currentEmbedData.appName,report:u.payload.currentEmbedData.report,embedUrl:u.payload.currentEmbedData.embedUrl,accessToken:u.payload.currentEmbedData.accessToken}});case o.AppsActionTypes.UPDATE_APP_LIST_TYPE:return p(p({},c),{},{appListType:u.payload.appListType});case o.AppsActionTypes.DELETE_APP_REJECTED:return p(p({},c),{},{deleteCanvasAppResponse:{success:!1,failed:!0,message:u.payload.errorMessage}});case o.AppsActionTypes.FETCH_UNPUBLISHED_APP_DEFINITION_REQUEST:return p(p({},c),{},{fetchAppWithUnpublishedDraftIsLoading:!0});case o.AppsActionTypes.FETCH_UNPUBLISHED_APP_DEFINITION_FULFILLED:return p(p({},c),{},{appsWithUnpublishedDraft:c.appsWithUnpublishedDraft.set(u.payload.app.id,null!=(null===(e=u.payload.app.properties)||void 0===e?void 0:e.unpublishedAppDefinition)),fetchAppWithUnpublishedDraftIsLoading:!1,fetchAppWithUnpublishedDraftError:""});case o.AppsActionTypes.FETCH_UNPUBLISHED_APP_DEFINITION_REJECTED:return p(p({},c),{},{fetchAppWithUnpublishedDraftError:u.payload.error,fetchAppWithUnpublishedDraftIsLoading:!1});case o.AppsActionTypes.UPDATE_APP_SETTINGS_REQUEST:return p(p({},c),{},{updateAppSettingsIsInProgress:!0});case o.AppsActionTypes.UPDATE_APP_SETTINGS_FULFILLED:return n=c.powerapps.byId(u.payload.appId),null!=u.payload.appSettings.canConsumeAppPass&&(n.properties.canConsumeAppPass=u.payload.appSettings.canConsumeAppPass),null!=u.payload.appSettings.performanceOptimizationEnabled&&(n.properties.performanceOptimizationEnabled=u.payload.appSettings.performanceOptimizationEnabled),t=Object(l.assign)(new r.CaseInsensitiveNormalized,c.powerapps),Object(r.add)(t,n),p(p({},c),{},{powerapps:t,updateAppSettingsError:"",updateAppSettingsIsInProgress:u.payload.numberOfFulFilled<u.payload.numberOfCalls});case o.AppsActionTypes.UPDATE_APP_SETTINGS_REJECTED:return p(p({},c),{},{updateAppSettingsError:u.payload.error,updateAppSettingsIsInProgress:!1});case o.AppsActionTypes.RESET_APP_SETTINGS_ERROR:return p(p({},c),{},{updateAppSettingsError:""});case o.AppsActionTypes.RENAME_APP_REQUEST:return p(p({},c),{},{renameAppIsInProgress:!0});case o.AppsActionTypes.RENAME_APP_FULFILLED:return(n=c.powerapps.byId(u.payload.appId)).properties.displayName=u.payload.appDisplayName,t=Object(l.assign)(new r.CaseInsensitiveNormalized,c.powerapps),Object(r.add)(t,n),p(p({},c),{},{powerapps:t,renameAppIsInProgress:!1,renameAppError:""});case o.AppsActionTypes.RENAME_APP_REJECTED:return p(p({},c),{},{renameAppError:u.payload.error,renameAppIsInProgress:!1});case o.AppsActionTypes.RESET_APP_RENAME_ERROR:return p(p({},c),{},{renameAppError:""});case o.AppsActionTypes.VALIDATE_APP_DISPLAY_NAME_REQUEST:return p(p({},c),{},{validateAppDisplayNameIsInProgress:!0,validateAppDisplayNameError:""});case o.AppsActionTypes.VALIDATE_APP_DISPLAY_NAME_FULFILLED:return p(p({},c),{},{validateAppDisplayNameIsInProgress:!1,validateAppDisplayNameError:""});case o.AppsActionTypes.VALIDATE_APP_DISPLAY_NAME_REJECTED:return p(p({},c),{},{validateAppDisplayNameIsInProgress:!1,validateAppDisplayNameError:u.payload.error});case o.AppsActionTypes.RESET_VALIDATE_APP_DISPLAY_NAME_ERROR:return p(p({},c),{},{validateAppDisplayNameError:""});case o.AppsActionTypes.RESTORE_APP_VERSION:return p(p({},c),{},{restoreAppVersionResponse:{failed:!1,success:!1,loading:!0,message:""}});case o.AppsActionTypes.RESTORE_APP_VERSION_FULFILLED:return p(p({},c),{},{restoreAppVersionResponse:{failed:!1,success:!0,loading:!1,message:u.payload.message}});case o.AppsActionTypes.RESTORE_APP_VERSION_REJECTED:return p(p({},c),{},{restoreAppVersionResponse:{failed:!0,success:!1,loading:!1,message:u.payload.message}});case o.AppsActionTypes.CLEAR_RESTORE_APP_VERSION_RESPONSE:return p(p({},c),{},{restoreAppVersionResponse:{failed:!1,success:!1,loading:!1,message:""}});case o.AppsActionTypes.DELETE_APP_VERSION:return p(p({},c),{},{deleteAppVersionResponse:{failed:!1,success:!1,loading:!0,message:""}});case o.AppsActionTypes.DELETE_APP_VERSION_FULFILLED:return p(p({},c),{},{deleteAppVersionResponse:{failed:!1,success:!0,loading:!1,message:u.payload.message}});case o.AppsActionTypes.DELETE_APP_VERSION_REJECTED:return p(p({},c),{},{deleteAppVersionResponse:{failed:!0,success:!1,loading:!1,message:u.payload.message}});case o.AppsActionTypes.CLEAR_DELETE_APP_VERSION_RESPONSE:return p(p({},c),{},{deleteAppVersionResponse:{failed:!1,success:!1,loading:!1,message:""}});case i.AppModulesActionTypes.FETCH_APPMODULES_REJECTED:var S=p({},c.fetchAppErrorsByEnvironment);return S[u.payload.environmentId]=u.payload.error,p(p({},c),{},{fetchAppErrorsByEnvironment:S});case i.AppModulesActionTypes.FETCH_APPMODULES_FULFILLED:var f=p({},c.fetchAppErrorsByEnvironment);return delete f[u.payload.environmentId],p(p({},c),{},{xrm:Object(r.updateNormalizedData)(c.xrm,u.payload.appModules,u.payload.environmentId),fetchAppErrorsByEnvironment:f});case i.AppModulesActionTypes.DELETE_APPMODULE_SUCCEEDED:var h=Object(l.assign)(new r.CaseInsensitiveNormalized,c.xrm);return Object(r.removeResourceById)(h,u.payload.appModuleId),p(p({},c),{},{appModuleActionResponse:{success:!0,failed:!1,message:u.payload.message},xrm:h});case i.AppModulesActionTypes.DELETE_APPMODULE_ERROR:return p(p({},c),{},{appModuleActionResponse:{success:!1,failed:!0,message:u.payload.message}});case o.AppsActionTypes.CLEAR_DELETE_APP_MODULE_RESPONSE_MESSAGE:return p(p({},c),{},{appModuleActionResponse:{success:!1,failed:!1,message:null}});case o.AppsActionTypes.CLEAR_DELETE_CANVAS_APP_RESPONSE_MESSAGE:return p(p({},c),{},{deleteCanvasAppResponse:{success:!1,failed:!1,message:null}});case o.AppsActionTypes.PUBLISH_APP_VERSION_REQUEST:return p(p({},c),{},{publishAppVersionResponse:{failed:!1,success:!1,loading:!0,message:""}});case o.AppsActionTypes.PUBLISH_APP_VERSION_FULFILLED:return p(p({},c),{},{publishAppVersionResponse:{failed:!1,success:!0,loading:!1,message:""}});case o.AppsActionTypes.PUBLISH_APP_VERSION_REJECTED:return p(p({},c),{},{publishAppVersionResponse:{failed:!0,success:!1,loading:!1,message:u.payload.error}});case o.AppsActionTypes.CLEAR_PUBLISH_APP_VERSION_RESPONSE:return p(p({},c),{},{publishAppVersionResponse:{failed:!1,success:!1,loading:!1,message:""}});default:return c}}},6001:function(e,t,n){"use strict";n.r(t),n.d(t,"AppRenamePanel",(function(){return u}));var o=n(4013),r=n(1697),a=n(1201),i=n(1429),s=n(245),l=n(5629),c=n(2869);function p(){return(p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}class u extends s.Component{constructor(e){super(e),this.footerButtons=[],this.resources=void 0,this.resources=Object(c.getResources)(),this.state={appDisplayName:e.appDisplayName.trim(),isValid:!1,isPristine:!0},this.getErrorMessage=this.getErrorMessage.bind(this),this.onAppDisplayNameChange=this.onAppDisplayNameChange.bind(this)}componentDidUpdate(e){this.props.errorMessage&&this.props.errorMessage!==e.errorMessage&&this.setState({isPristine:!1})}render(){var e,t;this.footerButtons=this.getFooterButtons(),Object(l.isLoading)(this.props.loadProgress)?e=s.createElement("div",{className:"app-settings-spinner"},s.createElement(a.Spinner,{size:a.SpinnerSize.large})):(this.props.errorMessage&&(t=s.createElement(r.MessageBar,{messageBarType:r.MessageBarType.error,isMultiline:!0,dismissButtonAriaLabel:this.resources.Common.close,onDismiss:this.props.resetRenameAppError},this.props.errorMessage)),null!==this.state.appDisplayName&&(e=s.createElement("div",{className:"app-rename"},s.createElement("div",{className:"app-rename-section"},s.createElement(i.TextField,{label:this.resources.Controllers.AppSettings.appName,value:this.state.appDisplayName,onChange:this.onAppDisplayNameChange,onGetErrorMessage:this.getErrorMessage,required:!0})))));var n={title:this.resources.Controllers.App.ConfirmationDialog.title,subtext:this.resources.Controllers.App.ConfirmationDialog.subtext,confirmButtonText:this.resources.Controllers.App.ConfirmationDialog.confirmButtonText,cancelButtonText:this.resources.Controllers.App.ConfirmationDialog.cancelButtonText};return s.createElement(o.Panel,p({},this.props.defaultPanelProps,{closeButtonType:o.PanelCloseButtonType.Back,closeButtonAriaLabel:this.resources.Common.close,onDismiss:()=>{this.onDismiss()},headerText:this.resources.Controllers.AppSettings.appName,showDismissDialog:!this.state.isPristine,dismissDialog:n,footerButtons:this.footerButtons}),t,e)}getFooterButtons(){return[{primary:!0,ariaLabel:this.resources.Common.Save.save,text:this.resources.Common.Save.save,dismissableOnClick:()=>this.onSave(),disabled:!this.state.isValid||this.state.isPristine},{ariaLabel:this.resources.Common.Save.cancel,text:this.resources.Common.Save.cancel,dismissableOnClick:e=>{e()}}]}getErrorMessage(e){return 0===e.trim().length?(this.setState({isValid:!1}),this.resources.AppRenamePanel.DisplayName.Validation.Empty.text):e.trim().length>64?(this.setState({isValid:!1}),this.resources.AppRenamePanel.DisplayName.Validation.MaxLength.text):/^[^.\\\/:*?\"<>|]+$/gim.test(e)?(this.setState({isValid:!0}),""):(this.setState({isValid:!1}),this.resources.AppRenamePanel.DisplayName.Validation.AllowedCharacters.text)}onAppDisplayNameChange(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.state.appDisplayName!==t&&this.setState({appDisplayName:t,isPristine:!1})}onSave(){this.props.onSaveClick(this.state.appDisplayName.trim()),this.props.resetRenameAppError(),this.setState({isPristine:!0})}onDismiss(){this.props.resetRenameAppError(),this.props.onPanelClose()}}},6002:function(e,t,n){"use strict";n.r(t),n.d(t,"mapStateToProps",(function(){return O})),n.d(t,"mapDispatchToProps",(function(){return C})),n.d(t,"mergeProps",(function(){return v})),n.d(t,"AppSettingsPanelContainer",(function(){return P}));var o=n(5437),r=n(2835),a=n(3076),i=n(5596),s=n(5478),l=n(5629),c=n(5981),p=n(5649),u=n(5468),d=n(5885),m=n(6003),b=n(2840),g=n(5889),y=n(5890);function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(Object(n),!0).forEach((function(t){h(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var O=(e,t)=>{var n,o=Object(p.appSelector)(e,t.selectedAppId),a=null!==(n=Object(p.appWithUnpublishedDraftError)(e)||Object(p.appSettingsUpdateError)(e))&&void 0!==n?n:"",s=r.isTeamsApp(o),c=Object(b.isCanvasAppCustomizable)(o);return{appDisplayName:i.getAppDisplayName(o),loadProgress:[Object(l.toLoadingState)(!!Object(p.appSettingsUiLoaded)(e,t.selectedAppId),a,"appSettings"),Object(l.toLoadingState)(!t.loading,void 0,"licenseCheck"),Object(l.toLoadingState)(!t.billingPolicyLoading,void 0,"billingPolicyCheck")],errorMessage:a,isTeamsApp:s,hasUnpublishedDraft:!!Object(p.appWithUnpublishedDraftSelector)(e,t.selectedAppId),canConsumeAppPass:r.canConsumeAppPass(o),performanceOptimizationEnabled:r.getPerformanceOptimizationEnabled(o),appPlanClassification:i.getAppPlanClassification(o),isAppCustomizable:c}},C=e=>({onPanelClose:()=>e(u.sharedActions.panelClose({panelType:s.PanelToShowType.AppSettingsPanel})),fetchAppWithUnpublishedDraft:t=>{e(c.appsActions.fetchUnpublishedAppDefinitionRequest({appName:t}))},onAppRenameClick:t=>{e(c.appsActions.openAppRename({appId:t}))},onSaveClick:(t,n,o)=>{e(c.appsActions.updateAppSettingsRequest({appId:t,appSettingsToUpdate:n}))},resetUpdateAppSettingsError:()=>{e(c.appsActions.resetAppSettingsError())},onCreateBillingPolicyClick:(t,n)=>{e(u.sharedActions.panelOpen({panelType:s.PanelToShowType.BillingWizardPanel,panelProps:{appName:t,selectPlanTypeStepScenarioRef:n}}))},dispatchTelemetry:e}),v=(e,t,n)=>{var{onClosePanel:o}=n,r=n.selectedAppId,a=e.hasUnpublishedDraft;return f(f(f({},e),n),{},{selectedAppId:r,onPanelClose:()=>{t.onPanelClose(),o&&o()},onCreateBillingPolicyClick:(e,n)=>{t.onCreateBillingPolicyClick(e,n)},onMount:()=>{t.fetchAppWithUnpublishedDraft(r)},onAppRenameClick:()=>t.onAppRenameClick(r),onSaveClicked:e=>t.onSaveClick(r,e,a),resetUpdateAppSettingsError:()=>t.resetUpdateAppSettingsError(),defaultPanelProps:n.defaultPanelProps,dispatchTelemetry:t.dispatchTelemetry,openAppSettingsPanelScenario:n.openAppSettingsPanelScenario})},P=Object(g.withPayGoBehavior)(Object(a.withApolloClient)(Object(y.withBillingPolicyDetails)(Object(d.withLicenseBehavior)(Object(o.connect)(O,C,v)(m.AppSettingsPanel)))))},6003:function(e,t,n){"use strict";n.r(t),n.d(t,"AppSettingsPanel",(function(){return N}));var o=n(4013),r=n(1864),a=n(687),i=n(1259),s=n(1697),l=n(1201),c=n(245),p=n(1101),u=n(5629),d=n(2869),m=n(6004),b=n(2880),g=n(5492),y=n(5481),S=n(2871),f=n(2879),h=n(5596),O=n(5880),C=n(5896),v=n(5731),P=n(5732),E=n(5595),T=n(5881);function j(){return(j=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}function A(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function R(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?A(Object(n),!0).forEach((function(t){I(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):A(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function I(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function w(e,t,n,o,r,a,i){try{var s=e[a](i),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(o,r)}function D(e){return function(){var t=this,n=arguments;return new Promise((function(o,r){var a=e.apply(t,n);function i(e){w(a,o,r,i,s,"next",e)}function s(e){w(a,o,r,i,s,"throw",e)}i(void 0)}))}}class N extends c.Component{constructor(e){super(e),this.resources=void 0,this.footerButtons=void 0,this.selectPlanTypeStepScenarioRef=void 0,this.saveAppSettingsPanelScenario=void 0,this.appType=void 0,this.isPremium=()=>Object(h.getAppPlanClassificationDetails)(this.props.appPlanClassification,this.props.isPayGoBehaviorEnabled)==this.resources.Controllers.AppSettings.AppPlanClassification.Plans.Premium,this.isEnvironmentAdmin=function(){var e=D((function*(e){return yield Object(C.checkPermission)(e)}));return function(t){return e.apply(this,arguments)}}(),this.getLicensingAndBillingSection=e=>{var t,n=this.props.hasPerAppPlans||this.props.hasPerAppPlansForTeams,o=this.props.billingPolicy,r="Enabled"===(null==o||null===(t=o.powerAppsPolicy)||void 0===t?void 0:t.payAsYouGoState)&&o.status!=T.BillingPolicyStatus.ProvisioningFailed,a=this.props.loading||this.props.billingPolicyLoading,i=()=>{this.selectPlanTypeStepScenarioRef=Object(v.sendPerformanceTelemetry)(void 0,P.featureName,P.BillingWizardTelemetryScenarios.SelectPlanTypeStep.pageOpened),this.props.onCreateBillingPolicyClick(this.props.appDisplayName,this.selectPlanTypeStepScenarioRef)};return c.createElement(O.LicensingAndBillingSection,{appType:this.appType,appId:this.props.selectedAppId,isLoading:a||void 0===this.state.isEnvironmentAdmin,isPremium:this.isPremium(),isAdmin:this.state.isEnvironmentAdmin,policy:o,onCreateBillingPlan:()=>i(),toggle:this.getCanConsumeAppPassToggle(n,r),hasPerAppPlan:n,canConsumeAppPass:!!this.props.canConsumeAppPass,isPayGo:r,billingSuccess:this.props.billingSuccess})},this.getAppPlanClassifictationSection=()=>{var e=Object(h.getAppPlanClassificationDetails)(this.props.appPlanClassification,this.props.isPayGoBehaviorEnabled),t=this.props.isPayGoBehaviorEnabled?this.isPremium()?this.resources.Controllers.AppSettings.LicensingAndBilling.AppPlanTooltip.Premium.tooltip:this.resources.Controllers.AppSettings.LicensingAndBilling.AppPlanTooltip.Standard.tooltip:Object(b.formatResourceStringAsLinks)(e.tooltip,[y.default.appPlanClassificationLink]);return S.featureGates.enableAppPlanClassification&&e?c.createElement("div",{className:"app-settings-section"},c.createElement("div",{className:"app-settings-header"},this.resources.Controllers.AppSettings.AppPlanClassification.title),c.createElement("div",{className:"app-settings-infoButton"},c.createElement("label",{id:"lblAppClassificationPlanName"},e.displayName),c.createElement(i.TooltipHost,{content:t},c.createElement(i.IconButton,{iconProps:{iconName:f.fabricIcons.Info},ariaLabel:"app-plan-description"})))):c.createElement(c.Fragment,null)},this.getPerAppPassesSection=()=>{if(S.featureGates.enablePerAppPlans){var e=this.props.hasPerAppPlans||this.props.hasPerAppPlansForTeams;return c.createElement("div",{className:"app-settings-section"},c.createElement("div",{className:"app-settings-seperator"}),c.createElement("div",{className:"app-settings-header"},this.resources.Controllers.AppSettings.PerAppPasses.title),c.createElement("div",{className:"section-description"},Object(b.formatResourceStringAsLinks)(this.resources.Controllers.AppSettings.PerAppPasses.description,[y.default.perAppPlanLearnMore])),this.getCanConsumeAppPassToggle(e))}return c.createElement(c.Fragment,null)},this.getPerfOptimizationSection=()=>p.featureGates.enablePreloadInTeamsEmbed?c.createElement("div",{className:"app-settings-section"},c.createElement("div",{className:"app-settings-seperator"}),c.createElement("div",{className:"app-settings-header"},this.resources.Controllers.AppSettings.TeamsAppPerfOptimization.title),c.createElement("div",{className:"section-description"},Object(b.formatResourceStringAsLinks)(this.resources.Controllers.AppSettings.TeamsAppPerfOptimization.description,[y.default.preloadLearnMore],{target:"_blank","aria-label":this.resources.Controllers.AppSettings.TeamsAppPerfOptimization.learnMoreAriaLabel})),c.createElement(r.Toggle,{defaultChecked:this.props.performanceOptimizationEnabled,onText:this.resources.Controllers.AppSettings.ToggleText.toggleOnText,offText:this.resources.Controllers.AppSettings.ToggleText.toggleOffText,onChange:(e,t)=>this.onPerfOptimizationToggleChange(e,!!t),styles:{label:{fontSize:"14px",fontFamily:g.fonts.segoeUiSemibold+" !important"}},ariaLabel:Object(b.formatResourceString)(this.resources.Controllers.AppSettings.TeamsAppPerfOptimization.description,"")})):c.createElement(c.Fragment,null),this.resources=Object(d.getResources)(),this.state={isPristine:!0,canConsumeAppPass:!!e.canConsumeAppPass,canConsumeAppPassToggleTouched:!1,performanceOptimizationEnabled:!!e.performanceOptimizationEnabled,performanceOptimizationEnabledToggleTouched:!1,isEnvironmentAdmin:void 0},this.saveAppSettingsPanelScenario=null,this.footerButtons=[],this.onAppNameEditClick=this.onAppNameEditClick.bind(this),this.selectPlanTypeStepScenarioRef=null,this.appType=P.AppType.CanvasApp}componentDidMount(){var e=this;return D((function*(){var t;if(e.props.isPayGoBehaviorEnabled){var{environmentClient:n}=e.props;e.isEnvironmentAdmin(n).then(t=>{e.setState({isEnvironmentAdmin:t})})}e.props.onMount(),null===(t=e.props.openAppSettingsPanelScenario)||void 0===t||t.complete({appType:e.appType,appId:e.props.selectedAppId,isPremium:e.isPremium()})}))()}componentDidUpdate(e){var t,n,o=E.CanvasAppSettingsActionEvents.OnSaveClick.getData(this.props.selectedAppId,this.getAppSettingsToUpdate(),this.props.hasUnpublishedDraft);this.props.errorMessage&&this.props.errorMessage!==e.errorMessage?(this.setState({isPristine:!1}),null===(t=this.saveAppSettingsPanelScenario)||void 0===t||t.completeWithError(R(R({},o),{},{error:this.props.errorMessage}))):null===(n=this.saveAppSettingsPanelScenario)||void 0===n||n.complete(o);this.saveAppSettingsPanelScenario=null}render(){var e,t;this.footerButtons=this.getFooterButtons(),Object(u.isLoading)(this.props.loadProgress)?e=c.createElement("div",{className:"app-settings-spinner"},c.createElement(l.Spinner,{size:l.SpinnerSize.large})):(this.props.errorMessage&&(t=c.createElement(s.MessageBar,{messageBarType:s.MessageBarType.error,isMultiline:!0,dismissButtonAriaLabel:this.resources.Common.close,onDismiss:this.props.resetUpdateAppSettingsError},this.props.errorMessage)),e=c.createElement("div",{className:m.appSettingsPanelStyleClasses.appSettings},c.createElement("div",{className:"app-settings-section"},c.createElement("label",{id:"lblAppDisplayName"},this.resources.Controllers.AppSettings.appName),c.createElement("div",{className:"input-description","aria-labelledby":"lblAppDisplayName"},c.createElement("button",{className:m.appSettingsPanelStyleClasses.appSettingsNameButton,"aria-label":this.props.appDisplayName+" "+this.resources.Controllers.AppSettings.AppName.editButton,disabled:!this.props.isAppCustomizable,onClick:this.onAppNameEditClick},c.createElement("span",{className:"input-description-text",title:this.props.appDisplayName},this.props.appDisplayName),c.createElement(a.Icon,{className:"app-display-name-edit-icon",iconName:"Edit"})))),this.getAppPlanClassifictationSection(),this.props.isPayGoBehaviorEnabled?this.getLicensingAndBillingSection(this.props):this.getPerAppPassesSection(),this.getPerfOptimizationSection()));var n={title:this.resources.Controllers.App.ConfirmationDialog.title,subtext:this.resources.Controllers.App.ConfirmationDialog.subtext,confirmButtonText:this.resources.Controllers.App.ConfirmationDialog.confirmButtonText,cancelButtonText:this.resources.Controllers.App.ConfirmationDialog.cancelButtonText};return c.createElement(o.Panel,j({},this.props.defaultPanelProps,{closeButtonAriaLabel:this.resources.Common.close,onDismiss:()=>{this.onDismiss()},headerText:this.resources.Controllers.App.Settings.title,showDismissDialog:!this.state.isPristine,dismissDialog:n,footerButtons:this.footerButtons}),t,e)}getFooterButtons(){return[{primary:!0,ariaLabel:this.resources.Common.Save.save,text:this.resources.Common.Save.save,dismissableOnClick:()=>this.onSave(),disabled:this.state.isPristine},{ariaLabel:this.resources.Common.Save.cancel,text:this.resources.Common.Save.cancel,dismissableOnClick:e=>{e()}}]}onAppNameEditClick(){this.props.onAppRenameClick()}onPerAppPlansToggleChange(e,t){this.setState({canConsumeAppPass:t,isPristine:!1,canConsumeAppPassToggleTouched:!0})}onPerfOptimizationToggleChange(e,t){this.setState({performanceOptimizationEnabled:t,isPristine:!1,performanceOptimizationEnabledToggleTouched:!0})}onSave(){var e=this.getAppSettingsToUpdate();this.saveAppSettingsPanelScenario=Object(v.sendPerformanceTelemetry)(E.CanvasAppSettingsActionEvents.OnSaveClick.getData(this.props.selectedAppId,e,this.props.hasUnpublishedDraft),P.featureName,P.AppSettingsTelemetryScenarios.Save),this.props.onSaveClicked(e),this.props.resetUpdateAppSettingsError(),this.setState({isPristine:!0})}getAppSettingsToUpdate(){var e;return e=this.state.canConsumeAppPassToggleTouched?{canConsumeAppPass:this.state.canConsumeAppPass}:{},this.state.performanceOptimizationEnabledToggleTouched&&(e=R(R({},e),{},{performanceOptimizationEnabled:this.state.performanceOptimizationEnabled})),e}onDismiss(){this.props.billingSuccess.setValue(!1),this.props.resetUpdateAppSettingsError(),this.props.onPanelClose()}getCanConsumeAppPassToggle(e,t){return c.createElement(r.Toggle,{label:!this.props.isPayGoBehaviorEnabled&&this.resources.Controllers.AppSettings.PerAppPasses.toggleHeader,defaultChecked:this.state.canConsumeAppPass&&(t||e),onText:this.props.isPayGoBehaviorEnabled?this.resources.Controllers.AppSettings.LicensingAndBilling.Toggle.onText:this.resources.Controllers.AppSettings.ToggleText.toggleOnText,offText:this.props.isPayGoBehaviorEnabled?this.resources.Controllers.AppSettings.LicensingAndBilling.Toggle.offText:this.resources.Controllers.AppSettings.ToggleText.toggleOffText,onChange:(e,t)=>this.onPerAppPlansToggleChange(e,!!t),styles:{label:{fontSize:"14px",fontFamily:g.fonts.segoeUiSemibold+" !important"}},disabled:!this.props.isPayGoBehaviorEnabled&&!e,ariaLabel:this.props.isPayGoBehaviorEnabled?this.resources.Controllers.AppSettings.ToggleText.descriptionPerAppPasses:this.resources.Controllers.AppSettings.ToggleText.descriptionPayGo})}}},6004:function(e,t,n){"use strict";n.r(t),n.d(t,"appSettingsPanelStyleClasses",(function(){return i}));var o=n(719),r=n(5492),a=n(2882),i=Object(o.mergeStyleSets)({appSettings:{selectors:{".app-settings-spinner .spinner":{top:"auto"},label:{font:"14px ".concat(r.fonts.segoeUi),maxWidth:"none",marginBottom:"5px"},".app-settings-section":{marginBottom:"12px",selectors:{".ms-Dropdown-container":{selectors:{"@media screen and (-ms-high-contrast: active)":{selectors:{".ms-Dropdown":{selectors:{":focus::after":{backgroundColor:"transparent"}}}}}}}}},".app-settings-section-inner":{marginBottom:"12px",paddingLeft:"10px",marginLeft:"10px",selectors:{".ms-Dropdown-container":{selectors:{"@media screen and (-ms-high-contrast: active)":{selectors:{".ms-Dropdown":{selectors:{":focus::after":{backgroundColor:"transparent"}}}}}}}}},".app-settings-header":{fontFamily:r.fonts.segoeUi,fontWeight:600,color:a.fabricColors.black,marginBottom:"5px"},".input-description-text":{whiteSpace:"nowrap"},".section-description":{fontSize:"14px",marginBottom:"8px"},".app-settings-seperator":{borderBottom:"1px solid ".concat(a.fabricColors.lighterGray),marginTop:"18px",marginBottom:"18px"},".app-settings-infoButton":{verticalAlign:"top",display:"inline-block",textAlign:"center",selectors:{button:{marginTop:"-5px"}}}}},appSettingsNameButton:{cursor:"pointer",border:0,padding:0,backgroundColor:"transparent",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",selectors:{"& .app-display-name-edit-icon":{marginLeft:"5px",minWidth:"16px",verticalAlign:"top"}}}})},6005:function(e,t,n){"use strict";n.r(t),n.d(t,"CanvasAppSharePanelContainer",(function(){return y}));var o=n(245),r=n.n(o),a=n(5437),i=n(2869),s=n(6006),l=n(2880),c=n(5596),p=n(6360),u=n(5468),d=n(5478),m=n(303),b=n(219),g=n.n(b),y=e=>{var{selectedApp:t,onClosePanel:n,defaultPanelProps:o}=e,b=Object(i.getResources)(),y=Object(c.getAppDisplayName)(t),S=Object(l.formatResourceString)(b.Apps.ManageApp.Share.Panel.title,y),f=b.Apps.ManageApp.Share.Panel.subtitle,h=Object(a.useDispatch)(),O=Object(m.useLocation)(),C=O&&g()(O.search,!0).query,v=!(!C||!C.isadminscope);return r.a.createElement(s.AppSharePanelContainer,{selectedApp:t,isAdminScope:v,defaultPanelProps:o,panelTitle:S,panelSubtitle:f,permissionsContainer:p.CanvasAppPermissionSectionContainer,onPanelClose:()=>{h(u.sharedActions.panelClose({panelType:d.PanelToShowType.AppSharePanel})),n&&n()}})}},6006:function(e,t,n){"use strict";n.r(t),n.d(t,"ImplicitlySharedConfirmEventName",(function(){return E})),n.d(t,"AppSharePanelContainer",(function(){return T})),n.d(t,"hasCDSConnection",(function(){return j}));var o=n(245),r=n.n(o),a=n(5437),i=n(6007),s=n.n(i),l=n(1697),c=n(684),p=n(5596),u=n(2889),d=n(6008),m=n(6024),b=n(6009),g=n(6355),y=n(6010),S=n(5629),f=n(6022),h=n(6359),O=n(2869),C=n(2880),v=n(5481),P=n(5593),E="AppSharePanel/ImplicitlyShared/Confirm",T=e=>{var t,{panelTitle:n,panelSubtitle:i,selectedApp:T,defaultPanelProps:A,permissionsContainer:R,isAdminScope:I}=e,w=Object(a.useDispatch)(),D=Object(O.getResources)(),[N,L]=Object(o.useState)(!0),M=Object(p.getAppName)(T),x=Object(a.useSelector)(b.modifyResourcePermissionsError),k=Object(a.useSelector)(y.cdsRoleSubmissionResultSelector),F=!!Object(a.useSelector)(b.modifyResourcePermissionsSelector);k.status==S.ComponentLoadState.Fail&&(x=x?"".concat(x," ").concat(k.error):null!==(t=k.error)&&void 0!==t?t:"");var _,U=Object(a.useSelector)(e=>Object(b.resourcePermissionsSelector)(e,M)),V={success:F&&s()(x),inProgress:Object(a.useSelector)(b.modifyResourcePermissionsLoadingSelector),error:x},B=e.isComponentLibrary||!1,H=Object(h.connectionsToList)(T),G=H.findIndex(e=>e.isImplicitlyShared)>-1;if(G&&N){var W=Object(C.formatResourceStringAsLinks)(D.Apps.ManageApp.Share.Connections.implicitWarning,[v.default.sharedPowerAppsConnections]);_={messageBarProps:{messageBarType:l.MessageBarType.severeWarning,actions:r.a.createElement("div",null,r.a.createElement(c.MessageBarButton,{onClick:()=>{Object(P.trackUserActionClickButton)(E),L(!1)}},"Confirm"))},onRenderBody:()=>W}}var q=G&&N;return r.a.createElement(h.AppShareContext.Provider,{value:{dataSources:H,hasImplicitlySharedConnection:G}},r.a.createElement(d.SharePanelContainer,{permissionsForExistingUsers:U,submitPanelResponse:V,panelTitle:n,panelSubtitle:i,onPanelClose:()=>{e.onPanelClose(),w(m.resourcesActions.modifyResourcePermissionsClear()),w(Object(f.submitRoleAssignmentResultClear)())},onMount:()=>w(g.shareActions.fetchSharePanelData({resourceName:M,resourceType:u.ResourceType.App,hasCdsConnection:j(T),isAdminScope:I})),onPanelSubmit:(e,t)=>{(e||t.size)&&w(m.resourcesActions.modifyResourcePermissionsRequest({resourceName:M,resourceType:u.ResourceType.App,requestData:e,cdsRoleAssignments:t,refreshShareData:!0,isAdminScope:I,isComponentLibrary:B}))},permissionsContainer:R,defaultPanelProps:A,resource:T,isAdminScope:I,messageBar:_,isShareDisabled:q}))};function j(e){var t=e&&e.properties;if(t&&t.connectionReferences){var n=t.connectionReferences;for(var o of Object.keys(n)){var r=n[o];if(Object(p.isConnectionCDSType)(r))return!0}}return!!t.databaseReferences}},6008:function(e,t,n){"use strict";n.r(t),n.d(t,"mapStateToProps",(function(){return D})),n.d(t,"mapDispatchToProps",(function(){return N})),n.d(t,"mergeProps",(function(){return L})),n.d(t,"createUserPermission",(function(){return M})),n.d(t,"createPermissionUIItem",(function(){return x})),n.d(t,"SharePanelContainer",(function(){return k}));var o=n(2867),r=n(2812),a=n(5437),i=n(6009),s=n(6010),l=n(5626),c=n(5602),p=n(5471),u=n(5637),d=n(6011),m=n(2889),b=n(5597),g=n(2869),y=n(5629),S=n(6012),f=n(6017),h=n(6014),O=n(6022),C=n(5669),v=n(5487),P=n(5604),E=n(5606),T=n(1190),j=["permissionsForExistingUsers","onPanelSubmit","resourceCapabilities","rootProps","isAdminScope"];function A(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function R(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?A(Object(n),!0).forEach((function(t){I(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):A(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function I(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function w(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var D=(e,t)=>{var n=Object(o.Map)(),a=!1,p=Object(l.aadUserSelector)(e),d=p&&p.tenantId,m=Object(s.isSharePanelDataLoadingSelector)(e),b=Object(i.modifyResourcePermissionsLoadingSelector)(e),g=Object(s.sharePanelDataRequestError)(e),S=Object(s.shareResourceLoadedName)(e);return m||b||S!==t.resource.name||(n=function(e,t){var n=t.permissionsForExistingUsers;if(!n)return Object(o.Map)();var a=Object(o.Map)().withMutations(t=>{n.filter(t=>{var n=Object(u.getPrincipalId)(t);return n&&!Object(u.isPermissionPrincipalRemovedFromTenant)(t)&&!Object(u.isServicePrincipal)(t)&&(Object(u.isPermissionForTenant)(t)||Object(l.graphDirectoryObjectsSelector)(e,n))}).forEach(n=>{var o=Object(u.getPrincipalId)(n),r=M(o,n,e);t.set(o,r)})});return a=a.withMutations(e=>{n.filter(u.isViralSharePermission).forEach(t=>{var n=t.id,o=function(e,t){var n=Object(u.getPermissionEmail)(t),o={text:n,objectId:e,principalType:c.PrincipalType.User},a=x(t,n,!1,!0);return{userListItem:o,originalPermission:a,modifiedPermission:r.cloneDeep(a)}}(n,t);e.set(n,o)})})}(e,t),a=!0),{logEvent:f.SharePanelLoadEvent,loadProgress:[Object(y.toLoadingState)(a,g)],existingUsersPermissions:n,currentAadUserObjectId:p&&p.objectId,tenantId:d,permissionOrDirectoryObjectDataErrorMessage:g}},N=(e,t)=>({dispatchTelemetry:e,fetchCurrentUserRoles:t=>{e(Object(O.fetchCDSRoleforUser)({objectId:t,isGroup:!1,shouldSendTelemetryEvent:!0,scenarioName:"share/fetchCurrentUserCDSRole"}))}}),L=(e,t,n)=>{var{existingUsersPermissions:o,loadProgress:r}=e,{permissionOrDirectoryObjectDataErrorMessage:a}=e,{permissionsForExistingUsers:i,onPanelSubmit:s,resourceCapabilities:l,rootProps:g,isAdminScope:y}=n,f=w(n,j),{fetchCurrentUserRoles:h}=t,O=g.currentEnvironment;return R(R({},f),{},{onPanelSubmit:(e,t,o,r)=>{s(function(e,t,n,o,r,a,i){var s=null;(e.size||t.size)&&(s={put:e.map(e=>function(e,t,n,o){var r=Object(p.getResourceType)(t),a=Object(u.getRole)(Object(S.getRoleNameFromModifiedPermission)(e),t),i=Object(S.getObjectIdFromUserPermission)(e),s=Object(S.getPrincipalTypeFromModifiedPermission)(e),l=Object(u.isTenantPermissionType)(s),d={roleName:a&&a.roleName,principal:{email:Object(S.getEmailFromUserPermission)(e),id:l?null:i,type:s,tenantId:l?i:null}};switch(r){case m.ResourceType.Flow:return{properties:d};default:return{properties:R(R({},d),{},{capabilities:o,NotifyShareTargetOption:n?c.NotifyShareTargetOptions.Notify:c.NotifyShareTargetOptions.DoNotNotify})}}}(e,n,o,r)).toArray(),delete:t.map(e=>{var t=Object(S.getObjectIdFromUserPermission)(e);return Object(u.isTenantPermissionType)(Object(S.getPrincipalTypeFromModifiedPermission)(e))&&(t=Object(d.createFullTenantId)(t)),{id:Object(b.getResourceUserPermissionsUrlBasedOnType)(Object(p.getResourceType)(n),Object(u.getResourceName)(n),t,a,i)}}).toArray()});return s}(e,t,n.resource,r,l,Object(P.getNameFromCurrentEnvironment)(O),y),o)},fetchCurrentUserRoles:h,existingUsersPermissions:o,currentAadUserObjectId:e.currentAadUserObjectId,loadProgress:r,logEvent:e.logEvent,startEventData:{ResourceType:n.resource.type,ResourceName:n.resource.name},dispatchTelemetry:t.dispatchTelemetry,permissionOrDirectoryObjectDataErrorMessage:a,isAdminScope:y})};function M(e,t,n){var o,a=Object(g.getResources)(),i=Object(l.graphDirectoryObjectsSelector)(n,e),s=Object(l.allowListFeaturesSelector)(n);if(Object(u.isPermissionForTenant)(t)){var p=Object(l.graphTenantDetailsSelector)(n,e);o={text:a.Apps.ManageApp.Share.EveryoneDisplayName.replace("{0}",p.displayName),objectId:e,principalType:c.PrincipalType.Tenant,isGuest:!1}}else o=Object(h.createUserListItemFromCurrentDirectoryObject)(i,null,s);var d=o.text,m=E.SagaContextProps.getAadUser(),b=null==m?void 0:m.objectId,y=x(t,d,Object(T.equalsIgnoreCase)(b,e),!1,o.isGuest);return{userListItem:o,originalPermission:y,modifiedPermission:r.cloneDeep(y)}}function x(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return{roleName:Object(u.getRoleNameForPermission)(e),principalType:Object(u.getPrincipalType)(e),principalDisplayName:t,isPermissionForCurrentUser:n,isViralShare:o,isGuestUser:r}}var k=Object(v.withRootProps)(Object(a.connect)(D,N,L)(Object(y.withLoadTelemetry)(S.SharePanel,C.LoadScenarioNames.SharePanel)))},6009:function(e,t,n){"use strict";n.r(t),n.d(t,"resourcePermissionsSelector",(function(){return o})),n.d(t,"resourcePermissionsError",(function(){return r})),n.d(t,"resourcePermissionsCacheComplete",(function(){return a})),n.d(t,"modifyResourcePermissionsSelector",(function(){return i})),n.d(t,"modifyResourcePermissionsLoadingSelector",(function(){return s})),n.d(t,"modifyResourcePermissionsError",(function(){return l}));var o=(e,t)=>e.resources.resourcePermissions&&e.resources.resourcePermissions.get(t),r=e=>e.resources.resourcePermissionsError,a=(e,t)=>{var n=o(e,t);return n&&n.length>0},i=e=>e.resources.modifyPermissionsResponse,s=e=>e.resources.modifyPermissionsInProgress,l=e=>e.resources.modifyPermissionsError},6010:function(e,t,n){"use strict";n.r(t),n.d(t,"isSharePanelDataLoadingSelector",(function(){return o})),n.d(t,"sharePanelDataRequestError",(function(){return r})),n.d(t,"shareResourceLoadedName",(function(){return a})),n.d(t,"shareCDSRolesSelector",(function(){return i})),n.d(t,"userCDSRolesSelector",(function(){return s})),n.d(t,"multipleUserCDSRolesSelector",(function(){return l})),n.d(t,"currentUserSelector",(function(){return c})),n.d(t,"cdsRoleLoadingSelector",(function(){return p})),n.d(t,"cdsRoleErrorSelector",(function(){return u})),n.d(t,"businessUnitSelector",(function(){return d})),n.d(t,"businessUnitLoadErrorSelector",(function(){return m})),n.d(t,"cdsRoleSubmissionResultSelector",(function(){return b}));var o=e=>e.sharedata.isSharePanelDataLoading,r=e=>e.sharedata.sharePanelDataError,a=e=>e.sharedata.resourceLoadedName,i=e=>e.sharedata.cdsDefaultRoles,s=(e,t)=>e.sharedata.cdsUserRoles.get(t),l=(e,t)=>t.map(t=>e.sharedata.cdsUserRoles.get(t)),c=e=>e.sharedata.currentUser,p=e=>e.sharedata.isCDSRoleLoading,u=e=>e.sharedata.getUserCdsRoleError,d=e=>e.sharedata.businessUnit,m=e=>e.sharedata.businessUnitLoadError,b=e=>e.sharedata.cdsRoleSubmissionResult},6011:function(e,t,n){"use strict";function o(e){return"tenant-".concat(e)}n.r(t),n.d(t,"createFullTenantId",(function(){return o}))},6012:function(e,t,n){"use strict";n.r(t),n.d(t,"getObjectIdFromUserPermission",(function(){return E})),n.d(t,"getEmailFromUserPermission",(function(){return T})),n.d(t,"getRoleNameFromOriginalPermission",(function(){return j})),n.d(t,"getRoleNameFromModifiedPermission",(function(){return A})),n.d(t,"getPrincipalTypeFromModifiedPermission",(function(){return R})),n.d(t,"setRoleNameForModifiedPermission",(function(){return I})),n.d(t,"getAppIdBasedOnScope",(function(){return w})),n.d(t,"SharePanel",(function(){return D}));var o=n(2867),r=n(1362),a=n(1697),i=n(545),s=n(245),l=n(5602),c=n(5637),p=n(2869),u=n(5638),d=n(5629),m=n(6013),b=n(6014),g=n(2871),y=n(5923),S=n(5924),f=n(5925),h=n(5926),O=n(5794),C=n(5593),v=n(860);function P(){return(P=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}function E(e){return e&&e.userListItem&&e.userListItem.objectId}function T(e){return e&&e.userListItem&&e.userListItem.secondaryText}function j(e){return e&&e.originalPermission&&e.originalPermission.roleName}function A(e){return e&&e.modifiedPermission&&e.modifiedPermission.roleName}function R(e){return e&&e.modifiedPermission&&e.modifiedPermission.principalType}function I(e,t){e&&e.modifiedPermission&&(e.modifiedPermission.roleName=t)}function w(e,t,n){return n?"/providers/Microsoft.PowerApps/scopes/admin/environments/".concat(t,"/apps/").concat(e):Object(O.getAppId)(e)}class D extends s.Component{static getDerivedStateFromProps(e,t){if(D.isDataLoaded(e)&&null===t.existingUsers)return{existingUsers:e.existingUsersPermissions};if(t.waitingForDataAfterSubmission&&e.submitPanelResponse){if(e.submitPanelResponse.success&&D.isDataLoaded(e))return{existingUsers:e.existingUsersPermissions,newUsers:Object(o.Map)(),selectedNewUserIds:Object(o.Set)(),selectedExistingUserIds:Object(o.Set)(),waitingForDataAfterSubmission:!1,userSecurityRoles:Object(o.Map)()};if(e.submitPanelResponse.error)return{waitingForDataAfterSubmission:!1,userSecurityRoles:Object(o.Map)()}}return null}componentDidUpdate(e){this.getCurrentAadUserRoleName(this.props,!1)===this.getCurrentAadUserRoleName(e,!1)&&this.getRoleNameForCurrentAadUserObjectId(this.props)===this.getRoleNameForCurrentAadUserObjectId(e)&&this.props.isShareDisabled===e.isShareDisabled||this.trackEnabledInfo()}trackEnabledInfo(){var e,t,{isAdminScope:n=!1,isShareDisabled:o}=this.props;Object(C.trackInfoTrace)("SharePanel/EnabledInfo",{roleName:null!==(e=this.getCurrentAadUserRoleName(this.props,!1))&&void 0!==e?e:"None",roleNameFromOriginal:null!==(t=this.getRoleNameForCurrentAadUserObjectId(this.props))&&void 0!==t?t:"None",isAdminScope:n,isShareDisabledProp:o})}static isDataLoaded(e){return Object(d.getTotalLoadingState)(e.loadProgress)===d.ComponentLoadState.Complete}constructor(e){super(e),this.resources=void 0,this.createUserListItemsFromUserPermissionMap=Object(i.memoizeFunction)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object(o.Map)(),t=e.keySeq().toArray();return t.map(t=>{var n=e.get(t),o=n.userListItem,r=A(n),a=Object(c.getRole)(r);return o.key=t,o.objectId=o.objectId||t,o.isOwner=Object(c.isRoleNameForOwner)(r),o.tertiaryText=Object(c.getShareDisplayText)(a),o})})),this.onEmailChecked=(e,t)=>{this.setState({notifyShareUsersByEmail:t})},this.resources=Object(p.getResources)(),this.state={existingUsers:D.isDataLoaded(e)?e.existingUsersPermissions:null,newUsers:Object(o.Map)(),notifyShareUsersByEmail:!0,selectedExistingUserIds:Object(o.Set)(),selectedNewUserIds:Object(o.Set)(),waitingForDataAfterSubmission:!1,userSecurityRoles:Object(o.Map)()}}componentDidMount(){this.props.onMount(),this.props.fetchCurrentUserRoles(this.props.currentAadUserObjectId),this.trackEnabledInfo()}getEmailCheckBox(){return s.createElement("div",{className:m.sharePanelClasses.emailCheckbox},s.createElement(r.Checkbox,{label:this.resources.Share.Panel.checkboxText,onChange:this.onEmailChecked,checked:!!this.state.notifyShareUsersByEmail}))}render(){var e=this.props.permissionsContainer,t=this.props.submitPanelResponse,n=null,o=this.props.messageBar,r={title:this.resources.Resources.ManageResource.Share.Panel.ConfirmationDialog.title,subtext:this.resources.Resources.ManageResource.Share.Panel.ConfirmationDialog.subtext,confirmButtonText:this.resources.Resources.ManageResource.Share.Panel.ConfirmationDialog.confirmButtonText,cancelButtonText:this.resources.Resources.ManageResource.Share.Panel.ConfirmationDialog.cancelButtonText};t&&t.inProgress||this.state.waitingForDataAfterSubmission?n=this.resources.Share.Panel.shareInProgress:Object(d.isLoading)(this.props.loadProgress)?n=this.resources.Common.Loading.ellipses:this.props.permissionOrDirectoryObjectDataErrorMessage?o=this.getMessageBar(this.props.permissionOrDirectoryObjectDataErrorMessage,a.MessageBarType.error):t&&t.success&&!this.state.waitingForDataAfterSubmission&&D.isDataLoaded(this.props)?o=this.getMessageBar(this.resources.Share.Panel.shareSuccess,a.MessageBarType.success):t&&t.error&&(o=this.getMessageBar(this.props.submitPanelResponse.error,a.MessageBarType.error));var i=Object(v.getResponsiveMode)(window)<=v.ResponsiveMode.large;return s.createElement(h.SharePanel,P({},this.props.defaultPanelProps,{onDismiss:()=>{this.props.onPanelClose()},headerText:this.props.panelTitle,footerButtons:this.getFooterButtons(),panelSubtitle:this.props.panelSubtitle,loadingMessage:n,isLoading:!!n,showDismissDialog:!(!this.getAddAndModifyShareSubmitData().size&&!this.getDeleteSubmitShareSubmitData().size),dismissDialog:r,messageBar:o}),s.createElement(S.PanelSections,null,s.createElement(y.LeftPanelSection,null,s.createElement("div",{className:m.sharePanelClasses.userSelectionSection,"data-is-scrollable":"true"},s.createElement(b.UserSelectionSectionContainer,{newUsers:this.getNewUsersData(),existingUsers:this.getExistingUsersData(),onNewUserSelectionChange:e=>this.onNewUserSelectionChange(e),onExistingUserSelectionChange:e=>this.onExistingUserSelectionChange(e),selectedNewUserIds:this.state.selectedNewUserIds,selectedExistingUserIds:this.state.selectedExistingUserIds,parentLoadingState:this.props.loadProgress&&this.props.loadProgress[0],onNewUsersAdded:e=>this.onNewUsersAdded(e),onUserRemoved:e=>this.onUserRemoved(e)})),!i&&this.getEmailCheckBox()),s.createElement(f.RightPanelSection,null,s.createElement("div",{className:m.sharePanelClasses.permissionSection},s.createElement(e,{userPermissions:this.getPermissionForSelectedUsers(),resource:this.props.resource,onPermissionRoleUpdate:e=>this.onPermissionRoleUpdate(e),onSecurityRoleAdded:(e,t,n)=>this.onSecurityRoleAdded(e,t,n),onSecurityRoleRemoved:(e,t,n)=>this.onSecurityRoleRemoved(e,t,n),isNewSecurityRoleAdded:(e,t)=>this.isNewSecurityRoleAdded(e,t),parentLoadingState:this.props.loadProgress&&this.props.loadProgress[0],isAdminScope:this.props.isAdminScope})),i&&this.getEmailCheckBox())))}getFooterButtons(){var e=this.props.isAdminScope||Object(c.roleNameHasSharePermission)(this.getCurrentAadUserRoleName(this.props));return[{primary:!0,ariaLabel:this.resources.Common.share,text:this.resources.Common.share,dismissableOnClick:()=>{this.setState({waitingForDataAfterSubmission:!0});var e=null;g.featureGates.showCDSSecurityRolesForShare&&(e=this.getRoleAssignments()),this.props.onPanelSubmit(this.getAddAndModifyShareSubmitData(),this.getDeleteSubmitShareSubmitData(),e,this.state.notifyShareUsersByEmail)},disabled:this.props.isShareDisabled||!D.isDataLoaded(this.props)||this.state.waitingForDataAfterSubmission||!e||!(this.getAddAndModifyShareSubmitData().size||this.getDeleteSubmitShareSubmitData().size||this.isNewRolesDirty())||this.props.submitPanelResponse.inProgress},{ariaLabel:this.resources.Common.Save.cancel,text:this.resources.Common.Save.cancel,disabled:this.props.submitPanelResponse.inProgress||this.state.waitingForDataAfterSubmission,dismissableOnClick:e=>{e()}}]}onSecurityRoleAdded(e,t,n){this._onSecurityRoleAddRemovedCommon(e,t,e=>(e.newSecurityRoles.find(e=>e.roleid==n.roleid)||(e.newSecurityRoles=e.newSecurityRoles.add(n)),e))}onSecurityRoleRemoved(e,t,n){this._onSecurityRoleAddRemovedCommon(e,t,e=>(e.newSecurityRoles=e.newSecurityRoles.withMutations(e=>{e.forEach(t=>{t.roleid==n.roleid&&e.remove(t)})}),e))}isNewRolesDirty(){return!!this.state.userSecurityRoles.size&&!!this.state.userSecurityRoles.find(e=>e.newSecurityRoles.size>0)}getPermissionForSelectedUsers(){var e=this.state.newUsers?this.state.newUsers.filter(e=>this.isSelected(e)).map(e=>e.modifiedPermission).toArray():[],t=this.state.existingUsers?this.state.existingUsers.filter(e=>this.isSelected(e)).map(e=>e.modifiedPermission).toArray():[];return(e||[]).concat(t)}getNewUsersData(){var e=this.state.newUsers||Object(o.Map)();return this.createUserListItemsFromUserPermissionMap(e)}getExistingUsersData(){var e=this.state.existingUsers||Object(o.Map)();return this.createUserListItemsFromUserPermissionMap(e)}onNewUserSelectionChange(e){this.setState({selectedNewUserIds:e})}onExistingUserSelectionChange(e){this.setState({selectedExistingUserIds:e})}onNewUsersAdded(e){var t=this.state.newUsers,n=Object(o.Map)().withMutations(n=>{e.forEach(e=>{var o=e.objectId;t.has(o)?n.set(o,t.get(o)):n.set(o,this.createUserPermissionForNewUser(e))})});this.setState({newUsers:n})}createUserPermissionForNewUser(e){return{userListItem:e,originalPermission:void 0,modifiedPermission:{roleName:l.RoleName.CanView,principalType:e.principalType,principalDisplayName:e.text,isPermissionForCurrentUser:!1,isGuestUser:e.isGuest}}}isSelected(e){var t=E(e);return this.state.selectedNewUserIds.contains(t)||this.state.selectedExistingUserIds.contains(t)}onPermissionRoleUpdate(e){var t=Object(o.Map)().withMutations(t=>{this.state.newUsers.forEach((n,o)=>{this.isSelected(n)&&I(n,e),t.set(o,n)})}),n=Object(o.Map)().withMutations(t=>{this.state.existingUsers.forEach((n,o)=>{this.isSelected(n)&&!Object(c.isRoleNameForOwner)(j(n))&&I(n,e),t.set(o,n)})});this.setState({newUsers:t,existingUsers:n})}_onSecurityRoleAddRemovedCommon(e,t,n){var r=this.state.userSecurityRoles.withMutations(r=>{var a;a=r.has(e)?r.get(e):{objectId:e,systemId:t,newSecurityRoles:Object(o.Set)()},a=n(a),r.set(e,a)});this.setState({userSecurityRoles:r})}isNewSecurityRoleAdded(e,t){return!!this.state.userSecurityRoles.has(e)&&this.state.userSecurityRoles.get(e).newSecurityRoles.has(t)}onUserRemoved(e){var t=e.objectId;this.state.newUsers.has(t)&&this.setState({newUsers:this.state.newUsers.remove(t)}),this.state.existingUsers.has(t)&&this.setState({existingUsers:this.state.existingUsers.remove(t)})}getCurrentAadUserRoleName(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=(e.existingUsersPermissions&&e.existingUsersPermissions.valueSeq()).map(e=>e.originalPermission).toArray(),o=Object(c.getRoleNameForPermission)(Object(c.getPermissionForResource)(e.resource));return o||(t?!this.hasGroupPermission(n)&&this.getRoleNameForCurrentAadUserObjectId(e):void 0)}hasGroupPermission(e){return!(!e||!e.length)&&e.some(e=>Object(u.equalsIgnoreCase)(e.principalType,l.PrincipalType.Group))}getRoleNameForCurrentAadUserObjectId(e){return j(e.existingUsersPermissions.get(e.currentAadUserObjectId))}getAddAndModifyShareSubmitData(){return(this.state.existingUsers?this.state.existingUsers.remove(this.props.currentAadUserObjectId):Object(o.Map)()).filter(e=>A(e)!==j(e)).filter(e=>!e.originalPermission.isViralShare).concat(this.state.newUsers)}getDeleteSubmitShareSubmitData(){return this.props.existingUsersPermissions.withMutations(e=>{this.state.existingUsers&&this.state.existingUsers.forEach(t=>{e.remove(t.userListItem.objectId)}),this.state.newUsers&&this.state.newUsers.forEach(t=>{e.remove(t.userListItem.objectId)})}).filter(e=>!e.originalPermission.isViralShare)}getMessageBar(e,t){return{messageBarProps:{messageBarType:t},onRenderBody:()=>s.createElement("span",null,e)}}getRoleAssignments(){return Object(o.Map)(this.state.userSecurityRoles.map((e,t)=>[t,{aadId:e.objectId,id:e.systemId,isGroup:Object(c.isGroupPermissionType)(this.getPrincipleType(e.objectId)),roles:e.newSecurityRoles.toArray()}]).valueSeq())}getPrincipleType(e){var t;if(this.state.newUsers.has(e))t=this.state.newUsers.get(e);else{if(!this.state.existingUsers.has(e))throw new Error("cannot find user ".concat(e," in the state"));t=this.state.existingUsers.get(e)}return t.userListItem.principalType}}},6013:function(e,t,n){"use strict";n.r(t),n.d(t,"sharePanelClasses",(function(){return r}));var o=n(719),r=Object(o.mergeStyleSets)({userSelectionSection:["user-selection-section section",{minWidth:"340px",overflowX:"hidden",overflowY:"scroll",padding:"16px"}],emailCheckbox:["email-checkbox",{selectors:{button:{width:"100%"},span:{fontWeight:"400",paddingTop:"16px",paddingBottom:"16px",backgroundColor:"rgb(255, 255, 255)"},div:{borderTop:"2px solid rgb(234, 234, 234)",borderRight:"1px solid rgb(234, 234, 234)",selectors:{".ms-Checkbox-checkbox":{marginTop:"16px",marginLeft:"16px"}}}}}],permissionSection:["permissions-section section",{flex:"1 1 100%",padding:"16px"}]})},6014:function(e,t,n){"use strict";n.r(t),n.d(t,"createUserListItemFromUser",(function(){return E})),n.d(t,"createUserListItemFromGroup",(function(){return T})),n.d(t,"createUserListItemForTenant",(function(){return j})),n.d(t,"createUserListItemFromCurrentDirectoryObject",(function(){return A})),n.d(t,"convertUsersAndGroupsToUserListItems",(function(){return R})),n.d(t,"getCurrentUsersList",(function(){return I})),n.d(t,"mapStateToProps",(function(){return w})),n.d(t,"mapDispatchToProps",(function(){return D})),n.d(t,"mergeProps",(function(){return N})),n.d(t,"UserSelectionSectionContainer",(function(){return L}));var o=n(1265),r=n(5437),a=n(5474),i=n(5626),s=n(6015),l=n(6016),c=n(5602),p=n(5637),u=n(2869),d=n(2880),m=n(5638),b=n(5629),g=n(6017),y=n(6018),S=n(5669),f=["parentLoadingState","onUserRemoved"],h=["tenantId"];function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function C(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach((function(t){v(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function P(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function E(e,t,n){var r=Object(m.equalsIgnoreCase)(s.GraphConstants.UserTypes.guest,e.userType)?Object(d.formatResourceString)(Object(u.getResources)().Share.Panel.Guest.user,e.displayName):e.displayName;return{objectId:e.objectId,principalType:c.PrincipalType.User,text:r,secondaryText:Object(l.getEmailFromPrincipalName)(e.userPrincipalName),imageUrl:e.thumbnailPhoto||n,size:o.PersonaSize.size32,isGuest:Object(m.equalsIgnoreCase)(s.GraphConstants.UserTypes.guest,e.userType)}}function T(e){return{objectId:e.objectId,principalType:c.PrincipalType.Group,text:e.displayName,secondaryText:e.mailEnabled?e.mail:e.displayName,size:o.PersonaSize.size32,isGroupEmailEnabled:e.mailEnabled}}function j(e,t){var n=t&&t.displayName;return{objectId:e,principalType:c.PrincipalType.Tenant,text:Object(u.getResources)().Apps.ManageApp.Share.EveryoneDisplayName.replace("{0}",n),secondaryText:"",size:o.PersonaSize.size32}}function A(e,t,n){return Object(l.isUser)(e)?E(e,0,t):Object(l.isGroup)(e)?T(e):null}function R(e,t,n){var o=[];return(e||[]).map(e=>{o.push(E(e))}),(t||[]).map(e=>{e.securityEnabled&&o.push(T(e))}),o}function I(e,t,n){return(e||[]).map(e=>A(e,n))}var w=(e,t)=>{var n=Object(i.aadUserSelector)(e),o=Object(i.allowListFeaturesSelector)(e);return{logEvent:g.CurrentAadUsersLoadEvent,loadProgress:[t.parentLoadingState],tenantId:n&&n.tenantId,currentAadUserDomains:Object(i.graphAadTenantDomainsSelector)(e),allowlistFeatures:o,isFetchUsersAndGroupsCompleted:t=>{var n=Object(i.graphAadUsersSelectorCacheComplete)(e,t),o=Object(i.graphAadGroupsSelectorCacheComplete)(e,t),r=Object(i.graphAadUsersSelectorError)(e,t),a=Object(i.graphAadGroupsSelectorError)(e,t);return n&&o||!!r||!!a},aadUsersAndGroupsBasedOnFilterText:r=>{var a=R(Object(i.graphAadUsersSelector)(e,r),Object(i.graphAadGroupsSelector)(e,r)),s=Object(u.getResources)().Share.Panel.everyoneDisplayName,l=r.toLocaleLowerCase();if(!o.BlockTenantPermissions&&(s.toLocaleLowerCase().includes(l)||p.EveryoneSearchTerm.includes(l))){var c=Object(i.graphTenantDetailsSelector)(e,n.tenantId);a.push(j(n.tenantId,c))}return a&&a.filter(e=>{var n=t.existingUsers.find(t=>Object(m.equalsIgnoreCase)(e.objectId,t.objectId)),o=t.newUsers.find(t=>Object(m.equalsIgnoreCase)(e.objectId,t.objectId));return!n&&!o})}}},D=e=>({dispatchTenantsDirectoryObjects:t=>{e(Object(a.fetchGraphTenantsDirectoryObjects)({objectIds:t}))},dispatchTenantPhoto:()=>{e(Object(a.fetchGraphTenantThumbnailPhoto)())},dispatchTenantDomains:()=>{e(Object(a.fetchGraphTenantDomains)())},dispatchUsersByEmailAddressOrDisplayNameMatch:(t,n)=>{e(Object(a.fetchGraphUsersByEmailAddressOrDisplayNameMatch)({emailAddressOrDisplayName:t,isCompleteString:n}))},dispatchGroupsByEmailAddressOrDisplayNameMatch:(t,n)=>{e(Object(a.fetchGraphGroupsByEmailAddressOrDisplayNameMatch)({displayName:t,isCompleteString:n}))},dispatchTelemetry:e}),N=(e,t,n)=>{var{parentLoadingState:o,onUserRemoved:r}=n,a=P(n,f),{tenantId:i}=e;return C(C({},P(e,h)),{},{fetchCurrentAadUserDomains:()=>{t.dispatchTenantDomains()},fetchUsersAndGroupsBasedOnFilterText:(e,n)=>{t.dispatchUsersByEmailAddressOrDisplayNameMatch(e,n),t.dispatchGroupsByEmailAddressOrDisplayNameMatch(e,n)},aadUsersAndGroupsBasedOnFilterText:e.aadUsersAndGroupsBasedOnFilterText,dispatchTelemetry:t.dispatchTelemetry,onUserRemoved:e=>{r(e)}},a)},L=Object(r.connect)(w,D,N)(Object(b.withLoadTelemetry)(y.UserSelectionSection,S.LoadScenarioNames.UserSelectionSection))},6015:function(e,t,n){"use strict";n.r(t),n.d(t,"GraphConstants",(function(){return o}));var o={UserTypes:{guest:"Guest",member:"Member"},DirectoryObjectTypes:{user:"user",group:"group"}}},6016:function(e,t,n){"use strict";n.r(t),n.d(t,"isUser",(function(){return i})),n.d(t,"isGroup",(function(){return s})),n.d(t,"getEmailFromPrincipalName",(function(){return l})),n.d(t,"getBase64ImageUri",(function(){return c})),n.d(t,"arrayBufferToBase64",(function(){return p})),n.d(t,"getDisplayName",(function(){return u})),n.d(t,"getEveryoneAvatar",(function(){return d}));var o=n(5493),r=n(5638),a=n(6015);function i(e){return Object(r.equalsIgnoreCase)(e.objectType,a.GraphConstants.DirectoryObjectTypes.user)}function s(e){return Object(r.equalsIgnoreCase)(e.objectType,a.GraphConstants.DirectoryObjectTypes.group)}function l(e){if(e.indexOf("#EXT#")>-1){var t=(e=e.split("#EXT#")[0]).lastIndexOf("_");t>0&&(e=e.substr(0,t)+"@"+e.substr(t+1))}return e}function c(e){return"data:image/JPEG;base64,".concat(p(e))}function p(e){var t=new Uint8Array(e);return btoa(t.reduce((e,t)=>e+String.fromCharCode(t),""))}function u(e){return e.displayName}function d(){return o.default.svg.everyoneAvatar}},6017:function(e,t,n){"use strict";n.r(t),n.d(t,"CurrentAadUsersLoadEvent",(function(){return o})),n.d(t,"SharePanelLoadEvent",(function(){return r})),n.d(t,"SharePanelResourceShareEvents",(function(){return a}));var o={eventName:"AadUsers.Load"},r={eventName:"SharePanel.Load"},a={PermissionAdded:{eventName:"Share.Permission.Added"},PermissionModified:{eventName:"Share.Permission.Modified"},PermissionRevoked:{eventName:"Share.Permissions.Revoked"},AddOrganizationClicked:{eventName:"Share.AddOrganization.Clicked"},SaveClicked:{eventName:"Share.Save.Clicked"}}},6018:function(e,t,n){"use strict";n.r(t),n.d(t,"UserSelectionSection",(function(){return l}));var o=n(245),r=n(2869),a=n(6019),i=n(6021),s=n(6023);class l extends o.Component{constructor(e){super(e),this.resources=void 0,this.resources=Object(r.getResources)(),this.state={peoplePickerFilterText:"",userNotFoundReasonText:"",currentSearch:""}}render(){return o.createElement(o.Fragment,null,o.createElement(a.UserSelectionPicker,{currentUsers:this.props.newUsers.concat(this.props.existingUsers),isFetchUsersAndGroupsCompleted:this.props.isFetchUsersAndGroupsCompleted,aadUsersAndGroupsBasedOnFilterText:this.props.aadUsersAndGroupsBasedOnFilterText,fetchUsersAndGroupsBasedOnFilterText:this.props.fetchUsersAndGroupsBasedOnFilterText,onNewUsersAdded:this.onNewUsersAdded.bind(this),allowlistFeatures:this.props.allowlistFeatures}),o.createElement("div",{className:s.userSelectionSectionClasses.UserSelectionPicker},this.renderNewUsersListSection(),this.renderExistingUsersListSection()))}onNewUsersAdded(e){var t=this.props.newUsers.concat(e);this.props.onNewUsersAdded(t);var n=this.props.selectedNewUserIds.withMutations(t=>{e.forEach(e=>{t.add(e.objectId)})});this.props.onNewUserSelectionChange(n)}renderNewUsersListSection(){return this.props.newUsers&&this.props.newUsers.length>0?o.createElement(i.UsersListContainer,{title:this.resources.Apps.ManageApp.Share.NewUsers,users:this.props.newUsers,onUserRemoved:this.props.onUserRemoved,areUsersAutoSelected:!0,shouldShowSorter:!1,onUsersSelectionChange:this.props.onNewUserSelectionChange,selectedUserIds:this.props.selectedNewUserIds,ariaLabelForSelectionColumn:this.resources.Apps.ManageApp.Share.ariaLabelForSelection}):null}renderExistingUsersListSection(){return this.props.existingUsers&&this.props.existingUsers.length>0?o.createElement(i.UsersListContainer,{title:this.resources.Apps.ManageApp.Share.ExistingUsers,users:this.props.existingUsers,onUserRemoved:this.props.onUserRemoved,areUsersAutoSelected:!1,shouldShowSorter:!0,onUsersSelectionChange:this.props.onExistingUserSelectionChange,selectedUserIds:this.props.selectedExistingUserIds,ariaLabelForSelectionColumn:this.resources.Apps.ManageApp.Share.ariaLabelForSelection}):null}}},6019:function(e,t,n){"use strict";n.r(t),n.d(t,"UserSelectionPicker",(function(){return d}));var o=n(2867),r=n(2812),a=n(1601),i=n(1201),s=n(1240),l=n(245),c=n(2869),p=n(2880),u=n(6020);class d extends l.Component{constructor(e){super(e),this.resources=void 0,this.suggestionProps=void 0,this.aadUsersAndGroupsPromise=void 0,this.aadUsersAndGroupsResolvePromise=void 0,this.outlookRegEx=/<[^\]]*>/,this._onItemsChange=e=>{var t=[],n=[];e.forEach(e=>{this.state.usersToAdd.has(e.searchTerm)?t.push(e):this.state.errorUsers.has(e.searchTerm)?n.push(e):this.props.onNewUsersAdded([e])}),this.setState({usersToAdd:Object(o.Map)().withMutations(e=>{t.forEach(t=>{e.set(t.searchTerm,t)})}),errorUsers:Object(o.Map)().withMutations(e=>{n.forEach(t=>{e.set(t.searchTerm,t)})})})},this._onInputChange=e=>{if(e&&e.indexOf(";")>-1){var t=e.split(";").filter(e=>e&&e.length>=3).map(e=>{var t=this._getEmailFromOutlookFormat(e);return this.props.fetchUsersAndGroupsBasedOnFilterText(t,!0),this._createGenericItem(e,t)}),n=this.state.usersToAdd.withMutations(e=>{t.forEach((t,n)=>{e.set(t.searchTerm,t)})});return this.setState({usersToAdd:n}),""}return e.length<3&&this.setState({userNotFoundReasonText:"",peoplePickerFilterText:"",lastUserInInput:""}),e},this._createGenericItem=(e,t)=>({objectId:"",principalType:"",loadingState:u.UserListItemState.Loading,searchTerm:t,inputedString:e}),this._renderItem=e=>{switch(e.item.loadingState){case u.UserListItemState.Complete:return l.createElement("span",null);case u.UserListItemState.Loading:return l.createElement(i.Spinner,{size:i.SpinnerSize.small});case u.UserListItemState.Failed:var t=r.some(this.props.currentUsers,(function(t){return t.secondaryText&&t.secondaryText.toUpperCase()===e.item.searchTerm.toUpperCase()||t.text&&t.text.toUpperCase()===e.item.searchTerm.toUpperCase()})),n=Object(p.formatResourceString)(t?this.resources.Share.Panel.inputPeoplePickerAlreadyAdded:this.resources.Share.Panel.inputPeoplePickerNotFound,e.item.inputedString);return l.createElement("div",{className:"sharePeoplePickerErrorLabelContainer"},l.createElement(s.TooltipHost,{content:n,calloutProps:{gapSpace:0}},l.createElement("div",{"aria-label":n,className:"sharePeoplePickerErrorLabel"},e.item.inputedString,";")));default:return l.createElement("div",null,e.item.inputedString,"; ")}},this._onFilterChanged=(e,t,n)=>{if(this.aadUsersAndGroupsPromise=new Promise(e=>{this.aadUsersAndGroupsResolvePromise=e}),e&&e.length>=3){this.aadUsersAndGroupsPromise=new Promise(e=>{this.aadUsersAndGroupsResolvePromise=e});var o=this._getEmailFromOutlookFormat(e),a=r.some(this.props.currentUsers,(function(e){return e.secondaryText&&e.secondaryText.toUpperCase().includes(o.toUpperCase())||e.text&&e.text.toUpperCase().includes(o.toUpperCase())})),i=Object(p.formatResourceString)(a?this.resources.Share.Panel.inputPeoplePickerAlreadyAdded:this.resources.Share.Panel.inputPeoplePickerNotFoundGeneric,o);return this.setState({userNotFoundReasonText:i,peoplePickerFilterText:e,lastUserInInput:o}),this.props.fetchUsersAndGroupsBasedOnFilterText(o,!1),this.aadUsersAndGroupsPromise}return this.state.usersToAdd.toArray()},this.resources=Object(c.getResources)(),this.aadUsersAndGroupsPromise=new Promise(e=>{this.aadUsersAndGroupsResolvePromise=e}),this.suggestionProps={loadingText:this.resources&&this.resources.Share.Panel.inputPeoplePickerLoading,noResultsFoundText:"",className:"sharePeoplePicker",suggestionsItemClassName:"share-panel-suggestion-item"},this.state={lastUserInInput:null,peoplePickerFilterText:"",userNotFoundReasonText:"",usersToAdd:Object(o.Map)(),errorUsers:Object(o.Map)()}}componentDidUpdate(e){if(this.state.usersToAdd.size>0){var t=!1,n=[],r=[],a=[];if(this.state.usersToAdd.forEach(e=>{if(this.props.isFetchUsersAndGroupsCompleted(e.searchTerm)){t=!0;var o=this.props.aadUsersAndGroupsBasedOnFilterText(e.searchTerm);e.searchTerm===this.state.lastUserInInput&&o.length>1?this.props.isFetchUsersAndGroupsCompleted(this.state.lastUserInInput)&&this.aadUsersAndGroupsResolvePromise(o):o.length<1?(e.loadingState=u.UserListItemState.Failed,r.push(e)):1===o.length?((e=o[0]).loadingState=u.UserListItemState.Complete,a.push(e)):(e.loadingState=u.UserListItemState.Failed,r.push(o[0]))}else n.push(e)}),t){this.props.onNewUsersAdded(a);var i=Object(o.Map)().withMutations(e=>{n.forEach(t=>{e.set(t.searchTerm,t)})}),s=this.state.errorUsers.withMutations(e=>{r.forEach(t=>{e.set(t.searchTerm,t)})});this.setState({usersToAdd:i,errorUsers:s})}}}render(){if(this.state.lastUserInInput&&this.props.isFetchUsersAndGroupsCompleted(this.state.lastUserInInput)){var e=this.props.aadUsersAndGroupsBasedOnFilterText(this.state.lastUserInInput);this.aadUsersAndGroupsResolvePromise(e)}this.suggestionProps.noResultsFoundText=this.state.userNotFoundReasonText,this.state.peoplePickerFilterText.length>=3?this.suggestionProps.className="sharePeoplePicker":this.suggestionProps.className="sharePeoplePicker shareHideCallout";var t=this.state.usersToAdd.toArray().concat(this.state.errorUsers.toArray());return l.createElement(a.NormalPeoplePicker,{onResolveSuggestions:this._onFilterChanged,resolveDelay:200,pickerSuggestionsProps:this.suggestionProps,className:"ba-ListPeoplePicker",selectedItems:t,onInputChange:this._onInputChange,onChange:this._onItemsChange,inputProps:{placeholder:0===t.length&&this.resources&&(this.props.allowlistFeatures.BlockTenantPermissions?this.resources.Share.Panel.inputPeoplePickerPlaceholderWithoutEveryone:this.resources.Share.Panel.inputPeoplePickerPlaceholder),"aria-label":this.resources&&this.resources.Share.Panel.inputPeoplePickerPlaceholder},onRenderItem:this._renderItem})}_getEmailFromOutlookFormat(e){var t,n=e.match(this.outlookRegEx);return n&&n[0]&&(t=(t=n[0].replace(/(^<|>$)/g,"")).trim()),t||e}}},6020:function(e,t,n){"use strict";n.r(t),n.d(t,"SortOrder",(function(){return o})),n.d(t,"SortType",(function(){return r})),n.d(t,"UserListItemState",(function(){return a})),n.d(t,"UsersList",(function(){return v}));var o,r,a,i=n(3064),s=n(1265),l=n(2867),c=n(2812),p=n(684),u=n(1471),d=n(1473),m=n(1240),b=n(719),g=n(245),y=n(5637),S=n(2879),f=n(2869),h=n(5633),O=n(2871);function C(){return(C=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}!function(e){e[e.Ascending=0]="Ascending",e[e.Descending=1]="Descending"}(o||(o={})),function(e){e[e.Name=0]="Name",e[e.UserType=1]="UserType"}(r||(r={})),function(e){e[e.Loading=0]="Loading",e[e.Complete=1]="Complete",e[e.Failed=2]="Failed"}(a||(a={}));class v extends g.Component{static getDerivedStateFromProps(e,t){var n={},o=t.selection,r=!1;return e.users.length!==t.usersListSize&&(o.setItems(e.users,!1),n.usersListSize=e.users.length,r=!0),v.hasUserSelectionChanged(o,e.selectedUserIds)&&(o=v.updateSelection(o,e.selectedUserIds),r=!0),e.users.length>t.usersListSize&&e.areUsersAutoSelected&&(o=v.selectLastAddedUsers(e.users,o,e.users.length-t.usersListSize),r=!0),r&&(n.selection=o),c.isEmpty(n)?null:n}static hasUserSelectionChanged(e,t){return!(!e||!t)&&(e.getSelectedCount()!==t.size||0!==Object(l.Set)(e.getSelection().map(e=>e.key)).subtract(t).size)}static selectLastAddedUsers(e,t,n){for(var o=e.length-1;o>=e.length-n;o--)t.setIndexSelected(e.length-1,!0,!1);return t}static updateSelection(e,t){for(var n of(e.setAllSelected(!1),t.toArray()))e.setKeySelected(n,!0,!1);return e}constructor(e){super(e),this.columns=void 0,this.resources=Object(f.getResources)(),this.onKeyPress=e=>{" "!==e.key&&32!==e.charCode&&32!==e.which||(e.preventDefault(),this.toggleAllUsersSelection())},this._sortBy=e=>{this.setState({currentSortType:e})},this.columns=this.buildColumns(),this.state={usersListSize:0,currentSortType:r.Name,sortOrder:c.isNil(this.props.initialSortOrder)?o.Ascending:this.props.initialSortOrder,selection:new d.Selection({canSelectItem:(e,t)=>!e.isOwner,onSelectionChanged:()=>{var t=this.state.selection.getSelection();if(e.onUsersSelectionChange(Object(l.Set)(t.map(e=>e.objectId))),O.featureGates.showCDSSecurityRolesForShare&&1===this.state.selection.getSelection().length){var n=t.map(e=>({objectId:e.objectId,principalType:e.principalType})),o=Object(y.isGroupPermissionType)(n[0].principalType);e.getUserRoles(n[0].objectId,o)}}})}}render(){var e=Object(b.mergeStyleSets)({check:{selectors:{":hover, :focus":{opacity:1,cursor:"pointer"}}}});return g.createElement("div",{className:"users-list-section"},g.createElement("div",{className:"users-list-section-header"},g.createElement(u.DetailsRowCheck,{canSelect:!0,selected:this.state.selection.isAllSelected(),onClick:()=>this.toggleAllUsersSelection(),tabIndex:0,className:e.check,"aria-label":this.props.ariaLabelForSelectionColumn,onKeyPress:this.onKeyPress}),g.createElement("span",{className:"users-list-section-title"},this.props.title),this.props.shouldShowSorter&&this.getSorterContextMenu()),g.createElement(i.DetailsList,C({isHeaderVisible:!1,items:this.props.users,columns:this.columns,setKey:"itemCollection",selectionMode:d.SelectionMode.multiple,selection:this.state.selection,selectionPreservedOnEmptyClick:!0},Object(h.getDetailsListProps)(this.resources.Common.rowSelectionAriaLabel),{layoutMode:void 0})))}buildColumns(){var e=!!this.props.shouldShowSorter||void 0,t=this.props.shouldShowSorter?(e,t)=>{var n,a;switch(this.state.currentSortType){case r.Name:n=e.text,a=t.text;break;case r.UserType:n=e.tertiaryText,a=t.tertiaryText}return this.state.sortOrder===o.Descending?a>n?1:-1:n>a?1:-1}:void 0;return[{key:"persona-details",name:this.props.title,fieldName:"persona-details",minWidth:150,isPadded:!1,isMultiline:!1,isSorted:e,onRender:e=>{var t;return t=Object(y.isTenantPermissionType)(e.principalType)?e.text:Object(y.isGroupPermissionType)(e.principalType)?e.isGroupEmailEnabled?"".concat(e.text,"<").concat(e.secondaryText,">"):e.text:e.secondaryText?"".concat(e.text,"<").concat(e.secondaryText,">"):"".concat(e.text),this.props.loadThumbnail(e.objectId),g.createElement(m.TooltipHost,{content:t},g.createElement(s.Persona,{imageUrl:e.imageUrl,text:e.text,secondaryText:e.tertiaryText,size:s.PersonaSize.size40,onRenderPrimaryText:e=>g.createElement(g.Fragment,null,e.text),onRenderSecondaryText:e=>g.createElement(g.Fragment,null,e.secondaryText)}))},sortBy:t},{key:"action",name:"action",fieldName:"action",minWidth:48,maxWidth:48,isPadded:!1,isMultiline:!1,onRender:e=>{var t={menuIconProps:{iconName:S.fabricIcons.Cancel,style:{fontSize:16}}};return e.isOwner?null:g.createElement(m.TooltipHost,{content:this.resources.Apps.ManageApp.Share.RemoveThis},g.createElement(p.IconButton,C({},t,{ariaLabel:this.resources.Apps.ManageApp.Share.RemoveThis,onClick:()=>this.userRemoved(e)})))}}]}userRemoved(e){this.props.onUserRemoved(e)}toggleAllUsersSelection(){this.state.selection.setAllSelected(!this.state.selection.isAllSelected())}getSorterContextMenu(){return g.createElement(g.Fragment,null,g.createElement(p.DefaultButton,{className:"users-list-sorter",styles:{root:{borderColor:"transparent"}},text:"".concat(this.resources.Apps.ManageApp.Share.SorterHeader," ").concat(this._getSortingOptionDisplayName(this.state.currentSortType)),menuProps:{id:"users-list-menu",shouldFocusOnMount:!0,items:[{key:"SortByName",className:"users-list-menu-sortByName",name:this.resources.Apps.ManageApp.Share.SorterCriteria.Name,iconProps:{iconName:this._getContextualItemIcon(r.Name)},onClick:()=>this._sortBy(r.Name),ariaLabel:this._getMenuItemAriaLabel(r.Name),checked:this._getMenuItemIsChecked(r.Name)},{key:"SortByUserType",className:"users-list-menu-sortByUserType",name:this.resources.Apps.ManageApp.Share.SorterCriteria.UserType,iconProps:{iconName:this._getContextualItemIcon(r.UserType)},onClick:()=>this._sortBy(r.UserType),ariaLabel:this._getMenuItemAriaLabel(r.UserType),checked:this._getMenuItemIsChecked(r.UserType)}]}}))}_getSortingOptionDisplayName(e){switch(e){case r.Name:return this.resources.Apps.ManageApp.Share.SorterCriteria.Name;case r.UserType:return this.resources.Apps.ManageApp.Share.SorterCriteria.UserType;default:return""}}_getContextualItemIcon(e){return this.state.currentSortType===e?S.fabricIcons.Accept:""}_getMenuItemAriaLabel(e){switch(e){case r.Name:return this.resources.Apps.ManageApp.Share.SorterCriteria.Name;case r.UserType:return this.resources.Apps.ManageApp.Share.SorterCriteria.UserType;default:return""}}_getMenuItemIsChecked(e){return this.state.currentSortType===e}}},6021:function(e,t,n){"use strict";n.r(t),n.d(t,"mapStateToProps",(function(){return g})),n.d(t,"mapDispatchToProps",(function(){return S})),n.d(t,"mergeProps",(function(){return f})),n.d(t,"UsersListContainer",(function(){return h}));var o=n(5437),r=n(6022),a=n(5474),i=n(6016),s=n(5637),l=n(6020),c=["users"],p=["loadThumbnailByUserId"];function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){m(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function b(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var g=e=>({thumbnailsInProgress:e.shared.graphAadTenantThumbnailPhotoUriInProgress,thumbnails:e.shared.graphAadTenantThumbnailPhotoUri});function y(e,t){return t.map(t=>{var n=t.objectId;return Object(s.isTenantPermissionType)(t.principalType)?(t.imageUrl=Object(i.getEveryoneAvatar)(),t):(Object(s.isGroupPermissionType)(t.principalType)||(t.imageUrl=e.get(n)),t)})}var S=e=>({loadThumbnailByUserId:t=>{e(Object(a.fetchGraphTenantThumbnailPhoto)({objectId:t}))},getUserRoles:(t,n)=>{e(Object(r.fetchCDSRoleforUser)({objectId:t,isGroup:n,shouldSendTelemetryEvent:!0,scenarioName:"share.fetchCDSRole"}))}}),f=(e,t,n)=>{var{users:o}=n,r=b(n,c),{thumbnails:a,thumbnailsInProgress:i}=e,{loadThumbnailByUserId:s}=t,l=b(t,p);return d(d(d({},r),l),{},{loadThumbnail:e=>{a.has(e)||i.has(e)||s(e)},users:y(a,o)})},h=Object(o.connect)(g,S,f)(l.UsersList)},6022:function(e,t,n){"use strict";var o;function r(e){return{type:o.FETCH_SHARE_PANEL_DATA,payload:e}}function a(e){return{type:o.FETCH_USER_CDS_ROLE,payload:e}}function i(e){return{type:o.FETCH_USER_CDS_ROLE_FINISHED,payload:e}}function s(e){return{type:o.FETCH_SHARE_PANEL_DATA_FINISHED,payload:e}}function l(e){return{type:o.FETCH_CDS_ROLES_FINISHED,payload:e}}function c(e){return{type:o.FETCH_ROOT_BUSINSESS_UNIT,payload:e}}function p(e){return{type:o.FETCH_ROOT_BUSINSESS_UNIT_FINISHED,payload:e}}function u(e){return{type:o.SUBMIT_ROLE_ASSIGNMENT,payload:e}}function d(e){return{type:o.SUBMIT_ROLE_ASSIGNMENT_FINISHED,payload:e}}function m(e){return{type:o.ADD_NEW_CDS_USER,payload:e}}function b(){return{type:o.SUBMIT_ROLE_ASSIGNMENT_RESULT_CLEAR}}n.r(t),n.d(t,"ShareActionTypes",(function(){return o})),n.d(t,"fetchSharePanelData",(function(){return r})),n.d(t,"fetchCDSRoleforUser",(function(){return a})),n.d(t,"fetchCDSRoleForUserFinished",(function(){return i})),n.d(t,"fetchSharePanelDataFinished",(function(){return s})),n.d(t,"fetchCDSRolesFinished",(function(){return l})),n.d(t,"fetchRootBusinessUnit",(function(){return c})),n.d(t,"fetchRootBusinessUnitFinished",(function(){return p})),n.d(t,"submitRoleAssignmentRequest",(function(){return u})),n.d(t,"submitRoleAssignmentFinished",(function(){return d})),n.d(t,"addNewCdsUser",(function(){return m})),n.d(t,"submitRoleAssignmentResultClear",(function(){return b})),function(e){e.FETCH_SHARE_PANEL_DATA="maker/resources/FETCH_SHARE_PANEL_DATA",e.FETCH_SHARE_PANEL_DATA_FINISHED="maker/resources/FETCH_SHARE_PANEL_DATA_FINISHED",e.FETCH_USER_CDS_ROLE="maker/resources/FETCH_USER_CDS_ROLE",e.FETCH_USER_CDS_ROLE_FINISHED="maker/resources/FETCH_USER_CDS_ROLE_FINISHED",e.FETCH_CDS_ROLES_FINISHED="makers/resources/FETCH_CDS_ROLES_FINISHED",e.FETCH_ROOT_BUSINSESS_UNIT="makers/resources/FETCH_ROOT_BUSINSESS_UNIT",e.FETCH_ROOT_BUSINSESS_UNIT_FINISHED="makers/resources/FETCH_ROOT_BUSINSESS_UNIT_FINISHED",e.SUBMIT_ROLE_ASSIGNMENT="makers/resources/SUBMIT_ROLE_ASSIGNMENT",e.SUBMIT_ROLE_ASSIGNMENT_FINISHED="makers/resources/SUBMIT_ROLE_ASSIGNMENT_FINISHED",e.SUBMIT_ROLE_ASSIGNMENT_RESULT_CLEAR="makers/resources/SUBMIT_ROLE_ASSIGNMENT_RESULT_CLEAR",e.ADD_NEW_CDS_USER="makers/resources/ADD_NEW_CDS_USER"}(o||(o={}))},6023:function(e,t,n){"use strict";n.r(t),n.d(t,"userSelectionSectionClasses",(function(){return r}));var o=n(719),r=Object(o.mergeStyleSets)({UserSelectionPicker:["user-selection-section-picker",{minHeight:"590px",paddingBottom:"15px",marginLeft:"-16px",marginRight:"-32px",height:"600px"}]})},6024:function(e,t,n){"use strict";n.r(t);var o=n(6025);n.d(t,"resourcesActions",(function(){return o}));var r=n(6026);n.d(t,"resourcesMiddlewares",(function(){return r}));var a=n(6354),i=n(6009);n.d(t,"resourcesSelectors",(function(){return i})),t.default=a.reducer},6025:function(e,t,n){"use strict";var o;function r(e){return{type:o.FETCH_RESOURCE_PERMISSIONS_REQUEST,payload:e}}function a(e){return{type:o.FETCH_RESOURCE_PERMISSIONS_FULFILLED,payload:e}}function i(e){return{type:o.FETCH_RESOURCE_PERMISSIONS_REJECTED,payload:e}}function s(e){return{type:o.MODIFY_RESOURCE_PERMISSIONS_REQUEST,payload:e}}function l(e){return{type:o.MODIFY_RESOURCE_PERMISSIONS_FULFILLED,payload:e}}function c(e){return{type:o.MODIFY_RESOURCE_PERMISSIONS_REJECTED,payload:e}}function p(){return{type:o.MODIFY_RESOURCE_PERMISSIONS_CLEAR}}n.r(t),n.d(t,"ResourcesActionTypes",(function(){return o})),n.d(t,"fetchResourcePermissionsRequest",(function(){return r})),n.d(t,"fetchResourcePermissionsFulfilled",(function(){return a})),n.d(t,"fetchResourcePermissionsRejected",(function(){return i})),n.d(t,"modifyResourcePermissionsRequest",(function(){return s})),n.d(t,"modifyResourcePermissionsFulfilled",(function(){return l})),n.d(t,"modifyResourcePermissionsRejected",(function(){return c})),n.d(t,"modifyResourcePermissionsClear",(function(){return p})),function(e){e.FETCH_RESOURCE_PERMISSIONS_REQUEST="maker/resources/FETCH_RESOURCE_PERMISSIONS",e.FETCH_RESOURCE_PERMISSIONS_FULFILLED="maker/resources/FETCH_RESOURCE_PERMISSIONS_FULFILLED",e.FETCH_RESOURCE_PERMISSIONS_REJECTED="maker/resources/FETCH_RESOURCE_PERMISSIONS_REJECTED",e.MODIFY_RESOURCE_PERMISSIONS_REQUEST="maker/resources/MODIFY_RESOURCE_PERMISSIONS_REQUEST",e.MODIFY_RESOURCE_PERMISSIONS_FULFILLED="maker/resources/MODIFY_RESOURCE_PERMISSIONS_FULFILLED",e.MODIFY_RESOURCE_PERMISSIONS_REJECTED="maker/resources/MODIFY_RESOURCE_PERMISSIONS_REJECTED",e.MODIFY_RESOURCE_PERMISSIONS_CLEAR="maker/resources/MODIFY_RESOURCE_PERMISSIONS_CLEAR"}(o||(o={}))},6026:function(e,t,n){"use strict";n.r(t);var o=n(6027);n.d(t,"PermissionsClientRootSaga",(function(){return o.PermissionsClientRootSaga}));var r=n(6028);n.d(t,"PermissionsClientSaga",(function(){return r.default}))},6027:function(e,t,n){"use strict";n.r(t),n.d(t,"PermissionsClientRootSaga",(function(){return a}));var o=n(5749),r=n(6026);function*a(){yield Object(o.all)([Object(o.fork)(r.PermissionsClientSaga)])}},6028:function(e,t,n){"use strict";n.r(t),n.d(t,"fetchResourcePermissions",(function(){return E})),n.d(t,"modifyResourcePermissions",(function(){return T}));var o=n(2812),r=n(5749),a=n(6024),i=n(5606),s=n(5596),l=n(5760),c=n(2889),p=n(5597),u=n(5470),d=n(5483),m=n(6022),b=n(6025),g=n(5768),y=n(6029),S=n(2871),f=n(5593),h=n(5669),O=n(5604);function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(Object(n),!0).forEach((function(t){P(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function P(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function*E(e){var t=e.payload.resourceName,n=e.payload.resourceType,o=e.payload.isAdminScope,c=yield Object(r.select)(a.resourcesSelectors.resourcePermissionsCacheComplete,t),m=u.CachedStatusType.None;c&&(m=u.CachedStatusType.Done);var y=i.SagaContextProps.getCurrentEnvironment(),S=Object(s.getAppParameters)(y).$filter,f=i.SagaContextProps.getAadUser(),h=f&&f.objectId,C={url:Object(d.getQueryUrl)(Object(p.getResourcePermissionsUrlBasedOnType)(n,t,Object(O.getNameFromCurrentEnvironment)(y),o),o?null:S,h)},v=yield Object(r.call)(l.default,e,C,m);if(!v)return null;Object(g.hasResponseError)(v)?yield Object(r.put)(Object(b.fetchResourcePermissionsRejected)({error:Object(g.getResponseErrorMessage)(v)})):yield Object(r.put)(Object(b.fetchResourcePermissionsFulfilled)({resourceName:t,resourcePermissions:v.data.value}))}function*T(e){var t,n=i.SagaContextProps.getCurrentEnvironment(),a=Object(O.getNameFromCurrentEnvironment)(n),u=Object(s.getAppParameters)(n).$filter,C=e.payload.resourceName,P=e.payload.resourceType,E=e.payload.requestData,T=e.payload.isAdminScope,j="";switch(P){case c.ResourceType.App:j=T?Object(p.modifyResourcePermissionsAdminScopeUrl)("".concat(Object(p.getAdminScopeAppUri)(a,C))):Object(d.getQueryUrl)(Object(p.modifyResourcePermissionsUrl)(p.appUrl,C),u,null);break;case c.ResourceType.Connection:j=T?Object(p.modifyResourcePermissionsAdminScopeUrl)("".concat(Object(p.getAdminScopeConnectionsUri)(a,C))):Object(d.getQueryUrl)(Object(p.modifyResourcePermissionsUrl)(p.connectionsQueryUrl,C),u,null);break;case c.ResourceType.Gateway:j=T?Object(p.modifyResourcePermissionsAdminScopeUrl)("".concat(Object(p.getAdminScopeGatewaysUri)(a,C))):Object(d.getQueryUrl)(Object(p.modifyResourcePermissionsUrl)(p.gatewaysQueryUrl,C),u,null)}var A={resourceName:C,resourceType:P,currentEnvironment:a,permissionsAddedorModified:o.get(E,"put")&&o.get(E,"put").length,permissionsDeleted:E&&o.get(E,"delete")&&o.get(E,"delete").length,rolesAdded:e.payload.cdsRoleAssignments&&e.payload.cdsRoleAssignments.size},R=Object(f.trackLoadScenario)("Share/ModifyPermissions",A);if(e.payload.isComponentLibrary&&(E.put=E.put.map(e=>("CanView"==e.properties.roleName&&(e.properties.roleName="CanViewWithComponentImport"),e))),E){var I={url:j,method:"POST",data:JSON.stringify(E),headers:{"Content-Type":"application/json"}};if(!(t=yield Object(r.call)(l.default,e,I)))return Object(f.trackScenarioFailure)("Share/ModifyPermissions",v(v({},A),{},{error:h.CommonErrors.noResponse}),R),null;if(Object(g.hasResponseError)(t))return yield Object(r.put)(Object(b.modifyResourcePermissionsRejected)({error:Object(g.getResponseErrorMessage)(t)})),void Object(f.trackScenarioFailure)("Share/ModifyPermissions",v(v({},A),{},{error:Object(g.getResponseError)(t)}),R)}if(S.featureGates.showCDSSecurityRolesForShare){var w=e.payload.cdsRoleAssignments;w&&!w.isEmpty()?yield Object(y.submitUserRoleAssignment)(w):yield Object(r.put)(Object(m.submitRoleAssignmentFinished)({}))}e.payload.refreshShareData&&(yield Object(r.put)(Object(m.fetchSharePanelData)({resourceName:C,resourceType:P,hasCdsConnection:!1,isAdminScope:T,forceRefresh:!0})),yield Object(r.take)(m.ShareActionTypes.FETCH_SHARE_PANEL_DATA_FINISHED));var D=t&&t.data;D||(D={}),yield Object(r.put)(Object(b.modifyResourcePermissionsFulfilled)({responseData:D})),Object(f.trackScenarioComplete)("Share/ModifyPermissions",v({},A),R)}t.default=function*(){yield Object(r.takeEvery)(b.ResourcesActionTypes.FETCH_RESOURCE_PERMISSIONS_REQUEST,E),yield Object(r.takeEvery)(b.ResourcesActionTypes.MODIFY_RESOURCE_PERMISSIONS_REQUEST,T)}},6029:function(e,t,n){"use strict";n.r(t),n.d(t,"fetchUserCDSRoles",(function(){return _})),n.d(t,"batchFetchCDSRoles",(function(){return U})),n.d(t,"submitUserRoleAssignment",(function(){return H}));var o=n(2812),r=n(5749),a=n(2867),i=n(6030),s=n(2830),l=n(252),c=n(1144),p=n(5606),u=n(5604),d=n(5637),m=n(2868),b=n(2869),g=n(2871),y=n(5474),S=n(6352),f=n(5626),h=n(6025),O=n(6028),C=n(6009),v=n(6022),P=n(6010),E=n(5597),T=n(5760),j=n(5593),A=n(5669),R=n(5768),I=n(5470);function w(e,t,n,o,r,a,i){try{var s=e[a](i),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(o,r)}function D(e){return function(){var t=this,n=arguments;return new Promise((function(o,r){var a=e.apply(t,n);function i(e){w(a,o,r,i,s,"next",e)}function s(e){w(a,o,r,i,s,"throw",e)}i(void 0)}))}}function N(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function L(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?N(Object(n),!0).forEach((function(t){M(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):N(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function M(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function*x(e){var t=e.payload.resourceName,n=e.payload.resourceType,o=e.payload.isAdminScope,a=p.SagaContextProps.getAadUser(),i=a&&a.tenantId;yield Object(r.fork)(F,e.payload.hasCdsConnection);var[s,l]=yield Object(r.all)([Object(r.call)(k,t,n,a,o),Object(r.call)(S.fetchTenantDetails,Object(y.fetchGraphTenantDetail)({tenantId:i}))]),c=yield Object(r.select)(f.graphTenantDetailsErrorSelector,i),u=s||c;yield Object(r.put)(Object(v.fetchSharePanelDataFinished)({error:u,resourceName:t}))}function*k(e,t,n,a){var i=Object(b.getResources)();yield Object(O.fetchResourcePermissions)(Object(h.fetchResourcePermissionsRequest)({resourceName:e,resourceType:t,isAdminScope:a,forceRefresh:!0}));var s=yield Object(r.select)(C.resourcePermissionsSelector,e),l=function(e,t){if(!e)return null;var n=B(e.filter(e=>!Object(d.isPermissionForTenant)(e)));Object(o.some)(n,{id:t.objectId})&&n.push(t.objectId);return n.filter(e=>e)}(s,n);if(!l)return i.Share.Panel.loadFail;yield Object(r.call)(S.GetTenantsDirectoryObjects,Object(y.fetchGraphTenantsDirectoryObjects)({objectIds:l}));var c=yield Object(r.select)(f.groupOfDirectoryObjectsSelectorError,B(s));return yield Object(r.select)(C.resourcePermissionsError)||(c&&c.find(e=>void 0!==e)?i.Share.Panel.loadFail:"")}function*F(e){var t=p.SagaContextProps.getCurrentEnvironment();if(g.featureGates.showCDSSecurityRolesForShare&&Object(u.environmentHasCds2Database)(t)&&e){var n=Object(j.trackLoadScenario)(A.SagaScenarioNames.fetchRolesSaga);try{var o=yield m.MetadataClientInstance.getInstance(),a=yield q();Object(j.trackScenarioProgress)(A.SagaScenarioNames.fetchRolesSaga,{businessUnit:a},n);var s=yield o.fetchListView("Role",i.StdViews.List,void 0,{columns:["roleid","name","_roletemplateid_value"],filter:"_businessunitid_value eq "+a},{scenarioName:m.MCLTelemetryEventsMap.PAPortalPrefix}),l=[];s&&s.data&&(l=s.data.map(e=>({name:e.name,roleid:e.roleid,_roletemplateid_value:e._roletemplateid_value}))),Object(j.trackScenarioComplete)(A.SagaScenarioNames.fetchRolesSaga,{},n),yield Object(r.put)(Object(v.fetchCDSRolesFinished)({cdsDefaultRoles:l}))}catch(c){Object(j.trackScenarioFailure)(A.SagaScenarioNames.fetchRolesSaga,{error:c.message},n),yield Object(r.put)(Object(v.fetchCDSRolesFinished)({cdsDefaultRoles:[],error:c.message}))}}}function*_(e){var t,n=e.payload.objectId,o=e.payload.isGroup,a=e.payload.scenarioName,i=null;e.payload.shouldSendTelemetryEvent&&(t={objectId:n,isGroup:o},i=Object(j.trackLoadScenario)(a,t));var s=p.SagaContextProps.getCurrentEnvironment();try{if(!Object(u.environmentHasCds2Database)(s))throw new Error("Not a CDS account");var l=yield Object(r.call)(U,[n],o);if(!l)throw new Error("There was a problem loading CDS Role");var c=l[n];yield Object(r.put)(Object(v.fetchCDSRoleForUserFinished)({objectId:n,userRole:c})),i&&Object(j.trackScenarioComplete)(a,L(L({},t),{},{rolesCount:c.roles.length}),i)}catch(m){var d=Object(R.getResponseErrorMessage)(m);yield Object(r.put)(Object(v.fetchCDSRoleForUserFinished)({objectId:n,userRole:null,error:d})),i&&Object(j.trackScenarioFailure)(a,L(L({},t),{},{error:d}),i)}}function*U(e,t){if(Object(o.isEmpty)(e))return{};var n,r=yield m.MetadataClientInstance.getInstance(),a=yield q();if(!a)throw new Error("Could not get business unit");if(!(n=t?yield r.fetchTeamRoles(e,a,{scenarioName:m.MCLTelemetryEventsMap.PAPortalPrefix}):yield r.fetchUserRoles(e,a,{scenarioName:m.MCLTelemetryEventsMap.PAPortalPrefix})))throw new Error("There was a problem loading CDS Role");return Object(o.reduce)(e,(e,o)=>{var r=n[o];return e[o]=r?L(L({},r),{},{aadId:o,isGroup:t}):{id:void 0,aadId:o,roles:[],isGroup:t},e},{})}function*V(e){var t=p.SagaContextProps.getCurrentEnvironment().name,n=Object(E.getCDSAddUserUrl)(t),o=e.keySeq().toArray();try{var a=(yield Object(r.all)(o.map(e=>{return Object(r.call)(T.requestSaga,Object(v.addNewCdsUser)({}),(t=e,{url:n,method:"POST",data:JSON.stringify({objectId:t}),headers:{"Content-Type":"application/json"}}));var t}))).filter(e=>e.request&&(e.request.status<200||e.request.status>299));if(a.length)throw Error("Failed to create the following users"+a.map(e=>e.config.payload.body));return yield Object(r.all)(o.map(e=>Object(r.call)(_,Object(v.fetchCDSRoleforUser)({objectId:e,isGroup:!1})))),(yield Object(r.select)(P.multipleUserCDSRolesSelector,o)).reduce((e,t)=>(e[t.aadId]=t.id,e),{})}catch(i){throw Error(i)}}function B(e){return e&&e.map(d.getPrincipalId)}function*H(e){var t=Object(j.trackLoadScenario)(A.SagaScenarioNames.submitUserRoleAssignment),n=yield q(),i=function(e){return Object(a.Map)(e.filter((e,t)=>void 0===e.id&&!!e.isGroup))}(e),s=function(e){return Object(a.Map)(e.filter((e,t)=>void 0===e.id&&!e.isGroup))}(e);Object(j.trackScenarioProgress)(A.SagaScenarioNames.submitUserRoleAssignment,{businessUnit:n,groupsMissingSystemId:i,userMissingSystemId:s},t);var l=i.keySeq().toArray().concat(s.keySeq().toArray()),c=yield Object(r.select)(f.allGraphDirectoryObjectsSelector),p=function(e,t){return t.filter(t=>!e.has(t))}(c,l);yield Object(r.call)(S.GetTenantsDirectoryObjects,Object(y.fetchGraphTenantsDirectoryObjects)({objectIds:p})),c=yield Object(r.select)(f.allGraphDirectoryObjectsSelector);try{e=G(e,yield function*(e,t,n){if(Object(o.isEmpty)(e))return{};var a=yield m.MetadataClientInstance.getInstance(),i=yield Object(r.all)(e.map(e=>Object(r.call)(Q,e))),s=yield Object(r.all)(e.map((e,o)=>{var s=t.get(e),l=s.displayName,c=s.description;return Object(r.call)(W,a,e,c,l,n,i[o])}));return Object(o.reduce)(s,(e,t)=>(e[t.aadId]=t.systemId,e),{})}(i.keySeq().toArray(),c,n)),e=G(e,yield V(s)),yield function(e){return z.apply(this,arguments)}(e),Object(j.trackScenarioComplete)(A.SagaScenarioNames.submitUserRoleAssignment,{},t),yield Object(r.put)(Object(v.submitRoleAssignmentFinished)({}))}catch(u){Object(j.trackScenarioFailure)(A.SagaScenarioNames.submitUserRoleAssignment,{error:u.message||u.toString()},t),yield Object(r.put)(Object(v.submitRoleAssignmentFinished)({error:u.message||u.toString()}))}}function G(e,t){return e.withMutations(e=>{Object(o.forEach)(t,(t,n)=>{if(!e.has(n))throw new Error("Could not find aadId: ".concat(n," in roleAssignments"));var o=e.get(n);o.id=t,e.set(n,o)})})}function*W(e,t,n,o,r,a){try{return{aadId:t,systemId:(yield e.executeAction("Team","Create",void 0,{teamtype:a,description:n,_businessunitid_value:r,name:o,azureactivedirectoryobjectid:t})).teamid}}catch(i){throw console.debug("Error creating a team",i),i}}function*q(e){var t=yield Object(r.select)(P.businessUnitSelector);if(void 0===t)try{var n=yield m.MetadataClientInstance.getInstance();t=(yield n.fetchView("BusinessUnit","RootBusinessUnit",void 0)).businessunitid,yield Object(r.put)(Object(v.fetchRootBusinessUnitFinished)({businessUnitId:t,error:void 0}))}catch(o){t=void 0,yield Object(r.put)(Object(v.fetchRootBusinessUnitFinished)({businessUnitId:t,error:o.message||o.toString()}))}return t}function z(){return(z=D((function*(e){var t=e.filter(e=>void 0!==e.id).map(e=>({type:e.isGroup?i.TeamUserEnum.Team:i.TeamUserEnum.User,id:e.id,roleIds:e.roles.map(e=>e.roleid)})).toArray(),n=yield Object(c.tryGetServiceEndpointByRegion)("cds-org",Object(l.getSettings)().region),o="https://".concat(n.replace(/\/$/,""));return(yield m.MetadataClientInstance.getInstance()).setTeamAndUserRoles(t,o)}))).apply(this,arguments)}function*Q(e){var t={url:Object(E.getMsGraphGroupUrl)(e)},n=yield Object(r.call)(T.requestSaga,{type:"GetGroups",payload:{authOptions:{shouldAddAuthHeader:!0,endpointUrl:""}}},t,I.CachedStatusType.None),o=n&&n.data&&n.data.groupTypes;return o&&o.length>0&&"Unified"===o[0]?s.TeamTypeEnum.AADOfficeGroup:s.TeamTypeEnum.AADSecurityGroup}t.default=function*(){yield Object(r.takeEvery)(v.ShareActionTypes.FETCH_SHARE_PANEL_DATA,x),yield Object(r.takeEvery)(v.ShareActionTypes.FETCH_USER_CDS_ROLE,_),yield Object(r.takeEvery)(v.ShareActionTypes.FETCH_ROOT_BUSINSESS_UNIT,q)}},6352:function(e,t,n){"use strict";n.r(t),n.d(t,"GetTenantsDirectoryObjects",(function(){return y})),n.d(t,"GetTenantThumbnailPhoto",(function(){return S})),n.d(t,"GetTenantDomains",(function(){return f})),n.d(t,"GetUsersByEmailAddressOrDisplayNameMatch",(function(){return h})),n.d(t,"GetGroupsByEmailAddressOrDisplayNameMatch",(function(){return O})),n.d(t,"fetchTenantDetails",(function(){return C}));var o=n(2812),r=n(5749),a=n(5468),i=n(6015),s=n(5760),l=n(5597),c=n(2869),p=n(5768),u=n(5470),d=n(6353),m=n(5474),b=n(2872),g=n(5606);function*y(e){var t=[],n=yield Object(r.select)(a.sharedSelectors.allGraphDirectoryObjectsSelector);for(var d of e.payload.objectIds)n.get(d)||t.push(d);var y=u.CachedStatusType.Done;t.length&&(y=u.CachedStatusType.None);for(var S=g.SagaContextProps.getAadUser(),f=Object(l.getGraphUriFromTemplate)(Object(l.graphBaseUri)(S.tenantId,b.settings.graphEndpoint),"".concat(l.GraphUriConstants.objectsByObjectIds),b.settings.graphApiVersion),h=o.chunk(t,999),O=yield Object(r.all)(h.map(t=>{var n={objectIds:t,types:[i.GraphConstants.DirectoryObjectTypes.group,i.GraphConstants.DirectoryObjectTypes.user]},o={url:f,method:"POST",data:JSON.stringify(n),headers:{"Content-Type":"application/json"}};return Object(r.call)(s.requestSaga,e,o,y)})),C=[],v=[],P=0;P<O.length;P++){var E=O[P];if(!E||Object(p.hasResponseError)(E)){var T=E?Object(p.getResponseErrorMessage)(E):Object(c.getResources)().Graph.FetchDirectorObjects.NoResponse;yield Object(r.put)(Object(m.fetchGraphTenantsDirectoryObjectsRejected)({objectIds:h[P],error:T}))}else v=v.concat(E.data.value),C=C.concat(h[P])}C.length>0&&(yield Object(r.put)(Object(m.fetchGraphTenantsDirectoryObjectsFulFilled)({objectIds:C,directoryObjects:v})))}function*S(e){var t=g.SagaContextProps.getAadUser(),n=e.payload.objectId,o={url:Object(l.getGraphUriFromTemplate)(Object(l.graphThumbnailPhotoTemplateUri)(t.tenantId,b.settings.graphEndpoint),n,b.settings.graphApiVersion),responseType:"arraybuffer"},i=u.CachedStatusType.None;(yield Object(r.select)(a.sharedSelectors.graphAadTenantThumbnailPhotoUriSelector,n))&&(i=u.CachedStatusType.Done);var c=yield Object(r.call)(s.requestSaga,e,o,i);if(!c)return null;Object(p.hasResponseError)(c)?yield Object(r.put)(Object(m.fetchGraphTenantThumbnailPhotoRejected)({objectId:n,error:Object(p.getResponseErrorMessage)(c)})):yield Object(r.put)(Object(m.fetchGraphTenantThumbnailPhotoFulFilled)({objectId:n,aadTenantThumbnailPhotoBuffer:c.data}))}function*f(e){var t=g.SagaContextProps.getAadUser(),n={url:Object(l.getGraphUriFromTemplate)(Object(l.graphBaseUri)(t.tenantId,b.settings.graphEndpoint),"".concat(l.GraphUriConstants.domains),b.settings.graphApiBetaVersion)},o=u.CachedStatusType.None,i=yield Object(r.select)(a.sharedSelectors.graphAadTenantDomainsSelector);i&&i.length&&(o=u.CachedStatusType.Done);var c=yield Object(r.call)(s.requestSaga,e,n,o);if(!c)return null;Object(p.hasResponseError)(c)?yield Object(r.put)(Object(m.fetchGraphTenantDomainsRejected)({error:Object(p.getResponseErrorMessage)(c)})):yield Object(r.put)(Object(m.fetchGraphTenantDomainsFulFilled)({graphAadTenantDomains:c.data.value}))}function*h(e){var t=e.payload.emailAddressOrDisplayName,n=e.payload.isCompleteString?Object(l.getGraphQueryByUserPrincipalAndDisplayNameCompleteMatch)(t):Object(l.getGraphQueryByUserPrincipalAndDisplayName)(t),o=g.SagaContextProps.getAadUser(),i={url:Object(l.getGraphUriFromTemplate)(Object(l.graphBaseUri)(o.tenantId,b.settings.graphEndpoint),"".concat(l.GraphUriConstants.users,"?$filter=").concat(encodeURIComponent(n)),b.settings.graphApiVersion)},c=u.CachedStatusType.None,d=yield Object(r.select)(a.sharedSelectors.graphAadUsersSelector,t);d&&d.length&&(c=u.CachedStatusType.Done);var y=yield Object(r.call)(s.requestSaga,e,i,c);if(!y)return null;Object(p.hasResponseError)(y)?yield Object(r.put)(Object(m.fetchGraphUsersByEmailAddressOrDisplayNameMatchRejected)({emailAddressOrDisplayName:t,error:Object(p.getResponseErrorMessage)(y)})):yield Object(r.put)(Object(m.fetchGraphUsersByEmailAddressOrDisplayNameMatchFulfilled)({emailAddressOrDisplayName:t,users:y.data.value}))}function*O(e){var t=e.payload.displayName,n=e.payload.isCompleteString?Object(l.getGraphQueryByGroupDisplayNameCompleteMatch)(t):Object(l.getGraphQueryByGroupDisplayName)(t),o=g.SagaContextProps.getAadUser(),i={url:Object(l.getGraphUriFromTemplate)(Object(l.graphBaseUri)(o.tenantId,b.settings.graphEndpoint),"".concat(l.GraphUriConstants.groups,"?$filter=").concat(encodeURIComponent(n)),b.settings.graphApiVersion)},c=u.CachedStatusType.None,d=yield Object(r.select)(a.sharedSelectors.graphAadGroupsSelector,t);d&&d.length&&(c=u.CachedStatusType.Done);var y=yield Object(r.call)(s.requestSaga,e,i,c);if(!y)return null;Object(p.hasResponseError)(y)?yield Object(r.put)(Object(m.fetchGraphGroupsByEmailAddressOrDisplayNameMatchRejected)({displayName:t,error:Object(p.getResponseErrorMessage)(y)})):yield Object(r.put)(Object(m.fetchGraphGroupsByEmailAddressOrDisplayNameMatchFulfilled)({displayName:t,groups:y.data.value}))}function*C(e){var t=e.payload.tenantId,n=g.SagaContextProps.getAadUser(),o={url:Object(l.getGraphUriFromTemplate)(Object(l.graphBaseUri)(n.tenantId,b.settings.graphEndpoint),"".concat(l.GraphUriConstants.tenantDetail,"/").concat(t),b.settings.graphApiVersion)},i=u.CachedStatusType.None;(yield Object(r.select)(a.sharedSelectors.graphTenantDetailsCacheCompleteSelector,t))&&(i=u.CachedStatusType.Done);var c=yield Object(r.call)(s.requestSaga,e,o,i);if(!c)return null;Object(p.hasResponseError)(c)?yield Object(r.put)(Object(m.fetchGraphTenantDetailRejected)({tenantId:t,error:Object(p.getResponseErrorMessage)(c)})):yield Object(r.put)(Object(m.fetchGraphTenantDetailFulfilled)({tenantId:t,data:c.data}))}t.default=function*(){yield Object(d.takeLeading)(m.SharedActionTypes.FETCH_GRAPH_TENANTS_DIRECTORY_OBJECTS,y),yield Object(r.takeEvery)(m.SharedActionTypes.FETCH_GRAPH_TENANT_THUMBNAIL_PHOTO,S),yield Object(d.takeLeading)(m.SharedActionTypes.FETCH_GRAPH_TENANT_DETAIL,C),yield Object(r.takeLatest)(m.SharedActionTypes.FETCH_GRAPH_TENANT_DOMAINS,f),yield Object(r.takeEvery)(m.SharedActionTypes.FETCH_GRAPH_USERS_BY_EMAIL_ADDRESS_OR_DISPLAY_NAME_MATCH,h),yield Object(r.takeEvery)(m.SharedActionTypes.FETCH_GRAPH_GROUPS_BY_EMAIL_ADDRESS_OR_DISPLAY_NAME_MATCH,O)}},6353:function(e,t,n){"use strict";n.r(t),n.d(t,"takeLeading",(function(){return r}));var o=n(5749),r=(e,t)=>Object(o.fork)((function*(){for(;;){var n=yield Object(o.take)(e);yield Object(o.call)(t,n)}}))},6354:function(e,t,n){"use strict";n.r(t),n.d(t,"defaultState",(function(){return c})),n.d(t,"reducer",(function(){return p}));var o=n(2867),r=n(2812),a=n(6025);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var c={resourcePermissions:Object(o.Map)(),resourcePermissionsError:"",isResourcePermissionsLoading:!1,modifyPermissionsResponse:null,modifyPermissionsInProgress:!1,modifyPermissionsError:""};function p(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case a.ResourcesActionTypes.FETCH_RESOURCE_PERMISSIONS_REQUEST:return Object(r.assign)({},e,{isResourcePermissionsLoading:!0});case a.ResourcesActionTypes.FETCH_RESOURCE_PERMISSIONS_REJECTED:return Object(r.assign)({},e,s(s({},e),{},{resourcePermissionsError:t.payload.error,isResourcePermissionsLoading:!1}));case a.ResourcesActionTypes.FETCH_RESOURCE_PERMISSIONS_FULFILLED:var n=e.resourcePermissions;return n=n.set(t.payload.resourceName,t.payload.resourcePermissions),Object(r.assign)({},e,s(s({},e),{},{resourcePermissions:n,resourcePermissionsError:"",isResourcePermissionsLoading:!1}));case a.ResourcesActionTypes.MODIFY_RESOURCE_PERMISSIONS_REQUEST:return s(s({},e),{},{modifyPermissionsResponse:null,modifyPermissionsInProgress:!0,modifyPermissionsError:""});case a.ResourcesActionTypes.MODIFY_RESOURCE_PERMISSIONS_FULFILLED:return s(s({},e),{},{modifyPermissionsResponse:t.payload.responseData,modifyPermissionsInProgress:!1,modifyPermissionsError:""});case a.ResourcesActionTypes.MODIFY_RESOURCE_PERMISSIONS_REJECTED:return s(s({},e),{},{modifyPermissionsResponse:null,modifyPermissionsInProgress:!1,modifyPermissionsError:t.payload.error});case a.ResourcesActionTypes.MODIFY_RESOURCE_PERMISSIONS_CLEAR:return s(s({},e),{},{modifyPermissionsResponse:null,modifyPermissionsInProgress:!1,modifyPermissionsError:""});default:return e}}},6355:function(e,t,n){"use strict";n.r(t);var o=n(6022);n.d(t,"shareActions",(function(){return o}));var r=n(6356);n.d(t,"shareMiddlewares",(function(){return r}));var a=n(6358),i=n(6010);n.d(t,"shareSelectors",(function(){return i})),t.default=a.reducer},6356:function(e,t,n){"use strict";n.r(t);var o=n(6357);n.d(t,"ShareClientRootSaga",(function(){return o.ShareClientRootSaga}));var r=n(6029);n.d(t,"ShareClientSaga",(function(){return r.default}))},6357:function(e,t,n){"use strict";n.r(t),n.d(t,"ShareClientRootSaga",(function(){return a}));var o=n(5749),r=n(6356);function*a(){yield Object(o.all)([Object(o.fork)(r.ShareClientSaga)])}},6358:function(e,t,n){"use strict";n.r(t),n.d(t,"defaultState",(function(){return p})),n.d(t,"reducer",(function(){return u}));var o=n(2867),r=n(2812),a=n(6022),i=n(5629);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var p={sharePanelDataError:"",isSharePanelDataLoading:!1,resourceLoadedName:"",cdsDefaultRoles:[],isCDSRoleLoading:!1,cdsUserRoles:Object(o.Map)(),currentUser:"",getUserCdsRoleError:"",businessUnit:void 0,businessUnitLoadError:void 0,cdsRoleSubmissionResult:{status:void 0,error:void 0}};function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case a.ShareActionTypes.FETCH_SHARE_PANEL_DATA:return Object(r.assign)({},e,{isSharePanelDataLoading:!0});case a.ShareActionTypes.FETCH_SHARE_PANEL_DATA_FINISHED:return Object(r.assign)({},e,l(l({},e),{},{sharePanelDataError:t.payload.error,resourceLoadedName:t.payload.resourceName,isSharePanelDataLoading:!1}));case a.ShareActionTypes.FETCH_USER_CDS_ROLE:return Object(r.assign)({},e,l(l({},e),{},{isCDSRoleLoading:!0,currentUser:t.payload.objectId,getUserCdsRoleError:""}));case a.ShareActionTypes.FETCH_USER_CDS_ROLE_FINISHED:var n=e.cdsUserRoles,o=t.payload.error;return r.isEmpty(o)&&(n=e.cdsUserRoles.set(t.payload.objectId,t.payload.userRole)),Object(r.assign)({},e,l(l({},e),{},{isCDSRoleLoading:!1,cdsUserRoles:n,getUserCdsRoleError:o}));case a.ShareActionTypes.FETCH_CDS_ROLES_FINISHED:return Object(r.assign)({},e,{cdsDefaultRoles:t.payload.cdsDefaultRoles,getUserCdsRoleError:t.payload.error});case a.ShareActionTypes.FETCH_ROOT_BUSINSESS_UNIT_FINISHED:return Object(r.assign)({},e,{businessUnit:t.payload.businessUnitId,businessUnitLoadError:t.payload.error});case a.ShareActionTypes.SUBMIT_ROLE_ASSIGNMENT:return Object(r.assign)({},e,{cdsRoleSubmissionResult:{status:i.ComponentLoadState.Loading}});case a.ShareActionTypes.SUBMIT_ROLE_ASSIGNMENT_FINISHED:return Object(r.assign)({},e,{cdsRoleSubmissionResult:{status:void 0===t.payload.error?i.ComponentLoadState.Complete:i.ComponentLoadState.Fail,error:t.payload.error}});case a.ShareActionTypes.SUBMIT_ROLE_ASSIGNMENT_RESULT_CLEAR:return Object(r.assign)({},e,{cdsRoleSubmissionResult:{status:void 0,error:void 0}});default:return e}}},6359:function(e,t,n){"use strict";n.r(t),n.d(t,"AppShareContext",(function(){return p})),n.d(t,"connectionsToList",(function(){return u}));var o=n(2867),r=n(5596),a=n(5623),i=n(2871),s=n(245),l=n.n(s),c=n(2869),p=l.a.createContext({dataSources:[],hasImplicitlySharedConnection:!1});function u(e){var t=Object(c.getResources)(),n=[],s=e&&e.properties.connectionReferences,l=Object(o.Map)(e&&e.properties.databaseReferences);if(!l.isEmpty()&&i.featureGates.showCDSNativeInShare){var p=[],u=!0;l.forEach(e=>{Object(o.Map)(e.dataSources).forEach(e=>{p.push(e.entitySetName)}),"default.cds"!==e.databaseDetails.environmentName&&(u=!1)}),u&&n.push({titles:p,subtitle:t.DataIntegration.CDM.DisplayName,titleMaxWidth:400,showTitlesToggle:!0,showTitlesLabel:t.Apps.ManageApp.Share.AppResources.ShowLabel,hideTitlesLabel:t.Apps.ManageApp.Share.AppResources.HideLabel,imageProps:{height:40,width:40,src:"https://connectoricons-prod.azureedge.net/releases/v1.0.1473/1.0.1473.2431/commondataserviceforapps/icon.png"},isCDS:!0,isImplicitlyShared:!1})}if(!s)return n;for(var d of Object.keys(s)){var m=s[d];if(Object(r.isConnectionSharePointType)(m)&&m.dataSets)for(var b of Object.keys(m.dataSets))for(var g of Object.keys(m.dataSets[b].dataSources)){var y=Object(a.getSharepointUrl)(b,g);y=y.replace(/([^:]\/)\/+/g,"$1"),n.push({titles:[g],titleLinkProps:{href:y,alt:y,target:"_blank"},titleMaxWidth:400,subtitle:t.Apps.ManageApp.Share.AppResources.SharePoint,showTitlesToggle:!1,showTitlesLabel:t.Apps.ManageApp.Share.AppResources.ShowLabel,hideTitlesLabel:t.Apps.ManageApp.Share.AppResources.HideLabel,imageProps:{height:40,width:40,src:m.iconUri},isCDS:!1,isImplicitlyShared:!1})}else{var S=[m.displayName],f="",h=!1,O=!1;m.sharedConnectionId&&(O=!0),Object(r.isConnectionCDSType)(m)&&m.dataSources&&(S=m.dataSources,f=m.displayName,h=!0),n.push({titles:S,subtitle:f,titleMaxWidth:400,showTitlesToggle:h,showTitlesLabel:t.Apps.ManageApp.Share.AppResources.ShowLabel,hideTitlesLabel:t.Apps.ManageApp.Share.AppResources.HideLabel,imageProps:{height:40,width:40,src:m.iconUri},isCDS:Object(r.isConnectionCDSType)(m),isImplicitlyShared:O})}}return n.sort((function(e,t){return e.isCDS?-1:t.isCDS?1:0})),n}},6360:function(e,t,n){"use strict";n.r(t),n.d(t,"CanvasAppPermissionSectionContainer",(function(){return p}));var o=n(245),r=n.n(o),a=n(2869),i=n(6361),s=n(2880),l=n(5481);function c(){return(c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}var p=e=>{var t=Object(a.getResources)(),n=Object(s.formatResourceStringAsLinks)(t.Apps.ManageApp.Share.AppResources.calloutText,[l.default.shareCDSforAppsLink,l.default.shareExcelLink,l.default.shareAppResourcesLink,l.default.shareLearnMoreLink]),o=t.Apps.ManageApp.Share.Panel.Permissions.Section.description,p=t.Apps.ManageApp.Share.UsersPermission.TenantAdditionalAnnotation,u=t.Apps.ManageApp.Share.UsersPermission.EveryonePermissionDescription,d=t.Apps.ManageApp.Share.UsersPermission.OneUserPermissionDescription,m=t.Apps.ManageApp.Share.UsersPermission.MultipleUserPermissionDescription,b=t.Apps.ManageApp.Share.CheckboxDescription;return r.a.createElement(i.AppPermissionsSectionContainer,c({},e,{appResourcesCallout:n,permissionsSectionDescription:o,tenantAdditionalAnnotation:p,everyonePermissionDescription:u,oneUserPermissionDescription:d,multipleUserPermissionDescription:m,checkboxDescription:b}))}},6361:function(e,t,n){"use strict";n.r(t),n.d(t,"AppPermissionsSectionContainer",(function(){return j}));var o=n(245),r=n.n(o),a=n(2812),i=n(5437),s=n(216),l=n(5604),c=n(5596),p=n(5478),u=n(6012),d=n(5629),m=n(5981),b=n(6022),g=n(6010),y=n(5468),S=n(5595),f=n(6362),h=n(6365),O=n(5602),C=n(5637),v=n(5669),P=n(6359),E=n(5487),T=Object(d.withLoadTelemetry)(f.AppPermissionsSection,v.LoadScenarioNames.AppPermissionsSection),j=e=>{var t,n,f,{userPermissions:v,isNewSecurityRoleAdded:j,appResourcesCallout:A,permissionsSectionDescription:R,tenantAdditionalAnnotation:I,everyonePermissionDescription:w,oneUserPermissionDescription:D,multipleUserPermissionDescription:N,checkboxDescription:L,onPermissionRoleUpdate:M,onSecurityRoleAdded:x,onSecurityRoleRemoved:k,isAdminScope:F}=e,_=Object(i.useDispatch)(),{rootProps:{currentEnvironment:U}}=Object(o.useContext)(E.RootPropsContext),{dataSources:V}=Object(o.useContext)(P.AppShareContext),{oid:B}=Object(o.useContext)(s.AuthenticatedUserInfoContext),H=e.resource.name,G=Object(i.useSelector)(e=>m.appsSelectors.appError(e,H)),W=Object(i.useSelector)(e=>null!==m.appsSelectors.appSelector(e,H)),q=Object(u.getAppIdBasedOnScope)(H,null==U?void 0:U.name,!!F),z=Object(i.useSelector)(e=>m.appsSelectors.appSelector(e,q)),Q=Object(i.useSelector)(g.shareCDSRolesSelector).sort((e,t)=>e.name.toLocaleLowerCase()>t.name.toLocaleLowerCase()?1:-1).filter(e=>!Object(h.isCurrentUserCDSAdmin)(e)||(t=e.roleid,!1)),K=Object(i.useSelector)(g.cdsRoleLoadingSelector),Y=Object(i.useSelector)(g.currentUserSelector),J=Object(i.useSelector)(e=>Object(g.userCDSRolesSelector)(e,Y)),X=Object(i.useSelector)(g.cdsRoleErrorSelector),Z=Object(i.useSelector)(e=>Object(g.userCDSRolesSelector)(e,B)),$=Z&&Z.roles&&!!a.find(Z.roles,{roleid:t}),ee=O.PrincipalType.User;a.isEmpty(e.userPermissions)||(ee=null!==(n=null===(f=a.first(e.userPermissions))||void 0===f?void 0:f.principalType)&&void 0!==n?n:O.PrincipalType.User);return r.a.createElement(T,{key:Y,dataSources:V,userPermissions:v||[],isNewSecurityRoleAdded:j,isAppSolutionAware:Object(c.isSolutionAware)(z),onPermissionRoleUpdate:M,onSecurityRoleAdded:x,onSecurityRoleRemoved:k,fetchCDSUserRole:()=>{return e=Y,t=Object(C.isGroupPermissionType)(ee),_(Object(b.fetchCDSRoleforUser)({objectId:e,isGroup:t,shouldSendTelemetryEvent:!0,scenarioName:"share/RefreshCDSRole"}));var e,t},isLoggedinUserCDSAdmin:$,isUserRoleLoading:K,cdsRoles:Q,userRole:J,logEvent:S.CanvasAppSharePermissionsSectionEvent,loadProgress:[Object(d.toLoadingState)(W,G)],appLoadingError:G,userRoleLoadingError:X,parentLoadingState:e.parentLoadingState,isUnderCDS2Environment:Object(l.environmentHasCds2Database)(U),onMount:()=>{_(m.appsActions.fetchAppRequest({appName:H,isAdminScope:F}))},onSetPermissionInstructionLinkPressed:()=>_(y.sharedActions.panelOpen({panelType:p.PanelToShowType.PermissionInstructionPanel,panelProps:{}})),dispatchTelemetry:_,currentEnvironment:U,appResourcesCallout:A,permissionsSectionDescription:R,tenantAdditionalAnnotation:I,everyonePermissionDescription:w,oneUserPermissionDescription:D,multipleUserPermissionDescription:N,checkboxDescription:L})}},6362:function(e,t,n){"use strict";n.r(t),n.d(t,"AppPermissionsSection",(function(){return T}));var o=n(4065),r=n(2812),a=n(790),i=n(1447),s=n(687),l=n(684),c=n(1452),p=n(1090),u=n(1201),d=n(245),m=n(5637),b=n(5629),g=n(2879),y=n(2869),S=n(2880),f=n(2871),h=n(6363),O=n(6364),C=n(5604),v=n(6365),P=n(860);function E(){return(E=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}class T extends d.Component{constructor(e){super(e),this.resources=void 0,this.calloutButtonElement=d.createRef(),this.getSecurityUsers=d.createRef(),this.securityRoleComboBox=d.createRef(),this.onToggleVisibilityClicked=()=>{this.setState({isCalloutVisible:!this.state.isCalloutVisible})},this.onCalloutDismiss=()=>{this.setState({isCalloutVisible:!1})},this.getCDSSecurityRoleDropDown=()=>{var e,t=Object(y.getResources)(),n=this.props.userRole&&this.props.userRole.aadId,o=[],a=[],s=this.props.isLoggedinUserCDSAdmin&&!Object(r.isEmpty)(this.props.cdsRoles)&&!this.props.isUserRoleLoading,l=[];if(s){var p=e=>e.map((e,t)=>{var o=this.props.userRole&&Object(r.some)(this.props.userRole.roles,{roleid:e.roleid}),a=this.props.isNewSecurityRoleAdded(n,e),i=t+e.roleid;return(o||a)&&l.push(i),{key:i,text:e.name,selected:o||a,disabled:o,styles:o?{root:{pointerEvents:"none"}}:{},data:{role:e}}});o=this.props.cdsRoles?p(this.props.cdsRoles.filter(e=>e._roletemplateid_value)):[],a=this.props.cdsRoles?p(this.props.cdsRoles.filter(e=>!e._roletemplateid_value)):[]}a.length>0&&(a=[{key:"HeaderSection1",text:t.Apps.ManageApp.Share.Panel.SecurityRoles.Dropdown.customRoles,itemType:c.SelectableOptionMenuItemType.Header},...a]);var u=(e=[{key:"Header",text:t.Apps.ManageApp.Share.Panel.SecurityRoles.Dropdown.openManageRoles,itemType:c.SelectableOptionMenuItemType.Header},{key:"divider",text:"-",itemType:c.SelectableOptionMenuItemType.Divider},{key:"SubHeader",text:t.Apps.ManageApp.Share.Panel.SecurityRoles.Dropdown.subheader,itemType:c.SelectableOptionMenuItemType.Header,styles:{optionText:O.appPermissionsSectionStyleClasses.cdsRolesSubheaderOptionText}},...a,{key:"HeaderSection2",text:t.Apps.ManageApp.Share.Panel.SecurityRoles.Dropdown.standardRoles,itemType:c.SelectableOptionMenuItemType.Header},...o]).reduce((e,t)=>e.set(t.key,t.text),new Map),b=l.map(e=>u.get(e)).join(", "),g=t.Apps.ManageApp.Share.Panel.SecurityRoles.Dropdown.placeholder;return d.createElement(i.ComboBox,{options:e,selectedKey:l,multiSelect:!0,placeholder:g,disabled:this.props.isUserRoleLoading||!this.props.isLoggedinUserCDSAdmin||1!==this.props.userPermissions.length||!!this.props.userRoleLoadingError||Object(m.isTenantPermissionType)(this.props.userPermissions[0].principalType)||!s,ariaLabel:g,className:"user-permission-section-cds-roles",onRenderOption:(e,t)=>this.onRenderSecurityRoleDropdownOption(e,t),onItemClick:(e,t)=>this.onSecurityRoleOptionClicked(t),styles:{header:O.appPermissionsSectionStyleClasses.cdsRolesHeaderCommon},onMenuOpen:this.onMenuOpen,componentRef:this.securityRoleComboBox,title:b.length>0?b:g})},this.onRenderSecurityRoleDropdownOption=(e,t)=>{var n;if(e){if("Header"===e.key)return d.createElement(p.Link,{className:O.appPermissionsSectionStyleClasses.cdsRolesHeader,href:Object(C.getSecurityUsersUrl)(this.props.currentEnvironment),target:"_blank",tabIndex:0,onBlur:this.onBlurSecurityUsersLink,componentRef:this.getSecurityUsers},null==t?void 0:t(e),d.createElement(s.Icon,{iconName:"OpenInNewWindow"}));if("SubHeader"===e.key)return d.createElement("div",{className:O.appPermissionsSectionStyleClasses.cdsRolesSubheader},null==t?void 0:t(e))}return null!==(n=null==t?void 0:t(e))&&void 0!==n?n:null},this.onMenuOpen=()=>{window.requestAnimationFrame(()=>{var e,t;null===(e=this.getSecurityUsers)||void 0===e||null===(t=e.current)||void 0===t||t.focus()})},this.onBlurSecurityUsersLink=e=>{var t,n;null===(t=this.securityRoleComboBox)||void 0===t||null===(n=t.current)||void 0===n||n.focus()},this.resources=Object(y.getResources)(),this.state={isCalloutVisible:!1}}componentDidMount(){this.props.onMount()}render(){var e,t=this.getDataSourcesList(),n=O.appPermissionsSectionStyleClasses["app-permissions-section"];return Object(b.isLoading)(this.props.loadProgress)&&!Object(b.isLoading)([this.props.parentLoadingState])?t=[d.createElement(u.Spinner,{size:u.SpinnerSize.large})]:this.props.appLoadingError&&(t=[d.createElement("span",null,this.resources.Apps.ManageApp.Share.AppResources.LoadingError)]),this.props.userPermissions&&this.props.userPermissions.length?e=d.createElement("div",{className:"users-permission-panel"},d.createElement("div",{className:"users-permission-section"},d.createElement("div",{className:"users-permission-header"},this.getUserPermissionSectionHeader()),d.createElement("div",{className:"checkbox-section"},d.createElement(h.CoauthorCheckboxContainer,{permissions:this.props.userPermissions,onPermissionRoleUpdate:this.props.onPermissionRoleUpdate,isResourceSolutionAware:this.props.isAppSolutionAware,checkboxDescription:this.props.checkboxDescription}))),d.createElement("hr",null),d.createElement("div",{className:"data-permission-section"},d.createElement("div",{className:"permissions-section-header"},d.createElement("h4",null,this.resources.Apps.ManageApp.Share.Panel.Permissions.Section.header,d.createElement("div",{className:"permissions-section-infoButton",ref:this.calloutButtonElement},d.createElement(l.IconButton,{onClick:this.onToggleVisibilityClicked,iconProps:{iconName:g.fabricIcons.Info},title:this.resources.Apps.ManageApp.Share.AppResources.calloutTooltip,ariaLabel:this.resources.Apps.ManageApp.Share.AppResources.calloutTooltip}))),d.createElement(a.FocusTrapCallout,{className:O.appPermissionsSectionStyleClasses["data-permission-callout"],role:"alertdialog",gapSpace:0,onDismiss:this.onCalloutDismiss,setInitialFocus:!0,target:this.calloutButtonElement.current,hidden:!this.state.isCalloutVisible,focusTrapProps:{isClickableOutsideFocusTrap:!0},ariaDescribedBy:"descriptionID"},d.createElement("p",{id:"descriptionID"},this.props.appResourcesCallout))),d.createElement("div",{className:"permissions-section-description"},this.props.permissionsSectionDescription),d.createElement("div",{className:"permissions-section-resources"},t))):(n+=" ".concat(O.appPermissionsSectionStyleClasses["app-permissions-centered"]),e=d.createElement("h4",{className:"users-permission-panel-no-users-selected"},this.resources.Apps.ManageApp.Share.UsersPermission.DefaultStateDescription)),d.createElement("div",{className:n},e)}getUserPermissionSectionHeader(){var e,t=this.props.userPermissions.length;if(this.props.userPermissions.some(e=>Object(m.isTenantPermissionType)(e.principalType))&&(e=d.createElement("div",{className:"tenant-annotation"},d.createElement(s.Icon,{iconName:g.fabricIcons.Error}),this.props.tenantAdditionalAnnotation)),1===t){var n=this.props.userPermissions[0],o=Object(m.isTenantPermissionType)(n.principalType);return d.createElement(d.Fragment,null,d.createElement("div",{className:"user-permission-section-title"},n.principalDisplayName),d.createElement("div",{className:"user-permission-section-subtitle"},d.createElement("div",{className:"user-permission-section-subtitle-text"},o?this.props.everyonePermissionDescription:this.props.oneUserPermissionDescription)),this.getGuestUserSubtitle(!!n.isGuestUser),e)}var a=Object(r.some)(this.props.userPermissions,e=>e.isGuestUser);return d.createElement(d.Fragment,null,d.createElement("div",{className:"user-permission-section-title"},Object(S.formatResourceString)(this.resources.Apps.ManageApp.Share.UsersPermission.MultipleUserPermissionTitle,t)),d.createElement("div",{className:"user-permission-section-subtitle"},d.createElement("div",{className:"user-permission-section-subtitle-text"},this.props.multipleUserPermissionDescription)),this.getGuestUserSubtitle(a),e)}getGuestUserSubtitle(e){return e?d.createElement("div",{className:"user-permission-section-subtitle"},d.createElement(s.Icon,{iconName:g.fabricIcons.Info}),d.createElement("div",{className:"user-permission-section-subtitle-text"},this.resources.Apps.ManageApp.Share.UsersPermission.coAuthorGuestInfo)):d.createElement(d.Fragment,null)}getDataSourcesList(){return this.props.dataSources&&this.props.dataSources.map((e,t)=>{if(e.isCDS&&this.props.isUnderCDS2Environment){e.rightContent=()=>d.createElement(p.Link,{onClick:()=>this.props.onSetPermissionInstructionLinkPressed(),className:"set-permsision-link"},this.resources.Apps.ManageApp.Share.PermissionInstructionLink,d.createElement(s.Icon,{iconName:g.fabricIcons.Forward}));var n=Object(v.isCRMVersionCompatibleForCDSShare)(Object(C.getCrmVersion)(this.props.currentEnvironment));if(f.featureGates.showCDSSecurityRolesForShare&&n){var r=this.getCDSSecurityRoleDropDown();e.rightContent=()=>d.createElement("div",{style:{display:"inline-block"}},r,this.getCDSSecurityRoleErrorPrompt())}}else e.isImplicitlyShared&&(e.rightContent=()=>d.createElement("span",null," ",this.resources.Apps.ManageApp.Share.AppResources.implicitlyShared," "));return Object(P.getResponsiveMode)(window)<=P.ResponsiveMode.large&&(e.isCDS&&this.props.isUnderCDS2Environment||e.isImplicitlyShared)?d.createElement(o.ExpandableResourceItem,E({styles:{root:{borderBottom:"1px solid",marginBottom:"20px"},sectionRight:{position:"relative",display:"inline-block"}},key:t},e)):d.createElement(o.ExpandableResourceItem,E({key:t},e))})}onSecurityRoleOptionClicked(e){if(e){var t=e.data;e.selected?this.props.onSecurityRoleRemoved(this.props.userRole.aadId,this.props.userRole.id,t.role):this.props.onSecurityRoleAdded(this.props.userRole.aadId,this.props.userRole.id,t.role)}}getCDSSecurityRoleErrorPrompt(){var e;return this.props.isLoggedinUserCDSAdmin?1!==this.props.userPermissions.length?e=d.createElement("span",null,this.resources.Apps.ManageApp.Share.Panel.SecurityRoles.multipleUserError):Object(m.isTenantPermissionType)(this.props.userPermissions[0].principalType)?e=d.createElement("span",null,this.resources.Apps.ManageApp.Share.Panel.SecurityRoles.tenantError):this.props.userRoleLoadingError&&(e=d.createElement("span",{className:"cdsroles-error-prompt"},Object(S.formatResourceStringToElement)(this.resources.Apps.ManageApp.Share.Panel.SecurityRoles.errorprompt,e=>d.createElement(p.Link,{onClick:()=>this.props.fetchCDSUserRole()},e)))):e=d.createElement("span",null,this.resources.Apps.ManageApp.Share.Panel.SecurityRoles.nonAdminError),d.createElement("div",{className:"cdsroles-generic-error"},e)}}},6363:function(e,t,n){"use strict";n.r(t),n.d(t,"mergeProps",(function(){return u})),n.d(t,"containTenantPermission",(function(){return d})),n.d(t,"containOwnerPermission",(function(){return m})),n.d(t,"containCurrentUserPermission",(function(){return b})),n.d(t,"containGroupPermission",(function(){return g})),n.d(t,"CoauthorCheckboxContainer",(function(){return y}));var o=n(4064),r=n(2812),a=n(5437),i=n(5602),s=n(5637),l=n(2869);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var u=(e,t,n)=>{var a=Object(l.getResources)(),u=function(e){var t=e.permissions||[];if(0===t.length)return{disabled:!0,checkState:o.MultistateCheckboxState.NotChecked};var n=d(t),a=1===t.length,i=m(t),l=g(t),c=b(t);if((n||i)&&a)return{disabled:!0,checkState:o.MultistateCheckboxState.NotChecked};var p,u=r.every(t,e=>Object(s.roleNameHasEditPermission)(e.roleName)),y=r.every(t,e=>!Object(s.roleNameHasEditPermission)(e.roleName)),S=r.some(t,e=>e.isGuestUser),f=e.isResourceSolutionAware&&l||n||i||c||S;p=u?o.MultistateCheckboxState.Checked:y?o.MultistateCheckboxState.NotChecked:o.MultistateCheckboxState.PartialChecked;return{disabled:f,checkState:p}}(n);return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){p(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({label:a.Apps.ManageApp.Share.CoOwner,description:n.checkboxDescription,onMultiStateChange:(e,t,r)=>{!function(e,t){if(d(e.permissions||[]))return;e.onPermissionRoleUpdate(t===o.MultistateCheckboxState.Checked?i.RoleName.CanEdit:i.RoleName.CanView)}(n,r)}},u)};function d(e){return(e||[]).some(e=>Object(s.isTenantPermissionType)(e.principalType))}function m(e){return(e||[]).some(e=>Object(s.isRoleNameForOwner)(e.roleName))}function b(e){return(e||[]).some(e=>e.isPermissionForCurrentUser)}function g(e){return(e||[]).some(e=>Object(s.isGroupPermissionType)(e.principalType))}var y=Object(a.connect)(null,null,u)(o.MultistateCheckbox)},6364:function(e,t,n){"use strict";n.r(t),n.d(t,"appPermissionsSectionStyleClasses",(function(){return i}));var o=n(719),r=n(2882),a=n(5492),i=Object(o.mergeStyleSets)({"app-permissions-centered":{width:"100%",display:"flex",justifyContent:"center",flexDirection:"column",textAlign:"center"},"app-permissions-section":{selectors:{".user-permission-section-title":{fontSize:"17px",marginBottom:"4px"},".users-permission-header":{marginBottom:"16px",selectors:{".user-permission-section-subtitle":{marginBottom:"4px",selectors:{".user-permission-section-subtitle-text":{fontSize:a.fontSizes.listFontSizeMedium,lineHeight:"20px",display:"inline-block"},i:{fontSize:a.fontSizes.listFontSizeMedium,marginRight:"5px",verticalAlign:"top",display:"inline-block",textAlign:"center"}}},".tenant-annotation":{fontSize:a.fontSizes.listFontSizeSmall,display:"flex",marginTop:"6px",selectors:{i:{marginRight:"4px"}}}}},".permissions-section-header":{marginBottom:"8px"},".permissions-section-description":{marginBottom:"24px"},".permissions-section-infoButton":{verticalAlign:"top",display:"inline-block",textAlign:"center",selectors:{button:{marginTop:"-5px"}}},".permissions-section-resource .ba-ExpandableResourceItem":{display:"flex"},".checkbox-section":{selectors:{label:{fontWeight:400},".checkbox-description":{marginLeft:"26px"}}},".set-permsision-link i":{fontSize:"10px",marginLeft:"8px"},hr:{marginTop:"16px",marginBottom:"16px"},".ba-ExpandableResourceItem-value":{marginTop:"-10px"},".cdsroles-error-prompt":{color:r.fabricColors.brightRed},".cdsroles-generic-error":{marginTop:"8px",fontSize:a.fontSizes.listFontSizeSmall}}},"data-permission-callout":{width:"300px",fontSize:a.fontSizes.listFontSizeSmall,selectors:{p:{padding:"10px 10px 0px 10px"}}},cdsRolesHeader:{color:r.fabricColors.plum,display:"flex",alignItems:"center",fontSize:a.fontSizes.listFontSizeMedium,lineHeight:"20px",height:"100%",selectors:{"& i":{marginLeft:"4px",lineHeight:"18px"}}},cdsRolesSubheader:{color:r.fabricColors.neutralChicago,fontSize:a.fontSizes.listFontSizeSmall,lineHeight:"16px",maxWidth:"252px"},cdsRolesHeaderCommon:{color:r.fabricColors.neutralTuatara},cdsRolesSubheaderOptionText:{whiteSpace:"unset"}})},6365:function(e,t,n){"use strict";n.r(t),n.d(t,"isCurrentUserCDSAdmin",(function(){return a})),n.d(t,"isCRMVersionCompatibleForCDSShare",(function(){return i}));var o=n(6366),r=n(1083),a=e=>"627090ff-40a3-4053-8790-584edc5be201"===e._roletemplateid_value;function i(e){return!!e&&Object(r.checkVersions)(e,o.CDS_SHARE_SUPPORTED_CRM_BUILD_MIN_VERSION)}},6366:function(e,t,n){"use strict";n.r(t),n.d(t,"CDS_SHARE_SUPPORTED_CRM_BUILD_MIN_VERSION",(function(){return o}));var o="9.1.0.4632"},6367:function(e,t,n){"use strict";n.r(t),n.d(t,"ComponentLibrarySharePanelContainer",(function(){return m}));var o=n(245),r=n.n(o),a=n(5437),i=n(2869),s=n(6006),l=n(2880),c=n(5596),p=n(6368),u=n(5468),d=n(5478),m=e=>{var{selectedComponentLibrary:t,defaultPanelProps:n,onClosePanel:o}=e,m=Object(i.getResources)(),b=Object(c.getAppDisplayName)(t),g=Object(l.formatResourceString)(m.ComponentLibraries.ManageComponentLibrary.Share.Panel.title,b),y=m.ComponentLibraries.ManageComponentLibrary.Share.Panel.subtitle,S=Object(a.useDispatch)();return r.a.createElement(s.AppSharePanelContainer,{selectedApp:t,defaultPanelProps:n,panelTitle:g,panelSubtitle:y,permissionsContainer:p.ComponentLibraryPermissionSectionContainer,onPanelClose:()=>{S(u.sharedActions.panelClose({panelType:d.PanelToShowType.ComponentLibrarySharePanel})),o&&o()},isComponentLibrary:!0})}},6368:function(e,t,n){"use strict";n.r(t),n.d(t,"ComponentLibraryPermissionSectionContainer",(function(){return p}));var o=n(245),r=n.n(o),a=n(2869),i=n(6361),s=n(2880),l=n(5481);function c(){return(c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}var p=e=>{var t=Object(a.getResources)(),n=Object(s.formatResourceStringAsLinks)(t.ComponentLibraries.ManageComponentLibrary.Share.AppResources.calloutText,[l.default.shareCDSforAppsLink,l.default.shareExcelLink,l.default.shareAppResourcesLink,l.default.shareLearnMoreLink]),o=t.ComponentLibraries.ManageComponentLibrary.Share.Panel.Permissions.Section.description,p=t.ComponentLibraries.ManageComponentLibrary.Share.UsersPermission.TenantAdditionalAnnotation,u=t.ComponentLibraries.ManageComponentLibrary.Share.UsersPermission.EveryonePermissionDescription,d=t.ComponentLibraries.ManageComponentLibrary.Share.UsersPermission.OneUserPermissionDescription,m=t.ComponentLibraries.ManageComponentLibrary.Share.UsersPermission.MultipleUserPermissionDescription,b=t.ComponentLibraries.ManageComponentLibrary.Share.CheckboxDescription;return r.a.createElement(i.AppPermissionsSectionContainer,c({},e,{appResourcesCallout:n,permissionsSectionDescription:o,tenantAdditionalAnnotation:p,everyonePermissionDescription:u,oneUserPermissionDescription:d,multipleUserPermissionDescription:m,checkboxDescription:b}))}},6369:function(e,t,n){"use strict";n.r(t),n.d(t,"mapDispatchToProps",(function(){return O})),n.d(t,"mapStateAndOwnPropsToProps",(function(){return C})),n.d(t,"mergeProps",(function(){return v})),n.d(t,"CreateConnectionReferencePanelContainer",(function(){return P}));var o=n(5437),r=n(5629),a=n(5478),i=n(5487),s=n(5468),l=n(6370),c=n(5704),p=n(6383),u=n(5807),d=n(5796),m=n(5630),b=n(5687),g=["rootProps"];function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){f(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var O=(e,t)=>({beforePanelClose:()=>{e(Object(d.fetchApisCancelPoll)()),e(Object(c.createConnectionReferenceClear)())},onPanelClose:()=>{e(s.sharedActions.panelClose({panelType:a.PanelToShowType.CreateConnectionReferencePanel}))},onCreateSave:(t,n)=>{e(Object(c.createConnectionReference)({solution:t,toCreate:n}))},openNewTab:t=>{e(Object(m.logAction)(s.sharedActions.openNewTab({uri:t}),b.ConnectionReferencePanelCommandEvents.LearnConnectionReferenceClicked.eventName))},fetchConnectorRequest:()=>{e(Object(d.fetchApisRequest)())},dispatchTelemetry:e}),C=(e,t)=>{var{rootProps:n}=t,o=Object(p.createConRefResponseSelector)(e),a=u.apisSelectorForCurrentEnv(e,n.currentEnvironment.id.toString()),i=u.apisListError(e),s=[Object(r.toLoadingState)(u.isApiListCachedComplete(e,n.currentEnvironment.id),i)];return{createConRefResponse:o,apis:a,loadProgress:s,isApiLoaded:Object(r.getTotalLoadingState)(s)==r.ComponentLoadState.Complete}},v=(e,t,n)=>{var{rootProps:o}=n,r=h(n,g);return S(S(S(S({},e),t),r),{},{isEdit:!1,defaultPanelProps:n.defaultPanelProps})},P=Object(i.withRootProps)(Object(o.connect)(C,O,v)(l.ConnectionReferencePanel))},6383:function(e,t,n){"use strict";n.r(t),n.d(t,"createConRefResponseSelector",(function(){return i})),n.d(t,"modifyConRefResponseSelector",(function(){return s})),n.d(t,"batchModifyConRefResponseSelector",(function(){return l})),n.d(t,"modifiedConnectionReferencesSelector",(function(){return c})),n.d(t,"fetchConRefDataResponseSelector",(function(){return p})),n.d(t,"conRefsNeedUpdateSelector",(function(){return u})),n.d(t,"connectionReferenceSelector",(function(){return d})),n.d(t,"ConnectionReferenceComponentSelector",(function(){return m})),n.d(t,"solutionComponentListWithValuesSelector",(function(){return b}));var o=n(2903),r=n(2812),a=n(5808),i=e=>e.connectionReferencesData.createResponse,s=e=>e.connectionReferencesData.modifyResponse,l=e=>e.connectionReferencesData.batchModifyResponse,c=e=>e.connectionReferencesData.modifiedConnectionReferences,p=e=>e.connectionReferencesData.fetchValuesResponse,u=e=>e.connectionReferencesData.conRefsNeedUpdate,d=(e,t)=>e.connectionReferencesData.connectionReferences.get(t),m=Object(o.memoizeFunction)((e,t,n,o)=>Object(r.find)(b(e,t,n),{msdyn_objectid:o})),b=(e,t,n,o)=>e.solutionComponents.solutionComponents.get(Object(a.getSolutionComponentMappingKey)(n,t,o))||[]},6384:function(e,t,n){"use strict";n.r(t),n.d(t,"mapStateToProps",(function(){return b})),n.d(t,"mapDispatchToProps",(function(){return g})),n.d(t,"mergeProps",(function(){return y})),n.d(t,"CreateEnvironmentPanelContainer",(function(){return S}));var o=n(5437),r=n(2869),a=n(2880),i=n(5630),s=n(5468),l=n(5478),c=n(5876),p=n(6385);function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){m(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var b=e=>{var t=Object(r.getResources)(),n=s.sharedSelectors.currentPlansMetaDataSelector(e),o=s.sharedSelectors.newEnvironmentSelector(e),i=s.sharedSelectors.newEnvironmentInProgressSelector(e),l=s.sharedSelectors.newEnvironmentErrorSelector(e),c=s.sharedSelectors.locationsSelector(e).map(e=>({key:e.name,text:e.properties.isDefault?Object(a.formatResourceString)(t.Shared.Environments.Create.CreateEnvironmentPanel.defaultRegionText,e.properties.displayName):e.properties.displayName}));return{doesUserHaveActiveP2Plan:n.doesUserHaveActiveP2Plan,locationOptions:c,newEnvironment:o,newEnvironmentInProgress:i,newEnvironmentError:l}},g=(e,t)=>({fetchLocations:()=>{e(s.sharedActions.fetchLocationsRequest())},onPanelClose:()=>{e(Object(i.logAction)(s.sharedActions.panelClose({panelType:l.PanelToShowType.CreateEnvironmentPanel}),c.CreateEnvironmentPanelEvents.CreatePanelClosed.eventName)),e(s.sharedActions.resetCreateEnvironmentPanelStatus())},onCreateNewEnvironment:t=>{e(Object(i.logAction)(s.sharedActions.createEnvironmentRequest({environmentName:t.name,region:t.region,environmentType:t.type}),c.CreateEnvironmentPanelEvents.CreateEnvironmentClick.eventName))},onCreateDatabase:()=>{e(Object(i.logAction)(s.sharedActions.panelOpen({panelType:l.PanelToShowType.CreateXrmDatabasePanel,panelProps:{sampleAppType:t.sampleAppType}}),c.CreateEnvironmentPanelEvents.CreateDatabaseClick.eventName))},onNavigateBack:()=>{e(s.sharedActions.resetCreateEnvironmentPanelStatus())}}),y=(e,t,n)=>d(d({onMount:()=>{t.fetchLocations()},defaultPanelProps:n.defaultPanelProps},e),t),S=Object(o.connect)(b,g,y)(p.CreateEnvironmentPanel)},6391:function(e,t,n){"use strict";n.r(t),n.d(t,"mapStateToProps",(function(){return h})),n.d(t,"mapDispatchToProps",(function(){return O})),n.d(t,"mergeProps",(function(){return C})),n.d(t,"CreateEnvironmentVariablePanelContainer",(function(){return v}));var o=n(5437),r=n(1144),a=n(5478),i=n(5468),s=n(6392),l=n(5630),c=n(5693),p=n(5687),u=n(6446),d=n(5787),m=n(5816),b=n(5629),g=n(5810);function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){f(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var h=e=>({createResponse:Object(m.createEnvVarResponseSelector)(e),createCurrentValueResponse:Object(m.createCurrentValueSelector)(e),modifyCurrentValueResponse:Object(m.modifyCurrentValueSelector)(e),modifyEnvironmentVariableResponse:Object(m.modifyEnvVarResponseSelector)(e),addSolutionComponentsResponse:Object(g.addSolutionComponentsStatus)(e),loadProgress:[{state:b.ComponentLoadState.Complete}],logEvent:null,deleteComponentsResponse:Object(g.deleteComponentsStatus)(e),removeComponentsResponse:Object(g.removeComponentsStatus)(e)}),O=e=>({beforePanelClose:()=>{e(Object(c.createCurrentValueClear)()),e(Object(c.createEnvironmentVariableClear)()),e(Object(c.modifyCurrentValueClear)()),e(Object(c.modifyEnvironmentVariableClear)())},onPanelClose:t=>{e(i.sharedActions.panelClose({panelType:a.PanelToShowType.CreateEnvironmentVariablePanel}))},openNewTab:t=>e(Object(l.logAction)(i.sharedActions.openNewTab({uri:t}),u.EnvironmentVariablePanelCommandEvents.LearnEnvironmentVariableClicked.eventName)),onCreateSave:(t,n,o)=>e(Object(c.createEnvironmentVariable)({solution:t,toCreate:n,currentValue:o})),onDeleteComponentClick:(e,t)=>{Object(l.logAction)(d.solutionComponentsActions.openDeleteDialog({components:[e],customComponentDefinitions:[],solutionId:t,shouldNotShowInList:!0}),p.SolutionComponentsCommandEvents.OpenDeleteDialog.eventName)},onRemoveComponentClick:(t,n)=>e(Object(l.logAction)(d.solutionComponentsActions.removeComponents({components:[t],solutionId:null==n?void 0:n.id,solutionName:null==n?void 0:n.name,shouldNotShowInList:!0}),p.SolutionComponentsCommandEvents.Remove.eventName)),dispatchTelemetry:e,fetchEnvironmentVariable:()=>null,clearResponses:()=>null}),C=(e,t,n)=>S(S(S(S({},e),t),n),{},{isEdit:!1}),v=Object(r.withHttpClient)(Object(o.connect)(h,O,C)(s.EnvironmentVariablePanel))},6392:function(e,t,n){"use strict";n.r(t),n.d(t,"EnvironmentVariablePanel",(function(){return w}));var o=n(4013),r=n(245),a=n(2869),i=n(6393),s=n(2812),l=n(2880),c=n(6394),p=n(6406),u=n(6407),d=n(5629),m=n(6396),b=n(6409),g=n(3076),y=n(1106),S=n(6410),f=n(6421),h=n(6416),O=n(6408),C=n(6422),v=n(6440),P=n(6442),E=n(6443),T=n(6444),j=n(6445),A=n(6379),R=n(2807);function I(){return(I=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}var w=e=>{var t,n,w,D=Object(a.getResources)(),N=D.Model.Solutions.Components.EnvironmentVariable.Panel,{currentEnvironment:L}=Object(r.useContext)(y.EnvironmentContext),{formData:M,onSetEnvironmentVariableDefinitionForFormData:x,isValidForm:k,hasUnsavedChanges:F,setNameIsPristine:_}=Object(c.useEnvironmentVariableForm)(e.isEdit,null===(t=e.solution)||void 0===t?void 0:t.isManaged,e.isValueEditOnly),[U,V]=Object(r.useState)({}),[B,H]=Object(r.useState)({}),[G,W]=Object(r.useState)(!1),[q,z]=Object(r.useState)(!1),{environmentClient:Q}=Object(r.useContext)(g.ApolloClientContext),[K,Y]=r.useState(!1),[J,X]=r.useState(!1),[Z,$]=r.useState(void 0),[ee,te]=r.useState(void 0),{queryStatus:ne,queryData:oe,onSetEnvironmentVariableDefinitionForQueryData:re}=Object(C.useEnvironmentVariableQueries)(e,M,Q,D);Object(r.useEffect)(()=>{e.environmentVariableDefinition&&x(e.environmentVariableDefinition),re(e.environmentVariableDefinition)},[e.environmentVariableDefinition]);var ae={title:N.ConfirmationDialog.title,subtext:N.ConfirmationDialog.subtext,confirmButtonText:N.ConfirmationDialog.confirmButtonText,cancelButtonText:N.ConfirmationDialog.cancelButtonText},ie=Object(v.getLoadingOverlay)(ne,e,D),se=Object(P.getMessageBar)(null===(n=e.solution)||void 0===n?void 0:n.isManaged,ne,D);Object(p.shouldClosePanelOnSuccess)(e)&&(e.beforePanelClose(),e.onPanelClose(!0)),Object(r.useEffect)(()=>{e.clearResponses()},[]),Object(r.useEffect)(()=>{var t,n;null!==(t=e.fetchVarDataResponse)&&void 0!==t&&t.success&&e.fetchEnvironmentVariableValue&&e.fetchEnvironmentVariableValue(null===(n=e.solution)||void 0===n?void 0:n.id,e.definitionId,L)},[null===(w=e.fetchVarDataResponse)||void 0===w?void 0:w.success]),Object(r.useEffect)(()=>{e.fetchEnvironmentVariable(L)},[e.removeComponentsResponse.success,e.deleteComponentsResponse.success]);var le,{solution:ce}=Object(A.useSolutionByUniqueName)(Q,"EnvironmentVariables",R.PortalScope,D.Common.Request.Failed);le=Object(d.getTotalLoadingState)(e.loadProgress)!==d.ComponentLoadState.Complete?r.createElement("div",null):r.createElement("div",null,Object(u.renderStandardFormContent)(e,D,ce,U,B,H,M,_),Object(S.renderDataSourceSections)(e,D,L,M,oe,Y),Object(f.renderSecretSections)(e,D,M,J,X),Object(h.renderValueSections)(e,D,L,M,oe,U,B,H,G,W,q,z,$,te),Object(O.renderCallout)(N.Name.calloutText,m.EnvironmentVariablePanelFormKeys.name,B,H,U,V),M.type.value&&Object(O.renderCallout)(N.DefaultValue.calloutText,m.EnvironmentVariablePanelFormKeys.defaultvalue,B,H,U,V));var pe=Object(b.getFooterButtons)(e,D,M,k,F,q,G,!!ie);return r.createElement(r.Fragment,null,Object(j.getRefreshConnectionsDialog)(K,Y,oe,D),Object(E.getConfirmParentChangeDialog)(Z,$,M,oe,D),Object(T.getConfirmParentDeleteValueDialog)(ee,te,M,oe,D),r.createElement(o.Panel,I({},e.defaultPanelProps,{headerText:e.isEdit?Object(l.formatResourceString)(N.editTitle,Object(s.get)(e,"environmentVariableDefinition.displayname")):N.createTitle,loadingOverlay:ie,messageBar:se,footerButtons:pe,showDismissDialog:F,dismissDialog:ae,onDismiss:()=>{e.beforePanelClose(),e.onPanelClose(!1)},className:i.environmentVariableStyleClasses.panelFooter,closeButtonAriaLabel:D.Common.close}),le))}},6393:function(e,t,n){"use strict";n.r(t),n.d(t,"environmentVariableStyleClasses",(function(){return u})),n.d(t,"environmentVariableTextStyles",(function(){return m})),n.d(t,"environmentVariableDropdownStyles",(function(){return b})),n.d(t,"environmentVariableCalloutStyles",(function(){return g})),n.d(t,"defaultValueAccordionStyles",(function(){return y}));var o=n(3328),r=n(2882),a=n(5617),i=n(5932);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var p={fontWeight:"500",marginTop:"16px"},u=Object(o.mergeStyleSets)({fieldSection:["environment-variable-section",{display:"block"}],fieldHeader:["environment-variable-section-header",{display:"inline-block",selectors:{label:l(l({},p),{},{display:"inline-block",marginBottom:"5px",maxWidth:"100%",paddingTop:"5px"})}}],fieldSubHeader:["environment-variable-section-subheader",{display:"block",selectors:{span:{fontWeight:"normal",fontSize:"12px",display:"inline-block",maxWidth:"100%",paddingTop:"5px"}}}],fieldStandardSubHeader:["environment-variable-section-subheader",{selectors:{span:{marginBottom:"22px"}}}],fieldDataSourceSubHeader:["environment-variable-section-subheader",{selectors:{span:{paddingBottom:"5px"}}}],fieldIconCallout:["environment-variable-icon-callout",{width:"330px",height:"50px"}],fieldIcon:["environment-variable-icon",{paddingLeft:"2px"}],fieldRequired:["environment-variable-required",{color:r.fabricColors.brightRed,paddingLeft:"4px"}],currentValueFieldHeader:{borderTop:"1px solid ".concat(r.fabricColors.neutralLight)},editCurrentValueFieldInputWrapper:{selectors:{"> *":{display:"inline-block"},"> div":{width:"calc(100% - 32px)"}}},dropdownOptionIcon:{color:a.fabricTheme.palette.themePrimary,margin:"7px 8px 7px 4px",lineHeight:"18px"},dropdownOptionText:{lineHeight:"32px",verticalAlign:"top"},panelFooter:{selectors:{"div[class^='ba-Panel-footer']":{float:"right"}}},learnMoreLink:{cursor:"pointer",fontFamily:"Segoe UI",marginLeft:"2px",color:a.fabricTheme.palette.themePrimary,fontSize:"14px",textDecoration:"underline",selectors:{"&:hover":{textDecoration:"underline"}}},moreButton:{width:"32px",maxWidth:"32px"}}),d={borderRadius:"2px",border:"1px solid ".concat(r.fabricColors.neutralTertiaryAlt),boxSizing:"border-box"},m={fieldGroup:d,subComponentStyles:{label:{root:p}}},b={title:d,label:p},g={root:{borderRadius:"2px",padding:"5px"}},y={root:{height:20,marginLeft:"0",paddingLeft:"0",backgroundColor:r.fabricColors.white},flexContainer:{alignItems:"flex-start",justifyContent:"flex-start"},textContainer:{flexGrow:0},label:{fontSize:14,marginLeft:"0",verticalAlign:"middle",fontFamily:i.fonts.segoeUi,lineHeight:20,color:r.fabricColors.plum,fontWeight:"normal"},menuIcon:{fontSize:12,color:r.fabricColors.plum,lineHeight:12,marginTop:3,marginBottom:3},container:{borderTop:"1px solid ".concat(r.fabricColors.veryLightGrey),marginTop:16},header:{marginTop:16}}},6394:function(e,t,n){"use strict";n.r(t),n.d(t,"useEnvironmentVariableForm",(function(){return g}));var o=n(6395),r=n(2830),a=n(5148),i=n(6396),s=n(2869),l=n(245),c=n(6397),p=n(6403),u=n(6405);function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){b(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function b(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function g(e,t,n){var[d,b]=Object(l.useState)(e),[g,y]=Object(l.useState)(!0),[S,f]=Object(l.useState)(!1),{formData:h,onSetEnvironmentVariableDefinitionForFormData:O}=function(e,t,n,d,b){var g=Object(s.getResources)(),[y,S]=Object(l.useState)(!0),[f,h]=Object(l.useState)(),[O,C]=Object(l.useState)(),[v,P]=Object(l.useState)(),[E,T]=Object(l.useState)(),[j,A]=Object(l.useState)(),[R,I]=Object(l.useState)(),[w,D]=Object(l.useState)(),N=function(e,n,o,r,a){return Object(i.createFormInputData)(e,n,o,t,S,y,r||d,a)},L=/[^A-Z0-9_]+/gi,M={name:N(f,h,[a.required(g.Model.Solutions.Components.EnvironmentVariable.Error.required),a.maxLength(100,e=>g.Model.Solutions.Components.EnvironmentVariable.Error.displayNameLength)],n||!!b),displayName:N(O,t=>{if(e&&!n){var o=null==t?void 0:t.replace(L,"");M.name.setValue(o)}C(t)},[a.required(g.Model.Solutions.Components.EnvironmentVariable.Error.required),Object(u.blank)(g.Model.Solutions.Components.EnvironmentVariable.Error.mustNotBeBlank)],!!b),description:N(v,P,[],!!b),type:N(E,e=>{e!==M.type.value&&(e!==r.EnvironmentVariableDefinitionTypeEnum.ConnectionReference&&x.connector.setValue(void 0),e!==r.EnvironmentVariableDefinitionTypeEnum.Secret&&F.secretStore.setValue(void 0),M.defaultValue.setValue(""),M.currentValue.setValue(m(m({},M.currentValue.value),{},{value:""})),T(e))},[a.required(g.Model.Solutions.Components.EnvironmentVariable.Error.required)],n||!!b),defaultValue:N(j,A,[a.maxLength(2e3,e=>g.Model.Solutions.Components.EnvironmentVariable.Error.maxLength),e=>{if(M.type.value===r.EnvironmentVariableDefinitionTypeEnum.Number&&e){if(!/^-?(\d+\.?)?\d+$/.test(e))return g.Model.Solutions.Components.EnvironmentVariable.Error.wrongFormat}}],!!b),defaultValueTwoOptions:N(R,I,[],!!b),currentValue:N(w,D,[e=>a.maxLength(2e3,e=>g.Model.Solutions.Components.EnvironmentVariable.Error.maxLength)(null==e?void 0:e.value),e=>{if(M.type.value===r.EnvironmentVariableDefinitionTypeEnum.Number&&null!=e&&e.value){if(!/^-?(\d+\.?)?\d+$/.test(null==e?void 0:e.value))return g.Model.Solutions.Components.EnvironmentVariable.Error.wrongFormat}}],!1)},{dataSourceFormData:x,setDataSourceEnvironmentVariableDefinition:k}=Object(c.useEnvironmentVariableDataSourceForm)(M,N,n,b),{secretFormData:F,setSecretEnvironmentVariableDefinition:_}=Object(p.useEnvironmentVariableSecretForm)(M,N,n,b);return{formData:m(m(m({},M),x),F),onSetEnvironmentVariableDefinitionForFormData:e=>{(e=>{var t;h(e.schemaname),C(e.displayname),P(e.description),T(e.type),A(e.defaultvalue),I(e.type===r.EnvironmentVariableDefinitionTypeEnum.Boolean?e.defaultvalue:o.TwoOptionVariableTypes.no),D(null!==(t=e.environmentvariabledefinition_environmentvariablevalue)&&void 0!==t&&t.length?e.environmentvariabledefinition_environmentvariablevalue[0]:void 0)})(e),k(e),_(e)}}}(g,f,e,t,n);return function(e,t){Object(l.useEffect)(()=>{for(var n of Object.values(e)){var o=n;if(o.getErrorMessage(o.value))return void t(!1)}t(!0)},[e])}(h,b),{formData:h,onSetEnvironmentVariableDefinitionForFormData:O,isValidForm:d,hasUnsavedChanges:S,setNameIsPristine:y}}},6395:function(e,t,n){"use strict";n.r(t),n.d(t,"RefreshConnections",(function(){return r})),n.d(t,"RefreshConnectionsActionNames",(function(){return a})),n.d(t,"TwoOptionVariableTypes",(function(){return o}));var o,r="refreshConnections",a={DismissDialog:"dismissDialog",OpenDialog:"openDialog",ExecuteFromDialog:"executeFromDialog"};!function(e){e.yes="yes",e.no="no"}(o||(o={}))},6396:function(e,t,n){"use strict";var o;function r(e,t,n,o,r,a,i,s){return{value:e,setValue:(e,n)=>{n||(o(!0),r(!1)),t(e,n)},getErrorMessage:e=>{if(a)return"";if(i&&!s)return"";for(var t="",o=0;o<n.length;++o)t||(t=n[o](e));return t},isDisabled:i}}n.r(t),n.d(t,"EnvironmentVariablePanelFormKeys",(function(){return o})),n.d(t,"createFormInputData",(function(){return r})),function(e){e.name="name",e.defaultvalue="defaultvalue",e.currentValue="current"}(o||(o={}))},6397:function(e,t,n){"use strict";n.r(t),n.d(t,"useEnvironmentVariableDataSourceForm",(function(){return m}));var o=n(2830),r=n(6398),a=n(5148),i=n(2869),s=n(245),l=n(6399),c=n(6401);function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function m(e,t,n,p){var d=Object(i.getResources)(),[m,b]=Object(s.useState)(),[g,y]=Object(s.useState)(),S={connector:t(m,t=>{t!==S.connector.value&&(S.connection.setValue(void 0),f.sharePointParameterType.setValue(void 0),e.currentValue.setValue(void 0),e.defaultValue.setValue(void 0)),b(t)},[t=>e.type.value===o.EnvironmentVariableDefinitionTypeEnum.ConnectionReference?a.required(d.Model.Solutions.Components.EnvironmentVariable.Error.required)(t):"",t=>e.type.value!==o.EnvironmentVariableDefinitionTypeEnum.ConnectionReference||Object.values(r.IEnvironmentVariableConnectors).includes(null==t?void 0:t.toLowerCase())?"":d.Model.Solutions.Components.EnvironmentVariable.Error.unsupportedConnector],n||!!p,!0),connection:t(g,y,[t=>e.type.value===o.EnvironmentVariableDefinitionTypeEnum.ConnectionReference&&S.connector.value&&!Object(r.isCDSApiId)(S.connector.value)?a.required(d.Model.Solutions.Components.EnvironmentVariable.Error.required)(t):""],!1)},{sharePointFormData:f,setSharePointEnvironmentVariableDefinition:h}=Object(l.useEnvironmentVariableSharePointForm)(e,S,t,n,p),{sqlFormData:O,setSQLEnvironmentVariableDefinition:C}=Object(c.useEnvironmentVariableSQLForm)(e,S,t,n,p);return{dataSourceFormData:u(u(u({},S),f),O),setDataSourceEnvironmentVariableDefinition:e=>{b(Object(r.isDataSourceEnvironmentVariableDefinition)(e)&&e.apiid),h(e),C(e)}}}},6399:function(e,t,n){"use strict";n.r(t),n.d(t,"useEnvironmentVariableSharePointForm",(function(){return d}));var o=n(2830),r=n(6398),a=n(6400),i=n(5148),s=n(2869),l=n(245);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e,t,n,c,u){var d=Object(s.getResources)(),[m,b]=Object(l.useState)(),[g,y]=Object(l.useState)(),S={sharePointParameterType:n(m,e=>{e!==S.sharePointParameterType.value&&S.sharePointSite.setValue(void 0),b(e)},[n=>e.type.value===o.EnvironmentVariableDefinitionTypeEnum.ConnectionReference&&Object(r.isSharePointApiId)(t.connector.value)?i.required(d.Model.Solutions.Components.EnvironmentVariable.Error.required)(n):""],c||!!u),sharePointSite:n(g,(t,n)=>{t===S.sharePointSite.value||n||(e.defaultValue.setValue(""),e.currentValue.setValue(p(p({},e.currentValue.value),{},{value:""}))),y(t)},[n=>{if(e.type.value===o.EnvironmentVariableDefinitionTypeEnum.ConnectionReference&&Object(r.isSharePointApiId)(t.connector.value)&&"table"===S.sharePointParameterType.value)return i.required(d.Model.Solutions.Components.EnvironmentVariable.Error.required)(n)}],!!u)};return{sharePointFormData:S,setSharePointEnvironmentVariableDefinition:e=>{b(Object(a.isSharePointEnvironmentVariableDefinition)(e)?e.parameterkey:void 0)}}}},6401:function(e,t,n){"use strict";n.r(t),n.d(t,"useEnvironmentVariableSQLForm",(function(){return d}));var o=n(2830),r=n(6398),a=n(6402),i=n(5148),s=n(2869),l=n(245);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e,t,n,c,u){var d=Object(s.getResources)(),[m,b]=Object(l.useState)(),[g,y]=Object(l.useState)(),S={sqlParameterType:n(m,e=>{e!==S.sqlParameterType.value&&S.sqlServer.setValue(void 0),b(e)},[n=>e.type.value===o.EnvironmentVariableDefinitionTypeEnum.ConnectionReference&&Object(r.isSQLApiId)(t.connector.value)?i.required(d.Model.Solutions.Components.EnvironmentVariable.Error.required)(n):""],c||!!u),sqlServer:n(g,(t,n)=>{t===S.sqlServer.value||n||(e.defaultValue.setValue(""),e.currentValue.setValue(p(p({},e.currentValue.value),{},{value:""}))),y(t)},[n=>{if(e.type.value===o.EnvironmentVariableDefinitionTypeEnum.ConnectionReference&&Object(r.isSQLApiId)(t.connector.value)&&"table"===S.sqlParameterType.value)return i.required(d.Model.Solutions.Components.EnvironmentVariable.Error.required)(n)}],!!u)};return{sqlFormData:S,setSQLEnvironmentVariableDefinition:e=>{b(Object(a.isSQLEnvironmentVariableDefinition)(e)?e.parameterkey:void 0)}}}},6403:function(e,t,n){"use strict";n.r(t),n.d(t,"useEnvironmentVariableSecretForm",(function(){return d}));var o=n(2830),r=n(6398),a=n(5148),i=n(2869),s=n(245),l=n(6404);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e,t,n,c){var u=Object(i.getResources)(),[d,m]=Object(s.useState)(),b={secretStore:t(d,t=>{t!==b.secretStore.value&&(e.currentValue.setValue(void 0),e.defaultValue.setValue(void 0)),m(t)},[t=>e.type.value===o.EnvironmentVariableDefinitionTypeEnum.Secret?a.required(u.Model.Solutions.Components.EnvironmentVariable.Error.required)(t):""],n||!!c,!0)},{keyVaultFormData:g}=Object(l.useEnvironmentVariableKeyVaultForm)(e,b,t,n,c);return{secretFormData:p(p({},b),g),setSecretEnvironmentVariableDefinition:e=>{m(Object(r.isSecretEnvironmentVariableDefinition)(e)?e.secretstore:void 0)}}}},6404:function(e,t,n){"use strict";n.r(t),n.d(t,"useEnvironmentVariableKeyVaultForm",(function(){return i})),n.d(t,"isValidGuid",(function(){return s})),n.d(t,"isValidAzureResourceName",(function(){return l})),n.d(t,"getKeyVaultReference",(function(){return c})),n.d(t,"validateKeyVaultReferenceRequired",(function(){return p}));var o=n(6396),r=n(2869),a=n(245);function i(e,t,n,i,u){var d,m,b,[g,y]=Object(a.useState)(),[S,f]=Object(a.useState)(),[h,O]=Object(a.useState)(),[C,v]=Object(a.useState)(),[P,E]=Object(a.useState)(),[T,j]=Object(a.useState)(),[A,R]=Object(a.useState)(),[I,w]=Object(a.useState)(),D=c(null===(d=e.defaultValue)||void 0===d?void 0:d.value),N=c(null===(m=e.currentValue)||void 0===m||null===(b=m.value)||void 0===b?void 0:b.value),L=Object(r.getResources)(),M=L.Model.Solutions.Components.EnvironmentVariable.Error.required,x=e=>p(e,B,o.EnvironmentVariablePanelFormKeys.defaultvalue,M),k=e=>p(e,B,o.EnvironmentVariablePanelFormKeys.currentValue,M),F=e=>n(e===o.EnvironmentVariablePanelFormKeys.defaultvalue?null!=g?g:null==D?void 0:D.subscriptionId:null!=P?P:null==N?void 0:N.subscriptionId,t=>{e===o.EnvironmentVariablePanelFormKeys.defaultvalue?y(t):E(t)},[e=>{if(e&&!s(e))return L.Model.Solutions.Components.EnvironmentVariable.Panel.Secret.Error.wrongKeyVaultSubscriptionIdFormat},t=>e===o.EnvironmentVariablePanelFormKeys.defaultvalue?x(t):k(t)],i||!!u),_=e=>n(e===o.EnvironmentVariablePanelFormKeys.defaultvalue?null!=S?S:null==D?void 0:D.resourceGroupName:null!=T?T:null==N?void 0:N.resourceGroupName,t=>{e===o.EnvironmentVariablePanelFormKeys.defaultvalue?f(t):j(t)},[e=>{if(e&&!l(e))return L.Model.Solutions.Components.EnvironmentVariable.Panel.Secret.Error.wrongKeyVaultResourceGroupNameFormat},t=>e===o.EnvironmentVariablePanelFormKeys.defaultvalue?x(t):k(t)],i||!!u),U=e=>n(e===o.EnvironmentVariablePanelFormKeys.defaultvalue?null!=h?h:null==D?void 0:D.keyVaultName:null!=A?A:null==N?void 0:N.keyVaultName,t=>{e===o.EnvironmentVariablePanelFormKeys.defaultvalue?O(t):R(t)},[e=>{if(e&&!l(e))return L.Model.Solutions.Components.EnvironmentVariable.Panel.Secret.Error.wrongKeyVaultNameFormat},t=>e===o.EnvironmentVariablePanelFormKeys.defaultvalue?x(t):k(t)],i||!!u),V=e=>n(e===o.EnvironmentVariablePanelFormKeys.defaultvalue?null!=C?C:null==D?void 0:D.secretName:null!=I?I:null==N?void 0:N.secretName,t=>{e===o.EnvironmentVariablePanelFormKeys.defaultvalue?v(t):w(t)},[e=>{if(e&&!l(e))return L.Model.Solutions.Components.EnvironmentVariable.Panel.Secret.Error.wrongKeyVaultSecretNameFormat},t=>e===o.EnvironmentVariablePanelFormKeys.defaultvalue?x(t):k(t)],i||!!u),B={defaultSubscriptionId:F(o.EnvironmentVariablePanelFormKeys.defaultvalue),defaultResourceGroupName:_(o.EnvironmentVariablePanelFormKeys.defaultvalue),defaultKeyVaultName:U(o.EnvironmentVariablePanelFormKeys.defaultvalue),defaultSecretName:V(o.EnvironmentVariablePanelFormKeys.defaultvalue),currentSubscriptionId:F(o.EnvironmentVariablePanelFormKeys.currentValue),currentResourceGroupName:_(o.EnvironmentVariablePanelFormKeys.currentValue),currentKeyVaultName:U(o.EnvironmentVariablePanelFormKeys.currentValue),currentSecretName:V(o.EnvironmentVariablePanelFormKeys.currentValue)};return{keyVaultFormData:B}}function s(e){if(e){return!!/^(\{){0,1}[0-9a-fA-F]{8}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{12}(\}){0,1}$/.test(e)}return!1}function l(e){if(e){return!!/^[-\w\._\(\)]+$/.test(e)}return!1}function c(e){var t=null==e?void 0:e.split("/");return(null==t?void 0:t.length)>=10?{subscriptionId:t[2],resourceGroupName:t[4],keyVaultName:t[8],secretName:t[10]}:void 0}function p(e,t,n,r){var a,i,s,l,c,p,u,d;return n===o.EnvironmentVariablePanelFormKeys.defaultvalue&&(null!==(a=t.defaultSubscriptionId)&&void 0!==a&&a.value||null!==(i=t.defaultResourceGroupName)&&void 0!==i&&i.value||null!==(s=t.defaultKeyVaultName)&&void 0!==s&&s.value||null!==(l=t.defaultSecretName)&&void 0!==l&&l.value)&&!e||n===o.EnvironmentVariablePanelFormKeys.currentValue&&(null!==(c=t.currentSubscriptionId)&&void 0!==c&&c.value||null!==(p=t.currentResourceGroupName)&&void 0!==p&&p.value||null!==(u=t.currentKeyVaultName)&&void 0!==u&&u.value||null!==(d=t.currentSecretName)&&void 0!==d&&d.value)&&!e?r:void 0}},6405:function(e,t,n){"use strict";function o(e){return t=>{if(0===(t=(t||"").trim()).length)return e}}n.r(t),n.d(t,"blank",(function(){return o}))},6406:function(e,t,n){"use strict";n.r(t),n.d(t,"shouldClosePanelOnSuccess",(function(){return d})),n.d(t,"shouldClosePanelOnSuccessCreateMode",(function(){return m})),n.d(t,"shouldClosePanelOnSuccessEditMode",(function(){return b})),n.d(t,"getDefaultValue",(function(){return g})),n.d(t,"isSaveDisabled",(function(){return y})),n.d(t,"onCalloutDismiss",(function(){return S})),n.d(t,"onToggleVisibilityClicked",(function(){return f})),n.d(t,"shouldShowCurrentValueInput",(function(){return h})),n.d(t,"shouldShowNewCurrentValueButton",(function(){return O})),n.d(t,"getEnvironmentVariableTypeOptions",(function(){return C})),n.d(t,"isEnvironmentVariablesSolutionCompatibleForDataSourceEnvironmentVariables",(function(){return v}));var o=n(5608),r=n(2844),a=n(3713),i=n(2871),s=n(1083),l=n(6398);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e){return e.isEdit?b(e):m(e)}function m(e){return(e.createResponse.success||e.createCurrentValueResponse.success)&&!(e.createResponse.failed||e.createCurrentValueResponse.failed)&&!(e.createResponse.loading||e.createCurrentValueResponse.loading)}function b(e){return(e.modifyEnvironmentVariableResponse.success||e.modifyCurrentValueResponse.success||e.createCurrentValueResponse.success||e.addSolutionComponentsResponse.success)&&!(e.modifyEnvironmentVariableResponse.failed||e.modifyCurrentValueResponse.failed||e.createCurrentValueResponse.failed||e.addSolutionComponentsResponse.failed)&&!(e.modifyEnvironmentVariableResponse.loading||e.modifyCurrentValueResponse.loading||e.createCurrentValueResponse.loading||e.addSolutionComponentsResponse.loading)}function g(e){return e.type.value===o.EnvironmentVariableDefinitionTypeEnum.Boolean?e.defaultValueTwoOptions.value:e.defaultValue.value}function y(e,t,n,o,r){var a;return!(null===(a=e.solution)||void 0===a||!a.isManaged)||(!e.isEdit||!o)&&(!(n&&!r)||!t)}function S(e,t,n){n(p(p({},t),{},{[e]:!1}))}function f(e,t,n){n(p(p({},t),{},{[e]:!t[e]}))}function h(e,t){return t||e.isEdit&&e.valuesInSolution&&e.valuesInSolution.length>0}function O(e){return!e.isEdit||e.valuesNotInSolution&&0===e.valuesNotInSolution.length&&!e.environmentVariableValueComponent}function C(e,t,n){var s=t.Model.Solutions.Components.EnvironmentVariable.Panel,c=[{key:o.EnvironmentVariableDefinitionTypeEnum.Number,text:s.DataType.decimalNumber,data:{icon:r.fabricIcons.Subscript}},{key:o.EnvironmentVariableDefinitionTypeEnum.JSON,text:s.DataType.json,data:{icon:r.fabricIcons.Code}},{key:o.EnvironmentVariableDefinitionTypeEnum.String,text:s.DataType.text,data:{icon:r.fabricIcons.TextField}},{key:o.EnvironmentVariableDefinitionTypeEnum.Boolean,text:(Object(a.isCdsLiteContext)(),s.DataType.booleanChoice),data:{icon:r.fabricIcons.BulletedList}}];return(v(null==n?void 0:n.version)&&i.featureGates.enableConnectionTypeEnvironmentVariables||Object(l.isDataSourceEnvironmentVariableDefinition)(e.environmentVariableDefinition))&&c.push({key:o.EnvironmentVariableDefinitionTypeEnum.ConnectionReference,text:s.DataType.dataSource,data:{icon:r.fabricIcons.OfflineStorage}}),i.featureGates.enableSecretTypeEnvironmentVariables&&c.push({key:o.EnvironmentVariableDefinitionTypeEnum.Secret,text:s.DataType.secret,data:{icon:r.fabricIcons.Permissions}}),c}function v(e){return!!e&&Object(s.checkVersions)(e,"1.0.2.47")}},6407:function(e,t,n){"use strict";n.r(t),n.d(t,"renderStandardFormContent",(function(){return g}));var o=n(6396),r=n(245),a=n(684),i=n(2879),s=n(5481),l=n(6393),c=n(1429),p=n(1567),u=n(6406),d=n(6408),m=n(2882),b=n(1090);function g(e,t,n,g,y,S,f,h){var O,C=t.Model.Solutions.Components.EnvironmentVariable.Panel;return r.createElement(r.Fragment,null,r.createElement("p",null,e.isEdit?C.editSubTitle:C.createSubTitle,r.createElement(b.Link,{href:s.default.environmentVariablesLearnMoreLink,target:"_blank",className:l.environmentVariableStyleClasses.learnMoreLink},C.learnMore)),r.createElement(c.TextField,{label:C.displayName,styles:l.environmentVariableTextStyles,required:!0,disabled:f.displayName.isDisabled,value:f.displayName.value,onChange:(e,t)=>{f.displayName.setValue(t)},errorMessage:f.displayName.getErrorMessage(f.displayName.value)}),r.createElement("div",{className:l.environmentVariableStyleClasses.fieldSection},r.createElement(c.TextField,{prefix:e.isEdit||null===(O=e.solution)||void 0===O?void 0:O.resourceNamePrefix,styles:l.environmentVariableTextStyles,ariaLabel:C.name,disabled:f.name.isDisabled,onRenderLabel:()=>r.createElement("div",{className:l.environmentVariableStyleClasses.fieldHeader},r.createElement("label",null,C.name),r.createElement("span",{className:l.environmentVariableStyleClasses.fieldRequired},"*"),r.createElement("span",{className:l.environmentVariableStyleClasses.fieldIcon,ref:g[o.EnvironmentVariablePanelFormKeys.name]},r.createElement(a.IconButton,{onClick:()=>Object(u.onToggleVisibilityClicked)(o.EnvironmentVariablePanelFormKeys.name,y,S),style:{color:m.fabricColors.accentGray},iconProps:{iconName:i.fabricIcons.Info},title:C.Generic.calloutTooltip,ariaLabel:C.Generic.calloutTooltip}))),value:f.name.value,onChange:(e,t)=>{f.name.setValue(t)},errorMessage:f.name.getErrorMessage(f.name.value),onFocus:()=>h(!1)})),r.createElement(c.TextField,{styles:l.environmentVariableTextStyles,disabled:f.description.isDisabled,label:C.description,value:f.description.value,onChange:(e,t)=>{f.description.setValue(t)}}),r.createElement(p.Dropdown,{options:Object(u.getEnvironmentVariableTypeOptions)(e,t,n),label:C.DataType.label,required:!0,onRenderOption:d.onRenderOption,onRenderTitle:e=>Object(d.onRenderOption)(e[0]),placeholder:C.DataType.placeholder,role:"listbox",disabled:f.type.isDisabled,styles:l.environmentVariableDropdownStyles,errorMessage:f.type.getErrorMessage(f.type.value),selectedKey:f.type.value,onChange:(e,t)=>{f.type.setValue(null==t?void 0:t.key)}}))}},6408:function(e,t,n){"use strict";n.r(t),n.d(t,"onRenderOption",(function(){return p})),n.d(t,"renderCallout",(function(){return u}));var o=n(245),r=n(687),a=n(790),i=n(6393),s=n(6406);function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p(e){return o.createElement("div",null,e.data&&e.data.icon&&o.createElement(r.Icon,{className:i.environmentVariableStyleClasses.dropdownOptionIcon,iconName:e.data.icon,"aria-hidden":"true",title:e.data.icon}),o.createElement("span",{className:i.environmentVariableStyleClasses.dropdownOptionText},e.text))}function u(e,t,n,r,p,u){if(!p[t]){var d=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},p);return d[t]=o.createRef(),u(d),o.createElement(o.Fragment,null)}return o.createElement(a.Callout,{role:"alertdialog",className:i.environmentVariableStyleClasses.fieldIconCallout,gapSpace:0,onDismiss:()=>Object(s.onCalloutDismiss)(t,n,r),setInitialFocus:!1,target:p[t].current,hidden:!n[t],directionalHint:a.DirectionalHint.topCenter,styles:i.environmentVariableCalloutStyles},e)}},6409:function(e,t,n){"use strict";n.r(t),n.d(t,"getFooterButtons",(function(){return d}));var o=n(6395),r=n(2812),a=n(6398),i=n(5611),s=n(6406),l=n(2830);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e,t,n,a,c,u,d,g){var y=t.Model.Solutions.Components.EnvironmentVariable.Panel;return[{primary:!0,ariaLabel:y.save,text:y.save,dismissableOnClick:()=>{if(e.isEdit){var t,a,c,g=Object(r.get)(e,"environmentVariableDefinition.environmentvariabledefinition_environmentvariablevalue[0].environmentvariablevalueid"),y=p(p({environmentvariabledefinitionid:e.environmentVariableDefinition.environmentvariabledefinitionid,displayname:n.displayName.value,description:n.description.value,type:n.type.value,defaultvalue:Object(s.getDefaultValue)(n)},m(n)),b(n));if(e.onEditSave(e.solution,null===(t=n.currentValue.value)||void 0===t?void 0:t.value,!!e.environmentVariableValueComponent,d||e.valuesInSolution&&e.valuesInSolution.length>0,g,e.environmentVariableDefinition,y),u)e.addExistingValue({solutionName:null===(a=e.solution)||void 0===a?void 0:a.name,solutionId:null===(c=e.solution)||void 0===c?void 0:c.id,componentType:i.StandardSolutionComponentTypes.EnvironmentVariableValue,componentsWithSubcomponents:[{component:e.environmentVariableValueComponent,includeSubcomponents:!1,includeEntityMetadata:!1,subcomponents:[]}]})}else{var S,f,h=null===(S=n.currentValue.value)||void 0===S?void 0:S.value;n.type.value===l.EnvironmentVariableDefinitionTypeEnum.Boolean&&!h&&d&&(h=o.TwoOptionVariableTypes.no);var O=p(p({displayname:n.displayName.value,schemaname:(null===(f=e.solution)||void 0===f?void 0:f.resourceNamePrefix)+n.name.value,description:n.description.value,defaultvalue:Object(s.getDefaultValue)(n),type:n.type.value},m(n)),b(n));e.onCreateSave(e.solution,O,h)}},disabled:Object(s.isSaveDisabled)(e,a,c,u,g)},{ariaLabel:t.Common.Save.cancel,text:t.Common.Save.cancel,dismissableOnClick:e=>{e()}}]}function m(e){if(e.type.value===l.EnvironmentVariableDefinitionTypeEnum.ConnectionReference){if(Object(a.isSharePointApiId)(e.connector.value))return p({type:l.EnvironmentVariableDefinitionTypeEnum.ConnectionReference,apiid:a.IEnvironmentVariableConnectors.SharePoint,parameterkey:e.sharePointParameterType.value},"table"===e.sharePointParameterType.value?{_parentdefinitionid_value:e.sharePointSite.value.environmentvariabledefinitionid}:{});if(Object(a.isSQLApiId)(e.connector.value))return p({type:l.EnvironmentVariableDefinitionTypeEnum.ConnectionReference,apiid:a.IEnvironmentVariableConnectors.SQL,parameterkey:e.sqlParameterType.value},"table"===e.sqlParameterType.value?{_parentdefinitionid_value:e.sqlServer.value.environmentvariabledefinitionid}:{});if(Object(a.isCDSApiId)(e.connector.value))return{type:l.EnvironmentVariableDefinitionTypeEnum.ConnectionReference,apiid:a.IEnvironmentVariableConnectors.CDS}}return{}}function b(e){return e.type.value===l.EnvironmentVariableDefinitionTypeEnum.Secret?{type:l.EnvironmentVariableDefinitionTypeEnum.Secret,secretstore:e.secretStore.value}:{}}},6410:function(e,t,n){"use strict";n.r(t),n.d(t,"renderDataSourceSections",(function(){return f}));var o=n(245),r=n(6393),a=n(5608),i=n(1567),s=n(2698),l=n(6411),c=n(6412),p=n(6398),u=n(6413),d=n(6417),m=n(2871),b=n(3713);function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){S(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function S(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function f(e,t,n,g,S,f){if(g.type.value!==a.EnvironmentVariableDefinitionTypeEnum.ConnectionReference)return null;var h,O;if(g.connector.value)if(Object(p.isSharePointApiId)(g.connector.value))h=Object(u.renderSharePointSections)(e,t,!(null===(O=g.connection.value)||void 0===O||!O.name),g,S.sharePointData.sharePointSiteVariables);else if(Object(p.isSQLApiId)(g.connector.value)){var C;h=Object(d.renderSQLSections)(e,t,!(null===(C=g.connection.value)||void 0===C||!C.name),g,S.sqlData.sqlServerVariables)}return o.createElement(o.Fragment,null,function(e,t,n){var a,s,l=Object(b.getUXContext)(null==n||null===(a=n.properties)||void 0===a?void 0:a.environmentSku),c=Object(b.isCDSLiteUXContext)(l),u=e.Model.Solutions.Components.EnvironmentVariable.Panel,d=[{key:p.IEnvironmentVariableConnectors.SharePoint,text:u.DataSource.Connector.sharePoint}];m.featureGates.enableSQLTypeEnvironmentVariables&&d.push({key:p.IEnvironmentVariableConnectors.SQL,text:u.DataSource.Connector.sql});m.featureGates.enableCDSTypeEnvironmentVariables&&d.push({key:p.IEnvironmentVariableConnectors.CDS,text:c?u.DataSource.Connector.dataverseForTeams:u.DataSource.Connector.dataverse});return o.createElement(i.Dropdown,{options:d,label:u.DataSource.Connector.label,required:!0,placeholder:u.DataSource.Connector.placeholder,role:"listbox",disabled:t.connector.isDisabled,styles:r.environmentVariableDropdownStyles,errorMessage:t.connector.getErrorMessage(t.connector.value),selectedKey:null===(s=t.connector.value)||void 0===s?void 0:s.toLocaleLowerCase(),onChange:(e,n)=>{t.connector.setValue(null==n?void 0:n.key)}})}(t,g,n),function(e,t,n,r,a){var u,d;if(!n.connector.value||Object(p.isCDSApiId)(n.connector.value)||!r)return null;var m=e.Model.Solutions.Components.EnvironmentVariable.Panel,b=Object(l.getConnectionsOptions)(r,m.DataSource.Connection.newConnection,n.connector.value),g=Object(c.getMultiConnectionsPickerStyles)().connectionReferenceDropdownStyles;return o.createElement(i.Dropdown,{options:b,label:m.DataSource.Connection.label,required:!0,placeholder:m.DataSource.Connection.placeholder,role:"listbox",onRenderOption:(e,o)=>Object(l.onRenderDropdownOptions)(e,o,t.name,!1,n.connector.value,s.PortalScope,a,m.DataSource.Connection.Errors.connectionErrorCantSignIn),styles:y(y({},g),{},{label:{fontWeight:"500",marginTop:"16px"}}),errorMessage:null===(u=n.connection)||void 0===u?void 0:u.getErrorMessage(n.connection.value),selectedKey:null===(d=n.connection.value)||void 0===d?void 0:d.name,onChange:(e,t)=>{var o;n.connection.setValue(null==t||null===(o=t.data)||void 0===o?void 0:o.connection)},disabled:n.connection.isDisabled})}(t,n,g,S.connectionsData.connections,f),h)}},6413:function(e,t,n){"use strict";n.r(t),n.d(t,"renderSharePointSections",(function(){return p})),n.d(t,"renderSharePointValueSections",(function(){return u}));var o=n(245),r=n(6393),a=n(6414),i=n(1567),s=n(1452),l=n(2903),c=n(6415);function p(e,t,n,c,p){return n||e.isEdit?o.createElement(o.Fragment,null,function(e,t){var n=e.Model.Solutions.Components.EnvironmentVariable.Panel.DataSource.SharePoint,a=[{key:"dataset",text:n.ParameterType.site},{key:"table",text:n.ParameterType.list}];return o.createElement(i.Dropdown,{options:a,label:n.ParameterType.label,required:!0,placeholder:n.ParameterType.label,role:"listbox",disabled:t.sharePointParameterType.isDisabled,styles:r.environmentVariableDropdownStyles,errorMessage:t.sharePointParameterType.getErrorMessage(t.sharePointParameterType.value),selectedKey:t.sharePointParameterType.value,onChange:(e,n)=>{t.sharePointParameterType.setValue(null==n?void 0:n.key)}})}(t,c),function(e,t,n){var c;if(!t.sharePointParameterType.value||"dataset"===t.sharePointParameterType.value)return null;var p=e.Model.Solutions.Components.EnvironmentVariable.Panel.DataSource.SharePoint,u=[];null!=n&&n.length&&(u=u.concat(n.map(e=>({key:e.environmentvariabledefinitionid,text:e.displayname,data:{environmentVariableDefinition:e}}))));u.length||(u=[{key:"Header",text:p.SharePointList.noSiteVariables,itemType:s.SelectableOptionMenuItemType.Header}]);return o.createElement(i.Dropdown,{options:u,label:p.SharePointSite.label,required:!0,placeholder:p.SharePointSite.placeholder,role:"listbox",disabled:t.sharePointSite.isDisabled,styles:r.environmentVariableDropdownStyles,errorMessage:t.sharePointSite.getErrorMessage(t.sharePointSite.value),selectedKey:null===(c=t.sharePointSite.value)||void 0===c?void 0:c.environmentvariabledefinitionid,onChange:(e,n)=>{t.sharePointSite.setValue(null==n?void 0:n.data.environmentVariableDefinition)},onRenderOption:(e,t)=>e?"Header"===e.key?o.createElement("div",{className:Object(l.css)(a.dataSourceEnvironmentVariableStyleClasses.dataSourceParentDropdownEmptyState)},t(e)):t(e):null})}(t,c,p)):null}function u(e,t,n,o,r,a){if(n.sharePointParameterType.value){var i="dataset"===n.sharePointParameterType.value;if(i||n.sharePointSite.value){var s=t.Model.Solutions.Components.EnvironmentVariable.Panel.DataSource.SharePoint,{sharePointValuesData:l,sharePointListVariableChildren:p}=a;return{labels:{currentValueHeaderText:i?s.SharePointSite.CurrentValue.label:s.SharePointList.CurrentValue.label,currentValueNewValueHeaderText:i?s.SharePointSite.CurrentValue.newValue:s.SharePointList.CurrentValue.newValue,currentValueAdditionalValueHeaderText:i?s.SharePointSite.CurrentValue.currentSite:s.SharePointList.CurrentValue.currentList,showDefaultValueText:s.SharePointSite.DefaultValue.showDefaultValue,defaultValueLabelText:i?s.SharePointSite.DefaultValue.label:s.SharePointList.DefaultValue.label},renderValueField:e=>Object(c.renderDataSourceValueField)(t,l.items,n,e,o,p),onDeleteComponentClick:()=>{null!=p&&p.length?r({onDelete:()=>e.onDeleteComponentClick(e.environmentVariableValueComponent,e.solution.id)}):e.onDeleteComponentClick(e.environmentVariableValueComponent,e.solution.id)}}}}}},6414:function(e,t,n){"use strict";n.r(t),n.d(t,"dataSourceEnvironmentVariableStyleClasses",(function(){return a})),n.d(t,"dataSourceParentChangeConfirmationItemIconStyles",(function(){return i})),n.d(t,"dataSourceValueComboBoxStyles",(function(){return s}));var o=n(3328),r=n(5617),a=Object(o.mergeStyleSets)({dataSourceParentDropdownEmptyState:{selectors:{"> span":{color:r.fabricTheme.palette.themePrimary}}},dataSourceParentChangeConfirmationItem:{marginBottom:"8px",height:"22px"},dataSourceParentChangeConfirmationItemText:{marginLeft:"8px"}}),i={root:{margin:0}},s={optionsContainerWrapper:{maxWidth:500,minWidth:100}}},6415:function(e,t,n){"use strict";n.r(t),n.d(t,"renderDataSourceValueSections",(function(){return b})),n.d(t,"renderDataSourceValueField",(function(){return g}));var o=n(6396),r=n(245),a=n(6393),i=n(6414),s=n(2903),l=n(2847),c=n(1447),p=n(6416);function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){m(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function b(e,t,n,i,c,u,d,m,b,g,y,S){var{labels:f,renderValueField:h,onDeleteComponentClick:O}=S;return r.createElement("div",null,Object(p.renderCurrentValueField)(e,t,n,i,m,b,g,y,{headerText:f.currentValueHeaderText,newValueHeaderText:f.currentValueNewValueHeaderText,headerClassName:a.environmentVariableStyleClasses.fieldSection,subHeaderClassName:Object(s.css)(a.environmentVariableStyleClasses.fieldSubHeader,a.environmentVariableStyleClasses.fieldDataSourceSubHeader),additionalValueHeaderText:f.currentValueAdditionalValueHeaderText},O,h(o.EnvironmentVariablePanelFormKeys.currentValue)),r.createElement(l.Accordion,{text:f.showDefaultValueText,styles:a.defaultValueAccordionStyles,onRenderContent:()=>r.createElement(r.Fragment,null,Object(p.renderDefaultValueField)(t,c,u,d,{defaultValueLabelText:f.defaultValueLabelText},h(o.EnvironmentVariablePanelFormKeys.defaultvalue)))}))}function g(e,t,n,a,s,l){var p,u,m=e.Model.Solutions.Components.EnvironmentVariable.Panel,b=a===o.EnvironmentVariablePanelFormKeys.defaultvalue?n.defaultValue.value:null===(p=n.currentValue.value)||void 0===p?void 0:p.value,g=(null===(u=t.find(e=>e.key===b))||void 0===u?void 0:u.text)||b;return r.createElement(c.ComboBox,{allowFreeform:!0,autoComplete:"on",options:t,styles:i.dataSourceValueComboBoxStyles,ariaLabel:a===o.EnvironmentVariablePanelFormKeys.defaultvalue?m.DefaultValue.label:m.CurrentValue.label,role:"combobox",disabled:a===o.EnvironmentVariablePanelFormKeys.defaultvalue?n.defaultValue.isDisabled:n.currentValue.isDisabled,text:g,onChange:(e,t,r,i)=>{var c=(null==t?void 0:t.key)||i;a===o.EnvironmentVariablePanelFormKeys.defaultvalue?n.defaultValue.setValue(c):(null!=l&&l.length&&s&&s({previousParentSelection:n.currentValue.value}),n.currentValue.setValue(d(d({},n.currentValue),{},{value:c})))}})}},6416:function(e,t,n){"use strict";n.r(t),n.d(t,"renderValueSections",(function(){return j})),n.d(t,"renderCurrentValueField",(function(){return A})),n.d(t,"renderDefaultValueField",(function(){return R}));var o=n(6395),r=n(6396),a=n(245),i=n(1697),s=n(684),l=n(2879),c=n(6393),p=n(5608),u=n(6406),d=n(2903),m=n(1567),b=n(1429),g=n(6398),y=n(6413),S=n(6417),f=n(6418),h=n(6415),O=n(2882),C=n(6419),v=n(6420);function P(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?P(Object(n),!0).forEach((function(t){T(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function T(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function j(e,t,n,o,i,s,l,u,m,b,O,P,E,T){if(o.type.value==p.EnvironmentVariableDefinitionTypeEnum.ConnectionReference){var j;return Object(g.isSharePointApiId)(o.connector.value)?j=Object(y.renderSharePointValueSections)(e,t,o,E,T,i.sharePointData):Object(g.isSQLApiId)(o.connector.value)?j=Object(S.renderSQLValueSections)(e,t,o,E,T,i.sqlData):Object(g.isCDSApiId)(o.connector.value)&&(j=Object(f.renderCDSValueSections)(e,t,o,i.cdsData)),j?(r=>Object(h.renderDataSourceValueSections)(e,t,n,o,s,l,u,m,b,O,P,r))(j):a.createElement(a.Fragment,null)}if(o.type.value==p.EnvironmentVariableDefinitionTypeEnum.Secret&&o.secretStore.value==g.IEnvironmentVariableSecretStores.KeyVault){return(r=>Object(C.renderSecretValueSections)(e,t,n,o,s,l,u,m,b,O,P,r))(Object(v.renderKeyVaultSecretValueSections)(e,t,o,E,T))}return a.createElement(a.Fragment,null,function(e,t,n,o,i,s,l,p,u,m,b){var g=t.Model.Solutions.Components.EnvironmentVariable.Panel;if(e.isEdit||o.type.value)return a.createElement("div",null,R(t,i,s,l,{defaultValueLabelText:g.DefaultValue.label},I(t,o,r.EnvironmentVariablePanelFormKeys.defaultvalue)),A(e,t,n,o,p,u,m,b,{headerText:g.CurrentValue.label,newValueHeaderText:g.CurrentValue.newValue,headerClassName:Object(d.css)(c.environmentVariableStyleClasses.fieldSection,c.environmentVariableStyleClasses.currentValueFieldHeader),subHeaderClassName:Object(d.css)(c.environmentVariableStyleClasses.fieldSubHeader,c.environmentVariableStyleClasses.fieldStandardSubHeader)},()=>e.onDeleteComponentClick(e.environmentVariableValueComponent,e.solution.id),I(t,o,r.EnvironmentVariablePanelFormKeys.currentValue)));return null}(e,t,n,o,s,l,u,m,b,O,P))}function A(e,t,n,o,r,p,d,m,b,g,y){var S=t.Model.Solutions.Components.EnvironmentVariable.Panel;return!Object(u.shouldShowCurrentValueInput)(e,r)&&e.solution.isManaged?a.createElement(a.Fragment,null):a.createElement(a.Fragment,null,a.createElement("div",{className:b.headerClassName},a.createElement("div",{className:c.environmentVariableStyleClasses.fieldHeader},a.createElement("label",null,b.headerText)),a.createElement("div",{className:b.subHeaderClassName},a.createElement("span",null,S.CurrentValue.subheader))),!Object(u.shouldShowCurrentValueInput)(e,r)&&Object(u.shouldShowNewCurrentValueButton)(e)&&a.createElement(s.ActionButton,{iconProps:{iconName:l.fabricIcons.Add},onClick:()=>{e.clearResponses(),p(!0)}},b.newValueHeaderText),!Object(u.shouldShowCurrentValueInput)(e,r)&&!Object(u.shouldShowNewCurrentValueButton)(e)&&a.createElement("div",null,a.createElement(i.MessageBar,{messageBarType:i.MessageBarType.info,styles:{root:{marginTop:"8px"}}},S.CurrentValue.addExistingWarning),a.createElement(s.ActionButton,{iconProps:{iconName:l.fabricIcons.Add},onClick:()=>{var t;(e.clearResponses(),e.fetchEnvironmentVariableValue)&&e.fetchEnvironmentVariableValue(null===(t=e.solution)||void 0===t?void 0:t.id,e.definitionId,n);m(!0),o.currentValue.setValue(e.valuesNotInSolution[0]),p(!0)}},S.CurrentValue.addExisting)),Object(u.shouldShowCurrentValueInput)(e,r)&&a.createElement(a.Fragment,null,b.additionalValueHeaderText&&a.createElement("div",{className:c.environmentVariableStyleClasses.fieldHeader},a.createElement("label",null,b.additionalValueHeaderText)),a.createElement("div",{className:e.isEdit&&e.environmentVariableValueComponent&&!d?c.environmentVariableStyleClasses.editCurrentValueFieldInputWrapper:void 0},y,e.isEdit&&e.environmentVariableValueComponent&&!d&&a.createElement(s.IconButton,{className:c.environmentVariableStyleClasses.moreButton,iconProps:{iconName:l.fabricIcons.More},menuIconProps:{iconName:l.fabricIcons.None},styles:{icon:{paddingLeft:"8px",margin:"0"},menuIcon:{width:"0",padding:"0"}},menuProps:{items:[{key:"Remove",text:t.Model.Solutions.Components.Commands.removeSubmenu,onClick:()=>e.onRemoveComponentClick(e.environmentVariableValueComponent,e.solution)},{key:"Delete",text:t.Model.Solutions.Components.Commands.Delete,onClick:()=>g()}]},disabled:!!e.isValueEditOnly||e.solution.isManaged})),e.isEdit&&e.environmentVariableValueComponent&&!d&&!e.solution.isManaged&&a.createElement(i.MessageBar,{messageBarType:i.MessageBarType.info,styles:{root:{marginTop:"8px"}}},S.CurrentValue.warning)))}function R(e,t,n,o,i,p){var d=e.Model.Solutions.Components.EnvironmentVariable.Panel;return a.createElement(a.Fragment,null,a.createElement("div",{className:c.environmentVariableStyleClasses.fieldSection},a.createElement("div",{className:c.environmentVariableStyleClasses.fieldHeader},a.createElement("label",null,i.defaultValueLabelText),a.createElement("span",{className:c.environmentVariableStyleClasses.fieldIcon,ref:t[r.EnvironmentVariablePanelFormKeys.defaultvalue]},a.createElement(s.IconButton,{onClick:()=>Object(u.onToggleVisibilityClicked)(r.EnvironmentVariablePanelFormKeys.defaultvalue,n,o),style:{color:O.fabricColors.accentGray},iconProps:{iconName:l.fabricIcons.Info},title:d.Generic.calloutTooltip,ariaLabel:d.Generic.calloutTooltip})))),p)}function I(e,t,n){var i=e.Model.Solutions.Components.EnvironmentVariable.Panel,s=n===r.EnvironmentVariablePanelFormKeys.defaultvalue?i.DefaultValue.label:i.CurrentValue.label;if(t.type.value===p.EnvironmentVariableDefinitionTypeEnum.Boolean){var l,c=n===r.EnvironmentVariablePanelFormKeys.defaultvalue?t.defaultValueTwoOptions:t.currentValue;return a.createElement(m.Dropdown,{options:[{key:o.TwoOptionVariableTypes.yes,text:i.DefaultValue.yes},{key:o.TwoOptionVariableTypes.no,text:i.DefaultValue.no}],ariaLabel:s,role:"combobox",disabled:c.isDisabled,selectedKey:n===r.EnvironmentVariablePanelFormKeys.defaultvalue?t.defaultValueTwoOptions.value:null===(l=t.currentValue.value)||void 0===l?void 0:l.value,onChange:(e,o)=>{n===r.EnvironmentVariablePanelFormKeys.defaultvalue?t.defaultValueTwoOptions.setValue(null==o?void 0:o.key):t.currentValue.setValue(E(E({},t.currentValue),{},{value:null==o?void 0:o.key}))}})}var u,d=n===r.EnvironmentVariablePanelFormKeys.defaultvalue?t.defaultValue:t.currentValue;return a.createElement(b.TextField,{disabled:d.isDisabled,ariaLabel:s,value:n===r.EnvironmentVariablePanelFormKeys.defaultvalue?t.defaultValue.value:null===(u=t.currentValue.value)||void 0===u?void 0:u.value,onChange:(e,o)=>{n===r.EnvironmentVariablePanelFormKeys.defaultvalue?t.defaultValue.setValue(o):t.currentValue.setValue(E(E({},t.currentValue),{},{value:o}))},errorMessage:n===r.EnvironmentVariablePanelFormKeys.defaultvalue?t.defaultValue.getErrorMessage(t.defaultValue.value):t.currentValue.getErrorMessage(t.currentValue.value)})}},6417:function(e,t,n){"use strict";n.r(t),n.d(t,"renderSQLSections",(function(){return p})),n.d(t,"renderSQLValueSections",(function(){return u}));var o=n(245),r=n(6393),a=n(6414),i=n(1567),s=n(1452),l=n(2903),c=n(6415);function p(e,t,n,c,p){return n||e.isEdit?o.createElement(o.Fragment,null,function(e,t){var n=e.Model.Solutions.Components.EnvironmentVariable.Panel.DataSource.SQL,a=[{key:"dataset",text:n.ParameterType.server},{key:"table",text:n.ParameterType.database}];return o.createElement(i.Dropdown,{options:a,label:n.ParameterType.label,required:!0,placeholder:n.ParameterType.label,role:"listbox",disabled:t.sqlParameterType.isDisabled,styles:r.environmentVariableDropdownStyles,errorMessage:t.sqlParameterType.getErrorMessage(t.sqlParameterType.value),selectedKey:t.sqlParameterType.value,onChange:(e,n)=>{t.sqlParameterType.setValue(null==n?void 0:n.key)}})}(t,c),function(e,t,n){var c;if(!t.sqlParameterType.value||"table"!==t.sqlParameterType.value)return null;var p=e.Model.Solutions.Components.EnvironmentVariable.Panel.DataSource.SQL,u=[];null!=n&&n.length&&(u=u.concat(n.map(e=>({key:e.environmentvariabledefinitionid,text:e.displayname,data:{environmentVariableDefinition:e}}))));u.length||(u=[{key:"Header",text:p.SQLDatabase.noServerVariables,itemType:s.SelectableOptionMenuItemType.Header}]);return o.createElement(i.Dropdown,{options:u,label:p.SQLServer.label,required:!0,placeholder:p.SQLServer.placeholder,role:"listbox",disabled:t.sqlServer.isDisabled,styles:r.environmentVariableDropdownStyles,errorMessage:t.sqlServer.getErrorMessage(t.sqlServer.value),selectedKey:null===(c=t.sqlServer.value)||void 0===c?void 0:c.environmentvariabledefinitionid,onChange:(e,n)=>{t.sqlServer.setValue(null==n?void 0:n.data.environmentVariableDefinition)},onRenderOption:(e,t)=>e?"Header"===e.key?o.createElement("div",{className:Object(l.css)(a.dataSourceEnvironmentVariableStyleClasses.dataSourceParentDropdownEmptyState)},t(e)):t(e):null})}(t,c,p)):null}function u(e,t,n,o,r,a){if(n.sqlParameterType.value){var i="dataset"===n.sqlParameterType.value;if(i||n.sqlServer.value){var s=t.Model.Solutions.Components.EnvironmentVariable.Panel.DataSource.SQL,{sqlValuesData:l,sqlDatabaseVariableChildren:p}=a;return{labels:{currentValueHeaderText:i?s.SQLServer.CurrentValue.label:s.SQLDatabase.CurrentValue.label,currentValueNewValueHeaderText:i?s.SQLServer.CurrentValue.newValue:s.SQLDatabase.CurrentValue.newValue,currentValueAdditionalValueHeaderText:i?s.SQLServer.CurrentValue.currentServer:s.SQLDatabase.CurrentValue.currentDatabase,showDefaultValueText:s.SQLServer.DefaultValue.showDefaultValue,defaultValueLabelText:i?s.SQLServer.DefaultValue.label:s.SQLDatabase.DefaultValue.label},renderValueField:e=>Object(c.renderDataSourceValueField)(t,l.items,n,e,o,p),onDeleteComponentClick:()=>{null!=p&&p.length?r({onDelete:()=>e.onDeleteComponentClick(e.environmentVariableValueComponent,e.solution.id)}):e.onDeleteComponentClick(e.environmentVariableValueComponent,e.solution.id)}}}}}},6418:function(e,t,n){"use strict";n.r(t),n.d(t,"renderCDSValueSections",(function(){return r}));var o=n(6415);function r(e,t,n,r){var a=t.Model.Solutions.Components.EnvironmentVariable.Panel.DataSource.Dataverse;return{labels:{currentValueHeaderText:a.DataverseEnvironment.CurrentValue.label,currentValueNewValueHeaderText:a.DataverseEnvironment.CurrentValue.newValue,currentValueAdditionalValueHeaderText:a.DataverseEnvironment.CurrentValue.currentEnvironment,showDefaultValueText:a.DataverseEnvironment.DefaultValue.showDefaultValue,defaultValueLabelText:a.DataverseEnvironment.DefaultValue.label},renderValueField:e=>function(e,t,n,r){var{cdsEnvironmentsData:a}=r;return Object(o.renderDataSourceValueField)(e,a.items,t,n)}(t,n,e,r),onDeleteComponentClick:()=>e.onDeleteComponentClick(e.environmentVariableValueComponent,e.solution.id)}}},6419:function(e,t,n){"use strict";n.r(t),n.d(t,"renderSecretValueSections",(function(){return c}));var o=n(6396),r=n(245),a=n(6393),i=n(2903),s=n(2847),l=n(6416);function c(e,t,n,c,p,u,d,m,b,g,y,S){var{labels:f,renderValueField:h,onDeleteComponentClick:O}=S;return r.createElement("div",null,Object(l.renderCurrentValueField)(e,t,n,c,m,b,g,y,{headerText:f.currentValueHeaderText,newValueHeaderText:f.currentValueNewValueHeaderText,headerClassName:a.environmentVariableStyleClasses.fieldSection,subHeaderClassName:Object(i.css)(a.environmentVariableStyleClasses.fieldSubHeader,a.environmentVariableStyleClasses.fieldDataSourceSubHeader),additionalValueHeaderText:f.currentValueAdditionalValueHeaderText},O,h(o.EnvironmentVariablePanelFormKeys.currentValue)),r.createElement(s.Accordion,{text:f.showDefaultValueText,styles:a.defaultValueAccordionStyles,onRenderContent:()=>r.createElement(r.Fragment,null,Object(l.renderDefaultValueField)(t,p,u,d,{defaultValueLabelText:f.defaultValueLabelText},h(o.EnvironmentVariablePanelFormKeys.defaultvalue)))}))}},6420:function(e,t,n){"use strict";n.r(t),n.d(t,"renderKeyVaultSecretValueSections",(function(){return d})),n.d(t,"setDefaultValue",(function(){return b})),n.d(t,"setCurrentValue",(function(){return g}));var o=n(245),r=n(1429),a=n(6396),i=n(1089),s=n(2830),l=n(6393);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e,t,n,i,s){var c=t.Model.Solutions.Components.EnvironmentVariable.Panel.Secret.KeyVault;return{labels:{currentValueHeaderText:c.CurrentValue.label,currentValueNewValueHeaderText:c.CurrentValue.newValue,currentValueAdditionalValueHeaderText:c.CurrentValue.newValue,showDefaultValueText:c.DefaultValue.showDefaultValue,defaultValueLabelText:c.DefaultValue.label},renderValueField:e=>function(e,t,n){var i,s,c,p,u,d,m,y,S=e.Model.Solutions.Components.EnvironmentVariable.Panel.Secret.KeyVault,f=n===a.EnvironmentVariablePanelFormKeys.defaultvalue?t.defaultValue:t.currentValue;return o.createElement(o.Fragment,null,o.createElement("div",{className:l.environmentVariableStyleClasses.fieldHeader},o.createElement("label",null,S.Value.subscriptionId)),o.createElement(r.TextField,{disabled:f.isDisabled,value:n===a.EnvironmentVariablePanelFormKeys.defaultvalue?null===(i=t.defaultSubscriptionId)||void 0===i?void 0:i.value:null===(s=t.currentSubscriptionId)||void 0===s?void 0:s.value,onChange:(e,o)=>{n===a.EnvironmentVariablePanelFormKeys.defaultvalue?b(t.defaultSubscriptionId,t,o):g(t.currentSubscriptionId,t,o)},errorMessage:n===a.EnvironmentVariablePanelFormKeys.defaultvalue?t.defaultSubscriptionId.getErrorMessage(t.defaultSubscriptionId.value):t.currentSubscriptionId.getErrorMessage(t.currentSubscriptionId.value)}),o.createElement("div",{className:l.environmentVariableStyleClasses.fieldHeader},o.createElement("label",null,S.Value.resourceGroupName)),o.createElement(r.TextField,{disabled:f.isDisabled,value:n===a.EnvironmentVariablePanelFormKeys.defaultvalue?null===(c=t.defaultResourceGroupName)||void 0===c?void 0:c.value:null===(p=t.currentResourceGroupName)||void 0===p?void 0:p.value,onChange:(e,o)=>{n===a.EnvironmentVariablePanelFormKeys.defaultvalue?b(t.defaultResourceGroupName,t,o):g(t.currentResourceGroupName,t,o)},errorMessage:n===a.EnvironmentVariablePanelFormKeys.defaultvalue?t.defaultResourceGroupName.getErrorMessage(t.defaultResourceGroupName.value):t.currentResourceGroupName.getErrorMessage(t.currentResourceGroupName.value)}),o.createElement("div",{className:l.environmentVariableStyleClasses.fieldHeader},o.createElement("label",null,S.Value.keyVaultName)),o.createElement(r.TextField,{disabled:f.isDisabled,value:n===a.EnvironmentVariablePanelFormKeys.defaultvalue?null===(u=t.defaultKeyVaultName)||void 0===u?void 0:u.value:null===(d=t.currentKeyVaultName)||void 0===d?void 0:d.value,onChange:(e,o)=>{n===a.EnvironmentVariablePanelFormKeys.defaultvalue?b(t.defaultKeyVaultName,t,o):g(t.currentKeyVaultName,t,o)},errorMessage:n===a.EnvironmentVariablePanelFormKeys.defaultvalue?t.defaultKeyVaultName.getErrorMessage(t.defaultKeyVaultName.value):t.currentKeyVaultName.getErrorMessage(t.currentKeyVaultName.value)}),o.createElement("div",{className:l.environmentVariableStyleClasses.fieldHeader},o.createElement("label",null,S.Value.secretName)),o.createElement(r.TextField,{disabled:f.isDisabled,value:n===a.EnvironmentVariablePanelFormKeys.defaultvalue?null===(m=t.defaultSecretName)||void 0===m?void 0:m.value:null===(y=t.currentSecretName)||void 0===y?void 0:y.value,onChange:(e,o)=>{n===a.EnvironmentVariablePanelFormKeys.defaultvalue?b(t.defaultSecretName,t,o):g(t.currentSecretName,t,o)},errorMessage:n===a.EnvironmentVariablePanelFormKeys.defaultvalue?t.defaultSecretName.getErrorMessage(t.defaultSecretName.value):t.currentSecretName.getErrorMessage(t.currentSecretName.value)}))}(t,n,e),onDeleteComponentClick:()=>e.onDeleteComponentClick(e.environmentVariableValueComponent,e.solution.id)}}var m="/subscriptions/{0}/resourceGroups/{1}/providers/Microsoft.KeyVault/vaults/{2}/secrets/{3}",b=(e,t,n)=>{var o,r,a,l;e.setValue(n);var c=e===t.defaultSubscriptionId?n:null===(o=t.defaultSubscriptionId)||void 0===o?void 0:o.value,p=e===t.defaultResourceGroupName?n:null===(r=t.defaultResourceGroupName)||void 0===r?void 0:r.value,u=e===t.defaultKeyVaultName?n:null===(a=t.defaultKeyVaultName)||void 0===a?void 0:a.value,d=e===t.defaultSecretName?n:null===(l=t.defaultSecretName)||void 0===l?void 0:l.value;t.type.value===s.EnvironmentVariableDefinitionTypeEnum.Secret&&(c&&p&&u&&d?t.defaultValue.setValue(Object(i.formatResourceString)(m,c,p,u,d)):t.defaultValue.setValue(""))},g=(e,t,n)=>{var o,r,a,l;e.setValue(n);var c,u,d,b,g=e===t.currentSubscriptionId?n:null===(o=t.currentSubscriptionId)||void 0===o?void 0:o.value,y=e===t.currentResourceGroupName?n:null===(r=t.currentResourceGroupName)||void 0===r?void 0:r.value,S=e===t.currentKeyVaultName?n:null===(a=t.currentKeyVaultName)||void 0===a?void 0:a.value,f=e===t.currentSecretName?n:null===(l=t.currentSecretName)||void 0===l?void 0:l.value;t.type.value===s.EnvironmentVariableDefinitionTypeEnum.Secret&&(g&&y&&S&&f?t.currentValue.setValue(p(p({},t.currentValue),{},{value:Object(i.formatResourceString)(m,e===t.currentSubscriptionId?n:null===(c=t.currentSubscriptionId)||void 0===c?void 0:c.value,e===t.currentResourceGroupName?n:null===(u=t.currentResourceGroupName)||void 0===u?void 0:u.value,e===t.currentKeyVaultName?n:null===(d=t.currentKeyVaultName)||void 0===d?void 0:d.value,e===t.currentSecretName?n:null===(b=t.currentSecretName)||void 0===b?void 0:b.value)})):t.currentValue.setValue(p(p({},t.currentValue),{},{value:""})))}},6421:function(e,t,n){"use strict";n.r(t),n.d(t,"renderSecretSections",(function(){return p}));var o=n(245),r=n(6393),a=n(5608),i=n(1567),s=n(1090),l=n(6398),c=n(5481);function p(e,t,n,p,u){return n.type.value!==a.EnvironmentVariableDefinitionTypeEnum.Secret?null:o.createElement(o.Fragment,null,function(e,t){var n=e.Model.Solutions.Components.EnvironmentVariable.Panel,a=[{key:l.IEnvironmentVariableSecretStores.KeyVault,text:n.Secret.SecretStore.keyVault}];return o.createElement(o.Fragment,null,o.createElement("p",null,o.createElement(s.Link,{href:c.default.environmentVariableSecretsLearnMoreLink,target:"_blank",className:r.environmentVariableStyleClasses.learnMoreLink},n.Secret.learnMore)),o.createElement(i.Dropdown,{options:a,label:n.Secret.SecretStore.label,required:!0,placeholder:n.Secret.SecretStore.placeholder,role:"listbox",disabled:t.secretStore.isDisabled,styles:r.environmentVariableDropdownStyles,errorMessage:t.secretStore.getErrorMessage(t.secretStore.value),selectedKey:t.secretStore.value,onChange:(e,n)=>{t.secretStore.setValue(null==n?void 0:n.key)}}))}(t,n))}},6422:function(e,t,n){"use strict";n.r(t),n.d(t,"useEnvironmentVariableQueries",(function(){return u}));var o=n(6423),r=n(6431),a=n(6433),i=n(6437),s=n(6439);function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){p(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e,t,n,l){var p=Object(s.useStandardQueryStatus)(e,l),u=Object(i.useEnvironmentVariableConnections)(t,n,l),{sharePointQueryResults:d,onSetEnvironmentVariableDefinitionForSharePointQueryData:m}=Object(o.useSharePointQuery)(t,n,l),{sqlQueryResults:b,onSetEnvironmentVariableDefinitionForSQLQueryData:g}=Object(r.useSQLQuery)(t,n,l),y=Object(a.useCDSQuery)(t,n,l);return{queryStatus:c(c(c(c(c({},p),u.queryStatus),d.queryStatus),b.queryStatus),y.queryStatus),queryData:{connectionsData:u.queryData,sharePointData:d.queryData,sqlData:b.queryData,cdsData:y.queryData},onSetEnvironmentVariableDefinitionForQueryData:e=>{m(e),g(e)}}}},6423:function(e,t,n){"use strict";n.r(t),n.d(t,"useSharePointQuery",(function(){return d}));var o=n(2830),r=n(6398),a=n(245),i=n(2807),s=n(6424),l=n(6426),c=n(2868),p=n(6428),u=n(6429);function d(e,t,n){var d,b,g,y,S,f,h,O,C,v,[P,E]=Object(a.useState)(void 0),[T,j]=Object(a.useState)(!1),[A,R]=Object(a.useState)(void 0),[I,w]=Object(a.useState)(void 0),[D,N]=Object(a.useState)(!1),[L,M]=Object(a.useState)(void 0),x=null===(d=e.connection.value)||void 0===d?void 0:d.primaryRuntimeUrl,k=null===(b=e.connection.value)||void 0===b?void 0:b.iconUri,F=null===(g=e.connection.value)||void 0===g?void 0:g.apiDisplayName,{datasets:_,loading:U,errorMessage:V}=Object(s.useDatasetsQuery)(t,{primaryRuntimeUrl:x,connectionName:null===(y=e.connection.value)||void 0===y?void 0:y.name},i.PortalScope,n.Common.Request.Failed,e.connector.value!==r.IEnvironmentVariableConnectors.SharePoint),B=_?_.map(e=>({key:e.id,text:e.displayName||e.id,data:{iconUri:k,subtitle:e.id,iconTitle:F}})):[],H="";if(null!==(S=e.sharePointSite.value)&&void 0!==S&&null!==(f=S.environmentvariabledefinition_environmentvariablevalue)&&void 0!==f&&f.length)H=null===(v=e.sharePointSite.value)||void 0===v?void 0:v.environmentvariabledefinition_environmentvariablevalue[0].value;else if(null!==(h=e.sharePointSite)&&void 0!==h&&null!==(O=h.value)&&void 0!==O&&O.defaultvalue){var G,W;H=null===(G=e.sharePointSite)||void 0===G||null===(W=G.value)||void 0===W?void 0:W.defaultvalue}var{tables:q,errorMessage:z,loading:Q,hasConnectionMismatch:K}=Object(l.useTablesQuery)(t,{primaryRuntimeUrl:x,connectionName:null===(C=e.connection.value)||void 0===C?void 0:C.name,datasetUrl:H,fetchAllTables:!0},i.PortalScope,n.Common.Request.Failed,e.connector.value!==r.IEnvironmentVariableConnectors.SharePoint),Y=m(e,t,n),J={items:B,isQueryLoading:U,queryError:V},X={items:!z&&q?q.map(e=>({key:e.id,text:e.displayName,data:{iconUri:k,subtitle:e.id,iconTitle:F}})):[],isQueryLoading:Q,queryError:z},Z="dataset"===e.sharePointParameterType.value?J:X,$={sharePointSiteVariables:P,sharePointListVariableChildren:I,isLoadingSharePointSiteVariables:T,isLoadingSharePointListVariableChildren:D,sharePointSiteVariablesError:A,sharePointListVariableChildrenError:L,sharePointSitesData:J,sharePointListsData:X,hasConnectionMismatch:"dataset"===e.sharePointParameterType.value?Y:Object(u.checkForTablesConnectionMismatch)(K,z,e,X)};return{sharePointQueryResults:{queryStatus:Object(p.useSharePointQueryStatus)(n,e,e.connector.value,$),queryData:{sharePointValuesData:Z,sharePointSiteVariables:P,sharePointListVariableChildren:I,hasConnectionMismatch:$.hasConnectionMismatch}},onSetEnvironmentVariableDefinitionForSharePointQueryData:t=>{j(!0);var n=c.MetadataClientInstance.getInstance();if(n.fetchList("EnvironmentVariableDefinition",void 0,{expand:{environmentvariabledefinition_environmentvariablevalue:{}},filter:"(type eq ".concat(o.EnvironmentVariableDefinitionTypeEnum.ConnectionReference,") and (apiid eq '").concat(r.IEnvironmentVariableConnectors.SharePoint,"') and (parameterkey eq 'dataset')")}).then(n=>{var a=n.data;E(a),j(!1),e.type.value===o.EnvironmentVariableDefinitionTypeEnum.ConnectionReference&&Object(r.isSharePointApiId)(e.connector.value)&&"table"===e.sharePointParameterType.value&&null!=t&&t._parentdefinitionid_value&&e.sharePointSite.setValue(a.find(e=>e.environmentvariabledefinitionid===t._parentdefinitionid_value),!0)}).catch(e=>{R(e),j(!1)}),null==t||!t.environmentvariabledefinitionid)return w([]),void N(!1);N(!0),n.fetchList("EnvironmentVariableDefinition",void 0,{expand:{environmentvariabledefinition_environmentvariablevalue:{}},filter:"(type eq ".concat(o.EnvironmentVariableDefinitionTypeEnum.ConnectionReference,") and (apiid eq '").concat(r.IEnvironmentVariableConnectors.SharePoint,"') and (parameterkey eq 'table') and (_parentdefinitionid_value eq '").concat(t.environmentvariabledefinitionid,"')")}).then(e=>{var t=e.data;w(t),N(!1)}).catch(e=>{M(e),N(!1)})}}}var m=(e,t,n)=>{var o,a,s,c,p,u=e.defaultValue.value,{errorMessage:d,loading:m}=Object(l.useTablesQuery)(t,{primaryRuntimeUrl:null===(o=e.connection.value)||void 0===o?void 0:o.primaryRuntimeUrl,connectionName:null===(a=e.connection.value)||void 0===a?void 0:a.name,datasetUrl:u,fetchAllTables:!0},i.PortalScope,n.Common.Request.Failed,e.connector.value!==r.IEnvironmentVariableConnectors.SharePoint),b=!!u&&!m&&!!d,g=null===(s=e.currentValue.value)||void 0===s?void 0:s.value,{errorMessage:y,loading:S}=Object(l.useTablesQuery)(t,{primaryRuntimeUrl:null===(c=e.connection.value)||void 0===c?void 0:c.primaryRuntimeUrl,connectionName:null===(p=e.connection.value)||void 0===p?void 0:p.name,datasetUrl:g,fetchAllTables:!0},i.PortalScope,n.Common.Request.Failed,e.connector.value!==r.IEnvironmentVariableConnectors.SharePoint);return b||!!g&&!S&&!!y}},6428:function(e,t,n){"use strict";n.r(t),n.d(t,"useSharePointQueryStatus",(function(){return a}));var o=n(6398),r=n(3815);function a(e,t,n,a){var i=e.Model.Solutions.Components.EnvironmentVariable.Panel,s=i.DataSource.SharePoint;return{fetchSharePointSites:{getErrorMessage:()=>{if(Object(o.isSharePointApiId)(n)&&"dataset"===t.sharePointParameterType.value)return a.hasConnectionMismatch?s.Error.siteNotFound:a.sharePointSitesData.queryError&&Object(r.formatString)(i.DataSource.SharePoint.Errors.sharePointSites,a.sharePointSitesData.queryError)},getIsLoading:()=>Object(o.isSharePointApiId)(n)&&"dataset"===t.sharePointParameterType.value&&a.sharePointSitesData.isQueryLoading&&s.SharePointSite.loading},fetchSharePointLists:{getErrorMessage:()=>{if(Object(o.isSharePointApiId)(n)&&"table"===t.sharePointParameterType.value){var e,l,c;if(t.sharePointSite.value)if(!(null!==(e=t.sharePointSite.value)&&void 0!==e&&e.environmentvariabledefinition_environmentvariablevalue.length&&t.sharePointSite.value.environmentvariabledefinition_environmentvariablevalue[0].value||null!==(l=t.sharePointSite)&&void 0!==l&&null!==(c=l.value)&&void 0!==c&&c.defaultvalue))return s.Error.noSharePointSiteFound;return a.hasConnectionMismatch?s.Error.listNotFound:a.sharePointListsData.queryError&&Object(r.formatString)(i.DataSource.SharePoint.Errors.sharePointLists,a.sharePointListsData.queryError)}},getIsLoading:()=>Object(o.isSharePointApiId)(n)&&"table"===t.sharePointParameterType.value&&a.sharePointListsData.isQueryLoading&&s.SharePointList.loading},fetchSharePointListChildren:{getErrorMessage:()=>Object(o.isSharePointApiId)(n)&&"dataset"===t.sharePointParameterType.value&&a.sharePointListVariableChildrenError&&Object(r.formatString)(i.DataSource.SharePoint.Errors.sharePointListChildren,a.sharePointListVariableChildrenError),getIsLoading:()=>Object(o.isSharePointApiId)(n)&&"dataset"===t.sharePointParameterType.value&&a.isLoadingSharePointListVariableChildren&&s.SharePointList.loading},fetchSharePointSiteVariables:{getErrorMessage:()=>Object(o.isSharePointApiId)(n)&&"table"===t.sharePointParameterType.value&&a.sharePointSiteVariablesError&&Object(r.formatString)(i.DataSource.SharePoint.Errors.sharePointSitesVariables,a.sharePointSiteVariablesError),getIsLoading:()=>Object(o.isSharePointApiId)(n)&&"table"===t.sharePointParameterType.value&&a.isLoadingSharePointSiteVariables&&s.SharePointSite.loading}}}},6429:function(e,t,n){"use strict";n.r(t),n.d(t,"checkForDatasetsConnectionMismatch",(function(){return r})),n.d(t,"checkForTablesConnectionMismatch",(function(){return a})),n.d(t,"checkForMissingCDSEnvironment",(function(){return i}));var o=n(6430);function r(e,t,n){var r,a=n&&n.items;return Object(o.hasMismatchedConnectionForDataset)(e,t.defaultValue.value,null===(r=t.currentValue.value)||void 0===r?void 0:r.value,a.map(e=>e.key))}function a(e,t,n,r){var a,i=r&&r.items;return Object(o.hasMismatchedConnectionForTable)(e,t,n.defaultValue.value,null===(a=n.currentValue.value)||void 0===a?void 0:a.value,i.map(e=>e.key))}function i(e,t,n){var r,a=n&&n.items;return Object(o.hasInaccessibleEnvironment)(e,t.defaultValue.value,null===(r=t.currentValue.value)||void 0===r?void 0:r.value,a.map(e=>e.key))}},6431:function(e,t,n){"use strict";n.r(t),n.d(t,"useSQLQuery",(function(){return d}));var o=n(2830),r=n(6398),a=n(245),i=n(2807),s=n(6424),l=n(6426),c=n(2868),p=n(6432),u=n(6429);function d(e,t,n){var d,m,b,g,y,S,f,h,[O,C]=Object(a.useState)(void 0),[v,P]=Object(a.useState)(!1),[E,T]=Object(a.useState)(void 0),[j,A]=Object(a.useState)(void 0),[R,I]=Object(a.useState)(!1),[w,D]=Object(a.useState)(void 0),N=null===(d=e.connection.value)||void 0===d?void 0:d.primaryRuntimeUrl,L=null===(m=e.connection.value)||void 0===m?void 0:m.iconUri,M=null===(b=e.connection.value)||void 0===b?void 0:b.apiDisplayName,{datasets:x,loading:k,errorMessage:F}=Object(s.useDatasetsQuery)(t,{primaryRuntimeUrl:N,connectionName:null===(g=e.connection.value)||void 0===g?void 0:g.name,isV2:!0},i.PortalScope,n.Common.Request.Failed,e.connector.value!==r.IEnvironmentVariableConnectors.SQL),_=x?x.map(e=>({key:e.id,text:e.displayName||e.id,data:{iconUri:L,subtitle:e.id,iconTitle:M}})):[],U="";null!==(y=e.sqlServer.value)&&void 0!==y&&null!==(S=y.environmentvariabledefinition_environmentvariablevalue)&&void 0!==S&&S.length&&(U=null===(h=e.sqlServer.value)||void 0===h?void 0:h.environmentvariabledefinition_environmentvariablevalue[0].value);var{tables:V,errorMessage:B,loading:H,hasConnectionMismatch:G}=Object(l.useTablesQuery)(t,{primaryRuntimeUrl:N,connectionName:null===(f=e.connection.value)||void 0===f?void 0:f.name,datasetUrl:U,isV2:!0},i.PortalScope,n.Common.Request.Failed,e.connector.value!==r.IEnvironmentVariableConnectors.SQL),W={items:_,isQueryLoading:k,queryError:F},q={items:!B&&V?V.map(e=>({key:e.id,text:e.displayName,data:{iconUri:L,subtitle:e.id,iconTitle:M}})):[],isQueryLoading:H,queryError:B},z="dataset"===e.sqlParameterType.value?W:q,Q={sqlServersData:W,sqlDatabasesData:q,isLoadingSQLServerVariables:v,isLoadingSQLDatabaseVariableChildren:R,sqlServerVariablesError:E,sqlDatabaseVariableChildrenError:w,sqlServerVariables:O,sqlDatabaseVariableChildren:j,hasConnectionMismatch:"dataset"===e.sqlParameterType.value?Object(u.checkForDatasetsConnectionMismatch)(F,e,W):Object(u.checkForTablesConnectionMismatch)(G,B,e,q)};return{sqlQueryResults:{queryStatus:Object(p.useSQLQueryStatus)(n,e,e.connector.value,Q),queryData:{sqlValuesData:z,sqlServerVariables:O,sqlDatabaseVariableChildren:j,hasConnectionMismatch:Q.hasConnectionMismatch}},onSetEnvironmentVariableDefinitionForSQLQueryData:t=>{P(!0);var n=c.MetadataClientInstance.getInstance();if(n.fetchList("EnvironmentVariableDefinition",void 0,{expand:{environmentvariabledefinition_environmentvariablevalue:{}},filter:"(type eq ".concat(o.EnvironmentVariableDefinitionTypeEnum.ConnectionReference,") and (apiid eq '").concat(r.IEnvironmentVariableConnectors.SQL,"') and (parameterkey eq 'dataset')")}).then(n=>{var a=n.data;C(a),P(!1),e.type.value===o.EnvironmentVariableDefinitionTypeEnum.ConnectionReference&&Object(r.isSQLApiId)(e.connector.value)&&"table"===e.sqlParameterType.value&&null!=t&&t._parentdefinitionid_value&&e.sqlServer.setValue(a.find(e=>e.environmentvariabledefinitionid===t._parentdefinitionid_value),!0)}).catch(e=>{T(e),P(!1)}),null==t||!t.environmentvariabledefinitionid)return A([]),void I(!1);I(!0),n.fetchList("EnvironmentVariableDefinition",void 0,{expand:{environmentvariabledefinition_environmentvariablevalue:{}},filter:"(type eq ".concat(o.EnvironmentVariableDefinitionTypeEnum.ConnectionReference,") and (apiid eq '").concat(r.IEnvironmentVariableConnectors.SQL,"') and (parameterkey eq 'table') and (_parentdefinitionid_value eq '").concat(t.environmentvariabledefinitionid,"')")}).then(e=>{var t=e.data;A(t),I(!1)}).catch(e=>{D(e),I(!1)})}}}},6432:function(e,t,n){"use strict";n.r(t),n.d(t,"useSQLQueryStatus",(function(){return a}));var o=n(6398),r=n(3815);function a(e,t,n,a){var i=e.Model.Solutions.Components.EnvironmentVariable.Panel,s=i.DataSource.SQL;return{fetchSQLServers:{getErrorMessage:()=>{if(Object(o.isSQLApiId)(n)&&"dataset"===t.sqlParameterType.value)return a.hasConnectionMismatch?s.Error.serverNotFound:a.sqlServersData.queryError&&Object(r.formatString)(i.DataSource.SQL.Errors.sqlServers,a.sqlServersData.queryError)},getIsLoading:()=>Object(o.isSQLApiId)(n)&&"dataset"===t.sqlParameterType.value&&a.sqlServersData.isQueryLoading&&s.SQLServer.loading},fetchSQLDatabases:{getErrorMessage:()=>{if(Object(o.isSQLApiId)(n)&&"table"===t.sqlParameterType.value){var e;if(t.sqlServer.value)if(null===(e=t.sqlServer.value)||void 0===e||!e.environmentvariabledefinition_environmentvariablevalue.length||!t.sqlServer.value.environmentvariabledefinition_environmentvariablevalue[0].value)return s.Error.noSQLServerFound;return a.hasConnectionMismatch?s.Error.databaseNotFound:a.sqlDatabasesData.queryError&&Object(r.formatString)(i.DataSource.SQL.Errors.sqlDatabases,a.sqlDatabasesData.queryError)}},getIsLoading:()=>Object(o.isSQLApiId)(n)&&"table"===t.sqlParameterType.value&&a.sqlDatabasesData.isQueryLoading&&s.SQLDatabase.loading},fetchSQLDatabaseChildren:{getErrorMessage:()=>Object(o.isSQLApiId)(n)&&"dataset"===t.sqlParameterType.value&&a.sqlDatabaseVariableChildrenError&&Object(r.formatString)(i.DataSource.SQL.Errors.sqlDatabaseChildren,a.sqlDatabaseVariableChildrenError),getIsLoading:()=>Object(o.isSQLApiId)(n)&&"dataset"===t.sqlParameterType.value&&a.isLoadingSQLDatabaseVariableChildren&&s.SQLDatabase.loading},fetchSQLServerVariables:{getErrorMessage:()=>Object(o.isSQLApiId)(n)&&"table"===t.sqlParameterType.value&&a.sqlServerVariablesError&&Object(r.formatString)(i.DataSource.SQL.Errors.sqlServerVariables,a.sqlServerVariablesError),getIsLoading:()=>Object(o.isSQLApiId)(n)&&"table"===t.sqlParameterType.value&&a.isLoadingSQLServerVariables&&s.SQLServer.loading}}}},6433:function(e,t,n){"use strict";n.r(t),n.d(t,"useCDSQuery",(function(){return l}));var o=n(6434),r=n(1083),a=n(2807),i=n(6435),s=n(6429);function l(e,t,n){var{loading:l,errorMessage:c,environments:p}=Object(i.useGetAvailableEnvironments)(t,a.PortalScope,n.Common.Request.Failed),u=(p||[]).filter(e=>!Object(r.isEnvironmentInDeletedState)(e)&&e.orgUrl),d={items:u?u.map(e=>({key:e.orgUrl,text:e.displayName||e.orgUrl})):[],isQueryLoading:l,queryError:c},m={cdsEnvironmentsData:d,hasMismatch:Object(s.checkForMissingCDSEnvironment)(c,e,d)};return{queryStatus:Object(o.useCDSQueryStatus)(n,e.connector.value,m),queryData:{cdsEnvironmentsData:d,hasMismatch:m.hasMismatch}}}},6434:function(e,t,n){"use strict";n.r(t),n.d(t,"useCDSQueryStatus",(function(){return a}));var o=n(6398),r=n(3815);function a(e,t,n){var a=e.Model.Solutions.Components.EnvironmentVariable.Panel,i=a.DataSource.Dataverse;return{fetchCDSEnvironments:{getErrorMessage:()=>{if(Object(o.isCDSApiId)(t))return n.hasMismatch?i.Error.mismatchEnvironment:n.cdsEnvironmentsData.queryError&&Object(r.formatString)(a.DataSource.Dataverse.Errors.environments,n.cdsEnvironmentsData.queryError)},getIsLoading:()=>Object(o.isCDSApiId)(t)&&n.cdsEnvironmentsData.isQueryLoading&&i.DataverseEnvironment.loading}}}},6437:function(e,t,n){"use strict";n.r(t),n.d(t,"useEnvironmentVariableConnections",(function(){return s}));var o=n(245),r=n(2807),a=n(6377),i=n(6438);function s(e,t,n){var[s,l]=Object(o.useState)(),{loading:c,datasets:p,errorMessage:u,refetch:d}=Object(a.useConnectionsWithDetailsQuery)(t,{},r.PortalScope,n.Common.StandardErrorMessages);Object(o.useEffect)(()=>{if(e.connection.setValue(void 0,!0),p&&e.connector.value){var t=new Set,n=null==p?void 0:p.sort((e,t)=>(e.isAuthError?1:0)-(t.isAuthError?1:0)).filter(n=>{var o,r;if((null===(o=n.apiId)||void 0===o?void 0:o.toLowerCase())!==(null===(r=e.connector.value)||void 0===r?void 0:r.toLowerCase()))return!1;var a=!t.has(n.displayName);return t.add(n.displayName),a});l(n),e.connection.setValue(n&&n.length?n[0]:void 0,!0)}},[p,e.connector.value]);var m={isLoadingConnections:c,loadConnectionsErrorMessage:u,connections:s,onRefreshConnections:d};return{queryStatus:Object(i.useConnectionsQueryStatus)(n,e,m),queryData:{connections:s,onRefreshConnections:d}}}},6438:function(e,t,n){"use strict";n.r(t),n.d(t,"useConnectionsQueryStatus",(function(){return i}));var o=n(2830),r=n(6398),a=n(3815);function i(e,t,n){var i=e.Model.Solutions.Components.EnvironmentVariable.Panel;return{loadConnections:{getErrorMessage:()=>t.type.value==o.EnvironmentVariableDefinitionTypeEnum.ConnectionReference&&!!t.connector.value&&!Object(r.isCDSApiId)(t.connector.value)&&n.loadConnectionsErrorMessage&&Object(a.formatString)(i.DataSource.Connection.Errors.connections,n.loadConnectionsErrorMessage),getIsLoading:()=>t.type.value==o.EnvironmentVariableDefinitionTypeEnum.ConnectionReference&&!!t.connector.value&&!Object(r.isCDSApiId)(t.connector.value)&&n.isLoadingConnections&&i.loadingConnections}}}},6439:function(e,t,n){"use strict";function o(e,t){var n=t.Model.Solutions.Components.EnvironmentVariable.Panel;return{createEnvironmentVariable:{getErrorMessage:()=>{var t,n;return(null===(t=e.createResponse)||void 0===t?void 0:t.failed)&&(null===(n=e.createResponse)||void 0===n?void 0:n.message)},getIsLoading:()=>{var t;return(null===(t=e.createResponse)||void 0===t?void 0:t.loading)&&n.creating}},createCurrentValue:{getErrorMessage:()=>{var t,n;return(null===(t=e.createCurrentValueResponse)||void 0===t?void 0:t.failed)&&(null===(n=e.createCurrentValueResponse)||void 0===n?void 0:n.message)},getIsLoading:()=>{var t;return(null===(t=e.createCurrentValueResponse)||void 0===t?void 0:t.loading)&&(e.isEdit?n.updating:n.creating)}},deleteComponents:{getErrorMessage:()=>{var t,n;return!(null!==(t=e.deleteComponentsResponse)&&void 0!==t&&t.success)&&(null===(n=e.deleteComponentsResponse)||void 0===n?void 0:n.message)},getSuccessMessage:()=>{var t,n;return(null===(t=e.deleteComponentsResponse)||void 0===t?void 0:t.success)&&(null===(n=e.deleteComponentsResponse)||void 0===n?void 0:n.message)},getIsLoading:()=>{var n;return(null===(n=e.deleteComponentsResponse)||void 0===n?void 0:n.loading)&&t.Model.Solutions.Components.DeleteComponents.inProgressMessage}},removeComponents:{getErrorMessage:()=>{var t,n;return!(null!==(t=e.removeComponentsResponse)&&void 0!==t&&t.success)&&(null===(n=e.removeComponentsResponse)||void 0===n?void 0:n.message)},getSuccessMessage:()=>{var t,n;return(null===(t=e.removeComponentsResponse)||void 0===t?void 0:t.success)&&(null===(n=e.removeComponentsResponse)||void 0===n?void 0:n.message)},getIsLoading:()=>{var n;return(null===(n=e.removeComponentsResponse)||void 0===n?void 0:n.loading)&&t.Model.Solutions.Components.RemoveComponents.inProgressMessage}},fetchEnvironmentVariableValues:{getErrorMessage:()=>{var t,n;return(null===(t=e.fetchEnvironmentVariableValuesResponse)||void 0===t?void 0:t.failed)&&(null===(n=e.fetchEnvironmentVariableValuesResponse)||void 0===n?void 0:n.message)},getIsLoading:()=>{var t;return(null===(t=e.fetchEnvironmentVariableValuesResponse)||void 0===t?void 0:t.loading)&&n.loading}},modifyEnvironmentVariable:{getErrorMessage:()=>{var t,n;return(null===(t=e.modifyEnvironmentVariableResponse)||void 0===t?void 0:t.failed)&&(null===(n=e.modifyEnvironmentVariableResponse)||void 0===n?void 0:n.message)},getIsLoading:()=>{var t;return(null===(t=e.modifyEnvironmentVariableResponse)||void 0===t?void 0:t.loading)&&n.updating}},modifyCurrentValue:{getErrorMessage:()=>{var t,n;return(null===(t=e.modifyCurrentValueResponse)||void 0===t?void 0:t.failed)&&(null===(n=e.modifyCurrentValueResponse)||void 0===n?void 0:n.message)},getIsLoading:()=>{var t;return(null===(t=e.modifyCurrentValueResponse)||void 0===t?void 0:t.loading)&&n.updating}},addSolutionComponents:{getErrorMessage:()=>{var t,n;return(null===(t=e.addSolutionComponentsResponse)||void 0===t?void 0:t.failed)&&(null===(n=e.addSolutionComponentsResponse)||void 0===n?void 0:n.message)},getIsLoading:()=>{var t;return(null===(t=e.addSolutionComponentsResponse)||void 0===t?void 0:t.loading)&&(e.isEdit?n.updating:n.creating)}}}}n.r(t),n.d(t,"useStandardQueryStatus",(function(){return o}))},6440:function(e,t,n){"use strict";n.r(t),n.d(t,"getLoadingOverlay",(function(){return a}));var o=n(6441),r=n(2813);function a(e,t,n){for(var a of Object.values(e))if(a.getIsLoading())return{spinnerProps:{size:o.SpinnerSize.large,label:a.getIsLoading()}};if(Object(r.isLoading)(t.loadProgress))return{spinnerProps:{size:o.SpinnerSize.large,label:n.Model.Solutions.Components.EnvironmentVariable.Panel.loading}}}},6441:function(e,t,n){"use strict";n.r(t),n.d(t,"SpinnerSize",(function(){return o})),n.d(t,"SpinnerSizeMappings",(function(){return s})),n.d(t,"Spinner",(function(){return l}));var o,r=n(245),a=n(1201),i=n(2903);!function(e){e[e.small=0]="small",e[e.medium=1]="medium",e[e.large=2]="large"}(o||(o={}));var s={[o.small]:a.SpinnerSize.small,[o.medium]:a.SpinnerSize.medium,[o.large]:a.SpinnerSize.large},l=e=>{var{ariaLabel:t,className:n,size:o,text:l,labelPosition:c}=e;return r.createElement(a.Spinner,{className:Object(i.css)("fl-Spinner",n),ariaLabel:t||l||"Loading",size:s[o],label:l,labelPosition:c})}},6442:function(e,t,n){"use strict";n.r(t),n.d(t,"getMessageBar",(function(){return i}));var o=n(245),r=n(1697),a=n(3713);function i(e,t,n){if(e)return{messageBarProps:{messageBarType:r.MessageBarType.warning,dismissButtonAriaLabel:n.Common.close,isMultiline:!1,truncated:!0},onRenderBody:()=>o.createElement(o.Fragment,null,Object(a.getHostContext)()===a.HostContext.Teams?n.Model.Solutions.Components.EnvironmentVariable.Panel.teamsManagedSolutionWarning:n.Model.Solutions.Components.EnvironmentVariable.Panel.managedSolutionWarning)};var i=function(e){var t;return e.getErrorMessage()?{v:{messageBarProps:{messageBarType:r.MessageBarType.error,dismissButtonAriaLabel:n.Common.close,isMultiline:!1,truncated:!0},onRenderBody:()=>o.createElement(o.Fragment,null,e.getErrorMessage())}}:null!==(t=e.getSuccessMessage)&&void 0!==t&&t.call(e)?{v:{messageBarProps:{messageBarType:r.MessageBarType.success,dismissButtonAriaLabel:n.Common.close,isMultiline:!1,truncated:!0},onRenderBody:()=>o.createElement(o.Fragment,null,e.getSuccessMessage())}}:void 0};for(var s of Object.values(t)){var l=i(s);if("object"==typeof l)return l.v}}},6443:function(e,t,n){"use strict";n.r(t),n.d(t,"getConfirmParentChangeDialog",(function(){return c}));var o=n(245),r=n(6414),a=n(5917),i=n(6398),s=n(687),l=n(2844);function c(e,t,n,c,p){var u,d,m=p.Model.Solutions.Components.EnvironmentVariable.Panel;return Object(i.isSharePointApiId)(n.connector.value)?(u=m.DataSource.SharePoint.SharePointSite.ConfirmChange,d=c.sharePointData.sharePointListVariableChildren):(u=m.DataSource.SQL.SQLServer.ConfirmChange,d=c.sqlData.sqlDatabaseVariableChildren),o.createElement(a.ConfirmDialog,{hidden:!e,shouldKeepButtonEnabledOnConfirm:!0,title:u.title,subText:u.content,confirmButtonText:p.Common.cancel,cancelButtonText:u.update,onConfirm:()=>{n.currentValue.setValue(e.previousParentSelection),t(void 0)},onCancel:()=>{t(void 0)},renderBody:()=>o.createElement("div",null,d.map(e=>o.createElement("div",{key:"".concat(e.environmentvariabledefinitionid,"-container"),className:r.dataSourceEnvironmentVariableStyleClasses.dataSourceParentChangeConfirmationItem},o.createElement(s.Icon,{iconName:l.fabricIcons.CustomList,styles:r.dataSourceParentChangeConfirmationItemIconStyles}),o.createElement("span",{key:"".concat(e.environmentvariabledefinitionid,"-label"),className:r.dataSourceEnvironmentVariableStyleClasses.dataSourceParentChangeConfirmationItemText},e.displayname))))})}},6444:function(e,t,n){"use strict";n.r(t),n.d(t,"getConfirmParentDeleteValueDialog",(function(){return c}));var o=n(245),r=n(6414),a=n(5917),i=n(6398),s=n(687),l=n(2844);function c(e,t,n,c,p){var u,d,m=p.Model.Solutions.Components.EnvironmentVariable.Panel;return Object(i.isSharePointApiId)(n.connector.value)?(u=m.DataSource.SharePoint.SharePointSite.ConfirmDeleteValue,d=c.sharePointData.sharePointListVariableChildren):(u=m.DataSource.SQL.SQLServer.ConfirmDeleteValue,d=c.sqlData.sqlDatabaseVariableChildren),o.createElement(a.ConfirmDialog,{hidden:!e,shouldKeepButtonEnabledOnConfirm:!0,title:u.title,subText:u.content,confirmButtonText:p.Common.cancel,cancelButtonText:u.update,onConfirm:()=>{t(void 0)},onCancel:()=>{e.onDelete(),t(void 0)},renderBody:()=>o.createElement("div",null,d.map(e=>o.createElement("div",{key:"".concat(e.environmentvariabledefinitionid,"-container"),className:r.dataSourceEnvironmentVariableStyleClasses.dataSourceParentChangeConfirmationItem},o.createElement(s.Icon,{iconName:l.fabricIcons.CustomList,styles:r.dataSourceParentChangeConfirmationItemIconStyles}),o.createElement("span",{key:"".concat(e.environmentvariabledefinitionid,"-label"),className:r.dataSourceEnvironmentVariableStyleClasses.dataSourceParentChangeConfirmationItemText},e.displayname))))})}},6445:function(e,t,n){"use strict";n.r(t),n.d(t,"getRefreshConnectionsDialog",(function(){return s}));var o=n(245),r=n(5917),a=n(2807),i=n(6395);function s(e,t,n,s){var l=s.Model.Solutions.Components.EnvironmentVariable.Panel;return o.createElement(r.ConfirmDialog,{hidden:!e,shouldKeepButtonEnabledOnConfirm:!0,title:l.NewConnectionPrompt.title,subText:l.NewConnectionPrompt.content,confirmButtonText:s.Common.refresh,cancelButtonText:s.Common.cancel,onConfirm:()=>{Object(a.trackUserActionClickButton)(i.RefreshConnections,{action:i.RefreshConnectionsActionNames.ExecuteFromDialog}),t(!1),n.connectionsData.onRefreshConnections()},onCancel:()=>{Object(a.trackUserActionClickButton)(i.RefreshConnections,{action:i.RefreshConnectionsActionNames.DismissDialog}),t(!1)}})}},6447:function(e,t,n){"use strict";n.r(t),n.d(t,"SampleAppTemplate",(function(){return g})),n.d(t,"PowerPortalTemplate",(function(){return y})),n.d(t,"mapStateToProps",(function(){return S})),n.d(t,"mapDispatchToProps",(function(){return f})),n.d(t,"mergeProps",(function(){return h})),n.d(t,"CreateXrmDatabasePanelContainer",(function(){return O}));var o=n(5437),r=n(5656),a=n(5468),i=n(6448),s=n(6449),l=n(5630),c=n(5478),p=n(5876),u=n(6450);function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){b(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function b(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var g="D365_CDSSampleApp",y="D365_CDSStarterPortal",S=e=>{var t=a.sharedSelectors.newXrmDatabaseInProgressSelector(e),n=a.sharedSelectors.newXrmDatabaseErrorSelector(e),o=a.sharedSelectors.newXrmDatabaseRequestFulfilledSelector(e);return{currencyOptions:a.sharedSelectors.currenciesSelector(e).map(e=>({key:e.properties.code,text:Object(i.getCurrencyDisplayName)(e)})),languageOptions:a.sharedSelectors.languagesSelector(e).map(e=>({key:e.properties.localeId,text:Object(s.getLanguageDisplayName)(e)})),newXrmDatabaseInProgress:t,newXrmDatabaseError:n,newXrmDatabaseRequestFulfilled:o}},f=(e,t)=>({fetchCurrencies:()=>{e(a.sharedActions.fetchCurrenciesRequest())},fetchLanguages:()=>{e(a.sharedActions.fetchLanguagesRequest())},onPanelClose:()=>{e(Object(l.logAction)(a.sharedActions.panelClose({panelType:c.PanelToShowType.CreateXrmDatabasePanel}),p.CreateXrmDatabasePanelEvents.CreatePanelClosed.eventName)),e(a.sharedActions.resetCreateXrmDatabasePanelStatus())},onCreateNewXrmDatabase:n=>{e(Object(l.logAction)(a.sharedActions.createXrmDatabaseRequest({currency:n.currency,language:n.language,templates:n.includeSampleApps?t.sampleAppType===r.SampleAppTypes.PowerPortal?[y]:[g]:[]}),p.CreateXrmDatabasePanelEvents.CreateXrmDatabaseClicked.eventName))},onNavigateBack:()=>{e(a.sharedActions.resetCreateXrmDatabasePanelStatus())}}),h=(e,t,n)=>m(m(m({onMount:()=>{t.fetchCurrencies(),t.fetchLanguages()},defaultPanelProps:n.defaultPanelProps},e),t),{},{sampleAppType:n.sampleAppType}),O=Object(o.connect)(S,f,h)(u.CreateXrmDatabasePanel)},6448:function(e,t,n){"use strict";function o(e){return e.properties.code||e.name}n.r(t),n.d(t,"getCurrencyDisplayName",(function(){return o}))},6449:function(e,t,n){"use strict";function o(e){return e.properties.displayName||e.name}n.r(t),n.d(t,"getLanguageDisplayName",(function(){return o}))},6452:function(e,t,n){"use strict";n.r(t),n.d(t,"mapStateAndOwnPropsToProps",(function(){return C})),n.d(t,"mapDispatchToProps",(function(){return v})),n.d(t,"mergeProps",(function(){return P})),n.d(t,"EditConnectionReferencePanelContainer",(function(){return E}));var o=n(5437),r=n(5629),a=n(5478),i=n(5487),s=n(5468),l=n(6370),c=n(5704),p=n(6383),u=n(5796),d=n(5807),m=n(5630),b=n(5687),g=n(3713),y=["rootProps"];function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(Object(n),!0).forEach((function(t){h(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function O(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var C=(e,t)=>{var{rootProps:n}=t,o=Object(p.connectionReferenceSelector)(e,t.connectionReferenceId),a=Object(p.fetchConRefDataResponseSelector)(e),i=Object(p.modifyConRefResponseSelector)(e),s=d.apisSelectorForCurrentEnv(e,n.currentEnvironment.id.toString()),l=d.apisListError(e),c=[Object(r.toLoadingState)(d.isApiListCachedComplete(e,n.currentEnvironment.id),l)],u=Object(r.getTotalLoadingState)(c)==r.ComponentLoadState.Complete,m=Object(p.ConnectionReferenceComponentSelector)(e,t.solution.solutionId,t.rootProps.currentEnvironment.id,t.connectionReferenceId);return{connectionReference:o,fetchConRefDataResponse:a,modifyConRefResponse:i,apis:s,loadProgress:c,isApiLoaded:u,solutionComponentId:Object(g.getSolutionComponentId)(m),solutionComponentTypeCode:Object(g.getSolutionComponentEntityTypeCode)(m)}},v=(e,t)=>({beforePanelClose:()=>{e(Object(u.fetchApisCancelPoll)()),e(Object(c.fetchConnectionReferenceDataClear)()),e(Object(c.modifyConnectionReferenceClear)())},onPanelClose:()=>{e(s.sharedActions.panelClose({panelType:a.PanelToShowType.EditConnectionReferencePanel}))},onEditSave:(t,n)=>{e(Object(c.modifyConnectionReference)({solution:t,toUpdate:n}))},openNewTab:t=>{e(Object(m.logAction)(s.sharedActions.openNewTab({uri:t}),b.ConnectionReferencePanelCommandEvents.LearnConnectionReferenceClicked.eventName))},fetchConnectionReferenceDataRequest:()=>{e(Object(c.fetchConnectionReferenceData)({}))},dispatchTelemetry:e,fetchConnectorRequest:()=>{e(Object(u.fetchApisRequest)())}}),P=(e,t,n)=>{var{rootProps:o}=n,r=O(n,y);return f(f(f(f({},e),t),r),{},{isEdit:!0,connectionReferenceId:n.connectionReferenceId,defaultPanelProps:n.defaultPanelProps})},E=Object(i.withRootProps)(Object(o.connect)(C,v,P)(l.ConnectionReferencePanel))},6453:function(e,t,n){"use strict";n.r(t),n.d(t,"mapStateAndOwnPropsToProps",(function(){return A})),n.d(t,"mapDispatchToProps",(function(){return R})),n.d(t,"mergeProps",(function(){return I})),n.d(t,"EditEnvironmentVariablePanelContainer",(function(){return w}));var o=n(5437),r=n(1144),a=n(5478),i=n(5468),s=n(6392),l=n(5630),c=n(5693),p=n(5687),u=n(6446),d=n(5787),m=n(5816),b=n(5629),g=n(5810),y=n(5487),S=n(5686),f=n(5675),h=n(5604),O=n(5611),C=n(6454),v=["rootProps"];function P(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?P(Object(n),!0).forEach((function(t){T(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function T(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function j(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var A=(e,t)=>{var n=Object(m.envVariableSelector)(e,t.definitionId),o=Object(m.envVariablesValuesNotInSolutionSelector)(e,t.solution.id,t.rootProps.currentEnvironment.id,t.definitionId),r=o[0]&&o[0].environmentvariablevalueid,a=Object(m.envVariablesValuesInSolutionSelector)(e,t.solution.id,t.rootProps.currentEnvironment.id,t.definitionId),i=a[0]&&a[0].environmentvariablevalueid,s=Object(m.fetchValuesResponseSelector)(e),l=Object(m.fetchVarDataResponseSelector)(e);return{createResponse:Object(m.createEnvVarResponseSelector)(e),createCurrentValueResponse:Object(m.createCurrentValueSelector)(e),modifyCurrentValueResponse:Object(m.modifyCurrentValueSelector)(e),addSolutionComponentsResponse:Object(g.addSolutionComponentsStatus)(e),modifyEnvironmentVariableResponse:Object(m.modifyEnvVarResponseSelector)(e),fetchEnvironmentVariableValuesResponse:s,fetchVarDataResponse:l,environmentVariableDefinition:n,loadProgress:[Object(b.toLoadingState)(!!n&&!Object(g.isFetchingSolutionComponent)(e,t.solution.id,t.rootProps.currentEnvironment.id,[O.StandardSolutionComponentTypes.EnvironmentVariableDefinition])&&!s.loading&&!l.loading&&Object(g.solutionComponentListNotInSolutionCacheComplete)(e,t.solution.id,t.rootProps.currentEnvironment.id,O.StandardSolutionComponentTypes.EnvironmentVariableValue))],logEvent:u.EnvironmentVariablePanelCommandEvents.Load,environmentVariableValueComponent:i?Object(g.EnvironmentVariableValueSelector)(e,t.solution.id,t.rootProps.currentEnvironment.id,i):Object(g.EnvironmentVariableValueNotInSolutionSelector)(e,t.solution.id,t.rootProps.currentEnvironment.id,r),deleteComponentsResponse:Object(g.deleteComponentsStatus)(e),removeComponentsResponse:Object(g.removeComponentsStatus)(e),valuesNotInSolution:o,valuesInSolution:Object(m.envVariablesValuesInSolutionSelector)(e,t.solution.id,t.rootProps.currentEnvironment.id,t.definitionId)}},R=e=>({beforePanelClose:()=>{e(Object(c.createCurrentValueClear)()),e(Object(c.createEnvironmentVariableClear)()),e(Object(c.modifyCurrentValueClear)()),e(Object(c.modifyEnvironmentVariableClear)()),e(Object(c.fetchEnvironmentVariableValuesClear)()),e(Object(c.fetchEnvironmentVariableDataClear)()),e(Object(S.addSolutionComponentsClear)())},onPanelClose:()=>{e(i.sharedActions.panelClose({panelType:a.PanelToShowType.EditEnvironmentVariablePanel}))},openNewTab:t=>e(Object(l.logAction)(i.sharedActions.openNewTab({uri:t}),u.EnvironmentVariablePanelCommandEvents.LearnEnvironmentVariableClicked.eventName)),onEditSave:(t,n,o,r,a,i,s)=>{!Object(C.isNullOrUndefined)(n)&&o?r&&e(Object(c.modifyCurrentValue)({solution:t,value:n,valueId:a})):Object(C.isNullOrUndefined)(n)||o||e(Object(c.createCurrentValue)({solution:t,value:n,definitionId:i.environmentvariabledefinitionid})),s&&e(Object(c.modifyEnvironmentVariable)({solution:t,defModificationContract:s}))},onDeleteComponentClick:(t,n)=>{e(d.solutionComponentsActions.deleteComponents({components:[t],solutionId:n,shouldNotShowInList:!0,customComponentDefinitions:[]}))},onRemoveComponentClick:(t,n)=>e(Object(l.logAction)(d.solutionComponentsActions.removeComponents({components:[t],solutionId:null==n?void 0:n.id,solutionName:null==n?void 0:n.name,shouldNotShowInList:!0}),p.SolutionComponentsCommandEvents.Remove.eventName)),fetchEnvironmentVariable:t=>{Object(f.shouldShowEnvironmentVariables)(Object(h.getCrmVersion)(t))&&e(Object(c.fetchEnvironmentVariableData)({}))},fetchEnvironmentVariableValue:(t,n,o)=>{Object(f.shouldShowEnvironmentVariables)(Object(h.getCrmVersion)(o))&&(e(Object(c.fetchEnvironmentVariableValues)({definitionId:n})),e(Object(S.fetchSolutionComponentsRequest)({solutionId:t,componentTypes:[O.StandardSolutionComponentTypes.EnvironmentVariableValue],pageSize:2e3})),e(Object(S.fetchSolutionComponentsNotInSolutionRequest)({solutionId:t,componentTypes:[O.StandardSolutionComponentTypes.EnvironmentVariableValue],pageSize:2e3})))},dispatchTelemetry:e,clearResponses:()=>{e(Object(c.fetchEnvironmentVariableValuesClear)()),e(Object(c.fetchEnvironmentVariableDataClear)()),e(d.solutionComponentsActions.removeComponentsClear()),e(d.solutionComponentsActions.deleteComponentsClear())},addExistingValue:t=>e(Object(S.addSolutionComponentsRequest)(t))}),I=(e,t,n)=>{var{rootProps:o}=n,r=j(n,v);return E(E(E(E({},e),t),r),{},{isEdit:!0,isValueEditOnly:r.isOnBehalfOfValue})},w=Object(r.withHttpClient)(Object(y.withRootProps)(Object(o.connect)(A,R,I)(s.EnvironmentVariablePanel)))},6457:function(e,t,n){"use strict";n.r(t),n.d(t,"mapStateToProps",(function(){return s})),n.d(t,"mapDispatchToProps",(function(){return l})),n.d(t,"FlowUpdatesPanelContainer",(function(){return c}));var o=n(5437),r=n(5468),a=n(5478),i=n(6458),s=e=>({}),l=e=>({onDismissPanel:()=>{e(r.sharedActions.panelClose({panelType:a.PanelToShowType.FlowUpdatesPanel}))}}),c=Object(o.connect)(s,l)(i.FlowUpdatesPanel)},6461:function(e,t,n){"use strict";n.r(t),n.d(t,"mapStateToProps",(function(){return r})),n.d(t,"GatewaySharePanelContainer",(function(){return a}));var o=n(245);function r(e,t){return{}}var a=()=>o.createElement(o.Fragment,null)},6462:function(e,t,n){"use strict";n.r(t),n.d(t,"mapStateToProps",(function(){return d})),n.d(t,"mapDispatchToProps",(function(){return m})),n.d(t,"mergeProps",(function(){return b})),n.d(t,"ImportTranslationPanelContainer",(function(){return g}));var o=n(5437),r=n(5478),a=n(5690),i=n(5691),s=n(5468),l=n(6463);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var d=e=>({importTranslationResponse:Object(i.importTranslationResponse)(e)}),m=(e,t)=>({onDismiss:()=>{t.onPanelClose?t.onPanelClose():e(s.sharedActions.panelClose({panelType:r.PanelToShowType.ImportTranslationPanel})),e(Object(a.importTranslationsClear)())},onImport:n=>{e(Object(a.importTranslationsRequest)({solutionId:t.solutionId,importFile:n}))}}),b=(e,t,n)=>p(p(p({},e),t),n),g=Object(o.connect)(d,m,b)(l.ImportTranslationPanel)},6467:function(e,t,n){"use strict";n.r(t),n.d(t,"ManagedPropertiesPanelContainer",(function(){return f}));var o=n(245),r=n.n(o),a=n(5437),i=n(5478),s=n(5468),l=n(6468),c=n(5686),p=n(5810),u=n(5766),d=n(6470),m=n(5767),b=n(6471),g=n(922),y=n(3076);function S(){return(S=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}var f=Object(g.translateService)("PowerappsPortal")(Object(y.withApolloClient)(e=>{var t,n=Object(a.useDispatch)(),o=Object(a.useSelector)(p.managedProperties),g=Object(a.useSelector)(d.apiCallResponsesSelector),y=Object(d.getApiCallResponse)(g,u.SolutionComponentApiCalls.FetchManagedProperties),f=Object(d.getApiCallResponse)(g,u.SolutionComponentApiCalls.UpdateManagedProperties),h=null!==(t=e.onPanelClose)&&void 0!==t?t:()=>n(s.sharedActions.panelClose({panelType:i.PanelToShowType.ManagedProperties})),{errorMessage:O,customComponentDefinitions:C}=Object(b.useSolutionCustomComponentTypesDefinition)(e.environmentClient,e.t("Common.Request.Failed"),!1);return r.a.createElement(l.ManagedPropertiesPanel,S({managedProperties:o,managedPropertiesResponse:y,updateManagedPropertiesResponse:f,onPanelClose:h,fetchComponentManagedProperties:(e,t)=>{n(Object(m.apiCallLoading)({apiCall:u.SolutionComponentApiCalls.FetchManagedProperties})),n(Object(c.fetchComponentManagedProperties)({component:e,customComponentDefinitions:t}))},updateManagedProperties:e=>{n(Object(m.apiCallLoading)({apiCall:u.SolutionComponentApiCalls.UpdateManagedProperties})),n(Object(c.updateManagedProperties)(e))},customComponentDefinitions:C,customComponentDefinitionsError:O,isSolutionManaged:e.isSolutionManaged,solutionName:e.solutionName,component:e.component,isUsingSolutionTree:e.isUsingSolutionTree},e))}))},6468:function(e,t,n){"use strict";n.r(t),n.d(t,"ManagedPropertiesPanel",(function(){return b}));var o=n(245),r=n(4013),a=n(1864),i=n(1362),s=n(1201),l=n(1697),c=n(2869),p=n(6469),u=n(2812),d=n(5607);function m(){return(m=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}class b extends o.Component{constructor(e){super(e),this.resources=void 0,this.isCustomizable="iscustomizable",this.propertiesInitialValue={},this.onChangeProperty=(e,t)=>{var n=e.currentTarget.id,{properties:o}=this.state;o[n]=t,this.setState({properties:o,isEdited:!u.isEqual(o,this.propertiesInitialValue)})},this.resources=Object(c.getResources)(),this.state={properties:null,isEdited:!1}}componentDidMount(){this.props.fetchComponentManagedProperties(this.props.component,this.props.customComponentDefinitions)}componentDidUpdate(e){if(e.managedProperties!==this.props.managedProperties){var t={};this.propertiesInitialValue={},this.props.managedProperties.map(e=>{t[e.Name]=e.Value,this.propertiesInitialValue[e.Name]=e.Value}),this.setState({properties:t})}}componentWillUnmount(){this.props.updateManagedPropertiesResponse.loading=!1,this.props.updateManagedPropertiesResponse.succeeded=!1,this.props.updateManagedPropertiesResponse.failed=!1,this.props.updateManagedPropertiesResponse.message=""}render(){var e,t,n=p.managedPropertiesPanelStyles;(this.props.managedPropertiesResponse&&this.props.managedPropertiesResponse.loading||this.props.updateManagedPropertiesResponse&&this.props.updateManagedPropertiesResponse.loading)&&(e={spinnerProps:{size:s.SpinnerSize.large}}),this.props.isUsingSolutionTree&&this.props.updateManagedPropertiesResponse&&this.props.updateManagedPropertiesResponse.succeeded&&this.props.onPanelClose();var c=this.props.updateManagedPropertiesResponse&&this.props.updateManagedPropertiesResponse.failed?this.props.updateManagedPropertiesResponse.message:this.props.customComponentDefinitionsError;c&&(t={messageBarProps:{messageBarType:l.MessageBarType.error,dismissButtonAriaLabel:this.resources.Common.close},onRenderBody:()=>o.createElement(o.Fragment,null,c)});var u=null;return this.state.properties&&(u=this.props.managedProperties.find(e=>e.Name.toLowerCase()===this.isCustomizable))&&(u.Value=this.state.properties[u.Name]),o.createElement(r.Panel,m({},this.props.defaultPanelProps,{headerText:this.resources.Model.Solutions.Components.ManagedProperties.headerText,loadingOverlay:e,messageBar:t,footerButtons:this.getFooterButtons(),onDismiss:this.props.onPanelClose,closeButtonType:r.PanelCloseButtonType.Back,closeButtonAriaLabel:this.resources.Common.close}),o.createElement("div",{style:n.section},this.resources.Model.Solutions.Components.ManagedProperties.headerSubText),u&&o.createElement(o.Fragment,null,o.createElement(a.Toggle,{checked:!!u.Value,onText:this.resources.Model.Solutions.Components.ManagedProperties.customizationText,offText:this.resources.Model.Solutions.Components.ManagedProperties.customizationText,onChange:this.onChangeProperty,ariaLabel:this.resources.Model.Solutions.Components.ManagedProperties.customizationText,styles:{root:n.toggleStyles.root},disabled:this.props.isSolutionManaged||Object(d.isSolutionComponentManaged)(this.props.component)||!u.CanBeChanged,id:u.Name}),this.props.managedProperties.map(e=>e.Name.toLowerCase()!==this.isCustomizable&&o.createElement(i.Checkbox,{styles:n.checkBoxStyles,label:e.Label,disabled:this.props.isSolutionManaged||Object(d.isSolutionComponentManaged)(this.props.component)||!u.CanBeChanged||!u.Value||!e.CanBeChanged,checked:!!this.state.properties[e.Name],onChange:this.onChangeProperty,id:e.Name}))))}getFooterButtons(){return[{primary:!0,ariaLabel:this.resources.Common.done,text:this.resources.Common.done,disabled:!this.state.isEdited||this.props.updateManagedPropertiesResponse.loading,dismissableOnClick:()=>{var{managedProperties:e}=this.props,{properties:t}=this.state;e.map(e=>{e.Value=t[e.Name]}),this.props.updateManagedProperties({properties:e,solutionName:this.props.solutionName,component:this.props.component,customComponentDefinitions:this.props.customComponentDefinitions,isReadOnly:!1})}},{ariaLabel:this.resources.Common.Save.cancel,text:this.resources.Common.Save.cancel,dismissableOnClick:this.props.onPanelClose,disabled:this.props.updateManagedPropertiesResponse.loading}]}}},6469:function(e,t,n){"use strict";n.r(t),n.d(t,"managedPropertiesPanelStyles",(function(){return a}));var o=n(5492),r=n(2882),a={section:{fontSize:"14px",lineHeight:"20px",fontFamily:o.fonts.segoeUi,color:r.fabricColors.neutralChicago,fontWeight:"normal",marginTop:"4px"},checkBoxStyles:{root:{marginTop:"8px",marginBottom:"8px",fontSize:"14px",lineHeight:"20px",fontFamily:o.fonts.segoeUi,color:r.fabricColors.neutralTuatara},label:{fontWeight:"normal"}},toggleStyles:{root:{marginTop:"16px !important",marginBottom:"8px",fontSize:"14px",lineHeight:"20px",fontFamily:o.fonts.segoeUi,color:r.fabricColors.neutralTuatara,fontWeight:"normal"}}}},6470:function(e,t,n){"use strict";n.r(t),n.d(t,"apiCallResponsesSelector",(function(){return o})),n.d(t,"getApiCallResponse",(function(){return r})),n.d(t,"apiCallResponseSelector",(function(){return a}));var o=e=>e.apiCallResponse.ApiCallResponses,r=(e,t)=>e.get(t)||{loading:!1,succeeded:!1,failed:!1,message:""},a=(e,t)=>{var n=o(e);return r(n,t)}},6471:function(e,t,n){"use strict";n.r(t),n.d(t,"useSolutionCustomComponentTypesDefinition",(function(){return c}));var o=n(6472),r=n(5593),a=n(245),i=n(2871),s=n(5613),l=[];function c(e,t,n,c){var{errorMessage:p,loading:u,solutionComponentDefinitions:d}=Object(o.useSolutionComponentDefinitions)({variables:{input:{showBotComponents:i.featureGates.showBotComponents,filterDataFlowComponent:n,botComponentDefinitions:s.knownCustomBotSolutionComponentTypeLogicalNames}},telemetryScope:r.PortalScope,skip:c}),m=d||l;return{errorMessage:p,loading:u,customComponentDefinitions:Object(a.useMemo)(()=>m.map(e=>({logicalName:e.name,typeCode:e.solutionComponentType,entitySetName:e.entitySetName,displayName:e.displayName})),[m])}}},6472:function(e,t,n){"use strict";n.r(t),n.d(t,"useSolutionComponentDefinitions",(function(){return u}));var o=n(3193),r=n(6473),a=n(5895),i=["data"];function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var u=e=>{var t=Object(a.useQueryWithClient)(l(l({},e),{},{query:r.SolutionComponentDefinitionQuery,scenarioName:o.TelemetryScenarioNames.powerSettingsFetch,getScenarioCompletionData:e=>({exists:!(null==e||!e.solutionComponentDefinition)})})),{data:n}=t;return l(l({},p(t,i)),{},{solutionComponentDefinitions:null==n?void 0:n.solutionComponentDefinition})}},6474:function(e,t,n){"use strict";n.r(t),n.d(t,"mapStateToProps",(function(){return S})),n.d(t,"mapDispatchToProps",(function(){return f})),n.d(t,"mergeProps",(function(){return h})),n.d(t,"ObjectCheckerPanelContainer",(function(){return O}));var o=n(5437),r=n(5487),a=n(6475),i=n(5468),s=n(5478),l=n(5629),c=n(5687),p=n(5810),u=n(5808),d=["rootProps"];function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){g(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function y(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var S=(e,t)=>{var n=Object(p.objectCheckerResultsMap)(e),o=Object(u.getComponentReferenceKey)(t.component.msdyn_componentlogicalname,t.component.msdyn_objectid);return{objectCheckerResult:n.get(o),logEvent:c.SolutionComponentsCommandEvents.ObjectCheckerOpenPanel,loadProgress:[Object(l.toLoadingState)(!0)]}},f=e=>({onDismiss:()=>e(i.sharedActions.panelClose({panelType:s.PanelToShowType.ObjectCheckerPanel})),dispatchTelemetry:e}),h=(e,t,n)=>{var{rootProps:o}=n,r=y(n,d);return b(b(b(b({},e),t),r),{},{defaultPanelProps:n.defaultPanelProps})},O=Object(r.withRootProps)(Object(o.connect)(S,f,h)(a.ObjectCheckerPanel))},6475:function(e,t,n){"use strict";n.r(t);var o=n(6476);n.d(t,"getClassNames",(function(){return o.getClassNames}));var r=n(6477);n.d(t,"ObjectCheckerPanel",(function(){return r.ObjectCheckerPanel}));var a=n(6478);n.d(t,"ObjectCheckerPanelResults",(function(){return a.ObjectCheckerPanelResults}));var i=n(6474);n.d(t,"mapStateToProps",(function(){return i.mapStateToProps})),n.d(t,"mapDispatchToProps",(function(){return i.mapDispatchToProps})),n.d(t,"mergeProps",(function(){return i.mergeProps})),n.d(t,"ObjectCheckerPanelContainer",(function(){return i.ObjectCheckerPanelContainer}));var s=n(6483);n.d(t,"NoProblemsFoundSvg",(function(){return s.NoProblemsFoundSvg}));var l=n(6485);n.d(t,"useFixAllObjectCheckerProblems",(function(){return l.useFixAllObjectCheckerProblems})),n.d(t,"useFixObjectCheckerProblem",(function(){return l.useFixObjectCheckerProblem}))},6476:function(e,t,n){"use strict";n.r(t),n.d(t,"getClassNames",(function(){return a}));var o=n(719),r=n(3058),a=()=>Object(o.mergeStyleSets)({table:{fontWeight:"500",fontSize:"16px",lineHeight:"22px",color:r.fabricColors.neutralChicago},problems:{fontWeight:"500",fontSize:"14px",lineHeight:"20px",color:r.fabricColors.black,paddingTop:"40px",marginBottom:"8px"},noProblemsFound:{backgroundColor:"purple"},center:{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",textAlign:"center",paddingTop:"calc(50% - 100px/2)"}})},6477:function(e,t,n){"use strict";n.r(t),n.d(t,"ObjectCheckerPanel",(function(){return m}));var o=n(245),r=n.n(o),a=n(6475),i=n(1573),s=n(684),l=n(5814),c=n(2812),p=n(923),u=n(3058);function d(){return(d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}var m=e=>{var{environmentId:t,objectCheckerComponentResult:n}=e,m=Object(o.useMemo)(()=>{var e;return null!=n&&n.groupedResult?null==n||null===(e=n.groupedResult)||void 0===e?void 0:e.filter(e=>[l.ReturnStatusCodes.Fail,l.ReturnStatusCodes.Warning].indexOf(e.returnStatus)>-1):[]},[n]),{t:b}=Object(p.useTranslation)("PowerappsPortal"),g=Object(a.getClassNames)(),y=Object(o.useMemo)(()=>!m&&m.length<1?[]:Object(c.map)(m,e=>(null==e?void 0:e.returnStatus)==l.ReturnStatusCodes.Fail?null==e?void 0:e.analysisResultId:null).filter(e=>!!e),[m]),{mutate:S}=Object(a.useFixAllObjectCheckerProblems)(y,t),f=()=>{S(),e.onDismiss()},h=r.a.useCallback(()=>r.a.createElement("div",null,(null==y?void 0:y.length)>0&&r.a.createElement(s.PrimaryButton,{onClick:f,styles:{root:{marginRight:8}}},b("Model.Solutions.Components.ObjectCheckerRun.Panel.ObjectCheckerFixAllProblems")),r.a.createElement(s.DefaultButton,{onClick:e.onDismiss},b("Model.Solutions.Components.ObjectCheckerRun.Panel.close"))),[e.onDismiss,m]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(i.Panel,d({"aria-label":b("Model.Solutions.Components.ObjectCheckerRun.Panel.problems")},e.defaultPanelProps,{closeButtonAriaLabel:b("Model.Solutions.Components.ObjectCheckerRun.Panel.close"),headerText:b("Model.Solutions.Components.ObjectCheckerRun.Panel.checkResults"),isFooterAtBottom:!0,isLightDismiss:!0,isOpen:!0,onDismiss:e.onDismiss,onRenderFooterContent:h,styles:{main:{backgroundColor:u.fabricColors.neutralLighterAlt,fontFamily:"Segoe UI"}}}),r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement("p",{className:g.table},(e=>{switch(e){case"Client Extension":return"Site map";default:return"Model-driven app"}})(e.component.msdyn_componenttypename))),r.a.createElement("div",null,r.a.createElement(a.ObjectCheckerPanelResults,d({},e,{status:status,foundProblems:m}))))))};t.default=m},6478:function(e,t,n){"use strict";n.r(t),n.d(t,"ObjectCheckerPanelResults",(function(){return p}));var o=n(245),r=n(1201),a=n(6475),i=n(6479),s=n(923),l=n(3058);function c(){return(c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}var p=e=>{var t,n,{status:p}=e,{t:u}=Object(s.useTranslation)("PowerappsPortal"),d=Object(a.getClassNames)();return o.createElement("div",null,null!==(t=e.foundProblems)&&void 0!==t&&t.length?o.createElement(o.Fragment,null,o.createElement("div",{className:d.problems},u("Model.Solutions.Components.ObjectCheckerRun.Panel.problems")," (",null===(n=e.foundProblems)||void 0===n?void 0:n.length,")"),e.foundProblems.map((t,n)=>o.createElement(i.ObjectCheckerAccordionCard,c({key:"solutionObjectCheckerPanelResult".concat(n),index:n,result:t,fixThisProblem:u("Model.Solutions.Components.ObjectCheckerRun.Panel.fixThisProblem"),howToFixIt:u("Model.Solutions.Components.ObjectCheckerRun.Panel.howToFixIt"),guidanceHelpLink:u("Model.Solutions.Components.ObjectCheckerRun.Panel.guidanceHelpLink"),problem:u("Model.Solutions.Components.ObjectCheckerRun.Panel.problem"),openProblemOrWarning:u("Model.Solutions.Components.ObjectCheckerRun.Panel.openProblemOrWarning"),closeProblemOrWarning:u("Model.Solutions.Components.ObjectCheckerRun.Panel.closeProblemOrWarning"),helpLink:u("Model.Solutions.Components.ObjectCheckerRun.Panel.helpLink")},e)))):o.createElement("div",{className:d.center},o.createElement(a.NoProblemsFoundSvg,{width:"100",height:"100",fillColor:l.fabricColors.neutralPlum,ariaLabel:u("Model.Solutions.Components.ObjectCheckerRun.Panel.noProblemsFound")}),o.createElement("p",null,u("Model.Solutions.Components.ObjectCheckerRun.Panel.noProblemsFound"))),"loading"===p&&o.createElement(r.Spinner,{size:r.SpinnerSize.large}))};t.default=p},6479:function(e,t,n){"use strict";n.r(t);var o=n(6480);n.d(t,"getClassNames",(function(){return o.getClassNames}));var r=n(6481);n.d(t,"ObjectCheckerAccordionCard",(function(){return r.ObjectCheckerAccordionCard}));var a=n(6482);n.d(t,"LeftHeader",(function(){return a.LeftHeader})),n.d(t,"RightHeader",(function(){return a.RightHeader})),n.d(t,"Body",(function(){return a.Body}))},6480:function(e,t,n){"use strict";n.r(t),n.d(t,"getClassNames",(function(){return a}));var o=n(719),r=n(3058),a=()=>Object(o.mergeStyleSets)({accordionAndCard:{backgroundColor:r.fabricColors.white,fontFamily:"Segoe UI",lineHeight:"20px",marginBottom:"16px",boxShadow:"0px 1.6px 3.6px rgba(0, 0, 0, 0.13), 0px 0.3px 0.9px rgba(0, 0, 0, 0.11)"},accordion:{fontSize:"14px",color:r.fabricColors.neutralTuatara,paddingLeft:"16px",paddingTop:"15px",height:"44px",textAlign:"left",selectors:{i:{marginRight:"8px"}},transition:"0.4s"},accordionInsideButton:{float:"left"},accordionOpen:{selectors:{}},card:{padding:"0 16px",color:r.fabricColors.neutralChicago,height:"0px",opacity:"0.0",transition:"opacity 500ms 0ms",overflow:"hidden"},cardOpen:{padding:"0 16px",color:r.fabricColors.neutralChicago,boxSizing:"border-box",height:"auto",opacity:"1.0",transition:"opacity 1000ms 500ms",selectors:{".header":{fontWeight:"500",marginTop:"16px"}}},fixThis:{marginTop:"16px",marginBottom:"16px",selectors:{label:{fontSize:"14px",fontWeight:"500",color:r.fabricColors.neutralTuatara,paddingLeft:"8px",textOverflow:"clip"}}},repair:{color:r.fabricColors.neutralPlum,height:"16px",width:"16px"},repairBigger:{color:r.fabricColors.neutralPlum,height:"20px",width:"16px",float:"right"},error:{fontSize:"14px",lineHeight:"100%",paddingTop:"15px",paddingLeft:"7px",paddingRight:"4px",width:"14.91px",height:"14.72px",color:r.fabricColors.brightRed},warning:{fontSize:"14px",lineHeight:"100%",paddingTop:"15px",paddingLeft:"7px",paddingRight:"4px",width:"14.91px",height:"14.72px",color:r.fabricColors.warningYellow},problemText:{paddingTop:"12px",paddingBottom:"12px",marginLeft:"10px",fontWeight:"600",backgroundColor:r.fabricColors.white,fontFamily:"Segoe UI",lineHeight:"20px",letterSpacing:"0.005em",width:"100%"},flexContainer:{display:"flex",justifyContent:"flex-start",width:"100%",selectors:{div:{textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"},button:{cursor:"pointer",backgroundColor:r.fabricColors.white,border:"none",outline:"none"}}},flexLeft:{display:"flex",justifyContent:"flex-start",width:"100%"},flexRight:{display:"flex",justifyContent:"flex-end",paddingRight:"16px",paddingTop:"12px"}})},6481:function(e,t,n){"use strict";n.r(t),n.d(t,"ObjectCheckerAccordionCard",(function(){return s}));var o=n(245),r=n(6479),a=n(6475),i=n(5814),s=e=>{var{closeProblemOrWarning:t,environmentId:n,fixThisProblem:s,guidanceHelpLink:l,howToFixIt:c,openProblemOrWarning:p,problem:u,result:d}=e,m=Object(r.getClassNames)(),[b,g]=Object(o.useState)(!1),{mutate:y}=Object(a.useFixObjectCheckerProblem)(e.result.analysisResultId,n),S=()=>{y(),e.onDismiss()},f=d.returnStatus==i.ReturnStatusCodes.Warning;return o.createElement("div",{className:m.accordionAndCard},o.createElement("div",{className:m.flexContainer},o.createElement("div",{className:m.flexLeft,title:d.name,onClick:()=>{g(!b)},onKeyDown:e=>{"Enter"===e.key&&g(!b)}},Object(r.LeftHeader)({closeProblemOrWarning:t,isOpen:b,isWarning:f,openProblemOrWarning:p,result:d,styles:m})),o.createElement("div",{className:m.flexRight},Object(r.RightHeader)({fixThisProblem:s,isOpen:b,isWarning:f,onClickFix:S,result:d,styles:m}))),b&&o.createElement("div",{className:b?m.cardOpen:m.card},Object(r.Body)({fixThisProblem:s,guidanceHelpLink:l,howToFixIt:c,isOpen:b,isWarning:f,onClickFix:S,problem:u,result:d,styles:m})))};t.default=s},6482:function(e,t,n){"use strict";n.r(t),n.d(t,"LeftHeader",(function(){return s})),n.d(t,"RightHeader",(function(){return l})),n.d(t,"Body",(function(){return c}));var o,r=n(245),a=n(1259),i=n(687);!function(e){e[e.No=-1]="No",e[e.Yes=0]="Yes"}(o||(o={}));var s=e=>{var{styles:t,isOpen:n,isWarning:a,closeProblemOrWarning:s,openProblemOrWarning:l,result:c}=e,p=a?"WarningSolid":"StatusErrorFull",u=a?t.warning:t.error;return r.createElement(r.Fragment,null,r.createElement(i.Icon,{iconName:n?"ChevronUp":"ChevronDown",className:n?[t.accordion,t.accordionOpen].join(" "):t.accordion,tabIndex:o.Yes,"aria-label":n?s:l,"aria-expanded":n,role:"button"}),r.createElement(i.Icon,{className:u,iconName:p,tabIndex:o.No,"aria-label":p,role:"img"}),r.createElement("span",{className:t.problemText,tabIndex:o.No,"aria-label":c.name,role:"button"},c.name))},l=e=>{var{fixThisProblem:t,isWarning:n,onClickFix:a,result:s,styles:l}=e;return!n&&s.hasResolution&&r.createElement(i.Icon,{className:l.repairBigger,iconName:"Repair",title:t,tabIndex:n?o.No:o.Yes,onClick:a,"aria-label":t})},c=e=>{var{fixThisProblem:t,guidanceHelpLink:n,howToFixIt:s,isOpen:l,isWarning:c,onClickFix:p,problem:u,result:d,styles:m}=e;return r.createElement(r.Fragment,null,r.createElement("p",{className:"header",tabIndex:o.No},u),r.createElement("p",{tabIndex:o.No},d.solutionHealthMessage),r.createElement("p",{className:"header",tabIndex:o.No},s),d.helpLink&&r.createElement("p",null,r.createElement(a.Link,{tabIndex:l?o.Yes:o.No,target:"_blank",href:d.helpLink,"aria-label":n},n)),d.ruleReferenceUri&&r.createElement("p",null,d.ruleReferenceUri),!c&&d.hasResolution&&r.createElement(a.DefaultButton,{className:m.fixThis,tabIndex:l&&!c?o.Yes:o.No,title:t,onClick:p,"aria-label":t},r.createElement(i.Icon,{className:m.repair,iconName:"Repair"}),r.createElement("label",{htmlFor:"problem",className:"fixThisText"},t)),r.createElement("br",null))}},6483:function(e,t,n){"use strict";n.r(t);var o=n(6484);n.d(t,"NoProblemsFoundSvg",(function(){return o.NoProblemsFoundSvg}))},6484:function(e,t,n){"use strict";n.r(t),n.d(t,"NoProblemsFoundSvg",(function(){return a}));var o=n(245),r=n.n(o),a=e=>r.a.createElement("div",{className:e.className,role:"img","aria-label":e.ariaLabel},r.a.createElement("svg",{width:e.width,height:e.height,viewBox:"0 0 100 100",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r.a.createElement("circle",{cx:"50",cy:"50",r:"50",fill:e.fillColor}),r.a.createElement("path",{d:"M58 22H30C28.8954 22 28 22.8954 28 24V76C28 77.1046 28.8954 78 30 78H70C71.1046 78 72 77.1046 72 76V36H62C59.7909 36 58 34.2091 58 32V22Z",fill:"white"}),r.a.createElement("path",{d:"M72 34H62C60.8954 34 60 33.1046 60 32V22L72 34Z",fill:"white"}),r.a.createElement("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M50 63C57.1797 63 63 57.1797 63 50C63 42.8203 57.1797 37 50 37C42.8203 37 37 42.8203 37 50C37 57.1797 42.8203 63 50 63Z",fill:e.fillColor}),r.a.createElement("path",{d:"M44 50.2L48.7273 55L57 46",stroke:"white","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})))},6485:function(e,t,n){"use strict";n.r(t);var o=n(6486);n.d(t,"useFixAllObjectCheckerProblems",(function(){return o.useFixAllObjectCheckerProblems}));var r=n(6514);n.d(t,"useFixObjectCheckerProblem",(function(){return r.useFixObjectCheckerProblem}))},6486:function(e,t,n){"use strict";n.r(t),n.d(t,"useFixAllObjectCheckerProblems",(function(){return c}));var o=n(3916),r=n(1146),a=n(6487),i=n(6491);function s(e,t,n,o,r,a,i){try{var s=e[a](i),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(o,r)}function l(e){return function(){var t=this,n=arguments;return new Promise((function(o,r){var a=e.apply(t,n);function i(e){s(a,o,r,i,l,"next",e)}function l(e){s(a,o,r,i,l,"throw",e)}i(void 0)}))}}function c(e,t){var n=null==t?void 0:t.split("/").pop(),s="https://graphql/graphql/environment/".concat(n),c=JSON.stringify({query:Object(i.print)(a.GetUseFixAllObjectCheckerProblemsGql),variables:e});return Object(o.useMutation)("post",l((function*(){return yield r.default.post(s,c,{headers:{"Content-Type":"application/json"}})})),{})}},6514:function(e,t,n){"use strict";n.r(t),n.d(t,"useFixObjectCheckerProblem",(function(){return c}));var o=n(3916),r=n(1146),a=n(6487),i=n(6491);function s(e,t,n,o,r,a,i){try{var s=e[a](i),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(o,r)}function l(e){return function(){var t=this,n=arguments;return new Promise((function(o,r){var a=e.apply(t,n);function i(e){s(a,o,r,i,l,"next",e)}function l(e){s(a,o,r,i,l,"throw",e)}i(void 0)}))}}function c(e,t){var n=null==t?void 0:t.split("/").pop(),s="https://graphql/graphql/environment/".concat(n),c=JSON.stringify({query:Object(i.print)(a.GetUseFixObjectCheckerProblemGql),variables:e});return Object(o.useMutation)("post",l((function*(){return yield r.default.post(s,c,{headers:{"Content-Type":"application/json"}})})),{})}},6515:function(e,t,n){"use strict";n.r(t),n.d(t,"mapStateToProps",(function(){return m})),n.d(t,"mapDispatchToProps",(function(){return b})),n.d(t,"mergeProps",(function(){return g})),n.d(t,"PermissionInstructionPanelContainer",(function(){return y}));var o=n(5437),r=n(5487),a=n(5468),i=n(5604),s=n(5481),l=n(5478),c=n(6516);function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var m=(e,t)=>{var n=t.rootProps.currentEnvironment;return{usersCrmLink:Object(i.getSecurityRolesUrl)(n),securityRoleCrmLink:Object(i.getSecurityUsersUrl)(n)}},b=e=>({onPanelClose:()=>e(a.sharedActions.panelClose({panelType:l.PanelToShowType.PermissionInstructionPanel}))}),g=(e,t,n)=>u(u(u({},e),t),{},{defaultPanelProps:n.defaultPanelProps,readMoreLink:s.default.setPermissionReadmoreLink}),y=Object(r.withRootProps)(Object(o.connect)(m,b,g)(c.PermissionInstructionPanel))},6516:function(e,t,n){"use strict";n.r(t),n.d(t,"PermissionInstructionPanel",(function(){return d}));var o=n(4013),r=n(687),a=n(1090),i=n(1573),s=n(245),l=n(2869),c=n(2880),p=n(6517);function u(){return(u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}class d extends s.Component{constructor(e){super(e),this.resources=void 0,this.resources=Object(l.getResources)()}render(){var e=this.getFooterButtons(),t=s.createElement("div",{className:"content-container"},s.createElement("div",null,Object(c.formatResourceStringAsLinks)(this.resources.Apps.ManageApp.Share.PermissionInstructionPanel.Guideline,[this.props.readMoreLink])),s.createElement("ol",null,s.createElement("li",null,s.createElement("h4",null,this.resources.Apps.ManageApp.Share.PermissionInstructionPanel.CreateSecurityRole),s.createElement("div",null,Object(c.formatResourceStringAsLinks)(this.resources.Apps.ManageApp.Share.PermissionInstructionPanel.CreateSecurityRoleDescription,[this.props.securityRoleCrmLink]))),s.createElement("li",null,s.createElement("h4",null,this.resources.Apps.ManageApp.Share.PermissionInstructionPanel.AssignUsers),s.createElement("div",null,Object(c.formatResourceStringAsLinks)(this.resources.Apps.ManageApp.Share.PermissionInstructionPanel.AssignUsersDescription,[this.props.usersCrmLink])))));return s.createElement(o.Panel,u({},this.props.defaultPanelProps,{onDismiss:()=>{this.props.onPanelClose()},type:i.PanelType.largeFixed,footerButtons:e,onRenderHeader:this.onRenderHeader.bind(this),className:p.permissionInstructionPanelStylesClasses.permissionInstructionPanel}),s.createElement("div",null,t))}getFooterButtons(){return[{primary:!0,ariaLabel:this.resources.Common.back,text:this.resources.Common.back,dismissableOnClick:()=>this.props.onPanelClose()}]}onRenderHeader(){return s.createElement("div",{className:"header-container"},s.createElement(a.Link,{onClick:()=>this.props.onPanelClose()},s.createElement(r.Icon,{iconName:"back",className:"back-icon"}),"Set Permission"))}}},6517:function(e,t,n){"use strict";n.r(t),n.d(t,"permissionInstructionPanelStylesClasses",(function(){return i}));var o=n(719),r=n(5492),a=n(2882),i=Object(o.mergeStyleSets)({permissionInstructionPanel:{selectors:{".header-container":{marginTop:"15px",paddingLeft:"16px",paddingRight:"16px",display:"flex",alignItems:"center",justifyContent:"flex-start",fontSize:"21px",selectors:{".back-icon":{fontSize:"16px",lineHeight:"19px",marginRight:"8px"}}},".content-container":{maxWidth:"528px",marginTop:"15px",position:"static",selectors:{h4:{fontSize:"14px",marginTop:"4px",marginBottom:"4px",fontWeight:"400",fontFamily:r.fonts.segoeUi,lineHeight:"20px"},ol:{paddingLeft:"14px",selectors:{li:{marginTop:"16px"}}},a:{color:a.fabricColors.neutralPlum}}}}}})},6518:function(e,t,n){"use strict";n.r(t),n.d(t,"PowerBIDashboardPanel",(function(){return h}));var o=n(245),r=n.n(o),a=n(5437),i=n(6519),s=n(6446),l=n(5487),c=n(5604),p=n(2868),u=n(5481),d=n(2869),m=n(5630),b=n(5693),g=n(5686),y=n(5468);function S(){return(S=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}var f={url:u.default.environmentVariablesLearnMoreLink,eventName:s.EnvironmentVariablePanelCommandEvents.LearnEnvironmentVariableClicked.eventName},h=e=>{var t=Object(a.useDispatch)(),n={openNewTab:(e,n)=>t(Object(m.logAction)(y.sharedActions.openNewTab({uri:e}),n)),panelClose:()=>t(y.sharedActions.panelClose({panelType:e.panelType})),createEnvironmentVariable:e=>t(Object(b.createEnvironmentVariable)(e)),modifyEnvironmentVariable:e=>t(Object(b.modifyEnvironmentVariable)(e)),modifyCurrentValue:e=>t(Object(b.modifyCurrentValue)(e)),createCurrentValue:e=>t(Object(b.createCurrentValue)(e)),fetchSolutionComponentsRequest:e=>t(Object(g.fetchSolutionComponentsRequest)(e))},{rootProps:{currentEnvironment:s}}=Object(o.useContext)(l.RootPropsContext),u=Object(c.getCrmInstanceUrl)(s),h=Object(c.getCrmInstanceName)(s),O=Object(o.useMemo)(()=>({instanceUrl:u,uniqueName:h}),[u,h]),C=Object(o.useMemo)(()=>({environmentVariable:Object(d.getResources)().Model.Solutions.Components.EnvironmentVariable,common:Object(d.getResources)().Common}),[]);return r.a.createElement(i.PowerBIDashboardPanel,S({},e,{environmentVariablesLearnMoreLink:f,resources:C,getCDSClient:p.MetadataClientInstance.getInstance,dispatch:n,environment:O}))}},6538:function(e,t,n){"use strict";n.r(t),n.d(t,"mapStateToProps",(function(){return I})),n.d(t,"mapDispatchToProps",(function(){return w})),n.d(t,"mergeProps",(function(){return D})),n.d(t,"PowerPortalSettingsPanelContainer",(function(){return N}));var o=n(3076),r=n(3199),a=n(6539),i=n(5437),s=n(5487),l=n(5604),c=n(5651),p=n(5645),u=n(5478),d=n(5629),m=n(5630),b=n(5871),g=n(6541),y=n(5987),S=n(5468),f=n(5474),h=n(5626),O=n(5668),C=n(6547),v=n(5889),P=n(5890),E=n(5885),T=n(5596);function j(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function A(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?j(Object(n),!0).forEach((function(t){R(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function R(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var I=(e,t)=>{var n,{allowListFeatures:o}=t,r=null!==(n=y.powerPortalSettingsUpdateError(e))&&void 0!==n?n:"",i=t.rootProps.currentEnvironment,s=l.getCrmInstanceUrl(i),u=y.portalByIdSelector(e,t.selectedPowerPortalId),m=b.appModulesSelectors.appModulesSelector(e,i.id),g=Object(c.getAppModuleId)(Object(c.getAppModuleByUniqueName)(p.PowerPortalAdminModelAppUniqueName,m)),S=y.appSelector(e,t.selectedPowerPortalId);return{appDisplayName:p.getDisplayName(u),powerPortalDisplayName:p.getDisplayName(u),selectedAppLanguagelcid:u?parseInt(u.portalProperties.Lcid):void 0,appAddress:p.getPowerPortalUrl(u),orgEnabledLanguages:Object(h.orgEnabledLanguagesSelector)(e,s),portalWebsiteIds:Object(h.portalWebsiteidSelector)(e,s),administrationLink:u?Object(a.getPowerPortalAdministrationUrl)(u.portalProperties.CrmGeo,u.id,u.portalProperties.Lcid):"",siteSettingsLink:u?Object(a.getPowerPortalSiteSettingsUrl)(u.portalProperties.CrmEditUrl,g):"",loadProgress:[Object(d.toLoadingState)(!!y.powerPortalSettingsUiLoaded(e,s),r)],errorMessage:r,logEvent:O.PowerPortalSettingsLoadEvent,powerPortalState:u?p.getPortalState(u.portalProperties.CategoryOperationAllowed):void 0,powerPortalStatus:u?p.getPortalStatus(u):void 0,enableIdentityAndAccessManagement:o.EnableIdentityAndAccessManagement,appPlanClassification:T.getAppPlanClassification(S)}},w=e=>({onPanelClose:()=>e(S.sharedActions.panelClose({panelType:u.PanelToShowType.PowerPortalSettingPanel})),onSaveClicked:(t,n,o)=>{e(Object(m.logAction)(g.powerPortalActions.updatePowerPortalSettingsRequest({powerPortalId:t,powerPortalName:n},o),O.PowerPortalSettingsActionEvents.OnSaveClick.eventName,O.PowerPortalSettingsActionEvents.OnSaveClick.getData(t,n)))},resetUpdatePowerPortalSettingsError:()=>e(g.powerPortalActions.resetPowerPortalSettingsError()),fetchOrgEnabledLanguages:()=>e(Object(f.fetchOrgEnabledLanguages)()),dispatchTelemetry:e,onCreateBillingPolicyClick:t=>{e(S.sharedActions.panelOpen({panelType:u.PanelToShowType.BillingWizardPanel,panelProps:{appName:t}}))}}),D=(e,t,n)=>{var o=n.selectedPowerPortalId;return A(A(A({},n),{},{selectedPowerPortalId:o,onPanelClose:()=>t.onPanelClose(),onSaveClicked:e=>t.onSaveClicked(o,e,n.environmentClient),resetUpdatePowerPortalSettingsError:()=>t.resetUpdatePowerPortalSettingsError(),fetchOrgEnabledLanguages:()=>t.fetchOrgEnabledLanguages(),defaultPanelProps:n.defaultPanelProps},e),{},{dispatchTelemetry:t.dispatchTelemetry,powerPortalState:e.powerPortalState,powerPortalStatus:e.powerPortalStatus,selectedEnvironmentId:n.rootProps.currentEnvironment.name,onCreateBillingPolicyClick:t.onCreateBillingPolicyClick})},N=Object(v.withPayGoBehavior)(Object(r.withAllowListFeatures)(Object(s.withRootProps)(Object(o.withApolloClient)(Object(P.withBillingPolicyDetails)(Object(E.withLicenseBehavior)(Object(i.connect)(I,w,D)(C.PowerPortalsSettingPanel)))))))},6541:function(e,t,n){"use strict";n.r(t);var o=n(5667);n.d(t,"powerPortalActions",(function(){return o}));var r=n(6542);n.d(t,"powerPortalMiddlewares",(function(){return r}));var a=n(6546),i=n(5987);n.d(t,"powerPortalSelectors",(function(){return i})),t.default=a.reducer},6542:function(e,t,n){"use strict";n.r(t);var o=n(6543);n.d(t,"PowerPortalRootSaga",(function(){return o.PowerPortalRootSaga}));var r=n(6544);n.d(t,"powerPortalSaga",(function(){return r.default}));var a=n(6545);n.d(t,"PowerPortalSpecificActionsMiddleware",(function(){return a.PowerPortalSpecificActionsMiddleware}))},6543:function(e,t,n){"use strict";n.r(t),n.d(t,"PowerPortalRootSaga",(function(){return a}));var o=n(5749),r=n(6541);function*a(){yield Object(o.all)([Object(o.fork)(r.powerPortalMiddlewares.powerPortalSaga)])}},6544:function(e,t,n){"use strict";n.r(t),n.d(t,"ApiScenario",(function(){return o})),n.d(t,"SuppressApiError",(function(){return re}));var o,r=n(2812),a=n(5749),i=n(5988),s=n(5606),l=n(5604),c=n(5758),p=n(5644),u=n(5645),d=n(5597),m=n(2868),b=n(2869),g=n(5667),y=n(5987),S=n(5474),f=n(5468),h=n(5768),O=n(5669),C=n(5593),v=n(2871),P=n(3804),E=n(5646),T=n(4200),j=n(3815),A=n(4443),R=n(3808),I=n(5432),w=n(1101);function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function N(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(Object(n),!0).forEach((function(t){L(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function L(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function*M(e){var t=Object(b.getResources)(),{powerPortalProvisioningRequestConfig:n}=e.payload,{enablePowerPortalPublicPreview:o,isPackageInstalled:i,navigate:l,environmentClient:c}=e.payload,d=s.SagaContextProps.getCurrentEnvironment(),m=O.SagaScenarioNames.createPortal,S=Object(C.trackCreateScenario)(m,{powerPortalProvisioningRequestConfig:n,enablePowerPortalPublicPreview:o,isPackageInstalled:i,navigateExists:!!l}),f=E.PowerPortalTelemetryService.getInstance();try{var h="";if(o){n.websiteId||(n.websiteId=h),E.PowerPortalTelemetryService.getInstance().getAnalyticsTracker(T.PerfEventName.CREATE_PORTAL).progressTracking(T.PerfEventName.CREATE_PORTAL+"_PROVISION_START",T.PerfEventType.CREATE),f.featureUsage(n.websiteId?A.TelemetryEventsFeatureName.CREATE_PORTAL_USING_WEBSITEID:A.TelemetryEventsFeatureName.CREATE_PORTAL,n.packageName),f.info(R.CREATE_PORTAL,JSON.stringify({packageUniqueName:n.packageName,hasWebsiteId:!!n.websiteId}));var v=yield Object(P.createPortalV2)(c,f,n);r.isEmpty(v)||(h=v.WebsiteId,f.info(m,"Portal created. Portal Id: ".concat(v.Id,", website Id: ").concat(h)),i=v.PackageStatus==p.PowerPortalPackageStatus.Installed,n.packageName==u.PowerPortalPackageName.IdeasPortal&&(yield Object(P.setPortalAppSetting)(c,f,v.TenantId,v.Id,u.PowerPortalIdeasAppSettingName,!0)),n.packageName==u.PowerPortalPackageName.FieldServiceAppPortal&&(yield Object(P.setPortalAppSetting)(c,f,v.TenantId,v.Id,u.PowerPortalFieldServiceAppSettingName,!0)))}else{var j=yield Object(a.select)(y.powerPortalWebsites,d.id);if(n.websiteId=!r.isEmpty(j)&&j[0].websiteId,r.isEmpty(n.websiteId)){yield H(c);var I=yield Object(a.select)(y.powerPortalWebsites,d.id);if(r.isEmpty(I)){var w=(yield Object(a.select)(y.powerPortalWebsitesFetchError,d.id))||t.DataversePortal.Common.Error.default;throw new Error(w)}n.websiteId=I[0].websiteId}h=n.websiteId,E.PowerPortalTelemetryService.getInstance().getAnalyticsTracker(T.PerfEventName.CREATE_PORTAL).progressTracking(T.PerfEventName.CREATE_PORTAL+"_PROVISION_START",T.PerfEventType.CREATE);var D=yield Object(P.createPortal)(c,f,n),N=JSON.parse(D);f.info(m,"Portal created (preview disabled). Portal Id: ".concat(N.Id,", website Id: ").concat(h)),n.packageName==u.PowerPortalPackageName.IdeasPortal&&(yield Object(P.setPortalAppSetting)(c,f,N.TenantId,N.Id,u.PowerPortalIdeasAppSettingName,!0)),n.packageName==u.PowerPortalPackageName.FieldServiceAppPortal&&(yield Object(P.setPortalAppSetting)(c,f,N.TenantId,N.Id,u.PowerPortalFieldServiceAppSettingName,!0))}yield Object(a.put)(Object(g.CreatePowerPortalFulfill)({packageName:n.packageName,websiteId:h,navigate:l,environmentClient:c,isPackageInstalled:i})),!o||h&&i||(yield Object(a.put)(Object(g.showCreatePowerPortalToastNotification)({portalName:n.portalName}))),yield Object(a.put)(g.resetPowerPortalOperationPrerequisites({environmentId:d.id,packageName:e.payload.powerPortalProvisioningRequestConfig.packageName,operationType:p.PowerPortalOperationType.Provision})),E.PowerPortalTelemetryService.getInstance().getAnalyticsTracker(T.PerfEventName.CREATE_PORTAL).endTracking(T.PerfEventOutcome.SUCCESS,T.PerfEventType.CREATE),Object(C.trackScenarioComplete)(m,{powerPortalProvisioningRequestConfig:n,enablePowerPortalPublicPreview:o,isPackageInstalled:i,navigateExists:!!l,websiteId:h},S)}catch(G){var L,M,x,k,F,_,U,V,B;G&&G.graphQLErrors&&G.graphQLErrors.length>0&&(B=JSON.parse(G.graphQLErrors[0].message)),f.error("CreatePortal","Create portal failed.",G),E.PowerPortalTelemetryService.getInstance().getAnalyticsTracker(T.PerfEventName.CREATE_PORTAL).endTracking(T.PerfEventOutcome.FAILURE,T.PerfEventType.CREATE),Object(C.trackScenarioFailure)(m,{error:{errorCode:null!==(L=B)&&void 0!==L&&L.errorCode?B.errorCode:void 0,exceptionMessage:null!==(M=B)&&void 0!==M&&M.message?B.message:"",detailedMessage:null!==(x=B)&&void 0!==x&&x.message?B.message:"",licenseCount:null!==(k=B)&&void 0!==k&&k.licenseCount?B.licenseCount:""}},S),yield Object(a.put)(g.showPowerPortalCreateModalError({error:{errorCode:null!==(F=B)&&void 0!==F&&F.errorCode?B.errorCode:void 0,exceptionMessage:null!==(_=B)&&void 0!==_&&_.message?B.message:"",detailedMessage:null!==(U=B)&&void 0!==U&&U.message?B.message:"",licenseCount:null!==(V=B)&&void 0!==V&&V.licenseCount?B.licenseCount:""},environmentId:d.id})),ee(G,"createPortal",B)}}function*x(e){yield Object(a.put)(Object(S.fetchPowerPortalIdeasOrStarterAppListInProgress)());try{var t=e.payload,n=s.SagaContextProps.getCurrentEnvironment();if(t.packageName==u.PowerPortalPackageName.IdeasPortal||t.packageName==u.PowerPortalPackageName.CDSStarter||t.packageName==u.PowerPortalPackageName.StarterPortal)try{var o=e.environmentClient,i=yield B(o),c=yield Object(a.select)(y.powerPortalWebsites,n.id);r.isEmpty(c)&&(yield Object(a.all)([Object(a.call)(H,o)]),c=yield Object(a.select)(y.powerPortalWebsites,n.id));var p=c.filter(e=>0===i.filter(t=>t.WebsiteId.toLowerCase()===e.websiteId.toLowerCase()).length?{name:e.name,websiteId:e.websiteId}:null);if(t.packageName==u.PowerPortalPackageName.IdeasPortal){var f,h=m.MetadataClientInstance.getInstance();f=yield h.retrieveFetchXmlResults({EntitySetName:"adx_sitesettings",fetchXml:d.ideasPortalSitesettingsFetchXml});var O=p.filter(e=>0!==f.value.filter(t=>t._adx_websiteid_value===e.websiteId&&"true"===t.adx_value).length?{name:e.name,websiteId:e.websiteId}:null);if(O&&0==O.length){var C=Object(b.getResources)();yield Object(a.put)(g.showPowerPortalCreateModalError({error:{exceptionMessage:C.PowerPortal.ErrorCode.A031,errorCode:"A031"},environmentId:n.id}))}else{var v=l.getCrmInstanceUrl(n);yield Object(a.put)(Object(S.fetchOrgEnabledWebsitesFulfilled)({environment:v,portalWebsiteIds:O}))}}else if(t.packageName==u.PowerPortalPackageName.CDSStarter||t.packageName==u.PowerPortalPackageName.StarterPortal){var P=l.getCrmInstanceUrl(n);yield Object(a.put)(Object(S.fetchOrgEnabledWebsitesFulfilled)({environment:P,portalWebsiteIds:p}))}}catch(w){var E,T,j,A,R;w&&w.graphQLErrors&&w.graphQLErrors.length>0&&(R=JSON.parse(w.graphQLErrors[0].message)),ee(w,"fetchPowerPortalIdeasOrStarterAppListSaga",R);var I={errorCode:null!==(E=R)&&void 0!==E&&E.errorCode?R.errorCode:void 0,exceptionMessage:null!==(T=R)&&void 0!==T&&T.message?R.message:"",detailedMessage:null!==(j=R)&&void 0!==j&&j.message?R.message:"",licenseCount:null!==(A=R)&&void 0!==A&&A.licenseCount?R.licenseCount:""};I.exceptionMessage=Object(u.getPowerPortalErrorMessageAndLogTheException)(I),yield Object(a.put)(g.powerPortalGenericErrors({error:I,environmentId:n.id})),yield Object(a.put)(g.showPowerPortalCreateModalError({error:{exceptionMessage:I.exceptionMessage,errorCode:I.errorCode},environmentId:n.id}))}}finally{yield Object(a.put)(Object(S.fetchPowerPortalIdeasOrStarterAppListFulfilled)())}}function*k(e){var t=e.payload,n=s.SagaContextProps.getCurrentEnvironment(),r=O.SagaScenarioNames.checkSubDomainAvailability,l=Object(C.trackLoadScenario)(r,{portalSubDomain:t}),c=e.environmentClient,p=E.PowerPortalTelemetryService.getInstance();try{var u=(yield Object(P.isSubDomainAvailable)(c,p,t))?i.SubDomainStatus.Accept:i.SubDomainStatus.Reject;yield Object(a.put)(Object(g.PortalSubDomainVerificationFulFilled)({portalSubDomain:t,portalSubDomainStatus:u})),Object(C.trackScenarioComplete)(r,{Summary:"Complete",portalSubDomain:t,portalSubDomainStatus:u},l),E.PowerPortalTelemetryService.getInstance().getAnalyticsTracker(T.PerfEventName.CREATE_PORTAL).progressTracking(T.PerfEventName.CREATE_PORTAL+"_DOMAIN_AVAILABLE",T.PerfEventType.CREATE)}catch(S){var d,m=te(S,"isSubDomainAvailable",o.create_portal),b=null==m?void 0:m.message,y=null!==(d=null==b?void 0:b.Message)&&void 0!==d?d:void 0;Object(C.trackScenarioFailure)(r,{error:{error:y,environmentId:n.id}},l),yield Object(a.put)(g.showPowerPortalCreateModalError({error:{exceptionMessage:y},environmentId:n.id})),ee(S,"checkSubDomainAvailability",m)}}function F(e,t){return e.some(e=>e.publisherid.uniquename===t)}function*_(){var e=s.SagaContextProps.getCurrentEnvironment(),t=yield Object(a.select)(y.powerPortalStarterSolutionStatusSelector,e.id);if(void 0===t){var n=Object(b.getResources)(),o=u.PowerPortalPackageName.CDSStarter,r=u.PowerPortalPublisherDetails.uniqueName;try{var i=yield m.MetadataClientInstance.getInstance(),l=o&&r?"uniquename eq '".concat(o,"'"):void 0,c=yield i.fetchListView("Solution","InternalSolutions",void 0,{filter:l,expand:{publisherid:{columns:["uniquename"]}}},{scenarioName:m.MCLTelemetryEventsMap.PAPortalPrefix});if(c.data&&r&&o){for(t=F(c.data,r);!t&&c.hasNext;)yield c.next(),t=F(c.data,r);t?yield Object(a.put)(g.fetchPowerPortalStarterSolutionFulfilled({environmentId:e.id,isPortalStarterSolutionInstalled:!0})):yield Object(a.put)(g.fetchPowerPortalStarterSolutionFulfilled({environmentId:e.id,isPortalStarterSolutionInstalled:!1}))}}catch(d){var p="401"===d.code||"403"===d.code?n.Model.Solutions.FetchRequest.ForbiddenError:n.DataversePortal.Common.Error.default;yield Object(a.put)(g.fetchPowerPortalStarterSolutionRejected({environmentId:e.id,error:Object(h.getResponseErrorMessage)(p)}))}}}function*U(e){var t=s.SagaContextProps.getCurrentEnvironment(),n=E.PowerPortalTelemetryService.getInstance();try{var o=e.payload.environmentClient;yield Object(P.retryProvisioning)(o,n,e.payload.portalId)}catch(m){var r,i,l,c,p;m&&m.graphQLErrors&&m.graphQLErrors.length>0&&(p=JSON.parse(m.graphQLErrors[0].message));var d={errorCode:null!==(r=p)&&void 0!==r&&r.errorCode?p.errorCode:void 0,exceptionMessage:null!==(i=p)&&void 0!==i&&i.message?p.message:"",detailedMessage:null!==(l=p)&&void 0!==l&&l.message?p.message:"",licenseCount:null!==(c=p)&&void 0!==c&&c.licenseCount?p.licenseCount:""};d.exceptionMessage=Object(u.getPowerPortalErrorMessageAndLogTheException)(d),yield Object(a.put)(g.powerPortalGenericErrors({error:d,environmentId:t.id})),ee(m,"retryPortalProvisioning",p)}}function*V(e){var t=O.SagaScenarioNames.updatePowerPortalSettingsSaga,n=e.environmentClient,o=E.PowerPortalTelemetryService.getInstance(),r=Object(C.trackLoadScenario)(t,e.payload);try{var i=yield Object(P.updatePortalName)(n,o,e.payload.powerPortalId,e.payload.powerPortalName);i&&(yield Object(a.put)(Object(g.updatePowerPortalSettingsFulfilled)({powerPortalId:e.payload.powerPortalId,powerPortalName:e.payload.powerPortalName}))),Object(C.trackScenarioComplete)(t,N(N({},e.payload),{},{status:i}),r)}catch(p){var s,l,c;p&&p.graphQLErrors&&p.graphQLErrors.length>0&&(c=JSON.parse(p.graphQLErrors[0].message)),Object(C.trackScenarioFailure)(t,{error:null!==(s=c)&&void 0!==s&&s.message?c.message:""},r),yield Object(a.put)(Object(g.updatePowerPortalSettingsRejected)({error:null!==(l=c)&&void 0!==l&&l.message?c.message:""})),ee(p,"updatePowerPortalSettingsSaga",c)}}function*B(e){var t=s.SagaContextProps.getCurrentEnvironment(),n=E.PowerPortalTelemetryService.getInstance();try{var r=l.getCrmInstanceId(t),i=yield Object(P.listPortalsByOrgId)(e,n,r,!0);return i&&i.length>0?yield Object(a.put)(g.fetchPowerPortalsFromSitewideFulfilled({powerPortals:i,environmentId:t.id,sitewideExists:p.PowerPortalsSitewideState.Exists})):yield Object(a.put)(g.fetchPowerPortalsFromSitewideFulfilled({powerPortals:void 0,environmentId:t.id,sitewideExists:p.PowerPortalsSitewideState.NotExists})),i}catch(u){var c=te(u,"listPortalsByOrgId",o.initial_load);return null!=c&&c.errorCode&&(yield Object(a.put)(g.fetchPowerPortalsFromSitewideRejected({environmentId:t.id,error:{responseCode:c.errorCode,errorMessage:null!=c&&c.message?c.message:""}}))),void ee(u,"fetchPowerPortalsFromSitewide",c)}}function*H(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=s.SagaContextProps.getCurrentEnvironment(),i=E.PowerPortalTelemetryService.getInstance(),c=Object(b.getResources)();try{var p=yield Object(a.select)(y.powerPortalWebsites,n.id);if(r.isEmpty(p)||t){var u=yield Object(P.getWebsites)(e,i);if(u&&u.length>0){var d=l.getEnvironmentIdentifier(n);p=u.map(e=>{var t;return{websiteId:e.id,name:e.name,modifiedon:e.modifiedon,createdby:null!==(t=e.systemUser)&&void 0!==t&&t.fullname?e.systemUser.fullname:"",createdon:e.createdon,stampedEnvironmentIdentifier:d}})}else p=[];yield Object(a.put)(g.fetchPowerPortalWebsitesFulfilled({powerPortalWebsites:p,environmentId:n.id}))}}catch(S){var m=te(S,"getWebsites",o.initial_load);null!=m&&m.errorCode&&(yield Object(a.put)(g.fetchPowerPortalWebsitesRejected({environmentId:n.id,error:"401"===m.errorCode||"403"===m.errorCode?c.PowerPortal.Website.FetchRequest.ForbiddenError:null==m?void 0:m.message}))),ee(S,"fetchPowerPortalWebsiteListSaga",m)}}function*G(e){var t=s.SagaContextProps.getCurrentEnvironment(),n=O.SagaScenarioNames.fetchPowerPortalAppListSaga,o=Object(C.trackLoadScenario)(n,e.payload),i=e.environmentClient;try{var u=e&&e.payload,d=[];v.featureGates.showPowerPortalTile&&(d=yield B(i));var m=[];if(!r.isEmpty(d)){u.pollOptions&&(yield Object(a.spawn)(c.setupPolling,e));var b=d&&d.length>0&&d.findIndex(e=>e.PackageStatus===p.PowerPortalPackageStatus.Installed)>=0,S=yield Object(a.select)(y.powerPortalWebsites,t.id);if(b){var f=function(e,t){var n=null==e?void 0:e.find(e=>!(null==e||!e.WebsiteId)&&!(null==t?void 0:t.find(t=>t.websiteId===e.WebsiteId)));return!Object(j.isNullOrUndefined)(n)}(d,S);(r.isEmpty(S)||f)&&(yield H(i,f),S=yield Object(a.select)(y.powerPortalWebsites,t.id))}var h=l.getEnvironmentIdentifier(t);m=d.map(e=>({id:e.Id,portalProperties:e,name:e.Name,websiteProperties:W(S,e),stampedEnvironmentIdentifier:h}))}yield Object(a.put)(Object(g.fetchPowerPortalsFulfilled)({powerPortals:m,environmentId:t.id})),Object(C.trackScenarioComplete)(n,N(N({},e.payload),{},{portalResult:m}),o)}catch(I){var P,E,T,A,R;I&&I.graphQLErrors&&I.graphQLErrors.length>0&&(R=JSON.parse(I.graphQLErrors[0].message)),Object(C.trackScenarioFailure)(n,{error:{responseCode:null!==(P=R)&&void 0!==P&&P.errorCode?R.errorCode:void 0,errorMessage:null!==(E=R)&&void 0!==E&&E.message?R.message:""}},o),yield Object(a.put)(Object(g.fetchPowerPortalsRejected)({environmentId:t.id,error:{responseCode:null!==(T=R)&&void 0!==T&&T.errorCode?R.errorCode:void 0,errorMessage:null!==(A=R)&&void 0!==A&&A.message?R.message:""}})),ee(I,"fetchPowerPortalAppListSaga",R)}}function W(e,t){var n=r.find(e,(function(e){return!!t&&function(e,t){return e.websiteId.toLowerCase()===t.WebsiteId}(e,t)}));return void 0===n?r.find(e,(function(e){return!!t.WebsiteId&&e&&e.websiteId.toLowerCase()===t.WebsiteId.toLowerCase()})):n}function*q(e){var t=s.SagaContextProps.getCurrentEnvironment(),n=e.environmentClient;try{var o;yield Object(a.all)([Object(a.call)(_),Object(a.call)(B,n)]),o=yield Object(a.select)(y.powerPortalSitewideFetchError,t.id);var i=(yield Object(a.select)(y.portalStarterSolutionFetchError,t.id))||o;i?yield Object(a.put)(g.showPowerPortalCreateModalError({error:{errorCode:void 0,exceptionMessage:i},environmentId:t.id})):yield Object(a.put)(g.openPowerPortalAppModal({sampleApp:e.payload.sampleApp},n))}catch(c){var l;c&&c.graphQLErrors&&c.graphQLErrors.length>0&&(l=JSON.parse(c.graphQLErrors[0].message)),yield Object(a.put)(g.showPowerPortalCreateModalError({error:{errorCode:r.isEmpty(c.code)?void 0:c.code,exceptionMessage:c.message},environmentId:t.id})),ee(c,"fetchPowerPortalMetaData",l)}}function*z(e){var t=s.SagaContextProps.getCurrentEnvironment(),n=E.PowerPortalTelemetryService.getInstance();try{var o=e.environmentClient,i=yield Object(P.getPortalById)(o,n,e.payload.powerPortalId),c={};if(!r.isEmpty(i)){var u=yield Object(a.select)(y.powerPortalWebsites,t.id);r.isEmpty(u)&&i&&i.PackageStatus===p.PowerPortalPackageStatus.Installed&&(yield H(o),u=yield Object(a.select)(y.powerPortalWebsites,t.id)),c.id=i.Id,c.portalProperties=i,c.name=i.Name,c.websiteProperties=r.find(u,(function(e){return!!i.WebsiteId&&e&&e.websiteId.toLowerCase()===i.WebsiteId.toLowerCase()})),c.stampedEnvironmentIdentifier=l.getEnvironmentIdentifier(t)}yield Object(a.put)(g.fetchPowerPortalsAppFulfilled({powerPortal:c,environmentId:t.id}))}catch(b){var d,m;b&&b.graphQLErrors&&b.graphQLErrors.length>0&&(m=JSON.parse(b.graphQLErrors[0].message)),yield Object(a.put)(g.fetchPowerPortalsAppRejected({portalId:e.payload.powerPortalId,error:null!==(d=m)&&void 0!==d&&d.message?m.message:""})),ee(b,"fetchPowerPortalAppSaga",m)}}function*Q(e){var t=s.SagaContextProps.getCurrentEnvironment(),n=O.SagaScenarioNames.checkIfOrgIsCDS,r=Object(C.trackLoadScenario)(n),i=E.PowerPortalTelemetryService.getInstance();try{var c=e.environmentClient,p=l.getCrmInstanceUrl(t);Object(C.trackScenarioProgress)(n,{CurrentStep:"Testing orgUrl ".concat(p)},r);var u=!0;v.featureGates.showPowerPortalTile&&(u=yield Object(P.isCDSOrg)(c,i,p)),i.info("isCDSOrg","isCDSOrganization: ".concat(u)),Object(C.trackScenarioComplete)(n,{Summary:"Complete"},r),yield Object(a.put)(g.fetchIsCDSOrgFullfilled({environmentId:t.id,isCDSOrg:u}))}catch(m){var d=te(m,"isCDSOrg",o.initial_load);i.info("isCDSOrg","isCDSOrg check failed."),Object(C.trackScenarioFailure)(n,{error:Object(h.getResponseErrorMessage)(m)},r),null!=d&&d.errorCode&&(yield Object(a.put)(g.fetchIsCDSOrgRejected({environmentId:t.id,error:null!=d&&d.message?d.message:""}))),ee(m,"checkIfOrgIsCDS",d)}finally{(yield Object(a.cancelled)())&&Object(C.trackScenarioComplete)(n,{Summary:"Cancelled"},r)}}function*K(e){var t=s.SagaContextProps.getCurrentEnvironment(),n=E.PowerPortalTelemetryService.getInstance();try{var o=e.payload,i=l.getCrmInstanceUrl(t),c=yield Object(a.select)(y.portalLanguageSelector,i),S=!1,f=!1;if(o.packageName==u.PowerPortalPackageName.IdeasPortal&&(S=!0,f=!0),o.lcid)c=o.lcid;else if(!c){var h,O=yield m.MetadataClientInstance.getInstance();h=O?yield O.fetchOrganizationEnabledLanguages():[];var C=yield h;c=C&&C.length>0?String(C[0].localeId):null}if(c){yield Object(a.put)(g.resetPowerPortalCreateModalError({environmentId:t.id}));var v=e.environmentClient,T=yield Object(P.getPortalPrerequisites)(v,n,o.operation,o.orgId,o.orgUrl,o.portalId?o.portalId:"",o.packageName,c,S,f);r.isEmpty(T)||(yield Object(a.put)(g.fetchPowerPortalPrerequisitesFullfilled({environmentId:t.id,powerPortalPrerequisites:T,packageName:o.packageName})))}else{var j=Object(b.getResources)();yield Object(a.put)(g.showPowerPortalCreateModalError({error:{errorCode:"A009",exceptionMessage:j.PowerPortal.ErrorCode.A009},environmentId:t.id}))}o.packageName==u.PowerPortalPackageName.FieldServiceAppPortal&&(yield function*(e){var t=yield m.MetadataClientInstance.getInstance(),n=Object(b.getResources)(),o=yield t.retrieveFetchXmlResults({EntitySetName:"solutions",fetchXml:d.powerPortalFieldServiceSolutionFetchXml},{scenarioName:m.MCLTelemetryEventsMap.PAPortalPrefix}),r=s.SagaContextProps.getCurrentEnvironment();o&&o.value&&0==o.value.length&&(yield Object(a.put)(g.showPowerPortalCreateModalError({error:{exceptionMessage:n.PowerPortal.ErrorCode.A028,errorCode:"A028"},environmentId:r.id})));o&&o.value&&o.value.length>0&&o.value[0].version<"8.8.22"&&(yield Object(a.put)(g.showPowerPortalCreateModalError({error:{exceptionMessage:n.PowerPortal.ErrorCode.A029,errorCode:"A029"},environmentId:r.id})));yield Object(a.put)(g.resetPowerPortalOperationPrerequisites({environmentId:r.id,packageName:e,operationType:p.PowerPortalOperationType.Provision}))}(o.packageName)),o.packageName==u.PowerPortalPackageName.SCMCustomerPortal&&(yield function*(e){var t=yield m.MetadataClientInstance.getInstance(),n=Object(b.getResources)(),o=yield t.retrieveFetchXmlResults({EntitySetName:"solutions",fetchXml:d.powerPortalSCMSolutionFetchXml},{scenarioName:m.MCLTelemetryEventsMap.PAPortalPrefix}),r=s.SagaContextProps.getCurrentEnvironment();o&&o.value&&0==o.value.length&&(yield Object(a.put)(g.showPowerPortalCreateModalError({error:{errorCode:"A026",exceptionMessage:n.PowerPortal.ErrorCode.A026},environmentId:r.id})),yield Object(a.put)(g.resetPowerPortalOperationPrerequisites({environmentId:r.id,packageName:e,operationType:p.PowerPortalOperationType.Provision})))}(o.packageName)),o.packageName==u.PowerPortalPackageName.IOMOrderReturnsPortal&&(yield function*(e){var t,n=yield m.MetadataClientInstance.getInstance(),o=Object(b.getResources)(),r=yield n.retrieveFetchXmlResults({EntitySetName:"solutions",fetchXml:d.powerPortalIOMOrderReturnsSolutionFetchXml},{scenarioName:m.MCLTelemetryEventsMap.PAPortalPrefix}),i=s.SagaContextProps.getCurrentEnvironment();null!=r&&r.value&&0!=(null==r||null===(t=r.value)||void 0===t?void 0:t.length)||(yield Object(a.put)(g.showPowerPortalCreateModalError({error:{errorCode:"A032",exceptionMessage:o.PowerPortal.ErrorCode.A032},environmentId:i.id})),yield Object(a.put)(g.resetPowerPortalOperationPrerequisites({environmentId:i.id,packageName:e,operationType:p.PowerPortalOperationType.Provision})))}(o.packageName)),o.packageName==u.PowerPortalPackageName.IdeasPortal&&(yield function*(e,t){var n=yield m.MetadataClientInstance.getInstance(),o=Object(b.getResources)();t.info("checkIdeasPortalPrerequisites","Start modern community solution(s) check");var r=yield n.retrieveFetchXmlResults({EntitySetName:"solutions",fetchXml:d.powerPortalIdeasSolutionFetchXml},{scenarioName:m.MCLTelemetryEventsMap.PAPortalPrefix}),i=s.SagaContextProps.getCurrentEnvironment(),l=!0;r&&r.value&&0!=r.value.length||(l=!1,yield Object(a.put)(g.showPowerPortalCreateModalError({error:{exceptionMessage:o.PowerPortal.ErrorCode.A027,errorCode:"A027"},environmentId:i.id})),yield Object(a.put)(g.resetPowerPortalOperationPrerequisites({environmentId:i.id,packageName:e,operationType:p.PowerPortalOperationType.Provision})));t.info("checkIdeasPortalPrerequisites","End modern community solution(s) check. isSolutionPresent: ".concat(l))}(o.packageName,n))}catch(I){var A=oe(I),R={errorCode:A&&A.ErrorCode?A.ErrorCode:void 0,exceptionMessage:A&&A.Message?A.Message:"",detailedMessage:A&&A.Message?A.Message:"",licenseCount:A&&A.LicenseCount?A.LicenseCount:""};yield Object(a.put)(g.showPowerPortalCreateModalError({error:R,environmentId:t.id})),A.ExceptionMessage=A.Message,A.Message=Object(u.getPowerPortalErrorMessageAndLogTheException)(R),ee(I,"fetchPowerPortalPrerequisites",A)}}function*Y(e){var t=yield m.MetadataClientInstance.getInstance(),n=Object(b.getResources)(),o=O.SagaScenarioNames.fetchCdsOrganizationSettings,r=Object(C.trackLoadScenario)(o),i=s.SagaContextProps.getCurrentEnvironment();try{var l,c={EntitySetName:"organizations",fetchXml:d.powerPortalOrganizationFetchXml},p={scenarioName:m.MCLTelemetryEventsMap.PAPortalPrefix},u=yield t.retrieveFetchXmlResults(c,p);u&&null!=u&&u.value&&0!=(null==u||null===(l=u.value)||void 0===l?void 0:l.length)||(yield Object(a.put)(g.fetchCdsOrgSettingsError({error:{exceptionMessage:n.PowerPortal.CreateAppModal.ErrorCode.A040,errorCode:"A040"},environmentId:i.id})));var y=u.value[0];yield Object(a.put)(g.fetchCdsOrgSettingsFulfilled({organizationSettings:y})),Object(C.trackScenarioComplete)(o,{currentEnvironment:i},r)}catch(S){Object(C.trackScenarioFailure)(o,{error:S.message},r)}}function*J(e){var t=O.SagaScenarioNames.checkDeletePermissions,{powerPortal:n,navigate:o,redirectUrl:i}=e.payload,c=Object(C.trackLoadScenario)(t,{powerPortal:n,redirectUrl:i,navigateExists:!!o});try{var u=s.SagaContextProps.getCurrentEnvironment(),d=E.PowerPortalTelemetryService.getInstance(),m=e.payload.environmentClient,b=yield Object(P.getPortalPrerequisites)(m,d,p.PowerPortalOperationType.Delete,l.getCrmInstanceId(u),l.getCrmInstanceUrl(u),e.payload.powerPortal.id,e.payload.powerPortal.portalProperties.PackageName,e.payload.powerPortal.portalProperties.Lcid,!0,!1),y=!r.isEmpty(b)&&b.IsAllowed;yield Object(a.put)(g.checkDeletePermissionFullFilled({powerPortal:e.payload.powerPortal,isDeleteAllowed:y,redirectUrl:e.payload.redirectUrl,navigate:e.payload.navigate,environmentClient:m})),Object(C.trackScenarioComplete)(t,N(N({},e.payload),{},{isDeleteAllowed:y,environmentClient:null}),c)}catch(f){var S=oe(f);Object(C.trackScenarioFailure)(t,{powerPortalError:{errorCode:S&&S.ErrorCode?S.ErrorCode:"",exceptionMessage:S&&S.Message?S.Message:""}},c),yield Object(a.put)(g.checkDeletePermissionRejected({powerPortalError:{errorCode:S&&S.ErrorCode?S.ErrorCode:"",exceptionMessage:S&&S.Message?S.Message:""},portalName:e.payload.powerPortal.name}))}}function*X(e){var t=s.SagaContextProps.getCurrentEnvironment(),n=E.PowerPortalTelemetryService.getInstance(),o=e.payload.environmentClient,r=O.SagaScenarioNames.deletePowerPortalAppSaga,{powerPortal:i,navigate:c,redirectUrl:u}=e.payload,d=Object(C.trackDeleteScenario)(r,{powerPortal:i,redirectUrl:u,navigateExists:!!c});try{var m=l.getCrmInstanceId(t),b=yield Object(P.deletePortal)(o,n,e.payload.powerPortal.id,m);b&&(yield Object(a.put)(Object(S.closeConfirmDialog)()),e.payload.redirectUrl?e.payload.navigate(e.payload.redirectUrl,!0):yield Object(a.put)(g.fetchPowerPortalsListRequest(e.payload.environmentClient,{forceRefresh:!0})),yield Object(a.put)(g.resetPowerPortalOperationPrerequisites({environmentId:t.id,packageName:e.payload.powerPortal.portalProperties.PackageName,operationType:p.PowerPortalOperationType.Provision})),yield Object(a.put)(g.clearPowerPortalGenericErrorMessage({environmentId:t.id}))),Object(C.trackScenarioComplete)(r,N(N({},e.payload),{},{status:b,environmentClient:null}),d)}catch(j){var y,f,h,v,T;j&&j.graphQLErrors&&j.graphQLErrors.length>0&&(T=JSON.parse(j.graphQLErrors[0].message)),Object(C.trackScenarioFailure)(r,{error:{errorCode:null!==(y=T)&&void 0!==y&&y.errorCode?T.errorCode:void 0,exceptionMessage:null!==(f=T)&&void 0!==f&&f.message?T.message:""}},d),yield Object(a.put)(g.deletePowerPortalAppRejected({powerPortalError:{errorCode:null!==(h=T)&&void 0!==h&&h.errorCode?T.errorCode:void 0,exceptionMessage:null!==(v=T)&&void 0!==v&&v.message?T.message:""}})),ee(j,"deletePowerPortalAppSaga",T)}}function*Z(e){var t=O.SagaScenarioNames.fetchPowerPortalPrerequisitesForPortalDialog,n=Object(C.trackLoadScenario)(t),o=s.SagaContextProps.getCurrentEnvironment();try{if(!(yield Object(a.select)(y.powerPortalPrerequisitesSelector,o.id,p.PowerPortalOperationType.Provision,e.payload.packageName))){yield Object(a.put)(Object(g.componentStateRequestInitiated)());var r=l.getCrmInstanceUrl(o);(yield Object(a.select)(f.sharedSelectors.orgEnabledLanguagesSelector,r))||(yield Object(a.put)(Object(S.fetchOrgEnabledLanguages)()),yield Object(a.take)([S.SharedActionTypes.FETCH_ORG_ENABLED_LANGUAGES_FULFILLED,g.PowerPortalActionTypes.SHOW_POWER_PORTAL_CREATE_MODAL_ERROR])),yield K(e),yield Object(a.put)(Object(g.componentStateRequestCompleted)())}Object(C.trackScenarioComplete)(t,e.payload,n)}catch(i){Object(C.trackScenarioFailure)(t,{error:i.message},n)}}function*$(e){var t=e.payload.environmentClient,n=s.SagaContextProps.getAadUser().tenantId;try{var o=yield Object(I.checkPowerPortalFeaturesEnabled)(t,E.PowerPortalTelemetryService.getInstance(),I.PowerPortalsFeatures.MOONCAKE,n);yield Object(a.put)(g.updatePowerPortalFeatures(o.features[0].value))}catch(r){yield Object(a.put)(g.updatePowerPortalFeatures(!1))}}function ee(e,t,n){var o={error:e,operationName:t,errorDetails:n};E.PowerPortalTelemetryService.getInstance().error(T.PerfEventName.SITEWIDE_GRAPHQL_CALL,t+": Sitewide GraphQL calls failed",o)}function te(e,t,n){var o,r,a,i,s,l=null!=e&&e.message?e.message:(null==e?void 0:e.length)>0?e[0].message:void 0;if(re.get(t))if((null==e||null===(r=e.graphQLErrors)||void 0===r?void 0:r.length)>0){var c,p=ne(e.graphQLErrors[0].message);if(p)o=p.errorCode,l=null!==(c=p.message)&&void 0!==c?c:"";else ee(e,t+"_"+n+"_Failed to get sitewide error code",l)}else ee(e,t+"_"+n+"_Something went wrong",l);else if((null==e||null===(a=e.message)||void 0===a?void 0:a.indexOf("status code 401"))>0)o="401",l=e.message;else if((null==e||null===(i=e.message)||void 0===i?void 0:i.indexOf("status code 403"))>0)o="403",l=e.message;else if((null==e||null===(s=e.graphQLErrors)||void 0===s?void 0:s.length)>0){var u,d=ne(e.graphQLErrors[0].message);if(d)o=d.errorCode,l=null!==(u=d.message)&&void 0!==u?u:"";else ee(e,t+"_"+n+"_Failed to get sitewide error code",l)}else if((null==e?void 0:e.length)>0){var m,b=ne(e[0].message);if(b)o=b.httpStatusCode,l=null!==(m=b.data)&&void 0!==m?m:"";else ee(e,t+"_"+n+"_Failed to get httpStatusCode",l)}return{errorCode:o,message:l}}function ne(e){var t;try{t=JSON.parse(e)}catch(n){t=void 0,ee(n,"Failed to parse JSON",e)}return t}function oe(e){var t,n={ErrorCode:"",ExceptionMessage:"",Message:"",LicenseCount:""};try{if(e&&e.message&&(e.message.indexOf("401")>0||e.message.indexOf("403")>0))n.ErrorCode="D004",n.Message=e.message;else if(e&&e.length>0){var o,r;t=null!==(o=t=JSON.parse(e[0].message))&&void 0!==o&&o.data?null===(r=t)||void 0===r?void 0:r.data:t}else if(e&&e.graphQLErrors&&e.graphQLErrors.length>0){var a,i;t=null!==(a=t=JSON.parse(e.graphQLErrors[0].message))&&void 0!==a&&a.data?null===(i=t)||void 0===i?void 0:i.data:t}t&&(n.ErrorCode=t.ErrorCode?t.ErrorCode:void 0,n.Message=t.Message?t.Message:"",n.LicenseCount=t.LicenseCount?t.LicenseCount:"")}catch(s){ee(s,"Failed to parse Exception",e)}return n}!function(e){e.initial_load="initial_load",e.create_portal="create_portal"}(o||(o={}));var re=new Map([["listPortalsByOrgId",!0],["getWebsites",!0],["getWebsiteBindings",!0],["isCDSOrg",!0],["createPortal",!1]]);t.default=function*(){yield Object(a.takeLatest)(g.PowerPortalActionTypes.CREATE_POWER_PORTALS_REQUEST,M),yield Object(a.takeLatest)(g.PowerPortalActionTypes.SUBDOMAIN_VERIFICATION_REQUEST,k),yield Object(a.takeEvery)(g.PowerPortalActionTypes.FETCH_POWER_PORTALS_REQUEST,G),yield Object(a.takeEvery)(g.PowerPortalActionTypes.FETCH_PREREQUISITES_REQUEST_FOR_POWER_PORTAL_DIALOG,x),yield Object(a.takeEvery)(g.PowerPortalActionTypes.FETCH_POWER_PORTAL_METADATA,q),yield Object(a.takeLatest)(g.PowerPortalActionTypes.RETRY_PROVISION_POWER_PORTALS_APP,U),yield Object(a.takeLatest)(g.PowerPortalActionTypes.POWER_PORTAL_SETTINGS_UPDATE_NAME_REQUEST,V),yield Object(a.takeLatest)(g.PowerPortalActionTypes.FETCH_POWER_PORTALS_APP_REQUEST,z),yield Object(a.takeLatest)(g.PowerPortalActionTypes.FETCH_POWER_PORTAL_STARTER_SOLUTION_REQUEST,_),w.featureGates.enableCanvasAppsInSolutionsByDefault&&(yield Object(a.takeLatest)(g.PowerPortalActionTypes.FETCH_CDS_ORG_SETTINGS_REQUEST,Y)),v.featureGates.showPowerPortalTile&&(yield Object(a.takeLatest)(g.PowerPortalActionTypes.FETCH_ISCDSORG_REQUEST,Q),yield Object(a.takeLatest)(g.PowerPortalActionTypes.FETCH_POWER_PORTAL_FEATURE,$)),yield Object(a.takeLatest)(g.PowerPortalActionTypes.FETCH_POWER_PORTAL_PREREQUISITES_REQUEST,K),yield Object(a.takeLatest)(g.PowerPortalActionTypes.CHECK_DELETE_PERMISSION,J),yield Object(a.takeLatest)(g.PowerPortalActionTypes.DELETE_POWER_PORTALS_APP,X),yield Object(a.takeLatest)(g.PowerPortalActionTypes.FETCH_PREREQUISITES_REQUEST_FOR_POWER_PORTAL_DIALOG,Z)}},6545:function(e,t,n){"use strict";n.r(t),n.d(t,"PowerPortalSpecificActionsMiddleware",(function(){return L}));var o=n(2812),r=n(6539),a=n(6541),i=n(5668),s=n(5656),l=n(5657),c=n(5606),p=n(5604),u=n(5645),d=n(5478),m=n(5876),b=n(5493),g=n(2869),y=n(5630),S=n(5623),f=n(5654),h=n(5653),O=n(5468),C=n(5667),v=n(5987),P=n(5626),E=n(5644),T=n(2880),j=n(5593),A=n(5669),R=n(5646),I=n(4200);function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function D(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(Object(n),!0).forEach((function(t){N(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function N(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function L(){return e=>t=>n=>{var w,N,L,{dispatch:x}=e,k=n,F=e.getState(),_=c.SagaContextProps.getCurrentEnvironment(),U=a.powerPortalSelectors.environmentHasCDSOrgSelector(F,_.id),V=Object(g.getResources)(),B=Object(P.allowListFeaturesSelector)(F).EnablePowerPortalPublicPreview,H=p.getCrmInstanceUrl(_);switch(k.type){case C.PowerPortalActionTypes.CREATE_POWER_PORTAL_MODULE:var G=Object(u.getPowerPortalPackageName)(k.payload.staticSampleAppId,U),W=Object(v.powerPortalPrerequisitesSelector)(F,_.id,E.PowerPortalOperationType.Provision,G),q={orgId:p.getCrmInstanceId(_),orgName:p.getCrmInstanceFriendlyName(_),orgUrl:H,portalName:k.payload.portalName,packageName:G,portalLanguage:Object(v.portalLanguageSelector)(F,H),subDomain:Object(v.portalSubDomainSelector)(F),websiteId:Object(v.websiteIdSelector)(F,H),isFieldService:Object(v.partnerPortalFieldServiceSelector)(F),isProjectService:Object(v.partnerPortalProjectServiceSelector)(F),enableEngagementInsights:k.payload.enableEngagementInsights};G==u.PowerPortalPackageName.IdeasPortal&&(q.skipPackageInstallation=!0,q.skipDuplicatePortalCheck=!0),x(Object(C.CreatePowerPortalRequest)({powerPortalProvisioningRequestConfig:q,enablePowerPortalPublicPreview:B,isPackageInstalled:W&&W.IsPackageInstalled,navigate:k.payload.navigate,environmentClient:k.payload.environmentClient}));break;case C.PowerPortalActionTypes.CREATE_POWER_PORTAL_FULFILLED:x(Object(C.resetCreatePowerPortalFields)()),k.payload.websiteId&&k.payload.isPackageInstalled?(R.PowerPortalTelemetryService.getInstance().getAnalyticsTracker(I.PerfEventName.MAKER_LOAD).startTracking(I.PerfEventName.MAKER_LOAD+"_PA_Home_Create",I.PerfEventType.LOAD),k.payload.navigate(Object(S.getMakerNavigateUrl)(k.payload.websiteId),!0)):x(Object(C.fetchPowerPortalsListRequest)(k.payload.environmentClient,{forceRefresh:!0})),x(Object(f.closeSampleAppModal)());break;case C.PowerPortalActionTypes.SHARE_POWER_PORTALS_APP:R.PowerPortalTelemetryService.getInstance().info(C.PowerPortalActionTypes.SHARE_POWER_PORTALS_APP,JSON.stringify(M("share power portal app Clicked",_,F))),x(O.sharedActions.panelOpen({panelType:d.PanelToShowType.PowerPortalSharePanel,panelProps:{powerPortal:k.payload.powerPortal}}));break;case C.PowerPortalActionTypes.CUSTOMIZE_POWER_PORTALS_APP:R.PowerPortalTelemetryService.getInstance().info(C.PowerPortalActionTypes.CUSTOMIZE_POWER_PORTALS_APP,JSON.stringify(M("Maker Edit Clicked",_,F))),R.PowerPortalTelemetryService.getInstance().getAnalyticsTracker(I.PerfEventName.MAKER_LOAD).startTracking(I.PerfEventName.MAKER_LOAD+"_PA_Home_Edit",I.PerfEventType.LOAD),k.payload.navigate(Object(S.getMakerNavigateUrl)(k.payload.websiteId),!0);break;case C.PowerPortalActionTypes.OPEN_POWER_PORTAL_APPMODAL:if(o.isEmpty(k.payload)){var z=b.default.getPaths();k.payload={sampleApp:new l.StaticSampleApp({id:l.StaticSampleAppId.NewPowerPortalApp,displayName:V.SampleTile.StartFromBlank.Portal.title,description:B?V.SampleApps.AppModule.createFromBlankPortal.publicPreviewDescription:V.SampleApps.AppModule.createFromBlankPortal.description,imageUrls:{phone:z.createPortalFromBlankCombined,tablet:z.createPortalFromBlankCombined,default:z.createPortalFromBlankCombined},modalImageUrls:{default:z.createPortalFromBlankCombinedModal}})}}var Q=Object(u.getPowerPortalPackageName)(k.payload.sampleApp.uniqueName,U),K=p.environmentHasCds2Database(_);if(B)K&&(x(Object(C.updateAppModelDetails)({environmentClient:k.environmentClient,packageName:Q})),x(Object(C.fetchPowerPortalPrerequisitesRequestPortalDialog)({operation:E.PowerPortalOperationType.Provision,orgId:p.getCrmInstanceId(_),orgUrl:H,portalId:null,packageName:Q,lcid:null},k.environmentClient))),R.PowerPortalTelemetryService.getInstance().getAnalyticsTracker(I.PerfEventName.CREATE_PORTAL).startTracking(I.PerfEventName.CREATE_PORTAL+"_PORTAL_FROM_BLANK",I.PerfEventType.CREATE),x(Object(h.createAppModule)(k.payload));else{var Y=a.powerPortalSelectors.powerPortalSitewideListSelector(F,_.id),J=Object(v.powerPortalStarterSolutionStatusSelector)(F,_.id);!K||Y&&0===Y.length&&J?(R.PowerPortalTelemetryService.getInstance().getAnalyticsTracker(I.PerfEventName.CREATE_PORTAL).startTracking(I.PerfEventName.CREATE_PORTAL+"_PORTAL_FROM_BLANK",I.PerfEventType.CREATE),x(Object(h.createAppModule)(k.payload))):o.isEmpty(Y)?x(J?Object(C.fetchPowerPortalMetaData)(D(D({},k.payload),{},{powerPortalPublicPreview:B}),k.environmentClient):O.sharedActions.openConfirmDialog({hidden:!1,title:V.PowerPortal.Entities.NotFound.title,subText:V.PowerPortal.Entities.NotFound.message,confirmButtonText:V.MakerDashboard.CreateEnvironment.text,cancelButtonText:V.Controllers.Properties.okButton,onConfirm:()=>{x(Object(y.logAction)(O.sharedActions.panelOpen({panelType:d.PanelToShowType.CreateEnvironmentPanel,panelProps:{sampleAppType:s.SampleAppTypes.PowerPortal}}),m.CreateEnvironmentPanelEvents.CreatePanelOpened.eventName)),x(O.sharedActions.closeConfirmDialog())},hideCancelButton:!1})):x(O.sharedActions.openConfirmDialog({hidden:!1,title:V.PowerPortal.Already.Exist.title,subText:V.PowerPortal.Already.Exist.message,confirmButtonText:V.Controllers.Properties.okButton,onConfirm:()=>{x(O.sharedActions.closeConfirmDialog())},hideCancelButton:!0}))}break;case C.PowerPortalActionTypes.OPEN_POWER_PORTAL_SETTINGS:R.PowerPortalTelemetryService.getInstance().info(C.PowerPortalActionTypes.OPEN_POWER_PORTAL_SETTINGS,JSON.stringify(M("power portal setting Clicked",_,F))),x(O.sharedActions.panelOpen({panelType:d.PanelToShowType.PowerPortalSettingPanel,panelProps:{selectedPowerPortalId:k.payload.powerPortal.id}}));break;case C.PowerPortalActionTypes.SHOW_DETAILS_POWER_PORTALS_APP:R.PowerPortalTelemetryService.getInstance().info(C.PowerPortalActionTypes.SHOW_DETAILS_POWER_PORTALS_APP,JSON.stringify(M("power portal show details Clicked",_,F)));var X=k.payload.powerPortalId;k.payload.navigate(Object(S.getPowerPortalDetailsUrl)(X),!0);break;case C.PowerPortalActionTypes.BROWSE_POWER_PORTALS_APP:if(R.PowerPortalTelemetryService.getInstance().info(C.PowerPortalActionTypes.BROWSE_POWER_PORTALS_APP,JSON.stringify(M("power portal show details Clicked",_,F))),B&&k.payload.powerPortal.portalProperties.PackageStatus===E.PowerPortalPackageStatus.InstallFailed)x(Object(C.powerPortalGenericErrors)({error:{exceptionMessage:V.PowerPortal.ProvisionFailedError},environmentId:_.id}));else switch(Object(u.getPortalState)(k.payload.powerPortal.portalProperties.CategoryBrowse)){case u.PowerPortalState.ProvisioningComplete:Object(y.logAction)(x(O.sharedActions.openNewTab({uri:k.payload.powerPortal.portalProperties.PortalUrl})),i.PowerPortalListCommandEvents.LaunchPowerPortalUrl.eventName,i.PowerPortalListCommandEvents.LaunchPowerPortalUrl.getData(k.payload.powerPortal));break;case u.PowerPortalState.ProvisioningInProgress:Object(y.logAction)(x(O.sharedActions.openConfirmDialog({hidden:!1,title:V.PowerPortal.Browse.Modal.Provision.title,subText:V.PowerPortal.Browse.Modal.Provision.text,onConfirm:()=>{e.dispatch(O.sharedActions.closeConfirmDialog())},showCloseButton:!0,hideCancelButton:!0,confirmButtonText:V.Common.Save.cancel})),i.PowerPortalListCommandEvents.ProvisionInProgressDialog.eventName,i.PowerPortalListCommandEvents.ProvisionInProgressDialog.getData(k.payload.powerPortal));break;case u.PowerPortalState.RetryProvision:Object(y.logAction)(x(O.sharedActions.openConfirmDialog({hidden:!1,title:V.PowerPortal.Browse.Modal.ProvisionFailed.title,subText:V.PowerPortal.Browse.Modal.ProvisionFailed.text,onConfirm:()=>{e.dispatch(Object(C.retryPowerPortalProvision)({portalId:n.payload.powerPortal.portalProperties.Id,environmentClient:n.payload.environmentClient})),e.dispatch(O.sharedActions.closeConfirmDialog())},showCloseButton:!0,hideCancelButton:!1,confirmButtonText:V.PowerPortal.Browse.Modal.ProvisionFailed.FooterButton.retry,cancelButtonText:V.Common.Save.cancel})),i.PowerPortalListCommandEvents.ProvisionFailedDialog.eventName,i.PowerPortalListCommandEvents.ProvisionFailedDialog.getData(k.payload.powerPortal));break;case u.PowerPortalState.NonRetryable:case u.PowerPortalState.Suspended:var Z=Object(u.getPortalStatus)(k.payload.powerPortal),$=Object(r.getPowerPortalAdministrationUrl)(k.payload.powerPortal.portalProperties.CrmGeo,k.payload.powerPortal.id,k.payload.powerPortal.portalProperties.Lcid);Z===u.PowerPortalStatus.StateSuspended?Object(y.logAction)(x(O.sharedActions.openConfirmDialog({hidden:!1,title:V.PowerPortal.Browse.Modal.StateSuspended.title,subText:Object(T.formatResourceString)(V.PowerPortal.Browse.Modal.StateSuspended.text,k.payload.powerPortal.name,k.payload.powerPortal.portalProperties.SuspendedPortalDeletingInDays),onConfirm:()=>{window.open($,"_blank"),e.dispatch(O.sharedActions.closeConfirmDialog())},showCloseButton:!0,hideCancelButton:!1,confirmButtonText:V.PowerPortal.Trial.upgradeMyTrial,cancelButtonText:V.Common.Save.cancel})),i.PowerPortalListCommandEvents.ProvisionFailedNonRetryableDialog.eventName,i.PowerPortalListCommandEvents.ProvisionFailedNonRetryableDialog.getData(k.payload.powerPortal)):Object(y.logAction)(x(O.sharedActions.openConfirmDialog({hidden:!1,title:V.PowerPortal.Browse.Modal.ProvisionFailed.NonRetryable.title,subText:V.PowerPortal.Browse.Modal.ProvisionFailed.NonRetryable.text,onConfirm:()=>{e.dispatch(O.sharedActions.closeConfirmDialog())},showCloseButton:!0,hideCancelButton:!0,confirmButtonText:V.Common.Save.cancel})),i.PowerPortalListCommandEvents.ProvisionFailedNonRetryableDialog.eventName,i.PowerPortalListCommandEvents.ProvisionFailedNonRetryableDialog.getData(k.payload.powerPortal))}break;case C.PowerPortalActionTypes.OPEN_POWER_PORTAL_DELETE_DIALOG:R.PowerPortalTelemetryService.getInstance().info(C.PowerPortalActionTypes.OPEN_POWER_PORTAL_DELETE_DIALOG,JSON.stringify(M("power portal delete Clicked",_,F))),x(O.sharedActions.openConfirmDialog({hidden:!1,title:"",subText:"",showCloseButton:!0,hideCancelButton:!0,isComponentLoading:!0,maxWidth:482})),x(Object(C.checkDeletePermission)({powerPortal:k.payload.powerPortal,redirectUrl:k.payload.redirectUrl,navigate:k.payload.navigate,environmentClient:k.payload.environmentClient}));break;case C.PowerPortalActionTypes.CHECK_DELETE_PERMISSION_FULLFILLED:var ee,te;if(k.payload.isDeleteAllowed)Object(y.logAction)(x(O.sharedActions.openConfirmDialog({hidden:!1,title:Object(T.formatResourceString)(V.PowerPortal.Delete.DialogDelete.title,k.payload.powerPortal.name),subText:Object(T.formatResourceString)(V.PowerPortal.Delete.DialogDelete.message),cancelButtonText:V.Common.cancel,confirmButtonText:V.PowerPortal.Delete.DialogDelete.confirm,onConfirm:()=>{var{powerPortal:t,navigate:o,redirectUrl:r}=n.payload;Object(j.trackUserActionClickButton)(A.PowerPortalClickActions.DeleteDialogConfirmationClickEvent,{powerPortal:t,redirectUrl:r,navigateExists:!!o}),R.PowerPortalTelemetryService.getInstance().info(A.PowerPortalClickActions.DeleteDialogConfirmationClickEvent,JSON.stringify(M("power portal delete after confirmation",_,F))),e.dispatch(Object(C.deletePowerPortalApp)({powerPortal:n.payload.powerPortal,redirectUrl:n.payload.redirectUrl,navigate:n.payload.navigate,environmentClient:n.payload.environmentClient}))},isDestructive:!0,showCloseButton:!0,maxWidth:482,isComponentLoading:!1})),i.PowerPortalListCommandEvents.Delete.eventName,i.PowerPortalListCommandEvents.Delete.getData(k.payload.powerPortal));else ee=V.PowerPortal.Delete.DialogPermissionDenied.title,te=Object(T.formatResourceString)(V.PowerPortal.Delete.DialogPermissionDenied.message,k.payload.powerPortal.name),x(O.sharedActions.openConfirmDialog({hidden:!1,title:ee,subText:te,onConfirm:()=>{e.dispatch(O.sharedActions.closeConfirmDialog())},showCloseButton:!0,hideCancelButton:!0,confirmButtonText:V.Common.ok,isComponentLoading:!1,maxWidth:482}));break;case C.PowerPortalActionTypes.CHECK_DELETE_PERMISSION_REJECTED:var ne,oe;"D004"===k.payload.powerPortalError.errorCode?(oe=Object(T.formatResourceString)(V.PowerPortal.Delete.DialogPermissionDenied.message,k.payload.portalName),ne=V.PowerPortal.Delete.DialogPermissionDenied.title):(oe=Object(u.getPowerPortalErrorMessageAndLogTheException)(k.payload.powerPortalError),ne=V.PowerPortal.Delete.DialogDelete.Error.Title),x(O.sharedActions.openConfirmDialog({hidden:!1,title:ne,subText:oe,onConfirm:()=>{e.dispatch(O.sharedActions.closeConfirmDialog())},showCloseButton:!0,hideCancelButton:!0,confirmButtonText:V.Common.ok,isComponentLoading:!1,maxWidth:482}));break;case C.PowerPortalActionTypes.DELETE_POWER_PORTAL_REJECTED:var re=Object(u.getPowerPortalErrorMessageAndLogTheException)(k.payload.powerPortalError);x(O.sharedActions.openConfirmDialog({hidden:!1,title:V.PowerPortal.Delete.DialogDelete.Error.Title,subText:re,onConfirm:()=>{e.dispatch(O.sharedActions.closeConfirmDialog())},showCloseButton:!0,hideCancelButton:!0,confirmButtonText:V.Common.ok,isComponentLoading:!1,maxWidth:482}));break;case C.PowerPortalActionTypes.LANGUAGE_SELECTED:var ae=Object(u.getPowerPortalPackageName)(null==F||null===(w=F.sampleApps)||void 0===w||null===(N=w.currentOpenSampleAppModal)||void 0===N?void 0:N.uniqueName,U);x(Object(C.fetchPowerPortalPrerequisitesRequest)({operation:E.PowerPortalOperationType.Provision,orgId:p.getCrmInstanceId(_),orgUrl:H,portalId:null,packageName:ae,lcid:n.payload},null==F||null===(L=F.powerPortalApps)||void 0===L?void 0:L.environmentClient))}return t(n)}}function M(e,t,n){var o;return{actionDetail:e,currentEnvId:null==t?void 0:t.id,powerPortalOperationType:E.PowerPortalOperationType.Provision,componentLoadState:null==n||null===(o=n.powerPortalApps)||void 0===o?void 0:o.componentLoadState}}},6546:function(e,t,n){"use strict";n.r(t),n.d(t,"defaultState",(function(){return d})),n.d(t,"reducer",(function(){return b}));var o=n(5470),r=n(5667),a=n(5629),i=n(2867),s=n(5988),l=n(2812);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var d={fetchOrganizationSettingsError:{},organizationSettings:null,portalSubDomainStatus:void 0,portalSubDomain:void 0,portalSelectedLangauge:void 0,websiteSelectedId:void 0,showTermsOfService:!1,portalCreateModalErrorMessage:{},CdsStarterSolutionInstallationStatusMap:Object(i.Map)(),fetchStarterSolutionErrorByEnvironment:{},powerPortalsFromSitewide:Object(i.Map)(),powerPortalsFromSitewideExists:Object(i.Map)(),powerPortals:new o.CaseInsensitiveNormalized,powerPortalWebsites:Object(i.Map)(),powerPortalWebsiteBindings:Object(i.Map)(),powerPortalsFetchErrorByEnvironment:{},fetchPortalsFromSitewideErrorByEnvironment:{},powerPortalWebsitesFetchError:Object(i.Map)(),powerPortalWebsiteBindingsFetchError:Object(i.Map)(),isPortalCreateInProgress:!1,updatePowerPortalSettingsError:"",updatePowerPortalSettingsIsInProgress:!1,powerPortalsAppFetchError:Object(i.Map)(),enablePartnerPortalFieldService:!1,enablePartnerPortalProjectService:!1,componentLoadState:void 0,environmentHasCDSOrg:Object(i.Map)(),powerPortalOperationPrerequisites:Object(i.Map)(),fetchIsCDSOrgErrorByEnvironment:{},powerPortalGenericError:{},packageName:"",environmentClient:null,enableEngagementInsights:!1,isPowerPortalFeaturesEnabled:!1};function m(e,t,n,o,r){var a=e.get(o);a||(a=Object(i.Map)());var s=a.get(r);if(s||(s=Object(i.Map)()),s=s.set(r,n),a=a.set(o,s),e.get(t)){var l=e.get(t).set(o,s);return e.set(t,l)}return e.set(t,a)}function b(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case r.PowerPortalActionTypes.SUBDOMAIN_VERIFICATION_REQUEST:return Object(l.assign)({},t,{portalSubDomainStatus:s.SubDomainStatus.Loading});case r.PowerPortalActionTypes.SUBDOMAIN_VERIFICATION_FULFILLED:return Object(l.assign)({},t,{portalSubDomainStatus:n.payload.portalSubDomainStatus,portalSubDomain:n.payload.portalSubDomain});case r.PowerPortalActionTypes.INVALID_SUBDOMAIN_SELECTED:return Object(l.assign)({},t,{portalSubDomain:void 0});case r.PowerPortalActionTypes.RESET_POWER_PORTAL_CREATE_MODAL_FIELDS:return Object(l.assign)({},t,{portalSubDomain:void 0,portalSubDomainStatus:void 0,portalSelectedLangauge:void 0,websiteSelectedId:void 0,portalCreateModalErrorMessage:{},enablePartnerPortalFieldService:void 0,enablePartnerPortalProjectService:void 0,enableEngagementInsights:!1});case r.PowerPortalActionTypes.LANGUAGE_SELECTED:return Object(l.assign)({},t,{portalSelectedLangauge:n.payload});case r.PowerPortalActionTypes.WEBSITEID_SELECTED:return Object(l.assign)({},t,{websiteSelectedId:n.payload});case r.PowerPortalActionTypes.SHOW_PORTAL_TERMS_OF_SERVICE_MODAL:return p(p({},t),{},{showTermsOfService:!0});case r.PowerPortalActionTypes.HIDE_PORTAL_TERMS_OF_SERVICE_MODAL:return p(p({},t),{},{showTermsOfService:!1});case r.PowerPortalActionTypes.SHOW_POWER_PORTAL_CREATE_MODAL_ERROR:var i=p({},t.portalCreateModalErrorMessage);return i[n.payload.environmentId]=n.payload.error,Object(l.assign)({},t,{portalCreateModalErrorMessage:i,isPortalCreateInProgress:!1});case r.PowerPortalActionTypes.RESET_POWER_PORTAL_CREATE_MODAL_ERROR:var c=p({},t.portalCreateModalErrorMessage);return delete c[n.payload.environmentId],Object(l.assign)({},t,{portalCreateModalErrorMessage:c,isPortalCreateInProgress:!1});case r.PowerPortalActionTypes.FETCH_POWER_PORTAL_STARTER_SOLUTION_FULFILLED:var u=p({},t.fetchStarterSolutionErrorByEnvironment);return delete u[n.payload.environmentId],p(p({},t),{},{CdsStarterSolutionInstallationStatusMap:t.CdsStarterSolutionInstallationStatusMap.set(n.payload.environmentId,n.payload.isPortalStarterSolutionInstalled),fetchStarterSolutionErrorByEnvironment:u});case r.PowerPortalActionTypes.FETCH_POWER_PORTAL_STARTER_SOLUTION_REJECTED:var b=p({},t.fetchStarterSolutionErrorByEnvironment);return b[n.payload.environmentId]=n.payload.error,p(p({},t),{},{fetchStarterSolutionErrorByEnvironment:b});case r.PowerPortalActionTypes.FETCH_POWER_PORTALS_SITEWIDE_FULFILLED:var g=p({},t.fetchPortalsFromSitewideErrorByEnvironment);return delete g[n.payload.environmentId],p(p({},t),{},{powerPortalsFromSitewide:t.powerPortalsFromSitewide.set(n.payload.environmentId,n.payload.powerPortals),powerPortalsFromSitewideExists:t.powerPortalsFromSitewideExists.set(n.payload.environmentId,n.payload.sitewideExists),fetchPortalsFromSitewideErrorByEnvironment:g});case r.PowerPortalActionTypes.FETCH_POWER_PORTALS_SITEWIDE_REJECTED:var y=p({},t.fetchPortalsFromSitewideErrorByEnvironment);return y[n.payload.environmentId]=n.payload.error,p(p({},t),{},{fetchPortalsFromSitewideErrorByEnvironment:y});case r.PowerPortalActionTypes.FETCH_POWER_PORTALS_FULFILLED:var S=p({},t.powerPortalsFetchErrorByEnvironment);return delete S[n.payload.environmentId],p(p({},t),{},{powerPortals:Object(o.updateNormalizedData)(t.powerPortals,n.payload.powerPortals,n.payload.environmentId),powerPortalsFetchErrorByEnvironment:S});case r.PowerPortalActionTypes.FETCH_POWER_PORTALS_REJECTED:var f=p({},t.powerPortalsFetchErrorByEnvironment);return f[n.payload.environmentId]=n.payload.error,p(p({},t),{},{powerPortalsFetchErrorByEnvironment:f});case r.PowerPortalActionTypes.CREATE_POWER_PORTALS_REQUEST:return p(p({},t),{},{isPortalCreateInProgress:!0});case r.PowerPortalActionTypes.CREATE_POWER_PORTAL_FULFILLED:return p(p({},t),{},{isPortalCreateInProgress:!1});case r.PowerPortalActionTypes.FETCH_POWER_PORTAL_WEBSITE_FULFILLED:return p(p({},t),{},{powerPortalWebsites:t.powerPortalWebsites.set(n.payload.environmentId,n.payload.powerPortalWebsites),powerPortalWebsitesFetchError:t.powerPortalWebsitesFetchError.set(n.payload.environmentId,"")});case r.PowerPortalActionTypes.FETCH_POWER_PORTAL_WEBSITE_BINDINGS_FULFILLED:return p(p({},t),{},{powerPortalWebsiteBindings:t.powerPortalWebsiteBindings.set(n.payload.environmentId,n.payload.powerPortalWebsiteBindings)});case r.PowerPortalActionTypes.FETCH_POWER_PORTAL_WEBSITE_REJECTED:return p(p({},t),{},{powerPortalWebsitesFetchError:t.powerPortalWebsitesFetchError.set(n.payload.environmentId,n.payload.error)});case r.PowerPortalActionTypes.FETCH_POWER_PORTAL_WEBSITE_BINDINGS_REJECTED:return p(p({},t),{},{powerPortalWebsiteBindingsFetchError:t.powerPortalWebsiteBindingsFetchError.set(n.payload.environmentId,n.payload.error)});case r.PowerPortalActionTypes.POWER_PORTAL_SETTINGS_UPDATE_NAME_REQUEST:return p(p({},t),{},{updatePowerPortalSettingsIsInProgress:!0});case r.PowerPortalActionTypes.RESET_POWER_PORTAL_SETTINGS_ERROR:return p(p({},t),{},{updatePowerPortalSettingsError:""});case r.PowerPortalActionTypes.POWER_PORTAL_SETTINGS_UPDATE_NAME_FULFILLED:var h=t.powerPortals.byId(n.payload.powerPortalId);return h.name=n.payload.powerPortalName,e=Object(l.assign)(new o.CaseInsensitiveNormalized,t.powerPortals),Object(o.add)(e,h),p(p({},t),{},{powerPortals:e,updatePowerPortalSettingsError:"",updatePowerPortalSettingsIsInProgress:!1});case r.PowerPortalActionTypes.POWER_PORTAL_SETTINGS_UPDATE_NAME_REJECTED:return p(p({},t),{},{updatePowerPortalSettingsError:n.payload.error,updatePowerPortalSettingsIsInProgress:!1});case r.PowerPortalActionTypes.FETCH_POWER_PORTALS_APP_REJECTED:return p(p({},t),{},{powerPortalsAppFetchError:t.powerPortalsAppFetchError.set(n.payload.portalId,n.payload.error)});case r.PowerPortalActionTypes.FETCH_POWER_PORTALS_APP_FULFILLED:return e=Object(l.assign)(new o.CaseInsensitiveNormalized,t.powerPortals),Object(o.add)(e,n.payload.powerPortal),p(p({},t),{},{powerPortals:e});case r.PowerPortalActionTypes.ENABLE_PARTNER_PORTAL_FIELD_SERVICE:return p(p({},t),{},{enablePartnerPortalFieldService:n.payload});case r.PowerPortalActionTypes.ENABLE_PARTNER_PORTAL_PROJECT_SERVICE:return p(p({},t),{},{enablePartnerPortalProjectService:n.payload});case r.PowerPortalActionTypes.FETCH_CDS_ORG_SETTINGS_FULFILLED:return p(p({},t),{},{organizationSettings:n.payload.organizationSettings});case r.PowerPortalActionTypes.FETCH_CDS_ORG_SETTINGS_ERROR:var O=p({},t.fetchOrganizationSettingsError);return O[n.payload.environmentId]=n.payload.error,p(p({},t),{},{fetchOrganizationSettingsError:O});case r.PowerPortalActionTypes.FETCH_ISCDSORG_FULLFILLED:return p(p({},t),{},{environmentHasCDSOrg:t.environmentHasCDSOrg.set(n.payload.environmentId,n.payload.isCDSOrg)});case r.PowerPortalActionTypes.FETCH_POWER_PORTAL_PREREQUISITES_FULLFILLED:var C=n.payload.powerPortalPrerequisites;return p(p({},t),{},{powerPortalOperationPrerequisites:m(t.powerPortalOperationPrerequisites,n.payload.environmentId,C,n.payload.packageName,C.Operation)});case r.PowerPortalActionTypes.COMPONENT_CREATE_STATE_REQUEST_INITIATED:return p(p({},t),{},{componentLoadState:a.ComponentLoadState.Loading});case r.PowerPortalActionTypes.COMPONENT_CREATE_STATE_REQUEST_COMPLETED:return p(p({},t),{},{componentLoadState:a.ComponentLoadState.Complete});case r.PowerPortalActionTypes.FETCH_ISCDSORG_POWER_PORTALS_REJECTED:var v=p({},t.fetchIsCDSOrgErrorByEnvironment);return v[n.payload.environmentId]=n.payload.error,p(p({},t),{},{fetchIsCDSOrgErrorByEnvironment:v});case r.PowerPortalActionTypes.POWER_PORTAL_GENERIC_ERROR:var P=p({},t.powerPortalGenericError),E={exception:n.payload.error,messageBarType:n.payload.messageType,powerPortal:n.payload.powerPortal};return P[n.payload.environmentId]=E,p(p({},t),{},{powerPortalGenericError:P});case r.PowerPortalActionTypes.CLEAR_POWER_PORTAL_GENERIC_Error_MESSAGE:var T=p({},t.powerPortalGenericError);return delete T[n.payload.environmentId],p(p({},t),{},{powerPortalGenericError:T});case r.PowerPortalActionTypes.RESET_POWER_PORTAL_OPERATION_PREREQUISITES:return p(p({},t),{},{powerPortalOperationPrerequisites:m(t.powerPortalOperationPrerequisites,n.payload.environmentId,void 0,n.payload.packageName,n.payload.operationType)});case r.PowerPortalActionTypes.UPDATE_APP_MODEL_DETAILS:return p(p({},t),{},{packageName:n.payload.packageName,environmentClient:n.payload.environmentClient});case r.PowerPortalActionTypes.ENABLE_PORTAL_ENGAGEMENTINSIGHTS:return p(p({},t),{},{enableEngagementInsights:n.payload});case r.PowerPortalActionTypes.UPDATE_POWER_PORTAL_FEATURE:return p(p({},t),{},{isPowerPortalFeaturesEnabled:n.payload});default:return t}}},6547:function(e,t,n){"use strict";n.r(t),n.d(t,"PowerPortalsSettingPanel",(function(){return j}));var o=n(6548),r=n(245),a=n(5487),i=n(5437),s=n(5468),l=n(5478),c=n(5667),p=n(1864),u=n(1259),d=n(5492),m=n(5880),b=n(2869),g=n(5896),y=n(3809),S=n(5898),f=n(5732),h=n(3804),O=n(6556),C=n(5645),v=n(6557),P=n(2814);function E(e,t,n,o,r,a,i){try{var s=e[a](i),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(o,r)}function T(e){return function(){var t=this,n=arguments;return new Promise((function(o,r){var a=e.apply(t,n);function i(e){E(a,o,r,i,s,"next",e)}function s(e){E(a,o,r,i,s,"throw",e)}i(void 0)}))}}var j=e=>{var t,n,g,E,T,j,[R,I]=r.useState(!0),[w,D]=r.useState(!1),[N,L]=r.useState(!1),[M,x]=r.useState(!1),[k,F]=r.useState(),[_,U]=r.useState(),[V,B]=r.useState(!1),[H,G]=r.useState(!0),W=r.useContext(a.RootPropsContext),q=Object(i.useDispatch)(),z=Object(b.getResources)(),Q=f.AppType.Portal,K=y.TelemetryService.getInstance();r.useEffect(()=>{(function(e){return A.apply(this,arguments)})(e.environmentClient).then(e=>{D(e)}),Object(h.getPortalAppSetting)(e.environmentClient,K,e.selectedPowerPortalId,"PAYGOptedIn").then(e=>{L(""===e||"true"===e)}),Object(h.getPortalById)(e.environmentClient,K,e.selectedPowerPortalId).then(e=>{F(e.ApplicationType===C.PowerPortalApplicationType[C.PowerPortalApplicationType.Production])}),Object(h.getPortalAppSetting)(e.environmentClient,K,e.selectedPowerPortalId,"Adx.Diagnostics.PortalVersion").then(e=>{U(Object(v.versionCompare)(e,"9.3.10")>=0)})},[]),r.useEffect(()=>{B(k&&_&&e.isPayGoBehaviorEnabled)},[k,_,e.isPayGoBehaviorEnabled]);var Y=null===(t=W.rootProps.currentEnvironment)||void 0===t||null===(n=t.properties)||void 0===n||null===(g=n.linkedEnvironmentMetadata)||void 0===g?void 0:g.resourceId,J=z.Controllers.AppSettings.LicensingAndBilling,X=r.useCallback((e,t)=>{L(!!t),x(!0),G(!1)},[]),Z=[Object(S.toLoadingState)({isComplete:!1})];e.selectedPowerPortalId&&(Z=e.isPayGoBehaviorEnabled?[Object(S.toLoadingState)({isComplete:!e.billingPolicyLoading,name:"BillingPolicyLoad"}),Object(S.toLoadingState)({isComplete:!e.loading,name:"AppPassesLoad"}),Object(S.toLoadingState)({isComplete:void 0!==w,name:"AdminAccessLoad"}),Object(S.toLoadingState)({isComplete:void 0!==k,name:"ApplicationTypeLoad"}),Object(S.toLoadingState)({isComplete:void 0!==_,name:"RunTimeAppVersionLoad"})]:[Object(S.toLoadingState)({isComplete:!0})]);var $=(e,t,n)=>r.createElement("div",{className:"section-description"},r.createElement("div",{className:n?"app-settings-subheader":"app-settings-header"},e),r.createElement("div",{className:"section-description ".concat(n?"":"main-description")},t)),ee=()=>{var t,n=e.hasPerAppPlans||e.hasPerAppPlansForTeams,o=e.billingPolicy,a="Enabled"===(null==o||null===(t=o.powerAppsPolicy)||void 0===t?void 0:t.payAsYouGoState);return r.createElement(m.LicensingAndBillingSection,{appType:Q,appId:e.selectedPowerPortalId,isLoading:Object(S.isLoading)(Z),isPremium:!0,isAdmin:w,policy:o,onCreateBillingPlan:()=>{var t,n,o;Object(h.setPortalAppSetting)(e.environmentClient,K,null===(t=W.rootProps.currentEnvironment)||void 0===t||null===(n=t.properties)||void 0===n||null===(o=n.createdBy)||void 0===o?void 0:o.tenantId,e.selectedPowerPortalId,"PAYGOptedIn",!0),e.onCreateBillingPolicyClick(e.appDisplayName)},toggle:r.createElement(p.Toggle,{label:!V&&z.Controllers.AppSettings.PerAppPasses.toggleHeader,checked:!V||N,onText:V?z.Controllers.AppSettings.LicensingAndBilling.Toggle.onText:z.Controllers.AppSettings.ToggleText.toggleOnText,offText:V?z.Controllers.AppSettings.LicensingAndBilling.Toggle.offText:z.Controllers.AppSettings.ToggleText.toggleOffText,onChange:X,styles:{label:{fontSize:"14px",fontFamily:d.fonts.segoeUiSemibold+" !important"}},disabled:!V}),hasPerAppPlan:n,canConsumeAppPass:!0,isPayGo:a,isSubSection:!0,billingSuccess:e.billingSuccess})},te=()=>{var e=P.settings.powerPlatformAdminCenterUrl.trim();return e.endsWith("/")?e:e+"/"},ne=()=>r.createElement(r.Fragment,null,$(J.PayGoSection.Licencing.ExternalUsers.Info.title,J.PayGoSection.Licencing.ExternalUsers.Info.description),r.createElement(r.Fragment,null,$(r.createElement("span",null,J.PayGoSection.Licencing.ExternalUsers.CapacityAddons.title),r.createElement("div",null,r.createElement("span",null,J.PayGoSection.Licencing.ExternalUsers.CapacityAddons.description),r.createElement(u.Link,{href:"https://go.microsoft.com/fwlink/p/?linkid=2103932",target:"_blank",className:"app-settings-learn-more"},J.PayGoSection.Licencing.ExternalUsers.CapacityAddons.learnMore),w&&r.createElement("div",{className:"app-setting-capacity-link"},r.createElement(u.Link,{href:"".concat(te(),"resources/capacity#add-ons"),target:"_blank"},J.PayGoSection.Licencing.ExternalUsers.CapacityAddons.addonsLink))),!0))),oe=()=>V&&r.createElement("div",{className:O.portalsAppSettingsPanelStyleClasses.appSettings},r.createElement("div",{className:"app-settings-seperator"}),r.createElement(r.Fragment,null,$(J.PayGoSection.Licencing.InternalUsers.Info.title,J.PayGoSection.Licencing.InternalUsers.Info.description),ee()),r.createElement("div",{className:"app-settings-seperator"}),ne());return r.createElement(o.PortalSettingPanel,{onPanelDismiss:()=>{e.billingSuccess.setValue(!1),I(!1),q(s.sharedActions.panelClose({panelType:l.PanelToShowType.PowerPortalSettingPanel}))},renderLicencingAndBilling:()=>oe(),isLoading:Object(S.isLoading)(Z),showPanel:R,portalId:e.selectedPowerPortalId,orgId:Y,onSave:t=>{var n,o;n=e.selectedPowerPortalId,o=t,q(Object(c.updatePowerPortalSettingsFulfilled)({powerPortalId:n,powerPortalName:o}))},perAppToggleClicked:M,setPerAppToggleClicked:x,isPristine:H,setIsPristine:G,perAppSettingEnabled:N,tenantId:null===(E=W.rootProps.currentEnvironment)||void 0===E||null===(T=E.properties)||void 0===T||null===(j=T.createdBy)||void 0===j?void 0:j.tenantId})};function A(){return(A=T((function*(e){return yield Object(g.checkPermission)(e)}))).apply(this,arguments)}},6556:function(e,t,n){"use strict";n.r(t),n.d(t,"getClassNames",(function(){return s})),n.d(t,"getStyles",(function(){return l})),n.d(t,"powerPortalSettingsPanelTextStyles",(function(){return c})),n.d(t,"portalsAppSettingsPanelStyleClasses",(function(){return p}));var o=n(1259),r=n(5492),a=n(2882),i=n(719),s=Object(o.classNamesFunction)(),l=e=>({spinner:{top:"auto"},section:{marginBottom:"12px"},seperator:{borderBottom:"1px solid",borderBottomColor:a.fabricColors.lighterGray,marginTop:"18px",marginBottom:"18px"},subheader:{fontFamily:r.fonts.segoeUi,fontSize:"16px !important",lineHeight:"22px !important",color:a.fabricColors.neutralPrimary,letterSpacing:"-0.0102px",fontWeight:"600",marginTop:"28px"},address:{color:a.fabricColors.neutralTertiary,paddingRight:"12px"},icon:{color:a.fabricColors.neutralTertiary,paddingRight:"12px",margin:"auto"}}),c={root:{selectors:{label:{color:a.fabricColors.neutralPrimary,letterSpacing:"-0.00825714px",fontSize:"14px !important",lineHeight:"22px !important",fontWeight:"600"}}}},p=Object(i.mergeStyleSets)({appSettings:{selectors:{".app-settings-spinner .spinner":{top:"auto"},label:{font:"14px ".concat(r.fonts.segoeUi),maxWidth:"none",marginBottom:"5px"},".app-name":{marginTop:"8px",color:a.fabricColors.neutralChicago},".app-settings-section":{marginBottom:"12px"},".app-settings-header":{fontFamily:r.fonts.segoeUi,fontWeight:600,color:a.fabricColors.black,marginBottom:"5px",display:"flex",alignItems:"center"},".app-settings-subheader":{color:a.fabricColors.gray,marginTop:"10px",marginBottom:"5px",fontWeight:600,fontFamily:r.fonts.segoeUi},".main-description":{paddingTop:"8px"},".app-setting-capacity-link":{marginTop:"10px",textDecoration:"underline"},".app-settings-learn-more":{marginLeft:"5px"},".section-description":{fontSize:"14px",marginBottom:"8px",selectors:{a:{color:a.fabricColors.plum}}},".app-settings-seperator":{borderBottom:"1px solid ".concat(a.fabricColors.lighterGray),marginTop:"18px",marginBottom:"18px"},".app-settings-edit-app Button":{paddingLeft:"0",selectors:{".ms-Button-label":{marginLeft:"0",color:a.fabricColors.plum},i:{color:a.fabricColors.plum}}}}}})},6557:function(e,t,n){"use strict";function o(e){var t=!1;if(e){t=!/[^a-z0-9]/gi.test(e)}return t}n.r(t),n.d(t,"isAlphaNumeric",(function(){return o})),n.d(t,"versionCompare",(function(){return r}));var r=(e,t)=>{for(var n=e.split("."),o=t.split("."),r=0,a=Math.max(n.length,o.length);r<a;r++){if(n[r]&&!o[r]&&Number(n[r])>0||Number(n[r])>Number(o[r]))return 1;if(o[r]&&!n[r]&&Number(o[r])>0||Number(n[r])<Number(o[r]))return-1}return 0}},6558:function(e,t,n){"use strict";n.r(t),n.d(t,"PowerPortalsSharePanel",(function(){return p}));var o=n(6553),r=n(245),a=n(5437),i=n(5487),s=n(5468),l=n(5478),c=n(5604),p=()=>{var[e,t]=r.useState(!0),n=r.useContext(i.RootPropsContext),p=Object(a.useDispatch)(),u=Object(c.getCrmInstanceUrl)(n.rootProps.currentEnvironment);return r.createElement(o.SharePanel,{onPanelDismiss:()=>{t(!1),p(s.sharedActions.panelClose({panelType:l.PanelToShowType.PowerPortalSharePanel}))},showSharePanel:e,crmOrgUrl:u})}},6559:function(e,t,n){"use strict";n.r(t),n.d(t,"PublishTeamsAppPanel",(function(){return p}));var o=n(245),r=n.n(o),a=n(1105),i=n(922),s=n(3076),l=n(6560);function c(){return(c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}var p=Object(i.translateService)("PowerappsPortal")(e=>{var{currentEnvironment:t}=Object(o.useContext)(a.EnvironmentContext),n=Object(o.useContext)(s.ApolloClientContext);return r.a.createElement(r.a.Fragment,null,t&&(null==n?void 0:n.environmentClient)&&r.a.createElement(l.PublishTeamsAppPanelBase,c({},e,{currentEnvironment:t,environmentClient:n})))})},6560:function(e,t,n){"use strict";n.r(t),n.d(t,"PublishTeamsAppPanelBase",(function(){return I}));var o=n(1573),r=n(5437),a=n(245),i=n.n(a),s=n(5466),l=n(5468),c=n(5478),p=n(6561),u=n(6562),d=n(6572),m=n(6585),b=n(3196),g=n(6571),y=n(5593),S=n(3185),f=n(6586),h=n(6587),O=n(6588),C=n(6589),v=n(6592),P=n(6594),E=n(1105);function T(){return(T=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}function j(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function A(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?j(Object(n),!0).forEach((function(t){R(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function R(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var I=e=>{var t,n,j,R,I,w,{currentEnvironment:D,environmentClient:N}=e,L=Object(m.getLabels)(e),M=null!==(t=e.solutionId)&&void 0!==t?t:null===(n=e.solution)||void 0===n?void 0:n.solutionid,x=null!==(j=e.solutionFriendlyName)&&void 0!==j?j:null===(R=e.solution)||void 0===R?void 0:R.friendlyname,k=null!==(I=e.solutionDescription)&&void 0!==I?I:null===(w=e.solution)||void 0===w?void 0:w.description,[F,_]=Object(a.useState)(p.PublishTeamsAppPanelSteps.SolutionDetails),U=Object(r.useDispatch)(),{packageName:V,setPackageName:B,validateName:H,packageDescription:G,setPackageDescription:W,validateDescription:q}=Object(f.usePackageDetails)(L,x,k),z=Object(v.usePackageIcon)(),{isFetchManagedSolutionComponentsLoading:Q,fetchManagedSolutionComponentsErrorMessage:K,hasManagedSolutionComponents:Y}=Object(P.useManagedSolutionComponents)(M),{supportedSolutionComponentTypes:J,isFetchCustomComponentDefinitionsLoading:X,fetchCustomComponentDefinitionsErrorMessage:Z}=Object(h.useSupportedComponentTypes)(N,M,e.t("Common.Request.Failed")),{packageComponents:$,setPackageComponents:ee,fetchSupportedSolutionComponentsErrorMessage:te,isFetchSupportedSolutionComponentsLoading:ne,hasComponentsBesidesFlows:oe}=Object(O.useSupportedSolutionComponents)(J,M,D),{errorMessage:re,canvasApps:ae,loading:ie}=Object(b.useCanvasAppsListQuery)(N.environmentClient,{},y.PortalScope,e.t("Common.Request.Failed")),se=!Object(E.environmentHasCds2Database)(D),{errorMessage:le,appModules:ce,loading:pe}=Object(S.useAppModulesListQuery)(N.environmentClient,y.PortalScope,e.t("Common.Request.Failed"),void 0,se),ue=()=>{e.onPanelClose?e.onPanelClose():U(l.sharedActions.panelClose({panelType:c.PanelToShowType.PublishTeamsApp}))},{onPublishTeamsPackage:de,isPublishOngoing:me,publishRequestErrorMessage:be}=Object(C.usePublishCallbacks)(N,M,D,e.t("Common.Request.Failed"),V,G,z,$,ue),{solutionDetailsLoadingMessageInfo:ge,solutionDetailsErrorMessageInfo:ye,componentRolesLoadingMessageInfo:Se,componentRolesErrorMessageInfo:fe}=Object(g.getLoadingAndErrorInfo)({isFetchManagedSolutionComponentsLoading:Q,isFetchCustomComponentDefinitionsLoading:X,isFetchSupportedSolutionComponentsLoading:ne,isFetchCanvasAppsLoading:ie,isFetchModelAppsLoading:pe,isPublishOngoing:me},{fetchManagedSolutionComponentsErrorMessage:K,fetchCustomComponentDefinitionsErrorMessage:Z,fetchSupportedSolutionComponentsErrorMessage:te,fetchCanvasAppsErrorMessage:re,fetchModelAppsErrorMessage:le,publishRequestErrorMessage:be},Y,V,L),he={hasCloseButton:!0,closeButtonAriaLabel:L.close,type:o.PanelType.smallFixedFar,headerText:L.title},Oe=[Object(u.getSolutionDetailsAndIconContents)(he,{labels:L.SharedLabels,packageName:V,packageDescription:G,errorMessageInfo:ye,loadingMessageInfo:ge,hasComponentsBesidesFlows:oe,onPublishTeamsPackage:de},{labels:L.SolutionDetailsAndIconLabels,packageNameInput:{value:V,setValue:B,validate:H},packageDescriptionInput:{value:G,setValue:W,validate:q},packageIcon:z}),Object(d.getComponentsAndRolesContents)(he,{labels:A(A({},L.SharedLabels),L.ComponentsAndRolesLabels),errorMessageInfo:fe,loadingMessageInfo:Se,onPublishTeamsPackage:de},{labels:L.ComponentsAndRolesLabels,packageComponents:$,setPackageComponents:ee,canvasApps:ae,modelApps:ce})];return i.a.createElement(s.MultistepPanel,T({customWidth:void 0,dismissDialog:void 0,dismissOnEscape:void 0,isBlocking:!0,isHiddenOnDismiss:!0,onDismissed:void 0,onLightDismissClick:void 0,showDismissDialog:void 0,isLightDismiss:!1,onOuterClick:void 0,isOpen:void 0},e.defaultPanelProps,{onDismiss:ue,panelsListProps:Oe,panelOpenIndex:F,setPanelOpenIndex:_}))}},6561:function(e,t,n){"use strict";var o;n.r(t),n.d(t,"PublishTeamsAppPanelSteps",(function(){return o})),function(e){e[e.SolutionDetails=0]="SolutionDetails",e[e.ComponentsAndRoles=1]="ComponentsAndRoles"}(o||(o={}))},6562:function(e,t,n){"use strict";n.r(t),n.d(t,"getSolutionDetailsAndIconContents",(function(){return d}));var o=n(245),r=n(1201),a=n(1697),i=n(6561),s=n(6563),l=n(6571);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e,t,n){var c,u,{errorMessageInfo:d,loadingMessageInfo:m,packageName:b,packageDescription:g,labels:y,onPublishTeamsPackage:S,hasComponentsBesidesFlows:f}=t;return m&&(c={spinnerProps:{size:r.SpinnerSize.large,label:m.loadingMessage,ariaLabel:m.loadingMessage,ariaLive:"polite",role:"alert"}}),d&&(u={messageBarProps:{messageBarType:a.MessageBarType.error},onRenderBody:()=>o.createElement(o.Fragment,null,d.errorMessage)}),p(p({},e),{},{messageBar:u,children:o.createElement(s.SolutionDetailsAndIconContents,n),loadingOverlay:c,footerButtons:[{primary:!0,navigateableOnClick:e=>{if(f)return i.PublishTeamsAppPanelSteps.ComponentsAndRoles;S()},disabled:!(b&&g&&!m&&!d),ariaLabel:y.next,text:y.next},{ariaLabel:y.cancel,text:y.cancel,navigateableOnClick:(e,t)=>(t(),null),disabled:Object(l.shouldBlockPanelClose)(d,m)}]})}},6563:function(e,t,n){"use strict";n.r(t),n.d(t,"SolutionDetailsAndIconContents",(function(){return d}));var o=n(245),r=n(1429),a=n(2903),i=n(6564),s=n(6565),l=n(1372),c=n(3815),p=n(5481),u=n(684),d=e=>{var{labels:t,packageNameInput:n,packageDescriptionInput:d,packageIcon:m}=e;return o.createElement("div",{className:i.publishTeamsAppPanelClasses.contentContainer},o.createElement("span",{className:Object(a.css)(i.publishTeamsAppPanelClasses.boldText,"subHeaderContentsText")},t.subtitle),o.createElement("span",{className:"subHeaderContentsText"},Object(c.formatString)(t.subtitleContents,"Built for Contoso")),o.createElement(u.ActionButton,{href:p.default.publishAppCatalog,styles:i.publishTeamsAppPanelStyles.learnMoreButtonStyles},t.learnMore),o.createElement("div",{className:"iconCustomizationSection"},o.createElement(l.Label,{required:!0},t.Labels.iconLabel),o.createElement(s.IconCreator,m)),o.createElement(r.TextField,{label:t.Labels.nameLabel,value:n.value,onChange:(e,t)=>{n.setValue(t)},required:!0,onGetErrorMessage:e=>n.validate(e),validateOnLoad:!1,styles:i.publishTeamsAppPanelStyles.textInputStyles}),o.createElement(r.TextField,{label:t.Labels.descriptionLabel,value:d.value,onChange:(e,t)=>{d.setValue(t)},required:!0,onGetErrorMessage:e=>d.validate(e),validateOnLoad:!1,multiline:!0,styles:i.publishTeamsAppPanelStyles.textInputStyles}))}},6564:function(e,t,n){"use strict";n.r(t),n.d(t,"publishTeamsAppPanelClasses",(function(){return i})),n.d(t,"publishTeamsAppPanelStyles",(function(){return s}));var o=n(719),r=n(5492),a=n(2882),i=Object(o.mergeStyleSets)({contentContainer:{paddingTop:"0px !important",marginTop:"16px !important",fontFamily:r.fonts.segoeUi,display:"block",selectors:{".subHeaderContentsText":{marginTop:4,fontSize:14,fontFamily:r.fonts.segoeUi,lineHeight:20,letterSpacing:"-0.0068px",display:"block"},".iconCustomizationSection":{marginTop:24},".componentContainer":{marginTop:24,marginBottom:10,alignItems:"center",selectors:{".componentContainerHeader":{display:"flex",marginBottom:7,alignItems:"center",selectors:{".componentContainerHeaderText":{marginLeft:8,display:"flex",flexDirection:"column",selectors:{".componentName":{lineHeight:19},".componentTypeName":{fontSize:12,lineHeight:16}}}}},".componentContainerDescription":{marginBottom:8,fontSize:12,lineHeight:16,color:a.fabricColors.darkGray,display:"flex",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"normal"}}}}},boldText:{fontWeight:600,lineHeight:16}}),s={textInputStyles:{root:{marginTop:24}},learnMoreButtonStyles:{root:{fontSize:14,height:"auto",minWidth:100,lineHeight:20,paddingLeft:0,paddingRight:0,paddingTop:4,paddingBottom:4,border:"none"},label:{color:a.fabricColors.sharePointBlue,margin:0}}}},6565:function(e,t,n){"use strict";n.r(t),n.d(t,"IconCreator",(function(){return m}));var o=n(684),r=n(790),a=n(719),i=n(1240),s=n(545),l=n(245),c=n(5927),p=n(6566),u=n(6570);class d extends l.Component{constructor(e){super(e),this.color="#FF0000",this.filePickerRef=l.createRef(),this.colorButtonId=Object(s.getId)("change-icon-color"),this.iconButtonId=Object(s.getId)("change-icon-outline"),this.styles=Object(a.mergeStyleSets)({colorButton:{minWidth:"98px",height:"24px",fontSize:"12px",marginLeft:"8px",marginBottom:"12px",padding:"0px"},buttons:{paddingLeft:"16px",borderLeft:"1px solid #edebe9"},buttonGroup:{display:"flex",flexDirection:"row"},colorPreview:{height:"24px",width:"24px",borderRadius:"2px"},container:{display:"flex",flexDirection:"row"},iconButton:{minWidth:"98px",height:"24px",fontSize:"12px",marginLeft:"8px",padding:"0px"},imageResetButton:{height:"24px",width:"24px",marginLeft:"4px",minWidth:"0px",padding:"0px"}}),this.color=e.color,this.state={isColorPickerVisible:!1,isIconResetVisible:!1}}render(){return l.createElement("div",{className:Object(a.mergeStyles)(this.props.className,this.styles.container)},l.createElement(u.IconPreview,{backgroundColor:this.props.color,imageUrl:this.props.imageUrl}),l.createElement("div",{className:this.styles.buttons},l.createElement("div",{className:this.styles.buttonGroup},l.createElement("div",{className:this.styles.colorPreview,style:{backgroundColor:this.props.color}}),l.createElement(o.DefaultButton,{text:this.props.strings.iconCreator.changeColor,id:this.colorButtonId,className:this.styles.colorButton,onClick:()=>this.setState({isColorPickerVisible:!0})})),l.createElement("div",{className:this.styles.buttonGroup},l.createElement(u.IconPreview,{backgroundColor:"#000000",imageUrl:this.props.imageUrl,containerStyle:{height:"24px",width:"24px",marginRight:0},iconStyle:{height:"16px",width:"16px",margin:"-20px 4px 4px 4px"}}),l.createElement(o.DefaultButton,{text:this.props.strings.iconCreator.changeIcon,id:this.iconButtonId,className:this.styles.iconButton,onClick:()=>{var e;null===(e=this.filePickerRef.current)||void 0===e||e.click()}}),this.state.isIconResetVisible&&!!this.props.onImageReset&&l.createElement(i.TooltipHost,{content:this.props.strings.iconCreator.resetIcon,calloutProps:{directionalHint:r.DirectionalHint.rightCenter}},l.createElement(o.DefaultButton,{iconProps:{iconName:"RevToggleKey"},className:this.styles.imageResetButton,onClick:()=>{var e,t;this.setState({isIconResetVisible:!1}),null!==(e=this.filePickerRef)&&void 0!==e&&null!==(t=e.current)&&void 0!==t&&t.value&&(this.filePickerRef.current.value=""),this.props.onImageReset&&this.props.onImageReset()}}))),l.createElement("input",{type:"file",ref:this.filePickerRef,style:{display:"none"},accept:this.props.imageExtensions?this.props.imageExtensions.join(","):".png",onChange:e=>{var t=e.target.files?e.target.files[0]:void 0;t&&(this.setState({isIconResetVisible:!0}),this.props.onImageUpload(t))}})),this.state.isColorPickerVisible&&l.createElement(r.Callout,{target:"#".concat(this.colorButtonId),onDismiss:()=>this.setState({isColorPickerVisible:!1}),setInitialFocus:!0},l.createElement(p.ColorPicker,{onChange:this.props.onColorChange,key:this.color,color:this.color,className:"".concat(this.props.className)})))}}var m=Object(c.withLocalizedStrings)(d)},6566:function(e,t,n){"use strict";n.r(t),n.d(t,"ColorPickerTabs",(function(){return o})),n.d(t,"ColorPickerInternal",(function(){return b})),n.d(t,"ColorPicker",(function(){return S}));var o,r=n(1397),a=n(1425),i=n(782),s=n(1709),l=n(719),c=n(245),p=n(5927),u=n(6567),d=n(6569);function m(){return(m=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}!function(e){e[e.standard=0]="standard",e[e.custom=1]="custom"}(o||(o={}));class b extends c.PureComponent{constructor(e){super(e),this._renderStandardTabButtonText=()=>this._renderTabButtonText(this.props.strings.colorPicker.standardHeader),this._renderCustomTabButtonText=()=>this._renderTabButtonText(this.props.strings.colorPicker.customHeader),this._renderTabButtonText=e=>c.createElement("div",{style:{textOverflow:"ellipses"}},e),this._renderColorGroup=(e,t,n)=>c.createElement(i.FocusZone,{"aria-label":e.name,key:e.name,"aria-rowcount":e.colorSwatches.length},c.createElement(u.default,{name:e.name,colorSwatches:e.colorSwatches,onColorChanged:this._onColorSwatchChanged})),this._onColorSwatchChanged=e=>{var t,n,o=Object(r.cssColor)(e);o&&(e="#"+Object(r.rgb2hex)(o.r,o.g,o.b)),this.setState({color:e}),null===(t=(n=this.props).onChange)||void 0===t||t.call(n,e)},this._onColorChanged=(e,t)=>{var n,o;this.setState({color:t}),null===(n=(o=this.props).onChange)||void 0===n||n.call(o,t.str)},this.state={color:this.props.color}}render(){var{title:e,ariaLabel:t,role:n}=this.props;return c.createElement("div",{className:Object(l.mergeStyles)(this.props.className,y.colorPickerContainer),title:e,"aria-label":t,role:n},c.createElement(s.Pivot,{linkFormat:"links"},c.createElement(s.PivotItem,{headerText:this.props.strings.colorPicker.standardHeader,itemKey:"0",onRenderItemLink:this._renderStandardTabButtonText,headerButtonProps:{title:this.props.strings.colorPicker.standardHeader}},this._renderColorGroups()),c.createElement(s.PivotItem,{headerText:this.props.strings.colorPicker.customHeader,itemKey:"1",onRenderItemLink:this._renderCustomTabButtonText,headerButtonProps:{title:this.props.strings.colorPicker.customHeader}},this._renderCustomColorPicker())))}_renderColorGroups(){var e=[{name:this.props.strings.colorPicker.themeColors,colorSwatches:this.props.themeColors||Object(d.getDefaultThemeColorPalette)()},{name:this.props.strings.colorPicker.standardColors,colorSwatches:this.props.standardColors||Object(d.getStandardColors)()}];return c.createElement("div",{className:y.groupsContainer,"aria-label":this.props.strings.colorPicker.standardHeader},e.map(this._renderColorGroup))}_renderCustomColorPicker(){return c.createElement("div",{className:y.customPickerContainer},c.createElement(a.ColorPicker,m({},this.props,{color:this.state.color,onChange:this._onColorChanged,styles:g,alphaSliderHidden:!0,hexLabel:this.props.strings.colorPicker.hex,redLabel:this.props.strings.colorPicker.red,greenLabel:this.props.strings.colorPicker.green,blueLabel:this.props.strings.colorPicker.blue})))}}var g={tableHeader:{fontSize:12}},y=Object(l.mergeStyleSets)({colorPickerContainer:{maxWidth:"350px",padding:1},groupsContainer:{maxWidth:"100%",display:"flex",flexDirection:"column",padding:"16px 33px 50px 15px"},customPickerContainer:{"& .ms-TextField-fieldGroup":{display:"block","& .ms-TextField-field":{height:"100%",textTransform:"uppercase",padding:"0px 3px"}}}}),S=Object(p.withLocalizedStrings)(b)},6567:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return i}));var o=n(245),r=n(719),a=n(6568);class i extends o.PureComponent{constructor(){super(...arguments),this._renderSwatchRow=(e,t)=>o.createElement("div",{key:t,className:Object(r.mergeStyles)(s.swatchesRow,"color-row")},e.map(this._renderSwatch)),this._renderSwatch=(e,t)=>o.createElement(a.default,{key:e,color:e,onClick:()=>this.props.onColorChanged(e),index:t,className:this.props.className})}render(){return o.createElement("div",{className:s.groupContainer,role:"presentation"},this._renderGroupName(),this._renderColorSwatches())}_renderGroupName(){return o.createElement("h1",{className:s.groupTitle},this.props.name)}_renderColorSwatches(){return this.props.colorSwatches?o.createElement("div",{className:Object(r.mergeStyles)(s.swatchesContainer,"color-group"),"aria-label":this.props.name},this.props.colorSwatches.map(this._renderSwatchRow)):null}}var s=Object(r.mergeStyleSets)({groupContainer:{maxWidth:"100%",display:"flex",flexDirection:"column"},groupTitle:{fontFamily:"Segoe UI",fontSize:"12px",padding:"2px",marginBottom:"2px",fontWeight:"normal",textOverflow:"ellipses",letterSpacing:"normal",lineHeight:"14px",marginTop:"2px"},swatchesContainer:{display:"flex",flexDirection:"column",marginBottom:"4px"},swatchesRow:{display:"flex",justifyContent:"flex-start"}})},6568:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return a}));var o=n(719),r=n(245);class a extends r.PureComponent{render(){var{color:e="",onClick:t,index:n,className:a}=this.props;return r.createElement("button",{className:Object(o.mergeStyles)(i.swatch,a),"data-is-focusable":!0,onClick:t,title:e.toUpperCase(),"aria-colindex":n},r.createElement("svg",{height:"100%",width:"100%",focusable:"false"},r.createElement("rect",{height:"100%",width:"100%","aria-label":e.toUpperCase(),style:{fill:e}})))}}var i=Object(o.mergeStyleSets)({swatch:{width:"22px",height:"22px",border:"1px solid #D2D2D2",outline:"none",padding:"0px",margin:"3px",":hover":{boxShadow:"".concat("0px 0px 0px 1px"," #666666")},"body.show-focus-styles &:focus":{boxShadow:"".concat("0px 0px 0px 1px"," #000000")},":active":{boxShadow:"".concat("0px 0px 0px 1px"," #000000")}}})},6569:function(e,t,n){"use strict";n.r(t),n.d(t,"getDefaultThemeColorPalette",(function(){return o})),n.d(t,"getStandardColors",(function(){return r}));var o=()=>[["rgb(255,255,255)","rgb(56,96,178)","rgb(0,18,107)","rgb(186,202,226)","rgb(166,166,166)","rgb(0,134,208)","rgb(141,198,63)","rgb(246,88,16)","rgb(168,0,0)"],["rgb(230,230,230)","rgb(215,223,240)","rgb(204,208,225)","rgb(241,244,249)","rgb(237,237,237)","rgb(204,231,246)","rgb(232,244,217)","rgb(253,222,207)","rgb(238,204,204)"],["rgb(204,204,204)","rgb(175,191,224)","rgb(153,160,196)","rgb(227,234,243)","rgb(219,219,219)","rgb(153,207,236)","rgb(209,232,178)","rgb(251,188,159)","rgb(220,153,153)"],["rgb(179,179,179)","rgb(136,160,209)","rgb(102,113,166)","rgb(214,223,238)","rgb(202,202,202)","rgb(102,182,227)","rgb(187,221,140)","rgb(250,155,112)","rgb(203,102,102)"],["rgb(153,153,153)","rgb(50,86,160)","rgb(0,16,96)","rgb(167,182,203)","rgb(149,149,149)","rgb(0,121,187)","rgb(127,178,57)","rgb(221,79,14)","rgb(151,0,0)"],["rgb(128,128,128)","rgb(39,67,125)","rgb(0,13,75)","rgb(130,141,158)","rgb(116,116,116)","rgb(0,94,146)","rgb(99,139,44)","rgb(172,62,11)","rgb(118,0,0)"]],r=()=>[["rgb(184,0,0)","rgb(255,0,0)","rgb(255,191,0)","rgb(255,255,0)","rgb(152,208,70)","rgb(54,176,75)","rgb(39,113,194)","rgb(9,33,98)","rgb(109,49,162)"],["rgb(255,255,255)","rgb(0,0,0)"]]},6570:function(e,t,n){"use strict";n.r(t),n.d(t,"IconPreview",(function(){return i}));var o=n(1277),r=n(719),a=n(245),i=e=>{var t=Object(r.mergeStyleSets)(s,{background:e.containerStyle,container:e.containerStyle,icon:e.iconStyle});return a.createElement("div",{className:t.container},a.createElement("div",{className:t.background,style:{backgroundColor:e.backgroundColor}}),a.createElement(o.Image,{src:e.imageUrl,imageFit:o.ImageFit.centerContain,className:t.icon,role:"presentation"}))},s=Object(r.mergeStyleSets)({background:{height:"60px",width:"60px",borderRadius:"2px"},container:{display:"block",position:"relative",marginRight:"16px",height:"60px",width:"60px"},icon:{height:"32px",width:"32px",margin:"-46px 14px 14px 14px"}})},6571:function(e,t,n){"use strict";n.r(t),n.d(t,"ComponentsAndRolesRequest",(function(){return o})),n.d(t,"getLoadingAndErrorInfo",(function(){return a})),n.d(t,"shouldBlockPanelClose",(function(){return i}));var o,r=n(3815);function a(e,t,n,a,i){var{isFetchManagedSolutionComponentsLoading:s,isFetchCustomComponentDefinitionsLoading:l,isFetchSupportedSolutionComponentsLoading:c,isFetchCanvasAppsLoading:p,isFetchModelAppsLoading:u,isPublishOngoing:d}=e,{fetchManagedSolutionComponentsErrorMessage:m,fetchCustomComponentDefinitionsErrorMessage:b,fetchSupportedSolutionComponentsErrorMessage:g,fetchCanvasAppsErrorMessage:y,fetchModelAppsErrorMessage:S,publishRequestErrorMessage:f}=t;return{solutionDetailsLoadingMessageInfo:function(e,t,n){var a;e.isFetchManagedSolutionComponentsLoading?a={loadingMessage:n.ComponentsAndRolesLabels.Loading.fetchingSolutionComponents,request:o.FetchSupportedSolutionComponents}:e.isFetchCustomComponentDefinitionsLoading?a={loadingMessage:n.ComponentsAndRolesLabels.Loading.fetchingSolutionComponents,request:o.FetchCustomComponentDefinitions}:e.isFetchSupportedSolutionComponentsLoading?a={loadingMessage:n.ComponentsAndRolesLabels.Loading.fetchingSolutionComponents,request:o.FetchManagedSolutionComponents}:e.isPublishOngoing&&(a={loadingMessage:Object(r.formatString)(n.ComponentsAndRolesLabels.Loading.publishing,t),request:o.Publish});return a}({isFetchManagedSolutionComponentsLoading:s,isFetchCustomComponentDefinitionsLoading:l,isFetchSupportedSolutionComponentsLoading:c,isPublishOngoing:d},a,i),solutionDetailsErrorMessageInfo:function(e,t,n){var r;e.fetchManagedSolutionComponentsErrorMessage?r={errorMessage:e.fetchManagedSolutionComponentsErrorMessage,request:o.FetchManagedSolutionComponents}:e.fetchCustomComponentDefinitionsErrorMessage?r={errorMessage:e.fetchCustomComponentDefinitionsErrorMessage,request:o.FetchCustomComponentDefinitions}:e.fetchSupportedSolutionComponentsErrorMessage?r={errorMessage:e.fetchSupportedSolutionComponentsErrorMessage,request:o.FetchSupportedSolutionComponents}:e.publishRequestErrorMessage?r={errorMessage:n.ComponentsAndRolesLabels.Publish.failure,request:o.Publish}:t&&(r={errorMessage:n.ComponentsAndRolesLabels.Publish.managedComponents,request:o.FetchManagedSolutionComponents});return r}({fetchManagedSolutionComponentsErrorMessage:m,fetchCustomComponentDefinitionsErrorMessage:b,fetchSupportedSolutionComponentsErrorMessage:g,publishRequestErrorMessage:f},n,i),componentRolesLoadingMessageInfo:function(e,t,n){var a;e.isFetchCanvasAppsLoading?a={loadingMessage:n.ComponentsAndRolesLabels.Loading.fetchingSolutionComponents,request:o.FetchCanvasApps}:e.isFetchModelAppsLoading?a={loadingMessage:n.ComponentsAndRolesLabels.Loading.fetchingSolutionComponents,request:o.FetchModelApps}:e.isPublishOngoing&&(a={loadingMessage:Object(r.formatString)(n.ComponentsAndRolesLabels.Loading.publishing,t),request:o.Publish});return a}({isFetchCanvasAppsLoading:p,isFetchModelAppsLoading:u,isPublishOngoing:d},a,i),componentRolesErrorMessageInfo:function(e,t){var n;e.fetchCanvasAppsErrorMessage?n={errorMessage:e.fetchCanvasAppsErrorMessage,request:o.FetchCanvasApps}:e.fetchModelAppsErrorMessage?n={errorMessage:e.fetchModelAppsErrorMessage,request:o.FetchModelApps}:e.publishRequestErrorMessage&&(n={errorMessage:t.ComponentsAndRolesLabels.Publish.failure,request:o.Publish});return n}({fetchCanvasAppsErrorMessage:y,fetchModelAppsErrorMessage:S,publishRequestErrorMessage:f},i)}}function i(e,t){return e&&e.request===o.Publish||t&&t.request===o.Publish}!function(e){e[e.FetchManagedSolutionComponents=0]="FetchManagedSolutionComponents",e[e.FetchCustomComponentDefinitions=1]="FetchCustomComponentDefinitions",e[e.FetchSupportedSolutionComponents=2]="FetchSupportedSolutionComponents",e[e.FetchCanvasApps=3]="FetchCanvasApps",e[e.FetchModelApps=4]="FetchModelApps",e[e.Publish=5]="Publish"}(o||(o={}))},6572:function(e,t,n){"use strict";n.r(t),n.d(t,"getComponentsAndRolesContents",(function(){return u}));var o=n(245),r=n(1201),a=n(6573),i=n(1697),s=n(6571);function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){p(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e,t,n){var l,p;return t.loadingMessageInfo&&(l={spinnerProps:{size:r.SpinnerSize.large,label:t.loadingMessageInfo.loadingMessage,ariaLabel:t.loadingMessageInfo.loadingMessage,ariaLive:"polite",role:"alert"}}),t.errorMessageInfo&&(p={messageBarProps:{messageBarType:i.MessageBarType.error},onRenderBody:()=>o.createElement(o.Fragment,null,t.errorMessageInfo.errorMessage)}),c(c({},e),{},{messageBar:p,children:o.createElement(a.ComponentsAndRolesContents,n),loadingOverlay:l,footerButtons:[{primary:!0,navigateableOnClick:(e,n)=>{t.onPublishTeamsPackage()},disabled:!!t.loadingMessageInfo||!!t.errorMessageInfo,ariaLabel:t.labels.publish,text:t.labels.publish},{ariaLabel:t.labels.cancel,text:t.labels.cancel,navigateableOnClick:(e,t)=>(t(),null),disabled:Object(s.shouldBlockPanelClose)(t.errorMessageInfo,t.loadingMessageInfo)}]})}},6573:function(e,t,n){"use strict";n.r(t),n.d(t,"ComponentsAndRolesContents",(function(){return d}));var o=n(245),r=n(2903),a=n(6564),i=n(6574),s=n(6578),l=n(6580),c=n(6582),p=n(6583),u=n(6584),d=e=>{var{packageComponents:t,labels:n,setPackageComponents:d,canvasApps:m,modelApps:b}=e;function g(e,n){var o=[...t];o.find(t=>t.msdyn_objectid==e.msdyn_objectid).appTemplateSelection=n,d(o)}return o.createElement("div",{className:a.publishTeamsAppPanelClasses.contentContainer},o.createElement("span",{className:Object(r.css)(a.publishTeamsAppPanelClasses.boldText,"subHeaderContentsText")},n.subtitle),o.createElement("span",{className:"subHeaderContentsText"},n.subtitleContents),t&&t.filter(e=>!Object(u.isFlowPublishTeamsAppComponent)(e)||!Object(p.isBotPublishTeamsAppComponent)(e)).map(e=>Object(l.isCanvasAppPublishTeamsAppComponent)(e)?o.createElement(i.CanvasAppRolesComponent,{key:e.msdyn_objectid,labels:n,packageComponent:e,canvasApp:m.find(t=>t.name===e.msdyn_objectid),onChangeAppTemplateSelection:g}):Object(c.isModelAppPublishTeamsAppComponent)(e)?o.createElement(s.ModelAppRolesComponent,{key:e.msdyn_objectid,labels:n,packageComponent:e,modelApp:b.find(t=>t.id===e.msdyn_objectid),onChangeAppTemplateSelection:g}):void 0))}},6574:function(e,t,n){"use strict";n.r(t),n.d(t,"CanvasAppRolesComponent",(function(){return u}));var o=n(245),r=n(6575),a=n(6576),i=n(1277),s=n(5607),l=n(5596),c=n(1106),p=n(3713),u=e=>{var{packageComponent:t,canvasApp:n}=e,{currentEnvironment:u}=Object(o.useContext)(c.EnvironmentContext),d=n.imageUrl||l.DefaultAppBackgroundImageUri;return o.createElement(r.ComponentRole,{displayName:t.msdyn_displayname,description:t.msdyn_description,typeDisplayName:Object(s.getSolutionComponentTypeDisplayName)(t,Object(p.isCdsLiteContext)(u)),renderComponentIcon:()=>o.createElement("div",{style:{backgroundColor:n.imageBackgroundColor,width:32,height:32}},o.createElement(i.Image,{src:d,alt:n.displayName,width:32,height:32})),renderComponentDropdown:()=>o.createElement(a.CanvasAppDropdown,e)})}},6575:function(e,t,n){"use strict";n.r(t),n.d(t,"ComponentRole",(function(){return i}));var o=n(245),r=n(2903),a=n(6564),i=e=>o.createElement("div",{className:"componentContainer"},o.createElement("div",{className:"componentContainerHeader"},e.renderComponentIcon(),o.createElement("div",{className:"componentContainerHeaderText"},o.createElement("span",{className:Object(r.css)(a.publishTeamsAppPanelClasses.boldText,"componentName")},e.displayName),o.createElement("span",{className:"componentTypeName"},e.typeDisplayName))),e.description?o.createElement("span",{className:"componentContainerDescription"},e.description):o.createElement(o.Fragment,null),e.renderComponentDropdown())},6576:function(e,t,n){"use strict";n.r(t),n.d(t,"CanvasAppDropdown",(function(){return i}));var o=n(245),r=n(1567),a=n(6577),i=e=>{var{packageComponent:t,labels:n}=e;return o.createElement(r.Dropdown,{selectedKey:t.appTemplateSelection,options:s(n),onChange:(n,o)=>{e.onChangeAppTemplateSelection(t,o.key)}})};function s(e){return[{key:a.SolutionComponentDisplayOptions.PersonalTab,text:e.Options.CanvasApp.addAsPersonalApp},{key:a.SolutionComponentDisplayOptions.TeamsTab,text:e.Options.CanvasApp.addAsTeamsApp}]}},6577:function(e,t,n){"use strict";var o;n.r(t),n.d(t,"SolutionComponentDisplayOptions",(function(){return o})),function(e){e[e.None=0]="None",e[e.TeamsTab=1]="TeamsTab",e[e.PersonalTab=2]="PersonalTab",e[e.Bot=3]="Bot"}(o||(o={}))},6578:function(e,t,n){"use strict";n.r(t),n.d(t,"ModelAppRolesComponent",(function(){return u}));var o=n(245),r=n(6579),a=n(1277),i=n(5607),s=n(6575),l=n(5493),c=n(1106),p=n(3713),u=e=>{var{packageComponent:t,modelApp:n}=e,{currentEnvironment:u}=Object(o.useContext)(c.EnvironmentContext),d=l.default.getPaths().appModuleDefaultIcon;return o.createElement(s.ComponentRole,{displayName:t.msdyn_displayname,description:t.msdyn_description,typeDisplayName:Object(i.getSolutionComponentTypeDisplayName)(t,Object(p.isCdsLiteContext)(u)),renderComponentIcon:()=>o.createElement("div",{style:{width:32,height:32}},o.createElement(a.Image,{src:d,alt:n.displayName,width:32,height:32})),renderComponentDropdown:()=>o.createElement(r.ModelAppDropdown,e)})}},6579:function(e,t,n){"use strict";n.r(t),n.d(t,"ModelAppDropdown",(function(){return i}));var o=n(245),r=n(1567),a=n(6577),i=e=>{var{packageComponent:t,labels:n}=e;return o.createElement(r.Dropdown,{selectedKey:t.appTemplateSelection,options:s(n),onChange:(n,o)=>{e.onChangeAppTemplateSelection(t,o.key)}})};function s(e){return[{key:a.SolutionComponentDisplayOptions.PersonalTab,text:e.Options.CanvasApp.addAsPersonalApp},{key:a.SolutionComponentDisplayOptions.TeamsTab,text:e.Options.CanvasApp.addAsTeamsApp}]}},6580:function(e,t,n){"use strict";n.r(t),n.d(t,"isCanvasAppPublishTeamsAppComponent",(function(){return i}));var o=n(6581),r=n(5609),a=n(5611);function i(e){return!!e&&Object(o.isPublishTeamsAppStandardComponentTypeInfo)(e)&&(Object(r.areSameSolutionComponentType)(e.componentType,a.StandardSolutionComponentTypes.CanvasApp)||Object(r.areSameSolutionComponentType)(e.componentType,a.StandardSolutionComponentTypes.CanvasAppsOnly))}},6581:function(e,t,n){"use strict";n.r(t),n.d(t,"PublishTeamsAppPanelSupportedStandardComponentTypes",(function(){return i})),n.d(t,"PublishTeamsAppPanelSupportedCustomComponentTypes",(function(){return s})),n.d(t,"isPublishTeamsAppStandardComponentTypeInfo",(function(){return l}));var o=n(5609),r=n(6577),a=n(5611),i=[{componentType:a.StandardSolutionComponentTypes.CanvasApp,appTemplateSelection:r.SolutionComponentDisplayOptions.PersonalTab},{componentType:a.StandardSolutionComponentTypes.CanvasAppsOnly,appTemplateSelection:r.SolutionComponentDisplayOptions.PersonalTab},{componentType:a.StandardSolutionComponentTypes.Flow,appTemplateSelection:r.SolutionComponentDisplayOptions.None},{componentType:a.StandardSolutionComponentTypes.AppModule,appTemplateSelection:r.SolutionComponentDisplayOptions.PersonalTab}],s=[];function l(e){return Object(o.isStandardSolutionComponentType)(e.componentType)}},6582:function(e,t,n){"use strict";n.r(t),n.d(t,"isModelAppPublishTeamsAppComponent",(function(){return i}));var o=n(6581),r=n(5609),a=n(5611);function i(e){return!!e&&Object(o.isPublishTeamsAppStandardComponentTypeInfo)(e)&&Object(r.areSameSolutionComponentType)(e.componentType,a.StandardSolutionComponentTypes.AppModule)}},6583:function(e,t,n){"use strict";n.r(t),n.d(t,"isBotPublishTeamsAppComponent",(function(){return a}));var o=n(6581),r=n(5613);function a(e){return!!e&&!Object(o.isPublishTeamsAppStandardComponentTypeInfo)(e)&&e.componentType===r.KnownCustomSolutionComponentTypes.bot.logicalName}},6584:function(e,t,n){"use strict";n.r(t),n.d(t,"isFlowPublishTeamsAppComponent",(function(){return i}));var o=n(6581),r=n(5609),a=n(5611);function i(e){return!!e&&Object(o.isPublishTeamsAppStandardComponentTypeInfo)(e)&&Object(r.areSameSolutionComponentType)(e.componentType,a.StandardSolutionComponentTypes.Flow)}},6585:function(e,t,n){"use strict";function o(e){return{close:e.t("Common.close"),title:e.t("Model.Solutions.PublishTeamsAppPanel.title"),SharedLabels:{next:e.t("Common.next"),cancel:e.t("Common.Save.cancel")},SolutionDetailsAndIconLabels:{subtitle:e.t("Model.Solutions.PublishTeamsAppPanel.SolutionDetailsAndIcon.subtitle"),subtitleContents:e.t("Model.Solutions.PublishTeamsAppPanel.SolutionDetailsAndIcon.subtitleContents"),learnMore:e.t("Model.Solutions.PublishTeamsAppPanel.SolutionDetailsAndIcon.learnMore"),Labels:{iconLabel:e.t("Model.Solutions.PublishTeamsAppPanel.SolutionDetailsAndIcon.Labels.iconLabel"),nameLabel:e.t("Model.Solutions.PublishTeamsAppPanel.SolutionDetailsAndIcon.Labels.nameLabel"),descriptionLabel:e.t("Model.Solutions.PublishTeamsAppPanel.SolutionDetailsAndIcon.Labels.descriptionLabel")},IconCustomization:{changeColor:e.t("Model.Solutions.PublishTeamsAppPanel.SolutionDetailsAndIcon.IconCustomization.changeColor"),changeIcon:e.t("Model.Solutions.PublishTeamsAppPanel.SolutionDetailsAndIcon.IconCustomization.changeIcon")},Errors:{packageNameError:e.t("Model.Solutions.PublishTeamsAppPanel.SolutionDetailsAndIcon.Errors.packageNameError"),packageDescriptionError:e.t("Model.Solutions.PublishTeamsAppPanel.SolutionDetailsAndIcon.Errors.packageDescriptionError")}},ComponentsAndRolesLabels:{subtitle:e.t("Model.Solutions.PublishTeamsAppPanel.ComponentsAndRoles.subtitle"),subtitleContents:e.t("Model.Solutions.PublishTeamsAppPanel.ComponentsAndRoles.subtitleContents"),publish:e.t("Model.Solutions.PublishTeamsAppPanel.ComponentsAndRoles.publish"),Loading:{fetchingSolutionComponents:e.t("Model.Solutions.PublishTeamsAppPanel.ComponentsAndRoles.Loading.fetchingSolutionComponents"),publishing:e.t("Model.Solutions.PublishTeamsAppPanel.ComponentsAndRoles.Loading.publishing")},Publish:{success:e.t("Model.Solutions.PublishTeamsAppPanel.ComponentsAndRoles.Publish.success"),successLink:e.t("Model.Solutions.PublishTeamsAppPanel.ComponentsAndRoles.Publish.successLink"),failure:e.t("Model.Solutions.PublishTeamsAppPanel.ComponentsAndRoles.Publish.failure"),managedComponents:e.t("Model.Solutions.PublishTeamsAppPanel.ComponentsAndRoles.Publish.managedComponents")},Options:{CanvasApp:{addAsPersonalApp:e.t("Model.Solutions.PublishTeamsAppPanel.ComponentsAndRoles.Options.CanvasApp.addAsPersonalApp"),addAsTeamsApp:e.t("Model.Solutions.PublishTeamsAppPanel.ComponentsAndRoles.Options.CanvasApp.addAsTeamsApp")}}}}}n.r(t),n.d(t,"getLabels",(function(){return o}))},6586:function(e,t,n){"use strict";n.r(t),n.d(t,"usePackageDetails",(function(){return r}));var o=n(245);function r(e,t,n){var[r,a]=Object(o.useState)(t),[i,s]=Object(o.useState)(n);return{packageName:r,setPackageName:a,validateName:t=>t?"":e.SolutionDetailsAndIconLabels.Errors.packageNameError,packageDescription:i,setPackageDescription:s,validateDescription:t=>t?"":e.SolutionDetailsAndIconLabels.Errors.packageDescriptionError}}},6587:function(e,t,n){"use strict";n.r(t),n.d(t,"useSupportedComponentTypes",(function(){return l})),n.d(t,"getAllSupportedSolutionComponentTypes",(function(){return c}));var o=n(245),r=n(5437),a=n(6471),i=n(5686),s=n(6581);function l(e,t,n){var[s,l]=Object(o.useState)(void 0),{errorMessage:p,loading:u,customComponentDefinitions:d}=Object(a.useSolutionCustomComponentTypesDefinition)(e.environmentClient,n,!1),m=Object(r.useDispatch)();return Object(o.useEffect)(()=>{if(!u&&!p){var e=c(d);m(Object(i.fetchSolutionComponentsRequest)({solutionId:t,componentTypes:e})),l(e)}},[u,p]),{supportedSolutionComponentTypes:s,isFetchCustomComponentDefinitionsLoading:u,fetchCustomComponentDefinitionsErrorMessage:p}}function c(e){return function(e){var t=[];return s.PublishTeamsAppPanelSupportedStandardComponentTypes.forEach(e=>{t.push(e.componentType)}),t=t.concat(e)}(function(e){if(!e)return[];return e.filter(e=>!!s.PublishTeamsAppPanelSupportedCustomComponentTypes.find(t=>e.logicalName===t.componentType))}(e))}},6588:function(e,t,n){"use strict";n.r(t),n.d(t,"useSupportedSolutionComponents",(function(){return d})),n.d(t,"convertSolutionComponents",(function(){return m}));var o=n(245),r=n(5437),a=n(5787),i=n(5607),s=n(6581),l=n(6584);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e,t,n){var i=Object(r.useSelector)(o=>e&&a.solutionComponentSelectors.solutionComponentListSelector(o,t,n,e)),[s,c]=Object(o.useState)(m(i));Object(o.useEffect)(()=>{c(m(i))},[i]);var p=Object(r.useSelector)(o=>e&&a.solutionComponentSelectors.solutionComponentListErrorsSelector(o,t,n.id,e)),u=Object(r.useSelector)(o=>e&&a.solutionComponentSelectors.isFetchingSolutionComponent(o,t,n&&n.id,e)),d=!1;s&&(d=!!s.find(e=>!Object(l.isFlowPublishTeamsAppComponent)(e)));return{packageComponents:s,setPackageComponents:c,fetchSupportedSolutionComponentsErrorMessage:p,isFetchSupportedSolutionComponentsLoading:u,hasComponentsBesidesFlows:d}}function m(e){var t=[];return e&&e.forEach(e=>{Object(i.isStandardSolutionComponent)(e)?s.PublishTeamsAppPanelSupportedStandardComponentTypes.forEach(n=>{Object(i.isOfSolutionComponentType)(e,n.componentType)&&t.push(b(e,n))}):s.PublishTeamsAppPanelSupportedCustomComponentTypes.forEach(n=>{e.msdyn_componentlogicalname===n.componentType&&t.push(b(e,n))})}),t}function b(e,t){return p(p({},e),t)}},6589:function(e,t,n){"use strict";n.r(t),n.d(t,"usePublishCallbacks",(function(){return p}));var o=n(5437),r=n(5593),a=n(5690),i=n(6590);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p(e,t,n,s,c,p,u,d,m){var b=Object(o.useDispatch)(),{_publishTeamsPackage:g,loading:y,errorMessage:S}=Object(i.useTeamsAppTemplatePublish)(e.environmentClient,e=>{b(Object(a.showPublishTeamsAppSuccessMessage)({appName:c,appLink:e})),m()},r.PortalScope,s);return{onPublishTeamsPackage:()=>{var e=function(e,t){var n=[];return t.forEach(e=>{n.push({objectId:e.msdyn_objectid,displayOption:e.appTemplateSelection,typeCode:e.msdyn_componenttype})}),l(l({},e),{},{SolutionComponentDisplaySettings:n})}({environmentName:n.name,solutionId:t,TemplateAppName:c,Description:p,IconParameters:{colorIconUri:"",outlineIconUri:u.imageUrl,accentColor:u.color}},d);g({variables:e})},isPublishOngoing:y,publishRequestErrorMessage:S}}},6590:function(e,t,n){"use strict";n.r(t),n.d(t,"useTeamsAppTemplatePublish",(function(){return c}));var o=n(3152),r=n(217),a=n(245),i=n(3192),s=n(3193),l=n(6591),c=(e,t,n,c)=>{var p=s.TelemetryScenarioNames.teamsPublish,[u,d]=Object(a.useState)(),[m,{loading:b,error:g,data:y}]=Object(o.useLazyQuery)(l.TeamsAppTemplatePublishQuery,{fetchPolicy:"no-cache",client:e||void 0,onCompleted:e=>{u&&u.complete(),t("TODO")},onError:e=>{if(u){var t=Object(i.getResponseMessageFromApolloError)(e,c);u.failure({error:t,clientError:e&&e.message})}}});return Object(a.useEffect)(()=>{b&&d(Object(r.trackLoadScenario)(n,p))},[b]),{_publishTeamsPackage:m,loading:b,errorMessage:g&&Object(i.getResponseMessageFromApolloError)(g,c),response:y}}},6591:function(e,t,n){"use strict";n.r(t),n.d(t,"TeamsAppTemplatePublishQuery",(function(){return s}));var o,r=n(3128);var a,i,s=n.n(r)()(o||(a=["\n  query TeamsPublishAppTemplate(\n    $environmentName: String!\n    $solutionId: String!\n    $TemplateAppName: String!\n    $Description: String!\n    $SolutionComponentDisplaySettings: [SolutionComponentDisplaySettingInput!]!\n    $IconParameters: TeamsIconInfo!\n  ) {\n    teamsAppTemplatePublish(\n      environmentName: $environmentName\n      solutionId: $solutionId\n      TemplateAppName: $TemplateAppName\n      Description: $Description\n      SolutionComponentDisplaySettings: $SolutionComponentDisplaySettings\n      IconParameters: $IconParameters\n    ) {\n      response\n    }\n  }\n"],i||(i=a.slice(0)),o=Object.freeze(Object.defineProperties(a,{raw:{value:Object.freeze(i)}}))))},6592:function(e,t,n){"use strict";n.r(t),n.d(t,"usePackageIcon",(function(){return a})),n.d(t,"defaultIconBackgroundColor",(function(){return i})),n.d(t,"defaultIconBase64",(function(){return s}));var o=n(245),r=n(6593);function a(){var[e,t]=Object(o.useState)(s),[n,a]=Object(o.useState)(i);return{color:n,onColorChange:a,imageUrl:e,onImageUpload:e=>{Object(r.readFileAsDataURLAsync)(e).then(e=>{t(e)}).catch(e=>{})},onImageReset:()=>{t(s)}}}var i="#742774",s="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMEAAADBCAYAAAB2QtScAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAARvSURBVHgB7d2BbSNFGIbhWZQCoIJcCVBBQgOIDjDXAL1QABc6uAaAlJISroJb1pwjReju4l17dmfnex7pl5VIiaPErz2WJrNDacw4jvfTzZsCnzwOw/BUKrop7TlM80uB6TlxmrfTPJSKvikQTgTEEwHxREA8ERBPBMQTAfFEQDwREE8ExGtx28Rcj9M8FfbivjS2N6yHCP4chuGh0LxxHIfp5l1pLALLIeKJgHgiIJ4IiCcC4omAeCIgngiIJwLiiYB41bdNLDhH6LbMczfdR2Ez1c8Fqm2NvUOHUvccocNpWN8q5wLVZjlEPBEQTwTEEwHxREA8ERBPBMQTAfFEQDwREK/FI1cei3OEtnRfwq4Z12IEzhHaSKvnAtVmOUQ8ERBPBMQTAfFEQDwREE8ExBMB8URAPBEQTwTEEwHxREA8ERBPBMQTAfFEQDwREE8ExBMB8URAPBEQb/aRKyHXIHs/DMOHQoQl5w4dSv/XIPttCvFHIWSwHPq876f5Zwrh20L3RPBlQgghgq8TQgARvE4InRPBeYTQMRGcTwidEsE8QuiQCOYTQmdEsIwQOiKC5YTQiTUu1/RY2r0G2fEB/HNZ7jkEWyx2bI0Imr4G2fQAPpRP1+laSgg7F78cOgX6a7mMpdGOeU9QhJBOBCdCyCWCF4SQSQT/I4Q8IvgMIWQRwRcIIYcIvkIIGUTwCiH0TwRnEELfRHAmIfRLBDMIoU8imEkI/RHBAkLoiwgWEkI/RHABIfRBBBcSwv6J4AqEsG8iuBIh7JcIruiKIfwthPWI4MquFMIPRQirEUEFQtgXEVQihP0QQUVC2AcRVCaE9olgBUJomwhWIoR2iWBFQmiTCFb2IoSxLPccwnfTFC4jgg2cQnhbLg/hr2mEcCERbOehCKEJItjI9GpwvHkoQticCDYkhDaIYGNC2J4IGiCEbYmgEULYjggaIoRtiKAxQlifCBokhHWJoFFCWI8IGiaEdYigcUKoTwQ7IIS6RLATQqhHBDsihDpEsDO1Qrgkhuevf21qf/+l93NT2J1jCNMf++H04R/HT5Vl/vsPtWl+f/G523K+4/3elXn3X/P7Hwt4nOap1HT85Y/zHApVnJ75DtN8HDk6/h4OZSbLoR274tIomgh2TgiXE0EHhHAZEXRCCMuJoCNCWEYEnRHCfCLokBDmEUGnhHA+EXRMCOcRQeeE8Dp7hwK82Gv0YZqfyn4cC76f5k2pSAQhTq8I70+zC1O4xx/6XakcgeUQ8URAPBEQTwTEEwHxREA8ERBPBMQTAfFEQDwREE8ExBMB8URAPBEQTwTEEwHxREA8ERBPBMQTAfFEQDwREE8ExBMB8URAPBEQTwTEEwHxREA8ERBPBMQTAfFEQDwREE8ExBMB8URAPBEQTwTEEwHxREA8ERBPBMQTAfFuygrGcSzQqjUiuJtmKLDMbalsjQgOp4EmeU9APBEQTwTEEwHxREA8ERBPBMQTAfFEQDwR0JvZG9WWbJt4nOZjgTY9lZn+BWtTIcpSyjpoAAAAAElFTkSuQmCC"},6593:function(e,t,n){"use strict";n.r(t),n.d(t,"readFileAsDataURLAsync",(function(){return o}));var o=e=>new Promise((t,n)=>{var o="",r=new FileReader;r.onloadend=e=>{"string"==typeof(o=e.target.result)?t(o):n(new Error("Result was not a string"))},r.onerror=e=>{n(e)},r.readAsDataURL(e)})},6594:function(e,t,n){"use strict";n.r(t),n.d(t,"useManagedSolutionComponents",(function(){return a}));var o=n(245),r=n(2868);function a(e){var[t,n]=Object(o.useState)(!1),[a,i]=Object(o.useState)(void 0),[s,l]=Object(o.useState)(!1);return Object(o.useEffect)(()=>{n(!0);try{r.MetadataClientInstance.getInstance().fetchList("SolutionComponentSummary",{solutionId:e},{filter:"msdyn_ismanaged eq 'true'"},{scenarioName:r.MCLTelemetryEventsMap.PAPortalPrefix}).then(e=>{var t;l(!(null==e||null===(t=e.data)||void 0===t||!t.length)),n(!1)}).catch(e=>{n(!1),i(e)})}catch(t){n(!1),i(t)}},[]),{isFetchManagedSolutionComponentsLoading:t,fetchManagedSolutionComponentsErrorMessage:a,hasManagedSolutionComponents:s}}},6595:function(e,t,n){"use strict";n.r(t),n.d(t,"mapStateToProps",(function(){return d})),n.d(t,"mapDispatchToProps",(function(){return m})),n.d(t,"mergeProps",(function(){return b})),n.d(t,"SolutionCheckerViewResultDetailPanelContainer",(function(){return g}));var o=n(5437),r=n(5478),a=n(5629),i=n(5468),s=n(5687),l=n(6596);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var d=(e,t)=>({logEvent:s.SolutionCheckerViewResultsListFilterPanelEvents,loadProgress:[Object(a.toLoadingState)(!0)]}),m=(e,t)=>({onPanelClose:()=>e(i.sharedActions.panelClose({panelType:r.PanelToShowType.SolutionCheckerViewResultDetailPanel})),dispatchTelemetry:e}),b=(e,t,n)=>p(p(p({},e),t),{},{defaultPanelProps:n.defaultPanelProps,onPanelClose:()=>t.onPanelClose(),dispatchTelemetry:t.dispatchTelemetry,solutionCheckerResultDetail:n.solutionCheckerResultDetail}),g=Object(o.connect)(d,m,b)(l.SolutionCheckerViewResultDetailPanel)},6596:function(e,t,n){"use strict";n.r(t),n.d(t,"SolutionCheckerViewResultDetailPanel",(function(){return d}));var o=n(4013),r=n(1090),a=n(1573),i=n(245),s=n(2890),l=n(2869),c=n(6597),p=n(6599);function u(){return(u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}class d extends i.Component{constructor(e){super(e),this.resources=void 0,this.GetDetail=(e,t)=>e&&e.analysisDetail?i.createElement("div",{className:"app-module-share-panel-content"},this.GetSubtitleAndStep(t.Model.Solutions.SolutionCheckerResults.DetailsPanel.issue,e.statement),this.GetSubtitleAndStep(t.Model.Solutions.SolutionCheckerResults.DetailsPanel.howToFix,this.GetHowToFix(e.solutionCheckerRule)),this.GetStepsList(e.solutionCheckerRule),this.GetSubtitleAndStep(t.Model.Solutions.SolutionCheckerResults.DetailsPanel.location,Object(c.getSolutionCheckerResultPropertyValueAsString)("msdyn_fileuri",e.analysisDetail)),i.createElement("div",{className:"panel-step"},this.GetDetailsByComponent(e))):null,this.onDismiss=()=>{this.props.onPanelClose()},this.GetStepsList=e=>{if(e&&e.howToFix&&e.howToFix.steps&&e.howToFix.steps.length>0){var t=e.howToFix.steps.map((e,t)=>i.createElement("li",{key:t},e));return i.createElement("div",{className:".panel-step-heading"},i.createElement("ul",null,t))}return null},this.GetHowToFix=e=>e?e.description?i.createElement(i.Fragment,null,i.createElement("span",null,e.description),i.createElement("br",null),i.createElement("span",{className:p.solutionCheckerViewResultDetailPanelStyles.guidanceUrlSpacing},this.GetGuidanceUrl(e))):i.createElement(i.Fragment,null,i.createElement("span",null,this.GetGuidanceUrl(e))):null,this.GetGuidanceUrl=e=>e&&e.guidanceUrl?i.createElement(r.Link,{href:e.guidanceUrl,target:"_blank"},this.resources.Model.Solutions.SolutionCheckerResults.DetailsPanel.getGuidance):null,this.GetSubtitleAndStep=(e,t)=>i.createElement(i.Fragment,null,i.createElement("div",{className:"panel-subtitle"},e),i.createElement("div",{className:"panel-step"},t),i.createElement("br",null),i.createElement("br",null)),this.GetDetailsByComponent=e=>{if(!e||!e.componentType)return null;switch(e.analysisDetail.msdyn_componenttype){case s.SolutionCheckerComponentTypeCodes.PlugIn:return i.createElement(i.Fragment,null,i.createElement("br",null),this.GetSubtitleAndStep(this.resources.Model.Solutions.SolutionCheckerResults.DetailsPanel.module,e.analysisDetail.msdyn_module),this.GetSubtitleAndStep(this.resources.Model.Solutions.SolutionCheckerResults.DetailsPanel.type,e.componentType),this.GetSubtitleAndStep(this.resources.Model.Solutions.SolutionCheckerResults.DetailsPanel.member,e.analysisDetail.msdyn_member));case s.SolutionCheckerComponentTypeCodes.WebResources:return i.createElement(i.Fragment,null,i.createElement("br",null),this.GetSubtitleAndStep(this.resources.Model.Solutions.SolutionCheckerResults.DetailsPanel.statement,e.analysisDetail.msdyn_snippet),this.GetSubtitleAndStep(this.resources.Model.Solutions.SolutionCheckerResults.DetailsPanel.line,e.analysisDetail.msdyn_line));case s.SolutionCheckerComponentTypeCodes.Configuration:default:return null}},this.resources=Object(l.getResources)()}render(){return i.createElement(o.Panel,u({},this.props.defaultPanelProps,{isBlocking:!1,closeButtonType:o.PanelCloseButtonType.Close,closeButtonAriaLabel:this.resources.Common.close,onDismiss:this.onDismiss,type:a.PanelType.smallFixedFar,headerText:this.resources.Model.Solutions.SolutionCheckerResults.DetailsPanel.headerText,className:p.solutionCheckerViewResultDetailPanelStyles["solution-checker-result-detail-panel"],headerClassName:"panel-header"}),this.GetDetail(this.props.solutionCheckerResultDetail,this.resources))}}},6597:function(e,t,n){"use strict";n.r(t),n.d(t,"groupingColumnsList",(function(){return p})),n.d(t,"groupingColumnsListForBreadCrumb",(function(){return u})),n.d(t,"columnGroupRenderCount",(function(){return d})),n.d(t,"iterativeCompare",(function(){return m})),n.d(t,"customCompare",(function(){return b})),n.d(t,"groupResults",(function(){return g})),n.d(t,"groupSolutionCheckerResults",(function(){return S})),n.d(t,"getGroupingPropertyList",(function(){return f})),n.d(t,"getSortingOrderPropertyList",(function(){return h})),n.d(t,"getSolutionCheckerResultPropertyValueAsString",(function(){return O})),n.d(t,"getSolutionCheckerSeverityText",(function(){return v})),n.d(t,"getSolutionCheckerComponentTypeText",(function(){return E})),n.d(t,"getSolutionCheckerCategoryText",(function(){return j})),n.d(t,"populateLocalizedTextValues",(function(){return A})),n.d(t,"getUnCollapsedGroups",(function(){return R})),n.d(t,"setUnCollapsedGroups",(function(){return I}));var o=n(6598),r=n(2890),a=n(2869),i=n(2903),s=[{propertyName:"msdyn_ruleid"}],l=[{propertyName:"msdyn_fileuri"}],c=[{propertyName:"msdyn_severity",isDescending:!0}],p=["msdyn_category","msdyn_componenttype","msdyn_severity","msdyn_fileuri"],u=["msdyn_fileuri","msdyn_category","msdyn_componenttype","msdyn_severity"],d=5;function m(e,t,n){var o=0;for(o=0;o<n.length;o++){var r=b(e,t,n[o]);if(0!==r)return r}return 0}function b(e,t,n){var o=!!n.isDescending&&n.isDescending,r=0;if(n.compare)r=n.compare(e,t);else{var a=n.propertyName;e[a]>t[a]?r=1:e[a]<t[a]&&(r=-1)}return o?-1*r:r}function g(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:(e,t)=>t[e].toString();return y(e,t,0,e.length-1,0,n,o)}function y(e,t,n,o,r,a,i){if(r>=a.length)return null;var s,l={},c=a[r];for(s=n;s<=o;s++){var p=i(c,t[e[s]]);l[p]?l[p].count++:l[p]={key:p,name:i(c,t[e[s]]),startIndex:s,count:1,isCollapsed:!0,level:r}}return Object.keys(l).map(n=>{var o=y(e,t,l[n].startIndex,l[n].startIndex+l[n].count-1,r+1,a,i);return o&&(l[n].children=o),l[n]})}function S(e,t,n){return g(e,t,n,O)}function f(e){return e===o.SolutionCheckerResultsGroupingOptions.ByIssue?s:e===o.SolutionCheckerResultsGroupingOptions.ByLocation?l:c}function h(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=[],r=-1,a=[{propertyName:"msdyn_category"},{propertyName:"msdyn_componenttype"},{propertyName:"msdyn_message"}];if(e===o.SolutionCheckerResultsGroupingOptions.ByIssue?(n=[...s,...l,...c],r=s.length):e===o.SolutionCheckerResultsGroupingOptions.ByLocation?(n=[...l,...s,...c],r=l.length):(n=[...c,...l,...s],r=c.length),n.push(...a),t){var i=n.findIndex(e=>e.propertyName===t.propertyName);if(i>-1){n.splice(i,1);var p=n.splice(0,r);n=[...p,t,...n]}}return n}function O(e,t){if(!t)return"";var n=Object(a.getResources)();switch(e){case"msdyn_severity":return v(t[e]);case"msdyn_componenttype":return E(t[e]);case"msdyn_category":return j(t[e]);case"msdyn_fileuri":return t[e]?t[e].toString():n.Model.Solutions.SolutionCheckerResults.FileUri.unspecified}return t[e]?t[e].toString():""}var C=Object(i.memoizeFunction)(e=>({[r.SolutionCheckerSeverityCodes.Low]:e.Model.Solutions.SolutionCheckerResults.Severity.low,[r.SolutionCheckerSeverityCodes.Medium]:e.Model.Solutions.SolutionCheckerResults.Severity.medium,[r.SolutionCheckerSeverityCodes.High]:e.Model.Solutions.SolutionCheckerResults.Severity.high,[r.SolutionCheckerSeverityCodes.Critical]:e.Model.Solutions.SolutionCheckerResults.Severity.critical}));function v(e){var t=Object(a.getResources)(),n=C(t)[e];return n||""}var P=Object(i.memoizeFunction)(e=>({[r.SolutionCheckerComponentTypeCodes.WebResources]:e.Model.Solutions.SolutionCheckerResults.ComponentType.webResources,[r.SolutionCheckerComponentTypeCodes.PlugIn]:e.Model.Solutions.SolutionCheckerResults.ComponentType.plugIn,[r.SolutionCheckerComponentTypeCodes.Configuration]:e.Model.Solutions.SolutionCheckerResults.ComponentType.configuration}));function E(e){var t=Object(a.getResources)(),n=P(t)[e];return n||""}var T=Object(i.memoizeFunction)(e=>({[r.SolutionCheckerCategoryCodes.Design]:e.Model.Solutions.SolutionCheckerResults.Category.design,[r.SolutionCheckerCategoryCodes.Maintainability]:e.Model.Solutions.SolutionCheckerResults.Category.maintainability,[r.SolutionCheckerCategoryCodes.OnlineMigration]:e.Model.Solutions.SolutionCheckerResults.Category.onlineMigration,[r.SolutionCheckerCategoryCodes.Performance]:e.Model.Solutions.SolutionCheckerResults.Category.performance,[r.SolutionCheckerCategoryCodes.Security]:e.Model.Solutions.SolutionCheckerResults.Category.security,[r.SolutionCheckerCategoryCodes.Supportability]:e.Model.Solutions.SolutionCheckerResults.Category.supportability,[r.SolutionCheckerCategoryCodes.UpgradeReadiness]:e.Model.Solutions.SolutionCheckerResults.Category.upgradeReadiness,[r.SolutionCheckerCategoryCodes.Usage]:e.Model.Solutions.SolutionCheckerResults.Category.usage}));function j(e){var t=Object(a.getResources)(),n=T(t)[e];return n||t.Model.Solutions.SolutionCheckerResults.Category.none}function A(e){return e&&p.forEach(t=>{e.has(t)&&e.get(t).forEach(e=>{var n=parseInt(e.value),o="";switch(t){case"msdyn_category":o=j(n);break;case"msdyn_componenttype":o=E(n);break;case"msdyn_severity":o=v(n);break;case"msdyn_fileuri":var r=Object(a.getResources)();o=e.value?e.value:r.Model.Solutions.SolutionCheckerResults.FileUri.unspecified;break;default:o=e.value}e.text=o})}),e}function R(e,t){e&&e.length>0&&e.forEach(e=>{e.isCollapsed||(t.push(w(e.name,e.level)),e.children&&R(e.children,t))})}function I(e,t){e&&e.length>0&&e.forEach(e=>{t.indexOf(w(e.name,e.level))>-1&&(e.isCollapsed=!1,e.children&&I(e.children,t))})}function w(e,t){return"".concat(e,"+").concat(t)}},6598:function(e,t,n){"use strict";n.r(t),n.d(t,"SolutionCheckerViewResultsCommandKey",(function(){return o})),n.d(t,"getSolutionCheckerViewResultsSpecificCommands",(function(){return c})),n.d(t,"SolutionCheckerResultsGroupingOptions",(function(){return r})),n.d(t,"getSolutionCheckerViewResultRightCommands",(function(){return p}));var o,r,a=n(2886),i=n(5617),s=n(2879),l=n(2869);function c(e){var t=Object(l.getResources)();return[{key:o.SolutionCheckerDownload,name:t.Model.Solutions.Commands.solutionCheckerDownload,disabled:e.isSolutionCheckerDownloadStarting||e.isSolutionCheckerStatusLoading||!e.solution||!e.solution.solutionCheckerResults||!Object(a.isSolutionCheckerResultsValid)(e.solution),onClick:()=>e.props.onSolutionCheckerDownloadClick(e.solution,e.environmentId),iconProps:{iconName:s.fabricIcons.Download,style:{color:i.fabricTheme.palette.themePrimary}}}]}function p(e){var t=Object(l.getResources)(),n={iconName:s.fabricIcons.CheckMark,style:{color:i.fabricTheme.palette.themePrimary}},o=[{key:r.ByLocation,text:t.Model.Solutions.SolutionCheckerResults.Commands.byLocation,onClick:()=>e.props.onSolutionCheckerResultsSortByGroupOption(r.ByLocation,e.environmentId),iconProps:e.groupingOptions===r.ByLocation?n:null},{key:r.ByIssue,text:t.Model.Solutions.SolutionCheckerResults.Commands.byIssue,onClick:()=>e.props.onSolutionCheckerResultsSortByGroupOption(r.ByIssue,e.environmentId),iconProps:e.groupingOptions===r.ByIssue?n:null},{key:r.BySeverity,text:t.Model.Solutions.SolutionCheckerResults.Commands.bySeverity,onClick:()=>e.props.onSolutionCheckerResultsSortByGroupOption(r.BySeverity,e.environmentId),iconProps:e.groupingOptions===r.BySeverity?n:null}],a="";switch(e.groupingOptions){case r.ByLocation:a=t.Model.Solutions.SolutionCheckerResults.Commands.byLocation;break;case r.ByIssue:a=t.Model.Solutions.SolutionCheckerResults.Commands.byIssue;break;case r.BySeverity:a=t.Model.Solutions.SolutionCheckerResults.Commands.bySeverity}return[{key:"sortorder",name:a,iconProps:{iconName:s.fabricIcons.SortLines,style:{color:i.fabricTheme.palette.themePrimary}},subMenuProps:{items:o}},{key:"filter",ariaLabel:"filter",onClick:()=>e.props.onSolutionCheckerResultsOpenFilterPanel(),iconProps:{iconName:e.isFilterApplied?s.fabricIcons.FilterSolid:s.fabricIcons.Filter,style:{color:i.fabricTheme.palette.themePrimary},"aria-labelledby":"filter"}}]}!function(e){e.SolutionCheckerRun="SolutionCheckerRun",e.SolutionCheckerDownload="SolutionCheckerDownload"}(o||(o={})),function(e){e.ByLocation="ByLocation",e.ByIssue="ByIssue",e.BySeverity="BySeverity"}(r||(r={}))},6599:function(e,t,n){"use strict";n.r(t),n.d(t,"solutionCheckerViewResultDetailPanelStyles",(function(){return i}));var o=n(719),r=n(5492),a=n(2882),i=Object(o.mergeStyleSets)({"solution-checker-result-detail-panel":{selectors:{".ba-Panel-headerContainer":{paddingTop:"15px",paddingLeft:"24px"},".ms-Panel-content, .ms-Panel-footer":{paddingLeft:"24px"},".panel-header":{fontFamily:r.fonts.segoeUi,fontSize:"20px",lineHeight:"28px",color:"".concat(a.fabricColors.mineShaft),fontWeight:"normal"},".app-module-share-panel-content":{fontFamily:r.fonts.segoeUi,lineHeight:"16px",fontSize:"12px",marginTop:"0px",selectors:{".panel-subtitle":{color:a.fabricColors.doveGray},".panel-step":{lineHeight:"16px",fontSize:"14px",wordWrap:"break-word",selectors:{".panel-step-heading":{color:a.fabricColors.mineShaft,lineHeight:"20px",fontSize:"14px"},".panel-step-message":{marginTop:"4px",paddingLeft:"15px",color:a.fabricColors.doveGray}}}}}}},guidanceUrlSpacing:{paddingTop:"12px",display:"inline-block"}})},6600:function(e,t,n){"use strict";n.r(t),n.d(t,"mapStateToProps",(function(){return y})),n.d(t,"mapDispatchToProps",(function(){return S})),n.d(t,"mergeProps",(function(){return f})),n.d(t,"SolutionCheckerViewResultsFilterPanelContainer",(function(){return h}));var o=n(5437),r=n(5478),a=n(5629),i=n(5468),s=n(5687),l=n(6601),c=n(6602),p=n(6603),u=n(5487),d=n(5582);function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){g(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var y=(e,t)=>{var n=Object(d.currentEnvironmentIdSelector)(t);return{logEvent:s.SolutionCheckerViewResultsListFilterPanelEvents,loadProgress:[{state:a.ComponentLoadState.Complete}],columnGroups:Object(c.solutionCheckerResultsColumnGroups)(e,n)}},S=(e,t)=>{var n=Object(d.currentEnvironmentIdSelector)(t);return{onPanelClose:()=>e(i.sharedActions.panelClose({panelType:r.PanelToShowType.SolutionCheckerViewResultsFilterPanel})),dispatchOnFilterCheckBoxChange:t=>e(Object(p.filterSolutionCheckerResultsRequest)(t)),dispatchClearFilters:()=>e(Object(p.clearFilterSolutionCheckerResultsRequest)({environmentId:n})),dispatchTelemetry:e}},f=(e,t,n)=>{var o=Object(d.currentEnvironmentIdSelector)(n);return b(b({},e),{},{defaultPanelProps:n.defaultPanelProps,onPanelClose:()=>t.onPanelClose(),columnGroups:e.columnGroups,dispatchTelemetry:t.dispatchTelemetry,onFilterCheckBoxChange:(e,n,r)=>t.dispatchOnFilterCheckBoxChange({columnName:e,columnValue:n,checked:r,environmentId:o}),clearFilters:()=>t.dispatchClearFilters()})},h=Object(u.withRootProps)(Object(o.connect)(y,S,f)(l.SolutionCheckerViewResultsFilterPanel))},6601:function(e,t,n){"use strict";n.r(t),n.d(t,"SolutionCheckerViewResultsFilterPanel",(function(){return E}));var o=n(4013),r=n(245),a=n(2869),i=n(1573),s=n(1362),l=n(719),c=n(684),p=n(545),u=n(6469),d=n(2879),m=n(2882),b=n(6464),g=n(1252),y=n(6597),S=n(2880);function f(){return(f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){C(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function C(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var v=Object(l.mergeStyleSets)({clearFilterDiv:{marginLeft:"-16px",backgroundColor:m.fabricColors.neutralLighter},clearFilterButton:{marginLeft:"12px",paddingLeft:"0px"},filterDiv:{paddingBottom:"15px"},filterName:{paddingTop:"5px",paddingBottom:"5px",fontSize:l.FontSizes.small},seeAllButton:{marginLeft:"-8px",color:m.fabricColors.plum}}),P=O(O({},u.managedPropertiesPanelStyles.checkBoxStyles),{},{label:{fontWeight:"normal",whiteSpace:"nowrap"}});class E extends r.Component{constructor(e){super(e),this.resources=void 0,this.memoizedPopulateColumnGroups=void 0,this.onDismiss=()=>{this.props.onPanelClose()},this.setPanelOpenIndex=e=>{this.state.panelOpenIndex!==e&&this.setState({panelOpenIndex:e})},this.state={panelOpenIndex:0,filterName:"",filterValues:[],columnName:null,filterText:""},this.resources=Object(a.getResources)(),this.props.onFilterCheckBoxChange.bind(this),this.memoizedPopulateColumnGroups=Object(p.memoizeFunction)(e=>Object(y.populateLocalizedTextValues)(e))}render(){var e=this.memoizedPopulateColumnGroups(this.props.columnGroups).some(e=>e.some(e=>e.isChecked)),t=[{hasCloseButton:!0,closeButtonType:o.PanelCloseButtonType.Close,closeButtonAriaLabel:this.resources.Common.close,type:i.PanelType.medium,headerText:this.resources.Model.Solutions.SolutionCheckerResults.FilterPanel.headerText,className:"solution-checker-view-results-filters-panel",children:this.filterContents(e)},{hasCloseButton:!0,closeButtonType:o.PanelCloseButtonType.Back,closeButtonAriaLabel:this.resources.Common.back,type:i.PanelType.medium,headerText:this.state.filterName,className:"solution-checker-view-results-filters-extendend-panel",children:this.getSpecificFilterContents()}];return r.createElement(b.MultistepPanel,f({customWidth:void 0,dismissDialog:void 0,dismissOnEscape:void 0,isBlocking:!0,isHiddenOnDismiss:!0,onDismissed:void 0,onLightDismissClick:void 0,showDismissDialog:void 0,isLightDismiss:!1,onOuterClick:void 0,isOpen:void 0},this.props.defaultPanelProps,{onDismiss:this.onDismiss,panelsListProps:t,panelOpenIndex:this.state.panelOpenIndex,setPanelOpenIndex:this.setPanelOpenIndex}))}filterContents(e){var t=this.memoizedPopulateColumnGroups(this.props.columnGroups);return r.createElement(r.Fragment,null,r.createElement("div",{className:v.clearFilterDiv},r.createElement(c.DefaultButton,{className:v.clearFilterButton,allowDisabledFocus:!0,disabled:!e,text:this.resources.Model.Solutions.SolutionCheckerResults.FilterPanel.clearAll,onClick:()=>{this.props.clearFilters()},iconProps:{iconName:d.fabricIcons.ClearFilter}})),r.createElement("div",null,this.getFilterLists(this.resources.Model.Solutions.SolutionCheckerResults.FilterPanel.SearchGroup.severity,t.get("msdyn_severity"),"msdyn_severity",(e,t)=>e.value>t.value?-1:e.value<t.value?1:0),this.getFilterLists(this.resources.Model.Solutions.SolutionCheckerResults.FilterPanel.SearchGroup.category,t.get("msdyn_category"),"msdyn_category"),this.getFilterLists(this.resources.Model.Solutions.SolutionCheckerResults.FilterPanel.SearchGroup.component,t.get("msdyn_componenttype"),"msdyn_componenttype"),this.getFilterLists(this.resources.Model.Solutions.SolutionCheckerResults.FilterPanel.SearchGroup.location,t.get("msdyn_fileuri"),"msdyn_fileuri")))}getFilterLists(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=[];return t&&t.length>0&&(o&&(t=t.sort(o)),t.slice(0,y.columnGroupRenderCount).forEach(e=>{a.push(this.onRenderCell(e,n))})),r.createElement("div",{className:v.filterDiv},r.createElement("span",{className:v.filterName},e),a,this.renderSeeAllTag(e,t,n))}getSpecificFilterContents(){var e=[];return this.state.filterValues&&this.state.filterValues.length>0&&this.state.filterValues.forEach(t=>{e.push(this.onRenderCell(t,this.state.columnName))}),r.createElement("div",{className:v.filterDiv},r.createElement(g.SearchBox,{placeholder:this.generatePlaceholderText(this.state.columnName),onChange:(e,t)=>{this.setState({filterValues:this.memoizedPopulateColumnGroups(this.props.columnGroups).get(this.state.columnName).filter(e=>e.text.toLowerCase().indexOf((t||"").toLowerCase())>-1)})},onClear:()=>this.setState({filterValues:this.memoizedPopulateColumnGroups(this.props.columnGroups).get(this.state.columnName)}),onEscape:()=>this.setState({filterValues:this.memoizedPopulateColumnGroups(this.props.columnGroups).get(this.state.columnName)})}),e)}onRenderCell(e,t){return r.createElement(s.Checkbox,{label:e.text,styles:P,checked:!!e.isChecked,onChange:(n,o)=>this.props.onFilterCheckBoxChange(t,e.value,o)})}renderSeeAllTag(e,t,n){return t&&t.length>y.columnGroupRenderCount?r.createElement(c.ActionButton,{className:v.seeAllButton,onClick:()=>this.setState({panelOpenIndex:1,filterName:e,filterValues:t,columnName:n})},this.resources.Model.Solutions.SolutionCheckerResults.FilterPanel.seeAll):null}generatePlaceholderText(e){var t=Object(a.getResources)(),n="";switch(e){case"msdyn_category":n=t.Model.Solutions.SolutionCheckerResults.FilterPanel.SearchGroup.category;break;case"msdyn_componenttype":n=t.Model.Solutions.SolutionCheckerResults.FilterPanel.SearchGroup.component;break;case"msdyn_severity":n=t.Model.Solutions.SolutionCheckerResults.FilterPanel.SearchGroup.severity;break;case"msdyn_fileuri":n=t.Model.Solutions.SolutionCheckerResults.FilterPanel.SearchGroup.location;break;default:n=""}return Object(S.formatResourceString)(t.Model.Solutions.SolutionCheckerResults.FilterPanel.searchBoxPlaceholder,n.toLocaleLowerCase())}}},6602:function(e,t,n){"use strict";n.r(t),n.d(t,"solutionCheckerResultsListSelector",(function(){return r})),n.d(t,"solutionCheckerResultsIndexSelector",(function(){return a})),n.d(t,"solutionCheckerGroupsSelector",(function(){return i})),n.d(t,"solutionCheckerResultsGroupOptionsSelector",(function(){return s})),n.d(t,"isSolutionCheckerResultsApiLoading",(function(){return l})),n.d(t,"solutionCheckerResultsListCount",(function(){return c})),n.d(t,"solutionCheckerRulesSelector",(function(){return p})),n.d(t,"solutionCheckerResultDetailSelector",(function(){return u})),n.d(t,"solutionCheckerResultsColumnGroups",(function(){return d})),n.d(t,"solutionCheckerResultsSearchString",(function(){return m}));var o=n(6598),r=(e,t)=>{var n=e.solutionCheckerResults.solutionCheckerResults.get(t);return n?e.solutionCheckerResults.solutionCheckerViewSets.get(t).resultIndex.map((e,t)=>n[e]):[]},a=(e,t)=>{var n=e.solutionCheckerResults.solutionCheckerViewSets.get(t);return n?n.resultIndex:[]},i=(e,t)=>{var n=e.solutionCheckerResults.solutionCheckerViewSets.get(t);return n?n.resultGroups:[]},s=(e,t)=>{var n=e.solutionCheckerResults.solutionCheckerViewSets.get(t);return n?n.groupingOption:o.SolutionCheckerResultsGroupingOptions.ByIssue},l=(e,t)=>e.solutionCheckerResults.solutionCheckerResultsApiStatus.has(t)&&e.solutionCheckerResults.solutionCheckerResultsApiStatus.get(t).loading,c=(e,t)=>e.solutionCheckerResults.solutionCheckerViewSets.has(t)?e.solutionCheckerResults.solutionCheckerViewSets.get(t).resultCount:0,p=(e,t)=>{var n=e.solutionCheckerResults.solutionCheckerRules.get(t);return n||[]},u=e=>e.solutionCheckerResults.solutionCheckerResultDetail,d=(e,t)=>{var n=e.solutionCheckerResults.solutionCheckerViewSets.get(t);return n?n.columnGroups:null},m=(e,t)=>{var n=e.solutionCheckerResults.solutionCheckerViewSets.get(t);return n?n.searchString:""}},6603:function(e,t,n){"use strict";var o;function r(e){return{type:o.FETCH_SOLUTION_CHECKER_RESULTS_REQUEST,payload:e}}function a(e){return{type:o.FETCH_SOLUTIONS_CHECKER_RESULTS_FULFILLED,payload:e}}function i(e){return{type:o.FETCH_SOLUTIONS_CHECKER_RESULTS_REJECTED,payload:e}}function s(e){return{type:o.CHANGE_GROUPING_SOLUTION_CHECKER_RESULTS,payload:e}}function l(){return{type:o.OPEN_SOLUTION_CHECKER_RESULTS_FILTER_PANEL}}function c(e){return{type:o.OPEN_SOLUTION_CHECKER_RESULT_DETAIL_PANEL,payload:e}}function p(e){return{type:o.FETCH_SOLUTION_CHECKER_RULES_REQUEST,payload:e}}function u(e){return{type:o.FETCH_SOLUTIONS_CHECKER_RULES_FULFILLED,payload:e}}function d(e){return{type:o.FETCH_SOLUTIONS_CHECKER_RULES_REJECTED,payload:e}}function m(e){return{type:o.FILTER_SOLUTION_CHECKER_RESULT_REQUEST,payload:e}}function b(e){return{type:o.CLEAR_FILTER_SOLUTION_CHECKER_RESULT_REQUEST,payload:e}}function g(e){return{type:o.SEARCH_FILTER_SOLUTION_CHECKER_RESULT,payload:e}}function y(e){return{type:o.CLEAR_SEARCH_FILTER_SOLUTION_CHECKER_RESULT,payload:e}}function S(e){return{type:o.ORDER_SOLUTION_CHECKER_RESULTS_CLIENT_SIDE,payload:e}}n.r(t),n.d(t,"SolutionCheckerResultsActionTypes",(function(){return o})),n.d(t,"fetchSolutionCheckerResultsRequest",(function(){return r})),n.d(t,"fetchSolutionCheckerResultsFulfilled",(function(){return a})),n.d(t,"fetchSolutionCheckerResultsRejected",(function(){return i})),n.d(t,"changeGroupingSolutionCheckerResults",(function(){return s})),n.d(t,"openSolutionCheckerResultsFilterPanel",(function(){return l})),n.d(t,"openSolutionCheckerResultDetailPanel",(function(){return c})),n.d(t,"fetchSolutionCheckerRulesRequest",(function(){return p})),n.d(t,"fetchSolutionCheckerRulesFulfilled",(function(){return u})),n.d(t,"fetchSolutionCheckerRulesRejected",(function(){return d})),n.d(t,"filterSolutionCheckerResultsRequest",(function(){return m})),n.d(t,"clearFilterSolutionCheckerResultsRequest",(function(){return b})),n.d(t,"searchFilterSolutionCheckerResult",(function(){return g})),n.d(t,"clearSearchFilterSolutionCheckerResult",(function(){return y})),n.d(t,"orderSolutionCheckerResultsClientSide",(function(){return S})),function(e){e.FETCH_SOLUTION_CHECKER_RESULTS_REQUEST="maker/model/solutionCheckerResults/FETCH_SOLUTION_CHECKER_RESULTS_REQUEST",e.FETCH_SOLUTIONS_CHECKER_RESULTS_FULFILLED="maker/model/solutionCheckerResults/FETCH_SOLUTIONS_CHECKER_RESULTS_FULFILLED",e.FETCH_SOLUTIONS_CHECKER_RESULTS_REJECTED="maker/model/solutionCheckerResults/FETCH_SOLUTIONS_CHECKER_RESULTS_REJECTED",e.CHANGE_GROUPING_SOLUTION_CHECKER_RESULTS="maker/model/solutionCheckerResults/CHANGE_GROUPING_SOLUTION_CHECKER_RESULTS",e.OPEN_SOLUTION_CHECKER_RESULTS_FILTER_PANEL="maker/model/solutionCheckerResults/OPEN_SOLUTION_CHECKER_RESULTS_FILTER_PANEL",e.OPEN_SOLUTION_CHECKER_RESULT_DETAIL_PANEL="maker/model/solutionCheckerResults/OPEN_SOLUTION_CHECKER_RESULT_DETAIL_PANEL",e.ORDER_SOLUTION_CHECKER_RESULTS_CLIENT_SIDE="maker/model/solutionCheckerResults/ORDER_SOLUTION_CHECKER_RESULTS_CLIENT_SIDE",e.FETCH_SOLUTION_CHECKER_RULES_REQUEST="maker/model/solutionCheckerResults/FETCH_SOLUTION_CHECKER_RULES_REQUEST",e.FETCH_SOLUTIONS_CHECKER_RULES_FULFILLED="maker/model/solutionCheckerResults/FETCH_SOLUTIONS_CHECKER_RULES_FULFILLED",e.FETCH_SOLUTIONS_CHECKER_RULES_REJECTED="maker/model/solutionCheckerResults/FETCH_SOLUTIONS_CHECKER_RULES_REJECTED",e.FILTER_SOLUTION_CHECKER_RESULT_REQUEST="maker/model/solutionCheckerResults/FILTER_SOLUTION_CHECKER_RESULT_REQUEST",e.CLEAR_FILTER_SOLUTION_CHECKER_RESULT_REQUEST="maker/model/solutionCheckerResults/CLEAR_FILTER_SOLUTION_CHECKER_RESULT_REQUEST",e.SEARCH_FILTER_SOLUTION_CHECKER_RESULT="maker/model/solutionCheckerResults/SEARCH_FILTER_SOLUTION_CHECKER_RESULT",e.CLEAR_SEARCH_FILTER_SOLUTION_CHECKER_RESULT="maker/model/solutionCheckerResults/CLEAR_SEARCH_FILTER_SOLUTION_CHECKER_RESULT"}(o||(o={}))},6604:function(e,t,n){"use strict";n.r(t),n.d(t,"mapStateToProps",(function(){return R})),n.d(t,"mapDispatchToProps",(function(){return I})),n.d(t,"mergeProps",(function(){return w})),n.d(t,"SolutionComponentAddExistingPanelContainer",(function(){return D}));var o=n(5437),r=n(2886),a=n(5478),i=n(5629),s=n(5787),l=n(5810),c=n(5691),p=n(5468),u=n(5687),d=n(6605),m=n(5487),b=n(5582),g=n(5812),y=n(5675),S=n(5809),f=n(5604),h=n(5693),O=n(6657),C=n(5690),v=n(6625),P=n(5819),E=n(6662);function T(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?T(Object(n),!0).forEach((function(t){A(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):T(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function A(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var R=(e,t)=>{var n=Object(b.currentEnvironmentIdSelector)(t),o=t.rootProps.currentEnvironment,r=Object(c.solutionSelector)(e,t.solutionId),s=!!Object(g.unsupportedFlowsSelector)(e),d=Object(l.addSolutionComponentsStatus)(e),m=d.failed&&d.message,h=p.sharedSelectors.panelsSelector(e).some(e=>e.panelType===a.PanelToShowType.AddSubcomponentsPanel);return{selectedSolution:r,logEvent:u.SolutionComponentsAddExistingPanelLoad,loadProgress:[Object(i.toLoadingState)(!!r,m)],addSolutionComponentsResponse:d,isCustomerServiceAppInstalled:Object(c.isCustomerServiceAppInstalled)(e),isDualWriteCoreSolutionInstalled:Object(c.isDualWriteCoreSolutionInstalled)(e,n),isCustomConnectorSupported:Object(y.isCRMVersionCompatibleForCustomConnector)(Object(f.getCrmVersion)(o)),isComponentLibrariesSupported:Object(S.isCRMVersionCompatibleForComponentLibraries)(Object(f.getCrmVersion)(o)),hasUnsupportedComponents:s,isAddSubcomponentsPanelOpen:h}},I=(e,t)=>({onPanelClose:n=>(t.onClosePanel&&t.onClosePanel(n),e(p.sharedActions.panelClose({panelType:a.PanelToShowType.SolutionComponentAddExistingPanel}))),fetchSolutionsRequest:()=>{e(Object(C.fetchSolutionsRequest)())},addSolutionComponentsRequest:t=>e(s.solutionComponentsActions.addSolutionComponentsRequest(t)),addSolutionUnawareCanvasAppsRequest:t=>e(s.solutionComponentsActions.addSolutionUnawareCanvasAppsRequest(t)),addSolutionUnawareFlowsRequest:t=>e(s.solutionComponentsActions.addSolutionUnawareFlowsRequest(t)),addSolutionUnawareCustomConnectorsRequest:t=>e(s.solutionComponentsActions.addSolutionUnawareCustomConnectorsRequest(t)),addSolutionUnawareDataflowsRequest:t=>e(s.solutionComponentsActions.addSolutionUnawareDataflowsRequest(t)),addSolutionUnawarePowerBIReportsRequest:t=>e(s.solutionComponentsActions.addSolutionUnawarePowerBIArtifactsRequest(t)),addSolutionUnawarePowerBIDatasetsRequest:t=>e(s.solutionComponentsActions.addSolutionUnawarePowerBIArtifactsRequest(t)),addSolutionComponentsClearResponse:()=>e(s.solutionComponentsActions.addSolutionComponentsClear()),openAddSubcomponentsPanel:(t,n,o,r)=>new Promise(i=>{e(p.sharedActions.panelOpen({panelType:a.PanelToShowType.AddSubcomponentsPanel,panelProps:{solutionId:t,componentName:n,componentDisplayName:o,onSelectionConfirmed:i,existingSelection:r}}))}),dispatchTelemetry:e,addEnvironmentVariableRequest:t=>{e(O.envVariableActions.addEnvironmentVariablesRequest(t))},fetchEnvironmentVariable:()=>e(Object(h.fetchEnvironmentVariableData)({}))}),w=(e,t,n)=>{var{solutionId:o,componentType:a,defaultPanelProps:i,settingsNotInSolution:s}=n,{openAddSubcomponentsPanel:l}=t,c=null==s?void 0:s.map(e=>({msdyn_name:e.name,msdyn_displayname:e.displayName,msdyn_objectid:e.objectId,msdyn_componenttype:e.componentType,msdyn_componenttypename:e.componentTypeName,msdyn_componentlogicalname:e.componentLogicalName,msdyn_ismanaged:e.isManaged,msdyn_ismanagedname:e.isManagedName,msdyn_iscustomizable:e.isCustomizable,msdyn_iscustomizablename:e.isCustomizablename,msdyn_description:e.description,msdyn_objecttypecode:e.objectTypeCode,msdyn_typename:e.typeName,msdyn_status:e.status,msdyn_statusname:e.statusName,msdyn_modifiedon:e.modifiedOn,msdyn_owner:e.owner,msdyn_version:e.version,msdyn_eventhandler:e.eventHandler,msdyn_deployment:e.deployment,msdyn_sdkmessagename:e.sdkMessage,msdyn_uniquename:e.uniqueName}));return j(j({},e),{},{defaultPanelProps:i,componentType:a,solutionId:o,inputSolutionComponents:c,onPanelClose:t.onPanelClose,onMount:()=>{e.selectedSolution||t.fetchSolutionsRequest()},addSolutionComponentsClearResponse:t.addSolutionComponentsClearResponse,onSaveClick:n=>{n.solutionUnawareCanvasApps?t.addSolutionUnawareCanvasAppsRequest({solutionId:o,canvasApps:n.solutionUnawareCanvasApps}):n.solutionUnawareFlows?t.addSolutionUnawareFlowsRequest({solutionId:o,flows:n.solutionUnawareFlows}):n.solutionUnawareDataflows?t.addSolutionUnawareDataflowsRequest({solutionId:o,dataflows:n.solutionUnawareDataflows}):n.solutionUnawareCustomConnectors?t.addSolutionUnawareCustomConnectorsRequest({apisToMigrate:n.solutionUnawareCustomConnectors.map(e=>e.name),solutionId:o}):n.componentsWithSubcomponents?t.addSolutionComponentsRequest({solutionName:Object(r.getSolutionName)(e.selectedSolution),solutionId:o,componentType:a,componentsWithSubcomponents:n.componentsWithSubcomponents}):n.environmentVariables?t.addEnvironmentVariableRequest({solutionName:Object(r.getSolutionName)(e.selectedSolution),solutionId:o,environmentVariables:n.environmentVariables}):n.solutionUnawarePowerBIReports?t.addSolutionUnawarePowerBIReportsRequest({solutionUniqueName:Object(r.getSolutionName)(e.selectedSolution),artifacts:n.solutionUnawarePowerBIReports,artifactsType:P.PowerBIArtifactSolutionComponentTypes.PowerBIReport,publisher:Object(r.getSolutionPublisher)(e.selectedSolution),solutionId:o}):n.solutionUnawarePowerBIDatasets&&t.addSolutionUnawarePowerBIDatasetsRequest({solutionUniqueName:Object(r.getSolutionName)(e.selectedSolution),artifacts:n.solutionUnawarePowerBIDatasets,artifactsType:P.PowerBIArtifactSolutionComponentTypes.PowerBIDataset,publisher:Object(r.getSolutionPublisher)(e.selectedSolution),solutionId:o})},dispatchTelemetry:t.dispatchTelemetry,openAddSubcomponentsPanel:l,environment:n.rootProps.currentEnvironment,fetchEnvironmentVariable:t.fetchEnvironmentVariable,customComponentDefinitions:n.customComponentDefinitions})},D=Object(v.withCustomComponentTypeCodes)(Object(m.withRootProps)(Object(E.withSettingsNotInSolution)(Object(o.connect)(R,I,w)(d.SolutionComponentAddExistingPanel))))},6605:function(e,t,n){"use strict";n.r(t),n.d(t,"SolutionComponentAddExistingPanel",(function(){return L}));var o=n(6464),r=n(4013),a=n(2867),i=n(1697),s=n(1573),l=n(1201),c=n(245),p=n(5675),u=n(5607),d=n(3713),m=n(5629),b=n(2869),g=n(2880),y=n(5627),S=n(6606),f=n(6611),h=n(5793),O=n(6613),C=n(6620),v=n(5604),P=n(5609),E=n(5611),T=n(5612),j=n(2812),A=n(3716),R=n(6621);function I(){return(I=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function D(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(Object(n),!0).forEach((function(t){N(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function N(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class L extends c.Component{static getDerivedStateFromProps(e,t){return t.componentTypeFromProp!==e.componentType?{componentTypeFromProp:e.componentType,componentType:e.componentType}:null}constructor(e){super(e),this.resources=void 0,this.onComponentSelectionChanged=()=>{var e,t=null===(e=this.state.currentSelectedItems)||void 0===e?void 0:e.map(e=>e.component),n=this.state.subcomponentSelection.withMutations(e=>{(t||[]).forEach(t=>{var n=Object(d.getSolutionComponentObjectId)(t);e.has(n)||e.set(n,Object(h.createSelectionsForSubcomponentTypes)())})});this.setState({subcomponentSelection:n})},this.isSaveDisabledForSettings=()=>Object(A.isComponentTypePowerSetting)(this.state.componentType)&&this.state.currentSelectedItems.some(e=>void 0===e.includeDefinition),this.onSave=()=>{if(this.getSolutionAwareness()===y.SolutionAwareness.NotInAnySolution)Object(P.areSameSolutionComponentType)(this.state.componentType,E.StandardSolutionComponentTypes.Flow)?this.props.onSaveClick({solutionUnawareFlows:Object(y.getObjectFromList)(this.state.currentSelectedItems)}):Object(P.areSameSolutionComponentType)(this.state.componentType,E.StandardSolutionComponentTypes.Dataflow)?this.props.onSaveClick({solutionUnawareDataflows:Object(y.getObjectFromList)(this.state.currentSelectedItems)}):Object(P.areSameSolutionComponentType)(this.state.componentType,E.StandardSolutionComponentTypes.Connector)?this.props.onSaveClick({solutionUnawareCustomConnectors:Object(y.getObjectFromList)(this.state.currentSelectedItems)}):Object(P.isKnownCustomSolutionComponentType)(this.state.componentType)&&Object(T.knownCustomSolutionComponentTypeCustomGetSaveProps)(this.state.componentType.logicalName,this.state)?this.props.onSaveClick(Object(T.knownCustomSolutionComponentTypeCustomGetSaveProps)(this.state.componentType.logicalName,this.state)):this.props.onSaveClick({solutionUnawareCanvasApps:Object(y.getObjectFromList)(this.state.currentSelectedItems)});else if(Object(A.isComponentTypePowerSetting)(this.state.componentType)){var e,t,n=[...null===(e=this.state.currentSelectedItems)||void 0===e?void 0:e.filter(e=>e.includeDefinition).map(e=>D(D({},e),{},{component:D(D({},e.component),{},{msdyn_componenttype:e.definitionTypeCode})})),...null===(t=this.state.currentSelectedItems)||void 0===t?void 0:t.filter(e=>e.includeOrgOverride).map(e=>D(D({},e),{},{component:D(D({},e.component),{},{msdyn_objectid:e.orgOverrideId,msdyn_componenttype:e.orgOverrideTypeCode})}))].map(e=>D(D({},e),{},{includeEntityMetadata:!1,includeSubcomponents:!1,subcomponents:[]}));this.props.onSaveClick({componentsWithSubcomponents:n})}else if(Object(P.areSameSolutionComponentType)(this.state.componentType,E.StandardSolutionComponentTypes.EnvironmentVariableDefinition)){var o;this.props.onSaveClick({environmentVariables:null===(o=this.state.currentSelectedItems)||void 0===o?void 0:o.map(e=>{var t=e.component,n=Object(d.getSolutionComponentObjectId)(t),o=!0,r=!0;return Object(P.areSameSolutionComponentType)(this.state.componentType,E.StandardSolutionComponentTypes.EnvironmentVariableDefinition)&&(o=this.state.componentsExcludingDefinition.includes(n),r=this.state.componentsExcludingCurrentValue.includes(n)),{component:t,excludeDefinition:o,excludeCurrentValue:r}})})}else{var r;this.props.onSaveClick({componentsWithSubcomponents:null===(r=this.state.currentSelectedItems)||void 0===r?void 0:r.map(e=>{var t=e.component,n=Object(d.getSolutionComponentObjectId)(t),o=Object(h.getAllSubcomponentListItems)(this.state.subcomponentSelection.get(n)),r=!0,a=!1;return Object(P.areSameSolutionComponentType)(this.state.componentType,E.StandardSolutionComponentTypes.Entity)&&(r=this.state.componentsIncludingAll.includes(n),a=this.state.componentsIncludingMetadata.includes(n)),{component:t,subcomponents:o,includeSubcomponents:r,includeEntityMetadata:a}})})}},this.onDismiss=e=>{this.props.onPanelClose(e),this.props.addSolutionComponentsClearResponse()},this.onSearchFilterUpdate=e=>{this.setState({searchFilter:e})},this.setPanelOpenIndex=e=>{this.state.panelOpenIndex!==e&&this.setState({panelOpenIndex:e})},this.onToggleIncludeAllSubcomponents=e=>{var t;this.setState({componentsIncludingAll:this.state.componentsIncludingAll.withMutations(n=>{n.includes(e)?(n.delete(e),t=!1):(n.add(e),t=!0)}),componentsIncludingMetadata:this.state.componentsIncludingMetadata.withMutations(n=>{!t&&n.includes(e)?n.delete(e):n.add(e)})})},this.onToggleIncludeEntityMetadata=e=>{this.setState({componentsIncludingMetadata:this.state.componentsIncludingMetadata.withMutations(t=>{t.includes(e)?t.delete(e):t.add(e)})})},this.onToggleExcludeDefinition=e=>{this.setState({componentsExcludingDefinition:this.state.componentsExcludingDefinition.withMutations(t=>{t.includes(e)?t.delete(e):(t.add(e),this.state.componentsExcludingCurrentValue.includes(e)&&this.onToggleExcludeCurrentValue(e))})})},this.onToggleExcludeCurrentValue=e=>{this.setState({componentsExcludingCurrentValue:this.state.componentsExcludingCurrentValue.withMutations(t=>{t.includes(e)?t.delete(e):(t.add(e),this.state.componentsExcludingDefinition.includes(e)&&this.onToggleExcludeDefinition(e))})})},this.onSolutionAwarePivotClicked=e=>{this.props.addSolutionComponentsClearResponse(),this.setState({isSolutionAware:e})},this.getSolutionAwareness=()=>Object(P.areSameSolutionComponentType)(this.state.componentType,E.StandardSolutionComponentTypes.CanvasApp)||Object(P.areSameSolutionComponentType)(this.state.componentType,E.StandardSolutionComponentTypes.CanvasAppsOnly)||Object(P.areSameSolutionComponentType)(this.state.componentType,E.StandardSolutionComponentTypes.CustomCanvasPage)||Object(P.areSameSolutionComponentType)(this.state.componentType,E.StandardSolutionComponentTypes.ComponentLibrary)||Object(P.areSameSolutionComponentType)(this.state.componentType,E.StandardSolutionComponentTypes.Flow)||Object(P.areSameSolutionComponentType)(this.state.componentType,E.StandardSolutionComponentTypes.UIFlow)||Object(P.areSameSolutionComponentType)(this.state.componentType,E.StandardSolutionComponentTypes.Dataflow)||Object(P.areSameSolutionComponentType)(this.state.componentType,E.StandardSolutionComponentTypes.Connector)?this.state.isSolutionAware?y.SolutionAwareness.NotInSolution:y.SolutionAwareness.NotInAnySolution:Object(P.isKnownCustomSolutionComponentType)(this.state.componentType)&&Object(T.knownCustomSolutionComponentTypeCustomSolutionAwareness)(this.state.componentType.logicalName,this.state.isSolutionAware)?Object(T.knownCustomSolutionComponentTypeCustomSolutionAwareness)(this.state.componentType.logicalName,this.state.isSolutionAware):y.SolutionAwareness.NotInSolution,this.resources=Object(b.getResources)(),this.state={currentSelectedItems:[],drilledInComponent:null,searchFilter:"",searchFilterForSubcomponents:"",selectedSubcomponentTypeOnPivot:"fields",componentType:this.props.componentType,componentTypeFromProp:this.props.componentType,panelOpenIndex:0,subcomponentSelection:Object(a.Map)(),componentsIncludingAll:Object(a.Set)(),componentsIncludingMetadata:Object(a.Set)(),isSolutionAware:!0,includeRequiredComponents:!0,componentsExcludingDefinition:Object(a.Set)(),componentsExcludingCurrentValue:Object(a.Set)()}}componentDidMount(){this.props.onMount(),Object(P.areSameSolutionComponentType)(this.props.componentType,E.StandardSolutionComponentTypes.EnvironmentVariableDefinition)&&Object(p.shouldShowEnvironmentVariables)(Object(v.getCrmVersion)(this.props.environment))&&this.props.fetchEnvironmentVariable()}componentDidUpdate(e,t){Object(j.isEqual)(t.currentSelectedItems,this.state.currentSelectedItems)||this.onComponentSelectionChanged()}render(){var e,t,n=Object(d.isCdsLiteContext)(this.props.environment);this.props.addSolutionComponentsResponse.loading||Object(m.getTotalLoadingState)(this.props.loadProgress)===m.ComponentLoadState.Loading?e={spinnerProps:{size:l.SpinnerSize.large,label:this.resources.Model.Solutions.Components.AddExistingPanel.inProgress}}:this.props.addSolutionComponentsResponse.failed&&this.props.addSolutionComponentsResponse.message?t={messageBarProps:{messageBarType:i.MessageBarType.error,dismissButtonAriaLabel:this.resources.Common.close,isMultiline:!1,truncated:!0},onRenderBody:()=>c.createElement(c.Fragment,null,this.props.addSolutionComponentsResponse.message)}:this.props.addSolutionComponentsResponse.success&&this.onDismiss(!0);var a={hasCloseButton:!0,closeButtonType:r.PanelCloseButtonType.Back,closeButtonAriaLabel:this.resources.Common.close,type:s.PanelType.large,loadingOverlay:e,messageBar:t},p=[this.getMainPanel(a,n)];return(Object(A.isComponentTypePowerSetting)(this.state.componentType)||Object(P.areSameSolutionComponentType)(this.state.componentType,E.StandardSolutionComponentTypes.Entity)||Object(P.areSameSolutionComponentType)(this.state.componentType,E.StandardSolutionComponentTypes.EnvironmentVariableDefinition))&&p.push(this.getSubcomponentsOverviewPanel(a,n)),c.createElement(o.MultistepPanel,I({customWidth:void 0,dismissDialog:void 0,dismissOnEscape:void 0,isBlocking:!this.props.isAddSubcomponentsPanelOpen,isHiddenOnDismiss:!0,onDismissed:void 0,onLightDismissClick:void 0,showDismissDialog:void 0,isLightDismiss:!1,onOuterClick:void 0,isOpen:void 0},this.props.defaultPanelProps,{onDismiss:()=>{this.onDismiss(!1)},panelsListProps:p,panelOpenIndex:this.state.panelOpenIndex,setPanelOpenIndex:this.setPanelOpenIndex}))}setComponentType(e){this.props.addSolutionComponentsClearResponse(),this.setState({componentType:e,currentSelectedItems:[]})}onReceiveSubcomponentSelection(e,t){t&&this.setState({subcomponentSelection:this.state.subcomponentSelection.set(e,t)})}getMainPanel(e,t){var n=c.createElement(O.SolutionComponentsAddExistingListContainer,{componentTypes:[this.state.componentType],searchFilter:this.state.searchFilter,solution:this.props.selectedSolution,solutionId:this.props.solutionId,solutionAwareness:this.getSolutionAwareness(),listHeaderPadding:1,customComponentDefinitions:this.props.customComponentDefinitions,currentSelectedItems:this.state.currentSelectedItems,updateComponentsListItemsSelected:e=>{this.setState({currentSelectedItems:e})},inputSolutionComponents:this.props.inputSolutionComponents});return D(D({},e),{},{headerText:Object(g.formatResourceString)(this.resources.Model.Solutions.Components.AddExistingPanel.title,Object(P.getTypeStringFromSolutionComponentType)(this.state.componentType,!0,!0)),onRenderSubHeader:()=>{var e;return c.createElement(S.SolutionComponentAddExistingPanelHeader,{numSelected:null===(e=this.state.currentSelectedItems)||void 0===e?void 0:e.length,componentType:this.state.componentType,searchFilter:this.state.searchFilter,isSolutionAware:this.state.isSolutionAware,hasUnsupportedComponents:this.props.hasUnsupportedComponents,onSearchFilterUpdate:this.onSearchFilterUpdate,onComponentTypeChange:this.setComponentType.bind(this),onPivotClicked:this.onSolutionAwarePivotClicked,isCustomerServiceAppInstalled:this.props.isCustomerServiceAppInstalled,isDualWriteCoreSolutionInstalled:this.props.isDualWriteCoreSolutionInstalled,isCustomConnectorSupported:this.props.isCustomConnectorSupported,isComponentLibrariesSupported:this.props.isComponentLibrariesSupported,environment:this.props.environment,customComponentDefinitions:this.props.customComponentDefinitions})},children:n,footerButtons:[Object(A.isComponentTypePowerSetting)(this.state.componentType)||Object(P.areSameSolutionComponentType)(this.state.componentType,E.StandardSolutionComponentTypes.Entity)||Object(P.areSameSolutionComponentType)(this.state.componentType,E.StandardSolutionComponentTypes.EnvironmentVariableDefinition)?{primary:!0,navigateableOnClick:e=>e+1,disabled:0===this.state.currentSelectedItems.length||this.props.addSolutionComponentsResponse.loading,ariaLabel:this.resources.Common.next,text:this.resources.Common.next}:{primary:!0,ariaLabel:this.resources.Common.add,text:this.resources.Common.add,disabled:0===this.state.currentSelectedItems.length||this.props.addSolutionComponentsResponse.loading,navigateableOnClick:e=>(this.onSave(),e)},{ariaLabel:this.resources.Common.Save.cancel,text:this.resources.Common.Save.cancel,navigateableOnClick:e=>(this.onDismiss(!1),e-1)}]})}getSubcomponentsOverviewPanel(e,t){var n;if(Object(A.isComponentTypePowerSetting)(this.state.componentType)){var o=this.state.currentSelectedItems.map(e=>D(D({},e),{},{settingName:e.component.msdyn_uniquename,displayName:e.component.msdyn_displayname}));n=this.props.selectedSolution?c.createElement(R.DefinitionsOrOverridesList,{solutionUniqueName:this.props.selectedSolution.uniquename,settings:o,removeItem:this.removeCurrentSelectedItems.bind(this),onSettingItemsChange:e=>{this.setState({currentSelectedItems:e})}}):c.createElement(c.Fragment,null)}else n=Object(P.areSameSolutionComponentType)(this.state.componentType,E.StandardSolutionComponentTypes.EnvironmentVariableDefinition)?c.createElement(C.EnvironmentVariableAddExistingPanelSelectedList,{currentSelectedItems:this.state.currentSelectedItems,removeCurrentSelectedItems:this.removeCurrentSelectedItems.bind(this),componentsExcludingDefinition:this.state.componentsExcludingDefinition,componentsExcludingCurrentValue:this.state.componentsExcludingCurrentValue,onToggleExcludeDefinition:this.onToggleExcludeDefinition,onToggleExcludeCurrentValue:this.onToggleExcludeCurrentValue,useCdsLiteUX:t}):c.createElement(f.SolutionComponentAddExistingPanelSelectedList,{currentSelectedItems:this.state.currentSelectedItems,removeCurrentSelectedItems:this.removeCurrentSelectedItems.bind(this),subcomponentSelection:this.state.subcomponentSelection,componentsIncludingAll:this.state.componentsIncludingAll,componentsIncludingMetadata:this.state.componentsIncludingMetadata,componentType:this.state.componentType,onSelectComponentsClick:e=>{this.setState({drilledInComponent:e.component});var t=Object(d.getSolutionComponentObjectId)(e.component);this.props.openAddSubcomponentsPanel(this.props.selectedSolution.id,Object(u.getSolutionComponentName)(e.component),Object(u.getSolutionComponentDisplayName)(e.component),this.state.subcomponentSelection.get(t)).then(e=>{this.onReceiveSubcomponentSelection(t,e)})},onToggleIncludeAllSubcomponents:this.onToggleIncludeAllSubcomponents,onToggleIncludeEntityMetadata:this.onToggleIncludeEntityMetadata,useCdsLiteUX:Object(d.isCdsLiteContext)(this.props.environment)});return D(D({},e),{},{headerText:Object(g.formatResourceString)(this.resources.Model.Solutions.Components.AddExistingPanel.SelectedComponents.title,Object(P.getTypeStringFromSolutionComponentType)(this.state.componentType,!0,!0)),headerLeftButtonProps:{ariaLabel:this.resources.ImportExport.Export.Back.Button.label,onClick:()=>this.setPanelOpenIndex(this.state.panelOpenIndex-1)},onRenderSubHeader:()=>c.createElement(c.Fragment,null,Object(g.formatResourceString)(this.resources.Model.Solutions.Components.AddExistingPanel.SelectedComponents.subtitle,Object(P.getTypeStringFromSolutionComponentType)(this.state.componentType,!0,!0))),children:n,footerButtons:[{primary:!0,navigateableOnClick:e=>(this.onSave(),e-1),ariaLabel:this.resources.Common.add,text:this.resources.Common.add,disabled:0===this.state.currentSelectedItems.length||this.isSaveDisabledForSettings()},{navigateableOnClick:e=>(this.onDismiss(!1),e-1),ariaLabel:this.resources.Common.Save.cancel,text:this.resources.Common.Save.cancel,disabled:0===this.state.currentSelectedItems.length}]})}removeCurrentSelectedItems(e){var t,n=(null===(t=this.state.currentSelectedItems)||void 0===t?void 0:t.filter(t=>t.key!==e))||[];this.setState({currentSelectedItems:n})}}},6606:function(e,t,n){"use strict";n.r(t),n.d(t,"SolutionComponentAddExistingPanelHeader",(function(){return v}));var o=n(1709),r=n(1252),a=n(1697),i=n(1090),s=n(245),l=n(5608),c=n(2869),p=n(2880),u=n(2871),d=n(6607),m=n(5481),b=n(6610),g=n(5609),y=n(5611),S=n(5610),f=n(5612),h=n(3713),O=n(5705);function C(){return(C=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}class v extends s.Component{constructor(e){super(e),this.resources=void 0,this.getPivots=()=>u.featureGates.addExistingSolutionUnawareCanvasApps&&(Object(g.isStandardSolutionComponentType)(this.props.componentType)&&Object(S.canStandardComponentTypeBeMadeSolutionAware)(this.props.componentType)||Object(g.isKnownCustomSolutionComponentType)(this.props.componentType)&&Object(f.knownCustomSolutionComponentTypeCanBeMadeSolutionAware)(this.props.componentType.logicalName))?s.createElement(o.Pivot,{selectedKey:this.props.isSolutionAware?l.SolutionAware.Aware:l.SolutionAware.Unaware,onLinkClick:e=>this.props.onPivotClicked(e.props.itemKey===l.SolutionAware.Aware)},s.createElement(o.PivotItem,{key:l.SolutionAware.Aware,itemKey:l.SolutionAware.Aware,linkText:this.resources.Model.Solutions.Components.AddExistingPanel.fromDataverse}),s.createElement(o.PivotItem,{key:l.SolutionAware.Unaware,itemKey:l.SolutionAware.Unaware,linkText:this.resources.Model.Solutions.Components.AddExistingPanel.outsideDataverse})):null,this.resources=Object(c.getResources)(),this.state={}}render(){var e=Object(h.isCdsLiteContext)(this.props.environment),t=s.createElement("div",{className:"subheader-number-selected"},this.getNumSelectedString(e)),n=Object(d.getSearchBoxProps)(this.props.onSearchFilterUpdate,Object(p.formatResourceString)(this.resources.Model.Solutions.Components.search,Object(g.getTypeStringFromSolutionComponentType)(this.props.componentType,!0,!0)),this.props.searchFilter);return s.createElement("div",{className:b.solutionComponentAddExistingPanelHeaderStyleClasses.solutionComponentsAddexistingSubheader},Object(p.formatResourceString)(this.resources.Model.Solutions.Components.AddExistingPanel.subtitle,Object(g.getTypeStringFromSolutionComponentType)(this.props.componentType,!0,!0)),this.renderSolutionComponentTypeWarning([y.StandardSolutionComponentTypes.CanvasApp,y.StandardSolutionComponentTypes.CanvasAppsOnly],this.resources.Model.Solutions.Components.AddExistingPanel.SolutionizingCanvasApps.sharedWarning),this.renderSolutionComponentTypeWarning([y.StandardSolutionComponentTypes.ComponentLibrary],this.resources.Model.Solutions.Components.AddExistingPanel.SolutionizingCanvasApps.componentLibraryWarning),Object(g.areSameSolutionComponentType)(this.props.componentType,y.StandardSolutionComponentTypes.Flow)&&!this.props.isSolutionAware&&this.props.hasUnsupportedComponents&&this.renderMessageBar(this.resources.Model.Solutions.Components.AddExistingPanel.SolutionizingFlows.message,m.default.migrationLimitations),Object(g.isKnownCustomSolutionComponentType)(this.props.componentType)&&this.props.componentType.logicalName===O.powerBIReportKnownCustomSolutionComponentType.logicalName&&!this.props.isSolutionAware&&this.renderMessageBar(this.resources.Model.Solutions.Components.AddExistingPanel.SolutionizingPowerBIReports.message),s.createElement("div",{className:"subheader-commandbar"},t,s.createElement("div",{className:"subheader-right-section"},s.createElement(r.SearchBox,C({className:"subheader-search-box"},n)))),this.getPivots())}renderSolutionComponentTypeWarning(e,t){return e.some(e=>Object(g.areSameSolutionComponentType)(this.props.componentType,e))&&!this.props.isSolutionAware&&this.renderMessageBar(t,m.default.migrationLimitations)}renderMessageBar(e,t){return s.createElement(a.MessageBar,{messageBarType:a.MessageBarType.info,isMultiline:!1,dismissButtonAriaLabel:this.resources.Common.close},e,t&&s.createElement(i.Link,{href:t,target:"_blank"},this.resources.Common.learnMore))}getNumSelectedString(e){return 0===this.props.numSelected?e?Object(g.getTypeStringFromSolutionComponentType)(this.props.componentType,e,!0):"":1===this.props.numSelected?Object(p.formatResourceString)(this.resources.Model.Solutions.Components.selected,this.props.numSelected,Object(g.getTypeStringFromSolutionComponentType)(this.props.componentType,!1,!0)):Object(p.formatResourceString)(this.resources.Model.Solutions.Components.selected,this.props.numSelected,Object(g.getTypeStringFromSolutionComponentType)(this.props.componentType,!0,!0))}}},6607:function(e,t,n){"use strict";n.r(t),n.d(t,"getSearchBoxProps",(function(){return a}));var o=n(6608),r=n(2869);function a(e,t,n,a){var i=Object(r.getResources)();return Object(o.getSearchBoxProps)(e,i.Controllers.SearchBox.placeholder,a||i.Controllers.SearchBox.arialabel,i.Controllers.SearchBox.ClearButton.arialabel,t,n)}},6608:function(e,t,n){"use strict";n.r(t),n.d(t,"getSearchBoxProps",(function(){return s}));var o=n(6609),r=n(2699);function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t,n,s,l,c,p){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({placeholder:l||t,ariaLabel:l||n,clearButtonProps:{ariaLabel:s,title:s},onChangeDelay:r.featureGates.deboundSearchboxTyping?o.uiInteractionDebounceTime:void 0,onChange:(t,n)=>e(n||"")},p?{defaultValue:c}:{value:c})}},6609:function(e,t,n){"use strict";n.r(t),n.d(t,"uiInteractionDebounceTime",(function(){return o}));var o=500},6610:function(e,t,n){"use strict";n.r(t),n.d(t,"solutionComponentAddExistingPanelHeaderStyleClasses",(function(){return a}));var o=n(719),r=n(5492),a=Object(o.mergeStyleSets)({solutionComponentsAddexistingSubheader:["solution-components-addexisting-subheader",{display:"flex",flexDirection:"column",marginTop:"8px",selectors:{".subheader-warning-message":{fontWeight:"bold",fontStyle:"italic"},".subheader-commandbar":{display:"flex",justifyContent:"space-between",alignItems:"center",paddingTop:"10px",selectors:{".subheader-number-selected":{fontFamily:r.fonts.segoeUi,fontWeight:"600"}," .subheader-right-section":{display:"flex",selectors:{".subheader-filter-button":{fontFamily:r.fonts.segoeUi,height:"32px"},".subheader-search-box":{width:"172px"}}}}}}}]})},6611:function(e,t,n){"use strict";n.r(t),n.d(t,"SolutionComponentAddExistingPanelSelectedList",(function(){return P}));var o=n(3064),r=n(2812),a=n(1362),i=n(1471),s=n(684),l=n(1090),c=n(1473),p=n(245),u=n(5607),d=n(3713),m=n(5617),b=n(2879),g=n(2869),y=n(2880),S=n(5793),f=n(6612),h=n(5609);function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function C(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach((function(t){v(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class P extends p.Component{constructor(e){super(e),this.resources=void 0,this.columns=void 0,this.resources=Object(g.getResources)(),this.state={},this.columns=this.buildColumns()}render(){var e=p.createElement(o.DetailsList,{items:this.buildListItems(),columns:this.columns,selectionMode:c.SelectionMode.none,constrainMode:i.ConstrainMode.unconstrained,layoutMode:i.DetailsListLayoutMode.justified,isHeaderVisible:!1});return p.createElement("div",{className:f.solutionComponentsSelectedListStyleClasses.solutionComponentsSelectedList},p.createElement("div",{className:"selected-list-subheader"},Object(y.formatResourceString)(this.resources.Model.Solutions.Components.AddExistingPanel.SelectedComponents.addMessage,this.props.currentSelectedItems.length,Object(h.getTypeStringFromSolutionComponentType)(this.props.componentType,!0,!0))),e)}buildListItems(){var e;return null===(e=this.props.currentSelectedItems)||void 0===e?void 0:e.map(e=>{var t=e.component,n=Object(d.getSolutionComponentObjectId)(t);return{key:n,displayName:Object(u.getSolutionComponentDisplayName)(t),component:t,subcomponents:this.props.subcomponentSelection.get(n),allComponentsIncluded:this.props.componentsIncludingAll.includes(n),metadataIncluded:this.props.componentsIncludingMetadata.includes(n)}})}buildColumns(){var e={fieldName:"",name:""},t={text:{fontWeight:"400"}};return[C(C({},e),{},{key:"selectedComponentOverview",minWidth:400,onRender:e=>{var t;return t=e.allComponentsIncluded?this.resources.Model.Solutions.Components.AddExistingPanel.SelectedComponents.allSelected:r.isEmpty(Object(S.getAllSubcomponentListItems)(e.subcomponents))?this.resources.Model.Solutions.Components.AddExistingPanel.SelectedComponents.noneSelected:Object(y.formatResourceString)(this.resources.Model.Solutions.Components.AddExistingPanel.SelectedComponents.severalSelected,e.subcomponents.map((e,t)=>{var n=e.getSelectedCount();return n>0&&Object(y.formatResourceString)(this.resources.Model.Solutions.Components.AddExistingPanel.SelectedComponents.subcomponentCount,e.getSelectedCount(),Object(S.getSubcomponentTypeString)(t,this.props.useCdsLiteUX,n>1).toLowerCase())}).filter(e=>!!e).join(", ")),p.createElement("div",{className:"selected-list-component-overview"},p.createElement("div",{className:"selected-list-component-name"},e.displayName),p.createElement("div",{className:"selected-list-subcomponents-count"},t),p.createElement(l.Link,{onClick:()=>{this.props.onSelectComponentsClick(e)},style:{color:m.fabricTheme.palette.purple},disabled:e.allComponentsIncluded},this.resources.Model.Solutions.Components.AddExistingPanel.SelectedComponents.selectComponents))}}),C(C({},e),{},{key:"includeAllComponentsToggle",minWidth:200,onRender:e=>p.createElement(a.Checkbox,{label:this.resources.Model.Solutions.Components.AddExistingPanel.SelectedComponents.includeAllComponents,onChange:()=>this.props.onToggleIncludeAllSubcomponents(Object(d.getSolutionComponentObjectId)(e.component)),checked:!!e.allComponentsIncluded,styles:t})}),C(C({},e),{},{key:"includeEntityMetadataToggle",minWidth:200,onRender:e=>p.createElement(a.Checkbox,{label:this.resources.Model.Solutions.Components.AddExistingPanel.SelectedComponents.includeEntityMetadata,onChange:()=>this.props.onToggleIncludeEntityMetadata(Object(d.getSolutionComponentObjectId)(e.component)),checked:!!e.metadataIncluded,disabled:e.allComponentsIncluded,styles:t})}),C(C({},e),{},{key:"removeComponent",minWidth:40,onRender:e=>p.createElement(s.IconButton,{iconProps:{iconName:b.fabricIcons.Cancel},onClick:()=>{this.props.removeCurrentSelectedItems(null==e?void 0:e.key)},ariaLabel:b.fabricIcons.Cancel})})]}}},6612:function(e,t,n){"use strict";n.r(t),n.d(t,"solutionComponentsSelectedListStyleClasses",(function(){return i}));var o=n(719),r=n(5492),a=n(2882),i=Object(o.mergeStyleSets)({solutionComponentsSelectedList:["solution-components-selected-list",{selectors:{".selected-list-subheader":{fontFamily:r.fonts.segoeUi,fontWeight:"600",height:"32px"},".selected-list-component-overview":{display:"inline-block",selectors:{".selected-list-component-name":{fontSize:"14px",color:a.fabricColors.black,marginBottom:"4px"},".selected-list-subcomponents-count":{marginBottom:"2px"}}}}}]})},6613:function(e,t,n){"use strict";n.r(t),n.d(t,"SolutionComponentsAddExistingListContainer",(function(){return i}));var o=n(6614),r=n(5627),a=n(5669),i=Object(o.withSolutionComponentsListBehavior)(r.SolutionComponentsList,a.LoadScenarioNames.SolutionComponentsAddExistingList)},6614:function(e,t,n){"use strict";n.r(t),n.d(t,"createSolutionComponentsListItems",(function(){return oe})),n.d(t,"createSolutionAwareComponentListItem",(function(){return re})),n.d(t,"createSolutionUnawareComponentListItem",(function(){return ae})),n.d(t,"mapStateToProps",(function(){return ie})),n.d(t,"mapDispatchToProps",(function(){return se})),n.d(t,"mergeProps",(function(){return le})),n.d(t,"withSolutionComponentsListBehavior",(function(){return ce}));var o=n(2812),r=n(5437),a=n(5647),i=n(5650),s=n(5487),l=n(5651),c=n(2886),p=n(5607),u=n(3713),d=n(5596),m=n(5629),b=n(2869),g=n(2880),y=n(5470),S=n(5630),f=n(5648),h=n(5653),O=n(5686),C=n(5796),v=n(5808),P=n(5810),E=n(5691),T=n(5474),j=n(5687),A=n(5615),R=n(5685),I=n(6615),w=n(6616),D=n(5689),N=n(5627),L=n(5582),M=n(6617),x=n(5801),k=n(5813),F=n(5675),_=n(5809),U=n(5604),V=n(5626),B=n(6618),H=n(5583),G=n(5698),W=n(5818),q=n(5803),z=n(5609),Q=n(5611),K=n(5612),Y=n(5621),J=n(6619),X=["solutionId","solutionComponents","getObjectFromComponent","solutionComponentsFilterParameterOptions"],Z=["componentTypes","solutionAwareness","rootProps","updateComponentsListItemsSelected","currentSelectedItems"];function $(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function ee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$(Object(n),!0).forEach((function(t){te(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function te(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ne(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var oe=(e,t,n,o,r,a,i)=>e?e.map(e=>{var r;return(r=Object(v.isSolutionAwareComponent)(e)?re(e,n,t,o,a,i):ae(e)).filterOn=[r.displayName,r.systemName,r.typeName,r.managedState,r.isCustomizable],r}):[],re=(e,t,n,o,r,a)=>({key:Object(u.getSolutionComponentId)(e),component:e,componentType:Object(p.getTypeFromSolutionComponent)(e),displayName:Object(p.getSolutionComponentDisplayName)(e),systemName:Object(p.getSolutionComponentName)(e),modified:Object(p.getSolutionComponentModified)(e),typeName:Object(p.getSolutionComponentTypeDisplayName)(e,t),managedState:Object(p.getSolutionComponentManagedName)(e),owner:Object(p.getSolutionComponentOwner)(e),status:Object(p.getSolutionComponentStatusTitle)(e),description:Object(p.getSolutionComponentDescription)(e),isCustomizable:Object(p.getSolutionComponentIsCustomizableName)(e),version:Object(p.getSolutionComponentVersion)(e),sdkMessage:Object(p.getSolutionComponentSdkMessage)(e),eventHandler:Object(p.getSolutionComponentEventHandler)(e),primaryObjectTypeCode:Object(u.getSolutionComponentObjectTypeCode)(e),language:Object(p.getSolutionComponentLanguage)(e),executionMode:Object(p.getSolutionComponentExecutionMode)(e),publicKeyToken:Object(p.getSolutionComponentPublickKeyToken)(e),onItemClick:Object(p.getSolutionComponentIsClickable)(e)?()=>o(e):void 0,object:n(e),extendedDataType:Object(B.getEnvironmentVariableDefinitionDataType)(e),extendedDefaultValue:Object(B.getEnvironmentVariableDefinitionDefaultValue)(e),extendedIsRequired:Object(B.getEnvironmentVariableDefinitionIsRequired)(e),isObjectCheckerRunStarting:Object(p.isComponentInArray)(e,r),isObjectCheckerRunCompleted:Object(p.hasObjectCheckerRunCompleted)(e,a)}),ae=e=>{var t,n,o,r,a,i=Object(b.getResources)();switch(e.type){case"Api":var s=e;t=Object(q.getApiId)(s),n=Object(q.getDisplayName)(s),o=Object(q.getApiSystemName)(s);break;case"IFlow":var l=e;t=Object(k.getFlowId)(l),n=Object(k.getFlowDisplayName)(l),o=Object(k.getFlowName)(l);break;case"IDataflow":var c=e;t=Object(W.getDataflowId)(c),n=Object(W.getDataflowDisplayName)(c),o=Object(W.getDataflowName)(c);break;case"PowerBIReport":case"PowerBIDataset":var p=e;t=Object(J.getPowerBIArtifactId)(p),n=Object(J.getPowerBIArtifactDisplayName)(p),r=Object(J.getPowerBIArtifactOwner)(p),a=Object(J.getPowerBIArtifactLastRefreshTime)(p),o=Object(J.getPowerBIArtifactDisplayName)(p);break;case"ICanvasApp":default:var u=e;t=Object(d.getAppId)(u),n=Object(d.getAppDisplayName)(u),o=Object(d.getAppName)(u)}return{key:t,displayName:n,systemName:o,lastRefreshTime:a,owner:r,componentType:Q.StandardSolutionComponentTypes.CanvasApp,managedState:i.Model.Solutions.Type.unmanaged,modified:null,isCustomizable:null,status:null,description:null,onItemClick:null,component:null,object:e,isObjectCheckerRunStarting:!1,isObjectCheckerRunCompleted:!1}},ie=(e,t)=>{var n,r,a,i,s,l=Object(c.getSolutionId)(t.solution)||t.solutionId,p=Object(L.currentEnvironmentIdSelector)(t),u=t.componentTypes,d=Object(_.isCRMVersionCompatibleForComponentLibraries)(Object(U.getCrmVersion)(t.rootProps.currentEnvironment)),b=t.inputSolutionComponents;if(!b)switch(t.solutionAwareness){case N.SolutionAwareness.NotInSolution:b=P.solutionComponentListNotInSolutionSelector(e,l,p,u[0]),n=P.solutionComponentListNotInSolutionCacheComplete(e,l,p,u[0]),a=(s=P.fetchComponentsNotInSolutionStatus(e)).failed&&s.message,r=s.loading,i=j.SolutionComponentsAddExistingLoadEvents;break;case N.SolutionAwareness.NotInAnySolution:b=P.solutionComponentListNotInAnySolutionSelector(e,p,u[0],d);var g=P.solutionComponentListNotInAnySolutionCachedStatus(e,p);a=P.fetchComponentsNotInAnySolutionError(e,u[0]),n=g===y.CachedStatusType.Done,r=g===y.CachedStatusType.Pending,i=j.SolutionComponentsAddExistingLoadEvents;break;case N.SolutionAwareness.InSolution:default:b=P.solutionComponentListSelector(e,l,t.rootProps.currentEnvironment,u),n=P.isSolutionComponentListCacheComplete(e,l,p,u),a=P.solutionComponentListErrorsSelector(e,l,p,u),r=P.isFetchingSolutionComponent(e,l,p,u),i=j.SolutionComponentsListLoadEvents}var S=P.solutionComponentActions(e),f=P.solutionComponentListSetKey(e),h=P.isAddSubcomponentsInProgress(e),O=Object(V.bapAllowListFeaturesSelector)(e),C=[];return(null==u?void 0:u.length)>0&&Object(z.isKnownCustomSolutionComponentType)(u[0])&&P.solutionComponentListNotInASolutionFilterOptionsSelector(e,p,u[0])&&(C=P.solutionComponentListNotInASolutionFilterOptionsSelector(e,p,u[0]).map(e=>({key:e.id,text:e.name}))),{solutionId:l,solutionComponents:b,errorMessage:a,loadProgress:[Object(m.toLoadingState)((n||Object(o.isEmpty)(b))&&!r&&!h,a)],hasNextLink:t.solutionAwareness===N.SolutionAwareness.NotInSolution?P.hasNextLinkSolutionComponentNotInSolution(e,l,p,u):P.hasNextLinkSolutionComponent(e,l,p,u),logEvent:i,getObjectFromComponent:t=>P.getObjectFromSolutionComponent(e,t),applicableComponentActions:S,setKey:f,isCustomerServiceAppInstalled:Object(E.isCustomerServiceAppInstalled)(e),isDualWriteCoreSolutionInstalled:Object(E.isDualWriteCoreSolutionInstalled)(e,p),isCustomConnectorSupported:Object(F.isCRMVersionCompatibleForCustomConnector)(Object(U.getCrmVersion)(t.rootProps.currentEnvironment)),isComponentLibrariesSupported:d,enableTestStudio:O.enableTestStudio,objectsBeingChecked:P.objectsBeingChecked(e,p),objectCheckerRunsCompleted:P.objectCheckerRunsCompleted(e),solutionComponentsFilterParameterOptions:C}},se=(e,t)=>{var{navigate:n,componentTypes:o,searchFilter:r}=t;return{dispatchListRequest:n=>{switch(t.solutionAwareness){case N.SolutionAwareness.NotInSolution:e(Object(O.fetchSolutionComponentsNotInSolutionRequest)({solutionId:n,componentTypes:o,applyCustomizationFilter:Object(A.isCustomizationFilterApplicable)(o[0])}));break;case N.SolutionAwareness.NotInAnySolution:if(o&&(Object(z.areSameSolutionComponentType)(o[0],Q.StandardSolutionComponentTypes.Flow)||Object(z.areSameSolutionComponentType)(o[0],Q.StandardSolutionComponentTypes.UIFlow)))e(Object(x.fetchFlowsRequest)({flowType:x.FlowType.personal})),e(Object(x.fetchFlowsRequest)({flowType:x.FlowType.team}));else if(o&&Object(z.areSameSolutionComponentType)(o[0],Q.StandardSolutionComponentTypes.Dataflow))G.fetchDataflowsRequests.forEach(e);else if(o&&Object(z.areSameSolutionComponentType)(o[0],Q.StandardSolutionComponentTypes.Connector))e(Object(C.fetchApisRequest)({requestOptions:{additionalFilters:["IsCustomApi eq 'True'"]}}));else if(o&&Object(z.areSameSolutionComponentType)(o[0],Q.StandardSolutionComponentTypes.ComponentLibrary))e(Object(f.fetchComponentLibrariesRequest)({forceRefresh:!0}));else if(o&&Object(z.isKnownCustomSolutionComponentType)(o[0])&&Object(K.knownCustomSolutionComponentTypeNotInAnySolutionListDispatchRequests)(o[0].logicalName)){Object(K.knownCustomSolutionComponentTypeNotInAnySolutionListDispatchRequests)(o[0].logicalName).forEach(e)}else e(Object(f.fetchAppsRequest)({appsListFilter:d.AppListType.SolutionUnaware,forceRefresh:!0}));break;case N.SolutionAwareness.InSolution:default:e(Object(O.fetchSolutionComponentsRequest)({solutionId:n,componentTypes:o,searchFilter:r}))}},dispatchListRequestForSorting:(n,a,i,s)=>{t.solutionAwareness===N.SolutionAwareness.NotInSolution?e(Object(O.fetchSolutionComponentsNotInSolutionRequest)({solutionId:n,orderBy:a,componentTypes:o,searchFilter:r,applyCustomizationFilter:Object(A.isCustomizationFilterApplicable)(o[0])})):t.solutionAwareness===N.SolutionAwareness.InSolution&&e(i?Object(O.orderSolutionComponents)({solutionId:n,orderBy:a,componentTypes:o,searchFilter:r}):Object(O.orderSolutionComponentsClientSide)({solutionId:n,orderBy:a,componentTypes:o,searchFilter:r,environmentId:s}))},dispatchSearch:(n,a)=>{t.solutionAwareness===N.SolutionAwareness.NotInSolution?e(Object(O.searchSolutionComponentsNotInSolution)({solutionId:n,orderBy:a,searchFilter:r,componentTypes:o})):t.solutionAwareness===N.SolutionAwareness.InSolution&&e(Object(O.searchSolutionComponents)({solutionId:n,orderBy:a,searchFilter:r,componentTypes:o}))},dispatchPageRequest:n=>{t.solutionAwareness===N.SolutionAwareness.NotInSolution?e(Object(O.pageSolutionComponentsNotInSolution)({solutionId:n,componentTypes:o,searchFilter:r})):t.solutionAwareness===N.SolutionAwareness.InSolution&&e(Object(O.pageSolutionComponents)({solutionId:n,componentTypes:o,searchFilter:r}))},dispatchSolutionUnawareRequest:()=>{e(Object(f.fetchAppsRequest)({appsListFilter:d.AppListType.SolutionUnaware}))},dispatchComponentLibraryRequest:()=>{e(Object(f.fetchComponentLibrariesRequest)({forceRefresh:!0}))},dispatchAppsRequest:()=>{e(Object(f.fetchAppsRequest)({appsListFilter:d.AppListType.Org}))},dispatchFlowsRequest:()=>{e(Object(x.fetchFlowsRequest)({flowType:x.FlowType.personal})),e(Object(x.fetchFlowsRequest)({flowType:x.FlowType.team}))},dispatchApisRequest:()=>{e(Object(C.fetchApisRequest)({requestOptions:{additionalFilters:["IsCustomApi eq 'True'"]}}))},dispatchAppModulesRequest:()=>{e(Object(h.fetchAppModulesRequest)({appModuleListFilter:l.AppModuleListType.Recent}))},dispatchDataflowRequests:()=>{G.fetchDataflowsRequests.forEach(e)},dispatchFilteredItemsRequest:t=>{(o||[]).forEach(n=>{if(Object(z.isKnownCustomSolutionComponentType)(n)){var o=Object(K.knownCustomSolutionComponentTypeFilteredListDispatchRequests)(n.logicalName,t);null==o||o.forEach(e)}})},dispatchCustomComponentRequests:()=>{(o||[]).forEach(t=>{if(Object(z.isKnownCustomSolutionComponentType)(t)){if(Object(K.knownCustomSolutionComponentTypeListDispatchRequests)(t.logicalName))Object(K.knownCustomSolutionComponentTypeListDispatchRequests)(t.logicalName).forEach(e);if(Object(K.knownCustomSolutionComponentTypeNotInAnySolutionListDispatchRequests)(t.logicalName))Object(K.knownCustomSolutionComponentTypeNotInAnySolutionListDispatchRequests)(t.logicalName).forEach(e)}})},onRowClick:o=>{var r=Object(L.currentEnvironmentName)(t),a=Object(c.getSolutionId)(t.solution);if(Object(D.processComponentClickEvent)(r,t.solution,o,t.navigate)!=D.ProcessResult.Handled){var i=Object(D.getRowClickActionForComponent)(t.solution,o,n);if(i&&(e(Object(S.logAction)(i,j.SolutionComponentsListEvents.RowClick.eventName,j.SolutionComponentsListEvents.RowClick.getData(a,o))),!(Object(p.isOfSolutionComponentType)(o,Q.StandardSolutionComponentTypes.RibbonCustomization)||Object(p.isOfSolutionComponentType)(o,Q.StandardSolutionComponentTypes.SdkMessageProcessingStep)||Object(p.isOfSolutionComponentType)(o,Q.StandardSolutionComponentTypes.EntityDataProvider)||Object(p.isOfSolutionComponentType)(o,Q.StandardSolutionComponentTypes.EntityDataSource)||Object(p.isOfSolutionComponentType)(o,Q.StandardSolutionComponentTypes.Entity)||Object(p.isOfSolutionComponentType)(o,Q.StandardSolutionComponentTypes.OptionSet)||Object(p.isOfSolutionComponentType)(o,Q.StandardSolutionComponentTypes.CanvasApp)||Object(p.isOfSolutionComponentType)(o,Q.StandardSolutionComponentTypes.CanvasAppsOnly)||Object(p.isOfSolutionComponentType)(o,Q.StandardSolutionComponentTypes.CustomCanvasPage)||Object(p.isOfSolutionComponentType)(o,Q.StandardSolutionComponentTypes.ComponentLibrary)||Object(p.isOfSolutionComponentType)(o,Q.StandardSolutionComponentTypes.Dialog)||Object(p.isOfSolutionComponentType)(o,Q.StandardSolutionComponentTypes.EnvironmentVariableDefinition)||Object(p.isOfSolutionComponentType)(o,Q.StandardSolutionComponentTypes.PowerBIDashboard)))){var s=Object(b.getResources)(),l=Object(p.getSolutionComponentTypeDisplayName)(o,!0);e(Object(T.openConfirmDialog)({hidden:!1,title:Object(g.formatResourceString)(s.Model.Solutions.Components.Edit.Dialog.title,l),subText:Object(g.formatResourceString)(s.Model.Solutions.Components.Edit.Dialog.subtext,l),confirmButtonText:s.Model.Solutions.Components.NewCommand.Dialog.closeButtonText,onConfirm:()=>{e(Object(O.forceSolutionComponentsListDeselect)()),e(Object(T.closeConfirmDialog)()),e(Object(O.refreshComponentsList)())},hideCancelButton:!0}))}}},dispatchTelemetry:e}},le=(e,t,n)=>{var{solutionId:r,solutionComponents:a,getObjectFromComponent:i,solutionComponentsFilterParameterOptions:s}=e,l=ne(e,X),{componentTypes:c,solutionAwareness:p,rootProps:d,updateComponentsListItemsSelected:m,currentSelectedItems:b}=n,g=ne(n,Z),y=d.currentEnvironment,S=Object(o.isEmpty)(c)?void 0:c[0],f=null,h=null,O=null;return p!==N.SolutionAwareness.NotInAnySolution&&(f=()=>t.dispatchPageRequest(r),h=(n,o,r)=>t.dispatchListRequestForSorting(e.solutionId,n,o,r),O=n=>t.dispatchSearch(e.solutionId,n)),ee(ee(ee({onMount:()=>{y&&(t.dispatchListRequest(r),t.dispatchAppsRequest(),t.dispatchComponentLibraryRequest(),t.dispatchSolutionUnawareRequest(),t.dispatchFlowsRequest(),t.dispatchApisRequest(),t.dispatchAppModulesRequest(),Object(Y.isStandardDataflowSolutionComponentEnabled)(n.customComponentDefinitions,y)&&t.dispatchDataflowRequests(),t.dispatchCustomComponentRequests())},dispatchTelemetry:t.dispatchTelemetry,solutionComponentsListItems:oe(a,i,Object(u.isCdsLiteContext)(y),t.onRowClick,n.columnOptions,e.objectsBeingChecked,e.objectCheckerRunsCompleted),solutionComponentsFilterParameterOptions:s,componentType:S,currentSelectedItems:b,updateComponentsListItemsSelected:m,loadMoreSolutionComponents:f,orderSolutionComponentsList:h,searchSolutionComponentsList:O,listHeaderPadding:n.listHeaderPadding,solutionAwareness:n.solutionAwareness,currentEnvironment:y},g),l),{},{fetchFilteredItems:t.dispatchFilteredItemsRequest})};function ce(e,t){return Object(H.withNavigation)(Object(M.withCustomConnectorCommands)(j.SolutionContexts.ComponentsList.ContextMenu)(Object(I.withFlowCommands)(j.SolutionContexts.ComponentsList.ContextMenu)(Object(a.withAppCommands)(j.SolutionContexts.ComponentsList.ContextMenu)(Object(i.withAppModuleCommands)(j.SolutionContexts.ComponentsList.ContextMenu)(Object(R.withEntityCommands)(j.SolutionContexts.ComponentsList.ContextMenu)(Object(w.withComponentLibraryCommands)(j.SolutionContexts.ComponentsList.ContextMenu)(Object(s.withRootProps)(Object(D.withSolutionComponentCommands)(j.SolutionContexts.ComponentsList.ContextMenu)(Object(r.connect)(ie,se,le)(Object(m.withLoadTelemetry)(e,t)))))))))))}},6615:function(e,t,n){"use strict";n.r(t),n.d(t,"mapStateToProps",(function(){return b})),n.d(t,"mapDispatchToProps",(function(){return g})),n.d(t,"mergeProps",(function(){return y})),n.d(t,"withFlowCommands",(function(){return S}));var o=n(5437),r=n(2809),a=n(5607),i=n(5630),s=n(5686),l=n(5687),c=n(5689),p=n(3713);function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){m(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function b(e){return{}}var g=e=>({dispatch:e}),y=e=>(e,t,n)=>{var o=t.dispatch,u={onFlowEdit:(e,t)=>{Object(c.assertOnlyOne)(e,o)&&o(Object(i.logAction)(s.openFlowEdit({currentSelectedComponent:e[0]}),l.SolutionFlowsCommandEvents.Edit.eventName))},onFlowShare:e=>o(Object(i.logAction)(s.openFlowShare({componentId:Object(p.getSolutionComponentId)(e),solutionId:Object(a.getSolutionComponentSolutionId)(e)}),l.SolutionFlowsCommandEvents.Share.eventName)),onFlowSeeAnalytics:e=>{Object(c.assertOnlyOne)(e,o)&&o(Object(i.logAction)(s.openFlowAnalytics({solutionId:Object(p.getSolutionComponentId)(e[0]),flowName:Object(a.getSolutionComponentFlowId)(e[0])}),r.SolutionComponentCommands.SeeAnalytics))},onFlowDetails:e=>{Object(c.assertOnlyOne)(e,o)&&o(Object(i.logAction)(s.openFlowDetails({solutionId:Object(p.getSolutionComponentId)(e[0]),flowName:Object(a.getSolutionComponentFlowId)(e[0]),currentSelectedComponent:e[0]}),r.SolutionComponentCommands.FlowDetails))}};return d(d({},n),{},{flowCommandActions:u})};function S(e){return Object(o.connect)(b,g,y(e))}},6616:function(e,t,n){"use strict";n.r(t),n.d(t,"mapStateToProps",(function(){return p})),n.d(t,"mapDispatchToProps",(function(){return u})),n.d(t,"mergeProps",(function(){return d})),n.d(t,"withComponentLibraryCommands",(function(){return m}));var o=n(5437),r=n(5674),a=n(5687),i=n(5593);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p(e){return{}}var u=e=>({dispatch:e}),d=e=>(e,t,n)=>{var{navigate:o}=n,s={onComponentLibraryEdit:(e,t,n)=>{Object(i.trackUserActionClickButton)(a.ComponentLibraryCommandEvents.Edit.eventName),r.ComponentLibraryCommandActions.onComponentLibraryEditClick(e.id,t,o,n)},onComponentLibraryDetails:(e,t,n)=>{Object(i.trackUserActionClickButton)(a.ComponentLibraryCommandEvents.Details.eventName),r.ComponentLibraryCommandActions.onComponentLibraryDetailsClick(e.name,t,o,n)}};return l(l({},n),{},{componentLibraryCommandActions:s})};function m(e){return Object(o.connect)(p,u,d(e))}},6617:function(e,t,n){"use strict";n.r(t),n.d(t,"mapStateToProps",(function(){return u})),n.d(t,"mapDispatchToProps",(function(){return d})),n.d(t,"mergeProps",(function(){return m})),n.d(t,"withCustomConnectorCommands",(function(){return b}));var o=n(5630),r=n(5686),a=n(5687),i=n(5437),s=n(5689);function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){p(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e){return{}}var d=e=>({dispatch:e}),m=e=>(e,t,n)=>{var i=t.dispatch,l={onCustomConnectEdit:(e,t)=>{Object(s.assertOnlyOne)(e,i)&&i(Object(o.logAction)(r.openCustomConnectorEdit({currentSelectedComponent:e[0]}),a.SolutionFlowsCommandEvents.Edit.eventName))}};return c(c({},n),{},{customConnectorCommandActions:l})};function b(e){return Object(i.connect)(u,d,m(e))}},6618:function(e,t,n){"use strict";n.r(t),n.d(t,"getEnvironmentVariableDefinitionDefaultValue",(function(){return a})),n.d(t,"getEnvironmentVariableDefinitionDataType",(function(){return i})),n.d(t,"getEnvironmentVariableDefinitionIsRequired",(function(){return s}));var o=n(2830),r=n(2869);function a(e){return e&&e.extendedDefaultValue||""}function i(e){var t,n=Object(r.getResources)().Model.Solutions.Components.EnvironmentVariable.Panel;switch(e.extendedDataType){case o.EnvironmentVariableDefinitionTypeEnum.Boolean:t=n.DataType.booleanChoice;break;case o.EnvironmentVariableDefinitionTypeEnum.JSON:t=n.DataType.json;break;case o.EnvironmentVariableDefinitionTypeEnum.Number:t=n.DataType.decimalNumber;break;case o.EnvironmentVariableDefinitionTypeEnum.String:t=n.DataType.text;break;default:t=""}return t}function s(e){var t=Object(r.getResources)().Model.Solutions.Components.EnvironmentVariable.Panel,n=t.IsRequired?t.IsRequired:{yes:"Yes",no:"No"};return e&&e.extendedIsRequired?n.yes:n.no}},6619:function(e,t,n){"use strict";function o(e){return(null==e?void 0:e.name)||""}function r(e){return null==e?void 0:e.id}function a(e){var t;return(null==e||null===(t=e.properties)||void 0===t?void 0:t.owner)||""}function i(e){var t;return(null==e||null===(t=e.properties)||void 0===t?void 0:t.lastRefreshTime)||""}n.r(t),n.d(t,"getPowerBIArtifactDisplayName",(function(){return o})),n.d(t,"getPowerBIArtifactId",(function(){return r})),n.d(t,"getPowerBIArtifactOwner",(function(){return a})),n.d(t,"getPowerBIArtifactLastRefreshTime",(function(){return i}))},6620:function(e,t,n){"use strict";n.r(t),n.d(t,"EnvironmentVariableAddExistingPanelSelectedList",(function(){return O}));var o=n(4064),r=n(1362),a=n(1471),i=n(684),s=n(1473),l=n(245),c=n(5607),p=n(3713),u=n(2879),d=n(2869),m=n(2880),b=n(6612),g=n(5609),y=n(5611);function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(Object(n),!0).forEach((function(t){h(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class O extends l.Component{constructor(e){super(e),this.resources=void 0,this.columns=void 0,this.resources=Object(d.getResources)(),this.state={},this.columns=this.buildColumns()}render(){var e=l.createElement(o.DetailsList,{items:this.buildListItems(),columns:this.columns,selectionMode:s.SelectionMode.none,constrainMode:a.ConstrainMode.unconstrained,layoutMode:a.DetailsListLayoutMode.justified,isHeaderVisible:!1});return l.createElement("div",{className:b.solutionComponentsSelectedListStyleClasses.solutionComponentsSelectedList},l.createElement("div",{className:"selected-list-subheader"},Object(m.formatResourceString)(this.resources.Model.Solutions.Components.AddExistingPanel.SelectedComponents.addMessage,this.props.currentSelectedItems.length,Object(g.getTypeStringFromSolutionComponentType)(y.StandardSolutionComponentTypes.EnvironmentVariableDefinition,!0,!0))),e)}buildListItems(){var e;return null===(e=this.props.currentSelectedItems)||void 0===e?void 0:e.map(e=>{var t=e.component,n=Object(p.getSolutionComponentObjectId)(t);return{key:n,displayName:Object(c.getSolutionComponentDisplayName)(t),component:t,definitionExcluded:this.props.componentsExcludingDefinition.includes(n),currentValueExcluded:this.props.componentsExcludingCurrentValue.includes(n)}})}buildColumns(){var e={fieldName:"",name:""},t={text:{fontWeight:"400"}};return[f(f({},e),{},{key:"selectedComponentOverview",minWidth:400,onRender:e=>l.createElement("div",{className:"selected-list-component-name"},e.displayName)}),f(f({},e),{},{key:"includeDefinitionToggle",minWidth:200,onRender:e=>l.createElement(r.Checkbox,{label:this.resources.Model.Solutions.Components.EnvironmentVariable.AddExistingPanel.SelectedEnvironmentVariables.includeDefinition,onChange:()=>this.props.onToggleExcludeDefinition(Object(p.getSolutionComponentObjectId)(e.component)),checked:!e.definitionExcluded,disabled:!e.component.extendedCurrentValueId,styles:t})}),f(f({},e),{},{key:"includeCurrentValueToggle",minWidth:200,onRender:e=>l.createElement(r.Checkbox,{label:this.resources.Model.Solutions.Components.EnvironmentVariable.AddExistingPanel.SelectedEnvironmentVariables.includeCurrentValue,onChange:()=>this.props.onToggleExcludeCurrentValue(Object(p.getSolutionComponentObjectId)(e.component)),checked:!!e.component.extendedCurrentValueId&&!e.currentValueExcluded,disabled:!e.component.extendedCurrentValueId,styles:t})}),f(f({},e),{},{key:"removeComponent",minWidth:40,onRender:e=>l.createElement(i.IconButton,{iconProps:{iconName:u.fabricIcons.Cancel},onClick:()=>{this.props.removeCurrentSelectedItems(null==e?void 0:e.key)},ariaLabel:u.fabricIcons.Cancel})})]}}},6621:function(e,t,n){"use strict";n.r(t);var o=n(6622);n.d(t,"DefinitionsOrOverridesList",(function(){return o.DefinitionsOrOverridesList}));var r=n(6623);n.d(t,"DefinitionsOrOverridesListBase",(function(){return r.DefinitionsOrOverridesListBase}));var a=n(6639);n.d(t,"DefinitionState",(function(){return a.DefinitionState})),n.d(t,"OrgOverrideState",(function(){return a.OrgOverrideState}));var i=n(6656);n.d(t,"getStyles",(function(){return i.getStyles}))},6622:function(e,t,n){"use strict";n.r(t),n.d(t,"DefinitionsOrOverridesList",(function(){return l}));var o=n(245),r=n.n(o),a=n(545),i=n(6623),s=n(6656),l=r.a.memo(Object(a.styled)(i.DefinitionsOrOverridesListBase,s.getStyles,void 0,{scope:"DefinitionsOrOverridesList"}))},6623:function(e,t,n){"use strict";n.r(t),n.d(t,"DefinitionsOrOverridesListBase",(function(){return C}));var o=n(245),r=n.n(o),a=n(1697),i=n(1372),s=n(545),l=n(923),c=n(1471),p=n(684),u=n(1473),d=n(6624),m=n(6625),b=n(217),g=n(6627),y=n(6629);function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(Object(n),!0).forEach((function(t){h(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var O=Object(s.classNamesFunction)(),C=e=>{var t,{settings:n,onSettingItemsChange:i,className:s,styles:p,theme:S}=e,{t:h}=Object(l.useTranslation)(y.PowerPlatformSettingsName),C=O(p,{theme:S,className:s}),[P,E]=Object(o.useState)([]),{customComponentTypeCodes:T}=Object(o.useContext)(m.CustomComponentTypeCodesContext),[j,A]=Object(o.useState)();i&&(t=e=>{null==i||i(e.map(e=>{var t,n;return void 0===e.definitionState||e.definitionState===g.DefinitionState.Loading?e:f(f({},e),{},{includeDefinition:e.definitionState===g.DefinitionState.ToggledOn||e.definitionState===g.DefinitionState.MustBeIncluded,includeOrgOverride:e.orgOverrideState===g.OrgOverrideState.ToggledOn||e.orgOverrideState===g.OrgOverrideState.MustBeIncluded,definitionTypeCode:null===(t=T.settingdefinitions)||void 0===t?void 0:t.objectTypeCode,orgOverrideTypeCode:null===(n=T.organizationsettings)||void 0===n?void 0:n.objectTypeCode})}))});var R=(e,n)=>{E(o=>{var r,a=[...o];return a[n]=f(f({},o[n]),e),null===(r=t)||void 0===r||r(a),a})},I=Object(o.useMemo)(()=>v(e,C,R,A,h),[]);return Object(o.useEffect)(()=>{E(n.map(e=>f(f({},e),{},{key:e.settingName,definitionState:g.DefinitionState.Loading,orgOverrideState:g.OrgOverrideState.Loading,orgOverrideId:void 0})))},[]),Object(o.useEffect)(()=>{null!=P&&P.length&&E(P.filter(e=>n.findIndex(t=>t.settingName===e.key)>-1))},[n]),Object(o.useEffect)(()=>{Object(b.trackInfoTrace)(y.PowerPlatformSettingsName,{eventName:"".concat("AddExistingStep2","/Load"),eventData:{settingsCount:n.length}})},[]),r.a.createElement("div",{className:C.root},j&&r.a.createElement(a.MessageBar,{messageBarType:a.MessageBarType.error},Object(d.parseMessageFromError)(j)),r.a.createElement("div",{className:C.header},h("addExistingSettingsList.countToAdd",{count:n.length})),r.a.createElement(c.DetailsList,{items:P,columns:I,selectionMode:u.SelectionMode.none,constrainMode:c.ConstrainMode.unconstrained,layoutMode:c.DetailsListLayoutMode.justified,isHeaderVisible:!1}))},v=(e,t,n,o,a)=>{var{removeItem:s,solutionUniqueName:l}=e,c={fieldName:"",name:""};return[f(f({},c),{},{key:"selectedComponentOverview",minWidth:400,onRender:e=>r.a.createElement(i.Label,{className:t.label},e.displayName)}),f(f({},c),{},{key:"includeDefinitionToggle",minWidth:300,onRender:(e,a)=>r.a.createElement(g.DefinitionCheckbox,{item:e,solutionUniqueName:l,changeSetting:e=>void 0!==a&&n(e,a),setErrorMessage:o,className:t.label})}),f(f({},c),{},{key:"includeOrgOverrideToggle",minWidth:300,onRender:(e,a)=>r.a.createElement(g.OrgOverrideCheckbox,{item:e,solutionUniqueName:l,changeSetting:e=>void 0!==a&&n(e,a),setErrorMessage:o,className:t.label})}),f(f({},c),{},{key:"removeComponent",minWidth:40,onRender:e=>r.a.createElement(p.IconButton,{iconProps:{iconName:"Cancel"},onClick:()=>{s(null==e?void 0:e.key)},ariaLabel:a("controls.cancel")})})]}},6624:function(e,t,n){"use strict";n.r(t);var o=n(5916);n.d(t,"isAuthError",(function(){return o.isAuthError})),n.d(t,"isErrorCodeUserForbidden",(function(){return o.isErrorCodeUserForbidden})),n.d(t,"UserForbiddenCodes",(function(){return o.UserForbiddenCodes})),n.d(t,"AadGroupsFeatureNotEnabledErrorCode",(function(){return o.AadGroupsFeatureNotEnabledErrorCode})),n.d(t,"checkErrorServerResponseCode",(function(){return o.checkErrorServerResponseCode})),n.d(t,"checkErrorStatusCode",(function(){return o.checkErrorStatusCode})),n.d(t,"isGraphQLError",(function(){return o.isGraphQLError})),n.d(t,"tryExtractGraphQLErrorBody",(function(){return o.tryExtractGraphQLErrorBody})),n.d(t,"parseMessageFromError",(function(){return o.parseMessageFromError})),n.d(t,"AADUserNotEnabledErrorCode",(function(){return o.AADUserNotEnabledErrorCode})),n.d(t,"parseMessageFromBatchResponse",(function(){return o.parseMessageFromBatchResponse})),n.d(t,"getSessionInfoMessage",(function(){return o.getSessionInfoMessage})),n.d(t,"getGenericAuthErrorMessage",(function(){return o.getGenericAuthErrorMessage}))},6625:function(e,t,n){"use strict";n.r(t),n.d(t,"CustomComponentTypeCodesContext",(function(){return s})),n.d(t,"CustomComponentTypeCodesProvider",(function(){return l})),n.d(t,"withCustomComponentTypeCodes",(function(){return c}));var o=n(245),r=n.n(o),a=n(6472),i=n(6626),s=r.a.createContext({customComponentTypeCodes:{}}),l=e=>{var{solutionComponentDefinitions:t}=Object(a.useSolutionComponentDefinitions)({variables:{input:{showBotComponents:!0,filterDataFlowComponent:!1,botComponentDefinitions:[]}},telemetryScope:i.CdsCommonUxName}),n=Object(o.useMemo)(()=>{var e={};if(t)for(var n of t)e[n.entitySetName]=n;return e},[t]);return r.a.createElement(s.Provider,{value:{customComponentTypeCodes:n}},e.children)},c=e=>t=>r.a.createElement(l,null,r.a.createElement(e,t))},6627:function(e,t,n){"use strict";n.r(t);var o=n(6628);n.d(t,"useDefinitionOrOverrideDisplayState",(function(){return o.useDefinitionOrOverrideDisplayState})),n.d(t,"getDisplayState",(function(){return o.getDisplayState})),n.d(t,"CheckboxShimmer",(function(){return o.CheckboxShimmer}));var r=n(6638);n.d(t,"DefinitionState",(function(){return r.DefinitionState})),n.d(t,"OrgOverrideState",(function(){return r.OrgOverrideState}));var a=n(6640);n.d(t,"DefinitionCheckbox",(function(){return a.DefinitionCheckbox}));var i=n(6655);n.d(t,"OrgOverrideCheckbox",(function(){return i.OrgOverrideCheckbox}))},6628:function(e,t,n){"use strict";n.r(t),n.d(t,"useDefinitionOrOverrideDisplayState",(function(){return d})),n.d(t,"getDisplayState",(function(){return m})),n.d(t,"CheckboxShimmer",(function(){return b}));var o=n(245),r=n.n(o),a=n(5893),i=n(1755),s=n(6627),l=n(6629);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var d=e=>{var{item:t,solutionUniqueName:n,changeSetting:r,setErrorMessage:i}=e,{powerSetting:s,errorMessage:c}=Object(a.usePowerSetting)({variables:{settingName:t.key,solutionUniqueName:n},telemetryScope:l.PowerPlatformSettingsName,fetchPolicy:"cache-and-network"});Object(o.useEffect)(()=>{var e;s&&r(p(p({},m(s)),{},{orgOverrideId:null!==(e=s.orgOverrideId)&&void 0!==e?e:void 0}))},[s]),Object(o.useEffect)(()=>{i(c)},[c])},m=e=>{var t=s.DefinitionState.ToggledOn,n=s.OrgOverrideState.ToggledOn;return e.orgOverrideId||(n=s.OrgOverrideState.DoesNotExist),e.isDefinitionPresentInSolution&&(t=s.DefinitionState.AlreadyIncluded),e.isOrgOverridePresentInSolution&&(n=s.OrgOverrideState.AlreadyIncluded),(n===s.OrgOverrideState.AlreadyIncluded||n===s.OrgOverrideState.DoesNotExist||e.hasActiveCustomizations)&&(t=s.DefinitionState.MustBeIncluded),t===s.DefinitionState.AlreadyIncluded&&(n=s.OrgOverrideState.MustBeIncluded),{definitionState:t,orgOverrideState:n}},b=()=>r.a.createElement(i.Shimmer,{shimmerElements:[{type:i.ShimmerElementType.line,width:200}]})},6629:function(e,t,n){"use strict";n.r(t);var o=n(6630);n.d(t,"PowerPlatformSettingsName",(function(){return o.PowerPlatformSettingsName})),n.d(t,"SettingsLearnMoreLink",(function(){return o.SettingsLearnMoreLink}));var r=n(6631);n.d(t,"useAppModuleForOverrides",(function(){return r.useAppModuleForOverrides})),n.d(t,"getAllowedOverrides",(function(){return r.getAllowedOverrides})),n.d(t,"getDataType",(function(){return r.getDataType})),n.d(t,"getOverrideDefault",(function(){return r.getOverrideDefault}))},6638:function(e,t,n){"use strict";n.r(t);var o=n(6639);n.d(t,"DefinitionState",(function(){return o.DefinitionState})),n.d(t,"OrgOverrideState",(function(){return o.OrgOverrideState}))},6639:function(e,t,n){"use strict";var o,r;n.r(t),n.d(t,"DefinitionState",(function(){return o})),n.d(t,"OrgOverrideState",(function(){return r})),function(e){e[e.AlreadyIncluded=0]="AlreadyIncluded",e[e.MustBeIncluded=1]="MustBeIncluded",e[e.ToggledOn=2]="ToggledOn",e[e.ToggledOff=3]="ToggledOff",e[e.Loading=4]="Loading"}(o||(o={})),function(e){e[e.AlreadyIncluded=0]="AlreadyIncluded",e[e.MustBeIncluded=1]="MustBeIncluded",e[e.ToggledOn=2]="ToggledOn",e[e.ToggledOff=3]="ToggledOff",e[e.Loading=4]="Loading",e[e.DoesNotExist=5]="DoesNotExist"}(r||(r={}))},6640:function(e,t,n){"use strict";n.r(t),n.d(t,"DefinitionCheckbox",(function(){return p}));var o=n(245),r=n.n(o),a=n(1372),i=n(923),s=n(6641),l=n(6627),c=n(6629),p=e=>{var{item:t,changeSetting:n,className:o}=e,{definitionState:p}=t,{t:u}=Object(i.useTranslation)(c.PowerPlatformSettingsName);return Object(l.useDefinitionOrOverrideDisplayState)(e),p===l.DefinitionState.Loading?r.a.createElement(l.CheckboxShimmer,null):p===l.DefinitionState.AlreadyIncluded?r.a.createElement(a.Label,{className:o},u("addExistingSettingsList.definitionAlreadyIncluded")):r.a.createElement(s.CdsCheckbox,{className:o,label:u("addExistingSettingsList.includeDefinition"),onChange:()=>{var e=p===l.DefinitionState.ToggledOn?l.DefinitionState.ToggledOff:l.DefinitionState.ToggledOn;n({definitionState:e})},checked:p===l.DefinitionState.MustBeIncluded||p===l.DefinitionState.ToggledOn,disabled:p!==l.DefinitionState.ToggledOn&&p!==l.DefinitionState.ToggledOff})}},6655:function(e,t,n){"use strict";n.r(t),n.d(t,"OrgOverrideCheckbox",(function(){return p}));var o=n(245),r=n.n(o),a=n(1372),i=n(923),s=n(6641),l=n(6627),c=n(6629),p=e=>{var{item:t,changeSetting:n,className:o}=e,{orgOverrideState:p}=t,{t:u}=Object(i.useTranslation)(c.PowerPlatformSettingsName);return Object(l.useDefinitionOrOverrideDisplayState)(e),p===l.OrgOverrideState.Loading?r.a.createElement(l.CheckboxShimmer,null):p===l.OrgOverrideState.AlreadyIncluded?r.a.createElement(a.Label,{className:o},u("addExistingSettingsList.orgOverrideAlreadyIncluded")):p===l.OrgOverrideState.DoesNotExist?r.a.createElement(a.Label,{className:o},u("addExistingSettingsList.orgOverrideDoesNotExist")):r.a.createElement(s.CdsCheckbox,{className:o,label:u("addExistingSettingsList.includeOverride"),onChange:()=>{var e=p===l.OrgOverrideState.ToggledOn?l.OrgOverrideState.ToggledOff:l.OrgOverrideState.ToggledOn;n({orgOverrideState:e})},checked:p===l.OrgOverrideState.MustBeIncluded||p===l.OrgOverrideState.ToggledOn,disabled:p!==l.OrgOverrideState.ToggledOn&&p!==l.OrgOverrideState.ToggledOff})}},6656:function(e,t,n){"use strict";function o(e){var{className:t}=e;return{root:[t],header:{fontWeight:600,height:32},label:{fontWeight:400}}}n.r(t),n.d(t,"getStyles",(function(){return o}))},6657:function(e,t,n){"use strict";n.r(t);var o=n(5693);n.d(t,"envVariableActions",(function(){return o}));var r=n(6658);n.d(t,"envVariableMiddlewares",(function(){return r}));var a=n(6661),i=n(5816);n.d(t,"envVariableSelectors",(function(){return i})),t.default=a.reducer},6658:function(e,t,n){"use strict";n.r(t);var o=n(6659);n.d(t,"EnvironmentVariableRootSaga",(function(){return o.EnvironmentVariableRootSaga}));var r=n(6660);n.d(t,"EnvironmentVariableSaga",(function(){return r.default}))},6659:function(e,t,n){"use strict";n.r(t),n.d(t,"EnvironmentVariableRootSaga",(function(){return a}));var o=n(5749),r=n(6658);function*a(){yield Object(o.all)([Object(o.fork)(r.EnvironmentVariableSaga)])}},6660:function(e,t,n){"use strict";n.r(t);var o=n(5749),r=n(5608),a=n(2868),i=n(2869),s=n(5686),l=n(5693),c=n(5816),p=n(5611),u=n(5593),d=n(5669),m=n(2880);function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){y(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function*S(e){var t=Object(i.getResources)();try{var n,r,c=yield a.MetadataClientInstance.getInstance(),p=yield c.executeAction("EnvironmentVariableDefinition","Create",{solutionName:null===(n=e.payload.solution)||void 0===n?void 0:n.name},e.payload.toCreate);e.payload.currentValue?yield Object(o.put)(Object(l.createCurrentValue)({solution:e.payload.solution,value:e.payload.currentValue,definitionId:p.environmentvariabledefinitionid})):yield Object(o.put)(Object(l.fetchEnvironmentVariableData)({})),yield Object(o.put)(Object(s.fetchSolutionComponentsRequest)({solutionId:null===(r=e.payload.solution)||void 0===r?void 0:r.id})),yield Object(o.put)(Object(l.createEnvironmentVariableSucceeded)({response:""}))}catch(d){var u;u="412"===d.code?t.Model.Solutions.Components.EnvironmentVariable.Error.duplicateName:"403"===d.code?t.Model.Solutions.Components.EnvironmentVariable.Error.missingCreatePrivilege:d.message?Object(m.formatResourceString)(t.Model.Solutions.Components.EnvironmentVariable.Error.saveFailedWithDetails,d.message):t.Model.Solutions.Components.EnvironmentVariable.Error.saveFailed,yield Object(o.put)(Object(l.createEnvironmentVariableFailed)({response:u}))}}function*f(e){var t,n=null===(t=e.payload.solution)||void 0===t?void 0:t.name,r=Object(i.getResources)();try{var s=yield a.MetadataClientInstance.getInstance();yield s.executeAction("EnvironmentVariableDefinition","Update",{solutionName:n},e.payload.defModificationContract),yield Object(o.put)(Object(l.modifyEnvironmentVariableSucceeded)({response:""})),yield Object(o.put)(Object(l.fetchEnvironmentVariableData)({}))}catch(p){var c;c="403"===p.code?r.Model.Solutions.Components.EnvironmentVariable.Error.missingEditPrivilege:p.message?Object(m.formatResourceString)(r.Model.Solutions.Components.EnvironmentVariable.Error.saveFailedWithDetails,p.message):r.Model.Solutions.Components.EnvironmentVariable.Error.saveFailed,yield Object(o.put)(Object(l.modifyEnvironmentVariableFailed)({response:c}))}}function*h(e){var t=Object(i.getResources)();try{var n,r,c=yield a.MetadataClientInstance.getInstance(),p={value:e.payload.value,_environmentvariabledefinitionid_value:e.payload.definitionId};yield c.executeAction("EnvironmentVariableValue","Create",{solutionName:null===(n=e.payload.solution)||void 0===n?void 0:n.name},p),yield Object(o.put)(Object(l.createCurrentValueSucceeded)({response:""})),yield Object(o.put)(Object(l.fetchEnvironmentVariableData)({})),yield Object(o.put)(Object(s.fetchSolutionComponentsRequest)({solutionId:null===(r=e.payload.solution)||void 0===r?void 0:r.id}))}catch(d){var u=t.Model.Solutions.Components.EnvironmentVariable.Error.saveFailed;d.message&&(u=Object(m.formatResourceString)(t.Model.Solutions.Components.EnvironmentVariable.Error.saveFailedWithDetails,d.message)),yield Object(o.put)(Object(l.createCurrentValueFailed)({response:u}))}}function*O(e){var t,n=null===(t=e.payload.solution)||void 0===t?void 0:t.name,r=Object(i.getResources)();try{var s=yield a.MetadataClientInstance.getInstance(),c={value:e.payload.value,environmentvariablevalueid:e.payload.valueId};yield s.executeAction("EnvironmentVariableValue","Update",{solutionName:n},c),yield Object(o.put)(Object(l.modifyCurrentValueSucceeded)({response:""})),yield Object(o.put)(Object(l.fetchEnvironmentVariableData)({}))}catch(u){var p=r.Model.Solutions.Components.EnvironmentVariable.Error.saveFailed;u.message&&(p=Object(m.formatResourceString)(r.Model.Solutions.Components.EnvironmentVariable.Error.saveFailedWithDetails,u.message)),yield Object(o.put)(Object(l.modifyCurrentValueFailed)({response:p}))}}function*C(e){var t=d.SagaScenarioNames.fetchEnvVariableDefs,n=Object(u.trackLoadScenario)(t,e.payload);try{var r=yield a.MetadataClientInstance.getInstance(),i=(yield r.fetchList("EnvironmentVariableDefinition",void 0,{expand:{environmentvariabledefinition_environmentvariablevalue:{}}})).data;yield Object(o.put)(Object(l.fetchEnvironmentVariableDataFinished)({envVariableDefs:i})),Object(u.trackScenarioComplete)(t,g({},e.payload),n)}catch(s){Object(u.trackScenarioFailure)(t,{error:s.message},n),yield Object(o.put)(Object(l.fetchEnvironmentVariableDataFinished)({envVariableDefs:[],error:s.message}))}}function*v(e){try{var t=yield a.MetadataClientInstance.getInstance(),n=(yield t.fetchList("EnvironmentVariableValue",{environmentvariabledefinitionid:e.payload.definitionId})).data;yield Object(o.put)(Object(l.fetchEnvironmentVariableValuesFinished)({envVariableValues:n,definitionId:e.payload.definitionId,error:null}))}catch(r){yield Object(o.put)(Object(l.fetchEnvironmentVariableValuesFinished)({envVariableValues:[],definitionId:e.payload.definitionId,error:r.message}))}}function*P(e){try{var t=yield a.MetadataClientInstance.getInstance(),n=[];e.payload.envVarValues.forEach(e=>{n.push({value:e.value,_environmentvariabledefinitionid_value:e.environmentVariableDefinitionId})}),yield t.executeAction("EnvironmentVariableValue","Create",{solutionName:"Default"},n),yield Object(o.put)(Object(l.fetchEnvironmentVariableData)({}))}catch(r){return r.message}}function*E(e){var t=[],n=[];try{for(var a=0;a<e.payload.environmentVariables.length;a++){var i=e.payload.environmentVariables[a];if(i.excludeDefinition||t.push(i.component),!i.excludeCurrentValue){var l=yield Object(o.select)(c.envVariableSelector,i.component.msdyn_objectid);if(l&&l.environmentvariabledefinition_environmentvariablevalue.length>0){var u=l.environmentvariabledefinition_environmentvariablevalue[0].environmentvariablevalueid;n.push({msdyn_objectid:u,msdyn_componenttype:r.SolutionComponentTypeCode.EnvironmentVariableValue})}}}if(t.length>0){var d={solutionName:e.payload.solutionName,solutionId:e.payload.solutionId,componentType:p.StandardSolutionComponentTypes.EnvironmentVariableValue,componentsWithSubcomponents:t.map(e=>({component:e,includeSubcomponents:!1,includeEntityMetadata:!1,subcomponents:[]}))};yield Object(o.put)(Object(s.addSolutionComponentsRequest)(d))}if(n.length>0){var m={solutionName:e.payload.solutionName,solutionId:e.payload.solutionId,componentType:p.StandardSolutionComponentTypes.EnvironmentVariableValue,componentsWithSubcomponents:n.map(e=>({component:e,includeSubcomponents:!1,includeEntityMetadata:!1,subcomponents:[]}))};yield Object(o.put)(Object(s.addSolutionComponentsRequest)(g({},m)))}}catch(b){return b.message}}t.default=function*(){yield Object(o.takeEvery)(l.EnvVariableActionTypes.CREATE_ENVIRONMENT_VARIABLE,S),yield Object(o.takeEvery)(l.EnvVariableActionTypes.MODIFY_ENVIRONMENT_VARIABLE,f),yield Object(o.takeEvery)(l.EnvVariableActionTypes.CREATE_CURRENT_VALUE,h),yield Object(o.takeEvery)(l.EnvVariableActionTypes.MODIFY_CURRENT_VALUE,O),yield Object(o.takeEvery)(l.EnvVariableActionTypes.FETCH_ENVIRONMENT_VARIABLE_DATA,C),yield Object(o.takeEvery)(l.EnvVariableActionTypes.FETCH_ENVIRONMENT_VARIABLE_VALUES,v),yield Object(o.takeEvery)(l.EnvVariableActionTypes.SET_ENVIRONMENT_VARIABLE_VALUE,P),yield Object(o.takeEvery)(l.EnvVariableActionTypes.ADD_ENVIRONMENTVARIABLES_REQUEST,E)}},6661:function(e,t,n){"use strict";n.r(t),n.d(t,"defaultState",(function(){return l})),n.d(t,"reducer",(function(){return c})),n.d(t,"getCurrentValueMappingKey",(function(){return p}));var o=n(2812),r=n(5693);function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var l={envVariableDefs:new Map,envVariableValues:new Map,fetchValuesResponse:{loading:!1,success:!1,failed:!1,message:""},fetchVarDataResponse:{loading:!1,success:!1,failed:!1,message:""},envVariablesNeedValue:[],createResponse:{loading:!1,success:!1,failed:!1,message:""},modifyEnvironmentVariableResponse:{loading:!1,success:!1,failed:!1,message:""},createCurrentValueResponse:{loading:!1,success:!1,failed:!1,message:""},modifyCurrentValueResponse:{loading:!1,success:!1,failed:!1,message:""}};function c(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case r.EnvVariableActionTypes.CREATE_ENVIRONMENT_VARIABLE:return i(i({},e),{},{createResponse:{message:"",success:!1,failed:!1,loading:!0}});case r.EnvVariableActionTypes.CREATE_ENVIRONMENT_VARIABLE_SUCCEEDED:return i(i({},e),{},{createResponse:{message:t.payload.response,success:!0,failed:!1,loading:!1}});case r.EnvVariableActionTypes.CREATE_ENVIRONMENT_VARIABLE_FAILED:return i(i({},e),{},{createResponse:{message:t.payload.response,success:!1,failed:!0,loading:!1}});case r.EnvVariableActionTypes.CREATE_ENVIRONMENT_VARIABLE_CLEAR:return i(i({},e),{},{createResponse:{message:"",success:!1,failed:!1,loading:!1}});case r.EnvVariableActionTypes.MODIFY_ENVIRONMENT_VARIABLE:return i(i({},e),{},{modifyEnvironmentVariableResponse:{message:"",success:!1,failed:!1,loading:!0}});case r.EnvVariableActionTypes.MODIFY_ENVIRONMENT_VARIABLE_SUCCEEDED:return i(i({},e),{},{modifyEnvironmentVariableResponse:{message:t.payload.response,success:!0,failed:!1,loading:!1}});case r.EnvVariableActionTypes.MODIFY_ENVIRONMENT_VARIABLE_FAILED:return i(i({},e),{},{modifyEnvironmentVariableResponse:{message:t.payload.response,success:!1,failed:!0,loading:!1}});case r.EnvVariableActionTypes.MODIFY_ENVIRONMENT_VARIABLE_CLEAR:return i(i({},e),{},{modifyEnvironmentVariableResponse:{message:"",success:!1,failed:!1,loading:!1}});case r.EnvVariableActionTypes.CREATE_CURRENT_VALUE:return i(i({},e),{},{createCurrentValueResponse:{message:"",success:!1,failed:!1,loading:!0}});case r.EnvVariableActionTypes.CREATE_CURRENT_VALUE_SUCCEEDED:return i(i({},e),{},{createCurrentValueResponse:{message:t.payload.response,success:!0,failed:!1,loading:!1}});case r.EnvVariableActionTypes.CREATE_CURRENT_VALUE_FAILED:return i(i({},e),{},{createCurrentValueResponse:{message:t.payload.response,success:!1,failed:!0,loading:!1}});case r.EnvVariableActionTypes.CREATE_CURRENT_VALUE_CLEAR:return i(i({},e),{},{createCurrentValueResponse:{message:"",success:!1,failed:!1,loading:!1}});case r.EnvVariableActionTypes.FETCH_ENVIRONMENT_VARIABLE_DATA_CLEAR:return Object(o.assign)({},e,i(i({},e),{},{fetchVarDataResponse:{message:"",success:!1,failed:!1,loading:!1}}));case r.EnvVariableActionTypes.FETCH_ENVIRONMENT_VARIABLE_DATA:return Object(o.assign)({},e,i(i({},e),{},{fetchVarDataResponse:{message:"",success:!1,failed:!1,loading:!0}}));case r.EnvVariableActionTypes.FETCH_ENVIRONMENT_VARIABLE_DATA_FINISHED:var n=e.envVariableDefs,a=[];return t.payload.envVariableDefs.forEach(e=>{o.isEmpty(e.defaultvalue)&&o.isEmpty(e.environmentvariabledefinition_environmentvariablevalue)&&a.push(e),n=n.set(e.environmentvariabledefinitionid,e)}),Object(o.assign)({},e,i(i({},e),{},{envVariableDefs:n,envVariablesNeedValue:a,fetchVarDataResponse:{message:t.payload.error,success:!t.payload.error,failed:!!t.payload.error,loading:!1}}));case r.EnvVariableActionTypes.FETCH_ENVIRONMENT_VARIABLE_VALUES:return Object(o.assign)({},e,i(i({},e),{},{fetchValuesResponse:{message:"",success:!1,failed:!1,loading:!0}}));case r.EnvVariableActionTypes.FETCH_ENVIRONMENT_VARIABLE_VALUES_CLEAR:return Object(o.assign)({},e,i(i({},e),{},{fetchValuesResponse:{message:"",success:!1,failed:!1,loading:!1}}));case r.EnvVariableActionTypes.FETCH_ENVIRONMENT_VARIABLE_VALUES_FINISHED:return Object(o.assign)({},e,i(i({},e),{},{envVariableValues:e.envVariableValues.set(t.payload.definitionId,t.payload.envVariableValues),fetchValuesResponse:{message:t.payload.error,success:!t.payload.error,failed:!!t.payload.error,loading:!1}}));case r.EnvVariableActionTypes.MODIFY_CURRENT_VALUE:return i(i({},e),{},{modifyCurrentValueResponse:{message:"",success:!1,failed:!1,loading:!0}});case r.EnvVariableActionTypes.MODIFY_CURRENT_VALUE_SUCCEEDED:return i(i({},e),{},{modifyCurrentValueResponse:{message:t.payload.response,success:!0,failed:!1,loading:!1}});case r.EnvVariableActionTypes.MODIFY_CURRENT_VALUE_FAILED:return i(i({},e),{},{modifyCurrentValueResponse:{message:t.payload.response,success:!1,failed:!0,loading:!1}});case r.EnvVariableActionTypes.MODIFY_CURRENT_VALUE_CLEAR:return i(i({},e),{},{modifyCurrentValueResponse:{message:"",success:!1,failed:!1,loading:!1}});default:return e}}function p(e,t){return"".concat(e,":").concat(t)}},6662:function(e,t,n){"use strict";n.r(t),n.d(t,"withSettingsNotInSolution",(function(){return c}));var o=n(245),r=n.n(o),a=n(6663),i=n(1083),s=n(6629);function l(){return(l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}function c(e){var t,n=t=>{var{solutionId:n,componentType:c}=t,p=!n||!c||"settingdefinition"!==c.logicalName,{solutionComponents:u}=Object(a.useSolutionComponentSummaries)({variables:{solutionId:i.DEFAULT_SOLUTION_ID,componentLogicalNames:["settingdefinition","organizationsetting"]},telemetryScope:s.PowerPlatformSettingsName,fetchPolicy:"cache-and-network",skip:p}),{solutionComponents:d}=Object(a.useSolutionComponentSummaries)({variables:{solutionId:null!=n?n:"",componentLogicalNames:["settingdefinition","organizationsetting"]},telemetryScope:s.PowerPlatformSettingsName,fetchPolicy:"cache-and-network",skip:p}),m=Object(o.useMemo)(()=>{if(u&&d&&!p){var e=[],t={},n={},o={};for(var r of u)"organizationsetting"===r.componentLogicalName&&(t[r.name]=r);for(var a of d)"settingdefinition"===a.componentLogicalName?n[a.uniqueName]=a:o[a.name]=a;for(var i of u)"settingdefinition"===i.componentLogicalName&&(!(i.uniqueName in n)||i.uniqueName in t&&!(i.uniqueName in o))&&e.push(i);return e}},[u,d,p]);return r.a.createElement(e,l({},t,{settingsNotInSolution:m}))};return n.displayName="WithSettingsNotInSolution(".concat(null!==(t=e.displayName)&&void 0!==t?t:"Component",")"),n}},6663:function(e,t,n){"use strict";n.r(t),n.d(t,"useSolutionComponentSummaries",(function(){return u}));var o=n(3193),r=n(6664),a=n(5895),i=["data"];function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var u=e=>{var t=Object(a.useQueryWithClient)(l(l({},e),{},{query:r.SolutionComponentsQuery,scenarioName:o.TelemetryScenarioNames.powerSettingsFetch,getScenarioCompletionData:e=>({exists:!(null==e||!e.solutionComponents)})})),{data:n}=t;return l(l({},p(t,i)),{},{solutionComponents:null==n?void 0:n.solutionComponents})}},6664:function(e,t,n){"use strict";n.r(t),n.d(t,"SolutionComponentsQuery",(function(){return s}));var o,r=n(3128);var a,i,s=n.n(r)()(o||(a=["\n  query solutionComponents($solutionId: String!, $componentLogicalNames: [String!]!) {\n    solutionComponents(solutionId: $solutionId, componentLogicalNames: $componentLogicalNames) {\n      name\n      displayName\n      objectId\n      componentType\n      componentTypeName\n      componentLogicalName\n      isManaged\n      isManagedName\n      isCustomizable\n      isCustomizablename\n      description\n      objectTypeCode\n      typeName\n      status\n      statusName\n      modifiedOn\n      owner\n      version\n      eventHandler\n      deployment\n      sdkMessage\n      uniqueName\n    }\n  }\n"],i||(i=a.slice(0)),o=Object.freeze(Object.defineProperties(a,{raw:{value:Object.freeze(i)}}))))},6665:function(e,t,n){"use strict";n.r(t),n.d(t,"mapDispatchToProps",(function(){return m})),n.d(t,"mergeProps",(function(){return b})),n.d(t,"SolutionComponentAddRequiredComponentsPanelContainer",(function(){return g}));var o=n(5437),r=n(5487),a=n(5478),i=n(5468),s=n(6666),l=["rootProps"];function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var m=(e,t)=>({onPanelClose:()=>e(i.sharedActions.panelClose({panelType:a.PanelToShowType.AddRequiredComponentsPanel}))}),b=(e,t,n)=>{var{rootProps:o}=n;return p(p(p({},d(n,l)),t),{},{onMount:()=>{}})},g=Object(r.withRootProps)(Object(o.connect)(null,m,b)(s.SolutionComponentAddRequiredComponentsPanel))},6666:function(e,t,n){"use strict";n.r(t),n.d(t,"SolutionComponentAddRequiredComponentsPanel",(function(){return p}));var o=n(4013),r=n(1362),a=n(1697),i=n(1573),s=n(245),l=n(2869);function c(){return(c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}class p extends s.Component{constructor(e){super(e),this.resources=void 0,this._onRequiredComponentsCheckboxChange=(e,t)=>{this.setState({includeRequiredComponents:t})},this.resources=Object(l.getResources)()}render(){var e={messageBarProps:{messageBarType:a.MessageBarType.info,dismissButtonAriaLabel:this.resources.Common.close},onRenderBody:()=>s.createElement(s.Fragment,null,this.resources.Model.Solutions.Components.AddExistingPanel.AddRequiredComponents.message)};return s.createElement(o.Panel,c({},this.props.defaultPanelProps,{onDismiss:()=>{this.props.onPanelClose()},closeButtonAriaLabel:this.resources.Common.close,closeButtonType:o.PanelCloseButtonType.Back,type:i.PanelType.large,headerText:this.resources.Model.Solutions.Components.AddExistingPanel.AddRequiredComponents.title,messageBar:e,footerButtons:[{primary:!0,ariaLabel:this.resources.Model.Solutions.Components.AddExistingPanel.AddRequiredComponents.doneButton,text:this.resources.Model.Solutions.Components.AddExistingPanel.AddRequiredComponents.doneButton,dismissableOnClick:e=>{e()}},{ariaLabel:this.resources.Common.Save.cancel,text:this.resources.Common.Save.cancel,dismissableOnClick:e=>{e()}}]}),s.createElement("div",null,s.createElement(r.Checkbox,{label:this.resources.Model.Solutions.Components.AddExistingPanel.AddRequiredComponents.checkboxLabel,defaultChecked:!0,onChange:this._onRequiredComponentsCheckboxChange,styles:{root:{marginTop:"18px",marginBottom:"18px"}}})))}componentDidMount(){this.props.onMount()}}},6667:function(e,t,n){"use strict";n.r(t),n.d(t,"mapStateToProps",(function(){return b})),n.d(t,"mapDispatchToProps",(function(){return g})),n.d(t,"SolutionComponentAddSubcomponentsPanelContainer",(function(){return y}));var o=n(5437),r=n(5478),a=n(5468),i=n(6668),s=n(5487),l=n(3713),c=["rootProps"];function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function m(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var b=(e,t)=>{var{rootProps:n}=t;return u(u({},m(t,c)),{},{useCdsLiteUX:Object(l.isCdsLiteContext)(n.currentEnvironment)})},g=(e,t)=>({onPanelClose:n=>{e(a.sharedActions.panelClose({panelType:r.PanelToShowType.AddSubcomponentsPanel})),t.onClosePanel&&window.requestAnimationFrame(()=>{t.onClosePanel(n)})}}),y=Object(s.withRootProps)(Object(o.connect)(b,g)(i.SolutionComponentAddSubcomponentsPanel))},6668:function(e,t,n){"use strict";n.r(t),n.d(t,"SolutionComponentAddSubcomponentsPanel",(function(){return h}));var o=n(4013),r=n(1697),a=n(1573),i=n(1709),s=n(245),l=n(2867),c=n(2869),p=n(2880),u=n(6607),d=n(6669),m=n(5793),b=n(6671),g=n(6673),y=n(5611),S=n(2871);function f(){return(f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}class h extends s.Component{constructor(e){super(e),this.resources=void 0,this.isRefreshNeeded=void 0,this.initialSubcomponentSelection=void 0,this.onSubcomponentSearchFilterUpdate=e=>{this.setState({searchFilterForSubcomponents:e})},this.onSubcomponentChange=e=>{this.setState({isSubcomponentSelected:this.isSubcomponentSelected()})},this.resources=Object(c.getResources)(),this.isRefreshNeeded=!1;var t=this.props.existingSelection||Object(m.createSelectionsForSubcomponentTypes)(this.onSubcomponentChange);this.initialSubcomponentSelection=h.getInitialSubcomponentSelection(t),this.state={searchFilterForSubcomponents:"",selectedSubcomponentTypeOnPivot:"fields",subcomponentSelection:t,isSubcomponentSelected:!!this.props.existingSelection}}render(){var e=Object(u.getSearchBoxProps)(this.onSubcomponentSearchFilterUpdate,Object(p.formatResourceString)(this.resources.Model.Solutions.Components.search,Object(m.getSubcomponentTypeString)(this.state.selectedSubcomponentTypeOnPivot,this.props.useCdsLiteUX).toLowerCase()),this.state.searchFilterForSubcomponents),t=null;this.props.displayErrorMessage&&(t={messageBarProps:{messageBarType:r.MessageBarType.error},onRenderBody:()=>s.createElement("span",null,this.props.displayErrorMessage)});var n=this.props.componentDisplayName||this.resources.Common.Loading.ellipses,l=Object.keys(m.SubcomponentTypes).filter(e=>"commands"!==e||S.featureGates.enablePortalCommands);return s.createElement(o.Panel,f({},this.props.defaultPanelProps,{onDismiss:()=>{this.props.onPanelClose(this.isRefreshNeeded)},closeButtonAriaLabel:this.resources.Common.close,closeButtonType:o.PanelCloseButtonType.Back,type:a.PanelType.large,onRenderSubHeader:()=>s.createElement(b.SolutionComponentAddSubcomponentsSubHeader,e),headerText:n,headerLeftButtonProps:{ariaLabel:this.resources.ImportExport.Export.Back.Button.label,onClick:()=>this.props.onPanelClose(this.isRefreshNeeded)},messageBar:t,footerButtons:[{primary:!0,dismissableOnClick:e=>{this.isRefreshNeeded=!0,e(),this.props.onSelectionConfirmed(this.state.subcomponentSelection)},disabled:!this.state.isSubcomponentSelected,ariaLabel:this.resources.Common.add,text:this.resources.Common.add},{dismissableOnClick:e=>{e(),h.setSubcomponentSelection(this.initialSubcomponentSelection,this.state.subcomponentSelection),this.props.onSelectionConfirmed(this.state.subcomponentSelection)},ariaLabel:this.resources.Common.Save.cancel,text:this.resources.Common.Save.cancel}]}),s.createElement("div",{className:"add-subcomponents-panel-pivots"},s.createElement(i.Pivot,{defaultSelectedKey:this.props.defaultSelectedKey||l[0],onLinkClick:e=>this.onSubcomponentPivotChange(e)},l.map(e=>{var t,n=this.state.subcomponentSelection.get(e),o={solutionId:this.props.solutionId,componentName:this.props.componentName,selection:n,cdsComponentType:m.SubcomponentTypes[e],searchFilter:this.state.searchFilterForSubcomponents,uniqueId:e};return t=m.SubcomponentTypes[e].logicalName===y.StandardSolutionComponentTypes.EntityRelationship.logicalName?s.createElement(g.RelationshipSubcomponentListContainer,o):s.createElement(d.SubComponentListContainer,o),s.createElement(i.PivotItem,{key:e,linkText:Object(m.getSubcomponentTypeString)(e,this.props.useCdsLiteUX),itemKey:e},t)}))))}onSubcomponentPivotChange(e){var t=e.props.itemKey;this.setState({selectedSubcomponentTypeOnPivot:t})}static getInitialSubcomponentSelection(e){var t=Object(l.Map)();return e.forEach((e,n)=>{t.set(n,e.getSelection().map(e=>e.key))}),t}static setSubcomponentSelection(e,t){t.forEach((t,n)=>{var o=e.get(n);t.getItems().forEach(e=>{var n=o&&o.findIndex(t=>t===e.key)>-1;t.setKeySelected(e.key,n,!1)})})}isSubcomponentSelected(){return this.state.subcomponentSelection.some(e=>e.getSelectedCount()>0)}}},6669:function(e,t,n){"use strict";n.r(t),n.d(t,"mapStateToProps",(function(){return v})),n.d(t,"mapDispatchToProps",(function(){return E})),n.d(t,"mergeProps",(function(){return T})),n.d(t,"SubComponentListContainer",(function(){return j}));var o=n(5437),r=n(545),a=n(5607),i=n(3713),s=n(5686),l=n(5810),c=n(6670),p=n(5487),u=n(5582),d=n(5615),m=n(5629),b=n(5611),g=n(5609),y=n(922),S=["isSubcomponentCacheComplete"];function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){O(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function O(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function C(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var v=(e,t)=>{var n=Object(u.currentEnvironmentIdSelector)(t),o=Object(l.solutionComponentListNotInSolutionCacheComplete)(e,t.solutionId,n,t.cdsComponentType,t.componentName),r=Object(l.solutionComponentListNotInSolutionSelector)(e,t.solutionId,n,t.cdsComponentType,t.componentName),a=Object(l.hasNextLinkSolutionComponentNotInSolution)(e,t.solutionId,n,[t.cdsComponentType],t.componentName);return{solutionSubcomponents:P(r||[],t.cdsComponentType,t.t),isSubcomponentCacheComplete:o,loadProgress:[Object(m.toLoadingState)(o)],hasNextLink:a,cdsComponentType:t.cdsComponentType}},P=Object(r.memoizeFunction)((e,t,n)=>e.map(e=>{var o,r=Object(i.getSolutionComponentObjectId)(e);return Object(g.areSameSolutionComponentType)(t,b.StandardSolutionComponentTypes.EntityRelationship)?(o={key:r,objectId:r,name:Object(a.getSolutionComponentName)(e),displayName:Object(a.getSolutionComponentDisplayName)(e),customizable:Object(a.getSolutionComponentIsCustomizable)(e),fieldType:Object(a.getSolutionComponentFieldType)(e),state:Object(a.getSolutionComponentManagedStateName)(e),subcomponentType:t,relationshipDirection:Object(a.getSolutionComponentSubType)(e),primaryEntity:Object(a.getSolutionComponentPrimaryEntity)(e),relatedEntity:Object(a.getSolutionComponentRelatedEntity)(e),typeofBehavior:Object(a.getSolutionComponentType)(e),fieldName:Object(a.getSolutionComponentRelatedEntityAttribute)(e),objectTypeCode:Object(a.getSolutionComponentObjectTypeCode)(e)}).filterOn=[o.name,o.state,o.relationshipDirection,o.primaryEntity,o.relatedEntity,o.typeofBehavior,o.fieldName]:(o={key:r,objectId:r,displayName:Object(a.getSolutionComponentDisplayName)(e),name:Object(a.getSolutionComponentName)(e),customizable:Object(a.getSolutionComponentIsCustomizable)(e),fieldType:Object(a.getSolutionComponentFieldType)(e),state:Object(a.getSolutionComponentManagedStateName)(e),description:Object(a.getSolutionComponentDescription)(e),statusName:Object(a.getSolutionComponentStatusName)(e),statusText:Object(a.getSolutionComponentStatusText)(e,n),subType:Object(a.getSolutionComponentSubTypeForView)(e,n),typeName:Object(a.getSolutionComponentType)(e),subcomponentType:t,objectTypeCode:Object(a.getSolutionComponentObjectTypeCode)(e)}).filterOn=[o.displayName,o.name,o.state,o.fieldType],o})),E=(e,t)=>({fetchSubcomponents:n=>e(Object(s.fetchSolutionComponentsNotInSolutionRequest)({solutionId:t.solutionId,componentTypes:[t.cdsComponentType],entityName:t.componentName,searchFilter:t.searchFilter,applyCustomizationFilter:Object(d.isCustomizationFilterApplicable)(t.cdsComponentType),orderBy:n})),pageSubcomponents:n=>e(Object(s.pageSolutionComponentsNotInSolution)({solutionId:t.solutionId,componentTypes:[t.cdsComponentType],entityName:t.componentName,searchFilter:t.searchFilter,applyCustomizationFilter:Object(d.isCustomizationFilterApplicable)(t.cdsComponentType),orderBy:n}))}),T=(e,t,n)=>{var{isSubcomponentCacheComplete:o}=e,r=C(e,S),{fetchSubcomponents:a}=t,{selection:i,searchFilter:s,uniqueId:l}=n;return h(h(h({selection:i,searchFilter:s,uniqueId:l,onMount:()=>{a(void 0)}},r),t),{},{t:n.t,tReady:n.tReady})},j=Object(y.translateService)("PowerappsPortal")(Object(p.withRootProps)(Object(o.connect)(v,E,T)(c.SolutionSubcomponentList)))},6670:function(e,t,n){"use strict";n.r(t),n.d(t,"SolutionSubcomponentList",(function(){return v}));var o=n(3064),r=n(3161),a=n(1471),i=n(1473),s=n(687),l=n(245),c=n(5628),p=n(5629),u=n(2879),d=n(2869),m=n(2880),b=n(5634),g=n(5611),y=n(5609),S=n(5697),f=n(2812);function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){C(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function C(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class v extends l.Component{constructor(e){super(e),this.resources=void 0,this.columns=void 0,this.selectedListItems=void 0,this.resources=Object(d.getResources)(),this.selectedListItems=[],this.state={orderBy:void 0,logicalName:void 0,selectionHasChanged:!1,itemSelection:new i.Selection({onSelectionChanged:()=>{var e=this.state.itemSelection;this.setState({itemSelection:e,selectionHasChanged:!0})}})},this.columns=this.buildColumns()}componentDidMount(){this.props.onMount();var e=this.state.itemSelection.getSelection(),t=this.props.selection.getSelection();if(this.props.selection.count>0&&!Object(f.isEqual)(e,t)){var n=[...this.state.itemSelection.getItems(),...this.props.selection.getItems()];for(var o of(this.state.itemSelection.setItems(n),this.state.itemSelection.setChangeEvents(!1,!0),t||[]))this.state.itemSelection.setKeySelected(o.key,!0,!1);this.state.itemSelection.setChangeEvents(!0,!0)}}static getDerivedStateFromProps(e,t){return e.solutionSubcomponents.length>0&&e.solutionSubcomponents[0].subcomponentType.logicalName!==t.logicalName?{logicalName:e.solutionSubcomponents[0].subcomponentType.logicalName}:null}componentDidUpdate(e){if(this.props.searchFilter!==e.searchFilter&&this.props.fetchSubcomponents(this.state.orderBy),this.state.selectionHasChanged){var t=[...this.props.selection.getItems(),...this.selectedListItems];for(var n of(this.props.selection.setItems(t),this.props.selection.setChangeEvents(!1,!0),this.selectedListItems||[]))this.props.selection.setKeySelected(n.key,!0,!1);this.props.selection.setChangeEvents(!0,!1),this.setState({selectionHasChanged:!1})}}render(){var e;return(null===(e=this.selectedListItems)||void 0===e?void 0:e.length)>0&&this.addPreviouslySelectedItems(),l.createElement(S.SaveSolutionSelection,{selection:this.state.itemSelection,items:this.props.solutionSubcomponents,updateComponentsSelected:e=>{this.selectedListItems=e}},l.createElement(o.DetailsList,{isLoading:Object(p.isLoading)(this.props.loadProgress),items:this.props.solutionSubcomponents,columns:this.columns,renderOnEmpty:()=>{var e=this.getPropsOnEmpty();return l.createElement(r.EmptyState,e)},filter:this.props.searchFilter,renderOnEmptySearch:()=>{var e=this.getPropsOnEmptySearch();return l.createElement(r.EmptyState,e)},selectionMode:i.SelectionMode.multiple,constrainMode:a.ConstrainMode.unconstrained,selection:this.state.itemSelection,layoutMode:a.DetailsListLayoutMode.justified,setKey:this.props.uniqueId,getKey:e=>e.key,isHeaderVisible:!0,filterAnnouncement:e=>Object(m.formatResourceString)(this.resources.Common.Search.Results,e),loadMoreButtonProps:this.getLoadMoreButtonProps(),showLoadMoreButton:this.props.hasNextLink}))}getRequiredColumnsHelper(e){var t=[];return Object(y.areSameSolutionComponentType)(e,g.StandardSolutionComponentTypes.Attribute)?t.push("displayName","name","subType","customizable","state"):Object(y.areSameSolutionComponentType)(e,g.StandardSolutionComponentTypes.BusinessRule)?t.push("displayName","statusText","state"):Object(y.areSameSolutionComponentType)(e,g.StandardSolutionComponentTypes.SavedQuery)?t.push("displayName","subType","state","description"):Object(y.areSameSolutionComponentType)(e,g.StandardSolutionComponentTypes.FormsOnly)?t.push("displayName","typeName","state","description"):Object(y.areSameSolutionComponentType)(e,g.StandardSolutionComponentTypes.AllDashboards)||Object(y.areSameSolutionComponentType)(e,g.StandardSolutionComponentTypes.SavedQueryVisualization)?t.push("displayName","state","description"):Object(y.areSameSolutionComponentType)(e,g.StandardSolutionComponentTypes.DisplayString)?t.push("name","state"):Object(y.areSameSolutionComponentType)(e,g.StandardSolutionComponentTypes.EntityKey)?t.push("displayName","name","statusName","state"):Object(y.areSameSolutionComponentType)(e,g.StandardSolutionComponentTypes.Commands)&&t.push("name","statusName","state"),t}getColumnHeaderName(){var e="";return Object(y.areSameSolutionComponentType)(this.props.cdsComponentType,g.StandardSolutionComponentTypes.Attribute)?e=this.props.t("Model.Solutions.Components.Header.dataType"):Object(y.areSameSolutionComponentType)(this.props.cdsComponentType,g.StandardSolutionComponentTypes.SavedQuery)&&(e=this.props.t("Model.Solutions.Components.Header.type")),e}buildColumns(){var e=this.getRequiredColumnsHelper(this.props.cdsComponentType);return[O(O({fieldName:"displayName",name:this.props.t("Model.Solutions.Components.Header.displayName"),key:"displayName",minWidth:200},this.getColumnSortProperties("msdyn_displayname")),{},{onRender:this.renderWithDefaultValue,isResizable:!0}),O(O({fieldName:"statusText",name:this.props.t("Model.Solutions.Components.Header.status"),key:"statusText",minWidth:200},this.getColumnSortProperties("msdyn_status")),{},{onRender:this.renderWithDefaultValue,isResizable:!0}),O(O({fieldName:"name",name:this.props.t("Model.Solutions.Components.Header.systemName"),key:"name",minWidth:200},this.getColumnSortProperties("msdyn_name")),{},{onRender:this.renderWithDefaultValue,isResizable:!0}),O(O({fieldName:"subType",name:this.getColumnHeaderName(),key:"subType",minWidth:200},this.getColumnSortProperties("msdyn_subtype")),{},{onRender:this.renderWithDefaultValue,isResizable:!0}),{fieldName:"customizable",name:this.props.t("Model.Solutions.Components.Header.customizable"),key:"customizable",minWidth:150,onRender:this.renderCheckMark,isResizable:!0},O(O({fieldName:"typeName",name:this.props.t("Model.Solutions.Components.Header.formType"),key:"typeName",minWidth:150},this.getColumnSortProperties("msdyn_typename")),{},{onRender:this.renderWithDefaultValue,isResizable:!0}),O(O({fieldName:"statusName",name:this.props.t("Model.Solutions.Components.Header.status"),key:"statusName",minWidth:200},this.getColumnSortProperties("msdyn_statusname")),{},{onRender:this.renderWithDefaultValue,isResizable:!0}),O(O({fieldName:"state",name:this.props.t("Model.Solutions.Components.Header.state"),key:"state",minWidth:150},this.getColumnSortProperties("msdyn_ismanagedname")),{},{onRender:this.renderWithDefaultValue,isResizable:!0}),O(O({fieldName:"description",name:this.props.t("Model.Solutions.Components.Header.description"),key:"description",minWidth:200},this.getColumnSortProperties("msdyn_description")),{},{onRender:this.renderWithDefaultValue,isResizable:!0})].filter(t=>e.includes(t.key))}getLoadMoreButtonProps(){return Object(p.isLoading)(this.props.loadProgress)?{text:Object(m.formatResourceString)(this.resources.Model.Solutions.Components.List.loadingMoreItems,b.PAGESIZE),disabled:!0}:{text:Object(m.formatResourceString)(this.resources.Model.Solutions.Components.List.loadMoreItems,b.PAGESIZE),onClick:()=>{this.props.pageSubcomponents(this.state.orderBy)}}}onColumnMenuItemsClick(e){this.props.fetchSubcomponents(e),this.setState({orderBy:e})}getColumnSortProperties(e){return{columnMenuItems:[{key:"".concat(e,":ascending"),text:this.resources.Model.Solutions.Components.Header.ascending,onClick:()=>this.onColumnMenuItemsClick({column:e,order:"asc"})},{key:"".concat(e,":descending"),text:this.resources.Model.Solutions.Components.Header.descending,onClick:()=>this.onColumnMenuItemsClick({column:e,order:"desc"})}]}}getPropsOnEmpty(){return{icon:u.fabricIcons.DocumentSet,className:"solution-components-list-empty-message",primaryMessage:this.resources.Model.Solutions.SubComponents.NoItems.message,secondaryMessage:[this.resources.Model.Solutions.SubComponents.NoItems.description],maxWidth:c.emptyStateMaxWidth}}getPropsOnEmptySearch(){return{icon:u.fabricIcons.DocumentSet,className:"solution-components-list-empty-message",primaryMessage:this.resources.Common.Search.NoMatch.title,secondaryMessage:[this.resources.Common.Search.NoMatch.message],maxWidth:c.emptyStateMaxWidth}}renderWithDefaultValue(e,t,n){return e&&n&&e[n.fieldName]||"-"}renderCheckMark(e,t,n){return e&&n&&e[n.fieldName]?l.createElement(s.Icon,{iconName:"CheckMark"}):"-"}addPreviouslySelectedItems(){var e;null===(e=this.selectedListItems)||void 0===e||e.forEach(e=>{var t;null!==(t=this.props.solutionSubcomponents)&&void 0!==t&&t.find(t=>t.key===e.key)||this.props.solutionSubcomponents.push(e)})}}},6671:function(e,t,n){"use strict";n.r(t),n.d(t,"SolutionComponentAddSubcomponentsSubHeader",(function(){return l}));var o=n(1252),r=n(245),a=n(2869),i=n(6672);function s(){return(s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}var l=e=>r.createElement("div",{className:i.solutionComponentAddSubComponentsStyleClasses.addSubComponentSubHeader},r.createElement("div",{className:"add-subcomponents-subtitle"},Object(a.getResources)().Model.Solutions.Components.AddExistingPanel.AddSubComponents.subtitle),r.createElement(o.SearchBox,s({className:"subheader-search-box"},e)))},6672:function(e,t,n){"use strict";n.r(t),n.d(t,"solutionComponentAddSubComponentsStyleClasses",(function(){return r}));var o=n(719),r=Object(o.mergeStyleSets)({addSubComponentSubHeader:["add-subcomponent-subheader",{display:"flex",justifyContent:"center",alignItems:"center",selectors:{"> *":{flexGrow:1},".subheader-search-box":{maxWidth:"172px",marginRight:"12px"}}}]})},6673:function(e,t,n){"use strict";n.r(t),n.d(t,"mapStateToProps",(function(){return C})),n.d(t,"mapDispatchToProps",(function(){return P})),n.d(t,"mergeProps",(function(){return E})),n.d(t,"RelationshipSubcomponentListContainer",(function(){return T}));var o=n(5437),r=n(545),a=n(5607),i=n(3713),s=n(5686),l=n(5810),c=n(5487),p=n(5582),u=n(5615),d=n(5629),m=n(6674),b=n(5611),g=n(5609),y=["isSubcomponentCacheComplete"];function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(Object(n),!0).forEach((function(t){h(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function O(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var C=(e,t)=>{var n=Object(p.currentEnvironmentIdSelector)(t),o=Object(l.solutionComponentListNotInSolutionCacheComplete)(e,t.solutionId,n,t.cdsComponentType,t.componentName),r=Object(l.solutionComponentListNotInSolutionSelector)(e,t.solutionId,n,t.cdsComponentType,t.componentName),a=Object(l.hasNextLinkSolutionComponentNotInSolution)(e,t.solutionId,n,[t.cdsComponentType],t.componentName);return{solutionSubcomponents:v(r||[],t.cdsComponentType),isSubcomponentCacheComplete:o,loadProgress:[Object(d.toLoadingState)(o)],hasNextLink:a}},v=Object(r.memoizeFunction)((e,t)=>e.map(e=>{var n,o=Object(i.getSolutionComponentObjectId)(e);return Object(g.areSameSolutionComponentType)(t,b.StandardSolutionComponentTypes.EntityRelationship)?(n={key:o,objectId:o,name:Object(a.getSolutionComponentName)(e),displayName:Object(a.getSolutionComponentDisplayName)(e),customizable:Object(a.getSolutionComponentIsCustomizable)(e),fieldType:Object(a.getSolutionComponentFieldType)(e),state:Object(a.getSolutionComponentManagedStateName)(e),subcomponentType:t,relationshipDirection:Object(a.getSolutionComponentSubType)(e),primaryEntity:Object(a.getSolutionComponentPrimaryEntity)(e),relatedEntity:Object(a.getSolutionComponentRelatedEntity)(e),typeofBehavior:Object(a.getSolutionComponentType)(e),fieldName:Object(a.getSolutionComponentRelatedEntityAttribute)(e)}).filterOn=[n.name,n.state,n.relationshipDirection,n.primaryEntity,n.relatedEntity,n.typeofBehavior,n.fieldName]:(n={key:o,objectId:o,displayName:Object(a.getSolutionComponentDisplayName)(e),name:Object(a.getSolutionComponentName)(e),customizable:Object(a.getSolutionComponentIsCustomizable)(e),fieldType:Object(a.getSolutionComponentFieldType)(e),state:Object(a.getSolutionComponentManagedStateName)(e),subcomponentType:t}).filterOn=[n.displayName,n.name,n.state,n.fieldType],n})),P=(e,t)=>({fetchSubcomponents:n=>e(Object(s.fetchSolutionComponentsNotInSolutionRequest)({solutionId:t.solutionId,componentTypes:[t.cdsComponentType],entityName:t.componentName,searchFilter:t.searchFilter,applyCustomizationFilter:Object(u.isCustomizationFilterApplicable)(t.cdsComponentType),orderBy:n})),pageSubcomponents:n=>e(Object(s.pageSolutionComponentsNotInSolution)({solutionId:t.solutionId,componentTypes:[t.cdsComponentType],entityName:t.componentName,searchFilter:t.searchFilter,applyCustomizationFilter:Object(u.isCustomizationFilterApplicable)(t.cdsComponentType),orderBy:n}))}),E=(e,t,n)=>{var{isSubcomponentCacheComplete:o}=e,r=O(e,y),{fetchSubcomponents:a}=t,{selection:i,searchFilter:s,uniqueId:l}=n;return f(f({selection:i,searchFilter:s,uniqueId:l,onMount:()=>{a(void 0)}},r),t)},T=Object(c.withRootProps)(Object(o.connect)(C,P,E)(m.RelationshipSubcomponentList))},6674:function(e,t,n){"use strict";n.r(t),n.d(t,"RelationshipSubcomponentList",(function(){return h}));var o=n(3064),r=n(3161),a=n(1471),i=n(1473),s=n(245),l=n(5628),c=n(5629),p=n(2879),u=n(2869),d=n(2880),m=n(5634),b=n(2812),g=n(5697);function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){f(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class h extends s.Component{constructor(e){super(e),this.resources=void 0,this.columns=void 0,this.selectedListItems=void 0,this.resources=Object(u.getResources)(),this.selectedListItems=[],this.state={orderBy:void 0,selectionHasChanged:!1,itemSelection:new i.Selection({onSelectionChanged:()=>{var e=this.state.itemSelection;this.setState({itemSelection:e,selectionHasChanged:!0})}})},this.columns=this.buildColumns()}componentDidMount(){this.props.onMount();var e=this.state.itemSelection.getSelection(),t=this.props.selection.getSelection();if(this.props.selection.count>0&&!Object(b.isEqual)(e,t)){var n=[...this.state.itemSelection.getItems(),...this.props.selection.getItems()];for(var o of(this.state.itemSelection.setItems(n),this.state.itemSelection.setChangeEvents(!1,!0),t||[]))this.state.itemSelection.setKeySelected(o.key,!0,!1);this.state.itemSelection.setChangeEvents(!0,!0)}}componentDidUpdate(e){if(this.props.searchFilter!==e.searchFilter&&this.props.fetchSubcomponents(this.state.orderBy),this.state.selectionHasChanged){var t=[...this.props.selection.getItems(),...this.selectedListItems];for(var n of(this.props.selection.setItems(t),this.props.selection.setChangeEvents(!1,!0),this.selectedListItems||[]))this.props.selection.setKeySelected(n.key,!0,!1);this.props.selection.setChangeEvents(!0,!1),this.setState({selectionHasChanged:!1})}}render(){var e;return(null===(e=this.selectedListItems)||void 0===e?void 0:e.length)>0&&this.addPreviouslySelectedItems(),s.createElement(g.SaveSolutionSelection,{selection:this.state.itemSelection,items:this.props.solutionSubcomponents,updateComponentsSelected:e=>{this.selectedListItems=e}},s.createElement(o.DetailsList,{isLoading:Object(c.isLoading)(this.props.loadProgress),items:this.props.solutionSubcomponents,columns:this.columns,renderOnEmpty:()=>{var e=this.getPropsOnEmpty();return s.createElement(r.EmptyState,e)},filter:this.props.searchFilter,renderOnEmptySearch:()=>{var e=this.getPropsOnEmptySearch();return s.createElement(r.EmptyState,e)},selectionMode:i.SelectionMode.multiple,setKey:this.props.uniqueId,getKey:e=>e.key,constrainMode:a.ConstrainMode.unconstrained,selection:this.state.itemSelection,layoutMode:a.DetailsListLayoutMode.justified,isHeaderVisible:!0,filterAnnouncement:e=>Object(d.formatResourceString)(this.resources.Common.Search.Results,e),loadMoreButtonProps:this.getLoadMoreButtonProps(),showLoadMoreButton:this.props.hasNextLink}))}buildColumns(){return[S(S({fieldName:"name",name:this.resources.Model.Solutions.Components.Header.systemName,key:"name",minWidth:200},this.getColumnSortProperties("msdyn_name")),{},{onRender:this.renderWithDefaultValue,isResizable:!0}),S(S({fieldName:"relationshipDirection",name:this.resources.Model.Solutions.Components.Header.relationshipDirection,key:"relationshipDirection",minWidth:200},this.getColumnSortProperties("msdyn_subtype")),{},{onRender:this.renderWithDefaultValue,isResizable:!0}),S(S({fieldName:"primaryEntity",name:this.resources.Model.Solutions.Components.Header.primaryEntity,key:"primaryEntity",minWidth:200},this.getColumnSortProperties("msdyn_primaryentityname")),{},{onRender:this.renderWithDefaultValue,isResizable:!0}),S(S({fieldName:"relatedEntity",name:this.resources.Model.Solutions.Components.Header.relatedEntity,key:"relatedEntity",minWidth:200},this.getColumnSortProperties("msdyn_relatedentity")),{},{onRender:this.renderWithDefaultValue,isResizable:!0}),S(S({fieldName:"typeofBehavior",name:this.resources.Model.Solutions.Components.Header.typeofBehavior,key:"typeofBehavior",minWidth:200},this.getColumnSortProperties("msdyn_name")),{},{onRender:this.renderWithDefaultValue,isResizable:!0}),S(S({fieldName:"fieldName",name:this.resources.Model.Solutions.Components.Header.fieldName,key:"fieldName",minWidth:200},this.getColumnSortProperties("msdyn_relatedentityattribute")),{},{onRender:this.renderWithDefaultValue,isResizable:!0}),S(S({fieldName:"state",name:this.resources.Model.Solutions.Components.Header.state,key:"state",minWidth:200},this.getColumnSortProperties("msdyn_ismanagedname")),{},{onRender:this.renderWithDefaultValue,isResizable:!0})]}getLoadMoreButtonProps(){return Object(c.isLoading)(this.props.loadProgress)?{text:Object(d.formatResourceString)(this.resources.Model.Solutions.Components.List.loadingMoreItems,m.PAGESIZE),disabled:!0}:{text:Object(d.formatResourceString)(this.resources.Model.Solutions.Components.List.loadMoreItems,m.PAGESIZE),onClick:()=>{this.props.pageSubcomponents(this.state.orderBy)}}}onColumnMenuItemsClick(e){this.props.fetchSubcomponents(e),this.setState({orderBy:e})}getColumnSortProperties(e){return{columnMenuItems:[{key:"".concat(e,":ascending"),text:this.resources.Model.Solutions.Components.Header.ascending,onClick:()=>this.onColumnMenuItemsClick({column:e,order:"asc"})},{key:"".concat(e,":descending"),text:this.resources.Model.Solutions.Components.Header.descending,onClick:()=>this.onColumnMenuItemsClick({column:e,order:"desc"})}]}}getPropsOnEmpty(){return{icon:p.fabricIcons.DocumentSet,className:"solution-components-list-empty-message",primaryMessage:this.resources.Model.Solutions.SubComponents.NoItems.message,secondaryMessage:[this.resources.Model.Solutions.SubComponents.NoItems.description],maxWidth:l.emptyStateMaxWidth}}getPropsOnEmptySearch(){return{icon:p.fabricIcons.DocumentSet,className:"solution-components-list-empty-message",primaryMessage:this.resources.Common.Search.NoMatch.title,secondaryMessage:[this.resources.Common.Search.NoMatch.message],maxWidth:l.emptyStateMaxWidth}}renderWithDefaultValue(e,t,n){return e&&n&&e[n.fieldName]||"-"}addPreviouslySelectedItems(){var e;null===(e=this.selectedListItems)||void 0===e||e.forEach(e=>{var t;null!==(t=this.props.solutionSubcomponents)&&void 0!==t&&t.find(t=>t.key===e.key)||this.props.solutionSubcomponents.push(e)})}}},6675:function(e,t,n){"use strict";n.r(t),n.d(t,"mapStateToProps",(function(){return v})),n.d(t,"mapDispatchToProps",(function(){return P})),n.d(t,"mergeProps",(function(){return E})),n.d(t,"SolutionExportPanelContainer",(function(){return T}));var o=n(5437),r=n(2886),a=n(5478),i=n(2869),s=n(2880),l=n(5630),c=n(5690),p=n(5691),u=n(5468),d=n(5626),m=n(5687),b=n(6676),g=n(5487),y=n(5582),S=n(5583),f=n(3713);function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){C(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function C(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var v=(e,t)=>{var n=Object(y.currentEnvironmentIdSelector)(t),o=d.aadUserSelector(e),a=e=>e===l.id,l=p.solutionSelector(e,t.solutionId),c=t.rootProps.currentEnvironment,u=p.solutionsBeingChecked(e,n).some(a),m=p.solutionsBeingCanceled(e,n).some(a),b=l.solutionCheckerResults&&l.solutionCheckerResults.lastRun&&l.solutionCheckerResults.lastRun.createdon?new Date(l.solutionCheckerResults.lastRun.createdon):null,g=p.analysisRequestsWithError(e,n).some(a),S=p.downloadResultsWithError(e,n).some(a),f=p.analysisCancelWithError(e,n).some(a),h=Object(i.getResources)();return{solution:l,publishCustomizationsResponse:p.publishCustomizationsStatus(e),isSolutionCheckerInstalled:p.isSolutionCheckerInstalled(e),isSolutionCheckerRunning:u||m||Object(r.isSolutionCheckerRunning)(l),solutionCheckerIssueFoundCount:p.solutionCheckerSummary(e,c.id,l&&l.id,b),analysisErrorMessage:g&&h?Object(s.formatResourceString)(h.Model.Solutions.MessageBar.analysisRequest,Object(r.getSolutionDisplayName)(l)):"",downloadErrorMessage:S&&h?Object(s.formatResourceString)(h.Model.Solutions.MessageBar.download,Object(r.getSolutionDisplayName)(l)):"",cancelAnalysisErrorMessage:f&&h?Object(s.formatResourceString)(h.Model.Solutions.MessageBar.analysisCancel,Object(r.getSolutionDisplayName)(l)):"",installProvisionErrorMessage:p.isErrorSolutionCheckerInstall(e,n)?h.Model.Solutions.MessageBar.installProvision:"",updateSolutionErrorMessage:p.updateSolutionStatus(e).message,solutionExportPanelResponse:p.solutionExportPanelResponse(e),solutionCheckerResult:p.solutionCheckerResult(e,l.id),isSolutionCheckerRunRequestedbyUser:Object(r.isSolutionCheckerRunRequestedbyUser)(l,o.objectId),isSolutionCanceling:m,isSolutionBeingChecked:u}},P=(e,t)=>{var{navigate:n}=t,o=Object(y.currentEnvironmentIdSelector)(t);return{cancelAnalysis:t=>{e(Object(c.solutionCheckerCancel)({environmentId:o,solution:t}))},onDismiss:()=>{t.onPanelClose&&t.onPanelClose(),e(u.sharedActions.panelClose({panelType:a.PanelToShowType.SolutionExportPanel})),e(c.updateSolutionClear())},onPublishAllClick:()=>e(Object(l.logAction)(c.publishAllCustomizations({originatedFromPanel:!0}),m.SolutionExportPanelCommandEvents.Publish.eventName)),clearPublishCustomizationMessage:()=>{e({type:c.SolutionsActionTypes.PUBLISH_ALL_CUSTOMIZATIONS_CLEAR})},openNewTab:t=>{e(Object(l.logAction)(u.sharedActions.openNewTab({uri:t}),m.SolutionExportPanelCommandEvents.LearnPublishClicked.eventName))},onSolutionCheckerRunClick:t=>e(Object(l.logAction)(c.solutionCheckerRun({solution:t,environmentId:o}),m.SolutionExportPanelCommandEvents.SolutionCheckRun.eventName)),onSolutionCheckerDownloadClick:t=>e(Object(l.logAction)(c.solutionCheckerDownload({solution:t,environmentId:o}),m.SolutionExportPanelCommandEvents.SolutionCheckDownload.eventName)),onSolutionCheckerViewResultsClick:t=>e(Object(l.logAction)(c.openSolutionCheckerViewResultsDialog({solution:t,navigate:n}),m.SolutionExportPanelCommandEvents.SolutionCheckViewResultsDialog.eventName)),onSolutionCheckerInstall:()=>{e(Object(l.logAction)(c.solutionCheckerInstallProvisionRequest({environmentId:o}),m.SolutionExportPanelCommandEvents.SolutionCheckInstall.eventName))},onFetchSolutionCheckerResultsSummary:t=>e(Object(l.logAction)(c.solutionCheckerFetchIssueSummary({solution:t}),m.SolutionExportPanelCommandEvents.SolutionCheckIssueSummary.eventName)),exportSolution:(t,n,o)=>{e(Object(l.logAction)(c.exportSolutionRequest({solution:t,asManaged:n,version:o}),m.SolutionCommandEvents.Export.eventName))}}},E=(e,t,n)=>{var o,r;return O(O(O({},e),t),{},{defaultPanelProps:n.defaultPanelProps,currentUXContext:Object(f.getUXContext)(null===(o=n.rootProps.currentEnvironment)||void 0===o||null===(r=o.properties)||void 0===r?void 0:r.environmentSku)})},T=Object(S.withNavigation)(Object(g.withRootProps)(Object(o.connect)(v,P,E)(b.SolutionExportPanel)))},6679:function(e,t,n){"use strict";n.r(t),n.d(t,"SolutionFeedbackPanel",(function(){return b}));var o=n(245),r=n(5437),a=n(5468),i=n(5478),s=["onDismiss"];function l(){return(l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var m=o.lazy(()=>n.e(433).then(n.bind(null,29573)).then(e=>({default:e.CESExitFeedbackDialog}))),b=e=>{var{onDismiss:t}=e,n=d(e,s),c=Object(r.useDispatch)(),u=o.useCallback(()=>{void 0!==t&&t(),c(a.sharedActions.panelClose({panelType:i.PanelToShowType.FeedbackPanel}))},[c,t]);return o.createElement(o.Suspense,{fallback:null},o.createElement(m,l({},n,{hidden:!1,surveyName:"ExitFeedback",teamName:"PowerApps",eventName:"SwitchToClassic",context:p({Area:"Solution Explorer"},e.context),onDismiss:u})))}},6680:function(e,t,n){"use strict";n.r(t),n.d(t,"PivotKey",(function(){return o})),n.d(t,"mapErrorXmlToDependencies",(function(){return N})),n.d(t,"SolutionImportDependenciesPanel",(function(){return M}));var o,r=n(1089),a=n(1573),i=n(245),s=n(5437),l=n(5468),c=n(5478),p=n(922),u=n(4064),d=n(1709),m=n(1473),b=n(1471),g=n(6681),y=n(684),S=n(217),f=n(2885),h=n(6682),O=n(6375),C=n(6683),v=n(6684),P=n(1201),E=n(900),T=n(719),j=n(1697);function A(){return(A=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}function R(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function I(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?R(Object(n),!0).forEach((function(t){w(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):R(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function w(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(e){e.ManagedSolutions="Managed solutions",e.Objects="Objects"}(o||(o={}));var D=e=>{var t={minWidth:40,maxWidth:54,isResizable:!0,isCollapsable:!1,isMultiline:!1,isPadded:!0,sortAscendingAriaLabel:e("Common.Sorting.ascending"),sortDescendingAriaLabel:e("Common.Sorting.descending")};return[I(I({},t),{},{key:"displayName",minWidth:100,maxWidth:150,name:e("Model.Solutions.SolutionImportDependencies.DisplayName"),fieldName:"displayName"}),I(I({},t),{},{key:"nameid",minWidth:100,maxWidth:150,name:e("Model.Solutions.SolutionImportDependencies.NameId"),fieldName:"nameId"}),I(I({},t),{},{key:"requiredobjecttype",name:e("Model.Solutions.SolutionImportDependencies.ComponentType"),fieldName:"objectType"}),I(I({},t),{},{key:"requiredby",name:e("Model.Solutions.SolutionImportDependencies.RequiredBy"),fieldName:"requiredBy"}),I(I({},t),{},{key:"dependentobjecttype",name:e("Model.Solutions.SolutionImportDependencies.ComponentType"),fieldName:"requiredByType"})]};function N(e,t){var n,o,r=null===(n=JSON.parse(e)[0])||void 0===n||null===(o=n.Message)||void 0===o?void 0:o.match("<MissingDependencies>.*</MissingDependencies>"),a=Object(v.ParseXml)(r),i=null==a?void 0:a.querySelectorAll("MissingDependency"),s=new Map,l=[];return i.forEach(e=>{var n,o,r,a,i,c,p,u,d,m,b,g,y,S,f=null===(n=e.getElementsByTagName("Required")[0])||void 0===n?void 0:n.attributes,h=null===(o=e.getElementsByTagName("Dependent")[0])||void 0===o?void 0:o.attributes,O=Object(C.solutionComponentTypeIdNameMap)(t).get(null===(r=f.getNamedItem("type"))||void 0===r?void 0:r.value)||(null===(a=f.getNamedItem("type"))||void 0===a?void 0:a.value),v=Object(C.solutionComponentTypeIdNameMap)(t).get(null===(i=h.getNamedItem("type"))||void 0===i?void 0:i.value)||(null===(c=h.getNamedItem("type"))||void 0===c?void 0:c.value),P={displayName:L(null===(p=f.getNamedItem("parentDisplayName"))||void 0===p?void 0:p.value,null===(u=f.getNamedItem("displayName"))||void 0===u?void 0:u.value,null===(d=f.getNamedItem("schemaName"))||void 0===d?void 0:d.value),nameId:null===(m=f.getNamedItem("schemaName"))||void 0===m?void 0:m.value,objectType:O,requiredBy:L(null===(b=h.getNamedItem("parentDisplayName"))||void 0===b?void 0:b.value,null===(g=h.getNamedItem("displayName"))||void 0===g?void 0:g.value,null===(y=h.getNamedItem("schemaName"))||void 0===y?void 0:y.value),requiredByType:v};if(0===(null==f||null===(S=f.getNamedItem("solution"))||void 0===S?void 0:S.value.localeCompare("Active",void 0,{sensitivity:"accent"})))l.push(P);else{var E,T=null===(E=f.getNamedItem("solution"))||void 0===E?void 0:E.value;s.has(T)?s.get(T).push(P):s.set(T,[P])}}),{managedSolutionGroups:s,objectList:l}}function L(e,t,n){return e&&t?"".concat(e," (").concat(t,")"):e||t||n}var M=Object(p.translateService)("PowerappsPortal")(e=>{var{t:t,defaultPanelProps:n,solutionDisplayName:p,errorMessage:C}=e,v=Object(s.useDispatch)(),R=()=>{Object(S.trackUserActionClickButton)(O.SolutionEventScope,O.EventNames.Dismiss),v(l.sharedActions.panelClose({panelType:c.PanelToShowType.SolutionImportDependenciesPanel}))},I=()=>{Object(S.trackUserActionClickButton)(O.SolutionEventScope,O.EventNames.DownloadErrorLog);Object(f.triggerFileDownloadFromText)(C,"log.txt");var e=h.CustomHostEvents.getOnSuccessfulDownload();e&&e("log.txt")},[w,L]=Object(i.useState)(new Map),[M,x]=Object(i.useState)([]),[k,F]=Object(i.useState)(!0),[_,U]=Object(i.useState)("");i.useEffect(()=>{(()=>{F(!0);try{var{managedSolutionGroups:e,objectList:n}=N(C,t);L(e),x(n)}catch(o){U(null==o?void 0:o.message)}finally{F(!1)}})()},[C]);var V,B=i.useCallback(()=>i.createElement("div",null,i.createElement(y.PrimaryButton,{primary:!0,styles:{root:{marginRight:"8px",overflow:"visible"}},onClick:R,text:t("Model.Solutions.SolutionImportDependencies.Close"),ariaLabel:t("Common.Action.Close")}),i.createElement(y.DefaultButton,{onClick:I,text:t("Download"),ariaLabel:t("Model.Solutions.SolutionImportDependencies.Download")})),[]),H=g.solutionImportDependenciesPanelStyleClasses,G="".concat(t(o.ManagedSolutions)," (").concat(w.size,")"),W="".concat(t(o.Objects)," (").concat(M.length,")");return i.createElement(a.Panel,A({},n,{onDismiss:R,headerText:t("Model.Solutions.SolutionImportDependencies.PanelHeader"),onRenderFooterContent:B,type:a.PanelType.largeFixed,isFooterAtBottom:!0,styles:{main:{overflowY:"hidden"},scrollableContent:{paddingLeft:"0",paddingRight:"0"}}}),!!_&&i.createElement(j.MessageBar,{messageBarType:j.MessageBarType.error,styles:{root:{marginBottom:8,flexShrink:0},iconContainer:{marginTop:8,marginBottom:8},text:{marginTop:8,marginBottom:8}},onDismiss:()=>U(""),dismissButtonAriaLabel:t("Common.Close")},_),i.createElement("div",{className:H.paneSubHeaderStyle},p),Object(r.formatResourceString)(t("Model.Solutions.SolutionImportDependencies.ImportDependenciesMessage"),p),k&&i.createElement(E.Overlay,{styles:{root:{backgroundColor:Object(T.getTheme)().palette.white,opacity:.9,marginTop:"50%"}}},i.createElement(P.Spinner,{size:P.SpinnerSize.large,label:t("Common.Loading.Ellipses"),ariaLabel:t("Common.Loading.Ellipses"),ariaLive:"assertive"})),!k&&i.createElement(d.Pivot,null,w.size>0&&i.createElement(d.PivotItem,{linkText:G,itemKey:o.ManagedSolutions},(e=>{var n=[],o=[],r=0;for(var[a,s]of e.entries())o.push({key:a,name:a,startIndex:r++,count:s.length,level:0}),n.push(...s);return i.createElement(u.DetailsList,{items:n,groups:o,groupProps:{isAllGroupsCollapsed:!0},constrainMode:b.ConstrainMode.unconstrained,columns:D(t),selectionMode:m.SelectionMode.none,layoutMode:b.DetailsListLayoutMode.justified,compact:!1,categorized:!0,categoriesCollapsed:!0,setKey:"set"})})(w)),M.length>0&&i.createElement(d.PivotItem,{linkText:W},(V=M,i.createElement(u.DetailsList,{items:V,constrainMode:b.ConstrainMode.unconstrained,columns:D(t),selectionMode:m.SelectionMode.none,layoutMode:b.DetailsListLayoutMode.justified,compact:!1,categorized:!0,categoriesCollapsed:!0,setKey:"set"})))))})},6681:function(e,t,n){"use strict";n.r(t),n.d(t,"solutionImportDependenciesPanelStyleClasses",(function(){return r}));var o=n(719),r=Object(o.mergeStyleSets)({paneSubHeaderStyle:["header",{fontSize:"14px",fontFamily:"Segoe UI",color:Object(o.getTheme)().palette.neutralSecondary,paddingBottom:"15px"}],pivot:["ba-Pivot",{paddingLeft:"16px",paddingTop:"8px"}],pivotSubHeaderStyle:["header",{padding:"20px 12px 0"}],contentWrapper:["content-wrapper",{minHeight:"32px"}]})},6682:function(e,t,n){"use strict";n.r(t),n.d(t,"CustomHostEvents",(function(){return o}));class o{static SetCustomHostEvents(e){o.props=e}static getOnSuccessfulDownload(){var e;return null===(e=o.props)||void 0===e?void 0:e.onSuccessfulDownload}}o.props=void 0},6683:function(e,t,n){"use strict";n.r(t),n.d(t,"solutionComponentTypeIdNameMap",(function(){return o}));var o=e=>new Map([["1",e("Model.Solutions.Components.ComponentTypes.Table")],["2",e("Model.Solutions.Components.ComponentTypes.Column")],["3",e("Model.Solutions.Components.ComponentTypes.Relationship")],["4",e("Model.Solutions.Components.ComponentTypes.AttributePicklistValue")],["5",e("Model.Solutions.Components.ComponentTypes.AttributeLookupValue")],["6",e("Model.Solutions.Components.ComponentTypes.ViewAttribute")],["7",e("Model.Solutions.Components.ComponentTypes.LocalizedLabel")],["8",e("Model.Solutions.Components.ComponentTypes.RelationshipExtraCondition")],["9",e("Model.Solutions.Components.ComponentTypes.OptionSet")],["10",e("Model.Solutions.Components.ComponentTypes.EntityRelationship")],["11",e("Model.Solutions.Components.ComponentTypes.EntityRelationshipRole")],["12",e("Model.Solutions.Components.ComponentTypes.EntityRelationshipRelationships")],["13",e("Model.Solutions.Components.ComponentTypes.ManagedProperty")],["14",e("Model.Solutions.Components.ComponentTypes.EntityKey")],["16",e("Model.Solutions.Components.ComponentTypes.Privilege")],["17",e("Model.Solutions.Components.ComponentTypes.PrivilegeObjectTypeCode")],["20",e("Model.Solutions.Components.ComponentTypes.Role")],["21",e("Model.Solutions.Components.ComponentTypes.RolePrivilege")],["22",e("Model.Solutions.Components.ComponentTypes.Message")],["23",e("Model.Solutions.Components.ComponentTypes.DisplayStringMap")],["26",e("Model.Solutions.Components.ComponentTypes.View")],["29",e("Model.Solutions.Components.ComponentTypes.Flow")],["31",e("Model.Solutions.Components.ComponentTypes.Report")],["36",e("Model.Solutions.Components.ComponentTypes.EmailTemplate")],["37",e("Model.Solutions.Components.ComponentTypes.ContractTemplate")],["38",e("Model.Solutions.Components.ComponentTypes.KBArticleTemplate")],["39",e("Model.Solutions.Components.ComponentTypes.MailMergeTemplate")],["50",e("Model.Solutions.Components.ComponentTypes.RibbonCustomization")],["59",e("Model.Solutions.Components.ComponentTypes.Chart")],["60",e("Model.Solutions.Components.ComponentTypes.SystemForm")],["61",e("Model.Solutions.Components.ComponentTypes.WebResource")],["62",e("Model.Solutions.Components.ComponentTypes.SiteMap")],["63",e("Model.Solutions.Components.ComponentTypes.ConnectionRole")],["66",e("Model.Solutions.Components.ComponentTypes.CustomControl")],["70",e("Model.Solutions.Components.ComponentTypes.FieldSecurityProfile")],["80",e("Model.Solutions.Components.ComponentTypes.ModelDrivenApp")],["91",e("Model.Solutions.Components.ComponentTypes.PluginAssembly")],["92",e("Model.Solutions.Components.ComponentTypes.SDKMessageProcessingStep")],["95",e("Model.Solutions.Components.ComponentTypes.ServiceEndpoint")],["150",e("Model.Solutions.Components.ComponentTypes.RoutingRule")],["152",e("Model.Solutions.Components.ComponentTypes.SLA")],["154",e("Model.Solutions.Components.ComponentTypes.ConvertRule")],["161",e("Model.Solutions.Components.ComponentTypes.MobileOfflineProfile")],["201",e("Model.Solutions.Components.ComponentTypes.SDKMessage")],["300",e("Model.Solutions.Components.ComponentTypes.CanvasApp")],["372",e("Model.Solutions.Components.ComponentTypes.CustomConnector")],["380",e("Model.Solutions.Components.ComponentTypes.EnvironmentVariableDefinition")],["381",e("Model.Solutions.Components.ComponentTypes.EnvironmentVariableValue")],["401",e("Model.Solutions.Components.ComponentTypes.AIModel")],["418",e("Model.Solutions.Components.ComponentTypes.Dataflow")],["419",e("Model.Solutions.Components.ComponentTypes.DataflowEntities")]])},6684:function(e,t,n){"use strict";function o(e){if(window.hasOwnProperty("DOMParser"))return(new DOMParser).parseFromString(e,"text/xml");if(window.hasOwnProperty("ActiveXObject")){var t=new window.ActiveXObject("Microsoft.XMLDOM");return t.async=!1,t.loadXML(e),t}return null}n.r(t),n.d(t,"ParseXml",(function(){return o}))},6685:function(e,t,n){"use strict";n.r(t),n.d(t,"mapStateToProps",(function(){return C})),n.d(t,"mapDispatchToProps",(function(){return v})),n.d(t,"mergeProps",(function(){return P})),n.d(t,"SolutionNewPanelContainer",(function(){return E}));var o=n(5687),r=n(5629),a=n(5774),i=n(5487),s=n(5690),l=n(5691),c=n(5781),p=n(5746),u=n(5669),d=n(5478),m=n(5437),b=n(5582),g=n(5630),y=n(5468),S=n(2699);function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){O(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function O(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var C=(e,t)=>{var n=Object(b.currentEnvironmentIdSelector)(t),a=p.solutionsSelectors.publishersSelector(e,n)||c.emptyList,i=Object(c.makePublisherOptions)(a),s=p.solutionsSelectors.configurationPagesSelector(e,n).map(e=>({key:e.webResource.webresourceid,text:e.webResource.displayname})),d=p.solutionsSelectors.publishersStatusSelector(e,n),m=p.solutionsSelectors.configurationPagesStatusSelector(e,n);return{publisherOptions:i,configurationPageOptions:s,logEvent:o.SolutionNewPanelLoadEvents,loadProgress:[Object(r.toLoadingState)(d&&d.success&&m&&m.success,d&&d.failed&&m&&m.failed&&u.CommonErrors.UnspecifiedError)],createSolutionResponse:Object(l.createSolutionStatus)(e),updateSolutionResponse:Object(l.updateSolutionStatus)(e)}},v=e=>{var t=t=>{e(y.sharedActions.panelClose({panelType:d.PanelToShowType.PublisherNewEditPanel})),t&&e(p.solutionsActions.fetchPublishersRequest())};return{onPanelClose:()=>{e(y.sharedActions.panelClose({panelType:d.PanelToShowType.SolutionNewPanel})),e(p.solutionsActions.createSolutionClear())},onMount:()=>{e(p.solutionsActions.fetchPublishersRequest()),e(p.solutionsActions.fetchConfigurationPagesRequest())},onSaveClick:t=>e(p.solutionsActions.createSolution({displayName:t.displayName,name:t.name,publisher:t.publisher,version:t.version,installedOn:t.installedOn,configurationPage:t.configurationPage,description:t.description})),openLegacySolutionPublisherDetailUI:t=>{e(Object(s.openLegacySolutionPublisherDetail)({publisherId:t}))},dispatchTelemetry:e,onCreateNewPublisher:()=>{S.featureGates.enablePublisherPanel?e(Object(g.logAction)(p.solutionsActions.openPublisherPanel({isCreateMode:!0,onPanelDismiss:t}),o.NewPublisherPanelLoadEvents.eventName)):(e(Object(s.openWaitingForNewPublisherDialog)()),e(Object(s.createNewPublisher)()))},onEditPublisher:n=>{S.featureGates.enablePublisherPanel?e(Object(g.logAction)(p.solutionsActions.openPublisherPanel({isCreateMode:!1,onPanelDismiss:t,publisherId:n}),o.EditPublisherPanelLoadEvents.eventName)):e(Object(s.openWaitingForEditPublisherDialog)())},onDismount:()=>e(Object(s.fetchPublishersCancelPoll)())}},P=(e,t,n)=>h(h(h({},e),{},{defaultPanelProps:n.defaultPanelProps},t),{},{isEditMode:!1,isManaged:!1,version:"1.0.0.0"}),E=Object(i.withRootProps)(Object(m.connect)(C,v,P)(a.SolutionNewEditPanel))},6686:function(e,t,n){"use strict";n.r(t),n.d(t,"mapStateToProps",(function(){return m})),n.d(t,"mapDispatchToProps",(function(){return b})),n.d(t,"mergeProps",(function(){return g})),n.d(t,"TrialExtensionPanelContainer",(function(){return y}));var o=n(5437),r=n(5468),a=n(5630),i=n(5478),s=n(6687),l=n(6690),c=n(5626);function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var m=e=>{var t=Object(c.newP2TrialPlanSelector)(e),n=Object(c.newP2TrialPlanInProgressSelector)(e),o=Object(c.newP2TrialPlanErrorSelector)(e),a=Object(c.premiumResourceTypeSelector)(e),i=r.sharedSelectors.countriesSelector(e),s=i.map(e=>({key:e.countryCode,text:e.countryDisplayName}));return{countries:i,countryOptions:s,newP2TrialPlan:t,newP2TrialPlanInProgress:n,newP2TrialPlanError:o,premiumResourceType:a}},b=e=>({fetchCountries:()=>{e(Object(a.logAction)(r.sharedActions.fetchCountriesRequest(),l.TrialExtensionPanelEvents.TrialExtensionPanelOpened.eventName))},markRenewTrialAsDismissed:()=>{e(r.sharedActions.markRenewTrialAsDismissed())},onPanelClose:t=>{e(Object(a.logAction)(r.sharedActions.panelClose({panelType:i.PanelToShowType.TrialExtensionPanel}),t))},onExtendTrial:t=>{e(Object(a.logAction)(r.sharedActions.extendTrialRequest({phoneNumber:t.phoneNumber,reasonForRenewal:t.reasonForRenewal,emailConsent:t.emailConsent}),l.TrialExtensionPanelEvents.TrialExtensionClicked.eventName))},onNavigateBack:()=>{e(r.sharedActions.resetTrialExtensionPanelStatus())}}),g=(e,t,n)=>u(u({onMount:()=>t.fetchCountries(),defaultPanelProps:n.defaultPanelProps},e),t),y=Object(o.connect)(m,b,g)(s.TrialExtensionPanel)},6687:function(e,t,n){"use strict";n.r(t),n.d(t,"RenewReason",(function(){return o})),n.d(t,"TrialExtensionPanel",(function(){return C}));var o,r=n(4013),a=n(5466),i=n(1567),s=n(1697),l=n(1573),c=n(1362),p=n(1429),u=n(245),d=n(2869),m=n(6688),b=n(6689),g=n(6690),y=n(6691);function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(Object(n),!0).forEach((function(t){h(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function O(){return(O=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}!function(e){e.StillEvaluating="StillEvaluating",e.ProblemsPurchasing="ProblemsPurchasing",e.SomeoneWillPurchase="SomeoneWillPurchase",e.NoTime="NoTime",e.Other="Other"}(o||(o={}));class C extends u.Component{constructor(e){super(e),this.resources=void 0,this.reasonFoRenewalOptions=void 0,this.changeCountriesDropdownState=(e,t)=>{var n=this.getCountry(t),o=this.state.consentCheckBox;switch(n&&n.defaultOptIn){case b.DefaultOptInOptions.DoNotShow:o={text:this.resources.Directives.OneRMConsent.ConsentCheckbox.hidden,checked:!0,disabled:!0};break;case b.DefaultOptInOptions.Yes:o={text:this.resources.Directives.OneRMConsent.ConsentCheckbox.shown,checked:!0,disabled:!1};break;case b.DefaultOptInOptions.No:default:o={text:this.resources.Directives.OneRMConsent.ConsentCheckbox.shown,checked:!1,disabled:!1}}this.setState({selectedCountryOption:t,consentCheckBox:o})},this.setPanelOpenIndex=e=>{this.props.newP2TrialPlan&&0===e&&this.props.onNavigateBack()},this.changeRenewalReasonsDropdownState=(e,t)=>{this.setState({selectedRenewReasonOption:t})},this.changePhoneNumberTextFieldState=(e,t)=>{this.setState({phoneNumber:t})},this.onDismiss=()=>{this.props.newP2TrialPlanInProgress||(this.props.markRenewTrialAsDismissed(),this.props.onPanelClose(g.TrialExtensionPanelEvents.TrialExtensionPanelDismissed.eventName))},this.resources=Object(d.getResources)(),this.reasonFoRenewalOptions=[{key:o.StillEvaluating,text:this.resources.Controllers.RenewTrialModal.RenewalReason.Reason1.text},{key:o.ProblemsPurchasing,text:this.resources.Controllers.RenewTrialModal.RenewalReason.Reason2.text},{key:o.SomeoneWillPurchase,text:this.resources.Controllers.RenewTrialModal.RenewalReason.Reason3.text},{key:o.NoTime,text:this.resources.Controllers.RenewTrialModal.RenewalReason.Reason4.text},{key:o.Other,text:this.resources.Controllers.RenewTrialModal.RenewalReason.Reason5.text}],this.state={selectedCountryOption:void 0,selectedRenewReasonOption:void 0,phoneNumber:"",consentCheckBox:{text:"",checked:!1,disabled:!0},panelOpenIndex:0}}componentDidMount(){this.props.onMount()}render(){var e=this.props.newP2TrialPlan&&!this.props.newP2TrialPlanError?1:0,t={headerText:this.resources.Controllers.RenewTrialModal.UserCollectionForm.header,headerClassName:"trial-extension-panel-header",hasCloseButton:!0,closeButtonType:r.PanelCloseButtonType.Back,closeButtonAriaLabel:this.resources.Common.close,type:l.PanelType.smallFixedFar,messageBar:this.getMessageBar()},n=[this.getTrialExtensionPanel(t),this.getTrialExtendedPanel(t)];return u.createElement(a.MultistepPanel,O({customWidth:void 0,dismissDialog:void 0,dismissOnEscape:void 0,isBlocking:!0,isHiddenOnDismiss:!0,onDismissed:void 0,onLightDismissClick:void 0,showDismissDialog:void 0,isLightDismiss:!1,onOuterClick:void 0,isOpen:void 0},this.props.defaultPanelProps,{onDismiss:this.onDismiss,panelsListProps:n,panelOpenIndex:e,setPanelOpenIndex:this.setPanelOpenIndex}))}getTrialExtensionPanel(e){var t=u.createElement(i.Dropdown,{options:this.props.countryOptions,required:!0,label:this.resources.Controllers.RenewTrialModal.UserCollectionForm.CountryDropdown.label,selectedKey:void 0!==this.state.selectedCountryOption&&void 0!==this.state.selectedCountryOption.key?this.state.selectedCountryOption.key:void 0,onChange:this.changeCountriesDropdownState,errorMessage:void 0===this.state.selectedCountryOption?this.resources.Shared.RenewTrial.TrialExtensionPanel.Error.Required:void 0}),n=u.createElement(i.Dropdown,{options:this.reasonFoRenewalOptions,required:!0,label:this.resources.Controllers.RenewTrialModal.UserCollectionForm.ExtensionReason.label,selectedKey:void 0!==this.state.selectedRenewReasonOption&&void 0!==this.state.selectedRenewReasonOption.key?this.state.selectedRenewReasonOption.key:void 0,onChange:this.changeRenewalReasonsDropdownState,errorMessage:void 0===this.state.selectedRenewReasonOption?this.resources.Shared.RenewTrial.TrialExtensionPanel.Error.Required:void 0}),o=this.state.consentCheckBox.disabled?null:u.createElement(c.Checkbox,{label:this.state.consentCheckBox.text,onChange:()=>{},checked:!!this.state.consentCheckBox.checked,disabled:this.state.consentCheckBox.disabled}),r=u.createElement("div",{className:"trial-extension-section"},u.createElement("div",{className:"panel-subtitle"},this.resources.Controllers.RenewTrialModal.UserCollectionForm.subheader),u.createElement("div",{className:"panel-trial-extension-field"},t),u.createElement("div",{className:"panel-trial-extension-field"},n),u.createElement("div",{className:"panel-trial-extension-field"},u.createElement(p.TextField,{label:this.resources.Controllers.RenewTrialModal.UserCollectionForm.PhoneNumberInput.label,onChange:this.changePhoneNumberTextFieldState})),u.createElement("div",{className:"panel-trial-extension-field"},u.createElement("div",{className:"consent-selection"},u.createElement("div",{className:"consent-checkbox"},o))));return f(f({},e),{},{children:r,footerButtons:this.getTrialExtensionFooterButtons()})}getTrialExtendedPanel(e){var t=u.createElement("div",{className:"trial-extended-section"});return f(f({},e),{},{headerLeftButtonProps:{styles:{root:{display:"none"}}},children:t,footerButtons:this.getTrialExtendedFooterButtons()})}getCountry(e){return void 0!==e?this.props.countries.find(t=>t.countryCode===e.key):null}getTrialExtensionFooterButtons(){return[{ariaLabel:this.resources.Common.Save.cancel,text:this.resources.Common.Save.cancel,disabled:this.props.newP2TrialPlanInProgress,className:"trial-extension-panel-button",navigateableOnClick:e=>(this.props.onPanelClose(g.TrialExtensionPanelEvents.TrialExtensionPanelDismissed.eventName),e)},{primary:!0,ariaLabel:this.resources.Controllers.RenewTrialModal.ExtendYourTrialButton.text,text:this.resources.Controllers.RenewTrialModal.ExtendYourTrialButton.text,disabled:this.isExtendTrialDisabled(),className:"trial-extension-panel-button",navigateableOnClick:e=>(this.onExtendTrialClicked(),e)}]}getTrialExtendedFooterButtons(){return[{ariaLabel:this.resources.Common.close,text:this.resources.Common.close,disabled:!1,className:"trial-extension-panel-button",navigateableOnClick:e=>(this.props.onPanelClose(g.TrialExtensionPanelEvents.TrialExtensionPanelCompleted.eventName),e)}]}isExtendTrialDisabled(){return this.props.newP2TrialPlanInProgress||void 0===this.state.selectedCountryOption||void 0===this.state.selectedRenewReasonOption}getRenewTrialConfirmationText(e){switch(e){case y.PremiumResourceType.Entity:return this.resources.Controllers.RenewTrialModal.TrialExtensionConfirmation.Entities.text;case y.PremiumResourceType.PremiumConnection:return this.resources.Controllers.RenewTrialModal.TrialExtensionConfirmation.Connections.text;case y.PremiumResourceType.General:default:return this.resources.Controllers.RenewTrialModal.TrialExtensionConfirmation.Generic.text}}getMessageBar(){var e="",t=null;return this.props.newP2TrialPlan?(e=this.getRenewTrialConfirmationText(this.props.premiumResourceType),t=s.MessageBarType.success):this.props.newP2TrialPlanInProgress?(e=this.resources.RenewTrialModal.ExtendYourTrialButton.Extending.text,t=s.MessageBarType.info):this.props.newP2TrialPlanError&&(e=this.props.newP2TrialPlanError,t=s.MessageBarType.error),e?{messageBarProps:{messageBarType:t},onRenderBody:()=>u.createElement("span",null,e)}:null}onExtendTrialClicked(){var e=this.state.selectedRenewReasonOption.key,t=this.state.phoneNumber,n={powerApps:{promotionalEmailOption:this.state.consentCheckBox.checked?m.UserConsentOptionsConstants.Yes:m.UserConsentOptionsConstants.No}};this.props.onExtendTrial({phoneNumber:t,reasonForRenewal:e,emailConsent:n})}}},6688:function(e,t,n){"use strict";n.r(t),n.d(t,"UserConsentOptionsConstants",(function(){return o}));var o={Yes:"Yes",No:"No",NotSpecified:"NotSpecified"}},6689:function(e,t,n){"use strict";n.r(t),n.d(t,"DefaultOptInOptions",(function(){return o}));var o={Yes:"Yes",No:"No",DoNotShow:"DoNotShow"}},6690:function(e,t,n){"use strict";n.r(t),n.d(t,"TrialExtensionPanelEvents",(function(){return o}));var o={TrialExtensionPanelOpened:{eventName:"RenewTrial.Modal.Shown"},TrialExtensionPanelDismissed:{eventName:"RenewTrial.Modal.Dismissed"},TrialExtensionPanelCompleted:{eventName:"RenewTrial.Modal.Completed"},TrialExtensionClicked:{eventName:"RenewTrial.Renew.Clicked"},TrialExtensionSucceeded:{eventName:"RenewTrial.Renew.Success"},TrialExtensionFail:{eventName:"RenewTrial.Renew.Fail"},TrialExtensionCountriesPerformance:{eventName:"RenewTrial.Countries.Performance"}}},6691:function(e,t,n){"use strict";var o;n.r(t),n.d(t,"PremiumResourceType",(function(){return o})),function(e){e[e.Entity=1]="Entity",e[e.PremiumConnection=2]="PremiumConnection",e[e.General=3]="General"}(o||(o={}))},6692:function(e,t,n){"use strict";n.r(t),n.d(t,"mapStateToProps",(function(){return d})),n.d(t,"mapDispatchToProps",(function(){return m})),n.d(t,"mergeProps",(function(){return b})),n.d(t,"UpdateEnvVariablesPanelContainer",(function(){return g}));var o=n(5816),r=n(5437),a=n(6693),i=n(5693),s=n(5468),l=n(5478);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var d=e=>({envVariablesNeedUpdate:Object(o.envVariablesNeedValueSelector)(e)}),m=e=>({updateEnvVariables:t=>{e(Object(i.setEnvVariableValue)({envVarValues:t}))},onDismissPanel:()=>{e(s.sharedActions.panelClose({panelType:l.PanelToShowType.UpdateEnvVariablesPanel}))}}),b=(e,t,n)=>p(p(p({},e),t),n),g=Object(r.connect)(d,m,b)(a.UpdateEnvVarValuesPanel)},6755:function(e,t,n){"use strict";n.r(t),n.d(t,"mapStateToProps",(function(){return m})),n.d(t,"mapDispatchToProps",(function(){return b})),n.d(t,"VersionPublishPanelContainer",(function(){return g}));var o=n(5437),r=n(5596),a=n(5481),i=n(5648),s=n(5649),l=n(5468),c=n(5630),p=n(5478),u=n(5799),d=n(6756),m=(e,t)=>({publishAppVersionResponse:Object(s.publishAppVersionResponse)(e)}),b=(e,t)=>({onDismiss:()=>e(l.sharedActions.panelClose({panelType:p.PanelToShowType.VersionPublishPanel})),onPublish:()=>e(Object(i.publishAppVersionRequest)({appName:Object(r.getAppName)(t.app)})),onEditAppSettings:()=>Object(c.logAction)(e(Object(i.openAppSettings)({app:t.app})),u.editAppSettingsClicked.eventName,u.editAppSettingsClicked.getData(t.app)),onLearnMoreClicked:()=>Object(c.logAction)(e(l.sharedActions.openNewTab({uri:a.default.publishingApps})),u.navigateToHelp.eventName,u.navigateToHelp.getData(t.app))}),g=Object(o.connect)(m,b)(d.VersionPublishPanel)},6756:function(e,t,n){"use strict";n.r(t),n.d(t,"VersionPublishPanel",(function(){return g}));var o=n(4013),r=n(1090),a=n(1697),i=n(1573),s=n(1201),l=n(6757),c=n(545),p=n(245),u=n(2869),d=n(2880),m=n(2835);function b(){return(b=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}class g extends p.Component{constructor(e){super(e),this.resources=void 0,this.resources=Object(u.getResources)(),this.state={isPublishRequestSubmitted:!1}}render(){var e=Object(d.formatResourceString)(this.resources.Apps.Versions.PublishModal.title,this.props.appVersionListItemIndex),t=Object(d.formatResourceStringToElement)(this.resources.Apps.Versions.PublishModal.subtitleReact,(e,t)=>0===t?this.props.appVersionListItemIndex.toString():1===t?p.createElement("b",null,e):null),n=this.resources.Apps.Versions.PublishModal.learnMore,u=this.props.publishedAppSettings,m=null,g=null;return this.props.publishAppVersionResponse.loading&&(m={spinnerProps:{size:s.SpinnerSize.large}}),this.props.publishAppVersionResponse.message&&(g={messageBarProps:{messageBarType:a.MessageBarType.error},onRenderBody:()=>p.createElement(p.Fragment,null,this.props.publishAppVersionResponse.message)}),p.createElement(o.Panel,b({},this.props.defaultPanelProps,{headerText:e,onDismiss:()=>this.props.onDismiss(),footerButtons:this.getFooterButtons(),type:i.PanelType.medium,loadingOverlay:m,messageBar:g}),p.createElement("div",{className:"version-publish-panel-subtitle"},p.createElement("span",null,t),p.createElement(r.Link,{onClick:()=>{this.props.onLearnMoreClicked()}},n)),p.createElement("div",{className:Object(c.css)(l.versionPublishPanelStyles.versionPublishPanelContent)},p.createElement("div",{className:"version-publish-panel-app-name-and-icon"},u.backgroundImageUri&&p.createElement("div",{className:"version-publish-panel-app-header-icon",style:{backgroundColor:u.backgroundColor}},p.createElement("img",{src:u.backgroundImageUri})),p.createElement("div",{className:"version-publish-panel-app-header-text"},p.createElement("div",{className:"app-title"},u.displayName),p.createElement("div",null,Object(d.formatResourceString)(this.resources.Apps.Versions.PublishModal.versionName,this.props.appVersionListItemIndex))))))}componentDidUpdate(){this.state.isPublishRequestSubmitted&&this.props.publishAppVersionResponse.success&&!this.props.publishAppVersionResponse.message&&!this.props.publishAppVersionResponse.loading&&this.props.onDismiss()}getFooterButtons(){var{publishAppVersionResponse:e,app:t,onPublish:n,onEditAppSettings:o}=this.props,r=e.loading,a=[{primary:!0,ariaLabel:this.resources.Apps.Versions.publishButton,text:this.resources.Apps.Versions.publishButton,dismissableOnClick:()=>{this.setState({isPublishRequestSubmitted:!0}),n()},disabled:r}];return Object(m.isAppComponentLibrary)(t)||a.push({ariaLabel:this.resources.Apps.Versions.PublishModal.editSettings,text:this.resources.Apps.Versions.PublishModal.editSettings,dismissableOnClick:e=>{e(),o()},disabled:r}),a}}},6757:function(e,t,n){"use strict";n.r(t),n.d(t,"versionPublishPanelStyles",(function(){return a}));var o=n(719),r=n(2882),a=Object(o.mergeStyleSets)({versionPublishPanelContent:{borderTop:"1px solid fabricColors.veryLightGrey",paddingTop:"16px",selectors:{".version-publish-panel-app-name-and-icon":{selectors:{".version-publish-panel-app-header-icon":{overFlow:"hidden",position:"relative",float:"left",height:"48px",width:"48px",backgroundColor:r.fabricColors.white,selectors:{img:{position:"absolute",top:"50%",left:"50%",webkitTransform:"translateY(-50%) translateX(-50%)",mozTransform:"translateY(-50%) translateX(-50%)",msTransform:"translateY(-50%) translateX(-50%)",oTransform:"translateY(-50%) translateX(-50%)",transform:"translateY(-50%) translateX(-50%)",height:"100%",width:"auto"}}},".version-publish-panel-app-header-text":{height:"48px",paddingLeft:"60px",selectors:{".app-title":{fontSize:"14px"}}}}}}}})},6758:function(e,t,n){"use strict";n.r(t),n.d(t,"mapStateToProps",(function(){return d})),n.d(t,"mapDispatchToProps",(function(){return m})),n.d(t,"mergeProps",(function(){return b})),n.d(t,"BillingWizardPanelContainer",(function(){return g}));var o=n(5437),r=n(3076),a=n(5478),i=n(5629),s=n(5468),l=n(6759);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var d=(e,t)=>({loadProgress:[Object(i.toLoadingState)(!t.loading,void 0,"page loading")]}),m=e=>({onPanelClose:()=>e(s.sharedActions.panelClose({panelType:a.PanelToShowType.BillingWizardPanel}))}),b=(e,t,n)=>{var{onClosePanel:o}=n;return p(p(p({},e),n),{},{onPanelClose:()=>{t.onPanelClose(),o&&o()},errorMessage:null,defaultPanelProps:n.defaultPanelProps,dispatchTelemetry:t.dispatchTelemetry})},g=Object(r.withApolloClient)(Object(o.connect)(d,m,b)(l.BillingWizardPanel))},6759:function(e,t,n){"use strict";n.r(t),n.d(t,"BillingWizardPanel",(function(){return E}));var o=n(245),r=n(4013),a=n(2871),i=n(2869),s=n(2880),l=n(5481),c=n(1573),p=n(6760),u=n(6851),d=n(5731),m=n(6852),b=n(6853),g=n(6855),y=n(5881),S=n(2698),f=n(1105),h=n(5732),O=n(6854),C=n(3199),v=n(5891);function P(){return(P=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}var E=e=>{var t,n,E,T,j,A=Object(i.getResources)(),[R,I]=Object(o.useState)(null),[w,D]=Object(o.useState)(null),[N,L]=Object(o.useState)(null),[M,x]=Object(o.useState)(null),[k,F]=Object(o.useState)(null),_=Object(o.useRef)(null),U=Object(o.useRef)(null),V=Object(o.useRef)(null),B=Object(o.useRef)(null),{allowListFeatures:H}=o.useContext(C.AllowListFeaturesContext),G=y.BillingPolicyApiVersion.v0_1_alpha;a.featureGates.enablePayGoV1PolicyAPI&&H.EnablePayGoGAFeatures&&(G=y.BillingPolicyApiVersion.v1_0);var[W,q]=Object(o.useState)(m.BillingWizardPanelStep.SelectPlanType),[z,Q]=Object(o.useState)(null),K=Object(o.useCallback)(()=>{Object(d.sendUsageTelemetry)(h.featureName,h.BillingWizardTelemetryScenarios.closeBillingWizard),e.onPanelClose()},[]),Y=Object(o.useCallback)(t=>{p.azureClient.GetAzureResourceGroups(e.environmentClient,t,e=>{var t;null===(t=U.current)||void 0===t||t.complete({resourceGroupsCount:null==e?void 0:e.length}),U.current=null,L(e)},e=>{var t;null===(t=U.current)||void 0===t||t.completeWithError({errors:e}),U.current=null})},[]),J=Object(o.useCallback)(()=>{D(null);p.azureClient.GetAzureSubscriptionsWithActionSets(e.environmentClient,u.createBillingPolicyPermissions,e=>{var t;null===(t=_.current)||void 0===t||t.complete({subscriptionsCount:e.length}),_.current=null,D(e)},e=>{var t;null===(t=_.current)||void 0===t||t.completeWithError({errors:e}),_.current=null})},[]);Object(o.useMemo)(()=>{var t;(Object(d.sendUsageTelemetry)(h.featureName,h.BillingWizardTelemetryScenarios.openBillingWizard),_.current=Object(d.sendPerformanceTelemetry)(void 0,h.featureName,h.BillingWizardTelemetryScenarios.AddSubscriptionDetailsStep.subscriptionsLoad),W==m.BillingWizardPanelStep.SelectPlanType)&&(null===(t=e.selectPlanTypeStepScenarioRef)||void 0===t||t.complete());J()},[]),Object(o.useMemo)(()=>{W==m.BillingWizardPanelStep.EnterSubscriptionDetails&&Object(d.sendUsageTelemetry)(h.featureName,h.BillingWizardTelemetryScenarios.AddSubscriptionDetailsStep.pageOpened),W==m.BillingWizardPanelStep.SelectPlanType&&Object(d.sendUsageTelemetry)(h.featureName,h.BillingWizardTelemetryScenarios.SelectPlanTypeStep.pageOpened)},[W]),Object(o.useMemo)(()=>{M&&(U.current=Object(d.sendPerformanceTelemetry)(void 0,h.featureName,h.BillingWizardTelemetryScenarios.AddSubscriptionDetailsStep.resourceGroupsLoad),Y(M.subscriptionId))},[M]),Object(o.useEffect)(()=>{var e;W==m.BillingWizardPanelStep.EnterSubscriptionDetails&&(null===(e=V.current)||void 0===e||e.complete(),V.current=null)},[W]);var X=Object(y.useGetAllBillingPolicies)(e.environmentClient,G,S.PortalScope,A.Common.Request.Failed);X.allBillingPolicies!==z&&Q(X.allBillingPolicies);var Z=o.useContext(f.EnvironmentContext),$={name:R,type:"TenantOwned",status:"Enabled",powerAppsPolicy:{payAsYouGoState:"Enabled"},billingInstrument:{subscriptionId:null==M?void 0:M.subscriptionId,resourceGroup:null==k?void 0:k.name,location:null===(t=Z.currentEnvironment)||void 0===t?void 0:t.location}},ee={environmentIds:[null===(n=Z.currentEnvironment)||void 0===n?void 0:n.name]},te=Object(y.useAddBillingPolicyAndLinkEnvironments)(e.environmentClient,$,ee,G,S.PortalScope,A.Common.Request.Failed);Object(o.useMemo)(()=>{var e;te.errorMessage&&(null===(e=B.current)||void 0===e||e.completeWithError({error:te.errorMessage,subscriptionId:null==M?void 0:M.subscriptionId,resourceGroupId:null==k?void 0:k.id}),B.current=null)},[te.errorMessage]);var ne,oe=te.success?1e3:0,re=Object(v.useGetBillingPolicyForCurrentEnvironment)(e.environmentClient,G,oe,S.PortalScope,Object(i.getResources)().Common.Request.Failed);te.success&&(null===(ne=B.current)||void 0===ne||ne.complete({subscriptionId:null==M?void 0:M.subscriptionId,resourceGroupId:null==k?void 0:k.id}),B.current=null,e.billingSuccess.setValue(!0),re.billingPolicyForEnvironment&&e.onPanelClose());var ae=te.success&&!re.billingPolicyForEnvironment,ie=new Map;ie.set(m.BillingWizardPanelStep.SelectPlanType,new b.SelectPlanTypeStep({billingPlanName:R,setBillingPlanName:I,setBillingWizardStep:q,billingPolicies:z,addSubscriptionDetailsStepScenarioRef:V,currentEnvironment:Z.currentEnvironment})),ie.set(m.BillingWizardPanelStep.EnterSubscriptionDetails,new g.AddSubscriptionDetailsStep({billingWizardProps:e,billingPlanName:R,subscriptions:w,resourceGroups:N,currentSubscription:M,setCurrentSubscription:x,currentResourceGroup:k,setCurrentResourceGroups:F,setCurrentStep:q,loadSubscriptions:J,addBillingPolicyAndLinkEnvironmentsMutationProps:te,currentEnvironment:Z.currentEnvironment,beginCreatePolicyScenario:()=>{B.current=Object(d.sendPerformanceTelemetry)({subscriptionId:null==M?void 0:M.subscriptionId,resourceGroupId:null==k?void 0:k.id},h.featureName,h.BillingWizardTelemetryScenarios.createBillingPolicy)},planLoading:ae}));var se=null!==(E=ie.get(W))&&void 0!==E&&E.getMessageBar?null===(T=ie.get(W))||void 0===T?void 0:T.getMessageBar():null,le=ie.get(W).body(),ce=null;return(te.loading||ae)&&(ce={loadingText:A.Controllers.BillingWizard.EnterSubscription.connectingSubscription}),o.createElement(r.Panel,P({},e.defaultPanelProps,{closeButtonAriaLabel:A.Common.close,onDismiss:()=>{K()},type:c.PanelType.medium,headerText:ie.get(W).title,onRenderSubHeader:()=>o.createElement("div",{className:O.BillingWizardPanelStyleClasses.billingWizard},o.createElement("div",{className:"billing-plan-subtitle"},Object(s.formatResourceStringAsLinks)(ie.get(W).subtitle,[W==m.BillingWizardPanelStep.SelectPlanType?l.default.payGoLearnMore:l.default.azureSubscriptionLearnMore]))),footerButtons:ie.get(W).footerButtons(),headerLeftButtonProps:null===(j=ie.get(W))||void 0===j?void 0:j.headerLeftButtonProps,messageBar:se,children:le,loadingOverlay:ce,"data-automation-key":"billing-wizard"}))}},6760:function(e,t,n){"use strict";n.r(t),n.d(t,"azureClient",(function(){return c}));var o=n(3145),r=n(6761),a=n(6849),i=n(6850);function s(e,t,n,o,r,a,i){try{var s=e[a](i),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(o,r)}function l(e){return function(){var t=this,n=arguments;return new Promise((function(o,r){var a=e.apply(t,n);function i(e){s(a,o,r,i,l,"next",e)}function l(e){s(a,o,r,i,l,"throw",e)}i(void 0)}))}}var c=new class{GetAzureSubscriptions(e,t,n,o){var r=this;return l((function*(){var{data:a,loading:i,errors:s}=yield r.GetAzureSubscriptionInternal(e,t);i||s||n(a.getFilteredAzureSubscriptionsWithActions),s&&o(s)}))()}GetAzureSubscriptionsWithActionSets(e,t,n,o){var r=this;return l((function*(){for(var a,i=null,s=!1,l=0;l<t.length;l++){var{data:c,loading:p,errors:u}=yield r.GetAzureSubscriptionInternal(e,t[l]);u&&o(u),null==i?(i=c.getFilteredAzureSubscriptionsWithActions,a=u,s=p):function(){var e=new Array,t=c.getFilteredAzureSubscriptionsWithActions;s=s&&p,t.forEach(t=>{i.findIndex(e=>e.id===t.id)>-1&&e.push(t)}),i=e}()}null==i&&(i=new Array),s||a||n(i)}))()}GetAzureSubscriptionInternal(e,t){return l((function*(){var n={tenantId:null,allowActions:t};return e?yield e.query({query:a.GetFilteredAzureSubscriptionsWithActionsQuery,variables:n,fetchPolicy:"no-cache"}):{errors:[new r.GraphQLError("Apollo Client is null, cannot execute query")],loading:!1,data:{getFilteredAzureSubscriptionsWithActions:[]},networkStatus:o.NetworkStatus.error,stale:!1}}))()}GetAzureResourceGroups(e,t,n,o){return l((function*(){var r={tenantId:null,subscriptionId:t};if(e){var{data:a,loading:s,errors:l}=yield e.query({query:i.GetAzureResourceGroupsQuery,variables:r,fetchPolicy:"no-cache"});s||l||n(a.getAzureResourceGroups),l&&o(l)}}))()}GetAzureRegions(e,t,n){return l((function*(){if(e){var{data:o,loading:r,errors:i}=yield e.query({query:a.GetResourceGroupRegionQuery});r||i||t(o.getResourceGroupRegion),i&&n(i)}}))()}}},6851:function(e,t,n){"use strict";n.r(t),n.d(t,"createBillingPolicyPermissions",(function(){return o}));var o=[["*","Microsoft.PowerPlatform/accounts/*","Microsoft.PowerPlatform/accounts/write"],["*","Microsoft.PowerPlatform/register/*","Microsoft.PowerPlatform/register/action"]]},6852:function(e,t,n){"use strict";var o;n.r(t),n.d(t,"BillingWizardPanelStep",(function(){return o})),n.d(t,"IBillingWizardPanelStepElements",(function(){return r})),function(e){e[e.SelectPlanType=0]="SelectPlanType",e[e.EnterSubscriptionDetails=1]="EnterSubscriptionDetails"}(o||(o={}));class r{constructor(){this.title=void 0,this.subtitle=void 0,this.body=void 0,this.footerButtons=void 0,this.getMessageBar=void 0,this.headerLeftButtonProps=void 0}}},6853:function(e,t,n){"use strict";n.r(t),n.d(t,"SelectPlanTypeStep",(function(){return b}));var o=n(1259),r=n(245),a=n.n(r),i=n(5731),s=n(2869),l=n(6557),c=n(6854),p=n(6852),u=n(5732),d=n(2879),m=n(2903);class b extends p.IBillingWizardPanelStepElements{constructor(e){super(),this.resources=void 0,this.props=void 0,this.getMessageBarImp=()=>({messageBarProps:{messageBarType:o.MessageBarType.warning},onRenderBody:()=>a.a.createElement("span",null,this.resources.Controllers.BillingWizard.SelectPlanType.infoMessageBarText)}),this.getSelectPlanTypeElements=()=>{var e,t=Object(m.getId)("nameFieldLabel");return a.a.createElement("div",{className:c.BillingWizardPanelStyleClasses.billingWizard},a.a.createElement("div",{className:"billing-plan-section"},a.a.createElement("div",{className:"billing-plan-header"},this.resources.Controllers.BillingWizard.SelectPlanType.TargetEnvironment),null===(e=this.props.currentEnvironment)||void 0===e?void 0:e.properties.displayName),a.a.createElement(o.TextField,{label:this.resources.Controllers.BillingWizard.SelectPlanType.name,onRenderLabel:(e,n)=>a.a.createElement(o.Stack,{horizontal:!0,verticalAlign:"center"},a.a.createElement("div",{id:t,className:"billing-plan-header"},e.label),a.a.createElement(o.TooltipHost,{content:this.resources.Controllers.BillingWizard.SelectPlanType.nameTooltip},a.a.createElement(o.Icon,{className:"billing-plan-policy-name-icon",iconName:d.fabricIcons.Info,tabIndex:0,ariaLabel:this.resources.Controllers.BillingWizard.SelectPlanType.nameTooltip})),a.a.createElement("span",null,n({label:" ",required:!0}))),"aria-labelledby":t,onChange:this.onNameChange,onGetErrorMessage:e=>this.getIsNameValidElement(),deferredValidationTime:500,required:!0,value:this.props.billingPlanName,className:"billing-plan-dropdown"}))},this.onNameChange=(e,t)=>{this.props.setBillingPlanName(t)},this.getSelectPlanTypeFooterButtons=()=>[{primary:!0,ariaLabel:this.resources.Common.next,text:this.resources.Common.next,dismissableOnClick:()=>{this.props.addSubscriptionDetailsStepScenarioRef.current=Object(i.sendPerformanceTelemetry)(void 0,u.featureName,u.BillingWizardTelemetryScenarios.AddSubscriptionDetailsStep.pageOpened),Object(i.sendUsageTelemetry)(u.featureName,u.BillingWizardTelemetryScenarios.SelectPlanTypeStep.nextClicked,{newState:p.BillingWizardPanelStep.EnterSubscriptionDetails}),this.props.setBillingWizardStep(p.BillingWizardPanelStep.EnterSubscriptionDetails)},disabled:!this.isPlanNameValid(this.props.billingPlanName)},{ariaLabel:this.resources.Common.back,text:this.resources.Common.back,dismissableOnClick:e=>{Object(i.sendUsageTelemetry)(u.featureName,u.BillingWizardTelemetryScenarios.SelectPlanTypeStep.backClicked),e()}}],this.props=e,this.resources=Object(s.getResources)(),this.title=this.resources.Controllers.BillingWizard.SelectPlanType.title,this.subtitle=this.resources.Controllers.BillingWizard.SelectPlanType.subtitle,this.body=this.getSelectPlanTypeElements,this.footerButtons=this.getSelectPlanTypeFooterButtons,this.getMessageBar=this.getMessageBarImp}getIsNameValidElement(){if(!this.props.billingPlanName)return"";if(0==this.isPlanNameValid(this.props.billingPlanName)){var e=this.resources.Controllers.BillingWizard.SelectPlanType.nameErrorMessage;return this.isUnique(this.props.billingPlanName)||(e=this.resources.Controllers.BillingWizard.SelectPlanType.nameNotUniqueErrorMessage),a.a.createElement("div",null,a.a.createElement(o.Stack,{horizontal:!0},a.a.createElement(o.Icon,{"aria-label":this.resources.Common.warning,iconName:"warning",className:"billing-warning"}),a.a.createElement(o.Text,{"aria-label":e,className:"billing-warning-text"},e)))}return""}isPlanNameValid(e){return!!e&&(!(e.length<10||e.length>64)&&(Object(l.isAlphaNumeric)(e)&&this.isUnique(e)))}isUnique(e){if(!e)return!0;if(this.props.billingPolicies)for(var t=0;t<this.props.billingPolicies.length;t++)if(this.props.billingPolicies[t].name.toLowerCase()===e.toLowerCase())return!1;return!0}}},6854:function(e,t,n){"use strict";n.r(t),n.d(t,"BillingWizardPanelStyleClasses",(function(){return i}));var o=n(719),r=n(5492),a=n(2882),i=Object(o.mergeStyleSets)({billingWizard:{selectors:{".billing-plan-spinner .spinner":{top:"auto"},label:{font:"14px ".concat(r.fonts.segoeUi),maxWidth:"none",marginBottom:"5px"},".billing-plan-section":{marginBottom:"12px",maxWidth:"300px",label:{font:"14px ".concat(r.fonts.segoeUi),fontWeight:600}},".billing-plan-paygo-description":{marginBottom:"12px",label:{font:"14px ".concat(r.fonts.segoeUi),fontWeight:600}},".billing-plan-paygo-bulletsContainer":{maxWidth:"400px",marginTop:"12px",alignItems:"center",marginLeft:"100px"},".billing-plan-paygo-bullets":{marginBottom:"12px"},".billing-plan-paygo-icon":{paddingRight:"8px",verticalAlign:"middle",color:a.fabricColors.neutralPlum,lineHeight:"20px",fontSize:"20px"},".billing-plan-dropdown":{marginBottom:"6px",maxWidth:"300px",label:{font:"14px ".concat(r.fonts.segoeUi),fontWeight:600}},".billing-warning":{paddingRight:"8px",verticalAlign:"middle",color:a.fabricColors.warningYellow,lineHeight:"16px"},".billing-plan-header":{fontFamily:r.fonts.segoeUi,fontWeight:600,color:a.fabricColors.black,marginBottom:"5px"},".billing-plan-subtitle":{marginBottom:"12px"},".billing-plan-policy-name-icon":{fontSize:"12px",paddingLeft:"4px",paddingRight:"4px",paddingBottom:"8px"}}}})},6855:function(e,t,n){"use strict";n.r(t),n.d(t,"AddSubscriptionDetailsStep",(function(){return b}));var o=n(1259),r=n(245),a=n.n(r),i=n(5731),s=n(2869),l=n(6854),c=n(6852),p=n(1089),u=n(5883),d=n(5732);function m(e,t,n,o,r,a,i){try{var s=e[a](i),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(o,r)}class b extends c.IBillingWizardPanelStepElements{constructor(e){var t;super(),t=this,this.props=void 0,this.resources=void 0,this.getMessageBarImp=()=>this.props.subscriptions&&0==this.props.subscriptions.length?{messageBarProps:{messageBarType:o.MessageBarType.error},onRenderBody:()=>a.a.createElement("span",null,Object(p.formatResourceStringAsLinks)(this.resources.Controllers.BillingWizard.EnterSubscription.noSubscriptionError,[],{onClick:()=>{this.props.setCurrentSubscription(null),this.props.setCurrentResourceGroups(null),this.props.loadSubscriptions()}}))}:this.props.currentSubscription&&this.props.resourceGroups&&0==this.props.resourceGroups.length?{messageBarProps:{messageBarType:o.MessageBarType.error},onRenderBody:()=>a.a.createElement("span",null,Object(p.formatResourceStringAsLinks)(this.resources.Controllers.BillingWizard.EnterSubscription.noResourceGroupError,[],{onClick:()=>{this.props.setCurrentSubscription(null),this.props.setCurrentResourceGroups(null),this.props.loadSubscriptions()}}))}:this.props.addBillingPolicyAndLinkEnvironmentsMutationProps.errorMessage?{messageBarProps:{messageBarType:o.MessageBarType.error},onRenderBody:()=>a.a.createElement("span",null,this.resources.Common.Request.Failed,a.a.createElement(u.StyledAccordion,{text:this.resources.Common.Request.SeeDetails,onRenderContent:()=>a.a.createElement("div",null,this.props.addBillingPolicyAndLinkEnvironmentsMutationProps.errorMessage)}))}:{messageBarProps:{messageBarType:o.MessageBarType.warning},onRenderBody:()=>a.a.createElement("span",null,this.resources.Controllers.BillingWizard.EnterSubscription.infoMessageBarText)},this.getSubscriptionDetailsStateElements=()=>{var e,t,n,r,i=null===(e=this.props.subscriptions)||void 0===e?void 0:e.map(e=>({key:e.subscriptionId,text:e.displayName,data:e})),s=null===(t=this.props.resourceGroups)||void 0===t?void 0:t.map(e=>({key:e.id,text:e.name,data:e}));return a.a.createElement("div",{className:l.BillingWizardPanelStyleClasses.billingWizard},a.a.createElement("div",{className:"billing-plan-section"},a.a.createElement("div",{className:"billing-plan-header"},this.resources.Controllers.BillingWizard.EnterSubscription.billingPlanName),this.props.billingPlanName),a.a.createElement("div",{className:"billing-plan-section"},a.a.createElement("div",{className:"billing-plan-header"},this.resources.Controllers.BillingWizard.EnterSubscription.type),this.resources.Controllers.BillingWizard.EnterSubscription.paygoType),a.a.createElement("div",{className:"billing-plan-section"},a.a.createElement("div",{className:"billing-plan-header"},this.resources.Controllers.BillingWizard.EnterSubscription.environment),null===(n=this.props.currentEnvironment)||void 0===n?void 0:n.properties.displayName),a.a.createElement("div",{className:"billing-plan-section"},a.a.createElement(o.Dropdown,{className:"billing-plan-dropdown",label:this.resources.Controllers.BillingWizard.EnterSubscription.azureSubscription,options:i,onChange:this.onSubscriptionDropdownChanged,selectedKey:this.props.currentSubscription?this.props.currentSubscription.subscriptionId:null,required:!0})),a.a.createElement("div",{className:"billing-plan-section"},a.a.createElement(o.Dropdown,{className:"billing-plan-dropdown",label:this.resources.Controllers.BillingWizard.EnterSubscription.resourceGroup,options:s,selectedKey:null===(r=this.props.currentResourceGroup)||void 0===r?void 0:r.id,onChange:this.onResourceGroupDropdownChanged,isDisabled:!this.props.resourceGroups,required:!0})))},this.onSubscriptionDropdownChanged=(e,t,n)=>{var o=t.data;this.props.setCurrentSubscription(o),this.props.setCurrentResourceGroups(null),Object(i.sendUsageTelemetry)(d.featureName,d.BillingWizardTelemetryScenarios.AddSubscriptionDetailsStep.subscriptionSelected)},this.onResourceGroupDropdownChanged=(e,t,n)=>{var o=t.data;Object(i.sendUsageTelemetry)(d.featureName,d.BillingWizardTelemetryScenarios.AddSubscriptionDetailsStep.resourceGroupSelected),this.props.setCurrentResourceGroups(o)},this.getSubscriptionDetailsStateFooterButtons=()=>{return[{ariaLabel:this.resources.Common.back,text:this.resources.Common.back,dismissableOnClick:()=>{Object(i.sendUsageTelemetry)(d.featureName,d.BillingWizardTelemetryScenarios.AddSubscriptionDetailsStep.backClicked,{newState:c.BillingWizardPanelStep.SelectPlanType}),this.props.setCurrentStep(c.BillingWizardPanelStep.SelectPlanType)}},{primary:!0,ariaLabel:this.resources.Controllers.BillingWizard.EnterSubscription.createPlan,text:this.resources.Controllers.BillingWizard.EnterSubscription.createPlan,dismissableOnClick:(e=function*(){t.props.beginCreatePolicyScenario(),Object(i.sendUsageTelemetry)(d.featureName,d.BillingWizardTelemetryScenarios.createBillingPolicy),t.props.addBillingPolicyAndLinkEnvironmentsMutationProps.addBillingPolicyAndLinkEnvironments()},n=function(){var t=this,n=arguments;return new Promise((function(o,r){var a=e.apply(t,n);function i(e){m(a,o,r,i,s,"next",e)}function s(e){m(a,o,r,i,s,"throw",e)}i(void 0)}))},function(){return n.apply(this,arguments)}),disabled:!(this.props.currentSubscription&&this.props.currentResourceGroup&&!this.props.addBillingPolicyAndLinkEnvironmentsMutationProps.loading&&!this.props.planLoading)}];var e,n},this.onBackClicked=()=>{this.props.setCurrentStep(c.BillingWizardPanelStep.SelectPlanType)},this.props=e,this.resources=Object(s.getResources)(),this.title=this.resources.Controllers.BillingWizard.EnterSubscription.title,this.subtitle=this.resources.Controllers.BillingWizard.EnterSubscription.subtitle,this.body=this.getSubscriptionDetailsStateElements,this.footerButtons=this.getSubscriptionDetailsStateFooterButtons,this.headerLeftButtonProps={ariaLabel:this.resources.Common.back,iconProps:{iconName:"Back"},autoFocus:!0,onClick:this.onBackClicked},this.getMessageBar=this.getMessageBarImp}}},6856:function(e,t,n){"use strict";n.r(t),n.d(t,"RenamePanelContainer",(function(){return l}));var o=n(245),r=n.n(o),a=n(6857),i=n(5596);function s(){return(s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}var l=e=>{var{onPanelDismiss:t,appId:n,selectedApp:l,canRefetch:c,setCanRefetch:p}=e,u=i.getAppDisplayName(l).trim(),[d,m]=Object(o.useState)(u),b={panelDetails:{appId:n,displayName:d,setDisplayName:m,canRefetch:c,setCanRefetch:p,onPanelDismiss:t}};return r.a.createElement(a.RenamePanel,s({defaultPanelProps:e.defaultPanelProps},b))}},6857:function(e,t,n){"use strict";n.r(t),n.d(t,"RenamePanel",(function(){return O}));var o=n(684),r=n(1697),a=n(1573),i=n(1429),s=n(245),l=n(2698),c=n(922),p=n(6858),u=n(3144),d=n(1795),m=n(2956),b=n(900),g=n(1201),y=n(6860),S=n(545),f=n(217);function h(){return(h=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}var O=Object(c.translateService)("PowerappsPortal")(Object(S.styled)(e=>{var{t:t,panelDetails:n,theme:c,styles:y}=e,{appId:S,displayName:O,setDisplayName:C,onPanelDismiss:v,setCanRefetch:P}=n,{environmentClient:E}=Object(s.useContext)(u.ApolloClientContext),T=Object(m.classNamesFunction)()(y,{theme:c,panelDetails:n}),[j,A]=Object(s.useState)(!1),[R,I]=Object(s.useState)(!1),[w,D]=Object(s.useState)(""),N=Object(f.trackUpdateScenario)(l.PortalScope,"ComponentLibrary/Rename"),{renameApp:L,loading:M,errorMessage:x}=Object(p.useRenameAppQuery)(E,{appId:S,displayName:O},l.PortalScope,t("Common.Request.Failed")),k=e=>0===e.trim().length?(A(!1),t("AppRenamePanel.DisplayName.Validation.Empty.text")):e.trim().length>64?(A(!1),t("AppRenamePanel.DisplayName.Validation.MaxLength.text")):/^[^.\\\/:*?\"<>|]+$/gim.test(e)?(A(!0),""):(A(!1),t("AppRenamePanel.DisplayName.Validation.AllowedCharacters.text")),F=Object(s.useCallback)(()=>!M&&s.createElement(d.Stack,{horizontal:!0,horizontalAlign:"start"},s.createElement(o.PrimaryButton,{disabled:!j||R,text:t("Common.Save.save"),onClick:U,className:T.primaryButton}),s.createElement(o.DefaultButton,{text:t("Common.Save.cancel"),onClick:()=>V(!0)})),[M,O,v,R,j]),_=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";O!==t&&(C&&C(t),I(!1))},U=Object(s.useCallback)(()=>{L({variables:{appId:S,displayName:O}}),P&&P(!0),x||I(!0),N.complete({scenario:"AppRename",app:S})},[O,x]);Object(s.useEffect)(()=>{x?(D(x),I(!1),N.failure({errorMessage:x})):(D(""),I(!0))},[x]);var V=s.useCallback((function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];v&&v(e),P&&P(!1)}),[v]);return s.createElement(a.Panel,h({},e.defaultPanelProps,{closeButtonAriaLabel:t("Common.close"),headerText:t("ComponentLibraries.ManageComponentLibrary.Rename.Panel.title"),className:T.panel,onDismiss:()=>V(!0),isFooterAtBottom:!0,onRenderFooterContent:F}),!!w&&s.createElement(r.MessageBar,{messageBarType:r.MessageBarType.error,isMultiline:!0,dismissButtonAriaLabel:t("Common.close"),onDismiss:()=>D("")},w),!!M&&s.createElement(b.Overlay,{styles:{root:{backgroundColor:null==c?void 0:c.palette.white,opacity:.9}}},s.createElement(g.Spinner,{size:g.SpinnerSize.large,label:t("Common.Loading.ellipses"),ariaLabel:t("Common.Loading.ellipses"),ariaLive:"assertive",labelPosition:"right"})),null!==O&&!M&&s.createElement(i.TextField,{label:t("ComponentLibraries.ManageComponentLibrary.Rename.Panel.title"),value:O,onChange:_,onGetErrorMessage:k,required:!0}))},y.getRenamePanelStyles))},6858:function(e,t,n){"use strict";n.r(t),n.d(t,"useDeleteCanvasAppQuery",(function(){return c})),n.d(t,"useRenameAppQuery",(function(){return p}));var o=n(3152),r=n(217),a=n(245),i=n(3192),s=n(3193),l=n(6859);function c(e,t,n){var c=s.TelemetryScenarioNames.deleteCanvasApp,[p,u]=Object(a.useState)(),[d,m]=Object(a.useState)(""),[b,{loading:g,data:y}]=Object(o.useMutation)(l.DeleteCanvasAppQuery,{client:e||void 0,onCompleted:()=>{p&&p.complete()},onError:e=>{var t=e.message,o=Object(i.getResponseMessageFromApolloError)(e,n);m(o),p&&p.failure({error:o,clientError:t})}});return Object(a.useEffect)(()=>{g||u(Object(r.trackLoadScenario)(t,c))},[g]),{deleteApp:b,data:y&&y.deleteCanvasAppById.appName,loading:g,errorMessage:d}}function p(e,t,n,c){var p=s.TelemetryScenarioNames.renameApp,[u,d]=Object(a.useState)(),[m,b]=Object(a.useState)(""),[g,{loading:y,data:S}]=Object(o.useMutation)(l.RenameAppQuery,{client:e||void 0,onCompleted:()=>{null==u||u.complete(),b("")},onError:e=>{var t=e.message,n=Object(i.getResponseMessageFromApolloError)(e,c);b(n),u&&u.failure({error:n,clientError:t})},variables:t});return Object(a.useEffect)(()=>{y||d(Object(r.trackLoadScenario)(n,p))},[y]),{renameApp:g,data:null==S?void 0:S.renameApp,loading:y,errorMessage:m}}},6860:function(e,t,n){"use strict";n.r(t),n.d(t,"getRenamePanelStyles",(function(){return o}));var o=e=>({panel:{selectors:{".ms-Panel-commands":{marginTop:16},".ms-Panel-header":{paddingLeft:16,paddingRight:16},".ms-Panel-content":{paddingLeft:16,paddingRight:16,paddingBottom:16,marginBottom:11},".ms-Overlay .ms-Spinner":{position:"relative",top:"40%",transform:"translateY(-50%)"}}},errorMessageBar:{marginTop:24},primaryButton:{marginRight:8}})},6861:function(e,t,n){"use strict";n.r(t),n.d(t,"CreateBillingPlanState",(function(){return o}));class o{constructor(){this.isSuccessful=void 0,this.isSuccessful=!1}getValue(){return this.isSuccessful}setValue(e){this.isSuccessful=e}}},6862:function(e,t,n){"use strict";n.r(t),n.d(t,"mapStateToProps",(function(){return d})),n.d(t,"mapDispatchToProps",(function(){return m})),n.d(t,"mergeProps",(function(){return b})),n.d(t,"UpdateConRefsPanelContainer",(function(){return g}));var o=n(5437),r=n(5468),a=n(5478),i=n(6863),s=n(6383),l=n(5704);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var d=e=>({conRefsNeedUpdate:Object(s.conRefsNeedUpdateSelector)(e),batchModifyConRefResponse:Object(s.batchModifyConRefResponseSelector)(e)}),m=e=>({updateConRef:t=>{e(Object(l.batchModifyConnectionReference)({updateContext:t}))},onDismissPanel:()=>{e(r.sharedActions.panelClose({panelType:a.PanelToShowType.UpdateConRefsPanel}))}}),b=(e,t,n)=>p(p(p({},e),t),n),g=Object(o.connect)(d,m,b)(i.UpdateConRefsPanel)},6863:function(e,t,n){"use strict";n.r(t),n.d(t,"UpdateConRefsPanel",(function(){return b}));var o=n(1573),r=n(245),a=n(5466),i=n(6864),s=n(6708),l=n(6710),c=n(3144),p=n(6865),u=n(6701),d=n(2869);function m(){return(m=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}var b=e=>{var t=Object(p.getUpdateConRefsLabels)(Object(d.getResources)()),{environmentClient:n}=Object(r.useContext)(c.ApolloClientContext),[b,g]=Object(r.useState)(new Map),[y,S]=Object(r.useState)(s.UpdateConRefsPanelSteps.conRefs),[f,h]=Object(r.useState)(void 0),{connectionTypes:O,loadConnectionTypesErrorMessage:C,loadConnectionsErrorMessage:v,isLoadingConnections:P,isLoadingConnectionTypes:E,onRefreshConnections:T}=Object(l.useUpdateConnectionReferenceBehavior)(n,g,t.Errors.StandardErrorMessages),j={hasCloseButton:!0,closeButtonAriaLabel:t.close,type:o.PanelType.medium,headerText:t.title},A={title:t.DismissPanel.title,confirmButtonText:t.DismissPanel.confirmButtonText,cancelButtonText:t.DismissPanel.cancelButtonText};Object(r.useEffect)(()=>{var t=e.conRefsNeedUpdate.map(u.mapToPickerConnectionRefereces);h(t)},[]);var R=[Object(i.useUpdateConRefsPanel)(j,t,e.conRefsNeedUpdate,f,b,O,h,e.updateConRef,e.batchModifyConRefResponse,e.onDismissPanel,T,C||v,P||E)];return r.createElement(a.MultistepPanel,m({customWidth:void 0,dismissOnEscape:void 0,isBlocking:!0,isHiddenOnDismiss:!0,onDismissed:void 0,onLightDismissClick:void 0,isLightDismiss:!1,onOuterClick:void 0,isOpen:void 0},e.defaultPanelProps,{onDismiss:()=>{e.onDismissPanel()},showDismissDialog:!0,dismissDialog:A,panelsListProps:R,panelOpenIndex:y,setPanelOpenIndex:S,hideLeftHeaderBackButton:!0}))}},6864:function(e,t,n){"use strict";n.r(t),n.d(t,"useUpdateConRefsPanel",(function(){return y}));var o=n(245),r=n.n(o),a=n(1697),i=n(1201),s=n(217),l=n(1106),c=n(6695),p=n(6708),u=n(6707),d=n(6709);function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){g(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function y(e,t,n,m,g,y,S,f,h,O,C,v,P){var E,T,{currentEnvironment:j}=Object(o.useContext)(l.EnvironmentContext),[A,R]=Object(o.useState)(),[I,w]=r.a.useState(!1),[D,N]=Object(o.useState)([]);(v||A)&&(E={messageBarProps:{messageBarType:a.MessageBarType.error,dismissButtonAriaLabel:t.close},onRenderBody:()=>r.a.createElement("div",null,v&&r.a.createElement("div",null,v),A&&r.a.createElement("div",null,A))}),P||I?T={spinnerProps:{size:i.SpinnerSize.large,label:t.loading,ariaLabel:t.loading,ariaLive:"polite",role:"alert"}}:!h.loading||h.success||h.failed?h.success&&!h.failed?O():h.failed&&!h.success&&R(h.message):T={spinnerProps:{size:i.SpinnerSize.large,label:t.updating,ariaLabel:t.updating,ariaLive:"polite",role:"alert"}};var L=b({currentStep:u.FriendlyUpdateConRefsPanelSteps.get(p.UpdateConRefsPanelSteps.conRefs)},Object(u.getConnectionReferencesTelemetryData)(m,g));return b(b({},e),{},{messageBar:E,children:r.a.createElement(c.MultiConnectionsPicker,{setErrorMessage:R,connectionReferences:m,connections:g,connectionTypes:y,onChangeConnectionSelection:(e,t,o)=>{var r=[...n],a=[...m],i=r.find(t=>t.connectionreferencelogicalname===e.connectionreferencelogicalname),s=a.find(t=>t.connectionreferencelogicalname===e.connectionreferencelogicalname);if(i&&s){s.selectedConnectionName=t;var l={connectionreferenceid:i.connectionreferenceid,connectionid:t};D.push({solution:{solutionId:i.solutionid,solutionName:null},toUpdate:l}),N(D),S(a)}},headerContent:t.content,onRefreshConnections:C,telemetryScope:u.SolutionEventScope,environmentName:null==j?void 0:j.name,setIsLoadingConnectionReferencesFlowWidget:w}),className:d.panelContentStyles.panelStyles,styles:{content:{display:"flex",width:"100%"},contentInner:{display:"flex"},scrollableContent:{display:"flex",padding:"0px 24px 24px 24px"}},loadingOverlay:T,footerButtons:[{primary:!0,navigateableOnClick:(e,t)=>(Object(s.trackUserActionClickButton)(u.SolutionEventScope,u.SolutionEventNames.Dismiss,b({},L)),f(D),null),ariaLabel:t.saveClose,text:t.saveClose},{primary:!1,ariaLabel:t.cancel,text:t.cancel,navigateableOnClick:(e,t)=>(Object(s.trackUserActionClickButton)(u.SolutionEventScope,u.SolutionEventNames.Dismiss,b({},L)),t(),null)}]})}},6865:function(e,t,n){"use strict";function o(e){return{close:e.Common.close,saveClose:e.Model.Solutions.UpdateConRefsPanel.saveAndClose,cancel:e.Common.Save.cancel,title:e.Model.Solutions.UpdateConRefsPanel.title,loading:e.Model.Solutions.UpdateConRefsPanel.loading,updating:e.Model.Solutions.UpdateConRefsPanel.updating,content:e.Model.Solutions.UpdateConRefsPanel.content,DismissPanel:{title:e.Common.DismissDialog.title,confirmButtonText:e.Common.DismissDialog.confirmButtonText,cancelButtonText:e.Common.DismissDialog.cancelButtonText},Errors:{StandardErrorMessages:{authenticationError:e.Common.StandardErrorMessages.authenticationError,authorizationError:e.Common.StandardErrorMessages.authorizationError,serverResponseCodeError:e.Common.StandardErrorMessages.serverResponseCodeError,unknownErrorType:e.Common.StandardErrorMessages.unknownErrorType},requestFailed:e.Common.Request.Failed}}}n.r(t),n.d(t,"getUpdateConRefsLabels",(function(){return o}))},6866:function(e,t,n){"use strict";n.r(t),n.d(t,"ConnectionsActionTypes",(function(){return o})),n.d(t,"fetchConnectionsRequest",(function(){return l})),n.d(t,"fetchConnectionsCancelPoll",(function(){return c})),n.d(t,"fetchConnectionsFulfilled",(function(){return p})),n.d(t,"fetchConnectionsRejected",(function(){return u})),n.d(t,"fetchConnectionRequest",(function(){return d})),n.d(t,"fetchConnectionFulfilled",(function(){return m})),n.d(t,"fetchConnectionRejected",(function(){return b})),n.d(t,"openConnectionPivot",(function(){return g})),n.d(t,"consentConnection",(function(){return y})),n.d(t,"createConnection",(function(){return S})),n.d(t,"editConnection",(function(){return f})),n.d(t,"deleteConnection",(function(){return h})),n.d(t,"deleteConnectionFulfilled",(function(){return O})),n.d(t,"openShareConnectionModal",(function(){return C})),n.d(t,"fetchConnectionUsagesRequest",(function(){return v})),n.d(t,"fetchConnectionUsagesCancelPoll",(function(){return P})),n.d(t,"fetchConnectionUsagesFulfilled",(function(){return E})),n.d(t,"fetchConnectionUsagesRejected",(function(){return T})),n.d(t,"fetchConnectionGatewayCancelPoll",(function(){return j})),n.d(t,"fetchConnectionGatewayRequest",(function(){return A})),n.d(t,"fetchConnectionGatewayFulfilled",(function(){return R})),n.d(t,"fetchConnectionGatewayRejected",(function(){return I}));var o,r=n(5470);function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e){var t=i({pollOptions:{shouldPoll:!0,pollStopAction:c()}},e);return{type:o.FETCH_CONNECTIONS_REQUEST,payload:t}}function c(){return{type:o.FETCH_CONNECTIONS_CANCEL_POLL}}function p(e){return e.normalizedResourceType=r.NormalizedResourceType.Connections,{type:o.FETCH_CONNECTIONS_FULFILLED,payload:e}}function u(e){return{type:o.FETCH_CONNECTIONS_REJECTED,payload:e}}function d(e){return{type:o.FETCH_CONNECTION_REQUEST,payload:e}}function m(e){return{type:o.FETCH_CONNECTION_FULFILLED,payload:e}}function b(e){return{type:o.FETCH_CONNECTION_REJECTED,payload:e}}function g(e){return{type:o.OPEN_CONNECTION_PIVOT,payload:e}}function y(e){return{type:o.CONSENT_CONNECTION,payload:e}}function S(e){return{type:o.CREATE_CONNECTION,payload:e}}function f(e){return{type:o.EDIT_CONNECTION,payload:e}}function h(e){return{type:o.DELETE_CONNECTION,payload:e}}function O(e){return{type:o.DELETE_CONNECTION_FULFILLED,payload:e}}function C(e){return{type:o.SHARE_CONNECTION,payload:e}}function v(e){var t=i({pollOptions:{shouldPoll:!0,pollStopAction:P()}},e);return{type:o.FETCH_CONNECTION_USAGES_REQUEST,payload:t}}function P(){return{type:o.FETCH_CONNECTION_USAGES_CANCEL_POLL}}function E(e){return{type:o.FETCH_CONNECTION_USAGES_FULFILLED,payload:e}}function T(e){return{type:o.FETCH_CONNECTION_USAGES_REJECTED,payload:e}}function j(){return{type:o.FETCH_CONNECTION_GATEWAY_CANCEL_POLL}}function A(e){var t=i({pollOptions:{shouldPoll:!0,pollStopAction:j()}},e);return{type:o.FETCH_CONNECTION_GATEWAY_REQUEST,payload:t}}function R(e){return{type:o.FETCH_CONNECTION_GATEWAY_FULFILLED,payload:e}}function I(e){return{type:o.FETCH_CONNECTION_GATEWAY_REJECTED,payload:e}}!function(e){e.FETCH_CONNECTIONS_REQUEST="maker/connections/FETCH_CONNECTIONS_REQUEST",e.FETCH_CONNECTIONS_FULFILLED="maker/connections/FETCH_CONNECTIONS_FULFILLED",e.FETCH_CONNECTIONS_REJECTED="maker/connections/FETCH_CONNECTIONS_REJECTED",e.FETCH_CONNECTIONS_CANCEL_POLL="maker/connections/FETCH_CONNECTIONS_CANCEL_POLL",e.FETCH_CONNECTION_REQUEST="maker/connections/FETCH_CONNECTION_REQUEST",e.FETCH_CONNECTION_FULFILLED="maker/connections/FETCH_CONNECTION_FULFILLED",e.FETCH_CONNECTION_REJECTED="maker/apps/FETCH_CONNECTION_REJECTED",e.FETCH_CONNECTION_DETAILS_REQUEST="maker/connections/FETCH_CONNECTION_DETAILS_REQUEST",e.FETCH_CONNECTION_DETAILS_FULFILLED="maker/connections/FETCH_CONNECTION_DETAILS_FULFILLED",e.FETCH_CONNECTION_DETAILS_REJECTED="maker/connections/FETCH_CONNECTION_DETAILS_REJECTED",e.OPEN_CONNECTION_PIVOT="maker/connections/commands/OPEN_CONNECTION_PIVOT",e.CONSENT_CONNECTION="maker/connections/commands/CONSENT_CONNECTION",e.CREATE_CONNECTION="maker/connections/commands/CREATE_CONNECTION",e.EDIT_CONNECTION="maker/connections/commands/EDIT_CONNECTION",e.DELETE_CONNECTION="maker/connections/commands/DELETE_CONNECTION",e.DELETE_CONNECTION_FULFILLED="maker/connections/commands/DELETE_CONNECTION_FULFILLED",e.SWITCH_ACCOUNT="maker/connections/commands/SWITCH_ACCOUNT",e.SHARE_CONNECTION="maker/connections/commands/SHARE_CONNECTION",e.FETCH_CONNECTION_USAGES_REQUEST="maker/connections/commands/FETCH_CONNECTION_USAGES_REQUEST",e.FETCH_CONNECTION_USAGES_FULFILLED="maker/connections/commands/FETCH_CONNECTION_USAGES_FULFILLED",e.FETCH_CONNECTION_USAGES_REJECTED="maker/connections/commands/FETCH_CONNECTION_USAGES_REJECTED",e.FETCH_CONNECTION_USAGES_CANCEL_POLL="maker/connections/commands/FETCH_CONNECTION_USAGES_CANCEL_POLL",e.FETCH_CONNECTION_GATEWAY_REQUEST="maker/connections/commands/FETCH_CONNECTION_GATEWAY_REQUEST",e.FETCH_CONNECTION_GATEWAY_FULFILLED="maker/connections/commands/FETCH_CONNECTION_GATEWAY_FULFILLED",e.FETCH_CONNECTION_GATEWAY_REJECTED="maker/connections/commands/FETCH_CONNECTION_GATEWAY_REJECTED",e.FETCH_CONNECTION_GATEWAY_CANCEL_POLL="maker/connections/commands/FETCH_CONNECTION_GATEWAY_CANCEL_POLL"}(o||(o={}))},6867:function(e,t,n){"use strict";n.r(t),n.d(t,"GatewaysActionTypes",(function(){return o})),n.d(t,"fetchGatewaysRequest",(function(){return l})),n.d(t,"fetchGatewaysFulfilled",(function(){return c})),n.d(t,"fetchGatewaysRejected",(function(){return p})),n.d(t,"fetchGatewaysCancelPoll",(function(){return u})),n.d(t,"fetchGatewayRequest",(function(){return d})),n.d(t,"fetchGatewayCancelPoll",(function(){return m})),n.d(t,"fetchGatewayFulfilled",(function(){return b})),n.d(t,"fetchGatewayRejected",(function(){return g})),n.d(t,"createGateway",(function(){return y})),n.d(t,"openGatewayDetails",(function(){return S})),n.d(t,"openGatewayHelp",(function(){return f})),n.d(t,"deleteGateway",(function(){return h})),n.d(t,"openDeleteGatewayDialogue",(function(){return O})),n.d(t,"deleteGatewayFulfilled",(function(){return C})),n.d(t,"deleteGatewayRejected",(function(){return v})),n.d(t,"fetchGatewayConnectionsRequest",(function(){return P})),n.d(t,"fetchGatewayConnectionsFulfilled",(function(){return E})),n.d(t,"fetchGatewayConnectionsRejected",(function(){return T})),n.d(t,"openShareGatewayModal",(function(){return j})),n.d(t,"PatchGatewayRequest",(function(){return A})),n.d(t,"patchGatewayFulfilled",(function(){return R})),n.d(t,"patchGatewayRejected",(function(){return I}));var o,r=n(5470);function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e){var t=i({pollOptions:{shouldPoll:!0,pollStopAction:u()}},e);return{type:o.FETCH_GATEWAYS_REQUEST,payload:t}}function c(e){return e.normalizedResourceType=r.NormalizedResourceType.Gateways,{type:o.FETCH_GATEWAYS_FULFILLED,payload:e}}function p(e){return{type:o.FETCH_GATEWAYS_REJECTED,payload:e}}function u(){return{type:o.FETCH_GATEWAYS_CANCEL_POLL}}function d(e){var t=i({pollOptions:{shouldPoll:!0,pollStopAction:m()}},e);return{type:o.FETCH_GATEWAY_REQUEST,payload:t}}function m(){return{type:o.FETCH_GATEWAY_CANCEL_POLL}}function b(e){return{type:o.FETCH_GATEWAY_FULFILLED,payload:e}}function g(e){return{type:o.FETCH_GATEWAY_REJECTED,payload:e}}function y(){return{type:o.CREATE_GATEWAY}}function S(e){return{type:o.OPEN_GATEWAY_DETAILS,payload:e}}function f(){return{type:o.OPEN_GATEWAY_HELP}}function h(e){return{type:o.DELETE_GATEWAY,payload:e}}function O(e){return e.gateway.id=e.gateway.id.replace("gatewayClusters","gateways"),{type:o.DELETE_GATEWAY_REQUEST,payload:e}}function C(e){return{type:o.DELETE_GATEWAY_FULFILLED,payload:e}}function v(e){return{type:o.DELETE_GATEWAY_REJECTED,payload:e}}function P(e){return{type:o.FETCH_GATEWAY_CONNECTIONS_REQUEST,payload:e}}function E(e){return{type:o.FETCH_GATEWAY_CONNECTIONS_FULFILLED,payload:e}}function T(e){return{type:o.FETCH_GATEWAY_CONNECTIONS_REJECTED,payload:e}}function j(e){return e.gateway.id=e.gateway.id.replace("gatewayClusters","gateways"),{type:o.SHARE_GATEWAY,payload:e}}function A(e){var t={gatewayId:e.gatewayId,state:e.state};return{type:o.PATCH_GATEWAY_REQUEST,payload:t}}function R(e){return{type:o.PATCH_GATEWAY_FULFILLED,payload:e}}function I(e){return{type:o.PATCH_GATEWAY_REJECTED,payload:e}}!function(e){e.FETCH_GATEWAYS_REQUEST="maker/gateways/FETCH_GATEWAYS_REQUEST",e.FETCH_GATEWAYS_FULFILLED="maker/gateways/FETCH_GATEWAYS_FULFILLED",e.FETCH_GATEWAYS_REJECTED="maker/gateways/FETCH_GATEWAYS_REJECTED",e.FETCH_GATEWAYS_CANCEL_POLL="maker/gateways/FETCH_GATEWAYS_CANCEL_POLL",e.FETCH_GATEWAY_REQUEST="maker/gateways/FETCH_GATEWAY_REQUEST",e.FETCH_GATEWAY_FULFILLED="maker/gateways/FETCH_GATEWAY_FULFILLED",e.FETCH_GATEWAY_REJECTED="maker/gateways/FETCH_GATEWAY_REJECTED",e.FETCH_GATEWAY_CANCEL_POLL="maker/gateways/FETCH_GATEWAY_CANCEL_POLL",e.CREATE_GATEWAY="maker/gateways/CREATE_GATEWAY",e.OPEN_GATEWAY_DETAILS="maker/gateways/OPEN_GATEWAY_DETAILS",e.OPEN_GATEWAY_HELP="maker/gateways/OPEN_GATEWAY_HELP",e.DELETE_GATEWAY="maker/gateways/DELETE_GATEWAY",e.DELETE_GATEWAY_REQUEST="maker/gateways/DELETE_GATEWAY_REQUEST",e.DELETE_GATEWAY_FULFILLED="maker/gateways/DELETE_GATEWAY_FULFILLED",e.DELETE_GATEWAY_REJECTED="maker/gateways/DELETE_GATEWAY_REJECTED",e.FETCH_GATEWAY_CONNECTIONS_REQUEST="maker/gateways/FETCH_GATEWAY_CONNECTIONS_REQUEST",e.FETCH_GATEWAY_CONNECTIONS_FULFILLED="maker/gateways/FETCH_GATEWAY_CONNECTIONS_FULFILLED",e.FETCH_GATEWAY_CONNECTIONS_REJECTED="maker/gateways/FETCH_GATEWAY_CONNECTIONS_REJECTED",e.SHARE_GATEWAY="maker/gateways/gatewaySpecificActions/SHARE_GATEWAY",e.PATCH_GATEWAY_REQUEST="maker/gateways/PATCH_GATEWAY_REQUEST",e.PATCH_GATEWAY_FULFILLED="maker/gateways/PATCH_GATEWAY_FULFILLED",e.PATCH_GATEWAY_REJECTED="maker/gateways/PATCH_GATEWAY_REJECTED"}(o||(o={}))},6868:function(e,t,n){"use strict";n.r(t);var o=n(6869);n.d(t,"environmentMiddleware",(function(){return o.environmentMiddleware}));var r=n(6870);n.d(t,"aadUserMiddleware",(function(){return r.aadUserMiddleware}));var a=n(5631);n.d(t,"telemetryActionMiddleware",(function(){return a.telemetryActionMiddleware}));var i=n(6871);n.d(t,"LoggingClientRootSaga",(function(){return i.LoggingClientRootSaga}));var s=n(6872);n.d(t,"IntervalLoggingSaga",(function(){return s.IntervalLoggingSaga})),n.d(t,"LoggingSaga",(function(){return s.LoggingSaga}));var l=n(6873);n.d(t,"navigateMiddleware",(function(){return l.navigateMiddleware}));var c=n(6875);n.d(t,"rpcMiddleware",(function(){return c.rpcMiddleware}));var p=n(6876);n.d(t,"planMiddleware",(function(){return p.planMiddleware}));var u=n(6877);n.d(t,"optimizelyMiddleware",(function(){return u.optimizelyMiddleware}));var d=n(6878);n.d(t,"startupMiddleware",(function(){return d.startupMiddleware}));var m=n(6879);n.d(t,"GraphClientRootSaga",(function(){return m.GraphClientRootSaga}));var b=n(6880);n.d(t,"EnvironmentClientRootSaga",(function(){return b.EnvironmentClientRootSaga}));var g=n(6882);n.d(t,"XrmDatabaseClientRootSaga",(function(){return g.XrmDatabaseClientRootSaga}));var y=n(6884);n.d(t,"LocationClientRootSaga",(function(){return y.LocationClientRootSaga}));var S=n(6886);n.d(t,"CurrencyClientRootSaga",(function(){return S.CurrencyClientRootSaga}));var f=n(6888);n.d(t,"LanguageClientRootSaga",(function(){return f.LanguageClientRootSaga}));var h=n(6890);n.d(t,"ConsentClientRootSaga",(function(){return h.ConsentClientRootSaga}));var O=n(6892);n.d(t,"P2PlanTrialClientRootSaga",(function(){return O.P2PlanTrialClientRootSaga}));var C=n(6352);n.d(t,"GraphClientSaga",(function(){return C.default}));var v=n(6894);n.d(t,"OrgEnabledLanguageRootSaga",(function(){return v.OrgEnabledLanguageRootSaga}));var P=n(6896);n.d(t,"GetTokenRootSaga",(function(){return P.GetTokenRootSaga}));var E=n(6898);n.d(t,"toastNotificationMiddleware",(function(){return E.toastNotificationMiddleware}))},6869:function(e,t,n){"use strict";n.r(t),n.d(t,"environmentMiddleware",(function(){return c}));var o=n(5468),r=n(5478),a=n(5876),i=n(2869),s=n(5630),l=n(5474);function c(e){return t=>n=>c=>{var p=c,u=Object(i.getResources)();switch(p.type){case l.SharedActionTypes.OPEN_CREATE_ENVIRONMENT:e.openCreateEnvironmentModal();break;case l.SharedActionTypes.OPEN_CREATE_XRM_DATABASE:e.openCreateXrmDatabaseModal();break;case l.SharedActionTypes.OPEN_UPSELL_ENVIRONMENT_MODAL:t.dispatch(o.sharedActions.openConfirmDialog({hidden:!1,title:c.payload.upsellModal.title,subText:c.payload.upsellModal.message,confirmButtonText:u.MakerDashboard.CreateEnvironment.text,cancelButtonText:u.Controllers.Properties.okButton,onConfirm:()=>{t.dispatch(Object(s.logAction)(o.sharedActions.panelOpen({panelType:r.PanelToShowType.CreateEnvironmentPanel,panelProps:null}),a.CreateEnvironmentPanelEvents.CreatePanelOpened.eventName)),t.dispatch(o.sharedActions.closeConfirmDialog())},hideCancelButton:!1}));break;case l.SharedActionTypes.OPEN_UPSELL_XRM_DATABASE_MODAL:t.dispatch(o.sharedActions.openConfirmDialog({hidden:!1,title:u.Model.Home.Apps.NoDatabase.title,subText:u.Model.Home.Apps.NoDatabase.message,confirmButtonText:u.Controllers.Environments.Create.Database.create,cancelButtonText:u.Controllers.Properties.okButton,onConfirm:()=>{t.dispatch(Object(s.logAction)(o.sharedActions.panelOpen({panelType:r.PanelToShowType.CreateXrmDatabasePanel,panelProps:null}),a.CreateXrmDatabasePanelEvents.CreatePanelOpened.eventName)),t.dispatch(o.sharedActions.closeConfirmDialog())},hideCancelButton:!1}));break;case l.SharedActionTypes.CREATE_ENVIRONMENT_FULFILLED:e.addAndSetEnvironment(p.payload.newEnvironment)}return n(c)}}},6870:function(e,t,n){"use strict";n.r(t),n.d(t,"aadUserMiddleware",(function(){return a}));var o=n(5474),r=n(2874);function a(e){return t=>n=>a=>{switch(a.type){case o.SharedActionTypes.AAD_USER_INIT:var i=e();Object(r.initialize)(i),t.dispatch(Object(o.aadUserUpdated)(i))}return n(a)}}},6871:function(e,t,n){"use strict";n.r(t),n.d(t,"LoggingClientRootSaga",(function(){return a}));var o=n(5749),r=n(6868);function*a(){yield Object(o.all)([Object(o.fork)(r.IntervalLoggingSaga),Object(o.fork)(r.LoggingSaga)])}},6872:function(e,t,n){"use strict";n.r(t),n.d(t,"IntervalLoggingSaga",(function(){return S})),n.d(t,"LoggingSaga",(function(){return f}));var o=n(2812),r=n(5749),a=n(222),i=n(2870),s=n(2880),l=n(2892),c=n(5474),p=n(5626),u=n(2872),d=n(2698),m=n(218),b=[];function g(e,t,n,r){var s=i.HostSettings.getDeploymentSettings(),c=Object(o.assign)({},{principalId:n&&n.principalId||"",tenantId:n&&n.tenantId||"",objectId:n&&n.objectId||"",trackingId:"",region:s&&s.region||"",userHash:n&&n.hash||"",sessionId:r,authSessionId:i.HostSettings.getAuthSessionId(),userAgent:window.navigator.userAgent,userLocale:l.getBrowserLocale(),eventTimeStamp:(new Date).toISOString(),portalUrl:window.location.href},e);return{activityId:Object(a.v4)(),data:c,name:t}}function*y(){var e=b;b=[];var t=e||[];Object(m.trackInfoTrace)(d.PortalScope,{eventName:"/api/logging/LogTrace",eventData:{logData:t}})}function*S(){for(;;)b.length>0&&(console.debug(Object(s.formatResourceString)("LoggingBatchReact: log interval {0} reached",u.settings.logBatchTimeout)),yield y()),yield Object(r.delay)(u.settings.logBatchTimeout)}function*f(){for(;;){var e=yield Object(r.take)(c.SharedActionTypes.LOG_EVENT_REQUEST),t=yield Object(r.select)(p.aadUserSelector),n=yield Object(r.select)(p.clientSessionId),o=g(e.payload.event.data,e.payload.event.name,t,n);b.push(o),b.length>u.settings.logReactBatchThreshold&&(console.debug(Object(s.formatResourceString)("LoggingBatchReact: log entry threshold count reached ({0}/{1})",b.length,u.settings.logBatchThreshold)),yield y())}}},6873:function(e,t,n){"use strict";n.r(t),n.d(t,"navigateMiddleware",(function(){return i}));var o=n(2869),r=n(6874),a=n(5474);function i(e){return e=>e=>t=>{var n=t,i=e;switch(n.type){case a.SharedActionTypes.OPEN_NEW_TAB:var s=n.payload.uri,l=n.payload.windowName,c=n.payload.features;Object(r.openNewTab)(s,c,l);break;case a.SharedActionTypes.OPEN_SAME_TAB:var p=n.payload.uri;Object(r.openInSameTab)(p);break;case a.SharedActionTypes.OPEN_ALERT_DIALOG:var u=n.payload.message,d=Object(o.getResources)();i(Object(a.openConfirmDialog)({hidden:!1,title:u,confirmButtonText:d.Common.ok,onConfirm:()=>{i(Object(a.closeConfirmDialog)())},hideCancelButton:!0}))}return e(t)}}},6875:function(e,t,n){"use strict";n.r(t),n.d(t,"rpcMiddleware",(function(){return r}));var o=n(5474);function r(e){return t=>n=>r=>{var a=r;switch(a.type){case o.SharedActionTypes.RPC_GET_TOKEN_FROM_SHELL_REQUEST:var i=a.payload;e.getAccessTokenFromShell(i).then(e=>{t.dispatch(Object(o.resourceTokenUpdated)({resource:i,token:e})),t.dispatch(Object(o.rpcGetTokenFromShellFulfilled)(e))}).catch(e=>{t.dispatch(Object(o.rpcGetTokenFromShellRejected)(e))})}return n(r)}}},6876:function(e,t,n){"use strict";n.r(t),n.d(t,"planMiddleware",(function(){return b}));var o=n(6691),r=n(5474),a=n(5468),i=n(2869),s=n(5630),l=n(5478),c=n(5876),p=n(5626),u=n(5661),d=n(2872),m=n(5768);function b(e){return t=>n=>b=>{var g,y,S=b,f=Object(i.getResources)();switch(S.type){case r.SharedActionTypes.CURRENT_PLANS_INIT:var h=t.getState(),O=null!==(g=Object(p.currentPlansSelector)(h))&&void 0!==g&&g.length?Object(p.currentPlansSelector)(h):null==e?void 0:e.getCurrentPlans();t.dispatch(Object(r.updateCurrentPlans)(O));var C=Object(u.getCurrentPlansMetaData)(O);t.dispatch(Object(r.updateCurrentPlansMetaData)(C));break;case r.SharedActionTypes.SIGN_UP_FOR_P2_TRIAL_REQUEST:null==e||null===(y=e.signUpForP2Trial())||void 0===y||y.then(e=>{t.dispatch(Object(r.signUpForP2TrialFulfilled)({newP2TrialPlan:e})),t.dispatch(Object(r.currentPlansInit)())}).catch(e=>{t.dispatch(Object(r.signUpForP2TrialRejected)({error:Object(m.getResponseErrorMessage)(e)}))});break;case r.SharedActionTypes.REQUEST_P2_PLAN_RENEWAL:var v=null==e?void 0:e.getCurrentPlansMetaData().doesUserHaveActivePremiumPlan,P=null==e?void 0:e.getCurrentPlansMetaData().doesUserHaveExpiredPremiumPlan;if(!v&&P){var E=S.payload,T="";switch(E){case o.PremiumResourceType.Entity:T=f.Controllers.RenewTrialModal.IntroPage.Entities.text;break;case o.PremiumResourceType.PremiumConnection:T=f.Controllers.RenewTrialModal.IntroPage.Connections.text;break;case o.PremiumResourceType.General:default:T=f.Controllers.RenewTrialModal.IntroPage.General.text}(null==e?void 0:e.requestP2PlanRenewal()).then(e=>{e&&e.properties&&e.properties.settings&&e.properties.settings.dismissed&&t.dispatch(a.sharedActions.openConfirmDialog({hidden:!1,title:f.Controllers.RenewTrialModal.trialExpiredText,subText:T,maxWidth:500,confirmButtonText:f.Controllers.RenewTrialModal.ExtendYourTrialButton.text,cancelButtonText:f.Controllers.Properties.okButton,linkUri:d.settings.trialBuyAPlanUrl,linkText:f.Controllers.RenewTrialModal.SeePowerAppsPlansLink.text,isLinkButtonVisible:!0,showCloseButton:!0,onConfirm:()=>{t.dispatch(Object(s.logAction)(a.sharedActions.panelOpen({panelType:l.PanelToShowType.TrialExtensionPanel,panelProps:null}),c.CreateEnvironmentPanelEvents.CreatePanelOpened.eventName)),t.dispatch(a.sharedActions.closeConfirmDialog())},hideCancelButton:!1}))})}break;case r.SharedActionTypes.RESET_TRIAL_RENEWAL_VALUES:e.resetRenewTrialValues();break;case r.SharedActionTypes.MARK_RENEW_TRIAL_DISMISSED:e.markRenewTrialAsDismissed()}return n(b)}}},6877:function(e,t,n){"use strict";n.r(t),n.d(t,"optimizelyMiddleware",(function(){return r}));var o=n(5474);function r(e){return e?t=>n=>r=>{var a=r;switch(a.type){case o.SharedActionTypes.FETCH_OPTIMIZELY_FLAGS:var i=e.flags,s=e.activeExperiments;t.dispatch(Object(o.fetchOptimizelyFlagsFulfilled)({optimizelyFlags:i,activeOptimizelyExperiments:s}));break;case o.SharedActionTypes.UPDATE_OPTIMIZELY_FLAG:e.enableExperiment(a.payload);var l=e.flags,c=e.activeExperiments;t.dispatch(Object(o.updateOptimizelyExperimentFulfilled)({updatedOptimizelyFlags:l,updatedActiveOptimizelyExperiments:c}))}return n(r)}:e=>e=>t=>e(t)}},6878:function(e,t,n){"use strict";n.r(t),n.d(t,"startupMiddleware",(function(){return r}));var o=n(5474);function r(e,t){return n=>r=>a=>{switch(a.type){case o.SharedActionTypes.FETCH_ALLOWLIST_FEATURES:var i=e.getAllowlistFeatures();n.dispatch(Object(o.fetchAllowlistFeaturesFullfilled)({allowlistFeatures:i}));break;case o.SharedActionTypes.FETCH_BAP_ALLOWLIST_FEATURES:var s=e.getBapAllowlistFeatures();n.dispatch(Object(o.fetchBapAllowlistFeaturesFullfilled)({bapAllowlistFeatures:s}));break;case o.SharedActionTypes.SESSION_ID_INIT:n.dispatch(Object(o.sessionIdUpdated)(t))}return r(a)}}},6879:function(e,t,n){"use strict";n.r(t),n.d(t,"GraphClientRootSaga",(function(){return a}));var o=n(5749),r=n(6868);function*a(){yield Object(o.all)([Object(o.fork)(r.GraphClientSaga)])}},6880:function(e,t,n){"use strict";n.r(t),n.d(t,"EnvironmentClientRootSaga",(function(){return a}));var o=n(5749),r=n(6881);function*a(){yield Object(o.all)([Object(o.fork)(r.default)])}},6881:function(e,t,n){"use strict";n.r(t),n.d(t,"createEnvironment",(function(){return d}));var o=n(5749),r=n(2810),a=n(5760),i=n(5597),s=n(5474),l=n(5593),c=n(5768);function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function*d(e){var t={region:e.payload.region,environmentSku:e.payload.environmentType},n=Object(l.trackCreateScenario)(r.CreateScenarioNames.Environment,t),d="".concat(i.environmentBaseUri,"?id=").concat(i.environmentAdminBaseUri),m={location:e.payload.region,properties:{displayName:e.payload.environmentName,environmentSku:e.payload.environmentType}},b={url:d,method:"POST",data:JSON.stringify(m),headers:{"Content-Type":"application/json"}};try{var g=yield Object(o.call)(a.default,e,b);if(!g)throw new Error("Create environment request failed.");if(g.error)throw g.error;if(g.response&&g.response.data&&g.response.data.error)throw g.response.data.error;if(g instanceof Error)throw g;var y=g.data;yield Object(o.put)(Object(s.updateEnvironmentPermissionsRequest)({environment:y})),Object(l.trackScenarioComplete)(r.CreateScenarioNames.Environment,t,n)}catch(f){var S=Object(c.getResponseErrorMessage)(f);yield Object(o.put)(Object(s.createEnvironmentRejected)({error:S})),Object(l.trackScenarioFailure)(r.CreateScenarioNames.Environment,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({Error:S},t),n)}}function*m(e){var t=e.payload.environment,n={url:"".concat(i.environmentBaseUri,"/").concat(t.name,"?$expand=properties.permissions,namespace")};try{var r=yield Object(o.call)(a.default,e,n);if(!r)throw new Error("Update environment request failed.");if(r.error)throw r.error;yield Object(o.put)(Object(s.createEnvironmentFulfilled)({newEnvironment:r.data}))}catch(l){yield Object(o.put)(Object(s.updateEnvironmentPermissionsRejected)({error:Object(c.getResponseErrorMessage)(l)}))}}t.default=function*(){yield Object(o.takeLatest)(s.SharedActionTypes.CREATE_ENVIRONMENT_REQUEST,d),yield Object(o.takeLatest)(s.SharedActionTypes.UPDATE_ENVIRONMENT_PERMISSIONS_REQUEST,m)}},6882:function(e,t,n){"use strict";n.r(t),n.d(t,"XrmDatabaseClientRootSaga",(function(){return a}));var o=n(5749),r=n(6883);function*a(){yield Object(o.all)([Object(o.fork)(r.default)])}},6883:function(e,t,n){"use strict";n.r(t),n.d(t,"createXrmDatabase",(function(){return b}));var o=n(5749),r=n(2810),a=n(5606),i=n(5760),s=n(5597),l=n(2880),c=n(5474),p=n(5768),u=n(5593);function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function*b(e){var t=a.SagaContextProps.getCurrentEnvironment(),n=Object(l.formatResourceString)(s.spacificXrmNamespaceUrl,t.name),b=e.payload.currency,g=parseInt(e.payload.language.toString(),10),y=e.payload.templates,S={baseLanguage:g,currency:{code:b}};y&&y.length>0&&(S.templates=y);var f=Object(u.trackCreateScenario)(r.CreateScenarioNames.Database,S),h={url:n,method:"POST",data:JSON.stringify(S),headers:{"Content-Type":"application/json"}},O=yield Object(o.call)(i.default,e,h);if(!O)return null;if(Object(p.hasResponseError)(O)){var C=Object(p.getResponseErrorMessage)(O);yield Object(o.put)(Object(c.createXrmDatabaseRejected)({error:C})),Object(u.trackScenarioFailure)(r.CreateScenarioNames.Environment,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){m(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({Error:C},S),f)}else yield Object(o.put)(Object(c.createXrmDatabaseFulfilled)()),a.SagaContextProps.refreshCurrentEnvironment(),Object(u.trackScenarioComplete)(r.CreateScenarioNames.Environment,S,f)}t.default=function*(){yield Object(o.takeLatest)(c.SharedActionTypes.CREATE_XRM_DATABASE_REQUEST,b)}},6884:function(e,t,n){"use strict";n.r(t),n.d(t,"LocationClientRootSaga",(function(){return a}));var o=n(5749),r=n(6885);function*a(){yield Object(o.all)([Object(o.fork)(r.default)])}},6885:function(e,t,n){"use strict";n.r(t);var o=n(5749),r=n(5474),a=n(5760),i=n(5597),s=n(5768);function*l(e){var t={url:i.locationBaseUri},n=yield Object(o.call)(a.default,e,t);if(!n)return null;Object(s.hasResponseError)(n)?yield Object(o.put)(Object(r.fetchLocationsRejected)({error:Object(s.getResponseErrorMessage)(n)})):yield Object(o.put)(Object(r.fetchLocationsFulfilled)({locations:n.data.value}))}t.default=function*(){yield Object(o.takeLatest)(r.SharedActionTypes.FETCH_LOCATIONS_REQUEST,l)}},6886:function(e,t,n){"use strict";n.r(t),n.d(t,"CurrencyClientRootSaga",(function(){return a}));var o=n(5749),r=n(6887);function*a(){yield Object(o.all)([Object(o.fork)(r.default)])}},6887:function(e,t,n){"use strict";n.r(t);var o=n(5749),r=n(5606),a=n(5760),i=n(5597),s=n(2880),l=n(5474),c=n(5768);function*p(e){var t=r.SagaContextProps.getCurrentEnvironment().location,n={url:Object(s.formatResourceString)(i.currencyUri,t)},p=yield Object(o.call)(a.default,e,n);if(!p)return null;Object(c.hasResponseError)(p)?yield Object(o.put)(Object(l.fetchCurrenciesRejected)({error:Object(c.getResponseErrorMessage)(p)})):yield Object(o.put)(Object(l.fetchCurrenciesFulfilled)({currencies:p.data.value}))}t.default=function*(){yield Object(o.takeLatest)(l.SharedActionTypes.FETCH_CURRENCIES_REQUEST,p)}},6888:function(e,t,n){"use strict";n.r(t),n.d(t,"LanguageClientRootSaga",(function(){return a}));var o=n(5749),r=n(6889);function*a(){yield Object(o.all)([Object(o.fork)(r.default)])}},6889:function(e,t,n){"use strict";n.r(t);var o=n(5749),r=n(5606),a=n(5760),i=n(5597),s=n(2880),l=n(5474),c=n(5768);function*p(e){var t=r.SagaContextProps.getCurrentEnvironment().location,n={url:Object(s.formatResourceString)(i.languageUri,t)},p=yield Object(o.call)(a.default,e,n);if(!p)return null;Object(c.hasResponseError)(p)?yield Object(o.put)(Object(l.fetchLanguagesRejected)({error:Object(c.getResponseErrorMessage)(p)})):yield Object(o.put)(Object(l.fetchLanguagesFulfilled)({languages:p.data.value}))}t.default=function*(){yield Object(o.takeLatest)(l.SharedActionTypes.FETCH_LANGUAGES_REQUEST,p)}},6890:function(e,t,n){"use strict";n.r(t),n.d(t,"ConsentClientRootSaga",(function(){return a}));var o=n(5749),r=n(6891);function*a(){yield Object(o.all)([Object(o.fork)(r.default)])}},6891:function(e,t,n){"use strict";n.r(t);var o=n(5749),r=n(5474),a=n(5760),i=n(5597),s=n(5630),l=n(6690),c=n(5768);function*p(e){var t={url:i.countriesUri},n=Object(s.logScenarioActionStart)(e,l.TrialExtensionPanelEvents.TrialExtensionCountriesPerformance.eventName,[]),p=yield Object(o.call)(a.default,e,t);if(!p)return yield Object(o.put)(Object(s.logActionFail)(Object(r.telemetryLogAction)(),l.TrialExtensionPanelEvents.TrialExtensionCountriesPerformance.eventName,n)),null;Object(c.hasResponseError)(p)?(yield Object(o.put)(Object(r.fetchCountriesRejected)({error:Object(c.getResponseErrorMessage)(p)})),yield Object(o.put)(Object(s.logActionFail)(Object(r.telemetryLogAction)(),l.TrialExtensionPanelEvents.TrialExtensionCountriesPerformance.eventName,n))):(yield Object(o.put)(Object(r.fetchCountriesFulfilled)({countries:p.data.value})),yield Object(o.put)(Object(s.logActionComplete)(Object(r.telemetryLogAction)(),l.TrialExtensionPanelEvents.TrialExtensionCountriesPerformance.eventName,n)))}t.default=function*(){yield Object(o.takeLatest)(r.SharedActionTypes.FETCH_COUNTRIES_REQUEST,p)}},6892:function(e,t,n){"use strict";n.r(t),n.d(t,"P2PlanTrialClientRootSaga",(function(){return a}));var o=n(5749),r=n(6893);function*a(){yield Object(o.all)([Object(o.fork)(r.default)])}},6893:function(e,t,n){"use strict";n.r(t);var o=n(5749),r=n(5760),a=n(5597),i=n(5474),s=n(2880),l=n(5630),c=n(6690),p=n(5768),u=n(2872);function*d(e){var t=Object(s.formatResourceString)(a.renewTrialUri,u.settings.powerAppsP2TrialLicenseId),n=e.payload,d={url:t,method:"POST",data:JSON.stringify(n),headers:{"Content-Type":"application/json"}},m=yield Object(o.call)(r.default,e,d);if(!m)return null;Object(p.hasResponseError)(m)?yield Object(o.put)(Object(l.logAction)(Object(i.extendTrialRejected)({error:Object(p.getResponseErrorMessage)(m)}),c.TrialExtensionPanelEvents.TrialExtensionFail.eventName)):(yield Object(o.put)(Object(l.logAction)(Object(i.extendTrialFulfilled)({newP2TrialPlan:m.data}),c.TrialExtensionPanelEvents.TrialExtensionSucceeded.eventName)),yield Object(o.put)(Object(i.resetTrialRenewalValues)()))}t.default=function*(){yield Object(o.takeLatest)(i.SharedActionTypes.EXTEND_TRIAL_REQUEST,d)}},6894:function(e,t,n){"use strict";n.r(t),n.d(t,"OrgEnabledLanguageRootSaga",(function(){return a}));var o=n(5749),r=n(6895);function*a(){yield Object(o.all)([Object(o.fork)(r.default)])}},6895:function(e,t,n){"use strict";n.r(t);var o=n(5749),r=n(5468),a=n(5606),i=n(5604),s=n(2868),l=n(5667),c=n(5474);function*p(){var e,t=a.SagaContextProps.getCurrentEnvironment(),n=i.getCrmInstanceUrl(t),p=yield Object(o.select)(r.sharedSelectors.orgEnabledLanguagesSelector,n);if(p&&p.length>0)return null;try{var u=s.MetadataClientInstance.getInstance();e=u?u.fetchOrganizationEnabledLanguages():[];var d=yield e;yield Object(o.put)(Object(c.fetchOrgEnabledLanguagesFulfilled)({environment:n,orgEnabledLanguages:d}))}catch(m){yield Object(o.put)(Object(l.showPowerPortalCreateModalError)({error:m.message,environmentId:t.id}))}}t.default=function*(){yield Object(o.takeLatest)(c.SharedActionTypes.FETCH_ORG_ENABLED_LANGUAGES,p)}},6896:function(e,t,n){"use strict";n.r(t),n.d(t,"GetTokenRootSaga",(function(){return a}));var o=n(5749),r=n(6897);function*a(){yield Object(o.all)([Object(o.fork)(r.default)])}},6897:function(e,t,n){"use strict";n.r(t);var o=n(5749),r=n(5468),a=n(5760);function*i(e){var t=null,n=e.payload.resource;try{t=yield Object(o.call)(a.renewToken,n),e.payload.resolve&&e.payload.resolve(t.data)}catch(r){e.payload.reject&&e.payload.reject(r)}return t}t.default=function*(){yield Object(o.takeLatest)(r.sharedActions.SharedActionTypes.GET_TOKEN_REQUEST,i)}},6898:function(e,t,n){"use strict";n.r(t),n.d(t,"toastNotificationMiddleware",(function(){return a}));var o=n(5667),r=n(6899);function a(e){return t=>t=>n=>{var a=n;switch(a.type){case o.PowerPortalActionTypes.SHOW_CREATE_POWER_PORTAL_TOAST_NOTIFICATION:var i=new r.CreatePowerPortalNotification(a.payload.portalName);e.addToastNotificationToHead([i]),e.triggerNextNotification(!0)}return t(n)}}},6899:function(e,t,n){"use strict";n.r(t),n.d(t,"CreatePowerPortalNotification",(function(){return s}));var o=n(3837),r=n(245),a=n(2869),i=n(2880);class s extends o.GenericTextNotification{constructor(e){super(),this.telemetryActionNamespace="PowerPortalsNotification",this.resources=void 0,this.portalName=void 0,this.resources=Object(a.getResources)(),this.portalName=e}get title(){return this.resources.PowerPortal.Notification.CreatePowerPortalNotification.Title}get actionButtonText(){return""}get actionButtonHandler(){return()=>{this.markPowerPortalsToastAsDismissed()}}getTelemetryActionNamespace(){return this.telemetryActionNamespace}get closingHandler(){return()=>{this.telemetry.logDismissed(),this.markPowerPortalsToastAsDismissed()}}getContent(){return r.createElement("div",{dangerouslySetInnerHTML:{__html:Object(i.formatResourceString)(this.resources.PowerPortal.Notification.CreatePowerPortalNotification.Text,this.portalName)}})}getNotificationForceFlag(){return!1}isApplicable(){return Promise.resolve(!0)}markPowerPortalsToastAsDismissed(){this.notificationCallParameters.userSettings.setUserSettings("powerPortals","dismissed","true")}}},6900:function(e,t,n){"use strict";n.r(t),n.d(t,"useStageSolutionHook",(function(){return c}));var o=n(245),r=n(6901),a=n(6902),i=n(3193),s=n(218);function l(e,t,n,o,r,a,i){try{var s=e[a](i),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(o,r)}var c=(e,t,n,c,p)=>{var u=i.TelemetryScenarioNames.stageSolution,[d,m]=Object(o.useState)(!1),[b,g]=Object(o.useState)(void 0),[y,S]=Object(o.useState)(void 0),[f,h]=Object(o.useState)(void 0);function O(){c(),m(!1)}var C=()=>{g(void 0),S(void 0),h(void 0),m(!0),t()},v=(e,t)=>{g(t),S(Object(a.getStageSolutionResultsError)(t)),h(Object(a.getStageSolutionResultsWarning)(t)),e&&e.complete({errors:y,warnings:f}),O()},P=(e,t)=>{g(void 0),S(t),h(void 0),e&&e.failure({error:t}),O()};return{_onStageSolution:()=>{C();var t=Object(s.trackLoadScenario)(p,u);Object(r.getBase64)(e).then(function(){var e,o=(e=function*(e){n(e).then(e=>{v(t,e)}).catch(e=>{P(t,e)})},function(){var t=this,n=arguments;return new Promise((function(o,r){var a=e.apply(t,n);function i(e){l(a,o,r,i,s,"next",e)}function s(e){l(a,o,r,i,s,"throw",e)}i(void 0)}))});return function(e){return o.apply(this,arguments)}}()).catch(e=>{P(t,e)})},isStagingOngoing:d,extendedStageSolutionResults:b,stageSolutionResultsError:y,stageSolutionResultsWarning:f}}},6901:function(e,t,n){"use strict";function o(e){return new Promise((t,n)=>{var o=new FileReader;o.readAsDataURL(e),o.onload=()=>{if(!o.result)return n("Empty file");var e=o.result.toString().replace(/^data:(.*,)?/,"");return t(e)},o.onerror=e=>n(e)})}function r(e){return!!e&&"00000000-0000-0000-0000-000000000000"!==e}n.r(t),n.d(t,"getBase64",(function(){return o})),n.d(t,"isValidStageSolutionUploadId",(function(){return r}))},6902:function(e,t,n){"use strict";n.r(t),n.d(t,"getStageSolutionResultsError",(function(){return r})),n.d(t,"getStageSolutionResultsWarning",(function(){return a})),n.d(t,"hasStageSolutionUploadId",(function(){return i})),n.d(t,"didStageSolutionPass",(function(){return s}));var o=n(6901);function r(e){if(e.SolutionValidationResults)return e.SolutionValidationResults.find(e=>"Error"===e.SolutionValidationResultType)}function a(e){if(e.SolutionValidationResults)return e.SolutionValidationResults.find(e=>"Warning"===e.SolutionValidationResultType)}function i(e){return!!e&&!!e.StageSolutionUploadId&&Object(o.isValidStageSolutionUploadId)(e.StageSolutionUploadId)}function s(e){return e&&"Passed"===e.StageSolutionStatus}},6903:function(e,t,n){"use strict";n.r(t),n.d(t,"getFileSelectionPanel",(function(){return u}));var o=n(245),r=n(6376),a=n(6904),i=n(217),s=n(6375);function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){p(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e,t,n,l,p,u,d){var m={currentStep:s.FriendlySolutionImportPanelSteps.get(r.SolutionImportPanelSteps.fileSelection)};return c(c({},e),{},{children:o.createElement(a.FileSelectionPanelContents,{labels:t,selectedFile:n,fileInputRef:p,_handleOnBrowseClick:()=>{Object(i.trackUserActionClickButton)(s.SolutionEventScope,s.EventNames.BrowseFile),u()},_onFileSelected:e=>{Object(i.trackUserActionClickButton)(s.SolutionEventScope,s.EventNames.FileSelected),function(e){var t=e.target.files?e.target.files[0]:void 0;l(t)}(e)}}),footerButtons:[{primary:!0,navigateableOnClick:e=>{var t=r.SolutionImportPanelSteps.validationResults;return Object(i.trackUserActionClickButton)(s.SolutionEventScope,s.EventNames.GoForward,c(c({},m),{},{nextStep:s.FriendlySolutionImportPanelSteps.get(t)})),d(),t},disabled:!n,ariaLabel:t.next,text:t.next},{ariaLabel:t.cancel,text:t.cancel,navigateableOnClick:(e,t)=>(t(),null)}]})}},6904:function(e,t,n){"use strict";n.r(t),n.d(t,"FileSelectionPanelContents",(function(){return i}));var o=n(245),r=n(6905),a=n(684),i=e=>{var{labels:t,selectedFile:n,fileInputRef:i,_handleOnBrowseClick:s,_onFileSelected:l}=e;return o.createElement("div",{className:r.solutionImportPanelClasses.contentContainer},o.createElement("span",{className:r.solutionImportPanelClasses.subHeaderText},t.FileSelectionPanel.title),o.createElement("span",{className:r.solutionImportPanelClasses.subHeaderContentsText},t.FileSelectionPanel.content),o.createElement("div",{className:r.solutionImportPanelClasses.fileSelectionContainer},o.createElement("input",{type:"file",ref:i,style:{display:"none"},accept:".zip, .cab",onChange:l}),o.createElement("div",null,o.createElement(a.DefaultButton,{onClick:s},t.FileSelectionPanel.browse),o.createElement("span",{className:r.solutionImportPanelClasses.fileSelectionText},n?n.name:t.FileSelectionPanel.noFileChosen))))}},6905:function(e,t,n){"use strict";n.r(t),n.d(t,"solutionImportPanelClasses",(function(){return i})),n.d(t,"solutionImportPanelStyles",(function(){return s})),n.d(t,"solutionComponentListIconStyle",(function(){return l})),n.d(t,"solutionComponentListIconBackgroundStyles",(function(){return c}));var o=n(719),r=n(2882),a=n(5492),i=Object(o.mergeStyleSets)({regularText:{fontSize:12,fontFamily:a.fonts.segoeUi,lineHeight:16},boldText:{fontWeight:600},displayType:{display:"block"},largerText:{fontFamily:a.fonts.segoeUi,fontSize:14,lineHeight:20},contentContainer:{paddingTop:"0px !important",marginTop:"16px !important",fontFamily:a.fonts.segoeUi,display:"grid"},subHeaderText:{fontSize:16,fontFamily:a.fonts.segoeUi,fontWeight:600,lineHeight:22},subHeaderContentsText:{marginTop:4,fontSize:14,fontFamily:a.fonts.segoeUi,lineHeight:19,letterSpacing:"-0.0068px"},detailContainer:{display:"grid",marginTop:16},detailTitle:{marginBottom:4},fileSelectionContainer:{marginTop:24},fileSelectionText:{marginLeft:12,fontFamily:a.fonts.segoeUi,fontSize:14,lineHeight:32,color:r.fabricColors.neutralChicago},choiceGroupLabelContainer:{marginLeft:28},checkBoxLabelContainer:{marginLeft:8},advancedSettingsItemTitle:{color:r.fabricColors.neutralTuatara,fontFamily:a.fonts.segoeUi,fontWeight:600,fontSize:14,lineHeight:20,marginBottom:4},advancedSettingsItemDescription:{marginTop:14},exisitngComponentsNotification:{fontFamily:a.fonts.segoeUi,fontSize:14,color:"#323130"},componentsListItemName:{fontFamily:a.fonts.segoeUi,fontSize:14,color:"#323130"},componentsListItemType:{fontFamily:a.fonts.segoeUi,fontSize:12,color:"#605E5C"}}),s={advancedSettingsAccordionStyles:{root:{height:20,marginTop:20,marginLeft:"0",paddingLeft:"0",backgroundColor:r.fabricColors.white},flexContainer:{alignItems:"flex-start",justifyContent:"flex-start"},textContainer:{flexGrow:0},label:{fontSize:14,marginLeft:"0",verticalAlign:"middle",fontFamily:a.fonts.segoeUi,lineHeight:20,color:r.fabricColors.plum,fontWeight:"normal"},menuIcon:{fontSize:12,color:r.fabricColors.plum,lineHeight:12,marginTop:3,marginBottom:3},container:{borderTop:"1px solid ".concat(r.fabricColors.veryLightGrey),marginTop:16},header:{marginTop:16},content:{marginTop:16}},choiceGroupStyles:{label:{fontFamily:a.fonts.segoeUi,fontSize:14,lineHeight:20,fontWeight:600},flexContainer:{marginLeft:9}},choiceGroupOptionStyles:{root:{marginTop:16}},checkboxStyles:{root:{marginTop:16},label:{alignItems:"unset"}}},l={root:{fontSize:16,marginTop:12}},c=Object(o.mergeStyleSets)({canvasApp:{width:40,height:40,backgroundColor:"#0078D4",borderRadius:4},table:{width:40,height:40,backgroundColor:"#742774",borderRadius:4},chatbots:{width:40,height:40,backgroundColor:"#0B556A",borderRadius:4},flow:{width:40,height:40,backgroundColor:"#0a67fc",borderRadius:4},default:{width:40,height:40,borderRadius:4}})},6906:function(e,t,n){"use strict";n.r(t),n.d(t,"getValidationResultsPanel",(function(){return v})),n.d(t,"setMessageBar",(function(){return T}));var o=n(245),r=n(1201),a=n(1697),i=n(6376),s=n(6907),l=n(6902),c=n(217),p=n(6375),u=n(2885),d=n(684),m=n(2882),b=n(6682),g=n(719),y=n(5468),S=n(5478),f=n(1089);function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){C(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function C(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function v(e,t,n,a,u,d,m,b,g,y,S,f,h,C,v,E,j,A,R,I,w,D,N){var L;d&&(L={spinnerProps:{size:r.SpinnerSize.large,label:n.FileSelectionPanel.processing,ariaLabel:n.FileSelectionPanel.processing,ariaLive:"polite",role:"alert"}});var M=T(b,y,n,g,u,I,e,w,N);function x(){return v&&v.length>0?i.SolutionImportPanelSteps.connectionReferences:E&&E.length>0?i.SolutionImportPanelSteps.environmentVariables:i.SolutionImportPanelSteps.import}var k=O({currentStep:p.FriendlySolutionImportPanelSteps.get(i.SolutionImportPanelSteps.validationResults)},Object(p.getSolutionImportValidationResultsTelemetryData)(m,b,y,S,h));return O(O({},t),{},{messageBar:M,children:o.createElement(s.ValidationResultsPanelContents,{labels:n,selectedFileName:a,stageSolutionResults:m,selectedSolutionAction:S,_onChooseSolutionAction:function(e,t){f(t&&t.key)},enableSdkMessagesAndFlows:h,_toggleEnableSdkMessagesAndFlows:function(e,t){C(t)},componentsSelection:A,componentsList:R,uxContext:D}),loadingOverlay:L,footerButtons:[{primary:!0,styles:P.importButtonStyles,navigateableOnClick:(e,t)=>{var n=x();return Object(c.trackUserActionClickButton)(p.SolutionEventScope,p.EventNames.GoForward,O(O({},k),{},{nextStep:p.FriendlySolutionImportPanelSteps.get(n)})),n===i.SolutionImportPanelSteps.import&&j(),n},disabled:!Object(l.didStageSolutionPass)(m),ariaLabel:n.next,text:x()==i.SolutionImportPanelSteps.import?n.import:n.next},{ariaLabel:n.cancel,text:n.cancel,navigateableOnClick:(e,t)=>(t(),null)}]})}var P={messageBarStyles:{innerText:{width:"100%"}},downloadLogButtonStyles:{root:{fontSize:12,fontWeight:600,height:20,backgroundColor:m.fabricColors.white,borderColor:m.fabricColors.gray},label:{color:m.fabricColors.gray,whiteSpace:"nowrap"}},importButtonStyles:{root:{backgroundColor:"#742774"}}},E=Object(g.mergeStyleSets)({messageBar:[{selectors:{".ms-MessageBar-innerText":{width:"100%"}}}],solutionsListExportMessageInnerContainer:{display:"flex",alignItems:"flex-start",selectors:{".solutionDependenciesMessageTextContainer":{width:"100%"}}}});function T(e,t,n,r,i,s,l,m,h){var O,C,v;return e?(v=m&&h?Object(f.formatResourceStringToElement)(l("Model.Solutions.SolutionImportDependencies.MissingDependenciesErrorMessage"),(e,t)=>{if(0===t)return o.createElement("b",null,i)}):e,C=a.MessageBarType.error):t&&(v=t,C=a.MessageBarType.warning),v&&(O={messageBarProps:{messageBarType:C,dismissButtonAriaLabel:n.close,styles:P.messageBarStyles},onRenderBody:()=>o.createElement("div",{className:E.solutionsListExportMessageInnerContainer},o.createElement("div",{className:"solutionDependenciesMessageTextContainer"},v),r&&o.createElement(d.ActionButton,{styles:P.downloadLogButtonStyles,className:Object(g.mergeStyles)({selectors:{".ms-Button-label":{padding:0,margin:0}}}),onClick:m&&h?()=>{s(y.sharedActions.panelOpen({panelType:S.PanelToShowType.SolutionImportDependenciesPanel,panelProps:{errorMessage:r,solutionDisplayName:i}}))}:()=>{Object(c.trackUserActionClickButton)(p.SolutionEventScope,p.EventNames.DownloadErrorLog),Object(u.triggerFileDownloadFromText)(r,"log.txt");var e=b.CustomHostEvents.getOnSuccessfulDownload();e&&e("log.txt")}},m&&h?l("Model.Solutions.SolutionImportDependencies.ShowDependencies"):n.ValidationResultsPanel.downloadLog))}),O}},6907:function(e,t,n){"use strict";n.r(t),n.d(t,"ValidationResultsPanelContents",(function(){return s}));var o=n(6908),r=n(6912),a=n(2871),i=n(3713),s=e=>Object(i.isCDSLiteUXContext)(e.uxContext)&&a.featureGates.enableTeamsSolutionImportV2?Object(r._getValidationResultsPanelContentsV2)(e):Object(o._getValidationResultsPanelContentsV1)(e)},6908:function(e,t,n){"use strict";n.r(t),n.d(t,"_getValidationResultsPanelContentsV1",(function(){return f})),n.d(t,"_getSolutionActionChoiceOptions",(function(){return h}));var o=n(245),r=n(6905),a=n(6376),i=n(6909),s=n(6911),l=n(5080),c=n(1368),p=n(1362),u=n(1372),d=n(1795),m=n(1090),b=n(5481),g=n(6375),y=n(217),S=n(1104),f=e=>{var{labels:t,stageSolutionResults:n,selectedSolutionAction:a,_onChooseSolutionAction:f,_toggleEnableSdkMessagesAndFlows:O,enableSdkMessagesAndFlows:C}=e,v=Object(s.shouldShowAdvancedSettings)(n);return o.createElement(o.Fragment,null,o.createElement("div",{className:r.solutionImportPanelClasses.contentContainer},o.createElement(i.SolutionDetailsContainer,{stageSolutionResults:n,labels:t})),!Object(S.isCdsLiteContext)()&&o.createElement(l.Accordion,{onOpen:()=>{Object(y.trackUserActionClickButton)(g.SolutionEventScope,g.EventNames.AdvancedSettings,{action:g.AdvancedSettingsActionNames.Show})},onClose:()=>{Object(y.trackUserActionClickButton)(g.SolutionEventScope,g.EventNames.AdvancedSettings,{action:g.AdvancedSettingsActionNames.Hide})},text:t.ValidationResultsPanel.AdvancedSettings.advancedSettings,styles:r.solutionImportPanelStyles.advancedSettingsAccordionStyles,onRenderContent:()=>o.createElement(o.Fragment,null,v&&o.createElement(o.Fragment,null,o.createElement(u.Label,{id:"SolutionAction-choiceGroup-title-label-id"},o.createElement(d.Stack,{horizontal:!0,verticalAlign:"center",gap:"5px"},o.createElement("span",null,t.ValidationResultsPanel.AdvancedSettings.SolutionActions.title),o.createElement(m.Link,{target:"_blank",href:b.default.solutionActionLearnMoreLink},t.ValidationResultsPanel.AdvancedSettings.SolutionActions.learnMore))),o.createElement(c.ChoiceGroup,{selectedKey:a,ariaLabelledBy:"SolutionAction-choiceGroup-title-label-id",onChange:f,styles:r.solutionImportPanelStyles.choiceGroupStyles,options:h(n,t)})),o.createElement(p.Checkbox,{label:t.ValidationResultsPanel.AdvancedSettings.EnableSdkMessagesAndFlows.title,onChange:O,checked:!!C,styles:r.solutionImportPanelStyles.checkboxStyles,onRenderLabel:()=>o.createElement("div",{className:r.solutionImportPanelClasses.checkBoxLabelContainer},o.createElement("div",{className:r.solutionImportPanelClasses.advancedSettingsItemTitle},t.ValidationResultsPanel.AdvancedSettings.EnableSdkMessagesAndFlows.title))}))}))};function h(e,t){var n=[],o=e.SolutionDetails;Object(s.isUnmanagedUpdate)(o)||n.push(O(a.SolutionActionsKeys.upgrade,t.ValidationResultsPanel.AdvancedSettings.SolutionActions.Upgrade),O(a.SolutionActionsKeys.stageForUpgrade,t.ValidationResultsPanel.AdvancedSettings.SolutionActions.StageForUpgrade));var r=O(a.SolutionActionsKeys.update,Object(s.isUnmanagedUpdate)(o)?t.ValidationResultsPanel.AdvancedSettings.SolutionActions.Update:t.ValidationResultsPanel.AdvancedSettings.SolutionActions.UpdateNotRecommended);return o.PreviousPatchSolutionsNames.length>0&&(r.disabled=!0),n.push(r),n}function O(e,t){return{key:e,text:t.title,styles:r.solutionImportPanelStyles.choiceGroupOptionStyles,onRenderLabel:()=>o.createElement("div",{className:r.solutionImportPanelClasses.choiceGroupLabelContainer},o.createElement("div",{className:r.solutionImportPanelClasses.advancedSettingsItemTitle},t.title),o.createElement("div",{className:r.solutionImportPanelClasses.advancedSettingsItemDescription},t.description))}}},6909:function(e,t,n){"use strict";n.r(t),n.d(t,"SolutionDetailsContainer",(function(){return l}));var o=n(245),r=n(6905),a=n(6910),i=n(6911),s=n(1104),l=e=>{if(!e.stageSolutionResults||!e.stageSolutionResults.SolutionDetails)return o.createElement(o.Fragment,null);var{labels:t,stageSolutionResults:n}=e,l=n.SolutionDetails,c=Object(s.getHostContext)()===s.HostContext.Teams;return o.createElement(o.Fragment,null,o.createElement("span",{className:r.solutionImportPanelClasses.subHeaderText},t.ValidationResultsPanel.title),o.createElement(a.SolutionDetail,{title:t.ValidationResultsPanel.name,value:l.SolutionUniqueName}),!c&&o.createElement(a.SolutionDetail,{title:t.ValidationResultsPanel.type,value:l.IsManaged?t.SolutionDetails.managed:t.SolutionDetails.unmanaged}),o.createElement(a.SolutionDetail,{title:t.ValidationResultsPanel.publisher,value:l.PublisherFriendlyName}),o.createElement(a.SolutionDetail,{title:t.ValidationResultsPanel.description,value:l.SolutionDescription}),!c&&(Object(i.isUpdate)(l)?o.createElement(o.Fragment,null,o.createElement(a.SolutionDetail,{title:t.ValidationResultsPanel.currentVersion,value:l.PreviousSolutionVersion}),o.createElement(a.SolutionDetail,{title:t.ValidationResultsPanel.updateVersion,value:l.SolutionVersion})):o.createElement(a.SolutionDetail,{title:t.ValidationResultsPanel.version,value:l.SolutionVersion})),!c&&o.createElement(a.SolutionDetail,{title:t.ValidationResultsPanel.Patch.patch,value:l.IsPatchSolution?t.ValidationResultsPanel.Patch.yes:t.ValidationResultsPanel.Patch.no}))}},6910:function(e,t,n){"use strict";n.r(t),n.d(t,"SolutionDetail",(function(){return i}));var o=n(245),r=n(6905),a=n(2903),i=e=>e.value?o.createElement("div",{className:r.solutionImportPanelClasses.detailContainer},o.createElement("span",{className:Object(a.css)(r.solutionImportPanelClasses.detailTitle,r.solutionImportPanelClasses.regularText,r.solutionImportPanelClasses.boldText,r.solutionImportPanelClasses.displayType)},e.title),o.createElement("span",{className:r.solutionImportPanelClasses.largerText},e.value)):o.createElement(o.Fragment,null)},6911:function(e,t,n){"use strict";n.r(t),n.d(t,"formatStageSolutionErrorMessage",(function(){return c})),n.d(t,"getMissingSolutionsString",(function(){return p})),n.d(t,"formatStageSolutionWarningMessage",(function(){return u})),n.d(t,"shouldShowAdvancedSettings",(function(){return d})),n.d(t,"isConvertComponentsToManagedWarning",(function(){return m})),n.d(t,"isUnmanagedUpdate",(function(){return b})),n.d(t,"isUpdate",(function(){return g}));var o=n(6902),r=n(6702),a=n(1089),i=n(5916),s=n(1104),l=n(5806);function c(e,t,n,o){if(e){if(Object(r.isSolutionValidationResult)(e)){if(-2147188707===e.ErrorCode){var s=p(t);return{stageSolutionErrorMessage:Object(a.formatResourceString)(n.missingDependenciesError,s),fullStageSolutionErrorMessage:t.SolutionValidationResults?JSON.stringify(t.SolutionValidationResults):void 0}}return/missing [a-zA-Z0-9]+ privilege/g.test(e.Message||"")?{stageSolutionErrorMessage:n.missingPermissions,fullStageSolutionErrorMessage:void 0}:{stageSolutionErrorMessage:e.Message,fullStageSolutionErrorMessage:void 0}}return{stageSolutionErrorMessage:Object(i.parseMessageFromError)(e,o),fullStageSolutionErrorMessage:void 0}}return{stageSolutionErrorMessage:void 0,fullStageSolutionErrorMessage:void 0}}function p(e){var t="";if(e&&e.MissingDependencies){var n=new Map;e.MissingDependencies.forEach((e,o)=>{var r=e.RequiredSolutionName;0==o?t='"'.concat(r,'"'):n.has(r)||(t+=', "'.concat(r,'"')),n.set(r,!0)})}return t}function u(e,t,n){return e?e.Message:t&&t.SolutionDetails&&t.SolutionDetails.PreviousSolutionVersion&&(!Object(s.isCdsLiteContext)()||t.SolutionDetails.IsManaged)?t.SolutionDetails.PreviousSolutionVersion===t.SolutionDetails.SolutionVersion?n.solutionVersionAlreadyInstalled:n.updateInstalledSolution:void 0}function d(e){return Object(o.didStageSolutionPass)(e)&&!!e.SolutionDetails.PreviousSolutionVersion&&e.SolutionDetails.PreviousSolutionVersion!==e.SolutionDetails.SolutionVersion}function m(e){return e&&e.Message==r.convertComponentsToManagedWarningMessage}function b(e){return!e.IsManaged&&g(e)}function g(e){return e.PreviousSolutionVersion&&Object(l.isMoreRecentVersion)(e.PreviousSolutionVersion,e.SolutionVersion)}},6912:function(e,t,n){"use strict";n.r(t),n.d(t,"_getValidationResultsPanelContentsV2",(function(){return b}));var o=n(245),r=n(6905),a=n(1089),i=n(1697),s=n(3064),l=n(545),c=n(687),p=n(2844),u=n(5611),d=n(6913),m=n(5613),b=e=>{var t,n,c,{labels:p,selectedFileName:u,componentsSelection:m,componentsList:b,stageSolutionResults:y}=e,S=[];null!=b&&b.forEach(e=>{e.componentDetail.IsPresentInOrg==d.ComponentExistenceStatus.TRUE&&S.push(e.Items)});return o.createElement(o.Fragment,null,o.createElement("p",null,o.createElement("span",{className:r.solutionImportPanelClasses.subHeaderText},null!=y&&null!==(t=y.SolutionDetails)&&void 0!==t&&t.IsManaged?p.ValidationResultsPanel.selectiveImportTitleManagedSolution:p.ValidationResultsPanel.selectiveImportTitleUnmanagedSolution)),o.createElement("p",null,o.createElement("span",{className:r.solutionImportPanelClasses.subHeaderContentsText},Object(a.formatResourceString)(null!=y&&null!==(n=y.SolutionDetails)&&void 0!==n&&n.IsManaged?p.ValidationResultsPanel.selectiveImportDescriptionManagedSolution:p.ValidationResultsPanel.selectiveImportDescriptionUnmanagedSolution,u))),0!==S.length&&o.createElement("div",{className:r.solutionImportPanelClasses.advancedSettingsItemDescription},o.createElement(i.MessageBar,{messageBarType:i.MessageBarType.info},o.createElement("span",{className:r.solutionImportPanelClasses.regularText},p.ValidationResultsPanel.notificationForExistingComponents),o.createElement("span",{className:r.solutionImportPanelClasses.boldText},S.join(", ")))),o.createElement(s.DetailsList,{isHeaderVisible:!0,items:b,columns:[{key:"Icon",minWidth:40,maxWidth:40,name:"Icon",fieldName:"Icon",iconName:"Documentation",isIconOnly:!0},{key:"Items",minWidth:30,maxWidth:240,name:"Items",fieldName:"Items"},{key:"Type",minWidth:30,name:"Type",fieldName:"Type"}],setKey:"key",selectionMode:null!=y&&null!==(c=y.SolutionDetails)&&void 0!==c&&c.IsManaged?l.SelectionMode.none:l.SelectionMode.multiple,selection:m,onRenderItemColumn:g,selectionPreservedOnEmptyClick:!0}))};function g(e,t,n){switch(n.key){case"Items":return o.createElement("span",{className:r.solutionImportPanelClasses.componentsListItemName},e.Items);case"Type":return o.createElement("span",{className:r.solutionImportPanelClasses.componentsListItemType},e.Type);case"Icon":return function(e){var t;switch(e.componentDetail.ComponentTypeName.toLowerCase()){case u.StandardSolutionComponentTypes.CanvasApp.logicalName:t=p.defaultSolutionComponentIcons.App.iconName;break;case u.StandardSolutionComponentTypes.Flow.logicalName:t=p.defaultSolutionComponentIcons.Flow.iconName;break;case m.KnownCustomSolutionComponentTypes.bot.logicalName:t=p.defaultSolutionComponentIcons.Chatbot.iconName;break;case u.StandardSolutionComponentTypes.Entity.logicalName:default:t=p.defaultSolutionComponentIcons.Entity.iconName}return o.createElement("div",{className:r.solutionComponentListIconBackgroundStyles.default},o.createElement(c.Icon,{iconName:t,styles:r.solutionComponentListIconStyle}))}(e);default:return o.createElement("span",null," ")}}},6913:function(e,t,n){"use strict";var o;n.r(t),n.d(t,"ComponentExistenceStatus",(function(){return o})),function(e){e.TRUE="True",e.FALSE="False",e.UNKNOWN="UNKNOWN"}(o||(o={}))},6914:function(e,t,n){"use strict";n.r(t),n.d(t,"useConnectionReferencesPanel",(function(){return S}));var o=n(245),r=n.n(o),a=n(6376),i=n(1697),s=n(1201),l=n(217),c=n(1106),p=n(6375),u=n(6695),d=n(6701),m=n(6915);function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){y(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function S(e,t,n,b,y,S,f,h,O,C,v){var P,E,{currentEnvironment:T}=Object(o.useContext)(c.EnvironmentContext),[j,A]=Object(o.useState)(),[R,I]=r.a.useState(!1);function w(){return C&&C.length>0?a.SolutionImportPanelSteps.environmentVariables:a.SolutionImportPanelSteps.import}(h||j)&&(P={messageBarProps:{messageBarType:i.MessageBarType.error,dismissButtonAriaLabel:t.close},onRenderBody:()=>r.a.createElement("div",null,h&&r.a.createElement("div",null,h),j&&r.a.createElement("div",null,j))}),(O||R)&&(E={spinnerProps:{size:s.SpinnerSize.large,label:t.ConnectionReferencesPanel.loading,ariaLabel:t.ConnectionReferencesPanel.loading,ariaLive:"polite",role:"alert"}});var D=g({currentStep:p.FriendlySolutionImportPanelSteps.get(a.SolutionImportPanelSteps.connectionReferences)},Object(p.getConnectionReferencesTelemetryData)(n,b));return g(g({},e),{},{messageBar:P,children:r.a.createElement(u.MultiConnectionsPicker,{setErrorMessage:A,connectionReferences:n,connections:b,connectionTypes:y,onChangeConnectionSelection:S,onRefreshConnections:f,telemetryScope:p.SolutionEventScope,environmentName:null==T?void 0:T.name,setIsLoadingConnectionReferencesFlowWidget:I}),className:m.panelContentStyles.panelStyles,styles:{content:{display:"flex",width:"100%"},contentInner:{display:"flex"},scrollableContent:{display:"flex",padding:"0px 24px 24px 24px"}},loadingOverlay:E,footerButtons:[{primary:!0,navigateableOnClick:()=>{var e=w();return Object(l.trackUserActionClickButton)(p.SolutionEventScope,p.EventNames.GoForward,g(g({},D),{},{nextStep:p.FriendlySolutionImportPanelSteps.get(e)})),e==a.SolutionImportPanelSteps.import&&v(),e},disabled:!Object(d.areAllConnectionsSelected)(n),ariaLabel:t.next,text:w()==a.SolutionImportPanelSteps.import?t.import:t.next},{ariaLabel:t.cancel,text:t.cancel,navigateableOnClick:(e,t)=>(t(),null)}]})}},6915:function(e,t,n){"use strict";n.r(t),n.d(t,"panelContentStyles",(function(){return r}));var o=n(719),r=Object(o.mergeStyleSets)({panelStyles:{selectors:{"& .ba-Panel-headerContainer":{paddingLeft:"24px !important",paddingBottom:"18px !important"},"& .ba-Panel-content":{display:"flex",flexDirection:"column",width:"100%"}}}})},6916:function(e,t,n){"use strict";n.r(t),n.d(t,"getEnvironmentVariablesPanel",(function(){return m}));var o=n(245),r=n(6376),a=n(217),i=n(6375),s=n(6715),l=n(6753),c=n(6917);function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function m(e,t,n,p,d){var m=u({currentStep:i.FriendlySolutionImportPanelSteps.get(r.SolutionImportPanelSteps.environmentVariables)},Object(i.getEnvironmentVariableTelemetryData)(n));return u(u({},e),{},{children:o.createElement(s.MultiEnvironmentVariablesPicker,{environmentVariableDefinitions:n,onUpdateEnvironmentVariableDefinitions:p}),className:c.panelContentStyles.panelStyles,footerButtons:[{primary:!0,navigateableOnClick:e=>{var t=r.SolutionImportPanelSteps.import;return Object(a.trackUserActionClickButton)(i.SolutionEventScope,i.EventNames.GoForward,u(u({},m),{},{nextStep:i.FriendlySolutionImportPanelSteps.get(t)})),d(),t},disabled:!Object(l.areAllEnvironmentVariablesValid)(n),ariaLabel:t.import,text:t.import},{ariaLabel:t.cancel,text:t.cancel,navigateableOnClick:(e,t)=>(t(),null)}]})}},6917:function(e,t,n){"use strict";n.r(t),n.d(t,"panelContentStyles",(function(){return r}));var o=n(719),r=Object(o.mergeStyleSets)({panelStyles:{selectors:{"& .ba-Panel-headerContainer":{paddingBottom:"18px !important"}}}})},6918:function(e,t,n){"use strict";n.r(t),n.d(t,"getExistingConnectionReferences",(function(){return u}));var o=n(6702),r=n(6378),a=n(2812),i=n.n(a),s=n(2869),l=n(6919);function c(e,t,n,o,r,a,i){try{var s=e[a](i),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(o,r)}function p(e){return function(){var t=this,n=arguments;return new Promise((function(o,r){var a=e.apply(t,n);function i(e){c(a,o,r,i,s,"next",e)}function s(e){c(a,o,r,i,s,"throw",e)}i(void 0)}))}}function u(e,t){return d.apply(this,arguments)}function d(){return(d=p((function*(e,t){if(!t.SolutionDetails.PreviousSolutionUniqueName)return{};var n={},r=t.SolutionComponentsDetails.filter(o.isConnectionReference);if(i.a.isEmpty(r))return{};var a=m(e),s=Object(l.getExistingEnvironmentConnectionReferences)(),c=yield a,p=yield s;return r.forEach(e=>{var t=e.Attributes.get("connectorid")||"";if(t){var o=e.Attributes.get("connectionreferencelogicalname")||"";if(o){var r=p.find(e=>e.connectionreferencelogicalname===o);if(r)return void(n[o]=r.connectionid);var a=c.rpConnectionsWithApiDetails.find(e=>e.apiId===t);if(!a)return;n[o]=a.name}}}),n}))).apply(this,arguments)}function m(e){return b.apply(this,arguments)}function b(){return(b=p((function*(e){var t=yield e.query({query:r.ConnectionsWithDetailsQuery});if(t&&(t.errors||!t.data))throw new Error(Object(s.getResources)().Common.Request.Failed);return t.data}))).apply(this,arguments)}},6919:function(e,t,n){"use strict";n.r(t),n.d(t,"getExistingEnvironmentConnectionReferences",(function(){return i}));var o=n(2868);function r(e,t,n,o,r,a,i){try{var s=e[a](i),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(o,r)}function a(e){return function(){var t=this,n=arguments;return new Promise((function(o,a){var i=e.apply(t,n);function s(e){r(i,o,a,s,l,"next",e)}function l(e){r(i,o,a,s,l,"throw",e)}s(void 0)}))}}function i(){return s.apply(this,arguments)}function s(){return(s=a((function*(){for(var e=yield o.MetadataClientInstance.getInstance().fetchList("ConnectionReference",void 0),t=e.data;e.hasNext;)yield e.next(),t=t.concat(e.data);return t}))).apply(this,arguments)}},6920:function(e,t,n){"use strict";n.r(t),n.d(t,"useImportRequestPanel",(function(){return c}));var o=n(245),r=n(1697),a=n(1201);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t,n,i){var l,c;n&&(l={spinnerProps:{size:a.SpinnerSize.large,label:t.SolutionImport.loading,ariaLabel:t.SolutionImport.loading,ariaLive:"polite",role:"alert"}});var p=i;return p&&(c={messageBarProps:{messageBarType:r.MessageBarType.error},onRenderBody:()=>o.createElement(o.Fragment,null,p)}),s(s({},e),{},{messageBar:c,loadingOverlay:l,footerButtons:[{ariaLabel:t.close,text:t.close,navigateableOnClick:(e,t)=>(t(),null)}]})}},6921:function(e,t,n){"use strict";n.r(t),n.d(t,"useImportSolutionHook",(function(){return l}));var o=n(245),r=n(6901),a=n(3193),i=n(218);function s(e,t,n,o,r,a,i){try{var s=e[a](i),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(o,r)}var l=(e,t,n,l)=>{var c=a.TelemetryScenarioNames.importSolution,p=Object(o.useRef)(),[u,d]=Object(o.useState)(!1),[m,b]=Object(o.useState)(void 0),[g,y]=Object(o.useState)(void 0);function S(e){y(e),p.current&&(p.current.failure({error:e}),p.current=void 0),d(!1)}return Object(o.useEffect)(()=>{u&&(p.current=Object(i.trackLoadScenario)(l,c))},[u]),{_requestSolutionImport:()=>{b(void 0),y(void 0),d(!0);var o=e=>{n(e).then(e=>{!function(e){b(e),p.current&&(p.current.complete(),p.current=void 0),d(!1)}(e)}).catch(e=>{S(e)})};Object(r.isValidStageSolutionUploadId)(e)?o({uploadId:e,isEncodedSolutionFile:!1}):Object(r.getBase64)(t).then(function(){var t,n=(t=function*(t){o({uploadId:e,encodedSolutionFile:t,isEncodedSolutionFile:!0})},function(){var e=this,n=arguments;return new Promise((function(o,r){var a=t.apply(e,n);function i(e){s(a,o,r,i,l,"next",e)}function l(e){s(a,o,r,i,l,"throw",e)}i(void 0)}))});return function(e){return n.apply(this,arguments)}}()).catch(e=>{S(e)})},isRequestOngoing:u,importRequestResult:m,importRequestError:g}}},6922:function(e,t,n){"use strict";n.r(t),n.d(t,"formatImportSolutionErrorMessage",(function(){return u})),n.d(t,"generateImportSolutionContract",(function(){return d}));var o=n(6376),r=n(5916),a=n(6923),i=n(2871),s=n(3713);function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){p(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e,t){if(e)return Object(r.parseMessageFromError)(e,t)}function d(e,t,n,r,i,s,l,p,u,d,b,g){return c(c(c(c(c({},function(e){return e.isEncodedSolutionFile?{CustomizationFile:e.encodedSolutionFile}:{}}(e)),{},{PublishWorkflows:n},function(e){return e==o.SolutionActionsKeys.stageForUpgrade||e==o.SolutionActionsKeys.update?{HoldingSolution:e==o.SolutionActionsKeys.stageForUpgrade}:void 0}(t)),function(e){return e?{ConvertToManaged:!0}:void 0}(r)),{},{OverwriteUnmanagedCustomizations:!1},Object(a.generateEntityCollectionProperty)(i,s,l,p)),{},{SolutionParameters:m(e,u,d,b,g)})}function m(e,t,n,o,r){if(Object(s.isCDSLiteUXContext)(r)&&i.featureGates.enableTeamsSolutionImportV2&&n){var a=[];return n.forEach(e=>{var n,r=t.find(t=>t.key==e);switch(r.Type){case o.ComponentType.CanvasApp:n="Microsoft.Dynamics.CRM.canvasapp";break;case o.ComponentType.Table:n="Microsoft.Dynamics.CRM.entity";break;case o.ComponentType.Flow:n="Microsoft.Dynamics.CRM.workflow";break;case o.ComponentType.Chatbot:n="Microsoft.Dynamics.CRM.chatbot";break;default:throw new Error("unsupported component type")}var i={};i["@odata.type"]=n,r.componentDetail.Attributes.forEach((e,t)=>{i[t]=e}),a.push({Component:i,ImportDecision:"Skip"})}),{StageSolutionUploadId:e.uploadId,SolutionComponentOptions:a}}return{StageSolutionUploadId:e.uploadId}}},6923:function(e,t,n){"use strict";n.r(t),n.d(t,"generateEntityCollectionProperty",(function(){return s}));var o=n(6703);function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t,n,r){var a=[];return[...e||[],...t||[]].filter(e=>!e.forConnectorEnvironmentVariable).forEach(e=>{var t={"@odata.type":"Microsoft.Dynamics.CRM.connectionreference",connectionreferencedisplayname:e.connectionreferencedisplayname,connectionreferencelogicalname:e.connectionreferencelogicalname,description:e.description,connectorid:e.connectorid,connectionid:e.selectedConnectionName||""};a.push(t)}),n&&n.forEach(e=>{Object(o.isPickerParentConnectorEnvironmentVariableDefinition)(e)&&e.childVariables.forEach(e=>{l(e,a)}),l(e,a)}),r&&r.forEach(e=>{if(e.currentValue){var t={"@odata.type":"Microsoft.Dynamics.CRM.environmentvariablevalue",schemaname:e.schemaname,value:e.currentValue.value,environmentvariablevalueid:e.currentValue.environmentvariablevalueid};a.push(t)}}),a.length>0?{ComponentParameters:a}:{}}function l(e,t){if(e.userSelectedValue){var n={"@odata.type":"Microsoft.Dynamics.CRM.environmentvariablevalue",schemaname:e.schemaname,value:e.userSelectedValue.value};e.userSelectedValue.environmentvariablevalueid&&(n=a(a({},n),{},{environmentvariablevalueid:e.userSelectedValue.environmentvariablevalueid})),t.push(n)}}},6924:function(e,t,n){"use strict";function o(e){return{close:e.t("Common.close"),next:e.t("Common.next"),cancel:e.t("Common.Save.cancel"),import:e.t("Model.Solutions.ImportPanel.import"),title:e.t("Model.Solutions.ImportPanel.title"),selectiveImportTitle:e.t("Model.Solutions.ImportPanel.selectiveImportTitle"),environment:e.t("Model.Solutions.ImportPanel.environment"),ComponentType:{CanvasApp:e.t("Model.Solutions.Components.Types.canvasApp"),Table:e.t("Model.Solutions.Components.Types.table"),Flow:e.t("Model.Solutions.Components.Types.flow"),Chatbot:e.t("Model.Solutions.Components.Types.bot")},FileSelectionPanel:{processing:e.t("Model.Solutions.ImportPanel.FileSelectionPanel.processing"),title:e.t("Model.Solutions.ImportPanel.FileSelectionPanel.title"),content:e.t("Model.Solutions.ImportPanel.FileSelectionPanel.content"),browse:e.t("Model.Solutions.ImportPanel.FileSelectionPanel.browse"),noFileChosen:e.t("Model.Solutions.ImportPanel.FileSelectionPanel.noFileChosen")},ValidationResultsPanel:{downloadLog:e.t("Model.Solutions.ImportPanel.ValidationResultsPanel.downloadLog"),title:e.t("Model.Solutions.ImportPanel.ValidationResultsPanel.title"),name:e.t("Model.Solutions.ImportPanel.ValidationResultsPanel.name"),type:e.t("Model.Solutions.ImportPanel.ValidationResultsPanel.type"),publisher:e.t("Model.Solutions.ImportPanel.ValidationResultsPanel.publisher"),description:e.t("Model.Solutions.ImportPanel.ValidationResultsPanel.description"),version:e.t("Model.Solutions.ImportPanel.ValidationResultsPanel.version"),currentVersion:e.t("Model.Solutions.ImportPanel.ValidationResultsPanel.currentVersion"),updateVersion:e.t("Model.Solutions.ImportPanel.ValidationResultsPanel.updateVersion"),selectiveImportTitleUnmanagedSolution:e.t("Model.Solutions.ImportPanel.ValidationResultsPanel.selectiveImportTitleUnmanagedSolution"),selectiveImportTitleManagedSolution:e.t("Model.Solutions.ImportPanel.ValidationResultsPanel.selectiveImportTitleManagedSolution"),selectiveImportDescriptionUnmanagedSolution:e.t("Model.Solutions.ImportPanel.ValidationResultsPanel.selectiveImportDescriptionUnmanagedSolution"),selectiveImportDescriptionManagedSolution:e.t("Model.Solutions.ImportPanel.ValidationResultsPanel.selectiveImportDescriptionManagedSolution"),notificationForExistingComponents:e.t("Model.Solutions.ImportPanel.ValidationResultsPanel.notificationForExistingComponents"),Patch:{patch:e.t("Model.Solutions.ImportPanel.ValidationResultsPanel.Patch.patch"),yes:e.t("Model.Solutions.ImportPanel.ValidationResultsPanel.Patch.yes"),no:e.t("Model.Solutions.ImportPanel.ValidationResultsPanel.Patch.no")},ValidationErrors:{missingDependenciesError:e.t("Model.Solutions.ImportPanel.ValidationResultsPanel.KnownErrors.missingDependenciesError"),solutionVersionAlreadyInstalled:e.t("Model.Solutions.ImportPanel.ValidationResultsPanel.KnownErrors.solutionVersionAlreadyInstalled"),updateInstalledSolution:e.t("Model.Solutions.ImportPanel.ValidationResultsPanel.KnownErrors.updateInstalledSolution"),convertComponentsToManagedWarning:e.t("Model.Solutions.ImportPanel.ValidationResultsPanel.KnownErrors.convertComponentsToManagedWarning"),missingPermissions:e.t("Model.Solutions.ImportPanel.ValidationResultsPanel.KnownErrors.missingPermissionsError")},AdvancedSettings:{advancedSettings:e.t("Model.Solutions.ImportPanel.ValidationResultsPanel.AdvancedSettings.advancedSettings"),SolutionActions:{title:e.t("Model.Solutions.ImportPanel.ValidationResultsPanel.AdvancedSettings.SolutionActions.title"),learnMore:e.t("Model.Solutions.ImportPanel.ValidationResultsPanel.AdvancedSettings.SolutionActions.learnMore"),Upgrade:{title:e.t("Model.Solutions.ImportPanel.ValidationResultsPanel.AdvancedSettings.SolutionActions.Upgrade.title"),description:e.t("Model.Solutions.ImportPanel.ValidationResultsPanel.AdvancedSettings.SolutionActions.Upgrade.description")},StageForUpgrade:{title:e.t("Model.Solutions.ImportPanel.ValidationResultsPanel.AdvancedSettings.SolutionActions.StageForUpgrade.title"),description:e.t("Model.Solutions.ImportPanel.ValidationResultsPanel.AdvancedSettings.SolutionActions.StageForUpgrade.description")},UpdateNotRecommended:{title:e.t("Model.Solutions.ImportPanel.ValidationResultsPanel.AdvancedSettings.SolutionActions.UpdateNotRecommended.title"),description:e.t("Model.Solutions.ImportPanel.ValidationResultsPanel.AdvancedSettings.SolutionActions.UpdateNotRecommended.description")},Update:{title:e.t("Model.Solutions.ImportPanel.ValidationResultsPanel.AdvancedSettings.SolutionActions.Update.title"),description:e.t("Model.Solutions.ImportPanel.ValidationResultsPanel.AdvancedSettings.SolutionActions.Update.description")}},EnableSdkMessagesAndFlows:{title:e.t("Model.Solutions.ImportPanel.ValidationResultsPanel.AdvancedSettings.EnableSdkMessagesAndFlows.title")}}},ConnectionReferencesPanel:{loading:e.t("Model.Solutions.ImportPanel.ConnectionReferencesPanel.loading")},SolutionImport:{loading:e.t("Model.Solutions.ImportPanel.SolutionImport.loading")},SolutionDetails:{managed:e.t("Model.Solutions.ImportPanel.SolutionDetails.managed"),unmanaged:e.t("Model.Solutions.ImportPanel.SolutionDetails.unmanaged")},DismissPanel:{title:e.t("Common.DismissDialog.title"),confirmButtonText:e.t("Common.DismissDialog.confirmButtonText"),cancelButtonText:e.t("Common.DismissDialog.cancelButtonText")},Errors:{StandardErrorMessages:{authenticationError:e.t("Common.StandardErrorMessages.authenticationError"),authorizationError:e.t("Common.StandardErrorMessages.authorizationError"),serverResponseCodeError:e.t("Common.StandardErrorMessages.serverResponseCodeError"),unknownErrorType:e.t("Common.StandardErrorMessages.unknownErrorType")},requestFailed:e.t("Common.Request.Failed")}}}n.r(t),n.d(t,"getSolutionImportPanelLabels",(function(){return o}))}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/109.2ad8f8aa.chunk.js.map