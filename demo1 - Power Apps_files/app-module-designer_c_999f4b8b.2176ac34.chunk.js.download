/*! For license information please see app-module-designer~c~999f4b8b.2176ac34.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[343],{12070:function(e,t,n){"use strict";n.r(t);var r=n(12071);n.d(t,"PropertySheetInner",(function(){return r.PropertySheetInner})),n.d(t,"PropertySheet",(function(){return r.PropertySheet})),n.d(t,"validatePropertySheet",(function(){return r.validatePropertySheet})),n.d(t,"validateProperty",(function(){return r.validateProperty}));n(12082);var a=n(12076);n.d(t,"styles",(function(){return a.styles})),n.d(t,"sectionAccordionHeaderStyles",(function(){return a.sectionAccordionHeaderStyles})),n.d(t,"dropdownIconStyles",(function(){return a.dropdownIconStyles}))},12071:function(e,t,n){"use strict";n.r(t),n.d(t,"PropertySheetInner",(function(){return x})),n.d(t,"PropertySheet",(function(){return L})),n.d(t,"validatePropertySheet",(function(){return R})),n.d(t,"validateProperty",(function(){return D}));var r=n(2846),a=n(5160),o=n(684),l=n(1362),i=n(1368),s=n(687),d=n(1567),c=n(1372),p=n(1789),u=n(245),y=n(12072),h=n(12075),m=n(1429),b=n(12076),f=n(923),v=n(12077),g=n(719);function k(e,t,n,r,a,o,l){try{var i=e[o](l),s=i.value}catch(d){return void n(d)}i.done?t(s):Promise.resolve(s).then(r,a)}function E(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function l(e){k(o,r,a,l,i,"next",e)}function i(e){k(o,r,a,l,i,"throw",e)}l(void 0)}))}}function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function P(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(Object(n),!0).forEach((function(t){S(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function S(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function O(){return(O=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var w=e=>u.createElement(o.DefaultButton,O({},e,{styles:b.sectionAccordionHeaderStyles}));class x extends u.PureComponent{constructor(e){var t;super(e),t=this,this.defaultOpenedSections=void 0,this.mapPropertySections=e=>(this.defaultOpenedSections=[],e.map((e,t)=>{var n,a="".concat(e.key,"-label"),o=this.mapEditableProperties(e.properties,a),l=u.createElement("hr",{className:b.styles.propertyPanePropertySeparator});(0===t||e.openByDefault)&&(n=u.createRef(),this.defaultOpenedSections.push(n));var i="".concat(e.key,"-info");if(e.label){if(!1===e.showAsAccordion){var s=e.info?this.onRenderInfoTooltip(e.info,e.key):u.createElement(u.Fragment,null);return u.createElement("div",{key:t,"data-cy":e.key,className:b.styles.sectionContainer},u.createElement("div",{className:b.styles.sectionLabel,id:i},u.createElement("span",{id:a,"aria-hidden":"true"},e.label),s),u.createElement("div",{className:b.styles.sectionContent},o),e.showSeparator?l:u.createElement(u.Fragment,null))}return u.createElement("div",{key:t,className:b.styles.sectionContainer,"data-cy":e.key},u.createElement(r.Accordion,{componentRef:n,buttonAs:w,text:e.label,onRenderContent:()=>u.createElement("div",{className:b.styles.sectionContent},o),styles:{header:{backgroundColor:"transparent"}}}),e.showSeparator?l:u.createElement(u.Fragment,null))}return u.createElement("div",{key:t,className:b.styles.sectionContent,"data-cy":e.key},o,e.showSeparator?l:u.createElement(u.Fragment,null))})),this.onRenderIconOption=e=>e?u.createElement("div",{className:b.styles.dropdownItemContainer},u.createElement("div",{className:b.styles.dropdownIconText},e.text),e.iconProps?u.createElement(s.Icon,{className:b.styles.dropdownIcon,iconName:e.iconProps.iconName,"aria-hidden":"true"}):u.createElement(u.Fragment,null)):u.createElement(u.Fragment,null),this.onRenderOption=e=>u.createElement("div",null,e&&e.data&&e.data.icon&&u.createElement(s.Icon,{style:{marginRight:"8px"},title:e.data.icon,iconName:e.data.icon,"aria-hidden":"true"}),u.createElement("span",null,e&&e.text)),this.getPropertyByType=(e,n)=>{var r,s,c,y,f;switch(e.inputType){case"number":y=u.createElement(a.NumberField,{key:e.key,value:e.value,onBlurred:t=>{this.handlePropertyValueChange(e,t)},textFieldProps:P(P({},e.textFieldProps),{},{ariaLabel:e.label,onRenderLabel:t=>this.onRenderWrappedLabel(e.key,e.label,"top",e.required,e.disabled,e.info),onGetErrorMessage:(f=E((function*(n){return yield D(e,t.props.t("requiredValidation"),Number(n))})),function(e){return f.apply(this,arguments)}),validateOnLoad:!1,disabled:e.disabled}),maxPrecision:e.maxPrecision,formatValue:e.formatValue});break;case"text":y=u.createElement(h.LiveTextField,O({},e.textFieldProps,{"aria-required":e.required,ariaLabel:e.label,key:e.key,value:e.value||"",multiline:e.multiline,onRenderLabel:t=>this.onRenderWrappedLabel(e.key,e.label,"top",e.required,e.disabled,e.info),onBlur:t=>this.handlePropertyValueChange(e,t.target.value),disabled:e.disabled,onGetErrorMessage:function(){var n=E((function*(n){return yield D(e,t.props.t("requiredValidation"),n)}));return function(e){return n.apply(this,arguments)}}()}));break;case"checkbox":y=u.createElement(l.Checkbox,{ariaDescribedBy:"".concat(e.key,"-label"),ariaLabel:e.label,key:e.key,checked:!!e.value,styles:{checkbox:{margin:"0px"}},onRenderLabel:t=>this.onRenderLabel(e.key,e.label,"right",e.info),onChange:(t,n)=>this.handlePropertyValueChange(e,!!n),disabled:e.disabled});break;case"dropdown":y=u.createElement(u.Fragment,null,this.onRenderWrappedLabel(e.key,e.label,"top",e.required,e.disabled,e.info),u.createElement(d.Dropdown,O({id:e.key,options:e.options,onRenderOption:this.onRenderOption,key:e.key,selectedKey:e.value,selectedKeys:e.dropdownProps&&e.dropdownProps.multiSelect?e.value:void 0,required:e.required,onChanged:t=>this.handlePropertyValueChange(e,t.key),disabled:e.disabled,"aria-labelledby":"".concat(e.key,"-label"),"aria-describedby":"".concat(e.key,"-option"),ariaLabel:e.label,role:e.dropdownProps&&e.dropdownProps.multiSelect?"button":"combobox",styles:Object(g.mergeStyleSets)({root:{maxWidth:300}},{dropdownItem:{height:"auto"}},null===(r=e.dropdownProps)||void 0===r?void 0:r.styles)},e.dropdownProps)));break;case"dropdownIcon":y=u.createElement(u.Fragment,null,this.onRenderWrappedLabel(e.key,e.label,"top",e.required,e.disabled,e.info),u.createElement(d.Dropdown,{options:e.options,key:e.key,selectedKey:e.value,required:e.required,onRenderOption:e=>this.onRenderIconOption(e),onChanged:t=>this.handlePropertyValueChange(e,t.key),disabled:e.disabled,ariaLabel:e.label,styles:b.dropdownIconStyles}));break;case"spinButton":var k=null!==(s=e.stepValue)&&void 0!==s?s:1,C=null!==(c=e.minValue)&&void 0!==c?c:1;y=u.createElement(u.Fragment,null,this.onRenderWrappedLabel(e.key,e.label,"top",e.required,e.disabled,e.info),u.createElement(p.SpinButton,{key:e.key,ariaLabel:e.label,value:void 0!==e.value&&null!=e.value?e.getDisplayValue?e.getDisplayValue(e.value.toString()):e.value.toString():void 0,onIncrement:(t,n)=>{this.onStepValueChanged(e,k,C)},onDecrement:(t,n)=>{this.onStepValueChanged(e,-k,C)},onChange:(t,n)=>{var r=Number(n);this.handlePropertyValueChange(e,r)},incrementButtonAriaLabel:"Increment by ".concat(e.stepValue),decrementButtonAriaLabel:"Decrement by ".concat(e.stepValue),min:C,max:e.maxValue,step:k}));break;case"choiceGroup":y=u.createElement(u.Fragment,null,this.onRenderWrappedLabel(e.key,e.label,"top",e.required,e.disabled,e.info),u.createElement(i.ChoiceGroup,{options:e.options,required:e.required,key:e.key,selectedKey:e.value,onChange:(t,n)=>this.handlePropertyValueChange(e,n.key),disabled:e.disabled,ariaLabelledBy:e.label}));break;case"readonly":var S=e.multiline?u.createElement(m.TextField,{ariaLabel:e.value,key:e.key+"-text",value:e.value,multiline:!0,readOnly:!0}):e.value,w=u.createElement("span",{"data-cy":e.key,className:b.styles.readonlyField},S),x=e.showInfoInValue&&e.info?u.createElement(u.Fragment,null,w,this.onRenderInfoTooltip(e.info,e.key)):w;y=u.createElement(u.Fragment,null,this.onRenderWrappedLabel(e.key,e.label,"top",e.required,!1,e.showInfoInValue?void 0:e.info),x);break;case"action":y=u.createElement(o.ActionButton,O({onClick:()=>e.onChanged&&e.onChanged()},e.buttonProps,{text:e.label,disabled:e.disabled}));break;case"custom":y=e.onRender(P(P({},e),{},{onChanged:t=>{this.handlePropertyValueChange(e,t)}}));break;case"pill":y=u.createElement(v.Pill,{t:this.props.t,pillDisplayText:e.pillDisplayText,onRenderCalloutInnerContent:e.onRenderCalloutInnerContent,headerText:e.headerText,onDelete:e.onDelete});break;default:y=u.createElement(u.Fragment,null)}return y},this.onStepValueChanged=(e,t,n)=>{if(void 0!==e.value&&null!=e.value){var r=e.value+t;r<=e.maxValue&&r>=n&&this.handlePropertyValueChange(e,r)}},this.mapEditableProperties=(e,t)=>e.filter(e=>!1!==e.visible).map((e,n)=>{var r=this.getPropertyByType(e,t),a=u.createElement(u.Fragment,null);return e.subProperties&&(a=u.createElement("div",{className:b.styles.subPropertyLabel},e.subProperties.filter(e=>!1!==e.visible).map(e=>this.getPropertyByType(e,t)))),u.createElement("div",{key:e.key,"data-cy":e.key,className:"custom"===e.inputType?b.styles.customPropertyContainer:b.styles.propertyContainer},r,a)}),this.renderOnEmpty=e=>u.createElement("div",{key:"0",className:b.styles.emptyContentContainer},u.createElement("div",{className:b.styles.emptyContentLabel},u.createElement(c.Label,{required:!1,disabled:!1},e))),this.defaultOpenedSections=[]}componentDidMount(){this.defaultOpenedSections.forEach(e=>{e.current&&e.current.toggleState()})}render(){var e=this.props.sections&&this.props.sections.length?this.mapPropertySections(this.props.sections):this.props.renderOnEmpty?this.props.renderOnEmpty():this.props.emptyStateString?this.renderOnEmpty(this.props.emptyStateString):u.createElement(u.Fragment,null);return u.createElement("div",null,e)}handlePropertyValueChange(e,t){var n=this;return E((function*(){var r;e.value!==t&&(e.onChanged&&(n.props.allowInvalidOnChange||(r=yield D(e,n.props.t("requiredValidation"),t)),r||e.onChanged(t)))}))()}onRenderInfoTooltip(e,t){var n;return null!=e&&null!==(n=e.content)&&void 0!==n&&n.length?(e.labelId=t,u.createElement(y.TooltipButton,e)):u.createElement(u.Fragment,null)}onRenderWrappedLabel(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"top",r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0,o=arguments.length>5?arguments[5]:void 0;if(!t)return u.createElement(u.Fragment,null);var l="".concat(e,"-info"),i=o?this.onRenderInfoTooltip(o,e):u.createElement(u.Fragment,null),s="",d="";switch(n){case"top":s=b.styles.propertyLabelTop,d="4px";break;case"right":d="0px",s=b.styles.propertyLabelSide}return u.createElement("div",{id:l,className:b.styles.propertyLabelContainer,style:{marginBottom:d}},u.createElement(c.Label,{id:"".concat(e,"-label"),styles:{root:[b.styles.propertyLabel+" "+s,{selectors:{":after":{paddingRight:"0px"}}}]},required:r,disabled:a},t),i)}onRenderLabel(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"top",r=arguments.length>3?arguments[3]:void 0;if(!t)return u.createElement(u.Fragment,null);var a="".concat(e,"-info"),o=r?this.onRenderInfoTooltip(r,e):u.createElement(u.Fragment,null),l="",i="";switch(n){case"top":l=b.styles.propertyLabelTop,i="4px";break;case"right":i="0px",l=b.styles.propertyLabelSide}return u.createElement("div",{id:a,className:b.styles.propertyLabelContainer,style:{marginBottom:i}},u.createElement("span",{id:"".concat(e,"-label"),className:"".concat(b.styles.propertyLabel," ").concat(l)},t),o)}}var L=Object(f.translateService)("PropertySheet")(x);function R(e){return I.apply(this,arguments)}function I(){return(I=E((function*(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(e.sections)for(var n of e.sections)if(n.properties)for(var r of n.properties){var a=yield D(r,t);if(a)return a}return""}))).apply(this,arguments)}function D(e,t,n){return V.apply(this,arguments)}function V(){return(V=E((function*(e,t,n){var r="",a=null==n?e.value:n;if(e.required&&(null==a||"string"==typeof a&&!a.trim())&&(r=t),e.validate){var o=yield e.validate(a);r=null!=o?o:r}return r}))).apply(this,arguments)}},12077:function(e,t,n){"use strict";n.r(t),n.d(t,"Pill",(function(){return p}));var r=n(4098),a=n(873),o=n(12078),l=n(245),i=n.n(l),s=n(12081),d=n(1259),c=Object(s.getStyles)();class p extends i.a.Component{constructor(e){super(e),this._menuButtonElement=i.a.createRef(),this.onRenderCallout=()=>i.a.createElement(o.ConfigurationCallout,{calloutProps:{hidden:!this.state.calloutOpen,target:this._menuButtonElement.current,onDismiss:()=>this.onDismiss()}},this.props.onRenderCalloutInnerContent(this.onDismiss,this.state.calloutConfirmationOpen,e=>{this.setState({calloutConfirmationOpen:e})},this.state.calloutIsDirty,e=>{this.setState({calloutIsDirty:e})})),this.onRenderPillButton=()=>{var{pillDisplayText:e}=this.props;return c=Object(s.getStyles)(this.state.calloutOpen,!0),i.a.createElement(i.a.Fragment,null,this.props.headerText&&i.a.createElement(d.Label,null,this.props.headerText),i.a.createElement(a.DefaultButton,{styles:c.editButtonStyles,onClick:()=>{this.onEditClicked()},text:e,title:e,ariaLabel:e},this.onRenderMenu()))},this.onEditClicked=()=>{this.setState({calloutOpen:!0})},this.onDeleteClicked=()=>{this.props.onDelete&&this.props.onDelete()},this.onRenderMenu=()=>{var{t:e}=this.props;return i.a.createElement(r.MoreButton,{itemsAriaLabel:"More",items:[{key:"edit",text:e("pillProperty.contextMenuStrings.edit"),iconProps:{iconName:"Edit"},onClick:()=>this.onEditClicked()},...this.props.onDelete?[{key:"delete",text:this.props.t("controls.controlConfigurer.lookupConfigurer.delete.text"),ariaLabel:this.props.t("controls.controlConfigurer.lookupConfigurer.delete.ariaLabel"),iconProps:{iconName:"Delete"},onClick:()=>this.onDeleteClicked()}]:[]],iconProps:{iconName:"MoreVertical"},styles:{root:{height:24,width:24,marginRight:3},flexContainer:{width:"100%"}}})},this.onDismiss=e=>{!e&&this.state.calloutIsDirty?this.setState({calloutConfirmationOpen:!0}):this.setState({calloutOpen:!1,calloutConfirmationOpen:!1,calloutIsDirty:!1})},this.state={calloutOpen:!1,calloutConfirmationOpen:!1,calloutIsDirty:!1}}render(){return i.a.createElement("div",{ref:this._menuButtonElement},this.onRenderCallout(),this.onRenderPillButton())}}},12081:function(e,t,n){"use strict";n.r(t),n.d(t,"getStyles",(function(){return o}));var r=n(719),a=Object(r.getTheme)(),o=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return{editButtonStyles:{root:{width:"100%",borderStyle:"solid",borderWidth:1,borderColor:e?a.palette.themePrimary:a.palette.neutralQuaternaryAlt,borderRadius:4,background:a.palette.white,padding:"0 0 0 8"},textContainer:{color:t?a.palette.themeSecondary:a.palette.neutralSecondary,lineHeight:20,textAlign:"left",overflow:"hidden",textOverflow:"ellipsis"},label:{display:"inline-block"}},iconStyles:{root:{fontSize:14,lineHeight:12,height:12,paddingLeft:0,marginLeft:0}}}}},12082:function(e,t,n){"use strict";n.r(t)}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/app-module-designer~c~999f4b8b.2176ac34.chunk.js.map