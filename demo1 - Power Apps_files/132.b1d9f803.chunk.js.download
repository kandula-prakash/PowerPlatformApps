(window.webpackJsonp=window.webpackJsonp||[]).push([[132],{5771:function(e,o,s){"use strict";s.r(o),s.d(o,"SolutionClonePanel",(function(){return m}));var i=s(4013),t=s(5160),n=s(2812),r=s(1697),l=s(1201),a=s(1429),u=s(245),h=s(5691),p=s(5772),c=s(2869);class m extends u.Component{constructor(e){var o;super(e),o=this,this.resources=void 0,this.cloneSolutionVersionNumberSuffix=".0.0",this.versionNumberSeperator=".",this.patchSolutionVersionNumberPrefix=void 0,this.onTextChangedDisplayName=function(e){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";o.setState({displayName:s})},this.onTextChangedMajorVersion=e=>{this.setState({isMajorVersionNumberIncorrect:void 0===e,majorVersion:e})},this.onTextChangedMinorVersion=e=>{this.setState({isMinorVersionNumberIncorrect:void 0===e,minorVersion:e})},this.onTextChangedBuildVersion=e=>{var o=Number(e.target.value)||this.state.buildVersion;o!==this.state.buildVersion&&this.setState({isBuildVersionNumberIncorrect:void 0===o,buildVersion:o})},this.onTextChangedRevisionVersion=e=>{var o=Number(e.target.value)||this.state.revisionVersion;o!==this.state.revisionVersion&&this.setState({isRevisionVersionNumberIncorrect:void 0===o,revisionVersion:o})},this.isVersionNumberFormatIncorrect=()=>this.state.isMajorVersionNumberIncorrect||this.state.isMinorVersionNumberIncorrect||this.state.isBuildVersionNumberIncorrect||this.state.isRevisionVersionNumberIncorrect,this.onDismiss=()=>{this.props.onPanelClose&&this.props.onPanelClose(),this.props.onDismiss(),this.props.clearCloneResponse()},this.onClosePanel=()=>{this.props.onPanelClose&&this.props.onPanelClose(),this.props.onDismiss()},this.resources=Object(c.getResources)(),this.state={hasBeenLoaded:!1,displayName:"",majorVersion:0,minorVersion:0,buildVersion:0,revisionVersion:0,isMajorVersionNumberIncorrect:!1,isMinorVersionNumberIncorrect:!1,isBuildVersionNumberIncorrect:!1,isRevisionVersionNumberIncorrect:!1}}render(){if(this.props.solution&&!this.state.hasBeenLoaded){this.patchSolutionVersionNumberPrefix=Number(this.props.solution.version.split(this.versionNumberSeperator)[0])+this.versionNumberSeperator+Number(this.props.solution.version.split(this.versionNumberSeperator)[1])+this.versionNumberSeperator;var e=this.getSolutionVersion().split(this.versionNumberSeperator);this.setState({hasBeenLoaded:!0,displayName:this.props.solution.friendlyName,majorVersion:Number(e[0]),minorVersion:void 0===e[1]?1:Number(e[1])+1,buildVersion:void 0===e[2]?1:Number(e[2])+1,revisionVersion:void 0===e[3]?0:Number(e[3]),isMajorVersionNumberIncorrect:!1,isMinorVersionNumberIncorrect:!1,isBuildVersionNumberIncorrect:!1,isRevisionVersionNumberIncorrect:!1})}var o,s,n;return this.state.hasBeenLoaded||(o={spinnerProps:{size:l.SpinnerSize.medium}}),this.props.cloneResponse.saving&&(o={spinnerProps:{size:l.SpinnerSize.medium,label:this.props.cloneType===h.SolutionsCloneType.CloneSolution?this.resources.Model.Solutions.CloneSolution.inProgress:this.resources.Model.Solutions.PatchSolution.inProgress}}),this.props.cloneResponse.failed&&this.props.cloneResponse.message&&(s={messageBarProps:{messageBarType:r.MessageBarType.error,dismissButtonAriaLabel:this.resources.Common.close},onRenderBody:()=>u.createElement(u.Fragment,null,this.props.cloneResponse.message)}),this.state.hasBeenLoaded&&(n=u.createElement("div",null,u.createElement("p",null,this.props.cloneType===h.SolutionsCloneType.Patch?this.resources.Model.Solutions.PatchSolution.Panel.subTitle:this.resources.Model.Solutions.CloneSolution.Panel.subTitle),u.createElement(a.TextField,{label:"".concat(this.resources.Model.Solutions.SolutionClone.Panel.Name,":"),disabled:!0,value:this.props.solution.uniqueName,styles:p.solutionCloneFields}),u.createElement(a.TextField,{label:"".concat(this.resources.Model.Solutions.Components.Header.displayName,":"),value:this.state.displayName,onChange:this.onTextChangedDisplayName,styles:p.solutionCloneFields}),u.createElement("span",null,this.resources.Model.Solutions.SolutionClone.Panel.versionNumber,":"),this.props.cloneType===h.SolutionsCloneType.CloneSolution&&u.createElement("div",null,u.createElement(t.NumberField,{textFieldProps:{ariaLabel:this.resources.Model.Solutions.SolutionClone.Panel.majorVersion,styles:p.solutionCloneTextStyles,maxLength:9},value:this.state.majorVersion,onBlurred:this.onTextChangedMajorVersion,formatValue:!1,maxPrecision:0}),u.createElement("span",{style:p.solutionCloneVersionSection},this.versionNumberSeperator),u.createElement(t.NumberField,{textFieldProps:{ariaLabel:this.resources.Model.Solutions.SolutionClone.Panel.minorVersion,styles:p.solutionCloneTextStyles,maxLength:9},onBlurred:this.onTextChangedMinorVersion,value:this.state.minorVersion,formatValue:!1,maxPrecision:0}),u.createElement("span",null,this.cloneSolutionVersionNumberSuffix)),this.props.cloneType===h.SolutionsCloneType.Patch&&u.createElement("div",null,u.createElement("span",null,this.patchSolutionVersionNumberPrefix),u.createElement(a.TextField,{value:this.state.buildVersion+"",styles:p.solutionCloneTextStyles,onChange:this.onTextChangedBuildVersion,ariaLabel:this.resources.Model.Solutions.SolutionClone.Panel.buildVersion}),u.createElement("span",{style:p.solutionCloneVersionSection},this.versionNumberSeperator),u.createElement(a.TextField,{value:this.state.revisionVersion+"",styles:p.solutionCloneTextStyles,onChange:this.onTextChangedRevisionVersion,ariaLabel:this.resources.Model.Solutions.SolutionClone.Panel.revisionVersion})),this.isVersionNumberFormatIncorrect()&&u.createElement("span",{style:p.solutionCloneVersionFormatError},this.resources.Model.Solutions.SolutionClone.versionNumberFormatErrorMessageText))),u.createElement(i.Panel,{headerText:this.props.cloneType===h.SolutionsCloneType.Patch?this.resources.Model.Solutions.PatchSolution.Panel.title:this.resources.Model.Solutions.CloneSolution.Panel.title,isLightDismiss:!0,onDismiss:this.onDismiss,closeButtonType:i.PanelCloseButtonType.Back,closeButtonAriaLabel:this.resources.Common.close,footerButtons:this.getFooterButtons(),isOpen:!0,loadingOverlay:o,messageBar:s},n)}componentDidUpdate(e){this.props.cloneResponse.success!==e.cloneResponse.success&&this.onClosePanel()}getFooterButtons(){return this.state.hasBeenLoaded?[{primary:!0,dismissableOnClick:()=>this.onSave(),ariaLabel:this.resources.Model.Solutions.SolutionClone.save,text:this.resources.Model.Solutions.SolutionClone.save,disabled:this.isVersionNumberFormatIncorrect()||this.props.cloneResponse.saving},{primary:!1,ariaLabel:this.resources.Common.close,text:this.resources.Common.close,disabled:this.props.cloneResponse.saving,dismissableOnClick:()=>this.onDismiss()}]:[]}onSave(){this.props.onSolutionCloneSaveClick({solution:{uniquename:this.props.solution.uniqueName,ismanaged:this.props.solution.isManaged,_parentsolutionid_value:this.props.solution.parentId},cloneType:this.props.cloneType,displayName:this.state.displayName,versionNumber:this.getVersionNumber()})}getVersionNumber(){return this.props.cloneType===h.SolutionsCloneType.CloneSolution?this.state.majorVersion+this.versionNumberSeperator+this.state.minorVersion+this.cloneSolutionVersionNumberSuffix:this.patchSolutionVersionNumberPrefix+this.state.buildVersion+this.versionNumberSeperator+this.state.revisionVersion}getSolutionVersion(){if(this.props.cloneType===h.SolutionsCloneType.Patch&&this.props.solutions.length>0&&!this.props.solution.parentId){var e=this.props.solutions.filter(e=>e.parentId===this.props.solution.id),o=Object(n.orderBy)(e,e=>e.createdOn,"desc");if(o.length>0)return o[0].version}return this.props.solution.version}}},5772:function(e,o,s){"use strict";s.r(o),s.d(o,"solutionCloneTextStyles",(function(){return t})),s.d(o,"solutionCloneFields",(function(){return n})),s.d(o,"solutionCloneVersionSection",(function(){return r})),s.d(o,"solutionCloneVersionFormatError",(function(){return l}));var i=s(2882),t={root:{display:"inline-block",width:30,marginTop:5,selectors:{input:{paddingLeft:5,paddingRight:5}}}},n={root:{paddingBottom:20}},r={display:"inline-block"},l={fontSize:"12px",fontWeight:400,color:i.fabricColors.brightRed,display:"flex",animationName:"css-0, css-13",animationFillMode:"both"}}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/132.b1d9f803.chunk.js.map