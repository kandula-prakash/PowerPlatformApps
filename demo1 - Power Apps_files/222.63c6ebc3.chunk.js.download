/*! For license information please see 222.63c6ebc3.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[222],{6430:function(e,n,t){"use strict";function i(e,n,t,i){return!e&&(o(n,i)||o(t,i))}function r(e,n,t,i,r){return!!e||!n&&(o(t,r)||o(i,r))}function a(e,n,t,i){return!e&&(o(n,i)||o(t,i))}function o(e,n){return!n||!(!e||n.includes(e))}t.r(n),t.d(n,"hasMismatchedConnectionForDataset",(function(){return i})),t.d(n,"hasMismatchedConnectionForTable",(function(){return r})),t.d(n,"hasInaccessibleEnvironment",(function(){return a}))},6715:function(e,n,t){"use strict";t.r(n),t.d(n,"_MultiEnvironmentVariablesPicker",(function(){return v})),t.d(n,"MultiEnvironmentVariablesPicker",(function(){return b}));var i=t(923),r=t(2903),a=t(245),o=t(6716),l=t(6717),s=t(6703),c=t(6377),u=t(3076),m=t(2698),d=t(1201),v=e=>{var{t:n,environmentVariableDefinitions:t,onUpdateEnvironmentVariableDefinitions:i,hideHeader:v}=e,b=Object(o.getMultiEnvironmentVariablesPickerClasses)(),{environmentClient:p}=a.useContext(u.ApolloClientContext),{datasets:f,refetch:E}=Object(c.useConnectionsWithDetailsQuery)(p,{},m.PortalScope,n("Common.request.failed"));return a.useEffect(()=>{(function(e,n){return e.some(e=>!(!Object(s.isPickerParentConnectorEnvironmentVariableDefinition)(e)||Object(s.isPickerParentConnectorEnvironmentVariableDefinition)(e)&&e.connection&&e.connection.name===e.connectionName)&&(!n||!n.find(n=>n.apiId===e.apiid&&n.name===e.connectionName)))})(t,f)&&E()},[t]),a.useEffect(()=>{!function(e,n,t){if(!n||!e)return;var i=!1,r=[...e],a=function(e){if(!Object(s.isPickerParentConnectorEnvironmentVariableDefinition)(e)||!e.connectionName||e.connection&&e.connection.name===e.connectionName)return"continue";var t=n.find(n=>{var t,i;return(null===(t=n.apiId)||void 0===t?void 0:t.toLowerCase())===(null===(i=e.apiid)||void 0===i?void 0:i.toLowerCase())&&n.name===e.connectionName});if(!t)return"continue";e.connection=t,i=!0};for(var o of r)a(o);i&&t(r)}(t,f,i)},[t,f,i]),t.some(e=>Object(s.isPickerParentConnectorEnvironmentVariableDefinition)(e)&&!e.connection)?a.createElement(d.Spinner,{size:d.SpinnerSize.medium}):a.createElement(a.Fragment,null,!v&&a.createElement("div",{className:b.contentContainer},a.createElement("span",{className:b.subHeaderText},n("MultiEnvironmentVariablesPicker.title")),a.createElement("span",{className:Object(r.css)(b.subHeaderContentsTextSmaller,b.regularText)},n("MultiEnvironmentVariablesPicker.content")),a.createElement("span",{className:Object(r.css)(b.updatedNeededText,b.regularText,b.boldText)},n("Common.updatesNeeded",{numberOfUpdates:(null==t?void 0:t.length)||0}))),a.createElement(l.EnvironmentVariablesContainer,{t:e.t,tReady:e.tReady,deferValidation:e.deferValidation,environmentVariableDefinitions:t,onUpdateEnvironmentVariableDefinitions:i}))},b=Object(i.translateService)("PowerAppsConnections")(v)},6716:function(e,n,t){"use strict";t.r(n),t.d(n,"getMultiEnvironmentVariablesPickerClasses",(function(){return o})),t.d(n,"getMultiEnvironmentVariablesPickerStyles",(function(){return l}));var i=t(3058),r=t(5932),a=t(719),o=()=>{var e=Object(a.getTheme)();return Object(a.mergeStyleSets)({regularText:{fontSize:12,fontFamily:r.fonts.segoeUi,lineHeight:16},boldText:{fontWeight:600},largerText:{fontFamily:r.fonts.segoeUi,fontSize:14,lineHeight:20},contentContainer:{paddingTop:"0 !important",marginTop:"16 !important",fontFamily:r.fonts.segoeUi,display:"grid"},subHeaderText:{fontSize:16,fontFamily:r.fonts.segoeUi,fontWeight:600,lineHeight:22},subHeaderContentsTextSmaller:{marginTop:4},updatedNeededText:{marginTop:24,marginBottom:16},environmentVariableWrapper:{paddingTop:16,paddingBottom:16,borderBottom:"1px solid ".concat(i.fabricColors.veryLightGrey)},environmentVariableContainer:{display:"flex",selectors:{".innerContainer":{display:"flex",width:"50%"},".innerContainerLeft":{paddingRight:8},".innerContainerRight":{paddingTop:30,paddingLeft:8,fontSize:"12px"}}},textboxLabel:{selectors:{".ms-Label":{color:null==e?void 0:e.palette.neutralPrimaryAlt}}},multipleDropdownsContainer:{display:"block",width:"100%"},childDropdownContainer:{marginBottom:8}})},l=()=>{var e=Object(a.getTheme)();return{environmentVariableInputStyles:{root:{width:"100%",paddingRight:8},subComponentStyles:{label:{lineHeight:20}},fieldGroup:{backgroundColor:null==e?void 0:e.palette.white,selectors:{"::after":{borderColor:null==e?void 0:e.semanticColors.inputBorderHovered}}},field:{color:null==e?void 0:e.palette.neutralPrimaryAlt}},environmentVariableDropdownStyles:{root:{width:"100%",paddingRight:8},dropdown:{selectors:{":focus":{borderColor:null==e?void 0:e.semanticColors.inputBorderHovered},":focus::after":{borderColor:null==e?void 0:e.semanticColors.inputBorderHovered},".ms-Dropdown-title":{color:"".concat(null==e?void 0:e.palette.neutralPrimaryAlt," !important")}}},subComponentStyles:{panel:{},label:{lineHeight:20},multiSelectItem:{}},label:{color:null==e?void 0:e.palette.neutralPrimaryAlt},dropdownItem:{backgroundColor:null==e?void 0:e.palette.white,color:null==e?void 0:e.semanticColors.menuItemText,selectors:{":focus":{backgroundColor:"".concat(null==e?void 0:e.semanticColors.menuItemBackgroundHovered," !important"),color:null==e?void 0:e.semanticColors.menuItemTextHovered},":hover":{backgroundColor:"".concat(null==e?void 0:e.semanticColors.menuItemBackgroundHovered," !important")}}},dropdownItemSelected:{backgroundColor:null==e?void 0:e.semanticColors.menuItemBackgroundPressed},title:{backgroundColor:null==e?void 0:e.palette.white},dropdownItemHeader:{backgroundColor:null==e?void 0:e.palette.white}},environmentVariableComboBoxStyles:{container:{width:"100%",paddingRight:"8px"},optionsContainerWrapper:{maxWidth:500,minWidth:100},input:{backgroundColor:null==e?void 0:e.palette.white},label:{backgroundColor:null==e?void 0:e.palette.white,color:null==e?void 0:e.palette.neutralPrimaryAlt,display:"block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",paddingBottom:"5px"}}}}},6717:function(e,n,t){"use strict";t.r(n),t.d(n,"EnvironmentVariablesContainer",(function(){return b}));var i=t(245),r=t(6718),a=t(6720),o=t(6703),l=t(6704),s=t(6705),c=t(6751);function u(){return(u=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)}function m(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function d(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?m(Object(t),!0).forEach((function(n){v(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):m(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function v(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}var b=e=>{var{environmentVariableDefinitions:n}=e;function t(t,i){var a=[...n],l=[];a.forEach(e=>{l.push(e),Object(o.isPickerParentConnectorEnvironmentVariableDefinition)(e)&&l.push(...e.childVariables)});var s=l.find(e=>e.schemaname===t.schemaname);if(s){var c=Object(r.isValidEnvironmentVariableValue)(s,i);s.hasError=!c,s.userSelectedValue=Object(r.setNewUserSelectedEnvironmentVariableValue)(s.currentValue,i),e.onUpdateEnvironmentVariableDefinitions(a)}}return i.createElement(i.Fragment,null,n.map(n=>{var r={t:e.t,tReady:e.tReady,deferValidation:e.deferValidation,onChangeEnvironmentVariableValue:t};if(Object(l.isPickerSharePointSiteEnvironmentVariableDefinition)(n)){var o=d(d({},r),{},{sharepointSiteEnvironmentVariableDefinition:n});return i.createElement(a.EnvironmentVariable,u({},o,{key:n.schemaname}))}if(Object(s.isPickerSQLServerEnvironmentVariableDefinition)(n)){var m=d(d({},r),{},{sqlServerEnvironmentVariableDefinition:n});return i.createElement(a.EnvironmentVariable,u({},m,{key:n.schemaname}))}if(Object(c.isPickerCDSEnvironmentVariableDefinition)(n)){var v=d(d({},r),{},{cdsEnvironmentVariableDefinition:n});return i.createElement(a.EnvironmentVariable,u({},v,{key:n.schemaname}))}var b=d(d({},r),{},{environmentVariableDefinition:n});return i.createElement(a.EnvironmentVariable,u({},b,{key:n.schemaname}))}))}},6718:function(e,n,t){"use strict";t.r(n),t.d(n,"isValidEnvironmentVariableValue",(function(){return s})),t.d(n,"validateEnvironmentVariableValue",(function(){return c})),t.d(n,"setNewUserSelectedEnvironmentVariableValue",(function(){return u})),t.d(n,"getSelectedValue",(function(){return m}));var i=t(2830),r=t(6719);function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){l(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function s(e,n){return!c(e,"mock","mock","mock",n)}function c(e,n,t,a,o){return!e.isrequired||void 0!==o&&""!==o?e.type===i.EnvironmentVariableDefinitionTypeEnum.Number&&o&&!/^-?(\d+\.?)?\d+$/.test(o)?t:Object(r.validateSecretEnvironmentVariableValue)(e,a,o):n}function u(e,n){return e?o(o({},e),{},{value:n}):n?{value:n}:e}function m(e){var n,t;return(null===(n=e.userSelectedValue)||void 0===n?void 0:n.value)||e.defaultvalue||(null===(t=e.currentValue)||void 0===t?void 0:t.value)}},6719:function(e,n,t){"use strict";t.r(n),t.d(n,"validateSecretEnvironmentVariableValue",(function(){return a}));var i=t(2830),r=t(6398);function a(e,n,t){if(e.type===i.EnvironmentVariableDefinitionTypeEnum.Secret&&e.secretstore===r.IEnvironmentVariableSecretStores.KeyVault&&t&&(a=t,!new RegExp("^/subscriptions/(.+)/resourcegroups/(.+)/providers/microsoft.keyvault/(.+)/secrets/(.+)$","i").test(a)))return n;var a}},6720:function(e,n,t){"use strict";t.r(n),t.d(n,"EnvironmentVariable",(function(){return v}));var i=t(2903),r=t(245),a=t(6716),o=t(6721),l=t(6722),s=t(6723),c=t(6724),u=t(6747),m=t(6748),d=t(2830),v=e=>{var n=Object(a.getMultiEnvironmentVariablesPickerClasses)();return Object(s.isSharePointEnvironmentVariableProps)(e)?r.createElement(c.SharepointConnectionEnvironmentVariableInput,e):Object(s.isSQLEnvironmentVariableProps)(e)?r.createElement(u.SQLConnectionEnvironmentVariableInput,e):Object(s.isCDSEnvironmentVariableProps)(e)?r.createElement(m.CDSConnectionEnvironmentVariableInput,e):r.createElement("div",{className:n.environmentVariableWrapper},r.createElement("div",{className:n.environmentVariableContainer},r.createElement("div",{className:Object(i.css)("innerContainer","innerContainerLeft")},function(e){if(Object(s.isSharePointEnvironmentVariableProps)(e)||Object(s.isSQLEnvironmentVariableProps)(e)||Object(s.isCDSEnvironmentVariableProps)(e))throw new Error("invalid environment variable");return e.environmentVariableDefinition.type===d.EnvironmentVariableDefinitionTypeEnum.Boolean?r.createElement(o.BooleanEnvironmentVariableInput,e):r.createElement(l.TextEnvironmentVariableInput,e)}(e)),r.createElement("div",{className:Object(i.css)("innerContainer","innerContainerRight")},r.createElement("div",{className:Object(i.css)(n.regularText)},function(e){if(Object(s.isSharePointEnvironmentVariableProps)(e)||Object(s.isSQLEnvironmentVariableProps)(e)||Object(s.isCDSEnvironmentVariableProps)(e))throw new Error("invalid environment variable");return e.environmentVariableDefinition.description}(e)))))}},6721:function(e,n,t){"use strict";t.r(n),t.d(n,"BooleanEnvironmentVariableInput",(function(){return s}));var i,r=t(1567),a=t(860),o=t(245),l=t(6716);!function(e){e.yes="yes",e.no="no"}(i||(i={}));var s=e=>{var{environmentVariableDefinition:n,onChangeEnvironmentVariableValue:t,t:s}=e,c=Object(l.getMultiEnvironmentVariablesPickerStyles)();return o.createElement(r.Dropdown,{label:n.displayname,title:n.displayname,required:n.isrequired,selectedKey:n.userSelectedValue&&n.userSelectedValue.value||n.defaultvalue,onChange:(e,i)=>{t(n,i&&i.key||"")},options:[{key:i.yes,text:s("MultiEnvironmentVariablesPicker.Boolean.yes")},{key:i.no,text:s("MultiEnvironmentVariablesPicker.Boolean.no")}],responsiveMode:a.ResponsiveMode.large,placeholder:s("MultiEnvironmentVariablesPicker.InputHints.selectABooleanOption"),styles:c.environmentVariableDropdownStyles})}},6722:function(e,n,t){"use strict";t.r(n),t.d(n,"TextEnvironmentVariableInput",(function(){return c}));var i=t(1429),r=t(245),a=t(6716),o=t(6718),l=t(2830),s=t(2903),c=e=>{var n,t,{environmentVariableDefinition:c,onChangeEnvironmentVariableValue:m,t:d,deferValidation:v}=e,b=Object(a.getMultiEnvironmentVariablesPickerStyles)(),p=Object(a.getMultiEnvironmentVariablesPickerClasses)();return r.createElement(i.TextField,{label:c.displayname,title:c.displayname,required:c.isrequired,value:null!==(n=(null===(t=c.userSelectedValue)||void 0===t?void 0:t.value)||c.defaultvalue)&&void 0!==n?n:"",onChange:(e,n)=>{m(c,n||"")},validateOnFocusOut:v,validateOnLoad:!v,onGetErrorMessage:e=>Object(o.validateEnvironmentVariableValue)(c,d("MultiEnvironmentVariablesPicker.isRequired"),d("MultiEnvironmentVariablesPicker.mustBeNumber"),d("MultiEnvironmentVariablesPicker.Secret.mustBeKeyVaultSecretReference"),e),className:Object(s.css)(p.textboxLabel),maxLength:2e3,multiline:c.type===l.EnvironmentVariableDefinitionTypeEnum.JSON,placeholder:u(c.type,d),styles:b.environmentVariableInputStyles})};function u(e,n){return e===l.EnvironmentVariableDefinitionTypeEnum.String?n("MultiEnvironmentVariablesPicker.InputHints.enterText"):e===l.EnvironmentVariableDefinitionTypeEnum.Number?n("MultiEnvironmentVariablesPicker.InputHints.enterDecimalNumber"):e===l.EnvironmentVariableDefinitionTypeEnum.JSON?n("MultiEnvironmentVariablesPicker.InputHints.enterJSON"):e===l.EnvironmentVariableDefinitionTypeEnum.Secret?n("MultiEnvironmentVariablesPicker.InputHints.Secret.enterKeyVaultSecretReference"):n("MultiEnvironmentVariablesPicker.InputHints.enterText")}},6723:function(e,n,t){"use strict";function i(e){return!!e.sharepointSiteEnvironmentVariableDefinition}function r(e){return!!e.sqlServerEnvironmentVariableDefinition}function a(e){return!!e.cdsEnvironmentVariableDefinition}t.r(n),t.d(n,"isSharePointEnvironmentVariableProps",(function(){return i})),t.d(n,"isSQLEnvironmentVariableProps",(function(){return r})),t.d(n,"isCDSEnvironmentVariableProps",(function(){return a}))},6724:function(e,n,t){"use strict";t.r(n),t.d(n,"SharepointConnectionEnvironmentVariableInput",(function(){return E}));var i=t(245),r=t(6716),a=t(6424),o=t(2698),l=t(3144),s=t(6426),c=t(1201),u=t(6430),m=t(1447),d=t(6718),v=t(2903),b=t(6725),p=t(3192),f=t(6726),E=e=>{var n,t,E,V,{sharepointSiteEnvironmentVariableDefinition:y,onChangeEnvironmentVariableValue:g,t:h}=e,C=Object(r.getMultiEnvironmentVariablesPickerStyles)(),{environmentClient:O}=i.useContext(l.ApolloClientContext),{datasets:S,loading:j,errorMessage:P}=Object(a.useDatasetsQuery)(O,{primaryRuntimeUrl:y.connection.primaryRuntimeUrl||"",connectionName:y.connection.name},o.PortalScope,h("Common.request.failed")),D=S?S.map(e=>{var n=Object(f.getFriendlyDatasetDisplayName)(e.displayName);return{key:e.id,text:n||e.id}}):[],k=Object(u.hasMismatchedConnectionForDataset)(P,null===(n=y.currentValue)||void 0===n?void 0:n.value,y.defaultvalue,D.map(e=>e.key)),x=Object(d.getSelectedValue)(y);k?V=h("MultiEnvironmentVariablesPicker.InputHints.SharePoint.connectionMismatchForSite"):y.preventUpdates||(V=Object(p.hasStatusCode)(P,[401,403,404])?h("MultiEnvironmentVariablesPicker.InputHints.SharePoint.sitesNotFoundError",{detailedError:P}):P);var w,{tables:M,errorMessage:N,loading:I,hasConnectionMismatch:T}=Object(s.useTablesQuery)(O,{primaryRuntimeUrl:y.connection.primaryRuntimeUrl||"",connectionName:y.connection.name,datasetUrl:x||"",fetchAllTables:!0},o.PortalScope,h("Common.request.failed")),U=!N&&M?M.map(e=>({key:e.id,text:e.displayName})):[];return j?w=i.createElement(c.Spinner,{label:h("MultiEnvironmentVariablesPicker.InputHints.SharePoint.loadingSites")}):null!==(t=y.childVariables)&&void 0!==t&&t.length&&I&&(w=i.createElement(c.Spinner,{label:h("MultiEnvironmentVariablesPicker.InputHints.SharePoint.loadingLists")})),i.createElement("div",{className:Object(r.getMultiEnvironmentVariablesPickerClasses)().environmentVariableWrapper},w&&i.createElement("div",{style:{display:"flex",justifyContent:"flex-start"}},w),!w&&i.createElement(i.Fragment,null,i.createElement("div",{className:Object(r.getMultiEnvironmentVariablesPickerClasses)().environmentVariableContainer},i.createElement("div",{className:Object(v.css)("innerContainer","innerContainerLeft")},i.createElement(m.ComboBox,{allowFreeform:!0,autoComplete:"on",label:y.displayname,title:y.displayname,text:(null===(E=D.find(e=>e.key===x))||void 0===E?void 0:E.text)||x,onChange:(e,n,t,i)=>{var r=(null==n?void 0:n.key)||i||"";g(y,r)},options:D,disabled:y.preventUpdates,placeholder:h("MultiEnvironmentVariablesPicker.InputHints.SharePoint.selectSite"),styles:C.environmentVariableComboBoxStyles,errorMessage:V})),i.createElement("div",{className:Object(v.css)("innerContainer","innerContainerRight"),style:{display:"block"}},i.createElement(b.DatasourceDescription,{connection:y.connection,definition:y}))),y.childVariables.map(e=>{var n,t,a=Object(u.hasMismatchedConnectionForTable)(T,N,null===(n=e.currentValue)||void 0===n?void 0:n.value,e.defaultvalue,U.map(e=>e.key)),o=N;a&&(o=h("MultiEnvironmentVariablesPicker.InputHints.SharePoint.connectionMismatchForList"));var l=Object(d.getSelectedValue)(e);return i.createElement("div",{key:"".concat(e.schemaname,"-container"),className:Object(r.getMultiEnvironmentVariablesPickerClasses)().environmentVariableContainer},i.createElement("div",{className:Object(v.css)("innerContainer","innerContainerLeft")},i.createElement(m.ComboBox,{allowFreeform:!0,autoComplete:"on",key:e.schemaname,label:e.displayname,title:e.displayname,text:(null===(t=U.find(e=>e.key===l))||void 0===t?void 0:t.text)||l,onChange:(n,t,i,r)=>{var a=(null==t?void 0:t.key)||r||"";g(e,a)},options:U,placeholder:h("MultiEnvironmentVariablesPicker.InputHints.SharePoint.selectList"),styles:C.environmentVariableComboBoxStyles,errorMessage:o})),i.createElement("div",{className:Object(v.css)("innerContainer","innerContainerRight"),style:{display:"block"}},i.createElement(b.DatasourceDescription,{connection:y.connection,definition:e})))})))}},6725:function(e,n,t){"use strict";t.r(n),t.d(n,"DatasourceDescription",(function(){return a}));var i=t(245),r=t(687);function a(e){var{connection:n,definition:t}=e;return n&&t?i.createElement(i.Fragment,null,i.createElement("div",{style:{display:"inline-flex",width:"100%"}},i.createElement("div",null,i.createElement(r.Icon,{title:n.apiDisplayName,ariaLabel:n.apiDisplayName,imageProps:{src:n.iconUri,alt:n.apiDisplayName,styles:{image:{width:"32px",height:"32px"}}}})),i.createElement("div",{style:{paddingLeft:"10px",display:"grid"}},i.createElement("div",{style:{textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",fontWeight:"bold"},title:n.apiDisplayName},n.apiDisplayName),i.createElement("div",{style:{textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"},title:t.schemaname},t.schemaname))),i.createElement("div",{style:{paddingTop:"10px"}},t.description)):i.createElement(i.Fragment,null)}},6747:function(e,n,t){"use strict";t.r(n),t.d(n,"SQLConnectionEnvironmentVariableInput",(function(){return E}));var i=t(245),r=t(6716),a=t(6424),o=t(2698),l=t(3144),s=t(6426),c=t(1201),u=t(6430),m=t(1447),d=t(6718),v=t(2903),b=t(6725),p=t(3192),f=t(6726),E=e=>{var n,t,E,V,{sqlServerEnvironmentVariableDefinition:y,onChangeEnvironmentVariableValue:g,t:h}=e,C=Object(r.getMultiEnvironmentVariablesPickerStyles)(),{environmentClient:O}=i.useContext(l.ApolloClientContext),{datasets:S,loading:j,errorMessage:P}=Object(a.useDatasetsQuery)(O,{primaryRuntimeUrl:y.connection.primaryRuntimeUrl||"",connectionName:y.connection.name},o.PortalScope,h("Common.request.failed")),D=S?S.map(e=>{var n=Object(f.getFriendlyDatasetDisplayName)(e.displayName);return{key:e.id,text:n||e.id}}):[],k=Object(u.hasMismatchedConnectionForDataset)(P,null===(n=y.currentValue)||void 0===n?void 0:n.value,y.defaultvalue,D.map(e=>e.key)),x=Object(d.getSelectedValue)(y);k?V=h("MultiEnvironmentVariablesPicker.InputHints.SQL.connectionMismatchForServer"):y.preventUpdates||(V=Object(p.hasStatusCode)(P,[401,403,404])?h("MultiEnvironmentVariablesPicker.InputHints.SQL.serversNotFoundError",{detailedError:P}):P);var w,{tables:M,errorMessage:N,loading:I,hasConnectionMismatch:T}=Object(s.useTablesQuery)(O,{primaryRuntimeUrl:y.connection.primaryRuntimeUrl||"",connectionName:y.connection.name,datasetUrl:x||""},o.PortalScope,h("Common.request.failed")),U=!N&&M?M.map(e=>({key:e.id,text:e.displayName})):[];return j?w=i.createElement(c.Spinner,{label:h("MultiEnvironmentVariablesPicker.InputHints.SQL.loadingServers")}):null!==(t=y.childVariables)&&void 0!==t&&t.length&&I&&(w=i.createElement(c.Spinner,{label:h("MultiEnvironmentVariablesPicker.InputHints.SQL.loadingDatabases")})),i.createElement("div",{className:Object(r.getMultiEnvironmentVariablesPickerClasses)().environmentVariableWrapper},w&&i.createElement("div",{style:{display:"flex",justifyContent:"flex-start"}},w),!w&&i.createElement(i.Fragment,null,i.createElement("div",{className:Object(r.getMultiEnvironmentVariablesPickerClasses)().environmentVariableContainer},i.createElement("div",{className:Object(v.css)("innerContainer","innerContainerLeft")},i.createElement(m.ComboBox,{allowFreeform:!0,autoComplete:"on",label:y.displayname,title:y.displayname,text:(null===(E=D.find(e=>e.key===x))||void 0===E?void 0:E.text)||x,onChange:(e,n,t,i)=>{var r=(null==n?void 0:n.key)||i||"";g(y,r)},options:D,disabled:y.preventUpdates,placeholder:h("MultiEnvironmentVariablesPicker.InputHints.SQL.selectServer"),styles:C.environmentVariableComboBoxStyles,errorMessage:V})),i.createElement("div",{className:Object(v.css)("innerContainer","innerContainerRight"),style:{display:"block"}},i.createElement(b.DatasourceDescription,{connection:y.connection,definition:y}))),y.childVariables.map(e=>{var n,t,a=Object(u.hasMismatchedConnectionForTable)(T,N,null===(n=e.currentValue)||void 0===n?void 0:n.value,e.defaultvalue,U.map(e=>e.key)),o=N;a&&(o=h("MultiEnvironmentVariablesPicker.InputHints.SQL.connectionMismatchForDatabase"));var l=Object(d.getSelectedValue)(e);return i.createElement("div",{key:"".concat(e.schemaname,"-container"),className:Object(r.getMultiEnvironmentVariablesPickerClasses)().environmentVariableContainer},i.createElement("div",{className:Object(v.css)("innerContainer","innerContainerLeft")},i.createElement(m.ComboBox,{allowFreeform:!0,autoComplete:"on",key:e.schemaname,label:e.displayname,title:e.displayname,text:(null===(t=U.find(e=>e.key===l))||void 0===t?void 0:t.text)||l,onChange:(n,t,i,r)=>{var a=(null==t?void 0:t.key)||r||"";g(e,a)},options:U,placeholder:h("MultiEnvironmentVariablesPicker.InputHints.SQL.selectDatabase"),styles:C.environmentVariableComboBoxStyles,errorMessage:o})),i.createElement("div",{className:Object(v.css)("innerContainer","innerContainerRight"),style:{display:"block"}},i.createElement(b.DatasourceDescription,{connection:y.connection,definition:e})))})))}},6748:function(e,n,t){"use strict";t.r(n),t.d(n,"CDSConnectionEnvironmentVariableInput",(function(){return V}));var i=t(245),r=t(6716),a=t(1201),o=t(1083),l=t(1447),s=t(6435),c=t(3144),u=t(2698),m=t(6718),d=t(6430),v=t(6749),b=t(2903),p=t(6725),f=t(1105),E=t(3713),V=e=>{var n,t,V,y,{cdsEnvironmentVariableDefinition:g,onChangeEnvironmentVariableValue:h,t:C}=e,O=Object(r.getMultiEnvironmentVariablesPickerStyles)(),S=Object(m.getSelectedValue)(g),{currentEnvironment:j}=i.useContext(f.EnvironmentContext),{environmentClient:P}=i.useContext(c.ApolloClientContext),D=Object(E.getUXContext)(null==j||null===(n=j.properties)||void 0===n?void 0:n.environmentSku),k=Object(E.isCDSLiteUXContext)(D),{loading:x,api:w,errorMessage:M}=Object(v.useApiQuery)(P,{apiId:g.apiid},u.PortalScope,C("Common.request.failed")),{loading:N,errorMessage:I,environments:T}=Object(s.useGetAvailableEnvironments)(P,u.PortalScope,C("Common.request.failed")),U=(T||[]).filter(e=>!Object(o.isEnvironmentInDeletedState)(e)&&e.orgUrl),H=U?U.map(e=>({key:e.orgUrl,text:e.displayName||e.orgUrl})):[],A=Object(d.hasInaccessibleEnvironment)(I,null===(t=g.currentValue)||void 0===t?void 0:t.value,g.defaultvalue,H.map(e=>e.key)),L=(null===(V=H.find(e=>e.key===S))||void 0===V?void 0:V.text)||S,F=C(k?"MultiEnvironmentVariablesPicker.InputHints.CDS.dataverse":"MultiEnvironmentVariablesPicker.InputHints.CDS.cds");N?y=i.createElement(a.Spinner,{label:C("MultiEnvironmentVariablesPicker.InputHints.CDS.loadingEnvironments",{productName:F})}):x&&(y=i.createElement(a.Spinner,{label:C("MultiEnvironmentVariablesPicker.InputHints.CDS.loadingMetadata",{productName:F})}));var R=I;return A&&(R=C("MultiEnvironmentVariablesPicker.InputHints.CDS.inaccessibleEnvironment")),i.createElement("div",{className:Object(r.getMultiEnvironmentVariablesPickerClasses)().environmentVariableWrapper},y&&i.createElement("div",{style:{display:"flex",justifyContent:"flex-start"}},y),!y&&i.createElement(i.Fragment,null,i.createElement("div",{className:Object(r.getMultiEnvironmentVariablesPickerClasses)().environmentVariableContainer},i.createElement("div",{className:Object(b.css)("innerContainer","innerContainerLeft")},i.createElement(l.ComboBox,{allowFreeform:!0,autoComplete:"on",label:g.displayname,title:g.displayname,text:L,onChange:(e,n,t,i)=>{var r=(null==n?void 0:n.key)||i||"";h(g,r)},options:H||[],placeholder:C("MultiEnvironmentVariablesPicker.InputHints.CDS.selectEnvironment",{productName:F}),styles:O.environmentVariableComboBoxStyles,errorMessage:R})),i.createElement("div",{className:Object(b.css)("innerContainer","innerContainerRight"),style:{display:"block"}},!M&&i.createElement(p.DatasourceDescription,{connection:w,definition:{schemaname:g.schemaname,description:g.description}}),M&&g.description))))}},6749:function(e,n,t){"use strict";t.r(n),t.d(n,"useApiQuery",(function(){return c}));var i=t(3152),r=t(217),a=t(245),o=t(3192),l=t(3193),s=t(6750);function c(e,n,t,c){var u=arguments.length>4&&void 0!==arguments[4]&&arguments[4],m=l.TelemetryScenarioNames.apiGetGraphQl,[d,v]=Object(a.useState)(),[b,p]=Object(a.useState)(""),{loading:f,data:E,error:V}=Object(i.useQuery)(s.ApiQuery,{skip:u,client:e||void 0,onCompleted:e=>{d&&d.complete()},onError:e=>{var n=e.message,t=Object(o.getResponseMessageFromApolloError)(e,c);p(t),d&&d.failure({error:t,clientError:n})},variables:n});return Object(a.useEffect)(()=>{f&&v(Object(r.trackLoadScenario)(t,m))},[f]),{loading:f,errorMessage:V&&b,api:E&&E.api}}},6750:function(e,n,t){"use strict";t.r(n),t.d(n,"ApiQuery",(function(){return s})),t.d(n,"ApiSwaggerQuery",(function(){return c}));var i,r,a=t(3128),o=t.n(a);function l(e,n){return n||(n=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(n)}}))}var s=o()(i||(i=l(["\n  query Api($apiId: String!) {\n    api(apiId: $apiId) {\n      id\n      name\n      primaryRuntimeUrl\n      iconUri\n      apiDisplayName\n    }\n  }\n"]))),c=o()(r||(r=l(["\n  query ApiSwagger($apiId: String!) {\n    apiSwagger(apiId: $apiId) {\n      id\n      name\n      primaryRuntimeUrl\n      iconUri\n      apiDisplayName\n      swagger {\n        host\n        basePath\n        schemes\n        paths {\n          path\n          methods\n        }\n      }\n    }\n  }\n"])))},6751:function(e,n,t){"use strict";t.r(n),t.d(n,"isPickerCDSEnvironmentVariableDefinition",(function(){return a}));var i=t(6703),r=t(6752);function a(e){return Object(i.isPickerConnectorEnvironmentVariableDefinition)(e)&&Object(r.hasCDSApiId)(e)}},6752:function(e,n,t){"use strict";t.r(n),t.d(n,"isCDSEnvironmentVariableDefinition",(function(){return r})),t.d(n,"hasCDSApiId",(function(){return a}));var i=t(6398);function r(e){return Object(i.isDataSourceEnvironmentVariableDefinition)(e)&&a(e)}function a(e){return Object(i.isCDSApiId)(e.apiid)}},6753:function(e,n,t){"use strict";t.r(n),t.d(n,"areAllEnvironmentVariablesValid",(function(){return u})),t.d(n,"convertEnvironmentVariablesToUserSelection",(function(){return m}));var i=t(6398),r=t(6400),a=t(6402),o=t(6752);function l(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function s(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?l(Object(t),!0).forEach((function(n){c(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):l(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function c(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function u(e){return!(e||[]).some(e=>e.hasError)}function m(e,n,t,l,c){var u=new Map;e.filter(e=>Object(i.isDataSourceChildEnvironmentVariableDefinition)(e)).forEach(e=>{var t=e,i=t._parentdefinitionid_value,r=u.get(i);r||(r=[]),v(s(s(s({},t),d(e,n)),{},{parentdefinition:i,parentdefinitionid:i}),r,l,c)&&u.set(i,r)});var m=[];return e.filter(e=>!Object(i.isDataSourceChildEnvironmentVariableDefinition)(e)).forEach(e=>{if(Object(a.isSQLServerEnvironmentVariableDefinition)(e)||Object(r.isSharePointSiteEnvironmentVariableDefinition)(e)){var t=u.get(e.environmentvariabledefinitionid)||u.get(e.schemaname)||[],i=s(s(s({},e),d(e,n)),{},{childVariables:t,connectionName:void 0,connection:void 0});v(i,m,l,c)&&i.childVariables.length&&u.delete(t[0].parentdefinition||t[0].parentdefinitionid)}else if(Object(o.isCDSEnvironmentVariableDefinition)(e)){v(s(s({},e),d(e,n)),m,l,c)}else{v(s(s({},e),d(e,n)),m,l,c)}}),u.forEach((e,i)=>{if(null!=e&&e.length){var r=null==t?void 0:t.find(e=>i===e.environmentvariabledefinitionid||i===e.schemaname);if(r){var a=s(s(s({},r),d(r,n)),{},{childVariables:e,connectionName:void 0,connection:void 0,preventUpdates:!0});m.push(a)}}}),m}function d(e,n){var t=e.schemaname||"",i=!!t&&!!n&&n[t];return{currentValue:i||void 0,userSelectedValue:i||void 0,hasError:!1}}function v(e,n,t,i){return!(t&&!t(e))&&(n.push(s(s({},e),{},{preventUpdates:!!i&&i(e)})),!0)}},6754:function(e,n,t){"use strict";t.r(n),t.d(n,"getEnvironmentVariableDefinitionsFromExistingSolution",(function(){return V})),t.d(n,"getEnvironmentVariableDefinitionsToBeUpdatedByUser",(function(){return y})),t.d(n,"getEnvironmentVariableDefinitionsToBeUpdatedByUserFromComponents",(function(){return g})),t.d(n,"getEnvironmentVariableValuesForDefinitions",(function(){return O})),t.d(n,"getExistingEnvironmentVariableValuesAndDefinitions",(function(){return j}));var i=t(6702),r=t(2812),a=t.n(r),o=t(6703),l=t(6718),s=t(6398),c=t(2830),u=t(6753);function m(e,n,t,i,r,a,o){try{var l=e[a](o),s=l.value}catch(c){return void t(c)}l.done?n(s):Promise.resolve(s).then(i,r)}function d(e){return function(){var n=this,t=arguments;return new Promise((function(i,r){var a=e.apply(n,t);function o(e){m(a,i,r,o,l,"next",e)}function l(e){m(a,i,r,o,l,"throw",e)}o(void 0)}))}}function v(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function b(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?v(Object(t),!0).forEach((function(n){p(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):v(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function p(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function f(e){var n=parseInt(e.Attributes.get("type")||"",10),t={displayname:e.Attributes.get("displayname"),schemaname:e.Attributes.get("schemaname"),description:e.Attributes.get("description"),type:n,defaultvalue:e.Attributes.get("defaultvalue")||void 0,isrequired:"true"===e.Attributes.get("isrequired")};return n===c.EnvironmentVariableDefinitionTypeEnum.ConnectionReference?b(b({},t),{},{apiid:e.Attributes.get("apiid"),parameterkey:e.Attributes.get("parameterkey"),_parentdefinitionid_value:e.Attributes.get("parentdefinition")||e.Attributes.get("parentdefinitionid")}):t}function E(e){var n;return Object(l.isValidEnvironmentVariableValue)(e,(null===(n=e.currentValue)||void 0===n?void 0:n.value)||e.defaultvalue)}function V(e){var n;if(e&&e.SolutionComponentsDetails){var t=e.SolutionComponentsDetails.filter(n=>{var t=e.ExistingEnvironmentVariableValues[n.Attributes.get("schemaname")||""];return Object(i.isEnvironmentVariableDefinition)(n)&&null!=t}).map(e=>f(e));(n=Object(u.convertEnvironmentVariablesToUserSelection)(t,e.ExistingEnvironmentVariableValues,[],(function(n){var t=n.schemaname||"",i=!!t&&!!e.ExistingEnvironmentVariableValues&&e.ExistingEnvironmentVariableValues[t];return null!=i}))).forEach(e=>{e.hasError=!E(e)})}return n}function y(e,n){return g(null==e?void 0:e.SolutionComponentsDetails,null==e?void 0:e.ExistingEnvironmentVariableValues,n)}function g(e,n,t,r){if(e){var a=e.filter(e=>Object(i.isEnvironmentVariableDefinition)(e)).map(e=>f(e)),l={};function s(e,t){var i=void 0===e.defaultvalue||r,a=void 0===e.currentValue,o=!!i&&a,l=!1,s=e.schemaname||"";if(s&&n){var c=n[s];l=null!=c}return o&&!l||t}e.filter(e=>Object(i.isEnvironmentVariableValue)(e)).forEach(e=>{var n=e.Attributes.get("schemaname")||"";n&&(l[n]={value:e.Attributes.get("value")||"",environmentvariablevalueid:e.Attributes.get("environmentvariablevalueid")||""})});var c=Object(u.convertEnvironmentVariablesToUserSelection)(a,l,t,(function(e){var n;return s(e,Object(o.isPickerParentConnectorEnvironmentVariableDefinition)(e)&&!(null===(n=e.childVariables)||void 0===n||!n.length))}),(function(e){var n,t=Object(o.isPickerParentConnectorEnvironmentVariableDefinition)(e)&&!(null===(n=e.childVariables)||void 0===n||!n.length);return!s(e,!1)&&t}));return null==c||c.forEach(e=>{e.hasError=!E(e)}),c}return[]}function h(e){return C.apply(this,arguments)}function C(){return(C=d((function*(e){var n=yield e.fetchList("EnvironmentVariableDefinition",void 0);if(!n)return null;for(var t=n.data;n.hasNext&&(yield n.next());)t=t.concat(n.data);return t}))).apply(this,arguments)}function O(e,n){return S.apply(this,arguments)}function S(){return(S=d((function*(e,n){var t=yield e.fetchList("EnvironmentVariableValue",void 0,{columns:["_environmentvariabledefinitionid_value","value","environmentvariablevalueid"]});if(!t)return{};for(var i=t.data;t.hasNext&&(yield t.next());)i=i.concat(t.data);var r={},a=function(e){var n,t=null===(n=i)||void 0===n?void 0:n.find(n=>n._environmentvariabledefinitionid_value===e.environmentvariabledefinitionid);t&&(r[e.schemaname]={value:t.value,environmentvariablevalueid:t.environmentvariablevalueid})};for(var o of n||[])a(o);return r}))).apply(this,arguments)}function j(e,n){return P.apply(this,arguments)}function P(){return(P=d((function*(e,n){if(!e.SolutionDetails.PreviousSolutionUniqueName)return{existingEnvironmentVariableValuesFromStagingResponse:{},existingEnvironmentVariableDefinitions:[]};var t=e.SolutionComponentsDetails.filter(i.isEnvironmentVariableDefinition);if(a.a.isEmpty(t))return{existingEnvironmentVariableValuesFromStagingResponse:{},existingEnvironmentVariableDefinitions:[]};var r=(yield h(n))||[],o=r.filter(e=>t.findIndex(n=>e.schemaname===n.Attributes.get("schemaname")||"")>-1),l=[];r.forEach(e=>{Object(s.isDataSourceEnvironmentVariableDefinition)(e)&&l.push(e)});var c=yield O(n,o);return{existingEnvironmentVariableDefinitions:l,existingEnvironmentVariableValuesFromStagingResponse:c}}))).apply(this,arguments)}}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/222.63c6ebc3.chunk.js.map