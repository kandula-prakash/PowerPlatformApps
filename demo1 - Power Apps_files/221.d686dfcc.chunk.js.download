/*! For license information please see 221.d686dfcc.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[221],{6377:function(e,t,n){"use strict";n.r(t),n.d(t,"useConnectionsWithDetailsQuery",(function(){return p}));var o=n(3152),r=n(217),i=n(245),a=n(5916),s=n(3192),l=n(3193),c=n(6378);function d(e,t,n,o,r,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(o,r)}function u(e){return function(){var t=this,n=arguments;return new Promise((function(o,r){var i=e.apply(t,n);function a(e){d(i,o,r,a,s,"next",e)}function s(e){d(i,o,r,a,s,"throw",e)}a(void 0)}))}}function p(e,t,n,d){var p,m=arguments.length>4&&void 0!==arguments[4]&&arguments[4],f=arguments.length>5&&void 0!==arguments[5]&&arguments[5],b=l.TelemetryScenarioNames.connectionsWithDetailsGraphQl,[g,h]=Object(i.useState)(),[v,S]=Object(i.useState)(""),{loading:y,data:O,error:C,refetch:w}=Object(o.useQuery)(c.ConnectionsWithDetailsQuery,{skip:m,fetchPolicy:"no-cache",notifyOnNetworkStatusChange:!0,client:e||void 0,onCompleted:e=>{S(""),g&&g.complete({apiId:t&&t.apiId,count:e&&e.rpConnectionsWithApiDetails&&e.rpConnectionsWithApiDetails.length})},onError:e=>{var t=Object(s.getResponseMessageFromApolloError)(e,d.unknownErrorType);S(Object(a.parseMessageFromError)(t,d)),g&&g.failure({error:t,clientError:e&&e.message})},variables:t});return Object(i.useEffect)(()=>{f&&w&&w(t)},[f]),Object(i.useEffect)(()=>{y&&(S(""),h(Object(r.trackLoadScenario)(n,b)))},[y]),{loading:y,errorMessage:C&&v,datasets:O&&O.rpConnectionsWithApiDetails,refetch:(p=u((function*(){yield w(t)})),function(){return p.apply(this,arguments)})}}},6699:function(e,t,n){"use strict";n.r(t),n.d(t,"featureGates",(function(){return r}));var o=n(250),r=Object(o.createFeatureGatesConfig)({packageName:"powerappsConnections",features:{enableFirstPartyCreateConnection:{owner:"aleyepez",description:"Enables first party create connection",createdDate:"4/17/2020",enabledFor:{}},enableInlineConnectionCreation:{owner:"mirestom",description:"Enables creating connections without having to navigate outside of the widget.",createdDate:"10/29/2020",enabledFor:{test:!1}}}})},6726:function(e,t,n){"use strict";n.r(t),n.d(t,"getConnectionSpecificFields",(function(){return b})),n.d(t,"getConnectionsTypeName",(function(){return g})),n.d(t,"getPreviewDescription",(function(){return h})),n.d(t,"getDatasetQueryVariables",(function(){return v})),n.d(t,"getTablesQueryVariables",(function(){return S})),n.d(t,"connectionHasError",(function(){return y})),n.d(t,"getPrimaryRuntimeUrl",(function(){return O})),n.d(t,"getConnectionName",(function(){return C})),n.d(t,"getAppFromDataUri",(function(){return w})),n.d(t,"createAppFromData",(function(){return j})),n.d(t,"createAppFromDataWithoutConnectionSelection",(function(){return E})),n.d(t,"createSharepointAFDUrl",(function(){return x})),n.d(t,"createSqlServerAFDUrl",(function(){return P})),n.d(t,"getConnectionDetails",(function(){return D})),n.d(t,"getConnectionDetailsUrl",(function(){return N})),n.d(t,"isOauthConnection",(function(){return k})),n.d(t,"getFriendlyDatasetDisplayName",(function(){return L}));var o,r,i,a=n(1195),s=n(3790),l=n(6727),c=n(6737),d=n(3788);function u(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){f(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function b(e,t,n,o,r,i,a,d,u){switch(e){case s.ConnectionType.SharePoint:return Object(l.SharePointConnectionSelectionFields)({t:r,connections:n,firstConnection:t,connectionsLoading:o,fieldsRef:i,setIsFormComplete:a,connectionHasError:d});case s.ConnectionType.SqlServer:return Object(c.SqlServerConnectionSelectionFields)({t:r,firstConnection:t,connections:n,connectionsLoading:o,fieldsRef:i,setIsFormComplete:a,connectionHasError:d,createConnection:u});default:return Object(l.SharePointConnectionSelectionFields)({t:r,connections:n,firstConnection:t,connectionsLoading:o,fieldsRef:i,setIsFormComplete:a,connectionHasError:d})}}function g(e,t){switch(e){case s.ConnectionType.SharePoint:return t("SharePoint.sharepointName");case s.ConnectionType.SqlServer:return t("SqlServer.sqlServerName");default:return t("SharePoint.sharepointName")}}function h(e,t){if(t)switch(e){case s.ConnectionType.SharePoint:return"SharePoint.descriptionForResponsiveAFD";case s.ConnectionType.SqlServer:return"SqlServer.descriptionForResponsiveAFD";default:return"SharePoint.descriptionForResponsiveAFD"}else switch(e){case s.ConnectionType.SharePoint:return"SharePoint.description";case s.ConnectionType.SqlServer:return"SqlServer.description";default:return"SharePoint.description"}}function v(e,t,n){var o={primaryRuntimeUrl:e,connectionName:t};return n===s.ConnectionType.SqlServer?m(m({},o),{},{isV2:!0}):o}function S(e,t,n,o){var r={primaryRuntimeUrl:e,connectionName:t,datasetUrl:n};return o===s.ConnectionType.SqlServer?m(m({},r),{},{isV2:!0}):r}function y(e){return!!e&&(e.isAuthError||e.isInError)}function O(e){return e&&e.primaryRuntimeUrl?e.primaryRuntimeUrl:""}function C(e){return e&&e.name?e.name:""}function w(e,t,n,o,r){if(!n)return"";var i=!!t&&!!t.current&&t.current.getAttribute("data-formValues")||"";switch(e){case s.ConnectionType.SharePoint:return x(i,n,o,r);case s.ConnectionType.SqlServer:return P(i,n,o);default:return""}}function j(e,t,n,o,r,i,a){if(o){var s=w(e,n,o,r,i);s&&(a?a(s):window.open(s,"_blank")),t&&t()}}function E(e,t,n,r,i){if(e){var l=function(e,t,n){if(!e)return"";var r=t===s.ConnectionType.SharePoint?Object(d.getApiIdBasedOnConnectionType)(t):"showallapis";return Object(a.URI)(o||(o=u(["/e/","/canvas/?","&",""])),e.name,{action:"new-data","connector-type":r},n?{"form-factor":"tablet"}:void 0)}(e,t,n);window.open(l,"_blank"),r&&r()}}function x(e,t,n,o){if(!e)return"";var i=JSON.parse(e);return i&&i.site&&i.list&&i.appName?Object(a.URI)(r||(r=u(["/e/","/canvas/?","&","&",""])),t.name,{action:"sp-new-data","site-id":i.site.key.toString(),"list-id":i.list.key,name:i.appName},n?{"form-factor":"tablet"}:void 0,o?{"solution-id":o}:void 0):""}function P(e,t,n){if(!e)return"";var o=JSON.parse(e);return o&&o.connectionName&&o.connectionName.data&&o.connectionName.data.details&&o.connectionName.data.details.name&&o.site&&o.list&&o.appName?Object(a.URI)(i||(i=u(["/e/","/canvas/?","&",""])),t.name,{action:"sql-new-data","connection-name":o.connectionName.data.details.name,"sql-dataset-name":o.site.key.toString(),"table-id":o.list.key.toString(),name:o.appName},n?{"form-factor":"tablet"}:void 0):""}function D(e,t,n){var o=N(e,t);window.open(o,"_blank"),n&&n()}function N(e,t){var n=Object(d.getApiIdBasedOnConnectionType)(e),o=n.substring(n.lastIndexOf("/")+1);return e===s.ConnectionType.SharePoint&&t?"".concat("connections","/").concat(o,"/").concat(t,"/details"):"connections"}function k(e){return e&&e.data&&e.data.details&&e.data.details.connectionParameter&&"oauth"===e.data.details.connectionParameter.name||void 0}function L(e){if(!e)return e;var t=e.lastIndexOf(" - ");return-1===t?e:e.substring(0,t).trim()}},6727:function(e,t,n){"use strict";n.r(t),n.d(t,"SharePointConnectionSelectionFields",(function(){return S})),n.d(t,"renderList",(function(){return C})),n.d(t,"getRefreshButton",(function(){return w})),n.d(t,"renderEmptyList",(function(){return j})),n.d(t,"dropdownStyle",(function(){return E}));var o=n(684),r=n(1755),i=n(1429),a=n(245),s=n(3058),l=n(6728),c=n(6730),d=n(3161),u=n(6733),p=n(3790),m=n(6734),f=n(6735),b=n(6736);function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){v(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var S=e=>{var{t:t,connections:n,firstConnection:o,connectionsLoading:r,fieldsRef:s,setIsFormComplete:l,connectionHasError:d}=e,{formValues:b,fieldOptions:g,setFormValues:v,setRefreshSites:S,setRefreshLists:C,datasetsLoading:w,tablesLoading:j,datasetsError:E,tablesError:x,tablesNormalizedUrl:P}=Object(c.useSharePointConnectionBehavior)(o,n,t,l,d),D=!!g&&!!g.connections&&g.connections.length>0;return r?a.createElement("div",null,y("LabelShimmerRow1"),O("InputBoxShimmerRow1"),y("LabelShimmerRow2"),O("InputBoxShimmerRow2"),y("LabelShimmerRow3"),O("InputBoxShimmerRow3")):a.createElement("div",{ref:s,"data-formvalues":JSON.stringify(b),id:"sharepointConnectionsForm"},a.createElement(i.TextField,{id:"appNameTextField",label:t("Common.appName"),placeholder:t("Common.appNamePlaceholder"),required:!0,defaultValue:t("Common.appNamePlaceholder"),onChange:(e,t)=>{Object(u.trackConnectionModalEvent)(u.ScenarioNames.AppNameEdit,p.ConnectionType.SharePoint),v(h(h({},b),{},{appName:t||""}))},disabled:!D||d,value:b.appName}),a.createElement(m.SharepointSitesDropdown,{formValues:b,isDisabled:!D||d||!b.connectionName,isLoading:w,setFormValues:v,setRefreshLists:C,setRefreshSites:S,siteOptions:g.sites,tablesNormalizedUrl:P,error:E}),a.createElement(f.SharepointListsDropdown,{formValues:b,isDisabled:!D||d||!b.connectionName||!b.site,isLoading:j,setFormValues:v,setRefreshLists:C,listOptions:g.lists,error:x}))},y=e=>a.createElement(r.Shimmer,{width:350,shimmerElements:[{type:r.ShimmerElementType.line,width:50,height:12}],key:"shimmerDiv".concat(e)}),O=e=>a.createElement(r.Shimmer,{styles:{root:b.sharePointConnectionStyles.elementGroupWrapperInput},width:350,customElementsGroup:[a.createElement("div",{className:b.sharePointConnectionStyles.elementGroupWrapper,key:"shimmerDiv".concat(e)},a.createElement(r.ShimmerElementsGroup,{shimmerElements:[{type:r.ShimmerElementType.line,width:30,height:30},{type:r.ShimmerElementType.gap,width:10,height:30}]}),a.createElement(r.ShimmerElementsGroup,{flexWrap:!0,shimmerElements:[{type:r.ShimmerElementType.line,width:120,height:10}]}))]}),C=(e,t,n,o,r,i,s,c,d)=>e&&e.options&&e.onChange&&e.componentRef?a.createElement(l.LookupDropdown,{items:e.options,onItemClick:e.onChange,componentRef:e.componentRef,showCustomInput:!0,onCustomInputPressEnter:r,componentStrings:{customInputString:n,searchBoxString:o},itemsLoading:t,onRenderEmptyList:s,refreshButtonProps:c,customInputError:i,shouldFilterItem:(e,t)=>(d&&Object(u.trackConnectionModalEvent)(d,p.ConnectionType.SharePoint),((e,t)=>{var n,o;if(!t)return!0;var r=!!t&&-1===(null===(n=e.text)||void 0===n?void 0:n.toLowerCase().indexOf(t.toLowerCase())),i=!!t&&-1===(null===(o=e.key)||void 0===o?void 0:o.toString().toLowerCase().indexOf(t.toLowerCase()));return!r||!i})(e,t))}):a.createElement(a.Fragment,null),w=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3?arguments[3]:void 0;return a.createElement(o.IconButton,{styles:{root:{marginRight:"8px"}},iconProps:{iconName:"Refresh"},onClick:()=>{t&&t(!0),r&&Object(u.trackConnectionModalButtonClick)(r,p.ConnectionType.SharePoint)},ariaLabel:e,title:e,disabled:n})},j=(e,t)=>a.createElement(d.EmptyState,{primaryMessage:e,secondaryMessage:t,styles:{root:{position:"absolute",maxWidth:"350px !important",height:"82px",margin:"39px 31px"},primaryMessage:{fontWeight:600,fontSize:"18px",lineHeight:"24px",textAlign:"center",color:s.fabricColors.neutralTuatara},secondaryMessage:{fontSize:"14px",lineHeight:"20px",textAlign:"center"}}}),E=e=>({callout:{selectors:{".ms-Callout-main":{height:1===e?"160px":2===e?"210px":"264px"}}}})},6728:function(e,t,n){"use strict";n.r(t),n.d(t,"LookupDropdown",(function(){return m})),n.d(t,"SimpleDropdown",(function(){return f})),n.d(t,"CustomHeaderDropdown",(function(){return b})),n.d(t,"onRenderCell",(function(){return g})),n.d(t,"defaultShouldFilterItem",(function(){return S}));var o=n(684),r=n(687),i=n(1277),a=n(1459),s=n(1429),l=n(1755),c=n(245),d=n.n(c),u=n(6729),p=n(5122),m=e=>{var[t,n]=d.a.useState(!1),o=[{key:"defaultView",text:"defaultView",iconName:"list",onRenderView:t=>e.itemsLoading?d.a.createElement("div",{className:u.lookupDropdownClassNames.renderViewDiv},v("1"),v("2"),v("3")):0===t.length&&e.onRenderEmptyList?e.onRenderEmptyList:d.a.createElement(a.List,{items:t,onRenderCell:t=>g(t,e.onItemClick,e.componentRef),className:u.lookupDropdownClassNames.listDiv})}];return d.a.createElement("div",null,e.showCustomInput&&h(t,n,e.componentStrings.customInputString,e.onCustomInputPressEnter,e.customInputError),d.a.createElement("hr",{className:u.lookupDropdownClassNames.dropdownSeparator}),d.a.createElement("div",{className:u.lookupDropdownClassNames.filterSearchViewWrapper},d.a.createElement(p.FilterSearchViews,{strings:{searchBoxPlaceholder:e.componentStrings.searchBoxString,allItemsFilterItemText:"All"},items:e.items,shouldFilterItem:e.shouldFilterItem||S,refreshButtonProps:e.refreshButtonProps,views:o,styles:{root:{flex:1},filterSearchBox:{marginLeft:"8px",marginRight:"8px",marginTop:"8px"}}})))},f=e=>d.a.createElement(a.List,{items:e.items,onRenderCell:t=>g(t,e.onItemClick,e.componentRef)}),b=e=>{var{onRenderCustomOnTop:t}=e;return t?d.a.createElement(d.a.Fragment,null,t(),d.a.createElement("hr",{className:u.lookupDropdownClassNames.dropdownSeparator}),f(e)):f(e)},g=(e,t,n)=>{var r=e.text;return e.data.subtitle&&(r="".concat(r," - ").concat(e.data.subtitle)),d.a.createElement(o.DefaultButton,{title:r,className:u.lookupDropdownClassNames.itemCell,"data-is-focusable":!0,onClick:o=>{t(o,e),n&&n.current&&n.current._onDismiss()},tabIndex:0},!!e.data&&d.a.createElement(i.Image,{className:u.lookupDropdownClassNames.itemImage,src:e.data.iconUri,width:40,height:40,alt:e.data.iconTitle}),d.a.createElement("div",{className:u.lookupDropdownClassNames.itemContent},d.a.createElement("div",{className:u.lookupDropdownClassNames.itemTitle},e.text),d.a.createElement("div",{className:u.lookupDropdownClassNames.itemSubtitle},e.data.subtitle)))},h=(e,t,n,i,a)=>d.a.createElement("div",null,e?d.a.createElement("div",{className:u.lookupDropdownClassNames.customInputWrapper},d.a.createElement(s.TextField,{placeholder:n,onKeyDown:e=>{i&&13===e.keyCode&&(e.preventDefault(),i(e))},errorMessage:a,autoFocus:!0,title:n})):d.a.createElement("div",{className:u.lookupDropdownClassNames.customInputButtonWrapper,role:"option"},d.a.createElement(o.DefaultButton,{onClick:()=>t(!0),className:u.lookupDropdownClassNames.showInputButton},d.a.createElement(r.Icon,{iconName:"Add",className:u.lookupDropdownClassNames.addIcon}),n))),v=e=>d.a.createElement(l.Shimmer,{styles:{root:{padding:"8px"}},width:350,customElementsGroup:[d.a.createElement("div",{className:u.lookupDropdownClassNames.loadingShimmerElementsWrapper,key:"shimmerDiv".concat(e)},d.a.createElement(l.ShimmerElementsGroup,{shimmerElements:[{type:l.ShimmerElementType.line,width:40,height:40},{type:l.ShimmerElementType.gap,width:10,height:40}]}),d.a.createElement(l.ShimmerElementsGroup,{flexWrap:!0,shimmerElements:[{type:l.ShimmerElementType.line,width:85,height:10},{type:l.ShimmerElementType.gap,width:215,height:20},{type:l.ShimmerElementType.line,width:215,height:10},{type:l.ShimmerElementType.gap,width:85,height:10}]}))]}),S=(e,t,n)=>!t||-1!==e.text.toLowerCase().indexOf(t.toLowerCase())},6729:function(e,t,n){"use strict";n.r(t),n.d(t,"lookupDropdownClassNames",(function(){return a}));var o=n(719),r=n(3058),i=Object(o.getTheme)(),a=Object(o.mergeStyleSets)({itemCell:[Object(o.getFocusStyle)(i,{inset:-1}),{minHeight:56,boxSizing:"border-box",display:"flex",border:"none",backgroundColor:"transparent",textAlign:"left",width:"100%",selectors:{span:{maxWidth:"375px"}}}],itemImage:{flexShrink:0,borderRadius:"3px"},itemContent:{marginLeft:10,overflow:"hidden",flexGrow:1},itemTitle:{fontSize:"14px",lineHeight:"19px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},itemSubtitle:{fontSize:"12px",lineHeight:"21px",color:r.fabricColors.neutralChicago,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},renderViewDiv:{position:"absolute"},listDiv:{position:"absolute",width:"100%"},dropdownSeparator:{backgroundColor:r.fabricColors.neutralTertiaryAlt,border:0,height:"1px"},filterSearchViewWrapper:{display:"flex",flexWrap:"wrap"},customInputWrapper:{margin:"8px 38px 0px 8px",paddingBottom:"8px",paddingRight:"8px"},customInputButtonWrapper:{display:"flex",marginLeft:"8px",marginBottom:"8px",selectors:{button:{padding:"0px 8px"}}},showInputButton:{border:"none",backgroundColor:"transparent",lineHeight:"19px",marginTop:"8px"},addIcon:{paddingRight:"8px",verticalAlign:"middle",color:r.fabricColors.neutralPlum,lineHeight:"16px"},loadingShimmerElementsWrapper:{display:"flex"}})},6730:function(e,t,n){"use strict";n.r(t),n.d(t,"useSharePointConnectionBehavior",(function(){return b})),n.d(t,"getSelectedConnection",(function(){return g}));var o=n(245),r=n.n(o),i=n(6424),a=n(6426),s=n(6731),l=n(3076),c=n(2698),d=n(6726),u=n(2813),p=n(2811);function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function b(e,t,n,o,b){var h,v,S,[y,O]=r.a.useState({appName:"".concat(n("SharePoint.sharepointName")," ").concat(n("Common.appNamePlaceholder"))}),[C,w]=r.a.useState(!1),[j,E]=r.a.useState(!1),{environmentClient:x}=r.a.useContext(l.ApolloClientContext),P=g(C,y,t),D=Object(d.getPrimaryRuntimeUrl)(P),N=Object(d.getConnectionName)(P),{datasets:k,loading:L,errorMessage:T}=Object(i.useDatasetsQuery)(x,{primaryRuntimeUrl:D,connectionName:N},c.PortalScope,n("Common.request.failed"),b),R=t?t.map(e=>(v||(v=e.iconUri,S=e.apiDisplayName),{key:e.id,text:e.displayName,data:{iconUri:v,subtitle:S,iconTitle:S,details:e}})):[],F={connections:[],sites:[],lists:[]};F.connections.push(...R);var I,q=k?k.map(e=>{var t=Object(d.getFriendlyDatasetDisplayName)(e.displayName);return{key:e.id,text:t||e.id,data:{iconUri:v,subtitle:e.id,iconTitle:S}}}):[];F.sites.push(...q),y.site&&y.site.data&&y.site.data.isCustom?(I=j?void 0:y.site)&&(I.data.iconTitle=S,I.data.iconUri=v,I.data.subtitle=I.key):I=function(e,t,n){var o,r=t.site&&(null===(o=t.site.key)||void 0===o?void 0:o.toString().toLowerCase());return e||!r?void 0:n.find(e=>e.key.toString().toLowerCase()===r)}(j,y,q);var M=I&&I.key?I.key.toString():"",{tables:B,errorMessage:U,loading:A,normalizedUrl:W}=Object(a.useTablesQuery)(x,{primaryRuntimeUrl:D,connectionName:N,datasetUrl:M},c.PortalScope,n("Common.request.failed"),b);r.a.useEffect(()=>{W&&y.site&&y.site.data&&y.site.data.isCustom&&(I=y.site)&&(I.key=W,I.text=W,I.data.subtitle=W)},[W]);var V=!U&&B?B.map(e=>({key:e.id,text:e.displayName,data:{iconUri:v,iconTitle:S}})):[];F.lists.push(...V);var z,H=(null===(h=y.list)||void 0===h?void 0:h.data.isCustom)&&y.list,{tableDetails:G,loading:Q,errorMessage:_}=Object(s.useTableDetailsQuery)(x,{primaryRuntimeUrl:D,connectionName:N,datasetUrl:M,tableName:H&&H.text},c.PortalScope,n("Common.request.failed"),b),J=function(e,t,n,o){if(null!=e&&e.data.isCustom&&void 0===t.list)return n;return o||void 0}(I,y,U,T),K=function(e,t,n){var o;if(null!==(o=e.list)&&void 0!==o&&o.data.isCustom)return t;return n||void 0}(y,_,U);if(function(e,t,n,o,r,i,a,s){var l;null==e||null===(l=e.data)||void 0===l||!l.isCustom||void 0!==t&&!s||n||((a||s)&&(e.data.isInvalid=!1,o.sites.unshift(e)),void 0===i.list&&!r&&void 0===t&&e.data.forceDismiss&&e.data.forceDismiss())}(I,J,L,F,A,y,!!B,W),function(e,t,n,o){var r;return!t&&(null==e||null===(r=e.list)||void 0===r?void 0:r.data.isCustom)&&void 0===o&&!n}(y,j,Q,K)&&G){var X,Y,Z,$,ee=null===(X=G.authorLookupEndpointUri)||void 0===X?void 0:X.split("/",3);if(ee)ee=null===($=G.editorLookupEndpointUri)||void 0===$?void 0:$.split("/",3);z={key:3===(null===(Y=ee)||void 0===Y?void 0:Y.length)?ee[2]:"",text:G.displayName,data:{iconUri:v,iconTitle:S,isCustom:!0,isInvalid:!1,forceDismiss:null===(Z=y.list)||void 0===Z?void 0:Z.data.forceDismiss}},F.lists.unshift(z),function(e,t,n){return!e&&void 0===n&&(null==t?void 0:t.data.forceDismiss)}(Q,z,K)&&z.data.forceDismiss()}r.a.useEffect(()=>{var t,n,r,i,a=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){f(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},y);(null==R?void 0:R.length)>0&&(!y.connectionName||(null==e?void 0:e.id)!==(null==y||null===(t=y.connectionName)||void 0===t||null===(n=t.data)||void 0===n||null===(r=n.details)||void 0===r?void 0:r.id))?a.connectionName=e&&R.find(t=>t.key===e.id)||R[0]:!y.site&&q.length>0?a.site=q[0]:!y.list&&V.length>0?a.list=V[0]:z&&null!==(i=y.list)&&void 0!==i&&i.data.isCustom&&y.list.key!==z.key&&(a.list=z),y.connectionName===a.connectionName&&y.site===a.site&&y.list===a.list||O(a),!b&&!J&&!K&&a&&a.appName&&a.connectionName&&a.list&&a.site?o(!0):o(!1)}),r.a.useEffect(()=>{C&&w(!1),j&&E(!1)},[C,j]);var te=[Object(u.toLoadingState)(void 0!==k,T,"DatasetsQuery",!b),Object(u.toLoadingState)(void 0!==B,U,"DataTablesQuery",!b)];return Object(p.useLoadProgressTelemetry)("SharepointData",te),{formValues:y,setFormValues:O,fieldOptions:F,setRefreshSites:w,setRefreshLists:E,datasetsLoading:L||C,tablesLoading:A||j,datasetsError:J,tablesError:K,tablesNormalizedUrl:W}}function g(e,t,n){var o=t.connectionName&&t.connectionName.key.toString().toLowerCase();return e||!o?void 0:n.find(e=>e.id.toString().toLowerCase()===o)}},6733:function(e,t,n){"use strict";n.r(t),n.d(t,"ScenarioNames",(function(){return o})),n.d(t,"trackConnectionModalButtonClick",(function(){return l})),n.d(t,"trackConnectionModalLinkClick",(function(){return c})),n.d(t,"trackConnectionModalEvent",(function(){return d})),n.d(t,"trackConnectionHasError",(function(){return u}));var o,r=n(2698);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(e){e.OpenConnectionModal="ConnectionsModal/OpenConnectionModal",e.ConnectionHasError="ConnectionsModal/ConnectionHasError",e.NoConnectionsFound="ConnectionsModal/NoConnectionsFound",e.OnPremConnectionFound="ConnectionsModal/OnPremConnectionFound",e.AppNameEdit="ConnectionsModal/AppNameEdit",e.DatasetSelect="ConnectionsModal/DatasetSelect",e.TableSelect="ConnectionsModal/TableSelect",e.RefreshDatasetButton="ConnectionsModal/RefreshDatasetButton",e.RefreshTablesButton="ConnectionsModal/RefreshTablesButton",e.CanvasAppButtonClick="ConnectionsModal/CanvasAppButtonClick",e.LearnMoreLinkClick="ConnectionsModal/LearnMoreLinkClick",e.AdvancedSettingsLinkClick="ConnectionsModal/AdvancedSettingsLinkClick",e.UserDismissedModal="ConnectionsModal/UserDismissedModal",e.CreateAppButtonClick="ConnectionsModal/CreateAppButtonClick",e.FixConnectionButtonClick="ConnectionsModal/FixConnectionButtonClick",e.CreateConnectionButtonClick="ConnectionsModal/CreateConnectionButtonClick",e.NotSupportedConnectionStudioButtonClick="ConnectionsModal/NotSupportedConnectionStudioButtonClick",e.NotSupportedConnectionCreateButtonClick="ConnectionsModal/NotSupportedConnectionCreateButtonClick",e.FilterDatasetResults="ConnectionsModal/FilterDatasetResults",e.FilterTableResults="ConnectionsModal/FilterTableResults",e.ConnectionSelect="ConnectionsModal/ConnectionSelect",e.SqlServerNameEdit="ConnectionsModal/SqlServerNameEdit",e.SqlDatabaseNameEdit="ConnectionsModal/SqlDatabaseNameEdit"}(o||(o={}));var l=(e,t)=>{Object(r.trackUserActionClickButton)(e,{connectionType:t})},c=(e,t,n)=>{Object(r.trackUserActionClickLink)(e,a({connectionType:t},n))},d=(e,t,n)=>{Object(r.trackInfoTrace)(e,a({connectionType:t},n))},u=(e,t)=>{Object(r.trackInfoTrace)(o.ConnectionHasError,{connectionType:e,error:t})}},6734:function(e,t,n){"use strict";n.r(t),n.d(t,"SharepointSitesDropdown",(function(){return p}));var o=n(1567),r=n(245),i=n(6733),a=n(3790),s=n(6727),l=n(923);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var p=Object(l.translateService)("PowerAppsConnections")(e=>{var t,n,l=r.useRef(null),{t:c,isDisabled:u,siteOptions:p,isLoading:m,formValues:f,error:b,setFormValues:g,setRefreshSites:h,setRefreshLists:v,tablesNormalizedUrl:S}=e,y=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3?arguments[3]:void 0;n&&e&&e.target&&(t={key:e.target.value,text:e.target.value,data:{isInvalid:!0,isCustom:n,forceDismiss:o}},h(!0)),g(d(d({},f),{},{site:t,list:void 0})),v(!0)},O=e=>{var t;y(e,void 0,!0,null===(t=l.current)||void 0===t?void 0:t._onDismiss),Object(i.trackConnectionModalEvent)(i.ScenarioNames.DatasetSelect,a.ConnectionType.SharePoint,{customInput:!0})},C=Object(s.getRefreshButton)(c("Common.refreshButtonTitle"),h,m,i.ScenarioNames.RefreshDatasetButton),w=Object(s.renderEmptyList)(c("SharePoint.emptySitesListPrimaryMessage"),c("SharePoint.emptySitesListSecondaryMessage"));return r.createElement(o.Dropdown,{id:"sitesDropdown",label:c("SharePoint.siteLabel"),placeholder:c("SharePoint.sitePlaceholder"),options:p,required:!0,responsiveMode:2,disabled:u,selectedKey:!(null!==(t=f.site)&&void 0!==t&&t.data.isInvalid)&&(null===(n=f.site)||void 0===n?void 0:n.key)||"",onChange:(e,t)=>{y(e,t,!1),Object(i.trackConnectionModalEvent)(i.ScenarioNames.DatasetSelect,a.ConnectionType.SharePoint)},styles:Object(s.dropdownStyle)(p.length),onRenderList:e=>Object(s.renderList)(e||{},m,c("SharePoint.siteListInputPlaceholder"),c("SharePoint.siteListSearchPlaceholder"),O,!!b&&!S&&c("SharePoint.siteNotFound")||"",w,C,i.ScenarioNames.FilterDatasetResults),componentRef:l})})},6735:function(e,t,n){"use strict";n.r(t),n.d(t,"SharepointListsDropdown",(function(){return p}));var o=n(1567),r=n(245),i=n(6733),a=n(3790),s=n(6727),l=n(923);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var p=Object(l.translateService)("PowerAppsConnections")(e=>{var t,n,l=r.useRef(null),{t:c,isDisabled:u,listOptions:p,isLoading:m,formValues:f,error:b,setFormValues:g,setRefreshLists:h}=e,v=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3?arguments[3]:void 0;n&&e&&e.target&&(t={key:e.target.value,text:e.target.value,data:{isInvalid:!0,isCustom:n,forceDismiss:o}}),g(d(d({},f),{},{list:t}))},S=e=>{var t;v(e,void 0,!0,null===(t=l.current)||void 0===t?void 0:t._onDismiss),Object(i.trackConnectionModalEvent)(i.ScenarioNames.TableSelect,a.ConnectionType.SharePoint,{customInput:!0})},y=Object(s.getRefreshButton)(c("Common.refreshButtonTitle"),h,m,i.ScenarioNames.RefreshTablesButton),O=Object(s.renderEmptyList)(c("SharePoint.emptyListsListPrimaryMessage"),c("SharePoint.emptyListsListSecondaryMessage"));return r.createElement(o.Dropdown,{id:"listsDropdown",label:c("SharePoint.listsLabel"),placeholder:c("SharePoint.listsPlaceholder"),options:p,required:!0,disabled:u,responsiveMode:2,selectedKey:!(null!==(t=f.list)&&void 0!==t&&t.data.isInvalid)&&(null===(n=f.list)||void 0===n?void 0:n.key)||"",onChange:(e,t)=>{v(e,t,!1),Object(i.trackConnectionModalEvent)(i.ScenarioNames.TableSelect,a.ConnectionType.SharePoint)},styles:Object(s.dropdownStyle)(p.length),onRenderList:e=>Object(s.renderList)(e||{},m,c("SharePoint.listsListInputPlaceholder"),c("SharePoint.listsListSearchPlaceholder"),S,!!b&&c("SharePoint.listNotFound")||"",O,y,i.ScenarioNames.FilterTableResults),componentRef:l})})},6736:function(e,t,n){"use strict";n.r(t),n.d(t,"sharePointConnectionStyles",(function(){return r}));var o=n(719),r=Object(o.mergeStyleSets)({elementGroupWrapperInput:{paddingTop:"10px",paddingBottom:"20px"},elementGroupWrapper:{display:"flex"}})},6737:function(e,t,n){"use strict";n.r(t),n.d(t,"SqlServerConnectionSelectionFields",(function(){return b}));var o=n(1429),r=n(245),i=n(6738),a=n(6733),s=n(3790),l=n(6741),c=n(6744),d=n(6745),u=n(6746);function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){f(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var b=e=>{var{t:t,firstConnection:n,connections:p,connectionsLoading:f,fieldsRef:b,setIsFormComplete:g,connectionHasError:h}=e,v=Object(i.useConnectionBehavior)(n,p,g,h,"".concat(t("SqlServer.sqlServerName")," ").concat(t("Common.appNamePlaceholder")),t("Common.request.failed"),s.ConnectionType.SqlServer),{formValues:S,fieldOptions:y,setFormValues:O}=v,C=!!y&&!!y.connections&&y.connections.length>0;if(f)return Object(l.getShimmerRows)();var w=m(m({},e),v);return r.createElement("div",{ref:b,"data-formvalues":JSON.stringify(S),id:"SqlServerConnectionsForm"},r.createElement(o.TextField,{id:"appNameTextField",label:t("Common.appName"),placeholder:t("Common.appNamePlaceholder"),required:!0,defaultValue:t("Common.appNamePlaceholder"),onChange:(e,t)=>{Object(a.trackConnectionModalEvent)(a.ScenarioNames.AppNameEdit,s.ConnectionType.SqlServer),O(m(m({},S),{},{appName:t||""}))},disabled:!C||h,value:S.appName}),r.createElement(c.SqlServerConnectionsDropdown,w),r.createElement(u.SqlServerDataset,w),r.createElement(d.SqlServerTableDropdown,w))}},6738:function(e,t,n){"use strict";n.r(t),n.d(t,"useConnectionBehavior",(function(){return p}));var o=n(245),r=n.n(o),i=n(3076),a=n(2811),s=n(6739),l=n(3790),c=n(6726);function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p(e,t,n,o,p,m,f){var[b,g]=r.a.useState({appName:p}),[h,v]=r.a.useState(!1),[S,y]=r.a.useState(!1),{environmentClient:O}=r.a.useContext(i.ApolloClientContext),C=function(e,t,n){var o=t.connectionName&&t.connectionName.key.toString().toLowerCase();return e||!o?void 0:n.find(e=>e.id.toString().toLowerCase()===o)}(h,b,t),w=Object(c.getPrimaryRuntimeUrl)(C),j=Object(c.getConnectionName)(C),E=Object(s.usePrepareVariables)(t,m,o,b,S,O,f,w,j);return r.a.useEffect(()=>function(e,t,n){t&&e.site&&e.site.data&&e.site.data.isCustom&&(n=e.site)&&(n.key=t,n.text=t,n.data.subtitle=t)}(b,E.tablesNormalizedUrl,E.currentSelectedSiteDropdownOption),[E.tablesNormalizedUrl]),r.a.useEffect(()=>function(e,t,n,o,r,i,a,s){var l,c=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e);(null==t?void 0:t.length)>0&&!e.connectionName?c.connectionName=t[0]:!e.site&&o.length>0?c.site=o[0]:!e.list&&r.length>0?c.list=r[0]:i&&null!==(l=e.list)&&void 0!==l&&l.data.isCustom&&e.list.key!==i.key&&(c.list=i);e.connectionName===c.connectionName&&e.site===c.site&&e.list===c.list||a(c);c&&c.appName&&c.connectionName&&c.list&&c.site?s(!0):s(!1)}(b,E.connectionOptions,0,E.siteOptions,E.listsOptions,E.customListOption,g,n)),r.a.useEffect(()=>{h&&v(!1),S&&y(!1)},[h,S]),Object(a.useLoadProgressTelemetry)(f===l.ConnectionType.SqlServer?"SqlServerData":"SharepointData",E.loadProgress),{formValues:b,setFormValues:g,fieldOptions:E.dropdownFormFields,setRefreshSites:v,setRefreshLists:y,datasetsLoading:E.datasetsQueryLoading||h,tablesLoading:E.tablesQueryLoading||S,datasetsError:E.datasetsError,tablesError:E.tablesError,tablesNormalizedUrl:E.tablesNormalizedUrl}}},6739:function(e,t,n){"use strict";n.r(t),n.d(t,"usePrepareVariables",(function(){return u}));var o=n(6424),r=n(6426),i=n(6731),a=n(2698),s=n(2813),l=n(3790),c=n(6726),d=n(6740);function u(e,t,n,u,p,m,f,b,g){var h,v,S,y="",O="";e&&e.length>0&&(y=e[0].iconUri||"",O=e[0].apiDisplayName||"");var C=function(e){var t,n;e&&e.length>0&&(t=e[0].iconUri,n=e[0].apiDisplayName);return e?e.map(e=>({key:e.id,text:e.displayName,data:{iconUri:t,subtitle:n,iconTitle:n,details:e}})):[]}(e),w={connections:[],sites:[],lists:[]};w.connections.push(...C);var{datasets:j,loading:E,errorMessage:x}=Object(o.useDatasetsQuery)(m,Object(c.getDatasetQueryVariables)(b,g,f),a.PortalScope,t,n),P=function(e,t,n){return e?e.map(e=>{var o=Object(c.getFriendlyDatasetDisplayName)(e.displayName);return{key:e.id,text:o||e.id,data:{iconUri:t,subtitle:e.id,iconTitle:n}}}):[]}(j,y,O);w.sites.push(...P);var D=p?void 0:function(e,t,n){if(e.site&&e.site.data&&e.site.data.isCustom){var o=e.site;return o.data.iconTitle=n,o.data.iconUri=t,o.data.subtitle=o.key,o}return}(u,y,O)||function(e,t){var n,o=e.site&&(null===(n=e.site.key)||void 0===n?void 0:n.toString().toLowerCase());return o?t.find(e=>e.key.toString().toLowerCase()===o):void 0}(u,P),N=function(e,t,n){if(n===l.ConnectionType.SqlServer&&Object(c.isOauthConnection)(t.connectionName))return Object(d.getSqlServerDatasetUrl)(t);return e&&e.key?e.key.toString():""}(D,u,f),{tables:k,errorMessage:L,loading:T,normalizedUrl:R}=Object(r.useTablesQuery)(m,Object(c.getTablesQueryVariables)(b,g,N,f),a.PortalScope,t,n),F=L?[]:function(e,t,n){return e?e.map(e=>({key:e.id,text:e.displayName,data:{iconUri:t,iconTitle:n}})):[]}(k,y,O);w.lists.push(...F);var I,q,M=(null===(h=u.list)||void 0===h?void 0:h.data.isCustom)&&u.list&&u.list.text,{tableDetails:B,loading:U,errorMessage:A}=Object(i.useTableDetailsQuery)(m,{primaryRuntimeUrl:b,connectionName:g,datasetUrl:N,tableName:M},a.PortalScope,t,n),W=null!=D&&D.data.isCustom&&void 0===u.list?L:x||void 0,V=null!==(v=u.list)&&void 0!==v&&v.data.isCustom?A:L||void 0;(function(e,t,n,o,r,i,a,s){var l;null==e||null===(l=e.data)||void 0===l||!l.isCustom||void 0!==t&&!s||n||((a||s)&&(e.data.isInvalid=!1,o.sites.unshift(e)),void 0===i.list&&!r&&void 0===t&&e.data.forceDismiss&&e.data.forceDismiss())}(D,W,E,w,T,u,!!k,R),p||!(null==u||null===(S=u.list)||void 0===S?void 0:S.data.isCustom)||void 0!==V||U)||B&&(I=function(e,t,n,o){var r,i,a,s,l=null===(r=e.authorLookupEndpointUri)||void 0===r?void 0:r.split("/",3);l&&(l=null===(s=e.editorLookupEndpointUri)||void 0===s?void 0:s.split("/",3));return{key:3===(null===(i=l)||void 0===i?void 0:i.length)?l[2]:"",text:e.displayName,data:{iconUri:n,iconTitle:o,isCustom:!0,isInvalid:!1,forceDismiss:null===(a=t.list)||void 0===a?void 0:a.data.forceDismiss}}}(B,u,y,O),w.lists.unshift(I),!U&&void 0===V&&(null===(q=I)||void 0===q?void 0:q.data.forceDismiss)&&I.data.forceDismiss());return{currentSelectedSiteDropdownOption:D,tablesNormalizedUrl:R,connectionOptions:C,siteOptions:P,listsOptions:F,customListOption:I,loadProgress:[Object(s.toLoadingState)(void 0!==j,x,"DatasetsQuery",!n),Object(s.toLoadingState)(void 0!==k,L,"DataTablesQuery",!n)],dropdownFormFields:w,datasetsQueryLoading:E,tablesQueryLoading:T,datasetsError:W,tablesError:V}}},6740:function(e,t,n){"use strict";function o(e){if(e.additionalFormData){var t=e.additionalFormData;return"".concat(t.server,",").concat(t.database)}return""}n.r(t),n.d(t,"getSqlServerDatasetUrl",(function(){return o}))},6741:function(e,t,n){"use strict";n.r(t),n.d(t,"isOpenSelectConnectionModalEnabled",(function(){return g})),n.d(t,"getShimmerRows",(function(){return h})),n.d(t,"renderList",(function(){return y})),n.d(t,"getRefreshButton",(function(){return O})),n.d(t,"renderEmptyList",(function(){return C})),n.d(t,"onListValueChange",(function(){return w})),n.d(t,"onSiteValueChange",(function(){return j})),n.d(t,"dropdownStyle",(function(){return E}));var o=n(3790),r=n(3058),i=n(245),a=n.n(i),s=n(3161),l=n(6733),c=n(6728),d=n(684),u=n(1755),p=n(6742);function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){b(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function b(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function g(e){switch(e){case o.ConnectionType.SharePoint:case o.ConnectionType.SqlServer:return!0;default:return!1}}var h=()=>a.a.createElement("div",null,v("LabelShimmerRow1"),S("InputBoxShimmerRow1"),v("LabelShimmerRow2"),S("InputBoxShimmerRow2"),v("LabelShimmerRow3"),S("InputBoxShimmerRow3")),v=e=>a.a.createElement(u.Shimmer,{width:350,shimmerElements:[{type:u.ShimmerElementType.line,width:50,height:12}],key:"shimmerDiv".concat(e)}),S=e=>a.a.createElement(u.Shimmer,{styles:{root:p.selectConnectionsModalStyles.elementGroupWrapperInput},width:350,customElementsGroup:[a.a.createElement("div",{className:p.selectConnectionsModalStyles.elementGroupWrapper,key:"shimmerDiv".concat(e)},a.a.createElement(u.ShimmerElementsGroup,{shimmerElements:[{type:u.ShimmerElementType.line,width:30,height:30},{type:u.ShimmerElementType.gap,width:10,height:30}]}),a.a.createElement(u.ShimmerElementsGroup,{flexWrap:!0,shimmerElements:[{type:u.ShimmerElementType.line,width:120,height:10}]}))]}),y=(e,t,n,o,r,i,s,d,u,p)=>e&&e.options&&e.onChange&&e.componentRef?a.a.createElement(c.LookupDropdown,{items:e.options,onItemClick:e.onChange,componentRef:e.componentRef,showCustomInput:!0,onCustomInputPressEnter:r,componentStrings:{customInputString:n,searchBoxString:o},itemsLoading:t,onRenderEmptyList:s,refreshButtonProps:d,customInputError:i,shouldFilterItem:(e,t)=>(p&&Object(l.trackConnectionModalEvent)(p,u),((e,t)=>{var n,o;if(!t)return!0;var r=!!t&&-1===(null===(n=e.text)||void 0===n?void 0:n.toLowerCase().indexOf(t.toLowerCase())),i=!!t&&-1===(null===(o=e.key)||void 0===o?void 0:o.toString().toLowerCase().indexOf(t.toLowerCase()));return!r||!i})(e,t))}):a.a.createElement(a.a.Fragment,null),O=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3?arguments[3]:void 0;return a.a.createElement(d.IconButton,{styles:{root:{marginRight:"8px"}},iconProps:{iconName:"Refresh"},onClick:()=>{t&&t(!0),r&&Object(l.trackConnectionModalButtonClick)(r,o.ConnectionType.SharePoint)},ariaLabel:e,title:e,disabled:n})},C=(e,t)=>a.a.createElement(s.EmptyState,{primaryMessage:e,secondaryMessage:t,styles:{root:{position:"absolute",maxWidth:"350px !important",height:"82px",margin:"39px 31px"},primaryMessage:{fontWeight:600,fontSize:"18px",lineHeight:"24px",textAlign:"center",color:r.fabricColors.neutralTuatara},secondaryMessage:{fontSize:"14px",lineHeight:"20px",textAlign:"center"}}});function w(e,t,n,o){var r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=arguments.length>5?arguments[5]:void 0;r&&e&&e.target&&(o={key:e.target.value,text:e.target.value,data:{isInvalid:!0,isCustom:r,forceDismiss:i}}),t(f(f({},n),{},{list:o}))}function j(e,t,n,o,r,i){var a=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7?arguments[7]:void 0;a&&e&&e.target&&(i={key:e.target.value,text:e.target.value,data:{isInvalid:!0,isCustom:a,forceDismiss:s}},n(!0)),t(f(f({},r),{},{site:i,list:void 0})),o(!0)}var E=e=>({callout:{selectors:{".ms-Callout-main":{height:1===e?"160px":2===e?"210px":"264px"}}}})},6742:function(e,t,n){"use strict";n.r(t),n.d(t,"selectConnectionsModalStyles",(function(){return l}));var o=n(860),r=n(719),i=n(3058),a=n(5932),s=n(6743),l=Object(r.mergeStyleSets)({titleWrapper:{padding:"16px 12px 0px 24px",width:Object(s.isLesserOrEqualToScreenSize)(o.ResponsiveMode.large)?void 0:450},titleWrapperOneColumn:{paddingTop:"0",paddingBottom:"11px"},title:{fontWeight:600,lineHeight:"28px",fontSize:"20px",marginBottom:"4px"},titleOneColumn:{fontWeight:600,lineHeight:"21px",fontSize:"16px",marginBottom:"0"},closeButton:{float:"right",cursor:"pointer",padding:"4px",marginTop:"20px",marginRight:"20px",color:i.fabricColors.neutralTuatara},contentWrapper:{minHeight:"572px",maxWidth:"900px"},modalContentWrapper:{maxWidth:"900px"},loadingImageCentered:{position:"absolute",top:0,left:0,right:0,bottom:0,margin:"auto"},mainContent:{width:"100%",height:"572",overflow:"hidden",paddingBottom:Object(s.isLesserOrEqualToScreenSize)(o.ResponsiveMode.medium)?void 0:57},section:{borderRight:"none",overflow:"hidden",width:Object(s.isLesserOrEqualToScreenSize)(o.ResponsiveMode.medium)?"100%":"50%",minWidth:Object(s.isLesserOrEqualToScreenSize)(o.ResponsiveMode.large)?void 0:425,paddingRight:"12px",paddingLeft:"12px",selectors:{".ms-Dropdown-container, .ms-TextField ":{paddingBottom:"16px"}}},sectionOneColumn:{borderRight:"none",overflow:"hidden",width:"50%",paddingRight:"12px",paddingLeft:"0",selectors:{".ms-Dropdown-container, .ms-TextField ":{paddingBottom:"16px"}}},description:{paddingTop:"12px"},appTagsSectionWrapper:{marginTop:"16px"},appTagsSection:{display:"flex",flexDirection:"row",alignItems:"center",fontWeight:400},appFormatTag:{backgroundColor:i.fabricColors.neutralLighter,margin:"auto 0px auto 8px",width:"46px",height:"24px",lineHeight:"16px",color:i.fabricColors.black,textAlign:"center",borderRadius:"3px"},appFormatTagText:{fontSize:"12px",verticalAlign:"middle",display:"inline-block",padding:"4px"},appTagsStyle:{padding:"4px",height:"24px",fontWeight:400,fontSize:"12px",lineHeight:"16px",backgroundColor:i.fabricColors.neutralLighter,color:i.fabricColors.black,border:"none",selectors:{span:{fontWeight:400}}},appTagCallout:{maxWidth:"288px",padding:"16px 11px 16px 28px"},appTagCalloutCloseButton:{float:"right",paddingTop:"10px"},appTagCalloutHeader:{fontSize:"16px",lineHeight:"19px"},appTagCalloutAnnotation:{padding:"12px 0",fontSize:"14px",lineHeight:"16px"},imageSection:{height:Object(s.isLesserOrEqualToScreenSize)(o.ResponsiveMode.large)?void 0:280,margin:"4px 0px",width:Object(s.isLesserOrEqualToScreenSize)(o.ResponsiveMode.large)?void 0:412,backgroundColor:i.fabricColors.neutralLighter,textAlign:"center",verticalAlign:"middle",lineHeight:Object(s.isLesserOrEqualToScreenSize)(o.ResponsiveMode.large)?void 0:280},image:{".ms-Image-image":{width:Object(s.isLesserOrEqualToScreenSize)(o.ResponsiveMode.small)?240:Object(s.isLesserOrEqualToScreenSize)(o.ResponsiveMode.large)?268:void 0},fontSize:"100px"},footer:{display:"flex",padding:"12px",flexDirection:"row",justifyContent:"flex-end",alignItems:"center",flex:"0 0 45px",height:"56px"},button:{marginLeft:"8px"},createChoiceGroup:{fontFamily:a.fonts.segoeUiSemilight,marginTop:"11px"},editLink:{verticalAlign:"middle",display:"inline-block",paddingBottom:"20px",selectors:{i:{verticalAlign:"middle",marginLeft:"7px",fontSize:"16px"}}},settingsDiv:{marginTop:"4px",color:i.fabricColors.black,selectors:{button:{paddingBottom:"2px"}}},onPremConnectionDiv:{color:i.fabricColors.black,selectors:{button:{paddingBottom:"2px"}}},onPremConnectionLink:{verticalAlign:"middle",display:"inline-block",paddingBottom:"20px",paddingRight:"4px",selectors:{i:{verticalAlign:"middle",marginLeft:"7px",fontSize:"16px"}}},elementGroupWrapperInput:{paddingTop:"10px",paddingBottom:"20px"},elementGroupWrapper:{display:"flex"},oneColumnMessage:{marginBottom:"16px"}})},6743:function(e,t,n){"use strict";n.r(t),n.d(t,"isLesserOrEqualToScreenSize",(function(){return r}));var o=n(860);function r(e){return Object(o.getResponsiveMode)(window)<=e}},6744:function(e,t,n){"use strict";n.r(t),n.d(t,"SqlServerConnectionsDropdown",(function(){return p}));var o=n(684),r=n(1567),i=n(245),a=n(6733),s=n(3790),l=n(6728);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var p=e=>{var t,n,c=i.useRef(null),{t:u,connectionHasError:p,formValues:m,fieldOptions:f,setFormValues:b,setRefreshSites:g,createConnection:h}=e,v=!!f&&!!f.connections&&f.connections.length>0;return i.createElement(r.Dropdown,{id:"ConnectionsDropdown",label:u("SqlServer.connectionsLabel"),placeholder:u("SqlServer.connectionsPlaceholder"),options:f.connections,required:!0,disabled:!v||p||!m.connectionName,selectedKey:!(null!==(t=m.connectionName)&&void 0!==t&&t.data.isInvalid)&&(null===(n=m.connectionName)||void 0===n?void 0:n.key)||"",onChange:(e,t)=>{b(d(d({},m),{},{connectionName:t,site:void 0,list:void 0})),g(!0),Object(a.trackConnectionModalEvent)(a.ScenarioNames.ConnectionSelect,s.ConnectionType.SqlServer)},onRenderList:e=>e&&e.options&&e.onChange&&e.componentRef?i.createElement(l.CustomHeaderDropdown,{items:e.options,onItemClick:e.onChange,componentRef:e.componentRef,onRenderCustomOnTop:()=>i.createElement(o.CommandButton,{iconProps:{iconName:"Add"},text:u("SqlServer.connectionsCreateNewLabel"),onClick:h})}):i.createElement(i.Fragment,null),componentRef:c})}},6745:function(e,t,n){"use strict";n.r(t),n.d(t,"SqlServerTableDropdown",(function(){return l}));var o=n(1567),r=n(245),i=n(6733),a=n(3790),s=n(6741),l=e=>{var t,n,l=r.useRef(null),{t:c,connectionHasError:d,formValues:u,fieldOptions:p,setFormValues:m,setRefreshLists:f,tablesLoading:b,tablesError:g}=e,h=!!p&&!!p.connections&&p.connections.length>0,v=e=>{var t;Object(s.onListValueChange)(e,m,u,void 0,!0,null===(t=e.target)||void 0===t?void 0:t._onDismiss),Object(i.trackConnectionModalEvent)(i.ScenarioNames.TableSelect,a.ConnectionType.SqlServer,{customInput:!0})},S=Object(s.getRefreshButton)(c("Common.refreshButtonTitle"),f,b,i.ScenarioNames.RefreshTablesButton),y=Object(s.renderEmptyList)(c("SqlServer.emptyListsListPrimaryMessage"),c("SqlServer.emptyListsListSecondaryMessage"));return r.createElement(o.Dropdown,{id:"listsDropdown",label:c("SqlServer.listsLabel"),placeholder:c("SqlServer.listsPlaceholder"),options:p.lists,required:!0,disabled:!h||d||!u.connectionName||!u.site,selectedKey:!(null!==(t=u.list)&&void 0!==t&&t.data.isInvalid)&&(null===(n=u.list)||void 0===n?void 0:n.key)||"",onChange:(e,t)=>{Object(s.onListValueChange)(e,m,u,t,!1),Object(i.trackConnectionModalEvent)(i.ScenarioNames.TableSelect,a.ConnectionType.SqlServer)},styles:Object(s.dropdownStyle)(p.lists.length),onRenderList:e=>Object(s.renderList)(e||{},!h||d||!u.connectionName||!u.site,c("SqlServer.listsListInputPlaceholder"),c("SqlServer.listsListSearchPlaceholder"),v,!!g&&c("SqlServer.listNotFound")||"",y,S,a.ConnectionType.SqlServer,i.ScenarioNames.FilterTableResults),componentRef:l})}},6746:function(e,t,n){"use strict";n.r(t),n.d(t,"SqlServerDataset",(function(){return p}));var o=n(1372),r=n(1429),i=n(245),a=n(6733),s=n(3790),l=n(6726);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var p=e=>{var{t:t,connectionHasError:n,formValues:c,fieldOptions:u,setFormValues:p,setRefreshLists:m}=e,f=!!u&&!!u.connections&&u.connections.length>0,b=c.connectionName&&c.connectionName.data&&c.connectionName.data.details&&c.connectionName.data.details.connectionParameter||void 0;if(b&&!Object(l.isOauthConnection)(c.connectionName))return i.createElement(i.Fragment,null,i.createElement("div",{id:"sqlServerName",style:{paddingBottom:"19px"}},i.createElement(o.Label,null,t("SqlServer.serverNameLabel")),i.createElement(o.Label,{style:{fontWeight:"normal"}},b.server)),i.createElement("div",{id:"sqlDatabaseName",style:{paddingBottom:"19px"}},i.createElement(o.Label,null,t("SqlServer.databaseNameLabel")),i.createElement(o.Label,{style:{fontWeight:"normal"}},b.database)));var g=(e,t)=>{p(d(d({},c),{},{additionalFormData:e})),e.server&&e.database&&m(!0),Object(a.trackConnectionModalEvent)(t,s.ConnectionType.SqlServer)},h=c.additionalFormData?c.additionalFormData:{};return i.createElement("div",{id:"sqlServerDetailsEdit"},i.createElement(r.TextField,{id:"sqlServerName",label:t("SqlServer.serverNameLabel"),placeholder:t("SqlServer.serverNamePlaceholder"),required:!0,defaultValue:h.server,onBlur:e=>{h.server=e.currentTarget.value||"",g(h,a.ScenarioNames.SqlServerNameEdit)},disabled:!f||n}),i.createElement(r.TextField,{id:"sqlDatabaseName",label:t("SqlServer.databaseNameLabel"),placeholder:t("SqlServer.databaseNamePlaceholder"),required:!0,defaultValue:h.database,onBlur:e=>{h.database=e.currentTarget.value||"",g(h,a.ScenarioNames.SqlServerNameEdit)},disabled:!f||n}))}}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/221.d686dfcc.chunk.js.map