(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/15.js?v=1.4.3886-master"]={begin:performance.now()},(window.__wpJsonpUci=window.__wpJsonpUci||[]).push([[15],{"+aBC":function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var r=i("jq7Z");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function n(e,t){return e+":"+t}function a(e,t,i,a){const s=n(i,a),o=Object(r.a)(e,t);return o&&o.customDataProviderOutputs&&o.customDataProviderOutputs[s]?o.customDataProviderOutputs[s]:null}},"00VO":function(e,t,i){"use strict";i.d(t,"b",(function(){return n})),i.d(t,"a",(function(){return a})),i.d(t,"c",(function(){return s})),i.d(t,"d",(function(){return o}));var r=i("/A0C");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function n(e,t){const i=[],r=e?e.split("|"):null;r&&r.forEach(e=>{i.push({attributeName:t,conditionOperator:6,value:e+"%"})});const n={conditions:i,filterOperator:1,filters:[]};return JSON.stringify(n)}function a(e,t,i){const r=new DOMParser,n=r.parseFromString(e,"text/xml"),a=n.getElementsByTagName("entity");if(a.length>0){const e=a[0],s="name";if(e.hasAttribute(s)&&"systemuser"===e.attributes.getNamedItem(s).value){const a=`<link-entity name="teammembership" to="systemuserid" from="systemuserid" link-type="inner">\n\t\t\t<link-entity name="team" to="teamid" from="teamid" link-type="inner">\n\t\t\t\t<filter type="and">\n\t\t\t\t<condition attribute="regardingobjectid" operator="eq" value="${i}"/>\n\t\t\t\t<condition attribute="teamtype" operator="eq" value="1" />\n\t\t\t\t<condition attribute="teamtemplateid" operator="eq" value="${t}"/>\n\t\t\t\t</filter>\n\t\t\t</link-entity>\n\t\t\t</link-entity>`,s=r.parseFromString(a,"text/xml");if(s.hasChildNodes()){e.appendChild(s.firstChild);return{updatedFetchXml:(new XMLSerializer).serializeToString(n.firstChild),filterString:a}}}}return{updatedFetchXml:e,filterString:""}}function s(e,t,i){let r=i;if(e){const n=(new DOMParser).parseFromString(e,"text/xml").getElementsByTagName("order");if(!n)return i;{let e=0,a=0;for(;a<n.length;a++)if(n[a].parentNode&&n[a].parentNode.localName&&"link-entity"!==n[a].parentNode.localName){e=a;break}if(a>=n.length)return i;const s=n[e];if(s){r=s.getAttribute("attribute");r=o(r,t[r].Type,i)}}}return r}function o(e,t,i){return e=function(e,t){e!==r.a.Customer&&e!==r.a.Lookup&&e!==r.a.Owner||(t+="name");return t}(t,e),function(e){switch(e){case r.a.String:case r.a.Memo:case r.a.Customer:case r.a.Lookup:case r.a.Owner:return!0;default:return!1}}(t)||(e=i),e}},"223Y":function(e,t,i){"use strict";i.d(t,"b",(function(){return hi})),i.d(t,"a",(function(){return gi})),i.d(t,"d",(function(){return fi})),i.d(t,"c",(function(){return pi}));var r=i("u+q+"),n=i("QBtP"),a=i("mMyr"),s=i("dL2K"),o=i("laoc"),l=i("2SCk"),c=i("g03H"),u=i("fMBw"),d=i.n(u),p=i("SZCI"),h=i("SAYH"),g=i("504W"),m=i("arV0"),f=i("xHmU"),b=i("i1f0"),y=i("lEFU"),v=i("Z/4N"),S=i("5ZBI"),_=i("dHD5"),O=i("jRy5"),P=i("odYE"),w=i("bT7G"),C=i("pnQK"),I=i("OtHk"),E=i("3/02"),j=i("Lyxw");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const D="CustomControlFramework.Selectors.CustomControlHostContextTokenSelectors";function T(){let e=null,t=null,i=null;return(r,n)=>{S.a.info(n.controlId+"."+D+": createGetContextTokenSelector started");const a=n.parentContextToken,s=n.contextString,o=function(e,t){const i=t.parentContextToken,r=t.contextString;let n;const a=t.configuration,s=Object(v.e)(e,t.configuration.CustomControlId);if(Object(j.f)(e,E.lb)&&Object(l.s)(s)&&function e(t,i){if(!i)return!1;if(i.contextTokenType===O.a.UnboundForm&&i.formId)return!(!Object(C.a)(t,i.formId)&&!Object(I.a)(t,i.formId));return e(t,i.parentContextToken)}(e,i))return n=_.q(i.parentContextToken,t.controlId),n;if("default"===r&&Object(l.s)(s)&&!Object(l.r)(t.configuration.Parameters)||Object(l.r)(t.configuration.Parameters)&&function(e){if(e.indexOf("ClientContextGridControl")>-1||e.indexOf("activeProcessGridControlContainer")>-1||e.indexOf("ManageDuplicatesGrid")>-1||e.indexOf("archivedProcessGridControlContainer")>-1)return!0;return!1}(t.controlId))return n=_.e(i,t.controlId),n;if(!t.formInfo&&a&&a.Parameters&&a.Parameters.value&&"TimelineWall"===a.Parameters.value.Type)return n=_.q(i,t.controlId),n;if(!t.formInfo&&Object(l.t)(t.configuration)){const r=function(e,t){const i=Object(m.j)(e,t.id),r=new P.a(i.entityTypeName,i.id||h.a.EMPTY),n=Object(b.hc)(e,t.id,t.parentContextToken),a=Object(w.e)(e,n,r,t.descriptor.DataFieldName),s=a?a.reference:null;return s?s.etn:Object(l.m)(t.descriptor)}(e,t);return n=_.m(i,t.controlId,r),n}n=i;const o=t.descriptor&&t.descriptor.Relationship;o&&(n=_.n(n,o));return n}(r,n);return(i!==s||F(e,o)||F(t,a))&&(e=o,t=a,i=s),S.a.info(n.controlId+"."+D+": createGetContextTokenSelector finished"),e}}function F(e,t){return e&&t?e.entityTypeName!==t.entityTypeName||e.controlName!==t.controlName||(e.formId&&e.formId.guid)!==(t.formId&&t.formId.guid)||(e.recordId&&e.recordId.guid)!==(t.recordId&&t.recordId.guid)||e.relationshipName!==t.relationshipName:e!==t}var N=i("p8cR"),R=i("P6DH"),k=i("zmL5"),A=i("OKVy"),M=i("FdB0"),x=i("fILV");function L(){let e={},t=!1;return(i,r,n,a,s,o)=>{S.a.info(r.controlId+".CustomControlFramework.Selectors.CustomControlHostPersonalizationInfoSelectors: createGetPersonalizationConfiguration started");const l=Object(m.a)(i,r),c=l&&l.id,u=e&&c&&c.guid&&(!e.recordGuid||e.recordGuid&&c.guid!==e.recordGuid.guid);if(!t||u){const l=Object(k.b)(i,r.id),c=h.a.equals(h.a.tryParse(n.UniqueId),h.a.EMPTY)?r.controlId:n.UniqueId;e=l&&o===A.a?function(e,t,i,r){return{areaType:"dashboard",entityTypeName:null,recordGuid:null,formGuid:i,controlUniqueId:r,viewId:void 0}}(0,0,l,c):l&&o===M.a?function(e,t,i,r){const{entityTypeName:n,recordSetQueryKey:a}=Object(m.a)(e,t);return{areaType:"dialog",entityTypeName:n,formGuid:i,controlUniqueId:r,viewId:a?a.split(",")[1]:void 0}}(i,r,l,c):l?function(e,t,i,r){const{entityTypeName:n,recordSetQueryKey:a,id:s}=Object(m.a)(e,t);return{areaType:"form",entityTypeName:n,recordGuid:s,formGuid:i,controlUniqueId:r,viewId:a?a.split(",")[1]:void 0}}(i,r,l,c):o===x.a?function(e,t,i,r){const n=Object(R.fb)(e,r,t);return{areaType:"grid",entityTypeName:i,viewId:n?n.split(",")[1]:void 0}}(i,r,a.entityTypeName,s):{areaType:null,entityTypeName:null,controlUniqueId:c,viewId:void 0},t=!0}return S.a.info(r.controlId+".CustomControlFramework.Selectors.CustomControlHostPersonalizationInfoSelectors: createGetPersonalizationConfiguration finished"),e}}var V=i("q6Ks"),B=i("jq7Z");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function z(e,t,i,r,n){const a=Object(B.a)(e,t),s=n?"__hiddenCommandManagerIds":"__pendingCommandManagerIds",o=Object(_.w)(r);return a&&a[s]&&a[s][o]&&a[s][o][i]?a[s][o][i]:null}var U=i("GT4X"),W=i("tJ+6"),G=i("cfbi");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const q=d.a.createEvent("CustomControlHostSelectors.mapStateToProps",p.e);var H=i("r/9v"),Q=i("OmkB"),K=i("tOh6"),X=i("BJ7u"),Y=i("5DN6"),J=i("iZ7K"),$=i("lY/Z"),Z=i("Lohl"),ee=i("y60j"),te=i("XlXz");function ie(e,t){return{type:te.a,payload:e,meta:{pageId:t}}}function re(e){return{type:"execute.cleanreferencepanelstate.async",execute:({dispatch:t,getState:i},r)=>(t(function(e){return{type:te.b,payload:{},meta:{pageId:e}}}(e)),Promise.resolve())}}function ne(e){return{type:"execute.closeallsessiontabs.async",execute({dispatch:t,getState:i},r){const n=i();return t(function(e,t){return{type:te.c,payload:e,meta:{pageId:t}}}({sessionTabs:[],activeTabId:Object(Y.b)(n,e)},e)),Promise.resolve()}}}function ae(e,t){return{type:"execute.closesessiontab.async",execute({dispatch:i,getState:r},n){const a=r(),s=Object(Y.d)(a,t),o=Object(Y.a)(a,e,t);return s.splice(e,1),i(function(e,t){return{type:te.d,payload:e,meta:{pageId:t}}}({sessionTabs:s,activeTabId:o},t)),Promise.resolve()}}}function se(e){return{type:"execute.dismissmessage.async",execute:({dispatch:t,getState:i},r)=>(t(function(e,t){return{type:te.e,payload:{referencePanelState:t},meta:{pageId:e}}}(e,{messageId:""})),Promise.resolve())}}function oe(e,t){return{type:"execute.initializereferencepanelcontrol.async",execute({dispatch:i,getState:r},n){const a=Object(Y.c)(r(),t);if(e&&!(a.activeTabId&&a.controlNames.length>0))return i(function(e,t){return{type:te.f,payload:e,meta:{pageId:t}}}({controlNames:e.map(e=>e.Name),activeTabId:e[0].Id},t)),Promise.resolve()}}}var le=i("SWZ5");function ce(e,t){return{type:"execute.addsessiontab.async",execute({dispatch:i,getState:r},n){const a=Object(Y.d)(r(),t),s=[];for(let t=0;t<a.length;t++)a[t].id===e.id?s.push(e):s.push(a[t]);return i(function(e,t){return{type:te.h,payload:e,meta:{pageId:t}}}({sessionTabs:s},t)),Promise.resolve()}}}var ue=i("IaGr"),de=i("1kth");var pe=i("Or4W"),he=i("BMZr"),ge=i("uPT+"),me=i("mIxf"),fe=i("sX6v"),be=i("WY/A"),ye=i("JP46"),ve=i("Dea/");var Se=i("ghNp"),_e=i("yRo8"),Oe=i("oOvK"),Pe=i("FZDd"),we=i("HfZT"),Ce=i("6Qf/"),Ie=i("a72m"),Ee=i("Tf+h"),je=i("ZUzm"),De=i("0uKS"),Te=i("lIi+"),Fe=i("lYcl"),Ne=i("huli"),Re=i("VCkP");var ke=i("DU8S");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class Ae{constructor(e,t){this.Target=e,this.FieldName=t}getMetadata(){return{boundParameter:null,operationName:"CalculateRollupField",operationType:1,parameterTypes:{Target:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5},FieldName:{typeName:"Edm.String",structuralProperty:1}}}}}var Me=i("srnJ"),xe=i("W8Pl"),Le=i("pGYJ");var Ve=i("NjDY");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var Be=i("0zhR"),ze=i("EY5k"),Ue=i("YxC/");var We=i("VpHT"),Ge=i("xymJ"),qe=i("kWiz");var He=i("Khp3"),Qe=i("3tOH"),Ke=i("Qn2w"),Xe=i("LbMF");var Ye=i("dQnL"),Je=i("d0Pd"),$e=i("0L4T"),Ze=i("NbYl"),et=i("NYBK"),tt=i("7fV9"),it=i("Z+6x"),rt=i("Nse0"),nt=i("WK+4"),at=i("qwRa"),st=i("s+OO"),ot=i("7k+e"),lt=i("BFlg"),ct=i("L4PC"),ut=i("ztod");function dt(e,t,i){return{type:"dataset.update.gridpagenumber.async",execute({dispatch:r,getState:n},a){const s=a.TraceManager.getTracer(lt.P),o=lt.N+".updatePageNumberAction";try{if(s.info("Updating the grid page number for the grid."),r(Object(ct.b)(e,t,i)),Object(j.f)(n(),E.Wf)){const t=[{filterType:12,filterExpressionOrValue:i}];r(Object(ut.a)(t,e))}const l=[];return l.push({name:"gridPageNumber",value:i}),a.EventManager.ReportComponentSuccess(o,l),Promise.resolve()}catch(e){const t="Updating of grid page number for the grid failed with error : "+e.message;a.EventManager.ReportComponentFailure(o,Error(t))}}}}var pt=i("eXjw"),ht=i("Uv1Y"),gt=i("vNXc"),mt=i("5Oca");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class ft{constructor(e,t,i){this.Target=e,this.Query=t,this.RollupType=i}getMetadata(){return{boundParameter:null,operationName:"Rollup",operationType:1,parameterTypes:{Target:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5},Query:{typeName:"Microsoft.Dynamics.CRM.QueryBase",structuralProperty:2},RollupType:{typeName:"Microsoft.Dynamics.CRM.RollupType",structuralProperty:3,enumProperties:[,{name:"None",value:0},{name:"Related",value:1},{name:"Extended",value:2}]}}}}}var bt=i("sNgR"),yt=i("tHtE"),vt=i("SRlt"),St=i("fYtF");function _t(e,t,i=!1){const r=[];return{type:"gridData.retrieve.rollup.async",execute({dispatch:n,getState:a},s){let o=a();const l=e.key,c=gt.a.fromState(e,a),u=Object(mt.w)(o,l,c.pageNumber-1);return u&&(c.pagingCookie=u),r.push(...Object(St.e)(e)),r.push({name:"isRefresh",value:i}),n(function(e,t,i=!1){const r={lists:{[e]:{initialized:i?pt.a.Refreshing:pt.a.Initializing,pageSize:t}}};return{type:"gridData.retrieve.rollup",payload:r}}(l,c.pageSize,i)),function(e,t,i,r){return i.toQueryExpression(e,t,r).then(n=>t(Object(bt.b)(new ft(P.a.toExternalEntityReference(i.target),n,i.rollupType),r)).then(n=>Object(vt.g)(n).then(n=>function(e,t,i,r,n){const a=i.getKeyQuery(),s=Object(yt.e)(e(),a),o=Object(Pe.e)(s.entity2AttributesMap,n);return t(o).then(()=>{const t=e();return Object(yt.a)(t,a,s,r)})}(e,t,i,n,r))))}(a,n,c,t).then(e=>{o=a(),n(Object(we.f)(o,n,l,c,e))}).catch(e=>{Object(ht.b)(e)})},getFailureParameters:(e,t)=>r,getSuccessParameters:(e,t,i)=>r}}var Ot=i("fREn"),Pt=i("ngeo"),wt=i("xorU");function Ct(e,t,i,r,n){let a="",s="";if(r&&r.message&&(a=r.message),r&&r.errorCode){const o=n||Le.a,l=(e,t=!1)=>{const l=[{name:"hexErrorCode",value:s},{name:"errorStatus",value:JSON.stringify(r)},{name:"customControlId",value:n},{name:"APIName",value:Le.a+".Actions.RefreshDataSetParameter.getErrorMessage"}];return t?i.TraceManager.getTracer(o).warn(e,l):i.EventManager.ReportComponentFailure(o,e,null,l),Promise.resolve(`${s} ${a}`)};try{s="0x"+Pt.a.getHexErrorCodeFromInt(r.errorCode);const i="Error_Title_"+s,n="Error_Message_"+s,a=`Localized resource strings not found for neither ${i} nor ${n}.  Please add error resources for error code ${s}`,o=e(Object(ze.e)([i])).catch(()=>{}),c=e(Object(ze.e)([n])).catch(()=>{});return Promise.all([o,c]).then(()=>{const e=Object(Ue.e)(t(),[i,n]),r=Object(Ue.c)(e,i),o=Object(Ue.c)(e,n);let c="";return c=function(e){return"0x8005f211"===(null==e?void 0:e.toLowerCase())}(s)?`${r}${r&&o?": ":""}${o}`:r||o,c?`${s} ${c}`:l(a,!0)})}catch(e){return l(e)}}return Promise.resolve(`${s} ${a}`)}function It(e,t){if(e instanceof tt.a){e.getLatestData().loading=!0,e.setRefreshingStart()}else if(e instanceof it.a||e instanceof et.a){const t=e.getLatestData();t&&(t.working=!0,it.a,e.setWrapperLoadingFlag(!0))}return{type:"customcontrol.refreshDataSetParameter.async",execute({dispatch:i,getState:r},n){if(e instanceof Ze.a){const a={retrieveGridDataAction:(e,t)=>i(Object(we.e)(e,t)),retrieveViewAction:(e,t,r,n,a,s=!1,o=!1)=>i(Object(Ie.a)(e,t,r,n,a,s,o)),retrieveViewSelectorAction:(e,t)=>i(Object(Ie.b)(e,t)),runPreSearch:(e,r,n)=>i(Object(de.X)(t,e,r,n)),runSetAdditionalParams:(e,r,n)=>i(Object(de.Y)(t,e,r,n)),refreshCustomDataProviderAction:(e,t,r,n)=>i(Object(rt.b)(e,t,r,n)),retreiveChartAction:(e,t,r)=>i(Object(Ye.a)(e,t,r)),retreiveChartDataAction:(e,t,r,n=!0)=>i(Object(Je.a)(e,t,r,n)),updateDataSetChartVisualizationId:(e,t,r)=>i(Object(nt.b)(e,t,r)),updateDataSetChartVisualizationType:(e,t,r)=>i(Object(at.b)(e,t,r)),getEntityMetadataAction:(e,t)=>i(Object(Pe.f)(e,!1,t)),getLocalizedErrorMessage:(e,t)=>Ct(i,r,n,e,t),updateChartFilterExpression:(e,t,r)=>i(Object(st.c)(e,t,r)),updateChartDrillDownParameters:(e,t,r)=>i(Object(ot.c)(e,t,r)),updateChartErrorInformation:(e,t,r,n)=>{Object($e.a)(e,i,t,r,n)}};return e.refreshDataSet(r,a,n)}const a={retrieveGridDataAction:(e,t)=>Object(g.a)(e.rollupType)?i(Object(we.e)(e,t)):i(_t(e)),retrieveViewAction:(e,t,r,n,a,s=!1,o=!1)=>i(Object(Ie.a)(e,t,r,n,a,s,o)),retrieveViewSelectorAction:(e,t)=>i(Object(Ie.b)(e,t)),runPreSearch:(e,r,n)=>i(Object(de.X)(t,e,r,n)),runSetAdditionalParams:(e,r,n)=>i(Object(de.Y)(t,e,r,n)),startCustomFilter:(e,t,r)=>i(Object(wt.f)(e,t,r)),endCustomFilter:(e,t,r)=>i(Object(wt.e)(e,t,r)),refreshCustomDataProviderAction:(e,t,r,n)=>i(Object(rt.b)(e,t,r,n)),getEntityMetadataAction:(e,t)=>i(Object(Pe.f)(e,!1,t)),getLocalizedErrorMessage:e=>Ct(i,r,n,e),getAdditionalResourceStrings:e=>i(Object(ze.e)(e)),addCustomViewAction:(e,t,r,n,a,s,o,l)=>i(Object(Ot.a)(e,t,r,n,a,s,o,l)),setOfflineQueryAction:e=>i(Object(Ot.b)(e)),applyGridCustomFilter:(e,t)=>{const r=[{filterType:6,filterExpressionOrValue:t}];i(Object(ut.a)(r,e))},applyGridSorting:(e,t)=>{const r=[{filterType:7,filterExpressionOrValue:t}];i(Object(ut.a)(r,e))},applyGridPaging:(e,t,r)=>{i(dt(e,t,r))}};return e.refreshDataSet(r,a,n)}}}var Et=i("7Sr4");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var jt=i("sn0j"),Dt=i("KVHF");var Tt=i("mFPv"),Ft=i("AE7n"),Nt=i("pp6D"),Rt=i("9i5P");var kt=i("Q1Tc"),At=i("jsFU"),Mt=i("izYK");var xt=i("eDSk"),Lt=i("Pbw+"),Vt=i("iWfp");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function Bt(e){if(!e)return;if(e instanceof P.a)return e;const t=e.entityName||e.LogicalName;let i;return i=h.a.fromLegacyGuid(e.Id),h.a.isNullOrEmpty(i)&&(i=new h.a(e.id||e.Id)),new P.a(t,i,Object(g.a)(e.name)?e.Name:e.name)}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var zt=i("/A0C");function Ut(e,t,i,r){return r&&r.DisplayName&&r.Type!==zt.a.PartyList&&Object(jt.b)(e,t,i,r)&&r.IsValidForAdvancedFind}var Wt=i("thZs"),Gt=i("R5Qn"),qt=i("E3i9"),Ht=i("KBcj");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class Qt{convert(e,t,i){const r=(new DOMParser).parseFromString(e,"text/xml"),n=this._firstElementChild(r),a=this._childElements(n);if(!a)return null;const s=[];for(const e of a){const t=[],i=this._childElements(e);for(const e of i)t.push(this._getGridCellDescriptor(e));s.push(this._getGridRowDescriptor(e,t))}const o=this._getGridDescriptor(n,s,i);return this._populateRelationshipInformation(o,t),o}_attributeValueBoolean(e,t){return"1"===this._attributeValueString(e,t,"")}_attributeValueString(e,t,i){const r=e.attributes.getNamedItem(t);return r&&r.value||i}_attributeValueInt(e,t,i){const r=this._attributeValueString(e,t,i+"");return parseInt(r,10)}_childElements(e){if(!e)return null;if(e.children)return Array.from(e.children);if(e.childNodes){return Array.from(e.childNodes).filter(e=>e.nodeType===Node.ELEMENT_NODE).map(e=>e)}return null}_getGridCellDescriptor(e){return{name:this._attributeValueString(e,"name",""),width:this._attributeValueInt(e,"width",0),relatedEntityName:this._attributeValueString(e,"relatedentityname",""),disableMetaDataBinding:this._attributeValueBoolean(e,"disableMetaDataBinding"),labelId:this._attributeValueString(e,"LabelId",""),isHidden:this._attributeValueBoolean(e,"ishidden"),disableSorting:this._attributeValueBoolean(e,"disableSorting"),addedBy:this._attributeValueString(e,"addedby",""),desc:this._attributeValueString(e,"desc",""),cellType:this._attributeValueString(e,"cellType",""),imageProviderWebresource:this._attributeValueString(e,"imageproviderwebresource",""),imageProviderFunctionName:this._attributeValueString(e,"imageproviderfunctionname","")}}_getGridRowDescriptor(e,t){return{name:this._attributeValueString(e,"name",""),id:this._attributeValueString(e,"id",""),cells:t,multiObjectIdField:this._attributeValueString(e,"multiobjectidfield",""),layoutStyle:this._attributeValueString(e,"layoutstyle","")}}_getGridDescriptor(e,t,i){return{name:this._attributeValueString(e,"name",""),object:i,rows:t,customControlDescriptions:null,jump:this._attributeValueString(e,"jump",""),select:this._attributeValueBoolean(e,"select"),icon:this._attributeValueBoolean(e,"icon"),preview:this._attributeValueBoolean(e,"preview"),iconrenderer:this._attributeValueString(e,"iconrenderer","")}}_firstElementChild(e){if(!e)return null;if(e.firstElementChild)return e.firstElementChild;const t=this._childElements(e);return t&&t[0]}_populateRelationshipInformation(e,t){const i=(new DOMParser).parseFromString(t,"text/xml"),r=this._firstElementChild(i),n=this._firstElementChild(r),a=this._childElements(n);if(a)for(const t of a)"link-entity"===t.nodeName&&this._attributeValueString(t,"alias","")&&this._attributeValueString(t,"name","")&&this._setRelatedEntityName(e,this._attributeValueString(t,"alias",""),this._attributeValueString(t,"name",""))}_setRelatedEntityName(e,t,i){for(let r=0;r<e.rows.length;r++)for(let n=0;n<e.rows[r].cells.length;n++){const a=e.rows[r].cells[n].name;(a?a.substring(0,a.indexOf(".")):void 0)===t&&(e.rows[r].cells[n].relatedEntityName=i)}}}var Kt=i("DU5H"),Xt=i("fU7K");function Yt(e,t=!1,i,r,n,a,s,o){return{type:"populateAndSend.LookupData.Action",sync:!0,execute({dispatch:l,getState:c},u){const d=c(),p=n||e.LookupEntityByName[0].EntityLogicalName,g=Object(Gt.f)(d,p,s,r),f=[];if(o){const t=o.split("."),n=Object(m.j)(d,r);let a;const s=Object(b.hc)(d,r,i),l=Object(w.b)(d,s);a=l&&l.activeChanges&&l.activeChanges[t[1]]?l.activeChanges[t[1]]:Object(mt.j)(d,new P.a(t[0],n.id),t[1]),e.RelatedRecordId=a&&a.reference&&a.reference.id}if(e.LookupEntityByName&&e.LookupEntityByName.length){const t=Object(b.hb)(d,r,i),n=t&&t[a];for(const t of e.LookupEntityByName){const e=Object(Kt.b)(d,r,i,a,t.EntityLogicalName);if(e&&(t.CustomFilter=Object(Xt.CrmHtmlDecode)(e).replace(/"/g,"'")),g){const e=Object(qt.a)(d,g,t.EntityLogicalName);e&&e.view&&(h.a.equals(e.view.viewId,t.ViewId)||Object(Ht.c)(d,t.ViewId))||f.push(l(Object(Ie.a)(t.EntityLogicalName,null,null,t.ViewId)))}const s=n&&n.parameters&&n.parameters.defaultviewid;if(n&&n.views&&n.views[s]&&n.views[s].entityLogicalName===t.EntityLogicalName){t.ViewId=null,t.FetchXml=n.views[s].fetchXML.replace(/"/g,"'");const e=Object(J.h)(d,t.EntityLogicalName),i=new Qt;t.LayoutJson=JSON.stringify(i.convert(n.views[s].layoutXML,n.views[s].fetchXML,e.ObjectTypeCode)).replace(/"/g,"'")}}}const y=Object(Wt.b)(d,p,e),v=Object(mt.p)(d,y);t=t||v===pt.a.Initialized,f.push(l(Object(Wt.d)(e,t)));const S=function(e,t,i,r,n){const a={};let s=r||i.EntityAndAttribute&&i.EntityAndAttribute.EntityName;const o=n||i.EntityAndAttribute&&i.EntityAndAttribute.AttributeName;if(!s&&!o)return null;s||(s="placeholderEtn");if(i.LookupEntityByName)for(const t of i.LookupEntityByName)a[t.EntityLogicalName]=Object(Wt.b)(e,t.EntityLogicalName,i);const l=Object(Wt.c)(e,i);return{type:"update.lookupRequestDataKey",payload:{[s]:{[o]:{metadataKey:l,dataKeys:a}}},meta:{pageId:t}}}(d,r,e,n,s);return S&&l(S),Promise.all(f)}}}var Jt=i("mpSO"),$t=i("F1Lu");var Zt=i("+pAH"),ei=i("wZxB"),ti=i("iB7y");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
let ii,ri,ni,ai;function si(e,t){return{openEditForm:(i,r,n,a,s)=>{const o=Bt(i);e(r?Object(je.a)(o,t.id,void 0,void 0,r,n,a,s):Object(je.a)(o,t.id))},openGridPage:(i,r,n,a,s,o,l,c)=>{e(Object(De.a)(i,t.id,h.a.tryParseOrNull(r),n,a,h.a.tryParseOrNull(s),o,null,c,l))},openCreateForm:(i,r,n)=>{e(Object(Z.d)(new P.a(i),null,"QuickCreate")).then(a=>{e(Object(he.a)(i,t.id,null,r,Bt(n)))}).catch(n=>{e(Object(je.a)(new P.a(i),t.id,void 0,r))})},openSearch:i=>{e(Object(Fe.a)(i,null,t.id))},openPowerBIFullScreenPage:(i,r,n,a,s,o,l)=>{e(Object(Te.a)(t.id,i,r,n,a,s,o,l))},openDashboard:e=>{},openUrl:(e,t)=>{},openUrlWithProtocol:(e,t)=>{},openPhoneNumber:(i,r,n,a,s,o,l,c,u,d=!1,p=!0)=>e(function(e,t,i,r,n,a,s,o,l,c,u=!1,d=!0){return{type:"customcontrol.openphonecall",execute(p,g){let m=e.trim();const f=Object(Ve.D)(p.getState()).defaultCountryCode;m.startsWith("tel:")&&(m=m.slice("tel:".length));let b="tel:"+m;m.match(/^\d/)&&f&&(b="tel:"+f+m);const y=new $t.a(g,p);let v;g.ScriptManager.containerExists(Jt.e)&&(v=g.GlobalCustomEventManager);const S=()=>{if(u){let e=null;const l={};if(t){e=new P.a(i,new h.a(t));const n={id:t,entityType:i,name:r};let c=n;a&&(c={id:a,entityType:s,name:o}),l.phonenumber=m,l.to=[n],l.regardingobjectid=c}return p.dispatch(Object(he.a)("phonecall",n,null,l,e,null,{entityName:"phonecall",showDialog:!0}))}};return y.canOpenUri(b).then(e=>{if(d&&v&&p.dispatch(v.runOnOpenUrl(n,b,c,l)))return null;const t=Object(j.f)(p.getState(),E.S);e?(y.openUri(b),t&&S()):u&&t&&S()},()=>null)},shouldReceiveFullStore:!0}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(i,n,r,a,t.id,o,s,l,c,u,d,p)),openMaps:e=>{},openMap:e=>{}}}var oi=i("Ki7F"),li=i("nJrx"),ci=i("o0iw"),ui=i("llMO");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const di=Object(r.a)(()=>{let e,t={},i=null,r={},n={},a={},s=!1,o="",u=null,d={},p=!1,_="",O=!1,P={stateToPropsMappingError:!1,dynamicData:null,manifest:null,personalizationState:null,propBagData:null,pageType:null,popupStack:null,contextToken:null,portalFlyoutToDialogId:null,designLanguage:null,inactive:!1},w=-1,C=-1;const I=Object(N.a)(),E=Object(V.a)(),j=L(),D=T();return(T,F)=>{var N;S.a.info(F.configuration.CustomControlId+".CustomControlFramework.Selectors.CustomControlHostSelectors: makeMapStateToProps started");const R=q.startStopwatch({controlId:F.controlId,parentId:Object(l.p)(F),level:(0).toString()});let k,A,M,x,L,V=[],B=!1,H=null,Q=null,K=null,X=null,Y=null,J=null,$=null,Z=null,ee=null,te=null,ie=!1,re=null,ne=null,ae=null,se=!1;try{let e=null;F.formInfo?(u&&d.EntityName===F.formInfo.EntityName&&d.RecordId===F.formInfo.RecordId&&d.FormId===F.formInfo.FormId||(u={id:F.formInfo.RecordId?new h.a(F.formInfo.RecordId):null,formId:F.formInfo.FormId?new h.a(F.formInfo.FormId):null,entityTypeName:F.formInfo.EntityName},d=F.formInfo),e=u):e=Object(m.j)(T,F.id),Q=F.descriptor,K=F.configuration,M=Object(f.b)(T),k=Object(m.p)(T,F.id),Object(m.h)(T,F.id)&&(L="DialogContainer__"+F.id),!L&&F.parentDefinedControlProps&&F.parentDefinedControlProps.parentFlyoutId&&(L=F.parentDefinedControlProps.parentFlyoutId),k&&(A=D(T,F));const t=Object(b.nb)(T,F,A);let i=K;if(null!==F.systemDefinedProperties){const e=Object.assign(Object.assign({},K.Parameters),F.systemDefinedProperties);i=Object.assign(Object.assign({},K),{Parameters:e})}if(X=Object(v.e)(T,K.CustomControlId)||Object(v.e)(T,K.Name),!X||!X.ConstructorName){X=null;const e=Object(c.j)(K.CustomControlId);e!==K.CustomControlId&&(X=Object(v.e)(T,e))}X&&(Z=E(T,X,e,t,F.contextHelper),$=Z.response,J=I(i,Q,F,T,e,A),Y=J.response,te=Y&&Y.dataReady?j(T,F,Q,e,A,k):null,ee=Object(y.a)(T,te,X.CustomControlId,F.id));const r=z(T,F.id,F.controlId,A);r&&(ie=r.every(e=>Object(U.b)(T,e))),x=z(T,F.id,F.controlId,A,!0),ne=F.parentDefinedControlProps&&!Object(g.a)(F.parentDefinedControlProps.height)?F.parentDefinedControlProps.height:-1,re=F.parentDefinedControlProps&&!Object(g.a)(F.parentDefinedControlProps.width)?F.parentDefinedControlProps.width:-1,ae=Object(W.b)(T)?Object(W.a)(T):null,se=((e,t,i,r,n)=>Object(m.p)(e,t)===G.b&&!Object(b.Lb)(e,t,i,r,h.a.tryParseOrNull(n)))(T,F.id,A,F.descriptor.Name,null===(N=F.formInfo)||void 0===N?void 0:N.FormId)}catch(e){const t=X.ConstructorName;S.a.error(t+": makeMapStateToProps encountered error, err "+e,[{name:"ApiName",value:"CustomControlFramework.Selectors.CustomControlHostSelectors"},{name:"controlId",value:F.controlId},{name:"customControlId",value:X.CustomControlId},{name:"manifest",value:JSON.stringify(X)},{name:"descriptor",value:JSON.stringify(Q)},{name:"configuration",value:JSON.stringify(K)},{name:"error.Stack",value:JSON.stringify(e.stack)}]),B=!0,H=e.toString()+". Stack: "+e.Stack}return i&&(V=V.concat(((e,t)=>{const i=[];return e.Disabled!==t.Disabled&&i.push("IsControlDisabled"),e.Label!==t.Label&&i.push("Label"),i})(Q,i))),i=F.descriptor,Y!==r||X!==t||$!==n||te!==a||B!==s||k!==o||ie!==p||x!==e||ne!==C||re!==w||L!==_||ae!==P.designLanguage||se!==O?(ne===C&&re===w||V.push("layout"),J&&(V=V.concat(J.updatedProperties)),Z&&(V=V.concat(Z.updatedProperties)),ae!==P.designLanguage&&V.push("design"),P={stateToPropsMappingError:B,stateToPropsMappingErrorMessage:H,dynamicData:Y,manifest:X,personalizationState:ee,propBagData:$,children:K&&K.Children,personalizationConfiguration:te,pageType:k,popupStack:M,contextToken:A,updatedProperties:V,globalCommandManagerInitialized:ie,internalCommandManagerIds:x,portalFlyoutToDialogId:L,designLanguage:ae,inactive:se},p=ie,e=x,_=L,s=B,n=$,t=X,r=Y,a=te,o=k,C=ne,w=re,O=se):P.updatedProperties=V,R({updatedProperties:JSON.stringify(V)}),S.a.info(F.configuration.CustomControlId+".CustomControlFramework.Selectors.CustomControlHostSelectors: makeMapStateToProps finished"),P}},(function(){let e;return function(t,i){if(e)return e;const r=si(t,i);return ii={setNotification:(e,i,r,n,a,s,o)=>t(function(e,t,i,r,n,a,s){return{type:"customcontrol.propertybag.mode.setnotification",execute({dispatch:o,getState:l},c){const u={uniqueId:t||"",messages:[e],priority:0,notificationLevel:Qe.a.error,actions:[{actions:[function(){}],message:""}]};o(Object(He.b)(i,r,u,n));const d=l(),p=new P.a(a,h.a.fromExternalGuid(s)),g=Object(Xe.a)(d,p.etn,r);return p&&g&&(2===g.RequiredLevel||1===g.RequiredLevel)&&o(Object(Ke.b)(i,r,!1,n)),!0},sync:!0}}(e,i,r,n,a,s,o)),clearNotification:(e,i,r,n,a,s)=>t(function(e,t,i,r,n,a){return{type:"customcontrol.propertybag.mode.clearnotification",execute({dispatch:r,getState:n},s){const o=Object(b.C)(n(),{controlName:t,id:e},i);if(o){a=a||"";const n=Object.keys(o);let s=null;for(let l=n.length-1;l>-1;--l)n[l]===a&&(s=o[n[l]],s.actions=null,s.messages=null,s.notificationLevel=null,r(Object(He.b)(e,t,s,i)))}return!0},sync:!0}}(e,i,r,0,0,s))},ni={setState:e=>!0,logMessage:(e,i,r)=>{t(function(e,t,i){return{type:"customcontrol.log",execute({dispatch:r,getState:n},a){const s=a.TraceManager.getTracer("customcontrol"),o=e+": "+t;switch(i){case qe.a.Error:s.error(o);break;case qe.a.Info:s.info(o);break;case qe.a.Warning:s.warn(o);break;case qe.a.Verbose:s.debug(o)}},sync:!0}}(e,i,r))}},ri={isGetBarcodeValueOperationAvailable:()=>t(Object(ke.c)()),isTakePictureOperationAvailable:()=>t(Object(ke.e)()),isCaptureVideoOperationAvailable:()=>t(Object(ke.b)()),isCaptureAudioOperationAvailable:()=>t(Object(ke.a)()),isOpenARViewerAvailable:()=>t(Object(ke.d)())},ai={clearNestedChild:e=>!0,createAccessibilityComponent:Vt.a,createCommandManagerUXComponent:()=>{let e=null;return t=>{const i=gi(t);return fi(e,t.selectedRecords)?i.selectedRecords=e:e=i.selectedRecords,hi(i)}},createKeyboardShortcut:Vt.b,createXrmForm:(e,i,r,n)=>function(e,t,i,r,n){return!!e(Object(Nt.b)(t,i,r,new h.a(n)))}(t,e,i,r,n),createXrmGrid:(e,i,r,n,a)=>{const s=[O.a.AssociatedGrid,O.a.CustomGrid,O.a.SubGrid,O.a.MainGrid];if(e&&-1===s.indexOf(e.contextTokenType))for(const n in r)if("Grid"===r[n].Type||r[n].Type===lt.m){const a=r[n];t(Object(Ce.c)(a.TargetEntityType||a.EntityName,a.ViewId,i,e));break}return function(e,t,i,r,n,a){const s=Object(R.yb)(r);if(t){let r;switch(t.contextTokenType){case O.a.SubGrid:r=3;break;case O.a.AssociatedGrid:r=2;break;case O.a.MainGrid:case O.a.CustomGrid:r=1;break;default:const e=[{name:"contextToken",value:JSON.stringify(t)},{name:"controlName",value:n},{name:"isEditableGrid",value:s}];ue.a.getInstance().eventManager.ReportComponentFailure("ClientApi.XrmCommandObjectWrapper.createXrmGridWrapper",new Error(`Unknown context token type ${t.contextTokenType} for grid. \n\t\t\t\t\tcontrolName: ${t.controlName}, entityTypeName: ${t.entityTypeName}, formId: ${t.formId}.`),null,e),r=1}return!!e(Object(Nt.c)(t,i,s,r,n,a))}return!0}(t,e,i,r,n,a)},registerNewControl:(e,i,r,n)=>function(e,t,i,r,n){return!!e(Object(Nt.e)(t,i,r,n))}(t,e,i,r,n),executeAddOnLoad:(e,i)=>{t(function(e,t){return{type:"customcontrol.executeAddOnLoad.async",sync:!0,execute({dispatch:i,getState:r},n){e.gridRunOnLoad((e,r,a)=>{if(n.ScriptManager.containerExists(e)){const s=n.ScriptManager.getContainer(e).getEventManager();i(s.runOnGridDataLoad(t,1,a,r))}})}}}(e,i))},addSessionTab:(e,i)=>t(function(e,t){return{type:"execute.addsessiontab.async",execute({dispatch:i,getState:r},n){const a=r(),s=Object(Y.d)(a,t);let o=!0;if(e){if(s.forEach(t=>{e.id===t.id&&(o=!1)}),o){if("quickViewFormTab"===e.type){let r=!1;const n=e,o=Object(X.a)(6),l=Object(J.H)(a,n.entityFormOptions.entityName),c="activitypointer";let u;u=a.data.entities[c]&&a.data.entities[c].hasOwnProperty(n.entityFormOptions.entityId)?Object(b.lc)(a,c,new h.a(n.entityFormOptions.entityId)):Object(b.lc)(a,n.entityFormOptions.entityName,new h.a(n.entityFormOptions.entityId));const d=new P.a(n.entityFormOptions.entityName,new h.a(n.entityFormOptions.entityId)),p=[];if(!u){const e=i(Object($.e)(d,[l]));p.push(e)}let g=Object(ee.f)(a,n.entityFormOptions.entityName,o);if(h.a.isNullOrEmpty(g)){const e=i(Object(Z.d)(d,null,o)).then(e=>{g=e,h.a.isNullOrEmpty(g)||g===Z.c||(r=!0)});p.push(e)}else r=!0,n.entityFormOptions.formId=g.guid;Promise.all(p).then(()=>{n.entityFormOptions.formId=r?g.guid:"",n.entityMetadata={DisplayName:a.metadata.entities[n.entityFormOptions.entityName].DisplayName},a.data.entities[c]&&a.data.entities[c].hasOwnProperty(n.entityFormOptions.entityId)?n.title=Object(b.lc)(a,c,new h.a(n.entityFormOptions.entityId)):n.title=Object(b.lc)(a,n.entityFormOptions.entityName,new h.a(n.entityFormOptions.entityId)),s.unshift(n),i(ie({sessionTabs:s,activeTabId:n.id,messageId:r?"":"quick_view_form_not_exist_message"},t))})}else s.unshift(e),i(ie({sessionTabs:s,activeTabId:e.id},t));return Promise.resolve()}i(ie({sessionTabs:s,activeTabId:e.id},t))}}}}(e,i)),closeSessionTab:(e,i)=>t(ae(e,i)),updateSessionTab:(e,i)=>t(ce(e,i)),closeAllSessionTabs:e=>t(ne(e)),dismissMessage:e=>t(se(e)),markActiveTab:(e,i,r)=>t(Object(le.b)(e,i,r)),initializeReferencePanelControl:(e,i)=>t(oe(e,i)),cleanReferencePanelState:e=>t(re(e)),executeNotifyHandlersThatEventOccurred:e=>t(function(e){return{type:"execute.notifyhandlersthatevenoccurred.async",execute({dispatch:t,getState:i},r){let n=null;try{switch(e.eventName){case"onresultopened":t(Object(de.V)(e.contextToken,e.pageId,e.fieldName,e.record));break;case"onselection":t(Object(de.W)(e.contextToken,e.pageId,e.fieldName,e.record));break;case"onpostsearch":t(Object(de.U)(e.contextToken,e.pageId,e.fieldName,e.record));break;case"onlookuptagclick":const a="ClientApi.ExecuteNotifyHandlersThatEventOccurred.runOnLookupTagClick",s=e.contextToken,o=e.fieldName,l=e.record;let c=!1;const u=Object(de.v)(a,i(),r,e.pageId,l);u&&(c=t(u.runOnLookupTagClick(s,o,null,l,i()))),n=c}return Promise.resolve(n)}catch(e){throw ue.a.getInstance().eventManager.ReportComponentFailure("ClientApi.ExecuteNotifyHandlersThatEventOccurred.executeNotifyHandlersThatEventOccurred",e),e}}}}(e)),getConnectorsApi:e=>null,executeRollupRequest:(e,i,r)=>t(function(e,t,i){return{type:"customcontrol.executeRollupRequest.async",execute({dispatch:r,getState:n},a){if(e&&t){const n=new Ae(e,t),s=xe.a.execute(n).then(e=>e.json()).then(n=>{if(n){const s=[];for(const e in n)-1!==e.indexOf("@")||e.startsWith("_")||s.push(e);const o=new P.a(e.entityType,h.a.fromExternalGuid(e.id));return r(Object(Me.a)(i,o,s)).then(()=>{a.EventManager.ReportComponentSuccess(Le.a+".Action",[{name:"APIName",value:Le.a+".Action.ExecuteRollupRequest"},{name:"target.entityType",value:e.entityType}])},i=>{a.EventManager.ReportComponentFailure(Le.a+".Actions",i,"refreshRecordData failure error message",[{name:"APIName",value:Le.a+".Actions.ExecuteRollupRequest"},{name:"target.entityType",value:e.entityType},{name:"target.id",value:e.id},{name:"fieldName",value:t},{name:"jsonResponse",value:n}])})}});return xe.a.Diagnostics.traceInfo(Le.a+".refreshRecordData","refresh record data return promise"),s}return Promise.resolve()}}}(e,i,r)),getResource:e=>t(function(e){return{type:"customcontrol.getresources.async",execute({dispatch:t,getState:i},r){const n=r.AssetLoader,a=i(),s=Object(Ve.x)(a);if(3===e.Type||2===e.Type)return n.loadRawData(s+e.Name)}}}(e)),getRecordSetQueryKey:e=>e?e.getPreviousQueryKey():null,loadResources:e=>t(Object(We.a)(e)),triggerOfflineMetadataSync:()=>t(Object(_e.h)()),retrieveFormWithAttributes:(e,i,r)=>t(Object(jt.c)(new P.a(e),h.a.tryParse(i),r)),loadManifest:(e,i)=>t(Object(Oe.c)(e,i)),updateOutputs:(e,i,r,n,a,s,o)=>t(function(e,t,i,r,n,a,s){return{type:"outputs.update",execute({dispatch:o,getState:l},c){try{const c={},u={};if(a)for(const e of Object.keys(a)){const t=a[e];let i=e;switch(t.fieldName&&(i=t.fieldName),(t.paramType===Mt.a.LookupSimple||t.paramType===Mt.a.LookupCustomer||t.paramType===Mt.a.LookupOwner||t.paramType===Mt.a.LookupRegarding||t.paramType===Mt.a.LookupMultiEntity)&&t.value&&t.value instanceof Array&&(t.value.length>0?t.value=t.value[0]:t.value=null),t.type){case 0:c[i]=a[e];break;case 2:u[i]=a[e]}}const d=new Array,p=o(Object(me.a)(e,c,!1,!1,t,i,n,s));if(d.push(p),Object(B.a)(l(),e).forms){const t=o(Object(kt.b)(e,r,s,u));d.push(t)}else{const t=o(Object(At.b)(e,r,u));d.push(t)}return Promise.all(d)}catch(n){const s=r+" failed at updating its outputs",o=Object(S.b)(l(),r);return c.EventManager.ReportComponentFailure(o+".CustomControl.updateOutputs",n,s,[{name:"APIName",value:Le.a+".Actions.UpdateOutputs"},{name:"customControlId",value:r},{name:"pageId",value:e},{name:"entityTypeName",value:t},{name:"recordId",value:i},{name:"outputs",value:JSON.stringify(a)}]),c.TraceManager.getTracer("customcontrol").warn(o+" failed at updating its outputs"),null}},sync:!0}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(e,i,r,n,a,s,o)),updateFieldValue:(e,i,r,n,a,s,o)=>t(Object(me.a)(e,i,!1,r,n,a,s,o)),runCustomOpenRecord:(e,i,r,n)=>t(function(e,t,i,r){return{type:"record.open",execute(n,a){const s=a.ScriptManager.getContainer(e).getEventManager(),o=new h.a(i),l=Object(_.f)(r,o,t);let c=n.dispatch(Object(Nt.b)(l,e,t,o));return c=new Rt.a(n,a,l,e,t,o),n.dispatch(s.runOnRecordOpen(r,i,c))}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(e,i,r,n)),getBoundFileObject:(e,i,r,n)=>{if(null==e||null==i||null==i.id||null==r)return null;const a={id:new h.a(i.id),etn:i.entityType};return t(Object(Zt.c)(e,a,r,n,"full"))},saveEmbeddedEntity:(e,i,r,n,a,s,o=!1,l)=>t(Object(Ft.b)(e,i,r,n,a,s,o,l)),renderNestedCustomControl:xt.a,renderReactSubtree:Ne.createPortal,retrieveView:(e,i,r,n,a,s,o)=>t(Object(Ie.a)(e,i,r,n,a,s,o)),retrieveViewSelector:(e,i)=>t(Object(Ie.b)(e,i)),retrieveGridData:(e,i)=>t(Object(we.e)(e,i)),retrieveRecordDataForForm:(e,i,r,n,a)=>t(Object($.f)(Bt(e),h.a.tryParse(i),r,n,a)),retrieveForm:(e,i,r)=>{const n=h.a.tryParse(i),a=Bt(e);return t(Object(Z.d)(a,n,r)).then(e=>t(Object(pe.c)(n,a.etn)).then(()=>e))},retrieveEntityData:e=>t(Object(Pe.f)(e,!1,[])),retrieveChartDrilldownAttributes:e=>{return t((i=e,{type:"customcontrol.charts.attributes.retrieve.async",execute:({dispatch:e,getState:t},r)=>e(Object(Pe.f)(i,!0,[])).then(()=>{const e=t(),r=Object(Xe.d)(e,i);if(r&&Object.keys(r).length>0){const t={};for(const n in r){const a=r[n];Ut(e,i,n,a)&&(t[n]=a)}return t}return null},e=>{const t=e.get_message();return r.EventManager.ReportComponentFailure(Le.a+".CustomControl.retrieveChartDrilldownAttributes",new Error(t),t,[{name:"APIName",value:Le.a+".Actions.RetrieveChartDrilldownAttributes"},{name:"Entity",value:i}]),null})}));var i},refreshDataSetParameter:(e,i)=>t(It(e,i)),retrieveLookupMetadataAction:e=>{return t((i=e,{type:"customcontrol.retrieveLookupMetaData.async",execute({dispatch:e,getState:t},r){if(i instanceof Dt.a){const r={retrieveGridDataAction:(t,i)=>e(Object(we.e)(t,i)),retrieveViewAction:(t,i,r,n)=>e(Object(Ie.a)(t,i,r,n)),retrieveViewSelectorAction:(t,i)=>e(Object(Ie.b)(t,i)),runPreSearch:(i,r,n)=>e(Object(de.X)(Object(_.j)(t(),i),i,r,n)),runSetAdditionalParams:(i,r,n)=>e(Object(de.Y)(Object(_.j)(t(),i),i,r,n)),refreshCustomDataProviderAction:(t,i,r,n)=>e(Object(rt.b)(t,i,r,n)),getEntityMetadataAction:(t,i)=>e(Object(Pe.f)(t,!1,i))};return i.retrieveLookupMetadata(t,r)}}}));var i},retrieveDataSetLookupCellParameter:(e,i,r)=>t(function(e,t,i){return{type:"customcontrol.retrieveDataSetLookupCellParameter.async",execute:({dispatch:r,getState:n},a)=>r(It(t,i)).then(()=>t.retrieveDataSetObject(n(),e,a)).catch(e=>{a.EventManager.ReportComponentFailure(Le.a+".Actions",{name:"error",message:e.get_message()},null,[{name:"APIName",value:Le.a+".Actions.RetrieveDataSetLookupCellParameter"}])})}}(e,i,r)),updateControlMemoizedDataSet:(e,i,r)=>t(function(e,t,i){return{type:"customcontrol.updateControlMemoizedDataSet",sync:!0,execute({dispatch:r,getState:n},a){const s=n(),o=e.retrieveDataSetObject(s,null,null,null,a);e.linkToParameter(o,t),e.updateControlMemoizedParameter(s,o,!0,i)}}}(e,i,r)),loadResourceStrings:e=>{return t((i=e,{type:"customcontrol.loadresourcestrings.async",execute({dispatch:e,getState:t},r){const n=i.CustomControlId;if(!n)return Promise.resolve();const a=t(),s=Be.a.getControlsResourceKeyList(n);if(!s)return Promise.resolve();const o=Object(Ue.d)(a);if(!o)return e(Object(ze.e)(s));const l=[];for(const e of s)o.hasOwnProperty(e)||l.push(e);return 0===l.length?Promise.resolve():e(Object(ze.e)(l))}}));var i},retrieveLookupData:(e,i)=>t(Object(we.e)(e,i)),setFieldControlPersonalization:(e,i,r)=>t(Object(Ee.i)(e,i,r)),setGridControlPersonalization:(e,i,r)=>t(Object(Ee.l)(e,i,r)),setDashboardControlPersonalization:(e,i,r)=>t(Object(Ee.h)(e,i,r)),setGenericControlPersonalization:(e,i,r)=>t(Object(Ee.j)(e,i,r)),setGlobalControlPersonalization:(e,i)=>t(Object(Ee.k)(e,i)),setPowerBISignedInState:(e,i)=>t(Object(ge.b)(e,i)),beginSecureSessionForResource:(e,i,r,n)=>t(function(e,t,i,r){return{type:"customcontrol.beginsecuresessionforresource",execute(n,a){const s=new Re.a(a,n);return r?s.beginSecureSessionForResource(e,t,i):s.beginSecureSessionForResourceSilent(e,t,i)},shouldReceiveFullStore:!0}}(e,i,r,n)),setXrmObject:e=>{},addPendingCommandManagerId:(e,i,r,n)=>{let a;t(Object(Tt.a)(e,i,r,n));return{promise:new Promise(e=>{a=e}),resolve:a}},initializeCommandManager:(e,i,r,n,a)=>{let s;t(Object(Tt.b)(e,i,r,n,a));return{promise:new Promise(e=>{s=e}),resolve:s}},retrieveRecordCommand:(e,i,r,n,a,s,o,l,c,u)=>t(Object(Tt.c)(u,e,i,r,n,a,s,o,l,c)),setValue:(e,i,r,n)=>e&&i?t(function(e,t,i,r){const n=[{name:"snapshotId",value:r},{name:"entityTypeName",value:t.etn},{name:"attributeNameValuePairs.length",value:i?Object.keys(i).length:null}];return{type:"control.update.value.by.snapshot.async",execute({dispatch:a,getState:s},o,l){const c=s(),u=Object(_.j)(c,e),d=Object(_.y)(u),p=Object(ye.a)(c,r,t,i,!1,u,o.TraceManager.getTracer("Forms.UpdateValue")),g=h.a.isNullOrEmpty(t.id)?ve.a.Create:ve.a.Update;if(n.push({name:"CorrelationId",value:l.correlationId},{name:"ContextId",value:l.contextId},{name:"ActionStack",value:l.stack},{name:"mode",value:g}),r)return a(Object(fe.b)(c,r,p)),o.EventManager.ReportComponentSuccess("Forms.UpdateValue.updateDataSnapshot",n),Promise.resolve();const m=Object(be.b)(c,t,p,d,g),f=m.payload.snapshotId;return a(m),n.push({name:"newSnapshotId",value:f}),o.EventManager.ReportComponentSuccess("Forms.UpdateValue.createDataSnapshotAction",n),Promise.resolve(f)},getFailureParameters:(e,t)=>n}}(n,e,i,r)).then(e=>e||r):Promise.reject("setValue: entityReference and controlKeyValuePairs parameters are required"),save:(e,i=[])=>t(Object(ti.b)(e,!1,i,null,null,null,1)),openPopup:e=>t(Object(K.a)(e)),closePopup:e=>t(Object(Q.a)(e)),loadWebResource:(e,i)=>t(Object(Ge.a)(e,i)),registerOngoingWork:(e,i,r,n)=>t(function(e,t,i,r){return{type:"customcontrol.registerworkoutstanding",execute:({dispatch:n,getState:a},s)=>(Et.a.getInstance().addWorkOutstandingPromise(e,t,i,r),Promise.resolve())}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(e,i,r,n)),isPresenceEnabledEntity:e=>Object(H.b)(e),getPresenceMappedField:e=>Object(H.a)(e),fireXrmEvent:(e,i,r,n,a)=>{const s=t(Object(Se.b)(i,r));let o=null;if(s&&s.ui&&s.ui.controls&&(o=s.ui.controls.get(e)),o)switch(n){case 0:o.fireOnKeyPress&&o.fireOnKeyPress()}},sendLookupRequest:(e,i,r,n,a,s,o)=>t(Yt(e,!0,i,r,n,a,s,o)),runPreSearch:(e,i,r)=>{t(function(e,t,i){return{type:"CCF.RunPreSearch",execute({dispatch:r,getState:n}){r(Object(wt.f)(i,t,e)),r(Object(de.X)(e,i,t)),r(Object(de.Y)(e,i,t)),r(Object(wt.e)(i,t,e))},sync:!0}}(e,i,r))},runOnReadyStateComplete:(e,i,r)=>{t(function(e,t,i){return{type:"CCF.RunOnReadyStateComplete",execute({dispatch:r,getState:n},a){a.ScriptManager.containerExists(t)&&r(a.ScriptManager.getContainer(t).getEventManager().runOnReadyStateComplete(e,null,i))},sync:!0}}(e,i,r))},retrieveLookupRecordsBySearchString:(e,i,r)=>t(Object(ei.a)(e,i,r)),retrieveLookupRecordsByIds:(e,i,r)=>t(Object(ei.b)(e,i,r)),retrievePersonaInfo:e=>{const i=new P.a("systemuser",new h.a(e));return t(Object($.e)(i,["entityimage_url","internalemailaddress","azureactivedirectoryobjectid"]))},usePresenceStatus:e=>Object(Lt.a)(e),useProfilePhoto:e=>Object(Lt.b)(e),updateGridPageNumber:(e,i,r)=>{t(dt(e,i,r))}},e={actions:ai,propBagMethods:{utils:ni,navigation:r,device:ri,mode:ii}},e}}))(s.a);class pi extends a.Component{constructor(e,t){super(e),this._updateCounter=0,this._isUpdateScheduled=!1,this._reRunMapStateToProps=()=>{this._isUpdateScheduled||(this._isUpdateScheduled=!0,Object(ui.c)(()=>{this._isUpdateScheduled=!1,this._updateCounter++,this.forceUpdate()}))},this._reRunMapStateToProps=this._reRunMapStateToProps.bind(this)}render(){let e=null,t=null;return this.context&&this.context.CustomControlGlobalHelper&&(e=this.context.CustomControlGlobalHelper,t=this.context.TraceManager.getLogLevel()),a.createElement(o.a.Provider,{value:this.context},a.createElement(di,Object.assign({},this.props,{contextHelper:e,logLevel:t,updateCounter:this._updateCounter,reRunMapStateMainProps:this._reRunMapStateToProps})))}}function hi(e){const t="cm"+Object(li.a)();return a.createElement(oi.a,{commandbarDisplayMode:e.commandbarDisplayMode,addedCommandList:e.addedCommandList,key:e.key,iconPosition:e.iconPosition,id:e.id,commandManagerId:e.commandManagerId||t,ribbonId:e.ribbonId,selectedRecords:e.selectedRecords,width:e.width,metaDataLoadedResolve:e.metaDataLoadedResolve,isHidden:e.isHidden,commandBarStyle:e.commandBarStyle,customCommandManagerStyle:e.customCommandManagerStyle,contextToken:e.contextToken,rootZIndex:e.rootZIndex,customControlType:e.customControlType,skipPageXrmReady:e.skipPageXrmReady,initializationCompletedCallback:e.initializationCompletedCallback})}function gi(e){return{commandbarDisplayMode:void 0!==e.commandbarDisplayMode&&null!==e.commandbarDisplayMode?e.commandbarDisplayMode:ci.a.IconLabel,id:e.id,commandManagerId:e.commandManagerId,ribbonId:e.ribbonId,mainMenuLength:e.mainMenuLength,iconPosition:e.iconPosition,selectedRecords:mi(e.selectedRecords),key:e.key,commandBarStyle:e.commandBarStyle,customCommandManagerStyle:e.customCommandManagerStyle,isHidden:e.isHidden,width:e.width,metaDataLoadedResolve:e.metaDataLoadedResolve,addedCommandList:e.addedCommandList,contextToken:e.contextToken,rootZIndex:e.rootZIndex,customControlType:e.customControlType,skipPageXrmReady:e.skipPageXrmReady,initializationCompletedCallback:e.initializationCompletedCallback}}function mi(e){const t=[];if(e)for(const i of e)t.push(Bt(i));return t}function fi(e,t){if(e===t)return!0;if(e&&t&&e.length===t.length){const i=e.length;for(let r=0;r<i;r++)if(e[r]!==t[r])return!1;return!0}return!1}pi.contextType=n.a},"2ciq":function(e,t,i){"use strict";i.d(t,"d",(function(){return m})),i.d(t,"c",(function(){return b})),i.d(t,"a",(function(){return f})),i.d(t,"b",(function(){return y}));var r=i("izYK"),n=i("Xd5/"),a=i("q6Ks"),s=i("IqkD"),o=i("LbMF"),l=i("WPtp"),c=i("dHD5"),u=i("odYE"),d=i("tJdb"),p=i("Ae6N"),h=i("5Oca"),g=i("jq7Z");function m(e,t,i,a,s,c,p,g,m){switch(a){case r.a.WholeTimeZone:return function(e,t){const i={},r=t.timeZoneDefinitionByCode;for(const e in r)if(r.hasOwnProperty(e)){const a=r[e];i[a.timeZoneCode]=n.v(a.timeZoneCode,t)}return e.TimeZoneByCode=i,e}(e,i);case r.a.WholeLanguage:return function(e,t,i){const r={},a=t.enabledLanguages;for(let e=0;e<a.length;e++){const t=a[e];r[t]=n.m(t,i)}return e.LanguageByCode=r,e}(e,t,s)}return c===d.a.Rollup?function(e,t,i,r){const a=Object(o.d)(t,i),s="_date",c="_state",d=new u.a(i,r),p=a[e.LogicalName];let g=p.LogicalName;p.IsBaseCurrency&&(g=g.substring(0,g.length-5));const m=Object(l.c)(Object(h.j)(t,d,g+s)),f=Object(l.c)(Object(h.j)(t,d,g+c)),b=Object(o.a)(t,i,e.LogicalName),y=n.A(t,b);return e.lastUpdatedValue=m?n.a(m,"date",y.cultureInfo,y):new Date(m),e.rollupStateValue=Number(f),e.rollupStateField=g+c,e.lastUpdatedField=g+s,e.calculatedFieldValid=!1,e.rollupValid=!0,e.recalculate=null,e}(e,p,g,m):e}function f(e,t,i,r,n){let a=!1;const s=new u.a(t,i),o=Object(h.D)(e,n,s,r.lastUpdatedField),l=Object(h.D)(e,n,s,r.rollupStateField);return(o>r.lastUpdatedValue||l!==r.rollupStateValue)&&(r.lastUpdatedValue=o,r.rollupStateValue=l,a=!0),a}function b(e,t,i,r,l,u){const d=e.formatted,h=Object(s.x)(t);let m=p.a.UserLocal;const f=Object(a.c)()(t).response;if(!f.formatInfoCultureName||!f.numberFormatInfo||!f.dateTimeFormatInfo)return d;const b=new Sys.CultureInfo(f.formatInfoCultureName,f.numberFormatInfo,f.dateTimeFormatInfo),y=Object(c.y)(u),v=Object(g.a)(t,i.id);if(!(v&&v.metadata&&v.metadata[y]&&v.metadata[y].attributes&&v.metadata[y].attributes[l]&&v.metadata[y].attributes[l].Format))return d;const S=Object(o.a)(t,u.entityTypeName,l),_=n.A(t,S),O=v.metadata[y].attributes[l].Format;let P=e.value;if(_.controlAttributes.Behavior===p.a.TimeZoneIndependent||_.controlAttributes.Behavior===p.a.DateOnly){m=p.a.None;const t=new Date(e.value);P=new Date(t.getTime()+6e4*t.getTimezoneOffset())}else P=n.E(d,_,b,_.controlAttributes.Format);return n.i(P,h,b,O,m)}function y(e,t){const i=e.Parameters[t];if(3===i.Usage){const e=i.Attributes;return e.LogicalName||e.EntityLogicalName}return i.Value}},"35be":function(e,t,i){"use strict";i.d(t,"a",(function(){return O}));var r=i("SAYH"),n=i("Nb1E"),a=i("odYE"),s=i("NM3A"),o=i("nzu+"),l=i("YxC/"),c=i("XvLr"),u=i("P6DH"),d=i("BFlg"),p=i("bZIe"),h=i("ruPX"),g=i("d0w6"),m=i("9egp"),f=i("hBJV"),b=i("jAuy"),y=i("p/Kg"),v=i("arV0"),S=i("9V+K");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const _=d.N+".saveFilterToPersonalView";function O(e,t){return{type:"save.filter.to.peronalview",execute({dispatch:i,getState:o},l){const c=Object(u.kb)(o(),e,t),d=o();if(c&&c.ViewId){const h=r.a.parse(c.ViewId),g=[];g.push({name:"ViewId",value:c.ViewId});const m=Object(u.tb)(d,h,e),O=Object(v.j)(d,e);if(m&&m.isUserView){const v=Object(b.k)(Object(u.B)(d,t,{id:e})),w=new a.a(s.b,h),C={};return C.fetchxml=v,Object(u.wb)(o())&&(C.layoutxml=Object(S.a)(m.grid)),i(Object(n.f)(w,C)).then(()=>{l.EventManager.ReportComponentSuccess(_+".ViewUpdated"),i(Object(f.a)()).then(()=>{var t;(null==O?void 0:O.pageToEditedViewMapId)&&i(Object(y.c)(null===(t=null==O?void 0:O.pageToEditedViewMapId)||void 0===t?void 0:t.guid,h.guid)),P(o(),i,h,c.TargetEntityType,e)}).catch(t=>{g.push({name:"Message",value:t.Message}),g.push({name:"ViewId",value:r.a.toString(h)}),g.push({name:"TargetEntityType",value:c.TargetEntityType}),l.EventManager.ReportComponentFailure(_+".RetrieveMetadataVersion","Failed to retrieve updated metadata version before calling navigateTo",null,g),P(o(),i,h,c.TargetEntityType,e)})}).catch(t=>{g.push({name:"Message",value:t.Message}),l.EventManager.ReportComponentFailure(_,"Odata retrieve failed",null,g),Object(p.a)(i,o(),e)})}return l.EventManager.ReportComponentFailure(_,"View Descriptor is null or view is not user View",null,g),l.EventManager.ReportComponentFailure(_,"wrong view type",null,g),Object(p.a)(i,o(),e),Promise.reject("wrong view type")}l.EventManager.ReportComponentFailure(_,"selected View is null",null,null),Object(p.a)(i,o(),e)}}}function P(e,t,i,r,n){const a={};a.viewId=i,a.entityTypeName=r,a.viewType=g.b.userview,t(Object(h.a)(m.a.getName(),a,n)).then(()=>t(Object(o.a)(Object(l.b)(e,c.CRM_FILTER_SAVED),{},n)))}},"49Nd":function(e,t,i){"use strict";i.d(t,"g",(function(){return r})),i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a})),i.d(t,"c",(function(){return s})),i.d(t,"d",(function(){return o})),i.d(t,"f",(function(){return l})),i.d(t,"e",(function(){return c})),i.d(t,"j",(function(){return u})),i.d(t,"h",(function(){return d})),i.d(t,"i",(function(){return p})),i.d(t,"k",(function(){return h}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="Grid_Paging_Mask",n="Grid_StatusMessage_Mask",a="Grid_ItemsSelected_Mask",s="Grid_TotalCount_Mask",o="Grid_ToolTip_FirstPage",l="Grid_ToolTip_PreviousPage",c="Grid_ToolTip_NextPage",u="Grid_TotalCount_SpaceMask",d="Grid_TotalCount_Approximate",p="Grid_TotalCount_Exact",h=[r,n,a,s,o,l,c,u,d,p]},"4DTG":function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class r{constructor(e,t,i,r,n,a){Object.assign(this,e),this.getViewId=()=>t,this.getTargetEntityType=()=>r,this.getTitle=()=>i,this.addColumn=n,this.entityDisplayCollectionName=a}refresh(){throw new Error("Not Replaced")}getViewId(){throw new Error("Not Replaced")}getTargetEntityType(){throw new Error("Not Replaced")}setSelectedRecordIds(e){throw new Error("Not Replaced")}getSelectedRecordIds(){throw new Error("Not Replaced")}clearSelectedRecordIds(){throw new Error("Not Replaced")}retrieveRecordCommand(e,t,i,r,n){throw new Error("Not Replaced")}openDatasetItem(e){throw new Error("Not Replaced")}getTitle(){throw new Error("Not Replaced")}addColumn(e,t){throw new Error("Not Replaced")}getCellImageInfo(e,t){throw new Error("Not Replaced")}}},"5UPV":function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var r=i("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const n="dataset.set.newPageRequested";function a(e,t,i){const a=Object(r.z)(t),s=Object(r.w)(t);return{type:n,payload:i,meta:{pageId:e,contextKey:a,dataSetContextKey:s}}}},"5ipV":function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var r=i("4DTG");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class n extends r.a{constructor(e,t,i,r){super(e,t,i,r),Object.assign(this,e)}selectView(e){throw new Error("Not wrapped")}getRecentItems(){throw new Error("Not Replaced")}getLookupConfiguration(){throw new Error("Not Replaced")}getAllViews(){throw new Error("Not Replaced")}getDataSetParameter(e,t){throw new Error("Not Replaced")}getDefaultViewId(e){throw new Error("Not Replaced")}setMyRecordsOnlyFilter(e){throw new Error("Not Replaced")}sendLookupRequest(e,t,i,r,n){throw new Error("Not Replaced")}runPreSearch(){throw new Error("Not Replaced")}usePresenceStatus(e){throw new Error("Not Replaced")}useProfilePhoto(e){throw new Error("Not Replaced")}setRelatedFilter(e){throw new Error("Not Replaced")}}},"7+p5":function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var r=i("Lyxw"),n=i("3/02"),a=i("IqkD");function s(e){if(Object(r.f)(e,n.Ib)){return!!Object(r.e)(e,n.e,n.jf)||1033===Object(a.s)(e)}return!1}},"7fV9":function(e,t,i){"use strict";i.d(t,"b",(function(){return Se})),i.d(t,"c",(function(){return _e})),i.d(t,"a",(function(){return Oe}));var r=i("SAYH"),n=i("WPtp"),a=i("+QYJ"),s=i("8a7L"),o=i("izYK");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class l{constructor(e,t,i,r,n=!1){this.getValue=this.getValue.bind(this),this.getFormattedValue=this.getFormattedValue.bind(this),this._record=e,this._columnAliasNameMap=t,this._getColumns=r,this._setAttributesByAliasMap(),this._primaryFieldName=i,this._isDirty=n}getRecordId(){return r.a.toString(this._record.identifier.id)}getNamedReference(){if(this._entityReference)return this._entityReference;let e=this._record.identifier.name;e||(e=this.getFormattedValue(this._primaryFieldName));const t=this._record.fields.activitytypecode,i=t?t.value:this._record.identifier.etn;return this._entityReference=new s.a(i,this._record.identifier.id.guid,e),this._entityReference}_setAttributesByAliasMap(){const e={};let t;for(t in this._columnAliasNameMap)e[t]=this.getValue(t);Object.assign(this,e)}_getColumnDataType(e){let t;const i=a.b(this._columnAliasNameMap[e])?e:this._columnAliasNameMap[e],r=this._getColumns().find(e=>e.name===i);return r&&(t=r.dataType),t}getValue(e){if(a.b(e))return null;a.b(this._columnAliasNameMap[e])||(e=this._columnAliasNameMap[e]);const t=this._getColumnDataType(e);if(t===o.a.File||t===o.a.Image)return this.getFileObject(e);const i=this._record.fields[e];return a.c(i)?null:i.validationResult.isValueValid?Object(n.e)(i):i.validationResult.userInput}getFileObject(e){return console.log("This hasn't been replaced yet"),null}getFormattedValue(e){throw new Error("Not Linked")}setValue(e,t){throw new Error("Not Linked")}save(e){throw new Error("Not Linked")}isDirty(){return this._isDirty}isRecordValid(){for(const e in this._record.fields)if(!this.isValid(e))return!1;return!0}isEditable(e){throw new Error("Not Linked")}isSecured(e){throw new Error("Not Linked")}isReadable(e){throw new Error("Not Linked")}isValid(e){return!(this._record&&this._record.fields&&this._record.fields[e]&&this._record.fields[e].validationResult)||this._record.fields[e].validationResult.isValueValid}getValidationError(e){return this._record&&this._record.fields&&this._record.fields[e]&&this._record.fields[e].validationResult?this._record.fields[e].validationResult.errorMessage:null}getFieldRequiredLevel(e){throw new Error("Not Linked")}reformatValue(e){return""}getCurrencyDecimalPrecision(e){throw new Error("Not Linked")}getPersonaInfo(e){throw new Error("Not Linked")}usePresenceStatus(e){throw new Error("Not Linked")}useProfilePhoto(e){throw new Error("Not Linked")}}var c=i("JwRZ");class u{constructor(){this.getConvertedFilter=this.getConvertedFilter.bind(this),this.getFilter=this.getFilter.bind(this),this.setFilter=this.setFilter.bind(this),this.clearFilter=this.clearFilter.bind(this)}retrieveDataSetFiltering(){return{getFilter:this.getFilter.bind(this),setFilter:this.setFilter.bind(this),clearFilter:this.clearFilter.bind(this),aliasMap:Object.freeze(Object.assign({},this._columnAliasMapWithColumns)),canDisableRelationshipFilter:()=>!1}}setColumnAliasMapWithColumns(e){this._columnAliasMapWithColumns=e}extendColumnAliasMapWithColumns(e){this._columnAliasMapWithColumns&&e?Object.keys(e).forEach(t=>{t in this._columnAliasMapWithColumns||(this._columnAliasMapWithColumns[t]=e[t])}):this._columnAliasMapWithColumns=e}getColumnAliasMapWithColumns(){return this._columnAliasMapWithColumns}getRootFilterExpression(){return this._rootFilterExpression}calculateFilterExpression(){this._rootFilterExpression=Object(c.n)(this._existedFilterExpression,this._columnAliasMapWithColumns)}convertFilter(e){if(!e)return null;if(!this._columnAliasMapWithColumns||!Object.keys(this._columnAliasMapWithColumns).length)return e;const t=[],i=[];for(const i in e.conditions){const r=this._columnAliasMapWithColumns[e.conditions[i].attributeName]||e.conditions[i].attributeName;t.push(Object.assign(Object.assign({},e.conditions[i]),{attributeName:r}))}const r={conditions:t,filterOperator:e.filterOperator};for(const t in e.filters)i.push(this.convertFilter(e.filters[t]));return i.length&&(r.filters=i),r}getConvertedFilter(){return this._convertedFilterExpression}getFilter(){return this._existedFilterExpression}setFilter(e){this._convertedFilterExpression=this.convertFilter(e),this._existedFilterExpression=e}clearFilter(){this._existedFilterExpression=null,this._convertedFilterExpression=null,this._rootFilterExpression=null}getClientApiFilterTimeStamp(){return this._clientApiFilterTimeStamp}setClientApiFilterTimeStamp(e){this._clientApiFilterTimeStamp=e}}var d=i("YPtO");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class p{constructor(e=1,t=1,i=!1,r=!1,n=0,a=25){this._currentPageFirstIndex=1,this._currentPageLastIndex=1,this._hasNextPage=!1,this._hasPreviousPage=!1,this._pageSize=25,this._totalResultCount=0,this._pagingSizeSettingSource=0,this._lastPageSizeFromView=-200,this._lastPageSizeFromParentPagingInput=-200,this.reset=this.reset.bind(this),this._currentPageFirstIndex=e,this._currentPageLastIndex=t,this._hasNextPage=i,this._hasPreviousPage=r,this._totalResultCount=n,this._pageSize=a}retrieveDataSetPaging(){const e=this._currentPageFirstIndex===this._currentPageLastIndex?this._currentPageFirstIndex:-100;return{pageNumber:e,totalResultCount:this._totalResultCount,firstPageNumber:e,lastPageNumber:e,pageSize:this._pageSize,setPageSize:this.setPageSize.bind(this,1),hasNextPage:this._hasNextPage,hasPreviousPage:this._hasPreviousPage,loadNextPage:null,loadPreviousPage:null,reset:null,loadExactPage:null}}reset(){this._currentPageFirstIndex=1,this._currentPageLastIndex=1}getPageFirstIndex(){return this._currentPageFirstIndex}getPageLastIndex(){return this._currentPageLastIndex}getHasNextPage(){return this._hasNextPage}getHasPreviousPage(){return this._hasPreviousPage}getPageSize(){return this._pageSize}setPageFirstIndex(e){this._currentPageFirstIndex=e}setPageLastIndex(e){this._currentPageLastIndex=e}setHasNextPage(e){this._hasNextPage=e}setHasPreviousPage(e){this._hasPreviousPage=e}setPageSize(e,t){switch(this._pageSize=t,this._pagingSizeSettingSource=e,e){case 1:break;case 2:this._lastPageSizeFromParentPagingInput=t;break;case 3:this._lastPageSizeFromView=t}}setTotalResultCount(e){this._totalResultCount=e}getLastPageSizeFromParentPagingInput(){return this._lastPageSizeFromParentPagingInput}getLastPageSizeFromView(){return this._lastPageSizeFromView}getPagingSizeSettingSource(){return this._pagingSizeSettingSource}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class h{constructor(){this._previousSortingArray=[],this._currentSortingArray=[],this.retrieveDataSetSorting=this.retrieveDataSetSorting.bind(this),this.getCurrentSortingArray=this.getCurrentSortingArray.bind(this),this.setColumnAliasMap=this.setColumnAliasMap.bind(this),this.extendColumnAliasMap=this.extendColumnAliasMap.bind(this)}retrieveDataSetSorting(){return this._currentSortingArray}getCurrentSortingArray(){return this._currentSortingArray}setColumnAliasMap(e){this._columnAliasMap=e}extendColumnAliasMap(e){this._columnAliasMap&&e?Object.keys(e).forEach(t=>{t in this._columnAliasMap||(this._columnAliasMap[t]=e[t])}):this._columnAliasMap=e}getValidSortingArray(){return this._previousSortingArray}updateSortingArrays(){let e=!1;e=Object(c.e)(this._currentSortingArray,this._previousSortingArray),e&&(this._previousSortingArray=Object(c.t)(this._currentSortingArray,this._columnAliasMap))}}var g=i("IqkD"),m=i("2SCk"),f=i("5Oca"),b=i("vNXc"),y=i("eXjw"),v=i("4DTG"),S=i("d0w6"),_=i("Uv1Y"),O=i("bT7G"),P=i("LbMF"),w=i("lEp6"),C=i("aFKs"),I=i("sozv"),E=i("i1f0"),j=i("+aBC"),D=i("arV0"),T=i("P6DH"),F=i("00VO"),N=i("fILV"),R=i("iZ7K"),k=i("odYE"),A=i("jRy5"),M=i("dHD5"),x=i("NjDY"),L=i("Z/4N"),V=i("5ZBI"),B=i("Xd5/"),z=i("YxC/"),U=i("504W"),W=i("uNu9"),G=i("pGYJ"),q=i("R5Qn"),H=i("Lyxw"),Q=i("3/02"),K=i("YGjz"),X=i("CB5L"),Y=i("69Qu"),J=i("2ciq"),$=i("4leG"),Z=i("g03H"),ee=i("s/8p"),te=i("x8sc");function ie(e,t,i){const r=Object(te.a)(t,["/","*"])+"([\\S\\s]*)"+Object(te.a)(i,["/","*"]),n=new RegExp(r,"i"),a=e.match(n);return a&&a.length>0?a[1]:null}function re(e,t){if(!e||!t)return null;const i=e.replace(/\sorder\s+by\s[\s\S]*$/i,"").match(/(select(?:[\s\S]*?))(?:where\s+([\s\S]*))?$/i);if(!i)return null;const r=i[1];if(!r)return null;const n=i[2],a=function(e){return/^\s*with\s/i.test(e)?function(e){const t=new RegExp(/(with[\s\S]*__QuickFindInternal__\]\))/i.source+"[\\s\\S]*"+/\swhere\s([\s\S]+\[__QuickFind__\]\))/i.source+"(?:[\\s\\S]*?)"+/(\s+order\s+by\s+(?:[\s\S]*?))?$/i.source,"i"),i=e.match(t);if(!i)return null;const r=i[1];if(!r)return null;const n=i[2];if(!n)return null;const a=i[3];return{with:r,in:n,orderBy:a}}(e):function(e){const t=/(\sorder\s+by\s+(?:[\s\S]*?))?$/i,i=e.match(t)[1];i&&(e=e.substring(0,e.indexOf(i)));const r=/^\s*select\s(?:[\s\S]*?)\sfrom\s(?:[\s\S]*?)where\s([\s\S]+)$/i,n=e.match(r)[1];if(!n)return null;return{in:n,orderBy:i}}(e)}(t),s=n?`(${n}) and (${a.in})`:a.in;return`${a.with||""} ${r} where ${s} ${a.orderBy||""}`}var ne=i("37s6"),ae=i("jAuy"),se=i("jq7Z"),oe=i("/Zy9"),le=i("RREX"),ce=i("8nT0"),ue=i("fYtF"),de=i("z+5+"),pe=i("fh2P"),he=i("TFb5"),ge=i("BFlg"),me=i("JMHu"),fe=i("t4Ha"),be=i("n3bs");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const ye="MscrmControls.FieldControls.SimpleLookupControl",ve="MscrmControls.FieldControls.AdvancedLookupControl",Se="dataset",_e="dataset_recordid_";class Oe{constructor(e,t=null,i){this._rerunMapStateToPropsTaskId=-1,this._shouldApplyContextFilter=!1,this.dataSetClass=0,this._viewBasedLinkedEntitiesKeys=[],this.previousDataSetParameter=null,this.previousEmptyParameter=null,this._previousDataSetRecords=null,this.previousRecords=null,this.previousSubParametersDefinition={sortingInput:null,filteringInput:null,extraFilters:null,pagingInput:null,refreshInput:null,linkingInput:null},this.previousSubParametersInput={sortingInput:null,filteringInput:null,extraFilters:null,pagingInput:null,refreshInput:null,linkingInput:null},this.previousAppliedSubParametersInput={sortingInput:null,filteringInput:null,extraFilters:null,pagingInput:null,refreshInput:null,linkingInput:null},this.previousOwnProps=null,this.linkedEntityParsed=!1,this.memoizedCurrentViewId=null,this.dataRequestedOnce=!1,this.dataFirstTimeSentAcknowledged=!1,this.forceApplyDataSetInputReturnNone=!1,this.firstDataRequestType=0,this.dataRequestedByControlInitialization=!0,this.previousInitState=y.a.Uninitialized,this._previousQueryKey=null,this._memoizedAdditionalColumnsInfo=null,this._memoizedViewColumnsInfo=null,this._memoizedAllColumnsInfo=null,this._additionalColumns=[],this._dataProvider=null,this._previousDataProviderReturn=null,this._selectedRecordIds=[],this._snapShotIdMap={},this.refreshingStatus=0,this._updatedDataSetPropertiesForLegacy={},this._updatedDataSetProperties={},this._queryBuilderForPaging=null,this.columnsForEmptyDataset=null,this._initialDataSetFetchEnabled=!0,this.entityLogicalNameFromView="",this._dataProviderRetrieveAction=0,this.extraFilters=[],this.lookupCustomFilters=[],this.viewIdDocumentDic={},this.isColumnFirstMetadataReady=!1,this._initialPageNumber=-1,this._relatedFilterEnabled=!0,this.meFilterEnabled=!1,this.gridRunOnLoad=this.gridRunOnLoad.bind(this),this.loadNextPage=this.loadNextPage.bind(this),this.loadExactPage=this.loadExactPage.bind(this),this.loadPreviousPage=this.loadPreviousPage.bind(this),this.resetPaging=this.resetPaging.bind(this),this.loadSpecificPage=this.loadSpecificPage.bind(this),this.addColumn=this.addColumn.bind(this),this.propKey=e,this.filteringObj=new u,this.linkedEntitiesObj=new d.a,this.pagingObj=new p,this.sortingObj=new h,this.previousDataSetDefinition=t,this._fieldDataSelector=Object(I.a)(),this.contextToken=i,this._additionalColumns=[]}getPreviousQueryKey(){return this._previousQueryKey}getLatestData(){return this.previousDataSetParameter}getUpdateFlag(){return this._needToRunLoad}getPropKey(){return this.propKey}setLookupDataSetAttributes(e,t){this._shouldApplyContextFilter=e,this._parentRecordContext=t}setRelatedFilter(e){this._relatedFilterEnabled=e}setSelectedRecordIds(e){var t;if(this._isNewSelection(e)&&(this._selectedRecordIds=[...e],this.previousDataSetDefinition.onRecordsSelected&&this.previousDataSetDefinition.onRecordsSelected(this._selectedRecordIds),this._rerenderOnSelectionChange)){let e=me.a;this._isPrimaryDataSet||(e=`${this.propKey}_${e}`),this.setUpdatedPropertiesDic(e),this.setLegacyUpdatedPropertiesDic(e),null===(t=this.reRenderControlAction)||void 0===t||t.call(this)}}getSelectedRecordIds(){const e=[];if(this._previousDataSetRecords)for(const t in this._selectedRecordIds)this._previousDataSetRecords[this._selectedRecordIds[t]]&&e.push(this._selectedRecordIds[t]);else if(this._previousDataProviderReturn)for(const t of this._previousDataProviderReturn){const i=t.getRecordId();this._selectedRecordIds.includes(i)&&e.push(i)}return e.length!==this._selectedRecordIds.length&&(this._selectedRecordIds=e),this._selectedRecordIds}clearSelectedRecordIds(){return this.setSelectedRecordIds([])}_isNewSelection(e=[]){var t;return!Object(fe.a)(null!==(t=this._selectedRecordIds)&&void 0!==t?t:[],e)}getParameterManifestType(){return o.a.Grid}getCurrentSnapshotIdMap(){return this._snapShotIdMap}clearCurrentSnapshotIdMap(){this._snapShotIdMap={}}getLinkedEntitiesObj(){return this.linkedEntitiesObj}isParameterOfDataSetType(e){return!!e&&e.Type===this.getParameterManifestType()}getRelationshipNameFromParameter(e){return e?e.RelationshipName:null}getLegacyUpdatedPropertiesDic(){return this._updatedDataSetPropertiesForLegacy}clearLegacyUpdatedPropertiesDic(){this._updatedDataSetPropertiesForLegacy={}}setLegacyUpdatedPropertiesDic(e){Object.assign(this._updatedDataSetPropertiesForLegacy,{[e]:!0})}getUpdatedPropertiesDic(){return this._updatedDataSetProperties}clearUpdatedPropertiesDic(){this._updatedDataSetProperties={}}setUpdatedPropertiesDic(e){Object.assign(this._updatedDataSetProperties,{[e]:!0})}getBoundEntityRecordId(e,t){if(t&&t.formInfo&&t.formInfo.RecordId)return new r.a(t.formInfo.RecordId);const i=Object(se.a)(e,t.id);let n=null;return i&&(n=i.input,n)?n.id:null}getBoundEntityName(e,t){if(t&&t.formInfo&&t.formInfo.EntityName)return t.formInfo.EntityName;const i=Object(se.a)(e,t.id);let r=null;return i&&(r=i.input,r)?r.entityTypeName:null}savePreviousOwnProps(e){this.previousOwnProps=e}retrievePropertyParameter(e,t,i,r,n,a){const s=Object.assign(Object.assign({},i),{Parameters:{[a]:n}});return this._fieldDataSelector(a,e,t,s,r,this.contextToken)}getPropertyParameterValue(e){return e&&e.raw}updatePreviousDataSetParameterDefinition(e,t){var i,r;Object(c.y)(this.previousDataSetDefinition,e)&&(this._isColumnsetChanged=!0),this.previousDataSetDefinition=e,this._dataProvider=e.DataProvider?e.DataProvider:null,this._dataProvider&&0!==this._dataProviderRetrieveAction&&(this._dataProviderRetrieveAction=1),e.FirstDataRequestType?this.firstDataRequestType=e.FirstDataRequestType:a.c(t)||(this._initialDataSetFetchEnabled=Object(me.c)(t,null===(i=this.previousOwnProps)||void 0===i?void 0:i.configuration,this.propKey),this._initialDataSetFetchEnabled||(this.firstDataRequestType=1)),a.c(t)||(this._rerenderOnSelectionChange=Object(H.f)(t,Q.qg),this._isPrimaryDataSet=Object(me.d)(t,null===(r=this.previousOwnProps)||void 0===r?void 0:r.configuration,this.propKey)),this.previousDataSetDefinition.LinkingInput?this.previousSubParametersDefinition.linkingInput=Object.assign(Object.assign({},this.previousDataSetDefinition.LinkingInput),{Usage:1}):this.previousSubParametersDefinition.linkingInput=null,this.previousDataSetDefinition.SortingInput?this.previousSubParametersDefinition.sortingInput=Object.assign(Object.assign({},this.previousDataSetDefinition.SortingInput),{Usage:1}):this.previousSubParametersDefinition.sortingInput=null,this.previousDataSetDefinition.FilteringInput?this.previousSubParametersDefinition.filteringInput=Object.assign(Object.assign({},this.previousDataSetDefinition.FilteringInput),{Usage:1}):this.previousSubParametersDefinition.filteringInput=null,this.previousDataSetDefinition.ExtraFilters?this.previousSubParametersDefinition.extraFilters=this.previousDataSetDefinition.ExtraFilters.slice(0):this.previousSubParametersDefinition.extraFilters=null,this.previousDataSetDefinition.PagingInput?this.previousSubParametersDefinition.pagingInput=Object.assign(Object.assign({},this.previousDataSetDefinition.PagingInput),{Usage:1}):this.previousSubParametersDefinition.pagingInput=null,this.previousDataSetDefinition.RefreshInput?this.previousSubParametersDefinition.refreshInput=Object.assign(Object.assign({},this.previousDataSetDefinition.RefreshInput),{Usage:1}):this.previousSubParametersDefinition.refreshInput=null}getSubParameterValues(e,t,i,r){let n=!1,s=null,o=null,l=null,c=null,u=null,d=null;if(this.previousSubParametersDefinition.linkingInput){const a=this.getPropertyParameterValue(this.previousSubParametersInput.linkingInput),s=this.retrievePropertyParameter(e,t,i,r,this.previousSubParametersDefinition.linkingInput,"linking"),o=this.getPropertyParameterValue(s);a===o||!Object(w.a)(o)&&null!=o?d=this.previousSubParametersInput.linkingInput:(d=s,n=!0)}if(this.previousSubParametersDefinition.sortingInput){const a=this.getPropertyParameterValue(this.previousSubParametersInput.sortingInput),o=this.retrievePropertyParameter(e,t,i,r,this.previousSubParametersDefinition.sortingInput,"sorting"),l=this.getPropertyParameterValue(o),c=Object(w.a)(l);a!==l&&c?(s=o,Object(m.b)(this.sortingObj.getValidSortingArray(),c)?(this.previousSubParametersInput.sortingInput=o,this.previousAppliedSubParametersInput.sortingInput=o):n=!0):s=this.previousSubParametersInput.sortingInput}if(this.previousSubParametersDefinition.filteringInput){const a=this.getPropertyParameterValue(this.previousSubParametersInput.filteringInput),s=this.retrievePropertyParameter(e,t,i,r,this.previousSubParametersDefinition.filteringInput,"filtering"),l=this.getPropertyParameterValue(s),c=Object(w.a)(l);if(a!==l&&(""===l&&a||c))o=s,Object(m.a)(this.filteringObj.getFilter(),c,this.filteringObj.getColumnAliasMapWithColumns())?(this.previousSubParametersInput.filteringInput=s,this.previousAppliedSubParametersInput.filteringInput=s):n=!0;else{const i=Object(T.t)(e,t.id,this.contextToken);a===l&&i&&i.source&&1===i.source&&i.timeStamp&&i.timeStamp!==this.filteringObj.getClientApiFilterTimeStamp()?(this.filteringObj.setClientApiFilterTimeStamp(i.timeStamp),o=Object.assign({},s),n=!0):o=this.previousSubParametersInput.filteringInput}}else if(!this.previousDataSetDefinition.FilteringInput){if(this.getPropertyParameterValue(this.previousSubParametersInput.filteringInput)){const a={Static:!0,Value:"",Usage:1};o=this.retrievePropertyParameter(e,t,i,r,a,"filtering"),n=!0}}if(this.previousSubParametersDefinition.extraFilters&&-1===t.controlId.indexOf(pe.b)){const e=this.previousSubParametersInput.extraFilters&&this.previousSubParametersInput.extraFilters.length?this.previousSubParametersInput.extraFilters.join():"",t=this.previousSubParametersDefinition.extraFilters;e!==(t&&t.length?t.join():"")?(l=t,n=!0):l=this.previousSubParametersInput.extraFilters}if(this.previousSubParametersDefinition.pagingInput){const a=this.getPropertyParameterValue(this.previousSubParametersInput.pagingInput),s=this.retrievePropertyParameter(e,t,i,r,this.previousSubParametersDefinition.pagingInput,"paging"),o=this.getPropertyParameterValue(s),l=!(!Object(w.a)(o)||!Object(w.a)(a)||Object(w.a)(o).PageRefreshInput===Object(w.a)(a).PageRefreshInput);if(a!==o&&Object(w.a)(o)||l){let e=!1;const t=Object(w.a)(o),i=Object(w.a)(a);if(t&&t.firstPageNumber===this.pagingObj.getPageFirstIndex()&&t.lastPageNumber===this.pagingObj.getPageLastIndex()&&t.pageSize===this.pagingObj.getPageSize()&&!l)n=!1,this.previousSubParametersInput.pagingInput=s,this.previousAppliedSubParametersInput.pagingInput=s,c=s;else if(t){const r=i&&i.pagingRefreshInput?i.pagingRefreshInput:"undefinedPagingRefreshInput";(this.isPagingSizeUpdated(t)||Object(m.y)(this.pagingObj.getPageFirstIndex(),t.firstPageNumber,this.pagingObj.getPageLastIndex(),t.lastPageNumber)||this.pagingObj.getHasNextPage()&&Object(m.w)(this.pagingObj.getPageFirstIndex(),t.firstPageNumber,this.pagingObj.getPageLastIndex(),t.lastPageNumber)||this.pagingObj.getHasPreviousPage()&&Object(m.x)(this.pagingObj.getPageFirstIndex(),t.firstPageNumber,this.pagingObj.getPageLastIndex(),t.lastPageNumber)||Object(m.v)(t.firstPageNumber,t.lastPageNumber,r,t.pagingRefreshInput,this.pagingObj.getPageFirstIndex(),this.pagingObj.getPageLastIndex()))&&(!this.dataRequestedOnce&&Object(m.v)(t.firstPageNumber,t.lastPageNumber,r,t.pagingRefreshInput,this.pagingObj.getPageFirstIndex(),this.pagingObj.getPageLastIndex())&&(this._initialPageNumber=t.firstPageNumber),e=!0),e?(c=s,n=!0):(a||(this.previousSubParametersInput.pagingInput={type:null,raw:this.previousSubParametersDefinition.pagingInput.Value,error:!1,errorMessage:null,security:null}),c=this.previousSubParametersInput.pagingInput)}}else c=this.previousSubParametersInput.pagingInput}if(this.previousSubParametersDefinition.refreshInput){const s=this.getPropertyParameterValue(this.previousSubParametersInput.refreshInput),o=this.retrievePropertyParameter(e,t,i,r,this.previousSubParametersDefinition.refreshInput,"refresh"),l=this.getPropertyParameterValue(o);s===l||a.c(l)?u=this.previousSubParametersInput.refreshInput:(u=o,n=!0)}return n?{sortingInput:s,filteringInput:o,extraFilters:l,pagingInput:c,refreshInput:u,linkingInput:d}:this.previousSubParametersInput}applySortingInput(e){const t=this.getPropertyParameterValue(e),i=Object(w.a)(t);if(i){const e=this.sortingObj.getCurrentSortingArray();e.splice(0),e.push(...i)}}applyLinkingInput(e){if(this.linkedEntitiesObj.length>0&&(this.linkedEntitiesObj.clear(),this._viewBasedLinkedEntitiesKeys.length>0&&(this.linkedEntityParsed=!1)),e){const t=this.getPropertyParameterValue(e),i=Object(w.a)(t);i&&i.forEach(e=>{this.linkedEntitiesObj.addLinkedEntity(e)})}}applyFilteringInput(e){const t=this.getPropertyParameterValue(e),i=""===t?t:Object(w.a)(t);i&&""!==i?this.filteringObj.setFilter(i):this.filteringObj.clearFilter()}applyExtraFiltersInput(e){this.extraFilters=e&&e.length?e.map(e=>{const t=Object(w.a)(e);return Object(c.n)(t,null)}).filter(e=>!a.c(e)):[]}isPagingSizeUpdated(e){const t=this.pagingObj.getLastPageSizeFromParentPagingInput();return e.pageSize&&e.pageSize!==this.pagingObj.getPageSize()&&(-200===t||t!==e.pageSize)}updatePagingSizeFromViewIfNeeded(e,t){if(-200!==this.pagingObj.getLastPageSizeFromView()||1===this.pagingObj.getPagingSizeSettingSource()||4===this.pagingObj.getPagingSizeSettingSource()||2===this.pagingObj.getPagingSizeSettingSource()&&this.pagingObj.getLastPageSizeFromParentPagingInput()!==t)return;const i=Object(c.B)(e,this.viewIdDocumentDic),r=i?i.getElementsByTagName("fetch"):null;if(!r||0===r.length)return;const n=r[0].getAttribute("count");let a=-200;n&&""!==n&&("string"==typeof n?a=parseInt(n,10):"number"==typeof n&&(a=n)),-200!==a&&this.pagingObj.setPageSize(3,a)}applyPagingInput(e,t){const i=this.getPropertyParameterValue(e),r=Object(w.a)(i)||{pageNumber:null,firstPageNumber:null,lastPageNumber:null,pageSize:null},n=this.getPropertyParameterValue(t),a=Object(w.a)(n)||{pageNumber:null,firstPageNumber:null,lastPageNumber:null,pageSize:null};this.isPagingSizeUpdated(a)?(this.pagingObj.reset(),this.pagingObj.setPageSize(2,a.pageSize),this._initialPageNumber>=1&&(this.pagingObj.setPageFirstIndex(this._initialPageNumber),this.pagingObj.setPageLastIndex(this._initialPageNumber))):(Object(m.y)(this.pagingObj.getPageFirstIndex(),a.firstPageNumber,this.pagingObj.getPageLastIndex(),a.lastPageNumber)||a.firstPageNumber===a.lastPageNumber&&r.pagingRefreshInput!==a.pagingRefreshInput)&&(this.pagingObj.setPageFirstIndex(a.firstPageNumber),this.pagingObj.setPageLastIndex(a.lastPageNumber)),this.previousDataSetParameter&&(this.previousDataSetParameter.paging=this.pagingObj.retrieveDataSetPaging())}updateEntityOwnColumnNames(e,t,i){let r=null;t.TargetEntityType?r=t.TargetEntityType:t.EntityName&&(r=t.EntityName),this._entityOwnColumnNames=this._getOwnEntityColumnNames(i.map(e=>e.name),Object(P.d)(e,r))}retrieveDataSetObjectFromStorage(e,t,i,n,a=!1){const s=i.Parameters[this.propKey],l=this.updatedSubParameter(n),u=this.getCurrentViewId(s)||(this.shouldUseLookupService(e)&&this.lookupViewId?new r.a(this.lookupViewId):null),d=r.a.toString(u);let p=Object(T.tb)(e,u,t.id);const h=Object(R.h)(e,p?p.entityLogicalName:""),g=h?h.DisplayCollectionName:"";if(!p&&this.shouldUseLookupService(e)){if(!this.lookupView||u&&!r.a.equals(this.lookupView.viewId,u))return this.generateEmptyDataSetParam(p?p.title:"",g)}else if(null===p||p.initialized!==y.a.Initialized||!Object(T.F)(e,p)||!Object(R.h)(e,p.entityLogicalName)||!this.getIsColumnFirstMetadataReady())return this.generateEmptyDataSetParam(p?p.title:"",p?g:"");!p&&this.shouldUseLookupService(e)&&this.lookupView&&(p=this.parseLookupViewDescriptorToViewDescriptor(this.lookupView));const m=this.getListRecordData(e,t,i);if(null===m)return 1!==this.refreshingStatus&&2!==this.refreshingStatus||a?(a&&this.error&&(this.error=!1,this.errorMessage="",this.innerError="",this.refreshingStatus=0),this.generateEmptyDataSetParam(p?p.title:"",p?g:"",a)):this.previousDataSetParameter;if(!this.previousDataSetParameter||m!==this.previousDataSetParameter.records||3===this.refreshingStatus||4===this.refreshingStatus){const t=!1,i=null,n=null,a=this.shouldUseLookupService(e)&&this.lookupView&&r.a.equals(this.lookupView.viewId,p.viewId)?this.parseLookupColumnsToDataSetColumns(this.lookupView.columns):Object(c.m)(e,s,c.q,p,this.viewIdDocumentDic);this.addExtraColumns(a,e,p?p.entityLogicalName:null),this.addColumnsFromDataSetParameterForMetadataRetrieval(e,s,p);const l=this.previousInitState!==y.a.Initialized||3===this.refreshingStatus;this.setFilteringObjColumnAliasMap(a),this.setSortingObjColumnAliasMap(a),this.previousDataSetParameter=this.generateNewDatasetParam(l,a,t,i,void 0,n,m,d,p.title,g),s.Type===o.a.Grid&&this.updateEntityOwnColumnNames(e,s,a),3!==this.refreshingStatus&&4!==this.refreshingStatus||(this.setLegacyUpdatedPropertiesDic(Se),4===this.refreshingStatus&&(this.refreshingStatus=0))}return l&&(this.previousDataSetParameter=Object.assign({},this.previousDataSetParameter)),this.previousDataSetParameter}updatedSubParameter(e){return this.previousSubParametersInput!==e&&(this.previousSubParametersInput=e,this.dataFirstTimeSentAcknowledged?this.forceApplyDataSetInputReturnNone=!1:this.forceApplyDataSetInputReturnNone=!0,!0)}addColumnsFromDataSetParameterForMetadataRetrieval(e,t,i){if(i&&i.initialized===y.a.Initialized&&t.Columns&&t.Columns.length>0){const r=Object(T.F)(e,i);t.Columns.forEach((e,t)=>{const i=r[e.Name];a.c(i)&&this.addColumn(e.Name)})}}addExtraColumns(e,t,i){this._additionalColumns&&this._additionalColumns.length>0&&this._additionalColumns.forEach(({name:i,alias:r},n)=>{if(a.c(r)){const r=e.filter(e=>e.name===i);if(!r||0===r.length){const r=this._createDataSetColumn(t,i);a.c(r)||e.push(r)}}else{const n=this.linkedEntitiesObj.getLinkedEntities();if(n&&n.length>0){let s=null;for(const e of n)if(e.alias===r){s=e.name;break}const o=this._createDataSetColumn(t,i,s,r);a.c(o)||e.push(o)}}}),this._addMandatoryColumns(e,t,i)}_getMandatoryColumnNames(e,t){if(this._dataProvider||!t)return[];const i=Object(R.h)(e,t),r=i&&i.PrimaryNameAttribute;return r?[r]:[]}_addMandatoryColumns(e,t,i){if(this._dataProvider||!i)return;const r=Object(R.h)(t,i),n=r&&r.PrimaryNameAttribute,a=!!n&&e&&e.findIndex(e=>e.name===n)>-1;n&&!a&&e.push({name:n,isHidden:!0,isPrimary:!0,displayName:"",order:0,dataType:"",alias:n,visualSizeFactor:1})}_createDataSetColumn(e,t,i,r){let n=null;const s=a.c(i)?this.getEntityTypeName():i,o=Object(P.d)(e,s);if(!a.c(o)){const e=o[t];if(!a.c(e)){let t=null;a.c(e.Type)||a.c(e.Format)||(t=Object(C.a)(e.Type,e.Format));const i={Alias:a.c(r)?e.LogicalName:`${r}.${e.LogicalName}`,DisplayName:e.DisplayName,DataType:t,Name:a.c(r)?e.LogicalName:`${r}.${e.LogicalName}`,Type:t,Format:e.Format};n=Object(c.q)(i,-1,-1,null,!1)}}return n}retrieveDataSetObjectFromDataProvider(e,t,i,n){const a=i.Parameters[this.propKey],s=this.updatedSubParameter(n),o=this.getCurrentViewId(a);let l,u;const d="function"==typeof this._dataProvider.getTitle?this._dataProvider.getTitle():"";if(o&&(l=r.a.toString(o),u=Object(T.tb)(e,o,t.id),null===u||u.initialized!==y.a.Initialized||!this.getIsColumnFirstMetadataReady()))return this.generateEmptyDataSetParam(u?u.title:d);const p=Object(j.b)(e,t.id,t.controlId,this.propKey);if(null===p)return this.generateEmptyDataSetParam(u?u.title:d);if(!this.previousDataSetParameter||p!==this._previousDataProviderReturn){this.error=!1;const t=this.error;this.errorMessage="";const i=this.errorMessage,r=this.innerError,n=!1;let s=this._dataProvider.getColumns();u?(s=Object(c.m)(e,a,c.q,u,this.viewIdDocumentDic),this.setFilteringObjColumnAliasMap(s),this.setSortingObjColumnAliasMap(s)):(this.setFilteringObjColumnAliasMap(null),this.setSortingObjColumnAliasMap(null)),this._previousDataProviderReturn=p;const o={};for(const e of p)o[e.getRecordId()]=e;this.setLegacyUpdatedPropertiesDic(Se),this.setUpdatedPropertiesDic(Se),this._postDataSetParameterProcessForDataProvider(),this.previousDataSetParameter=this.generateNewDatasetParam(n,s,t,i,void 0,r,o,l,u?u.title:d),this.triggerOnDataSetUpdateCallBack(!1,"")}return s&&(this.previousDataSetParameter=Object.assign({},this.previousDataSetParameter)),this.previousDataSetParameter}_postDataSetParameterProcessForDataProvider(){if(this._dataProvider&&this._dataProvider.getPaging&&this._dataProvider.getPaging()){const e=this._dataProvider.getPaging();e.hasOwnProperty("hasNextPage")&&this.pagingObj.setHasNextPage(e.hasNextPage),e.hasOwnProperty("hasPreviousPage")&&this.pagingObj.setHasPreviousPage(e.hasPreviousPage),e.hasOwnProperty("pageSize")&&this.pagingObj.setPageSize(4,e.pageSize),e.hasOwnProperty("totalResultCount")&&this.pagingObj.setTotalResultCount(e.totalResultCount)}this._dataProviderRetrieveAction=this._dataProvider?1:0}retrieveDataSetObject(e,t,i,n){this.savePreviousOwnProps(t),this.isOnlineStatus=Object(Y.c)(e);const s=i.Parameters[this.propKey];let o=!1;if(this.isParameterOfDataSetType(s)){this.updatePreviousDataSetParameterDefinition(s,e);const l=this.getSubParameterValues(e,t,i,n);if(this.previousSubParametersInput.sortingInput!==l.sortingInput&&this.applySortingInput(l.sortingInput),this.previousSubParametersInput.linkingInput!==l.linkingInput&&this.applyLinkingInput(l.linkingInput),this.previousSubParametersInput.filteringInput!==l.filteringInput&&this.applyFilteringInput(l.filteringInput),this.previousSubParametersInput.extraFilters!==l.extraFilters&&this.applyExtraFiltersInput(l.extraFilters),this.previousSubParametersInput.pagingInput!==l.pagingInput&&this.applyPagingInput(this.previousSubParametersInput.pagingInput,l.pagingInput),this.previousSubParametersInput.refreshInput!==l.refreshInput&&(o=!0,this.previousSubParametersInput.refreshInput=l.refreshInput),this.controlId=t.descriptor.parentFieldSectionItem?t.descriptor.parentFieldSectionItem:t.controlId,!this.lookupView&&this.shouldUseLookupService(e)){const r=Object(J.b)(i,this.propKey);this.lookupMetadataKey=this.lookupMetadataKey||r?Object(q.f)(e,n.entityTypeName,r,t.id):null,this.lookupView=Object(q.a)(e,this.lookupMetadataKey,this.targetEntity||this.entityLogicalNameFromView),this.lookupView&&this.lookupView.viewId&&s.ViewId===this.lookupView.viewId.guid&&(this.lookupViewId=this.lookupView.viewId.guid,this.columnsForEmptyDataset=this.parseLookupColumnsToDataSetColumns(this.lookupView.columns))}if(a.c(this.columnsForEmptyDataset)){let i;const n=this.getCurrentViewId(s);this.shouldUseLookupService(e)&&this.lookupView&&(!n||r.a.equals(this.lookupView.viewId,n))||(n?(i=Object(T.tb)(e,n,t.id),!a.c(i)&&i.initialized===y.a.Initialized&&Object(T.F)(e,i)&&Object(R.h)(e,i.entityLogicalName)&&this.getIsColumnFirstMetadataReady()&&(this.columnsForEmptyDataset=Object(c.m)(e,s,c.q,i,this.viewIdDocumentDic),this.entityLogicalNameFromView=i.entityLogicalName,this._sortedColumnsOnView||(this._sortedColumnsOnView=Object(c.x)(i,this.viewIdDocumentDic),this.columnsForEmptyDataset&&this.columnsForEmptyDataset.length>0&&this._sortedColumnsOnView&&this._sortedColumnsOnView.length>0&&0===this.sortingObj.getCurrentSortingArray().length&&this.sortingObj.getCurrentSortingArray().push(...this._sortedColumnsOnView)),this.updatePagingSizeFromViewIfNeeded(i,Object(g.h)(e)))):this._dataProvider&&(this.columnsForEmptyDataset=this._dataProvider.getColumns()))}let u;return a.c(n)||(this.pageEtn=n.entityTypeName),u=this._dataProvider?this.retrieveDataSetObjectFromDataProvider(e,t,i,l):this.retrieveDataSetObjectFromStorage(e,t,i,l,o),this.linkedEntityParsed||this._parselinkedEntitiesFromView(e,i),u}return null}getIsColumnFirstMetadataReady(){return this.shouldUseLookupService()||this.isColumnFirstMetadataReady||1===this.dataSetClass||3===this.dataSetClass||2===this.firstDataRequestType&&this.dataFirstTimeSentAcknowledged}_parselinkedEntitiesFromView(e,t){const i=t.Parameters[this.propKey],r=this.previousOwnProps?this.previousOwnProps.id:null,n=this.getCurrentViewId(i),a=Object(T.tb)(e,n,r);this._parselinkedEntitiesFromViewDescriptor(a)}_parselinkedEntitiesFromViewDescriptor(e){if(e){this.linkedEntityParsed=!0;const{linkEntities:t,keys:i}=Object(me.f)(e,this.viewIdDocumentDic);for(const e of t)this.linkedEntitiesObj.addLinkedEntity(e);for(const e of i)-1===this._viewBasedLinkedEntitiesKeys.indexOf(e)&&this._viewBasedLinkedEntitiesKeys.push(e)}}_getOwnEntityColumnNames(e,t){const i=[];if(t){const r=Object.keys(t);e.forEach(e=>{-1!==r.indexOf(e)&&i.push(e)})}return i}linkToParameter(e,t){const i=t.refreshDataSetParameter;for(const i in e.records)this.linkRecordAPI(e.records[i],t);e.refresh=()=>{i(this,this.contextToken)},e.setSelectedRecordIds=this.setSelectedRecordIds.bind(this),e.getSelectedRecordIds=this.getSelectedRecordIds.bind(this),e.clearSelectedRecordIds=this.clearSelectedRecordIds.bind(this),this.linkPagingAPI(e.paging,t),e.openDatasetItem=t.openDatasetItem;const r={},n=[];e.columns.forEach(e=>{r[e.name]=e,n.push(e.name)}),e.getCellImageInfo=this._getCellConditionalImage.bind(this,e.records,t.loadWebResource,r,n)}_getCellConditionalImage(e,t,i,r,n,a,s){const o=i[n];return this.getConditionalImage(t,r,e[a],o.imageProviderWebresource,o.imageProviderFunctionName,s)}getConditionalImage(e,t,i,r,n,a){if(i&&r&&n&&"$webresource:"!==r){const s={};s["RowId"]=i.getRecordId(),t.forEach(e=>{s[e]=i.getFormattedValue(e),s[e+"_Value"]=i.getValue(e)});return e(r,this.previousOwnProps.id).then(async e=>{const t=await e.container.execute(n,[JSON.stringify(s),a]);return{Url:Array.isArray(t)&&t.length>0?t[0]&&t[0].startsWith("blob:")?t[0]:Object(x.a)(e.webResourcePath,t[0]):null,Tooltip:Array.isArray(t)&&t.length>1?t[1]:null}})}return Promise.resolve(null)}linkRecordAPI(e,t){e.setValue=this._recordSetValueAPI.bind(this,e,t.updateFieldValue),e.save=this._recordSaveAPI.bind(this,e,t.saveEmbeddedEntity),e.getFileObject=this._getFileObjectAPI.bind(this,e,t.getBoundFileObject),e.getPersonaInfo=this._getPersonaInfo.bind(this,t.retrievePersonaInfo),e.usePresenceStatus=this.usePresenceStatus.bind(this,t.usePresenceStatus),e.useProfilePhoto=this.useProfilePhoto.bind(this,t.useProfilePhoto)}linkPagingAPI(e,t){const i=t.refreshDataSetParameter,r=t.updateGridPageNumber;e.loadNextPage=this.loadNextPage.bind(this,i,r),e.loadPreviousPage=this.loadPreviousPage.bind(this,i,r),e.reset=this.resetPaging.bind(this,i,r),e.loadExactPage=this.loadExactPage.bind(this,i,r)}async _getPersonaInfo(e,t){let i=Object(f.h)(this._getState(),"systemuser",t);if(i&&i.fields&&i.fields.entityimage_url&&i.fields.azureactivedirectoryobjectid&&i.fields.internalEmailAddress){const{entityimage_url:e,azureactivedirectoryobjectid:t,internalemailaddress:r}=i.fields;return{imageUrl:Object(n.c)(e),aadId:Object(n.c)(t),internalEmailAddress:Object(n.c)(r)}}await e(t),i=Object(f.h)(this._getState(),"systemuser",t);const{entityimage_url:r,azureactivedirectoryobjectid:a,internalemailaddress:s}=(null==i?void 0:i.fields)||{};return{imageUrl:Object(n.c)(r),aadId:Object(n.c)(a),internalEmailAddress:Object(n.c)(s)}}_getFileObjectAPI(e,t,i){return t(i,{id:e.getRecordId(),entityType:e.getNamedReference().entityName},this.previousOwnProps.id,this.contextToken)}_getClosestParentWithContext(e){return e.descriptor&&e.descriptor.HasContext?e.controlId:e.parentDefinedControlProps&&e.parentDefinedControlProps.closestParentWithContext}_recordSetValueAPI(e,t,i,r){if(this.previousOwnProps){const n=this._getClosestParentWithContext(this.previousOwnProps),a=this.previousOwnProps.id,s=e.getRecordId();t(a,{[i]:{fieldName:i,type:0,value:r}},!1,e.getNamedReference().entityName,s,n,this.contextToken)}}_recordSaveAPI(e,t,i){const r=this._getClosestParentWithContext(this.previousOwnProps),n=this.previousOwnProps.id,a=e.getRecordId(),s=e.getNamedReference().entityName,o=this.previousDataSetDefinition.ViewId;return t(n,s,a,r,this._entityOwnColumnNames,o,i&&i.suppressDuplicateDetection,this.contextToken)}applyDataSetInputs(e){let t=0;if(this.previousSubParametersInput.pagingInput!==this.previousAppliedSubParametersInput.pagingInput){if(!this.previousSubParametersInput.pagingInput)return this.previousAppliedSubParametersInput.pagingInput=this.previousSubParametersInput.pagingInput,this.pagingObj.reset(),this.forceApplyDataSetInputReturnNone?(this.forceApplyDataSetInputReturnNone=!1,0):1;const e=this.getPropertyParameterValue(this.previousSubParametersInput.pagingInput),i=Object(w.a)(e);if(i){this.isPagingSizeUpdated(i)&&(this.pagingObj.setPageSize(2,i.pageSize),this.pagingObj.reset(),t=1),Object(m.w)(this.pagingObj.getPageFirstIndex(),i.firstPageNumber,this.pagingObj.getPageLastIndex(),i.lastPageNumber)&&(this.pagingObj.setPageFirstIndex(i.firstPageNumber),t=2),Object(m.x)(this.pagingObj.getPageFirstIndex(),i.firstPageNumber,this.pagingObj.getPageLastIndex(),i.lastPageNumber)&&(this.pagingObj.setPageLastIndex(i.lastPageNumber),t=3);const e=this.getPropertyParameterValue(this.previousAppliedSubParametersInput.pagingInput),r=Object(w.a)(e),n=r&&r.pagingRefreshInput?r.pagingRefreshInput:"undefinedPagingRefreshInput";Object(m.v)(i.firstPageNumber,i.lastPageNumber,n,i.pagingRefreshInput,this.pagingObj.getPageFirstIndex(),this.pagingObj.getPageLastIndex())&&(this.pagingObj.setPageFirstIndex(i.firstPageNumber),this.pagingObj.setPageLastIndex(i.lastPageNumber),t=6),this.previousAppliedSubParametersInput.pagingInput=this.previousSubParametersInput.pagingInput}}return this.previousSubParametersInput.sortingInput!==this.previousAppliedSubParametersInput.sortingInput&&(this.previousAppliedSubParametersInput.sortingInput=this.previousSubParametersInput.sortingInput,t=1),this.previousSubParametersInput.filteringInput!==this.previousAppliedSubParametersInput.filteringInput&&(this.previousAppliedSubParametersInput.filteringInput=this.previousSubParametersInput.filteringInput,t=1),this.previousSubParametersInput.extraFilters!==this.previousAppliedSubParametersInput.extraFilters&&(this.previousAppliedSubParametersInput.extraFilters=this.previousSubParametersInput.extraFilters,t=1),this.previousSubParametersInput.refreshInput!==this.previousAppliedSubParametersInput.refreshInput&&(this.previousAppliedSubParametersInput.refreshInput=this.previousSubParametersInput.refreshInput,t=1),this.forceApplyDataSetInputReturnNone?(this.forceApplyDataSetInputReturnNone=!1,0):t}usePresenceStatus(e,t){return e(t)}useProfilePhoto(e,t){return e(t)}setRefreshingStart(){0===this.refreshingStatus&&a.c(this._dataProvider)&&(this.refreshingStatus=1)}getCurrentViewId(e){if(!e)return this.dataSetClass,null;let t=e.ViewId;if(!t||t===r.a.toString(r.a.EMPTY)){if(!e.BoundViewParams||!this._isValidBoundParameterConfiguration(e.BoundViewParams))return null;this._boundViewParams={ViewId:e.BoundViewParams.ViewId,ViewDisplayName:e.BoundViewParams.ViewDisplayName,FetchXml:e.BoundViewParams.FetchXml,LayoutXml:e.BoundViewParams.LayoutXml,TargetEntityType:e.BoundViewParams.TargetEntityType},t=e.BoundViewParams.ViewId}return this.memoizedCurrentViewId&&r.a.toString(this.memoizedCurrentViewId)===t||(this.memoizedCurrentViewId=new r.a(t)),this.memoizedCurrentViewId}retrieveCurrentView(e,t){const i=this.previousOwnProps?this.previousOwnProps.id:null,n=this.getCurrentViewId(this.previousDataSetDefinition),a=Object(T.tb)(e(),n,i);return a&&r.a.equals(a.viewId,n)&&a.initialized===y.a.Initialized?Promise.resolve(a):this.shouldUseLookupService(e())&&this.lookupView&&(r.a.equals(this.lookupView.viewId,n)||!n)?Promise.resolve(this.parseLookupViewDescriptorToViewDescriptor(this.lookupView)):n?this.retrieveView(n,t).then(()=>Object(T.tb)(e(),n,i)):this.retrieveView(n,t).then(t=>Object(T.tb)(e(),t,i))}_isValidBoundParameterConfiguration(e){if(Object(U.b)(e.TargetEntityType)||Object(U.b)(e.FetchXml)||Object(U.b)(e.LayoutXml)||!r.a.validate(e.ViewId)||Object(U.b)(e.ViewDisplayName)){const e=G.a+"Models.DataSet.DataSetObjectWrapper.addCustomView";return V.a.error(e+": addCustomView, view parameters are not valid",this._getTelemetryParams(e)),!1}return!0}addCurrentBoundView(e,t){const i=new r.a(this._boundViewParams.ViewId);t(null,null,new r.a(this._boundViewParams.ViewId),this._boundViewParams.TargetEntityType,null,this._boundViewParams.ViewDisplayName,this._boundViewParams.FetchXml,this._boundViewParams.LayoutXml);const n=this.previousOwnProps?this.previousOwnProps.id:null,a=Object(T.tb)(e(),i,n);return a&&r.a.equals(a.viewId,i)?Promise.resolve(a):Promise.reject(new _.a("Could not add current bound view to state"))}retrieveCurrentBoundView(e,t){const i=this.getCurrentViewId(this.previousDataSetDefinition);if(i){const n=this.previousOwnProps?this.previousOwnProps.id:null,a=Object(T.tb)(e(),i,n);return a&&r.a.equals(a.viewId,i)?Promise.resolve(a):this.addCurrentBoundView(e,t)}}retrieveCurrentViewAndAssoicatedAttributes(e,t){return this.retrieveCurrentView(e,t.retrieveViewAction).then(i=>{const r=new Array,n=e(),a=this.getColumnsThatRequireMetadataToBeLoaded(i,n);for(const e in a)Object(c.z)(n,e,a[e])||r.push(t.getEntityMetadataAction(e,a[e]));return Promise.all(r).then(()=>(this.isColumnFirstMetadataReady=!0,i))})}_processSortingArrays(e,t,i){return 0===i.length||this._sortedColumnsOnView&&0!==this._sortedColumnsOnView.length&&Object(c.c)(i,this._sortedColumnsOnView)?[]:i}createQueryBuilder(e,t){var i,n,s,o;const l=this.previousOwnProps?this.previousOwnProps.id:null,u=Object(T.D)(e(),l,this.contextToken);!a.b(this.lookupFilterString)&&this._quickFindView||(this.lookupFilterString=null);const d=e();this._getState=e;let p=!0,h=!1;const g=!!this.contextToken&&this.contextToken.contextTokenType===A.a.SubGrid;this.previousOwnProps&&this.previousOwnProps.descriptor&&this.previousOwnProps.descriptor.Parameters&&this.previousOwnProps.descriptor.Parameters.EnableViewPicker&&(h="true"===this.previousOwnProps.descriptor.Parameters.EnableViewPicker),Object(H.e)(d,Q.ch)&&g&&!h||Object(ae.l)(d,l)&&!this._isCustomGrid()||(p=t.queryType===S.a.QUICKFIND_SEARCH);const m=this.lookupFilterString||(u&&u.quickFind&&p?u.quickFind:null);let f=t.fetchXML;const y=t.offlineSqlQuery;let v,_=!1,w="",C=!1;const I=Object(c.p)(d,t.entityLogicalName,f),j=Object(T.nb)(d,l,this.contextToken);if(this.lookupFilterString&&this._quickFindView)if(C=this._isModernQueryBuilder(d,t.viewId,l,_,I,j,m),C)v=oe.c.fromView(t.viewId,m),v.mergeQuickFind(this._quickFindView.viewId);else{const i=this._addQuickFindFilterToFetchXml(this._quickFindView,f);let r=y;if(y&&this._quickFindView.offlineSqlQuery&&(r=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t,i){if(!t||!i)return null;let r=null;if(!Object(H.f)(e,Q.Xg))return re(t,i);const n=ie(t,ee.h,ee.c);if(!n)return re(t,i);const a=ie(i,ee.b,ee.a),s=ie(i,ee.j,ee.i);let o=ie(t,ee.j,ee.i);o&&(o=o.toLowerCase().replace("where",""));const l=ie(i,ee.e,ee.d);return r=a?`${a} ${n} ${s}`:`${n} ${s}`,o&&(r+=` and (${o})`),l&&(r+=" "+l),r}(d,y,this._quickFindView.offlineSqlQuery),!r)){const e=G.a+".Models.DataSet.DataSetObjectWrapper.createQueryBuilder",t=e+" failed to merge offline Lookup queries:\n"+`viewQuery:\n${y}\nquickFindQuery:\n${this._quickFindView.offlineSqlQuery}`;V.a.error(t,this._getTelemetryParams(e))}v=b.a.fromXmlAndSql(i,r,this._quickFindView.viewId,m,t.entityLogicalName,e),this.previousOwnProps.configuration.CustomControlId!==ye&&this.previousOwnProps.configuration.CustomControlId!==ve||v.setQuickFindSearch(m)}else{let i=!1;u&&u.quickFind&&"columnLookup"!==this.propKey&&(Object(ae.l)(d,l)&&!this._isCustomGrid()||Object(H.e)(d,Q.ch)&&g&&!h)&&(f=this._addQuickFindFilterToFetchXml(this._quickFindView,f),i=!0);const r="TeamTemplateId";if(t.entityLogicalName===K.a&&this.previousOwnProps&&this.previousOwnProps.descriptor&&this.previousOwnProps.descriptor.Parameters&&this.previousOwnProps.descriptor.Parameters[r]){const e=this.previousOwnProps.descriptor.Parameters[r];if(f&&f.indexOf(e)<0){const t=this.getBoundEntityRecordId(d,this.previousOwnProps),i=t?t.guid:"",{updatedFetchXml:r,filterString:n}=Object(F.a)(f,e,i);f=r,w=n,_=!0}}C=this._isModernQueryBuilder(d,t.viewId,l,_,I,j,m),C?(v=oe.c.fromView(t.viewId,m),i&&this._quickFindView&&v.mergeQuickFind(this._quickFindView.viewId)):(v=b.a.fromXmlAndSql(f,y,t.viewId,m,t.entityLogicalName,e),i&&v.setQuickFindSearch(null==u?void 0:u.quickFind)),this.lookupFilterString=null}if(_){const e=r.a.toString(this.getBoundEntityRecordId(d,this.previousOwnProps));v.addExistingContextFilterToKey(e,w)}const D=this._getAdditionalColumns(t,this.previousDataSetDefinition,d),N=this.sortingObj.getValidSortingArray();if(N&&N.length>0){this._processSortingArrays(d,t,N).forEach(e=>{v.orderBy(e.name,1===e.sortDirection)})}const R=this.getRelationshipNameFromParameter(this.previousDataSetDefinition);if(R&&this._relatedFilterEnabled){let e=this.getBoundEntityRecordId(d,this.previousOwnProps),t=this.getBoundEntityName(d,this.previousOwnProps),i=null,n=null;this.previousOwnProps&&this.previousOwnProps.descriptor&&this.previousOwnProps.descriptor.Parameters&&this.previousOwnProps.descriptor.Parameters.DependentAttributeName&&(n=this.previousOwnProps.descriptor.Parameters.DependentAttributeName,i=n.split(".")[1]?n.split(".")[1]:n);let a=Object(E.hc)(d,l,this.contextToken),s=new k.a(t,e);if("columnLookup"===this.propKey){const o=this.previousDataSetDefinition;this._parentRecordContext&&(e=this._parentRecordContext.parentRecordId?new r.a(this._parentRecordContext.parentRecordId):r.a.EMPTY,a=this.getRecordSnapshotId(d,this.previousOwnProps,this._parentRecordContext.parentRecordEntityTypeName,e),this._parentRecordContext.parentRecordEntityTypeName&&(t=this._parentRecordContext.parentRecordEntityTypeName,s=new k.a(this._parentRecordContext.parentRecordEntityTypeName,e))),o.DependentAttributeName&&(n=o.DependentAttributeName,i=n.split(".")[1]?n.split(".")[1]:n)}const o=Object(P.a)(d,t,i);let c=null,u=!1;const p=this.previousDataSetDefinition.DependentAttributeType;o?c=Object(O.e)(d,a,s,i):p&&(u=p===t&&p!==this.entityLogicalNameFromView);const h=c;if(h&&h.reference?e=h.reference.id:"columnLookup"!==this.propKey&&null===i||null!==h&&null!==h.reference||!s||null===s.id||u||(e=null),Object($.e)(d)&&null===e&&(e=r.a.EMPTY),j){let e=X.h.Related;"Opportunity_ActivityPointers"===R&&(e=X.h.None),v.applyRollupContextFilter(s,e)}else if((this._shouldApplyContextFilter&&"columnLookup"===this.propKey||"columnLookup"!==this.propKey)&&(!C||e)){const t=Object(T.v)(d,l,this.contextToken);try{v.applyContextFilter(R,e,d,t?t.relationshipRoleOrdinal:void 0)}catch(e){const t=G.a+".Models.DataSet.DataSetObjectWrapper.createQueryBuilder",i=this._getTelemetryParams(t);i.push({name:"exception",value:null==e?void 0:e.message},{name:"callstack",value:null==e?void 0:e.stack}),V.a.error(`${t}: relationship parameter was not found in the state tree metadata for relationshipName "${R}"`,i)}}}I&&v.where(I),this._updateQueryBuilderFiltering(v,m,e);for(const e of this.linkedEntitiesObj.getLinkedEntities()){if((null===(n=null===(i=this.previousOwnProps)||void 0===i?void 0:i.configuration)||void 0===n?void 0:n.CustomControlId)!==ye&&(null===(o=null===(s=this.previousOwnProps)||void 0===s?void 0:s.configuration)||void 0===o?void 0:o.CustomControlId)!==ve||v.validateLinkedEntity(d,e),!this._isLinkEntityNeeded(e))continue;const t=[];if(this._additionalColumns&&this._additionalColumns.length>0)for(const i of this._additionalColumns)i.alias===e.alias&&-1===t.indexOf(i.name)&&t.push(i.name);v.addLinkedEntity(e,t)}v.pageSize=this.pagingObj.getPageSize();const M=D.slice(0);if(M&&M.length>0)for(let e=0;e<M.length;e++)if(M[e]===T.c){const i=Object(T.o)(d,t.entityLogicalName);i&&!Object(ae.b)(t.fetchXML)&&v.addChildCountAttribute(i.primaryAttribute),M.splice(e,1)}if(v.select(...M),C){v.pageSize=this.pagingObj.getPageSize();return v.getQueryState(e)}return v}_addQuickFindFilterToFetchXml(e,t){const i=new DOMParser;if(e){const r=i.parseFromString(e.fetchXML,"text/xml"),n=i.parseFromString(t,"text/xml"),a=r.getElementsByTagName("filter");for(let e=0;e<a.length;e++)a[e].attributes&&a[e].attributes.getNamedItem("isquickfindfields")&&n.getElementsByTagName("entity")[0].appendChild(a[e]);return(new XMLSerializer).serializeToString(n)}return t}_updateQueryBuilderFiltering(e,t,i){if(this.filteringObj.getRootFilterExpression()||this.extraFilters.length>0||this.lookupCustomFilters.length>0){const r=new DOMParser,n=e instanceof b.a?e.fetchXml:e.toFetchXml(i),a=r.parseFromString(n,"text/xml").getElementsByTagName("filter");let s=!1;for(let e=0;e<a.length;e++)s=s||!Object(Z.l)(a[e].getAttribute("hint"));const o=this.filteringObj.getRootFilterExpression();if(this.extraFilters.length>0||this.lookupCustomFilters.length>0){const i=this.extraFilters.slice(0);i.push(...this.lookupCustomFilters),o&&(this.previousOwnProps.configuration.CustomControlId!==ye&&this.previousOwnProps.configuration.CustomControlId!==ve||!t)&&i.push(o);const r={operator:"and",terms:i};e.where(r,!0,s)}else o&&(this.previousOwnProps.configuration.CustomControlId!==ye&&this.previousOwnProps.configuration.CustomControlId!==ve||!t)&&e.where(o,!0,s)}}_checkIfLinkedEntityHasAdditionalColumns(e){return!!this._additionalColumns.find(({name:t,alias:i},r,n)=>i===e.alias)}_isLinkEntityNeeded(e){return-1===this._viewBasedLinkedEntitiesKeys.indexOf(Object(me.b)(e))||this._checkIfLinkedEntityHasAdditionalColumns(e)}_isModernQueryBuilder(e,t,i,r,n,a,s){var o,l,c,u,d,p;const h=Object(D.j)(e,i),g=!(!(null==h?void 0:h.pageToEditedViewMapId)||!Object(T.ub)(e,h.pageToEditedViewMapId.guid,t.guid)),m=this.getRelationshipNameFromParameter(this.previousDataSetDefinition),f=this.linkedEntitiesObj.length>0&&this.linkedEntitiesObj.getLinkedEntities().some(e=>this._isLinkEntityNeeded(e)),b=Object(T.tb)(e,t,i),y=n||this.filteringObj.getRootFilterExpression()||this.extraFilters.length>0||this.lookupCustomFilters.length>0,v=s||(null==b?void 0:b.queryType)===S.a.QUICKFIND_SEARCH,_=m&&!a,O=(null===(l=null===(o=this.previousOwnProps)||void 0===o?void 0:o.configuration)||void 0===l?void 0:l.CustomControlId)===ge.D||(null===(u=null===(c=this.previousOwnProps)||void 0===c?void 0:c.configuration)||void 0===u?void 0:u.CustomControlId)===ge.C||(null===(p=null===(d=this.previousOwnProps)||void 0===d?void 0:d.configuration)||void 0===p?void 0:p.CustomControlId)===ge.y,P=!0===(null==b?void 0:b.isCustomView);return Object(de.x)(e,O,!!y,f,_,!!v,a,g,r)||Object(de.y)(e,a,g,r,P)||Object(de.z)(e,a,g,r)}_retrieveDataProviderRetrieveAction(){let e=this._dataProvider.refresh.bind(this._dataProvider);switch(this._dataProviderRetrieveAction){case 2:e=this._dataProvider.getPaging().loadNextPage.bind(this._dataProvider.getPaging());break;case 3:e=this._dataProvider.getPaging().loadPreviousPage.bind(this._dataProvider.getPaging());break;case 5:e=this._dataProvider.getPaging().reset.bind(this._dataProvider.getPaging());break;case 6:e=this._dataProvider.getPaging().loadExactPage.bind(this._dataProvider.getPaging(),this._exactPageNumberToBeLoaded)}return e}_refreshDataProvider(e,t){this._dataProvider.setSorting(this.sortingObj.getCurrentSortingArray()),this._dataProvider.setFiltering(this.filteringObj.getFilter()),this._dataProvider.getPaging&&this._dataProvider.getPaging()&&this._dataProvider.getPaging().setPagingSize&&this._dataProvider.getPaging().setPagingSize(this.pagingObj.getPageSize()),this._initialPageNumber>1&&(this.pagingObj.setPageFirstIndex(this._initialPageNumber),this.pagingObj.setPageLastIndex(this._initialPageNumber),this._exactPageNumberToBeLoaded=this._initialPageNumber,this._dataProviderRetrieveAction=6,this._initialPageNumber=-1);const i=t.refreshCustomDataProviderAction(this.previousOwnProps.id,this.previousOwnProps.controlId,this.propKey,this._retrieveDataProviderRetrieveAction()),r=this.getCurrentViewId(this.previousDataSetDefinition),n=new Array;return n.push(i),r&&n.push(this.retrieveCurrentViewAndAssoicatedAttributes(e,t)),Promise.all(n)}refreshDataSet(e,t,i){var r,n;const s=e(),o=this.previousOwnProps&&this.previousOwnProps.configuration?Object(V.b)(s,this.previousOwnProps.configuration.CustomControlId)||Object(V.b)(e(),this.previousOwnProps.configuration.Name):G.a,l=this.previousOwnProps?Object(D.p)(e(),this.previousOwnProps.id):"",u=G.a+".Models.DataSet.DataSetObjectWrapper.refreshDataSet",d=this.retrieveQuickFindView(e,t);if(!this.previousDataSetDefinition){const e=new Error("Refreshing not initialized DataSet parameter"),t=this._getTelemetryParams(u);throw i.EventManager.ReportComponentFailure(o,e,null,t),e}if(this._queryBuilderForPaging)return this.cachedQueryState=this._queryBuilderForPaging.getQueryState(Object(de.n)(s)?e:void 0),this.cachedQueryBuilder=this._queryBuilderForPaging,this._queryBuilderForPaging=null,t.retrieveGridDataAction(this.cachedQueryState,null===(r=this.previousOwnProps)||void 0===r?void 0:r.id).then(()=>(this.updateRefreshStatusToRequestBack(),this),r=>{const n=this._getTelemetryParams(u+".retrieveGridDataAction",l);return i.EventManager.ReportComponentFailure(o,r,null,n),this.handleRefreshError(e,this,r,t),this});this._additionalColumns&&this._additionalColumns.length>0&&(this.extendFilteringObjColumnAliasMap(this._additionalColumns),this.extendSortingObjColumnAliasMap(this._additionalColumns)),this.sortingObj.updateSortingArrays(),this.filteringObj.getFilter()&&this.filteringObj.calculateFilterExpression();const p=null===(n=this.previousOwnProps)||void 0===n?void 0:n.id,h=Object(H.f)(s,Q.Wf),m=Object(H.f)(s,Q.Xf);if(p&&(h||m)){const e=Pe(Object(D.o)(s,{id:p})),i="Grid"===this.propKey||"Items"===this.propKey;if(e&&!this.isEditableGrid(s)&&(i||m)){const e=0!==this.sortingObj.getCurrentSortingArray().length;e&&t.applyGridSorting(p,Object(w.b)(this.sortingObj.getCurrentSortingArray()));const i=this.filteringObj.getFilter();i&&t.applyGridCustomFilter(p,Object(w.b)(this.filteringObj.getFilter())),(e||i)&&this.pagingObj&&this.pagingObj.getPageFirstIndex()===this.pagingObj.getPageLastIndex()&&t.applyGridPaging(p,this.contextToken,this.pagingObj.getPageFirstIndex())}}if(this.dataFirstTimeSentAcknowledged=!0,this._dataProvider)return this._refreshDataProvider(e,t).catch(r=>{const n=this._getTelemetryParams(u+"._refreshDataProvider",l);return i.EventManager.ReportComponentFailure(o,r,null,n),this.handleRefreshError(e,this,r,t),this});return(this._boundViewParams?this.retrieveCurrentBoundView(e,t.addCustomViewAction):this.retrieveCurrentView(e,t.retrieveViewAction)).then(r=>{const n=new Array;if(null==r||r.initialized!==y.a.Initialized)throw V.a.error(u+": retrieveView, can not retrieve view's metadata",this._getTelemetryParams(u)),new _.a("Can not retrieve view's metadata",2415919120);this.linkedEntityParsed||this._parselinkedEntitiesFromViewDescriptor(r);const h=this.getColumnsThatRequireMetadataToBeLoaded(r,e()),m=Object(P.i)(e(),r,this.getRelationshipNameFromParameter(this.previousDataSetDefinition));m&&!a.c(r.entityLogicalName)&&(a.c(h[r.entityLogicalName])&&(h[r.entityLogicalName]=[]),h[r.entityLogicalName].push(m));for(const i in h)Object(c.z)(e(),i,h[i])||n.push(t.getEntityMetadataAction(i,h[i]));const v=Object(c.u)();return v.length>0&&n.push(t.getAdditionalResourceStrings(v)),d&&n.push(d),r.isCustomView&&Object(ne.D)(e())&&(Object.isFrozen(r)&&(r=Object.assign({},r)),Object(de.z)(s,!1,!1,!1)||n.push(t.setOfflineQueryAction(r))),Promise.all(n).then(()=>{var n,a,s;this.isColumnFirstMetadataReady=!0,this.updatePagingSizeFromViewIfNeeded(r,Object(g.h)(e()));let c=Promise.resolve();const d=this.createQueryBuilder(e,r);if(d instanceof b.a?(this.cachedQueryBuilder=d,this.cachedQueryState=this.cachedQueryBuilder.getQueryState(),c=this._extractErrorMessagesIfNeeded(this.cachedQueryBuilder,t,e)):(this.cachedQueryState=d,this.cachedQueryState.entityLogicalName=r.entityLogicalName,this.cachedQueryBuilder=oe.c.fromState(this.cachedQueryState)),this._initialPageNumber<=1)this.pagingObj.reset();else{const t=this.cachedQueryBuilder.pageNumber!==this._initialPageNumber;this.cachedQueryBuilder.pageNumber=this._initialPageNumber,t&&this._canPreservePageState(e(),p)&&this.cachedQueryBuilder instanceof b.a?this.cachedQueryState=this.cachedQueryBuilder.getQueryState():this.cachedQueryState.pageNumber=this._initialPageNumber,this._initialPageNumber=-1}return 1===this.firstDataRequestType&&this.dataRequestedByControlInitialization&&(this.dataRequestedByControlInitialization=!1,Object(f.p)(e(),this.cachedQueryBuilder.getKey())===y.a.Initialized||!this._initialDataSetFetchEnabled)?(this.updateRefreshStatusToRequestBack(),c.then(()=>this)):(Object(ue.c)(this.cachedQueryState,null===(n=this.contextToken)||void 0===n?void 0:n.contextTokenType,null===(s=null===(a=this.previousOwnProps)||void 0===a?void 0:a.configuration)||void 0===s?void 0:s.CustomControlId),c.then(()=>{var r;return t.retrieveGridDataAction(this.cachedQueryState,null===(r=this.previousOwnProps)||void 0===r?void 0:r.id).then(()=>(this.updateRefreshStatusToRequestBack(),this),r=>{const n=this._getTelemetryParams(u+".retrieveGridDataAction",l);return i.EventManager.ReportComponentFailure(o,r,null,n),this.handleRefreshError(e,this,r,t),this})}))})}).catch(r=>{const n=this._getTelemetryParams(u+".viewRetrievePromise",l);return i.EventManager.ReportComponentFailure(o,r,null,n),this.handleRefreshError(e,this,r,t),this})}retrieveQuickFindView(e,t){let i;const r=e(),n=this.previousOwnProps?this.previousOwnProps.id:null;return this.previousOwnProps&&(i=Object(T.D)(r,n,this.contextToken)),this.shouldUseQuickFindViewForLookup(r)&&!a.b(this.lookupFilterString)||i&&i.quickFind?t.retrieveViewAction(this.targetEntity||this.entityLogicalNameFromView||this.getEntityTypeName(),S.a.QUICKFIND_SEARCH,S.b.savedview).then(t=>{this._quickFindView=Object(T.tb)(e(),t,n)}):null}_extractErrorMessagesIfNeeded(e,t,i){if(!this.previousOwnProps||!this.previousOwnProps.configuration||this.previousOwnProps.configuration.CustomControlId!==ye&&this.previousOwnProps.configuration.CustomControlId!==ve||!e||!e.containsError())return Promise.resolve();const r=e.getErrors().filter(e=>!!e.message).map(e=>e.message);if(t.getAdditionalResourceStrings&&"function"==typeof i){const e=Object(z.e)(i(),r);if(Object.values(e).some(e=>!e))return t.getAdditionalResourceStrings(r)}return Promise.resolve()}getColumnsThatRequireMetadataToBeLoaded(e,t){const i=this._getAllColumns(e,this.previousDataSetDefinition,t,null,!0),r={},n=new Set,s=this.previousDataSetDefinition;a.c(s)||a.c(s.Columns)||s.Columns.forEach(e=>{!a.c(e.PreventMetadataRequest)&&e.PreventMetadataRequest&&n.add(e.Name)}),i.forEach(t=>{if(n.has(t));else if(-1!==t.indexOf(".")){let e;const i=this.linkedEntitiesObj.getLinkedEntities();if(i&&i.length>0&&i.forEach(i=>{i.alias===t.split(".")[0]&&(e=i.name)}),!a.c(e)){const i=t.split(".")[1];this._addColumnsToColumnDictionary(r,e,i)}}else this._addColumnsToColumnDictionary(r,e.entityLogicalName,t)});let o=null;return this.linkedEntitiesObj.getLinkedEntities().forEach(t=>{var i;const n=t.name,a=t.from,s=t.alias;(null==e?void 0:e.entityLogicalName)&&n&&a&&this._addColumnsToColumnDictionary(r,n,a);const l=t.to;if((null==e?void 0:e.entityLogicalName)&&n&&l){o=o||Object(he.w)(null==e?void 0:e.fetchXML);const t=null===(i=o.querySelector(`link-entity[alias=${s}]`))||void 0===i?void 0:i.parentElement;"link-entity"===(null==t?void 0:t.tagName)?this._addColumnsToColumnDictionary(r,t.getAttribute("name"),l):this._addColumnsToColumnDictionary(r,e.entityLogicalName,l)}}),r}_addColumnsToColumnDictionary(e,t,i){a.c(e[t])&&(e[t]=[]),-1===e[t].indexOf(i)&&e[t].push(i)}updateRefreshStatusToRequestBack(){this.refreshingStatus=4,this.previousOwnProps&&this.previousOwnProps.reRunMapStateMainProps&&(0===this.dataSetClass?this.previousOwnProps.reRunMapStateMainProps():2!==this.dataSetClass&&3!==this.dataSetClass||this._scheduleForceMapStateToProps(this.previousOwnProps.reRunMapStateMainProps))}setErrorStatus(e,t,i){var r;this.refreshingStatus=100,this.errorMessage=e;const n=null==i?void 0:i.errorCode;this.innerError=null===(r=null==i?void 0:i.innerError)||void 0===r?void 0:r.message,this.error=!0;const a=this.getLatestData();a&&(a.loading=!1,this.previousDataSetParameter.loading=!1,a.error=this.error,this.previousDataSetParameter.error=this.error,a.errorMessage=this.errorMessage,this.previousDataSetParameter.errorMessage=this.errorMessage,a.errorCode=n,this.previousDataSetParameter.errorCode=n,a.innerError=this.innerError,this.previousDataSetParameter.innerError=this.innerError),this.reRenderControlAction&&this.reRenderControlAction(),this.triggerOnDataSetUpdateCallBack(this.error,this.errorMessage,n,this.innerError)}setControlReRender(e){this.reRenderControlAction=e}handleRefreshError(e,t,i,r){let n;i&&i.reason?n=i.reason:i&&(n=i),n?this._retrieveLocalizedMessageAndSetErrorStatus(e,t,n,r):t.setErrorStatus("")}_retrieveLocalizedMessageAndSetErrorStatus(e,t,i,r){r.getLocalizedErrorMessage(i,this.previousOwnProps&&this.previousOwnProps.configuration&&this.previousOwnProps.configuration.CustomControlId).then(r=>{t.setErrorStatus(r,e,i)})}gridRunOnLoad(e){if(this._needToRunLoad&&this.previousOwnProps){this._needToRunLoad=!1;try{e(this.previousOwnProps.id,void 0,this.previousOwnProps.controlId)}catch(e){V.a.error(G.a+".Models.DataSet.DataSetObjectWrapper.gridRunOnLoad: gridRunOnLoad encountered error: "+e.message,[{name:"APIName",value:G.a+".Models.DataSet.DataSetObjectWrapper.gridRunOnLoad"}])}}}loadNextPage(e,t){this._dataProvider&&this._dataProvider.getPaging&&this._dataProvider.getPaging()&&this._dataProvider.getPaging().loadNextPage&&(this._dataProviderRetrieveAction=2),this.loadSpecificPage(e,t,this.pagingObj.getHasNextPage(),this.pagingObj.getPageLastIndex()+1)}loadExactPage(e,t,i){this._dataProvider&&this._dataProvider.getPaging&&this._dataProvider.getPaging()&&this._dataProvider.getPaging().loadNextPage&&(this._dataProviderRetrieveAction=6);const r=i||this.pagingObj.getPageFirstIndex();this.loadSpecificPage(e,t,!0,r,!0)}loadPreviousPage(e,t){this._dataProvider&&this._dataProvider.getPaging&&this._dataProvider.getPaging()&&this._dataProvider.getPaging().loadPreviousPage&&(this._dataProviderRetrieveAction=3),this.loadSpecificPage(e,t,this.pagingObj.getHasPreviousPage(),this.pagingObj.getPageFirstIndex()-1)}resetPaging(e,t){this._dataProvider&&this._dataProvider.getPaging&&this._dataProvider.getPaging()&&this._dataProvider.getPaging().reset&&(this._dataProviderRetrieveAction=5);const i=1!==this.pagingObj.getPageFirstIndex();this.pagingObj.reset(),this.loadSpecificPage(e,t,i,1)}_updatePagingObject(e,t){e?(this.pagingObj.setPageLastIndex(t),this.pagingObj.setPageFirstIndex(t),this._exactPageNumberToBeLoaded=t):t-this.pagingObj.getPageLastIndex()==1?this.pagingObj.setPageLastIndex(t):this.pagingObj.getPageFirstIndex()-t==1&&this.pagingObj.setPageFirstIndex(t)}loadSpecificPage(e,t,i,r,n){var a;if(!i)return;if(this._dataProvider&&0!==this._dataProviderRetrieveAction)return this._updatePagingObject(n,r),void e(this,this.contextToken);const s=this.cachedQueryBuilder;this.pagingObj.getPageSize()!==s.pageSize?(this.pagingObj.reset(),s.pageSize=this.pagingObj.getPageSize(),this.cachedQueryState=s.getQueryState(this._getState),r=1):this._updatePagingObject(n,r),s.pageNumber=r,this._queryBuilderForPaging=s;const o=this._getState(),l=null===(a=this.previousOwnProps)||void 0===a?void 0:a.id;this._canPreservePageState(o,l)&&t(l,this.contextToken,r),e(this,this.contextToken)}_canPreservePageState(e,t){if(!t)return!1;const i=Object(D.o)(e,{id:t}),r=Object(L.e)(e,this.previousOwnProps.configuration.CustomControlId)||Object(L.e)(e,this.previousOwnProps.configuration.Name);return!(!Pe(i)||(null==r?void 0:r.CustomControlId)!==ge.C&&(null==r?void 0:r.CustomControlId)!==ge.y&&!Object(H.f)(e,Q.Vf))}generateNewDatasetParam(e,t,i,r,n,a,s,o,l,c){const u=this.getEntityTypeName()||this.targetEntity;return new v.a({loading:e,columns:t,error:i,errorMessage:r,errorCode:n,innerError:a,sortedRecordIds:Object.keys(s),records:s,sorting:this.sortingObj.retrieveDataSetSorting(),filtering:this.filteringObj.retrieveDataSetFiltering(),paging:this.pagingObj.retrieveDataSetPaging(),linking:this.linkedEntitiesObj.retrieveDataSetLinking()},o,l,u,this.addColumn,c)}generateEmptyDataSetParam(e="",t="",i=!1){const n=this.shouldUseLookupService()&&this.lookupView?this.lookupView.viewId:this.getCurrentViewId(this.previousDataSetDefinition),a=r.a.toString(n);if(i||!this.previousEmptyParameter||a!==this.previousEmptyParameter.getViewId()||this.columnsForEmptyDataset&&this.previousEmptyParameter.columns.length!==this.columnsForEmptyDataset.length){const i=null!==n||null!==this._dataProvider;let r,s,o,l;this.columnsForEmptyDataset&&(this.setFilteringObjColumnAliasMap(this.columnsForEmptyDataset),this.setSortingObjColumnAliasMap(this.columnsForEmptyDataset)),100===this.refreshingStatus&&this.previousDataSetParameter&&this.previousDataSetParameter.error&&(r=this.previousDataSetParameter.error,s=this.previousDataSetParameter.errorMessage,l=this.previousDataSetParameter.innerError,o=this.previousDataSetParameter.errorCode),this.previousEmptyParameter=this.generateNewDatasetParam(i,this.columnsForEmptyDataset?this.columnsForEmptyDataset:[],!1,null,void 0,null,{},a,e,t),r&&(this.previousEmptyParameter.error=r,this.previousEmptyParameter.errorMessage=s,this.previousEmptyParameter.errorCode=o,this.previousEmptyParameter.innerError=l,this.previousEmptyParameter.loading=!1),this.previousDataSetParameter=this.previousEmptyParameter}return this.previousEmptyParameter}isValidParameterConfiguration(e){return!!(e.ViewId||this._dataProvider||e.BoundViewParams)}addColumn(e,t){a.c(e)||this._additionalColumns.find(({name:i,alias:r},n,a)=>i===e&&r===t)||(this._additionalColumns.push({name:e,alias:t}),this._isColumnsetChanged=!0)}generateEmptyParam(){return this.generateEmptyDataSetParam()}getRecordSnapshotId(e,t,i,r){const n=this._getClosestParentWithContext(t),a=this.previousOwnProps.id;let s;switch(Object(D.p)(e,a)){case N.a:{const t=Object(M.f)(this.contextToken,r,i);s=Object(T.T)(e,a,t);break}default:if(n){const t=Object(M.f)(this.contextToken,r,i);s=Object(T.T)(e,a,t)}else s=Object(E.hc)(e,a,this.contextToken)}return s}_linkRecordToState(e,t,i){const s=this.previousOwnProps.id,l=i.getRecordId();i.getFormattedValue=e=>{var t,r;if(a.b(e))return null;a.b(i._columnAliasNameMap[e])||(e=i._columnAliasNameMap[e]);const s=null===(r=null===(t=this.previousDataSetParameter)||void 0===t?void 0:t.columns)||void 0===r?void 0:r.find(t=>t.name===e);if(s&&(s.dataType===o.a.WholeLanguage||s.dataType===o.a.WholeTimeZone||s.dataType===o.a.WholeDuration))return i.reformatValue(e);const l=i._record.fields[e];return a.c(l)?null:Object(n.c)(l)};const u=i.getNamedReference().entityName,d=Object(M.f)(this.contextToken,new r.a(l,!0),u);i.isEditable=t=>{if(Object(U.b)(t)){const t=!this._isRecordDisabled(e,u,i);return Promise.resolve(t)}return Promise.resolve(this.getRecordFieldIsEditable(e,i,t))},i.isSecured=t=>{const r=Object(P.d)(e,i.getNamedReference().entityName);return r&&r[t]?Promise.resolve(r[t].IsSecured):Promise.resolve(!1)},i.isReadable=t=>{const r=Object(P.d)(e,i.getNamedReference().entityName);return r&&r[t]?Promise.resolve(r[t].IsValidForRead):Promise.resolve(!0)},i.getFieldRequiredLevel=t=>Promise.resolve(this.getRecordFieldRequiredLevel(e,i,t)),i.isValid=t=>!Object(T.L)(e,s,d,t)&&(!(i._record&&i._record.fields&&i._record.fields[t]&&i._record.fields[t].validationResult)||i._record.fields[t].validationResult.isValueValid),i.getValidationError=t=>{const r=Object(T.L)(e,s,d,t);return r||(i._record&&i._record.fields&&i._record.fields[t]&&i._record.fields[t].validationResult?i._record.fields[t].validationResult.errorMessage:null)},i.reformatValue=t=>{const r=i.getValue(t);if(!Object(U.b)(r)){let a=Object(P.d)(e,i.getNamedReference().entityName);if((!a||!a[t])&&i._record&&i._record.fields&&i._record.fields[t]){const r=i._record.fields[t];Object(n.f)(r)&&(a=Object(P.d)(e,r.entityLogicalName),t=r.attributeLogicalName)}if(a&&a[t]||!i._record||!i._record.identifier||!i._record.identifier.etn||"activitypointer"!==i._record.identifier.etn||(a=Object(P.d)(e,"activitypointer")),a&&a[t]){const i=Object(c.u)(),n=Object(B.A)(e,a[t],null);return Object(B.y)(r,n,Object(z.e)(e,i))}}return""},i.getCurrencyDecimalPrecision=t=>{var n,s,o,l,c;const u=Object(P.d)(e,i.getNamedReference().entityName);if(!u)return null;const d=u[t];if(!d||a.c(d.PrecisionSource))return null;const p=Object(x.D)(e);switch(d.PrecisionSource){case le.a.attribute:return d.Precision;case le.a.organization:return p.pricingDecimalPrecision;case le.a.currency:const t=null===(s=null===(n=i._record)||void 0===n?void 0:n.fields)||void 0===s?void 0:s[ce.z],a=r.a.toString(null===(o=null==t?void 0:t.reference)||void 0===o?void 0:o.id);return a&&(null===(l=p.transactionCurrencyById)||void 0===l?void 0:l.hasOwnProperty(a))?p.transactionCurrencyById[a].currencyPrecision:null===(c=Object(g.x)(e).numberFormatInfo)||void 0===c?void 0:c.CurrencyDecimalDigits}return null}}_isRecordDisabled(e,t,i){return t!==W.rb&&(t===W.o||Object(E.Rb)(e,t,new r.a(i.getRecordId())))}getRecordFieldRequiredLevel(e,t,i){const n=this.previousOwnProps.id,a=t.getRecordId(),s=t.getNamedReference().entityName,o=Object(M.f)(this.contextToken,new r.a(a,!0),s);return Object(T.O)(e,n,o,i)}getRecordFieldIsEditable(e,t,i){if("statuscode"===i||"statecode"===i)return!1;const n=this.previousOwnProps.id,a=t.getRecordId(),s=t.getNamedReference().entityName,o=Object(M.f)(this.contextToken,new r.a(a,!0),s);return Object(T.M)(e,n,o,i,r.a.tryParseOrNull(a))}_getLastColumns(){var e;return null===(e=this.previousDataSetParameter)||void 0===e?void 0:e.columns}getListRecordData(e,t,i){const n=i.Parameters[this.propKey];let a;if(this.shouldUseLookupService(e)){const r=Object(J.b)(i,this.propKey);a=Object(q.b)(e,this.pageEtn,r,this.targetEntity||this.entityLogicalNameFromView,t.id),this.previousInitState=Object(q.d)(e,a)}else a=this._getQueryKey(()=>e,t,n),this.previousInitState=Object(f.p)(e,a);if(this.previousInitState!==y.a.Initialized)return 1!==this.refreshingStatus||this.previousInitState!==y.a.Initializing&&this.previousInitState!==y.a.Refreshing||(this.refreshingStatus=2),null;if(2===this.refreshingStatus&&(this.refreshingStatus=3),1===this.refreshingStatus)return null;const s=this.getRecordsListFromStateWithSnapshots(e,t,i);this.clearCurrentSnapshotIdMap();const o={},u={};for(let i=0;i<s.length;i++){const n=s[i].identifier.id,a=r.a.toString(n),l=s[i].identifier.etn,c=this.getRecordSnapshotId(e,t,l,n);c&&(o[a]=c,u[c]=u[c]||Object(O.b)(e,c))}Object.assign(this._snapShotIdMap,o);const d=!!Object.keys(o).length,p=Object(c.d)(this.previousRecords,s);if(this._previousDataSetRecords&&!p&&!d&&a===this._previousQueryKey&&!this.shouldUseLookupService(e)&&4!==this.refreshingStatus)return this._previousDataSetRecords;const h=this._previousQueryKey!==a;if(this._previousQueryKey=a,this.previousDataSetParameter){Object(c.A)(this.previousRecords,this.previousDataSetParameter.sortedRecordIds,s)&&(this.setLegacyUpdatedPropertiesDic(Se),this.setUpdatedPropertiesDic(Se))}else s&&s.length>0&&(this.setLegacyUpdatedPropertiesDic(Se),this.setUpdatedPropertiesDic(Se));const g=Object(c.b)(this.previousDataSetDefinition,n);if(p||g){const i={},a={},c=this.getAliasMap(n);for(let t=0;t<s.length;t++){const n=s[t],d=r.a.toString(n.identifier.id),p=n.identifier.etn,h=Object(R.h)(e,p).PrimaryNameAttribute;let g=!1;if(this.isEditableGrid(e)&&o[d]){const t=u[o[d]]||Object(O.b)(e,o[d]);(t.activeChanges&&Object.keys(t.activeChanges).length||t.lockedChanges&&Object.keys(t.lockedChanges).length)&&(g=!0)}i[d]=n,a[d]=new l(n,c,h,this._getLastColumns.bind(this),g)}p&&(this.previousRecords=Object.assign({},i)),g&&(this.previousDataSetDefinition=Object.assign({},n)),this._needToRunLoad=!0,this.setUpdatedPropertiesDic(Se),this._previousDataSetRecords=Object.assign({},a);for(const i in this._previousDataSetRecords){const r=this._previousDataSetRecords[i];this._linkRecordToState(e,t,r)}this.triggerOnDataSetUpdateCallBack(!1,"")}else(h||4===this.refreshingStatus)&&this.triggerOnDataSetUpdateCallBack(!1,"");return this._previousDataSetRecords}getRecordsListById(e,t,i){const n={};if(this.previousInitState!==y.a.Initialized)return n;const a=this.getRecordsListFromStateWithSnapshots(e,t,i);for(let e=0;e<a.length;e++){const t=a[e];n[r.a.toString(t.identifier.id)]=t}return n}getRecordsListFromStateWithSnapshots(e,t,i){const n=i.Parameters[this.propKey],a=this.getRecordsList(e,t,n);this.clearCurrentSnapshotIdMap();const s={},o={};for(let i=0;i<a.length;i++){const n=a[i].identifier.id,l=r.a.toString(n),c=a[i].identifier.etn,u=this.getRecordSnapshotId(e,t,c,n);u&&(s[l]=u,o[u]=o[u]||Object(O.b)(e,u))}Object.assign(this._snapShotIdMap,s);return!!Object.keys(s).length&&Object.keys(s).forEach(t=>{const i=a.findIndex(e=>e.identifier.id.guid===t),n=a[i],l=s[t];(k.a.equals(o[l].identifier,n.identifier)||"activitypointer"===n.identifier.etn&&o[l].identifier&&n.identifier&&r.a.equals(o[l].identifier.id,n.identifier.id))&&(a[i]=Object(O.i)(e,s[t],n,n.identifier,Object.keys(n.fields)))}),a}getAliasMap(e){const t={};return e.Columns&&e.Columns.forEach(e=>{t[e.Alias]=e.Name}),t}setFilteringObjColumnAliasMap(e){e?this.filteringObj.setColumnAliasMapWithColumns(this._generateColumnAliasMapWithColumns(e)):this.filteringObj.setColumnAliasMapWithColumns(null)}extendFilteringObjColumnAliasMap(e){e&&e.length>0&&this.filteringObj.extendColumnAliasMapWithColumns(this._generateColumnAliasMapWithColumns(e))}setSortingObjColumnAliasMap(e){e?this.sortingObj.setColumnAliasMap(this._generateColumnAliasMapWithColumns(e)):this.sortingObj.setColumnAliasMap(null)}extendSortingObjColumnAliasMap(e){e&&e.length>0&&this.sortingObj.extendColumnAliasMap(this._generateColumnAliasMapWithColumns(e))}retrieveView(e,t){const i=this.getEntityTypeName();if(!i){const e=G.a+"Models.DataSet.DataSetObjectWrapper.retrieveView";return V.a.error(e+": retrieveView, Entity name is not specified for lookup",this._getTelemetryParams(e)),Promise.reject(new _.a("Entity name is not specified for lookup"))}return t(i,null,S.b.savedview,e)}ensureDataInitialization(e){this.dataRequestedOnce||this.previousInitState===y.a.Initialized&&2===this.firstDataRequestType?this.previousInitState===y.a.Initialized&&2===this.firstDataRequestType&&(this.dataFirstTimeSentAcknowledged=!0):e.refreshDataSetParameter(this,this.contextToken),this.dataRequestedOnce=!0}triggerOnDataSetUpdateCallBack(e,t,i,r=""){if(this.previousDataSetDefinition&&this.previousDataSetDefinition.onDataSetUpdate)if(this.cachedQueryState||this._dataProvider){let n="";this.filteringObj&&!a.c(this.filteringObj.getConvertedFilter())&&(n=Object(w.b)(this.filteringObj.getConvertedFilter()));const s=this.pagingObj.retrieveDataSetPaging();s.firstPageNumber=this.pagingObj.getPageFirstIndex(),s.lastPageNumber=this.pagingObj.getPageLastIndex();const o={fetchXmlInUse:a.c(this.cachedQueryState)?null:this.cachedQueryState.fetchXml,newQueryKey:a.c(this.cachedQueryState)?null:this.cachedQueryState.key,existedFilteringString:n,existedPagingString:Object(w.b)(s),error:e,errorMessage:t,errorCode:i,innerError:r,existedValidSortingArrayString:Object(w.b)(this.sortingObj.getValidSortingArray())};this.previousDataSetDefinition.onDataSetUpdate(o)}else if(this.error){const n={error:e,errorMessage:t,errorCode:i,innerError:r};this.previousDataSetDefinition.onDataSetUpdate(n)}}_getViewColumns(e,t){if(!this._memoizedViewColumnsInfo||this._memoizedViewColumnsInfo.memoizedViewId!==(e&&e.viewId)){const i=[],r=e&&e.grid&&e.grid.rows&&e.grid.rows[0]?e.grid.rows[0].cells:null;if(r)for(const e in r)!r.hasOwnProperty(e)||t&&r[e].disableMetaDataBinding||i.push(r[e].name);else if(this.shouldUseLookupService()&&this.lookupView)for(const e in this.lookupView.columns)i.push(this.lookupView.columns[e].logicalName);this._memoizedViewColumnsInfo={memoizedViewId:e&&e.viewId,memoizedValue:i}}return this._memoizedViewColumnsInfo.memoizedValue}_getFetchXmlColumns(e){if(e){const t=Object(he.w)(e);return Object(he.q)(t)}return[]}_getAdditionalColumns(e,t,i){if(this._isColumnsetChanged||!this._memoizedAdditionalColumnsInfo||this._memoizedAdditionalColumnsInfo.memoizedViewId!==e.viewId){let r=[];const n=this._getViewColumns(e),s=this._getFetchXmlColumns(e.fetchXML);for(const e in t.Columns){const{Name:i}=t.Columns[e];i&&-1===n.indexOf(i)&&-1===r.indexOf(i)&&r.push(i)}const o=[];this._additionalColumns.forEach(({name:e,alias:t})=>{const i=a.c(t)?e:`${t}.${e}`;-1===r.indexOf(i)&&-1===n.indexOf(i)&&o.push(i)}),r=r.concat(o);(e?this._getMandatoryColumnNames(i,e.entityLogicalName):[]).forEach(e=>{-1===r.indexOf(e)&&(-1===n.indexOf(e)||s&&-1===s.indexOf(e))&&r.push(e)}),this._memoizedAdditionalColumnsInfo={memoizedViewId:e.viewId,memoizedValue:r}}return this._memoizedAdditionalColumnsInfo.memoizedValue}_getAllColumns(e,t,i,r,n){var a;if(this._isColumnsetChanged||!this._memoizedAllColumnsInfo||this._memoizedAllColumnsInfo.memoizedViewId!==e.viewId){const s=this._getViewColumns(e,n).concat(this._getAdditionalColumns(e,t,i)),o=Object(T.x)(i,this.contextToken,(null===(a=this.previousOwnProps)||void 0===a?void 0:a.id)||r||null);if(o)for(const e of o)-1===s.indexOf(e)&&s.push(e);const l=e&&e.grid&&e.grid.rows&&e.grid.rows[0]?e.grid.rows[0].multiObjectIdField:null;l&&-1===s.indexOf(l)&&s.push(l),this._memoizedAllColumnsInfo={memoizedViewId:e.viewId,memoizedValue:s},this._isColumnsetChanged=!1}return this._memoizedAllColumnsInfo.memoizedValue}getRecordsList(e,t,i){let r,n;if(this.shouldUseLookupService()&&this.lookupView&&this.lookupView.viewId&&(this.lookupView.viewId.guid===i.ViewId||!i.ViewId)){n=[];for(const e of this.lookupView.columns)n.push(e.logicalName)}else{const r=Object(T.tb)(e,this.getCurrentViewId(i),t.id);r&&(n=this._getAllColumns(r,i,e,(null==t?void 0:t.id)||null))}const a=this._getPageNumberQueue(),s=[];a.length>0&&1!==a[0]?this.pagingObj.setHasPreviousPage(!0):this.pagingObj.setHasPreviousPage(!1);for(let o=0;o<a.length;o++){let l;if(this.shouldUseLookupService()){const i=Object(J.b)(t.configuration,this.propKey);r=Object(q.b)(e,this.pageEtn,i,this.targetEntity||this.entityLogicalNameFromView,t.id),l=Object(q.e)(e,r,a[o],n)}else r=this._getQueryKey(()=>e,t,i),l=Object(f.r)(e,r,a[o],n);if(l&&l.length>0){if(s.push(...l),o===a.length-1){const t=Object(f.o)(e,r).pages[a[o]];this.pagingObj.setHasNextPage(t.moreRecords)}}else o>0?this.pagingObj.setPageLastIndex(a[o]):this.pagingObj.setPageLastIndex(1),this.pagingObj.setHasNextPage(!1)}return this.pagingObj.setTotalResultCount(Object(f.u)(e,r)),s}_generateColumnAliasMapWithColumns(e){const t={};for(const i of e)i.alias&&i.name?(t[i.name]=i.name,t[i.alias]=i.name):!i.alias&&i.name&&(t[i.name]=i.name);return t}_getQueryKey(e,t,i){return this._getQueryBuilder(e,t,i).getKey()}_getQueryBuilder(e,t,i){if(!this.cachedQueryState){const r=Object(T.tb)(e(),this.getCurrentViewId(i),t.id),n=this.createQueryBuilder(e,r);n instanceof b.a?(this.cachedQueryBuilder=n,this.cachedQueryState=this.cachedQueryBuilder.getQueryState()):(this.cachedQueryState=n,this.cachedQueryBuilder=oe.c.fromState(this.cachedQueryState))}return this.cachedQueryBuilder}_getPageNumberQueue(){const e=[];if(this.shouldUseLookupService()||this.cachedQueryState)for(let t=this.pagingObj.getPageFirstIndex();t<this.pagingObj.getPageLastIndex()+1;t++)e.push(t);else e.push(1);return e}_getTelemetryParams(e,t){const i=[],r={name:"pageType",value:t},n={name:"CustomControlId",value:this.previousOwnProps&&this.previousOwnProps.configuration?this.previousOwnProps.configuration.CustomControlId:""},a={name:"controlId",value:this.previousOwnProps?this.previousOwnProps.controlId:""},s={name:"APIName",value:e},o={name:"EntityName",value:this.previousOwnProps&&this.previousOwnProps.formInfo&&this.previousOwnProps.formInfo.EntityName?this.previousOwnProps.formInfo.EntityName:null},l={name:"FormId",value:this.previousOwnProps&&this.previousOwnProps.formInfo&&this.previousOwnProps.formInfo.FormId?this.previousOwnProps.formInfo.FormId:null},c={name:"contextString",value:this.previousOwnProps?this.previousOwnProps.contextString:""};return i.push(r),i.push(n),i.push(s),i.push(o),i.push(l),i.push(a),i.push(c),i}getEntityTypeName(){let e;return this.previousDataSetDefinition&&this.previousDataSetDefinition.TargetEntityType?e=this.previousDataSetDefinition.TargetEntityType:this.entityLogicalNameFromView?e=this.entityLogicalNameFromView:this.previousDataSetDefinition&&this.previousDataSetDefinition.EntityName&&(e=this.previousDataSetDefinition.EntityName),e}getAttribute(e,t,i){const r=e.Parameters[this.propKey];return 3===r.Usage?r.Attributes:Object(P.a)(t,i,r.Value)}isEditableGrid(e){if(!this.previousOwnProps||!this.previousOwnProps.configuration)return!1;const t=Object(L.e)(e,this.previousOwnProps.configuration.CustomControlId)||Object(L.e)(e,this.previousOwnProps.configuration.Name);if(!t||"MscrmControls.Grid.GridControl"!==t.ConstructorName)return!1;if(this.previousOwnProps.configuration.Parameters&&this.previousOwnProps.configuration.Parameters.EnableEditing){const e=this.previousOwnProps.configuration.Parameters.EnableEditing;if(e.Value&&"No"===e.Value)return!1}return!0}getViewIdDocumentDic(){return this.viewIdDocumentDic}parseLookupColumnsToDataSetColumns(e){const t=[];for(let i=0;i<e.length;i++)t.push({name:e[i].logicalName,displayName:e[i].logicalName,order:i,dataType:"String"===e[i].dataType?"SingleLine."+e[i].format.charAt(0).toUpperCase()+e[i].format.slice(1):e[i].dataType,alias:e[i].alias||e[i].logicalName,visualSizeFactor:0});return t}parseLookupViewDescriptorToViewDescriptor(e){return{initialized:y.a.Initialized,viewId:new r.a(this.lookupViewId),fetchXML:this.lookupView.fetchXml,entityLogicalName:this.targetEntity||this.entityLogicalNameFromView,queryType:S.a.LOOKUP_VIEW,isUserView:!1,title:e.viewName}}shouldUseLookupService(e){if(e&&!Object(Y.c)(e)||!this.isOnlineStatus)return!1;if(Object(U.b)(this.lookupServiceEnabled)){if(!e)return!1;if(this._dataProvider)return this.lookupServiceEnabled=!1,this.lookupServiceEnabled;Object(U.b)(this.lookupServiceEnabled)&&(this.lookupServiceEnabled=Object(H.f)(e,Q.ie))}let t=!1;return this.previousOwnProps&&this.previousOwnProps.configuration&&(this.previousOwnProps.configuration.CustomControlId===ye||this.previousOwnProps.configuration.CustomControlId===ve)&&(t=!0),this.lookupServiceEnabled&&t}shouldUseQuickFindViewForLookup(e){Object(U.b)(this.lookupQuickFindEnabled)&&(this.lookupQuickFindEnabled=Object(H.f)(e,Q.ge));let t=!1;return this.previousOwnProps&&this.previousOwnProps.configuration&&(this.previousOwnProps.configuration.CustomControlId===ye||this.previousOwnProps.configuration.CustomControlId===ve)&&(t=!0),this.lookupQuickFindEnabled&&t}get filteringObj(){return this._filteringObj}set filteringObj(e){this._filteringObj=e}_scheduleForceMapStateToProps(e){this._rerunMapStateToPropsTaskId>=0&&clearTimeout(this._rerunMapStateToPropsTaskId),this._rerunMapStateToPropsTaskId=setTimeout(()=>{e(),this._rerunMapStateToPropsTaskId=-1},50)}_isCustomGrid(){var e;return(null===(e=this.contextToken)||void 0===e?void 0:e.contextTokenType)===A.a.CustomGrid}setMyRecordsOnlyFilter(e){this.meFilterEnabled=e}get queryBuilder(){return this.cachedQueryBuilder}relevantQueryError(){if(!(this.cachedQueryBuilder&&this.cachedQueryBuilder instanceof b.a&&this.cachedQueryBuilder.containsError()))return null;const e=this.cachedQueryBuilder.getFirstError();return!e||this.isOnlineStatus&&e.offlineModeSpecific?null:e}}function Pe(e){return[be.a.ENTITY_LIST,be.a.VIEW].indexOf(e)>=0}Oe.UnknownErrorMessage="Unknown error occurred."},"7p56":function(e,t,i){"use strict";i.d(t,"a",(function(){return Ki}));var r=i("mMyr"),n=i("huli"),a=i("agNy"),s=i("u+q+"),o=i("kXuq"),l=i("fVjY"),c=i("/to1"),u=i("nFP/"),d=i("Fn63"),p=i("223Y"),h=i("2SCk"),g=i("AuoJ"),m=i("KKKn"),f=i("sclX"),b=i("BFlg");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const y=2/(1+Math.sqrt(5));class v extends r.Component{constructor(e){super(e),this._memorizedDescriptor=null,this.onMeasuring=this.onMeasuring.bind(this),this.state={width:0,height:0}}_getGoldenRatioHeight(e){return y*e}onMeasuring(e,t){let i=!1;const r={};e!==this.state.width&&(r.width=e,i=!0),t!==this.state.height&&(r.height=t,i=!0),i&&this.setState(r)}render(){const e=this.props.TraceManager&&this.props.TraceManager.getTracer?this.props.TraceManager.getTracer(b.P):null;if(!this.props||!this.props.showChart||!this.props.configuration)return e&&e.info("Chart not rendered because the configuration is missing or show chart is set to false"),null;this._memorizedDescriptor&&this.props.chartId===this._memorizedDescriptor.Id||(this._memorizedDescriptor={Id:this.props.chartId,Label:"",Name:"",ShowLabel:!1,Visible:!0,Disabled:!1});const t=parseFloat(getComputedStyle(document.documentElement).fontSize),i=this._getTopAndBottomAdjustment(t),n=this._getLeftAndRightAdjustment(t);let a,s;this.props.isLayoutVertical?(a=this.state.width-n,s=this._getGoldenRatioHeight(a),this.props.style.minHeight=s+i):(a=Math.max(this.state.width,320)-n,s=this.state.height-i);const l={minWidth:a.toString()+"px",minHeight:s.toString()+"px"},c={width:a>0?a:-1,height:s>0?s:-1,eventListeners:[{eventname:"onChartPaneClose",eventhandler:[this._closeChartPane.bind(this)]},{eventname:"onChartPaneMove",eventhandler:[this._moveChartPaneLeftOrRight.bind(this)]}]};return r.createElement(o.a,{key:"pageChart_"+this.props.id,testhooks:{id:"pageChart_"+this.props.id},style:this.props.style,onMeasuring:this.onMeasuring,isRequestedMeasuring:!0},r.createElement(o.a,{key:"pageChart_"+this.props.id+"_container",style:l},r.createElement(p.c,{key:this.props.chartId,controlId:this.props.chartId,id:this.props.id,configuration:this.props.configuration,descriptor:this._memorizedDescriptor,parentDefinedControlProps:c,parentContextToken:this.props.contextToken})))}_closeChartPane(){this.props.closeChartPaneHandler(this.props.id,this.props.contextToken,!1)}_moveChartPaneLeftOrRight(){this.props.moveChartPaneHandler(this.props.isChartOnTheRightSide,this.props.id,this.props.contextToken)}_getTopAndBottomAdjustment(e){let t=0;return this.props.style.borderTopWidth&&(t+=e*("string"==typeof this.props.style.borderTopWidth?parseFloat(this.props.style.borderTopWidth||"0px"):this.props.style.borderTopWidth)),this.props.style.paddingTop&&(t+=e*("string"==typeof this.props.style.paddingTop?parseFloat(this.props.style.paddingTop||"0px"):this.props.style.paddingTop)),this.props.style.borderTop&&(t+=1),this.props.style.borderBottom&&(t+=1),t}_getLeftAndRightAdjustment(e){let t=0;return this.props.style.paddingLeft&&(t+=e*("string"==typeof this.props.style.paddingLeft?parseFloat(this.props.style.paddingLeft||"0px"):this.props.style.paddingLeft)),this.props.style.paddingRight&&(t+=e*("string"==typeof this.props.style.paddingRight?parseFloat(this.props.style.paddingRight||"0px"):this.props.style.paddingRight)),this.props.style.borderLeft&&(t+=1),this.props.style.borderRight&&(t+=1),t}}var S=i("SAYH"),_=i("ij89"),O=i("KBcj"),P=i("d0w6"),w=i("iWfp"),C=i("XvLr"),I=i("P6DH"),E=i("b6Tl"),j=i("/nm7"),D=i("x7SK");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const T=j.b.gray130,F=j.b.gray40,N=j.b.gray30,R=j.b.gray190,k={maxWidth:"100%",margin:"-8px 0 0 0"},A=Object.assign(Object.assign({},k),{boxSizing:"border-box",padding:"0px 24px"}),M={root:{display:"block",fontSize:"20px",border:"none",padding:"4px",height:"auto",maxWidth:"100%"},label:{padding:"4px",margin:"0",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},menuIcon:{lineHeight:"20px"},textContainer:{overflow:"hidden"}},x={header:{selectors:{i:{display:"none"}}},container:{},list:{},subComponentStyles:{callout:{},menuItem:{}},title:{}},L=Object.assign({root:{minWidth:"304px",maxWidth:"min(440px, calc(100vw - 16px))"}},x),V=Object.assign({root:{display:"flex",flexDirection:"column",maxHeight:"calc(100vh - 40px)",minWidth:"304px",maxWidth:"min(440px, calc(100vw - 16px))"}},x),B={root:{height:"auto",padding:"4px",lineHeight:"initial",selectors:{"&[aria-checked='true']":{backgroundColor:F,selectors:{[D.l]:{backgroundColor:"Highlight"}}}}},label:{margin:0,padding:"4px",whiteSpace:"normal",overflowWrap:"break-word"},checkmarkIcon:{display:"none"}},z={root:{height:"auto",padding:"4px",lineHeight:"initial",selectors:{"&[aria-checked='true']":{backgroundColor:N,selectors:{[D.l]:{backgroundColor:"Highlight"}}},"&:hover":{"#infoIcon":{visibility:"visible"}},"&:focus":{"#infoIcon":{visibility:"visible"}}}},label:{cursor:"pointer",flexGrow:0,fontWeight:"400",margin:0,padding:"4px",whiteSpace:"normal",overflowWrap:"break-word"},secondaryText:{fontSize:"12px",color:R,fontWeight:"600"},checkmarkIcon:{display:"none"}},U=Object.assign(Object.assign({},B),{icon:{display:"none"}}),W=Object.assign(Object.assign({},z),{icon:{}}),G={root:{"overflow-y":"auto"}},q={root:{margin:"8px",padding:"4px"}},H={root:{"flex-shrink":0,"border-top":"1px solid #ccc"}},Q={root:{padding:"0px",margin:"69px auto auto auto",fontSize:"18px"}},K={root:{padding:"0px",margin:"auto auto 68px auto",color:T}},X={root:{height:"201px"},checkmarkIcon:{display:"none"},icon:{display:"none"}},Y={root:{display:"inline-block",padding:"4px"}},J={root:{color:"#0078d4",fontSize:"16px",visibility:"hidden"}},$={root:{fontSize:"12px",color:T,padding:"0px 2px",textAlign:"center",verticalAlign:"baseline"}},Z={flexGrow:1};var ee=i("CoqL"),te=i("pgIM"),ie=i("46Dq"),re=i("7P9M"),ne=i("y2up"),ae=i("TjDw"),se=i("LYE8"),oe=i("Ruv5"),le=i("urMQ"),ce=i("QBtP"),ue=i("fMBw"),de=i.n(ue),pe=i("SZCI"),he=i("504W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
Object(D.hb)({fontFace:{fontFamily:'"Segoe MDL2 Assets"'},icons:{ContactSolid:"",ExploitProtectionSettings:""}});const ge={styles:W},me={styles:z},fe={styles:B},be={styles:U},ye=de.a.createEvent("ViewSelectorRenderStopWatch",pe.o);class ve extends r.Component{constructor(e){super(e),this._mainPageViewSelectorEndWatch=null,this._clearStatusMessageTimeoutId=0,this.state={statusMessage:"",filterString:""}}render(){var e,t;const{categories:i,id:n,items:a,strings:s,styles:o,value:l,isAdvancedFilteringEnabled:u,onMenuOpened:d}=this.props;let p=[];const h=[];if(u&&Object(he.a)(this._mainPageViewSelectorEndWatch)&&(this._mainPageViewSelectorEndWatch=ye.startStopwatch()),u){if(this._isNotViewCategory(i[0].id))for(const e of i){const t=this._createCategorySection(e);p.push(t)}else{const{onChangeView:t,orgDefaultValue:i,userDefaultValue:r}=this.props,n={iconProps:{iconName:"ContactSolid",styles:$}};let o=0;a.map(e=>{const a=e.value===l,c=e.value===r||!r&&e.value===i,u=e.categoryId===P.b.userview.toString();u&&(o+=1);const d=u?me:ge,h=u?s.personalView:s.systemView,g=String.format("{0}. {1}",e.text,h),m={onRenderContent:this._createRenderMenuItemFunction(!0,u),canCheck:!0,checked:a,"data-value":e.value,key:e.value,itemProps:d,role:"menuitemradio",onClick:()=>t(e.value,this.state.filterString),secondaryText:c&&s.defaultStatus,title:g,text:e.text};p.push(u?Object.assign(Object.assign({},m),n):m)});const c=[{name:"UserViewCount",value:o},{name:"SystemViewCount",value:a.length-o}];null===(e=this.context.EventManager)||void 0===e||e.ReportComponentSuccess(qe(b.x),c)}p=this._filterViews(p),p&&p.length&&!this._isCategorizedMenuListEmpty(i[0].id,p)||p.push({key:"no_results",onRender:this._createRenderNoSearchResultFunction()}),this._addButtonsForModernAdvancedFind(h)}else{for(const e of i){const t=this._createCategorySection(e);p.push(t)}p.push(this._createDefaultViewCommand())}let g={ariaLabel:s.viewsLabel,calloutProps:{"data-id":`ViewSelector_${l}-flyout`},isBeakVisible:!1,items:p,shouldFocusOnMount:!0,styles:u?V:L,onMenuOpened:u?d:null,onDismiss:this._onDismiss.bind(this),focusZoneProps:{handleTabKey:ee.b.all}};u&&(g=Object.assign(Object.assign({},g),{onRenderMenuList:this._createRenderMenuListFuncion(h)}));const m=null===(t=a.find(e=>e.value===l))||void 0===t?void 0:t.text,f=r.createElement(r.Fragment,null,r.createElement(c.a,{semanticTag:"h1",style:null==o?void 0:o.root,title:m},r.createElement(te.a,{ariaDescription:s.openPopupToChangeView,id:n,"data-id":"ViewSelector_"+l,menuProps:g,styles:M,text:m})),r.createElement(c.a,{accessibilityLive:"assertive",style:D.Z},this.state.statusMessage));return u&&(this._mainPageViewSelectorEndWatch(),this._mainPageViewSelectorEndWatch=null),f}_isNotViewCategory(e){return e!==P.b.userview.toString()&&e!==P.b.savedview.toString()}_isCategorizedMenuListEmpty(e,t){var i;if(this._isNotViewCategory(e)){for(const e of t)if(0!==(null===(i=e.sectionProps)||void 0===i?void 0:i.items.length))return!1;return!0}return!1}_filterViews(e){const t=this.state.filterString.toLowerCase().trim();return(e=e.filter(e=>{var i;return e.sectionProps&&(e.sectionProps.items=this._filterViews(e.sectionProps.items)),-1!==(null===(i=null==e?void 0:e.text)||void 0===i?void 0:i.toLowerCase().indexOf(t))})).filter(e=>{var i;return-1!==(null===(i=null==e?void 0:e.text)||void 0===i?void 0:i.toLowerCase().indexOf(t))})}_createRenderMenuItemFunction(e,t){return(i,n)=>r.createElement(r.Fragment,null,this._renderItemNameAndIcon(i),n.renderSecondaryText(i),e?this._renderInfoIcon(i,t):null)}_renderItemNameAndIcon(e){const{item:t,hasIcons:i,classNames:n}=e;let a;if(i){const{iconProps:e}=t;a=r.createElement(ie.a,Object.assign({},e,{className:n.icon}))}else a=null;return t.text||t.name?r.createElement(re.a,{className:n.label,styles:{root:Z}},t.text||t.name,a):null}_renderInfoIcon(e,t){const{classNames:i}=e,{strings:n}=this.props,a={iconName:"Info",id:"infoIcon",styles:J};return r.createElement(ne.a,{content:t?n.personalView:n.systemView,id:"tooltipId",directionalHint:ae.a.rightCenter,calloutProps:{gapSpace:0},onTooltipToggle:this._onInfoIconTooltipToggle.bind(this),styles:Y},r.createElement(ie.a,Object.assign({},a,{className:i.icon})))}_createRenderNoSearchResultFunction(){const{strings:e}=this.props;return()=>r.createElement(se.a,{styles:X},r.createElement(re.a,{styles:Q},e.noMatchesFound),r.createElement(re.a,{styles:K},e.tryRewordingYourSearch))}_createRenderMenuListFuncion(e){const{strings:t}=this.props;return(i,n)=>{const a=n(i);i.items=e,i.totalItemCount=e.length,i.hasIcons=!0;const s=n(i);return r.createElement(r.Fragment,null,r.createElement(se.a,{styles:G},r.createElement(oe.a,{ariaLabel:t.searchViews,placeholder:t.searchViews,onChange:this._onChange.bind(this),styles:q,value:this.state.filterString,onFocus:this._onFocus.bind(this)}),a),r.createElement(se.a,{styles:H},s))}}_addButtonsForModernAdvancedFind(e){const t=this._createSaveChangesToCurrentViewCommand();t&&e.push(t);const i=this._createSaveAsNewViewCommand();i&&e.push(i);const r=this._createSetDefaultViewCommand();r&&e.push(r);const n=this._createResetDefaultViewCommand();n&&e.push(n);const a=this._createManageAndShareViewsCommand();a&&e.push(a)}_onFocus(e){var t;null===(t=this.context.EventManager)||void 0===t||t.ReportComponentSuccess(qe(b.t))}_onChange(e){var t;this.setState({filterString:(null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.value)||""})}_onDismiss(e){this.setState({filterString:""})}_onInfoIconTooltipToggle(e){var t;e&&(null===(t=this.context.EventManager)||void 0===t||t.ReportComponentSuccess(qe(b.n)))}componentWillUnmount(){window.clearTimeout(this._clearStatusMessageTimeoutId)}_createCategorySection(e){const{items:t,onChangeView:i,orgDefaultValue:r,strings:n,userDefaultValue:a,value:s,isAdvancedFilteringEnabled:o}=this.props,l=t.filter(t=>t.categoryId===e.id);return{key:e.id,itemType:le.a.Section,sectionProps:{title:e.name,items:l.map(e=>{const t=e.value===s,l=e.value===a||!a&&e.value===r,c={canCheck:!0,checked:t,"data-value":e.value,key:e.value,itemProps:o?ge:be,role:"menuitemradio",onClick:()=>i(e.value,this.state.filterString),secondaryText:l&&n.defaultStatus,title:e.text,text:e.text},u={onRenderContent:this._createRenderMenuItemFunction(!1,!1)};return o?Object.assign(Object.assign({},c),u):c}),bottomDivider:!0}}}_createSaveChangesToCurrentViewCommand(){const{items:e,strings:t,value:i,isEdited:r,personalViewEditingEnabled:n,canUserUpdatePersonalView:a}=this.props,s=e.find(e=>e.value===i);if(!s)return null;const o=s.categoryId===P.b.userview.toString();return n&&a&&r&&o?{"data-id":"save-changes",key:t.saveChangesToCurrent,iconProps:{iconName:"Save"},itemProps:fe,onClick:()=>this.props.onSaveChangesToCurrentView(),text:t.saveChangesToCurrent}:null}_createSaveAsNewViewCommand(){const{items:e,strings:t,value:i,isEdited:r,personalViewEditingEnabled:n,canUserCreatePersonalView:a}=this.props,s=e.find(e=>e.value===i);if(!s)return null;const o=s.categoryId===P.b.savedview.toString();return(n||o)&&a&&r?{"data-id":"save-as-new",key:t.saveAsNew,iconProps:{iconName:"SaveAs"},itemProps:fe,onClick:()=>this.props.onSaveAsNewView(),text:t.saveAsNew}:null}_createDefaultViewCommand(){const{items:e,orgDefaultValue:t,strings:i,userDefaultValue:r,value:n}=this.props,a=e.find(e=>e.value===n),s=n===t&&!r;return n===r||s?{"data-id":"reset-default",disabled:s,key:i.resetOrgDefault,iconProps:{iconName:"RevToggleKey"},itemProps:fe,onClick:()=>this._changeUserDefaultView(a,!1),text:i.resetOrgDefault}:{"data-id":"set-default",key:i.setUserDefault,iconProps:{iconName:"AccountBrowser"},itemProps:fe,onClick:()=>this._changeUserDefaultView(a,!0),text:i.setUserDefault}}_createSetDefaultViewCommand(){const{items:e,strings:t,orgDefaultValue:i,userDefaultValue:r,value:n,isEdited:a}=this.props,s=e.find(e=>e.value===n);return!(r&&n!==r)&&!(n!==i&&!r)||a?null:{"data-id":"set-default",key:t.setUserDefault,iconProps:{iconName:"AccountBrowser"},itemProps:fe,onClick:()=>this._changeUserDefaultView(s,!0),text:"Set as default view"}}_createResetDefaultViewCommand(){const{items:e,strings:t,userDefaultValue:i,value:r}=this.props,n=e.find(e=>e.value===r);return i?{"data-id":"reset-default",key:t.resetOrgDefault,iconProps:{iconName:"RevToggleKey"},itemProps:fe,onClick:()=>this._changeUserDefaultView(n,!1),text:t.resetOrgDefault}:null}_changeUserDefaultView(e,t){const{onChangeUserDefaultView:i,strings:r}=this.props,n=t?r.setUserDefaultSuccess:r.resetOrgDefaultSuccess;i(e,t).then(()=>{window.clearTimeout(this._clearStatusMessageTimeoutId),this.setState({statusMessage:n}),this._clearStatusMessageTimeoutId=window.setTimeout(()=>{this.setState({statusMessage:""})},1e4)})}_createManageAndShareViewsCommand(){const{strings:e,canUserManageAndShareView:t}=this.props;return t?{"data-id":"manage-and-share",key:e.manageAndShare,iconProps:{iconName:"ExploitProtectionSettings"},itemProps:fe,onClick:this.props.onManageAndShareViews,text:e.manageAndShare}:null}}ve.contextType=ce.a;var Se=i("a72m"),_e=i("EY5k"),Oe=i("YxC/"),Pe=i("FZDd"),we=i("iZ7K"),Ce=i("eXjw"),Ie=i("OmkB"),Ee=i("tOh6"),je=i("sZ+8"),De=i("69Qu"),Te=i("RJiR"),Fe=i("3/02"),Ne=i("Lyxw"),Re=i("0kGT"),ke=i("BSJX"),Ae=i("35be"),Me=i("bZIe"),xe=i("DD48"),Le=i("ruPX"),Ve=i("tICD"),Be=i("zu1I"),ze=i("MuBJ"),Ue=i("9egp");let We=[];class Ge extends r.Component{constructor(e){super(e),this._onItemIconPointerDown=this._onItemIconPointerDown.bind(this),this._onChangeUserDefaultView=this._onChangeUserDefaultView.bind(this),this._onSaveAsNewView=this._onSaveAsNewView.bind(this),this._onSaveChangesToCurrentView=this._onSaveChangesToCurrentView.bind(this),this._onManageAndShareView=this._onManageAndShareView.bind(this),this._onChange=this._onChange.bind(this),this._onMenuOpened=this._onMenuOpened.bind(this),this.props.entityTypeName.toLowerCase()===I.a&&(this.props.loadAllActivityTypes(e.activities),this.props.loadAllActivityResourceString()),this._internalIdAppendix=S.a.newGuid().guid}_getEntityTypeNameFromViewId(e){return e&&this.props.gridViewSelectorItems&&this.props.gridViewSelectorItems[e]&&this.props.gridViewSelectorItems[e].relatedEntityName?this.props.gridViewSelectorItems[e].relatedEntityName:null}_onMenuOpened(){var e;const t=[{name:"EntityTypeName",value:this.props.entityTypeName}];null===(e=this.context.EventManager)||void 0===e||e.ReportComponentSuccess(qe(b.z),t)}_onChange(e,t){var i,r;if(this.props.isAdvancedFilteringEnabled){const e=[{name:"NumberOfCharactersInSearchbox",value:t.trim().length}];null===(i=this.context.EventManager)||void 0===i||i.ReportComponentSuccess(qe(b.H),e)}this.props.isGridRoot&&this.props.pageToEditedViewMapId&&this.props.selectedViewId!==e&&this.props.removeEditedViewPageMap(null===(r=this.props.pageToEditedViewMapId)||void 0===r?void 0:r.guid,new S.a(this.props.selectedViewId)),this.props.onChange(e,this.props.entityTypeName===I.a?this._getEntityTypeNameFromViewId(e):this.props.entityTypeName)}_isViewSelectorHidden(){return!(this.props.gridViewSelectorItems&&this.props.viewCategories&&this.props.selectedViewId)}_viewNameSorter(e,t){var i,r;const n=null===(i=null==e?void 0:e.text)||void 0===i?void 0:i.toLocaleLowerCase(),a=null===(r=null==t?void 0:t.text)||void 0===r?void 0:r.toLocaleLowerCase();return n<a?-1:n>a?1:0}render(){var e;const t=this.props.resourceStrings,i=Object(Oe.c)(t,C.VIEWSELECTOR_TOOLTIP),n=this.props.contextString===b.o.GRID,a=n?this._onItemIconPointerDown:null,s=this.props.isPhone,o=s?this.props.styleProps.textStyleMobile:this.props.styleProps.textStyle,l=s?this.props.styleProps.viewSelectorMobileStyle:this.props.styleProps.viewSelectorStyle,c=this.props.TraceManager&&this.props.TraceManager.getTracer?this.props.TraceManager.getTracer(b.P):null;if(this._isViewSelectorHidden())return c&&c.info("View Selector not rendered because view selector items or view categories or selected view is not available."),null;let u=[],p=!1,h=null;const g=this.props.useSortedViewSelectorItems&&!!this.props.viewSelectorSortOrder,m=[],f=[];for(const e in this.props.gridViewSelectorItems){const t=this.props.gridViewSelectorItems[e];if(!t)continue;const i=t.isUserView;let r;if(i&&(p=!0),this.props.entityTypeName===I.a&&this.props.pinnedActivityView){const e=t;r=e.isPinned&&this.props.pinnedActivityView.PinnedEntity===e.relatedEntityName}else r=t.isPinned;r&&(h=e);const a=n?r?d.a.Pinned:d.a.Pin:null,s='""',o='""',l={marginLeft:"8px",marginRight:"8px",":hover":{"::before":{content:r?s:o}}},c=n?l:null,b=Object(Oe.c)(this.props.resourceStrings,C.VIEWSELECTOR_DEFAULTVIEW),y=Object(Oe.c)(this.props.resourceStrings,C.VIEWSELECTOR_SETDEFAULTVIEW),v=n?r?b:y:null;let S="";S=this.props.entityTypeName===I.a&&this.props.allActivitiesString&&this.props.shouldDisplayNestedViewSelector?(We.indexOf(t.relatedEntityName)+1).toString():i?P.b.userview.toString():P.b.savedview.toString();let _=t.name;e===this.props.selectedViewId&&this.props.isEdited&&(this.props.isRTL?_="*"+_:_+="*"),g?i?m.push({value:e,text:_,categoryId:S,iconType:a,iconTitle:v,iconStyle:c}):f.push({value:e,text:_,categoryId:S,iconType:a,iconTitle:v,iconStyle:c}):u.push({value:e,text:_,categoryId:S,iconType:a,iconTitle:v,iconStyle:c})}if(g)switch(this.props.viewSelectorSortOrder){case 1:case 2:m.sort(this._viewNameSorter),f.sort(this._viewNameSorter),u=1===this.props.viewSelectorSortOrder?m.concat(f):f.concat(m);break;case 3:u=m.concat(f).sort(this._viewNameSorter)}if(this.props.selectedViewId&&this.props.quickFindViewId&&this.props.quickFindViewId===this.props.selectedViewId){const e=Object(Oe.c)(this.props.resourceStrings,C.QUICK_FIND_VIEWS_LABEL_ID);u.push({value:this.props.selectedViewId,text:e,categoryId:P.b.savedview.toString()})}const y=p?this.props.viewCategories:this.props.viewCategories.filter(e=>e.id!==P.b.userview.toString());if(this.props.isGridRoot){if(this.props.isInMobileModeForOct2019)return r.createElement(Te.c,{pageId:this.props.pageId},this.props.isAdvancedFindView?r.createElement(ke.a,null,"New view"):r.createElement(Te.m,{id:this.props.id,dataId:this.props.selectedViewId,uniqueListId:this._internalIdAppendix,items:u,selectedItemId:this.props.selectedViewId,onChange:this._onChange}));if(this.props.isOctober2021Update){const i=s?k:A;return r.createElement(ve,{categories:y,id:this.props.id,items:u,isEdited:this.props.isEdited,personalViewEditingEnabled:this.props.personalViewEditingEnabled,canUserCreatePersonalView:this.props.canUserCreatePersonalView,canUserUpdatePersonalView:this.props.canUserUpdatePersonalView,canUserManageAndShareView:this.props.canUserManageAndShareView,onChangeUserDefaultView:this._onChangeUserDefaultView,onSaveAsNewView:this._onSaveAsNewView,onSaveChangesToCurrentView:this._onSaveChangesToCurrentView,onChangeView:this._onChange,onMenuOpened:this._onMenuOpened,orgDefaultValue:null===(e=this.props.defaultViewId)||void 0===e?void 0:e.guid,strings:{defaultStatus:Object(Oe.c)(t,C.MAINVIEWSELECTOR_DEFAULT_VIEW),manageAndShare:Object(Oe.c)(t,C.MAINVIEWSELECTOR_MANAGE_AND_SHARE),noMatchesFound:Object(Oe.c)(t,C.MAINVIEWSELECTOR_NO_MATCHES_FOUND)||"No matches found",openPopupToChangeView:Object(Oe.c)(t,C.MAINVIEWSELECTOR_OPEN_POPUP_TO_CHANGE_VIEW)||"Open popup to change view.",personalView:Object(Oe.c)(t,C.MAINVIEWSELECTOR_PERSONAL_VIEW)||"Personal view",resetOrgDefault:Object(Oe.c)(t,C.MAINVIEWSELECTOR_RESET_ORG_DEFAULT),resetOrgDefaultSuccess:Object(Oe.c)(t,C.MAINVIEWSELECTOR_RESET_ORG_DEFAULT_SUCCESS),saveAsNew:Object(Oe.c)(t,C.MAINVIEWSELECTOR_SAVE_AS_NEW),saveChangesToCurrent:Object(Oe.c)(t,C.MAINVIEWSELECTOR_SAVE_CHANGES_TO_CURRENT),searchViews:Object(Oe.c)(t,C.MAINVIEWSELECTOR_SEARCH_VIEWS),setUserDefault:Object(Oe.c)(t,C.MAINVIEWSELECTOR_SET_USER_DEFAULT),setUserDefaultSuccess:Object(Oe.c)(t,C.MAINVIEWSELECTOR_SET_USER_DEFAULT_SUCCESS),systemView:Object(Oe.c)(t,C.MAINVIEWSELECTOR_SYSTEM_VIEW)||"System view",tryRewordingYourSearch:Object(Oe.c)(t,C.MAINVIEWSELECTOR_TRY_REWORDING_YOUR_SEARCH)||"Try rewording your search.",viewsLabel:Object(Oe.c)(t,C.VIEWSELECTOR_VIEWS)},styles:{root:i},userDefaultValue:h,value:this.props.selectedViewId,onManageAndShareViews:()=>this._onManageAndShareView(h),isAdvancedFilteringEnabled:this.props.isAdvancedFilteringEnabled})}}return this.props.isAdvancedFindView?r.createElement(ke.a,{style:o},"New view"):r.createElement(_.a,{id:this.props.id,testhooks:{id:"ViewSelector_"+this.props.selectedViewId},value:this.props.selectedViewId,role:"presentation",title:i,categories:y,options:u,style:this.props.style,caretType:d.a.ChevronDownMed,caretStyle:this.props.styleProps.caretStyle,textStyle:o,viewSelectorStyle:l,onChange:this._onChange,onItemIconPointerDown:a,createAccessibilityComponent:w.a,createKeyboardShortcut:w.b,parentCustomControlId:this.props.id,rootZIndex:this.props.rootZIndex,isRTL:this.props.isRTL,placeItemIconOnRight:!0,useHeader:!0})}componentDidMount(){if(this.props.viewIds?this.props.loadGridViewsByViewId(this.props.viewIds,this.props.entityTypeName):this.props.loadViewsByType(this.props.queryViewSelectorTypes,this.props.entityTypeName,this.props.gridViewSelectorItems),this._isViewSelectorHidden())return;let e=!1;if(this.props.selectedViewId&&""!==this.props.selectedViewId&&(this.props.gridViewSelectorItems&&this.props.gridViewSelectorItems[this.props.selectedViewId]||this.props.quickFindViewId&&this.props.quickFindViewId===this.props.selectedViewId)&&(e=!0),!e){if(this.props.viewIds){this.props.viewIds.find(e=>e.guid===this.props.selectedViewId)&&(e=!0)}this.props.defaultViewId&&this.props.defaultViewId.guid!==S.a.EMPTYSTRING&&this.props.defaultViewId.guid!==S.a.EMPTYGUIDSTRING&&this.props.onChange(this.props.defaultViewId.guid,this.props.entityTypeName)}}_onItemIconPointerDown(e){const t=e.iconType===d.a.Pinned;this._onChangeUserDefaultView(e,!t)}_onChangeUserDefaultView(e,t){var i;const r=e;let n="";this.props.isAdvancedFilteringEnabled&&(n=t?b.i:b.f,null===(i=this.context.EventManager)||void 0===i||i.ReportComponentSuccess(qe(n)));const a=this.props.TraceManager&&this.props.TraceManager.getTracer?this.props.TraceManager.getTracer(b.P):null;let s=e.categoryId,o=this.props.entityTypeName;if(this.props.entityTypeName===I.a){const t=this.props.gridViewSelectorItems;o=t&&t[e.value]?t[e.value].relatedEntityName:o;s=!(!t||!t[e.value])&&t[e.value].isUserView?P.b.userview.toString():P.b.savedview.toString()}return a&&a.info(`Toggle isUserDefaultView status for ${e.value} for ${o} entity`),this.props.onChangeUserDefaultView(o,e.value,s,"",t).then(()=>{if(a&&a.info("Resetting isUserDefaultView status of all the options and toggle the isUserDefaultView status of the recently selected item"),t&&this.props.entityTypeName===I.a){const t=this.props.gridViewSelectorItems[r.value];this.props.pinnedActivityView.PinnedEntity=t.relatedEntityName,this.props.pinnedActivityView.ViewId=new S.a(e.value),this.props.pinnedActivityView.ViewType=t.isUserView?P.b.userview:P.b.savedview}for(const e in this.props.gridViewSelectorItems)this.props.gridViewSelectorItems[e].isPinned=e===r.value&&t;this.forceUpdate()},i=>{var r;const s="Could not set selected view as user's default";if(a&&a.error(`${s}: ${i}`),this.props.isAdvancedFilteringEnabled){const a=[{name:"EntityTypeName",value:this.props.entityTypeName},{name:"ViewId",value:e.value},{name:"ShouldSetAsUserDefault",value:t}];null===(r=this.context.EventManager)||void 0===r||r.ReportComponentFailure(qe(n),i,s,a)}})}_onSaveAsNewView(){var e;null===(e=this.context.EventManager)||void 0===e||e.ReportComponentSuccess(qe(b.g)),this.props.saveFilterAsNewPersonalView(this.props.pageId,this.props.contextToken)}_onSaveChangesToCurrentView(){var e;null===(e=this.context.EventManager)||void 0===e||e.ReportComponentSuccess(qe(b.h)),this.props.saveFilterToPersonalView(this.props.pageId,this.props.contextToken)}_onManageAndShareView(e){var t,i;null===(t=this.context.EventManager)||void 0===t||t.ReportComponentSuccess(qe(b.e)),this.props.onManageAndShareViews(this.props.entityTypeName,null===(i=this.props.defaultViewId)||void 0===i?void 0:i.guid,e)}}function qe(e){return`${b.P}.${b.Q}.${e}`}function He(e,t,i,r){let n=[];if(t===I.a&&r){let t=1;We.forEach(i=>{n.push({id:t.toString(),name:Object(we.f)(e,i)}),t++})}else n=Object(I.pb)(e,i);return n}function Qe(e,t,i){let r;return t.forEach((t,n)=>{const a=function(e,t,i){let r=Object(O.f)(e,t,i);r&&!Object(De.c)(e)&&Object(je.n)(e,t)&&(r=Object.keys(r).reduce((n,a)=>((r[a].isAvailableInOffline||a===S.a.toString(Object(O.a)(e,t,i)))&&(n[a]=r[a]),n),{}));return r}(e,i,t);a&&(r=Object.assign(Object.assign({},r),a))}),r}Ge.displayName="DataSetViewSelector",Ge.contextType=ce.a;const Ke=Object(s.a)((function(){let e=null,t=null,i=null,r={gridViewSelectorItems:null,viewCategories:null,allActivitiesString:null,activities:null,activityOptions:null,resourceStrings:null,quickFindViewId:null,styleProps:null,useSortedViewSelectorItems:!1,viewSelectorSortOrder:null};const n=Object(E.a)(),a=Object(Oe.h)();return(s,o)=>{var l,c,u;const d=a(s,C.labelList),p=S.a.toString(Object(O.a)(s,o.entityTypeName,P.a.QUICKFIND_SEARCH));let h=null;let g=null;const m=n(s,o.contextString);We=Object(I.C)(s);let f=!1;if(o.queryViewSelectorTypes&&o.queryViewSelectorTypes.length>0&&!o.viewIds){if(o.entityTypeName===I.a&&o.shouldDisplayNestedViewSelector?(We.forEach(e=>{const t=Qe(s,o.queryViewSelectorTypes,e);t&&(h=Object.assign(Object.assign({},h),t))}),g=Object(Oe.e)(s,["ViewSelectorAllActivities"])):h=Qe(s,o.queryViewSelectorTypes,o.entityTypeName),e)for(const t in h)if(!e[t]||e[t]!==h[t]){f=!0;break}}else if(o.viewIds){const t={};for(let i=0;i<o.viewIds.length;i++){const r=Object(I.tb)(s,o.viewIds[i],o.id);if(r&&r.grid&&r.grid.rows){const i=e?e[r.viewId.guid]:void 0,n=!i||i.name!==r.title||i.queryType!==r.queryType,a=n?{name:r.title,queryType:r.queryType,isDefault:!1,isQuickFindQuery:!1,isUserView:r.isUserView}:i;Object.assign(t,{[r.viewId.guid]:a}),f=f||n}}t&&(h=t)}!h||e&&Object.keys(e).length===Object.keys(h).length||(f=!0),g&&r.allActivitiesString!==g.ViewSelectorAllActivities&&(f=!0),t!==p&&(f=!0),i!==m&&(f=!0);const b=Object(xe.c)(s);let y,v=!1;return b&&1===(null===(l=o.queryViewSelectorTypes)||void 0===l?void 0:l.length)&&o.queryViewSelectorTypes[0]===P.a.MAIN_APPLICATION_VIEW&&(v=!0,y=(null===(u=null===(c=Object(O.g)(s))||void 0===c?void 0:c[o.entityTypeName])||void 0===u?void 0:u.MAIN_APPLICATION_VIEW)||1),f&&(e=h,t=p,i=m,r={gridViewSelectorItems:e,viewCategories:He(s,o.entityTypeName,C,o.shouldDisplayNestedViewSelector),allActivitiesString:g&&g.ViewSelectorAllActivities,activities:null,activityOptions:null,resourceStrings:d,quickFindViewId:t,styleProps:i,isInMobileModeForOct2019:Object(Re.c)(s),isOctober2021Update:Object(Ne.f)(s,Fe.kf),isAdvancedFilteringEnabled:b,useSortedViewSelectorItems:v,viewSelectorSortOrder:y}),r}}),(function(e){return{loadViewsByType:(t,i,r)=>{const n=[];return t.forEach((t,a)=>{t===P.a.MAIN_APPLICATION_VIEW&&r&&0!==Object.keys(r).length||n.push(e(Object(Se.a)(i,t,void 0,void 0)))}),Promise.all(n)},loadAllActivityResourceString:()=>e(Object(_e.e)(["ViewSelectorAllActivities"])),loadAllActivityTypes:t=>{let i=null;for(const e in t)t[e].Initialized!==Ce.a.Initialized&&(i||(i={}),i[e]=["DisplayName","ActivityTypeMask","IsVisibleInMobileClient"]);return i?e(Object(Pe.e)(i)):Promise.resolve()},loadGridViewsByViewId:(t,i)=>{const r=[];return t.forEach((t,n)=>{r.push(e(Object(Se.a)(i,void 0,void 0,t,void 0,!0)))}),Promise.all(r)},openPopup:t=>e(Object(Ee.a)(t)),closePopup:t=>e(Object(Ie.a)(t)),saveFilterToPersonalView(t,i){e(Object(Ae.a)(t,i))},saveFilterAsNewPersonalView(t,i){e(Object(Me.b)(t,i))},onManageAndShareViews:(t,i,r)=>e(function(e,t,i){return{type:"open.view.management.dialog",async execute({getState:r,dispatch:n},a){if(!e||!Object(xe.c)(r()))return null;const s={height:void 0,width:592,windowPosition:"side"},o={param_entity_name:e,param_org_default_view_id:t,param_user_default_view_id:i},l=await n(Object(Be.b)("msdyn_ViewManagementDialog",s,o));0===l.status&&(await n(Object(Ve.a)(l.pageId)),setTimeout(async()=>{await n(Object(ze.a)()),await n(Object(Se.b)(e,P.a.MAIN_APPLICATION_VIEW,!0));const t={entityTypeName:e};n(Object(Le.a)(Ue.a.getName(),t))},100))}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(t,i,r))}}))(Ge);var Xe=i("Ki7F"),Ye=i("o0iw"),Je=i("N2HV"),$e=i("Wdaq"),Ze=i("/aHX"),et=i("ZGH+"),tt=i("AVDU");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const it=42;class rt extends r.Component{constructor(e){super(e),this.onMeasuring=this.onMeasuring.bind(this),this.state={commandbarWidth:0},this._lastCommandManagerId=e.commandManagerId}onMeasuring(e){const t=e-((this.props.style.paddingLeft?"string"==typeof this.props.style.paddingLeft?Object(et.e)(this.props.style.paddingLeft):this.props.style.paddingLeft:0)+(this.props.style.paddingRight?"string"==typeof this.props.style.paddingRight?Object(et.e)(this.props.style.paddingRight):this.props.style.paddingRight:0))-(this.props.backButtonEnabled?it:0);t!==this.state.commandbarWidth&&this.setState({commandbarWidth:t})}componentDidUpdate(){this.props.commandManagerId!==this._lastCommandManagerId&&(this._lastCommandManagerId=this.props.commandManagerId,this.props.setCommandManagerId(this.props.pageId,this.props.commandManagerId,this.props.contextToken))}_renderConsoleAppBackButton(){return this.props.backButtonEnabled?r.createElement(Ze.a,{pageId:this.props.pageId}):null}_renderNativeSubgridCommandBar(){return this.props.isNativeSubgridMode?r.createElement(Te.h,{commandManagerId:this.props.commandManagerId,pageId:this.props.pageId}):null}_renderNativeItemLevelCommandDrawer(){return this.props.renderItemLevelCommandDrawer?r.createElement(Te.f,{commandManagerId:this.props.commandManagerId,pageId:this.props.pageId,contextToken:this.props.contextToken,ribbonId:this.props.ribbonId,onCloseItemLevelDrawer:this.props.onCloseItemLevelCommandDrawer,itemLevelCommandList:this.props.itemLevelCommandList}):null}render(){if(!this.props.pageId||!this.props.ribbonId||!this.props.commandManagerId)return null;const e=!this.state.commandbarWidth,t=r.createElement(Xe.a,{commandBarStyle:this.props.commandbarStyles,width:this.state.commandbarWidth,commandbarDisplayMode:Ye.a.IconLabel,key:this.props.pageId,iconPosition:Je.a.Left,commandManagerId:this.props.commandManagerId,id:this.props.pageId,ribbonId:this.props.ribbonId,relationshipType:this.props.relationshipType,addedCommandList:this.props.addedCommandList,appendedCommandList:this.props.appendedCommandList,contextToken:this.props.contextToken,metaDataLoadedResolve:this.props.metaDataLoadedResolve,isHidden:e,rootZIndex:this.props.rootZIndex,customControlType:this.props.customControlType,isNativeMode:this.props.isNativeSubgridMode||this.props.renderItemLevelCommandDrawer,skipPageXrmReady:this.props.skipPageXrmReady});return this.props.isInMobileModeForOct2019&&this.props.isGridRoot&&!this.props.renderItemLevelCommandDrawer?t:r.createElement(o.a,{key:"commandBar_"+this.props.pageId,testhooks:{id:"commandBar_"+this.props.pageId},style:this.props.style,onMeasuring:this.onMeasuring,isRequestedMeasuring:!0},this._renderConsoleAppBackButton(),t,this._renderNativeSubgridCommandBar(),this._renderNativeItemLevelCommandDrawer())}}rt.displayName="DataSetCommandBar";const nt=Object(s.a)((function(){return(e,t)=>{const i=Object(Re.c)(e);return{commandManagerId:Object(I.w)(e,t.pageId,t.contextToken)||t.commandManagerId,backButtonEnabled:Object(tt.h)(e)&&t.isGridRoot&&!t.collapsed,isInMobileModeForOct2019:i}}}),(function(e){return{setCommandManagerId:(t,i,r)=>{t&&i&&r&&e(Object($e.b)(t,i,r))}}}))(rt);var at=i("F1bw"),st=i("jAuy");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function ot(e){if(e){const t=e.split(":");if(2===t.length){return t[1].split(",")}}return[]}function lt(e){if(e&&e.filterOptions&&e.filterOptions.length>0){let t=e.filterOptions.filter(e=>e.isDefault);const i=e.userSetting,n=i&&i.defaultGridViews&&i.defaultGridViews[e.entityTypeName];let a,s;n&&""!==n.QueueId&&(t=e.filterOptions.filter(e=>Object(I.eb)(n.QueueId).sort().join(",")===ot(e.value).sort().join(","))),e.isGridPaginationStateFeatureEnabled&&null!=e.previousValue&&(a=Object(st.f)(e.filterOptions,e.previousValue),s=e.previousValue),a||(t.length>0?(a=t[0].text,s=t[0].value):(a=e.filterOptions[0].text,s=e.filterOptions[0].value)),e.updateFilterValue(s);const l=Object(Oe.c)(e.resourceStrings,C.QUEUE_FILTER_LABEL),c=r.createElement(at.a,{key:"gridFilter",testhooks:{id:"gridFilter_"+e},title:l,accessibilityLabel:l,defaultValue:a,options:e.filterOptions,onChange:e.onFilterChange,createAccessibilityComponent:w.a,style:e.comboBoxStyle,createKeyboardShortcut:w.b,freeTextMode:!0,suppressFreeTextChangeCallback:!0});return r.createElement(o.a,{key:"GridFilterView",style:e.style},c)}const t=e.TraceManager&&e.TraceManager.getTracer?e.TraceManager.getTracer(b.P):null;return t&&t.info("Queue Filter not rendered because there are no filter options available"),null}var ct=i("KOTC"),ut=i("CbNq"),dt=i("H4dV"),pt=i("rhTL");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const ht={Id:"toggleButtonControl",Label:null,Name:"toggleButtonControl",ShowLabel:!1,Visible:!0,Disabled:!1},gt={FormFactor:2,CustomControlId:"MscrmControls.FlipSwitch.FlipSwitchControl",Name:"MscrmControls.FlipSwitch.FlipSwitchControl",Version:"1.0.0",Parameters:{value:{Usage:3,Static:!1,Value:0,Type:"TwoOptions",Attributes:{DefaultValue:0,Options:null},Callback:null}},ShouldOverrideControlVisible:!1};function mt(e,t){if(!e.isRollupViewSupported)return null;const i=function(e){const t=[];if(!Array.isArray(e))return t;for(let i=0;i<e.length;++i)t.push({Label:e[i],Value:i});return t}([Object(Oe.c)(e.resourceStrings,C.ROLLUPVIEW_SWITCH_OFF),Object(Oe.c)(e.resourceStrings,C.ROLLUPVIEW_SWITCH_ON)]),n=e.isOffline,a=(s=e.toggleValue,o=t,l=e.onToggleChange,c=i,Object.assign(Object.assign({},gt),{Parameters:{value:{Usage:3,Static:!1,Type:"TwoOptions",Value:s?1:0,Attributes:{DefaultValue:0,Options:c,DisplayName:o},Callback:l}}}));var s,o,l,c;const u=function(e,t){return Object.assign(Object.assign({},ht),{Label:e,Disabled:t})}(t,n),d="rollup_view_switch_"+e.id;return r.createElement(p.c,{key:d,controlId:d,id:e.id,systemDefinedProperties:null,descriptor:u,configuration:a,formInfo:void 0,shouldRender:!0,parentContextToken:null,parentDefinedControlProps:void 0})}function ft(e,t,i,n,a){const s=e.theme,l=e.isRTL,c=e.isActivityManagementFeatureEnabled&&e.entityIsActivityType;return r.createElement(o.a,{key:"ActivityViewContainer",role:"presentation",style:e.activityViewContainerStyle},r.createElement(o.a,{key:"ActivityDueDateFilterView",style:c?e.activityTypeContainerStyle:e.containerStyle},[t,i]),a?r.createElement(o.a,{key:"ActivityTypeFilterView",style:e.activityTypeContainerStyle},[n,a]):null,function(e,t,i,n){if(!t)return;const a=Object(Oe.c)(e.resourceStrings,C.ROLLUPVIEW_SWITCH_LABEL),s={flex:"1 1 auto",marginLeft:i.sizes.Measures.Measure200,marginRight:i.sizes.Measures.Measure200,marginTop:i.sizes.Measures.Measure050,minWidth:"15rem"},l={whiteSpace:"nowrap",flex:"1 0 auto",marginRight:n?0:i.sizes.Measures.Measure100,marginLeft:n?i.sizes.Measures.Measure100:0};return r.createElement(o.a,{key:"RollupViewControlContainer",style:s},r.createElement(o.a,{key:"rollupViewFilterLabelView",style:l},a),mt(e,a))}(e,e.isRollupViewSupported,s,l))}const bt=Object(s.a)(void 0,(function(e){return{openPopup:t=>e(Object(Ee.a)(t)),closePopup:t=>e(Object(Ie.a)(t))}}))((function(e){const t=e.TraceManager&&e.TraceManager.getTracer?e.TraceManager.getTracer(b.P):null;let n,a="";const s=e.isActivityManagementFeatureEnabled&&e.entityIsActivityType;if(e&&e.filterOptions&&e.filterOptions.length>0){const t=e.filterOptions.filter(e=>e.isDefault);s&&(n=Object(ut.d)(e.filterOptions)),e.isGridPaginationStateFeatureEnabled&&null!=e.previousValue&&(a=s?e.previousValue:Object(st.f)(e.filterOptions,e.previousValue)),a||(a=t.length>0?s?t[0].value:t[0].text:s?e.filterOptions[0].value:e.filterOptions[0].text)}const[l,u]=r.useState(a);if(e&&e.filterOptions&&e.filterOptions.length>0){const d={flex:"1 0 auto",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",width:"0px"},p=s?Object(Oe.c)(e.resourceStrings,e.dueDateFilterLabelResourceString):Object(Oe.c)(e.resourceStrings,e.entityFilterLabelResourceString);let h=null;p&&(h=r.createElement(c.a,{key:"activityDueDateFilterLabel",style:s?e.activityMgmtLabelStyle:e.labelStyle}," ",p," "));const g=r.createElement(o.a,{key:"activityDueDateFilterLabelView",style:{alignItems:"flex-start",justifyContent:"flex-start"}},h);let m=r.createElement(at.a,{key:"activityDueDateFilterComboBox",testhooks:{id:"activityDueDateFilterComboBox_"+e.id},id:"activityDueDateFilterComboBox",defaultValue:a,options:e.filterOptions,onChange:e.onFilterChange,createAccessibilityComponent:w.a,style:e.comboBoxStyle,textStyle:d,createKeyboardShortcut:w.b,openPopup:e.openPopup,closePopup:e.closePopup,parentCustomControlId:"activityDueDateFilterComboBox",rootZIndex:e.rootZIndex,accessibilityLabel:p,freeTextMode:!0,suppressFreeTextChangeCallback:!0});s&&(m=r.createElement(ct.a,{key:"activityDueDateFilterComboBox",loader:()=>Object(pt.c)().then(e=>e.ComboBox),props:{selectedKey:l,key:"activityDueDateFilterComboBox",id:"activityDueDateFilterComboBox",options:n,onChange:(t,i)=>{u(i.key),e.onFilterChange(i.key)},style:e.dueDatecomboBoxStyle,ariaLabel:p,useComboBoxAsMenuWidth:!0,allowFreeform:!0,shouldRestoreFocus:!0}}));const f=dt.a.getInstance().get_IsMobilePhone();if(e.isActivityManagementFeatureEnabled&&!e.isOffline&&!f&&e.gridEntityName===b.a){let n=null;const a=Object(Oe.c)(e.resourceStrings,e.activityTypeFilterLabelResourceString);a&&(n=r.createElement(c.a,{key:"activityTypeFilterLabel",style:e.activityMgmtLabelStyle}," ",a," "));const s=r.createElement(o.a,{key:"activityTypeFilterLabelView",style:{alignItems:"flex-start",justifyContent:"flex-start"}},n);let l;if(e.filterOptionsForActivityType&&e.filterOptionsForActivityType.length>0){t&&t.info("Activity Management Filter - Activity Type Filter Rendered with no. of options "+e.filterOptionsForActivityType.length);let n=Object(ut.c)(e.filterOptionsForActivityType);if(e.isActivityFilterSelectAllEnabled){const t=Object(Oe.c)(e.resourceStrings,C.ACTIVITYTYPE_SELECTALL),i=[];i.push({key:"selectAllKey",text:t}),n=i.concat(n)}let s=[];e.isGridPaginationStateFeatureEnabled&&null!=e.activityTypePreviousValues&&(s=Object(ut.b)(e.activityTypePreviousValues)),l=r.createElement(ct.a,{key:"activityTypeFilterBox",loader:()=>Promise.all([i.e(30),i.e(189),i.e(91)]).then(i.bind(null,"yiyP")).then(e=>e.ActivityTypeCombobox),props:{key:"activityTypeFilterBox",id:"activityTypeFilterBox",selectedOptionKeys:s,onActivityTypeFilterClear:()=>{e.onActivityTypeFilterClear()},onActivityTypeMenuDismissed:t=>{e.onActivityTypeChange(t)},options:n,ariaLabel:a,isRTL:e.isRTL,style:e.activityTypeContainerStyle,resourceStrings:e.resourceStrings,selectAllEnabled:e.isActivityFilterSelectAllEnabled}})}return ft(e,g,m,s,l)}return ft(e,g,m,null,null)}return t&&t.info("Activity Filter not rendered because there are no filter options available"),null}));var yt=i("nJrx"),vt=i("xqqo"),St=i("Eqw3"),_t=i("MTWl"),Ot=i("q441"),Pt=i("InN9"),wt=i("hSDL"),Ct=i("unFF"),It=i("tJ+6");var Et=i("kC0I"),jt=i("3rse"),Dt=i("00VO"),Tt=i("FhVi"),Ft=i("Afz2"),Nt=i("Gilj"),Rt=i("cz9j"),kt=i("L4PC");class At extends r.Component{constructor(e){super(e),this._cachedSelectedFilter="",this._onFilterChange=this._onFilterChange.bind(this),this._toggleJumpBarFlyout=this._toggleJumpBarFlyout.bind(this),this._closeJumpBarDomId="close-jumpbar-"+Object(yt.a)(),this._selectedFilterDomId="selected-filter-"+Object(yt.a)(),this.state={isFlyoutOpened:!1}}_onOutsideClickHandler(e,t){const i=t.target,r=document.getElementById(e);i&&!r.contains(i)&&r!==i&&this._toggleJumpBarFlyout()}keyDownHandler(e){switch(e.EVENT.keyCode){case jt.a.Escape:this._setIsFlyoutOpenedState(!1)}}_toggleJumpBarFlyout(){this._setIsFlyoutOpenedState(!this.state.isFlyoutOpened)}_setIsFlyoutOpenedState(e){this.setState({isFlyoutOpened:e}),Object(Rt.g)(e)}_filterGrid(e){let t,i=e.getAttribute("data-value");if(i!==this._cachedSelectedFilter&&(this.props.updateDataSetLoadingState(1),this._cachedSelectedFilter=i),1033===this.props.languageId&&i){const t=e.getAttribute("data-value").toUpperCase();t!==i&&(i=`${i}|${t}`)}t=this.props.dataSetFetchXml?Object(Dt.c)(this.props.dataSetFetchXml,this.props.entityAttributeMetadata,this.props.primaryNameAttribute):this.props.primaryNameAttribute,this.props.applyGridFilter(Object(Dt.b)(i,t),this.props.isGridRoot,this.props.contextToken),this._setIsFlyoutOpenedState(this.props.renderMobile&&!this.state.isFlyoutOpened)}_onFilterChange(e){let t=e.target;const i=e;("click"===e.type||i&&i.keyCode===jt.a.Enter)&&(e.preventDefault(),t&&"a"===t.tagName.toLowerCase()&&(t=t.parentElement),this._filterGrid(t))}_renderListItem(e,t,i){let n=Object.assign({},this.props.renderMobile?this.props.styles.listItemStyleMobile:this.props.styles.listItemStyle),a=Object.assign(Object.assign({},this.props.styles.hyperlinkStyle),this.props.renderMobile?this.props.styles.hyperlinkStyleMobile:null);return i.describedByElementId&&(n=Object.assign(n,this.props.renderMobile?this.props.styles.listItemSelectedStyleMobile:this.props.styles.listItemSelectedStyle),a=Object.assign(a,this.props.renderMobile?this.props.styles.hyperlinkSelectedStyleMobile:null)),r.createElement(St.a,Object.assign({},i,{style:n}),r.createElement(_t.a,Object.assign({},e,{style:a}),t))}_createKeyboardShortcuts(){const e=Object(Oe.c)(this.props.resourceStrings,C.CLOSE_JUMPBAR_ARIALABEL),t=this.keyDownHandler.bind(this),i=[],r=new Nt.a([jt.a.Escape],t,!0,"",e);return i.push(r),i}_renderJumpBarAlphabet(){const e=[],t=Object(Oe.c)(this.props.resourceStrings,C.JUMPBAR_ALPHABET),i=Object(Oe.c)(this.props.resourceStrings,C.JUMPBAR_NUMBER_INDICATOR),r=Object(Oe.c)(this.props.resourceStrings,C.JUMPBAR_NUMBER_TOOLTIP),n=dt.a.getInstance(),a=!!n&&n.get_IsIOS();return t.split(",").forEach(t=>{const n=Object(Et.j)(t),s=n[0],o=n[1],l=s+"_listItem",c=s+"_link",u={id:l,key:l,accessibilityLabel:String.format(C.FILTERBY_ARIALABEL,o),role:Ft.u,onClick:this._onFilterChange,onKeyDown:this._onFilterChange,tabIndex:-1},d={id:c,key:c,testhooks:{id:c},tabIndex:-1,role:Ft.v,accessibilityHidden:!a,accessibilityLabel:a?String.format(C.FILTERBY_ARIALABEL,o):void 0};s===i&&(d.title=r,d.accessibilityLabel=C.NUMBER_ARIALABEL),this.props.selectedFilter!==s&&this.props.selectedFilter!==o||(u.describedByElementId=this._selectedFilterDomId,u.isSelected=!0,u.tabIndex=0),o&&(u.dataValue=o),e.push(this._renderListItem(d,s,u))}),e}_renderJumpBarAll(){const e=Object(Oe.c)(this.props.resourceStrings,C.JUMPBAR_ALL),t=Object(Oe.c)(this.props.resourceStrings,C.JUMPBAR_ALL_TITLE);this._allListItemDomId=e+"_listItem";const i=e+"_link",r=dt.a.getInstance(),n=!!r&&r.get_IsIOS(),a={id:this._allListItemDomId,key:this._allListItemDomId,onClick:this._onFilterChange,onKeyDown:this._onFilterChange,role:Ft.u,tabIndex:-1,accessibilityLabel:String.format(C.FILTERBY_ARIALABEL,e)},s={id:i,key:i,testhooks:{id:i},tabIndex:-1,role:Ft.v,accessibilityHidden:!n,accessibilityLabel:n?String.format(C.FILTERBY_ARIALABEL,e):void 0,title:t};return this.props.selectedFilter&&this.props.selectedFilter!==e||(a.describedByElementId=this._selectedFilterDomId,a.isSelected=!0,a.tabIndex=0),this._renderListItem(s,e,a)}_renderList(){const e=Object(Oe.c)(this.props.resourceStrings,C.JUMPBAR_LETTER_TITLE);return r.createElement(vt.a,{id:"JumpBarItemsList",key:"JumpBarItemsList",testhooks:{id:"JumpBarItemsList"},title:e,role:Ft.m,onKeyDown:this._onJumpbarKeyDown.bind(this),style:Object.assign(Object.assign({},this.props.styles.jumpBarStyle),this.props.renderMobile?this.props.styles.jumpBarStyleMobile:null),accessibilityLabel:C.JUMPBAR_ARIALABEL},this._renderJumpBarAll(),this._renderJumpBarAlphabet())}_onJumpbarKeyDown(e){const t=e.target;if(this.state.isFlyoutOpened){const i=9===e.keyCode,r=e.shiftKey;if(i){if(e.stopPropagation(),e.preventDefault(),r){if(t.id===this._closeJumpBarDomId)return void document.querySelector("#JumpBarItemsList").lastElementChild.focus();const e=t.previousElementSibling;e?e.focus():t.id===this._allListItemDomId&&document.getElementById(this._closeJumpBarDomId).focus()}else{if(t.id===this._closeJumpBarDomId)return void document.getElementById(this._allListItemDomId).focus();if(t.parentElement&&t.parentElement.lastElementChild&&t.id===t.parentElement.lastElementChild.getAttribute("id"))return void document.getElementById(this._closeJumpBarDomId).focus();const e=t.nextElementSibling;e&&e.focus()}return}}if(e.keyCode===jt.a.UpArrow||e.keyCode===jt.a.DownArrow||e.keyCode===jt.a.LeftArrow||e.keyCode===jt.a.RightArrow){e.stopPropagation(),e.preventDefault();const i=e.keyCode===jt.a.DownArrow||e.keyCode===jt.a.RightArrow,r=e.keyCode===jt.a.UpArrow||e.keyCode===jt.a.LeftArrow;if(i){const e=t.nextElementSibling;return void(e&&e.focus())}if(r){const e=t.previousElementSibling;e&&e.focus()}}}_renderJumpBarFlyout(e,t){const i="jumpbar-flyout_"+this.props.id,n=i+"Accessibility",a=[];return a.push(r.createElement(Tt.a,{key:n,rootElementId:i,shouldManageFocus:!0,isModal:!0,keyboardShortcuts:this._createKeyboardShortcuts(),defaultFocusId:this._closeJumpBarDomId})),r.createElement(o.a,{role:Ft.f,testhooks:{"uci-dialog":!0}},r.createElement(Pt.b,{id:i,testhooks:{id:i},key:i,rootZIndex:this.props.rootZIndex,positionType:"relative",relativeToElementId:t,flyoutStyle:this.props.styles.jumpBarFlyoutStyle,flyoutDirection:this.props.isRTL?Pt.c.upleft:Pt.c.rightup,onOutsideClick:this._onOutsideClickHandler.bind(this,e)},r.createElement(Ot.a,{key:"cancel",style:this.props.styles.closeButtonStyle,id:this._closeJumpBarDomId,onClick:this._toggleJumpBarFlyout,onKeyDown:this._onJumpbarKeyDown.bind(this),accessibilityLabel:C.CLOSE_JUMPBAR_ARIALABEL},r.createElement(c.a,{style:this.props.styles.closeButtonTextStyle},r.createElement(Je.b,{type:d.a.Close}))),this._renderList()),a)}_renderFlyoutButton(e){const t=Object(Oe.c)(this.props.resourceStrings,C.JUMPBAR_LETTER_TITLE),i=Object(Oe.c)(this.props.resourceStrings,C.JUMPBAR_ALPHABET).split(",");let n="";for(let e=0;e<3;e++){n+=Object(Et.j)(i[e+1])[0]}return r.createElement(Ot.a,{id:e,accessibilityLabel:t,title:t,style:this.props.isMobile?this.props.styles.jumpBarButtonMobileStyle:this.props.styles.jumpBarButtonStyle,onClick:this._toggleJumpBarFlyout,testhooks:{id:e}},r.createElement(c.a,{style:this.props.styles.jumpBarButtonTextStyle},n))}render(){try{if(this.props.resourceStrings){const e="jumpBarRoot_"+this.props.id,t=`${e}_${this.props.uniqueId}`,i="jumpbarBtn_"+(this.props.uniqueId||this.props.id),n={position:"relative"};this.props.renderMobile&&Object.assign(n,{maxWidth:"100%"});const a={height:"0",width:"0"},s="flyoutRelativeElement"+this.props.controlKey;return r.createElement(o.a,{id:t,key:t,testhooks:{id:e},style:n},this.props.isRTL?null:r.createElement(o.a,{id:s,style:a,role:"presentation","aria-hidden":"true"}),this.props.renderMobile?this._renderFlyoutButton(i):this._renderList(),this.state.isFlyoutOpened?this._renderJumpBarFlyout(i,s):null,r.createElement(o.a,{style:{display:"none"},id:this._selectedFilterDomId,key:this._selectedFilterDomId,role:" "},C.SELECTEDFILTER_TEXT),this.props.isRTL?r.createElement(o.a,{id:s,style:a,role:"presentation","aria-hidden":"true"}):null)}return null}catch(e){return console.error(e.message),null}}}const Mt=Object(s.a)((function(){let e=null,t=null,i=null;const r=Object(Oe.h)(),n=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(){let e=null,t=null;return function(i,r){var n,a,s,o,l,c,u,d,p,h,g,m,f,b,y,v,S,_,O,P,w,C,I,E,j,D,T,F,N,R,k,A,M,x;const L=Object(Ct.a)(i),V=Object(It.b)(i)&&Object(Ne.e)(i,Fe.jd,Fe.jf)&&(null===(n=Object(It.a)(i))||void 0===n?void 0:n.Components)?Object(It.a)(i).Components:null;return t!==L&&(t=L,e={jumpBarStyle:{width:"100%",height:L.sizes.Measures.Measure300,display:"flex",flexDirection:"row",justifyContent:"space-around",alignItems:"center",listStyleType:"none",backgroundColor:(null===(o=null===(s=null===(a=null==V?void 0:V.Grid)||void 0===a?void 0:a.Footer)||void 0===s?void 0:s.JumpBar)||void 0===o?void 0:o.BackgroundColor)||L.colors.BaseColor.Grey.Grey1,border:"1px solid transparent"},jumpBarButtonStyle:{display:"flex",fontSize:L.fontSizes.Font085,fontFamily:L.fontFamilies.Regular,color:(null===(u=null===(c=null===(l=null==V?void 0:V.Grid)||void 0===l?void 0:l.Footer)||void 0===c?void 0:c.JumpBar)||void 0===u?void 0:u.TextColor)||L.colors.MainThemeColor.MainColor1.Fill,cursor:L.display.PointerCursorStyle,borderStyle:"none",backgroundColor:"transparent",padding:"0",marginLeft:L.sizes.Measures.Measure100,marginRight:L.sizes.Measures.Measure100,marginTop:L.sizes.Measures.Measure050,marginBottom:L.sizes.Measures.Measure050,maxWidth:"100%"},jumpBarButtonMobileStyle:{display:"flex",fontSize:L.fontSizes.Font100,fontFamily:L.fontFamilies.Regular,color:(null===(h=null===(p=null===(d=null==V?void 0:V.Grid)||void 0===d?void 0:d.Footer)||void 0===p?void 0:p.JumpBar)||void 0===h?void 0:h.TextColor)||L.colors.MainThemeColor.MainColor1.Fill,cursor:L.display.PointerCursorStyle,borderStyle:"none",backgroundColor:"transparent",padding:"0",marginLeft:L.sizes.Measures.Measure100,marginRight:L.sizes.Measures.Measure100,marginTop:L.sizes.Measures.Measure050,marginBottom:L.sizes.Measures.Measure050,maxWidth:"100%"},jumpBarButtonTextStyle:{textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"},jumpBarFlyoutStyle:{border:L.borders.Border02,backgroundColor:L.colors.BaseColor.Grey.Grey1,overflowY:"auto",overflowX:"hidden"},closeButtonStyle:{position:"absolute",top:"0",right:"0",borderStyle:"none",display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"transparent",cursor:L.display.PointerCursorStyle,padding:L.sizes.Measures.Measure100,width:L.sizes.Measures.Measure300,height:L.sizes.Measures.Measure300},closeButtonTextStyle:{fontSize:"16px",color:L.colors.BaseColor.Grey.Grey7},jumpBarStyleMobile:{height:"auto",flexWrap:"wrap",display:"flex",alignItems:"center",justifyContent:"flex-start",paddingTop:L.sizes.Measures.Measure300,paddingRight:L.sizes.Measures.Measure050,paddingBottom:L.sizes.Measures.Measure150,paddingLeft:L.sizes.Measures.Measure300,maxWidth:"20rem"},listItemStyle:{textAlign:"center",position:"relative",height:L.sizes.Measures.Measure125},listItemSelectedStyle:{borderStyle:"solid",borderBottomColor:(null===(f=null===(m=null===(g=null==V?void 0:V.Grid)||void 0===g?void 0:g.Footer)||void 0===m?void 0:m.JumpBar)||void 0===f?void 0:f.SelectedColor)||L.colors.MainThemeColor.MainColor1.Fill,borderBottomWidth:L.sizes.Measures.Measure025},listItemStyleMobile:{display:"flex",alignItems:"center",justifyContent:"center",cursor:L.display.PointerCursorStyle,marginRight:L.sizes.Measures.Measure150,marginBottom:L.sizes.Measures.Measure150,width:L.sizes.Measures.Measure300,height:L.sizes.Measures.Measure300,border:L.borders.Border01,borderColor:(null===(v=null===(y=null===(b=null==V?void 0:V.Grid)||void 0===b?void 0:b.Footer)||void 0===y?void 0:y.JumpBar)||void 0===v?void 0:v.BorderColor)||L.colors.BaseColor.Blue.Blue3,backgroundColor:(null===(O=null===(_=null===(S=null==V?void 0:V.Grid)||void 0===S?void 0:S.Footer)||void 0===_?void 0:_.JumpBar)||void 0===O?void 0:O.BackgroundColorMobile)||L.colors.BaseColor.White,":nth-child(2)":{marginRight:"50%"},outlineOffset:"0px !important"},listItemSelectedStyleMobile:{borderColor:(null===(C=null===(w=null===(P=null==V?void 0:V.Grid)||void 0===P?void 0:P.Footer)||void 0===w?void 0:w.JumpBar)||void 0===C?void 0:C.SelectedBorderColor)||L.colors.BaseColor.Transparent,backgroundColor:(null===(j=null===(E=null===(I=null==V?void 0:V.Grid)||void 0===I?void 0:I.Footer)||void 0===E?void 0:E.JumpBar)||void 0===j?void 0:j.SelectedColorMobile)||L.colors.BaseColor.Grey.Grey2},hyperlinkStyle:{textDecoration:"none",textAlign:"center",fontSize:L.fontSizes.Font085,fontFamily:L.fontFamilies.Regular,whiteSpace:"nowrap",color:(null===(F=null===(T=null===(D=null==V?void 0:V.Grid)||void 0===D?void 0:D.Footer)||void 0===T?void 0:T.JumpBar)||void 0===F?void 0:F.LinkColor)||L.colors.BaseColor.Grey.Grey7},hyperlinkStyleMobile:{color:(null===(k=null===(R=null===(N=null==V?void 0:V.Grid)||void 0===N?void 0:N.Footer)||void 0===R?void 0:R.JumpBar)||void 0===k?void 0:k.LinkColor)||L.colors.BaseColor.Blue.Blue3},hyperlinkSelectedStyleMobile:{color:(null===(x=null===(M=null===(A=null==V?void 0:V.Grid)||void 0===A?void 0:A.Footer)||void 0===M?void 0:M.JumpBar)||void 0===x?void 0:x.SelectedBorderColor)||L.colors.BaseColor.Grey.Grey7}}),e}}();return(a,s)=>{const o=n(a,s);if(null===e&&(e=Object(we.H)(a,s.entityTypeName)),null==t&&(t=a.metadata.attributes[s.entityTypeName]),Object(Ne.e)(a,Fe.Sd)){const e=Object(I.v)(a,s.id,s.contextToken);i=e&&e.fetchXml}return{resourceStrings:r(a,C.labelList),primaryNameAttribute:e,dataSetFetchXml:i,entityAttributeMetadata:t,styles:o}}}),(function(e,t){return{applyGridFilter:(i,r,n)=>{if(e(Object(wt.m)(i,t.id,n)),e(Object(kt.b)(t.id,n,1)),r){const e=[{filterType:4,filterExpressionOrValue:i}];t.updateGridPaginationStateHandler(e,t.id),t.setResetPagingInfoForEnhancedPaging()}}}}))(At);var xt=i("49Nd");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var Lt=i("5UPV"),Vt=i("RrRu"),Bt=i("jRHm"),zt=i("lEp6"),Ut=i("wFY3"),Wt=i("LAGg"),Gt=i("fU7K");class qt extends r.Component{constructor(e){super(e),this._goToFirstPage=this._goToFirstPage.bind(this),this._goToPreviousPage=this._goToPreviousPage.bind(this),this._goToNextPage=this._goToNextPage.bind(this),Object(Oe.c)(e.resourceStrings,xt.d)||e.retrieveResourceStrings(xt.k)}_firstButtonEnabled(e){return this.props.currentPage>1}_nextButtonEnabled(e){return(!(this.props.currentPage===Math.floor(e.totalResultCount/e.pageSize))||!this.props.pagingInfo.isGridScrolledToBottom)&&e.hasNextPage}_previousButtonEnabled(e){return this.props.currentPage>1}_goToNextPage(e){this.props.updateDataSetLoadingState(1),this.props.incrementLastPage(),this.props.setNewPageRequested(!0),this.props.updatePageNumber(this.props.currentPage+1),this._setFooterButtonsFocus(e,!0)}_goToPreviousPage(e){this.props.updateDataSetLoadingState(1),this.props.setNewPageRequested(!0),this.props.updatePageNumber(this.props.currentPage-1),this._setFooterButtonsFocus(e,!1)}_goToFirstPage(e){this.props.updateDataSetLoadingState(1),this.props.setNewPageRequested(!0),this.props.setFirstPage(1),this.props.updatePageNumber(1),this._setFooterButtonsFocus(e,!1)}_setFooterButtonsFocus(e,t){if(null!==e&&null!==e.currentTarget&&null!==e.currentTarget.parentElement&&null!==e.currentTarget.parentElement.children)if(t&&e.currentTarget.parentElement.children.length>=2&&null!==e.currentTarget.parentElement.children[1]){const t=e.currentTarget,i=e.currentTarget.parentElement.children[1];setTimeout(()=>{t.disabled&&i.focus()},500)}else if(!t&&null!==e.currentTarget.parentElement.lastElementChild){const t=e.currentTarget,i=e.currentTarget.parentElement.lastElementChild;setTimeout(()=>{t.disabled&&i.focus()},500)}}_getResources(){if(this._loadFirstPage=this._loadFirstPage||Object(Oe.c)(this.props.resourceStrings,xt.d),this._loadNextPage=this._loadNextPage||Object(Oe.c)(this.props.resourceStrings,xt.e),this._loadPreviousPage=this._loadPreviousPage||Object(Oe.c)(this.props.resourceStrings,xt.f),!this._spaceResource){const e=Object(Oe.c)(this.props.resourceStrings,xt.j);this._spaceResource=Object(Gt.CrmHtmlDecode)(e)}this._gridInfoResource=this._gridInfoResource||Object(Oe.c)(this.props.resourceStrings,xt.a),this._gridTotalCount=this._gridTotalCount||Object(Oe.c)(this.props.resourceStrings,xt.c),this._itemSelected=this._itemSelected||Object(Oe.c)(this.props.resourceStrings,xt.b),this._totalApproximate=this._totalApproximate||Object(Oe.c)(this.props.resourceStrings,xt.h),this._totalExact=this._totalExact||Object(Oe.c)(this.props.resourceStrings,xt.i)}render(){if(!this.props.pagingData)return null;const e=Object(zt.a)(this.props.pagingData);let t=0,i=0;e.totalResultCount&&(this.props.enhancedPagingDisabled?(t=e.pageSize*(this.props.currentPage-1)+1,i=this.props.currentPage*e.pageSize,-1!==e.totalResultCount&&this.props.currentPage*e.pageSize>e.totalResultCount&&(i=e.totalResultCount,this.props.isServerOffline&&this.props.currentPage>1&&(i=e.pageSize*(this.props.currentPage-1)+e.totalResultCount))):(t=e.pageSize*(this.props.pagingInfo.firstPageNumber-1)+1,i=this.props.pagingInfo.lastPageNumber*e.pageSize,this.props.pagingInfo.pageShift>0&&(t+=this.props.pagingInfo.pageShift,i+=this.props.pagingInfo.pageShift),-1!==e.totalResultCount&&this.props.pagingInfo.lastPageNumber*e.pageSize>e.totalResultCount&&(i=e.totalResultCount,this.props.isServerOffline&&this.props.currentPage>1&&(i=e.pageSize*(this.props.currentPage-1)+e.totalResultCount))));const n=e.totalResultCount,a=this._firstButtonEnabled(e),s=this._nextButtonEnabled(e),l=this._previousButtonEnabled(e);this._getResources();let c=n;-1===n&&(c=i<this.props.gridTotalRecordsCountLimit?this.props.gridTotalRecordsCountLimit:i);let u="";u=-1===n?String.format(this._totalApproximate,this.props.isServerOffline?i:c):this.props.isServerOffline&&n>e.pageSize?String.format(this._totalApproximate,i):String.format(this._totalExact,this.props.isServerOffline?i:n);const d=String.format(this._gridTotalCount,this._spaceResource,u),p=this.props.selectedRowCount>0?String.format(this._itemSelected,this._spaceResource,this.props.selectedRowCount):null,h=Object(Oe.c)(this.props.resourceStrings,xt.g),g=String.format(h,this.props.currentPage);let m=n/e.pageSize;return this.props.isServerOffline&&0!==this.props.currentPage&&(m=-1/e.pageSize),r.createElement(o.a,{style:this.props.styleProps.containerStyle},this._renderPagingText(t,i,d,p),this._renderPagingButtons(a,s,l,g,m))}_renderPagingButtons(e,t,i,n,a){return(a<0||a>1)&&this.props.enhancedPagingDisabled?r.createElement(o.a,{style:this.props.styleProps.navigationPanelStyle},r.createElement(Ot.a,{style:this.props.styleProps.pagingButton,testhooks:{id:"loadFirstPage_"+this.props.id},accessibilityLabel:this._loadFirstPage,disabled:!e,tabIndex:0,onClick:this._goToFirstPage},r.createElement(Je.b,{type:d.a.FirstPageButton})),r.createElement(Ot.a,{style:this.props.styleProps.pagingButton,testhooks:{id:"moveToPreviousPage_"+this.props.id},accessibilityLabel:this._loadPreviousPage,disabled:!i,tabIndex:0,onClick:this._goToPreviousPage},r.createElement(Je.b,{type:d.a.BackButton})),r.createElement(c.a,{style:this.props.styleProps.pageNumberStyle,testhooks:{id:"pageNumber_"+this.props.id},role:Ft.a,notificationType:Ut.b},null!==this.props.currentPage?String.format(n,this.props.currentPage):null),r.createElement(Ot.a,{style:this.props.styleProps.pagingButton,testhooks:{id:"moveToNextPage_"+this.props.id},accessibilityLabel:this._loadNextPage,disabled:!t,tabIndex:0,onClick:this._goToNextPage},r.createElement(Je.b,{type:d.a.Forward}))):null}_renderPagingText(e,t,i,n){if(!this.props.pagingTextDisabled&&this.props.shouldPagingTextRender&&this.props.gridTotalRecordsCountLimit)return r.createElement(o.a,{style:this.props.styleProps.pagingTextStyle,testhooks:{id:"pagingText"}},r.createElement(c.a,null,String.format(this._gridInfoResource,e,t,i,n)))}}const Ht=Object(s.a)((function(){let e=null;const t=Object(Oe.h)(),i=function(){let e=null,t=null;const i={containerStyle:{justifyContent:"space-between",alignItems:"center",width:"100%"},navigationPanelStyle:{flexDirection:"row"},pageNumberStyle:{whiteSpace:"nowrap"},pagingButton:{borderStyle:"none",display:"inline-block",backgroundColor:"transparent",fontSize:"16px"}};return function(r,n){var a,s,o,l,c,u,d,p,h,g;const m=Object(It.b)(r)&&Object(Ne.e)(r,Fe.jd,Fe.jf)&&(null===(a=Object(It.a)(r))||void 0===a?void 0:a.Components)?Object(It.a)(r).Components:null;if(e!==n){e=n;const a=Object(Ct.a)(r),{isRTL:f}=r.user.userSettings,b=Object.assign(Object.assign({},i.containerStyle),{marginRight:a.sizes.Measures.Measure100,marginLeft:a.sizes.Measures.Measure100}),y=Object.assign(Object.assign({},i.navigationPanelStyle),{["margin"+(f?"Right":"Left")]:"auto"}),v=Object.assign(Object.assign({},i.pageNumberStyle),{marginRight:a.sizes.Measures.Measure100,marginLeft:a.sizes.Measures.Measure100,fontSize:a.fontSizes.Font085,fontFamily:a.fontFamilies.Regular,color:(null===(o=null===(s=null==m?void 0:m.Grid)||void 0===s?void 0:s.Footer)||void 0===o?void 0:o.TextColor)||a.colors.BaseColor.Grey.Grey7}),S=Object.assign(Object.assign(Object.assign({},i.pagingButton),{color:(null===(c=null===(l=null==m?void 0:m.Grid)||void 0===l?void 0:l.Footer)||void 0===c?void 0:c.IconColor)||a.colors.BaseColor.Blue.Blue3,marginLeft:a.sizes.Measures.Measure050,marginRight:a.sizes.Measures.Measure050,padding:"0px","[data-id]:focus":{outlineOffset:"2px"},fontSize:a.fontSizes.Font085,"[disabled]":{color:(null===(p=null===(d=null===(u=null==m?void 0:m.Grid)||void 0===u?void 0:u.Footer)||void 0===d?void 0:d.Disabled)||void 0===p?void 0:p.IconColor)||a.colors.BaseColor.Grey.Grey5}}),f&&{transform:"scaleX(-1)"}),_={["margin"+(f?"Left":"Right")]:"auto",fontSize:a.fontSizes.Font085,fontFamily:a.fontFamilies.Regular,color:(null===(g=null===(h=null==m?void 0:m.Grid)||void 0===h?void 0:h.Footer)||void 0===g?void 0:g.TextColor)||a.colors.BaseColor.Grey.Grey7};t=Object.assign(Object.assign({},i),{containerStyle:b,navigationPanelStyle:y,pagingButton:S,pageNumberStyle:v,pagingTextStyle:_})}return t}}();return(r,n)=>{const a=i(r,n.contextString),s=Object(I.ib)(r,n.id,n.contextToken),o=s?s.length:0,l=t(r,xt.k),c=Object(I.bb)(r,n.id,n.contextToken),u=Object(I.y)(r,n.id,n.contextToken);return e!==a&&(e=a),{selectedRowCount:o,resourceStrings:l,pagingData:c,currentPage:null===u?1:u,styleProps:e}}}),(function(e,t){return{retrieveResourceStrings:t=>e(Object(_e.e)(t)),updatePageNumber:i=>{if(e(Object(kt.b)(t.id,t.contextToken,i)),1===i&&t.enhancedPagingDisabled&&e(Object(Wt.b)(t.id,t.contextToken)),t.isGridRoot){const e=[{filterType:12,filterExpressionOrValue:i}];t.updateGridPaginationStateHandler(e,t.id)}return e(Object(Bt.b)(t.id,t.contextToken,null)),e(Object(Vt.b)(t.id,t.contextToken,[]))},setNewPageRequested:i=>{e(Object(Lt.b)(t.id,t.contextToken,i))}}}))(qt);var Qt=i("OsHU"),Kt=i("Yexl"),Xt=i("IqkD");var Yt=i("5O6t"),Jt=i("b8TU");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class $t extends r.Component{constructor(e){super(e),this._quickFindInnerTextRef=null,this._searchBarFocusTriggered=!1,this._onTextInputChange=this._onTextInputChange.bind(this),this._onkeyDown=this._onkeyDown.bind(this),this._onButtonClick=this._onButtonClick.bind(this),this._focusTextInput=this._focusTextInput.bind(this),this.updateSearchTextAndFind=this.updateSearchTextAndFind.bind(this),this.props.isGridPaginationStateFeatureEnabled&&this.props&&this.props.gridInput&&this.props.gridInput.quickFindExpression?this.state={quickFindText:this.props.gridInput.quickFindExpression.trim(),currentViewId:this.props.currentViewIdToRestore,clearQuickFind:!0}:this.state={quickFindText:null,currentViewId:null,clearQuickFind:!1}}clearSearchBar(){this.setState({quickFindText:null,clearQuickFind:!1})}updateSearchTextAndFind(e,t){this.setState({quickFindText:e},()=>{t&&this._applyQuickFind()})}_onButtonClick(e){this.props.updateDataSetLoadingState(1),this.state.clearQuickFind?this._clearQuickFind():this._applyQuickFind()}_onkeyDown(e){e.keyCode===jt.a.Enter&&(this.props.updateDataSetLoadingState(1),this._applyQuickFind())}_onTextInputChange(e){const t=""===e;this.setState({quickFindText:e,clearQuickFind:t})}_applyFilter(){const e=this._formatQuickFindText(),t=Object(Dt.b)(e,this.props.primaryNameAttribute);this.props.applyGridFilter(t,this.props.contextToken)}_clearFilter(){this.setState({quickFindText:""},()=>{this._applyFilter()})}_formatQuickFindText(){return this.state.quickFindText.split("*").join("%").replace(/%?\s*$/,"%")}_applyQuickFind(){this.state.quickFindText&&""!==this.state.quickFindText.trim()?this.props.shouldUseFilter?(this._applyFilter(),this.setState({clearQuickFind:!0})):this.props.applyQuickFind(this.state.quickFindText,this.props.id,this.props.gridInput,this.props.contextToken,this.props.controlName,this.props.isGridPaginationStateFeatureEnabled).then(e=>{this.setState({clearQuickFind:!0}),this.state.currentViewId||this.setState({currentViewId:e})}):this._clearQuickFind()}_clearQuickFind(){this.props.shouldUseFilter?(this._clearFilter(),this.setState({clearQuickFind:!1})):this.props.clearQuickFind(this.state.currentViewId,this.props.id,this.props.gridInput,this.props.contextToken,this.props.controlName).then(()=>{this.setState({quickFindText:"",currentViewId:null,clearQuickFind:!1})})}_getPlaceholderText(){return this.props.isGridSearchCanUseCurrentViewFeatureEnabled?this.props.shouldGridSearchUseCurrentView?Object(Oe.c)(this.props.resourceStrings,C.QUICK_FIND_TEXT_BOX_PLACEHOLDER_TEXT_SEARCH_THIS_VIEW):Object(Oe.c)(this.props.resourceStrings,C.QUICK_FIND_TEXT_BOX_PLACEHOLDER_TEXT_QUICK_FIND_VIEW):Object(Oe.c)(this.props.resourceStrings,C.QUICK_FIND_TEXT_BOX_PLACEHOLDER_TEXT)}_createUniqueId(e){const{contextToken:t,id:i}=this.props;return t.controlName?`${e}_${t.controlName}_${i}`:`${e}_${i}`}render(){const e=this._getPlaceholderText(),t=Object(Oe.c)(this.props.resourceStrings,C.QUICK_FIND_TOOLTIP_CLEAR_BUTTON);if(this.props.showNewQuickFindSearchBarForMobile)return r.createElement(o.a,{style:{width:"100%",alignItems:"center"}},r.createElement(Te.k,{placeholder:e,cancelText:Object(Oe.c)(this.props.resourceStrings,C.QUICK_FIND_CANCEL_LABEL_ID),clearText:t,applyQuickFind:this._applyQuickFind,windowWidth:this.props.viewPortWidth,updateSearchTextAndFind:this.updateSearchTextAndFind,value:this.state.quickFindText,quickFindRNStyleProps:this.props.quickFindRNStyleProps}));const i=this._createUniqueId("quickFind_text"),n=this._createUniqueId("quickFind_button"),a=this._createUniqueId("quickFind_button_icon"),s=Object(Oe.c)(this.props.resourceStrings,C.QUICK_FIND_TOOLTIP_APPLY_BUTTON),l=this.props.entityDisplayName?`${this.props.entityDisplayName} ${e}`:e,c=this.state&&this.state.clearQuickFind?t:s;return r.createElement(o.a,{style:this.props.styleProps.quickFindStyle,testhooks:{id:"data-set-quickFind-container"}},r.createElement(Qt.a,{id:i,key:i,ref:e=>{this._quickFindInnerTextRef=e},testhooks:{id:i},value:this.state&&this.state.quickFindText?this.state.quickFindText:null,accessibilityLabel:l,onChangeText:this._onTextInputChange,onKeyDown:this._onkeyDown,style:this.props.styleProps.inputStyle,placeholder:e}),r.createElement(Ot.a,{id:n,key:n,testhooks:{id:n},accessibilityLabel:c,title:c,onClick:this._onButtonClick,tabIndex:0,style:this.props.styleProps.buttonStyle},r.createElement(Je.b,{id:a,key:a,type:this.state&&this.state.clearQuickFind?d.a.Cancel:d.a.SearchButton,style:this.props.styleProps.buttonIconStyle})))}_focusTextInput(){if(this.props.focusSearchBoxAfterRender&&!this._searchBarFocusTriggered){const e=n.findDOMNode(this._quickFindInnerTextRef);e&&(e.focus(),this._searchBarFocusTriggered=!0)}}componentDidMount(){this._focusTextInput()}}$t.displayName="DataSetQuickFind";const Zt=Object(s.a)((function(){let e=null,t=null,i=null,r={quickFindText:null,currentViewId:null,clearQuickFind:null,primaryNameAttribute:null,styleProps:null,quickFindRNStyleProps:null,shouldUseFilter:!1,resourceStrings:null,isGridPaginationStateFeatureEnabled:null,currentViewIdToRestore:null,shouldGridSearchUseCurrentView:null,isGridSearchCanUseCurrentViewFeatureEnabled:null,isQuickFindImprovementsFeatureEnabled:null,viewPortWidth:null};const n=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(){let e,t=null,i=null,r={buttonStyle:{border:"none",padding:"0",backgroundColor:"transparent",flexDirection:"column","-webkit-appearance":"none"},inputStyle:{border:"none",backgroundColor:"transparent",width:"100%",minWidth:"0px","-webkit-appearance":"none","::-ms-clear":{display:"none"}},quickFindStyle:{borderWidth:"1px",borderStyle:"solid",display:"flex",flexDirection:"row",width:"100%"},buttonIconStyle:{fontWeight:"bold",marginTop:"auto",marginBottom:"auto",width:"100%"}};return function(n,a){var s,o,l,c,u,d,p,h,g,m,f,b,y,v,S,_;const O=Object(Xt.g)(n),P=Object(It.b)(n)&&Object(Ne.e)(n,Fe.jd,Fe.jf)&&(null===(s=Object(It.a)(n))||void 0===s?void 0:s.Components)?Object(It.a)(n).Components:null;if(P&&(r=Object.assign(r,{inputStyle:{color:null===(c=null===(l=null===(o=null==P?void 0:P.Grid)||void 0===o?void 0:o.ColumnHeader)||void 0===l?void 0:l.QuickFind)||void 0===c?void 0:c.TextColor,backgroundColor:null===(p=null===(d=null===(u=null==P?void 0:P.Grid)||void 0===u?void 0:u.ColumnHeader)||void 0===d?void 0:d.QuickFind)||void 0===p?void 0:p.BackgroundColor,borderColor:"transparent"},searchIconStyle:{color:null===(m=null===(g=null===(h=null==P?void 0:P.Grid)||void 0===h?void 0:h.ColumnHeader)||void 0===g?void 0:g.QuickFind)||void 0===m?void 0:m.IconColor},buttonIconStyle:{color:null===(y=null===(b=null===(f=null==P?void 0:P.Grid)||void 0===f?void 0:f.ColumnHeader)||void 0===b?void 0:b.QuickFind)||void 0===y?void 0:y.IconColor}})),t!==a||e!==O){t=a,e=O;const s=Object(Ct.a)(n),o=Object.assign(Object.assign({},r.buttonStyle),{":before":{content:"''",display:"inline-block",width:s.sizes.Measures.Measure250}}),l=Object.assign(Object.assign({},r.quickFindStyle),{borderColor:(null===(_=null===(S=null===(v=null==P?void 0:P.Grid)||void 0===v?void 0:v.ColumnHeader)||void 0===S?void 0:S.QuickFind)||void 0===_?void 0:_.BorderColor)||s.colors.BaseColor.Grey.Grey3,["padding"+(O?"Right":"Left")]:s.sizes.Measures.Measure025});i=Object.assign(Object.assign({},r),{buttonStyle:o,quickFindStyle:l})}return i}}(),a=Object(Yt.a)(),s=Object(Oe.h)();let o=null;return(l,c)=>{const u=n(l,c.contextString),d=a(l,c);i||(i=s(l,C.labelList)),e!==u&&(e=u),t!==d&&(t=d),o||(o=Object(Ne.f)(l,Fe.fg));const p=Object(Ne.e)(l,Fe.Yc);let h=null;if(p&&c.gridInput){h=(c.gridInput&&c.gridInput.viewId&&!S.a.isNullOrEmpty(c.gridInput.viewId)?c.gridInput.viewId:null)||Object(O.a)(l,c.entityTypeName,P.a.MAIN_APPLICATION_VIEW)}return r={quickFindText:"",currentViewId:null,clearQuickFind:!1,primaryNameAttribute:Object(we.H)(l,c.entityTypeName),styleProps:e,quickFindRNStyleProps:t,shouldUseFilter:!(Object(Et.e)(c.contextString)||Object(Et.d)(c.contextString)||Object(Et.i)(c.contextString)&&o),resourceStrings:i,isGridPaginationStateFeatureEnabled:p,currentViewIdToRestore:h,shouldGridSearchUseCurrentView:Object(st.l)(l,c.id),isGridSearchCanUseCurrentViewFeatureEnabled:Object(Ne.f)(l,Fe.fd),isQuickFindImprovementsFeatureEnabled:Object(Ne.f)(l,Fe.dg)&&Object(Re.b)(l),viewPortWidth:Object(Jt.c)(l)},r}}),(function(e,t){return{applyQuickFind:(i,r,n,a,s,o)=>{if(n&&o){const e=[{filterType:1,filterExpressionOrValue:i}];n.entityTypeName===b.a&&e.push({filterType:2,filterExpressionOrValue:t.entityTypeName}),t.updateGridPaginationStateHandler(e,t.id),t.resetPagingInfoForEnhancedPaging()}return e(Object(Kt.a)(i,r,a,s))},clearQuickFind:(i,r,n,a,s)=>{if(n){const e=[{filterType:1,filterExpressionOrValue:null}];t.updateGridPaginationStateHandler(e,t.id)}return e(Object(Kt.b)(i,r,a,s))},applyGridFilter:(i,r)=>{e(Object(wt.n)(i,t.id,r))}}}),null,{forwardRef:!0})($t);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const ei=({onSeeMoreClick:e,resourceStrings:t,containerStyle:i,buttonStyle:n,seeMoreTextStyle:a,localizedStrings:s})=>function(e,t,i,n,a,s){const l=(null==s?void 0:s.seeMoreTooltip)||Object(Oe.c)(t,C.SEE_MORE_TOOL_TIP),u=(null==s?void 0:s.seeMoreLabel)||Object(Oe.c)(t,C.SEE_MORE_LABEL);let d=l;return(null==s?void 0:s.uniqueLabel)&&(d+=" "+s.uniqueLabel),r.createElement(o.a,{style:i},r.createElement(Ot.a,{key:"seeMoreBtn",id:"seemore-btn",title:l,style:n,onClick:e,tabIndex:0,accessibilityLabel:d,describedByElementId:null},r.createElement(c.a,{style:a},u)))}(e,t,i,n,a,s)
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */;var ti=i("5R5s"),ii=i("kKLx"),ri=i("vNXc"),ni=i("aF0N");var ai=i("iOrn"),si=i("zFtG"),oi=i("waMg"),li=i("6Qf/"),ci=i("B9jE"),ui=i("Jpj4"),di=i("E6o7"),pi=i("QXpm"),hi=i("rQHy"),gi=i("kt5S"),mi=i("Nb1E"),fi=i("odYE"),bi=i("wyQO"),yi=i("XOSd");var vi=i("fyfl"),Si=i("ojtV"),_i=i("K0PS"),Oi=i("2YQW"),Pi=i("ngeo"),wi=i("WZ96"),Ci=i("1uZV"),Ii=i("uNu9"),Ei=i("PVDM"),ji=i("PZ34");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function Di(e){return r.createElement(ct.a,{loader:()=>Promise.all([i.e(18),i.e(20),i.e(21),i.e(24),i.e(22),i.e(25),i.e(30),i.e(27),i.e(29),i.e(31),i.e(32),i.e(36),i.e(39),i.e(42),i.e(50),i.e(52),i.e(57),i.e(61),i.e(177),i.e(70)]).then(i.bind(null,"BvEH")).then(e=>e.DataSetExpressionBuilder),props:e})}Di.displayName="DataSetExpressionBuilderLazyLoadComponent";var Ti=i("p/Kg"),Fi=i("Tz6o"),Ni=i("BkgE"),Ri=i("+HfF"),ki=i("Uv1Y"),Ai=i("+QYJ"),Mi=i("w1eR"),xi=i("eOoD");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function Li(e){return r.createElement(ct.a,{loader:()=>Promise.all([i.e(18),i.e(20),i.e(21),i.e(33),i.e(39),i.e(52),i.e(61),i.e(68)]).then(i.bind(null,"12bH")).then(e=>e.ColumnEditor),props:e})}Li.displayName="ColumnEditorLazyLoadComponent";var Vi=i("7Dqt"),Bi=i("XfqB"),zi=i("QyGV"),Ui=i("mFPv"),Wi=i("oOvK");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
Object(Vi.a)();const Gi=b.N+".DataSetHost",qi=Gi+".AdvancedFind.Open",Hi=Gi+".AdvancedFind.Discard";class Qi extends r.Component{constructor(e){super(e),this._quickFindCommandBarId="showQuickFind",this._columnEditorCommandBarId="showColumnEditor",this._advancedFilterCommandBarId="showAdvancedFilter",this._changeVisualizationCommandBarId="changeVisualization",this._savedDefault=null,this._savedFormInfo=null,this._currentFilterValue=null,this._addedCommandListFromHost=[],this._addedCommandListFromControl=[],this._addedCommandListFromHostParent=[],this._memoizedConfiguration=null,this._memoizedResourceStrings=null,this._memoizedViewConfigurations=null,this._memoizedButtonList=null,this._parentSwitchVisualizationButton=null,this._keyIndex=0,this._width=0,this._height=0,this._isFirstRequestComplete=!1,this._isPreNavigationEventAttached=!1,this._offlineSqlQueryRetrieveState=0,this._dataSetQuickFindRef=r.createRef(),this._renderControlCommandsNative=!1,this._onCloseItemLevelDrawer=null,this._isSubGridFirstLoad=!1,this._minWidthForChartPlusGridReflow=640,this._isReflowLayoutVertical=!1,this._isSwitchVisualizationInitialized=!1,this._incrementLastPage=()=>{this.props.pageNumber===this.state.pagingInfo.lastPageNumber&&this.setState({pagingInfo:Object.assign(Object.assign({},this.state.pagingInfo),{lastPageNumber:this.state.pagingInfo.lastPageNumber+1})})},this._setFirstPage=e=>{this.setState({pagingInfo:Object.assign(Object.assign({},this.state.pagingInfo),{firstPageNumber:e})})},this._seeMorePopup=this._seeMorePopup.bind(this),this._onSendControlCommandsEventFired=this._onSendControlCommandsEventFired.bind(this),this._onSelectedOrderColumnChangeFired=this._onSelectedOrderColumnChangeFired.bind(this),this._onParentPagePreNavigationEventFired=this._onParentPagePreNavigationEventFired.bind(this),this._onFilterChange=this._onFilterChange.bind(this),this._onActivityTypeMenuDismissed=this._onActivityTypeMenuDismissed.bind(this),this._updateDataSetLoadingStateEvent=this._updateDataSetLoadingStateEvent.bind(this),this._updateFilterValue=this._updateFilterValue.bind(this),this._onRollupViewToggleChanged=this._onRollupViewToggleChanged.bind(this),this._onQuickFind=this._onQuickFind.bind(this),this._setViewAsUserDefault=this._setViewAsUserDefault.bind(this),this._onViewChanged=this._onViewChanged.bind(this),this._onControlLoadedError=this._onControlLoadedError.bind(this),this._updatePagingInfo=this._updatePagingInfo.bind(this),this._updateFilterExpressionStrings=this._updateFilterExpressionStrings.bind(this),this._configureDataSetControlParams=this._configureDataSetControlParams.bind(this),this._openManageDuplicatesDialog=this._openManageDuplicatesDialog.bind(this),this._showInnerError=this._showInnerError.bind(this),this._isInSeeMoreState=this._isInSeeMoreState.bind(this),this._getChartPaneText=this._getChartPaneText.bind(this),this.onMeasuring=this.onMeasuring.bind(this),this.closeFilterPanel=this.closeFilterPanel.bind(this),this._clearActivityTypeFilter=this._clearActivityTypeFilter.bind(this),this._updateCurrentPageNumber=this._updateCurrentPageNumber.bind(this),this._openItemLevelCommandsDrawer=this._openItemLevelCommandsDrawer.bind(this),this._openSortColumnNativeDrawer=this._openSortColumnNativeDrawer.bind(this),this._isNativePlatform=null!=e.platformType&&e.platformType===f.b.Native,this._currentPagingString=null,this._preSeeMoreCachedPagingString=null,this._boundOnRecordsSelected=null,this._pageNumberToRestoreForEnhancedPaging=this.props.pageNumberForEnhancedPaging,this._shouldResetPagingForEnhancedPaging=!1,this._previousSortingInfo=null,this._selectedSortColumnName=null,this._applySortingAndRefresh=null,this._sortDrawerTitle=null,this._resetProcessedForEnhancedPaging=!0,this.state=Object.assign({quickFindVisibility:!1,addedCommandList:[],itemLevelCommandList:[],inSeeMoreState:!1,pagingInfo:{firstPageNumber:Object(he.a)(this.props.pageNumberForEnhancedPaging)?1:this.props.pageNumberForEnhancedPaging,lastPageNumber:Object(he.a)(this.props.pageNumberForEnhancedPaging)?1:this.props.pageNumberForEnhancedPaging,currentPageNumber:Object(he.a)(this.props.pageNumberForEnhancedPaging)?1:this.props.pageNumberForEnhancedPaging,pageShift:0,isGridScrolledToBottom:!1},compositeControlInitState:Ce.a.Uninitialized,controlLoadErrorMessage:null,controlLoadInnerErrorMessage:null,loadingState:0,isFilterPanelOpen:!1,columnEditorPanelOpen:!1,isAdvancedFilterEdited:!1,shouldRenderSortColumnsNativeDrawer:!1},this._getUpdateAddedCommandList(this._showCommandBarButtonColumnEditor(),this._showCommandBarButtonAdvancedFilter(),this._showCommandBarButtonSearch(),this._showCommandBarButtonShowChart())),this._parentDefinedEventHandlers=[{eventname:"sendgridcontrolcommandstohostcommandbar",eventhandler:[this._onSendControlCommandsEventFired]},{eventname:"opencontrolcommandsinmobileoptimizeddrawer",eventhandler:[this._openItemLevelCommandsDrawer]},{eventname:"onselectedordercolumnchange",eventhandler:[this._onSelectedOrderColumnChangeFired]},{eventname:"opencontrolsortcolumnsinmobiledrawer",eventhandler:[this._openSortColumnNativeDrawer]},{eventname:"parentPagePreNavigation",eventhandler:[this._onParentPagePreNavigationEventFired]},{eventname:"sendpaginginfotopagingcontrol",eventhandler:[this._updatePagingInfo]},{eventname:"sendfilterexpressionstringstodatasethost",eventhandler:[this._updateFilterExpressionStrings]},{eventname:"updatedatasethostloadingstate",eventhandler:[this._updateDataSetLoadingStateEvent]},{eventname:"openmanageduplicatesdialog",eventhandler:[this._openManageDuplicatesDialog]},{eventname:"showinnererror",eventhandler:[this._showInnerError]},{eventname:"sendcurrentpagenumber",eventhandler:[this._updateCurrentPageNumber]}],this._parentDefinedProps={containerStyleOverrides:{rootContainer:{flex:Object(Et.e)(e.contextString)?"1 1 100%":"1 1 auto",minHeight:"0"}},onControlLoadedError:this._onControlLoadedError},this._seeMoreHelper=new m.a}_openSortColumnNativeDrawer({sortColumns:e,selectedColumn:t,applySortingAndRefresh:i,drawerTitle:r}){this._sortColumns=e,this._selectedSortColumnName=t,this._applySortingAndRefresh=i,this._sortDrawerTitle=r,this.setState({shouldRenderSortColumnsNativeDrawer:!0})}_openItemLevelCommandsDrawer(e){const t=e[0],i=null==t?void 0:t.getRecordId(),r={};r[i]=t;const n=[i];this.props.retrieveRecordCommand(r,this.props.commandBarProps.commandManagerId,this.props.contextToken,n,void 0,void 0,!0,void 0,void 0,this.props.commandBarProps.pageId).then((t=[])=>{const i=t.filter(e=>e.shouldBeVisible&&("Button"===e.controlType||"SplitButton"===e.controlType)),r=[];i.forEach(e=>{r.push({Id:e.commandId,CommandManagerId:this.props.commandBarProps.commandManagerId,CommandType:"",Command:e.label,LabelText:e.label,Icon:e.icon,Tooltip:e.tooltip,Children:[],IsInjectedCommand:!0,Execute:e.execute,IsGlobalCommand:!1})}),this._renderControlCommandsNative=!0,this._onCloseItemLevelDrawer=this._generateOnCloseDrawer(e[1]).bind(this),this.setState({itemLevelCommandList:r})})}_generateOnCloseDrawer(e){return()=>{this._renderControlCommandsNative=!1,e(),this.setState({itemLevelCommandList:[]})}}_logInfo(e){this._tracer&&this._tracer.info(e)}_updateDataSetLoadingStateEvent(e){this._updateDataSetLoadingState(e.value)}_updateDataSetLoadingState(e,t={}){(1===e&&this.props.featureControlProps.isGridProgressIndicatorFeatureEnabled||1!==e)&&(this.setState(Object.assign(t,{loadingState:e})),this._currentLoadingTimeoutIdentifier&&clearTimeout(this._currentLoadingTimeoutIdentifier),this._currentLoadingTimeoutIdentifier=null,1===e&&(this._currentLoadingTimeoutIdentifier=setTimeout(()=>{this._updateDataSetLoadingState(2)},3e4)))}_openManageDuplicatesDialog(e){!this.props.isOffline&&e&&e.entityReference&&e.reject&&this.props.openManageDuplicatesDialog(e)}_showInnerError(e){this.props.showInnerError(e)}_updatePagingInfo(e){e&&e.currentPageNumber>0&&(this.props.setNewPageRequested(this.props.id,this.props.contextToken,!1),this.props.featureControlProps.isGridPaginationStateFeatureEnabled&&this.props.gridInput&&(this._resetProcessedForEnhancedPaging||1!==e.currentPageNumber||(this._resetProcessedForEnhancedPaging=!0,this._pageNumberToRestoreForEnhancedPaging=1),this.props.pageNumberForEnhancedPaging!==e.currentPageNumber&&this.props.updatePageNumberForEnhancedPaging(e.currentPageNumber,this.props.contextToken)),Object(Oi.e)(this.state.pagingInfo,e)||this.setState({pagingInfo:e}))}_updateCurrentPageNumber(e){e&&e.currentPageNumber>0&&this.props.updateCurrentPageNumber(this.props.id,this.props.contextToken,e.currentPageNumber)}_updateFilterExpressionStrings(e){if(this.props.featureControlProps.isGridPaginationStateFeatureEnabled&&this.props.gridInput&&e&&(e.nativeFilterExpressionString||e.dataSetFilterExpressionString)){const t=[{filterType:5,filterExpressionOrValue:e.nativeFilterExpressionString},{filterType:6,filterExpressionOrValue:e.dataSetFilterExpressionString}];this.props.updateGridPaginationStateHandler(t,this.props.id),this.props.updateCurrentPageNumber(this.props.id,this.props.contextToken,1)}}_setResetPagingInfoForEnhancedPaging(){this.props.featureControlProps.isGridPaginationStateFeatureEnabled&&this.props.gridInput&&this._isNativePlatform&&(this._shouldResetPagingForEnhancedPaging=!0)}_resetPagingInfoForEnhancedPaging(){this.props.featureControlProps.isGridPaginationStateFeatureEnabled&&this.props.gridInput&&this._isNativePlatform&&(this.setState({pagingInfo:{firstPageNumber:1,lastPageNumber:1,currentPageNumber:1,pageShift:0,isGridScrolledToBottom:!1}}),this._pageNumberToRestoreForEnhancedPaging=1)}_onControlLoadedError(e){const t=e?e.message:null;this._logTelemetryData(t),this._setControlLoadError()}_setControlLoadError(e=C.GRID_CONTROL_LOAD_ERROR){this.setState({controlLoadErrorMessage:Object(Oe.c)(this.props.resourceStrings,e)})}_logTelemetryData(e){this._tracer&&this._tracer.error("Loading for the grid failed because of error :"+(e||"CustomControl_Calendar_ErrorView_DefaultMessage"))}_renderTitle(){if(!this.props.descriptor)return null;const{ShowLabel:e,Name:t,Label:i}=this.props.descriptor,n=this._isWidthLessThanViewportSm()?this.props.styles.titleMobileStyle:this.props.styles.titleStyle;return e&&i?r.createElement(c.a,{key:t,semanticTag:"h3",style:n},i):null}onMeasuring(e,t){if(this._height=t,Math.abs(this._width-e)<50)return;if(this._width=e,this._getCachedSize()&&e===this._getCachedSize().width&&(!t||t===this._getCachedSize().height))return;const i={},r=this._seeMoreHelper.shouldGivePoppedOutDimensions(!0),n=this._seeMoreHelper.getSeeMorePopupInfo(),a=r?n.endWidthInner:e,s=[];!this._isWidthInitialized()&&e>0&&(i.isWidthInitialized=!0,s.push("isWidthInitialized:"+i.isWidthInitialized));const o=a<=this.props.viewportSm;o!==this._isWidthLessThanViewportSm()&&(i.isWidthLessThanViewportSm=o,s.push("isWidthLessThanViewportSm:"+o));const l=a<=this.props.viewportM;l!==this._isWidthLessThanViewportM()&&(i.isWidthLessThanViewportM=l,s.push("isWidthLessThanViewportM:"+l));const c=a<this._minWidthForChartPlusGridReflow;c!==this._isWidthLessThanMinWidthForChartPlusGridReflow()&&(i.isWidthLessThanMinWidthForChartPlusGridReflow=c,s.push("isWidthLessThanMinWidthForChartPlusGridReflow:"+c));const u=this._jumpBarShouldRenderAsFlyout(a);u!==this._isJumpBarRenderingAsFlyout()&&(i.isJumpBarRenderingAsFlyout=u,s.push("isJumpBarRenderingAsFlyout:"+u));const d=a>480;d!==this._isWidthGreaterThan480()&&(i.isWidthGreaterThan480=d,s.push("isWidthGreaterThan480:"+d));const p=r?n.endHeightInner:t,h=p>240;h!==this._isHeightGreaterThan240()&&(i.isHeightGreaterThan240=h,s.push("isHeightGreaterThan240:"+h)),0!==e&&0!==t||this._tracer&&this._tracer.warn(`The measuring service returned width or height as 0. The new dimensions are width is ${e} and height is ${t}`);let g=!1;const m=this.props.quickFindProps&&o&&!this._checkIfMobileImprovementsEnabledForQuickFindSearchOnGridRoot();m!==this._showCommandBarButtonSearch()&&(i.showCommandBarButtonSearch=m,s.push("showCommandBarButtonSearch:"+m),g=!0);const f=this.props.isAdvancedColumnEditorEnabled&&o&&this.props.featureControlProps.isModernGridButtonsEnabled&&!Object(Et.i)(this.props.contextString)&&!Object(Et.d)(this.props.contextString);f!==this._showCommandBarButtonColumnEditor()&&(i.showCommandBarButtonColumnEditor=f,s.push("showCommandBarButtonColumnEditor:"+f),g=!0);const b=this.props.isAdvancedColumnFilteringEnabled&&o&&this.props.featureControlProps.isModernGridButtonsEnabled&&!Object(Et.i)(this.props.contextString)&&!Object(Et.d)(this.props.contextString);b!==this._showCommandBarButtonAdvancedFilter()&&(i.showCommandBarButtonAdvancedFilter=b,s.push("showCommandBarButtonAdvancedFilter:"+b),g=!0);const y=Object(Et.e)(this.props.contextString)||Object(Et.d)(this.props.contextString)&&this.props.featureControlProps.isChartOnAssociatedGridEnabled;if(y!==this._showCommandBarButtonShowChart()&&(i.showCommandBarButtonShowChart=y,s.push("showCommandBarButtonShowChart:"+y),g=!0),s.length>0){s.push("currentWidth:"+e),s.push("currentHeight:"+t),s.push("usePoppedOutDimensions:"+r),s.push("newWidth:"+a),s.push("newHeight:"+p),s.push("commandBarNeedsUpdate:"+g);const i=s.join(",");this._logInfo("onMeasuring change: "+i)}this._getCachedSize()&&this._getCachedSize().update&&(this._cachedSize=this._getCachedSize().update({width:e,height:t,isWidthInitialized:e>0,isWidthLessThanViewportSm:o,isWidthLessThanViewportM:l,isWidthLessThanMinWidthForChartPlusGridReflow:c,isJumpBarRenderingAsFlyout:u,isWidthGreaterThan480:d,isHeightGreaterThan240:h,showCommandBarButtonColumnEditor:f,showCommandBarButtonAdvancedFilter:b,showCommandBarButtonSearch:m,showCommandBarButtonShowChart:y}));let v=i;g&&(v=Object.assign(v,this._getUpdateAddedCommandList(f,b,m,y))),Object.keys(v).length&&this.setState(v)}_getUpdateAddedCommandList(e,t,i,r){if(this._addedCommandListFromHost=[],e&&(this._logInfo("Adding column editor button to commandbar for DataSethost."),this._addedCommandListFromHost.push({Icon:"ColumnOptions",DisplayText:Object(Oe.c)(this.props.resourceStrings,C.ColumnEditorButtonLabel),Id:this._columnEditorCommandBarId,execute:this._onColumnEditorButtonClick.bind(this)})),t&&(this._logInfo("Adding advanced filter button to commandbar for DataSethost."),this._addedCommandListFromHost.push({Icon:"Filter",DisplayText:Object(Oe.c)(this.props.resourceStrings,C.EditFiltersButton),Id:this._advancedFilterCommandBarId,execute:this._toggleAdvancedFilterPanel.bind(this)})),i&&(this._logInfo("Adding search button to commandbar for DataSethost."),this._addedCommandListFromHost.push({Icon:"SearchButton",DisplayText:Object(Oe.c)(this.props.resourceStrings,C.QUICK_FIND_COMMANDBAR_TEXT),Id:this._quickFindCommandBarId,execute:this._onQuickFind})),this.props.isQueryMode){this._logInfo("Adding clear query button to commandbar for DataSethost.");const e=this._getClearQueryText();this._addedCommandListFromHost.push({Icon:"ClearDefault",DisplayText:e,Tooltip:{title:e},Id:"ClearQuery",execute:()=>this.props.clearQuery()})}if(!this.props.isOffline&&r){this._logInfo("Adding show chart button to commandbar for DataSethost.");const e=this._getChartPaneText();this._addedCommandListFromHost.push({Icon:"SelectChart",DisplayText:e,Tooltip:{title:e},Id:"ShowChartPane",execute:()=>this.props.toggleChartPane(this.props.id,this.props.contextToken,!this.props.showChart)})}return this._onAddedCommandListChange(!1)}_onViewChanged(e,t,i=!0){var r;i&&this._updateDataSetLoadingState(1);const n=this.props.descriptor?this.props.descriptor.Id:null;this._logInfo("The view for the grid changed. The new view parameters for the view are - NewViewId : "+e+", EntityTypeName : "+t+"and ControlName : "+n),this.props.setCustomFilter("",0,this.props.id,this.props.contextToken),this._resetPagingInfoForEnhancedPaging(),null===(r=this._dataSetQuickFindRef.current)||void 0===r||r.clearSearchBar();const a=this.props.gridInput&&this.props.gridInput.entityTypeName.toLowerCase()===I.a;this.props.updateView(this.props.id,n,e,t,this.props.commandBarProps&&this.props.commandBarProps.commandManagerId,this.props.contextToken,this.props.userId,this.props.featureControlProps&&this.props.featureControlProps.isQueueFilterPerfUCIEnabled,a,this.props.featureControlProps).then(()=>{this.props.nonCompositionProps&&this.props.nonCompositionProps.setPageInputViewId&&this.props.nonCompositionProps.setPageInputViewId(e),this.state.controlLoadErrorMessage&&this.setState({controlLoadErrorMessage:null})},e=>{this._logInfo(e.message),this._setControlLoadError()})}_setViewAsUserDefault(e,t,i,r,n){this._logInfo("Trying to set default view for user. The new view parameters for the view are - NewViewId : "+t+", EntityTypeName : "+e+", ViewType : "+i+"and shouldSetAsUserDefault : "+n);const a=ot(this._currentFilterValue);return this.props.updateUserDefaultGridView(e,t,i,r,a,!n)}_onQuickFind(){this.setState({quickFindVisibility:!this.state.quickFindVisibility})}_getChartPaneText(){const{resourceStrings:e,showChart:t}=this.props;return t?Object(Oe.c)(e,C.CHARTS_HIDE_CHART_PANE_LABEL):Object(Oe.c)(e,C.CHARTS_SHOW_CHART_PANE_LABEL)}_getClearQueryText(){return"Clear query"}_updateFilterValue(e){this._currentFilterValue=e}_onFilterChange(e,t=this.props.gridEntityTypeName){this._logInfo("Applying grid filter, the new value received is "+e),2===this.state.loadingState&&this._updateDataSetLoadingState(1),this._updateFilterValue(e);const i=Object(ti.a)(this.props.viewSelectorProps.entityTypeName,this.props.userId,this.props.contextToken,this.props.featureControlProps.isQueueFilterPerfUCIEnabled,this.props.entityIsActivityType).getFilterExpression(e,this.props.userSetting,t);this.props.updateCurrentPageNumber(this.props.id,this.props.contextToken,1),this._setResetPagingInfoForEnhancedPaging(),this.props.applyGridFilter(i,e,this.props.contextToken)}_clearActivityTypeFilter(){this.props.applyActivityTypeFilter("","",this.props.contextToken)}_onActivityTypeMenuDismissed(e){if(!this.props.isOffline){const t=e.join(","),i=function(e,t){if(null!=e){if(e.indexOf("selectAllKey")>-1||0===e.length||null!=t&&t.length===e.length)return null;let i=null;const r=[];for(let t=0;t<e.length;t++)r.push({attributeName:"activitytypecode",conditionOperator:0,value:e[t]});return r&&r.length>0&&(i={conditions:r,filterOperator:1}),i}}(e,this.props.entityFilterProps.filterOptionsForActivityType),r=i?JSON.stringify(i):"";void 0===this.props.entityFilterProps.activityTypePreviousValues?this.props.applyActivityTypeFilter(r,t,this.props.contextToken):t!==this.props.entityFilterProps.activityTypePreviousValues&&this._shouldActivitySelectAllFilterFire(t,this.props.entityFilterProps.activityTypePreviousValues,this.props.entityFilterProps.isActivityFilterSelectAllEnabled)&&(this._logInfo("Applying activity type grid filter, the new value received is "+t),2===this.state.loadingState&&this._updateDataSetLoadingState(1),this.props.updateCurrentPageNumber(this.props.id,this.props.contextToken,1),this._setResetPagingInfoForEnhancedPaging(),this.props.applyActivityTypeFilter(r,t,this.props.contextToken));const n=[{name:"ActivityTypeFilterUsage",value:"Initiated"},{name:"SelectedActivityTypeFilterCount",value:e.length},{name:"ActivityTypeFilterDropDownCount",value:this.props.entityFilterProps.filterOptionsForActivityType.length}];this.context&&this.context.EventManager&&this.context.EventManager.ReportComponentSuccess&&this.context.EventManager.ReportComponentSuccess(Gi,n)}}_shouldActivitySelectAllFilterFire(e,t,i){if(i){let i=!1,r=!1;return(t.indexOf("selectAllKey")>-1||""===t)&&(i=!0),(e.indexOf("selectAllKey")>-1||""===e)&&(r=!0),!(i&&r)}return!0}_onRollupViewToggleChanged(e){this._logInfo("Toggling rollupView control, the new value received is "+e),this.props.toggleGridRollupView(e,this.props.contextToken)}_updateFilterOnViewSelectorChange(e){this._logInfo("Updating dataset with the existing filter selection for activity pointer"),this._onFilterChange(this._currentFilterValue,e)}_onSendControlCommandsEventFired(e){this._logInfo("Adding control commands to command bar. The command to be added are : "+e),e!==this._addedCommandListFromControl&&(this._addedCommandListFromControl=e,this._onAddedCommandListChange())}_onSelectedOrderColumnChangeFired(e){if(this._logInfo("Updating jumpbar filter based on the selected order column"),this.props.featureControlProps.isJumpBarShouldHonorSortingFeatureEnabled&&this.props.jumpBarProps){let t=e.columnSortingName;t=Object(Dt.d)(t,e.columnSortingType,e.primaryNameAttribute);const i=Object(Dt.b)(this.props.jumpBarProps.selectedFilter,t);this.props.onSelectedOrderColumnChange(i,this.props.contextToken)}}_onParentPagePreNavigationEventFired(e){e&&Array.isArray(e)&&e.length>0&&!this._isPreNavigationEventAttached&&this.context&&this.context.Router&&this.context.Router.registerPreNavigationHandler&&(this._tracer&&this._tracer.info("Adding control preNavigation handlers to the router"),e.forEach(e=>this.context.Router.registerPreNavigationHandler(()=>{try{return e()}catch(e){const t=[{name:"subComponent",value:"onPreNavigation"}];this.context&&this.context.EventManager&&this.context.EventManager.ReportComponentFailure&&this.context.EventManager.ReportComponentFailure(Gi,e,null,t)}return Promise.resolve(!0)})),this._isPreNavigationEventAttached=!0)}_createSwitchVisualization(e,t){return()=>{switch(this._keyIndex++,this.props.contextString){case b.o.ASSOCIATEDGRID:this.props.switchAssociatedGridVisualization(this.props.id,this.props.entityTypeName,this.props.controlId,this.props.viewId,e,this.props.nonCompositionProps&&this.props.nonCompositionProps.viewConfigurations,this.props.nonCompositionProps&&this.props.nonCompositionProps.gridConfigurations,"VIEW_CONFIG"===t);break;case b.o.SUBGRID:this.props.switchSubgridVisualization(this.props.id,e,this.props.controlId);break;case b.o.GRID:default:if(this.props.featureControlProps.isGridPaginationStateFeatureEnabled&&this.props.gridInput){const e=[{filterType:3,filterExpressionOrValue:null}];this.props.updateGridPaginationStateHandler(e,this.props.id),this.props.setCustomFilter("",0,this.props.id,this.props.contextToken)}"VIEW_CONFIG"===t?this.props.switchViewConfiguration(this.props.id,this.props.contextToken,e,this.props.controlId,!1):this.props.switchHomepageConfiguration(this.props.id,this.props.contextToken,e,this.props.controlId,!0)}}}_updateChangeVisualizationButtons(e){let t=[];const{configuration:i,contextString:r,controlId:n,descriptor:a,gridEntityTypeName:s,nonCompositionProps:o,pcfDatasetGridOrgSettingEnabled:l,retrieveControlResourceStringsForSwitchVisualization:c,viewId:u}=this.props,d=null==o?void 0:o.gridConfigurations,p=null==o?void 0:o.viewConfigurations;let h=!1;this._parentSwitchVisualizationButton||(this._parentSwitchVisualizationButton={Icon:"SelectChart",DisplayText:Object(Oe.c)(this.props.resourceStrings,C.SWITCH_VISUALIZATION_BUTTON_LABEL),Id:this._changeVisualizationCommandBarId+"-Parent",WillOpenFlyout:!0,Children:null}),Object(gi.b)(this._memoizedConfiguration,this.props.updatedConfiguration)&&Object(gi.a)(this._memoizedViewConfigurations,p)&&this._memoizedResourceStrings===this.props.switchVisualizationResourceStrings||this.props.switchVisualizationResourceStrings&&(this._memoizedConfiguration=this.props.updatedConfiguration,this._memoizedViewConfigurations=p,this._memoizedResourceStrings=this.props.switchVisualizationResourceStrings,this._memoizedButtonList=[],t=Object(gi.d)({controlDescriptorParameters:null==a?void 0:a.Parameters,controlId:n,dataSetType:r,deviceFormFactor:e,isDefaultConfig:i.isDefaultConfig,gridConfigurations:d,gridEntityTypeName:s,pcfDatasetGridEnabled:l,viewConfigurations:p,viewId:u}),t.forEach(t=>{if(Object(gi.b)(this.props.updatedConfiguration,t.configuration)||t.configuration.isDefaultConfig&&this.props.updatedConfiguration.isDefaultConfig||this.props.featureControlProps.isDisableEditableGridControlOnPhoneFeatureEnabled&&Object(st.g)(t.configuration,parseInt(e,10)))return;const i={Icon:"SelectChart",DisplayText:""+Object(gi.c)(this.props.switchVisualizationResourceStrings,t.configuration),Id:`${this._changeVisualizationCommandBarId}-${t.configuration.Name}-${t.formFactor}`,execute:this._createSwitchVisualization(t.configuration,t.configurationType),IsInFlyout:!0};this._memoizedButtonList.push(i),h=!0})),!this._isSwitchVisualizationInitialized&&this.props.commandBarProps&&(Object(gi.e)({context:this.context,controlDescriptorParameters:null==a?void 0:a.Parameters,controlId:n,dataSetType:r,deviceFormFactor:e,isDefaultConfig:i.isDefaultConfig,gridConfigurations:d,gridEntityTypeName:s,pcfDatasetGridEnabled:l,retrieveControlResourceStrings:c,viewConfigurations:p,viewId:u}),this._isSwitchVisualizationInitialized=!0),this._parentSwitchVisualizationButton.Children=this._memoizedButtonList,h&&this._onAddedCommandListChange()}_onAddedCommandListChange(e=!0){var t,i,r,n;const a=[],s=[],o=(null===(i=null===(t=this._parentSwitchVisualizationButton)||void 0===t?void 0:t.Children)||void 0===i?void 0:i.length)>0;if(this.props.featureControlProps.isShowAsButtonFirstEnabled&&o&&s.push(this._parentSwitchVisualizationButton),s.push(...this._addedCommandListFromControl),s.push(...this._addedCommandListFromHost),(null===(n=null===(r=this.props.nonCompositionProps)||void 0===r?void 0:r.addedCommandListFromHostParent)||void 0===n?void 0:n.length)>0&&a.push(...this.props.nonCompositionProps.addedCommandListFromHostParent),!this.props.featureControlProps.isShowAsButtonFirstEnabled&&o&&a.push(this._parentSwitchVisualizationButton),!e)return{addedCommandList:s,appendedCommandList:a};this&&this.setState&&this.setState({addedCommandList:s,appendedCommandList:a})}_seeMoreCallback(e){this.setState({inSeeMoreState:!this.state.inSeeMoreState})}_seeMorePopup(e,t=!1){!0===e?(this._preSeeMoreCachedPagingString=this._currentPagingString,this._currentPagingString=null):(this._currentPagingString=this._preSeeMoreCachedPagingString,this._preSeeMoreCachedPagingString=null),this._keyIndex++,this._seeMoreHelper.seeMorePopup(this._getDataSetHostRootElement(),this._seeMoreCallback.bind(this),e,t,this.props.isRTL)}_getDataSetHostRootElement(){return n.findDOMNode(this)}_onRecordsSelectedCallback(e,t){this._logInfo("onRecordsSelected for DataSetHost. New selected rows are "+t);const i=[];for(const e of t)i.push(new S.a(e));if(this.props.markSelectedRows(this.props.id,this.props.contextToken,i),e){const e=this.props.updatedConfiguration.Parameters[this.props.nestedGridDatasetName];this.props.markSelectedRelatedEntity(this.props.id,this.props.contextToken,e.TargetEntityType)}else this.props.markSelectedRelatedEntity(this.props.id,this.props.contextToken,null);this.props.isGridEditable&&t.length>0&&this.props.rowProperties(this.props.id,this.props.contextToken,i),(this.props.isGridEditable||this.props.isModernDataSet)&&(this._logInfo("Running onRecordSelect for EditableGrid"),this.props.runOnRecordSelect(this.props.id,this.props.contextToken,i,this.props.isModernDataSet)),!e&&this._onRecordsSelectedParent&&(this._logInfo("onRecordsSelected: Calling onRecordsSelected callback for the parent control"),this._onRecordsSelectedParent(t))}markGridFirstRequestComplete(){this._isFirstRequestComplete=!0}_isDataSetHostKnownError(e){return!(!e||""===e)&&(-1!==e.indexOf(Pi.a.getHexErrorCodeFromInt(2415919120))||!(-1===e.indexOf(Pi.a.getHexErrorCodeFromInt(-2147093999))||this.props.offlineProps.isEntityAvailableForOffline&&this.props.offlineProps.isOfflineAvailableForUse))}_onDataSetUpdateCallback(e){this._logInfo("DataSetUpdated for DataSetHost control");const t=[{name:"currentPagingString",value:e&&e.existedPagingString||""}];this.markGridFirstRequestComplete(),this._currentPagingString!==e.existedPagingString&&t.push({name:"previousPagingString",value:this._currentPagingString});let i=!1;e.error?(i=this._isDataSetHostKnownError(e.errorMessage)||!Object(Ai.b)(e.innerError),e.innerError&&t.push({name:"InnerErrorMessage",value:e.innerError}),this.context.EventManager.ReportComponentFailure(Gi,new Error(e.errorMessage||""),null,t)):this.context.EventManager.ReportComponentSuccess(Gi,t);let r={};if(i)r={compositeControlInitState:Ce.a.Error,controlLoadErrorMessage:e.errorMessage},e.innerError&&(r.controlLoadInnerErrorMessage=e.innerError);else{this.props.updateFetchXml(this.props.id,this.props.contextToken,e.fetchXmlInUse);let t=null;if(e.existedFilteringString){const i=JSON.parse(e.existedFilteringString);t=Object(h.j)(i,Gt.CrmXmlEncode),this.props.setCustomFilter(t,0,this.props.id,this.props.contextToken)}if(this.props.featureControlProps.isGridPaginationStateFeatureEnabled){const t=[];let i=!1,r=null;e.existedValidSortingArrayString&&(r=e.existedValidSortingArrayString);const n=!Object(he.a)(r)&&JSON.parse(r);if(n&&n instanceof Array&&n.length>0&&r!==this._previousSortingInfo&&(this.props.gridInput&&t.push({filterType:7,filterExpressionOrValue:r}),this._previousSortingInfo=r,i=!0),i){if(e.existedPagingString){const t=JSON.parse(e.existedPagingString);t.firstPageNumber&&(this.props.updateCurrentPageNumber(this.props.id,this.props.contextToken,t.firstPageNumber),this.props.gridInput&&this._setResetPagingInfoForEnhancedPaging())}this.props.gridInput&&this.props.updateGridPaginationStateHandler(t,this.props.id)}}this.props.updateQueryKey(e.newQueryKey,this.props.id,this.props.contextToken),this.props.updatePagingData(this.props.id,this.props.contextToken,e.existedPagingString),this.props.setNewPageRequested(this.props.id,this.props.contextToken,!1),this._logInfo("onDataSetUpdate: eventPagingString: "+e.existedPagingString),this._currentPagingString=e.existedPagingString}2!==this.state.loadingState?this._updateDataSetLoadingState(2,r):this.setState(r)}_configureDataSetControlParams(){if(!this.props.updatedConfiguration)return;const e=this.props.updatedConfiguration.Parameters[this.props.primaryDataSetName];if(e){!Object(he.a)(e.onRecordsSelected)&&Object(he.a)(this._onRecordsSelectedParent)&&e.onRecordsSelected!==this._boundOnRecordsSelected&&(this._onRecordsSelectedParent=e.onRecordsSelected),this._isFirstRequestComplete&&(e.FirstDataRequestType=0),Object(he.a)(this._boundOnRecordsSelected)&&(this._boundOnRecordsSelected=this._onRecordsSelectedCallback.bind(this,!1)),e.onRecordsSelected=this._boundOnRecordsSelected,e.onDataSetUpdate=this._onDataSetUpdateCallback.bind(this);const t=this.props.descriptor;let i=1,r=this.state.pagingInfo.lastPageNumber;this.props.isGridEditable||this._isNativePlatform?this.props.featureControlProps.isGridPaginationStateFeatureEnabled&&this._isNativePlatform&&(i=this.state.pagingInfo.firstPageNumber):(i=this.props.pageNumber,r=this.props.pageNumber);const n={pageNumber:i,firstPageNumber:i,lastPageNumber:r,pageSize:!this._isInSeeMoreState()&&t&&t.Parameters&&t.Parameters[b.E]&&parseInt(t.Parameters[b.E],10)||this.props.recordsPerPageSetting,pagingRefreshInput:this.props.pagingRefreshInput?this.props.pagingRefreshInput.toString():""},a=Object(zt.a)(this._currentPagingString);if(a&&a.pageSize&&(this._logInfo("Updating pageSize based on _receivedPagingStringData.pageSize to "+a.pageSize),n.pageSize=a.pageSize),e.PagingInput={Static:!0,Value:JSON.stringify(n)},this.props.refreshCounter){const t=this.props.refreshCounter.toString();if(e.RefreshInput={Value:parseInt(t,10),Static:!0},!Object(he.a)(this.props.customFilter)&&!Object(he.a)(this.props.customFilter.customFilterXml)&&this.props.customFilter.source&&1===this.props.customFilter.source){const t=Object(h.i)(this.props.customFilter.customFilterXml);e.FilteringInput={Static:!0,Value:JSON.stringify(t)}}}if(this.props.featureControlProps.isGridPaginationStateFeatureEnabled&&this.props.gridInput){if(!Object(he.a)(this.props.customFilter)&&!Object(he.a)(this.props.customFilter.customFilterXml)){const t=Object(h.i)(this.props.customFilter.customFilterXml);e.FilteringInput={Static:!0,Value:JSON.stringify(t)}}const t=!Object(he.a)(this.props.gridSortingInfo)&&JSON.parse(this.props.gridSortingInfo),i=t&&t instanceof Array&&t.length>0,r=!Object(he.a)(this._previousSortingInfo)&&JSON.parse(this._previousSortingInfo),n=r&&r instanceof Array&&r.length>0;(i||n&&this.props.gridSortingInfo!==this._previousSortingInfo)&&(this._previousSortingInfo=this.props.gridSortingInfo,e.SortingInput={Static:!0,Value:this.props.gridSortingInfo})}this.props.gridEntityTypeName&&(e.EntityName=this.props.gridEntityTypeName)}this._addExtraParametersToConfiguration();const t=this.props.updatedConfiguration.Parameters[this.props.nestedGridDatasetName];if(t&&(t.onRecordsSelected=this._onRecordsSelectedCallback.bind(this,!0),this.props.refreshCounter)){const e=this.props.refreshCounter.toString();t.RefreshInput={Value:parseInt(e,10),Static:!0}}}_addExtraParametersToConfiguration(){if(this.props.featureControlProps.isGridPaginationStateFeatureEnabled&&this.props.gridInput&&(this.props.updatedConfiguration.Parameters.NativeFilterExpressionToRestore={Usage:1,Static:!0,Value:this.props.nativeFilterExpression},!Object(he.a)(this._pageNumberToRestoreForEnhancedPaging))){let e=this._pageNumberToRestoreForEnhancedPaging;this._pageNumberToRestoreForEnhancedPaging>1&&(this._shouldResetPagingForEnhancedPaging||!this._resetProcessedForEnhancedPaging)&&(this._shouldResetPagingForEnhancedPaging=!1,this._resetProcessedForEnhancedPaging=!1,e=-1),this.props.updatedConfiguration.Parameters.PageNumberToRestore={Usage:1,Static:!0,Value:e}}this.props.lookupAttributeForRecordHierarchy&&this.props.gridInput&&(this.props.updatedConfiguration.Parameters.LookupAttributeNameForHierarchy={Usage:1,Static:!0,Value:this.props.lookupAttributeForRecordHierarchy})}_renderQuickFind(){const e=this._showNewQuickFindSearchBarForMobile();if(this.props.quickFindProps&&this._isWidthInitialized()){if(this._isWidthLessThanViewportSm()&&(this.state.quickFindVisibility||e)){const t=Object.assign(this.props.quickFindProps,{focusSearchBoxAfterRender:!0});return r.createElement(o.a,{key:"quickFind",style:this.props.styles.quickFindMobileStyle},r.createElement(Zt,Object.assign({},t,{updateGridPaginationStateHandler:this.props.updateGridPaginationStateHandler,resetPagingInfoForEnhancedPaging:this._resetPagingInfoForEnhancedPaging.bind(this),updateDataSetLoadingState:this._updateDataSetLoadingState.bind(this),ref:this._dataSetQuickFindRef,showNewQuickFindSearchBarForMobile:e})))}if(!this._isWidthLessThanViewportSm())return Object(Et.i)(this.props.contextString)?r.createElement(o.a,{style:this.props.styles.quickFindContainerStyle},this._getQuickFind()):this._getQuickFind()}return null}_renderAdvancedFilter(){const e=Object(Oe.c)(this.props.resourceStrings,C.ADVANCEDFILTER_OPEN_LABEL);if(this.props.featureControlProps.isModernGridButtonsEnabled){let e=this.props.styles.newEditColumnAndFilterButtonStyle;this.state.isFilterPanelOpen&&(e=Object.assign(Object.assign({},e),{background:this.props.theme.colors.BaseColor.Grey.Grey1}));const t=Object(Oe.c)(this.props.resourceStrings,C.EditFiltersButton);let i=Object(Oe.c)(this.props.resourceStrings,C.EditFiltersButton_Tooltip);return i=i.replace("\\r\\n","\n\n"),this._isWidthInitialized()&&this.props.showAdvancedFilter&&this.props.quickFindProps&&r.createElement(Bi.a,{key:"openAdvancedFilter",id:"open-advanced-filter",iconProps:{iconName:"Filter",style:{color:this.props.theme.colors.BaseColor.Blue.Blue3}},title:i,onClick:()=>{this._toggleAdvancedFilterPanel()},style:e,tabIndex:0,accessibilityLabel:i},this._showGridButtonsText()&&t)}return this._isWidthInitialized()&&this.props.showAdvancedFilter&&this.props.quickFindProps&&r.createElement(Ot.a,{key:"openAdvancedFilter",id:"open-advanced-filter",iconType:"filter",title:e,style:this.props.styles.advancedFilterButtonStyles,onClick:()=>{this._toggleAdvancedFilterPanel()},tabIndex:0,accessibilityLabel:e},r.createElement(Je.b,{id:"filter",accessibilityHidden:!0,type:d.a.Filter}))}_toggleAdvancedFilterPanel(){var e;if(this.props.featureControlProps.isDockedModeForGridEditorPanelsEnabled&&this.state.isFilterPanelOpen)this.setState({isFilterPanelOpen:!1});else{this._updateDataSetLoadingState(1);const t=[{name:"entityName",value:this.props.entityTypeName},{name:"ViewId",value:null===(e=this.props.viewId)||void 0===e?void 0:e.guid}];this.props.retrieveRelatedEntitiesMetadata(this.props.entityTypeName).then(()=>{this.setState({isFilterPanelOpen:!0,columnEditorPanelOpen:!1}),this._updateDataSetLoadingState(2),this.context.EventManager.ReportComponentSuccess(qi,t)},e=>{this._tracer.error(null==e?void 0:e.message),this._updateDataSetLoadingState(2),this.context.EventManager.ReportComponentFailure(qi,new Error(e),t)})}}_renderDiscardChanges(){if(this.props.showAdvancedFilter&&this.props.isViewEdited&&this._isWidthInitialized()&&!this.props.showColumnEditor)return r.createElement(Ot.a,{key:"clearAdvancedFilter",id:"clear-advanced-filter",iconType:"clearFilter",title:Object(Oe.c)(this.props.resourceStrings,C.AdvancedFind_DiscardButton_Title),style:this.props.styles.advancedFilterButtonStyles,onClick:()=>{var e;this.props.removeEditedViewPageMap(this.props.gridInput.pageToEditedViewMapId.guid,this.props.viewId),this._clearCustomFilterAndUpdateControlKeyIndex();const t=[{name:"entityName",value:this.props.entityTypeName},{name:"ViewId",value:null===(e=this.props.viewId)||void 0===e?void 0:e.guid}];this.context.EventManager.ReportComponentSuccess(Hi,t)},tabIndex:0,accessibilityLabel:Object(Oe.c)(this.props.resourceStrings,C.AdvancedFilter_DiscardButton_AccessibilityLabel)},r.createElement(Je.b,{id:"clearFilter",type:d.a.GlobalFilterClearAll}))}_renderColumnEditor(){if(!(this.props.showColumnEditor&&this._isWidthInitialized()&&this.props.quickFindProps))return;const e=Object(Oe.c)(this.props.resourceStrings,C.ColumnEditorButton);let t=Object(Oe.c)(this.props.resourceStrings,C.ColumnEditorButton_Tooltip);if(t=t.replace("\\r\\n","\n\n"),this.props.featureControlProps.isModernGridButtonsEnabled){const e=Object(Oe.c)(this.props.resourceStrings,C.ColumnEditorButtonLabel);let i=this.props.styles.newEditColumnAndFilterButtonStyle;return this.state.columnEditorPanelOpen&&(i=Object.assign(Object.assign({},i),{background:this.props.theme.colors.BaseColor.Grey.Grey1})),r.createElement(Bi.a,{key:"columnEditorBtn",id:"columnEditor-btn",iconProps:{iconName:"ColumnOptions",style:{color:this.props.theme.colors.BaseColor.Blue.Blue3}},title:t,"aria-label":t,onClick:this._onColumnEditorButtonClick.bind(this),style:i},this._showGridButtonsText()&&e)}return r.createElement(zi.a,{key:"columnEditorBtn",id:"columnEditor-btn",iconProps:{iconName:"ColumnOptions",style:{color:"black"}},title:e,"aria-label":e,onClick:()=>this.setState({columnEditorPanelOpen:!0}),style:this.props.styles.columnEditorButtonStyle})}_onColumnEditorButtonClick(){this.props.featureControlProps.isDockedModeForGridEditorPanelsEnabled&&this.state.columnEditorPanelOpen?this.setState({columnEditorPanelOpen:!1}):this.setState({columnEditorPanelOpen:!0,isFilterPanelOpen:!1})}_clearCustomFilterAndUpdateControlKeyIndex(){this.props.setCustomFilter("",0,this.props.id,this.props.contextToken).then(()=>{this._keyIndex++,this._onViewChanged(this.props.viewId.guid,this.props.entityTypeName,!1)})}_getQuickFind(){return r.createElement(o.a,{key:"quickFind",style:this.props.styles.quickFindStyle},r.createElement(Zt,Object.assign({},this.props.quickFindProps,{updateGridPaginationStateHandler:this.props.updateGridPaginationStateHandler,resetPagingInfoForEnhancedPaging:this._resetPagingInfoForEnhancedPaging.bind(this),updateDataSetLoadingState:this._updateDataSetLoadingState.bind(this),ref:this._dataSetQuickFindRef})))}_renderViewSelector(){if(this.props.viewSelectorProps&&this._isWidthInitialized()){const e=this._isWidthLessThanViewportSm()?this.props.styles.viewSelectorOuterMobileStyle:this.props.styles.viewSelectorOuterStyle;return r.createElement(o.a,{key:"viewSelector",style:e},r.createElement(Ke,Object.assign({isGridRoot:Object(Et.e)(this.props.contextString)},this.props.viewSelectorProps,{isTablet:this._isWidthLessThanViewportM(),isPhone:this._isWidthLessThanViewportSm(),key:"dataSetHostView",onChange:this._onViewChanged,onChangeUserDefaultView:this._setViewAsUserDefault,rootZIndex:this._isInSeeMoreState(),isRTL:this.props.isRTL,removeEditedViewPageMap:this.props.removeEditedViewPageMap})))}return this._renderTitle()}_renderQueueFilter(){if((this.props.entityTypeName===Ii.zb||this.props.entityTypeName===Ei.a)&&this.props.queueFilterProps&&this._isWidthInitialized()){const e=this._isWidthLessThanViewportSm()?this.props.styles.filterContainerMobileStyle:this.props.styles.filterContainerStyle;return r.createElement(lt,Object.assign({},this.props.queueFilterProps,{key:"queueFilter",onFilterChange:this._onFilterChange,updateFilterValue:this._updateFilterValue,resourceStrings:this.props.resourceStrings,style:e,isGridPaginationStateFeatureEnabled:this.props.featureControlProps.isGridPaginationStateFeatureEnabled}))}return null}_renderEntityFilter(){if(this.props.entityFilterProps&&this._isWidthInitialized()){const e=this._isWidthLessThanViewportSm(),t=e?this.props.styles.filterContainerMobileStyle:this.props.styles.filterContainerStyle,i=this.props.styles.activityTypeFilterContainerStyle;return r.createElement(bt,Object.assign({},this.props.entityFilterProps,{onToggleChange:this._onRollupViewToggleChanged,key:"EntityFilterDataSet",onFilterChange:this._onFilterChange,onActivityTypeChange:this._onActivityTypeMenuDismissed,onActivityTypeFilterClear:this._clearActivityTypeFilter,gridEntityName:this.props.gridEntityTypeName,resourceStrings:this.props.resourceStrings,containerStyle:t,activityTypeContainerStyle:i,rootZIndex:this._isInSeeMoreState(),isGridPaginationStateFeatureEnabled:this.props.featureControlProps.isGridPaginationStateFeatureEnabled,isMobile:e}))}return null}_renderDataSetChart(e){if(!this.props.chartProps||!this._isWidthInitialized())return null;this.props.chartProps.isLayoutVertical=this._isReflowLayoutVertical;const t=e!==this.props.isRTL,i=this._isReflowLayoutVertical?this._isWidthLessThanViewportSm()?this.props.styles.reflowChartMobileStyle:this.props.styles.reflowChartStyle:Object.assign(this.props.styles.chartStyle,t?this.props.styles.chartLeftBorderStyle:this.props.styles.chartRightBorderStyle);return r.createElement(v,Object.assign({},this.props.chartProps,{style:i,key:"pageChartDataSet",closeChartPaneHandler:this.props.toggleChartPane,moveChartPaneHandler:this.props.moveChartPane}))}_renderSortColumnsNativeDrawer(){return r.createElement(o.a,{key:"MobileSortColumnNativeDrawer"},r.createElement(Te.g,{title:this._sortDrawerTitle,onClose:()=>{this.setState({shouldRenderSortColumnsNativeDrawer:!1})},items:this._sortColumns,onChange:this._applySortingAndRefresh,selectedItem:this._selectedSortColumnName,onItemPress:e=>{e.preventDefault(),e.stopPropagation()}}))}_renderBackButtonForGridInMobile(){return this.props.commandBarProps&&this._isWidthInitialized()&&Object(Et.e)(this.props.contextString)&&this._isWidthLessThanViewportSm()&&this.props.backButtonEnabled?r.createElement(Ze.a,{pageId:this.props.id,overwriteStyle:{borderWidth:0,height:"auto",padding:0,margin:"-8px 0"}}):null}_renderCommandBar(){var e,t;if(!this.props.commandBarProps||!this._isWidthInitialized())return null;this._commandBarLoadedPromise||(this._commandBarLoadedPromise=new Promise(e=>{this._commandBarLoadedResolve=e})),this._commandManagerId=this._commandManagerId||this.props.commandBarProps.commandManagerId||Object(yt.a)();let i=this.props.styles.commandManagerContainerStyle,n=this.props.styles.commandBarStyle;this._isWidthLessThanViewportSm()&&(i=this.props.styles.commandManagerContainerMobileStyle,n=this.props.styles.commandBarMobileInnerStyle);const a=Object(Et.e)(this.props.contextString);return Object(Ye.b)(this.props.commandBarRefreshProps,n,this._isWidthLessThanViewportSm(),i),r.createElement(nt,Object.assign({},this.props.commandBarProps,{key:"commandBarDataSet",addedCommandList:this.state.addedCommandList,appendedCommandList:this.state.appendedCommandList,metaDataLoadedResolve:this._commandBarLoadedResolve,commandManagerId:this._commandManagerId,style:i,commandbarStyles:n,rootZIndex:this._isInSeeMoreState(),customControlType:this.props.updatedConfiguration.CustomControlId,isGridRoot:a,collapsed:this._isWidthLessThanViewportSm(),isNativeSubgridMode:this._isNativeSubgrid(),renderItemLevelCommandDrawer:this._renderControlCommandsNative,onCloseItemLevelCommandDrawer:this._onCloseItemLevelDrawer,itemLevelCommandList:this.state.itemLevelCommandList,skipPageXrmReady:null===(t=null===(e=this.props.systemDefinedProperties)||void 0===e?void 0:e.commandBarSkipPageXrmReady)||void 0===t?void 0:t.Value}))}_renderFooter(){if(Object(Et.g)(this.props.configuration)||Object(Et.f)(this.props.configuration)||Object(Et.h)(this.props.configuration))return null;let e=!1;if(this.props.totalResultCount<=this.props.pageSize&&!this.props.totalRecordCountLimitExceeded&&Object(Et.i)(this.props.contextString)&&!this._isInSeeMoreState()&&!this.props.jumpBarProps&&(e=this._shouldRenderSeeMoreButton(),!e))return this._logInfo("Hiding the footer for the subgrid because there is less than 2 pages of data"),null;if(this._isWidthInitialized()&&(this.props.jumpBarProps||this.props.pagingProps)){const t=this._isJumpBarRenderingAsFlyout()?this.props.styles.footerMobileStyle:this.props.isGridEditable?this.props.styles.footerEditableGridStyle:Object.assign(Object.assign({},this.props.styles.footerOuterStyle),this.props.jumpBarProps?this.props.styles.defaultFooterHeightStyle:this.props.styles.jumpBarLessFooterHeightStyle);if(!this.props.isGridEditable)return this._hideJumpbarForMobile()?null:r.createElement(o.a,{key:"dataSetFooter_"+this.props.id,style:t},!e&&this._renderJumpBar(),r.createElement(o.a,{key:"dataSetPagingContainer_"+this.props.id,style:this.props.styles.footerPagingContainer},this._renderPaging(e),this._renderSeeMoreButton()));if(this.props.jumpBarProps)return r.createElement(o.a,{key:"dataSetFooter_"+this.props.id,style:t},this._renderJumpBar());this._logInfo("Hiding the footer for the editable grid because the jump bar props is null")}return this._logInfo("Hiding the footer for the grid because the width for the controld is 0 or the jump bar props is null or paging props is null"),null}_jumpBarShouldRenderAsFlyout(e){const t=Object(Oe.c)(this.props.resourceStrings,C.JUMPBAR_ALPHABET);if(t){const i=t.split(","),r=e-100,n=this._isJumpBarRenderingAsFlyout()?.5:-.5;return!!i&&r/i.length<=32+n}return!1}_renderJumpBar(){let e=null;return this._isJumpBarRenderingAsFlyout()&&(e=this.props.styles.jumpBarButtonContainerStyle),this.props.jumpBarProps?r.createElement(o.a,{key:"jumpBar_"+this.props.id,style:e},r.createElement(Mt,Object.assign({},this.props.jumpBarProps,{rootZIndex:this._isInSeeMoreState(),controlKey:this.props.controlKey,renderMobile:this._isJumpBarRenderingAsFlyout(),isDeviceSizeSmall:!this._isWidthGreaterThan480(),isRTL:this.props.isRTL,isGridRoot:Object(Et.e)(this.props.contextString),updateGridPaginationStateHandler:this.props.updateGridPaginationStateHandler,setResetPagingInfoForEnhancedPaging:this._setResetPagingInfoForEnhancedPaging.bind(this),updateDataSetLoadingState:this._updateDataSetLoadingState.bind(this),isMobile:this._isWidthLessThanViewportM()}))):null}_renderPaging(e){const t=Object(Et.h)(this.props.configuration),i=!this.props.hasCustomDataProvider&&Object(he.a)(this.props.totalRecordCountLimitExceeded);return t&&this._logInfo("Hiding the paging button for the grid because the sharepoint grid does not support paging"),this.props.pagingProps?r.createElement(Ht,Object.assign({},this.props.pagingProps,{pagingInfo:this.state.pagingInfo,shouldPagingTextRender:!(e||this.props.clientHost===Mi.a.MailApp&&this._isWidthLessThanViewportSm()),incrementLastPage:this._incrementLastPage,setFirstPage:this._setFirstPage,enhancedPagingDisabled:!e&&!t&&!this._isNativePlatform,pagingTextDisabled:i,gridTotalRecordsCountLimit:this.props.gridTotalRecordsCountLimit,isGridRoot:Object(Et.e)(this.props.contextString),updateGridPaginationStateHandler:this.props.updateGridPaginationStateHandler,updateDataSetLoadingState:this._updateDataSetLoadingState.bind(this),isServerOffline:this.props.isOffline})):null}renderDataSetHostComponent(e,t,i,n,a){var s,c,u,h,m;let f=[];const y=this._isWidthLessThanViewportSm();this._isReflowLayoutVertical=!(!this._isWidthLessThanMinWidthForChartPlusGridReflow()||!this.props.chartProps);try{const v=this._getDataSetHostErrorMessage();if(Object(he.a)(v)||this.state.compositeControlInitState===Ce.a.Initializing){if(this._isWidthInitialized()||Object(Et.i)(this.props.contextString)&&this.state.compositeControlInitState!==Ce.a.Initializing){this._isShowChartChanged&&(this._getUpdateAddedCommandList(this._showCommandBarButtonColumnEditor(),this._showCommandBarButtonAdvancedFilter(),this._showCommandBarButtonSearch(),this._showCommandBarButtonShowChart()),this._onAddedCommandListChange(),this._isShowChartChanged=!1);const t=(Object(Et.e)(this.props.contextString)||Object(Et.d)(this.props.contextString))&&this.props.entityIsActivityType;y||Object(Et.i)(this.props.contextString)?(this.props.viewSelectorProps||this.props.quickFindProps||this.props.entityFilterProps||this.props.queueFilterProps||this.props.commandBarProps)&&(this.props.featureControlProps.isInMobileModeForOct2019&&Object(Et.e)(this.props.contextString)&&(a=Object.assign(Object.assign({},a),{display:"none"})),f.push(r.createElement(o.a,{key:"dataSetHeader_"+this.props.id,style:i},this._renderHeader([this._renderBackButtonForGridInMobile(),this._renderViewSelector(),this._renderCommandBar()],a),this._renderQuickFind(),t||this.props.entityFilterProps&&this.props.entityFilterProps.isRollupViewSupported&&this.props.contextString===b.o.ASSOCIATEDGRID?this._renderEntityFilter():this._renderQueueFilter()))):(f.push(this._renderCommandBar()),(this.props.viewSelectorProps||this.props.quickFindProps||this.props.entityFilterProps||this.props.queueFilterProps)&&f.push(r.createElement(o.a,{key:"dataSetHeader_"+this.props.id,style:i},this._renderHeader([this._renderViewSelector(),this._renderDiscardChanges(),this.props.isAdvancedColumnEditorEnabled&&this._renderColumnEditor(),this.props.isAdvancedColumnFilteringEnabled&&this._renderAdvancedFilter(),this._renderQuickFind()],a),t||this.props.entityFilterProps&&this.props.entityFilterProps.isRollupViewSupported&&this.props.contextString===b.o.ASSOCIATEDGRID?this._renderEntityFilter():this._renderQueueFilter())));let l=this.props.chartProps&&this._isReflowLayoutVertical?this.props.styles.reflowdataSetContentBodyStyle:this.props.styles.dataSetContentBodyStyle;this.props.featureControlProps.isAssociatedGridHeightEnabled&&Object(Et.d)(this.props.contextString)&&(l=Object.assign(Object.assign({},l),{flexBasis:"0px"}));if(this.props.chartProps&&!this._isReflowLayoutVertical&&this.props.featureControlProps.isSuiterChartEnabled||this._showNewQuickFindSearchBarForMobile()){const e="1px solid #d8d8d8";l=Object.assign(Object.assign({},l),{borderTop:e})}const d=(null===(u=null===(c=null===(s=this.props)||void 0===s?void 0:s.configuration)||void 0===c?void 0:c.Parameters)||void 0===u?void 0:u.EnableSubGridAutoCollapse)&&this.props.configuration.Parameters.EnableSubGridAutoCollapse,v=d&&d.Value,S=this.props.featureControlProps.isSubGridAutoCollapseEnabled&&Object(Et.i)(this.props.contextString)&&"true"===v;S&&0===this.props.totalResultCount&&(l=Object.assign(Object.assign({},l),{display:"none"})),this.props.featureControlProps.isSubGridRemoveMinHeightEnabled&&S&&(l=Object.assign(Object.assign({},l),{minHeight:"0px"}));const _=y&&Object(Et.e)(this.props.contextString),O=this._parentDefinedProps;O.eventListeners=this._parentDefinedEventHandlers,this.props.parentDefinedControlProps&&(O.height=this.props.parentDefinedControlProps.height>0&&this._seeMoreHelper.getSeeMorePopupStatus()===g.b.NotInUse?this.props.parentDefinedControlProps.height:void 0,O.width=this.props.parentDefinedControlProps.width>0&&this._seeMoreHelper.getSeeMorePopupStatus()===g.b.NotInUse?this.props.parentDefinedControlProps.width:void 0,O.decorators=this.props.parentDefinedControlProps.decorators,O.propertyBagOverrides=this.props.parentDefinedControlProps.propertyBagOverrides,(null===(h=this.props.parentDefinedControlProps.eventListeners)||void 0===h?void 0:h.length)&&(O.eventListeners=function(e){const t={};for(const{eventname:i,eventhandler:r}of e)t[i]||(t[i]=[]),t[i].push(...r);const i=[];for(const e in t)i.push({eventname:e,eventhandler:t[e]});return i}([...this._parentDefinedEventHandlers,...this.props.parentDefinedControlProps.eventListeners]))),O.parentInSeeMoreMode=this._seeMoreHelper.getSeeMorePopupStatus()!==g.b.NotInUse,O.containerStyleOverrides=this._getCombinedContainerStyleOverrides();const P="data-set-body-container";let w=null;this.props.chartProps&&this._isWidthInitialized()&&(w={width:"70%"});const C=dt.a.getInstance().get_IsBrowserIE()?Object.assign(n,{flex:"1 1 100%"}):n,I=null===(m=this.props.chartProps)||void 0===m?void 0:m.isChartOnTheRightSide;f.push(r.createElement(o.a,{key:"dataSetContentBody_"+this.props.id,style:l},I?null:this._renderDataSetChart(I),r.createElement(o.a,{key:"dataSetBody_"+this.props.id,style:!0===this._isReflowLayoutVertical?this.props.styles.reflowGridStyle:Object.assign(C,w),className:this._isInSeeMoreState()?"seeMore":void 0,testhooks:{id:P}},r.createElement(p.c,{key:this.props.controlKey+this._keyIndex,controlId:this.props.controlId,id:this.props.id,formInfo:this._savedFormInfo,configuration:this.props.updatedConfiguration,descriptor:this.props.descriptor?this.props.descriptor:this._savedDefault,systemDefinedProperties:this.props.systemDefinedProperties,rowSpan:this.props.rowSpan,parentDefinedControlProps:O,parentContextToken:this.props.contextToken,contextString:this.props.contextString,externalCommandManagerId:this._commandManagerId,externalCommandPromise:this._commandBarLoadedPromise,shouldRender:this.props.nonCompositionProps?this.props.nonCompositionProps.shouldRender:void 0}),this.state.shouldRenderSortColumnsNativeDrawer?this._renderSortColumnsNativeDrawer():null,_?null:this._renderFooter()),I?this._renderDataSetChart(I):null)),_&&f.push(this._renderFooter()),f=f.concat(this._renderAccessibilityComponent(e))}}else if(2!==this.state.loadingState&&this._updateDataSetLoadingState(2),f.push(r.createElement(o.a,{key:"dataSetHeader_"+this.props.id,style:i},this._renderHeader([this._renderViewSelector()],a))),this._isWidthInitialized()){const e={fontSize:this._isHeightGreaterThan240()&&this._isWidthGreaterThan480()?"4.5em":"2em",color:"red"},t={display:"flex",justifyContent:"center"},i=Object(Oe.c)(this.props.resourceStrings,C.SEE_MORE_DETAILS);f.push(r.createElement(o.a,null,r.createElement(l.a,{id:"gridErrorContainer"+this.props.id,text:v,icon:d.a.DetailsPageClose,iconStyle:e}),this.state.controlLoadInnerErrorMessage&&!this._isDataSetHostKnownError(this.state.controlLoadErrorMessage)&&r.createElement(o.a,{style:t},r.createElement(_t.a,{key:"gridInnerErrorMessage",href:"#",accessibilityLabel:i,onClick:()=>{this.props.showInnerError(this.state.controlLoadInnerErrorMessage)}},i))))}const S=Object.assign(Object.assign({},t),this.state.controlLoadInnerErrorMessage&&{backgroundColor:"#FFFFFF"});return r.createElement(o.a,{style:S,onMeasuring:this.onMeasuring,isRequestedMeasuring:!0,id:e,key:e,testhooks:{id:e,[wi.e]:this.props.previewId,[wi.f]:wi.g.row},semanticTag:this.props.semanticTag},f)}catch(e){this._onControlLoadedError(e)}}_getDataSetHostErrorMessage(){var e;let t=null;if(this.props.hasReadRolePrivilege)if(this.props.isUCIEntity||this.props.hasCustomDataProvider)if(this.props.offlineProps.isOfflineSqlQueryAvailable)t=this.props.isOffline&&this.state.controlLoadErrorMessage&&!this.props.hasCustomDataProvider?this.props.offlineProps.isEntityAvailableForOffline?this.props.offlineProps.isOfflineAvailableForUse?this.state.controlLoadErrorMessage:Object(Oe.c)(this.props.resourceStrings,C.OFFLINE_NOT_READY_FOR_USE):Object(Oe.c)(this.props.resourceStrings,C.ENTITY_NOT_AVAILABLE_IN_PROFILE):this.state.controlLoadErrorMessage;else{let e="";this.props.offlineProps.offlineErrorMessage&&(e=this.props.offlineProps.offlineErrorMessage),e||(e=Object(Oe.c)(this.props.resourceStrings,C.VIEW_NOTAVAILABLE_IN_OFFLINE)),t=e}else{const e=this.props.entityDisplayName?this.props.entityDisplayName:this.props.entityTypeName,i=Object(Oe.c)(this.props.resourceStrings,C.UCI_DISABLED_ENTITY_ERROR);t=String.format(i,e)}else t=Object(Oe.c)(this.props.resourceStrings,C.READ_PRIVILEGE_VIOLATION_KEY);return Object(he.a)(t)||null===(e=this._tracer)||void 0===e||e.error(`${Gi}._getDataSetHostErrorMessage : ${t}`,this.props.isOffline&&this.props.offlineProps.offlineGridErrorTelemetryParams),t}_renderHeader(e=[],t){const i=(e||[]).filter(e=>!!e);return i.length?r.createElement(o.a,{key:"dataSetHeaderInner_"+this.props.id,style:t},i):null}_getParentDefinedPropsDecoratorValue(e){return this.props.parentDefinedControlProps&&this.props.parentDefinedControlProps.decorators&&this.props.parentDefinedControlProps.decorators[e]}_shouldRenderSeeMoreButton(){return this._getParentDefinedPropsDecoratorValue("ShowSeeMore")&&!!this.props.totalResultCount}_renderSeeMoreButton(){const e=Object(Et.i)(this.props.contextString),t=Object(Et.d)(this.props.contextString),i=this._seeMoreHelper.getSeeMorePopupStatus(),n=Object(Et.h)(this.props.configuration);return!((e||t)&&!n)||i===g.b.PopFadeIn||i===g.b.PoppedOut||i===g.b.ReturnFadeOutAndMove||this.props.totalResultCount>=0&&this.props.totalResultCount<=this.props.pageSize&&!this._shouldRenderSeeMoreButton()||!this._isNativePlatform?(this._logInfo("Hiding the See more button for the grid because the grid does not support see more or there is less than 2 pages of data"),null):r.createElement(ei,{onSeeMoreClick:this._seeMorePopup.bind(this,!0,!1),resourceStrings:this.props.resourceStrings,containerStyle:this.props.styles.seeMoreButtonContainerStyle,buttonStyle:this.props.styles.seeMoreButtonStyle,seeMoreTextStyle:this.props.styles.seeMoreButtonTextStyle,localizedStrings:this._getSeeMoreLocalizedStrings()})}_getSeeMoreLocalizedStrings(){let e=null;return this.props.viewSelectorProps&&this.props.viewSelectorProps.title?e=this.props.viewSelectorProps.title:this.props.descriptor.ShowLabel&&this.props.descriptor.Label?e=this.props.descriptor.Label:this.props.entityDisplayName&&(e=this.props.entityDisplayName),this._isNativeSubgrid()?{uniqueLabel:e,seeMoreLabel:Object(Oe.c)(this.props.resourceStrings,C.SEE_ALL_LABEL),seeMoreTooltip:Object(Oe.c)(this.props.resourceStrings,C.SEE_ALL_TOOL_TIP)}:{uniqueLabel:e}}_isStreamOnSuiterDashboard(){return this.props.featureControlProps.isSuiterDashboardEnabled&&Object(Et.i)(this.props.contextString)&&this.props.configuration&&this.props.configuration.Parameters&&this.props.configuration.Parameters.UseDefaultCardFormForList&&this.props.configuration.Parameters.UseDefaultCardFormForList.Value}_renderProgressIndicator(){let e="datasethost-progress-indicator";this.props.descriptor&&(e+="-"+this.props.descriptor.Id);const t=Object.assign({},this.props.styles.dataSetChangingProgressIndicatorContainerStyle);let i=this.props.styles.progressIndicatorContainerStyle;return 1===this.state.loadingState?(t.width=this._width,t.height=Math.max(this._height,100)):0===this.state.loadingState&&this._isStreamOnSuiterDashboard()&&(i=Object.assign(Object.assign({},i),{borderBottom:"none"})),r.createElement(o.a,{key:"progressIndicatorContainer",id:"progressIndicatorContainer",style:0===this.state.loadingState?i:t},r.createElement(o.a,{key:"progressIndicator",id:"progressIndicator",style:0===this.state.loadingState?this.props.styles.progressIndicatorStyle:this.props.styles.dataSetChangingProgressIndicatorStyle},r.createElement(u.a,{key:e,id:e,testhooks:{id:e},style:this.props.styles.datasethostProgressIndicatorStyle,progressType:"ring",displayDelay:0===this.state.loadingState&&2e3,active:!0})))}componentWillUnmount(){this._seeMoreHelper&&this._seeMoreHelper.destroy(),clearTimeout(this._statusTimeout),this._statusTimeout=null}get _tracer(){return this.context?this.context.TraceManager.getTracer(b.P):null}_updateStatus(e){if(!this._isSubGridFirstLoad){if(this.state.statusMessage===e){if(this._statusTimeout&&this._statusTimeoutString===e)return;this.setState({statusMessage:""})}clearTimeout(this._statusTimeout),this._statusTimeoutString=e,this._statusTimeout=setTimeout(()=>{this.setState({statusMessage:e}),this._statusTimeout=null,this._statusTimeoutString=null},1e3)}}render(){var e,t,i,n,a;if(Object(he.a)(this.props.updatedConfiguration))return this._logInfo("DataSetHost not rendered. Configuration is null"),null;if(!this.props.isInitialized&&this.props.contextToken&&this.props.primaryDataSetName&&this.state.compositeControlInitState!==Ce.a.Error){const e=this.props.updatedConfiguration.Parameters[this.props.primaryDataSetName];if(!e)return this.props.controlManifest||this.props.loadManifest(this.props.configuration.CustomControlId,this.props.configuration.Name).then(e=>{const t=e.controlManifests[this.props.configuration.CustomControlId];let i="";if(t){for(const e in t.Properties.DataSetDefinitions)if(t.Properties.DataSetDefinitions[e].Primary){i=e;break}i&&this.props.updatedConfiguration.Parameters[i]||this.setState({compositeControlInitState:Ce.a.Error})}else this.setState({compositeControlInitState:Ce.a.Error})}).catch(e=>{this.setState({compositeControlInitState:Ce.a.Error}),this._logInfo(e)}),this._logInfo("DataSetHost not rendered. DataSet is not initialized and configuration does not contain primary dataset name."),null;if(this.state.compositeControlInitState===Ce.a.Uninitialized){this.setState({compositeControlInitState:Ce.a.Initializing});const t=this.props.viewId?this.props.viewId:e.ViewId?S.a.parse(e.ViewId):null,i=this.props.gridEntityTypeName||e.TargetEntityType||e.EntityName;if(!i&&!this.props.hasCustomDataProvider)return this._tracer&&this._tracer.error("DataSetHost not rendered. Reason: entityName unknown"),null;this.props&&this.props.hasCustomDataProvider&&this._logInfo("render: Initializing DataSetHost, id "+this.props.controlId+", for custom data provider"),this._logInfo(`Initializing grid for ${t} view and ${i} entity.`),this.props.initializeGrid(t,i,this.props.commandBarProps&&this.props.commandBarProps.commandManagerId,this.props.contextToken,this.props.featureControlProps).then(()=>{this._logInfo(`Initialized grid for ${t} view and ${i} entity.`),this.setState({compositeControlInitState:Ce.a.Initialized})},e=>{const t=e instanceof Error?e.message:e;-1!==ii.c.indexOf(t)?this._setControlLoadError(t):this._tracer&&this._tracer.error("Grid initialization failed. Reason: "+t),this.setState({compositeControlInitState:Ce.a.Error})})}return this._logInfo("DataSetHost not rendered. Either state is not initialized or resource strings are not initialized"),null}if(this.props&&this.props.nonCompositionProps&&this.props.nonCompositionProps.addedCommandListFromHostParent&&!this._areCommandListsSame(this._addedCommandListFromHostParent,this.props.nonCompositionProps.addedCommandListFromHostParent)&&(this._addedCommandListFromHostParent=this.props.nonCompositionProps.addedCommandListFromHostParent,this._onAddedCommandListChange()),this.props.descriptor&&this.props.descriptor.Parameters){const e=this.props.descriptor.Parameters[b.c];if(this._isWidthLessThanViewportSm()&&e&&"false"===e)return this._logInfo("DataSetHost not rendered. Available on phone is set to false"),null}this._configureDataSetControlParams(),this._updateViewSelectorProps(this.props),!this.props.viewId||!(null===(e=this.props.nonCompositionProps)||void 0===e?void 0:e.setPageInputViewId)||this.props.viewId.guid===(null===(i=null===(t=this.props.gridInput)||void 0===t?void 0:t.viewId)||void 0===i?void 0:i.guid)&&(null===(n=this.props.gridInput)||void 0===n?void 0:n.viewType)||this.props.savedQueryType===P.a.QUICKFIND_SEARCH||this.props.nonCompositionProps.setPageInputViewId(this.props.viewId.guid),this._savedDefault&&this.props.controlId===this._savedDefault.Id||(this._savedDefault={Id:this.props.controlId,HasContext:!0,Label:"",Name:"",ShowLabel:!1,Visible:!0,Disabled:!1}),this.props.formInfo&&(this._savedFormInfo=this.props.formInfo,null!=this.props.ribbonId&&(this._savedFormInfo.RibbonId=this.props.ribbonId));const s=this.props.descriptor&&this.props.descriptor.DomId&&this.props.descriptor.Id?this.props.descriptor.DomId.includes(this.props.descriptor.Id)?this.props.descriptor.DomId:this.props.descriptor.Id:this.props.id,l="dataSetRoot_"+s,{containerStyle:u,headerStyle:d}=this.props.styles;let{rootStyle:p,headerInnerStyle:h,bodyStyle:m}=this.props.styles;this._updateChangeVisualizationButtons(this.props.updatedConfiguration.FormFactor.toString());let f=u;this.props.featureControlProps.isDockedModeForGridEditorPanelsEnabled&&this.state.columnEditorPanelOpen&&(f=this.props.isRTL?Object.assign(Object.assign({},f),{marginLeft:"340px"}):Object.assign(Object.assign({},f),{marginRight:"340px"})),this.props.featureControlProps.isDockedModeForGridEditorPanelsEnabled&&this.state.isFilterPanelOpen&&(f=this.props.isRTL?Object.assign(Object.assign({},f),{marginLeft:"592px"}):Object.assign(Object.assign({},f),{marginRight:"592px"}));let y={shadowStyle:null,innerStyle:null,outerStyle:null};this._isWidthLessThanViewportSm()&&(m=this.props.styles.bodyMobileStyle,h=this.props.styles.headerInnerMobileStyle);const v=this._seeMoreHelper.getSeeMorePopupStatus(),_=this._seeMoreHelper.getSeeMorePopupInfo();v!==g.b.NotInUse&&(y=g.a.getCustomControlFancyPopoutStyles(this.props.renderer,v,_),v!==g.b.ReturnFadeIn&&(f={height:_.startHeight,width:_.startWidth},p=Object.assign(Object.assign({},p),{height:_.endHeightInner-48})));const O=this.renderDataSetHostComponent(l,p,d,m,h),w=(this._getDataSetHostRootElement(),this._seeMorePopup.bind(this,!1)),C=this.props.isRTL,I=function(e,t,i,n,a,s,l,c=!1){const u=a||s,d="DataSetHostContainer";return r.createElement(o.a,{key:d,id:`${d}_${l}`,style:u,testhooks:{id:d}},e.renderCloseButton(n,!0,!1,c),e.renderSpacer(!0,!1),t)}(this._seeMoreHelper,O,0,w,y.innerStyle,p,l,C);let E=Object.assign({},y.outerStyle?y.outerStyle:p);0===this.state.loadingState?(E.visibility="hidden",E.maxHeight="0"):1===this.state.loadingState&&(E=Object.assign(Object.assign({},E),{opacity:"0.6",pointerEvents:"none",minHeight:this._height}));const j=function(e,t,i,n){const a=t||{width:"100%"},s=n?Ft.f:null;return r.createElement(o.a,{key:"DataSetHostOuterContainer",id:i+"_outer",style:a,role:s,testhooks:{"uci-dialog":!0}},e)}(I,E,l,(null===(a=this._seeMoreHelper)||void 0===a?void 0:a.getSeeMorePopupStatus())!==g.b.NotInUse),D=function(e,t){return t=t||{display:"none"},r.createElement(o.a,{key:"shadow",id:e?e+"shadow":null,style:t})}(l,y.shadowStyle),T=`datassethost_root_view_${s}_${l}`,F=dt.a.getInstance().get_IsBrowserIE()&&Object(Et.i)(this.props.contextString)?{overflow:"visible"}:{},{mobileSubGridContainerStyles:N}=this.props.styles;let R=Object.assign(f,F);this._isNativePlatform&&Object(Et.i)(this.props.contextString)&&this.props.featureControlProps.isInMobileModeForApril2020&&this.props.featureControlProps.isSubgridImprovementsEnabled&&(R=Object.assign(Object.assign({},R),N));const k=this.state.columnEditorPanelOpen||this.state.isFilterPanelOpen,A=this.state.isFilterPanelOpen?"592px":"340px",M=C?{left:k?`calc(${R.marginLeft} + ${A})`:0}:{right:k?`calc(${R.marginRight} - ${A})`:0};return r.createElement(o.a,{key:T,style:R},r.createElement(c.a,{role:Ft.w,notificationType:Ut.b,style:{left:"-3000%",width:"0%",height:"0%",position:"absolute"}},this.state.statusMessage),D,j,this.props.showAdvancedFilter&&this.state.isFilterPanelOpen&&r.createElement(r.Fragment,null,r.createElement(o.a,{id:l+"_AdvancedFilterPanel",style:M}),r.createElement(Di,{controlId:this.props.controlId,controlKey:this.props.controlKey,id:this.props.id,contextToken:this.props.contextToken,entityTypeName:this.props.entityTypeName,fetchXML:this.props.fetchXML,filterPanelOpen:this.state.isFilterPanelOpen,viewId:this.props.viewId,gridInput:this.props.gridInput,updateFetchXml:this.props.updateFetchXml,updatePageInput:this.props.updatePageInput,closeFilterPanel:this.closeFilterPanel,onViewChanged:this._onViewChanged,setAdvancedPanelApplyClick:()=>{this._clearCustomFilterAndUpdateControlKeyIndex(),this.setState({isAdvancedFilterEdited:!0})},originalView:this.props.originalView,resourceStrings:this.props.resourceStrings,telemetryMonitorAdvancedFindDiscard:Hi,resetAdvancedFilter:()=>this.setState({isAdvancedFilterEdited:!1}),isDockedModeForGridEditorPanelsEnabled:this.props.featureControlProps.isDockedModeForGridEditorPanelsEnabled,parentKey:l+"_AdvancedFilterPanel",featureProps:this.props.featureControlProps})),this.props.showColumnEditor&&r.createElement(r.Fragment,null,r.createElement(o.a,{id:l+"_ColumnEditorPanel",style:M}),r.createElement(Li,{entityTypeName:this.props.entityTypeName,onViewChanged:this._onViewChanged,columnEditorPanelOpen:this.state.columnEditorPanelOpen,columnEditorPanelDismiss:()=>this.setState({columnEditorPanelOpen:!1}),viewId:this.props.viewId,pageId:this.props.id,gridInput:this.props.gridInput,updatePageInput:this.props.updatePageInput,fetchXML:this.props.fetchXML,originalView:this.props.originalView,isAdvancedFindFilterEdited:this.state.isAdvancedFilterEdited,isDockedModeForGridEditorPanelsEnabled:this.props.featureControlProps.isDockedModeForGridEditorPanelsEnabled,parentKey:l+"_ColumnEditorPanel"})),2!==this.state.loadingState?this._renderProgressIndicator():null)}closeFilterPanel(){this.setState({isFilterPanelOpen:!1})}componentWillReceiveProps(e){(Object(Et.e)(this.props.contextString)||Object(Et.i)(this.props.contextString)||Object(Et.d)(this.props.contextString))&&(!this.props.isOffline&&e.isOffline||!this.props.isOfflineByDefaultAvailable&&e.isOfflineByDefaultAvailable)&&0===this._offlineSqlQueryRetrieveState&&this.props.offlineProps.isEmptyOfflineSqlQuery&&(this._offlineSqlQueryRetrieveState=1,this.props.retrieveView(this.props.entityTypeName,this.props.savedQueryType,this.props.viewType,this.props.viewId,!1).then(()=>{this._offlineSqlQueryRetrieveState=2;const e=[{name:"scenario",value:"Called retrieveView"},{name:"entityTypeName",value:this.props.entityTypeName},{name:"viewId",value:S.a.toString(this.props.viewId)}];this.context&&this.context.EventManager&&this.context.EventManager.ReportComponentSuccess&&this.context.EventManager.ReportComponentSuccess(Gi+".componentWillReceiveProps",e)}).catch(e=>{this._offlineSqlQueryRetrieveState=2;const t=[{name:"scenario",value:"Called retrieveView"},{name:"error",value:e&&e.message},{name:"entityTypeName",value:this.props.entityTypeName},{name:"viewId",value:S.a.toString(this.props.viewId)},{name:"viewType",value:this.props.viewType},{name:"savedQueryType",value:this.props.savedQueryType}];this.context&&this.context.EventManager&&this.context.EventManager.ReportComponentFailure&&this.context.EventManager.ReportComponentFailure(Gi+".componentWillReceiveProps",e,null,t)})),this._isShowChartChanged=this.props.showChart!==e.showChart;const t=Object(Oe.c)(e.resourceStrings,C.GRID_LOADING_PLACEHOLDER).replace("{0}",e.entityDisplayName),i=2===this.state.loadingState?e.notificationMessage:t;this._updateStatus(i)}shouldComponentUpdate(e){return this.props.entityTypeName===I.a&&this.props.gridEntityTypeName!==e.gridEntityTypeName&&this._currentFilterValue?(this._updateFilterOnViewSelectorChange(e.gridEntityTypeName),!1):1!==this._offlineSqlQueryRetrieveState&&(0!==e.refreshCounter&&this.props.refreshCounter!==e.refreshCounter&&2===this.state.loadingState&&this._updateDataSetLoadingState(1),!0)}componentDidUpdate(){this._seeMoreHelper.getSeeMorePopupStatus()!==g.b.NotInUse&&this._seeMoreHelper.checkOnPopupStatus(!0,!1,this._getDataSetHostRootElement()),Object(Et.i)(this.props.contextString)&&(0===this.state.loadingState?this._isSubGridFirstLoad=!0:1===this.state.loadingState&&(this._isSubGridFirstLoad=!1))}componentDidMount(){var e;(null===(e=this.props.gridInput)||void 0===e?void 0:e.advancedFindExperience)&&(this._updateDataSetLoadingState(1),this.props.retrieveRelatedEntitiesMetadata(this.props.entityTypeName).then(()=>{this.setState({isFilterPanelOpen:!0}),this._updateDataSetLoadingState(2)},e=>{this._tracer.error(null==e?void 0:e.message),this._updateDataSetLoadingState(2)}))}_renderAccessibilityComponent(e){const t=e+"Accessibility";if(Object(Et.e)(this.props.contextString)){const i=[];if(this.props.viewSelectorProps){const n=this.props.viewSelectorProps.id;i.push(r.createElement(Tt.a,{key:t,rootElementId:e,isModal:!1,shouldManageFocus:!0,defaultFocusId:n}))}else i.push(r.createElement(Tt.a,{key:t,rootElementId:e,isModal:!1,shouldManageFocus:!0}));return i}return null}_isInSeeMoreState(){const e=this._seeMoreHelper.getSeeMorePopupStatus();return e!==g.b.NotInUse&&e!==g.b.ReturnFadeOutAndMove&&e!==g.b.ReturnFadeIn}_isNativeSubgrid(){return Object(Et.i)(this.props.contextString)&&this.props.clientHostSubtype===xi.a.Phone&&this.props.featureControlProps.isInMobileModeForOct2019&&this.props.featureControlProps.isInMobileModeForApril2020&&this.props.featureControlProps.isSubgridImprovementsEnabled}_getCombinedContainerStyleOverrides(){const{containerStyleOverrides:e}=this._parentDefinedProps,t=this.props.parentDefinedControlProps&&this.props.parentDefinedControlProps.containerStyleOverrides;return Object.assign(e,t,{rootContainer:Object.assign(e.rootContainer,{flex:Object(Et.e)(this.props.contextString)||this._isInSeeMoreState()?"1 1 100%":"1 1 auto"},t&&t.rootContainer),primaryInnerContainer:this._isInSeeMoreState()?{flex:"1 1 100%",minHeight:"0"}:{}})}_updateViewSelectorProps(e){if(e.descriptor&&e.viewSelectorProps&&e.descriptor.Parameters){const t=e.descriptor.Parameters[b.S],i=t?t.toString().split(","):null,r=i?i.map(e=>S.a.tryParse(e)):null;e.viewSelectorProps.viewIds=r||null}}_getCachedSize(){return this._cachedSize||(this._cachedSize=this.props.cachedSize),this._cachedSize}_isWidthInitialized(){return this.state.isWidthInitialized||this._getCachedSize()&&this._getCachedSize().isWidthInitialized||!1}_isWidthLessThanViewportSm(){return this.state.isWidthLessThanViewportSm||this._getCachedSize()&&this._getCachedSize().isWidthLessThanViewportSm||!1}_isWidthLessThanViewportM(){return this.state.isWidthLessThanViewportM||this._getCachedSize()&&this._getCachedSize().isWidthLessThanViewportM||!1}_isWidthLessThanMinWidthForChartPlusGridReflow(){return this.state.isWidthLessThanMinWidthForChartPlusGridReflow||this._getCachedSize()&&this._getCachedSize().isWidthLessThanMinWidthForChartPlusGridReflow||!1}_isWidthGreaterThan480(){return this.state.isWidthGreaterThan480||this._getCachedSize()&&this._getCachedSize().isWidthGreaterThan480||!1}_isHeightGreaterThan240(){return this.state.isHeightGreaterThan240||this._getCachedSize()&&this._getCachedSize().isHeightGreaterThan240||!1}_showCommandBarButtonSearch(){var e;return(null===(e=this.state)||void 0===e?void 0:e.showCommandBarButtonSearch)||this._getCachedSize()&&this._getCachedSize().showCommandBarButtonSearch||!1}_showCommandBarButtonColumnEditor(){var e;return(null===(e=this.state)||void 0===e?void 0:e.showCommandBarButtonColumnEditor)||this._getCachedSize()&&this._getCachedSize().showCommandBarButtonColumnEditor||!1}_showCommandBarButtonAdvancedFilter(){var e;return(null===(e=this.state)||void 0===e?void 0:e.showCommandBarButtonAdvancedFilter)||this._getCachedSize()&&this._getCachedSize().showCommandBarButtonAdvancedFilter||!1}_showCommandBarButtonShowChart(){var e;return(null===(e=this.state)||void 0===e?void 0:e.showCommandBarButtonShowChart)||this._getCachedSize()&&this._getCachedSize().showCommandBarButtonShowChart||!1}_isJumpBarRenderingAsFlyout(){return this.state.isJumpBarRenderingAsFlyout||this._getCachedSize()&&this._getCachedSize().isJumpBarRenderingAsFlyout||!1}_showGridButtonsText(){return this._getCachedSize()&&this._getCachedSize().width>1020}_hideJumpbarForMobile(){return this.props.featureControlProps.isJumpbarFeatureForMobileEnabled&&this._isWidthLessThanViewportSm()&&(Object(Et.e)(this.props.contextString)||Object(Et.d)(this.props.contextString))&&this.props.featureControlProps.isInMobileModeForApril2020}_showNewQuickFindSearchBarForMobile(){var e,t,i,r,n,a,s;return this._checkIfMobileImprovementsEnabledForQuickFindSearchOnGridRoot()&&this._isWidthLessThanViewportSm()&&((null===(e=this.props.configuration)||void 0===e?void 0:e.CustomControlId)===b.D||(null===(t=this.props.configuration)||void 0===t?void 0:t.CustomControlId)===b.y||(null===(i=this.props.configuration)||void 0===i?void 0:i.CustomControlId)===b.C||(null===(r=this.props.configuration)||void 0===r?void 0:r.Name)===b.u||(null===(n=this.props.configuration)||void 0===n?void 0:n.Name)===b.D||(null===(a=this.props.configuration)||void 0===a?void 0:a.Name)===b.y||(null===(s=this.props.configuration)||void 0===s?void 0:s.Name)===b.C)}_checkIfMobileImprovementsEnabledForQuickFindSearchOnGridRoot(){return this.props.featureControlProps.isQuickFindImprovementsEnabled&&this.props.featureControlProps.isInMobileModeForApril2020&&Object(Et.e)(this.props.contextString)}_areCommandListsSame(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if((e[i]||t[i])&&(e[i]&&!t[i]||!e[i]&&t[i]||e[i].Id!==t[i].Id||e[i].DisplayText!==t[i].DisplayText||e[i].Children&&!t[i].Children||!e[i].Children&&t[i].Children||e[i].Children&&t[i].Children&&!this._areCommandListsSame(e[i].Children,t[i].Children)))return!1;return!0}}Qi.displayName="DataSetHost",Qi.contextType=ce.a;const Ki=Object(s.a)(Et.k,(function(e,t){return{initializeGrid:(i,r,n,a,s)=>{const o=ri.a.fromXmlAndSql("","",i).getQueryState(),l=t.descriptor&&t.descriptor.Parameters?t.descriptor.Parameters[b.F]:null,c=t.descriptor&&t.descriptor.Parameters&&t.descriptor.Parameters[b.G]?parseInt(t.descriptor.Parameters[b.G],10):null;n||(n=Object(st.c)(t.id,a));const u=e(Object(li.d)(o,r,t.id,a,t.descriptor,l,c,void 0,n)),d=s.disableLoadDependenciesOnMissingViewId&&!i?Promise.resolve():e(Object(vi.b)(r,i,t.id)),p=e(Object(_e.e)(C.labelList));return Promise.all([u,p,d])},removeEditedViewPageMap:(t,i)=>e(Object(Ti.c)(t,i.guid)),updatePageInput:(t,i)=>e(Object(Fi.d)(t,i)),updateView:(i,r,n,a,s,o,l,c,u,d)=>{const p=(d.gridSynchronousFilterClearing?Promise.all([e(Object(wt.m)("",i,o)),e(Object(wt.n)("",i,o)),e(Object(wt.j)("",i,o)),e(Object(ai.b)("",0,i,o))]):Promise.resolve()).then(()=>e(Object(ci.a)(i,o,r,n,a)).then(()=>e(Object(hi.a)(i,s)))),h=S.a.tryParseOrNull(n),g=d.disableLoadDependenciesOnMissingViewId&&!h?Promise.resolve():e(Object(vi.b)(a,h,i));let m=Promise.resolve(null);if(u){const t=Object(ti.a)(a,l,o,c,!0);m=e(t.getFilterOptionsAction())}return Promise.all([p,g,m]).then(()=>{if(Object(Et.e)(t.contextString)){const e=[{filterType:0,filterExpressionOrValue:null}];t.updateGridPaginationStateHandler(e,t.id)}d.gridSynchronousFilterClearing||(e(Object(wt.m)("",i,o)),e(Object(wt.n)("",i,o)),e(Object(wt.j)("",i,o)),e(Object(ai.b)("",0,i,o)))})},retrieveView:(t,i,r,n,a)=>e(Object(Se.a)(t,i,r,n,!1)),markSelectedRows:(t,i,r)=>e(Object(Vt.b)(t,i,r)),markSelectedRelatedEntity:(t,i,r)=>e(Object(Bt.b)(t,i,r)),rowProperties:(t,i,r)=>e(Object(ui.b)(t,i,r)),updateFetchXml:(t,i,r)=>e(Object(di.b)(t,i,r)),applyGridFilter:(i,r,n)=>{if(Object(Et.e)(t.contextString)){const e=[{filterType:8,filterExpressionOrValue:i},{filterType:11,filterExpressionOrValue:r}];t.updateGridPaginationStateHandler(e,t.id)}e(Object(wt.k)(r,t.id,n)),e(Object(wt.l)(i,t.id,n))},applyActivityTypeFilter:(i,r,n)=>{if(Object(Et.e)(t.contextString)){const e=[{filterType:9,filterExpressionOrValue:i},{filterType:10,filterExpressionOrValue:r}];t.updateGridPaginationStateHandler(e,t.id)}e(Object(wt.h)(r,t.id,n)),e(Object(wt.i)(i,t.id,n))},onSelectedOrderColumnChange:(i,r)=>{e(Object(wt.o)(i,t.id,r))},toggleGridRollupView:(i,r)=>{e(Object(pi.b)(i,t.id,r))},updatePagingData:(t,i,r)=>e(Object(si.b)(t,i,r)),updateQueryKey:(t,i,r)=>{e(Object(oi.b)(t,i,r))},setCustomFilter:(t,i,r,n)=>e(Object(ai.b)(t,i,r,n)),runOnRecordSelect:(i,r,n,a)=>{e(function(e,t,i,r,n,a){return{type:"dataset.run.on.record.select",sync:!0,execute({dispatch:n,getState:s},o){const l=o.TraceManager.getTracer(b.P),c=b.N+".RunOnRecordAction";try{if(o&&o.ScriptManager){const u=o.ScriptManager.getContainer(e);if(u&&r&&1===r.length){const e=Object(ni.c)(s()),d=Object(ni.b)(s());e&&(n(u.getEventManager().addGridOnRecordSelectHandlers(t)),a||n(u.getEventManager().addGridOnChangeHandlers(t))),(e||d)&&n(u.getEventManager().runOnRecordSelect(t,i)),l.info("Triggered the action for {0} selected records"+r.length),o.EventManager.ReportComponentSuccess(c)}}}catch(e){const t="Triggered action for selected records failed with error : "+e.message;o.EventManager.ReportComponentFailure(c,Error(t))}}}}(i,r,r.controlName?r.controlName:"entity_control",n,Object(Et.e)(t.contextString)||Object(Et.i)(t.contextString),a))},retrieveRelatedEntitiesMetadata:t=>e(Object(Ni.a)(t)),retrieveRecordCommand:(t,i,r,n,a,s,o,l,c,u)=>e(Object(Ui.c)(u,t,i,r,n,a,s,o,l,c)),switchHomepageConfiguration:(t,i,r,n,a)=>{e(Object(gi.h)(t,i,r,n,a))},switchViewConfiguration:(t,i,r,n,a)=>{e(Object(gi.j)(t,i,r,n,a))},switchSubgridVisualization:(t,i,r)=>{e(Object(gi.i)(t,i,r))},switchAssociatedGridVisualization:(t,i,r,n,a,s,o,l)=>{e(l?Object(gi.g)(t,i,r,n,a,s,o):Object(gi.f)(t,i,r,a,o))},toggleChartPane:(t,i,r)=>{e(Object(Si.b)(t,i,r))},moveChartPane:(t,i,r)=>{e(Object(_i.c)(t,i,r))},clearQuery:()=>{e(Object(ji.a)())},updateUserDefaultGridView:(t,i,r,n,a,s)=>e(function(e,t,i,r,n,a){return{type:"grid.update.userdefaultview",execute(s,o){const l=o.TraceManager.getTracer(b.P),c=b.N+".updateUserDefaultGridViewAction";try{l.info("Updating the user default view for the grid.");const u=s.getState(),d="usersettings",p=new fi.a(d,Object(Xt.q)(u)),h=Object(we.h)(u,e);if(!p||!h.ObjectTypeCode)return Promise.resolve();const g="<DefaultGridViews><DefaultGridView><EntityTypeCode>{0}</EntityTypeCode><ChildEntityName>{1}</ChildEntityName><QueueId>{2}</QueueId><ViewId>{3}</ViewId><ViewType>{4}</ViewType></DefaultGridView></DefaultGridViews>";a&&(t="",i="",n=[],r="");const m=[];for(const e of n){const t=S.a.tryParse(e),i=S.a.externalGuid(t);m.push(i)}const f=String.format(g,h.ObjectTypeCode,r||"",1===m.length?m.toString():"",S.a.externalGuid(S.a.tryParse(t)),i);s.dispatch(Object(mi.f)(p,{personalizationsettings:f}));const b={ViewId:t,ViewType:+i,QueueId:n.toString()};return s.dispatch(Object(bi.j)(b,e)),Object(yi.b)(u),o.EventManager.ReportComponentSuccess(c),Promise.resolve()}catch(e){const t="Failed to update user default grid view with error : "+e.message;o.EventManager.ReportComponentFailure(c,Error(t))}}}}(t,i,r,n,a,s)),updateCurrentPageNumber:(t,i,r)=>e(Object(kt.b)(t,i,r)),setNewPageRequested:(t,i,r)=>{e(Object(Lt.b)(t,i,r))},retrieveControlResourceStringsForSwitchVisualization:t=>{const i=t.filter(e=>null!=e);return e(Object(_e.e)(i))},updatePageNumberForEnhancedPaging:e=>{if(Object(Et.e)(t.contextString)){const i=[{filterType:12,filterExpressionOrValue:e}];t.updateGridPaginationStateHandler(i,t.id)}},openManageDuplicatesDialog:t=>{e(Object(Ci.a)(null,null,fi.a.fromExternalEntityReference(t.entityReference))).then(i=>{if(0===i.status)return e(Object(Ve.a)(i.pageId)).then(e=>{"ignore_save"===e.value.param_lastButtonClicked&&t.reject()})})},showInnerError:i=>{const r=new ki.a(i,null,null,null,null,{stack:`${i} ${(new Error).stack}`,message:i});e(Object(Ri.a)(t.id,r))},loadManifest:(t,i)=>e(Object(Wi.c)(t,i))}}))((function(e){const t=r.useContext(a.a);return r.createElement(Qi,Object.assign({},e,{renderer:t}))}))},"9V+K":function(e,t,i){"use strict";function r(e){const t=(new DOMParser).parseFromString("","text/xml"),i=t.createElement("grid");i.setAttribute("name",e.name),i.setAttribute("object",e.object?e.object.toString():"0"),i.setAttribute("jump",e.jump),i.setAttribute("select",e.select?"1":"0"),i.setAttribute("icon",e.icon.toString()),i.setAttribute("preview",e.preview?"1":"0"),e.iconRenderer&&i.setAttribute("iconRenderer",e.iconRenderer),e.rows.forEach(e=>{const r=function(e,t){const i=t.createElement("row");return i.setAttribute("name",e.name),i.setAttribute("id",e.id),e.layoutStyle&&i.setAttribute("layoutStyle",e.layoutStyle),e.multiObjectIdField&&i.setAttribute("multiobjectidfield",e.multiObjectIdField),e.cells.forEach(e=>{const r=function(e,t){const i=t.createElement("cell");return i.setAttribute("name",e.name),i.setAttribute("width",e.width.toString()),e.labelId&&i.setAttribute("LabelId",e.labelId),e.desc&&i.setAttribute("desc",e.desc),e.isHidden&&i.setAttribute("ishidden",e.isHidden?"1":"0"),e.disableSorting&&i.setAttribute("disableSorting",e.disableSorting?"1":"0"),e.disableMetaDataBinding&&i.setAttribute("disableMetaDataBinding",e.disableMetaDataBinding?"1":"0"),e.cellType&&i.setAttribute("cellType",e.cellType),e.imageProviderWebresource&&i.setAttribute("imageproviderwebresource",e.imageProviderWebresource),e.imageProviderFunctionName&&i.setAttribute("imageproviderfunctionname",e.imageProviderFunctionName),i}(e,t);i.append(r)}),i}(e,t);i.append(r)});return(new XMLSerializer).serializeToString(i)}i.d(t,"a",(function(){return r}))},ANW1:function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var r=i("kSDG"),n=i("yTPE"),a=i("nfCs"),s=i("r0As"),o=i("SAYH"),l=i("LbMF"),c=i("fKWG"),u=i("/A0C");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class d extends n.a{constructor(e,t,i,r,n,a,s,o){if(super(e,t,i,r,n),this._chartType=o,-1!==a.indexOf(".")){const e=a.split(".");2===e.length&&(this._newGroupByLinkedEntityAlias=e[0],this._newGroupByAttributeName=a.split(".")[1],this._newGroupByLinkedEntityName=s)}else this._newGroupByAttributeName=a}get drillDownChartType(){return this._chartType}setupAggregationQueries(){if(!this.initialized)throw new Error("ChartDataSetQueryDecorator has not been initialized.");this.isWebResourceChart||(this._removeExistingGroupBysAndOrderBys(),this._addNewGroupBys(),this.dataDefinition.buildCategory(),Object(s.i)(this.dataDefinition.entityExpression))}_removeExistingGroupBysAndOrderBys(){const e=this.dataDefinition.entityExpression;Object(s.j)(e,"groupby"),this.dataDefinition.groupByList.length=0}_addNewGroupBys(){const e=this.dataDefinition.entityExpression,t="_"+o.a.toString(o.a.newGuid()).replace(/-/g,""),i=this._newGroupByLinkedEntityName?this._newGroupByLinkedEntityName:this.dataDefinition.entityExpression.entityName;let r=null;const n=this._createDateTimeGroupingInfo(i),l=n?Object(a.c)(n.groupingType):null;if(this._newGroupByLinkedEntityName){const i=this._getRequiredLinkedEntityFromViewDefintion();if(null!=i){const a=Object(s.c)(i,e);Object(s.g)(a,this._newGroupByAttributeName,t,"true",null,l,"true"),Object(s.a)(a,e),e.linkedEntities.push(a),r=this._createNewGroupByAndAddToExpression(t,a,n),this._GroupByKey=`LinedEntity_${a.entityName}_alias_${a.alias}_from_${a.linkFromAttribute}_to_${a.linkToAttribute}_join_${a.joinType}_GroupBy_${this._newGroupByAttributeName}_${l}`}}else Object(s.g)(e,this._newGroupByAttributeName,t,"true",null,l,"true"),r=this._createNewGroupByAndAddToExpression(t,e,n);this._GroupByKey=`GroupBy_${this._newGroupByAttributeName}_${l}`,this.dataDefinition.addGroupBys(r)}_createNewGroupByAndAddToExpression(e,t,i){const n=Object(r.a)(this._newGroupByAttributeName,e,t,i);return n.hasGroupBy=!0,t.attributes.push(n),t.groupByAttributes.push(n),n}_getRequiredLinkedEntityFromViewDefintion(){for(let e=0;e<this.viewDefinition.linkedEntities.length;e++)if(this.viewDefinition.linkedEntities[e].alias===this._newGroupByLinkedEntityAlias)return this.viewDefinition.linkedEntities[e];return null}_createDateTimeGroupingInfo(e){return Object(l.a)(this.getState(),e,this._newGroupByAttributeName).Type===u.a.DateTime?Object(a.a)(c.a.MONTH):null}getStorageKey(){let e=super.getStorageKey();return e=`${e}:${this._GroupByKey}:${this._chartType}`,e}}},AsoW:function(e,t,i){"use strict";i.d(t,"c",(function(){return l})),i.d(t,"a",(function(){return c})),i.d(t,"d",(function(){return u})),i.d(t,"b",(function(){return o}));var r=i("5Oca"),n=i("LbMF"),a=i("/A0C"),s=i("jS4H");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function o(e,t){var i;return null===(i=Object(s.a)(e,t))||void 0===i?void 0:i.businessProcessFlowUIState}function l(e,t,i){var r,n;return null===(n=null===(r=o(e,t))||void 0===r?void 0:r.dataById)||void 0===n?void 0:n[i.guid]}function c(e,t,i){var r;return null===(r=l(e,t,i))||void 0===r?void 0:r.processNavigationBehavior}function u(e,t,i,s){const o=Object(n.a)(t,i,s);if(o){switch(o.Type){case a.a.Boolean:const n=e;return!n||"1"!==n.valueString;default:return Object(r.E)(e,t,i,s)}}return Object(r.E)(e,t,i,s)}},AuXg:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var r=i("JRRC");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function n(e,t){return Object(r.c)({id:e,activity:t.activity,availability:t.availability})}},BkgE:function(e,t,i){"use strict";i.d(t,"a",(function(){return l})),i.d(t,"b",(function(){return c}));var r=i("FZDd"),n=i("iZ7K"),a=i("BFlg"),s=i("6KW3"),o=i("LbMF");function l(e){const t=[];return{type:"grid.retrieveRelatedEntityMetadata.async",execute({dispatch:i,getState:a},s){try{const o=Object(n.h)(a(),e),l={};u(l,e),Object.keys(o.ManyToManyRelationships).forEach(t=>{const i=o.ManyToManyRelationships[t];if(i.IsValidForAdvancedFind){let t=i.Entity1LogicalName;t===e&&(t=i.Entity2LogicalName),u(l,t)}}),Object.keys(o.OneToManyRelationships).forEach(e=>{const t=o.OneToManyRelationships[e];t.IsValidForAdvancedFind&&u(l,t.ReferencingEntity,t.ReferencingAttribute)}),Object.keys(o.ManyToOneRelationships).forEach(e=>{const t=o.ManyToOneRelationships[e];t.IsValidForAdvancedFind&&(u(l,t.ReferencedEntity),u(l,t.ReferencingEntity,t.ReferencingAttribute))});const c=function(e){let t=0,i={};const r=[];for(const n of Object.keys(e))i[n]=e[n],++t>=200&&(r.push(i),t=0,i={});Object.keys(i).length>0&&r.push(i);return r}(l);for(const n of c)t.push(i(Object(r.e)(n)).catch(t=>h(e,s,t,"retrieveRelatedEntityMetadata.async","retrieveRelatedEntityMetadata")));return Promise.all(t).then(()=>{})}catch(t){return h(e,s,t,"retrieveRelatedEntityMetadata.async","retrieveRelatedEntityMetadata")}}}}function c(e){return{type:"grid.retrieveRelatedEntityRelationshipMetadata.async",execute({getState:t},i){try{let i=[];const r=t(),a=Object(n.h)(r,e),l=[];Object.keys(a.OneToManyRelationships).forEach(e=>{var t,i;const c=a.OneToManyRelationships[e];if(c.IsValidForAdvancedFind){const e=c.ReferencingEntity,a=Object(n.h)(r,e),u=Object(o.a)(r,e,c.ReferencingAttribute);if(a){const e=d(a,1===c.AssociatedMenuConfiguration.Behavior?null!==(t=c.AssociatedMenuConfiguration.Label)&&void 0!==t?t:"":null!==(i=null==u?void 0:u.DisplayName)&&void 0!==i?i:a.DisplayCollectionName),r=p(c,a.DisplayCollectionName,s.RelationshipType.OneToMany);l.push([e,r])}}}),Object.keys(a.ManyToManyRelationships).forEach(e=>{var t,i;const o=a.ManyToManyRelationships[e];if(o.IsValidForAdvancedFind){let e,c,u=!0,p=o.Entity1LogicalName,h=!0;if(p===a.EntityLogicalName?(p=o.Entity2LogicalName,o.IsCustomRelationship&&(u=2!==o.Entity2AssociatedMenuConfiguration.Behavior),c=o.Entity2AssociatedMenuConfiguration.Behavior,e=null!==(t=o.Entity2AssociatedMenuConfiguration.Label)&&void 0!==t?t:"",h=!1):(o.IsCustomRelationship&&(u=2!==o.Entity1AssociatedMenuConfiguration.Behavior),c=o.Entity1AssociatedMenuConfiguration.Behavior,e=null!==(i=o.Entity1AssociatedMenuConfiguration.Label)&&void 0!==i?i:""),u){const t=Object(n.h)(r,p);if(t){const i=d(t,1===c?e:t.DisplayCollectionName);let r;r=h?{displayName:t.DisplayCollectionName,referencedFieldName:a.PrimaryIdAttribute,referencingFieldName:t.PrimaryIdAttribute,relationshipType:s.RelationshipType.ManyToMany,isHierarchical:!1,intersectEntityName:o.IntersectEntityName,entityIntersectIdAttribute:o.Entity2IntersectAttribute,relatedEntityIntersectIdAttribute:o.Entity1IntersectAttribute}:{displayName:t.DisplayCollectionName,referencedFieldName:a.PrimaryIdAttribute,referencingFieldName:t.PrimaryIdAttribute,relationshipType:s.RelationshipType.ManyToMany,isHierarchical:!1,intersectEntityName:o.IntersectEntityName,entityIntersectIdAttribute:o.Entity1IntersectAttribute,relatedEntityIntersectIdAttribute:o.Entity2IntersectAttribute},l.push([i,r])}}if(o.Entity1LogicalName===o.Entity2LogicalName){const e=Object(n.h)(r,o.Entity2LogicalName);if(2!==o.Entity1AssociatedMenuConfiguration.Behavior){const t=d(e,1===o.Entity1AssociatedMenuConfiguration.Behavior?o.Entity1AssociatedMenuConfiguration.Label:e.DisplayCollectionName),i={displayName:e.DisplayCollectionName,referencedFieldName:a.PrimaryIdAttribute,referencingFieldName:e.PrimaryIdAttribute,relationshipType:s.RelationshipType.ManyToMany,isHierarchical:!1,intersectEntityName:o.IntersectEntityName,entityIntersectIdAttribute:o.Entity2IntersectAttribute,relatedEntityIntersectIdAttribute:o.Entity1IntersectAttribute};l.push([t,i])}}}}),Object.keys(a.ManyToOneRelationships).forEach(e=>{var t,i;const c=a.ManyToOneRelationships[e];if(c.IsValidForAdvancedFind){const e=c.ReferencedEntity,u=c.ReferencingAttribute,h=Object(n.h)(r,e),g=Object(o.a)(r,a.EntityLogicalName,u);if(h){const e=p(c,1===c.AssociatedMenuConfiguration.Behavior?null!==(t=c.AssociatedMenuConfiguration.Label)&&void 0!==t?t:"":null!==(i=null==g?void 0:g.DisplayName)&&void 0!==i?i:h.DisplayCollectionName,s.RelationshipType.ManyToOne);l.push([d(h,h.DisplayCollectionName),e])}}});return i=l.sort((e,t)=>{var i,r,n,a;if(!(null===(i=e[1])||void 0===i?void 0:i.displayName)||!(null===(r=t[1])||void 0===r?void 0:r.displayName))return 0;const s=e[1].displayName.localeCompare(t[1].displayName);return 0===s?(null===(n=e[0])||void 0===n?void 0:n.displayName)&&(null===(a=t[0])||void 0===a?void 0:a.displayName)?e[0].displayName.localeCompare(t[0].displayName):0:s}),Promise.resolve(i)}catch(t){return h(e,i,t,"retrieveRelatedEntityRelationshipMetadata.async","retrieveRelationshipMetadata")}}}}function u(e,t,i){e[t]||(e[t]=[]),i&&-1===e[t].indexOf(i)&&e[t].push(i)}function d(e,t){var i;return{metadataId:null===(i=e.Id)||void 0===i?void 0:i.guid,displayName:t,primaryIdField:e.PrimaryIdAttribute,primaryNameField:e.PrimaryNameAttribute,name:e.EntityLogicalName}}function p(e,t,i){return{displayName:t,referencingFieldName:e.ReferencingAttribute,isHierarchical:e.IsHierarchical,relationshipType:i,referencedFieldName:e.ReferencedAttribute}}function h(e,t,i,r,n){const s=[{name:a.r,value:e}];return t.EventManager.ReportComponentFailure(Object(a.X)(r,n),i,null,s),Promise.resolve(null)}},CbNq:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"c",(function(){return s})),i.d(t,"b",(function(){return o})),i.d(t,"d",(function(){return l}));var r=i("P6DH");function n(e){const t=Object(r.m)(e),i=e&&e.metadata?e.metadata.entities:null,n=[];return i?(t.forEach(e=>{if(4200!==i[e].ObjectTypeCode){const t=function(e){const t=e.DisplayName,i=e.ObjectTypeCode.toString();return{entityDisplayName:t,objectTypeCode:i}}(i[e]);n.push(t)}}),n.sort(a)):n}function a(e,t){const i=e.entityDisplayName,r=t.entityDisplayName;let n=0;return i>r?n=1:i<r&&(n=-1),n}function s(e){const t=[];for(let i=0;i<e.length;i++){const r={key:e[i].objectTypeCode,text:e[i].entityDisplayName};t.push(r)}return t}function o(e){return e?e.split(","):[]}function l(e){return e?e.map(e=>({key:e.value,text:e.text})):[]}},DU5H:function(e,t,i){"use strict";i.d(t,"a",(function(){return l})),i.d(t,"b",(function(){return c}));var r=i("i1f0"),n=i("2SCk"),a=i("q/4y"),s=i("JwRZ"),o=i("fU7K");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function l(e,t,i,a,l){const c=Object(r.E)(e,t,a,i),u=[];let d=!1;if(c&&c.customFilter)for(const e of c.customFilter)if("START_FLAG"===e.customFilter)d=!0;else if("END_FLAG"===e.customFilter)d=!1;else if(d&&(!e.entityLogicalName||l===e.entityLogicalName)){const t=Object(n.i)(Object(o.CrmHtmlDecode)(e.customFilter));if(null!==t){const e=Object(s.n)(t,null);e&&u.push(e)}}return u}function c(e,t,i,r,n){return l(e,t,i,r,n).map(e=>a.a.toLegacyFilterExpression(e).toFetchXml()||"").join("")}},DU8S:function(e,t,i){"use strict";i.d(t,"c",(function(){return l})),i.d(t,"e",(function(){return c})),i.d(t,"b",(function(){return u})),i.d(t,"a",(function(){return d})),i.d(t,"d",(function(){return p}));var r=i("2QCH"),n=i("9A3e"),a=i("VDDv"),s=i("VkXQ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const o="customcontrol.propertybag.device.isoperationavailable";function l(){return{type:o,execute:(e,t)=>new n.a(t,e).isOperationAvailable(s.c.getBarcodeValue.name),sync:!0}}function c(){return{type:o,execute:(e,t)=>new a.a(t,e).isOperationAvailable(s.h.takePicture.name),sync:!0}}function u(){return{type:o,execute:(e,t)=>new a.a(t,e).isOperationAvailable(s.h.captureVideo.name),sync:!0}}function d(){return{type:o,execute:(e,t)=>new a.a(t,e).isOperationAvailable(s.h.captureAudio.name),sync:!0}}function p(){return{type:o,execute:(e,t)=>new r.a(t,e).isOperationAvailable(s.b.openARViewer.name),sync:!0}}},E6o7:function(e,t,i){"use strict";i.d(t,"a",(function(){return s})),i.d(t,"b",(function(){return o}));var r=i("dHD5"),n=i("jAuy"),a=i("BFlg");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const s="dataset.update.fetchxml";function o(e,t,i){return{type:"dataset.update.fetchxml.async",execute({dispatch:o,getState:l},c){const u=c.TraceManager.getTracer(a.P),d=a.N+".updateFetchXMLAction";try{u.info("Updating the fetch xml for the grid."),o(function(e,t,i){const n=Object(r.z)(t),a=Object(r.w)(t);return{type:s,payload:i,meta:{pageId:e,contextKey:n,dataSetContextKey:a}}}(e,t,i));const a=Object(n.j)(i),l=[];return l.push({name:"fetchXML",value:a}),c.EventManager.ReportComponentSuccess(d,l),Promise.resolve()}catch(e){const i="Updating the fetchxml for the grid with contextKey : "+Object(r.w)(t)+" failed with the error : "+e.message;c.EventManager.ReportComponentFailure(d,Error(i))}}}}},JMHu:function(e,t,i){"use strict";i.d(t,"a",(function(){return s})),i.d(t,"f",(function(){return o})),i.d(t,"e",(function(){return c})),i.d(t,"b",(function(){return u})),i.d(t,"c",(function(){return p})),i.d(t,"d",(function(){return h}));var r=i("Z/4N"),n=i("JwRZ"),a=i("YPtO");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const s="SelectedItems";function o(e,t){const i=new a.a,r=[];if(e){const a=Object(n.B)(e,t);if(a){const e=a.getElementsByTagName("link-entity");if(!e||0===e.length)return{linkEntities:[],keys:r};for(let t=0;t<e.length;t++){const n=l(e[t]);i.addLinkedEntity(n);const a=u(n);-1===r.indexOf(a)&&r.push(a)}}}return{linkEntities:i.getLinkedEntities(),keys:r}}function l(e){if(!e)return null;const t=e.attributes,i=t.getNamedItem("alias")?t.getNamedItem("alias").value:null;return{name:t.getNamedItem("name")?t.getNamedItem("name").value:null,from:t.getNamedItem("from")?t.getNamedItem("from").value:null,to:t.getNamedItem("to")?t.getNamedItem("to").value:null,linkType:t.getNamedItem("link-type")?t.getNamedItem("link-type").value:null,alias:i}}function c(e,t){return e.name===t.name&&e.from===t.from&&e.to===t.to&&e.linkType===t.linkType&&e.alias===t.alias}function u(e){return`${e.name}: ${e.alias}: ${e.from}: ${e.to}: ${e.linkType}`}function d(e,t,i){var n;if(t){const a=Object(r.e)(e,t.CustomControlId)||Object(r.e)(e,t.Name);return null===(n=null==a?void 0:a.Properties.DataSetDefinitions)||void 0===n?void 0:n[i]}}function p(e,t,i){var r;const n=d(e,t,i);return null===(r=null==n?void 0:n.InitialDataSetFetch)||void 0===r||r}function h(e,t,i){var r;const n=d(e,t,i);return null!==(r=null==n?void 0:n.Primary)&&void 0!==r&&r}},Jpj4:function(e,t,i){"use strict";i.d(t,"a",(function(){return m})),i.d(t,"b",(function(){return f}));var r=i("SAYH"),n=i("dHD5"),a=i("BFlg"),s=i("P6DH"),o=i("LbMF"),l=i("3hnk"),c=i("NUHF"),u=i("odYE"),d=i("3/02"),p=i("Lyxw"),h=i("bT7G"),g=i("qLnS");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const m="dataset.row.properties";function f(e,t,i){return{type:"row.properties.async",execute({dispatch:c,getState:h},f){const y=f.TraceManager.getTracer(a.P),v=a.N+".RowPropertiesAction",S=Object(p.f)(h(),d.pb);try{const a=Object(n.w)(t),d=Object(s.R)(h(),t,{id:e});if(d){let p=null;const P=Object(s.S)(h(),e,t);if(P)p=P;else{const i=Object(s.U)(h(),{id:e},t);i&&i.entityLogicalName&&(p=i.entityLogicalName)}if(p){const n=Object(o.d)(h(),p),a=Object(s.z)(h(),t,e);if(n){const e=[];for(const t of Object.keys(n)){const i=n[t],r=Object(l.f)(h(),p,i.LogicalName,g.a.CanUpdate);let s=!0;S&&a&&0===a[i.LogicalName]&&(s=!1),e.push({[i.LogicalName]:{requiredLevel:i.RequiredLevel,isDisabled:!(i.IsValidForUpdate&&r&&s),notifications:{}}})}for(const t of i)if(0===d.records.filter(e=>Object.keys(e)[0]===r.a.toString(t)).length)d.records.push({[r.a.toString(t)]:e});else{const i=d.records.find(e=>Object.keys(e)[0]===r.a.toString(t))[r.a.toString(t)],n=JSON.parse(JSON.stringify(e));i&&i.forEach(e=>{const t=e[Object.keys(e)[0]];t&&Object.keys(t.notifications).length>0&&(n.find(t=>Object.keys(t)[0]===Object.keys(e)[0])[Object.keys(e)[0]].notifications=t.notifications)}),d.records.find(e=>Object.keys(e)[0]===r.a.toString(t))[r.a.toString(t)]=n}}}if(c(function(e,t,i){return{type:m,payload:i,meta:{pageId:e,dataSetContextKey:t}}}(e,a,d)),S&&p){const r=Object(o.d)(h(),p),a=Object(s.z)(h(),t,e);for(const s of i){const i=(h(),_=s,O=p,new u.a(O,_)),o=Object(n.f)(t,s,p);if(r)for(const t of Object.keys(r)){const n=r[t];a&&1===a[n.LogicalName]&&null===n.ParentPicklistLogicalName&&b(h(),c,e,i,n.LogicalName,o)}}}y.info("creating the rowproperties for {0} rows"+i.length),f.EventManager.ReportComponentSuccess(v)}return Promise.resolve()}catch(e){const t="creating the rowproperties for {0} rows"+i.length+"failed";f.EventManager.ReportComponentFailure(v,Error(t))}var _,O}}}function b(e,t,i,r,n,a){const o={},l=Object(s.T)(e,i,a),u=Object(h.e)(e,l,r,n);o[n]=u,Object.keys(o).length>0&&t(Object(c.b)(i,a,!1,o))}},JwRZ:function(e,t,i){"use strict";i.d(t,"A",(function(){return F})),i.d(t,"d",(function(){return N})),i.d(t,"b",(function(){return R})),i.d(t,"x",(function(){return k})),i.d(t,"c",(function(){return A})),i.d(t,"m",(function(){return M})),i.d(t,"r",(function(){return B})),i.d(t,"s",(function(){return V})),i.d(t,"e",(function(){return z})),i.d(t,"t",(function(){return U})),i.d(t,"p",(function(){return W})),i.d(t,"n",(function(){return q})),i.d(t,"g",(function(){return Y})),i.d(t,"f",(function(){return J})),i.d(t,"i",(function(){return $})),i.d(t,"h",(function(){return Z})),i.d(t,"o",(function(){return H})),i.d(t,"q",(function(){return Q})),i.d(t,"B",(function(){return x})),i.d(t,"u",(function(){return re})),i.d(t,"j",(function(){return ne})),i.d(t,"z",(function(){return oe})),i.d(t,"k",(function(){return ae})),i.d(t,"l",(function(){return se})),i.d(t,"v",(function(){return le})),i.d(t,"y",(function(){return ce})),i.d(t,"w",(function(){return L})),i.d(t,"a",(function(){return T}));var r=i("SAYH"),n=i("P6DH"),a=i("WPtp"),s=i("izYK"),o=i("+QYJ"),l=i("Lyxw"),c=i("3/02"),u=i("eXjw"),d=i("2ciq"),p=i("NjDY"),h=i("IqkD"),g=i("aFKs"),m=i("p/2N"),f=i("errb"),b=i("LbMF"),y=i("iZ7K"),v=i("504W"),S=i("09gH"),_=i("YxC/"),O=i("8a7L"),P=i("2SCk"),w=i("CpcI"),C=i("5ZBI"),I=i("/A0C"),E=i("jAuy"),j=i("odYE");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const D="CustomControlFramework.Selectors.CustomControlDataSetSelectors",T={operator:"and",terms:[{operator:"eq-userid",terms:[{attributeName:"ownerid"}]}]};function F(e,t,i){if(!e)return!0;if(Object.keys(e).length!==i.length)return!0;if(t)for(let e=0;e<t.length;e++){const n=t[e],a=i[e];if(n!==r.a.toString(a.identifier.id))return!0}return!1}function N(e,t){var i,n;C.a.info(D+": areRecordsUpdated started");let a=!1;const s=e;if(e){const o={};for(let e=0;e<t.length;e++){const i=t[e];o[r.a.toString(i.identifier.id)]=i}if(Object.keys(e).length!==Object.keys(o).length)a=!0;else for(let e=0;e<t.length;e++){const o=t[e],l=s[r.a.toString(o.identifier.id)];if((o&&!l||l.initialized!==o.initialized||!j.a.equals(l.identifier,o.identifier))&&(a=!0),!a&&o.fields)for(const e in o.fields){const t=o.fields[e],r=l.fields[e];(!r&&t||(null===(i=null==t?void 0:t.timestamp)||void 0===i?void 0:i.getTime())!==(null===(n=null==r?void 0:r.timestamp)||void 0===n?void 0:n.getTime()))&&(a=!0)}if(a)break}}else a=!0;return C.a.info(D+": areRecordsUpdated finished"),a}function R(e,t){C.a.info(D+": areColumnAliasMapUpdated started");const i=e;let r=!1;if(e){if(i.Columns&&!t.Columns||!i.Columns&&t.Columns)r=!0;else if(i.Columns&&t.Columns)if(i.Columns.length!==t.Columns.length)r=!0;else for(let e=0;e<t.Columns.length;e++){const n=t.Columns[e].Alias;let a=!0;for(let s=0;s<i.Columns.length;s++)if(i.Columns[s].Alias===n){i.Columns[s].Name===t.Columns[e].Name?a=!1:r=!0;break}if(r||a){r=!0;break}}}else r=!0;return C.a.info(D+": areColumnAliasMapUpdated finished"),r}function k(e,t){var i;if(C.a.info(D+": getSortedColumnsOnView started"),!e||e.initialized!==u.a.Initialized)return[];const r=x(e,t);if(r){const e=r.getElementsByTagName("order");if(!e||0===e.length)return C.a.info(D+": getSortedColumnsOnView return []"),[];if(e.length>0){const t=[];for(let r=0;r<e.length;r++){const n=e[r],a=Object(P.o)(n,"attribute");let s="";"link-entity"===(null===(i=null==n?void 0:n.parentNode)||void 0===i?void 0:i.nodeName)&&(s=n.parentNode.getAttribute("alias")?n.parentNode.getAttribute("alias")+".":"");const o=Object(P.o)(n,"descending");a&&t.push({name:s+a,sortDirection:o&&"TRUE"===o.toUpperCase()?1:0})}return C.a.info(D+": getSortedColumnsOnView finished"),t}}return C.a.info(D+": getSortedColumnsOnView finished and return []"),[]}function A(e,t){if(!e&&!t)return!0;if(!e&&t||!t&&e||e.length!==t.length)return!1;for(let i=0;i<e.length;i++){const r=e[i],n=t[i];if(r.name!==n.name||r.sortDirection!==n.sortDirection)return!1}return!0}function M(e,t,i,r=null,a){C.a.info(D+": generateDataSetColumns started");const o=[],d=Object(p.D)(e),S=Object(h.x)(e),O=Object(p.h)(e);let P=null;if(r&&r.initialized===u.a.Initialized){const t=Object(y.h)(e,r.entityLogicalName);t&&(P=t.PrimaryNameAttribute)}if(t.Type===s.a.Grid){const a=t;a.Columns&&a.Columns.forEach(t=>{if(r&&r.initialized===u.a.Initialized){const a=t.Name,s=Object(n.F)(e,r),l=s[a],c=l?l.DisplayName:"",u=a&&s&&s[a]&&s[a].Type?s[a].Type:"",d=a&&s&&s[a]&&s[a].Format?s[a].Format:"",p=Object(g.a)(u,d),h=Object.assign(Object.assign({},t),{DisplayName:c,DataType:p,Type:""===u?I.a.String:u,Format:""===d?f.a.text:d});o.push(i(h,-1,-1,l))}else o.push(i(t,-1,-1,null))});const s=o.find(e=>e.name===P);s&&(s.isPrimary=!0)}if(t.Type===s.a.Grid||t.Type===s.a.LookupSimple){if(r&&r.initialized===u.a.Initialized){const t=Object(m.d)(r);let s=0;const u=x(r,a),p=u?u.getElementsByTagName("link-entity"):null,h=Object(n.F)(e,r);if(!h)return C.a.error(D+": generateDataSetColumns, attributesByName is missing, return []",[{name:"viewDescriptor",value:Object(E.j)(r.fetchXML)},{name:"attributesOnState",value:e&&e.metadata&&e.metadata.attributes?JSON.stringify(e.metadata.attributes):null}]),[];for(const r of t){let t=r.disableSorting;const n=o.filter(e=>e.name===r.name&&e.order<0);let a,u=h[r.name];a=u&&r.labelId?Object(_.b)(e,r.labelId):u?u.DisplayName:"";let m="",y="";if(!u||0==(2&u.SourceTypeMask)&&0==(4&u.SourceTypeMask)&&0==(8&u.SourceTypeMask)||(t=!0),r.relatedEntityName){const i=Object(b.d)(e,r.relatedEntityName),n=r&&null!=r.name?r.name.split(".")[1]:null;u=null!=i&&n?i[n]:null,Object(l.f)(e,c.Vg)&&t&&u&&(u.Type===I.a.Lookup||u.Type===I.a.Customer||u.Type===I.a.Owner||u.Type===I.a.Status||u.Type===I.a.State||!Object(v.a)(u.SourceType))&&"partylist"!==u.Type&&(t=!1),a=L(e,r,h,p,i),u&&(m=u.Type?u.Type:"",y=u.Format?u.Format:"")}else m=r.name&&h[r.name]&&h[r.name].Type?h[r.name].Type:"",y=r.name&&h[r.name]&&h[r.name].Format?h[r.name].Format:"";const w=Object(g.a)(m,y),C={Alias:r.name,DisplayName:a,DataType:w,Name:r.name,Type:""===m?I.a.String:m,Format:""===y?f.a.text:y},E=i(C,s,r.width,u,r.isHidden||r.disableMetaDataBinding,r.imageProviderWebresource,r.imageProviderFunctionName,r.name===P,r.cellType,t,d,S,O,e);n&&n.length>0?n.forEach((e,t)=>{const i=e.alias;Object.assign(e,E,{alias:i}),t>0&&Object.assign(e,{order:-1})}):o.push(E),s++}}return C.a.info(D+": generateDataSetColumns finished"),o}return C.a.info(D+": generateDataSetColumns finished and return []"),[]}function x(e,t){const i=e?r.a.toString(e.viewId):"";if(i&&t[i.toUpperCase()])return t[i.toUpperCase()];const n=new DOMParser,a=e&&e.fetchXML?n.parseFromString(e.fetchXML,"text/xml"):null;return i&&a&&(t[i.toUpperCase()]=a),a}function L(e,t,i,r,n){let a="";const s=t.name.split("."),o=s.length>1?s[1]:s[0],l=n?n[o]:null;if(null!=n&&null!=l&&null!=r){let e="";for(let t=0;t<r.length;t++)r[t].getAttribute("alias")===s[0]&&(e=r[t].getAttribute("to"));const t=i[e];a=l?String.format("{0} ({1})",l.DisplayName,t?t.DisplayName:""):""}return a}function V(e,t,i,r,n){const s=[],o=Object(m.d)(r).map(e=>e.name);if(o)for(let e=0;e<o.length;e++){const t=n.fields[o[e]];s.push(Object(a.c)(t))}return s}function B(e,t,i,r,n){return Object(m.d)(r)}function z(e,t){if(!Object(o.a)(e))return!1;if(e.length!==t.length)return!0;let i=!1;for(let r=0;r<t.length;r++){const n=e[r],a=t[r];if(!n.name||Object(o.b)(n.name)||!K(n.sortDirection))return!1;n.name===a.name&&n.sortDirection===a.sortDirection||(i=!0)}return i}function U(e,t){const i=[];for(let r=0;r<e.length;r++){const n=e[r];let a;a=null==t?n.name:n.name?t[n.name]:null;const s=Object.assign(Object.assign({},n),{name:a});i.push(s)}return i}function W(e,t,i){const r={conditions:[],filterOperator:0};let n=null;if(i){n=(new DOMParser).parseFromString(i,"text/xml").getElementsByTagName("filter")}if("activitypointer"===t){const t=Object(y.a)(e);for(const e in t){const i=t[e];if(!i.IsEnabledInUnifiedInterface&&null!=i.ObjectTypeCode){const e={attributeName:"activitytypecode",conditionOperator:1,value:i.ObjectTypeCode.toString()};G(n,e)||r.conditions.push(e)}}}return r.conditions.length>0?q(r,null):null}function G(e,t){var i,r,n;if(!e||!t.attributeName||!t.conditionOperator||"string"!=typeof t.value)return!1;for(let a=0;a<e.length;a++){const s=e[a].getElementsByTagName("condition");for(let e=0;e<s.length;e++)if((null===(i=s[e].getAttribute("attribute"))||void 0===i?void 0:i.toLocaleLowerCase())===t.attributeName.toLocaleLowerCase()&&(null===(r=s[e].getAttribute("operator"))||void 0===r?void 0:r.toLocaleLowerCase())===ee(t.conditionOperator)&&(null===(n=s[e].getAttribute("value"))||void 0===n?void 0:n.toLocaleLowerCase())===t.value.toLocaleLowerCase())return!0}return!1}function q(e,t){if(C.a.info(D+": generateIExpression started"),Object(v.a)(e.filterOperator)&&(e.filterOperator=0),!(e&&(e.conditions&&0!==e.conditions.length||e.filters&&0!==e.filters.length)))return null;const i=function(e){switch(e){case 0:return"and";case 1:return"or"}return"none"}(e.filterOperator);!function(e){switch(e){case"and":case"or":break;default:throw new TypeError}}(i);const r=[];if(e.conditions&&e.conditions.length>0)for(let i=0;i<e.conditions.length;i++){const n=e.conditions[i];X(n);const a=ee(n.conditionOperator);let s,o,l,c,u,d;if(te(a),s=null===t?n.attributeName:ie(n.attributeName,t),Object(v.a)(n.value))l={etn:null,attributeName:s},u={entityName:n.entityAliasName},o=[],o.push(l),o.push(u),d={operator:a,terms:o},r.push(d);else{l={etn:null,attributeName:s};c={value:"number"==typeof n.value?n.value.toString(10):n.value},u={entityName:n.entityAliasName},o=[],o.push(l),o.push(c),o.push(u),d={operator:a,terms:o},r.push(d)}}if(e.filters&&e.filters.length>0)for(let i=0;i<e.filters.length;i++){const n=q(e.filters[i],t);n&&r.push(n)}return e.conditions||e.filters?(C.a.info(D+": generateIExpression finished"),{hint:e.hint,operator:i,terms:r}):(C.a.info(D+": generateIExpression finished and return null"),null)}const H=(e,t,i,r,n,a,s,o,l,c,u,p,h,g)=>{let m=function(e){if(!e)return{LogicalName:null,Type:null,type:null,DisplayName:null,IsSecured:null,RequiredLevel:null,MaxLength:null,maxLength:null,MinValue:null,minValue:null,MaxValue:null,maxValue:null,Precision:null,precision:null,Format:null,format:null,Behavior:null,behavior:null,DefaultValue:null,defaultValue:null,Targets:null,targets:null,ImeMode:null,imeMode:null,SourceType:null,sourceType:null,Options:null,options:null,ParentPicklistLogicalName:null,parentPicklistLogicalName:null,ChildPicklistLogicalNames:null,childPicklistLogicalNames:null};let t=null;return e.Behavior&&(t=e.Behavior.toString()),{LogicalName:e.LogicalName,Type:e.Type,type:e.Type,DisplayName:e.DisplayName,IsSecured:e.IsSecured,RequiredLevel:e.RequiredLevel,MaxLength:e.MaxLength,maxLength:e.MaxLength,MinValue:e.MinValue,minValue:e.MinValue,MaxValue:e.MaxValue,maxValue:e.MaxValue,Precision:e.Precision,precision:e.Precision,Format:e.Format,format:e.Format,Behavior:t,behavior:t,DefaultValue:e.DefaultValue,defaultValue:e.DefaultValue,Targets:e.Targets,targets:e.Targets,ImeMode:e.ImeMode,imeMode:e.ImeMode,SourceType:e.SourceType,sourceType:e.SourceType,Options:e.OptionSet,options:e.OptionSet,ParentPicklistLogicalName:e.ParentPicklistLogicalName,parentPicklistLogicalName:e.ParentPicklistLogicalName,ChildPicklistLogicalNames:e.ChildPicklistLogicalNames,childPicklistLogicalNames:e.ChildPicklistLogicalNames}}(r);return u&&p&&h&&(m=Object(d.d)(m,u,p,e.DataType,h,null,g,null,null)),{name:e.Name,displayName:e.DisplayName,dataType:e.DataType,alias:e.Alias,order:t,visualSizeFactor:i,attributes:m,isHidden:n,imageProviderWebresource:a,imageProviderFunctionName:s,isPrimary:o,cellType:l,disableSorting:c}},Q=(e,t,i,r,n,a,s,o,l,c,u,d,p,h)=>({name:e.Name,displayName:e.DisplayName,dataType:e.DataType,alias:e.Alias,order:t,visualSizeFactor:i,isHidden:n,imageProviderWebresource:a,imageProviderFunctionName:s,isPrimary:o,cellType:l,disableSorting:c});function K(e){return 0===e||1===e}function X(e){if(e.attributeName&&e.value&&(null===e.conditionOperator||"number"!=typeof e.conditionOperator))throw C.a.error(D+": checkIfConditionExpressionHasInvalidArguments, condition Operator in ConditionExpression is missing"),TypeError("Condition Operator in ConditionExpression is missing");if(e.conditionOperator&&e.value&&!e.attributeName)throw C.a.error(D+": checkIfConditionExpressionHasInvalidArguments, attributeName in ConditionExpression is missing"),TypeError("AttributeName in ConditionExpression is missing")}function Y(e,t,i){return i.filter(i=>{const r=e.getFormattedValue(i),n=t.getFormattedValue(i);return!(!r&&!n)&&r!==n})}function J(e,t,i){return i.filter(i=>e[i].isValid&&!t.isValid(i)||!e[i].isValid&&t.isValid(i))}function $(e,t,i,r,n){return n.filter(n=>i[n].requiredLevel!==t.getRecordFieldRequiredLevel(e,r,n))}function Z(e,t,i,r,n){return n.filter(n=>i[n].isEditable!==t.getRecordFieldIsEditable(e,r,n))}function ee(e){switch(e){case 0:return"eq";case 1:return"ne";case 4:return"ge";case 2:return"gt";case 5:return"le";case 3:return"lt";case 25:return"on";case 26:return"on-or-before";case 27:return"on-or-after";case 6:return"like";case 7:return"not-like";case 8:return"in";case 9:return"not-in";case 10:return"between";case 11:return"not-between";case 12:return"null";case 13:return"not-null";case 14:return"yesterday";case 15:return"today";case 16:return"tomorrow";case 17:return"last-seven-days";case 18:return"next-seven-days";case 19:return"last-week";case 20:return"this-week";case 21:return"next-week";case 22:return"last-month";case 23:return"this-month";case 24:return"next-month";case 28:return"last-year";case 29:return"this-year";case 30:return"next-year";case 31:return"last-x-hours";case 32:return"next-x-hours";case 33:return"last-x-days";case 34:return"next-x-days";case 35:return"last-x-weeks";case 36:return"next-x-weeks";case 39:return"last-x-years";case 40:return"next-x-years";case 37:return"last-x-months";case 38:return"next-x-months";case 8:return"in";case 49:return"like";case 58:return"this-fiscal-year";case 59:return"this-fiscal-period";case 60:return"next-fiscal-year";case 61:return"next-fiscal-period";case 62:return"last-fiscal-year";case 63:return"last-fiscal-period";case 64:return"last-x-fiscal-years";case 65:return"last-x-fiscal-periods";case 66:return"next-x-fiscal-years";case 67:return"next-x-fiscal-periods";case 68:return"in-fiscal-year";case 69:return"in-fiscal-period";case 70:return"in-fiscal-period-and-year";case 71:return"in-or-before-fiscal-period-and-year";case 72:return"in-or-after-fiscal-period-and-year";case 75:return"above";case 76:return"under";case 77:return"not-under";case 78:return"eq-or-above";case 79:return"eq-or-under";case 87:return"contain-values";case 53:return"olderthan-x-months";case 82:return"olderthan-x-years";case 83:return"olderthan-x-weeks";case 84:return"olderthan-x-days";case 85:return"olderthan-x-hours";case 86:return"olderthan-x-minutes";case 54:return"begins-with";case 56:return"ends-with";case 55:return"not-begin-with";case 57:return"not-end-with";case 51:return"eq-userlanguage";case 41:return"eq-userid";case 42:return"ne-userid";case 43:return"eq-businessid";case 44:return"ne-businessid";case 73:return"eq-userteams";case 74:return"eq-useroruserteams";case 80:return"eq-useroruserhierarchy";case 81:return"eq-useroruserhierarchyandteams";case 88:return"not-contain-values"}return""}function te(e){switch(e){case"eq":case"ne":case"neq":case"ge":case"gt":case"le":case"lt":case"on":case"on-or-before":case"on-or-after":case"like":case"not-like":case"in":case"not-in":case"between":case"not-between":case"null":case"not-null":case"yesterday":case"today":case"tomorrow":case"last-seven-days":case"next-seven-days":case"last-week":case"this-week":case"next-week":case"last-month":case"this-month":case"next-month":case"last-year":case"this-year":case"next-year":case"last-x-hours":case"next-x-hours":case"last-x-days":case"next-x-days":case"last-x-weeks":case"next-x-weeks":case"last-x-months":case"next-x-months":case"last-x-years":case"next-x-years":case"this-fiscal-year":case"this-fiscal-period":case"next-fiscal-year":case"next-fiscal-period":case"last-fiscal-year":case"last-fiscal-period":case"last-x-fiscal-years":case"last-x-fiscal-periods":case"next-x-fiscal-years":case"next-x-fiscal-periods":case"in-fiscal-year":case"in-fiscal-period":case"in-fiscal-period-and-year":case"in-or-before-fiscal-period-and-year":case"in-or-after-fiscal-period-and-year":case"above":case"under":case"not-under":case"eq-or-above":case"eq-or-under":case"olderthan-x-months":case"olderthan-x-years":case"olderthan-x-weeks":case"olderthan-x-days":case"olderthan-x-hours":case"olderthan-x-minutes":case"contain-values":case"begins-with":case"ends-with":case"not-begin-with":case"not-end-with":case"not-contain-values":case"eq-userid":case"ne-userid":case"eq-businessid":case"ne-businessid":case"eq-userlanguage":case"eq-userteams":case"eq-useroruserteams":case"eq-useroruserhierarchy":case"eq-useroruserhierarchyandteams":break;default:throw C.a.error(D+": checkConditionOperatorIsValid, invalid condition operator"),TypeError("Invalid condition operator")}}function ie(e,t){return t&&t.hasOwnProperty(e)?t[e]:e}function re(){return[].concat(S.o).concat(w.g)}function ne(e){return e?(e instanceof Array||(e=[e]),e.forEach(e=>{Object.assign(e,{entityType:e.TypeName,id:e.Id?e.Id.toString():null,name:e.Name})}),e):[]}function ae(e){const t=[];if(!e)return t;const i=e.get_entities();return i?(i.forEach(e=>{const i=e.getValue("partyid");if(i)t.push(new O.a(i.TypeName,i.Id?i.Id.toString():null,i.Name));else{const i=e.getValue("addressused");i&&t.push(new O.a("unresolvedaddress",r.a.EMPTY.guid,i))}}),t):t}function se(e){const t=[];return e?(e instanceof Array||(e=[e]),e.forEach(e=>{if(e.fields.partyid){const i=e.fields.partyid.reference;i&&t.push(new O.a(i.etn,i.id?i.id.guid:null,i.name))}else e.fields.addressused&&t.push(new O.a("unresolvedaddress",r.a.EMPTY.guid,e.fields.addressused.value))}),t):[]}function oe(e,t,i){const r=Object(b.k)(e,t,i);if(!r)return!1;for(let e=0;e<i.length;e++)if(!r[i[e]])return!1;return!0}function le(e){if(e&&e.descriptor&&e.descriptor.Id){const t=e.descriptor.Id;return t.indexOf(".fieldControl")===t.length-".fieldControl".length?t.substring(0,t.length-".fieldControl".length):t}return null}function ce(e,t){return!(Object(v.a)(e)||Object(v.a)(t)||Object(v.a)(e.Columns)===Object(v.a)(t.Columns)&&(Object(v.a)(t.Columns)||e.Columns.length===t.Columns.length))}},K0PS:function(e,t,i){"use strict";i.d(t,"b",(function(){return a})),i.d(t,"a",(function(){return s})),i.d(t,"c",(function(){return o}));var r=i("dHD5"),n=i("BFlg");const a="chart.location.update",s="isChartOnTheRightSide";function o(e,t,i){return{type:"chart.location.update.async",execute({dispatch:o,getState:l},c){const u=c.TraceManager.getTracer(n.P),d=n.N+".updateChartLocationAction";try{u.info(`Moving Chart to ${e?"left":"right"} of the grid`),i||(i=Object(r.l)(l(),t));const n=Object(r.w)(i);return o(function(e,t,i){return{type:a,payload:{name:s,value:i},meta:{pageId:e,dataSetContextKey:t}}}(t,n,!e)),Promise.resolve()}catch(t){const i=`Moving Chart to ${e?"left":"right"} of the grid failed with error: ${t.message}`;c.EventManager.ReportComponentFailure(d,Error(i))}}}}},K3gL:function(e,t,i){"use strict";i.d(t,"b",(function(){return s})),i.d(t,"a",(function(){return o}));var r=i("yzZr"),n=i("YxC/"),a=i("ngeo");function s(){let e=null;const t=Object(n.h)();return function(i,n){let a=r.nb;const s=n&&function(e){const t=[];for(const i in e){const r=o(e[i].errorCode);r&&-1===t.indexOf(r)&&t.push(r)}return t}(n);s&&s.length>0&&(a=[...r.nb,...s]);const l=t(i,a);return e!==l&&(e=l),e}}function o(e){return 0===e?null:"Error_Message_0x"+a.a.getHexErrorCodeFromInt(e)}},KCGk:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));class r{updateConfiguration(e,t){var i,r,n,a;null!==(null==e?void 0:e.DisableMru)&&void 0!==(null==e?void 0:e.DisableMru)?this._disableMru="true"===e.DisableMru.toString():this._disableMru="true"===(null===(i=null==t?void 0:t.Parameters)||void 0===i?void 0:i.DisableMru),(null===(r=null==t?void 0:t.Parameters)||void 0===r?void 0:r.IsInlineNewEnabled)?this._disableInlineNewButton="false"===t.Parameters.IsInlineNewEnabled:this._disableInlineNewButton=!1,(null===(n=null==t?void 0:t.Parameters)||void 0===n?void 0:n.useMainFormDialogForCreate)?this._useMainFormDialogForCreate="true"===t.Parameters.useMainFormDialogForCreate:this._useMainFormDialogForCreate=!!(null==e?void 0:e.UseMainFormDialogForCreate),(null===(a=null==t?void 0:t.Parameters)||void 0===a?void 0:a.useMainFormDialogForEdit)?this._useMainFormDialogForEdit="true"===t.Parameters.useMainFormDialogForEdit:this._useMainFormDialogForEdit=!!(null==e?void 0:e.UseMainFormDialogForEdit)}getLookupConfiguration(){return this._memoizedLookupConfiguration&&this._memoizedLookupConfiguration.isMruDisabled===this._disableMru&&this._memoizedLookupConfiguration.isInlineNewButtonDisabled===this._disableInlineNewButton&&this._memoizedLookupConfiguration.useMainFormDialogForCreate===this._useMainFormDialogForCreate&&this._memoizedLookupConfiguration.useMainFormDialogForEdit===this._useMainFormDialogForEdit||(this._memoizedLookupConfiguration={isMruDisabled:this._disableMru,isInlineNewButtonDisabled:this._disableInlineNewButton,useMainFormDialogForCreate:this._useMainFormDialogForCreate,useMainFormDialogForEdit:this._useMainFormDialogForEdit}),this._memoizedLookupConfiguration}}},KVHF:function(e,t,i){"use strict";i.d(t,"a",(function(){return E}));var r=i("7fV9"),n=i("w10E"),a=i("KCGk"),s=i("j9v9"),o=i("5ipV"),l=i("izYK"),c=i("SAYH"),u=i("KBcj"),d=i("d0w6"),p=i("Uv1Y"),h=i("eXjw"),g=i("Xi8U"),m=i("5ZBI"),f=i("pGYJ"),b=i("JwRZ"),y=i("R5Qn"),v=i("Znul"),S=i("u2Wk"),_=i("F3eT"),O=i("2ciq"),P=i("DU5H"),w=i("LbMF"),C=i("YxC/");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const I={type:l.a.LookupSimple,raw:void 0,error:!1,errorMessage:void 0,security:null};class E extends r.a{constructor(e,t,i){super(e,null,t),this._dataSetWrappers={},this._dataSetParameters={},this._viewSelectorItemsByTypeById={},this._previousAvailableViewIds=null,this._previousAvailableViews=null,this._selectedViewName=null,this._previousLookupParameter=null,this._lookupConfigurationWrapper=null,this._lookupMruWrapper=null,this._requireRefresh=!1,this._views={},this.lookupMetaDataRequestOnce=!1,this._lookupMruWrapper=new n.a,this._lookupConfigurationWrapper=new a.a,this._requireRefresh=i,this.dataSetClass=2}getLatestData(){return this._previousLookupParameter}getLatestFieldData(){return this._previousFieldData}retrieveCurrentView(e,t){if(null!==this._previousAvailableViews&&null!==this._selectedViewName)for(let e=0,t=this._previousAvailableViews.length;e<t;e++)if(this._previousAvailableViews[e]&&this._previousAvailableViews[e].title===this._selectedViewName)return Promise.resolve(this._previousAvailableViews[e]);return super.retrieveCurrentView(e,t)}getRelationshipNameFromParameter(e){if(!e)return null;return e.FilterRelationshipName}retrieveDataSetObject(e,t,i,r){const n=i.Parameters[this.getPropKey()];this._pageId=t.id,this.controlId=Object(b.v)(t)||n.Value,this.pageEtn=r?r.entityTypeName:"";const a=Object(O.b)(i,this.propKey),o=this.getAttribute(i,e,this.pageEtn),l=o&&o.Targets&&o.Targets[0];if(this.targetEntity=l,o&&this._checkCustomViews(e,o),this.shouldUseLookupService(e)&&o){const t=Object(y.f)(e,this.pageEtn,a,this._pageId);if(!this._entityMetadata){const i=Object(y.c)(e,t,l);if(i){const e=i.entity;this._entityMetadata={[l]:this.convertEntityDescriptorToEntityMetadata(e)}}}}let p=!1;if(!this.isParameterOfDataSetType(n))return null;this._defaultViewId=this.getCurrentViewId(n);const h=this.previousDataSetParameter;let m=this._retrieveDataSetObjectInternal(e,t,i,r);if(!m){const t=this.getCurrentViewId(n);let i;t&&(i=Object(u.c)(e,t)),m=super.generateNewDatasetParam(!0,[],!1,null,void 0,null,{},c.a.toString(t),i?i.title:"")}const f=this.createLookupParameter(e,m,n);if(this._updateMemoizedObjectsIfNeeded(h,m,f,n,r,e),this._lookupConfigurationWrapper.updateConfiguration(n,t.descriptor),this._lookupMruWrapper.updateRecentItems(Object(g.f)(e),[m.getTargetEntityType()||l],this._lookupConfigurationWrapper.getLookupConfiguration()),Object.keys(this._viewSelectorItemsByTypeById).length>0){const n={};Object.keys(this._viewSelectorItemsByTypeById).forEach(a=>{Object.keys(this._viewSelectorItemsByTypeById[a]).forEach(o=>{if(this._views[o]=Object(u.c)(e,new c.a(o)),!this._dataSetWrappers[o]){const e=this._viewSelectorItemsByTypeById[a][o],i=e&&e.isUserView?d.b.userview:d.b.savedview;this._dataSetWrappers[o]=new s.a(a,this.propKey,this.contextToken,o,i),this._dataSetWrappers[o].updatePreviousOwnProps(t),this._dataSetParameters[o]=null}const l=this._dataSetWrappers[o];let h=l.retrieveDataSetObject(e,t,i,r);h||(h=l.generateEmptyParam()),n[o]=h,n[o]!==this._dataSetParameters[o]&&(this._dataSetParameters[o]=n[o],p=!0)})}),p&&(this._previousLookupParameter=Object.assign({},this._previousLookupParameter))}return this._previousLookupParameter}_getExtraFilters(e){let t=[];if(e){e.ExtraFilters&&(t=t.concat(e.ExtraFilters));const i=e.AdditionalTargetExtraFilters;i&&i.hasOwnProperty(this.targetEntity)&&(t=t.concat(i[this.targetEntity].slice(0)))}return t}_retrieveDataSetObjectInternal(e,t,i,r){const n=this.getPropKey();if(i&&i.Parameters&&i.Parameters[n]){const a=i.Parameters[n],s=this._getExtraFilters(a),o=Object.assign(Object.assign(Object.assign({},i.Parameters[n]),this.previousDataSetDefinition),{Type:l.a.LookupSimple,ExtraFilters:s}),c=Object.assign(Object.assign({},i),{Parameters:Object.assign(Object.assign({},i.Parameters),{[n]:o})}),u=Object.assign(Object.assign({},t),{configuration:c});return super.retrieveDataSetObject(e,u,c,r)}return super.retrieveDataSetObject(e,t,i,r)}_checkCustomViews(e,t){if(e&&e.metadata&&e.metadata.views&&t&&t.Targets){const i=[],r=[];for(const t in e.metadata.views){e.metadata.views[t].isCustomView&&r.push(t)}for(const t in r){const n=r[t];i.push({id:n,name:e.metadata.views[n].title,queryType:d.a.CUSTOM_DEFINED_VIEW,isDefault:!1,isQuickFindQuery:!1,isUserView:!1,isPinned:!1,relatedEntityName:e.metadata.views[n].entityLogicalName,isAvailableInOffline:!0})}for(const e in t.Targets){const r=t.Targets[e],n=i.filter(e=>e.relatedEntityName===r),a={};n&&n.length>0&&(n.forEach(e=>{a[e.id]=e}),this._viewSelectorItemsByTypeById[r]=Object.assign(Object.assign({},this._viewSelectorItemsByTypeById[r]),a))}}}_updateMemoizedObjectsIfNeeded(e,t,i,r,n,a){let s=!1,o=!1;const l=this._previousAvailableViewIds?this._previousAvailableViewIds.join():null;let d=null;this.previousDataSetDefinition!==r&&(this.previousDataSetDefinition=r),null!==e&&e===t||(s=!0,this.previousDataSetParameter=t);const p=n,h=p&&p.viewIds&&p.viewIds.length>0?p.viewIds.join():null;if(h&&l!==h?(s=!0,o=!0,d=p.viewIds):r.AvailableViewIds&&l!==r.AvailableViewIds&&(s=!0,o=!0,d=r.AvailableViewIds.split(",")),null===this._previousLookupParameter&&(s=!0),s?this._previousLookupParameter=i:i.error&&(this._previousLookupParameter.error=!0,this._previousLookupParameter.errorMessage=i.errorMessage,this._previousLookupParameter.errorCode=i.errorCode),o){this._previousAvailableViews=[],d.forEach(e=>{const t=Object(u.c)(a,new c.a(e));t&&this._previousAvailableViews.push(t)}),this._previousAvailableViewIds=d.map(e=>e.replace(/[\{\}]/gi,"").toLocaleLowerCase()),i.selectView=e=>{this._selectedViewName=e},i.availableViewNames=[];for(let e=0,t=this._previousAvailableViews.length;e<t;e++)this._previousAvailableViews[e]?i.availableViewNames.push(this._previousAvailableViews[e].title):i.availableViewNames.push("Unknown View")}}createLookupParameter(e,t,i){const n=new o.a(t,t.getViewId(),t.getTitle(),t.getTargetEntityType());n.allowFilterOff=!!i.AllowFilterOff,n.disableQuickFind=!!i.DisableQuickFind,n.enableViewPicker=!1!==i.EnableViewPicker,n.targetEntityType=i.TargetEntityType,n.filterRelationshipName=i.FilterRelationshipName,n.availableViewIds=i.AvailableViewIds,n.dependentAttributeName=i.DependentAttributeName,n.dependentAttributeType=i.DependentAttributeType,n.useMainFormDialogForCreate=i.UseMainFormDialogForCreate,n.useMainFormDialogForEdit=i.UseMainFormDialogForEdit,n.setRelatedFilter=this._setRelatedFilter.bind(this),n.setMyRecordsOnlyFilter=this._setMyRecordsOnlyFilter.bind(this);const a=this.relevantQueryError();if(a){if(n.error=!0,n.errorMessage=Object(C.b)(e,a.message),!n.errorMessage)return n.errorMessage=r.a.UnknownErrorMessage,n;a.parameter&&(n.errorMessage+=" "+a.parameter)}return n}_setMyRecordsOnlyFilter(e){this.setMyRecordsOnlyFilter(e),this._dataSetWrappers&&Object.keys(this._dataSetWrappers).forEach(t=>{this._dataSetWrappers[t].setMyRecordsOnlyFilter(e)})}_setRelatedFilter(e){this.setRelatedFilter(e),this._dataSetWrappers&&Object.keys(this._dataSetWrappers).forEach(t=>{this._dataSetWrappers[t].setRelatedFilter(e)})}generateEmptyLookupParam(e){const t=this.previousDataSetParameter,i=super.generateEmptyDataSetParam();if(!this._previousLookupParameter||t!==i){const t=this.getCurrentViewId(this.previousDataSetDefinition),r=c.a.toString(t),n=this.targetEntity;this._previousLookupParameter=this.extendByFieldData(new o.a(i,r,"",n),e)}return this._previousLookupParameter}generateEmptyParam(){return this.generateEmptyLookupParam(I)}extendByFieldData(e,t=null){const i=this.queryBuilder&&this.queryBuilder.getFirstError()&&this._previousLookupParameter&&this._previousLookupParameter.error,r=i?this._previousLookupParameter.errorMessage:"";return null!==t&&this._previousFieldData!==t?(this._previousFieldData=t,this._previousLookupParameter=Object.assign(Object.assign({},e),this._previousFieldData)):this._previousLookupParameter=Object.assign(e,this._previousFieldData),i&&(this._previousLookupParameter.error=i,this._previousLookupParameter.errorMessage=r),this._previousLookupParameter}linkToParameter(e,t){super.linkToParameter(e,t),e.getRecentItems=this._lookupMruWrapper.getRecentItems.bind(this._lookupMruWrapper,{entityTypeNames:[e.getTargetEntityType()]}),e.getLookupConfiguration=this._lookupConfigurationWrapper.getLookupConfiguration.bind(this._lookupConfigurationWrapper),e.getAllViews=this.getAllViews.bind(this,{retrieveViewAction:t.retrieveViewAction,retrieveViewSelectorAction:t.retrieveViewSelectorAction}),e.getDefaultViewId=this.getDefaultViewId.bind(this),e.getDataSetParameter=this._getDataSetParameter.bind(this),this._dataSetWrappers&&Object.keys(this._dataSetWrappers).forEach(e=>{this._dataSetWrappers[e].linkToParameter(this._dataSetParameters[e],t)}),e.generateAdditionalAttributes=this.ensureLookupMetaDataInitialization.bind(this,{retrieveLookupMetadataAction:t.retrieveLookupMetadataAction,refreshDataSetParameter:t.refreshDataSetParameter},!0),e.sendLookupRequest=this.searchLookup.bind(this,t),e.runPreSearch=()=>{this.contextToken&&t.runPreSearch(this.contextToken,this.controlId,this._pageId)},e.usePresenceStatus=this.usePresenceStatus.bind(this,t.usePresenceStatus),e.useProfilePhoto=this.useProfilePhoto.bind(this,t.useProfilePhoto),e.executeNotifyHandlersThatEventOccurred=this._executeNotifyHandlersThatEventOccurred.bind(this,t)}getDefaultViewId(e){return this._defaultViewId&&this._defaultViewId.guid}getAllViews(e,t,i){const r=t;let n=[];if(!i){const t=e.retrieveViewAction(r,d.a.MAIN_APPLICATION_VIEW,d.b.savedview),i=e.retrieveViewAction(r,d.a.LOOKUP_VIEW,d.b.savedview);n=n.concat([t,i])}const a=this._previousAvailableViewIds?this._previousAvailableViewIds:[];for(let t=0;t<a.length;t++)this._previousAvailableViews&&0!==this._previousAvailableViews.length&&0!==this._previousAvailableViews.filter(e=>e.viewId&&e.viewId.guid===a[t]).length||n.push(this.retrieveView(new c.a(a[t]),e.retrieveViewAction));return Promise.all(n).then(()=>{const n=[];let s=[];if(!i){const t=e.retrieveViewSelectorAction(r,d.a.LOOKUP_VIEW).then(e=>{const t=e.viewSelectors[r][d.a[d.a.LOOKUP_VIEW]];t&&(this._viewSelectorItemsByTypeById[r]=Object.assign(Object.assign({},this._viewSelectorItemsByTypeById[r]),t),Object.keys(t).forEach(e=>{(0===a.length||a.indexOf(e.toLocaleLowerCase())>-1)&&n.push({viewId:e,viewName:t[e]?t[e].name:null,isDefault:t[e]?t[e].isDefault:null,isAvailableInOffline:t[e]?t[e].isAvailableInOffline:null,isUserView:t[e]?t[e].isUserView:null,isPinned:t[e]?t[e].isPinned:null,relatedEntityName:t[e]?t[e].relatedEntityName:null})}))}),i=e.retrieveViewSelectorAction(r,d.a.MAIN_APPLICATION_VIEW).then(e=>{const t=e.viewSelectors[r][d.a[d.a.MAIN_APPLICATION_VIEW]];t&&(this._viewSelectorItemsByTypeById[r]=Object.assign(Object.assign({},this._viewSelectorItemsByTypeById[r]),t),Object.keys(t).forEach(e=>{(0===a.length||a.indexOf(e.toLocaleLowerCase())>-1)&&n.push({viewId:e,viewName:t[e]?t[e].name:null,isDefault:!1,isAvailableInOffline:t[e]?t[e].isAvailableInOffline:null,isUserView:t[e]?t[e].isUserView:null,isPinned:t[e]?t[e].isPinned:null,relatedEntityName:t[e]?t[e].relatedEntityName:null})}))});s=s.concat([t,i])}const o=new Promise(e=>{for(const e in this._viewSelectorItemsByTypeById[t]){const i=this._viewSelectorItemsByTypeById[t][e];i.queryType===d.a.CUSTOM_DEFINED_VIEW&&n.push({viewId:e,viewName:i.name,isDefault:i.isDefault,isAvailableInOffline:i.isAvailableInOffline,isUserView:i.isUserView,isPinned:i.isPinned,relatedEntityName:i.relatedEntityName})}e()});return s.push(o),Promise.all(s).then(()=>n)})}retrieveView(e,t){let i;return this.previousDataSetDefinition&&this.previousDataSetDefinition.TargetEntityType?i=this.previousDataSetDefinition.TargetEntityType:this.previousDataSetDefinition&&this.previousDataSetDefinition.EntityName?i=this.previousDataSetDefinition.EntityName:this._previousFieldData&&this._previousFieldData.attributes&&this._previousFieldData.attributes.Targets&&this._previousFieldData.attributes.Targets.length>0?i=this._previousFieldData.attributes.Targets[0]:this._previousFieldData&&this._previousFieldData.attributes&&this._previousFieldData.attributes.EntityLogicalName&&(i=this._previousFieldData.attributes.EntityLogicalName),i?e||this._viewId?t(i,d.a.LOOKUP_VIEW,d.b.savedview,e||this._viewId):t(i,d.a.LOOKUP_VIEW,d.b.savedview).then(e=>(this._viewId=e,e)).then(e=>e):(m.a.error(f.a+": retrieveView encountered error, Entity name is not specified for lookup",[{name:"APIName",value:f.a+".Models.Lookups.LookupSimpleObjectWrapper.retrieveView"}]),Promise.reject(new p.a("Entity name is not specified for lookup")))}getParameterManifestType(){return l.a.LookupSimple}refreshDataSet(e,t,i){let r=null;const n=this.getEntityTypeName()||this.targetEntity;try{t.startCustomFilter(this._pageId,this.controlId,this.contextToken),t.runPreSearch(this._pageId,this.controlId),t.runSetAdditionalParams(this._pageId,this.controlId),t.endCustomFilter(this._pageId,this.controlId,this.contextToken)}catch(e){}if(this.lookupCustomFilters=Object(P.a)(e(),this._pageId,this.contextToken,this.controlId,n),this.meFilterEnabled&&(Object(w.a)(e(),n,"ownerid")?this.lookupCustomFilters.push(b.a):r=t.getEntityMetadataAction(n,["ownerid"])),this.shouldUseQuickFindViewForLookup(e())){const e=this.filteringObj&&this.filteringObj.getFilter();this.lookupFilterString=e&&e.conditions&&e.conditions[0]&&e.conditions[0].value,this.lookupFilterString=this.lookupFilterString&&this.lookupFilterString.replace(/%$/g,"").replace(/\%/g,"*")}return this.meFilterEnabled&&r?r.then(()=>(Object(w.a)(e(),n,"ownerid")&&this.lookupCustomFilters.push(b.a),super.refreshDataSet(e,t,i))):super.refreshDataSet(e,t,i)}setErrorStatus(e,t){let i=e;const n=this.relevantQueryError();n&&t&&"function"==typeof t&&(i=Object(C.b)(t(),n.message),i?n.parameter&&(i+=" "+n.parameter):i=r.a.UnknownErrorMessage),super.setErrorStatus(i,t)}isParameterOfDataSetType(e){return!!e&&e.Type===this.getParameterManifestType()}retrieveLookupMetadata(e,t){return this.lookupMetaDataRequestOnce=!0,this.retrieveCurrentViewAndAssoicatedAttributes(e,t)}ensureLookupMetaDataInitialization(e){this.previousInitState!==h.a.Uninitialized||this.lookupMetaDataRequestOnce||this.shouldUseLookupService()||e.retrieveLookupMetadataAction(this).then(()=>{this._requireRefresh&&(this._requireRefresh=!1,e.refreshDataSetParameter(this,this.contextToken))})}_executeNotifyHandlersThatEventOccurred(e,t,i){return this.contextToken?e.executeNotifyHandlersThatEventOccurred({contextToken:this.contextToken,fieldName:this.controlId,pageId:this._pageId,record:i,eventName:t}):Promise.resolve(!1)}_getDataSetParameter(e,t){return this._dataSetParameters[t]}convertEntityDescriptorToEntityMetadata(e){return{IsReadOnlyInMobileClient:e.IsReadOnlyInMobileClient,IsEnabledInUnifiedInterface:e.IsEnabledInUnifiedInterface,DisplayName:e.DisplayName,PrimaryNameAttribute:e.PrimaryNameAttribute,LogicalName:e.EntityLogicalName,DisplayCollectionName:e.DisplayCollectionName,IconVectorName:e.IconVectorName,ObjectTypeCode:e.ObjectTypeCode,Attributes:null}}searchLookup(e,t,i,r,n,a){const s=new _.a(this.pagingObj.getPageLastIndex()+(r&&this.pagingObj.getHasNextPage()?1:0),this.pagingObj.getPageSize(),!0,null);this._viewId=t?new c.a(t):this._defaultViewId,a||(a=this.getRelationshipNameFromParameter(this.previousDataSetDefinition));const o=new S.a(this.targetEntity,this._viewId,n,a,null,null,s);if(r){if(!this.pagingObj.getHasNextPage())return Promise.resolve(null);this.pagingObj.setPageLastIndex(this.pagingObj.getPageLastIndex()+1)}const l=new v.a([o],null,null,null,i,!0);this.getLatestData().loading=!0,this.setRefreshingStart();const u=Object(O.b)(this.previousOwnProps.configuration,this.propKey);return e.sendLookupRequest(l,this.contextToken,this._pageId,this.pageEtn,this.controlId,u,this.previousDataSetDefinition.DependentAttributeName).then(()=>{this.updateRefreshStatusToRequestBack()}).catch(e=>{const t="Lookup Data Request encounters an exception";throw this.setErrorStatus(t),m.a.error(f.a+": "+t,[{name:"APIName",value:f.a+".Models.Lookups.LookupSimpleObjectWrapper.searchLookup"},{name:"error.Stack",value:JSON.stringify(e.stack)},{name:"controlId",value:this.controlId},{name:"entityTypeName",value:this.pageEtn}]),new p.a(t)})}}},MuBJ:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var r=i("K7RF"),n=i("Uv1Y"),a=i("x/aW"),s=i("iJGp"),o=i("/oKV");function l(){return{type:"usermetadataversion.retrieve.async",execute:({dispatch:e,getState:t},i)=>e(Object(r.b)(a.a.UserMetadataVersion,null,null,null,!1,s.a.OnDemandWithoutContext,null,null,[],null,o.a.Remote)).catch(n.b)}}},NYBK:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var r=i("KBcj"),n=i("LbMF"),a=i("d0w6"),s=i("SAYH"),o=i("g03H"),l=i("Z+6x"),c=i("BFlg");class u{constructor(e,t,i){this._dataSetWrapper=null,this._dataSetHostOwnProps=null,this._dataSetPageInfo=null,this._memoizedDataSetColumnLookupOwnProps=null,this._memoizedDataSetColumnLookupConfiguration=null,this._columnName=e,this._contextToken=t,this._dataSetPageInfo=i}setParentRecordContext(e){this._parentRecordContext=e,this._getDataSetWrapper()&&this._getDataSetWrapper().setLookupDataSetAttributes(!0,e)}updateParameterConfiguration(e,t,i,l){if(this._dataSetHostOwnProps=t,i&&(this._dataSetPageInfo=i),!this._memoizedDataSetColumnLookupConfiguration){const t=Object(n.a)(e,l.getTargetEntityType(),this._columnName);let i;if(t&&t.Targets&&t.Targets.length)i=t.Targets[0];else if(l&&l.columns){let e=l.columns[this._columnName];e||(e=l.columns.find(e=>e.name===this._columnName)),e&&e.attributes&&e.attributes.Targets&&e.attributes.Targets.length&&(i=e.attributes.Targets[0])}l&&l.getTargetEntityType&&l.getTargetEntityType()&&"connection"===l.getTargetEntityType().toLowerCase()&&"record2id"===this._columnName&&(l&&l.getViewId&&l.getViewId()&&"4E3600FA-B9C8-49F4-B69A-51EBA06D9BDF"===l.getViewId().toUpperCase()?i="contact":l&&l.getViewId&&l.getViewId()&&"FE4BC089-8901-466C-A41B-1C1090F204D4"===l.getViewId().toUpperCase()&&(i="systemuser"));let u=Object(r.a)(e,i,a.a.LOOKUP_VIEW),d=!1,p=null,h=null,g=null;const m=this._dataSetHostOwnProps.configuration.Parameters.hasOwnProperty(c.l),f=this._dataSetHostOwnProps.configuration.Parameters.hasOwnProperty(c.m);if(this._dataSetHostOwnProps&&this._dataSetHostOwnProps.configuration&&this._dataSetHostOwnProps.configuration.Parameters&&(m||f)){const e=this._dataSetHostOwnProps.configuration.Parameters[m?c.l:c.m].Lookups;if(null!=e)for(const t in e){if(t.split(".").indexOf(this._columnName)>-1){const i=t.split("."),r=i&&i.length>0&&i[0];if(l&&l.getViewId&&l.getViewId()&&s.a.equals(new s.a(l.getViewId()),new s.a(r))){const i=e[t];u=new s.a(i.DefaultViewId),d=i.AllowFilterOff,g=i.RelationshipName,p=i.DependentAttributeName,h=i.DependentAttributeType}}}}this._memoizedDataSetColumnLookupConfiguration=Object(o.o)(this._dataSetHostOwnProps.configuration.CustomControlId,this._dataSetHostOwnProps.configuration.FormFactor,s.a.toString(u),i,"columnLookup",d,g,h,p)}if(this._memoizedDataSetColumnLookupConfiguration.Parameters.hasOwnProperty("columnLookup")){const e=this._memoizedDataSetColumnLookupConfiguration.Parameters.columnLookup;if(e&&null!=e.AllowFilterOff){l.filtering.canDisableRelationshipFilter=()=>"true"===e.AllowFilterOff.toString();const t=l.filtering;t.enableRelationshipFilter=e=>{this._dataSetWrapper.setLookupDataSetAttributes(!0,this._parentRecordContext)},t.disableRelationshipFilter=()=>{this._dataSetWrapper.setLookupDataSetAttributes(!1,this._parentRecordContext)}}}this._memoizedDataSetColumnLookupOwnProps||(this._memoizedDataSetColumnLookupOwnProps=Object.assign(Object.assign({},this._dataSetHostOwnProps),{configuration:this._memoizedDataSetColumnLookupConfiguration}))}_getDataSetWrapper(){if(!this._dataSetWrapper){const e=this._memoizedDataSetColumnLookupConfiguration.Parameters.columnLookup;this._dataSetWrapper=new l.a("columnLookup",e,this._contextToken)}return this._dataSetWrapper}ensureViewInitialization(e){const t=this._memoizedDataSetColumnLookupConfiguration.Parameters.columnLookup;if(!t.ViewId){return e(t.TargetEntityType,a.a.LOOKUP_VIEW,a.b.savedview).then(e=>(t.ViewId=s.a.toString(e),t.ViewId))}return Promise.resolve(t.ViewId)}retrieveDataSetObject(e,t,i){this.updateParameterConfiguration(e,this._dataSetHostOwnProps,this._dataSetPageInfo,t);const r=this._getDataSetWrapper(),n=r.retrieveDataSetObject(e,this._memoizedDataSetColumnLookupOwnProps,this._memoizedDataSetColumnLookupConfiguration,this._dataSetPageInfo,i);n.filtering.canDisableRelationshipFilter=t.filtering.canDisableRelationshipFilter;const a=n.filtering;return a.disableRelationshipFilter=t.filtering.disableRelationshipFilter,a.enableRelationshipFilter=t.filtering.enableRelationshipFilter,r.updateControlMemoizedParameter(e,n,!1,null),n}setWrapperLoadingFlag(e){this._getDataSetWrapper().setWrapperLoadingFlag(!0)}linkToParameter(e,t){const i=e.filtering;e&&e.getTargetEntityType&&e.getTargetEntityType()&&"connectionrole"===e.getTargetEntityType().toLowerCase()&&"record2roleid"===this._columnName&&this._addConnectionFilters(i),this._dataSetWrapper.linkToParameter(e,t),e.refresh=()=>{t.retrieveDataSetLookupCellParameter(e,this,this._contextToken)}}getLatestData(){return this._dataSetWrapper?this._dataSetWrapper.getLatestData():null}resetControlLockedDataSet(){this._dataSetWrapper&&this._dataSetWrapper.resetControlMemoizedDataSet()}refreshDataSet(e,t,i){const r=this._getDataSetWrapper();return this.ensureViewInitialization(t.retrieveViewAction).then(n=>r.refreshDataSet(e,t,i))}_addConnectionFilters(e){if(this._dataSetHostOwnProps&&this._dataSetHostOwnProps.descriptor&&this._dataSetHostOwnProps.descriptor.Parameters&&this._dataSetHostOwnProps.descriptor.Parameters.hasOwnProperty("ViewId")){const t=s.a.toString(s.a.fromExternalGuid(this._dataSetHostOwnProps.descriptor.Parameters.ViewId)).toUpperCase();if("4E3600FA-B9C8-49F4-B69A-51EBA06D9BDF"===t||"FE4BC089-8901-466C-A41B-1C1090F204D4"===t){const i="4E3600FA-B9C8-49F4-B69A-51EBA06D9BDF"===t?"1000":"1001";e.clearFilter();const r=[],n={attributeName:"category",conditionOperator:0,value:i};r.push(n);const a={conditions:r,filterOperator:0};e.setFilter(a)}}}}},NbYl:function(e,t,i){"use strict";i.d(t,"a",(function(){return U}));var r=i("3/02"),n=i("Lyxw"),a=i("SAYH"),s=i("eXjw"),o=i("pGYJ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function l(e,t,i,r,n,a,s,o,l=null){const d={getState:t,actions:i,entityName:o,parentName:n,promiseCollection:l||[],chartDataSetObjectWrapper:r,pageId:a,contextToken:s};switch(e){case 1:return u(d);case 3:return function(e){const t=e.actions.updateChartFilterExpression(e.pageId,e.contextToken,e.chartDataSetObjectWrapper.getChartFilterExpression()),i=e.actions.updateChartDrillDownParameters(e.pageId,e.contextToken,e.chartDataSetObjectWrapper.getChartDrillDownParameters());return Promise.all([t,i]).then(()=>{let t=1;const i=e.chartDataSetObjectWrapper.getChartDrillDownParameters();i&&i.length>0&&(t=2),e.chartDataSetObjectWrapper.setRefreshMode(t)})}(d);case 2:return function(e){return c(e).then(e=>{const t=e.input,i=e.chartDataDecorator,r=e.input.actions.retreiveChartDataAction(i,t.entityName,t.pageId,!0);return t.promiseCollection.push(r),Promise.all(t.promiseCollection)})}(d);default:return u(d)}}function c(e){return e.chartDataSetObjectWrapper.ensureReadinessForChartDataRefresh(e.getState,e.actions,e.entityName).then(t=>{if(e.parentName&&"DataSetHost"===e.parentName){const i=e.actions.updateDataSetChartVisualizationId(e.pageId,e.contextToken,a.a.toString(t.visualizationId)),r=e.actions.updateDataSetChartVisualizationType(e.pageId,e.contextToken,t.visualizationType);e.promiseCollection.push(i,r)}return{input:e,chartDataDecorator:t}})}function u(e){return c(e).then(t=>{const i=t.input,r=t.chartDataDecorator,n=t.input.actions.retreiveChartDataAction(r,i.entityName,i.pageId,!0);return e.promiseCollection.push(n),Promise.all(e.promiseCollection)})}var d=i("CngE"),p=i("GEBM"),h=i("LbMF"),g=i("p/2N"),m=i("YxC/"),f=i("69Qu"),b=i("37s6"),y=i("KBcj"),v=i("3mEc"),S=i("JwRZ"),_=i("5ZBI"),O=i("4DTG");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class P extends O.a{constructor(e,t,i,r,n,a,s,o,l,c,u,d){super(e,t,i,r),this.getChartConfigObject=()=>n,this.getWebResourceState=()=>a,this.getChartSelectorOption=()=>s,this.getAttributesMetadata=()=>o,this.getViewAssociatedAttributesMetadata=()=>l,this.getViewSelectorOption=()=>c,this.getDefaultVisualizationId=()=>u,this.getChartExportMetadata=()=>d}getVisualizationType(){throw new Error("Not Replaced")}setVisualizationType(e){throw new Error("Not Replaced")}getVisualizationId(){throw new Error("Not Replaced")}setVisualizationId(e){throw new Error("Not Replaced")}getViewType(){throw new Error("Not Replaced")}setViewType(e){throw new Error("Not Replaced")}getViewId(){throw new Error("Not Replaced")}setViewId(e){throw new Error("Not Replaced")}getChartConfigObject(){throw new Error("Not Replaced")}getWebResourceState(){throw new Error("Not Replaced")}getChartFilterExpression(){throw new Error("Not Replaced")}setChartFilterExpression(e){throw new Error("Not Replaced")}getChartSelectorOption(){throw new Error("Not Replaced")}getViewSelectorOption(){throw new Error("Not Replaced")}getUpdateChartFilterExpression(){throw new Error("Not Replaced")}setUpdateChartFilterExpression(e){throw new Error("Not Replaced")}getAttributesMetadata(){throw new Error("Not Replaced")}getViewAssociatedAttributesMetadata(){throw new Error("Not Replaced")}setRefreshMode(e){throw new Error("Not Replaced")}getChartDrillDownParameters(){throw new Error("Not Replaced")}setChartDrillDownParameters(e){throw new Error("Not Replaced")}getDefaultVisualizationId(){throw new Error("Not Replaced")}formatNumber(e,t){throw new Error("Not Replaced")}getChartExportMetadata(){throw new Error("Not Replaced")}getIsRelatedRecord(){throw new Error("Not Replaced")}}var w=i("7fV9"),C=i("d0w6"),I=i("hwt8"),E=i("IqkD"),j=i("Xd5/"),D=i("ANW1"),T=i("fSnw"),F=i("g03H"),N=i("ngeo"),R=i("5R5s"),k=i("K3gL"),A=i("85o3"),M=i("uNu9"),x=i("+QYJ"),L=i("P6DH"),V=i("vNXc"),B=i("/Zy9");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const z=o.a+".Models.DataSet.ChartDataSetObjectWrapper.refreshDataSet";class U extends w.a{constructor(e,t){super(e,null,t),this._previousChartDataSetParameter=null,this._previousEmptyChartParameter=null,this._previousChartConfigObjectFromStateTree=null,this._previousChartConfigObjectToChartControl=null,this._previousWebResourceStateFromStateTree=null,this._previousWebResourceStateToChartControl=null,this._previousChartSelectorObjectFromStateTree=null,this._previousChartSelectorObjectToChartControl=null,this._previousViewSelectorObjectFromStateTree=null,this._previousViewSelectorObjectToChartControl=null,this._previousViewIdsToDisplayRaw=null,this._previousViewIdsToDisplay=null,this._memoizedVisualizationIdFromDataSetDefinition=null,this._currentVisualizationId=null,this._memoizedVisualizationTypeFromDataSetDefinition=null,this._currentVisualizationType=null,this._memoizedViewIdFromDataSetDefinition=null,this._currentViewId=null,this._memoizedViewTypeFromDataSetDefinition=null,this._currentViewType=null,this._memoizedChartFilterExpressionFromDataSetDefinition=null,this._currentChartFilterExpression=null,this._memoizedChartDrillDownParametersFromDataSetDefinition=null,this._memoizedDefaultFilterAndLinkedEntities=null,this._currentChartDrillDownParameters=null,this._parentName=null,this._shouldUpdateChartFilterExpression=null,this._chartDataSetRefreshMode=null,this._isChartDrillDownFeatureEnabled=null,this._cultureInfo=null,this.dataSetClass=1}getLatestData(){return this._previousChartDataSetParameter}retrieveDataSetObjectFromStorage(e,t,i,o){const l=i.Parameters.Parent;l&&(this._parentName=l.Value);const c=i.Parameters[this.getPropKey()],u=this.updatedSubParameter(o);"DataSetHost"===this._parentName&&(this.forceApplyDataSetInputReturnNone=!1);const p=this.getViewId(),m=this.getVisualizationId(),f=c.EntityName||c.TargetEntityType;if(this.getVisualizationType(),this.getViewType(),this.getChartFilterExpression(),this.getChartDrillDownParameters(),this._getUserCultureInfo(e),!p||!m)return this._generateEmptyChartDataSetParam();const b=this.previousOwnProps?this.previousOwnProps.id:null,y=Object(L.tb)(e,a.a.tryParse(p),b),v=this._retrieveChartConfigObject(e,m,p),_=this._retrieveWebResourceState(e,m),O=this._retrieveChartSelectorObject(e,f),P=this._retrieveViewSelectorObject(e,f);if(!(v||_||O||P))return this._generateEmptyChartDataSetParam();if(null!==_||null!==v?(2===this.refreshingStatus&&(this.refreshingStatus=4),this.previousInitState=s.a.Initialized):this.previousInitState===s.a.Uninitialized&&2===this.firstDataRequestType&&(this.previousInitState=s.a.Initializing),!this._previousChartDataSetParameter||v!==this._previousChartDataSetParameter.getChartConfigObject()||_!==this._previousChartDataSetParameter.getWebResourceState()||O!==this._previousChartDataSetParameter.getChartSelectorOption()||P!==this._previousChartDataSetParameter.getViewSelectorOption()||4===this.refreshingStatus){let t=!1;if(null!==v){let i;i=Object(n.f)(e,r.wg)?this._cachedChartDataDecorator?Object(d.e)(e,this._cachedChartDataDecorator.getStorageKey()):Object(d.e)(e,this.createChartDataDecorator(e).getStorageKey()):Object(d.d)(e,m,p),t=i!==s.a.Initialized}const i=Object(S.m)(e,c,S.q,y,this.viewIdDocumentDic),a=!1,o=null,l=null,u={},b=p,w="",C=v,I=_,E=O,j=Object(h.d)(e,f),D=function(e,t){const i={};if(e&&e.initialized===s.a.Initialized){Object(g.d)(e).forEach(e=>{i[e.name]={relatedEntityName:e.relatedEntityName||"",drilldownDisplayName:e.name}}),t&&t.length>0&&t.filter(e=>e.name in i).forEach(e=>{i[e.name].drilldownDisplayName=e.displayName})}return i}(y,i),T=P,F=this._getDefaultVisualizationId(e),N=this._getChartExportMetadataFromStateTree(e);null===_&&null===v||4===this.refreshingStatus&&(this.refreshingStatus=0),this._previousChartDataSetParameter=this._generateNewDataSetParam(t,i,a,o,void 0,l,u,b,w,C,I,E,j,D,T,F,N)}return u&&(this._previousChartDataSetParameter=Object.assign({},this._previousChartDataSetParameter)),this._previousChartDataSetParameter}_retrieveWebResourceState(e,t){const i=Object(d.a)(e,a.a.tryParse(t));if(null==i||a.a.isNullOrEmpty(i.WebResourceId))return null;const r=i.WebResourceId,n=Object(v.g)(e,r);if(!this._previousWebResourceStateFromStateTree||this._previousWebResourceStateFromStateTree!==n||!this._previousWebResourceStateToChartControl){this._previousWebResourceStateFromStateTree=n;let e=null;return n&&(e={name:n.name,displayName:n.displayName,id:a.a.toString(n.id),type:n.type,isEnabledForMobileClient:n.isEnabledForMobileClient}),this._previousWebResourceStateToChartControl=e,this._previousWebResourceStateToChartControl}return this._previousWebResourceStateToChartControl}_retrieveChartConfigObject(e,t,i){let a=null;if(a=Object(n.f)(e,r.wg)?this._cachedChartDataDecorator?Object(d.c)(e,this._cachedChartDataDecorator.getStorageKey()):Object(d.c)(e,this.createChartDataDecorator(e).getStorageKey()):Object(d.b)(e,t,i),!this._previousChartConfigObjectFromStateTree||this._previousChartConfigObjectFromStateTree!==a||!this._previousChartConfigObjectToChartControl){this._previousChartConfigObjectFromStateTree=a;let e=null;return a&&(e={Title:a.Title,Legend:a.Legend,Area3DStyle:a.Area3DStyle,AreaGradientStyle:a.AreaGradientStyle,XAxes:a.XAxes,YAxes:a.YAxes,SeriesList:a.SeriesList,SubTitle:a.SubTitle,Colors:a.Colors,DisplayMode:a.DisplayMode,ErrorInformation:a.ErrorInformation,EnableDrilldown:a.EnableDrilldown,Annotations:a.Annotations}),this._previousChartConfigObjectToChartControl=e,this._previousChartConfigObjectToChartControl}return this._previousChartConfigObjectToChartControl}_retrieveChartSelectorObject(e,t){const i=Object(d.i)(e,t);if(!this._previousChartSelectorObjectFromStateTree||this._previousChartSelectorObjectFromStateTree!==i||!this._previousChartSelectorObjectToChartControl){this._previousChartSelectorObjectFromStateTree=i;const e=[];if(i){const t=i.chartTypes;if(t&&Object.keys(t).length>0)for(const i in t){const r=t[i];for(const t in r){const i=r[t],n={categoryId:i.IsUserChart?"1":"0",id:a.a.toString(i.Id),value:a.a.toString(i.Id),text:i.Name};e.push(n)}}}return this._previousChartSelectorObjectToChartControl=e,this._previousChartSelectorObjectToChartControl}return this._previousChartSelectorObjectToChartControl}_retrieveViewSelectorObject(e,t){const i=this.previousDataSetDefinition;if(!i.EnableViewPicker)return null;const r=i.ViewIds;this._previousViewIdsToDisplayRaw&&this._previousViewIdsToDisplayRaw===r||(this._previousViewIdsToDisplayRaw=r,this._previousViewIdsToDisplay=r&&r.split(","),this._previousViewIdsToDisplay&&this._previousViewIdsToDisplay.length>0&&this._previousViewIdsToDisplay.forEach((e,t,i)=>{i[t]=a.a.toString(a.a.tryParse(e))}));const n=Object(y.f)(e,t,C.a.MAIN_APPLICATION_VIEW);if(n&&(!this._previousViewSelectorObjectFromStateTree||this._previousViewSelectorObjectFromStateTree!==n||!this._previousViewSelectorObjectToChartControl)){this._previousViewSelectorObjectFromStateTree=n;const e=[];if(Object.keys(n).length>0)for(const t in n){if(this._previousViewIdsToDisplay&&this._previousViewIdsToDisplay.length>0&&-1===this._previousViewIdsToDisplay.indexOf(t))continue;const i=n[t],r={categoryId:i.isUserView?"1":"0",id:t,value:t,text:i.name};e.push(r)}return this._previousViewSelectorObjectToChartControl=e,this._previousViewSelectorObjectToChartControl}return this._previousViewSelectorObjectToChartControl}generateEmptyParam(){return this._generateEmptyChartDataSetParam()}_generateEmptyChartDataSetParam(){const e=this.getViewId(),t=this.getVisualizationId();if(!this._previousEmptyChartParameter||e!==this._previousEmptyChartParameter.getViewId()||t!==this._previousEmptyChartParameter.getVisualizationId()){const i=null!==e&&null!==t;this._previousEmptyChartParameter=this._generateNewDataSetParam(i,[],!1,null,void 0,null,{},e,"",null,null,null,null,null,null,"",null)}return this._previousChartDataSetParameter=this._previousEmptyChartParameter,this._previousEmptyChartParameter}_generateNewDataSetParam(e,t,i,r,n,a,s,o,l,c,u,d,p,h,g,m,f){const b=super.generateNewDatasetParam(e,t,i,r,n,a,s,o,l),y=this.getEntityTypeName(),v=new P(b,o,l,y,c,u,d,p,h,g,m,f);return v.getVisualizationType=this.getVisualizationType.bind(this),v.setVisualizationType=this.setVisualizationType.bind(this),v.getVisualizationId=this.getVisualizationId.bind(this),v.setVisualizationId=this.setVisualizationId.bind(this),v.getViewType=this.getViewType.bind(this),v.setViewType=this.setViewType.bind(this),v.getViewId=this.getViewId.bind(this),v.setViewId=this.setViewId.bind(this),v.getChartFilterExpression=this.getChartFilterExpression.bind(this),v.setChartFilterExpression=this.setChartFilterExpression.bind(this),v.getUpdateChartFilterExpression=this.getUpdateChartFilterExpression.bind(this),v.setUpdateChartFilterExpression=this.setUpdateChartFilterExpression.bind(this),v.getChartDrillDownParameters=this.getChartDrillDownParameters.bind(this),v.setChartDrillDownParameters=this.setChartDrillDownParameters.bind(this),v.setRefreshMode=this.setRefreshMode.bind(this),v.formatNumber=this.formatNumber.bind(this),v.getIsRelatedRecord=this.getIsRelatedRecord.bind(this),v}getVisualizationId(){if(this._currentVisualizationId){if(this.previousDataSetDefinition&&this.previousDataSetDefinition.VisualizationId){const e=a.a.toString(new a.a(this.previousDataSetDefinition.VisualizationId));e!==this._memoizedVisualizationIdFromDataSetDefinition&&(this._currentVisualizationId=e,this._memoizedVisualizationIdFromDataSetDefinition=e)}}else if(this.previousDataSetDefinition&&this.previousDataSetDefinition.VisualizationId){const e=a.a.toString(new a.a(this.previousDataSetDefinition.VisualizationId));this._currentVisualizationId=e,this._memoizedVisualizationIdFromDataSetDefinition=e}else this._currentVisualizationId=null;return this._currentVisualizationId}setVisualizationId(e){const t=new a.a(e);this._currentVisualizationId=a.a.toString(t)}getVisualizationType(){const e=this.previousDataSetDefinition;if(null===this._currentVisualizationType)if(e&&e.IsUserChart){const t="true"===e.IsUserChart?1:0;this._currentVisualizationType=t,this._memoizedVisualizationTypeFromDataSetDefinition=t}else this._currentVisualizationType=0;else if(e&&e.IsUserChart){const t="true"===e.IsUserChart?1:0;t!==this._memoizedVisualizationTypeFromDataSetDefinition&&(this._currentVisualizationType=t,this._memoizedVisualizationTypeFromDataSetDefinition=t)}return this._currentVisualizationType}setVisualizationType(e){this._currentVisualizationType=e}getViewId(){if(this._currentViewId){if(this.previousDataSetDefinition&&this.previousDataSetDefinition.ViewId){const e=a.a.toString(new a.a(this.previousDataSetDefinition.ViewId));e!==this._memoizedViewIdFromDataSetDefinition&&(this._currentViewId=e,this._memoizedViewIdFromDataSetDefinition=e)}}else if(this.previousDataSetDefinition&&this.previousDataSetDefinition.ViewId){const e=a.a.toString(new a.a(this.previousDataSetDefinition.ViewId));this._currentViewId=e,this._memoizedViewIdFromDataSetDefinition=e}else this._currentViewId=null;return this._currentViewId}setViewId(e){const t=new a.a(e);this._currentViewId=a.a.toString(t)}getViewType(){const e=this.previousDataSetDefinition;if(null===this._currentViewType)if(e&&e.IsUserView){const t="true"===e.IsUserView?4230:1039;this._currentViewType=t,this._memoizedViewTypeFromDataSetDefinition=t}else this._currentViewType=1039;else if(e&&e.IsUserView){const t="true"===e.IsUserView?4230:1039;t!==this._memoizedViewTypeFromDataSetDefinition&&(this._currentViewType=t,this._memoizedViewTypeFromDataSetDefinition=t)}return this._currentViewType}setViewType(e){this._currentViewType=e}getChartFilterExpression(){const e=this.previousDataSetDefinition;return this._currentChartFilterExpression?e&&e.HighchartFilterExpression&&e.HighchartFilterExpression!==this._memoizedChartFilterExpressionFromDataSetDefinition&&(this._currentChartFilterExpression=e.HighchartFilterExpression,this._memoizedChartFilterExpressionFromDataSetDefinition=e.HighchartFilterExpression):e&&e.HighchartFilterExpression?(this._currentChartFilterExpression=e.HighchartFilterExpression,this._memoizedChartFilterExpressionFromDataSetDefinition=e.HighchartFilterExpression):e&&e.ChartDrillDownParameters&&e.ChartDrillDownParameters.length>0&&(this._currentChartFilterExpression=e.ChartDrillDownParameters[e.ChartDrillDownParameters.length-1].filterExpression),this._currentChartFilterExpression}setChartFilterExpression(e){this._currentChartFilterExpression=e}setUpdateChartFilterExpression(e){this._shouldUpdateChartFilterExpression=e}getUpdateChartFilterExpression(){return this._shouldUpdateChartFilterExpression}getChartDrillDownParameters(){const e=this.previousDataSetDefinition;return this._currentChartDrillDownParameters?e&&e.ChartDrillDownParameters&&e.ChartDrillDownParameters!==this._memoizedChartDrillDownParametersFromDataSetDefinition&&(this._currentChartDrillDownParameters=e.ChartDrillDownParameters,this._memoizedChartDrillDownParametersFromDataSetDefinition=e.ChartDrillDownParameters):e&&e.ChartDrillDownParameters&&(this._currentChartDrillDownParameters=e.ChartDrillDownParameters,this._memoizedChartDrillDownParametersFromDataSetDefinition=e.ChartDrillDownParameters),this._currentChartDrillDownParameters}setChartDrillDownParameters(e){this._currentChartDrillDownParameters=e}setRefreshMode(e){this._chartDataSetRefreshMode=e}formatNumber(e,t,i){return Object(I.c)(e,this._cultureInfo,t,i)}getRefreshMode(e){return null===this._isChartDrillDownFeatureEnabled&&(this._isChartDrillDownFeatureEnabled=Object(n.f)(e,r.I)),this._getRefreshMode()}_getRefreshMode(){!1===this._isChartDrillDownFeatureEnabled&&(this._parentName&&"DataSetHost"===this._parentName&&this.getUpdateChartFilterExpression()?this._chartDataSetRefreshMode=3:this._chartDataSetRefreshMode=1);const e=this.getChartDrillDownParameters();return 2===this._chartDataSetRefreshMode&&(!e||e.length<=0)&&(this._chartDataSetRefreshMode=1),this._chartDataSetRefreshMode?this._chartDataSetRefreshMode:e&&e.length>0?2:1}getIsRelatedRecord(){var e;return!!(null===(e=this.previousDataSetDefinition)||void 0===e?void 0:e.RelationshipName)}createChartDataDecorator(e){const t=this.getViewId(),i=a.a.tryParse(t),r=this.getViewType(),n=this.getVisualizationId(),s=a.a.tryParse(n),o=this.getVisualizationType();let l;switch(this.getRefreshMode(e)){case 2:let t=null;const n=this.getChartDrillDownParameters();if(!(n&&n.length>0))throw new Error("Execution failed for ChartDrilldownDataSetRefreshExecutor; Cause: Missing Chart Drilldown Parameter.");t=n[n.length-1],l=new D.a(()=>e,s,i,o,r,t.groupByAttribute.name,t.groupByAttribute.relatedEntityName,t.chartType);break;case 1:case 3:default:l=new T.a(()=>e,s,i,o,r)}this.dataFirstTimeSentAcknowledged=!0;const c=this.previousOwnProps?this.previousOwnProps.id:null,u=Object(L.tb)(e,i,c);if(!u||!u.fetchXML)return l;const p=Object(d.a)(e,s);if(!p||!p.DataDescription&&!p.WebResourceId)return l;this.sortingObj.updateSortingArrays();const h=this.getChartFilterExpression();h&&("{}"===h?this.filteringObj.clearFilter():this.filteringObj.setFilter(JSON.parse(h))),u.entityLogicalName&&u.entityLogicalName===M.zb&&this._applyQueueItemDefaultFilterAndLinkedEntities(e,u),this.filteringObj.getFilter()&&this.filteringObj.calculateFilterExpression();const g=this.createQueryBuilder(()=>e,u);return this.pagingObj.reset(),g instanceof V.a?(this.cachedQueryState=g.getQueryState(),this.cachedQueryBuilder=g):(this.cachedQueryState=g,this.cachedQueryBuilder=B.c.fromState(this.cachedQueryState)),l.initialize(p.DataDescription,this.cachedQueryBuilder instanceof V.a?this.cachedQueryBuilder.fetchXml:this.cachedQueryState.fetchXml,p.PresentationDescription,u.title,u.entityLogicalName,p.Name,p.PrimaryEntityTypeCode,!a.a.isNullOrEmpty(p.WebResourceId),!Object(x.c)(this.cachedQueryBuilder instanceof V.a?this.cachedQueryBuilder.rollupType:void 0)),l.setupAggregationQueries(),this._cachedChartDataDecorator=l,this._cachedChartDataDecorator}ensureDataInitialization(e){this.dataRequestedOnce||this.previousInitState!==s.a.Initializing||2!==this.firstDataRequestType||(this.dataRequestedOnce=!0,this.dataFirstTimeSentAcknowledged=!0),super.ensureDataInitialization(e)}ensureReadinessForChartDataRefresh(e,t,i){const r=this.getViewId(),n=this.getViewType(),s=this.getVisualizationId(),o=this.getVisualizationType(),l=[];l.push(t.retrieveViewAction(i,null,n,a.a.tryParse(r))),this.previousDataSetDefinition&&this.previousDataSetDefinition.EnableViewPicker&&l.push(t.retrieveViewSelectorAction(i,C.a.MAIN_APPLICATION_VIEW));const c=this.retrieveQuickFindView(e,t);return c&&l.push(c),Promise.all(l).then(l=>t.retreiveChartAction(i,o,a.a.tryParse(s)).then(()=>this.createChartDataDecorator(e()),i=>(this._handleRetrieveChartActionError(e,t,new T.a(e,a.a.tryParse(s),a.a.tryParse(r),o,n),i.getNegativeErrorCode()),null)),i=>{const l=i&&!Object(F.l)(i.errorCode)&&i.errorCode,c=Object(k.a)(l),u=c?Object(m.b)(e(),c):"retrieve chart failed. error code: "+N.a.getHexErrorCodeFromInt(l);t.updateChartErrorInformation(e(),u,new T.a(e,a.a.tryParse(s),a.a.tryParse(r),o,n),this.previousOwnProps.id)})}_handleRetrieveChartActionError(e,t,i,r){const n=e();t.updateChartErrorInformation(n,Object(m.b)(n,p.p),i,this.previousOwnProps.id)}refreshDataSet(e,t,i){const r=this.previousOwnProps&&this.previousOwnProps.configuration?Object(_.b)(e(),this.previousOwnProps.configuration.CustomControlId)||Object(_.b)(e(),this.previousOwnProps.configuration.Name):o.a;if(!this.previousDataSetDefinition)throw i.EventManager.ReportComponentFailure(r,new Error("previousDataSetDefinition is null or undefined"),null,[{name:"APIName",value:z},{name:"controlId",value:this.previousOwnProps?this.previousOwnProps.controlId:""},{name:"EntityName",value:this.previousOwnProps&&this.previousOwnProps.formInfo?this.previousOwnProps.formInfo.EntityName:null},{name:"CustomControlId",value:this.previousOwnProps&&this.previousOwnProps.configuration?this.previousOwnProps.configuration.CustomControlId:""}]),new Error("Refreshing not initialized DataSet parameter");const n=e();if(Object(b.E)(n)?!Object(f.b)(n):!Object(f.c)(n))return this.updateRefreshStatusToRequestBack(),Promise.resolve(this);const s=this.previousOwnProps?this.previousOwnProps.id:null,c=this.previousOwnProps&&this.previousOwnProps.formInfo?this.previousOwnProps.formInfo.EntityName:this.getEntityTypeName(),u=this.getVisualizationId(),d=a.a.tryParse(u);return l(this.getRefreshMode(e()),e,t,this,this._parentName,s,this.contextToken,c,null).then(()=>(this.updateRefreshStatusToRequestBack(),this),n=>(i.EventManager.ReportComponentFailure(r,n,n.message,[{name:"APIName",value:z},{name:"pageId",value:s},{name:"controlId",value:this.previousOwnProps?this.previousOwnProps.controlId:null},{name:"EntityName",value:this.getEntityTypeName()},{name:"visualizationId",value:JSON.stringify(d)}]),this.handleRefreshError(e,this,n,t),this))}setErrorStatus(e,t,i){this.refreshingStatus=100,this.errorMessage=e;const r=null==i?void 0:i.errorCode;this.error=!0;const n=this.getLatestData();n&&(n.loading=!1,this._previousChartDataSetParameter.loading=!1,n.error=this.error,this._previousChartDataSetParameter.error=this.error,n.errorMessage=this.errorMessage,this._previousChartDataSetParameter.errorMessage=this.errorMessage,n.errorCode=r,this._previousChartDataSetParameter.errorCode=r),this.triggerOnDataSetUpdateCallBack(this.error,this.errorMessage,r,"")}_getChartExportMetadataFromStateTree(e){if(!(e&&e.metadata&&e.metadata.charts&&e.metadata.charts[this.getVisualizationId()]))return null;return{visualizationid:this.getVisualizationId(),name:e.metadata.charts[this.getVisualizationId()].Name,description:null,primaryentitytypecode:e.metadata.charts[this.getVisualizationId()].PrimaryEntityTypeCode,datadescription:e.metadata.charts[this.getVisualizationId()].DataDescription,presentationdescription:e.metadata.charts[this.getVisualizationId()].PresentationDescription,isdefault:e.metadata.charts[this.getVisualizationId()].IsDefault,solutionId:null}}_getUserCultureInfo(e){return e&&e.user?(this._cultureInfo||(this._cultureInfo=Object(j.c)(Object(E.x)(e))),this._cultureInfo):null}_getDefaultVisualizationId(e){const t=this.getEntityTypeName();if(!(e&&e.metadata&&e.metadata.chartDefaults&&t))return null;const i=e.metadata.chartDefaults[t];return i?a.a.toString(i):null}_applyQueueItemDefaultFilterAndLinkedEntities(e,t){const i=Object(E.q)(e),a=t.entityLogicalName;if(i&&a&&0===this.extraFilters.length){if(!this._memoizedDefaultFilterAndLinkedEntities){const t=Object(n.f)(e,r.ag),s=Object(R.a)(a,i,this.contextToken,t,null,!0).getFilterAndLinkedEntities(A.a,!0);this._memoizedDefaultFilterAndLinkedEntities=s}if(this._memoizedDefaultFilterAndLinkedEntities){const e=this._memoizedDefaultFilterAndLinkedEntities.filter,t=this.filteringObj.getFilter();if(t&&t!==e){if(!t.filters||t.filters&&-1===t.filters.indexOf(e)){const i={conditions:[],filterOperator:0,filters:[t,e]};this.filteringObj.setFilter(i)}}else this.filteringObj.setFilter(e);this._memoizedDefaultFilterAndLinkedEntities.linkEntities.forEach(e=>{this.linkedEntitiesObj.addLinkedEntity(e)})}}}}},Nse0:function(e,t,i){"use strict";i.d(t,"a",(function(){return a})),i.d(t,"b",(function(){return s}));var r=i("BFlg"),n=i("Uv1Y");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const a="customcontrol.refreshCustomDataProvider";function s(e,t,i,s){return{type:"customcontrol.refreshCustomDataProvider.async",execute({dispatch:o,getState:l},c){const u=r.N+".refreshCustomDataProviderAction";return s().then(r=>(o(function(e,t,i,r){let n=new Array;r&&r.length>0&&(n=r.slice());return{type:a,payload:n,meta:{pageId:e,customControlId:t,dataSetParameterName:i}}}(e,t,i,r)),c.EventManager.ReportComponentSuccess(u),r)).catch(e=>{throw c.EventManager.ReportComponentFailure(u,Error(e)),new n.a(e)})}}}},Or4W:function(e,t,i){"use strict";i.d(t,"b",(function(){return j})),i.d(t,"a",(function(){return D})),i.d(t,"d",(function(){return F})),i.d(t,"c",(function(){return E}));var r=i("SAYH"),n=i("y60j"),a=i("K7RF"),s=i("g03H"),o=i("VqBP"),l=i("FZDd"),c=i("Lohl"),u=i("odYE"),d=i("Z/4N"),p=i("NPZ3"),h=i("Uv1Y"),g=i("BJ7u"),m=i("txdA"),f=i("3/02"),b=i("Lyxw"),y=i("AF/G"),v=i("9fGf"),S=i("iJGp"),_=i("CYtR"),O=i("69Qu"),P=i("i1f0"),w=i("NjDY");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const C=new r.a("06e9f7af-1f54-4681-8eec-1e21a1ceb465"),I=new r.a("e7a81278-8635-4d9e-8d4d-59480b391c5b");function E(e,t){const i=[{name:"formId",value:r.a.toString(e)},{name:"entityTypeName",value:t}];return{type:"loadFormDependencies.async",execute({dispatch:r,getState:a},s,o){let c=a();const u=Object(n.h)(c,e);if(!u)return s.EventManager.ReportComponentFailure("Forms.LoadFormDependencies",Error("Invalid FormDescriptor in LoadFormDependencies"),void 0,i),Promise.reject(new h.a("No form descriptor found in state tree for specified formId."));return r(Object(l.f)(t,!1,Object(n.w)(c,e))).then(()=>{c=a();const e=j(c,r,u,t,s,o),i=r(Object(l.f)(t,!1,Object(p.c)(c,t,!1)));e.push(i);const n=function(e,t,i,r,n){let a=!0;null!=i.EntityLogicalName&&e&&e.metadata&&e.metadata.entities&&e.metadata.entities[i.EntityLogicalName]&&!e.metadata.entities[i.EntityLogicalName].IsBusinessProcessEnabled&&(a=!1);if(a){return T(e,t,["MscrmControls.Containers.ProcessBreadCrumb","MscrmControls.Containers.ProcessStageControl"],r,n)}return Promise.resolve()}(c,r,u,s,o);return e.push(n),Promise.all(e)})},getFailureParameters:(e,t)=>i}}function j(e,t,i,n,a,s){const l=[];for(const c in i.Controls){const u=i.Controls[c];if(r.a.isNullOrEmpty(u.ClassId)||r.a.equals(u.ClassId,y.G))continue;const d=D(e,t,i,c,u,Object(o.b)(e,n,u),u.ClassId&&r.a.toString(u.ClassId),a,s);l.push(d)}return l}function D(e,t,i,n,a,o,c,u,d){let p,h;const g=a.Parameters,y=Object(m.g)(e,i,a,g);if(Object(b.f)(e,f.O)&&y){h="MscrmControls.Chart.ChartControl";const i=[T(e,t,[h],u,d)];return Promise.all(i)}if(a.UniqueId!==r.a.EMPTY.guid&&!r.a.equals(a.ClassId,C)){const t=i.ControlConfigurations[a.UniqueId],r=Object(v.b)(e);t&&t.CustomControls&&t.CustomControls[r]&&(p=t.CustomControls[r],h=p.Name)}if(!p){const{pcfDatasetGridEnabled:t}=Object(w.D)(e);p=Object(s.s)(n,a.DataFieldName,o,a,i.EntityLogicalName,c,t),h="notescontrol"===p.Name?"MscrmControls.TimelineWallControl.TimelineWall":Object(s.B)(p)}const S=[T(e,t,function(e){return e===_.b?[e,_.a,_.d]:[e]}(h),u,d)];if(r.a.equals(new r.a(c),I)&&a.Parameters){const e="TargetEntityType",i=a.Parameters[e];S.push(t(Object(l.f)(i,!1,[])).catch(()=>{}))}return Promise.all(S)}function T(e,t,i,r,n){const s=[];for(const t of i){Object(d.e)(e,t)||s.push(t)}return s.length>0?t(Object(a.b)("customcontrol",null,null,null,!1,S.a.OnDemandWithoutContext,null,null,s,null)).catch(e=>{const t=[{name:"CorrelationId",value:n.correlationId},{name:"ContextId",value:n.contextId},{name:"ActionStack",value:n.stack}];r.TraceManager.getTracer("Forms.LoadFormDependencies").warn("Getting client metadata has failed.",t)}):Promise.resolve()}function F(e,t,i,r){var n;const a=[];for(const s in t){const o=t[s],l=!Object(O.c)(i);let d;d=l?Object(P.ec)(i):new Set(Object.keys(o));for(const t in o){if(l&&d&&!d.has(t)){null===(n=r.TraceManager.getTracer("Forms.LoadFormDependencies"))||void 0===n||n.warn("Quick form entity is not included in offline profile.Skipping loading descriptor when offline .");continue}const i=o[t],s=e(Object(c.d)(new u.a(t),i,Object(g.a)(6))).then(()=>e(E(i,t)));a.push(s)}}return Promise.all(a)}},PZ34:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var r=i("ruPX"),n=i("baQL");function a(e,t){return Object(r.a)(n.a,{},t,e)}},"Pbw+":function(e,t,i){"use strict";i.d(t,"a",(function(){return j})),i.d(t,"b",(function(){return D}));var r=i("7NpP"),n=i("u+q+"),a=i("QBtP"),s=i("VRhS");function o(e,t){var i;return(null===(i=e.persona.presence)||void 0===i?void 0:i[t])||s.a}function l(e,t){var i;return null===(i=e.persona.profilePhoto)||void 0===i?void 0:i[t]}var c=i("mMyr"),u=i("AuXg"),d=i("Lyxw"),p=i("3/02"),h=i("SAYH"),g=i("jezt");class m{constructor(e,t,i,r,n,a){this.listeners={},this.listeners={},this.context=e,this.store=t,this._serviceName=i,this._debounceTimeInMs=r,this._dismissIntervalInMs=n,this._pollingConfig=a,this.getItem=this.getItem.bind(this),this.setItem=this.setItem.bind(this),this.registerListenerForUserId=this.registerListenerForUserId.bind(this),this.unRegisterListenerForUserId=this.unRegisterListenerForUserId.bind(this),this.loadData=this.loadData.bind(this),this.removeUnusedItems=this.removeUnusedItems.bind(this),this._debounceLoadData=this._debounceLoadData.bind(this),this._pollingConfig.enabled&&this._startPolling(),this._startCheckAndRemoveItems()}registerListenerForUserId(e,t){const i=h.a.newGuid().guid;return this.listeners[e]||(this.listeners[e]={}),this.listeners[e][i]=t,this._debounceLoadData(),i}unRegisterListenerForUserId(e,t){this.listeners[e]&&delete this.listeners[e][t],0===Object.keys(this.listeners[e]).length&&delete this.listeners[e]}forceUpdateIfRegistered(e){const t=e.filter(e=>null!=this.listeners[e]);t.length>0&&this.loadData(t)}executeListeners(e){e.forEach(e=>{this.listeners[e]&&Object.keys(this.listeners[e]).forEach(t=>{this.listeners[e][t](e,this.getItem(e))})})}_startPolling(){new g.a(this.context,this.store.dispatch,this._serviceName,this._pollingConfig.activePollingTimeInMs,this._pollingConfig.inactivePollingTimeInMs,!1,()=>this.loadData()).startPolling()}_debounceLoadData(){clearTimeout(this._statusTimeout),this._statusTimeout=setTimeout(()=>{this.loadData()},this._debounceTimeInMs)}_startCheckAndRemoveItems(){setInterval(this.removeUnusedItems,this._dismissIntervalInMs)}}var f=i("I/gz");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var b=i("wge3"),y=i("zsAz");async function v(e,t){var i;await e(Object(b.initializeAppHostClient)());const r=(await(null===(i=t.AppHostClient)||void 0===i?void 0:i.getPluginProvider().getExternalPluginsAsync())).microsoftGraph,n=t.TraceManager.getTracer("microsoftGraph");if(!r)throw n.warn("GraphPlugin is not available from SAH (shared app host)"),Object(y.d)("GraphPlugin is not available from SAH (shared app host)");return r}const S="PresenceCachingService",_={enabled:!0,activePollingTimeInMs:3e4,inactivePollingTimeInMs:6e5};class O extends m{constructor(e,t){super(e,t,S,1e3,3e5,_)}getItem(e){return o(this.store.getState(),e)}setItem(e,t){this.store.dispatch(function(e,t){return{type:f.d,payload:{id:e,status:t}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(e,t))}async loadData(e){const t=null!=e?e:Object.keys(this.listeners);if(0!==t.length)try{const e=await v(this.store.dispatch,this.context),i=await e.getPresencesByUserId(t);for(const e of i)this.setItem(e.id,{availability:e.availability,activity:e.activity});this.executeListeners(Object.keys(this.listeners));const r=[{name:"statuses Cached",value:JSON.stringify(i)}];this.context.EventManager.ReportComponentSuccess(S,r)}catch(e){throw t.forEach(e=>{const t=s.a;this.setItem(e,t)}),this.executeListeners(Object.keys(this.listeners)),this.context.EventManager.ReportComponentFailure(S,e,"SAH (shared app host initialization or plugin setup failed), refresh page or re-signin with user with sufficient permission"),e}}removeUnusedItems(){const e=(t=this.store.getState(),i=Object.keys(this.listeners),Object.keys(t.persona.presence).filter(e=>!i.includes(e)));var t,i,r;0!==e.length&&this.store.dispatch((r=e,{type:f.b,payload:r}))}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
async function P(e){const t=await fetch(e),i=await t.blob();return URL.createObjectURL(i)}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const w={enabled:!1};class C extends m{constructor(e,t){super(e,t,"ProfilePhotoCachingService",1e3,3e5,w)}getItem(e){return l(this.store.getState(),e)}setItem(e,t){this.store.dispatch(
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t){return{type:f.e,payload:{id:e,blobUrl:t}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(e,t))}async loadData(e){const t=null!=e?e:Object.keys(this.listeners);if(0===t.length)return;const i=[];for(const e of t)if(!this.getItem(e))try{const t=await v(this.store.dispatch,this.context),r=await t.getPhoto(e),n=await P(r);this.setItem(e,n),i.push(e);const a=[{name:"caching image for user",value:e}];this.context.EventManager.ReportComponentSuccess("ProfilePhotoCachingService",a)}catch(t){this.setItem(e,void 0),this.context.EventManager.ReportComponentFailure("ProfilePhotoCachingService",t,"SAH (shared app host initialization or plugin setup failed), refresh page or re-signin with user with sufficient permission")}this.executeListeners(i)}removeUnusedItems(){const e=(t=this.store.getState(),i=Object.keys(this.listeners),Object.keys(t.persona.profilePhoto).filter(e=>!i.includes(e)));var t,i;if(0!==e.length){for(const t of e)URL.revokeObjectURL(this.getItem(t));var r;this.store.dispatch((r=e,{type:f.c,payload:r}))}}}var I=i("Y6SI");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function E(){return{type:f.a,sync:!0,execute(e,t){if(!t.PersonaCachingServices){const i=e.getState(),r=Object(d.f)(i,p.ue);if(Object(I.e)(i)&&r){const i={};i[S]=function(e,t){return new O(e,t)}(t,e),i.ProfilePhotoCachingService=function(e,t){return new C(e,t)}(t,e),t.PersonaCachingServices=i,t.EventManager.ReportComponentSuccess("BootPersonaSuccess")}}}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function j(e){const t=c.useContext(a.a);Object(n.c)()(E());const i=Object(n.d)(t=>o(t,e)),s=i?Object(u.a)(e,i):r.b.none,[l,d]=c.useState(s);return c.useEffect(()=>{var i,r;if(!e)return;const n=null===(r=null===(i=null==t?void 0:t.PersonaCachingServices)||void 0===i?void 0:i.PresenceCachingService)||void 0===r?void 0:r.registerListenerForUserId(e,(e,t)=>{const i=Object(u.a)(e,t);d(i)});return()=>{var i,r;null===(r=null===(i=null==t?void 0:t.PersonaCachingServices)||void 0===i?void 0:i.PresenceCachingService)||void 0===r||r.unRegisterListenerForUserId(e,n)}},[e,t]),l}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function D(e){const t=c.useContext(a.a);Object(n.c)()(E());const i=Object(n.d)(t=>l(t,e));return c.useEffect(()=>{var i,r;if(!e)return;const n=null===(r=null===(i=null==t?void 0:t.PersonaCachingServices)||void 0===i?void 0:i.ProfilePhotoCachingService)||void 0===r?void 0:r.registerListenerForUserId(e,()=>{});return()=>{var i,r;null===(r=null===(i=null==t?void 0:t.PersonaCachingServices)||void 0===i?void 0:i.ProfilePhotoCachingService)||void 0===r||r.unRegisterListenerForUserId(e,n)}},[e,t]),i}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */},Q1Tc:function(e,t,i){"use strict";i.d(t,"b",(function(){return s})),i.d(t,"a",(function(){return a}));var r=i("dHD5"),n=i("jq7Z");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const a="control.update.unboundOutputs";function s(e,t,i,s){return{type:"control.update.unboundOutputs.async",execute({dispatch:o,getState:l}){if(!Object.keys(s).length)return Promise.resolve();const c=l(),u=Object(n.a)(c,e);let d=!1;const p=Object(r.w)(i),h=Object.assign({},u.forms[p].controlUnboundOutputs);for(const e in s){const i=s[e],r=t+"."+e;h[r]!==i&&(h[r]=i,d=!0)}return d&&o(function(e,t,i){return{type:a,payload:{controlUnboundOutputs:i},meta:{pageId:e,contextKey:t}}}(e,p,h)),Promise.resolve()}}}},QXpm:function(e,t,i){"use strict";i.d(t,"a",(function(){return s})),i.d(t,"b",(function(){return o}));var r=i("dHD5"),n=i("BFlg"),a=i("LAGg");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const s="grid.toggleRollupView";const o=(e,t,i)=>function(e,t,i,s){return{type:"grid.toggleRollupView.async",execute({dispatch:o},l){const c=l.TraceManager.getTracer(n.P),u=n.N+".toggleRollupViewAction";try{c.info(`Setting Toggle value to ${t} for the grid.`);const n=Object(r.w)(s);o(function(e,t,i,r){return{type:e,payload:t,meta:{pageId:i,dataSetContextKey:r}}}(e,t,i,n)),o(Object(a.b)(i,s));const d=[{name:"newValue",value:t}];return l.EventManager.ReportComponentSuccess(u,d),Promise.resolve()}catch(e){const t="Setting Toggle value to the grid failed";l.EventManager.ReportComponentFailure(u,Error(t))}}}}(s,e,t,i)},R5Qn:function(e,t,i){"use strict";i.d(t,"b",(function(){return u})),i.d(t,"c",(function(){return l})),i.d(t,"f",(function(){return c})),i.d(t,"a",(function(){return d})),i.d(t,"e",(function(){return p})),i.d(t,"d",(function(){return h}));var r=i("5Oca"),n=i("eXjw"),a=i("E3i9"),s=i("jq7Z");function o(e,t,i,r){var n,a,o;return null===(o=null===(a=null===(n=Object(s.a)(e,t))||void 0===n?void 0:n.__lookupKeys)||void 0===a?void 0:a[i])||void 0===o?void 0:o[r]}function l(e,t,i){const r=Object(a.b)(e,t);return r&&i&&r[i]?r[i]:null}function c(e,t,i,r){const n=o(e,r,t||"placeholderEtn",i);return n&&n.metadataKey}function u(e,t,i,r,n){const a=o(e,n,t||"placeholderEtn",i);return a&&a.dataKeys?a.dataKeys[r]:null}function d(e,t,i){const r=l(e,t,i||"placeholderEtn");return r&&r.view?r.view:null}function p(e,t,i,n,a){const s=function(e,t,i,r){const n=function(e,t){if(!e||!e.data||!e.data.lists)return null;return e.data.lists[t]}(e,t);if(n){if(r)return n.records;if(n.pages&&i>0){const e=n.pages[i];if(e)return n.records.slice(e.startIndex,e.startIndex+n.pageSize)}}return null}(e,t,i,a),o=[];if(!s)return null;for(const t of s){const i=Object(r.b)(t)(e,t.etn);i&&o.push(i)}return o}function h(e,t){const i=Object(r.o)(e,t);return i?i.initialized:n.a.Uninitialized}},VRhS:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var r=i("JRRC");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const n={availability:r.b.PresenceUnknown,activity:r.a.Offline}},VpHT:function(e,t,i){"use strict";i.d(t,"a",(function(){return p}));var r=i("NjDY"),n=i("99zj"),a=i("V6aM"),s=i("3mEc"),o=i("69Qu");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const l=["JQUERY","JQUERY.JS"];let c,u,d;function p(e){return{type:"customcontrol.loadresources",execute({dispatch:t,getState:i},p){const g=[],m=i(),f=Object(r.x)(m),b=e.Properties.Resources.filter((e,t,i)=>(0===e.Type||4===e.Type||1===e.Type)&&!(e.LibraryName&&-1!==l.indexOf(e.LibraryName.toUpperCase())||p.AssetLoader.isResourceLoaded(f+e.Name))).sort((e,t)=>e.LoadOrder-t.LoadOrder),y=e.Properties.Resources.filter((e,t,i)=>5===e.Type);if(b.length>0){let e;const i=!Object(o.c)(m),r=Object(o.b)(m),n=()=>async function(e,t,i,r,n,s){let o=[],l=s[0].LoadOrder,u=0;for(;u<s.length;){t&&s[u].LoadOrder!==l&&(await Promise.all(o),o=[],l=s[u].LoadOrder);const d=s[u];let p,g=d.Name,m=r;if(c&&c[d.Name])m=window.__public_path__+"control",g=c[d.Name];else if(0===d.Type){const e=d.LibraryName+".js";c&&c[e]&&(m=window.__public_path__+"control",g=c[e])}switch(d.Type){case 0:case 4:p=h(n,g,m,3,t=>e(Object(a.a)(t)),t,i,!1);break;case 1:p=h(n,g,m,2,t=>e(Object(a.a)(t)),t,i);break;default:p=null}p&&o.push(p),u++}await Promise.all(o)}(t,i,r,f,p.AssetLoader,b);e=!function(){null==d&&(d=window.location.search.toLocaleLowerCase().indexOf("uselocal=true")>=0);return d}()||c?n():function(){if(u)return u;if("/uclient/"!==window.__public_path__){if(!c){const e=window.__public_path__+"controlFileMap.json";u=-1!==navigator.userAgent.indexOf("MSIE")||navigator.appVersion.indexOf("Trident/")>0?new Promise(t=>{const i=new XMLHttpRequest;i.addEventListener("load",(function(){let e={};try{e=JSON.parse(this.responseText)}catch(e){}t(e)})),i.addEventListener("error",()=>{t({})}),i.open("GET",e),i.send()}):fetch(e).then(e=>e.json(),()=>({})),u.then(e=>{c=e},()=>{c={}})}}else c={},u=Promise.resolve({});return u}().then(n,n),e&&g.push(e)}const v=Object(s.k)(m);for(let e=0;e<y.length;e++)if(!v||!v.hasOwnProperty(y[e].Name)){const i=t(Object(n.c)(y[e].Name)).then(i=>{let r=!1;for(const t of i)t&&t.webResourceDescriptorsByName&&t.webResourceDescriptorsByName.hasOwnProperty(y[e].Name)&&(r=!0);!r&&t(Object(n.b)(y[e].Name))});g.push(i)}return g.length>0?Promise.all(g):null},sync:!0}}function h(e,t,i,r,n,a,s,o=!0){return e.loadWebResource(t,i,r,n,a,o).catch(l=>{if(a&&s)return e.resetFilePromiseForRetry(i,t,r),e.loadWebResource(t,i,r,n,!1,o);throw l})}},WZ96:function(e,t,i){"use strict";i.d(t,"e",(function(){return r})),i.d(t,"b",(function(){return n})),i.d(t,"f",(function(){return a})),i.d(t,"g",(function(){return s})),i.d(t,"d",(function(){return o})),i.d(t,"c",(function(){return l})),i.d(t,"a",(function(){return c}));
/**
 * Constants for the grid page.
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="preview-id",n="preview-click-through",a="preview_orientation";var s;!function(e){e.row="row",e.column="column"}(s||(s={}));const o="preview-dont-show-borders",l="preview-dont-show-badges",c="FormDesigner"},Wdaq:function(e,t,i){"use strict";i.d(t,"a",(function(){return a})),i.d(t,"b",(function(){return s}));var r=i("dHD5"),n=i("BFlg");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const a="grid.setCommandManagerId";function s(e,t,i){return{type:"grid.setCommandManagerId.async",execute({dispatch:s,getState:o},l){const c=l.TraceManager.getTracer(n.P),u=n.N+".setCommandManagerIdAction";try{c.info("Updating the command manager id for the grid.");const n=Object(r.w)(i);return s(function(e,t,i){return{type:a,payload:t,meta:{pageId:e,dataSetContextKey:i}}}(e,t,n)),l.EventManager.ReportComponentSuccess(u),Promise.resolve()}catch(e){const t="Updating the command manager id for the grid failed with error : "+e.message;l.EventManager.ReportComponentFailure(u,Error(t))}}}}},Y6SI:function(e,t,i){"use strict";i.d(t,"e",(function(){return p})),i.d(t,"h",(function(){return g})),i.d(t,"c",(function(){return m})),i.d(t,"d",(function(){return f})),i.d(t,"a",(function(){return b})),i.d(t,"g",(function(){return v})),i.d(t,"f",(function(){return S})),i.d(t,"b",(function(){return _}));var r=i("Lyxw"),n=i("GYEz"),a=i("NjDY"),s=i("3/02"),o=i("eOoD"),l=i("w1eR"),c=i("uNu9"),u=i("arV0");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const d=new Map;function p(e){const{isCollaborationExperienceEnabled:t}=Object(a.D)(e);return t}function h(e,t){if(Object(r.f)(e,s.U))return!0;if(!1===d.has(t)){const i=Object(n.a)(e)===l.a.Browser,r=Object(n.e)(e)===o.a.Tablet,a=Object(n.e)(e)===o.a.Phone,s=p(e)&&i&&!r&&!a&&function(e){return y.has(e)}(t);d.set(t,s)}return d.get(t)}function g(e,t){return Object(r.f)(e,s.W)&&h(e,t)}function m(e,t){return Object(r.f)(e,s.T)&&h(e,t)}function f(e,t,i){return!t&&(m(e,i)||g(e,i))}function b(e,t,i){const r=Object(u.j)(e,i);if(!r)return null;const{id:n}=r;return`${t}_${null==n?void 0:n.guid}`}const y=new Set([c.a,c.A,c.Y,c.mb]);function v(e){return Object(r.f)(e,s.Ue)}function S(e){return Object(r.f)(e,s.Yb)}function _(e){const{copresenceRefreshRate:t}=Object(a.D)(e);return t?1e3*t:6e4}},YGjz:function(e,t,i){"use strict";i.d(t,"a",(function(){return r})),i.d(t,"b",(function(){return n}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="systemuser",n="transactioncurrency"},YPtO:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var r=i("JMHu");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class n{constructor(){this.getLinkedEntities=this.getLinkedEntities.bind(this),this.addLinkedEntity=this.addLinkedEntity.bind(this),this.clear=this.clear.bind(this),this._linkedEntityExpressions=new Array}retrieveDataSetLinking(){return{addLinkedEntity:this.addLinkedEntity.bind(this),getLinkedEntities:this.getLinkedEntities.bind(this),clear:this.clear,removeLinkedEntity:this.removeLinkedEntity.bind(this)}}getLinkedEntities(){return this._linkedEntityExpressions}addLinkedEntity(e){this._linkedEntityExpressions.find(t=>Object(r.e)(t,e))||this._linkedEntityExpressions.push(e)}removeLinkedEntity(e){const t=this._linkedEntityExpressions.findIndex(t=>Object(r.e)(t,e));-1!==t&&this._linkedEntityExpressions.splice(t,1)}get length(){return this._linkedEntityExpressions.length}clear(){this._linkedEntityExpressions=[]}}},Yexl:function(e,t,i){"use strict";i.d(t,"a",(function(){return m})),i.d(t,"b",(function(){return f}));var r=i("3/02"),n=i("SAYH"),a=i("P6DH"),s=i("Lyxw"),o=i("B9jE"),l=i("jRy5"),c=i("a72m"),u=i("KBcj"),d=i("d0w6"),p=i("BFlg"),h=i("hSDL"),g=i("jAuy");function m(e,t,i,m){return{type:"grid.quickfind.apply.async",execute({dispatch:f,getState:b},y){const v=y.TraceManager.getTracer(p.P),S=p.N+".QuickFilterAction";try{const p=b(),_=Object(a.H)(p,t,i,m);return function(e,t,i){return new Promise(r=>{const n=Object(u.a)(e,i,d.a.QUICKFIND_SEARCH);n?r(n):t(Object(c.a)(i,d.a.QUICKFIND_SEARCH,d.b.savedview)).then(e=>{r(e)})})}(p,f,_).then(c=>{v.info("Performing quick find on the grid ");const u=Object(a.V)(p,t,i,m);let _=u;const O=i.contextTokenType===l.a.SubGrid;let P=!1,w=Object(g.l)(p,t);if(O&&i.controlName){const e=Object(a.kb)(b(),t,i,i.controlName);e&&(P=e.EnableViewPicker)}return Object(s.e)(b(),r.ch)&&O&&!P||Object(g.l)(p,t)||(_=c,w=!1),f(Object(h.n)(e,t,i)),f(Object(o.a)(t,i,m,n.a.toString(_),null,d.a.QUICKFIND_SEARCH)).then(()=>{const e=[{name:"SearchCurrentView",value:w}];return y.EventManager.ReportComponentSuccess(S,e),u})})}catch(e){const t="Unable to perform a quick find on the grid";y.EventManager.ReportComponentFailure(S,Error(t))}}}}function f(e,t,i,r){return{type:"grid.quickfind.clear.async",execute({dispatch:a,getState:s},l){const c=l.TraceManager.getTracer(p.P),u=p.N+".QuickFilterAction";try{return c.info("Clearing quick find from the grid."),a(Object(h.n)("",t,i)),a(Object(o.a)(t,i,r,n.a.toString(e))).then(()=>{l.EventManager.ReportComponentSuccess(u)})}catch(e){const t="Unable to clear quick find value for grid";l.EventManager.ReportComponentFailure(u,Error(t))}}}}},"Z+6x":function(e,t,i){"use strict";i.d(t,"a",(function(){return w}));var r=i("7fV9");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class n{constructor(e,t,i){this.commanding={},this.hasError=e.error,this.errorMessage=e.errorMessage,this.errorCode=e.errorCode,this.innerError=e.innerError,this.working=e.loading,this.columns=i,this.sortedRecordIds=e.sortedRecordIds,this.records=t,this.sorting=e.sorting,this.filtering=e.filtering,this.linking=e.linking,this.paging=e.paging,this._dataSetParameter=e}refresh(){throw new Error("Not Replaced")}generateAdditionalAttributes(){throw new Error("Not Replaced")}add_OnDataSetRecordChange(e){throw new Error("Not Replaced")}remove_OnDataSetRecordChange(e){throw new Error("Not Replaced")}addOnDataSetUpdated(e){throw new Error("Not Replaced")}removeOnDataSetUpdated(e){throw new Error("Not Replaced")}getTitle(){return this._dataSetParameter.getTitle()}getViewId(){return this._dataSetParameter.getViewId()}getTargetEntityType(){return this._dataSetParameter.getTargetEntityType()}getLookupDataSet(e){throw new Error("Not Replaced")}setSelectedRecordId(e,t){throw new Error("Not Replaced")}setSelectedRecords(e){throw new Error("Not Replaced")}clearSelectedRecord(){throw new Error("Not Replaced")}getSelectedRecord(){throw new Error("Not Replaced")}retrieveRecordCommand(e,t,i,r,n){throw new Error("Not Replaced")}openDatasetItem(e){throw new Error("Not Replaced")}setSelectedRecordIds(e){throw new Error("Not Replaced")}getSelectedRecordIds(){throw new Error("Not Replaced")}clearSelectedRecordIds(){throw new Error("Not Replaced")}getCellImageInfo(e,t){throw new Error("Not Replaced")}retrieveLookupRecordsBySearchString(e,t,i){throw new Error("Not Replaced")}retrieveLookupRecordsByIds(e,t,i){throw new Error("Not Replaced")}}var a=i("SAYH"),s=i("izYK"),o=i("NYBK"),l=i("+QYJ"),c=i("JwRZ"),u=i("tHaS"),d=i("uhZ3");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class p{constructor(e,t,i,r){this._errorMessage="",this._notifications={},this._columns=[],this._wrappedRecord=e,this._columnAliasNameMap=t,this._legacyRecordData=i,this._columns=r}getWrappedRecord(){return this._wrappedRecord}getRecordId(){return this._wrappedRecord.getRecordId()}getNamedReference(){return this._wrappedRecord.getNamedReference()}getPrimaryEntityLogicalName(){return this.getNamedReference().LogicalName}getErrorMessage(){return this._errorMessage}setErrorMessage(e){this._errorMessage=e}getNotification(e){return this._notifications[e]?this._notifications[e]:this._wrappedRecord.getValidationError(e)}setNotification(e,t){this._notifications[e]=t}_getColumnDataType(e){let t;const i=l.b(this._columnAliasNameMap[e])?e:this._columnAliasNameMap[e],r=this._columns.find(e=>e.name===i);return r&&(t=r.dataType),t}getValue(e){if(this._legacyRecordData){if(l.b(e))return null;l.b(this._columnAliasNameMap[e])||(e=this._columnAliasNameMap[e]);const t=this._getColumnDataType(e);if(t===s.a.File||t===s.a.Image)return this._wrappedRecord.getValue(e);if(!this.getWrappedRecord().isValid(e)||null==this._legacyRecordData[e])return t===s.a.LookupPartyList?Object(c.l)(this.getWrappedRecord().getValue(e)):this.getWrappedRecord().getValue(e);const i=this._legacyRecordData[e];if(i instanceof u.a){if(t===s.a.OptionSet)return this._wrappedRecord.getValue(e);if(t===s.a.LookupSimple)return i.get_value()}return this._getColumnDataType(e)===s.a.LookupPartyList?Object(c.l)(this.getWrappedRecord().getValue(e)):this._getColumnDataType(e)===s.a.OptionSet?i.getValue("value"):i}return this._wrappedRecord.getValue(e)}getFormattedValue(e){return this._wrappedRecord.getFormattedValue(e)}setValue(e,t){throw new Error("Not replaced")}save(e){return this._wrappedRecord.save(e)}isDirty(){return this._wrappedRecord.isDirty()}isRecordValid(){return!this._errorMessage&&this._wrappedRecord.isRecordValid()}isEditable(e){return this._wrappedRecord.isEditable(e)}isSecured(e){return this._wrappedRecord.isSecured(e)}isReadable(e){return this._wrappedRecord.isReadable(e)}isValid(e){return this._wrappedRecord.isValid(e)}getFieldRequiredLevel(e){return this._wrappedRecord.getFieldRequiredLevel(e)}reformatValue(e){return this._wrappedRecord.reformatValue(e)}getCurrencyDecimalPrecision(e){return this._wrappedRecord.getCurrencyDecimalPrecision(e)}getPersonaInfo(e){return this._wrappedRecord.getPersonaInfo(e)}usePresenceStatus(e){return this._wrappedRecord.usePresenceStatus(e)}useProfilePhoto(e){return this._wrappedRecord.useProfilePhoto(e)}tryValidateColumns(e){var t;null===(t=this._columns)||void 0===t||t.forEach(t=>{var i;if(-1===(null===(i=t.name)||void 0===i?void 0:i.indexOf("."))&&t.name!==e&&!t.isHidden&&t.order>=0){const e=this.getValue(t.name);Object(d.b)(e)&&this._wrappedRecord.setValue(t.name,e)}})}}var h=i("odYE"),g=i("5Oca"),m=i("5ZBI"),f=i("pGYJ"),b=i("P6DH"),y=i("bT7G"),v=i("Lyxw"),S=i("3/02"),_=i("t4Ha"),O=i("NjDY");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const P=f.a+".Models.DataSet.LegacyDataSetObjectWrapper";class w{constructor(e,t=null,i){this._wrapper=null,this.previousDataSetParameter=null,this.previousLegacyDataSetParameter=null,this.controlMemoizedLegacyDataSetParameter=null,this._initializationActions=null,this._memoizedLookupWrappers={},this._recordChangeHandlers=[],this._dataSetChangeHandlers=[],this._previousRecords={},this._previousRowProperties={},this._previousHostOwnProps=null,this._previousPageInfo=null,this.refreshDataSet=this.refreshDataSet.bind(this),this.gridRunOnLoad=this.gridRunOnLoad.bind(this),this._propKey=e,this._wrapper=new r.a(e,t,i),this._contextToken=i}_wrapDataSetRecords(e,t,i,r){const n={},s={};i&&i.forEach(e=>{s[e.alias]=e.name});const o=this._previousHostOwnProps.configuration.Parameters[this._propKey],l=t.getTargetEntityType();for(const c in t.records){let u,d;if(o.DataProvider)u=t.records[c],d=new p(u,null,null,i);else{u=t.records[c];const n=u.getNamedReference(),o=new h.a(l,a.a.parse(n.id),n.name),m=r[c],f={};m&&i&&i.forEach(t=>{f[t.name]=Object(g.n)(e,o.etn,t.name,m.fields[t.name])}),d=new p(u,s,f,i)}i&&i.forEach(e=>{if(e.alias){const t=e.alias;Object.assign(d,{[t]:d.getValue(t)})}}),n[c]=d}return n}setLookupDataSetAttributes(e,t){this._wrapper.setLookupDataSetAttributes(e,t)}getPreviousQueryKey(){return this._wrapper.getPreviousQueryKey()}getUpdatedPropertiesDic(){return this._wrapper.getLegacyUpdatedPropertiesDic()}clearUpdatedPropertiesDic(){this._wrapper.clearLegacyUpdatedPropertiesDic()}isValidParameterConfiguration(e){return this._wrapper.isValidParameterConfiguration(e)}retrieveDataSetObject(e,t,i,r,a){var l,u,d,p;try{null!==t&&(this._previousHostOwnProps=t),null!==r&&(this._previousPageInfo=r);const i=this._wrapper.retrieveDataSetObject(e,this._previousHostOwnProps,this._previousHostOwnProps.configuration,this._previousPageInfo);if(this.previousDataSetParameter&&i===this.previousDataSetParameter)return this.controlMemoizedLegacyDataSetParameter||this.previousLegacyDataSetParameter&&this.previousLegacyDataSetParameter.working||(this.controlMemoizedLegacyDataSetParameter=this.previousLegacyDataSetParameter),this.previousLegacyDataSetParameter;this.previousDataSetParameter=i;const a=this._previousHostOwnProps.configuration.Parameters[this._propKey],h=Object(b.tb)(e,this._wrapper.getCurrentViewId(a),null==t?void 0:t.id),g=a.DataProvider&&!h,m=g||!this._wrapper.getIsColumnFirstMetadataReady()?i.columns:Object(c.m)(e,a,c.o,h,this._wrapper.getViewIdDocumentDic()),f=this._wrapper.getRecordsListById(e,this._previousHostOwnProps,this._previousHostOwnProps.configuration),y=this._wrapDataSetRecords(e,i,i.columns,f);if(Object(v.f)(e,S.Cc)&&(null==m?void 0:m.length)){const t="9",i=Object(O.D)(e),r=null==i?void 0:i.appointmentRichEditorExperience;if(null===(l=Object.values(y))||void 0===l?void 0:l.length)for(const e of m)for(const i of Object.values(y)){const n=(null===(u=i.getValue(e.alias))||void 0===u?void 0:u.get_entityLogicalName)?i.getValue(e.alias).get_entityLogicalName():i.getPrimaryEntityLogicalName();if(this._isHtmlContentField(n,e.attributes,r)){e.attributes.Format=t;break}}else for(const e of m){const i=((null===(d=this._wrapper.getLinkedEntitiesObj())||void 0===d?void 0:d.getLinkedEntities)?null===(p=this._wrapper.getLinkedEntitiesObj())||void 0===p?void 0:p.getLinkedEntities():[]).find(t=>`${t.alias}.${e.attributes.LogicalName}`===e.alias),n=(null==i?void 0:i.name)||this.getEntityTypeName();this._isHtmlContentField(n,e.attributes,r)&&(e.attributes.Format=t)}}this._dependentOptionSetColumnStatus=Object(b.z)(e,this._contextToken,this._previousHostOwnProps.id);const _=new n(i,y,m);if(i.columns&&!g)for(const n of i.columns){const i=n.name,a=m.filter(e=>e.name===i);if(!a||0===a.length){const e=Object.assign({},n);m.push(e)}if(this._wrapper.isEditableGrid(e))switch(n.dataType){case s.a.LookupSimple:this._memoizedLookupWrappers[i]||(this._memoizedLookupWrappers[i]=new o.a(i,this._contextToken,r));const n=this._memoizedLookupWrappers[i];n.updateParameterConfiguration(e,t,r,_),this._initializationActions&&n.ensureViewInitialization(this._initializationActions.retrieveViewAction)}}return this.previousLegacyDataSetParameter=_,Object.defineProperty(this.previousLegacyDataSetParameter,"working",{get:()=>i.loading,set(e){i.loading=e},enumerable:!0,configurable:!0}),this.previousLegacyDataSetParameter}catch(e){if(a){const t=this._previousHostOwnProps.configuration.CustomControlId.substring(this._previousHostOwnProps.configuration.CustomControlId.lastIndexOf(".")+1);a.EventManager.ReportComponentFailure(t,e,e.errorMessage,[{name:"APIName",value:P+".retrieveDataSetObject"},...this._getExtraTelemetryInfo()])}throw e}}_isHtmlContentField(e,t,i){if("email"!==e&&"appointment"!==e&&"recurringappointmentmaster"!==e&&"queueitem"!==e&&"annotation"!==e&&"activitypointer"!==e)return!1;if(!t)return!1;if(("appointment"===e||"recurringappointmentmaster"===e)&&!i)return!1;const r=t.format,n=t.LogicalName;return(("email"===e||"queueitem"===e||"activitypointer"===e)&&"description"===n||"annotation"===e&&"notetext"===n)&&"0"===r||"memo"===t.type&&"1"===r}updateControlMemoizedParameter(e,t,i,n){this.controlMemoizedLegacyDataSetParameter?Object.assign(this.controlMemoizedLegacyDataSetParameter,t):t.working||(this.controlMemoizedLegacyDataSetParameter=t),this._triggerDataSetUpdatedEvents(e,t,i,n),(i||this.getUpdatedPropertiesDic().hasOwnProperty(r.b))&&this.triggerOnDataSetUpdated()}_triggerDataSetUpdatedEvents(e,t,i,n){try{const s={},o=t.columns.map(e=>e.name);for(const l in t.records){if(i&&n&&n.toUpperCase()!==l.toUpperCase())continue;const u=t.records[l],d=u.getWrappedRecord(),p={},h={};for(const t of o)d.isValid(t)||(p[t]=d.getValidationError(t)),h[t]={isValid:d.isValid(t),requiredLevel:this._wrapper.getRecordFieldRequiredLevel(e,d,t),isEditable:this._wrapper.getRecordFieldIsEditable(e,d,t)};if(s[l]=h,this._previousRecords[l]){const t=this._previousRecords[l].getWrappedRecord();if(i){const t=this._previousRowProperties[l],i=Object(c.i)(e,this._wrapper,t,d,o);if(i.length){const e=this._createUpdateResult(2,u,i,p);this.triggerOnDataSetRecordChange(e)}const r=Object(c.h)(e,this._wrapper,t,d,o);if(r.length){const e=this._createUpdateResult(3,u,r,p);this.triggerOnDataSetRecordChange(e)}const n=Object(c.f)(t,d,o);if(n.length){const e=this._createUpdateResult(4,u,n,p);this.triggerOnDataSetRecordChange(e)}}const n=Object(c.g)(t,d,o);if(n.length){let t=null;if(i)this._wrapper.getCurrentSnapshotIdMap().hasOwnProperty(l)?(t=this._createUpdateResult(1,u,n,p),this.triggerOnDataSetRecordChange(t)):(t=this._createUpdateResult(10,u,n,p),this.triggerOnDataSetRecordChange(t));else if(!i)if(this._wrapper.getCurrentSnapshotIdMap().hasOwnProperty(l)){let i=1;if(a.a.tryParseOrNull(l)){const t=this._wrapper.getRecordSnapshotId(e,this._previousHostOwnProps,this._wrapper.getEntityTypeName(),a.a.parse(l));if(t){const r=Object(y.b)(e,t);if(r.activeChanges){for(const e of n)if(!r.activeChanges.hasOwnProperty(e)){i=10;break}}else i=10}else i=10}t=this._createUpdateResult(i,u,n,p),this.triggerOnDataSetRecordChange(t),10===i&&(this._wrapper.setLegacyUpdatedPropertiesDic(r.b),this._wrapper.setLegacyUpdatedPropertiesDic(`${r.c}${l}`))}else t=this._createUpdateResult(10,u,n,p),this.triggerOnDataSetRecordChange(t),this._wrapper.setLegacyUpdatedPropertiesDic(r.b)}else if(t.isDirty()&&!d.isDirty()){const e=this._createUpdateResult(10,u,n,p);this.triggerOnDataSetRecordChange(e)}}}this._wrapper.clearCurrentSnapshotIdMap(),this._previousRecords=t.records,this._previousRowProperties=s}catch(e){const t=[{name:"APIName",value:P},{name:"fromSetValue",value:i},{name:"fromSetRecordId",value:n},...this._getExtraTelemetryInfo(),{name:"errorMessage",value:null==e?void 0:e.message},{name:"callstack",value:null==e?void 0:e.stack}];m.a.error(`${P}: _triggerDataSetUpdatedEvents encountered error: ${null==e?void 0:e.message}`,t)}}setWrapperLoadingFlag(e){this._wrapper.getLatestData().loading=e,this._wrapper.setRefreshingStart()}getLatestData(){return this.previousLegacyDataSetParameter}setControlReRender(e){this._wrapper.setControlReRender(()=>{const t=this._wrapper.getLatestData();this.previousLegacyDataSetParameter.working=t.loading,this.previousLegacyDataSetParameter.hasError=t.error;const i=t.errorMessage;let r=i||"",n=t.errorCode;if(i&&i.startsWith("0x")){const e=i.indexOf(" ");r=i.substring(e+1),n||(n=parseInt(i.substring(0,e),16))}this.previousLegacyDataSetParameter.errorMessage=r,this.previousLegacyDataSetParameter.errorCode=n,this.previousLegacyDataSetParameter.innerError=t.innerError,e()})}linkToParameter(e,t){const i=t.refreshDataSetParameter;for(const i in e.records){const r=e.records[i],n=r.getWrappedRecord();this._wrapper.linkRecordAPI(n,t),r.setValue=this._recordSetValueAPI.bind(this,n.setValue.bind(n),t,i,r.tryValidateColumns.bind(r))}e.refresh=()=>{i(this,this._contextToken)},e.dependentOptionSetColumnStatus=this._dependentOptionSetColumnStatus,e.getLookupDataSet=this.getLookupDataSet.bind(this,e,t),e.generateAdditionalAttributes=this.generateAdditionalAttributes.bind(this),e.setSelectedRecordId=this._setSelectedRecordId.bind(this),e.setSelectedRecords=this._setSelectedRecords.bind(this),e.clearSelectedRecord=this._clearSelectedRecord.bind(this),e.getSelectedRecord=this._getSelectedRecord.bind(this,e),this._linkDataSetParameterEvents(e,t),e.openDatasetItem=t.openDatasetItem,e.setSelectedRecordIds=this._wrapper.setSelectedRecordIds.bind(this._wrapper),e.getSelectedRecordIds=this._wrapper.getSelectedRecordIds.bind(this._wrapper),e.clearSelectedRecordIds=this._wrapper.clearSelectedRecordIds.bind(this._wrapper);const r={},n=[];e.columns.forEach(e=>{r[e.name]=e,n.push(e.name)}),e.getCellImageInfo=this._getCellConditionalImage.bind(this,e.records,t.loadWebResource,r,n),e.addColumn=this._wrapper.addColumn.bind(this._wrapper),e.retrieveLookupRecordsBySearchString=this._retrieveLookupRecordsBySearchString.bind(this,t),e.retrieveLookupRecordsByIds=this._retrieveLookupRecordsByIds.bind(this,t),this._wrapper.linkPagingAPI(e.paging,t)}_retrieveLookupRecordsBySearchString(e,t,i,r){return e.retrieveLookupRecordsBySearchString(t,i,r)}_retrieveLookupRecordsByIds(e,t,i,r){return e.retrieveLookupRecordsByIds(t,i,r)}_getCellConditionalImage(e,t,i,r,n,a,s){const o=i[n];return e&&e[a]&&o?this._wrapper.getConditionalImage(t,r,e[a],o.imageProviderWebresource,o.imageProviderFunctionName,s):Promise.resolve(null)}_setSelectedRecordId(e,t){return this._wrapper.setSelectedRecordIds([e])}_setSelectedRecords(e){if(this._isNewSelection(e)){if(1===e.length&&this._memoizedLookupWrappers){const t={parentRecordId:e[0],parentRecordEntityTypeName:this.getEntityTypeName()};Object.keys(this._memoizedLookupWrappers).forEach(e=>{const i=this._memoizedLookupWrappers[e];i&&i.setParentRecordContext(t)})}return this._wrapper.setSelectedRecordIds(e)}}_clearSelectedRecord(){this._isNewSelection()&&this._wrapper.clearSelectedRecordIds()}_isNewSelection(e=[]){var t;return!1===Object(_.a)(null!==(t=this._wrapper.getSelectedRecordIds())&&void 0!==t?t:[],e)}_getSelectedRecord(e){return e.records[this._wrapper.getSelectedRecordIds()[0]]}_recordSetValueAPI(e,t,i,r,n,a){return r(n),e(n,a),t.updateControlMemoizedDataSet(this,t,i),Promise.resolve(!0)}generateAdditionalAttributes(){return Promise.resolve(!0)}_linkDataSetParameterEvents(e,t){e.add_OnDataSetRecordChange=this.addOnDataSetRecordChange.bind(this),e.remove_OnDataSetRecordChange=this.removeOnDataSetRecordChange.bind(this),e.addOnDataSetUpdated=this.addOnDataSetUpdated.bind(this),e.removeOnDataSetUpdated=this.removeOnDataSetUpdated.bind(this)}addOnDataSetRecordChange(e){this._recordChangeHandlers.push(e)}removeOnDataSetRecordChange(e){for(let t=0;t<this._recordChangeHandlers.length;t++)this._recordChangeHandlers[t]===e&&this._recordChangeHandlers.splice(t,1)}triggerOnDataSetRecordChange(e){for(const t of this._recordChangeHandlers)t(e)}addOnDataSetUpdated(e){this._dataSetChangeHandlers.push(e)}removeOnDataSetUpdated(e){for(let t=0;t<this._dataSetChangeHandlers.length;t++)this._dataSetChangeHandlers[t]===e&&this._dataSetChangeHandlers.splice(t,1)}triggerOnDataSetUpdated(){for(const e of this._dataSetChangeHandlers)e(this.getLatestData())}_createUpdateResult(e,t,i,r){let n=!0;return r&&Object.keys(r).length&&(n=!1),{resultType:e,recordId:t.getRecordId(),isSuccessful:n,isRecordSavedSuccessfully:n,affectedColumns:i,fieldErrorMessages:r||{},record:t}}resetControlMemoizedDataSet(){this.controlMemoizedLegacyDataSetParameter=null}getLookupDataSet(e,t,i){const r=this._memoizedLookupWrappers[i];return r.resetControlLockedDataSet(),t.retrieveDataSetLookupCellParameter(e,r,this._contextToken).then(e=>(r.linkToParameter(e,t),e))}gridRunOnLoad(e){this._wrapper.gridRunOnLoad(e)}refreshDataSet(e,t,i){return this._wrapper.refreshDataSet(e,t,i).then(()=>this)}ensureDataInitialization(e){return this._initializationActions=e,this._wrapper.ensureDataInitialization(e)}applyDataSetInputs(e){return this._wrapper.applyDataSetInputs(e)}getParameterManifestType(){return this._wrapper.getParameterManifestType()}getEntityTypeName(){return this._wrapper.getEntityTypeName()}getUpdateFlag(){return this._wrapper.getUpdateFlag()}_getExtraTelemetryInfo(){var e,t,i,r,n,a,s;return[{name:"entityTypeName",value:null!==(t=null===(e=this._previousPageInfo)||void 0===e?void 0:e.entityTypeName)&&void 0!==t?t:""},{name:"pageType",value:null!==(r=null===(i=this._previousPageInfo)||void 0===i?void 0:i.pageType)&&void 0!==r?r:""},{name:"CustomControlId",value:null!==(s=null===(a=null===(n=this._previousHostOwnProps)||void 0===n?void 0:n.configuration)||void 0===a?void 0:a.CustomControlId)&&void 0!==s?s:""},{name:"FormId",value:this._previousHostOwnProps&&this._previousHostOwnProps.formInfo?this._previousHostOwnProps.formInfo.FormId:""}]}}},aFKs:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var r=i("izYK"),n=i("errb"),a=i("/A0C");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function s(e,t){switch("number"==typeof t&&(t=t.toString()),t=t.toUpperCase(),e=e.toUpperCase()){case a.a.Boolean.toUpperCase():return r.a.TwoOptions;case a.a.Customer.toUpperCase():return r.a.LookupCustomer;case a.a.DateTime.toUpperCase():return t===n.a.dateTime.toUpperCase()?r.a.DateAndTimeDateAndTime:r.a.DateAndTimeDateOnly;case a.a.Decimal.toUpperCase():return r.a.Decimal;case a.a.Double.toUpperCase():return r.a.FP;case a.a.Integer.toUpperCase():return t===n.a.duration.toUpperCase()||"1"===t?r.a.WholeDuration:t===n.a.language.toUpperCase()||"3"===t?r.a.WholeLanguage:t===n.a.timeZone.toUpperCase()||"2"===t?r.a.WholeTimeZone:r.a.WholeNone;case a.a.Lookup.toUpperCase():return t===n.a.regarding.toUpperCase()?r.a.LookupRegarding:r.a.LookupSimple;case a.a.Memo.toUpperCase():return r.a.Multiple;case a.a.Money.toUpperCase():return r.a.Currency;case a.a.Owner.toUpperCase():return r.a.LookupOwner;case a.a.PartyList.toUpperCase():return r.a.LookupPartyList;case a.a.PickList.toUpperCase():case a.a.Status.toUpperCase():case a.a.State.toUpperCase():return r.a.OptionSet;case a.a.MultiSelectPickList.toUpperCase():return r.a.MultiSelectPicklist;case a.a.String.toUpperCase():return t===n.a.email.toUpperCase()?r.a.SingleLineEmail:t===n.a.phone.toUpperCase()?r.a.SingleLinePhone:t===n.a.text.toUpperCase()?r.a.SingleLineText:t===n.a.textArea.toUpperCase()?r.a.SingleLineTextArea:t===n.a.tickerSymbol.toUpperCase()?r.a.SingleLineTickerSymbol:t===n.a.url.toUpperCase()?r.a.SingleLineURL:r.a.SingleLineText;case a.a.EntityName.toUpperCase():return r.a.EntityNameOptionSet;case a.a.Image.toUpperCase():case a.a.EntityImage.toUpperCase():return r.a.Image;case a.a.File.toUpperCase():return r.a.File;default:return""}}},bZIe:function(e,t,i){"use strict";i.d(t,"b",(function(){return O})),i.d(t,"a",(function(){return P}));var r=i("P6DH"),n=i("SAYH"),a=i("zu1I"),s=i("Nb1E"),o=i("odYE"),l=i("tICD"),c=i("ruPX"),u=i("d0w6"),d=i("a72m"),p=i("9egp"),h=i("BFlg"),g=i("XvLr"),m=i("nzu+"),f=i("YxC/"),b=i("jAuy"),y=i("arV0"),v=i("p/Kg"),S=i("9V+K");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const _=h.N+".saveFilterAsNewPersonalView";function O(e,t){return{type:"save.filter.as.new.peronalview",execute({dispatch:i,getState:h},g){const m=Object(r.kb)(h(),e,t);if(m&&m.ViewId){const f=n.a.parse(m.ViewId),O=h(),w=Object(r.rb)(h(),m.ViewId,e),C=[];C.push({name:"ViewId",value:f.guid}),C.push({name:"dialogName",value:"SaveNewPersonalView"}),C.push({name:"viewType",value:w});const I=Object(y.j)(O,e),E=I&&I.isQueryMode,j=I&&I.isAdvancedFindView,D=new o.a(w,f);return i(Object(s.d)(D,"?$select=layoutxml")).then(s=>{if(s&&s.layoutxml){const o=Object(r.tb)(h(),f,e),y=j?"New view":o.title,O={param_fetchxml:Object(b.k)(Object(r.B)(h(),t,{id:e})),param_layoutxml:Object(r.wb)(h())?Object(S.a)(o.grid):s.layoutxml,param_entityname:m.TargetEntityType,querytype:0,name:y},w={},D=i(Object(a.b)("SaveNewPersonalView",w,O,e));return D.then(t=>{g.EventManager.ReportComponentSuccess(_+".DialogOpened"),0===t.status?i(Object(l.a)(t.pageId)).then(e=>{var r;e.value.param_viewid&&((null==I?void 0:I.pageToEditedViewMapId)&&i(Object(v.c)(null===(r=null==I?void 0:I.pageToEditedViewMapId)||void 0===r?void 0:r.guid,f.guid)),i(Object(d.b)(m.TargetEntityType,u.a.MAIN_APPLICATION_VIEW,!0)).then(()=>{g.EventManager.ReportComponentSuccess(_+".ViewSaved",C);const r={viewId:new n.a(e.value.param_viewid,!1),entityTypeName:m.TargetEntityType,viewType:u.b.userview,isQueryMode:E};i(Object(c.a)(p.a.getName(),r,t.pageId))}))}):1===t.status&&(C.push({name:"Message",value:"Dialog did not load"}),g.EventManager.ReportComponentFailure(_,t.error,null,C),P(i,h(),e))}),D}g.EventManager.ReportComponentFailure(_,"Layout XML is null or undefined",null,C),P(i,h(),e)}).catch(t=>{C.push({name:"Message",value:t.Message}),g.EventManager.ReportComponentFailure(_,"Odata retrieve failed",null,C),P(i,h(),e)})}g.EventManager.ReportComponentFailure(_,"selected View is null",null,null),P(i,h(),e)}}}function P(e,t,i){const r=Object(f.b)(t,g.GRID_CONTROL_LOAD_ERROR);e(Object(m.a)(r,{},i))}},d0Pd:function(e,t,i){"use strict";i.d(t,"a",(function(){return E}));var r=i("3/02"),n=i("SAYH"),a=i("eXjw"),s=i("j2fa"),o=i("dQnL"),l=i("CngE"),c=i("GEBM"),u=i("0L4T"),d=i("FZDd"),p=i("EY5k"),h=i("a72m"),g=i("YxC/"),m=i("KBcj"),f=i("p/2N"),b=i("16wZ"),y=i("K3gL"),v=i("ngeo"),S=i("504W"),_=i("95wm"),O=i("haag"),P=i("3hnk");function w(e,t,i){return{type:"chartData.retrieve.preReq_async",execute({dispatch:r,getState:w},C){let I=w();const E=O.b+".chartData.retrieve.preReq_async",j=e.visualizationId,D=e.viewId;return r(Object(h.a)(t,void 0,e.viewType,D)).then(()=>{I=w();const h=Object(m.c)(I,D);if(!function(e,t,r,n){if(!r||!r.fetchXML)return Object(u.a)(e,t,Object(g.b)(e,c.f),n,i),!1;return!0}(I,r,h,e))return null;const b=r(Object(o.a)(t,e.visualizationType,j)),v=r(Object(p.e)(c.z));return Promise.all([b,v]).then(()=>{I=w();const o=Object(l.a)(I,j);if(function(e){if(e&&e.WebResourceId)return!0;return!1}(o))return Object(s.d)(I,r,n.a.toString(e.visualizationId),n.a.toString(e.viewId),i),e;if(!function(e,t,r,n){if(r){if(r.initialized===a.a.Error){const a=Object(y.a)(r.errorCode)||c.t;return t(Object(p.e)([a])).then(()=>{const r=Object(g.b)(e,a);Object(u.a)(e,t,r,n,i)},()=>{Object(u.a)(e,t,Object(g.b)(e,c.t),n,i)}),!1}return!!r.DataDescription||(Object(u.a)(e,t,Object(g.b)(e,c.n),n,i),!1)}return!1}(I,r,o,e))return null;e.initialized||(e.initialize(o.DataDescription,h.fetchXML,o.PresentationDescription,h.title,h.entityLogicalName,o.Name,o.PrimaryEntityTypeCode,!1),e.setupAggregationQueries());const m={},b=e.dataDefinition.allAttributeNamesByEntity;Array.from(b.keys()).map(e=>{const t=Array.from(b.get(e).keys());m[e]=t});const v=Object(f.c)(h).filter(e=>-1===e.indexOf("."));if(v&&v.length>0){const e=h.entityLogicalName;e in m?m[e].push(...v):m[e]=v}try{const e=o.PresentationDescription,t=Object(_.a)(e);if(!Object(S.b)(e)&&t.length>0){const e=h.entityLogicalName,i=[];i.push(function(e,t){const i=t[2]?t[2].toLowerCase():"";if(i.substring(0,e.length)!==e)return"";return i.substring(e.length+1,i.length)}(e,t)),e in m?m[e].push(...i):m[e]=i}}catch(e){const t="Failed to retrieve entity metadata attributes for Chart Series with error : "+e.message;C.EventManager.ReportComponentFailure(E,Error(t))}return r(Object(d.e)(m)).then(()=>Object(P.g)(w(),t,2,0)?e:(Object(u.b)(-2147220960,w(),r,Object(g.b)(w(),c.p),e,i),null))},t=>(Object(u.b)(t.getNegativeErrorCode(),w(),r,Object(g.b)(w(),c.p),e,i),null))},t=>{const n=t&&!Object(b.a)(t.errorCode)&&t.errorCode,a=Object(y.a)(n),s=a?Object(g.b)(I,a):"retrieve chart failed. error code: "+v.a.getHexErrorCodeFromInt(n);return Object(u.a)(I,r,s,e,i),null})}}}var C=i("Tezb"),I=i("Lyxw");function E(e,t,i,o=!1){return{type:"chartData.retrieve.async",execute({dispatch:c,getState:u},d){const p=[];try{p.push({name:O.g,value:n.a.toString(e.viewId)}),p.push({name:O.h,value:n.a.toString(e.visualizationId)});const h=u(),g=e.visualizationId,m=n.a.toString(g),f=e.viewId,b=n.a.toString(f);if(!Object(_.b)(u,c,d,p,e,t,i))return Promise.resolve();let y;const v=Object(I.f)(h,r.wg);return y=v?Object(l.e)(h,e.getStorageKey()):Object(l.d)(h,m,b),(y===a.a.Initialized&&Object(l.b)(h,m,b)||y===a.a.Initializing)&&!o?Promise.resolve():(c(v?Object(_.d)(e.getStorageKey(),C.c):Object(_.c)(m,b,C.c)),c(w(e,t,i)).then(e=>{if(!e||e.isWebResourceChart)return;const r=e;return c(Object(s.b)(r,t,i))}))}catch(e){return d.EventManager.ReportComponentFailure(_.f+".retrieveChartData",Error(e),O.b,p),Promise.reject(e)}}}}},eDSk:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var r=i("mMyr"),n=i("223Y"),a=i("BFlg"),s=i("7p56");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function o(e,t,i){if(null==i?void 0:i.dataSetUIOptions){const n=e+t.id;let o=t.contextString;switch(t.contextString){case a.o.ASSOCIATEDGRID:case a.o.SUBGRID:case a.o.GRID:break;case a.o.CUSTOM:default:o=a.o.CUSTOM}return r.createElement(s.a,{key:n,id:t.id,systemDefinedProperties:t.systemDefinedProperties,controlId:t.controlId,configuration:t.configuration,descriptor:t.descriptor,formInfo:t.formInfo,themingData:t.themingData,parentDefinedControlProps:t.parentDefinedControlProps,children:t.children,rowSpan:t.rowSpan,contextString:o,parentContextToken:t.parentContextToken,dataSetUIOptions:i.dataSetUIOptions})}return r.createElement(n.c,{key:e,id:t.id,systemDefinedProperties:t.systemDefinedProperties,controlId:t.controlId,configuration:t.configuration,descriptor:t.descriptor,formInfo:t.formInfo,themingData:t.themingData,parentDefinedControlProps:t.parentDefinedControlProps,children:t.children,rowSpan:t.rowSpan,contextString:t.contextString,parentContextToken:t.parentContextToken})}},fSnw:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var r=i("r0As"),n=i("kSDG"),a=i("yTPE");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class s extends a.a{setupAggregationQueries(){if(!this.initialized)throw new Error("ChartDataSetQueryDecorator has not been initialized.");if(this.isWebResourceChart)return;this.dataDefinition.buildCategory();const e=this.viewDefinition;if(!this.dataDefinition.isOrderPresent()&&e.orderByAttributes.length>0){const t=e.orderByAttributes[0],i=this.dataDefinition.entityExpression;if(i.hasAggregate)for(let e=0;e<i.groupByAttributes.length;e++){const a=i.groupByAttributes[e];if(a.attributeName===t.name){Object(r.h)(i,Object(n.a)(a.attributeName,a.aliasName,i),!0,t.descending,-1);break}}else Object(r.h)(i,Object(n.a)(t.name,t.aliasName,i),!1,t.descending,-1)}Object(r.i)(this.dataDefinition.entityExpression)}}},fyfl:function(e,t,i){"use strict";i.d(t,"a",(function(){return p})),i.d(t,"b",(function(){return d}));var r=i("SAYH"),n=i("FZDd"),a=i("d0w6"),s=i("Uv1Y"),o=i("a72m"),l=i("BFlg"),c=i("kKLx"),u=i("P6DH");function d(e,t,i){return{type:"datasethost.dependencies.retrieve.async",execute({dispatch:d,getState:h},g){const m=g.TraceManager.getTracer(l.P),f=l.N+".loadDataSetHostDependenciesAction";m.info(`Retrieving view with ID ${r.a.toString(t)} for ${e} entity.`);const b=Object(u.sb)(h(),e,t);return d(Object(o.a)(e,a.a.MAIN_APPLICATION_VIEW,b,t,void 0,!0)).then(a=>{if(!a){const i=`Unable to retrieve DataSetHost dependencies for the grid. Failed to retrieve view with ID ${r.a.toString(t)} for ${e}`;throw g.EventManager.ReportComponentFailure(f,Error(i)),new s.a(c.b)}const o=p(h(),t,i);return d(Object(n.e)(o)).then(()=>{const i=[{name:"entityTypeName",value:e},{name:"viewId",value:r.a.toString(t)}];g.EventManager.ReportComponentSuccess(f,i)}).catch(i=>{let n=[];for(const e in o)o[e].length&&(n=[...o[e],...n]);const a=`Unable to retrieve DataSetHost dependencies for the grid for view with ID ${r.a.toString(t)}. Failed to retrieve entity with attributes ${n.join()} for ${e}`;throw g.EventManager.ReportComponentFailure(f,Error(a)),new s.a(c.a)})})}}}function p(e,t,i){const r=Object(u.tb)(e,t,i),n={};if(r&&r.grid&&r.grid.rows&&r.grid.rows[0]&&r.grid.rows[0].cells){const e=[];r.grid.rows[0].cells.forEach(t=>{if(!t.disableMetaDataBinding)if(t.relatedEntityName){if(t.name&&-1!==t.name.indexOf(".")){const e=t.name.split(".")[1];n[t.relatedEntityName]||(n[t.relatedEntityName]=[]),-1===n[t.relatedEntityName].indexOf(e)&&e&&n[t.relatedEntityName].push(e)}}else-1===e.indexOf(t.name)&&e.push(t.name)}),e.length>0&&(n[r.entityLogicalName]=e)}return n}},iWfp:function(e,t,i){"use strict";i.d(t,"b",(function(){return s})),i.d(t,"a",(function(){return o}));var r=i("mMyr"),n=i("Gilj"),a=i("FhVi");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function s(e,t,i,r,a,s){return new n.a(e,e=>{t(e.EVENT)},i,r,a,s)}function o(e){return r.createElement(a.a,{key:e.id,keyboardShortcuts:e.keyboardShortcuts,defaultFocusId:e.defaultFocusId,rootElementId:e.rootElementId,isModal:e.isModal,shouldManageFocus:e.shouldManageFocus||!1})}},j9v9:function(e,t,i){"use strict";i.d(t,"a",(function(){return b}));var r=i("7fV9"),n=i("SAYH"),a=i("d0w6"),s=i("izYK"),o=i("5ZBI"),l=i("pGYJ"),c=i("JwRZ"),u=i("DU5H"),d=i("KBcj"),p=i("5ipV"),h=i("Uv1Y"),g=i("LbMF"),m=i("YxC/");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const f=l.a+".Models.Lookups.MultiEntityTypeLookupInternalDataSetWrapper";class b extends r.a{constructor(e,t,i,r,n){super(t,null,i),this._previousAvailableViewIds=null,this._previousAvailableViews=null,this._selectedViewName=null,this.refreshDataSet=this.refreshDataSet.bind(this),this.ensureViewId=this.ensureViewId.bind(this),this.dataSetClass=3,this.targetEntity=e,this._viewId=r,this._viewType=n||a.b.savedview}_retrieveParameterDefinition(e,t,i){return Object.assign(Object.assign({},this.previousDataSetDefinition),{Type:s.a.Grid,ViewId:t,TargetEntityType:e,ExtraFilters:i})}ensureViewId(e,t){return this.shouldUseLookupService()&&!this._viewId?(this._viewId=this.lookupViewId,Promise.resolve(this._viewId)):e(this.targetEntity,a.a.LOOKUP_VIEW,this._viewType,void 0,void 0,void 0,!0).then(i=>{const r=n.a.toString(i);if(this._viewId&&r!==this._viewId){const i=e(this.targetEntity,a.a.LOOKUP_VIEW,this._viewType,new n.a(this._viewId),void 0,void 0,!0).then(e=>!!t||this._viewId).catch(e=>(o.a.error(l.a+": ensureViewId encountered error, "+e),this.setErrorStatus(e),!1));return t?Promise.resolve(!0):i}return this._viewId=r,!!t||this._viewId}).catch(e=>(o.a.error(l.a+": ensureViewId encountered error, "+e,[{name:"APIName",value:f}]),this.setErrorStatus(e),!1))}setErrorStatus(e,t){let i=e;const n=this.relevantQueryError();n&&t&&"function"==typeof t&&(i=Object(m.b)(t(),n.message),i?n.parameter&&(i+=" "+n.parameter):i=r.a.UnknownErrorMessage),super.setErrorStatus(i,t)}refreshDataSet(e,t,i){let r=null;const n=this.getEntityTypeName()||this.targetEntity;this.shouldUseLookupService()&&(this.lookupServiceEnabled=!1);try{t.startCustomFilter(this._pageId,this._controlName,this.contextToken),t.runPreSearch(this._pageId,this._controlName),t.runSetAdditionalParams(this._pageId,this._controlName),t.endCustomFilter(this._pageId,this._controlName,this.contextToken)}catch(e){}if(this.lookupCustomFilters=Object(u.a)(e(),this._pageId,this.contextToken,this.controlId,n),this.meFilterEnabled&&(Object(g.a)(e(),n,"ownerid")?this.lookupCustomFilters.push(c.a):r=t.getEntityMetadataAction(n,["ownerid"])),this.shouldUseQuickFindViewForLookup(e())){const e=this.filteringObj&&this.filteringObj.getFilter();this.lookupFilterString=e&&e.conditions&&e.conditions[0]&&e.conditions[0].value,this.lookupFilterString=this.lookupFilterString&&this.lookupFilterString.replace(/%$/g,"").replace(/\%/g,"*")}return this.ensureViewId(t.retrieveViewAction).then(()=>(super.updatePreviousDataSetParameterDefinition(this._retrieveParameterDefinition(this.targetEntity,this._viewId,this._passInConfigExtraFilters)),this.meFilterEnabled&&r?r.then(()=>(Object(g.a)(e(),n,"ownerid")&&this.lookupCustomFilters.push(c.a),super.refreshDataSet(e,t,i))):super.refreshDataSet(e,t,i)))}linkToParameter(e,t){super.linkToParameter(e,t),e.generateAdditionalAttributes=this.ensureViewId.bind(this,t.retrieveViewAction,!0)}retrieveDataSetObject(e,t,i,r){if(this._pageId=t.id,this._controlName=Object(c.v)(t),i&&i.Parameters){const e=i.Parameters.value;if(this._passInConfigExtraFilters=[],e){this._controlName=this._controlName||e.Value,e.ExtraFilters&&(this._passInConfigExtraFilters=this._passInConfigExtraFilters.concat(e.ExtraFilters));const t=e.AdditionalTargetExtraFilters;t&&t.hasOwnProperty(this.targetEntity)&&(this._passInConfigExtraFilters=this._passInConfigExtraFilters.concat(t[this.targetEntity].slice(0)))}}const n=Object.assign(Object.assign({},i.Parameters[super.getPropKey()]),this._retrieveParameterDefinition(this.targetEntity,this._viewId,this._passInConfigExtraFilters)),a=Object.assign(Object.assign({},i),{Parameters:Object.assign(Object.assign({},i.Parameters),{[super.getPropKey()]:n})}),s=Object.assign(Object.assign({},t),{configuration:a}),o=super.retrieveDataSetObject(e,s,a,r);return this._updateAvailableViewIds(i,r,e,o),o}getPagingObject(){return this.pagingObj}updatePagingObject(){this.pagingObj.getHasNextPage()&&this.pagingObj.setPageLastIndex(this.pagingObj.getPageLastIndex()+1)}setViewId(e){this._viewId=e}updatePreviousOwnProps(e){this.previousOwnProps=e,this._pageId=e.id,this._controlName=Object(c.v)(e)}getRelationshipNameFromParameter(e){if(!e)return null;return e.FilterRelationshipName}_updateAvailableViewIds(e,t,i,r){let a=!1;const s=this._previousAvailableViewIds?this._previousAvailableViewIds.join():null,o=e.Parameters[this.getPropKey()],l=this.createLookupParameter(r,o),c=t;let u=null;const p=c&&c.viewIds&&c.viewIds.length>0?c.viewIds.join():null;if(p&&s!==p?(u=c.viewIds,a=!0):o.AvailableViewIds&&s!==o.AvailableViewIds&&(u=o.AvailableViewIds.split(","),a=!0),a){this._previousAvailableViews=[],u.forEach(e=>{const t=Object(d.c)(i,new n.a(e));t&&this._previousAvailableViews.push(t)}),this._previousAvailableViewIds=u.map(e=>e.replace(/[\{\}]/gi,"").toLocaleLowerCase()),l.selectView=e=>{this._selectedViewName=e},l.availableViewNames=[];for(let e=0,t=this._previousAvailableViews.length;e<t;e++)this._previousAvailableViews[e]?l.availableViewNames.push(this._previousAvailableViews[e].title):l.availableViewNames.push("Unknown View")}}createLookupParameter(e,t){const i=new p.a(e,e.getViewId(),e.getTitle(),e.getTargetEntityType());return i.allowFilterOff=!!t.AllowFilterOff,i.disableQuickFind=!!t.DisableQuickFind,i.useMainFormDialogForCreate=!!t.UseMainFormDialogForCreate,i.useMainFormDialogForEdit=!!t.UseMainFormDialogForEdit,i.enableViewPicker=!1!==t.EnableViewPicker,i.targetEntityType=t.TargetEntityType,i.setMyRecordsOnlyFilter=this.setMyRecordsOnlyFilter.bind(this),i}retrieveView(e,t){let i;return this.previousDataSetDefinition&&this.previousDataSetDefinition.TargetEntityType?i=this.previousDataSetDefinition.TargetEntityType:this.previousDataSetDefinition&&this.previousDataSetDefinition.EntityName&&(i=this.previousDataSetDefinition.EntityName),i?t(i,a.a.LOOKUP_VIEW,a.b.savedview,e):(o.a.error(l.a+": retrieveView encountered error, Entity name is not specified for lookup",[{name:"APIName",value:l.a+".Models.Lookups.LookupSimpleObjectWrapper.retrieveView"}]),Promise.reject(new h.a("Entity name is not specified for lookup")))}getAvailableViews(){return this._previousAvailableViewIds||[]}getMissingDescriptorIds(){const e=[],t=this._previousAvailableViewIds?this._previousAvailableViewIds:[];for(let i=0;i<t.length;i++)this._previousAvailableViews&&0!==this._previousAvailableViews.length&&0!==this._previousAvailableViews.filter(e=>e.viewId&&e.viewId.guid===t[i]).length||e.push(new n.a(t[i]));return e}retrieveCurrentView(e,t){if(null!==this._previousAvailableViews&&null!==this._selectedViewName)for(let e=0,t=this._previousAvailableViews.length;e<t;e++)if(this._previousAvailableViews[e]&&this._previousAvailableViews[e].title===this._selectedViewName)return Promise.resolve(this._previousAvailableViews[e]);return super.retrieveCurrentView(e,t)}}},jsFU:function(e,t,i){"use strict";i.d(t,"b",(function(){return s})),i.d(t,"a",(function(){return a}));var r=i("BFlg"),n=i("jq7Z");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const a="control.update.formlessControlOutputs";function s(e,t,i){return{type:"control.update.formlessControlOutputs.async",execute({dispatch:s,getState:o},l){const c=l.TraceManager.getTracer(r.P),u=r.N+".formlessControlOutputsIdAction";try{if(!Object.keys(i).length)return Promise.resolve();const r=o(),d=Object(n.a)(r,e),p=Object.assign({},d.formlessControlOutputs);let h=!1;c.info("Updating the unbound output.");for(const e in i){const r=i[e],n=t+"."+e;p[n]!==r&&(p[n]=r,h=!0)}return h&&s(function(e,t){return{type:a,payload:{formlessControlOutputs:t},meta:{pageId:e}}}(e,p)),l.EventManager.ReportComponentSuccess(u),Promise.resolve()}catch(e){const t="Updating the outbound outputs for the grid failed with error : "+e.message;l.EventManager.ReportComponentFailure(u,Error(t))}}}}},kC0I:function(e,t,i){"use strict";i.d(t,"k",(function(){return ve})),i.d(t,"i",(function(){return oe})),i.d(t,"e",(function(){return le})),i.d(t,"f",(function(){return me})),i.d(t,"g",(function(){return ge})),i.d(t,"d",(function(){return ce})),i.d(t,"h",(function(){return fe})),i.d(t,"j",(function(){return _e})),i.d(t,"c",(function(){return de})),i.d(t,"a",(function(){return ye})),i.d(t,"b",(function(){return be}));var r=i("SAYH"),n=i("eOoD"),a=i("w1eR"),s=i("eXjw"),o=i("3mEc"),l=i("g03H"),c=i("jRy5"),u=i("ILmX"),d=i("d0w6"),p=i("iZ7K"),h=i("IqkD"),g=i("NjDY"),m=i("YxC/"),f=i("KBcj"),b=i("BzGi"),y=i("BFlg"),v=i("P6DH"),S=i("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function _(){let e=null,t=null,i=null;return(r,n)=>{const a=n.parentContextToken,s=n.contextString,o=function(e,t){const i=t.parentContextToken;switch(t.contextString){case y.o.ASSOCIATEDGRID:const r=Object(v.jb)(e,t,i);return S.a(i,r.relationshipName,r.ordinal);case y.o.SUBGRID:if(t.descriptor&&t.descriptor.StreamId)return S.p(i,t.descriptor.Name,t.descriptor.StreamId,!!t.descriptor.IsTile);const n=S.q(i,t.descriptor.Name),a=n&&n.parentContextToken?n.parentContextToken.entityTypeName:null;return n.relationshipType=de(e,t,a,n),n;case y.o.GRID:return S.l(e,t.id);case y.o.CUSTOM:return S.c(i,t.controlId);default:return i}}(r,n);return(i!==s||O(e,o)||O(t,a))&&(e=o,t=a,i=s),e}}function O(e,t){return e&&t?e.entityTypeName!==t.entityTypeName||e.controlName!==t.controlName||(e.formId&&e.formId.guid)!==(t.formId&&t.formId.guid)||(e.recordId&&e.recordId.guid)!==(t.recordId&&t.recordId.guid)||e.relationshipName!==t.relationshipName||e.roleOrd!==t.roleOrd:e!==t}var P=i("5O6t"),w=i("XvLr"),C=i("LzVy"),I=i("sclX"),E=i("unFF"),j=i("GYEz"),D=i("o0iw"),T=i("504W"),F=i("3hnk"),N=i("sZ+8"),R=i("69Qu"),k=i("3/02"),A=i("Lyxw"),M=i("kt5S"),x=i("jAuy"),L=i("arV0"),V=i("pEXn"),B=i("5R5s"),z=i("2SCk"),U=i("85o3"),W=i("lEp6"),G=i("YPtO"),q=i("0kGT"),H=i("Z/4N"),Q=i("nIfK"),K=i("8nT0"),X=i("CbNq"),Y=i("7+p5"),J=i("37s6"),$=i("LbMF"),Z=i("SJlc"),ee=i("AVDU"),te=i("H4dV"),ie=i("2YQW"),re=i("4leG"),ne=i("HRnw"),ae=i("E5IU"),se=i("DD48");function oe(e){return e===y.o.SUBGRID}function le(e){return e===y.o.GRID}function ce(e){return e===y.o.ASSOCIATEDGRID}function ue(e){switch(e){case y.o.ASSOCIATEDGRID:case y.o.SUBGRID:return"div";case y.o.GRID:default:return"section"}}function de(e,t,i,r){let n=i?Object(p.K)(e,i,r.relationshipName):null;if(null===n&&t.descriptor&&t.descriptor.Parameters){const r=t.descriptor.Parameters[y.W.RELATIONSHIP_NAME],a=t.descriptor.Parameters[y.W.TARGET_ENTITY_TYPE];r&&i?n=Object(p.K)(e,i,r):r&&a&&(n=Object(p.K)(e,a,r))}return n}function pe(){let e=null,t=null;return i=>(e!==i.contextString&&(e=i.contextString,t=function(e){switch(e.contextString){case y.o.ASSOCIATEDGRID:case y.o.SUBGRID:return[d.a.SUB_GRID,d.a.MAIN_APPLICATION_VIEW];case y.o.GRID:return e.isAdvancedFindView?[d.a.ADVANCED_SEARCH]:[d.a.MAIN_APPLICATION_VIEW];default:return[d.a.MAIN_APPLICATION_VIEW]}}(i)),t)}function he(e){return e&&[e.CustomControlId,e.Name].some(e=>-1!==Q.a.indexOf(e))}function ge(e){return(null==e?void 0:e.CustomControlId)===y.C||(null==e?void 0:e.Name)===y.C}function me(e){return(null==e?void 0:e.CustomControlId)===y.y||(null==e?void 0:e.Name)===y.y}function fe(e){return(null==e?void 0:e.CustomControlId)===y.I||(null==e?void 0:e.Name)===y.I}function be(e,t,i){if(!e||!e.contextTokenType||e.contextTokenType!==c.a.AssociatedGrid&&e.contextTokenType!==c.a.MainGrid)return null;switch(t){case"displayChart":return!1;case"displayCommandBar":return!0;case"displayIndex":return!(ge(i)||me(i)||fe(i))&&he(i);case"displayQuickFind":case"displayViewSelector":return!0}return null}function ye(){let e=null,t=null;return(i,r,n)=>{if(e&&t===r.CustomControlId)return e;const a=r&&r.CustomControlId?r.CustomControlId:null;if(!a)return null;const s=Object(v.db)(i,a),o=Object(H.e)(i,a);if(s&&o&&o.Properties.DataSetDefinitions&&o.Properties.DataSetDefinitions[s]&&o.Properties.DataSetDefinitions[s].CDSDataSetOptions){const i=o.Properties.DataSetDefinitions[s].CDSDataSetOptions;e={displayChart:i.hasOwnProperty("displayChart")?i.displayChart:be(n,"displayChart",r),displayCommandBar:i.hasOwnProperty("displayCommandBar")?i.displayCommandBar:be(n,"displayCommandBar",r),displayIndex:i.hasOwnProperty("displayIndex")?i.displayIndex:be(n,"displayIndex",r),displayQuickFind:i.hasOwnProperty("displayQuickFind")?i.displayQuickFind:be(n,"displayQuickFind",r),displayViewSelector:i.hasOwnProperty("displayViewSelector")?i.displayViewSelector:be(n,"displayViewSelector",r)},t=r.CustomControlId}return e}}function ve(){let e,t=null,i=null,S=null,O=null,z="",Q=null,fe=null,be=null,ye=null,ve=null,we=null,Ce=null,Ie=null,Ee=null;const je=function(){let e=null;return(t,i,r,n)=>{let a=e;switch(Object(T.b)(n)&&(n=i.contextString),n){case y.o.ASSOCIATEDGRID:a=Object(u.b)(r);break;case y.o.SUBGRID:a=Object(u.m)(r);break;case y.o.GRID:default:a=Object(u.i)(r)}return a!==e&&(e=a),e}}(),De=Object(P.a)(),Te=_(),Fe=function(){let e=null;const t=function(){let e=null;return(t,i,n)=>{let s,o,c,u,d;if(Object(v.lb)(t,i.id,n)){s=Object(v.V)(t,i.id,n);const e=Object(v.tb)(t,s,i.id);o=e&&e.entityLogicalName,d=e&&e.isUserView,c=Object(v.r)(t,i.id,n,o),u=Object(v.s)(t,i.id,n)!==b.a.savedvisualization}else{const e=Object(v.db)(t,i.configuration.CustomControlId);if(e){const t=i.configuration.Parameters[e];t&&(s=t.ViewId&&new r.a(t.ViewId),o=t.TargetEntityType,c=t.VisualizationId&&new r.a(t.VisualizationId),u=!(!t.IsUserChart||"true"!==t.IsUserChart),d=!(!t.IsUserView||"true"!==t.IsUserView))}}if(!r.a.isNullOrEmpty(s)&&c&&o){const p=Object(v.q)(t,i.id,n),h=Object(v.p)(t,i.id,n),g=Object(v.D)(t,i.id,n),m=Se(t,i,n,g,!0),f=Object(v.P)(t,i.id,n),b=t.user&&t.user.userId,S=Object(A.f)(t,k.ag),_=Object(B.a)(o,b,n,S),O=_&&_.getFilterAndLinkedEntities(g&&g.activityOrQueueFilterValue?g.activityOrQueueFilterValue:void 0),P=O&&null!==O.linkEntities?JSON.stringify(O.linkEntities):null,w=Object(A.f)(t,k.eh),C=!w||w&&Object(j.a)(t)===a.a.MobileApplication,I=w,E=ce(i.contextString)?Object(l.r)(y.d,o,r.a.toString(s),r.a.toString(c),n.relationshipName,f,u,d,m,P,I,Object(v.X)(t,i.id,n)):Object(l.v)(y.d,o,r.a.toString(s),r.a.toString(c),f,p,u,h,d,m,P,C,I,Object(v.X)(t,i.id,n),Object(re.d)(t));if(e){const i=E&&E.CustomControlId?E.CustomControlId:null,r=Object(v.db)(t,i);if(r&&E.Parameters[r]){const t=E.Parameters[r],i=e.Parameters[r];t.ViewId===i.ViewId&&t.VisualizationId===i.VisualizationId&&t.EntityName===i.EntityName&&t.HighchartFilterExpression===i.HighchartFilterExpression&&t.ChartDrillDownParameters===i.ChartDrillDownParameters&&t.ExtraFilters===i.ExtraFilters||(e=E)}}else e=E}else if(e&&o&&!c){const i=e.CustomControlId,r=Object(v.db)(t,i);r&&e.Parameters[r]&&o!==e.Parameters[r].EntityName&&(e=null)}return e}}();return(i,r,n)=>{const a=t(i,r,n),s=r.id,o=Object(v.X)(i,r.id,n);return e&&e.configuration===a&&e.id===s||(e={configuration:a,id:s,chartId:y.d,showChart:!0,isChartOnTheRightSide:o,contextToken:n}),e}}(),Ne=function(){let e=null;return(t,i,r,n,a,s)=>{const o=s.commandBarStyle,l=i.id,c=de(t,i,r&&r.parentContextToken?r.parentContextToken.entityTypeName:null,r),u=Object(v.w)(t,l,r);return e&&e.commandManagerId===u&&e.pageId===l&&e.ribbonId===a&&e.relationshipType===c&&e.contextToken===r&&e.style===o||(e={commandManagerId:u,pageId:l,ribbonId:a,relationshipType:c,contextToken:r,style:o}),e}}(),Re=function(){let e=null;const t=pe();return(i,n,a,s,o,l)=>{var c;const u=l.viewSelectorStyle,p=r.a.toString(o),g=t(n),m=Object(v.qb)(n.id,p),b=le(n.contextString),y=b,S=n.contextString,_=Object(v.cb)(i),O=Object(h.g)(i),P=Object(v.tb)(i,o,n.id),w=P?P.title:null;let C=d.a.MAIN_APPLICATION_VIEW;oe(S)?C=d.a.SUB_GRID:b&&n.isAdvancedFindView&&(C=d.a.ADVANCED_SEARCH);const I=Object(f.a)(i,s,C),E=I||r.a.EMPTY,j=Object(L.j)(i,null==n?void 0:n.id),D=Object(v.ub)(i,null===(c=null==j?void 0:j.pageToEditedViewMapId)||void 0===c?void 0:c.guid,null==o?void 0:o.guid),T=n.canUserCreatePersonalView,F=n.canUserUpdatePersonalView,N=n.canUserManageAndShareView,R=n.personalViewEditingEnabled,k=n.isCurrentViewEdited,A=!!D||k;return e&&e.id===m&&e.entityTypeName===s&&e.selectedViewId===p&&e.queryViewSelectorTypes===g&&e.shouldDisplayNestedViewSelector===y&&e.isRTL===O&&e.defaultViewId===E&&e.isEdited===A&&e.canUserCreatePersonalView===T&&e.canUserUpdatePersonalView===F&&e.canUserManageAndShareView===N&&e.personalViewEditingEnabled===R||(e={id:m,pageId:n.id,title:w,entityTypeName:s,selectedViewId:p,style:u,queryViewSelectorTypes:g,shouldDisplayNestedViewSelector:y,contextString:S,pinnedActivityView:_,isRTL:O,defaultViewId:E,isAdvancedFindView:n.isQueryMode&&n.isAdvancedFindView,isEdited:k,pageToEditedViewMapId:null==j?void 0:j.pageToEditedViewMapId,contextToken:a,canUserCreatePersonalView:T,canUserUpdatePersonalView:F,canUserManageAndShareView:N,personalViewEditingEnabled:R}),e}}(),ke=function(){let e=null;return(t,i,r,n,a)=>{const s=i.id,o=Object(v.I)(t,i),l=Object(h.x)(t),c=a.filterComboStyle,u=Object(L.j)(t,s).entityFilterValue;return e&&e.id===s&&e.entityTypeName===n&&e.filterOptions===o&&e.comboBoxStyle===c&&e.userSetting===l&&u===e.previousValue||(e={id:s,filterOptions:o,entityTypeName:n,updateFilterValue:null,onFilterChange:null,resourceStrings:null,userSetting:l,style:null,comboBoxStyle:c,previousValue:u}),e}}(),Ae=function(){let e=null;return(t,i,r,n,a)=>{const s=i.id,o=Object(v.I)(t,i,n),l=Object(X.a)(t),c=a.filterComboStyle,u=a.dueDateComboBoxStyles,d=a.activityTypeComboBoxStyles,p=Object(x.h)(t,r.relationshipName,ce(i.contextString)),g=!Object(R.c)(t),m=Object(v.nb)(t,s,r),f=Object(h.g)(t),b=Object(E.a)(t),y=Object(L.j)(t,s),S=y.entityFilterValue,_=y.activityTypeFilterValue,O=Object(A.f)(t,k.b),P=Object(A.e)(t,k.b,k.jf),C=Object(v.xb)(t,n),I=Object(A.f)(t,k.ag),j=Object(B.a)(n,t.user.userId,r,I,C),D=j&&j.getFilterLabelResourceKey(),T=w.ACTIVITY_MGMT_ACTIVITY_TYPE_LABEL,F=w.ACTIVITY_MGMT_DUE_DATE_LABEL;if(!e||e.id!==s||e.entityTypeName!==n||e.filterOptions!==o||e.comboBoxStyle!==c||e.dueDatecomboBoxStyle!==u||e.activityTypecomboBoxStyle!==d||e.labelStyle!==a.filterLabelStyle||e.activityMgmtLabelStyle!==a.activityMgmtLabelStyle||e.isActivityManagementFeatureEnabled!==O||e.filterOptionsForActivityType!==l||e.isRollupViewSupported!==p||e.isOffline!==g||e.toggleValue!==m||e.isRTL!==f||e.theme!==b||e.previousValue!==S||e.activityTypePreviousValues!==_||e.isActivityFilterSelectAllEnabled!==P||e.entityIsActivityType!==C){const t={isRollupViewSupported:p,isOffline:g,toggleValue:m,onToggleChange:null,isRTL:f,theme:b};e=Object.assign({id:s,filterOptions:o,filterOptionsForActivityType:l,entityTypeName:n,onFilterChange:null,onActivityTypeChange:null,onActivityTypeFilterClear:null,gridEntityName:null,resourceStrings:null,comboBoxStyle:c,dueDatecomboBoxStyle:u,activityTypecomboBoxStyle:d,containerStyle:null,activityTypeContainerStyle:null,labelStyle:a.filterLabelStyle,activityMgmtLabelStyle:a.activityMgmtLabelStyle,previousValue:S,activityTypePreviousValues:_,isActivityManagementFeatureEnabled:O,activityViewContainerStyle:a.activityViewContainerStyle,entityFilterLabelResourceString:D,activityTypeFilterLabelResourceString:T,dueDateFilterLabelResourceString:F,isActivityFilterSelectAllEnabled:P,isRTL:f,entityIsActivityType:C},t)}return e}}(),Me=function(){let e=null;const t=[1041,2052,3076,1028,1042];return(i,r,n,a,s,o)=>{const l=i.id,c=i.descriptor&&i.descriptor.Id?i.descriptor.Id:null,u=s?JSON.parse(s).conditions[0]:null,d=function(e,t){if(t=t?t.value.replace("%","").toUpperCase():null,e){const i=_e(e.split(",")[0]),r=i[1].split("|");if(r&&t===r[0])return i[1]}return t}(Object(m.c)(o,w.JUMPBAR_ALPHABET),u);return t.indexOf(a)>-1?e=null:e&&e.id===l&&e.contextToken===r&&e.entityTypeName===n&&e.selectedFilter===d||(e={id:l,uniqueId:c,contextToken:r,entityTypeName:n,selectedFilter:d,languageId:a}),e}}(),xe=function(){let e=null;return(t,i,r,n,a)=>{const{id:s,contextString:o}=t;return e&&e.id===s&&e.contextToken===i&&e.entityTypeName===r&&e.entityDisplayName===n&&e.gridInput===a||(e={id:s,contextToken:i,entityTypeName:r,entityDisplayName:n,contextString:o,gridInput:a}),e}}(),Le=function(){let e=null;return(t,i,r)=>{const{id:n,contextString:a}=t;return e&&e.id===n&&e.contextToken===i||(e={id:n,contextToken:i,contextString:a}),e}}(),Ve=Object(m.h)(),Be=function(){let e=null,t=null;const i={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1},r={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1};let s=null;const o={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1},l={Type:"WholeNumber.None",Usage:1,Static:!0,Value:!1,Primary:!1},c={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1},u={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1},d={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1},p={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1},h={Type:"TwoOptions",Usage:1,Static:!0,Value:!1,Primary:!1},m={Type:"TwoOptions",Usage:1,Static:!0,Value:!1,Primary:!1},f={Type:"TwoOptions",Usage:1,Static:!0,Value:!1,Primary:!1};let b,y,S={useSkypeProtocol:i,gridPageNumber:r,isNewPageRequested:o,enhancedPagingDisabled:l,isActivityTypeFilterDisabled:c,showAddNewCommand:u,emptySubgridIconAndTextChanges:d,emptyGridChangesIfQuickFindImprovementsEnabled:p,headerDialogOnTop:h,headerDialogPreventDismissOnScroll:m,listSortHeaderEnabled:f};return(_,O,P)=>{const w=Object(j.e)(_),E=Object(g.D)(_).useSkypeProtocol,D=Object(v.y)(_,O.id,P),T=Object(v.ab)(_,O.id,P);T||s===D||(s=D),b||(b=Object(C.a)(_),y=null!=b&&b===I.b.Native);const F=!y,N=Object(A.f)(_,k.b),{systemDefinedProperties:R}=O,M=D!==s&&T,x=F!==l.Value;let L=!1;N&&(ce(O.contextString)||le(O.contextString))&&(L=!0);let V=!1;Object(q.b)(_)&&oe(O.contextString)&&(V=!0);let B=!1;Object(q.b)(_)&&Object(A.f)(_,k.bh)&&oe(O.contextString)&&Object(j.a)(_)===a.a.MobileApplication&&(B=!0);let z=!1;if(Object(q.b)(_)&&Object(A.f)(_,k.dg)&&le(O.contextString)&&Object(j.a)(_)===a.a.MobileApplication){const e=Object(v.D)(_,O.id,P);(null==e?void 0:e.quickFind)&&(z=!0)}const U=!le(O.contextString)&&n.a.Tablet===w,W=n.a.Tablet===w&&!ce(O.contextString)||"Web"===Object(j.k)(_)&&!te.a.getInstance().get_IsAndroid()&&!te.a.getInstance().get_IsWindows()&&!te.a.getInstance().get_isIPhone(),G=Object(A.f)(_,k.we)&&Object(A.f)(_,k.o)&&Object(j.a)(_)===a.a.MobileApplication&&le(O.contextString),H=o.Value!==T;if(w!==e||E!==t||M||x||H||L!==c.Value||V!==u.Value||B!==d.Value||z!==p.Value||U!==h.Value||W!==m.Value||G!==f.Value){e=w,t=E,r.Value=D,s=D,o.Value=T,l.Value=F,c.Value=L,u.Value=V,d.Value=B,p.Value=z,h.Value=U,m.Value=W,f.Value=G;const n=null==e?E:null;(n!==i.Value||M||x||H)&&(i.Value=n,S=Object.assign(Object.assign({},R),{useSkypeProtocol:i,gridPageNumber:r,isNewPageRequested:o,enhancedPagingDisabled:l,isActivityTypeFilterDisabled:c,showAddNewCommand:u,emptySubgridIconAndTextChanges:d,emptyGridChangesIfQuickFindImprovementsEnabled:p,headerDialogOnTop:h,headerDialogPreventDismissOnScroll:m,listSortHeaderEnabled:f}))}return S}}(),ze=function(){let e=null,t=null;return(i,r,n)=>{var a;if(i&&(!t||e!==i||n)){let n=null;if(r&&(null==t?void 0:t.Parameters.hasOwnProperty(r))){const e=t.Parameters[r];"sharepointdocument"===(null===(a=e.EntityName)||void 0===a?void 0:a.toLowerCase())&&(n=e.FilteringInput)}if(t=Object.assign({},i),i.Parameters&&(t.Parameters=Object.assign({},i.Parameters),r&&i.Parameters[r])){t.Parameters[r]=Object.assign({},i.Parameters[r]);const e=t.Parameters[r];n&&(e.FilteringInput=n),i.Parameters[r].Columns&&(e.Columns=i.Parameters[r].Columns.slice(0))}e=i}return t}}(),Ue=Object(D.s)(),We=function(){const e=[];return(t,i,r,n,a,s,o,l,c,u,d)=>(e&&e.length&&e.splice(0,e.length),e.push({name:V.b.IsGridRoot,value:t},{name:V.b.IsSubGrid,value:i},{name:V.b.IsAssociatedGrid,value:r},{name:V.b.EntityName,value:n},{name:V.b.ViewId,value:a},{name:V.b.IsEmptyFetch,value:s},{name:V.b.IsEmptyOfflineSqlQuery,value:o},{name:V.b.IsValidFetchXmlForOfflineUsage,value:l},{name:V.b.IsEntityAvailableForOfflineUsage,value:c},{name:V.b.OfflineConfigurationErrorCode,value:u},{name:V.b.RelatedEntityUnavailableOffline,value:d}),e)}(),Ge=function(){let e=null;return t=>(e||(e={isGridPaginationStateFeatureEnabled:Object(A.e)(t,k.Yc),isAssociatedGridHeightEnabled:!Object(v.zb)(t)&&Object(x.e)(t),isChartOnAssociatedGridEnabled:Object(A.e)(t,k.N,null,k.q),isGridProgressIndicatorFeatureEnabled:Object(A.e)(t,k.ad),isInMobileModeForOct2019:Object(q.c)(t),isJumpBarShouldHonorSortingFeatureEnabled:Object(A.e)(t,k.Sd),isJumpbarFeatureForMobileEnabled:Object(A.f)(t,k.wd),isSuiterChartEnabled:Object(A.f)(t,k.eh),isSuiterDashboardEnabled:Object(A.f)(t,k.fh),isAdvancedFindEnabled:Object(Y.a)(t),isDisableEditableGridControlOnPhoneFeatureEnabled:Object(A.f)(t,k.tb),isInMobileModeForApril2020:Object(q.b)(t),isSubgridImprovementsEnabled:Object(A.f)(t,k.bh),isSubGridAutoCollapseEnabled:Object(A.e)(t,k.Yg,k.jf),isSubGridRemoveMinHeightEnabled:Object(A.e)(t,k.ah,k.jf),isQuickFindImprovementsEnabled:Object(A.f)(t,k.dg),isShowAsButtonFirstEnabled:Object(A.f)(t,k.Ng),isColumnEditorButtonEnabled:Object(v.wb)(t),isQueueFilterPerfUCIEnabled:Object(A.f)(t,k.ag),isModernAdvancedFindEnabled:Object(A.e)(t,k.ze,k.p),isDockedModeForGridEditorPanelsEnabled:Object(A.e)(t,k.zb,k.p),isModernGridButtonsEnabled:Object(A.e)(t,k.Te,k.p),disableLoadDependenciesOnMissingViewId:Object(A.f)(t,k.ub),gridSynchronousFilterClearing:Object(A.f)(t,k.id),expressionBuilderForcePrimaryAttribute:Object(A.f)(t,k.sc)}),e)}(),qe=function(){let e={fetchXML:null,entityName:null,isOffline:null,isOfflineByDefaultAvailable:null},t={error:!1,errorCode:null,relatedEntityUnavailableOffline:null};return function(i,r,n,a,s){if(e.entityName!==n||e.fetchXML!==r||e.isOffline!==a||e.isOfflineByDefaultAvailable!==s)if(Object(N.m)(n)){const o=Object(N.b)(i,r);t={error:o.error,errorCode:o.error?w.LINKED_ENTITY_NOT_SUPPORTED:null,relatedEntityUnavailableOffline:o.relatedEntityUnavailableOffline},e={fetchXML:r,entityName:n,isOffline:a,isOfflineByDefaultAvailable:s}}else t={error:!0,errorCode:w.ACTIVITY_ENTITY_NOT_SUPPORTED_OFFLINE},e={fetchXML:r,entityName:n,isOffline:a,isOfflineByDefaultAvailable:s};return t}}();return function(n,a){var l,u,b,_,P,D;const V=Object(h.x)(n),q=Te(n,a),X=Object(v.v)(n,a.id,q),Y=q.relationshipName,re=q.roleOrd,de=Object(v.P)(n,a.id,q),pe=Object(v.K)(n,a.id,q),_e=Object(v.y)(n,a.id,q),He=a.descriptor,Qe=Pe.bind(null,a,He),Ke=a.configuration,Xe=Ke&&Ke.CustomControlId?Ke.CustomControlId:null,Ye=Object(C.a)(n),Je=Object(j.e)(n),$e=Object(j.a)(n),Ze=Object(v.db)(n,Xe)||(a.contextString===y.o.CUSTOM?y.l:null),et=le(a.contextString),tt=Ge(n),it=Object(v.B)(n,q,a);let rt=null,nt=!1,at=null;const st=Object(v.t)(n,a.id,q),ot=Object(v.D)(n,a.id,q);et&&(rt=Object(L.j)(n,a.id),tt.isGridPaginationStateFeatureEnabled&&(at=rt.gridSortingInfo,at&&(Object(T.a)(ye)||ye!==at)&&(ye=at,nt=!0),st&&(Object(T.a)(ve)||ve!==st.customFilterXml)&&(ve=st.customFilterXml,nt=!0)),(ot&&Object(T.a)(we)||we!==ot)&&(we=ot,nt=!0));const lt=ze(Ke,Ze,nt),ct=lt&&lt.Parameters?lt.Parameters[Ze]:null,ut=ce(a.contextString),dt=oe(a.contextString),pt=a.contextString===y.o.CUSTOM;const ht=Object(J.E)(n),gt=ht?!Object(R.b)(n):!Object(R.c)(n),mt=Object(ae.r)(n),ft=Object(v.mb)(n,q,a),bt=ct&&!!ct.DataProvider,yt=ct&&!!ct.BoundViewParams,vt=Object(g.D)(n),St=vt&&vt.gridTotalRecordCountLimit?vt.gridTotalRecordCountLimit:5e3,_t=Object(se.a)(n),Ot=Object(se.b)(n),Pt=vt.pcfDatasetGridEnabled,wt=Object(v.lb)(n,a.id,q),Ct=he(a.configuration)&&!ge(a.configuration)&&!me(a.configuration),It=Ct,Et=Ct;if(null!=a.nonCompositionProps){const e=Ke&&Ke.FormFactor&&Ke.FormFactor.toString(),t=Object(M.d)({dataSetType:y.o.GRID,deviceFormFactor:e,gridConfigurations:a.nonCompositionProps.gridConfigurations,pcfDatasetGridEnabled:Pt,viewConfigurations:a.nonCompositionProps.viewConfigurations}),i=t.map(e=>e.configuration.DisplayNameKey),r=function(e,t,i){for(let r=0;r<i.length;r++){const n=i[r],a=n.configuration.DisplayNameKey;if(t[a])continue;const s=Object(H.e)(e,n.configuration.CustomControlId)||Object(H.e)(e,n.configuration.Name),l=Object(o.k)(e);if(s&&l)for(const e of s.Properties.Resources)if(5===e.Type){const i=l[e.Name];if(!i||i&&!i.contentJson)continue;i.contentJson.hasOwnProperty(a)&&(t[a]=i.contentJson[a])}}return t}(n,Ve(n,i),t);(!be&&""!==Object(m.c)(r,i[0])||be!==r)&&(be=r)}let jt=!!X;let Dt=Object(v.V)(n,a.id,q)||(He&&He.Parameters&&He.Parameters.ViewId?r.a.parse(He.Parameters.ViewId):null);const Tt=Object(v.tb)(n,Dt,a.id),Ft=(null==Tt?void 0:Tt.isUserView)?d.b.userview:d.b.savedview,Nt=null==Tt?void 0:Tt.queryType,Rt=null==Tt?void 0:Tt.entityLogicalName;Rt&&Rt!==S&&(S=Rt);const kt=Object(p.h)(n,S),At=!gt&&(Ye===I.b.Web||Ye===I.b.Native&&te.a.getInstance().get_IsWindows())&&et&&tt.isAdvancedFindEnabled&&(null==kt?void 0:kt.IsValidForAdvancedFind);if(!fe||e!==At){const t=Ve(n,w.labelList);""!==Object(m.c)(t,w.JUMPBAR_ALL_TITLE)?(fe=t,e=At):jt=!1}const Mt=Object(v.Z)(n,Xe);Mt&&Mt!==Q&&(Q=Mt);const xt=De(n,a);if(he(a.configuration)){const e=ge(a.configuration)||me(a.configuration)?"row":"column";xt.bodyStyle=Object.assign(Object.assign({},xt.bodyStyle),{flexDirection:e}),xt.bodyMobileStyle=Object.assign(Object.assign({},xt.bodyMobileStyle),{flexDirection:e})}let Lt=Object(v.H)(n,a.id,q)||(He&&He.Parameters&&He.Parameters[y.K]?He.Parameters[y.K]:null),Vt=Lt;et&&(Vt=rt.entityTypeName);const Bt=Object(F.b)(n,Lt);kt&&kt.Initialized===s.a.Initialized||bt||yt||(jt=!1);const zt=kt?kt.DisplayName:"",Ut=Object(g.x)(n),Wt=Object(p.i)(n,Lt),Gt=!(Tt&&Tt.fetchXML),qt=Tt&&Tt.viewId,Ht=qe(n,Gt?"":Tt.fetchXML,S,gt,ht),Qt=!Gt&&!Ht.error,Kt=null!=Tt&&Object(T.b)(Tt.offlineSqlQuery),Xt=Object(N.n)(n,S),Yt=We(et,dt,ut,S,qt?qt.guid:null,Gt,Kt,Qt,Xt,Ht.error&&Ht.errorCode||"",Ht.error&&Ht.relatedEntityUnavailableOffline||""),Jt=!((et||ut||dt)&&Tt&&Tt.fetchXML&&(gt||mt)&&Xt)||!Kt&&Qt;let $t="";if(Jt?Xt||ht?ht&&Object(J.D)(n)&&($t=Object(J.y)(n)):$t=Object(m.c)(fe,w.ENTITY_NOT_AVAILABLE_IN_PROFILE):Kt?$t=Object(m.c)(fe,w.SQL_QUERY_NOT_AVAILABLE):Ht.error&&($t=Object(m.c)(fe,Ht.errorCode)),ct){ct.TargetEntityType&&Lt!==ct.TargetEntityType&&(Lt=ct.TargetEntityType),ct.ExtraFilters=Se(n,a,q,ot,!1);const e=function(e,t,i,r,n){let a=[];const s=Object(v.q)(e,t.id,i);if(s){const e=JSON.parse(s);if(e.conditions)for(const t of e.conditions)t.linkEntityExpressions&&(a=a.concat(t.linkEntityExpressions))}const o=e.user&&e.user.userId,l=Object(A.f)(e,k.ag),c=Object(v.xb)(e,r),u=Object(B.a)(r,o,i,l,c,!le(t.contextString));let d=u&&u.getFilterAndLinkedEntities(n&&void 0!==n.activityOrQueueFilterValue?n.activityOrQueueFilterValue:U.a,n&&!n.activityOrQueue);d&&d.linkEntities&&(a=a.concat(d.linkEntities));return d=d||{filter:null,linkEntities:null},d.linkEntities=a,d}(n,a,q,Lt,ot);if(e&&e.filter&&(ct.ExtraFilters?ct.ExtraFilters.push(JSON.stringify(e.filter)):ct.ExtraFilters=[JSON.stringify(e.filter)]),e&&e.linkEntities&&e.linkEntities.length>0){let t={Static:!0,Value:Object(W.b)(e.linkEntities)};if(ct.LinkingInput){t=ct.LinkingInput;const i=Object(W.a)(ct.LinkingInput.Value);if(i){const r=new G.a;i.forEach(e=>{r.addLinkedEntity(e)}),e.linkEntities.forEach(e=>{r.addLinkedEntity(e)}),t.Value=Object(W.b)(r.getLinkedEntities())}}ct.LinkingInput=t}if(Dt){const e=r.a.toString(Dt);e!==ct.ViewId&&(ct.ViewId=e)}else Dt=r.a.tryParseOrNull(ct.ViewId);(He&&He.Parameters?"false"===He.Parameters[y.W.ENABLE_CONTEXTUALACTIONS]:null)&&(lt.Parameters[y.p]={Usage:1,Static:!0,Type:"Enum",Value:!1,Primary:!1})}Lt&&Lt!==O&&(O=Lt);const Zt=Object(p.r)(n,Lt)&&a.contextString===y.o.GRID?v.a:Lt,ei=ct&&ct.CommandBarContext,ti=je(n,a,Zt,ei),ii=function(e,t,i){const r=Object(v.tb)(e,t,i);return r&&r.grid&&r.grid.rows&&r.grid.rows[0]&&r.grid.rows[0].cells}(n,Dt,a.id),ri=null==ii?void 0:ii.map(e=>e.name),ni=null==i?void 0:i.map(e=>e.name);(JSON.stringify(ri)!==JSON.stringify(ni)||(Dt&&Dt.guid)!==(t&&t.guid)||Y===Ce&&re!==Ie)&&(t=Dt,Ie=re,z=(He&&He.Id?He.Id:"")+(new Date).getTime(),i=ii),Y&&Y!==Ce&&(Ce=Y);const ai=Object(v.o)(n,Lt),si=ai?ai.lookupAttribute:null;ct&&(function(e,t,i,r,n,a,s){const o=Object(p.h)(e,r);if(o&&he(t.configuration)){const l=y.b;i.Columns||(i.Columns=[]),r!==v.a||n&&n.some(e=>e.name===l)||i.Columns.find(e=>e.Name===l)||i.Columns.push({Alias:l,DataType:"",Type:"",Name:l});const c=o&&o.PrimaryNameAttribute,u=n&&n.some(e=>e.name===c);if(!c||u||i.Columns.some(e=>e.Name===c)||i.Columns.push({Alias:c,DataType:"",Type:"",Name:c}),!Object(v.yb)(t.configuration.Parameters)){const r=Object(x.a)(o.PrimaryImageAttribute);r&&!i.Columns.find(e=>e.Name===r)&&i.Columns.push({Alias:K.f,DataType:"SingleLine.Text",Type:"",Name:r}),(!ge(t.configuration)||Object(A.f)(e,k.Lf))&&Object(A.e)(e,k.Tc)&&a&&s&&(i.Columns.find(e=>e.Name===v.c)||i.Columns.push({Alias:v.c,DataType:"Whole.None",Type:"",Name:v.c,PreventMetadataRequest:!0}),i.Columns.find(e=>e.Name===a)||i.Columns.push({Alias:a,DataType:"Lookup.Simple",Type:"",Name:a}))}}}(n,a,ct,Lt,i,si,!Object(T.a)(rt)),function(e,t,i,r,n){if(!Object(v.yb)(t.configuration.Parameters))return;(null==n?void 0:n.some(t=>{var i;return(null===(i=Object($.a)(e,r,t.name))||void 0===i?void 0:i.Type)===Z.a.moneyType}))&&(i.Columns.some(e=>e.Alias===y.R)||i.Columns.push({Alias:y.R,DataType:"Lookup.Simple",Type:"",Name:K.z}))}(n,a,ct,Lt,i));const oi=!Lt||(Object(F.i)(Lt)||Object(F.g)(n,Lt,2,0)&&function(e,t){let i=!0;t&&t.forEach(t=>{if(t.relatedEntityName&&(i=Object(F.g)(e,t.relatedEntityName,2,0),!i))return!1});return i}(n,i)),li=Object(v.bb)(n,a.id,q),ci=li?JSON.parse(li):null,ui=ci?ci.totalResultCount:null,di=ci?ci.pageSize:null,pi=null!==ui&&ui>-1?0===ui?Object(m.c)(fe,w.NO_DATA_AVAILABLE):String.format(w.X_RECORDS_PRESENT,ui):"",hi=Ue(n,et,null===(l=a.dataSetUIOptions)||void 0===l?void 0:l.displayIconsInColor),gi=!(null!=Ye&&Ye===I.b.Native),mi=Object(v.ub)(n,null===(u=null==rt?void 0:rt.pageToEditedViewMapId)||void 0===u?void 0:u.guid,null==Dt?void 0:Dt.guid),fi={isEmptyOfflineSqlQuery:Kt,isEntityAvailableForOffline:Xt,isOfflineSqlQueryAvailable:Jt,offlineErrorMessage:$t,isOfflineAvailableForUse:Object(J.D)(n),offlineGridErrorTelemetryParams:Yt};Object(ie.e)(fi,Ee)||(Ee=fi);const bi=Object(ee.h)(n),yi=Object(f.c)(n,t),vi=!gt&&Ye===I.b.Web&&et&&tt.isColumnEditorButtonEnabled&&!ut&&!dt&&(null==kt?void 0:kt.IsValidForAdvancedFind);if(ge(a.configuration)||me(a.configuration)){vi&&(lt.Parameters[y.B]={Primary:!1,Static:!0,Type:"Enum",Usage:1,Value:"Disable"});(dt||pt&&(null===(b=a.parentContextToken)||void 0===b?void 0:b.contextTokenType)===c.a.SubGrid)&&!(null===(D=null===(P=null===(_=a.parentDefinedControlProps)||void 0===_?void 0:_.decorators)||void 0===P?void 0:P.referencePanel)||void 0===D?void 0:D.isInReferencePanel)&&(lt.Parameters[y.A]={Primary:!1,Static:!0,Type:"Enum",Usage:1,Value:"Enable"})}const Si=Object(v.xb)(n,Lt),_i=Object(E.a)(n);return{showAdvancedFilter:At,isViewEdited:!!mi,isInitialized:jt,viewId:t,customFilter:st,gridEntityTypeName:S,chartEntityTypeName:S,isUCIEntity:Bt,totalRecordCountLimitExceeded:ft,chartProps:wt?Fe(n,a,q):null,viewDescriptor:Tt,commandBarProps:Qe(y.V.COMMANDBAR_ENABLED,!0,y.W.ENABLE_CONTEXTUALACTIONS,Ze,!0)?Ne(n,a,q,He,ti,xt):null,viewSelectorProps:Vt&&Qe(y.V.VIEWSELECTOR_ENABLED,!0,y.W.ENABLE_VIEW_PICKER,Ze)?Re(n,a,q,Vt,t,xt):null,queueFilterProps:Ke&&Qe(null,!0,y.W.ENABLE_QUEUEFILTER,Ze)?ke(n,a,q,Lt,xt):null,entityFilterProps:gt||!Si&&!Object(x.h)(n,Ce,ut)?null:Ae(n,a,q,Lt,xt),jumpBarProps:Qe(y.V.JUMPBAR_ENABLED,It,y.W.ENABLE_JUMPBAR,Ze)&&Oe(a)?Me(a,q,Lt,V.languageId,ot?ot.jumpBar:null,fe):null,quickFindProps:Qe(y.V.QUICKFIND_ENABLED,!0,y.W.ENABLE_QUICKFIND,Ze)?xe(a,q,Lt,zt,rt):null,pagingProps:Qe(y.V.PAGING_ENABLED,Et,null,Ze)?Le(a,q,Lt):null,contextToken:q,controlKey:z,styles:xt,refreshCounter:de,pagingRefreshInput:pe,pageNumber:_e,ribbonId:ti,semanticTag:ue(a.contextString),recordsPerPageSetting:Object(h.h)(n),userSetting:V,hasReadRolePrivilege:oi,resourceStrings:fe,switchVisualizationResourceStrings:be,entityTypeName:O,primaryDataSetName:Ze,nestedGridDatasetName:Q,viewportSm:Object(E.a)(n).sizes.Breakpoints.DimensionS,viewportM:Object(E.a)(n).sizes.Breakpoints.DimensionM,systemDefinedProperties:Be(n,a,q),platformType:Object(C.a)(n),isGridEditable:Object(v.yb)(Ke?Ke.Parameters:null),notificationMessage:pi,totalResultCount:ui,pageSize:di,offlineProps:Ee,isRTL:Object(h.g)(n),entityDisplayName:zt,isOffline:gt,isOfflineByDefaultAvailable:ht,showChart:wt,entityIconVectorName:Wt,webResourceUrl:Ut,hasCustomDataProvider:bt,commandBarRefreshProps:hi,updatedConfiguration:lt,offlineGridErrorTelemetryParams:Yt,gridInput:rt,gridTotalRecordsCountLimit:St,gridSortingInfo:at,nativeFilterExpression:tt.isGridPaginationStateFeatureEnabled&&rt?rt.nativeFilterExpression:null,pageNumberForEnhancedPaging:tt.isGridPaginationStateFeatureEnabled&&!gi&&rt?rt.gridPageNumber:null,userId:n.user&&n.user.userId||null,lookupAttributeForRecordHierarchy:si,fetchXML:it,viewType:Ft,savedQueryType:Nt,featureControlProps:tt,clientHostSubtype:Je,clientHost:$e,backButtonEnabled:bi,originalView:yi,showColumnEditor:vi,entityIsActivityType:Si,isModernDataSet:Object(ne.a)(n,Object(H.e)(n,Xe)),controlManifest:Object(H.e)(n,Xe),isAdvancedColumnEditorEnabled:_t,isAdvancedColumnFilteringEnabled:Ot,pcfDatasetGridOrgSettingEnabled:Pt,theme:_i}}}function Se(e,t,i,r,n){if(!r)return[];const a=le(t.contextString),s=ce(t.contextString),o=oe(t.contextString)&&Object(A.f)(e,k.fg),l=[];for(const e in r)l.push([e,r[e]]);const c=l.reduce((e,[t,i])=>((a||s||o)&&"quickFind"===t||("activityOrQueueFilterValue"===t||"activityTypeSelectedValues"===t)||!i||e.push(i),e),[]);if(n){const r=Object(v.t)(e,t.id,i);if(r&&r.customFilterXml){const e=Object(z.i)(r.customFilterXml),t=JSON.stringify(e);t&&c.push(t)}}else{const r=Object(v.q)(e,t.id,i);r&&c.push(r)}return c}function _e(e){if(!e&&"("!==e[0]||")"!==e[e.length-1])throw new Error(String.format("Resource string group must be in the format (A:a).  The format {0} is invalid.",e));const t=(e=(e=e.replace("(","")).replace(")","")).split(":");if(2!==t.length)throw new Error("Resource string group must have a search list defined.  E.g : (A:a).");return t}function Oe(e){var t,i,r;return"no"!==(null===(r=null===(i=null===(t=e.configuration)||void 0===t?void 0:t.Parameters)||void 0===i?void 0:i.EnableJumpBar)||void 0===r?void 0:r.Value)}function Pe(e,t,i,r,n,a,s){let o=e.dataSetUIOptions,l=r;if(s=!!Object(T.a)(s)||s,!o&&e.configuration&&e.configuration.Parameters){const t=e.configuration.Parameters[a];t&&t[y.k]&&(o=t[y.k])}const c=t&&t.Parameters&&t.Parameters[n]?"true"===t.Parameters[n]:s;return o&&i&&!Object(T.a)(o[i])&&(l=o[i]),l&&c}},kSDG:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));let r=0;function n(e,t,i,r){return{attributeName:e,aliasName:t,entity:i,dateTimeGrouping:r||null,hasAggregate:!1,hasGroupBy:!1,aggregateType:null}}function a(e,t){return r++,r>65535&&(r=0),String.format("{0}_{1}{2}_{3}",e,r,t,(new Date).getTime())}},kt5S:function(e,t,i){"use strict";i.d(t,"h",(function(){return v})),i.d(t,"j",(function(){return S})),i.d(t,"i",(function(){return _})),i.d(t,"f",(function(){return O})),i.d(t,"g",(function(){return P})),i.d(t,"b",(function(){return w})),i.d(t,"a",(function(){return C})),i.d(t,"d",(function(){return E})),i.d(t,"c",(function(){return D})),i.d(t,"e",(function(){return I}));var r=i("BFlg"),n=i("P6DH"),a=i("arV0");function s(e,t,i,r){return{type:"update.grid.configuration",payload:{[t]:{[i]:e}},meta:{pageId:r}}}function o(e,t,i){return{type:"update.views.configuration",payload:{[t]:e},meta:{pageId:i}}}var l=i("oOvK"),c=i("9fGf"),u=i("Z/4N"),d=i("y60j"),p=i("SAYH"),h=i("KBcj"),g=i("g03H"),m=i("5ZBI"),f=i("pGYJ"),b=i("zmL5");function y(e,t){const i=Object.assign({},e.CustomControls);if(e.CustomControls[t]&&!e.CustomControls[t].isDefaultConfig){let r=!1;for(const i in e.CustomControls)if(w(e.CustomControls[i],e.CustomControls[t])&&i!==t.toString()){r=!0;break}if(!r){let r=-1;i[r]?r--:i[r.toString()]=e.CustomControls[t]}}return i[t]=null,i}function v(e,t,i,r,u){return{type:"customcontrol.changevisualization.homepage",sync:!0,execute({dispatch:d,getState:p},h){const g=p(),b=Object(c.b)(g),y=Object(n.k)(g,e,t),v={UniqueId:y?y.UniqueId:null,CustomControls:{[b]:Object.assign(Object.assign({},i),{FormFactor:b})},FormLibraries:y?y.FormLibraries:null,EventHandlers:y?y.EventHandlers:null},{entityTypeName:S}=Object(a.j)(g,e);if(u){const i=Object(n.V)(g,e,t);d(o({UniqueId:null,CustomControls:{[b]:null},FormLibraries:null,EventHandlers:null},i.guid,e))}d(Object(l.c)(i.CustomControlId)).then(()=>{d(s(v,S,r,e))},t=>{const n=Object(m.b)(p(),i.CustomControlId);h.EventManager.ReportComponentFailure(n+".CustomControl.retrieveControlManifest",t,"retrieveControlManifest failure error message",[{name:"APIName",value:f.a+".Actions.SwitchVisualization"},{name:"entityTypeName",value:S},{name:"customControlId",value:i.CustomControlId},{name:"pageId",value:e},{name:"controlId",value:r},{name:"config",value:JSON.stringify(i)}])})}}}function S(e,t,i,r,u){return{type:"customcontrol.changevisualization.homepage",sync:!0,execute({dispatch:d,getState:p}){const g=p(),m=Object(c.b)(g),f=Object(n.V)(g,e,t),b=Object(h.d)(g,f),v={UniqueId:b?b.UniqueId:null,CustomControls:{[m]:Object.assign(Object.assign({},i),{FormFactor:m})},FormLibraries:b?b.FormLibraries:null,EventHandlers:b?b.EventHandlers:null},{entityTypeName:S}=Object(a.j)(g,e);if(u){const i=Object(n.k)(g,e,t);if(i&&i.CustomControls&&i.CustomControls[m]){const t={UniqueId:i.UniqueId,CustomControls:y(i,m),FormLibraries:i.FormLibraries,EventHandlers:i.EventHandlers};d(s(t,S,r,e))}}d(Object(l.c)(i.CustomControlId)).then(()=>{d(o(v,f.guid,e))})}}}function _(e,t,i){return{type:"customcontrol.changevisualization.subgrid",sync:!0,execute({dispatch:r,getState:n}){const a=n(),o=Object(c.b)(a),p=Object(b.b)(a,e),h=Object(d.a)(a,e,p,i),g=Object(u.b)(a,h.UniqueId,p);if(!g||!g.CustomControls)return;const m={UniqueId:h.UniqueId,CustomControls:{[o]:Object.assign(Object.assign({},t),{FormFactor:o})},FormLibraries:g.FormLibraries,EventHandlers:g.EventHandlers};r(Object(l.c)(t.CustomControlId)).then(()=>{r(s(m,p.guid,g.UniqueId,e))})}}}function O(e,t,i,r,n){return{type:"customcontrol.changevisualization.associatedgrid.grid",sync:!0,execute({dispatch:a,getState:o}){const u=o(),d=Object(c.b)(u),p={UniqueId:n.UniqueId,CustomControls:{[d]:Object.assign(Object.assign({},r),{FormFactor:d})},FormLibraries:n.FormLibraries,EventHandlers:n.EventHandlers};a(Object(l.c)(r.CustomControlId)).then(()=>{a(s(p,t,i,e))})}}}function P(e,t,i,r,n,a,u){return{type:"customcontrol.changevisualization.associatedgrid.view",sync:!0,execute({dispatch:d,getState:p}){const h=p(),g=Object(c.b)(h),m={UniqueId:a.UniqueId,CustomControls:{[g]:Object.assign(Object.assign({},n),{FormFactor:g})},FormLibraries:a.FormLibraries,EventHandlers:a.EventHandlers};if(u&&u.CustomControls&&u.CustomControls[g]){const r={UniqueId:u.UniqueId,CustomControls:y(u,g),FormLibraries:u.FormLibraries,EventHandlers:u.EventHandlers};d(s(r,t,i,e))}d(Object(l.c)(n.CustomControlId)).then(()=>{d(o(m,r.guid,e))})}}}function w(e,t){if(e&&t){let i=!!e==!!t&&e.CustomControlId===t.CustomControlId&&e.Name===t.Name&&e.ShouldOverrideControlVisible===t.ShouldOverrideControlVisible&&e.Version===t.Version&&e.isDefaultConfig===t.isDefaultConfig&&function e(t,i){var r,n;if(t&&i&&t!==i){if(t instanceof Array&&i instanceof Array&&t.length!==i.length)return!1;for(const a in t)if(t[a]!==i[a]){if("function"==typeof t[a])continue;if(t[a]&&i[a]&&"object"==typeof t[a]&&"object"==typeof i[a]){if(e(t[a],i[a]))continue;return!1}if("EnableViewPicker"===a)return(null===(r=t[a])||void 0===r?void 0:r.toString())===(null===(n=i[a])||void 0===n?void 0:n.toString());if("ExtraFilters"!==a&&"PagingInput"!==a&&"FilteringInput"!==a&&"RefreshInput"!==a&&"ViewId"!==a&&"EntityName"!==a&&"LinkingInput"!==a&&"FirstDataRequestType"!==a&&"NativeFilterExpressionToRestore"!==a&&"LookupAttributeNameForHierarchy"!==a&&"SortingInput"!==a&&"function"!=typeof t[a])return!1}}return!0}(e.Parameters,t.Parameters);if(e.Children&&t.Children){if(Object.keys(e.Children).length===Object.keys(t.Children).length){for(const r in e.Children)i=i&&w(e.Children[r],t.Children[r]);return i}return!1}return i&&e.Children===t.Children}return!!e==!!t}function C(e,t){if(e===t)return!0;if(!e||!t||e.UniqueId!==t.UniqueId)return!1;if(!e.CustomControls&&!t.CustomControls)return!0;if(!!e.CustomControls!=!!t.CustomControls)return!1;for(const i of Object.keys(e.CustomControls))if(!w(e.CustomControls[i],t.CustomControls[i]))return!1;return!0}function I(e){const{context:t,retrieveControlResourceStrings:i}=e,r=t?t.TraceManager.getTracer("customcontrol"):null;return i(E(e).map(e=>e.configuration.DisplayNameKey)).catch(e=>{r&&r.info("Resource retrieve failed: "+e.message)})}function E({controlDescriptorParameters:e,controlId:t,dataSetType:i,deviceFormFactor:n,isDefaultConfig:a,gridConfigurations:s,gridEntityTypeName:o,pcfDatasetGridEnabled:l,viewConfigurations:c,viewId:u}){const d=[];if(null==n)return d;if(i===r.o.CUSTOM&&a)return d;const h=i===r.o.GRID||i===r.o.ASSOCIATEDGRID?Object(g.w)(t,o,u&&p.a.toString(u),l):Object(g.z)(t,e,!1,l);return d.push({configuration:h,formFactor:n,configurationType:null}),s&&s.CustomControls&&j(d,s,"GRID_CONFIG"),c&&c.CustomControls&&j(d,c,"VIEW_CONFIG"),d}function j(e,t,i){for(const r in t.CustomControls)if(t.CustomControls[r]&&!t.CustomControls[r].isDefaultConfig){let n=!1;for(let i=0;i<e.length;i++)if(w(e[i].configuration,t.CustomControls[r])){n=!0;break}n||e.push({configuration:t.CustomControls[r],formFactor:r,configurationType:i})}}function D(e,t){return null!=t.DisplayNameKey?null!=e&&null!=e[t.DisplayNameKey]?e[t.DisplayNameKey]:t.DisplayNameKey:"Grid"}},"lIi+":function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var r=i("WLAV"),n=i("ruPX");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function a(e,t,i,a,s,o,l,c){const u={powerBIEmbedUrl:t,powerBIGroupId:i,powerBIDashboardId:a,powerBITileId:s,powerBIReportId:o,powerBIReportUrl:l,powerBIComponentTypeCode:c};return Object(n.a)(r.a,u,e,{target:"dialog"})}},lLEV:function(e,t,i){"use strict";i.d(t,"a",(function(){return Ae}));var r=i("izYK"),n=i("y60j"),a=i("S6h3");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class s{constructor(e){Object.assign(this,e)}getTimelineWallData(){throw new Error("Not Replaced")}performTimelineWallCUDOperations(){throw new Error("Not Replaced")}getCommands(){throw new Error("Not Replaced")}loadWebResource(){throw new Error("Not Replaced")}getEntityAttributes(){throw new Error("Not Replaced")}}var o=i("LE5i"),l=i("zDpi"),c=i("NAAR"),u=i("69Qu"),d=i("ybGo"),p=i("E5qG"),h=i("37s6"),g=i("Lyxw"),m=i("FETf"),f=i("dyr5"),b=i("SRlt"),y=i("g22U");function v(e){return{type:"SERIALIZE_RETRIEVE_PERSONAL_WALL_REQUEST_ASYNC",execute({dispatch:t,getState:i},r){const n=e.get_pageNumber(),a=e.get_pageSize(),s=i(),o=e.get_commentsPerPost(),l=e.get_startDate(),c=e.get_endDate(),u=e.get_type(),d=e.get_source(),p=e.get_sortDirection(),h=e.get_keyword()||null;return Promise.resolve(
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t,i,r,n,a,s,o,l,c){return{urlParameters:"posts/Microsoft.Dynamics.CRM.RetrievePersonalWall(PageNumber="+t+",PageSize="+i+",CommentsPerPost="+r+",StartDate="+n+",EndDate="+a+",Type="+s+",Source="+o+",SortDirection="+l+(Object(f.b)(e)&&c?",Keyword=@keyword)?@keyword="+encodeURIComponent("'"+c+"'"):")"),method:"GET",additionalHeaders:{Accept:b.a,"Content-Type":"application/json; charset=utf-8",Prefer:"odata.include-annotations=*","OData-MaxVersion":"4.0","OData-Version":"4.0"},additionalParameters:{[y.a.TYPE]:y.d.FUNCTION,[y.a.SUB_TYPE]:y.c.RetrievePersonalWall}}}(s,n,a,o,l,c,u,d,p,h))}}}var S=i("iZ7K");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function _(e,t,i,r){return Object(f.b)(e)&&t?",Keyword=@keyword)?@tid="+O(i,r,e)+"&@keyword="+encodeURIComponent("'"+t+"'"):")?@tid="+O(i,r,e)}function O(e,t,i){if(null===e||null===t)return"null";return"{'@odata.id':'"+Object(S.o)(i,t)+"("+e.toString()+")'}"}function P(e){return{type:"SERIALIZE_RETRIEVE_RECORD_WALL_REQUEST_ASYNC",execute({dispatch:t,getState:i},r){const n=e.get_pageNumber(),a=e.get_pageSize(),s=i(),o=e.get_commentsPerPost(),l=e.get_startDate(),c=e.get_endDate(),u=e.get_type(),d=e.get_source(),p=e.get_sortDirection(),h=e.get_entity(),g=e.get_keyword();return Promise.resolve(function(e,t,i,r,n,a,s,o,l,c,u){return{urlParameters:"posts/Microsoft.Dynamics.CRM.RetrieveRecordWall(Entity=@tid,PageNumber="+t+",PageSize="+i+",CommentsPerPost="+r+",StartDate="+n+",EndDate="+a+",Type="+s+",Source="+o+",SortDirection="+l+_(e,u,c.Id,c.LogicalName),method:"GET",additionalHeaders:{Accept:b.a,"Content-Type":"application/json; charset=utf-8",Prefer:"odata.include-annotations=*","OData-MaxVersion":"4.0","OData-Version":"4.0"},additionalParameters:{[y.a.TYPE]:y.d.FUNCTION,[y.a.SUB_TYPE]:y.c.RetrieveRecordWall}}}(s,n,a,o,l,c,u,d,p,h,g))}}}var w=i("fU7K");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function C(e,t,i,r){let n="null",a=!1;t&&t.LogicalName&&(n=function(e,t,i){if(null===e||null===t)return"null";return"{'@odata.id':'"+Object(S.o)(i,t)+"("+e.toString()+")'}"}(t.Id,t.LogicalName,e),e&&e.metadata&&e.metadata.entities&&e.metadata.entities[t.LogicalName]&&(a=e.metadata.entities[t.LogicalName].IsActivityParty));return{urlParameters:"activitypointers/Microsoft.Dynamics.CRM.RetrieveTimelineWallRecords(FetchXml=@xml,Target=@id,RollupType=@rollupType)?@id="+(-1===r&&a?null:n)+"&@xml='"+Object(w.CrmUrlEncode)(i)+"'&@rollupType="+r,method:"GET",additionalHeaders:{Accept:b.a,"Content-Type":"application/json; charset=utf-8",Prefer:"odata.include-annotations=*","OData-MaxVersion":"4.0","OData-Version":"4.0"},additionalParameters:{[y.a.TYPE]:y.d.FUNCTION,[y.a.SUB_TYPE]:y.c.RetrieveTimelineWallRecords}}}function I(e){return{type:"SERIALIZE_RETRIEVE_TIMELINE_WALL_RECORDS_REQUEST_ASYNC",execute({dispatch:t,getState:i},r){const n=e.get_target(),a=e.get_fetchXml(),s=i(),o=e.get_rollupType();return Promise.resolve(C(s,n,a,o))}}}var E=i("nxt5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class j extends E.a{constructor(e){super("RetrievePersonalWall"),this._entityCollection=e}get_entityCollection(){return this._entityCollection}}function D(e,t){return{type:"DESERIALIZE_RETRIEVE_PERSONAL_WALL_RESPONSE_ASYNC",execute:({dispatch:t,getState:i},r)=>e.json().then(e=>new j(e.value))}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class T extends E.a{constructor(e){super("RetrieveRecordWall"),this._entityCollection=e}get_entityCollection(){return this._entityCollection}}function F(e,t){return{type:"DESERIALIZE_RETRIEVE_RECORD_WALL_RESPONSE_ASYNC",execute:({dispatch:t,getState:i},r)=>e.json().then(e=>new T(e.value))}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class N extends E.a{constructor(e){super("RetrieveTimelineWallRecords"),this._timelineWallRecords=e}get_timelineWallRecords(){return this._timelineWallRecords}}function R(e,t){return{type:"DESERIALIZE_RETRIEVE_TIMELINE_WALL_RECORDS_RESPONSE_ASYNC",execute:({dispatch:t,getState:i},r)=>Promise.resolve(e.json().then(e=>new N(e.TimelineWallRecords)))}}var k=i("84PK"),A=i("hirD"),M=i("XgcG"),x=i("GD3x"),L=i("JdSN"),V=i("WRF3"),B=i("Mr6u"),z=i("5yoC");class U extends z.a{constructor(e,t,i){super(),this._fetchXml=null,this._rollupType=0,this._target=null,this._set_fetchXml(e),this._set_target(t),this._rollupType=i}get_name(){return"RetrieveTimelineWallRecords"}get_xmlNamespace(){return"http://schemas.microsoft.com/xrm/7.1/Contracts"}get_target(){return this._target}_set_target(e){return this._target=e,e}get_fetchXml(){return this._fetchXml}_set_fetchXml(e){return this._fetchXml=e,e}get_rollupType(){return this._rollupType}}var W=i("sZ+8");class G extends z.a{constructor(e,t,i,r,n,a,s,o,l,c){super(),this._entity=null,this._pageNumber=0,this._pageSize=0,this._commentsPerPost=0,this._startDate=null,this._endDate=null,this._type=0,this._source=0,this._sortDirection=!1,this._entity=e,this._pageNumber=t,this._pageSize=i,this._commentsPerPost=r,this._startDate=n,this._endDate=a,this._type=s,this._source=o,this._sortDirection=l,this._keyword=c}get_name(){return"RetrieveRecordWall"}get_xmlNamespace(){return"http://schemas.microsoft.com/xrm/7.1/Contracts"}get_entity(){return this._entity}get_pageNumber(){return this._pageNumber}get_pageSize(){return this._pageSize}get_commentsPerPost(){return this._commentsPerPost}get_startDate(){return this._startDate}get_endDate(){return this._endDate}get_type(){return this._type}get_source(){return this._source}get_sortDirection(){return this._sortDirection}get_keyword(){return this._keyword}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class q extends z.a{constructor(e,t,i,r,n,a,s,o,l){super(),this._pageNumber=0,this._pageSize=0,this._commentsPerPost=0,this._startDate=null,this._endDate=null,this._type=0,this._source=0,this._sortDirection=!1,this._keyword=null,this._set_pageNumber(e),this._set_pageSize(t),this._set_commentsPerPost(i),this._set_startDate(r),this._set_endDate(n),this._set_type(a),this._set_source(s),this._set_sortDirection(o),this._set_keyword(l)}get_name(){return"RetrievePersonalWall"}get_pageNumber(){return this._pageNumber}_set_pageNumber(e){return this._pageNumber=e,e}get_pageSize(){return this._pageSize}_set_pageSize(e){return this._pageSize=e,e}get_commentsPerPost(){return this._commentsPerPost}_set_commentsPerPost(e){return this._commentsPerPost=e,e}get_startDate(){return this._startDate}_set_startDate(e){return this._startDate=e,e}get_endDate(){return this._endDate}_set_endDate(e){return this._endDate=e,e}get_type(){return this._type}_set_type(e){return this._type=e,e}get_source(){return this._source}_set_source(e){return this._source=e,e}get_sortDirection(){return this._sortDirection}_set_sortDirection(e){return this._sortDirection=e,e}get_keyword(){return this._keyword}_set_keyword(e){return this._keyword=e,e}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var H=i("V482"),Q=i("/Zy9"),K=i("HfZT"),X=i("4ciL"),Y=i("zoUO"),J=i("tHtE"),$=i("23jc");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Z="TimelineWall.retrieveTimelineWallData",ee={RetrieveTimelineWallRecords:I,RetrieveMultiple:Y.a,RetrieveRecordWall:P,RetrievePersonalWall:v},te={RetrieveTimelineWallRecords:R,RetrieveMultiple:J.c,RetrieveRecordWall:F,RetrievePersonalWall:D};function ie(e,t){return{type:"timelinewall.data.retrieve.async",execute({dispatch:i,getState:r},n){const a=n.DataSource.get_WebAPIService();let s=o.a.Data;return void 0!==e.queueTypeToRequestMap[o.a.Filters]&&null!==e.queueTypeToRequestMap[o.a.Filters]?s=o.a.Filters:void 0!==e.queueTypeToRequestMap[o.a.WhatsChanged]&&null!==e.queueTypeToRequestMap[o.a.WhatsChanged]?s=o.a.WhatsChanged:void 0!==e.queueTypeToRequestMap[o.a.MoreEmails]&&null!==e.queueTypeToRequestMap[o.a.MoreEmails]&&(s=o.a.MoreEmails),i(Object(m.o)(e,s)),i(function(e,t,i,r){return{type:"timelinewall.data.retrieve.nextpage.async",async execute({dispatch:n,getState:a},s){const l=s.DataSource,u=a(),d=t,p=Object.keys(d.queueTypeToRequestMap).sort();let h=[];const b=Object(g.f)(u,c.y.TimelineWallMDLNotes),y=Object(g.f)(u,c.y.TimelineWallUnbatchedRequests);if(i!==o.a.Data&&i!==o.a.MoreEmails&&(h=Object.keys(t.queueTypeToRequestMap[i].dataMap.FetchXMLs)),Object(f.c)(u)){if(Object(W.n)(u,c.c.Notes)&&Object(W.n)(u,c.c.User)&&d.queueTypeToRequestMap[m.h]&&d.queueTypeToRequestMap[m.h].isEnabled){if(Object(g.f)(u,c.y.TimelineWallOfflineMDLAPI))return void await se(m.h,d,t,s,n,r);const e=d.queueTypeToRequestMap[m.h].dataMap.FetchXML;return Xrm.WebApi.retrieveMultipleRecords(c.c.Notes,"?fetchXml="+e).then(e=>{n(Object(m.q)({isError:!1,errorMessage:"",errorLocalizedMessage:"",errorCode:"",dataResults:e.entities},t.controlId,m.h))},e=>{n(Object(m.q)({isError:!0,errorMessage:e.message,errorLocalizedMessage:"",errorCode:e.errorCode,dataResults:null},t.controlId,m.h))})}return}const v=i===o.a.WhatsChanged||i===o.a.Filters;if(y&&i!==o.a.Filters&&i!==o.a.MoreEmails&&i!==o.a.WhatsChanged)return Promise.allSettled([oe(s,l,u,e,p,d,t,n),le(s,b,l,u,e,p,d,t,n,r),ce(s,l,u,e,p,d,t,n)]);const S=[];let _,O="";for(let r=0;r<p.length;r++){O=p[r];const n=d.queueTypeToRequestMap[O];if(n.isEnabled)if(i!==o.a.Data&&i!==o.a.MoreEmails)for(let i=0;i<h.length;i++){const r=ae(e,n,O,u,k.a.tryCreate(t.recordId),t.recordEntityName,i,h);r&&S.push(r)}else{const i=ae(e,n,O,u,k.a.tryCreate(t.recordId),t.recordEntityName);!i||O===m.h&&b||S.push(i)}}if(i===o.a.Filters&&Object(g.f)(u,c.y.TimelineWallFilterPerfImprovements)){try{const e=await function(e,t,i,r,n){const a=e.map(e=>(B.a,me(e,t,i,r,n)));return Promise.all(a)}(S,l,{OperationSource:"TimelineWall.getTimelineWallFilterData"},u,n),r={};for(const t in e)O=h[Number(t)],r[O]=new H.a(null,Number(t),e[t]);n(Object(m.q)({isError:!1,errorMessage:"",errorLocalizedMessage:"",errorCode:"",dataResults:r},t.controlId,i))}catch(e){pe(e,"TimelineWall.getTimelineWallFilterData",s,O,t,n)}return}if(b){const e=p.indexOf(m.h);e>-1&&(p.splice(e,1),_=new Promise((e,i)=>{e(se(m.h,d,t,s,n,r))}))}const P=new Promise((r,a)=>{if(0!==S.length){r(ge(new A.a(S,new x.a(v,!0)),l,{OperationSource:Z},u,n).then(r=>{const a=r.get_responses(),g={};let b=!1,y="";for(const r in a){const v=a[r];if(i!==o.a.Data&&i!==o.a.MoreEmails){if(O=h[r],(i===o.a.WhatsChanged||i===o.a.Filters)&&null===v.get_response()&&null!==v.get_fault())if(v.get_fault().get_errorCode()===c.b);else{try{v.get_fault().get_message()&&(y=v.get_fault().get_message())}catch(e){y=e.message}b=!0,Object(f.e)(v,s,Z,"timelinewall.data.retrieve.nextpage.async",y)}g[O]=v}else{if(O=p[r],O===c.m){return ue(v,l,e,d,t,O,u,n).then(e=>{const i=[v.get_response(),...e];n(Object(m.q)({isError:!1,errorMessage:"",errorLocalizedMessage:"",errorCode:"",dataResults:i},t.controlId,O))},e=>{let i="";try{e&&e.reason&&(i=e.reason.get_localizedMessage())}catch(e){i=e.message}Object(f.e)(e,s,Z,"timelinewall.data.retrieve.nextpage.async",i),n(Object(m.q)({isError:!0,errorMessage:y,errorLocalizedMessage:"",errorCode:"",dataResults:null},t.controlId,O))})}n(Object(m.q)({isError:!1,errorMessage:"",errorLocalizedMessage:"",errorCode:"",dataResults:v.get_response()},t.controlId,O))}}i!==o.a.Data&&i!==o.a.MoreEmails&&n(b?Object(m.q)({isError:!0,errorMessage:y,errorLocalizedMessage:"",errorCode:"",dataResults:null},t.controlId,i):Object(m.q)({isError:!1,errorMessage:"",errorLocalizedMessage:"",errorCode:"",dataResults:g},t.controlId,i))},e=>{let i="",r="",a="";try{if(e)if(e.reason)i=null!=e.reason.get_message()?e.reason.get_message():e.reason.get_organizationServiceFault().get_messages().get_Items().toString();else{i=null!=e.get_message()?e.get_message():"",r=null!=e.get_localizedMessage()?e.get_localizedMessage():"";const t=e.get_error()?JSON.parse(e.get_error()):"";a=t?t.error.code:""}}catch(e){i=e.message}Object(f.e)(e,s,Z,"timelinewall.data.retrieve.nextpage.async",i),n(Object(m.q)({isError:!0,errorMessage:i,errorLocalizedMessage:r,errorCode:a,dataResults:null},t.controlId,O))}))}else r("TimelineWall.emptyQueue")});if(_&&b)try{return await Promise.allSettled([_,P])}catch(e){Object(f.e)(e,s,Z,"timelinewall.data.retrieve.async")}return P}}}(a,e,s,t)).then(()=>{i(Object(m.p)(e.controlId,s,2,e.requestId))}),Promise.resolve()}}}function re(e,t){let i="";for(let e=0;e<t.length;e++)i+="<value>"+t[e]+"</value>";return String.format(e,i)}function ne(e,t,i,r,n){if((null==e?void 0:e.length)&&i.dataMap.FetchXML)return i.dataMap.FetchXML=re(i.dataMap.FetchXML,e),ae(t,i,c.n,r,k.a.tryCreate(n.recordId),n.recordEntityName)}function ae(e,t,i,r,n,a,s,l){switch(i){case m.i:return function(e,t,i,r,n){const a="IsDashboardContext",s="PageNumber",o="PageSize",l="CommentsPerPost",u="StartDate",d="EndDate",p="Source",h="SortDirection",m="Keyword",f=!0===Object(g.f)(i,c.y.TimelineWallUserPosts)?t.dataMap[p]||null:1;if(!0===t.dataMap[a])return he(e,"RetrievePersonalWall",v,D),b={pageNumber:t.dataMap[s],pageSize:t.dataMap[o],commentsPerPost:t.dataMap[l],startDate:t.dataMap[u],endDate:t.dataMap[d],type:null,source:f,sortDirection:t.dataMap[h],keyword:t.dataMap[m]},new q(b.pageNumber,b.pageSize,b.commentsPerPost,b.startDate,b.endDate,b.type,b.source,b.sortDirection,b.keyword);var b;return he(e,"RetrieveRecordWall",P,F),function(e){return new G(e.entity,e.pageNumber,e.pageSize,e.commentsPerPost,e.startDate,e.endDate,e.type,e.source,e.sortDirection,e.keyword)}({entity:new V.a(n,r),pageNumber:t.dataMap[s],pageSize:t.dataMap[o],commentsPerPost:t.dataMap[l],startDate:t.dataMap[u],endDate:t.dataMap[d],type:null,source:f,sortDirection:t.dataMap[h],keyword:t.dataMap[m]})}(e,t,r,n,a);case o.a.MoreEmails:case m.a:return de(e,t,t.dataMap.FetchXML,n,a);case c.r:{const e=t.dataMap.FetchXmlRegardingRecord;return new B.a(e)}case m.h:{const e=t.dataMap.FetchXML;return new B.a(e)}case c.n:{const e=t.dataMap.FetchXML;return new B.a(e)}case c.a:{const e=t.dataMap.ActivityFileAttachmentFetchXml;return new B.a(e)}case c.o:{const e=t.dataMap.PostImageFetchXml;return new B.a(e)}case o.a.Filters:case o.a.WhatsChanged:{const i=t.dataMap.FetchXMLs[l[s]],r=i.fetchXml;if(r){const s=i.requestType;if("RetrieveMultipleRequest"===s)return new B.a(r);if("RetrieveTimelineWallRecordsRequest"===s)return de(e,t,r,n,a)}return null}}}async function se(e,t,i,r,n,a){const s=t.queueTypeToRequestMap[e];if(s&&s.isEnabled&&s.dataMap&&s.dataMap.FetchXML){const e=t.queueTypeToRequestMap.Notes.dataMap.FetchXML,s=Q.c.fromXml(e);s.skipPagingDefaults=!0;const o=s.getQueryState();if(o)try{const e=await n(Object(K.e)(o,a));n(Object(m.q)({isError:!1,errorMessage:"",errorLocalizedMessage:"",errorCode:"",dataResults:e},i.controlId,m.h))}catch(e){pe(e,"TimelineWall.getTimelineWallActivities",r,m.h,i,n)}}}async function oe(e,t,i,r,n,a,s,o){const l=n.find(e=>e===m.a);if(l){const n=a.queueTypeToRequestMap[l];if(n.isEnabled&&(null==n?void 0:n.dataMap.FetchXML)){const u=ae(r,n,l,i,k.a.tryCreate(s.recordId),s.recordEntityName);if(u)try{const n=await me(u,t,{OperationSource:"TimelineWall.getTimelineWallActivities"},i,o),d=await async function(e,t,i,r,n,a,s,o,l){var u;const d=[];try{if(null===(u=null==r?void 0:r.queueTypeToRequestMap[a])||void 0===u?void 0:u.dataMap.FetchXmlRegardingRecord){const s=r.queueTypeToRequestMap[a],u=function(e,t,i,r,n){if((null==e?void 0:e.length)&&i.dataMap.FetchXmlRegardingRecord)return i.dataMap.FetchXmlRegardingRecord=re(i.dataMap.FetchXmlRegardingRecord,e),ae(t,i,c.r,r,k.a.tryCreate(n.recordId),n.recordEntityName)}(function(e,t){let i=[];const r=new Set;let n=[];const a=JSON.parse(e.get_timelineWallRecords());if(n=void 0!==a.entityCollection?a.entityCollection.Entities:a.Entities,a&&n){let e;n.forEach(i=>{var n,a,s,o,l,u;const d=null!==(n=null==i?void 0:i.Attributes)&&void 0!==n?n:[];for(let t=0;t<d.length;t++)if(d[t].Key===c.c.AllParties){e=d[t];break}const p=null!==(s=null===(a=null==e?void 0:e.Value)||void 0===a?void 0:a.Entities)&&void 0!==s?s:[];for(let e=0;e<p.length;e++){const i=null===(o=p[e])||void 0===o?void 0:o.Attributes;let n;for(let e=0;e<i.length;e++)if(i[e].Key===c.c.PartyId){n=i[e];break}const a=null===(l=null==n?void 0:n.Value)||void 0===l?void 0:l.Id,s=null===(u=null==n?void 0:n.Value)||void 0===u?void 0:u.LogicalName;a&&s&&s===t&&r.add(a)}}),i=Array.from(r.values())}return i}(e,c.c.Incident),i,s,o,n);if(u){const e=await me(u,t,{OperationSource:"TimelineWall.retrieveTimelineWallRegardingRecords"},o,l);d.push(e)}}}catch(e){Object(f.e)(e,s,"TimelineWall.retrieveTimelineWallRegardingRecords","timelinewall.data.retrieve.async")}return d}(n,t,r,a,s,l,e,i,o),p=[n];(null==d?void 0:d.length)&&p.push(...d),o(Object(m.q)({isError:!1,errorMessage:"",errorLocalizedMessage:"",errorCode:"",dataResults:(null==d?void 0:d.length)?p:n},s.controlId,l))}catch(t){pe(t,"TimelineWall.getTimelineWallActivities",e,l,s,o)}}}}async function le(e,t,i,r,n,a,s,o,l,c){if(t)await se(m.h,s,o,e,l,c);else{const t=a.find(e=>e===m.h);if(t){const a=s.queueTypeToRequestMap[t];if(a.isEnabled){const s=ae(n,a,t,r,k.a.tryCreate(o.recordId),o.recordEntityName);if(s)try{const e=await me(s,i,{OperationSource:"TimelineWall.getTimelineWallNotes"},r,l);l(Object(m.q)({isError:!1,errorMessage:"",errorLocalizedMessage:"",errorCode:"",dataResults:e},o.controlId,t))}catch(i){pe(i,"TimelineWall.getTimelineWallNotes",e,t,o,l)}}}}}async function ce(e,t,i,r,n,a,s,o){const l=n.find(e=>e===m.i);if(l){const n=a.queueTypeToRequestMap[l];if(n.isEnabled){const c=ae(r,n,l,i,k.a.tryCreate(s.recordId),s.recordEntityName);if(c)try{const e=await me(c,t,{OperationSource:"TimelineWall.getTimelineWallPosts"},i,o),n=[e],u=await ue(e,t,r,a,s,l,i,o);n.push(...u),o(Object(m.q)({isError:!1,errorMessage:"",errorLocalizedMessage:"",errorCode:"",dataResults:n},s.controlId,l))}catch(t){pe(t,"TimelineWall.getTimelineWallPosts",e,l,s,o)}}}}async function ue(e,t,i,r,n,a,s,o){const l=[];let u=[];const d=[],{userIds:p,postIds:h}=function(e,t){const i=[],r=[],n=e instanceof j||Object(g.f)(t,c.y.TimelineWallUnbatchedRequests)?e:e.get_response();if(n){const e=n.get_entityCollection();if(null!=e)for(const t of e){if(2===t.source){const e=t._createdby_value;-1===r.indexOf(e)&&r.push(e)}i.push(t.postid)}}return{userIds:r,postIds:i}}(e,s),m=r.queueTypeToRequestMap[a];if(m.dataMap.ActivityFileAttachmentFetchXml){const e=ne(h,i,m,s,n);if(e){const i=await me(e,t,{OperationSource:Z},s,o);l.push(i),d.push(...function(e){const t=[];if(e){const i=e.get_entityCollection(),r=null==i?void 0:i.get_entities();if(r)for(const e of r){const i=e.fields.postcommentid.toString();t.push(i)}}return t}(i))}}else{const e=ne(h,i,m,s,n);u.push(e)}if(u.push(function(e,t,i,r,n){if((null==e?void 0:e.length)&&i.dataMap.PostImageFetchXml)return i.dataMap.PostImageFetchXml=re(i.dataMap.PostImageFetchXml,e),ae(t,i,c.o,r,k.a.tryCreate(n.recordId),n.recordEntityName)}(p,i,m,s,n),function(e,t,i,r,n,a){if((e.length||t.length)&&r.dataMap.ActivityFileAttachmentFetchXml)return r.dataMap.ActivityFileAttachmentFetchXml=re(r.dataMap.ActivityFileAttachmentFetchXml,[...e,...t]),ae(i,r,c.a,n,k.a.tryCreate(a.recordId),a.recordEntityName)}(h,d,i,m,s,n)),u=u.filter(e=>e),u.length){const e=(await ge(new A.a(u,new x.a(!1,!0)),t,{OperationSource:Z},s,o)).get_responses();l.push(...e.map(e=>e.get_response()))}return l}function de(e,t,i,r,n){const a=t.dataMap.IsDashboardContext;he(e,"RetrieveTimelineWallRecords",I,R);const s=a?null:new V.a(n,r);return new U(i,s,t.dataMap.RollupType)}function pe(e,t,i,r,n,a){let s="";let o="";try{if(e instanceof L.a&&e.get_error()){const t=JSON.parse(e.get_error()).error;s=t.message,o=t.code}else s=e.message,o=e.errorCode.toString()}catch(e){s=e.message}Object(f.e)(e,i,t,"timelinewall.data.retrieve.nextpage.async",s),a(Object(m.q)({isError:!0,errorMessage:s,errorLocalizedMessage:"",errorCode:o,dataResults:null},n.controlId,r))}function he(e,t,i,r){e.requestSerializers.hasOwnProperty(t)||(e.requestSerializers[t]=i),e.responseDeserializers.hasOwnProperty(t)||(e.responseDeserializers[t]=r)}async function ge(e,t,i,r,n){if(Object(g.f)(r,c.y.TimelineWallAvoidDirectWebAPI)){const t=e.get_requests(),i=await async function(e,t){const i=[],r=e.get_requests();for(const e of r){const r=e.get_name(),n=ee[r](e),a=await t(n);i.push(a)}return i}(e,n),r=await n(Object(X.c)(i)),a=[];r.forEach((e,i)=>{a.push(n(te[t[i].get_name()](e,t[i])))});const s=await Promise.all(a);if(s&&s.length){const e=[];for(let t=0;t<s.length;t++)e.push(new H.a(null,t,s[t]));return new M.a(!1,e)}}return t.get_WebAPIService().Execute(e,null,i)}async function me(e,t,i,r,n){if(Object(g.f)(r,c.y.TimelineWallAvoidDirectWebAPI)){const t=e.get_name(),i=await n(ee[t](e)),r=await n(Object($.a)(i));return await n(te[t](r,e))}return t.get_WebAPIService().Execute(e,null,i)}var fe=i("Dea/"),be=i("WY/A"),ye=i("SAYH"),ve=i("odYE"),Se=i("iB7y");function _e(e){const t={},i=new ve.a(e.regardingEntityType,new ye.a(e.regardingEntityId)),r={reference:i,timestamp:new Date,validationResult:{isValueValid:!0,errorMessage:null,errorId:null,userInput:i}};t.objectid=r;switch(e.entityType){case"annotation":{const i=e.dataMap,r=["annotationid","notetext","subject","filename","mimetype","documentbody"];Object.entries(i).forEach(([e,i])=>{if(r.includes(e)){const r={value:n=i,timestamp:new Date,validationResult:{isValueValid:!0,errorMessage:null,errorId:null,userInput:n}};t[e]=r}var n})}break;default:console.error("No entity found")}return t}function Oe(e){const t=e.entityType;switch(t){case"annotation":return new ve.a(t,new ye.a(e.dataMap.annotationid));default:return new ve.a(t,ye.a.EMPTY)}}var Pe=i("65OV"),we=i("mFPv"),Ce=i("arV0"),Ie=i("pGYJ"),Ee=i("zmL5"),je=i("OtHk");var De=i("dHD5"),Te=i("ghNp");var Fe=i("Knfm"),Ne=i("GEbX"),Re=i("NjDY"),ke=i("V6aM");class Ae{constructor(e,t,i){this.objectWrapperType=3,this.previousReturn=new s({timelineWallData:null,timelineWallConfiguration:null,contextType:null,controlId:null,entitiesMetadata:null,getTimelineWallData:null,performTimelineWallCUDOperations:null,getCommands:null,getEntityAttributes:null,loadWebResource:null,isMultiSessionNavigationType:null}),this._isServerAvailable=null,this._upSyncStatus=null,this._propKey=t,this._pageId=i,this._retrieveTimelineWallData=t=>e(ie(t,i)),this._performTimelineWallCUDOperations=t=>e(function(e){return{type:"timelinewall.data.cud.async",async execute({dispatch:t,getState:i},r){const n=i();switch(e.operationType){case 0:const i=_e(e),r=Oe(e);try{const a=Object(be.b)(n,r,i,e.entityType,fe.a.Create),s=a.payload.snapshotId;t(a);const o=await t(Object(Se.b)(s,!1,null,null,null,null,3));t(Object(m.w)(!1,e.controlId,e.requestId,o))}catch(i){t(Object(m.w)(!0,e.controlId,e.requestId,i))}break;case 1:const a=_e(e),s=Oe(e);try{const i=Object(be.b)(n,s,a,e.entityType,fe.a.Update),r=i.payload.snapshotId;t(i);const o=await t(Object(Se.b)(r,!1,null,null,null,null,3));t(Object(m.w)(!1,e.controlId,e.requestId,o))}catch(i){t(Object(m.w)(!0,e.controlId,e.requestId,i))}break;case 2:const o=Oe(e);try{const i=await Xrm.WebApi.deleteRecord(e.entityType,o.id.guid);t(Object(m.w)(!1,e.controlId,e.requestId,i))}catch(i){t(Object(m.w)(!0,e.controlId,e.requestId,i))}}}}}(t)),this._retrieveTimelineCommands=(t,r,n,a,s)=>e(function(e,t,i,r,n){return{type:"retrieve.timelineRecordCommand.async",execute({dispatch:a,getState:s},o){let l=null;const c=s(),u=Object(Ce.j)(c,e);if("dashboard"===u.pageType){let t=u.dashboardId;t||(t=u.etn?Object(je.e)(c,u.etn):Object(Ee.b)(c,e)),l=t.guid+":notescontrol"}else l=u.entityTypeName+":notescontrol";return Object(Pe.a)(c,e,t,l,i,a,r,!0,n).then(e=>Object(we.d)(e,a),e=>{const i="Retrieve Timeline record commands failure error message";o.EventManager.ReportComponentFailure("TimelineWall.CustomControl.retrieveTimelineCommands",{name:"error",message:i},i,[{name:"APIName",value:Ie.a+".Actions.RetrieveTimelineCommands"},{name:"Action",value:"retrieve.timelineRecordCommand.async"},{name:"CommandMangerId",value:t}])})}}}(i,r,n,a,s)),this._getEntityAttributes=()=>{return e((t=i,{type:"getentityattributes.async.action",execute({dispatch:e,getState:i},r,n){const a=i(),s=Object(De.j)(a,t);if(null!==t&&null!==s){const i=e(Object(Te.b)(t,s));if(i&&i.data&&i.data.entity)return i.data.entity.attributes}return null},sync:!0}));var t},this._loadWebResource=(t,i)=>e(function(e,t){return{type:"loadWebResource.async.action",execute({dispatch:i,getState:r},n){const a=r(),s=Object(Re.x)(a),o=n.AssetLoader,l=!Object(u.c)(a);return o.loadWebResource(e,s,t,e=>i(Object(ke.a)(e)),l,!0).catch(e=>{throw e})}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(t,i))}linkToParameter(e,t){e.getTimelineWallData=this._retrieveTimelineWallData,e.performTimelineWallCUDOperations=this._performTimelineWallCUDOperations,e.loadWebResource=this._loadWebResource,e.getCommands=this.executeRetrieveTimelineWallCommandAction.bind(this),e.getEntityAttributes=this._getEntityAttributes}retrieveTimelineWallObject(e,t,i,r,u){const d=i.Parameters[this._propKey];if(this.isParameterOfTimelineWallType(d)){const i=Object(Ee.b)(e,t.id),h=Object(l.c)(r,t.controlId),g=Object(n.a)(e,t.id,i,h),f=Object(p.a)(e,g.LabelId,t.id);t&&t.descriptor&&g.Label!==t.descriptor.Label&&(g.Parameters[c.x.Label]=t.descriptor.Label);const b=e.data;if(!r.isPreview||!b.timelineWalls||b.timelineWalls[f]&&b.timelineWalls[f].requestStatusMap){const t=Object(a.a)(e,f),i=Object(l.d)(e,g,r,f,d,t,u);!t||t.target&&(!t.target||t.target.etn&&t.target.id)||r.entityTypeName&&r.id&&(t.target={etn:r.entityTypeName,id:r.id.guid});const n=Object(Fe.a)(e)===Ne.a.MultiSession;n&&t&&t.target&&!t.target.isAPI&&r&&r.entityTypeName&&(t.target={etn:r.entityTypeName,id:r.id&&r.id.guid});const o=new s({timelineWallData:t,timelineWallConfiguration:i?i.TimelineWallConfiguration:null,contextType:i?i.ContextType:null,controlId:f,entitiesMetadata:i?i.EntitiesMetadata:null,getTimelineWallData:null,performTimelineWallCUDOperations:null,getCommands:null,getEntityAttributes:null,loadWebResource:null,isMultiSessionNavigationType:n});return this._hasStateChanged(this.previousReturn,o,e)&&(this.previousReturn=o),this.previousReturn}u(Object(m.r)(f,null,null)),u(Object(m.p)(f,o.a.Metadata,2,null))}}_hasServerStateChanged(e){const t=null!==this._upSyncStatus&&Object(d.b)(e)!==this._upSyncStatus,i=null!==this._isServerAvailable&&Object(u.c)(e)!==this._isServerAvailable,r=i&&Object(u.c)(e)&&!Object(h.D)(e)||t&&Object(u.c)(e)||i&&!Object(u.c)(e);return this._isServerAvailable=Object(u.c)(e),this._upSyncStatus=Object(d.b)(e),r}_hasTimelineWallStateChanged(e,t){var i,r;if(!e.controlId||!e.timelineWallConfiguration&&t.timelineWallConfiguration||e.timelineWallConfiguration&&t.timelineWallConfiguration&&e.timelineWallConfiguration.Label!==t.timelineWallConfiguration.Label)return!0;const n=[o.a.Data,o.a.Filters,o.a.WhatsChanged,o.a.InitiateRefresh,o.a.MoreEmails,o.a.ContextualDialogEntity],a=n.length;for(let i=0;i<a;i++)if(t.timelineWallData&&e.timelineWallData&&t.timelineWallData.requestStatusMap&&e.timelineWallData.requestStatusMap&&(e.timelineWallData.requestStatusMap[n[i]].requestId!==t.timelineWallData.requestStatusMap[n[i]].requestId||e.timelineWallData.requestStatusMap[n[i]].status!==t.timelineWallData.requestStatusMap[n[i]].status))return!0;return!this._isResponseStatusEqual(null===(i=null==e?void 0:e.timelineWallData)||void 0===i?void 0:i.responsesStatus,null===(r=null==t?void 0:t.timelineWallData)||void 0===r?void 0:r.responsesStatus)}getLatestData(){return this.previousReturn}isLoading(){return!(this.previousReturn&&this.previousReturn.timelineWallConfiguration||Object(p.c)())}isParameterOfTimelineWallType(e){return!!e&&e.Type===r.a.TimelineWall}executeRetrieveTimelineWallCommandAction(e,t){if(e[0]&&e[0].name&&this._activityCommandManagerId)return this._retrieveTimelineCommands(this._pageId,this._activityCommandManagerId,e,t)}getParameterManifestType(){return r.a.TimelineWall}ensureTimelinewallCommandsInitialization(e){this._ownProps=e,this._initializeCommandManager()}_initializeCommandManager(){null==this._activityCommandManagerId&&(this._activityCommandManagerId=this._createHiddenCommandManager(this._ownProps,"activitypointer"))}_createHiddenCommandManager(e,t){const i=e.id+":"+e.controlId+":"+t;return e.actions.registerNewControl(e.contextToken,e.id,e.controlId,e.descriptor.LabelId),e.actions.initializeCommandManager(e.id,e.contextToken,e.controlId,i,"SubGridStandard:activitypointer"),i}_hasStateChanged(e,t,i){return this._hasTimelineWallStateChanged(e,t)||this._hasServerStateChanged(i)}_isResponseStatusEqual(e,t){if(e===t)return!0;if((null==e?void 0:e.length)!==(null==t?void 0:t.length))return!1;for(let i=0;i<e.length;i++){const r=e[i],n=t[i];if(r.requestId!==n.requestId)return!1}return!0}}},nIfK:function(e,t,i){"use strict";i.d(t,"f",(function(){return U})),i.d(t,"a",(function(){return R})),i.d(t,"e",(function(){return A})),i.d(t,"d",(function(){return L})),i.d(t,"b",(function(){return x})),i.d(t,"c",(function(){return M}));var r=i("Yx7Y"),n=i("SAYH"),a=i("vNXc"),s=i("9fGf"),o=i("Z/4N"),l=i("P6DH"),c=i("p/2N"),u=i("iZ7K"),d=i("sn0j"),p=i("y60j"),h=i("BJ7u"),g=i("JwRZ"),m=i("504W"),f=i("IqkD"),b=i("CB5L"),y=i("odYE"),v=i("i1f0"),S=i("bT7G"),_=i("00VO"),O=i("YGjz"),P=i("LbMF"),w=i("BFlg"),C=i("Lyxw"),I=i("3/02"),E=i("jAuy"),j=i("/Zy9"),D=i("arV0"),T=i("z+5+"),F=i("d0w6"),N=i("AF/G");const R=[w.D,w.C,w.y,"MscrmControls.Grid.GridControl","MscrmControls.SharepointAssociatedGrid.SharepointControl","MscrmControls.MailApp.MailAppListControl"],k=["Opportunity_ActivityPointers"];function A(e){const t=e&&e.control&&e.control.Parameters&&e.control.Parameters.hasOwnProperty(w.F)&&e.control.Parameters[w.F],i=[e.viewId,t,e.recordsPerPage,(r=e,r&&r.controlParameters&&r.controlParameters.ChartDrillDownParameters&&r.controlParameters.ChartDrillDownParameters.length>0)];var r;return e.customQueryStateKeyParts&&i.push(...e.customQueryStateKeyParts),i.join("")}function M(e,t,i,r,n){const s=x(e,t,i,r,n);return t=>{const i=s(t);return i&&i.getQueryState(i instanceof a.a?void 0:e)}}function x(e,t,i,r,o){const c={};return u=>{const d=new n.a(u.viewId),p=Object(l.tb)(e(),d,t);if(!p)return null;const h=function(e,t,i){let r=t.fetchXML,n=null;const a="TeamTemplateId";if(t.entityLogicalName===O.a&&e.controlParameters[a]){const t=e.controlParameters[a];if(r&&r.indexOf(t)<0){const e=i?i.guid:"",a=Object(_.a)(r,t,e);r=a.updatedFetchXml,n=a.filterString}}return{fetchXML:r,filterString:n}}(u,p,r);let w=h.fetchXML;if(!w&&p.queryApi)return null;const R=e(),A=u.getCustomFilter&&u.getCustomFilter(),M=function(e,t,i,r,a){const s=a.controlParameters.RelationshipName;if(s){let o=r,c=null,u=null;if(a.controlParameters.DependentAttributeName){u=a.controlParameters.DependentAttributeName;c=u.split(".")[1]||u}if(a.controlParameters.IsDataSetLookup&&(o=null==a.controlParameters.ParentRecordId?n.a.EMPTY:new n.a(a.controlParameters.ParentRecordId),a.controlParameters.DependentAttributeName)){u=a.controlParameters.DependentAttributeName;c=u.split(".")[1]||u}const d=Object(v.hc)(e,t,a.contextToken),p=new y.a(i,o);let h=null,g=!1;Object(P.a)(e,i,c)?h=Object(S.e)(e,d,p,c):a.controlParameters.DependentAttributeType&&(g=a.controlParameters.DependentAttributeType===i&&a.controlParameters.DependentAttributeType!==a.entityLogicalName);const m=h;m&&m.reference?o=m.reference.id:!a.controlParameters.IsDataSetLookup&&null===c||null!==m&&null!==m.reference||!p||null===p.id||g||(o=null);const f=Object(l.nb)(e,t,a.contextToken);let _=0,O=b.h.None;return f?(_=1,-1===k.indexOf(s)&&(O=b.h.Related)):(a.controlParameters.ShouldApplyContextFilter&&a.controlParameters.IsDataSetLookup||!a.controlParameters.IsDataSetLookup)&&(_=2),{type:_,rollupType:O,entityReference:p,contextId:o,relationshipName:s}}return null}(R,t,o||i&&i.EntityLogicalName,r,u),x=u.entityLogicalName,V=Object(g.p)(e(),x),B=!(!(null==h?void 0:h.filterString)||!r),z=function(e,t,i,r,a,s,o,c){var u,d;const p=Object(D.j)(e,s),h=!(!(null==p?void 0:p.pageToEditedViewMapId)||!Object(l.ub)(e,p.pageToEditedViewMapId.guid,o.guid)),g=a||r&&r.filter&&Array.isArray(r.filter)&&r.filter.length>0,m=Object(l.tb)(e,o,s),f=t.hasGrid&&(1===t.gridType||void 0===t.gridType&&n.a.equals(null===(u=t.control)||void 0===u?void 0:u.ClassId,N.E)),b=t.quickFindViewId||(null==m?void 0:m.queryType)===F.a.QUICKFIND_SEARCH,y=(null===(d=null==r?void 0:r.linkEntities)||void 0===d?void 0:d.length)>0,v=2===(null==i?void 0:i.type),S=1===(null==i?void 0:i.type),_=!0===(null==m?void 0:m.isCustomView);return Object(T.x)(e,f,!!g,y,v,!!b,S,h,c)||Object(T.y)(e,S,h,c,_)||Object(T.z)(e,S,h,c)}(R,u,M,A,V,t,d,B);let U,W=!1;if(Object(E.l)(e(),t)&&u.quickFindViewId){const i=new n.a(u.quickFindViewId),r=n.a.isNullOrEmpty(i)?null:Object(l.tb)(e(),i,t);Object(m.a)(r)||z||(w=function(e,t){const i=new DOMParser;if(e){const r=i.parseFromString(e.fetchXML,"text/xml"),n=i.parseFromString(t.fetchXML,"text/xml"),a=r.getElementsByTagName("filter");for(let e=0;e<a.length;e++)a[e].attributes&&a[e].attributes.getNamedItem("isquickfindfields")&&n.getElementsByTagName("entity")[0].appendChild(a[e]);return(new XMLSerializer).serializeToString(n)}return t.fetchXML}(r,p)),W=!0}z?(U=j.c.fromView(d,u.quickFindSearchString),W&&U.mergeQuickFind(new n.a(u.quickFindViewId))):U=a.a.fromXmlAndSql(w,p.offlineSqlQuery,d,u.quickFindSearchString,x,e),B&&U.addExistingContextFilterToKey(n.a.toString(r),h.filterString);const G=Object(l.y)(e(),t,u.contextToken);G&&(U.pageNumber=G);const q=L(e(),t,i,u,p,x);q.length&&U.select(...q);const H=function(e,t,i,r,n,a){let o=null;if(!Object(C.e)(e,I.Tc)||!a.hasGrid||1!==a.gridType)return null;const c=Object(l.j)(r)(e,t,a.contextToken),u=Object(s.b)(e),d=c&&c.CustomControls&&c.CustomControls[u]&&c.CustomControls[u].Parameters;if(!Object(l.yb)(d)&&(o=Object(l.o)(e,i),o)){const e=[],t=n&&n.grid&&n.grid.rows&&n.grid.rows[0]&&n.grid.rows[0].cells;if(t)for(const i in t)t.hasOwnProperty(i)&&e.push(t[i].name);-1!==e.indexOf(o.lookupAttribute)&&(o.lookupAttribute=null),n&&n.fetchXML&&Object(E.b)(n.fetchXML)&&(o.primaryAttribute=null)}return o}(e(),t,x,d,p,u);H&&(H.lookupAttribute&&U.select(H.lookupAttribute),H.primaryAttribute&&U.addChildCountAttribute(H.primaryAttribute));const Q=u.getCustomSorting&&u.getCustomSorting(p,c);if(Q)for(const e of Q)U.orderBy(e.name,1===e.sortDirection);if(M)switch(M.type){case 1:U.applyRollupContextFilter(M.entityReference,M.rollupType);break;case 2:const e=Object(l.v)(R,t,u.contextToken);U.applyContextFilter(M.relationshipName,M.contextId,R,e?e.relationshipRoleOrdinal:void 0)}if(V&&U.where(V),A&&A.filter)if(Array.isArray(A.filter)){const e=A.filter;for(const t of e)U.where(t,t.shouldReplace)}else{const e=A.filter;!function(e){return!!(e&&e.operator&&e.terms)}(e)?U.where(Object(g.n)(A.filter,null)):U.where(e,e.shouldReplace)}if(A&&A.linkEntities)for(const e of A.linkEntities)U.addLinkedEntity(e,e.attributes||[]);const K=u.recordsPerPage;if(K)U.pageSize=K;else{const t=Object(f.h)(e());u.hasChart||Object(m.a)(t)?U instanceof a.a&&U.setDefaultPageSize():U.pageSize=t}return U}}function L(e,t,i,r,n,a){const s=[...V(e,i,r,n.viewId),...B(e,r,a,n.viewId),...z(e,i,r,a),...W(e,r,a),...G(e,t,r,a),...r.getCustomColumns?r.getCustomColumns():[]];if(s.length){const e=[],t=[],i=n&&n.grid&&n.grid.rows&&n.grid.rows[0]&&n.grid.rows[0].cells;if(i)for(const e in i)i.hasOwnProperty(e)&&t.push(i[e].name);for(const i in s){const r=s[i];-1===t.indexOf(r)&&-1===e.indexOf(r)&&e.push(r)}return e}return s}function V(e,t,i,r){if(0!==i.gridType)return[];let n="Grid";const a=Object(s.b)(e),u=t&&Object(o.a)(i.control,t,a);return u&&(n=Object(l.db)(e,u.CustomControlId)),Object(c.b)(e,i.control.UniqueId,n,t&&t.Id,null,null,r)||[]}function B(e,t,i,r){return 1!==t.gridType?[]:Object(c.a)(e,i,r)||[]}function z(e,t,i,r){const n=[],a=Object(u.h)(e,r);return a&&(U(e,t,i.control)||i.hasGrid)&&("activitypointer"===r&&n.push("activitytypecode"),a.PrimaryNameAttribute&&n.push(a.PrimaryNameAttribute),Object(l.yb)(i.controlParameters)||a.PrimaryImageAttribute&&n.push(Object(E.a)(a.PrimaryImageAttribute))),n}function U(e,t,i){const r=Object(s.b)(e),n=t&&Object(o.a)(i,t,r);return n&&[n.CustomControlId&&n.Name].some(e=>-1!==R.indexOf(e))}function W(e,t,i){const r=[];if(4&t.streamMode){r.push("modifiedon");const t=Object(P.d)(e,i);if(t)for(const n in t){const a=t[n];a.IsSortableEnabled&&"image"!==a.Type&&"multiselectpicklist"!==a.Type&&Object(d.b)(e,i,a.LogicalName,a)&&r.push(a.LogicalName)}}else 2&t.streamMode&&r.push("modifiedon");return r.sort()}function G(e,t,i,a){const s=[],o=i.cardFormId;if(o)if("activitypointer"===a)s.push(...d.a);else{const i=n.a.equals(o,r.a)?Object(p.f)(e,a,Object(h.a)(11)):o,l=Object(p.c)(e,i,t);if(l)for(const e in l){const t=l[e];t.DataFieldName&&s.push(t.DataFieldName)}}return s}},ojtV:function(e,t,i){"use strict";i.d(t,"a",(function(){return v})),i.d(t,"b",(function(){return S}));var r=i("dHD5"),n=i("BFlg"),a=i("dQnL"),s=i("KBcj"),o=i("SAYH"),l=i("P6DH"),c=i("CngE"),u=i("iZ7K"),d=i("qwRa"),p=i("WK+4"),h=i("BzGi"),g=i("EY5k"),m=i("GEBM"),f=i("69Qu"),b=i("LAGg"),y=i("37s6");const v="chart.showChart.update";function S(e,t,i){return{type:"chart.showChart.update.async",execute({dispatch:v,getState:S},O){const P=O.TraceManager.getTracer(n.P),w=n.N+".updateShowChartAction";try{P.info("Updating the show chart"),t||(t=Object(r.l)(S(),e));const n=S(),C=Object(r.w)(t),I=Object(l.V)(n,e,t),E=Object(s.c)(n,I),j=E&&E.entityLogicalName;let D=Object(l.r)(n,e,t,j),T=Object(l.s)(n,e,t);const F=Object(c.a)(n,D),N=F&&F.PrimaryEntityTypeCode,R=N&&Object(u.m)(n,parseInt(N,10));j&&R&&j!==R&&(D=null,T=h.a.savedvisualization);const k=Object(c.i)(n,j);if(D&&k&&k.chartTypes&&Object.keys(k.chartTypes).length>0){const e=o.a.toString(D);T=e in k.chartTypes[h.a[h.a.savedvisualization]]?h.a.savedvisualization:h.a.uservisualization}if(!i)return v(_(e,C,i)),O.EventManager.ReportComponentSuccess(w),Promise.resolve();if(Object(y.E)(n)?!Object(f.b)(n):!Object(f.c)(n))return Promise.resolve();return v(Object(g.e)(m.z)).then(()=>{v(Object(a.a)(j,T,D)).then(i=>o.a.isNullOrEmpty(i)?(T=h.a.uservisualization,v(Object(d.b)(e,t,T)).then(()=>v(Object(a.a)(j,T,D)).then(e=>e))):i).then(r=>{const n=o.a.toString(r);Promise.all([v(Object(p.b)(e,t,n)),v(Object(d.b)(e,t,T)),v(_(e,C,i))]).then(()=>{O.EventManager.ReportComponentSuccess(w),v(Object(b.b)(e,t))})})}).catch(e=>{throw O.EventManager.ReportComponentFailure(w,Error("Retrieve resource strings for chart failed")),e}),Promise.resolve()}catch(e){const t="Update the show chart failed with error : "+e.message;O.EventManager.ReportComponentFailure(w,Error(t))}}}}function _(e,t,i){return{type:v,payload:{name:"showChart",value:i},meta:{pageId:e,dataSetContextKey:t}}}},"p/2N":function(e,t,i){"use strict";i.d(t,"b",(function(){return c})),i.d(t,"a",(function(){return p})),i.d(t,"d",(function(){return d})),i.d(t,"c",(function(){return u}));var r=i("izYK"),n=i("KBcj"),a=i("Z/4N"),s=i("vmcK"),o=i("9fGf");function l(e,t,i,n){const a=Object(o.b)(e);if(!(t&&t.CustomControls&&t.CustomControls[a]&&t.CustomControls[a].Parameters))return null;const s=t.CustomControls[a].Parameters;let l=null;if(n&&s[n]){s[n].Type===r.a.Grid&&(l=s[n])}else for(const e in s){const t=s[e];if(t.Type===r.a.Grid){l=t;break}}if(l&&l.Columns){const e=l.Columns,t=[];for(const r in e){const{Name:n}=e[r];n&&-1===t.indexOf(n)&&-1===i.indexOf(n)&&t.push(n)}return t}return null}function c(e,t,i,r,s,o,c){const d=Object(n.c)(e,c);if(!(r||s||e&&d&&e.metadata&&e.metadata.formDefaults&&o&&e.metadata.formDefaults[o]))return null;const p=r||e.metadata.formDefaults[o][s].formId;return l(e,Object(a.b)(e,t,p),u(d),i)}function u(e){const t=d(e);return t?t.map(e=>e.name):[]}function d(e){return e&&e.grid&&e.grid.rows&&e.grid.rows[0]&&e.grid.rows[0].cells?e.grid.rows[0].cells:[]}function p(e,t,i){const r=Object(n.c)(e,i);return r?l(e,Object(a.d)(e,t,s.a),u(r)):[]}},p8cR:function(e,t,i){"use strict";i.d(t,"b",(function(){return si})),i.d(t,"a",(function(){return oi}));var r=i("izYK"),n=i("sozv"),a=i("SAYH"),s=i("7fV9"),o=i("69Qu"),l=i("KBcj"),c=i("d0w6"),u=i("arV0");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class d{getDataSetParameter(e){throw new Error("Not wrapped")}getTargetEntityNames(){throw new Error("Not wrapped")}refresh(e){throw new Error("Not Replaced")}getRecentItems(e){throw new Error("Not Replaced")}getLookupConfiguration(){throw new Error("Not Replaced")}getAllViews(e){throw new Error("Not Replaced")}getDefaultViewId(e){throw new Error("Not Replaced")}setMyRecordsOnlyFilter(e){throw new Error("Not Replaced")}sendLookupRequest(e,t,i,r,n){throw new Error("Not Replaced")}runPreSearch(){throw new Error("Not Replaced")}usePresenceStatus(e){throw new Error("Not Linked")}useProfilePhoto(e){throw new Error("Not Linked")}}var p=i("j9v9"),h=i("i1f0"),g=i("w10E"),m=i("KCGk"),f=i("Xi8U"),b=i("5ZBI"),y=i("R5Qn"),v=i("Znul"),S=i("u2Wk"),_=i("Lyxw"),O=i("F3eT"),P=i("3/02"),w=i("+QYJ"),C=i("Uv1Y"),I=i("E3i9"),E=i("q/4y"),j=i("2ciq"),D=i("YxC/");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const T="CustomControlFramework.Models.Lookups.MultiEntityTypeLookupObjectWrapper",F=a.a.EMPTY;class N{constructor(e,t){this._dataSetWrappers={},this._dataSetParameters={},this._viewSelectorItemsByTypeById={},this._viewIdByEtn={},this._targetEntityTypeNames=null,this._lookupMruWrapper=null,this._lookupConfigurationWrapper=null,this._propKey=e,this._contextToken=t,this._metadataInitCalled=!1,this._lookupMruWrapper=new g.a,this._lookupConfigurationWrapper=new m.a}getPropKey(){return this._propKey}getLatestData(){return this.previousReturn}getLatestFieldData(){return this._previousFieldData}retrieveTargetEntityNames(e,t,i){const r=i;if(r.entityTypes&&r.entityTypes.length>0)return r.entityTypes;if(this._contextToken&&(this._contextToken.entityTypeName||i.entityTypeName)){const r=this._contextToken;r.entityTypeName=r.entityTypeName||i.entityTypeName;const n=t.configuration.Parameters[this.getPropKey()];if(0===n.Usage)return Object(h.Vb)(e,t.id,r,n.Value);if(3===n.Usage){const e=n;return e.Attributes&&e.Attributes.Targets}}return null}createParameterInstance(){return new d}_generateDataSetKey(e,t){return t&&this._viewIdByEtn[e]!==t?e+":"+t:e+":"+F.guid}retrieveDataSetObject(e,t,i,r){const n={};let a,d=!1,g=!1,m="",v="";if(this._pageId=t.id,this._pageEtn=r.entityTypeName,this._controlId=t.descriptor.parentFieldSectionItem?t.descriptor.parentFieldSectionItem:t.controlId,this._attributeName=Object(j.b)(i,this._propKey),this._shouldUseLookupService(e,i.CustomControlId)&&!this._entityMetadata){const i=Object(y.f)(e,this._pageEtn,this._attributeName,t.id);if(a=Object(I.b)(e,i),a){this._entityMetadata={},this._entityDefaultViews={};for(const e in a)this._entityMetadata[e]=this.convertEntityDescriptorToEntityMetadata(a[e].entity),this._entityDefaultViews[e]=a[e].view,d=!0}}this._checkCustomViews(e,this.retrieveTargetEntityNames(e,t,r));const S=i.Parameters[this._propKey];let _;if(_=S.TargetEntityTypes?S.TargetEntityTypes:3===S.Usage&&S.Attributes?S.Attributes.Targets:this.retrieveTargetEntityNames(e,t,r),null===_||0===_.length){const i=t?Object(u.p)(e,t.id):"",n=t&&t.configuration?Object(b.b)(e,t.configuration.CustomControlId)||Object(b.b)(e,t.configuration.Name):T,a=[{name:"EntityName",value:r&&r.entityTypeName},{name:"RecordId",value:r&&r.id&&r.id.guid},{name:"FieldName",value:t&&t.controlId},{name:"IsOffline",value:!Object(o.c)(e)},{name:"PageType",value:i}];b.a.warn(n+": No target entities found",a)}const O=Object(h.hb)(e,t.id,this._contextToken),P=S;for(const a in _){const s=_[a],u=Object(l.a)(e,s,c.a.LOOKUP_VIEW),h=this._getDefaultView(s,O,this._controlId,this._entityDefaultViews,u,P,e,this._viewSelectorItemsByTypeById);h&&(this._viewIdByEtn[s]=h.guid);this._viewSelectorItemsByTypeById&&this._viewSelectorItemsByTypeById[s]&&Object.keys(this._viewSelectorItemsByTypeById[s]).length>0&&Object.keys(this._viewSelectorItemsByTypeById[s]).forEach(o=>{const l=this._generateDataSetKey(s,o);if(!this._dataSetWrappers[l]||!this._targetEntityTypeNames||_[a]!==this._targetEntityTypeNames[a]){const e=this._viewSelectorItemsByTypeById[s][o],i=e&&e.isUserView?c.b.userview:c.b.savedview;this._dataSetWrappers[l]=new p.a(s,this._propKey,this._contextToken,o,i),this._dataSetWrappers[l].updatePreviousOwnProps(t),this._dataSetParameters[l]=null}const u=this._dataSetWrappers[l];if(o){u.setViewId(o);let a=u.retrieveDataSetObject(e,t,i,r);a||(a=u.generateEmptyParam()),n[l]=a}else n[l]=u.generateEmptyParam(),this._dataSetParameters[l]&&this._dataSetParameters[l].error?n[l].error=!0:n[l].loading=!0;n[l]!==this._dataSetParameters[l]&&(this._dataSetParameters[l]=n[l],d=!0)});const f=this._generateDataSetKey(s,this._viewIdByEtn[s]);this._dataSetWrappers[f]&&this._targetEntityTypeNames&&_[a]===this._targetEntityTypeNames[a]||(this._dataSetWrappers[f]=new p.a(s,this._propKey,this._contextToken),this._dataSetWrappers[f].updatePreviousOwnProps(t),this._dataSetParameters[f]=null);const b=this._dataSetWrappers[f];if(b&&b.queryBuilder){const t=b.queryBuilder.getFirstError();!t||Object(o.c)(e)&&t.offlineModeSpecific||(g=!0,m=t.message,v=t.parameter)}if(h){b.setViewId(h.guid);let a=b.retrieveDataSetObject(e,t,i,r);a||(a=b.generateEmptyParam()),n[f]=a}else b.savePreviousOwnProps(t),n[f]=b.generateEmptyParam(),this._dataSetParameters[f]&&this._dataSetParameters[f].error?n[f].error=!0:n[f].loading=!0;n[f]!==this._dataSetParameters[f]&&(this._dataSetParameters[f]=n[f],d=!0)}if(this._targetEntityTypeNames=_,this._lookupConfigurationWrapper.updateConfiguration(S,t.descriptor),this._lookupMruWrapper.updateRecentItems(Object(f.f)(e),_,this._lookupConfigurationWrapper.getLookupConfiguration()),d&&(this.previousReturn=this.createParameterInstance(),this.previousReturn.getDataSetParameter=this.getDataSetParameter.bind(this),this.previousReturn.getTargetEntityNames=this.getTargetEntityNames.bind(this),this.previousReturn.entityMetadata=this._entityMetadata),g){if(this.previousReturn.error=!0,this.previousReturn.errorMessage=Object(D.b)(e,m),!this.previousReturn.errorMessage)return this.previousReturn.errorMessage=s.a.UnknownErrorMessage,this.previousReturn;v&&(this.previousReturn.errorMessage+=" "+v)}return this.previousReturn}_checkCustomViews(e,t){if(e&&e.metadata&&e.metadata.views&&t){const i=[],r=[];for(const t in e.metadata.views){e.metadata.views[t].isCustomView&&r.push(t)}for(const t in r){const n=r[t];i.push({id:n,name:e.metadata.views[n].title,queryType:c.a.CUSTOM_DEFINED_VIEW,isDefault:!1,isQuickFindQuery:!1,isUserView:!1,isPinned:!1,relatedEntityName:e.metadata.views[n].entityLogicalName,isAvailableInOffline:!0})}for(const e in t){const r=t[e],n=i.filter(e=>e.relatedEntityName===r),a={};n&&n.length>0&&(n.forEach(e=>{a[e.id]=e}),this._viewSelectorItemsByTypeById[r]=Object.assign(Object.assign({},this._viewSelectorItemsByTypeById[r]),a))}}}_getDefaultView(e,t,i,r,n,s,o,l){const c=t&&t[i]&&t[i].parameters&&t[i].parameters.defaultviewid&&this._doesViewSupportEntity(o,e,t[i].parameters.defaultviewid)?new a.a(t[i].parameters.defaultviewid):null,u=r&&r[e]&&r[e].viewId?new a.a(r[e].viewId):null;let d;return d=this._shouldUseLookupService()?u||c:c&&l[e]&&l[e][t[i].parameters.defaultviewid]?c:s&&s.ViewId&&this._doesViewSupportEntity(o,e,s.ViewId)?new a.a(s.ViewId):c||n,"string"==typeof d&&(d=new a.a(d)),d}_doesViewSupportEntity(e,t,i){if(!e||!e.metadata||!e.metadata.views)return!0;const r=e.metadata.views[i];return!r||!r.entityLogicalName||r.entityLogicalName===t}_queryBuilderHasErrors(){return this._dataSetWrappers&&Object.keys(this._dataSetWrappers).forEach(e=>{if(this._dataSetWrappers[e].queryBuilder&&this._dataSetWrappers[e].queryBuilder.getFirstError())return!0}),!1}setControlReRender(e){this._dataSetWrappers&&Object.keys(this._dataSetWrappers).forEach(t=>{this._dataSetWrappers[t].setControlReRender(e)})}extendByFieldData(e,t=null){const i=this._queryBuilderHasErrors()&&this.previousReturn&&this.previousReturn.error,r=i?this.previousReturn.errorMessage:"";return null!==t&&this._previousFieldData!==t?(this._previousFieldData=t,this.previousReturn=Object.assign(Object.assign({},e),this._previousFieldData)):this.previousReturn=Object.assign(e,this._previousFieldData),this.previousReturn.entityMetadata=this._entityMetadata,i&&(this.previousReturn.error=i,this.previousReturn.errorMessage=r),this.previousReturn}linkToParameter(e,t){const i=t.refreshDataSetParameter;this._dataSetWrappers&&Object.keys(this._dataSetWrappers).forEach(e=>{this._dataSetWrappers[e].linkToParameter(this._dataSetParameters[e],t)}),e.refresh=this.refresh.bind(this,i),e.getRecentItems=this._lookupMruWrapper.getRecentItems.bind(this._lookupMruWrapper),e.getLookupConfiguration=this._lookupConfigurationWrapper.getLookupConfiguration.bind(this._lookupConfigurationWrapper),e.generateAdditionalAttributes=this.ensureLookupMetaDataInitialization.bind(this,{retrieveLookupMetadataAction:t.retrieveLookupMetadataAction,refreshDataSetParameter:t.refreshDataSetParameter,retrieveViewAction:t.retrieveViewAction}),e.getAllViews=this.getAllViews.bind(this,{retrieveViewAction:t.retrieveViewAction,retrieveViewSelectorAction:t.retrieveViewSelectorAction}),e.getDefaultViewId=this.getDefaultViewId.bind(this),e.sendLookupRequest=this.searchLookup.bind(this,t),e.setMyRecordsOnlyFilter=this.setMyRecordsOnlyFilter.bind(this),e.runPreSearch=()=>{this._contextToken&&t.runPreSearch(this._contextToken,this._controlId,this._pageId)},e.usePresenceStatus=this._usePresenceStatus.bind(this,t.usePresenceStatus),e.useProfilePhoto=this._useProfilePhoto.bind(this,t.useProfilePhoto),e.executeNotifyHandlersThatEventOccurred=this._executeNotifyHandlersThatEventOccurred.bind(this,t)}_executeNotifyHandlersThatEventOccurred(e,t,i){return this._contextToken?e.executeNotifyHandlersThatEventOccurred({contextToken:this._contextToken,fieldName:this._controlId,pageId:this._pageId,record:i,eventName:t}):Promise.resolve(!1)}setMyRecordsOnlyFilter(e){this._dataSetWrappers&&Object.keys(this._dataSetWrappers).forEach(t=>{this._dataSetWrappers[t].setMyRecordsOnlyFilter(e)})}getDefaultViewId(e){return this._viewIdByEtn&&this._viewIdByEtn[e]?this._viewIdByEtn[e]:null}getAllViews(e,t,i){let r=[];if(!i){const i=e.retrieveViewAction(t,c.a.MAIN_APPLICATION_VIEW,c.b.savedview),n=e.retrieveViewAction(t,c.a.LOOKUP_VIEW,c.b.savedview);r=r.concat([i,n])}const n=this._dataSetWrappers[this._generateDataSetKey(t,this._viewIdByEtn[t])],a=n&&n.getAvailableViews()||[];if(n){const t=n.getMissingDescriptorIds();t&&t.forEach(t=>{r.push(n.retrieveView(t,e.retrieveViewAction))})}return Promise.all(r).then(()=>{const r=[];let n=[];if(!i){const i=e.retrieveViewSelectorAction(t,c.a.LOOKUP_VIEW).then(e=>{const i=e.viewSelectors[t][c.a[c.a.LOOKUP_VIEW]];i&&(this._viewSelectorItemsByTypeById[t]=Object.assign(Object.assign({},this._viewSelectorItemsByTypeById[t]),i),Object.keys(i).forEach(e=>{(0===a.length||a.indexOf(e.toLocaleLowerCase())>-1)&&r.push({viewId:e,viewName:i[e]?i[e].name:null,isDefault:i[e]?i[e].isDefault:null,isAvailableInOffline:i[e]?i[e].isAvailableInOffline:null,isUserView:i[e]?i[e].isUserView:null,isPinned:i[e]?i[e].isPinned:null,relatedEntityName:i[e]?i[e].relatedEntityName:null})}))}),s=e.retrieveViewSelectorAction(t,c.a.MAIN_APPLICATION_VIEW).then(e=>{const i=e.viewSelectors[t][c.a[c.a.MAIN_APPLICATION_VIEW]];i&&(this._viewSelectorItemsByTypeById[t]=Object.assign(Object.assign({},this._viewSelectorItemsByTypeById[t]),i),Object.keys(i).forEach(e=>{(0===a.length||a.indexOf(e.toLocaleLowerCase())>-1)&&r.push({viewId:e,viewName:i[e]?i[e].name:null,isDefault:!1,isAvailableInOffline:i[e]?i[e].isAvailableInOffline:null,isUserView:i[e]?i[e].isUserView:null,isPinned:i[e]?i[e].isPinned:null,relatedEntityName:i[e]?i[e].relatedEntityName:null})}))});n=n.concat([i,s])}const s=new Promise(e=>{for(const e in this._viewSelectorItemsByTypeById[t]){const i=this._viewSelectorItemsByTypeById[t][e];i.queryType===c.a.CUSTOM_DEFINED_VIEW&&r.push({viewId:e,viewName:i.name,isDefault:i.isDefault,isAvailableInOffline:i.isAvailableInOffline,isUserView:i.isUserView,isPinned:i.isPinned,relatedEntityName:i.relatedEntityName})}e()});return n.push(s),Promise.all(n).then(()=>r)})}refresh(e,t){let i;if(this._lookupServiceEnabled=!1,t)i=e(this._dataSetWrappers[this._generateDataSetKey(t,null)],this._contextToken);else{const t=[];for(const i of this._targetEntityTypeNames){const r=e(this._dataSetWrappers[this._generateDataSetKey(i,null)],this._contextToken);t.push(r)}i=Promise.all(t)}return i.then(()=>this)}getDataSetParameter(e,t){return this._dataSetParameters[this._generateDataSetKey(e,t)]}getTargetEntityNames(){return[...this._targetEntityTypeNames]}convertEntityDescriptorToEntityMetadata(e){return{IsReadOnlyInMobileClient:e.IsReadOnlyInMobileClient,IsEnabledInUnifiedInterface:e.IsEnabledInUnifiedInterface,DisplayName:e.DisplayName,PrimaryNameAttribute:e.PrimaryNameAttribute,LogicalName:e.EntityLogicalName,DisplayCollectionName:e.DisplayCollectionName,IconVectorName:e.IconVectorName,ObjectTypeCode:e.ObjectTypeCode,Attributes:null}}ensureLookupMetaDataInitialization(e){if(e.retrieveViewAction&&!this._metadataInitCalled){this._metadataInitCalled=!0;const t=this._dataSetWrappers;for(const i of Object.values(t))i.ensureViewId(e.retrieveViewAction)}}searchLookup(e,t,i,r,n,s){const o=[];let l=!1;for(const e in t){let i="";const c=this._dataSetWrappers[`${e}:${t[e]}`]||this._dataSetWrappers[`${e}:${a.a.EMPTYGUIDSTRING}`],u=c.getPagingObject(),d=new O.a(u.getPageLastIndex()+(r&&u.getHasNextPage()?1:0),u.getPageSize(),!0,null);if(i=(n&&n[e]?n[e]:null)||"",c.filteringObj){const e=c.filteringObj.getRootFilterExpression();if(e){i+=E.a.toLegacyFilterExpression(e).toFetchXml()||""}}i||(i=null),o.push(new S.a(e,t[e]&&new a.a(t[e]),i,s,null,null,d)),r?u.getHasNextPage()&&(l=!0,c.updatePagingObject(),c.getLatestData().loading=!0,c.setRefreshingStart()):l=!0}if(l){const r=new v.a(o,null,null,null,i,!0);return e.sendLookupRequest(r,this._contextToken,this._pageId,this._pageEtn,this._controlId,this._attributeName).then(()=>{for(const e in t){(this._dataSetWrappers[`${e}:${t[e]}`]||this._dataSetWrappers[`${e}:${a.a.EMPTYGUIDSTRING}`]).updateRefreshStatusToRequestBack()}}).catch(e=>{const i="Lookup Data Request encounters an exception";for(const e in t){(this._dataSetWrappers[`${e}:${t[e]}`]||this._dataSetWrappers[`${e}:${a.a.EMPTYGUIDSTRING}`]).setErrorStatus(i)}throw b.a.error(T+": "+i,[{name:"APIName",value:T+".searchLookup"},{name:"error.Stack",value:JSON.stringify(e.stack)},{name:"controlId",value:this._controlId},{name:"entityTypeName",value:this._pageEtn}]),new C.a(i)})}return Promise.resolve(null)}_shouldUseLookupService(e,t){return Object(w.c)(this._lookupServiceEnabled)&&(this._lookupServiceEnabled=Object(_.f)(e,P.ie),"MscrmControls.FieldControls.SimpleLookupControl"!==t&&(this._lookupServiceEnabled=!1)),this._lookupServiceEnabled}_usePresenceStatus(e,t){return e(t)}_useProfilePhoto(e,t){return e(t)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class R extends d{}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class k extends N{createParameterInstance(){return new R}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class A extends d{}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class M extends N{createParameterInstance(){return new A}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class x extends d{}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class L extends N{createParameterInstance(){return new x}}var V=i("KVHF");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class B extends d{}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class z extends N{createParameterInstance(){return new B}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const U="CustomControlFramework.Selectors.DynamicDataSelectors.CustomControlLookupSelector";var W=i("NbYl"),G=i("Z/4N"),q=i("Z+6x"),H=i("g03H"),Q=i("TfjW"),K=i("lEp6"),X=i("JMHu"),Y=i("JwRZ"),J=i("eXjw"),$=i("FZDd"),Z=i("P6DH"),ee=i("IqkD"),te=i("/A0C"),ie=i("4ciL"),re=i("LbMF"),ne=i("iZ7K"),ae=i("sjKS"),se=i("jRy5"),oe=i("dHD5"),le=i("fILV");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function ce(e){var t,i,r;return null===(r=null===(i=null===(t=null==e?void 0:e.grid)||void 0===t?void 0:t.rows)||void 0===i?void 0:i[0])||void 0===r?void 0:r.cells}function ue(e,t){const i=ce(e);return e=>{const r=null==i?void 0:i.find(({name:t})=>t===e);return(null==r?void 0:r.relatedEntityName)||t}}function de(e,t,i){return{errorMessage:e,errorCode:t,errorTitle:i}}function pe(e){var t,i;return(null===(t=e.descriptor)||void 0===t?void 0:t.HasContext)?e.controlId:null===(i=e.parentDefinedControlProps)||void 0===i?void 0:i.closestParentWithContext}function he(e,t,i,r,n,a){let s;if(Object(u.p)(e,t)===le.a||pe(a)){const a=Object(oe.f)(i,r,n);s=Object(Z.T)(e,t,a)}else s=Object(h.hc)(e,t,i);return s}var ge=i("WPtp"),me=i("AE7n"),fe=i("mIxf"),be=i("bT7G"),ye=i("odYE"),ve=i("Dea/"),Se=i("bi9n"),_e=i("BFlg"),Oe=i("aF0N");var Pe=i("5Oca"),we=i("7iDi");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class Ce{constructor(e,t,i,r,n,s,o,l,c,u){this._allColumNames=t,this._primaryColumnName=i,this.id=null!=c?c:a.a.toString(a.a.newGuid()),this.activeColumnNames=(null==u?void 0:u.fields)?Object.keys(u.fields):[],this.viewId=r,this.getOwnProps=n,this._getColumnMetadata=s,this._getCachedColumnsMetadata=o,this.contextToken=l,this.ref=new ye.a(e,a.a.tryParseOrNull(this.id)),this.isNew=!c}getReference(e){if(this.ref.etn===h.a){const{getState:e}=Object(ae.a)(),t=Object(Pe.h)(e(),h.a,this.ref.id.guid);if(t&&t.fields){const{activitytypecode:e}=t.fields,i=Object(ge.e)(e);this.ref=new ye.a(i,this.ref.id,this.ref.name)}}if(e&&!this.ref.name&&this._primaryColumnName){const e=this.getField(this._primaryColumnName),t=e&&Object(ge.e)(e);t&&(this.ref=new ye.a(this.ref.etn,this.ref.id,t))}return this.ref}getField(e){const{getState:t}=Object(ae.a)(),i=t(),r=he(i,this.getPageId(),this.contextToken,this.ref.id,this.ref.etn,this.getOwnProps());return Object(be.e)(i,r,this.ref,e)}getAllFields(){const{getState:e}=Object(ae.a)(),t=e(),i={},r=he(t,this.getPageId(),this.contextToken,this.ref.id,this.ref.etn,this.getOwnProps());for(const e of this.activeColumnNames){const n=Object(be.e)(t,r,this.ref,e);i[e]=n}return i}async setValue(e,t){const{dispatch:i}=Object(ae.a)();var r,n,a;await i((r=this.id,n=this.getPageId(),a=this.contextToken,{type:"customcontrol.addgridonchangehandlers",sync:!0,execute({dispatch:e,getState:t},i){const s=i.TraceManager.getTracer(_e.P),o=_e.N+".AddGridOnChangeHandlersAction";try{if(i.ScriptManager){const l=i.ScriptManager.getContainer(n);l&&(Object(Oe.c)(t())&&e(l.getEventManager().addGridOnChangeHandlers(a,r)),s.info("Triggered the action for updated record "+r),i.EventManager.ReportComponentSuccess(o))}}catch(e){const t="Triggered action for updated record failed with error : "+e.message;i.EventManager.ReportComponentFailure(o,Error(t)),console.log(t)}}})),i(Object(fe.a)(this.getPageId(),{[e]:{fieldName:e,type:0,value:t}},!1,!1,this.ref.etn,this.id,pe(this.getOwnProps()),this.contextToken,!0)),this.activeColumnNames.includes(e)||this.activeColumnNames.push(e);const s=this.getField(e);return null==s?void 0:s.validationResult}async getMetadata(e){const{primaryEntityMetadata:t,relatedEntityMetadata:i}=await this._getColumnMetadata(e);return this._fetchColumnMetadata(e,t,i)}getCachedColumnsMetadata(){return this._getCachedColumnsMetadata()}_fetchColumnMetadata(e,t,i){let r=t.metadata[e],n=!1;if(!r)for(const t in i){const a=i[t];if(r=null==a?void 0:a.metadata[e],r){n=!0;break}}if(null==r?void 0:r.IsEditable){let i=!n;if(i){const{getState:r}=Object(ae.a)();i=Object(Z.M)(r(),this.getPageId(),this.contextToken,e,this.ref.id,t.logicalName)}r=Object.assign(Object.assign({},r),{IsEditable:i})}return r}isEditable(e){const t=Object(ae.a)().getState(),i=this.getPageId(),r=this.getReference().id,n=this.contextToken;return!(!i||!n)&&(n.contextTokenType=se.a.GridRow,n.recordId=r,n.parentContextToken={contextTokenType:se.a.MainGrid,entityTypeName:n.entityTypeName},Object(Z.M)(t,i,n,e,r))}getNotification(e){const t=Object(ae.a)().getState(),i=this.getPageId(),r=this.getReference().id;if(i&&this.contextToken){let n={contextTokenType:se.a.GridRow,entityTypeName:this.ref.etn,recordId:r,parentContextToken:{contextTokenType:se.a.MainGrid,entityTypeName:this.ref.etn}};if(this.getOwnProps().contextString===we.a.subGrid){n={contextTokenType:se.a.GridRow,entityTypeName:this.ref.etn,recordId:r,parentContextToken:this.getOwnProps().parentContextToken}}return Object(Z.L)(t,i,n,e)}return""}isDirty(){const e=this._getSnapshot();return!(!e||!Ie(e.activeChanges)&&!Ie(e.lockedChanges))}getChangedFields(){const e=this._getSnapshot();return[...Object.keys((null==e?void 0:e.activeChanges)||{}),...Object.keys((null==e?void 0:e.lockedChanges)||{})]}async save(){if(this.isDirty()){const{getState:e,dispatch:t}=Object(ae.a)(),i=[];for(const e of this.activeColumnNames)this._allColumNames.includes(e)&&i.push(e);if(i.length>0){if(this.isNew){const i=he(e(),this.getPageId(),this.contextToken,this.ref.id,this.ref.etn,this.getOwnProps());t(Object(Se.b)(i,ve.a.Create))}let r;try{r=!!await t(Object(me.b)(this.getPageId(),this.ref.etn,this.id,pe(this.getOwnProps()),i,this.viewId,!1,this.contextToken))}catch(e){const t=e;throw de(t.displayMessage||t.message||"Unexpected error while saving record.",t.errorCode,t.displayTitle)}if(!r)throw de("Error saving record.");this.isNew=!1}}}_getSnapshot(){const{getState:e}=Object(ae.a)(),t=e(),i=he(t,this.getPageId(),this.contextToken,this.ref.id,this.ref.etn,this.getOwnProps());return Object(be.b)(t,i)}getPageId(){return this.getOwnProps().id}}function Ie(e){return e&&Object.keys(e).length>0}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Ee(e,t){var i,r,n,a,s,o,l,c,u;if(e){if(function(e){var t;return e&&je(null===(t=e)||void 0===t?void 0:t.value)}(e)){if((null===(i=e)||void 0===i?void 0:i.value.hasOwnProperty("mimeType"))&&-1!==(null===(r=e.value.mimeType)||void 0===r?void 0:r.indexOf("image")))return e.value;if((null===(n=e)||void 0===n?void 0:n.value.hasOwnProperty("mimeType"))&&-1===(null===(a=e.value.mimeType)||void 0===a?void 0:a.indexOf("image")))return e.value}if(function(e){var t,i;return e&&(null===(i=null===(t=e)||void 0===t?void 0:t.value)||void 0===i?void 0:i.hasOwnProperty("filename"))}(e)){if(-1!==(null===(c=null===(l=null===(o=null===(s=e)||void 0===s?void 0:s.value)||void 0===o?void 0:o.mimetype)||void 0===l?void 0:l.value)||void 0===c?void 0:c.indexOf("image"))&&e.value.hasOwnProperty("imagedata")){const t=e.value;return{fileName:null==t?void 0:t.filename,fileContent:null==t?void 0:t.imagedata.value,fileSize:null==t?void 0:t.filesizebytes.value,mimeType:null==t?void 0:t.mimetype.value,fileUrl:null==t?void 0:t.fullimageurl.value}}const t=null===(u=e)||void 0===u?void 0:u.value;return{fileName:null==t?void 0:t.filename.value,fileContent:"",fileSize:null==t?void 0:t.filesizeinbytes.value,mimeType:null==t?void 0:t.mimetype.value,fileUrl:null}}const d=Object(ge.e)(e);switch(t){case te.a.MultiSelectPickList:return Array.isArray(d)?d:null==d?void 0:d.split(",").map(e=>parseInt(e,10)).filter(e=>!isNaN(e));default:return d}}return null}function je(e){return!!e&&(null==e?void 0:e.hasOwnProperty("fileName"))}function De(e){if(Array.isArray(e)){return e.map(De)}return e instanceof ye.a?{id:e.id,etn:e.etn,name:e.name}:!(null==(t=e)?void 0:t.etn)||!t.id||t instanceof ye.a?e:new ye.a(e.etn,e.id,e.name);var t}var Te=i("0fHr"),Fe=i("Xd5/"),Ne=i("504W"),Re=i("SJlc");class ke{constructor(e,t){this._recordProvider=e,this._imageProvider=t}getRecordId(){const e=this._recordProvider.getReference();return a.a.toString(e.id)}getNamedReference(){return De(this._recordProvider.getReference(!0))}async getColumnInfo(e){const t=await this._recordProvider.getMetadata(e);if(!t)throw de("Column metadata is not available",void 0,"Column info not available");const{IsEditable:i,IsReadable:r,IsSecured:n,Type:a,RequiredLevel:s}=t,o=this._recordProvider.getField(e);let l,c=this._recordProvider.getNotification(e);const u=this._recordProvider.isEditable(e);if(o){const{validationResult:e}=o;l=!e.isValueValid,c=null!=c?c:e.errorMessage}else(1===(d=s)||2===d)&&(l=!0,c="Column is required");var d;return c&&(l=!0),{error:l,errorMessage:c,security:{editable:i&&u,readable:r,secured:n},type:a}}getValue(e){const t=this._recordProvider.getField(e),i=this._recordProvider.getCachedColumnsMetadata(),r=null==i?void 0:i[e];return De(t&&Ee(t,null==r?void 0:r.Type))}getFormattedValue(e){var t;const i=this._recordProvider.getField(e),r=i&&Object(ge.c)(i);let n;const a=this._recordProvider.getCachedColumnsMetadata(),s=null==a?void 0:a[e];if(s){const a=[Te.b.none,Te.b.language,Te.b.duration,Te.b.timeZone];(null===(t=s.Type)||void 0===t?void 0:t.toLocaleLowerCase())===Re.a.integerType&&a.includes(s.Format)&&(n=this._reformatValue(e,i,r))}return null!=n?n:r}_reformatValue(e,t,i){var r;const{getState:n}=Object(ae.a)();if(!Object(Ne.b)(i)){const a=n();let s=Object(re.d)(a,this.getNamedReference().etn);const o=this._recordProvider.getField(e);if(s&&s[e]||!o||Object(ge.f)(t)&&(s=Object(re.d)(a,t.entityLogicalName),e=t.attributeLogicalName),s&&s[e]||(null===(r=this._recordProvider.getReference())||void 0===r?void 0:r.etn)!==h.a||(s=Object(re.d)(a,h.a)),s&&s[e]){const t=Object(Y.u)(),r=Object(Fe.A)(a,s[e],null);return Object(Fe.y)(i,r,Object(D.e)(a,t))}}}isDirty(){return this._recordProvider.isDirty()}isValid(){const e=this._recordProvider.getAllFields();for(const t in e){const i=e[t];if(i&&!i.validationResult.isValueValid)return!1}return!0}async setValue(e,t){const i=De(t);if(je(i)&&this._recordProvider.isNew)throw de("To setValue of image/file type record needs to be created first.");const r=await this._recordProvider.setValue(e,i);if(r&&!r.isValueValid)throw de(r.errorMessage||"Could not set value",2415919121)}async save(){if(!this.isValid())throw de("Columns have invalid values.",void 0,"Unable to save column values.");return this.isDirty()&&await this._recordProvider.save(),this}getChanges(){const e={},t=this._recordProvider.getChangedFields();for(const i of t)e[i]=this.getValue(i);return e}getCellImageInfo(e,t){return this._imageProvider.getCellImageInfo(this,e,t)}}var Ae=i("/Zy9"),Me=i("f07+"),xe=i("HfZT"),Le=i("a72m"),Ve=i("jq7Z"),Be=i("jAuy"),ze=i("NjDY"),Ue=i("xymJ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class We{constructor(e,t){this._columnNames=[],this._imageColumns={},this._pageId=e;const i=ce(t)||[];for(const e of i){this._columnNames.push(e.name);const{imageProviderFunctionName:t,imageProviderWebresource:i}=e;t&&i&&"$webresource:"!==i&&(this._imageColumns[e.name]={webResourceName:i,functionName:t})}}async getCellImageInfo(e,t,i){const{webResourceName:r,functionName:n}=this._imageColumns[t]||{};if(r&&n){const{dispatch:t}=Object(ae.a)(),a=await t(Object(Ue.a)(r,this._pageId)),s={RowId:e.getRecordId()};for(const t of this._columnNames)s[t]=e.getFormattedValue(t),s[t+"_Value"]=e.getValue(t);const o=await a.container.execute(n,[JSON.stringify(s),i]);let l,c;return Array.isArray(o)&&([l,c]=o,(null==l?void 0:l.startsWith("blob:"))||(l=Object(ze.a)(a.webResourcePath,l))),{Url:l||null,Tooltip:c||null}}return null}}var Ge=i("Jpj4"),qe=i("L6aH"),He=i("RVeV");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function Qe({DisplayName:e,EntityLogicalName:t,PrimaryNameAttribute:i,PrimaryImageAttribute:r,PrimaryIdAttribute:n,Description:a,EntitySetName:s,AttributeNames:o,Privileges:l}){const c={};if(l)for(const e of l)c[e.PrivilegeType]=e;return{displayName:e,logicalName:t,primaryNameAttribute:i,primaryImageAttribute:r,primaryIdAttribute:n,privilegesByType:c,description:a,entityPluralName:s,metadata:{},attributeNames:o}}function Ke({DisplayName:e,LogicalName:t,RequiredLevel:i,IsSecured:r,IsValidForRead:n,IsValidForUpdate:a,SourceType:s,SourceTypeMask:o,Description:l,Type:c,MaxLength:u,Format:d,ImeMode:p,Precision:h,PrecisionSource:g,MinValue:m,MaxValue:f,Targets:b,Behavior:y,DefaultValue:v,OptionSet:S}){const _={DisplayName:e,LogicalName:t,RequiredLevel:i,IsSecured:r,IsReadable:n,IsEditable:a,SourceType:s,SourceTypeMask:o,Description:l,Type:c,MaxLength:u,Format:d,ImeMode:p,Precision:h,MinValue:m,MaxValue:f,Targets:b,Behavior:y,DefaultValue:v,Options:null==S?void 0:S.map(({Label:e,Color:t,Value:i})=>({Label:e,Color:t,Value:i})),SupportedAggregations:Xe(c),CanBeGrouped:Je(c),SupportedDateGroupings:$e(c)};if(c===te.a.Integer){const e=parseInt(d,10);if(e===He.a.LANGUAGE||e===He.a.TIMEZONE){const{getState:t}=Object(ae.a)(),i=t();if(e===He.a.TIMEZONE){const e=Object(ee.m)(i),t={};for(const i in e)e[i]&&(t[i]=e[i].userInterfaceName);_.TimeZoneByCode=t}else e===He.a.LANGUAGE&&(_.LanguageByCode=Object(ze.h)(i))}}else if(c===te.a.Money&&(g===qe.b.currency||g===qe.b.organization)){const{getState:e}=Object(ae.a)(),t=e();if(g===qe.b.currency){const e=Object(ee.x)(t).numberFormatInfo;e&&(_.Precision=e.CurrencyDecimalDigits)}else g===qe.b.organization&&(_.Precision=Object(ze.D)(t).pricingDecimalPrecision)}return _}function Xe(e){const t=["countcolumn","count"],i=[te.a.Decimal,te.a.Double,te.a.Money,te.a.BigInt,te.a.Integer].includes(e);return i&&t.push("avg","sum"),(i||Ye(e))&&t.push("max","min"),t}function Ye(e){return[te.a.Date,te.a.DateTime].includes(e)}function Je(e){return e!==te.a.MultiSelectPickList}function $e(e){if(Ye(e)&&Je(e))return["year","quarter","month","week","day","fiscal-period","fiscal-year"]}var Ze=i("37s6");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function et(e){var t,i,r,n,a,s,o,l,c,u;const d=null===(t=null==e?void 0:e.isEditable)||void 0===t||t,p=null===(i=null==e?void 0:e.isFilterable)||void 0===i||i,h=null===(r=null==e?void 0:e.isSortable)||void 0===r||r,g=null===(n=null==e?void 0:e.canPaginate)||void 0===n||n,m=null===(a=null==e?void 0:e.canCreateNewRecords)||void 0===a||a,f=null===(s=null==e?void 0:e.hasRecordNavigation)||void 0===s||s,b=null===(o=null==e?void 0:e.hasCellImageInfo)||void 0===o||o,y=null!==(l=null==e?void 0:e.canAggregate)&&void 0!==l&&l,v=null!==(c=null==e?void 0:e.canGroup)&&void 0!==c&&c,S=null!==(u=null==e?void 0:e.canCreateDynamicDataSets)&&void 0!==u&&u,_=()=>S&&tt(P.Re);let O;return Object.freeze({isEditable:d,isFilterable:p,isSortable:h,canPaginate:g,canCreateNewRecords:m,hasRecordNavigation:f,hasCellImageInfo:b,get canAggregate(){return y&&tt(P.Qe)},get canGroup(){return v&&tt(P.Se)},dynamicDataSets:Object.freeze({get canCreateDynamicDataSets(){return _()},getDynamicDataSetCapabilities:()=>_()?(null!=O||(O=et({canAggregate:!0,canGroup:!0,canCreateDynamicDataSets:!1})),O):null})})}function tt(e){const{getState:t}=Object(ae.a)(),i=t();return(Object(Ze.E)(i)?o.b:o.c)(i)&&Object(_.f)(i,e)}class it{constructor(e,{EntityName:t,TargetEntityType:i,ViewId:r,RelationshipName:n,BoundViewParams:a},s,o,l,c=!1){this._selectedRecordIds=[],this._memoizedData=[],this._memoizedList=[],this._isFirstDataRetrieval=!0,this._cachedMetadata={},this._cachedLookupColumnMetadata=[],this._relatedDataSets={},this._cachedColumnMetadata={},this.getColumnMetadata=e=>this.getMetadata([e]),this.getCachedColumnsMetadata=()=>this._cachedColumnMetadata,this.entityName=t||i,this._viewId=(null==a?void 0:a.ViewId)||r,this._relationshipName=n,this.getOwnProps=e,this._getIsInitialDataSetFetchEnabled=s,this.contextToken=o,this._hiddenFilters=l,this._getQueryBuilder=this._makeMemoizeQueryBuilder(),this._relatedDataProvider=c,this._capabilities=et({canCreateDynamicDataSets:!c}),this._isRelatedDatasetMetadataInitializing=!1,this._getImageProvider=this._makeMemoizedImageProvider()}getFetchXml(){return this._currentFetchXml}getQueryKey(){return this._currentQueryKey}getEntityName(){return this.entityName}getViewId(){var e;return a.a.toString(null===(e=this._view)||void 0===e?void 0:e.viewId)||this._viewId}getTitle(){var e;return null===(e=this._view)||void 0===e?void 0:e.title}_makeMemoizeQueryBuilder(){let e,t,i,r,n,s,o,l,c;return(u,{columns:d,filters:p,linkingDetails:h,pagingDetails:g,sortDetails:m},{quickFindFilter:f,quickFindViewId:b},y)=>{var v,S,_,O,P,w;let C=!1;if((f!==o||(null==d?void 0:d.length)!==(null==e?void 0:e.length)||(null==d?void 0:d.filter(({name:t})=>!(null==e?void 0:e.includes(t))).length)||y!==n||(null==g?void 0:g.firstPageNumber)!==(null==r?void 0:r.firstPageNumber)||(null==g?void 0:g.lastPageNumber)!==(null==r?void 0:r.lastPageNumber)||(null==g?void 0:g.pageSize)!==(null==r?void 0:r.pageSize)||(null===(v=this._hiddenFilters)||void 0===v?void 0:v.hasHint)!==(null==l?void 0:l.hasHint)||(null===(S=this._hiddenFilters)||void 0===S?void 0:S.filters)!==(null==l?void 0:l.filters)||rt(t,p)||rt(i,m)||rt(s,h))&&(C=!0),C||!c){const{viewId:v,entityLogicalName:S}=this._view;c=Ae.c.fromView(v,f);const C=Object(Y.p)(u,S);C&&c.where(C),b&&c.mergeQuickFind(b),o=f,this._hiddenFilters?((null===(_=this._hiddenFilters.filters)||void 0===_?void 0:_.terms.length)&&c.where(this._hiddenFilters.filters,!1,this._hiddenFilters.hasHint),l=Object.assign({},this._hiddenFilters)):l=null;let I=!1;const E=null==d?void 0:d.filter(e=>e.name!==Z.c);E&&(I=E.length!==d.length,d=[...E]);const j={},D={};if(d){const t=[];for(const{name:e,alias:i}of d)t.push(e),j[e]=e,i&&(j[i]=e,D[i]||(D[i]=[]),D[i].push(e));c.select(...t),e=[...t]}else e=null;if(p){const e=Object(Y.n)(p,j);e&&c.where(e)}if(t=nt(p),h)for(const e of h)c.addLinkedEntity(e,D[e.alias]||[]);if(s=nt(h),g&&(c.pageSize=g.pageSize),r=g,n=y,c.pageNumber=y,m)for(const{name:e,sortDirection:t}of m)c.orderBy(e,1===t);if(i=nt(m),this._relationshipName){const e=null===(O=this.getOwnProps())||void 0===O?void 0:O.id,t=Object(Z.v)(u,e,this.contextToken);let i;if(null===(w=null===(P=this.getOwnProps())||void 0===P?void 0:P.formInfo)||void 0===w?void 0:w.RecordId)i=new a.a(this.getOwnProps().formInfo.RecordId);else{const e=Object(Ve.a)(u,this.getOwnProps().id);if(e){const t=e.input;t&&(i=t.id)}}try{c.applyContextFilter(this._relationshipName,i,u,null==t?void 0:t.relationshipRoleOrdinal)}catch(e){}}if(I&&this._view){const e=Object(Z.o)(u,this._view.entityLogicalName);e&&!Object(Be.b)(this._view.fetchXML)&&c.addChildCountAttribute(e.primaryAttribute)}}return c}}async getRecords(e,t=!1){var i,r,n,s,o,l,c;await this._initialize();const u={};null===(i=e.columns)||void 0===i||i.forEach(e=>{u[e.name]=e.attributes}),this._cachedColumnMetadata=u;let d=Ae.a,p=Ae.a,h=Ae.b;e.pagingDetails&&({firstPageNumber:d,lastPageNumber:p,pageSize:h}=e.pagingDetails),this._pageSize!==h&&(this._memoizedData=[],this._memoizedList=[],this._pageSize=h);let g,m={};for(let i=d;i<=p;i++){if(void 0===this._memoizedData[i]&&void 0===this._memoizedList[i]||t){const{getState:t,dispatch:a}=Object(ae.a)(),o=await this._getQuickFindInfo();if(this._relatedDataProvider){const t=new Set(this._cachedLookupColumnMetadata.map(e=>e.name));e.columns=[...this._cachedLookupColumnMetadata,...null===(r=e.columns)||void 0===r?void 0:r.filter(e=>!t.has(e.name))]}const l=this._getQueryBuilder(t(),e,o,i);let c,u;const d=l.getQueryState(t),p=l.getKey();if(!this._isFirstDataRetrieval||this._getIsInitialDataSetFetchEnabled()||Object(Pe.p)(t(),p)!==J.a.Initialized){const e=await a(Object(xe.e)(d,this.getOwnProps().id));c=null===(n=null==e?void 0:e.entities)||void 0===n?void 0:n[this.entityName],u=null===(s=null==e?void 0:e.lists)||void 0===s?void 0:s[p]}else c=Object(Pe.i)(t(),this.entityName),u=Object(Pe.o)(t(),p);this._currentQueryKey=p,this._currentFetchXml=l.toFetchXml(t),c?(this._memoizedData[i]=c,this._memoizedList[i]=u):u&&(this._memoizedData[i]={},this._memoizedList[i]=u)}if(void 0===this._memoizedData[i])break;m=Object.assign(Object.assign({},m),this._memoizedData[i]),g=(null==g?void 0:g.pages)?Object.assign(Object.assign({},this._memoizedList[i]),{lastRetrieved:g.lastRetrieved<this._memoizedList[i].lastRetrieved?g.lastRetrieved:this._memoizedList[i].lastRetrieved,pages:Object.assign(Object.assign({},g.pages),this._memoizedList[i].pages),records:[...g.records,...this._memoizedList[i].records]}):this._memoizedList[i]}this._isFirstDataRetrieval=!1;const f=this._getRecordsById(m);return this._registerRecordsForPBLNotifications(Object.keys(f)),{queryId:e.queryId,records:f,hasNextPage:!!(null===(o=null==g?void 0:g.pages[p])||void 0===o?void 0:o.moreRecords),totalRecordCount:(null===(l=e.pagingDetails)||void 0===l?void 0:l.retrieveTotalRecordCount)?(null==g?void 0:g.totalRecordCountLimitExceeded)?-1:null==g?void 0:g.totalRecordCount:void 0,sortedRecordIds:(null===(c=null==g?void 0:g.records)||void 0===c?void 0:c.map(({id:e})=>a.a.toString(e)))||[]}}async _initialize(){if(!this._isInitialized&&!this._isRelatedDatasetMetadataInitializing){const{getState:e,dispatch:t}=Object(ae.a)(),[i]=await Promise.all([this._relatedDataProvider?t(Object(Le.a)(this.entityName,c.a.LOOKUP_VIEW,c.b.savedview)):t(Object(Le.a)(this.entityName,null,null,a.a.tryParseOrNull(this._viewId))),t(Object($.f)(this.entityName,!1,[]))]),r=Object(ne.h)(e(),this.entityName);this.primaryNameColumn=null==r?void 0:r.PrimaryNameAttribute,this.allColumnNames=(null==r?void 0:r.AttributeNames)||[],this._view=Object(l.c)(e(),i),this._relatedDataProvider&&await this._initializeRelatedProvider(),this._isInitialized=!0}this._throwIfInvalidView()}async _initializeRelatedProvider(){this._isRelatedDatasetMetadataInitializing=!0;const e=ce(this._view).map(e=>e.name);let t,i,r=!1;if(e.forEach(e=>{var t,i;(null===(t=this._cachedMetadata[this.entityName])||void 0===t?void 0:t.metadata)&&e in(null===(i=this._cachedMetadata[this.entityName])||void 0===i?void 0:i.metadata)||(r=!0)}),r){const r=await this.getMetadata(e);t=r.primaryEntityMetadata.metadata,i=r.primaryEntityMetadata.primaryNameAttribute}else t=this._cachedMetadata[this.entityName].metadata,i=this._cachedMetadata[this.entityName].primaryNameAttribute;this._cachedLookupColumnMetadata=[],e.forEach(e=>{const r=t[e],n={name:r.LogicalName,alias:r.LogicalName,dataType:r.Type,displayName:r.DisplayName||"",order:1,visualSizeFactor:1,isPrimary:r.LogicalName===i,attributes:r};this._cachedLookupColumnMetadata.push(n)}),this._cachedPrimaryDataSet.columns=this._cachedLookupColumnMetadata,this._isRelatedDatasetMetadataInitializing=!1}async getMetadata(e){let t=this._cachedMetadata[this.entityName];const i=this._cachedMetadata;let r=!t;if(r||(null==e?void 0:e.length)){await this._initialize();const n={[this.entityName]:[]},a={};if(e){const t=ue(this._view,this.entityName);for(const i of e){const e=t(i);n[e]||(n[e]=[]);const r=i.includes(".")?i.split(".")[1]:i;a[r]=i,n[e].push(r)}}if(!r)for(const e in n){const t=i[e];if(t){const i=n[e];for(const e of i)if(!t.metadata[a[e]]){r=!0;break}}else r=!0;if(r)break}if(r){const{getState:e,dispatch:r}=Object(ae.a)();await r(Object($.e)(n));for(const r in n){const s=Qe(Object(ne.h)(e(),r)),o=n[r];for(const t of o){const i=Object(re.a)(e(),r,t);if(i){const e=Ke(i);s.metadata[a[t]]=e}}i[r]=s,r===this.entityName&&(t=s)}}}return{primaryEntityMetadata:t,relatedEntityMetadata:i}}async newRecord(e){var t;await this._initialize();const i=this.wrapRecord(this._getImageProvider());if(null==e?void 0:e.length){const{primaryEntityMetadata:r}=await this.getMetadata(e),{getState:n}=Object(ae.a)(),a=n(),s=[];for(const n of e){const e=r.metadata[n],o=(null==e?void 0:e.Type)===te.a.Owner?{etn:"systemuser",id:Object(ee.q)(a),name:Object(ee.t)(a)}:null!==(t=null==e?void 0:e.DefaultValue)&&void 0!==t?t:null;s.push(i.setValue(n,o))}try{await Promise.all(s)}catch(e){}}return i}delete(e){if(!e.length)return Promise.resolve();const{dispatch:t}=Object(ae.a)(),i=e.map(e=>new Me.c({id:e,entityType:this.entityName}));return t(Object(ie.b)(i))}getCapabilities(){return this._capabilities}setSelectedRecordIds(e){this._selectedRecordIds=[...e||[]]}_registerRecordsForPBLNotifications(e){var t;const{dispatch:i}=Object(ae.a)();let r={contextTokenType:se.a.MainGrid,entityTypeName:null===(t=this.contextToken)||void 0===t?void 0:t.entityTypeName};if(this.getOwnProps().contextString===we.a.subGrid){r={contextTokenType:se.a.GridRow,entityTypeName:this.entityName,parentContextToken:this.contextToken}}i(Object(Ge.b)(this.getOwnProps().id,r,null==e?void 0:e.map(e=>new a.a(e))))}getSelectedRecordIds(){return[...this._selectedRecordIds]}clearSelectedRecordIds(){this.setSelectedRecordIds([])}getRelatedDataSet(e,t,i){if(e.name in this._relatedDataSets)return Promise.resolve(this._relatedDataSets[e.name]);const r=null==e?void 0:e.attributes;if(!(null==(n=r)?void 0:n.Targets))throw de("Must specify a lookup column to get a related data set.");var n;if(i&&!r.Targets.includes(i))throw de(`Requested entity ${i} is not a valid target for column ${e.name}.`);const a=i?[i]:e.attributes.Targets;this._relatedDataSets[e.name]=[];const s=[];return a.forEach(e=>{const i=new it(this.getOwnProps,{ViewId:"",EntityName:e,Type:""},()=>!0,{contextTokenType:se.a.RelatedEntity,entityTypeName:e},this._hiddenFilters,!0),r={initQuery:{columns:[]},events:{dataSetUpdatedCallback:t}},n=Q.a.createDataSetObjectWrapper(i,r),a=n.getDataSet();s.push(n.refreshWithAwait()),i._cachedPrimaryDataSet=a}),Promise.all(s).then(t=>(t.forEach(t=>{this._relatedDataSets[e.name].push(t)}),this._relatedDataSets[e.name]))}destroy(){}async saveMultipleRecords(e){var t,i,r;const{getState:n,dispatch:s}=Object(ae.a)(),o={[this.entityName]:[]},l=[];for(const r of e){const e=Object.keys(r.getChanges());if(0===e.length)continue;l.push(new ye.a(this.entityName,new a.a(r.getRecordId()))),e.forEach(e=>{o[this.entityName].includes(e)||o[this.entityName].push(e)});if((null===(t=this._memoizedData)||void 0===t?void 0:t.some(e=>!e[r.getRecordId()]))||0===this._memoizedData.length){const e=he(n(),null===(i=this.getOwnProps())||void 0===i?void 0:i.id,this.contextToken,new a.a(r.getRecordId()),this.entityName,this.getOwnProps());s(Object(Se.b)(e,ve.a.Create))}}if(0===l.length)return[];try{const e=await s(Object(me.a)(null===(r=this.getOwnProps())||void 0===r?void 0:r.id,l,o,this._viewId,!1,this.contextToken)),t=[];return e.forEach(e=>{t.push(e.id.guid)}),t}catch(e){const t=e;throw de(t.displayMessage||t.message||"Error saving record.",t.errorCode,t.displayTitle)}}async _getQuickFindInfo(){const{getState:e,dispatch:t}=Object(ae.a)(),i=Object(Z.D)(e(),this.getOwnProps().id,this.contextToken),r=null==i?void 0:i.quickFind;let n;if(r){n=await t(Object(Le.a)(this.entityName,c.a.QUICKFIND_SEARCH,c.b.savedview));const i=Object(Z.tb)(e(),n,this.getOwnProps().id);if((null==i?void 0:i.initialized)!==J.a.Initialized)throw de("Can not retrieve quick find view metadata",2415919120)}return{quickFindFilter:r,quickFindViewId:n}}_throwIfInvalidView(){var e;if((null===(e=this._view)||void 0===e?void 0:e.initialized)!==J.a.Initialized)throw de("Can not retrieve view's metadata",2415919120)}_getRecordsById(e){const t={};if(e){const i=this._getImageProvider();for(const r in e){const n=e[r];t[r]=this.wrapRecord(i,r,n)}}return t}wrapRecord(e,t,i){const r=new Ce(this.entityName,this.allColumnNames,this.primaryNameColumn,this.getViewId(),this.getOwnProps,this.getColumnMetadata,this.getCachedColumnsMetadata,this.contextToken,t,i);return new ke(r,e)}_makeMemoizedImageProvider(){let e,t;return()=>{const{getState:i}=Object(ae.a)(),r=this.getOwnProps().id,n=Object(Z.tb)(i(),a.a.tryParseOrNull(this._viewId),r);return n!==e&&(t=new We(r,n),e=n),t}}}function rt(e,t){return!e!=!t||(!Object(Ne.a)(e)||!Object(Ne.a)(t))&&JSON.stringify(e)!==JSON.stringify(t)}function nt(e){return e?JSON.parse(JSON.stringify(e)):e}class at extends Ce{constructor(e,t,i,r,n,a,s,o,l,c){super(e,t,i,r,n,a,s,o,l,c),this._activityType=this.getField("activitytypecode").value}async setValue(e,t){const{dispatch:i,getState:r}=Object(ae.a)(),n=Object(re.a)(r(),this._activityType,e);if(!n||n.Initialized!==J.a.Initialized){const t={[this._activityType]:[e]};await i(Object($.e)(t))}i(Object(fe.a)(this.getPageId(),{[e]:{fieldName:e,type:0,value:t}},!1,!1,this._activityType,this.id,pe(this.getOwnProps()),this.contextToken)),this.activeColumnNames.includes(e)||this.activeColumnNames.push(e);const a=this.getField(e);return null==a?void 0:a.validationResult}async save(){if(this.isDirty()){const{getState:e,dispatch:t}=Object(ae.a)(),i=this.getChangedFields(),r={[this._activityType]:[]};if(i.forEach(t=>{const i=Object(re.a)(e(),this._activityType,t);i&&i.Initialized===J.a.Initialized||r[this._activityType].push(t)}),r[this._activityType].length>0&&await t(Object($.e)(r)),i.length>0){if(this.isNew){const i=he(e(),this.getPageId(),this.contextToken,this.ref.id,this.ref.etn,this.getOwnProps());t(Object(Se.b)(i,ve.a.Create))}try{if(!await t(Object(me.b)(this.getPageId(),this._activityType,this.id,pe(this.getOwnProps()),i,this.viewId,!1,this.contextToken)))throw de("Error saving record.");this.isNew=!1}catch(e){const t=e;throw de(t.displayMessage||t.message||"Error saving record.",t.errorCode,t.displayTitle)}}}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class st extends it{wrapRecord(e,t,i){const r=new at(this.entityName,this.allColumnNames,this.primaryNameColumn,this.getViewId(),this.getOwnProps,this.getColumnMetadata,this.getCachedColumnsMetadata,this.contextToken,t,i);return new ke(r,e)}}var ot=i("ztod");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class lt{constructor(e,t,i){this._eventHandlers={},this.subscribeEvent=this._subscribeEvent.bind(this);const r={onRecordsSelected:this._eventRaiser("onRecordsSelected"),onPagingUpdated:this._eventRaiser("onPagingUpdated"),onQueryUpdated:this._eventRaiser("onQueryUpdated"),onGetRecords:this._eventRaiser("onGetRecords")};let n;if(e.DataProvider)n=e.DataProvider;else{this._hiddenFilters={},this.setHiddenFilters(e);const a=new("activitypointer"===e.EntityName?st:it)(()=>this._ownProps,e,t,i,this._hiddenFilters);let s,o;n=a,this._subscribeEvent("onGetRecords",()=>{const e=a.getFetchXml(),t=a.getQueryKey();s===e&&o===t||(s=e,o=t,r.onQueryUpdated(e,t))})}this._dataProvider=function(e,t){let i,r;const n={getRecords:async(n,a)=>{var s;const o=await e.getRecords(n,a);if(n.pagingDetails){const{pageNumber:e,pageSize:a}=n.pagingDetails;e===i&&a===r||(i=e,r=a,t.onPagingUpdated(e,a))}const l=e,c=null===(s=null==l?void 0:l.getOwnProps())||void 0===s?void 0:s.id;if(n.filters&&c){const{dispatch:e}=Object(ae.a)(),t=[{filterType:6,filterExpressionOrValue:Object(K.b)(n.filters)}];e(Object(ot.a)(t,c))}return t.onGetRecords(),o},setSelectedRecordIds:i=>{e.setSelectedRecordIds(i),t.onRecordsSelected(i)},clearSelectedRecordIds:()=>{e.clearSelectedRecordIds(),t.onRecordsSelected([])}};if("Proxy"in window)return new Proxy(e,{get:(e,t,i)=>n.hasOwnProperty(t)?n[t]:Reflect.get(e,t,i)});const a={},s=Object.getPrototypeOf(e);for(const t of[...Object.getOwnPropertyNames(e),...Object.getOwnPropertyNames(s)]){const i=t;if(!(i in a))if(n.hasOwnProperty(i))a[i]=n[i];else{const{enumerable:t,configurable:r}=Object.getOwnPropertyDescriptor(e,i)||Object.getOwnPropertyDescriptor(s,i)||{enumerable:!1,configurable:!1};Object.defineProperty(a,i,{enumerable:t,configurable:r,get:()=>e[i],set:t=>e[i]=t})}}return a}(n,r),this._viewId=a.a.tryParseOrNull(e.BoundViewParams?e.BoundViewParams.ViewId:e.ViewId)}_subscribeEvent(e,t){let i=this._eventHandlers[e];i||(i=[],this._eventHandlers[e]=i),i.includes(t)||i.push(t)}unsubscribeEvent(e,t){const i=this._eventHandlers[e],r=i?i.indexOf(t):-1;-1!==r&&i.splice(r,1)}_eventRaiser(e){return(...t)=>{const i=this._eventHandlers[e];if(i)for(const e of i)e(...t)}}getDataProvider(){return this._dataProvider}async getView(){if(a.a.isNullOrEmpty(this._viewId))return null;const{getState:e,dispatch:t}=Object(ae.a)(),i=await t(Object(Le.a)(this._dataProvider.getEntityName(),null,null,this._viewId)),r=Object(Z.tb)(e(),i,this._ownProps.id,!1);return(null==r?void 0:r.initialized)===J.a.Initialized?r:null}setHiddenFilters(e){if(!this._hiddenFilters)return!1;const t=function({ExtraFilters:e}){var t;const i=[];if(e)for(const r of e){const e=Object(K.a)(r);(e.conditions||(null===(t=e.filters)||void 0===t?void 0:t.length))&&i.push(e)}return i}(e);if(t){const e=[];let i=!1;for(const r of t){const t=Object(Y.n)(r,null);t&&(i=i||!!t.hint,e.push(t))}this._hiddenFilters.hasHint=i,this._hiddenFilters.filters={operator:"and",terms:e}}else this._hiddenFilters.hasHint=null,this._hiddenFilters.filters=null;return!0}setOwnProps(e){this._ownProps=e}}var ct=i("2SCk"),ut=i("cUMa"),dt=i("cfbi"),pt=i("ruPX"),ht=i("s1hL");var gt=i("16wZ"),mt=i("8MGk");function ft(e,t,i){return{type:"navigation.open.file",execute:(r,n)=>
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t,i,r,n){return r||Object(gt.j)(i+"openFile","file"),new mt.a(t,e).openFile(r,n)}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(r,n,e,t,i)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var bt=i("fREn");const yt={FilteringInput:e=>e.filtering.getFilter(),LinkingInput:e=>e.linking.getLinkedEntities(),SortingInput:e=>e.sorting,PagingInput:null,RefreshInput:null,ExtraFilters:null,Columns:null,onDataSetUpdate:null,onRecordsSelected:null,BoundViewParams:null},vt=["onDataSetUpdate","onRecordsSelected"],St=["ExtraFilters","Columns","BoundViewParams"],_t=Object.keys(yt);class Ot{constructor(e,t,i,r){this.objectWrapperType=5,this._updatedProperties={},this._viewIdDoc={},this._propKey=e,this._inputParser=function(e){const t=Object(n.a)(),i={},r=(e,t)=>{if(!t)return null;const r=i[e];if((null==r?void 0:r.raw)===t)return r.parsed;const n=Object(K.a)(t);return i[e]={raw:t,parsed:n},n};return(i,n,a,s,o)=>{const l=a.Parameters[o],c=o=>{var c;const u=l[o];if(!u)return null;if(vt.includes(o))return u;if(St.includes(o)){const e=u,t=e?Object(K.b)(e):null;return r(o,t)}a=Object.assign(Object.assign({},a),{Parameters:{[o]:u}});const d=null===(c=t(o,i,n,a,s,e))||void 0===c?void 0:c.raw;return r(o,d)},u={};for(const e of _t)u[e]=c(e);return u}}(i),Object(w.c)(t.FirstDataRequestType)||(this._isInitialDataSetFetchEnabled=1!==t.FirstDataRequestType),this._dataProviderAdaptor=new lt(t,()=>this._isInitialDataSetFetchEnabled,i),this._createEventHandlers(),this._pageId=r.id,this._contextToken=i,this._controlName=r.configuration.Name}_createEventHandlers(){let e,t;this._dataProviderAdaptor.subscribeEvent("onRecordsSelected",e=>{var t,i;null===(i=(t=this._currentParameter).onRecordsSelected)||void 0===i||i.call(t,e),this._addUpdatedProperty(X.a)}),this._dataProviderAdaptor.subscribeEvent("onPagingUpdated",(e,t)=>{this._pageNumber=e,this._pageSize=t}),this._dataProviderAdaptor.subscribeEvent("onQueryUpdated",(i,r)=>{e=i,t=r}),this._innerWrapperEvents={dataSetUpdatedCallback:({error:i,errorMessage:r,filtering:n,paging:a,sorting:s},o)=>{for(const e of o)this._addUpdatedProperty(e);if(this._currentParameter.onDataSetUpdate){const o={error:i,errorMessage:r,newQueryKey:t,fetchXmlInUse:e,existedFilteringString:Object(K.b)(n.getFilter()),existedPagingString:Object(K.b)(Object.assign(Object.assign({},a),{pageSize:this._pageSize,firstPageNumber:this._pageNumber})),existedValidSortingArrayString:Object(K.b)(s)};this._currentParameter.onDataSetUpdate(o)}},recordSelectedCallback:e=>{this._openDataSetItem(e)}}}async _openDataSetItem(e){const t=this.getLatestData();let i,r;if("string"==typeof e?(i=null==t?void 0:t.getTargetEntityType(),r=e):(i=e.etn,r=e.id.guid),i===h.a){const{getState:e}=Object(ae.a)(),t=Object(Pe.h)(e(),h.a,r);if(t&&t.fields){const{activitytypecode:e}=t.fields;i=Object(ge.e)(e)}}null==t||t.setSelectedRecordIds([r]);const n=()=>{const e={entityName:i,entityId:r},t=Object(ht.a)(e,null,null),{dispatch:n}=Object(ae.a)();"report"===t.entityTypeName?n(function(e,t,i){return{type:"navigation.open.report",execute:(r,n)=>Object(ht.b)(e,r,t,i)}}(t,Nt,Rt)):n(Object(pt.a)(dt.b,t,this._pageId)).then(e=>{if(0!==e.status)throw e.error})};try{const e=(await t.getCommands([r])).filter(e=>"Mscrm.OpenRecordItem"===e.commandId).shift();e?e.execute():n()}catch(e){n()}}_createInnerWrapper(e,t){var i;null===(i=this._innerWrapper)||void 0===i||i.destroy(),this._innerWrapper=Q.a.createDataSetObjectWrapper(this._getDataProvider(),{initQuery:{columns:e,pagingDetails:Ct(this._currentParameter,this._pageSize),filters:It(this._currentParameter),linkingDetails:Et(this._currentParameter,t,this._viewIdDoc),sortDetails:jt(this._currentParameter,t,this._viewIdDoc)},events:this._innerWrapperEvents,initializeCommanding:!0})}applyDataSetInputs(e){let t=0;if(this._nextParameter&&this._currentParameter!==this._nextParameter){const i=Tt(this._currentParameter,this._nextParameter,e);if(i.length>0){t=1;for(const r of i)switch(r){case"ExtraFilters":this._dataProviderAdaptor.setHiddenFilters(this._nextParameter)||1!==i.length||(t=0);break;case"FilteringInput":const r=It(this._nextParameter);e.filtering.setFilter(r);break;case"LinkingInput":const n=Et(this._nextParameter)||[];e.linking.clear();for(const t of n)e.linking.addLinkedEntity(t);break;case"PagingInput":const a=Ct(this._nextParameter,this._pageSize);if(a){const{pageSize:i,pageNumber:r}=a;this._pageSize!==i&&(this._pageSize=i,e.paging.setPageSize(i));const n=this._pageNumber||1;n!==r&&r>0&&(t=r===n+1?2:r===n-1?3:6,this._pageNumber=r)}break;case"SortingInput":const s=jt(this._nextParameter)||[];e.sorting.splice(0,e.sorting.length),e.sorting.push(...s)}}this._currentParameter=this._nextParameter}return{nextAction:t,pageNumber:this._pageNumber}}getEntityTypeName(){return this._getDataProvider().getEntityName()}getUpdateFlag(){return!1}async ensureDataInitialization(e){let t=this.getLatestData();if(t.loading=!0,this._currentParameter.BoundViewParams){const{dispatch:e}=Object(ae.a)();await e(Object(bt.a)(this._pageId,this._controlName,a.a.tryParseOrNull(this._currentParameter.BoundViewParams.ViewId),this.getEntityTypeName(),this._contextToken,this._currentParameter.BoundViewParams.ViewDisplayName,this._currentParameter.BoundViewParams.FetchXml,this._currentParameter.BoundViewParams.LayoutXml))}const i=await this._dataProviderAdaptor.getView(),r=Pt(this._currentParameter,i);await async function(e,t,i){var r;if(e.length>0){const{primaryEntityMetadata:n,relatedEntityMetadata:a}=await i.getMetadata(e.map(({name:e})=>e)),s=ue(t);for(const t of e){const e=a[s(t.name)]||n,i=e.metadata[t.name];if(t.isPrimary=e===n&&n.primaryNameAttribute===t.name,!t.attributes){t.attributes=i;const e=null===(r=i)||void 0===r?void 0:r.Format,n=null==i?void 0:i.Type;n&&(t.attributes.Format=Object(H.i)(n,e))}t.displayName||(t.displayName=null==i?void 0:i.DisplayName),t.dataType||(t.dataType=null==i?void 0:i.Type),!t.disableSorting&&wt(i)&&(t.disableSorting=!0)}}}(r,i,this._getDataProvider()),this._createInnerWrapper(r,i),t=this.getLatestData(),t.refresh()}getParameterManifestType(){return r.a.Grid}getLatestData(){return this._innerWrapper.getDataSet()}retrieveDataSetObject(e,t,i,r){var n,a,s;this._isInitialDataSetFetchEnabled=null!==(n=this._isInitialDataSetFetchEnabled)&&void 0!==n?n:Object(X.c)(e,i,this._propKey),this._isPrimary=null!==(a=this._isPrimary)&&void 0!==a?a:Object(X.d)(e,i,this._propKey),this._pageSize=null!==(s=this._pageSize)&&void 0!==s?s:Object(ee.h)(e),this._dataProviderAdaptor.setOwnProps(t);const o=this._inputParser(e,t,i,r,this._propKey);let l;if(this._innerWrapper){const e=Tt(this._currentParameter,o);e.length&&(this._nextParameter=o,l=e.includes("RefreshInput"))}else{this._currentParameter=o;const e=Pt(o);this._createInnerWrapper(e)}return this._innerWrapper.getDataSet(l)}getUpdatedPropertiesDic(){return this._updatedProperties}clearUpdatedPropertiesDic(){this._updatedProperties={}}_addUpdatedProperty(e){this._isPrimary||(e=`${this._propKey}_${e}`),this._updatedProperties[e]=!0}_getDataProvider(){return this._dataProviderAdaptor.getDataProvider()}}function Pt({Columns:e},t){const i=[];if(e)for(const{Name:t,DisplayName:r,Alias:n,DataType:a}of e)i.push({name:t,displayName:r,dataType:a,alias:n,isHidden:!0,order:-1,visualSizeFactor:1});const r=ce(t);if(r)for(const{disableMetaDataBinding:e,name:t,width:n,isHidden:a,disableSorting:s,relatedEntityName:o}of r)if(!e){const e={name:t,alias:o&&!t.includes(".")?`${o}.${t}`:t,order:i.length+1,visualSizeFactor:n,isHidden:a,disableSorting:s};i.push(e)}return i}function wt(e){const t=null==e?void 0:e.SourceTypeMask;return!Object(w.c)(t)&&(0!=(2&t)||0!=(4&t)||0!=(8&t))}function Ct({PagingInput:e},t){let i=1;return e&&(i=e.firstPageNumber,t=e.pageSize),{pageNumber:i,pageSize:t,retrieveTotalRecordCount:!0}}function It({FilteringInput:e}){return e}function Et({LinkingInput:e},t,i){return Dt(e,t&&(()=>Object(X.f)(t,i).linkEntities))}function jt({SortingInput:e},t,i){return Dt(e,t&&(()=>Object(Y.x)(t,i)))}function Dt(e,t){if(t){const i=t();i&&(e=e?[...e,...i]:i)}return e}function Tt(e,t,i){const r=[];for(const n in yt){const a=n;if(vt.includes(a))continue;const s=yt[a],o=i&&(null==s?void 0:s(i)),l=e[a],c=t[a];!Ft(a,l,c)||i&&s&&!Ft(a,o,c)||r.push(a)}return r}function Ft(e,t,i){if(t===i)return!1;switch(e){case"ExtraFilters":return!Object(ut.a)(t,i);case"FilteringInput":return!Object(ct.a)(t,i);case"SortingInput":return!Object(ct.b)(t,i);case"LinkingInput":return!Object(ut.a)(t,i,X.e);case"PagingInput":const e=t,r=i;return(null==e?void 0:e.firstPageNumber)!==(null==r?void 0:r.firstPageNumber)||(null==e?void 0:e.pageSize)!==(null==r?void 0:r.pageSize)}return!0}function Nt(e,t){try{return Object(ae.a)().dispatch(ft("ModernDataSet.",e,t))}catch(e){const t=e;throw de(t.displayMessage||t.message||"ModernDataSet..openFile have failed during the execution.",t.errorCode,t.displayTitle)}}function Rt(e,t){return Object(ae.a)().dispatch(function(e,t,i){return{type:"navigation.open.url",execute:(r,n)=>Object(ht.c)(e+"OpenUrlAction.",t,n,r,i)}}("ModernDataSet.",e,t))}var kt=i("HRnw");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class At{constructor(e,t,i,r=null,n=null,s=null){this.status=0,this.formDescriptor=e,this.entityName=t,this.recordId=a.a.toString(i),this.associatedEntityLabel=r,this.associatedEntityRecordName=n,this.entityImageUrl=s}getComponentNameByControlId(e){throw new Error("Not initialized")}getComponentPropsByControlId(e){throw new Error("Not initialized")}retrieveRecordDataForForm(e,t){throw new Error("Not initialized")}}var Mt=i("y60j"),xt=i("VqBP"),Lt=i("BJ7u"),Vt=i("GYEz"),Bt=i("w1eR"),zt=i("xy1J");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function Ut(e,t){const i=e.formDescriptor.Controls[t];return!i||!i.UniqueId||!e.formDescriptor.ControlConfigurations[i.UniqueId]}function Wt(e,t,i){const r=t.formDescriptor.Controls[i],n=t.entityName,s=Object(xt.b)(e,n,r),o=r.ClassId&&a.a.toString(r.ClassId),{pcfDatasetGridEnabled:l}=Object(ze.D)(e);return Object(H.s)(r.Id,r.DataFieldName,s,r,n,o,l)}function Gt(e){return{initialized:J.a.Initializing,Tabs:[],Sections:{},Controls:{},ControlConfigurations:{},Id:e,Header:[],Footer:[],HiddenFields:[]}}class qt{constructor(){this.objectWrapperType=4,this._formRequested=!1,this._entityRequested=!1,this._recordRequested=!1,this._formDependenciesLoaded=!0,this._actions=null,this._formType=null,this._wrapperStatus=-1,this._memoizedComponents={},this._entityPrimaryImageField=null,this._handleFetchFailure=this._handleFetchFailure.bind(this),this._checkForm=this._checkForm.bind(this),this._checkEntity=this._checkEntity.bind(this)}getParameterManifestType(){return r.a.QuickForm}ensureDataInitialization(e){this._actions={retrieveForm:e.retrieveForm,retrieveEntityData:e.retrieveEntityData,retrieveRecordData:e.retrieveRecordForForm,forceUpdate:e.forceUpdate},this._fetchData()}_fetchData(e){var t,i;if(this._actions){if(2!==this._wrapperStatus||this._entityRequested||(this._entityRequested=!0,this._actions.retrieveEntityData(this.previousFormParameter.entityName).then(this._checkEntity).catch(this._handleFetchFailure)),0===this._wrapperStatus&&!this._formRequested){this._formRequested=!0,this._formDependenciesLoaded=!1;const e=new ye.a(this.previousFormParameter.entityName,a.a.tryParse(this.previousFormParameter.recordId));this._actions.retrieveForm(e,null===(i=null===(t=this.previousFormParameter.formDescriptor)||void 0===t?void 0:t.Id)||void 0===i?void 0:i.guid,this._formType).then(this._checkForm).catch(this._handleFetchFailure)}if(3===this._wrapperStatus&&!this._recordRequested){this._recordRequested=!0;const e=new ye.a(this.previousFormParameter.entityName,a.a.tryParse(this.previousFormParameter.recordId));this._actions.retrieveRecordData(e,this.previousFormParameter.formDescriptor.Id.guid,null,[],!0).catch(this._handleFetchFailure)}}}_checkEntity(e){e&&e.entities&&e.entities.hasOwnProperty(this.previousFormParameter.entityName)||this._handleFetchFailure(null)}_checkForm(e){!e||a.a.equals(a.a.EMPTY,e)?this._handleFetchFailure(null):this._formDependenciesLoaded=!0}_handleFetchFailure(e){this._wrapperStatus=5;const t=this.previousFormParameter&&this.previousFormParameter.formDescriptor&&this.previousFormParameter.formDescriptor.Id?this.previousFormParameter.formDescriptor.Id:a.a.EMPTY,i=this.previousFormParameter&&this.previousFormParameter.entityName?this.previousFormParameter.entityName:null;this.retrieveErrorFormObject(t,i),this._actions.forceUpdate()}retrieveErrorFormObject(e,t,i,r){this._wrapperStatus=5;const n=Gt(e);return this.previousFormParameter&&3===this.previousFormParameter.status||(this.previousFormParameter=new At(n,t,null,null,null,null),this.previousFormParameter.status=3,i&&1===r&&(this.previousFormParameter.errorMessage=Object(D.b)(i,zt.l))),this.previousFormParameter}retrieveFormObject(e,t,i,r,n,s,l,c,u,d){let p=this.previousFormParameter&&this.previousFormParameter.formDescriptor&&this.previousFormParameter.formDescriptor.initialized===J.a.Initialized&&a.a.equals(i,this.previousFormParameter.formDescriptor.Id)?this.previousFormParameter.formDescriptor:Object(Mt.h)(e,i);if(this.previousFormParameter&&this.previousFormParameter.formDescriptor&&r===Object(Lt.a)(6)){let i;const r=this.previousFormParameter.formDescriptor.Controls?Object.keys(this.previousFormParameter.formDescriptor.Controls):null;if(r&&r.forEach(r=>{const n=Object(h.Vc)(e,{id:t.id,controlName:r},c),a=this.previousFormParameter.formDescriptor.Controls[r],s=n&&a.Visible!==n.visible,o=n&&a.Label!==n.label&&null!=n.label;n&&(s||o)&&(i||(i={}),i[r]=Object.assign(Object.assign({},a),{Visible:s?n.visible:a.Visible,Label:o?n.label:a.Label}))}),i){p=Object.assign({},this.previousFormParameter.formDescriptor);const e=Object.assign({},this.previousFormParameter.formDescriptor.Controls);Object.keys(i).forEach(t=>{e[t]=i[t]}),p.Controls=e}}this._formType=r,d&&(this._chartDataRequestType=d);let g=2;const m=Object(ne.h)(e,n);this._entityPrimaryImageField=m?m.PrimaryImageAttribute:null;const f=t.descriptor.ShowLabel&&t.descriptor.Label?t.descriptor.Label:m?m.DisplayName:"";if(p&&p.initialized===J.a.Error||5===this._wrapperStatus)return b.a.info("Form: retrieveFormObject encountered error",[{name:"formId",value:a.a.toString(i)},{name:"entityName",value:n},{name:"controlId",value:t?t.controlId:""}]),this.retrieveErrorFormObject(i,n,e,1);if(!(Object(o.c)(e)||this.previousFormParameter&&6===this._wrapperStatus)){const t=Object(h.ec)(e);if(t&&!t.has(m.EntityLogicalName))return this._wrapperStatus=6,this.previousFormParameter=new At(null,n,null,null,null,null),this.previousFormParameter}if(a.a.equals(i,a.a.EMPTY)||!p||p.initialized===J.a.Initializing||p.initialized===J.a.Uninitialized||p.initialized===J.a.Initialized&&!this._formDependenciesLoaded){const t=p?p.initialized:null;let r=!1;return(!this.previousFormParameter||0!==this.previousFormParameter.status||0!==this._wrapperStatus&&-1!==this._wrapperStatus)&&(this.previousFormParameter&&this.previousFormParameter.formDescriptor&&!a.a.equals(this.previousFormParameter.formDescriptor.Id,i)&&(r=!0),p=Gt(i),this.previousFormParameter=new At(p,n,null,f,null,null),this.previousFormParameter.status=0),this._wrapperStatus=a.a.equals(i,a.a.EMPTY)?-1:t!==J.a.Initializing||this._formRequested?0:1,r&&(this._wrapperStatus=0,this._formRequested=!1),this._fetchData(e),this.previousFormParameter}const y=u||this._getAssociatedRecordPrimaryAttributeValue(e,t.id,n,s,c);if(y||null==s||a.a.equals(s,a.a.EMPTY)?g=2:(this._wrapperStatus=m&&m.Initialized===J.a.Initialized?3:2,g=1),this.previousFormParameter&&this.previousFormParameter.formDescriptor===p&&this.previousFormParameter.formDescriptor&&this.previousFormParameter.formDescriptor.initialized===p.initialized&&a.a.equals(this.previousFormParameter.formDescriptor.Id,i)&&(null===this.previousFormParameter.recordId&&null===s||this.previousFormParameter.recordId===s.guid)&&this.previousFormParameter.entityImageUrl===l&&this.previousFormParameter.associatedEntityRecordName===y)return 1===g&&this._fetchData(e),this.previousFormParameter;const v=new At(p,n,s,f,y,l);return v.status=g,v.getComponentPropsByControlId=this.getComponentPropsByControlId.bind(this,e,v),v.getComponentNameByControlId=this.getComponentNameByControlId.bind(this,e,v),v.firstDataRequestType=this._getFirstDataRequestType(e,t,c),this.previousFormParameter=v,1===g&&this._fetchData(e),v}linkToParameter(e,t){const i=t.retrieveRecordDataForForm,r=e.formDescriptor&&e.formDescriptor.Id?e.formDescriptor.Id.guid:null,n=this._entityPrimaryImageField?[this._entityPrimaryImageField+"_url"]:null;e.retrieveRecordDataForForm=this._retrieveRecordDataForForm.bind(this,new ye.a(e.entityName,a.a.tryParse(e.recordId)),r,i,null,n)}getComponentNameByControlId(e,t,i){const r=t.formDescriptor.Controls[i];if(!Ut(t,i))return r.UniqueId;const n=Wt(e,t,i);return Object(H.B)(n)}getComponentPropsByControlId(e,t,i,r=!1){this._memoizedComponents[i]||(this._memoizedComponents[i]={controlId:i});const n=this._memoizedComponents[i],s=t.entityName;let o;const l=t.formDescriptor.Controls[i];if(Ut(t,i)||r)if(function(e,t){var i;return Object(_.f)(e,P.P)&&!a.a.isNullOrEmpty(null===(i=null==t?void 0:t.Parameters)||void 0===i?void 0:i.VisualizationId)&&"Chart"===t.Parameters.ChartGridMode}(e,l)){const t=!Object(_.e)(e,P.L,P.jf,P.M)||Object(_.e)(e,P.J,P.o,P.G);o=Object(H.y)(l.Parameters,this._chartDataRequestType,t)}else o=Wt(e,t,i);else{o=t.formDescriptor.ControlConfigurations[l.UniqueId].CustomControls[0];const i=Object(Vt.a)(e);if(Object(_.f)(e,P.Vh)&&i!==Bt.a.MailApp&&l.DataFieldName){const t=Object(G.e)(e,o.Name);t&&(o=Object(H.H)(o,t))}}const c=t.recordId,u=t.formDescriptor.Id;let d;return d=n.nestedFormProps&&n.nestedFormProps.EntityName===s&&n.nestedFormProps.RecordId===c&&n.nestedFormProps===u?n.nestedFormProps:{EntityName:s,RecordId:t.recordId,FormId:a.a.toString(t.formDescriptor.Id)},o===n.configuration&&l===n.descriptor&&d===n.nestedFormProps||(n.configuration=o,n.descriptor=l,n.nestedFormProps=d,n.componentProps={configuration:o,descriptor:l,nestedFormProps:d}),n.componentProps}getLatestData(){return this.previousFormParameter}_getAssociatedRecordPrimaryAttributeValue(e,t,i,r,n){const s=Object(re.h)(e,i),o=new ye.a(i,r||a.a.EMPTY),l=Object(h.hc)(e,t,n),c=Object(be.e)(e,l,o,s);return c&&c.value?c.value:null}_retrieveRecordDataForForm(e,t,i,r,n){i(e,t,r,n)}_getFirstDataRequestType(e,t,i){if(!i)return null;if(!Object(h.fd)(e,t.id,t.descriptor))return null;const r=Object(h.hc)(e,t.id,i.parentContextToken);return Object(be.b)(e,r)?null:1}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var Ht=i("3mEc"),Qt=i("b8TU"),Kt=i("unFF");function Xt(e,t){return"web"===function(e){if(e<425)return"mobile";if(e<600)return"tablet";return"web"}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(Object(Qt.c)(e))||!1!==t}function Yt(e){return e*function(){let e;if(void 0===e){const t=window.document.getElementsByTagName("body")[0],i=window.getComputedStyle(t,null).getPropertyValue("font-size");e=parseInt(i.replace("px",""),10)}return e}()}class Jt{constructor(e){Object.assign(this,e)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class $t{constructor(){this.previousReturn=new Jt({IsMicrosoftFlowEnabled:!1,MicrosoftFlowFirstPartyIntegrationSiteUrl:"",MicrosoftFlowDestinationUrl:"",MicrosoftFlowEnvironmentId:""})}retrieveMicrosoftFlowObject(e,t,i,r){const n=function(e){return{isMicrosoftFlowEnabled:e&&e.organization&&e.organization.organizationSettings&&e.organization.organizationSettings.isMicrosoftFlowEnabled,microsoftFlowFirstPartyIntegrationSiteUrl:e&&e.organization&&e.organization.organizationSettings&&e.organization.organizationSettings.microsoftFlowFirstPartyIntegrationSiteUrl,microsoftFlowDestinationUrl:e&&e.organization&&e.organization.organizationSettings&&e.organization.organizationSettings.microsoftFlowDestinationUrl,microsoftFlowEnvironmentId:e&&e.organization&&e.organization.organizationSettings&&e.organization.organizationSettings.microsoftFlowEnvironmentId}}(e),a={IsMicrosoftFlowEnabled:n.isMicrosoftFlowEnabled,MicrosoftFlowFirstPartyIntegrationSiteUrl:n.microsoftFlowFirstPartyIntegrationSiteUrl,MicrosoftFlowDestinationUrl:n.microsoftFlowDestinationUrl,MicrosoftFlowEnvironmentId:n.microsoftFlowEnvironmentId};return this.previousReturn=a,a}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function Zt(e,t,i,r,n){return r.Parameters[e].Value}var ei=i("lLEV");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const ti=[r.a.Currency,r.a.DateAndTimeDateAndTime,r.a.DateAndTimeDateOnly,r.a.Decimal,r.a.FP,r.a.Multiple,r.a.OptionSet,r.a.SingleLineEmail,r.a.SingleLinePhone,r.a.SingleLineText,r.a.SingleLineTextArea,r.a.SingleLineTickerSymbol,r.a.SingleLineURL,r.a.TwoOptions,r.a.WholeDuration,r.a.WholeLanguage,r.a.WholeNone,r.a.WholeTimeZone],ii=[r.a.LookupSimple,r.a.LookupPartyList,r.a.LookupRegarding,r.a.LookupOwner,r.a.LookupCustomer,r.a.LookupMultiEntity],ri=[0,1,2,3,4,5,6],ni={};function ai(e,t,i){for(const r of t)e[r]=i}function si(e,...t){for(const i of t)ni.hasOwnProperty(i)||ai(ni,[i],e)}function oi(){let e=null,t={};const i={},n=function(){const e={};return t=>(e[t]||(e[t]=t in ni?ni[t]():ni[r.a.SingleLineText]()),e[t])}();return(a,o,l,c,u,d)=>{var p,h,g;const m=l.configuration?l.configuration.CustomControlId:"";b.a.info(m+".CustomControlFramework.Selectors.CustomControlHostDynamicDataSelectors: createGetDynamicData started");let f=!1,y=!0;const v={},S=[];if(a&&a.Parameters&&Object.keys(a.Parameters).length){const e=Object(G.e)(c,l.configuration.CustomControlId);for(const o in a.Parameters){const m=a.Parameters[o],b=n(m.Type)(o,c,l,a,u,d),_=b;let O=!1;if(e&&b instanceof s.a||b instanceof q.a){if(e.Properties.DataSetDefinitions[o]&&!b.isValidParameterConfiguration(m))continue}(null===b||(b instanceof s.a||b instanceof q.a)&&b.getParameterManifestType()===r.a.Grid&&(!b.getLatestData().columns||0===b.getLatestData().columns.length)||_&&3===_.objectWrapperType&&b instanceof ei.a&&b.isLoading())&&(y=!!(b instanceof W.a&&b.getLatestData())),t.hasOwnProperty(o)&&t[o]===b||(v[o]=b,S.push(o),f=!0,O=!0);let P=!1;_&&(P=-1!==ri.indexOf(_.objectWrapperType)),P||(P=b instanceof s.a||b instanceof q.a||b instanceof N),P&&b.getLatestData()!==i[o]&&(v[o]=b,i[o]=b.getLatestData(),O||S.push(o),f=!0);const w=null===(h=null===(p=b)||void 0===p?void 0:p.getUpdatedPropertiesDic)||void 0===h?void 0:h.call(p);if(w){!0===w[(null===(g=Object.keys(w))||void 0===g?void 0:g.filter(e=>-1!==e.indexOf(X.a)))[0]]&&(f=!0)}}}else e&&e.response&&!Object.keys(e.response.parameters).length||(f=!0);return f?(S.push("parameters"),t=Object.assign(Object.assign({},t),v),e={response:{parameters:t,dataReady:y,updated:!0},updatedProperties:S}):(e.response.updated=!1,e.updatedProperties=S),b.a.info(m+".CustomControlFramework.Selectors.CustomControlHostDynamicDataSelectors: createGetDynamicData finished"),e}}ai(ni,ti,n.a),ai(ni,ii,(function(){const e={},t={},i={},s=Object(n.a)(),o={};return(n,l,c,u,d,p)=>{b.a.info(c.controlId+"."+U+": createGetLookupData started");let h=!1;const g=u.Parameters[n],m=s(n,l,c,u,d,p);if(!o.hasOwnProperty(n)||!o[n])switch(g.Type){case r.a.LookupCustomer:o[n]=new k(n,p);break;case r.a.LookupOwner:o[n]=new M(n,p);break;case r.a.LookupSimple:o[n]=new V.a(n,p);break;case r.a.LookupPartyList:o[n]=new L(n,p);break;case r.a.LookupRegarding:o[n]=new z(n,p);break;case r.a.LookupMultiEntity:o[n]=new N(n,p);break;default:throw new Error("Unknown parameter type")}let f=o[n];const y=o[n].getLatestData(),v=g;if(y&&v&&y.getViewId&&!a.a.equals(a.a.fromExternalGuid(y.getViewId()),a.a.fromExternalGuid(v.ViewId))){const e=f;f=e.refreshingStatus&&0!==e.refreshingStatus?new V.a(n,p,!0):new V.a(n,p,!1),o[n]=f}const S=f;if(null===m)return b.a.info(c.controlId+"."+U+": createGetLookupData return null"),null;t.hasOwnProperty(n)&&t[n]===m||(t[n]=m,h=!0);const _=f.retrieveDataSetObject(l,c,u,d);if(i.hasOwnProperty(n)&&i[n]&&_===i[n]||(i[n]=_,h=!0),f instanceof V.a)f.extendByFieldData(_,m);else{if(!(f instanceof N))throw b.a.error(c.controlId+"."+U+": createGetLookupData encountered error, unknown Lookup parameter wrapper type"),new Error("Unknown Lookup parameter wrapper type");f.extendByFieldData(_,m)}return h&&(e[n]=S),b.a.info(c.controlId+"."+U+": createGetLookupData finished"),e[n]}})),ai(ni,[r.a.Grid],(function(){const e={},t={},i={};return(r,n,a,o,l,c)=>{b.a.info(a.configuration.CustomControlId+".CustomControlFramework.Selectors.DynamicDataSelectors.CustomControlDataSetDataSelector: createGetDataSetData started");let u=!1;if(!i.hasOwnProperty(r)||!i[r]){const e=o.Parameters[r],t=Object(G.e)(n,o.CustomControlId);e.ChartGridMode&&"Chart"===e.ChartGridMode?i[r]=new W.a(r,c):Object(kt.a)(n,t)?i[r]=new Ot(r,e,c,a):t&&Object(H.k)(t)?i[r]=new q.a(r,null,c):i[r]=new s.a(r,null,c)}const d=i[r],p=d.retrieveDataSetObject(n,a,o,l);d instanceof q.a&&d.updateControlMemoizedParameter(n,p,!1,null),t.hasOwnProperty(r)&&t[r]&&p===t[r]||(t[r]=p,u=!0);const h=d;return u&&(e[r]=h),b.a.info(a.configuration.CustomControlId+".CustomControlFramework.Selectors.DynamicDataSelectors.CustomControlDataSetDataSelector: createGetDataSetData finished"),e[r]}})),ai(ni,[r.a.WebResourceHtmlControl],(function(){const e={};return(t,i,n,a,s)=>{let o;b.a.info(n.controlId+".CustomControlFramework.Selectors.DynamicDataSelectors.CustomControlWebResourcesSelector: createGetWebResourceHtmlData started");const l=a.Parameters[t],c=Object(Ht.l)(l),u=Object(Ht.g)(i,c);if(u){let e=l.Url;e=Object(ze.x)(i)+e;const t=Xt(i,u.isEnabledForMobileClient);o={ControlId:l.ControlId,Title:l.Title,Url:e,Visible:t||l.Visible,ShowLabel:l.ShowLabel,Label:l.Label,Type:r.a.WebResourceHtmlControl,PageType:l.PageType,WebResourceType:l.WebResourceType?l.WebResourceType:-1,ControlParameters:l.ControlParameters}}else{let e=null;const t=Object(Ve.a)(i,n.id);if(e=t&&t.webResourcePageDescriptor?t.webResourcePageDescriptor:Object(Ht.h)(i,n.descriptor),!e)return null;let a={};n.descriptor&&n.descriptor.Parameters&&(a=Object(Ht.i)(n.descriptor));let s=!0;if("FullPage"===e.pageType){const t=function(e,t){if(e&&e.metadata&&e.metadata.webResourceDescriptorsByName)return e.metadata.webResourceDescriptorsByName[t];return null}(i,e.Name);t&&void 0!==t.isEnabledForMobileClient&&(s=Xt(i,t.isEnabledForMobileClient))}const l=Object(Kt.a)(i);o={ControlId:e.controlId,Title:e.title,Url:e.url,Visible:"FullPage"===e.pageType?s:e.visible,ShowLabel:e.showLabel,Label:e.label,Type:r.a.WebResourceHtmlControl,PageType:e.pageType,WebResourceType:e.webresourceType,CellHeight:Yt(l.sizes.Section.cellHeightInRem),ControlParameters:a,WebResourceName:e.Name?e.Name:""}}return e.hasOwnProperty(t)&&e[t].Url===o.Url||(e[t]=o),b.a.info(n.controlId+".CustomControlFramework.Selectors.DynamicDataSelectors.CustomControlWebResourcesSelector: createGetWebResourceHtmlData finished"),e[t]}})),ai(ni,[r.a.MicrosoftFlow],(function(){return(e,t,i,r,n)=>{b.a.info(i.controlId+".CustomControlFramework.Selectors.DynamicDataSelectors.CustomControlMicrosoftFlowSelector: createGetMicrosoftFlowData started");const a=new $t;return a.retrieveMicrosoftFlowObject(t,i,r,n),b.a.info(i.controlId+".CustomControlFramework.Selectors.DynamicDataSelectors.CustomControlMicrosoftFlowSelector: createGetMicrosoftFlowData finished"),a}})),ai(ni,[r.a.QuickForm,"Form.Card"],(function(){const e={},t={},i={};return(r,n,s,o,l,c)=>{b.a.info(s.controlId+".CustomControlFramework.Selectors.DynamicDataSelectors.CustomControlQuickFormSelector: createGetQuickFormData started");let u,d,p=!1;const g=o.Parameters[r].Value.split("|");if(g.length<2)throw b.a.error(s.controlId+".CustomControlFramework.Selectors.DynamicDataSelectors.CustomControlQuickFormSelector: createGetQuickFormData encountered error, invalid form configuration provided"),new Error("Invalid form configuration provided");let m=g[0],f=null;if(m.indexOf(":")>-1){const e=m.split(":");m=e[0],f=e[1]}f=f||Object(Lt.a)(6);const y=g[1];let v=a.a.EMPTY,S=null,_=y;if(g.length>=3){v=a.a.tryParse(g[2]);const e=_?Object(ne.h)(n,_):null,t=!a.a.isNullOrEmpty(v)&&_?new ye.a(_,v):null,i=e&&t?Object(Pe.j)(n,t,e.PrimaryImageAttribute+"_url"):null;S=i?i.value:null}else{const e=new ye.a(l.entityTypeName,a.a.isNullOrEmpty(l.id)?a.a.EMPTY:l.id),t=Object(h.hc)(n,s.id,c.parentContextToken);u=Object(be.e)(n,t,e,y);const i=u?u.reference:null;if(v=i&&i.id?i.id:a.a.EMPTY,d=u&&u.reference?u.reference.name:"",_=i?i.etn:null,!_){const e=Object(re.a)(n,l.entityTypeName,y),t=e?e.Targets:null;_=t&&t.length?t[0]:null}const r=_?Object(ne.h)(n,_):null,o=r&&i?Object(Pe.j)(n,i,r.PrimaryImageAttribute+"_url"):null;S=o?o.value:null}i.hasOwnProperty(r)&&i[r]||(i[r]=new qt);const O=i[r],P=a.a.tryParse(m),w=o.Parameters[r].FirstDataRequestType,C=O.retrieveFormObject(n,s,P,f,_,v,S,c,d,w);t.hasOwnProperty(r)&&t[r]&&C===t[r]||(p=!0);const I=O;return p&&(t[r]=C,e[r]=I),b.a.info(s.controlId+".CustomControlFramework.Selectors.DynamicDataSelectors.CustomControlQuickFormSelector: createGetQuickFormData finished"),e[r]}})),ai(ni,["GroupDefinition"],()=>Zt)},qwRa:function(e,t,i){"use strict";i.d(t,"a",(function(){return a})),i.d(t,"b",(function(){return s}));var r=i("dHD5"),n=i("BFlg");const a="chart.visualizationtype.update";function s(e,t,i){return{type:"chart.visualizationtype.update.async",execute({dispatch:s,getState:o},l){const c=l.TraceManager.getTracer(n.P),u=n.N+".updateVisualizationTypeAction";try{c.info("Update the chart visualization type"),t||(t=Object(r.l)(o(),e));const n=Object(r.w)(t);return s(function(e,t,i){return{type:a,payload:{name:"chartVisualizationType",value:i},meta:{pageId:e,dataSetContextKey:t}}}(e,n,i)),l.EventManager.ReportComponentSuccess(u),Promise.resolve()}catch(e){const t="Update the chart visualization type failed with error : "+e.message;l.EventManager.ReportComponentFailure(u,Error(t))}}}}},r0As:function(e,t,i){"use strict";i.d(t,"b",(function(){return s})),i.d(t,"d",(function(){return c})),i.d(t,"f",(function(){return u})),i.d(t,"e",(function(){return d})),i.d(t,"h",(function(){return m})),i.d(t,"g",(function(){return f})),i.d(t,"j",(function(){return g})),i.d(t,"c",(function(){return S})),i.d(t,"a",(function(){return _})),i.d(t,"i",(function(){return v}));var r=i("kSDG"),n=i("nfCs");function a(e,t,i,r){return{name:e,aliasName:t,descending:i,entity:r||null}}function s(e,t,i,r){return o(e,t,i,null,r)}function o(e,t,i,r,n){const a={getState:n,entityName:e,tableAliasCount:0,tableAliases:new Array,attributes:[],attributesByName:new Map,orderByAttributes:[],groupByAttributes:[],aggregateAttributes:[],linkedEntities:[],parentEntity:t||null,useLimitStatement:!0,top:5e3,offset:1,alias:r,filters:[]};return l(a),t?(a.baseEntity=t.baseEntity,a.joinType=i||0):a.baseEntity=a,a}function l(e){if(e.entityName){const t=String.format("{0}{1}",e.entityName,e.tableAliasCount++);e.tableAliases.push(t),e.tableAlias=t}else e.tableAlias=""}function c(e){return(new XMLSerializer).serializeToString(e.fetchXmlDoc.documentElement)}function u(e,t){const i=new DOMParser;e.fetchXmlDoc=i.parseFromString(t,"text/xml");const r=e.fetchXmlDoc.getElementsByTagName("fetch");r&&r.length>0&&d(e,r[0])}function d(e,t){const i=new DOMParser,s=new XMLSerializer;e.fetchXmlDoc=i.parseFromString(s.serializeToString(t),"text/xml"),e.hasAggregate="true"===p(t,"aggregate");const c=p(t,"count");c&&(e.top=Number(c));const u=t.getElementsByTagName("entity");let h=u&&u.length>0?u[0]:null;h||"link-entity"!==t.tagName||(h=t),e.parentEntity||(e.tableAliasCount=0,e.tableAliases=[],l(e),e.baseEntity=e),function(e,t){e.entityName=p(t,"name");const i=t.childNodes;for(let t=0;t<i.length;t++){const s=i.item(t);if(!s||!s.tagName)continue;switch(s.tagName.toLowerCase()){case"attribute":{let t=null;const i=Object(n.b)(p(s,"dategrouping"));i>=0&&(t=Object(n.a)(i));const a=p(s,"name"),o=p(s,"alias"),l=Object(r.a)(a,o,e,t);e.attributesByName.set(null===o?a:o,l),e.attributes.push(l);const c=p(s,"aggregate");c&&(l.hasAggregate=!0,l.aggregateType=c,e.aggregateAttributes.push(l));const u=p(s,"groupby");u&&"true"===u&&(l.hasGroupBy=!0,e.groupByAttributes.push(l));break}case"order":{const t=p(s,"alias"),i=p(s,"attribute"),r=p(s,"descending"),n=a(i,t,r&&"true"===r,e);e.orderByAttributes.push(n);break}case"link-entity":{const t=s.getAttribute("name"),i=s.getAttribute("from"),r=s.getAttribute("to"),n=o(t,e,null,s.getAttribute("alias"),e.getState);O(n,i,r,"eq",y(s)),d(n,s),e.linkedEntities.push(n);break}case"filter":e.filters.push(s.outerHTML);break;default:throw new Error("Unexpected Node Name.")}}}(e,h)}function p(e,t){return e.getAttribute(t)}function h(e){let t=e.fetchXmlDoc.getElementsByTagName("entity")[0];return t||(t=e.fetchXmlDoc.getElementsByTagName("link-entity")[0]),t}function g(e,t){!function e(t,i){const r=new Array;for(let n=0,a=t.childNodes.length;n<a;n++){const a=t.childNodes[n];switch(a.nodeName){case"attribute":i?i&&p(a,i)&&"true"===p(a,i).toLowerCase()&&r.push(a):r.push(a);break;case"order":r.push(a);break;case"link-entity":e(a,i),r.push(a)}}for(let e=0;e<r.length;e++)t.removeChild(r[e])}(e.fetchXmlDoc.getElementsByTagName("entity")[0],t),function(e){if(e.hasAggregate){for(let t=e.groupByAttributes.length-1;t>=0;t--)e.groupByAttributes[t].hasGroupBy&&e.groupByAttributes.splice(t,1);for(let t=e.orderByAttributes.length-1;t>=0;t--)e.orderByAttributes.splice(t,1)}}(e)}function m(e,t,i,r,n){const s=i?null:t.attributeName?t.attributeName:t.aliasName,o=i?t.aliasName?t.aliasName:t.attributeName:null;!function(e,t,i,r,n){const a=e.fetchXmlDoc.createElement("order");if(t){const i=e.fetchXmlDoc.createAttribute("attribute");i.value=t,a.attributes.setNamedItem(i)}if(i){const t=e.fetchXmlDoc.createAttribute("alias");t.value=i,a.attributes.setNamedItem(t)}const s=e.fetchXmlDoc.createAttribute("descending");s.value=r?"true":"false",a.attributes.setNamedItem(s);const o=h(e);if(n<0)return void o.appendChild(a);const l=o.childNodes;let c=-1;for(let e=0;e<l.length;e++){const t=l[e],i=t.nodeName;if(i&&"order"===i.toLowerCase()&&(c++,c===n))return void o.insertBefore(a,t)}o.appendChild(a)}(e,s,o,r,n);const l=a(s,o,r,e);n<0||n>=e.orderByAttributes.length?e.orderByAttributes.push(l):e.orderByAttributes.splice(n,0,l)}function f(e,t,i,r,n,a,s){const o=e.fetchXmlDoc.createElement("attribute");o.attributes.setNamedItem(b(e,"name",t)),i&&o.attributes.setNamedItem(b(e,"alias",i)),r&&o.attributes.setNamedItem(b(e,"groupby",r)),n&&o.attributes.setNamedItem(b(e,"aggregate",n)),a&&(o.attributes.setNamedItem(b(e,"dategrouping",a)),s?o.attributes.setNamedItem(b(e,"usertimezone",s)):o.attributes.setNamedItem(b(e,"usertimezone","true")));h(e).appendChild(o)}function b(e,t,i){const r=e.fetchXmlDoc.createAttribute(t);return r.value=i,r}function y(e){const t=p(e,"link-type");if(!t)return 0;switch(t){case"natural":return 2;case"inner":return 0;case"outer":return 1;case"matchfirstrowusingcrossapply":return 3;case"in":return 4;case"exists":return 5;default:throw new Error("EntityQueryExpression.GetLinkType: Invalid join type!")}}function v(e){const t=h(e);!function(e){const t=Array.from(e.childNodes).filter(e=>"link-entity"===e.tagName);for(let i=0;i<t.length;i++)e.removeChild(t[i])}(t),function(e,t){for(let i=0;i<t.linkedEntities.length;i++){const r=h(t.linkedEntities[i]).cloneNode(!0);e.appendChild(r)}}(t,e)}function S(e,t){return function(e,t,i,r,n,a){const s=o(e,i,null,t,i.getState);O(s,r,n,"eq",0);const l=function(e,t){const i=t.fetchXmlDoc.createElement("link-entity");if(e.entityName){const r=t.fetchXmlDoc.createAttribute("name");r.value=e.entityName,i.attributes.setNamedItem(r)}if(e.linkFromAttribute){const r=t.fetchXmlDoc.createAttribute("from");r.value=e.linkFromAttribute,i.attributes.setNamedItem(r)}if(e.linkToAttribute){const r=t.fetchXmlDoc.createAttribute("to");r.value=e.linkToAttribute,i.attributes.setNamedItem(r)}if(null!==e.joinType){const r=t.fetchXmlDoc.createAttribute("link-type");r.value=function(e){switch(e){case 2:return"natural";case 0:return"inner";case 1:return"outer";case 3:return"matchfirstrowusingcrossapply";case 4:return"in";case 5:return"exists";default:throw new Error("EntityQueryExpression.convertLinkTypeToString: Invalid join type!")}}(e.joinType),i.attributes.setNamedItem(r)}return i}(s,i);return d(s,l),s}(e.entityName,e.alias,t,e.linkFromAttribute,e.linkToAttribute,e.joinType)}function _(e,t){const i=h(t),r=h(e);i.appendChild(r.cloneNode(!0))}function O(e,t,i,r,n){e.linkFromAttribute=t,e.linkToAttribute=i,e.conditionOperator=r,e.joinType=n}},sn0j:function(e,t,i){"use strict";i.d(t,"c",(function(){return p})),i.d(t,"a",(function(){return d})),i.d(t,"b",(function(){return h}));var r=i("SAYH"),n=i("Lohl"),a=i("y60j"),s=i("LbMF"),o=i("FZDd"),l=i("3hnk"),c=i("pGYJ"),u=i("qLnS");const d=["activitytypecode","prioritycode","scheduledend","subject","description","regardingobjectid","ownerid","createdon","statecode","modifiedon"];function p(e,t,i){return{type:"formandattribute.retrieve.async",execute({dispatch:l,getState:u},p){const m="Card"===i;return e.etn&&"activitypointer"===e.etn&&m?l(Object(o.f)("activitypointer",!1,d)).then(()=>{const t=u(),i={};for(const r of d){const n=Object(s.a)(t,e.etn,r);n&&h(t,e.etn,r,n)&&(i[r]=n)}return g(t,e.etn,i,Object(s.d)(t,e.etn)),{formDescriptor:null,attributeDescriptors:i}}):l(Object(n.d)(e,t,i)).then(n=>{const d={};let f=null;return e.etn?l(Object(o.f)(e.etn,!0,[])).then(()=>{const t=u();if(!r.a.isNullOrEmpty(n)&&(f=Object(a.h)(t,n),f&&f.Attributes))for(const i in f.Attributes){const r=f.Attributes[i],n=Object(s.a)(t,e.etn,r);n&&h(t,e.etn,r,n)&&(d[r]=n)}return m&&g(t,e.etn,d,Object(s.d)(t,e.etn)),{formDescriptor:f,attributeDescriptors:d}}):(p.EventManager.ReportComponentSuccess("Form.CustomControl.retrieveFormWithAttributes",[{name:"APIName",value:c.a+".Actions.RetrieveFormWithAttributesAction"},{name:"formId",value:r.a.toString(t)},{name:"formType",value:i}]),null)},e=>{const n=e.get_message();p.EventManager.ReportComponentFailure("Form.CustomControl.retrieveFormWithAttributes",new Error(n),n,[{name:"APIName",value:c.a+".Actions.RetrieveFormWithAttributesAction"},{name:"formId",value:r.a.toString(t)},{name:"formType",value:i}])})}}}function h(e,t,i,r){return Object(l.f)(e,t,i,u.a.CanRead)&&r&&r.IsValidForRead}function g(e,t,i,r){if(r)for(const n in r){const a=r[n];!a.IsSortableEnabled&&"modifiedon"!==a.LogicalName||i[n]||!h(e,t,a.LogicalName,a)||"image"===a.Type||"multiselectpicklist"===a.Type||(i[n]=a)}}},sozv:function(e,t,i){"use strict";i.d(t,"a",(function(){return U})),i.d(t,"b",(function(){return z}));var r=i("odYE"),n=i("SAYH"),a=i("eXjw"),s=i("izYK"),o=i("i1f0"),l=i("WPtp"),c=i("LbMF"),u=i("5Oca"),d=i("+nNZ");var p=i("AsoW"),h=i("y60j"),g=i("bT7G"),m=i("NjDY"),f=i("IqkD"),b=i("2ciq"),y=i("Xd5/"),v=i("dHD5"),S=i("jq7Z");var _=i("H523"),O=i("0cBP");var P=i("3hnk"),w=i("JwRZ"),C=i("5ZBI"),I=i("tJdb"),E=i("qLnS"),j=i("+QYJ"),D=i("zmL5"),T=i("6QGX"),F=i("64CY"),N=i("7Sr4"),R=i("Lyxw"),k=i("dpM5"),A=i("3/02"),M=i("qpML"),x=i("YxC/"),L=i("xy1J"),V=i("g2Nw");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const B="CustomControlFramework.Selectors.DynamicDataSelectors.CustomControlFieldDataSelector";function z(e,t){const i=Object(h.h)(e,t);return!!i&&7===i.FormType}function U(){const e={},t={},i={};let w;const U={};let H=[],Q=null,K=null;const X=function(){let e,t;return(i,r,n)=>{const a=Object(o.C)(i,r,n);if(!a)return t=a,e=null,null;if(a===t)return e;const s=Object.keys(a);let l=null,c=null,u=null;for(let e=0;e<s.length;e++){const t=a[s[e]];l||t.notificationLevel!==_.a.error||(l=t),c||t.notificationLevel!==_.a.recommendation||(c=t),u||t.notificationLevel!==_.a.information||(u=t)}return t=a,e={error:l,recommendation:c,information:u},e}}();let Y=null;return(_,J,$,Z,ee,te)=>{var ie,re,ne,ae;C.a.info($.controlId+"."+B+": createGetFieldParameterData started");const se=Object(f.x)(J),oe=Object(m.D)(J),le=$.formInfo&&$.formInfo.FormId?new n.a($.formInfo.FormId):Object(D.b)(J,$.id),ce=function(e,t){const i=Object(h.h)(e,t);return!!i&&10===i.FormType}(J,le),ue=z(J,le),de=$.id;let pe,he,ge;$.formInfo&&$.formInfo.EntityName&&$.formInfo.RecordId?(pe=$.formInfo.EntityName,he=new n.a($.formInfo.RecordId)):(pe=ee.entityTypeName,he=ee.id);let me=!1;const fe=new r.a(pe,ee.id),be=Z.Parameters[_];let ye={};const ve=0===be.Usage,Se=1===be.Usage,_e=2===be.Usage;if(_.includes("isEmpty")){const t="showStageGatingError",i=Z.Parameters[t],r=e[t];if(!!i&&!!r&&i.Value!==r.raw&&(!e.hasOwnProperty(_)||e[_].type!==be.Type)){const t="value",i=Z.Parameters[t];if(i){const t=i.Value,r=Object(o.hc)(J,de,te),n=Object(o.ab)(J,de,te,r,fe,t);let a;a=Object(j.c)($)||Object(j.c)($.descriptor)||Object(j.c)($.descriptor.Id)||!Object(o.bd)($.descriptor.Id)?Object(u.E)(n,J,pe,t):Object(p.d)(n,J,pe,t),me=!e[_]||a!==e[_].raw,ge={type:be.Type,raw:a,formatted:null,attributes:ye,error:!1,errorMessage:null,security:{},isPropertyLoading:!1}}}}else if(3===be.Usage&&i[_]!==be){const e=Object(x.e)(J,V.a),t=be;i[_]=t,ge={type:t.Type,raw:t.Value,formatted:t.Attributes&&be.Value?Object(y.y)(be.Value,Object(y.A)(J,t.Attributes),e):null,error:!1,errorMessage:null,security:t.Security||{secured:!1,editable:!0,readable:!0},attributes:t.Attributes,isPropertyLoading:!1},me=!0}else if(_e)e.hasOwnProperty(_)&&e[_].type===be.Type||(ge={type:be.Type,raw:null,formatted:null,attributes:ye,error:!1,errorMessage:null,security:{},isPropertyLoading:!1},me=!0);else if(void 0===be.Value)e.hasOwnProperty(_)||(ge={type:null,raw:null,formatted:null,attributes:ye,error:!1,errorMessage:null,security:{},isPropertyLoading:!1},me=!0);else if(be.Static)e.hasOwnProperty(_)&&e[_].raw===be.Value||(ge={type:be.Type,raw:be.Value,formatted:null,attributes:ye,error:!1,errorMessage:null,security:{},isPropertyLoading:!1},me=!0);else if(Se&&be.ControlLinked){const e=be.Value,t=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t,i,r){const n=Object(S.a)(e,t),a=Object(v.w)(i);return n&&n.forms&&n.forms[a]&&n.forms[a].controlUnboundOutputs[r]?n.forms[a].controlUnboundOutputs[r]:null}(J,de,te,e);let i=t?t.value:null;if(!i){const t=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t,i){const r=Object(S.a)(e,t);return r&&r.formlessControlOutputs&&r.formlessControlOutputs[i]?r.formlessControlOutputs[i]:null}(J,de,e);i=t?t.value:null}i!==U[e]&&(ge={type:be.Type,raw:i,formatted:i,error:!1,errorMessage:null,security:{},attributes:{}},U[e]=i,me=!0)}else{const r=be.Value;if(N.a.getInstance().getAttributesPendingUpdate().has(r))return e[_];const p=Object(u.b)(fe)(J,fe.etn);if(ve&&!ce&&!ue&&!n.a.isNullOrEmpty(he)&&(!p||!Object(a.b)(p.initialized)))return C.a.warn($.controlId+"."+B+": createGetFieldParameterData record data is not usable"),null;let h=!1;const f=t.hasOwnProperty(_)?t[_]:{timestamp:null,fieldName:null,rawAttributes:null,pageAttributes:null,finalAttributes:null},D=!!p&&(p.initialized===a.a.Initializing||p.initialized===a.a.Refreshing);(ve||Se)&&e[_]&&D!==e[_].isPropertyLoading&&(h=!0);const V=Object(o.hc)(J,de,te),z=Object(o.ab)(J,de,te,V,fe,r);let U=[];be.Type===s.a.SingleLineAddress&&(U=Object(F.d)(r)||[]),!z||f.fieldName&&f.fieldName===r&&f.timestamp&&z.timestamp===f.timestamp?w&&!n.a.equals(w.id,he)&&(h=!0,f.timestamp=z?z.timestamp:f.timestamp,f.fieldName=r,w=ee):(h=!0,f.timestamp=z.timestamp,f.fieldName=r,w=ee);let Z=null,le={};const _e=Object(S.a)(J,$.id);let Oe=null;const Pe=Object(v.w)(te);if(_e&&_e.metadata&&_e.metadata[Pe]&&_e.metadata[Pe].attributes&&_e.metadata[Pe].attributes[r]&&(Oe=_e.metadata[Pe].attributes[r]),ve){let t=!0,i=!0;if(U.length>0){const e=Object(c.k)(J,pe,U);Object.keys(e).forEach(r=>{const n=e[r];t=t&&n.IsValidForUpdate,i=i&&n.IsValidForCreate})}const n=Object(c.a)(J,pe,be.Value),a=Object(m.h)(J);let p=null,v=null;if(be.Type===s.a.StatusOptionSet&&(p=Object(g.e)(J,V,fe,"statecode"),v=Object(g.e)(J,V,fe,be.Value)),be.Type===s.a.File&&(n.IsValidForUpdate=!0),n!==f.rawAttributes||f.pageAttributes!==Oe||q(p,Q)||q(v,K)||(be.Type===s.a.File||be.Type===s.a.Image||be.Type===s.a.StatusOptionSet)&&h){h=!0,f.rawAttributes=n;ye=function(e,t){if(!e)return null;return{DisplayName:e.DisplayName,LogicalName:e.LogicalName,Type:e.Type,IsSecured:e.IsSecured,RequiredLevel:e.RequiredLevel,MinValue:e.MinValue,MaxValue:e.MaxValue,ImeMode:e.ImeMode,MaxLength:e.MaxLength,EntityLogicalName:e.EntityLogicalName,Precision:e.Precision,Format:e.Format,FormatName:e.FormatName,Behavior:e.Behavior,Targets:e.Targets,Options:e.OptionSet,DefaultValue:e.DefaultValue,SourceType:e.SourceType,Description:e.Description,Timestamp:t}}(n,z&&z.timestamp?z.timestamp.getTime():null),ye=Object(b.d)(ye,oe,se,be.Type,a,n?n.SourceType:I.a.Unknown,J,pe,he),f.finalAttributes=function(e,t){if(null==e)return t;const i=t;null!=e.OptionSet&&(i.Options=e.OptionSet);null!=e.Precision&&(i.Precision=e.Precision);null!=e.RequiredLevel&&(i.RequiredLevel=e.RequiredLevel);null!=e.Targets&&(i.Targets=e.Targets);null!=e.Format&&(i.Format=e.Format);return i}(Oe,ye);const e=Object(u.e)(J,fe);if(Object(o.bd)(null===(ie=null==$?void 0:$.descriptor)||void 0===ie?void 0:ie.Id)&&
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t,i,r){var n,a,s;const o=null===(n=Object(d.a)(e,t))||void 0===n?void 0:n.businessProcessFlowEntities;if((null==o?void 0:o.length)>0&&r)for(const e of o)if(e.entityLogicalName===i&&(null===(s=null===(a=e.stage)||void 0===a?void 0:a.steps)||void 0===s?void 0:s.length)>0)for(const t of e.stage.steps)if(t.controlName===r&&t.required)return!0;return!1}(J,e,pe,$.descriptor.parentFieldSectionItem?$.descriptor.parentFieldSectionItem:$.descriptor.Id)&&(f.finalAttributes.RequiredLevel=1),be.Type===s.a.StatusOptionSet){const e=Object(o.Hb)(J,de);if(p||e&&Object(R.f)(J,k.h)){const t=Object(c.a)(J,pe,"statecode"),i=e?null:null===(ne=null===(re=t.OptionSet.find(e=>e.Value.toString()===p.valueString))||void 0===re?void 0:re.DefaultStatus)||void 0===ne?void 0:ne.toString(),r=Object(R.f)(J,A.Ih)?Object(g.e)(J,V,fe,"statuscode"):Object(u.j)(J,fe,"statuscode")||{label:"",valueString:i,timestamp:null,validationResult:null},a=Object(T.g)(r);let s;s=e?p?parseInt(p.valueString,10):0:parseInt(p.valueString,10);const o=v?parseInt(v.valueString,10):null;let l=Object(O.a)(J,n.EntityLogicalName,s,null!=a?a:o,e);null!=l&&Array.isArray(l)&&0===l.length&&(l=[o]);const d=ye.Options.filter((e,t,i)=>(C.a.info($.controlId+"."+B+": createGetFieldParameterData return statusOptionValues.indexOf(element.Value) >= 0"),l.indexOf(e.Value)>=0));Q=p,H=d,K=v,ye.Options=H}}f.pageAttributes=Oe,!n||n.SourceType!==I.a.Rollup&&n.SourceType!==I.a.Calculated||Object(b.a)(J,pe,he,f.finalAttributes,V)}else!n||n.SourceType!==I.a.Rollup&&n.SourceType!==I.a.Calculated||Object(b.a)(J,pe,he,f.finalAttributes,V)&&(h=!0);be.Type===s.a.DateAndTimeDateAndTime&&Object(l.j)(z)?Z=Object(b.c)(z,J,$,ee,r,te):be.Type===s.a.WholeLanguage&&Object(l.j)(z)?Z=Object(y.m)(z.value,a):be.Type===s.a.Currency&&Object(l.j)(z)?Z=z&&z.validationResult&&!z.validationResult.isValueValid?z.validationResult.userInput&&(null===(ae=z.validationResult.userInput)||void 0===ae?void 0:ae.toString()):Object(l.c)(z):be.Type===s.a.TwoOptions?(Z=Object(l.c)(z),Object(j.b)(Z)&&(Z=Object(l.e)(z))):Z=Object(l.c)(z),h=h||e[_]&&Z!==e[_].formatted;const S=Object(o.kd)(J,de),w=!!Object(P.f)(J,pe,be.Value,S?E.a.CanCreate:E.a.CanUpdate,he),D=!!Object(P.f)(J,pe,be.Value,E.a.CanRead,he);let F;F=be.Type===s.a.SingleLineAddress?!!n&&((S?i:t)&&w):!!n&&((S?n.IsValidForCreate:n.IsValidForUpdate)&&w);const N=!!n&&(D&&n.IsValidForRead);le={secured:!!n&&n.IsSecured,editable:F,readable:N},h=h||e[_]&&e[_].security&&(F!==e[_].security.editable||N!==e[_].security.readable)}const we=X(J,{controlName:G($),id:de},te);we!==Y&&(h=!0,Y=we);let Ce,Ie=!1,Ee=null;if(h||we){const t=function(e,t){var i;let r=!(!e||!e.validationResult)&&!e.validationResult.isValueValid,n=e&&e.validationResult?e.validationResult.errorMessage:null,a=null===(i=null==e?void 0:e.validationResult)||void 0===i?void 0:i.errorId;r||(r=!!(t&&t.error&&t.error.messages),n=r&&t.error.messages[0]||null,a=r&&t.error.uniqueId||void 0);return{error:r,errorMessage:n,errorCode:a}}(z,we);Ie=t.error,Ee=t.errorMessage,Ce=t.errorCode,!e[_]||e[_].error===Ie&&e[_].errorMessage===Ee||(h=!0)}if(be.Type===s.a.File||be.Type===s.a.Image){const i=Object(u.l)(J,fe,be.Value);if(i&&i.pageId===$.id)switch(i.fileProgress){case M.b.Failed:Ie=!0,Ee=String.format(Object(x.b)(J,L.h),t[_].finalAttributes.DisplayName);break;case M.b.Cancelled:Ie=!0,Ee=be.Type===s.a.File?String.format(Object(x.b)(J,L.g),t[_].finalAttributes.DisplayName):String.format(Object(x.b)(J,L.j),t[_].finalAttributes.DisplayName)}!e[_]||e[_].error===Ie&&e[_].errorMessage===Ee||(h=!0)}if(h){if(t[_]=f,3===be.Usage){const e=be;i[_]=e,ge={type:e.Type,raw:e.Value,formatted:e.Attributes&&be.Value?Object(y.y)(be.Value,Object(y.A)(J,e.Attributes)):null,error:Ie,errorMessage:Ee,errorCode:Ce,notifications:we,security:e.Security||{secured:!1,editable:!0,readable:!0},attributes:e.Attributes,isPropertyLoading:!1}}else ge={type:be.Type,raw:W(J,V,fe,be),formatted:Z,attributes:t[_].finalAttributes,error:Ie,errorMessage:Ee,errorCode:Ce,notifications:we,security:le,isPropertyLoading:D};me=!0}else if(!e[_]){if(!Se)return C.a.warn($.controlId+"."+B+": createGetFieldParameterData return null"),null;ge={type:be.Type,raw:null,formatted:null,attributes:ye,error:!1,errorMessage:null,notifications:null,security:le,isPropertyLoading:!1},me=!0}}return me&&(e[_]=ge),C.a.info($.controlId+"."+B+": createGetFieldParameterData finished"),e[_]}}function W(e,t,i,r){const n=Object(g.e)(e,t,i,r.Value);if(Object(l.j)(n)&&n.validationResult&&!n.validationResult.isValueValid)return n.validationResult.userInput;switch(r.Type){case s.a.OptionSet:return n&&n.valueString?parseInt(n.valueString,10):null;case s.a.TwoOptions:if(n){let e=n.value;const t=Object(j.c)(e);if(t&&(e=n.valueString),!Object(j.c)(e))return t&&"-1"===e?null:"boolean"==typeof e?e:"0"!==e.toString()}return null;case s.a.LookupSimple:case s.a.LookupCustomer:case s.a.LookupOwner:case s.a.LookupRegarding:case s.a.LookupMultiEntity:const a=n&&n.validationResult&&!n.validationResult.isValueValid?n.validationResult.userInput:Object(u.D)(e,t,i,r.Value);return Object(w.j)(a);case s.a.LookupPartyList:return n&&n.validationResult&&!n.validationResult.isValueValid?n.validationResult.userInput:Object(w.k)(Object(u.D)(e,t,i,r.Value));case s.a.SingleLineText:if(n&&Object(l.g)(n)&&n.id)return n.id.guid;default:return Object(u.D)(e,t,i,r.Value)}}function G(e){const t=e.parentDefinedControlProps&&e.parentDefinedControlProps.parentFieldSectionItem,i=e.descriptor&&e.descriptor.Name;return t||i}function q(e,t){return!(e===t||t&&e&&e.label===t.label&&e.valueString===t.valueString)}},t4Ha:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r=(e,t)=>{if(e.length===t.length){const i=[...e].sort(),r=[...t].sort();return i.every((e,t)=>e===r[Number(t)])}return!1}},"uPT+":function(e,t,i){"use strict";i.d(t,"a",(function(){return r})),i.d(t,"b",(function(){return n}));const r="powerbi.signedin.state";function n(e,t){return{type:r,payload:t,meta:{pageId:e}}}},w10E:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var r=i("X37l"),n=i("SAYH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class a{constructor(){this._recentItems=[],this._targetEntityTypeNames=[]}updateRecentItems(e,t,i){this._recentItems=e,t&&(this._targetEntityTypeNames=t),i&&(this._disableMru=i.isMruDisabled)}getRecentItems(e){if(this._disableMru)return[];let t=this._recentItems?this._recentItems.map(t=>!(t&&t.RecordType===r.a.Entity&&t.EntityTypeName&&this._targetEntityTypeNames&&-1!==this._targetEntityTypeNames.indexOf(t.EntityTypeName))||e&&e.entityTypeNames&&-1===e.entityTypeNames.indexOf(t.EntityTypeName)?null:{lastAccessed:t.LastAccessed,entityTypeName:t.EntityTypeName,pinStatus:t.PinStatus,objectId:n.a.toString(t.ObjectId),title:t.Title,iconPath:t.IconPath}):[];return t=t.filter(e=>null!==e),t}}},wZxB:function(e,t,i){"use strict";i.d(t,"a",(function(){return d})),i.d(t,"b",(function(){return p}));var r=i("4r2D"),n=i("SAYH"),a=i("iZ7K"),s=i("FZDd"),o=i("pEXn"),l=i("Nb1E"),c=i("fU7K");const u=o.b.AdvancedFindLookupResolverParameters;function d(e,t,i){const l=[];return{type:"advancedFind.lookup.retrieve.async",execute({dispatch:c,getState:d},p,g){const m=new r.a(n.a.newGuid().guid,g&&g.isPreloadCall);l.push({name:o.b.ActionType,value:"advancedFind.lookup.retrieve.async"},{name:o.b.ClientRequestId,value:m.RequestId()},{name:u.PrimaryEntity,value:e},{name:u.Targets,value:t.join(",")});const f=t.reduce((e,t)=>Object.assign(Object.assign({},e),{[t]:[]}),{});return c(Object(s.e)(f)).then(()=>{const e=function(e,t,i,r,n){return(s,o)=>{const l=Object(a.h)(i,o);if(!l||!l.EntityLogicalName||!l.PrimaryNameAttribute)return r.push({name:u.EntityMetadataUnavailable,value:o}),s;let c=`<fetch version="1.0" mapping="logical" no-lock="false"><entity name="${l.EntityLogicalName}"><attribute name="${l.PrimaryNameAttribute}"/><attribute name="${l.PrimaryIdAttribute}"/><order attribute="${l.PrimaryNameAttribute}" descending="false" />`;c+=n&&"systemuser"===o?`<filter type="and"><condition attribute="accessmode" operator="ne" value="4" /></filter><filter type="or"><condition attribute="${l.PrimaryNameAttribute}" operator="like" value="%${t||""}%" /></filter>`:n&&"team"===o?`<filter type="and"><condition attribute="teamtype" operator="ne" value="1" /></filter><filter type="or"><condition attribute="${l.PrimaryNameAttribute}" operator="like" value="%${t||""}%" /></filter>`:`<filter type="or"><condition attribute="${l.PrimaryNameAttribute}" operator="like" value="%${t||""}%" /></filter>`,c+="</entity></fetch>";const d=h(e,l,c,r);return s.push(d),s}}(c,i,d(),l,t.length>1),r=t.reduce(e,[]);return Promise.all(r).then(e=>[].concat(...e))})},getSuccessParameters:()=>l,getFailureParameters:(e,t)=>l}}function p(e,t,i){const l=[];return{type:"advancedFind.lookup.retrieve.by.id.async",execute({dispatch:c,getState:d},p,g){const m=new r.a(n.a.newGuid().guid,g&&g.isPreloadCall);l.push({name:o.b.ActionType,value:"advancedFind.lookup.retrieve.async"},{name:o.b.ClientRequestId,value:m.RequestId()},{name:u.PrimaryEntity,value:e},{name:u.Targets,value:t.join(",")});const f=t.reduce((e,t)=>Object.assign(Object.assign({},e),{[t]:[]}),{});return c(Object(s.e)(f)).then(()=>{const e=function(e,t,i,r){return(n,s)=>{const o=Object(a.h)(i,s);if(!o||!o.EntityLogicalName||!o.PrimaryNameAttribute)return r.push({name:u.EntityMetadataUnavailable,value:s}),n;const l=t.filter(e=>!!e).map(e=>`<condition attribute="${o.PrimaryIdAttribute}" operator="eq" value="${e}" />`),c=`<fetch version="1.0" mapping="logical" no-lock="false"><entity name="${o.EntityLogicalName}"><attribute name="${o.PrimaryNameAttribute}"/><attribute name="${o.PrimaryIdAttribute}"/><order attribute="${o.PrimaryNameAttribute}" descending="false" /><filter type="or">${l}</filter></entity></fetch>`,d=h(e,o,c,r);return n.push(d),n}}(c,i,d(),l),r=t.reduce(e,[]);return Promise.all(r).then(e=>[].concat(...e))})},getSuccessParameters:()=>l,getFailureParameters:(e,t)=>l}}function h(e,t,i,r){const n="?fetchXml="+Object(c.CrmUrlEncode)(i);return new Promise((i,a)=>{e(Object(l.e)(t.EntityLogicalName,n,100)).then(e=>{const n=function(e,t){const i=[];t.value&&t.value.length>0&&t.value.forEach(t=>{i.push({id:t[e.PrimaryIdAttribute],displayName:t[e.PrimaryNameAttribute],entityLogicalName:(null==e?void 0:e.EntityLogicalName)||void 0,entityDisplayName:(null==e?void 0:e.DisplayName)||void 0})});return i}(t,e);r.push({name:u.RetrieveRequestSuccess,value:`Retrieve Seccuess for ${t.EntityLogicalName} Count: ${n.length}`}),i(n)},e=>{r.push({name:u.RetrieveRequestFail,value:`Failed to retrieve records for ${t.EntityLogicalName} Error: ${e}`}),i([])})})}},waMg:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var r=i("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const n="grid.updatequerykey";function a(e,t,i){const a=Object(r.z)(i),s=Object(r.w)(i);return{type:n,payload:e,meta:{pageId:t,contextKey:a,dataSetContextKey:s}}}},xymJ:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var r=i("NjDY");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function n(e,t){return{type:"customcontrol.loadresources.async",execute:({dispatch:i,getState:n},a)=>function(e,t,i,n){const a=Object(r.x)(t);return i.initializeContainerForClientApi(n).then(t=>t.loadWebResources([Object(r.a)(a,e)]).then(()=>({container:t,webResourcePath:a})))}(e,n(),a.ScriptManager,t)}}},yTPE:function(e,t,i){"use strict";i.d(t,"a",(function(){return b}));var r=i("r0As"),n=i("kSDG"),a=i("nfCs"),s=i("iZ7K"),o=i("fKWG");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class l{constructor(e,t){this._attribute=e,this._extendedGroupBys=new Array,this._chartDefinition=t,this._addExtendedGroupBys(),this._initializeOrderType()}get groupAttribute(){return this._attribute}get extendedGroupBys(){return this._extendedGroupBys}get descending(){return this._descending}get hasOrder(){return this._hasOrder}_initializeOrderType(){const e=this._attribute.entity.orderByAttributes;for(let t=0;t<e.length;t++){const i=e[t];if(i.aliasName===this._attribute.aliasName)return this._hasOrder=!0,void(this._descending=i.descending)}}_addExtendedGroupBys(){this._addPrimaryFieldGroupByforPrimaryKey(),this._addDateGroupBys()}_addDateGroupBys(){if(!this._attribute.dateTimeGrouping)return;let e=-1;const t=this._attribute.entity.orderByAttributes;for(let i=0;i<t.length;i++){const r=t[i];if(r.aliasName===this._attribute.aliasName){e=i,this._hasOrder=!0,this._descending=r.descending;break}}switch(-1===e&&(Object(r.h)(this._attribute.entity,this._attribute,!0,!1,t.length),e=t.length-1,this._hasOrder=!0,this._descending=!1),this._attribute.dateTimeGrouping.groupingType){case o.a.FISCAL_YEAR:case o.a.FISCAL_PERIOD:case o.a.YEAR:return;case o.a.WEEK:case o.a.MONTH:case o.a.QUARTER:this._addGroupingAndOrder(o.a.YEAR,this.descending,e);break;case o.a.DAY:this._addGroupingAndOrder(o.a.MONTH,this.descending,e),this._addGroupingAndOrder(o.a.YEAR,this.descending,e)}}_addPrimaryFieldGroupByforPrimaryKey(){const e=this._attribute.entity,t=Object(s.h)(e.getState(),e.entityName).PrimaryIdAttribute;if(!t||this._attribute.attributeName!==t)return;const i=Object(s.h)(e.getState(),e.entityName).PrimaryNameAttribute,a=e.entityName+"_"+i+"_extendedGroupByAttribute",o=Object(n.a)(i,a,e);if(this._attribute.hasGroupBy){for(let t=0;t<e.groupByAttributes.length;t++){const r=e.groupByAttributes[t];if(r.attributeName===i)return void this._extendedGroupBys.push(r)}o.hasGroupBy=!0,Object(r.g)(e,o.attributeName,o.aliasName,"true",null,null,null),e.groupByAttributes.push(o)}else Object(r.g)(e,o.attributeName,o.aliasName);e.attributes.push(o),e.attributesByName.set(o.aliasName,o),this._chartDefinition.allAttributeNamesByEntity.has(e.entityName)&&this._chartDefinition.allAttributeNamesByEntity.get(e.entityName).set(o.attributeName,o),this._extendedGroupBys.push(o)}_addGroupingAndOrder(e,t,i){const s=this._attribute.entity,l=this._attribute&&this._attribute.aliasName?this._attribute.aliasName+"_"+o.a[e]:Object(n.b)(s.entityName,this._attribute.attributeName),c=Object(n.a)(this._attribute.attributeName,l,s,a.a(e));c.hasGroupBy=!0,s.groupByAttributes.push(c),s.attributes.push(c),s.attributesByName.set(c.aliasName,c),Object(r.h)(s,c,!0,t,i),Object(r.g)(s,c.attributeName,c.aliasName,"true",null,a.c(e),"true"),this._extendedGroupBys.push(c)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function c(e,t,i,a){const o=e.getAttribute("alias"),c=t.allMeasureInfo.get(o),u={measureAttribute:c.attributeExpression,parentMeasureCollection:i,parentCategory:a};return function(e,t,i){if(!e.parentCategory.primaryGroupBy)if(!t.groupByList||t.groupByList.length<=0)e.parentCategory.primaryGroupBy=function(e,t){if(e.hasAggregate)return null;const i=Object(n.a)(Object(s.h)(e.getState(),e.entityName).PrimaryIdAttribute,null,e);return Object(r.g)(e,i.attributeName,null),e.attributes.push(i),e.attributesByName.set(i.attributeName,i),t.allAttributeNamesByEntity.has(e.entityName)&&t.allAttributeNamesByEntity.get(e.entityName).set(i.attributeName,i),new l(i,t)}(t.attributeExpression.entity,i);else if(e.parentCategory.primaryGroupByAlias)for(let r=0;r<t.groupByList.length;r++){const n=t.groupByList[r];if(n.aliasName===e.parentCategory.primaryGroupByAlias){e.parentCategory.primaryGroupBy=new l(n,i);break}}else e.parentCategory.primaryGroupBy=new l(t.groupByList[0],i);if(!e.parentMeasureCollection.secondaryGroupBys&&(e.parentMeasureCollection.secondaryGroupBys=new Array,t.groupByList&&t.groupByList.length>1))for(let r=0;r<t.groupByList.length;r++){const n=t.groupByList[r];n!==e.parentCategory.primaryGroupBy.groupAttribute&&e.parentMeasureCollection.secondaryGroupBys.push(new l(n,i))}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(u,c,t),u}function u(e,t,i){const r={measures:new Array,chartDataDefinition:t,secondaryGroupBys:null};return r.measures.push(c(e.getElementsByTagName("measure")[0],r.chartDataDefinition,r,i)),r}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class d{constructor(e,t){this._attributeExpression=e,this._groupByList=t}get groupByList(){return this._groupByList}get attributeExpression(){return this._attributeExpression}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class p{constructor(e){this._getState=e,this._allAttributeNamesByEntity=new Map,this._groupByList=new Array,this._allMeasureInfo=new Map,this._allAttributes=new Map}get category(){return this._category}get isComparisonChart(){return this._isComparisonChart}get entityExpression(){return this._entityExpression}get groupByList(){return this._groupByList}get allMeasureInfo(){return this._allMeasureInfo}get allAttributeNamesByEntity(){return this._allAttributeNamesByEntity}get categoryColumns(){const e=new Array;if(this._category.primaryGroupBy){this._category.primaryGroupBy.groupAttribute.attributeName!==Object(s.h)(this._getState(),this.category.primaryGroupBy.groupAttribute.entity.entityName).PrimaryIdAttribute&&e.push(this._category.primaryGroupBy.groupAttribute);for(let t=0;t<this._category.primaryGroupBy.extendedGroupBys.length;t++)e.push(this._category.primaryGroupBy.extendedGroupBys[t])}else for(let t=0;t<this._entityExpression.attributes.length;t++){const i=this._entityExpression.attributes[t],r=i.aliasName?i.aliasName:i.attributeName;this._allMeasureInfo.has(r)||e.push(i)}return e}isOrderPresent(){if(this._entityExpression.orderByAttributes.length>0)return!0;const e=this._entityExpression.linkedEntities;for(let t=0;t<e.length;t++)if(e[t].orderByAttributes.length>0)return!0;return!1}isOrderPresentOnPrimaryGroupBy(){return!!(this._category&&this._category.primaryGroupBy&&this._category.primaryGroupBy.hasOrder)}isGroupByFromNestedLinkEntity(){const e=this._entityExpression.linkedEntities;for(const t of e)return this._isGroupByFromChildLinkEntity(t);return!1}_isGroupByFromChildLinkEntity(e){var t;for(const i of e.linkedEntities)return(null===(t=null==i?void 0:i.groupByAttributes)||void 0===t?void 0:t.length)>0||this._isGroupByFromChildLinkEntity(i);return!1}parserDataDefinition(e){const t=new DOMParser;this._dataXmlDoc=t.parseFromString(e,"text/xml"),function(e){const t=e.getElementsByTagName("parsererror");if(t&&t.length>0)throw new Error("Unreadable Chart Definition")}(this._dataXmlDoc),this._entityExpression=Object(r.b)(null,null,null,this._getState);const i=this._dataXmlDoc.getElementsByTagName("datadefinition")[0].getElementsByTagName("fetchcollection")[0].getElementsByTagName("fetch")[0];Object(r.e)(this._entityExpression,i),this._buildMeasureInformationFromFetch(this._entityExpression)}addGroupBys(e){this._groupByList.push(e),this._removeAliasFromCategoryNode()}_removeAliasFromCategoryNode(){const e=this._dataXmlDoc.getElementsByTagName("datadefinition")[0].getElementsByTagName("categorycollection")[0].getElementsByTagName("category")[0];e&&e.removeAttribute("alias")}buildCategory(){this._buildChartMeasures(),this._isComparisonChart=this._category.measureCollections[0].secondaryGroupBys.length>0}_buildChartMeasures(){const e=this._dataXmlDoc.getElementsByTagName("datadefinition")[0].getElementsByTagName("categorycollection")[0].getElementsByTagName("category")[0];if(!e)throw new Error("data xml missing category node!");this._category=function(e,t){const i={chartDataDefinition:t,measureCollections:new Array,primaryGroupByAlias:e.getAttribute("alias"),primaryGroupBy:null},r=e.getElementsByTagName("measurecollection");for(let e=0;e<r.length;e++)i.measureCollections.push(u(r[e],i.chartDataDefinition,i));return i}(e,this)}_buildMeasureInformationFromFetch(e){const t=e.entityName;let i;this._allAttributeNamesByEntity.has(t)?i=this._allAttributeNamesByEntity.get(t):(i=new Map,this._allAttributeNamesByEntity.set(t,i));const r=e.attributes;for(let e=0;e<r.length;e++){const t=r[e];i.set(t.attributeName,t);const n=(t.aliasName,t.aliasName);this._allAttributes.set(n,t),t.hasGroupBy?this._groupByList.push(t):this._allMeasureInfo.set(h(t),new d(t,this._groupByList))}for(let t=0;t<e.linkedEntities.length;t++)this._buildMeasureInformationFromFetch(e.linkedEntities[t])}}function h(e){return e.aliasName?e.aliasName:e.attributeName}var g=i("SAYH"),m=i("BzGi"),f=i("d0w6");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class b{constructor(e,t,i,r,n){this._initialized=!1,this._isWebResourceChart=!1,this._isRollUpView=!1,this.getState=e,this._visualizationId=t,this._viewId=i,this._visualizationType=r||m.a.savedvisualization,this._viewType=n||f.b.savedview}get dataDefinition(){return this._dataDefinition}get fetchXml(){return Object(r.d)(this._dataDefinition.entityExpression)}get viewDefinition(){return this._viewDefinition}get viewXml(){return this._viewDefinition?Object(r.d)(this._viewDefinition):null}get viewId(){return this._viewId}get visualizationId(){return this._visualizationId}get viewType(){return this._viewType}get visualizationType(){return this._visualizationType}get isWebResourceChart(){return this._isWebResourceChart}get presentationXml(){return this._presentationXml}get viewTitle(){return this._viewTitle}get viewEntityLogicalName(){return this._viewEntityLogicalName}get chartName(){return this._chartName}get chartPrimaryEntityTypeCode(){return this._chartPrimaryEntityTypeCode}get initialized(){return this._initialized}get isRollUpView(){return this._isRollUpView}initialize(e,t,i,n,a,s,o,l=!1,c=!1){e&&(this._dataDefinition=new p(this.getState),this._dataDefinition.parserDataDefinition(e)),t&&(this._viewDefinition=Object(r.b)(null,null,null,this.getState),Object(r.f)(this._viewDefinition,t)),this._presentationXml=i,this._isWebResourceChart=l,this._viewTitle=n,this._viewEntityLogicalName=a,this._chartName=s,this._chartPrimaryEntityTypeCode=o,this._isRollUpView=c,(l||e&&t)&&(this._initialized=!0)}getStorageKey(){let e="",t="",i="";this.initialized&&!this.isWebResourceChart&&(e=this.viewDefinition.linkedEntities.map(e=>Object(r.d)(e)).join(""),t=this.dataDefinition.entityExpression.linkedEntities.map(e=>Object(r.d)(e)).join(""),i=this.viewDefinition.filters.join(""));return`${this.viewEntityLogicalName||""}:${g.a.toString(this.viewId)}:${i}:${e}:${g.a.toString(this.visualizationId)}:${t}`}}},yzZr:function(e,t,i){"use strict";i.d(t,"mb",(function(){return r})),i.d(t,"kb",(function(){return n})),i.d(t,"n",(function(){return a})),i.d(t,"o",(function(){return s})),i.d(t,"b",(function(){return o})),i.d(t,"p",(function(){return l})),i.d(t,"q",(function(){return c})),i.d(t,"gb",(function(){return u})),i.d(t,"lb",(function(){return d})),i.d(t,"i",(function(){return p})),i.d(t,"c",(function(){return h})),i.d(t,"h",(function(){return g})),i.d(t,"f",(function(){return m})),i.d(t,"a",(function(){return f})),i.d(t,"e",(function(){return b})),i.d(t,"d",(function(){return y})),i.d(t,"m",(function(){return v})),i.d(t,"j",(function(){return S})),i.d(t,"k",(function(){return _})),i.d(t,"l",(function(){return O})),i.d(t,"g",(function(){return P})),i.d(t,"jb",(function(){return w})),i.d(t,"hb",(function(){return C})),i.d(t,"ib",(function(){return I})),i.d(t,"V",(function(){return E})),i.d(t,"eb",(function(){return j})),i.d(t,"x",(function(){return D})),i.d(t,"w",(function(){return T})),i.d(t,"W",(function(){return F})),i.d(t,"J",(function(){return N})),i.d(t,"K",(function(){return R})),i.d(t,"ab",(function(){return k})),i.d(t,"Y",(function(){return A})),i.d(t,"Q",(function(){return M})),i.d(t,"fb",(function(){return x})),i.d(t,"cb",(function(){return L})),i.d(t,"bb",(function(){return V})),i.d(t,"X",(function(){return B})),i.d(t,"S",(function(){return z})),i.d(t,"R",(function(){return U})),i.d(t,"T",(function(){return W})),i.d(t,"U",(function(){return G})),i.d(t,"L",(function(){return q})),i.d(t,"P",(function(){return H})),i.d(t,"O",(function(){return Q})),i.d(t,"Z",(function(){return K})),i.d(t,"v",(function(){return X})),i.d(t,"y",(function(){return Y})),i.d(t,"A",(function(){return J})),i.d(t,"E",(function(){return $})),i.d(t,"C",(function(){return Z})),i.d(t,"D",(function(){return ee})),i.d(t,"B",(function(){return te})),i.d(t,"F",(function(){return ie})),i.d(t,"z",(function(){return re})),i.d(t,"H",(function(){return ne})),i.d(t,"I",(function(){return ae})),i.d(t,"G",(function(){return se})),i.d(t,"u",(function(){return oe})),i.d(t,"s",(function(){return le})),i.d(t,"t",(function(){return ce})),i.d(t,"r",(function(){return ue})),i.d(t,"N",(function(){return de})),i.d(t,"M",(function(){return pe})),i.d(t,"db",(function(){return he})),i.d(t,"nb",(function(){return ge}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="Search_Page_Title",n="Search_SearchWith_Label",a="Search_FilterWith_Label_No_Colon",s="Search_FilterOption_None",o="Web.Tools.personalsettings.dialogs.personalsettings.aspx_213",l="Search.LegacySearch",c="Search.ModernSearch",u="Web.Tools.personalsettings.dialogs.personalsettings.aspx_212",d="Search_Noresults_Message",p="Search_TextInput_Placeholder",h="Search.Accessibility.Multiple_CategorizedSearchResult",g="Search.Accessibility.Single_CategorizedSearchResult",m="Search.Accessibility.ResultLoading",f="Search_FilterWith_Label_No_Colon",b="Grid_ToolTip_PreviousPage",y="Grid_ToolTip_NextPage",v="Facet_RecordType",S="Facet_CreatedOn",_="Facet_ModifiedOn",O="Facet_Owner",P="ReportViewer_PageOf",w="Search.Accessibility.Search_box",C="Search.Accessibility.Scan_Barcode",I="Search.Accessibility.Barcode_Scanned",E="RelevanceSearch.SearchResults",j="RelevanceSearch.TopResults",D="RelevanceSearch.ErrorTitle",T="RelevanceSearch.ErrorSubtitle",F="RelevanceSearch.Retry",N="RelevanceSearch.Feedback",R="RelevanceSearch.Feedback.Provided",k="RelevanceSearch.ShowMore",A="RelevanceSearch.ShowLess",M="RelevanceSearch.NoResultForQueryInApp",x="RelevanceSearch.TryDifferentKeyword",L="RelevanceSearch.StartTypingToSearchInApp",V="RelevanceSearch.StartTypingToFindYourInformationInApp",B="RelevanceSearch.SearchHasMoved",z="RelevanceSearch.NumberOfResultsBasedOnFields",U="RelevanceSearch.NumberOfOtherFields",W="RelevanceSearch.NumberOfResultsForQueryInApp",G="RelevanceSearch.NumberOfResultsForAdvancedQueryInApp",q="RelevanceSearch.Filters",H="RelevanceSearch.ItemType",Q="RelevanceSearch.ItemTitle",K="RelevanceSearch.ShowMatchedText",X="RelevanceSearch.ClearAll",Y="RelevanceSearch.Facet.Clear",J="RelevanceSearch.Facet.DateRange.Oldest",$="RelevanceSearch.Facet.DateRange.OneYearAgo",Z="RelevanceSearch.Facet.DateRange.OneMonthAgo",ee="RelevanceSearch.Facet.DateRange.OneWeekAgo",te="RelevanceSearch.Facet.DateRange.OneDayAgo",ie="RelevanceSearch.Facet.DateRange.Today",re="RelevanceSearch.Facet.DateRange.Latest",ne="RelevanceSearch.Facet.Range.From",ae="RelevanceSearch.Facet.Range.To",se="RelevanceSearch.Facet.Owner.Me",oe="Button_Label_Yes",le="Button_Label_No",ce="PickList_RoundingPolicy_Value_1",ue="PickList_RoundingPolicy_Value_2",de="RelevanceSearch.Open",pe="RelevanceSearch.Close",he="RelevanceSearch.TeachingBubble.Close",ge=[r,o,l,c,u,n,a,s,"Ribbon.AdvancedFind.Show.Results",d,p,h,g,m,f,v,S,_,O,P,w,C,I,b,y,E,j,"RelevanceSearch.ShowNumberOfResults",k,A,M,x,V,L,D,T,F,N,R,"RelevanceSearch.EntityNumberOfResults","RelevanceSearch.EntityNumberOfSingleResult",z,U,W,G,q,H,Q,K,X,Y,J,$,Z,ee,te,ie,re,se,ne,ae,oe,le,ce,ue,de,pe,B,he]},zFtG:function(e,t,i){"use strict";i.d(t,"a",(function(){return a})),i.d(t,"b",(function(){return s}));var r=i("dHD5"),n=i("BFlg");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const a="dataset.update.pagingdata";function s(e,t,i){return{type:"dataset.update.pagingdata.async",execute({dispatch:s,getState:o},l){const c=l.TraceManager.getTracer(n.P),u=n.N+".updatePagingDataAction";try{return c.info("Updating the paging data for the grid."),s(function(e,t,i){const n=Object(r.z)(t),s=Object(r.w)(t);return{type:a,payload:i,meta:{pageId:e,contextKey:n,dataSetContextKey:s}}}(e,t,i)),l.EventManager.ReportComponentSuccess(u),Promise.resolve()}catch(e){const t="Updation of paging data for the grid failed with error : "+e.message;l.EventManager.ReportComponentFailure(u,Error(t))}}}}},ztod:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var r=i("BFlg"),n=i("3/02"),a=i("Lyxw"),s=i("arV0"),o=i("Tz6o");function l(e,t){return{type:"update.grid.pagination.state.async",execute({dispatch:i,getState:l},c){const u=l();if(!Object(a.e)(u,n.Yc))return null;const d=r.N+".updateGridPaginationStateAction";try{const r=Object(s.j)(u,t),n=Object.assign({},r);return function(e,t){e.forEach(e=>{switch(e.filterType){case 0:t.quickFindExpression=null,t.jumpBarFilterExpression=null;case 1:case 2:case 3:t.customFilteringString=null,t.nativeFilterExpression=null,t.gridSortingInfo=null;case 4:case 6:case 5:case 7:case 8:case 11:case 9:case 10:t.gridPageNumber=1}})}(e,n),e.forEach(e=>{switch(e.filterType){case 1:n.quickFindExpression=e.filterExpressionOrValue;break;case 2:n.quickFindEntityIfActivity=e.filterExpressionOrValue;break;case 4:n.jumpBarFilterExpression=e.filterExpressionOrValue;break;case 5:n.nativeFilterExpression=e.filterExpressionOrValue;break;case 6:n.customFilteringString=e.filterExpressionOrValue;break;case 7:n.gridSortingInfo=e.filterExpressionOrValue;break;case 8:n.entityFilterExpression=e.filterExpressionOrValue;break;case 11:n.entityFilterValue=e.filterExpressionOrValue;break;case 9:n.activityTypeFilterExpression=e.filterExpressionOrValue;break;case 10:n.activityTypeFilterValue=e.filterExpressionOrValue;break;case 12:n.gridPageNumber=e.filterExpressionOrValue}}),i(Object(o.d)(n,t)),c.EventManager.ReportComponentSuccess(d),Promise.resolve()}catch(e){const t="Failed with error "+e.message;c.EventManager.ReportComponentFailure(d,Error(t))}}}}}}]),window.bundleExecutionMarkers["scripts/15.js?v=1.4.3886-master"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();