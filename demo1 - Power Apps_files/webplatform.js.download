(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/webplatform.js?v=1.4.3886-master"]={begin:performance.now()},(window.__wpJsonpUci=window.__wpJsonpUci||[]).push([[173],{"4QP1":function(e,t,r){"use strict";r.r(t),r.d(t,"WebPlatform",(function(){return M}));var n=r("Qois");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a={};class i{executeServiceOperation(e,t,r){return new Promise((t,r)=>{const a=e.getServiceName(),i=e.getOperationName();r({errorCode:n.a.ServiceAndOperationNotSupported,param:a+"."+i})})}static getAvailableServiceOperations(e){return null}}var o=r("uLW4"),s=r("eVe1"),c=r("uM6Y"),l=r("VkXQ"),u=r("r6hG"),d=r("IqkD"),p=r("pgSX"),h=r("gQ5I"),m=r("si7p"),w=r("YxC/"),g=r("tICD"),f=r("JRzo"),v=r("ErQw"),b=r("uufl"),O=r("OpjU"),_=r("jZCH"),S=r("Uv1Y");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class k{executeServiceOperation(e,t,r){const a=e.getOperationName();switch(a){case l.k.signOut.name:return this._signOut(t,r);case l.k.handleAuthError.name:return this._handleAuthError(t,r)}return new Promise((e,t)=>{t({errorCode:n.a.ServiceAndOperationNotSupported,param:"UserAccount."+a})})}_signOut(e,t){return new Promise((r,n)=>{const a=[];a.push(_.a.get_DefaultInstance().clearAllData()),a.push(_.a.get_DefaultInstance().updateSecureContext()),Promise.all(a).then(()=>{e.Dispose();const n=window.location.origin,a=Object(d.x)(t.getState());window.location.href=new URL(a.isLive?`/main.aspx?signout=1&redirect=${n}/main.aspx`:"/main.aspx?signout=1",n).href,r()},t=>{e.TraceManager.getTracer("SignOut").error("Signout failed, errorDetail: "+t.toString()),n({errorCode:-2147093993})})})}_handleAuthError(e,t){const r=e.TraceManager.getTracer("HandleAuthError");return new Promise((e,n)=>{Object(b.a)(t.getState())?(r.warn("Not showing autherror dialog. A reauth dialog is already showing"),t.subscribe(b.a,t=>{!t&&e()})):(t.dispatch(Object(O.b)(!0)),this._showAuthDialog(t,r).then(()=>{t.dispatch(Object(O.b)(!1)),e()}).catch(e=>{t.dispatch(Object(O.b)(!1)),n(e)}))})}async _showAuthDialog(e,t){var r;const n=Object(w.e)(e.getState(),f.q),a=n[f.d],i=n[f.a],o=n[f.o],s=n[f.i],c=await e.dispatch(Object(p.a)(m.b,"",v.b,o,a,i,s));if(0!==c.status){const e=[{name:"navigation_error_parameters",value:c.error&&c.error.errorParameters},{name:"navigation_error_message",value:c.error&&c.error.displayMessage}];throw t.warn("Failed to open signin dialog",e),new S.a("Failed to signin: Failed to open modal dialog")}{const n=window.RegisterAuthExpiryReminder;this._registerAuthCompleteHandlerToCloseDialog(c.pageId,e,n);const a=await e.dispatch(Object(g.a)(c.pageId));if(!(null===(r=null==a?void 0:a.value)||void 0===r?void 0:r.confirmed)){const e=[{name:"output_value",value:null==a?void 0:a.value}],r="User closed signin prompt without signing in";throw t.warn(r,e),new S.a(r,2415919124)}}}_registerAuthCompleteHandlerToCloseDialog(e,t,r){window.RegisterAuthExpiryReminder=(...n)=>{window.RegisterAuthExpiryReminder=r,null!==e&&t.dispatch(Object(h.e)(e)),r&&r.apply(null,n)}}static getAvailableServiceOperations(e){const t=Object(d.x)(e);if(t&&(t.isLive||!t.usePathBasedUrls))return Object(u.a)(c.k,{signOut:l.k.signOut,handleAuthError:l.k.handleAuthError})}}var A=r("9gmQ"),y=r("K9oF");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const T="tokenRequestMessage",E="tokenAckMessage",P="tokenResponseMessage";class x{executeServiceOperation(e,t,r){const a=e.getOperationName();switch(a){case l.k.signOut.name:return this._signOut(t,r);case l.k.handleAuthError.name:return this._handleAuthError(t,r);case l.k.authenticate.name:return this._authenticate(t,r)}return new Promise((e,t)=>{t({errorCode:n.a.ServiceAndOperationNotSupported,param:"UserAccount."+a})})}async _signOut(e,t){e.TraceManager.getTracer("SignOut").warn("WebEmbeddedUserAccountPlatformServiceProvider: Unexpected sign out encountered"),await t.dispatch(Object(y.e)("")),await _.a.get_DefaultInstance().clearAllData(),await _.a.get_DefaultInstance().updateSecureContext()}async _handleAuthError(e,t){e.TraceManager.getTracer("HandleAuthError").warn("Embedded auth token failed. Attempting retrieving new token."),await this._retrieveAuthToken(e,t)}static getAvailableServiceOperations(e){const t=Object(d.x)(e);if(t&&(t.isLive||!t.usePathBasedUrls)){const e={signOut:l.k.signOut,handleAuthError:l.k.handleAuthError,authenticate:l.k.authenticate};return Object(u.a)(c.k,e)}}async _authenticate(e,t){await this._retrieveAuthToken(e,t)}_retrieveAuthToken(e,t){if(!window.parent||window.parent===window){return e.TraceManager.getTracer("AuthTokenExchange").error("No parent window found."),Promise.reject()}return window.parent.postMessage({message:T},"*"),new Promise((r,n)=>{const a=async i=>{var o;if((null===(o=i.data)||void 0===o?void 0:o.message)===P){window.removeEventListener("message",a);try{await this._handleTokenResponse(i.data,i.origin,t,e),r(!0)}catch(e){n()}}};window.addEventListener("message",a)})}async _handleTokenResponse(e,t,r,n){const{token:a,expiration:i}=e.payload;if(!a){const e="Invalid token";throw this._handleTokenFailure(t,e,n),e}if(!i||isNaN(i)){const e="Invalid expiration";throw this._handleTokenFailure(t,e,n),e}if(i-Date.now()<=0){const e="Token expired";throw this._handleTokenFailure(t,e,n),e}await this._handleTokenSuccess(a,i,t,r,n)}async _handleTokenSuccess(e,t,r,n,a){await n.dispatch(Object(y.e)(e)),this._tokenExpiryTimer&&window.clearTimeout(this._tokenExpiryTimer);const i=t-Date.now();this._tokenExpiryTimer=window.setTimeout(()=>{this._retrieveAuthToken(a,n),this._tokenExpiryTimer=null},i),window.parent&&window.parent.postMessage({message:E,payload:{success:!0}},r);a.TraceManager.getTracer("AuthTokenExchange").info("Token exchange success")}_handleTokenFailure(e,t,r){r.TraceManager.getTracer("AuthTokenExchange").error("Token exchange failed, errorDetail: "+t),window.parent&&window.parent.postMessage({message:E,payload:{success:!1,error:t}},e)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function F(){return window.parent!==window}var C=r("SX+A"),I=r("sclX");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class M{executeServiceOperation(e,t,r){return function(e,t){switch(e.getServiceName()){case c.f:return new o.a;case c.i:return new s.a;case c.k:return F()&&t.getState().configuration.isPreviewMode?new x:new k;default:return new i}}(e,r).executeServiceOperation(e,t,r)}getPlatformReadyStatus(e,t){return function(e,t){const r=[],n=t.getState();for(const e in a)r.push(i.getAvailableServiceOperations(e));r.push(s.a.getAvailableServiceOperations(n)),r.push(o.a.getAvailableServiceOperations()),F()&&t.getState().configuration.isPreviewMode?r.push(x.getAvailableServiceOperations(n)):r.push(k.getAvailableServiceOperations(n));const c={};for(let e=0;e<r.length;e++){const t=r[e];t&&(c[t.name]=t)}t.dispatch(Object(A.b)(c))}(0,t),t.dispatch(Object(C.d)(I.b.Web)),Promise.resolve()}}},"5RA1":function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const n=.75},eVe1:function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var n=r("UwOy"),a=r("uM6Y"),i=r("VkXQ"),o=r("r6hG"),s=r("Qois"),c=r("H4dV"),l=r("Knfm"),u=r("GEbX");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class d{executeServiceOperation(e,t,r){const n=e.getOperationName();switch(n){case i.i.navigateBackOutOfApp.name:return this._goToPreviousPage(t,r.getState());case i.i.openUri.name:return this._openUri(e);case i.i.canOpenUri.name:return Promise.resolve(!0)}return new Promise((e,t)=>{t({errorCode:s.a.ServiceAndOperationNotSupported,param:"FileManager."+n})})}_goToPreviousPage(e,t){return Object(n.h)(t)||Object(l.a)(t)===u.a.MultiSession?e.Router.redirectToDefault():(window.history.back(),Promise.resolve({status:0,pageId:null}))}_openUri(e){return new Promise((t,r)=>{const n=e.getParameters()[0],a=e.getParameters()[1];let i="";if(p.some(e=>n.startsWith(e)))return window.location.href=n,void t();a&&a.openInNewWindow&&(i=a.width?i+"width="+a.width+",":"",i=a.height?i+"height="+a.height+",":"",i+="resizable=1"),window.open(n,"_blank",i),t()})}static getAvailableServiceOperations(e){const t=Object.assign({},i.i);return delete t.switchApp,(Object(n.h)(e)||Object(l.a)(e)===u.a.MultiSession)&&delete t.navigateBackOutOfApp,Object(o.a)(a.i,t)}}const p=function(){const e=["mailto:","tel:"];if(!c.a.getInstance().get_IsMacSafari())return e.concat(["ms-word:","ms-excel:","ms-powerpoint:","onenote:","skype:"]);return e}()},r6hG:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function n(e,t){return{name:e,operations:t}}r.d(t,"a",(function(){return n}))},uLW4:function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var n=r("NjDY"),a=r("H4dV");var i=r("5RA1"),o=r("uM6Y"),s=r("VkXQ"),c=r("r6hG"),l=r("Qois"),u=r("zsAz");class d{executeServiceOperation(e,t,r){const n=e.getOperationName();switch(n){case s.f.openFile.name:return this._openFile(e,t);case s.f.pickFile.name:let n;if(e.getParameters()&&e.getParameters()[0]&&(n=e.getParameters()[0]),null==n?void 0:n.useBinaryReader){return t.TraceManager.getTracer().error("pickFile with useBinaryReader=true is currently not supported on web platform"),new Promise((e,t)=>{t({errorCode:l.a.ServiceAndOperationNotSupported,param:"pickFile with useBinaryReader=true is currently not supported on web platform"})})}return this._pickFile(e,r)}return new Promise((e,t)=>{t({errorCode:l.a.ServiceAndOperationNotSupported,param:"FileManager."+n})})}_openFile(e,t){return new Promise((r,n)=>{const i=e.getParameters()[0],o=e.getParameters()[1].openMode,s=i.fileName,c=i.fileContent,u=t.TraceManager.getTracer();if(!i)return u.error("Parameter file is null or undefined"),n({errorCode:l.a.OpenDocumentErrorCodeGeneric});if(i.fileName||(i.fileName="Default_name_"+Date.now()),!i.mimeType)return u.error("Parameter file.mimeType is null or undefined"),n({errorCode:l.a.OpenDocumentErrorCodeGeneric});if(!i.fileContent)return u.error(`File ${i.fileName} doesn’t have any content and cannot be opened.`),n({errorCode:l.a.OpenDocumentErrorCodeGeneric});const d=this._base64ToBlob(c,i.mimeType);switch(o){case 2:return window.navigator.msSaveBlob?window.navigator.msSaveBlob(d,s):a.a.getInstance().get_IsMacSafariNotSupportAnchorDownload()?this._saveBlobForSafari(d,n,u):this._saveOrOpenBlob(d,s),r();case 1:return window.navigator.msSaveOrOpenBlob?window.navigator.msSaveOrOpenBlob(d,s):a.a.getInstance().get_IsMacSafariNotSupportAnchorDownload()?this._saveBlobForSafari(d,n,u):this._saveOrOpenBlob(d),r();default:return u.error("Unknown mode value for openFile operation"),n({errorCode:l.a.OpenDocumentErrorCodeGeneric})}})}_pickFile(e,t){return new Promise((r,a)=>{let i;e.getParameters()&&e.getParameters()[0]&&(i=e.getParameters()[0]);const o=!(!i||!i.allowMultipleFiles)&&i.allowMultipleFiles,s=i&&i.maximumAllowedFileSize&&i.maximumAllowedFileSize>0?i.maximumAllowedFileSize:Object(n.D)(t.getState()).maxUploadFileSize,c=i&&i.accept?i.accept:"*";this._pickFileInternal(t,o,s,c).then(e=>{document.body.removeChild(this._fileInput),r(e)},e=>{document.body.removeChild(this._fileInput),a(e)})})}_pickFileInternal(e,t,r,n){return new Promise((e,a)=>{const o=document.getElementById("filepickerid");o?(this._fileInput=o,this._fileInput.multiple=t,this._fileInput.accept=n):(this._fileInput=document.createElement("input"),this._fileInput.type="file",this._fileInput.id="filepickerid",this._fileInput.style.display="none",this._fileInput.multiple=t,this._fileInput.accept=n,this._fileInput.onchange=t=>{const n=t.target.files;for(let e=0;e<n.length;e++){if(n[e].size>r)return void a({errorCode:l.a.FilePickerErrorFileSizeBreached,param:r/1024});if(0===n[e].size)return void a({errorCode:l.a.FilePickerErrorFileSizeCannotBeZero})}const o=[];let s=0;for(let t=0;t<n.length;t++){const r=new FileReader;r.onload=()=>{const a=r.result,c=a.substring(a.indexOf(",")+1),l={fileName:n[t].name,mimeType:n[t].type,fileContent:c,fileSize:Math.ceil(c.length*i.a)};o.push(l),s++,s===n.length&&e(o)},r.onerror=e=>{const r=Object(u.d)("FileReader Error",l.a.FilePickerErrorUnableToOpenFile,[{name:"mimeType",value:n[t].type}]);r.innerError=e,a(r)},r.readAsDataURL(n[t])}},document.body.appendChild(this._fileInput)),this._fileInput.click()})}_base64ToBlob(e,t){const r=window.atob(e),n=r.length,a=new ArrayBuffer(n),i=new Uint8Array(a);for(let e=0;e<n;e++)i[e]=r.charCodeAt(e);return new Blob([a],{type:t})}_saveOrOpenBlob(e,t){const r=window.URL.createObjectURL(e);!
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t){const r=document.createElement("a");r.setAttribute("href",e),a.a.getInstance().get_IsMacSafari()||r.setAttribute("target","_blank"),t&&r.setAttribute("download",t),document.body.appendChild(r),r.click(),document.body.removeChild(r)}(r,t),setTimeout(()=>{window.URL.revokeObjectURL(r)},1e3)}_saveBlobForSafari(e,t,r){const n=new FileReader;n.onloadend=()=>{let t=n.result,r=document.getElementById("__mscrm.safariopenfileiframe");r||(r=document.createElement("iframe"),r.style.display="none",document.body.appendChild(r),r.id="__mscrm.safariopenfileiframe"),(e.type.startsWith("text")||e.type.startsWith("image")||e.type.startsWith("application"))&&(t=t.replace(e.type,"application/octet-stream")),r.src=t},n.onerror=e=>(r.error("Something is wrong with buffer data. Error: "+e.toString()),t({errorCode:l.a.OpenDocumentErrorCodeGeneric})),n.readAsDataURL(e)}static getAvailableServiceOperations(){return Object(c.a)(o.f,s.f)}}}}]),window.bundleExecutionMarkers["scripts/webplatform.js?v=1.4.3886-master"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();