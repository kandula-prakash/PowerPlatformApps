/*! For license information please see 34.0fdf17a5.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[34],{3148:function(e,t,r){"use strict";r.r(t),r.d(t,"getDateTimeStringFromT",(function(){return h})),r.d(t,"AppsList",(function(){return g}));var n=r(3064),a=r(1190),o=r(3076),i=r(1105),s=r(2887),p=r(3149),c=r(922),l=r(545),u=r(245),m=r.n(u),d=r(303),f=r(3155),b=r(3160),v=r(3169),y=r(3180),h=Object(l.memoizeFunction)((e,t)=>{var r={formats:{justNow:t("dateTime.formats.justNow"),timeAgo:t("dateTime.formats.timeAgo"),timeInFuture:t("dateTime.formats.timeInFuture"),time:t("dateTime.formats.time")},units:{second:t("dateTime.units.second"),seconds:t("dateTime.units.seconds"),min:t("dateTime.units.min"),mins:t("dateTime.units.mins"),hour:t("dateTime.units.hour"),hours:t("dateTime.units.hours"),day:t("dateTime.units.day"),days:t("dateTime.units.days"),week:t("dateTime.units.week"),weeks:t("dateTime.units.weeks"),month:t("dateTime.units.month"),months:t("dateTime.units.months"),year:t("dateTime.units.year"),years:t("dateTime.units.years")}};return Object(s.getFriendlyRelativeTimeString)(e,r)});var g=Object(c.translateService)("PowerAppsPortalApps")(Object(o.withApolloClient)(e=>{var{appId:t,environmentClient:r,searchFilter:o,requiresCanvasApps:s,requiresAppModules:c,onGenericAppSelect:l,isAdminScope:g,deletedApps:O,t:A,numberOfAppsToShow:C,additionalApps:j,additionalAppsLoadState:S,skipLoadOrder:T,canvasAppShareAreaPathUri:P,modelDrivenAppShareAreaPathUri:M,setDeleteModalState:L,showDetailsPanel:k}=e;if(!r)return null;var{currentEnvironment:w}=Object(u.useContext)(i.EnvironmentContext),E=Object(d.useHistory)(),{filter:D}=Object(p.useAppsListFilterState)(),{loadProgress:N,appListItems:I}=Object(y.useAppsListBehavior)(r,D,g,s,c,A("common.request.failed"),e=>function(e,t){return Object(f.getAppTypeDisplayName)(e,t("appType.model"),t("appType.powerPortal"),t("appType.canvas"),t("appType.customCanvasPage"))}(e,A),e=>h(e,A),O,C,j,S,T),x=Object(u.useMemo)(()=>"string"==typeof t?null==I?void 0:I.find(e=>Object(a.equalsIgnoreCase)(null==e?void 0:e.id,t)):void 0,[t,I]),F=Object(f.getAppsListEnvironment)(w,e.appsListInjectedEnvironment),R=Object(u.useMemo)(()=>Object(v.getItemToMenuColumnConverter)({t:A,history:E,selectedApp:x,appsListCurrentEnvironment:F,canvasAppShareAreaPathUri:P,modelDrivenAppShareAreaPathUri:M,isAdminScope:g,setDeleteModalState:L,showDetailsPanel:k}),[x,F,P,M,g,L,k]),U=Object(u.useCallback)(e=>{var t={href:"#",disabled:!(!F||"Teams"!==F.environmentType),onClick:()=>{Object(v.appsListTitleClick)(e.id,e.appType,e.name,e.imageBackgroundColor,e.isSharePoint,e.embeddedAppListUrl,e.ownerTenantId,w)},onContextMenu:e=>(e.preventDefault(),!1)};return m.a.createElement(n.DetailsListLink,{linkText:e.displayName,linkProps:t})},[w]),B=Object(u.useMemo)(()=>Object(v.buildAppsListColumns)({t:A,convertItemToMenuColumn:R,onRenderDisplayName:U}),[R,U]),z=Object(u.useCallback)(()=>Object(v.getAppsListPropsOnEmpty)(e=>E.push({pathname:"/environments/".concat(F.environmentName).concat(e)}),A("noApps.message"),A("noApps.description"),A("noApps.exploreTemplates"),A("common.learnMore"),g),[g,F.environmentName]);return m.a.createElement(b.AppsListBase,{appListItems:I,loadProgress:N,searchFilter:o,columns:B,onGenericAppSelect:l,renderOnEmpty:z})}))},3149:function(e,t,r){"use strict";r.r(t),r.d(t,"useAppsListFilterState",(function(){return s}));var n=r(3150),a=r(3151),o=r(3154),i=n.CanvasAppType.SharedWithMe;function s(){var e,t,r,{state:n,setState:s}=Object(a.usePersistentState)(o.AppsListTypeClientQuery);return{filter:null!==(e=null==n||null===(t=n.powerAppsPortal)||void 0===t||null===(r=t.apps)||void 0===r?void 0:r.appsListType)&&void 0!==e?e:i,setFilter:e=>{var t={powerAppsPortal:{apps:{appsListType:e,__typename:o.powerAppsPortalCacheTypeName.appsListType},__typename:o.powerAppsPortalCacheTypeName.apps}};s(t)}}}},3151:function(e,t,r){"use strict";r.r(t),r.d(t,"safeReadCache",(function(){return i})),r.d(t,"usePersistentState",(function(){return s}));var n=r(3152),a=r(3076),o=r(245),i=e=>{var t;try{t=e()}catch(r){r instanceof Error&&r.name}return t};function s(e){var t,{environmentClient:r}=Object(o.useContext)(a.ApolloClientContext),{data:i}=Object(n.useQuery)(e,{client:null!=r?r:void 0,skip:!r});return{state:null!==(t=r&&i)&&void 0!==t?t:void 0,setState:t=>{r&&r.writeQuery({query:e,data:t})}}}},3154:function(e,t,r){"use strict";r.r(t),r.d(t,"powerAppsPortalCacheTypeName",(function(){return s})),r.d(t,"AppsListTypeClientQuery",(function(){return p}));var n,a=r(3128);var o,i,s={apps:"apps",appsListType:"appsListType"},p=r.n(a)()(n||(o=["\n  query appsListType {\n    powerAppsPortal @client {\n      apps {\n        appsListType\n      }\n    }\n  }\n"],i||(i=o.slice(0)),n=Object.freeze(Object.defineProperties(o,{raw:{value:Object.freeze(i)}}))))},3160:function(e,t,r){"use strict";r.r(t),r.d(t,"AppsListBase",(function(){return y}));var n=r(3064),a=r(3161),o=r(2813),i=r(3166),s=r(1089),p=r(922),c=r(2812),l=r(545),u=r(245),m=r.n(u),d=r(3167),f=r(3169),b=r(3155);function v(){return(v=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var y=Object(p.translateService)("PowerAppsPortalApps")(e=>{var{appListItems:t,loadProgress:r,searchFilter:p,columns:y,className:h,selectionMode:g,onGenericAppSelect:O,renderOnEmpty:A,t:C}=e,j=Object(c.isEmpty)(t)&&Object(o.hasErrorMessage)(r),S=Object(b.getUnexpectedErrorMessage)(r),T=!Object(c.isEmpty)(t)&&!Object(c.isEmpty)(S),P=Object(u.useCallback)(()=>m.a.createElement(a.EmptyState,Object(d.getPropsOnEmptySearch)(f.appsListEmptyMessageClassName,C("search.noMatch.title"),C("search.noMatch.message"))),[]),M=Object(u.useCallback)(()=>m.a.createElement(a.EmptyState,Object(d.getPropsOnError)(f.appsListEmptyMessageClassName,r,C("common.request.failed"))),[r]);return m.a.createElement(m.a.Fragment,null,T&&m.a.createElement(f.ErrorMessageBar,{errorMessage:S}),m.a.createElement(n.DetailsList,v({styles:{outerRoot:h}},Object(i.getDetailsListProps)(C("Common.rowSelectionAriaLabel")),{setKey:"staticKey",renderOnEmpty:A,filter:p,renderOnEmptySearch:P,isError:j,renderOnError:M,items:t,columns:y,selectionMode:null!=g?g:l.SelectionMode.single,selection:Object(f.getAppsListItemSelection)(O),filterAnnouncement:e=>Object(s.formatResourceString)(C("search.results"),e),useShimmeredList:!0})))})},3167:function(e,t,r){"use strict";r.r(t),r.d(t,"getPropsOnEmptySearch",(function(){return u})),r.d(t,"getPropsOnError",(function(){return m})),r.d(t,"getCommonPropsOnErrorOrEmptySearch",(function(){return d}));var n=r(2844),a=r(2752),o=r(2813),i=r(3168),s=r(687);function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach((function(t){l(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function u(e,t,r){return c(c({},d()),{},{className:e,primaryMessage:t,secondaryMessage:[r]})}function m(e,t,r){return c(c({},d(!0)),{},{className:e,primaryMessage:r,secondaryMessage:[Object(o.getErrorMessages)(t).join(" ")]})}function d(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t={icon:e?n.fabricIcons.Cancel:f(),maxWidth:i.emptyStateMaxWidth};return t}function f(){return{iconType:s.IconType.image,imageProps:{src:a.default.getPaths().appEmptyState}}}},3169:function(e,t,r){"use strict";r.r(t),r.d(t,"appsListEmptyMessageClassName",(function(){return P})),r.d(t,"getAppsListItemSelection",(function(){return M})),r.d(t,"buildAppsListColumns",(function(){return L})),r.d(t,"getAppsListPropsOnEmpty",(function(){return k})),r.d(t,"getItemToMenuColumnConverter",(function(){return w})),r.d(t,"getCommonColumnProps",(function(){return D})),r.d(t,"appsListTitleClick",(function(){return N})),r.d(t,"ErrorMessageBar",(function(){return I}));var n=r(3064),a=r(3161),o=r(1083),i=r(1086),s=r(3156),p=r(3170),c=r(2844),l=r(1697),u=r(1473),m=r(545),d=r(245),f=r.n(d),b=r(3171),v=r(3159),y=r(3172),h=r(3174),g=r(3177),O=r(3167),A=r(3148),C=r(3179);function j(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function S(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?j(Object(r),!0).forEach((function(t){T(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):j(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function T(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var P="apps-list-empty-message",M=Object(m.memoizeFunction)(e=>{var t=new u.Selection({onSelectionChanged:()=>{var r=t.getSelection().length>0?t.getSelection()[0]:null;e&&e(r&&r.id||void 0,r&&r.appType||void 0)}});return t}),L=e=>{var{t:t,convertItemToMenuColumn:r,onRenderDisplayName:a}=e,o=t("common.sorting.ascending"),i=t("common.sorting.descending"),s=r?[Object(n.buildMenuColumn)(r)]:[],p=S(S({},Object(n.buildIconColumn)(E,n.RowHeight.medium)),{},{iconName:c.fabricIcons.AppIconDefault,isIconOnly:!0,headerClassName:C.appsListStyleClasses.iconHeader}),l=D(o,i);return[p,S(S({},l),{},{key:"displayName",name:t("common.name"),fieldName:"displayName",minWidth:50,maxWidth:350,isCollapsible:!1,onRender:a}),...s,S(S({},l),{},{key:"displayModifiedDate",name:t("common.modified"),fieldName:"displayModifiedDate",minWidth:100,maxWidth:160,onRender:e=>{var r;return(null===(r=Object(A.getDateTimeStringFromT)(e.displayModifiedDate,t))||void 0===r?void 0:r.toLocaleString())||""}}),S(S({},l),{},{key:"ownerName",name:t("common.owner"),fieldName:"ownerName",minWidth:100,maxWidth:190}),{key:"appType",name:t("common.type"),fieldName:"appType",minWidth:100,maxWidth:100,onRender:e=>e.displayAppTypeName}]},k=(e,t,r,n,o,i)=>{var s=S(S({},Object(O.getCommonPropsOnErrorOrEmptySearch)()),{},{className:P,primaryMessage:t,secondaryMessage:[r],learnMoreLabel:o,learnMoreProps:{href:b.appLinks.canvasAndModelCreateLink,target:"_blank"}});return i||(s=S(S({},s),{},{callToActionText:n,callToActionProps:{onClick:()=>e(p.templateAppsRoute.canvas,!0)}})),f.a.createElement(a.EmptyState,s)};function w(e){var{history:t,appsListCurrentEnvironment:r,isAdminScope:n,t:a,canvasAppShareAreaPathUri:o,setDeleteModalState:i,showDetailsPanel:p,selectedApp:c,modelDrivenAppShareAreaPathUri:l}=e;return e=>{var u=e&&e.appType;return u===s.AppTypes.Canvas?{items:Object(h.useCanvasAppContextMenuCommands)({appName:e.name,enableTestStudio:!1,enablePowerPortalPublicPreview:!1,history:t,currentEnvironment:r,isAdminScope:n,t:a,canvasAppShareAreaPathUri:o,permissions:e.permissions,isSpoFormApp:e.isSharePoint,isCustomizable:e.isCustomizable},()=>i({showModal:!0,appName:"".concat(e.name),appDisplayName:"".concat(e.displayName),appType:s.AppTypes.Canvas}),()=>null==p?void 0:p("".concat(e.name))),iconAriaLabel:a("common.commands")}:u===s.AppTypes.Model?{items:Object(g.useAppModuleContextMenuCommands)({appModuleId:e&&e.id,isSampleAppModule:c&&c.isSampleApp,isManaged:null==c?void 0:c.isManaged,isAdminScope:n,currentEnvironment:r,modelDrivenAppShareAreaPathUri:l,history:t,t:a},()=>i({showModal:!0,appName:"".concat(e.id),appDisplayName:"".concat(e.displayName),appType:s.AppTypes.Model})),iconAriaLabel:a("common.commands")}:{items:[],iconAriaLabel:"s"}}}var E=e=>({iconUri:e.imageUrl,iconAltText:e.displayName,defaultIconUrl:v.DefaultAppBackgroundImageUri,iconBackgroundColor:e.imageBackgroundColor});var D=Object(m.memoizeFunction)((e,t)=>({isRowHeader:!0,isResizable:!0,isPadded:!0,isMultiline:!1,isCollapsible:!0,sortAscendingAriaLabel:e,sortDescendingAriaLabel:t}));function N(e,t,r,n,a,p,c,l){switch(t){case s.AppTypes.Canvas:Object(y.launchAppInWebPlayer)(r,n,a,p,c);break;case s.AppTypes.Model:var u=o.getCrmInstanceUrl(l);if(u&&e){var m=i.getPlayAppModuleUrl(u,e);window.open(m,"_blank")}break;case s.AppTypes.PowerPortal:}}function I(e){return e.errorMessage?f.a.createElement(l.MessageBar,{messageBarType:l.MessageBarType.info,isMultiline:!1,dismissButtonAriaLabel:c.fabricIcons.Cancel},e.errorMessage):f.a.createElement(f.a.Fragment,null)}},3171:function(e,t,r){"use strict";r.r(t),r.d(t,"appLinks",(function(){return n}));var n={canvasAndModelCreateLink:"https://aka.ms/canvasAndModelCreateLink"}},3174:function(e,t,r){"use strict";r.r(t),r.d(t,"useCanvasAppContextMenuCommands",(function(){return o})),r.d(t,"useCanvasAppCommandBarCommands",(function(){return i})),r.d(t,"useDefaultCommandBarCommands",(function(){return s})),r.d(t,"memoizedCanvasAppContextMenuCommands",(function(){return p}));var n=r(545),a=r(3175);function o(e,t,r){var n=Object(a.canvasAppCommandRepository)(e);return e.isAdminScope?[n.ShareApp({}),n.DeleteApp({onClick:t}),n.Details({onClick:r})]:[n.ShareApp({}),n.DeleteApp({onClick:t})]}function i(e,t,r,n){var o=Object(a.canvasAppCommandRepository)(e);return e.isAdminScope?[o.ShareApp({}),o.DeleteApp({onClick:t}),o.Details({onClick:n})]:[o.ShareApp({}),o.DeleteApp({onClick:t})]}function s(){return[]}var p=Object(n.memoizeFunction)(o)},3175:function(e,t,r){"use strict";r.r(t),r.d(t,"canvasAppCommandRepository",(function(){return m}));var n=r(3176),a=r(2844),o=r(2816),i=r(777),s=r(3155),p=r(2840);function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){u(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function u(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var m=e=>{var{appName:t,currentEnvironment:r,t:c,isAdminScope:u,history:m,canvasAppShareAreaPathUri:d,permissions:f,isSpoFormApp:b,isCustomizable:v}=e;return{Divider:()=>({key:"Divider",itemType:i.ContextualMenuItemType.Divider}),EditCanvasApp:e=>l({key:"EditCanvasApp",name:c("getResources().Controllers.ManageApp.headerEditCommand"),iconProps:{iconName:a.fabricIcons.Edit,style:{color:n.fabricTheme&&n.fabricTheme.palette&&n.fabricTheme.palette.themePrimary}},onClick:()=>{}},e),Details:e=>l({key:"Details",text:c("CommandsTitles.details"),iconProps:{iconName:a.fabricIcons.Info,style:{color:n.fabricTheme&&n.fabricTheme.palette&&n.fabricTheme.palette.themePrimary}}},e),ShareApp:e=>l({key:"ShareApp",text:c("CommandsTitles.share"),onClick:()=>{((e,t,r,n,a)=>{var i=Object(o.appShareDeepLink)(a,t,e,r,!1,!0);n.push(i)})(t,r&&r.environmentName,u,m,d)},disabled:Object(s.isShareAppDisable)(f,b,u),iconProps:{iconName:a.fabricIcons.Share,style:{color:n.fabricTheme&&n.fabricTheme.palette&&n.fabricTheme.palette.themePrimary}}},e),DeleteApp:e=>l({key:"DeleteApp",text:c("CommandsTitles.delete"),iconProps:{iconName:a.fabricIcons.Delete,style:{color:n.fabricTheme&&n.fabricTheme.palette&&n.fabricTheme.palette.themePrimary}},disabled:Object(s.isDeleteAppDisable)(f,b,u)||!Object(p.featureGatedIsCustomizable)(v)},e)}}},3177:function(e,t,r){"use strict";r.r(t),r.d(t,"useAppModuleContextMenuCommands",(function(){return a})),r.d(t,"useAppModuleCommandBarCommands",(function(){return o}));var n=r(3178);function a(e,t){var r=Object(n.appModuleCommandRepository)(e);return[r.ShareAppModule({}),r.DeleteAppModule({onClick:t})]}function o(e,t){var r=Object(n.appModuleCommandRepository)(e);return[r.ShareAppModule({}),r.DeleteAppModule({onClick:t})]}},3178:function(e,t,r){"use strict";r.r(t),r.d(t,"appModuleCommandRepository",(function(){return l}));var n=r(3176),a=r(2844),o=r(2816),i=r(777);function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function p(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){c(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var l=e=>{var{appModuleId:t,currentEnvironment:r,isAdminScope:s,isManaged:c,t:l,history:u,modelDrivenAppShareAreaPathUri:m}=e;return{Divider:()=>({key:"Divider",itemType:i.ContextualMenuItemType.Divider}),ShareAppModule:e=>p({key:"ShareAppModule",name:l("CommandsTitles.share"),iconProps:{iconName:a.fabricIcons.Share,style:{color:n.fabricTheme&&n.fabricTheme.palette&&n.fabricTheme.palette.themePrimary}},onClick:()=>((e,t,r,n,a)=>{var i=Object(o.appShareDeepLink)(a,t,e,r,!0,!0);n.push(i)})(t,r&&r.environmentName,s,u,m)},e),DeleteAppModule:e=>p({key:"DeleteAppModule",name:l("CommandsTitles.delete"),disabled:c,iconProps:{iconName:a.fabricIcons.Delete,style:{color:n.fabricTheme&&n.fabricTheme.palette&&n.fabricTheme.palette.themePrimary}},onClick:()=>{}},e)}}},3179:function(e,t,r){"use strict";r.r(t),r.d(t,"appsListStyleClasses",(function(){return o}));var n=r(3176),a=r(719),o=Object(a.mergeStyleSets)({iconHeader:{selectors:{"span[class*='ms-DetailsHeader-cellTitle']":{justifyContent:"center"}}},disabledRow:{pointerEvents:"none",opacity:"0.5",background:"#ccc"},appImage:{width:"20px",height:"20px",pointerEvents:"auto"},statusIcon:{background:"#fff",fontSize:"10px",position:"absolute",bottom:"0",right:"0",marginRight:"0",marginBottom:"9px",padding:"1px",borderRadius:"12px"},transparentAppImage:{opacity:"0.5"},failIconColor:{color:n.fabricTheme&&n.fabricTheme.palette&&n.fabricTheme.palette.redDark}})},3180:function(e,t,r){"use strict";r.r(t),r.d(t,"appsListTelemetryName",(function(){return f})),r.d(t,"useAppsListBehavior",(function(){return b})),r.d(t,"createAppRowFromApp",(function(){return y})),r.d(t,"createAppRowFromGenericApp",(function(){return h}));var n=r(3156),a=r(3181),o=r(2698),i=r(2813),s=r(2811),p=r(3185),c=r(3196),l=r(2812),u=r(245),m=r(3155),d=r(3197),f="AppsList";function b(e,t,r){var l=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],m=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],b=arguments.length>5?arguments[5]:void 0,y=arguments.length>6?arguments[6]:void 0,h=arguments.length>7?arguments[7]:void 0,g=arguments.length>8?arguments[8]:void 0,O=arguments.length>9?arguments[9]:void 0,A=arguments.length>10?arguments[10]:void 0,C=arguments.length>11?arguments[11]:void 0,j=arguments.length>12?arguments[12]:void 0,{errorMessage:S,canvasApps:T}=Object(c.useCanvasAppsListQuery)(e,{appListType:t,isAdminScope:r},o.PortalScope,b,!0,!l),{errorMessage:P,appModules:M}=Object(p.useAppModulesListQuery)(e,o.PortalScope,b,d.DefaultPollTimeInMs,!m,!0),L=Object(u.useMemo)(()=>e=>e.appType===n.AppTypes.Canvas?!g.includes(e.name):e.appType!==n.AppTypes.Model||!g.includes(e.id),[g]),k=Object(u.useMemo)(()=>e=>v(e,y,h),[]),w=[Object(i.toLoadingState)(void 0!==T,S,"Canvas",l),Object(i.toLoadingState)(void 0!==M,P,"Model",m)];void 0!==A&&void 0!==C&&w.push(C),Object(s.useLoadProgressTelemetry)(f,w);var E=Object(i.getTotalLoadingState)(w),D=2,N=Object(a.useLoadOrder)({canvasApps:T,appModules:M,additionalAppsListItems:A},E===i.ComponentLoadState.Loading,D,O,L,k,j,f);return{loadProgress:w,appListItems:N}}var v=Object(l.memoize)((e,t,r)=>y(e,t,r)),y=(e,t,r)=>{var a=e.appType,o=h(e,t,r);if(a===n.AppTypes.Canvas){var i,s=e;o.ownerTenantId=null!==(i=s.ownerTenantId)&&void 0!==i?i:"",o.isSharePoint=s.isSharePoint,o.embeddedAppListUrl=s.embeddedAppListUrl,o.permissions=s.permissions,o.isCustomizable=!!s.isCustomizable}else a===n.AppTypes.Model&&(o.isSampleApp=e.isSampleAppModule,o.isManaged=e.isManaged);return o},h=(e,t,r)=>{var{id:n,name:a,displayName:o,ownerName:i,imageUrl:s,imageBackgroundColor:p,lastModifiedDate:c}=e,l=e.appType,u=t(l),d=new Date(null!=c?c:"");return{type:"AppListItem",id:n,key:n,name:a,displayName:o,appType:l,ownerName:i,displayAppTypeName:u,displayModifiedDate:d,imageUrl:Object(m.getAppImageUri)(l,s||""),imageBackgroundColor:p||"",filterOn:[o||"",r(d),u,i],ownerTenantId:"",isSharePoint:!1,embeddedAppListUrl:"",isSampleApp:!1,isManaged:!1,permissions:[],isCustomizable:!0}}},3181:function(e,t,r){"use strict";r.r(t),r.d(t,"useLoadOrder",(function(){return l}));var n=r(245),a=r(3182),o=(e,t)=>{var r=[];for(var n of(t||(t=Object.keys(e)),t))void 0!==e[n]&&null!==e[n]&&r.push(e[n]);return r},i=e=>Object.keys(e).map(t=>void 0===e[t]?void 0:t).filter(e=>void 0!==e),s=(e,t)=>{if(t.length===e.length)return t;var r=[...t];for(var n of e)t.indexOf(n)<0&&r.push(n);return r},p=(e,t,r,n,a)=>{for(var o=[],i=[],s=0;s<e.length;s++){for(var p=e[s],l=Math.min(n,p.length),u=0;u<l;u++){var m=p[u];a(m)&&o.push(m)}i[s]=u}return t||(o=c(o,e,i,a,r)),o},c=(e,t,r,n,a)=>{if(e.length>=a)return e;for(var o=0;o<t.length;o++)for(var i=t[o],s=r&&r[o]||0;s<i.length;s++){var p=i[s];if(n(p)&&(e.push(p),e.length>=a))return e}return e},l=function(e,t,r,l,u,m){var d,f,b,v=arguments.length>6&&void 0!==arguments[6]&&arguments[6],y=arguments.length>7?arguments[7]:void 0,h=arguments.length>8?arguments[8]:void 0,[g,O]=Object(n.useState)(t),[A,C]=Object(n.useState)([]),[j,S]=Object(n.useState)(!1),T=i(e);if(v||j)d=o(e),f=c([],d,void 0,u,l);else{d=o(e,A);var P=l&&l/r||4;f=p(d,t,l,P,u)}Object(n.useEffect)(()=>{C(s(T,A))},[T.length]),Object(n.useEffect)(()=>{t!==g&&O(t)},[t]),Object(n.useEffect)(()=>{t||g||S(!0)},[u,m,f.length]);var M=(b=m?f.map(m):f).length,L=0;return v||j||!t||(L=l?l-b.length:6)>0&&(b=b.concat(new Array(L))),Object(a.useLoadOrderContextScenarioProgress)({itemCount:M,shimmerCount:L,listName:y,isLoading:t,error:h}),b}},3182:function(e,t,r){"use strict";r.r(t),r.d(t,"useLoadOrderContextScenarioProgress",(function(){return i}));var n=r(245),a=r(3183),o=r(3184),i=e=>{var{itemCount:t,shimmerCount:r,listName:i,isLoading:s,error:p}=e,{trackContextScenarioProgress:c,trackMyPartFinished:l}=Object(a.useContextScenario)(),u=Object(n.useRef)(!1),m=Object(n.useRef)(!1);Object(n.useEffect)(()=>{if(i&&c){var e=0===t&&!s&&!p;!u.current&&(e||t>0)&&(c({[i]:"is now interactive"}),u.current=!0),c({[i]:"".concat(t," items, ").concat(r," shimmers")})}},[t,r]),Object(n.useEffect)(()=>{i&&c&&(s||m.current||(p?l(o.CompleteOrFail.Fail,p):0===r&&l(o.CompleteOrFail.Complete),m.current=!0))},[s])}},3183:function(e,t,r){"use strict";r.r(t),r.d(t,"ContextScenarioContext",(function(){return p})),r.d(t,"useContextScenario",(function(){return c})),r.d(t,"ContextScenarioProvider",(function(){return l}));var n=r(245),a=r.n(n),o=r(222),i=r(2698),s=r(3184),p=a.a.createContext({trackContextScenarioProgress:()=>{},trackMyPartFinished:()=>{}}),c=()=>Object(n.useContext)(p),l=e=>{var{scenarioName:t,expectedCompletions:r}=e,c=Object(n.useRef)(),l=Object(n.useRef)({});return Object(n.useEffect)(()=>{c.current=Object(i.trackLoadScenario)(t)},[]),a.a.createElement(p.Provider,{value:{trackContextScenarioProgress:function(e){c.current&&Object(i.trackScenarioProgress)(t,e,c.current)},trackMyPartFinished:function(e,n){c.current&&(e===s.CompleteOrFail.Fail?(Object(i.trackScenarioFailure)(t,{errorMessage:n||"No error message attached"},c.current),c.current=void 0):Object.keys(l.current).length+1===r?(Object(i.trackScenarioComplete)(t,void 0,c.current),c.current=void 0):l.current[Object(o.v4)()]="Completed")}}},e.children)}},3184:function(e,t,r){"use strict";var n;r.r(t),r.d(t,"CompleteOrFail",(function(){return n})),function(e){e[e.Fail=0]="Fail",e[e.Complete=1]="Complete"}(n||(n={}))},3196:function(e,t,r){"use strict";r.r(t),r.d(t,"useCanvasAppsListQuery",(function(){return l})),r.d(t,"useAppComponentLibrariesListPollingQuery",(function(){return u})),r.d(t,"useCanvasAppQuery",(function(){return d}));var n=r(3152),a=r(217),o=r(245),i=r(3192),s=r(3197),p=r(3193),c=r(3198);function l(e,t,r,n){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5&&void 0!==arguments[5]&&arguments[5];return m(e,c.CanvasAppsQuery,t,r,n,a,o)}function u(e,t,r,n){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5?arguments[5]:void 0,i=arguments.length>6?arguments[6]:void 0,{loading:s,errorMessage:p,canvasApps:l}=m(e,c.ComponentLibrariesQuery,t,r,n,!0,a,o,i);return{loading:s,errorMessage:p,appComponentLibraries:l}}function m(e,t,r,c,l){var u=arguments.length>5&&void 0!==arguments[5]&&arguments[5],m=arguments.length>6&&void 0!==arguments[6]&&arguments[6],d=arguments.length>7?arguments[7]:void 0,f=arguments.length>8?arguments[8]:void 0,b=p.TelemetryScenarioNames.canvasAppListGraphQl,[v,y]=Object(o.useState)(),[h,g]=Object(o.useState)(""),{loading:O,data:A,refetch:C}=Object(n.useQuery)(t,{skip:m,client:e||void 0,pollInterval:u?s.DefaultPollTimeInMs:void 0,fetchPolicy:"no-cache",notifyOnNetworkStatusChange:u,onCompleted:e=>{v&&(v.complete({canvasAppsLength:e&&e.canvasApps&&e.canvasApps.length}),y(void 0))},onError:e=>{var t=Object(i.getResponseMessageFromApolloError)(e,l);g(t),v&&(v.failure({error:t,clientError:e&&e.message}),y(void 0))},variables:r});return Object(o.useEffect)(()=>{(d&&d(A)||f)&&C&&C(r)},[d]),Object(o.useEffect)(()=>{y(Object(a.trackLoadScenario)(c,b))},[O]),{loading:O,errorMessage:h,canvasApps:A&&A.canvasApps}}function d(e,t,r,s,l,u){var m=p.TelemetryScenarioNames.canvasAppGraphQl,[d,f]=Object(o.useState)(),[b,v]=Object(o.useState)(""),y=l||!t.appId,{loading:h,data:g,refetch:O}=Object(n.useQuery)(c.CanvasAppQuery,{skip:y,client:e||void 0,onCompleted:()=>{d&&d.complete()},onError:e=>{var t=e.message,r=Object(i.getResponseMessageFromApolloError)(e,s);v(r),d&&d.failure({error:r,clientError:t})},variables:t});return u&&O&&O(),Object(o.useEffect)(()=>{h&&f(Object(a.trackLoadScenario)(r,m))},[h]),{loading:h,errorMessage:b,canvasApp:g&&g.canvasAppById}}}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/34.0fdf17a5.chunk.js.map