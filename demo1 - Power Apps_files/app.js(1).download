(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/app.js?v=1.4.3886-master"]={begin:performance.now()},function(e){function t(t){for(var r,o,s=t[0],c=t[1],l=t[2],d=0,p=[];d<s.length;d++)o=s[d],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&p.push(a[o][0]),a[o]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);for(u&&u(t);p.length;)p.shift()();return i.push.apply(i,l||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],r=!0,s=1;s<n.length;s++){var c=n[s];0!==a[c]&&(r=!1)}r&&(i.splice(t--,1),e=o(o.s=n[0]))}return e}var r={},a={94:0},i=[];function o(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.e=function(e){var t=[],n=a[e];if(0!==n)if(n)t.push(n[2]);else{var r=new Promise((function(t,r){n=a[e]=[t,r]}));t.push(n[2]=r);var i,s=document.createElement("script");s.charset="utf-8",s.timeout=120,o.nc&&s.setAttribute("nonce",o.nc),s.src=function(e){return o.p+"scripts/"+({19:"barnotificationlist",34:"ODataQueryOptions",46:"editformpage",47:"offlinets",48:"previewsync",53:"UpsyncOfflineFileOrImage",54:"dialogpage",55:"formheaderv2",56:"retrieveToursActions",66:"AppActionSerializers",67:"CollaborationComponents",68:"ColumnEditor",69:"CustomPagePreinit",70:"DataSetExpressionBuilder",71:"FormCheckerStrings",72:"GlobalSearchFlyout",73:"LegacyOfflineStatusFileDownloadStatusList",74:"MdlProvider",75:"NativeComponents",76:"NotificationCard",77:"OfflineDataSyncAsyncAction",78:"OfflineStatusBarManager",79:"OfflineStatusFileDownloadStatusList",80:"OpenOfflineStatusDialogAction",81:"RequiredFieldValidationCheckerModule",82:"RunControlStateChecker",83:"RunRelatedMenuCheckerModule",84:"RunSaveRecordCheckerModule",85:"SqlDbTransactionAdapterV2",86:"SqlExecutorImpl",87:"ToastContainerInner",88:"ToastNotificationContainer",89:"TourUtilitiesImports",90:"XrmOfflineValidator",91:"activityTypeComboBox",92:"addAppNotifications",93:"addToastNotification",95:"appNameBar",96:"appshellpage",97:"appspage",98:"arviewerdispatcher",99:"benchmarkpage",100:"big.js",101:"businessprocesspagewrapper",102:"cardfeedcontainerflyout",103:"commandchecker",104:"contextualHelpBrowser",105:"contextualHelpBrowser.strings",106:"cordovamediadispatcher",108:"customcontrolpage",109:"custompage",110:"dashboardpage",111:"datadispatcher",112:"developerconsole",113:"documentdispatcher",114:"dynamicsOct2020",115:"embeddedplatform",116:"executeNonCUDUpSyncRequest",117:"expressionContextProvider",118:"externalcontextdispatcher",119:"feedbackdispatcher",120:"fluentui",121:"globalSearchBoxContainer",122:"globalbarnotification",123:"globalcommandbar",124:"gridpage",125:"highdensitypageheader",126:"highdensitypageheaderforform",127:"initializeAppHostClient",128:"kbarticlepage",129:"kbsearchpage",130:"legacydialogpage",131:"livepersonacard",132:"localdeploymenthandler",133:"lookupdialogpage",134:"mailapp",135:"mds",136:"mobilescrollabletabs",137:"modaldialogpage",138:"modelformcomponent",139:"monitor",140:"multimediadispatcher",141:"multisession",142:"nativeplatform",143:"navigateToTourStep",144:"navigationdispatcher",145:"networkdispatcher",146:"notificationcenter",147:"notificationsettings",148:"officeapplauncher",149:"officewaffleplaceholder",150:"offlineODataCRUD",151:"offlinestatusdialogpage",152:"onnavigation",153:"performanceinterface",154:"performancescenarios",155:"popupnotification",156:"powerbifullscreenpage",157:"powertours-tourcomponents",158:"previewform",159:"querypage",160:"quickcreateformpage",161:"runBpfChecker",162:"runControlDefaultValueChecker",163:"searchpage",164:"sessionpanel",165:"sidepanel",166:"sitemapmonitor",167:"sitemappanel",168:"taskbasedflowmenu",169:"taskbasedflowpage",170:"toastnotificationlist",171:"tourcontextprovider",172:"upgraderunner",173:"webplatform",174:"webresourcepage",175:"welcomepagedialog"}[e]||e)+".js?v=1.4.3886-master"}(e),0!==s.src.indexOf(window.location.origin+"/")&&(s.crossOrigin="anonymous");var c=new Error;i=function(t){s.onerror=s.onload=null,clearTimeout(l);var n=a[e];if(0!==n){if(n){var r=t&&("load"===t.type?"missing":t.type),i=t&&t.target&&t.target.src;c.message="Loading chunk "+e+" failed.\n("+r+": "+i+")",c.name="ChunkLoadError",c.type=r,c.request=i,n[1](c)}a[e]=void 0}};var l=setTimeout((function(){i({type:"timeout",target:s})}),12e4);s.onerror=s.onload=i,document.head.appendChild(s)}return Promise.all(t)},o.m=e,o.c=r,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o.oe=function(e){throw console.error(e),e};var s=window.__wpJsonpUci=window.__wpJsonpUci||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var l=0;l<s.length;l++)t(s[l]);var u=c;i.push(["DPXt",107,49]),n()}({"+5Bq":function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e){if(e)switch(e.toLowerCase()){case"false":return!1;case"true":return!0;default:return}}n.d(t,"a",(function(){return r}))},"+6s6":function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return s}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="ClientApi.XrmGridControl.",a="XrmFormSelectorItem",i=`ClientApi.${a}.`,o="XrmWebApiOnline",s=`ClientApi.${o}.`},"+7Rg":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="Button_Label_Close",a="RecordSetNavigator.button.name",i=[r,a]},"+Ajx":function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="form.related.select";function i(e,t,n){const i=Object(r.w)(t);return{type:a,payload:n,meta:{pageId:e,contextKey:i}}}},"+BIz":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("pgSX"),a=n("si7p");function i(e,t,n,i,o,s,c){const l=[{name:"dialogHeight",value:t&&t.height},{name:"dialogWidth",value:t&&t.width},{name:"dialogPosition",value:t&&t.position},{name:"dialogWindowPosition",value:t&&t.windowPosition}];return{type:"form.openConfirmDialog",execute:({dispatch:l,getState:u},d,p)=>l(Object(r.a)(a.c,e,t,s,n,o,c,void 0,void 0,void 0,i)),getFailureParameters:(e,t)=>l}}},"+Kwi":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));class r{constructor(e,t,n,r,a,i){this._day=0,this._dayOfWeek=0,this._month=0,this._week=0,this._timeOfDay=null,this._isFixedDateRule=!1,this._day=e,this._dayOfWeek=t,this._month=n,this._week=r,this._timeOfDay=a,this._isFixedDateRule=i}get_Day(){return this._day}get_DayOfWeek(){return this._dayOfWeek}get_Month(){return this._month}get_Week(){return this._week}get_TimeOfDay(){return this._timeOfDay.format("s")}get_IsFixedDataRule(){return this._isFixedDateRule}getObjectData(){const e={};return e.day=this._day,e.dayofweek=this._dayOfWeek,e.month=this._month,e.week=this._week,e.timeofday=this.get_TimeOfDay(),e.isfixeddaterule=this._isFixedDateRule,e}static createFromObjectData(e){const t=e.day,n=e.dayofweek,a=e.month,i=e.week,o=new Date(e.timeofday),s=e.isfixeddaterule;return new r(t,n,a,i,o,s)}}},"+QYJ":function(e,t,n){"use strict";function r(e){return null==e}function a(e){return r(e)||!e.length}function i(e){return!r(e)&&e.constructor===Array}n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i}))},"+Qpx":function(e,t,n){"use strict";n.d(t,"u",(function(){return a})),n.d(t,"D",(function(){return i})),n.d(t,"y",(function(){return o})),n.d(t,"z",(function(){return s})),n.d(t,"q",(function(){return c})),n.d(t,"H",(function(){return l})),n.d(t,"G",(function(){return u})),n.d(t,"t",(function(){return d})),n.d(t,"r",(function(){return p})),n.d(t,"I",(function(){return f})),n.d(t,"v",(function(){return g})),n.d(t,"s",(function(){return h})),n.d(t,"x",(function(){return m})),n.d(t,"C",(function(){return b})),n.d(t,"A",(function(){return y})),n.d(t,"E",(function(){return _})),n.d(t,"w",(function(){return S})),n.d(t,"F",(function(){return O})),n.d(t,"b",(function(){return C})),n.d(t,"a",(function(){return E})),n.d(t,"f",(function(){return I})),n.d(t,"e",(function(){return w})),n.d(t,"h",(function(){return j})),n.d(t,"g",(function(){return P})),n.d(t,"c",(function(){return T})),n.d(t,"l",(function(){return N})),n.d(t,"k",(function(){return A})),n.d(t,"B",(function(){return R})),n.d(t,"d",(function(){return D})),n.d(t,"m",(function(){return x})),n.d(t,"J",(function(){return M})),n.d(t,"i",(function(){return F})),n.d(t,"n",(function(){return k})),n.d(t,"p",(function(){return L})),n.d(t,"j",(function(){return B})),n.d(t,"o",(function(){return U}));var r=n("eq7e");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="Forms.FormChecker.",i="RelatedMenu",o="FormControls",s="FormEvents",c="UnsupportedClientApi",l="TabStateChange",u="SectionStateChange",d="ControlStateChange",p="CompositeControl",f="UnsavedChanges",g="FooterControls",h="ControlDefaultValue",m="FormType",b="QuickCreateMenu",y="InvalidClientAPIParameters",_="RequiredFieldValidation",v="MergeDialog.load",S="FormSelector",O="SaveRecord",C="BusinessProcessFlow.BPFChecker.",E="BPFNotShown",I="SetActiveStage",w="SelectionResults",j="StageNavigationBlocked",P="SetStatus",T="GetActiveStage",N="ClientAPI.ClientAPIChecker",A="ClientAPI",R="FormChecker",D="BPFChecker",x="ClientAPIChecker",M=[i,o,s,c,l,u,d,p,f,g,h,m,b,y,_,v,S,O].map(e=>`${a}${e}`),F=[E,w,j].map(e=>`${C}${e}`),k=[A].map(e=>`${N}${e}`),L=[{operation:i},{operation:s},{operation:c,logLevel:r.a.Error},{operation:l},{operation:u},{operation:d},{operation:o},{operation:p,logLevel:r.a.Error},{operation:f},{operation:g,logLevel:r.a.Error},{operation:h},{operation:y,logLevel:r.a.Error},{operation:b},{operation:m},{operation:_},{operation:v},{operation:S},{operation:O}].map(e=>Object.assign({eventPrefix:a},e)),B=[{operation:E},{operation:j},{operation:w},{operation:I,logLevel:r.a.Error},{operation:P,logLevel:r.a.Error},{operation:T,logLevel:r.a.Info}].map(e=>Object.assign({eventPrefix:C},e)),U=[{operation:A}].map(e=>Object.assign({eventPrefix:N},e))},"+Szo":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class r{constructor(e){this.length=e.rows.length,this._nativeResult=e}item(e){const t=this._nativeResult.rows[e];if(!t)return null;const n={};for(let e=0;e<this._nativeResult.columnNames.length;++e){n[this._nativeResult.columnNames[e]]=t[e]}return n}}},"+VD1":function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return c}));var r,a=n("eXjw");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */!function(e){e[e.Number=0]="Number",e[e.String=1]="String",e[e.Boolean=2]="Boolean"}(r||(r={}));var i=n("NCdO"),o=n("+5Bq");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function s(e,t){var n;if(!(e&&e.AppModulePublished&&e.AppModulePublished.length&&t))return null;const r=e.AppModulePublished.find(e=>e.appInfo.AppId===t),i=e.LabelsPublish;return r?{initialized:a.a.Initialized,app:l(r.appInfo,i),webResource:(s=r.webResourceInfo,{displayName:s.DisplayName,guid:s.Guid,name:s.Name,webResourceType:s.WebResourceType}),welcomePage:d(r.welcomePageInfo),eventHandlers:r.eventHandlers,offlineProfile:(o=null===(n=r.appInfo)||void 0===n?void 0:n.ProfileInformation,o?{AppId:o.AppId,OfflineAvailableEntities:o.OfflineAvailableEntities,ProfileId:o.ProfileId,ProfileVersion:o.ProfileVersion}:null)}:null;
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var o,s}function c(e){if(!e||!e.length)return null;const t=[];for(let n=0;n<e.length;n++){const r=e[n];if(4===r.ClientType&&r.IsOfflineEnabled){const e={ClientType:r.ClientType,Description:r.Description,Id:r.Id,Image:r.Image,ImageType:r.ImageType,Name:r.Name,IsOfflineEnabled:r.IsOfflineEnabled};t.push(e)}}return t}function l(e,t){return e?{appId:e.AppId,appUrl:e.AppUrl,id:e.Id,description:Object(i.a)(t,e.AppId,"description")||e.Description,LastModifiedOn:e.LastModifiedOn,status:e.Status,title:Object(i.a)(t,e.AppId,"name")||e.Title,uniqueName:e.UniqueName,clientType:e.ClientType,navigationType:e.NavigationType,isFeatured:e.IsFeatured,solutionId:e.SolutionId,versionNumber:e.VersionNumber,components:e.Components,appComponents:u(e.AppComponents),appSettings:p(e.AppSettings)}:null}function u(e){return e?{entities:e.Entities}:null}function d(e){return{displayName:e.DisplayName,guid:e.Guid,name:e.Name,webResourceType:e.WebResourceType}}function p(e){const t={};if(e)for(const n of e){const e=f(n);t[e.name]=e}return t}function f(e){const t=function(e,t){switch(e){case r.Number:return parseFloat(t);case r.Boolean:return Object(o.a)(t);case r.String:default:return t}}(e.DataType,e.Value);return{name:e.Name,dataType:e.DataType,value:t}}},"+XGO":function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n("i1f0"),a=n("TYIz"),i=n("eL7I"),o=n("PidC"),s=n("Lyxw"),c=n("dpM5"),l=n("SWZ5"),u=n("y60j"),d=n("zmL5"),p=n("jq7Z"),f=n("dHD5"),g=n("64CY");function h(e,t,n){const a=[{name:"controlName",value:n}];return{type:"control.setfocus",execute({dispatch:h,getState:b},y,_){var v,S;const O=b(),C=Object(p.a)(O,e);if(C.parentComponentId){const t=Object(p.a)(O,C.parentComponentId),n=Object(f.j)(b(),C.parentComponentId),i=null===(S=null===(v=t.formInstances)||void 0===v?void 0:v.controlNameByFormInstanceId)||void 0===S?void 0:S[e];if(i){const e=Object(r.E)(O,C.parentComponentId,i,n);m(O,C.parentComponentId,i,n,_,a,h,e.parentSectionName,e.domId)}}let E,{parentSectionName:I,domId:w}=Object(r.E)(O,e,n,t);if(m(O,e,n,t,_,a,h,I,w),I&&(E=Object(r.Ac)(O,e,I,t).parentTabId),!E){const a=Object(s.e)(O,c.k),l=Object(d.b)(O,e),u=Object(o.f)(O,{id:e},t,l);if(a&&u){const r=Object(o.i)()(O,{id:e,contextToken:t,formId:l});for(let e=0;e<r.length;e++)if(r[e].Name===n){document.getElementById(i.b).click();break}}if(!a){Object(r.zb)(O,e,t).has(n)&&document.getElementById(i.b).click()}}const j=Object(g.c)(n);if(j){const n=j[0],a=Object(r.E)(O,e,n,t);w=a.domId,I=a.parentSectionName}if(w){y.AccessibilityManager.getAccessibilityComponentStack(e).setClientAPISetFocusElementId(w);const t=Object(d.b)(O,e),a=Object(u.a)(O,e,t,n);if(a&&a.ParentSectionName&&a.ParentSectionName.startsWith(r.f)){const t={id:a.Id,title:a.Label,type:l.a};h(Object(l.b)(t,!1,e))}E&&y.IntersectionObserverManager.intersectAll(E)}return Promise.resolve()},getFailureParameters:(e,t)=>a}}function m(e,t,n,i,o,s,c,l,u){const d=Object(r.Ab)(e,t,n,i);s.push({name:"CorrelationId",value:o.correlationId},{name:"ContextId",value:o.contextId},{name:"ActionStack",value:o.stack},{name:"parentSectionName",value:l},{name:"hiddenTabName",value:d},{name:"domId",value:u}),d&&c(Object(a.b)(t,d,i))}},"+YnR":function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return u}));var r=n("dHD5"),a=n("WKRf"),i=n("uWQm"),o=n("SAYH"),s=n("SnEr"),c=n("69Qu");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function l(e,t,n,o){const l=e.getState(),u=Object(r.h)(t);e.dispatch(Object(a.b)(o,!0,u)),e.dispatch(Object(i.c)(n,Object(c.c)(l))),e.dispatch(Object(s.b)({etn:t,id:n}))}function u(e,t,n){const s=e.getState(),l=new Set;t.forEach(e=>l.add(e.entityType)),l.forEach(t=>{const i=Object(r.h)(t);e.dispatch(Object(a.b)(n,!0,i))}),e.dispatch(Object(i.d)(t.map(e=>o.a.parse(e.id)),Object(c.c)(s)))}},"+Zk2":function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"e",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s}));
/**
 * Constants for updateFieldValue.
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="control.update.value",a="Forms.UpdateFieldValue",i="transactioncurrencyid",o="Required",s="Forms.LargeImageFileAttribute"},"+baL":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("OKVy"),a=n("ruPX");function i(e,t,n,i,o,s,c){const l={navPath:e,dashboardId:t,etn:i,type:o,canOverride:s};return Object(a.a)(r.a,l,c,n)}},"+bek":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("arV0"),a=n("pF61"),i=n("E5IU");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function o(e){return{appId:Object(i.n)(e),pageInput:Object(r.j)(e,Object(a.c)(e))}}},"+cBJ":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));const r="setFormUserViewRetrievedAction";function a(e,t){return{type:r,payload:{entityLogicalName:e,retrieved:t}}}},"+cdD":function(e,t,n){"use strict";n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return u})),n.d(t,"d",(function(){return d}));var r=n("SAYH"),a=n("n3bs"),i=n("arV0"),o=n("zmL5"),s=n("Znsu");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const c=e=>null==e?void 0:e.msdyn_labelsresource,l=(e,t)=>!e.some(e=>e.type.toLowerCase()!==t),u=(e,t)=>{const n=Object(i.j)(e,t);switch(null==n?void 0:n.pageType){case a.a.ENTITY_RECORD:return r.a.toString(Object(o.b)(e,t));case a.a.ENTITY_LIST:return r.a.toString(n.viewId);case a.a.DASHBOARD:return r.a.toString(n.dashboardId);case a.a.CONTROL:return n.customControlId;default:return r.a.EMPTYGUIDSTRING}},d=(e,t,n)=>["",s.i,e,t,n].join(s.s)},"+hKY":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("3BuU");t.AWTPropertyType=r.AWTPropertyType,t.AWTPiiKind=r.AWTPiiKind,t.AWTEventPriority=r.AWTEventPriority,t.AWTEventsDroppedReason=r.AWTEventsDroppedReason,t.AWTEventsRejectedReason=r.AWTEventsRejectedReason,t.AWTCustomerContentKind=r.AWTCustomerContentKind;var a=n("sDlx");t.AWTUserIdType=a.AWTUserIdType,t.AWTSessionState=a.AWTSessionState;var i=n("GjO+");t.AWT_BEST_EFFORT=i.AWT_BEST_EFFORT,t.AWT_NEAR_REAL_TIME=i.AWT_NEAR_REAL_TIME,t.AWT_REAL_TIME=i.AWT_REAL_TIME;var o=n("1DaZ");t.AWTEventProperties=o.default;var s=n("X6wG");t.AWTLogger=s.default;var c=n("gFPh");t.AWTLogManager=c.default;var l=n("YiEf");t.AWTTransmissionManager=l.default;var u=n("9fhM");t.AWTSerializer=u.default;var d=n("XSLb");t.AWTSemanticContext=d.default,t.AWT_COLLECTOR_URL_UNITED_STATES="https://us.pipe.aria.microsoft.com/Collector/3.0/",t.AWT_COLLECTOR_URL_GERMANY="https://de.pipe.aria.microsoft.com/Collector/3.0/",t.AWT_COLLECTOR_URL_JAPAN="https://jp.pipe.aria.microsoft.com/Collector/3.0/",t.AWT_COLLECTOR_URL_AUSTRALIA="https://au.pipe.aria.microsoft.com/Collector/3.0/",t.AWT_COLLECTOR_URL_EUROPE="https://eu.pipe.aria.microsoft.com/Collector/3.0/",t.AWT_COLLECTOR_URL_USGOV_DOD="https://pf.pipe.aria.microsoft.com/Collector/3.0",t.AWT_COLLECTOR_URL_USGOV_DOJ="https://tb.pipe.aria.microsoft.com/Collector/3.0"},"+nNZ":function(e,t,n){"use strict";n.d(t,"g",(function(){return g})),n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"d",(function(){return d})),n.d(t,"e",(function(){return p})),n.d(t,"c",(function(){return f})),n.d(t,"h",(function(){return h})),n.d(t,"f",(function(){return l}));var r=n("eXjw"),a=n("SAYH"),i=n("5Oca"),o=n("iZ7K"),s=n("504W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function c(e,t){return e&&e.metadata&&e.metadata.businessProcessFlows&&t&&t.guid&&e.metadata.businessProcessFlows.hasOwnProperty(t.guid)?e.metadata.businessProcessFlows[t.guid]:null}function l(e,t){const n=Object(o.h)(e,t);return!!n&&(n.IsBusinessProcessEnabled||n.IsBPFEntity)}function u(e,t){const n=Object(i.b)(t)(e,t.etn);return n&&n.fields?n.fields:null}function d(e,t){const n=c(e,t);return n?n.initialized:r.a.Uninitialized}function p(e,t,n,r){if(e&&!a.a.isNullOrEmpty(t)&&n&&r){const a=c(e,t);if(a&&a.businessProcessFlowStepEntityAttributeControls&&a.businessProcessFlowStepEntityAttributeControls[n])return a.businessProcessFlowStepEntityAttributeControls[n][r]}return null}function f(e,t,n){var r,a,i;if(t&&n)return null===(i=null===(a=null===(r=c(e,t))||void 0===r?void 0:r.dependencies)||void 0===a?void 0:a.entitiesAndAttributes)||void 0===i?void 0:i[n.etn]}function g(e,t){const n=Object(i.b)(t)(e,t.etn);return n?n.processInstanceModifiedTimestamp:null}function h(e,t){return!(!e.metadata||!e.metadata.businessProcessFlows)&&(!Object(s.a)(e.metadata.businessProcessFlows[t])&&!Object(s.a)(e.metadata.businessProcessFlows[t].initialized)&&Object(r.b)(e.metadata.businessProcessFlows[t].initialized))}},"+nTZ":function(e,t,n){"use strict";n.d(t,"d",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return c}));var r=n("zsAz");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e){return e.dialogContexts}function i(e,t){const n=a(e)[t];if(!n)throw Object(r.d)("Dialog context does not exist",2415919107,[{name:"id",value:t}]);return n}function o(e,t){return s(e,t,!1)}function s(e,t,n){const r=a(e);for(const e in r){if(r[e].contentPageId===t)return r[e];if(r[e].pageStack&&-1!==r[e].pageStack.indexOf(t))return r[e];if(n&&r[e].previousPages&&-1!==r[e].previousPages.indexOf(t))return r[e]}return null}function c(e,t){return s(e,t,!0)}},"+pAH":function(e,t,n){"use strict";n.d(t,"a",(function(){return _})),n.d(t,"b",(function(){return C})),n.d(t,"c",(function(){return I})),n.d(t,"d",(function(){return y}));var r=n("SoYb"),a=n("Nb1E"),i=(n("lY/Z"),n("5Oca")),o=n("iZ7K"),s=n("LbMF"),c=n("qpML"),l=n("8nT0"),u=n("WPtp"),d=n("ZPAw"),p=n("/A0C"),f=n("SRlt"),g=n("NvOS"),h=n("bT7G"),m=n("i1f0"),b=n("np5s");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const y=16777216,_="File.State";class v{constructor(e,t){this.done=e,this.value=t}}class S{getCurrentIndex(){return this.currentIndex}getNextChunkFromServer(e){const t=[],n=E(this.attributeName,this.imageSizeResolution);t.push({name:"RequestUrl",value:n}),t.push({name:"FileSize",value:this.fileSize}),t.push({name:"ChunkSize",value:this.chunkSize}),t.push({name:"CurrentIndex",value:this.currentIndex});let r=null;if(0!==this.currentIndex||this.fileSize>this.chunkSize){let e=this.chunkSize;this.fileSize-this.currentIndex<this.chunkSize&&(e=this.fileSize-this.currentIndex);const n=this.currentIndex+e-1,a="bytes="+this.currentIndex+"-"+n;r={Range:a},t.push({name:"ChunkRange",value:a})}return this.dispatch(Object(a.d)(this.target,n,r,!0,void 0,void 0,e)).then(e=>(this.currentIndex=this.currentIndex+e.byteLength,t.push({name:"ChunkValueLengthReadFromFile",value:e.byteLength}),this.applicationContext.EventManager.ReportComponentSuccess("DownloadFile.ReadNextChunkFromServer",t),new Uint8Array(e))).catch(e=>{throw this.applicationContext.EventManager.ReportComponentFailure("DownloadFile.ReadNextChunkFromServer",e,"",t),e})}read(e){const t=[];return t.push({name:"FileSize",value:this.fileSize}),t.push({name:"ChunkSize",value:this.chunkSize}),t.push({name:"AttributeName",value:this.attributeName}),t.push({name:"EntityName",value:this.target.etn}),this.getNextChunkFromServer(e).then(e=>{t.push({name:"CurrentIndex",value:this.currentIndex});let n=!0;this.currentIndex<this.fileSize&&(n=!1),t.push({name:"ChunkValueLengthReadFromFile",value:e.length}),t.push({name:"IsFileReadComplete",value:n}),this.applicationContext.EventManager.ReportComponentSuccess("DownloadFile.ReadNextChunk",t);return new v(n,e)}).catch(e=>{throw t.push({name:"CurrentIndex",value:this.currentIndex}),this.applicationContext.EventManager.ReportComponentFailure("DownloadFile.ReadNextChunk",e,"",t),this.tracer.error("downloadFile : Failed to download file in single chunk case "),e})}}class O{getBinaryReader(e){0===e&&this.fileSize>y||this.fileSize>y&&e>4194304?e=4194304:0===e&&this.fileSize<=y&&(e=y);const t=new S;return t.imageSizeResolution=this.imageSizeResolution,t.fileSize=this.fileSize,t.mimeType=this.mimeType,t.attributeName=this.attributeName,t.dispatch=this.dispatch,t.tracer=this.tracer,t.target=this.target,t.chunkSize=e,t.applicationContext=this.applicationContext,t.currentIndex=0,this.textReader=t,t}}function C(e,t,n,r,a,i,o){return{type:_,payload:{identifier:e,attributeName:t,fileState:{fileProgress:n,operationType:c.a.Download,pageId:r,fileName:a,mimeType:i,fileSize:o}}}}function E(e,t){let n="";return n="/"+e+"/$value",t&&"full"===t&&(n=n+"?size="+t),n}function I(e,t,n,a,c){return{type:"FileDownload",sync:!0,execute({dispatch:_,getState:v},S){const C=v(),I=Object(m.hc)(C,n,a),w=Object(h.e)(C,I,t,e),j=Object(s.b)(e,t.etn,C);let P=l.j;const T=Object(d.a)(C,t,e,j);j===p.a.Image&&(P=l.i);const N=Object(i.z)(C,t,T,e);if(N&&w.value){const n=N.fields.hasOwnProperty(P)?Object(u.c)(N.fields[P]):null,a=N.fields.hasOwnProperty(l.r)?Object(u.c)(N.fields[l.r]):null,i=N.fields.hasOwnProperty(l.h)?Object(u.c)(N.fields[l.h]):null,s=new O;s.applicationContext=S,s.dispatch=_,s.tracer=S.TraceManager.getTracer("DownloadFile"),s.fileName=i,s.target=t,s.mimeType=a,s.fileSize=Object(r.b)(n),s.attributeName=e,j===p.a.Image&&c&&"full"===c&&(c=w.value.fullimageurl?"full":""),s.imageSizeResolution=c;const h=f.c.WEB_API_URL_FRAGMENT,m=Object(g.a)(C,h);if(Object(d.b)(C,t,e,!1))!function(e,t,n,r){const a=Object(b.a)(t);if(a){const t=n.fields.hasOwnProperty(l.c)?Object(u.c)(n.fields[l.c]):null;if(t&&(e.fileUrl=`${a}${t}`),r===p.a.Image){const t=n.fields.hasOwnProperty(l.d)?Object(u.c)(n.fields[l.d]):null;t&&(e.thumbnailUrl=`${a}${t}`)}}}(s,C,N,j);else if(Object(r.b)(n)>y)j===p.a.Image&&(s.thumbnailUrl=w.value.imageurl?new URL(w.value.imageurl.value,window.location.origin).href:null),s.fileUrl=Object(u.c)(N.fields[l.w]);else if(j===p.a.Image)s.thumbnailUrl=w.value.imageurl?new URL(w.value.imageurl.value,window.location.origin).href:null,s.fileUrl=w.value.fullimageurl?new URL(w.value.fullimageurl.value,window.location.origin).href:null;else{const n=Object(o.o)(C,t.etn),r=E(e);s.fileUrl=new URL(`${m}${n}(${t.id.guid})${r}`,window.location.origin).href}return s}return null}}}},"+qat":function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n("Rj8P"),a=n("TBkx"),i=n("yRo8"),o=n("eZ32"),s=n("8CLP"),c=n("RADj"),l=n("pEXn"),u=n("37s6"),d=n("6lVV");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function p(e){return{type:"offline.cancel.sync",execute({dispatch:t,getState:n},p){const f=p.OfflineProvider,g=p.TraceManager.getTracer(i.f),h=[];return f.cancelSync(e).nativePromise().then(()=>{const e=n(),a=Object(u.n)(e),f=Object(u.q)(e);if(h.push({name:l.b.IsForcedSync,value:a}),a||f)g.warn("OfflineCancelSyncAction.cancelSync: Successfully canceled forced sync",h),t(Object(d.g)(!1));else{const e=o.a.NotAvailable;t(Object(r.c)(e,s.a.None)),h.push({name:l.b.OfflineStatus,value:e});const n=!1,a=c.a.SyncPendingFromServer;t(Object(i.i)({syncStatus:a,metadataAvailable:n})),Object(i.j)(p,i.c,n),h.push({name:i.c,value:n}),Object(i.j)(p,i.d,a),h.push({name:i.d,value:a})}g.warn("OfflineCancelSyncAction.cancelSync: Successfully",h)}).catch(e=>{throw h.push({name:l.b.ErrorMessage,value:Object(a.f)(e)}),g.error("OfflineCancelSyncAction.cancelSync: Failure.",h),e})}}}},"+uwx":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return i}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="add.notificationToastV2Action",a="dismiss.toastNotification",i="dismiss.toastNotifications"},"+zAK":function(e,t,n){"use strict";n.d(t,"b",(function(){return a}));var r={createMarker:function(){},startStopwatch:function(){return function(){}},createRetroactiveStopwatch:function(){}},a=new(function(){function e(){this._creator=null}return e.prototype.setPerformanceHooks=function(e,t,n,r,a){this._creator=e,this._addKpi=t,this._addKpiOnIdle=n,this._trackWork=r,this._scheduleControlUpdate=a},e.prototype.createPerformanceEvent=function(e,t,n){return void 0===t&&(t=3),void 0===n&&(n="CustomControlsFramework"),this._creator&&t>2?this._creator(e,n):r},e.prototype.startLifecycleStopwatch=function(e,t,n){return this.createPerformanceEvent(e,void 0,"CustomControls").startStopwatch({controlId:t,manifestControlName:n})},e.prototype.addKeyPerformanceIndicator=function(e,t,n){this._addKpi&&this._addKpi(e,t,n)},e.prototype.addKeyPerformanceIndicatorOnIdle=function(e,t){this._addKpiOnIdle&&this._addKpiOnIdle(e,t)},e.prototype.trackWork=function(e){return this._trackWork?this._trackWork(e):function(){}},e.prototype.scheduleControlUpdate=function(e){this._scheduleControlUpdate?this._scheduleControlUpdate(e):e()},e}());t.a=a},"+zjj":function(e,t,n){"use strict";n.d(t,"a",(function(){return A})),n.d(t,"b",(function(){return N})),n.d(t,"g",(function(){return R})),n.d(t,"h",(function(){return q})),n.d(t,"e",(function(){return W})),n.d(t,"f",(function(){return M})),n.d(t,"c",(function(){return k})),n.d(t,"d",(function(){return V}));var r=n("iZ7K"),a=n("y60j"),i=n("arV0"),o=n("i1f0"),s=n("niX0"),c=n("NP1x"),l=n("Lyxw"),u=n("uNu9"),d=n("3/02");function p(e,t,n){let r=n.show?A.Displayed_HardcodedEntityAllowedInUCI:A.NotDisplayed_HardcodedEntityDisallowedInUCI;switch(n.entityName){case u.y:t.IsConnectionsEnabled||(r=A.NotDisplayed_ConnectionEntityNotEnabled);break;case u.tb:t.CanTriggerWorkflow||(r=A.NotDisplayed_ProcessionEntityCannotTriggerWorkflow);break;case u.e:t.CanTriggerWorkflow||(r=A.NotDisplayed_AsyncOperationEntityCannotTriggerWorkflow);break;case u.f:t.IsCustomizable||(r=A.NotDisplayed_AuditEntityIsNotCustomizable);break;case u.ub:(a=t).EntityLogicalName!==u.Ab&&a.EntityLogicalName!==u.Z&&a.EntityLogicalName!==u.Ib&&a.EntityLogicalName!==u.mb&&(r=A.NotDisplayed_ProductEntityAndRelatedEntityRelationshipNotValid);break;case u.S:(function(e,t){return t.IsDocumentManagementEnabled&&!Object(l.f)(e,d.vc)})(e,t)||(r=A.NotDisplayed_FeedbackEntityNotAllowedInUCI)}var a;n.displayStateReason=r}var f,g=n("dHD5"),h=n("3hnk"),m=n("2YQW"),b=n("X3qb"),y=n("YxC/"),_=n("IqkD"),v=n("0l0t"),S=n("p9KN"),O=n("7XzV"),C=n("504W"),E=n("NjDY"),I=n("hK10"),w=n("whN/"),j=n("69Qu"),P=n("zmL5"),T=n("jq7Z");!function(e){e[e.Metadata=0]="Metadata",e[e.Hardcoded=1]="Hardcoded"}(f||(f={}));const N={RelationshipMetadata:"RelatedMenu_LabelSource_RelationshipMetadata",EntityDisplayCollectionName:"RelatedMenu_LabelSource_EntityDisplayCollectionName",EntityDisplayName:"RelatedMenu_LabelSource_EntityDisplayName",ClientAPI:"RelatedMenu_LabelSource_ClientAPI",HardcodedRelationship:"RelatedMenu_LabelSource_HardcodedRelationship",FormDescriptorForCurrentUserLanguage:"RelatedMenu_LabelSource_FormDescriptorForCurrentUserLanguage",FormDescriptorForBaseLanguage:"RelatedMenu_LabelSource_FormDescriptorForBaseLanguage",FormDescriptorForEnglish:"RelatedMenu_LabelSource_FormDescriptorForEnglish",NavLinkFormDescriptorForCurrentUserLanguage:"NavLink_LabelSource_FormDescriptorForCurrentUserLanguage",NavLinkFormDescriptorForBaseLanguage:"NavLink_LabelSource_FormDescriptorForBaseLanguage",NavLinkFormDescriptorForEnglish:"NavLink_LabelSource_FormDescriptorForEnglish",NavLinkFormDescriptorNoTitle:"NavLink_LabelSource_FormDescriptorNoTitle"},A={Displayed_SetInFormDescriptor:{reason:"RelatedMenu_Displayed_SetInFormDescriptor",displayed:!0,canBeOverwritten:!0},Displayed_SetInRelationshipMetadata:{reason:"RelatedMenu_Displayed_SetInRelationshipMetadata",displayed:!0,canBeOverwritten:!0},Displayed_HardcodedEntityAllowedInUCI:{reason:"RelatedMenu_Displayed_HardcodedEntityAllowedInUCI",displayed:!0,canBeOverwritten:!1},Displayed_NavLink:{reason:"NavLink_Displayed",displayed:!0,canBeOverwritten:!0},NotDisplayed_ShowNavigationItemsOptionDisabled:{reason:"RelatedMenu_NotDisplayed_ShowNavigationItemsOptionDisabled",displayed:!1,canBeOverwritten:!1},NotDisplayed_RelatedEntityMetadataNotAvailableInUnifiedClient:{reason:"RelatedMenu_NotDisplayed_RelatedEntityMetadataNotAvailableInUnifiedClient",displayed:!1,canBeOverwritten:!1},NotDisplayed_HardcodedEntityDisallowedInUCI:{reason:"RelatedMenu_NotDisplayed_HardcodedEntityDisallowedInUCI",displayed:!1,canBeOverwritten:!1},NotDisplayed_SetByClientAPI:{reason:"RelatedMenu_NotDisplayed_SetByClientAPI",displayed:!1,canBeOverwritten:!0},NotDisplayed_NotEnabledForUnifiedClient:{reason:"RelatedMenu_NotDisplayed_NotEnabledForUnifiedClient",displayed:!1,canBeOverwritten:!1},NotDisplayed_RelatedEntityNotInOfflineProfile:{reason:"RelatedMenu_NotDisplayed_RelatedEntityNotInOfflineProfile",displayed:!1,canBeOverwritten:!1},NotDisplayed_SetInFormDescriptor:{reason:"RelatedMenu_NotDisplayed_SetInFormDescriptor",displayed:!1,canBeOverwritten:!0},NotDisplayed_SetInRelationshipMetadata:{reason:"RelatedMenu_NotDisplayed_SetInRelationshipMetadata",displayed:!1,canBeOverwritten:!0},NotDisplayed_IsBPFEntity:{reason:"RelatedMenu_NotDisplayed_IsBPFEntity",displayed:!1,canBeOverwritten:!1},NotDisplayed_SPDocumentNotConfigured:{reason:"RelatedMenu_NotDisplayed_SPDocumentNotConfigured",displayed:!1,canBeOverwritten:!1},NotDisplayed_NotCustomOrConfigurableSystemRelationship:{reason:"RelatedMenu_NotDisplayed_NotCustomOrConfigurableSystemRelationship",displayed:!1,canBeOverwritten:!1},NotDisplayed_NoReadPermissionOnRelatedEntity:{reason:"RelatedMenu_NotDisplayed_NoReadPermissionOnRelatedEntity",displayed:!1,canBeOverwritten:!1},NotDisplayed_KnowledgeManagementNotEnabled:{reason:"RelatedMenu_NotDisplayed_KnowledgeManagementNotEnabled",displayed:!1,canBeOverwritten:!1},NotDisplayed_ConnectionEntityNotEnabled:{reason:"RelatedMenu_NotDisplayed_ConnectionEntityNotEnabled",displayed:!1,canBeOverwritten:!1},NotDisplayed_ProcessionEntityCannotTriggerWorkflow:{reason:"RelatedMenu_NotDisplayed_ProcessionEntityCannotTriggerWorkflow",displayed:!1,canBeOverwritten:!1},NotDisplayed_AsyncOperationEntityCannotTriggerWorkflow:{reason:"RelatedMenu_NotDisplayed_AsyncOperationEntityCannotTriggerWorkflow",displayed:!1,canBeOverwritten:!1},NotDisplayed_AuditEntityIsNotCustomizable:{reason:"RelatedMenu_NotDisplayed_AuditEntityIsNotCustomizable",displayed:!1,canBeOverwritten:!1},NotDisplayed_ProductEntityAndRelatedEntityRelationshipNotValid:{reason:"RelatedMenu_NotDisplayed_ProductEntityAndRelatedEntityRelationshipNotValid",displayed:!1,canBeOverwritten:!1},NotDisplayed_FeedbackEntityNotAllowedInUCI:{reason:"RelatedMenu_NotDisplayed_FeedbackEntityNotAllowedInUCI",displayed:!1,canBeOverwritten:!1},NotDisplayed_HardcodedRelationshipNameAndReferencingEntityNotFound:{reason:"RelatedMenu_NotDisplayed_HardcodedRelationshipNameAndReferencingEntityNotFound",displayed:!1,canBeOverwritten:!1}};function R(e){return!e||e.displayed}function D(e,t){!e||e.displayStateReason&&!e.displayStateReason.canBeOverwritten||(e.displayStateReason=t)}function x(e,t){if(e&&t){const n={},r=function(e){const t={};if(t[v.b]=0,t[v.f]=1,t[v.g]=2,t[v.d]=3,t[v.c]=4,t[v.a]=5,t[v.e]=6,e&&e.Navigation&&e.Navigation.navBarAreas&&Object.keys(e.Navigation.navBarAreas).length>0){const n=[];Object.keys(e.Navigation.navBarAreas).filter((e,t,n)=>n.indexOf(e)===t).forEach(e=>{n.push(Object(c.a)(e))});const r=Object.keys(t).filter(e=>n.indexOf(e)<0);n.concat(r).forEach((e,n)=>{t[e]=n})}return t}(e);for(const e of t)n[e]=r[e];return Object.keys(n).sort((e,t)=>n[e]-n[t])}return t}function M(){let e=null,t=null;return function(n,r){var i;const s=r.getAllMenuItemsForFormChecker,l=[],u=!0===r.isFromInitializeAction,d=r.id,p=Object(P.b)(n,d),f=Object(a.h)(n,p),g=f&&f.EntityLogicalName,h=Object(_.x)(n),v=h?h.languageId:null,S=!Object(j.c)(n),O=Object(o.ec)(n),C=L(n,d,s).concat(k(n,d,s)),E=function(e,t,n,r){const a=[];if(n&&n.Navigation&&n.Navigation.navBarAreas&&n.Navigation.navBarByRelationshipItems){const e=Object.keys(n.Navigation.navBarByRelationshipItems),t=Object.keys(n.Navigation.navBarAreas);for(let i=0;i<e.length;i++){const o=n.Navigation.navBarByRelationshipItems[e[i]];if(o){let e;for(let r=0;r<t.length;r++)n.Navigation.navBarAreas[t[r]].id===o.area&&(e=Object(c.a)(n.Navigation.navBarAreas[t[r]].id));const i=Object(I.b)(o,r),s={areaId:e,id:o.id,title:i?i.Value:null,labelSource:i?N.FormDescriptorForCurrentUserLanguage:null,show:o.show,displayStateReason:o.show?A.Displayed_SetInFormDescriptor:A.NotDisplayed_SetInFormDescriptor,relationshipName:o.relationshipName,sequence:parseInt(o.sequence,10)};a.push(s)}}}return a}(0,0,f,v),w=Object(y.b)(n,b.f),T=Object(y.b)(n,b.e);if(C&&E)for(const e of C){const t=E.find(t=>t.relationshipName&&e.relationshipName&&t.areaId===e.areaId?t.relationshipName===e.relationshipName:t.id===e.id),r=F(n,d,g,S,O,u,s,!1,e,t);r&&l.push(r)}const R=z(n,d,f);if(R&&R.length>0)for(const e of R){const t=F(n,d,g,S,O,u,null,!0,e);t&&l.push(t)}let D=!1;if(null==e||e.length!==l.length)D=!0;else for(let r=0;r<l.length;r++){if(!Object(m.e)(e[r],l[r])){D=!0;break}const a=G(n,null===(i=l[r])||void 0===i?void 0:i.areaId,f,v),o=String.format(T,w,a.areaName);if(!t.some(e=>e.areaName===o)){D=!0;break}}if(D&&l)if(0===l.length)0!==(null==t?void 0:t.length)&&(t=[]);else{e=l;const r=l.reduce((e,t)=>(-1===e.indexOf(t.areaId)&&e.push(t.areaId),e),[]);t=x(f,r).map(e=>{const t=l.filter(t=>t.areaId===e),r=G(n,e,f,v);return{areaName:String.format(T,w,r.areaName),previewId:r.previewId,relatedItems:(a=t,a?a.sort((e,t)=>e.sequence-t.sequence):[])};var a})}return t}}function F(e,t,n,a,i,s,c,l,u,d){if(!u&&!d)throw Error("relatedItemFromRelationship and relatedItemOnForm cannot be both null.");if(u&&!Object(h.b)(e,u.entityName)&&!u.url)return D(u,A.NotDisplayed_NotEnabledForUnifiedClient),c?u:null;if(a&&i&&(d&&d.entityName&&!i.has(d.entityName)||u&&u.entityName&&!i.has(u.entityName))){let e;return d&&d.entityName?(e=d,e.relationshipSource=null==u?void 0:u.relationshipSource):e=u,D(e,A.NotDisplayed_RelatedEntityNotInOfflineProfile),c?e:null}if(u&&1===u.relationshipType&&n===u.entityName){const n=Object(o.Zb)(e,t,u.id);return n?(Object(C.a)(n.show)||n.showSetByClientAPI&&D(u,(null==n?void 0:n.show)?A.Displayed_SetByClientAPI:A.NotDisplayed_SetByClientAPI),n.show?u:null):u}if(d){if(!1===d.show)return D(d,A.NotDisplayed_SetInFormDescriptor),d.relationshipSource=null==u?void 0:u.relationshipSource,c?d:null}else if(!1===u.show)return D(u,A.NotDisplayed_SetInRelationshipMetadata),c?u:null;const p=u||d;l&&(D(p,A.Displayed_NavLink),p.show=!0);const f=Object(o.Zb)(e,t,p.id);null!==(null==f?void 0:f.show)&&void 0!==(null==f?void 0:f.show)?((null==f?void 0:f.showSetByClientAPI)&&D(p,(null==f?void 0:f.show)?A.Displayed_SetByClientAPI:A.NotDisplayed_SetByClientAPI),p.show=null==f?void 0:f.show):d?(p.show=!1!==d.show,D(p,p.show?A.Displayed_SetInFormDescriptor:A.NotDisplayed_SetInFormDescriptor)):(p.show=!1!==u.show,D(p,p.show?A.Displayed_SetInRelationshipMetadata:A.NotDisplayed_SetInRelationshipMetadata)),d&&d.areaId&&(p.areaId=d.areaId);const g=p.entityName?Object(r.h)(e,p.entityName):null,m=Object(o.Yb)(e,t,p.id,g&&g.DisplayCollectionName);return!s&&m&&m.label?(p.title=m.label,d&&d.title&&(p.labelSource=m.labelSource)):d&&d.title&&(p.title=d.title,p.labelSource=d.labelSource),(null==f?void 0:f.labelSetByClientAPI)&&(p.labelSource=N.ClientAPI),d&&d.sequence>=0&&(p.sequence=d.sequence),l&&(p.labelSource=null==m?void 0:m.labelSource),p.previewId=null==m?void 0:m.previewId,p.ordinal=d&&d.ordinal?d.ordinal:u?u.ordinal:w.a.Referencing,p}function k(e,t,n){let a=[];const i=H(e,t);if(i){const t=Object(c.d)(e,i.EntityLogicalName,n),o=Object(c.c)(e,i.EntityLogicalName,n);a=t.concat(o).map(t=>{const n=Object(r.h)(e,t.entityName);return{areaId:t.areaId,id:t.id,entityName:t.entityName,title:t.title,labelSource:t.labelSource,relationshipName:t.relationshipName,icon:n?n.EntityIcon:"",isCustomEntity:n?n.IsCustomEntity:void 0,sequence:t.order,show:t.show,ordinal:t.ordinal,webResourceIcon:n&&n.IconVectorName?Object(E.x)(e)+n.IconVectorName:void 0,relationshipType:t.relationshipType,displayStateReason:t.displayStateReason,relationshipSource:f.Metadata}})}return a}function L(e,t,n){const a=[],i=Object(s.c)(e),o=H(e,t);if(o){const c=o.IsCustomEntity?u.lb:o.EntityLogicalName,l=Object(s.b)(e,c,o.EntityLogicalName);for(const s of i){if(p(e,o,s),!n&&s.displayStateReason!==A.Displayed_HardcodedEntityAllowedInUCI)continue;if(!B(e,s,n))continue;const i=Object(r.h)(e,s.entityName),c=i&&i.EntityIcon?i.EntityIcon:o.EntityIcon,l=U(e,t,o.EntityLogicalName,s,n,c);l&&a.push(l)}for(const r of l){if(r.displayStateReason=r.show?A.Displayed_HardcodedEntityAllowedInUCI:A.NotDisplayed_HardcodedEntityDisallowedInUCI,!B(e,r,n))continue;const i=e&&e.metadata&&e.metadata.entities;let s=o.EntityIcon;if(i&&!Object(C.a)(i[r.entityName])){const e=i[r.entityName].EntityIcon;e&&(s=e)}const c=U(e,t,o.EntityLogicalName,r,n,s);c&&a.push(c)}}return a}function B(e,t,n){return Object(r.h)(e,t.entityName)?Object(h.g)(e,t.entityName,2,0)||(t.displayStateReason=A.NotDisplayed_NoReadPermissionOnRelatedEntity):t.displayStateReason=A.NotDisplayed_RelatedEntityMetadataNotAvailableInUnifiedClient,n||R(t.displayStateReason)}function U(e,t,n,a,i,o){const c=Object(s.a)(e,n,a.entityName,a.id);if(i||c){const t=a.title?a.title:Object(r.e)(e,a.entityName),n=a.title?N.HardcodedRelationship:N.EntityDisplayCollectionName;return{areaId:a.areaId,id:a.id,entityName:null==c?void 0:c.referencingEntity,title:t,relationshipName:null==c?void 0:c.relationshipName,icon:o,sequence:a.order,show:a.show,relationshipType:a.relationshipType,displayStateReason:a.displayStateReason&&R(a.displayStateReason)&&!c?A.NotDisplayed_HardcodedRelationshipNameAndReferencingEntityNotFound:a.displayStateReason,relationshipSource:f.Hardcoded,labelSource:n}}}function V(e,t,n){let r=k(e,t).find(e=>e.id===n);return r||(r=function(e,t,n){const r=Object(P.b)(e,t),i=Object(a.h)(e,r);return z(e,t,i).find(e=>e.id===n)}(e,t,n),r||(r=L(e,t,!1).find(e=>e.id===n),r))}function z(e,t,n){var r;const a=[];if(n&&n.Navigation&&n.Navigation.navBarAreas&&n.Navigation.navBarItems){const i=Object.keys(n.Navigation.navBarItems);for(let s=0;s<i.length;s++){const l=n.Navigation.navBarItems[i[s]];if(l){const n=l.area?Object(c.a)(l.area):null,i=null===(r=Object(o.Yb)(e,t,l.id))||void 0===r?void 0:r.label,s=/^\$webresource:/i,u=l.url?l.url.replace(s,""):null;let d=null;l.icon&&l.icon.includes("$webresource")&&(d=Object(E.x)(e)+l.icon.replace(s,""));const p={areaId:n,id:l.id,title:i,url:u,webResourceIcon:d,sequence:parseInt(l.sequence,10),availableOffline:l.availableOffline,show:l.show};a.push(p)}}}return a}function q(e,t){const n=Object(P.b)(e,t.id),r=Object(a.h)(e,n);return r&&r.ShowNavigationBar}function H(e,t){const n=Object(i.j)(e,t);return n?Object(r.h)(e,n.entityTypeName):null}function W(e,t,n){const r=Object(T.a)(e,t.id),a=Object(g.w)(n);if(r&&r.forms&&r.forms[a]){const n=r.forms[a].selectedRelatedEntity;let i=n;if(n){const s=Object(o.Xb)(e,t.id,n.id);s&&i.title!==s&&(i=Object.assign({},r.forms[a].selectedRelatedEntity),i.title=s)}return i}return null}function G(e,t,n,r){let a;switch(t){case v.b:return a=Object(y.b)(e,S.d),K(O.c,n,r)||K(O.b,n,r)||{areaName:a,previewId:a};case v.f:return a=Object(y.b)(e,S.s),K(O.h,n,r)||{areaName:a,previewId:a};case v.g:return a=Object(y.b)(e,S.t),K(O.i,n,r)||{areaName:a,previewId:a};case v.d:return a=Object(y.b)(e,S.h),K(O.e,n,r)||{areaName:a,previewId:a};case v.c:return a=Object(y.b)(e,S.g),K(O.d,n,r)||{areaName:a,previewId:a};case v.e:case v.a:return a=Object(y.b)(e,S.n),K(O.f,n,r)||K(O.g,n,r)||K(O.a,n,r)||{areaName:a,previewId:a};default:return a=Object(y.b)(e,S.d),K(O.c,n,r)||K(O.b,n,r)||{areaName:a,previewId:a}}}function K(e,t,n){if(t&&t.Navigation&&t.Navigation.navBarAreas&&t.Navigation.navBarAreas[e]){const r=t.Navigation.navBarAreas[e].titles,a=t.Navigation.navBarAreas[e].PreviewId;if(r)for(let e=0;e<=Object.keys(r).length;e++){const t=r[e];if(!Object(C.a)(t)&&n&&t.LCID===n)return{areaName:t.text,previewId:a}}}return null}},"/2Q6":function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n("fA3V"),a=n("pEXn"),i=n("zsAz"),o=n("TBkx");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const s={getName:()=>r.a,getRequiredAttributes(){throw new Error("Not Implemented")},throwIfInvalidUrl(e){if(!e||!e.webresourceName)throw Object(i.d)("Missing required URL parameter: webresourceName",o.b)},createPageModule:e=>Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(7),n.e(10),n.e(4),n.e(5),n.e(6),n.e(9),n.e(8),n.e(11),n.e(12),n.e(13),n.e(14),n.e(15),n.e(174)]).then(n.bind(null,"Uhz3")).then(({WebResource:t})=>new t(e)),getTelemetryAttributes:e=>[{name:a.b.WebResourceName,value:e?e.webresourceName:""}]};Object.freeze(s);var c=n("D+Bz"),l=n("xagu"),u=n("Uv1Y");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const d={type:c.a.Page,pageType:"webresource",factory:s,urlToInput(e){const t=e.searchParams,n=t.get(l.hb),r=t.get(l.i),a={webresourceName:n};if(r){const e={webresourceData:r};a.webresourceData=e}return a},inputToUrl(e,t){const n=new URL(e,window.location.origin),r=n.searchParams;return r.set(l.hb,t.webresourceName),t.webresourceData&&t.webresourceData[l.gb]&&r.append(l.i,t.webresourceData[l.gb]),n.href},inputToWebUrl(e,t){throw new u.a("not supported",2147746581)}}},"/60z":function(e,t,n){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.FilterType=t.SortDirection=t.GRID_CSS_CLASS_NAMES=t.COL_HEADER_KEYPRESS_EVENT=t.ROW_STATUS=t.RECID=void 0,t.RECID="__rec_id",t.ROW_STATUS="__row_status",t.COL_HEADER_KEYPRESS_EVENT="__pa_grid_header_keypress_event",t.GRID_CSS_CLASS_NAMES={selectedRow:"ag-row-selected",hoveredRow:"ag-row-hover"},function(e){e[e.None=-1]="None",e[e.Asc=0]="Asc",e[e.Desc=1]="Desc"}(t.SortDirection||(t.SortDirection={})),function(e){e.set="set",e.text="text",e.number="number",e.date="agDateColumnFilter"}(t.FilterType||(t.FilterType={}))},"/6en":function(e,t,n){"use strict";n.d(t,"e",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"f",(function(){return s})),n.d(t,"g",(function(){return c})),n.d(t,"h",(function(){return l})),n.d(t,"d",(function(){return u}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="None",a="Completed",i="Downloading",o="Error",s="Suspended",c="Waiting",l="WaitingForTransfer",u="Idle"},"/A0C":function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e.Boolean="boolean",e.Unknown="unknown",e.Customer="customer",e.Date="date",e.DateTime="datetime",e.Decimal="decimal",e.Double="double",e.Image="image",e.Integer="integer",e.Lookup="lookup",e.ManagedProperty="managedproperty",e.Memo="memo",e.Money="money",e.OptionSet="optionset",e.Owner="owner",e.PartyList="partylist",e.PickList="picklist",e.State="state",e.Status="status",e.String="string",e.UniqueIdentifier="uniqueidentifier",e.CalendarRules="calendarrules",e.Virtual="virtual",e.BigInt="bigint",e.EntityName="entityname",e.EntityImage="entityimage",e.AliasedValue="aliasedvalue",e.Regarding="regarding",e.MultiSelectPickList="multiselectpicklist",e.File="file",e.NavigationProperty="navigationproperty"}(r||(r={}))},"/BiW":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="ApplyApplicationMetadataChangesNavigationHandler",a="Offline"},"/D1P":function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.Pending=0]="Pending",e[e.InProgress=1]="InProgress",e[e.Completed=2]="Completed"}(r||(r={}))},"/Ikn":function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i}));var r=n("MOEv");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t){return`${r.a}${e}button${t}`}function i(e,t,n,r){n=n||[];for(const i in n){const n=a(t,i);r.doesOnClickEventExist(e,n)&&r.getOnClickEvents(e,n).forEach(t=>r.removeOnClickEvent(e,n,t))}}},"/J/l":function(e,t,n){"use strict";n.d(t,"e",(function(){return r})),n.d(t,"g",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"f",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return l}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="execute.updatecurrentsearchtext",a="execute.updatesearchresults",i="execute.searchwidgetactions.openresult",o="execute.searchwidgetactions.selectedresult",s="execute.updatenumberofresults",c="execute.searchwidgetactions.changeselectedmenu",l="execute.updateblockresults"},"/JYk":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("SRlt"),a=n("JdSN");function i(e,t){return{type:"DESERIALIZE_GET_CLIENT_METADATA_RESPONSE_ASYNC",execute:({dispatch:t,getState:n},i)=>Object(r.g)(e).then(e=>{if(e.Metadata)return JSON.parse(e.Metadata);if(e instanceof a.a)throw e;return{}})}}},"/KPo":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("504W");class a{constructor(e,t){this._serverVersion=null,this._databaseVersion=null,this._serverVersion=Object(r.b)(e)?"":e,this._databaseVersion=Object(r.b)(t)?"":t}get_serverVersion(){return this._serverVersion}get_databaseVersion(){return this._databaseVersion}getObjectData(){const e={};return e.serverversion=this._serverVersion,e.databaseversion=this._databaseVersion,e}static createFromObjectData(e){const t=e.serverversion,n=e.databaseversion;return new a(t,n)}}},"/Ndy":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("504W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class a{constructor(e,t,n){this._request=null,this._error=null,this._request=e,this._error=n}get_request(){return this._request}get_error(){return this._error}get_message(){return this.get_responseMessage()}get_responseMessage(){return Object(r.a)(this._request)||4!==this._request.readyState?"":this._request.responseText}}a.HtmlHeader="<!DOCTYPE html"},"/Viv":function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n("/oKV"),a=n("BSqk"),i=n("504W"),o=n("2F73"),s=n("0lM4");class c extends s.a{constructor(e,t,n,r){super(e,n,r),this._columnSet=null,this._columnSet=Object(i.a)(t)?o.a.get_instance():t}getColumnSet(){return this._columnSet}}class l{constructor(){this._localRetrievePromises={},this._remoteRetrievePromises={},this._localAndRemoteRetrievePromises={}}put(e,t,n,a,i){let o="Key: "+t+"; ColumnSet: "+JSON.stringify(n)+"; RetrievalStrategy: "+r.a[a];if(i){o=o+", ClientRequestId: "+i.RequestId(),i.AppendCallStack("DataSource._PutInternal")}switch(a){case r.a.Remote:this._PutInternal(this._remoteRetrievePromises,e,t,n,o,i);break;case 0:this._PutInternal(this._localRetrievePromises,e,t,n,o,i);break;case r.a.LocalAndRemote:this._PutInternal(this._localAndRemoteRetrievePromises,e,t,n,o,i);break;default:throw Error.argumentOutOfRange("retrievalStrategy",a,"Unknown retrieve strategy")}}_PutInternal(e,t,n,r,i,o){const s=JSON.stringify(r);let l=null;n in e?l=e[n]:(l=new a.a,e[n]=l),l.put(s,new c(t,r,i,"PutInternal"),o)}get(e,t,n){switch(n){case r.a.Remote:return this._GetInternal(this._remoteRetrievePromises,e,t);case 0:return this._GetInternal(this._localRetrievePromises,e,t);case r.a.LocalAndRemote:return this._GetInternal(this._localAndRemoteRetrievePromises,e,t);default:throw Error.argumentOutOfRange("retrievalStrategy",n,"Unknown retrieve strategy")}}_GetInternal(e,t,n){const r=JSON.stringify(n);if(!(t in e))return null;const a=e[t];if(a.containsKey(r))return a.get(r).getPromise();const i=a.get_values();for(const e of i)if(e.getColumnSet().getDifference(n).get_isEmpty())return e.getPromise();return null}}},"/XAI":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));class r{constructor(e,t,n){this._bias=0,this._timeZoneCode=0,this._userInterfaceName=null,this._bias=e,this._timeZoneCode=t,this._userInterfaceName=n}get_Bias(){return this._bias}get_TimeZoneCode(){return this._timeZoneCode}get_UserInterfaceName(){return this._userInterfaceName}getObjectData(){const e={};return e.bias=this._bias,e.timezonecode=this._timeZoneCode,e.userinterfacename=this._userInterfaceName,e}static createFromObjectData(e){const t=e.bias,n=e.timezonecode,a=e.userinterfacename;return new r(t,n,a)}}},"/Ypj":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));class r{constructor(e,t){this._callId=null,this._dispatcher=null,this._callId=e,this._dispatcher=t}get_callId(){return this._callId}get_nativeMethodDispatcher(){return this._dispatcher}static get_dispatcherCallIdName(){return"dispatcherCallId"}static get_shimDispatcherPerfDataPlaceHolderName(){return"ShimPerfDataPlaceHolder"}}},"/Zy9":function(e,t,n){"use strict";n.d(t,"b",(function(){return b})),n.d(t,"a",(function(){return y})),n.d(t,"c",(function(){return v})),n.d(t,"d",(function(){return O}));var r=n("SAYH"),a=n("TFb5"),i=n("KBcj"),o=n("zsAz"),s=n("whN/"),c=n("iZ7K"),l=n("q/4y"),u=n("sZ+8"),d=n("WWG3"),p=n("LbMF"),f=n("/A0C"),g=n("d0w6"),h=n("fYtF"),m=n("504W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const b=25,y=1,_="ModernQueryBuilder: getState function not provided.";class v{constructor(e){this._query=e?Object.assign({},e):{},this._query.selects=this._query.selects||[],this._selectsInKey=this._query.selects?this._query.selects.map(e=>!0):[],this._query.linkEntities=this._query.linkEntities||[],this._query.sorts=this._query.sorts||[],this._query.wheres=this._query.wheres||[],this._query.contextFiltersAndIds=this._query.contextFiltersAndIds||[],this._query.childCountAttributes=this._query.childCountAttributes||[],this._query.searchString=this._query.searchString||"",this._query.isQuickFindSearch=this._query.isQuickFindSearch||!1,this._isFetchXmlParsed=!1,this._isFetchXmlModified=!1,this._resetSort=!1,this._queryStatus=[]}get fetchDocument(){return this._isFetchXmlParsed||this._parseFetchXmlFromString(this._query.fetchXml),this._fetchDocument}_parseFetchXmlFromString(e){e&&(this._fetchDocument=Object(a.w)(e),this._isFetchXmlParsed=!0)}static fromView(e,t){const n=new v;return n._query.viewId=e,n._query.searchString=t||"",n._query.isQuickFindSearch=!!t,n}static fromXml(e,t,n){const r=new v;return r._query.fetchXml=e,r._query.viewId=t,r._query.searchString=n,r._query.isQuickFindSearch=!!n,r}static fromState(e){const t=new v(e);return t._isFetchXmlModified=!(!e.fetchXml||!e.viewId),t}select(...e){const t=[];for(let n=0;n<e.length;n++)-1===this._query.selects.indexOf(e[n])&&t.push(e[n]);return this._query.selects.push(...t),this._selectsInKey.push(...t.map(e=>!0)),this}selectInternal(e,t=!0){return-1===this._query.selects.indexOf(e)&&(this._query.selects.push(e),this._selectsInKey.push(t)),this}addLinkedEntity(e,t,n){const r=Object(a.i)(e,t,n);return this._query.linkEntities.push(r),this}orderBy(e,t=!1,n=!0){return e&&(this._query.sorts.push(e+(t?" desc":" asc")),this._resetSort=n),this}addChildCountAttribute(e){return this._query.childCountAttributes.push(e),this}applyContextFilter(e,t,n,o=s.a.Referencing){var l,u,d;if(Object(m.a)(t))null===(d=h.b.tracer)||void 0===d||d.warn("ModernQueryBuilder: The contextId provided for applyContextFilter is null. Relationship name: "+e);else{this._query.entityLogicalName||(this._query.entityLogicalName=this._query.viewId&&(null===(l=Object(i.c)(n,this._query.viewId))||void 0===l?void 0:l.entityLogicalName)||Object(a.r)(this.fetchDocument));const d=Object(c.K)(n,this._query.entityLogicalName,e);if(Object(m.a)(d))throw null===(u=h.b.tracer)||void 0===u||u.error("ModernQueryBuilder: Invalid relationship was passed. Relationship name: "+e),new Error("Passed in relationship could not be found for the entity");Object(m.a)(o)?this._query.contextFiltersAndIds.push(`${e} ${r.a.toString(t)}`):this._query.contextFiltersAndIds.push(`${e} ${r.a.toString(t)} ${s.a[o].toLowerCase()}`)}return this}where(e,t,n){const r=l.a.toLegacyFilterExpression(e,n).toFetchXml();return this._query&&this._query.wheres&&this._query.wheres.push(r),this._query.expression?this._query.expression.terms.push(e):this._query.expression=new l.a(l.b.and,e),this}mergeQuickFind(e){return this._query.mergeQuickFindViewId=e,this}toFetchXml(e){var t,n;if(this._isFetchXmlModified&&this.fetchDocument&&this._query.viewId&&e&&(this._fetchDocument=void 0,this._isFetchXmlModified=!1,this._isFetchXmlParsed=!1,this._query.fetchXml=void 0,(null===(t=this._query.sorts)||void 0===t?void 0:t.length)>0&&(this._resetSort=!0)),function(e,t){if(!e.pageNumber)if(e.skipPagingDefaults){const n=Object(a.t)(t);isNaN(n)||(e.pageNumber=n)}else e.pageNumber=y;if(!e.pageSize)if(e.skipPagingDefaults){const n=Object(a.u)(t);isNaN(n)||(e.pageSize=n)}else e.pageSize=b;e.useModernQueryBuilder=!0}(this._query,this.fetchDocument),!this.fetchDocument){if(!e)throw Object(o.d)(_);{const t=e();if(!this._query.viewId)throw Object(o.d)("ModernQueryBuilder: view id not provided to retrieve fetch xml for the view");const n=Object(i.c)(t,this._query.viewId);if(!n)throw Object(o.d)("ModernQueryBuilder: view not found in the state");this._parseFetchXmlFromString(n.fetchXML),this._query.entityLogicalName||(this._query.entityLogicalName=n.entityLogicalName)}}if(!this.fetchDocument)return null===(n=h.b.tracer)||void 0===n||n.error("ModernQueryBuilder: fetch xml not provided"),"";this._applyModificationsToFetchXml(e),Object(a.z)(this.fetchDocument,this._query.pageSize,this._query.pageNumber,this._query.pagingCookie,true,false);return(new XMLSerializer).serializeToString(this.fetchDocument)}getQueryState(e){return this._query.fetchXml=this.toFetchXml(e),this._query.entityLogicalName||(this._query.entityLogicalName=Object(a.r)(this.fetchDocument)),e&&!Object(u.n)(e(),this._query.entityLogicalName)&&this.queryStatus.push({failed:!0,offlineModeSpecific:!0,message:"Error.MainEntity.NotAvailable.Offline",parameter:this._query.entityLogicalName}),this._query.key=this.getKey(),this._query.publicKey=this.getPublicKey(),Object(a.v)(this.fetchDocument)&&(this._query.isAllColumns=!0),this._query.columnNames=Object(a.q)(this.fetchDocument),e&&this._query.viewId&&(this._query.isCustomView=!0===Object(i.c)(e(),this._query.viewId).isCustomView),this._query}set skipPagingDefaults(e){this._query.skipPagingDefaults=e}get skipPagingDefaults(){return this._query.skipPagingDefaults}get pageSize(){return this._query.pageSize}set pageSize(e){this._query.pageSize=e}set pageNumber(e){this._query.pageNumber=e}get pageNumber(){return this._query.pageNumber}get pagingCookie(){return this._query.pagingCookie}set pagingCookie(e){this._query.pagingCookie=e}getKey(){const e=this._query.mergeQuickFindViewId?r.a.toString(this._query.mergeQuickFindViewId):"";return`${this._getBaseKey()}: ${this._query.selects.filter((e,t)=>this._selectsInKey[t])}: ${this._query.wheres}: ${this._query.sorts}: ${this._query.contextFiltersAndIds}: ${this._query.linkEntities}: ${this._query.isQuickFindSearch}: ${this._query.searchString}: ${e}: ${this._query.pageSize}`}getPublicKey(){const e=this._query.mergeQuickFindViewId?r.a.toString(this._query.mergeQuickFindViewId):"";return`${this._getBaseKey()}: ${this._query.selects.filter((e,t)=>this._selectsInKey[t])}: ${this._query.sorts}: ${this._query.contextFiltersAndIds}: ${this._query.linkEntities}: ${this._query.isQuickFindSearch}: ${e}: ${this._query.pageSize}`}_getBaseKey(){return this._query.viewId?`${this._query.entityLogicalName}-${r.a.toString(this._query.viewId)}`:r.a.toString(this._query.viewId)}get queryStatus(){return this._queryStatus}_applyModificationsToFetchXml(e){if(this._query.linkEntities.length>0&&this._query.linkEntities.forEach(e=>Object(a.e)(this.fetchDocument,e)),this._query.selects.length>0&&(Object(a.v)(this.fetchDocument)||Object(a.b)(this.fetchDocument,this._query.selects)),this._query.wheres&&this._query.wheres.length>0&&this._query.wheres.forEach(e=>Object(a.d)(this.fetchDocument,e)),this._resetSort&&Object(a.y)(this.fetchDocument),this._query.sorts.length>0&&this._query.sorts.forEach(e=>{const t=e.split(" ");Object(a.g)(this.fetchDocument,t[0],"desc"===t[1])}),this._query.childCountAttributes.length>0&&this._query.childCountAttributes.forEach(e=>Object(a.a)(this.fetchDocument,e)),this._query.contextFiltersAndIds.length>0&&this._query.contextFiltersAndIds.forEach((t,n)=>{var r;const{relationshipName:i,contextId:c,roleOrdinal:l}=function(e){const t=e.split(" ");if(2===t.length)return{relationshipName:t[0],contextId:t[1],roleOrdinal:null};if(3===t.length){let e;switch(t[2]){case"referencing":e=s.a.Referencing;break;case"associationentity":e=s.a.AssociationEntity;break;default:throw new Error("Passed contextFilterAndId has invalid format.")}return{relationshipName:t[0],contextId:t[1],roleOrdinal:e}}throw new Error("Passed contextFilterAndId has invalid format.")}(t);if(!e)throw Object(o.d)(_);try{const t=O(i,this._query.entityLogicalName,l,e());t.computedRoleOrdinal=t.computedRoleOrdinal||s.a.Referencing,this._query.contextFiltersAndIds[n]=`${i} ${c} ${s.a[t.computedRoleOrdinal].toLowerCase()}`,Object(a.c)(this.fetchDocument,t.contextFilter,c)}catch(e){null===(r=h.b.tracer)||void 0===r||r.error(`ModernQueryBuilder: Error when applying context filter for: ${t}. ${e.message}`)}}),this._query.mergeQuickFindViewId){if(!e)throw Object(o.d)("ModernQueryBuilder: getState function not provided");{const t=Object(i.c)(e(),this._query.mergeQuickFindViewId);if(t.queryType!==g.a.QUICKFIND_SEARCH)throw Object(o.d)("ModernQueryBuilder: view provided for mergeQuickFind is not a quick find view");Object(a.f)(t,this.fetchDocument)}}if(this._query.searchString){if(!e)throw Object(o.d)(_);!function(e,t,n,r){let i=Object(a.o)(e);const o=Object(c.h)(r(),n);if(!t||"*"===t||"%"===t)return void(i&&Object(a.x)(i));if(!i){if(!o.PrimaryNameAttribute)return;const t=Object(a.h)(o.EntityLogicalName,o.PrimaryNameAttribute);e=Object(a.w)(t.toString()),i=Object(a.o)(e)}const s=function(e){let t=e;if(!t)return t;"*"===t[0]&&(t=t.substring(1));"*"===t[t.length-1]&&(t=t.substring(0,t.length-1));return t}(t);t=function(e){let t="";for(let n=0;n<e.length;n++)switch(e.charAt(n)){case"[":t=t.concat("[[]");break;case"_":t=t.concat("[_]");break;case"%":t=t.concat("[%]");break;case"*":t=t.concat("%");break;default:t=t.concat(e.charAt(n))}e.length&&e.endsWith("*")||(t=t.concat("%"));return t}(t);let l="",u="",g=!1,h=!1,m=!1;const b=d.a.get_instance().parseDecimalValue(s);if(!isNaN(b)&&isFinite(b)){u=l=b.toString(),m=h=g=!0;const e=d.a.get_instance().parseIntegerValue(s);!isNaN(e)&&isFinite(e)&&e>=-2147483648&&e<=2147483647&&e.toString()===s||(h=!1,u="")}let y="",_=!1;const v=Date.parseLocale(s);v&&(y=v.getFullYear()+"-"+(v.getMonth()<9?"0":"")+(v.getMonth()+1)+"-"+(v.getDate()<10?"0":"")+v.getDate(),_=!0);!function(e,t,n,r,i,o){const s=n.childNodes;for(let c=0;c<s.length;c++){const l=s[c];if("condition"!==l.nodeName)continue;const u="value";if(l.hasChildNodes()){const r=o(),s=t.substring(0,t.length-1),u=Object(a.s)(l,"attribute");if(Object(p.b)(u,i.EntityLogicalName,r)===f.a.MultiSelectPickList){const t=Object(p.a)(r,i.EntityLogicalName,u),a=t&&t.OptionSet,o=a&&a.filter(e=>e.Label&&e.Label.match(new RegExp(s,"i"))).map(e=>e.Value);o&&o.length>0?o.forEach((t,n)=>{if(0===n)l.firstElementChild.textContent=t&&t.toString();else{const n=e.createElement("value");n.textContent=t&&t.toString(),l.appendChild(n)}}):(n.removeChild(l),c--)}}else switch(Object(a.s)(l,u)){case"{4}":r.isFloat?Object(a.A)(l,u,r.decimal):(n.removeChild(l),c--);break;case"{3}":r.isDate?Object(a.A)(l,u,r.date):(n.removeChild(l),c--);break;case"{2}":r.isCurrency?Object(a.A)(l,u,r.decimal):(n.removeChild(l),c--);break;case"{1}":r.isInteger?Object(a.A)(l,u,r.integer):(n.removeChild(l),c--);break;case"{0}":Object(a.A)(l,u,t)}}}(e,t,i,{decimal:l,integer:u,date:y,isFloat:g,isInteger:h,isCurrency:m,isDate:_},o,r)}(this.fetchDocument,this._query.searchString,this._query.entityLogicalName,e)}this._isFetchXmlModified=!0}validateLinkedEntity(e,t){e&&!Object(u.n)(e,t.name)&&this.queryStatus.push({failed:!0,offlineModeSpecific:!0,message:"Error.LinkedEntity.NotAvailable.Offline",parameter:t.name})}containsError(){return this.queryStatus.some(e=>e.failed)}getErrors(){return this.queryStatus.filter(e=>e.failed)}getFirstError(){return this.queryStatus.find(e=>e.failed)}applyRollupContextFilter(){throw new Error("Not implemented")}addExistingContextFilterToKey(){throw new Error("Not implemented")}}function S(e,t){if(!t)throw new Error("Cannot apply context filter because QueryBuilder's state tree reference is empty");const n=Object(c.h)(t,e);if(!n)throw new Error(`Cannot apply context filter because the state tree has no metadata for the ${e} entity`);const r=n.PrimaryIdAttribute;if(!r)throw new Error(`Cannot apply context filter because the primary key for the ${e} entity is missing from the state tree`);return r}function O(e,t,n,r){let i,o=Object(c.y)(r,t,e);if(o){const e=o;i=Object(a.k)(e.ReferencedEntity,e.ReferencedAttribute,e.ReferencingAttribute,null)}else if(o=Object(c.C)(r,t,e)){const e=o,t=Object(c.h)(r,e.ReferencingEntity);i=Object(a.k)(e.ReferencingEntity,e.ReferencingAttribute,e.ReferencedAttribute,t.PrimaryIdAttribute)}else{if(o=Object(c.v)(r,t,e),!o)throw new Error("Passed in relationship could not be found as any type of relationship");{const e=o,c=e.IntersectEntityName;let l,u,d,p;p=e.Entity1LogicalName===e.Entity2LogicalName?n:e.Entity1LogicalName===t?s.a.AssociationEntity:s.a.Referencing,p===s.a.Referencing?(l=e.Entity1LogicalName,d=e.Entity1IntersectAttribute,u=e.Entity2IntersectAttribute):(l=e.Entity2LogicalName,d=e.Entity2IntersectAttribute,u=e.Entity1IntersectAttribute);const f=S(t,r),g=S(l,r);i=Object(a.j)(c,f,d,l,g,u),n=p}}return{contextFilter:i,computedRoleOrdinal:n}}},"/aHX":function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}));var r=n("mMyr"),a=n("KOTC");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function i(){return Promise.all([n.e(0),n.e(1),n.e(6),n.e(62),n.e(141)]).then(n.bind(null,"y1Ka"))}function o(e){return r.createElement(a.a,{key:"navigatebackbutton",loader:()=>i().then(e=>e.NavigateBackButton),props:e})}},"/bjP":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("HkYq"),a=n("504W"),i=n("cgR4"),o=n("8tWD");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class s{constructor(){this._descriptors=null,this._descriptors={}}get_descriptors(){return this._descriptors}tryGetDescriptor(e){return Object(a.a)(this._descriptors[o.a[e]])?"":this._descriptors[o.a[e]].Data}updateDescriptorSet(e,t){o.a[e]in this.get_descriptors()?this._descriptors[o.a[e]].Data=t:this._descriptors[o.a[e]]=new i.a(e,t)}static createFromFetchXml(e){const t=new s;return t._descriptors[o.a[o.a.FetchXml]]=new i.a(o.a.FetchXml,e),t}static createDescriptorSet(e,t,n){const a=new s;if(t===r.a.fetchXml)if(e instanceof Array)for(let t=0;t<e.length;t++){const r=e[t];(r.Format!==o.a.Sql||n)&&(a.get_descriptors()[o.a[r.Format]]=new i.a(r.Format,r.Data))}else"string"==typeof e&&(a.get_descriptors()[o.a[o.a.FetchXml]]=new i.a(o.a.FetchXml,e));else a.get_descriptors()[o.a[0]]=new i.a(0,e);return a}}},"/d6W":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("nxt5");class a extends r.a{constructor(e,t){super("Retrieve"),this._entity=e}get_entity(){return this._entity}}},"/iCT":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("ftQm");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e){r.a.Instance.cleanUpProcessmanagerByPageId(e)}},"/leX":function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r,a;n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a})),function(e){e[e.IFrame=0]="IFrame",e[e.Page=1]="Page",e[e.Pane=2]="Pane"}(r||(r={})),function(e){e[e.NotStarted=0]="NotStarted",e[e.Loading=1]="Loading",e[e.Completed=2]="Completed"}(a||(a={}))},"/o1X":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("3/02"),a=n("Lyxw"),i=n("dpM5"),o=n("E5IU");function s(e){return Object(a.e)(e,i.e,r.kf)&&"Dynamics365Portals"!==Object(o.n)(e)}},"/oKV":function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.Local=0]="Local",e[e.Remote=1]="Remote",e[e.LocalAndRemote=2]="LocalAndRemote",e[e.Default=3]="Default"}(r||(r={}))},"/t1C":function(e,t,n){"use strict";n.d(t,"a",(function(){return ee})),n.d(t,"b",(function(){return X}));var r=n("3/02"),a=n("2yvP"),i=n("Lyxw"),o=n("y60j"),s=n("ghNp"),c=n("3mEc"),l=n("VWP5"),u=n("Wlg7");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class d extends u.a{constructor(e,t){super(t),this._tagValue=e}getTagValue(){return this._tagValue}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class p extends u.a{constructor(e,t,n,r){super(t),this._saveMode=e,this._preventDefaultOnError=n||!1,this._disableAsyncTimeout=r||!1}getSaveMode(){return this._saveMode}preventDefaultOnError(){this._preventDefaultOnError=!0}shouldPreventDefaultOnError(){return this._preventDefaultOnError}disableAsyncTimeout(){this._disableAsyncTimeout=!0}shouldDisableAsyncTimeout(){return this._disableAsyncTimeout}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class f{constructor(e){if(!e)throw"Required parameter is null or undefined: dataLoadState";this._dataLoadState=e}getDataLoadState(){return this._dataLoadState}}var g=n("K6rc"),h=n("7ZMh"),m=n("Uv1Y"),b=n("SAYH"),y=n("NjDY"),_=n("jRy5"),v=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class S extends u.a{constructor(e,t,n){super(n),this._stage=e,this._direction=t}getStage(){return this._stage}getDirection(){return 0===this._direction?"Next":1===this._direction?"Previous":null}}var O=n("Z/4N"),C=n("aF0N"),E=n("vmcK"),I=n("504W"),w=n("pEXn"),j=n("69Qu"),P=n("V6aM"),T=n("FM/+"),N=n("5d8d"),A=n("P6DH"),R=n("zmL5"),D=n("wL2W"),x=n("KXSk"),M=n("+Qpx"),F=n("yHAP"),k=n("4aOd"),L=n("hAdb"),B=n("EY5k"),U=n("YxC/");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class V{constructor(e,t,n){this._entityReference=t,this._errorInfo=n,this._isSaveSuccess=e}getEntityReference(){return this._entityReference}getIsSaveSuccess(){return this._isSaveSuccess}getSaveErrorInfo(){return this._errorInfo}}var z=n("Gi6V"),q=n("hvSt");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class H extends u.a{constructor(e,t){super(t),this._status=e}getStatus(){return this._status?q.a[this._status]:null}getStage(){return null}getDirection(){return null}}var W=n("i1f0");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const G=["Custom_Event_Event_Name","Custom_Event_WebResource_Name","Custom_Event_Function_Name","Custom_Event_Solution_Name","Custom_Event_Publisher_Name","Custom_Event_Load_WebResource_Error"],K=()=>{},Q=["function(){pbl_","function(){bpf_","function(){if (!Mscrm?.BusinessRulesScript?.FunctionsByName?.['"],X={onXrmReady:"onxrmready",onLoad:"onload",onSave:"onsave",onChange:"onchange",onTabStateChange:"tabstatechange",onReadyStateComplete:"onreadystatecomplete",onPostSave:"onpostsave",onClick:"onclick",onKeyPress:"onkeypress",onProcessChange:"onprocesschange",onProcessStatusChange:"onprocessstatuschange",onPreStageChange:"onprestagechange",onPreProcessStatusChange:"onpreprocessstatuschange",onStageChange:"onstagechange",onStageSelected:"onstageselected",preSearchEvent:"presearchevent",onResultOpened:"onresultopened",onSelection:"onselection",onPostSearch:"onpostsearch",onDataLoad:"ondataload",onGridDataLoad:"ongriddataload",onRecordSelect:"onrecordselect",onRecordOpen:"onrecordopen",onLookupTagClick:"onlookuptagclick",setAdditionalParams:"setadditionalparams",postSaveEvent:"postsaveevent",businessRule:"businessrule"},Y={[X.onSave]:(e,t)=>Object(z.b)(e.getState(),t),[X.onLoad]:(e,t)=>Object(z.a)(e.getState(),t)},J=new Set([X.onLoad.toLocaleLowerCase(),X.onSave.toLocaleLowerCase(),X.onChange.toLocaleLowerCase(),X.businessRule.toLocaleLowerCase(),X.onTabStateChange.toLocaleLowerCase(),X.onPostSave.toLocaleLowerCase()]);function $(e){return"Enabled"===e||"Enabled by BehaviorInBulkEditForm attribute in the form xml. By default this attribute is not added, so the enablement is an intentional behavior by the form xml owner."===e}function Z(e){return e.AttributeName?`${e.EventName} for ${e.AttributeName}`:e.EventName}class ee{constructor(e,t,n,r,a,i){this._tracing=n,this._pageId=e,this._container=t,this._telemetryEventManager=r,this._scriptManager=a,this._clientApiManager=i,this._reset()}doesOnClickEventExist(e,t,n){if(this._onClickEvents&&this._onClickEvents.length>0){const r=Object(v.w)(e),a=this._onClickEvents.filter(e=>(!n||String(e.func)===String(n))&&t===e.AttributeName&&e.contextKey===r);return a&&a.length>0}return!1}getOnClickEvents(e,t){let n;if(this._onClickEvents&&this._onClickEvents.length>0){const r=Object(v.w)(e);n=this._onClickEvents.filter(e=>t===e.AttributeName&&e.contextKey===r).map(e=>e.func)}return n}_getLibraryList(e,t){return e?(e.forEach(e=>{e&&e.LibraryName&&t.indexOf(e.LibraryName)<0&&t.push(e.LibraryName)}),t):t}loadWebResources(e,t,n,r,a,i,o,s){const l=a&&0!==a.length,u=i&&0!==i.length;if(l||u||o){const d=t.ScriptManager.getContainer(n);this._container.errorHandler.addEventHandler((n,a)=>this._handleContainerError(e,r,t,a)),o&&d.loadJavascriptString(o);const p=Object(y.x)(r());let f=[];if(l&&f.push(...a),u){let e=[];e=this._getLibraryList(i,e),f.push(...e)}f.length>0&&(f=Object(c.e)(r(),f),f.forEach(e=>{e&&e.startsWith&&s.push(e)})),s=s.filter(e=>!this._isFormLibraryDisabledByConfigFlag(r(),e));const g=!Object(j.c)(r());return s=s.map(e=>this._normalizeWebResourceName(e,p)),d.loadWebResourcesForAllContexts(s,p,3,t=>e(Object(P.a)(t)),g)}return Promise.resolve()}loadScripts(e,t,n){return{type:"eventManager.loadScriptsAction",execute:({dispatch:r,getState:a},i)=>{let s,c,l,u=[];const d=Object(o.h)(a(),e);if(d){s=d.FormLibraries,c=d.EventHandlers,l=d.BusinessLogic;const e=Object(W.o)(a(),d,t);if(null==e?void 0:e.length){const t=e;for(let n=0;n<e.length;n++)u=this._getLibraryList(t[n].EventHandlers,u)}Object(D.a)()&&this._sendAllEventsToMonitor(i,a(),d,n,t)}return this.loadWebResources(r,i,t,a,s,c,l,u)}}}loadGridScripts(e,t){return{type:"eventManager.loadGridScriptsAction",execute:({dispatch:n,getState:r},a)=>{let i,o;if(Object(C.b)(r())){const t=Object(O.d)(r(),e,E.a);t&&(i=t.FormLibraries,o=t.EventHandlers)}let s;if(Object(C.c)(r())){const t=Object(C.a)(r(),e,E.a);t&&(s=t.BusinessLogic)}return this.loadWebResources(n,a,t,r,i,o,s,[])}}}runOnLoad(e,t,n,r="This onload event is triggered during form load."){if(this._scriptManager.containerExists(this._pageId)){n||Object(a.b)("event.source",()=>{const t=this.getClientApiForm(e);t?n=t.ui:this._tracing.error("XrmForm is null or undefined")});const i=new f(t);return this._executeFormEventHandler(e,X.onLoad,n,i,null,r)}return this._tracing.error("RunOnLoad was cancelled as the container does not exists"),{type:"eventManager.execute.formEventHandler",sync:!0,execute:(e,t)=>!1}}runOnSave(e,t,n,r,i="This save event is invoked by a manual or programatic save operation."){let o=null;n||Object(a.b)("event.source",()=>{var t;o=this._getFormContext(e,r),n=null===(t=null==o?void 0:o.data)||void 0===t?void 0:t.entity});const s=new p(t);return this._executeFormEventHandler(e,X.onSave,n,s,o,i)}runOnChange(e,t,n,r){return n||Object(a.b)("event.source",()=>{const a=this._getFormContext(e,r);if(null==a?void 0:a.getAttribute)n=a.getAttribute(t);else if(e.relationshipName){const r=this._getFormContext(e.parentContextToken);if(r){const a=r.data.entity.relatedEntities.get(e.relationshipName);a&&(n=a.attributes.get(t))}}}),this._executeControlEventHandler(e,X.onChange,t,n)}runOnKeyPress(e,t,n){return this._executeControlEventHandler(e,X.onKeyPress,t,n)}runOnClick(e,t,n){return n||Object(a.b)("event.source",()=>{n=this.getClientApiForm(e).getControl(t)}),this._executeControlEventHandler(e,X.onClick,t,n)}runOnStageChange(e,t,n){let r;return Object(a.b)("event.source",()=>{const a=this.getClientApiForm(e);a&&a.data&&a.data.process&&(t=a.data.process.getActiveStage(),r=new S(t,n))}),this._executeFormEventHandler(e,X.onStageChange,t,r)}runOnProcessStatusChange(e,t,n){let r;return Object(a.b)("event.source",()=>{const a=this.getClientApiForm(e);a&&a.data&&a.data.process&&(n=a.data.process.getActiveProcess(),r=new H(t))}),this._executeFormEventHandler(e,X.onProcessStatusChange,n,r)}runOnPreStageChange(e,t,n,r){let i;return Object(a.b)("event.source",()=>{var t;const a=this.getClientApiForm(e);if(a&&a.data&&a.data.process){const e=null===(t=a.data.process.getActiveProcess().getStages().get().filter(e=>e.getId()===r))||void 0===t?void 0:t[0];i=new S(e,n)}}),this._executeFormEventHandler(e,X.onPreStageChange,t,i)}runOnPreProcessStatusChange(e,t,n){let r;const i=this.getClientApiForm(e);return Object(a.b)("event.source",()=>{i&&i.data&&i.data.process&&(r=new H(t))}),this._executeFormEventHandler(e,X.onPreProcessStatusChange,n,r)}runOnStageSelected(e,t){let n;const r=this.getClientApiForm(e);return Object(a.b)("event.source",()=>{r&&r.data&&r.data.process&&(t=r.data.process.getSelectedStage(),n=new S(t,null))}),this._executeFormEventHandler(e,X.onStageSelected,t,n)}runOnTabStateChange(e,t,n){const r=this.getClientApiForm(e);return Object(a.b)("event.source",()=>{!n&&r&&r.ui&&r.ui.tabs&&(n=r.ui.tabs.get(t))}),this._executeControlEventHandler(e,X.onTabStateChange,t,n)}runOnReadyStateComplete(e,t,n){if(!t){const r=this.getClientApiForm(e);r&&Object(a.b)("event.source",()=>{t=r.getControl(n)})}return this._executeControlEventHandler(e,X.onReadyStateComplete,n,t)}runOnProcessChange(e,t){const n=this.getClientApiForm(e);return Object(a.b)("event.source",()=>{n.data.process=null,n.ui.process=null}),this._executeFormEventHandler(e,X.onProcessChange,t)}runPreSearch(e,t,n){return n||Object(a.b)("event.source",()=>{const r=this.getClientApiForm(e);n=null==r?void 0:r.getControl(t)}),this._executeControlEventHandler(e,X.preSearchEvent,t,n)}runOnResultOpened(e,t,n,r){let i;return Object(a.b)("event.source",()=>{const n=this.getClientApiForm(e);i=null==n?void 0:n.getControl(t)}),this._executeControlEventHandler(e,X.onResultOpened,t,i,null,n,r)}runOnSelection(e,t,n,r){let i;return Object(a.b)("event.source",()=>{const n=this.getClientApiForm(e);i=null==n?void 0:n.getControl(t)}),this._executeControlEventHandler(e,X.onSelection,t,i,null,n,r)}runOnPostSearch(e,t,n,r){let i;return Object(a.b)("event.source",()=>{const n=this.getClientApiForm(e);i=null==n?void 0:n.getControl(t)}),this._executeControlEventHandler(e,X.onPostSearch,t,i,null,n,r)}runOnDataLoad(e,t,n){if(!n){const t=this.getClientApiForm(e);Object(a.b)("event.source",()=>{t&&t.data&&t.data.entity&&(n=t.data.entity)})}const r=new f(t);return this._executeFormEventHandler(e,X.onDataLoad,n,r)}runOnPostSave(e,t,n,r,a,i="This save event is invoked by a manual or programatic save operation."){const o=new V(t,n,r);return this._executeFormEventHandler(e,X.onPostSave,a,o,null,i)}runOnGridDataLoad(e,t,n,r){r||(r=this.getClientApiGrid(e));const a=new f(t);return this._executeControlEventHandler(e,X.onGridDataLoad,n,r,a)}runOnLookupTagClick(e,t,n,r,a){const i=new d(r);return this._executeControlEventHandler(e,X.onLookupTagClick,t,n,i,r,a)}runSetAdditionalParams(e,t,n){return this._scriptManager.containerExists(this._pageId)?(n||Object(a.b)("event.source",()=>{const r=this.getClientApiForm(e);n=null==r?void 0:r.getControl(t)}),this._executeControlEventHandler(e,X.setAdditionalParams,t,n)):(this._tracing.error("runSetAdditionalParams was cancelled as the container does not exists"),{type:"eventManager.execute.formEventHandler",sync:!0,execute:(e,t)=>!1})}runOnRecordSelect(e,t,n){return n||Object(a.b)("event.source",()=>{n=this._getFormContext(e).data.entity}),this._executeControlEventHandler(e,X.onRecordSelect,t,n)}runOnRecordOpen(e,t,n){return n||Object(a.b)("event.source",()=>{n=this._getFormContext(e)}),this._executeControlEventHandler(e,X.onRecordOpen,t,n)}addGridOnRecordSelectHandlers(e){return{type:"eventManager.addGridOnRecordSelectHandlers",execute:async(t,n)=>{if(!Object(C.c)(t.getState()))return;const r=Object(v.w)(e),i=e.controlName?e.controlName:E.a,o=this._getRelationship(t.getState(),e);if(0!==this._onRecordSelectEvents.filter(e=>e.AttributeName===i&&e.contextKey===r&&this._isMatchingEventRelationship(e.Relationship,o)).length)return;const s=e.controlName?e.controlName:"crmGrid";let c;Object(a.b)("event.source",()=>{c=this._getFormContext(e).data.entity.getEntityName()});const l=String.format("Mscrm.BusinessRulesScript.addOnRecordSelect_{0}_{1}",s,c);if(!this._getScopedFunction(l))return;const u=this.getClientApiGrid(e),d={Identifier:this._generateEventIdentifier(X.onRecordSelect),EventName:X.onRecordSelect,FunctionName:l,PassExecutionContext:!0,contextKey:r,BehaviorInBulkEditForm:null};await this._executeIndividualEvent(n,d,undefined,!0,0,t,e,u,null,null)}}}addGridOnChangeHandlers(e,t){return{type:"eventManager.addGridOnChangeHandlers",execute:async(n,r)=>{if(!Object(C.c)(n.getState()))return;const i=Object(v.w)(e),o=e.controlName?e.controlName:E.a,s=this._getRelationship(n.getState(),e);if(0!==this._onChangeEvents.filter(e=>e.AttributeName===o&&e.contextKey===i&&this._isMatchingEventRelationship(e.Relationship,s)).length)return;const c=e.controlName?e.controlName:"crmGrid";let l,u;Object(a.b)("event.source",()=>{u=this._getFormContext(e,t).data.entity,l=u.getEntityName()});const d=String.format("Mscrm.BusinessRulesScript.addOnChange_{0}_{1}",c,l);if(!this._getScopedFunction(d))return;const p={Identifier:this._generateEventIdentifier(X.onRecordSelect),EventName:X.onRecordSelect,FunctionName:d,PassExecutionContext:!0,contextKey:i,BehaviorInBulkEditForm:null};await this._executeIndividualEvent(r,p,undefined,!0,0,n,e,u,null,null)}}}addOnLoadEvent(e,t,n){this._addEvent(e,this._onLoadEvents,t,X.onLoad,void 0,n)}addOnSaveEvent(e,t){this._addEvent(e,this._onSaveEvents,t,X.onSave)}addOnChangeEvent(e,t,n,r,a){const i=this._getRelationship(e,t);this._addEvent(t,this._onChangeEvents,r,X.onChange,n,a,i)}addOnClickEvent(e,t,n){this._addEvent(e,this._onClickEvents,n,X.onClick,t)}addOnProcessChangeEvent(e,t){this._addEvent(e,this._onProcessChangeEvents,t,X.onProcessChange)}addOnProcessStatusChangeEvent(e,t){this._addEvent(e,this._onProcessStatusChangeEvents,t,X.onProcessStatusChange)}addOnPreProcessStatusChangeEvent(e,t){this._addEvent(e,this._onPreProcessStatusChangeEvents,t,X.onPreProcessStatusChange)}addOnPreStageChangeEvent(e,t){this._addEvent(e,this._onPreStageChangeEvents,t,X.onPreStageChange)}addOnStageChangeEvent(e,t){this._addEvent(e,this._onStageChangeEvents,t,X.onStageChange)}addOnStageSelectedEvent(e,t){this._addEvent(e,this._onStageSelectedEvents,t,X.onStageSelected)}addOnTabStateChangeEvent(e,t,n){this._addEvent(e,this._onTabStateChangeEvents,n,X.onTabStateChange,t)}addOnKeyPressEvent(e,t,n){this._addEvent(e,this._onKeyPressEvents,n,X.onKeyPress,t)}addPreSearchEvent(e,t,n){this._addEvent(e,this._preSearchEvents,n,X.preSearchEvent,t)}addOnResultOpened(e,t,n){this._addEvent(e,this._onResultOpenedEvents,n,X.onResultOpened,t)}addOnSelection(e,t,n){this._addEvent(e,this._onSelectionEvents,n,X.onSelection,t)}addOnPostSearch(e,t,n){this._addEvent(e,this._onPostSearchEvents,n,X.onPostSearch,t)}addOnReadyStateComplete(e,t,n){this._addEvent(e,this._onReadyStateComplete,t,X.onReadyStateComplete,n)}addOnDataLoad(e,t){this._addEvent(e,this._onDataLoadEvents,t,X.onDataLoad)}addOnGridDataLoad(e,t,n){this._addEvent(e,this._onGridDataLoadEvents,t,X.onGridDataLoad,n)}addOnRecordSelect(e,t,n,r){const a=this._getRelationship(e,t);this._addEvent(t,this._onRecordSelectEvents,n,X.onRecordSelect,r,!1,a)}addOnPostSave(e,t){this._addEvent(e,this._onPostSaveEvents,t,X.onPostSave)}addOnLookupTagClick(e,t,n){this._addEvent(e,this._onLookupTagClickEvents,n,X.onLookupTagClick,t)}removeOnKeyPressEvent(e,t,n){this._removeEvent(e,this._onKeyPressEvents,n,t)}removeOnLoadEvent(e,t){this._removeEvent(e,this._onLoadEvents,t)}removeOnSaveEvent(e,t){this._removeEvent(e,this._onSaveEvents,t)}removeOnChangeEvent(e,t,n){this._removeEvent(e,this._onChangeEvents,n,t)}removePreSearchEvent(e,t,n){this._removeEvent(e,this._preSearchEvents,n,t)}removeOnResultOpened(e,t,n){this._removeEvent(e,this._onResultOpenedEvents,n,t)}removeOnSelection(e,t,n){this._removeEvent(e,this._onSelectionEvents,n,t)}removeOnPostSearch(e,t,n){this._removeEvent(e,this._onPostSearchEvents,n,t)}removeOnClickEvent(e,t,n){this._removeEvent(e,this._onClickEvents,n,t)}removeOnProcessStatusChange(e,t){this._removeEvent(e,this._onProcessStatusChangeEvents,t)}removeOnStageChange(e,t){this._removeEvent(e,this._onStageChangeEvents,t)}removeOnPreStageChange(e,t){this._removeEvent(e,this._onPreStageChangeEvents,t)}removeOnPreProcessStatusChange(e,t){this._removeEvent(e,this._onPreProcessStatusChangeEvents,t)}removeOnStageSelected(e,t){this._removeEvent(e,this._onStageSelectedEvents,t)}removeOnTabStateChange(e,t,n){this._removeEvent(e,this._onTabStateChangeEvents,n,t)}removeOnReadyStateComplete(e,t,n){this._removeEvent(e,this._onReadyStateComplete,t,n)}removeOnDataLoad(e,t){this._removeEvent(e,this._onDataLoadEvents,t)}removeOnGridDataLoad(e,t,n){this._removeEvent(e,this._onGridDataLoadEvents,t,n)}removeOnRecordSelect(e,t,n){this._removeEvent(e,this._onRecordSelectEvents,t,n)}removeOnLookupTagClick(e,t,n){this._removeEvent(e,this._onLookupTagClickEvents,n,t)}removeOnPostSave(e,t){this._removeEvent(e,this._onPostSaveEvents,t)}disableOnChangeHandlers(e){this._onChangeDisabledFields.indexOf(e)<0&&this._onChangeDisabledFields.push(e)}isOnChangeDisabled(e){return this._onChangeDisabledFields.indexOf(e)>=0}addBusinessRuleEventDuringFormLoad(e){return{type:"eventManager.addBusinessRuleEventAction",sync:!0,execute:(t,n)=>{const r=this._getScopedFunction("Mscrm.BusinessRulesScript.Initialize");if(!(null==r?void 0:r.apply))return;this._runBusinessRuleFormChecker(t.getState(),n,e),Object(a.b)("businessRule.initialization",()=>{r.apply(this)});const i=this._getScopedFunction("Mscrm.BusinessRulesScript.ReInitialize");i&&this._addEvent(e,this._businessRuleExecutionEvents,i,X.businessRule)}}}_runBusinessRuleFormChecker(e,t,n){var r;const a=this._getScopedFunction("Mscrm.BusinessRulesScript.GetFunctions"),i=Object(D.a)();let o=null,s="",c="";if(i){c=Object(x.c)(e,this._pageId),o=Object(F.b)(c,X.businessRule),s=Object(F.c)(e,this._pageId,n);const t={message:`Business Rules started ${s}.`+(a?" You can disable all business rules through config flag &flags=DisableFormHandlers=businessrule or selectively disable some through &flags=DisableFormHandlers=businesrule_<index> or &flags=DisableFormHandlers=businessrule_<startIndex>_<endIndex>. Note that this disablement would disable the business rule(s) in all event pipelines such as onload, onsave, onchange etc.":" To see all business rules on this form and be able to individually disable them through config flag, the business rules need to be refreshed in the backend. To do so, please deactivate and reactivate any existing rule on this form, or activate a new rule and then delete it. Once you've taken the action, please refresh this form and you'll see different message here with additional debugging information.")};o.push(t)}let l=null;if(a){const t=a.apply(this);l=null==t?void 0:t.length;const r=[];for(let a=0;a<(null==t?void 0:t.length);a++){if(!t[a])continue;const o=this._createCustomEvent(n,K,X.businessRule,null),s=this._getCustomEventEnabledState(e,o,null,a),c=!$(s);if(t[a].disabledByConfigFlag=c,i){const e={index:a,businessRuleName:t[a].businessRuleName,functionName:t[a].functionName,businessRuleId:t[a].businessRuleId,enabledState:s};r.push(e)}}if(i){const e={message:r.length?JSON.stringify(r):"There are no active business rules on this form."};o.push(e)}}if(null!==l&&l>=0){const t=[];t.push({name:"entityName",value:Object(v.w)(n)},{name:"formId",value:null===(r=Object(R.b)(e,this._pageId))||void 0===r?void 0:r.guid},{name:"numberOfBusinessRules",value:l}),this._telemetryEventManager.ReportComponentSuccess("ScriptManager.customEventManager..businessrule",t)}if(i){const e={message:`Business Rules completed ${s}.`};o.push(e),Object(F.a)(t,c,X.businessRule)}}runBusinessRulesAfterSaveSuccess(e){return this._executeFormEventHandler(e,X.businessRule)}_getScopedFunction(e){if(this._container&&this._container.iFrame){const t=e.split(".");let n=this._container.iFrame.contentWindow;for(let e=0;e<t.length&&n;e++)n=n[t[e]];return n}return null}_removeEvent(e,t,n,r){if(t&&t.length>0&&n){const a=Object(v.w)(e),i=t.filter(e=>e.func===n&&(!r||r===e.AttributeName)&&e.contextKey===a);for(let e=0;e<i.length;e++){const n=t.indexOf(i[e]);t[n].isDisabled=!0}}}_addEvent(e,t,n,r,a,i,o){if(t&&n){const s=this._createCustomEvent(e,n,r,a,i,o);t.push(s)}}_createCustomEvent(e,t,n,r,a,i){var o;if(!t)return null;const s=this._isFunctionBusinessRule(n,t),c=null===(o=this._container)||void 0===o?void 0:o.getCurrentInfo();return{Identifier:this._generateEventIdentifier(n,s),EventName:n,PassExecutionContext:!0,func:t,AttributeName:r,isDisabled:!1,contextKey:Object(v.w)(e),isHighPriority:a,Relationship:Object(I.a)(i)?null:i,CustomizationInfo:Object.assign(Object.assign({},c),{type:s?n:n+"Dynamic",source:s?"This event handler is defined by Business Rule":"This event handler is dynamically added in code. To find the code location where the handler is added please check the callStackForDynamicHandler value."}),callStackForDynamicHandler:s?void 0:new k.a(new Error).getStackTrace()}}_isFunctionBusinessRule(e,t){var n;if(!Object(D.a)())return!1;if(e===X.businessRule)return!0;if(e===X.onChange&&"onchangehandler"===(null==t?void 0:t.name)){const e=null===(n=null==t?void 0:t.toString)||void 0===n?void 0:n.call(t);return(null==e?void 0:e.length)&&Q.some(t=>e.indexOf(t)>=0)}return!1}_executeFormEventHandler(e,t,n,a,o,s){let c=[];switch(t){case X.onLoad:c=this._onLoadEvents;break;case X.onSave:c=this._onSaveEvents;break;case X.onProcessChange:c=this._onProcessChangeEvents;break;case X.onProcessStatusChange:c=this._onProcessStatusChangeEvents;break;case X.onPreStageChange:c=this._onPreStageChangeEvents;break;case X.onPreProcessStatusChange:c=this._onPreProcessStatusChangeEvents;break;case X.onStageChange:c=this._onStageChangeEvents;break;case X.onStageSelected:c=this._onStageSelectedEvents;break;case X.onReadyStateComplete:c=this._onReadyStateComplete;break;case X.onDataLoad:c=this._onDataLoadEvents;break;case X.onGridDataLoad:c=this._onGridDataLoadEvents;break;case X.businessRule:c=this._businessRuleExecutionEvents;break;case X.onPostSave:c=this._onPostSaveEvents}return{type:"eventManager.execute.formEventHandler",sync:!0,execute:(l,u)=>{var d;if(this._isHandlerLocked("_form",t))return!1;if(Object(T.a)(t,X.onPostSave)&&!Object(i.f)(l.getState(),r.Qf))return null===(d=null==u?void 0:u.TraceManager)||void 0===d||d.getTracer("Forms.SaveForm.PostSaveAsyncEvent").warn("FCB PostSaveEventHandler is not enabled"),!1;if(this._lockHandler("_form",t),t===X.onLoad&&!e.parentContextToken)if(u.GlobalCustomEventManager){const t=this.getClientApiForm(e);l.dispatch(u.GlobalCustomEventManager.runBeforeOnLoad(t,this._pageId,t))}else this._telemetryEventManager.ReportComponentFailure("ScriptManager.customEventManager.._executeFormEventHandler",new Error("GlobalCustomEventManager is null or undefined"));let p;try{const[r,i]=this._getEventHandlerList(l.getState(),e,t);p=this._executeEventHandler(u,r,i,c,l,e,t,n,a,o,s),this._unlockHandler("_form",t)}catch(e){this._unlockHandler("_form",t),this._handleError(l.dispatch,l.getState,e),p=!1}return p}}}_executeControlEventHandler(e,t,n,r,a,i,o){let s=[];switch(t){case X.preSearchEvent:s=this._preSearchEvents;break;case X.onChange:s=this._onChangeEvents;break;case X.onKeyPress:s=this._onKeyPressEvents;break;case X.onClick:s=this._onClickEvents;break;case X.onTabStateChange:s=this._onTabStateChangeEvents;break;case X.onDataLoad:s=this._onDataLoadEvents;break;case X.onGridDataLoad:s=this._onGridDataLoadEvents;break;case X.onResultOpened:s=this._onResultOpenedEvents,Object(N.a)(e,this._pageId,this._clientApiManager,s,i,o);break;case X.onSelection:s=this._onSelectionEvents,Object(N.a)(e,this._pageId,this._clientApiManager,s,i,o);break;case X.onPostSearch:s=this._onPostSearchEvents,Object(N.a)(e,this._pageId,this._clientApiManager,s,i,o);break;case X.onLookupTagClick:s=this._onLookupTagClickEvents;break;case X.onRecordSelect:s=this._onRecordSelectEvents;break;case X.onReadyStateComplete:s=this._onReadyStateComplete}return{type:"eventManager.execute.controlEventHandler",sync:!0,execute:(i,o)=>{if(!n||Object(T.a)(t,X.onChange)&&this.isOnChangeDisabled(n))return;if(this._isHandlerLocked(n,t))return;const c=Object(v.w)(e),l=this._getRelationship(i.getState(),e);if(s=s.filter(e=>e.AttributeName===n&&e.contextKey===c&&this._isMatchingEventRelationship(e.Relationship,l)),this._lockHandler(n,t),t===X.onGridDataLoad&&!e.parentContextToken)if(o.GlobalCustomEventManager){const t=this.getClientApiGrid(e);i.dispatch(o.GlobalCustomEventManager.runBeforeOnLoad(t,this._pageId))}else this._telemetryEventManager.ReportComponentFailure("ScriptManager.customEventManager.._executeControlEventHandler",new Error("GlobalCustomEventManager is null or undefined"));const[u,d]=this._getEventHandlerList(i.getState(),e,t,n);let p;try{if(this._executeEventHandler(o,u,d,s,i,e,t,r,a),this._unlockHandler(n,t),t===X.onRecordOpen)return u&&u.length>0||s&&s.length>0;if(t===X.onLookupTagClick){const e=a;return!!e&&e.isDefaultPrevented()}}catch(e){this._unlockHandler(n,t),this._handleError(i.dispatch,i.getState,e),p=!1}return p}}}_executeEventHandler(e,t,n,r,a,i,o,s,c,l,u){let d=!1;const p=[],f=[];if(0!==t.length||0!==r.length){let o,g,h;for(let t=0;t<r.length;t++)r[t].isHighPriority&&(g=this._executeIndividualEvent(e,r[t],o,d,t,a,i,s,c,l,f,u),"boolean"==typeof g?d=g:p.push(g));for(let r=0;r<t.length;r++)g=this._executeIndividualEvent(e,t[r],o,d,n[r],a,i,s,c,l,f,u),"boolean"==typeof g?d=g:p.push(g);let m=0;for(;m<r.length;)h=r[m],h.isHighPriority||(g=this._executeIndividualEvent(e,h,o,d,m+t.length,a,i,s,c,l,f,u),"boolean"==typeof g?d=g:p.push(g)),m++}return f.length>0&&Promise.all(f).then(()=>{this._flushMonitorEvents(a.getState,e,o)}),p.length>0?Promise.allSettled(p).then(t=>{for(const e of t){if("fulfilled"!==e.status)throw e.reason;d||!0!==e.value||(d=!0)}return this._flushMonitorEvents(a.getState,e,o),d}):d}_executeIndividualEvent(e,t,n,o,c,u,d,h,m,b,y,S){var O;const C=null===(O=Y[t.EventName])||void 0===O?void 0:O.call(Y,u,d);if(Object(v.w)(d)!==t.contextKey)return o;if(t.isDisabled)return o;const{eventEnabledState:E,telemetryParameters:I,eventMonitorParam:j,isInMonitoringSession:P,monitorEventLogs:N,forSubFormForEntityMessage:A,customizationInfo:R}=this._checkEventEnabledAndLogEventStartToMonitor(u.getState(),d,t,c,S);let D=j;if(!$(E))return o;Object(T.a)(t.EventName,X.onSave)&&(m=new p(m.getSaveMode(),m.isDefaultPrevented()||o)),Object(T.a)(t.EventName,X.onPostSave)&&(m=new V(m.getIsSaveSuccess(),m.getEntityReference(),m.getSaveErrorInfo()),I.push({name:"EntityName",value:t.contextKey},{name:"EventName",value:t.EventName},{name:"WebResourceName",value:R.webResourceName},{name:"FunctionName",value:t.FunctionName},{name:"SolutionName",value:R.solutionName})),(Object(T.a)(t.EventName,X.onLoad)||Object(T.a)(t.EventName,X.onDataLoad))&&(m=new f(m.getDataLoadState()));const x=t.Parameters&&t.Parameters.length>0;let M;if(t.PassExecutionContext){let a;if(b)a=b;else if(Object(T.a)(t.EventName,X.onRecordOpen))a=h;else if(Object(T.a)(t.EventName,X.onRecordSelect)||Object(T.a)(t.EventName,X.onChange)||Object(T.a)(t.EventName,X.onSave)||Object(T.a)(t.EventName,X.onPostSave)){let e;(null==h?void 0:h.getRecordIdFromContextToken)&&(e=h.getRecordIdFromContextToken()),a=this._getFormContextFromToken(d,e)}else a=d.parentContextToken&&(Object(i.f)(u.getState(),r.Zg)&&d.contextTokenType===_.a.SubGrid&&Object(T.a)(t.EventName,X.onGridDataLoad)||d.contextTokenType===_.a.SearchWidget&&Object(T.a)(t.EventName,X.onSelection))?Object(s.d)(this._pageId,d.parentContextToken,e.ClientApiManager):Object(s.d)(this._pageId,d,e.ClientApiManager);n=new l.a(u,this._pageId,h,c,m,a,n),M=x?[n].concat(t.Parameters):[n]}else x&&(M=t.Parameters);let F,k=!1;try{const e={sourceName:"event.executeHandler"};if(e.eventParameters=[{name:"eventName",value:t.EventName},{name:"attributeName",value:t.AttributeName}],t.func||t.FunctionName){let n,r,i;t.func?(n=t.func,r=n.name||"anonymous"):(r=n=t.FunctionName,i=!0,e.eventParameters.push({name:w.b.WebResourceParameterNames.WebResourceName,value:R.webResourceName}),e.eventParameters.push({name:w.b.WebResourceParameterNames.SolutionName,value:R.solutionName}),e.eventParameters.push({name:w.b.WebResourceParameterNames.PublisherName,value:R.publisherName})),e.eventParameters.push({name:w.b.WebResourceParameterNames.FunctionName,value:r}),Object(a.b)(e,()=>{F=this._container.execute(n,M,i,t.CustomizationInfo,m).catch(e=>{C&&m&&"function"==typeof m.shouldPreventDefaultOnError&&m.shouldPreventDefaultOnError()&&(o=!0),(C||(null==e?void 0:e.message)!==g.a)&&(this._handleError(u.dispatch,u.getState,e,t),D=this._getEventMonitorParameter(t,e))})})}}catch(e){this._handleError(u.dispatch,u.getState,e,t),D=this._getEventMonitorParameter(t,e)}o=this._evaluatePreventDefault(m,o),k=this._evaluateDisableAsyncTimeout(m);const L=F.then(()=>(C&&(o=this._evaluatePreventDefault(m,o)),P&&N.push({message:`${D.eventName} handler ${D.errorMessage?"failed":"completed"} ${A}${o?" (default prevented, save operation will be canceled)":""} ${k?" (disableAsyncTimeout has been set by this handler, if this is an async handler the save operation will be waiting for the promise returned by this handler to finish saving)":""}.`,event:this._convertEventMonitorParameterForCompletedEvent(D)}),o));return C?L:(null==y||y.push(L),o)}_evaluatePreventDefault(e,t){return!(t||!e||"function"!=typeof e.isDefaultPrevented||!e.isDefaultPrevented())||t}_evaluateDisableAsyncTimeout(e){var t,n;return e&&"function"==typeof(null===(t=e)||void 0===t?void 0:t.shouldDisableAsyncTimeout)&&(null===(n=e)||void 0===n?void 0:n.shouldDisableAsyncTimeout())}_checkEventEnabledAndLogEventStartToMonitor(e,t,n,r,a){const i=n.CustomizationInfo||{webResourceName:"",publisherName:"",solutionName:"",solutionVersion:"",type:""},o=this._getCustomEventEnabledState(e,n,i.webResourceName,r),s=Object(D.a)();let c=null,l=null,u="";let d="";if(s){d=Object(x.c)(e,this._pageId),c=Object(F.b)(d,n.EventName),a&&c.push({message:a}),u=Object(F.c)(e,this._pageId,t);const r=`${n.EventName}${n.EventName!==X.businessRule?" handler":""}`,i={message:$(o)?`${r} started ${u}.`:`${r} is disabled. Reason: ${o}`};n&&(l=this._getEventMonitorParameter(n),i.event=l),c.push(i)}return{eventEnabledState:o,telemetryParameters:[],eventMonitorParam:l,isInMonitoringSession:s,monitorEventLogs:c,forSubFormForEntityMessage:u,rootComponentId:d,customizationInfo:i}}async _handleError(e,t,n,r,a){let i;if(r){await e(Object(B.e)(G));const n=t(),a=Object(U.e)(n,G),o=Object(U.c)(a,"Custom_Event_Event_Name")||"Event Name:",s=Object(U.c)(a,"Custom_Event_Function_Name")||"Function Name:",c=Object(U.c)(a,"Custom_Event_WebResource_Name")||"Web Resource Name:",l=Object(U.c)(a,"Custom_Event_Solution_Name")||"Solution Name:",u=Object(U.c)(a,"Custom_Event_Publisher_Name")||"Publisher Name:",d=r.CustomizationInfo||{webResourceName:"",publisherName:"",solutionName:"",solutionVersion:"",type:""};i=`${o} ${r.EventName}\n`+(r.FunctionName?`${s} ${r.FunctionName}\n`:"")+(d.webResourceName?`${c} ${d.webResourceName}\n`:"")+(d.solutionName?`${l} ${d.solutionName}\n`:"")+(d.publisherName?`${u} ${d.publisherName}`:"")}a&&(i=i?`${i}\n${a}`:a),e(Object(h.a)(this._pageId,new m.a(void 0,2153976091,void 0,void 0,void 0,n,i)))}_generateEventIdentifier(e,t=!1){return t?X.businessRule:`${e}_${b.a.newGuid().guid}`}_getEventMonitorParameter(e,t){var n;if(!e)return null;const r=t?new k.a(t):null,a=this._isFunctionBusinessRule(e.EventName,e.func);return Object.assign(Object.assign(Object.assign(Object.assign({identifier:e.Identifier,eventName:e.EventName,attributeName:e.AttributeName},e.CustomizationInfo),{functionName:a?void 0:e.func?(null===(n=e.func.name)||void 0===n?void 0:n.length)?e.func.name:"anonymous":e.FunctionName}),t&&{errorMessage:t.message,errorCallStack:r.getStackTrace()}),{callStackForDynamicHandler:e.callStackForDynamicHandler})}_convertEventMonitorParameterForCompletedEvent(e){return e?{identifier:e.identifier+" (messages of the same identifier belong to the same event handler.)",errorMessage:e.errorMessage?e.errorMessage:void 0,errorCallStack:e.errorCallStack?e.errorCallStack:void 0}:e}_getAttributeEventNameKey(e,t){return e.concat("_",t)}_lockHandler(e,t){const n=this._getAttributeEventNameKey(e,t);this._lockedHandlers[n]=!0}_isHandlerLocked(e,t){const n=this._getAttributeEventNameKey(e,t);return this._lockedHandlers[n]}_unlockHandler(e,t){const n=this._getAttributeEventNameKey(e,t);this._lockedHandlers[n]?this._lockedHandlers[n]=!1:this._tracing.error("Handler was NOT LOCKED as expected ("+n+")")}_getEventHandlerList(e,t,n,c){let l=[],u=null,d=null;const p=Object(C.b)(e);if(Object(a.b)("event.getHandlers",()=>{var r,a;if(t&&t.contextTokenType&&(t.contextTokenType===_.a.MainGrid||t.contextTokenType===_.a.AssociatedGrid)){if(p){const r=Object(s.d)(this._pageId,t,this._clientApiManager);if(r&&r.getEntityName&&"function"==typeof r.getEntityName){const a=r.getEntityName(),i=Object(O.d)(e,a,E.a);i&&(l=i.EventHandlers,u="Grids",Object(T.a)(n,X.onRecordSelect)&&(c=null),d=this._getRelationship(e,t))}}}else{const i=Object(o.h)(e,Object(R.b)(e,this._pageId));if(i){l=i.EventHandlers;const o=Object(W.o)(e,i,this._pageId);if(Object(T.a)(n,X.onTabStateChange)&&(null==o?void 0:o.length))for(let e=0;e<o.length;e++){const t=null===(a=null===(r=o[e])||void 0===r?void 0:r.EventHandlers)||void 0===a?void 0:a.map(t=>{var n;return t.AttributeName=null===(n=o[e])||void 0===n?void 0:n.Name,t});(null==t?void 0:t.length)&&(l=l.concat(t))}p&&(u=t&&t.controlName?t.controlName:null,Object(T.a)(n,X.onRecordSelect)&&(c=null),d=this._getRelationship(e,t))}}}),l&&0!==l.length){const a=[],o={};return[l.filter(t=>{let s=!1;const l=Z(t);if(t.EventName&&(void 0===o[l]?o[l]=0:++o[l]),t.Enabled){if(Object(T.a)(n,X.onRecordOpen))return s=Object(i.f)(e,r.Xc)&&Object(T.a)(t.EventName,n)&&u===t.ControlId,s&&t.EventName&&a.push(o[l]),s;if(!c||!t.AttributeName&&!t.ControlId)return s=Object(T.a)(t.EventName,n)&&(p&&t.ControlId===u||!p)&&(p&&this._isMatchingEventRelationship(t.Relationship,d)||!p),s&&t.EventName&&a.push(o[l]),s;if(t.AttributeName)return s=Object(T.a)(t.EventName,n)&&t.AttributeName===c&&(p&&t.ControlId===u||!p)&&(p&&this._isMatchingEventRelationship(t.Relationship,d)||!p),s&&t.EventName&&a.push(o[l]),s;if(t.ControlId)return Object(T.a)(t.EventName,n)&&t.ControlId===c}}).map(n=>this._convertEventDescriptorToCustomEvent(e,n,t)),a]}return[[],[]]}_convertEventDescriptorToCustomEvent(e,t,n){const r=Object(c.j)(e,t.LibraryName);return{Identifier:this._generateEventIdentifier(t.EventName),EventName:t.EventName,PassExecutionContext:t.PassExecutionContext,AttributeName:t.AttributeName,FunctionName:t.FunctionName,Parameters:Object(T.b)(this._container,t.Parameters),contextKey:Object(v.w)(n),CustomizationInfo:{functionName:t.FunctionName,webResourceName:r&&r.name,solutionName:r&&r.solutionName,solutionVersion:r&&r.solutionVersion,publisherName:r&&r.publisherName,type:t.EventName,source:"This event handler is defined via the form XML."},BehaviorInBulkEditForm:t.BehaviorInBulkEditForm}}getClientApiForm(e){const t=Object(s.d)(this._pageId,e,this._clientApiManager);if(!t){const t=[];t.push({name:"contextKey",value:Object(v.w)(e)}),this._telemetryEventManager.ReportComponentFailure("ScriptManager.customEventManager.getClientApiForm",new Error("XrmForm is null or undefined"),null,t)}return t}_getFormContext(e,t){const n=Object(s.d)(this._pageId,e,this._clientApiManager);if(!n){const t=[{name:"contextKey",value:Object(v.w)(e)},{name:"isContainerNull",value:null==this._container}];this._telemetryEventManager.ReportComponentFailure("ScriptManager.customEventManager._getFormContext",new Error("clientApiObject is null or undefined"),null,t)}return this._getFormContextFromClientApiObject(n,t)}_getFormContextFromToken(e,t){const n=Object(s.d)(this._pageId,e,this._clientApiManager);if(!n){const t=[{name:"contextKey",value:Object(v.w)(e)},{name:"isContainerNull",value:null==this._container}];this._telemetryEventManager.ReportComponentFailure("ScriptManager.customEventManager._getFormContextFromToken",new Error("clientApiObject is null or undefined"),null,t)}return this._getFormContextFromClientApiObject(n,t)}_getFormContextFromClientApiObject(e,t){return e&&!t&&e.getGrid&&"function"==typeof e.getGrid&&e.getGrid()&&e.getGrid().getSelectedRows()&&1===e.getGrid().getSelectedRows().getLength()?e.getGrid().getSelectedRows().get(0):e&&t&&e.getGrid&&"function"==typeof e.getGrid&&e.getGrid()&&e.getGrid().getRows()&&e.getGrid().getRows().getLength()>0?e.getGrid().getRows().get(t):e}getClientApiGrid(e){const t=Object(s.d)(this._pageId,e,this._clientApiManager);if(!t){const t=[];t.push({name:"contextKey",value:Object(v.w)(e)}),this._telemetryEventManager.ReportComponentFailure("ScriptManager.customEventManager.getClientApiGrid",new Error("grid is null or undefined"),null,t)}return t}_getRelationship(e,t){let n=null;return Object(a.b)("event.source",()=>{const r=Object(s.d)(this._pageId,t,this._clientApiManager);if(r&&r.getEntityName&&"function"==typeof r.getEntityName&&r.getGrid&&"function"==typeof r.getGrid&&r.getGrid()&&r.getGrid().getSelectedRows()&&1===r.getGrid().getSelectedRows().getLength()){const a=!Object(I.a)(Object(A.S)(e,this._pageId,t)),i=r.getEntityName(),o=r.getGrid().getSelectedRows().get(0).data.entity.getEntityName();a&&i!==o&&(n=o)}}),n}_isMatchingEventRelationship(e,t){return Object(I.a)(e)&&Object(I.a)(t)||!Object(I.a)(e)&&e===t}_getCustomEventEnabledState(e,t,n,r){var a,i;if(null==t?void 0:t.isDisabled)return"Disabled in form XML";if(Object(W.Hb)(e,this._pageId))return"Enabled"===(null==t?void 0:t.BehaviorInBulkEditForm)?"Enabled by BehaviorInBulkEditForm attribute in the form xml. By default this attribute is not added, so the enablement is an intentional behavior by the form xml owner.":"Disabled in bulk edit form. This is by design";const o=null===(a=Object(L.d)(e,"DisableFormHandlers"))||void 0===a?void 0:a.map(e=>e.toLocaleLowerCase());if((null==o?void 0:o.length)>0){const e=o[0],n=null===(i=null==t?void 0:t.EventName)||void 0===i?void 0:i.toLocaleLowerCase();if(!(e===n||"true"===e&&J.has(n)))return"Enabled";o.splice(0,1);const a=o.map(e=>parseInt(e,10));return 0===a.length||this._isIndexDisabledInRange(r,a)?"Disabled by config flag":"Enabled"}return this._isFormLibraryDisabledByConfigFlag(e,n)?"Disabled by config flag":"Enabled"}_isFormLibraryDisabledByConfigFlag(e,t){var n,r,a;if(!t)return!1;const i=Object(L.c)(e,"DisableFormLibraries");if("true"===(null==i?void 0:i.toLocaleLowerCase()))return!0;const s=Object(R.b)(e,this._pageId),c=Object(o.h)(e,s),l=Object(y.x)(e),u=null===(r=null===(n=null==c?void 0:c.FormLibraries)||void 0===n?void 0:n.map(e=>this._normalizeWebResourceName(e,l,!0)))||void 0===r?void 0:r.indexOf(this._normalizeWebResourceName(t,l,!0)),d=null===(a=Object(L.d)(e,"DisableFormLibraries"))||void 0===a?void 0:a.map(e=>parseInt(e,10));return(null==d?void 0:d.length)>0&&this._isIndexDisabledInRange(u,d)}_isIndexDisabledInRange(e,t){return!(null==e||!t||0===t.length||t.some(e=>{null==e||isNaN(e)}))&&(1===t.length?t[0]===e:(null==t?void 0:t.length)>=2&&(e>=t[0]&&e<=t[1]))}_flushMonitorEvents(e,t,n){if(Object(D.a)()){const r=Object(x.c)(e(),this._pageId);r===this._pageId&&Object(F.a)(t,r,n)}}_normalizeWebResourceName(e,t,n=!1){var r;const a=null===(r=null==e?void 0:e.replace(t,""))||void 0===r?void 0:r.replace(/^\$webresource:/i,"");return n?null==a?void 0:a.toLocaleLowerCase():a}_sendAllEventsToMonitor(e,t,n,r,a){var i,o,s;if(!n)return null;const c=Object(W.o)(t,n,a),l=[...n.EventHandlers];null==c||c.forEach(e=>{var t;(null===(t=null==e?void 0:e.EventHandlers)||void 0===t?void 0:t.length)>0&&e.EventHandlers.forEach(t=>l.push(Object.assign(Object.assign({},t),{AttributeName:e.Name})))});const u={};l.map(e=>{if(null==e?void 0:e.EventName){const t=Z(e);u[t]||(u[t]=[]),u[t].push(e)}});const d={};Object.keys(u).forEach(e=>{const n=u[e],a=[];for(let e=0;e<n.length;e++){const i=n[e],o=this._convertEventDescriptorToCustomEvent(t,i,r),s=this._getCustomEventEnabledState(t,o,i.LibraryName,e);a.push({eventIndex:e,function:i.FunctionName,library:i.LibraryName,enabledState:s})}d[e]=a});const p=[];for(let e=0;e<(null===(i=n.FormLibraries)||void 0===i?void 0:i.length);e++){const r=n.FormLibraries[e];p.push({libraryIndex:e,library:r,disabledByConfigFlag:this._isFormLibraryDisabledByConfigFlag(t,r)})}const f={Message:`All events except form business rules are reported here. Please refer to ${M.z}.${X.businessRule} opeartion for details of business rules.`,AllEvents:d,AllLibraries:p};null===(s=null===(o=null==e?void 0:e.TraceManager)||void 0===o?void 0:o.getTracer(`${M.u}${M.z}`))||void 0===s||s.warn(M.B,[{name:w.l,value:M.z},{name:M.z,value:JSON.stringify(f)}])}async _handleContainerError(e,t,n,r){if(!Object(D.a)())return;await e(Object(B.e)(G));const a=Object(U.e)(t(),G),i=`${Object(U.c)(a,"Custom_Event_Load_WebResource_Error")||"An error occurred while loading the web resource before any events were triggered. If any form event handler has an issue later this error might be the reason."}\n${null==r?void 0:r.errorMessage}`;let o=null;const s=t(),c=Object(x.c)(s,this._pageId);o=Object(F.b)(c,"loadWebResource");const l={identifier:this._generateEventIdentifier("loadWebResource"),eventName:"loadWebResource",webResource:null==r?void 0:r.fileName,functionName:null==r?void 0:r.func,errorMessage:null==r?void 0:r.errorMessage,errorCallStack:null==r?void 0:r.stackTrace};o.push({message:i,event:l}),this._flushMonitorEvents(t,n,"loadWebResource")}_reset(){this._onChangeEvents=[],this._onLoadEvents=[],this._onSaveEvents=[],this._onClickEvents=[],this._onKeyPressEvents=[],this._onProcessChangeEvents=[],this._onProcessStatusChangeEvents=[],this._onPreProcessStatusChangeEvents=[],this._onPreStageChangeEvents=[],this._onStageChangeEvents=[],this._onStageSelectedEvents=[],this._onTabStateChangeEvents=[],this._preSearchEvents=[],this._onResultOpenedEvents=[],this._onSelectionEvents=[],this._onPostSearchEvents=[],this._onReadyStateComplete=[],this._onDataLoadEvents=[],this._businessRuleExecutionEvents=[],this._onGridDataLoadEvents=[],this._onRecordSelectEvents=[],this._onChangeDisabledFields=[],this._lockedHandlers={},this._onLookupTagClickEvents=[],this._onPostSaveEvents=[]}}},"/to1":function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var r,a=n("QEBF"),i=n("hGVc"),o=n("JK2E"),s=n("MrAI"),c=n("ghc6"),l=n("8aze"),u=(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});function d(e){switch(e){case"normal":return"normal";case"bold":return"bold";default:return Number(e)}}var p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return u(t,e),t.prototype.getElementName=function(){return this.props.semanticTag||"span"},t.prototype.getElementClassName=function(){var e=this.props.styles?this.props.styles.rule:"";return this.props.className?e+" "+this.props.className:e},t.prototype.getElementProps=function(){var e={};switch(this.props.role){case o.a:e[i.p]=this.props.notificationType||s.a}return e},t.displayName="Text",t}(a.a);function f(e){return e&&e.style?e.style.fontWeight?Object.assign({},{fontWeight:"string"==typeof e.style.fontWeight?d(e.style.fontWeight):e.style.fontWeight},Object(l.a)(e)):Object.assign(e.style,Object(l.a)(e)):{}}var g=c.a((function(e){return{rule:f(e)}}))(p)},"/uKC":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.shouldRetryForStatus=function(e){return!(e>=300&&e<500&&408!==e||501===e||505===e)},e.getMillisToBackoffForRetry=function(e){var t,n=Math.floor(1200*Math.random())+2400;return t=Math.pow(4,e)*n,Math.min(t,12e4)},e}();t.default=r},"/y4C":function(e,t,n){e.exports=n("liLA")()},"01Vp":function(e,t,n){"use strict";n.d(t,"c",(function(){return p})),n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return d}));var r=n("odYE"),a=n("Hevb"),i=n("iZ7K"),o=n("Wc7r"),s=n("g22U"),c=n("O4uv"),l=n("8i4h");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function u(e,t,n,r,a,o={},s){return Object(i.o)(e,t.etn)||null==s||s.warn(`The entity set name of ${t.etn} in buildDeleteRequest is null or undefined!`),d(e,t.etn,t.id.guid,r,null,n,a,o)}function d(e,t,n,r,a,u,d,p={}){let f=Object(i.o)(e,t);n&&(f=`${f}(${n})`),r&&(f=f+"/"+r),a&&(f+=a);let g=s.c.Delete;r?g=s.c.BinaryDelete:a&&(g=s.c.DeleteWithUrlParams);const h=Object(s.g)(p),m={urlParameters:f,method:"DELETE",additionalParameters:Object(l.a)(s.d.DELETE,h,t,g),additionalHeaders:{}};return r||(m.additionalHeaders[o.HEADER.IF_MATCH]=u||"*"),d&&Object(c.b)(m,d),m}function p(e){return{type:"SERIALIZE_DELETE_REQUEST",execute({dispatch:t,getState:n},i){const o=e.get_target();return Promise.resolve(u(n(),r.a.fromLegacyEntityReference(o),Object(a.b)(e.get_concurrencyBehavior(),o.getValue("versionnumber"))))}}}},"03Hu":function(e,t,n){"use strict";n.d(t,"a",(function(){return O}));var r=n("ufH1"),a=n("umme"),i=n("84PK"),o=n("504W"),s=n("NMtn"),c=n("VA/h"),l=n("l3Ef"),u=n("8Mff"),d=n("i8tO"),p=n("FZk4"),f=n("2LZB");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class g{constructor(e){this._syncErrorCount=0,this._syncErrorCount=e}get_syncErrorCount(){return this._syncErrorCount}set_syncErrorCount(e){return this._syncErrorCount=e,e}}var h=n("1nJ/"),m=n("3fL6"),b=n("jZCH"),y=n("EW4s"),_=n("/A0C"),v=n("Div0");let S=null;class O{constructor(e,t,n){this._isOfflineDataSourceInitialized=!1,this._localDataSource=null,this._applicationStatusProvider=null,this._offlineTypescriptInterface=null,this._offlineSyncInfo=new g(0),Object(s.d)(t,"serverUri"),Object(s.d)(e,"loacalDataSource"),this._localDataSource=e,this._applicationStatusProvider=n}get_applicationStatusProvider(){return this._applicationStatusProvider}get_isOfflineDataSourceInitialized(){return this._isOfflineDataSourceInitialized}get_offlineSyncInfo(){if(Object(o.a)(this._offlineSyncInfo))throw Error.invalidOperation("OfflineSyncInfo has not been initialized yet.");return this._offlineSyncInfo}get_syncErrorCount(){return this.get_offlineSyncInfo().get_syncErrorCount()}set_syncErrorCount(e){return this.get_offlineSyncInfo().set_syncErrorCount(e),e}get_offlineTypescriptInterface(){return this._offlineTypescriptInterface}set_offlineTypescriptInterface(e){this._offlineTypescriptInterface=e}get_localDataSource(){return this._localDataSource}initialize(e){const t=new y.a;return this._localDataSource.initializeOfflineComponents(e).then(e=>{this._isOfflineDataSourceInitialized=!0,Object(r.d)("OfflineDataSource.Initialize.Done",v.a.storage,"Offline Data source initialization completed succesfully"),t.resolve(this._isOfflineDataSourceInitialized)},e=>{this._isOfflineDataSourceInitialized=!1,Object(r.b)("OfflineDataSource.Initialize.Fail",v.a.storage,"Offline Data source initialization failed with error: "+e.get_Message()),t.reject(e)}),t}refreshLookupData(e,t,n,r){const a=new y.a,i={},s=t.get_fieldTypes();for(const n in s){const r={key:n,value:s[n]},a=r.value;if((a===_.a.Lookup||a===_.a.Customer||a===_.a.Owner)&&t.hasValue(r.key)){const n=t.getValue(r.key);if(Object(o.a)(n))continue;if(!n.equals(e)&&this._offlineTypescriptInterface.isEntityAvailableForOfflineUsage(n.LogicalName)){const e=n.LogicalName in i?i[n.LogicalName]:{};if(n.Id.toString()in e){const t=e[n.Id.toString()];t[t.length]=r.key,e[n.Id.toString()]=t}else e[n.Id.toString()]=[r.key];i[n.LogicalName]=e}}}const l=[];for(const e in i){const t={key:e,value:i[e]},a=t.value;l.push(this._localDataSource.get_offlineDataStore().retrieveLookupRecords(Object.keys(a),t.key,r,n))}return Object(c.a)(l).then(e=>{for(const n of e){const e=n;for(const n of e.get_entities()){const e=n.get_identifier(),r=i[n.get_identifier().LogicalName][n.get_identifier().Id.toString()];for(let n=0;n<r.length;n++){t.getValue(r[n]).equals(e)||t.setValue(r[n],e)}}}a.resolve(t)},()=>{a.resolve(t)}),a}refreshRetrieveMultipleLookupData(e,t,n){const a=new y.a,i={},s=[],l=e.get_entities();for(let e=0;e<l.length;e++){const t=l[e].get_fieldTypes();for(const n in t){const r={key:n,value:t[n]},a=r.value;if((a===_.a.Lookup||a===_.a.Customer||a===_.a.Owner)&&l[e].hasValue(r.key)){const t=l[e].getValue(r.key);if(Object(o.a)(t))continue;if(this._offlineTypescriptInterface.isEntityAvailableForOfflineUsage(t.LogicalName)){s.indexOf(r.key)<0&&s.push(r.key);const e=t.LogicalName in i?i[t.LogicalName]:[];e.indexOf(t.get_identifier())<0&&(e.push(t.get_identifier().toUpperCase()),i[t.LogicalName]=e)}}}}const u=[];for(const e in i)u.push(this._localDataSource.get_offlineDataStore().retrieveLookupRecords(i[e],e,n,t));return Object(c.a)(u).then(t=>{const n={};for(const e of t){const t=e.get_entities();for(let e=0;e<t.length;e++)n[t[e].get_key()]=t[e]}for(let e=0;e<l.length;e++)for(const t of s)if(l[e].hasValue(t)&&!Object(o.a)(l[e].getValue(t))){const r=l[e].getValue(t),a=r.get_identifier()in n?n[r.get_identifier()].get_identifier():null;Object(o.a)(a)||r.equals(a)||l[e].setValue(t,a)}a.resolve(e)},t=>{Object(r.d)("OfflineDataSource_RefreshRetrieveMultipleLookupData_OfflineError",v.a.storage,t.get_Message()),a.resolve(e)}),a}getExistingActivityParties(e){const t=new y.a;if(Object(o.a)(e.getValue(l.c))||e.getValue(l.c)===i.a.get_empty())return Object(r.d)("OfflineDataSource_GetExistingActivityParties",v.a.storage,"No activityparty data to retrieve for current entity"),t.resolve(new Array(0));const n=new Array(0),a=[new p.a(l.c+l.l+l.B,e.getValue(l.c).toString(),m.a.Or,0)],s=new f.a(a);return this._localDataSource.get_offlineDataStore().retrieveLocalEntities(l.d,s).then(e=>{const a=Object(o.a)(e)||Object(o.a)(e.rows)?0:e.rows.length,i=l.e;for(let t=0;t<a;t++)Object(o.a)(e.rows.item(t))||Object(o.a)(e.rows.item(t)[i])||(n[n.length]=e.rows.item(t)[i].toUpperCase());Object(r.d)("OfflineDataSource_GetExistingActivityParties",v.a.storage,"GetExistingActivityParties completed successfully"),t.resolve(n)},e=>{Object(r.e)("OfflineDataSource_GetExistingActivityParties - Failure",v.a.storage,e.get_Message()),t.reject(e)}),t}startPlayback(e){return h.a.get_DefaultInstance().startPlayback(e)}hasItemsToUpsync(){return h.a.get_DefaultInstance().hasItemsToUpsync()}hasOfflineChanges(e,t){return h.a.get_DefaultInstance().isLocalCopy(e,t)}applyApplicationMetadataChanges(){return this._localDataSource.get_offlineDataStore().applyApplicationMetadataChanges()}createActivityPointerAndAttachmentView(){this._localDataSource.get_offlineDataStore().createActivityPointerAndAttachmentView()}calculateDisabledOfflineEntities(){return Object(r.d)("OfflineDataSource_CalculateDisabledOfflineEntities",v.a.storage,"Calculate disabled offline entities"),Object(o.a)(this._localDataSource.get_offlineDataStore().get_offlineMetadataManager())?(new y.a).reject(a.a.FromMessage("Cannot calculate disabled offline entities as the OfflineMetadataManager object is not available")):this._localDataSource.get_offlineDataStore().get_offlineMetadataManager().calculateDisabledOfflineEntitiesAfterMetadataSync()}isEntityAvailableForOfflineUsage(e){return this._offlineTypescriptInterface.isEntityAvailableForOfflineUsage(e)}isOfflineAvailableForUse(){return this._offlineTypescriptInterface.isOfflineAvailableForUse()}isOfflineFeatureEnabledForOrganization(){return this._offlineTypescriptInterface.getIsMocaOfflineFeatureEnabled()}isAppAvailableOffline(){return this._offlineTypescriptInterface.isAppAvailableOffline()}isOfflineOptedIn(){return this._offlineTypescriptInterface.getOfflineFeatureStatus()===u.a.Enabled}isDssOfflineEnabled(){return this._offlineTypescriptInterface.isDssOfflineEnabled()}static get_DefaultInstance(){return Object(o.a)(b.a.get_DefaultInstance())||Object(o.a)(S)&&(S=new O(b.a.get_DefaultInstance().get_LocalDataSource(),b.a.get_DefaultInstance().get_ServerUri(),b.a.get_DefaultInstance().get_ApplicationStatusProvider()),b.a.get_DefaultInstance().get_LocalDataSource().set_offlineDataStore(new d.a)),S}}},"09gH":function(e,t,n){"use strict";n.d(t,"k",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"e",(function(){return i})),n.d(t,"h",(function(){return o})),n.d(t,"i",(function(){return s})),n.d(t,"f",(function(){return c})),n.d(t,"g",(function(){return l})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return d})),n.d(t,"j",(function(){return p})),n.d(t,"l",(function(){return f})),n.d(t,"n",(function(){return g})),n.d(t,"m",(function(){return h})),n.d(t,"a",(function(){return m})),n.d(t,"o",(function(){return b}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="jqGrid.strings.integer",a="Invalid_Date_Time",i="_common.styles.duration.htc_71",o="D1A3FDEE-DE35-43E0-8D04-629726F19C08",s="2C5BD24E-AF86-4179-9865-52359439BD0E",c="BE995A69-9CC9-4507-80E3-F46BD0797510",l="C9A1167E-2464-4E5C-A0B4-872B05B8F667",u="56796A28-3D03-49E0-8A96-78F796BB0E44",d="826F4F88-FF87-479D-B0CA-4CA19E481E53",p="Field.Email.Error",f="CustomControl_MaxLengthExceeded_Error",g="Field.Required.Error",h="Field.Number.Error",m="Field.Currency.Error",b=[r,"Invalid_Decimal",a,i,o,s,c,l,u,d,p,f,"IW_ExportTemplate_MaxValue","IW_ExportTemplate_MinValue",g,h,m]},"0FMG":function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"f",(function(){return l})),n.d(t,"e",(function(){return d})),n.d(t,"g",(function(){return f})),n.d(t,"d",(function(){return g}));var r=n("WkRo"),a=n("lq82"),i=n("uZvv");const o="sitemap.select.subarea",s="sitemap.select.area",c="sitemap.set.expanded.state";function l(e,t){return{sync:!0,type:"setSelectedSubAreaIdSync",execute({dispatch:n,getState:o}){n(u(e)),Object(r.a)();const s=Object(i.a)(o());n(Object(a.b)("areaId",{id:s},t)),n(Object(a.b)("subAreaId",{id:e},t))}}}function u(e){return{type:o,payload:{selectedSubAreaId:e}}}function d(e,t=null){return p(e)}function p(e){return{type:s,payload:{selectedAreaId:e}}}function f(e){return{type:c,payload:{sitemapExpandedState:e}}}function g(e){return{sync:!0,type:"restoreSubAreaFromHistoryState",execute({dispatch:t}){const n=t(Object(a.a)("subAreaId",e));(null==n?void 0:n.id)&&t(u(n.id));const r=t(Object(a.a)("areaId",e));(null==r?void 0:r.id)&&t(p(r.id))}}}},"0GT3":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("N6mg"),a=n("FZDd"),i=n("BR3n"),o=n("EY5k");function s(){return{type:"initializeQuickCreateMenu.async",execute:({dispatch:e,getState:t},n,s)=>(e(Object(o.e)(i.b)),e(Object(r.a)()).then(t=>{if(t&&t.quickCreateMenuItems){const n={};for(const e in t.quickCreateMenuItems)n[e]=[];e(Object(a.e)(n))}}))}}},"0Lym":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("+Kwi");class a{constructor(e,t,n,r,a){this._dateEnd=null,this._dateStart=null,this._delta=0,this._daylightStart=null,this._daylightEnd=null,this._dateEnd=e,this._dateStart=t,this._delta=n,this._daylightStart=r,this._daylightEnd=a}get_DateStart(){return this._dateStart}get_DateEnd(){return this._dateEnd}get_DaylightStart(){return this._daylightStart}get_DaylightEnd(){return this._daylightEnd}get_Delta(){return this._delta}getObjectData(){const e={};return e.dateend=this._dateEnd,e.datestart=this._dateStart,e.delta=this._delta,e.daylightstart=this._daylightStart.getObjectData(),e.daylightend=this._daylightEnd.getObjectData(),e}static createFromObjectData(e){const t=e.datestart,n=e.dateend,i=e.delta,o=r.a.createFromObjectData(e.daylightstart),s=r.a.createFromObjectData(e.daylightend);return new a(n,t,i,o,s)}}},"0buK":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * The unique name of the TaskBasedFlow page module.
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="TaskBasedFlow"},"0cBP":function(e,t,n){"use strict";n.d(t,"c",(function(){return l})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return c}));var r=n("8nT0"),a=n("iZ7K"),i=n("LbMF"),o=n("504W");function s(e,t,n){const a=Object(i.a)(e,t,r.y);if(!a||!a.OptionSet)return null;const o=a.OptionSet;for(const e of o)if(e.Value===n&&e.TransitionData)return e.TransitionData;return null}function c(e,t,n,c,l=!1){const u=Object(a.h)(e,t);if(!u||Object(o.a)(u.EnforceStateTransitions))return[];const d=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t,n){const a=Object(i.a)(e,t,r.y);if(!a||!a.OptionSet)return[];const o=[],s=a.OptionSet;for(const e of s)e.State===n&&o.push(e.Value);return o}(e,t,n);if(Object(o.a)(d))return[];if(!l&&u.EnforceStateTransitions){if(Object(o.a)(c))return[];const n=s(e,t,c);return Object(o.a)(n)?[]:d.filter(e=>e===c||n.indexOf(e)>=0)}return d}function l(e,t){const n=Object(i.a)(e,t,r.x);return n&&n.OptionSet&&null!==n.DefaultValue&&void 0!==n.DefaultValue?n.DefaultValue:null}},"0eNV":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class r{constructor(e,t){this._relationShipName=null,this._columnNames=null,this._relationShipName=e,this._columnNames=t}get_relationShipName(){return this._relationShipName}get_columnNames(){return this._columnNames}}},"0fHr":function(e,t,n){"use strict";var r,a;n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),function(e){e.date="date",e.dateonly="dateonly",e.datetime="datetime",e.dateandtime="dateandtime"}(r||(r={})),function(e){e.connection="connection",e.date="date",e.dateTime="datetime",e.duration="duration",e.email="email",e.language="language",e.none="none",e.phone="phone",e.regarding="regarding",e.text="text",e.textArea="textarea",e.tickerSymbol="tickersymbol",e.timeZone="timezone",e.url="url"}(a||(a={}))},"0hkU":function(e,t,n){"use strict";function r(e){return e?e.getTimezoneOffset():0}function a(){return""}function i(){return"Web"}function o(){return 1}function s(e,t,n){return alert(e.text),Promise.resolve({})}function c(e,t,n){return alert((e.message||"")+(e.errorCode?" ("+e.errorCode+")\n\n":"\n\n")+(e.details||"")),Promise.resolve({})}function l(e,t,n){var r=confirm((e.title?e.title+"\n"+(e.subtitle?e.subtitle+"\n":"\n"):"")+e.text);return Promise.resolve({confirmed:r})}n.d(t,"d",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"g",(function(){return c})),n.d(t,"f",(function(){return l}))},"0iNb":function(e,t,n){"use strict";n.d(t,"a",(function(){return M})),n.d(t,"b",(function(){return F}));var r=n("w1eR"),a=n("Zvo8"),i=n("ruPX"),o=n("QbIY"),s=n("ZuxC"),c=n("E5IU"),l=n("UZFl"),u=n("69Qu"),d=n("17x/"),p=n("C78e"),f=n("KeJu"),g=n("yRo8"),h=n("+BIz"),m=n("tICD"),b=n("EY5k"),y=n("YxC/"),_=n("69gE"),v=n("iF9X"),S=n("ml6Y"),O=n("RADj"),C=n("pEXn"),E=n("lMS8");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const I=["Metadata_Dialog_Button_Update","Metadata_Dialog_Button_Skip","Update_Metadata_Prompt_Title","Metadata_Download_Confirmation"];function w(e,t,n){return{type:"offline.metadata.downlaod.async",async execute({dispatch:r,getState:a},i){let o;const s=Object(c.r)(a());var l,u;s?(await r(Object(E.d)()),o=!0):o=await r((l="Update_Metadata_Prompt_Title",u="Metadata_Download_Confirmation",{type:"offline.metadata.confirm.dialog.async",execute:({dispatch:e,getState:t})=>e(Object(b.e)(I)).then(()=>{const n=Object(y.e)(t(),I),r=Object(y.c)(n,l),a=Object(y.c)(n,u),i=Object(y.c)(n,"Metadata_Dialog_Button_Update"),o=Object(y.c)(n,"Metadata_Dialog_Button_Skip");return e(Object(h.a)(a,{},r,void 0,"",i,o)).then(t=>{if(0===t.status)return e(Object(m.a)(t.pageId)).then(e=>e.value.confirmed);throw t.error})})}));const d=a(),p=Object(v.e)(d),f=n.TraceManager.getTracer(g.f),w=[];let j=null,P=!1;if(o){const n=s?"Sync started with offline by default app":"Update button is clicked";if(f.warn(`OfflineMetadataDownloadActions.DownloadOfflineMetadataWithUserConfirmation: ${n}.`),!p){const n=new _.a(i,t),a=n.IsExecAvailable();return a&&n.onSyncStart(),r(Object(g.h)(e)).then(()=>{a&&n.onSyncComplete()}).catch(e=>{throw a&&n.onSyncError(),e})}j=O.a.InSyncWithServer,P=!0,r(Object(g.i)({syncStatus:j,metadataAvailable:P}))}else j=O.a.SyncPendingFromServer,r(Object(g.i)({syncStatus:j})),f.warn("OfflineMetadataDownloadActions.DownloadOfflineMetadataWithUserConfirmation: Skip button is clicked.");if(p){Object(g.j)(i,g.c,P),w.push({name:g.c,value:P}),Object(g.j)(i,g.d,j),w.push({name:g.d,value:j});const e=!0;Object(g.j)(i,S.a.IsFirstApplicationMetadataDownloadConfirmationDoneKey,e),w.push({name:C.b.IsFirstDownloadPromptAlreadyTriggered,value:e}),f.warn("OfflineMetadataDownloadActions.DownloadOfflineMetadataWithUserConfirmation: IsFirstDownloadPromptAlreadyTriggered is set to "+e,w)}}}}var j=n("0kGT"),P=n("wL2W"),T=n("bktA"),N=n("Lyxw"),A=n("3/02"),R=n("pulT"),D=n("FoFY"),x=n("3eti");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function M(e){const t=/[?&](pagetype)/i.exec(e.search);return t&&t.length>1?e.searchParams.get(t[1]):null}async function F(e,t){let n=new URL(window.location.href,window.location.origin);const a=e.getStore(),o=t.PlatformContext.getLandingPage();if(o){const e=T.a+".navigateToPage",r=[{name:"foundLandingPageUrl",value:!0}];t.EventManager.ReportComponentSuccess(e,r),n=new URL(o,window.location.origin)}const u=d.e(a.getState()),p=u?null:M(n),f=e.getClientHost()===r.a.MobileApplication||u;await Object(P.c)(a,t.EventManager,n);const g=Object(N.d)(a.getState(),A.Qh,A.i)?Object(i.a)(n.toString()):Object(i.a)(n.toString(),void 0,void 0,{replaceState:!0});if(null!==p)return a.dispatch(g);if(f){const r=Object(c.k)(a.getState());if(!r){const e={webresourceName:void 0};return a.dispatch(Object(i.a)(l.a,e))}return function(e,t,n){return Object(j.c)(t)?Promise.resolve(null):n.DataSource?Promise.resolve(n.DataSource.retrieveSessionState(s.a)).then(t=>t?t[e]:null):Promise.resolve(null)}(r,a.getState(),t).then(r=>r?(n=new URL(r,window.location.origin),e.setInitialUrl(n),k(()=>a.dispatch(Object(i.a)(n.toString())),a,t,f)):k(L.bind(null,a),a,t,f))}return k(L.bind(null,a),a,t,f)}async function k(e,t,n,r){const a=n.DataSource.get_IsLocalDataSourceAvailable();return Object(u.c)(t.getState())&&r&&d.c(t.getState())&&a?(await function(e,t){const n=e.getState(),r=S.a.IsFirstApplicationMetadataDownloadConfirmationDoneKey,a=t.TraceManager.getTracer(g.f),i=[];if(i.push({name:C.b.IsApplicationMetadataDownloadInShimEnabled,value:Object(v.e)(n)}),!Object(v.e)(n))return B(e,t);return e.dispatch(Object(x.a)(r)).then(n=>{const o=function(e,t){if(e&&e[t])return e[t];return!1}(n,r);if(i.push({name:C.b.IsFirstDownloadPromptAlreadyTriggered,value:o}),a.warn("BootNavigationHelper.performOfflineMetadataSync",i),!o)return B(e,t)})}(t,n),e()):e()}function L(e){const t=Object(R.a)(e.getState()),n={targetBrowsingContext:Object(D.a)(e.getState(),t).anchorTabId};return e.dispatch(Object(o.a)(n)).then(()=>{if(navigator.cookieEnabled){const t=Object(c.k)(e.getState());if(null!==t){const n=Object(a.b)("persistentNavTourCookie_"+t);if(null==Object(a.b)("sessionNavTourCookie_"+t)&&(null==n||null!==n&&"false"===n)){Object(a.c)("sessionNavTourCookie_"+t,"true",0);const n=Object(c.p)(e.getState());n&&n.name&&""!==n.name&&e.dispatch(Object(p.a)(null,n.name))}}}})}function B(e,t){return e.dispatch(Object(f.c)()).then(n=>{if(n)return e.dispatch(w(n,e,t))})}},"0kGT":function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"c",(function(){return g})),n.d(t,"b",(function(){return h}));var r=n("Lyxw"),a=n("3/02"),i=(n("u+q+"),n("GYEz")),o=n("LzVy"),s=n("sclX"),c=n("w1eR"),l=n("H4dV"),u=n("hAdb"),d=n("4gfk");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const p=e=>{const t=Object(o.a)(e),n=Object(i.a)(e);return t===s.b.Native&&n!==c.a.MailApp&&(l.a.getInstance().get_IsIOS()||l.a.getInstance().get_IsAndroid())},f=e=>{const t=Object(o.a)(e),n=Object(i.a)(e);return t===s.b.Native&&n!==c.a.MailApp&&l.a.getInstance().get_IsWindows()},g=e=>!!p(e)||!!Object(u.e)(e,d.a),h=e=>!!Object(u.e)(e,d.a)||p(e)&&Object(r.f)(e,a.o)},"0l0t":function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"f",(function(){return a})),n.d(t,"g",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"e",(function(){return c})),n.d(t,"a",(function(){return l}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="_NA_Info",a="_NA_SFA",i="_NA_CS",o="_NA_MA",s="_NA_IMA",c="_NA_PROC",l="_NA_AO"},"0lM4":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class r{constructor(e,t,n,r=null){this._promise=null,this._contextString=null,this._cacheName=null,this._retrievalStrategy=null,this._promise=e,this._contextString=t,this._cacheName=n,this._retrievalStrategy=r}getPromise(){return this._promise}getContextString(){return this._contextString}getCacheName(){return this._cacheName}getRetrievalStrategy(){return this._retrievalStrategy}setRetrievalStrategy(e){this._retrievalStrategy=e}}},"0nOn":function(e,t,n){"use strict";n.d(t,"a",(function(){return O}));var r=n("2yvP"),a=n("pEXn"),i=n("+Qpx"),o=n("IaGr"),s=n("f/sd"),c=n("mL5Q"),l=n("arV0"),u=n("FdB0"),d=n("cfbi"),p=n("EBJu"),f=n("4aOd"),g=n("ABCl"),h=n("wL2W"),m=n("zmL5"),b=n("SAYH"),y=n("PR89"),_=n("+6s6");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const v=new Set,S=[{fileName:_.c,apiName:null}];class O{constructor(e,t,n,r,a){this._store=e,this._pageId=n,this._isInMonitoringSession=Object(h.a)(),this._clientApiExecutor=new g.b(e,t,r,a)}isPageReadyForClientAPIAccess(e){return this._getIsPageReadyForClientAPIAccessState(e).ready}getComponentName(e){return this._clientApiExecutor.getComponentName(e)}reportFailure(e,t,n){return this._clientApiExecutor.reportFailure(e,t,n)}execute(e,t,n,r=!0,a=!1){return this._clientApiExecutor.execute(e,(n,r,a)=>(this._reportUnsupportedClientApiAccess(e,n,r),t(n,r,a)),n,r,a)}executeAsync(e,t,n,r=!0,a=!1){return this._clientApiExecutor.executeAsync(e,(n,r,a)=>(this._reportUnsupportedClientApiAccess(e,n,r),t(n,r,a)),n,r,a)}addEventParameter(e){this._clientApiExecutor.addEventParameter(e)}runClientApiChecker(e,t,n){this._clientApiExecutor.runClientApiChecker(e,t,n)}_reportUnsupportedClientApiAccess(e,t,n){var r,s;const{ready:c,pageLoadingState:l}=this._getIsPageReadyForClientAPIAccessState(t);if(!c){let c=this._isInMonitoringSession;if(!c){const e=Object(m.b)(null===(r=this._store)||void 0===r?void 0:r.getState(),this._pageId);c=!b.a.isNullOrEmpty(e)&&v.has(e),c&&v.add(e)}if(c=c&&!S.find(n=>(!n.fileName||t&&(null==t?void 0:t.indexOf(n.fileName))>=0)&&(!n.apiName||n.apiName===e)),c){n.push({name:"pageLoadingState",value:l});const e=new f.a(new Error);n.push({name:"callStack",value:e.getStackTrace()}),null===(s=o.a.getInstance().traceManager.getTracer(`${i.u}${i.q}`))||void 0===s||s.error(i.B,[{name:a.l,value:i.q},{name:i.q,value:JSON.stringify(n)}])}}}_getIsPageReadyForClientAPIAccessState(e){var t,n;const a=null===(t=this._store)||void 0===t?void 0:t.getState(),i=null===(n=Object(r.a)())||void 0===n?void 0:n.sourceName,o=this._isApiExemptFromUnsupportedClientApiAccessCheck(e);if(!a||null===this._pageId||void 0===this._pageId||"bpf.initialization"===i||"form.initialization"===i||"page.initialization"===i||o)return{ready:!0,pageLoadingState:void 0};const f=Object(l.p)(a,this._pageId),g=Object(c.a)(a,this._pageId);return{ready:!(f===d.b||f===p.a||f===u.a)||g>=s.a.OnLoadReady&&g!==s.a.Error,pageLoadingState:g}}_isApiExemptFromUnsupportedClientApiAccessCheck(e){return(null==e?void 0:e.indexOf(y.a))>=0}}},"0rLi":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("iJGp"),a=n("504W");class i{constructor(e,t,n,r,a,i,o,s,c,l,u=!1){this.MetadataType=null,this.MetadataSubtype=null,this.EntityLogicalName=null,this.MetadataId=null,this.MetadataNames=null,this.GetDefault=!1,this.DependencyDepth=0,this.ChangedAfter=null,this.Exclude=null,this.AppId=null,this.IsPreloadCall=!1,this.UseServerCache=!1,this.MetadataType=e,this.MetadataSubtype=t,this.EntityLogicalName=n,this.MetadataId=r,this.MetadataNames=a,this.GetDefault=i,this.DependencyDepth=o,this.ChangedAfter=s,this.Exclude=c,this.AppId=l,this.UseServerCache=u}toString(){let e="";if(Object(a.b)(this.MetadataType)||(e+=String.format("MT: {0}; ",this.MetadataType)),Object(a.b)(this.MetadataSubtype)||(e+=String.format("MST: {0}; ",this.MetadataSubtype)),Object(a.b)(this.EntityLogicalName)||(e+=String.format("ELN: {0}; ",this.EntityLogicalName)),this.MetadataId&&(e+=String.format("MI: {0}; ",this.MetadataId.toString())),this.MetadataNames&&this.MetadataNames.length>0){e+=String.format("MNS: ");for(const t of this.MetadataNames)e+=String.format("{0} ",t);e+="; "}if(e+=String.format("GD: {0}; ",this.GetDefault.toString()),e+=String.format("DD: {0}; ",r.a[this.DependencyDepth]),Object(a.b)(this.ChangedAfter)||(e+=String.format("CA: {0}; ",this.ChangedAfter)),this.Exclude&&this.Exclude.length>0){e+=String.format("EX: ");for(const t of this.Exclude)e+=String.format("{0} ",t);e+="; "}return this.AppId&&(e+=String.format("AI: {0}; ",this.AppId.toString())),e+=String.format("SC: {0}; ",this.UseServerCache.toString()),e}}},"0uKS":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("fILV"),a=n("ruPX");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function i(e,t,n,i,o,s,c,l,u,d,p){const f={entityTypeName:e,viewId:n,viewType:u,showChart:i,visualizationType:o,visualizationId:s,filterExpression:c,chartDrillDownParameters:d,isQueryMode:p&&p.isQueryMode,isAdvancedFindView:p&&p.isAdvancedFindView};return Object(a.a)(r.a,f,t,l)}},"0zhR":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(){function e(){}return e.getControlsResourceKeyList=function(e){if(!e)return null;switch(e){case"MscrmControls.Calendar.CalendarControl":return["CustomControl_Calendar_AllDayItem","CustomControl_Calendar_Today","CustomControl_Calendar_WeekView","CustomControl_Calendar_MonthView","CustomControl_Calendar_DayView","CustomControl_Calendar_ErrorView_DefaultMessage","CustomControl_Calendar_ViewMore"];case"MscrmControls.Containers.FieldSectionItem":return["ProcessControl.RequiredStepTooltip"]}return null},e}()},"11K9":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("pEXn");function a(e,t){const{navPath:n,canOverride:a,etn:i,type:o,dashboardId:s}=e||{};return[{name:r.b.DashboardNavPath,value:n},{name:r.b.ShowDefaultDashboard,value:a},{name:r.b.ActionType,value:t},{name:r.b.EntityName,value:i},{name:r.b.DashboardType,value:o},{name:r.b.DashboardId,value:s&&s.guid}]}},"16wZ":function(e,t,n){"use strict";n.d(t,"j",(function(){return f})),n.d(t,"e",(function(){return p})),n.d(t,"a",(function(){return y})),n.d(t,"b",(function(){return _})),n.d(t,"k",(function(){return m})),n.d(t,"h",(function(){return S})),n.d(t,"c",(function(){return O})),n.d(t,"d",(function(){return C})),n.d(t,"l",(function(){return b})),n.d(t,"g",(function(){return g})),n.d(t,"f",(function(){return h})),n.d(t,"i",(function(){return v}));var r=n("zsAz"),a=n("Uv1Y"),i=n("SAYH"),o=n("ngeo"),s=n("EY5k"),c=n("YxC/"),l=n("ZIjf"),u=n("IaGr"),d=n("VIXY");function p(e,t,n,a){throw e&&(n||(n=t),a||(a=[]),a.push({name:"validationError",value:"true"}),u.a.getInstance().traceManager.getTracer(e).error(n,a)),Object(r.d)(t,2415919121)}function f(e,t,n){n||(n=[]),n.push({name:"name",value:t});p(e,"Required parameter is null or undefined: "+t,"Required parameter is null or undefined",n)}function g(e,t,n,r){null==e&&f(t,n,r)}function h(e,t,n,r,a){a||(a=[]),"guid"===r?i.a.validate(n)||(a.push({name:"type",value:typeof n}),m(e,r,t,a)):"array"===r?Array.isArray(n)||(a.push({name:"type",value:typeof n}),m(e,r,t,a)):typeof n!==r&&(a.push({name:"type",value:typeof n}),m(e,r,t,a))}function m(e,t,n,r){r||(r=[]),r.push({name:"expectedType",value:t}),r.push({name:"name",value:n});p(e,`Value should be of type: ${t}: Parameter Name: ${n}`,"Parameter type validation error",r)}function b(e){p(e,"Invalid XML Format")}function y(e){return null==e}function _(e){return!((new DOMParser).parseFromString(e,"text/xml").getElementsByTagName("parsererror").length>0)}function v(e,t,n){const r=`The API ${t} is not supported in the current context`;n||(n=[]),n.push({name:"apiName",value:t}),p(e,r,"API not supported in the current context",n)}function S(e,t,n,r){const a=`Invalid value ${n} for ${t}`;r||(r=[]),r.push({name:"name",value:t}),r.push({name:"value",value:n}),p(e,a,"Invalid value",r)}function O(e,t){return C(e,t,"ClientApi.ErrorValidation.parseError")}function C(e,t,n,i,p=!0,f=!0,g,h){var m;const b="ClientApi.ErrorValidation.parseErrorToResponse";let y;const _="An error has occurred. Try this action again. If the problem continues, check the Microsoft Dynamics 365 Community for solutions or contact your organization's Microsoft Dynamics 365 Administrator. Finally, you can contact Microsoft Support.";try{if(i||(i=[]),i.push({name:"sourceComponent",value:n}),function(e){
//!error.name to stop UCIError giving false positive
return e&&e.errorCode&&e.errorCode>0&&e.message&&!e.name}(t))return Promise.reject(t);let v,S;const O="Error_Message_Generic",C="Error_Message_Generic_Instruction",I="CRM_Dynamics_Community",w="Microsoft_Support";let j,P,T,N;if(null==t?void 0:t.displayMessage)v=t.message,y=t.errorCode;else if(E(t))S=t.get_organizationServiceFault();else if(t&&t.reason&&E(t.reason))S=t.reason.get_organizationServiceFault();else if(function(e){return e&&e.hasOwnProperty("_errorSource")&&e instanceof Error}(t)){y=t.errorCode,v=t.message;const e=t.innerError;e&&(j={message:e.message,stacktrace:e.stack})}else if(Object(r.f)(t)){y=a.a.fromLegacyErrorStatus(t).errorCode,v=t.get_Message();const e=t.get_InnerError();e&&(j={message:e.get_Message(),stacktrace:""})}else Object(r.g)(t)&&(y=t.errorCode,v=t.message);if(S){y=S.get_errorCode(),v=S.get_message();const e=S.get_innerFault();e&&(j={message:e.get_message(),stacktrace:e.get_callStack()})}if(i.push({name:"errorMessage",value:v}),y){f&&l.a.instance.reportSuccess(n,h),y<0&&(y=y+4294967295+1),i.push({name:"errorCode",value:y});const e="0x"+o.a.getHexErrorCodeFromInt(y);T="Error_Message_"+e,N="Error_Title_"+e,P=[T,N],p&&u.a.getInstance().traceManager.getTracer(n).error("Error detected with an error code.  See EventContext for more details.",i)}else f&&l.a.instance.reportFailure(n,h),P=[O,C,I,w],p&&(t||(t=new Error("Received blank error object")),g?g.reportFailure(n,t,i):u.a.getInstance().eventManager.ReportComponentFailure(n,t,null,i));return(null==t?void 0:t.displayMessage)?(y=null!==(m=t.errorCode)&&void 0!==m?m:2147746581,Promise.reject({errorCode:y,message:t.displayMessage})):2148081666===y?Promise.reject({errorCode:y,message:v,code:y,innerror:j}):2147746405===y?(t.innerError&&t.innerError.message?v=t.innerError.message:t.message&&(v=t.message),Promise.reject({errorCode:y,message:v,code:y,innerror:j})):(2415919125===y&&(y=2147746581),e?e.dispatch(Object(s.e)(P)).then(()=>{const n=Object(c.e)(e.getState(),P);let r,a;if(y)if(r=Object(c.c)(n,T),a=Object(c.c)(n,N),r){if(t.param)r=String.format(r,t.param);else if(t.errorParameters){const e=t.errorParameters.map(e=>e.value);r=String.format(r,e)}}else 2147746581!==y&&(t.message&&(r=t.message),u.a.getInstance().eventManager.ReportComponentFailure(b+".localizedErrorMessage",new Error("Error message for the error code is not present in resource file"),"Add the error message in resource file correspond to error code",i));else y=2147746581;if(!r){const e=Object(d.a)(Object(c.c)(n,C),Object(c.c)(n,I),Object(c.c)(n,w));r=Object(d.a)(Object(c.c)(n,O),e,"")}const o={errorCode:y,message:r,code:y,title:a};throw j&&(o.innerror=j),o}):(u.a.getInstance().eventManager.ReportComponentFailure(b,new Error("Could not retrieve localized error strings, store is null or undefined"),null,i),y||(y=2147746581),Promise.reject({errorCode:y,message:_,code:y})))}catch(e){return u.a.getInstance().eventManager.ReportComponentFailure(b,e,null,i),y||(y=2147746581),Promise.reject({errorCode:y,message:_,code:y})}}function E(e){return null==e?void 0:e.get_organizationServiceFault}},"17x/":function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"d",(function(){return v})),n.d(t,"c",(function(){return S})),n.d(t,"g",(function(){return O})),n.d(t,"i",(function(){return C})),n.d(t,"e",(function(){return E})),n.d(t,"j",(function(){return I})),n.d(t,"f",(function(){return w})),n.d(t,"l",(function(){return j})),n.d(t,"b",(function(){return P})),n.d(t,"k",(function(){return T})),n.d(t,"h",(function(){return N}));var r=n("SAYH"),a=n("E5IU"),i=n("IqkD"),o=n("NjDY"),s=n("iF9X"),c=n("Lyxw"),l=n("3/02"),u=n("GYEz"),d=n("w1eR"),p=n("hAdb"),f=n("69Qu"),g=n("37s6"),h=n("pEXn");var m;function b(){return-1!==window.navigator.userAgent.indexOf("Chrome")}function y(){return e="openDatabase",void 0!==window.self[e];var e}function _(e,t){const n=r.a.toString(Object(i.e)(e)),o=Object(a.b)(e,161),s=null!==n&&null!==o&&o.indexOf(n)>=0;return t&&t.TraceManager.getTracer("Offline").info("Offline profile "+(s?"found":"NOT found")+" for profile id: "+n+" - app id: "+Object(a.k)(e)+" - app name: "+Object(a.l)(e)),s}function v(e,t){return!(!Object(o.n)(e)&&!E(e))&&_(e,t)}function S(e){return!!Object(s.a)(e)&&_(e)}function O(e,t){let n=Object(c.f)(e,l.Eh);return t&&t.searchParams&&t.searchParams.has("cache")&&(n="true"===t.searchParams.get("cache")),n}function C(e){return Object(a.r)(e)&&Object(f.d)(e)&&Object(g.D)(e)}function E(e){return(Object(c.f)(e,l.D)||Object(c.f)(e,l.je))&&y()&&Object(u.a)(e)===d.a.Browser&&b()}function I(e){return E(e)&&Object(c.f)(e,l.je)}function w(e){return(Object(p.a)(e,l.D)||Object(p.a)(e,l.je))&&y()&&Object(u.a)(e)===d.a.Browser&&b()}function j(e){return Object(c.f)(e,l.ye)&&Object(c.g)(e,"MobileClientOneDbPerProfile")}function P(e,t){const n=!!Object(a.i)(h.b.EnableRoleBasedOfflineProfileAccess,e),r=j(e);t.push({name:h.b.EnableServerAndNativeFCBForRoleBasedProfileAccess,value:r}),t.push({name:h.b.EnableRoleBasedOfflineProfileSetting,value:n}),t.push({name:h.b.EnableRoleBasedOfflineProfileAccess,value:r&&n})}function T(e){const t=Object(c.g)(e,l.ve),n=Object(c.f)(e,l.ve);return t&&n}function N(e){if(e){if("Completed"===e.totalProgress&&e.totalErrorCount>0||"Error"===e.totalProgress)return{isFileSyncCompleted:!0,isFileSyncCompletedWithError:!0};if("Completed"===e.totalProgress&&0===e.totalErrorCount)return{isFileSyncCompleted:!0,isFileSyncCompletedWithError:!1}}return{isFileSyncCompleted:!1,isFileSyncCompletedWithError:!1}}!function(e){e[e.Ok=1]="Ok",e[e.UnknownMapping=2]="UnknownMapping",e[e.NoDefaultMapping=3]="NoDefaultMapping",e[e.MappingInconsistency=4]="MappingInconsistency",e[e.ProfileSwitch=5]="ProfileSwitch"}(m||(m={}))},"1Bax":function(e,t,n){"use strict";n.d(t,"b",(function(){return d})),n.d(t,"c",(function(){return p})),n.d(t,"a",(function(){return h}));var r=n("/leX"),a=n("LqfC"),i=n("DMoA"),o=n("rcL5"),s=n("504W"),c=n("5X+N"),l=n("r0fD"),u=n("3peg");function d(e,t){return{type:a.i,sync:!0,execute({dispatch:n,getState:r},c){var d,p;const g=r(),h=Object(o.i)(g,e);t.sidePanelPosition&&(null===(d=h.option)||void 0===d?void 0:d.sidePanelPosition)!==t.sidePanelPosition&&Object(i.b)(g,h.sidePanelId,t.sidePanelPosition),t.sidePanelState&&Object(i.h)(t.sidePanelState),t.sidePanelPosition&&Object(i.g)(t.sidePanelPosition),t.sidePanelWidth&&Object(i.i)(t.sidePanelWidth);try{t.sidePanelWidth&&localStorage.setItem(a.w,t.sidePanelWidth+"px"),!Object(s.a)(t.sidePanelState)&&2!==t.sidePanelState&&localStorage.setItem(a.t,t.sidePanelState.toString())}catch(e){}n(f(e,t)),!Object(s.a)(t.sidePanelState)&&2===(null===(p=h.option)||void 0===p?void 0:p.sidePanelPosition)&&Object(u.d)(r())&&(0===t.sidePanelState?n(Object(l.b)(0,t.sidePanelPosition)):1===t.sidePanelState&&n(Object(l.b)(1,t.sidePanelPosition)))}}}function p(e,t){return{type:a.l,sync:!0,execute({dispatch:n,getState:r},a){const s=r();Object(o.i)(s,e),t.sidePanelPosition&&Object(i.g)(t.sidePanelPosition),t.sidePanelWidth&&Object(i.i)(t.sidePanelWidth),n(f(e,t))}}}function f(e,t){return{type:a.j,payload:{sidePanelId:e,option:t}}}function g(e){return{type:a.c,sync:!0,execute({dispatch:t,getState:n},a){const i=n(),s=Object(u.e)(i,e);if(1===s.panesState&&s.selectedPane){const e=Object(o.i)(i,s.selectedPane);e.type===r.b.Pane?t(Object(l.a)(0,2)):1===e.option.sidePanelState&&Object(c.b)().then(e=>{t(e.setPanelOptions(s.selectedPane,{sidePanelState:0}))})}}}}function h(){return{type:a.d,sync:!0,execute({dispatch:e,getState:t},n){e(g(1)),e(g(2))}}}},"1DaZ":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("Ri7K"),a=n("3BuU"),i=function(){function e(e){this._event={name:"",properties:{}},e&&this.setName(e)}return e.prototype.setName=function(e){this._event.name=e},e.prototype.getName=function(){return this._event.name},e.prototype.setType=function(e){this._event.type=e},e.prototype.getType=function(){return this._event.type},e.prototype.setTimestamp=function(e){this._event.timestamp=e},e.prototype.getTimestamp=function(){return this._event.timestamp},e.prototype.setEventPriority=function(e){this._event.priority=e},e.prototype.getEventPriority=function(){return this._event.priority},e.prototype.setProperty=function(e,t,n){void 0===n&&(n=a.AWTPropertyType.Unspecified);var i={value:t,type:n,pii:a.AWTPiiKind.NotSet,cc:a.AWTCustomerContentKind.NotSet};null!==(i=r.sanitizeProperty(e,i))?this._event.properties[e]=i:delete this._event.properties[e]},e.prototype.setPropertyWithPii=function(e,t,n,i){void 0===i&&(i=a.AWTPropertyType.Unspecified);var o={value:t,type:i,pii:n,cc:a.AWTCustomerContentKind.NotSet};null!==(o=r.sanitizeProperty(e,o))?this._event.properties[e]=o:delete this._event.properties[e]},e.prototype.setPropertyWithCustomerContent=function(e,t,n,i){void 0===i&&(i=a.AWTPropertyType.Unspecified);var o={value:t,type:i,pii:a.AWTPiiKind.NotSet,cc:n};null!==(o=r.sanitizeProperty(e,o))?this._event.properties[e]=o:delete this._event.properties[e]},e.prototype.getPropertyMap=function(){return this._event.properties},e.prototype.getEvent=function(){return this._event},e}();t.default=i},"1Ibc":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("Lyxw"),a=n("3/02"),i=n("NjDY"),o=n("H4dV");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function s(e){const t=Object(i.D)(e);return Object(r.f)(e,a.Vd)&&!t.globalHelpUrlEnabled&&t.isContextualHelpEnabled&&!o.a.getInstance().get_IsBrowserIE()}},"1OTd":function(e,t,n){"use strict";n.d(t,"m",(function(){return r})),n.d(t,"q",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"n",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"f",(function(){return l})),n.d(t,"g",(function(){return u})),n.d(t,"r",(function(){return d})),n.d(t,"j",(function(){return p})),n.d(t,"k",(function(){return f})),n.d(t,"l",(function(){return g})),n.d(t,"s",(function(){return h})),n.d(t,"t",(function(){return m})),n.d(t,"o",(function(){return b})),n.d(t,"p",(function(){return y})),n.d(t,"e",(function(){return _})),n.d(t,"d",(function(){return v})),n.d(t,"h",(function(){return S})),n.d(t,"i",(function(){return O})),n.d(t,"u",(function(){return C}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="router.start",a="router.updatebrowsingcontext",i="router.adddialogcontexttobrowsingcontext",o="router.removedialogcontextfrombrowsingcontext",s="router.closebrowsingcontext",c="router.closebrowsingcontextinternal",l="router.createbrowsingcontext",u="router.createbrowsingcontextinternal",d="router.updateBrowsingContextViewport",p="router.navigateTo.async",f="router.navigateToNewWindow.async",g="Navigation.Cancelled",h="router.updatedialogcontext",m="router.updatedialogcontextinternal",b="router.removepagefromdialogcontexthistory",y="router.removepagefromdialogcontexthistoryinternal",_="router.closedialogcontexts",v="router.closedialogcontext",S="router.createdialogcontext",O="router.createdialogcontextinternal",C="router.updatedialogcontextoutputs"},"1RM4":function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"e",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return s}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="SetLogFetchSuccess",a="swlogfetchsuccess",i="PurgeGcmCache",o="PurgeCache",s="SetIsBrowserOfflineEnabledWithFlag"},"1S8a":function(e,t,n){"use strict";n.d(t,"c",(function(){return d})),n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return p}));var r=n("E5IU"),a=n("pF61"),i=n("arV0"),o=n("UZFl"),s=n("eXjw"),c=n("4leG");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function l(e){const t=Object(r.k)(e);return Object(c.b)(e)||!!t}function u(e){return!Object(c.b)(e)&&!l(e)}function d(e){return!Object(c.b)(e)&&function(e){const t=Object(a.c)(e),n=Object(r.k)(e);let s=!1;return Object(i.p)(e,t)!==o.a||n||(s=!0),s}(e)}function p(e){const t=d(e),n=function(e){return!Object(c.b)(e)&&!l(e)}(e);return!function(e){const t=Object(c.e)(e),n=Object(r.e)(e);return t&&(null==n?void 0:n.initialized)===s.a.Initialized}(e)&&(t||n)}},"1SVz":function(e,t,n){"use strict";n.d(t,"c",(function(){return P})),n.d(t,"b",(function(){return w})),n.d(t,"a",(function(){return I}));var r=n("u+q+"),a=n("mMyr"),i=n("kXuq"),o=n("/to1"),s=n("q441"),c=n("N2HV"),l=n("Fn63"),u=n("InN9"),d=n("CvZq"),p=n("n2e+"),f=n("3rse"),g=n("FhVi"),h=n("Afz2");class m extends a.Component{_isUiBlocker(){return this.props.type===d.a.BlockingUI}componentDidMount(){this._onKeyDownHandler=this._onKeyDownHandler.bind(this),document.addEventListener("keydown",this._onKeyDownHandler)}componentWillUnmount(){document.removeEventListener("keydown",this._onKeyDownHandler)}_onKeyDownHandler(e){e.keyCode===f.a.Escape&&(this._isUiBlocker()?this.props.reconnect&&this.props.reconnect():this.props.close&&this.props.close())}render(){if(!this.props.isReconnectNotificationShown)return null;let e=this.props.reconnectNotificationHeaderText,t=this.props.reconnectNotificationBodyText,n=this.props.styles.reconnectNotificationBodyStyle;return this._isUiBlocker()&&(e=this.props.reconnectUIBlockerNotificationHeaderText,t=this.props.reconnectUIBlockerNotificationBodyText),this.props.isReconnectSuccessful||(t=this.props.reconnectNotificationReconnectFailBodyText,n=this.props.styles.reconnectNotificationBodyWarningStyle),a.createElement(u.b,{id:"reconnect_notification_Id",key:"reconnect_notification_key",role:h.v,testhooks:{id:"reconnect_notification_Id"},flyoutStyle:this.props.styles.reconnectNotificationRootFlyoutStyle,positionType:"absolute",position:{left:0,top:0,right:0,bottom:0}},a.createElement(i.a,{id:"reconnectNotificationView",style:this.props.styles.reconnectNotificationViewStyle,role:h.f,testhooks:{"uci-dialog":!0},labelledByElementId:"reconnect_notification_reconnect_title_Id",describedByElementId:"reconnect_notification_reconnect_message_Id"},a.createElement(g.a,{key:"reconnectNotificationViewAccessibility",rootElementId:"reconnectNotificationView",isModal:!0,defaultFocusId:"reconnect_notification_reconnect_button_Id",overrideFocusId:"reconnect_notification_reconnect_button_Id",shouldManageFocus:!0}),a.createElement(i.a,{style:this.props.styles.reconnectNotificationFormHeaderStyle},a.createElement(o.a,{id:"reconnect_notification_reconnect_title_Id",style:this.props.styles.reconnectNotificationHeaderStyle,accessibilityLabel:e,semanticTag:"h1"},e),this._isUiBlocker()?null:this._renderCloseButtonIcon()),a.createElement(i.a,{style:this.props.styles.reconnectNotificationHeaderStyle},this._renderProgressIndicator(),a.createElement(o.a,{id:"reconnect_notification_reconnect_message_Id",style:n,accessibilityLabel:t},t)),a.createElement(i.a,{style:this.props.styles.reconnectNotificationButtonContainerStyle},this._renderReconnectButton(),this._isUiBlocker()?null:this._renderCancelButton())))}_renderProgressIndicator(){return a.createElement(p.b,{key:"reconnectNotificationProgressIndicator"})}_renderReconnectButton(){return a.createElement(s.a,{style:this.props.styles.reconnectNotificationReconnectButtonStyle,id:"reconnect_notification_reconnect_button_Id",onClick:this.props.reconnect,testhooks:{id:"reconnect_notification_reconnect_button_Id"},accessibilityLabel:this.props.reconnectNotificationReconnectButtonText},a.createElement(o.a,{style:this.props.styles.reconnectNotificationReconnectButtonTextStyle,role:h.v},this.props.reconnectNotificationReconnectButtonText))}_renderCancelButton(){return a.createElement(s.a,{style:this.props.styles.reconnectNotificationCancelButtonStyle,id:"reconnect_notification_cancel_button_Id",onClick:this.props.close,testhooks:{id:"reconnect_notification_cancel_button_Id"},accessibilityLabel:this.props.reconnectNotificationCancelButtonText},a.createElement(o.a,{style:this.props.styles.reconnectNotificationCancelButtonTextStyle,role:h.v},this.props.reconnectNotificationCancelButtonText))}_renderCloseButtonIcon(){return a.createElement(s.a,{style:this.props.styles.reconnectNotificationCloseButtonStyle,id:"reconnect_notification_close_button_Id",onClick:this.props.close,testhooks:{id:"reconnect_notification_close_button_Id"},accessibilityLabel:this.props.reconnectNotificationCancelButtonText},a.createElement(c.b,{type:l.a.Close}))}}m.displayName="ReconnectNotificationView";var b=n("unFF"),y=n("b8TU");function _(e){const t=function(e){const t=Object(b.a)(e);return Object(y.c)(e)<=t.sizes.Breakpoints.DimensionS}(e),n=Object(b.a)(e),r={backgroundColor:"white",width:"376px",minHeight:"236px",margin:"auto",flexDirection:"column",display:"flex",border:n.borders.Border01,padding:t?n.sizes.Measures.Measure100:n.sizes.Measures.Measure150,boxShadow:n.shadows.Shadow01,boxSizing:t?"border-box":void 0,alignSelf:"flex-end",justifyContent:t?"space-between":"flex-start"},a={marginTop:"0px",marginBottom:n.sizes.Measures.Measure125,fontFamily:n.fontFamilies.Semilight,fontSize:n.fontSizes.Font125},i={marginTop:"0",marginBottom:n.sizes.Measures.Measure125,alignSelf:"flex-start",fontFamily:n.fontFamilies.Regular,fontSize:n.fontSizes.Font100,flexDirection:t?"column":void 0},o={boxSizing:t?"border-box":void 0,alignSelf:t?"center":"flex-end",flexDirection:t?"column":"row",justifyContent:"flex-end",marginTop:"auto",width:t?"100%":"auto"},s={marginTop:t?n.sizes.Measures.Measure050:0,marginLeft:t?0:n.sizes.Measures.Measure050,alignSelf:"flex-end",width:t?"100%":void 0},c="-"+(t?n.sizes.Measures.Measure075:n.sizes.Measures.Measure050),l={marginTop:c,marginRight:c},u=Object.assign(Object.assign({},s),n.buttons.Button01Primary),d=Object.assign(Object.assign({},s),n.buttons.Button01Secondary),p=n.buttons.ButtonPrimaryText,f=n.buttons.ButtonSecondaryText,g=Object.assign(Object.assign({},l),n.buttons.ActionIconButton01);return{reconnectNotificationRootFlyoutStyle:{backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",positionType:"absolute"},reconnectNotificationViewStyle:r,reconnectNotificationHeaderStyle:a,reconnectNotificationBodyStyle:i,reconnectNotificationBodyWarningStyle:Object.assign(Object.assign({},i),{color:n.colors.BaseColor.Red.Red3}),reconnectNotificationButtonTextStyle:{marginTop:"auto",marginBottom:"5px",marginRight:"5px",alignSelf:"flex-end",color:"white"},reconnectNotificationButtonContainerStyle:o,reconnectNotificationReconnectButtonStyle:u,reconnectNotificationCancelButtonStyle:d,reconnectNotificationCloseButtonStyle:g,reconnectNotificationFormHeaderStyle:{display:"flex",justifyContent:"space-between"},reconnectNotificationReconnectButtonTextStyle:p,reconnectNotificationCancelButtonTextStyle:f}}var v=n("6fj+"),S=n("83Lp"),O=n("JhlA"),C=n("YxC/"),E=n("4leG");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const I="The attempt to reconnect failed. Please try again.",w="The connection was successfully restored.",j=function(){let e=null;return function(t){const n=Object(v.a)(t),r=Object(v.b)(t),a=Object(v.e)(t);return e&&e.isReconnectNotificationShown===n&&e.isReconnectSuccessful===r&&e.showReconnectNotificationAfterUpsync===a||(e={styles:_(t),isReconnectNotificationShown:n,showReconnectNotificationAfterUpsync:a,reconnectNotificationHeaderText:Object(C.b)(t,O.h)||"The network connection has been restored.",reconnectNotificationBodyText:Object(C.b)(t,O.g)||"Would you like to reconnect?",reconnectNotificationReconnectFailBodyText:Object(C.b)(t,O.d)||I,reconnectNotificationReconnectButtonText:Object(C.b)(t,O.c)||"Try Again",reconnectNotificationCancelButtonText:Object(C.b)(t,O.a)||"Cancel",reconnectUIBlockerNotificationHeaderText:Object(C.b)(t,O.k)||"Server unreachable.",reconnectUIBlockerNotificationBodyText:Object(C.b)(t,O.j)||"We are having trouble connecting to the server. This may be due to a temporary issue with the server or internet connectivity. Ensure you have internet connectivity and try again. If the problem persists, please contact your administrator.",reconnectNotificationProgressIndicatorText:Object(C.b)(t,O.e)||"Reconnecting...",reconnectNotificationSuccessNotificationText:Object(C.b)(t,O.f)||w,type:Object(v.d)(t),isReconnectSuccessful:r,isPreviewModeEnabled:Object(E.e)(t)}),e}}();const P=Object(r.a)(j,(function(e){return{close(){e(Object(S.e)())},dispatchReconnect(t,n){e(Object(S.g)(t,n,null))}}}),(function(e,t){return Object.assign({reconnect:()=>{t.dispatchReconnect(e.reconnectNotificationProgressIndicatorText,e.reconnectNotificationSuccessNotificationText)},close:t.close},e)}))(m)},"1TGm":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("iJGp"),a=n("x/aW");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function i(e,t){return e!==a.a.BusinessProcessFlow&&e!==a.a.MetadataVersion&&e!==a.a.UserMetadataVersion&&e!==a.a.AppModules&&t!==r.a.UserContext}},"1Utt":function(e,t,n){"use strict";
/** @license React v0.20.2
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r,a,i,o;if("object"==typeof performance&&"function"==typeof performance.now){var s=performance;t.unstable_now=function(){return s.now()}}else{var c=Date,l=c.now();t.unstable_now=function(){return c.now()-l}}if("undefined"==typeof window||"function"!=typeof MessageChannel){var u=null,d=null,p=function(){if(null!==u)try{var e=t.unstable_now();u(!0,e),u=null}catch(e){throw setTimeout(p,0),e}};r=function(e){null!==u?setTimeout(r,0,e):(u=e,setTimeout(p,0))},a=function(e,t){d=setTimeout(e,t)},i=function(){clearTimeout(d)},t.unstable_shouldYield=function(){return!1},o=t.unstable_forceFrameRate=function(){}}else{var f=window.setTimeout,g=window.clearTimeout;if("undefined"!=typeof console){var h=window.cancelAnimationFrame;"function"!=typeof window.requestAnimationFrame&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills"),"function"!=typeof h&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills")}var m=!1,b=null,y=-1,_=5,v=0;t.unstable_shouldYield=function(){return t.unstable_now()>=v},o=function(){},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_=0<e?Math.floor(1e3/e):5};var S=new MessageChannel,O=S.port2;S.port1.onmessage=function(){if(null!==b){var e=t.unstable_now();v=e+_;try{b(!0,e)?O.postMessage(null):(m=!1,b=null)}catch(e){throw O.postMessage(null),e}}else m=!1},r=function(e){b=e,m||(m=!0,O.postMessage(null))},a=function(e,n){y=f((function(){e(t.unstable_now())}),n)},i=function(){g(y),y=-1}}function C(e,t){var n=e.length;e.push(t);e:for(;;){var r=n-1>>>1,a=e[r];if(!(void 0!==a&&0<w(a,t)))break e;e[r]=t,e[n]=a,n=r}}function E(e){return void 0===(e=e[0])?null:e}function I(e){var t=e[0];if(void 0!==t){var n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,a=e.length;r<a;){var i=2*(r+1)-1,o=e[i],s=i+1,c=e[s];if(void 0!==o&&0>w(o,n))void 0!==c&&0>w(c,o)?(e[r]=c,e[s]=n,r=s):(e[r]=o,e[i]=n,r=i);else{if(!(void 0!==c&&0>w(c,n)))break e;e[r]=c,e[s]=n,r=s}}}return t}return null}function w(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}var j=[],P=[],T=1,N=null,A=3,R=!1,D=!1,x=!1;function M(e){for(var t=E(P);null!==t;){if(null===t.callback)I(P);else{if(!(t.startTime<=e))break;I(P),t.sortIndex=t.expirationTime,C(j,t)}t=E(P)}}function F(e){if(x=!1,M(e),!D)if(null!==E(j))D=!0,r(k);else{var t=E(P);null!==t&&a(F,t.startTime-e)}}function k(e,n){D=!1,x&&(x=!1,i()),R=!0;var r=A;try{for(M(n),N=E(j);null!==N&&(!(N.expirationTime>n)||e&&!t.unstable_shouldYield());){var o=N.callback;if("function"==typeof o){N.callback=null,A=N.priorityLevel;var s=o(N.expirationTime<=n);n=t.unstable_now(),"function"==typeof s?N.callback=s:N===E(j)&&I(j),M(n)}else I(j);N=E(j)}if(null!==N)var c=!0;else{var l=E(P);null!==l&&a(F,l.startTime-n),c=!1}return c}finally{N=null,A=r,R=!1}}var L=o;t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){D||R||(D=!0,r(k))},t.unstable_getCurrentPriorityLevel=function(){return A},t.unstable_getFirstCallbackNode=function(){return E(j)},t.unstable_next=function(e){switch(A){case 1:case 2:case 3:var t=3;break;default:t=A}var n=A;A=t;try{return e()}finally{A=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=L,t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=A;A=e;try{return t()}finally{A=n}},t.unstable_scheduleCallback=function(e,n,o){var s=t.unstable_now();switch("object"==typeof o&&null!==o?o="number"==typeof(o=o.delay)&&0<o?s+o:s:o=s,e){case 1:var c=-1;break;case 2:c=250;break;case 5:c=1073741823;break;case 4:c=1e4;break;default:c=5e3}return e={id:T++,callback:n,priorityLevel:e,startTime:o,expirationTime:c=o+c,sortIndex:-1},o>s?(e.sortIndex=o,C(P,e),null===E(j)&&e===E(P)&&(x?i():x=!0,a(F,o-s))):(e.sortIndex=c,C(j,e),D||R||(D=!0,r(k))),e},t.unstable_wrapCallback=function(e){var t=A;return function(){var n=A;A=t;try{return e.apply(this,arguments)}finally{A=n}}}},"1Xob":function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.InvalidSubscription=-2147220969]="InvalidSubscription",e[e.InvalidMetadata=-2147015408]="InvalidMetadata",e[e.AuthenticationError=-2147093995]="AuthenticationError",e[e.InvalidSubscriptionInLoop=-2147015405]="InvalidSubscriptionInLoop",e[e.SyncHandlerNotAvailable=-6]="SyncHandlerNotAvailable",e[e.DatabaseFullException=2007]="DatabaseFullException",e[e.PrivilegeDenied=-2147220960]="PrivilegeDenied",e[e.PrivilegeDeniedAdminOnly=-2147180269]="PrivilegeDeniedAdminOnly",e[e.Cancelled=2001]="Cancelled"}(r||(r={}))},"1c32":function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("fMBw"),a=n.n(r);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class i{constructor(){this._stack=[]}push(e){this._stack.push(e)}removeItem(e,t){const n=this._stack.findIndex(e);if(n>=0){const e=this._stack.splice(n,1);return e.length?e[0]:null}return null}peek(){return this._stack[this._stack.length-1]}get length(){return this._stack.length}}var o=n("TEuE");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const s=a.a.createEvent("OnContextChanged","Accessibility");class c{constructor(e,t){this._accessibilityStack=new i,this._focusCheckScheduled=!1,this._contextVisibilitySubscribers=[],this._applicationContext=e,this._isMobileApp=t}subscribeOnToggleVisibility(e){this._contextVisibilitySubscribers.push(e)}unsubscribeOnToggleVisibility(e){this._contextVisibilitySubscribers=this._contextVisibilitySubscribers.filter(t=>t&&t!==e)}get length(){return this._accessibilityStack.length}onToggleVisibility(){var e,t;for(let n=0;n<this._contextVisibilitySubscribers.length;n++)null===(t=(e=this._contextVisibilitySubscribers)[n])||void 0===t||t.call(e)}registerAccessibilityContext(e){if(e.props.shouldManageFocus&&null!=e.props.rootElementId){const t=this._registerMutationObserver(e.rootElementId);e.updateMutationObserver(t);const n=this._accessibilityStack.peek();n&&(n.isActive=!1),this._accessibilityStack.push(e),this._scheduleFocusCheck(e,t)}}deregisterAccessibilityContext(e){if(e.props.rootElementId){const t=this._accessibilityStack.peek(),n=this._accessibilityStack.removeItem(t=>t===e);n&&this._deregisterMutationObserver(n.popMutationObserver()),n===t&&this._onContextChanged()}}getCurrentAccessibilityContext(){return this._currentAccessibilityComponent}updateAccessibilityContext(e){this._currentAccessibilityComponent===e&&this._updateCurrentContext()}setClientAPISetFocusElementId(e){this._clientAPISetFocusElementId=e,this._scheduleFocusCheck(this._currentAccessibilityComponent,this._currentAccessibilityComponent&&this._currentAccessibilityComponent.mutationObserver)}isClientAPISetFocusScheduled(){return!!this._clientAPISetFocusElementId}_scheduleFocusCheck(e,t){this._focusCheckScheduled||(Object(o.f)(this._checkIfCompletelyRendered.bind(this,e,t),o.a),this._focusCheckScheduled=!0)}_checkIfCompletelyRendered(e,t){if(this._focusCheckScheduled=!1,e&&t){e.checkIfCompletelyRendered(this._clientAPISetFocusElementId,this._isMobileApp)&&(this._deregisterMutationObserver(t),setTimeout(this._onContextChanged.bind(this),100))}}_deregisterMutationObserver(e){e&&this._applicationContext.MutationObserverHandler.removeObserverTarget(e)}_onContextChanged(){const e=s.startStopwatch();this._currentAccessibilityComponent=this._accessibilityStack.peek(),this._currentAccessibilityComponent&&(this._updateCurrentContext(),this.redetermineFocusOnCurrentContext()),e()}_updateCurrentContext(){this._currentAccessibilityComponent=this._accessibilityStack.peek(),this._currentAccessibilityComponent&&(this._currentAccessibilityComponent.isActive=!0)}redetermineFocusOnCurrentContext(){this._currentAccessibilityComponent&&(this._currentAccessibilityComponent.redetermineFocusOnCurrentContext(this._clientAPISetFocusElementId),this._clientAPISetFocusElementId=null)}_registerMutationObserver(e){const t=new MutationObserver(this._mutationHandler.bind(this));return this._applicationContext.MutationObserverHandler.addObserverTarget(t,e,{childList:!0,subtree:!0,attributes:!1,characterData:!1,attributeOldValue:!1,characterDataOldValue:!1}),t}_mutationHandler(e,t){this._currentAccessibilityComponent=this._accessibilityStack.peek(),this._currentAccessibilityComponent&&this._currentAccessibilityComponent.mutationObserver===t&&this._scheduleFocusCheck(this._currentAccessibilityComponent,t)}}},"1dXh":function(e,t,n){"use strict";n.d(t,"a",(function(){return W}));var r=n("mMyr"),a=n("u+q+"),i=n("arV0"),o=n("xHmU"),s=n("syUe"),c=n("EUSs"),l=n("9lTt"),u=n("QBtP"),d=n("fueu"),p=n("Afz2"),f=n("kXuq"),g=n("/to1"),h=n("q441"),m=n("gQ5I"),b=n("N2HV"),y=n("Fn63"),_=n("unFF"),v=n("Zz+h"),S=n("b8TU"),O=n("IqkD"),C=n("FJiw"),E=n("d8rx");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function I(){let e,t,n,r=!1,a=!1,i=!1,o=!1,s=!1;return function(c,l){const u=Object(_.a)(c),d=Object(v.b)(c,l),p=Object(S.a)(c),f=Object(O.g)(c),g=function(e,t){return t&&e&&e.sizes.Breakpoints&&e.sizes.Breakpoints.DimensionS&&t.deviceWidth<e.sizes.Breakpoints.DimensionS}(u,p),h=Object(v.c)(c,l.id),m=!(!d||!d.windowPosition||"side"!==d.windowPosition),b=d&&d.hideDialogHeader;if(e!==u||r!==g||i!==m||o!==f||n!==d||a!==h||s!==b){e=u,r=g,a=h,i=m,o=f,n=d,s=b;const c={height:32,width:32,flexShrink:0},l=Object.assign(Object.assign({},u.buttons.ActionIconButton01),c);t={dialogOuterContainerStyle:{height:"100%",width:"100%",display:"flex",alignItems:"center",justifyContent:m?"flex-end":"center"},dialogStyle:{backgroundColor:u.colors.BaseColor.White,minHeight:m||h?"100%":"0px",maxHeight:m||h||g?"100%":"90%",height:m||h?"100%":"auto",minWidth:g||h?"100%":`min(${u.sizes.Dialog.Width}, 100%)`,maxWidth:g||h?"100%":"90%",flexDirection:"column",borderRadius:u.sizes.Measures.Measure015,borderStyle:u.display.SolidBorderStyle,borderWidth:u.sizes.Dialog.BorderWidth,borderColor:u.colors.BaseColor.Grey.Grey1},dialogIconButtonStyle:l,dialogIconStyle:{color:u.colors.BaseColor.Grey.Grey6,fontSize:u.fontSizes.Font1143,textAlign:"center"},dialogHeaderStyle:{display:b?"none":"flex",flexDirection:"row",backgroundColor:"white",borderBottom:u.borders.Border01,borderColor:"#E5E5E5",alignItems:"center",padding:10,minHeight:32},dialogTitleViewStyle:{flexGrow:0,overflow:"hidden",[Object(E.d)(f)]:45,width:"100%"},dialogTitleTextStyle:{fontFamily:u.fontFamilies.Semibold,fontSize:u.fontSizes.Font16px,lineHeight:"26px",color:"#323130",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},dialogPageContainerStyle:{left:0,right:0,top:0,flexDirection:"column",flexGrow:1,overflow:"hidden",borderBottomLeftRadius:u.sizes.Measures.Measure015,borderBottomRightRadius:u.sizes.Measures.Measure015,height:"100%"}},t.dialogStyle=function(e,t,n,r){const a=Object.assign({},t);n&&n.height?a.height=n.height:a.height=r?"65%":C.a.height;n&&n.width?a.width=n.width:a.width=C.a.width;return a}(0,t.dialogStyle,n,g)}return t}}var w=n("FJpk"),j=n("FhVi"),P=n("6b+r"),T=n("H4dV");var N=n("YxC/"),A=n("3rse"),R=n("oB6S"),D=n("Lyxw"),x=n("3/02");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const M="defaultDialogChrome";class F extends r.Component{constructor(e){super(e),this._titleId="",this._closeButtonId="",this._toggleExpandMode=this._toggleExpandMode.bind(this),this.state={inExpandMode:!!this.props.dialogOptions&&this.props.dialogOptions.inExpandMode},this._titleId=M+"Title-"+this.props.dialogId,this._closeButtonId=M+"CloseIconButton-"+this.props.dialogId,this.keyDownHandler=this.keyDownHandler.bind(this)}_renderHeader(){const e=M+"Header-"+this.props.dialogId;return r.createElement(f.a,{id:e,key:e,style:this.props.dialogHeaderStyle},this._renderTitleView(),!this.props.enableReflow&&this._renderResizeButtons(),this._renderCloseButton())}_renderTitleView(){const e=M+"TitleView-"+this.props.dialogId;return r.createElement(f.a,{id:e,key:e,style:this.props.dialogTitleViewStyle},this._renderTitleText())}_renderTitleText(){const e=this.props.title?this.props.title:"";return r.createElement(g.a,{style:this.props.dialogTitleTextStyle,tabIndex:this._isIE()?-1:void 0,id:this._titleId,testhooks:{id:this._titleId},accessibilityLabel:e,semanticTag:"h1",key:this._titleId},Object(P.b)(e)?this._getMultiLineHtml(e):e)}_renderResizeButtons(){const e="dialogResizeIconButton-"+this.props.dialogId,t=this.state.inExpandMode?this.props.contractDialogText:this.props.expandDialogText;return r.createElement(h.a,{key:e,style:this.props.dialogIconButtonStyle,tabIndex:0,onClick:this._toggleExpandMode,accessibilityLabel:t,testhooks:{id:e},title:t},r.createElement(b.b,{key:"dialogResizeIcon",type:this.state.inExpandMode?y.a.MiniContract:y.a.MiniExpand,style:this.props.dialogIconStyle}))}_renderCloseButton(){return r.createElement(h.a,{id:this._closeButtonId,key:this._closeButtonId,style:this.props.dialogIconButtonStyle,tabIndex:0,onClick:this.props.handleClose,accessibilityLabel:this.props.dialogCloseText,testhooks:{id:"dialogCloseIconButton"},title:this.props.dialogCloseText},r.createElement(b.b,{key:M+"CloseIcon",type:y.a.Cancel,style:this.props.dialogIconStyle}))}_renderPageContainer(){return r.createElement(f.a,{id:"dialogPageContainer-"+this.props.dialogId,style:this.props.dialogPageContainerStyle},r.Children.only(this.props.children))}render(){let e=this.props.dialogStyle;(this.state.inExpandMode||this.props.enableReflow)&&(e=Object.assign(Object.assign({},e),{width:"100%",height:"100%",maxWidth:"100%",maxHeight:"100%"}));const t=M+"OuterContainer-"+this.props.dialogId,n=M+"View-"+this.props.dialogId;return r.createElement(f.a,{id:t,key:t,style:this.props.dialogOuterContainerStyle},r.createElement(f.a,{id:n,key:n,style:e,labelledByElementId:this.props.title?this._titleId:void 0,role:this.props.title?p.f:p.v,accessibilityModal:!0,onKeyDown:this.keyDownHandler},this._renderHeader(),this._renderPageContainer(),this._renderAccessibilityComponent(n)))}keyDownHandler(e){e.keyCode===A.a.Escape&&(this.props.handleClose(),e.stopPropagation())}_renderAccessibilityComponent(e){return r.createElement(j.a,{key:"dialogAccessibility",rootElementId:e,isModal:!0,shouldManageFocus:!0,defaultFocusId:this._closeButtonId})}_toggleExpandMode(){this.setState({inExpandMode:!this.state.inExpandMode})}_isIE(){return T.a.getInstance().get_IsBrowserIE()}_getMultiLineHtml(e){const t=e.split("\n"),n=[t[0]];for(let e=1;e<t.length;e++)n.push(r.createElement("br")),n.push(t[e]);return r.createElement(r.Fragment,null,n)}}const k=Object(a.a)((function(){const e=I();return function(t,n){const r=e(t,{id:n.dialogId}),a=n.title&&Object(w.c)(n.title),i=Object(R.c)(R.b.Zoom300)&&(Object(D.f)(t,x.kf)||Object(D.f)(t,x.Th));return Object.assign(Object.assign({name:n.name,dialogId:n.dialogId,dialogOptions:n.dialogOptions,title:a,enableReflow:i},r),{dialogCloseText:Object(N.b)(t,"Button_Label_Close")||"Close",expandDialogText:Object(N.b)(t,"MainFormDialog_Expand_Button_Label")||"Enter full screen mode",contractDialogText:Object(N.b)(t,"MainFormDialog_Contract_Button_Label")||"Exit full screen mode"})}}),(function(e,t){return{handleClose:()=>{e(Object(m.e)(t.dialogId))}}}))(F);var L=n("voMr"),B=n("c/rA");class U extends r.Component{constructor(){super(...arguments),this._seeMoreStackRank=null}_getContainerStyle(){const e=this.props.isDialog?{position:"absolute",left:0,top:0,width:"100%",height:"100%",backgroundColor:this.props.dialogOptions.shadowColor?this.props.dialogOptions.shadowColor:"transparent"}:{position:"absolute",left:0,top:0};return this._seeMoreStackRank>0&&(e.zIndex=this._seeMoreStackRank),e}componentDidMount(){if(this.context&&this.context.MutationObserverHandler){const e=this.context.MutationObserverHandler,t=d.a.getInstance();this._observerTarget=new MutationObserver(()=>{t.scheduleMeasuringUpdate()});const n="DialogContainer__"+this.props.dialogId+"_popupContainer";e.addObserverTarget(this._observerTarget,n),t.scheduleMeasuringUpdate()}}componentWillUnmount(){this.context&&this.context.MutationObserverHandler&&this.context.MutationObserverHandler.removeObserverTarget(this._observerTarget)}_renderPageInstance(){const e={width:this.props.dialogOptions.width,height:this.props.dialogOptions.height,left:this.props.dialogOptions.left,right:this.props.dialogOptions.right,top:this.props.dialogOptions.top,bottom:this.props.dialogOptions.bottom,position:this.props.dialogOptions.position,opacity:this.props.dialogOptions.opacity,overflow:this.props.dialogOptions.overflow,backgroundColor:this.props.dialogOptions.backgroundColor,justifyContent:this.props.dialogOptions.shouldSupportRTL?"flex-end":void 0},t=this._getContainerStyle();return this.props.dialogOptions.useDefaultDialogChrome?r.createElement(s.a,{popupStyle:e,style:t,isDialogPopup:!0},r.createElement(k,{name:"MainPageDialogWrapper",dialogId:this.props.dialogId,dialogOptions:this.props.dialogOptions,title:this.props.title},r.createElement(B.a,{pageId:this.props.dialogId,key:this.props.dialogId,isDialog:!0}))):r.createElement(s.a,{popupStyle:e,style:t,isDialogPopup:!0},r.createElement(B.a,{pageId:this.props.dialogId,key:this.props.dialogId,isDialog:!0}))}render(){if(null===this._seeMoreStackRank&&(this._seeMoreStackRank=l.a.getInstance().getPopupCount()),this.props.dialogType===L.a.Native)return r.createElement(B.a,{pageId:this.props.dialogId,key:this.props.dialogId,isDialog:!0});const e="DialogContainer__"+this.props.dialogId,t=this.props.isDialog?this._renderPageInstance():null,n=this.props.rootNodeId?document.getElementById(this.props.rootNodeId):null;return r.createElement(c.b,{id:e,tabIndex:-1,rootBodyElement:n},t)}}U.contextType=u.a;var V=n("I6RZ"),z=n("eIIO");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const q={opacity:.5,borderStyle:"solid",width:"100%",height:"100%",right:0,top:0,position:"absolute",openInNewWindow:!0};class H extends r.Component{constructor(e,t){super(e),this._router=t.Router}componentDidMount(){this._toggleScrollOnIOS(),this._setAppShellAriaVisibility()}componentDidUpdate(){this._toggleScrollOnIOS(),this._setAppShellAriaVisibility()}_toggleScrollOnIOS(){this.props.stack.length>0?document.getElementById(z.b).classList.add("modalDialogBackgroundScrollBlock"):document.getElementById(z.b).classList.remove("modalDialogBackgroundScrollBlock")}_setAppShellAriaVisibility(){this.props.setAppShellAriaVisibility&&this.props.setAppShellAriaVisibility(this._topNodeId)}render(){const e=[];let t=!1;this._topNodeId=void 0;for(let n=this.props.stack.length-1;n>=0;n--){const a=this.props.stack[n],i=this._router.getPage(a),o=null!=i;if(i){const n=r.createElement(U,{isDialog:o,dialogOptions:this.props.dialogOptions[a],dialogId:a,title:this.props.dialogTitles[a],key:a,dialogType:this.props.dialogFlags[a],rootNodeId:this.props.rootNodeId});e.unshift(this.props.isReactInstancePageCachingEnabled?r.createElement(d.b.Provider,{value:{groupId:a},children:n}):n),t||(t=!0,this._topNodeId="DialogContainer__"+a+"_popupContainer")}}return 0===this.props.stack.length?null:r.createElement(f.a,null,e)}}H.displayName="DialogConductor",H.contextType=u.a;const W=Object(a.a)((function(){let e=[],t={},n={},r={};return function(a,s){const c=Object(o.b)(a,s.browsingContextId),l={},u={},d={};let p=!1;for(let e=0;e<c.length;e++){const t=c[e];n[t]&&n[t]===Object(i.e)(a,t)||(p=!0),l[t]=Object(i.e)(a,t)||q,u[t]=Object(i.g)(a,t),d[t]=Object(V.a)(a,t)}return(e!==c||p)&&(e=c,n=l,r=u,t=d),{stack:e,dialogOptions:n,dialogTitles:r,dialogFlags:t,isReactInstancePageCachingEnabled:Object(D.f)(a,x.gg)}}}))(H)},"1fn7":function(e,t,n){"use strict";n.d(t,"d",(function(){return B})),n.d(t,"p",(function(){return U})),n.d(t,"q",(function(){return V})),n.d(t,"r",(function(){return y})),n.d(t,"z",(function(){return z})),n.d(t,"A",(function(){return q})),n.d(t,"y",(function(){return H})),n.d(t,"v",(function(){return _})),n.d(t,"l",(function(){return v})),n.d(t,"a",(function(){return S})),n.d(t,"e",(function(){return O})),n.d(t,"k",(function(){return C})),n.d(t,"x",(function(){return E})),n.d(t,"i",(function(){return I})),n.d(t,"o",(function(){return w})),n.d(t,"m",(function(){return j})),n.d(t,"n",(function(){return P})),n.d(t,"w",(function(){return T})),n.d(t,"f",(function(){return N})),n.d(t,"h",(function(){return A})),n.d(t,"g",(function(){return R})),n.d(t,"c",(function(){return D})),n.d(t,"b",(function(){return x})),n.d(t,"s",(function(){return M})),n.d(t,"u",(function(){return F})),n.d(t,"t",(function(){return k})),n.d(t,"j",(function(){return L}));var r=n("09gH"),a=n("EDOo"),i=n("sptG"),o=n("qMYv"),s=n("+7Rg"),c=n("CpcI"),l=n("xy1J"),u=n("X3qb"),d=n("p0fx"),p=n("oSQy"),f=n("bJSG"),g=n("FdXt"),h=n("8Jtx"),m=n("LTq1"),b=n("vr5N");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const y="L_Create_And_Close_Button_Text",_="SavingInformation",v="ReadOnly",S="Dialog_Label_Active",O="Dialog_Label_Inactive",C="Form_PopOut",E="UnSavedChangesWarning",I="Local_Save_Record_Notification_Status_Message",w="RecordSetNavigator.Button.Open.Tooltip",j="RecordSetNavigator.Button.Close.Tooltip",P="RecordSetNavigator.button.name",T="SharePoint.Form.Saving",N="PageLoadingMessage",A="QuickEditForm_MaxNumberReached_Title",R="Error_Message_0x80071156",D="Button_Label_Save",x="ConfirmSave_DiscardButton",M="FormSaveStatus_Saved",F="FormSaveStatus_Unsaved",k="FormSaveStatus_Saving",L="OpenInNewWindow_TooltipTitle",B="DisableControlsMessage",U="UCI_Form_SaveAndNew",V="UCI_Form_SaveAndOpen",z=[y,"L_Lookup_New_Text",_,v,S,O,C,E,I,"CRM_System_View_Group_Name","CRM_User_View_Group_Name","ProcessControl.Configurator.Collapse","ProcessControl.Configurator.Expand",w,j,P,T,D,x,M,F,k,L,B].concat(r.o,a.c,s.c,c.g,l.p,o.e,i.i,u.g,d.a,p.h,f.c,m.e),q=z.concat(g.i,h.b,[A,R,N]),H=z.concat(b.n,g.i)},"1kth":function(e,t,n){"use strict";n.d(t,"v",(function(){return d})),n.d(t,"V",(function(){return p})),n.d(t,"W",(function(){return f})),n.d(t,"U",(function(){return g})),n.d(t,"S",(function(){return h})),n.d(t,"R",(function(){return m})),n.d(t,"T",(function(){return b})),n.d(t,"X",(function(){return y})),n.d(t,"Y",(function(){return _})),n.d(t,"d",(function(){return v})),n.d(t,"c",(function(){return S})),n.d(t,"f",(function(){return O})),n.d(t,"p",(function(){return C})),n.d(t,"a",(function(){return E})),n.d(t,"e",(function(){return I})),n.d(t,"b",(function(){return w})),n.d(t,"u",(function(){return j})),n.d(t,"l",(function(){return P})),n.d(t,"t",(function(){return T})),n.d(t,"r",(function(){return N})),n.d(t,"j",(function(){return A})),n.d(t,"k",(function(){return R})),n.d(t,"s",(function(){return D})),n.d(t,"o",(function(){return x})),n.d(t,"q",(function(){return M})),n.d(t,"i",(function(){return F})),n.d(t,"n",(function(){return k})),n.d(t,"g",(function(){return L})),n.d(t,"m",(function(){return B})),n.d(t,"h",(function(){return U})),n.d(t,"w",(function(){return V})),n.d(t,"z",(function(){return z})),n.d(t,"y",(function(){return q})),n.d(t,"B",(function(){return H})),n.d(t,"L",(function(){return W})),n.d(t,"A",(function(){return G})),n.d(t,"x",(function(){return K})),n.d(t,"Q",(function(){return Q})),n.d(t,"P",(function(){return X})),n.d(t,"N",(function(){return Y})),n.d(t,"O",(function(){return J})),n.d(t,"H",(function(){return $})),n.d(t,"G",(function(){return Z})),n.d(t,"F",(function(){return ee})),n.d(t,"K",(function(){return te})),n.d(t,"E",(function(){return ne})),n.d(t,"M",(function(){return re})),n.d(t,"J",(function(){return ae})),n.d(t,"C",(function(){return ie})),n.d(t,"I",(function(){return oe})),n.d(t,"D",(function(){return se}));var r=n("0nOn"),a=n("IaGr"),i=n("qshH"),o=n("MIBb"),s=n("1kth"),c=n("i1f0");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const l="ClientApi.CustomEventManagerWrapper.";let u;function d(e,t,n,r,a){return Object(o.a)(e,t,n,r,a)?n.ScriptManager.getContainer(r).getEventManager():null}function p(e,t,n,r){return{type:"eventManager.runOnResultOpened",sync:!0,execute({dispatch:o,getState:s},c){const u=l+"runOnResultOpened";try{const a=d(u,s(),c,t,r);a&&o(a.runOnResultOpened(e,n,r,s()))}catch(t){const r=i.a.getInstance().getEventParameters(e);throw r.push({name:"fieldName",value:n}),a.a.getInstance().eventManager.ReportComponentFailure(u,t,null,r),t}}}}function f(e,t,n,r){return{type:"eventManager.runOnSelection",sync:!0,execute({dispatch:o,getState:s},c){const u=l+"runOnSelection";try{const a=d(u,s(),c,t,r);a&&o(a.runOnSelection(e,n,r,s()))}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(u,t,null,n),t}}}}function g(e,t,n,r){return{type:"eventManager.runPostSearch",sync:!0,execute({dispatch:o,getState:s},c){const u=l+"runOnPostSearch";try{const a=d(u,s(),c,t,r);a&&o(a.runOnPostSearch(e,n,r,s()))}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(u,t,null,n),t}}}}function h(e,t,n,r){return{type:"eventManager.runOnDataLoad",sync:!0,execute({dispatch:o,getState:s},c){const u=l+"runOnDataLoad";try{const a=d(u,s(),c,t);a&&o(a.runOnDataLoad(e,n,r))}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(u,t,null,n),t}}}}function m(e,t,n){return{type:"eventManager.runOnChange",sync:!0,execute({dispatch:r,getState:o},s){const c=l+"runOnChange";try{const a=d(c,o(),s,t);a&&r(a.runOnChange(e,n))}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(c,t,null,n),t}}}}function b(e,t,n,r){return{type:"eventManager.runOnKeyPress",sync:!0,execute({dispatch:o,getState:s},c){const u=l+"runOnKeyPress";try{const a=d(u,s(),c,t);a&&o(a.runOnKeyPress(e,n,r))}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(u,t,null,n),t}}}}function y(e,t,n,r){return{type:"eventManager.runPreSearch",sync:!0,execute({dispatch:o,getState:s},c){const u=l+"runPreSearch";try{const a=d(u,s(),c,t);return!!a&&o(a.runPreSearch(e,n,r))}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(u,t,null,n),t}}}}function _(e,t,n,a){return{type:"eventManager.runSetAdditionalParams",sync:!0,execute:(i,o)=>function(e,t){u||(u=new r.a(e,l,t));return u}(i,t).execute("runSetAdditionalParams",(r,s)=>{const c=d(r,i.getState(),o,t,s);return!!c&&i.dispatch(c.runSetAdditionalParams(e,n,a))},[{name:"contextToken",value:JSON.stringify(e),isEventParam:!0},{name:"controlName",value:n,isEventParam:!0}],!1)}}function v(e,t,n,r){return{type:"eventManager.addOnGridDataLoad",sync:!0,execute({dispatch:o,getState:s},c){const u=l+"addOnGridDataLoadEvent";try{const a=d(u,s(),c,t);a&&a.addOnGridDataLoad(e,n,r)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(u,t,null,n),t}}}}function S(e,t,n){return{type:"eventManager.addOnDataLoad",sync:!0,execute({dispatch:r,getState:o},s){const c=l+"addOnDataLoadEvent";try{const r=d(c,o(),s,t);r&&r.addOnDataLoad(e,n)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(c,t,null,n),t}}}}function O(e,t,n,r){return{type:"eventManager.addOnLoad",sync:!0,execute({dispatch:o,getState:s},c){const u=l+"addOnLoadEvent";try{const a=d(u,s(),c,t);a&&a.addOnLoadEvent(e,n,r)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(u,t,null,n),t}}}}function C(e,t,n){return{type:"eventManager.addOnSave",sync:!0,execute({dispatch:r,getState:o},s){const c=l+"addOnSaveEvent";try{const r=d(c,o(),s,t);r&&r.addOnSaveEvent(e,n)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(c,t,null,n),t}}}}function E(e,t,n,r,o){return{type:"eventManager.addOnChange",sync:!0,execute:({dispatch:s,getState:c},u)=>{const p=l+"addOnChangeEvent";try{const a=d(p,c(),u,t);a&&a.addOnChangeEvent(c(),e,n,r,o)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(p,t,null,n),t}}}}function I(e,t,n,r){return{type:"eventManager.addOnKeyPress",sync:!0,execute:({dispatch:o,getState:s},c)=>{const u=l+"addOnKeyPressEvent";try{const a=d(u,s(),c,t);a&&a.addOnKeyPressEvent(e,n,r)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(u,t,null,n),t}}}}function w(e,t,n,r){return{type:"eventManager.addOnClick",sync:!0,execute:({dispatch:o,getState:s},c)=>{const u=l+"addOnClickEvent";try{const a=d(u,s(),c,t);a&&a.addOnClickEvent(e,n,r)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(u,t,null,n),t}}}}function j(e,t,n,r){return{type:"eventManager.addPreSearch",sync:!0,execute:({dispatch:o,getState:s},c)=>{const u=l+"addPreSearchEvent";try{const a=d(u,s(),c,t);a&&a.addPreSearchEvent(e,n,r)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(u,t,null,n),t}}}}function P(e,t,n){return{type:"eventManager.addOnProcessStatusChange",sync:!0,execute:({dispatch:r,getState:o},c)=>{const u=l+"addOnProcessStatusChange";try{const r=s.v(u,o(),c,t);r&&r.addOnProcessStatusChangeEvent(e,n)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(u,t,null,n),t}}}}function T(e,t,n,r){return{type:"eventManager.addOnTabStateChange",sync:!0,execute:({dispatch:o,getState:s},c)=>{const u=l+"addOnTabStateChange";try{const a=d(u,s(),c,t);a&&a.addOnTabStateChangeEvent(e,n,r)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(u,t,null,n),t}}}}function N(e,t,n){return{type:"eventManager.addOnStageChange",sync:!0,execute:({dispatch:r,getState:o},c)=>{const u=l+"addOnStageChange";try{const r=s.v(u,o(),c,t);r&&r.addOnStageChangeEvent(e,n)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(u,t,null,n),t}}}}function A(e,t,n){return{type:"eventManager.addOnPreProcessStatusChange",sync:!0,execute:({dispatch:r,getState:o},s)=>{const c=l+"addOnPreProcessStatusChange";try{const r=d(c,o(),s,t);r&&r.addOnPreProcessStatusChangeEvent(e,n)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(c,t,null,n),t}}}}function R(e,t,n){return{type:"eventManager.addOnPreStageChange",sync:!0,execute:({dispatch:r,getState:o},s)=>{const c=l+"addOnPreStageChange";try{const r=d(c,o(),s,t);r&&r.addOnPreStageChangeEvent(e,n)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(c,t,null,n),t}}}}function D(e,t,n){return{type:"eventManager.addOnStageSelected",sync:!0,execute:({dispatch:r,getState:o},c)=>{const u=l+"addOnStageSelected";try{const r=s.v(u,o(),c,t);r&&r.addOnStageSelectedEvent(e,n)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(u,t,null,n),t}}}}function x(e,t,n,r){return{type:"eventManager.addOnResultOpened",sync:!0,execute({dispatch:o,getState:s},c){const u=l+"addOnResultOpened";try{const a=d(u,s(),c,t);a&&a.addOnResultOpened(e,r,n)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(u,t,null,n),t}}}}function M(e,t,n,r){return{type:"eventManager.addOnSelection",sync:!0,execute({dispatch:o,getState:s},c){const u=l+"addOnSelection";try{const a=d(u,s(),c,t);a&&a.addOnSelection(e,r,n)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(u,t,null,n),t}}}}function F(e,t,n,r){return{type:"eventManager.addPostSearch",sync:!0,execute({dispatch:o,getState:s},c){const u=l+"addOnPostSearch";try{const a=d(u,s(),c,t);a&&a.addOnPostSearch(e,r,n)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(u,t,null,n),t}}}}function k(e,t,n,r){return{type:"eventManager.addOnRecordSelect",sync:!0,execute({dispatch:o,getState:s},c){const u=l+"addOnRecordSelect";try{const a=d(u,s(),c,t);a&&a.addOnRecordSelect(s(),e,n,r)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(u,t,null,n),t}}}}function L(e,t,n,r){return{type:"eventManager.addOnLookupTagClick",sync:!0,execute({dispatch:o,getState:s},c){const u=l+"addOnLookupTagClick";try{const a=d(u,s(),c,t);a&&a.addOnLookupTagClick(e,n,r)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(u,t,null,n),t}}}}function B(e,t,n,r){return{type:"eventManager.addOnReadyStateComplete",sync:!0,execute({dispatch:o,getState:s},c){const u=l+"addOnReadyStateComplete";try{const a=d(u,s(),c,t);a&&a.addOnReadyStateComplete(e,n,r)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(u,t,null,n),t}}}}function U(e,t,n){return{type:"eventManager.addOnPostSave",sync:!0,execute({dispatch:r,getState:o},s){const u=l+"addOnPostSaveEvent";try{const r=d(u,o(),s,t);r&&Object(c.ld)(o(),t)&&r.addOnPostSave(e,n)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(u,t,null,n),t}}}}function V(e,t,n,r){return{type:"eventManager.removeOnChange",sync:!0,execute:({dispatch:o,getState:s},c)=>{const u=l+"removeOnChangeEvent";try{const a=d(u,s(),c,t);a&&a.removeOnChangeEvent(e,n,r)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(u,t,null,n),t}}}}function z(e,t,n,r){return{type:"eventManager.removeOnGridDataLoad",sync:!0,execute:({dispatch:o,getState:s},c)=>{const u=l+"removeOnGridDataLoadEvent";try{const a=d(u,s(),c,t);a&&a.removeOnGridDataLoad(e,n,r)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(u,t,null,n),t}}}}function q(e,t,n){return{type:"eventManager.removeOnDataLoad",sync:!0,execute:({dispatch:r,getState:o},s)=>{const c=l+"removeOnDataLoadEvent";try{const r=d(c,o(),s,t);r&&r.removeOnDataLoad(e,n)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(c,t,null,n),t}}}}function H(e,t,n){return{type:"eventManager.removeOnLoad",sync:!0,execute:({dispatch:r,getState:o},s)=>{const c=l+"removeOnLoadEvent";try{const r=d(c,o(),s,t);r&&r.removeOnLoadEvent(e,n)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(c,t,null,n),t}}}}function W(e,t,n){return{type:"eventManager.removeOnSave",sync:!0,execute:({dispatch:r,getState:o},s)=>{const c=l+"removeOnSaveEvent";try{const r=d(c,o(),s,t);r&&r.removeOnSaveEvent(e,n)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(c,t,null,n),t}}}}function G(e,t,n,r){return{type:"eventManager.removeOnKeyPress",sync:!0,execute:({dispatch:o,getState:s},c)=>{const u=l+"removeOnKeyPressEvent";try{const a=d(u,s(),c,t);a&&a.removeOnKeyPressEvent(e,n,r)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(u,t,null,n),t}}}}function K(e,t,n,r){return{type:"eventManager.removeOnClick",sync:!0,execute:({dispatch:o,getState:s},c)=>{const u=l+"removeOnClickEvent";try{const a=d(u,s(),c,t);a&&a.removeOnClickEvent(e,n,r)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(u,t,null,n),t}}}}function Q(e,t,n,r){return{type:"eventManager.removePreSearch",sync:!0,execute:({dispatch:o,getState:s},c)=>{const u=l+"removePreSearchEvent";try{const a=d(u,s(),c,t);a&&a.removePreSearchEvent(e,n,r)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(u,t,null,n),t}}}}function X(e,t,n,r){return{type:"eventManager.removeOnTabStateChange",sync:!0,execute:({dispatch:o,getState:s},c)=>{const u=l+"removeOnTabStateChangeEvent";try{const a=d(u,s(),c,t);a&&a.removeOnTabStateChange(e,n,r)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(u,t,null,n),t}}}}function Y(e,t,n){return{type:"eventManager.removeOnStageChange",sync:!0,execute:({dispatch:r,getState:o},c)=>{const u=l+"removeOnStageChange";try{const r=s.v(u,o(),c,t);r&&r.removeOnStageChange(e,n)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(u,t,null,n),t}}}}function J(e,t,n){return{type:"eventManager.removeOnStageSelected",sync:!0,execute:({dispatch:r,getState:o},c)=>{const u=l+"removeOnStageSelected";try{const r=s.v(u,o(),c,t);r&&r.removeOnStageSelected(e,n)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(u,t,null,n),t}}}}function $(e,t,n){return{type:"eventManager.removeOnProcessStatusChange",sync:!0,execute:({dispatch:r,getState:o},c)=>{const u=l+"removeOnProcessStatusChange";try{const r=s.v(u,o(),c,t);r&&r.removeOnProcessStatusChange(e,n)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(u,t,null,n),t}}}}function Z(e,t,n){return{type:"eventManager.removeOnPreStageChange",sync:!0,execute:({dispatch:r,getState:o},s)=>{const c=l+"removeOnPreStageChange";try{const r=d(c,o(),s,t);r&&r.removeOnPreStageChange(e,n)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(c,t,null,n),t}}}}function ee(e,t,n){return{type:"eventManager.removeOnPreProcessStatusChange",sync:!0,execute:({dispatch:r,getState:o},s)=>{const c=l+"removeOnPreProcessStatusChange";try{const r=d(c,o(),s,t);r&&r.removeOnPreProcessStatusChange(e,n)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(c,t,null,n),t}}}}function te(e,t,n,r){return{type:"eventManager.removeOnResultOpened",sync:!0,execute({dispatch:o,getState:s},c){const u=l+"removeOnResultOpened";try{const a=d(u,s(),c,t);a&&a.removeOnResultOpened(e,r,n)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(u,t,null,n),t}}}}function ne(e,t,n,r){return{type:"eventManager.removePostSearch",sync:!0,execute({dispatch:o,getState:s},c){const u=l+"removeOnPostSearch";try{const a=d(u,s(),c,t);a&&a.removeOnPostSearch(e,r,n)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(u,t,null,n),t}}}}function re(e,t,n,r){return{type:"eventManager.removeOnSelection",sync:!0,execute({dispatch:o,getState:s},c){const u=l+"removeOnSelection";try{const a=d(u,s(),c,t);a&&a.removeOnSelection(e,r,n)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(u,t,null,n),t}}}}function ae(e,t,n,r){return{type:"eventManager.removeOnRecordSelect",sync:!0,execute({dispatch:o,getState:s},c){const u=l+"removeOnRecordSelect";try{const a=d(u,s(),c,t);a&&a.removeOnRecordSelect(e,n,r)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(u,t,null,n),t}}}}function ie(e,t,n,r){return{type:"eventManager.removeOnLookupTagClick",sync:!0,execute({dispatch:o,getState:s},c){const u=l+"removeOnLookupTagClick";try{const a=d(u,s(),c,t);a&&a.removeOnLookupTagClick(e,n,r)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(u,t,null,n),t}}}}function oe(e,t,n,r){return{type:"eventManager.removeOnReadyStateComplete",sync:!0,execute({dispatch:o,getState:s},c){const u=l+"removeOnReadyStateComplete";try{const a=d(u,s(),c,t);a&&a.removeOnReadyStateComplete(e,n,r)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(u,t,null,n),t}}}}function se(e,t,n){return{type:"eventManager.removeOnPostSave",sync:!0,execute:({dispatch:r,getState:o},s)=>{const u=l+"removeOnPostSaveEvent";try{const r=d(u,o(),s,t);r&&Object(c.ld)(o(),t)&&r.removeOnPostSave(e,n)}catch(t){const n=i.a.getInstance().getEventParameters(e);throw a.a.getInstance().eventManager.ReportComponentFailure(u,t,null,n),t}}}}},"1nJ/":function(e,t,n){"use strict";n.d(t,"a",(function(){return U}));var r=n("umme"),a=n("84PK"),i=n("504W"),o=n("TRNQ"),s=n("FZk4"),c=n("3fL6"),l=n("3ri3"),u=n("jqlv"),d=n("8kVO"),p=n("DijY");class f{constructor(e,t,n,r,a){this._CommandType=0,this._AssociatedMainLog=null,this._CommandId=null,this._Command=null,this._EntitiesInCommand=null,this._AssociatedCommandMainLogs=null,this._AssociatedCommandEntityLogs=null,this._set_commandType(t.get_name().toLowerCase()===l.c.toLowerCase()?p.a.changeProcessAndStage:p.a.nonCrud),this.set_commandId(e),this.set_command(t),this.set_entitiesInCommand(n),this.set_associatedCommandMainLogs(r),this.set_associatedCommandEntityLogs(a)}get_commandType(){return this._CommandType}_set_commandType(e){return this._CommandType=e,e}get_associatedMainLog(){return this._AssociatedMainLog}set_associatedMainLog(e){return this._AssociatedMainLog=e,e}set_associatedEntityLog(e){}get_commandId(){return this._CommandId}set_commandId(e){return this._CommandId=e,e}get_command(){return this._Command}set_command(e){return this._Command=e,e}get_entitiesInCommand(){return this._EntitiesInCommand}set_entitiesInCommand(e){return this._EntitiesInCommand=e,e}get_associatedCommandMainLogs(){return this._AssociatedCommandMainLogs}set_associatedCommandMainLogs(e){return this._AssociatedCommandMainLogs=e,e}get_associatedCommandEntityLogs(){return this._AssociatedCommandEntityLogs}set_associatedCommandEntityLogs(e){return this._AssociatedCommandEntityLogs=e,e}}class g{constructor(e,t){this._CommandType=0,this._AssociatedMainLog=null,this._set_commandType(p.a.transaction)}get_commandType(){return this._CommandType}_set_commandType(e){return this._CommandType=e,e}get_associatedMainLog(){return this._AssociatedMainLog}set_associatedMainLog(e){return this._AssociatedMainLog=e,e}set_associatedEntityLog(e){}}var h=n("HYaY"),m=n("WRF3"),b=n("sdkC"),y=n("jZCH");class _{constructor(e,t,n){this._dalWrapper=null,this._BatchLogs=null,this._EntityLogMap=null,this._AssociatedNonCrudMainLogs=null,this._AssociatedNonCrudEntityLogs=null,this._EntitiesInNonCrud=null,this._set_BatchLogs(t),this._set_EntityLogMap(n),this._dalWrapper=new o.a}_get_BatchLogs(){return this._BatchLogs}_set_BatchLogs(e){return this._BatchLogs=e,e}_get_EntityLogMap(){return this._EntityLogMap}_set_EntityLogMap(e){return this._EntityLogMap=e,e}_get_AssociatedNonCrudMainLogs(){return this._AssociatedNonCrudMainLogs}_set_AssociatedNonCrudMainLogs(e){return this._AssociatedNonCrudMainLogs=e,e}_get_AssociatedNonCrudEntityLogs(){return this._AssociatedNonCrudEntityLogs}_set_AssociatedNonCrudEntityLogs(e){return this._AssociatedNonCrudEntityLogs=e,e}_get_EntitiesInNonCrud(){return this._EntitiesInNonCrud}_set_EntitiesInNonCrud(e){return this._EntitiesInNonCrud=e,e}async createCommandData(e){if(e>=this._get_BatchLogs().length)throw r.a.FromMessage("Invalid index specified for batch logs");const t=[],n=this._get_BatchLogs()[e];n.get_logTableID().toLowerCase()!==l.w.toLowerCase()?n.get_logTableID().toLowerCase()===l.E.toLowerCase()||n.get_logTableID().toLowerCase()===l.F.toLowerCase()?t.push(this._GetTransactionCommandData(e)):t.push(this._GetCrudCommandData(e)):t.push(this._GetNonCrudCommandData(e));const a=await Promise.all(t),o=Object(i.a)(a[0])?null:a[0];return Object(i.a)(o)?null:(o.set_associatedMainLog(n),o.set_associatedEntityLog(u.f(n,this._get_EntityLogMap())),o)}_GetTransactionCommandData(e){const t=this._get_BatchLogs()[e],n=t.get_operationType(),r=new m.a(u.c(t),a.a.newGuid()),i=new h.a(r,{},{},{},{},new b.a(new Array(0)));return Promise.resolve(new g(n,i))}async _GetCrudCommandData(e){const t=this._get_BatchLogs()[e],n=t.get_operationType();if(U.get_skipTables().indexOf(t.get_logTableID())>=0)return new d.a(n,null);const r=u.f(t,this._get_EntityLogMap()),a=u.g(t,this._get_EntityLogMap()),i=u.c(t),o=await this._dalWrapper.convertSQLiteResultsToEntityRecord(r,a,i,n).nativePromise();return new d.a(n,o)}async _GetNonCrudCommandData(e){const t=this._get_BatchLogs()[e];this._set_EntitiesInNonCrud({}),this._set_AssociatedNonCrudMainLogs([]),this._set_AssociatedNonCrudEntityLogs({});const n=u.f(t,this._get_EntityLogMap()),r=a.a.tryCreate(n[l.f].toString()),i=u.b(n);return await this._ProcessEntitiesInNonCrudCommand(e,i),new f(r,i,this._get_EntitiesInNonCrud(),this._get_AssociatedNonCrudMainLogs(),this._get_AssociatedNonCrudEntityLogs())}_GetCommandOperationsCount(e){let t=0;for(;e<this._get_BatchLogs().length;){if(this._get_BatchLogs()[e].get_logTableID().toLowerCase()!==l.x.toLowerCase())break;t++,e++}return t}async _ProcessEntitiesInNonCrudCommand(e,t){if(t.get_name().toLowerCase()===l.c.toLowerCase()){if(e+1>=this._get_BatchLogs().length)return!0;const t=this._get_BatchLogs()[e+1];return u.i(t)!==l.v||(this._get_AssociatedNonCrudMainLogs().push(t),this._get_AssociatedNonCrudEntityLogs()[t.get_SID().toString()]=u.f(t,this._get_EntityLogMap()),!0)}const n=this._GetCommandOperationsCount(e+1),a=[];for(let t=1;t<=2*n;t++)a.push(this._PopulateEntitiesInNonCrud(e+t));try{return await Promise.all(a),u.l("OfflineUpSync.PlaybackManager.ProcessEntitiesInNonCrud.Success","Processing of Entities in NonCrud Succeeded"),!0}catch(e){throw e=e instanceof r.a?e:r.a.fromGenericError(e),u.k("OfflineUpSync.PlaybackManager.ProcessEntitiesInNonCrud.Fail",e.get_Message()),e}}async _PopulateEntitiesInNonCrud(e){if(u.l("OfflineUpSync.PlaybackManager._PopulateEntitiesInNonCrud.Start","Population of Entities in NonCrud Started"),e>=this._get_BatchLogs().length)return u.l("OfflineUpSync.PlaybackManager._PopulateEntitiesInNonCrud.Success","Population of Entities in NonCrud Succeeded"),!1;const t=this._get_BatchLogs()[e],n=t.get_logTableID(),a=u.c(t);new Array(0).push(new s.a(l.z,t.get_SID(),c.a.Or,0));const o=u.f(t,this._get_EntityLogMap());if(this._get_AssociatedNonCrudMainLogs().push(t),this._get_AssociatedNonCrudEntityLogs()[t.get_SID().toString()]=o,U.get_skipTables().indexOf(n)>=0)return u.l("OfflineUpSync.PlaybackManager._PopulateEntitiesInNonCrud.Success","Population of Entities in NonCrud is skipped"),!0;try{const e=await y.a.get_DefaultInstance().retrieveEntityMetadata(a,null).nativePromise();return!Object(i.a)(e)&&e.get_primaryIdAttribute()in o&&(u.l("OfflineUpSync.PlaybackManager._PopulateEntitiesInNonCrud.Success","Population of Entities in NonCrud Succeeded"),this._get_EntitiesInNonCrud()[o[e.get_primaryIdAttribute()].toString()]=a),!0}catch(e){throw e=e instanceof r.a?e:r.a.fromGenericError(e),u.k("OfflineUpSync.PlaybackManager._PopulateEntitiesInNonCrud.Fail",e.get_Message()),e}}}var v,S=n("vONk");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */!function(e){e[e.failure=0]="failure",e[e.success=1]="success"}(v||(v={}));var O=n("2LZB"),C=n("JUjK"),E=n("pHbk");class I{constructor(e,t,n){this._ErrorCount=0,this._LastSuccessfulSaveOnCrm=null,this._ErrorCount=t,this._LastSuccessfulSaveOnCrm=n}get_errorCount(){return this._ErrorCount}get_lastSuccessfulSaveOnCrm(){return this._LastSuccessfulSaveOnCrm}}var w=n("qCX6"),j=n("Nnen"),P=n("Eua/"),T=n("Q7Xa"),N=n("VJBm");class A extends N.a{constructor(e){super(e),this.set_dataAccessLayer(e)}create(e,t){this.get_dataAccessLayer().create(e,t)}retrieve(e,t){return this.get_dataAccessLayer().retrieve(e,t)}update(e,t){this.get_dataAccessLayer().update(e,t)}Delete(e,t){this.get_dataAccessLayer().Delete(e,t)}begin(e){this.get_dataAccessLayer().begin(e)}Commit(e){return this.get_dataAccessLayer().Commit(e)}}var R=n("thzq");class D{constructor(){this._dalBase=null,this._norSyncDAL=null,this._commandDAL=null,this._wrapper=null,this._dalBase=new P.a,this._norSyncDAL=new A(this._dalBase),this._commandDAL=new j.a(this._dalBase),this._wrapper=new o.a}async getNorSyncMainLogs(e){const t=await this._norSyncDAL.retrieve(l.B,e);return u.a(t)}getNorSyncEntityLogs(e,t){const n=u.e(t);return this._norSyncDAL.retrieve(n,e).nativePromise()}async performOperations(e,t,n){try{return await this._wrapper.performOperations(e,t,n).nativePromise(),u.m("OfflineUpSync.PlaybackManager.UpdateRowVersion.Success","Updation of Row Version Succeeded"),!0}catch(e){throw e=e instanceof r.a?e:r.a.fromGenericError(e),u.k("OfflineUpSync.PlaybackManager.UpdateRowVersion.Fail",e.get_Message()),e}}async clearNorSyncLogs(e,t,n){if(!e.length)return!0;const r=new Array(0);r.push(new s.a(l.K,e,c.a.Or,C.a.In));const i=new O.a(r),o=new Array(0);o.push(new s.a(l.z,e,c.a.Or,C.a.In));const u=new O.a(o);this._norSyncDAL.begin(!0);for(const e of t)this._deleteNorSyncEntityLog(e,u);return this._deleteNorSyncMainLogs(i),n.equals(a.a.get_empty())||this._DeleteCommand(n),await this._norSyncDAL.Commit(this._dalBase.get_transaction()).nativePromise(),!0}updateCommandStatus(e,t){if(Object(i.a)(e))return null;const n=e.toDictionary();return n[l.m]=t,new T.a(n,R.a.Update,l.n)}_DeleteCommand(e){const t=new Array(0);t.push(new s.a(l.f,e.toString(),c.a.Or,0));const n=new O.a(t);new Array(0).push(new s.a(l.h,e.toString(),c.a.Or,0));const r=new O.a(t);this._commandDAL.Delete(l.n,n),this._commandDAL.Delete(l.l,r)}_deleteNorSyncMainLogs(e){this._norSyncDAL.Delete(l.B,e)}_deleteNorSyncEntityLog(e,t){this._norSyncDAL.Delete(e,t)}}var x=n("SAYH");let M=null,F=0,k=null,L=null,B=null;class U{constructor(){this._lastSID=0,this._commandOperationsLength=0,this._hasInCompleteNonCrudCommand=!1,this._hasInCompleteTransaction=!1,this._NorSyncLogHelper=null,this._PlaybackBatchManager=null,this._BatchLogs=null,this._EntityList=null,this._norSyncMainLogs=null,this._EntityLogMap=null,this._set_NorSyncLogHelper(new D)}_get_NorSyncLogHelper(){return this._NorSyncLogHelper}_set_NorSyncLogHelper(e){return this._NorSyncLogHelper=e,e}_get_PlaybackBatchManager(){return this._PlaybackBatchManager}_set_PlaybackBatchManager(e){return this._PlaybackBatchManager=e,e}_get_BatchLogs(){return this._BatchLogs}_set_BatchLogs(e){return this._BatchLogs=e,e}_get_EntityList(){return this._EntityList}_set_EntityList(e){return this._EntityList=e,e}_get_EntityLogMap(){return this._EntityLogMap}_set_EntityLogMap(e){return this._EntityLogMap=e,e}get_maxBatchSize(){return 10}get_norSyncMainLogs(){return this._norSyncMainLogs}async startPlayback(e){if(S.a.set_OverallSyncErrorMessage(null),U.set_syncErrorsCount(0),U.set_upsyncId(),this._lastSID=0,!E.a.get_instance().isOfflineDatabaseAvailable())throw r.a.FromMessage("Offline database is not available.");Object(u.l)("OfflineUpSync.PlaybackManager.StartPlayback","Started Upsync");try{await this._InitializeSyncErrorRetryStatus();try{await this._ProcessPlayBack(e),E.a.get_instance().saveOfflineErrorState(l.Y,U.get_syncErrorRetryCountMap()),Object(u.l)("OfflineUpSync.PlaybackManager.StartPlayback","Total number of Sync Errors is "+Object.keys(U.get_syncErrorRetryCountMap()).length)}catch(e){throw E.a.get_instance().saveOfflineErrorState(l.Y,U.get_syncErrorRetryCountMap()),e}finally{const e=await E.a.get_instance().retrieveOfflineErrorState(l.s);e&&Object.keys(e).length>0&&U.set_lastSuccessfulSaveOnCrm(e[l.s])}w.a.get_instance().get_offlineDataSource().set_syncErrorCount(U.get_syncErrorsCount());const t=!Object(i.a)(this._get_PlaybackBatchManager())&&this._get_PlaybackBatchManager().get_hasNetworkIssueDuringUpsync()?0:v.success;return new I(t,U.get_syncErrorsCount(),U.get_lastSuccessfulSaveOnCrm())}catch(e){throw e=e instanceof r.a?e:r.a.fromGenericError(e),Object(u.k)("OfflineUpSync.PlaybackManager.StartPlayback.Failure",e.get_Message()),e}}async hasItemsToUpsync(){try{const e=new Array(0);e[0]=new s.a(l.K,this._lastSID,c.a.Or,C.a.GreaterThan);const t=new O.a(e),n=await this._get_NorSyncLogHelper().getNorSyncMainLogs(t);return Object(i.a)(n)||!n.length?(Object(u.l)("OfflineUpSync.PlaybackManager.HasPlayBackQueueItems.Success","No Items found for upsync"),!1):(Object(u.l)("OfflineUpSync.PlaybackManager.HasPlayBackQueueItems.Success","Found items for upsync. No of items in log table - "+n.length),!0)}catch(e){throw e=e instanceof r.a?e:r.a.fromGenericError(e),Object(u.k)("OfflineUpSync.PlaybackManager.HasPlayBackQueueItems.Failure",e.get_Message()),e}}async isLocalCopy(e,t){const n=await y.a.get_DefaultInstance().retrieveEntityMetadata(e,null).nativePromise();if(Object(i.a)(n))return!1;const r=n.get_primaryIdAttribute(),a=new Array(0);a[0]=new s.a(r,t.toString(),c.a.Or,0);const o=new O.a(a),l=await this._get_NorSyncLogHelper().getNorSyncEntityLogs(o,e);return!Object(i.a)(l)&&l.rows.length>0}async _InitializeSyncErrorRetryStatus(){const e=await E.a.get_instance().retrieveOfflineErrorState(l.Y);return U.set_syncErrorRetryCountMap(Object(i.a)(e)?{}:e),!0}async _ProcessPlayBack(e){let t;Object(u.l)("OfflineUpSync.PlaybackManager._ProcessPlayBack.Success","I Pass Completed");try{return t=await this._StartPass(e),t?this._get_PlaybackBatchManager().get_hasNetworkIssueDuringUpsync()?(Object(u.m)("OfflineUpSync.PlaybackManager._ProcessPlayBack.NetworkFailure","II Pass Not Started due to Network Issue"),!1):(Object(u.l)("OfflineUpSync.PlaybackManager._ProcessPlayBack","II Pass Started"),await this._StartPass(e),Object(u.l)("OfflineUpSync.PlaybackManager._ProcessPlayBack.Success","II Pass Completed"),!0):(Object(u.l)("OfflineUpSync.PlaybackManager._ProcessPlayBack.Success","Completed"),!0)}catch(e){throw e=e instanceof r.a?e:r.a.fromGenericError(e),Object(u.k)("OfflineUpSync.PlaybackManager._ProcessPlayBack.Failure",e.get_Message()),e}}async _StartPass(e){Object(u.l)("OfflineUpSync.PlaybackManager._StartPass","Started");try{return await this.hasItemsToUpsync()?(this._set_PlaybackBatchManager(new S.a(this._get_NorSyncLogHelper())),await this.upSync(e),this._get_PlaybackBatchManager().get_hasNetworkIssueDuringUpsync()?Object(u.l)("OfflineUpSync.PlaybackManager._StartPass.NetworkFaliure","Faliure"):Object(u.l)("OfflineUpSync.PlaybackManager._StartPass.Success","StartPass Finished"),!0):(Object(u.l)("OfflineUpSync.PlaybackManager._StartPass.Success","StartPass Completed"),!1)}catch(e){throw e=e instanceof r.a?e:r.a.fromGenericError(e),Object(u.k)("OfflineUpSync.PlaybackManager._StartPass.Failure",e.get_Message()),e}}async upSync(e){Object(u.l)("OfflineUpSync.PlaybackManager.UpSync","UpSync Started");const t=[];t.push(this._get_PlaybackBatchManager().processBatchForUpSync(e)),t.push(this._PrepareNextBatch());try{if(await Promise.all(t),this._get_PlaybackBatchManager().get_hasNetworkIssueDuringUpsync())return Object(u.l)("OfflineUpSync.PlaybackManager.UpSync.Warning","NetWork Issue Encountered while upsync"),!1;if(!this._get_PlaybackBatchManager().get_playbackQueue().length)return Object(u.l)("OfflineUpSync.PlaybackManager.UpSync.Info","ManagePlayBackQueue PlayBack All Remaining Requests Started"),await this._get_PlaybackBatchManager().processBatchForUpSync(e),!0;const n=await this.upSync(e);return Object(u.l)("OfflineUpSync.PlaybackManager.UpSync.Success","ManagePlayBackQueue Finished"),n}catch(e){throw e=e instanceof r.a?e:r.a.fromGenericError(e),Object(u.k)("OfflineUpSync.PlaybackManager.UpSync.Failure",e.get_Message()),e}}async _PrepareNextBatch(){Object(u.l)("OfflineUpSync.PlaybackManager._PrepareNextBatch","ProcessBatch Started");try{if(await this._RetrieveBatch(!0),Object(i.a)(this._get_BatchLogs())||!this._get_BatchLogs().length)return Object(u.l)("OfflineUpSync.PlaybackManager._PrepareNextBatch.Success","ProcessBatch Completed"),!1;const e=await this._CreateBatchData();return!Object(i.a)(e)&&e.length>0&&(Object(u.l)("OfflineUpSync.PlaybackManager._PrepareNextBatch","Batch Added to PlayBackBatchManager"),this._get_PlaybackBatchManager().get_playbackQueue().push(e)),Object(u.l)("OfflineUpSync.PlaybackManager._PrepareNextBatch.Success","ProcessBatch Finished"),!0}catch(e){throw e=e instanceof r.a?e:r.a.fromGenericError(e),Object(u.k)("OfflineUpSync.PlaybackManager._PrepareNextBatch.Failure",e.get_Message()),e}}_PrepareBatchAndValidateBatchReadyforUpSync(e){let t=0,n=!e;for(;t<this.get_norSyncMainLogs().length&&(this._get_BatchLogs().length<this.get_maxBatchSize()||n);){const e=Object(u.i)(this.get_norSyncMainLogs()[t]),r=Object(u.d)(e);this._get_BatchLogs().push(this.get_norSyncMainLogs()[t]),this._get_EntityList().indexOf(r)<0&&this._get_EntityList().push(r),n?this._hasInCompleteNonCrudCommand?e.toLowerCase()===l.x.toLowerCase()?this._commandOperationsLength++:(this._commandOperationsLength--,this._commandOperationsLength<=0&&(n=!1,this._hasInCompleteNonCrudCommand=!1,this._commandOperationsLength=0)):this._hasInCompleteTransaction&&e.toLowerCase()===l.F.toLowerCase()&&(n=!1,this._hasInCompleteTransaction=!1):e.toLowerCase()===l.w.toLowerCase()?(n=!0,this._hasInCompleteNonCrudCommand=!0,this._commandOperationsLength=0):e.toLowerCase()===l.E.toLowerCase()&&(n=!0,this._hasInCompleteTransaction=!0),t++}return this._lastSID=this._get_BatchLogs()[this._get_BatchLogs().length-1].get_SID(),this._norSyncMainLogs.splice(0,t),n}async _PrepareEntityLogs(){Object(u.l)("OfflineUpSync.PlaybackManager.RetrieveEntityLogs","RetrieveEntityLogs Started"),this._set_EntityLogMap({});const e=new Array(0);e.push(new s.a(l.z,this._get_BatchLogs()[0].get_SID(),0,C.a.GreaterThanEqualTo)),e.push(new s.a(l.z,this._lastSID,0,C.a.LessThanEqualTo));const t=new O.a(e),n=[];for(const e of this._get_EntityList())e!==Object(u.d)(l.E)&&e!==Object(u.d)(l.F)?n.push(this._get_NorSyncLogHelper().getNorSyncEntityLogs(t,e)):n.push(Promise.resolve(null));try{const e=await Promise.all(n);Object(u.l)("OfflineUpSync.PlaybackManager.RetrieveEntityLogs.Success","RetrieveEntityLogs Completed");for(let t=0;t<this._get_EntityList().length;t++){const n=this._get_EntityList()[t];if(Object(i.a)(e[t]))this._get_EntityLogMap()[n]=null;else{const r=e[t],a={};for(let e=0;e<r.rows.length;e++){const t=r.rows.item(e),n=t[l.z].toString()in a?a[t[l.z].toString()]:[];n.push(t),a[t[l.z].toString()]=n}this._get_EntityLogMap()[n]=a}}return!0}catch(e){throw e=e instanceof r.a?e:r.a.fromGenericError(e),Object(u.k)("OfflineUpSync.PlaybackManager.RetrieveEntityLogs.Failure",e.get_Message()),e}}async _CreateBatchData(){Object(u.l)("OfflineUpSync.PlaybackManager._CreateBatchData","CreateBatchData Started");const e=[];let t=0,n=0,a=!1;for(;t<this._get_BatchLogs().length;){const r=Object(u.i)(this._get_BatchLogs()[t]);a?r.toLowerCase()===l.x.toLowerCase()?(n++,t++):(t+=r.toLowerCase()!==l.v.toLowerCase()||n?n:1,a=!1,n=0):(r.toLowerCase()===l.w.toLowerCase()&&(a=!0,n=0),e.push(new _(this._get_NorSyncLogHelper(),this._get_BatchLogs(),this._get_EntityLogMap()).createCommandData(t)),t++)}try{return await Promise.all(e)}catch(e){throw e=e instanceof r.a?e:r.a.fromGenericError(e),Object(u.k)("OfflineUpSync.PlaybackManager._CreateBatchData.Failure",e.get_Message()),e}}async _GetBatch(e){const t=new Array(0);t[0]=new s.a(l.K,this._lastSID,c.a.Or,C.a.GreaterThan);const n=new O.a(t,e);try{const e=await this._get_NorSyncLogHelper().getNorSyncMainLogs(n);return Object(u.l)("OfflineUpSync.PlaybackManager._GetBatch.Success","GetBatch Completed."),Object(i.a)(this._norSyncMainLogs)?this._norSyncMainLogs=e:this._norSyncMainLogs.push(...e),!0}catch(e){throw e=e instanceof r.a?e:r.a.fromGenericError(e),Object(u.m)("OfflineUpSync.PlaybackManager._GetBatch.Fail",e.get_Message()),e}}async _RetrieveBatch(e){Object(u.l)("OfflineUpSync.PlaybackManager._RetrieveBatch","RetrieveBatch Started."),e&&(this._set_BatchLogs([]),this._set_EntityList([]));let t=this.get_maxBatchSize();!Object(i.a)(this.get_norSyncMainLogs())&&this.get_norSyncMainLogs().length>0&&(t-=this.get_norSyncMainLogs().length,this._lastSID=this.get_norSyncMainLogs()[this.get_norSyncMainLogs().length-1].get_SID());try{return await this._GetBatch(t),Object(i.a)(this.get_norSyncMainLogs())||!this.get_norSyncMainLogs().length?!0:this._PrepareBatchAndValidateBatchReadyforUpSync(e)?(await this._RetrieveBatch(!1),Object(u.l)("OfflineUpSync.PlaybackManager._RetrieveBatch.Force.Success","Force RetrieveBatch Completed."),!0):(await this._PrepareEntityLogs(),Object(u.l)("OfflineUpSync.PlaybackManager._RetrieveBatch.Success","RetrieveBatch Completed."),!0)}catch(e){throw e=e instanceof r.a?e:r.a.fromGenericError(e),Object(u.k)("OfflineUpSync.PlaybackManager._RetrieveBatch.Failure",e.get_Message()),e}}static get_syncErrorsCount(){return F}static set_syncErrorsCount(e){return F=e,e}static get_lastSuccessfulSaveOnCrm(){return L}static set_lastSuccessfulSaveOnCrm(e){return L=e,e}static set_upsyncId(){B=x.a.newGuid().guid}static get_upsyncId(){return B}static get_DefaultInstance(){return Object(i.a)(M)&&(M=new U),M}static get_syncErrorRetryCountMap(){return Object(i.a)(k)&&(k={}),k}static set_syncErrorRetryCountMap(e){return k=e,e}static get_skipTables(){return[l.x,l.v]}static IncrementSyncErrorsCount(){let e;(e=U).set_syncErrorsCount(e.get_syncErrorsCount()+1)}}},"1pQz":function(e,t,n){"use strict";n.d(t,"b",(function(){return m})),n.d(t,"a",(function(){return M}));var r=n("eXjw"),a=n("SAYH"),i=n("fC8v"),o=n("504W"),s=n("SFgX"),c=n("Lyxw"),l=n("3/02"),u=n("vSoM");function d(e,t,n,c,l,d=r.a.Initialized){let m=s.a.defaulticon;t.LogicalName&&s.a[t.LogicalName]&&(m=s.a[t.LogicalName]);const b=Object(u.b)(e),y=Object(u.c)(e),_={Initialized:d,Id:a.a.tryParseOrNull(t.MetadataId),EntityLogicalName:t.LogicalName,EntityIcon:m,DisplayName:Object(i.b)(b,y,t.DisplayName),EntitySetName:t.EntitySetName,PrimaryKeyName:t.PrimaryIdAttribute,ObjectTypeCode:t.ObjectTypeCode,PrimaryIdAttribute:t.PrimaryIdAttribute,PrimaryNameAttribute:t.PrimaryNameAttribute,PrimaryImageAttribute:t.PrimaryImageAttribute,EntityColor:Object(u.f)(b,y,t.EntityColor),ActivityTypeMask:t.ActivityTypeMask,AutoRouteToOwnerQueue:Object(u.a)(b,y,t.AutoRouteToOwnerQueue),DisplayCollectionName:Object(i.b)(b,y,t.DisplayCollectionName),CanTriggerWorkflow:Object(u.a)(b,y,t.CanTriggerWorkflow),CanCreateForms:f(t.CanCreateForms),Description:Object(i.b)(b,y,t.Description),EntityHelpUrlEnabled:Object(u.a)(b,y,t.EntityHelpUrlEnabled),EntityHelpUrl:t.EntityHelpUrl,IsDocumentManagementEnabled:Object(u.a)(b,y,t.IsDocumentManagementEnabled),IsOneNoteIntegrationEnabled:Object(u.a)(b,y,t.IsOneNoteIntegrationEnabled),IsMSTeamsIntegrationEnabled:Object(u.a)(b,y,t.IsMSTeamsIntegrationEnabled),IsDocumentRecommendationsEnabled:Object(u.a)(b,y,t.IsDocumentRecommendationsEnabled),IsInteractionCentricEnabled:Object(u.a)(b,y,t.IsInteractionCentricEnabled),IsKnowledgeManagementEnabled:Object(u.a)(b,y,t.IsKnowledgeManagementEnabled),IsActivity:Object(u.a)(b,y,t.IsActivity),IsActivityParty:Object(u.a)(b,y,t.IsActivityParty),HasEmailAddresses:Object(u.a)(b,y,t.HasEmailAddresses),IsChildEntity:Object(u.a)(b,y,t.IsChildEntity),IsCollaboration:f(t.IsValidForQueue),IsConnectionsEnabled:f(t.IsConnectionsEnabled),IsCustomEntity:Object(u.a)(b,y,t.IsCustomEntity),IsBusinessProcessEnabled:Object(u.a)(b,y,t.IsBusinessProcessEnabled),IsCustomizable:f(t.IsCustomizable),IsOptimisticConcurrencyEnabled:Object(u.a)(b,y,t.IsOptimisticConcurrencyEnabled),IsImportable:Object(u.a)(b,y,t.IsImportable),IsIntersect:Object(u.a)(b,y,t.IsIntersect),IsMailMergeEnabled:f(t.IsMailMergeEnabled),IsEnabledForCharts:Object(u.a)(b,y,t.IsEnabledForCharts),IsValidForAdvancedFind:Object(u.a)(b,y,t.IsValidForAdvancedFind),IsVisibleInMobileClient:f(t.IsVisibleInMobileClient),IsReadOnlyInMobileClient:f(t.IsReadOnlyInMobileClient),IsOfflineInMobileClient:f(t.IsOfflineInMobileClient),IsQuickCreateEnabled:Object(u.a)(b,y,t.IsQuickCreateEnabled),EntityClientSetting:t.EntityClientSetting,OwnershipType:l?g(t.OwnershipType):t.OwnershipType,HasChanged:Object(u.a)(b,y,t.HasChanged),HasStateCode:x(t),IsStateModelAware:Object(u.a)(b,y,t.IsStateModelAware),EnforceStateTransitions:Object(u.a)(b,y,t.EnforceStateTransitions),Privileges:l?h(t.Privileges):t.Privileges||[],IconVectorName:t.IconVectorName,IsBPFEntity:Object(u.a)(b,y,t.IsBPFEntity),DataProviderId:a.a.tryParseOrNull(t.DataProviderId),IsEnabledInUnifiedInterface:!!Object(o.a)(t.IsVisibleInMobileClient)||(t.IsVisibleInMobileClient.Value||t.IsVisibleInMobileClient.CanBeChanged),VersionNumber:n||t.VersionNumber,OverallVersionNumber:c||t.OverallVersionNumber,AttributeNames:t.AttributeNames,IsAuditEnabled:t.IsAuditEnabled};if(t.OneToManyRelationships&&(_.OneToManyRelationships=D(e,t.OneToManyRelationships,t,l,P),_.HasActivities=p(_.OneToManyRelationships,"activitypointer","regardingobjectid"),_.HasNotes=p(_.OneToManyRelationships,"annotation","objectid")),t.ManyToOneRelationships&&(_.ManyToOneRelationships=D(e,t.ManyToOneRelationships,t,l,P)),t.ManyToManyRelationships&&(_.ManyToManyRelationships=D(e,t.ManyToManyRelationships,t,l,R)),_.IsChildEntity&&_.ManyToOneRelationships){const e=function(e){if(e)for(const t of Object.keys(e)){const n=e[t];if(2===n.SecurityTypes)return{parentEntityLogicalName:n.ReferencedEntity,parentEntityReferencingAttribute:n.ReferencingAttribute}}return null}(_.ManyToOneRelationships);Object(o.a)(e)||(_.ParentEntityLogicalName=e.parentEntityLogicalName,_.ParentEntityReferencingAttribute=e.parentEntityReferencingAttribute)}return _}function p(e,t,n){for(const r in e)if(e[r].ReferencingEntity===t&&e[r].ReferencingAttribute===n)return!0;return!1}function f(e){return e?e.Value:null}function g(e){if("string"!=typeof e)return"number"==typeof e?e:null;switch(e){case"None":return 0;case"UserOwned":return 1;case"TeamOwned":return 2;case"BusinessOwned":return 3;case"OrganizationOwned":return 4;case"BusinessParented":return 5;default:return 0}}function h(e){if(null===e)return[];for(const t of e)if(null!==t&&"string"==typeof t.PrivilegeType)switch(t.PrivilegeType){case"None":t.PrivilegeType=0;continue;case"Create":t.PrivilegeType=1;continue;case"Read":t.PrivilegeType=2;continue;case"Write":t.PrivilegeType=3;continue;case"Delete":t.PrivilegeType=4;continue;case"Assign":t.PrivilegeType=5;continue;case"Share":t.PrivilegeType=6;continue;case"Append":t.PrivilegeType=7;continue;case"AppendTo":t.PrivilegeType=8;continue;default:t.PrivilegeType=0;continue}return e}function m(e,t,n,a,o=r.a.Initialized,s){const u=a&&Object(c.f)(a,l.Pd);let p=null,f=null;if(e){p={},f={};for(const r of e){const e=d(a,r,t,n,u,o);p[e.EntityLogicalName]=e;const c=Object(i.e)(a,r,s);f[e.EntityLogicalName]=c}}return{entities:p,attributes:f}}function b(e,t,n){if(Object(o.a)(t))return null;const r=Object(u.b)(e),s=Object(u.c)(e);var c,l;return{Behavior:n?v(t.Behavior):y(r,s,t.Behavior),Group:n?S(t.Group):_(r,s,t.Group),Label:Object(i.b)(r,s,t.Label),Order:t.Order,AvailableOffline:(c=r,l=t.AvailableOffline,!(!c||!Object(o.a)(l))||l),Icon:t.Icon,IsCustomizable:z(r,t.IsCustomizable),MenuId:t.MenuId,QueryApi:t.QueryApi,ViewId:q(r,a.a.tryParseOrNull(t.ViewId)),ExtensionData:t.ExtensionData}}function y(e,t,n){return e&&t&&Object(o.a)(n)?2:n}function _(e,t,n){return e&&t&&Object(o.a)(n)?0:n}function v(e){if("string"!=typeof e)return"number"==typeof e?e:0;switch(e){case"UseCollectionName":return 0;case"UseLabel":return 1;case"DoNotDisplay":return 2;default:return 0}}function S(e){if("string"!=typeof e)return"number"==typeof e?e:0;switch(e){case"Details":return 0;case"Sales":return 1;case"Service":return 2;case"Marketing":return 3;default:return 0}}function O(e,t,n){return e&&t&&Object(o.a)(n)?0:n}function C(e){if("string"!=typeof e)return"number"==typeof e?e:0;switch(e){case"NoCascade":return 0;case"Cascade":return 1;case"Active":return 2;case"UserOwned":return 3;case"RemoveLink":return 4;case"Restrict":return 5;default:return 0}}function E(e,t,n){const r=Object(u.b)(e),a=Object(u.c)(e);var i,s;return{IsCustomRelationship:t.IsCustomRelationship,IsCustomizable:f(t.IsCustomizable),IsValidForAdvancedFind:t.IsValidForAdvancedFind,SchemaName:t.SchemaName,SecurityTypes:n?w(t.SecurityTypes):t.SecurityTypes,IsManaged:I(r,a,t),RelationshipType:n?j(t.RelationshipType):(i=r,s=t.RelationshipType,i&&Object(o.a)(s)?0:s),IntroducedVersion:t.IntroducedVersion}}function I(e,t,n){return!!(e&&t&&Object(o.a)(n.IsManaged))||n.IsManaged}function w(e){if("string"!=typeof e)return"number"==typeof e?e:0;switch(e){case"None":return 0;case"Append":return 1;case"ParentChild":return 2;case"Pointer":return 4;case"Inheritance":return 8;default:return 0}}function j(e){if("string"!=typeof e)return"number"==typeof e?e:-1;switch(e){case"OneToManyRelationship":return 0;case"ManyToManyRelationship":return 1;default:return-1}}function P(e,t,n,r){const a=b(e,t.AssociatedMenuConfiguration,r),i=function(e,t,n){const r=Object(u.b)(e),a=Object(u.c)(e);return n?{Assign:C(t.Assign),Delete:C(t.Delete),Merge:C(t.Merge),Reparent:C(t.Reparent),Share:C(t.Share),Unshare:C(t.Unshare),ExtensionData:t.ExtensionData}:{Assign:O(r,a,null==t?void 0:t.Assign),Delete:O(r,a,t.Delete),Merge:O(r,a,t.Merge),Reparent:O(r,a,t.Reparent),Share:O(r,a,t.Share),Unshare:O(r,a,t.Unshare),ExtensionData:t.ExtensionData}}(e,t.CascadeConfiguration,r),o=Object(u.b)(e),s=Object(u.c)(e);return Object.assign({AssociatedMenuConfiguration:a,CascadeConfiguration:i,ReferencedAttribute:t.ReferencedAttribute,ReferencedEntity:T(o,s,t,n),ReferencingAttribute:t.ReferencingAttribute,ReferencingEntity:N(o,s,t,n),IsHierarchical:A(o,s,t.IsHierarchical),ReferencedEntityNavigationPropertyName:V(o,t),ReferencingEntityNavigationPropertyName:U(o,s,t)},E(e,t,r))}function T(e,t,n,r){return e&&t&&Object(o.a)(n.ReferencedEntity)?r.LogicalName:n.ReferencedEntity}function N(e,t,n,r){return e&&t&&Object(o.a)(n.ReferencingEntity)?r.LogicalName:n.ReferencingEntity}function A(e,t,n){return!(e&&t&&Object(o.a)(n))&&n}function R(e,t,n,r){const a=Object(u.b)(e);return Object.assign({Entity1AssociatedMenuConfiguration:b(e,t.Entity1AssociatedMenuConfiguration,r),Entity2AssociatedMenuConfiguration:b(e,t.Entity2AssociatedMenuConfiguration,r),Entity1LogicalName:t.Entity1LogicalName,Entity2LogicalName:t.Entity2LogicalName,IntersectEntityName:B(a,t),Entity1IntersectAttribute:t.Entity1IntersectAttribute,Entity2IntersectAttribute:t.Entity2IntersectAttribute,Entity1NavigationPropertyName:k(a,t),Entity2NavigationPropertyName:L(a,t)},E(e,t,r))}function D(e,t,n,r,a){if(!t)return null;const i={};for(const o of t){const t=a(e,o,n,r);i[o.SchemaName]=t}return i}function x(e){if(!e||!e.AttributeNames)return!1;for(const t of e.AttributeNames)if("statecode"===t.toLowerCase())return!0;return!1}function M(e,t){return{Initialized:F(e.Initialized,t.Initialized),EntityLogicalName:F(e.EntityLogicalName,t.EntityLogicalName),DisplayName:F(e.DisplayName,t.DisplayName),EntitySetName:F(e.EntitySetName,t.EntitySetName),PrimaryKeyName:F(e.PrimaryKeyName,t.PrimaryKeyName),ObjectTypeCode:F(e.ObjectTypeCode,t.ObjectTypeCode),Id:F(e.Id,t.Id),DisplayCollectionName:F(e.DisplayCollectionName,t.DisplayCollectionName),PluralName:F(e.PluralName,t.PluralName),PrimaryIdAttribute:F(e.PrimaryIdAttribute,t.PrimaryIdAttribute),PrimaryNameAttribute:F(e.PrimaryNameAttribute,t.PrimaryNameAttribute),PrimaryImageAttribute:F(e.PrimaryImageAttribute,t.PrimaryImageAttribute),EntityColor:F(e.EntityColor,t.EntityColor),ActivityTypeMask:F(e.ActivityTypeMask,t.ActivityTypeMask),HasChanged:F(e.HasChanged,t.HasChanged),HasNotes:F(e.HasNotes,t.HasNotes),HasActivities:F(e.HasActivities,t.HasActivities),HasStateCode:e.HasStateCode,CanTriggerWorkflow:F(e.CanTriggerWorkflow,t.CanTriggerWorkflow),AutoRouteToOwnerQueue:F(e.AutoRouteToOwnerQueue,t.AutoRouteToOwnerQueue),Description:F(e.Description,t.Description),EntityHelpUrlEnabled:F(e.EntityHelpUrlEnabled,t.EntityHelpUrlEnabled),EntityHelpUrl:F(e.EntityHelpUrl,t.EntityHelpUrl),IsDocumentManagementEnabled:F(e.IsDocumentManagementEnabled,t.IsDocumentManagementEnabled),IsOneNoteIntegrationEnabled:F(e.IsOneNoteIntegrationEnabled,t.IsOneNoteIntegrationEnabled),IsMSTeamsIntegrationEnabled:F(e.IsMSTeamsIntegrationEnabled,t.IsMSTeamsIntegrationEnabled),IsInteractionCentricEnabled:F(e.IsInteractionCentricEnabled,t.IsInteractionCentricEnabled),IsKnowledgeManagementEnabled:F(e.IsKnowledgeManagementEnabled,t.IsKnowledgeManagementEnabled),IsDocumentRecommendationsEnabled:F(e.IsDocumentRecommendationsEnabled,t.IsDocumentRecommendationsEnabled),IsActivity:F(e.IsActivity,t.IsActivity),IsEnabledForCharts:F(e.IsEnabledForCharts,t.IsEnabledForCharts),IsActivityParty:F(e.IsActivityParty,t.IsActivityParty),IsChildEntity:F(e.IsChildEntity,t.IsChildEntity),IsCollaboration:F(e.IsCollaboration,t.IsCollaboration),IsConnectionsEnabled:F(e.IsConnectionsEnabled,t.IsConnectionsEnabled),IsCustomEntity:F(e.IsCustomEntity,t.IsCustomEntity),IsCustomizable:F(e.IsCustomizable,t.IsCustomizable),IsIntersect:F(e.IsIntersect,t.IsIntersect),ParentEntityLogicalName:F(e.ParentEntityLogicalName,t.ParentEntityLogicalName),ParentEntityReferencingAttribute:F(e.ParentEntityReferencingAttribute,t.ParentEntityReferencingAttribute),IsBusinessProcessEnabled:F(e.IsBusinessProcessEnabled,t.IsBusinessProcessEnabled),IsBPFEntity:F(e.IsBPFEntity,t.IsBPFEntity),IsDuplicateDetectionEnabled:F(e.IsDuplicateDetectionEnabled,t.IsDuplicateDetectionEnabled),CanEnableSyncToExternalSearchIndex:F(e.CanEnableSyncToExternalSearchIndex,t.CanEnableSyncToExternalSearchIndex),IsOptimisticConcurrencyEnabled:F(e.IsOptimisticConcurrencyEnabled,t.IsOptimisticConcurrencyEnabled),IsImportable:F(e.IsImportable,t.IsImportable),IsMailMergeEnabled:F(e.IsMailMergeEnabled,t.IsMailMergeEnabled),IsManaged:F(e.IsManaged,t.IsManaged),IsStateModelAware:F(e.IsStateModelAware,t.IsStateModelAware),EnforceStateTransitions:F(e.EnforceStateTransitions,t.EnforceStateTransitions),IsValidForAdvancedFind:F(e.IsValidForAdvancedFind,t.IsValidForAdvancedFind),IsVisibleInMobileClient:F(e.IsVisibleInMobileClient,t.IsVisibleInMobileClient),IsReadOnlyInMobileClient:F(e.IsReadOnlyInMobileClient,t.IsReadOnlyInMobileClient),IsOfflineInMobileClient:F(e.IsOfflineInMobileClient,t.IsOfflineInMobileClient),IsQuickCreateEnabled:F(e.IsQuickCreateEnabled,t.IsQuickCreateEnabled),EntityClientSetting:F(e.EntityClientSetting,t.EntityClientSetting),OwnershipType:F(e.OwnershipType,t.OwnershipType),Privileges:F(e.Privileges,t.Privileges),DataProviderId:F(e.DataProviderId,t.DataProviderId),OneToManyRelationships:Object.assign(Object.assign({},e.OneToManyRelationships),t.OneToManyRelationships),ManyToOneRelationships:Object.assign(Object.assign({},e.ManyToOneRelationships),t.ManyToOneRelationships),ManyToManyRelationships:Object.assign(Object.assign({},e.ManyToManyRelationships),t.ManyToManyRelationships)}}function F(e,t){if(null==e)return t;if(null==t)return e;if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)throw new Error("Descriptor field arrays with the same key have conflicting values");return e}if(e instanceof Object&&t instanceof Object){if(Object.keys(e).length!==Object.keys(t).length)throw new Error("Descriptor field objects with the same key have conflicting values");return e}if(e!==t)throw new Error("Descriptor fields with the same key have conflicting values");return e}function k(e,t){return e&&Object(o.a)(t.Entity1NavigationPropertyName)?t.SchemaName:t.Entity1NavigationPropertyName}function L(e,t){return e&&Object(o.a)(t.Entity2NavigationPropertyName)?t.SchemaName:t.Entity2NavigationPropertyName}function B(e,t){return e&&Object(o.a)(t.IntersectEntityName)?t.SchemaName:t.IntersectEntityName}function U(e,t,n){return e&&t&&Object(o.a)(n.ReferencingEntityNavigationPropertyName)?n.ReferencingAttribute:n.ReferencingEntityNavigationPropertyName}function V(e,t){return e&&Object(o.a)(t.ReferencedEntityNavigationPropertyName)?t.SchemaName:t.ReferencedEntityNavigationPropertyName}function z(e,t){return(!e||!Object(o.a)(t))&&t}function q(e,t){return e&&Object(o.a)(t)?a.a.EMPTY:t}},"1qQb":function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n("eXjw"),a=n("SAYH"),i=n("odYE");function o(e){const t={recordPrivileges:e.get_accessRights()},n=e.get_userSharedAttributePrivileges();if(n){const e={};for(const t in n){const r=n[t];e[t]={accessRightsMask:r.get_AccessRightsMask(),attributeId:a.a.fromLegacyGuid(r.get_AttributeId()),canCreate:r.get_CanCreate(),canRead:r.get_CanRead(),canUpdate:r.get_CanUpdate()}}t.attributePrivileges=e}return t}var s=n("/A0C"),c=n("XvL5"),l=n("2F73"),u=n("iZ7K");function d(e,t){if(!e)throw new Error("Legacy entity record is null");const n=e.get_fieldNames(),a=e.get_fieldTypes(),s={},d=new Date;if(n)for(const r of n){const n=a[r],i=e.getValue(r);null!==i?s[r]=p(t,r,n,i,e,d):s[r]=null}const f=e.get_globalNavigationData();let g=null,h=null;if(f){const e=i.a.fromLegacyEntityReference(f.get_identifier());e&&(h=e.id);const t=f.getValue("processid");if(t){g=i.a.fromLegacyEntityReference(t).id}}const m=e.get_columnSet();let b=[];if(m&&m instanceof c.a)b=m.get_Columns();else if(m&&m instanceof l.a){const n=e.get_identifier().LogicalName,r=Object(u.d)(t,n);b=Array.from(r)}return{initialized:r.a.Initialized,identifier:i.a.fromLegacyEntityReference(e.get_identifier()),accessRights:o(e),fields:s,businessProcessFlowId:g,businessProcessFlowInstanceId:h,queryColumnNames:b}}function p(e,t,n,r,o,c){const l={errorId:null,errorMessage:null,isValueValid:!0,userInput:null,isOfflineSyncError:!1};switch(n){case s.a.Boolean:case s.a.PickList:case s.a.State:case s.a.Status:const n=r;return{label:n.get_Label(),valueString:n.get_ValueString(),timestamp:c,validationResult:l};case s.a.UniqueIdentifier:const u=r;return{id:a.a.fromLegacyGuid(u),timestamp:c,validationResult:l};case s.a.Customer:case s.a.Lookup:case s.a.Owner:const f=r;return{reference:i.a.fromLegacyEntityReference(f),timestamp:c,validationResult:l};case s.a.AliasedValue:const g=r,h=g.get_entityLogicalName(),m=g.get_attributeLogicalName(),b=g.get_attributeType();return{attributeLogicalName:m,entityLogicalName:h,innerValue:p(e,t,b,g.get_value(),o,c),timestamp:c,validationResult:l,innerType:b};case s.a.PartyList:const y=r,_=[];for(const t of y.get_entities())_.push(d(t,e));return{list:_,timestamp:c,validationResult:l};case s.a.NavigationProperty:const v=r,S=[];for(const t of v)S.push(d(t,e));return{list:S,timestamp:c,validationResult:l};case s.a.DateTime:r=r&&r.toISOString();default:const O=o.get_formattedValues();if(O.hasOwnProperty(t))return{value:r,formatted:O[t],timestamp:c,validationResult:l};const C=o.get_numericFormattedValues();return C.hasOwnProperty(t)?{value:r,formatted:C[t],timestamp:c,validationResult:l}:{value:r,timestamp:c,validationResult:l}}}},"1u1B":function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"e",(function(){return d})),n.d(t,"b",(function(){return p})),n.d(t,"f",(function(){return f})),n.d(t,"c",(function(){return g})),n.d(t,"g",(function(){return h})),n.d(t,"d",(function(){return m}));var r=n("OKVy"),a=n("fILV"),i=n("cfbi"),o=n("UZFl"),s=n("EBJu"),c=n("P+p9"),l=n("ryEF");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const u="offline.bar.dismiss";function d(e){return{type:u,payload:{hasDismissedStatusBar:e}}}const p="offline.bar.dismiss.per.sync";function f(e){return{type:p,payload:{hasDismissedStatusBarPerSync:e}}}const g="show.sync.finished.notification";function h(e){return{type:g,payload:{showSyncFinishedNotification:e}}}function m(e){e.Router.registerNavigationBeginHandlers((e,t,n)=>-1!==[r.a,a.a,i.b,o.a,s.a].indexOf(n)?t(Object(c.b)(l.c)):Promise.resolve())}},"1usl":function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class r{constructor(e,t){this.EntityName=e,this.EntityId=t}getMetadata(){return{boundParameter:null,parameterTypes:{EntityName:{typeName:this.EntityName,structuralProperty:5},EntityId:{typeName:this.EntityId,structuralProperty:5}},operationName:"GetCurrentServerDateTimeInUtc",operationType:2}}}var a=n("w72X"),i=n("SAYH");const o="serverTime.retrieve";function s(e,t){return{type:o,execute({dispatch:n,getState:s},c){const l=n(Object(a.b)(new r(e.etn,i.a.toString(e.id)),t));return l.then(e=>{Promise.resolve(e.json().then(e=>{const t=e.ServerDateTime;let r=t.indexOf('"',t.indexOf("ServerTime")),a=t.indexOf('"',r+1),i=new Date(t.substring(r+1,a));"NaN"===i.toString()&&(r=t.indexOf('"',t.indexOf("ServerTimeForIE8")),a=t.indexOf('"',r+1),i=new Date(t.substring(r+1,a))),n(function(e){const t=e?Math.floor((Date.parse((new Date).toUTCString())-Date.parse(new Date(e).toUTCString()))/1e3):0;return{type:o,payload:{serverTimeDiffInSeconds:t}}}(i.toString()))}))},e=>{}),Promise.resolve(l)}}}},"1wvP":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"f",(function(){return c}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="add.AppNotificationToCenterAction",a="delete.AppNotificationIdAction",i="clear.AppNotificationIdsAction",o="notificationCenter.setInitialized",s="notificationCenter.setdisplay",c="notificationSettingPanel.setdisplay"},"23jc":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));function r(e,t,n,r){return{type:"execute.serialized.request.async",execute:async({dispatch:a,getState:i},o)=>await o.DataSource.executeSerializedRequest(e,r,t,n)}}},"2F73":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("XvL5");class a{get_isEmpty(){return!1}getDifference(e){return new r.a(new Array(0))}static get_instance(){return i||(i=new a)}}let i=null},"2FbK":function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return p}));var r=n("eXjw"),a=n("Lyxw"),i=n("GWSs"),o=n("NjDY"),s=n("3/02"),c=n("IqkD");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
let l=-1,u={};function d(e){const t=Object(i.f)(e);return t?function(e,t){if(e.metadata.siteMap.hasOwnProperty("Areas")&&e.metadata.siteMap.hasOwnProperty("AreaIds")){const n=Object(a.f)(e,s.Bg),r=Object(a.f)(e,s.Pf),i=Object(c.x)(e),d=null==i?void 0:i.autoCaptureUserStatus,p=Object(o.D)(e),m=Object(a.f)(e,s.ne),b=Object(a.f)(e,s.kh),y=null==p?void 0:p.isAutoDataCaptureV2Enabled,_=Object(a.f)(e,s.Ag);if(_||g(t,"Enterprise_Sales","AppExtensionsGrp"),y&&1===d||(g(t,"Enterprise_Sales","AutoCapture"),h(t,"Enterprise_Sales","My_Work","SuggestedActivty"),h(t,"Enterprise_Sales","Customers","SuggestedContact")),!n)return function(e){const t="Sales_Settings_Area",n=e.VersionNumber;n!==l&&(u=JSON.parse(JSON.stringify(e)),l=n);const r=u.AreaIds.indexOf(t);-1!==r&&(delete u.Areas[t],u.AreaIds.splice(r,1));return u}(t);r||g(t,"Sales_Settings_Area","PlaybookManagementGroup"),_||g(t,"Sales_Settings_Area","AppExtensionsGrp"),m||(h(t,"Sales_Settings_Area","GoalManagementGrp","ForecastDefinition"),h(t,"Sales_Settings_Area","GoalManagementGrp","ForecastConfiguration"),h(t,"Enterprise_Sales","Goals","ForecastInstance")),b||h(t,"Sales_Settings_Area","GeneralSettingsGroup","TeamsCallsIntegration"),function(e,t,n){const r=Object(a.f)(e,s.o),i="Sales_Personal_Settings_Area";let o;o=r?n?h(t,"Sales_Insights_Settings_Area","SalesInsightsGrp","Personal_Settings"):function(e){return f(e,"Sales_Insights_Settings_Area")}(t):f(t,i)}(e,t,i.isAdmin)}return t}(e,function(e,t){var n;const r="Settings",a=t.VersionNumber;a!==l&&(u=JSON.parse(JSON.stringify(t)),l=a);if(!0===(null===(n=e.configuration)||void 0===n?void 0:n.isD365DefaultApp)&&e.metadata.siteMap.hasOwnProperty("Areas")&&e.metadata.siteMap.hasOwnProperty("AreaIds")){const e=u.AreaIds.indexOf(r);-1!==e&&(delete u.Areas[r],u.AreaIds.splice(e,1))}return u}(e,t)):null}function p(e){const t=Object(i.b)(e);return t&&t===r.a.Initialized?d(e):null}function f(e,t){const n=e.VersionNumber;n!==l&&(u=JSON.parse(JSON.stringify(e)),l=n);const r=u.AreaIds.indexOf(t);return-1!==r&&(delete u.Areas[t],u.AreaIds.splice(r,1)),u}function g(e,t,n){const r=e.VersionNumber;r!==l&&(u=JSON.parse(JSON.stringify(e)),l=r);let a=u.AreaIds.indexOf(t);return-1!==a&&(a=-1,a=u.Areas[t].GroupIds.indexOf(n),-1!==a&&(delete u.Areas[t].Groups[n],u.Areas[t].GroupIds.splice(a,1))),u}function h(e,t,n,r){const a=e.VersionNumber;a!==l&&(u=JSON.parse(JSON.stringify(e)),l=a);let i=u.AreaIds.indexOf(t);return-1!==i&&(i=-1,i=u.Areas[t].GroupIds.indexOf(n),-1!==i&&null!==r&&(i=-1,i=u.Areas[t].Groups[n].SubAreaIds.indexOf(r),-1!==i))?(delete u.Areas[t].Groups[n].SubAreas[r],u.Areas[t].Groups[n].SubAreaIds.splice(i,1),u):u}},"2JG5":function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("84PK"),a=n("504W"),i=n("NMtn"),o=n("KLhE"),s=n("b6oC");class c{constructor(e,t,n,r,a,o,s,c,l,u,d,p,f,g,h,m,b,y,_,v,S,O,C,E,I,w,j,P,T,N,A,R,D,x,M,F,k,L,B,U,V,z,q,H,W,G,K,Q,X,Y,J,$,Z,ee,te){this._id=null,this._logicalName=null,this._objectTypeCode=0,this._primaryIdAttribute=null,this._primaryNameAttribute=null,this._primaryImageAttribute=null,this._privilegesByType=null,this._hasChanged=!1,this._isActivity=!1,this._isReadOnlyForMobileClient=!1,this._isVisibleInMobileClient=!1,this._isOfflineInMobileClient=!1,this._isOptimisticConcurrencyEnabled=!1,this._isChildEntity=!1,this._parentEntityLogicalName=null,this._parentEntityReferencingAttribute=null,this._displayName=null,this._primaryKeyName=null,this._autoRouteToOwnerQueue=!1,this._canTriggerWorkflow=!1,this._displayCollectionName=null,this._description=null,this._canCreateForms=!1,this._entitySetName=null,this._isValidForAdvancedFind=!1,this._isMailMergeEnabled=!1,this._isConnectionsEnabled=!1,this._isCustomizable=!1,this._isActivityParty=!1,this._isImportable=!1,this._isEnabledForCharts=!1,this._isCustomEntity=!1,this._isStateModelAware=!1,this._enforceStateTransitions=!1,this._activityTypeMask=0,this._ownershipType=0,this._isCollaboration=!1,this._hasSecuredAttributes=!1,this._hasStateCode=!1,this._isBusinessProcessEnabled=!1,this._isDocumentManagementEnabled=!1,this._isOneNoteIntegrationEnabled=!1,this._isMSTeamsIntegrationEnabled=!1,this._isIntersect=!1,this._hasActivities=!1,this._entityColor=null,this._isInteractionCentricEnabled=!1,this._isQuickCreateEnabled=!1,this._entityClientSetting={AllowMainFormDialogForCreate:!1,AllowMainFormDialogForEdit:!1},this._isKnowledgeManagementEnabled=!1,this._isDocumentRecommendationsEnabled=!1,this._hasNotes=!1,this._usesBusinessDataLabelTable=!1,this._isBPFEntity=!1,this._oneToManyRelationships=null,this._manyToOneRelationships=null,this._manyToManyRelationships=null,this._iconVectorName=null,this._dataProviderId=null,this._versionNumber=0,this._overallVersionNumber=0,this._attributeNames=null,this._attributes=null,Object(i.d)(e,"id"),Object(i.d)(t,"logicalName"),this._id=e,this._logicalName=t,this._displayName=n,this._entitySetName=r,this._objectTypeCode=a,this._primaryIdAttribute=o,this._primaryNameAttribute=s,this._primaryImageAttribute=c,this._isReadOnlyForMobileClient=u,this._isVisibleInMobileClient=d,this._isOfflineInMobileClient=p,this._isOptimisticConcurrencyEnabled=f,this._hasChanged=g,this._isActivity=h,this._isChildEntity=m,this._parentEntityLogicalName=b,this._parentEntityReferencingAttribute=y,this._isValidForAdvancedFind=_,this._isMailMergeEnabled=v,this._isConnectionsEnabled=S,this._isCustomizable=O,this._isActivityParty=C,this._isImportable=E,this._isEnabledForCharts=I,this._isCustomEntity=w,this._isStateModelAware=j,this._enforceStateTransitions=P,this._isCollaboration=T,this._activityTypeMask=N,this._ownershipType=A,this._hasSecuredAttributes=R,this._hasStateCode=D,this._isBusinessProcessEnabled=x,this._entityHelpUrlEnabled=M,this._entityHelpUrl=F,this._isDocumentManagementEnabled=k,this._isOneNoteIntegrationEnabled=L,this._isMSTeamsIntegrationEnabled=B,this._hasActivities=U,this._entityColor=V,this._isInteractionCentricEnabled=z,this._isQuickCreateEnabled=q,this._entityClientSetting=H,this._isKnowledgeManagementEnabled=W,this._isDocumentRecommendationsEnabled=G,this._isIntersect=K,this._hasNotes=Q,this._usesBusinessDataLabelTable=X,this._iconVectorName=Y,this._isBPFEntity=J,this._versionNumber=$,this._overallVersionNumber=Z,this._attributeNames=ee,this._privilegesByType={};for(const e of l)this._privilegesByType[e.get_privilegeTypeKey()]=e;this._attributes=te}get_attributeNames(){return this._attributeNames}get_id(){return this._id}get_logicalName(){return this._logicalName}get_displayName(){return this._displayName}set_entitySetName(e){return this._entitySetName=e,e}get_objectTypeCode(){return this._objectTypeCode}get_primaryIdAttribute(){return this._primaryIdAttribute}get_primaryNameAttribute(){return this._primaryNameAttribute}get_isOptimisticConcurrencyEnabled(){return this._isOptimisticConcurrencyEnabled}get_isActivity(){switch(this._logicalName){case"phonecall":case"email":case"task":case"appointment":case"activitypointer":return!0;default:return this._isActivity}}get_isChildEntity(){return this._isChildEntity}get_parentEntityLogicalName(){return this._parentEntityLogicalName}get_parentEntityReferencingAttribute(){return this._parentEntityReferencingAttribute}get_isCustomEntity(){return this._isCustomEntity}get_activityTypeMask(){return this._activityTypeMask}get_ownershipType(){return this._ownershipType}get_hasSecuredAttributes(){return this._hasSecuredAttributes}get_hasStateCode(){return this._hasStateCode}get_isBusinessProcessEnabled(){return this._isBusinessProcessEnabled}get_isIntersect(){return this._isIntersect}get_usesBusinessDataLabelTable(){return this._usesBusinessDataLabelTable}get_isBPFEntity(){return this._isBPFEntity}getEntityCanBeUsedInBusinessProcess(){return this._isBusinessProcessEnabled||this._isBPFEntity}getODataObject(){const e={},t=this._id.toString();e.Id=t,e.MetadataId=t,e.LogicalName=this._logicalName,e.DisplayName=c.convertToLabel(this._displayName),e.EntitySetName=this._entitySetName,e.ObjectTypeCode=this._objectTypeCode,e.PrimaryKeyName=this._primaryKeyName,e.AutoRouteToOwnerQueue=this._autoRouteToOwnerQueue,e.CanTriggerWorkflow=this._canTriggerWorkflow,e.Description=c.convertToLabel(this._description),e.DisplayCollectionName=c.convertToLabel(this._displayCollectionName),e.PrimaryIdAttribute=this._primaryIdAttribute,e.PrimaryNameAttribute=this._primaryNameAttribute,e.PrimaryImageAttribute=this._primaryImageAttribute,e.IsReadOnlyInMobileClient=this._isReadOnlyForMobileClient,e.IsVisibleInMobileClient=this._isVisibleInMobileClient,e.IsOfflineInMobileClient=this._isOfflineInMobileClient,e.IsOptimisticConcurrencyEnabled=this._isOptimisticConcurrencyEnabled,e.HasChanged=this._hasChanged,e.CanCreateForms=this._canCreateForms,e.IsActivity=this._isActivity,e.IsChildEntity=this._isChildEntity,e.ParentEntityLogicalName=this._parentEntityLogicalName,e.ParentEntityReferencingAttribute=this._parentEntityReferencingAttribute,e.IsValidForAdvancedFind=this._isValidForAdvancedFind,e.IsMailMergeEnabled=this._isMailMergeEnabled,e.IsConnectionsEnabled=this._isConnectionsEnabled,e.IsCustomizable=this._isCustomizable,e.IsActivityParty=this._isActivityParty,e.IsImportable=this._isImportable,e.IsEnabledForCharts=this._isEnabledForCharts,e.IsCustomEntity=this._isCustomEntity,e.IsStateModelAware=this._isStateModelAware,e.EnforceStateTransitions=this._enforceStateTransitions,e.IsValidForQueue=this._isCollaboration,e.ActivityTypeMask=this._activityTypeMask,e.OwnershipType=this._ownershipType,e.HasStateCode=this._hasStateCode,e.IsBusinessProcessEnabled=this._isBusinessProcessEnabled,e.IsDocumentManagementEnabled=this._isDocumentManagementEnabled,e.EntityColor=this._entityColor,e.IsInteractionCentricEnabled=this._isInteractionCentricEnabled,e.isQuickCreateEnabled=this._isQuickCreateEnabled,e.entityClientSetting=this._entityClientSetting,e.IsKnowledgeManagementEnabled=this._isKnowledgeManagementEnabled,e.OneToManyRelationships=this._oneToManyRelationships,e.ManyToOneRelationships=this._manyToOneRelationships,e.ManyToManyRelationships=this._manyToManyRelationships,e.IconVectorName=this._iconVectorName,e.IsBPFEntity=this._isBPFEntity,e.DataProviderId=this._dataProviderId?this._dataProviderId.toString():"",e.IsDocumentRecommendationsEnabled=this._isDocumentRecommendationsEnabled,e.IsIntersect=this._isIntersect,e.IsMSTeamsIntegrationEnabled=this._isMSTeamsIntegrationEnabled,e.VersionNumber=this._versionNumber,e.OverallVersionNumber=this._overallVersionNumber,e.AttributeNames=this._attributeNames,e.Privileges=[];for(const t in this._privilegesByType)e.Privileges.push(this._privilegesByType[t].getODataObject());return e.Attributes=this._attributes,e}getStorableODataObject(){return Object.assign(Object.assign({},this._getKeyPaths()),this.getODataObject())}getObjectData(){const e={};Object.assign(e,this._getKeyPaths()),e.displayname=this._displayName,e.entitysetname=this._entitySetName,e.objecttypecode=this._objectTypeCode,e.primaryidattribute=this._primaryIdAttribute,e.primarykeyname=this._primaryKeyName,e.displayCollectionName=this._displayCollectionName,e.autoRouteToOwnerQueue=this._autoRouteToOwnerQueue,e.canTriggerWorkflow=this._canTriggerWorkflow,e.primarynameattribute=this._primaryNameAttribute,e.primaryimageattribute=this._primaryImageAttribute,e.description=this._description,e.oneToManyRelationships=this._oneToManyRelationships,e.manyToOneRelationships=this._manyToOneRelationships,e.manyToManyRelationships=this._manyToManyRelationships,e.isreadonlyformobileclient=this._isReadOnlyForMobileClient,e.isvisibleinmobileclient=this._isVisibleInMobileClient,e.isofflineinmobileclient=this._isOfflineInMobileClient,e.isoptimisticconcurrencyenabled=this._isOptimisticConcurrencyEnabled,e.haschanged=this._hasChanged,e.canCreateForms=this._canCreateForms,e.isactivity=this._isActivity,e.ischildentity=this._isChildEntity,e.parententitylogicalname=this._parentEntityLogicalName,e.parententityreferencingattribute=this._parentEntityReferencingAttribute,e.isvalidforadvancedfind=this._isValidForAdvancedFind,e.ismailmergeenabled=this._isMailMergeEnabled,e.isconnectionsenabled=this._isConnectionsEnabled,e.iscustomizable=this._isCustomizable,e.isactivityparty=this._isActivityParty,e.isimportable=this._isImportable,e.isenabledforcharts=this._isEnabledForCharts,e.iscustomentity=this._isCustomEntity,e.isstatemodelaware=this._isStateModelAware,e.enforcestatetransitions=this._enforceStateTransitions,e.iscollaboration=this._isCollaboration,e.activitytypemask=this._activityTypeMask,e.ownershiptype=this._ownershipType,e.hassecuredattributes=this._hasSecuredAttributes,e.hasstatecode=this._hasStateCode,e.isbusinessprocessenabled=this._isBusinessProcessEnabled,e.entityhelpurlenabled=this._entityHelpUrlEnabled,e.entityhelpurl=this._entityHelpUrl,e.isdocumentmanagementenabled=this._isDocumentManagementEnabled,e.isonenoteintegrationenabled=this._isOneNoteIntegrationEnabled,e.ismsteamsintegrationenabled=this._isMSTeamsIntegrationEnabled,e.hasactivities=this._hasActivities,e.entitycolor=this._entityColor,e.isinteractioncentricenabled=this._isInteractionCentricEnabled,e.isQuickCreateEnabled=this._isQuickCreateEnabled,e.entityClientSetting=this._entityClientSetting,e.isKnowledgeManagementEnabled=this._isKnowledgeManagementEnabled,e.isDocumentRecommendationsEnabled=this._isDocumentRecommendationsEnabled,e.isIntersect=this._isIntersect,e.hasnotes=this._hasNotes,e.iconVectorName=this._iconVectorName,e.usesBusinessDataLabelTable=this._usesBusinessDataLabelTable,e.isbpfentity=this._isBPFEntity,e.dataProviderId=this._dataProviderId?this._dataProviderId.toString():"",e.VersionNumber=this._versionNumber,e.OverallVersionNumber=this._overallVersionNumber,e.AttributeNames=this._attributeNames;const t=[],n=this._privilegesByType;for(const e in n){const r={key:e,value:n[e]};t.push(r.value.getObjectData())}return e.privileges=t,e}_getKeyPaths(){return{id:this._id.getObjectData(),[c.logicalNamePath]:this._logicalName}}static hasAccessRights(e,t){let n=t.getEntityMetadata(e);if(Object(a.a)(n))return!1;if(n.get_isChildEntity()){const e=t.getEntityMetadata(n.get_parentEntityLogicalName());Object(a.a)(e)||(n=e)}if(n._ownershipType&o.a.userOwned){switch(n.get_logicalName()){case"activitypointer":case"salesorderdetail":case"importdata":case"knowledgearticleincident":case"importlog":case"mailboxtrackingfolder":case"actioncard":case"dynamicpropertyinstance":case"callbackregistration":case"msdyn_productivitymacroconnector":case"postfollow":case"userentityuisettings":case"opportunityproduct":case"recurrencerule":case"contractdetail":case"untrackedemail":case"sharepointdocument":case"quotedetail":case"userapplicationmetadata":case"bulkoperationlog":case"interactionforemail":case"actioncardusersettings":case"mailboxtrackingcategory":case"exchangesyncidmapping":case"entitlementchannel":case"userentityinstancedata":case"invoicedetail":case"bookableresourcebookingexchangesyncidmapping":return!1}return!0}return!1}static extractKey(e){const t=e.id;return t?r.a.createFromObjectData(t).toString():e.Id}static createFromObjectData(e){if(!Object(a.b)(e.MetadataId)){e=c.createFromOData(e).getObjectData()}const t=r.a.createFromObjectData(e.id),n=e[c.logicalNamePath],i=e.displayname,o=e.entitysetname,l=e.objecttypecode,u=e.primaryidattribute,d=e.primarynameattribute,p=e.primaryimageattribute,f=e.isreadonlyformobileclient,g=e.isvisibleinmobileclient,h=e.isofflineinmobileclient,m=e.isoptimisticconcurrencyenabled,b=e.haschanged,y=e.canCreateForms,_=e.isactivity,v=e.ischildentity,S=e.parententitylogicalname,O=e.parententityreferencingattribute,C=e.isvalidforadvancedfind,E=e.ismailmergeenabled,I=e.isconnectionsenabled,w=e.iscustomizable,j=e.isactivityparty,P=e.isimportable,T=e.isenabledforcharts,N=e.iscustomentity,A=e.isstatemodelaware,R=e.enforcestatetransitions,D=e.iscollaboration,x=e.activitytypemask,M=e.ownershiptype,F=e.hassecuredattributes,k=e.hasstatecode,L=e.isbusinessprocessenabled,B=e.entityhelpurlenabled,U=e.entityhelpurl,V=e.isdocumentmanagementenabled,z=e.isonenoteintegrationenabled,q=e.ismsteamsintegrationenabled,H=e.hasactivities,W=e.entitycolor,G=e.isinteractioncentricenabled,K=e.isQuickCreateEnabled,Q=e.entityClientSetting,X=e.isKnowledgeManagementEnabled,Y=e.IsDocumentRecommendationsEnabled,J=e.isIntersect,$=e.hasnotes,Z=e.usesBusinessDataLabelTable,ee=e.iconVectorName,te=e.isbpfentity,ne=Object(a.b)(e.dataProviderId)?null:r.a.tryCreate(e.dataProviderId),re=e.primaryKeyName,ae=e.autoRouteToOwnerQueue,ie=e.canTriggerWorkflow,oe=e.displayCollectionName,se=e.description,ce=e.oneToManyRelationships,le=e.manyToOneRelationships,ue=e.manyToManyRelationships;let de=-1,pe=-1;e.VersionNumber&&(de=e.VersionNumber),e.OverallVersionNumber&&(pe=e.OverallVersionNumber);const fe=e.AttributeNames,ge=e.privileges.map(e=>s.a.createFromObjectData(e)),he=new c(t,n,i,o,l,u,d,p,ge,f,g,h,m,b,_,v,S,O,C,E,I,w,j,P,T,N,A,R,D,x,M,F,k,L,B,U,V,z,q,H,W,G,K,Q,X,Y,J,$,Z,ee,te,de,pe,fe);return he._primaryKeyName=re,he._autoRouteToOwnerQueue=ae,he._canTriggerWorkflow=ie,he._canCreateForms=y,he._displayCollectionName=oe,he._description=se,he._dataProviderId=ne,he._oneToManyRelationships=ce,he._manyToManyRelationships=ue,he._manyToOneRelationships=le,he}static getLabelString(e){return Object(a.a)(e)||Object(a.a)(e.UserLocalizedLabel)?null:e.UserLocalizedLabel.Label}static convertToLabel(e){const t={UserLocalizedLabel:{}};return t.UserLocalizedLabel.Label=e,t}static createFromOData(e){const t=r.a.tryCreate(e.MetadataId),n=e.LogicalName,i=c.getLabelString(e.DisplayName),o=e.EntitySetName,l=e.ObjectTypeCode,u=e.PrimaryIdAttribute,d=e.IconVectorName,p=e.PrimaryKeyName,f=e.AutoRouteToOwnerQueue,g=e.CanTriggerWorkflow,h=e.PrimaryNameAttribute,m=e.PrimaryImageAttribute,b=e.IsReadOnlyInMobileClient,y=e.IsVisibleInMobileClient,_=e.IsOfflineInMobileClient,v=e.IsOptimisticConcurrencyEnabled,S=e.HasChanged,O=e.CanCreateForms,C=e.IsActivity,E=e.IsChildEntity,I=e.ParentEntityLogicalName,w=e.ParentEntityReferencingAttribute,j=e.IsValidForAdvancedFind,P=e.IsMailMergeEnabled,T=e.IsConnectionsEnabled,N=e.IsCustomizable,A=e.IsActivityParty,R=e.IsImportable,D=e.IsEnabledForCharts,x=e.IsCustomEntity,M=e.IsStateModelAware,F=e.EnforceStateTransitions,k=e.IsValidForQueue,L=e.ActivityTypeMask,B=e.OwnershipType,U=e.IsBusinessProcessEnabled,V=e.EntityHelpUrlEnabled,z=e.EntityHelpUrl,q=e.IsDocumentManagementEnabled,H=e.IsOneNoteIntegrationEnabled,W=e.IsMSTeamsIntegrationEnabled,G=e.EntityColor,K=e.IsInteractionCentricEnabled,Q=e.IsQuickCreateEnabled,X=e.entityClientSetting,Y=e.IsKnowledgeManagementEnabled,J=e.IsDocumentManagementEnabled,$=e.IsBPFEntity,Z=e.OneToManyRelationships,ee=e.ManyToOneRelationships,te=e.ManyToManyRelationships,ne=c.getLabelString(e.DisplayCollectionName),re=c.getLabelString(e.Description),ae=Object(a.b)(e.DataProviderId)?null:r.a.tryCreate(e.DataProviderId);let ie=-1,oe=-1;e.VersionNumber&&(ie=e.VersionNumber),e.OverallVersionNumber&&(oe=e.OverallVersionNumber);let se=!1;const ce=e.AttributeNames;for(let e=0;e<ce.length;e++)if("statecode"===ce[e]){se=!0;break}const le=e.IsIntersect,ue=e.Privileges.map(e=>s.a.createFromOData(e)),de=new c(t,n,i,o,l,u,h,m,ue,b,y,_,v,S,C,E,I,w,j,P,T,N,A,R,D,x,M,F,k,L,B,!1,se,U,V,z,q,H,W,!1,G,K,Q,X,Y,J,le,!1,!1,d,$,ie,oe,ce,e.Attributes);return de._primaryKeyName=p,de._autoRouteToOwnerQueue=f,de._canTriggerWorkflow=g,de._canCreateForms=O,de._displayCollectionName=ne,de._description=re,de._dataProviderId=ae,de._oneToManyRelationships=Z,de._manyToOneRelationships=ee,de._manyToManyRelationships=te,de}}c.logicalNamePath="logicalname"},"2LZB":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("504W");class a{constructor(e,t,n){this._batchOffset=0,this._batchSize=0,this._filterCriteria=null,this.set_filterCriteria(e),Object(r.a)(n)||this.set_batchOffset(n),Object(r.a)(t)||this.set_batchSize(t)}get_batchOffset(){return this._batchOffset}set_batchOffset(e){return this._batchOffset=e,e}get_batchSize(){return this._batchSize}set_batchSize(e){return this._batchSize=e,e}get_filterCriteria(){return this._filterCriteria}set_filterCriteria(e){return this._filterCriteria=e,e}}},"2OPF":function(e,t,n){"use strict";(function(e,r){var a,i=n("bqQC");a="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==e?e:r;var o=Object(i.a)(a);t.a=o}).call(this,n("Gjxs"),n("WvT0")(e))},"2QCH":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("IpQH"),a=n("uM6Y"),i=n("VkXQ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class o extends r.a{constructor(e,t){super(e,t,a.b)}openARViewer(e){return this.execute(i.b.openARViewer.name,e)}}},"2SCk":function(e,t,n){"use strict";n.d(t,"h",(function(){return l})),n.d(t,"d",(function(){return u})),n.d(t,"l",(function(){return h})),n.d(t,"c",(function(){return m})),n.d(t,"k",(function(){return y})),n.d(t,"u",(function(){return _})),n.d(t,"a",(function(){return E})),n.d(t,"b",(function(){return w})),n.d(t,"f",(function(){return d})),n.d(t,"e",(function(){return p})),n.d(t,"g",(function(){return f})),n.d(t,"p",(function(){return j})),n.d(t,"i",(function(){return P})),n.d(t,"n",(function(){return g})),n.d(t,"j",(function(){return T})),n.d(t,"o",(function(){return x})),n.d(t,"y",(function(){return M})),n.d(t,"x",(function(){return L})),n.d(t,"w",(function(){return F})),n.d(t,"v",(function(){return k})),n.d(t,"s",(function(){return U})),n.d(t,"t",(function(){return z})),n.d(t,"r",(function(){return V})),n.d(t,"m",(function(){return q})),n.d(t,"q",(function(){return H}));var r,a=n("W8Pl"),i=n("+QYJ"),o=n("izYK"),s=n("pGYJ"),c=n("g03H");function l(e,t,n){if(n)return n;if(!t)return t;var r=u(e);return(r?r+"-":"")+t}function u(e){if(e.configuration&&e.configuration.CustomControlId===c.b)return function(e){return e.descriptor.DomId+"-"+e.descriptor.Id}(e);var t="";return e.descriptor&&(t=e.descriptor.DomId?e.descriptor.DomId:""),(t?t+"-":"")+((e.controlId?e.controlId:"")||"")}function d(e,t){var n=e&&e.controlId?e.controlId:"";return t?(n?n+"-":"")+t:n||""}function p(e){return Object(i.c)(e)||Object(i.c)(e.propBagData)||Object(i.c)(e.propBagData.accessibilityData)||Object(i.c)(e.propBagData.accessibilityData.assignedTabIndex)?0:e.propBagData.accessibilityData.assignedTabIndex}function f(e){var t,n,r;return null!==(r=null===(n=null===(t=null==e?void 0:e.propBagData)||void 0===t?void 0:t.accessibilityData)||void 0===n?void 0:n.assignedTooltip)&&void 0!==r?r:null}function g(){if(void 0===r){if(window.matchMedia("(-ms-high-contrast: active)").matches)r=!0;else{var e=document.getElementsByTagName("html");r=null!=e[0].getAttribute("hc")}}return r}function h(e,t,n){var r=b(e,t,n);if(r&&null!==r){var a=document.getElementById(r);a&&null!==a&&a.focus()}}function m(e,t,n){var r=b(e,t,n);if(r&&null!==r){var a=document.getElementById(r);a&&null!==a&&a.blur()}}function b(e,t,n){if(t)return!0===n?t:l(e,t)}function y(e,t){var n=t.organizationUniqueName?t.organizationUniqueName:"";return!!t.usePathBasedUrls&&t.usePathBasedUrls&&n?"/"+n+e:e}function _(e,t,n,r,i,o){if(i){var c=i.entityType||i.entityName||i.LogicalName,l=i.id||i.Id&&i.Id.toString(),u=function(e,t){var n=t&&e.dynamicData?e.dynamicData.parameters[t]:null;return e.actions&&e.actions.getRecordSetQueryKey&&null!==n?e.actions.getRecordSetQueryKey(n):null}(e,n),d=function(){try{var t={entityName:c,entityId:l,recordSetQueryKey:u};if(e.parentDefinedControlProps&&e.parentDefinedControlProps.propertyBagOverrides&&e.parentDefinedControlProps.propertyBagOverrides.openForm)e.parentDefinedControlProps.propertyBagOverrides.openForm(t,null,e.id);else{if(!t.entityName)throw new Error("EntityName was not passed in to method, cannot call openForm");a.b.openForm(t,null,e.id)}}catch(t){var n="";try{n=JSON.stringify(e)}catch(e){n="Unable to parse ownProps"}try{e.propBagMethods.navigation&&e.propBagMethods.navigation.openEditForm&&e.propBagMethods.navigation.openEditForm(i,null,null,null,null,e.id)}catch(e){a.b.Reporting.reportFailure(s.a+".Utilities",t,"propBagMethods.navigation.openEditForm failed",[{name:"ownProps",value:n},{name:"APIName",value:s.a+".Utilities.CustomControlHelper.openDatasetItemAction"}])}a.b.Reporting.reportFailure(s.a+".Utilities",t,"XrmProxyInstance.openForm failed",[{name:"ownProps",value:n},{name:"APIName",value:s.a+"Utilities.CustomControlHelper.openFormAction"}])}};c!==t.getTargetEntityType()&&"activitypointer"!==t.getTargetEntityType()||!t.records.hasOwnProperty(l)?d():a.b.Utils.isFeatureEnabled("GridOverrideOpenRecord")&&r?r(e.id,c,l,e.contextToken).then((function(e){e?a.b.Reporting.reportSuccess(s.a+".Utilities",[{name:"hasCustomOpenAction",value:e},{name:"entityName",value:c},{name:"APIName",value:s.a+".Utilities.CustomControlHelper.runCustomOpenRecord"}]):p()}),(function(e){a.b.Reporting.reportFailure(s.a+".Utilities",e,"runCustomOpenRecord failed",[{name:"APIName",value:s.a+".Utilities.CustomControlHelper.runCustomOpenRecord"},{name:"entityName",value:c}])})):p()}function p(){if(t.retrieveRecordCommand){var e=o&&o.CommandButtonId?o.CommandButtonId:"Mscrm.OpenRecordItem";t.retrieveRecordCommand([l],[e],!1,!1,!1).then((function(e){e&&e.length>0?e[0].execute():d()}),(function(){d()}))}else d()}}function v(e){return Object(i.c)(e)||0===e.length}function S(e){return Object(i.c)(e)||0===e.length}function O(e){return Object(i.c)(e)||Object(i.c)(e.filterOperator)||S(e.conditions)&&v(e.filters)}function C(e,t){if(Object(i.c)(e)&&Object(i.c)(t))return!0;if(Object(i.c)(e)||Object(i.c)(t))return!1;var n="number"==typeof e?e.toString(10):e,r="number"==typeof t?t.toString(10):t;if(typeof n!=typeof r)return!1;if("string"==typeof n)return e===t;if(!Object(i.a)(n)||!Object(i.a)(r))return!1;if(n.length!==r.length)return!1;for(var a=0;a<n.length;a++){if(!C(n[a],r[a]))return!1}}function E(e,t,n){if(O(e)&&O(t))return!0;if(O(e)||O(t))return!1;if(e.filterOperator!==t.filterOperator)return!1;var r,a,o=e.conditions,s=t.conditions;if(S(o)&&S(s)){var c=e.filters,l=t.filters;if(v(c)&&v(l))return!0;if(v(c)||v(l))return!1;if(c.length!==l.length)return!1;for(var u=0;u<c.length;u++){if(!E(c[u],l[u],n))return!1}}else{if(S(o)||S(s))return!1;if(o.length!==s.length)return!1;for(u=0;u<o.length;u++){var d=o[u],p=s[u];if(!(I(d.attributeName,p.attributeName,n)&&d.conditionOperator===p.conditionOperator&&(r=d.entityAliasName,a=p.entityAliasName,Object(i.b)(r)&&Object(i.b)(a)||!Object(i.b)(r)&&!Object(i.b)(a)&&r===a)&&C(d.value,p.value)))return!1}}return!0}function I(e,t,n){return n?(n.hasOwnProperty(e)?n[e]:e)===(n.hasOwnProperty(t)?n[t]:t):e===t}function w(e,t){if(Object(i.c)(e)&&Object(i.c)(t))return!0;if(Object(i.c)(e)||Object(i.c)(t))return!1;if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++){var r=e[n],a=t[n];if(r.name!==a.name||r.sortDirection!==a.sortDirection)return!1}return!0}function j(e){var t,n=u(e).split("-");for(t=0;t<n.length-1;t++)if("id"!==n[t]&&isNaN(Number(n[t])))return n[t];return""}function P(e){try{if(!e)return null;var t=(new DOMParser).parseFromString(e,"text/xml");if(t){var n=t.getElementsByTagName("filter");return n&&0!==n.length?R(n[0]):null}return a.b.Diagnostics.traceInfo(s.a+".convertFetchXmlToFilterExpression","return null"),null}catch(t){a.b.Reporting.reportFailure(s.a+".Utilities",t,"convert xml failed",[{name:"inputFetchXmlSnippet",value:e},{name:"APIName",value:s.a+".Utilities.CustomControlHelper.convertFetchXmlToFilterExpression"}])}}function T(e,t){t||(t=function(e){return e});var n="";if(Object(i.c)(e)||(Object(i.c)(e.filters)||0===e.filters.length)&&(Object(i.c)(e.conditions)||0===e.conditions.length))return n;if(!Object(i.c)(e.conditions)&&e.conditions.length>0){n+='<filter type="'+N(e.filterOperator)+'"',n+=">";for(var r=0;r<e.conditions.length;r++){var a=e.conditions[r];if(n+="<condition ",Object(i.b)(a.entityAliasName)||(n+='entityname="'+a.entityAliasName+'" '),null==a.value)n+='attribute="'+a.attributeName+'" operator="'+A(a.conditionOperator)+'"/>';else if("string"==typeof a.value||"number"==typeof a.value)n+='attribute="'+a.attributeName+'" operator="'+A(a.conditionOperator)+'" value="'+t(a.value)+'" />';else{var o=a.value;n+='attribute="'+a.attributeName+'" operator="'+A(a.conditionOperator)+'">';for(var s=0;s<o.length;s++)n+="<value>"+t(o[s])+"</value>";n+="</condition>"}}n+="</filter>"}else{e.filters.length>0&&(n+='<filter type="'+N(e.filterOperator)+'">');for(r=0;r<e.filters.length;r++)n+=T(e.filters[r],t);e.filters.length>0&&(n+="</filter>")}return n}function N(e){switch(e){case 0:return"and";case 1:return"or"}}function A(e){switch(e){case 0:return"eq";case 1:return"ne";case 2:return"gt";case 3:return"lt";case 4:return"ge";case 5:return"le";case 6:return"like";case 7:return"not-like";case 8:return"in";case 9:return"not-in";case 10:return"between";case 11:return"not-between";case 12:return"null";case 13:return"not-null";case 14:return"yesterday";case 15:return"today";case 16:return"tomorrow";case 17:return"last-seven-days";case 18:return"next-seven-days";case 19:return"last-week";case 20:return"this-week";case 21:return"next-week";case 22:return"last-month";case 23:return"this-month";case 24:return"next-month";case 25:return"on";case 26:return"on-or-before";case 27:return"on-or-after";case 28:return"last-year";case 29:return"this-year";case 30:return"next-year";case 31:return"last-x-hours";case 32:return"next-x-hours";case 33:return"last-x-days";case 34:return"next-x-days";case 35:return"last-x-weeks";case 36:return"next-x-weeks";case 37:return"last-x-months";case 38:return"next-x-months";case 39:return"last-x-years";case 40:return"next-x-years";case 41:return"eq-userid";case 42:return"ne-userid";case 43:return"eq-businessid";case 44:return"ne-businessid";case 49:return"contain-values";case 51:return"eq-userlanguage";case 53:return"olderthan-x-months";case 54:return"begins-with";case 55:return"not-begin-with";case 56:return"ends-with";case 57:return"not-end-with";case 58:return"this-fiscal-year";case 59:return"this-fiscal-period";case 60:return"next-fiscal-year";case 61:return"next-fiscal-period";case 62:return"last-fiscal-year";case 63:return"last-fiscal-period";case 64:return"last-x-fiscal-years";case 65:return"last-x-fiscal-periods";case 66:return"next-x-fiscal-years";case 67:return"next-x-fiscal-periods";case 68:return"in-fiscal-year";case 69:return"in-fiscal-period";case 70:return"in-fiscal-period-and-year";case 71:return"in-or-before-fiscal-period-and-year";case 72:return"in-or-after-fiscal-period-and-year";case 73:return"eq-userteams";case 74:return"eq-useroruserteams";case 75:return"above";case 76:return"under";case 77:return"not-under";case 78:return"eq-or-above";case 79:return"eq-or-under";case 80:return"eq-useroruserhierarchy";case 81:return"eq-useroruserhierarchyandteams";case 82:return"olderthan-x-years";case 83:return"olderthan-x-weeks";case 84:return"olderthan-x-days";case 85:return"olderthan-x-hours";case 86:return"olderthan-x-minutes";case 87:return"contain-values";case 88:return"not-contain-values"}}function R(e,t){if(!e||"string"==typeof e)return null;var n=e,r=function(e){if(!e)return 0;switch(e){case"and":return 0;case"or":return 1}return null}(x(n,"type"));if(null===r||!n.childNodes||0===n.childNodes.length)return null;for(var a,i=[],o=[],s=0;s<n.childNodes.length;s++){var c=n.childNodes.item(s);if("string"!=typeof c&&("filter"===c.nodeName||"condition"===c.nodeName))if("filter"===c.nodeName){var l=R(c,t);l&&i.push(l)}else if("condition"===c.nodeName){var u=x(c,"attribute"),d=x(c,"operator"),p=x(c.parentElement&&c.parentElement.parentElement,"name"),f=t||x(c,"entityname"),g=D(d);if(null!==g&&u){var h=void 0;if("in"===(a=d)||"not-in"===a||"in-fiscal-period-and-year"===a||"in-or-after-fiscal-period-and-year"===a||"in-or-before-fiscal-period-and-year"===a||"contain-values"===a||"not-contain-values"===a){if(h=[],c.childNodes)for(var m=0;m<c.childNodes.length;m++){var b=c.childNodes.item(m);if("string"!=typeof b&&"value"===b.nodeName){var y=b.firstChild?b.firstChild.nodeValue:null;if("string"==typeof y){var _=y.toString();h.push(_)}}}}else h=x(c,"value");var v={attributeName:u,conditionOperator:g,entityName:p,entityAliasName:f,value:h};o.push(v)}}}return{filters:i,filterOperator:r,conditions:o}}function D(e){if(!e)return null;switch(e){case"eq":return 0;case"ne":case"neq":return 1;case"ge":return 4;case"gt":return 2;case"le":return 5;case"lt":return 3;case"on":return 25;case"on-or-before":return 26;case"on-or-after":return 27;case"like":return 6;case"not-like":return 7;case"in":return 8;case"not-in":return 9;case"between":return 10;case"not-between":return 11;case"null":return 12;case"not-null":return 13;case"yesterday":return 14;case"today":return 15;case"tomorrow":return 16;case"last-seven-days":return 17;case"next-seven-days":return 18;case"last-week":return 19;case"this-week":return 20;case"next-week":return 21;case"last-month":return 22;case"this-month":return 23;case"next-month":return 24;case"last-year":return 28;case"this-year":return 29;case"next-year":return 30;case"last-x-hours":return 31;case"next-x-hours":return 32;case"last-x-days":return 33;case"next-x-days":return 34;case"last-x-weeks":return 35;case"next-x-weeks":return 36;case"last-x-months":return 37;case"next-x-months":return 38;case"last-x-years":return 39;case"next-x-years":return 40;case"this-fiscal-year":return 58;case"this-fiscal-period":return 59;case"next-fiscal-year":return 60;case"next-fiscal-period":return 61;case"last-fiscal-year":return 62;case"last-fiscal-period":return 63;case"last-x-fiscal-years":return 64;case"last-x-fiscal-periods":return 65;case"next-x-fiscal-years":return 66;case"next-x-fiscal-periods":return 67;case"in-fiscal-year":return 68;case"in-fiscal-period":return 69;case"in-fiscal-period-and-year":return 70;case"in-or-before-fiscal-period-and-year":return 71;case"in-or-after-fiscal-period-and-year":return 72;case"above":return 75;case"under":return 76;case"not-under":return 77;case"eq-or-above":return 78;case"eq-or-under":return 79;case"olderthan-x-months":return 53;case"olderthan-x-years":return 82;case"olderthan-x-weeks":return 83;case"olderthan-x-days":return 84;case"olderthan-x-hours":return 85;case"olderthan-x-minutes":return 86;case"contain-values":return 87;case"not-contain-values":return 88;case"begins-with":return 54;case"ends-with":return 56;case"not-begin-with":return 55;case"not-end-with":return 57;case"eq-businessid":return 43;case"ne-businessid":return 44;case"eq-userlanguage":return 51;case"eq-useroruserhierarchy":return 80;case"eq-useroruserhierarchyandteams":return 81;case"eq-userteams":return 73;case"eq-useroruserteams":return 74;case"eq-userid":return 41;case"ne-userid":return 42}return null}function x(e,t){if(!e)return null;var n=e.attributes.getNamedItem(t);return n?n.value:null}function M(e,t,n,r){return!!B(e,n,t,r)&&(e<n&&t>=r||e<=n&&t>r)}function F(e,t,n,r){return!!B(e,t,n,r)&&(r-n==1&&e<=t)}function k(e,t,n,r,a,i){return!!(e&&t&&e===t&&(n&&r&&n!==r||e>i||a>t))}function L(e,t,n,r){return!!B(e,t,n,r)&&(e-t==1&&n>=r)}function B(e,t,n,r){return!!(e&&t&&n&&r&&e>0&&t>0&&n>0&&r>0)}function U(e){if(e&&e.Properties&&e.Properties.DataSetDefinitions){var t=e.Properties.DataSetDefinitions;for(var n in t)if(e.Properties.DataSetDefinitions[n]&&e.Properties.DataSetDefinitions[n].Primary){for(var r=!1,a=0,i=e.Properties.Properties;a<i.length;a++){if(0===i[a].Usage){r=!0;break}}return!r}}return!1}function V(e){for(var t in e){var n=e[t];if(n&&n.DataProvider)return!0}return!1}function z(e){if(e&&e.Parameters)for(var t in e.Parameters)if(e.Parameters[t]&&e.Parameters[t].Type===o.a.QuickForm)return!0;return!1}function q(e){var t;for(var n in e.Parameters)if(e.Parameters[n]&&e.Parameters[n].Value){var r=e.Parameters[n].Value.split('"');if(r.length>1&&r[0].indexOf("entityname")>-1){t=r[1];break}}return t}function H(e){var t,n,r=function(e){if(e&&e.Parameters)for(var t in e.Parameters)if(e.Parameters[t]&&e.Parameters[t].Type===o.a.QuickForm&&e.Parameters[t].Primary)return t;return"value"}(e.configuration),a=e.dynamicData.parameters[r];if(a&&a.getLatestData){var i=a.getLatestData();t=i?i.entityName:W(e.configuration,1),n=i?i.recordId:function(e){return W(e,2)}(e.configuration)}return{recordId:n,entityTypeName:t}}function W(e,t){var n;if(e&&e.Parameters&&e.Parameters.value){var r=e.Parameters.value,a=r.Value?r.Value.split("|"):null;a&&a.length>t&&(n=a[t])}return n}},"2XFH":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("K7RF"),a=n("ZoNW"),i=n("/oKV"),o=n("iJGp");function s(e){return{type:"labels.retrieve.async",execute({dispatch:t,getState:n},s){if(e&&e.length){const s=Object(a.a)(n(),e);if(s&&s.length){return t(Object(r.b)("label",null,null,null,!1,o.a.OnDemandWithoutContext,null,null,s,null,i.a.Local)).catch(e=>{if(-2147093999===e.errorCode)return{};throw e})}}return Promise.resolve({})}}}},"2YQW":function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e){return function(e){return(t,n)=>{const r=void 0===t?{}:t,a={};let i=!1;const o=Object.keys(e);for(const t of o){const o=e[t],s=r[t],c=o(s,n);a[t]=c,i=i||c!==s}const s=i?a:r;return Object.freeze(s)}}(a(e))}function a(e){const t={},n=Object.keys(e);for(const r of n)t[r]=e[r];return t}function i(e,t,n){const r=Object.assign({},t);return Object.freeze(r),function(e,t,n){return(r=t,a)=>{if(-1===e.indexOf(a.type))return r;const i=n?n(a.payload):a.payload,o=i?Object.assign(Object.assign({},r),i):r;return Object.freeze(o)}}(e,r,n)}function o(e,t){return(n=Object.freeze({}),r)=>{const a=r.meta&&r.meta[e];if(a){const e=n[a],i=t(e,r);return i===e?n:Object.freeze(Object.assign(Object.assign({},n),{[a]:i}))}return n}}function s(e,t){const n=a(e);let r=t;return"object"==typeof t&&(r=Object.assign({},t),Object.freeze(r)),function(e,t){return(n=t,r)=>{const a=e[r.type];return a?Object.freeze(a(n,r)):n}}(n,r)}function c(e,t){if(null===e&&null===t||void 0===e&&void 0===t)return!0;if(!e&&t||e&&!t)return!1;const n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;const a=Object.prototype.hasOwnProperty;for(let r=0;r<n.length;r++)if("function"!=typeof e[n[r]]&&(!a.call(t,n[r])||e[n[r]]!==t[n[r]]))return!1;return!0}n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"d",(function(){return s})),n.d(t,"e",(function(){return c}))},"2bwe":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="recentItem.dropdownRecentsDescriptor.toggle";function a(e){return{type:r,payload:e||{isOpened:!1,entityTypeName:null,relativeToEntryId:null}}}},"2c85":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("SocB"),a=n("tJ+6"),i=n("unFF");let o;function s(e){if(!o){const t=Object(i.a)(e),n=Object(a.b)(e)?Object(a.a)(e):null,s=n?n.Components.AppHeader.Focus.BorderColor:t.colors.NavBar.NavBar3.Text,c=n?n.Components.AppHeader.BackgroundColor:t.colors.NavBar.NavBar1.Fill,l=n?n.Components.AppHeader.Hover.BackgroundColor:t.colors.NavBar.NavBar2.Fill,u=n?n.Components.AppHeader.TextColor:t.colors.NavBar.NavBar1.Text,d=Object(r.e)(l);o={backgroundColor:c,textColor:u,focusOutlineColor:s,buttonHover:{backgroundColor:l,color:d},buttonFocus:{backgroundColor:l,color:d,outline:"1px solid !important",outlineColor:s+" !important",outlineOffset:"-2px !important"},fontFamilies:t.fontFamilies,navbarHeight:t.sizes.NavbarHeight}}return o}},"2cSh":function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e.Low="Low",e.HighWithControls="HighWithControls",e.HighReadOnlyValues="HighReadOnlyValues"}(r||(r={}))},"2gMP":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * The unique name of the WelcomePageDialog page module.
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="WelcomePageDialog"},"2jAf":function(e,t,n){"use strict";n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return u})),n.d(t,"a",(function(){return s})),n.d(t,"e",(function(){return d})),n.d(t,"b",(function(){return c}));var r=n("eXjw"),a=n("iZ7K"),i=n("Wgxh"),o=n("ddoO");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const s="gc.metadata.remove",c="gc.metadata.update.refcount";function l(e){return{type:"garbage.collect.metadata.sync",sync:!0,execute({dispatch:t,getState:n},s){const c=n(),l={},p={},f={},g=Object(o.f)(c);for(const t in g){const n=g[t]&&g[t].slice(),o=Object(i.b)(n,e);if(o)if(0===o.length){const e=Object(a.h)(c,t);if(e){const n={Initialized:r.a.Uninitialized,EntityLogicalName:e.EntityLogicalName,IsActivity:e.IsActivity};l[t]=n,p[t]=null}}else f[t]=o}const h={},m={},b=Object(o.l)(c);for(const t in b){const n=b[t]&&b[t].slice(),r=Object(i.b)(n,e);r&&(0===r.length?h[t]=null:m[t]=r)}if((Object.keys(m).length>0||Object.keys(f).length>0)&&t(d(f,m)),Object.keys(h).length>0||Object.keys(l).length>0){t(u({ribbons:h,entities:l,attributes:p}))}}}}function u(e){return{type:s,payload:e}}function d(e,t){return{type:c,payload:{entities:e,ribbons:t}}}},"2mBq":function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return s}));var r=n("504W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a=new RegExp("[\n\r]+");function i(e){let t=0;for(let n=0;n<e.length;++n){t=(t<<5)-t+e.charCodeAt(n),t&=t}return t}function o(e,t,n,r,a,i,o){return void 0===t&&void 0===n&&void 0===r&&void 0===a&&void 0===i&&void 0===o?e:String.format(e,t,n,r,a,i,o)}function s(e,t){if(Object(r.b)(e))return"";let n="";const i=e.split(a);for(let e=0;e<i.length;e++)Object(r.b)(i[e])||(n+=`${i[e]}${t}`);return n}},"2qKp":function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return d})),n.d(t,"c",(function(){return p}));var r=n("pulT"),a=n("jhff"),i=n("FoFY"),o=n("QGYZ"),s=n("31Vn"),c=n("oT5e");function l(e,t,n){const s=e.getState(),c=t.slice();return function(e,t,n){t.push({name:"focusedSessionId",value:Object(r.c)(e)}),t.push({name:"focusedTabId",value:Object(a.b)(e)}),n&&t.push({name:"focusedTabIdInSession",value:Object(a.c)(e,n)})}(s,c,n),function(e,t,n){t.push({name:"totalSessions",value:Object(i.d)(e)}),t.push({name:"totalTabs",value:Object(o.e)(e)}),n&&t.push({name:"totalTabsInSession",value:Object(o.f)(e,n)})}(s,c,n),c}function u(e,t,n){const r=e.getState(),a=t.slice();return function(e,t,n){const r=Object(c.a)(e,n).history,a=r.length&&r[r.length-1];t.push({name:"historyLength",value:r.length}),a&&t.push({name:"currentHistoryState",value:JSON.stringify(a.state)}),a&&t.push({name:"currentHistoryUrl",value:a&&Object(s.a)(a.url)})}(r,a,n),function(e,t,n){if(0===Object(c.a)(e,n).type){const r=Object(i.b)(e,n);t.push({name:"sessionId",value:r.id})}}(r,a,n),a}function d(e,t){return{getInitialParameters:n=>u(n,t,e),getFailureParameters:(n,r,a,i)=>u(a,t,e),getSuccessParameters:(n,r,a)=>u(r,t,e)}}function p(e){if(!e)return e;const t=e.lastIndexOf(".");if(t<0)return e.replace(/./g,"*");const n=e.substring(0,t),r=e.substring(t+1);return n.replace(/./g,"*")+"."+r}},"2v4m":function(e,t){
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */},"2yvP":function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}));var r=n("IaGr");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a=[];function i(e,t){"string"==typeof e&&(e={sourceName:e}),a.push(e);const n=t(),i="ClientApi.ClientApiSourceAttribution.setClientApiAttributionSource",s=[{name:"source",value:e.sourceName}];if(0===a.length)r.a.getInstance().eventManager.ReportComponentFailure(i,new Error("Client API Source stack was unexpectedly empty."),null,s);else{const t=o();t===e?a.pop():(s.push({name:"topSource",value:t.sourceName}),r.a.getInstance().eventManager.ReportComponentFailure(i,new Error("Client API Source stack top item value was unexpected and not removed."),null,s))}return n}function o(){return 0===a.length?{sourceName:"unknown"}:a[a.length-1]}},"3/02":function(e,t,n){"use strict";n.d(t,"Ug",(function(){return r})),n.d(t,"Cg",(function(){return a})),n.d(t,"Nh",(function(){return i})),n.d(t,"E",(function(){return o})),n.d(t,"hh",(function(){return s})),n.d(t,"F",(function(){return c})),n.d(t,"j",(function(){return l})),n.d(t,"O",(function(){return u})),n.d(t,"Sf",(function(){return d})),n.d(t,"Rf",(function(){return p})),n.d(t,"Gd",(function(){return f})),n.d(t,"Dd",(function(){return g})),n.d(t,"Fd",(function(){return h})),n.d(t,"Bd",(function(){return m})),n.d(t,"Ed",(function(){return b})),n.d(t,"Cd",(function(){return y})),n.d(t,"Xd",(function(){return _})),n.d(t,"pb",(function(){return v})),n.d(t,"Rb",(function(){return S})),n.d(t,"I",(function(){return O})),n.d(t,"lb",(function(){return C})),n.d(t,"tb",(function(){return E})),n.d(t,"ff",(function(){return I})),n.d(t,"Eg",(function(){return w})),n.d(t,"Gg",(function(){return j})),n.d(t,"ud",(function(){return P})),n.d(t,"yh",(function(){return T})),n.d(t,"xh",(function(){return N})),n.d(t,"lg",(function(){return A})),n.d(t,"Fg",(function(){return R})),n.d(t,"kg",(function(){return D})),n.d(t,"Z",(function(){return x})),n.d(t,"Hg",(function(){return M})),n.d(t,"og",(function(){return F})),n.d(t,"ng",(function(){return k})),n.d(t,"mg",(function(){return L})),n.d(t,"ie",(function(){return B})),n.d(t,"ge",(function(){return U})),n.d(t,"ce",(function(){return V})),n.d(t,"Ah",(function(){return z})),n.d(t,"R",(function(){return q})),n.d(t,"td",(function(){return H})),n.d(t,"sd",(function(){return W})),n.d(t,"hg",(function(){return G})),n.d(t,"af",(function(){return K})),n.d(t,"P",(function(){return Q})),n.d(t,"Ad",(function(){return X})),n.d(t,"d",(function(){return Y})),n.d(t,"hc",(function(){return J})),n.d(t,"Uh",(function(){return $})),n.d(t,"zg",(function(){return Z})),n.d(t,"Vg",(function(){return ee})),n.d(t,"K",(function(){return te})),n.d(t,"Hh",(function(){return ne})),n.d(t,"Wb",(function(){return re})),n.d(t,"pg",(function(){return ae})),n.d(t,"mc",(function(){return ie})),n.d(t,"Vb",(function(){return oe})),n.d(t,"Ob",(function(){return se})),n.d(t,"t",(function(){return ce})),n.d(t,"xc",(function(){return le})),n.d(t,"D",(function(){return ue})),n.d(t,"Dg",(function(){return de})),n.d(t,"ph",(function(){return pe})),n.d(t,"qh",(function(){return fe})),n.d(t,"Vd",(function(){return ge})),n.d(t,"ab",(function(){return he})),n.d(t,"fg",(function(){return me})),n.d(t,"ch",(function(){return be})),n.d(t,"mh",(function(){return ye})),n.d(t,"Yc",(function(){return _e})),n.d(t,"uh",(function(){return ve})),n.d(t,"hd",(function(){return Se})),n.d(t,"Xc",(function(){return Oe})),n.d(t,"kd",(function(){return Ce})),n.d(t,"ad",(function(){return Ee})),n.d(t,"be",(function(){return Ie})),n.d(t,"gc",(function(){return we})),n.d(t,"Sd",(function(){return je})),n.d(t,"Jg",(function(){return Pe})),n.d(t,"Kg",(function(){return Te})),n.d(t,"ue",(function(){return Ne})),n.d(t,"cf",(function(){return Ae})),n.d(t,"wg",(function(){return Re})),n.d(t,"Tc",(function(){return De})),n.d(t,"eb",(function(){return xe})),n.d(t,"Wc",(function(){return Me})),n.d(t,"tc",(function(){return Fe})),n.d(t,"hb",(function(){return ke})),n.d(t,"Qb",(function(){return Le})),n.d(t,"tf",(function(){return Be})),n.d(t,"dd",(function(){return Ue})),n.d(t,"cd",(function(){return Ve})),n.d(t,"v",(function(){return ze})),n.d(t,"Pd",(function(){return qe})),n.d(t,"Sc",(function(){return He})),n.d(t,"Od",(function(){return We})),n.d(t,"Qd",(function(){return Ge})),n.d(t,"Ph",(function(){return Ke})),n.d(t,"nc",(function(){return Qe})),n.d(t,"Qc",(function(){return Xe})),n.d(t,"lc",(function(){return Ye})),n.d(t,"xd",(function(){return Je})),n.d(t,"Zg",(function(){return $e})),n.d(t,"ig",(function(){return Ze})),n.d(t,"Oh",(function(){return et})),n.d(t,"Vc",(function(){return tt})),n.d(t,"Of",(function(){return nt})),n.d(t,"We",(function(){return rt})),n.d(t,"de",(function(){return at})),n.d(t,"Td",(function(){return it})),n.d(t,"jf",(function(){return ot})),n.d(t,"wf",(function(){return st})),n.d(t,"te",(function(){return ct})),n.d(t,"Db",(function(){return lt})),n.d(t,"jd",(function(){return ut})),n.d(t,"fh",(function(){return dt})),n.d(t,"gh",(function(){return pt})),n.d(t,"Rh",(function(){return ft})),n.d(t,"r",(function(){return gt})),n.d(t,"q",(function(){return ht})),n.d(t,"Dh",(function(){return mt})),n.d(t,"Fb",(function(){return bt})),n.d(t,"Mc",(function(){return yt})),n.d(t,"C",(function(){return _t})),n.d(t,"Xb",(function(){return vt})),n.d(t,"Ib",(function(){return St})),n.d(t,"b",(function(){return Ot})),n.d(t,"nh",(function(){return Ct})),n.d(t,"rb",(function(){return Et})),n.d(t,"qb",(function(){return It})),n.d(t,"eh",(function(){return wt})),n.d(t,"N",(function(){return jt})),n.d(t,"fd",(function(){return Pt})),n.d(t,"Rd",(function(){return Tt})),n.d(t,"Mh",(function(){return Nt})),n.d(t,"Ae",(function(){return At})),n.d(t,"Pe",(function(){return Rt})),n.d(t,"wd",(function(){return Dt})),n.d(t,"Xg",(function(){return xt})),n.d(t,"e",(function(){return Mt})),n.d(t,"bf",(function(){return Ft})),n.d(t,"X",(function(){return kt})),n.d(t,"bh",(function(){return Lt})),n.d(t,"De",(function(){return Bt})),n.d(t,"of",(function(){return Ut})),n.d(t,"yg",(function(){return Vt})),n.d(t,"xg",(function(){return zt})),n.d(t,"z",(function(){return qt})),n.d(t,"df",(function(){return Ht})),n.d(t,"H",(function(){return Wt})),n.d(t,"M",(function(){return Gt})),n.d(t,"G",(function(){return Kt})),n.d(t,"Q",(function(){return Qt})),n.d(t,"J",(function(){return Xt})),n.d(t,"ih",(function(){return Yt})),n.d(t,"ze",(function(){return Jt})),n.d(t,"S",(function(){return $t})),n.d(t,"oh",(function(){return Zt})),n.d(t,"Yg",(function(){return en})),n.d(t,"ah",(function(){return tn})),n.d(t,"ae",(function(){return nn})),n.d(t,"Uc",(function(){return rn})),n.d(t,"L",(function(){return an})),n.d(t,"Be",(function(){return on})),n.d(t,"vg",(function(){return sn})),n.d(t,"sg",(function(){return cn})),n.d(t,"ug",(function(){return ln})),n.d(t,"tg",(function(){return un})),n.d(t,"rg",(function(){return dn})),n.d(t,"w",(function(){return pn})),n.d(t,"Ec",(function(){return fn})),n.d(t,"Ke",(function(){return gn})),n.d(t,"Le",(function(){return hn})),n.d(t,"Me",(function(){return mn})),n.d(t,"y",(function(){return bn})),n.d(t,"sc",(function(){return yn})),n.d(t,"He",(function(){return _n})),n.d(t,"Ce",(function(){return vn})),n.d(t,"sh",(function(){return Sn})),n.d(t,"Jf",(function(){return On})),n.d(t,"Mf",(function(){return Cn})),n.d(t,"Ee",(function(){return En})),n.d(t,"Gh",(function(){return In})),n.d(t,"dg",(function(){return wn})),n.d(t,"gf",(function(){return jn})),n.d(t,"Lf",(function(){return Pn})),n.d(t,"yc",(function(){return Tn})),n.d(t,"Kf",(function(){return Nn})),n.d(t,"ub",(function(){return An})),n.d(t,"dh",(function(){return Rn})),n.d(t,"Jc",(function(){return Dn})),n.d(t,"Kc",(function(){return xn})),n.d(t,"Gc",(function(){return Mn})),n.d(t,"Ng",(function(){return Fn})),n.d(t,"mb",(function(){return kn})),n.d(t,"Ig",(function(){return Ln})),n.d(t,"Md",(function(){return Bn})),n.d(t,"Vh",(function(){return Un})),n.d(t,"Pg",(function(){return Vn})),n.d(t,"Dc",(function(){return zn})),n.d(t,"bc",(function(){return qn})),n.d(t,"qc",(function(){return Hn})),n.d(t,"pc",(function(){return Wn})),n.d(t,"Af",(function(){return Gn})),n.d(t,"f",(function(){return Kn})),n.d(t,"ag",(function(){return Qn})),n.d(t,"id",(function(){return Xn})),n.d(t,"le",(function(){return Yn})),n.d(t,"Lc",(function(){return Jn})),n.d(t,"Yd",(function(){return $n})),n.d(t,"cb",(function(){return Zn})),n.d(t,"db",(function(){return er})),n.d(t,"bb",(function(){return tr})),n.d(t,"re",(function(){return nr})),n.d(t,"oe",(function(){return rr})),n.d(t,"pe",(function(){return ar})),n.d(t,"jb",(function(){return ir})),n.d(t,"Kd",(function(){return or})),n.d(t,"mf",(function(){return sr})),n.d(t,"Wd",(function(){return cr})),n.d(t,"Cc",(function(){return lr})),n.d(t,"je",(function(){return ur})),n.d(t,"Oe",(function(){return dr})),n.d(t,"yd",(function(){return pr})),n.d(t,"Ne",(function(){return fr})),n.d(t,"Ge",(function(){return gr})),n.d(t,"vd",(function(){return hr})),n.d(t,"cg",(function(){return mr})),n.d(t,"nf",(function(){return br})),n.d(t,"o",(function(){return yr})),n.d(t,"m",(function(){return _r})),n.d(t,"n",(function(){return vr})),n.d(t,"ee",(function(){return Sr})),n.d(t,"he",(function(){return Or})),n.d(t,"Ih",(function(){return Cr})),n.d(t,"zd",(function(){return Er})),n.d(t,"Nc",(function(){return Ir})),n.d(t,"fb",(function(){return wr})),n.d(t,"uf",(function(){return jr})),n.d(t,"Hc",(function(){return Pr})),n.d(t,"Ic",(function(){return Tr})),n.d(t,"rc",(function(){return Nr})),n.d(t,"Bh",(function(){return Ar})),n.d(t,"Ch",(function(){return Rr})),n.d(t,"ke",(function(){return Dr})),n.d(t,"Oc",(function(){return xr})),n.d(t,"Pc",(function(){return Mr})),n.d(t,"Ze",(function(){return Fr})),n.d(t,"we",(function(){return kr})),n.d(t,"Sg",(function(){return Lr})),n.d(t,"Qf",(function(){return Br})),n.d(t,"s",(function(){return Ur})),n.d(t,"Zd",(function(){return Vr})),n.d(t,"eg",(function(){return zr})),n.d(t,"zh",(function(){return qr})),n.d(t,"Eb",(function(){return Hr})),n.d(t,"Hb",(function(){return Wr})),n.d(t,"Gb",(function(){return Gr})),n.d(t,"lh",(function(){return Kr})),n.d(t,"Rg",(function(){return Qr})),n.d(t,"l",(function(){return Xr})),n.d(t,"Tf",(function(){return Yr})),n.d(t,"gg",(function(){return Jr})),n.d(t,"ib",(function(){return $r})),n.d(t,"Fh",(function(){return Zr})),n.d(t,"Bf",(function(){return ea})),n.d(t,"Uf",(function(){return ta})),n.d(t,"kb",(function(){return na})),n.d(t,"Df",(function(){return ra})),n.d(t,"Ab",(function(){return aa})),n.d(t,"A",(function(){return ia})),n.d(t,"Lg",(function(){return oa})),n.d(t,"vb",(function(){return sa})),n.d(t,"Zf",(function(){return ca})),n.d(t,"kf",(function(){return la})),n.d(t,"Cf",(function(){return ua})),n.d(t,"Ef",(function(){return da})),n.d(t,"Ff",(function(){return pa})),n.d(t,"Gf",(function(){return fa})),n.d(t,"Hf",(function(){return ga})),n.d(t,"If",(function(){return ha})),n.d(t,"Bc",(function(){return ma})),n.d(t,"nb",(function(){return ba})),n.d(t,"Nb",(function(){return ya})),n.d(t,"Lb",(function(){return _a})),n.d(t,"Kb",(function(){return va})),n.d(t,"Jb",(function(){return Sa})),n.d(t,"Mb",(function(){return Oa})),n.d(t,"h",(function(){return Ca})),n.d(t,"Y",(function(){return Ea})),n.d(t,"Ie",(function(){return Ia})),n.d(t,"Fc",(function(){return wa})),n.d(t,"if",(function(){return ja})),n.d(t,"Th",(function(){return Pa})),n.d(t,"dc",(function(){return Ta})),n.d(t,"jc",(function(){return Na})),n.d(t,"ic",(function(){return Aa})),n.d(t,"gd",(function(){return Ra})),n.d(t,"Ud",(function(){return Da})),n.d(t,"bd",(function(){return xa})),n.d(t,"Jd",(function(){return Ma})),n.d(t,"Id",(function(){return Fa})),n.d(t,"Hd",(function(){return ka})),n.d(t,"Ve",(function(){return La})),n.d(t,"xe",(function(){return Ba})),n.d(t,"cc",(function(){return Ua})),n.d(t,"qg",(function(){return Va})),n.d(t,"hf",(function(){return za})),n.d(t,"rf",(function(){return qa})),n.d(t,"qf",(function(){return Ha})),n.d(t,"Qh",(function(){return Wa})),n.d(t,"i",(function(){return Ga})),n.d(t,"Rc",(function(){return Ka})),n.d(t,"Je",(function(){return Qa})),n.d(t,"ed",(function(){return Xa})),n.d(t,"x",(function(){return Ya})),n.d(t,"vf",(function(){return Ja})),n.d(t,"ye",(function(){return $a})),n.d(t,"ve",(function(){return Za})),n.d(t,"Pb",(function(){return ei})),n.d(t,"ef",(function(){return ti})),n.d(t,"Sh",(function(){return ni})),n.d(t,"ld",(function(){return ri})),n.d(t,"W",(function(){return ai})),n.d(t,"Zc",(function(){return ii})),n.d(t,"xf",(function(){return oi})),n.d(t,"yf",(function(){return si})),n.d(t,"zf",(function(){return ci})),n.d(t,"T",(function(){return li})),n.d(t,"V",(function(){return ui})),n.d(t,"wh",(function(){return di})),n.d(t,"vh",(function(){return pi})),n.d(t,"B",(function(){return fi})),n.d(t,"jg",(function(){return gi})),n.d(t,"Mg",(function(){return hi})),n.d(t,"me",(function(){return mi})),n.d(t,"ac",(function(){return bi})),n.d(t,"Ac",(function(){return yi})),n.d(t,"zc",(function(){return _i})),n.d(t,"vc",(function(){return vi})),n.d(t,"Ye",(function(){return Si})),n.d(t,"Zb",(function(){return Oi})),n.d(t,"th",(function(){return Ci})),n.d(t,"oc",(function(){return Ei})),n.d(t,"Eh",(function(){return Ii})),n.d(t,"a",(function(){return wi})),n.d(t,"Ld",(function(){return ji})),n.d(t,"Bg",(function(){return Pi})),n.d(t,"Pf",(function(){return Ti})),n.d(t,"ne",(function(){return Ni})),n.d(t,"kh",(function(){return Ai})),n.d(t,"Ag",(function(){return Ri})),n.d(t,"wb",(function(){return Di})),n.d(t,"Tg",(function(){return xi})),n.d(t,"Bb",(function(){return Mi})),n.d(t,"Cb",(function(){return Fi})),n.d(t,"Wh",(function(){return ki})),n.d(t,"Nd",(function(){return Li})),n.d(t,"Sb",(function(){return Bi})),n.d(t,"Wg",(function(){return Ui})),n.d(t,"kc",(function(){return Vi})),n.d(t,"Tb",(function(){return zi})),n.d(t,"Ub",(function(){return qi})),n.d(t,"xb",(function(){return Hi})),n.d(t,"k",(function(){return Wi})),n.d(t,"Nf",(function(){return Gi})),n.d(t,"p",(function(){return Ki})),n.d(t,"lf",(function(){return Qi})),n.d(t,"u",(function(){return Xi})),n.d(t,"sf",(function(){return Yi})),n.d(t,"fc",(function(){return Ji})),n.d(t,"Fe",(function(){return $i})),n.d(t,"Wf",(function(){return Zi})),n.d(t,"Xf",(function(){return eo})),n.d(t,"Vf",(function(){return to})),n.d(t,"Se",(function(){return no})),n.d(t,"Qe",(function(){return ro})),n.d(t,"Re",(function(){return ao})),n.d(t,"Yf",(function(){return io})),n.d(t,"ob",(function(){return oo})),n.d(t,"wc",(function(){return so})),n.d(t,"Og",(function(){return co})),n.d(t,"bg",(function(){return lo})),n.d(t,"Ue",(function(){return uo})),n.d(t,"gb",(function(){return po})),n.d(t,"Yb",(function(){return fo})),n.d(t,"Jh",(function(){return go})),n.d(t,"Lh",(function(){return ho})),n.d(t,"Kh",(function(){return mo})),n.d(t,"pf",(function(){return bo})),n.d(t,"qe",(function(){return yo})),n.d(t,"se",(function(){return _o})),n.d(t,"Qg",(function(){return vo})),n.d(t,"zb",(function(){return So})),n.d(t,"md",(function(){return Oo})),n.d(t,"nd",(function(){return Co})),n.d(t,"od",(function(){return Eo})),n.d(t,"pd",(function(){return Io})),n.d(t,"qd",(function(){return wo})),n.d(t,"rd",(function(){return jo})),n.d(t,"ec",(function(){return Po})),n.d(t,"U",(function(){return To})),n.d(t,"Te",(function(){return No})),n.d(t,"fe",(function(){return Ao})),n.d(t,"sb",(function(){return Ro})),n.d(t,"yb",(function(){return Do})),n.d(t,"jh",(function(){return xo})),n.d(t,"c",(function(){return Mo})),n.d(t,"uc",(function(){return Fo})),n.d(t,"g",(function(){return ko})),n.d(t,"rh",(function(){return Lo})),n.d(t,"Xe",(function(){return Bo}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="SocialInsightsMapping",a="SaveEditableGridPreNav",i="UseFabricDateTime",o="Client.CSHSaveFilterUCI",s="Client.SupportCreatePersonalView",c="Client.Search.Categorized.Barcode",l="AllowLegacyDialogsInUci",u="Client.Chart.ChartOnForm",d="Client.PowerBI.PowerBIOnForm",p="PowerBIDialog",f="HybridDialog.Share",g="HybridDialog.BulkEdit",h="HybridDialog.Merge",m="HybridDialog.AdvancedFind",b="HybridDialog.ListQueryBuild",y="HybridDialog.AppointmentRecurrence",_="LetterAndFaxVisibleOnTLW",v="DependentOptionSetSgFCB",S="EnableBPFApprovalFlows",O="Client.Chart.DrillDown",C="DashboardCustomizableRibbon",E="DisableEditableGridControlOnPhone",I="NewSearchExperience",w="SearchFuzzyMatching",j="SearchMovedTeachingBubble",P="HideCategorizedSearch",T="UCIRelevanceSearchPublicAPI",N="UCIRelevanceSearchLocalization",A="RelevanceSearchBizQASecondSuggestionField",R="SearchImprovementApril2021",D="RelevanceSearchAsDefault",x="CommandContextTypeRule",M="SearchSuggestType",F="RelevanceSearchSpecialHandlingNoteEntity",k="RelevanceSearchResultsGridTooltip",L="RelevanceSearchGridHighlighting",B="LookupService",U="LookupQuickFind",V="LoadHigherJQueryVersion",z="UCKMControlRelevanceSearch",q="Client.Chart.ChartViewSelector",H="HideBrandName",W="HideAppSwitcher",G="ReadOnlyGridColumnFiltering",K="NavigateToGridFromSubgrid",Q="Client.Chart.ChartOnQuickViewForm",X="HybridDashboardActions",Y="AddUserForAccessTeam",J="EnableLookupMRU",$="WijmoSizeCache",Z="RunReportsInUci",ee="SortingByRelatedEntityColumn",te="Client.Chart.GridCommandBar",ne="UnsetDefaultDashboard",re="Client.EnableCanvasAppEmbedding",ae="Client.RenderCanvasAppInline",ie="EnableCustomPageSW",oe="EnableBlockingAuthForAuthFlow",se="Client.EnableAppToHostCommunication",ce="AuditHistory",le="FontMeasureWholeNumbersV1",ue="BrowserOfflineEnabledForTest",de="SaveFilterToPersonalView",pe="TimelineWallEmailThread",fe="TimelineWallUxImprovements",ge="LearningPath",he="ConnectionRoleUCI",me="QuickSearchForSubGrid",be="SubgridQuickFindWC",ye="TextBoxControlExpandButton",_e="GridPaginationState",ve="UCIGridDensity",Se="GridSubjectColumn",Oe="GridOverrideOpenRecord",Ce="GridVirtualization",Ee="GridProgressIndicator",Ie="LivePersonaCardAdalVerboseLogging",we="EnableLivePersonaCardPCFAuthFlow",je="JumpBarShouldHonorSorting",Pe="UciServiceWorker",Te="UciServiceWorkerGcm",Ne="MicrosoftGraphApi",Ae="UciNavigationBasedNotificationPolling",Re="RetrieveChartByStorageKey",De="GridHierarchyIcon",xe="ContextMenuLookup",Me="GridNotificationOnServerError",Fe="ExtendedOfflineClientApiSupport",ke="CustomOfflineCommands",Le="EnableAuthFlow",Be="OpenFormErrorsOnInvalidFormParameters",Ue="GridRollupForAllEntities",Ve="GridRollupForAllEntitiesApril2020",ze="AutomaticReconnect",qe="IsGetClientMetadataExEnabled",He="GridDuplicateDetection",We="FileType",Ge="MultipleImages",Ke="UseReactNativeOfflineStatusPage",Qe="EnableStandaloneConsentService",Xe="GridColumnEditor",Ye="EnableQueryPage",Je="HideLegacyAdvancedFindInGlobalCommandBar",$e="SubGridDataLoadFormContext",Ze="RecordSetNavigatorOnQueueItem",et="UseLegacyFunctionForWeekNumbering",tt="GridNewFilter",nt="ShowPersonalViewFirst",rt="MultiSelectOptionQuickFind",at="LookupAutoselectFirstResult",it="KMSearchUIEnhancements",ot="October2020Update",st="OverrideRecordSetNavigatorOnQueueItem",ct="MemoFieldOnEditableGrid",lt="EditableGridLookupRecordCountConfig",ut="GridTheming",dt="SuiterDashboard",pt="SuiterStream",ft="UseVerticalMoreIcon",gt="AssociatedGridHeight",ht="AssociatedGridApril2020Update",mt="UnresolvedEmailAddressFeature",bt="EmailAddressUsedUpdateFeature",yt="GlobalBarNotification",_t="BpfFlowStepUIRefresh",vt="EnableConnectorAuthPopup",St="EnableAdvancedGridFiltering",Ot="ActivityMgmtApril2020Update",Ct="ThemeOct2020Update",Et="DesignLanguageTheme",It="DesignLanguageTeamsTheme",wt="SuiterChart",jt="ChartOnAssociatedGrid",Pt="GridSearchCanUseCurrentView",Tt="IsPowerBIEnabledIsJustForUserDashboards",Nt="UseDefaultPowerBIBackground",At="ModernDataLayer",Rt="ModernDataLayerUpsync",Dt="HideJumpbarMobile",xt="UseOfflineSqlTokens",Mt="AdvancedFilterNonEnglishSupport",Ft="NavigateToOpenInNewTabSupport",kt="CollapseHeaderOnScrollGridRootMobile",Lt="SubgridImprovements",Bt="ModernDataLayerDev",Ut="OfflineFileImage",Vt="RetryConnectivityFailuresOnce",zt="RetryConnectivityFailuresInfinitely",qt="BlockUIForServerConnectivity",Ht="NavigationManagerNetworkDispatcher",Wt="ChartCustomizationParity",Gt="ChartOct2020Update",Kt="ChartApr2021Update",Qt="ChartPlugin",Xt="ChartFormIconCommandBar",Yt="SwitchGridChartSide",Jt="ModernAdvancedFind",$t="ClickPhoneCallToOpenQuickCreate",Zt="TimeControlValidateOnKeypress",en="SubGridAutoCollapseOctober2020Update",tn="SubGridRemoveMinHeightOctober2020Update",nn="ListSelectAllOctober2020Update",rn="GridListViewSortOption",an="ChartNavigateToAssociatedGrid",on="ModernDataLayerCUD",sn="RestoreUciState",cn="RestoreDialogState",ln="RestorePageMetadata",un="RestorePageData",dn="RestoreDataFromDisk",pn="AzureFootprint",fn="FormFocusAndScrollState",gn="ModernDataLayerRMPhase1",hn="ModernDataLayerRMPhase2",mn="ModernDataLayerRMPhase3",bn="BatchRequestForLongFetchXml",yn="ExpressionBuilderForcePrimaryAttribute",_n="ModernDataLayerGCM",vn="ModernDataLayerClientApi",Sn="TrustedUCI",On="PcfGridColumnFilterValues",Cn="PcfGridRecordLinkAnchor",En="ModernDataLayerEM",In="UnmountPageForBackNavigation",wn="QuickFindImprovementsOnGridRootForMobile",jn="NoRibbonClientMetadataForUncustomizedEntities",Pn="PcfGridHierarchy",Tn="ForceDynamicsBrandingForConnectedStore",Nn="PcfGridEnsureSetRows",An="DisableLoadDependenciesOnMissingViewId",Rn="SubgridRefreshInactiveTabs",Dn="GCMOptimizationBySeparation",xn="GCMOptimizationBySeparationForBatchProcessing",Mn="FormGCMOptimizationBySeparation",Fn="ShowAsButtonFirst",kn="DashboardGCMOptimizationBySeparation",Ln="GCMSeparateExtendedUserContext",Bn="GCMIncludeExtendedUserContext",Un="WrapExplicitlyDefinedControls",Vn="ShowOfflineFileDownloadStatus",zn="ForceSyncOfflineData",qn="EnableEmailEditInMoca",Hn="EnforceUCIReportToAdmin",Wn="EnforceUCIDeeplink",Gn="PCF.PreventUnnecessaryRenders",Kn="AdvancedFindGlobalizedFormattingSupport",Qn="QueueFilterPerfImprovementUCI",Xn="GridSynchronousFilterClearing",Yn="MFDForLookupDialog",Jn="GarbageCollectDialogPages",$n="LimitNotchPaddingToUciDialogs",Zn="ConsumeMdlModel",er="ConsumeMdlModelGcm",tr="ConsumeMdlFromCustomPage",nr="MdlResponseCache",rr="MdlBootWithCachedValue",ar="MdlCheckServerHealth",ir="CustomPageOffline",or="ImmediateOfflineDataSync",sr="OfflineByDefault",cr="LegacyEditableSubGridWarningOnUpdate",lr="ForceRteColumnFormatOnHtmlContent",ur="MDLBrowserOfflineEnabledForTest",dr="ModernDataLayerSingletonExecutor",pr="HideUCISearch",fr="ModernDataLayerRetrieve",gr="ModernDataLayerFunctionsAndActions",hr="HideGridItemEntityImage",mr="QueueItemUCINavigation",br="OfflineDownloadingStatusUpdate",yr="April2021Update",_r="April2021AppShellA11y",vr="April2021EarlyAccessAppShellA11y",Sr="LookupCharacterCountBeforeResolveSettable",Or="LookupResolveDelaySettable",Cr="UpdateStatusOption",Er="HighDensityPageHeader",Ir="GlobalNavEventArgsPageInput",wr="ConvertPageInputPageTypeAdditions",jr="OpenUrlInNewWindowSupport",Pr="GCMOptimizationByEntityMetadataReduction",Tr="GCMOptimizationByEntityMetadataReduction2",Nr="EscapeSearchValues",Ar="UciControlsSwitch1",Rr="UciControlsSwitch2",Dr="MDLUseStateOverMetadataCache",xr="GlobalSearchMobileExperience",Mr="GlobalSearchMobileExperienceWithSearchAndFilter",Fr="NativeMobileItemLevelCommandDrawer",kr="MobileListHeader",Lr="SkipEvaluationOfDeviceSpecificRibbonRules",Br="PostSaveEventHandler",Ur="AsyncOnSaveHandler",Vr="ListItemSwipeActions",zr="QuickFindPageSizeAsUserPageSize",qr="UCISessionStateRetrievalBundling",Hr="EditableSubGridLegacyInPageUpdate",Wr="EnableAccessChecker",Gr="EmailBodyRTEControlApril2021Update",Kr="TemplateBodyRTEControlApril2021Update",Qr="SignatureBodyRTEControlApril2021Update",Xr="AppHostClientWithoutRootAppId",Yr="PreLoadAppHostClient",Jr="ReactInstancePageCaching",$r="CustomPageCaching",Zr="UnmountCustomPages",ea="PageAlwaysRender",ta="EnablePrebuiltContainers",na="CustomPagePreconnectLinks",ra="PartialInitAppHostClient",aa="EarlyInitAppHostClient",ia="BootAppHostClientLoadSequentially",oa="SetReplaceStateOnMultiSessionDefaultNavigation",sa="DisableRefreshWhileEditing",ca="PullToRefreshGrid",la="October2021Update",ua="PaneCompatibilityMode",da="PcfDatasetGrid",pa="PcfDatasetGridMainGridOnly",fa="PcfDatasetGridShowJumpBar",ga="PcfDatasetGridSlowDeployment",ha="PcfDatasetList",ma="ForceNewWindowToSingleSession",ba="DateTimeControlDaylightSavings",ya="EnableAppActions",_a="EnableAppActionFeature",va="EnableAppActionFXFeature",Sa="EnableAppActionClassicVisibleRules",Oa="EnableAppActionSplitFlyout",Ca="AllowEntityAndGlobalScopedAppActions",Ea="CombineOrgAttributeDependencyCallsFromRibbon",Ia="ModernDataLayerMailApp",wa="FormGCMCacheResponse",ja="ODataGCMResponseCache",Pa="WCAG21Oct2021Update",Ta="EnableGraphInformationInAppModuleOfflineGCMCall",Na="EnablePowerToursInUCI",Aa="EnableMobilePowerToursInUCI",Ra="GridSkipRecordRenders",Da="LandmarkRegionKeyboardShortcut",xa="GridReduceRenders",Ma="IESupportEndWarning",Fa="IEBlockPending",ka="IEBlock",La="ModernSitemapEnabled",Ba="MobileModernSitemapEnabled",Ua="EnableFSMobileAppUpdateNotification",Va="RerenderDataSetOnSelectionChange",za="NonOutLine",qa="OldBrowserWarning",Ha="OldBrowserSkipNSAT",Wa="UseReplaceStateForBootNavigation",Ga="AllowHardReloadOnNavigate",Ka="GridDelayDatasetUpdates",Qa="ModernDataLayerMatchServerGCM",Xa="GridSaveOnBlur",Ya="BarcodeScanNativeRelevanceSearch",Ja="OptimizeMDLDataCallsForExpressions",$a="MobileOffline.EnableRoleBasedProfileAccess",Za="MobileClientMetadataExecuteBatchV2",ei="EnableAppointmentDescriptionRTEControl",ti="NewActivityRibbonButton",ni="UserRatings",ri="HTML5InputOnMobileClient",ai="CollaborationShare",ii="GridPersonaControl",oi="PAOneGrid",si="PAOneGridEnableListView",ci="PAOneGridMainGridOnly",li="CollaborationCoPresenceFacepile",ui="CollaborationOwnerHeader",di="UCIMaxSessionTimeout",pi="UCIInactivityTimeout",fi="BpfActionSupportActionQuerying",gi="ReferencePanelControl",hi="SharePointS2S",mi="MSTeamsIntegration",bi="EnableEmailDescriptionRTEControl",yi="ForceEnableEmailDescriptionRTEControl",_i="ForceEnableAppointmentDescriptionRTEControl",vi="Feedback",Si="NPSSurvey",Oi="EnableDataSyncService",Ci="UCIEnableApplicationMetadataDownloadInShim",Ei="EnableUCIOfflineSyncAdaptivePaging",Ii="UnifiedClientCacheModeEnabled",wi="ActionCard",ji="ImmersiveSkype",Pi="SalesSettingsOnUCI",Ti="Playbook",Ni="ManualForecast",Ai="TeamsDialerSettings",Ri="SalesPartnerApps",Di="DisableSkypeForBusinessPresence",xi="SkypeForBusiness",Mi="EditableGridControlJsEvents",Fi="EditableGridControlPbl",ki="YammerPostsOnUCI",Li="IncrementalSyncSelectors",Bi="EnableBPFNonDefaultCustomControls",Ui="SplitBPFEntityAndParticipatingEntityCreates",Vi="EnableProcessManagerPerPage",zi="EnableBPFOffline",qi="EnableBPFPhase3",Hi="DisableUserFormXmlLabelTransform",Wi="AllowSwitchDashboard",Gi="PersistControlState",Ki="April2022Update",Qi="October2022Update",Xi="AutoDetectCurrentWaveUpdate",Yi="OnlineTeamsMeeting",Ji="EnableLeadActivityRollupView",$i="ModernDataLayerExpressionRuntime",Zi="PreserveDatasetState",eo="PreserveDatasetStateNotOOB",to="PreservePageDatasetStateNotOOB",no="ModernDataSetGrouping",ro="ModernDataSetAggregation",ao="ModernDataSetCreateDynamicDataSets",io="PreservePageInputInHistory",oo="DeferPeriodicSyncWhenImmediateSyncInProgress",so="FlyoutPrimitveParentClickCheck",co="ShowBusinessRecommendedIcon",lo="QueueItemPrivilegeOverride",uo="ModernShare",po="CopyLinkTypeSelectable",fo="EnableCopyDialog",go="UseCommonPromiseCache",ho="UseCommonPromiseCacheForRetrieve",mo="UseCommonPromiseCacheForClientApiRAndRM",bo="OfflineStatusBar",yo="MdlMetadataAvailableEntity",_o="MdlUpdateOfflineContextFallback",vo="ShowReconnectNotificationOnFlakyNetwork",So="DockedModeForGridEditorPanels",Oo="HardReloadStaticThreshold",Co="HardReloadStaticThresholdBit0",Eo="HardReloadStaticThresholdBit1",Io="HardReloadStaticThresholdBit2",wo="HardReloadStaticThresholdBit3",jo="HardReloadStaticThresholdBit4",Po="EnableGreyStarIconForUnfollow",To="CollaborationForAllEntity",No="ModernGridButtons",Ao="LookupPersona",Ro="DetectUnexpectedBrowserTermination",Do="DisposeFormComponentAllCases",xo="TeamsChatIntegration",Mo="AddTokenToSvgXhrRequests",Fo="FSI2022Update",ko="AdvancedLookupEnabledOffline",Lo="TrackWindowEventListeners",Bo="MultiSessionLayoutImprovements"},"31Vn":function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i}));var r=n("xagu");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a=[r.i,r.v,r.U.toLocaleLowerCase(),r.gb];function i(e,t=!1){let n=null,r="";try{"string"==typeof e&&""!==e?n=new URL(e,window.location.origin):e instanceof URL&&(n=new URL(e.toString(),window.location.origin)),!n||n.protocol===window.location.protocol&&n.host===window.location.host?n&&(r=s(n,t?[]:a).toString()):r=s(n,[]).toString()}finally{return r}}function o(e){let t=e;if(null!==e&&""!==e&&void 0!==e){const n=e.toLocaleLowerCase();t="true"===n||"1"===n||"false"===n||"0"===n?"[Bool]":isNaN(Number(n))?"[String-"+n.length+"]":"[Num]"}return t}function s(e,t){return e.username&&(e.username="[username]"),e.password&&(e.password="[password]"),e.searchParams.forEach((n,r)=>{(0===t.length||t.indexOf(r.toLocaleLowerCase())>-1)&&e.searchParams.set(r,o(n))}),e}},"37s6":function(e,t,n){"use strict";n.d(t,"A",(function(){return R})),n.d(t,"w",(function(){return y})),n.d(t,"x",(function(){return C})),n.d(t,"e",(function(){return j})),n.d(t,"v",(function(){return P})),n.d(t,"t",(function(){return I})),n.d(t,"u",(function(){return w})),n.d(t,"c",(function(){return A})),n.d(t,"D",(function(){return T})),n.d(t,"a",(function(){return D})),n.d(t,"b",(function(){return x})),n.d(t,"p",(function(){return L})),n.d(t,"C",(function(){return k})),n.d(t,"z",(function(){return B})),n.d(t,"y",(function(){return U})),n.d(t,"r",(function(){return F})),n.d(t,"q",(function(){return q})),n.d(t,"k",(function(){return M})),n.d(t,"m",(function(){return W})),n.d(t,"l",(function(){return H})),n.d(t,"n",(function(){return G})),n.d(t,"d",(function(){return _})),n.d(t,"f",(function(){return S})),n.d(t,"s",(function(){return v})),n.d(t,"i",(function(){return O})),n.d(t,"o",(function(){return K})),n.d(t,"j",(function(){return E})),n.d(t,"E",(function(){return N})),n.d(t,"g",(function(){return Q})),n.d(t,"h",(function(){return X})),n.d(t,"B",(function(){return Y}));var r=n("504W"),a=n("eZ32"),i=n("8CLP"),o=n("8Mff"),s=n("smSa"),c=n("69Qu"),l=n("YxC/"),u=n("iF9X"),d=n("RADj"),p=n("ff1s"),f=n("8f6m"),g=n("h6c1"),h=n("7NKF"),m=(n("17x/"),n("E5IU")),b=n("/6en");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function y(e){const t=V(e);return t&&!Object(r.a)(t.status)?t.status:null}function _(e){var t;const n=null===(t=Object(g.a)(e,h.c))||void 0===t?void 0:t.dataSyncStatus;return n||{isFirstSync:!0,isForcedSync:!1,entities:[],dbSize:0,totalProgress:b.e}}function v(e){var t;const n=null===(t=Object(g.a)(e,h.c))||void 0===t?void 0:t.metadataSyncStatus;return n||{totalProgress:b.e,downloadedMetadataCount:0,totalMetadataCount:0,dbSize:0}}function S(e){var t;const n=null===(t=Object(g.a)(e,h.c))||void 0===t?void 0:t.filesDownloadStatus;return Object(r.a)(n)?Object(f.a)():n}function O(e){const t=S(e);return!!t&&t.totalFileCount-t.downloadedFileCount>0}function C(e){const t=V(e);return t&&!Object(r.a)(t.statusReason)?t.statusReason:null}function E(e){const t=V(e);return!(!t||Object(r.a)(t.isFileSyncInProgress))&&t.isFileSyncInProgress}function I(e){const t=V(e);return t&&!Object(r.a)(t.errorCode)?t.errorCode:null}function w(e){const t=V(e);return t&&!Object(r.a)(t.errorMessage)?t.errorMessage:null}function j(e){const t=V(e);return t&&t.existingDatabaseName?t.existingDatabaseName:null}function P(e){const t=V(e);return t&&!Object(r.a)(t.offlineFeatureStatus)?t.offlineFeatureStatus:null}function T(e,t=!0){return P(e)===o.a.Enabled&&y(e)===a.a.Available&&(!t||Object(p.d)(e))}function N(e,t=!0){return Object(m.r)(e)&&T(e,t)}function A(e){const t=V(e);return!(!t||Object(r.a)(t.isDbCleanupNeeded))&&t.isDbCleanupNeeded}function R(e){const t=V(e);return!(!t||Object(r.a)(t.reInitializeOffline))&&t.reInitializeOffline}function D(e){const t=V(e);return!(!t||!t.applyApplicationMetadataChanges)&&t.applyApplicationMetadataChanges}function x(e){const t=V(e);return!(!t||!t.applyingApplicationMetadataChanges)&&e.offline.client.applyingApplicationMetadataChanges}function M(e){const t=V(e);return!(!t||!t.isFirstApplyApplicationMetadataChangesDone)&&t.isFirstApplyApplicationMetadataChangesDone}function F(e){const t=V(e);return!(!t||!t.isSyncing)&&e.offline.client.isSyncing}function k(e){const t=V(e);return!(!t||Object(r.a)(t.isUserSelectOffline))&&t.isUserSelectOffline}function L(e){return P(e)!==o.a.Disabled&&Object(u.a)(e)}function B(e){let t="";switch(y(e)){case a.a.NotAvailable:t=Object(l.b)(e,"L_Offline_Not_Available");break;case a.a.Initializing:t=Object(l.b)(e,"L_Initializing");break;case a.a.Available:t=Object(p.d)(e)?G(e)?Object(l.b)(e,"L_Offline_Updating"):Object(l.b)(e,"L_Offline_Available"):Object(p.c)(e)?Object(l.b)(e,"L_Offline_Not_Available"):Object(l.b)(e,"L_Initializing");break;default:t=Object(l.b)(e,"L_Offline_Not_Available")}return t}function U(e){let t="";if(Object(p.c)(e))return t;const n=C(e);if(n)switch(n){case i.a.ProfileUnavailable:t=Object(l.b)(e,"L_OfflineProfile_Not_Available");break;case i.a.DatabaseUnavailable:t=Object(l.b)(e,"L_Offline_DB_Not_Available");break;case i.a.MetadataChanged:t=z(e);break;case i.a.SyncFailure:t=Object(l.b)(e,"L_Sync_Failure");break;case i.a.UpgradeClient:t=Object(l.b)(e,"L_Upgrade_Client")}return!t&&Object(c.d)(e)&&d.a.SyncPendingFromServer===Object(s.c)(e)&&(t=z(e)),t}function V(e){return e&&e.offline&&e.offline.client?e.offline.client:null}function z(e){let t="";return t=Object(s.c)(e)===d.a.SyncPendingFromServer?Object(l.b)(e,"L_Metadata_Changed_Text"):Object(l.b)(e,"L_Metadata_Changed"),t}function q(e){const t=V(e);return!(!t||!t.isOfflineFirstTimeSyncCompleted)&&t.isOfflineFirstTimeSyncCompleted}function H(e){const t=V(e);return!(!t||!t.isFirstTimeDataSyncCompleted)&&t.isFirstTimeDataSyncCompleted}function W(e){const t=V(e);return!(!t||!t.isFirstTimeMetadataValidationCompleted)&&t.isFirstTimeMetadataValidationCompleted}function G(e){const t=V(e);return!(!t||!t.isForcedSyncInProgress)&&t.isForcedSyncInProgress}function K(e){const t=V(e);return t&&t.isImmediateOfflineDataSyncInProgress}function Q(e){const t=V(e);return t&&t.hasDismissedStatusBar}function X(e){const t=V(e);return t&&t.hasDismissedStatusBarPerSync}function Y(e){const t=V(e);return t&&t.showSyncFinishedNotification}},"3BuU":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Unspecified=0]="Unspecified",e[e.String=1]="String",e[e.Int64=2]="Int64",e[e.Double=3]="Double",e[e.Boolean=4]="Boolean",e[e.Date=5]="Date"}(t.AWTPropertyType||(t.AWTPropertyType={})),function(e){e[e.NotSet=0]="NotSet",e[e.DistinguishedName=1]="DistinguishedName",e[e.GenericData=2]="GenericData",e[e.IPV4Address=3]="IPV4Address",e[e.IPv6Address=4]="IPv6Address",e[e.MailSubject=5]="MailSubject",e[e.PhoneNumber=6]="PhoneNumber",e[e.QueryString=7]="QueryString",e[e.SipAddress=8]="SipAddress",e[e.SmtpAddress=9]="SmtpAddress",e[e.Identity=10]="Identity",e[e.Uri=11]="Uri",e[e.Fqdn=12]="Fqdn",e[e.IPV4AddressLegacy=13]="IPV4AddressLegacy"}(t.AWTPiiKind||(t.AWTPiiKind={})),function(e){e[e.NotSet=0]="NotSet",e[e.GenericContent=1]="GenericContent"}(t.AWTCustomerContentKind||(t.AWTCustomerContentKind={})),function(e){e[e.Low=1]="Low",e[e.Normal=2]="Normal",e[e.High=3]="High",e[e.Immediate_sync=5]="Immediate_sync"}(t.AWTEventPriority||(t.AWTEventPriority={})),function(e){e[e.NonRetryableStatus=1]="NonRetryableStatus",e[e.QueueFull=3]="QueueFull",e[e.MaxRetryLimit=4]="MaxRetryLimit"}(t.AWTEventsDroppedReason||(t.AWTEventsDroppedReason={})),function(e){e[e.InvalidEvent=1]="InvalidEvent",e[e.SizeLimitExceeded=2]="SizeLimitExceeded",e[e.KillSwitch=3]="KillSwitch"}(t.AWTEventsRejectedReason||(t.AWTEventsRejectedReason={}))},"3I29":function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),function(e){e[e.Normal=1]="Normal",e[e.Slow=10]="Slow"}(r||(r={}));const a=8e3,i=1e3},"3UxG":function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"h",(function(){return c})),n.d(t,"f",(function(){return l})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return d})),n.d(t,"e",(function(){return p})),n.d(t,"g",(function(){return f}));var r=n("Kxpb"),a=n("uZvv"),i=n("d6Hx");const o="sitemap.set.group.collapsed.map",s="sitemap.set.group.collapsed.state.internal";function c(e,t,n){return{type:"sitemap.set.group.collapsed.state",sync:!0,execute({dispatch:r,getState:o},c){r(function(e,t,n){return{type:s,payload:{areaId:e,groupId:t,isExpanded:n}}}(e,t,n));const l=o(),u=Object(a.d)(l);try{const e={[g(o,c)]:u};c.DataSource.saveSessionState("sitemap.group.collapsed.state.local.storage.key",e,!0)}catch(e){c.TraceManager.getTracer(i.o).warn("error saving value in session state for SITEMAP_GROUP_COLLAPSED_STATE_LOCAL_STORAGE_KEY",[{name:"error",value:e.message}])}}}}function l(){return{sync:!0,type:"load.sitemap.group.collapsed.state.from.local.storage",async execute({getState:e,dispatch:t},n){var a;let s=r.b;try{const t=n.DataSource,i=await t.retrieveSessionState("sitemap.group.collapsed.state.local.storage.key"),o=g(e,n);s=null!==(a=null==i?void 0:i[o])&&void 0!==a?a:r.b}catch(e){n.TraceManager.getTracer(i.o).warn("error loading value in session state for SITEMAP_GROUP_COLLAPSED_STATE_STORAGE_KEY",[{name:"error",value:e.message}])}t(function(e){return{type:o,payload:{collapsedGroupState:e.collapsedGroupState}}}(s))}}}function u(e){return e?Object.keys(e):[]}function d(e,t){return e.reduce((e,n)=>(null==t?void 0:t[n])?e+1:e,0)}function p(e,t){var n,r;return null!==(r=null===(n=null==t?void 0:t.collapsedGroupState)||void 0===n?void 0:n[e])&&void 0!==r&&r}function f(e,t){return{sync:!0,type:"log.sitemap.group.toggle.event",execute({getState:n},r){const o=Object(a.d)(n()).collapsedGroupState,s=u(o),c=d(s,o);r.EventManager.ReportComponentSuccess(i.m,[{name:"ExpandedGroupsCount",value:c},{name:"TotalGroups",value:s.length},{name:"IsGroupExpanded",value:e},{name:"IsMobileApp",value:t}])}}}function g(e,t){var n,r,a,o,s;const c=null!==(s=null===(o=null===(a=null===(r=null===(n=e())||void 0===n?void 0:n.metadata)||void 0===r?void 0:r.appContext)||void 0===a?void 0:a.app)||void 0===o?void 0:o.appId)&&void 0!==s?s:"";return c||t.TraceManager.getTracer(i.o).warn("error with App ID value in session state for SITEMAP_GROUP_COLLAPSED_STATE_STORAGE_KEY",[{name:"error",value:"App ID was null with current state"}]),c}},"3VnW":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("Ri7K"),a="MicrosoftApplicationsTelemetryDeviceId",i="MicrosoftApplicationsTelemetryFirstLaunchTime",o="MSIE",s="Chrome",c="Firefox",l="Safari",u="Edge",d="Electron",p="SkypeShell",f="PhantomJS",g="Opera",h="Windows",m="Mac OS X",b="Windows Phone",y="Windows RT",_="iOS",v="Android",S="Linux",O="Chrome OS",C=/(windows|win32)/i,E=/ arm;/i,I=/windows\sphone\s\d+\.\d+/i,w=/(macintosh|mac os x)/i,j=/(iPad|iPhone|iPod)(?=.*like Mac OS X)/i,P=/(linux|joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)/i,T=/android/i,N=/CrOS/i,A={5.1:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1","10.0":"10"},R=function(){function e(){}return e.addPropertyStorageOverride=function(e){return!!e&&(this._propertyStorage=e,!0)},e.autoCollect=function(e,t,n){if(this._semanticContext=e,this._disableCookies=t,this._autoCollect(),n||"undefined"==typeof navigator||(n=navigator.userAgent||""),this._autoCollectFromUserAgent(n),this._disableCookies&&!this._propertyStorage)return this._deleteCookie(a),void this._deleteCookie(i);(this._propertyStorage||this._areCookiesAvailable&&!this._disableCookies)&&this._autoCollectDeviceId()},e.checkAndSaveDeviceId=function(e){if(e){var t=this._getData(a),n=this._getData(i);t!==e&&(n=r.getISOString(new Date)),this._saveData(a,e),this._saveData(i,n),this._setFirstLaunchTime(n)}},e._autoCollectDeviceId=function(){var e=this._getData(a);e||(e=r.newGuid()),this._semanticContext.setDeviceId(e)},e._autoCollect=function(){"undefined"!=typeof document&&document.documentElement&&this._semanticContext.setAppLanguage(document.documentElement.lang),"undefined"!=typeof navigator&&this._semanticContext.setUserLanguage(navigator.userLanguage||navigator.language);var e=(new Date).getTimezoneOffset(),t=e%60,n=(e-t)/60,r="+";n>0&&(r="-"),n=Math.abs(n),t=Math.abs(t),this._semanticContext.setUserTimeZone(r+(n<10?"0"+n:n.toString())+":"+(t<10?"0"+t:t.toString()))},e._autoCollectFromUserAgent=function(e){if(e){var t=this._getBrowserName(e);this._semanticContext.setDeviceBrowserName(t),this._semanticContext.setDeviceBrowserVersion(this._getBrowserVersion(e,t));var n=this._getOsName(e);this._semanticContext.setDeviceOsName(n),this._semanticContext.setDeviceOsVersion(this._getOsVersion(e,n))}},e._getBrowserName=function(e){return this._userAgentContainsString("OPR/",e)?g:this._userAgentContainsString(f,e)?f:this._userAgentContainsString(u,e)||this._userAgentContainsString("Edg",e)?u:this._userAgentContainsString(d,e)?d:this._userAgentContainsString(s,e)?s:this._userAgentContainsString("Trident",e)?o:this._userAgentContainsString(c,e)?c:this._userAgentContainsString(l,e)?l:this._userAgentContainsString(p,e)?p:"Unknown"},e._setFirstLaunchTime=function(e){if(!isNaN(e)){var t=new Date;t.setTime(parseInt(e,10)),e=r.getISOString(t)}this.firstLaunchTime=e},e._userAgentContainsString=function(e,t){return t.indexOf(e)>-1},e._getBrowserVersion=function(e,t){if(t===o)return this._getIeVersion(e);if(t===u){var n=this._getOtherVersion(t,e);return"Unknown"===n?this._getOtherVersion("Edg",e):n}return this._getOtherVersion(t,e)},e._getIeVersion=function(e){var t=e.match(new RegExp(o+" ([\\d,.]+)"));if(t)return t[1];var n=e.match(new RegExp("rv:([\\d,.]+)"));return n?n[1]:void 0},e._getOtherVersion=function(e,t){e===l&&(e="Version");var n=t.match(new RegExp(e+"/([\\d,.]+)"));return n?n[1]:"Unknown"},e._getOsName=function(e){return e.match(I)?b:e.match(E)?y:e.match(j)?_:e.match(T)?v:e.match(P)?S:e.match(w)?m:e.match(C)?h:e.match(N)?O:"Unknown"},e._getOsVersion=function(e,t){return t===h?this._getGenericOsVersion(e,"Windows NT"):t===v?this._getGenericOsVersion(e,t):t===m?this._getMacOsxVersion(e):"Unknown"},e._getGenericOsVersion=function(e,t){var n=e.match(new RegExp(t+" ([\\d,.]+)"));return n?A[n[1]]?A[n[1]]:n[1]:"Unknown"},e._getMacOsxVersion=function(e){var t=e.match(new RegExp(m+" ([\\d,_,.]+)"));if(t){var n=t[1].replace(/_/g,".");if(n){var r=this._getDelimiter(n);return r?n.split(r)[0]:n}}return"Unknown"},e._getDelimiter=function(e){return e.indexOf(".")>-1?".":e.indexOf("_")>-1?"_":null},e._saveData=function(e,t){if(this._propertyStorage)this._propertyStorage.setProperty(e,t);else if(this._areCookiesAvailable){var n=new Date;n.setTime(n.getTime()+31536e6);var r="expires="+n.toUTCString();document.cookie=e+"="+t+"; "+r}},e._getData=function(e){if(this._propertyStorage)return this._propertyStorage.getProperty(e)||"";if(this._areCookiesAvailable){e+="=";for(var t=document.cookie.split(";"),n=0;n<t.length;n++){for(var r=t[n],a=0;" "===r.charAt(a);)a++;if(0===(r=r.substring(a)).indexOf(e))return r.substring(e.length,r.length)}}return""},e._deleteCookie=function(e){this._areCookiesAvailable&&(document.cookie=e+"=;expires=Thu, 01 Jan 1970 00:00:01 GMT;")},e._disableCookies=!1,e._areCookiesAvailable="undefined"!=typeof document&&void 0!==document.cookie,e}();t.default=R},"3ZMs":function(e,t,n){"use strict";var r,a,i;Object.defineProperty(t,"__esModule",{value:!0}),t.writeToConsole=t.issueMessages=t.PerformanceIssueLevel=t.PerformanceIssueType=void 0,function(e){e[e.Warning=0]="Warning",e[e.Error=1]="Error"}(a||(a={})),t.PerformanceIssueLevel=a,function(e){e[e.WorkBlockTimeout=0]="WorkBlockTimeout",e[e.SyncXHR=1]="SyncXHR",e[e.UnmemoizedSelector=2]="UnmemoizedSelector",e[e.ComponentUpdateDuringIdleTask=3]="ComponentUpdateDuringIdleTask",e[e.IdleTaskAddedFromIdleTask=4]="IdleTaskAddedFromIdleTask",e[e.MaxIdleTimeExceeded=5]="MaxIdleTimeExceeded",e[e.NetworkRequestQuotaIssues=6]="NetworkRequestQuotaIssues",e[e.WorkTimeOutOfBounds=7]="WorkTimeOutOfBounds",e[e.ExternalNetworkRequest=8]="ExternalNetworkRequest",e[e.MetadataCallDuringWarmLoad=9]="MetadataCallDuringWarmLoad",e[e.MismatchedKeyPerformanceIndicators=10]="MismatchedKeyPerformanceIndicators",e[e.ErrorDuringAutomation=11]="ErrorDuringAutomation",e[e.ObjectCountIncrease=12]="ObjectCountIncrease",e[e.ExcessiveRendering=13]="ExcessiveRendering"}(i||(i={})),t.PerformanceIssueType=i,t.writeToConsole=function(e){var t=o[e.type],n="Performance issue (type: "+(e.level===a.Error?"error":"warning")+"): "+t+" | "+e.message+".";console.warn(n,e.parameters)};var o=((r={})[i.WorkBlockTimeout]="Work block action(s) timeout",r[i.SyncXHR]="Synchronous XHR",r[i.UnmemoizedSelector]="Unmemoized selector",r[i.ComponentUpdateDuringIdleTask]="Component update during idle tasks",r[i.IdleTaskAddedFromIdleTask]="Idle task added from idle task",r[i.MaxIdleTimeExceeded]="Max app idle time exceeded",r[i.NetworkRequestQuotaIssues]="Network request quota issues",r[i.WorkTimeOutOfBounds]="Work time out of bounds",r[i.ExternalNetworkRequest]="External network request",r[i.MetadataCallDuringWarmLoad]="Metadata call during warm load",r[i.MismatchedKeyPerformanceIndicators]="Mismatched key performance indicator",r[i.ErrorDuringAutomation]="Error during automation",r[i.ObjectCountIncrease]="Object count increase",r[i.ExcessiveRendering]="Excessive rendering",r);t.issueMessages=o},"3ZcW":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));class r{getMetadata(){return{boundParameter:null,operationName:null,operationType:null,parameterTypes:{MetadataType:{typeName:"Edm.String",structuralProperty:1},MetadataSubtype:{typeName:"Edm.String",structuralProperty:1},EntityLogicalName:{typeName:"Edm.String",structuralProperty:1},MetadataId:{typeName:"Edm.Guid",structuralProperty:1},MetadataName:{typeName:"Edm.String",structuralProperty:1},MetadataNames:{typeName:"Edm.String",structuralProperty:4},GetDefault:{typeName:"Edm.Boolean",structuralProperty:1},DependencyDepth:{typeName:"Microsoft.Dynamics.CRM.DependencyDepth",structuralProperty:3,enumProperties:[,{name:"Unknown",value:0},{name:"OnDemandWithContext",value:1},{name:"OnDemandWithoutContext",value:2},{name:"OnDemandContextOnly",value:3},{name:"Offline",value:4},{name:"Mobile",value:5},{name:"UserContext",value:6}]},ChangedAfter:{typeName:"Edm.String",structuralProperty:1},Exclude:{typeName:"Edm.Guid",structuralProperty:4},AppId:{typeName:"Edm.Guid",structuralProperty:1}}}}}},"3bZx":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class r{constructor(){this._cache={}}setItem(e,t){this._cache[e]=t}getItem(e){return this._cache[e]||null}removeItem(e){delete this._cache[e]}}},"3c60":function(e,t,n){"use strict";n.d(t,"i",(function(){return u})),n.d(t,"a",(function(){return d})),n.d(t,"c",(function(){return f})),n.d(t,"d",(function(){return g})),n.d(t,"f",(function(){return h})),n.d(t,"b",(function(){return m})),n.d(t,"e",(function(){return b})),n.d(t,"g",(function(){return y})),n.d(t,"h",(function(){return _})),n.d(t,"j",(function(){return v}));var r=n("Ae6N"),a=n("2mBq"),i=n("olF5"),o=n("MUIu"),s=n("jZCH"),c=n("MXaZ"),l=n("504W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const u=6e4;function d(e,t){switch(t){case r.a.DateOnly:return b(e);case r.a.TimeZoneIndependent:return e;case r.a.UserLocal:return function(e){return Object(c.n)(s.a.get_DefaultInstance().get_UserContext(),e)}(e);default:throw Error.create("The Attribute's DateTime Behavior is Undefined!!")}}function p(e,t,n,r,i){const o=Object(a.a)("rtrim([{0}].[{1}])",e,t),s=Object(c.v)(n),l=Object(c.v)(r);return Object(a.a)(i,o,s,o,l)}function f(e,t,n,r){return p(e,t,n,r," {0} >= {1} and {2} < {3} ")}function g(e,t,n,r){return p(e,t,n,r," {0} >= {1} and {2} <= {3} ")}function h(){return Object(c.F)(s.a.get_DefaultInstance().get_UserContext())}function m(e){if(Object(i.b)(e,"DateTime input Value"),e instanceof Date)return e;let t=e;const n=new RegExp("[-]","ig");return t=t.replace(n,"/"),t=Object(o.d)(t),t=t.lastIndexOf(".")>-1?t.substr(0,t.lastIndexOf(".")):t,new Date(Date.parse(t))}function b(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate())}function y(){return Object(c.N)(s.a.get_DefaultInstance().get_UserContext(),h())}function _(e){switch(e){case"last-x-days":case"next-x-days":case"last-seven-days":case"next-seven-days":case"yesterday":case"today":case"tomorrow":case"on":case"on-or-after":case"on-or-before":case"next-week":case"last-week":case"this-week":case"last-x-weeks":case"next-x-weeks":case"last-x-months":case"next-x-months":case"last-month":case"next-month":case"this-month":case"last-x-years":case"next-x-years":case"last-year":case"next-year":case"this-year":case"not-null":return!0;default:return!1}}function v(e){let t=e.trim();t=t.replace(/[/]/gi,"-");const n=t.match(/[Z,T]/gi);if(!Object(l.a)(n)&&2===n.length&&n.indexOf("Z")>0&&n.indexOf("T")>0&&!isNaN(Date.parse(t)))return t;t=t.replace(/[Z,T]/gi," ").trim();const r=t.split(" ");return r.length>1?t=`${S(r[0],e)}T${function(e,t){let n="";return e.split(":").forEach(e=>{n+=O(e,t)+":"}),n=n.substring(0,n.length-1),n}(r[1],e)}Z`:1===r.length&&(t=S(r[0],e)+"T00:00:00.000Z"),isNaN(Date.parse(t))&&C(e),t}function S(e,t){let n="";return e.split("-").forEach(e=>{n+=4!==e.length?O(e,t)+"-":e+"-"}),n=n.substring(0,n.length-1),n}function O(e,t){return-1===e.indexOf(".")?(e.length>2&&C(t),e.length<2?"0"+e:e):(e.length>10&&C(t),e.split(".")[0].length<2?"0"+e:e)}function C(e){throw new Error(`[${t||"DateTimeUtils"}] Incorrect datetime string format${e?": "+e:""}`);var t}},"3c7c":function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return s}));var r=n("Lyxw"),a=n("3/02");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function i(e){return null==e?void 0:e.replace(/\\/g,"\\\\").replace(/"/gi,'\\"')}function o(e){return null==e?void 0:e.replace(/\\"/gi,'"')}function s(e,t=!0){const n=[{Exclude:["entity","ribbon"]},{KeepOnly:["entity"]}];t&&n.push({KeepOnly:["ribbon"]}),Object(r.f)(e,a.Kc)&&(n[0].Exclude.push("webresource"),n.push({KeepOnly:["webresource"]}));return n.map(e=>[i(JSON.stringify(e))])}},"3cEW":function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return l}));var r=n("0FMG"),a=n("uZvv"),i=n("d6Hx"),o=n("1Bax"),s=n("AVDU");function c(e){return{sync:!0,type:"togglePanelStateAction",execute({getState:t,dispatch:n}){const i=Object(a.e)(t())?0:1;n(Object(r.g)(i)),!e&&Object(s.e)(t())&&n(Object(o.a)());try{Object(s.d)(t())||localStorage.setItem("siteMapState",i.toString())}catch(e){}}}}function l(e){return{sync:!0,type:"loadPanelStateFromLocalStorage",execute({getState:t,dispatch:n},a){let o=e;try{o=parseInt(localStorage.getItem("siteMapState"),10)}catch(t){o=e,a.TraceManager.getTracer(i.o).warn("error loading value in localStorage for SITE_MAP_STATE_LOCAL_STORAGE_KEY",[{name:"error",value:t.message}])}void 0!==o&&0!==o&&1!==o&&(o=e),n(Object(r.g)(o))}}}},"3eJf":function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n("Tf+h");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a=[r.e,r.g,r.d,r.f,r.c];function i(e=null,t){return s(e,t,!1)}function o(e=null,t){return s(e,t,!0)}function s(e,t,n){if(-1===a.indexOf(t.type)||!t.payload||n!==!!t.meta.pageId)return e;const r=Object.assign({},e),{payload:i,meta:o}=t;return function e(t,n,r,a){t.hasOwnProperty(r)&&r!==a?e(t[r],n[r],Object.keys(n[r])[0],a):t[r]=n[r]}(r,i,Object.keys(i)[0],o.lastPropertyKey),Object.freeze(r)}},"3eti":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("Uv1Y");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e){return{type:"offline.information.retrieve.async",async execute({dispatch:t,getState:n},a){const i=a.DataSource;return await function(e,t){return e.retrieveOfflineInformation(t).nativePromise().catch(r.b)}(i,e)}}}},"3fL6":function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.And=0]="And",e[e.Or=1]="Or"}(r||(r={}))},"3hnk":function(e,t,n){"use strict";n.d(t,"f",(function(){return m})),n.d(t,"g",(function(){return _})),n.d(t,"a",(function(){return O})),n.d(t,"h",(function(){return C})),n.d(t,"i",(function(){return h})),n.d(t,"b",(function(){return b})),n.d(t,"c",(function(){return y})),n.d(t,"e",(function(){return S})),n.d(t,"d",(function(){return v}));var r=n("LbMF"),a=n("IqkD"),i=n("iZ7K"),o=n("SAYH"),s=n("y60j"),c=n("UJfx"),l=n("qLnS"),u=n("Y2Yg"),d=n("uNu9"),p=n("Lyxw"),f=n("3/02");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const g={[d.zb]:(e,t,n)=>Object(p.f)(e,f.bg)&&n===u.a.WriteAccess?E(e,d.zb,t,n)||E(e,d.zb,t,u.a.AppendToAccess):E(e,d.zb,t,n)};function h(e){if(e)switch(e){case"activitymimeattachment":case"recommendationcache":return!0;default:return!1}return!1}function m(e,t,n,i,s){var u;let d=!0;if(function(e,t,n){let a=!1;const i=Object(r.a)(e,t,n);return i&&(a=i.IsSecured),a}(e,t,n)){const p=Object(r.a)(e,t,n);let f=!1;switch(i){case l.a.CanCreate:f=p.CanBeSecuredForCreate;break;case l.a.CanRead:f=p.CanBeSecuredForRead;break;case l.a.CanUpdate:f=p.CanBeSecuredForUpdate}if(f){const r=o.a.toString(p.Id),f=o.a.toString(s),g=null===(u=Object(a.n)(e))||void 0===u?void 0:u[r],h=Object(c.c)(e,t,f,n);if(g||h)switch(i){case l.a.CanCreate:d=(null==g?void 0:g.canCreate)||(null==h?void 0:h.canCreate);break;case l.a.CanRead:d=(null==g?void 0:g.canRead)||(null==h?void 0:h.canRead);break;case l.a.CanUpdate:d=(null==g?void 0:g.canUpdate)||(null==h?void 0:h.canUpdate)}else d=!1}}return d}function b(e,t){const n=Object(i.h)(e,t);return!!n&&n.IsEnabledInUnifiedInterface}function y(e,t){const n=Object(i.h)(e,t);return n?n.IsReadOnlyInMobileClient:null}function _(e,t,n,r,a=!1){let o=a;const s=Object(i.h)(e,t);if(s&&0===s.OwnershipType&&2===n)return!0;if(s&&s.Privileges)if(s.IsChildEntity){const t=v(e,s);o=!!t&&_(e,t.EntityLogicalName,n,r)}else for(const t in s.Privileges)if(n===s.Privileges[t].PrivilegeType){o=S(e,s.Privileges[t].PrivilegeId,r);break}return o}function v(e,t){const n=t.ManyToOneRelationships;if(n)for(const t of Object.keys(n)){const r=n[t];if(2===r.SecurityTypes)return Object(i.h)(e,r.ReferencedEntity)}return null}function S(e,t,n){let r=!1;const i=Object(a.v)(e);if(i&&i.hasOwnProperty(t)){const e=i[t];if(void 0!==(null==e?void 0:e.privilegeDepth)&&null!==(null==e?void 0:e.privilegeDepth)){const t=n;e.privilegeDepth>=t&&(r=!0)}}return r}function O(e,t){let n=!1;const r=Object(s.h)(e,t);if(r&&r.FormType)switch(r.FormType){case 2:case 9:n=!0}return n}function C(e,t,n,r){const a=g[t];return a?a(e,n,r):E(e,t,n,r)}function E(e,t,n,r){let a=!0;const i=Object(c.b)(e,t,n);return i&&(a=r===(i&r)),a}},"3mEc":function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"h",(function(){return p})),n.d(t,"j",(function(){return h})),n.d(t,"i",(function(){return f})),n.d(t,"e",(function(){return b})),n.d(t,"d",(function(){return y})),n.d(t,"f",(function(){return _})),n.d(t,"g",(function(){return v})),n.d(t,"l",(function(){return S})),n.d(t,"k",(function(){return g})),n.d(t,"c",(function(){return C})),n.d(t,"b",(function(){return O}));var r=n("SAYH"),a=n("NjDY"),i=n("arV0"),o=n("dHD5"),s=n("iZ7K"),c=n("504W"),l=n("jq7Z"),u=n("fU7K");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const d="WEBERSOURCEROOT";function p(e,t){if(!t.Parameters)return null;const n=t.Parameters.Url,r=h(e,n);let i=r?parseInt(r.type,10):-1;i=n?i:-1;let o=t.Url&&t.Url!==t.Parameters.Url?t.Url:t.Parameters.Url;if(!t.Parameters.isCustomSrc&&!o.toLocaleLowerCase().startsWith("http")&&!o.toLocaleLowerCase().startsWith("https")&&-1===o.indexOf(".aspx")){const t=Object(a.x)(e);o.startsWith(t)||(o=Object(a.x)(e)+o)}return{controlId:t.Id,title:t.Name,url:o,visible:t.Visible,showLabel:t.ShowLabel,label:t.Label,webresourceType:i}}function f(e){return{security:e.Parameters.Security,scrolling:e.Parameters.Scrolling,border:e.Parameters.Border,altText:e.Parameters.AltText,sizeType:e.Parameters.SizeType,horizontalAlignment:e.Parameters.HorizontalAlignment,verticalAlignment:e.Parameters.VerticalAlignment,width:e.Parameters.Width,height:e.Parameters.Height,showOnMobileClient:e.Parameters.hasOwnProperty("ShowOnMobileClient")?e.Parameters.ShowOnMobileClient:"true",passParameters:e.Parameters.PassParameters,data:e.Parameters.isCustomSrc?null:e.Parameters.Data,webResourceId:e.Parameters.WebResourceId}}function g(e){return e&&e.metadata?e.metadata.webResourceDescriptorsByName||{}:null}function h(e,t){const n=g(e);let r=t;if(n[r])return n[r];if(r=r.replace(/^\$webresource:/i,""),n[r])return n[r];const a=t.split("/");return r=a[a.length-1],n[r]?n[r]:{}}function m(e){return e&&e.dependency&&e.dependency.JScripts||[]}function b(e,t){const n=t.map(t=>m(h(e,t)));return t.concat(...n)}function y(e,t,n){if(!t||!n)return null;const r=t.map(t=>function(e,t){const n=e&&e.dependency&&e.dependency.Attributes||{},r=t.map(e=>n[e]||[]);return[].concat(...r)}(h(e,t),n));return[].concat(...r)}function _(e,t){const n=t.map(t=>{const n=h(e,t),r=m(n),a=function(e){return e&&e.dependency&&e.dependency.ResxResources||[]}(n);return[].concat(r,a)});return[].concat(...n)}function v(e,t){if(!t)return null;const n=function(e){return e&&e.metadata&&e.metadata.webResources?e.metadata.webResources:null}(e),a=r.a.toString(t);return n&&n[a]?n[a]:null}function S(e){if(!e||!e.WebResourceId)return null;const t=e.WebResourceId;return new r.a(t)}function O(e,t,n){if(!Object(c.b)(t)&&!Object(c.b)(n)){const r=e.indexOf("?");e=(e+=-1===r?"?":"&")+Object(u.CrmUrlEncode)(t)+"="+Object(u.CrmUrlEncode)(n)}return e}function C(e,t,n,r,a){const c=Object(l.a)(e,t),u=Object(i.j)(e,t),d=Object(o.w)(r),p=c.forms[d].controls[n].parameters,f=e.organization.organizationSettings,g=e.user.userSettings,h=Object(s.h)(e,u.entityTypeName);let m=a;return p&&p.isCustomSrc?p.Url:(null!=p&&null!=p.Data&&(m=O(m,"data",p.Data)),null!=p&&p.PassParameters&&"true"===p.PassParameters.toLocaleLowerCase()&&(m=O(m,"id",u.id?u.id.guid:""),m=O(m,"typename",u.entityTypeName),m=0!==h.ObjectTypeCode?O(m,"type",h.ObjectTypeCode):m,m=O(m,"orgname",f.organizationUniqueName),m=O(m,"OrgLCID",f.orgCultureInfoLCID.toString()),m=O(m,"UserLCID",g.languageId.toString())),m)}},"3peg":function(e,t,n){"use strict";n.d(t,"e",(function(){return d})),n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return g})),n.d(t,"d",(function(){return h})),n.d(t,"f",(function(){return m}));var r=n("rcL5"),a=n("/leX"),i=n("Lyxw"),o=n("3/02"),s=n("xggx"),c=n("rvu9"),l=n("oT5e"),u=n("E5IU");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function d(e,t){return Object(r.d)(e).appPaneDescriptors[t]}function p(e){return d(e,2)}function f(e){return p(e).panesState}function g(e,t){const n=Object(r.d)(e),i=n.appPaneDescriptors[t];if(i.selectedPane&&1===i.panesState){const e=n.panes[i.selectedPane];return e.type===a.b.Pane||1===e.option.sidePanelState}return!1}function h(e){return Object(i.e)(e,o.Cf,o.kf)||Object(u.i)("EnableAppSidePaneEarlyAccess",e)}function m(e,t){return b(e,2)===t||b(e,1)===t}function b(e,t){if(g(e,t)){const n=d(e,t),r=2===t?Object(s.a)(e):Object(s.b)(e),a=Object(c.c)(e,n.selectedPane),i=Object(l.a)(e,a.browsingContextId),o=null==i?void 0:i.pageId;if(r.includes(a))return o}}},"3ri3":function(e,t,n){"use strict";n.d(t,"f",(function(){return r})),n.d(t,"g",(function(){return a})),n.d(t,"m",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"j",(function(){return c})),n.d(t,"h",(function(){return l})),n.d(t,"k",(function(){return u})),n.d(t,"i",(function(){return d})),n.d(t,"n",(function(){return p})),n.d(t,"l",(function(){return f})),n.d(t,"b",(function(){return g})),n.d(t,"a",(function(){return h})),n.d(t,"v",(function(){return m})),n.d(t,"w",(function(){return b})),n.d(t,"x",(function(){return y})),n.d(t,"E",(function(){return _})),n.d(t,"F",(function(){return v})),n.d(t,"B",(function(){return S})),n.d(t,"C",(function(){return O})),n.d(t,"z",(function(){return C})),n.d(t,"D",(function(){return E})),n.d(t,"A",(function(){return I})),n.d(t,"y",(function(){return w})),n.d(t,"u",(function(){return j})),n.d(t,"o",(function(){return P})),n.d(t,"ab",(function(){return T})),n.d(t,"s",(function(){return N})),n.d(t,"K",(function(){return A})),n.d(t,"H",(function(){return R})),n.d(t,"I",(function(){return D})),n.d(t,"J",(function(){return x})),n.d(t,"L",(function(){return M})),n.d(t,"p",(function(){return F})),n.d(t,"W",(function(){return k})),n.d(t,"S",(function(){return L})),n.d(t,"Q",(function(){return B})),n.d(t,"V",(function(){return U})),n.d(t,"T",(function(){return V})),n.d(t,"R",(function(){return z})),n.d(t,"U",(function(){return q})),n.d(t,"X",(function(){return H})),n.d(t,"N",(function(){return W})),n.d(t,"P",(function(){return G})),n.d(t,"O",(function(){return K})),n.d(t,"Z",(function(){return Q})),n.d(t,"M",(function(){return X})),n.d(t,"r",(function(){return Y})),n.d(t,"q",(function(){return J})),n.d(t,"G",(function(){return $})),n.d(t,"c",(function(){return Z})),n.d(t,"t",(function(){return ee})),n.d(t,"Y",(function(){return te}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="Id",a="Name",i="Status",o="ActionData",s="CreatedOn",c="Id",l="CommandId",u="Operation",d="EntityName",p="Command",f="CommandOperation",g="businessprocessflowinstance",h="businessprocessflowinstanceid",m="_NORSYNC_LOG_businessprocessflowinstance",b="_NORSYNC_LOG_Command",y="_NORSYNC_LOG_commandoperation",_="_NORSYNC_LOG__upsynctransaction_begin",v="_NORSYNC_LOG__upsynctransaction_end",S="_NORSYNC_MAIN_LOG_TABLE",O="NORSYNC_SID",C="NORSYNC_LOG_SID",E="NORSYNC_TABLE_ID",I="NORSYNC_LOG_TYPE",w="_NORSYNC_LOG_",j="norsync",P=1,T=3,N="lastsuccessfulsaveoncrm",A="SID",R="DEVICE_ID",D="LOG_TABLE_ID",x="OPERATION_TYPE",M="TIME_STAMP",F="crudCommandActionData",k="_NORSYNC_LOG_syncerror",L="name",B="action",U="regardingobjectid",V="errormessage",z="actiondata",q="errortime",H="requestdata",W="errorcode",G="errortype",K="errordetail",Q="traversedpath",X="stageid",Y="entitylogicalname",J="entityid",$="processid",Z="ChangeProcessAndStage",ee="_MODIFIED_ON",te="SyncErrorFailureMap"},"3rse":function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.Backspace=8]="Backspace",e[e.Tab=9]="Tab",e[e.Enter=13]="Enter",e[e.Shift=16]="Shift",e[e.Ctrl=17]="Ctrl",e[e.Alt=18]="Alt",e[e.PauseBreak=19]="PauseBreak",e[e.Capslock=20]="Capslock",e[e.Escape=27]="Escape",e[e.Space=32]="Space",e[e.PageUp=33]="PageUp",e[e.PageDown=34]="PageDown",e[e.End=35]="End",e[e.Home=36]="Home",e[e.LeftArrow=37]="LeftArrow",e[e.UpArrow=38]="UpArrow",e[e.RightArrow=39]="RightArrow",e[e.DownArrow=40]="DownArrow",e[e.Insert=45]="Insert",e[e.Delete=46]="Delete",e[e.Num0=48]="Num0",e[e.Num1=49]="Num1",e[e.Num2=50]="Num2",e[e.Num3=51]="Num3",e[e.Num4=52]="Num4",e[e.Num5=53]="Num5",e[e.Num6=54]="Num6",e[e.Num7=55]="Num7",e[e.Num8=56]="Num8",e[e.Num9=57]="Num9",e[e.A=65]="A",e[e.B=66]="B",e[e.C=67]="C",e[e.D=68]="D",e[e.E=69]="E",e[e.F=70]="F",e[e.G=71]="G",e[e.H=72]="H",e[e.I=73]="I",e[e.J=74]="J",e[e.K=75]="K",e[e.L=76]="L",e[e.M=77]="M",e[e.N=78]="N",e[e.O=79]="O",e[e.P=80]="P",e[e.Q=81]="Q",e[e.R=82]="R",e[e.S=83]="S",e[e.T=84]="T",e[e.U=85]="U",e[e.V=86]="V",e[e.W=87]="W",e[e.X=88]="X",e[e.Y=89]="Y",e[e.Z=90]="Z",e[e.LeftWindowKey=91]="LeftWindowKey",e[e.RightWindowKey=92]="RightWindowKey",e[e.SelectKey=93]="SelectKey",e[e.NumPad0=96]="NumPad0",e[e.NumPad1=97]="NumPad1",e[e.NumPad2=98]="NumPad2",e[e.NumPad3=99]="NumPad3",e[e.NumPad4=100]="NumPad4",e[e.NumPad5=101]="NumPad5",e[e.NumPad6=102]="NumPad6",e[e.NumPad7=103]="NumPad7",e[e.NumPad8=104]="NumPad8",e[e.NumPad9=105]="NumPad9",e[e.Multiply=106]="Multiply",e[e.Add=107]="Add",e[e.Subtract=109]="Subtract",e[e.DecimalPoint=110]="DecimalPoint",e[e.Divide=111]="Divide",e[e.F1=112]="F1",e[e.F2=113]="F2",e[e.F3=114]="F3",e[e.F4=115]="F4",e[e.F5=116]="F5",e[e.F6=117]="F6",e[e.F7=118]="F7",e[e.F8=119]="F8",e[e.F9=120]="F9",e[e.F10=121]="F10",e[e.F11=122]="F11",e[e.F12=123]="F12",e[e.NumLock=144]="NumLock",e[e.ScrollLock=145]="ScrollLock",e[e.SemiColon=186]="SemiColon",e[e.EqualSign=187]="EqualSign",e[e.Comma=188]="Comma",e[e.Dash=189]="Dash",e[e.Period=190]="Period",e[e.ForwardSlash=191]="ForwardSlash",e[e.GraveAccent=192]="GraveAccent",e[e.OpenBracket=219]="OpenBracket",e[e.BackSlash=220]="BackSlash",e[e.CloseBraket=221]="CloseBraket",e[e.SingleQuote=222]="SingleQuote"}(r||(r={}))},"3sOn":function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var r=n("ufH1"),a=n("84PK"),i=n("504W"),o=n("Div0"),s=n("rO1J"),c=n("ngzy"),l=n("j63P"),u=n("P74A"),d=n("gvQo"),p=n("/KPo"),f=n("/XAI"),g=n("xP3K"),h=n("FKgA"),m=n("Gxq8");class b{constructor(e,t,n,r,o,s,u,d,f,g,m,b,_,v,S,O,C,E,I,w,j,P,T){this._userId=null,this._userRoles=null,this._parentRootRoles=null,this._roleNames=null,this._organizationSettings=null,this._personalizationSettings=null,this._offlineProfile=null,this._userSettings=null,this._rolePrivileges=null,this._attributePrivileges=null,this._serverContext=null,this._fullServerVersion=null,this._externalContext=null,this._fcbContext=null,this._featureControlSettings=null,this._metadataLastModifiedTime=null,this._userMetadataLastModifiedTime=null,this._transactionCurrencyId=null,this._userName=null,this._userEmail=null,this._isErrorContext=!1,this._errorCode=0,this._isValid=!1,this._isSecured=!1,this._defaultDashboardId=null,this._defaultHomepageId=null,this._defaultInteractionCentricDashboardId=null,this._userId=Object(i.a)(e)?a.a.get_empty():e,this._userName=Object(i.b)(t)?"":t,this._userEmail=Object(i.b)(n)?"":n,this._userRoles=Object(i.a)(r)?new Array(0):r,this._parentRootRoles=Object(i.a)(o)?new Array(0):o,this._organizationSettings=Object(i.a)(s)?new l.a(a.a.get_empty(),"",0,null,0,"",0,0,!1,!1,!1,0,0,new Date,0,0,0,0,0,0,"",!1,a.a.get_empty(),"",!1,"","",0,!1,!1,0,"",!1,!1,"","","",0,0,0,0,"",!1,"",!1,!1,0,0,!1,"",!1,"",!1,!1,!1,"",!1,"","",0,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,"","",!0,0,"",!0,0,!1,!1,"","","",!1,!1,!0,2,!1,"","",null,1,0,5e3,!1,"","","","",!1,!1,!1,!1,"",!1,"","",!1,!1,null,null,"",!1,null,!1,null,!1,!1,!1,60,!0,!0,!1,!1,null,!0,"",!1):s,this._userSettings=Object(i.a)(u)?new h.a(0,0,"","",null,null,0,null,0,0,!1,!1,!1,0,null,null,!1,!1,null,null,!1,null,0,!1):u,this._rolePrivileges=Object(i.a)(d)?{}:d,this._attributePrivileges=Object(i.a)(f)?{}:f,this._serverContext=Object(i.a)(g)?new p.a("",""):g,this._roleNames=Object(i.a)(m)?new Array(0):m,this._metadataLastModifiedTime=Object(i.b)(b)?"":b,this._userMetadataLastModifiedTime=Object(i.b)(_)?"":_,this._transactionCurrencyId=Object(i.a)(v)?a.a.get_empty():v,this._defaultDashboardId=Object(i.a)(S)?a.a.get_empty():S,this._defaultHomepageId=Object(i.a)(O)?a.a.get_empty():O,this._defaultInteractionCentricDashboardId=Object(i.a)(C)?a.a.get_empty():C,this._fullServerVersion=Object(i.b)(E)?"":E,this._offlineProfile=Object(i.a)(I)?new c.a(a.a.get_empty(),[],""):I,this._externalContext=Object(i.a)(w)?{}:w,this._fcbContext=Object(i.a)(j)?{}:j,this._isValid=this._userRoles.length>0,this._isSecured=!1,this._personalizationSettings=Object(i.a)(P)?y():P,this._featureControlSettings=Object(i.a)(T)?{}:T}get_DefaultSearchExperience(){return this.get_UserSettings().get_defaultSearchExperience()}get_UserId(){return this._userId}get_UserEmail(){return this._userEmail}get_TransactionCurrencyId(){return this._transactionCurrencyId}get_UserName(){return this._userName}get_userRoles(){return this._userRoles}get_parentRootRoles(){return this._parentRootRoles}get_roleNames(){return this._roleNames}get_UserRolesToNames(){if(!Object(i.a)(this.get_userRoles())){const e={};for(let t=0;t<this.get_userRoles().length;t++)e[this.get_userRoles()[t].toString()]=this.get_roleNames()[t];return e}return{}}get_organizationSettings(){return this._organizationSettings}get_personalizationSettings(){return this._personalizationSettings}get_UserSettings(){return this._userSettings}get_rolePrivileges(){return this._rolePrivileges}get_UserRolePrivileges(){return Object(i.a)(this._rolePrivileges)?{}:this._rolePrivileges}get_attributePrivileges(){return this._attributePrivileges}get_UserAttributePrivileges(){return Object(i.a)(this._attributePrivileges)?{}:this._attributePrivileges}get_serverContext(){return this._serverContext}get_externalContext(){return this._externalContext}get_TransactionCurrencyById(){return Object(i.a)(this.get_externalContext())||Object(i.a)(this.get_externalContext()[b.transactionCurrencyByIdExternalContextField])?{}:this.get_externalContext()[b.transactionCurrencyByIdExternalContextField]}get_IsLive(){return this.get_externalContext()[b.isLiveExternalContextField]}get_IsOsdpOrganization(){return this.get_externalContext()[b.isOsdpOrganizationExternalContextField]}get_UsePathBasedUrls(){return this.get_externalContext()[b.usePathBasedUrlsExternalContextField]}get_TimeZoneDefinitionByCode(){return Object(i.a)(this.get_externalContext()[b.timeZoneDefinitionByCodeExternalContextField])?{}:this.get_externalContext()[b.timeZoneDefinitionByCodeExternalContextField]}get_FCBContext(){return this._fcbContext}get_FeatureControlSettings(){return this._featureControlSettings}get_MetadataLastModifiedTime(){return this._metadataLastModifiedTime}set_MetadataLastModifiedTime(e){return this._metadataLastModifiedTime=e,e}get_UserMetadataLastModifiedTime(){return this._userMetadataLastModifiedTime}get_isErrorContext(){return this._isErrorContext}get_ErrorCode(){return this._errorCode}get_DefaultDashboardId(){return this._defaultDashboardId}get_DefaultHomepageId(){return this._defaultHomepageId}get_DefaultInteractionCentricDashboardId(){return this._defaultInteractionCentricDashboardId}getObjectData(){const e={};if(e.userid=this._userId.getObjectData(),e.username=this._userName,e.iserrorcontext=this._isErrorContext,e.errorcode=this._errorCode,e.isvalid=this._isValid,e.issecured=this._isSecured,!this._isValid)return e;e.rolenames=this._roleNames,e.userroles=this._userRoles.map(e=>e.getObjectData()),e.organizationsettings=this._organizationSettings.getObjectData(),e.personalizationSettings=this._personalizationSettings.getObjectData(),e.offlineprofile=this._offlineProfile.getObjectData(),e.usersettings=this._userSettings.getObjectData(),e.servercontext=this._serverContext.getObjectData(),e.fullserverversion=this._fullServerVersion,e.metadatalastmodifiedtime=this._metadataLastModifiedTime,e.usermetadatalastmodifiedtime=this._userMetadataLastModifiedTime,e.transactioncurrencyid=this._transactionCurrencyId.getObjectData(),e.defaultdashboardid=this._defaultDashboardId.getObjectData(),e.defaulthomepageid=this._defaultHomepageId.getObjectData(),e.defaultinteractioncentricdashboardid=this._defaultInteractionCentricDashboardId.getObjectData();const t=[];if(this._rolePrivileges&&Object.keys(this._rolePrivileges).length>0){const e=this._rolePrivileges;for(const n in e){const r={key:n,value:e[n]};t.push(r.value.getObjectData())}}else Object(r.e)("UserContext.GetObjectData:",o.a.storage,"rolePrivileges is null or empty");e.roleprivileges=t;const n=[];if(this._attributePrivileges&&Object.keys(this._attributePrivileges).length>0){const e=this._attributePrivileges;for(const t in e){const r={key:t,value:e[t]};n.push(r.value.getObjectData())}}else Object(r.e)("UserContext.GetObjectData:",o.a.storage,"attributePrivileges is null or empty");e.attributeprivileges=n;const a={},i={},s=this._externalContext[b.transactionCurrencyByIdExternalContextField];if(s&&Object.keys(s).length>0){const e=s;for(const t in e){const n={key:t,value:e[t]};i[n.key]=n.value.getObjectData()}}else Object(r.e)("UserContext.GetObjectData:",o.a.storage," externalContext Does not have any TransactionCurrency");a[b.transactionCurrencyByIdExternalContextField]=i;const c={},l=this._externalContext[b.timeZoneDefinitionByCodeExternalContextField];if(l&&Object.keys(l).length>0){const e=l;for(const t in e){const n={key:t,value:e[t]};c[n.key]=n.value.getObjectData()}}else Object(r.e)("UserContext.GetObjectData:",o.a.storage," externalContext Does not have any TimeZoneDefinitions");a[b.timeZoneDefinitionByCodeExternalContextField]=c,a[b.isLiveExternalContextField]=this._externalContext[b.isLiveExternalContextField],a[b.isOsdpOrganizationExternalContextField]=this._externalContext[b.isOsdpOrganizationExternalContextField],a[b.usePathBasedUrlsExternalContextField]=this._externalContext[b.usePathBasedUrlsExternalContextField],e.externalcontext=a,e.fcbcontext=this._fcbContext;const u={},d=this._featureControlSettings;if(d)for(const e in d){const t=[];for(const n of d[e]){const e=n.getObjectData();t.push(e)}t&&(u[e]=t)}return e.featurecontrolsettings=u,e}getTransactionCurrency(e){const t=this.get_externalContext()[b.transactionCurrencyByIdExternalContextField],n=Object(i.a)(e)?"":e.toString();return n in t?t[n]:null}get_LanguageId(){return this.get_UserSettings().get_languageId()}get_UserCultureLcid(){return this.get_UserSettings().get_userCultureLcid()}get_userCultureName(){return this.get_UserSettings().get_userCultureName()}get_IsFarEastLanguage(){return this.get_UserSettings().get_isFarEastLanguage()}get_TimeZoneUtcOffsetMinutes(){return this.get_UserSettings().get_timeZoneUtcOffsetMinutes()}get_TimeZoneAdjusters(){return this.get_UserSettings().get_timeZoneAdjusters()}get_UserReportScriptErrors(){return this.get_UserSettings().get_reportScriptErrors()}get_SavedFilters(){return this.get_UserSettings().get_savedfilters()}get_DefaultSavedFilter(){return this.get_UserSettings().get_defaultSavedFilter()}get_NumberFormatInfo(){return this.get_UserSettings().get_numberFormatInfo()}get_DateTimeFormatInfo(){return this.get_UserSettings().get_dateTimeFormatInfo()}get_ShowCalendarWeeks(){return this.get_UserSettings().get_showCalendarWeeks()}get_FormatInfoCultureName(){return this.get_UserSettings().get_formatInfoCultureName()}get_IsRTL(){return this.get_UserSettings().get_isRTL()}get_IsHighContrastEnabled(){return this.get_UserSettings().get_isHighContrastEnabled()}get_IsAdmin(){return this.get_UserSettings().get_isAdmin()}get_IsCustomizer(){return this.get_UserSettings().get_isCustomizer()}get_IsSupportUser(){return this.get_UserSettings().get_isSupportUser()}get_IsEmailConversationViewEnabled(){return this.get_UserSettings().get_isEmailConversationViewEnabled()}get_WorkDayStartTime(){return this.get_UserSettings().get_workDayStartTime()}get_AutoCaptureUserStatus(){return this.get_UserSettings().get_AutoCaptureUserStatus()}get_IsAutoSaveEnabled(){return this.get_organizationSettings().get_isAutoSaveEnabled()}get_AppointmentRichEditorExperience(){return this.get_organizationSettings().get_appointmentRichEditorExperience()}get_WebServiceCallRetryPolicies(){return this.get_organizationSettings().get_webServiceCallRetryPolicies()}get_FiscalCalendarStart(){return this.get_organizationSettings().get_fiscalCalendarStart()}get_DefaultCountryCode(){return this.get_organizationSettings().get_defaultCountryCode()}get_GeoName(){return this.get_organizationSettings().get_geoName()}get_FullNameConventionCode(){return this.get_organizationSettings().get_fullNameConventionCode()}get_PricingDecimalPrecision(){return this.get_organizationSettings().get_pricingDecimalPrecision()}get_OrganizationUniqueName(){return this.get_organizationSettings().get_organizationUniqueName()}get_SelectedFormsByEntity(){return this.get_personalizationSettings().get_selectedFormsByEntity()}get_NorsyncServerConnectionString(){return this.get_organizationSettings().get_norsyncServerConnectionString()}get_CurrentThemeData(){return this.get_organizationSettings().get_currentThemeData()}get_DelveUrl(){return this.get_organizationSettings().get_delveUrl()}get_KmUseExternalPortal(){return this.get_organizationSettings().get_kmUseExternalPortal()}get_KmExternalPortalUrl(){return this.get_organizationSettings().get_kmExternalPortalUrl()}get_MaxIncidentMergeNumber(){return this.get_organizationSettings().get_maxIncidentMergeNumber()}get_MaxChildIncidentNumber(){return this.get_organizationSettings().get_maxChildIncidentNumber()}get_IsConflictDetectionEnabledForMobileClient(){return this.get_organizationSettings().get_isConflictDetectionEnabledForMobileClient()}get_IsDuplicateDetectionEnabledForOnlineCreateUpdate(){return this.get_organizationSettings().get_isDuplicateDetectionEnabledForOnlineCreateUpdate()}get_IsParature(){return this.get_organizationSettings().get_isParature()}get_IsKMConfigured(){return this.get_organizationSettings().get_isKMConfigured()}get_MobileOfflineSyncInterval(){return this.get_organizationSettings().get_mobileOfflineSyncInterval()}get_OverrideTrackInCrmBehavior(){return this.get_organizationSettings().get_overrideTrackInCrmBehaviour()}get_ShowWeekNumber(){return this.get_organizationSettings().get_showWeekNumber()}get_IsMocaOfflineFeatureEnabled(){return this.get_organizationSettings().get_isMocaOfflineFeatureEnabled()}get_IsSOPIntegrationEnabled(){return this.get_organizationSettings().get_isSOPIntegrationEnabled()}get_IsTelemeteryEnabled(){return this.get_organizationSettings().get_isTelemetryEnabled()}get_UseSkypeProtocol(){return this.get_organizationSettings().get_useSkypeProtocol()}get_FiscalPeriodFormatPeriod(){return this.get_organizationSettings().get_fiscalPeriodFormatPeriod()}get_FiscalPeriodType(){return this.get_organizationSettings().get_fiscalPeriodType()}get_FiscalYearFormatYear(){return this.get_organizationSettings().get_fiscalYearFormatYear()}get_FiscalYearFormatPrefix(){return this.get_organizationSettings().get_fiscalYearFormatPrefix()}get_FiscalYearFormatSuffix(){return this.get_organizationSettings().get_fiscalYearFormatSuffix()}get_FiscalYearDisplayCode(){return this.get_organizationSettings().get_fiscalYearDisplayCode()}get_FiscalPeriodConnector(){return this.get_organizationSettings().get_fiscalPeriodConnector()}get_LanguageCode(){return this.get_organizationSettings().get_languageCode()}get_OrgCultureInfoLcid(){return this.get_organizationSettings().get_orgCultureInfoLcid()}get_OrganizationId(){return this.get_organizationSettings().get_organizationId()}get_OrganizationName(){return this.get_organizationSettings().get_organizationName()}get_BlockedAttachments(){return this.get_organizationSettings().get_blockedAttachments()}get_MaxUploadFileSize(){return this.get_organizationSettings().get_maxUploadFileSize()}get_OrganizationReportScriptErrors(){return this.get_organizationSettings().get_reportScriptErrors()}get_IsDuplicateDetectionEnabled(){return this.get_organizationSettings().get_isDuplicateDetectionEnabled()}get_CurrencyDisplayOption(){return this._organizationSettings.get_currencyDisplayOption()}get_EnabledLanguages(){return this._organizationSettings.get_enabledLanguages()}get_BaseCurrencyId(){return this.get_organizationSettings().get_baseCurrencyId()}get_WebResourceHash(){return this._organizationSettings.get_webResourceHash()}get_IsPowerBIEnabled(){return this._organizationSettings.get_isPowerBIEnabled()}get_FirstPartyIntegrationSiteUrl(){return this._organizationSettings.get_firstPartyIntegrationSiteUrl()}get_IsTrialOrganization(){return this._organizationSettings.get_isTrialOrganization()}get_OfflineProfileId(){return this._offlineProfile.get_profileId()}get_OfflineProfileVersion(){return this._offlineProfile.get_profileVersion()}get_OfflineProfileAvailableEntities(){return this._offlineProfile.get_offlineAvailableEntities()}get_ServerVersion(){return this.get_serverContext().get_serverVersion()}get_ServerDatabaseVersion(){return this.get_serverContext().get_databaseVersion()}get_fullServerVersion(){return this._fullServerVersion}get_EnableLPAuthoring(){return this._organizationSettings.get_enableLPAuthoring()}get_IsContextualHelpEnabled(){return this._organizationSettings.get_isContextualHelpEnabled()}get_IsMicrosoftFlowEnabled(){return this._organizationSettings.get_isMicrosoftFlowEnabled()}get_MicrosoftFlowFirstPartyIntegrationSiteUrl(){return this._organizationSettings.get_microsoftFlowFirstPartyIntegrationSiteUrl()}get_MicrosoftFlowDestinationUrl(){return this._organizationSettings.get_microsoftFlowDestinationUrl()}get_MicrosoftFlowEnvironmentId(){return this._organizationSettings.get_microsoftFlowEnvironmentId()}get_IsExternalSearchIndexEnabled(){return this._organizationSettings.get_isExternalSearchIndexEnabled()}get_SharePointDeploymentType(){return this._organizationSettings.get_sharePointDeploymentType()}get_IsOneDriveEnabled(){return this._organizationSettings.get_isOneDriveEnabled()}get_IsMSTeamsEnabled(){return this._organizationSettings.get_isMSTeamsEnabled()}get_IsContextualEmailEnabled(){return this._organizationSettings.get_isContextualEmailEnabled()}get_IsRichTextNotesEnabled(){return this._organizationSettings.get_isRichTextNotesEnabled()}get_IsAutoDataCaptureV2Enabled(){return this._organizationSettings.get_isAutoDataCaptureV2Enabled()}get_IsManualSalesForecastingEnabled(){return this._organizationSettings.get_isManualSalesForecastingEnabled()}get_IsActionCardEnabled(){return this._organizationSettings.get_isActionCardEnabled()}get_EnableImmersiveSkypeIntegration(){return this._organizationSettings.get_enableImmersiveSkypeIntegration()}get_IsEmailMonitoringAllowed(){return this._organizationSettings.get_isEmailMonitoringAllowed()}get_AllowUnresolvedPartiesOnEmailSend(){return this._organizationSettings.get_allowUnresolvedPartiesOnEmailSend()}get_IsPresenceEnabled(){return this._organizationSettings.get_isPresenceEnabled()}get_DefaultGridViews(){return this.get_UserSettings().get_defaultGridViews()}get_SelectedGlobalFilterId(){return this.get_UserSettings().get_selectedGlobalFilterId()}get_BoundDashboardDefaultCardExpanded(){return this.get_organizationSettings().get_boundDashboardDefaultCardExpanded()}get_IsPreviewOrganization(){return this._organizationSettings.get_isPreviewOrganization()}get_IsSandboxOrganization(){return this.get_organizationSettings().get_isSandboxOrganization()}get_IsSovereignCloud(){return this.get_organizationSettings().get_isSovereignCloud()}get_AdvancedDebuggabilitySettings(){return this.get_organizationSettings().get_advancedDebuggabilitySettings()}get_LogoImagePath(){return this.get_organizationSettings().get_logoImagePath()}get_LogoTooltip(){return this.get_organizationSettings().get_logoTooltip()}get_SessionTimeoutInSeconds(){return this.get_organizationSettings().get_sessionTimeoutInSeconds()}get_SessionTimeoutReminderInSeconds(){return this.get_organizationSettings().get_sessionTimeoutReminderInSeconds()}get_InactivityTimeoutInSeconds(){return this.get_organizationSettings().get_inactivityTimeoutInSeconds()}get_InactivityTimeoutReminderInSeconds(){return this.get_organizationSettings().get_inactivityTimeoutReminderInSeconds()}get_OfficePortalUrl(){return this._organizationSettings.get_officePortalUrl()}get_PpacSettingsUrl(){return this._organizationSettings.get_ppacSettingsUrl()}get_CustomizationUrl(){return this._organizationSettings.get_customizationUrl()}get_IsCrmOrg(){return this._organizationSettings.get_isCrmOrg()}get_YammerGroupId(){return this._organizationSettings.get_yammerGroupId()}get_YammerNetworkName(){return this._organizationSettings.get_yammerNetworkName()}get_YammerOAuthAccessTokenExpired(){return this._organizationSettings.get_yammerOAuthAccessTokenExpired()}get_YammerPostMethod(){return this._organizationSettings.get_yammerPostMethod()}get_EnableBingMapsIntegration(){return this._organizationSettings.get_enableBingMapsIntegration()}get_BingMapsApiKey(){return this._organizationSettings.get_bingMapsApiKey()}get_AvailableBingMapLocales(){return this._organizationSettings.get_availableBingMapLocales()}get_ExcludedCountriesForMaps(){return this._organizationSettings.get_excludedCountriesForMaps()}get_BFDatacenter(){return this._organizationSettings.get_bfDatacenter()}get_AllowLegacyDialogsEmbedding(){return this.get_organizationSettings().get_allowLegacyDialogsEmbedding()}get_AllowLegacyClientExperience(){return this.get_organizationSettings().get_allowLegacyClientExperience()}get_CdsCapabilityMode(){return this.get_organizationSettings().get_cdsCapabilityMode()}get_EnableUnifiedInterfaceShellRefresh(){return this.get_organizationSettings().get_enableUnifiedInterfaceShellRefresh()}get_GlobalHelpUrl(){return this.get_organizationSettings().get_globalHelpUrl()}get_GlobalHelpUrlEnabled(){return this.get_organizationSettings().get_globalHelpUrlEnabled()}get_GlobalAppendUrlParametersEnabled(){return this.get_organizationSettings().get_globalAppendUrlParametersEnabled()}get_PrivacyStatementUrl(){return this.get_organizationSettings().get_privacyStatementUrl()}get_OrganizationTenant(){return this.get_organizationSettings().get_organizationTenant()}get_SecuritySettingForEmail(){return this.get_organizationSettings().get_securitySettingForEmail()}get_EnableActivitiesTimeLinePerfImprovement(){return this.get_organizationSettings().get_enableActivitiesTimeLinePerfImprovement()}get_GridTotalRecordCountLimit(){return this._organizationSettings.get_gridTotalRecordCountLimit()}get_EnableLivePersonaCardUCI(){return this.get_organizationSettings().get_enableLivePersonaCardUCI()}get_LivePersonaCardComplianceEnvironment(){return this.get_organizationSettings().get_livePersonaCardComplianceEnvironment()}get_LivePersonaCardCulture(){return this.get_organizationSettings().get_livePersonaCardCulture()}get_LivePersonaCardFirstPartyIntegrationUrl(){return this.get_organizationSettings().get_livePersonaCardFirstPartyIntegrationUrl()}get_LivePersonaCardRegion(){return this.get_organizationSettings().get_livePersonaCardRegion()}get_DefaultCrmCustomName(){return this.get_organizationSettings().get_defaultCrmCustomName()}get_AreJquery3IncompatibleSolutionsInstalled(){return this.get_organizationSettings().get_areJquery3IncompatibleSolutionsInstalled()}get_UseQuickFindViewForGridSearch(){return this.get_organizationSettings().get_useQuickFindViewForGridSearch()}get_NewSearchExperienceEnabled(){return this.get_organizationSettings().get_newSearchExperienceEnabled()}get_RelevanceSearchEnabledByPlatform(){return this.get_organizationSettings().get_relevanceSearchEnabledByPlatform()}get_ImproveSearchLoggingEnabled(){return this.get_organizationSettings().get_improveSearchLoggingEnabled()}get_LookupCharacterCountBeforeResolve(){return this.get_organizationSettings().get_lookupCharacterCountBeforeResolve()}get_LookupResolveDelayMS(){return this.get_organizationSettings().get_lookupResolveDelayMS()}get_organizationBAPEnvironmentID(){return this.get_organizationSettings().get_organizationBAPEnvironmentID()}get_AdvancedLookupEnabled(){return this.get_organizationSettings().get_advancedLookupEnabled()}get_QuickActionToOpenRecordsInSidePaneEnabled(){return this.get_organizationSettings().get_quickActionToOpenRecordsInSidePaneEnabled()}get_AdvancedColumnEditorEnabled(){return this.get_organizationSettings().get_advancedColumnEditorEnabled()}get_AdvancedColumnFilteringEnabled(){return this.get_organizationSettings().get_advancedColumnFilteringEnabled()}get_ModernAdvancedFindFiltering(){return this.get_organizationSettings().get_modernAdvancedFindFiltering()}get_AllowUsersHidingSystemViews(){return this.get_organizationSettings().get_allowUsersHidingSystemViews()}get_IsCollaborationExperienceEnabled(){return this.get_organizationSettings().get_isCollaborationExperienceEnabled()}get_IsSharingInOrgAllowed(){return this.get_organizationSettings().get_isSharingInOrgAllowed()}get_CopresenceRefreshRate(){return this.get_organizationSettings().get_copresenceRefreshRate()}get_EnableAsyncMergeAPIForUCI(){return this.get_organizationSettings().get_enableAsyncMergeAPIForUCI()}get_UserRatingEnabled(){return this.get_organizationSettings().get_userRatingEnabled()}get_PcfDatasetGridEnabled(){return this.get_organizationSettings().get_pcfDatasetGridEnabled()}get_AppointmentWithTeamsMeetingEnabled(){return this.get_organizationSettings().get_appointmentWithTeamsMeetingEnabled()}static createErrorContext(e,t){const n=e?new b(e._userId,e._userName,e._userEmail,e._userRoles,e._parentRootRoles,e._organizationSettings,e._userSettings,e._rolePrivileges,e._attributePrivileges,e._serverContext,e._roleNames,e._metadataLastModifiedTime,e._userMetadataLastModifiedTime,e._transactionCurrencyId,e._defaultDashboardId,e._defaultHomepageId,e._defaultInteractionCentricDashboardId,e._fullServerVersion,e._offlineProfile,e.get_externalContext(),e.get_FCBContext(),e._personalizationSettings,e.get_FeatureControlSettings()):new b(a.a.get_empty(),"","",null,null,null,null,null,null,null,null,"","",a.a.get_empty(),a.a.get_empty(),a.a.get_empty(),a.a.get_empty(),"",null,null,null,null,null);return n._isErrorContext=!0,n._errorCode=t,n}static createSecureContext(e){const t=e?new b(e._userId,e._userName,e._userEmail,e._userRoles,e._parentRootRoles,e._organizationSettings,e._userSettings,e._rolePrivileges,e._attributePrivileges,e._serverContext,e._roleNames,e._metadataLastModifiedTime,e._userMetadataLastModifiedTime,e._transactionCurrencyId,e._defaultDashboardId,e._defaultHomepageId,e._defaultInteractionCentricDashboardId,e._fullServerVersion,e._offlineProfile,e.get_externalContext(),e.get_FCBContext(),e.get_personalizationSettings(),e.get_FeatureControlSettings()):new b(a.a.get_empty(),"","",null,null,null,null,null,null,null,null,"","",a.a.get_empty(),a.a.get_empty(),a.a.get_empty(),a.a.get_empty(),"",null,null,null,null,null);return t._userName="",t._isSecured=!0,t}static createFromObjectData(e){const t=e.userid?a.a.createFromObjectData(e.userid):a.a.get_empty(),n=e.username,_=e.userEmail,v=e.iserrorcontext,S=e.errorcode,O=e.isvalid,C=e.issecured;if(!O)return b.createErrorContext(null,S);const E=e.rolenames,I=e.userroles.map(e=>a.a.createFromObjectData(e));let w=[];Object(i.a)(e.parentrootroles)||(w=e.parentrootroles.map(e=>a.a.createFromObjectData(e)));const j=l.a.createFromObjectData(e.organizationsettings),P=Object(i.a)(e.personalizationSettings)?y():u.a.createFromObjectData(e.personalizationSettings),T=h.a.createFromObjectData(e.usersettings),N=p.a.createFromObjectData(e.servercontext),A=c.a.createFromObjectData(e.offlineprofile),R=e.fullserverversion,D={};for(const t of e.roleprivileges){const e=d.a.createFromObjectData(t);D[e.get_privilegeId().toString()]=e}const x={};for(const t of e.attributeprivileges){const e=s.a.createFromObjectData(t);x[e.get_AttributeId().toString()]=e}const M=e.metadatalastmodifiedtime,F=e.usermetadatalastmodifiedtime,k=e.transactioncurrencyid?a.a.createFromObjectData(e.transactioncurrencyid):a.a.get_empty(),L=e.defaultdashboardid?a.a.createFromObjectData(e.defaultdashboardid):a.a.get_empty(),B=e.defaulthomepageid?a.a.createFromObjectData(e.defaulthomepageid):a.a.get_empty(),U=e.defaultinteractioncentricdashboardid?a.a.createFromObjectData(e.defaultinteractioncentricdashboardid):a.a.get_empty(),V=e.externalcontext,z={},q={},H=V[b.transactionCurrencyByIdExternalContextField];for(const e in H){const t={key:e,value:H[e]};q[t.key]=g.a.createFromObjectData(t.value)}z[b.transactionCurrencyByIdExternalContextField]=q;const W={};if(V[b.timeZoneDefinitionByCodeExternalContextField]){const e=V[b.timeZoneDefinitionByCodeExternalContextField];for(const t in e){const n={key:t,value:e[t]};W[n.key]=f.a.createFromObjectData(n.value)}}else Object(r.e)("UserContext.CreateFromObjectData:",o.a.storage," SerializedExternalContext Does not have any TimeZoneDefinitions");z[b.timeZoneDefinitionByCodeExternalContextField]=W,z[b.isLiveExternalContextField]=V[b.isLiveExternalContextField],z[b.isOsdpOrganizationExternalContextField]=V[b.isOsdpOrganizationExternalContextField],z[b.usePathBasedUrlsExternalContextField]=V[b.usePathBasedUrlsExternalContextField];const G=e.fcbcontext,K={};if(e.featurecontrolsettings){const t=e.featurecontrolsettings;for(const e in t){const n=[];for(const r of t[e]){const e=m.a.createFromObjectData(r);n.push(e)}n&&(K[e]=n)}}let Q=new b(t,n,_,I,w,j,T,D,x,N,E,M,F,k,L,B,U,R,A,z,G,P,K);return v&&(Q=b.createErrorContext(Q,S)),C&&(Q=b.createSecureContext(Q)),Q}}function y(){return new u.a(new Array(0))}b.transactionCurrencyByIdExternalContextField="transactioncurrencybyid",b.timeZoneDefinitionByCodeExternalContextField="timezonedefinitionbycode",b.isLiveExternalContextField="islive",b.isOsdpOrganizationExternalContextField="isosdporganization",b.usePathBasedUrlsExternalContextField="usepathbasedurls",b.entityMetadataSyncConfigurationExternalContextField="entitymetadatasyncconfiguration"},"3tOH":function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e.error="ERROR",e.warning="WARNING",e.information="INFO",e.localSave="LOCALSAVE",e.recommendation="RECOMMENDATION"}(r||(r={}))},"3umU":function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var r=n("nfLm"),a=n("HkYq"),i=n("504W"),o=n("NMtn"),s=n("eYZY"),c=n("cgR4"),l=n("8tWD"),u=n("/bjP"),d=n("xAYq"),p=n("jZCH"),f=n("qCX6"),g=n("JPoD"),h=n("UDbe"),m=n("ufH1"),b=n("Div0");class y{constructor(e){this._id=null,this._metadataType=0,this._metadataSubtype=0,this._formFactor=0,this._isDefault=!1,this._associatedEntityLogicalName=null,this._displayName=null,this._sourceId=null,this._isUserRecord=!1,this._descriptorData=null,this._dependencyData=null,this._isDescriptorDataDeserialized=!1,Object(o.d)(e,"fields"),Object(o.d)(e[s.a],'fields["'+s.a+'"]'),Object(o.d)(e[s.j],'fields["'+s.j+'"]'),Object(o.d)(e[s.f],'fields["'+s.f+'"]'),Object(o.d)(e[s.c],'fields["'+s.c+'"]'),this._id=e[s.a],this._metadataType=e[s.j],this._metadataSubtype=e[s.i],this._formFactor=e[s.f],this._sourceId=e[s.k],this._isDescriptorDataDeserialized=!1,this._descriptorData=e[s.c],this._dependencyData=e[s.d],this._isDefault=s.g in e&&e[s.g],this._associatedEntityLogicalName=s.b in e?e[s.b]:null,this._displayName=s.e in e?e[s.e]:null,this._sourceId=s.k in e?e[s.k]:null,this._isUserRecord=s.h in e&&e[s.h],this._metadataType===a.a.savedView&&e[s.c]&&!e[s.c].OfflineSqlQuery&&Object(m.e)("ApplicationMetadata_constructor",b.a.storage,`SavedView application metadata created without offline SQL query for Id: ${this._id}, Entity: ${this._associatedEntityLogicalName}, Subtype: ${this._metadataSubtype}, Source Id: ${this._sourceId}, Display Name: ${this._displayName}}`)}get_metadataType(){return this._metadataType}get_metadataSubtype(){return this._metadataSubtype}get_formFactor(){return this._formFactor}get_isDefault(){return this._isDefault}get_AssociatedEntityLogicalName(){return this._associatedEntityLogicalName}get_DisplayName(){return this._displayName}get_metadata(){if(!Object(i.a)(this._descriptorData)){if(this._metadataType===a.a.fetchXml)return this.get_descriptorSet().tryGetDescriptor(l.a.FetchXml);if(this._metadataType!==a.a.layoutXml&&this._metadataType!==a.a.webResource&&this._metadataType!==a.a.businessLogic&&this._metadataType!==a.a.staticJSFile&&this._metadataType!==a.a.applicationMetadataUserContext)return this.get_descriptorSet().tryGetDescriptor(0)}return this._descriptorData}get_descriptorSet(){if(!this._isDescriptorDataDeserialized){if(this._metadataType!==a.a.layoutXml&&this._metadataType!==a.a.webResource&&this._metadataType!==a.a.businessLogic&&this._metadataType!==a.a.staticJSFile&&this._metadataType!==a.a.applicationMetadataUserContext&&this._metadataType!==a.a.commandXaml){const e=this._metadataType!==a.a.fetchXml||f.a.get_instance().get_offlineDataSource().isEntityAvailableForOfflineUsage(this.get_AssociatedEntityLogicalName());if(this._descriptorData=u.a.createDescriptorSet(JSON.parse(this._descriptorData),this._metadataType,e),this.get_metadataType()===a.a.fetchXml){let e=this._descriptorData.tryGetDescriptor(l.a.Sql);if(!Object(i.b)(e))if(f.a.get_instance().verifyIfLinkedEntitiesOfflineEnabled(this._descriptorData.tryGetDescriptor(l.a.FetchXml))){if(this.get_metadataSubtype()!==r.a.advancedFind){if(e=e.replace('"!eq-userid!"',"'"+p.a.get_DefaultInstance().get_UserContext().get_UserId().toString()+"' COLLATE NOCASE"),this.get_AssociatedEntityLogicalName()===g.j){const t="6";e=e.replace("@LanguageId0",p.a.get_DefaultInstance().get_UserContext().get_UserSettings().get_languageId().toString()),e=e.replace("@LanguageId1",p.a.get_DefaultInstance().get_UserContext().get_organizationSettings().get_languageCode().toString()),e=e.replace("@ObjectColumnName0",t),e=e.replace("@ObjectColumnName1",t)}this._descriptorData.updateDescriptorSet(l.a.Sql,e)}}else this._descriptorData.updateDescriptorSet(l.a.Sql,null)}}this._isDescriptorDataDeserialized=!0}return this._descriptorData}get_sourceId(){return this._sourceId}get_isUserRecord(){return this._isUserRecord}getObjectData(){const e={};e[s.a]=this._id,e[s.j]=this._metadataType,e[s.i]=this._metadataSubtype,e[s.f]=this._formFactor,e[s.b]=this._associatedEntityLogicalName,e[s.k]=this._sourceId,e[s.g]=this._isDefault,this._isDescriptorDataDeserialized&&this._metadataType!==a.a.layoutXml&&this._metadataType!==a.a.webResource&&this._metadataType!==a.a.businessLogic&&this._metadataType!==a.a.staticJSFile?e[s.c]=JSON.stringify(this._FormatDescriptorSetToSerialize(this.get_descriptorSet())):e[s.c]=this._descriptorData,e[s.d]=this._dependencyData,e[s.e]=this._displayName,e[s.h]=this._isUserRecord,y.metadataTypeKeyPath.get_path()!==s.j&&(e[y.metadataTypeKeyPath.get_path()]=this._metadataType);const t=this._metadataType.toString(),n=this._sourceId;Object(i.a)(n)?e[y.metadataTypeSourceIdKeyPath.get_path()]="":e[y.metadataTypeSourceIdKeyPath.get_path()]=t+d.a+n;const r=this._associatedEntityLogicalName;if(Object(i.a)(r)||Object(i.a)(this.get_metadataSubtype()))e[y.metadataTypeMetadataSubtypeAssociatedEntityLogicalNameKeyPath.get_path()]="";else{const n=this._metadataSubtype.toString();e[y.metadataTypeMetadataSubtypeAssociatedEntityLogicalNameKeyPath.get_path()]=t+d.a+n+d.a+r}Object(i.a)(r)?e[y.metadataTypeAssociatedEntityLogicalNameKeyPath.get_path()]="":e[y.metadataTypeAssociatedEntityLogicalNameKeyPath.get_path()]=t+d.a+r;const o=this._displayName;return Object(i.a)(o)?e[y.metadataTypeNormalizedDisplayNameKeyPath.get_path()]="":e[y.metadataTypeNormalizedDisplayNameKeyPath.get_path()]=t+d.a+o.toUpperCase(),e}getDescriptor(){return this._descriptorData}_FormatDescriptorSetToSerialize(e){if(l.a[0]in e.get_descriptors())return e.get_descriptors()[l.a[0]].Data;const t=[];let n=0;for(const r of Object.keys(e.get_descriptors()))t[n]=new c.a(e.get_descriptors()[r].Format,e.get_descriptors()[r].Data),n++;return t}static extractKey(e){return e[s.a]}static createFromObjectData(e){return new y(e)}}y.metadataTypeKeyPath=new h.a(s.j),y.metadataTypeSourceIdKeyPath=new h.a(s.j+d.a+s.k),y.metadataTypeAssociatedEntityLogicalNameKeyPath=new h.a(s.j+d.a+s.b),y.metadataTypeMetadataSubtypeAssociatedEntityLogicalNameKeyPath=new h.a(s.j+d.a+s.i+d.a+s.b),y.metadataTypeNormalizedDisplayNameKeyPath=new h.a(s.j+d.a+s.e)},"3ybi":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class r{constructor(e,t,n){this.Target=e,this.ProcessId=t,this.ProcessInstanceId=n}getMetadata(){return{boundParameter:null,parameterTypes:{Target:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5},ProcessId:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5},ProcessInstanceId:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5}},operationName:"RetrieveProcessControlData",operationType:1}}}},"3yqi":function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e.Dashboard="Dashboard",e.Dialog="Dialog",e.ModalDialog="ModalDialog",e.EditForm="EditForm",e.QuickCreateForm="QuickCreateForm",e.PowerBIFullScreen="PowerBIFullScreen",e.Search="Search",e.TaskBasedFlow="TaskBasedFlow",e.WebResource="WebResource",e.Grid="EntityList",e.CustomControl="Control"}(r||(r={}))},"47MF":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("5yoC");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class a extends r.a{constructor(e,t){super(),this._outerQuery=null,this._subQueries=null,this._outerQuery=e,this._subQueries=t}get_name(){return"RetrieveEntitiesForAggregateQuery"}get_outerQuery(){return this._outerQuery}get_subQueries(){return this._subQueries}}},"49Vs":function(e,t,n){"use strict";n.d(t,"a",(function(){return _}));var r=n("KBcj"),a=n("x0oY"),i=n("d0w6"),o=n("tHtE"),s=n("LbMF"),c=n("iZ7K"),l=n("eXjw");function u(e,t,n,r,i,o){if(t&&n&&Object(c.l)(e,i)===l.a.Initialized){return Object(a.d)(e,o,t,n,null,null,null,r)}}function d(e,t){let n=null;const a=Object(r.a)(e,t,i.a.QUICKFIND_SEARCH);if(a){const t=Object(r.c)(e,a);t&&t.fetchXML&&(n=Object(o.d)(e,t.fetchXML))}return n||(n={aliasedValueDescriptors:{},entity2AttributesMap:{}}),n}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const p=[function(){const e={},t={};return{checkEntity:(e,t)=>"activitypointer"===t||Object(c.r)(e,t),deserialize:(n,r="activitypointer",a,i)=>u(n,Object(c.h)(n,a),e[r]||(e[r]=Object(s.d)(n,r)),t[r]||(t[r]=d(n,r)),a,i)}},function(){const e={},t={},n={};return{checkEntity:(e,t)=>!0,deserialize:(r,a,i,o)=>u(r,t[i]||(t[i]=Object(c.h)(r,i)),e[i]||(e[i]=Object(s.d)(r,i)),n[i]||(n[i]=d(r,i)),i,o)}}];var f=n("Jz1I"),g=n("c46F"),h=n("wMH2"),m=n("a1q1"),b=n("WF3G");const y=/#Microsoft.Dynamics.CRM./gi;function _(e,t){return{type:"DESERIALIZE_EXECUTEQUICKFIND_ASYNC",execute:({getState:n})=>e.json().then(e=>{const r=n(),a=e.Result,i=function(){const e=[];for(const t of p){const n=t();e.push(n)}return e}(),o=[],s=t&&t.get_entityNames();for(let e=0;e<a.length;e++){const t=a[e];let n=s&&s[e];const c=!!n,l=[],u=t.Data;if(u.length>0){let e;for(const t in u){const a=u[t],o=v(a);if(c||(n=o),!e)for(const t of i)if(t.checkEntity(r,n)){e=t;break}const s=e.deserialize(r,c?n:null,o,a);s&&l.push(s)}}const d=new g.a(n,new h.a(l,!1,l.length,!1,new b.a("")),t.ErrorCode);o.push(d)}return new f.a(new m.a(o))})}}function v(e){const t=e["@odata.type"];return t&&t.replace(y,"")}},"4Gtd":function(e,t,n){"use strict";n.d(t,"g",(function(){return i})),n.d(t,"k",(function(){return o})),n.d(t,"h",(function(){return s})),n.d(t,"f",(function(){return c})),n.d(t,"e",(function(){return l})),n.d(t,"j",(function(){return u})),n.d(t,"l",(function(){return d})),n.d(t,"i",(function(){return p})),n.d(t,"d",(function(){return f})),n.d(t,"m",(function(){return g})),n.d(t,"a",(function(){return h})),n.d(t,"c",(function(){return m})),n.d(t,"b",(function(){return b}));var r=n("a475"),a=n("UDbe");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i="__OBJECTSTORE",o="__VERSIONS",s="StoreName",c="IndexKeyPath",l="IndexName",u="EntityName",d="VersionName",p="db",f="json",g=500,h="Exception occurred on a transaction callback. ",m=a.a.get_id().get_path();function b(){return r.a.get_Instance().get_device().get_DeviceState().get_deviceMemoryRestricted()?10:50}},"4N6w":function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e){if(e&&e.authentication)return e.authentication.token}function a(e){if(e&&e.authentication)return e.authentication.objectid}function i(e){if(e&&e.authentication)return e.authentication.tenantid}function o(e){if(e&&e.authentication)return e.authentication.reauthfailed}function s(e){var t;return null===(t=e.authentication)||void 0===t?void 0:t.cookiesblocked}n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"e",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"b",(function(){return s}))},"4RdG":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={compositionstart:"Composition",compositionupdate:"Composition",compositionend:"Composition",resize:"Resize",scroll:"Scroll",wheel:"Scroll",keydown:"Key",keypress:"Key",mousedown:"Click",auxclick:"Click",click:"Click",dblclick:"Click",contextmenu:"Click",touchstart:"Click",pointerdown:"Click"},a=function(){function e(){var e=this;this._userInteractions={},Object.keys(r).forEach((function(t){return document.addEventListener(t,(function(){var n=r[t];n in e._userInteractions?e._userInteractions[n].push(performance.now()):e._userInteractions[n]=[performance.now()]}))}),!0)}return e.prototype.resetTracking=function(){this._userInteractions={}},e.prototype.userInteractions=function(){return this._userInteractions},e}();t.default=a},"4aOd":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("31Vn");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class a{constructor(e){const{functionName:t,functionNameNoClassName:n,urlString:a,line:i,column:o}=function(e){let t="anonymous",n="unknown",a=-1,i=-1;const o="   at ";if(e)if(e.startsWith("BrowserErrorHandler.InternalGetStackTrace"))t=e.trim();else if(e.startsWith(o))t=(e=e.slice(o.length)).trim();else{const o=function(e){const t=e.indexOf("("),n=e.indexOf("@");let r;if(-1===t&&-1===n)return-1;r=t>-1?t:n;return r}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(e=function(e){const t="    at ";e.startsWith(t)&&(e=e.slice(t.length));const n="Function.";e.startsWith(n)&&(e=e.slice(n.length));return e}(e));o>-1&&(t=e.slice(0,o).trim());const s=function(e){let t,n=-1,a=-1;const i=e.lastIndexOf(":");if(i>-1){const r=e.slice(0,i),o=e.slice(i+1);a=parseInt(o,10);const s=r.lastIndexOf(":");if(s>-1){t=r.slice(0,s);const e=r.slice(s+1);n=parseInt(e,10)}else t=r}else t=e;return{url:Object(r.a)(t),line:n,column:a}}(function(e,t){let n;n=t>-1?e.slice(t+1):e;return n=n.replace(/\)$/,""),n}(e,o));n=s.url,a=s.line,i=s.column}else;const s=t.lastIndexOf("."),c=s>=0&&s<t.length-1?t.substring(s+1):t;return{functionName:t,functionNameNoClassName:c,urlString:n,line:a,column:i}}(e);this.functionName=t,this.functionNameNoClassName=n,this.urlString=a,this.line=i,this.column=o}toString(){const{functionName:e,urlString:t,line:n,column:r}=this;return` at ${e} (${t}${n>-1?`:${n}:${r}`:""})`}}class i{constructor(e){this._stackTrace=this._internalGetStackTrace(e)}getFunctionName(){const e=this._stackTrace.length?this._stackTrace[0].functionName:"anonymous",t=e.indexOf("$",0);if(-1===t)return"anonymous";const n=e.indexOf("$",t+1);if(-1===n)return e;const r=e.indexOf("$",n+1);return-1===r?e:e.slice(n+1,r-t)}getStackTrace(){return this._stackTrace.join("\n")}_removeErrorMessageFromStack(e,t){t.length>0&&t[0].indexOf(e)>-1&&t.shift()}_internalGetStackTrace(e){if(null==e)return[new a("BrowserErrorHandler.InternalGetStackTrace: Error is null or undefined.")];const t=e.stack;if(null==t)return[new a("BrowserErrorHandler.InternalGetStackTrace: Stack trace is null or undefined.")];const n=t.split("\n"),r=e.message;this._removeErrorMessageFromStack(r,n);const i=[];for(const e of n)""!==e&&i.push(new a(e));return i}}},"4ciL":function(e,t,n){"use strict";n.d(t,"c",(function(){return j})),n.d(t,"b",(function(){return P})),n.d(t,"a",(function(){return T})),n.d(t,"d",(function(){return A})),n.d(t,"e",(function(){return N}));var r=n("odYE"),a=n("Uv1Y"),i=n("SRlt"),o=n("f07+"),s=n("eeMP"),c=n("l0Rp"),l=n("w72X"),u=n("sNgR"),d=n("aRLb"),p=n("Hevb"),f=n("O4uv"),g=n("01Vp"),h=n("ATrR"),m=n("iZ7K"),b=n("NvOS"),y=n("vF3j"),_=n("g22U");function v(e,t,n,r,a={},o){const s=r.map(r=>function(e,t,n,r,a,o){if(!(e&&t&&n&&r))return{serializationFailure:"Cannot serialize associate request. All parameters are mandatory, but some were passed in empty"};const s=Object(m.o)(e,t.etn);s||null==o||o.warn(`The entity set name of ${t.etn} in _constructSingleAssociateRequest is null or undefined!`);const c=Object(m.o)(e,r.etn);c||null==o||o.warn(`The entity set name of ${r.etn} in _constructSingleAssociateRequest is null or undefined!`);const{navigationProperty:l,method:u,serializationFailure:d}=Object(y.a)(e,t.etn,n);if(d)return{serializationFailure:d};const p=Object(_.g)(a);return{urlParameters:`${s}(${t.id.guid})/${l}/$ref`,body:JSON.stringify({"@odata.context":new URL(Object(b.a)(e,i.c.WEB_API_URL_FRAGMENT)+"$metadata#$ref",window.location.origin).href,"@odata.id":`${c}(${r.id.guid})`}),additionalHeaders:{Accept:i.a},method:u,additionalParameters:{[_.a.TYPE]:_.d.UPDATE,[_.a.SUB_TYPE]:_.c.Associate,[_.a.SOURCE]:p}}}(e,t,n,r,a,o));return 1===s.length?s[0]:Object(c.a)(e,s)}var S=n("iEjf");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var O=n("pEXn"),C=n("SAYH"),E=n("4r2D"),I=n("z+5+"),w=n("23jc");function j(e){const t=[];return{type:"executeOData.batch.async",async execute({dispatch:n,getState:r},o){const l=new E.a(C.a.newGuid().guid);t.push({name:O.b.ClientRequestId,value:l&&l.RequestId?l.RequestId():null});const u=Object(c.a)(r(),e);if(u.serializationFailure)throw new a.a("Cannot serialize request: "+u.serializationFailure);i.c.AddRequestId(u,l&&l.RequestId?l.RequestId():C.a.newGuid().guid);const d=await n(Object(w.a)(u,_.d.Execution_Multiple));return Object(s.b)(d)},getFailureParameters:(e,n)=>t}}function P(e,t={},n){return{type:"executeOData.batch.async",execute({dispatch:r,getState:i},c){const l=new o.f(e);return r(Object(d.e)(n,...e)).then(()=>{if(Object(I.r)(i(),l)){return c.DataSource.executeOData(l,null,void 0,void 0,t).nativePromise().then(e=>Object(s.b)(e))}const n=i();let o=null;const u=e.map(e=>{if(N(e)){const r=T(n,e,t);return r.serializationFailure&&(o=r.serializationFailure),r}if(A(e))return e.map(e=>{const r=T(n,e,t);return r.serializationFailure&&(o=r.serializationFailure),r});throw Error("value should be of type odatacontract or Changeset")});if(o)throw new a.a("Cannot serialize request: "+o);return r(j(u))})}}}function T(e,t,n={},a,o){if(!t)return{serializationFailure:"Cannot build the serialized request: the request object is empty"};if(!t.getMetadata())return{serializationFailure:"Cannot build the serialized request: the request object does not contain metadata definition"};switch(t.getMetadata().operationType){case 0:return Object(l.a)(e,t,n,o);case 1:return Object(u.a)(e,t,n,o);case 2:return function(e,t,n={},a,o){switch(t.getMetadata().operationName){case"Create":{const r=t;return Object(f.c)(e,r.etn,r.payload,r.suppressDupeDetection,r.returnRowVersion,r.offlineData,n,o,r.solutionUniqueName)}case"Retrieve":{const a=t,i=r.a.fromExternalEntityReference(a.entityReference);return Object(h.a)(e,i,a.columns,void 0,a.navigationPropertyDetails,n,o)}case"RetrieveWithUrlParams":{const r=t;return Object(h.b)(e,r.etn,r.id,r.urlParams,r.maxPageSize,r.headers,r.isBinary,n,a,o)}case"Update":{const r=t;return Object(p.a)(e,r.etn,r.id,r.payload,r.suppressDupeDetection,r.ifMatch,r.returnRowVersion,r.urlParams,r.headers,r.isBinaryPayload,r.offlineData,n,o,r.solutionUniqueName)}case"Delete":{const a=t,i=r.a.fromExternalEntityReference(a.entityReference);return Object(g.a)(e,i,a.ifMatch,a.attributeName,a.offlineData,n,o)}case"DeleteWithUrlParams":{const r=t;return Object(g.b)(e,r.etn,r.id,null,r.urlParams,r.ifMatch,r.offlineData,n)}case"Associate":{const a=t,i=r.a.fromExternalEntityReference(a.target),s=a.relatedEntities.map(r.a.fromExternalEntityReference);return v(e,i,a.relationship,s,n,o)}case"Disassociate":{const a=t,i=r.a.fromExternalEntityReference(a.target);return Object(S.a)(e,i,a.relationship,a.relatedEntityId,n,o)}case"EntityDefinitions":return function(e,t={}){let n="";if(!e.query&&!e.columns&&!e.filter)return{serializationFailure:"Cannot serialize entity definition request. All the passed in parameters are empty or invalid."};if(e.query)n="EntityDefinitions"+e.query;else{const t=e.columns?"$select="+e.columns.join(","):"";let r=e.filter?e.filter:"";e.columns&&e.filter&&(r="&"+r),n=`EntityDefinitions?${t}${r}`}const r=Object(_.g)(t);return{urlParameters:n,additionalHeaders:{Accept:i.a},method:"GET",additionalParameters:{[_.a.TYPE]:_.d.ENTITY_DEFINITION,[_.a.SUB_TYPE]:_.c.EntityDefinition,[_.a.SOURCE]:r}}}(t,n);default:return{serializationFailure:`Cannot convert ODataContract with ${t.getMetadata().operationName} operation into a serialized request`}}}(e,t,n,a,o)}}function N(e){return e&&e.getMetadata}function A(e){return e&&Array.isArray(e)&&e.length>0&&e[0].getMetadata}},"4gfk":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="mobilenative"},"4leG":function(e,t,n){"use strict";function r(e){if(e&&e.configuration)return e.configuration.navbar}function a(e){if(e&&e.configuration)return e.configuration.themeOption}function i(e){if(e&&e.configuration)return e.configuration.cmdbar}function o(e){return!(!e||!e.configuration)&&e.configuration.isPreviewMode}function s(e){return!(!e||!e.configuration)&&e.configuration.isEmbedded}function c(e){return!(!e||!e.configuration)&&e.configuration.isD365DefaultApp}function l(e){return s(e)}function u(e){return!(!e||!e.configuration)&&e.configuration.playedFromAppDesigner}n.d(t,"f",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return s})),n.d(t,"e",(function(){return o})),n.d(t,"b",(function(){return c})),n.d(t,"h",(function(){return a})),n.d(t,"d",(function(){return l})),n.d(t,"g",(function(){return u}))},"4m6s":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("3BuU"),a=n("Sq7X"),i=n("RHUE"),o=n("nZ7Q"),s=n("E+70"),c=n("Ri7K"),l=function(){function e(e,t,n,i){this._queueSizeLimit=t,this._isCurrentlyUploadingNow=!1,this._uploadNowQueue=[],this._shouldDropEventsOnPause=!1,this._paused=!1,this._queueSize=0,this._outboundQueue=[],this._inboundQueues={},this._inboundQueues[r.AWTEventPriority.High]=[],this._inboundQueues[r.AWTEventPriority.Normal]=[],this._inboundQueues[r.AWTEventPriority.Low]=[],this._addEmptyQueues(),this._batcher=new o.default(this._outboundQueue,500),this._httpManager=new a.default(this._outboundQueue,e,this,n,i)}return e.prototype.addEvent=function(e){c.isPriority(e.priority)||(e.priority=r.AWTEventPriority.Normal),e.priority===r.AWTEventPriority.Immediate_sync?this._httpManager.sendSynchronousRequest(this._batcher.addEventToBatch(e),e.apiKey):this._queueSize<this._queueSizeLimit||this._dropEventWithPriorityOrLess(e.priority)?this._addEventToProperQueue(e):s.default.eventsDropped([e],r.AWTEventsDroppedReason.QueueFull)},e.prototype.sendEventsForPriorityAndAbove=function(e){this._batchEvents(e),this._httpManager.sendQueuedRequests()},e.prototype.hasEvents=function(){return(this._inboundQueues[r.AWTEventPriority.High][0].length>0||this._inboundQueues[r.AWTEventPriority.Normal][0].length>0||this._inboundQueues[r.AWTEventPriority.Low][0].length>0||this._batcher.hasBatch())&&this._httpManager.hasIdleConnection()},e.prototype.addBackRequest=function(e){if(!this._paused||!this._shouldDropEventsOnPause){for(var t in e)if(e.hasOwnProperty(t))for(var n=0;n<e[t].length;++n)e[t][n].sendAttempt<6?this.addEvent(e[t][n]):s.default.eventsDropped([e[t][n]],r.AWTEventsDroppedReason.MaxRetryLimit);i.default.scheduleTimer()}},e.prototype.teardown=function(){this._paused||(this._batchEvents(r.AWTEventPriority.Low),this._httpManager.teardown())},e.prototype.uploadNow=function(e){var t=this;this._addEmptyQueues(),this._isCurrentlyUploadingNow?this._uploadNowQueue.push(e):(this._isCurrentlyUploadingNow=!0,setTimeout((function(){return t._uploadNow(e)}),0))},e.prototype.pauseTransmission=function(){this._paused=!0,this._httpManager.pause(),this._shouldDropEventsOnPause&&(this._queueSize-=this._inboundQueues[r.AWTEventPriority.High][0].length+this._inboundQueues[r.AWTEventPriority.Normal][0].length+this._inboundQueues[r.AWTEventPriority.Low][0].length,this._inboundQueues[r.AWTEventPriority.High][0]=[],this._inboundQueues[r.AWTEventPriority.Normal][0]=[],this._inboundQueues[r.AWTEventPriority.Low][0]=[],this._httpManager.removeQueuedRequests())},e.prototype.resumeTransmission=function(){this._paused=!1,this._httpManager.resume()},e.prototype.shouldDropEventsOnPause=function(e){this._shouldDropEventsOnPause=e},e.prototype._removeFirstQueues=function(){this._inboundQueues[r.AWTEventPriority.High].shift(),this._inboundQueues[r.AWTEventPriority.Normal].shift(),this._inboundQueues[r.AWTEventPriority.Low].shift()},e.prototype._addEmptyQueues=function(){this._inboundQueues[r.AWTEventPriority.High].push([]),this._inboundQueues[r.AWTEventPriority.Normal].push([]),this._inboundQueues[r.AWTEventPriority.Low].push([])},e.prototype._addEventToProperQueue=function(e){this._paused&&this._shouldDropEventsOnPause||(this._queueSize++,this._inboundQueues[e.priority][this._inboundQueues[e.priority].length-1].push(e))},e.prototype._dropEventWithPriorityOrLess=function(e){for(var t=r.AWTEventPriority.Low;t<=e;){if(this._inboundQueues[t][this._inboundQueues[t].length-1].length>0)return s.default.eventsDropped([this._inboundQueues[t][this._inboundQueues[t].length-1].shift()],r.AWTEventsDroppedReason.QueueFull),!0;t++}return!1},e.prototype._batchEvents=function(e){for(var t=r.AWTEventPriority.High;t>=e;){for(;this._inboundQueues[t][0].length>0;){var n=this._inboundQueues[t][0].pop();this._queueSize--,this._batcher.addEventToBatch(n)}t--}this._batcher.flushBatch()},e.prototype._uploadNow=function(e){var t=this;this.hasEvents()&&this.sendEventsForPriorityAndAbove(r.AWTEventPriority.Low),this._checkOutboundQueueEmptyAndSent((function(){t._removeFirstQueues(),null!=e&&e(),t._uploadNowQueue.length>0?setTimeout((function(){return t._uploadNow(t._uploadNowQueue.shift())}),0):(t._isCurrentlyUploadingNow=!1,t.hasEvents()&&i.default.scheduleTimer())}))},e.prototype._checkOutboundQueueEmptyAndSent=function(e){var t=this;this._httpManager.isCompletelyIdle()?e():setTimeout((function(){return t._checkOutboundQueueEmptyAndSent(e)}),250)},e}();t.default=l},"4r2D":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("rWW8");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class a extends r.a{constructor(e,t,n){super(e,null,n),this._isPreloadCall=!1,this.requestId=e,this._isPreloadCall=t}RequestId(){return this.requestId}IsPreloadCall(){return this._isPreloadCall}toString(){return"["+this.RequestId()+"]"}}},"504W":function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return c}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r=/(http|https):\/\/(\w+:{0,1}\w*)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%!\-\/]))?/,a=/(dynamicsxrm):\/\/(\w+:{0,1}\w*)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%!\-\/]))?/,i=/^\/([0-9a-zA-Z_]+\/)?main.aspx/;function o(e){return null==e}function s(e){return!!o(e)||"string"==typeof e&&""===e.trim()}function c(e){return r.test(e)||a.test(e)||i.test(e)}},"5DN6":function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"d",(function(){return l}));var r=n("jq7Z"),a=n("y60j"),i=n("zmL5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function o(e,t){const n=Object(r.a)(e,t);return null==n?void 0:n.referencePanel}function s(e,t,n){const r=o(e,n);if(!r)return"";const s=r.activeTabId,c=l(e,n);if(t<0||t>=c.length)return s;if(c.length>0&&c[t].id!==s)return s;if(0===t){if(1===c.length){if(0===r.controlNames.length)return"";const t=Object(i.b)(e,n),o=Object(a.a)(e,n,t,r.controlNames[0]);return null==o?void 0:o.Id}if(c.length>1)return c[1].id}else if(t>0)return c[t-1].id}function c(e,t){var n;const r=o(e,t),s=Object(i.b)(e,t);return r&&r.controlNames.length>0?null===(n=Object(a.a)(e,t,s,r.controlNames[0]))||void 0===n?void 0:n.Id:""}function l(e,t){var n,r;return null!==(r=null===(n=o(e,t))||void 0===n?void 0:n.sessionTabs)&&void 0!==r?r:[]}},"5KQF":function(e,t,n){"use strict";n.d(t,"a",(function(){return z}));var r=n("vmcK");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e){const t={};if(e&&e.length>0){const n=e.split(";");for(const e of n)if(e&&e.length>0){const n=e.split(":");if(n&&n.length>1){const e=n[0];let r,a=!1;switch(n[1].toLowerCase()){case"true":r=!0,a=!0;break;case"false":r=!1,a=!0}if(a)switch(e.toLowerCase()){case"displaycommandbar":t.displayCommandBar=r;break;case"displayviewselector":t.displayViewSelector=r;break;case"displayindex":t.displayIndex=r;break;case"displayquickfind":t.displayQuickFind=r;break;case"displaypaging":t.displayPaging=r}}}}return t}function i(e){const t={},n={},r=[],i=[];if(e){let o=!1;for(const n of e.Properties){const e=n.Usage;0===e&&(o=!0);const r={Required:n.Required,DefaultValue:n.DefaultValue,Usage:e};t[n.Name]=r}if(e.DataSets){let t=!o;for(const r of e.DataSets){const e={};for(const t of r.Columns){const n={Required:t.Required,DefaultValue:t.DefaultValue,Usage:t.Usage};e[t.Name]=n}const i={DisplayName:r.DisplayName,Type:r.Type,Columns:e,Primary:t,InitialDataSetFetch:r.InitialDataSetFetch,CDSDataSetOptions:a(r.CDSDataSetOptions)};n[r.Name]=i,t=!1}}for(const t of e.Resources){const e={Name:t.Name,LoadOrder:t.LoadOrder,Type:t.Type,LibraryName:t.LibraryName};r.push(e)}if(e.FeatureUsage)for(const t of e.FeatureUsage){const e={Name:t.Name,Type:t.Type,IsRequired:t.IsRequired};i.push(e)}}return{Resources:r,GroupDefinitions:{},DataSetDefinitions:n,Properties:t,FeatureUsage:i}}var o=n("1pQz"),s=n("Lr+c");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function c(e){const t={};return t[r.a]={PrimaryEntityLogicalName:e.PrimaryEntityLogicalName,BusinessLogic:e.BusinessLogic},t}var l=n("eXjw"),u=n("fC8v"),d=n("vSoM");var p=n("SAYH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var f=n("olXY"),g=n("+VD1"),h=n("EU8S");var m,b=n("g0tL");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function y(e){const t={};for(const n in e)t[n]=_(e[n]);return t}function _(e){const t=[];return 0!=(e&m.NoQuickCreateForm)&&t.push("There is no quick create form available for the entity. Contact the entity owner to make sure there is a quick create form added."),0!=(e&m.NotAllowedForQuickCreate)&&t.push("The entity is not enabled for quick create. Contact the entity owner to enable it."),0!=(e&m.NotEnabledForUnifiedClient)&&t.push("The entity is not enabled for Unified Client. Contact the entity owner to enable it."),0!=(e&m.ReadOnlyInUnifiedClient)&&t.push("The entity is read-only in Unified Client. Contact the entity owner to change the settings."),0!=(e&m.CannotModifyMobileClientVisibility)&&t.push("The entity's mobile client visibility cannot be modified. Contact the entity owner to fix it."),0!=(e&m.MissingFromAppModule)&&t.push("The entity is not part of the app module. Contact the app owner to add the entity."),0!=(e&m.NoCreatePrivilege)&&t.push("The user does not have a create privilege on the entity. Contact the administrator to change the privileges for the user."),0!=(e&m.CreatePrivilegeNotSupported)&&t.push("The create privilege is not supported for the entity. Contact the entity owner to enable it."),t}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */!function(e){e[e.None=0]="None",e[e.NoQuickCreateForm=1]="NoQuickCreateForm",e[e.NotAllowedForQuickCreate=2]="NotAllowedForQuickCreate",e[e.NotEnabledForUnifiedClient=4]="NotEnabledForUnifiedClient",e[e.ReadOnlyInUnifiedClient=8]="ReadOnlyInUnifiedClient",e[e.CannotModifyMobileClientVisibility=16]="CannotModifyMobileClientVisibility",e[e.MissingFromAppModule=32]="MissingFromAppModule",e[e.NoCreatePrivilege=64]="NoCreatePrivilege",e[e.CreatePrivilegeNotSupported=128]="CreatePrivilegeNotSupported"}(m||(m={}));var v=n("+QYJ"),S=n("fh2P"),O=n("wL2W");function C(e,t,n,r,a){if(!t)return null;const i=[],o=function(e){let t=null;for(const n of e)if(n.Relationships){return t={relationships:I(n.Relationships)},t}if(!t&&e.length>=2&&e[0].EntityLogicalName&&e[1].EntityLogicalName){const n=e[0],r=e[1];if(n.EntityLogicalName!==r.EntityLogicalName&&n.RelationshipName&&n.ReferencingAttributeName&&n.Stage&&r.Stage){const e={sourceStageId:p.a.tryParse(n.Stage.StageId),targetStageId:p.a.tryParse(r.Stage.StageId),attributeName:n.ReferencingAttributeName,relationshipName:n.RelationshipName},a=[];a.push(e),t={relationships:a}}}return t}(t);o&&i.push(o);for(const s of t)if(s.EntityDisplayName){const t=s;let c=[];r[t.EntityLogicalName]||(r[t.EntityLogicalName]={},a.entitiesAndAttributes[t.EntityLogicalName]||(a.entitiesAndAttributes[t.EntityLogicalName]=[]),c=a.entitiesAndAttributes[t.EntityLogicalName]);const l={entityDisplayName:t.EntityDisplayName,entityLogicalName:t.EntityLogicalName,relationshipName:t.RelationshipName,referencingAttributeName:t.ReferencingAttributeName,isClosedLoop:t.IsClosedLoop,attributeFieldNames:t.AttributeFieldNames,stage:w(e,t.Stage,n,r[t.EntityLogicalName],a.labelIdsAndColumnNames,c)},u=E(t.Stage,o);u&&l&&(l.relationshipName||(l.relationshipName=u.relationshipName),l.referencingAttributeName||(l.referencingAttributeName=u.attributeName)),i.push(l)}return i}function E(e,t){if(!e||!t)return null;for(const n of t.relationships)if(p.a.equals(p.a.parse(e.StageId),n.targetStageId))return n;return null}function I(e){if(!e)return null;const t=[];for(const n of e){const e={sourceStageId:p.a.tryParse(n.SourceStageId),targetStageId:p.a.tryParse(n.TargetStageId),attributeName:n.AttributeName,relationshipName:n.RelationshipName};t.push(e)}return t}function w(e,t,n,r,a,i){if(!t)return null;let o=Object(b.c)(e,t.LabelId,null,null,null,n,null,null,"description");o||(o=t.StageDisplayName),a.push(t.LabelId+":description");return{stageId:p.a.tryParse(t.StageId),name:t.Name,stageLogicalName:t.StageLogicalName,stageDisplayName:o,stageCategory:t.StageCategory,nextStageId:t.NextStageId?p.a.tryParse(t.NextStageId):null,conditionJson:t.ConditionJson,data:t.Data,steps:j(e,t.Steps,n,r,a,i)}}function j(e,t,n,r,a,i){if(!t)return null;const o=[];for(const s of t){if(!s.Name)continue;let t=Object(b.c)(e,s.LabelId,null,null,null,n,null,null,"description");t||(t=s.Label),a.push(s.LabelId+":description");let c=s.StepType;Object(v.b)(c)||(c=c.toLowerCase(),"action"!==c&&"modernflow"!==c&&i.push(s.Name));const l={stepId:p.a.tryParse(s.StepId),name:s.Name,enabled:s.Enabled,required:s.Required,label:t,controlName:P(s,t,r),viewId:s.ViewId,stepType:s.StepType};o.push(l)}return o}function P(e,t,n){const r=function(e,t){if(!e)return null;t||(t={});return Object(S.e)(e.Name,null,t)}(e,n);if(r){const a={defaultviewid:e.ViewId},i={Id:e.StepId,Label:t,Name:r,ShowLabel:!0,Visible:!0,Disabled:!e.Enabled,DataFieldName:e.Name,UniqueId:e.StepId,ClassId:p.a.tryParse(e.ClassId),DomId:r,Parameters:a};n[i.Name]=i}return r}function T(e){if(!e)return null;const t={};for(const n of e){const e={entityName:n.EntityName,businessRuleAttributes:N(n.BusinessRuleAttributes)};t[e.entityName]=e}return t}function N(e){if(!e)return null;const t={};for(const n of e){const e={attributeName:n.AttributeName,customJavascriptFunctions:n.CustomJavascriptFunctions};t[e.attributeName]=e}return t}function A(e,t){if(!e)return null;const n={};for(const r of e){let e,a;if(0===r.ActionType){if(!t)return null;for(const n of t)if(!Object(v.b)(r.UniqueName)){const t=r.UniqueName.indexOf("_");if((t>0?r.UniqueName.substring(t+1):r.UniqueName)===n.CustomOperationUniqueName){e=R(n.InputParameters),a=R(n.OutputParameters);break}}}const i=r.InputParameterBindings.map(e=>({parameterName:e.ParameterName,boundAttributeName:e.BoundAttributeName,parameterType:e.ParameterType,parameterStructuralProperty:D(e.ParameterStructuralProperty)})),o=r.OutputParameterBindings.map(e=>({parameterName:e.ParameterName,boundAttributeName:e.BoundAttributeName,parameterType:e.ParameterType,parameterStructuralProperty:D(e.ParameterStructuralProperty)})),s={processActionMessageName:S.c+r.ProcessActionMessageName,inputParameters:e,outputParameters:a,inputBindings:i,outputBindings:o,workflowId:r.WorkflowId,actionType:r.ActionType,uniqueName:r.UniqueName,actionId:r.ActionId};n[s.processActionMessageName]=s}return n}function R(e){if(!e)return null;const t={};for(const n in e){const r={parameterName:e[n].ParameterName,parameterStructuralProperty:D(e[n].ParameterStructuralProperty),parameterType:e[n].ParameterType};t[r.parameterName]=r}return t}function D(e){switch(e){case"Primitive":return 1;case"Complex":return 2;case"Enumeration":return 3;case"Collection":return 4;case"Entity":return 5;default:return 0}}function x(e){if(!e)return null;const t={};for(const n of e){const e={workflowId:n.WorkflowId,uniqueName:n.UniqueName,actionId:n.ActionId};t[n.ActionId]=e}return t}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function M(e){if(!e)return null;const t={initialized:l.a.Initialized,formId:new p.a(e.FormId),uniqueName:e.UniqueName,displayName:e.DisplayName,imageUrl:e.ImageUrl,primaryModelName:e.PrimaryModelName,properties:e.Properties,workFlowId:e.WorkFlowId,description:e.Description,defaultNextPageByTabName:e.DefaultNextPageByTabName,versionNumber:e.VersionNumber,overallVersionNumber:e.OverallVersionNumber};if(e.Labels){const n=e.Labels.filter(e=>e.Id===t.workFlowId);t.displayName=n&&n.length?n[0].Value:t.displayName}return t}var F=n("WNuT");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var k=n("ILmX");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function L(e){const t=new Set;let n=new Array;if(e.Layout.Tabs.Tab&&(n=n.concat(e.Layout.Tabs.Tab)),e.Layout.ContextualTabs.Tab&&(n=n.concat(e.Layout.ContextualTabs.Tab)),n.forEach(e=>{e&&e.Groups&&e.Groups.Group&&e.Groups.Group.forEach(e=>{e&&e.Controls&&e.Controls.Items&&e.Controls.Items.forEach(e=>{t.add(Object(k.j)(e.Command))})})}),e.Commands)for(const n in e.Commands)for(const r in e.Commands[n]){const a=e.Commands[n][r];t.has(a.Id)?a.isFirstLevel=!0:a.isFirstLevel=!1}}var B=n("7HpW");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var U=n("NCdO"),V=n("GEbX");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function z(e,t,n,a,m,_,v,S,E,I){if(!e)return null;const w=q(e.EntityMetadataVersionStamp),j=q(e.MetadataVersion);let P=null;const N=[];let R=null,D=null,k=null,z=null,W=null;const G=function(e,t){if(!e||!e.length)return null;const n={};for(const r of e){const e=M(r);n[e.uniqueName]=e,t.push(...r.Labels)}return{taskBasedFlows:n}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(e.TaskBasedFlows,N),K=function(e,t){if(!e||!e.length)return null;const n={},r=[];if(e.length>1)throw"More than one TBX Menu detected";const a=e[0];for(const e of a.TaskBasedFlows){const a=M(e);n[a.uniqueName]=a,t.push(...e.Labels),r.push(a.uniqueName)}return{taskBasedFlows:n,taskBasedFlowGlobalMenu:{initialized:l.a.Initialized,availableOffline:a.AvailableOffline,commandName:a.CommandName,taskBasedFlowUniqueNames:r,versionNumber:a.VersionNumber,overallVersionNumber:a.OverallVersionNumber}}}(e.TaskBasedFlowGlobalMenu,N);K?(R=K.taskBasedFlowGlobalMenu,D=K.taskBasedFlows):G&&(D=G.taskBasedFlows),P=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e){const t={};if(e&&e.length>0)for(const n of e)if(n)if(t[n.Id])t[n.Id][n.LabelColumnName]=n.Value;else{const e={};e[n.LabelColumnName]=n.Value,t[n.Id]=e}return t}(N.concat(e.Labels)),t===b.b.Dashboard&&(k=function(e,t,n,r){const a={},i={},o=new Map;let s=null;if(e){for(const c of e){const e={};e.Initialized=l.a.Initialized,e.FormId=new p.a(c.FormId),e.Name=c.Name,e.Description=c.Description,e.VersionNumber=c.VersionNumber,e.OverallVersionNumber=c.OverallVersionNumber,e.OverallUserVersionNumber=c.OverallUserVersionNumber,a[c.FormId]=e,""!==t&&null!=t?i[t.toLowerCase()]=e:!s&&r&&(s=e),!r&&n&&""!==n&&o.set(n,e)}s&&(a[p.a.fromLegacyGuid(r).guid]=s)}else{if(r||!n||""===n)return null;{const e={};e.Initialized=l.a.Initialized,e.FormId=null,e.Name=null,e.Description=null,o.set(n,e)}}return{dashboards:a,dashboardsByNavPath:i,dashboardsByEntityName:Object.fromEntries(o)}}(e.Dashboards,m,n,_)),n?W=function(e){if(!e)return null;const t={};for(const n of e)if(n.hasOwnProperty("EntityLogicalName")){const e={};for(const t of n.SelectorItems){const n={Id:new p.a(t.Id),DisplayName:t.DisplayName,Description:t.Description,Tooltip:t.Tooltip,Type:t.Type,IsTabledEnabled:t.IsTabletEnabled};e[t.Id]=n}t[n.EntityLogicalName]=e}return t}(e.DashboardSelectors):z=function(e){if(!e)return null;const t={};for(const n of e)for(const e of n.SelectorItems){const n={Id:new p.a(e.Id),DisplayName:e.DisplayName,Description:e.Description,Tooltip:e.Tooltip,Type:e.Type,IsTabledEnabled:e.IsTabletEnabled,OverallVersionNumber:e.OverallVersionNumber,OverallUserVersionNumber:e.OverallUserVersionNumber};t[e.Id]=n}return t}(e.DashboardSelectors);const Q=function(e){const t={};if(e)for(const n of e){const e={ConstructorName:n.Name,CustomControlId:n.FullName||n.Name,IsVirtual:n.IsVirtual,Properties:i(n.Properties),ControlMode:n.ControlMode,SolutionName:n.SolutionName,SolutionVersion:n.SolutionVersion,PublisherName:n.PublisherName,ApiVersion:n.ApiVersion,DesignMap:n.DesignMapJson?JSON.parse(n.DesignMapJson):null};t[n.Name]=e,n.FullName&&n.FullName!==n.Name&&(t[n.FullName]=e),n.CustomControlId&&"00000000-0000-0000-0000-000000000000"!==n.CustomControlId&&(t[n.CustomControlId]=e)}return t}(e.CustomControls),{entities:X,attributes:Y}=Object(o.b)(e.Entities,w,j,a,l.a.Initialized,v),J=function(e){if(!e)return null;const t={};for(const n of e){const e={initialized:l.a.Initialized,formId:p.a.tryParseOrNull(n.FormId),description:n.Description,uniqueName:n.UniqueName,isTabletEnabled:n.IsTabletEnabled,versionNumber:n.VersionNumber,overallVersionNumber:n.OverallVersionNumber};t[e.uniqueName.toLowerCase()]=e}return t}(e.Dialogs),$=Object(b.g)(e.Forms,t,a,n,P,Y,X);let Z,ee,te,ne;$&&(Z=$.forms,ee=$.entities,te=$.attributes,ne=$.charts);const{entities:re}=Object(o.b)(e.RelationshipNavigationEntities,w,j,a,l.a.Uninitialized,v),ae=Object(r.c)(e.ViewSelectors,n),ie=ae?ae.viewSelectors:null,oe=ae?ae.viewDefaults:null,se=ae?ae.viewSelectorVersions:null,ce=ae?ae.viewSelectorSortOrders:null,{formSelectors:le,formSelectorUnfilteredIdsCountByEntity:ue,formDefaults:de,formSelectorFormCheckerInfo:pe}=Object(b.h)(a,e.finalRetrievalStrategy,e.FormSelectors,n,I),{bpfSelectors:fe,bpfDefaults:ge}=function(e){if(!e)return{bpfSelectors:null,bpfDefaults:null};const t={},n={};for(const r of e)if(r.hasOwnProperty("EntityLogicalName")&&r.SelectorItems.length>0){t[r.EntityLogicalName]||(t[r.EntityLogicalName]=[]);let e=null;for(const n of r.SelectorItems){const a={id:n.Id,primaryEntity:n.PrimaryEntity,processOrder:n.ProcessOrder,uniqueName:n.UniqueName};t[r.EntityLogicalName].push(a),(!e&&n.PrimaryEntity===r.EntityLogicalName||e&&e.ProcessOrder>n.ProcessOrder)&&(e=n)}e&&(n[r.EntityLogicalName]=new p.a(e.Id))}return{bpfSelectors:t,bpfDefaults:n}}(e.BPFSelectors),he=H(Object(f.c)(e.SavedQueryVisualizations),Object(f.c)(e.UserQueryVisualizations)),me=H(he,ne),be=Object(f.b)(e.VisualizationSelectors);let ye={},_e={};be&&(ye=be.chartDefaults,_e=be.chartSelectors);const{views:ve}=Object(r.b)(a,e.Views,v),Se=new Map;if(e.CustomControlConfigurations&&e.CustomControlConfigurations.length>0)for(let t=0;t<e.CustomControlConfigurations.length;t++){const n={},a=Object(s.a)(e.CustomControlConfigurations[t]);n[r.a]=a,Se.set(a.PrimaryEntityType,n)}Se.get(n)||Se.set(n,{});let Oe={};if(e&&e.GridBusinessLogics&&e.GridBusinessLogics.length>0)if(t===b.b.View){const t=c(e.GridBusinessLogics[0]);Oe[t[r.a].PrimaryEntityLogicalName]=t}else t===b.b.Dashboard&&(Oe=function(e){const t={};for(let n=0;n<e.length;n++){const a=c(e[n]);t[a[r.a].PrimaryEntityLogicalName]=a}return t}(e.GridBusinessLogics));const Ce=Object(b.f)(X,ee),Ee=Object.assign(Object.assign({},re),Ce),Ie=Object(b.e)(Y,te),{optionSets:we}=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t){const n={},r={},a=Object(d.b)(e),i=Object(d.c)(e);if(t)for(const o of t){const t={Initialized:l.a.Initialized,OptionSetId:o.MetadataId,OptionSetName:o.Name,OptionSetType:Object(u.d)(a,i,o.OptionSetType),Options:Object(u.c)(e,o)};t.OptionSetId&&(n[t.OptionSetId]=t.OptionSetName),t.OptionSetName&&(r[t.OptionSetName]=t)}return{optionSets:{optionSetNameById:n,optionSetByName:r}}}(a,e.OptionSets);e.Dialogs&&e.Dialogs.length>0&&we&&(function(e,t){for(const n in e){const r=e[n];for(const e in r){const n=r[e];if(n&&n.OptionSetId&&n.OptionSetName){const e={Initialized:l.a.Initialized,OptionSetId:n.OptionSetId,OptionSetName:n.OptionSetName,OptionSetType:n.OptionSetType,Options:n.OptionSet};t.optionSetNameById[e.OptionSetId]=e.OptionSetName,t.optionSetByName[e.OptionSetName]=e}}}}(Ie,we),
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t){for(const n in e){const r=e[n];for(const e in r){const n=r[e];n.OptionSetId&&!n.OptionSetName&&t&&t.optionSetNameById&&t.optionSetNameById[n.OptionSetId]&&(n.OptionSetName=t.optionSetNameById[n.OptionSetId]),n.OptionSetName&&t.optionSetByName&&t.optionSetByName[n.OptionSetName]&&(n.OptionSetType=t.optionSetByName[n.OptionSetName].OptionSetType,n.OptionSet=t.optionSetByName[n.OptionSetName].Options)}}}(Ie,we));const je=Object(h.b)(e.WebResources),Pe=Object(h.c)(e),Te=function(e){if(!e)return null;const t={};let n,r=-1,a=-1;for(const i of e){if(i.MissingQuickCreateMenuItemsSummary){n=y(i.MissingQuickCreateMenuItemsSummary);continue}const e={formId:new p.a(i.FormId),entityLogicalName:i.EntityLogicalName,entityDisplayName:i.EntityDisplayName,formType:i.FormType,icon:i.Icon,isActivity:i.IsActivity,versionNumber:i.VersionNumber,overallVersionNumber:i.OverallVersionNumber,formDescription:i.FormDescription};i.VersionNumber>r&&(r=i.VersionNumber,-1===a&&(a=i.OverallVersionNumber)),t[e.entityLogicalName]=e}return{initialized:l.a.Initialized,quickCreateMenuItems:t,versionNumber:r,overallVersionNumber:a,missingQuickCreateMenuItems:n}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(e.QuickCreateMenu),Ne=function(e){return e&&e.length?e[0]:null}(e.Search);let Ae=null;Ae=e.BusinessProcessFlowMetadata;const Re=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t,n,r){if(!t||!t.length)return null;const a={};for(const i of t){const t=i;if(!t)continue;const o=p.a.tryParse(t.BusinessProcessFlowId);if(p.a.isNullOrEmpty(o)){Object(O.a)()&&(a[t.BusinessProcessFlowId]={businessProcessFlowId:o,initialized:l.a.Initialized,BpfDefinitionSelectionAggregatedResults:i.BpfDefinitionSelectionAggregatedResults,BpfDefinitionSelectionAggregatedResultsBrief:i.BpfDefinitionSelectionAggregatedResultsBrief});continue}if(!t.BusinessProcessFlowEntities)continue;const s={labelIdsAndColumnNames:[],entitiesAndAttributes:{}};s.labelIdsAndColumnNames.push(i.LabelId+":name");const c={},u=C(e,t.BusinessProcessFlowEntities,n,c,s);let d=Object(b.c)(e,t.LabelId,null,null,null,n,null,null,"name");d||(d=t.BusinessProcessFlowName);const f=i.BusinessProcessFlowState||{BusinessProcessFlowId:t.BusinessProcessFlowId,Version:0,State:1,CanUpdate:!0},g=i.Version||f.Version,h={initialized:l.a.Initialized,businessProcessFlowId:o,businessProcessFlowName:d,businessProcessFlowUniqueName:t.BusinessProcessFlowUniqueName,businessProcessFlowEntities:u,businessProcessFlowBusinessRules:T(t.BusinessProcessFlowBusinessRules),businessProcessFlowStepEntityAttributeControls:c,businessProcessFlowActions:A(t.BusinessProcessFlowActions,r),businessProcessFlowFlows:x(t.BusinessProcessFlowFlows),businessProcessFlowProcessVersion:g,VersionNumber:g,OverallVersionNumber:i.OverallVersionNumber,businessProcessFlowProcessState:f.State,businessProcessFlowCanUpdate:f.CanUpdate,dependencies:s};a[t.BusinessProcessFlowId]=h}return a}(a,Ae,P,e.ProcessActionOperationMetadata),De=Object(B.d)(Object(F.a)(e.Sitemap),v),xe=Object(g.a)(e,S),Me=function(e){if(!e)return null;const t={};for(const n of e)for(let e=0;e<n.length;e++){const r=n[e].Key,a=n[e].Value;t[r]=a}return{initialized:l.a.Initialized,strings:t}}(e.ResourceStrings);let Fe={},ke={};const Le=function(e){if(!e||!e.length)return null;const t={};let n={};for(const r of e){const e={Commands:r.Commands,Layout:r.Layout,EnableRules:r.EnableRules,DisplayRules:r.DisplayRules,initialized:l.a.Initialized,VersionNumber:Number(r.VersionNumber),OverallVersionNumber:Number(r.OverallVersionNumber)};t[r.Context+":"+r.EntityLogicalName]=e,n=Object.assign(Object.assign({},n),r.ColumnNameToObjectId),L(e)}return{ribbons:t,ribbonsLabelIds:n}}(e.Ribbons);null!=Le&&(null==E||E(e.AppAction,e.AppActionClassicRules,Le.ribbons,n,a,v),Fe=Le.ribbons,ke=Le.ribbonsLabelIds);const Be=function(e){if(!e||!e.length)return null;if(e.length>1)throw"MetadataVersion response is not correct";const t=Number(e[0]);return{initialized:l.a.Initialized,lastVersion:t,currentVersion:t}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(e.MetadataVersion),Ue=function(e){if(!e||!e.length)return null;if(e.length>1)throw"UserMetadataVersion response is not correct";const t=Number(e[0]);return{initialized:l.a.Initialized,lastVersion:t,currentVersion:t}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(e.UserMetadataVersion),Ve=function(e){if(!e)return null;const t={};for(let n=0;n<e.length;n++){const r=e[n].Name,a=e[n].Value;t[r]=a}return{initialized:l.a.Initialized,complexControls:t}}(e.ComplexControls),ze={};null!=e.AppModuleSelector&&e.AppModuleSelector.length>0&&(ze.offlineAppDescriptors=Object(g.c)(e.AppModuleSelector[0].SelectorItems),ze.offlineAppDescriptorsInitialized=l.a.Initialized);return{appModulesList:
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 *
 * Logic in this file is owned by the App Module team.
 */
function(e){const t=window.WEB_RESOURCE_ORG_VERSION_NUMBER?"/"+window.WEB_RESOURCE_ORG_VERSION_NUMBER:"",n=e.LabelsPublish,r=[],a=e.LegacyAppModule;a&&Object.keys(a).length>0&&a.forEach(e=>{r.push({id:e.appInfo.AppId,displayName:e.appInfo.Title,backgroundColor:"#002050",iconUri:new URL(`${t}/WebResources/${e.webResourceInfo.Name}`,window.location.origin).href,appOpenUri:e.appInfo.AppUrl,uniqueName:e.appInfo.UniqueName,clientType:e.appInfo.ClientType})});const i=e.AppModulePublished;return i&&Object.keys(i).length>0&&i.forEach(e=>r.push({id:e.appInfo.AppId,displayName:Object(U.a)(n,e.appInfo.AppId,"name")||e.appInfo.Title,backgroundColor:"#002050",iconUri:new URL(`${t}/WebResources/${e.webResourceInfo.Name}`,window.location.origin).href,appOpenUri:new URL("/main.aspx?appid="+e.appInfo.AppId,window.location.origin).href,uniqueName:e.appInfo.UniqueName,clientType:e.appInfo.ClientType,navigationType:Number.isInteger(e.appInfo.NavigationType)?e.appInfo.NavigationType:V.a.SingleSession,appElements:e.appInfo.AppElements&&e.appInfo.AppElements.length>0?e.appInfo.AppElements.map(e=>({appElementType:e.AppElementType,objectId:e.ObjectId,objectName:e.ObjectName,canvasAppType:e.CanvasAppType})):[]})),r.length>0?{appList:r}:null}(e),forms:Z,formSelectors:le,formSelectorUnfilteredIdsCountByEntity:ue,formDefaults:de,formSelectorFormCheckerInfo:pe,bpfSelectors:fe,bpfDefaults:ge,dialogs:J,taskBasedFlows:D,taskBasedFlowGlobalMenu:R,dashboards:k?k.dashboards:null,dashboardsByNavPath:k?k.dashboardsByNavPath:null,dashboardSelectors:z,dashboardsByEntityName:k?k.dashboardsByEntityName:null,dashboardSelectorsByEntityName:W,entities:Ee,views:ve,viewSelectors:ie,viewDefaults:oe,viewSelectorVersions:se,viewSelectorSortOrders:ce,attributes:Ie,labels:P,controlManifests:Q,charts:me,chartDefaults:ye,chartSelectors:_e,resourceStrings:Me,optionSets:we,quickCreateMenu:Te,searchConfiguration:Ne,webResources:je,webResourceDescriptorsByName:Pe,homePageConfigurations:Object.fromEntries(Se),homePageBusinessLogics:Oe,businessProcessFlows:Re,siteMap:De,ribbons:Fe,ribbonsLabelIds:ke,appContext:xe,metadataVersion:Be,userMetadataVersion:Ue,complexControls:Ve,webResourcesContent:e.WebResourcesContent,landingPageOfflineMetadata:ze}}function q(e){return e&&1===e.length?e[0]:null}function H(e,t){const n=Object.assign({},e);for(const e in t)n.hasOwnProperty(e)?Object.assign(n[e],t[e]):n[e]=t[e];return n}},"5LEP":function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r,a;n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a})),function(e){e.Web="WebTour",e.Mobile="MobileTour"}(r||(r={})),function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized",e[e.Failed=3]="Failed"}(a||(a={}))},"5Oca":function(e,t,n){"use strict";n.d(t,"i",(function(){return I})),n.d(t,"h",(function(){return w})),n.d(t,"q",(function(){return V})),n.d(t,"b",(function(){return R})),n.d(t,"e",(function(){return F})),n.d(t,"d",(function(){return k})),n.d(t,"f",(function(){return L})),n.d(t,"x",(function(){return D})),n.d(t,"j",(function(){return x})),n.d(t,"r",(function(){return q})),n.d(t,"o",(function(){return B})),n.d(t,"p",(function(){return U})),n.d(t,"w",(function(){return W})),n.d(t,"u",(function(){return H})),n.d(t,"n",(function(){return X})),n.d(t,"D",(function(){return Y})),n.d(t,"s",(function(){return J})),n.d(t,"c",(function(){return Z})),n.d(t,"y",(function(){return ee})),n.d(t,"v",(function(){return te})),n.d(t,"g",(function(){return j})),n.d(t,"E",(function(){return K})),n.d(t,"B",(function(){return P})),n.d(t,"z",(function(){return N})),n.d(t,"k",(function(){return ne})),n.d(t,"l",(function(){return re})),n.d(t,"m",(function(){return M})),n.d(t,"a",(function(){return r})),n.d(t,"t",(function(){return $})),n.d(t,"A",(function(){return A})),n.d(t,"C",(function(){return T}));var r,a=n("SAYH"),i=n("eXjw"),o=n("odYE"),s=n("504W"),c=n("WPtp"),l=n("LbMF"),u=n("bT7G"),d=n("JOgp"),p=n("wMH2"),f=n("HYaY"),g=n("sdkC"),h=n("IvgJ"),m=n("tHaS"),b=n("iZ7K"),y=n("/A0C"),_=n("ZPAw"),v=n("Lyxw"),S=n("3/02"),O=n("dpM5"),C=n("64CY");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function E(e){return e?e.data:null}function I(e,t){const n=E(e);return n&&n.entities&&n.entities.hasOwnProperty(t)?n.entities[t]:null}function w(e,t,n){const r=I(e,t);return r?r[n]:null}function j(e,t){const n=E(e);return n&&n.entityFilters&&n.entityFilters.hasOwnProperty(t)?n.entityFilters[t]:null}function P(e,t,n){const r=w(e,t.etn,a.a.toString(t.id));if(r&&r.fields&&r.fields.hasOwnProperty(n)){const e=r.fields[n];if(e)return e.list}return null}function T(e,t,n){const r=w(e,t.etn,a.a.toString(t.id));return r&&r.fields&&r.fields.hasOwnProperty(n)?r.fields[n].hasOwnProperty("list")?r.fields[n].list.map(e=>e.identifier):r.fields[n].reference:null}function N(e,t,n,r){const a=P(e,t,n);if(a){const i=Object(b.L)(e,t.etn,n);if(0===i)for(const e of a){const t=e.fields.hasOwnProperty("regardingfieldname")?e.fields.regardingfieldname:null;if(r===Object(c.c)(t))return e}else if(2===i)return a[0]}return null}function A(e,t,n,r){const a=P(e,t,n);if(a){const i=Object(b.L)(e,t.etn,n);if(0===i){let e=0;for(const t of a){const n=t.fields.hasOwnProperty("regardingfieldname")?t.fields.regardingfieldname:null;if(r===Object(c.c)(n))return e;e++}}else if(2===i)return 0}return null}function R(e){return function(t){const n=I(t,e.etn);if(n){const t=a.a.toString(e.id);if(n.hasOwnProperty(t))return n[t]}return null}}function D(e,t){const n=R(t)(e,t.etn);return n&&n.hasOwnProperty("initialized")?n.initialized:null}function x(e,t,n){if(t){const r=R(t)(e,t.etn);if(r&&r.fields){const a={[y.a.File]:()=>Object(v.f)(e,S.Od)&&Object(v.f)(e,O.l),[y.a.Image]:()=>Object(v.f)(e,S.Qd)&&Object(v.f)(e,O.l)},i=Object(l.b)(n,t.etn,e);if(i===y.a.File||i===y.a.Image){if(!a[i]||!a[i]())return null;{const a=Object(_.a)(e,t,n,i);if(r.fields.hasOwnProperty(a)){const i=N(e,t,a,n),o=i?M(i.fields,r&&r.fields&&r.fields[a]&&r.fields[a].timestamp?r.fields[a].timestamp:null,r&&r.fields&&r.fields[a]&&r.fields[a].validationResult?r.fields[a].validationResult:null):null;if(o)return o.timestamp=r.fields[a].timestamp,o.validationResult=r.fields[a].validationResult,o}}}else{if(r.fields.hasOwnProperty(n))return r.fields[n];{const e={productidname:{identifier:"productid",entityNames:["opportunityproduct","quotedetail","salesorderdetail","invoicedetail"]},parentcustomeridname:{identifier:"parentcustomerid",entityNames:["contact"]}},a="name";if(e.hasOwnProperty(n)&&-1!==e[n].entityNames.indexOf(t.etn)){const t=r.fields[e[n].identifier];if(t){const e=t.reference;if(e&&e.hasOwnProperty(a))return M(e[a])}}}}}}return null}function M(e,t,n){return{value:e,timestamp:t||new Date,validationResult:n||{isValueValid:!0,errorMessage:null,errorId:null,userInput:""}}}function F(e,t){const n=R(t)(e,t.etn);return n&&n.businessProcessFlowId?n.businessProcessFlowId:null}function k(e,t){return e&&e.metadata&&e.metadata.businessProcessFlowsDefault&&t&&e.metadata.businessProcessFlowsDefault.hasOwnProperty(t)?e.metadata.businessProcessFlowsDefault[t]:null}function L(e,t){const n=R(t)(e,t.etn);return n&&n.businessProcessFlowInstanceId?n.businessProcessFlowInstanceId:null}function B(e,t){const n=E(e);return n&&n.lists&&n.lists.hasOwnProperty(t)?n.lists[t]:null}function U(e,t){const n=B(e,t);return n?n.initialized:i.a.Uninitialized}function V(e,t,n,r){const a=B(e,t);if(a){if(r)return a.records;if(a.pages&&n>0){const e=a.pages[n];if(e)return a.records.slice(e.startIndex,e.startIndex+a.pageSize)}}return null}function z(e,t,n,r){const a={initialized:t.initialized,identifier:n,fields:{}};if(t)if(r&&r.length)for(const e of r)a.fields[e]=t.fields[e];else a.fields=t.fields;return a}function q(e,t,n,r,a){const i=V(e,t,n,a),o=[];if(!i)return null;for(const t of i){const n=R(t)(e,t.etn);if(n){const e=z(0,n,t,r);o.push(e)}}return o}function H(e,t){const n=B(e,t);return n?n.totalRecordCount:null}function W(e,t,n){const r=B(e,t);return r&&r.pages&&r.pages[n]&&r.pages[n].pagingCookie?e.data.lists[t].pages[n].pagingCookie:null}function G(e,t=r.LatestEntered){return t===r.LastValid?e.value:e.validationResult.userInput||e.value}function K(e,t,n,i,o=r.LatestEntered){if(!e)return!0;if(Object(c.f)(e))return K(e.innerValue,t,n,i,o);const u=Object(l.a)(t,n,i);if(!u||!u.Type)return function e(t){return Object(c.i)(t)?!t.valueString:Object(c.g)(t)?a.a.isNullOrEmpty(t.id):Object(c.k)(t)?!t.reference:Object(c.j)(t)?!t.value:Object(c.f)(t)?e(t.innerValue):Object(c.h)(t)?!t.list:void 0}(e);let d=!1;switch(u.Type){case y.a.PartyList:const t=e;t&&t.list&&t.list.length>0&&(d=!0);break;case y.a.Boolean:const n=e;!n||"1"!==n.valueString&&"0"!==n.valueString||(d=!0);break;case y.a.PickList:case y.a.State:case y.a.Status:const r=e;r&&"-1"!==r.valueString&&!Object(s.b)(r.valueString)&&(d=!0);break;case y.a.MultiSelectPickList:const a=G(e,o);-1===a||Object(s.b)(a)||(d=!0);break;case y.a.Customer:case y.a.Lookup:case y.a.Owner:const i=e;i&&!Object(s.b)(i.reference)&&(d=!0);break;case y.a.UniqueIdentifier:const c=e;c&&!Object(s.b)(c.id)&&(d=!0);break;case y.a.Date:case y.a.DateTime:case y.a.Decimal:case y.a.Double:case y.a.Integer:case y.a.String:case y.a.BigInt:case y.a.Unknown:case y.a.Memo:case y.a.Money:case y.a.CalendarRules:case y.a.Virtual:default:const l=G(e,o);Object(s.b)(l)||(d=!0)}return!d}function Q(e,t,n,i=r.LatestEntered){switch(n){case y.a.PartyList:const n=[],r=t;for(const t of r.list){const r={},a={},i={},s={};for(const n in t.fields){const o=t.fields[n],u=X(e,"activityparty",n,o);if(u){r[n]=u;const t=Object(l.a)(e,"activityparty",n);if(t&&(a[n]=t.Type,Object(c.j)(o))){const e=o;i[n]=e.formatted||null,s[n]=e.formatted||null}}}const u=new f.a(o.a.toLegacyEntityReference(t.identifier),r,a,i,s,new g.a([]));n.push(u)}return new p.a(n,!1,n.length,!1,null,null);case y.a.Date:case y.a.DateTime:const s=G(t,i),u=Date.parse(s);return isNaN(u)?s:new Date(u);case y.a.PickList:case y.a.Boolean:case y.a.State:case y.a.Status:const d=t,m=d?d.label:null;let b=d?parseInt(d.valueString,10):null;return isNaN(b)&&(b=null),new h.a(m,b,-1,-1,null,null,null);case y.a.Customer:case y.a.Lookup:case y.a.Owner:const _=t;return _&&_.reference?o.a.toLegacyEntityReference(_.reference):null;case y.a.UniqueIdentifier:const v=t;return a.a.toLegacyGuid(v.id);case y.a.MultiSelectPickList:const S=G(t,i);return-1===S||null===S||!Array.isArray(S)&&"string"!=typeof S?null:Array.isArray(S)?S:S.split(",").map(e=>parseInt(e,10));case y.a.Decimal:case y.a.Double:case y.a.Integer:case y.a.String:case y.a.BigInt:case y.a.Unknown:case y.a.Memo:case y.a.Money:case y.a.CalendarRules:case y.a.Virtual:default:return G(t,i)}}function X(e,t,n,a,i=r.LatestEntered){if(Object(c.f)(a)){const t=new m.a(a.entityLogicalName,a.attributeLogicalName,y.a.AliasedValue);return a.innerType===y.a.Integer?t.set_value(Q(e,a.innerValue,y.a.Integer,i)):t.set_value(X(e,a.entityLogicalName,a.attributeLogicalName,a.innerValue)),t}const o=Object(l.a)(e,t,n);if(!o||!o.Type)return null;const s=o.Type;return a?Q(e,a,s,i):s===y.a.PartyList?new p.a([],!1,0,!1,null,null):null}function Y(e,t,n,a,i=r.LatestEntered){if(Object(C.f)(a))return Object(d.c)(a,e,t,n);const o=Object(u.e)(e,t,n,a);let s;if(n&&n.etn)s=n.etn;else{const n=Object(u.b)(e,t);if(!(n&&n.identifier&&n.identifier.etn))return null;s=n.identifier.etn}return X(e,s,a,o,i)}function J(e,t){const n=B(e,t);return n&&n.pageSize?n.pageSize:null}function $(e,t){const n=B(e,t);return null==n?void 0:n.queryColumnNames}function Z(e,t,n=!1){const r=t.get_identifier(),a=Object(l.d)(e,r.LogicalName);if(!a)return t.get_fieldNames();const i=Object.keys(a);return(n&&t.isDirty()?t.get_changedFieldNames():t.get_fieldNames()).filter(e=>i&&-1===i.indexOf(e))}function ee(e,t,n=!1){const r=t.get_identifier(),a=n&&t.isDirty()?t.get_changedFieldNames():t.get_fieldNames(),i=Object(l.d)(e,r.LogicalName),o=new Set;if(!i)throw new Error(`The attribute metadata for ${r.LogicalName} entity is missing in the state tree.`);for(const e of a){const n=i[e];if(!n)throw new Error(`The metadata for ${e} attribute of ${r.LogicalName} entity is missing in the state tree.`);if(n.Type===y.a.PartyList){const n=t.getValue(e).get_entities();for(const e of n)o.add(e.get_identifier().LogicalName)}if(n.Type===y.a.Lookup||n.Type===y.a.Customer||n.Type===y.a.Owner){const n=t.getValue(e);n&&n.LogicalName&&o.add(n.LogicalName)}}return Array.from(o)}function te(e,t){if(!t)return null;const n=function(e){return e.data.notifications}(e);return n&&n.length?n.filter(e=>e.forRecord&&o.a.equals(e.forRecord,t)):null}function ne(e,t,n){const r=re(e,t,n);return r?r.fileProgress:null}function re(e,t,n){if(!e||!e.data||!e.data.files)return null;const r=E(e);return r&&r.files&&r.files.hasOwnProperty(t.etn)&&r.files[t.etn][a.a.toString(t.id)]&&r.files[t.etn][a.a.toString(t.id)][n]?r.files[t.etn][a.a.toString(t.id)][n]:null}!function(e){e[e.LatestEntered=0]="LatestEntered",e[e.LastValid=1]="LastValid"}(r||(r={}))},"5UJb":function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},a=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(r(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.WorkBlockTracker=t.exposeWorkBlockTracker=void 0;var i,o=n("3ZMs");!function(e){e[e.Working=0]="Working",e[e.WorkComplete=1]="WorkComplete",e[e.Idle=2]="Idle"}(i||(i={}));var s=function(e,t){console[t](e)},c=function(){function e(e,t,n){void 0===n&&(n=!1),this._appWorkingCallbacks=[],this._appIdleCallbacks=[],this._isBoot=!0,this._pendingWorkItems=[],this._workEndTimeoutId=-1,this._appIdleTimeoutId=-1,this._workIntervalId=-1,this._appBusyTime=0,this._appIdleTime=0,this._lastWorkUpdateTime=0,this._state=i.Idle,this._runningIdleCallbacks=!1,this._appIdleTimeoutLength=e,this._workCompleteTimeout=t,this._rethrowErrors=n,this._checkIfWorkTimedOut=this._checkIfWorkTimedOut.bind(this),this._onWorkDoneConfirmation=this._onWorkDoneConfirmation.bind(this),this._checkIfAppIdle=this._checkIfAppIdle.bind(this)}return e.prototype.getLastWorkBlockStartTime=function(){return this._appBusyTime},e.prototype.overrideWorkBlockStartTime=function(e){this._appBusyTime=e},e.prototype.isAppIdle=function(){return this._state===i.Idle},e.prototype.setPerformanceIssueHook=function(e){this._logPerformanceIssue=e},e.prototype.subscribeToAppWorking=function(e){this._appWorkingCallbacks.push(e)},e.prototype.subscribeToAppIdle=function(e){this._appIdleCallbacks.push(e)},e.prototype.unsubscribeFromAppWorking=function(e){var t=this._appWorkingCallbacks.indexOf(e);t>-1&&this._appWorkingCallbacks.splice(t,1)},e.prototype.unsubscribeFromAppIdle=function(e){var t=this._appIdleCallbacks.indexOf(e);t>-1&&this._appIdleCallbacks.splice(t,1)},e.prototype.trackPendingPromise=function(e,t){var n=this.trackWork(t);e.then(n,n)},e.prototype.trackWork=function(e,t){var n,r=this;return void 0===t&&(t=!0),!t&&this.isAppIdle()?function(){}:this._runningIdleCallbacks?(s("WorkBlockTracker: work block started during synchronous idle callbacks. This behavior is not supported","log"),function(){}):(this._pendingWorkItems.push(e),this._state!==i.Working&&this._onNewWork(),n=!1,function(){n||(n=!0,r._onItemCompleted(e))})},e.prototype._onItemCompleted=function(e){var t=this._pendingWorkItems.indexOf(e);t>=0&&(this._pendingWorkItems.splice(t,1),0===this._pendingWorkItems.length?this._onWorkDone():this._resetWorkTimeoutTracking())},e.prototype._onNewWork=function(){var e=this;if(this._state!==i.Working&&1===this._pendingWorkItems.length){var t=!1;if(this._state===i.Idle&&(this._workIntervalId=setInterval(this._checkIfWorkTimedOut,this._workCompleteTimeout),this._isBoot||(performance.mark&&performance.mark("WorkBlockStart"),this._appBusyTime=window.performance.now()),t=!0),this._state=i.Working,this._resetWorkTimeoutTracking(),clearTimeout(this._workEndTimeoutId),this._workEndTimeoutId=-1,clearTimeout(this._appIdleTimeoutId),this._appIdleTimeoutId=-1,t){var n={isBoot:this._isBoot};this._appWorkingCallbacks.slice().forEach((function(t){return e._safelyCallCallback(t,n)}))}}else s("WorkBlockTracker: invalid state in _onNewWork","error")},e.prototype._resetWorkTimeoutTracking=function(){this._lastWorkUpdateTime=performance.now()},e.prototype._checkIfWorkTimedOut=function(){if(this._state===i.Working&&performance.now()-this._lastWorkUpdateTime>this._workCompleteTimeout){var e={type:o.PerformanceIssueType.WorkBlockTimeout,level:o.PerformanceIssueLevel.Warning,message:"Work timed out with no activity",parameters:a([this._workCompleteTimeout.toString()],this._pendingWorkItems)};this._logPerformanceIssue&&this._logPerformanceIssue(e),this._pendingWorkItems=[],this._onWorkDone()}},e.prototype._onWorkDone=function(){this._state===i.Working&&0===this._pendingWorkItems.length?(this._state=i.WorkComplete,clearTimeout(this._workEndTimeoutId),this._workEndTimeoutId=setTimeout(this._onWorkDoneConfirmation,0)):s("Invalid WorkBlockTracker state: _onWorkDone should not be called with pending work","error")},e.prototype._onWorkDoneConfirmation=function(){this._state===i.WorkComplete&&0===this._pendingWorkItems.length||s("Invalid WorkBlockTracker state: _onWorkDoneConfirmation should not be called with pending work","error"),this._appIdleTime=window.performance.now(),clearTimeout(this._appIdleTimeoutId),this._appIdleTimeoutId=setTimeout(this._checkIfAppIdle,this._appIdleTimeoutLength)},e.prototype._checkIfAppIdle=function(){var e=this;if(this._state===i.WorkComplete)if(this._state===i.WorkComplete){this._state=i.Idle,clearInterval(this._workIntervalId),this._workIntervalId=-1,performance.mark&&performance.mark("WorkBlockEnd");var t={appWorkingTime:this._appBusyTime,appIdleTime:this._appIdleTime,isBoot:this._isBoot};this._isBoot=!1,this._appIdleTimeoutId=-1,this._runningIdleCallbacks=!0,this._appIdleCallbacks.slice().forEach((function(n){return e._safelyCallCallback(n,t)})),this._runningIdleCallbacks=!1}else this._appIdleTimeoutId=-1;else s("Invalid WorkBlockTracker state: shouldn't be in working state when transitioning to idle","error")},e.prototype._safelyCallCallback=function(e,t){try{e.call(null,t)}catch(e){this._rethrowErrors&&setTimeout((function(){throw e}),0)}},e}();t.WorkBlockTracker=c;var l=new c(100,6e4,!0);t.default=l,t.exposeWorkBlockTracker=function(){window.UCWorkBlockTracker=l}},"5Wsx":function(e,t,n){"use strict";function r(e,t){return e.appUserSettings&&e.appUserSettings[t]}n.d(t,"a",(function(){return r}))},"5X+N":function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}));var r=n("zsAz");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let a;async function i(){return a||(a=await Promise.all([n.e(0),n.e(1),n.e(6),n.e(51),n.e(165)]).then(n.bind(null,"gYJt"))),a}function o(){if(!a)throw Object(r.d)("Accessed Panes API before creating a Pane",2415919130);return a}},"5ZBI":function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return o}));var r=n("Z/4N");let a;function i(e){a=e}function o(e,t){const n=Object(r.e)(e,t);return n&&n.ConstructorName?n.ConstructorName:t}},"5bWN":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("X37l"),a=n("SAYH");function i(e){const t={EntityTypeName:e.EntityTypeName,LastAccessed:e.LastAccessed,ObjectId:e.ObjectId,PinStatus:e.PinStatus,RecordType:e.RecordType,IsUserView:e.IsUserView,IconPath:e.IconPath,HasPrimaryImageField:e.HasPrimaryImageField};return JSON.stringify(t)}function o(e,t,n=!1){const o=[];switch(e.EntityTypeName||o.push({name:"EntityTypeName",value:"Expected to get correct value for EntityTypeName when we create new recent."}),e.Title||o.push({name:"Title",value:"Expected to get correct value for Title when we create new recent."}),e.LastAccessed?e.LastAccessed instanceof Date&&e.LastAccessed.toISOString||o.push({name:"LastAccessed",value:`Expected type Date. Actual type: ${typeof e.LastAccessed}. Value: ${e.LastAccessed}.`}):o.push({name:"LastAccessed",value:"Expected to get correct value for LastAccessed when we create new recent."}),(a.a.isNullOrEmpty(e.ObjectId)||e.ObjectId.guid===a.a.EMPTYSTRING)&&o.push({name:"ObjectId",value:e.ObjectId?"Expected to get a non-empty string for ObjectId.guid when we create new recent.":"Expected to get correct value for ObjectId when we create new recent."}),e.RecordType){case r.a.Entity:case r.a.Grid:case r.a.Isv:break;default:o.push({name:"RecordType",value:"Expected to get correct value for RecordType when we create new recent."})}return!o.length||(o.push({name:"RecentItem",value:i(e)}),o.push({name:"IsDeleted",value:n}),t.EventManager.ReportComponentFailure("MRU.ValidateRecentItem",new Error("Recent item has incorrect data."),null,o),!1)}},"5d8d":function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"i",(function(){return c})),n.d(t,"h",(function(){return l})),n.d(t,"j",(function(){return d})),n.d(t,"a",(function(){return p})),n.d(t,"g",(function(){return g})),n.d(t,"d",(function(){return f})),n.d(t,"e",(function(){return h})),n.d(t,"f",(function(){return m})),n.d(t,"c",(function(){return b}));var r=n("dHD5"),a=n("T6Zt"),i=n("ghNp");function o(e){return e.organization.organizationSettings.kmUseExternalPortal}function s(e,t){return e.organization.organizationSettings.kmExternalPortalUrl.replace("{kbnum}",t.articlePublicNumber?t.articlePublicNumber:function(e){const t="MscrmControls.KbSearchControl.KbSearchControl:MscrmControls.KbSearchControl.KbSearchControl",n="value",r=e.searchWidget.list[t].relevanceRecords[n],a=e.searchWidget.list[t].selectedResult;for(let e=0;e<r.length;e++)if(r[e].objectId===a)return r[e].relevanceData.articlepublicnumber;return null}(e))}function c(e){return e.user.userSettings&&e.user.userSettings.usePathBasedUrls}function l(e,t){return e.metadata.entities[t].IsKnowledgeManagementEnabled}function u(e,t){return e.metadata.entities[t].DisplayName}function d(e){return e&&void 0!==e.entityTypeName&&null!==e.entityTypeName}function p(e,t,n,r,c,l){if(Object(i.d)(t,e.parentContextToken,n)instanceof a.a&&r&&r.length>0&&c)for(let e=0;e<r.length;e++){const t={articlePost:{articleId:c.articlePublicNumber+"_"+c.knowledgeArticleId,articleUId:c.knowledgeArticleId,question:c.title,answer:c.content,timesViewed:c.knowledgeArticleViews,createdOn:c.createdon,lastModifiedOn:c.modifiedOn,stateCode:c.stateCode,published:3===c.stateCode,publicUrl:o(l)?s(l,c):""}};r[e].Parameters=[t]}}function f(e,t){const n=Object(r.w)(e);return t.searchWidget&&t.searchWidget.list&&t.searchWidget.list[n]&&t.searchWidget.list[n].currentSearchText?t.searchWidget.list[n].currentSearchText:""}function g(e,t){const n=Object(r.w)(e);return t.searchWidget&&t.searchWidget.list&&t.searchWidget.list[n]&&t.searchWidget.list[n].totalCountString?parseInt(t.searchWidget.list[n].totalCountString,10):0}function h(e,t){const n=Object(r.w)(e);if(t.searchWidget&&t.searchWidget.list&&t.searchWidget.list[n]&&t.searchWidget.list[n].records)for(const e of t.searchWidget.list[n].records)if(e.knowledgeArticleId===t.searchWidget.list[n].selectedResult)return e;return null}function m(e,t,n){const a=Object(r.w)(e);return t.searchWidget&&t.searchWidget.list&&t.searchWidget.list[a]&&t.searchWidget.list[a].records?n>=0&&n<t.searchWidget.list[a].records.length?t.searchWidget.list[a].records[n].knowledgeArticleId:-1:0}function b(e,t){return t.searchWidget&&t.searchWidget.list&&t.searchWidget.list[e]&&t.searchWidget.list[e].numberOfResults?t.searchWidget.list[e].numberOfResults:0}},"5hnz":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * Constants for the modal dialog page.
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="dialogCloseIconButton",a="confirmButton"},"5oHv":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * The unique name of the CustomControl page module.
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="KbSearch"},"5qiD":function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.Workspace=0]="Workspace",e[e.Medium=1]="Medium",e[e.NotCached=2]="NotCached"}(r||(r={}))},"5w+f":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));const r="dialog.initialize";function a(e,t,n=!1,a,i){return{type:"dialog.initialize.async",execute({dispatch:o}){const s=e.getId(),c=e.getName();return o(function(e,t,n,a,i){return{type:r,payload:{input:e,dialogOptions:t,__pageName:n,isDialogStatus:i},meta:{pageId:a}}}(t,a,c,s,n)),o(e.getInitializationAction(i)).then(()=>s)}}}},"5ylf":function(e,t,n){"use strict";var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.setNetworkInfo=t.processBrowserResourceTimings=t.clearBrowserResourceTimings=t.CACHED_NAME=t.RESOURCE_NAME=t.NETWORK_REQUEST_EVENT_NAME=void 0;var i=a(n("fMBw")),o=a(n("zI6t")),s=n("GotM"),c=n("WbTV");t.NETWORK_REQUEST_EVENT_NAME="BrowserResourceTimings";t.RESOURCE_NAME="name";t.CACHED_NAME="cached";var l,u=i.default.createEvent("Fetch","BrowserResourceTimings"),d={xmlhttprequest:i.default.createEvent("XMLHttpRequest","BrowserResourceTimings"),script:i.default.createEvent("AssetLoad.Script","BrowserResourceTimings"),link:i.default.createEvent("AssetLoad.Link","BrowserResourceTimings"),iframe:i.default.createEvent("AssetLoad.IFrame","BrowserResourceTimings"),fetch:u,"":u},p=i.default.createEvent("RequestPatch","BrowserResourceTimings");function f(e){try{return e&&e.performance&&"function"==typeof e.performance.clearResourceTimings&&!!e.performance.clearResourceTimings}catch(e){return!1}}t.processBrowserResourceTimings=function(){var e=c.getNetworkRequests(),t=[],n=function(e,n){var a,i;if(f(e)){var o=e.performance,s=o.getEntriesByType("resource");try{for(var c=r(s),l=c.next();!l.done;l=c.next()){var u=l.value;t.push({resource:u,performanceObject:o,identifier:n})}}catch(e){a={error:e}}finally{try{l&&!l.done&&(i=c.return)&&i.call(c)}finally{if(a)throw a.error}}}};n(window,"MainWindow"),s.forEachAdditionalWindow((function(e){n(e.contentWindow,e.id)})),l&&o.default.addCommonKpiParameters(l);var a=0;t.sort((function(e,t){return e.performanceObject.timing.navigationStart+e.resource.startTime-(t.performanceObject.timing.navigationStart+t.resource.startTime)})).forEach((function(t){for(var n,r=a;r<e.length;r++){var i=t.resource.initiatorType;if(t.resource.name.endsWith(e[r].url)&&(("fetch"===i||""===i)&&e[r].fetch||"xmlhttprequest"===i&&!e[r].fetch)){n=e.splice(r,1)[0],a=r;break}}!function(e,t){var n=e.performanceObject,r=e.resource,a=n.timing.navigationStart-window.performance.timing.navigationStart;if(d[r.initiatorType]){var i=r.startTime+a,o=r.responseEnd+a-i,s=d[r.initiatorType],c={};r.connectEnd&&(c.connectEnd=Math.round(r.connectEnd+a).toString()),r.connectStart&&(c.connectStart=Math.round(r.connectStart+a).toString()),r.domainLookupEnd&&(c.domainLookupEnd=Math.round(r.domainLookupEnd+a).toString()),r.domainLookupStart&&(c.domainLookupStart=Math.round(r.domainLookupStart+a).toString()),c.duration=Math.round(r.duration).toString(),c.fetchStart=Math.round(r.fetchStart+a).toString(),c.name=r.name.toString(),r.redirectEnd&&(c.redirectEnd=Math.round(r.redirectEnd+a).toString()),r.redirectStart&&(c.redirectStart=Math.round(r.redirectStart+a).toString()),r.requestStart&&(c.requestStart=Math.round(r.requestStart+a).toString()),c.responseEnd=Math.round(r.responseEnd+a).toString(),r.responseStart&&(c.responseStart=Math.round(r.responseStart+a).toString()),c.startTime=Math.round(r.startTime+a).toString(),r.workerStart&&(c.workerStart=Math.round(r.workerStart+a).toString()),r.decodedBodySize&&(c.decodedBodySize=r.decodedBodySize.toString()),r.encodedBodySize&&(c.encodedBodySize=r.encodedBodySize.toString()),r.nextHopProtocol&&(c.nextHopProtocol=r.nextHopProtocol.toString()),r.secureConnectionStart&&(c.secureConnectionStart=Math.round(r.secureConnectionStart+a).toString()),r.transferSize&&(c.transferSize=r.transferSize.toString()),(r.redirectStart||r.redirectEnd||r.domainLookupStart||r.domainLookupEnd||r.connectStart||r.connectEnd||r.secureConnectionStart||r.requestStart||r.responseStart)&&void 0!==r.transferSize&&(c.cached=(0===r.transferSize).toString()),c.window=e.identifier,l&&Object.assign(c,l),Object.assign(c,t),s.createRetroactiveStopwatch(i,o,c)}}(t,n)})),e.forEach((function(e){p.createRetroactiveStopwatch(e.patchStartTime,e.patchDuration,JSON.parse(JSON.stringify(e)))}))},t.clearBrowserResourceTimings=function(){f(window)&&(window.performance.clearResourceTimings(),s.forEachAdditionalWindow((function(e){f(e.contentWindow)&&e.contentWindow.performance.clearResourceTimings()}))),c.resetNetworkRequests()},t.setNetworkInfo=function(e){l=e}},"5yoC":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class r{constructor(){this.offlineData=null}get_name(){return"Request"}get_xmlNamespace(){return"http://schemas.microsoft.com/crm/2011/Contracts"}toString(){return this.get_name()+"Request"}}},"6/BY":function(e,t,n){"use strict";n.d(t,"b",(function(){return p})),n.d(t,"a",(function(){return f}));var r=n("83Lp"),a=n("6fj+"),i=n("69Qu"),o=n("17x/"),s=n("CvZq"),c=n("ff1s"),l=n("Lyxw"),u=n("3/02"),d=n("37s6");function p(e,t,n){const p=n.getState(),f=Object(i.d)(p),g=Object(a.c)(p),h=Object(o.c)(p),m=Object(c.b)(p),b=Object(o.e)(p),y=Object(l.f)(p,u.v),_=Object(d.C)(p);e||m||h&&t||b?e&&!f&&g?!_&&y?n.dispatch(Object(r.g)(null,null,null,!0)):Object(l.f)(p,u.Ph)||n.dispatch(Object(r.h)(s.a.NonBlockingUI)):e&&f&&n.dispatch(Object(r.f)()):n.dispatch(Object(r.h)(s.a.BlockingUI))}function f(e,t,r){if(t&&r){!async function(e,t){const r=await n.e(93).then(n.bind(null,"bvqZ"));e(r.addToastNotification(t))}(e,{id:"reconnect_notification_toast",level:t,message:r,title:null,type:1,onCloseHandler:null})}}},"64CY":function(e,t,n){"use strict";n.d(t,"e",(function(){return s})),n.d(t,"f",(function(){return c})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="_compositionLinkControl_",a=["AddressCompositionLinkControl","FullNameCompositionLinkControl"];function i(e){const t=o(e);return t?t.map(t=>e+r+t):null}function o(e){switch(e){case"fullname":return["firstname","middlename","lastname"];case"yomifullname":return["yomifirstname","yomimiddlename","yomilastname"];case"address1_composite":return["address1_line1","address1_line2","address1_line3","address1_city","address1_stateorprovince","address1_postalcode","address1_country"];case"address2_composite":return["address2_line1","address2_line2","address2_line3","address2_city","address2_stateorprovince","address2_postalcode","address2_country"];case"address3_composite":return["address3_line1","address3_line2","address3_line3","address3_city","address3_stateorprovince","address3_postalcode","address3_country"];case"billto_composite":return["billto_line1","billto_line2","billto_line3","billto_city","billto_stateorprovince","billto_postalcode","billto_country"];case"shipto_composite":return["shipto_line1","shipto_line2","shipto_line3","shipto_city","shipto_stateorprovince","shipto_postalcode","shipto_country"];default:return null}}function s(e){if(!e)return!1;switch(e.toLowerCase()){case"contact":case"lead":case"systemuser":case"externalparty":case"contact":case"account":case"competitor":case"invoice":case"salesorder":case"quote":return!0}return!1}function c(e){return"address1_composite"===e||"address2_composite"===e||"address3_composite"===e||"billto_composite"===e||"shipto_composite"===e}},"67s4":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("8o18");class a extends r.a{constructor(e,t,n){super(n,t.get_identifier()+"_"+e.toString()),this._entity=t,this._relationship=e}get_relationship(){return this._relationship}toString(){return"RelatedEntityQuery: "+this._entity.get_identifier()+","+this._relationship.toString()+","+super.toString()}}},"69Qu":function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"a",(function(){return c}));var r=n("E5IU"),a=n("37s6");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function i(e){return(!Object(r.r)(e)||!Object(a.D)(e))&&o(e)}function o(e){return e&&e.serverStatus?e.serverStatus.isAvailable:null}function s(e){return e.serverStatus?e.serverStatus.isNetworkAvailable:null}function c(e){return e.serverStatus?e.serverStatus.isHealthCheckEnabled:null}},"69gE":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("IpQH"),a=n("uM6Y"),i=n("VkXQ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class o extends r.a{constructor(e,t){super(e,t,a.j)}IsExecAvailable(){return this.isOperationAvailable(i.j.exec.name)}onSyncStart(){return this.execute(i.j.onSyncStart.name)}onSyncComplete(){return this.execute(i.j.onSyncComplete.name)}onSyncError(){return this.execute(i.j.onSyncError.name)}}},"6L2Z":function(e,t,n){"use strict";function r(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}n.d(t,"a",(function(){return r}))},"6QGX":function(e,t,n){"use strict";n.d(t,"i",(function(){return u})),n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return f})),n.d(t,"d",(function(){return h})),n.d(t,"f",(function(){return m})),n.d(t,"g",(function(){return b})),n.d(t,"h",(function(){return y})),n.d(t,"j",(function(){return v})),n.d(t,"e",(function(){return d})),n.d(t,"c",(function(){return _}));var r=n("WPtp"),a=n("Xd5/"),i=n("16wZ"),o=n("SAYH"),s=n("MXaZ"),c=n("IaGr"),l=n("Ae6N");function u(e){return Object(r.j)(e)?e.value:null}function d(e){if(Object(r.j)(e)){const t=[],n=e.value?e.value.split(","):null;for(const e in n)Object(i.a)(n[e])||t.push(parseInt(n[e],10));return t.length>0?t:null}return null}function p(e){if(e&&Object(r.i)(e))switch(e.valueString){case"-1":return null;case"0":return!1;case"1":return!0;default:const t=new Error("Unknown boolean value"),n=[];n.push({name:"value",value:e.valueString}),c.a.getInstance().eventManager.ReportComponentFailure("ClientApi.AttributeValueSelector.getBooleanValue",t,null,n)}return null}function f(e,t,n){if(!Object(r.j)(n)||Object(i.a)(n.value))return null;const o=Object(a.A)(e,t,null,new Date(n.value));let c=null;if(o)if(Object(s.x)(e)){const e=(null==n?void 0:n.value)?new Date(n.value):null;switch(o.controlAttributes.Behavior){case l.a.UserLocal:c=Object(s.m)(e,o.userSettings.timeZoneUtcOffsetMinutes,o.userSettings.timeZoneAdjusters),c=g(c,o);break;case l.a.TimeZoneIndependent:case l.a.DateOnly:c=Object(s.I)(e);break;default:c=e}}else c=Object(a.a)(n.formatted,o.controlAttributes.Format,o.cultureInfo,o),o.controlAttributes.Behavior===l.a.UserLocal&&(c=g(c,o)),c=new Date(c.getTime()+1e3*new Date(n.value).getSeconds());else c=new Date(n.value);return c}function g(e,t){const n=new Date,r=(t.userSettings.timeZoneUtcOffsetMinutes+Object(s.t)(new Date,t.userSettings.timeZoneAdjusters))*s.f,a=Object(s.s)(new Date(n.getFullYear(),n.getMonth(),n.getDate()),t.userSettings.timeZoneAdjusters)-Object(s.s)(e,t.userSettings.timeZoneAdjusters),i=e.getTimezoneOffset()*s.f;return new Date(e.getTime()-r-i+a)}function h(e){if(Object(r.k)(e)&&!Object(i.a)(e.reference)){const t={entityType:e.reference.etn,id:o.a.externalGuid(e.reference.id),name:e.reference.name},n=new Array;return n.push(t),n}return null}function m(e,t,n){if(Object(r.j)(e)&&!Object(i.a)(e.value)&&""!==e.value)switch(t){case"double":case"decimal":case"money":return isNaN(e.value)?0:parseFloat(n?e.value.toFixed(n):e.value);case"integer":return Math.round(e.value);default:return parseInt(e.value,10)}return null}function b(e){return Object(r.i)(e)&&!Object(i.a)(e.valueString)&&"-1"!==e.valueString?parseInt(e.valueString,10):null}function y(e){if(Object(r.h)(e)){const t=new Array;return Object(i.a)(e.list)||e.list.forEach(e=>{let n;if(e&&e.fields)if(e.fields.partyid){const a=e.fields.partyid;if(Object(r.k)(a)&&a.reference){const e=a.reference;n={entityType:e.etn,id:o.a.externalGuid(e.id),name:e.name},t.push(n)}}else if(e.fields.addressused){const a=e.fields.addressused;n={entityType:"unresolvedaddress",id:o.a.externalGuid(o.a.EMPTY),name:Object(r.e)(a)},t.push(n)}}),t}return null}function _(e){return Object(r.j)(e)?e.value:null}function v(e){if(e){if(Object(r.g)(e))return Object(i.a)(e.id)?null:o.a.externalGuid(e.id);Object(i.k)("ClientApi.AttributeValueSelector.getUniqueIdentifierValue","guid","value.id")}return null}},"6RYU":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("SNT6"),a=n("Gbua"),i=n("gzcE");t._Utf8_GetBytes=function(e){for(var t=[],n=0;n<e.length;++n){var r=e.charCodeAt(n);r<128?t.push(r):r<2048?t.push(192|r>>6,128|63&r):r<55296||r>=57344?t.push(224|r>>12,128|r>>6&63,128|63&r):(r=65536+((1023&r)<<10|1023&e.charCodeAt(++n)),t.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r))}return t},t._Base64_GetString=function(e){for(var t,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=[],a=e.length%3,i=0,o=e.length-a;i<o;i+=3){var s=(e[i]<<16)+(e[i+1]<<8)+e[i+2];r.push([n.charAt((t=s)>>18&63),n.charAt(t>>12&63),n.charAt(t>>6&63),n.charAt(63&t)].join(""))}switch(a){case 1:s=e[e.length-1];r.push(n.charAt(s>>2)),r.push(n.charAt(s<<4&63)),r.push("==");break;case 2:var c=(e[e.length-2]<<8)+e[e.length-1];r.push(n.charAt(c>>10)),r.push(n.charAt(c>>4&63)),r.push(n.charAt(c<<2&63)),r.push("=")}return r.join("")},t._Varint_GetBytes=function(e){for(var t=[];4294967168&e;)t.push(127&e|128),e>>>=7;return t.push(127&e),t},t._Varint64_GetBytes=function(e){for(var t=e.low,n=e.high,r=[];n||4294967168&t;)r.push(127&t|128),t=(127&n)<<25|t>>>7,n>>>=7;return r.push(127&t),r},t._Double_GetBytes=function(e){if(i.BrowserChecker._IsDataViewSupport()){var t=new DataView(new ArrayBuffer(8));t.setFloat64(0,e,!0);for(var n=[],r=0;r<8;++r)n.push(t.getUint8(r));return n}return a.FloatUtils._ConvertNumberToArray(e,!0)},t._Zigzag_EncodeZigzag32=function(e){return(e=r.Number._ToInt32(e))<<1^e>>31},t._Zigzag_EncodeZigzag64=function(e){var t=e.low,n=e.high,a=n<<1|t>>>31,i=t<<1;2147483648&n&&(a=~a,i=~i);var o=new r.UInt64("0");return o.low=i,o.high=a,o}},"6b+r":function(e,t,n){"use strict";n.d(t,"a",(function(){return A})),n.d(t,"b",(function(){return N}));var r=n("mMyr"),a=n("olZa"),i=n("FhVi"),o=n("Afz2"),s=n("kXuq"),c=n("/to1"),l=n("q441"),u=n("huli"),d=n("wipL");class p extends r.Component{constructor(e){super(e),this._onShowDetailsClicked=this._onShowDetailsClicked.bind(this),this._onDynamicHelpLinkClicked=this._onDynamicHelpLinkClicked.bind(this),this.state={errorDetailsShown:!1}}_onShowDetailsClicked(){this.setState({errorDetailsShown:!0},()=>{this._setFocus("dialogErrorText")})}_getErrorDetails(){const e=[];let t=0;return this.props.errorDetails&&this.props.errorDetails.forEach(n=>{const a="errorDetail_"+t++;e.push(r.createElement(c.a,{id:a,testhooks:{id:a},key:a},n))}),e}render(){return r.createElement(s.a,{id:"dialogErrorView"},r.createElement(l.a,{accessibilityLabel:this.props.showDetailsLabel,id:"dialogErrorViewlink",testhooks:{id:"dialogErrorViewlink"},onClick:this._onShowDetailsClicked,style:this._styleShowDetailsButton(),tabIndex:this.props.tabIndex,hidden:!this.state.errorDetailsShown},r.createElement(c.a,{id:"dialogErrorViewtext",style:this._buttonTextStyle()},this.props.showDetailsLabel)),r.createElement(s.a,{id:"dialogErrorText",ref:"dialogErrorText",style:this._styleDetails(),tabIndex:this.props.tabIndex,hidden:this.state.errorDetailsShown},this._getErrorDetails(),this._getDownloadLogFileButton()),this._getDynamicHelpLinkButton())}_setFocus(e){const t=this.refs[e];t?u.findDOMNode(t).focus():document.getElementById(this.props.errorOkButtonId).focus()}_styleShowDetailsButton(){return Object.assign(Object.assign({},this._buttonAsHyperlinkStyle(!this.state.errorDetailsShown)),{marginTop:0})}_styleDetails(){return Object.assign({},this.state.errorDetailsShown?{flexDirection:"column"}:{display:"none"})}_buttonTextStyle(){return{color:"#069"}}_buttonAsHyperlinkStyle(e){return{display:e?"flex":"none",backgroundColor:"transparent",borderColor:"transparent",padding:"0",cursor:"pointer",marginTop:"1.25rem",":focus":{borderStyle:"dotted",borderColor:"#666666",borderWidth:"2px"}}}_getDynamicHelpLinkButton(){if(this.props.dynamicHelpOptions&&(this.props.dynamicHelpOptions.errorRegion||this.props.dynamicHelpOptions.helpURL))return r.createElement(l.a,{testhooks:{id:"DynamicHelpbutton"},ref:"dialogErrorDownloadLogFile",accessibilityLabel:this.props.dynamicHelpOptions.helpLabel,onClick:this._onDynamicHelpLinkClicked,style:this._buttonAsHyperlinkStyle(!0),tabIndex:this.props.tabIndex},r.createElement(c.a,{id:"DynamicHelptext",style:this._buttonTextStyle()},this.props.dynamicHelpOptions.helpLabel))}_getDownloadLogFileButton(){if(!this.props.hideDownloadLogLink)return r.createElement(l.a,{testhooks:{id:"dialogErrorTextbutton"},ref:"dialogErrorDownloadLogFile",accessibilityLabel:this.props.downloadLogFileLabel,onClick:this.props.downloadButtonClicked,style:this._buttonAsHyperlinkStyle(!0),tabIndex:this.props.tabIndex},r.createElement(c.a,{id:"dialogErrorTexttext",style:this._buttonTextStyle()},this.props.downloadLogFileLabel))}_onDynamicHelpLinkClicked(){Object(d.d)(this.props.dynamicHelpOptions,this.props.openURL)}}var f=n("u+q+"),g=n("d4He"),h=n("pgSX"),m=n("si7p");class b extends r.Component{constructor(e){super(e),this._hyperlinkClickHandler=this._hyperlinkClickHandler.bind(this),this._ShowErrorDetails=this._ShowErrorDetails.bind(this),this._hyperlinkTextStyle={color:"#069"},this._hyperlinkButtonStyle={display:"flex",backgroundColor:"transparent",borderColor:"transparent",padding:"0",cursor:"pointer",margin:"1px"}}_hyperlinkClickHandler(e,t){e.preventDefault(),this.props.openUrl(t)}_ShowErrorDetails(e,t){this.props.openDialog(t)}_getLinks(){const e=[];return e.push(r.createElement(l.a,{accessibilityLabel:this.props.privacyStatementLabel,id:"dialogLinkViewprivacystatementlink",testhooks:{id:"dialogLinkViewprivacystatementlink"},onClick:e=>this._hyperlinkClickHandler(e,this.props.privacyStatementLink),style:this._hyperlinkButtonStyle,tabIndex:this.props.tabIndex},r.createElement(c.a,{id:"dialogLinkViewprivacystatementlinktext",style:this._hyperlinkTextStyle},this.props.privacyStatementLabel))),e.push(r.createElement(l.a,{accessibilityLabel:this.props.viewErorDetailsLabel,id:"dialogLinkViewviewerrorslink",testhooks:{id:"dialogLinkViewviewerrorslink"},onClick:e=>this._ShowErrorDetails(e,this.props.text),style:this._hyperlinkButtonStyle,tabIndex:this.props.tabIndex},r.createElement(c.a,{id:"dialogLinkViewviewerrorslinktext",style:this._hyperlinkTextStyle},this.props.viewErorDetailsLabel))),e.push(r.createElement(l.a,{accessibilityLabel:this.props.howToChangeNotificationSettingsLabel,id:"dialogLinkViewnotificationlink",testhooks:{id:"dialogLinkViewnotificationlink"},onClick:e=>this._hyperlinkClickHandler(e,this.props.howToChangeNotificationSettingslink),style:this._hyperlinkButtonStyle,tabIndex:this.props.tabIndex},r.createElement(c.a,{id:"dialogLinkViewnotificationlinktext",style:this._hyperlinkTextStyle},this.props.howToChangeNotificationSettingsLabel))),e}render(){return r.createElement(s.a,{id:"dialogUnhandledErrorView"},r.createElement(c.a,{accessibilityLabel:this.props.text,id:"dialogMessageName",testhooks:{id:"dialogMessageNametext"}},this.props.text),r.createElement(s.a,{id:"dialogUnhandledErrorViewview"},this._getLinks()))}}const y=Object(f.a)(void 0,(function(e,t){const n={height:"22rem",width:"36rem"};return{openUrl:t=>e(Object(g.a)(t)),openDialog:r=>e(Object(h.a)(m.a,t.errorData,n,void 0,t.showErrorDetailsDialogTitle,t.showErrorDetailsDialogSubTitle,void 0,"",void 0,void 0,t.id))}}))(b);var _=n("3rse"),v=n("Fn63"),S=n("N2HV"),O=n("YxC/"),C=n("5hnz"),E=n("H4dV"),I=n("RJiR"),w=n("I6RZ"),j=n("voMr"),P=n("z0a7");class T extends r.Component{constructor(e){super(e),this._onCloseHandler=this._onCloseHandler.bind(this),this._onCancelClick=this._onCancelClick.bind(this),this._onConfirmClick=this._onConfirmClick.bind(this),this._confirmAndSignIn=this._confirmAndSignIn.bind(this),this._confirmAndSignOutSignIn=this._confirmAndSignOutSignIn.bind(this)}_onConfirmClick(e){this._isActive()&&this.props.confirmAndClose()}_confirmAndSignIn(e){this._isActive()&&this.props.confirmAndDoSignin()}_confirmAndSignOutSignIn(e){this._isActive()&&this.props.confirmAndDoSignoutSignin()}_onCancelClick(e){this._isActive()&&this.props.close()}_onCloseHandler(e){if(e.keyCode===_.a.Escape&&!this.props.blockClose){if(!this._isActive())return;e.stopImmediatePropagation(),this.props&&this.props.dismiss()}}_renderContentContainer(){return r.createElement(s.a,{id:"modalDialogContentContainer",key:"modalDialogContentContainer",style:this.props.modalDialogContentContainerStyle},this._renderHeader(),this._renderTextContainer(),this._renderButtonsContainer())}_renderHeader(){return r.createElement(s.a,{id:"modalDialogHeader",key:"modalDialogHeader",style:this.props.modalDialogHeaderStyle},this._renderTitleContainer(),this._renderSubtitleContainer())}_renderIcon(){return this.props.dialogOptions&&this.props.dialogOptions.type&&(m.f||this.props.modalDialogType===m.d||this.props.modalDialogType===m.g)?r.createElement(s.a,{style:this.props.modalDialogIconStyle},this._getMessageIcon(this.props.dialogOptions.type,"")):null}_getMessageIcon(e,t){switch(e.toLowerCase()){case"error":return r.createElement(S.b,{id:"errorIcon",type:v.a.ErrorIcon,testhooks:{id:"errorIcon"},style:this.props.modalDialogIconSymbolStyle});case"abandon":return r.createElement(S.b,{id:"abandonIcon",type:v.a.Abandon,testhooks:{id:"abandonIcon"},style:this.props.modalDialogIconSymbolStyle});case"warning":return r.createElement(S.b,{id:"warningIcon",type:v.a.Warning,testhooks:{id:"warningIcon"},style:this.props.modalDialogIconSymbolStyle});case"information":return r.createElement(S.b,{id:"informationIcon",type:v.a.InformationIcon,testhooks:{id:"informationIcon"},style:this.props.modalDialogIconSymbolStyle});default:return""}}_renderTitleContainer(){return r.createElement(s.a,{id:"dialogTitleContainer",key:"dialogTitleContainer",style:this.props.modalDialogTitleContainerStyle},this._renderIcon(),this._renderTitle(),this.props.blockClose?null:this._renderCloseIconButton())}_renderCloseIconButton(){const e=Object(O.c)(this.props.resourceStrings,a.c);return r.createElement(l.a,{id:C.a,key:C.a,style:this.props.modalDialogCloseIconButtonStyle,tabIndex:0,onClick:this.props.dismiss,accessibilityLabel:e,testhooks:{id:"dialogCloseIconButton"},title:e},r.createElement(S.b,{id:"dialogCloseIcon",key:"dialogCloseIcon",type:v.a.Cancel,style:this.props.modalDialogCloseIconStyle}))}_renderTitle(){const{modalDialogTitleViewStyle:e}=this.props;return r.createElement(s.a,{id:"dialogTitleView",key:"dialogTitleView",style:e},this._renderTitleText())}_renderTitleText(){const{modalDialogTitleStyle:e,modalDialogType:t}=this.props;let n=this.props.title;return t===m.e&&(n=Object(O.c)(this.props.resourceStrings,a.e)),n?r.createElement(c.a,{id:"dialogTitleText",testhooks:{id:"dialogTitleText"},key:"dialogTitleText",accessibilityLabel:n,semanticTag:"h1",tabIndex:this._isIE()?-1:void 0,style:e},N(n)?this._getMultiLineHtml(n):n):null}_getMultiLineHtml(e){const t=e.split("\n"),n=[t[0]];for(let e=1;e<t.length;e++)n.push(r.createElement("br")),n.push(t[e]);return r.createElement(r.Fragment,null,n)}_renderSubtitleContainer(){const{subtitle:e,modalDialogSubtitleContainerStyle:t}=this.props;if(e)return r.createElement(s.a,{id:"dialogSubtitleContainer",key:"dialogSubtitleContainer",style:t},this._renderSubtitle())}_renderSubtitle(){const{modalDialogType:e,modalDialogSubtitleStyle:t,subtitle:n}=this.props;return e===m.a||e===m.c||m.f||e===m.d||e===m.g?r.createElement(c.a,{style:t,id:"subtitle",semanticTag:"h2",testhooks:{id:"errorDialog_subtitle"},accessibilityLabel:n,tabIndex:this._isIE()?-1:void 0},n):null}_renderTextContainer(){let e;const{modalDialogType:t,text:n,modalDialogTextContainerStyle:i,modalDialogTextStyle:o}=this.props;if(t===m.d)e=this._renderErrorDetails();else if(t===m.e)e=Object(O.c)(this.props.resourceStrings,a.f);else if(t===m.g)e=this._renderUnhandledErrorDetails();else{if(N(n))return this._renderAsMultilineText(n);e=n?n.toString():""}return r.createElement(s.a,{id:"dialogTextContainer",key:"dialogTextContainer",style:i},r.createElement(c.a,{id:"dialogMessageText",key:"dialogMessageText",testhooks:{id:"dialogMessageText"},style:o},e))}_renderAsMultilineText(e){const{modalDialogTextStyle:t,modalDialogTextContainerStyle:n}=this.props,a=e.split("\n").map((e,n)=>{const a="dialogMessageTextLine"+n;return r.createElement(c.a,{accessibilityLabel:e,id:a,key:a,role:o.g,style:t},e)});return r.createElement(s.a,{id:"dialogTextContainer",key:"dialogTextContainer",style:n},a)}_getMultiLineTextIds(e){return e?e.split("\n").map((e,t)=>"dialogMessageTextLine"+t).join(" "):""}_renderErrorDetails(){const{confirmAndClose:e,errorDetails:t,showDetailsLabel:n,hideDownloadLogLink:a,confirmButtonLabel:i,dynamicHelpOptions:o,openURL:s}=this.props;return r.createElement(p,{downloadButtonClicked:e,errorDetails:t,showDetailsLabel:n,hideDownloadLogLink:a,downloadLogFileLabel:i,errorOkButtonId:"cancelButton",tabIndex:0,dynamicHelpOptions:o,openURL:s})}_renderButtonsContainer(){const{modalDialogType:e,modalDialogButtonContainerStyle:t}=this.props;if(e)return r.createElement(s.a,{id:"buttonView",key:"buttonView",style:t},this._renderButtons())}_renderUnhandledErrorDetails(){const{errorDetails:e,text:t}=this.props;return r.createElement(y,{id:this.props.id,text:t,privacyStatementLabel:e[0],privacyStatementLink:e[1],howToChangeNotificationSettingsLabel:e[2],howToChangeNotificationSettingslink:e[3],viewErorDetailsLabel:e[4],showErrorDetailsDialogTitle:e[5],showErrorDetailsDialogSubTitle:e[6],errorData:e[7],errorDetails:[t],tabIndex:0})}_renderButtons(){const e=[],t=this.props.confirmButtonLabel?this.props.confirmButtonLabel:Object(O.c)(this.props.resourceStrings,a.g);if(this.props)switch(this.props.modalDialogType){case m.a:e.push(r.createElement(l.a,{style:this.props.modalDialogPrimaryButtonStyle,id:"okButton",key:"okButton",onClick:this._onConfirmClick,tabIndex:0,accessibilityLabel:t,testhooks:{id:"okButton"}},r.createElement(c.a,{id:"okButtonText",key:"okButtonText",style:this.props.modalDialogPrimaryButtonTextStyle},t)));break;case m.c:case m.e:{const n=this.props.cancelButtonLabel?this.props.cancelButtonLabel:Object(O.c)(this.props.resourceStrings,a.b);e.push(r.createElement(l.a,{id:C.b,key:C.b,style:this.props.modalDialogPrimaryButtonStyle,onClick:this._onConfirmClick,tabIndex:0,accessibilityLabel:t,testhooks:{id:"confirmButton"}},r.createElement(c.a,{id:"confirmButtonText",key:"confirmButtonText",style:this.props.modalDialogPrimaryButtonTextStyle},t))),e.push(r.createElement(l.a,{id:"cancelButton",key:"cancelButton",style:this.props.modalDialogDefaultButtonStyle,onClick:this._onCancelClick,tabIndex:0,accessibilityLabel:n,testhooks:{id:"cancelButton"}},r.createElement(c.a,{id:"cancelButtonTextName",key:"cancelButtonTextName",style:this.props.modalDialogDefaultButtonTextStyle},n)));break}case m.d:{const t=this.props.cancelButtonLabel?this.props.cancelButtonLabel:Object(O.c)(this.props.resourceStrings,a.b);e.push(r.createElement(l.a,{id:"cancelButton",key:"cancelButton",style:this.props.modalDialogPrimaryButtonStyle,onClick:this._onCancelClick,tabIndex:0,accessibilityLabel:t,testhooks:{id:"errorOkButton"}},r.createElement(c.a,{id:"okButtonText",key:"okButtonText",style:this.props.modalDialogPrimaryButtonTextStyle},t)));break}case m.f:{const n=this.props.cancelButtonLabel?this.props.cancelButtonLabel:Object(O.c)(this.props.resourceStrings,a.b);e.push(r.createElement(l.a,{id:C.b,key:C.b,style:this.props.modalDialogPrimaryButtonStyle,onClick:this._confirmAndSignIn,tabIndex:0,accessibilityLabel:t,testhooks:{id:"confirmButton"}},r.createElement(c.a,{id:"confirmButtonText",key:"confirmButtonText",style:this.props.modalDialogPrimaryButtonTextStyle},t))),e.push(r.createElement(l.a,{id:"cancelButton",key:"cancelButton",style:this.props.modalDialogDefaultButtonStyle,onClick:this._onCancelClick,tabIndex:0,accessibilityLabel:n,testhooks:{id:"cancelButton"}},r.createElement(c.a,{id:"cancelButtonTextName",key:"cancelButtonTextName",style:this.props.modalDialogDefaultButtonTextStyle},n)));break}case m.b:{const n=this.props.cancelButtonLabel?this.props.cancelButtonLabel:Object(O.c)(this.props.resourceStrings,a.b);e.push(r.createElement(l.a,{id:C.b,key:C.b,style:this.props.modalDialogPrimaryButtonStyle,onClick:this._confirmAndSignOutSignIn,tabIndex:0,accessibilityLabel:t,testhooks:{id:"confirmButton"}},r.createElement(c.a,{id:"confirmButtonText",key:"confirmButtonText",style:this.props.modalDialogPrimaryButtonTextStyle},t))),e.push(r.createElement(l.a,{id:"cancelButton",key:"cancelButton",style:this.props.modalDialogDefaultButtonStyle,onClick:this._onCancelClick,tabIndex:0,accessibilityLabel:n,testhooks:{id:"cancelButton"}},r.createElement(c.a,{id:"cancelButtonTextName",key:"cancelButtonTextName",style:this.props.modalDialogDefaultButtonTextStyle},n)));break}case m.g:{const t=this.props.cancelButtonLabel?this.props.cancelButtonLabel:Object(O.c)(this.props.resourceStrings,a.b),n=this.props.confirmButtonLabel?this.props.confirmButtonLabel:Object(O.c)(this.props.resourceStrings,a.g);e.push(r.createElement(l.a,{id:"sendReportButton",key:"sendReportButton",style:this.props.modalDialogPrimaryButtonStyle,onClick:this._onConfirmClick,tabIndex:0,accessibilityLabel:n,testhooks:{id:"sendReportButton"}},r.createElement(c.a,{id:"sendReportButtonTextName",key:"sendReportButtonTextName",style:this.props.modalDialogPrimaryButtonTextStyle},n)),r.createElement(l.a,{id:"dontSendReportButton",key:"dontSendReportButton",style:this.props.modalDialogDefaultButtonStyle,onClick:this._onCancelClick,tabIndex:0,accessibilityLabel:t,testhooks:{id:"dontSendReportButton"}},r.createElement(c.a,{id:"dontSendReportButtonTextName",key:"dontSendReportButtonTextName",style:this.props.modalDialogDefaultButtonTextStyle},t)));break}}return e}_renderAccessibilityComponent(e){let t;const{modalDialogType:n}=this.props;switch(n){case m.a:t="okButton";break;case m.c:case m.e:case m.f:t=C.b;break;case m.g:t="sendReportButton";break;case m.d:t="cancelButton"}return r.createElement(i.a,{key:"modalDialogAccessibility",rootElementId:e,isModal:!0,shouldManageFocus:!0,defaultFocusId:t,overrideFocusId:t})}_isActive(){return this.props&&this.props.activeDialog}_isIE(){return E.a.getInstance().get_IsBrowserIE()}render(){const{id:e,modalDialogOuterContainerStyle:t,modalDialogStyle:n,modalDialogType:a,text:i,title:c}=this.props,l="modalDialogRoot_"+e,u="modalDialogView_"+e,d=i&&"string"==typeof i&&i.indexOf("\n")>-1?this._getMultiLineTextIds(i):"dialogMessageText";let p=c?"dialogTitleText":void 0,f=i?d:void 0;return p||(p=i?d:void 0,f=void 0),r.createElement(s.a,{id:l,key:l,style:t,tabIndex:-1},this._renderAccessibilityComponent(l),r.createElement(s.a,{id:u,key:u,labelledByElementId:p,describedByElementId:"subtitle "+f,style:n,role:o.f,testhooks:{id:a+"dialog","uci-dialog":!0},tabIndex:-1,accessibilityModal:!0},this._renderContentContainer()))}componentDidMount(){document.addEventListener("keydown",this._onCloseHandler),this._elementFocusedBeforeDialogWasOpened=document.activeElement}componentWillUnmount(){document.removeEventListener("keydown",this._onCloseHandler),this.props.dialogOptions&&this.props.dialogOptions.restoreFocus&&this._elementFocusedBeforeDialogWasOpened&&this._elementFocusedBeforeDialogWasOpened.focus()}}function N(e){return e&&"string"==typeof e&&e.indexOf("\n")>-1}function A(e){const t=Object(f.d)(t=>Object(w.a)(t,e.id)),n=Object(P.a)([a.c]);if(t===j.a.Native){const{activeDialog:t,title:i,text:o,cancelButtonLabel:s,close:c,confirmButtonLabel:l,confirmAndClose:u}=e;return r.createElement(I.a,{title:i,message:o,cancelLabel:s,cancel:()=>t&&c(),confirmLabel:l,confirm:()=>t&&u(),dismiss:()=>t&&u(),dismissLabel:n[a.c]})}return r.createElement(T,Object.assign({},e))}T.displayName="ModalDialogRoot"},"6eYz":function(e,t,n){"use strict";function r(e){return e.popupNotifications}function a(e,t){return e.popupNotifications[t]}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}))},"6fj+":function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"e",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"d",(function(){return l}));var r=n("504W"),a=n("CvZq");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function i(e){return!(!e||!e.reconnectNotification||Object(r.a)(e.reconnectNotification.isReconnectNotificationShown))&&e.reconnectNotification.isReconnectNotificationShown}function o(e){return!!e.reconnectNotification.showReconnectNotificationAfterUpsync}function s(e){return!(!e||!e.reconnectNotification||Object(r.a)(e.reconnectNotification.isServerUnavailableNewSession))&&e.reconnectNotification.isServerUnavailableNewSession}function c(e){return!(e&&e.reconnectNotification&&!Object(r.a)(e.reconnectNotification.isReconnectSuccessful))||e.reconnectNotification.isReconnectSuccessful}function l(e){return e&&e.reconnectNotification&&e.reconnectNotification.type?e.reconnectNotification.type:a.a.NonBlockingUI}},"6hHv":function(e,t,n){"use strict";n.d(t,"c",(function(){return U})),n.d(t,"e",(function(){return B})),n.d(t,"d",(function(){return V})),n.d(t,"f",(function(){return J})),n.d(t,"a",(function(){return L})),n.d(t,"b",(function(){return k}));var r=n("M0zh"),a=n("92OB"),i=n("GT4X"),o=n("wgH2"),s=n("ILmX"),c=n("iZ7K"),l=n("eD3A");var u=n("I4Rv"),d=n("UIlN");function p(e,t,n,i){return{type:"commanding.initstate.sync",execute({dispatch:s,getState:l},p){const g=l();if(e){J(e,s,l);const b=new a.a(t,n,g,l,p,s),y=Object(d.a)(g,n);let _;_=y?Object(o.a)(y.ribbonId):i.ContextEntityLogicalName;const v=Object(c.f)(g,_),S=Object(c.e)(g,_),O=function(e,t,n,r,a){const i={};let o=new Array;e.Layout.Tabs.Tab&&(o=o.concat(e.Layout.Tabs.Tab));e.Layout.ContextualTabs.Tab&&(o=o.concat(e.Layout.ContextualTabs.Tab));return o.forEach(o=>{o&&o.Groups&&o.Groups.Group&&o.Groups.Group.forEach(o=>{o.Controls.Items.forEach(o=>{h(o,t,e,i,n,r,a)})})}),i}(e,b,_,v,S),C=function(e,t){const n={EnableRules:{},DisplayRules:{}};e&&e.DisplayRules&&m(e.DisplayRules,t,n.DisplayRules);e&&e.EnableRules&&m(e.EnableRules,t,n.EnableRules);return n}(e,b);f(s,O,n),s(function(e,t){const n={nonCacheableRules:e};return{type:r.q,payload:n,meta:{commandManagerId:t}}}(C,n)),s(Object(u.b)(t,n))}},sync:!0}}function f(e,t,n){const a=[];for(const e in t)a.push(g(t[e],e,n));a.length>0&&e(function(e,t){const n={stateUpdates:e};return{type:r.k,payload:n,meta:{commandManagerId:t}}}(a,n))}function g(e,t,n){return{type:r.j,payload:e,meta:{commandManagerId:n,controlId:t}}}function h(e,t,n,a,i,o,c){const u={hasPopulateQueryCommand:!1,hasSelectionCountRule:!1,hasVisibilityExpression:!1,hasActionExpression:!1};if(e&&e.Id&&e.Command){if("Menu"in e&&e.Menu&&e.Menu.MenuSection&&e.Menu.MenuSection.length)for(let r=0;r<e.Menu.MenuSection.length;r++){const s=e.Menu.MenuSection[r];if(s.Item&&s.Item.Items){const e=s.Item.Items;for(let r=0;r<e.length;r++){const s=h(e[r],t,n,a,i,o,c);u.hasPopulateQueryCommand=u.hasPopulateQueryCommand||s.hasPopulateQueryCommand,u.hasSelectionCountRule=u.hasSelectionCountRule||s.hasSelectionCountRule,u.hasVisibilityExpression=u.hasVisibilityExpression||s.hasVisibilityExpression,u.hasActionExpression=u.hasActionExpression||s.hasActionExpression}}}const d=e.Command.split("|");if(4===d.length){const t=Object(l.k)(e.ToolTipTitle,e.ToolTipDescription,e.LabelText),p=""===d[0]?"null":d[0],f=d[3],g=Object(s.j)(e.Id,i),h=Object(l.w)(e.LabelText,o,c),m=n.Commands[p]?n.Commands[p][f]:n.Commands[r.c][f];if(m){u.hasPopulateQueryCommand=u.hasPopulateQueryCommand||!!e.PopulateQueryCommand,u.hasSelectionCountRule=u.hasSelectionCountRule||Object(l.p)(n.EnableRules,m.EnableRules,p),u.hasVisibilityExpression=u.hasVisibilityExpression||Object(l.q)(n.EnableRules,m.EnableRules,p),u.hasActionExpression=u.hasActionExpression||Object(l.a)(m);const r={},i={};!function(e,t,n,r){e&&e.EnableRules&&e.EnableRules.length>0&&e.EnableRules.forEach(e=>{n[e]={ruleIdResult:null,rulePartsResults:[]}});e&&e.DisplayRules&&e.DisplayRules.length>0&&e.DisplayRules.forEach(e=>{r[e]={ruleIdResult:null,rulePartsResults:[]}})}(m,0,r,i),a[g]={hasPopulateQueryCommand:u.hasPopulateQueryCommand,hasSelectionCountRule:u.hasSelectionCountRule,hasVisibilityExpression:u.hasVisibilityExpression,hasActionExpression:u.hasActionExpression,canBeVisibleOffline:Object(l.o)(n.EnableRules,m.EnableRules,p),canBeVisibleForHierarchy:Object(l.n)(n.EnableRules,m.EnableRules,p),commandId:e.Command,labelText:h,tooltip:t,icon:e.ModernImage,enableRulesResult:r,displayRulesResult:i,commandValueId:!("Menu"in e)&&e.CommandValueId?e.CommandValueId:null}}}}return u}function m(e,t,n){if(e&&n)for(const t in e)for(const r in e[t]){Object(l.v)(e,r,t)&&(n[t]||(n[t]={}),n[t][r]=!0)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function b(e,t){const n=Object(d.a)(e,t);return n&&n.nonCacheableRules||null}var y=n("P86a"),_=n("Me5Q"),v=n("Wz2A"),S=n("arV0"),O=n("GYEz"),C=n("w1eR"),E=n("Lyxw"),I=n("3/02"),w=n("3mEc"),j=n("lY/Z"),P=n("pEXn"),T=n("jjPz"),N=n("a8hT"),A=n("Bl5B"),R=n("Uv1Y");function D(e,t){const n={},r=Object.values(e).filter((e,t,n)=>n.indexOf(e)===t);for(const e of r)n[Object(A.g)(t(),e)]=void 0,n[Object(A.l)(t(),e)]=e;return Object.entries(e).forEach(([e,r])=>{n[Object(A.m)(t(),r,e)]=r}),n}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function x(e,t,n,a="null",o){return{type:"commanding.initializeExpressionRuntimeForRibbon",async execute({dispatch:c,getState:l},u){const d=[];a||(a="null"),d.push({name:P.b.CommandingParameters.CommandManagerId,value:e}),d.push({name:P.b.CommandingParameters.EntityName,value:a});let p=-1;try{const u={},f=Object(i.c)(l(),e);if(!f||0===Object.keys(f).length)return void(null==n||n.info("No controls with expressions found",d));for(const e in f){const n=Object(s.j)(e),i=t.Commands[a]?t.Commands[a][n]:t.Commands[r.c][n];Object.assign(u,F(i,t,a)),Object.assign(u,M(i.Actions))}const g=new Promise((e,t)=>{p=setTimeout(()=>t({message:"InitializeExpressionRuntimeForRibbon timed out after 60000 milli seconds and it could not load expression runtime, as a result some of PoerFx based buttons will not work correctly"}),6e4)}),h=async()=>{await c(function(e){return Object(T.a)(arguments,{type:"load.expression.scripts",async execute({dispatch:t,getState:n},r){if(!Object(E.f)(n(),I.Fe))throw R.a.fromErrorCode(n(),-2147086061);if(!e||0===Object.keys(e).length)return;const a=await Object(N.b)();await a.waitForExpressionRuntimeToBeInitialized();const i=D(e,n);await a.loadExpressionScripts(i,r,n,t)}})}(u)),clearTimeout(p)};await Promise.race([h(),g]),o.IsExpressionRuntimeAvailable=!0}catch(e){clearTimeout(p),o.IsExpressionRuntimeAvailable=!1,null==n||n.error("Error when trying to intialize expression runtime for ribbon "+(null==e?void 0:e.message),d)}}}}function M(e){const t={};for(const n of e)if(5===n.ActionType){const e=n.Attributes;t[e.ComponentName]=e.Library}return t}function F(e,t,n){var r;const a={},i=e.EnableRules;for(const e in i){const o=i[e];if(null===(r=t.EnableRules)||void 0===r?void 0:r[n]){const e=t.EnableRules[n][o];for(let t=0;t<e.Rules.length;t++){const n=e.Rules[t];if(48===n.RuleType){const e=n;a[e.ComponentName]=e.Library}}}}return a}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const k="EnableRules",L="DisplayRules";function B(e,t,n,o,s){const c=[{name:"commandManagerId",value:o},{name:"pageId",value:n},{name:"contextKey",value:s},{name:"contextEntity",value:null==t?void 0:t.EntityLogicalName},{name:"ribbonContextType",value:null==t?void 0:t.ContextType},{name:"contextTypeMask",value:null==t?void 0:t.ContextTypeMask}];return{type:"ribbon.evaluterulenostatechange.async",async execute({dispatch:u,getState:d},p){const f=[],g=d(),h=Object(l.g)(g,null==t?void 0:t.EntityLogicalName),m=Q(g),y={contextTypeFeatureEnabled:Object(E.f)(g,I.Z)},_=p.TraceManager.getTracer("Commanding.EvaluateRules"),S=Object(i.e)(g,o);J(e,u,d);const O=new a.a(n,o,g,d,p,u),C=b(g,o);_.debug("Evaluating rules",c);for(const n in S){const a=S[n].commandId,i=a.split("|");if(4===i.length){const c=""===i[0]?"null":i[0],l=i[3],d=e.Commands[c]?e.Commands[c][l]:e.Commands[r.c][l];if(d){const r={},i={};m&&X(l,d.Actions)?f.push(W(v.a.Skipped,n,o,r,i)):f.push(z(O,d,C,!1,a,n,t,e,c,o,s,h,u,r,i,y))}}}return(await Promise.all(f)).reduce((e,t)=>(e[t.meta.controlId]=Object.assign(Object.assign({},S[t.meta.controlId]),t.payload),e),{})}}}function U(e,t,n,o,s,c){const u=[{name:"commandManagerId",value:o},{name:"pageId",value:n},{name:"contextKey",value:s},{name:"contextEntity",value:null==t?void 0:t.EntityLogicalName},{name:"ribbonContextType",value:null==t?void 0:t.ContextType}];return{type:"ribbon.evaluaterule.async",async execute({dispatch:d,getState:f},g){const h=[],m=g.TraceManager.getTracer("Commanding.EvaluateRules");if(!e||!o)return m.warn("Rules were not evaluated"),!1;const S=Object(i.b)(f(),o);S||d(p(e,n,o,t));const O=f();Object(l.s)(O)?await d(x(o,e,m,null==t?void 0:t.ContextEntityLogicalName,t)):m.warn("App Action FX Feature is Disabled");const C=Object(l.g)(O,null==t?void 0:t.EntityLogicalName),w=Q(O),j=Object(i.e)(O,o);J(e,d,f);const P=new a.a(n,o,O,f,g,d),T={contextTypeFeatureEnabled:Object(E.f)(O,I.Z)},N=b(O,o);m.debug(`Evaluating rules for commandManagerId: ${o}, pageId: ${n}`);for(const n in j){const a=j[n].commandId,i=a.split("|");if(4===i.length){const l=""===i[0]?"null":i[0],u=i[3],p=e.Commands[l]?e.Commands[l][u]:e.Commands[r.c][u],f=null!==j[n].visible&&void 0!==j[n].visible;if(p&&(null==p?void 0:p.isFirstLevel)){const r={},i={};w&&X(u,p.Actions)?h.push(W(v.a.Skipped,n,o,r,i)):h.push(z(P,p,N,f&&!c,a,n,t,e,l,o,s,C,d,r,i,T))}}}const A=await Promise.all(h);return S||d(Object(_.a)(y.a.CompletedInitialRuleEvaluation,o)),d(q(A,o)),u.push({name:"RuleEvaluationResults",value:K(A)}),m.debug("Finished evaluating rules",u),!0}}}function V(e,t,n,u,p){const g=[{name:"commandManagerId",value:n},{name:"pageId",value:t},{name:"contextKey",value:u},{name:"ribbonId",value:p}];return{type:"ribbon.evaluaterule.async",async execute({dispatch:m,getState:y},_){const O=y(),C=Object(S.j)(O,t),E=Object(l.g)(O,null==C?void 0:C.entityTypeName),I=Q(O),w=[],j=Object(s.l)(O,n,p),P=Object(o.c)(O,n),T=Object(i.e)(O,n),N=b(O,n);J(j,m,y);const A=_.TraceManager.getTracer("Commanding.EvaluateRules");if(g.push({name:"contextEntity",value:null==P?void 0:P.EntityLogicalName}),g.push({name:"ribbonContextType",value:null==P?void 0:P.ContextType}),!j||!n)return A.error("Rules were not evaluated for flyout due to missing ribbon descriptor",g),!1;const R=new a.a(t,n,O,y,_,m);e.some(e=>!T[Object(s.j)(e.Id,null==P?void 0:P.ContextEntityLogicalName)])&&m(function(e,t,n,r,i){return{type:"commanding.initmenustate.sync",execute({dispatch:s,getState:l},u){const p=l();if(e&&e.length>0){J(t,s,l);const g=new a.a(n,r,p,l,u,s),m={},b=Object(d.a)(p,r);let y;y=b?Object(o.a)(null==b?void 0:b.ribbonId):null==i?void 0:i.ContextEntityLogicalName;const _=Object(c.f)(p,y),v=Object(c.e)(p,y);e.forEach(e=>{h(e,g,t,m,y,_,v)}),f(s,m,r)}},sync:!0}}(e,j,t,n,P)),A.debug(`Evaluating rules of menu items for commandManagerId: ${n}, pageId: ${t}`),e.forEach(e=>{const t=e.Command.split("|");if(4===t.length){const a=""===t[0]?"null":t[0],i=t[3],o=j.Commands,c=o[a]?o[a][i]:o[r.c][i],l=Object(s.j)(e.Id,null==P?void 0:P.ContextEntityLogicalName);if(c){const t={},r={};I&&X(i,c.Actions)?w.push(W(v.a.Skipped,l,n,t,r)):w.push(z(R,c,N,!1,e.Command,l,P,j,a,n,u,E,m,t,r))}}});const D=await Promise.all(w);return m(q(D,n)),g.push({name:"RuleEvaluationResults",value:K(D)}),A.debug("Finished evaluating rules",g),!0}}}async function z(e,t,n,r,a,i,o,s,c,u,d,p,f,g,h,m){if(p&&!Object(l.o)(s.EnableRules,t.EnableRules,c))return W(v.a.Offline,i,u,g,h);if((null==m?void 0:m.contextTypeFeatureEnabled)&&Object(l.x)(u,o,null==t?void 0:t.Id)&&!Object(l.m)(s.EnableRules,t.EnableRules,c))return W(v.a.False,i,u,g,h);const b=e.evaluateSyncRulesForCommand(s.EnableRules,n.EnableRules,k,t.EnableRules,o,c,t.Id,u,d,g,h,m);if(b===v.a.False)return W(v.a.False,i,u,g,h);if(!r){if(e.evaluateSyncRulesForCommand(s.DisplayRules,n.DisplayRules,L,t.DisplayRules,o,c,t.Id,u,d,g,h)===v.a.False)return H(b,v.a.False,i,u,g,h)}const y=[],_=e.evaluateAsyncRulesForCommand(s.EnableRules,n.EnableRules,k,t.EnableRules,o,c,t.Id,u,d,g,h);if(y.push(_),!r){const r=e.evaluateAsyncRulesForCommand(s.DisplayRules,n.DisplayRules,L,t.DisplayRules,o,c,t.Id,u,d,g,h);y.push(r)}const S=await Promise.all(y),O=S[0];if(!r){return H(O,S[1],i,u,g,h)}return W(O,i,u,g,h)}function q(e,t){const n={evaluatedRules:e};return{type:r.d,payload:n,meta:{commandManagerId:t}}}function H(e,t,n,a,i,o){return G(r.f,e,t,n,a,i,o)}function W(e,t,n,a,i){return G(r.e,e,v.a.Skipped,t,n,a,i)}function G(e,t,n,r,a,i,o){const s={};return t!==v.a.Skipped&&(s.enabled=t===v.a.True,s.enableRulesResult=i),n!==v.a.Skipped&&(s.visible=n===v.a.True,s.displayRulesResult=o),{type:e,payload:s,meta:{commandManagerId:a,controlId:r}}}function K(e){const t=[];return Object.entries(e).forEach(e=>{var n,r,a,i,o,s;t.push({controlId:e[1]&&(null===(r=null===(n=e[1])||void 0===n?void 0:n.meta)||void 0===r?void 0:r.controlId),enableRulesResult:e[1]&&(null===(i=null===(a=e[1])||void 0===a?void 0:a.payload)||void 0===i?void 0:i.enabled),displayRulesResult:e[1]&&(null===(s=null===(o=e[1])||void 0===o?void 0:o.payload)||void 0===s?void 0:s.visible)})}),JSON.stringify(t)}function Q(e){return Object(O.a)(e)!==C.a.MailApp&&Object(E.f)(e,I.Sg)}function X(e,t){return!!e.startsWith("MailApp.")&&(0===t.length||t.some(e=>{var t;return null===(t=e.Attributes.Library)||void 0===t?void 0:t.toLowerCase().includes("new_mailappscriptresource")}))}function Y(e,t,n){const r=function(e,t){const n=e.EnableRules,r=e.DisplayRules,a=new Set;for(const e of[n,r])for(const t in e)for(const n in e[t]){const r=e[t][n].Rules;for(const e of r)4===e.RuleType&&a.add(e.Library)}const i=/^\$webresource:/i;return Object(w.e)(t(),Array.from(a)).map(e=>e.replace(i,""))}(e,n);return t(Object(j.g)(r)).catch(e=>{})}function J(e,t,n){return Object(E.f)(n(),I.Y)?Y(e,t,n):null}},"6kq6":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("KdpX");function a({navPath:e,dashboardId:t,etn:n,type:a,canOverride:i}){return{type:"dashboard.retrieveDashboard",execute:({dispatch:o})=>o(Object(r.d)(e,t,n,a,i)).then(e=>({retrievedId:e})).catch(e=>({error:e}))}}},"6lVV":function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"g",(function(){return m})),n.d(t,"b",(function(){return p})),n.d(t,"h",(function(){return b})),n.d(t,"f",(function(){return _})),n.d(t,"e",(function(){return y})),n.d(t,"d",(function(){return v})),n.d(t,"c",(function(){return f}));var r=n("a8hT"),a=n("37s6"),i=n("+qat"),o=n("Lyxw"),s=n("sZ+8"),c=n("3/02"),l=n("Er26");let u=null;const d="offline.forced.sync",p="offline.immediate.sync",f="OfflineImmediateSync";let g={},h="";function m(e){return{type:d,payload:{isForcedSyncInProgress:e}}}function b(e){return{type:p,payload:{isImmediateOfflineDataSyncInProgress:e}}}function y(e,t){return{type:"immediate.sync",execute({dispatch:n,getState:d},p){const m=p.TraceManager.getTracer(f);if(!(Object(o.f)(d(),c.Kd)&&Object(o.f)(d(),c.mf)&&Object(a.D)(d())&&e&&e.length))return void m.warn("immediateOfflineDataSync: FCB FCB.ImmediateOfflineDataSync / FCB.OfflineByDefault not enabled or app is not offline enabled");if(e)for(const t of e)if(!Object(s.n)(d(),t))return void m.warn(`immediateOfflineDataSync: Entity ${t} is not available for offline usage`);if(g&&t&&g.hasOwnProperty(t))return m.warn("immediateOfflineDataSync: returning existing promise for syncId =  "+t),g[t];const y=new Promise((t,o)=>{(Object(a.r)(d())?n(Object(i.a)(l.h)):Promise.resolve()).finally(()=>{Object(a.o)(d())||n(b(!0)),u&&(u(),u=null),u=t}),Object(a.D)(d())&&Object(r.e)().then(t=>{n(t.startOfflineDataSync(void 0,e))})}).finally(()=>{g&&t&&g.hasOwnProperty(t)&&delete g[t]});return t&&(m.warn("immediateOfflineDataSync: starting sync for syncId =  "+t),g={},g[t]=y,h=t),y}}}function _(){u&&(u(),u=null)}function v(){return h}},"6u68":function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n("/D1P");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="offline.upsync.pending";function i(){const e={upSyncStatus:r.a.Pending};return{type:a,payload:e}}},"6zk2":function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.Default=0]="Default",e[e.IfRowVersionMatches=1]="IfRowVersionMatches",e[e.AlwaysOverwrite=2]="AlwaysOverwrite"}(r||(r={}))},"74Tm":function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e){return e.personalizations.recordSetNavigatorCollapse}n.d(t,"a",(function(){return r}))},"7CnF":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.clockSkewRefreshDurationInMins=e,this._reset()}return e.prototype.allowRequestSending=function(){return this._isFirstRequest&&!this._clockSkewSet?(this._isFirstRequest=!1,this._allowRequestSending=!1,!0):this._allowRequestSending},e.prototype.shouldAddClockSkewHeaders=function(){return this._shouldAddClockSkewHeaders},e.prototype.getClockSkewHeaderValue=function(){return this._clockSkewHeaderValue},e.prototype.setClockSkew=function(e){this._clockSkewSet||(e?this._clockSkewHeaderValue=e:this._shouldAddClockSkewHeaders=!1,this._clockSkewSet=!0,this._allowRequestSending=!0)},e.prototype._reset=function(){var e=this;this._isFirstRequest=!0,this._clockSkewSet=!1,this._allowRequestSending=!0,this._shouldAddClockSkewHeaders=!0,this._clockSkewHeaderValue="use-collector-delta",this.clockSkewRefreshDurationInMins>0&&setTimeout((function(){return e._reset()}),6e4*this.clockSkewRefreshDurationInMins)},e}();t.default=r},"7F2l":function(e,t,n){"use strict";n.d(t,"c",(function(){return d})),n.d(t,"b",(function(){return g})),n.d(t,"a",(function(){return h}));var r=n("Uv1Y"),a=n("Er26"),i=n("1Xob"),o=n("SRlt"),s=n("g22U"),c=n("Wc7r"),l=n("/oKV"),u=n("69Qu");function d(e,t,n,i){var o,d,p;const f=Object(r.e)(t);return!function(e,t){return null!=e&&-2147015421===e&&t&&t.subType===s.c.AssetLoader}(f,e)&&(((null==e?void 0:e.type)!==s.d.GCM||(null===(o=null==n?void 0:n.additionalParameters)||void 0===o?void 0:o[a.i])!==l.a.LocalAndRemote||(null===(d=null==n?void 0:n.additionalHeaders)||void 0===d?void 0:d[c.HEADER.EXECUTION_HINT])!==c.EXECUTION_HINTS.OFFLINE||!Object(u.d)(i))&&(("sharepointdocument"!==(null===(p=null==n?void 0:n.additionalParameters)||void 0===p?void 0:p[a.e])||-2147088615!==f)&&!(e&&"RenewCookie"===e.subType)))}function p(e,t){const n=Object(r.e)(e);return!(null!=n&&[-2147217919,-2147220969,-2147220891,-2147220956,-2147220960,-2147217122,-2147167669,-2147220955,-2147086061].indexOf(n)>-1)&&!!function(e,t){if(-2147088246===e&&(null==t?void 0:t.startsWith("Resource not found for the segment"))&&!(null==t?void 0:t.endsWith("'null'.")))return!1;return!0}(n,t)}function f(e,t,n){switch(e){case a.k.ModernDataSource:case a.k.ModernDataSourceGCM:case a.k.MdlHttpClient:case a.k.MdlMetadataClient:case a.o.Upsync:case o.b:return p(t,n);case a.o.DataSync:return function(e,t){const n=Object(r.e)(e),a=[i.a.InvalidSubscription,i.a.InvalidMetadata,i.a.AuthenticationError,i.a.InvalidSubscriptionInLoop,i.a.SyncHandlerNotAvailable,-2147093999],o=["Synchronization interrupted by the user!"];return!(null!=n&&a.indexOf(n)>-1||o.indexOf(t)>-1)}(t,n);default:return!0}}function g(e,t,n){return f(e,t,n)}function h(e){const t=Object(r.e)(e);return!(null!=t&&[-2147220891,-2147220956].indexOf(t)>-1)}},"7Gx7":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class r{constructor(e){this._dictionary=null,this._dictionary=e}get_dictionary(){return this._dictionary}}},"7HpW":function(e,t,n){"use strict";n.d(t,"d",(function(){return u})),n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return s}));var r=n("d6Hx"),a=n("wL2W");function i(e){if(!e)return[];const t=[];for(const n of e.AreaIds)if(n!==r.c){const r=e.Areas[n];t.push(r)}return t}function o(e){if(!e||!e.GroupIds)return[];const t=[],n=e.GroupIds;for(const r of n)t.push(e.Groups[r]);return t}function s(e){const t=[],n=e.SubAreaIds;for(const r of n)c(r)&&t.push(e.SubAreas[r]);return t}function c(e){let t;switch(e){case"nav_manageflow":case"nav_personalwall":t=!1;break;default:t=!0}return t}function l(e){return e.Entity||e.DefaultDashboard||e.Page||e.DynamicPage||e.Url&&((t=e.Url).startsWith("http")||t.includes("main.aspx")||t.includes("/workplace/home_dashboards.aspx")||t.includes("/WebResources/"));var t}function u(e,t){if(!e)return null;const n=[],i={},o=Object(a.a)(),s=[],c=[],u=[];for(const t of e.AreaIds){if(t===r.c)continue;const a=e.Areas[t],d=a.GroupIds,p={},f=[];for(const e of d){const t=a.Groups[e],n=t.SubAreaIds,r={},i=[];for(const e of n){const n=t.SubAreas[e];l(n)?(i.push(e),r[e]=n):o&&s.push(e)}t.SubAreas=r,t.SubAreaIds=i,t.SubAreaIds.length>0?(f.push(e),p[e]=t):o&&c.push(e)}a.Groups=p,a.GroupIds=f,a.GroupIds.length>0?(n.push(t),i[t]=a):o&&u.push(t)}if(e.AreaIds=n,e.Areas=i,o){const e=[];e.push({name:"SubAreas filtered out from sitemap",value:s.toString()}),e.push({name:"Empty groups filtered out from sitemap",value:c.toString()}),e.push({name:"Empty areas filtered out from sitemap",value:u.toString()}),t&&t.warn("SubAreas filtered from sitemap descriptor",e)}return e}},"7Mzt":function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="editform.toggle.command.manager";function a(e){return{type:r,payload:{perfRenderCmdBar:e}}}},"7NKF":function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="offline",a="localServer",i="nativeApplication"},"7O3c":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("nxt5");class a extends r.a{constructor(e,t,n){super("RetrieveProcessControlData"),this._entity=e,this._globalNavigationData=t,this._bpfDefinitionVersionNumber=n}get_entity(){return this._entity}get_globalNavigationData(){return this._globalNavigationData}get_bpfDefinitionVersionNumber(){return this._bpfDefinitionVersionNumber}}},"7Sr4":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("pF61"),a=n("n3bs"),i=n("zmL5");let o=null;class s{constructor(){this._forceWorkOutstandingCallbacks=[],this._workOutstanding=[]}addWorkOutstandingPromise(e,t,n,r){const a=t?{callback:t,componentId:n,attributesPendingUpdate:r}:null;a&&this._forceWorkOutstandingCallbacks.push(a),this._workOutstanding.push(e),e.then(()=>{const t=this._forceWorkOutstandingCallbacks.indexOf(a);t>=0&&this._forceWorkOutstandingCallbacks.splice(t,1),this._workOutstanding.splice(this._workOutstanding.indexOf(e),1)})}getAttributesPendingUpdate(){const e=new Set;for(let t=0;t<this._forceWorkOutstandingCallbacks.length;t++)this._forceWorkOutstandingCallbacks[t].attributesPendingUpdate&&this._forceWorkOutstandingCallbacks[t].attributesPendingUpdate.forEach(t=>e.add(t));return e}checkForOutstandingWork(e,t){const n=[];for(let a=0;a<this._forceWorkOutstandingCallbacks.length;a++){const{callback:i,componentId:o}=this._forceWorkOutstandingCallbacks[a],s=null!=t?t:Object(r.c)(e),c=this._getChildComponents(e,s);!o||o===s||c.includes(o)?i():n.push(this._forceWorkOutstandingCallbacks[a])}return this._forceWorkOutstandingCallbacks=n,Promise.all(this._workOutstanding)}static getInstance(){return o||(o=new s),o}_getChildComponents(e,t){let n=[];switch(Object(r.j)(e,t)){case a.a.ENTITY_RECORD:n=Object(i.c)(e,t)}return n}}},"7XzV":function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"h",(function(){return i})),n.d(t,"e",(function(){return o})),n.d(t,"i",(function(){return s})),n.d(t,"d",(function(){return c})),n.d(t,"g",(function(){return l})),n.d(t,"f",(function(){return u})),n.d(t,"a",(function(){return d}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="Info",a="Details",i="Sales",o="Marketing",s="Service",c="InternetMarketing",l="ProcessCenter",u="Processes",d="Async"},"7ZMh":function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("pgSX"),a=n("si7p"),i=n("ngeo"),o=n("YxC/"),s=n("EY5k"),c=n("tICD"),l=n("8MGk");function u(e,t){return{type:"form.script.error.dialog",execute(n,u,d){var p,f,g;const h=t.errorCode?t.errorCode:2153976091,m=null===(p=t.errorFault)||void 0===p?void 0:p.message,b=null===(f=t.errorFault)||void 0===f?void 0:f.stack,y=null===(g=t.details)||void 0===g?void 0:g.split("\n"),_="0x"+i.a.getHexErrorCodeFromInt(h),v="Error_Title_"+_,S="Error_Message_"+_,O=[v,S,"SolutionWizard.Button.Export.Tooltip","Button_Label_OK","Web.Dialog.ErrorCode_Caption","Error_Title_0x8004b056","Error_Title_0x80700000","L_Show_Details_Text","L_Client_Session_Id","L_Current_Time","L_Correlation_Id","Error_Details"];return n.dispatch(Object(s.e)(O)).then(()=>{var i;const s=Object(o.e)(n.getState(),O),p=Object(o.c)(s,v);let f=Object(o.c)(s,S);const g=Object(o.c)(s,"SolutionWizard.Button.Export.Tooltip"),h=Object(o.c)(s,"Button_Label_OK"),_=Object(o.c)(s,"L_Show_Details_Text"),C=Object(o.c)(s,"L_Client_Session_Id"),E=Object(o.c)(s,"L_Current_Time"),I=Object(o.c)(s,"L_Correlation_Id"),w=Object(o.c)(s,"Error_Details")||"Error details:";f=f.replace("\\r\\n{0}","");const j=C.replace("{0}",u.EventManager.getCurrentSessionId()),P=E.replace("{0}",""+new Date),T=I.replace("{0}",d.correlationId);n.dispatch(Object(r.a)(a.d,m,{type:"error"},g,p,f,h,_,[...(null===(i=null==m?void 0:m.toString())||void 0===i?void 0:i.split("\n"))||[],j,T,...y||[],P],void 0,e)).then(e=>{if(0===e.status)return n.dispatch(Object(c.a)(e.pageId)).then(e=>{if(e.value.confirmed&&(b||t.details)){const e=b&&t.details?`${b}\n\n${w}\n${t.details}`:b||t.details,r={mimeType:"text/plain",fileName:"ErrorDetails.txt",fileContent:btoa(unescape(encodeURIComponent(e))),fileSize:e.length},a={openMode:2};new l.a(u,n).openFile(r,a)}});throw e.error})})}}}},"7cfk":function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.Not_Initialized=0]="Not_Initialized",e[e.Initialized=1]="Initialized",e[e.Initialize_Failed=2]="Initialize_Failed"}(r||(r={}))},"7iDi":function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e.button="button",e.standard="standard",e.iFrame="iframe",e.lookup="lookup",e.optionSet="optionset",e.subGrid="subgrid",e.webResource="webresource",e.notes="notes",e.timer="timercontrol",e.kbsearch="kbsearch",e.customcontrol="customcontrol",e.customsubgrid="customsubgrid",e.quickFormControl="quickform",e.timeline="timeline",e.timelinewall="timelinewall",e.multiSelectOptionSet="multiselectoptionset"}(r||(r={}))},"7kVW":function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return d}));var r=n("uhZ3"),a=n("b02z"),i=n("n48k"),o=n("YxC/"),s=n("09gH"),c=n("zipJ");function l(e){return"integer"===e.Type&&("duration"===e.Format||"1"===e.Format)}function u(e,t){if(!Object(r.b)(e)&&!Object(c.b)(e)){let n=e.toString().trim();if(!t)return!1;const{regexMinutes:r,regexHours:a,regexDays:i}=t;if(r.test(n))n=n.replace(r,"").trim();else if(a.test(n))n=n.replace(a,"").trim();else{if(!i.test(n))return!1;n=n.replace(i,"").trim()}return Object(c.b)(n)}return!0}function d(e,t){const n=Object(o.c)(t,s.e),r=new RegExp("^"+Object(o.c)(t,s.h)+"\\s|\\s"+Object(o.c)(t,s.h)+"$|^"+Object(o.c)(t,s.i)+"\\s|\\s"+Object(o.c)(t,s.i)+"$"),c=new RegExp("^"+Object(o.c)(t,s.f)+"\\s|\\s"+Object(o.c)(t,s.f)+"$|^"+Object(o.c)(t,s.g)+"\\s|\\s"+Object(o.c)(t,s.g)+"$"),d=new RegExp("^"+Object(o.c)(t,s.c)+"\\s|\\s"+Object(o.c)(t,s.c)+"$|^"+Object(o.c)(t,s.d)+"\\s|\\s"+Object(o.c)(t,s.d)+"$");return l(e)?Object(a.a)(u,i.a[i.a.Duration],n,{regexMinutes:r,regexHours:c,regexDays:d}):null}},"7tM0":function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return c}));var r=n("IqkD"),a=n("NjDY"),i=n("3mEc");function o(e,t,n){const r=e[t+(n?"."+n:"")+".resx"];return r&&r.contentJson?r.contentJson:null}function s(e,t){const n=Object(i.k)(e);if(!n)return null;let s;if(s=o(n,t,Object(r.x)(e).languageId),s)return s;if(s=o(n,t,Object(a.D)(e).languageCode),s)return s;if(s=o(n,t,null),s)return s;const c=n[t];return c&&c.contentJson?c.contentJson:null}function c(e,t,n){const r=s(e,t);return r?r[n]:null}},"83Lp":function(e,t,n){"use strict";n.d(t,"d",(function(){return d})),n.d(t,"b",(function(){return p})),n.d(t,"a",(function(){return f})),n.d(t,"c",(function(){return g})),n.d(t,"h",(function(){return y})),n.d(t,"e",(function(){return h})),n.d(t,"g",(function(){return m})),n.d(t,"f",(function(){return v}));var r=n("yJdb"),a=n("LMh4"),i=n("dDbD"),o=n("pEXn"),s=n("6/BY"),c=n("gy+e"),l=n("xM/W"),u=n("a8hT");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const d="offline.showreconnectnotification",p="offline.hidereconnectnotification",f="offline.clearreconnectnotification",g="offline.setreconnectstatus";function h(){return{type:"offline.cancelreconnect",execute:({dispatch:e,getState:t},n)=>(n.TraceManager.getTracer("Offline").warn("offlineReconnectNotification: Cancel"),e(_()),Promise.resolve())}}function m(e,t,n,d=!1){return{type:"offline.reconnect",execute(p,f){const g=f.TraceManager.getTracer("Offline");g.warn("offlineReconnectNotification: Reconnect"+(d?" (auto)":""));const h=[];return d||p.dispatch(Object(a.b)(e)),Object(u.g)().then(e=>p.dispatch(Object(i.pingServer)()).then(e=>{e?(Object(c.a)(f,p).then(()=>{d?p.dispatch(Object(l.b)(!0)):(Object(s.a)(p.dispatch,1,t),p.dispatch(Object(r.b)())),p.dispatch(S(!0)),f.EventManager.ReportComponentSuccess("Offline.Reconnect")}).catch(e=>{b(p.dispatch,d,n),h.push({name:o.b.ReconnectErrorMessage,value:"Error Happens when refreshing auth token."}),h.push({name:o.b.AutomaticReconnect,value:d}),f.EventManager.ReportComponentFailure("Offline.Reconnect",e,null,h)}),p.dispatch(_())):(b(p.dispatch,d,n),h.push({name:o.b.AutomaticReconnect,value:d}),g.error("Server is not available",h))}).catch(e=>{b(p.dispatch,d,n),h.push({name:o.b.ReconnectErrorMessage,value:"Error Happens when pinging the server."}),h.push({name:o.b.AutomaticReconnect,value:d}),f.EventManager.ReportComponentFailure("Offline.Reconnect",e,null,h)}))}}}function b(e,t,n){t||(Object(s.a)(e,2,n),e(Object(r.b)())),e(S(!1))}function y(e){return{type:d,payload:{isReconnectNotificationShown:!0,isServerUnavailableNewSession:!1,type:e}}}function _(){return{type:p,payload:{isReconnectNotificationShown:!1,isServerUnavailableNewSession:!1}}}function v(){return{type:f,payload:{isServerUnavailableNewSession:!0}}}function S(e){return{type:f,payload:{isReconnectSuccessful:e}}}},"84PK":function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n("504W");let a=null,i=null,o=null,s=null,c=null;class l{constructor(e,t){if(this._rawGuid=null,this._formattedGuid=null,t)this._rawGuid=e;else if(this._rawGuid=u(e),Object(r.b)(this._rawGuid))throw Error.argumentOutOfRange(String.format("'{0}' is not a valid Guid value.",e))}getObjectData(){return{rawguid:this._rawGuid}}equals(e){if(e instanceof l)return e._rawGuid===this._rawGuid;if("string"==typeof e)try{return new l(e)._rawGuid===this._rawGuid}catch(e){return!1}return!1}toString(){return this._formattedGuid||(this._formattedGuid=this._rawGuid.substring(0,8)+"-"+this._rawGuid.substring(8,12)+"-"+this._rawGuid.substring(12,16)+"-"+this._rawGuid.substring(16,20)+"-"+this._rawGuid.substring(20,32)),this._formattedGuid}static get_empty(){return a||(a=new l("00000000000000000000000000000000",!0))}static createFromObjectData(e){return new l(e.rawguid)}static tryCreate(e){const t=u(e);return Object(r.b)(t)?l.get_empty():new l(t)}static createFromFormattedGuidStringAndSkipParsing(e){return new l(e.replace(d(),""),!0)}static isNullOrEmpty(e){return!(!Object(r.a)(e)&&e.length)||!!new l(e).equals(a)}static newGuid(){let e="";for(let t=0;t<36;t++)if(14!==t){if(8!==t&&13!==t&&18!==t&&23!==t){if(19===t){const e=Math.floor(16*Math.random());"0123456789abcdef".substr(3&e|8,1)}e+="0123456789abcdef".substr(Math.floor(16*Math.random()),1)}}else e+="4";return new l(e,!0)}}function u(e){return Object(r.b)(e)?null:(e=e.toLowerCase(),(o||(o=new RegExp("^(\\d|[a-f]){8}-(\\d|[a-f]){4}-(\\d|[a-f]){4}-(\\d|[a-f]){4}-(\\d|[a-f]){12}$"))).test(e)||(s||(s=new RegExp("^{(\\d|[a-f]){8}-(\\d|[a-f]){4}-(\\d|[a-f]){4}-(\\d|[a-f]){4}-(\\d|[a-f]){12}}$"))).test(e)?e.replace(d(),""):(c||(c=new RegExp("^(\\d|[a-f]){32}$"))).test(e)?e:null)}function d(){return i||(i=new RegExp("{|}|-","g"))}l.__typeName="Microsoft.Crm.Client.Core.Framework.Guid"},"84uC":function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.greaterThan=0]="greaterThan",e[e.lessThan=1]="lessThan"}(r||(r={}))},"85o3":function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"e",(function(){return f})),n.d(t,"d",(function(){return g})),n.d(t,"b",(function(){return h})),n.d(t,"c",(function(){return S})),n.d(t,"f",(function(){return m})),n.d(t,"i",(function(){return w})),n.d(t,"j",(function(){return O})),n.d(t,"g",(function(){return I})),n.d(t,"h",(function(){return E}));var r=n("504W"),a=n("SAYH"),i=n("q/7h"),o=n("vNXc"),s=n("EY5k"),c=n("YxC/"),l=n("/oKV"),u=n("5qiD"),d=n("d+dp");const p="2d8d408d-c255-4587-9e34-596d496e6738",f="e611d950-6bab-477c-a5a3-7e9a447b326d",g="436e2293-da8f-4ef9-a1e6-fff25a5beb22",h="c05b417b-708d-4d50-a1e1-6660bb32b9ef",m="gridFilters.retrieve.success",b=["Workplace_Queue_Selector_All","Workplace_Queue_Selector_Public","Workplace_Queue_Selector_Private"],y="0",_="name",v="queueviewtype",S=",";function O({dispatch:e,getState:t},n,p,f,g){return new Promise((p,f)=>{const m=[],S=[],O=[],E=n.DataSource,I=o.a.fromXml("<fetch version= '1.0' mapping='logical' distinct='true' >\n\t\t\t\t\t\t\t<entity name='queue'>\n\t\t\t\t\t\t\t\t<attribute name='name' />\n\t\t\t\t\t\t\t\t<attribute name='queueviewtype' />\n\t\t\t\t\t\t\t\t<attribute name='queueid' />\n\t\t\t\t\t\t\t\t\t<link-entity name='queuemembership' from='queueid' to='queueid' visible='false' link-type='outer' alias='membership' >\n\t\t\t\t\t\t\t\t\t\t<filter type='and'>\n\t\t\t\t\t\t\t\t\t\t\t<condition attribute='systemuserid' operator='eq-userid' />\n\t\t\t\t\t\t\t\t\t\t</filter>\n\t\t\t\t\t\t\t\t\t</link-entity>\n\t\t\t\t\t\t\t\t\t<filter type='or'>\n\t\t\t\t\t\t\t\t\t\t<condition entityname='membership' attribute='systemuserid' operator='eq-userid' />\n\t\t\t\t\t\t\t\t\t\t<condition entityname='queue' attribute='queueviewtype' operator='eq' value='0' />\n\t\t\t\t\t\t\t\t\t</filter>\n\t\t\t\t\t\t\t\t\t<filter type='and'>\n\t\t\t\t\t\t\t\t\t\t<condition attribute='statecode' operator='eq' value='0' />\n\t\t\t\t\t\t\t\t\t</filter>\n\t\t\t\t\t\t\t\t\t<order attribute=\"name\" descending=\"false\" />\n\t\t\t\t\t\t\t</entity>\n\t\t\t\t\t\t</fetch>",new a.a(h));I.pageSize=5e3;const w=I.getKeyQuery(),j=new d.a(u.a.NotCached,l.a.Remote),P=E.retrieveMultiple(w,j,null,g).nativePromise().then(e=>{const n=Object(i.a)(e,t()),o=m.length;for(let e=0;e<n.length;e++){const t=n[e].fields[v],i=null!=t&&t.valueString===y,s=a.a.toString(n[e].identifier.id);i?O.push(s):S.push(s);const c=`${o+e}:${s}`,l=Object(r.a)(n[e].fields[_])?"":n[e].fields[_].value;m.push({value:c,text:l,isDefault:!1})}}),T=e(Object(s.e)(b));Promise.all([T,P]).then(()=>{const e=Object(c.e)(t(),b);C(m,e),p(m)})})}function C(e=[],t){const n=e.length;return e.push({value:`${n}:${p}`,text:null==t?void 0:t.Workplace_Queue_Selector_All,isDefault:!1}),e.push({value:`${n+1}:${f}`,text:null==t?void 0:t.Workplace_Queue_Selector_Public,isDefault:!1}),e.push({value:`${n+2}:${g}`,text:null==t?void 0:t.Workplace_Queue_Selector_Private,isDefault:!0}),e}function E(){var e,t;const n=null===(t=null===(e=C().filter(e=>e.isDefault))||void 0===e?void 0:e[0])||void 0===t?void 0:t.value,r=null==n?void 0:n.split(":");return(null==r?void 0:r.length)>1?r[1]:n}function I(){return new Promise((e,t)=>{e([])})}function w(e,t,n,r){return{type:"gridFilters.retrieve.async",execute:(a,i)=>n(a,i,e,t,r).then(t=>(a.dispatch(function(e,t){return{type:m,payload:{entityFilters:{[e]:t}}}}(e,t)),t))}}},"8CLP":function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.ProfileUnavailable=1]="ProfileUnavailable",e[e.DatabaseUnavailable=2]="DatabaseUnavailable",e[e.MetadataChanged=3]="MetadataChanged",e[e.SyncFailure=-1]="SyncFailure",e[e.UpgradeClient=-2]="UpgradeClient"}(r||(r={}))},"8Jtx":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="Button_Label_Close",a=[r]},"8MGk":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("IpQH"),a=n("uM6Y"),i=n("VkXQ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class o extends r.a{constructor(e,t){super(e,t,a.f)}openFile(e,t){const n=t||{openMode:1};return this.execute(i.f.openFile.name,e,n)}pickFile(e){return this.execute(i.f.pickFile.name,e)}}},"8Mff":function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.Default=0]="Default",e[e.Enabled=1]="Enabled",e[e.Disabled=2]="Disabled"}(r||(r={}))},"8N/3":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("OwbH"),a=n("kToj"),i=n("504W"),o=n("KJT0");class s extends r.a{constructor(e,t,n,r){super([e]),this._leftBound=null,this._rightBound=null,this._intervalType=0,this._leftBound=t,this._rightBound=n,this._intervalType=r}get_leftBound(){return this._leftBound}get_rightBound(){return this._rightBound}get_intervalType(){return this._intervalType}testCondition(e){let t=!1;if(!Object(i.a)(e))switch(this.get_intervalType()){case 0:t=e>=this.get_leftBound()&&e<=this.get_rightBound();break;case o.a.open:t=e>this.get_leftBound()&&e<this.get_rightBound();break;case o.a.openLeft:t=e>this.get_leftBound()&&e<=this.get_rightBound();break;case o.a.openRight:t=e>=this.get_leftBound()&&e<this.get_rightBound();break;default:Object(a.a)(!1,"unknown range type")}return t}}},"8VF0":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));const r="entityMetadata.retrieve";function a(e){return{type:r,payload:e}}},"8a7L":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(){function e(e,t,n){this._etn=e,this._id=t||"",this._name=n,Object.freeze(this)}return Object.defineProperty(e.prototype,"entityName",{get:function(){return this._etn},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"entityType",{get:function(){return this._etn},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"logicalName",{get:function(){return this._etn},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"LogicalName",{get:function(){return this._etn},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Id",{get:function(){return this._Id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Name",{get:function(){return this._name},enumerable:!1,configurable:!0}),e.toString=function(e){return e.entityName+":"+e.id},e.equals=function(e,t){return!e&&!t||!(!e||!t)&&(e.entityName===t.entityName&&e.id===t.id&&e.name===t.name)},e.EMPTY=new e(""),e}()},"8aQ2":function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n("KdpX"),a=n("OtHk"),i=n("K7RF"),o=n("/oKV"),s=n("iJGp");let c=!0;function l(e,t){return c?{type:"grid.retrieveEntityDashboardSelectors.async",execute:({dispatch:n,getState:l})=>Object(a.g)(l(),e)?Promise.resolve():n(function(e,t){return Object(i.b)("dashboardselector",null,e,null,!0,s.a.OnDemandWithContext,null,null,[],null,t)}(e,o.a.LocalAndRemote)).then(()=>{if(!Object(a.g)(l(),e))return c=!1,n(Object(r.d)(null,null,e,void 0,void 0,void 0,t))})}:Object(r.d)(null,null,e,void 0,void 0,void 0,t)}},"8aze":function(e,t,n){"use strict";function r(e){return e.style?(Object.assign(e.style,function(e){if(!e)return{};var t={};null!=e.borderBottomWidth&&(t.borderBottomWidth=a(e.borderBottomWidth));null!=e.borderLeftWidth&&(t.borderLeftWidth=a(e.borderLeftWidth));null!=e.borderRightWidth&&(t.borderRightWidth=a(e.borderRightWidth));null!=e.borderTopWidth&&(t.borderTopWidth=a(e.borderTopWidth));null!=e.borderWidth&&(t.borderWidth=a(e.borderWidth));null!=e.height&&(t.height=a(e.height));null!=e.width&&(t.width=a(e.width));null!=e.minWidth&&(t.minWidth=a(e.minWidth));null!=e.minHeight&&(t.minHeight=a(e.minHeight));null!=e.maxWidth&&(t.maxWidth=a(e.maxWidth));null!=e.maxHeight&&(t.maxHeight=a(e.maxHeight));null!=e.margin&&(t.margin=a(e.margin));null!=e.marginBottom&&(t.marginBottom=a(e.marginBottom));null!=e.marginLeft&&(t.marginLeft=a(e.marginLeft));null!=e.marginRight&&(t.marginRight=a(e.marginRight));null!=e.marginTop&&(t.marginTop=a(e.marginTop));null!=e.padding&&(t.padding=a(e.padding));null!=e.paddingBottom&&(t.paddingBottom=a(e.paddingBottom));null!=e.paddingLeft&&(t.paddingLeft=a(e.paddingLeft));null!=e.paddingRight&&(t.paddingRight=a(e.paddingRight));null!=e.paddingTop&&(t.paddingTop=a(e.paddingTop));null!=e.position&&(t.position=a(e.position));null!=e.bottom&&(t.bottom=a(e.bottom));null!=e.right&&(t.right=a(e.right));null!=e.top&&(t.top=a(e.top));null!=e.left&&(t.left=a(e.left));null!=e.flex&&(t.flex=(n=e.flex,r=Number(n),isNaN(r)?n:r));var n,r;null!=e.animationDirection&&(t.animationDirection=e.animationDirection);null!=e.animationDuration&&(t.animationDuration=e.animationDuration);null!=e.animationFillMode&&(t.animationFillMode=e.animationFillMode);null!=e.animationIterationCount&&(t.animationIterationCount=e.animationIterationCount);null!=e.animationName&&(t.animationName=e.animationName);null!=e.backgroundColor&&(t.backgroundColor=e.backgroundColor);return t}(e.style)),e.style):{}}function a(e){return"number"==typeof e?e.toString()+"px":e}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));var i=function(e){return{rule:r(e)}}},"8f6m":function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n("/6en");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(){return{entities:[{}],totalProgress:r.e,downloadedFileCount:0,totalFileCount:0,totalErrorCount:0,filesSize:0,annotationFilesSize:0}}function i(e,t){for(const n of e.entities)n.entityName&&t.get(n.entityName)&&(n.entityName=t.get(n.entityName));return e}function o(e){const t=[];for(const n of e.entities)t.push(n.entityName);return t}},"8i4h":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("Er26"),a=n("g22U");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function i(e,t,n,i){switch(e){case a.d.CREATE:return{[a.a.TYPE]:a.d.CREATE,[a.a.SUB_TYPE]:i||a.c.Create,[r.e]:n,[a.a.SOURCE]:t};case a.d.UPDATE:return{[a.a.TYPE]:a.d.UPDATE,[a.a.SUB_TYPE]:i||a.c.Update,[r.e]:n,[a.a.SOURCE]:t};case a.d.DELETE:return{[a.a.TYPE]:a.d.DELETE,[a.a.SUB_TYPE]:i||a.c.Delete,[r.e]:n,[a.a.SOURCE]:t};case a.d.RETRIEVE_MULTIPLE:return{[a.a.TYPE]:a.d.RETRIEVE_MULTIPLE,[a.a.SUB_TYPE]:i||a.c.RetrieveMultipleOther,[r.e]:n,[a.a.SOURCE]:t};case a.d.RETRIEVE:return{[a.a.TYPE]:a.d.RETRIEVE,[a.a.SUB_TYPE]:i||a.c.Retrieve,[r.e]:n,[a.a.SOURCE]:t}}}},"8kVO":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));class r{constructor(e,t){this._CommandType=0,this._AssociatedMainLog=null,this._AssociatedEntityLog=null,this._SQLOperation=0,this._EntityRecord=null,this._AssociatedActivityParties=null,this._set_commandType(0),this.set_sqlOperation(e),this.set_entityRecord(t),this.set_associatedActivityParties([])}get_commandType(){return this._CommandType}_set_commandType(e){return this._CommandType=e,e}get_associatedMainLog(){return this._AssociatedMainLog}set_associatedMainLog(e){return this._AssociatedMainLog=e,e}get_associatedEntityLog(){return this._AssociatedEntityLog}set_associatedEntityLog(e){return this._AssociatedEntityLog=e,e}get_sqlOperation(){return this._SQLOperation}set_sqlOperation(e){return this._SQLOperation=e,e}get_entityRecord(){return this._EntityRecord}set_entityRecord(e){return this._EntityRecord=e,e}get_associatedActivityParties(){return this._AssociatedActivityParties}set_associatedActivityParties(e){return this._AssociatedActivityParties=e,e}}},"8mbc":function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r={EventManager:"EventManager",TraceManager:"TraceManager",EventListeners:"EventListeners",Performance:"Performance",TelemetryArchiver:"TelemetryArchiver",TelemetryQueue:"TelemetryQueue",AriaClient:"AriaClient"},a="*"},"8nT0":function(e,t,n){"use strict";n.d(t,"f",(function(){return r})),n.d(t,"x",(function(){return a})),n.d(t,"y",(function(){return i})),n.d(t,"s",(function(){return o})),n.d(t,"z",(function(){return s})),n.d(t,"v",(function(){return c})),n.d(t,"t",(function(){return l})),n.d(t,"A",(function(){return u})),n.d(t,"a",(function(){return d})),n.d(t,"l",(function(){return p})),n.d(t,"j",(function(){return f})),n.d(t,"i",(function(){return g})),n.d(t,"r",(function(){return m})),n.d(t,"h",(function(){return b})),n.d(t,"g",(function(){return y})),n.d(t,"u",(function(){return _})),n.d(t,"k",(function(){return v})),n.d(t,"m",(function(){return S})),n.d(t,"o",(function(){return O})),n.d(t,"n",(function(){return C})),n.d(t,"b",(function(){return E})),n.d(t,"q",(function(){return I})),n.d(t,"p",(function(){return w})),n.d(t,"B",(function(){return j})),n.d(t,"c",(function(){return P})),n.d(t,"d",(function(){return T})),n.d(t,"w",(function(){return h})),n.d(t,"e",(function(){return N}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="entityimage_url",a="statecode",i="statuscode",o="ownerid",s="transactioncurrencyid",c="regardingobjectid",l="processid",u="traversedpath",d="activestageid",p="fullname",f="filesizeinbytes",g="filesizebytes",h="sasurl",m="mimetype",b="filename",y="fileattachmentid",_="regardingfieldname",v="fullimageurl",S="imagedata",O="imagepixelwidth",C="imagepixelheight",E="colordepthbits",I="imageurl",w="imagetimestamp",j="versionnumber",P="devicefilepath",T="devicethumbnailpath",N="directioncode"},"8o18":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("WF3G"),a=n("84PK"),i=n("504W");class o extends r.a{constructor(e,t){super(e),this._overrideKey=null,this._sourceId=t}get_key(){if(!Object(i.b)(this._overrideKey))return this._overrideKey;let e;const t=a.a.tryCreate(this._sourceId);return e=t.equals(a.a.get_empty())?this._sourceId:t.toString(),this.get_EntityLogicalName()+","+e+","+this.get_returnTotalRecordCount()}get_DataLayerInternalCachingKey(){return`${this.get_key()}::${this.get_PageNumber()}`}get_SourceId(){return this._sourceId}get_OverrideKey(){return this._overrideKey}get_PublicKey(){return this._publicKey}set_OverrideKey(e){return this._overrideKey=e,e}set_PublicKey(e){return this._publicKey=e,this._publicKey}generateNorSyncAttributeName(e,t,n){return t}get_id(){return this.get_key()}}},"8tWD":function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.Json=0]="Json",e[e.FetchXml=1]="FetchXml",e[e.Sql=2]="Sql",e[e.LayoutXml=3]="LayoutXml"}(r||(r={}))},"8unZ":function(e,t,n){"use strict";function r(e){return e&&e.metadata&&e.metadata.appShellSettings&&e.metadata.appShellSettings.appNavSettings?e.metadata.appShellSettings.appNavSettings:null}function a(e){const t=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e){return e&&e.metadata&&e.metadata.appShellSettings?e.metadata.appShellSettings:null}(e);return t?t.initialized:null}n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return r}))},"8uvO":function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n("nA3O"),a=n("kToj"),i=n("7Gx7"),o=n("g73c"),s=n("NMtn");var c=n("M6xi"),l=n("504W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function u(e,t){return Object(l.a)(t)?e===Number||Type.isEnum(e)?0:e!==Boolean&&null:t}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class d{constructor(e,t,n,r){this._name=null,this._propertyType=null,this._ownerType=null,this._defaultValue=null,this._jsonConverter=c.a.defaultConverter,Object(a.a)(!Object(l.b)(e),"Property name must be a valid name."),Object(a.a)(!Object(l.a)(t),"propertyType cannot be null"),Object(a.a)(!Object(l.a)(n),"ownerType cannot be null"),this._name=e,this._propertyType=t,this._ownerType=n,this._defaultValue=u(t,r),this.AssertPropertyValue(this.get_defaultValue())}get_name(){return this._name}get_propertyType(){return this._propertyType}get_ownerType(){return this._ownerType}get_defaultValue(){return this._defaultValue}get_fullName(){return this.get_ownerType().getName()+"."+this.get_name()}get_jsonConverter(){return this._jsonConverter}set_jsonConverter(e){if(this._jsonConverter!==c.a.defaultConverter)throw Error.invalidOperation("Cannot set JsonConverter of a property twice.");return this._jsonConverter=e,e}coerceToPropertyType(e){if(void 0===e)return this.get_defaultValue();if(null===e)return u(this.get_propertyType(),e);if(this.get_propertyType().isInstanceOfType&&this.get_propertyType().isInstanceOfType(e)||"number"==typeof e&&this.get_propertyType()[e])return e;if("string"==typeof e){if(Type.isEnum(this.get_propertyType()))return Object(o.b)(this.get_propertyType(),e);if(this.get_propertyType()===Number){const t=Number.parseInvariant(e);if(!isNaN(t)&&isFinite(t))return t}const t=this.get_propertyType().parse;if(!Object(l.a)(t)){let n=null;try{n=t(e)}catch(t){n=JSON.parse(e)}if(void 0!==n)return n}}if("object"==typeof e&&this.get_propertyType()===Error)return function(e){Object(s.d)(e,"errorInformation");const t={};return t.message=e.errorMessage,t.name=e.errorType,t.exceptionString=e.errorString,t.innerException=e.errorCause,Error.create(t.message,t)}(e);let t=this.get_propertyType().create;if(!Object(l.a)(t))return t(e);if("object"==typeof e&&this.get_propertyType().prototype&&this.get_propertyType().prototype.getSchema){const t=new(this.get_propertyType());return t.setValues(e),t}const n=this.get_propertyType().getName()+"Converter";try{const r=Type.parse(n);if(!Object(l.a)(r)&&(t=r.create,!Object(l.a)(t)))return t(e)}catch(e){}throw Error.invalidOperation(this.get_fullName()+" cannot safely coerce "+Object.getType(e).getName()+" to "+this.get_propertyType().getName())}coerceToJsonType(e){return void 0===e?this._coerceToJsonTypeInternal(this.get_defaultValue()):null===e?null:(this.AssertPropertyValue(e),Type.isEnum(this.get_propertyType())?e:this._coerceToJsonTypeInternal(e))}AssertPropertyValue(e){if(void 0===e){if(this.get_propertyType()===Boolean)return;Object(a.a)(!1,String.format("{0} cannot be set to an undefined value.",this))}Object(a.a)(null===e||this.get_propertyType().constructor===Object||this.get_propertyType().isInstanceOfType(e)||Type.isEnum(this.get_propertyType())&&("number"==typeof e||"string"==typeof e),String.format("Cannot set an instance of {0} as the value of {1}, which requires values of type {2}.",null!==e?Object.getType(e).getName():null,this,this.get_propertyType().getName&&this.get_propertyType().getName()))}_coerceToJsonTypeInternal(e){if(null===e||"string"==typeof e||"number"==typeof e||"boolean"==typeof e)return e;const t=Object.getType(e);if(e instanceof r.a)return e.getValues();if(e instanceof Array){const t=e,n=[];for(let e=0;e<t.length;e++)n[e]=this._coerceToJsonTypeInternal(t[e]);return n}if(e instanceof i.a){const t=e.get_dictionary(),n={};for(const e in t){const r={key:e,value:t[e]};n[r.key]=this._coerceToJsonTypeInternal(r.value)}return n}let n=t.condense;if(!Object(l.a)(n))return n(e);if(e instanceof Error)return function(e){Object(s.d)(e,"exception");const t=e,n={};return n.errorMessage=t.message,n.errorType=t.name,n.errorString=t.exceptionString,n.errorCause=t.innerException,n}(e);const a=t.getName()+"Converter";try{const t=Type.parse(a);if(!Object(l.a)(t)&&(n=t.condense,!Object(l.a)(n)))return n(e)}catch(e){}throw Error.invalidOperation(this.get_fullName()+" cannot safely coerce "+this.get_propertyType().getName()+" to JSON")}}},"91WF":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("5yoC"),a=n("RIwK");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class i extends r.a{constructor(e,t,n,r,a,i,o,s,c,l,u,d,p,f){super(),this._originalFunction=null,this._functionRaw=null,this._message=r,this._lineNumber=e,this._url=s,this._exceptionNumber=l,this._clientName=d,this._clientState=p,this._callStack=f}get_name(){return"ScriptError"}requestBody(){return String.format('<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"><soap:Body><SendScriptErrorReport xmlns="http://schemas.microsoft.com/crm/2009/WebServices"><ReportVersion>1.0</ReportVersion>\r\n<ScriptErrorDetails>\r\n<Message>'+Object(a.b)(this._message)+"</Message>\r\n<ExceptionNumber>"+Object(a.b)(this._exceptionNumber.toString())+"</ExceptionNumber>\r\n<Line>"+this._lineNumber+"</Line>\r\n<URL>"+Object(a.b)(this._url)+"</URL>\r\n<PageURL>"+Object(a.b)(window.location.href)+"</PageURL>\r\n<Function>"+Object(a.b)(this._originalFunction)+"</Function>\r\n<FunctionRaw>"+Object(a.b)(this._functionRaw)+"</FunctionRaw>\r\n<CallStack>\r\n"+Object(a.b)(this._callStack)+"   </CallStack>\r\n</ScriptErrorDetails>\r\n<ClientInformation>\r\n<BrowserUserAgent>"+Object(a.b)(window.navigator.userAgent)+"</BrowserUserAgent>\r\n<BrowserLanguage>"+Object(a.b)(window.navigator.browserLanguage)+"</BrowserLanguage>\r\n<SystemLanguage>"+Object(a.b)(window.navigator.systemLanguage)+"</SystemLanguage>\r\n<UserLanguage>"+Object(a.b)(window.navigator.userLanguage)+"</UserLanguage>\r\n<ScreenResolution>"+window.screen.width+"x"+window.screen.height+"</ScreenResolution>\r\n<ClientName>"+Object(a.b)(this._clientName)+"</ClientName>\r\n<ClienState>"+Object(a.b)(this._clientState)+"</ClienState>\r\n<ClientTime>"+Object(a.b)((new Date).toDateString())+"</ClientTime>\r\n</ClientInformation>\r\n</SendScriptErrorReport></soap:Body></soap:Envelope>")}}i.scriptErrorRelativeWebEndpointUrl="/AppWebServices/ScriptError.asmx",i.scriptErrorSendReportSoapAction="http://schemas.microsoft.com/crm/2009/WebServices/SendScriptErrorReport"},"92OB":function(e,t,n){"use strict";n.d(t,"a",(function(){return Q}));var r=n("2yvP"),a=n("SAYH"),i=n("iZ7K"),o=n("IKHO"),s=n("omgb"),c=n("w1eR"),l=n("GYEz"),u=n("eXjw"),d=n("NjDY"),p=n("IqkD"),f=n("Lyxw"),g=n("TDVd"),h=n("69Qu"),m=n("LbMF"),b=n("3hnk"),y=n("bT7G"),_=n("WPtp"),v=n("5Oca"),S=n("i1f0"),O=n("dHD5"),C=n("3mEc"),E=n("pEXn"),I=n("kWiz"),w=n("FZDd"),j=n("lY/Z"),P=n("P6DH"),T=n("nlPs"),N=n("eD3A"),A=n("V6aM"),R=n("hAdb"),D=n("sZ+8"),x=n("bwbe"),M=n("xhhr"),F=n("5UJb"),k=n.n(F),L=n("Wz2A"),B=n("UJfx"),U=n("6hHv"),V=n("odYE"),z=n("Y2Yg"),q=n("K6rc"),H=n("mpSO"),W=n("RvmO"),G=n("Uv1Y"),K=n("Er26");class Q{constructor(e,t,n,r,a,i){this._pageId=e,this._commandManagerId=t,this._state=n,this._getState=r,this._applicationContext=a,this._dispatch=i,this._ruleCache={},this._evaluateParameters=new g.a}evaluateSyncRulesForCommand(e,t,n,r,a,i,o,s,c,l,u,d){const p=[];if(i&&p.push({name:"IndexEntity",value:i}),o&&p.push({name:"ControlId",value:o}),c&&p.push({name:"ContextKey",value:c}),r.length>0&&p.push({name:"CommandRules",value:r.join(",")}),a.EntityLogicalName&&p.push({name:"ContextEntity",value:a.EntityLogicalName}),a.ContextType&&p.push({name:"RibbonContextType",value:a.ContextType}),s&&p.push({name:"CommandManagerId",value:s}),this._trace(I.a.Verbose,"Start evaluate synchronous rules for",p),!e)return this._trace(I.a.Info,"Did not evaluate rules, because rule set array is empty",p),L.a.False;for(const t in r){const o=r[t];if(e[i]){const t=e[i];if(t[o]){const e=this._getRulePartsResultsForRuleId(o,n,l,u),r=this._evaluateSyncRuleParts(o,t[o].Rules,a,s,c,p,e,d);switch(n){case U.b:l[o].ruleIdResult=this._isNullOrUndefined(r)?null:r.toString(),l[o].rulePartsResults=e;break;case U.a:default:u[o].ruleIdResult=this._isNullOrUndefined(r)?null:r.toString(),u[o].rulePartsResults=e}if(r===L.a.False)return L.a.False}}}return L.a.True}async evaluateAsyncRulesForCommand(e,t,n,r,a,i,o,s,c,l,u){const d=[];if(i&&d.push({name:"IndexEntity",value:i}),o&&d.push({name:"ControlId",value:o}),c&&d.push({name:"ContextKey",value:c}),r.length>0&&d.push({name:"CommandRules",value:r.join(",")}),a.EntityLogicalName&&d.push({name:"ContextEntity",value:a.EntityLogicalName}),a.ContextType&&d.push({name:"RibbonContextType",value:a.ContextType}),this._trace(I.a.Verbose,"Start evaluate asynchronous rules for",d),!e)return this._trace(I.a.Info,"Do not evaluate rules, because rule set array is empty",d),L.a.False;const p=[],f={parallelOr:!1,length:r.length,count:0};for(const g in r){const h=r[g];if(e[i]){const r=e[i][h];if(r){const e=!(t&&t[i]&&t[i][h]),g=this._getRulePartsResultsForRuleId(h,n,l,u),m=g.some(e=>e.rulePartResult===L.a.Skipped.toString()),b=e&&this._ruleCache[n]&&this._ruleCache[n][h]&&!m?this._ruleCache[n][h]:this._evaluateAsyncRuleParts(h,r.Rules,a,o,s,c,n,d,f,g);!e||this._ruleCache[n]&&this._ruleCache[n][h]&&!m||(this._ruleCache[n]||(this._ruleCache[n]={}),this._ruleCache[n][h]=b),p.push(b)}}}if(p.length>0)try{const e=await Promise.all(p);let t=`Results of rule evaluation for indexEntity ${i} commandManagerId ${s}, control ${o}: `;switch(e.forEach((e,n)=>{t+=`${r[n]}: ${e.ruleIdResult} `}),this._trace(I.a.Verbose,t),n){case U.b:e.forEach(e=>{l[e.ruleId].ruleIdResult=this._isNullOrUndefined(e.ruleIdResult)?null:e.ruleIdResult.toString(),l[e.ruleId].rulePartsResults=e.rulePartsResults});break;case U.a:default:e.forEach(e=>{u[e.ruleId].ruleIdResult=this._isNullOrUndefined(e.ruleIdResult)?null:e.ruleIdResult.toString(),u[e.ruleId].rulePartsResults=e.rulePartsResults})}const a=Object(L.c)(e.map(e=>e.ruleIdResult),!0);return d.push({name:"Result",value:a.toString()}),this._trace(I.a.Info,"Finish evaluate all rules for",d),a}catch(e){return d.push({name:"Result",value:"false"}),this._applicationContext.EventManager.ReportComponentFailure("Commanding.Components.RuleEvaluator.evaluateAsyncRulesForCommand",e,"Error on rule evaluate",d),L.a.ErrorDefaultFalse}return d.push({name:"Result",value:"true"}),this._trace(I.a.Info,"Finish evaluate rules as there wasn't any",d),L.a.True}_getRulePartsResultsForRuleId(e,t,n,r){switch(t){case U.b:return e in n||(n[e]={ruleIdResult:null,rulePartsResults:[]}),n[e].rulePartsResults;case U.a:default:return e in r||(r[e]={ruleIdResult:null,rulePartsResults:[]}),r[e].rulePartsResults}}_evaluateSyncRuleParts(e,t,n,r,a,i,o,s){if(!t)return L.a.True;let c=L.a.True;for(let l=0;l<t.length&&c!==L.a.False;l++){const u=t[l];if(u){switch(u.RuleType){case 8:c=Object(L.b)(this.TelemetryReport(e,this._EvaluateClientRulePart(u,n),"ClientRule",i,u));break;case 26:c=Object(L.b)(this.TelemetryReport(e,this._EvaluateCommandClientTypeRulePart(u,n),"CommandClientTypeRule",i,u));break;case 23:c=Object(L.b)(this.TelemetryReport(e,this._EvaluateCrmOutlookClientVersionRulePart(u,n),"CrmOutlookClientVersionRule",i,u));break;case 31:c=Object(L.b)(this.TelemetryReport(e,this._EvaluateDeviceTypeRulePart(u,n),"DeviceTypeRule",i,u));break;case 1:c=Object(L.b)(this.TelemetryReport(e,this._EvaluateEntityRulePart(u,n),"EntityRule",i,u));break;case 7:c=Object(L.b)(this.TelemetryReport(e,this._EvaluateFormStateRulePart(u,n,a),"FormStateRule",i,u));break;case 16:c=Object(L.b)(this.TelemetryReport(e,this._EvaluateOfflineAccessStateRulePart(u,n),"OfflineAccessStateRule",i,u));break;case 10:c=Object(L.b)(this.TelemetryReport(e,this._EvaluateOutlookClientRulePart(u,n),"OutlookClientRule",i,u));break;case 19:c=Object(L.b)(this.TelemetryReport(e,this._EvaluateOutlookItemTrackingRulePart(u,n),"OutlookItemTrackingRule",i,u));break;case 17:c=Object(L.b)(this.TelemetryReport(e,this._EvaluateOutlookVersionRulePart(u,n),"OutlookVersionRule",i,u));break;case 12:c=Object(L.b)(this.TelemetryReport(e,this._EvaluatePageRulePart(u,n),"PageRule",i,u));break;case 5:c=Object(L.b)(this.TelemetryReport(e,this._EvaluateSelectionCountRulePart(u,n),"SelectionCountRule",i,u));break;case 11:c=Object(L.b)(this.TelemetryReport(e,this._EvaluateSkuRulePart(u,n),"SkuRule",i,u));break;case 3:c=Object(L.b)(this.TelemetryReport(e,this._EvaluateValueRulePart(u,n),"ValueRule",i,u));break;case 21:c=Object(L.b)(this.TelemetryReport(e,this._EvaluateFormEntityContextRulePart(u,n),"FormEntityContextRule",i,u));break;case 9:c=Object(L.b)(this.TelemetryReport(e,this._EvaluateOrganizationSettingRulePart(u,n),"OrganizationSettingRule",i,u));break;case 18:c=Object(L.b)(this.TelemetryReport(e,this._EvaluateOutlookRenderTypeRulePart(u,n),"OutlookRenderTypeRule",i,u));break;case 13:c=Object(L.b)(this.TelemetryReport(e,this._EvaluateMiscellaneousPrivilegeRulePart(u,n),"MiscellaneousPrivilegeRule",i,u));break;case 20:c=Object(L.b)(this.TelemetryReport(e,this._EvaluateRelationshipTypeRulePart(u,n,r),"RelationshipTypeRule",i,u));break;case 24:c=Object(L.b)(this.TelemetryReport(e,this._EvaluateOptionSetRulePart(u,n),"OptionSetRule",i,u));break;case 35:c=Object(L.b)(this.TelemetryReport(e,this._EvaluateFeatureControlRulePart(u,n),"FeatureControlRule",i,u));break;case 25:c=Object(L.b)(this.TelemetryReport(e,this._EvaluateFormTypeRulePart(u,n),"FormTypeRule",i,u));break;case 27:c=Object(L.b)(this.TelemetryReport(e,this._EvaluateHideForTabletExperienceRulePart(u,n),"HideForTabletExperienceRule",i,u));break;case 42:c=Object(L.b)(this.TelemetryReport(e,this._EvaluateHideIfPowerBITileNotAvailableRulePart(u,n),"HideIfPowerBITileNotAvailable",i,u));break;case 53:c=Object(L.b)(this.TelemetryReport(e,this._EvaluateContextTypeRulePart(u,n,s),"ContextType",i,u));break;case 4:const t=J(u);c=null!==t?Object(L.b)(this.TelemetryReport(e,t,"SyncJavascriptRule",i,u)):L.a.Skipped;break;case 2:case 15:case 6:case 22:case 48:c=L.a.Skipped;break;default:c=Object(L.b)(this.TelemetryReport(e,!1,"DefaultRule",i,u))}o[l]={rulePartType:u.RuleType.toString(),rulePartResult:c.toString()}}}return c}async _evaluateAsyncRuleParts(e,t,n,r,a,i,o,s,c,l){if(!t)return{ruleId:e,ruleIdResult:L.a.True,rulePartsResults:l};const u=[];for(let d=0;d<t.length;d++){const p=t[d],f=d;if(p)switch(p.RuleType){case 4:u.push(this._TelemetryReportWithRulePartIndex(e,this._EvaluateJavaScriptRulePart(p,n,r,i,c),"JavaScriptRule",s,p,f));break;case 48:u.push(this._TelemetryReportWithRulePartIndex(e,this._EvaluateExpressionRulePart(p,n,r,i,c),"ExpressionRule",s,p,f));break;case 2:const t={rulePartType:p.RuleType.toString(),rulePartResult:null,orGroupsResults:[]};l[d]=t,u.push(this._TelemetryReportWithRulePartIndex(e,this._EvaluateOrBlockRulePart(e,p,n,r,a,i,o,s,t,c),"OrBlockRule",s,p,f));break;case 15:u.push(this._TelemetryReportWithRulePartIndex(e,this._EvaluateEntityPropertyRulePart(p,n,c),"EntityPropertyRule",s,p,f));break;case 6:switch(o){case U.b:u.push(this._TelemetryReportWithRulePartIndex(e,this._EvaluateRecordPrivilegeRulePart(p,n,o,c),"RecordPrivilegeRule",s,p,f));break;case U.a:default:u.push(this._TelemetryReportWithRulePartIndex(e,this._EvaluateEntityPrivilegeRulePart(p,n,o,c),"EntityPrivilegeRule",s,p,f))}break;case 22:u.push(this._TelemetryReportWithRulePartIndex(e,this._EvaluateReferencingAttributeRequiredRulePart(p,n,a,c),"ReferencingAttributeRequiredRule",s,p,f))}}if(u.length>0)try{const t=await Promise.all(u),n=Object(L.c)(t.map(e=>e.rulePartResult),!0);return t.forEach(e=>{2!==e.rulePartType&&(l[e.rulePartIndex]={rulePartType:this._isNullOrUndefined(e.rulePartType)?null:e.rulePartType.toString(),rulePartResult:this._isNullOrUndefined(e.rulePartResult)?null:e.rulePartResult.toString()})}),{ruleId:e,ruleIdResult:n,rulePartsResults:l}}catch(t){return{ruleId:e,ruleIdResult:L.a.False,rulePartsResults:l}}return{ruleId:e,ruleIdResult:L.a.True,rulePartsResults:l}}async _TelemetryReportWithRulePartIndex(e,t,n,r,a,i){return{rulePartResult:await this.TelemetryReport(e,t,n,r,a),rulePartType:a.RuleType,rulePartIndex:i}}TelemetryReport(e,t,n,r,a){const i=[];for(const e of r)i.push(e);if(e&&i.push({name:"RuleId",value:e}),a.RuleType&&i.push({name:"RuleType",value:a.RuleType}),n&&i.push({name:"RuleEvaluator",value:n}),4===a.RuleType){const e=a;e.FunctionName&&i.push({name:"FunctionName",value:e.FunctionName}),e.Library&&i.push({name:"Library",value:e.Library})}const o=e=>{if(i.push({name:"Result",value:Object(L.c)([e],!0).toString()}),this._trace(I.a.Verbose,"Rule evaluation finished for "+n,i),Object(R.h)(this._state)){let e="Rule Evaluated: ";const t=[];for(const n of i)"CommandRules"!==n.name&&(e+="%c"+n.name+":%c"+n.value+"; ",t.push("color:FireBrick;"),n.value===L.a.True.toString()?t.push("color:green;"):n.value===L.a.False.toString()?t.push("color:red;"):n.value===L.a.Skipped.toString()?t.push("color:gray;"):t.push("color:blue;"));console.log(e,...t)}},s=e=>{i.push({name:"Error",value:e?e.toString():""}),this._trace(I.a.Error,"Rule evaluation failed for "+n,i)};return t&&"function"==typeof t.then?t.then(o,s):"boolean"==typeof t?o(t):s(new Error("Unexpected result of type "+typeof t)),t}_EvaluateClientRulePart(e,t){return!(!e||!t)&&Y(e,1===e.ClientType)}_EvaluateEntityRulePart(e,t){let n=null;if(!e||!t)return!1;if(t){let r=e.AppliesTo;const a=t.ContextEntityLogicalName?t.ContextEntityLogicalName:t.EntityLogicalName;r||(r=1);let o=null,s=null;switch(t.ContextType){case 1:s="HomePageGrid";break;case 2:s="Form";break;case 3:s="SubGridStandard";break;case 4:s="SubGridRelated";break;case 5:s="CreateForm";break;case 6:s="SubGridAssociated";break;case 7:s="Card";break;case 8:s="Dashboard";break;case 9:s="AppointmentBook"}2===r?o=a:t.EntityLogicalName&&(o=t.EntityLogicalName);const c=null===e.EntityLogicalName||!e.EntityLogicalName.length||("listmember"===e.EntityLogicalName?"account"===o||"contact"===o||"lead"===o:o===e.EntityLogicalName),l=null===e.EntityContextName||!e.EntityContextName.length||s===e.EntityContextName;if(c)n=l;else if("activitypointer"===e.EntityLogicalName&&"HomePageGrid"===s){const e=Object(i.h)(this._state,a);n=e?e.IsActivity&&!e.IsCustomEntity&&l:null}else n=!1}return Y(e,n)}_EvaluateFormStateRulePart(e,t,n){let r=null;if(!e||!t)return!1;const a=Q.getFormState(this._state,this._pageId,n);switch(e.FormState){case 2:r=2===a||"email"===t.EntityLogicalName;break;case 4:r=4===a&&"email"!==t.EntityLogicalName;break;case 1:r=1===a;break;case 3:r=3===a;break;case 9:case 7:case 6:case 0:r=!1}return Y(e,r)}static getFormState(e,t,n){switch(Object(S.ub)(e,t,n)){case 1:return 1;case 2:return 2;case 3:return 3;case 4:return 4;case 6:return 6;case 0:return 0}}_CanStopEvaluation(e){if(!e.parallelOr&&e.anyFalse||e.parallelOr&&e.anyTrue)return!0;let t=e.parent;for(;t;){if(!t.parallelOr&&t.anyFalse||t.parallelOr&&t.anyTrue)return!0;t=t.parent}return!1}_UpdateParallelRuleEvaluations(e,t){!t||t.anyFalse||t.anyTrue||(!1!==e||t.parallelOr?t.parallelOr&&!0===e?(t.anyTrue=!0,this._UpdateParallelRuleEvaluations(!0,t.parent)):(t.count++,t.count===t.length&&this._UpdateParallelRuleEvaluations(!t.parallelOr,t.parent)):(t.anyFalse=!0,this._UpdateParallelRuleEvaluations(!1,t.parent)))}async _EvaluateJavaScriptRulePart(e,t,n,a,i){if(!e||!t)return this._UpdateParallelRuleEvaluations(!1,i),!1;const o=/^\$webresource:/i;let s=null;if(!e.Library||-1===e.Library.search(o))return this._UpdateParallelRuleEvaluations(!1,i),!1;const c=J(e);if(null!==c)return this._UpdateParallelRuleEvaluations(c,i),c;const l=Object(C.e)(this._state,[e.Library]);for(let e=0;e<l.length;++e)l[e]=l[e].replace(o,"");const u=Object(N.j)(this._applicationContext,this._dispatch,this._commandManagerId,this._pageId),d=[];this._evaluateParameters.evaluateParameters(e.Parameters,2,t,this._pageId,n,this._state,this._applicationContext,a,this._commandManagerId).forEach(e=>d.push(e.value));const p=this._dispatch(Object(j.g)(l)),f=u.then(e=>e.loadWebResourcesForAllContexts(l,t.WebResourcePath,3,e=>this._dispatch(Object(A.a)(e)),!t.IsServerAvailable));try{const t=await Promise.all([p,f,u]);if(this._CanStopEvaluation(i))return L.a.Skipped;let a=null;const o=t[2];s=Object(C.j)(this._state,e.Library);const c={sourceName:"ribbon.rule"};c.eventParameters=[{name:E.b.CommandingParameters.ControlId,value:n},{name:E.b.WebResourceParameterNames.FunctionName,value:e.FunctionName},{name:E.b.WebResourceParameterNames.WebResourceName,value:null==s?void 0:s.name},{name:E.b.WebResourceParameterNames.SolutionName,value:null==s?void 0:s.solutionName},{name:E.b.WebResourceParameterNames.PublisherName,value:null==s?void 0:s.publisherName}],Object(r.b)(c,()=>{a=o.execute(e.FunctionName,d,!1,{webResourceName:s&&s.name,solutionName:s&&s.solutionName,solutionVersion:s&&s.solutionVersion,publisherName:s&&s.publisherName,type:"RuleEvaluation"})});const l=a.then(t=>this._sharedParallelRuleBehavior(e,t,i));return k.a.trackPendingPromise(l,"RuleEvaluation"),await l}catch(t){const r=[];return e.FunctionName&&r.push({name:"RuleErrorFunctionName",value:e.FunctionName}),e.Library&&r.push({name:"Library",value:e.Library}),n&&r.push({name:"ControlId",value:n}),a&&r.push({name:"ContextKey",value:a}),t&&t.message&&r.push({name:"RuleErrorMessage",value:t.message}),(null==s?void 0:s.solutionName)&&r.push({name:"SolutionName",value:s.solutionName}),(null==s?void 0:s.solutionVersion)&&r.push({name:"SolutionVersion",value:s.solutionVersion}),(null==s?void 0:s.publisherName)&&r.push({name:"PublisherName",value:s.publisherName}),this._handleTimeOutOrErrorRuleEvalResult(e,"JavaScript",null==t?void 0:t.message,i,r)}}_handleTimeOutOrErrorRuleEvalResult(e,t,n,r,a){const i=e.InvertResult?!e.DefaultValue:e.DefaultValue;return this._UpdateParallelRuleEvaluations(i,r),n===q.a?(this._trace(I.a.Error,`${q.a} executing ${t} rule function "\n\t\t\t\t\t${e.FunctionName}" from library "${e.Library}", defaulting to ${i.toString()}`,a),i?L.a.TimedOutDefaultTrue:L.a.TimedOutDefaultFalse):(this._trace(I.a.Error,`Failed to execute ${t} rule function \n\t\t\t\t"${e.FunctionName}" from library "${e.Library}", defaulting to ${i.toString()}`,a),i?L.a.ErrorDefaultTrue:L.a.ErrorDefaultFalse)}_sharedParallelRuleBehavior(e,t,n){const r=Y(e,t);return this._UpdateParallelRuleEvaluations(r,n),r}async _EvaluateExpressionRulePart(e,t,n,r,a){if(!(null==t?void 0:t.IsExpressionRuntimeAvailable))return this._trace(I.a.Warning,"Expression runtime failed to initialize, as a result PowerFx based command buttons will be visible as expression rules cannot be evaluated"),L.a.Skipped;if(this._CanStopEvaluation(a))return L.a.Skipped;const i=Object(N.l)(this._applicationContext,this._commandManagerId,this._pageId),o=[];e.FunctionName&&o.push({name:"RuleErrorFunctionName",value:e.FunctionName}),e.Library&&o.push({name:"Library",value:e.Library}),e.ComponentName&&o.push({name:"ComponentName",value:e.ComponentName}),n&&o.push({name:"ControlId",value:n}),r&&o.push({name:"ContextKey",value:r}),o.push({name:"RuleType",value:"Expression"});try{const s={sourceName:"ribbon.rule"};s.eventParameters=[{name:E.b.CommandingParameters.ControlId,value:n},{name:K.g.LIBRARY_NAME,value:e.Library},{name:K.g.FUNCTIONAL_COMPONENT_NAME,value:e.ComponentName},{name:E.b.WebResourceParameterNames.FunctionName,value:e.FunctionName}];const c=Object(N.b)().then(a=>this._dispatch(Object(W.a)(e.Library,e.ComponentName,e.FunctionName,a.createExpressionContextProvider(t,this._evaluateParameters,i,this._pageId,n,{dispatch:this._dispatch,getState:()=>this._state},this._applicationContext,r,this._commandManagerId,s,this._applicationContext.TraceManager.getTracer("Commanding"),o,!0)))).then(t=>this._sharedParallelRuleBehavior(e,t,a));return k.a.trackPendingPromise(c,"RuleEvaluation"),await c}catch(t){const n=Object(G.d)(t);return n&&o.push({name:"RuleErrorMessage",value:n}),this._handleTimeOutOrErrorRuleEvalResult(e,"Expression",n,a,o)}}_EvaluateOfflineAccessStateRulePart(e,t){if(!e||!t)return!1;let n;return n=Object(h.c)(this._state)||Object(D.q)(this._state,t.EntityLogicalName)?1===e.OfflineAccessState:2===e.OfflineAccessState,Y(e,n)}async _EvaluateOrBlockRulePart(e,t,n,r,a,i,o,s,c,l){if(!t||!n)return this._UpdateParallelRuleEvaluations(!1,l),L.a.False;if(!t.OrGroups||0===t.OrGroups.length){const e=Y(t,null);return this._UpdateParallelRuleEvaluations(e,l),Object(L.b)(e)}const u=[],d={parallelOr:!0,count:0,length:t.OrGroups.length,parent:l},p=[];for(const c of t.OrGroups){const t=[];if(this._evaluateSyncRuleParts(e,c.Rules,n,a,i,s,t)===L.a.False)u.push({ruleId:"",ruleIdResult:L.a.False,rulePartsResults:t});else{const l={parallelOr:!1,count:0,length:c.Rules.length,parent:d};u.push(this._evaluateAsyncRuleParts(e,c.Rules,n,r,a,i,o,s,l,t))}p.push({rulePartsResults:t})}try{const e=Y(t,(await Promise.all(u)).some(e=>e.ruleIdResult===L.a.True));return c.rulePartType=t.RuleType.toString(),c.rulePartResult=Object(L.b)(e).toString(),c.orGroupsResults=p,Object(L.b)(e)}catch(e){return this._UpdateParallelRuleEvaluations(!1,l),L.a.False}}_EvaluateOutlookClientRulePart(e,t){return!(!e||!t)&&Y(e,0===e.OutlookClientType)}_EvaluateOutlookVersionRulePart(e,t){return!(!e||!t)&&Y(e,null)}_EvaluateOutlookItemTrackingRulePart(e,t){return!(!e||!t)&&Y(e,null)}_EvaluatePageRulePart(e,t){return!(!e||!t)&&Y(e,e.Address===document.location.href)}async _EvaluateRecordPrivilegeRulePart(e,t,n,r){if(!e||!t)return!1;let a;const o=t.EntityLogicalName?t.EntityLogicalName:"";if(!o)return Y(e,!1);if(t&&t.EntityId&&t.EntityId.guid&&(a=t.EntityId.guid),this._isEntityDescriptorInitializedWithMobileCheck(this._getState(),o)&&this._isRecordDescriptorInitialized(this._getState(),o,a)&&this._isNullOrUndefined(Object(w.d)(this._getState(),o,null,null,this._pageId)))return this._privilegeMetadataCallback(e,o,n,r,a);if(this._isEntityValidWithCurrentServerStatus(this._getState(),o)){const s=[];this._isEntityDescriptorInitializedWithMobileCheck(this._getState(),o)||s.push(this._dispatch(Object(w.f)(o,!1,[],this._pageId)));try{if(await Promise.all(s),this._CanStopEvaluation(r))return L.a.Skipped;if(a&&!this._isRecordDescriptorInitialized(this._getState(),o,a)){const e=new V.a(o,t.EntityId),n=Object(i.H)(this._getState(),o);await this._dispatch(Object(j.e)(e,[n]))}return this._privilegeMetadataCallback(e,o,n,r,a)}catch(e){}}return Y(e,null)}_privilegeMetadataCallback(e,t,n,r,a){if(this._CanStopEvaluation(r))return L.a.Skipped;const o=this._getState(),s=Object(i.h)(o,t),c=Object(B.b)(o,t,a);if(!Object(h.c)(o)&&!Object(D.r)(o,t)&&!X(o,t))return this._UpdateParallelRuleEvaluations(!1,r),!1;const l=s?s.Privileges:null,u=!!s&&s.IsEnabledInUnifiedInterface,d=!s||s.IsReadOnlyInMobileClient;let p;const f=["systemform","savedquery","workflow","documenttemplate","importfile","asyncoperation","processsession",x.c].includes(t);if(f&&!u&&this._trace(I.a.Warning,"Mandatory entity is not enabled in UCI",[{name:"entity",value:t},{name:"readonly",value:d}]),!f){if(!0!==u){const t=Y(e,!1);return this._UpdateParallelRuleEvaluations(t,r),t}if(!0===d&&2!==e.PrivilegeType&&64!==e.PrivilegeType&&128!==e.PrivilegeType&&32!==e.PrivilegeType){const t=Y(e,!1);return this._UpdateParallelRuleEvaluations(t,r),t}}switch(n){case U.a:l&&(p=this._HasEntityPrivilege(o,e,t));break;case U.b:if(c)p=this._HasRecordPrivilege(o,e,t,a);else if(l){const n=this._ConvertPrivilegeType(e.PrivilegeType,!1);p=Object(b.g)(o,t,n,0)}}return void 0===p&&(p=e.DefaultValue),p=Y(e,p),this._UpdateParallelRuleEvaluations(p,r),p}async _EvaluateEntityPrivilegeRulePart(e,t,n,r){if(!e||!t)return this._UpdateParallelRuleEvaluations(!1,r),!1;let a;if(e.EntityLogicalName)a=e.EntityLogicalName;else if(1===e.AppliesTo?a=t.EntityLogicalName?t.EntityLogicalName:"":2===e.AppliesTo&&(a=t.ContextEntityLogicalName?t.ContextEntityLogicalName:""),!a||0===e.AppliesTo){const t=Y(e,!1);return this._UpdateParallelRuleEvaluations(t,r),t}if(this._isEntityDescriptorInitializedWithMobileCheck(this._getState(),a)&&this._isNullOrUndefined(Object(w.d)(this._getState(),a,null,null,this._pageId)))return this._privilegeMetadataCallback(e,a,n,r);if(this._isEntityValidWithCurrentServerStatus(this._getState(),a))try{return await this._dispatch(Object(w.f)(a,!1,[],this._pageId)),this._privilegeMetadataCallback(e,a,n,r)}catch(e){}const i=Y(e,null);return this._UpdateParallelRuleEvaluations(i,r),i}_HasEntityPrivilege(e,t,n){let r=!1;if(n){const a=this._ConvertPrivilegeType(t.PrivilegeType,!1);r=Object(b.g)(e,n,a,t.PrivilegeDepth)}return r}_ConvertPrivilegeType(e,t){let n;switch(e){case 1:n=t?"Create":1;break;case 2:n=t?"Read":2;break;case 4:n=t?"Write":3;break;case 8:n=t?"Delete":4;break;case 16:n=t?"Assign":5;break;case 32:n=t?"Share":6;break;case 64:n=t?"Append":7;break;case 128:n=t?"AppendTo":8;break;default:n=t?"Read":2}return n}_HasRecordPrivilege(e,t,n,r){let a=!1;if(n&&r){const i=this._ConvertPrivilegeTypeToAccessRight(t.PrivilegeType);a=Object(b.h)(e,n,r,i)}return a}_ConvertPrivilegeTypeToAccessRight(e){let t=z.a.None;switch(e){case 1:t=z.a.CreateAccess;break;case 2:t=z.a.ReadAccess;break;case 4:t=z.a.WriteAccess;break;case 8:t=z.a.DeleteAccess;break;case 16:t=z.a.AssignAccess;break;case 32:t=z.a.ShareAccess;break;case 64:t=z.a.AppendAccess;break;case 128:t=z.a.AppendToAccess;break;default:t=z.a.ReadAccess}return t}_EvaluateSelectionCountRulePart(e,t){if(!e||!t)return!1;let n=null;return t.SelectedItems&&(n=!0,null!==e.Minimum&&void 0!==e.Minimum&&t.SelectedItems.length<e.Minimum&&(n=!1),null!==e.Maximum&&void 0!==e.Maximum&&e.Maximum>=0&&t.SelectedItems.length>e.Maximum&&(n=!1)),Y(e,n)}_EvaluateSkuRulePart(e,t){return!(!e||!t)&&Y(e,0!=(2&e.SkuTypes))}_EvaluateValueRulePart(e,t){var n;let r=null;if(!e||!t)return!1;const i=Object(m.d)(this._state,t.EntityLogicalName),o=Object(O.j)(this._state,this._pageId),s=Object(S.hc)(this._state,this._pageId,o);let c=null;if(t.SelectedItems&&t.SelectedItems.length>0)c=t.SelectedItems[0].EntityReference;else if(t.EntityLogicalName&&t.EntityId&&t.EntityId.guid){const e=Object(v.i)(this._state,t.EntityLogicalName);e&&e[t.EntityId.guid]&&(c=e[t.EntityId.guid].identifier)}c||(c=null===(n=Object(y.b)(this._state,s))||void 0===n?void 0:n.identifier);const l=Object(y.e)(this._state,s,c,e.Field);let u=null;if(l&&Object(_.i)(l)&&l.hasOwnProperty("valueString"))u=l.valueString;else if(l&&Object(_.j)(l)&&l.hasOwnProperty("value"))u=l.value;else if(l&&Object(_.g)(l)&&l.hasOwnProperty("id"))u=a.a.toString(l.id);else if(l&&Object(_.k)(l)&&l.hasOwnProperty("reference")){const e=l.reference&&l.reference.id||null;u=e&&a.a.toString(e)||null}if(i){const t=i[e.Field];if(t&&t.OptionSet){let n;t&&t.OptionSet&&(n=t.OptionSet.filter(e=>e.Value===Number(u))),null!=u&&u!==e.Value&&n.length>0&&(u=n[0].InvariantName,u!==e.Value&&(u=n[0].Label,u!==e.Value&&(u=n[0].Value,u.toString()!==e.Value&&"boolean"===t.Type&&(1===u?u="true":0===u&&(u="false")))))}}return r=null!=u?u.toString()===e.Value:null===u&&""===e.Value||e.DefaultValue,Y(e,r)}_EvaluateCommandClientTypeRulePart(e,t){return!(!e||!t)&&Y(e,1===e.ClientType)}_EvaluateDeviceTypeRulePart(e,t){if(!e||!t)return!1;let n=null;return 1===e.Type?n=Object(o.a)()===s.a.Phone:2===e.Type?n=Object(o.a)()===s.a.Slate&&Object(l.a)(this._getState())===c.a.MobileApplication:3===e.Type?n=Object(l.a)(this._getState())===c.a.Browser:4===e.Type&&(n=Object(l.a)(this._getState())===c.a.MailApp),Y(e,n)}async _EvaluateEntityPropertyRulePart(e,t,n){if(!e||!t)return this._UpdateParallelRuleEvaluations(!1,n),!1;if(t){let r=null;if(r=e.EntityLogicalName?e.EntityLogicalName:2===e.AppliesTo&&t.ContextEntityLogicalName?t.ContextEntityLogicalName:t.EntityLogicalName,null===r&&0===e.AppliesTo){const t=Y(e,null);return this._UpdateParallelRuleEvaluations(t,n),t}const a=()=>{if(this._CanStopEvaluation(n))return L.a.Skipped;const t=this._getState(),a=Object(i.h)(t,r);if(!Object(h.c)(t)&&!Object(D.r)(t,e.EntityLogicalName)&&!X(t,e.EntityLogicalName))return this._UpdateParallelRuleEvaluations(!1,n),!1;if(null!=a){let t=null;switch(e.PropertyName){case 3:t=a.IsDuplicateDetectionEnabled;break;case 5:t=a.IsValidForAdvancedFind;break;case 4:t=a.HasStateCode;break;case 1:t=a.IsMailMergeEnabled;break;case 2:t=a.IsCollaboration||"activitypointer"===r;break;case 6:t=a.IsConnectionsEnabled;break;case 7:t=a.HasActivities;break;case 8:t="activitypointer"===r||a.IsActivity;break;case 9:t=a.HasNotes;break;case 17:break;case 10:t=a.IsCustomizable;break;case 12:t=a.HasEmailAddresses;break;case 11:t=a.IsActivityParty;break;case 13:t=a.IsChildEntity;break;case 14:t=a.IsImportable;break;case 15:t=a.IsEnabledForCharts;break;case 16:t=a.IsBusinessProcessEnabled;break;case 18:t=a.IsBPFEntity;break;case 19:t=a.IsDocumentManagementEnabled}const i=Y(e,e.PropertyValue===t);return this._UpdateParallelRuleEvaluations(i,n),i}console.log("Unable to retrieve entity metadata for entity "+r);const o=Y(e,null);return this._UpdateParallelRuleEvaluations(o,n),o};if(!r||this._isEntityDescriptorInitializedWithMobileCheck(this._getState(),r)&&this._isNullOrUndefined(Object(w.d)(this._getState(),r,null,null,this._pageId)))return a();if(this._isEntityValidWithCurrentServerStatus(this._getState(),r))try{return await this._dispatch(Object(w.f)(r,!1,[],this._pageId)),a()}catch(e){}const o=Y(e,null);return this._UpdateParallelRuleEvaluations(o,n),o}}_EvaluateFormEntityContextRulePart(e,t){if(!e||!t)return!1;let n=null;return t&&t.EntityLogicalName&&e.EntityLogicalName&&(n=e.EntityLogicalName===t.EntityLogicalName),Y(e,n)}_EvaluateOrganizationSettingRulePart(e,t){if(!e||!t)return!1;const n=Object(d.D)(this._state);let r=null;switch(e.Setting){case 2:r=n?n.isSOPIntegrationEnabled:null;break;case 3:r=n?n.fiscalYearStartDate!==new Date(0,0,1):null}return Y(e,r)}_EvaluateOutlookRenderTypeRulePart(e,t){return!(!e||!t)&&Y(e,1===e.RenderType)}_EvaluateCrmOutlookClientVersionRulePart(e,t){return!(!e||!t)&&Y(e,null)}_EvaluateMiscellaneousPrivilegeRulePart(e,t){const n=e&&e.PrivilegeName?e.PrivilegeName:"";let r=null;const i=Object(p.x)(this._state);if("osdp"===n.toLowerCase()&&i)r=!!i.isOsdpOrganization&&i.isOsdpOrganization;else{let t=!1,n=null;if(e&&e.PrivilegeId&&this._state.user&&this._state.user.userRolePrivileges)for(const r in this._state.user.userRolePrivileges){const i=this._state.user.userRolePrivileges[r];if(i&&a.a.externalGuid(i.privilegeId)===e.PrivilegeId.toUpperCase()){t=!0,n=i.privilegeDepth;break}}r=!!t&&(-1===e.PrivilegeDepth||n>=e.PrivilegeDepth)}return Y(e,r)}async _EvaluateReferencingAttributeRequiredRulePart(e,t,n,r){if(!e||!t)return this._UpdateParallelRuleEvaluations(!1,r),!1;if(t){const a=Object(T.b)(this._state,n),o=Object(P.v)(this._state,this._pageId,a);if(o&&o.relationshipName){const n=o.relationshipName,a=Object(i.C)(this._state,t.EntityLogicalName,n);if(a&&a.ReferencingAttribute&&a.ReferencingEntity){const t=a.ReferencingAttribute,n=a.ReferencingEntity,i=()=>{if(this._CanStopEvaluation(r))return L.a.Skipped;const a=Object(m.a)(this._getState(),n,t),i=Y(e,a&&(2===a.RequiredLevel||1===a.RequiredLevel));return this._UpdateParallelRuleEvaluations(i,r),i};if(Object(m.a)(this._getState(),n,t)&&this._isNullOrUndefined(Object(w.d)(this._getState(),n,null,null,this._pageId)))return i();if(this._isEntityValidWithCurrentServerStatus(this._getState(),n))try{return await this._dispatch(Object(w.f)(n,!1,[t],this._pageId)),i()}catch(e){}}}}const a=Y(e,null);return this._UpdateParallelRuleEvaluations(a,r),a}_EvaluateRelationshipTypeRulePart(e,t,n){let r=null;if(!e||!t)return!1;let a=e.RelationshipType;if(this._isNullOrUndefined(e.AllowCustomRelationship)&&this._isNullOrUndefined(e.AllowSystemRelationship)&&this._isNullOrUndefined(a)&&(a=0),this._isNullOrUndefined(a)||(r=a===t.RelationshipType+1),!this._isNullOrUndefined(e.AllowCustomRelationship)||!this._isNullOrUndefined(e.AllowSystemRelationship)){const a=Object(T.b)(this._state,n),o=Object(P.v)(this._state,this._pageId,a);if(o){const n=o.relationshipName,a=Object(i.C)(this._state,t.EntityLogicalName,n),s=Object(i.v)(this._state,t.EntityLogicalName,n);(a&&this._relationshipIsInvalid(e,a)||s&&this._relationshipIsInvalid(e,s))&&(r=!1)}}return Y(e,r)}_relationshipIsInvalid(e,t){return!this._isNullOrUndefined(e.AllowCustomRelationship)&&!e.AllowCustomRelationship&&t.IsCustomRelationship||!this._isNullOrUndefined(e.AllowCustomRelationship)&&!e.AllowSystemRelationship&&!t.IsCustomRelationship}_EvaluateOptionSetRulePart(e,t){if(!e||!t)return!1;let n=null,r=0;const a=Object(m.a)(this._state,t.EntityLogicalName,"statuscode");return a&&a.OptionSet&&(a.OptionSet.every(t=>!(t.State===e.StateCode&&(r++,r>1))),n=!(r>1)),Y(e,n)}_EvaluateFeatureControlRulePart(e,t){var n;if(!e||!t)return!1;let r=null;if(e.FeatureControlBit){r=Object(f.f)(this._state,null===(n=e.FeatureControlBit)||void 0===n?void 0:n.substr(4))===e.ExpectedValue}return Y(e,r)}_EvaluateFormTypeRulePart(e,t){if(!e||!t)return!1;let n=!1;return 5!==t.ContextType||9!==e.FormType&&6!==e.FormType?(7===t.ContextType&&11===e.FormType||8===t.ContextType&&5===e.FormType||9===t.ContextType&&0===e.FormType||2===t.ContextType&&2===e.FormType)&&(n=!0):n=!0,Y(e,n)}_EvaluateHideForTabletExperienceRulePart(e,t){return!(!e||!t)&&Y(e,null)}_EvaluateHideIfPowerBITileNotAvailableRulePart(e,t){if(!e||!t)return!1;return Y(e,Object(M.a)(this._getState()))}_EvaluateContextTypeRulePart(e,t,n){var r;if(!e||!t)return!1;let a;if(null==n?void 0:n.contextTypeFeatureEnabled){a=0!=((null!==(r=t.ContextTypeMask)&&void 0!==r?r:H.c.TableGridCommand)&e.ContextType)}return Y(e,a)}_isNullOrUndefined(e){return null==e}_isEntityDescriptorInitializedWithMobileCheck(e,t){const n=Object(i.h)(e,t);return Object(i.l)(this._getState(),t)===u.a.Initialized&&n&&!this._isNullOrUndefined(n.IsVisibleInMobileClient)}_isRecordDescriptorInitialized(e,t,n){const r=Object(v.h)(e,t,n);return!this._isNullOrUndefined(r)}_isEntityValidWithCurrentServerStatus(e,t){return Object(h.c)(e)||Object(D.n)(e,t)||Object(D.r)(e,t)}_trace(e,t,n){const r=this._applicationContext.TraceManager.getTracer("Commanding");switch(e){case I.a.Verbose:r.debug(t,n);break;case I.a.Info:r.info(t,n);break;case I.a.Warning:r.warn(t,n);break;case I.a.Error:r.error(t,n)}}}function X(e,t){if(!t)return!0;const n=Object(i.h)(e,t);return!n||n.IsEnabledInUnifiedInterface}function Y(e,t){return null==t&&(t=e.DefaultValue),e.InvertResult?!t:t}function J(e){return"XrmCore.Rules.Enabled.alwaysEnabled"===e.FunctionName&&"$webresource:Main_system_library.js"===e.Library?!e.InvertResult:"XrmCore.Rules.Enabled.neverEnabled"===e.FunctionName&&"$webresource:Main_system_library.js"===e.Library?e.InvertResult:null}},9692:function(e,t,n){"use strict";n.d(t,"c",(function(){return h})),n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n("2YQW"),a=n("Oz8S");const i="gc.data.remove",o="gc.data.update",s={},c=[o,i],l=[o,i],u={};function d(e,t){if(0===Object.keys(t).length)return e;const n=Object.assign({},e);for(const e in t){const r=t[e];for(const a in r)n[e]||(n[e]=t[e]),n[e][a]=t[e][a]}return Object.freeze(n)}function p(e,t){if(0===Object.keys(t).length)return e;const n={};for(const r in e){const a=e[r];if(void 0===t[r])n[r]=e[r];else for(const e in a)void 0===t[r][e]&&(n[r]||(n[r]={}),n[r][e]=t[r][e])}return Object.freeze(n)}const f=[o,i];const g={entities:function(e=u,t){return-1!==c.indexOf(t.type)&&t&&t.payload&&t.payload.entities?t.type===i?p(e,t.payload.entities):d(e,t.payload.entities):e},lists:function(e=s,t){return-1!==f.indexOf(t.type)&&t&&t.payload&&t.payload.lists?t.type===i?Object(a.b)(e,t.payload.lists):Object(a.a)(e,t.payload.lists):e},charts:function(e=u,t){return-1!==l.indexOf(t.type)&&t&&t.payload&&t.payload.charts?t.type===i?p(e,t.payload.charts):d(e,t.payload.charts):e},chartData:function(e=s,t){return-1!==l.indexOf(t.type)&&t&&t.payload&&t.payload.chartData?t.type===i?Object(a.b)(e,t.payload.chartData):Object(a.a)(e,t.payload.chartData):e}},h=Object(r.a)(g)},"99zj":function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return d}));var r=n("K7RF"),a=n("Uv1Y"),i=n("3mEc"),o=n("eXjw"),s=n("/oKV"),c=n("iJGp");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const l="webresourcedescriptor.stub";function u(e){return d([e])}function d(e){return{type:"webresourcedescriptor.retrieve.async",execute({dispatch:t,getState:n},a){const o=n(),c=Object(i.k)(o),l=new Array,u=new Array;for(let t of e){const e=/^\$webresource:/i;t=t.replace(e,""),c[t]?Object(r.e)(o,c[t].OverallVersionNumber)&&-1===u.indexOf(t)&&u.push(t):-1===l.indexOf(t)&&l.push(t)}return l.length>0||u.length>0?Promise.all([t(p(l,s.a.LocalAndRemote)),t(p(u,s.a.Remote))]):Promise.resolve([null])}}}function p(e,t){return{type:"webresourcedescriptor.retrieve.async",execute({dispatch:n,getState:o},s){if(e.length>0){const s=Object(r.b)("webresourcedescriptor",null,null,null,!1,c.a.OnDemandWithoutContext,null,null,e,null,t);return n(s).then(t=>{const r=o(),a=Object(i.f)(r,e);return n(d(a)).then(e=>Object.assign(Object.assign({},t),e))}).catch(a.b)}return Promise.resolve({})}}}function f(e){const t={webResourceDescriptorsByName:{[e]:{contentJson:null,name:e,state:o.a.Error}}};return{type:l,payload:t}}},"9A3e":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("IpQH"),a=n("uM6Y"),i=n("VkXQ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class o extends r.a{constructor(e,t){super(e,t,a.c)}getBarcodeValue(){return this.execute(i.c.getBarcodeValue.name,"ScanBarCode",{})}}},"9Cao":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){for(var n in e)t(e[n],n,e)}},"9L53":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class r{constructor(){this.state={}}composedPath(){return[]}initEvent(e,t,n){}preventDefault(){}stopImmediatePropagation(){}stopPropagation(){}}},"9XdG":function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
let r=null;function a(e){r=e}function i(){return r}},"9egp":function(e,t,n){"use strict";n.d(t,"a",(function(){return M}));var r=n("fILV"),a=n("pEXn"),i=n("K7RF"),o=n("Uv1Y"),s=n("Z/4N"),c=n("vmcK"),l=n("BDhr"),u=n("/oKV"),d=n("iJGp");function p(e){return{type:"custom.control.configuration.async",execute({dispatch:t,getState:n},r){const a=n();let p=u.a.LocalAndRemote;const f=Object(s.d)(a,e,c.a);if(f&&(f.CustomControls||-1===f.VersionNumber)){if(!Object(i.e)(a,f.OverallVersionNumber))return Promise.resolve();p=u.a.Remote}return t(Object(i.b)("customcontroldefaultconfig",null,e,null,!1,d.a.OnDemandWithoutContext,null,null,[],null,p)).then(n=>{if(n&&n.homePageConfigurations&&n.homePageConfigurations[e]&&null==n.homePageConfigurations[e][c.a]){const r=Object(l.b)(a);n.homePageConfigurations[e][c.a]={UniqueId:null,CustomControls:null,FormLibraries:null,EventHandlers:null,VersionNumber:-1,OverallVersionNumber:r.currentVersion},t(function(e){return{type:i.a,payload:e}}(n))}},o.b)}}}var f=n("FZDd"),g=n("sZ+8"),h=n("69Qu"),m=n("iZ7K"),b=n("BFlg"),y=n("Qjw6"),_=n("M0zh"),v=n("nmJf"),S=n("a72m"),O=n("d0w6"),C=n("IqkD"),E=n("EY5k"),I=n("XvLr"),w=n("8aQ2"),j=n("P6DH"),P=n("w+N3"),T=n("Lyxw"),N=n("eVWz"),A=n("NM3A"),R=n("3/02"),D=n("oOvK"),x=n("UwOy");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const M={predictedNextPageFactories:[y.b],getName:()=>r.a,throwIfInvalidUrl(e){},getRequiredAttributes(){throw new Error("Not Implemented")},preInitializePage:e=>({type:"preInitialize.gridAction.async",execute:({dispatch:t,getState:n},r)=>{const{entityTypeName:a,viewId:i,viewType:c}=e,l=r.TraceManager.getTracer(b.P),u=Object(C.x)(n());if(null===a){const e="Cannot load grid page without etn",t=new o.a(e),n=b.N+".preInitializeAction";return r.EventManager.ReportComponentFailure(n,t),Promise.reject(t)}let d,y=!1;const M=n(),F=t(p(a)).then(()=>{l.info("Control configuration retrieved for the main page grid")}).catch(e=>{const t="Control configuration retrieval failed for the main page grid with error : "+e.message;l.info(t+". Default grid configuration will be used.")}),k=Object(h.c)(n());let L;if(i||(d=Object(j.ob)(u,a,l,M),y=d&&d.PinnedEntity&&(k||Object(g.n)(M,d.PinnedEntity))),a===j.a){const e={};e[j.a]=[],y&&d.PinnedEntity!==j.a&&(e[d.PinnedEntity]=null),L=t(Object(f.e)(e))}else L=t(Object(f.f)(a,!1,[]));const B=Object(T.f)(n(),R.Dg)&&k,U=!Object(x.g)(n())&&Object(T.f)(n(),R.hh)&&k&&Object(N.b)(n());if((B||U)&&t(Object(f.f)(A.b,!1,null)),k||Object(g.n)(M,a)){if(t(Object(v.a)(_.i+a)),y?(t(Object(S.a)(d.PinnedEntity,O.a.MAIN_APPLICATION_VIEW,d.ViewType,d.ViewId)),a===j.a&&t(Object(S.a)(j.a,O.a.MAIN_APPLICATION_VIEW,void 0,void 0))):t(Object(S.a)(a,O.a.MAIN_APPLICATION_VIEW,c,i)),a===j.a){Object(j.C)(M).forEach(e=>{e===j.a||d&&e===d.PinnedEntity||t(Object(S.b)(e,O.a.MAIN_APPLICATION_VIEW))});const e=Object(m.a)(n()),r=[j.i,j.f,j.h,j.e,j.g,j.b],a={};for(const t in e){const n=e[t].EntityLogicalName;(r.indexOf(n)>-1&&(!d||n!==d.PinnedEntity)&&k||Object(g.n)(M,n))&&(a[n]=[])}t(Object(f.e)(a))}k&&t(Object(w.a)(a));const e="ViewSelectorAllActivities";t(Object(E.e)([...I.labelList,e,...P.c])),Object(s.e)(n(),b.D)||t(Object(D.c)(b.D)),Object(T.e)(n(),R.xf)&&!Object(s.e)(n(),b.y)&&t(Object(D.c)(b.y)),Object(j.zb)(n())&&!Object(s.e)(n(),b.C)&&t(Object(D.c)(b.C))}return Promise.all([L,F]).catch(e=>{const t="Entity Metadata retrieve failed due to error: "+e,n=b.N+".preInitializeAction";throw r.EventManager.ReportComponentFailure(n,t),e})}}),createPageModule:e=>Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(7),n.e(10),n.e(4),n.e(5),n.e(6),n.e(9),n.e(8),n.e(11),n.e(12),n.e(13),n.e(14),n.e(15),n.e(16),n.e(17),n.e(23),n.e(26),n.e(124)]).then(n.bind(null,"WunZ")).then(({Grid:t})=>new t(e)),getTelemetryAttributes:e=>[{name:a.b.EntityName,value:e&&e.entityTypeName},{name:a.b.ViewId,value:e&&e.viewId&&e.viewId.guid},{name:a.b.VisualizationId,value:e&&e.visualizationId&&e.visualizationId.guid}],getKeyForThawedCheck:e=>e.entityTypeName};Object.freeze(M)},"9fGf":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return c}));var r,a=n("w1eR"),i=n("eOoD"),o=n("hAdb"),s=n("4gfk");function c(e){var t,n;if(Object(o.e)(e,s.a))return r.Phone;if((null===(t=null==e?void 0:e.clientHost)||void 0===t?void 0:t.type)!==a.a.MobileApplication)return r.Web;switch(null===(n=null==e?void 0:e.clientHost)||void 0===n?void 0:n.subtype){case i.a.Phone:return r.Phone;case i.a.Tablet:return r.Tablet}}!function(e){e[e.Phone=0]="Phone",e[e.Tablet=1]="Tablet",e[e.Web=2]="Web"}(r||(r={}))},"9fhM":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("IJw9"),a=n("3BuU"),i=n("E+70"),o=n("Ri7K"),s=function(){function e(){}return e.getPayloadBlob=function(e,t){var n,s=!1,c=new r.IO.MemoryStream,l=new r.CompactBinaryProtocolWriter(c);for(var u in l._WriteFieldBegin(r._BondDataType._BT_MAP,3,null),l._WriteMapContainerBegin(t,r._BondDataType._BT_STRING,r._BondDataType._BT_LIST),e)if(s)n||(n={}),n[u]=e[u],delete e[u];else if(e.hasOwnProperty(u)){l._WriteString(u);var d=e[u];l._WriteContainerBegin(1,r._BondDataType._BT_STRUCT),l._WriteFieldBegin(r._BondDataType._BT_STRING,2,null),l._WriteString("act_default_source"),l._WriteFieldBegin(r._BondDataType._BT_STRING,5,null),l._WriteString(o.newGuid()),l._WriteFieldBegin(r._BondDataType._BT_INT64,6,null),l._WriteInt64(o.numberToBondInt64(Date.now())),l._WriteFieldBegin(r._BondDataType._BT_LIST,8,null);var p=c._GetBuffer().length+1;l._WriteContainerBegin(e[u].length,r._BondDataType._BT_STRUCT);for(var f=c._GetBuffer().length-p,g=0;g<d.length;++g){var h=c._GetBuffer().length;if(this.writeEvent(d[g],l),c._GetBuffer().length-h>2936012)i.default.eventsRejected([d[g]],a.AWTEventsRejectedReason.SizeLimitExceeded),d.splice(g--,1),c._GetBuffer().splice(h),this._addNewDataPackageSize(d.length,c,f,p);else if(c._GetBuffer().length>2936012){c._GetBuffer().splice(h),n||(n={}),e[u]=d.splice(0,g),n[u]=d,this._addNewDataPackageSize(e[u].length,c,f,p),s=!0;break}}l._WriteStructEnd(!1)}return l._WriteStructEnd(!1),{payloadBlob:c._GetBuffer(),remainingRequest:n}},e._addNewDataPackageSize=function(e,t,n,a){for(var i=r._Encoding._Varint_GetBytes(r.Number._ToUInt32(e)),o=0;o<n;++o){if(!(o<i.length)){t._GetBuffer().slice(a+o,n-o);break}t._GetBuffer()[a+o]=i[o]}},e.writeEvent=function(e,t){t._WriteFieldBegin(r._BondDataType._BT_STRING,1,null),t._WriteString(e.id),t._WriteFieldBegin(r._BondDataType._BT_INT64,3,null),t._WriteInt64(o.numberToBondInt64(e.timestamp)),t._WriteFieldBegin(r._BondDataType._BT_STRING,5,null),t._WriteString(e.type),t._WriteFieldBegin(r._BondDataType._BT_STRING,6,null),t._WriteString(e.name);var n={},i=0,s={},c=0,l={},u=0,d={},p=0,f={},g=0,h={},m=0,b={},y=0;for(var _ in e.properties){if(e.properties.hasOwnProperty(_))if((S=e.properties[_]).cc>0)b[_]=S,y++;else if(S.pii>0)h[_]=S,m++;else switch(S.type){case a.AWTPropertyType.String:n[_]=S.value,i++;break;case a.AWTPropertyType.Int64:s[_]=S.value,c++;break;case a.AWTPropertyType.Double:l[_]=S.value,u++;break;case a.AWTPropertyType.Boolean:d[_]=S.value,p++;break;case a.AWTPropertyType.Date:f[_]=S.value,g++}}if(i)for(var _ in t._WriteFieldBegin(r._BondDataType._BT_MAP,13,null),t._WriteMapContainerBegin(i,r._BondDataType._BT_STRING,r._BondDataType._BT_STRING),n)if(n.hasOwnProperty(_)){var v=n[_];t._WriteString(_),t._WriteString(v.toString())}if(m)for(var _ in t._WriteFieldBegin(r._BondDataType._BT_MAP,30,null),t._WriteMapContainerBegin(m,r._BondDataType._BT_STRING,r._BondDataType._BT_STRUCT),h)if(h.hasOwnProperty(_)){var S=h[_];t._WriteString(_),t._WriteFieldBegin(r._BondDataType._BT_INT32,1,null),t._WriteInt32(1),t._WriteFieldBegin(r._BondDataType._BT_INT32,2,null),t._WriteInt32(S.pii),t._WriteFieldBegin(r._BondDataType._BT_STRING,3,null),t._WriteString(S.value.toString()),t._WriteStructEnd(!1)}if(p)for(var _ in t._WriteFieldBegin(r._BondDataType._BT_MAP,31,null),t._WriteMapContainerBegin(p,r._BondDataType._BT_STRING,r._BondDataType._BT_BOOL),d)if(d.hasOwnProperty(_)){v=d[_];t._WriteString(_),t._WriteBool(v)}if(g)for(var _ in t._WriteFieldBegin(r._BondDataType._BT_MAP,32,null),t._WriteMapContainerBegin(g,r._BondDataType._BT_STRING,r._BondDataType._BT_INT64),f)if(f.hasOwnProperty(_)){v=f[_];t._WriteString(_),t._WriteInt64(o.numberToBondInt64(v))}if(c)for(var _ in t._WriteFieldBegin(r._BondDataType._BT_MAP,33,null),t._WriteMapContainerBegin(c,r._BondDataType._BT_STRING,r._BondDataType._BT_INT64),s)if(s.hasOwnProperty(_)){v=s[_];t._WriteString(_),t._WriteInt64(o.numberToBondInt64(v))}if(u)for(var _ in t._WriteFieldBegin(r._BondDataType._BT_MAP,34,null),t._WriteMapContainerBegin(u,r._BondDataType._BT_STRING,r._BondDataType._BT_DOUBLE),l)if(l.hasOwnProperty(_)){v=l[_];t._WriteString(_),t._WriteDouble(v)}if(y)for(var _ in t._WriteFieldBegin(r._BondDataType._BT_MAP,36,null),t._WriteMapContainerBegin(y,r._BondDataType._BT_STRING,r._BondDataType._BT_STRUCT),b)if(b.hasOwnProperty(_)){S=b[_];t._WriteString(_),t._WriteFieldBegin(r._BondDataType._BT_INT32,1,null),t._WriteInt32(S.cc),t._WriteFieldBegin(r._BondDataType._BT_STRING,2,null),t._WriteString(S.value.toString()),t._WriteStructEnd(!1)}t._WriteStructEnd(!1)},e.base64Encode=function(e){return r._Encoding._Base64_GetString(e)},e}();t.default=s},"9gmQ":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="aps.initialize";function a(e){return{type:r,payload:e}}},"9hJQ":function(e,t,n){"use strict";n.d(t,"a",(function(){return C})),n.d(t,"b",(function(){return E})),n.d(t,"c",(function(){return I}));var r=n("zipJ"),a=n("b02z"),i=n("n48k"),o=n("YxC/"),s=n("09gH"),c=n("7kVW");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function l(e){if("string"==typeof e||"number"==typeof e){const t=Number(e);return!isNaN(t)&&Number.isInteger(t)}return!1}var u=n("Xd5/"),d=n("/A0C");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const p=/^[^@\s\\"<>)(\[\]:;,.]+(([.]{1}[^@\s\\"<>)(\[\]:;,.]+)+?|)@([^@\s\\"<>)(\[\]+:;,.-]+(((\.|\+|\-|\-\-)[^@\s\\"<>)(\[\]+:;,.-]+)+?|)([.][^0-9@\s\\"<>)(\[\]+:;,.-]+)+?|(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?))$/,f=/["\\"]/;function g(e){return p.test(e)||function(e){if("string"!=typeof e)return!1;const t=e.indexOf('"'),n=e.indexOf('"@',1);if(0===t&&n>1){const t=e.substring(1,n),r=e.replace('"'+t+'"',"abc");if(!f.test(t)&&p.test(r))return!0}return!1}(e)}var h=n("uhZ3");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function m(e){return!Object(h.b)(e)}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function b(e){return!isNaN(Date.parse(e))}var y=n("i1f0"),_=n("KXSk"),v=n("5Oca"),S=n("+nNZ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const O=[function(e,t){const n=Object(o.c)(t,s.n);return 2===e.RequiredLevel||1===e.RequiredLevel?Object(a.a)(m,i.a[i.a.Required],n):null},function(e,t){const n=Object(o.c)(t,s.b);return"datetime"===e.Type?Object(a.a)(b,i.a[i.a.DateTime],n):null},r.a,function(e,t){const n=Object(o.c)(t,s.k);return"integer"!==e.Type||Object(c.b)(e)?null:Object(a.a)(l,i.a[i.a.Integer],n)},c.a,function(e,t,n){const r=e.Type===d.a.Money?Object(o.c)(t,s.a):Object(o.c)(t,s.m),c=n?Object(u.y)(e.MinValue,n,t):e.MinValue,l=n?Object(u.y)(e.MaxValue,n,t):e.MaxValue;return void 0!==e.MinValue&&null!==e.MinValue&&void 0!==e.MaxValue&&null!==e.MaxValue?Object(a.a)((p=e.MaxValue,e=>{if("string"==typeof e||"number"==typeof e){const t=Number(e);return!isNaN(t)&&+t<=p}return!1}),i.a[i.a.MaxValue],String.format(r,c,l)):null;
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var p}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */,function(e,t,n){const r=e.Type===d.a.Money?Object(o.c)(t,s.a):Object(o.c)(t,s.m),c=n?Object(u.y)(e.MinValue,n,t):e.MinValue,l=n?Object(u.y)(e.MaxValue,n,t):e.MaxValue;return void 0!==e.MinValue&&null!==e.MinValue&&void 0!==e.MaxValue&&null!==e.MaxValue?Object(a.a)((p=e.MinValue,e=>{if("string"==typeof e||"number"==typeof e){const t=Number(e);return!isNaN(t)&&+t>=p}return!1}),i.a[i.a.MinValue],String.format(r,c,l)):null;var p},function(e,t){const n=Object(o.c)(t,s.j);return"email"===("string"==typeof e.Format&&e.Format.toLowerCase())&&e.Type!==d.a.Memo?Object(a.a)(g,i.a[i.a.Email],n):null},function(e,t){const n=Object(o.c)(t,s.l);return void 0!==e.MaxLength&&null!==e.MaxLength?Object(a.a)((r=e.MaxLength,e=>"string"==typeof e&&e.length<=r),i.a[i.a.MaxLength],String.format(n,e.MaxLength)):null;var r}];function C(e,t,n,r,a,i=!1){const o={attributeName:a.LogicalName,controlValidationDecisions:[],attributeValidationNeeded:!1},s=Object(y.B)(e,t,n,a.LogicalName),c=Object(_.c)(e,t),l=Object(y.Hb)(e,c),u=r?Object(v.e)(e,r):null,d=2===a.RequiredLevel||1===a.RequiredLevel;let p=!1;return null==s||s.forEach(a=>{let s;l?s=1:d?Object(y.v)(e,{id:t,controlName:a},n)?s=2:Object(y.I)(e,{id:t,controlName:a},n)?Object(y.nd)(e,{id:t},n,a)?s=4:Object(S.e)(e,u,null==r?void 0:r.etn,a)&&i?s=5:(s=0,p=!0):s=3:s=6,o.controlValidationDecisions.push({controlName:a,validationDecision:s})}),(null==s?void 0:s.length)?o.attributeValidationNeeded=p&&d:o.attributeValidationNeeded=d,o}function E(e,t){return{isValueValid:!0,userInput:e,errorMessage:null,errorId:void 0,isOfflineSyncError:t}}function I(e,t,n,r,a){const i=E(e,a),o=function(e,t,n){const r=[];if(e)for(const a of O)a&&r.push(a(e,t,n));return r}(t,n,r);for(const t of o)if(t&&!t.validate(e,t.parameters)){i.isValueValid=!1,i.errorMessage=t.errorMessage,i.errorId=t.errorCode;break}return i}},"9lTt":function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return a}));var a=function(){function e(){this._disablingScrollStyle=!1,this._popupCount=0}return e.getInstance=function(){return r||(r=new e),r},e.prototype.seeMoreOpen=function(){this._popupCount++,this.setDisableScrollStyle(!0)},e.prototype.seeMoreClose=function(){this._popupCount--,this.setDisableScrollStyle(!1)},e.prototype.getPopupCount=function(){return this._popupCount},e.prototype.getDisableScrollStyle=function(){return this._disablingScrollStyle},e.prototype.setDisableScrollStyle=function(e){if(this._disablingScrollStyle!==e){this._disablingScrollStyle=e;for(var t=document.querySelectorAll(e?".webkitScroll":".webkitScrollAuto"),n=0;n<t.length;n++)e?(t[n].classList.add("webkitScrollAuto"),t[n].classList.remove("webkitScroll")):(t[n].classList.add("webkitScroll"),t[n].classList.remove("webkitScrollAuto"));var r=document.querySelectorAll(e?".forceNewStackContext":".forceNewStackContextInert");for(n=0;n<r.length;n++)e?(r[n].classList.add("forceNewStackContextInert"),r[n].classList.remove("forceNewStackContext")):(r[n].classList.add("forceNewStackContext"),r[n].classList.remove("forceNewStackContextInert"))}},e}()},"9n4z":function(e,t,n){"use strict";n.d(t,"b",(function(){return q})),n.d(t,"a",(function(){return V}));var r=n("ZIjf"),a=n("16wZ"),i=n("nzu+"),o=n("tICD"),s=n("ruPX"),c=n("cfbi"),l=n("SAYH"),u=n("BMZr"),d=n("odYE"),p=n("Uv1Y"),f=n("fA3V"),g=n("zu1I"),h=n("+BIz"),m=n("tT9w"),b=n("ZFkP"),y=n("1kth"),_=n("dHD5"),v=n("B3HF"),S=n("qshH"),O=n("arV0"),C=n("3yqi"),E=n("htFu"),I=n("D+Bz"),w=n("i1f0"),j=n("A09F"),P=n("0nOn"),T=n("amNf"),N=n("dUiZ"),A=n("0GT3"),R=n("Lyxw"),D=n("pF61"),x=n("ZUus"),M=n("SSc5"),F=n("QHx/"),k=n("s1hL"),L=n("2yvP"),B=n("8MGk"),U=n("/o1X");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const V="ClientApi.XrmNavigation.";let z;class q{constructor(e,t,n,r){const i=V+"constructor";e||Object(a.j)(i,"store"),t||Object(a.j)(i,"context"),n||Object(a.j)(i,"globalContext"),z=e,this._context=t,this._globalContext=n,this._clientApiExecutor=new P.a(z,V,r),this._pageId=r}addOnPreNavigation(e){const t=V+"addOnPreNavigation";try{r.a.instance.reportCall(t),this._context.Router.addGlobalOnPreNavigation(e),r.a.instance.reportSuccess(t)}catch(e){throw S.a.getInstance().reportFailure(t,e),e}}removeOnPreNavigation(e){const t=V+"removeOnPreNavigation";try{r.a.instance.reportCall(t),this._context.Router.removeGlobalOnPreNavigation(e),r.a.instance.reportSuccess(t)}catch(e){throw S.a.getInstance().reportFailure(t,e),e}}openAlertDialog(e,t){return this._clientApiExecutor.executeAsync("openAlertDialog",(n,r,a)=>{let s={};return t&&(s={width:t.width,height:t.height}),z.dispatch(Object(i.a)(e,s,this._pageId)).then(e=>{if(0===e.status)return z.dispatch(Object(o.a)(e.pageId)).then(()=>({}));throw e.error})},[{name:"alertStrings",value:e,isRequired:!0,isClientAPICheckerParam:!0},{name:"options",value:t,isClientAPICheckerParam:!0}],!0,!0)}openConfirmDialog(e,t){return this._clientApiExecutor.executeAsync("openConfirmDialog",(n,r,a)=>{let i={};return t&&(i={width:t.width,height:t.height,restoreFocus:t.restoreFocus}),z.dispatch(Object(h.a)(e.text,i,e.title,this._pageId,e.subtitle,e.confirmButtonLabel,e.cancelButtonLabel)).then(e=>{if(0===e.status)return z.dispatch(Object(o.a)(e.pageId)).then(e=>({confirmed:e.value.confirmed}));throw e.error})},[{name:"confirmStrings",value:e,isRequired:!0,isClientAPICheckerParam:!0},{name:"options",value:t,isClientAPICheckerParam:!0}],!0,!0)}openDialog(e,t,n){return this._clientApiExecutor.executeAsync("openDialog",(r,a,i)=>{let s={};if(t){let e=null;switch(t.position){case 1:e="center";break;case 2:e="side";break;case 3:e="inline"}s={width:t.width,height:t.height,windowPosition:e}}return z.dispatch(Object(g.b)(e,s,n,this._pageId)).then(e=>{if(0===e.status)return z.dispatch(Object(o.a)(e.pageId)).then(e=>({parameters:e.value}));throw e.error})},[{name:"name",value:e,isRequired:!0,isEventParam:!0,isClientAPICheckerParam:!0},{name:"parameters",value:this._getParametersValue(n),isClientAPICheckerParam:!0},{name:"options",value:t,isClientAPICheckerParam:!0}],!0,!0)}openErrorDialog(e){return this._clientApiExecutor.executeAsync("openErrorDialog",(t,n,r)=>{const a=new p.a(e.message,e.errorCode,null,null,null,null,e.details);return e.errorRegion&&(a.errorRegion=e.errorRegion),z.dispatch(Object(m.b)(a,!0,this._pageId)).then(()=>({}))},[{name:"options",value:e,isRequired:!0,isClientAPICheckerParam:!0}],!0,!0)}openFile(e,t){const n=V+"openFile",i=Object(L.a)();e||Object(a.j)(n,"file");try{r.a.instance.reportCall(n);return new B.a(this._context,z).openFile(e,t).then(()=>{r.a.instance.reportSuccess(n,i)}).catch(e=>Object(a.d)(z,e,n+".fileManager.openFile",null,!0,!0,null,i))}catch(e){return Object(a.d)(z,e,n,null,!0,!0,null,i)}}navigateTo(e,t){const n=this._clientApiExecutor.getComponentName("navigateTo");let r,a,i;return this._clientApiExecutor.runClientApiChecker("navigateTo",[{name:"input",value:e,isClientAPICheckerParam:!0},{name:"options",value:t,isClientAPICheckerParam:!0}]),t&&(r=Object(T.c)(n,t),2===t.target?a=Object(T.f)(n,t):3===t.target&&(i=Object(T.g)(n,t))),Object(T.i)(z,this._clientApiExecutor,e,"navigateTo",r,a,i,this._pageId)}navigateBack(){return this._clientApiExecutor.executeAsync("navigateBack",()=>{const e=z.getState(),t=this._pageId||Object(D.c)(e),n=Object(F.a)(e,t,I.b.Xrm);if(!n.targetBrowsingContext){const e=this._clientApiExecutor.getComponentName("navigateBack");Object(a.h)(e,"pageId",t)}return z.dispatch(Object(M.a)(n))})}canNavigateBack(){return this._clientApiExecutor.execute("canNavigateBack",()=>{const e=z.getState(),t=this._pageId||Object(D.c)(e),n=Object(F.a)(e,t,I.b.Xrm);if(!n.targetBrowsingContext){const e=this._clientApiExecutor.getComponentName("navigateBack");Object(a.h)(e,"pageId",t)}return!Object(D.e)(e,n.targetBrowsingContext)})}openForm(e,t){return this._clientApiExecutor.executeAsync("openForm",(n,r,i)=>{if(e.createFromEntity&&(e.createFromEntity.id||Object(a.j)(n,"createFromEntity.id"),e.createFromEntity.entityType||Object(a.j)(n,"createFromEntity.entityType")),e.entityId&&!l.a.tryParseOrNull(e.entityId)&&Object(a.h)(n,"options.entityId",e.entityId),!e.entityId&&(e.showDialog||e.useQuickCreateForm)){return(Object(N.a)(z.getState())?Promise.resolve():z.dispatch(Object(A.a)())).then(()=>{var r;const a=null===(r=Object(w.L)(z.getState(),e.entityName))||void 0===r?void 0:r.mode,i=this._openCreateFormDialog(n,e,t);if(a===j.a.QuickCreateForm||a===j.a.MainFormDialog)return i;return{savedEntityReference:[{entityType:e.entityName,id:e.entityId,name:e.entityName}]}})}const o=z.getState(),s=Object(D.c)(o),c=Object(O.j)(o,s),u=c&&c.isQueryMode,d=c&&c.isAdvancedFindView;return this._openEntityForm(n,e,t,{isQueryMode:u,isAdvancedFindView:d})},[{name:"options",value:e,isRequired:!0,isClientAPICheckerParam:!0},{name:"options.entityName",value:null==e?void 0:e.entityName,isRequired:!0,isEventParam:!0},{name:"parameters",value:this._getParametersValue(t),isClientAPICheckerParam:!0}],!0,!0)}_openEntityForm(e,t,n,r){e+="._openEntityForm";const a=Object(k.a)(t,n,r),i={savedEntityReference:[{entityType:t.entityName,id:t.entityId,name:t.entityName}]};if("report"===a.entityTypeName)return Object(k.b)(a,z,(e,t)=>this.openFile(e,t),(e,t)=>this.openUrl(e,t),i);if(t&&t.openInNewWindow&&this._globalContext&&this._globalContext.client&&"Web"===this._globalContext.client.getClient())return a.newWindowOptions=Object(T.g)(e,t),z.dispatch(Object(s.c)(c.b,a)).then(n=>(this._attachEvent(e,n&&n.pageId,t),i));const o=a&&a.data&&a.data.recurringAppointmentFormData?I.b.Redirect:{target:"inline"};return z.dispatch(Object(s.a)(c.b,a,this._pageId,o)).then(n=>{if(0===n.status)return this._attachEvent(e,n.pageId,t),i;throw n.error})}_openCreateFormDialog(e,t,n){e+="._openCreateFormDialog";const r={height:t.height,width:t.width,openInNewWindow:t.openInNewWindow};let a;return t.createFromEntity&&(a=new d.a(t.createFromEntity.entityType,new l.a(t.createFromEntity.id),t.createFromEntity.name)),z.dispatch(Object(u.a)(t.entityName,this._pageId,r,n,a,null,t)).then(n=>{if(0===n.status){Object(O.p)(z.getState(),n.pageId)===C.a.EditForm&&this._attachEvent(e,n.pageId,t);const r={pageType:"entityrecord",entityName:t.entityName,createFromEntity:t.createFromEntity,relationship:t.relationship};return Object(T.h)(z,n,r)}throw n.error})}openTaskFlow(e,t,n){return this._clientApiExecutor.executeAsync("openTaskFlow",(r,a,i)=>Object(U.a)(z.getState())?Promise.reject("Task Flow is deprecated in 2021 Release Wave 2 Update. Please contact system administrator to resolve this issue."):z.dispatch(Object(E.c)()).then(()=>z.dispatch(Object(b.a)(t.primaryEntityContext.entityType,e,new l.a(t.primaryEntityContext.id),n,this._pageId)).then(e=>{if(0===e.status)return z.dispatch(Object(o.a)(e.pageId)).then(e=>({parameters:e}));throw e.error})),[{name:"name",value:e,isRequired:!0,isEventParam:!0},{name:"options",value:t,isRequired:!0}])}openUrl(e,t){return new P.a(z,V,this._pageId).executeAsync("openUrl",(n,r,a)=>Object(k.c)(a.apiName,e,this._context,z,t),[{name:"url",value:e,isRequired:!0}])}openWebResource(e,t,n){this._clientApiExecutor.executeAsync("openWebResource",(r,a,i)=>{const o={webresourceName:e,webresourceData:{webresourceData:n},navbar:x.a.Off,cmdbar:!1};return t&&(o.newWindowOptions=Object(T.g)(e,t)),this._globalContext&&this._globalContext.client&&"Mobile"===this._globalContext.client.getClient()&&!Object(R.g)(z.getState(),"MobileClientSupportsExternalLinks")?z.dispatch(Object(s.a)(f.a,o,this._pageId,I.b.Xrm)):z.dispatch(Object(s.c)(f.a,o))},[{name:"name",value:e,isRequired:!0,isClientAPICheckerParam:!0},{name:"options",value:t,isClientAPICheckerParam:!0},{name:"data",value:n,isClientAPICheckerParam:!0}],!0,!0)}addBeforeOnLoad(e){const t=V+"addBeforeOnLoad";e||Object(a.j)(t,"handler");try{r.a.instance.reportCall(t),z.dispatch(Object(v.a)(e)),r.a.instance.reportSuccess(t)}catch(e){throw S.a.getInstance().reportFailure(t,e),e}}removeBeforeOnLoad(e){const t=V+"removeBeforeOnLoad";e||Object(a.j)(t,"handler");try{r.a.instance.reportCall(t),z.dispatch(Object(v.f)(e)),r.a.instance.reportSuccess(t)}catch(e){throw S.a.getInstance().reportFailure(t,e),e}}_attachEvent(e,t,n){e+="._attachEvent";return new Promise((r,i)=>{try{if(t){let o=!1;z.dispatch(Object(y.c)(Object(_.j)(z.getState(),t),t,s=>{var c,l;try{if(!o&&s){const i=s.getEventSource(),u=s.getEventArgs();if(i&&i.getId()&&3!==u.getDataLoadState()){const s=Object(_.j)(z.getState(),t);return!((null===(l=Object(w.B)(z.getState(),t,s,null===(c=null==n?void 0:n.relationship)||void 0===c?void 0:c.attributeName))||void 0===l?void 0:l.length)>0)?Object(T.a)(z,i.getEntityReference(),null==n?void 0:n.createFromEntity,null==n?void 0:n.relationship).then(()=>{const e={savedEntityReference:[i.getEntityReference()]};o=!0,r(e)}).catch(t=>Object(a.d)(z,t,e+"._associate")):r(void 0)}}}catch(t){Object(a.d)(z,t,e+".dataLoaded").catch(e=>i(e))}}))}else r(void 0)}catch(t){Object(a.d)(z,t,e).catch(e=>i(e))}})}addOnOpenUrl(e){const t=V+"addOnOpenUrl";e||Object(a.j)(t,"handler");try{r.a.instance.reportCall(t),z.dispatch(Object(v.b)(e)),r.a.instance.reportSuccess(t)}catch(e){throw S.a.getInstance().reportFailure(t,e),e}}removeOnOpenUrl(e){const t=V+"removeOnOpenUrl";e||Object(a.j)(t,"handler");try{r.a.instance.reportCall(t),z.dispatch(Object(v.g)(e)),r.a.instance.reportSuccess(t)}catch(e){throw S.a.getInstance().reportFailure(t,e),e}}_getParametersValue(e){let t;try{t=JSON.stringify(e)}catch(e){t="Error logging parameters"}return t}}},"9tpK":function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return c}));var r=n("mMyr"),a=n("huli"),i=n("kXuq"),o=n("KOTC"),s=n("Afz2");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const c="toastNotificationListRoot";function l(e){const t=e.toastNotifications?Object.keys(e.toastNotifications):[];return a.createPortal(r.createElement(i.a,{key:c,id:c,role:s.v},t.length>0&&r.createElement(o.a,{key:"toastNotificationContainer",loader:()=>n.e(170).then(n.bind(null,"VWQk")).then(e=>e.ToastNotificationList)}),t.length>0&&(l=e.toastNotifications[t[0]].props.message,r.createElement(i.a,{key:"toastNotification_Accessibility",accessibilityLive:"assertive",role:s.a,style:{width:0,height:0,overflow:"hidden"}},l))),document.body);var l}l.displayName="ToastNotificationContainer"},"9wSR":function(e,t,n){"use strict";n.d(t,"g",(function(){return c})),n.d(t,"e",(function(){return l})),n.d(t,"f",(function(){return s})),n.d(t,"d",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return o}));const r="form.updateautosaveinterval",a="form.incrementautosaveinterval",i=3e4,o=20*i,s={};function c(e){return s[e]&&(clearTimeout(s[e]),delete s[e]),{type:r,payload:void 0,meta:{pageId:e}}}function l(e){return{type:a,payload:void 0,meta:{pageId:e}}}},"9wih":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("EBJu"),a=n("ruPX");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function i(e,t,n){return Object(a.a)(r.a,e,t,n)}},"9xX1":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("D+Bz"),a=n("n3bs"),i=n("Qjw6"),o=n("IfHN");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const s={type:r.a.Page,pageType:a.a.BULK_EDIT,factory:i.a,isRedirect:!0,getDialogOptions:e=>null,urlToInput:e=>o.a.urlToInput(e),inputToUrl:(e,t)=>o.a.inputToUrl(e,t,!1)};Object.freeze(s)},A09F:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.QuickCreateForm=1]="QuickCreateForm",e[e.MainFormDialog=2]="MainFormDialog",e[e.EditForm=3]="EditForm"}(r||(r={}))},A2T2:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return o}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="recentItem.pin",a="recentItem.unpin";function i(e){return{type:"recentItem.pin.sync",execute(t,n){t.dispatch(function(e){return{type:r,payload:e}}(e)),window.setTimeout(()=>n.RecentItemsSyncManager.notifyRecentItemsUpdate())},sync:!0}}function o(e){return{type:"recentItem.unpin.sync",execute(t,n){t.dispatch(function(e){return{type:a,payload:e}}(e)),window.setTimeout(()=>n.RecentItemsSyncManager.notifyRecentItemsUpdate())},sync:!0}}},A8zQ:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("+hKY"),a=n("GYEz"),i=n("w1eR"),o=n("3/02"),s=n("Lyxw");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const c={Chrome:83,Edge:83,Firefox:76},l={Chrome:83,Edge:83,Firefox:76};function u(e){if(Object(a.a)(e)===i.a.Browser){const t=r.AWTLogManager.getSemanticContext(),n=t.getDeviceBrowserName(),a=t.getDeviceBrowserVersion(),i=Object(s.f)(e,o.p)?l:c;if(n&&a&&void 0!==i[n]){const e=parseInt(a.includes(".")?a.substr(0,a.indexOf(".")):a,10);if(!isNaN(e))return e>=i[n]}}return!0}},AAlD:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="appsettings.updateGroupsState";function a(e){return{type:r,payload:e}}},ABCl:function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return g})),n.d(t,"c",(function(){return h}));var r=n("2yvP");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class a{constructor(e){this._innerPromise=e}then(e,t){const n=Object(r.a)();let a,i;return e&&(a=t=>Object(r.b)(n,()=>e(t))),t&&(i=e=>Object(r.b)(n,()=>t(e))),this._innerPromise.then(a,i)}catch(e){const t=Object(r.a)();let n;return e&&(n=n=>Object(r.b)(t,()=>e(n))),this._innerPromise.catch(n)}finally(e){const t=Object(r.a)();let n;return e&&(n=()=>Object(r.b)(t,()=>e())),this._innerPromise.finally(n)}}Symbol.toStringTag;var i=n("ZIjf"),o=n("pEXn"),s=n("IaGr"),c=n("16wZ"),l=n("wL2W"),u=n("+Qpx"),d=n("4aOd"),p=n("WePp");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const f="Exception in customer logic";Object(p.b)({sanitize:function(e,t,n){try{const r=Object.assign({},n);if(e===o.r.Name){const e=t[o.g.ComponentName].toString();(null==e?void 0:e.indexOf(`${u.l}${u.k}`))>=0&&r[u.k]&&(r[u.k]="<sanitized>")}return r}catch(e){return n}},diagnosticName:"ClientApi",eventNames:[o.r.Name]});class g{constructor(e,t,n,r){var a;if(this._eventParameters=[],this._failureReports={},this._isInMonitorSession=Object(l.a)(),this._fileName=null===(a=t.split("."))||void 0===a?void 0:a[1],this._store=e,n&&this.addEventParameter({name:"contextToken",value:JSON.stringify(n),isEventParam:!0}),r){const e=this.getComponentName("constructor");this._validateParamsInternal(e,r);for(const e of r)this.addEventParameter(e)}}getComponentName(e){return`ClientApi.${this._fileName}.${e}`}reportFailure(e,t,n){s.a.getInstance().eventManager.ReportComponentFailure(e,t,null,n),e=i.a.trimComponentName(e),this._failureReports[e]?this._failureReports[e]++:this._failureReports[e]=1}execute(e,t,n,r=!0,a=!1){return this._executeInternal(e,(n,a,i)=>{const o=t(n,i,{fileName:this._fileName,apiName:e});return this._reportComponentUsage(n,a,r),o},(e,t,n,a)=>this._errorHandlerSync(e,t,n,a,r),n,r,a)}executeAsync(e,t,n,r=!0,i=!1){return new a(this._executeInternal(e,(n,a,i)=>t(n,i,{fileName:this._fileName,apiName:e}).then(e=>(this._reportComponentUsage(n,a,r),e)).catch(e=>this._errorHandlerAsync(e,n,a,i,r)),(e,t,n,a)=>this._errorHandlerAsync(e,t,n,a,r),n,r,i))}_executeInternal(e,t,n,a,o=!0,c=!1){a||(a=[]);const l=Object(r.a)();a.push({name:"clientApiSource",value:l.sourceName,isEventParam:!0});const u=this.getComponentName(e);let d,p;try{this._validateParamsInternal(u,a)}catch(t){throw this.runClientApiChecker(e,a,null==t?void 0:t.toString()),t}try{return d=this._getEventParams(a),o&&(i.a.instance.reportCall(u,l),"unknown"===l.sourceName&&s.a.getInstance().traceManager.getTracer(u).info("Client API was called with unknown source attribution.",d)),t(u,l,d)}catch(e){return p=e,n(e,u,l,d)}finally{c&&this._isInMonitorSession&&this.runClientApiChecker(e,a,p)}}runClientApiChecker(e,t,n){var r,a,i,c;if(!this._isInMonitorSession)return;const l=e=>void 0===e?"undefined":e,p=new d.a(new Error),f=null===(r=null==t?void 0:t.filter(e=>null==e?void 0:e.isClientAPICheckerParam))||void 0===r?void 0:r.map(e=>({name:l(e.name),value:l(e.value)})),g={apiName:`${this._fileName}.${e}`,"inputs / options / parameters etc.":null!=f?f:null,"callStack for caller code (this is not an error)":p.getStackTrace(),"Client API failed":null===n?void 0:n};null===(c=null===(i=null===(a=s.a.getInstance())||void 0===a?void 0:a.traceManager)||void 0===i?void 0:i.getTracer(`${u.l}${u.k}`))||void 0===c||c.warn(u.m,[{name:o.l,value:`${this._fileName}.${e}`},{name:u.k,value:JSON.stringify(g)}])}addEventParameter(e){e.isEventParam&&this._eventParameters.push(e)}_errorHandlerSync(e,t,n,r,a){throw e.errorCode?2415919125!==e.errorCode&&2415919121!==e.errorCode&&(r.push({name:"errorCode",value:e.errorCode}),r.push({name:"errorMessage",value:e.message}),s.a.getInstance().traceManager.getTracer(t).error("Error detected with an error code.  See EventContext for more details.",r)):this.reportFailure(t,e,r),this._reportComponentUsage(t,n,a),e.errorCode=2415919125,e}_errorHandlerAsync(e,t,n,r,a){if(2415919121===e.errorCode)throw this._reportComponentUsage(t,n,a),e;const i=e;return Object(c.d)(this._store,e,t,r,!0,!1,this).catch(e=>{throw this._reportComponentUsage(t,n,a),e.raw=JSON.stringify(i),e})}_reportComponentUsage(e,t,n){n&&(this._failureReports[e]?i.a.instance.reportFailure(e,t):i.a.instance.reportSuccess(e,t)),this._failureReports[e]=0}_validateParamsInternal(e,t){if(t){const n=this._getEventParams(t);for(const r of t)r.isRequired&&Object(c.g)(r.value,e,r.name,n),r.expectedDataType&&null!==r.value&&void 0!==r.value&&Object(c.f)(e,r.name,r.value,r.expectedDataType,n)}}_getEventParams(e){var t;const n=[];for(const e of this._eventParameters)n.push(e);const a=Object(r.a)();if((null===(t=a.eventParameters)||void 0===t?void 0:t.length)>0)for(const e of a.eventParameters)n.push(e);if(e)for(const t of e)t.isEventParam&&n.push(t);return n}}function h(e,t,n){try{return n()}catch(n){console.error(`${f}: ${n.message}`),t.push({name:"exception",value:n.message}),t.push({name:"exceptionStack",value:n.stack}),s.a.getInstance().traceManager.getTracer(e).error(f,t)}}},ABtu:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return f}));var r=n("kAKO"),a=n("yHIv"),i=n("Eh65"),o=n("n/Vw"),s=n("4aOd"),c=n("TBkx"),l=n("H4dV"),u=n("pEXn"),d=n("WePp");class p{constructor(e,t=window){this._eventHandlers=[],this._unhandledErrorDebounceTimeout=-1,this._unhandledEventDataList=[],this._catchError=this._catchError.bind(this),this._handleError=this._handleError.bind(this),this._baseHandler=t.onerror,t.onerror=this._catchError,this._applicationContext=e,this._windowName=t.name;this._eventHandlers.push((e,t)=>{const n=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t,n,r,a,i,o,s){const c=new d.a(u.o.Name);return c.addEventParameter(u.g.ComponentName,e),c.addEventParameter(u.o.FileName,t),c.addEventParameter(u.o.FunctionName,n),c.addEventParameter(u.o.LineNumber,r),c.addEventParameter(u.o.ColumnNumber,a),c.addEventParameter(u.o.CommonError.Message,i),c.addEventParameter(u.o.CommonError.CallStack,o),c.addEventParameter(u.o.WindowName,s),c}(e,t.fileName,t.func,t.lineNumber,t.columnNumber,t.errorMessage,t.stackTrace,t.windowName);this._applicationContext.EventManager.ReportEvent(n,i.a.Low)})}addEventHandler(e){this._eventHandlers.push(e)}raise(e,t){if(void 0!==e&&(this._eventData=e,this._eventHandlers.forEach(n=>n(t,e)),function(e){if(!e)return!1;if(Object(c.i)(e.errorCode))return!0;return!1}(e)||this._unhandledEventDataList.push(e),-1===this._unhandledErrorDebounceTimeout&&this._unhandledEventDataList.length>0))try{this._unhandledErrorDebounceTimeout=setTimeout(this._handleError,1e4)}catch(e){throw Error(e.message)}}_handleError(){const e=this._unhandledEventDataList.slice();if(this._unhandledEventDataList=[],this._baseHandler){const t=this._baseHandler(void 0,void 0,void 0,void 0,void 0,e,this._applicationContext.EventManager.getCurrentSessionId());t instanceof Promise?t.then(()=>{if(this._unhandledEventDataList.length>0)return window.clearTimeout(this._unhandledErrorDebounceTimeout),void(this._unhandledErrorDebounceTimeout=setTimeout(this._handleError,5e3));this._unhandledErrorDebounceTimeout=-1}):this._unhandledErrorDebounceTimeout=-1}}eventData(){return this._eventData}buildCrashData(e,t,n,r,a,i){let o;return this.isOutOfMemoryError(e)?(o={},o.errorMessage="Out of Memory!",o.lineNumber=n,o.columnNumber=r,o.func="",o.fileName="",o.isOutOfMemoryError=!0,o.errorType=i,o.windowName=this._windowName):o=this._collectCrashData(e,t,n,r,a,i,this._windowName),o}buildUnknownCrashData(e,t){let n="";try{n=JSON.stringify(t)}catch(e){n="Received an uncaught Unknown Error Event which failed to be stringified for the following reason: "+e.message}const r=Error("Unknown Error Event");r.stack="No stack available.";return this.buildCrashData(n,e,0,0,r,o.a.UnhandledRejection)}isOutOfMemoryError(e){return!!l.a.getInstance().get_IsBrowserIE()&&"143abf4577894d22ae34a054a6dce7fe"===e}_collectCrashData(e,t,n,r,a,i,o){const c=new s.a(a),l={isOutOfMemoryError:!1};l.lineNumber=n,l.columnNumber=r,l.func=c.getFunctionName();const u=new URL(t,window.location.origin);return l.fileName=u.pathname,l.stackTrace=c.getStackTrace(),l.errorMessage=e,l.errorType=i,l.windowName=o,a&&a.errorCode&&(l.errorCode=a.errorCode),l}_catchError(e,t,n,r,a){const i=this.buildCrashData(e,t,n,r,a,o.a.UnhandledError);return this.raise(i,"ErrorLogging"),!0}replaceBaseHandler(e){this._baseHandler=e}ensureErrorObject(e){return Object(c.e)(e,this._applicationContext.TraceManager.getTracer("ErrorHandler"))}}function f(){return{diagnosticName:"ErrorHandler",boot:(e,t)=>{const n=new p(t);t.ErrorHandler=n,function(e){window.addEventListener("unhandledrejection",t=>{const n=new URL(window.location.href,window.location.origin);if(void 0!==t&&void 0!==t.reason&&void 0!==t.promise){const r=t.reason.lineNumber||0,a=t.reason.columnNumber||0;t.promise.catch(t=>{const i=e.ensureErrorObject(t),s=e.buildCrashData(i.message,n.pathname,r,a,i,o.a.UnhandledRejection);e.raise(s,"UnhandledRejectionLogging")})}else if(void 0!==t.reason&&t.reason.get_organizationServiceFault){const r=e.ensureErrorObject(t),a=e.buildCrashData(r.message,n.pathname,0,0,r,o.a.UnhandledRejection);e.raise(a,"UnhandledRejectionLogging")}else{const r=e.buildUnknownCrashData(n.pathname,t);e.raise(r,"UnhandledRejectionLogging")}})}(n),function(e){if(e&&e.EventManager){const t=window.__preloadErrors;t&&(t.forEach(t=>{e.EventManager.ReportComponentFailure("Boot.Preload",t)}),window.__preloadErrors=[])}}(t)},supportedClientHostTypes:a.a,supportedPageTypes:a.b,priority:r.a.Normal}}},AEtR:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class r{getMetadata(){return{boundParameter:null,operationName:"GetRecentItems",operationType:0,parameterTypes:{entityNames:{typeName:"Edm.String",structuralProperty:4},preferredPinnedItems:{typeName:"Edm.Int32",structuralProperty:1},preferredUnpinnedItems:{typeName:"Edm.Int32",structuralProperty:1},preferredPinnedItemsPerEntity:{typeName:"Edm.Int32",structuralProperty:1},preferredUnpinnedItemsPerEntity:{typeName:"Edm.Int32",structuralProperty:1},appId:{typeName:"Edm.String",structuralProperty:1}}}}}},"AF/G":function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return s})),n.d(t,"e",(function(){return c})),n.d(t,"f",(function(){return l})),n.d(t,"g",(function(){return u})),n.d(t,"h",(function(){return d})),n.d(t,"i",(function(){return p})),n.d(t,"j",(function(){return f})),n.d(t,"k",(function(){return g})),n.d(t,"l",(function(){return h})),n.d(t,"m",(function(){return m})),n.d(t,"n",(function(){return b})),n.d(t,"p",(function(){return y})),n.d(t,"q",(function(){return _})),n.d(t,"r",(function(){return v})),n.d(t,"s",(function(){return S})),n.d(t,"t",(function(){return O})),n.d(t,"o",(function(){return C})),n.d(t,"u",(function(){return E})),n.d(t,"v",(function(){return I})),n.d(t,"w",(function(){return w})),n.d(t,"x",(function(){return j})),n.d(t,"y",(function(){return P})),n.d(t,"z",(function(){return T})),n.d(t,"A",(function(){return N})),n.d(t,"B",(function(){return A})),n.d(t,"C",(function(){return R})),n.d(t,"D",(function(){return D})),n.d(t,"E",(function(){return x})),n.d(t,"G",(function(){return M})),n.d(t,"H",(function(){return F})),n.d(t,"I",(function(){return k})),n.d(t,"J",(function(){return L})),n.d(t,"K",(function(){return B})),n.d(t,"L",(function(){return U})),n.d(t,"M",(function(){return V})),n.d(t,"N",(function(){return z})),n.d(t,"O",(function(){return q})),n.d(t,"P",(function(){return H})),n.d(t,"Q",(function(){return W})),n.d(t,"R",(function(){return G})),n.d(t,"S",(function(){return K})),n.d(t,"T",(function(){return Q})),n.d(t,"U",(function(){return X})),n.d(t,"V",(function(){return Y})),n.d(t,"W",(function(){return J})),n.d(t,"X",(function(){return $})),n.d(t,"Y",(function(){return Z})),n.d(t,"Z",(function(){return ee})),n.d(t,"ab",(function(){return te})),n.d(t,"bb",(function(){return ne})),n.d(t,"eb",(function(){return re})),n.d(t,"db",(function(){return ae})),n.d(t,"cb",(function(){return ie})),n.d(t,"fb",(function(){return oe})),n.d(t,"gb",(function(){return se})),n.d(t,"hb",(function(){return ce})),n.d(t,"ib",(function(){return le})),n.d(t,"jb",(function(){return ue})),n.d(t,"kb",(function(){return de})),n.d(t,"lb",(function(){return pe})),n.d(t,"mb",(function(){return fe})),n.d(t,"nb",(function(){return ge})),n.d(t,"ob",(function(){return he})),n.d(t,"pb",(function(){return me})),n.d(t,"qb",(function(){return be})),n.d(t,"rb",(function(){return ye})),n.d(t,"sb",(function(){return _e})),n.d(t,"tb",(function(){return ve})),n.d(t,"ub",(function(){return Se})),n.d(t,"vb",(function(){return Oe})),n.d(t,"wb",(function(){return Ce})),n.d(t,"F",(function(){return Ee}));var r=n("SAYH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a=new r.a("f93a31b2-99ac-4084-8ec2-d4027c31369a"),i=new r.a("3f4e2a56-f102-4b4d-ab9c-f1574ca5bfda"),o=new r.a("c8bfbbef-6851-4401-a0cc-7450062fe085"),s=new r.a("c72511ab-84e5-4fb7-a543-25b4fc01e83e"),c=new r.a("6636847d-b74d-4994-b55a-a6faf97ecea2"),l=new r.a("9c310a73-a360-42c5-8943-47a06f1b51ea"),u=new r.a("f02ef977-2564-4b9a-b2f0-df083d8a019b"),d=new r.a("62b0df79-0464-470f-8af7-4483cfea0c7d"),p=new r.a("00ad73da-bd4d-49c6-88a8-2f4f4cad4a20"),f=new r.a("b0c6723a-8503-4fd7-bb28-c8a06ac933c2"),g=new r.a("db1284ef-9ffc-4e99-b382-0cc082fe2364"),h=new r.a("3246f906-1f71-45f7-b11f-d7be0f9d04c9"),m=new r.a("821acf1a-7e46-4a0c-965d-fe14a57d78c7"),b=new r.a("4168a05c-d857-46af-8457-5bb47eb04ea1"),y=new r.a("d2561f53-b292-42d9-b222-478e40ffe29f"),_=new r.a("5b773807-9fb2-42db-97c3-7a91eff8adff"),v=new r.a("c3efe0c3-0ec6-42be-8349-cbd9079dfd8e"),S=new r.a("aa987274-ce4e-4271-a803-66164311a958"),O=new r.a("6896f004-b17a-4202-861e-8b7ea2080e0b"),C=new r.a("f9a8a302-114e-466a-b582-6771b2ae0d92"),E=new r.a("1479835f-f852-4679-b864-c6892a2844c9"),I=new r.a("ada2203e-b4cd-49be-9ddf-234642b43b52"),w=new r.a("6f3fb987-393b-4d2d-859f-9d0f0349b6ad"),j=new r.a("f454228d-1d25-4319-e12f-d27968bc0234"),P=new r.a("26e9760f-7454-40de-bb07-f6dcccb82040"),T=new r.a("00000000-0000-0000-0000-000000000000"),N=new r.a("f4c16eca-ca81-4e39-9448-834b8378721e"),A=new r.a("0d2c745a-e5a8-4c8f-ba63-c6d3bb604660"),R=new r.a("fd2a7985-3187-444e-908d-6624b21f69c0"),D=new r.a("fff0e632-9d7b-4f21-bbc1-05d1567ad144"),x=new r.a("e7a81278-8635-4d9e-8d4d-59480b391c5b"),M=new r.a("5546e6cd-394c-4bee-94a8-4425e17ef6c6"),F=new r.a("c6d124ca-7eda-4a60-aea9-7fb8d318b68f"),k=new r.a("a62b6fa9-169e-406c-b1aa-eab828cb6026"),L=new r.a("39354e4a-5015-4d74-8031-ea9eb73a1322"),B=new r.a("671a9387-ca5a-4d1e-8ab7-06e39ddcf6b5"),U=new r.a("dfdf1cde-837b-4ac9-98cf-ac74361fd89d"),V=new r.a("270bd3db-d9af-4782-9025-509e298dec0a"),z=new r.a("b634828e-c390-444a-afe6-e07315d9d970"),q=new r.a("91dc0675-c8b9-4421-b1e0-261cebf02bac"),H=new r.a("533b9e00-756b-4312-95a0-dc888637ac78"),W=new r.a("4aa28ab7-9c13-4f57-a73d-ad894d048b5f"),G=new r.a("76b9e25e-695e-4fef-ac69-f05cfa96739c"),K=new r.a("cbfb742c-14e7-4a17-96bb-1a13f7f64aa2"),Q=new r.a("8c10015a-b339-4982-9474-a95fe05631a5"),X=new r.a("3ef39988-22bb-4f0b-bbbe-64b5a3748aee"),Y=new r.a("2305e33a-bad3-4022-9e15-1856cf218333"),J=new r.a("5d68b988-0661-4db2-bc3e-17598ad3be6c"),$=new r.a("8c54228c-1b25-4909-a12a-f2b968bb0d62"),Z=new r.a("06e9f7af-1f54-4681-8eec-1e21a1ceb465"),ee=new r.a("69af7dca-2e3b-4ee7-9201-0da731dd2413"),te=new r.a("5c5600e0-1d6e-4205-a272-be80da87fd42"),ne=new r.a("67fac785-cd58-4f9f-abb3-4b7ddc6ed5ed"),re=new r.a("02d4264b-47e2-4b4c-aa95-f439f3f4d458"),ae=new r.a("7ccd1494-1f7a-4e3a-8bde-f32069daeb9f"),ie=new r.a("b68b05f0-a46d-43f8-843b-917920af806a"),oe=new r.a("f3015350-44a2-4aa0-97b5-00166532b5e9"),se=new r.a("163b90a6-eb64-49d2-9df8-3c84a4f0a0f8"),ce=new r.a("5f986642-5961-4d9f-ab5e-643d71e231e9"),le=new r.a("a28f441b-916c-4865-87fd-0c5d53bd59c9"),ue=new r.a("f94db24f-263d-44a7-b38e-a35e9854812b"),de=new r.a("e616a57f-20e0-4534-8662-a101b5ddf4e0"),pe=new r.a("86b9e25e-695e-4fef-ac69-f05cfa96739c"),fe=new r.a("ee9078c8-6946-4e2c-b8f8-35e65f4be6a8"),ge=new r.a("e0dece4b-6fc8-4a8f-a065-082708572369"),he=new r.a("4273edbd-ac1d-40d3-9fb2-095c621b552d"),me=new r.a("1e1fc551-f7a8-43af-ac34-a8dc35c7b6d4"),be=new r.a("06375649-c143-495e-a496-c962e5b4488e"),ye=new r.a("9c5ca0a1-ab4d-4781-be7e-8dfbe867b87e"),_e=new r.a("7c624a0b-f59e-493d-9583-638d34759266"),ve=new r.a("71716b6c-711e-476c-8ab8-5d11542bfb47"),Se=new r.a("9fdf5f91-88b1-47f4-ad53-c11efc01a01d"),Oe=new r.a("587cdf98-c1d5-4bde-8473-14a0bc7644a7"),Ce=new r.a("080677db-86ec-4544-ac42-f927e74b491f");function Ee(e){let t="Unknown";if(!e)return t;switch(e.guid.toLowerCase()){case a.guid:t="AccessPrivilege";break;case i.guid:t="AccessTeamEntityPicker";break;case o.guid:t="ACI";break;case s.guid:t="ActivitiesContainer";break;case c.guid:t="ActivitiesWall";break;case l.guid:t="AppliedFilters";break;case u.guid:t="ArticleContent";break;case d.guid:t="BingMap";break;case p.guid:t="Button";break;case f.guid:t="CheckBox";break;case g.guid:t="CompositionLink";break;case h.guid:t="Connection";break;case m.guid:t="ConnectionRoleObjectTypeList";break;case b.guid:t="CoverPagePickList";break;case y.guid:t="Dashboard";break;case _.guid:t="DateTime";break;case v.guid:t="Decimal";break;case S.guid:t="Duration";break;case O.guid:t="DynamicPropertyList";break;case C.guid:t="EditableGrid";break;case E.guid:t="EditFilter";break;case I.guid:t="EmailAddress";break;case w.guid:t="EmailBody";break;case j.guid:t="EmailEngagementActions";break;case P.guid:t="EmailRecipientActivity";break;case T.guid:t="Empty";break;case N.guid:t="ErrorStatus";break;case A.guid:t="Float";break;case R.guid:t="Frame";break;case D.guid:t="GlobalFilter";break;case x.guid:t="Grid";break;case M.guid:t="HiddenInput";break;case F.guid:t="Integer";break;case k.guid:t="KBViewer";break;case L.guid:t="Label";break;case B.guid:t="LanguagePicker";break;case U.guid:t="Link";break;case V.guid:t="Lookup";break;case z.guid:t="MailMergeLanguagePicker";break;case q.guid:t="MapLink";break;case H.guid:t="Money";break;case W.guid:t="MultiSelectPickList";break;case G.guid:t="OrgInsights";break;case K.guid:t="PartyList";break;case Q.guid:t="PhoneNumber";break;case X.guid:t="PickList";break;case Y.guid:t="PickListLookup";break;case J.guid:t="PickListStatus";break;case $.guid:t="PowerBI";break;case Z.guid:t="Process";break;case ee.guid:t="QuickForm";break;case te.guid:t="QuickFormCollection";break;case ne.guid:t="Radio";break;case re.guid:t="ReferencePanelSubGrid";break;case ae.guid:t="ReferencePanelSearchWidget";break;case ie.guid:t="ReferencePanelQuickFormCollection";break;case oe.guid:t="Regarding";break;case se.guid:t="RelatedInformation";break;case ce.guid:t="RelationshipRolePickList";break;case le.guid:t="Report";break;case ue.guid:t="RichEditor";break;case de.guid:t="SearchWidget";break;case pe.guid:t="SocialInsight";break;case fe.guid:t="Streams";break;case ge.guid:t="TextArea";break;case he.guid:t="TextBox";break;case me.guid:t="Ticker";break;case be.guid:t="Timeline";break;case ye.guid:t="Timer";break;case _e.guid:t="TimeZonePickList";break;case ve.guid:t="Url";break;case Se.guid:t="WebResourceHtml";break;case Oe.guid:t="WebResourceImage";break;case Ce.guid:t="WebResourceSilverlight";break;default:t=e.guid}return t}},AFlp:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n("SAYH"),a=n("eXjw");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i="businessProcessFlow.addIdToRecordData";function o(e,t){const n={entities:{[t.etn]:{[r.a.toString(t.id)]:{initialized:a.a.Initialized,businessProcessFlowId:e}}}};return{type:i,payload:n}}},AKum:function(e,t,n){"use strict";n.d(t,"f",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"b",(function(){return u})),n.d(t,"h",(function(){return c})),n.d(t,"g",(function(){return l}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="type",a="etc",i="extraqs",o="id",s="pagetype",c="viewType",l="viewid",u="etn"},ATrR:function(e,t,n){"use strict";n.d(t,"c",(function(){return b})),n.d(t,"a",(function(){return _})),n.d(t,"b",(function(){return v})),n.d(t,"d",(function(){return y}));var r=n("Wc7r"),a=n("odYE"),i=n("SAYH"),o=n("+QYJ"),s=n("16wZ"),c=n("d7fm"),l=n("/A0C"),u=n("FZDd"),d=n("LbMF"),p=n("iZ7K"),f=n("g22U"),g=n("Er26");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const h=["owner","customer","lookup"],m=["AppModuleId"];
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function b(e,t){return{type:"SERIALIZE_RETRIEVE_REQUEST",execute({dispatch:n,getState:r},i){const o=e.get_target(),s=a.a.fromLegacyEntityReference(o),c=e.get_columnSet().get_Columns(),l=e.get_navigationProperty(),d={[s.etn]:c},p=i.TraceManager.getTracer("RetrieveRequestSerializer");return y(d,r(),s.etn,l,p),n(Object(u.e)(d,t)).then(()=>_(r(),s,c,i,l))}}}function y(e,t,n,r,a){if(r)for(const i of r){const r=i.get_relationShipName(),o=Object(p.I)(t,n,r);if(o){const a=0===Object(p.L)(t,n,r)?o.ReferencingEntity:o.ReferencedEntity,s=i.get_columnNames();e[a]=s}else null==a||a.error(`[ExecuteOData] Unable to find relationship ${r} on entity ${n}`)}}function _(e,t,n,a,s,u={},m){const b=Object(p.o)(e,t.etn);let y,_;b||null==m||m.warn(`The entity set name of ${t.etn} in buildRetrieveRequest is null or undefined!`);const v=[],S=[];for(const r of n){const n=Object(d.a)(e,t.etn,r);if(!n){y=`Cannot serialize a request with no attribute metadata for ${t.etn}.${r}`;break}if(n.Type===l.a.PartyList){if(_=Object(p.b)(e,t.etn),!_){y=`The relationship for the partylist attribute ${r} is not found in the state tree or is invalid`;break}{const e=Object(c.a)(t.etn,r);if(void 0===e){y="Unknown participation type mask for attribute "+r;break}S.push(e)}}else n&&-1!==h.indexOf(n.Type)?v.push(`_${r}_value`):v.push(r)}if(y)return{serializationFailure:y};let O="";if(S.length){const e=`$filter=Microsoft.Dynamics.CRM.In(PropertyName='participationtypemask',PropertyValues=[${S.map(e=>`'${e}'`)}])`;O=`&$expand=${_.ReferencedEntityNavigationPropertyName}(${e})`}const C=function(e,t,n,r){let a="";const i=[];let s,u;if(r)for(const n of r){const r=n.get_relationShipName(),f=n.get_columnNames(),g=[],m=Object(p.I)(e,t.etn,r);if(m){const n=0===Object(p.L)(e,t.etn,r)?m.ReferencingEntity:m.ReferencedEntity;for(const t of f){const r=Object(d.a)(e,n,t);if(!r){u=`Cannot serialize a request with no attribute metadata for ${n}.${t}`;break}if(r.Type===l.a.PartyList){if(s=Object(p.b)(e,n),!s){u=`The relationship for the partylist attribute ${t} is not found in the state tree or is invalid`;break}{const e=Object(c.a)(n,t);if(void 0===e){u="Unknown participation type mask for attribute "+t;break}i.push(e)}}else r&&-1!==h.indexOf(r.Type)?g.push(`_${t}_value`):g.push(t)}}g&&g.length>0&&(a=Object(o.b)(a)?`${r}($select=${g.join(",")})`:a+","+`${r}($select=${g.join(",")})`)}if(u&&n){n.TraceManager.getTracer("RetrieveRequestSerializer").error(u)}return a}(e,t,a,s),E=C?`${O?",":"&$expand="}${C}`:"",I=Object(f.g)(u);return{urlParameters:`${b}(${i.a.toString(t.id)})?$select=${v.join(",")}${O}${E}`,additionalHeaders:{[r.HEADER.PREFER]:r.HEADER_VALUES.ANNOTATIONS,[r.HEADER.ACCEPT]:r.HEADER_VALUES.APPLICATION_JSON,[r.HEADER.MSCRM_RETURN_NOTIFICATIONS]:"true"},method:"GET",additionalParameters:{[f.a.TYPE]:f.d.RETRIEVE,[f.a.SUB_TYPE]:f.c.Retrieve,[g.e]:t.etn,[f.a.SOURCE]:I}}}function v(e,t,n,r,a,c,l=!1,u={},d,h){const m=Object(p.o)(e,t);m||null==h||h.warn(`The entity set name of ${t} in buildRetrieveRequestWithURLParams is null or undefined!`);const b=Object(s.a)(n)?"":`(${i.a.tryParse(n).guid})`,y=a&&"number"==typeof a?",odata.maxpagesize="+a:"";let _=f.d.RETRIEVE,v=f.c.Retrieve;l&&(v=f.c.BinaryDownload),Object(o.b)(b)&&(_=f.d.RETRIEVE_MULTIPLE,v=f.c.CustomQuery);const O=Object(f.g)(u),C={urlParameters:`${m}${b}${r||""}`,additionalHeaders:S(d,y),method:"GET",additionalParameters:{[f.a.TYPE]:_,[f.a.SUB_TYPE]:v,[g.e]:t,[f.a.SOURCE]:O}};return c&&"object"==typeof c&&Object.assign(C.additionalHeaders,c),C}function S(e,t){const n={};if(e&&Object.keys(e).length>-1)for(const t in e)m.indexOf(t)>-1&&(n[t]=e[t]);return Object.assign(Object.assign({},n),{[r.HEADER.PREFER]:t?`${r.HEADER_VALUES.ANNOTATIONS}${t}`:""+r.HEADER_VALUES.ANNOTATIONS,[r.HEADER.ACCEPT]:r.HEADER_VALUES.APPLICATION_JSON,[r.HEADER.MSCRM_RETURN_NOTIFICATIONS]:"true"})}},AVDU:function(e,t,n){"use strict";n.d(t,"n",(function(){return _})),n.d(t,"g",(function(){return S})),n.d(t,"f",(function(){return O})),n.d(t,"c",(function(){return E})),n.d(t,"i",(function(){return I})),n.d(t,"l",(function(){return w})),n.d(t,"j",(function(){return j})),n.d(t,"k",(function(){return P})),n.d(t,"m",(function(){return T})),n.d(t,"o",(function(){return N})),n.d(t,"e",(function(){return A})),n.d(t,"h",(function(){return R})),n.d(t,"b",(function(){return D})),n.d(t,"a",(function(){return x})),n.d(t,"p",(function(){return M})),n.d(t,"d",(function(){return F}));var r=n("Lyxw"),a=n("3/02"),i=n("b8TU"),o=n("Knfm"),s=n("GEbX"),c=n("GYEz"),l=n("w1eR"),u=n("glAs"),d=n("0kGT"),p=n("4leG"),f=n("h4iz"),g=n("504W"),h=n("IqkD"),m=n("GWSs"),b=n("oB6S"),y=n("E5IU");function _(e){return!T(e)}function v(e){return T(e)&&Object(c.a)(e)!==l.a.MailApp&&!Object(p.c)(e)&&!N(e)}function S(e){return v(e)&&I(e)}function O(e){return v(e)&&!I(e)}function C(e){return!!Object(r.f)(e,a.Ve)&&!(Object(d.c)(e)&&!Object(r.f)(e,a.xe))}function E(e){return!!C(e)&&Object(m.h)(e)}function I(e){return!F(e)&&(!C(e)||Object(m.c)(e))}function w(e){return!F(e)&&(!C(e)||Object(m.e)(e))}function j(e){return!F(e)&&(!C(e)||Object(m.d)(e))}function P(e){return Object(r.f)(e,a.lc)}function T(e){const t=Object(f.a)(e);return!Object(g.a)(t)&&(Object(c.a)(e)===l.a.MailApp||(Object(i.e)(e)||Object(u.a)(e)))}function N(e){var t;const n=Object(c.a)(e),r=Object(p.c)(e),a=Object(c.a)(e)===l.a.MailApp;return!(!(null===(t=Object(h.x)(e))||void 0===t?void 0:t.isLive)||n===l.a.MobileApplication||a||r)&&A(e)}function A(e){const t=T(e),n=Object(r.d)(e,a.kf,a.Th);return t&&n}function R(e){return Object(o.a)(e)===s.a.MultiSession||!Object(d.c)(e)}function D(e,t,n,r){return r?"228px":t?"84%":1===n?e.sizes.SiteMap.RefreshedWidth:e.sizes.SiteMap.RefreshedWidthCollapsed}function x(e,t){return t?"228px":e&&b.a+"px"}function M(e){return Object(r.d)(e,a.kf,a.Th)}function F(e){const t=Object(y.i)(a.Xe,e),n=Object(r.f)(e,a.Xe),i=t||n,c=Object(o.a)(e);return i&&c===s.a.MultiSession&&!T(e)}},AckI:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return c}));var r=n("69Qu"),a=n("jS4H"),i=n("37s6");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function o(e,t){const n=Object(a.a)(e,t);return n&&null!==n.isSearchOnline?n.isSearchOnline:i.E?Object(r.b)(e):Object(r.c)(e)}function s(e,t){const n=Object(a.a)(e,t.id);return n?n.categorizedSearchData.searchFilter:null}function c(e,t){const n=Object(a.a)(e,t.id);return n?n.isBarcodeScanned:null}},Ae6N:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.UserLocal=1]="UserLocal",e[e.DateOnly=2]="DateOnly",e[e.TimeZoneIndependent=3]="TimeZoneIndependent"}(r||(r={}))},Afz2:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"f",(function(){return o})),n.d(t,"r",(function(){return s})),n.d(t,"s",(function(){return c})),n.d(t,"u",(function(){return l})),n.d(t,"w",(function(){return u})),n.d(t,"x",(function(){return d})),n.d(t,"y",(function(){return p})),n.d(t,"z",(function(){return f})),n.d(t,"A",(function(){return g})),n.d(t,"C",(function(){return h})),n.d(t,"m",(function(){return m})),n.d(t,"p",(function(){return b})),n.d(t,"q",(function(){return y})),n.d(t,"B",(function(){return _})),n.d(t,"g",(function(){return v})),n.d(t,"i",(function(){return S})),n.d(t,"k",(function(){return O})),n.d(t,"l",(function(){return C})),n.d(t,"n",(function(){return E})),n.d(t,"v",(function(){return I})),n.d(t,"c",(function(){return w})),n.d(t,"e",(function(){return j})),n.d(t,"h",(function(){return P})),n.d(t,"o",(function(){return T})),n.d(t,"t",(function(){return N})),n.d(t,"j",(function(){return A}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="alert",a="alertdialog",i="button",o="dialog",s="menuitem",c="menuitemradio",l="option",u="status",d="tab",p="tablist",f="tabpanel",g="timer",h="treeitem",m="listbox",b="menu",y="menubar",_="tree",v="document",S="group",O="heading",C="list",E="listitem",I="presentation",w="banner",j="complementary",P="form",T="main",N="navigation",A="header"},ApeL:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"f",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return c})),n.d(t,"g",(function(){return l})),n.d(t,"e",(function(){return u}));var r=n("dHD5");const a="dataset.row.property.update",i="dataset.row.property.dummy";function o(e,t,n,i){const o=Object(r.w)(t.parentContextToken);return{type:a,payload:{recordId:t.recordId,attributeName:n,requiredLevel:i},meta:{pageId:e,dataSetContextKey:o}}}function s(e,t,n,i){const o=Object(r.w)(t.parentContextToken);return{type:a,payload:{recordId:t.recordId,attributeName:n,isDisabled:i},meta:{pageId:e,dataSetContextKey:o}}}function c(e,t,n,i){const o=Object(r.w)(t.parentContextToken);let s={};return s=i?i.notificationLevel&&"RECOMMENDATION"===i.notificationLevel?null:{[i.uniqueId]:i}:null,{type:a,payload:{recordId:t.recordId,attributeName:n,notifications:s},meta:{pageId:e,dataSetContextKey:o}}}function l(e,t,n,a){const o=Object(r.w)(t.parentContextToken);return{type:i,payload:{recordId:t.recordId,attributeName:n,isVisible:a},meta:{pageId:e,dataSetContextKey:o}}}function u(e,t,n,a){const o=Object(r.w)(t.parentContextToken);return{type:i,payload:{recordId:t.recordId,attributeName:n,precision:a},meta:{pageId:e,dataSetContextKey:o}}}},Axoi:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n("NjDY"),a=n("SAYH"),i=n("qshH"),o=n("5Oca"),s=n("WPtp"),c=n("6QGX"),l=n("16wZ"),u=n("ZIjf");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const d="ClientApi.XrmOrganizationSettings.";let p;class f{constructor(e){p=e}get languageId(){const e=d+"languageId";try{u.a.instance.reportCall(e);const t=Object(r.D)(p.getState()),n=t&&t.languageCode?t.languageCode:null;return u.a.instance.reportSuccess(e),n}catch(t){throw i.a.getInstance().reportFailure(e,t),t}}get isAutoSaveEnabled(){const e=d+"isAutoSaveEnabled";try{u.a.instance.reportCall(e);const t=Object(r.D)(p.getState()),n=!!t&&t.isAutoSaveEnabled;return u.a.instance.reportSuccess(e),n}catch(t){throw i.a.getInstance().reportFailure(e,t),t}}get appointmentRichEditorExperience(){const e=d+"appointmentRichEditorExperience";try{u.a.instance.reportCall(e);const t=Object(r.D)(p.getState()),n=!!t&&t.appointmentRichEditorExperience;return u.a.instance.reportSuccess(e),n}catch(t){throw i.a.getInstance().reportFailure(e,t),t}}get uniqueName(){const e=d+"uniqueName";try{u.a.instance.reportCall(e);const t=Object(r.D)(p.getState()),n=t&&t.organizationUniqueName?t.organizationUniqueName:null;return u.a.instance.reportSuccess(e),n}catch(t){throw i.a.getInstance().reportFailure(e,t),t}}get attributes(){const e=d+"attributes";try{u.a.instance.reportCall(e);const t={},n={id:new a.a(this.organizationId),etn:"organization"},r=Object(o.b)(n)(p.getState());if(r&&r.fields)for(const n in r.fields)r.fields[n]?Object(s.i)(r.fields[n])?t[n]=Object(c.g)(r.fields[n]):Object(s.j)(r.fields[n])?t[n]=Object(c.i)(r.fields[n]):Object(s.k)(r.fields[n])?t[n]=Object(c.d)(r.fields[n]):Object(s.g)(r.fields[n])?t[n]=Object(c.j)(r.fields[n]):Object(s.h)(r.fields[n])?t[n]=Object(c.h)(r.fields[n]):Object(l.h)(e,"organization.attribute",r.fields[n]):t[n]=null;return u.a.instance.reportSuccess(e),t}catch(t){throw i.a.getInstance().reportFailure(e,t),t}}get organizationId(){let e,t,n=d+"organizationId";try{if(u.a.instance.reportCall(n),e=Object(r.E)(p.getState()),e&&e.organizationId){const t=a.a.toString(e.organizationId);return u.a.instance.reportSuccess(n),t}}catch(e){throw i.a.getInstance().reportFailure(n,e),e}e?e.organizationId||(n=d+"state.organizationId",t="OrganizationId is coming as null"):(n=d+"state",t="State is coming as null");const o=new Error(t);throw i.a.getInstance().reportFailure(n,o),o}get isTrialOrganization(){const e=d+"isTrialOrganization";try{u.a.instance.reportCall(e);const t=Object(r.u)(p.getState());return u.a.instance.reportSuccess(e),t}catch(t){throw i.a.getInstance().reportFailure(e,t),t}}get organizationTenant(){const e=d+"organizationTenant";try{u.a.instance.reportCall(e);const t=Object(r.F)(p.getState())||null;return u.a.instance.reportSuccess(e),t}catch(t){throw i.a.getInstance().reportFailure(e,t),t}}get organizationGeo(){const e=d+"organizationGeo";try{u.a.instance.reportCall(e);const t=Object(r.z)(p.getState())||null;return u.a.instance.reportSuccess(e),t}catch(t){throw i.a.getInstance().reportFailure(e,t),t}}get organizationExpiryDate(){const e=d+"trialOrganizationExpiryDate";try{u.a.instance.reportCall(e);const t=Object(r.w)(p.getState())||null;return u.a.instance.reportSuccess(e),t}catch(t){throw i.a.getInstance().reportFailure(e,t),t}}get isSovereignCloud(){const e=d+"isSovereignCloud";try{u.a.instance.reportCall(e);const t=Object(r.t)(p.getState());return u.a.instance.reportSuccess(e),t}catch(t){throw i.a.getInstance().reportFailure(e,t),t}}get defaultCountryCode(){const e=d+"defaultCountryCode";try{u.a.instance.reportCall(e);const t=Object(r.D)(p.getState()),n=t&&t.defaultCountryCode?t.defaultCountryCode:null;return u.a.instance.reportSuccess(e),n}catch(t){throw i.a.getInstance().reportFailure(e,t),t}}get useSkypeProtocol(){const e=d+"useSkypeProtocol";try{u.a.instance.reportCall(e);const t=Object(r.D)(p.getState()),n=!(!t||!t.useSkypeProtocol)&&t.useSkypeProtocol;return u.a.instance.reportSuccess(e),n}catch(t){throw i.a.getInstance().reportFailure(e,t),t}}get baseCurrencyId(){const e=d+"baseCurrencyId";try{u.a.instance.reportCall(e);const t=this.baseCurrency,n=t?t.id:null;return u.a.instance.reportSuccess(e),n}catch(t){throw i.a.getInstance().reportFailure(e,t),t}}get baseCurrency(){const e=d+"baseCurrency";try{u.a.instance.reportCall(e);const t=Object(r.D)(p.getState());if(t){const n={id:a.a.toString(t.baseCurrencyId),entityType:"transactioncurrency",name:t.transactionCurrencyById[a.a.toString(t.baseCurrencyId)].currencyName};return u.a.instance.reportSuccess(e),n}return i.a.getInstance().reportFailure(e,new Error("Organization Settings are null")),null}catch(t){throw i.a.getInstance().reportFailure(e,t),t}}get isYammerConfigured(){const e=d+"isYammerConfigured";try{u.a.instance.reportCall(e);const t=Object(r.D)(p.getState()),n=!!(t&&t.yammerNetworkName&&t.yammerGroupId>=0&&!1===t.yammerOAuthAccessTokenExpired);return u.a.instance.reportSuccess(e),n}catch(t){throw i.a.getInstance().reportFailure(e,t),t}}get fullNameConventionCode(){const e=d+"fullNameConventionCode";try{u.a.instance.reportCall(e);const t=Object(r.D)(p.getState());return u.a.instance.reportSuccess(e),null==t?void 0:t.fullNameConventionCode}catch(t){throw i.a.getInstance().reportFailure(e,t),t}}get quickActionToOpenRecordsInSidePaneEnabled(){const e=d+"quickActionToOpenRecordsInSidePaneEnabled";try{u.a.instance.reportCall(e);const t=Object(r.D)(p.getState());return u.a.instance.reportSuccess(e),null==t?void 0:t.quickActionToOpenRecordsInSidePaneEnabled}catch(t){throw i.a.getInstance().reportFailure(e,t),t}}get isCollaborationExperienceEnabled(){const e=d+"isCollaborationExperienceEnabled";try{u.a.instance.reportCall(e);const t=Object(r.D)(p.getState());return u.a.instance.reportSuccess(e),null==t?void 0:t.isCollaborationExperienceEnabled}catch(t){throw i.a.getInstance().reportFailure(e,t),t}}get isSharingInOrgAllowed(){const e=d+"isSharingInOrgAllowed";try{u.a.instance.reportCall(e);const t=Object(r.D)(p.getState());return u.a.instance.reportSuccess(e),null==t?void 0:t.isSharingInOrgAllowed}catch(t){throw i.a.getInstance().reportFailure(e,t),t}}get copresenceRefreshRate(){const e=d+"copresenceRefreshRate";try{u.a.instance.reportCall(e);const t=Object(r.D)(p.getState());return u.a.instance.reportSuccess(e),null==t?void 0:t.copresenceRefreshRate}catch(t){throw i.a.getInstance().reportFailure(e,t),t}}get enableAsyncMergeAPIForUCI(){const e=d+"enableAsyncMergeAPIForUCI";try{u.a.instance.reportCall(e);const t=Object(r.D)(p.getState());return u.a.instance.reportSuccess(e),null==t?void 0:t.enableAsyncMergeAPIForUCI}catch(t){throw i.a.getInstance().reportFailure(e,t),t}}}},Az35:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}));var r=n("mMyr"),a=n("KOTC");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function i(e,t){const n=n=>r.createElement(a.a,{loader:()=>e().then(e=>e[t]),props:n},n.children);return n.displayName=`LoadableComponent(${t})`,n}function o(e){return i(()=>Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(7),n.e(10),n.e(18),n.e(20),n.e(21),n.e(24),n.e(22),n.e(25),n.e(30),n.e(27),n.e(29),n.e(31),n.e(32),n.e(33),n.e(38),n.e(41),n.e(65),n.e(4),n.e(5),n.e(6),n.e(75)]).then(n.bind(null,"0jo4")),e)}},"B+9Q":function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"c",(function(){return d})),n.d(t,"b",(function(){return p}));var r,a=n("3/02");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */!function(e){e[e.Lite=1]="Lite",e[e.Full=2]="Full"}(r||(r={}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i={list:n("dpM5").g.concat([{name:a.kd,value:!0},{name:a.Vg,value:!0},{name:a.hg,value:!0},{name:a.af,value:!0},{name:a.Cg,value:!0},{name:a.hh,value:!0},{name:a.Ug,value:!0},{name:a.Nh,value:!0},{name:a.E,value:!0},{name:a.F,value:!0},{name:a.O,value:!0},{name:a.Gd,value:!0,valueByCdsCapabilityMode:{[r.Lite]:!1}},{name:a.Dd,value:!0,valueByCdsCapabilityMode:{[r.Lite]:!1}},{name:a.Fd,value:!0,valueByCdsCapabilityMode:{[r.Lite]:!1}},{name:a.Bd,value:!0},{name:a.Ed,value:!0},{name:a.Cd,value:!0},{name:a.Xd,value:!0},{name:a.Rb,value:!1},{name:a.lb,value:!1},{name:a.I,value:!0},{name:a.Sf,value:!0},{name:a.R,value:!0},{name:a.Ah,value:!0},{name:a.Eg,value:!0},{name:a.Gg,value:!1},{name:a.Hg,value:!0},{name:a.og,value:!1},{name:a.ng,value:!0},{name:a.mg,value:!0},{name:a.Z,value:!0},{name:a.P,value:!0},{name:a.Ad,value:!0,valueByCdsCapabilityMode:{[r.Lite]:!1}},{name:a.d,value:!0},{name:a.hc,value:!0},{name:a.Uh,value:!1},{name:a.Wb,value:!0},{name:a.pg,value:!0},{name:a.mc,value:!0},{name:a.Vb,value:!0},{name:a.Ob,value:!0},{name:a.zg,value:!0},{name:a.K,value:!0},{name:a.t,value:!0},{name:a.xc,value:!0},{name:a.Hh,value:!0},{name:a.qh,value:!1},{name:a.ph,value:!1},{name:a.Dg,value:!0},{name:a.Vd,value:!0},{name:a.fg,value:!0},{name:a.mh,value:!1},{name:a.Yc,value:!0},{name:a.ab,value:!0},{name:a.uh,value:!0},{name:a.hd,value:!0},{name:a.Xc,value:!0},{name:a.ad,value:!0},{name:a.ch,value:!0},{name:a.be,value:!1},{name:a.Sd,value:!0},{name:a.Tc,value:!0},{name:a.eb,value:!0},{name:a.wg,value:!0},{name:a.Wc,value:!0},{name:a.tc,value:!0},{name:a.hb,value:!1},{name:a.Qb,value:!0},{name:a.tf,value:!1},{name:a.dd,value:!1},{name:a.cd,value:!0},{name:a.v,value:!0},{name:a.Sc,value:!0},{name:a.Ph,value:!0},{name:a.nc,value:!0},{name:a.lc,value:!1},{name:a.Qc,value:!0},{name:a.xd,value:!1},{name:a.ig,value:!0},{name:a.Oh,value:!1},{name:a.Vc,value:!0},{name:a.Of,value:!0},{name:a.We,value:!0},{name:a.de,value:!1},{name:a.te,value:!0},{name:a.Db,value:!0},{name:a.wf,value:!1},{name:a.Mc,value:!0},{name:a.r,value:!0},{name:a.q,value:!1},{name:a.C,value:!0},{name:a.Xb,value:!1},{name:a.jd,value:!1},{name:a.Ib,value:!0},{name:a.rb,value:!1},{name:a.qb,value:!1},{name:a.Rf,value:!0},{name:a.fh,value:!0},{name:a.eh,value:!0},{name:a.gh,value:!0},{name:a.Zg,value:!0},{name:a.Rh,value:!0},{name:a.N,value:!0},{name:a.Rd,value:!0},{name:a.Ae,value:!1},{name:a.Pe,value:!1},{name:a.wd,value:!0},{name:a.e,value:!0},{name:a.Mh,value:!0},{name:a.bf,value:!1},{name:a.X,value:!1},{name:a.De,value:!1},{name:a.of,value:!0},{name:a.yg,value:!0},{name:a.xg,value:!1},{name:a.z,value:!0},{name:a.df,value:!0},{name:a.H,value:!0},{name:a.M,value:!1},{name:a.G,value:!0},{name:a.Q,value:!1},{name:a.J,value:!0},{name:a.ih,value:!0},{name:a.S,value:!0},{name:a.td,value:!1},{name:a.sd,value:!1},{name:a.oh,value:!1},{name:a.Uc,value:!1},{name:a.L,value:!0},{name:a.Tf,value:!0},{name:a.bh,value:!0},{name:a.dg,value:!0},{name:a.vg,value:!0},{name:a.sg,value:!1},{name:a.ug,value:!1},{name:a.tg,value:!1},{name:a.rg,value:!1},{name:a.ae,value:!0},{name:a.mb,value:!0},{name:a.Gh,value:!0},{name:a.yc,value:!0},{name:a.Lf,value:!0},{name:a.Gc,value:!0},{name:a.Ng,value:!1},{name:a.Pg,value:!0},{name:a.Dc,value:!0},{name:a.Ec,value:!1},{name:a.qc,value:!1},{name:a.pc,value:!1},{name:a.Af,value:!0},{name:a.f,value:!0},{name:a.Yd,value:!0},{name:a.gf,value:!1},{name:a.le,value:!0},{name:a.Lc,value:!0},{name:a.Eb,value:!0},{name:a.Wd,value:!0},{name:a.Cc,value:!0},{name:a.Ef,value:!0},{name:a.Ff,value:!1},{name:a.Gf,value:!1},{name:a.Kf,value:!0},{name:a.id,value:!0},{name:a.ub,value:!0},{name:a.dh,value:!0},{name:a.If,value:!0},{name:a.Cf,value:!1},{name:a.Jf,value:!0},{name:a.Mf,value:!0},{name:a.yd,value:!1},{name:a.vd,value:!1},{name:a.nf,value:!1},{name:a.o,value:!1},{name:a.ee,value:!1},{name:a.he,value:!1},{name:a.Ih,value:!1},{name:a.zd,value:!0},{name:a.Nc,value:!0},{name:a.fb,value:!0},{name:a.uf,value:!1},{name:a.Oc,value:!0},{name:a.lg,value:!1},{name:a.Pc,value:!0},{name:a.Ze,value:!0},{name:a.we,value:!0},{name:a.m,value:!0},{name:a.n,value:!1},{name:a.Ud,value:!0},{name:a.Qf,value:!0},{name:a.s,value:!0},{name:a.Zd,value:!0},{name:a.eg,value:!0},{name:a.Hb,value:!1},{name:a.l,value:!0},{name:a.Lg,value:!0},{name:a.cf,value:!0},{name:a.rc,value:!1},{name:a.Bh,value:!0},{name:a.Ch,value:!0},{name:a.vb,value:!0},{name:a.Zf,value:!1},{name:a.Bc,value:!1},{name:a.nb,value:!1},{name:a.Nb,value:!0},{name:a.gd,value:!0},{name:a.bd,value:!0},{name:a.Ve,value:!0},{name:a.xe,value:!0},{name:a.ib,value:!0},{name:a.Fh,value:!0},{name:a.Uf,value:!0},{name:a.kb,value:!0},{name:a.Df,value:!1},{name:a.Ab,value:!0},{name:a.A,value:!0},{name:a.cc,value:!0},{name:a.qg,value:!0},{name:a.hf,value:!0},{name:a.Fb,value:!1},{name:a.Qh,value:!0},{name:a.Rc,value:!0},{name:a.ed,value:!0},{name:a.x,value:!0},{name:a.Pb,value:!0},{name:a.ef,value:!0},{name:a.ld,value:!1},{name:a.ac,value:!0},{name:a.Ac,value:!1},{name:a.zc,value:!1},{name:a.Nf,value:!0},{name:a.W,value:!0},{name:a.Zc,value:!1},{name:a.xf,value:!1},{name:a.yf,value:!0},{name:a.zf,value:!1},{name:a.Jg,value:!0},{name:a.Kg,value:!0},{name:a.T,value:!0},{name:a.sf,value:!0},{name:a.Wf,value:!0},{name:a.Xf,value:!1},{name:a.Vf,value:!1},{name:a.Se,value:!1},{name:a.Qe,value:!1},{name:a.Re,value:!1},{name:a.Yf,value:!0},{name:a.V,value:!0},{name:a.Og,value:!1},{name:a.bg,value:!0},{name:a.wc,value:!0},{name:a.Ue,value:!1},{name:a.gb,value:!1},{name:a.Yb,value:!1},{name:a.u,value:!0},{name:a.pf,value:!1},{name:a.Bf,value:!1},{name:a.zb,value:!1},{name:a.ec,value:!0},{name:a.Sh,value:!1},{name:a.U,value:!1},{name:a.Te,value:!0},{name:a.fe,value:!1},{name:a.jh,value:!1},{name:a.c,value:!0},{name:a.uc,value:!1},{name:a.Xe,value:!1},{name:a.g,value:!1}])};var o=n("hAdb"),s=n("504W"),c=n("NjDY");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const l="featureControlManager.clientFCBContextRetrieved",u=[a.Jg,a.Kg,a.mc,a.pg,a.Uf,a.Df];function d(e){return{type:"featureControlManager.clientFCBContextRetrieved.sync",sync:!0,execute({getState:t,dispatch:n},r){const a=e.get_FCBContext(),o=Object.assign({},a),l=Object(c.d)(t()),u=i.list;for(const e of u)if(a&&void 0===a[e.name]){const t=l&&e.valueByCdsCapabilityMode&&e.valueByCdsCapabilityMode[l],n=Object(s.a)(t)?e.value:t;o[e.name]=n}const d=Object.keys(o).filter(e=>o[e]);r.EventManager.ReportComponentSuccess("FCB",[{name:"FCB",value:JSON.stringify(d)}]),f(t(),o),n(g(o))}}}function p(){return{type:"featureControlManager.URLFCBOverrides",sync:!0,execute({getState:e,dispatch:t}){const n={};f(e(),n),function(e){const t=i.list;for(const n of t)u.includes(n.name)&&void 0===e[n.name]&&(e[n.name]=n.value)}(n),t(g(n))}}}function f(e,t){const n=Object(o.b)(e);if(n)for(const e in n){t[e.trim().substring(4)]=n[e]}}function g(e){return{type:l,payload:{clientFCBs:e}}}},"B/QL":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("SAYH"),a=n("ml6Y"),i=n("yRo8");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const o={[a.a.MaxTimeKey]:1,[a.a.ClientVersionKey]:1,[a.a.OfflineProfileDataKey]:4,[a.a.OfflineEntityPluralNamesKey]:4,[a.a.offlineDatabaseInformationKey]:4,[a.a.isMobileOfflineOptedInKey]:4,[a.a.isMobileOfflineOptedOutKey]:4,[a.a.OfflineDisabledInfoKey]:4,[a.a.LastSuccessfulSaveOnCrmKey]:4,[a.a.OfflinePrimaryAvailableEntitiesKey]:4,[a.a.IsFirstApplicationMetadataDownloadConfirmationDoneKey]:4,[a.a.OfflineApplyApplicationMetadataChangesKey]:4,[a.a.IsFirstApplyApplicationMetadataChangesDoneKey]:4,[a.a.SyncErrorFailureMapKey]:6,[a.a.OfflineMetatdataSyncStatusKey]:6,[a.a.IsFirstTimeDataSyncCompletedKey]:4,[a.a.IsFirstTimeMetadataValidationCompletedKey]:4,[a.a.IsOfflineFirstTimeSyncCompletedKey]:4,[i.c]:4,[i.d]:4,[i.a]:4,[a.a.IsOfflineUpgradeDoneKey]:2,[a.a.IsUserSelectOffline]:2,[a.a.OfflineDatabaseKey]:2};function s(e,t,n){if(-1===Object.keys(o).indexOf(e))return e;let a=e;return 1&o[e]&&(a=e),2&o[e]&&t&&t!==r.a.EMPTY.guid&&(a+="_"+t),4&o[e]&&n&&n!==r.a.EMPTY.guid&&(a+="_"+n),a}},B3HF:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"f",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"g",(function(){return l})),n.d(t,"k",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"h",(function(){return p})),n.d(t,"l",(function(){return f})),n.d(t,"d",(function(){return g})),n.d(t,"i",(function(){return h})),n.d(t,"m",(function(){return m})),n.d(t,"e",(function(){return b})),n.d(t,"j",(function(){return y}));var r=n("IaGr"),a=n("mpSO");function i(e,t){if(e+=".getEventManager",t.ScriptManager.containerExists(a.e))return t.GlobalCustomEventManager;const n=[];return n.push({name:"ContainerId",value:a.e}),r.a.getInstance().eventManager.ReportComponentFailure(e,new Error("Container does not exist"),null,n),null}function o(e){return{type:"eventManager.addOnBeforeLoad",sync:!0,execute({dispatch:t,getState:n},r){const a=i("ClientApi.addBeforeOnLoad",r);a&&a.addBeforeOnLoad(e)}}}function s(e){return{type:"eventManager.removeOnBeforeLoad",sync:!0,execute:({dispatch:t,getState:n},r)=>{const a=i("ClientApi.removeBeforeOnLoad",r);a&&a.removeBeforeOnLoad(e)}}}function c(e){return{type:"eventManager.addOnOpenURL",sync:!0,execute({dispatch:t,getState:n},r){const a=i("ClientApi.addOnOpenUrl",r);a&&a.addOnOpenUrl(e)}}}function l(e){return{type:"eventManager.removeOnOpenUrl",sync:!0,execute({dispatch:t,getState:n},r){const a=i("ClientApi.removeOnOpenUrl",r);a&&a.removeOnOpenUrl(e)}}}function u(e,t,n){return{type:"eventManager.runPanelOnMessageReceived",sync:!0,execute({dispatch:r,getState:a},o){const s=i("ClientApi.runPanelOnMessageReceived",o);s&&r(s.runPanelOnMessageReceived(e,t,n))}}}function d(e,t){return{type:"eventManager.addPanelOnMessageReceived",sync:!0,execute({dispatch:n,getState:r},a){const o=i("ClientApi.addPanelOnMessageReceived",a);o&&o.addPanelOnMessageReceived(e,t)}}}function p(e,t){return{type:"eventManager.removePanelOnMessageReceived",sync:!0,execute({dispatch:n,getState:r},a){const o=i("ClientApi.removePanelOnMessageReceived",a);o&&o.removePanelOnMessageReceived(e,t)}}}function f(e,t){return{type:"eventManager.runPanelOnSizeChange",sync:!0,execute({dispatch:n,getState:r},a){const o=i("ClientApi.runPanelOnSizeChange",a);o&&n(o.runPanelOnSizeChange(e,t))}}}function g(e,t){return{type:"eventManager.addPanelOnSizeChange",sync:!0,execute({dispatch:n,getState:r},a){const o=i("ClientApi.addPanelOnSizeChange",a);o&&o.addPanelOnSizeChange(e,t)}}}function h(e,t){return{type:"eventManager.removePanelOnSizeChange",sync:!0,execute({dispatch:n,getState:r},a){const o=i("ClientApi.removePanelOnSizeChange",a);o&&o.removePanelOnSizeChange(e,t)}}}function m(e,t){return{type:"eventManager.runPanelOnStateChange",sync:!0,execute({dispatch:n,getState:r},a){const o=i("ClientApi.runPanelOnStateChange",a);o&&n(o.runPanelOnStateChange(e,t))}}}function b(e,t){return{type:"eventManager.addPanelOnStateChange",sync:!0,execute({dispatch:n,getState:r},a){const o=i("ClientApi.addPanelOnStateChange",a);o&&o.addPanelOnStateChange(e,t)}}}function y(e,t){return{type:"eventManager.removePanelOnStateChange",sync:!0,execute({dispatch:n,getState:r},a){const o=i("ClientApi.removePanelOnStateChange",a);o&&o.removePanelOnStateChange(e,t)}}}},B65h:function(e,t,n){"use strict";var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.timelineToCsv=t.timelineToFullDataJson=t.timelineToSerializable=t.timelineDataFromJson=t.doTimespansOverlap=t.PerformanceTimeline=void 0;var a=n("zI6t"),i=n("5ylf"),o=function(){function e(e,t,n){void 0===e&&(e=null),void 0===t&&(t=null),void 0===n&&(n=!1),this._events=e||[],this._metadata=t,!n&&this._finalize()}return e.prototype.getMetadata=function(){return this._metadata},e.prototype.setMetadata=function(e){this._metadata=e},e.prototype.setTags=function(e){this._tags=e},e.prototype.getTags=function(){return this._tags},e.prototype.getName=function(){var e,t;if(this._tags&&this._tags.length>0)return this._tags.join(", ");var n=this.getKeyPerformanceIndicators();if(n.length>0)return n[n.length-1].name;var a=null,i=0,o=0;try{for(var s=r(this._events),c=s.next();!c.done;c=s.next()){var l=c.value;if(l.timeEnd){var u="Core.Actions.Async"===l.zone?3:"Core.Actions.Sync"===l.zone?2:1,d=l.timeEnd-l.time;u>=o&&d>i&&(o=u,i=d,a=l)}}}catch(t){e={error:t}}finally{try{c&&!c.done&&(t=s.return)&&t.call(s)}finally{if(e)throw e.error}}return a?a.name:"Untitled timeline"},e.prototype.getStartTime=function(){return 0===this._events.length?0:this._events[0].time},e.prototype.getDuration=function(){if(0===this._events.length)return 0;var e=this._events[0].time,t=this._events[this._events.length-1];return(t.timeEnd||t.time)-e},e.prototype.getKeyPerformanceIndicators=function(){var e=this._events.find((function(e){return e.name===a.WORK_START_EVENT_NAME})),t=e?e.time:0;return this._events.filter((function(e){return e.zone===a.KPI_ZONE})).map((function(e){var n=e.time;return e.parameters&&e.parameters.value?n=e.parameters.value:n-=t,{name:e.name,value:n}})).sort((function(e,t){return e.name<t.name?-1:e.name>t.name?1:0}))},e.prototype.getEvents=function(){return this._events},e.prototype.filter=function(t){return new e(this._events.filter(t),this._metadata,!0)},e.prototype.getNetworkRequests=function(){return this.getEvents().reduce((function(e,t){return t.zone===i.NETWORK_REQUEST_EVENT_NAME&&e.push(t),e}),[])},e.prototype.getTimelineForTimespan=function(e,t){return this.filter((function(n){return s(n.time,n.timeEnd,e,t)}))},e.prototype._finalize=function(){if(0!==this._events.length){this._events=this._events.sort((function(e,t){return e.time<=t.time?-1:1}));var e=this.getStartTime();this._events=this._events.map((function(t){return Object.assign({},t,{time:t.time-e,timeEnd:null!=t.timeEnd?t.timeEnd-e:void 0})}))}},e}();function s(e,t,n,r){return e>=n&&e<=r||t&&t>=n&&t<=r||e<=n&&t&&t>=r}function c(e){return{events:e.getEvents(),metadata:e.getMetadata(),tags:e.getTags()}}t.PerformanceTimeline=o,t.doTimespansOverlap=s,t.timelineDataFromJson=function(e){var t=JSON.parse(e),n=new o(t.timeline.events,t.timeline.metadata);return n.setTags(t.tags),{timeline:n,keyPerformanceIndicators:t.keyPerformanceIndicators,issues:t.issues}},t.timelineToSerializable=c,t.timelineToFullDataJson=function(e,t){return JSON.stringify({timeline:c(e),keyPerformanceIndicators:e.getKeyPerformanceIndicators(),issues:t})},t.timelineToCsv=function(e){return e.getEvents().reduce((function(e,t){return e+(t.zone+", ")+t.name+", "+t.time+", "+t.timeEnd+", "+JSON.stringify(t.parameters)+"\n"}),"Zone, Name, Start time, End time, Parameters\n")}},BDhr:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return o}));var r=n("eXjw");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e){return e&&e.metadata&&e.metadata.metadataVersion?e.metadata.metadataVersion:null}function i(e){const t=a(e);return t?t.initialized:r.a.Uninitialized}function o(e){var t;return null===(t=a(e))||void 0===t?void 0:t.currentVersion}},BFlg:function(e,t,n){"use strict";n.d(t,"K",(function(){return r})),n.d(t,"T",(function(){return a})),n.d(t,"w",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"u",(function(){return s})),n.d(t,"E",(function(){return c})),n.d(t,"S",(function(){return l})),n.d(t,"D",(function(){return u})),n.d(t,"C",(function(){return d})),n.d(t,"y",(function(){return p})),n.d(t,"I",(function(){return f})),n.d(t,"s",(function(){return g})),n.d(t,"v",(function(){return h})),n.d(t,"j",(function(){return m})),n.d(t,"r",(function(){return b})),n.d(t,"J",(function(){return y})),n.d(t,"q",(function(){return _})),n.d(t,"p",(function(){return v})),n.d(t,"F",(function(){return S})),n.d(t,"G",(function(){return O})),n.d(t,"c",(function(){return C})),n.d(t,"U",(function(){return E})),n.d(t,"k",(function(){return I})),n.d(t,"l",(function(){return w})),n.d(t,"m",(function(){return j})),n.d(t,"B",(function(){return P})),n.d(t,"A",(function(){return T})),n.d(t,"N",(function(){return N})),n.d(t,"P",(function(){return A})),n.d(t,"O",(function(){return R})),n.d(t,"L",(function(){return D})),n.d(t,"M",(function(){return x})),n.d(t,"Q",(function(){return M})),n.d(t,"g",(function(){return F})),n.d(t,"h",(function(){return k})),n.d(t,"i",(function(){return L})),n.d(t,"f",(function(){return B})),n.d(t,"e",(function(){return U})),n.d(t,"H",(function(){return V})),n.d(t,"t",(function(){return z})),n.d(t,"n",(function(){return q})),n.d(t,"x",(function(){return H})),n.d(t,"z",(function(){return W})),n.d(t,"a",(function(){return G})),n.d(t,"b",(function(){return K})),n.d(t,"R",(function(){return Q})),n.d(t,"o",(function(){return X})),n.d(t,"W",(function(){return Y})),n.d(t,"V",(function(){return J})),n.d(t,"X",(function(){return $}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="TargetEntityType",a="ViewId",i="homepageGrid",o="MscrmControls.Chart.ChartControl",s="MscrmControls.Grid.GridControl",c="RecordsPerPage",l="ViewIds",u="MscrmControls.Grid.ReadOnlyGrid",d="MscrmControls.Grid.PCFGridControl",p="Microsoft.PowerApps.PowerAppsOneGrid",f="MscrmControls.SharepointAssociatedGrid.SharepointControl",g="fetchXML",h="GridFilterType",m="DataSetContextKey",b="entityLogicalName",y="subgrid",_="EnableViewPicker",v="EnableItemContextualActions",S="RelationshipName",O="RelationshipRoleOrdinal",C="AvailableOnPhone",E="ViewSelector",I="DataSetUIOptions",w="Grid",j="Items",P="ColumnMoving",T="AutoHeight",N="Grid",A="Grid",R="SubGrid",D="AssociatedGrid",x="ExpressionBuilder",M="MainPageViewSelector",F="ClickSaveAsNewViewCommand",k="ClickSaveChangesToCurrentViewCommand",L="ClickSetDefaultViewCommand",B="ClickResetDefaultViewCommand",U="ClickManageAndShareViewsCommand",V="SelectAView",z="FocusSearchBox",q="DisplayInfoIconTooltip",H="NumberOfUserAndSystemViewsRendered",W="OpenMainPageViewSelector",G="activitypointer",K="activitytypecode",Q="transactioncurrencyidforcurrencyfield",X={GRID:"grid",SUBGRID:"subgrid",ASSOCIATEDGRID:"associatedgrid",CUSTOM:"custom"},Y={ENABLE_VIEW_PICKER:_,ENABLE_CONTEXTUALACTIONS:"EnableContextualActions",ENABLE_JUMPBAR:"EnableJumpBar",ENABLE_QUICKFIND:"EnableQuickFind",ENABLE_QUEUEFILTER:"EnableQueueFilter",ENABLE_CHART_PICKER:"EnableChartPicker",RELATIONSHIP_NAME:S,AVAILABLE_ON_PHONE:C,TARGET_ENTITY_TYPE:r},J={CHART_ENABLED:"displayChart",COMMANDBAR_ENABLED:"displayCommandBar",VIEWSELECTOR_ENABLED:"displayViewSelector",JUMPBAR_ENABLED:"displayIndex",QUICKFIND_ENABLED:"displayQuickFind",PAGING_ENABLED:"displayPaging"};function $(e,t){return N+"."+e+"."+t}},BHBs:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("Z1+9"),a={account:"crmSymbolFont entity-symbol Account",activitypointer:"crmSymbolFont entity-symbol Activitypointer",appointment:"crmSymbolFont entity-symbol Appointment",article:"symbolFont Article-symbol",businessunit:"crmSymbolFont entity-symbol BusinessUnit",campaign:"crmSymbolFont entity-symbol Campaign",campaignresolution:"symbolFont CampaignResolution-symbol",case:"symbolFont Case-symbol",caseresolution:"symbolFont CaseResolution-symbol",chat:"symbolFont Chat-symbol",competitor:"crmSymbolFont entity-symbol Competitor",connection:"crmSymbolFont entity-symbol Connection",contact:"crmSymbolFont entity-symbol Contact",contract:"crmSymbolFont entity-symbol Contract",createquote:"symbolFont CreateQuote-symbol",customactivity:"symbolFont CustomActivity-symbol",customeraddress:"crmSymbolFont entity-symbol CustomerAddress",dashboard:"crmSymbolFont entity-symbol Dashboard",distributionList:"symbolFont DistributionList-symbol",documenttemplates:"symbolFont DocumentTemplates-symbol",email:"crmSymbolFont entity-symbol Email",externalUser:"symbolFont GuestUser-symbol",fax:"crmSymbolFont entity-symbol Fax",goal:"crmSymbolFont entity-symbol Goal",guestUser:"symbolFont GuestUser-symbol",incident:"crmSymbolFont entity-symbol Incident",invoice:"crmSymbolFont entity-symbol Invoice",knowledgearticle:"crmSymbolFont entity-symbol Knowledgearticle",lead:"crmSymbolFont entity-symbol Lead",letter:"crmSymbolFont entity-symbol Letter",mail:"symbolFont Mail-symbol",membersicon:"symbolFont MembersIcon-symbol",metric:"crmSymbolFont entity-symbol Metric",opportunity:"crmSymbolFont entity-symbol Opportunity",opportunityproduct:"crmSymbolFont entity-symbol Opportunityproduct",phone:"symbolFont Phone-symbol",phonecall:"crmSymbolFont entity-symbol Phonecall",position:"crmSymbolFont entity-symbol Position",product:"crmSymbolFont entity-symbol Product",queueicon:"symbolFont QueueIcon-symbol",queueitem:"crmSymbolFont entity-symbol Queueitem",queueitemroute:"symbolFont QueueItemRoute-symbol",quote:"crmSymbolFont entity-symbol Quote",report:"crmSymbolFont entity-symbol Report",resolvecase:"symbolFont ResolveCase-symbol",salesliterature:"crmSymbolFont entity-symbol SalesLiterature",salesorder:"crmSymbolFont entity-symbol Salesorder",serviceactivity:"symbolFont ServiceActivity-symbol",sharepointdocument:"crmSymbolFont entity-symbol Sharepointdocument",socialprofile:"crmSymbolFont entity-symbol Socialprofile",systemuser:"crmSymbolFont entity-symbol Systemuser",task:"crmSymbolFont entity-symbol Task",team:"crmSymbolFont entity-symbol Team",transactioncurrency:"crmSymbolFont entity-symbol TransactionCurrency",user:"symbolFont GuestUser-symbol",wordtemplates:"symbolFont WordTemplates-symbol",msdyusd_task:"crmSymbolFont entity-symbol msdyusd_task-symbol",msdyusd_configuration:"crmSymbolFont entity-symbol msdyusd_configuration-symbol",msdyusd_customizationfiles:"crmSymbolFont entity-symbol msdyusd_customizationfiles-symbol",msdyusd_entitysearch:"crmSymbolFont entity-symbol msdyusd_entitysearch-symbol",msdyusd_uiievent:"crmSymbolFont entity-symbol msdyusd_uiievent-symbol",msdyusd_form:"crmSymbolFont entity-symbol msdyusd_form-symbol",uii_option:"crmSymbolFont entity-symbol uii_option-symbol",uii_hostedapplication:"crmSymbolFont entity-symbol uii_hostedapplication-symbol",msdyusd_scriptlet:"crmSymbolFont entity-symbol msdyusd_scriptlet-symbol",msdyusd_toolbarstrip:"crmSymbolFont entity-symbol msdyusd_toolbarstrip-symbol",msdyusd_usersettings:"crmSymbolFont entity-symbol msdyusd_usersettings-symbol",msdyusd_agentscriptaction:"crmSymbolFont entity-symbol msdyusd_agentscriptaction-symbol",msdyusd_auditanddiagnosticssetting:"crmSymbolFont entity-symbol msdyusd_auditanddiagnosticssetting-symbol",msdyusd_sessioninformation:"crmSymbolFont entity-symbol msdyusd_sessioninformation-symbol",msdyusd_windowroute:"crmSymbolFont entity-symbol msdyusd_windowroute-symbol",customentity:"symbolFont CustomEntity-symbol",default:"symbolFont CustomEntity-symbol",unresolvedaddress:"symbolFont InformationIcon-symbol",recurringappointmentmaster:"symbolFont NewRecurringAppointment-symbol",service:"crmSymbolFont entity-symbol Service",serviceappointment:"crmSymbolFont entity-symbol ServiceAppointment",equipment:"crmSymbolFont entity-symbol Equipment",pricelevel:"crmSymbolFont entity-symbol PriceLevel",goalrollupquery:"crmSymbolFont entity-symbol GoalRollUpQuery",uomschedule:"crmSymbolFont entity-symbol UoMSchedule",discounttype:"crmSymbolFont entity-symbol DiscountType",territory:"crmSymbolFont entity-symbol Territory",socialactivity:"crmSymbolFont entity-symbol Socialactivity",calendar:"crmSymbolFont entity-symbol Calendar",category:"crmSymbolFont entity-symbol Category",entitlement:"crmSymbolFont entity-symbol Entitlement",queue:"crmSymbolFont entity-symbol Queue",routingrule:"crmSymbolFont entity-symbol RoutingRule",routingruleitem:"crmSymbolFont entity-symbol RoutingRuleItem",msdyn_knowledgearticletemplate:"crmSymbolFont entity-symbol msdyn_knowledgearticletemplate",msdyn_servicelevelagreement:"crmSymbolFont entity-symbol msdyn_servicelevelagreement",msdyn_servicelevelagreementkpi:"crmSymbolFont entity-symbol msdyn_servicelevelagreementkpi",msdyn_servicelevelagreementinstance:"crmSymbolFont entity-symbol msdyn_servicelevelagreementinstance",Code:"crmSymbolFont entity-symbol Code",GroupList:"crmSymbolFont entity-symbol GroupList",CompletedSolid:"crmSymbolFont entity-symbol CompletedSolid",WarningSolid:"crmSymbolFont entity-symbol WarningSolid",site:"crmSymbolFont entity-symbol Site"};var i,o=n("ghc6"),s=n("8aze"),c=(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return c(t,e),t.prototype.getSymbolClassName=function(e){return function(e){return a[e]?a[e]:a.default}(e)},t}(r.a),u=o.a(s.b)(l)},BHck:function(e,t,n){"use strict";function r(e){return e&&e.metadata&&e.metadata.landingPageOfflineMetadata&&e.metadata.landingPageOfflineMetadata.offlineAppDescriptors?e.metadata.landingPageOfflineMetadata.offlineAppDescriptors:null}function a(e){return e&&e.metadata&&e.metadata.landingPageOfflineMetadata?e.metadata.landingPageOfflineMetadata:null}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}))},BJ7u:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e){switch(e){case-1:return"None";case 0:return"AppointmentBook";case 1:return"Hardcoded";case 2:return"Main";case 3:return"MiniCampaignBO";case 4:return"Preview";case 5:return"Dashboard";case 6:return"Quick";case 7:return"Mobile";case 8:return"Read";case 9:return"QuickCreate";case 10:return"Dialog";case 11:return"Card";case 12:return"TaskBasedForm";case 13:return"InteractionCentricDashboard"}}n.d(t,"a",(function(){return r}))},BM7Q:function(e,t,n){"use strict";n.d(t,"f",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"g",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"e",(function(){return c})),n.d(t,"d",(function(){return l}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="Web.NavBar.Preview_Watermark_Caption",a="Brand_China_Mooncake_English",i="Web.NavBar.Sandbox_Watermark_Caption",o="Change_App_ToolTip",s="App_Modules_SubArea_Title",c="Skip_To_Main_Content_Label",l=[r,i,o,s,c]},BMZr:function(e,t,n){"use strict";n.d(t,"a",(function(){return O}));var r=n("SAYH"),a=n("9wih"),i=n("ruPX"),o=n("zu1I"),s=n("FZDd"),c=n("N6mg"),l=n("GYEz"),u=n("w1eR"),d=n("cfbi"),p=n("A09F"),f=n("i1f0"),g=n("YxC/"),h=n("1fn7"),m=n("nzu+"),b=n("E8F2"),y=n("xHmU"),_=n("pEXn"),v=n("+Qpx");var S=n("wL2W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function O(e,t,n,g,h,m,b){const y=[{name:"entityTypeName",value:e}];return null!=h&&r.a.isNullOrEmpty(h.id)&&y.push({name:"createFromEntityID",value:h.id.guid}),{type:"form.openCreateFormDialog.async",execute({dispatch:O,getState:E},I,w){let j=E();return O(Object(c.a)()).then(c=>{let P;if(c&&c.quickCreateMenuItems)for(const t in c.quickCreateMenuItems)if(t===e){P=O(Object(s.f)(e,!1,[]));break}const T=()=>{j=E();const s=b?b.relationship:null,c=b?r.a.tryParseOrNull(b.formId):null,P=b?b.lookupAttributeName:null,T=Object(f.L)(j,e),N=null==T?void 0:T.mode;return Object(S.a)()&&O(function(e,t){return{type:"formChecker.FormType.async",async execute({},n){var r;const a=null===(r=null==n?void 0:n.TraceManager)||void 0===r?void 0:r.getTracer(`${v.u}${v.x}`);if(a&&e.mode!==p.a.QuickCreateForm){if(e){let n;switch(e.mode){case p.a.MainFormDialog:n="Main Form Dialog";break;case p.a.EditForm:n="Edit Form"}const r={"Form Type":n,"Entity Name":t,"Reason(s) why a Quick Create Menu Item is not opened":e.reason};r&&a.warn(v.B,[{name:_.l,value:v.x},{name:v.x,value:JSON.stringify(r)}])}await Promise.resolve()}}}}(T,e)),N===p.a.QuickCreateForm?(y.push({name:"createType",value:"QuickCreate"}),h&&(y.push({name:"createFromEntity",value:h.etn}),b&&b.isCrossEntityNavigate&&(g&&g.processId&&(g.processId=r.a.EMPTY.guid),g&&g.processInstanceId&&(g.processInstanceId=null))),function(e,t,n,r,i,s,c,l,u,d,p,f){return C(e,t,!1,s).then(g=>{if(0===g.status){const g=function(e,t,n,r,a,i,s,c){const l=Object(o.a)(null,e,n,r,t);return l.createFromEntity=a,l.createFromRelationship=i,l.formId=s,l.lookupAttributeName=c,l}(t,i,c,l,u,d,p,f);return e(Object(a.a)(g,s)).then(e=>{const t=[{name:"CorrelationId",value:r.correlationId},{name:"ContextId",value:r.contextId},{name:"ActionStack",value:r.stack},{name:"entityTypeName",value:i}];return n.EventManager.ReportComponentSuccess("Forms.openCreateFormDialog._openQuickCreate",t),e})}return g})}(O,j,I,w,e,t,n,g,h,s,c,P)):N===p.a.MainFormDialog?(y.push({name:"createType",value:"MainFormDialog"}),function(e,t,n,r,a,o,s,c,l,u,p,f){return C(e,t,!0,o).then(t=>{if(0===t.status){const t={entityTypeName:a,data:c,formId:p,initWithEntity:l,dialogOptions:s,lookupAttributeName:f},u={target:"dialog"};return e(Object(i.a)(d.b,t,o,u)).then(e=>{const t=[{name:"CorrelationId",value:r.correlationId},{name:"ContextId",value:r.contextId},{name:"ActionStack",value:r.stack},{name:"openInNewWindow",value:!1},{name:"entityTypeName",value:a}];return n.EventManager.ReportComponentSuccess("Forms.openCreateFormDialog._openMainFormDialog",t),e})}return t})}(O,j,I,w,e,t,n,g,h,0,c,P)):(y.push({name:"createType",value:"EditForm"}),function(e,t,n,r,a,o,s,c,p,f,g){const h=s,m={entityTypeName:a,id:null,data:h&&0!==Object.keys(h).length?h:null,initWithEntity:c,createFromRelationship:p},b=Object(l.a)(t);if(f||g&&b!==u.a.MobileApplication){const t=e(Object(i.c)("EditForm",m,f)),o=[{name:"CorrelationId",value:r.correlationId},{name:"ContextId",value:r.contextId},{name:"ActionStack",value:r.stack},{name:"target",value:JSON.stringify(f)},{name:"clientHost",value:JSON.stringify(b)},{name:"openInNewWindow",value:g},{name:"entityTypeName",value:a}];return n.EventManager.ReportComponentSuccess("Forms.openCreateFormDialog._openEditForm",o),Promise.resolve(t)}return function(e,t,n,r,a,o,s,c,l,u){return e(Object(i.a)(a,o,l)).then(e=>{const t=[{name:"CorrelationId",value:r.correlationId},{name:"ContextId",value:r.contextId},{name:"ActionStack",value:r.stack},{name:"target",value:JSON.stringify(u)},{name:"openInNewWindow",value:!1},{name:"clientHost",value:JSON.stringify(s)},{name:"entityTypeName",value:c}];return n.EventManager.ReportComponentSuccess(a===d.b?"Forms.openCreateFormDialog._openEditForm":"Forms.openCreateFormDialog._openMainFormDialog",t),e})}(e,0,n,r,d.b,m,b,a,o,f)}(O,j,I,w,e,t,g,h,s,m,n?n.openInNewWindow:void 0))};return P?(y.push({name:"isPromiseValid",value:!0}),P.then(T)):(y.push({name:"isPromiseValid",value:!1}),T())})},getFailureParameters:(e,t)=>y}}function C(e,t,n,r){const a=Object(y.a)(t),i=a?a.filter(e=>n?Object(f.Ob)(t,e):Object(f.Qb)(t,e)):[];if(n&&i.length>=3||!n&&i.length>=10){const n=Object(g.b)(t,h.h),a=Object(g.b)(t,h.g);return e(Object(m.a)({title:n,text:a},{height:210},r)).then(e=>({status:1,error:Object(b.b)(t,r,2147946838,a)}))}return Promise.resolve({status:0})}},BR3n:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="InteractionCentricNavBar_QuickCreate_Activities",a=[r,"Web.NavBar.Back_Caption"]},BSGX:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("OwbH");class a extends r.a{constructor(e,t){super([e]),this._target=null,this._target=t}get_fieldValue(){return this._target}testCondition(e){return e===this.get_fieldValue()}}},BSqk:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n("ufH1"),a=n("umme"),i=n("504W"),o=n("2mBq"),s=n("Div0"),c=n("/oKV");class l{constructor(){this._promiseCache={}}get_values(){const e=new Array(0),t=this._promiseCache;for(const n in t){const r={key:n,value:t[n]};e.push(r.value)}return e}put(e,t,n){const c="Operation timed out. Cache name : "+t.getCacheName(),l="Operation timed out. Key = "+e+"; ContextString = "+t.getContextString(),u=window.setTimeout(()=>{Object(r.e)("PromiseCache_Put_promiseCacheObject_Always",s.a.storage,Object(o.a)("Get cache object with key={0} timed out. promiseCacheObject.ContextString is={1}",e,t.getContextString()));const u=a.a.FromMessage(c);Object(i.a)(n)||Object(i.a)(n.get_Stack())||u.set_Stack(n.get_Stack()),u.set_InnerError(a.a.FromMessage(l)),t.getPromise().reject(u)},3e5);this._promiseCache[e]=t,t.getPromise().always(()=>{const t=this.get(e);Object(i.a)(t)?Object(r.c)("PromiseCache_Put_promiseCacheObject_Always",s.a.storage,Object(o.a)("Get cache object with key={0}, value is undefined.",e)):delete this._promiseCache[e],window.clearTimeout(u)})}get(e){return this._promiseCache[e]}containsKey(e){return e in this._promiseCache}rejectRemotePromises(){const e=this.get_values();for(const t in e){const n=e[t];if("GetClientMetadata"!==n.getCacheName()||n.getRetrievalStrategy()!==c.a.LocalAndRemote&&n.getRetrievalStrategy()!==c.a.Remote){if(n.getRetrievalStrategy()===c.a.LocalAndRemote||n.getRetrievalStrategy()===c.a.Remote){const e=a.a.fromErrorCode(-2147093999);n.getPromise().reject(e)}}else{const e=a.a.fromErrorCodeAndMessage(12163,"Retry this error");n.getPromise().reject(e)}}}}},BfRu:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="add.pageNotificationAction";function a(e,t){return{type:"add.pageNotificationAction.async",execute({dispatch:n}){const a={type:r,payload:e,meta:{pageId:t}};return Promise.resolve(n(a))}}}},BgaZ:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("wRZP"),a=n("EY5k"),i=n("YxC/"),o=n("tICD"),s=n("pgSX"),c=n("si7p");let l=!1;function u(e){const t=["AppModule.AccessDenied_Title","AppModule.AccessDenied_Message"];return e.dispatch(Object(a.e)(t)).then(()=>{if(l)return{status:0};l=!0;const n=Object(i.e)(e.getState(),t),a=Object(i.c)(n,"AppModule.AccessDenied_Message"),u=Object(i.c)(n,"AppModule.AccessDenied_Title");return e.dispatch(Object(s.a)(c.a,a,{height:"16rem",width:"40rem",type:"error"},"",u)).then(t=>0===t.status?e.dispatch(Object(o.a)(t.pageId)).then(()=>(l=!1,e.dispatch(Object(r.a)()))):(l=!1,t)).catch(e=>{throw l=!1,e})})}},Bl5B:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e){return e.metadata.rootCanvasApp}function a(e){var t;return null===(t=r(e))||void 0===t?void 0:t.dataComponentApp}function i(e){var t;return null===(t=r(e))||void 0===t?void 0:t.functionalComponentApp}function o(e){var t;return null===(t=a(e))||void 0===t?void 0:t.name}function s(e){var t;return null===(t=a(e))||void 0===t?void 0:t.appMetadata}function c(e){var t;return null===(t=i(e))||void 0===t?void 0:t.name}function l(e){var t;return null===(t=i(e))||void 0===t?void 0:t.functionalComponentLibraries}function u(e){var t;return null===(t=a(e))||void 0===t?void 0:t.dependencyInfo}function d(e,t){var n;return null===(n=u(e))||void 0===n?void 0:n[t]}function p(e,t){var n,r;return null===(r=null===(n=i(e))||void 0===n?void 0:n.functionalComponentLibraries)||void 0===r?void 0:r[t]}function f(e,t){var n,r;return null===(r=null===(n=i(e))||void 0===n?void 0:n.functionalComponentLibraries)||void 0===r?void 0:r[t].logicalName}function g(e,t){var n;return null===(n=p(e,t))||void 0===n?void 0:n.expressionRuntimeScript}function h(e,t){var n;return null===(n=p(e,t))||void 0===n?void 0:n.initScript}function m(e,t,n,r){var a,i,o,s;const c=p(e,t);return null===(s=null===(o=null===(i=null===(a=null==c?void 0:c.components)||void 0===a?void 0:a[n])||void 0===i?void 0:i.dependencies)||void 0===o?void 0:o.functionDependencies)||void 0===s?void 0:s[r]}function b(e,t,n){var r,a;const i=p(e,t),o=null===(a=null===(r=null==i?void 0:i.components)||void 0===r?void 0:r[n])||void 0===a?void 0:a.dependencies.functionDependencies;return o?Object.keys(o):[]}function y(e,t,n){var r,a;const i=p(e,t);return null===(a=null===(r=null==i?void 0:i.components)||void 0===r?void 0:r[n])||void 0===a?void 0:a.scriptURL}function _(e){var t;return!!(null===(t=a(e))||void 0===t?void 0:t.expressionRuntimeInitialized)}n.d(t,"h",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"i",(function(){return c})),n.d(t,"j",(function(){return l})),n.d(t,"d",(function(){return u})),n.d(t,"e",(function(){return d})),n.d(t,"k",(function(){return f})),n.d(t,"g",(function(){return g})),n.d(t,"l",(function(){return h})),n.d(t,"f",(function(){return m})),n.d(t,"a",(function(){return b})),n.d(t,"m",(function(){return y})),n.d(t,"n",(function(){return _}))},BlGn:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("RIJJ"),a=n("ruPX");function i(e,t,n,i){const o=[{name:"url",value:e}];return{type:"form.openLegacyDialog",execute:({dispatch:o,getState:s})=>o(
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t,n,i){const o={url:e,dialogOptions:t,dialogArguments:n};return Object(a.a)(r.a,o,i)}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(e,t,n,i)),getFailureParameters:(e,t)=>o}}},Bo7t:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="form.tab.select";function i(e,t,n){const i=Object(r.w)(t);return{type:a,payload:n,meta:{pageId:e,contextKey:i}}}},BoVI:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"f",(function(){return o})),n.d(t,"g",(function(){return a})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return c})),n.d(t,"e",(function(){return l}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="form.registerFormInstance",a="form.unregisterFormInstance",i="control.views.addCustomView",o="control.views.setOfflineQuery",s="form.registerParentComponentId",c="control.initializationIntent",l="form.setFormScrollAndFocusState"},Brg7:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("69Qu");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a={};function i(e){return{type:"loadimages.async",execute({getState:t},n){const i=n.TraceManager.getTracer("loadimages");if(Object(r.b)(t())){const n=(e(t(),i)||[]).map((function(e){const t=a[e.iconPath];if(t)return t;const n=new Promise((t,n)=>{const r=new Image;r.onload=t,r.onerror=n,r.src=e.iconPath});return n.then(t=>{a[e.iconPath]=n},t=>{i.error("Cannot load image with path "+e.iconPath+" for "+e.type+" "+e.id,[{name:"reason",value:t}])})}));return Promise.all(n)}return i.info("Cannot load images in offline"),Promise.resolve()}}}},BvQu:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.Dirty=0]="Dirty",e[e.Always=1]="Always",e[e.Never=2]="Never"}(r||(r={}))},BzGi:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.savedvisualization=0]="savedvisualization",e[e.uservisualization=1]="uservisualization"}(r||(r={}))},BzKn:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return u}));var r=n("zVFX");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var a=n("NjDY"),i=n("SocB"),o=n("GYEz"),s=n("w1eR"),c=n("CXmn");const l="theme.initialize";function u(e){const t=Object(o.a)(e),n=r.a,u=Object(a.e)(e),g=Object(c.c)(e);if(""!==u){const t=function(e){const t=(new DOMParser).parseFromString(e,"text/xml"),n=t.getElementsByTagName("theme")[0].childNodes,r={};for(let e=0;e<n.length;e++)r[n[e].nodeName]=n[e].childNodes[0]?n[e].childNodes[0].nodeValue:"";return r.themeId=t.getElementsByTagName("theme")[0].getAttribute("themeId"),r}(u);t&&(n.colors.Link.Normal.Text=d(t.globallinkcolor,n.colors.Link.Normal.Text),n.colors.Link.Visited.Text=d(t.selectedlinkeffect,n.colors.Link.Visited.Text),n.colors.Link.Hover.Text=d(t.hoverlinkeffect,n.colors.Link.Hover.Text),n.colors.Title.Text=d(t.headercolor,n.colors.Title.Text),n.colors.ProcessControl=d(t.processcontrolcolor,n.colors.ProcessControl),n.colors.SiteMap.GroupText=f(t.maincolor,n.colors.SiteMap.GroupText,n.colors.SiteMap.Default,n.colors.BaseColor.White),n.colors.SiteMap.AppLauncherBorder=f(t.maincolor,n.colors.SiteMap.AppLauncherBorder,n.colors.SiteMap.Default,n.colors.BaseColor.White),n.colors.SiteMap.AreaItemBorder=f(t.maincolor,n.colors.SiteMap.AreaItemBorder,n.colors.SiteMap.Default,n.colors.BaseColor.White),n.colors.QuickLaunchBarButtonBorderColor=f(t.maincolor,n.colors.QuickLaunchBarButtonBorderColor,n.colors.QuickLaunchBar,n.colors.BaseColor.White),n.colors.SiteMap.NavigationShelf=p(t.navbarshelfcolor,n.colors.SiteMap.NavigationShelf),n.colors.Entity=p(t.defaultentitycolor,n.colors.Entity),n.colors.CustomEntity=p(t.defaultcustomentitycolor,n.colors.CustomEntity),n.colors.PageHeader=p(t.pageheaderbackgroundcolor,n.colors.PageHeader),n.colors.PagePanel=p(t.panelheaderbackgroundcolor,n.colors.PagePanel),n.colors.Control=(S=t.controlshade,O=t.controlborder,C=n.colors.Control,{Fill:S||C.Fill,Text:S?Object(i.e)(S):C.Text,Stroke:O||C.Stroke}),n.colors.MainThemeColor=(_=t.maincolor,v=n.colors.MainThemeColor,_?{MainColor1:Object(i.f)(_),MainColor2:Object(i.g)(_,i.c),MainColor3:Object(i.h)(_)}:v),n.colors.AccentThemeColor=(b=t.accentcolor,y=n.colors.AccentThemeColor,b?{Accent1:Object(i.f)(b),Accent2:Object(i.g)(b,i.a),Accent3:Object(i.h)(b)}:y),"#000000"!==t.navbarbackgroundcolor&&(n.colors.NavBar=(h=t.navbarbackgroundcolor,m=n.colors.NavBar,h?{NavBar1:Object(i.f)(h),NavBar2:Object(i.g)(h,i.c),NavBar3:Object(i.h)(h)}:m)),n.buttons.Button01Primary.backgroundColor=n.colors.MainThemeColor.MainColor1.Fill,n.buttons.Button01Primary.color=n.colors.MainThemeColor.MainColor1.Text,n.buttons.Button01Primary["> span"].color=n.colors.MainThemeColor.MainColor1.Text,n.buttons.Button01Primary[":hover"].color=n.colors.MainThemeColor.MainColor3.Text,n.buttons.Button01Primary[":hover"].backgroundColor=n.colors.MainThemeColor.MainColor3.Fill,n.buttons.Button01Primary[":active"].color=n.colors.MainThemeColor.MainColor3.Text,n.buttons.Button01Primary[":active"].backgroundColor=n.colors.MainThemeColor.MainColor3.Fill,n.buttons.Button01Primary[":active"].outline="1px solid "+n.colors.MainThemeColor.MainColor3.Fill,e.user.userSettings.isHighContrastEnabled&&(n.buttons.Button01Primary[":focus"].outlineOffset="-3px !important"),n.buttons.Button01Secondary.border="1px solid "+n.colors.MainThemeColor.MainColor1.Fill,n.buttons.Button01Secondary.backgroundColor=n.colors.BaseColor.White,n.buttons.Button01Secondary["> span"].color=n.colors.MainThemeColor.MainColor1.Fill,n.buttons.Button01Secondary[":hover"]["> span"].color=n.colors.MainThemeColor.MainColor3.Text,n.buttons.Button01Secondary[":hover"].backgroundColor=n.colors.MainThemeColor.MainColor3.Fill,n.buttons.Button01Secondary[":active"]["> span"].color=n.colors.MainThemeColor.MainColor3.Text,n.buttons.Button01Secondary[":active"].backgroundColor=n.colors.MainThemeColor.MainColor3.Fill,n.buttons.Button01Secondary[":active"].outline="1px solid "+n.colors.MainThemeColor.MainColor3.Fill,n.buttons.Button02Primary.backgroundColor=n.colors.MainThemeColor.MainColor1.Fill,n.buttons.Button02Primary.color=n.colors.MainThemeColor.MainColor1.Text,n.buttons.Button02Primary[":hover"].color=n.colors.MainThemeColor.MainColor3.Text,n.buttons.Button02Primary[":hover"].backgroundColor=n.colors.MainThemeColor.MainColor3.Fill,n.buttons.Button02Primary[":active"].color=n.colors.MainThemeColor.MainColor3.Text,n.buttons.Button02Primary[":active"].backgroundColor=n.colors.MainThemeColor.MainColor3.Fill,n.buttons.Button02Primary[":active"].outline="1px solid "+n.colors.MainThemeColor.MainColor3.Fill,e.user.userSettings.isHighContrastEnabled&&(n.buttons.Button02Primary[":focus"].outlineOffset="-3px !important"),n.buttons.Button02Secondary.border="1px solid "+n.colors.MainThemeColor.MainColor1.Fill,n.buttons.Button02Secondary.backgroundColor=n.colors.BaseColor.White,n.buttons.Button02Secondary["> span"].color=n.colors.MainThemeColor.MainColor1.Fill,n.buttons.Button02Secondary[":hover"]["> span"].color=n.colors.MainThemeColor.MainColor3.Text,n.buttons.Button02Secondary[":hover"].backgroundColor=n.colors.MainThemeColor.MainColor3.Fill,n.buttons.Button02Secondary[":active"]["> span"].color=n.colors.MainThemeColor.MainColor3.Text,n.buttons.Button02Secondary[":active"].backgroundColor=n.colors.MainThemeColor.MainColor3.Fill,n.buttons.Button02Secondary[":active"].outline="1px solid "+n.colors.MainThemeColor.MainColor3.Fill)}var h,m,b,y,_,v,S,O,C;return t===s.a.MailApp&&(n.colors.NavBar.NavBar1.Fill=n.colors.BaseColor.Blue.Blue3,n.colors.NavBar.NavBar1.Text=n.colors.BaseColor.White,n.colors.NavBar.NavBar2.Fill="#c2c2c2",n.colors.SiteMap.AppLauncherBar=n.colors.BaseColor.Grey.Grey1,n.colors.SiteMap.AppLauncherBorder=n.colors.BaseColor.Blue.Blue6,n.colors.SiteMap.AppLauncherText=n.colors.BaseColor.Grey.Grey7,n.colors.SiteMap.GroupText=n.colors.BaseColor.Blue.Blue3,n.colors.SiteMap.Default=n.colors.BaseColor.White,n.colors.QuickLaunchBarIcon=n.colors.BaseColor.Grey.Grey7,n.colors.QuickLaunchBarHover=n.colors.BaseColor.Grey.Grey3,n.colors.EntityLabel=n.colors.BaseColor.Grey.Grey7,n.colors.EntityIcon=n.colors.BaseColor.Grey.Grey7,n.colors.SiteMap.AreaBar=n.colors.BaseColor.Grey.Grey1,n.colors.SiteMap.AreaBarItemActive=n.colors.BaseColor.Grey.Grey3,n.colors.SiteMap.AreaBarItemIcon=n.colors.BaseColor.Grey.Grey7,n.colors.SiteMap.AreaBarItemText=n.colors.BaseColor.Grey.Grey7,n.colors.SiteMap.AreaItemBorder=n.colors.BaseColor.Blue.Blue6,n.colors.SiteMap.NavigationBarMobileActive.Text=n.colors.BaseColor.White,n.colors.SiteMap.NavigationBarMobile.Text=n.colors.BaseColor.White),g&&(n.colors.NavBar.NavBar1.Fill="#f3f2f1",n.colors.NavBar.NavBar1.Text=n.colors.BaseColor.Black,n.colors.NavBar.NavBar2.Fill=n.colors.BaseColor.White,n.colors.NavBar.NavBar2.Text=n.colors.BaseColor.Black,n.colors.NavBar.NavBar3.Fill="#d8d8d8",n.colors.NavBar.NavBar3.Text=n.colors.BaseColor.Black),{type:l,payload:n}}function d(e,t){return e||t}function p(e,t){return e?{Fill:e,Text:Object(i.e)(e)}:t}function f(e,t,n,r){return e?Object(i.j)(e,r,n):t}},C78e:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("2gMP"),a=n("ruPX");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function i(e,t){const n={dialogOptions:e,welcomePageName:t};return Object(a.a)(r.a,n,void 0)}},CB5L:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r,a,i,o,s,c,l,u,d;n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"e",(function(){return i})),n.d(t,"f",(function(){return o})),n.d(t,"g",(function(){return s})),n.d(t,"h",(function(){return l})),n.d(t,"d",(function(){return u})),n.d(t,"c",(function(){return d})),function(e){e[e.Equal=0]="Equal",e[e.NotEqual=1]="NotEqual",e[e.GreaterThan=2]="GreaterThan",e[e.LessThan=3]="LessThan",e[e.GreaterEqual=4]="GreaterEqual",e[e.LessEqual=5]="LessEqual",e[e.Like=6]="Like",e[e.NotLike=7]="NotLike",e[e.In=8]="In",e[e.NotIn=9]="NotIn",e[e.Between=10]="Between",e[e.NotBetween=11]="NotBetween",e[e.Null=12]="Null",e[e.NotNull=13]="NotNull",e[e.Yesterday=14]="Yesterday",e[e.Today=15]="Today",e[e.Tomorrow=16]="Tomorrow",e[e.Last7Days=17]="Last7Days",e[e.Next7Days=18]="Next7Days",e[e.LastWeek=19]="LastWeek",e[e.ThisWeek=20]="ThisWeek",e[e.NextWeek=21]="NextWeek",e[e.LastMonth=22]="LastMonth",e[e.ThisMonth=23]="ThisMonth",e[e.NextMonth=24]="NextMonth",e[e.On=25]="On",e[e.OnOrBefore=26]="OnOrBefore",e[e.OnOrAfter=27]="OnOrAfter",e[e.LastYear=28]="LastYear",e[e.ThisYear=29]="ThisYear",e[e.NextYear=30]="NextYear",e[e.LastXHours=31]="LastXHours",e[e.NextXHours=32]="NextXHours",e[e.LastXDays=33]="LastXDays",e[e.NextXDays=34]="NextXDays",e[e.LastXWeeks=35]="LastXWeeks",e[e.NextXWeeks=36]="NextXWeeks",e[e.LastXMonths=37]="LastXMonths",e[e.NextXMonths=38]="NextXMonths",e[e.LastXYears=39]="LastXYears",e[e.NextXYears=40]="NextXYears",e[e.EqualUserId=41]="EqualUserId",e[e.NotEqualUserId=42]="NotEqualUserId",e[e.EqualBusinessId=43]="EqualBusinessId",e[e.NotEqualBusinessId=44]="NotEqualBusinessId",e[e.ChildOf=45]="ChildOf",e[e.Mask=46]="Mask",e[e.NotMask=47]="NotMask",e[e.MasksSelect=48]="MasksSelect",e[e.Contains=49]="Contains",e[e.DoesNotContain=50]="DoesNotContain",e[e.EqualUserLanguage=51]="EqualUserLanguage",e[e.NotOn=52]="NotOn",e[e.OlderThanXMonths=53]="OlderThanXMonths",e[e.BeginsWith=54]="BeginsWith",e[e.DoesNotBeginWith=55]="DoesNotBeginWith",e[e.EndsWith=56]="EndsWith",e[e.DoesNotEndWith=57]="DoesNotEndWith",e[e.ThisFiscalYear=58]="ThisFiscalYear",e[e.ThisFiscalPeriod=59]="ThisFiscalPeriod",e[e.NextFiscalYear=60]="NextFiscalYear",e[e.NextFiscalPeriod=61]="NextFiscalPeriod",e[e.LastFiscalYear=62]="LastFiscalYear",e[e.LastFiscalPeriod=63]="LastFiscalPeriod",e[e.LastXFiscalYears=64]="LastXFiscalYears",e[e.LastXFiscalPeriods=65]="LastXFiscalPeriods",e[e.NextXFiscalYears=66]="NextXFiscalYears",e[e.NextXFiscalPeriods=67]="NextXFiscalPeriods",e[e.InFiscalYear=68]="InFiscalYear",e[e.InFiscalPeriod=69]="InFiscalPeriod",e[e.InFiscalPeriodAndYear=70]="InFiscalPeriodAndYear",e[e.InOrBeforeFiscalPeriodAndYear=71]="InOrBeforeFiscalPeriodAndYear",e[e.InOrAfterFiscalPeriodAndYear=72]="InOrAfterFiscalPeriodAndYear",e[e.EqualUserTeams=73]="EqualUserTeams",e[e.EqualUserOrUserTeams=74]="EqualUserOrUserTeams",e[e.Under=75]="Under",e[e.NotUnder=76]="NotUnder",e[e.UnderOrEqual=77]="UnderOrEqual",e[e.Above=78]="Above",e[e.AboveOrEqual=79]="AboveOrEqual",e[e.EqualUserOrUserHierarchy=80]="EqualUserOrUserHierarchy",e[e.EqualUserOrUserHierarchyAndTeams=81]="EqualUserOrUserHierarchyAndTeams",e[e.OlderThanXYears=82]="OlderThanXYears",e[e.OlderThanXWeeks=83]="OlderThanXWeeks",e[e.OlderThanXDays=84]="OlderThanXDays",e[e.OlderThanXHours=85]="OlderThanXHours",e[e.OlderThanXMinutes=86]="OlderThanXMinutes"}(r||(r={})),function(e){e[e.Unknown=0]="Unknown",e[e.OnDemandWithContext=1]="OnDemandWithContext",e[e.OnDemandWithoutContext=2]="OnDemandWithoutContext",e[e.OnDemandContextOnly=3]="OnDemandContextOnly",e[e.Offline=4]="Offline",e[e.Mobile=5]="Mobile",e[e.UserContext=6]="UserContext"}(a||(a={})),function(e){e[e.Inner=0]="Inner",e[e.LeftOuter=1]="LeftOuter",e[e.Natural=2]="Natural",e[e.MatchFirstRowUsingCrossApply=3]="MatchFirstRowUsingCrossApply",e[e.In=4]="In",e[e.Exists=5]="Exists"}(i||(i={})),function(e){e[e.And=0]="And",e[e.Or=1]="Or",e[e.Not=2]="Not"}(o||(o={})),function(e){e[e.Ascending=0]="Ascending",e[e.Descending=1]="Descending"}(s||(s={})),function(e){e[e.All=0]="All",e[e.ValidForCreate=1]="ValidForCreate",e[e.ValidForUpdate=2]="ValidForUpdate",e[e.ValidForRead=3]="ValidForRead"}(c||(c={})),function(e){e[e.None=0]="None",e[e.Related=1]="Related",e[e.Extended=2]="Extended"}(l||(l={})),function(e){e[e.None=0]="None",e[e.SingleQuotesURL=1]="SingleQuotesURL",e[e.DoubleQuotesURL=2]="DoubleQuotesURL",e[e.NoQuotesURL=3]="NoQuotesURL",e[e.Contract=4]="Contract",e[e.JsonifyURL=5]="JsonifyURL"}(u||(u={})),function(e){e[e.NewData=1]="NewData",e[e.ExistingData=2]="ExistingData"}(d||(d={}))},CEpr:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.DeviceDefault=0]="DeviceDefault",e[e.Res640x480=1]="Res640x480",e[e.Res1024x768=2]="Res1024x768",e[e.Res1600x1200=3]="Res1600x1200",e[e.Res2048x1536=4]="Res2048x1536",e[e.Res2592x1936=5]="Res2592x1936"}(r||(r={}))},CXmn:function(e,t,n){"use strict";n.d(t,"f",(function(){return S})),n.d(t,"e",(function(){return O})),n.d(t,"k",(function(){return C})),n.d(t,"l",(function(){return E})),n.d(t,"a",(function(){return I})),n.d(t,"j",(function(){return w})),n.d(t,"d",(function(){return j})),n.d(t,"i",(function(){return P})),n.d(t,"c",(function(){return T})),n.d(t,"g",(function(){return N})),n.d(t,"m",(function(){return A})),n.d(t,"b",(function(){return R})),n.d(t,"h",(function(){return D}));var r=n("LzVy"),a=n("sclX"),i=n("4leG"),o=n("unFF"),s=n("b8TU"),c=n("GYEz"),l=n("AVDU"),u=n("w1eR"),d=n("NjDY"),p=n("IqkD"),f=n("glAs"),g=n("h4iz"),h=n("504W"),m=n("Lyxw"),b=n("3/02"),y=n("E+Gg"),_=n("YxC/"),v=n("BM7Q");function S(e){return Object(m.f)(e,b.td)}function O(e){return Object(m.f)(e,b.sd)}function C(e,t=!1){return!!Object(d.k)(e)&&(!t||!Object(s.e)(e))}function E(e){return Object(p.c)(e)}function I(e,t,n){if(!function(e,t){return C(e,t)&&!(t&&E(e))}(e,n))return t;const r=Object(_.b)(e,v.c);let a="{0}{2}{1}";Object(p.g)(e)&&n&&(a="{1}{2}{0}");const i=n?" ":"\n";return String.format(a,t,r,i)}function w(e){var t;const n=Object(c.a)(e),r=Object(i.c)(e),a=Object(s.e)(e),o=Object(f.a)(e),l=Object(c.a)(e)===u.a.MailApp;if(!(null===(t=Object(p.x)(e))||void 0===t?void 0:t.isLive)||n===u.a.MobileApplication||l||r)return!1;if(o||a){const t=Object(g.a)(e);return Object(h.a)(t)}return!0}function j(e){return Object(y.f)(e)}function P(e){return Object(l.m)(e)}function T(e){return Object(i.c)(e)}function N(e){return Object(c.a)(e)!==u.a.MailApp&&!Object(i.c)(e)}function A(e){const t=Object(r.a)(e),n=Object(i.c)(e);return!(t!==a.b.Native&&!n)||!Object(s.e)(e)&&void 0}function R(e){return Object(o.a)(e).sizes.NavbarHeight}function D(e){return Object(m.e)(e,b.m,b.o,b.n)}},CYtR:function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return o}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="MscrmControls.ModelForm.ModelFormControl",a="MscrmControls.FieldControls.DateTimeControl",i="MscrmControls.FieldControls.DateControl",o="MscrmControls.FieldControls.TimeControl"},CfSh:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("IpQH"),a=n("fMBw"),i=n.n(a),o=n("uM6Y"),s=n("VkXQ"),c=n("DPfD"),l=n("zwYV");class u extends r.a{constructor(e,t){super(e,t,o.d),this._tracer=e.TraceManager.getTracer("ExternalContext")}getExternalContextProperty(e,t,n=null){const r=s.d.getExternalContextProperty.name,a=o.d+"."+r,u=[{name:"ContextId",value:e},{name:"PropertyId",value:t}],d=i.a.createEvent(r,o.d).startStopwatch({externalContextId:e,externalContextPropertyId:t}),p=this.getAvailableExternalContexts();if(!p||!p[e]){const t=`External context ${e} is not available. Check the availability before calling.`;return d(),this._tracer.info(t),Promise.reject(new Error(t))}if(-1===p[e].properties.indexOf(t)){const n=`External context property ${t} is not available on context ${e}. Check the availability before calling.`;return d(),this._tracer.info(n),Promise.reject(new Error(n))}n&&n.updateListener&&this.applicationStore.dispatch(Object(l.f)(e,t,n.updateListener));const f=Object(c.c)(this.applicationStore.getState(),e,t);return void 0!==f?(d(),this._tracer.info(`External Context property retrieved from state: ${e} ${t}`),Promise.resolve(f)):this.execute(r,e,t,n&&n.args).then(n=>(d(),this._tracer.info(`External Context property retrieved from platform: ${e} ${t}`),n&&n.value),e=>{throw d(),this.applicationContext.EventManager.ReportComponentFailure(a,e,"Check shim connection to external context",u),e})}invokeExternalContextAction(e,t,n=null){const r=s.d.invokeExternalContextAction.name,a=o.d+"."+r,c=[{name:"ContextId",value:e},{name:"ActionId",value:t}],l=i.a.createEvent(r,o.d).startStopwatch({externalContextId:e,externalContextActionId:t}),u=this.getAvailableExternalContexts();if(!u||!u[e]){const t=`External context ${e} is not available. Check the availability before calling.`;return l(),this._tracer.info(t),Promise.reject(new Error(t))}if(-1===u[e].actions.indexOf(t)){const n=`External context action ${t} is not available on context ${e}. Check the availability before calling.`;return l(),this._tracer.info(n),Promise.reject(new Error(n))}return this.execute(r,e,t,n&&n.args).then(n=>(l(),this._tracer.info(`External Context action invoked on platform: ${e} ${t}`),n&&n.value),e=>{throw l(),this.applicationContext.EventManager.ReportComponentFailure(a,e,"Check shim connection to external context",c),e})}getAvailableExternalContexts(){return Object(c.a)(this.applicationStore.getState())}removeExternalContextPropertyListener(e,t,n){this.applicationStore.dispatch(Object(l.h)(e,t,n))}}},Ci56:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runAction=t.waitWithTimeout=t.makeCompositeAction=void 0;var r=n("oZ1k");function a(e,t){return new Promise((function(n,r){var a=setTimeout((function(){r(t)}),3e4);e().then((function(e){clearTimeout(a),n(e)}),(function(e){clearTimeout(a),r(e)}))}))}function i(e,t,n,i,o){return e.isBoot&&r.saveAutomationState(),(e.isComposite?e.action(n,null,o):new Promise((function(t){setTimeout((function(){t(a((function(){return n.preActionCallback&&n.preActionCallback(),(n.preActionCallback&&n.waitForIdle()||Promise.resolve()).then((function(){return e.action(n,i,o)}))}),"Action "+e.displayName+" timed out after 30000 ms"))}),n.DELAY_BETWEEN_ACTIONS)}))).then((function(e){return t?n.waitForIdle().then((function(){return e})):e}))}t.waitWithTimeout=a,t.runAction=i,t.makeCompositeAction=function(e,t){return{action:function(t,n,r){return e.reduce((function(e,n){return e.then((function(e){return i(n,!0,t,e,r)}))}),Promise.resolve())},displayName:t,isComposite:!0}}},Ckvi:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("Ri7K"),a=n("E+70"),i=n("3BuU"),o=function(){function e(){}return e.initialize=function(e){var t=this;this._sendStats=e,this._isInitalized=!0,a.default.addNotificationListener({eventsSent:function(e){t._addStat("records_sent_count",e.length,e[0].apiKey)},eventsDropped:function(e,n){switch(n){case i.AWTEventsDroppedReason.NonRetryableStatus:t._addStat("d_send_fail",e.length,e[0].apiKey),t._addStat("records_dropped_count",e.length,e[0].apiKey);break;case i.AWTEventsDroppedReason.MaxRetryLimit:t._addStat("d_retry_limit",e.length,e[0].apiKey),t._addStat("records_dropped_count",e.length,e[0].apiKey);break;case i.AWTEventsDroppedReason.QueueFull:t._addStat("d_queue_full",e.length,e[0].apiKey)}},eventsRejected:function(e,n){switch(n){case i.AWTEventsRejectedReason.InvalidEvent:t._addStat("r_inv",e.length,e[0].apiKey);break;case i.AWTEventsRejectedReason.KillSwitch:t._addStat("r_kl",e.length,e[0].apiKey);break;case i.AWTEventsRejectedReason.SizeLimitExceeded:t._addStat("r_size",e.length,e[0].apiKey)}t._addStat("r_count",e.length,e[0].apiKey)},eventsRetrying:null}),setTimeout((function(){return t.flush()}),6e4)},e.teardown=function(){this._isInitalized&&(this.flush(),this._isInitalized=!1)},e.eventReceived=function(t){e._addStat("records_received_count",1,t)},e.flush=function(){var e=this;if(this._isInitalized){for(var t in this._stats)this._stats.hasOwnProperty(t)&&this._sendStats(this._stats[t],t);this._stats={},setTimeout((function(){return e.flush()}),6e4)}},e._addStat=function(e,t,n){if(this._isInitalized&&n!==r.StatsApiKey){var a=r.getTenantId(n);this._stats[a]||(this._stats[a]={}),this._stats[a][e]?this._stats[a][e]=this._stats[a][e]+t:this._stats[a][e]=t}},e._isInitalized=!1,e._stats={},e}();t.default=o},CngE:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"g",(function(){return o})),n.d(t,"f",(function(){return s})),n.d(t,"d",(function(){return c})),n.d(t,"e",(function(){return l})),n.d(t,"h",(function(){return u})),n.d(t,"j",(function(){return d})),n.d(t,"b",(function(){return p})),n.d(t,"c",(function(){return f})),n.d(t,"i",(function(){return g}));var r=n("SAYH"),a=n("eXjw");function i(e,t){const n=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e){return e&&e.metadata&&e.metadata.charts?e.metadata.charts:null}(e);if(!t||!n)return null;const a=r.a.toString(t);return n.hasOwnProperty(a)?n[a]:null}function o(e,t){const n=i(e,t);return n?n.oDataInitialized:a.a.Uninitialized}function s(e,t){const n=i(e,t);return n?n.initialized:a.a.Uninitialized}function c(e,t,n){return e&&t&&n&&e&&e.data&&e.data.charts&&e.data.charts[t]&&e.data.charts[t][n]?e.data.charts[t][n].initialized:a.a.Uninitialized}function l(e,t){return e&&t&&e&&e.data&&e.data.chartData&&e.data.chartData[t]?e.data.chartData[t].initialized:a.a.Uninitialized}function u(e,t){return e&&t&&e&&e.metadata&&e.metadata.chartSelectors&&e.metadata.chartSelectors[t]?e.metadata.chartSelectors[t].initialized:a.a.Uninitialized}function d(e,t){if(!(e&&e.metadata&&e.metadata.chartDefaults&&t))return null;const n=e.metadata.chartDefaults[t];return n||null}function p(e,t,n){return e&&t&&n&&e&&e.data&&e.data.charts&&e.data.charts[t]&&e.data.charts[t][n]&&e.data.charts[t][n].initialized===a.a.Initialized&&e.data.charts[t][n].chartConfigObject?e.data.charts[t][n].chartConfigObject:null}function f(e,t){return e&&t&&e&&e.data&&e.data.chartData&&e.data.chartData[t]&&e.data.chartData[t].initialized===a.a.Initialized&&e.data.chartData[t].chartConfigObject?e.data.chartData[t].chartConfigObject:null}function g(e,t){return e&&t&&e&&e.metadata&&e.metadata.chartSelectors?e.metadata.chartSelectors[t]:null}},CpcI:function(e,t,n){"use strict";n.d(t,"g",(function(){return l})),n.d(t,"e",(function(){return r})),n.d(t,"f",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return c}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="CC_Duration_Minute",a="CC_Duration_Minutes",i="CC_Duration_Hour",o="CC_Duration_Hours",s="CC_Duration_Day",c="CC_Duration_Days",l=[r,a,i,o,s,c]},CrQY:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("5yoC");class a extends r.a{constructor(e,t,n,r){super(),this._searchText=null,this._entityGroupName=null,this._entityNames=null,this._searchText=e,this._entityGroupName=t,this._entityNames=n}get_name(){return"ExecuteQuickFind"}get_searchText(){return this._searchText}get_entityGroupName(){return this._entityGroupName}get_entityNames(){return this._entityNames}}},CvZq:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.NonBlockingUI=0]="NonBlockingUI",e[e.BlockingUI=1]="BlockingUI"}(r||(r={}))},Cxkq:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r,a=n("wo7m");function i(e,t){return{type:"DESERIALIZE_RETRIEVE_PRINCIPAL_ACCESS_RESPONSE_ASYNC",execute:({dispatch:t,getState:n},i)=>e.json().then(e=>{let t=r.None;return e&&"string"==typeof e.AccessRights&&e.AccessRights.split(", ").forEach(e=>{const n=r[e];t|=n}),new a.a(t)})}}!function(e){e[e.None=0]="None",e[e.ReadAccess=1]="ReadAccess",e[e.WriteAccess=2]="WriteAccess",e[e.AppendAccess=4]="AppendAccess",e[e.AppendToAccess=16]="AppendToAccess",e[e.CreateAccess=32]="CreateAccess",e[e.DeleteAccess=65536]="DeleteAccess",e[e.ShareAccess=262144]="ShareAccess",e[e.AssignAccess=524288]="AssignAccess"}(r||(r={}))},"D+Bz":function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r,a;n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),function(e){e[e.Page=0]="Page",e[e.Dialog=1]="Dialog"}(r||(r={})),function(e){e.Other="Other",e.SiteMap="SiteMap",e.AdvancedInAppShell="AdvancedInAppShell",e.Redirect="Redirect",e.SwitchApp="SwitchApp",e.SiteMapSubArea="SiteMapSubArea",e.Xrm="Xrm",e.BrowserBack="BrowserBack",e.Unknown="Unknown"}(a||(a={}))},D4rv:function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"f",(function(){return c})),n.d(t,"e",(function(){return l}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var i=function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function o(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n}function s(e,t,n,r){var a,i=arguments.length,o=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(o=(i<3?a(o):i>3?a(t,n,o):a(t,n))||o);return i>3&&o&&Object.defineProperty(t,n,o),o}Object.create;function c(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),a=0;for(t=0;t<n;t++)for(var i=arguments[t],o=0,s=i.length;o<s;o++,a++)r[a]=i[o];return r}function l(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))}Object.create},D6Jg:function(e,t,n){"use strict";n.d(t,"e",(function(){return f})),n.d(t,"d",(function(){return g})),n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"f",(function(){return d}));var r=n("ZUus"),a=n("gqKu"),i=n("mlvZ"),o=n("xagu"),s=n("a6P5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const c="initialize.configuration.from.url",l=e=>{const t=e.searchParams.get(o.D),n={isPreviewMode:!!u(t)},r=Object(i.f)(),a=e.searchParams.get("cmdbar"),l=e.searchParams.get("ribbondebug"),h=e.searchParams.get("navbar"),m=e.searchParams.get("sitemap"),b=e.searchParams.get("testmode"),y=e.searchParams.get("flags"),_=e.searchParams.get("app"),v=e.searchParams.get("disableLocalStorage"),S=e.searchParams.get("hostConfig"),O=e.searchParams.get("solutionUniqueName"),C=e.searchParams.get("playedFromAppDesigner");if(!(a||h||r||l||m||b||_||y||O||C))return;const E=u(a),I=u(l),w=d(h),j=u(m),P=u(b),T=u(v),N=f(y),A=g(y),R=p(N[o.Y]),D=u(N[o.B]),x=Object(s.a)(S),M=u(C);return void 0!==E&&(n.cmdbar=E),void 0!==I&&(n.ribbonDebug=I),w&&(n.navbar=w),R&&(n.themeOption=R),r&&(n.performanceUiEnabled=!0),void 0!==j&&(n.sitemap=j),!0===P||"d365default"===_?n.isD365DefaultApp=!0:!1===P&&(n.isD365DefaultApp=!1),void 0!==N&&(n.flags=N),void 0!==A&&(n.fcbs=A),void 0!==T&&(n.disableLocalStorage=T),void 0!==D&&(n.isEmbedded=D),void 0!==x&&(n.hostConfig=x),void 0!==O&&(n.solutionUniqueName=O),void 0!==M&&(n.playedFromAppDesigner=M),{type:c,payload:n}},u=e=>{if(e)switch(e.toLowerCase()){case"false":return!1;case"true":return!0;default:return}},d=e=>{if(e)switch(e.toLowerCase()){case r.a[r.a.Off].toLowerCase():return r.a.Off;case r.a[r.a.Entity].toLowerCase():return r.a.Entity;case r.a[r.a.On].toLowerCase():return r.a.On;default:return}},p=e=>{if(e)switch(e.toLowerCase()){case a.a[a.a.Default].toLowerCase():return a.a.Default;case a.a[a.a.TeamsDark].toLowerCase():return a.a.TeamsDark;case a.a[a.a.TeamsDefault].toLowerCase():return a.a.TeamsDefault;case a.a[a.a.TeamsHighContrast].toLowerCase():return a.a.TeamsHighContrast;case a.a[a.a.Wacky].toLowerCase():return a.a.Wacky;default:return}},f=e=>{var t;if(!e)return{};const n={},r=e.split(",");for(const e of r){const r=e.split("="),a=r[0];if(!a.startsWith("FCB.")){const e=null===(t=r[1])||void 0===t?void 0:t.toLowerCase();n[a.toLowerCase()]=e}}return n},g=e=>{if(!e)return{};const t={},n=e.split(",");for(const e of n){const n=e.split("="),r=n[0];if(r.startsWith("FCB.")){const e=u(n[1]);t[r]=e}}return t}},D9jM:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i}));var r=n("LbMF");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t,n,a){const i=function(e,t,n){if(!e||!e.metadata)return null;const a=Object(r.a)(e,t,n);return a?a.OptionSet:[]}(e,t,n);for(const e of i)if(e.Value===a)return e.Label;return""}function i(e,t,n,a){const i=Object(r.a)(e,t,n);if(!i||!i.OptionSet)return null;const o=[];for(const e of i.OptionSet)e.ParentValues&&e.ParentValues.find(e=>e===a)&&o.push(e);return o.length>0?o:null}},DD48:function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return c}));var r=n("3/02"),a=n("Lyxw"),i=n("NjDY");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function o(e){const t=Object(i.D)(e);return Object(a.e)(e,r.ze,r.p)&&!!(null==t?void 0:t.modernAdvancedFindFiltering)}function s(e){const t=Object(i.D)(e);return!Object(a.e)(e,r.ze,r.p)||!!(null==t?void 0:t.advancedColumnEditorEnabled)}function c(e){const t=Object(i.D)(e);return!Object(a.e)(e,r.ze,r.p)||!!(null==t?void 0:t.advancedColumnFilteringEnabled)}},DMoA:function(e,t,n){"use strict";n.d(t,"g",(function(){return s})),n.d(t,"h",(function(){return c})),n.d(t,"i",(function(){return l})),n.d(t,"e",(function(){return u})),n.d(t,"f",(function(){return d})),n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return g})),n.d(t,"c",(function(){return h})),n.d(t,"d",(function(){return p}));var r=n("zsAz"),a=n("LqfC"),i=n("rcL5"),o=n("/leX");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function s(e){switch(e){case 1:case 2:return}throw Object(r.d)("Invalid panel position",2415919121,[{name:"position",value:e}])}function c(e){switch(e){case 0:case 1:case 2:return}throw Object(r.d)("Invalid panel state",2415919121,[{name:"state",value:e}])}function l(e){if(!e)throw Object(r.d)("Invalid width",2415919121,[{name:"width",value:e}]);if(!/^\d+(\.\d+)?(px|%)?$/.test(e))throw Object(r.d)("Invalid width",2415919121,[{name:"width",value:e}])}function u(e){return 2===e?a.u:a.s}function d(e){return 1===e?a.r:void 0}function p(e){let t=0;return!e||e.type!==o.b.Pane&&2===e.option.sidePanelState||(t=e.option.sidePanelWidth&&e.option.sidePanelWidth.indexOf("%")>0?a.r:parseInt(e.option.sidePanelWidth,10),t<a.r&&(t=a.r)),t}function f(e,t,n){const a=Object(i.h)(e,t);if(a&&(a.type===o.b.IFrame||!n))throw Object(r.d)("Cannot create SidePanel. Only 1 sidepanel in each position",2415919107)}function g(e,t,n){const a=Object(i.h)(e,n);if(a&&a.sidePanelId!==t)throw Object(r.d)("Cannot update SidePanel position. Only 1 sidepanel in each position",2415919107)}function h(e){return e+"_header"}},DPXt:function(e,t,n){"use strict";n.r(t);var r={};n.r(r);var a={};n.r(a);var i={};n.r(i),n.d(i,"decorateUrl",(function(){return Pd})),n.d(i,"decorateInput",(function(){return Td}));var o={};n.r(o),n.d(o,"decorateUrl",(function(){return Ad})),n.d(o,"decorateInput",(function(){return Rd}));var s={};n.r(s),n.d(s,"decorateUrl",(function(){return Dd})),n.d(s,"decorateInput",(function(){return xd}));var c={};n.r(c),n.d(c,"decorateUrl",(function(){return Bd})),n.d(c,"decorateInput",(function(){return Ud}));var l={};n.r(l),n.d(l,"diagnosticName",(function(){return Rg})),n.d(l,"boot",(function(){return Dg})),n.d(l,"supportedClientHostTypes",(function(){return xg})),n.d(l,"supportedPageTypes",(function(){return Mg})),n.d(l,"priority",(function(){return Fg}));n("wD+p"),n("Nl/S"),n("/K9b"),n("vffP"),n("a3Nm"),n("YUtc"),n("4shB"),n("X58J"),n("UvBn"),n("ynWy"),n("LuPR"),n("jMf1");
/**
 * Loads global polyfills so they are included by webpack
 * and initialize window level variables.
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
n.p=__public_path__;var u=n("mMyr"),d=n("huli");
/**
 * Loads global polyfills so they are included by webpack
 * and initialize window level variables.
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
window.React=u,window.ReactDOM=d,window.__React=u,window.__ReactDOM=d,window.requirejs=function(e,t){if(1===e.length){if("react"===e[0])return void t(u);if("react-dom"===e[0])return void t(d)}throw new Error("requirejs is not supported")};var p=n("kAKO"),f=n("zsAz"),g=n("fMBw"),h=n.n(g),m=n("SZCI"),b=n("FdKt");function y(e,t,n){let r=!1;const a=n.TraceManager&&n.TraceManager.getTracer("Boot.Initializer");a&&a.debug("Initializer boot started.");const i=t.getClientHost().toString();return e.reduce((e,o)=>e.then(()=>{if(!o.supportedClientHostTypes.includes(i))return;const e=h.a.createEvent(o.diagnosticName,m.d).startStopwatch();let r;const a=t.getStore();return!
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e){return e.priority===p.a.OnIdle}(o)?r=o.boot(t,n,a):Object(b.b)(()=>o.boot(t,n,a),o.diagnosticName),r instanceof Promise?r.then(()=>{e()},()=>{e()}):e(),r}).then(e=>(a&&a.info(o.diagnosticName+".Initializer - boot completed successfully."),e)).catch(e=>{let t=e;throw r||(t=Object(f.c)(e),r=!0,a&&a.error(o.diagnosticName+".Initializer - boot failed with error: "+e.message),Object(f.b)(e,[{name:"BootTask",value:o.diagnosticName}]),t.message=o.diagnosticName+": "+t.message),t}),Promise.resolve())}var _=n("5UJb"),v=n.n(_),S=n("zI6t"),O=n.n(S),C=n("Z9sG"),E=n("pEXn"),I=n("mlvZ"),w=n("2YQW");var j=n("mfAb");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var P=n("TBkx"),T=n("504W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class N{constructor(e,t,n,r){this._pendingActionCache={},this._store=e,this._dispatch=t,this._applicationContext=n,this._tracer=r}executeAction(e,t){return Object(j.a)(e)?this._executeAsync(e,t):this._executeSync(e,t)}_executeSync(e,t){const n=h.a.createEvent(e.type,m.E).startStopwatch();try{return this._beginExecution(e,this._store,this._applicationContext,t),Object(j.b)(e)?void this._executePlainAction(e,t):this._executeSyncAction(e,t)}catch(n){this._handleFailure(n,e,this._store,this._applicationContext,t,!0)}finally{n()}}_executePlainAction(e,t){this._dispatch(e),this._handleSuccess(e,void 0,this._store,this._applicationContext,t)}_executeSyncAction(e,t){const n=this._store,r=e.execute(n,this._applicationContext,t);return this._handleSuccess(e,r,this._store,this._applicationContext,t),r}_executeAsync(e,t){const n=e.cacheKey;return n&&this._pendingActionCache[n]?this._pendingActionCache[n]:this._executeAsyncAction(e,t)}_executeAsyncAction(e,t){const n=h.a.createEvent(e.type,"Core.Actions.Async"),r=h.a.createEvent(e.type,m.E),a=n.startStopwatch(),i=new Promise(n=>{this._beginExecution(e,this._store,this._applicationContext,t);const a=r.startStopwatch(),i=function(e,t,n){const r={getState:e.getState,dispatch:n=>e.dispatch(n,t)};n&&(r.subscribe=e.subscribe);return r}(this._store,t,function(e){return!!e.shouldReceiveFullStore}(e));try{const r=e.execute(i,this._applicationContext,t);r||this._tracer.warn(`No promise returned from execute method, ActionType: ${e.type}.`),n(r)}finally{a()}}).then(n=>(this._handleSuccess(e,n,this._store,this._applicationContext,t),n)).catch(n=>this._handleFailure(n,e,this._store,this._applicationContext,t)),o=()=>a();i.then(o,o);const s=e.cacheKey;if(s){this._pendingActionCache[s]=i;const e=()=>delete this._pendingActionCache[s];i.then(e,e)}return i}_beginExecution(e,t,n,r){const a=this._getExecutionParameters(e,r);if("function"==typeof e.getInitialParameters){const r=n.EventManager;try{Array.prototype.push.apply(a,e.getInitialParameters(t,n))}catch(e){this._tracer.error("AsyncActionExecutor.getInitialParameters failed, message : "+e.message,a)}r.ReportComponentSuccess("AsyncActionExecutor.BeginExecute",a)}else this._tracer.info("Begin executing action",this._getExecutionParameters(e,r))}_handleSuccess(e,t,n,r,a){const i=this._getExecutionParameters(e,a);if("function"==typeof e.getSuccessParameters){const a=r.EventManager;try{Array.prototype.push.apply(i,e.getSuccessParameters(t,n,r))}catch(e){this._tracer.error("AsyncActionExecutor.getSuccessParameters failed, message : "+e.message,i)}a.ReportComponentSuccess("AsyncActionExecutor.EndExecute",i)}else this._tracer.info("Finished executing action successfully",this._getExecutionParameters(e,a))}_handleFailure(e,t,n,r,a,i=!1){const o=r.EventManager,s={actionType:t.type,actionStack:a.stack,contextId:a.contextId};let c,l;if(e){const t=Object(P.e)(e);if("object"==typeof e){if(Object.isFrozen(e)){const n=Object(f.d)(t.message);n.innerError=e,l=n}else l=e;try{l.message=t.message,l.name=l.name||t.name,l.stack=t.stack}catch(e){e&&e.message&&this._tracer.error("Copying ensuredError properties to error object failed, message : "+e.message),c=JSON.stringify(t,Object.getOwnPropertyNames(t))}}else l=t;(function(e){return"object"==typeof e&&null!==e&&"object"==typeof e.__action})(e)||(l.__action={source:s})}else l=new Error(`Action Executor detected an error, but the action (${t.type}) failed to supply an error object.`),l.__action={source:s};const u=l.__action,d=this._getExecutionFailureParameters(t,u,a);Object(T.b)(c)||d.push({name:"ReadOnlyErrorObjectString",value:c});let p=!a.parentContextId;if("function"==typeof t.getFailureParameters)try{Array.prototype.push.apply(d,t.getFailureParameters(l,u,n,r)),p=!0}catch(e){this._tracer.error("AsyncActionExecutor.getFailureParameters failed, message : "+e.message,d)}if(p){const e=`This is a failure that ${a.parentContextId?"is yet to reach":"reached uncaught to"} the entry level dispatch. For additional information, query for all events with the same CorrelationId.`;o.ReportComponentFailure("AsyncActionExecutor.EndExecute",l,e,d)}if(u.child=s,i)throw l;return Promise.reject(l)}_getExecutionParameters(e,t){const n=[{name:"ActionType",value:e.type},{name:"CorrelationId",value:t.correlationId},{name:"ContextId",value:t.contextId},{name:"EntryStack",value:t.entryStack},{name:"ActionStack",value:t.stack}];return t.parentContextId&&n.push({name:"ParentContextId",value:t.parentContextId}),n}_getExecutionFailureParameters(e,t,n){const r=[{name:"ActionType",value:e.type},{name:"CorrelationId",value:n.correlationId},{name:"ContextId",value:n.contextId},{name:"EntryStack",value:n.entryStack},{name:"ActionStack",value:t.source.actionStack},{name:"SourceContextId",value:t.source.contextId}];return n.parentContextId&&r.push({name:"ParentContextId",value:n.parentContextId}),r}}var A=n("SAYH");function R(e){return t=>(n,r)=>{const a=t(n,r);return function(e,t){const n={subscribe:t.subscribe,getState:t.getState,dispatch:function(e,n){return t.dispatch(e,n)}},r=e.TraceManager.getTracer("ActionLogging"),a=new N(n,t.dispatch,e,r);return t.dispatch=function(e,t){const n=v.a.trackWork(e.type);t=t?{entryStack:t.entryStack,stack:(t.stack||"")+" :"+e.type,correlationId:t.correlationId||A.a.toString(A.a.newGuid()),contextId:A.a.toString(A.a.newGuid()),parentContextId:t.contextId||"",isPreloadCall:t.isPreloadCall}:{entryStack:void 0,stack:e.type,correlationId:A.a.toString(A.a.newGuid()),contextId:A.a.toString(A.a.newGuid()),parentContextId:""};const r=a.executeAction(e,t);return n(),r},t}(e,a)}}function D(e){return(t,n)=>{const r=e(t,n);return r.subscribe=function(e){const t=e.subscribe;return function(n,r){let a;if(void 0===r)return a=n,t(a);const i=n;return a=function(e,t,n){let r;return function(){const a=t(e());a!==r&&(r=a,n(a))}}(e.getState,i,r),t(a)}}(r),r}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var x=n("Qkep"),M=n("llMO");var F=n("gQ5I"),k=n("2jAf"),L=n("nxXM");var B=n("K7RF"),U=n("y6/h");var V=n("SeXA");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function z(e,t){switch(t.type){case V.a:return Object.assign({},e);default:return e}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function q(e){return{type:"set.server.status",payload:{isAvailable:e}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function H(e){return{type:"set.network.status",payload:{isNetworkAvailable:e}}}var W=n("Qpqc");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const G=["set.server.status","set.network.status",W.b,W.a],K=Object(w.c)(G,null);const Q=[n("1usl").a],X=Object(w.c)(Q,null);var Y=n("wyQO"),J=n("eXjw"),$=n("N6Lu");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Z=[Y.c,Y.a],ee=[Y.c,$.a],te={initialized:J.a.Uninitialized},ne={initialized:J.a.Uninitialized};function re(e=te,t){const n=Object.assign({},e);if(Object.freeze(n),-1===Z.indexOf(t.type)||!t.payload)return n;let r;if(t.type===Y.c){const e=t.payload.userState;r=Object.assign(Object.assign({},n),e)}else if(t.type===Y.a){const e=t.payload,a=e.etn,i={};i[a]=e.pinnedView;for(const e in n.userSettings.defaultGridViews)e!==a&&(i[e]=n.userSettings.defaultGridViews[e]);r=Object.assign({},n),r.userSettings.defaultGridViews=i}return Object.freeze(r)}function ae(e=ne,t){const n=Object.assign({},e);if(Object.freeze(n),-1===ee.indexOf(t.type)||!t.payload)return n;let r;if(t.type===Y.c){const e=t.payload.orgState;r=Object.assign(Object.assign({},n),e)}else if(t.type===$.a){const e=t.payload;r=Object.assign({},n),r.organizationSettings.webResourceHash=e}return Object.freeze(r)}var ie=n("iQAP"),oe=n("B+9Q"),se=n("SjFi");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const ce={clientFCBs:{},nativeFCBContext:{}};function le(e=ce,t){switch(t.type){case oe.a:{const n=Object.assign(Object.assign({},e),t.payload);return n.currentReleaseWave=ue(n),Object.freeze(n)}case ie.a:{const n=Object.assign(Object.assign({},e),{nativeFCBContext:t.payload});return n.currentReleaseWave=ue(n),Object.freeze(n)}default:return e}}function ue(e){const t=Object(se.b)(e);return{waveNumber:t&&Object(se.c)(t),waveYear:t&&Object(se.d)(t)}}var de=n("VX+W"),pe=n("g440"),fe=n("KdpX");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const ge=[B.a,de.a,pe.a,fe.c],he=Object(w.c)(ge,null,e=>e.forms);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const me=[B.a],be=Object(w.c)(me,null,e=>e.siteMap);var ye=n("M0zh");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const _e=[ye.l,B.a],ve=Object(w.c)(_e,null,e=>e.ribbons);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Se=[B.a],Oe=Object(w.c)(Se,null,e=>e.searchConfiguration);var Ce=n("8VF0"),Ee=n("FZDd"),Ie=n("E3kc"),we=n("fC8v");function je(e,t,n){const r={};r[e]=function(e,t){const n={},r="OptionSet";for(const a of e){const e=[{name:E.b.EntityName,value:a.get_entityLogicalName()},{name:E.b.AttributeName,value:a.get_logicalName()}],i={Initialized:J.a.Initialized,Id:A.a.fromLegacyGuid(a.get_id()),LogicalName:a.get_logicalName(),EntityLogicalName:a.get_entityLogicalName(),Type:a.get_type(),SourceType:a.get_sourceType(),DisplayName:a.get_displayName(),RequiredLevel:Object(we.f)(a.get_requiredLevel(),t,e),IsSecured:a.get_isSecured(),IsValidForCreate:a.get_isValidForCreate(),IsValidForUpdate:a.get_isValidForUpdate(),IsValidForRead:a.get_isValidForRead(),IsValidForGrid:a.get_isValidForGrid(),OptionSet:Pe(a.getODataObject()[r]),Targets:a.get_targets(),DefaultFormValue:a.get_defaultFormValue(),DefaultValue:a.get_defaultValue(),MaxLength:a.get_maxLength(),MinValue:a.get_minValue(),MaxValue:a.get_maxValue(),Precision:a.get_precision(),PrecisionSource:a.get_precisionSource(),Format:Object(we.a)(a.get_type(),a.get_format(),a.get_formatName()),Behavior:a.get_behavior(),IsBaseCurrency:a.get_isBaseCurrency(),AttributeOf:a.get_attributeOf(),HasChanged:a.get_hasChanged(),IsSortableEnabled:a.get_isSortableEnabled(),ImeMode:Ne(a.get_imeMode()),InheritsFrom:a.get_inheritsFrom(),CanBeSecuredForCreate:a.get_canBeSecuredForCreate(),CanBeSecuredForRead:a.get_canBeSecuredForRead(),CanBeSecuredForUpdate:a.get_canBeSecuredForUpdate(),IsLogical:a.get_isLogical()};n[i.LogicalName]=i}return n}(t,n);return{type:"cache.attributemetadata",payload:{attributes:r}}}function Pe(e){let t=null;if(e&&(t=[],e.FalseOption&&t.push(Te(e.FalseOption)),e.TrueOption&&t.push(Te(e.TrueOption)),e.Options)){const n=e.Options;for(const e of n)t.push(Te(e))}return t}function Te(e){return{Color:e.Color,Label:Object(we.b)(!1,!1,e.Label),Value:e.Value,DefaultStatus:e.DefaultStatus,State:e.State,InvariantName:e.InvariantName,TransitionData:e.TransitionData}}function Ne(e){if("string"!=typeof e)return"number"==typeof e?e:null;switch(e){case"Auto":return 0;case"Inactive":return 1;case"Active":return 2;case"Disabled":return 3;default:return null}}var Ae=n("thZs");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const Re=[de.a,B.a,Ce.a,Ee.b,fe.c,k.a,Ie.a,"cache.attributemetadata",Ae.a];var De=n("1pQz");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const xe=[B.a,Ee.b,Ce.a,fe.c,de.a,k.a,"cache.entitymetadata",Ae.a],Me={1030:"systemform",1031:"userform"};var Fe=n("EY5k");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const ke=[Fe.a,de.a,fe.c,B.a,Fe.c,Fe.b],Le={initialized:J.a.Uninitialized,strings:null,missingStringIds:[]};var Be=n("BoVI");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const Ue=[B.a,de.a,pe.a,fe.c,Be.a],Ve=Object(w.c)(Ue,null,e=>e.views);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const ze=[B.a];
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const qe=[de.a,B.a],He=Object(w.c)(qe,null,e=>e.dialogs);var We=n("oOvK");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const Ge=[B.a,de.a,We.b,fe.c,We.a];const Ke=[B.a],Qe=Object(w.c)(Ke,null,e=>e.taskBasedFlows);var Xe=n("htFu");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const Ye=[Xe.b,B.a],Je=Object(w.c)(Ye,null,e=>e.taskBasedFlowGlobalMenu),$e=[B.a,de.a,Xe.a,pe.a,ye.l,fe.c];var Ze=n("oLL6"),et=n("RWYE");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const tt=[B.a,Ze.a],nt=Object(w.c)(tt,null,e=>e.businessProcessFlows);const rt=Object(w.c)(tt,null,e=>e.businessProcessFlowsDefault),at=Object(w.c)(tt,null,e=>e.bpfDefaults),it=Object(w.c)(tt,null,e=>e.bpfSelectors),ot=[B.a,ye.l];const st=[fe.c,B.a],ct=Object(w.c)(st,null,e=>e.dashboards),lt=Object(w.c)(st,null,e=>e.dashboardsByNavPath),ut=Object(w.c)(st,null,e=>e.dashboardsByEntityName),dt=Object(w.c)(st,null,e=>e.dashboardSelectorsByEntityName);var pt=n("Tezb");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const ft=[fe.c,pt.b,pt.f,pt.a,B.a,k.a],gt=Object(w.c)(ft,null,e=>e.charts);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const ht=[B.a,de.a],mt={optionSetNameById:{},optionSetByName:{}};var bt=n("99zj");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const yt=[B.a,fe.c,bt.a],_t=Object(w.c)(yt,null,e=>e.webResources),vt=Object(w.c)(yt,null,e=>e.webResourceDescriptorsByName);var St=n("KeJu"),Ot=n("xmKQ");var Ct=n("Yz6o"),Et=n("AAlD");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const It={initialized:J.a.Uninitialized,appNavSettings:{Groups:[]}};
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const wt=[B.a],jt=Object(w.c)(wt,null,e=>e.quickCreateMenu);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Pt=[n("Py/t").a],Tt=Object(w.c)(Pt,null);var Nt=n("yRo8"),At=n("RADj");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Rt=[Nt.e,St.a],Dt=Object.freeze({});
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const xt=[B.a],Mt={initialized:J.a.Uninitialized,lastVersion:null,currentVersion:null};
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Ft=[B.a],kt={initialized:J.a.Uninitialized,lastVersion:null,currentVersion:null};
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Lt=[B.a],Bt=Object(w.c)(Lt,{appList:[]},e=>e.appModulesList),Ut=[B.a],Vt={initialized:J.a.Uninitialized,complexControls:null};
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const zt=[B.a],qt=Object(w.c)(zt,null,e=>e.landingPageOfflineMetadata);var Ht=n("mASP");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const Wt=[Ae.a],Gt=Object(w.c)(Wt,null,e=>e.lookup);var Kt=n("Wiik");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var Qt=n("aMuN");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var Xt=n("+cBJ");const Yt=new Set([Xt.a]);const Jt={forms:he,formDefaults:function(e=null,t){if(-1===ge.indexOf(t.type)||!t.payload||!t.payload.formDefaults)return e;const n=t.payload.formDefaults,r=Object.assign({},e);for(const e in n)r.hasOwnProperty(e)?r[e]=Object.assign(Object.assign({},r[e]),n[e]):r[e]=n[e];return Object.freeze(r)},formSelectors:function(e=null,t){if(-1===ge.indexOf(t.type)||!t.payload||!t.payload.formSelectors)return e;const n=t.payload.formSelectors,r=Object.assign({},e);for(const e in n)r.hasOwnProperty(e)?r[e]=Object.assign(Object.assign({},r[e]),n[e]):r[e]=n[e];return Object.freeze(r)},formSelectorUnfilteredIdsCountByEntity:function(e={},t){return-1!==ge.indexOf(t.type)&&t.payload&&t.payload.formSelectors?Object.freeze(t.payload.formSelectorUnfilteredIdsCountByEntity):e},formUserViewsRetrievedByEntity:function(e={},t){if(!Yt.has(t.type)||!t.payload)return e;const n=Object.assign(Object.assign({},e),{[t.payload.entityLogicalName]:t.payload.retrieved});return Object.freeze(n)},ribbons:function(e,t){switch(t.type){case k.a:return function(e,t){if(!t.payload.ribbons||0===Object.keys(t.payload.ribbons).length)return e;const n={};for(const r of Object.keys(e)){let a=!1;for(const e of Object.keys(t.payload.ribbons))if(r===e){a=!0;break}a||(n[r]=e[r])}return n}(e,t);default:return ve(e,t)}},siteMap:be,attributes:function(e=null,t){if(-1===Re.indexOf(t.type)||!t||!t.payload||!t.payload.attributes)return e;if(t.type===k.a)return function(e,t){if(!t.payload.attributes||0===Object.keys(t.payload.attributes).length)return e;const n={};for(const r in e){let a=!1;for(const e in t.payload.attributes)if(r===e){a=!0;break}a||(n[r]=e[r])}return n}(e,t);const n=Object.assign({},e);for(const e in t.payload.attributes)if(n[e])if(t.type===Ae.a){n[e]=Object.assign({},n[e]);for(const r in t.payload.attributes[e])n[e].hasOwnProperty(r)||(n[e][r]=Object.assign({},t.payload.attributes[e][r]))}else n[e]=Object.assign(Object.assign({},n[e]),t.payload.attributes[e]);else n[e]=t.payload.attributes[e];return Object.freeze(n)},entities:function(e=null,t){if(!(t&&t.payload&&t.payload.entities&&0!==Object.keys(t.payload.entities).length&&t.type&&-1!==xe.indexOf(t.type)))return e;const n=Object.assign({},e);let r=!1;if(t.type===k.a){r=!0;for(const e in t.payload.entities)n[e]=t.payload.entities[e]}else for(const e in t.payload.entities)n.hasOwnProperty(e)&&(!t.payload.entities[e].VersionNumber||n[e].VersionNumber===t.payload.entities[e].VersionNumber)&&(a=n[e],i=t.payload.entities[e],a.Initialized!==J.a.Uninitialized&&a.Initialized!==J.a.Partial||i.Initialized!==J.a.Initialized)||(r=!0,n[e]=Object.assign(Object.assign({},n[e]),t.payload.entities[e]));var a,i;return r?Object.freeze(n):e},entitiesByTypeCode:function(e=Me,t){if(!(t&&t.payload&&t.payload.entities&&t.type&&-1!==xe.indexOf(t.type)))return e;const n=Object.assign({},e);for(const e in t.payload.entities){const r=t.payload.entities[e].ObjectTypeCode;null!=r&&(n[r]=e)}return Object.freeze(n)},resourceStrings:function(e=Le,t){if(-1===ke.indexOf(t.type)||!t.payload||!t.payload.resourceStrings)return e;let n=[],r=[];t.payload.resourceStrings.strings&&(n=Object.keys(t.payload.resourceStrings.strings)),e&&e.missingStringIds&&(r=e.missingStringIds.filter(e=>-1===n.indexOf(e)));const a=Object.assign(Object.assign({},e.strings),t.payload.resourceStrings.strings),i=Object.assign({},t.payload.resourceStrings);return i.strings=a,t.payload.resourceStrings.missingStringIds?i.missingStringIds=r.concat(t.payload.resourceStrings.missingStringIds):i.missingStringIds=r,Object.freeze(i)},views:Ve,viewDefaults:function(e=null,t){if(-1===Ue.indexOf(t.type)||!t.payload||!t.payload.viewDefaults)return e;const n=t.payload.viewDefaults,r=Object.assign({},e);for(const e in n)r.hasOwnProperty(e)?Object.assign(r[e],n[e]):r[e]=n[e];return Object.freeze(r)},viewSelectors:function(e=null,t){if(-1===Ue.indexOf(t.type)||!t.payload||!t.payload.viewSelectors)return e;const n=t.payload.viewSelectors,r=Object.assign({},e);for(const e in n)for(const t in n[e])r.hasOwnProperty(e)?r[e][t]=n[e][t]:r[e]=n[e];return Object.freeze(r)},viewSelectorVersions:function(e=null,t){if(-1===Ue.indexOf(t.type)||!t.payload||!t.payload.viewSelectorVersions)return e;const n=t.payload.viewSelectorVersions,r=Object.assign({},e);for(const e in n)for(const t in n[e])r.hasOwnProperty(e)?r[e][t]=n[e][t]:r[e]=n[e];return Object.freeze(r)},viewSelectorSortOrders:function(e=null,t){if(-1===Ue.indexOf(t.type)||!t.payload||!t.payload.viewSelectorSortOrders)return e;const n=t.payload.viewSelectorSortOrders,r=Object.assign({},e);for(const e in n)for(const t in n[e])r.hasOwnProperty(e)?r[e][t]=n[e][t]:r[e]=n[e];return Object.freeze(r)},dialogs:He,canvasapps:
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e={},t){switch(t.type){case"metadata.canvasapp.add":const i=t.payload;return n=e,r=i.name,a=i,void 0!==n[r]?n:Object.assign(Object.assign({},n),{[r]:a});default:return e}var n,r,a},rootCanvasApp:function(e={},t){switch(t.type){case Qt.c:return Object.assign({},t.payload);case Qt.a:const n=Object.assign(Object.assign({},e.dataComponentApp),t.payload.dataComponentApp);return Object.assign(Object.assign({},e),{dataComponentApp:n});case Qt.b:const r=Object.assign(Object.assign({},e.functionalComponentApp),t.payload.functionalComponentApp);return Object.assign(Object.assign({},e),{functionalComponentApp:r});default:return e}},controlManifests:function(e=null,t){if(-1===Ge.indexOf(t.type)||!t.payload||!t.payload.controlManifests)return e;const n=t.payload.controlManifests,r=Object.assign({},e);for(const e in n)r[e]=Object.assign(Object.assign({},r[e]),n[e]);return Object.freeze(r)},taskBasedFlows:Qe,taskBasedFlowGlobalMenu:Je,homePageConfigurations:function(e=null,t){if(-1===Ue.indexOf(t.type)||!t.payload||!t.payload.homePageConfigurations)return e;const n=t.payload.homePageConfigurations,r=Object.assign({},e);for(const e in n)r.hasOwnProperty(e)?Object.assign(r[e],n[e]):r[e]=n[e];return Object.freeze(r)},homePageBusinessLogics:function(e=null,t){if(-1===ze.indexOf(t.type)||!t.payload||!t.payload.homePageBusinessLogics)return e;const n=t.payload.homePageBusinessLogics,r=Object.assign({},e);for(const e in n)r.hasOwnProperty(e)?Object.assign(r[e],n[e]):r[e]=n[e];return Object.freeze(r)},labels:function(e=null,t){if(-1===$e.indexOf(t.type)||!t||!t.payload||!t.payload.labels)return e;const n=t.payload.labels,r=Object.assign({},e);for(const e in n)if(r.hasOwnProperty(e))for(const t in n[e])r[e].hasOwnProperty(t)&&n[e][t],r[e][t]=n[e][t];else r[e]=n[e];return Object.freeze(r)},ribbonsLabelIds:function(e=null,t){if(-1===ot.indexOf(t.type)||!t||!t.payload||!t.payload.ribbonsLabelIds)return e;const n=t.payload.ribbonsLabelIds,r=Object.assign(Object.assign({},e),n);return Object.freeze(r)},businessProcessFlows:(e,t)=>{switch(t.type){case et.a:return function(e,t){const n={};for(const r in e)t.payload.has(r)||(n[r]=e[r]);return Object.freeze(n)}(e,t);default:return nt(e,t)}},businessProcessFlowsDefault:rt,bpfDefaults:at,bpfSelectors:it,searchConfiguration:Oe,charts:function(e,t){if(!t||!t.payload||!t.payload.charts||0===Object.keys(t.payload.charts).length)return e;switch(t.type){case k.a:return function(e,t){const n={};for(const r in e)void 0===t.payload.charts[r]&&(n[r]=e[r]);return Object.freeze(n)}(e,t);case pt.f:const n=t.payload.charts,r=Object.assign({},e);for(const e in n)r[e].oDataInitialized=n[e].oDataInitialized;return Object.freeze(r);default:return gt(e,t)}},chartDefaults:function(e=null,t){if(-1===ft.indexOf(t.type)||!t.payload||!t.payload.chartDefaults)return e;const n=t.payload.chartDefaults,r=Object.assign({},e);for(const e in n)r[e]=n[e];return Object.freeze(r)},chartSelectors:function(e=null,t){if(-1===ft.indexOf(t.type)||!t.payload||!t.payload.chartSelectors)return e;const n=t.payload.chartSelectors,r=Object.assign({},e);for(const e in n)r[e]=n[e];return Object.freeze(r)},dashboards:ct,dashboardSelectors:function(e=null,t){if(-1===st.indexOf(t.type)||!t.payload||!t.payload.dashboardSelectors)return e;const n=t.payload.dashboardSelectors,r=Object.assign({},n),a=Object.keys(n);return a&&a.length?Object.freeze(r):e},dashboardsByNavPath:lt,dashboardsByEntityName:ut,dashboardSelectorsByEntityName:dt,webResources:_t,webResourceDescriptorsByName:vt,optionSets:function(e=mt,t){if(-1===ht.indexOf(t.type)||!t||!t.payload||!t.payload.optionSets)return e;const n=Object.assign({},e);for(const e in t.payload.optionSets.optionSetNameById)n.optionSetNameById[e]?n.optionSetNameById[e]=Object.assign(Object.assign({},n.optionSetNameById[e]),t.payload.optionSets.optionSetNameById[e]):n.optionSetNameById[e]=t.payload.optionSets.optionSetNameById[e];for(const e in t.payload.optionSets.optionSetByName)n.optionSetByName[e]?n.optionSetByName[e]=Object.assign(Object.assign({},n.optionSetByName[e]),t.payload.optionSets.optionSetByName[e]):n.optionSetByName[e]=t.payload.optionSets.optionSetByName[e];return Object.freeze(n)},appContext:
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t){let n=e;return t&&t.payload&&t.type&&t.payload.appContext&&(t.type===St.b||t.type===B.a||t.type===Ot.a)&&(n=Object.assign({},t.payload.appContext)),Object.freeze(n)},appShellSettings:function(e=It,t){switch(t.type){case Ct.a:return Object.freeze(Object.assign(Object.assign({},e),t.payload));case Et.a:if(e&&e.initialized===J.a.Initialized){const n=Object.freeze(Object.assign(Object.assign({},e.appNavSettings),{GroupsCollapsedState:t.payload}));return Object.freeze(Object.assign(Object.assign({},e),{appNavSettings:n}))}return Object.freeze(e);default:return Object.freeze(e)}},appModulesList:Bt,quickCreateMenu:jt,offlineSync:function(e=Dt,t){if(-1===Rt.indexOf(t.type))return e;const n=t&&t.payload&&t.payload.offlineSync||{},r=["downloadSize","downloadTime","parseTime","persistTime","localDBSize"];let a;return a=e&&null!==e.syncStatus&&void 0!==e.syncStatus&&e.syncStatus!==n.syncStatus&&n.syncStatus===At.a.InProgress?r.reduce((e,t)=>(e[t]=0,e),{}):r.reduce((t,r)=>{const a=n&&n[r],i=e&&e[r];return(a||i)&&(t[r]=(i||0)+(a||0)),t},{}),Object.freeze(Object.assign(Object.assign(Object.assign({},e),n),a))},offlineBPFEntities:Tt,metadataVersion:function(e=Mt,t){if(-1===xt.indexOf(t.type)||!t.payload||!t.payload.metadataVersion)return e;const n=Object.assign({},t.payload.metadataVersion);return e&&e.initialized!==J.a.Uninitialized&&(e.currentVersion!==n.currentVersion?n.lastVersion=e.currentVersion:n.lastVersion=e.lastVersion),Object.freeze(n)},userMetadataVersion:function(e=kt,t){if(-1===Ft.indexOf(t.type)||!t.payload||!t.payload.userMetadataVersion)return e;const n=Object.assign({},t.payload.userMetadataVersion);return e&&e.initialized!==J.a.Uninitialized&&(e.currentVersion!==n.currentVersion?n.lastVersion=e.currentVersion:n.lastVersion=e.lastVersion),Object.freeze(n)},complexControls:function(e=Vt,t){if(-1===Ut.indexOf(t.type)||!t.payload||!t.payload.complexControls)return e;const n=Object.assign(Object.assign({},e.complexControls),t.payload.complexControls.complexControls),r=Object.assign({},t.payload.complexControls);return r.complexControls=n,Object.freeze(r)},landingPageOfflineMetadata:qt,lookup:Gt,consistencyStrong:function(e,t){switch(t.type){case Kt.a:return t.payload;default:return e}}},$t=Object(w.a)(Jt);function Zt(e,t){if(t&&t.type===Ht.a){const n=Object.freeze(Object.assign(Object.assign({},e),t.payload));return $t(n,t)}return $t(e,t)}var en=n("HfZT"),tn=n("Dea/"),nn=n("WY/A"),rn=n("sX6v"),an=n("P+kM"),on=n("RrRQ"),sn=n("Pcet"),cn=n("YYhu"),ln=n("bi9n");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const un={};function dn(e,t,n){const r=Object.assign({},t),a=Object.assign({},n);for(const t of e)a[t]=r[t],delete r[t];return{from:r,to:a}}var pn=n("lY/Z"),fn=n("AFlp"),gn=n("k1f1"),hn=n("ycdb"),mn=n("c7jw"),bn=n("rodW"),yn=n("quej"),_n=n("ijzp"),vn=n("9692"),Sn=n("SnEr");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const On=["retrieve.grid.data.action",pn.a,pn.b,en.b,fn.a,gn.a,mn.a,bn.a,yn.a,_n.a,vn.a,Sn.a,hn.a],Cn={};function En(e,t){const n=Object.assign(Object.assign({},e.fields),t.fields);let r=[];r=e.queryColumnNames?t.queryColumnNames?e.queryColumnNames.concat(t.queryColumnNames.filter(t=>e.queryColumnNames.indexOf(t)<0)):e.queryColumnNames:t.queryColumnNames;let a=null;e.accessRights?a=t.accessRights?{recordPrivileges:t.accessRights.recordPrivileges,attributePrivileges:Object.assign(Object.assign({},e.accessRights.attributePrivileges),t.accessRights.attributePrivileges)}:e.accessRights:t.accessRights&&(a=t.accessRights);for(const e in n)(null===n[e]||t.queryColumnNames&&-1!==t.queryColumnNames.indexOf(e)&&!t.fields.hasOwnProperty(e)&&n.hasOwnProperty(e))&&delete n[e];const i={initialized:t.initialized,fields:n,queryColumnNames:r};return e.businessProcessFlowId&&(i.businessProcessFlowId=e.businessProcessFlowId),e.businessProcessFlowInstanceId&&(i.businessProcessFlowInstanceId=e.businessProcessFlowInstanceId),e.processInstanceModifiedTimestamp&&(i.processInstanceModifiedTimestamp=e.processInstanceModifiedTimestamp),a&&(i.accessRights=a),t.identifier&&(i.identifier=t.identifier),i}function In(e,t){let n=e;return t.businessProcessFlowId?n=Object.assign(Object.assign({},e),{businessProcessFlowId:t.businessProcessFlowId}):t.ignoreBpfOnRecord?n=Object.assign(Object.assign({},e),{ignoreBpfOnRecord:t.ignoreBpfOnRecord}):t.businessProcessFlowInstanceId?n=Object.assign(Object.assign({},e),{businessProcessFlowInstanceId:t.businessProcessFlowInstanceId}):t.processInstanceModifiedTimestamp?n=Object.assign(Object.assign({},e),{processInstanceModifiedTimestamp:t.processInstanceModifiedTimestamp}):null!=t.refreshGlobalNavigationData&&(n=Object.assign(Object.assign({},e),{refreshGlobalNavigationData:t.refreshGlobalNavigationData})),n}function wn(e,t,n,r){const a=r.payload.entities[t];if(a)if(n.hasOwnProperty(t)){n[t]=Object.assign({},e[t]);for(const o of Object.keys(a))if(n[t].hasOwnProperty(o)){const s=n[t][o];a[o].initialized!==J.a.Initialized?(n[t][o]=Object.assign({},e[t][o]),n[t][o].initialized=a[o].initialized):(i=r.type)===fn.a||i===gn.a||i===bn.a||i===yn.a||i===hn.a?n[t][o]=In(s,a[o]):n[t][o]=En(s,a[o])}else n[t][o]=a[o]}else n[t]=a;var i}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const jn=[pt.e,pt.d,pt.c,de.a,vn.a],Pn={};var Tn=n("odYE"),Nn=n("x0oY");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const An=[n("85o3").f],Rn={};var Dn=n("+pAH");const xn=[Dn.a],Mn={};
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Fn=["retrieve.grid.data.action",en.b,vn.a],kn={};const Ln={entities:function(e=Cn,t){if(-1===On.indexOf(t.type)||!t.payload||!t.payload.entities||0===Object.keys(t.payload.entities).length)return e;if(t.type===vn.a)return function(e=Cn,t){const n={};for(const r in e){const a=e[r],i=t.payload.entities[r];if(i)for(const e in a)void 0===i[e]&&(n[r]||(n[r]={}),n[r][e]=a[e]);else n[r]=a}return Object.freeze(n)}(e,t);if(t.type===Sn.a)return function(e=Cn,t){const n=e;return Object.keys(t.payload.entities).forEach(e=>{const r=t.payload.entities[e];r&&Object.keys(r).forEach(t=>{n&&n[e]&&n[e][t]&&delete n[e][t]})}),Object.freeze(n)}(e,t);const n=Object.assign({},e);for(const r of Object.keys(t.payload.entities))wn(e,r,n,t);return Object.freeze(n)},lists:function(e=kn,t){if(-1===Fn.indexOf(t.type)||!t||!t.payload||!t.payload.lists)return e;if(t.type===vn.a)return function(e,t){if(0===Object.keys(t.payload.lists).length)return e;const n={};for(const r in e)void 0===t.payload.lists[r]&&(n[r]=e[r]);return Object.freeze(n)}(e,t);let n=null;const r=Object.keys(t.payload.lists);if(!r||!r.length)return e;for(let a=0;a<r.length;a++){const i=r[a];if(e.hasOwnProperty(i)){n=Object.assign({},e);const r=t.payload.lists[i],a=e[i];let o=[];if(o=a.queryColumnNames?r.queryColumnNames?a.queryColumnNames.concat(r.queryColumnNames.filter(e=>a.queryColumnNames.indexOf(e)<0)):a.queryColumnNames:r.queryColumnNames,r.initialized===J.a.Initialized&&r.pages){let e=0;const t=Number(Object.keys(r.pages)[0]);a&&a.pages&&a.pages[t]?(e=a.pages[t].startIndex,0!==r.totalRecordCount?n[i].records.splice(e,a.pageSize,...r.records):n[i].records=[]):a&&a.records?(e=a.records.length,n[i].records=a.records.concat(r.records)):n[i].records=r.records;const o=r.pages[t];n[i].pages=Object.assign(Object.assign({},n[i].pages),{[t]:{startIndex:e,startGuid:o.startGuid,pagingCookie:o.pagingCookie,moreRecords:o.moreRecords}})}n[i].initialized=r.initialized,n[i].lastRetrieved=r.lastRetrieved,n[i].totalRecordCount=r.totalRecordCount,n[i].totalRecordCountLimitExceeded=r.totalRecordCountLimitExceeded,n[i].queryColumnNames=o}else n=Object.assign(Object.assign({},e),t.payload.lists)}return Object.freeze(n)},snapshots:function(e=un,t){switch(t.type){case an.a:{const{snapshotId:n,selectedFields:r}=t.meta,a=t.payload,i=e[n],o={snapshotId:n,identifier:i.identifier,mode:i.mode};if(r)if(a){const e=dn(r,i.activeChanges,i.lockedChanges);Object.keys(e.from).length&&(o.activeChanges=e.from),Object.keys(e.to).length&&(o.lockedChanges=e.to)}else{const e=dn(r,i.lockedChanges,i.activeChanges);Object.keys(e.to).length&&(o.activeChanges=e.to),Object.keys(e.from).length&&(o.lockedChanges=e.from)}else a?o.lockedChanges=i.activeChanges:o.activeChanges=Object.assign(Object.assign({},i.lockedChanges),i.activeChanges);const s=Object.assign(Object.assign({},e),{[n]:o});return Object.freeze(s)}case cn.a:{const n=t.meta,r=e[n],a=Object.assign({},r);delete a.lockedChanges;const i=Object.assign(Object.assign({},e),{[n]:a});return Object.freeze(i)}case on.a:{const n={};for(const r in e)r!==t.meta&&(n[r]=e[r]);return Object.freeze(n)}case nn.a:{const n=t.payload,r=Object.assign(Object.assign({},e),{[n.snapshotId]:n});return Object.freeze(r)}case rn.a:{const n=t.meta.snapshotId,r=t.payload,a=e[n];if(r&&Object.keys(r).length>0||t.meta&&t.meta.newId&&a.mode===tn.a.Create||t.meta&&1===t.meta.flavor){const i=0===t.meta.flavor?Object.assign(Object.assign({},a.activeChanges),r):r,o=Object.assign(Object.assign({},a),{activeChanges:i,identifier:t.meta.entityReference||a.identifier}),s=Object.assign(Object.assign({},e),{[n]:o});return Object.freeze(s)}return e}case sn.a:{const n=t.meta,r=t.payload,a=Object.assign(Object.assign({},e[n]),{identifier:r}),i=Object.assign(Object.assign({},e),{[n]:a});return Object.freeze(i)}case ln.a:{const n=t.meta,r=t.payload,a=Object.assign(Object.assign({},e[n]),{mode:r}),i=Object.assign(Object.assign({},e),{[n]:a});return Object.freeze(i)}default:return e}},lastSnapshotNumber:function(e=null,t){switch(t.type){case nn.a:return t.meta.nextSnapshotNumber;default:return e}},charts:function(e=Pn,t){if(-1===jn.indexOf(t.type)||!t||!t.payload||!t.payload.charts||0===Object.keys(t.payload.charts).length)return Object.freeze(e);if(t.type===vn.a)return function(e,t){const n={};for(const r in e)if(t.payload.charts[r])for(const a in e[r])void 0===t.payload.charts[r][a]&&(n[r]||(n[r]={}),n[r][a]=e[r][a]);else n[r]=e[r];return Object.freeze(n)}(e,t);let n=null;const r=Object.keys(t.payload.charts)[0];if(!r)return Object.freeze(e);if(e.hasOwnProperty(r)){n=Object.assign({},e);const a=Object.keys(t.payload.charts[r])[0];if(!a)return Object.freeze(e);n[r][a]=t.payload.charts[r][a]}else n=Object.assign(Object.assign({},e),t.payload.charts);return Object.freeze(n)},chartData:function(e={},t){if(-1===jn.indexOf(t.type)||!t||!t.payload||!t.payload.chartData||0===Object.keys(t.payload.chartData).length)return Object.freeze(e);if(t.type===vn.a)return function(e,t){const n={};for(const r in e)void 0===t.payload.chartData[r]&&(n[r]=e[r]);return Object.freeze(n)}(e,t);let n=null;const r=Object.keys(t.payload.chartData)[0];return r?(e.hasOwnProperty(r)?(n=Object.assign({},e),n[r]=t.payload.chartData[r]):n=Object.assign(Object.assign({},e),t.payload.chartData),Object.freeze(n)):Object.freeze(e)},notifications:
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e=[],t){let n=e;switch(t.type){case Nn.a:t.payload&&t.payload.notifications&&(n=function(e=[],t){const n=[];return t.forEach(e=>{e.forRecord&&n.push(e.forRecord)}),e.filter(e=>!e.forRecord||!n.find(t=>Tn.a.equals(t,e.forRecord))).concat(t)}(e,t.payload.notifications));break;case Nn.c:t.meta&&(n=function(e=[],t){return e.filter(e=>!e.forRecord||!Tn.a.equals(e.forRecord,t))}(e,t.meta))}return Object.freeze(n)},entityFilters:function(e=Rn,t){if(!t||-1===An.indexOf(t.type)||!t.payload||!t.payload.entityFilters)return e;const n=Object.assign(Object.assign({},e),t.payload.entityFilters);return Object.freeze(n)},files:function(e=Mn,t){if(!t||-1===xn.indexOf(t.type)||!t.payload)return e;const n=Object.assign({},e);return t.type===Dn.a?function(e,t){const n=t.payload.identifier;let r=Object.assign({},e);if(n){const a=n.etn,i=A.a.toString(n.id),o=t.payload.attributeName,s=t.payload.fileState,c={[i]:{[o]:s}},l={[a]:c};let u=Object.assign({},e);if(u)if(u[a])if(u[a][i]){const e=Object.assign(Object.assign({},u[a][i]),{[o]:s}),t=Object.assign(Object.assign({},u[a]),{[i]:e});u=Object.assign(Object.assign({},u),{[a]:t})}else{const e=Object.assign(Object.assign({},u[a]),c);u=Object.assign(Object.assign({},u),{[a]:e})}else{const e=Object.assign(Object.assign({},u[a]),c);u=Object.assign(Object.assign({},u),{[a]:e})}else u=Object.assign(Object.assign({},u),l);r=Object.assign({},u)}return Object.freeze(r)}(n,t):Object.freeze(n)}};Object(w.a)(Ln);var Bn=n("zVFX"),Un=n("q0Q1");function Vn(e,t){switch(t.type){case Un.a:return t.payload;default:return e}}function zn(){return{type:"deviceSize.retrieve",payload:{deviceWidth:Math.max(document.documentElement.clientWidth,window.innerWidth||0),deviceHeight:Math.max(document.documentElement.clientHeight,window.innerHeight||0)}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const qn={deviceWidth:1280};function Hn(e=qn,t){switch(t.type){case"deviceSize.retrieve":return Object.freeze(Object.assign(Object.assign({},e),t.payload));default:return e}}var Wn=n("9gmQ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const Gn={};function Kn(e=Gn,t){switch(t.type){case Wn.a:return e=Object.assign(Object.assign({},e),t.payload),Object.freeze(e);default:return e}}var Qn=n("zwYV");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const Xn={};function Yn(e=Xn,t){switch(t.type){case Qn.a:return e=Jn(e,t,!0),Object.freeze(e);case Qn.c:return e=Jn(e,t,!1),Object.freeze(e);case Qn.b:return e=Object.assign(Object.assign({},e),{knownProperties:t.payload}),Object.freeze(e);case Qn.d:return e=Object.assign(Object.assign({},e),{availableContexts:t.payload}),Object.freeze(e);case Qn.e:return e=Object.assign(Object.assign({},e),{knownProperties:Object.assign(Object.assign({},e.knownProperties),{[t.payload.contextId]:Object.assign(Object.assign({},e.knownProperties[t.payload.contextId]),{[t.payload.propertyId]:t.payload.value?t.payload.value.value:void 0})})}),Object.freeze(e);default:return e}}function Jn(e=Xn,t,n){const r=e.propertyListeners&&e.propertyListeners[t.payload.contextId],a=r&&r[t.payload.propertyId],i=n?function(e=[],t){return-1===e.findIndex(e=>e===t)?[...e,t]:e}(a,t.payload.listener):function(e=[],t){return e.filter(e=>e!==t)}(a,t.payload.listener);return Object.assign(Object.assign({},e),{propertyListeners:Object.assign(Object.assign({},e.propertyListeners),{[t.payload.contextId]:Object.assign(Object.assign({},r),{[t.payload.propertyId]:i})})})}var $n=n("D6Jg"),Zn=n("ZUus"),er=n("gqKu");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const tr=Object.freeze({isPreviewMode:!1,navbar:Zn.a.On,themeOption:er.a.Default,cmdbar:!0,performanceUiEnabled:!1,sitemap:!0,flags:{}});function nr(e=tr,t){switch(t.type){case $n.a:return Object.freeze(Object.assign(Object.assign({},e),t.payload));case I.a:return Object.freeze(Object.assign(Object.assign({},e),{performanceUiEnabled:t.payload}));default:return e}}var rr=n("83Lp"),ar=n("xM/W"),ir=n("CvZq");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const or=Object.freeze({isReconnectNotificationShown:!1,showReconnectNotificationAfterUpsync:!1,isServerUnavailableNewSession:!0,type:ir.a.NonBlockingUI,isReconnectSuccessful:!0});function sr(e=or,t){switch(t.type){case rr.d:case rr.b:case rr.a:case rr.c:case ar.a:return Object.freeze(Object.assign(Object.assign({},e),t.payload));default:return e}}var cr=n("3eJf");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const lr=[n("kX6F").a,Y.c];var ur=n("JEGW");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const dr={controls:cr.a,selectedForms:function(e=null,t){if(!t||!t.payload||!t.payload.selectedForms||-1===lr.indexOf(t.type))return e;const n=t.payload.selectedForms;let r=null;r=Object.assign({},e);for(const e of Object.keys(n))r[e]=n[e];return Object.freeze(r)},recordSetNavigatorCollapse:function(e=!0,t){return t.type===ur.a?t.payload.collapsed:e}},pr=Object(w.a)(dr);var fr=n("I/gz");const gr={presence:function(e={},t){switch(t.type){case fr.d:return function(e={},t){const n=Object.assign(Object.assign({},e),{[t.payload.id]:t.payload.status});return Object.freeze(n)}(e,t);case fr.b:return function(e={},t){const n=t.payload,r=Object.assign({},e);for(const e of n)delete r[e];return Object.freeze(r)}(e,t);default:return e}},profilePhoto:function(e={},t){switch(t.type){case fr.e:return function(e={},t){const n=Object.assign(Object.assign({},e),{[t.payload.id]:t.payload.blobUrl});return Object.freeze(n)}(e,t);case fr.c:return function(e={},t){const n=t.payload,r=Object.assign({},e);for(const e of n)delete r[e];return Object.freeze(r)}(e,t);default:return e}}},hr=Object(w.a)(gr);var mr=n("mpSO"),br=n("7Mzt"),yr=n("I4Rv"),_r=n("P86a");const vr=Object(w.b)("controlId",(
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t){switch(t.type){case ye.j:case ye.f:case ye.e:return Object.assign(Object.assign({},e),t.payload);default:return e}}));const Sr=Object(w.d)({[mr.j]:(e,t)=>t.payload.initializationState},_r.a.Uninitialized);const Or=Object(w.b)("flyoutControlId",(function(e,t){switch(t.type){case ye.p:return Object.assign(Object.assign({},e),t.payload.injectedXML);default:return e}})),Cr=Object(w.a)({controlsMap:function(e,t){let n=Object.assign({},e);switch(t.type){case ye.k:return t.payload.stateUpdates.forEach(e=>{n=Object.assign(Object.assign({},n),vr(n,e))}),n;case ye.d:return t.payload.evaluatedRules.forEach(e=>{n=Object.assign(Object.assign({},n),vr(n,e))}),n;default:return e}},initializationState:Sr,ruleContext:function(e,t){switch(t.type){case ye.s:return Object.assign(Object.assign({},e),t.payload.ruleContext);default:return e}},ribbonId:function(e,t){switch(t.type){case ye.r:return t.payload.ribbonId;default:return e}},injectedXML:Or,contextToken:function(e,t){switch(t.type){case ye.n:return Object.assign(Object.assign({},e),t.payload.contextToken);default:return e}},createdScriptContainer:function(e,t){switch(t.type){case ye.o:return t.payload.createdScriptContainer;default:return e}},controlAllowList:function(e,t){switch(t.type){case ye.m:return t.payload.controlAllowList?Object.assign({},t.payload.controlAllowList):null;default:return e}},nonCacheableRules:function(e,t){switch(t.type){case ye.q:return Object.assign(Object.assign({},e),t.payload.nonCacheableRules);default:return e}},pageId:function(e,t){switch(t.type){case yr.a:return t.payload;default:return e}},addedCommandList:function(e,t){switch(t.type){case mr.m:return t.payload;default:return e}},appendedCommandList:function(e,t){switch(t.type){case mr.n:return t.payload;default:return e}}}),Er=Object(w.b)("commandManagerId",Cr);function Ir(e,t){switch(t.type){case ye.a:return function(e,t){switch(t.type){case ye.a:const n=t.payload;if(!n||0===n.length)return e;const r={};for(const t in e)-1===n.indexOf(t)&&(r[t]=e[t]);return r;default:return e}}(e,t);case br.a:return function(e,t){return Object.freeze(Object.assign(Object.assign({},e),{perfRenderCmdBar:t.payload.perfRenderCmdBar}))}(e,t);default:return Er(e,t)}}var wr=n("K+04");const jr=Object(w.a)({copresenceUsers:function(e={},t){if(t.type===wr.c){const n=Object.assign(Object.assign({},e),t.payload.copresenceUsers);return Object.freeze(n)}return e},currentUserSessionId:function(e,t){return t.type===wr.b&&void 0!==t.payload?t.payload:e}});var Pr=n("/J/l");const Tr={records:null,relevanceRecords:null,totalCountString:"",currentSearchText:"",controlStateId:"",isControlDisabled:!1,searchWidgetActionResult:null,selectedResult:"",filterQueryParams:null,numberOfResults:null,blockClick:null},Nr={list:{}},Ar=[Pr.e,Pr.g,Pr.a,Pr.b,Pr.c,Pr.f,Pr.d];function Rr(e=Nr,t){if(-1===Ar.indexOf(t.type)||!t||!t.meta.contextKey)return e;const n=t.meta.contextKey;n in e.list||(e.list[n]=Object.freeze(Object.assign({},Tr)));const r=A.a.toString(A.a.newGuid());let a;switch(t.type){case Pr.e:a=Object.freeze(Object.assign(Object.assign({},e.list[n]),{currentSearchText:t.payload.currentSearchText,controlStateId:t.payload.keyPhrasesString?r:e.list[n].controlStateId}));break;case Pr.g:a=Object.freeze(Object.assign(Object.assign({},e.list[n]),{records:t.payload.records,totalCountString:t.payload.records?t.payload.records.length:"0",loading:!1,isInitializing:!1}));break;case Pr.a:a=Object.freeze(Object.assign(Object.assign({},e.list[n]),{searchWidgetActionResult:t.payload,isInitializing:!1}));break;case Pr.b:a=Object.freeze(Object.assign(Object.assign({},e.list[n]),{selectedResult:t.payload.selectedResult,isInitializing:!1}));break;case Pr.c:a=Object.freeze(Object.assign(Object.assign({},e.list[n]),{filterQueryParams:t.payload.filterQueryParams,isInitializing:!1}));break;case Pr.f:a=Object.freeze(Object.assign(Object.assign({},e.list[n]),{numberOfResults:t.payload.numberOfResults,controlStateId:r,isInitializing:!1}));break;case Pr.d:a=Object.freeze(Object.assign(Object.assign({},e.list[n]),{blockClick:t.payload.blockClick,controlStateId:r,isInitializing:!1}));break;default:a=e.list[n]}const i={};return i[n]=a,Object.freeze({list:Object.assign(Object.assign({},e.list),i)})}var Dr=n("uUCw");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const xr={type:null,installationId:null,subtype:null,version:null,deviceModel:null,deviceTelemetryParams:null};function Mr(e=xr,t){switch(t.type){case Dr.a:return Object.assign(Object.assign({},e),{type:t.payload});case Dr.d:return Object.assign(Object.assign({},e),{installationId:t.payload});case Dr.e:return Object.assign(Object.assign({},e),{subtype:t.payload});case Dr.f:return Object.assign(Object.assign({},e),{version:t.payload});case Dr.b:return Object.assign(Object.assign({},e),{deviceModel:t.payload});case Dr.c:return Object.assign(Object.assign({},e),{deviceTelemetryParams:t.payload});default:return e}}var Fr=n("K9oF");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function kr(e){return{type:"authentication.set.reauth.failed",payload:e}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const Lr={token:void 0,objectid:void 0,tenantid:void 0,reauthfailed:!1,cookiesblocked:!1};function Br(e=Lr,t){switch(t.type){case Fr.c:return Object.assign(Object.assign({},e),{token:t.payload});case Fr.a:return Object.assign(Object.assign({},e),{objectid:t.payload});case Fr.b:return Object.assign(Object.assign({},e),{tenantid:t.payload});case"authentication.set.reauth.failed":return Object.assign(Object.assign({},e),{reauthfailed:t.payload});case Fr.d:return Object.assign(Object.assign({},e),{cookiesblocked:t.payload});default:return e}}var Ur=n("SX+A"),Vr=n("sclX"),zr=n("wJNo");function qr(e){return{type:"deviceSettings.initialize",payload:e}}var Hr=n("db6h");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const Wr={};const Gr={features:function(e=Wr,t){switch(t.type){case"deviceSettings.initialize":return Object.keys(t.payload).forEach(n=>{e=Object.assign(Object.assign({},e),{[n]:Object.assign(Object.assign({},e[n]),t.payload[n])})}),Object.freeze(e);case zr.a:return e=Object.assign(Object.assign({},e),t.payload),Object.freeze(e);case Hr.a:return Object.keys(t.payload).forEach(n=>{e=Object.assign(Object.assign({},e),{[n]:Object.assign(Object.assign({},e[n]),t.payload[n])})}),Object.freeze(e);default:return e}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */,type:function(e=Vr.b.Web,t){switch(t.type){case Ur.b:return t.payload.type;default:return e}},state:function(e=Vr.a.Active,t){switch(t.type){case Ur.b:return t.payload.state;case Ur.a:return t.payload;default:return e}}},Kr=Object(w.a)(Gr);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var Qr;!function(e){e[e.Day=0]="Day",e[e.Week=1]="Week",e[e.Month=2]="Month"}(Qr||(Qr={}));var Xr=n("omKH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const Yr={defaultCalendarView:Qr.Day,recordsPerPage:50,timeZoneCode:0,workDayStartTime:"",workDayStopTime:""};var Jr=n("ORpD");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const $r={toastNotification:null};
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Zr={personalSettingsForMobileApp:function(e=Yr,t){switch(t.type){case Xr.a:return e=Object.assign(Object.assign({},e),t.payload),Object.freeze(e);default:return e}},userAccessibilitySettings:function(e=$r,t){switch(t.type){case Jr.a:return e=Object.assign(Object.assign({},e),t.payload),Object.freeze(e);default:return e}}},ea=Object(w.a)(Zr);var ta=n("bwbe"),na=n("uCpV"),ra=n("uWQm"),aa=n("A2T2");function ia(e){return{type:"recentItem.lastsynced.update",payload:e}}var oa=n("2bwe");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const sa={lastSynced:null,recentItems:[],deletedRecentItems:[],flyoutRecentsDescriptor:null,dropdownRecentsDescriptor:null};function ca(e=sa,t){let n;switch(t.type){case na.a:n=function(e,t){const n=e.recentItems,r=t.payload,a=n.findIndex(e=>e.ObjectId.guid===r.ObjectId.guid);let i;if(a>=0){const e=Object.assign(Object.assign({},r),{PinStatus:n[a].PinStatus});s=e,c=a,i=[...(o=n).slice(0,c),s,...o.slice(c+1)]}else i=ga(n,r);var o,s,c;return Object.assign(Object.assign({},e),{recentItems:i})}(e,t);break;case ra.a:n=la(e,[t.payload.id],t.payload.isOnline);break;case ra.b:n=la(e,t.payload.ids,t.payload.isOnline);break;case aa.a:n=pa(e,t.payload,!0);break;case aa.b:n=pa(e,t.payload,!1);break;case oa.a:n=function(e,t){const{dropdownRecentsDescriptor:n}=e;if(n&&n.isOpened&&n.relativeToEntryId===t.payload.relativeToEntryId)return function(e){const{dropdownRecentsDescriptor:t}=e,n=Object.assign({},t);return n.isOpened=!1,Object.assign(Object.assign({},e),{dropdownRecentsDescriptor:n})}(e);return function(e,t){const n=Object.assign(Object.assign({},t),{isOpened:!0});return Object.assign(Object.assign({},e),{dropdownRecentsDescriptor:n})}(e,t.payload)}(e,t);break;case ta.a:n=function(e,t){const n=e.recentItems,r=ua(t.oldRecents,n),a=ua(n,t.oldRecents),i=[...ua(t.newRecents,r),...a],o=function(e,t){const n={};[...e,...t].reduce((e,t)=>{if(t){const n=e[t.ObjectId.guid];!n||void 0!==n.PinStatus&&null!==n.PinStatus&&void 0!==t.PinStatus&&null!==t.PinStatus||(void 0!==t.PinStatus&&null!==t.PinStatus?n.PinStatus=t.PinStatus:void 0!==n.PinStatus&&null!==n.PinStatus&&(t.PinStatus=n.PinStatus)),e[t.ObjectId.guid]=!n||n.LastAccessed<t.LastAccessed?t:n}return e},n);const r=Object.keys(n).map(e=>n[e]),a=da(r.filter(e=>!0===e.PinStatus),25),i=da(r.filter(e=>!e.PinStatus),50);return[...a,...i]}(n,i);return Object.assign(Object.assign({},e),{recentItems:o})}(e,t.payload);break;case"recentItem.removeRecentItemsFromState":n=function(e,t){if(!t||!t.length)return e;const n=ua(e.deletedRecentItems,t),r=ua(e.recentItems,t);return Object.assign(Object.assign({},e),{deletedRecentItems:n,recentItems:r})}(e,t.payload);break;case"recentItem.lastsynced.update":n=function(e,t){const{lastSynced:n}=e,r=t.payload>n?t.payload:n;return Object.assign(Object.assign({},e),{lastSynced:r})}(e,t);break;default:return e}return Object.freeze(n)}function la(e,t,n){const r=[],a=[...e.deletedRecentItems],i=e.recentItems;return i&&i.forEach(e=>{t.some(t=>A.a.equals(e.ObjectId,t))?n&&a.push(e):r.push(e)}),Object.assign(Object.assign({},e),{recentItems:r,deletedRecentItems:a})}function ua(e,t){return e.filter(e=>!t.some(t=>A.a.equals(e.ObjectId,t.ObjectId)))}function da(e,t){if(e.length<=t)return e;return e.sort((e,t)=>+e.LastAccessed-+t.LastAccessed).splice(e.length-t)}function pa(e,t,n){const r=e.recentItems,a=r.findIndex(e=>e.ObjectId.guid===t.ObjectId.guid);if(a<0)return console.error("Attempting change pin status for item which is not in state. Item: "+JSON.stringify(t)),e;const i=ga([...r.slice(0,a),...r.slice(a+1)],Object.assign(Object.assign({},t),{PinStatus:n,LastAccessed:new Date}));return Object.assign(Object.assign({},e),{recentItems:i})}function fa(e,t,n){return e.push(t),da(e,n)}function ga(e,t){let n=e.filter(e=>!0===e.PinStatus),r=e.filter(e=>!e.PinStatus);return t.PinStatus?n=fa(n,t,25):r=fa(r,t,50),[...n,...r]}var ha=n("FETf");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const ma={},ba=[ha.d,ha.b,ha.c,ha.e,ha.f,ha.m,ha.l,ha.g,ha.k,ha.n,ha.j];function ya(e=ma,t){if(-1===ba.indexOf(t.type)||!t||!t.payload||!t.type)return e;const n=Object.assign({},e);switch(t.type){case ha.d:n[t.payload.id]=Object.assign({},t.payload.timlineWallResetDataState);break;case ha.b:n[t.payload.id]=Object.assign({},n[t.payload.id]),n[t.payload.id].dataQueues=Object.assign(Object.assign({},n[t.payload.id].dataQueues),t.payload.timlineWallInitDataState.dataQueues),n[t.payload.id].requestStatusMap=Object.assign(Object.assign({},n[t.payload.id].requestStatusMap),t.payload.timlineWallInitDataState.requestStatusMap);break;case ha.c:n[t.payload.id]=Object.assign({},n[t.payload.id]),n[t.payload.id].dataQueues=Object.assign(Object.assign({},n[t.payload.id].dataQueues),t.payload.dataQueues);break;case ha.e:n[t.payload.id]=Object.assign({},n[t.payload.id]),n[t.payload.id].responsesStatus=[...n[t.payload.id].responsesStatus||[],t.payload.responseStatus];break;case ha.f:n[t.payload.id]=Object.assign({},n[t.payload.id]),n[t.payload.id].requestStatusMap=Object.assign(Object.assign({},n[t.payload.id].requestStatusMap),t.payload.timlineWallDataState.requestStatusMap),n[t.payload.id].target=Object.assign(Object.assign({},n[t.payload.id].target),t.payload.timlineWallDataState.target);break;case ha.m:n[t.payload.id]=Object.assign({},n[t.payload.id]),n[t.payload.id].recordLastAccessedTime=t.payload.recordLastAccessedTime;break;case ha.l:n[t.payload.id]=Object.assign({},n[t.payload.id]),n[t.payload.id].entityRecentItems=Object.assign(Object.assign({},n[t.payload.id].entityRecentItems),t.payload.entityRecentItems);break;case ha.g:n[t.payload.id]=Object.assign({},n[t.payload.id]),n[t.payload.id].isMetadataRetrievalError=t.payload.isMetadataRetrievalError;break;case ha.k:n[t.payload.id]=Object.assign({},n[t.payload.id]),n[t.payload.id].isNotesAnalysisEnabled=t.payload.isNotesAnalysisEnabled;break;case ha.n:n[t.payload.id]=Object.assign({},n[t.payload.id]),n[t.payload.id].target=Object.assign(Object.assign({},n[t.payload.id].target),t.payload.target);break;case ha.j:n[t.payload.id]=Object.assign({},n[t.payload.id]),n[t.payload.id].emailAction=t.payload.emailAction,n[t.payload.id].contextualDialogEntityData=Object.assign(Object.assign({},n[t.payload.id].contextualDialogEntityData),t.payload.contextualDialogEntityData)}return Object.freeze(n)}var _a=n("D4rv"),va=n("ScZZ"),Sa=n("+uwx");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function Oa(e={},t){switch(t.type){case va.a:return function(e,t){return Object.freeze(Object.assign(Object.assign({},e),{[t.payload.props.id]:t.payload}))}(e,t);case va.c:return function(e,t){const n=e,r=t.payload,a=(n[r],Object(_a.d)(n,["symbol"==typeof r?r:r+""]));return Object.freeze(a)}(e,t);case Sa.a:return function(e,t){return Object.freeze(Object.assign(Object.assign({},e),{[t.payload.props.appNotificationId]:t.payload.props}))}(e,t);case Sa.c:return function(e,t){const n=e,r=t.payload,a=(n[r],Object(_a.d)(n,["symbol"==typeof r?r:r+""]));return Object.freeze(a)}(e,t);case Sa.b:return function(e,t){const n=t.payload,r=Object.assign({},e);return n.forEach(e=>{delete r[e]}),Object.freeze(r)}(e,t);case va.b:return Object.freeze({});default:return e}}var Ca=n("XIaj"),Ea=n("yGgp");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function Ia(e={},t){switch(t.type){case Ca.a:return function(e,t){const n={[t.payload.props.id]:t.payload};return Object.freeze(Object.assign(Object.assign({},e),n))}(e,t);case Ea.a:return function(e,t){const n=e,r=t.payload,a=(n[r],Object(_a.d)(n,["symbol"==typeof r?r:r+""]));return Object.freeze(a)}(e,t);default:return e}}var wa=n("1wvP");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function ja(e={initialized:!1,isNotificationPanelVisible:!1,appNotificationIds:[],isNotificationSettingsPanelVisible:!1},t){switch(t.type){case wa.d:const n={initialized:t.payload.initialized};return Object.freeze(Object.assign(Object.assign({},e),n));case wa.e:const r={isNotificationPanelVisible:t.payload.isNotificationPanelVisible};return Object.freeze(Object.assign(Object.assign({},e),r));case wa.f:const a={isNotificationSettingsPanelVisible:t.payload.isNotificationSettingsPanelVisible};return Object.freeze(Object.assign(Object.assign({},e),a));case wa.a:const i=[...t.payload];return Object.freeze(Object.assign(Object.assign({},e),{appNotificationIds:i}));case wa.c:const o=t.payload,s=e.appNotificationIds.filter(e=>e!==o);return Object.freeze(Object.assign(Object.assign({},e),{appNotificationIds:s}));case wa.b:return Object.freeze(Object.assign(Object.assign({},e),{appNotificationIds:[]}));default:return e}}var Pa=n("aT9V");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Ta(e={},t){switch(t.type){case Pa.a:return function(e,t){const n=t.payload,r={};if(Object.keys(t.payload).forEach(t=>{void 0===e[t]&&(r[t]=n[t])}),0===Object.keys(r).length)return e;return Object.freeze(Object.assign(Object.assign({},e),r))}(e,t);case Pa.c:return function(e,t){const n=e,r=t.payload,a=(n[r],Object(_a.d)(n,["symbol"==typeof r?r:r+""]));return Object.freeze(a)}(e,t);case Pa.b:return function(e,t){const n=t.payload,r=Object.assign({},e);return n.forEach(e=>{delete r[e]}),Object.freeze(r)}(e,t);default:return e}}var Na=n("idRo");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Aa(e={},t){switch(t.type){case Na.a:return Object.freeze(Object.assign(Object.assign({},e),t.payload));case Na.b:const n=Object.assign({},e);return n[t.payload.name].value=t.payload.value,t.payload.id&&(n[t.payload.name].id=t.payload.id),Object.freeze(n);default:return e}}var Ra=n("jCkl"),Da=n("yJdb"),xa=n("LMh4");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Ma={inProgress:!1,progressMessage:null};function Fa(e=Ma,t){switch(t.type){case Ra.a:case Da.a:case xa.a:return Object.freeze(Object.assign(Object.assign({},e),t.payload));default:return e}}var ka=n("eL04"),La=n("P+p9");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function Ba(e={},t){switch(t.type){case ka.a:return function(e,t){const n={[t.payload.props.id]:t.payload};return Object.freeze(Object.assign(Object.assign({},e),n))}(e,t);case La.a:return function(e,t){return delete(e=Object.assign({},e))[t.payload],Object.freeze(e)}(e,t);default:return e}}var Ua=n("Oz8S");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const Va={ribbons:Ua.d,entities:Ua.c},za={metadata:Object(w.a)(Va),data:vn.c},qa=Object(w.a)(za);function Ha(e){return{type:"cache.set.codecachestatus",payload:{codeCacheState:e}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const Wa=Object.freeze({isCacheEnabled:!1,codeCacheState:1});function Ga(e=Wa,t){switch(t.type){case"cache.setcachestatus":case"cache.set.codecachestatus":return Object.freeze(Object.assign(Object.assign({},e),t.payload));default:return e}}var Ka=n("OpjU");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const Qa=[Ka.a],Xa=Object(w.c)(Qa,{isReauthInProgress:!1});function Ya(e,t){return{type:"session.hostData.set",payload:{key:e,value:t}}}const Ja=Object(w.a)({hostData:function(e=[],t){if("session.hostData.set"===t.type&&t.payload){const n=e.slice(0);return n.push({key:t.payload.key,value:t.payload.value}),Object.freeze(n)}return e},hostSubtype:function(e,t){if("session.hostSubtype.set"===t.type&&void 0!==t.payload)return t.payload;return e},hostType:function(e,t){if("session.hostType.set"===t.type&&void 0!==t.payload)return t.payload;return e},hostOptionInitialized:function(e,t){if("session.hostOptionsInitialized.set"===t.type&&void 0!==t.payload)return t.payload;return e},playerName:function(e,t){if("session.playerName.set"===t.type&&void 0!==t.payload)return t.payload;return e}});var $a=n("LqfC"),Za=n("/leX"),ei=n("xggx");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const ti={panes:[],selectedPane:void 0,panesState:1},ni={appPaneDescriptors:{1:ti,2:ti},panes:{}};function ri(e=ni,t){const n=function(e,t){const n=t.payload&&t.payload.sidePanelId;if(!n)return e;const r=e[n];let a=r;if(t.type===$a.g)t.payload.type===Za.b.Pane?r||(a=t.payload):(!r||r.type!==Za.b.Pane&&r.sidePanelLoadState===Za.a.NotStarted)&&(a=Object.assign(Object.assign({},t.payload),{sidePanelLoadState:Za.a.Loading}));else if(t.type===$a.b){if(-1!==Object.keys(e).indexOf(n)){const t=e,r=n,a=(t[r],Object(_a.d)(t,["symbol"==typeof r?r:r+""]));return Object.freeze(a)}}else a=function(e,t){const n=function(e,t){if($a.h===t.type)return Za.a.Completed;return e}(e.sidePanelLoadState,t),r=function(e={},t){if(!t.payload)return e;const n=function(e,t){if($a.j===t.type&&t.payload.sidePanelWidth)return t.payload.sidePanelWidth;return e}(e.sidePanelWidth,t),r=function(e,t){if($a.j===t.type&&!Object(T.a)(t.payload.sidePanelState))return t.payload.sidePanelState;return e}(e.sidePanelState,t),a=function(e,t){if(ii(t))return t.payload.sidePanelPosition;return e}(e.sidePanelPosition,t),i=function(e,t){if($a.j===t.type&&!Object(T.a)(t.payload.sidePanelTitle))return t.payload.sidePanelTitle;return e}(e.sidePanelTitle,t),o=function(e,t){if($a.j===t.type&&!Object(T.a)(t.payload.canBeClosed))return t.payload.canBeClosed;return e}(e.canBeClosed,t),s=function(e,t){if($a.j===t.type&&!Object(T.a)(t.payload.canBeCollapsed))return t.payload.canBeCollapsed;return e}(e.canBeCollapsed,t),c=function(e,t){if($a.j===t.type&&!Object(T.a)(t.payload.isTitleStatic))return t.payload.isTitleStatic;return e}(e.isTitleStatic,t),l=function(e,t){if($a.j===t.type&&!Object(T.a)(t.payload.showTitle))return t.payload.showTitle;return e}(e.showTitle,t),u=function(e,t){if($a.j===t.type&&!Object(T.a)(t.payload.sidePanelDefaultCollapsedBehavior))return t.payload.sidePanelDefaultCollapsedBehavior;return e}(e.sidePanelDefaultCollapsedBehavior,t),d=function(e,t){if($a.j===t.type&&!Object(T.a)(t.payload.imageSrc))return t.payload.imageSrc;return e}(e.imageSrc,t),p=function(e,t){if($a.j===t.type&&!Object(T.a)(t.payload.hidden))return t.payload.hidden;return e}(e.hidden,t),f=function(e,t){if($a.j===t.type&&!Object(T.a)(t.payload.badge))return t.payload.badge;return e}(e.badge,t),g=function(e,t){if($a.j===t.type&&!Object(T.a)(t.payload.alwaysRender))return t.payload.alwaysRender;return e}(e.alwaysRender,t),h=function(e,t){if($a.j===t.type&&!Object(T.a)(t.payload.keepBadgeOnSelect))return t.payload.keepBadgeOnSelect;return e}(e.keepBadgeOnSelect,t);if(n!==e.sidePanelWidth||r!==e.sidePanelState||a!==e.sidePanelPosition||i!==e.sidePanelTitle||o!==e.canBeClosed||s!==e.canBeCollapsed||c!==e.isTitleStatic||l!==e.showTitle||u!==e.sidePanelDefaultCollapsedBehavior||d!==e.imageSrc||p!==e.hidden||f!==e.badge||g!==e.alwaysRender||h!==e.keepBadgeOnSelect){const t={sidePanelWidth:n,sidePanelState:r,sidePanelPosition:a,sidePanelTitle:i,sidePanelDefaultCollapsedBehavior:u,canBeClosed:o,canBeCollapsed:s,isTitleStatic:c,showTitle:l,badge:f,hidden:p,imageSrc:d,alwaysRender:g,keepBadgeOnSelect:h};return Object.freeze(Object.assign(Object.assign({},e),t))}return e}(e.option,{type:t.type,payload:t.payload.option});if(n!==e.sidePanelLoadState||r!==e.option)return Object.freeze(Object.assign(Object.assign({},e),{sidePanelLoadState:n,option:r}));return e}(r,t);r!==a&&(e=Object.freeze(Object.assign(Object.assign({},e),{[n]:a})));return e}(e.panes,t),r=function(e,t){var n,r,a;let i=e.appPaneDescriptors;const o=function(e,t){var n,r,a,i,o;if(t.type===$a.m||t.type===$a.k)return t.meta.position;return(null===(r=null===(n=t.payload)||void 0===n?void 0:n.option)||void 0===r?void 0:r.sidePanelPosition)||(null===(o=null===(i=e.panes[null===(a=t.payload)||void 0===a?void 0:a.sidePanelId])||void 0===i?void 0:i.option)||void 0===o?void 0:o.sidePanelPosition)}(e,t);if(o&&ii(t)){const o=null===(a=null===(r=e.panes[null===(n=t.payload)||void 0===n?void 0:n.sidePanelId])||void 0===r?void 0:r.option)||void 0===a?void 0:a.sidePanelPosition,s=ai(i[o],t,!1,e);s!==i[o]&&(i=Object.assign(Object.assign({},i),{[o]:s}))}if(o){const n=ai(i[o],t,!!ii(t)||void 0,e);n!==i[o]&&(i=Object.assign(Object.assign({},i),{[o]:n}))}return i}(e,t);if(n!==e.panes||r!==e.appPaneDescriptors){const t={panes:n,appPaneDescriptors:r};return Object.freeze(Object.assign(Object.assign({},e),t))}return e}function ai(e,t,n,r){const a=function(e,t,n){const r=t.payload.sidePanelId;let a=e.panes;if(t.type===$a.g||n)a=[...a,r];else if((t.type===$a.b||!1===n)&&a.includes(r))return a.filter(e=>e!==r);return a}(e,t,n),i=function(e,t,n,r){const a=t.payload.sidePanelId;if(t.type===$a.g&&t.meta.isSelected||t.type===$a.m||n)return a;if((t.type===$a.b||!1===n||function(e){var t,n;return e.type===$a.j&&!0===(null===(t=e.payload.option)||void 0===t?void 0:t.hidden)||$a.j===e.type&&2===(null===(n=e.payload.option)||void 0===n?void 0:n.sidePanelState)}(t))&&e.selectedPane===a){const t=e.panes.filter(e=>Object(ei.c)(r.panes[e]));if(t.length>1){const e=t.indexOf(a);return t[(0===e?1:e-1)%t.length]}return}return e.selectedPane}(e,t,n,r),o=function(e,t){if(t.type===$a.k)return t.payload.panesState;if(t.type===$a.g&&t.meta.isSelected)return 1;return e.panesState}(e,t);if(a!==e.panes||i!==e.selectedPane||o!==e.panesState){const t={panes:a,selectedPane:i,panesState:o};return Object.freeze(Object.assign(Object.assign({},e),t))}return e}function ii(e){var t;return!($a.j!==e.type||Object(T.a)(e.payload.sidePanelPosition)&&Object(T.a)(null===(t=e.payload.option)||void 0===t?void 0:t.sidePanelPosition))}var oi=n("0FMG");const si={};function ci(e=si,t){switch(t.type){case oi.a:const n=t.payload.selectedAreaId;if(n!==e.selectedAreaId)return Object.freeze(Object.assign(Object.assign({},e),{selectedAreaId:n}));break;case oi.b:const r=t.payload.selectedSubAreaId;if(r!==e.selectedSubAreaId)return Object.freeze(Object.assign(Object.assign({},e),{selectedSubAreaId:r}));break;case oi.c:const a=t.payload.sitemapExpandedState;if(a!==e.sitemapExpandedState)return Object.freeze(Object.assign(Object.assign({},e),{sitemapExpandedState:a}))}return e}var li=n("EkzE"),ui=n("eagp");const di={modalComponentsOpenState:{}};function pi(e=di,t){switch(t.type){case ui.b:{const n=t.payload.modalId;if(n&&!e.modalComponentsOpenState[n]){const t=Object.assign(Object.assign({},e.modalComponentsOpenState),{[n]:!0});return Object.assign(Object.assign({},e),{modalComponentsOpenState:t})}break}case ui.a:{const n=t.payload.modalId;if(n&&e.modalComponentsOpenState[n]){const t=Object.assign(Object.assign({},e.modalComponentsOpenState),{[n]:!1});return Object.assign(Object.assign({},e),{modalComponentsOpenState:t})}break}default:return e}return e}var fi=n("Zn5P");const gi={indicatorNotifications:[]};function hi(e=gi,t){const n=function(e,t){return t.payload?t.type===fi.a?[...e,t.payload]:t.type===fi.b?e.filter(e=>e.id!==t.payload):e:e}(e.indicatorNotifications,t);return n!==e.indicatorNotifications?Object.assign(Object.assign({},e),{indicatorNotifications:n}):e}var mi=n("VnTQ");const bi={hideLongPressTooltip:!1,tooltipDismissCount:0};function yi(e=bi,t){if(void 0===t.payload)return e;if(t.type===mi.b){const n=t.payload;if(n.hideLongPressTooltip!==e.hideLongPressTooltip||n.tooltipDismissCount!==e.tooltipDismissCount){const t={};return void 0!==n.hideLongPressTooltip&&(t.hideLongPressTooltip=n.hideLongPressTooltip),void 0!==n.tooltipDismissCount&&(t.tooltipDismissCount=n.tooltipDismissCount),Object.assign(Object.assign({},e),t)}}if(t.type===mi.a&&t.payload!==e.hideLongPressTooltip){return{hideLongPressTooltip:t.payload,tooltipDismissCount:t.payload?e.tooltipDismissCount+1:e.tooltipDismissCount}}return e}var _i=n("IYuw"),vi=n("txA/"),Si=n("Kxpb"),Oi=n("x6/I");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Ci={};function Ei(e=Ci,t){return t.type===Oi.a?Object.freeze(Object.assign(Object.assign({},e),{[t.payload.counterType]:t.payload.value})):e}var Ii=n("FJpk");const wi=Object(w.a)({sitemapState:ci,focusedSessionId:ji,defaultSessionId:Pi,modalComponentState:pi,backNavTooltipState:yi,indicatorNotificationState:hi,hideAppNameInTopBar:Ti,suppressSessionCloseWarning:Ni,globalSearchState:li.b,sitemapCollapsedState:Si.c,componentCounters:Ei});function ji(e=Ii.a,t){return t.type===vi.v&&t.payload.sessionId||t.type===vi.l&&!1!==t.payload.isFocused&&t.payload.sessionId?t.payload.sessionId:e}function Pi(e=Ii.a,t){return e}function Ti(e=!1,t){return t.type!==_i.a||Object(T.a)(t.payload.hideAppNameInTopBar)?e:t.payload.hideAppNameInTopBar}function Ni(e=!1,t){return t.type===_i.b?t.payload.suppressSessionCloseWarning:e}const Ai={[Ii.a]:{id:Ii.a,focusedTabId:Ii.b,anchorTabId:Ii.b,title:void 0,icon:"",tabs:[Ii.b],canBeClosed:!1,isFocusRequested:!1,iconTitle:""}};function Ri(e=Ai,t){const n=t.payload?t.payload.sessionId:void 0;if(n){const r=e[n],a=function(e={},t){const n=function(e,t){if(t.type===vi.l)return t.payload.sessionId;return e}(e.id,t),r=function(e,t){if(t.type===vi.pb||t.type===vi.l)return t.payload.title;return e}(e.title,t),a=function(e,t){if(t.type===vi.jb&&t.payload.isFocusRequested)return t.payload.isFocusRequested;if(t.type===vi.l&&t.payload.isFocusRequested&&!1===t.payload.isFocused)return t.payload.isFocusRequested;if(t.type===vi.v)return!1;return e}(e.isFocusRequested,t),i=function(e,t){if(t.type===vi.hb||t.type===vi.l)return!1!==t.payload.canBeClosed;return e}(e.canBeClosed,t),o=function(e=[],t){if(t.type===vi.p||t.type===vi.l){if(-1===e.indexOf(t.payload.tabId))return Object.freeze(e.concat(t.payload.tabId))}else if(t.type===vi.i){const n=t.payload.tabId;if(-1!==e.indexOf(n))return e.filter(e=>e!==n)}return e}(e.tabs,t),s=function(e,t){if(t.type===vi.p&&!1!==t.payload.isFocused&&t.payload.tabId)return t.payload.tabId;if(t.type===vi.y||t.type===vi.l){if(t.payload.tabId)return t.payload.tabId}else if(t.type===vi.i&&t.payload.tabId===e.focusedTabId){const t=e.tabs.indexOf(e.focusedTabId),n=t+1===e.tabs.length?-1:1;return e.tabs[(t+n)%e.tabs.length]}return e.focusedTabId}(e,t),c=function(e,t){if(t.type===vi.l||t.type===vi.lb)return t.payload.icon;return e}(e.icon,t),l=function(e,t){if(t.type===vi.l||t.type===vi.nb)return t.payload.iconTitle;return e}(e.iconTitle,t),u=function(e,t){if(t.type===vi.l)return t.payload.tabId;return e}(e.anchorTabId,t);if(o!==e.tabs||s!==e.focusedTabId||i!==e.canBeClosed||r!==e.title||a!==e.isFocusRequested||n!==e.id||c!==e.icon||l!==e.iconTitle||u!==e.anchorTabId)return Object.freeze(Object.assign(Object.assign({},e),{id:n,tabs:o,focusedTabId:s,anchorTabId:u,canBeClosed:i,title:r,isFocusRequested:a,icon:c,iconTitle:l}));return e}(r,t);r!==a&&(e=Object.freeze(Object.assign(Object.assign({},e),{[n]:a})))}if(t.type===vi.g){const t=Object.keys(e);if(t.indexOf(n)>=0){const r={};for(const a of t)a!==n&&(r[a]=e[a]);return Object.freeze(r)}}return e}const Di={[Ii.b]:{id:Ii.b,canBeClosed:!1}};function xi(e=Di,t){const n=t.payload&&(t.payload.tabId||t.payload.browsingContext);if(n){const r=e[n],a=function(e={},t){const n=function(e,t){if(t.type===vi.p||t.type===vi.l)return t.payload.tabId;return e}(e.id,t),r=function(e,t){if(t.type===vi.p||t.type===vi.rb)return!1!==t.payload.canBeClosed;if(t.type===vi.l)return!1;return e}(e.canBeClosed,t),a=function(e,t){if(t.type===vi.p||t.type===vi.tb)return t.payload.title;return e}(e.title,t),i=function(e,t){if(t.type===vi.p)return!!t.payload.isTitleStatic;return e}(e.isTitleStatic,t);if(n!==e.id||r!==e.canBeClosed||a!==e.title||i!==e.isTitleStatic)return Object.freeze(Object.assign(Object.assign({},e),{id:n,canBeClosed:r,title:a,isTitleStatic:i}));return e}(r,t);r!==a&&(e=Object.freeze(Object.assign(Object.assign({},e),{[n]:a})))}if(t.type===vi.i){if(-1!==Object.keys(e).indexOf(n)){const t=e,r=n,a=(t[r],Object(_a.d)(t,["symbol"==typeof r?r:r+""]));return Object.freeze(a)}}return e}var Mi=n("1OTd"),Fi=n("JHwY");var ki=n("m2nm");const Li={[Ii.b]:{id:Ii.b,pageId:"",error:void 0,dialogContextIds:[],history:[],disableNavigateBack:!1,type:0,navigating:!1,navigationsCount:0}};function Bi(e=Li,t){if(t.type===Mi.g){const n=t.payload&&t.payload.browsingContextId;if(n){const r={id:n,pageId:"",error:void 0,dialogContextIds:[],history:[],disableNavigateBack:!1,type:t.payload.type,navigating:!1,navigationsCount:0};return Object.freeze(Object.assign(Object.assign({},e),{[n]:r}))}}if(t.type===Mi.c){const n=t.payload&&t.payload.browsingContextId;if(-1!==Object.keys(e).indexOf(n)){const t=e,r=n,a=(t[r],Object(_a.d)(t,["symbol"==typeof r?r:r+""]));return Object.freeze(a)}}const n=t.payload&&t.payload.browsingContextId;if(n){const r=e[n],a=function(e,t){const n=function(e,t){if(t.type===Mi.q)return t.payload.currentPage;return e}(e.pageId,t),r=function(e,t){if(t.type===Mi.q)return t.payload.error;return e}(e.error,t),a=function(e=[],t){switch(t.type){case vi.a:return Object.freeze(e.concat({state:t.payload.state,url:t.payload.url}));case vi.cb:{const n={state:t.payload.state,url:t.payload.url};return 0===e.length?[n]:Object.freeze(e.map((t,r)=>r===e.length-1?n:t))}case vi.b:return Object.freeze(e.slice(0,e.length-1));case vi.d:return e.length>1?Object.freeze(e.slice(e.length-1,e.length)):e;case vi.bb:return Object.freeze(t.payload.history);default:return e}}(e.history,t),i=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t){if(t.type===Fi.a)return Object.freeze(t.payload.dialogContextIds);if(t.type===Mi.a){const n=t.payload.dialogContextId,r=e.filter(e=>e!==n);return r.push(n),Object.freeze(r)}return t.type===Mi.n?Object.freeze(e.filter(e=>e!==t.payload.dialogContextId)):e}(e.dialogContextIds,t),o=function(e=!1,t){if(t.type===ki.a&&void 0!==t.payload.disableNavigateBack)return t.payload.disableNavigateBack;return e}(e.disableNavigateBack,t),s=function(e,t){if(t.type===Mi.m&&void 0!==t.payload.navigating)return Object.freeze(t.payload.navigating);return e}(e.navigating,t),c=function(e,t){if(t.type===Mi.m&&!0===t.payload.navigating)return e+1;return e}(e.navigationsCount||0,t),l=function(e,t){if(t.type===Mi.r){const n=Math.ceil(t.payload.viewport.width),r=Math.ceil(t.payload.viewport.height);if(!e||n!==e.width||r!==e.height)return Object.freeze({width:n,height:r})}return e}(e.viewport,t);if(a!==e.history||n!==e.pageId||r!==e.error||i!==e.dialogContextIds||o!==e.disableNavigateBack||s!==e.navigating||c!==e.navigationsCount||l!==e.viewport)return Object.freeze(Object.assign(Object.assign({},e),{pageId:n,error:r,history:a,dialogContextIds:i,disableNavigateBack:o,navigating:s,navigationsCount:c,viewport:l}));return e}(r,t);r!==a&&(e=Object.freeze(Object.assign(Object.assign({},e),{[n]:a})))}return e}var Ui=n("bo6D"),Vi=n("xE5/"),zi=n("QT+q");const qi=new URL(window.location.href,window.location.origin),Hi=qi.searchParams.has(zi.c)&&"true"===qi.searchParams.get(zi.c).toLowerCase(),Wi=Object.freeze({isOpen:Hi});function Gi(e=Wi,t){switch(t.type){case Ui.a:return Object.freeze({isOpen:!0,url:t.payload.url});case Vi.a:return Object.freeze({isOpen:!1});default:return e}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Ki(e={},t){if(t.type===Mi.i){const n=t.payload&&t.payload.dialogContextId;if(n){const r={dialogContextId:n,contentPageId:t.payload.pageId,pageStack:[t.payload.pageId],sourcePageId:t.payload.sourcePageId,previousPages:[t.payload.pageId]};return Object.freeze(Object.assign(Object.assign({},e),{[n]:r}))}}if(t.type===Mi.d){const n=t.payload&&t.payload.dialogContextId;if(-1!==Object.keys(e).indexOf(n)){const t=e,r=n,a=(t[r],Object(_a.d)(t,["symbol"==typeof r?r:r+""]));return Object.freeze(a)}}const n=t.payload&&t.payload.dialogContextId;if(n&&e[n]){const r=e[n],a=function(e,t){const n=function(e=[],t){if(t.type===Mi.p)return Object.freeze(e.filter(e=>e!==t.payload.pageId));if(t.type===Mi.t)return[...e,t.payload.pageId];return e}(e.pageStack,t),r=function(e,t,n){if(n.type===Mi.t)return n.payload.pageId;if(n.type===Mi.p)return t.length>0?t[t.length-1]:void 0;return e}(e.contentPageId,n,t),a=function(e=[],t,n){if(n.type===Mi.t&&!e.includes(t))return[...e,t];return e}(e.previousPages,r,t),i=e.sourcePageId;if(n!==e.pageStack||r!==e.contentPageId||a!==e.previousPages)return Object.freeze(Object.assign(Object.assign({},e),{dialogContextId:e.dialogContextId,contentPageId:r,pageStack:n,sourcePageId:i,previousPages:a}));return e}(r,t);r!==a&&(e=Object.freeze(Object.assign(Object.assign({},e),{[n]:a})))}return e}var Qi=n("p/Kg");const Xi=Object(w.d)({[Qi.a]:function(e,t){if(t.meta&&t.meta.pageToEditedViewMapId&&t.meta.viewId){const n=t.meta.pageToEditedViewMapId,r={fetchXml:t.payload.fetchXml};t.payload.gridDescriptor&&(r.gridDescriptor=t.payload.gridDescriptor);const a=e[n],i=a&&a[t.meta.viewId],o=Object.freeze(Object.assign(Object.assign({},i),r)),s=Object.freeze(Object.assign(Object.assign({},a),{[t.meta.viewId]:o}));return Object.freeze(Object.assign(Object.assign({},e),{[n]:s}))}return e},[Qi.b]:function(e,t){if(t.meta&&t.meta.pageToEditedViewMapId&&t.meta.viewId){const n=t.meta.pageToEditedViewMapId;let r=Object.assign({},e);const a=Object.assign({},r[n]);if(a){Object.keys(a).forEach(e=>{e===t.meta.viewId&&delete a[e]})}if(0===Object.keys(a).length){Object.keys(r).forEach(e=>{e===t.meta.pageToEditedViewMapId&&delete r[e]})}else r=Object.assign(Object.assign({},e),{[n]:a});return Object.freeze(r)}return e}},{});var Yi=n("7cfk"),Ji=n("P4TJ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const $i={initialized:Yi.a.Not_Initialized,bundleLoaded:!1};function Zi(e=$i,t){switch(t.type){case Ji.c:case Ji.d:return Object.freeze(Object.assign(Object.assign({},e),{initialized:t.payload.initialized,error:t.payload.error}));case Ji.b:return Object.freeze(Object.assign(Object.assign({},e),{bundleLoaded:t.payload}));default:return e}}var eo=n("Eq/9");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const to={};function no(e=to,t){switch(t.type){case eo.a:const n=t.payload.name,r=t.payload.state;return e=Object.assign(Object.assign({},e),{[n]:Object.assign(Object.assign({},e[n]),r)}),Object.freeze(e);default:return e}}var ro=n("ZYsU");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function ao(e={loadSitemap:!1,loadShellComponents:!1},t){return t.type===ro.b?Object.freeze(Object.assign(Object.assign({},e),{loadSitemap:t.payload.loadingStatus})):t.type===ro.a?Object.freeze(Object.assign(Object.assign({},e),{loadShellComponents:t.payload.loadingStatus})):e}var io=n("mfZ0");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const oo=[];function so(e=oo,t){switch(t.type){case io.a:return[...e,...t.payload];default:return e}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function co(e={},t){switch(t.type){case Y.c:const n=t.payload.featureControlSettings;return Object.freeze(Object.assign(Object.assign({},e),n));default:return e}}var lo=n("yHIv"),uo=n("Z6+u"),po=n("5LEP");const fo=Object(w.a)({tours:
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e=[],t){switch(t.type){case uo.d:return[...t.payload.tours];default:return e}},fullyRenderContexts:function(e=[],t){switch(t.type){case uo.c:return[...t.payload.fullyRenderContexts];default:return e}},containerDimensions:function(e={width:0,height:0},t){switch(t.type){case uo.e:return t.payload.containerDimensions;default:return e}},tourMetadata:function(e={},t){switch(t.type){case uo.d:const n=t.payload,r={};return n.tours.forEach(t=>{var n;r[t.msdyn_tourid]=null!==(n=e[t.msdyn_tourid])&&void 0!==n?n:{initializationActions:[],status:po.a.Uninitialized,isActive:!1}}),r;case uo.h:const a={};return Object.keys(e).forEach(n=>{a[n]=Object.assign(Object.assign({},e[n]),{isActive:n===t.payload.tourId})}),a;case uo.i:const i={};return Object.keys(e).forEach(n=>{i[n]=Object.assign(Object.assign({},e[n]),n===t.payload.tourId&&{isActive:!1})}),i;case uo.j:const o=t.payload;return Object.assign(Object.assign({},e),{[o.tourId]:Object.assign(Object.assign({},e[o.tourId]),{status:o.initializationStatus})});case uo.k:const{tourId:s,initializers:c}=t.payload;return Object.assign(Object.assign({},e),{[s]:Object.assign(Object.assign({},e[s]),{initializationActions:c})});case uo.g:return Object.assign(Object.assign({},e),{[t.payload.tourId]:Object.assign(Object.assign({},e[t.payload.tourId]),{nextStepIndex:t.payload.stepIndex})});case uo.f:const l={};return Object.keys(e).forEach(t=>{l[t]=Object.assign(Object.assign({},e[t]),{nextStepIndex:void 0})}),l;default:return e}}});var go=n("XhkN");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function ho(e=null,t){return t.type===go.c?t.payload.displayState:e}var mo=n("NvqY");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var bo=n("XOSd");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function yo(e){return{type:"serviceWorker.enablePreload",sync:!0,execute({getState:t,dispatch:n}){n(function(e){return{type:"serviceWorker.updatePreload",payload:{preloadServiceWorker:e}}}(Object(bo.a)(t(),e)))}}}function _o(e=!1,t){switch(t.type){case"serviceWorker.updatePreload":return t.payload.preloadServiceWorker;default:return e}}var vo=n("h34H");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const So=Object(w.d)({[vo.c]:function(e,t){return Object.freeze(Object.assign({},t.payload))}},null),Oo=Object(w.a)({reports:Object(w.b)(vo.a,So)});
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
let Co;function Eo(e,t){!
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t){if(t.type===F.b){const n=t.meta.pageId;n&&Object(b.b)(()=>{e.dispatch(Object(k.c)(n)),e.dispatch(Object(L.a)(n))},"Garbage collection")}}(e,t),
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t){t.type===B.a&&Object(U.a)(e.getState())}(e,t),function(e,t){Co?Co(e,t):Promise.all([n.e(0),n.e(1),n.e(51),n.e(58),n.e(167)]).then(n.bind(null,"lq5R")).then(({sitemapPanelActionInspector:n})=>{Co=n,n(e,t)})}(e,t)}var Io=n("YVjE"),wo=n("ABtu"),jo=n("H4dV");const Po={count:
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e){return Object.keys(e).length},isEmpty:function(e){if(Object(T.a)(e))throw Error.argumentNull("obj");return 0===Object.keys(e).length},keys:function(e){const t=new Array(0);for(const n in e){const r={key:n,value:e[n]};t[t.length]=r.key}return t}};var To=n("84PK");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class No{constructor(e){this._items=null,this._items=e||new Array(0)}get_Items(){return this._items}get_Count(){return this._items.length}get_item(e){return this._items[e]}set_item(e,t){this._items[e]=t}add(e){this._items.push(e)}addRange(e){this._items.push(...e)}clear(){this._items=[]}contains(e){return this._items.indexOf(e)>=0}remove(e){const t=this._items.indexOf(e);t>=0&&this._items.splice(t,1)}removeAt(e){this._items.splice(e,1)}toArray(){const e=new Array(this.get_Count());for(let t=0;t<this.get_Count();t++)e[t]=this.get_item(t);return e}}var Ao=n("fU7K");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var Ro=n("iZ7K"),Do=n("LbMF"),xo=n("hVsf"),Mo=n("mDek"),Fo=n("IvgJ"),ko=n("jFgV"),Lo=n("2JG5"),Bo=n("b6oC");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class Uo{constructor(e,t){this._store=null,this._tracer=null,this._store=e,this._tracer=t}getAttributeTypes(e,t){return Object(Do.c)(t,e,this._store.getState())}getMultipleAttributeMetadata(e,t){const n=this._store.getState(),r=Object(Do.d)(n,e);if(!r)return this._tracer&&this._tracer.info("getMultipleAttributeMetadata was called, attributesDescriptor is null. Returning null."),null;const a=Object.keys(r);if(t&&t.some(e=>-1===a.indexOf(e)))return this._tracer&&this._tracer.info("getMultipleAttributeMetadata was called while no attribute metadata is available in the state tree. Returning null."),null;t||(t=a);return t.map(t=>this.getAttributeMetadata(e,t))}getAttributeMetadata(e,t){const n=this._store.getState(),r=Object(Do.a)(n,e,t);if(!r||r.Initialized!==J.a.Initialized)return this._tracer&&this._tracer.info("getAttributeMetadata was called while no attribute metadata is available in the state tree. Returning null."),null;const a={};if(r.OptionSet)for(const e in r.OptionSet){const t=r.OptionSet[e],n=new Fo.a(t.Label,t.Value,t.State,t.DefaultStatus,t.TransitionData,t.Color,t.Label);a[e]=n}const i=new ko.a(a);return new Mo.a(r.LogicalName,A.a.toLegacyGuid(r.Id),r.EntityLogicalName,r.Type,r.DisplayName,r.IsSecured,r.IsValidForCreate,r.IsValidForRead,r.IsValidForUpdate,r.IsValidForGrid,r.RequiredLevel,r.MaxLength,r.MinValue,r.MaxValue,r.Precision,r.PrecisionSource,r.Format,r.Behavior,r.DefaultFormValue,r.DefaultValue,i,r.IsBaseCurrency,r.Targets,r.AttributeOf,r.HasChanged,r.ImeMode,!0,r.InheritsFrom,r.SourceType,!1,r.IsCustomAttribute,r.ColumnNumber)}getEntityMetadata(e){const t=this._store.getState(),n=Object(Ro.h)(t,e);if(!n||n.Initialized!==J.a.Initialized)return null;return new Lo.a(A.a.toLegacyGuid(n.Id),e,n.DisplayName,n.PluralName,n.ObjectTypeCode,n.PrimaryIdAttribute,n.PrimaryNameAttribute,n.PrimaryImageAttribute,n.Privileges?n.Privileges.map(this._getLegacySecurityPrivilegeMetadata):null,n.IsReadOnlyInMobileClient,n.IsVisibleInMobileClient,n.IsOfflineInMobileClient,n.IsOptimisticConcurrencyEnabled,n.HasChanged,n.IsActivity,n.IsChildEntity,n.ParentEntityLogicalName,n.ParentEntityReferencingAttribute,n.IsValidForAdvancedFind,n.IsMailMergeEnabled,n.IsConnectionsEnabled,n.IsCustomizable,n.IsActivityParty,n.IsImportable,n.IsEnabledForCharts,n.IsCustomEntity,n.IsStateModelAware,n.EnforceStateTransitions,n.IsCollaboration,n.ActivityTypeMask,n.OwnershipType,!0,n.HasStateCode,n.IsBusinessProcessEnabled,n.EntityHelpUrlEnabled,n.EntityHelpUrl,n.IsDocumentManagementEnabled,n.IsOneNoteIntegrationEnabled,n.IsMSTeamsIntegrationEnabled,!1,n.EntityColor,n.IsInteractionCentricEnabled,n.IsQuickCreateEnabled,n.EntityClientSetting,n.IsKnowledgeManagementEnabled,n.IsDocumentRecommendationsEnabled,n.IsIntersect,n.HasNotes,n.UsesBusinessDataLabelTable,n.IconVectorName,n.IsBPFEntity,n.VersionNumber,n.OverallVersionNumber,n.AttributeNames)}_getLegacySecurityPrivilegeMetadata(e){return new Bo.a(e.Name,A.a.toLegacyGuid(new A.a(e.PrivilegeId)),e.PrivilegeType,e.CanBeBasic,e.CanBeLocal,e.CanBeDeep,e.CanBeGlobal)}getEntityMetadataByTypeCode(e){return this.getEntityMetadata(Object(Ro.m)(this._store.getState(),e))}cacheEntityMetadata(e){const t=[];t.push(e),this._store.dispatch(function(e,t,n){const r=[];for(const t of e)r.push(t.getODataObject());return{type:"cache.entitymetadata",payload:Object(De.b)(r,r[0].VersionNumber,r[0].OverallVersionNumber,t,J.a.Initialized,n)}}(t,this._store.getState()))}cacheIsActivityFlags(e){const t=Object(xo.b)(e);this._store.dispatch(Object(Ce.b)(t))}cacheInitialEntities(e){this._store.dispatch(Object(Ee.h)(e,this._tracer))}cacheAttributeMetadata(e,t,n){const r=this._store.getState(),a=Object(Do.d)(r,e);let i=null;a&&(i=n.filter(e=>{const t=e.get_logicalName();return!a.hasOwnProperty(t)||a[t].Initialized!==J.a.Initialized})),i&&i.length>0&&this._store.dispatch(je(e,i,this._tracer))}}Uo.TRACER_CATEGORY_ID="MetadataCache";var Vo=n("ngeo"),zo=n("SRlt"),qo=n("EW4s"),Ho=n("Lyxw"),Wo=n("3/02"),Go=n("zBbx"),Ko=n("4N6w"),Qo=n("VCkP"),Xo=n("wO8k");function Yo(e,t,n){throw e.dispatch(kr(!0)),t.error("Reauth failed. Logging out user"),e.dispatch(Object(Xo.b)("Signing out after reauth failure in RemoteCallRetryHandler",!1)),n}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class Jo{constructor(e,t){this._applicationContext=e,this._store=t}isConnectivityRetryEnabled(){return Object(Ho.f)(this._store.getState(),Wo.yg)||Object(Ho.f)(this._store.getState(),Wo.xg)}shouldRetryConnectivityError(e,t){var n;if(!(t.get_isErrorInOffline&&t.get_isErrorInOffline()))return!1;let r;if(Object(Ho.f)(this._store.getState(),Wo.xg))r=Number.POSITIVE_INFINITY;else{if(!Object(Ho.f)(this._store.getState(),Wo.yg))return!1;r=1}const a=null!==(n=e.connectivityRetryCount)&&void 0!==n?n:0;return"GET"===e.method&&a<r}handleAuthError(e){const t=new qo.a;return this._reauth(e).then(()=>{t.resolve()}).catch(e=>{this._applicationContext.TraceManager.getTracer("RemoteCallRetryHandler").error("Auth error handling failed: "+(null==e?void 0:e.message)),t.reject(e)}),t}_reauth(e){return async function(e,t,n,r,a){const i=t.TraceManager.getTracer("Authentication");if(Object(Ko.d)(e.getState()))throw Object(f.d)("User credentials invalid, probably expired. Auth error being handled.",null,null,null,null,null,!0);const o=n();r(o?o+1:1),n()>2&&Yo(e,i,Object(f.d)("A call failed retry more than twice",-2147093995,null,null,null,null,!0));const s=new Qo.a(t,e);try{return await s.handleAuthError()}catch(t){Yo(e,i,t)}a(),t.EventManager.ReportComponentSuccess("Authentication")}(this._store,this._applicationContext,()=>e.retryCount,t=>{e.retryCount=t},()=>Object(Go.a)(this._store.getState(),e))}resetFailures(){this._store.dispatch(kr(!1))}}var $o=n("smSa"),Zo=n("E5IU");class es{constructor(e,t){this._store=e}isOfflineSyncDone(){return Object($o.b)(this._store.getState())}getCurrentAppId(){return Object(Zo.k)(this._store.getState())}getCurrentAppUniqueNameOrDefault(){return Object(Zo.o)(this._store.getState())}getAuthToken(){return Object(Ko.a)(this._store.getState())}addAuthorizationHeader(e){return Object(Go.a)(this._store.getState(),e)}}var ts=n("GYEz"),ns=n("uAlF"),rs=n("jZCH"),as=n("fYtF"),is=n("17x/");function os(e,t,n,r=!1){const a=e.DataSource;return a.initialize(n).nativePromise().then(i=>{i&&Object(Y.e)(t.dispatch,i),t.dispatch(Object(St.g)(a.get_appModuleVersionStamps())),e.EventManager.setDataSource(a),a.set_IsLocalDataSourceAvailable(n);if(e.TraceManager.getTracer("dataSourceLoader").warn("Boot task DataSource completed"),!i&&r&&n&&e.DataSource.isUserContextInitialized()){return e.DataSource.get_LocalDataSource().UpdateUserContext(e.DataSource.get_UserContext()).nativePromise().then(()=>{})}})}var ss=n("jsc8"),cs=n("GdzE"),ls=n("w1eR");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class us{constructor(){this._onFocusHandlers=[],this._onBlurHandlers=[],this._resetActivityTimeStamp=this._resetActivityTimeStamp.bind(this),this._handleFocus=this._handleFocus.bind(this),this._handleBlur=this._handleBlur.bind(this),this._handleWindowUnload=this._handleWindowUnload.bind(this);const e=(new Date).valueOf();this._hasFocus=!0,this._lastFocusOn=e,this._lastBlurOn=0,window.addEventListener("pointerup",this._resetActivityTimeStamp,!0),window.addEventListener("keydown",this._resetActivityTimeStamp,!0),window.addEventListener("focus",this._handleFocus),window.addEventListener("blur",this._handleBlur),window.addEventListener("unload",this._handleWindowUnload)}_resetActivityTimeStamp(){this._lastActiveOn=(new Date).valueOf()}_handleFocus(){this._hasFocus=!0;const e=(new Date).valueOf();this._lastActiveOn=e,this._lastFocusOn=e,this._onFocusHandlers.forEach(e=>{e()})}_handleBlur(){this._hasFocus=!1;const e=(new Date).valueOf();this._lastBlurOn=e,this._onBlurHandlers.forEach(e=>{e()})}_handleWindowUnload(){if(this._hasFocus){const e=(new Date).valueOf();this._lastActiveOn=e,this._lastFocusOn=e,this._onFocusHandlers.forEach(e=>{e()})}else{const e=(new Date).valueOf();this._lastBlurOn=e,this._onBlurHandlers.forEach(e=>{e()})}}getHasFocus(){return this._hasFocus}getLastFocusOn(){return this._lastFocusOn}getLastBlurOn(){return this._lastBlurOn}getLastActiveOn(){return this._lastActiveOn}addOnFocusHandler(e){this._onFocusHandlers.push(e)}addOnBlurHandler(e){this._onBlurHandlers.push(e)}}var ds=n("gy+e"),ps=n("IqkD"),fs=n("NjDY");var gs=n("WePp"),hs=n("4aOd"),ms=n("kWiz");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class bs{constructor(e){this._eventManager=e}write(e,t,n,r,a){const i=new Error(n),o=new hs.a(i).getStackTrace().split("\n"),s=o.splice(0,1).join("\n")+"\n"+o.splice(4,o.length).join("\n"),c=this._createTraceEvent(t,n,r,a,s);this._eventManager.ReportEvent(c)}_createTraceEvent(e,t,n,r,a){const i=new gs.a(E.r.Name);return i.addEventParameter(E.g.ComponentName,n),i.addEventParameter(E.r.TraceLevel,ms.a.toString(e)),i.addEventParameter(E.r.CommonError.Message,t),i.addEventParameter(E.r.CommonError.CallStack,a),r&&r.forEach(e=>{i.addEventParameter(e.name,e.value)}),i}}var ys=n("XjOj");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var _s=n("gNtT");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class vs{constructor(e){this._platform=e}getPlatform(){return this._platform}setLandingPage(e){this._landingPage=e}getLandingPage(){return this._landingPage}}const Ss=["camera","video","microphone","geolocation"];
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Os={imageRes:n("CEpr").a.DeviceDefault,savePhoto:!1};function Cs(e){const t={featureName:e,isEnabled:!0};return"camera"===e&&Object.keys(Os).forEach(e=>{t[e]=Os[e]}),t}var Es=n("UwOy");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var Is=n("FbdD"),ws=n("6cfr"),js=n("Q6x1"),Ps=n("wipL"),Ts=n("vIHs");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class Ns{constructor(e){this._errorLoadingIndicator=document.getElementById("error-app-loading-indicator"),this._loadingIndicator=document.getElementById("app-loading-indicator"),this._basicErrorRoot=document.getElementById("errorPopup-container"),this._basicErrorRoot.innerHTML="",this._felaProviderProps=e}createErrorPopup(e,t,n){return this._loadingIndicator.classList.add("hideProgressBar"),this._basicErrorRoot.classList.remove("hideErrorBlock"),this._errorLoadingIndicator.classList.remove("hideErrorBlock"),this._errorLoadingIndicator.classList.add("centered"),Object(Ts.a)(e,n?n.dispatch:null,n?n.getState:null,t).then(e=>{const t=e.errorPopupDescriptor,r=u.createElement(Ps.c,{errorDescriptor:t}),a=u.createElement(Is.a,{store:n},r),i=u.createElement(js.a,this._felaProviderProps,a);d.render(i,this._basicErrorRoot)})}}var As=n("Eh65"),Rs=n("8mbc"),Ds=n("+hKY"),xs=n("ldKl");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class Ms{constructor(e,t){this._telemetryFallback=t,this._AWTInit(e)}setAWTSemanticContext(e){if(void 0===this._defaultAriaLogger)return;if(this._defaultAriaLogger.getSemanticContext()){for(const t of e.parameters)if(t){const e=Object(gs.c)(t.value);this._defaultAriaLogger.setContext(t.name,e,Ds.AWTPropertyType.Unspecified)}this._defaultAriaLogger.setContext(E.g.UserAgent,window.navigator.userAgent,Ds.AWTPropertyType.String),this._defaultAriaLogger.setContext(E.g.Origin,window.location.origin,Ds.AWTPropertyType.String)}}logEvent(e,t){if(void 0===this._defaultAriaLogger)return;const n=e.getEventName().toLowerCase();if(E.h.indexOf(n)<0)return;const r=new Ds.AWTEventProperties(n);this._setEventPriority(r,t),r.setProperty("ActivityId",e.getActivityId(),Ds.AWTPropertyType.String);const a=e.toAriaEventData().EventValues;for(const e in a)r.setProperty(e,a[e],Ds.AWTPropertyType.Unspecified);this._defaultAriaLogger.logEvent(r)}flushAndTearDown(){Ds.AWTLogManager.flushAndTeardown()}_AWTInit(e){const t=this._getLoggingOptions();this._defaultAriaLogger=Ds.AWTLogManager.initialize(t.instrumentationKey,{collectorUri:t.endpointUrl}),this._eventsDropped={},window.addEventListener("beforeunload",this._onBeforeUnload),Ds.AWTLogManager.addNotificationListener({eventsSent:e=>{},eventsDropped:(e,t)=>{var n;this._eventsDropped[t]=(null!==(n=this._eventsDropped[t])&&void 0!==n?n:0)+e.length},eventsRejected:(t,n)=>{const r=[{name:"reason",value:n},{name:"eventsRejected",value:t.length}];e.EventManager.ReportComponentFailure("AWTLogManager.eventsRejected",r)},eventsRetrying:e=>{}})}_getLoggingOptions(){return this._telemetryFallback?Object(xs.b)("TEST"):Object(xs.c)(window.location.origin)}_setEventPriority(e,t){void 0!==t&&(t===As.a.High?e.setEventPriority(Ds.AWTEventPriority.High):t===As.a.Low?e.setEventPriority(Ds.AWTEventPriority.Low):e.setEventPriority(Ds.AWTEventPriority.Normal))}_onBeforeUnload(){try{if(0!==Object.entries(this._eventsDropped).length){const e=new gs.a(E.i.Name);e.addEventParameter("eventsDropped",JSON.stringify(this._eventsDropped)),this.logEvent(e,As.a.High)}}catch(e){}Ds.AWTLogManager.flushAndTeardown()}}const Fs="MaxBrowserQueueSize",ks="MaxMobileQueueSize";class Ls{constructor(e,t){this._MAX_QUEUE_SIZE=250,this._clientHost=t,this._clientHost===ls.a.Browser&&(this._MAX_QUEUE_SIZE=2e3),this._queueEvents=[],e.DebugSettingsHandler.registerSettingsHandler(Rs.b.TelemetryQueue,this._receiveSettings.bind(this))}length(){return this._queueEvents.length}getSpaceAvailable(){return this._MAX_QUEUE_SIZE-this._queueEvents.length}enqueue(e){this._queueEvents.length<this._MAX_QUEUE_SIZE?this._queueEvents.push(e):this._reportEventsLost(1)}_receiveSettings(e){this._clientHost===ls.a.Browser&&Fs in e&&this._loadMaxQueueSize(e,Fs),this._clientHost!==ls.a.Browser&&ks in e&&this._loadMaxQueueSize(e,ks)}_loadMaxQueueSize(e,t){const n=Number(e[t]);isNaN(n)||(this._MAX_QUEUE_SIZE=n)}_reportEventsLost(e){if(e>0&&this._queueEvents.length>=this._MAX_QUEUE_SIZE){const t="Telemetry.QueueFull",n="KnownEventsLost",r=this._queueEvents[this._queueEvents.length-1];if(t===r.getEventParameter(E.g.ComponentName).value){const t=Number(r.getEventParameter(n).value);t>0&&(e+=t),r.addEventParameter(n,e),this._queueEvents[this._queueEvents.length-1]=r}else{e++;const r=new gs.a(E.r.Name);r.addEventParameter(E.g.ComponentName,t),r.addEventParameter(E.g.ActivityId,"1238c0de-aaaa-bbbb-cccc-1234567890ab"),r.addEventParameter(E.r.TraceLevel,ms.a.toString(ms.a.Warning)),r.addEventParameter(E.r.CommonError.Message,"Queue dropped events"),r.addEventParameter(E.r.CommonError.CallStack,"No callstack"),r.addEventParameter(n,e),this._queueEvents[this._queueEvents.length-1]=r}}}dequeueAll(){const e=this._queueEvents.slice();return this._queueEvents=[],e}}class Bs{constructor(e){this._storage=e}saveData(e,t){return this._storage.saveSessionState(e,t,!1).nativePromise().then(()=>{})}readData(e){return this._storage.retrieveSessionState(e).nativePromise()}deleteData(e){return this._storage.deleteSessionState(e).nativePromise()}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const Us="MaxStoredBatches";class Vs{constructor(e,t,n){this._storedEventManifest=[],this._MAX_STORED_BATCHES=250,this._storage=t,this._archiveStoreKey=n,this._loadEventManifestFromStorage(),e.DebugSettingsHandler.registerSettingsHandler(Rs.b.TelemetryArchiver,this._receiveSettings.bind(this))}archiveEvents(e){return this._receiveEvents(e)}countEvents(){let e=0;for(const t of this._storedEventManifest)e+=t.NumEvents;return e}_receiveSettings(e){if(Us in e){const t=Number(e[Us]);isNaN(t)||(this._MAX_STORED_BATCHES=t)}}getEventBatch(){if(this._storedEventManifest.length>0){const e=this._storedEventManifest.shift();return this._writeEventManifestToStorage().then(()=>this._readEventBatch([],e.Key)).then(t=>{const n={SessionContext:e.SessionContext,Events:t};return this._deleteEventBatch(e.Key).then(()=>n)})}return Promise.resolve()}_receiveEvents(e){const t=e.Events;if(!t||0===t.length)return Promise.resolve();if(this._storedEventManifest.length>=this._MAX_STORED_BATCHES)return Promise.resolve();const n=t.slice(),r=this._archiveStoreKey+"_"+A.a.newGuid().guid,a={Created:Date.now(),Key:r,SessionContext:e.SessionContext,NumEvents:n.length};return this._storedEventManifest.push(a),this._writeEventManifestToStorage().then(()=>this._writeEventBatch(n,r))}_readEventBatch(e,t){return this._storage.readData(t).then(t=>{let n=[];const r=JSON.parse(JSON.stringify(t));r&&r.length>0&&(n=JSON.parse(r[0]));const a=e.slice();for(let e=0;e<n.length;e++){const t=new gs.a("").fromJSON(n[e]);a.push(t)}return a}).catch(e=>(console.error("[Telemetry] failure 'Read DB'"),console.dirxml(e),console.error(e.stack||e),[]))}_writeEventBatch(e,t){const n=e.slice(),r=[];return r.push(JSON.stringify(n)),this._storage.saveData(t,r).then(()=>{}).catch(e=>{throw console.error("[Telemetry] failure 'Save DB'"),console.dirxml(e),console.error(e.stack||e),e})}_deleteEventBatch(e){return this._storage.deleteData(e).then(e=>{}).catch(e=>{throw console.error("[Telemetry] failure 'Delete DB'"),console.dirxml(e),console.error(e.stack||e),e})}_loadEventManifestFromStorage(){return this._storage.readData(this._archiveStoreKey+"_Manifest").then(e=>{let t=[];const n=JSON.parse(JSON.stringify(e));n&&n.length>0&&(t=JSON.parse(n[0])),this._storedEventManifest=t}).catch(e=>{throw console.error("[Telemetry] 'Retrieve Archive Manifest' failure"),console.dirxml(e),console.error(e.stack||e),e})}_writeEventManifestToStorage(){const e=this._storedEventManifest.slice();if(!this._storage)return Promise.resolve();const t=[];return t.push(JSON.stringify(e)),this._storage.saveData(this._archiveStoreKey+"_Manifest",t).then(()=>{}).catch(e=>{throw console.error("[Telemetry] 'Store Save DB' failure"),console.dirxml(e),console.error(e.stack||e),e})}}class zs{constructor(e,t,n){this._reporting=!0,this.ARCHIVING=!0,this._telemetryClient=new Ms(e,t),this._queue=new Ls(e,n),this._applicationContext=e,e.DebugSettingsHandler.registerSettingsHandler(Rs.b.EventListeners,this._receiveSettings.bind(this)),this._flushTimeout=null}handleEvent(e,t){if(!this._reporting)return;const n=e.getEventParameter(E.j.NetworkConnectivityState).value;if("offline"!==n){if(this._telemetryClient.logEvent(e,t),"online"===n&&(this._archiver&&this._archiver.countEvents()>0||this._queue&&this._queue.length()>0)){const t=()=>{clearTimeout(this._flushTimeout),this._flushTimeout=null,this._queue&&this._queue.length()>0&&this._flushQueuedEventsToAria(),this._archiver&&this._archiver.countEvents()>0&&this._processArchiver()},n=e.getEventParameter(E.g.ComponentName).value,r=e.getEventName(),a=r===E.q.Name||r===E.i.Name;n.toString().toLowerCase().indexOf("offline")>-1&&a&&t(),null===this._flushTimeout&&(this._flushTimeout=setTimeout(t,6e4))}}else{if(!this.ARCHIVING)return;(this._queue.getSpaceAvailable()<=0?this._flushQueueToArchiver():Promise.resolve()).then(()=>{e.addEventParameter("timestamp",(new Date).getTime()),this._queue.enqueue(e)}).catch(()=>{e.addEventParameter("timestamp",(new Date).getTime()),this._queue.enqueue(e)})}}setSessionContext(e){this._sessionContext=e,this._telemetryClient.setAWTSemanticContext(e)}_receiveSettings(e){"AWTEventListener"in e?"off"===e.AWTEventListener.toLowerCase()?(this._reporting=!1,this._telemetryClient.flushAndTearDown()):this._reporting=!0:this._reporting=true}_flushQueueToArchiver(){if(this._archiver&&this._queue.length()>0){const e={SessionContext:this._sessionContext,Events:this._queue.dequeueAll()};return this._archiver.archiveEvents(e)}return Promise.resolve()}_flushQueuedEventsToAria(){let e=0;if(this._queue&&this._queue.length()>0){const t=this._queue.dequeueAll();e=t.length;for(let e=0;e<t.length;e++){const n=t[e];this._telemetryClient.logEvent(n,As.a.High)}}const t=new gs.a(E.r.Name);t.addEventParameter(E.g.ComponentName,"AWTEventListener"),t.addEventParameter(E.g.ActivityId,A.a.toString(A.a.newGuid())),t.addEventParameter(E.r.TraceLevel,ms.a.toString(ms.a.Warning)),t.addEventParameter(E.r.CommonError.Message,"Processing events from Queue"),t.addEventParameter(E.r.CommonError.CallStack,"No callstack");const n=this._archiver?this._archiver.countEvents():0;return t.addEventParameter("ArchivedEventsCount",n),t.addEventParameter("QueuedEventsCount",e),this._telemetryClient.logEvent(t,As.a.High),Promise.resolve()}_processArchiver(){const e=new gs.a(E.r.Name),t=this._archiver?this._archiver.countEvents():0;return e.addEventParameter(E.g.ComponentName,"AWTEventListener"),e.addEventParameter(E.g.ActivityId,A.a.toString(A.a.newGuid())),e.addEventParameter(E.r.TraceLevel,ms.a.toString(ms.a.Warning)),e.addEventParameter(E.r.CommonError.Message,"Processing events from Archiver"),e.addEventParameter(E.r.CommonError.CallStack,"No callstack"),e.addEventParameter("ArchivedEventsCount",t),this._telemetryClient.logEvent(e,As.a.High),this._archiver.getEventBatch().then(t=>{const n=this._archiver.countEvents();e.addEventParameter(E.r.CommonError.Message,"Processing batch of events from archiver"),e.addEventParameter("RemainingArchivedEventsCount",n);const r=t&&t.Events?t.Events.length:0;e.addEventParameter("CurrentBatchEventsCount",r),this._telemetryClient.logEvent(e,As.a.High),t&&(this._telemetryClient.setAWTSemanticContext(t.SessionContext),t.Events.forEach(e=>{this._telemetryClient.logEvent(e)}),this._archiver.countEvents()>0?this._processArchiver():this._telemetryClient.setAWTSemanticContext(this._sessionContext))})}setStorage(e){this._telemetryStorage=new Bs(e),this._setArchiver()}_setArchiver(){this._telemetryStorage?this._archiver||(this._archiver=new Vs(this._applicationContext,this._telemetryStorage,"ariaTelemetry")):this._archiver=void 0}}var qs=n("QMfC");class Hs{constructor(e,t){this._isConsoleOn=false,e.DebugSettingsHandler.registerSettingsHandler(Rs.b.EventListeners,this._setConsoleSettings.bind(this)),this._console=t,this._verboseLog=this._getVerboseLog()}handleEvent(e,t){if(!this._isConsoleOn)return;/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)&&this._verboseLog?this._printWebAPIStructured(e):this._printMessage(this._eventToString(e),Object(qs.a)(e))}_setConsoleSettings(e){"Console"in e?"off"===e.Console.toLowerCase()?this._isConsoleOn=!1:this._isConsoleOn=!0:this._isConsoleOn=false}_getVerboseLog(){return null!==this._verboseLog&&void 0!==this._verboseLog||(this._verboseLog=window.location.search.toLocaleLowerCase().indexOf("verboselog=true")>=0),this._verboseLog}_printWebAPIStructured(e){const t="Event: "+e.getEventName();this._console.group(t);const n=this._getMainInfo(e);this._printMessage(n,Object(qs.a)(e)),this._console.group("Details"),this._console.groupCollapsed("Event Parameters"),this._console.table(this._formatParametersForTable(e)),this._console.groupEnd();const r=e.getEventParameter(E.e.CallStack).value;r&&(this._console.group("Call Stack"),this._console.log(r),this._console.groupEnd()),this._console.groupEnd(),this._console.groupEnd()}_formatParametersForTable(e){const t={};t[E.g.ActivityId]={value:e.getActivityId()};const n=e.toSendJSON().EventValues;for(const e in n){const r=n[e];if(E.g.EventContext!==e||r)if(E.k.StartTime===e)t[e]={value:JSON.stringify(r).replace(/"/g,"")};else if(E.e.CallStack!==e){const n=null!==r?r.toString():"null";t[e]={value:n}}}return t}_printMessage(e,t){4===t?this._console.error(e):3===t&&this._verboseLog?this._console.warn(e):1===t&&this._verboseLog?this._console.info(e):this._verboseLog&&this._console.log(e)}_getHeaderString(e){let t="["+e.getEventName()+"]";return t+="   "+this._getMainInfo(e)+"\n",t}_getMainInfo(e){const t=e.getEventParameter(E.e.Message).value,n=e.getEventParameter(E.g.ComponentName).value;let r="";return n&&(r="["+n+"]"),E.n.Name===e.getEventName()?(r.length>0&&(r+="\n"),r+=E.n.MetricName+": "+e.getEventParameter(E.n.MetricName).value+"\n",r+=E.n.MetricValue+": "+e.getEventParameter(E.n.MetricValue).value+"\n"):t&&(r.length>0&&(r+="\t"),r+=t),r}_getParameterStringPair(e){let t=e.name,n="";for(n=E.k.StartTime===e.name?JSON.stringify(e.value).replace(/"/g,""):""+e.value;n.length>t.length;)t+=" ";for(;t.length>n.length;)n+=" ";return t+="   ",n+="   ",[t,n]}_getDetailsString(e){let t="",n="",r="",a="",i="",o="";n+="---Details---\n";const s=[],c={name:E.g.ActivityId,value:e.getActivityId()};s.push(c);const l=e.toSendJSON().EventValues;for(const e in l){const t=l[e];if(E.g.EventContext===e&&!t)continue;const n={name:e,value:t};s.push(n)}return s.forEach(e=>{E.e.CallStack!==e.name?([i,o]=this._getParameterStringPair(e),r.length+i.length>160?(n+=r+"\n",r=i,n+=a+"\n\n",a=o):(r+=i,a+=o)):t=""+e.value}),n+=r+"\n",n+=a+"\n",t&&(n+="---Call Stack---\n"+t),n}_eventToString(e){let t=this._getHeaderString(e);return t+=this._getDetailsString(e),t}}var Ws=n("OEUm"),Gs=n("J+j6"),Ks=n("OEF1"),Qs=n("dj6u");function Xs(e,t,n){e.parameters.push({name:t,value:n})}var Ys=n("69Qu"),Js=n("PV+a");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const $s="Message",Zs="Parameters",ec="MethodName",tc={assert:4,error:4,exception:4,info:1,log:0,trace:2,warn:3};let nc;class rc{constructor(){if(nc)throw new Error("Only one instance of the Console Wrapper could exist at the application runtime. To log amything into console, please use browser console patched methods.");nc=this,this._console=console,this._wrapMethods()}_wrapMethods(){const e=this._console,t=this;for(const n in e){const r=e[n];t[n]="function"==typeof r?r.bind(e):r,tc.hasOwnProperty(n)&&(e[n]=(...e)=>{this._shouldBeCaptured(n,e)&&this._captureUnknownConsoleOutput(n,e),t[n].apply(null,e)})}}_shouldBeCaptured(e,t){return"assert"!==e||!t[0]}_captureUnknownConsoleOutput(e,t){const n=new gs.a("unknown_console_output");n.addEventParameter(E.b.ApplicationEventLevel,tc[e]),n.addEventParameter(ec,e),n.addEventParameter($s,this._exctractMessageFromCallParams(e,t)),n.addEventParameter(Zs,JSON.stringify(t)),Object(Gs.e)(n)}_exctractMessageFromCallParams(e,t){const n="assert"===e?t[1]:t[0];return n?`Browser console.${e} was called with message "${n}".`:`Unable to extract message from console.${e} call. Please see arguments ${Zs} for the details.`}}var ac=n("31Vn"),ic=n("37s6"),oc=n("ff1s"),sc=n("eZ32"),cc=n("8Mff");var lc;!function(e){e[e.true=1]="true",e[e.false=0]="false",e[e.unknown=-1]="unknown"}(lc||(lc={}));class uc{constructor(e,t,n,r,a=[]){this._eventListeners=[],this._componentSettings={},this._wildCardComponentSettings={},this._eventSettings={},this._useLocal="",this._store=e,this._ariaEventListener=new zs(t,r,n),this._eventListeners.push(this._ariaEventListener),this._eventListeners=this._eventListeners.concat(a),this._tracer=t.TraceManager.getTracer("Telemetry"),this._clientHost=n,this._needContextEvent=!0,this._sessionId=A.a.newGuid().guid,window.CURRENT_SESSION_ID=this._sessionId,t.DebugSettingsHandler.registerSettingsHandler(Rs.b.EventManager,this._setEventSettings.bind(this)),this._refreshSessionContext(),this._trackEndPerformanceWorkblock=this._trackEndPerformanceWorkblock.bind(this),this._subscribeToWorkBlockReporting();const i=new URL(window.location.href,window.location.origin);this._useLocal=i.searchParams.get("useLocal")}getCurrentSessionId(){return this._sessionId}getActivityId(){return this._activityId?this._activityId:window.__preload.initialActivityId}ReportComponentPerformance(e,t,n,r,a){const i=new gs.a(E.n.Name);i.addEventParameter(E.g.ComponentName,e),i.addEventParameter(E.n.MetricName,t),null!=a&&i.addEventParameter(E.n.StartTime,new Date(performance.timing.navigationStart+a).toISOString()),i.addEventParameter(E.n.MetricValue,Math.round(n)),this._addOptionalParameters(i,r),this._dispatch(i)}ReportComponentSuccess(e,t){const n=new gs.a(E.q.Name);n.addEventParameter(E.g.ComponentName,e),this._addOptionalParameters(n,t),this._dispatch(n)}ReportComponentFailure(e,t,n,r){if(t&&t.blockErrorReporting)return;const a=new gs.a(E.i.Name),i=Object(P.e)(t,this._tracer),o=new hs.a(i).getStackTrace()||"No stack available.";if(!i.message){const e=[{name:"ErrorMessage",value:JSON.stringify(t)}];this._tracer.warn("Reporting error with empty string to telemetry.",e)}a.addEventParameter(E.g.ComponentName,e),a.addEventParameter(E.i.CommonError.Message,i.message),a.addEventParameter(E.i.CommonError.CallStack,o),a.addEventParameter(E.i.SuggestedMitigation,n),this._addUciErrorParameters(a,t),this._addOptionalParameters(a,r),this._dispatch(a)}ReportEvent(e){this._dispatch(e)}_addUciErrorParameters(e,t){if(e&&t){if(t.errorParameters)for(const n of t.errorParameters)e.addEventParameter(n.name,n.value);if(t.innerError){let n;n="string"==typeof t.innerError||t.innerError instanceof String?t.innerError.valueOf():JSON.stringify(t.innerError),e.addEventParameter("innerErrorParameter",n)}t.errorCode&&e.addEventParameter("ErrorCode",t.errorCode)}}_addOptionalParameters(e,t){if(t)for(const n of t)e.addEventParameter(n.name,n.value,n.forceOwnColumn)}setTelemetryListeners(){}addTelemetryListener(e){this._eventListeners.push(e)}_trackBeginPerformanceWorkblock(){this._activityId||(this._activityId=A.a.toString(A.a.newGuid()),O.a.onNextPerfData(this._trackEndPerformanceWorkblock))}_trackEndPerformanceWorkblock(){this._activityId=void 0}_handleContextRequest(){this._needContextEvent&&this._store&&Object(J.b)(Object(fs.B)(this._store.getState()))&&Object(J.b)(Object(ps.r)(this._store.getState()))&&(this._needContextEvent=!1,this.sendContextEvent())}sendContextEvent(){const e=new gs.a(E.f.Name),t={compositeName:"ContextEvent",parameters:[]};!function(e,t){if(Xs(e,E.g.ComponentName,"Telemetry.ContextEvent"),t){const n=t.getState(),r=Object(ts.c)(n);r&&Xs(e,E.f.InstallId,r);const a=Object(ts.b)(n);if(a&&Xs(e,E.f.DeviceModel,a),Object(J.b)(Object(fs.B)(n))){const t=Object(fs.E)(n),r=Object(fs.D)(n);Xs(e,E.f.OrganizationParameters.Language,r.languageCode),Xs(e,E.f.OrganizationParameters.OrgName,t.organizationName)}if(Object(J.b)(Object(ps.r)(n))){const t=Object(ps.x)(n);Xs(e,E.f.UserParameters.Language,t.languageId)}}Xs(e,E.f.WindowResolution,window.innerWidth+"x"+window.innerHeight),Xs(e,E.f.ScreenResolution,window.screen.width+"x"+window.screen.height),Xs(e,E.f.DeviceMemory,window.navigator.deviceMemory),Xs(e,E.f.HardwareConcurrency,window.navigator.hardwareConcurrency)}(t,this._store);for(const n of t.parameters)e.addEventParameter(n.name,n.value);this._dispatch(e)}setDataSource(e){this._ariaEventListener.setStorage(e),this._refreshSessionContext()}canSendEvent(e,t){if(!this._componentSettings&&!this._wildCardComponentSettings&&!this._eventSettings)return true;let n=this._checkInvalidComponentName(t,e);return lc.unknown!==n?lc.true===n:(n=this._checkComponentSetting(t,e),lc.unknown!==n?lc.true===n:(n=this._checkPartialComponentSetting(t,e),lc.unknown!==n?lc.true===n:(n=this._checkEventSetting(e),lc.unknown===n||lc.true===n)))}_refreshSessionContext(){const e=function(e,t,n){const r={compositeName:"SessionContext",parameters:[]};if(Xs(r,E.p.SessionId,t),e){const t=e.getState();Xs(r,E.p.HostType,Object(Es.b)(t)),Xs(r,E.p.HostSubType,Object(ts.g)(t)),Xs(r,E.p.PlayerName,Object(Ks.f)(t));const n=Object(ts.j)(t);n&&Xs(r,E.p.HostVersion,n);const a=Object(J.b)(Object(fs.B)(t))&&Object(fs.E)(t),i=window.__preload&&window.__preload.serverVersion?window.__preload.serverVersion:null,o=window.__preload&&window.__preload.orgId?window.__preload.orgId:null,s=a&&a.serverVersion?a.serverVersion:i,c=a&&a.organizationId?a.organizationId.guid:o;Xs(r,E.p.ServerVersion,s),Xs(r,E.p.OrganizationId,c);const l=Object(J.b)(Object(ps.r)(t))&&Object(ps.y)(t),u=window.__preload&&window.__preload.userId?window.__preload.userId:null,d=l&&l.userId?l.userId.guid:u;Xs(r,E.p.UserId,d);const p=Object(Qs.c)(t);Xs(r,E.p.AadObjectId,p);const f=Object(Qs.b)(t);Xs(r,E.p.AadTenantId,f);const g=Object(Zo.k)(t);g&&Xs(r,E.p.AppId,g);const h=Object(Zo.o)(t);h&&Xs(r,E.p.AppModule,h);const m=Object(Zo.j)(t);m&&Xs(r,E.p.AppModuleClientType,m);const b=Object(Zo.m)(t);null!==b&&Xs(r,E.p.NavigationType,b);const y=Object(Ks.a)(t);null==y||y.forEach(e=>{Xs(r,e.key,e.value)})}return Xs(r,E.p.ClientVersion,window.VERSION_NUMERIC_VALUE),r}(this._store,this.getCurrentSessionId(),this._clientHost);this._ariaEventListener.setSessionContext(e)}_storeComponentSettings(e,t,n){e[t]||(e[t]={});for(const r in n)e[t][r]=this._getSettingValue(n[r])}_setEventSettings(e){let t="";try{t=JSON.stringify(e)}catch(e){t="Unable to be stringified"}this._tracer.info("Event Manager Settings Received.",[{name:"Settings",value:t}]),this._componentSettings={},this._wildCardComponentSettings={},this._eventSettings={};const n=e&&e.Components?e.Components:{},r=e&&e.Events?e.Events:{};for(const e in n){const t=n[e];e.length>0&&("*"===e.charAt(0)||"*"===e.charAt(e.length-1))?this._storeComponentSettings(this._wildCardComponentSettings,e,t):this._storeComponentSettings(this._componentSettings,e,t)}for(const e in r)this._eventSettings[e]=this._getSettingValue(r[e])}_getSettingValue(e){return"off"!==String(e).toLowerCase()}_checkInvalidComponentName(e,t){return e?lc.unknown:t in this._eventSettings?this._eventSettings[t]?lc.true:lc.false:lc.true}_checkComponentSetting(e,t){if(e in this._componentSettings){if(t in this._componentSettings[e])return this._componentSettings[e][t]?lc.true:lc.false;if(Rs.a in this._componentSettings[e])return this._componentSettings[e][Rs.a]?lc.true:lc.false}return lc.unknown}_checkPartialComponentSetting(e,t){let n=!1,r=!1;for(const a in this._wildCardComponentSettings)if(a.length>0&&("*"===a.charAt(0)||"*"===a.charAt(a.length-1))){const i=a.replace(/\*/g,"");if(e.indexOf(i)>=0)if(t in this._wildCardComponentSettings[a]){if(r=this._wildCardComponentSettings[a][t],true===r)return r?lc.true:lc.false;n=!0}else if(Rs.a in this._wildCardComponentSettings[a]){if(r=this._wildCardComponentSettings[a][Rs.a],true===r)return r?lc.true:lc.false;n=!0}}return n?r?lc.true:lc.false:lc.unknown}_checkEventSetting(e){return e in this._eventSettings?this._eventSettings[e]?lc.true:lc.false:Rs.a in this._eventSettings?this._eventSettings[Rs.a]?lc.true:lc.false:lc.unknown}_addNetworkContext(e){let t="unknown";this._store&&!Object(T.a)(Object(Ys.c)(this._store.getState()))&&(t=Object(Ys.c)(this._store.getState())?"online":"offline"),e.addEventParameter(E.j.ServerConnectivityState,t);let n="unknown";this._store&&!Object(T.a)(Object(Ys.b)(this._store.getState()))&&(n=Object(Ys.b)(this._store.getState())?"online":"offline"),e.addEventParameter(E.j.NetworkConnectivityState,n)}_addOfflineContext(e){let t=!1,n=!1;if(this._store&&this._clientHost===ls.a.MobileApplication){const r=Object(Zo.r)(this._store.getState());if(e.addEventParameter(E.j.IsOfflineByDefaultApp,r),t=Object(ic.D)(this._store.getState()),e.addEventParameter(E.j.OfflineFeatureAvailableForUse,t),n=Object(ic.C)(this._store.getState()),e.addEventParameter(E.j.HasUserForcedOffline,n),!t){const t=Object(ic.v)(this._store.getState()),n=t===cc.a.Default?"Default":t===cc.a.Enabled?"Enabled":"Disabled";e.addEventParameter(E.b.MobileOfflineFeatureStatus,n);const r=Object(fs.n)(this._store.getState());if(e.addEventParameter(E.b.IsMocaOfflineFeatureEnabledInOrg,r),r&&t===cc.a.Enabled){const t=Object(ic.w)(this._store.getState()),n=t===sc.a.Available?"Available":t===sc.a.Initializing?"Initializing":"NotAvailable",r=Object(ic.x)(this._store.getState()),a=Object(oc.d)(this._store.getState());e.addEventParameter(E.b.OfflineStatus,n),e.addEventParameter(E.b.OfflineStatusReason,r),e.addEventParameter(E.b.IsCodeCacheReady,a)}}}}_addDeviceParameters(e){if(this._store){const t=this._store.getState(),n=Object(ts.h)(t);n&&Object.keys(n).forEach(t=>{e.addEventParameter(t,n[t])})}}_addContext(e){this._clientHost!==ls.a.Browser&&this._addDeviceParameters(e),e.addEventParameter(E.g.ActivityId,this.getActivityId()),e.addEventParameter(E.p.SessionId,this.getCurrentSessionId()),this._addNetworkContext(e),this._addOfflineContext(e),this._useLocal&&e.addEventParameter(E.j.UseLocal,this._useLocal),this._refreshSessionContext()}_dispatch(e,t){this._handleContextRequest();const n=e.getEventName(),r=String(e.getEventParameter(E.g.ComponentName).value);this.canSendEvent(n,r)&&(this._addContext(e),this._eventListeners.forEach(n=>{n.handleEvent(e,t)}))}_subscribeToWorkBlockReporting(){v.a.subscribeToAppWorking(this._trackBeginPerformanceWorkblock.bind(this))}}class dc{constructor(e,t,n){this._traceManager=e,this._transports=t,this._componentId=n}getLogLevel(){return this._traceManager.getLogLevel(this._componentId)}error(e,t){this._log(ms.a.Error,e,t)}warn(e,t){this._log(ms.a.Warning,e,t)}info(e,t){this._log(ms.a.Info,e,t)}debug(e,t){this._log(ms.a.Verbose,e,t)}_log(e,t,n){if(e>this.getLogLevel())return;const r=Date.now();this._transports.forEach(a=>a.write(r,e,t,this._componentId,n))}}const pc=ms.a.Warning;class fc{constructor(e,t,n,r,a){this._tracerCache=new Map,this._customLogLevels={},this._tracerCtor=t,this._config={defaultTransports:n,transportMappings:[]},e.DebugSettingsHandler.registerSettingsHandler(Rs.b.TraceManager,this._setTraceSettings.bind(this)),r&&r.forEach(e=>this.addTransportMapping(e));const i=a?this._getTraceLevelEnumForString(a):pc;this.setLogLevel(i)}addTransportMapping(e){this._config.transportMappings.push(e)}getTracer(e){let t=this._config.defaultTransports;if(e){if(!this._tracerCache.has(e)){const n=this._config.transportMappings.filter(t=>t.categories.indexOf(e)>-1).map(e=>e.transport);n.length>0&&(t=n),this._tracerCache.set(e,new this._tracerCtor(this,t,e))}return this._tracerCache.get(e)}return new this._tracerCtor(this,t)}getLogLevel(e){let t=this._logLevel;if(e){if(e in this._customLogLevels)return this._customLogLevels[e];for(const n in this._customLogLevels)if(n.length>0&&("*"===n.charAt(0)||"*"===n.charAt(n.length-1))){const r=n.replace(/\*/g,"");e.indexOf(r)>=0&&this._customLogLevels[n]>t&&(t=this._customLogLevels[n])}}return t}setLogLevel(e,t){t?this._customLogLevels[t]=e:this._logLevel=e}addDefaultTransport(e){this._config&&this._config.defaultTransports.push(e)}setTraceAreas(e){if(null===e)return;e.split(" ").forEach(e=>{const t=e.split(":");if(2===t.length){const e=t[0],n=this._getTraceLevelEnumForString(t[1]);this.setLogLevel(n,e)}})}_setTraceSettings(e){let t="";try{t=JSON.stringify(e)}catch(e){t="Unable to be stringified"}this.getTracer("TraceManager").info("Trace Manager Settings Received.",[{name:"Settings",value:t}]);const n=e&&e.Components?e.Components:{};this._customLogLevels={},this.setLogLevel(pc);for(const e in n){const t=n[e],r=this._getTraceLevelEnumForString(t);e===Rs.a?this.setLogLevel(r):this.setLogLevel(r,e)}}_getTraceLevelEnumForString(e){let t=this._logLevel;switch(e.toLowerCase()){case"off":t=ms.a.Off;break;case"error":t=ms.a.Error;break;case"warning":t=ms.a.Warning;break;case"info":t=ms.a.Info;break;case"verbose":t=ms.a.Verbose}return t}}class gc{constructor(e){this._registeredHandlers={},this._cachedSettings={},this._applicationContext=e,this._loadStoredSettings()}registerSettingsHandler(e,t){e&&(this._registeredHandlers[e]||(this._registeredHandlers[e]=[]),this._registeredHandlers[e].push(t),this._callSettingsHandler(e))}_callSettingsHandler(e){if(e in this._registeredHandlers){const t=this._registeredHandlers[e];this._cachedSettings[e]||(this._cachedSettings[e]={});for(const n of t)n(this._cachedSettings[e])}}updateSettings(e){let t={};try{t=JSON.parse(e)}catch(e){return void this._applicationContext.EventManager.ReportComponentFailure("DebugSettingsHandler",e,"Check the AdvancedDebuggabilitySetting being passed through the UserContext, or the locally saved copy, as it failed to be parsed.")}try{window.localStorage.setItem("UCIAdvancedDebuggabilitySettings",e)}catch(e){}this._cachedSettings=t&&"object"==typeof t?t:{};for(const e in this._registeredHandlers)this._callSettingsHandler(e)}_loadStoredSettings(){let e="";try{e=window.localStorage.getItem("UCIAdvancedDebuggabilitySettings")||""}catch(e){}e&&this.updateSettings(e)}}var hc=n("YPXd");function mc(e,t,n,r){const a=jo.a.getInstance(),i=!!a&&a.get_IsIOS(),o=t===ls.a.MailApp||i,s=r.getState().configuration.disableLocalStorage;let c=Object(hc.b)(e);if(c||(c=!s&&o?Object(hc.d)(n):Object(hc.c)(n)),c){const e=c.externalCorrelationId,a=c.hostName,i=c.playerName;t===ls.a.Browser&&r.dispatch({type:"session.hostType.set",payload:Es.a}),(a||i)&&(r.dispatch({type:"session.hostSubtype.set",payload:a||i}),r.dispatch(function(e){return{type:"session.playerName.set",payload:e}}(i))),e&&r.dispatch(Ya("ExternalCorrelationId",e));const o=c.loadHandler,s=o&&o.webResourceName,l=o&&o.initFunctionName;s&&r.dispatch(Ya("WebResourceName",s)),l&&r.dispatch(Ya("InitFunctionName",l)),r.dispatch({type:"session.hostOptionsInitialized.set",payload:{value:!0}});const u=[];u.push({name:"hostOptions",value:JSON.stringify(c)}),n.EventManager.ReportComponentSuccess("PopulateHostOptions.getHostOptions",u)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var bc=n("tlcF"),yc=n("Fgw8");class _c{constructor(e,t,n=new Array,r=-1,a=A.a.newGuid().guid){this.history=n,this.currentHistoryElement=r,this.historyManagerId=a,this._internalHistoryManager=new bc.a(e,t),this._store=e}moveHistory(e){const t=this.currentHistoryElement+e;t>=0&&t<this.history.length?this.currentHistoryElement=t:t<0?(this.currentHistoryElement=0,console.warn("Offset supplied makes index less than zero.")):(this.currentHistoryElement=this.history.length-1,console.warn("Offset supplied makes index greater than maximum history length."))}updateCurrentHistoryElementForPush(e){this.currentHistoryElement++}handlePushInHistory(e,t,n){this.updateCurrentHistoryElementForPush(n),this.history[this.currentHistoryElement]={state:e,url:t};const r=this.history.length-1-this.currentHistoryElement;r&&this.history.splice(-r,r)}handleReplace(e,t,n){this.currentHistoryElement<0&&this.currentHistoryElement++;const r=null==t?this.GetCurrentUrl(n):t;this.history[this.currentHistoryElement]={state:e,url:r}}getCurrentHistoryElement(){return this.history[this.currentHistoryElement]||{state:void 0,url:void 0}}decorateState(e,t=this.currentHistoryElement){return Object.assign(Object.assign({},e),{[this.historyManagerId]:t})}getIsBoot(e){if(Object(Ho.d)(this._store.getState(),Wo.Qh,Wo.i)){return Object(yc.a)(this._store.getState(),e).navigationsCount<=1}}ClearHistory(){this.history=[],this.currentHistoryElement=-1}HistoryBack(e){if(this._isPushToBrowserEnabled(e)){this.moveHistory(-1);const t=this.getCurrentHistoryElement();this.ExecuteOnHistoryBack(t.state,t.url,e)}else this._internalHistoryManager.HistoryBack(e)}PushState(e,t,n,r){try{if(this._isPushToBrowserEnabled(n)){const r=this.decorateState(e,this.currentHistoryElement+1);this.handlePushInHistory(r,t,n),this.ExecuteOnPushState(r,t,n)}else this._internalHistoryManager.PushState(e,t,n)}catch(n){r&&r.info(`PushState has error ${JSON.stringify(n)}. state: '${e}', url: '${t}'`)}}ReplaceState(e,t,n,r){try{if(this._isPushToBrowserEnabled(n)){const r=this.decorateState(e,this.currentHistoryElement>-1?this.currentHistoryElement:0);this.handleReplace(r,t,n),this.ExecuteOnReplaceState(r,t,n)}else this._internalHistoryManager.ReplaceState(e,t,n)}catch(n){r&&r.info(`ReplaceState has error ${JSON.stringify(n)}. state: '${e}', url: '${t}'`)}}GetCurrentUrl(e){return this._isPushToBrowserEnabled(e)?this.getCurrentHistoryElement().url:this._internalHistoryManager.GetCurrentUrl(e)}GetHistoryLength(e){return this._isPushToBrowserEnabled(e)?this.currentHistoryElement+1:this._internalHistoryManager.GetHistoryLength(e)}GetState(e){return this._isPushToBrowserEnabled(e)?this.getCurrentHistoryElement().state:this._internalHistoryManager.GetState(e)}RegisterOnPopState(e){this._internalHistoryManager.RegisterOnPopState(e)}_isPushToBrowserEnabled(e){return Object(yc.c)(this._store.getState(),e)}}var vc=n("D+Bz");class Sc extends _c{constructor(e,t){const n=function(){let e=null;try{e=window.history.state}catch(e){}if(!e)return null;let t=null;for(const n in e)if(e.hasOwnProperty(n)&&A.a.tryParseOrNull(n)){const r=window.sessionStorage.getItem(n);if(r){t={history:JSON.parse(r),index:e[n],managerId:n};break}}return t}();n?super(e,t,n.history,n.index,n.managerId):super(e,t),this._isInAppHistoryChanged=!1,window.addEventListener("popstate",this._handleOnPopState.bind(this))}_handleOnPopState(e){const t={source:vc.b.BrowserBack};this._updateHistoryOnPopStateChange(e),this._onPopStateEventCb&&this._onPopStateEventCb(e,t)}_updateHistoryOnPopStateChange(e){this._isInAppHistoryChanged?this._isInAppHistoryChanged=!1:this.moveHistory(this._getHistoryOffset(e))}_getHistoryOffset(e){const t=this.getCurrentHistoryElement().state,n=(e.state||{})[this.historyManagerId];return null==n?-1:n-t[this.historyManagerId]}_saveHistoryBackup(){const e=JSON.stringify(this.history);window.sessionStorage.setItem(this.historyManagerId,e)}updateCurrentHistoryElementForPush(e){this.getIsBoot(e)&&this.currentHistoryElement>-1||this.currentHistoryElement++}ExecuteOnHistoryBack(e,t,n){this._isInAppHistoryChanged=!0,window.history.back()}ExecuteOnPushState(e,t,n){this.getIsBoot(n)?window.history.replaceState(e,"",t):window.history.pushState(e,"",t),this._saveHistoryBackup()}ExecuteOnReplaceState(e,t=null,n){window.history.replaceState(e,"",t),this._saveHistoryBackup()}RegisterOnPopState(e){super.RegisterOnPopState(e),this._onPopStateEventCb=e}RegisterOnBeforeUnload(e){this._onBeforeUnloadCb=e,window.addEventListener("beforeunload",e)}Dispose(){window.removeEventListener("beforeunload",this._onBeforeUnloadCb),this._onPopStateEventCb=void 0,this._onBeforeUnloadCb=void 0}decorateState(e,t=this.currentHistoryElement){return this._decorateWithHistoryLength(super.decorateState(e,t))}_decorateWithHistoryLength(e){let t=null;try{t=window.history.state}catch(e){}return Object.assign(Object.assign({historyLengthOnInitialLoad:window.history.length},t),e)}}var Oc=n("9L53");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class Cc extends _c{ExecuteOnHistoryBack(e,t,n){const r=new Oc.a;r.state=e,this._onPop(r)}ExecuteOnPushState(e,t){}ExecuteOnReplaceState(e,t){}RegisterOnPopState(e){super.RegisterOnPopState(e),this._onPop=e}RegisterOnBeforeUnload(e){}Dispose(){this._onPop=void 0}}var Ec=n("TEuE"),Ic=n("xPbo"),wc=n("JC5U"),jc=n("ZuxC"),Pc=n("pF61"),Tc=n("QHx/");var Nc=n("Lc3p");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Ac(e){return{type:"router.set.prerender.state",payload:{preRendering:e}}}function Rc(e){return{type:"router.set.preloading.state",payload:{preLoading:e}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const Dc={baseUrl:void 0,preLoading:!1};function xc(e=Dc,t){const n=function(e,t){if("router.set.baseurl"===t.type&&void 0!==t.payload.baseUrl)return t.payload.baseUrl;return e}(e.baseUrl,t),r=function(e=!1,t){if("router.set.prerender.state"===t.type&&void 0!==t.payload.preRendering)return t.payload.preRendering;return e}(e.preRendering,t),a=function(e=!1,t){if("router.set.preloading.state"===t.type&&void 0!==t.payload.preLoading)return t.payload.preLoading;if(t.type===Mi.m)return!1;return e}(e.preLoading,t);return t.type===mo.b&&t.payload.routerState?t.payload.routerState:n!==e.baseUrl||r!==e.preRendering||a!==e.preLoading?Object.freeze({baseUrl:n,preRendering:r,preLoading:a}):e}var Mc=n("arV0"),Fc=n("wF0i"),kc=n("bsQO"),Lc=n("oqdd"),Bc=n("ruPX"),Uc=n("tICD"),Vc=n("si7p"),zc=n("YxC/"),qc=n("olZa");var Hc=n("E7fB");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let Wc;class Gc{constructor(e,t,n,r,a){this._sharedVariables={},this._store=e,this._depth=n,this._eventArgs=r,Wc=t,a&&(this._sharedVariables=a._sharedVariables)}getContext(){return this._context||(this._context=new Hc.a(this._store,Object(Pc.c)(this._store.getState()))),this._context}getDepth(){return this._depth}getEventArgs(){return this._eventArgs}getEventSource(){return Wc.TraceManager.getTracer(Il.ROUTER_TRACER_CATEGORY).error("getEventSource was called on NavigationEventContext"),null}getFormContext(){return Wc.TraceManager.getTracer(Il.ROUTER_TRACER_CATEGORY).error("getFormContext was called on NavigationEventContext"),null}getSharedVariable(e){return this._sharedVariables[e]}setSharedVariable(e,t){this._sharedVariables[e]=t}}var Kc=n("4leG"),Qc=n("amNf"),Xc=n("rcL5"),Yc=n("oT5e"),Jc=n("QGYZ");class $c{constructor(e,t,n,r,a,i){this._state=e,this._preventDefault=a||!1,this._navigationOptions=i,this._pageUrl=r,this._pageParameters=n,this._pageInput=Object(Ho.e)(e,Wo.Nc,Wo.o)?Object(Qc.b)(e,t,"XrmClientApi.NavigationEventArgs",[{name:"XrmClientApi.NavigationEventArgs",value:"PageInput"}]):void 0}get pageUrl(){return this._pageUrl}get pageParameters(){return this._pageParameters}get pageInput(){return this._pageInput}get navigationOptions(){return this._navigationOptions}get sourceId(){var e;return!this._sourceId&&(null===(e=this._navigationOptions)||void 0===e?void 0:e.sourceBrowsingContext)&&(this._sourceId=Zc(this._state,this._navigationOptions.sourceBrowsingContext)),this._sourceId}get targetId(){var e;return!this._targetId&&(null===(e=this._navigationOptions)||void 0===e?void 0:e.targetBrowsingContext)&&(this._targetId=Zc(this._state,this._navigationOptions.targetBrowsingContext)),this._targetId}isDefaultPrevented(){return this._preventDefault}preventDefault(){this._preventDefault=!0}}function Zc(e,t){var n,r;const a=Object(Yc.a)(e,t);return 0===a.type?null===(n=Object(Jc.a)(e,a.id))||void 0===n?void 0:n.id:1===a.type?null===(r=Object(Xc.f)(e,a.id))||void 0===r?void 0:r.sidePanelId:void 0}var el=n("GEbX"),tl=n("Knfm"),nl=n("G4xW"),rl=n("tFCh"),al=n("+nTZ");const il=new Set,ol=new Set,sl=new Set;var cl=n("yHXp");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const ll={getName:()=>cl.a,getRequiredAttributes(){throw new Error("Not Implemented")},throwIfInvalidUrl(e){if(!e||!e.modalDialogType||e.modalDialogType!==Vc.a&&e.modalDialogType!==Vc.c&&e.modalDialogType!==Vc.d||!e.text||0===e.text.length)throw Object(f.d)("Missing or invalid URL parameter: type",P.b)},createPageModule:e=>n.e(137).then(n.bind(null,"n8uW")).then(({ModalDialog:t})=>new t(e)),getTelemetryAttributes:e=>[{name:E.b.ModalDialogType,value:e&&e.modalDialogType}]};Object.freeze(ll);var ul=n("xagu");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const dl=!1,pl="100%",fl="100%",gl="rgba(0, 0, 0, 0.5)",hl={type:vc.a.Dialog,pageType:"modaldialog",factory:ll,getDialogOptions(e){var t,n;return{width:pl,height:fl,openInNewWindow:(null===(t=e.dialogOptions)||void 0===t?void 0:t.openInNewWindow)?e.dialogOptions.openInNewWindow:dl,shadowColor:(null===(n=e.dialogOptions)||void 0===n?void 0:n.shadowColor)?e.dialogOptions.shadowColor:gl,overflow:"auto"}},urlToInput(e){const t=e.searchParams;let n;switch(t.get(ul.s)){case Vc.a:n=Vc.a;break;case Vc.c:n=Vc.c;break;case Vc.d:n=Vc.d;break;case Vc.g:n=Vc.g;default:throw Error(ul.t)}const r=t.get(ul.q);let a,i,o,s,c,l,u,d;return t.has(ul.n)&&(a=JSON.parse(t.get(ul.n))),t.has(ul.r)&&(i=t.get(ul.r)),t.has(ul.p)&&(o=t.get(ul.p)),t.has(ul.k)&&(s=t.get(ul.k)),t.has(ul.j)&&(c=t.get(ul.j)),t.has(ul.o)&&(l=t.get(ul.o)),t.has(ul.m)&&(u=JSON.parse(t.get(ul.m))),t.has(ul.l)&&(d=JSON.parse(t.get(ul.l))),{modalDialogType:n,text:r,title:i,subtitle:o,confirmButtonLabel:s,cancelButtonLabel:c,dialogOptions:a,showDetailsLabel:l,errorDetails:d,hideDownloadLogLink:u}},inputToUrl(e,t){const n=new URL(e,window.location.origin),r=n.searchParams;return r.set(ul.s,t.modalDialogType),r.set(ul.q,t.text),t.dialogOptions&&r.set(ul.n,JSON.stringify(t.dialogOptions)),t.title&&r.set(ul.r,t.title),t.subtitle&&r.set(ul.p,t.subtitle),t.confirmButtonLabel&&r.set(ul.k,t.confirmButtonLabel),t.cancelButtonLabel&&r.set(ul.j,t.cancelButtonLabel),t.showDetailsLabel&&r.set(ul.o,t.showDetailsLabel),t.errorDetails&&r.set(ul.l,JSON.stringify(t.errorDetails)),n.href}};Object.freeze(hl);var ml=n("7Sr4"),bl=n("WkRo"),yl=n("F1Lu"),_l=n("VgPQ"),vl=n("Z4sG"),Sl=n("QbIY");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function Ol(e,t,n,r,a){e&&t&&n&&e(function(e,t,n,r){return{type:Mi.u,payload:{dialogContextId:t,pageType:n,output:r},meta:{pageId:e}}}(t,n,r,a))}var Cl=n("Tz6o");const El=h.a.createEvent("LoadPageModule",m.c);class Il{constructor(e,t,n){this._onBeforeUnload=this._onBeforeUnload.bind(this),this._onPopState=this._onPopState.bind(this),this._applicationContext=e,this._tracer=this._applicationContext.TraceManager.getTracer(Il.ROUTER_TRACER_CATEGORY),this._pageMappings=t,this._pagesAction={},this._nextPageId=0,this._nextDialogContext=0,this._pages={},this._inputs={},this._activeDialogs=[],this._livePageIds=[],this._pagesReducer=Object(Nc.a)(this._pages),this._preNavigationHandlers={},this._globalPreNavigationHandlers=[],this._postNavigationHandlers=[],this._navigationBeginHandlers=[],this._historyManager=n,this._historyManager.RegisterOnPopState(this._onPopState),this._historyManager.RegisterOnBeforeUnload(this._onBeforeUnload)}setHistoryManager(e){this._disposeHistoryManager(),this._historyManager=e,this._historyManager.RegisterOnPopState(this._onPopState),this._historyManager.RegisterOnBeforeUnload(this._onBeforeUnload)}addGlobalOnPreNavigation(e){this._globalPreNavigationHandlers.push(e)}removeGlobalOnPreNavigation(e){for(let t=0;t<this._globalPreNavigationHandlers.length;t++)if(this._globalPreNavigationHandlers[t]===e){this._globalPreNavigationHandlers.splice(t,1);break}}getPageMappings(){return this._pageMappings}removeDialogFromStack(e){this._activeDialogs.splice(this._activeDialogs.findIndex(t=>t.id===e),1)}_navigate(e,t,n,r,a,i,o,s,c){const l=Object(Pc.c)(this._store.getState());!r&&this._store.dispatch(Object(Ic.c)(c.targetBrowsingContext)),Object(Ec.e)(Ec.b);const u=i||String(this._nextPageId++);document.body.setAttribute("data-loaded","0");const d=t.getName(),p=function(e,t,n,r){const a=e.getKeyForThawedCheck&&e.getKeyForThawedCheck(t);let i=0;if(il.has(n))i=3;else if(il.add(n),ol.has(r)?i=1:ol.add(r),a){const e=a+r;sl.has(e)?i=2:sl.add(e)}return i}(t,n,a,d),f=this._pages[l],g=f?f.getName():"none",h=Object(I.c)(t.getTelemetryAttributes(n,e.getState()));h[E.n.PageName]=d,h[E.n.LoadType]=p.toString(),h[E.b.PageLoadParameters.NavigationOrigin]=g,Object(Fc.f)(d,h),O.a.onNextIdleProcessing(e=>{this._onAppIdle(d,p)});const m=v.a.trackWork("createPageModule");return this._runNavigationBeginHandlers(t.getName()).then(()=>{const a=El.startStopwatch(),i=t.createPageModule(u);i.then(()=>{a(),m()},()=>{a(),m()});const l=[i];return this._preInitializePage(t,n,u,l),Promise.all(l).then(([a,i])=>{let l;O.a.addKeyPerformanceIndicator("PageNavigationModuleReady"),this._pages[u]=a,this._inputs[u]={factory:t,input:n};const d=new Promise(e=>{l=e});return this._pagesAction[u]={pageOutputPromise:d,pageOutputPromiseResolvers:l,preClosePageHandlers:[]},r?this._navigateToDialog(e,u,a,n,c,o):(Object(b.b)(()=>{this.garbageCollector()},"Run garbage collection after navigation"),this._livePageIds.push(u)),this._store.dispatch(Object(bl.c)(c.targetBrowsingContext)),this._tracer.info(`PageModule has been created. Page name: '${a.getName()}', PageId: '${a.getId()}'`),this._runPostNavigationHandler(a.getName()),[a,n,r,s,t.getTelemetryAttributes(n,e.getState()),i]})})}_navigateToDialog(e,t,n,r,a,i){if(this._activeDialogs.push({id:t,page:n}),i){const n=Object(al.b)(this._store.getState(),i);if(n&&(r.dialogOptions||r.pageType===hl.pageType||(r.dialogOptions=Object(Mc.f)(e.getState(),i)),a.replaceState))return e.dispatch(Object(rl.d)(n.dialogContextId,t,a,i))}return e.dispatch(Object(rl.b)(String(++this._nextDialogContext),t,i,a.targetBrowsingContext))}_preInitializePage(e,t,n,r){if(e.preInitializePage){const a=v.a.trackWork("preInitializePage"),i=this._store.dispatch(e.preInitializePage(t,n));i.then(a,a),r.push(i)}if(e.predictedNextPageFactories)for(const n of e.predictedNextPageFactories)if(n.preInitializePage&&n.getPredictedPageInput){const r=n.getPredictedPageInput(e.getName(),t);if(r){const e=Object(nl.a)(n.preInitializePage(r,null));this._store.dispatch(e)}}}garbageCollector(){const e=this._store.getState();if(this._livePageIds.length>=10){let t=-1;for(const n of this._livePageIds){if(t++,void 0===e.pages[n]){const r=[{name:"pageIndex",value:n},{name:"livePageIds",value:JSON.stringify(this._livePageIds)},{name:"pages",value:JSON.stringify(Object.keys(e.pages))}];this._tracer.warn("Trying to access a page which does not exist.",r),this._livePageIds.splice(t,1);break}if(Object(Pc.m)(e,n)){this._store.dispatch(Object(F.f)(n)),this._livePageIds.splice(t,1);break}}}}navigateTo(e,t,n,r){return Object(T.c)(e.pageName)?this._navigateToUrl(e,t,n,r):this._navigateToPage(e,t,n,r)}_navigateToPage(e,t,n,r){try{const a=this._historyManager.GetCurrentUrl(t),i=this._pageMappings.getPageFromPageName(e,t),{factory:o,isRedirect:s}=i,{isDialogNavigation:c,dialogOptions:l}=Object(Pc.d)(n.getState(),i,t,r),u=s,d=t.source;let p="";u&&(p=this._pageMappings.getUrlForPage(o.getName(),e.input,a,d),e.input.appshellmode=this._pageMappings.getPageFromUrl(p,t).input.appshellmode);const f=String(this._nextPageId++),g=wl(f,o.getName());return!c&&t.replaceState?(p=this._pageMappings.getUrlForPage(o.getName(),e.input,a,d),e.input.appshellmode=this._pageMappings.getPageFromUrl(p,t).input.appshellmode,this._historyManager.ReplaceState(g,p,t,this._tracer)):!c&&g&&(p=this._pageMappings.getUrlForPage(o.getName(),e.input,a,d),e.input.appshellmode=this._pageMappings.getPageFromUrl(p,t).input.appshellmode,this._historyManager.PushState(g,p,t,this._tracer)),this._navigate(n,o,e.input,c,p,f,r,l,t)}catch(e){return e&&(e.message&&this._tracer.error(e.message),e={name:e.name,errorCode:e.errorCode,message:e.message,stack:e.stack}),Promise.reject(e)}}_navigateToUrl(e,t,n,r){try{const a=this._historyManager.GetCurrentUrl(t),i=this._pageMappings.getPageFromUrl(e.pageName,t),{factory:o,input:s,isRedirect:c}=i,{isDialogNavigation:l,dialogOptions:u}=Object(Pc.d)(n.getState(),i,t,r);(c||/^\/([0-9a-zA-Z_]+\/)?main.aspx/.test(e.pageName))&&(e.pageName=this._pageMappings.getUrlForPage(o.getName(),s,a,t.source));const d=String(this._nextPageId++),p=wl(d,o.getName());return!l&&t.replaceState?this._historyManager.ReplaceState(p,e.pageName,t,this._tracer):!l&&p&&this._historyManager.PushState(p,e.pageName,t,this._tracer),this._navigate(n,o,s,l,e.pageName,d,r,u,t)}catch(e){return e&&e.message&&this._tracer.error(e.message),Promise.reject(e)}}navigateBack(e){const t=new Promise(e=>this._navigationPromiseResolver=e);return this._historyManager.HistoryBack(e),t}navigateToNewWindow(e){return new yl.a(this._applicationContext,this._store).openUri(e).then(e=>({status:0,windowProxy:void 0,pageId:void 0})).catch(e=>({status:1}))}navigateBackOutOfApp(e){const t=new yl.a(this._applicationContext,this._store);return t.isOperationAvailableAndEnabled("navigateBackOutOfApp")&&Object(yc.c)(this._store.getState(),e)?t.navigateBackOutOfApp():Promise.resolve({status:1})}redirectToDefault(e){return Object(Ho.e)(this._store.getState(),Wo.Lg,Wo.o)&&(e=Object.assign(Object.assign({},e),{replaceState:!0})),this._store.dispatch(Object(Sl.a)(e))}navigateInternal(e,t){try{let n,r,a,i=!1;const o=this._historyManager.GetCurrentUrl(t),s=Object(Pc.c)(this._store.getState()),c=String(this._nextPageId++);if(e&&e.pageId)if(r=this._store.dispatch(Object(Cl.c)(e.pageId))||Object(Mc.j)(this._store.getState(),e.pageId),void 0!==r){a=this._pageMappings.getPageFromPageName({pageName:e.pageName},t),({factory:n,isDialog:i=!1}=a);const r={pageId:c,pageName:e.pageName};this._historyManager.ReplaceState(r,o,t)}else a=this._pageMappings.getPageFromUrl(o),({factory:n,input:r,isDialog:i=!1}=a);else a=this._pageMappings.getPageFromUrl(o),({factory:n,input:r,isDialog:i=!1}=a);const l=Object(Pc.d)(this._store.getState(),a,t,s);return i=l.isDialogNavigation,this._navigate(this._store,n,r,i,o,c,s,l.dialogOptions,t)}catch(e){return e&&e.message&&this._tracer.error(e.message),Promise.reject(e)}}cleanUp(e){Object(Ho.f)(this._store.getState(),Wo.gg)?this._cleanUp(e):Object(b.b)(()=>{this._cleanUp(e)},"Clean up router pages")}_cleanUp(e){delete this._pages[e],delete this._pagesAction[e],delete this._inputs[e],delete this._preNavigationHandlers[e]}registerPreNavigationHandler(e,t){t||(t=Object(Pc.c)(this._store.getState()),this._tracer.warn("pageId is not provided to registerPreNavigationHandler")),this._preNavigationHandlers[t]||(this._preNavigationHandlers[t]=[]),this._preNavigationHandlers[t].includes(e)||this._preNavigationHandlers[t].push(e)}registerPostNavigationHandlers(e){this._postNavigationHandlers.push(e)}registerNavigationBeginHandlers(e){this._navigationBeginHandlers.push(e)}_removePreNavigationHandlers(e){e||(e=Object(Pc.c)(this._store.getState()),this._tracer.warn("pageId is not provided to registerPreNavigationHandler")),this._preNavigationHandlers[e]=void 0}_removePreCloseHandler(e){this._pagesAction[e].preClosePageHandlers=[]}registerPreCloseHandler(e,t){this._pagesAction[e].preClosePageHandlers.push(t)}getPageOutputPromise(e){if(void 0===this._pagesAction[e]){let t;const n=new Promise(e=>{t=e});this._pagesAction[e]={pageOutputPromise:n,pageOutputPromiseResolvers:t,preClosePageHandlers:[]}}return this._pagesAction[e].pageOutputPromise}_getPageOutputResolver(e){return this._pagesAction[e].pageOutputPromiseResolvers}_runClosePageHandlers(e){return this._pagesAction[e]?ml.a.getInstance().checkForOutstandingWork(this._store.getState()).then(()=>{const t=this._pagesAction[e].preClosePageHandlers;if(t&&t.length>0){return t.reduce((e,t)=>e.then(()=>t(this._store.getState,this._store.dispatch)),Promise.resolve())}}):Promise.resolve()}_runPostNavigationHandler(e){this._postNavigationHandlers&&this._postNavigationHandlers.length>0&&this._postNavigationHandlers.forEach(t=>{t(this._store.getState,this._store.dispatch,e)})}_runNavigationBeginHandlers(e){const t=this._navigationBeginHandlers.map(t=>t(this._store.getState,this._store.dispatch,e));return Promise.all(t).then(()=>{this._tracer.info("runNavigationBeginHandlers completed successfully")}).catch(e=>{this._tracer.error(`runNavigationBeginHandlers completed with failure : '${e.message}'`)})}isPageADialog(e,t,n,r){let a;try{a=Object(T.c)(t.pageName)?this._pageMappings.getPageFromUrl(t.pageName,n):this._pageMappings.getPageFromPageName(t,n)}catch(e){return!1}return Object(Pc.d)(e,a,n,r).isDialogNavigation}shouldNavigate(e,t,n,r){n||(this._tracer.warn("A pageId was not provided to shouldNavigate"),n=Object(Pc.c)(this._store.getState(),null==r?void 0:r.targetBrowsingContext));if(e&&this.isPageADialog(this._store.getState(),e,r,n))return Promise.resolve(!0);return ml.a.getInstance().checkForOutstandingWork(this._store.getState()).then(()=>{const e=this._store.getState(),r=Object(Yc.b)(e,n);if(!r)return!0;const a=Object(Pc.b)(e,r.id);return!a||!t||"welcomePagedialog"===Object(Pc.j)(this._store.getState(),a)||this._store.dispatch((i=n,{type:"router.open.confirm.dialog.async",execute({dispatch:e,getState:t},n){const r=Object(zc.h)()(t(),[qc.e]),a={modalDialogType:Vc.e,text:"Unsaved change",title:Object(zc.c)(r,qc.e)};return e(Object(Bc.a)("ModalDialog",a,i)).then(t=>0===t.status&&e(Object(Uc.a)(t.pageId)).then(e=>e.value.confirmed))}}));var i}).then(n=>{let a=!0;if(Object(Ho.f)(this._store.getState(),Wo.o)&&(r&&r.replaceState?a=!1:t||(a=!1)),e&&e.pageName&&e.input&&this._globalPreNavigationHandlers.length&&a){let t,a=0;const i=e.input,o=this._pageMappings.getMappingForPage(e),s=this._pageMappings.getBaseUrl(),c=function(e,t,n,r){if(!e)throw new Error("Page Input is null");if(!n)throw new Error("Base Url is null");if(!r)throw new Error("State is null");const a=new URL(n.toLowerCase(),window.location.origin),i=a.searchParams.get("navbar")||void 0,o=a.searchParams.get("appid")||"",s="true"===a.searchParams.get("ribbondebug")||!1,c=Object(Kc.a)(r);return{etn:e.entityTypeName,formid:e.formid&&e.formid.guid,formParameters:e.data||{},pagetype:t,id:e.id&&e.id.guid||e.dashboardId&&e.dashboardId.guid,viewid:e.viewid&&e.viewid.guid,viewtype:e.viewType,navbar:i,cmdbar:c,ribbonDebug:s,appid:o}}(i,o.pageType,s,this._store.getState()),l=this.createUrlForPage(e.pageName,i);return this._globalPreNavigationHandlers.reduce((e,n)=>e.then(e=>{const o=new $c(this._store.getState(),i,c,l,!e,r);t=new Gc(this._store,this._applicationContext,a++,o,t);try{n(t)}catch(e){this._applicationContext.TraceManager.getTracer(Il.ROUTER_TRACER_CATEGORY).error(e,[{name:"baseUrl",value:s},{name:"pageParameters",value:JSON.stringify(c)}])}return e&&!o.isDefaultPrevented()}),Promise.resolve(n))}return n}).then(e=>e&&this._preNavigationHandlers[n]&&this._preNavigationHandlers[n].length?this._preNavigationHandlers[n].reduce((e,t)=>e.then(n=>n?t(this._store.getState()):e),Promise.resolve(e)):e).then(e=>(e&&this._removePreNavigationHandlers(n),e))}shouldDialogClose(e){return ml.a.getInstance().checkForOutstandingWork(this._store.getState()).then(()=>!this._preNavigationHandlers[e]||!this._preNavigationHandlers[e].length||this._preNavigationHandlers[e].reduce((e,t)=>e.then(n=>n?t(this._store.getState()):e),Promise.resolve(!0))).then(t=>(t&&this._removePreNavigationHandlers(e),t))}keepUrl(){const e=Object(Pc.c)(this._store.getState()),t=this._historyManager.GetCurrentUrl(),n=this._inputs[e],r=n.factory.getName(),a=wl(e,r),i=this._pageMappings.getUrlForPage(r,n.input,t);if(a){const t=Object(Tc.a)(this._store.getState(),e,vc.b.Other);this._historyManager.PushState(a,i,t,this._tracer)}}preRenderCheck(e){try{const t=this._pageMappings.getFactoryForPage({pageName:e.pageName});return t&&t.prePageRender?(this._store.dispatch(Ac(!0)),t.prePageRender(e.input,this._applicationContext,this._store.dispatch,this._store.getState).then(e=>(this._store.dispatch(Ac(!1)),e.resultType===Lc.a.Fail&&(e.resultValue=e.resultValue||Object(f.d)("Error occurred during pre-rendering",2415919107)),e))):Promise.resolve({resultType:Lc.a.Success})}catch(e){return e=e||Object(f.d)("Error occurred during pre-rendering",2415919107),Promise.reject(e)}}preCloseCheck(e,t){try{const n=this._pages[e];return n&&n.prePageClose?n.prePageClose(e,this._applicationContext,this._store.dispatch,this._store.getState,t).then(e=>e):Promise.resolve({resultType:Lc.a.Success})}catch(e){return e=e||Object(f.d)("Error occurred during pre-CloseCheck",2415919107),Promise.reject(e)}}closePage(e,t){return this._runClosePageHandlers(e).then(()=>{const n=Object(Mc.h)(this._store.getState(),e),r=this._pages[e];if(!r)throw Object(f.d)("Trying to close the page which was already closed",2415919107,[{name:"PageId",value:e}]);const a=Object(Yc.b)(this._store.getState(),e),i=Object(al.c)(this._store.getState(),e),o=Object(Mc.c)(this._store.getState(),e);if(o){const e=[{name:"numberOfDialogContextIds",value:Object.keys(o).length}];this._tracer.warn("Number of dialog context ids in dialog context outputs",e)}const s=this._getPageOutputResolver(e),c=r&&r.getCloseAction(t);if(!c)return s(null),this._activeDialogs=this._activeDialogs.filter(t=>t.id!==e),{isDialog:n,output:{reason:t,value:void 0}};return this._store.dispatch(c).then(r=>{const o={reason:t,value:r};return this._activeDialogs=this._activeDialogs.filter(t=>t.id!==e),n&&Ol(this._store.dispatch,null==i?void 0:i.sourcePageId,null==i?void 0:i.dialogContextId,Object(Mc.p)(this._store.getState(),e),o),s(o),this._removePreCloseHandler(e),a&&this._store.dispatch(Object(bl.c)(a.id)),{isDialog:n,output:o}})})}addPopup(e,t,n){const r=String(++this._nextDialogContext);this._store.dispatch(Object(rl.b)(r,e,void 0,t)),this._activeDialogs.push({id:e,page:void 0,closeHandler:n})}getPopup(e){return this._activeDialogs[this._activeDialogs.findIndex(t=>t.id===e)]}_onAppIdle(e,t){document.body.setAttribute("data-loaded","1"),3===t&&Object(kc.b)(),"EditForm"===e&&Object(kc.a)()}_onPopState(e,t){if(e.preventDefault(),!(t=t||{}).targetBrowsingContext){const n=e.state&&e.state.pageId,r=this._store.getState(),a=n&&Object(Yc.b)(r,n);t.targetBrowsingContext=a?a.id:Object(Yc.g)(r)}this._navigationPromiseResolver?(this._navigationPromiseResolver(this.navigateInternal(e.state,t)),this._navigationPromiseResolver=null):this._store.dispatch(function(e,t){return{type:"router.navigateInternal.async",execute({dispatch:n,getState:r},a){const i=a.Router;if(!t){const n=e&&e.pageId?e.pageId:Object(Pc.c)(r());t=Object(Tc.a)(r(),n)}return i.shouldNavigate().then(a=>a?n(Object(F.d)(t.targetBrowsingContext)).then(()=>(n(Object(wc.b)(t.targetBrowsingContext)),i.navigateInternal(e,t).then(([e,a,i,o,s,c])=>{const l=i?Object(Pc.c)(r()):e.getId();return n(Object(Ic.d)(l,e.getId(),t.targetBrowsingContext)),n(Object(jc.c)(e,a,i,c))},e=>(e&&(e={name:e.name,errorCode:e.errorCode,message:e.message,stack:e.stack}),n(Object(Ic.e)(e,t.targetBrowsingContext)),{status:1,error:e})))).catch(e=>({status:1,error:e={name:e.name,errorCode:e.errorCode,message:e.message,stack:e.stack}})).then(e=>(n(Object(wc.a)(t.targetBrowsingContext)),e)):(t&&t.source===vc.b.BrowserBack&&i.keepUrl(),{status:1,error:new Error("Navigation is not allowed")}))}}}(e.state,t))}_onBeforeUnload(e){const t=document.createEvent("HTMLEvents");t.initEvent("blur",!0,!0),document.dispatchEvent(t);const n=this._store.getState(),r=this._pages[Object(Pc.c)(n)],a=r&&r.beforePageUnload&&r.beforePageUnload(n),i=Object(tl.a)(this._store.getState());if(a||i===el.a.MultiSession)return e.returnValue=""}getHistoryManager(){return this._historyManager}getPage(e){const t=this._pages[e];return t?t.getRootComponent():void 0}getAliveTemplates(e){const t=Object.keys(this._pages).reduce((t,n)=>{var r;const a=this._pages[n];if(!a)return;const i=e===n,o=null===(r=a.getTemplateName)||void 0===r?void 0:r.call(a,this._inputs[n].input);if(o||i){const e=o||n;t[e]={pageId:a.getId(),templateName:e,component:a.getRootComponent()}}return t},{});return Object.keys(t).sort().map(e=>t[e])}getPageDefinitions(){return this._pages}getPageModuleInput(e){return this._inputs[e]}getDialogIdStack(){const e=[];for(const t of this._activeDialogs)e.push(t.id);return e}createUrlForPage(e,t,n,r){var a;const i=null===(a=this._historyManager)||void 0===a?void 0:a.GetCurrentUrl();return this._pageMappings.getUrlForPage(e,t,i,n,r)}createWebUrlForPage(e,t,n,r){return this._pageMappings.getWebUrlForPage(t,n,e,r)}createMobileClientUrlForPage(e,t,n){const r=this._historyManager.GetCurrentUrl();return this._pageMappings.getMobileClientUrlForPage(e,t,r,n)}initializeManager(e){this._store=e;const t=this._pageMappings.getBaseUrl();this._store.dispatch({type:"router.set.baseurl",payload:{baseUrl:t}})}restoreRouter(e,t){const{pages:n,router:r}=e;this._store.dispatch(Object(mo.d)(n,r)),this._store.dispatch(Rc(!0)),Object(b.b)(()=>{this._store.dispatch(Rc(!1))},"Clear preload flag after app becomes idle");const a={};if(!n)return a;const i=Object.keys(n);i&&i.length&&(this._nextPageId=Number.parseInt(i[i.length-1],10)+1);const o=e.dialogContexts&&Object.keys(e.dialogContexts);o&&o.length&&(this._nextDialogContext=Number.parseInt(o[o.length-1],10)+1);const s=Object(Pc.c)(e),c=t?i:i.filter(e=>e!==s);for(const t of c){const r=n[t];a[t]=this._restorePage(t,r,s);const i=Object(Mc.k)(e,t),o=[];i&&i.forEach(e=>{o.push(this._store.dispatch(B.b.apply(this,e)))}),Promise.all(o).then(()=>{const n=Object(Mc.i)(e,t);n&&n.forEach(e=>{switch(e.type){case 0:this._store.dispatch(en.e.apply(this,e.parameters));break;case 1:this._store.dispatch(pn.e.apply(this,e.parameters))}})})}return a}_restorePage(e,t,n){const r=this._pageMappings.getPageFromPageName({pageName:t.__pageName,input:t.input}),{factory:a,input:i,isDialog:o}=r,s=a.preInitializePage&&this._store.dispatch(a.preInitializePage(i,e)),c=a.createPageModule(e);return Promise.all([c,s]).then(([t,r])=>{let s;o?this._activeDialogs.push({id:e,page:t}):this._livePageIds.push(e),this._pages[e]=t,this._inputs[e]={factory:a,input:i};const c=new Promise(e=>{s=e});if(this._pagesAction[e]={pageOutputPromise:c,pageOutputPromiseResolvers:s,preClosePageHandlers:[]},this._store.dispatch(Object(_l.b)(e,!1)),Object(vl.a)(this._store,this._applicationContext,e),n===e&&!Object(Kc.c)(this._store.getState())){const t={pageId:e,pageName:a.getName()},n=this._historyManager.GetCurrentUrl(),r=this._pageMappings.getUrlForPage(a.getName(),i,n);this._historyManager.ReplaceState(t,r,null)}return()=>this._store.dispatch(t.getInitializationAction(r))})}getReducers(){return{pages:this._pagesReducer,router:xc}}updateDialogs(e){this._activeDialogs=e.map(e=>({id:e,page:this._pages[e]}))}dispose(){this._disposeHistoryManager()}isURLSupportedForNavigation(e){try{return this.getPageMappings().getPageFromUrl(e),!0}catch(e){return!1}}browsingContextCouldNavigateBack(e){return this.getHistoryManager().GetHistoryLength(e)>1}_disposeHistoryManager(){this._historyManager&&(this._historyManager.Dispose(),this._historyManager=void 0)}}function wl(e,t){if(e)return{pageId:e,pageName:t}}function jl(e,t,n,r){let a;switch(r){case ls.a.MobileApplication:a=new Cc(t,e.TraceManager);break;case ls.a.MailApp:a=function(){if(!window.history)return!1;try{window.history.replaceState(window.history.state,"")}catch(e){return!1}return!0}()?jo.a.getInstance().get_IsAndroidPhone()?new Cc(t,e.TraceManager):new Sc(t,e.TraceManager):new Cc(t,e.TraceManager);break;default:a=Object(Kc.c)(t.getState())?new bc.a(t,e.TraceManager):new Sc(t,e.TraceManager)}return new Il(e,n,a)}Il.ROUTER_TRACER_CATEGORY="router";var Pl=n("GotM"),Tl=n("5ylf"),Nl=n("WbTV"),Al=n("SSL+");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Rl=h.a.createEvent("Frame",m.C);class Dl{constructor(){this._timeByTask=null,this._trackerCallbackId=-1,this._debounceTimeoutId=-1,v.a.subscribeToAppWorking(()=>{this._timeByTask={},this._trackFrames(-1)}),v.a.subscribeToAppIdle(()=>{this._timeByTask=null,cancelAnimationFrame(this._trackerCallbackId),clearTimeout(this._debounceTimeoutId),this._debounceTimeoutId=-1}),this._timeByTask={},this._trackFrames(-1)}_trackFrames(e){if(null===this._timeByTask)return;const t=performance.now();if(-1!==e){const n=t-e;n>200&&this._sendSlowFrameInfo(e,n)}this._timeByTask={},this._debounceTimeoutId=setTimeout(()=>{this._trackerCallbackId=requestAnimationFrame(()=>{this._trackFrames(t)})},100)}_sendSlowFrameInfo(e,t){const n=[];for(const e in this._timeByTask){const t=this._timeByTask[e];t>10&&n.push({t:e,d:Math.round(t)})}Rl.createRetroactiveStopwatch(e,t,{tasks:JSON.stringify(n)})}writeMarker(e,t,n){}writeRetroactiveTimespan(e,t,n,r){this._captureEvent(e,n,r)}startTimespan(e,t,n){return(t,r)=>{this._captureEvent(e,t,Object.assign(Object.assign({},n),r))}}_captureEvent(e,t,n){if(null===this._timeByTask)return;let r=null;if(e.getZone()===m.f){const e=n[m.s];e&&(r=e)}else r=e.getName();r&&(this._timeByTask[r]?this._timeByTask[r]+=t:this._timeByTask[r]=t)}}var xl=n("+zAK"),Ml=n("2yvP"),Fl=n("K6rc"),kl=n("nJrx");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class Ll{constructor(e){this._index=-1,this._length=e,this._items=[]}enQueue(e){this._index++,this._index>=this._length&&(this._index=0),this._items[this._index]=e}find(e){if(this._index<0)return!1;for(let t=0;t<this._items.length;t++)if(this._items[t]===e)return!0;return!1}}var Bl=n("IaGr"),Ul=n("nC8a");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Vl=h.a.createEvent("initializeContainer","ScriptManager.Manager"),zl=h.a.createEvent("removeContainer","ScriptManager.Manager");class ql{constructor(e,t,n,r=document,a,i){this._cache={},this._removedContainers=[],this._containerEntryPool=[],this._traceManager=e,this._tracer=e.getTracer("ScriptManager"),this._target=r,this._eventManager=a,this._clientApiManager=i,this._circularQueue=new Ll(10),this._applicationContext=t,this._store=n}initializeContainerPool(){this._queueIframeCreation(),this._createIframeWhenWorkEnds()}_createIframeWhenWorkEnds(){for(let e=this._containerEntryPool.length;e<1;e++)Object(b.b)(()=>{this._queueIframeCreation()},"Create iframe")}initializeContainerForClientApi(e,t=!0){const n=Object(Mc.h)(this._store.getState(),e),r=Object(Ul.a)(this._store.getState(),e);return!t||e===this._previousPageId||n||r||(this._previousPageId&&Object(Pc.m)(this._store.getState(),this._previousPageId)&&this.removeContainer(this._previousPageId),this._previousPageId=e),this.initializeContainer(e).then(t=>(Object(Ml.b)("page.initialization",()=>{const n=this._clientApiManager.getClientApiEntry(e).xrmInstance;t.setGlobalVariable("Xrm",n)}),t))}initializeContainer(e){const t=this._cache[e];let n,r;if(void 0!==t&&(n=t.container,t.promise))return t.promise;if(this._circularQueue.enQueue(e),n){this._tracer.info(`initializeContainer called with id ${e} corresponding to an existing uninitialized container with no pre-created iframe`);const t=Vl.startStopwatch();r={id:e,container:n,promise:this._createScriptFrame(e).then(e=>(n.iFrame=e,n.initialize(),n)),removed:!1};const a=()=>t();r.promise.then(a,a)}else{const t=this._getScriptContainer();n=t.container,r={id:e,container:n,promise:t.promise.then(()=>(n.initEventManager(e),n.iFrame.id=Hl(e),n)),removed:!1}}return this._cache[e]=r,r.promise}_preInitializeContainer(){const e=Object(kl.a)(),t=Vl.startStopwatch(),n={container:new Fl.b(void 0,this._tracer,this._eventManager,this,this._applicationContext,this._store,this._clientApiManager),promise:this._createScriptFrame(e).then(t=>(this._tracer.info("Created script frame with ID "+e),n.container.iFrame=t,n.container.initialize(),n.container))},r=()=>t();return n.promise.then(r,r),n}_queueIframeCreation(){if(this._containerEntryPool.length<1){this._tracer.info("Queuing creation of script container");const e=this._preInitializeContainer();return this._containerEntryPool.push(e),e.promise}return this._tracer.info("Container Pool Full. Failed to queue creation of new script container"),null}_getScriptContainer(){const e=this._popScriptContainerFromPool();return e||(this._tracer.info("Container pool empty: _popScriptContainerFromPool returning promise for creation of new iframe"),this._preInitializeContainer())}_popScriptContainerFromPool(){if(this._containerEntryPool.length){const e=this._containerEntryPool.shift();return this._createIframeWhenWorkEnds(),this._tracer.info("_popScriptContainerFromPool returning a pre-created iframe"),e}return this._tracer.warn("Container Pool is empty, unable to retrieve a pre-initialized container"),null}_createScriptFrame(e){return new Promise((t,n)=>{const r=this._target.createElement("iframe");r.id=Hl(e),r.height=r.width=r.frameBorder="0",r.setAttribute("aria-hidden","true"),r.setAttribute("tabindex","-1"),r.setAttribute("src","/uclient/blank.htm"+Object(Io.c)()),r.setAttribute("name",e),r.onload=()=>{r.contentWindow.onbeforeunload=()=>{this._tracer.warn("Script container reloaded",[{name:"name",value:r.name},{name:"id",value:r.id}])},t(r)},r.onerror=()=>{n(new Error("Failed to create script container iframe"))},this._target.body.appendChild(r),Bl.a.initialize(r.contentWindow,this._eventManager,this._traceManager)})}getContainer(e){const t=this._cache[e];if(null==t){const t=new Error("Container does not exist"),n=[];try{n.push({name:"IsRecentPageId",value:this._circularQueue.find(e)}),n.push({name:"ContainerId",value:e})}catch(e){this._eventManager.ReportComponentFailure("ScriptManager.Manager.getContainer.addingParameter",e)}throw this._eventManager.ReportComponentFailure("ScriptManager.Manager.getContainer",t,null,n),t}return t.removed&&this._eventManager.ReportComponentFailure("ScriptManager.Manager.getContainer",new Error("Accessed removed container")),t.container}containerExists(e){const t=this._cache[e];return null!=t&&void 0!==t.container&&null!==t.container&&!t.removed}removeContainer(e,t=!1){const n=this._cache[e];if(t&&void 0!==n){this._removeContainer(n);const e=this._removedContainers.indexOf(n);-1!==e&&this._removedContainers.splice(e,1)}else void 0===n||n.removed||(n.removed=!0,this._removedContainers.push(n),1===this._removedContainers.length&&Object(b.b)(()=>{const e=zl.startStopwatch();this._removedContainers.forEach(this._removeContainer,this),this._removedContainers=[],e()},"Remove stale containers"))}_removeContainer(e){try{const t=e.container.getIFrame();t&&(t.contentWindow.onbeforeunload=void 0,this._target.body.removeChild(t)),this._clientApiManager.removeClientApiEntry(e.id)}catch(t){const n=[{name:"id",value:e.id}];this._eventManager.ReportComponentFailure("ScriptManager.Manager._removeContainer",t,void 0,n)}delete this._cache[e.id]}}function Hl(e){return"ClientApiFrame_"+e}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class Wl{constructor(){this._workTimeByType=null,v.a.subscribeToAppWorking(()=>{this._workTimeByType={},this._syncTime=0,this._customScriptTime=0,O.a.onNextIdleProcessing(this._processWorkBlockData.bind(this))}),v.a.isAppIdle()||(this._workTimeByType={},this._syncTime=0,this._customScriptTime=0,O.a.onNextIdleProcessing(this._processWorkBlockData.bind(this)))}writeMarker(e,t,n){}writeRetroactiveTimespan(e,t,n,r){this._captureEvent(e,n,r)}startTimespan(e,t,n){return(t,r)=>{this._captureEvent(e,t,Object.assign(Object.assign({},n),r))}}_captureEvent(e,t,n){if(null===this._workTimeByType)return;const r=e.getZone();if(r===Tl.NETWORK_REQUEST_EVENT_NAME){n["sync"]&&(this._syncTime+=t)}else{this._customScriptTime+=t;const a=r===m.f,i=a?"CustomControl":n.type,o=n.solutionName,s=n.solutionVersion,c=n.publisherName,l=a?n[m.s]:n.webResourceName,u=a?e.getName():n.method,d=n.requests;i&&c&&o&&s&&l&&u&&(this._workTimeByType[i]||(this._workTimeByType[i]={}),this._workTimeByType[i][c]||(this._workTimeByType[i][c]={}),this._workTimeByType[i][c][o]||(this._workTimeByType[i][c][o]={}),this._workTimeByType[i][c][o][s]||(this._workTimeByType[i][c][o][s]={}),this._workTimeByType[i][c][o][s][l]||(this._workTimeByType[i][c][o][s][l]={}),this._workTimeByType[i][c][o][s][l].hasOwnProperty(u)||(this._workTimeByType[i][c][o][s][l][u]=[]),this._workTimeByType[i][c][o][s][l][u].push({d:Math.round(t),r:d}))}}_processWorkBlockData(){null!==this._workTimeByType&&(O.a.addCommonKpiParameters({[E.b.PageLoadParameters.Attribution]:JSON.stringify(this._workTimeByType),[E.b.PageLoadParameters.CustomScriptTime]:Math.round(this._customScriptTime).toString(),[E.b.PageLoadParameters.SyncRequestTime]:Math.round(this._syncTime).toString()},!0),this._workTimeByType=null)}}var Gl=n("Z/4N"),Kl=n.p+"scripts/fpv2.min.js?v=1.4.3886-master";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Ql={1:"Latency",2:"Latency",8:"Throughput",16:"Throughput"};Object(_.exposeWorkBlockTracker)();var Xl=n("Hm+e"),Yl=n("t6P7"),Jl=n("lKf0"),$l=n("JhlA"),Zl=n("1SVz");function eu(e){const t=e.getState();if(Object(Ys.d)(t))e.dispatch(Object(La.b)("serverUnavailableNotification")),e.dispatch(Object(rr.f)());else{if(Object(Kc.e)(t))return;const n=Object(ts.a)(t)===ls.a.MobileApplication,r=Object(Ho.f)(t,Wo.v),a=Object(ic.C)(t),i=Object(ic.p)(t),o=r||a?null:{actionLabel:Object(zc.b)(t,Jl.r)||"Reconnect",eventHandler:()=>{e.dispatch(Object(rr.g)(Object(zc.b)(t,$l.e)||"Reconnecting...",Object(zc.b)(t,$l.f)||Zl.b,Object(zc.b)(t,$l.d)||Zl.a))}},s=Object(Zo.r)(t),c=a?Object(zc.b)(t,$l.i)||"You are now working in offline mode.":s?Object(zc.b)(t,Jl.u):Object(zc.b)(t,Jl.t)||"The application has lost connectivity to the server. You might not see all the records as you are offline.",l={id:"serverUnavailableNotification",level:Object(is.c)(e.getState())?4:3,message:c,title:null,action:o,type:1,onCloseHandler:null,showCloseButton:n};e.dispatch(Object(ka.b)(l)),function(e,t,n){const r=!t&&Object(Ho.f)(e,Wo.z)&&!Object(is.e)(e),a=t&&Object(Ho.f)(e,Wo.z)&&Object(Ho.f)(e,Wo.Qg)&&!n;return r||a}(t,n,i)&&e.dispatch(Object(rr.h)(ir.a.BlockingUI))}}var tu=n("6/BY");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function nu(e,t){e.DataSource.saveSessionState("LastAccessedApp",null,!1),t.dispatch(Object(Ot.b)(null))}var ru=n("0iNb"),au=n("n3bs");class iu{constructor(e,t,n,r){this._baseURL=e,this._pageTypeExtractor=n||this._extractPageType,this._registerMappings(t),this._decorator=r}getPageFromUrl(e,t={}){const n=t.source?t.source:vc.b.Other,r=new URL(e,window.location.origin),a={pageName:e},i=this.getMappingForPage(a);let o=null,s=null,c=!1,l=!1;try{if(!i)throw Object(f.d)("Unknown page type",2415919105);s=Object.assign(Object.assign({},i.urlToInput(r)),{pageType:i.pageType}),o=i.factory,this._decorator&&(s=this._decorator.decorateInput(s,e,n)),o.throwIfInvalidUrl&&o.throwIfInvalidUrl(s)}catch(e){throw Object(f.b)(e,[{name:"pageName",value:a.pageName},{name:"source",value:n}]),e}return this._isDialogMapping(i)&&(c=!0),i.isRedirect&&(l=i.isRedirect),{factory:o,input:s,isDialog:c,isRedirect:l,mapping:i}}getPageFromPageName(e,t={}){const n=t.source?t.source:vc.b.Other;let r=!1;const a=this._pageModulesByName[e.pageName];try{if(!a)throw Object(f.d)("Unknown page type",2415919105);this._isDialogMapping(a)&&(r=!0),e.input&&(e.input.pageType=e.input.pageType?e.input.pageType:a.pageType)}catch(t){throw t.errorCode||(t.errorCode=2415919107),Object(f.b)(t,[{name:"pageName",value:e.pageName},{name:"source",value:n}]),t}return{factory:a.factory,input:e.input,isDialog:r,isRedirect:a.isRedirect,mapping:a}}_isDialogMapping(e){return e.type===vc.a.Dialog}getUrlForPage(e,t,n,r=vc.b.Other,a=!1){const i=new URL(this._baseURL.toString(),window.location.origin),o=i.searchParams,{inputToUrl:s,pageType:c}=this._pageModulesByName[e];o.set("pagetype",c);const l=s(i.href,t,a);return this._decorator?this._decorator.decorateUrl(new URL(l,window.location.origin),new URL(n,window.location.origin),r,t,a).href:l}getWebUrlForPage(e,t,n){const{inputToWebUrl:r}=this._pageModulesByName[e];return r?r(n,t):""}getMobileClientUrlForPage(e,t,n,r=vc.b.Other){const a=new URL("ms-dynamicsxrm:///?",window.location.origin),{inputToUrl:i,pageType:o}=this._pageModulesByName[e];if(this._isMobileSupportedPageType(o)){a.searchParams.set("pagetype",o);const e=i(a.href,t,!0);return this._decorator?this._decorator.decorateUrl(new URL(e,window.location.origin),new URL(n,window.location.origin),r,t,!1).href:e}const s=[{name:"pageName",value:e},{name:"currentUrl",value:n},{name:"source",value:r}];throw Object(f.d)("UnSupported Page Type",2415919105,s)}getMappingForPage(e){try{if(!Object(T.c)(e.pageName))return this._pageModulesByName[e.pageName];const t=new URL(e.pageName,window.location.origin),n=this._mapPageType(this._pageTypeExtractor(t));return this._pageModulesByType[n]}catch(t){const n=[{name:"pageName",value:e.pageName}];throw Object(f.d)("Unknown page type",2415919105,n,t.stack)}}getFactoryForPage(e){try{if(!Object(T.c)(e.pageName)){const{factory:t}=this._pageModulesByName[e.pageName];return t}const t=new URL(e.pageName,window.location.origin),n=this._mapPageType(this._pageTypeExtractor(t)),{factory:r}=this._pageModulesByType[n];return r}catch(t){const n=[{name:"pageName",value:e.pageName}];throw Object(f.d)("Unknown page type",2415919105,n,void 0,void 0,t.stack)}}getBaseUrl(){return this._baseURL.toString()}_registerMappings(e){this._pageModulesByType={},this._pageModulesByName={};for(const t of e)this._pageModulesByType[t.pageType]=t,this._pageModulesByName[t.factory.getName()]=t,t.otherPageTypesSupported&&t.otherPageTypesSupported.forEach(e=>{this._pageModulesByType[e]=t})}_extractPageType(e){return e.searchParams.get("pagetype")}_mapPageType(e){let t=e;return t===au.a.CREATE?t=au.a.QUICK_CREATE:t===au.a.ENTITY?t=au.a.ENTITY_RECORD:t===au.a.VIEW&&(t=au.a.ENTITY_LIST),t}_isMobileSupportedPageType(e){switch(e){case au.a.ENTITY:case au.a.ENTITY_RECORD:case au.a.VIEW:case au.a.ENTITY_LIST:case au.a.CREATE:case au.a.QUICK_CREATE:case au.a.DASHBOARD:return!0;default:return!1}}getFactoryForPageType(e){const t=this._pageModulesByType[e];return null==t?void 0:t.factory}}var ou=n("IfHN"),su=n("EBJu"),cu=n("Lohl"),lu=n("BJ7u"),uu=n("sYIp");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const du={getName:()=>su.a,getRequiredAttributes(){throw new Error("Not Implemented")},throwIfInvalidUrl(e){if(!e||!e.entityTypeName)throw Object(f.d)("Missing required URL parameter: etn",P.b)},preInitializePage(e){const{formId:t,entityTypeName:n,id:r,isPreview:a}=e,i=new Tn.a(n,r);return{type:"preInitialize.quickCreateFormAction.async",execute:({dispatch:n,getState:r},o,s)=>{const c=o.TraceManager.getTracer("Forms.QuickCreate.QuickCreateFormFactory"),l=this.getTelemetryAttributes(e,r());return c.info("preInitializePage started.",l),a?Object(uu.b)().then(({retrievePreviewForm:e})=>n(e()).then(e=>({updatedFormId:e,error:void 0})).catch(e=>({error:e,updatedFormId:void 0}))):n(Object(cu.d)(i,t,Object(lu.a)(9))).then(e=>(c&&(l.push({name:"updatedFormId",value:A.a.toString(e)}),c.info("preInitializePage completed.",l)),{updatedFormId:e,error:void 0})).catch(e=>(c&&(l.push({name:"error",value:e&&e.toString()}),c.error("preInitializePage failed.",l)),{updatedFormId:void 0,error:e}))}}},createPageModule:e=>Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(7),n.e(10),n.e(4),n.e(5),n.e(6),n.e(9),n.e(8),n.e(11),n.e(12),n.e(13),n.e(14),n.e(15),n.e(16),n.e(17),n.e(19),n.e(28),n.e(37),n.e(160)]).then(n.bind(null,"fab1")).then(({QuickCreateForm:t})=>new t(e)),getTelemetryAttributes:e=>[{name:E.b.EntityName,value:e&&e.entityTypeName},{name:"entityId",value:e&&A.a.toString(e.id)},{name:"formId",value:e&&A.a.toString(e.formId)},{name:"isPreview",value:e&&e.isPreview}],getKeyForThawedCheck(e){const t=e.formId?e.formId.guid:"";return e.entityTypeName+t}};Object.freeze(du);var pu=n("N6E8");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const fu={opacity:1,borderStyle:"solid",width:"100%",height:"100%",right:0,top:0,position:"absolute",openInNewWindow:!0,backgroundColor:"transparent",shadowColor:"rgba(0, 0, 0, 0.5)",overflow:"auto"},gu={type:vc.a.Dialog,pageType:au.a.QUICK_CREATE,factory:du,isRedirect:!0,getDialogOptions:e=>fu,urlToInput(e){let t=null;const n=e.searchParams,r=n.get(ul.u),a=n.get(ul.J),i=new URLSearchParams(n.get(ul.v)),o=n.has(ul.D)&&"true"===n.get(ul.D).toLowerCase(),s=a===au.a.CREATE?au.a.QUICK_CREATE:a;try{if(n.has(ul.i)&&n.get(ul.i)){const e=n.get(ul.i),r=decodeURIComponent(e);t=JSON.parse(r)}}catch(e){throw Error(e)}n.has(ul.v)&&(t||(t={}),i.forEach((e,n)=>{n in t||(t[n]=e)}));return o?{pageType:s,entityTypeName:r,data:t,isPreview:o}:{pageType:s,entityTypeName:r,data:t}},inputToUrl(e,t){let n=Object.assign({},t.data);const r=new URL(e,window.location.origin),a=r.searchParams,i=t.createFromEntity;if(a.set(ul.u,t.entityTypeName),i&&!(n.hasOwnProperty(pu.d+"id")&&n.hasOwnProperty(pu.d+"type")&&n.hasOwnProperty(pu.d+"name"))){const e={[pu.d+"id"]:i.id.guid,[pu.d+"type"]:i.etn,[pu.d+"name"]:i.name};n=Object.assign(Object.assign({},n),e),t.data=n}if(n&&0!==Object.keys(n).length){const e=JSON.stringify(n),t=encodeURIComponent(e);a.set(ul.i,t)}return r.href}};Object.freeze(gu);var hu=n("Qjw6");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const mu={type:vc.a.Dialog,pageType:au.a.MAIN_FORM_DIALOG,factory:hu.c,isRedirect:!0,getDialogOptions:e=>fu,urlToInput:e=>ou.a.urlToInput(e),inputToUrl:(e,t)=>ou.a.inputToUrl(e,t,!1)};Object.freeze(mu);var bu=n("9egp"),yu=n("d0w6"),_u=n("BzGi"),vu=n("AKum");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Su={type:vc.a.Page,pageType:au.a.ENTITY_LIST,factory:bu.a,otherPageTypesSupported:["grid"],urlToInput(e){const t=e.searchParams,n={entityTypeName:t.get(ul.u)};let r=A.a.tryParseOrNull(t.get(ul.bb));if(r||(r=A.a.tryParseOrNull(t.get(ul.z))),r){const e=t.get(ul.cb),a=Ou(e);n.viewId=r,n.viewType=a}const a=t.has(ul.v),i=new URLSearchParams(t.get(ul.v)),o=a&&A.a.tryParseOrNull(i.get(ul.db));if(o&&(n.visualizationId=o),a&&i.has(ul.eb)&&"1"===i.get(ul.eb)&&(n.showChart=!0),a&&i.has(ul.fb)){const e=i.get(ul.fb),t=Cu(e);n.visualizationType=t}if(t.has(ul.J)){const e=t.get(ul.J);n.pageType=au.a.VIEW?au.a.ENTITY_LIST:e}return n},inputToUrl(e,t){const n=new URL(e,window.location.origin),r=n.searchParams;if(r.set(ul.u,t.entityTypeName),t.viewId){const e=A.a.toString(t.viewId);e&&(r.set(ul.bb,e),t.viewType&&r.set(ul.cb,t.viewType.toString()))}const a=new URLSearchParams;let i=!1;if(t.visualizationId){const e=A.a.toString(t.visualizationId);e&&(a.set(ul.db,e),i=!0)}return t.showChart&&(a.set(ul.eb,"1"),i=!0),t.visualizationType&&(a.set(ul.fb,t.visualizationType.toString()),i=!0),i&&r.set(ul.v,a.toString()),n.href},inputToWebUrl(e,t){const n=new URL(e,window.location.origin),r=n.searchParams,a=t.entityTypeName;a&&r.set(vu.b,a);const i=t.entityTypeCode;return i&&r.set(vu.c,encodeURIComponent(`${vu.a}=${i}`)),r.set(vu.e,"entitylist"),t.viewType&&r.set(vu.h,t.viewType.toString()),t.viewId&&r.set(vu.g,A.a.externalGuid(t.viewId)),n.href}},Ou=e=>e&&parseInt(e,10)===yu.b.userview?yu.b.userview:yu.b.savedview,Cu=e=>e&&parseInt(e,10)===_u.a.uservisualization?_u.a.uservisualization:_u.a.savedvisualization;Object.freeze(Su);var Eu=n("FdB0"),Iu=n("hIjC");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const wu={getName:()=>Eu.a,getRequiredAttributes(){throw new Error("Not Implemented")},createPageModule:e=>Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(7),n.e(10),n.e(4),n.e(5),n.e(6),n.e(9),n.e(8),n.e(11),n.e(12),n.e(13),n.e(14),n.e(15),n.e(16),n.e(17),n.e(19),n.e(28),n.e(54)]).then(n.bind(null,"Xzpw")).then(({Dialog:t})=>new t(e)),getTelemetryAttributes:e=>[{name:E.b.UniqueName,value:e&&e.uniqueName}],getKeyForThawedCheck:e=>e&&e.uniqueName,prePageRender:function(e,t,n,r){const a=r();if(Object(Kc.e)(a))return Promise.resolve({resultType:Lc.a.Success});const i=e,o=Object(Iu.c)()+".DialogPreCheck",s=t.TraceManager.getTracer(Object(Iu.d)());if(!i||!i.uniqueName||"string"!=typeof i.uniqueName||""===i.uniqueName.trim()){const e="Invalid unique name from the input";s.error(e);const n=Object.assign(new Error(e),{errorCode:-1});return t.EventManager.ReportComponentFailure(o,n),Promise.resolve({resultType:Lc.a.Fail,resultValue:n})}const c=i.uniqueName;return n(Object(de.b)(c)).then(e=>{if(A.a.isNullOrEmpty(e)){const e="retrieved form id is null or empty for dialog with unique name: "+c,t=Object.assign(new Error(e),{errorCode:-1});return s.error(e),{resultType:Lc.a.Fail,resultValue:t}}return{resultType:Lc.a.Success}},e=>({resultType:Lc.a.Fail,resultValue:e}))}};Object.freeze(wu);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const ju={type:vc.a.Dialog,pageType:au.a.DIALOG,factory:wu,getDialogOptions:e=>({width:pl,height:fl,openInNewWindow:e.dialogOptions&&e.dialogOptions.openInNewWindow?e.dialogOptions.openInNewWindow:dl,shadowColor:e.dialogOptions&&e.dialogOptions.shadowColor?e.dialogOptions.shadowColor:gl,overflow:"auto"}),urlToInput(e){const t=e.searchParams,n=t.get(ul.F),r=n;let a,i;return t.has(ul.n)&&(a=JSON.parse(t.get(ul.n))),t.has(ul.i)&&(i=JSON.parse(t.get(ul.i))),{uniqueName:n,entityTypeName:r,data:i,dialogOptions:a}},inputToUrl(e,t){const n=new URL(e,window.location.origin),r=n.searchParams;return r.set(ul.F,t.uniqueName),t.data&&r.set(ul.i,JSON.stringify(t.data)),t.dialogOptions&&r.set(ul.n,JSON.stringify(t.dialogOptions)),n.href}};Object.freeze(ju);var Pu=n("JDi5"),Tu=n("JQqP"),Nu=n("E+Gg");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Au={getName:()=>Pu.a,getRequiredAttributes(){throw new Error("Not Implemented")},createPageModule:e=>Promise.all([n.e(49),n.e(0),n.e(1),n.e(2),n.e(3),n.e(7),n.e(10),n.e(18),n.e(20),n.e(21),n.e(24),n.e(22),n.e(25),n.e(30),n.e(27),n.e(29),n.e(31),n.e(32),n.e(33),n.e(38),n.e(36),n.e(39),n.e(41),n.e(42),n.e(163)]).then(n.bind(null,"CRmP")).then(({Search:t})=>new t(e)),getTelemetryAttributes:(e,t)=>[{name:Tu.i.isNewSearchExperience,value:Object(Nu.c)(t)}]};Object.freeze(Au);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Ru={type:vc.a.Page,pageType:au.a.SEARCH,factory:Au,urlToInput(e){const t=e.searchParams,n=t.get(ul.U);let r,a,i=null;return t.has(ul.V)&&t.get(ul.V)&&(i=t.get(ul.V).toLowerCase(),r=function(e){const t=+e;if(t||0===t)return t;return}(i)),t.has(ul.J)&&t.get(ul.J)&&(a=t.get(ul.J)),{searchText:n,searchType:r,pageType:a}},inputToUrl(e,t){const n=new URL(e,window.location.origin),r=n.searchParams;return r.set(ul.U,t.searchText),(t.searchType||0===t.searchType)&&r.set(ul.V,t.searchType.toString()),n.href}};Object.freeze(Ru);var Du=n("r0R4"),xu=n("OKVy"),Mu=n("6kq6"),Fu=n("11K9");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const ku={},Lu={getName:()=>xu.a,getRequiredAttributes(){throw new Error("Not Implemented")},preInitializePage:(e,t)=>({type:"preInitialize.dashboardAction.async",execute:({dispatch:n})=>{const r=n(Object(Mu.a)(e));return ku[t]=e=>r.then(t=>n(e(t))),Promise.resolve()}}),createPageModule:e=>Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(7),n.e(10),n.e(4),n.e(5),n.e(6),n.e(9),n.e(8),n.e(11),n.e(12),n.e(13),n.e(14),n.e(15),n.e(16),n.e(17),n.e(23),n.e(26),n.e(110)]).then(n.bind(null,"aTYF")).then(({Dashboard:t})=>{const n=ku[e];return delete ku[e],new t(e,n)}),getTelemetryAttributes:e=>Object(Fu.a)(e,"PageNavigation"),getKeyForThawedCheck:e=>e.dashboardId&&e.dashboardId.guid,async forceRenderPage(e,t,r){const a=await n.e(89).then(n.bind(null,"3o8h"));e({type:a.TOURS_FULLY_RENDER_CONTEXT,payload:{fullyRenderContexts:[a.getTourContextString(r,t.pageType,A.a.toString(t.dashboardId))]}})},async revertForceRenderOfPage(e,t,r){e({type:(await n.e(89).then(n.bind(null,"3o8h"))).TOURS_FULLY_RENDER_CONTEXT,payload:{fullyRenderContexts:[]}})}};Object.freeze(Lu);const Bu={type:vc.a.Page,pageType:"dashboard",factory:Lu,isRedirect:!0,urlToInput(e){let t,n,r,a,i;const o=e.searchParams;o.has(ul.I)&&o.get(ul.I)&&(t=o.get(ul.I)),o.has(ul.J)&&(n=o.get(ul.J)),o.has(ul.u)&&o.get(ul.u)&&(r=o.get(ul.u)),o.has(ul.Z)&&o.get(ul.Z)&&(a=o.get(ul.Z).toLowerCase(),a!==fe.a&&a!==fe.b&&(a=null)),o.has(ul.b)&&o.get(ul.b)&&(i="true"===o.get(ul.b));let s=A.a.tryParseOrNull(o.get(ul.z));return A.a.isNullOrEmpty(s)&&(s=A.a.tryParseOrNull(o.get(ul.h))),{navPath:t,dashboardId:s,pageType:n,etn:r,type:a,canOverride:i}},inputToUrl(e,t){const n=new URL(e,window.location.origin),r=n.searchParams,a=A.a.toString(t.dashboardId);a&&r.set(ul.z,a);const i=t.navPath;i&&r.set(ul.I,i);const o=t.etn;o&&r.set(ul.u,o);const s=t.type;s&&r.set(ul.Z,s);const c=t.canOverride;return c&&r.set(ul.b,c.toString()),n.href},inputToWebUrl(e,t){const n=new URL(e,window.location.origin),r=n.searchParams,a=A.a.toString(t.dashboardId);a&&r.set(vu.d,a);const i=t.type;return i&&r.set(vu.f,i),n.href}};Object.freeze(Bu);var Uu=n("TQVK"),Vu=n("0buK"),zu=n("ZFkP");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const qu={getName:()=>Vu.a,getRequiredAttributes(){throw new Error("Not Implemented")},createPageModule:e=>Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(7),n.e(10),n.e(4),n.e(5),n.e(6),n.e(9),n.e(8),n.e(11),n.e(12),n.e(13),n.e(14),n.e(15),n.e(16),n.e(17),n.e(19),n.e(28),n.e(169)]).then(n.bind(null,"QH2d")).then(({TaskBasedFlow:t})=>new t(e)),getTelemetryAttributes:e=>[{name:E.b.UniqueName,value:e&&e.uniqueName},{name:E.b.EntityName,value:e&&e.entityTypeName}],prePageRender:(e,t,n,r)=>Object(zu.b)(e,t,n,r)};Object.freeze(qu);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Hu={opacity:1,borderStyle:"solid",width:"100%",height:"100%",top:0,position:"absolute",openInNewWindow:!0,backgroundColor:"transparent",shadowColor:"rgba(0, 0, 0, 0.5)",overflow:"auto",shouldSupportRTL:!0},Wu={type:vc.a.Dialog,pageType:au.a.TASKBASED_FLOW,factory:qu,getDialogOptions:e=>Hu,urlToInput(e){const t=e.searchParams;return{entityTypeName:t.get(ul.u),id:A.a.tryParseOrNull(t.get(ul.z)),uniqueName:t.get(ul.ab)}},inputToUrl(e,t){const n=new URL(e,window.location.origin),r=n.searchParams;return r.set(ul.ab,t.uniqueName),t.entityTypeName&&r.set(ul.u,t.entityTypeName),t.id&&r.set(ul.z,A.a.toString(t.id)),n.href}};Object.freeze(Wu);var Gu=n("RIJJ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const Ku={getName:()=>Gu.a,getRequiredAttributes:()=>[],throwIfInvalidUrl(e){if(!e||!e.url||!e.dialogOptions)throw Object(f.d)("Missing required URL parameters: Dialog Options",P.b)},createPageModule:e=>n.e(130).then(n.bind(null,"a0Rm")).then(({LegacyDialog:t})=>new t(e)),getTelemetryAttributes:e=>[{name:E.b.LegacyDialogUrl,value:e&&e.url}]};Object.freeze(Ku);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Qu=!1,Xu="100%",Yu="100%",Ju="rgba(0,0,0,0.5)",$u={type:vc.a.Dialog,pageType:"legacydialog",factory:Ku,getDialogOptions:e=>({width:Xu,height:Yu,openInNewWindow:Qu,shadowColor:Ju,overflow:"auto"}),urlToInput:e=>({}),inputToUrl:(e,t)=>e};Object.freeze($u);var Zu=n("2gMP");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const ed={getName:()=>Zu.a,getRequiredAttributes(){throw new Error("Not Implemented")},createPageModule:e=>n.e(175).then(n.bind(null,"U/xE")).then(({WelcomePageDialog:t})=>new t(e)),getTelemetryAttributes:e=>[{name:E.b.WelcomePageName,value:e&&e.welcomePageName}]};Object.freeze(ed);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const td=!1,nd="100%",rd="100%",ad="rgba(0, 0, 0, 0.5)",id={type:vc.a.Dialog,pageType:"welcomePagedialog",factory:ed,getDialogOptions:e=>({width:nd,height:rd,openInNewWindow:e.dialogOptions&&e.dialogOptions.openInNewWindow?e.dialogOptions.openInNewWindow:td,shadowColor:e.dialogOptions&&e.dialogOptions.shadowColor?e.dialogOptions.shadowColor:ad,overflow:"auto"}),urlToInput(e){const t=e.searchParams;let n,r;if(t.has("dialogOptions"))try{n=JSON.parse(t.get("dialogOptions"))}catch(e){throw Error(e)}return t.has("dialogWelcomePageName")&&(r=t.get("dialogWelcomePageName")),{dialogOptions:n,welcomePageName:r}},inputToUrl(e,t){const n=new URL(e,window.location.origin),r=n.searchParams;return t.dialogOptions&&r.set("dialogOptions",JSON.stringify(t.dialogOptions)),t.welcomePageName&&r.set("dialogWelcomePageName",t.welcomePageName),n.href}};Object.freeze(id);var od=n("/2Q6"),sd=n("JTy6");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const cd={getName:()=>sd.a,getRequiredAttributes(){throw new Error("Not Implemented")},createPageModule:e=>Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(7),n.e(10),n.e(4),n.e(5),n.e(6),n.e(9),n.e(8),n.e(11),n.e(12),n.e(13),n.e(14),n.e(15),n.e(16),n.e(133)]).then(n.bind(null,"RwSO")).then(({LookupDialog:t})=>new t(e)),getTelemetryAttributes:e=>[{name:E.b.LookupDialogParameters.DefaultEntityType,value:e&&e.defaultEntityType},{name:E.b.LookupDialogParameters.DefaultViewId,value:e&&e.defaultViewId},{name:E.b.LookupDialogParameters.EntityTypes,value:e&&e.entityTypes&&e.entityTypes.toString()},{name:E.b.LookupDialogParameters.ViewIds,value:e&&e.viewIds&&e.viewIds.toString()},{name:E.b.LookupDialogParameters.AllowMultiSelect,value:e&&e.allowMultiSelect},{name:E.b.LookupDialogParameters.SearchText,value:e&&e.searchText}]};Object.freeze(cd);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const ld={opacity:1,borderStyle:"solid",height:"100%",top:0,position:"absolute",openInNewWindow:!0,backgroundColor:"transparent",shadowColor:"rgba(0, 0, 0, 0.5)",overflow:"auto",width:"100%",shouldSupportRTL:!0},ud={type:vc.a.Dialog,pageType:"lookupdialog",factory:cd,getDialogOptions:e=>ld,urlToInput(e){const t=e.searchParams,n=t.get("etn");return{lookupType:t.get("type"),defaultEntityType:n,defaultViewId:t.get("viewid")}},inputToUrl(e,t){const n=new URL(e,window.location.origin),r=n.searchParams;return r.set("etn",t.defaultEntityType),r.set("type",t.lookupType),t.defaultViewId&&r.set("viewid",t.defaultViewId),n.href}};Object.freeze(ud);var dd=n("Nk+G");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const pd={getName:()=>dd.a,getRequiredAttributes(){throw new Error("Not Implemented")},createPageModule:e=>Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(7),n.e(10),n.e(4),n.e(5),n.e(6),n.e(9),n.e(8),n.e(11),n.e(12),n.e(13),n.e(14),n.e(15),n.e(16),n.e(17),n.e(108)]).then(n.bind(null,"hHCe")).then(({CustomControl:t})=>new t(e)),getTelemetryAttributes:e=>[{name:E.b.CustomControlId,value:e?e.customControlId:""}]};Object.freeze(pd);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const fd={type:vc.a.Page,pageType:"control",factory:pd,otherPageTypesSupported:["customcontrol"],urlToInput(e){const t=e.searchParams;let n=t.get(ul.g);const r=t.get(ul.i)?JSON.parse(t.get(ul.i)):null;n||(n=t.get(ul.f));return{customControlId:n,data:r}},inputToUrl(e,t){const n=new URL(e,window.location.origin),r=n.searchParams;return r.set(ul.g,t.customControlId),t.data&&r.set(ul.i,JSON.stringify(t.data)),n.href}};var gd=n("5oHv");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const hd={getName:()=>gd.a,getRequiredAttributes(){throw new Error("Not Implemented")},createPageModule:e=>Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(7),n.e(10),n.e(4),n.e(5),n.e(6),n.e(9),n.e(8),n.e(11),n.e(12),n.e(13),n.e(14),n.e(15),n.e(16),n.e(129)]).then(n.bind(null,"QO6+")).then(({KbSearch:t})=>new t(e)),getTelemetryAttributes:e=>[]};Object.freeze(hd);function md(e){return null==e}const bd={type:vc.a.Page,pageType:"kbsearch",factory:hd,urlToInput(e){const t=e.searchParams,n=t.get("query"),r=t.get("showFilter"),a=t.get("showLang"),i=t.get("lang"),o=t.get("results"),s=t.get("blockClick"),c=t.get("filter"),l=t.get("sort"),u=t.get("enableSelection"),d=t.get("enableContextualActions"),p=t.get("entityName"),f=t.get("autoSuggestionField");return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},n&&{query:n}),r&&{showFilter:"0"!==r}),a&&{showLang:"1"===a}),i&&{lang:i}),o&&{results:parseInt(o,10)}),s&&{blockClick:"1"===s}),c&&{filter:c}),l&&{sort:parseInt(l,10)}),u&&{enableSelection:"1"===u}),d&&{enableContextualActions:"1"===d}),p&&{entityName:p}),f&&{autoSuggestionField:f})},inputToUrl(e,t){const n=new URL(e,window.location.origin),r=n.searchParams;return t.query&&r.set("query",t.query),!md(t.showFilter)&&r.set("showFilter",t.showFilter?"1":"0"),!md(t.showLang)&&r.set("showLang",t.showLang?"1":"0"),t.lang&&r.set("lang",t.lang),t.results&&r.set("results",t.results.toString()),!md(t.blockClick)&&r.set("blockClick",t.blockClick?"1":"0"),t.filter&&r.set("filter",t.filter),t.sort&&r.set("sort",t.sort.toString()),!md(t.enableSelection)&&r.set("enableSelection",t.enableSelection?"1":"0"),!md(t.enableContextualActions)&&r.set("enableContextualActions",t.enableContextualActions?"1":"0"),t.entityName&&r.set("entityName",t.entityName),t.autoSuggestionField&&r.set("autoSuggestionField",t.autoSuggestionField),n.href}};var yd=n("qk+o");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const _d={getName:()=>yd.a,getRequiredAttributes(){throw new Error("Not Implemented")},createPageModule:e=>Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(7),n.e(10),n.e(4),n.e(5),n.e(6),n.e(9),n.e(8),n.e(11),n.e(12),n.e(13),n.e(14),n.e(15),n.e(128)]).then(n.bind(null,"c3fe")).then(({KbArticle:t})=>new t(e)),getTelemetryAttributes:e=>[]};Object.freeze(_d);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const vd={type:vc.a.Page,pageType:"kbarticle",factory:_d,urlToInput:e=>({articleId:e.searchParams.get("articleId")}),inputToUrl(e,t){const n=new URL(e,window.location.origin);return n.searchParams.set("articleId",t.articleId),n.href}};var Sd=n("lcRi");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const Od={getName:()=>Sd.a,getRequiredAttributes:()=>[],createPageModule:e=>Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(7),n.e(10),n.e(4),n.e(5),n.e(6),n.e(9),n.e(8),n.e(11),n.e(12),n.e(13),n.e(14),n.e(15),n.e(16),n.e(99)]).then(n.bind(null,"B822")).then(({Benchmark:t})=>new t(e)),getTelemetryAttributes:e=>[{name:E.b.BenchmarkControlName,value:e&&e.controlName},{name:E.b.BenchmarkElementNumber,value:e&&e.elementNumber},{name:E.b.EntityName,value:e&&e.entityTypeName}]};Object.freeze(Od);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Cd={type:vc.a.Page,pageType:"benchmark",factory:Od,isRedirect:!0,urlToInput:e=>({}),inputToUrl:(e,t)=>e,inputToWebUrl:(e,t)=>e};Object.freeze(Cd);var Ed=n("TKDo");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const Id={getName:()=>Ed.a,getRequiredAttributes:()=>[],throwIfInvalidUrl(e){if(!e||!e.uniqueName)throw Object(f.d)("Missing required URL parameter: name",P.b)},createPageModule:e=>Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(7),n.e(10),n.e(4),n.e(5),n.e(6),n.e(9),n.e(8),n.e(11),n.e(12),n.e(13),n.e(14),n.e(15),n.e(16),n.e(17),n.e(19),n.e(28),n.e(54)]).then(n.bind(null,"Xzpw")).then(({Dialog:t})=>new t(e)),getTelemetryAttributes:e=>[{name:E.b.UniqueName,value:e&&e.uniqueName}],getKeyForThawedCheck:e=>e&&e.uniqueName};Object.freeze(Id);const wd={type:vc.a.Page,pageType:au.a.INLINE_DIALOG,factory:Id,urlToInput(e){const t=e.searchParams,n=t.get(ul.F),r=n;let a=null,i=null;try{t.has(ul.n)&&(a=JSON.parse(t.get(ul.n))),a=Object.assign(Object.assign({},a),{windowPosition:"inline"}),t.has(ul.i)&&(i=JSON.parse(t.get(ul.i)))}catch(e){throw{name:"Inline Dialog: Invalid JSON",message:`Invalid JSON in dialogOptions or data. Reason: "${e.message}"`}}return{uniqueName:n,entityTypeName:r,data:i,dialogOptions:a}},inputToUrl(e,t){const n=new URL(e,window.location.origin),r=n.searchParams;r.set(ul.F,t.uniqueName),t.data&&r.set(ul.i,JSON.stringify(t.data));const a=Object.assign(Object.assign({},t.dialogOptions),{windowPosition:"inline"});return r.set(ul.n,JSON.stringify(a)),n.href}};Object.freeze(wd);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class jd{constructor(e){if(!e)throw new Error("decoratorList parameter must not be null");this._decoratorList=e}decorateUrl(e,t,n,r,a){return this._decoratorList.reduce((e,i)=>i.decorateUrl(e,t,n,r,a),e)}decorateInput(e,t,n){for(const r of this._decoratorList)r.decorateInput(e,t,n);return e}addDecorator(e){e&&this._decoratorList&&this._decoratorList.push(e)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Pd(e,t,n,r){const a=e.searchParams;return void 0!==r.cmdbar&&a.set(ul.e,r.cmdbar.toString()),void 0!==r.navbar&&a.set(ul.G,Zn.a[r.navbar].toLowerCase()),e}function Td(e,t,n){return e}var Nd=n("nDua");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Ad(e,t,n,r){const a=e.searchParams;if(r&&r.appId&&n===vc.b.SwitchApp)a.set("appid",r.appId);else if(r&&r.appshellmode&&r.appshellmode===Nd.a.ADVANCED||n===vc.b.AdvancedInAppShell)a.set(Nd.a.APP_SHELL_QUERY_PARAM,Nd.a.ADVANCED);else if(n===vc.b.Other){const e=t.searchParams.get(Nd.a.APP_SHELL_QUERY_PARAM);e&&a.set(Nd.a.APP_SHELL_QUERY_PARAM,e)}return e}function Rd(e,t,n){const r=new URL(t,window.location.origin).searchParams.get(Nd.a.APP_SHELL_QUERY_PARAM);return r?e.appshellmode=r:n===vc.b.AdvancedInAppShell&&(e.appshellmode=Nd.a.ADVANCED),e}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Dd(e,t,n,r,a){if(a&&"/nga/main.htm"===e.pathname&&e.host===t.host){const t=new URL(e.href,window.location.origin);t.pathname="/main.aspx";for(const e of["liveid","installid","org"])t.searchParams.delete(e);return t}return e}function xd(e,t,n){return e}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const Md=["tenantId","source","flags"],Fd=["channelId","channelType","entityId","chatId","groupId","locale","hostClientType","isFullScreen","subEntityId","teamId","teamType","theme","userTeamRole"],kd=["embedded"],Ld=[Wo.sh,Wo.j];function Bd(e,t,n,r,a){if(a&&"/uclient/main.htm"===e.pathname&&e.host===t.host){const t=new URL(e.href,window.location.origin);t.pathname="/main.aspx";for(const e of[...Md,...Fd])t.searchParams.delete(e);const n=Object($n.e)(e.searchParams.get("flags"));Vd(n,kd);const r=Object($n.d)(e.searchParams.get("flags"));Vd(r,Ld);const a=Object.assign(Object.assign({},r),n),i=Object.keys(a).map(e=>`${e}=${a[e]}`).join(",");return i&&t.searchParams.set("flags",i),t}return e}function Ud(e,t,n){return e}function Vd(e,t){for(const n of t)delete e[n]}var zd=n("uAcA");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const qd={getName:()=>zd.a,getRequiredAttributes(){throw new Error("Not Implemented")},throwIfInvalidUrl(){},preInitializePage:()=>({type:"preInitialize.offlineStatusDialog.async",execute:()=>Promise.resolve({})}),createPageModule:e=>Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(7),n.e(10),n.e(18),n.e(20),n.e(21),n.e(24),n.e(22),n.e(25),n.e(30),n.e(27),n.e(29),n.e(31),n.e(32),n.e(33),n.e(38),n.e(41),n.e(65),n.e(4),n.e(5),n.e(6),n.e(151)]).then(n.bind(null,"vCHt")).then(({OfflineStatusDialogForm:t})=>new t(e)),getTelemetryAttributes:()=>[]};Object.freeze(qd);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Hd={opacity:1,borderStyle:"solid",width:"100%",height:"100%",right:0,top:0,position:"absolute",openInNewWindow:!0,backgroundColor:"transparent",shadowColor:"rgba(0, 0, 0, 0.5)",overflow:"auto"},Wd={type:vc.a.Dialog,pageType:au.a.OFFLINESTATUS_FORM,factory:qd,isRedirect:!1,getDialogOptions:e=>Object.assign(Object.assign({},Hd),e.dialogOptions),urlToInput:e=>({}),inputToUrl:(e,t)=>e};Object.freeze(Wd);var Gd=n("baQL");const Kd={getName:()=>Gd.a,getRequiredAttributes(){throw new Error("Not Implemented")},createPageModule:e=>Promise.all([n.e(0),n.e(1),n.e(3),n.e(18),n.e(20),n.e(184),n.e(6),n.e(12),n.e(14),n.e(159)]).then(n.bind(null,"Hv5K")).then(({Query:t})=>new t(e)),getTelemetryAttributes:e=>[]};Object.freeze(Kd);const Qd={type:vc.a.Page,pageType:"query",factory:Kd,urlToInput(e){let t;const n=e.searchParams;return n.has(ul.J)&&(t=n.get(ul.J)),{pageType:t}},inputToUrl:(e,t)=>new URL(e,window.location.origin).href,inputToWebUrl:(e,t)=>new URL(e,window.location.origin).href};Object.freeze(Qd);var Xd=n("q27N"),Yd=n("9xX1");var Jd=n("0kGT"),$d=n("UqMU");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class Zd{constructor(e){this._store=e}HistoryBack(e){const t=Object(Yc.g)(this._store.getState());if(e&&e.backToRoot){const e=Object(Yc.a)(this._store.getState(),t).history;this._store.dispatch(Object($d.d)(t,[e[0]]))}else this._store.dispatch(Object($d.c)(t));const n=Object(Yc.a)(this._store.getState(),t).history,r=n[n.length-1],a=new Oc.a;a.state=r.state,this._onPop(a)}PushState(e,t,n){const r=Object(Yc.g)(this._store.getState());n.source!==vc.b.SiteMap&&n.source!==vc.b.SiteMapSubArea?this._store.dispatch(Object($d.a)(r,e,t)):this._store.dispatch(Object($d.e)(r,e,t))}ClearHistory(){this._store.dispatch(Object($d.b)(Object(Yc.g)(this._store.getState())))}ReplaceState(e,t){const n=Object(Yc.g)(this._store.getState());this._store.dispatch(Object($d.e)(n,e,t))}GetCurrentUrl(e){if(Object(Ho.d)(this._store.getState(),Wo.Qh,Wo.i)){const t=Object(yc.b)(this._store.getState(),e);return null==t?void 0:t.url}}GetHistoryLength(){return Object(Yc.f)(this._store.getState()).history.length}GetState(){const e=Object(Yc.f)(this._store.getState());return e.history[e.history.length-1].state}RegisterOnBeforeUnload(e){}RegisterOnPopState(e){this._onPop=e}Dispose(){this._onPop=void 0}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var ep=n("q6Ks"),tp=n("5ZBI"),np=n("yyjc"),rp=n("sjKS");class ap{constructor(e){this._lastState=null,this._getThemingData=null,this._getClientData=null,this._getFormattingData=null,this._utilsData=null,this._lastReturn=null,this._getClientData=Object(ep.b)(),this._getFormattingData=Object(ep.c)(),this._getThemingData=Object(ep.d)(e),this._utilsData=Object(ep.e)(e)}getCommonPropertyBagData(e){let t=[];if(!this._lastState||this._lastState!==e){this._lastState=e;const n=this._getClientData(e),r=this._getFormattingData(e),a=this._getThemingData(e);this._lastReturn&&this._lastReturn.response.clientData===n.response&&this._lastReturn.response.formattingData===r.response&&this._lastReturn.response.themingData===a.response||(t=t.concat(n.updatedProperties,r.updatedProperties,a.updatedProperties),this._lastReturn={response:{utilsData:this._utilsData,themingData:a.response,formattingData:r.response,clientData:n.response},updatedProperties:t,ancillaryData:n.ancillaryData})}return this._lastReturn}}var ip=n("fueu");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var op=n("SJ2k"),sp=n("Uv1Y"),cp=n("a8hT"),lp=n("z+5+"),up=n("1RM4");var dp=n("QARO"),pp=n("xAwK"),fp=n("a475");var gp=n("Rj8P"),hp=n("69gE"),mp=n("Nzmy"),bp=n("rzss"),yp=n("fILV"),_p=n("cfbi"),vp=n("iF9X"),Sp=n("8CLP"),Op=n("qCX6"),Cp=n("03Hu"),Ep=n("/BiW"),Ip=n("UGwp"),wp=n("UZFl"),jp=n("JEu3"),Pp=n("lMS8"),Tp=n("1u1B");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Np={getOfflineProvider:function(){return Op.a.get_instance()},getOfflineDataSource:function(){return Cp.a.get_DefaultInstance()}};function Ap(e,t,r,a){const{OfflineTypescriptInterface:i,offlineReducer:o,offlineUpdateStateTreeFromSessionState:s,isOfflineAvailableForUse:c,inOfflineEnabledProfile:l,getOfflineFeatureStatus:u,isOldStateEmpty:d,hasOfflineConfigurationExceptAvailableEntitiesChanged:p,hasOfflineAvailableEntitiesOrProfileVersionHasChanged:f,ConstructOfflineState:g,OfflineUpdateStateTree:h,getReInitializeOffline:m,createReInitializeOfflineAction:b,initializeOfflineLifecycleAsyncAction:y}=e;Nt.g.push(...e.OfflineResourceIds);const _=Np.getOfflineProvider();window.__UCITestHook={syncNow:()=>{_.schedulePeriodicSyncJob()},syncCompleteFlag:0},_.set_offlineDataSource(Np.getOfflineDataSource()),_.set_offlineTypescriptInterface(new i(a,r,{})),r.OfflineProvider=_;const v=Object.assign(Object.assign({},a.currentReducerMap),{offline:o});a.replaceReducer(Object(w.a)(v)),a.currentReducerMap=v,a.dispatch(Object(gp.c)(sc.a.NotAvailable,Sp.a.None));const S=a.getState(),O=Object(is.d)(S,r);let C=Object(Ys.d)(S);if(mp.c.warn("offlineLoader:loadingOffline - isServerAvailableStatus:"+C+" isAppAvailableOffline"+O),!O)return C?Promise.resolve(null):Promise.reject(sp.a.fromErrorCode(S,-2147093999));const E=Object(Ho.g)(S,"MobileClientOfflineAutoOptin");return new hp.a(r,a).IsExecAvailable()&&E||Object(is.e)(S)?(Object(Ho.d)(S,Wo.pf,Wo.p)&&Promise.all([n.e(8),n.e(11),n.e(78)]).then(n.bind(null,"pwU7")).then(e=>{e.subscribeOfflineSyncNotificationToStoreChanges(a),e.subscribeOfflineManualRefreshNotificationToStoreChanges(a),Object(Tp.d)(r)}),a.subscribe(ic.f,e=>function(e,t){const{isFileSyncCompleted:n,isFileSyncCompletedWithError:r}=Object(is.h)(t);Object(ic.j)(e.getState())&&n&&(e.dispatch(Object(jp.b)(!1)),e.dispatch(Object(Pp.a)(r)))}(a,e)),a.dispatch(s()).then(()=>{let e=null,t=null,n=null,i=null,o=null,s=null;const _=a.getState(),v=c(_),S=l(_);if(C=Object(Ys.d)(_),mp.c.warn("offlineLoader:loadedOffline - isServerAvailableStatus:"+C+" isOfflineAvailableForUseStatus:"+v+" inOfflineEnabledProfileStatus: "+S),!C&&r.DataSource&&!v&&!S)throw sp.a.fromErrorCode(_,-2147093999);a.subscribeImmediate(()=>{const n=a.getState(),r=Object($o.c)(n),c=Object(Ys.d)(n);let l=!1,m=!1;const b=u(n);let y=!1,_=null;if(u(n)!==cc.a.Disabled){const u=function(e){return Object($o.c)(e)===At.a.InProgress||!1===Object($o.b)(e)}(n);n.user&&n.organization&&n.user.userSettings&&n.organization.organizationSettings&&(n.user.userSettings!==e||n.organization.organizationSettings!==t)&&((d(e,t,n)||p(n,a.dispatch))&&(mp.c.warn("offlineLoader:loadOffline:Offline state change : bisMetdataSyncInProgressOrIsMetataUnavailable:"+u),y=!0,u||(m=!0)),!y&&f(n)&&(y=!0,mp.c.warn("offlineLoader:loadOffline:Offline state change : Available Entities Or Profile Version Has Changed"))),u||m||(!function(e,t,n){return!1===e&&!0===t}(i,c)?(function(e,t){return e===cc.a.Disabled&&t===cc.a.Enabled}(s,b)||function(e,t,n){if(Object(vp.e)(e))return t===At.a.Init&&n===At.a.InSyncWithServer||t===At.a.SyncPendingFromServer&&n===At.a.InSyncWithServer;return(t===At.a.InProgress||t===At.a.SyncPendingFromServer)&&n===At.a.InSyncWithServer}(n,o,r))&&(m=!0,y=!0,mp.c.warn("offlineLoader:loadOffline:Offline state change : Metadata sync has been completed")):(l=!0,m=!0,y=!0,mp.c.warn("offlineLoader:loadOffline:Offline state change : upsync required "))),t=n.organization.organizationSettings,e=n.user.userSettings,s!==b&&(s=b),o!==r&&(o=r),i!==c&&(mp.c.warn("offlineLoader:loadOffline:Offline lifecycle - Server State change:oldServerState:"+i+" newServerState:"+c),i=c),y&&(mp.c.warn("offlineLoader:loadOffline:Offline state tree change : change value:"+y),_=g(n,m,l),a.dispatch(h(_)))}else s!==b&&(mp.c.warn("offlineLoader:loadOffline:Offline lifecycle - feature status change:oldOptStatus:"+s+" newOptStatus:"+b),s=b)}),a.subscribeImmediate(()=>{const e=a.getState(),t=m(e);n!==t&&(n=t,t&&(mp.c.warn("offlineLoader:loadOffline:reinitialize: newOfflineState:"+t),a.dispatch(b(!1)),a.dispatch(y())))})},e=>{throw mp.c.error("Offline: offlineUpdateStateTreeFromSessionState: offlineUpdateStateTreeFromSessionState: Failed: Error retrieving session data from session state"),e})):void 0}var Rp=n("ZIjf"),Dp=n("ghNp"),xp=n("3yqi");function Mp(e){return"ClientApiFrame_"+e}var Fp=n("qshH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var kp=n("ABCl");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var Lp=n("VWP5"),Bp=n("7ZMh"),Up=n("Wlg7");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class Vp extends Up.a{constructor(e,t){super(t),this._url=e}get url(){return this._url}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class zp{constructor(e,t){this._eventNames={beforeOnLoad:"beforeOnload",onOpenUrl:"onOpenURL",panelOnMessageReceived:"panelOnMessageReceived",panelOnSizeChange:"panelOnSizeChange",panelOnStateChange:"panelOnStateChange"},this._tracing=e,this._scriptManager=t,this._scriptManager.initializeContainerForClientApi("crm_header_global",!1),this._container=null,this._reset()}getContainer(){return this._container||(this._container=this._scriptManager.getContainer("crm_header_global")),this._container}_getAttributeEventNameKey(e,t){return e.concat("_",t)}_lockHandler(e,t){const n=this._getAttributeEventNameKey(e,t);this._lockedHandlers[n]=!0}_isHandlerLocked(e,t){const n=this._getAttributeEventNameKey(e,t);return this._lockedHandlers[n]}_unlockHandler(e,t){const n=this._getAttributeEventNameKey(e,t);if(this._lockedHandlers[n])this._lockedHandlers[n]=!1;else{const e=[];e.push({name:"EventKey",value:n}),e.push({name:"EventName",value:t}),this._tracing.error("Event handler was NOT LOCKED as expected")}}_handleError(e,t){e(Object(Bp.a)("crm_header_global",new sp.a(void 0,2153976091,void 0,void 0,void 0,t)))}runBeforeOnLoad(e,t,n){return this._executeGlobalEventHandler(this._eventNames.beforeOnLoad,t,this._beforeOnLoadEvents,e,n)}addBeforeOnLoad(e){this._addEvent(this._beforeOnLoadEvents,e,this._eventNames.beforeOnLoad)}removeBeforeOnLoad(e){this._removeEvent(this._beforeOnLoadEvents,e)}runOnOpenUrl(e,t,n,r){const a=new Vp(t,!1);return{type:"globalEventManager.execute.globalEventHandler",sync:!0,execute:(t,i,o)=>{const s=t.dispatch(Object(Dp.b)(e,n)),c=s?s.getControl(r):null;return t.dispatch(this._executeGlobalEventHandler(this._eventNames.onOpenUrl,e,this._onOpenUrlEvents,c,s,a))}}}addOnOpenUrl(e){this._addEvent(this._onOpenUrlEvents,e,this._eventNames.onOpenUrl)}removeOnOpenUrl(e){this._removeEvent(this._onOpenUrlEvents,e)}runPanelOnMessageReceived(e,t,n){return this._panelOnMessageReceivedEvents[e]||(this._panelOnMessageReceivedEvents[e]=[]),this._executeGlobalEventHandler(this._eventNames.panelOnMessageReceived,"crm_header_global",this._panelOnMessageReceivedEvents[e],t,null,n)}addPanelOnMessageReceived(e,t){this._panelOnMessageReceivedEvents[e]||(this._panelOnMessageReceivedEvents[e]=[]),this._addEvent(this._panelOnMessageReceivedEvents[e],t,this._eventNames.panelOnMessageReceived)}removePanelOnMessageReceived(e,t){this._panelOnMessageReceivedEvents[e]||(this._panelOnMessageReceivedEvents[e]=[]),this._removeEvent(this._panelOnMessageReceivedEvents[e],t)}runPanelOnSizeChange(e,t){return this._panelOnSizeChangeEvents[e]||(this._panelOnSizeChangeEvents[e]=[]),this._executeGlobalEventHandler(this._eventNames.panelOnSizeChange,"crm_header_global",this._panelOnSizeChangeEvents[e],t)}addPanelOnSizeChange(e,t){this._panelOnSizeChangeEvents[e]||(this._panelOnSizeChangeEvents[e]=[]),this._addEvent(this._panelOnSizeChangeEvents[e],t,this._eventNames.panelOnSizeChange)}removePanelOnSizeChange(e,t){this._panelOnSizeChangeEvents[e]||(this._panelOnSizeChangeEvents[e]=[]),this._removeEvent(this._panelOnSizeChangeEvents[e],t)}runPanelOnStateChange(e,t){return this._panelOnStateChangeEvents[e]||(this._panelOnStateChangeEvents[e]=[]),this._executeGlobalEventHandler(this._eventNames.panelOnStateChange,"crm_header_global",this._panelOnStateChangeEvents[e],t)}addPanelOnStateChange(e,t){this._panelOnStateChangeEvents[e]||(this._panelOnStateChangeEvents[e]=[]),this._addEvent(this._panelOnStateChangeEvents[e],t,this._eventNames.panelOnStateChange)}removePanelOnStateChange(e,t){this._panelOnStateChangeEvents[e]||(this._panelOnStateChangeEvents[e]=[]),this._removeEvent(this._panelOnStateChangeEvents[e],t)}_executeGlobalEventHandler(e,t,n,r,a,i){if(!this._scriptManager.containerExists("crm_header_global")){const t=[];return t.push({name:"ContainerId",value:"crm_header_global"}),t.push({name:"EventName",value:e}),this._tracing.error("Global event was cancelled as the container does not exist",t),{type:"globalEventManager.execute.globalEventHandler",sync:!0,execute:(e,t)=>!1}}return{type:"globalEventManager.execute.globalEventHandler",sync:!0,execute:(o,s)=>{if(this._isHandlerLocked("_global",e))return!1;let c;this._lockHandler("_global",e);try{c=this._executeEventHandler(s,n,o,t,r,a,i),this._unlockHandler("_global",e)}catch(t){this._unlockHandler("_global",e),this._handleError(o.dispatch,t),c=!1}return c}}}_executeEventHandler(e,t,n,r,a,i,o){if(0!==t.length)for(let s=0;s<t.length;s++)this._executeIndividualEvent(e,t[s],s,n,r,a,i,o);return!(o&&o instanceof Up.a)||o.isDefaultPrevented()}_executeIndividualEvent(e,t,n,r,a,i,o,s){let c=t.Parameters;try{if(t.PassExecutionContext){const e=new Lp.a(r,a,i,n,s,o);c=c&&c.length?[e].concat(t.Parameters):[e]}const e={sourceName:"globalEvent.executeHandler"};e.eventParameters=[{name:"eventName",value:t.EventName}],Object(Ml.b)("globalEvent.executeHandler",()=>{if(t.func||t.FunctionName){let n,r,a;t.func?(n=t.func,r=n.name):(r=n=t.FunctionName,a=!0),e.eventParameters.push({name:E.b.WebResourceParameterNames.FunctionName,value:r}),this.getContainer().execute(n,c,a,t.CustomizationInfo)}})}catch(e){return this._handleError(r.dispatch,e),!1}return!0}_addEvent(e,t,n){var r;if(e&&t){const a=null===(r=this._container)||void 0===r?void 0:r.getCurrentInfo(),i=a&&`${a.source?a.source+",":""}${a.type}`,o={EventName:n,PassExecutionContext:!0,func:t,CustomizationInfo:Object.assign(Object.assign({},a),{type:n+"Dynamic",source:i})};e.push(o)}}_removeEvent(e,t){for(let n=0;n<e.length;n++)if(e[n].func===t){e.splice(n,1);break}}_reset(){this._beforeOnLoadEvents=[],this._onOpenUrlEvents=[],this._panelOnMessageReceivedEvents={},this._panelOnSizeChangeEvents={},this._panelOnStateChangeEvents={},this._lockedHandlers={}}}class qp{constructor(e,t,n){this._subscriptions=[],this._subscribers=[],this._id=e,this._onMessageReceived=t,this._channelManager=n}sendTo(e,t){this._channelManager.sendMessage(this,e,t)}sendToSubscribers(e){this.sendTo(this.getSubscribers().slice(0),e)}subscribeTo(e){this._channelManager.subscribe(this,e)}unsubscribeFrom(e){this._channelManager.unsubscribe(this,e)}getChannelId(){return this._id}getSubscriptions(){return Object.freeze(this._subscriptions)}setOnMesseageReceivedHandler(e){this._onMessageReceived=e}getSubscribers(){return Object.freeze(this._subscribers)}getOnMessageReceivedHandler(){return this._onMessageReceived}setSubscriptions(e){this._subscriptions=e}setSubscribers(e){this._subscribers=e}}class Hp{constructor(e){this._channels={},this._tracing=e}createChannel(e,t){if(this._channels[e])throw Object(f.d)("Cannot create new channel using existing channel ID",Hp.DUPLICATE_CHANNEL_ERROR_ID,[{name:"ChannelId",value:e}]);return this._channels[e]=new qp(e,t,this)}getChannel(e){return this._channels[e]}destroyChannel(e){this._assertChannel(e);for(const t of e.getSubscribers()){this._channels[t].unsubscribeFrom([e.getChannelId()])}e.unsubscribeFrom(e.getSubscriptions().slice(0)),delete this._channels[e.getChannelId()]}sendMessage(e,t,n){if(this._assertChannel(e),t){t=this._ensureStringArray(t);for(const r of t)if(this._channels[r]){const t=this._channels[r].getOnMessageReceivedHandler();t&&t(n,e.getChannelId())}else this._tracing.warn("Channel was not found",[{name:"ChannelId",value:r}])}else this._tracing.error("toChannels parameter is null",[{name:"from_channel_id",value:e.getChannelId()}])}subscribe(e,t){if(this._assertChannel(e),t){t=this._ensureStringArray(t);for(const n of t){const t=this._channels[n];if(t){const r=t.getSubscribers().slice(0);-1===r.indexOf(e.getChannelId())&&(r.push(e.getChannelId()),t.setSubscribers(r));const a=e.getSubscriptions().slice(0);-1===a.indexOf(n)&&(a.push(n),e.setSubscriptions(a))}else this._tracing.error("Channel being subscribed to does not exist",[{name:"ChannelId",value:n}])}}else this._tracing.error("toChannels parameter is null",[{name:"subscriber_channel_id",value:e.getChannelId()}])}unsubscribe(e,t){if(this._assertChannel(e),t){t=this._ensureStringArray(t);for(const n of t){const t=this._channels[n];t&&t.setSubscribers(this._removeItemsFromArray(t.getSubscribers(),e.getChannelId())),e.setSubscriptions(this._removeItemsFromArray(e.getSubscriptions(),n))}}else this._tracing.error("toChannels parameter is null",[{name:"subscriber_channel_id",value:e.getChannelId()}])}_assertChannel(e){if(!this._channels[e.getChannelId()])throw Object(f.d)("Unregistered Channel ID",Hp.UNREGISTERED_ERROR_ID,[{name:"ChannelId",value:e.getChannelId()}]);if(this._channels[e.getChannelId()]!==e)throw Object(f.d)("Unauthorized Channel ID",Hp.UNAUTHORIZED_ERROR_ID,[{name:"ChannelId",value:e.getChannelId()}])}_removeItemsFromArray(e,t){return e.filter(e=>e!==t)}_ensureStringArray(e){return"string"==typeof e?[e]:e}}Hp.UNAUTHORIZED_ERROR_ID=1879375873,Hp.UNREGISTERED_ERROR_ID=1879375874,Hp.DUPLICATE_CHANNEL_ERROR_ID=1879375875;var Wp=n("N0PS"),Gp=n("dHD5");class Kp{constructor(e,t){this._xrmObjectCache={};if(!e){const e=new Error("Required parameter is null or undefined: store");throw Bl.a.getInstance().traceManager.getTracer("ClientApi.ClientApiEntry.constructor").error(e.message),e}t===mr.e&&(t=null),this._store=e,this._pageId=t}get primaryContextToken(){return this._primaryContextToken}set primaryContextToken(e){if(this._primaryContextToken){const t=[];t.push({name:"CurrentKey",value:Object(Gp.w)(this._primaryContextToken)}),t.push({name:"NewKey",value:Object(Gp.w)(e)});const n=new Error("ClientApiEntry.primaryContextToken can only be set once");throw Bl.a.getInstance().traceManager.getTracer("ClientApi.ClientApiEntry.primaryContextToken.set").error(n.message),n}this._primaryContextToken=e}get xrmObjectCache(){return this._xrmObjectCache}get xrmInstance(){return this._xrmInstance||(this._xrmInstance=this._store.dispatch(Object(Wp.b)(this._pageId))),this._xrmInstance}}var Qp=n("16wZ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class Xp{constructor(e){this._cache={};e||Object(Qp.j)("ClientApi.ClientApiManager.constructor","store"),this._store=e}getClientApiEntry(e){e||(e=mr.e,Bl.a.getInstance().traceManager.getTracer("ClientApi.ClientApiManager.getClientApiEntry").error("Missing pageId"));let t=this._cache[e];return t||(t=new Kp(this._store,e),this._cache[e]=t),t}removeClientApiEntry(e){this._cache[e]&&(delete this._cache[e],Rp.a.instance.sendReportData())}static get usageCounters(){return Rp.a.instance}}var Yp=n.p+"scripts/cordovaAndroid.js?v=1.4.3886-master",Jp=n.p+"scripts/cordovaIOS.js?v=1.4.3886-master";var $p=n.p+"resources/styles/LoadingStylesAndroid.css?v=1.4.3886-master";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var Zp=n("WOnu"),ef=n("5bWN");function tf(e,t){return{type:"recentItems.pushToServer.async",execute:({dispatch:n,getState:r},a)=>function(e,t,n){const r=[];return t.forEach(t=>{if(Object(ef.a)(t,e)){const e=i(t,!1);r.push(e)}}),n.forEach(t=>{if(Object(ef.a)(t,e,!0)){const e=i(t,!0);r.push(e)}}),e.DataSource.UpdateRecentItems(r,null).nativePromise().catch(a);function a(t){return e.TraceManager.getTracer("Recents").error("Pushing recent items to server failed with error: "+t.get_Message()),Promise.reject(t)}function i(e,t){const n=new Zp.a;return n.EntityTypeName=e.EntityTypeName,n.LastAccessedStr=e.LastAccessed.toISOString(),n.ObjectId=A.a.externalGuid(e.ObjectId),null!==e.PinStatus&&void 0!==e.PinStatus&&(n.PinStatus=e.PinStatus),n.RecordType=e.RecordType,n.IsUserView=e.IsUserView,n.Title=e.Title,n.IconPath=e.IconPath,n.IsDeleted=t,n}}(a,e,t)}}function nf(){return{type:"retrieve.recentItems.fromLocal.async",execute:({dispatch:e},t)=>function(e,t){return e(Object(ss.a)("recentItemsInformation")).then(e=>{const n=[];return(e||[]).map(rf).forEach(e=>{Object(ef.a)(e,t)&&n.push(e)}),n},e=>(t.TraceManager.getTracer("RecentItems").warn("Error on recent items from local store retrieval:"+e.message),[]))}(e,t)}}function rf(e){return e.LastAccessed instanceof Date||(e.LastAccessed=new Date(e.LastAccessed)),!e.ObjectId||!e.ObjectId.guid||e.ObjectId instanceof A.a||(e.ObjectId=new A.a(e.ObjectId.guid)),e}var af=n("Xi8U"),of=n("Brg7");class sf{constructor(e,t){this._isPushScheduled=!1,this._isFetchScheduled=!1,this._store=e,this._context=t,this.notifyRecentItemsUpdate=this.notifyRecentItemsUpdate.bind(this)}initialize(e){Object(ts.a)(this._store.getState())===ls.a.MobileApplication&&this._fetchDataFromLocal(e),this._scheduleTheFetchOnAppIdle()}addOnFocusHandler(){this._context.ActivityManager.addOnFocusHandler(this.notifyRecentItemsUpdate)}_getFetchRecents(){if(function(e,t){if(t)return!1;if(null==e)return!0;return Date.now()-e.getTime()>6e5}(Object(af.h)(this._store.getState()),this._isFetchScheduled))return this._scheduleTheFetchOnAppIdle}_scheduleTheFetchOnAppIdle(e=3){0===e||this._isFetchScheduled||(this._isFetchScheduled=!0,this._mruSnapshotBeforeFetch||(this._mruSnapshotBeforeFetch=Object(af.f)(this._store.getState())),Object(b.b)(()=>{const t=new Date,n=this._store.getState();Object(Ys.c)(n)?this._store.dispatch(Object(ta.f)()).then(e=>this._handleSuccessOnFetch(t,e),()=>{this._isFetchScheduled=!1,this._scheduleTheFetchOnAppIdle(e-1)}):this._isFetchScheduled=!1},"Retrieve recent items"))}_fetchDataFromLocal(e){return this._store.dispatch(nf()).then(t=>(this._reportRecentItem(t,e),this._store.dispatch(Object(ta.e)(t))))}_putRecentItemsToLocalStorage(){if(Object(ts.a)(this._store.getState())===ls.a.MobileApplication){const e=Object(af.f)(this._store.getState());this._store.dispatch(function(e){return{type:"save.recentItems.toLocal.async",execute:({dispatch:t})=>t(Object(cs.a)("recentItemsInformation",e,!1))}}(e))}}_handleSuccessOnFetch(e,t){this._isFetchScheduled=!1,this._store.dispatch(ia(e)),this._store.dispatch(Object(ta.e)(t,this._mruSnapshotBeforeFetch)),this._store.dispatch(Object(of.a)((e,n)=>Object(af.g)(e,t))),window.setTimeout(()=>{this._mruSnapshotBeforeFetch=Object(af.f)(this._store.getState()),this._putRecentItemsToLocalStorage()})}_scheduleThePushOnIdle(e,t){this._isPushScheduled||this._context.ActivityManager&&!this._context.ActivityManager.getHasFocus()||(this._isPushScheduled=!0,Object(b.b)(()=>{const n=this._store.getState(),r=Object(af.d)(n),a=Object(af.b)(n);if(r.length>0||a.length>0){if(!Object(Ys.c)(n))return this._putRecentItemsToLocalStorage(),void(this._isPushScheduled=!1);const i=new Date;this._store.dispatch(tf(r,a)).then(()=>this._handleSuccessfulPush(e,i,a),()=>this._handleErrorOnPush(e,t))}else this._isPushScheduled=!1,e&&e()},"Push recent items"))}_handleSuccessfulPush(e,t,n){this._isPushScheduled=!1,this._store.dispatch(ia(t)),this._store.dispatch({type:"recentItem.removeRecentItemsFromState",payload:n}),this._putRecentItemsToLocalStorage(),e&&e()}_handleErrorOnPush(e,t){this._isPushScheduled=!1,t>0&&this._scheduleThePushOnIdle(e,t-1)}notifyRecentItemsUpdate(){const e=this._getFetchRecents();let t;e&&(t=e.bind(this)),this._scheduleThePushOnIdle(t,3)}_reportRecentItem(e,t){try{if(e&&e.length>0){let n=0;const r=e.length;for(const t in e)e[t].PinStatus&&(n+=1);const a=[];a.push({name:"ri",value:r}),a.push({name:"pi",value:n}),t.ReportComponentSuccess("NPSSitMap.recentAndPinnedItem",a)}}catch(e){t.ReportComponentFailure("NPSsiteMap.RecentItemsLocalStorageManagingActions",e)}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var cf=n("tHOi"),lf=n("3I29");var uf=n("hBJV");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var df=n("lk80"),pf=n("pgSX"),ff=n("JRzo"),gf=n("ErQw");function hf(e,t,n){!function(){try{const e=window.localStorage,t="__storage_test__";return e.setItem(t,t),e.removeItem(t),!0}catch(e){return!1}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */()?t.warn("localStorage is not supported by current browser."):(null==n&&(n=Date.now()),localStorage.setItem(e,n),localStorage.removeItem(e))}var mf=n("uufl");class bf{constructor(e,t){this._store=e,this._context=t,this._tracer=t.TraceManager.getTracer("MaxSessionTimeoutMonitor"),this._lastReload=null,this._timerHandler=null,this._warningShowDate=null,this._signoutShowDate=null,this._isSignoutDialogOpened=!1,this._warningDialogPageId=null,this._isPreviewModeEnabled=Object(Kc.e)(this._store.getState()),this._storageEventHandler=this._storageEventHandler.bind(this),this.checkSessionTimeout=this.checkSessionTimeout.bind(this),this._showWarning=this._showWarning.bind(this),this._hideWarning=this._hideWarning.bind(this),this._showSignout=this._showSignout.bind(this),this._doSignout=this._doSignout.bind(this),this._reload=this._reload.bind(this),this._registerAuthExpiryReminder=this._registerAuthExpiryReminder.bind(this)}start(e){const t=Object(fs.D)(this._store.getState()),n=t.sessionTimeoutReminderInSeconds,r=t.sessionTimeoutInSeconds;if(r<=0||-1===n)return void this._tracer.info("Max Session timeout monitor did not start since authexpiration is not enabled or input values are not valid.");this._tracer.info(`Max Session timeout monitor started and monitoring page: ${window.location.href}, newUpdate: ${e}.`);const a=[{name:"page",value:window.location.href},{name:"newUpdate",value:e},{name:"warningInSeconds",value:n},{name:"signoutInSeconds",value:r},{name:"isPreviewModeEnabled",value:Object(Kc.e)(this._store.getState())}];this._context.EventManager.ReportComponentSuccess("MaxSessionTimeoutMonitor.Start",a),window.removeEventListener("storage",this._storageEventHandler),window.addEventListener("storage",this._storageEventHandler),window.RegisterAuthExpiryReminder=null,window.RegisterAuthExpiryReminder=this._registerAuthExpiryReminder;const i=this._getCurrentTime();if(this._warningShowDate=n>0?i+1e3*n:null,this._signoutShowDate=r>0?i+1e3*r:null,this._lastReload=e,this.checkSessionTimeout(i),0!==n){const t={now:i,enabled:!0,warning:n,signout:r,lastupdate:e};hf("oss_reload",this._tracer,JSON.stringify(t))}else 0!==r?(this._showWarning(),hf("oss_showWarning",this._tracer)):this._doSignout("Max Session Timeout Monitor sign out user in start method because warning and signout timed out before page refresh",!1)}getIsSignoutDialogOpened(){return this._isSignoutDialogOpened}_storageEventHandler(e){if(null!==e.newValue&&void 0!==e.newValue&&""!==e.newValue)switch(e.key){case"oss_showWarning":this._showWarning();break;case"oss_hideWarning":this._hideWarning();break;case"oss_showSignOut":this._showSignout();break;case"oss_mustSignOut":this._doSignout(`Received a ${e.key} event from the storage event handler in max session timeout monitor`,!1);break;case"oss_reload":this._reload(JSON.parse(e.newValue))}}_showWarning(){const e=Object(mf.a)(this._store.getState());if(e||this._isSignoutDialogOpened){const t=[{name:"isSigninDialogOpened",value:this._isSignoutDialogOpened},{name:"isReauthInProgress",value:e}];this._tracer.warn("Session timout warning dialog prevented from opening",t)}else this._isPreviewModeEnabled||(this._store.dispatch(Object(Ka.b)(!0)),this._store.dispatch(Object(Fe.e)(ff.q)).then(()=>{this._context.EventManager.ReportComponentSuccess("MaxSessionTimeoutMonitor.Warning",[{name:"info",value:"Max session warning dialog displayed"}]);const e=Object(zc.e)(this._store.getState(),ff.q),t=Object(ps.x)(this._store.getState()).isLive,n=e[ff.n],r=e[ff.h],a=String.format(e[ff.k],t?n:r),i=e[ff.o],o=e[ff.i],s=e[ff.p];return this._store.dispatch(Object(pf.a)(Vc.f,"",gf.b,i,s,a,o)).then(e=>{if(0===e.status)return this._warningDialogPageId=e.pageId,this._store.dispatch(Object(Uc.a)(e.pageId)).then(e=>{e&&e.value&&!e.value.confirmed&&(this._warningDialogPageId=null,hf("oss_hideWarning",this._tracer),this._tracer.info("User cancelled/closed max session timeout warning dialog")),this._store.dispatch(Object(Ka.b)(!1))});this._store.dispatch(Object(Ka.b)(!1)),this._tracer.error("User is forced to cancel/close due to max session timeout dialog error: "+e.error)})}).catch(e=>{this._store.dispatch(Object(Ka.b)(!1)),this._tracer.error("Max Session timeout resource string retrieval failed "+e)}))}_hideWarning(){null!==this._warningDialogPageId&&(this._store.dispatch(Object(F.e)(this._warningDialogPageId)),this._store.dispatch(Object(Ka.b)(!1)),this._warningDialogPageId=null)}_showSignout(){this._isSignoutDialogOpened||(this._isSignoutDialogOpened=!0,this._store.dispatch(Object(Fe.e)(ff.q)).then(()=>{this._context.EventManager.ReportComponentSuccess("MaxSessionTimeoutMonitor.Signout",[{name:"info",value:"Max session signout dialog displayed"}]);const e=Object(zc.e)(this._store.getState(),ff.q);let t,n,r,a;return this._isPreviewModeEnabled?(t=e[ff.m],n="",r=e[ff.g],a=""):(t=e[ff.l],n=e[ff.j],r=e[ff.g],a=Vc.a),this._store.dispatch(Object(pf.a)(a,"",gf.a,n,r,t)).then(e=>{if(0===e.status)return this._store.dispatch(Object(Uc.a)(e.pageId)).then(e=>{this._isSignoutDialogOpened=!1;const t="User confirmed to sign out from max session timeout dialog.";this._doSignout(t,!0),hf("oss_mustSignOut",this._tracer),this._tracer.info(t)});this._isSignoutDialogOpened=!1;const t="User is forced to sign out due to max session timeout dialog error: "+e.error;this._doSignout(t,!1),hf("oss_mustSignOut",this._tracer),this._tracer.error(t)}).catch(e=>{this._isSignoutDialogOpened=!1;const t="User is forced to sign out due to max session timeout dialog error: "+e;this._doSignout(t,!1),hf("oss_mustSignOut",this._tracer),this._tracer.error(t)})},()=>{this._isSignoutDialogOpened=!1;const e="Max Session timeout resource string retrieval failed";this._tracer.error(e),this._doSignout(e,!1),hf("oss_mustSignOut",this._tracer)}))}_doSignout(e,t){return this._store.dispatch(Object(Xo.b)(e,t))}_reload(e){const t=e.enabled,n=e.warning,r=e.signout,a=e.now,i=e.lastupdate;if(t){if(i&&(null===this._lastReload||this._lastReload<i)){const e=n>0?a+1e3*n:null,t=r>0?a+1e3*r:null;if(this._warningShowDate=e,this._signoutShowDate=t,this._lastReload=i,null!==this._warningShowDate&&this._hideWarning(),a>=this._signoutShowDate||a>=this._warningShowDate){const e=[{name:"currentDate",value:a},{name:"signoutShownDate",value:this._signoutShowDate},{name:"warningShownDate",value:this._warningShowDate}];this._tracer.warn("Session timout dialog will be shown as a result of reauth success handler",e)}this.checkSessionTimeout(a)}}else clearTimeout(this._timerHandler),this._timerHandler=null}checkSessionTimeout(e){clearTimeout(this._timerHandler),this._timerHandler=null;let t=0;void 0===e&&(e=this._getCurrentTime()),null!==this._signoutShowDate&&e>=this._signoutShowDate?(this._hideWarning(),hf("oss_hideWarning",this._tracer),this._showSignout(),hf("oss_showSignOut",this._tracer),this._tracer.warn(`Max session reminder timeout, showing signout dialog, _signoutShowDate: ${this._signoutShowDate}, currentDate: ${e}.`)):null===this._warningShowDate||e>=this._warningShowDate?(null!==this._warningShowDate&&(this._showWarning(),hf("oss_showWarning",this._tracer),this._tracer.warn("Max session timeout, warning dialog shown")),null!==this._signoutShowDate&&(t=this._signoutShowDate-e)):t=this._warningShowDate-e,t>0&&this._waitFor(this.checkSessionTimeout,t)}_registerAuthExpiryReminder(e,t,n,r){const a={now:this._getCurrentTime(),enabled:e,warning:t,signout:n,lastupdate:r};this._reload(a),hf("oss_reload",this._tracer,JSON.stringify(a))}_getCurrentTime(){return Date.now()}_waitFor(e,t){clearTimeout(this._timerHandler),this._timerHandler=setTimeout(e,t)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const yf=["Inactivity_Dialog_Warning_Description","Inactivity_Dialog_Error_Description","Inactivity_Dialog_Continue_Button","ErrorIconAltWarning","ErrorIconAltInformation"];var _f=n("Zvo8");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function vf(e){!function(e){window.addEventListener("pointerdown",()=>{e.forEach(e=>e.registerActivity())},!0),window.addEventListener("pointermove",()=>{e.forEach(e=>e.registerActivity())},!0),window.addEventListener("scroll",()=>{e.forEach(e=>e.registerActivity())},!0),window.addEventListener("keydown",()=>{e.forEach(e=>e.registerActivity())},!0)}(e),function(e){window.addEventListener("focus",()=>{e.forEach(e=>e.registerTabState(!0))},!0),window.addEventListener("blur",()=>{e.forEach(e=>e.registerTabState(!1))},!0),window.addEventListener("beforeunload",()=>{e.forEach(e=>e.registerTabClose())},!0)}(e),e.forEach(e=>e.start())}function Sf(){return null!==Object(_f.b)("ost_sessionHasExpired")}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class Of{constructor(e,t){this._store=e,this._context=t,this._tracer=t.TraceManager.getTracer("InactivityTimeoutMonitor");const n=Object(fs.D)(this._store.getState());this._inactivitySignoutInSeconds=n.inactivityTimeoutInSeconds,this._inactivityWarningInSeconds=n.inactivityTimeoutReminderInSeconds,this._isMonitorEnabled=!1,this._timerHandler=null,this._currentLastInactivityTime=0,this._isReminderDialogOpened=!1,this._isSignoutDialogOpened=!1,this._warningDialogPageId=null}start(){if(!this.isEligible())return this._tracer.info("Inactivity Session timeout monitor did not start because it was ineligible."),void(this._isMonitorEnabled=!1);this._isMonitorEnabled=!0;const e=[{name:"signoutInSeconds",value:this._inactivitySignoutInSeconds},{name:"warningInSeconds",value:this._inactivityWarningInSeconds}];this._context.EventManager.ReportComponentSuccess("InactivityTimeoutMonitor.Start",e),Sf()?this._tryToSignOut({force:!0}):(window.addEventListener("storage",e=>this._storageEventHandler(e)),this.registerTabState(this._isCurrentTabActive()),hf("ost_newMonitorInstance",this._tracer,this._currentLastInactivityTime))}isEligible(){return this._inactivitySignoutInSeconds>0&&this._inactivityWarningInSeconds>0}registerActivity(){this._isMonitorEnabled&&(this._currentLastInactivityTime=this._getCurrentTime())}registerTabState(e){this._isMonitorActive!==e&&(this._isMonitorActive=e,this._isMonitorActive&&Sf()?this._tryToSignOut({force:!0}):(this.registerActivity(),this.checkInactivity(),hf("ost_newTabSelected",this._tracer,this._currentLastInactivityTime)))}registerTabClose(){Sf()||(clearTimeout(this._timerHandler),this._timerHandler=null,this.registerActivity(),hf("ost_newTabSelected",this._tracer,this._currentLastInactivityTime),this._isMonitorActive=!1)}_isCurrentTabActive(){const e=document;return void 0!==e.hidden&&"hidden"!==e.visibilityState||void 0!==e.mozHidden&&"hidden"!==e.mozVisibilityState||void 0!==e.msHidden&&"hidden"!==e.msVisibilityState||void 0!==e.webkitHidden&&"hidden"!==e.webkitVisibilityState}_storageEventHandler(e){if(null!==e.newValue&&void 0!==e.newValue&&""!==e.newValue)switch("ost_SyncLastActivityTime"!==e.key&&"ost_newMonitorInstance"!==e.key&&"ost_newTabSelected"!==e.key&&"ost_showWarning"!==e.key&&"ost_hideWarning"!==e.key&&"ost_signOut"!==e.key||this._tracer.info(`Event received ${e.key}, ${e.newValue}`),e.key){case"ost_newMonitorInstance":Sf()?this._tryToSignOut({force:!0}):(this._hideWarning(),this._updateCurrentLastInactivityTimeFromEvent(e.newValue));break;case"ost_SyncLastActivityTime":case"ost_newTabSelected":this._updateCurrentLastInactivityTimeFromEvent(e.newValue);break;case"ost_showWarning":this._showWarning(),this._updateCurrentLastInactivityTimeFromEvent(e.newValue);break;case"ost_hideWarning":this._hideWarning(),this._updateCurrentLastInactivityTimeFromEvent(e.newValue);break;case"ost_signOut":const t="true"===e.newValue;this._tryToSignOut({force:t,mustNotify:!1})}}_updateCurrentLastInactivityTimeFromEvent(e){const t=+e;this._currentLastInactivityTime!==t&&(!this._currentLastInactivityTime||this._currentLastInactivityTime<t?(this._currentLastInactivityTime=t,this.checkInactivity()):hf("ost_SyncLastActivityTime",this._tracer,this._currentLastInactivityTime))}checkInactivity(){const e=(this._getCurrentTime()-this._currentLastInactivityTime)/1e3;if(e>=this._inactivitySignoutInSeconds&&this._inactivitySignoutInSeconds>0)Object(_f.c)("ost_sessionHasExpired","1",10),this._tryToSignOut({});else if(e>=this._inactivityWarningInSeconds&&this._inactivityWarningInSeconds>0)this._syncWithOtherWindowsAndCheckWarning();else{const t=1e3*(this._inactivityWarningInSeconds-e);this._waitFor(()=>this.checkInactivity(),t)}}_syncWithOtherWindowsAndCheckWarning(){hf("ost_SyncLastActivityTime",this._tracer,this._currentLastInactivityTime),this._waitFor(()=>this._checkInactivityWarning(),500)}_checkInactivityWarning(){let e=0;const t=(this._getCurrentTime()-this._currentLastInactivityTime)/1e3;t>=this._inactivityWarningInSeconds?(this._showWarningAndNotify(),e=1e3*(this._inactivitySignoutInSeconds-t)):e=1e3*(this._inactivityWarningInSeconds-t),this._waitFor(()=>this.checkInactivity(),e)}_showWarningAndNotify(){this._showWarning(),hf("ost_showWarning",this._tracer,this._currentLastInactivityTime)}_showWarning(){this._isReminderDialogOpened||this._isSignoutDialogOpened?this._isSignoutDialogOpened&&this._tracer.warn("inactivity timeout is prevented to open warning dialog when signout dialog is already opened"):(this._isReminderDialogOpened=!0,this._store.dispatch(Object(Fe.e)(yf)).then(()=>{this._context.EventManager.ReportComponentSuccess("InactivityTimeoutMonitor.Warning",[{name:"info",value:"Inactivity warning dialog displayed"}]);const e=Object(zc.e)(this._store.getState(),yf),t=e.Inactivity_Dialog_Continue_Button,n=e.ErrorIconAltWarning,r=e.Inactivity_Dialog_Warning_Description;return this._store.dispatch(Object(pf.a)(Vc.a,r,gf.b,t,n)).then(e=>{if(0===e.status)return this._isMonitorEnabled=!1,this._warningDialogPageId=e.pageId,this._store.dispatch(Object(Uc.a)(e.pageId)).then(()=>{this._isReminderDialogOpened=!1,this._warningDialogPageId=null,this._hideWarning(),this.registerActivity(),this.checkInactivity(),hf("ost_hideWarning",this._tracer,this._currentLastInactivityTime),this._tracer.info("User cancelled/closed inactivity timeout warning dialog")});this._isMonitorEnabled=!0,this._isReminderDialogOpened=!1,this._tracer.error("inactivity timeout can't open the warning dialog, navResult: "+e)})},()=>{this._isMonitorEnabled=!0,this._isReminderDialogOpened=!1,this._tracer.error("inactivity timeout resource string retrieval failed")}))}_hideWarning(){this._isReminderDialogOpened&&(null!==this._warningDialogPageId&&this._store.dispatch(Object(F.e)(this._warningDialogPageId)),this._isReminderDialogOpened=!1,this._warningDialogPageId=null),this._isMonitorEnabled=!0}_tryToSignOut(e){(e=e||{}).force=!!e.hasOwnProperty("force")&&e.force,e.mustNotify=!e.hasOwnProperty("mustNotify")||e.mustNotify,this._hideWarning(),this._isMonitorEnabled=!1,this._isSignoutDialogOpened||(this._isSignoutDialogOpened=!0,this._store.dispatch(Object(Fe.e)(yf)).then(()=>{const t=[{name:"info",value:"Inactivity signout dialog displayed"},{name:"force",value:e.force},{name:"mustNotify",value:e.mustNotify}];this._context.EventManager.ReportComponentSuccess("InactivityTimeoutMonitor.Signout",t);const n=Object(zc.e)(this._store.getState(),yf),r=n.Inactivity_Dialog_Error_Description,a=n.ErrorIconAltInformation;return this._store.dispatch(Object(pf.a)(Vc.a,r,gf.a,"",a)).then(e=>0===e.status?this._store.dispatch(Object(Uc.a)(e.pageId)).then(()=>this._handleSignout("User confirmed to sign out from inactivity timeout dialog.",!0)):this._handleSignout("User is forced to sign out due to max session timeout dialog error: "+e.error,!1)).catch(e=>this._handleSignout("User is forced to sign out due to max session timeout dialog error: "+e,!1))},()=>this._handleSignout("inactivity timeout resource string retrieval failed",!1))),this._isMonitorActive||e.force?this._handleSignout(`User signed out from inactivity timeout. IsMonitorActive:${this._isMonitorActive}, Force:${e.force}`,!1):hf("ost_signOut",this._tracer,!1)}_handleSignout(e,t){return this._isSignoutDialogOpened=!1,""!==e&&this._tracer.error(e),hf("ost_signOut",this._tracer,!0),this._store.dispatch(Object(Xo.b)(e,t)).then(()=>{Object(_f.a)("ost_sessionHasExpired")})}_getCurrentTime(){return Date.now()}_waitFor(e,t){clearTimeout(this._timerHandler),this._timerHandler=setTimeout(e,t)}getIsReminderDialogOpened(){return this._isReminderDialogOpened}getIsSignoutDialogOpened(){return this._isSignoutDialogOpened}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var Cf=n("3mEc"),Ef=n("V6aM"),If=(n("NUY7"),n("FM/+"));function wf(e,t,n,r){const a=r.filter(t=>{const n=Object(Cf.j)(e,t);return!n||!n.Name});return t(Object(bt.d)(a)).then(()=>{const a=Object(fs.x)(e),i=/^\$webresource:/i,o=Object(Cf.e)(e,r).map(e=>e.replace(a,"").replace(i,"")),s=!Object(Ys.c)(e);return n.loadWebResourcesForAllContexts(o,a,3,e=>t(Object(Ef.a)(e)),s)})}function jf(e,t,n,r,a,i,o,s=[]){try{const c=Object(Cf.j)(t,r);s.push({name:"type",value:o}),s.push({name:"libraryName",value:r}),s.push({name:"functionName",value:a}),s.push({name:"webResourceName",value:c.name}),s.push({name:"solutionName",value:c.solutionName}),s.push({name:"publisherName",value:c.publisherName}),n.execute(a,i,!0,{webResourceName:c&&c.name,solutionName:c&&c.solutionName,solutionVersion:c&&c.solutionVersion,publisherName:c&&c.publisherName,type:o}),e.EventManager.ReportComponentSuccess("AppCustomizationLoader.executeScript",s)}catch(e){throw s.push({name:"IsCustomizationError",value:"true"}),Object(f.b)(e,s),e}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class Pf{constructor(){this._config={childList:!0,subtree:!0,attributes:!0,characterData:!0},this._observers=[]}addObserverTarget(e,t,n){t||(t=Pf.UCLIENT_SHELL);const r=document.getElementById(t);r&&(e.observe(r,n||this._config),this._observers.push(e))}removeObserverTarget(e){this._observers=this._observers.filter(t=>(t===e&&t.disconnect(),t!==e))}}Pf.UCLIENT_SHELL="shell-container";var Tf=n("Gilj");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class Nf{constructor(){this.emptyQueue()}enqueue(e){this._queue.push(e)}emptyQueue(){this._queue=[]}isItemInQueue(e){return-1!==this._queue.indexOf(e)}getItemAtIndex(e){return e<0||e>=this._queue.length?null:this._queue[e]}length(){return this._queue.length}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class Af{constructor(e){this._shortcutDictionary={},this._keyDownQueue=new Nf,this._applicationContext=e,document.addEventListener("keydown",e=>{this._onKeyDownListener(e,this)}),document.addEventListener("keyup",e=>{this._onKeyUpListener(e,this)})}registerShortcut(e){const t=this.getStringKeyFromKeyCombination(e.getKeyCombination());if(null==t)return;let n=this._shortcutDictionary[t];null==n&&(n=new Array),n.push(e),this._shortcutDictionary[t]=n}deregisterShortcut(e){const t=this.getStringKeyFromKeyCombination(e.getKeyCombination());if(null==t)return;const n=this._shortcutDictionary[t],r=[];if(null!=n)for(let t=0;t<n.length;t++)n[t].getSrcElementId()===e.getSrcElementId()&&n[t].getIsGlobal()===e.getIsGlobal()&&n[t].getAreaName()===e.getAreaName()||r.push(n[t]);this._shortcutDictionary[t]=r}getStringKeyFromKeyCombination(e){let t="";for(let n=0;n<e.length-1;n++)t+=e[n]+",";return t+=e[e.length-1],0===t.length?null:t}showShortcutsByCategory(){const e=this._getShortcutsByCategory();for(const t in e){console.log(t);const n=e[t];for(let e=0;e<n.length;e++){const t=n[e];t.getIsHidden()||console.log("Shortcut: "+this.getStringKeyFromKeyCombination(t.getKeyCombination())+" "+t.getShortcutDescription())}}}_getShortcutsByCategory(){const e={};for(const t in this._shortcutDictionary){const n=this._shortcutDictionary[t];for(let t=0;t<n.length;t++){const r=n[t].getAreaName();if(r){if(e[r]){const a=e[r];let i=!1;for(let e=0;e<a.length;e++)if(this.getStringKeyFromKeyCombination(a[e].getKeyCombination())===this.getStringKeyFromKeyCombination(n[t].getKeyCombination())){i=!0;break}i||e[r].push(n[t])}else e[r]=[n[t]]}}}return e}_onKeyDownListener(e,t){const n=e.keyCode||e.which;t._keyDownQueue.isItemInQueue(n)||t._keyDownQueue.enqueue(n),t._tryFireKeyboardShortcut(e,Tf.b.KeyDown)}_onKeyUpListener(e,t){t._tryFireKeyboardShortcut(e,Tf.b.KeyUp),t._keyDownQueue.emptyQueue()}_tryFireKeyboardShortcut(e,t){let n=0,r="";for(;n<this._keyDownQueue.length()-1;n++)r+=this._keyDownQueue.getItemAtIndex(n)+",";r+=this._keyDownQueue.getItemAtIndex(n),this._callShortcutHandler(r,e,t)}_callShortcutHandler(e,t,n){if(null==e)return;const r=this._shortcutDictionary[e];if(null!=r)for(let e=0;e<r.length;e++){const a=t.srcElement||t.target;if((r[e].getSrcElementId()===a.id||r[e].getIsGlobal())&&r[e].getKeyboardShortcutType()===n){const n=new Tf.c;n.EVENT=t,n.APPLICATION_CONTEXT=this._applicationContext,r[e].getShortcutHandler()(n)}}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Rf(e){const t=function(e){return{position:"absolute",left:e.element.offsetLeft+e.element.clientWidth/2,top:e.element.offsetTop+e.element.clientHeight-7,background:"dimgrey",color:"white",width:"17px",borderRadius:"2px",textAlign:"center"}}(e);return u.createElement("div",{style:t},u.createElement("span",null," ",e.accessKey," "))}Rf.displayName="KeyTipIndicator";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class Df{constructor(e,t,n){this.setAccessKey(e),this.setElement(t),this.setIsDisplayed(n)}getAccessKey(){return this._accessKey}setAccessKey(e){e.length>0?this._accessKey=e:this._accessKey=""}getElement(){return this._element}setElement(e){this._element=e}getIsDisplayed(){return this._isDisplayed}setIsDisplayed(e){this._isDisplayed=e}clone(){return new Df(this.getAccessKey(),this.getElement(),this.getIsDisplayed())}}class xf extends u.Component{constructor(e){super(e),this.state={keyTips:[]}}render(){const e=[];for(let t=0;t<this.state.keyTips.length;t++)if(this.state.keyTips[t].getIsDisplayed()){const n="keyTip"+[t];e.push(u.createElement(Rf,{key:n,accessKey:this.state.keyTips[t].getAccessKey(),element:this.state.keyTips[t].getElement()}))}return u.createElement("div",null," ",e," ")}}var Mf=n("3rse");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class Ff{constructor(){this._keyTipPressed="",this._currentKeyTips=[],document.addEventListener("keydown",e=>{this._launchAccessKeyFunction(e)})}toggleKeyTips(){this._keyTipsRootComponent?this._hideKeyTips():this._showKeyTips()}_createRootElement(){this._keyTipRoot||(this._keyTipRoot=document.createElement("div"),this._keyTipRoot.id="keyTipContainer",document.body.appendChild(this._keyTipRoot))}_removeRootElement(){this._keyTipRoot&&(document.body.removeChild(this._keyTipRoot),this._keyTipRoot=null)}_showKeyTips(){this._createRootElement(),this._readAccessKeys(document.body);const e={keyTips:this._currentKeyTips},t=u.createElement(xf,null);this._keyTipsRootComponent=d.render(t,this._keyTipRoot),this._keyTipsRootComponent.setState(e),document.body.focus()}_hideKeyTips(){d.unmountComponentAtNode(this._keyTipRoot),this._keyTipsRootComponent=null,this._keyTipPressed="",this._currentKeyTips=[],this._removeRootElement()}_launchAccessKeyFunction(e){let t=!1;if(this._keyTipsRootComponent){const n=[];e.keyCode===Mf.a.Escape&&this._hideKeyTips();for(let r=0;r<this._currentKeyTips.length;r++){const a=this._currentKeyTips[r].clone();if(a.getIsDisplayed()){const n=this._keyTipPressed+e.key.toUpperCase(),i=a.getAccessKey().toUpperCase();if(n===i)return this._currentKeyTips[r].getElement().click(),void this._hideKeyTips();0===i.indexOf(n)&&i.length>1?t=!0:a.setIsDisplayed(!1)}n.push(a)}if(t){const t={keyTips:n};this._currentKeyTips=n,this._keyTipPressed+=e.key.toUpperCase(),this._keyTipsRootComponent.setState(t)}}}_readAccessKeys(e){if(e)for(let t=0;t<e.children.length;t++){const n=e.children.item(t);if(n.tabIndex>-1&&"hidden"!==n.style.visibility&&"none"!==n.style.display&&null!==n.accessKey&&n.accessKey.length>0){const e=new Df(n.accessKey,n,!0);this._currentKeyTips.push(e)}this._readAccessKeys(n)}}}var kf=n("SocB"),Lf=n("dfL6"),Bf=n("GZHP"),Uf=n("PsCI"),Vf=n("rhTL"),zf=n("ju1h");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class qf{constructor(e){this._applicationContext=e}registerShortCut(e){const t=new Tf.a([Uf.a.Ctrl,Uf.a.M],this._notificationKeyboardShortcutHandler.bind(this),!0,"Notification keyboard shortcut","Using Ctrl+M to navigate to notification");e.registerShortcut(t)}_getAllNotification(){return document.body.querySelectorAll(`[${zf.f}=true]`)}_getCurrentNotificationIndex(e,t){for(let n=0;n<e.length;n++)if(e[n].contains(t))return n;return-1}_getNextNotificationFocus(e){const t=this._getAllNotification();if(0===t.length)return null;const n=this._getCurrentNotificationIndex(t,e);let r=t.length;return r=n<=0?t.length-1:n-1,r!==n?t[r]:null}_notificationKeyboardShortcutHandler(e){const t=e.EVENT,n=this._getNextNotificationFocus(t.target);n&&(this._applicationContext.AccessibilityManager.showOutlineState(!0),Object(Vf.a)(n,n.firstChild,!0))}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let Hf="noOutline";class Wf{constructor(e,t){this._landmarkRegionKeyboardShortcutManager=null,this._popupKeyboardShortcutManager=null,this._notificationKeyboardShortcutManager=null,this._shortcutManager=new Af(e),this._keyTipsManager=new Ff,this._createGlobalShortcuts(t),this._handleKeyDownForOutline=this._handleKeyDownForOutline.bind(this),this._handerMouseClickForOutline=this._handerMouseClickForOutline.bind(this);const n=t.getState();Object(Ho.f)(n,Wo.kf)&&Object(Ho.f)(n,Wo.hf)&&(Hf="nonOutline"),this.showOutlineState(!1),Object(Lf.b)(n)&&(this._landmarkRegionKeyboardShortcutManager=new Lf.a(e),this._landmarkRegionKeyboardShortcutManager.registerGlobalShortCut()),Object(Bf.b)(n)&&(this._popupKeyboardShortcutManager=new Bf.a(e),this._popupKeyboardShortcutManager.registerShortCut(this._shortcutManager)),this._notificationKeyboardShortcutManager=new qf(e),this._notificationKeyboardShortcutManager.registerShortCut(this._shortcutManager)}setMainAccessibilityComponentStack(e){this._accessibilityStack=e}getAccessibilityComponentStack(e){return this._accessibilityStack}registerKeyboardShortcuts(e){if(e)for(let t=0;t<e.length;t++)this._shortcutManager.registerShortcut(e[t])}deregisterKeyboardShortcuts(e){e&&this._deregisterKeyboardShortcuts(e)}showOutlineState(e){const t=document.body;t&&(e&&!t.classList.contains("showOutline")?(t.classList.remove(Hf),t.classList.add("showOutline"),document.addEventListener("focusin",this._handleKeyDownForOutline),document.removeEventListener("keydown",this._handleKeyDownForOutline),document.addEventListener("mousedown",this._handerMouseClickForOutline)):e||t.classList.contains(Hf)||(t.classList.remove("showOutline"),t.classList.add(Hf),document.removeEventListener("focusin",this._handleKeyDownForOutline),document.addEventListener("keydown",this._handleKeyDownForOutline),document.removeEventListener("mousedown",this._handerMouseClickForOutline)))}_deregisterKeyboardShortcuts(e){if(null!=e)for(let t=0;t<e.length;t++)this._shortcutManager.deregisterShortcut(e[t])}_handleKeyDownForOutline(e){if(jo.a.getInstance().get_IsBrowserIE()||jo.a.getInstance().get_IsBrowserEdge()){let t=e.target;const n=document.getElementById(t.id);if(n&&n.style){let e="";do{e=window.getComputedStyle(t).backgroundColor,t=t.parentElement}while("transparent"===e&&t);const r=Object(kf.i)(e),a=Object(kf.k)(r).luminosity;n.style.outlineColor=a<.5?"#666666":"#FFFFFF"}}e.keyCode!==Mf.a.Tab&&e.keyCode!==Mf.a.UpArrow&&e.keyCode!==Mf.a.DownArrow&&e.keyCode!==Mf.a.LeftArrow&&e.keyCode!==Mf.a.RightArrow||this.showOutlineState(!0)}_handerMouseClickForOutline(e){this.showOutlineState(!1)}_createGlobalShortcuts(e){const t=this._gotoFirstFocusableElement.bind(this),n=new Tf.a([Mf.a.Ctrl,Mf.a.Num1],t,!0,"Global","Focuses the first element on the current page");this._shortcutManager.registerShortcut(n);const r=this._toggleKeyTips.bind(this),a=new Tf.a([Mf.a.Shift,Mf.a.Alt],r,!0,"Global","Shows the currently registered shortcuts");this._shortcutManager.registerShortcut(a);const i=this._showUniqueShortcuts.bind(this),o=new Tf.a([Mf.a.Ctrl,Mf.a.Comma],i,!0,"Global","Shows the access keys as pop-ups");this._shortcutManager.registerShortcut(o);const s=new Tf.a([Mf.a.Alt,Mf.a.Shift,Mf.a.Q],I.e,!0,"Global","",void 0,void 0,!0);this._shortcutManager.registerShortcut(s);const c=new Tf.a([Mf.a.Ctrl,Mf.a.Shift,Mf.a.Alt,Mf.a.D],Ws.c,!0,"Global","",void 0,void 0,!0);this._shortcutManager.registerShortcut(c)}_gotoFirstFocusableElement(e){var t;null===(t=this._accessibilityStack.getCurrentAccessibilityContext())||void 0===t||t.gotoFirstFocusableElement()}_toggleKeyTips(){this._keyTipsManager.toggleKeyTips()}_showUniqueShortcuts(e){this._shortcutManager.showShortcutsByCategory()}}var Gf=n("uNu9"),Kf=n("f+LF"),Qf=n("DsuF");var Xf=n("i1f0");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var Yf=n("BgaZ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var Jf=n("uvnT"),$f=n("QXIS");var Zf=n("amok"),eg=n("/aHX");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class tg{constructor(){this._handlers={}}setHandler(e,t){this._handlers[e]=t}getHandler(e){return this._handlers[e]}}class ng{constructor(e,t){this._store=e,this._context=t}_canClose(){const e=this._store.getState();return Object(ts.a)(e)===ls.a.Browser&&!Object(Es.h)(e)&&this._context.Router.getHistoryManager().GetState().historyLengthOnInitialLoad<=1}close(){return this._canClose()?(setTimeout(()=>window.close(),0),Promise.resolve(!0)):Promise.reject(Object(f.d)("Can not close Windows",2415919132))}}var rg=n("lULv");class ag{constructor(e){this._store=e}close(e){const t=Object(Xc.f)(this._store.getState(),e);return t.option.canBeClosed?this._store.dispatch(Object(rg.a)(t.sidePanelId)):Promise.reject(Object(f.d)("Can not close sidePane",2415919132))}}var ig=n("lmfa");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var og=n("LOik");const sg={id:"LegacyAppPresentNotification",level:3,messageId:Jl.o,buttonLabelId:Jl.f,getActionUrl:()=>"https://go.microsoft.com/fwlink/p/?linkid=2008063&clcid=0x",isValid(e,t){const n=t.getState(),r=!Object(fs.D)(n).allowLegacyClientExperience,a=Object(ps.x)(n).isAdmin||Object(ps.x)(n).isCustomizer,i=e.getInitialUrl().searchParams.get("pagetype")===Jl.c,o=Object(og.a)(n).some(e=>2===e.clientType);return a&&i&&o&&r}},cg={id:"LegacyAppRunningNotification",level:3,messageId:Jl.p,buttonLabelId:Jl.f,getActionUrl:()=>"https://go.microsoft.com/fwlink/p/?linkid=2008063&clcid=0x",isValid(e,t){const n=t.getState(),r=Object(ps.x)(n).isAdmin||Object(ps.x)(n).isCustomizer,a=2===Object(Zo.j)(n);return r&&a}},lg={id:"KitchenSinkAppRunningNotification",level:3,messageId:Jl.n,buttonLabelId:Jl.f,getActionUrl:()=>"https://go.microsoft.com/fwlink/p/?linkid=2086605&clcid=0x",isValid(e,t){const n=t.getState(),r=Object(ps.x)(n).isAdmin||Object(ps.x)(n).isCustomizer,a=Object(Zo.o)(n)===Zo.a;return r&&a}};var ug=n("wRZP"),dg=n("Vv1C");const pg={id:"AppLessModeNotification",level:4,messageId:Jl.e,buttonLabelId:Jl.d,allowDismiss:!1,onAction:e=>({type:"AppLessModeNotificationOpenAppDialog",execute:(e,t)=>e.dispatch(Object(ug.b)())}),isValid(e,t){const n=t.getState();if(Object(Kc.c)(n)||Object(Kc.e)(n)||Object(dg.a)(n))return!1;const r=e.getInitialUrl(),a=!(r.searchParams.has(Jl.a)||r.searchParams.has(Jl.b)),i=r.searchParams.get("pagetype")!==Jl.c;return a&&i}};var fg=n("d4He");const gg={id:"IESupportEndWarningNotifcation",level:3,messageId:Jl.m,buttonLabelId:Jl.l,allowDismiss:!0,getActionUrl:()=>"https://go.microsoft.com/fwlink/p/?linkid=2161158&clcid=0x",isValid:e=>Object(Ho.f)(e.getStore().getState(),Wo.Jd)&&!Object(Ho.f)(e.getStore().getState(),Wo.Id)&&jo.a.getInstance().get_IsBrowserIE()},hg={id:"IEBlockPendingErrorNotification",level:2,messageId:Jl.i,buttonLabelId:Jl.h,allowDismiss:!1,getActionUrl:()=>"https://go.microsoft.com/fwlink/p/?linkid=2161158&clcid=0x",isValid:e=>Object(Ho.f)(e.getStore().getState(),Wo.Id)&&jo.a.getInstance().get_IsBrowserIE()},mg={id:"IECustomPageComponentsNotSupported",level:3,messageId:Jl.k,buttonLabelId:Jl.j,allowDismiss:!1,getActionUrl:()=>"https://go.microsoft.com/fwlink/?linkid=2165387",isValid:e=>jo.a.getInstance().get_IsBrowserIE()&&Object(Zo.f)(e.getStore().getState()).length>0};var bg=n("A8zQ");const yg={id:"UnsupportedBrowserNotification",level:3,messageId:Jl.w,buttonLabelId:Jl.v,allowDismiss:!0,getActionUrl:()=>"https://go.microsoft.com/fwlink/p/?linkid=2163305&clcid=0x",isValid:e=>Object(Ho.e)(e.getStore().getState(),Wo.rf,Wo.kf)&&!Object(bg.a)(e.getStore().getState())};
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function _g(e){return t=>({id:`Update${e.playerName}Mobile${e.platform}ApplicationNotification`,level:3,messageId:Jl.q,buttonLabelId:Jl.x,getActionUrl:()=>(t.ReportComponentSuccess("Notification.ClickOnUpdate"+e.playerName),e.storeLink),isValid(n,r){if(e.fcbName&&!Object(Ho.f)(r.getState(),e.fcbName))return!1;const a=jo.a.getInstance();if(a.get_IsAndroid()&&"Android"===e.platform||a.get_IsIOS()&&"iOS"===e.platform){if(Object(Ks.f)(r.getState())!==e.playerName)return!1;const n=Object(ts.i)(r.getState());if(!(null==n?void 0:n.version))return!1;if(-1!==e.versionExceptions.indexOf(n.version))return!1;if(!Object(Ys.b)(r.getState()))return!1;const a=n.version.split(".");if(a.length<2||a.length>4)return!1;jo.a.getInstance().get_IsIOS()&&a.pop();const i=Number(a[a.length-1]);if(i<1e4)return t.ReportComponentFailure("Notification.Update"+e.playerName,[{name:"mainVersion",value:i}]),!1;const o=i<=e.trainVersion;return o&&t.ReportComponentSuccess("Notification.Update"+e.playerName,[{name:"currentVersion",value:n.version}]),o}return!1}})}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function vg(e){Object(ts.a)(e.getState())===ls.a.MobileApplication&&e.dispatch(Object(Fe.e)([Jl.z,Jl.y])).then(()=>{const t={id:"gcmRevalidateUpdate",type:1,level:4,message:Object(zc.b)(e.getState(),Jl.z),title:null,action:{actionLabel:Object(zc.b)(e.getState(),Jl.y),eventHandler:()=>{window.location.reload()}},onCloseHandler:null,showCloseButton:!0};e.dispatch(Object(ka.b)(t))})}function Sg(e,t){t&&t.data.forEach(t=>{switch(t.reason){case"gcmRevalidateUpdate":vg(e)}})}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var Og=n("OzPR"),Cg=n("hAdb");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Eg="/uclient/";function Ig(e,t,n,r,a,i,o,s,c){navigator.serviceWorker.register(`/uclient/sw.js?cdn=${t}&gcm=${n}&uci=${r}&customPage=${a}&clientHost=${s}&cdnEndpoint=${i}&uciVersion=${o}`,{scope:"/"}).then(t=>{!function(e,t,n){let r,a=!1;e.onupdatefound=()=>{e.installing&&(r=e.installing,r.onstatechange=()=>{switch(r.state){case"installed":if(a)break;navigator.serviceWorker.controller?wg(r,"ServiceWorker update installed, new content is available",t,n):wg(r,"New serviceWorker installed, content has been precached",t,n);break;case"redundant":jg(t,"swRegistrationError",new Error("The installing service worker became redundant."))}wg(r,"State change for registered serviceWorker through swRegistration update",t,n)})},e.waiting&&(wg(e.waiting,"ServiceWorker update intalled, new content is available",t,n),a=!0)}(t,e,c)}).catch(t=>{jg(e,"swRegistrationError",t)})}function wg(e,t,n,r){const a=[{name:"serviceWorkerScriptURL",value:e.scriptURL},{name:"serviceWorkerState",value:e.state},{name:"message",value:t},{name:"preloadFlag",value:r}];n.EventManager.ReportComponentSuccess("ServiceWorkerBootSuccess",a)}function jg(e,t,n){const r=[{name:t,value:n.message}];e.EventManager.ReportComponentFailure("ServiceWorkerBootFailure",n,"",r)}function Pg(e,t,n){!function(e,t){navigator.serviceWorker.getRegistration("/uclient").then(n=>{if(n){const r=n.active||n.waiting||n.installing;n.unregister().then(n=>{n?r&&wg(r,"Unregister serviceWorker success",e):t.warn("Unregistering wwwroot scope serviceWorker resolve with false")}).catch(t=>{jg(e,"swUnRegistrationError",t)})}})}(t,n),Object(bo.c)()}function Tg(e,t,n,r){const a=t.getState();navigator.serviceWorker.getRegistration("/uclient").then(t=>{t&&t.waiting&&wg(t.waiting,"An updated serviceWorker is registered(installed) and waiting to be activated",e)});const i=Object(Ho.f)(a,Wo.Kg),o=Object(Ho.f)(a,Wo.mc),s=window.VERSION_NUMERIC_VALUE,c=function(){const e=window.__public_path__;return![Eg,Object(Og.a)()].includes(e)}(),l=window.__public_path__,u=c?l:"",d=Object(ts.a)(a);n.warn("Attempting to register service worker with :\n\t\t"+JSON.stringify({isCdnEnabled:c,isGcmEnabled:i,isUciResourceCacheEnabled:true,isCustomPageCacheEnabled:o,cdnEndpoint:u,uciVersion:s,clientHost:d,isPreload:r})),Ig(e,c,i,true,o,u,s,d,r);const p=e.EventManager.canSendEvent(E.q.Name,"ServiceWorker.Fetch");navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage({name:up.d,data:{logFetchSuccess:p&&Object(Cg.e)(a,up.e)}});const f={};f.gcmStoredData=Sg,f.gcmRevalidateUpdate=vg,navigator.serviceWorker.addEventListener("message",e=>{e.data&&e.data.reason&&f[e.data.reason](t,e.data)})}function Ng(e,t,n,r,a){Object(bo.a)(t.getState(),r)?Tg(e,t,n,a):Pg(0,e,n)}var Ag=n("Fb4j");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const Rg="AppCachePreFetch";async function Dg(e,t){const n=t.EventManager,r=jo.a.getInstance().get_IsIOS(),a=document.documentElement.getAttribute("manifest");if(!r||null===a||!navigator.onLine)return;const i=await fetch(a);if(!i.ok){const e=[{name:"appManifestUrl",value:a},{name:"status",value:i.status},{name:"statusText",value:i.statusText}];return void n.ReportComponentFailure(Rg,new Error("Failed to fetch app manifest"),"",e)}const o=function(e){let t=!0;const n=[],r=e.split(/\r|\n/);for(let e=1;e<r.length;e++){const a=r[e].trim();switch(a){case"CACHE:":t=!0;continue;case"FALLBACK:":case"NETWORK:":case"SETTINGS:":t=!1;continue}t&&0!==a.length&&!a.startsWith("#")&&kg(a)&&n.push(a)}return n}(await i.text());Promise.all(o.map(Lg)).then(e=>{const t=e.filter(e=>!e.ok);if(t.length>0){const e=[{name:"files",value:JSON.stringify(t)}];n.ReportComponentFailure(Rg,new Error("Failed to fetch some assets"),"",e)}else n.ReportComponentSuccess(Rg)},e=>{n.ReportComponentFailure(Rg,e)})}const xg=[ls.a.MobileApplication.toString()],Mg=lo.b,Fg=p.a.Normal;function kg(e){return 0===e.indexOf("https://")}async function Lg(e){try{const t=await fetch(e);return{file:e,ok:t.ok,status:t.statusText}}catch(t){return{file:e,ok:!1,status:t.message}}}
/**
 * This boot task monitor the cache's state and fires up action when downloading is done.
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var Bg=n("9XdG");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var Ug=n("Sm/T"),Vg=n("qUtK");async function zg(e,t){const r=e.getState(),a=Object(Zo.f)(r).filter(e=>"canvasapp"===e.appElementType&&!Object(T.a)(e.canvasAppType));if(Object(Ho.f)(r,Wo.Tf)&&Object(Ho.f)(r,Wo.l)&&a.length>0){const i=await Promise.all([n.e(5),n.e(127)]).then(n.bind(null,"wge3"));await i.loadAppHostSdk(e,t);const o=e.dispatch(i.initializeAppHostClient());t.EventManager.ReportComponentSuccess("InitializeAppHostClientBootTask"),Object(b.b)(async()=>{var e;if(await o,Object(Ho.f)(r,Wo.pg)&&(null===(e=t.AppHostClient)||void 0===e?void 0:e.loadResourcesAsync)){const{preInitCustomPages:e}=await n.e(69).then(n.bind(null,"22qH"));e(r,t,a)}},"PreinitCustomPage")}}var qg=n("RMPf");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var Hg=n("bktA");class Wg{constructor(e,t){this._context=e,this._key="uci-state-"+t}persistState(e){var t,n;try{if(e){const t=JSON.stringify(e,Gg);window.localStorage.setItem(this._key,t)}else null===(t=this._context.EventManager)||void 0===t||t.ReportComponentFailure("LocalStorageStatePersistence.persistState",Object(f.d)(`Unexpected value of ${e} for input parameter "state"`))}catch(e){null===(n=this._context.EventManager)||void 0===n||n.ReportComponentFailure("LocalStorageStatePersistence.persistState",e)}}retrieveState(){var e;try{const e=window.localStorage.getItem(this._key);if(e){const t=JSON.parse(e,Kg);return Promise.resolve(t)}}catch(t){null===(e=this._context.EventManager)||void 0===e||e.ReportComponentFailure("LocalStorageStatePersistence.retrieveState",t)}return Promise.resolve(void 0)}clearState(){return new Promise((e,t)=>{var n,r,a;try{window.localStorage.removeItem(this._key),null===(n=this._context.EventManager)||void 0===n||n.ReportComponentSuccess("LocalStorageStatePersistence.clearState",[{name:"key",value:this._key}])}catch(e){null===(a=null===(r=this._context)||void 0===r?void 0:r.EventManager)||void 0===a||a.ReportComponentFailure("LocalStorageStatePersistence.clearState",e)}e()})}}function Gg(e,t){if("[object Date]"===Object.prototype.toString.call(this[e]))return"$$IsDate$$"+this[e].toISOString();if("object"==typeof this[e]){if(this[e]instanceof Set)return"$$IsSet$$"+JSON.stringify(Array.from(this[e]));if(this[e]instanceof To.a)return"$$IsLegacyGuid$$"+this[e].toString()}return t}function Kg(e,t){return"string"==typeof t&&t.includes("$$IsDate$$")?new Date(t.split("$$IsDate$$")[1]):"string"==typeof t&&t.includes("$$IsSet$$")?new Set(JSON.parse(t.split("$$IsSet$$")[1])):"string"==typeof t&&t.includes("$$IsLegacyGuid$$")?To.a.tryCreate(t.split("$$IsLegacyGuid$$")[1]):t}var Qg=n("F2/H"),Xg=n("ddoO"),Yg=n("5Oca"),Jg=n("CngE");function $g(e,t){const{data:n,garbageCollector:r}=function(e){const t={};if(!Object(Ho.f)(e,Wo.rg))return t.snapshots=e.data.snapshots,t.lastSnapshotNumber=e.data.lastSnapshotNumber,{data:t};const n={};!function(e,t,n,r){const a=Object(Xg.e)(e);for(const i in a){const o=a[i];for(const a in o){const s=o[a];(null==s?void 0:s.includes(t))&&(n.entities||(n.entities={}),n.entities[i]||(n.entities[i]={}),n.entities[i][a]=Object(Yg.h)(e,i,a),r.entities||(r.entities={}),r.entities[i]||(r.entities[i]={}),r.entities[i][a]||(r.entities[i][a]=[]),r.entities[i][a].includes(t)||r.entities[i][a].push(t))}}const i=Object(Xg.j)(e),o=[];for(const n in i){const r=i[n];if(null==r?void 0:r.includes(t)){const t=Object(Yg.o)(e,n);t&&o.push([n,t])}}if(o.length){o.sort((e,t)=>e[1].lastRetrieved>t[1].lastRetrieved?-1:e[1].lastRetrieved<t[1].lastRetrieved?1:0),n.lists||(n.lists={});for(let e=0;e<Math.min(o.length,5);e++){const a=o[e],i=a[0];n.lists[i]=a[1],r.lists||(r.lists={}),r.lists[i]||(r.lists[i]=[]),r.lists[i].includes(t)||r.lists[i].push(t)}}const s=Object(Xg.a)(e);for(const a in s){const i=s[a];(null==i?void 0:i.includes(t))&&(n.chartData||(n.chartData={}),n.chartData[a]={initialized:Object(Jg.e)(e,a),chartConfigObject:Object(Jg.c)(e,a)},r.chartData||(r.chartData={}),r.chartData[a]||(r.chartData[a]=[]),r.chartData[a].includes(t)||r.chartData[a].push(t))}}(e,Object(Pc.c)(e),t,n);const r={data:n,metadata:void 0};return{data:t,garbageCollector:r}}(e);return{router:e.router,pages:Zg(e),data:n,garbageCollector:r,sessions:e.sessions,tabs:e.tabs,browsingContexts:eh(e),dialogContexts:th(e),appShellState:e.appShellState,personalizations:oh(e,t),editedViews:e.editedViews,panelManager:e.panelManager,telemetry:ah(e),metadata:rh(e),businessProcessFlowDisplayState:e.businessProcessFlowDisplayState}}function Zg(e){const t={},n=Object(Ho.f)(e,Wo.sg);for(const[r,a]of Object.entries(e.pages))Object(Pc.m)(e,r)||!n&&Object(al.b)(e,r)||(t[r]=Object.assign(Object.assign({},a),{isPageUnmounted:!0}),a.__pageName===_p.b&&(t[r].businessProcessFlowUIState=nh(n,a.businessProcessFlowUIState)));return t}function eh(e){if(Object(Ho.f)(e,Wo.sg))return e.browsingContexts;const t={};for(const[n,r]of Object.entries(e.browsingContexts)){const{dialogContextIds:e}=r,a=Object(_a.d)(r,["dialogContextIds"]);t[n]=Object.assign(Object.assign({},a),{dialogContextIds:[]})}return t}function th(e){if(Object(Ho.f)(e,Wo.sg))return e.dialogContexts}function nh(e,t){if(e)return t;if(null==t?void 0:t.dataById){let e=Object.assign({},t),n=!1;for(const[r,a]of Object.entries(t.dataById)){if(null==a?void 0:a.actionLogCollection)for(const[t,i]of Object.entries(a.actionLogCollection))if(null==i?void 0:i.clearOnRestore){e=Object.assign(Object.assign({},e),{dataById:Object.assign(Object.assign({},e.dataById),{[r]:Object.assign(Object.assign({},e.dataById[r]),{actionLogCollection:Object.assign(Object.assign({},e.dataById[r].actionLogCollection),{[t]:Object.assign(Object.assign({},e.dataById[r].actionLogCollection[t]),{status:3,clearOnRestore:!1})})})})}),n=!0;break}if(n)break}return e}return t}function rh(e){const t=e.metadata,{userMetadataVersion:n,metadataVersion:r}=t;return{userMetadataVersion:n,metadataVersion:r}}function ah(e){const t=[];for(const n of Object.keys(e.pages))!Object(Pc.m)(e,n)&&Object(al.b)(e,n)&&t.push({pageType:Object(Pc.j)(e,n)});return{dialogs:t}}let ih=!1;function oh(e,t){try{if(!Object(Ho.f)(e,Wo.Nf))return;if(JSON.stringify(e.personalizations).length>5e5){if(!ih){ih=!0;const e=Object(f.d)("Size limit exceeded");null==t||t.ReportComponentFailure(sh+".getPersonalizationsState",e)}return}return e.personalizations}catch(e){ih||(ih=!0,null==t||t.ReportComponentFailure(sh+".getPersonalizationsState",e))}}const sh="RestoreStateManager";let ch;class lh{constructor(e,t,n){this._context=e,this._store=t,this._initialUciUrl=new URL(window.location.href,window.location.origin);const r=`${Object(Qg.c)(this._initialUciUrl)}-${Object(Qg.d)(this._initialUciUrl)}-${Object(Qg.a)(this._initialUciUrl)}`;this._statePersistence=n||new Wg(e,r),this.persistState=this.persistState.bind(this),this._queuePersistStateOnAppIdle=this._queuePersistStateOnAppIdle.bind(this),this._throttledPersistState=uh(this.persistState),this._isAutomaticStatePersistenceEnabled=Object(Qg.b)()}get shouldReInitializePages(){return!!this._restoredState}get shouldReInitializeCurrentPage(){if(void 0===this._shouldReInitializeCurrentPage){const e=this._context.PlatformContext.getLandingPage();this._shouldReInitializeCurrentPage=!e||this._doesUrlMatchCurrentPage(e)}return this._shouldReInitializeCurrentPage}get isStateRestored(){return!!this._restoredState}static getInstance(e,t,n){return ch||(ch=new lh(e,t,n)),ch}initialize(){this._shouldRestoreState=this._explicitRestoreStateEnabled||Object(Qg.b)(),this._shouldRestoreState&&Object(ru.a)(this._initialUciUrl)&&this._context.PlatformContext.setLandingPage(this._initialUciUrl.toString())}handleBootSuccess(){if(this._shouldRestoreState||this._isAutomaticStatePersistenceEnabled){Object(Ho.f)(this._store.getState(),Wo.vg)&&this._isAutomaticStatePersistenceEnabled?(this._store.dispatch((e=uh(this._queuePersistStateOnAppIdle),{type:"initialize.state.persistence",execute:(t,n)=>new Promise(n=>{t.subscribe(e=>e.pages,e),t.subscribe(e=>e.router,e),t.subscribe(e=>e.data.snapshots,e),t.subscribe(e=>e.sessions,e),t.subscribe(e=>e.tabs,e),t.subscribe(e=>e.browsingContexts,e),t.subscribe(e=>e.appShellState,e),t.subscribe(e=>e.personalizations,e),t.subscribe(e=>e.editedViews,e),t.subscribe(e=>e.businessProcessFlowDisplayState,e),t.subscribe(e=>e.panelManager,e),Object(Ho.f)(t.getState(),Wo.sg)&&t.subscribe(e=>e.dialogContexts,e),Object(Ho.f)(t.getState(),Wo.rg)&&t.subscribe(e=>e.garbageCollector,e),n()}),shouldReceiveFullStore:!0})),this.persistState()):this._statePersistence.clearState(),this._logTelemetry("handleBootSuccess"),this._restoredState=null}var e}handleBootError(){(this._shouldRestoreState||this._isAutomaticStatePersistenceEnabled)&&(this._statePersistence.clearState(),this._logTelemetry("handleBootError"))}async tryRestorePersistedState(){const e=this._shouldRestoreState&&await this._statePersistence.retrieveState();return!!e&&(this._restoredState=e,this._store.dispatch(Object(mo.c)(e)),!0)}restoreRouter(){this._restoredState&&(this._restoreRouterPromises=this._context.Router.restoreRouter(this._restoredState,this.shouldReInitializeCurrentPage))}async initializePages(e){if(this._restoreRouterPromises)for(const e of Object.values(this._restoreRouterPromises).reverse()){(await e)()}this.shouldReInitializeCurrentPage?this.shouldReInitializePages&&!Object(Pc.c)(this._store.getState())&&await this._store.dispatch(Object(Sl.b)()):await Object(ru.b)(e,this._context)}persistState(){const e=this._retrieveStateToSerialize();this._statePersistence.persistState(e)}setExplicitRestoreState(e){this._explicitRestoreStateEnabled=e}_logTelemetry(e){var t,n;const r=[{name:"shouldRestoreState",value:this._shouldRestoreState}];this._restoredState&&(r.push({name:"size",value:JSON.stringify(this._restoredState).length}),(null===(t=this._restoredState.telemetry)||void 0===t?void 0:t.dialogs)&&r.push({name:"closedDialogs",value:JSON.stringify(this._restoredState.telemetry.dialogs)})),null===(n=this._context.EventManager)||void 0===n||n.ReportComponentSuccess(`${sh}.${e}`,r)}_retrieveStateToSerialize(){return $g(this._store.getState(),this._context.EventManager)}_queuePersistStateOnAppIdle(){Object(b.b)(this._throttledPersistState,"persistUciState")}_doesUrlMatchCurrentPage(e){var t;try{const t=this._context.Router,n=Object(Mc.j)(this._restoredState,Object(Pc.c)(this._restoredState));if(n){const r=t.getPageMappings().getFactoryForPageType(n.pageType),a=t.createUrlForPage(r.getName(),n),i=t.getPageMappings().getPageFromUrl(e);if(null==i?void 0:i.input){const e=t.getPageMappings().getFactoryForPageType(i.input.pageType);return a===t.createUrlForPage(e.getName(),i.input)}}}catch(e){null===(t=this._context.EventManager)||void 0===t||t.ReportComponentFailure(sh+".doesUrlMatchCurrentPage",e)}return!1}}function uh(e,t=100){let n=-1;return function(...r){-1===n&&(e.apply(this,r),n=setTimeout(()=>{n=-1},t))}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var dh=n("zhw7");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function ph(e,t){const n=document.createElement("link");n.rel="preconnect",n.href=e,t&&(n.crossOrigin="crossorigin"),document.head.append(n)}var fh=n("wL2W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function gh(e){if(e&&!e.persisted)try{sessionStorage.removeItem("UNEXPECTED_TERMINATION")}catch(e){}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const hh=[{diagnosticName:"DebugSettingsHandler",boot:(e,t)=>{t.DebugSettingsHandler=new gc(t)},supportedClientHostTypes:lo.a,supportedPageTypes:lo.b,priority:p.a.Normal},{diagnosticName:"TraceManager",boot:(e,t)=>{let n="";e.getInitialUrl().searchParams.has("defaulttracelevel")&&(n=e.getInitialUrl().searchParams.get("defaulttracelevel"));const r=new fc(t,dc,[],void 0,n);if(e.getInitialUrl().searchParams.has("traceareas")){const t=e.getInitialUrl().searchParams.get("traceareas");r.setTraceAreas(t)}t.TraceManager=r},supportedClientHostTypes:lo.a,supportedPageTypes:lo.b,priority:p.a.Normal},{diagnosticName:"CreateStore",boot:(e,t)=>{Ln.timelineWalls=ya;const n={configuration:nr,user:re,organization:ae,fcbs:le,metadata:Zt,data:Object(w.a)(Ln),serverStatus:K,currentServerTime:X,theme:Bn.b,designLanguage:Vn,deviceSize:Hn,availablePlatformServices:Kn,pluginState:no,externalContext:Yn,platform:Kr,userSettings:ea,personalizations:pr,persona:hr,businessProcessFlowDisplayState:ho,commands:Ir,copresence:jr,clientHost:Mr,authentication:Br,searchWidget:Rr,toastNotifications:Oa,popupNotifications:Ia,notificationCenter:ja,appNotifications:Ta,appUserSettings:Aa,globalProgressIndicator:Fa,globalNotifications:Ba,recentItems:ca,garbageCollector:qa,reconnectNotification:sr,cache:Ga,sessionTimeoutStatus:Xa,session:Ja,panelManager:ri,browsingContexts:Bi,dialogContexts:Ki,sessions:Ri,tabs:xi,appShellState:wi,contextualHelpBrowser:Gi,editedViews:Xi,appHostClient:Zi,delayLoadingState:ao,availablePlatformPlugins:so,featureControlSettings:co,tours:fo,preloadServiceWorker:_o,powerbi:Oo};Object(I.f)()&&Object.assign(n,{dummyReducer:z});const r=Object(w.a)(n);var a;const i=function(e,t,n,r){const a=[];if(n){const e=(i=n,e=>(t,n)=>{const r=e(t,n);return r.dispatch=function(e,t,n){return function(r){return n(e,r),t.apply(void 0,arguments)}}(r,r.dispatch,i),r});a.push(e)}var i;a.push(R(t),D,M.b);const o=Object(x.c)(...a);return Object(x.d)(e,r,o)}((a=r,(e,t)=>t.type===mo.a?Object.assign(Object.assign({},e),t.payload):a(e,t)),t,Eo);i.currentReducerMap=n;const o=Math.random().toString(36).slice(2);window["__store$"+o]=i,e.setStore(i)},supportedClientHostTypes:lo.a,supportedPageTypes:lo.b,priority:p.a.Normal},{diagnosticName:"EventManager",boot:(e,t,n)=>{const r=function(t,n){const r=e.getInitialUrl().searchParams.get(t);if(r)switch(r.toLowerCase()){case"true":case"1":return!0;case"false":case"0":return!1;default:return n}return n}("telemetry",!1),a=e.getClientHost(),i=e.getInitialUrl().toString(),o=document.referrer,s=window.__preload&&window.__preload.serverRequestId?window.__preload.serverRequestId:null,c=[];Object(Ws.a)()?(c.push(Object(Gs.b)()),c.push(new Hs(t,new rc))):c.push(new Hs(t,console)),t.EventManager=new uc(n,t,a,r,c);const l=[{name:"initialUrl",value:Object(ac.a)(i)},{name:"referrerUrl",value:Object(ac.a)(o)},{name:zo.c.SERVER_REQUEST_ID,value:s}];t.EventManager.ReportComponentSuccess("EventManager.constructor",l),Js.a.setEventManager(t.EventManager)},supportedClientHostTypes:lo.a,supportedPageTypes:lo.b,priority:p.a.Normal},Object(wo.b)(),{diagnosticName:"HostOptions",boot:(e,t,n)=>{const r=e.getClientHost();mc(e.getInitialUrl(),r,t,n)},supportedClientHostTypes:lo.a,supportedPageTypes:lo.b,priority:p.a.Normal},{diagnosticName:"PreconnectToKnownEndpoints",boot:(e,t)=>{try{const e=localStorage.getItem(Ji.a);e&&JSON.parse(e).map(e=>{ph(e,!1),ph(e,!0)})}catch(e){t.TraceManager.getTracer("PRECONNECT_BOOT_TASK_TRACER").warn("Adding preconnect endpoints to document failed",[{name:"errordetails",value:e}])}},supportedClientHostTypes:lo.a,supportedPageTypes:lo.b,priority:p.a.Normal},{diagnosticName:"ApplicationContextDispose",boot:(e,t)=>{t.Dispose=()=>{t.isDisposed?t.TraceManager.getTracer("ApplicationContext").error("The applicationContext has been disposed already"):(t.Router&&t.Router.dispose(),t.isDisposed=!0)}},supportedClientHostTypes:lo.a,supportedPageTypes:lo.b,priority:p.a.Normal},{diagnosticName:"ErrorService",boot:(e,t)=>{t.ErrorService=new Ns({renderer:Object(ws.a)({selectorPrefix:"pa-"})})},supportedClientHostTypes:lo.a,supportedPageTypes:lo.b,priority:p.a.Normal},{diagnosticName:"PerformanceTracking",boot:(e,t)=>{try{const e="false"!==localStorage.getItem("_UCI_PERF_IS_FIRST_APP_START");e&&localStorage.setItem("_UCI_PERF_IS_FIRST_APP_START","false"),O.a.addCommonKpiParameters({[E.b.PageLoadParameters.FirstAppStart]:e.toString()})}catch(e){}Object(I.g)(t),h.a.registerTransport(new Dl,[m.f,m.y,m.E,m.i]),Object(gs.b)({sanitize:I.h,diagnosticName:"Performance",eventNames:[E.r.Name,E.n.Name]}),h.a.registerTransport(new Wl,["CustomScripts",m.f,Tl.NETWORK_REQUEST_EVENT_NAME]),Object(Pl.setAdditionalWindows)("ClientApiFrame_"),Object(Al.a)(window.location.origin,t.EventManager),O.a.initializeZoneActivityTracking([m.y,m.E,m.G,m.c,Tl.NETWORK_REQUEST_EVENT_NAME,S.PERFORMANCE_OBSERVER_ZONE]),O.a.subscribeToPerformanceIssues(e=>{const n=e.parameters?e.parameters.map((e,t)=>({name:"Param"+t,value:e})):[];t.TraceManager.getTracer("Performance").warn(e.message,n)}),xl.a.setPerformanceHooks((t,n)=>{const r=h.a.createEvent(t,n||"CustomControlFramework");return{createMarker:r.createMarker,startStopwatch(t){if(t&&t[m.s]){const n=Object(Gl.e)(e.getStore().getState(),t[m.s]),a=[],i=Object(Nl.addNetworkRequestListener)(e=>{e.id=A.a.toString(A.a.newGuid()),a.push({id:e.id,sync:e.sync})}),o=r.startStopwatch(Object.assign(Object.assign({},t),{solutionName:n&&n.SolutionName,solutionVersion:n&&n.SolutionVersion,publisherName:n&&n.PublisherName}));return e=>{i(),o(Object.assign(Object.assign({},e),a.length>0?{requests:JSON.stringify(a)}:void 0))}}return r.startStopwatch(t)},createRetroactiveStopwatch:r.createRetroactiveStopwatch}},(e,t,n)=>{O.a.addKeyPerformanceIndicator(e,t,n)},(e,t)=>{O.a.addKeyPerformanceIndicatorOnIdle(e,t)},e=>v.a.trackWork(e),M.c),Object(I.b)(e.getInitialUrl()),Object(I.i)(t.EventManager),Object(I.f)()&&Object(I.d)(e.getClientHost());const n=()=>{const n=Object(fs.E)(e.getStore().getState()).organizationId.guid,r=t.EventManager.getCurrentSessionId();window.Footprint.start("d365",["fpc.msedge.net/conf/v2/d365/fpconfig.min.json"],0,JSON.stringify({oid:n,sid:r}),"",{"placeholder.dynamics.com":e.getBaseUrl().host},e=>{Object(Tl.setNetworkInfo)(e.reduce((e,t)=>(e[`${t.Conn}${Ql[t.T]}`]=t.Result.toString(),e),{}))})};Object(b.b)(()=>{Object(Ho.f)(e.getStore().getState(),Wo.w)&&t.AssetLoader.loadScript(Kl).then(()=>{n(),setInterval(n,3e5)})},"Azure Footprint")},supportedClientHostTypes:lo.a,supportedPageTypes:lo.b,priority:p.a.Normal},{diagnosticName:"Store",boot:(e,t,n)=>{n.subscribe(fs.b,e=>t.DebugSettingsHandler.updateSettings(e)),Object(I.f)()&&(Object(Yl.b)(n),Object(Xl.b)(n)),Object(I.j)(n),Object(M.e)(n),n.dispatch(Object(Y.i)(e.getOrg(),e.getIsLiveId()));const r=Object($n.b)(e.getInitialUrl());var a;r&&n.dispatch(r),n.dispatch(Object(oe.b)()),Object(Kc.e)(n.getState())||((a=n).subscribe(Ys.d,()=>eu(a)),a.subscribe(ic.C,()=>eu(a)),a.subscribe(Zo.r,()=>eu(a)),a.subscribe(()=>Object(zc.b)(a.getState(),Jl.t),()=>eu(a)),n.subscribe(Ys.b,e=>Object(tu.b)(e,t.DataSource.get_ApplicationStatusProvider().isOfflineSyncDone(),n)))},supportedClientHostTypes:lo.a,supportedPageTypes:lo.b,priority:p.a.Normal},{diagnosticName:"Telemetry",boot:(e,t)=>{const n=new bs(t.EventManager);t.TraceManager.addDefaultTransport(n),Object(ys.a)(function(e){return(t,n)=>{const r=n(),a=r.getValue(r.get_sourceKeyIdentifier()),i=e.TraceManager.getTracer(a).getLogLevel(),o=ms.a.fromLegacyLogLevel(t);if(i<o)return;const s=new gs.a(E.r.Name),c=r.getValue(r.get_exceptionMessageKeyIdentifier())||r.get_message();s.addEventParameter(E.g.ComponentName,a),s.addEventParameter(E.r.TraceLevel,ms.a.toString(o)),s.addEventParameter(E.r.CommonError.Message,c),s.addEventParameter(E.r.CommonError.CallStack,r.getValue(r.get_stackTraceKeyIdentifier())),s.addEventParameter(E.b.CommonErrorParameters.ErrorStack,r.getValue(r.get_exceptionStackTraceKeyIdentifier())),e.EventManager.ReportEvent(s)}}(t))},supportedClientHostTypes:lo.a,supportedPageTypes:lo.b,priority:p.a.Normal},{diagnosticName:"ServiceWorker",boot:(e,t,n)=>{const r=t.TraceManager.getTracer("ServiceWorker");if(!navigator.serviceWorker||!("caches"in self))return void r.info("ServiceWorkers or webAPI caches are not supported for current useragent.");navigator.serviceWorker.controller&&wg(navigator.serviceWorker.controller,"Active serviceWorker already registered",t);const a=e.getIsPreload();let i;a&&(n.dispatch(yo(e.getInitialUrl())),i=Object(bo.a)(n.getState(),e.getInitialUrl()),Ng(t,n,r,e.getInitialUrl(),a)),O.a.onNextIdleProcessing(()=>{if(n.getState().preloadServiceWorker){const t=Object(bo.a)(n.getState(),e.getInitialUrl());if(i===t)return}Ng(t,n,r,e.getInitialUrl())})},supportedClientHostTypes:lo.a,supportedPageTypes:lo.b,priority:p.a.Normal},Object(Io.b)(),{diagnosticName:"ScriptSharp",boot:(e,t)=>{window.Microsoft||(window.Microsoft={});const n=Microsoft;n.Crm||(n.Crm={}),n.Crm.Client||(n.Crm.Client={}),n.Crm.Client.Core||(n.Crm.Client.Core={}),n.Crm.Client.Core.Framework||(n.Crm.Client.Core.Framework={}),n.Crm.Client.Core.Framework.UserAgent=jo.a,n.Crm.Client.Core.Framework._Dictionary=Po,n.Crm.Client.Core.Framework.Guid=To.a,n.Crm.Client.Core.Framework.List$1={$$:e=>No},n.Crm.Client.Core.Framework.IList$1={$$:()=>{}},window.CrmEncodeDecode=Ao},supportedClientHostTypes:lo.a,supportedPageTypes:lo.b,priority:p.a.Normal},{diagnosticName:"Router",boot:(e,t,n)=>{t.RestoreStateManager=lh.getInstance(t,n)},supportedClientHostTypes:lo.a,supportedPageTypes:lo.b,priority:p.a.Normal},{diagnosticName:"PalBootstrapper",boot:async(e,t,r)=>{let a;const i=e.getClientHost();let o=null;return i===ls.a.MobileApplication||i===ls.a.MailApp?(o=await n.e(142).then(n.bind(null,"wCe8")),a=new o.NativePlatform(t,r,e.getInAppNavigate())):Object(Es.d)(r.getState())?(o=await Promise.all([n.e(5),n.e(115)]).then(n.bind(null,"fAuA")),a=new o.EmbeddedPlatform(t,r)):(o=await n.e(173).then(n.bind(null,"4QP1")),a=new o.WebPlatform),function(e,t,n,r){t.PlatformContext=new vs(r);const a=r.getPlatformReadyStatus(t,n);return n.dispatch(Object(Dr.g)(e.getClientHost())),a}(e,t,r,a)},supportedClientHostTypes:lo.a,supportedPageTypes:lo.b,priority:p.a.Normal},{diagnosticName:"Router",boot:async(e,t)=>{t.RestoreStateManager.initialize();const n=await t.RestoreStateManager.tryRestorePersistedState();n&&(e.addEventParameter({name:"isRestore",value:n}),O.a.addCommonKpiParameters({[E.b.BootPerformanceParameters.IsStateRestore]:n.toString()}))},supportedClientHostTypes:lo.a,supportedPageTypes:lo.b,priority:p.a.Normal},{diagnosticName:"CheckCookiesDisabledBootTask",boot:(e,t,n)=>{Object(_f.d)()||(t.TraceManager.getTracer("CookiesDisabled").warn("Cookies disabled"),n.dispatch(Object(Fr.f)(!0)))},supportedClientHostTypes:lo.a,supportedPageTypes:lo.b,priority:p.a.Normal},{diagnosticName:"DataSource",boot:(e,t,n)=>{const r=new Jo(t,n),a=rs.a.getInstance(e.getOrgUrl(),r,new es(n,t),n);if(n){const o=t.TraceManager,s=o.getTracer(Uo.TRACER_CATEGORY_ID);a.set_MetadataCache(new Uo(n,s)),o.getTracer("dataSourceLoader").warn("Boot task DataSource started");const c=o.getTracer(Vo.a.TRACER_CATEGORY_ID);Object(ns.b)(new Vo.a(n,c)),as.b.tracer=o.getTracer(as.a);const l=o.getTracer(zo.c.TRACER_CATEGORY_ID),u=Object(ts.a)(n.getState()),d=new zo.c(n,t,u,r,l);a.set_WebAPIService(d),n.dispatch(q(a.get_IsServerAvailable())),a.get_EventManager().add_serverAvailabilityChanged((i=n,(e,t)=>{Object(Ho.f)(i.getState(),Wo.pe)?i.dispatch(Object(W.d)(e,t,t)):(i.dispatch(q(e)),i.dispatch(H(t)))}));const p=n.getState();Object(is.f)(p)&&e.setIsLocalStoreAvailable(!0)}var i;return rs.a.set_DefaultInstance(a),t.DataSource=rs.a.get_DefaultInstance(),os(t,n,e.getIsLocalStoreAvailable())},supportedClientHostTypes:lo.a,supportedPageTypes:lo.b,priority:p.a.Normal},{diagnosticName:"AppLoader",boot:(e,t,n)=>{const r=t.TraceManager.getTracer("AppLoader"),a=e.getShimBootType();let i=e.getBaseUrl().searchParams.get("appid");if(i&&r.info("Getting appid from URL"),i||(i=Object(Zo.k)(n.getState()),i&&r.info("Getting appid from shim state")),i&&!A.a.isNullOrEmpty(A.a.tryParseOrNull(i))){if(e.getClientHost()===ls.a.MobileApplication){const e={};e.appId=i,n.dispatch(Object(cs.a)("LastAccessedApp",e,!1))}n.dispatch(Object(Ot.b)(i)),a.appIdConfigured=!0,a.inAppNavigation=!0,e.setSharedVariable("IsAppDeepLink",!0)}else if(e.getClientHost()===ls.a.MobileApplication)return n.dispatch(Object(ss.a)("LastAccessedApp")).then(e=>{e&&e.appId&&(r.info("Getting appid from sessionstate"),n.dispatch(Object(Ot.b)(e.appId)),a.appIdConfigured=!0)});return Promise.resolve()},supportedClientHostTypes:lo.a,supportedPageTypes:lo.b,priority:p.a.Normal},Object(ds.b)(),{diagnosticName:"InitializeNavigationHandler",boot:(e,t,n)=>{const r=new ig.a(n,t);t.CustomNavigationHandler=r,t.BrowsingContextHandlerFactory=new tg,t.BrowsingContextHandlerFactory.setHandler(0,new ng(n,t)),t.BrowsingContextHandlerFactory.setHandler(1,new ag(n))},supportedClientHostTypes:lo.a,supportedPageTypes:lo.b,priority:p.a.Normal},{diagnosticName:"Router",boot:(e,t,r)=>{const a=[ou.a,gu,mu,Yd.a,Su,ju,wd,Ru,Wu,ud,hl,id,$u,Du.a,Bu,Qd,od.a,fd,bd,vd,Uu.a,Cd,Wd,Xd.a],l=new jd([i,o]);e.getClientHost()===ls.a.MailApp?n.e(134).then(n.bind(null,"5WU+")).then(e=>{l.addDecorator(e)}).catch(e=>{t.TraceManager.getTracer("RouterBootTask").error("Failed to load mail app param decorator",[{name:"ErrorMessage",value:e&&e.toString()}])}):e.getClientHost()===ls.a.MobileApplication?l.addDecorator(s):Object(Es.d)(r.getState())&&l.addDecorator(c);const u=new iu(e.getBaseUrl(),a,ru.a,l),d=jl(t,r,u,e.getClientHost());t.Router=d;const p=Object.assign(Object.assign({},r.currentReducerMap),d.getReducers());r.replaceReducer(Object(w.a)(p)),r.currentReducerMap=p,d.initializeManager(r),t.RestoreStateManager.restoreRouter()},supportedClientHostTypes:lo.a,supportedPageTypes:lo.b,priority:p.a.Normal},{diagnosticName:"InitializeClientApiGlobalStore",boot:(e,t,n)=>{Bl.a.initialize(window,t.EventManager,t.TraceManager)},supportedClientHostTypes:lo.a,supportedPageTypes:lo.b,priority:p.a.Normal},{diagnosticName:"ChannelManager",boot:(e,t,n)=>{t.ChannelManager=new Hp(t.TraceManager.getTracer())},supportedClientHostTypes:lo.a,supportedPageTypes:lo.b,priority:p.a.Normal},{diagnosticName:"RetrieveUserContext",boot:(e,t,n)=>function(e,t,n){return function(e){return e.dispatch(Object(ss.a)("UserId",!0)).then(e=>{let t=A.a.EMPTY;return e&&e.UserId&&(t=A.a.parse(e.UserId)),t})}(n).then(r=>{let a;return n.dispatch(Object(Y.h)(void 0,!1,!1,!0)).then(()=>(a=Object(ps.q)(n.getState()),function(e,t,n,r,a){const i=Object(fs.D)(a.getState());if(i&&n.addEventParameter({name:E.c.AllowLegacyClientExperience,value:i.allowLegacyClientExperience}),e===A.a.EMPTY||e.guid!==t.guid)return r.TraceManager.getTracer("UserValidator").info("User has changed"),n.setSharedVariable("HasUserChanged",!0),r.DataSource.clearAllMetadata(!0).nativePromise().then(()=>{})}(r,a,e,t,n))).then(()=>{if(!r||r.guid!==a.guid){const e={UserId:a.guid};return n.dispatch(Object(cs.a)("UserId",e,!1,!0))}t.EventManager.setTelemetryListeners()}).catch(e=>{throw Object(P.j)(e)&&(e.errorCode=-2147094001),e})})}(e,t,n),supportedClientHostTypes:lo.a,supportedPageTypes:lo.b,priority:p.a.Normal},{diagnosticName:"CheckUnsupportedBrowserBootTask",boot:(e,t)=>{const n=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(){const e=[];return"undefined"==typeof MutationObserver&&e.push("MutationObserver"),"undefined"==typeof requestAnimationFrame&&e.push("requestAnimationFrame"),e.join(",")}();if(Object(Ho.f)(e.getStore().getState(),Wo.Hd)&&jo.a.getInstance().get_IsBrowserIE()&&e.getClientHost()===ls.a.Browser)throw Object(f.d)("Internet Explorer blocked",P.a,[{name:"UserAgent",value:navigator.userAgent}]);if(""!==n)throw Object(f.d)("Unsupported Browser Version",P.c,[{name:"UserAgent",value:navigator.userAgent},{name:"UnsupportedBrowserApi",value:n}])},supportedClientHostTypes:lo.a,supportedPageTypes:lo.b,priority:p.a.Normal},Object(Ag.b)(),{diagnosticName:"InitializeAppHostClient",boot:async(e,t,n)=>{const r=n.getState();Object(Ho.f)(r,Wo.Ab)?Object(Ho.f)(r,Wo.A)?await zg(n,t):zg(n,t):Object(b.b)(()=>zg(n,t),"InitializeAppHostClientBootTask")},supportedClientHostTypes:lo.a,supportedPageTypes:lo.b,priority:p.a.Normal},{diagnosticName:"AppContextLoader",boot:(e,t,n)=>{const r=e.getSharedVariable("IsAppInvalid"),a=e.getSharedVariable("HasUserChanged"),i=e.getSharedVariable("IsAppDeepLink");if(r||a&&!i)nu(t,n);else{const r=Object(Zo.k)(n.getState());if(r)return n.dispatch(Object(St.d)(new A.a(r))).catch(r=>{if(Object(P.h)(r))return nu(t,n),void e.setSharedVariable("IsAppInvalid",!0);throw r})}},supportedClientHostTypes:lo.a,supportedPageTypes:lo.b,priority:p.a.Normal},{diagnosticName:"checkUnsupportedBrowserMultiSessionAppBootTask",boot:(e,t,n)=>{const r=n.getState();if(!Object(tl.b)(r)&&Object(Zo.m)(r)===el.a.MultiSession)throw Object(f.d)("Unsupported Browser For MultiSession App",P.d,[{name:"UserAgent",value:navigator.userAgent}])},supportedClientHostTypes:lo.a,supportedPageTypes:lo.b,priority:p.a.Normal},{diagnosticName:"JQueryDowngradeVersionCheck",boot:(e,t,r)=>{const a=r.getState(),i=Object(Ho.f)(a,Wo.ce),o=Object(fs.D)(a);if(!i||o.areJquery3IncompatibleSolutionsInstalled){const e=[{name:"loadHigherJQueryVersionFcb",value:i},{name:"areJquery3IncompatibleSolutionsInstalled",value:o.areJquery3IncompatibleSolutionsInstalled}];n.e(191).then(n.t.bind(null,"l4gE",7)).then(()=>{t.EventManager.ReportComponentSuccess("JQueryDowngradeVersionCheckLoader",e)}).catch(n=>{t.EventManager.ReportComponentFailure("JQueryDowngradeVersionCheckLoader",n,null,e)})}},supportedClientHostTypes:lo.a,supportedPageTypes:lo.b,priority:p.a.Normal},{diagnosticName:"UpdateHistoryManager",boot:(e,t,n)=>{Object(Jd.c)(n.getState())&&t.Router.setHistoryManager(new Zd(n))},supportedClientHostTypes:[ls.a.Browser.toString(),ls.a.MobileApplication.toString()],supportedPageTypes:lo.b,priority:p.a.Normal},{diagnosticName:"InitializeNavigationHandler",boot:(e,t,n)=>{if(Object(tl.a)(n.getState())===el.a.MultiSession)return Object(eg.b)().then(e=>{Object(Zf.b)(e.XrmAppSessions);const r=new e.MultiSessionNavigationHandler(n,t);t.CustomNavigationHandler=r,t.BrowsingContextHandlerFactory.setHandler(0,new e.TabBrowsingContextHandler(n)),t.SessionTabEventManager=new e.SessionTabEventManager(n,t.EventManager)})},supportedClientHostTypes:lo.a,supportedPageTypes:lo.b,priority:p.a.Normal},{diagnosticName:"PerfToolsOptional",boot:(e,t)=>{Object(I.f)()&&Promise.all([n.e(64),n.e(154)]).then(n.bind(null,"6dVr")).then(({initializePerformanceAutomationScenariosOnBoot:n})=>{n(e.getStore(),t.EventManager.getCurrentSessionId())})},supportedClientHostTypes:lo.a,supportedPageTypes:lo.b,priority:p.a.Normal},Object($f.c)(),{diagnosticName:"MeasuringHandler",boot:(e,t)=>{ip.a.getInstance().setSchedulingFunction(M.d)},supportedClientHostTypes:lo.a,supportedPageTypes:lo.b,priority:p.a.Normal},{diagnosticName:"MutationObserverHandler",boot:(e,t)=>{const n=new Pf;t.MutationObserverHandler=n},supportedClientHostTypes:lo.a,supportedPageTypes:lo.b,priority:p.a.Normal},{diagnosticName:"Accessibility",boot:(e,t,n)=>{const r=new Wf(t,n);t.AccessibilityManager=r},supportedClientHostTypes:lo.a,supportedPageTypes:lo.b,priority:p.a.Normal},{diagnosticName:"UserSettings",boot:(e,t,n)=>{!function(e,t){const n={toastNotification:{toastNotificationDisplaySpeed:lf.a.Normal}};t.dispatch(Object(cf.b)(_s.b)).then(e=>{e?t.dispatch(Object(Jr.c)(e.get_personalization())):t.dispatch(Object(Jr.c)(n))},r=>{e.TraceManager.getTracer("UserAccessibilitySettings").error("Error retrieving UserAccessibility session data from SesstionState: "+r.message),t.dispatch(Object(Jr.c)(n))})}(t,n),function(e){const t=Object(ps.o)(e.getState()),n=t&&t.substr(0,2);document.documentElement.setAttribute("lang",n||"en")}(n)},supportedClientHostTypes:lo.a,supportedPageTypes:lo.b,priority:p.a.Normal},{diagnosticName:"Offline",boot:(e,t,n)=>{Object(mp.d)(t.TraceManager.getTracer(Ep.b));const r=new hp.a(t,n),a=Object(Ho.g)(n.getState(),"MobileClientOfflineAutoOptin"),i=Object(fs.n)(n.getState()),o=r.IsExecAvailable(),s=Object(is.d)(n.getState(),t),c=Object(ts.a)(n.getState()),l=o&&a&&i&&c===ls.a.MobileApplication&&s,u=Object(vp.e)(n.getState());(l&&u||Object(is.e)(n.getState()))&&function(e){e.Router.registerNavigationBeginHandlers((e,t,n)=>-1!==[xu.a,yp.a,_p.b,Eu.a,zd.a,wp.a].indexOf(n)?t(Object(Ip.a)()):Promise.resolve())}(t);const d=Object(Ho.g)(n.getState(),"ForceOfflineLoaderCompletion"),p=[];if(p.push({name:"IsOfflineServiceAvailable",value:o}),p.push({name:"MobileClientOfflineAutoOptinFeature",value:a}),p.push({name:"IsMocaOfflineFeatureEnabledInOrg",value:i}),p.push({name:"IsUserInOfflineEnabledProfile",value:s}),p.push({name:"IsOfflineUsable",value:l}),p.push({name:"IsAppMetadataDownloadInShimEnabled",value:u}),p.push({name:"ForceOfflineLoaderCompletion",value:d}),l||Object(is.e)(n.getState()))return mp.c.warn("offlineLoader:loading offline dependencies",p),Object(bp.a)().then(e=>{if(d)return Ap(e,0,t,n);Ap(e,0,t,n)}).catch(e=>{throw mp.c.error("Offline: loadOfflineDependencies has Failed :"+Object(P.f)(e)),e});mp.c.warn("offlineLoader:skipping loading of offline dependencies",p)},supportedClientHostTypes:[ls.a.Browser.toString(),ls.a.MobileApplication.toString()],supportedPageTypes:lo.b,priority:p.a.Normal},Object(op.b)(),{diagnosticName:"DataSourceFinalizer",boot:async(e,t,n)=>{const r=e.getClientHost()===ls.a.MobileApplication||is.e(n.getState());let a=!1;Object(cp.b)().then(e=>{e.initializeCache(n,t)});const i=Object(Zo.k)(n.getState());if(Object(Ho.f)(n.getState(),Wo.Fe)&&Object(Ys.d)(n.getState())&&i&&(Object(lp.b)(n.getState())||Object(Ho.f)(n.getState(),Wo.De))){let r=e.getOrgUrl()+zo.c.WEB_API_URL_FRAGMENT;r.startsWith("http")||(r=window.location.origin+r),(await Object(cp.b)()).initializeExpressionRuntime(r,n,t)}is.g(n.getState(),e.getBaseUrl())?a=!0:r&&(a=is.c(n.getState()));const o=r&&is.c(n.getState())?t.DataSource.get_IsLocalDataSourceAvailableOffline():t.DataSource.get_IsLocalDataSourceAvailable();navigator.serviceWorker&&navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage({name:up.c,data:{isBrowserOfflineEnabledWithFlag:is.f(n.getState())||!1}});let s=Promise.resolve();const c=t.TraceManager.getTracer("dataSourceFinalizer"),l=t.DataSource.get_IsNetworkAvailable();return c.warn("Boot task DataSourceFinalizer started.currentLocalStoreState = "+o+" : desiredLocalStoreState = "+a+" : isNetworkAvailable = "+l),window.__UCCacheModeEnabled=a,n.dispatch({type:"cache.setcachestatus",payload:{isCacheEnabled:a}}),n.dispatch(H(l)),n.dispatch(Object(W.c)(l)),a!==o&&(c.info("Re-initializing DataSource with cacheMode : "+a),s=os(t,n,a,!0).then(()=>{if(r&&is.c(n.getState())&&!t.DataSource.get_IsLocalDataSourceAvailableOffline())throw c.warn("dataSourceFinalizer : Failed to reinitialize the database, unable to create valid local data source for offline"),sp.a.fromErrorCode(n.getState(),-2147015599)})),Object(Ho.f)(n.getState(),Wo.cb)&&Object(cp.c)().then(r=>{const a=r.MdlProvider.getInstance(e.getOrgUrl(),n,t);r.MdlProvider.setDefaultInstance(a)}),s},supportedClientHostTypes:lo.a,supportedPageTypes:lo.b,priority:p.a.Normal},{diagnosticName:"DeviceSettingsBootstrapper",boot:(e,t,n)=>{const r={};n.dispatch(Object(ss.a)(_s.a)).then(e=>{Ss.forEach(t=>{e&&e[t]?r[t]=function(e,t){const n={featureName:e,isEnabled:t.isEnabled};return"camera"===e&&Object.keys(Os).forEach(e=>{n[e]=t[e]}),n}(t,e[t]):r[t]=Cs(t)}),n.dispatch(qr(r))},e=>{t.TraceManager.getTracer("DeviceSettings").error("Error retrieving deviceSettingInformation session data from SesstionState"),Ss.forEach(e=>{r[e]=Cs(e)}),n.dispatch(qr(r))})},supportedClientHostTypes:lo.a,supportedPageTypes:lo.b,priority:p.a.Normal},function(e=1e3){return{diagnosticName:"DeviceSize",boot:(t,n,r)=>{const a=function(e,t,n){let r=0;function a(){n&&(n.EventManager&&n.EventManager.sendContextEvent(),ip.a.getInstance().scheduleMeasuringUpdate()),r=0,t(zn())}return function(){r||(r=setTimeout(a,e))}}(e,r.dispatch,n);r.dispatch(zn()),window.addEventListener("resize",a)},supportedClientHostTypes:lo.a,supportedPageTypes:lo.b,priority:p.a.Normal}}(),{diagnosticName:"ClientApiManager",boot:(e,t,n)=>{t.ClientApiManager=new Xp(n)},supportedClientHostTypes:lo.a,supportedPageTypes:lo.b,priority:p.a.Normal},{diagnosticName:"ScriptManager",boot:(e,t,n)=>{const r=new ql(t.TraceManager,t,n,document,t.EventManager,t.ClientApiManager);t.ScriptManager=r,r.initializeContainerPool()},supportedClientHostTypes:lo.a,supportedPageTypes:lo.b,priority:p.a.Normal},{diagnosticName:"AddClientApiGlobalFunctions",boot:(e,t,n)=>{const r=window;r.getCurrentXrmStatus=function(){const e="ClientApi.AddClientApiGlobalFunctions.getCurrentXrmStatus";try{Rp.a.instance.reportCall(e);const r=n.getState(),a=Object(Pc.b)(r)||Object(Pc.c)(r),i=function(e,t,n){const r=e.getState();try{const a=t.ClientApiManager.getClientApiEntry(n),i=a.primaryContextToken;let o,s;const c=Object(Mc.p)(r,n);return xp.a.Grid===c?o=e.dispatch(Object(Dp.c)(n,i)):s=e.dispatch(Object(Dp.b)(n,i)),{mainForm:s,mainGrid:o,pageType:c,xrmInstance:a.xrmInstance,clientApiIFrameId:Mp(n)}}catch(e){throw Bl.a.getInstance().eventManager.ReportComponentFailure("ClientApi.InitializeClientApiAction.getXrmStatus",e),e}}(n,t,a);return Rp.a.instance.reportSuccess(e),i}catch(t){throw Fp.a.getInstance().reportFailure(e,t),t}},r.getGlobalContextObject=function(){const e="ClientApi.AddClientApiGlobalFunctions.getGlobalContextObject";try{Rp.a.instance.reportCall(e);const t=n.getState(),r=Object(Pc.b)(t)||Object(Pc.c)(t),a=new Hc.a(n,r);return Rp.a.instance.reportSuccess(e),a}catch(t){throw Fp.a.getInstance().reportFailure(e,t),t}},r.getCurrentXrm=function(){const e="ClientApi.AddClientApiGlobalFunctions.getCurrentXrm";try{Rp.a.instance.reportCall(e);const r=n.getState(),a=Object(Pc.b)(r)||Object(Pc.c)(r),i=t.ClientApiManager.getClientApiEntry(a).xrmInstance;return Rp.a.instance.reportSuccess(e),i}catch(t){throw Fp.a.getInstance().reportFailure(e,t),t}}},supportedClientHostTypes:lo.a,supportedPageTypes:lo.b,priority:p.a.Normal},{diagnosticName:"SetCurrentXrm",boot:(e,t,n)=>{if(window.hasOwnProperty("Xrm"))t.TraceManager.getTracer("ClientApi.SetCurrentXrm.Xrm").warn("Xrm property is already defined on the main UCI Window");else{const e=new kp.b(n,"ClientApi.SetCurrentXrm.");Object.defineProperty(window,"Xrm",{get:()=>e.execute("Xrm",()=>{const e=n.getState(),r=Object(Pc.f)(e);return t.ClientApiManager.getClientApiEntry(r).xrmInstance})})}},supportedClientHostTypes:lo.a,supportedPageTypes:lo.b,priority:p.a.Normal},{diagnosticName:"PreloadImportantDataAndMetadata",boot:(e,t,n)=>{!function(e,t,n){const r={etn:"organization",id:Object(fs.E)(e).organizationId},a=["allowunresolvedpartiesonemailsend","emailconnectionchannel","entityimage","entityimage_url","ismsteamscollaborationenabled","ismsteamsenabled","isnewaddproductexperienceenabled","isplaybookenabled","ispricelistmandatory","isquickcreateenabledforopportunityclose","iswriteinproductsallowed","name","organizationid","orgdborgsettings","qualifyleadadditionaloptions","resolvesimilarunresolvedemailaddress","sendbulkemailinuci","businesscardoptions","ispaienabled"];t(Object(pn.e)(r,a)).catch(e=>{-2147093999!==e.errorCode&&n.error("Preload Retrieval of organization data record failed because: "+Object(P.f)(e))})}(n.getState(),n.dispatch,t.TraceManager.getTracer("RetrieveOrganizationEntity")),async function(e,t){try{const t=Object(Ho.f)(e.getState(),Wo.Ig);!Object(Ho.f)(e.getState(),Wo.Md)&&t&&await e.dispatch(Object(Y.g)())}catch(e){t.warn("[retrieveExtendedUserContext] Retrieve extended user context failed. "+Object(P.f)(e))}}(n,t.TraceManager.getTracer("RetrieveExtendedUserContext"))},supportedClientHostTypes:lo.a,supportedPageTypes:lo.b,priority:p.a.Normal},{diagnosticName:"RTL",boot:(e,t,n)=>{n.subscribe(ps.g,e=>{document.body.dir=e?"rtl":"ltr"})},supportedClientHostTypes:lo.a,supportedPageTypes:lo.b,priority:p.a.Normal},Object(dp.a)(),{diagnosticName:"IncrementalSyncNavigationHandler",boot:(e,t,n)=>{t.Router.registerPostNavigationHandlers((e,t,r)=>{Object(b.b)(()=>{Object(Ys.d)(n.getState())&&t(Object(uf.a)())},"Retrieve metadata version")})},supportedClientHostTypes:lo.a,supportedPageTypes:lo.b,priority:p.a.OnIdle},{diagnosticName:"CheckServerHealthNavigationHandler",boot:(e,t,n)=>{Object(Ho.f)(n.getState(),Wo.pe)&&(t.Router.registerPostNavigationHandlers((e,t,n)=>{Object(b.b)(()=>{const r=[xu.a,yp.a,_p.b,wp.a,su.a];Object(ic.E)(e(),!1)&&Object(Ys.a)(e())&&-1!==r.indexOf(n)&&Object(cp.g)().then(e=>{t(e.checkServerHealth())})},"check server health via ping")}),t.Router.registerNavigationBeginHandlers((e,t,n)=>{const r=[su.a,_p.b,yp.a];return Object(ic.E)(e(),!1)&&Object(Ys.a)(e())&&-1!==r.indexOf(n)&&Object(cp.g)().then(e=>{t(e.checkServerHealth())}),Promise.resolve()}))},supportedClientHostTypes:[ls.a.Browser.toString(),ls.a.MobileApplication.toString()],supportedPageTypes:lo.b,priority:p.a.OnIdle},{diagnosticName:"GlobalCustomEventManager",boot:(e,t,n)=>{t.GlobalCustomEventManager=new zp(t.TraceManager.getTracer(),t.ScriptManager)},supportedClientHostTypes:lo.a,supportedPageTypes:lo.b,priority:p.a.Normal},{diagnosticName:"StorageLoader",boot:(e,t,n)=>{t.RecentItemsSyncManager=new sf(n,t),t.RecentItemsSyncManager.initialize(t.EventManager)},supportedClientHostTypes:lo.a,supportedPageTypes:lo.b,priority:p.a.Normal},{diagnosticName:"CustomControlHelper",boot:(e,t)=>{const n=new ap(e.getStore().getState);var r;r=e.getStore().getState(),Object(np.b)({SELECT_TO_ENTER_DATA:Object(zc.b)(r,"InlineEditControls.SelectToEnter")}),t.CustomControlGlobalHelper=n,Object(tp.c)(t.TraceManager.getTracer("CustomControlFramework")),Object(rp.b)(e.getStore())},supportedClientHostTypes:lo.a,supportedPageTypes:lo.b,priority:p.a.Normal},{diagnosticName:"LoadingStyles",boot:(e,t,n)=>{e.getClientHost()===ls.a.MobileApplication&&jo.a.getInstance().get_IsAndroid()&&t.AssetLoader.loadStylesheet($p,Object(Io.c)())},supportedClientHostTypes:[ls.a.MobileApplication.toString()],supportedPageTypes:lo.b,priority:p.a.Normal},{diagnosticName:"AppCustomizationLoader",boot:(e,t,n)=>{const r=e.getClientHost();Object(Ks.c)(n.getState())||(mc(e.getInitialUrl(),r,t,n),r===ls.a.Browser)||t.TraceManager.getTracer("HostOptions").warn("Host option is not available during HostOptionsBootTask for clientHost: "+r);const a=Object(Ks.b)(n.getState(),"WebResourceName"),i=a&&a.value,o=Object(Zo.e)(n.getState()),s=o&&o.eventHandlers?o.eventHandlers.filter(e=>e.Enabled&&Object(If.a)(e.EventName,"onload")):[],c=s.length>0,l=s.some(e=>e.IsBlocking);if(!i&&!c)return null;const u=Object(kl.a)(),d=t.ScriptManager.initializeContainerForClientApi(u,!1).then(e=>{const r=[];return r.push(function(e,t,n,r){const a=[];let i=0;return r.forEach(r=>{const o={isRestore:e.RestoreStateManager.isStateRestored},s=new Gc(t,null,i++,o,void 0),c=Object(If.b)(n,r.Parameters),l=wf(t.getState(),t.dispatch,n,[r.LibraryName]).then(()=>jf(e,t.getState(),n,r.LibraryName,r.FunctionName,c&&c.length?c:[s],"AppModuleOnLoad",[{name:"IsBlocking",value:r.IsBlocking},{name:"parametersLength",value:c&&c.length}]));r.IsBlocking&&a.push(l)}),Promise.all(a)}(t,n,e,s)),r.push(function(e,t,n,r,a){const i=Object(Ks.b)(t(),"WebResourceName"),o=Object(Ks.b)(t(),"InitFunctionName"),s=i&&i.value,c=o&&o.value;return s?wf(t(),n,r,[s]).then(()=>{if(c){const n=e.ClientApiManager.getClientApiEntry(a).xrmInstance;jf(e,t(),r,s,c,[n],"EmbeddedLoader")}}).then(hc.f):(Object(hc.f)(),Promise.resolve(null))}(t,n.getState,n.dispatch,e,u)),Promise.all(r)});return i||l?d:null},supportedClientHostTypes:lo.a,supportedPageTypes:lo.b,priority:p.a.Normal},{diagnosticName:"BootEmbeddedPreview",boot:(e,t,r)=>{const a=e.getInitialUrl();if(a){const e=t.TraceManager.getTracer(Object(Xf.V)(!1,"previewForm")),i=a.searchParams;if(i.has(ul.c)&&i.has(ul.D)){const a=i.get(ul.c),o=i.get(ul.D);if(a&&o)return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(7),n.e(10),n.e(4),n.e(5),n.e(6),n.e(9),n.e(8),n.e(11),n.e(12),n.e(13),n.e(14),n.e(15),n.e(16),n.e(17),n.e(23),n.e(26),n.e(48)]).then(n.bind(null,"q5Ef")).then(({PreviewSync:n})=>{const i=new n(r,e);t.PreviewSyncChannel=i.initializeChannel(a),t.Router.addGlobalOnPreNavigation(e=>{var t;const n=null===(t=null==e?void 0:e.getEventArgs())||void 0===t?void 0:t._pageInput,a=null==n?void 0:n.pageType;Object(uu.a)().then(e=>r.dispatch(e({pageName:a,inputOrSource:n})))})})}}},supportedClientHostTypes:lo.a,supportedPageTypes:lo.b,priority:p.a.Normal},{diagnosticName:"ModelFormComponentBootTask",boot:(e,t,r)=>{Object(Bg.b)(r),window._getModelFormComponent=()=>Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(7),n.e(10),n.e(4),n.e(5),n.e(6),n.e(9),n.e(8),n.e(11),n.e(12),n.e(13),n.e(14),n.e(15),n.e(16),n.e(17),n.e(19),n.e(23),n.e(28),n.e(37),n.e(43),n.e(138)]).then(n.bind(null,"0N/X")).then(({ModelFormComponent:e})=>(e._store||(e._store=r),e._context||(e._context=t),e))},supportedClientHostTypes:lo.a,supportedPageTypes:[au.a.ENTITY_RECORD.toString()],priority:p.a.Normal},{diagnosticName:"windowEventListenerBootTask",boot:(e,t,n)=>{Object(Ho.f)(n.getState(),Wo.rh)&&!jo.a.getInstance().get_IsBrowserIE()&&(window._UCIWindowListenerCount=0,window._UCIWindowListenerAddedOnPage=0,window._UCIWindowListenerRemovedOnPage=0,EventTarget.prototype.addEventListenerBase=EventTarget.prototype.addEventListener,EventTarget.prototype.addEventListener=function(){this===window&&null!=window._UCIWindowListenerCount&&null!=window._UCIWindowListenerAddedOnPage&&(window._UCIWindowListenerCount++,window._UCIWindowListenerAddedOnPage++),EventTarget.prototype.addEventListenerBase.apply(this,arguments)},EventTarget.prototype.removeListenerBase=EventTarget.prototype.removeEventListener,EventTarget.prototype.removeEventListener=function(){this===window&&null!=window._UCIWindowListenerCount&&null!=window._UCIWindowListenerRemovedOnPage&&(window._UCIWindowListenerCount--,window._UCIWindowListenerRemovedOnPage++),EventTarget.prototype.removeListenerBase.apply(this,arguments)},t.Router.registerPostNavigationHandlers((e,t)=>{Object(b.b)(()=>{t({type:"WindowListenerReportCount",sync:!0,execute(e,t){try{t.TraceManager.getTracer("WindowListenerReportCount").warn("Counts",[{name:"TotalCount",value:window._UCIWindowListenerCount},{name:"AddedCount",value:window._UCIWindowListenerAddedOnPage},{name:"RemovedCount",value:window._UCIWindowListenerRemovedOnPage}])}catch(e){}}}),null!=(null===window||void 0===window?void 0:window._UCIWindowListenerRemovedOnPage)&&(window._UCIWindowListenerRemovedOnPage=0)},"WindowListenerReportCount")}),t.Router.addGlobalOnPreNavigation(()=>{null!=(null===window||void 0===window?void 0:window._UCIWindowListenerAddedOnPage)&&(window._UCIWindowListenerAddedOnPage=0)}))},supportedClientHostTypes:lo.a,supportedPageTypes:lo.b,priority:p.a.Normal},{diagnosticName:"FormatterBootTask",boot:async(e,t,r)=>{const a=await n.e(100).then(n.t.bind(null,"9fy+",7));Object(dh.c)(r,a)},supportedClientHostTypes:lo.a,supportedPageTypes:lo.b,priority:p.a.Normal},{diagnosticName:"CordovaLoader",boot:(e,t,n)=>{const r=jo.a.getInstance().get_IsAndroid()?Yp:jo.a.getInstance().get_IsIOS()?Jp:void 0;r&&t.AssetLoader.loadScript(r)},supportedClientHostTypes:[ls.a.MobileApplication.toString()],supportedPageTypes:lo.b,priority:p.a.Normal},l,{diagnosticName:"codeCacheStatusCheck",boot:(e,t,n)=>{if(Object(bo.a)(n.getState(),e.getInitialUrl())&&window.navigator.serviceWorker)return window.navigator.serviceWorker.controller&&"activated"===navigator.serviceWorker.controller.state&&(n.dispatch(Ha(3)),t.EventManager.ReportComponentSuccess("codeCacheStatusCheck.SW.InitialState.Idle",e.getEventParameters())),void navigator.serviceWorker.addEventListener("controllerchange",r=>{n.dispatch(Ha(3)),t.EventManager.ReportComponentSuccess("codeCacheStatusCheck.SW.InitialState.FirstInstallActivate",e.getEventParameters())});if(window.applicationCache&&e.getClientHost()===ls.a.MobileApplication){const r=Object(Ys.c)(n.getState());return new Promise((a,i)=>{if(window.applicationCache.status===window.applicationCache.IDLE||window.applicationCache.status===window.applicationCache.UPDATEREADY)return t.EventManager.ReportComponentSuccess("appCacheEventsCheck.Ready.State."+window.applicationCache.status,e.getEventParameters()),n.dispatch(Ha(3)),void a();t.EventManager.ReportComponentSuccess("appCacheEventsCheck.Waiting.State."+window.applicationCache.status,e.getEventParameters()),["noupdate","cached","updateready","error","obsolete"].forEach(o=>window.applicationCache.addEventListener(o,()=>{window.applicationCache.status===window.applicationCache.IDLE||window.applicationCache.status===window.applicationCache.UPDATEREADY?(n.dispatch(Ha(3)),t.EventManager.ReportComponentSuccess("appCacheEventsCheck.Ready.State."+window.applicationCache.status,e.getEventParameters()),r||a()):(t.EventManager.ReportComponentSuccess("appCacheEventsCheck.Waiting.State."+window.applicationCache.status,e.getEventParameters()),r||i(Object(f.d)("Application cache could not initialize for offline usage, go back online and allow the cache to fully initialize before trying again.")))})),r&&a()})}},supportedClientHostTypes:lo.a,supportedPageTypes:lo.b,priority:p.a.Normal},{diagnosticName:"RelevanceSearch",boot:(e,t,n)=>{n.dispatch(Object(qg.b)())},supportedClientHostTypes:lo.a,supportedPageTypes:[au.a.SEARCH.toString()],priority:p.a.Normal},Object(df.b)(),{diagnosticName:"InitializeTimeoutBootTask",boot:(e,t,n)=>{e.getClientHost()!==ls.a.Browser||Object(Kc.c)(n.getState())||(function(e,t){if(Object(Ho.f)(e.getStore().getState(),Wo.wh)){const n=(new Date).toISOString().replace(/[^0-9]/g,"").slice(0,-3);new bf(e.getStore(),t).start(Number(n))}}(e,t),Object(Kc.e)(e.getStore().getState())||function(e,t){const n=[];if(Object(Ho.f)(e.getStore().getState(),Wo.vh)){const r=new Of(e.getStore(),t);r.isEligible()&&n.push(r)}n.length&&vf(n)}(e,t))},supportedClientHostTypes:[ls.a.Browser.toString()],supportedPageTypes:lo.b,priority:p.a.Normal},{diagnosticName:"InvalidAppHandler",boot:(e,t,n)=>{t.TraceManager.getTracer("InvalidAppHandler").debug("InvalidAppHandler started."),e.getSharedVariable("IsAppInvalid")&&(e.removeSharedVariable("IsAppInvalid"),Object(Yf.a)(n))},supportedClientHostTypes:lo.a,supportedPageTypes:lo.b,priority:p.a.Normal},Object(Jf.b)(),{diagnosticName:"BootNotificationTask",boot:(e,t,n)=>{!function(e,t,n){const r=[],a=Object(ts.a)(n.getState());if(a===ls.a.Browser)r.push(sg,cg,lg,pg,gg,hg,yg,mg);else if(a===ls.a.MobileApplication)for(const e of[_g({playerName:"FieldServiceMobileApp",storeLink:"https://play.google.com/store/apps/details?id=com.microsoft.crm.crmphone.fieldServices",platform:"Android",fcbName:Wo.cc,trainVersion:21093,versionExceptions:[]}),_g({playerName:"Dynamics365MobileApp",storeLink:"https://play.google.com/store/apps/details?id=com.microsoft.crm.crmphone",fcbName:Wo.cc,platform:"Android",trainVersion:21093,versionExceptions:["4.3.19122","4.3.20043"]}),_g({playerName:"PowerAppsMobileApp",storeLink:"https://play.google.com/store/apps/details?id=com.microsoft.msapps",platform:"Android",fcbName:Wo.cc,trainVersion:21093,versionExceptions:["3.21091","3.20065"]})])r.push(e(t.EventManager));n.dispatch(Object(Fe.e)(Jl.g)).then(()=>{for(const t of r)if(t.isValid(e,n)){const r={id:t.id,type:1,level:t.level,message:Object(zc.b)(n.getState(),t.messageId),title:null,action:{actionLabel:Object(zc.b)(n.getState(),t.buttonLabelId),eventHandler:()=>{t.onAction?n.dispatch(t.onAction(e)):n.dispatch(Object(fg.a)(t.getActionUrl(e)))}},onCloseHandler:null,showCloseButton:!1!==t.allowDismiss};n.dispatch(Object(ka.b)(r))}})}(e,t,n)},supportedClientHostTypes:lo.a,supportedPageTypes:lo.b,priority:p.a.OnIdle},{diagnosticName:"DelayLoadComponents",boot:(e,t,n)=>{n.dispatch(Object(Vg.a)()).then(()=>{n.dispatch(Object(Ug.b)(!0))}),n.dispatch(Object(Ug.a)(!0))},supportedClientHostTypes:lo.a,supportedPageTypes:lo.b,priority:p.a.OnIdle},{diagnosticName:"ShimPerformanceMetrics",boot:(e,t,n)=>{const r=t.TraceManager.getTracer("ShimPerformanceMetrics"),a=fp.a.get_Instance();a.add_onReadyOrNow(()=>{const t=a.get_application().get_applicationState().get_ShimPerformanceMetrics(),n={},i=e.getShimBootType().getShimBootTypeString();n[E.b.ShimBootParameters.ShimBootType]=i,O.a.addCommonKpiParameters(n),Object(pp.a)(n,t,r)})},supportedClientHostTypes:[ls.a.MobileApplication.toString(),ls.a.MailApp.toString()],supportedPageTypes:lo.b,priority:p.a.Normal},{diagnosticName:"LoadImportantMetadataBootTask",boot:(e,t,n)=>{const r={};r[Gf.Ub]=[],r[Gf.Wb]=[],Object(Kf.f)(n.getState())&&(r[Qf.a]=[]),n.dispatch(Object(Ee.e)(r)).catch(e=>{const n=[{name:"functionName",value:"retrieveEntities"},{name:"entities",value:JSON.stringify(r)}];t.EventManager.ReportComponentFailure("Boot.Tasks.LoadImportantMetadataBootTask",e,null,n)})},supportedClientHostTypes:lo.a,supportedPageTypes:lo.b,priority:p.a.OnIdle},{diagnosticName:"cdnEndpointValidation",boot:(e,t)=>{const n=window.__public_path__,r=window.__cdn_public_path__;let a="";if("/uclient/"===n?void 0!==r&&(a=r):a=n,a.length>0){const e=new XMLHttpRequest;e.onreadystatechange=function(){if(4===e.readyState){const r=[],i="ClientCdnEndpointValidation";if(r.push({name:"CdnEndpoint",value:a}),r.push({name:"CdnEndpointUsed",value:n}),r.push({name:"Status",value:e.status}),e.status>=200&&e.status<304)t.EventManager.ReportComponentSuccess(i,r);else{const e="Primary CDN Endpoint Cannot Be Reached From Current Client";t.TraceManager.getTracer(i).warn(e,r)}}},e.open("GET",a+"uci_cdn_connection_check?version="+window.VERSION_NUMERIC_VALUE,!0),e.timeout=3e4,e.send()}},supportedClientHostTypes:lo.a,supportedPageTypes:lo.b,priority:p.a.OnIdle},{diagnosticName:"ActivityManager",boot:(e,t,n)=>{const r=new us;t.ActivityManager=r,t.RecentItemsSyncManager.addOnFocusHandler()},supportedClientHostTypes:lo.a,supportedPageTypes:lo.b,priority:p.a.OnIdle},Object(Hg.b)(),{diagnosticName:"SitemapIconValidation",boot:async(e,t,r)=>{if(Object(fh.a)()){const{validateSitemapIcons:e}=await n.e(166).then(n.bind(null,"Kn/H"));r.dispatch(e())}},supportedClientHostTypes:lo.a,supportedPageTypes:lo.b,priority:p.a.OnIdle},{diagnosticName:"detectUnexpectedTermination",boot:(e,t,n)=>{if(Object(Ho.f)(n.getState(),Wo.sb)){const e=t.TraceManager.getTracer("detectUnexpectedTermination");try{const n=t.EventManager.getCurrentSessionId(),r=sessionStorage.getItem("UNEXPECTED_TERMINATION");r?e.warn("Page terminated unexpectedly",[{name:"PreviousSessionId",value:r}]):sessionStorage.setItem("UNEXPECTED_TERMINATION",null!=n?n:A.a.EMPTYGUIDSTRING),window.addEventListener("pagehide",gh)}catch(t){e.warn("Error determining unexpected termination")}}},supportedClientHostTypes:[ls.a.Browser.toString()],supportedPageTypes:lo.b,priority:p.a.Normal}],mh=[912559,P.c,P.a,P.b,2147951393,2147951394,2147951395,2147951396,2147951397,2147951398,2147779907,2147787024,-2147015420,-2147093999,-2147155696];class bh{constructor(e){this._bcd=e,this._applicationContext={}}boot(){const e=window.ApplicationCodeExecuteStart;e&&O.a.addKeyPerformanceIndicator("ApplicationCodeExecuteStart",{},e),O.a.addKeyPerformanceIndicator("ApplicationBootStart");const t=v.a.trackWork("Boot");try{y(hh,this._bcd,this._applicationContext).then(()=>{t()}).then(()=>{this._handleSuccess()}).catch(e=>{t(),this._handleError(0,e,this._bcd.getStore())})}catch(e){this._handleError(0,e,this._bcd.getStore())}}_handleError(e,t,n){var r;if(console.error(t.stack||t),!function(e,t){if(!e.errorCode)return!1;if(mh.indexOf(e.errorCode)>-1)return!0;const n=e;return Object(sp.g)(n)?t!==ls.a.MobileApplication||!n.containsErrorCode(-2147220960):2147873354===n.errorCode}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(t,this._bcd.getClientHost())?this._applicationContext&&this._applicationContext.EventManager&&this._applicationContext.EventManager.ReportComponentFailure("Boot.Start",t):(this._bcd.addEventParameter({name:E.c.Error,value:JSON.stringify(t)}),this._handleSuccess()),Object(P.k)(t.errorCode)&&this._bcd.getClientHost()===ls.a.Browser){const e=t.errorCode.toString(16);window.location.assign(`/_common/error/errorhandler.aspx?ErrorCode=${e}&BackUri=${encodeURIComponent(document.location.href)}`)}else{if(this._applicationContext&&n&&!t.suppressErrorDialog){const r=new C.a(this._applicationContext,n);r.isOperationAvailable("bootError")?r.bootError(e,t):this._renderErrorPage(t,n)}null===(r=this._applicationContext.RestoreStateManager)||void 0===r||r.handleBootError(),this._handleApplicationCacheEvents()}}_handleSuccess(){if(this._applicationContext&&this._applicationContext.EventManager){const e=this._bcd.getEventParameters();this._applicationContext.EventManager.ReportComponentSuccess("Boot.Start",e),this._applicationContext.RestoreStateManager.handleBootSuccess()}this._handleApplicationCacheEvents()}_renderErrorPage(e,t){if(!this._applicationContext.ErrorService)throw e;{const n=this._applicationContext.EventManager.getCurrentSessionId();this._applicationContext.ErrorService.createErrorPopup(e,{sessionId:n},t)}}_handleApplicationCacheEvents(){this._bcd.getClientHost()===ls.a.MobileApplication&&(this._logApplicationCacheEvents(),this._subscribeToApplicationCacheEvents())}_subscribeToApplicationCacheEvents(){window.addEventListener("applicationCacheBlock",this._logApplicationCacheEvents.bind(this))}_logApplicationCacheEvents(){const e=window.navigator.onLine;if(localStorage.getItem("AppCacheEvent")&&this._applicationContext.EventManager){const t=this._applicationContext.TraceManager.getTracer("ApplicationCache"),n=JSON.parse(localStorage.getItem("AppCacheEvent"));for(let r=0;r<n.length;r++){const a=JSON.parse(n[r]),i=a[a.length-1].type,o=[{name:"blockType",value:i},{name:"cacheEventBlocks",value:n[r]}];"cached"===i||"updateready"===i||"noupdate"===i?this._applicationContext.EventManager.ReportComponentSuccess("ApplicationCache",o):"error"!==i&&"obsolete"!==i||(e?this._applicationContext.EventManager.ReportComponentFailure("ApplicationCache",o):t.warn("Application cache did not download new changes as network is not available.",o))}localStorage.setItem("AppCacheEvent","")}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class yh{constructor(e,t,n){this._appIdConfigured=e,this._autoSignIn=t,this._inAppNavigation=n}set appIdConfigured(e){this._appIdConfigured=e}set autoSignIn(e){this._autoSignIn=e}set inAppNavigation(e){this._inAppNavigation=e}getShimBootTypeString(){return JSON.stringify({appIdConfigured:this._appIdConfigured,autoSignIn:this._autoSignIn,inAppNavigation:this._inAppNavigation})}}var _h=n("3bZx");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class vh{constructor(e,t,n,r,a,i,o,s,c,l){this._initialUrl=e,this._baseUrl=t,this._setOrgUrl(n),this._org=r,this._setIsLiveId(a),this._setClientHost(s),this.setIsLocalStoreAvailable(o),this._setInAppNavigate(c),this._setIsPreload(l),this._shimBootType=new yh(!1,!1,!1),this._sharedVariables=new _h.a,this._eventParameters=[]}getIsLocalStoreAvailable(){return this._isLocalStoreAvailable}setIsLocalStoreAvailable(e){this._isLocalStoreAvailable=e}getBaseUrl(){return this._baseUrl}getInitialUrl(){return this._initialUrl}setInitialUrl(e){this._initialUrl=e}getOrgUrl(){return this._orgUrl}getOrg(){return this._org}getStore(){return this._store}setStore(e){this._store=e}_setOrgUrl(e){this._orgUrl=e}getIsLiveId(){return this._isLiveId}_setIsLiveId(e){this._isLiveId=e}getClientHost(){return this._clientHost}_setClientHost(e){this._clientHost=e}getInAppNavigate(){return this._inAppNavigate}_setInAppNavigate(e){this._inAppNavigate=e}getIsPreload(){return this._isPreload}_setIsPreload(e){this._isPreload=e}getShimBootType(){return this._shimBootType}setSharedVariable(e,t){this._sharedVariables.setItem(e,t)}getSharedVariable(e){return this._sharedVariables.getItem(e)}removeSharedVariable(e){this._sharedVariables.removeItem(e)}addEventParameter(e){this._eventParameters.push(e)}getEventParameters(){return this._eventParameters}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let Sh=r;Sh=a;const Oh=["app","appId","appid","cache","clienthost","cmdbar","channelId","defaulttracelevel","entityId","flags","forceUCI","isOverviewAboutTabInExpandedViewEnabled","liveid","LivePersonaCardVersionOverride","lpcstikkontakt","midgardTestEndpoint","midgardTestId","MidgardVersion","monitor","navbar","org",m.u,"ribbondebug","telemetry","testmode","useLocal","hostCorrelationId","verboseLog","forceClientCdn","skipMobileRedirect","useSecondaryCdnEndpoint"];function Ch(e){const t=new URL(e,window.location.origin),n=t.searchParams.get("org")||window.__preload&&window.__preload.org,r=!!t.searchParams.get("liveid")||!(!window.__preload||!window.__preload.isLiveId),a=!!t.searchParams.get("skipSetupCookie"),i=!!t.searchParams.get("inAppNavigate"),o=!!Object($n.c)(t.searchParams.get("preload")),s=Eh(t);let c=s===ls.a.MobileApplication;const l=function(e,t){const n=new URL(e,window.location.origin);n.search="";for(const e of Oh)t.searchParams.has(e)&&n.searchParams.set(e,t.searchParams.get(e));t.searchParams.has("newWindow")&&n.searchParams.set("newWindow",t.searchParams.get("newWindow"));return n.hash="",n}(e,t),u=function(e,t,n){let r=e.protocol+"//"+e.host;n||(r="/"+t);return r}(t,n,r);return new vh(t,l,u,n,r,a,c,s,i,o)}function Eh(e){let t=ls.a.Browser;const n=parseInt(e.searchParams.get("clienthost"),10);return isNaN(n)?"nga"===e.pathname.split("/")[1]&&(t=ls.a.MobileApplication):t=n,t}!function(){const e=["checking","noupdate","cached","updateready","obsolete","progress","downloading","error"];let t;if(window.applicationCache&&Eh(new URL(window.location.href,window.location.origin))===ls.a.MobileApplication){try{t=JSON.parse(localStorage.getItem("AppCacheEvent"))||[]}catch(e){t=[]}e.forEach((function(e){window.applicationCache.addEventListener(e,r,!1)}))}let n=[];function r(e){let r;if(r="checking"===e.type?{type:e.type,timeStamp:e.timeStamp,currentTimeStamp:Date.now(),url:window.location.href,cacheStatus:window.applicationCache.status}:{type:e.type,timeStamp:e.timeStamp,cacheStatus:window.applicationCache.status},n.push(r),"cached"===e.type||"updateready"===e.type||"noupdate"===e.type||"error"===e.type||"obsolete"===e.type){t.push(JSON.stringify(n)),localStorage.setItem("AppCacheEvent",JSON.stringify(t)),n=[];const e=document.createEvent("HTMLEvents");e.initEvent("applicationCacheBlock",!0,!0),document.dispatchEvent(e)}}}(),Object(hc.e)(),setTimeout(()=>{var e;e=Ch(window.location.href),new bh(e).boot()},0)},DPfD:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e){return e&&e.externalContext?e.externalContext.availableContexts:null}function a(e,t,n){if(e&&e.externalContext&&e.externalContext.knownProperties&&e.externalContext.knownProperties[t])return e.externalContext.knownProperties[t][n]}function i(e,t,n){return e&&e.externalContext&&e.externalContext.propertyListeners&&e.externalContext.propertyListeners[t]&&e.externalContext.propertyListeners[t][n]?e.externalContext.propertyListeners[t][n]:null}n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return i}))},"DS+G":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("uu/V"),a=n("ai6P");class i extends r.a{constructor(e,t,n,r){super(e,t,n,r),this._userContext=null,this.get_success()&&(this._userContext=Object(a.a)(this.get_response()))}get_userContext(){return this._userContext}}},"Dea/":function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.Create=2]="Create",e[e.Update=3]="Update"}(r||(r={}))},DijY:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.crud=0]="crud",e[e.nonCrud=1]="nonCrud",e[e.changeProcessAndStage=2]="changeProcessAndStage",e[e.transaction=3]="transaction"}(r||(r={}))},Div0:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.actions=1]="actions",e[e.core=30]="core",e[e.framework=51]="framework",e[e.indexedDb=60]="indexedDb",e[e.PAL=81]="PAL",e[e.sql=109]="sql",e[e.sqlBatch=110]="sqlBatch",e[e.sqlDbTransactionAdapter=111]="sqlDbTransactionAdapter",e[e.sqlDbTransactionAdapterV2=112]="sqlDbTransactionAdapterV2",e[e.taskRunner=119]="taskRunner",e[e.authentication=159]="authentication",e[e.telemetry=164]="telemetry",e[e.quickFind=168]="quickFind",e[e.storage=1005]="storage",e[e.xmlNodeFactory=1006]="xmlNodeFactory",e[e.dataSource=1007]="dataSource",e[e.localDataSource=1008]="localDataSource",e[e.crmServerDataSource=1009]="crmServerDataSource",e[e.scheduler=1025]="scheduler",e[e.offlineDataStore=1031]="offlineDataStore",e[e.offlineMetadataSync=1032]="offlineMetadataSync",e[e.offlineUpSync=1035]="offlineUpSync"}(r||(r={}))},DsuF:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"d",(function(){return o}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="appnotification";var a,i,o;!function(e){e[e.Normal=2e8]="Normal",e[e.High=200000001]="High"}(a||(a={})),function(e){e[e.Info=1e8]="Info",e[e.Success=100000001]="Success",e[e.Error=100000002]="Error",e[e.Warning=100000003]="Warning",e[e.Mention=100000004]="Mention",e[e.Custom=100000005]="Custom"}(i||(i={})),function(e){e[e.Timed=2e8]="Timed",e[e.Hidden=200000001]="Hidden"}(o||(o={}))},"E+70":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.addNotificationListener=function(e){this.listeners.push(e)},e.removeNotificationListener=function(e){for(var t=this.listeners.indexOf(e);t>-1;)this.listeners.splice(t,1),t=this.listeners.indexOf(e)},e.eventsSent=function(e){for(var t=this,n=function(n){r.listeners[n].eventsSent&&setTimeout((function(){return t.listeners[n].eventsSent(e)}),0)},r=this,a=0;a<this.listeners.length;++a)n(a)},e.eventsDropped=function(e,t){for(var n=this,r=function(r){a.listeners[r].eventsDropped&&setTimeout((function(){return n.listeners[r].eventsDropped(e,t)}),0)},a=this,i=0;i<this.listeners.length;++i)r(i)},e.eventsRetrying=function(e){for(var t=this,n=function(n){r.listeners[n].eventsRetrying&&setTimeout((function(){return t.listeners[n].eventsRetrying(e)}),0)},r=this,a=0;a<this.listeners.length;++a)n(a)},e.eventsRejected=function(e,t){for(var n=this,r=function(r){a.listeners[r].eventsRejected&&setTimeout((function(){return n.listeners[r].eventsRejected(e,t)}),0)},a=this,i=0;i<this.listeners.length;++i)r(i)},e.listeners=[],e}();t.default=r},"E+Gg":function(e,t,n){"use strict";n.d(t,"a",(function(){return y})),n.d(t,"d",(function(){return _})),n.d(t,"e",(function(){return v})),n.d(t,"c",(function(){return S})),n.d(t,"g",(function(){return C})),n.d(t,"f",(function(){return E})),n.d(t,"b",(function(){return I}));var r=n("w1eR"),a=n("eOoD"),i=n("3/02"),o=n("Lyxw"),s=n("504W"),c=n("4leG"),l=n("sclX"),u=n("GYEz"),d=n("LzVy"),p=n("AckI"),f=n("ORLm"),g=n("E5IU"),h=n("NjDY"),m=n("H4dV"),b=n("IqkD");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function y(e,t){return!(!Array.isArray(e)||!Array.isArray(t))&&(e&&e.every((e,n)=>t[n]&&e===t[n]))}function _(e){return Object(o.e)(e,i.kg,i.kf)}function v(e){return!(_(e)||!function(e){return Object(h.r)(e)}(e))}function S(e){const t=Object(b.x)(e);return function(e){if(v(e))return!1;const t=Object(d.a)(e),n=m.a.getInstance();return Object(h.q)(e)&&(t===l.b.Web||_(e)&&t===l.b.Native&&n.get_IsWindows()&&!n.get_isWinPhone()&&!n.get_isMailApp())&&Object(o.e)(e,i.ff,i.jf)&&(Object(o.e)(e,i.ud,i.o)||Object(h.o)(e))&&Object(f.a)(e)}(e)&&O(t,e)}function O(e,t){return 0===e.defaultSearchExperience||Object(o.e)(t,i.ud,i.o)&&3!==e.defaultSearchExperience}function C(e){return(S(e)||Object(h.q)(e)&&Object(o.f)(e,i.kf))&&Object(o.e)(e,i.ud,i.o)}function E(e){var t;return S(e)&&(!Object(s.a)(null===(t=Object(g.d)(e))||void 0===t?void 0:t.appId)||Object(c.b)(e))}function I(e,t){return!v(e)&&Object(d.a)(e)===l.b.Native&&Object(h.q)(e)&&O(Object(b.x)(e),e)&&Object(p.b)(e,t)&&Object(u.e)(e)===a.a.Phone&&Object(u.a)(e)===r.a.MobileApplication&&Object(o.e)(e,i.Oc,i.o)}},E3i9:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e,t){return e&&e.metadata&&e.metadata.lookup&&e.metadata.lookup.hasOwnProperty(t)?e.metadata.lookup[t]:null}function a(e,t,n){const a=r(e,t);return a&&a.hasOwnProperty(n)?a[n]:null}function i(e,t,n){const r=a(e,t,n);return r&&r.view?r.view:null}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return i}))},E3kc:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n("LbMF");const a="dialog.attribute.optionsets.update";function i(e,t,n){const i=Object(r.l)(e,t),o={};i&&n.forEach(e=>{const t=e.AttributeName;t&&i[t]&&(o[t]=Object.assign(Object.assign({},i[t]),{OptionSet:Object.assign([],i[t].OptionSet,e.Options)}))});const s={};return s[t]=o,{type:a,payload:{attributes:s},meta:{dialogIdentifier:t}}}},E5IU:function(e,t,n){"use strict";n.d(t,"e",(function(){return o})),n.d(t,"d",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return l})),n.d(t,"k",(function(){return p})),n.d(t,"l",(function(){return f})),n.d(t,"n",(function(){return b})),n.d(t,"o",(function(){return y})),n.d(t,"g",(function(){return u})),n.d(t,"p",(function(){return d})),n.d(t,"j",(function(){return _})),n.d(t,"m",(function(){return v})),n.d(t,"a",(function(){return i})),n.d(t,"q",(function(){return h})),n.d(t,"r",(function(){return O})),n.d(t,"i",(function(){return S})),n.d(t,"f",(function(){return g})),n.d(t,"h",(function(){return m}));var r=n("Lyxw"),a=n("3/02");const i="d365custom";function o(e){return e&&e.metadata&&e.metadata.appContext?e.metadata.appContext:null}function s(e){const t=o(e);return t&&t.app?t.app:null}function c(e){const t=s(e);return t?t.appComponents:null}function l(e,t){const n=s(e),r=n?n.components:null,a=[];if(r&&r.length&&r.length>0)for(const e of r)e.Type===t&&a.push(e.Id);return a}function u(e){const t=o(e);return t&&t.webResource?t.webResource:null}function d(e){const t=o(e);return t&&t.welcomePage?t.welcomePage:null}function p(e){const t=s(e);return t&&t.appId?t.appId:null}function f(e){const t=s(e);return t&&t.title?t.title:null}function g(e){const t=p(e),n=t?e.metadata.appModulesList.appList.find(e=>e.id===t):null;return n?n.appElements:[]}function h(e,t){return!Object(r.f)(e,a.l)||g(e).some(e=>e.objectName===t)}function m(e){var t;return null===(t=g(e))||void 0===t?void 0:t.filter(e=>1===e.canvasAppType)}function b(e){const t=s(e);return t&&t.uniqueName?t.uniqueName:null}function y(e){const t=s(e);return t&&t.uniqueName?t.uniqueName:e&&e.configuration&&e.configuration.isD365DefaultApp?i:"__ unavailable__"}function _(e){const t=s(e);return t&&t.clientType?t.clientType:null}function v(e){const t=s(e);return t&&Number.isInteger(t.navigationType)?t.navigationType:null}function S(e,t){var n,r;const a=s(t);return void 0===(null===(r=null===(n=null==a?void 0:a.appSettings)||void 0===n?void 0:n[e])||void 0===r?void 0:r.value)?null:a.appSettings[e].value}function O(e){return!1===S("ServerMode",e)&&Object(r.f)(e,a.mf)}},E7fB:function(e,t,n){"use strict";n.d(t,"a",(function(){return D}));var r=n("ABCl"),a=n("IqkD"),i=n("SAYH"),o=n("69Qu"),s=n("GYEz"),c=n("eOoD"),l=n("16wZ"),u=n("qshH"),d=n("ZIjf");let p;class f{constructor(e){p=e}getClient(){const e="ClientApi.XrmPageContextClient.getClient";try{let t;d.a.instance.reportCall(e);const n=Object(s.k)(p.getState());switch(n){case"Mobile":t="Mobile";break;case"Outlook":t="Outlook";break;case"Web":t="Web";break;case"UnifiedServiceDesk":t="UnifiedServiceDesk";break;default:const r=[];r.push({name:"clientName",value:n}),u.a.getInstance().reportFailure(e,new Error("Unknown client"),null,r)}return d.a.instance.reportSuccess(e),t}catch(t){throw u.a.getInstance().reportFailure(e,t),t}}getClientState(){const e="ClientApi.XrmPageContextClient.getClientState";try{d.a.instance.reportCall(e);const t=Object(o.c)(p.getState())?"Online":"Offline";return d.a.instance.reportSuccess(e),t}catch(t){throw u.a.getInstance().reportFailure(e,t),t}}getFormFactor(){const e="ClientApi.XrmPageContextClient.getFormFactor";try{d.a.instance.reportCall(e);const t=this.getClient();let n;if("Web"===t||"UnifiedServiceDesk"===t)n=1;else{const t=Object(s.e)(p.getState());switch(t){case c.a.Phone:n=3;break;case c.a.Tablet:n=2;break;default:Object(l.h)(e,"ClientHostSubtype",t)}}return d.a.instance.reportSuccess(e),n}catch(t){throw u.a.getInstance().reportFailure(e,t),t}}isOffline(){const e="ClientApi.XrmPageContextClient.isOffline";try{d.a.instance.reportCall(e);const t=!Object(o.c)(p.getState());return d.a.instance.reportSuccess(e),t}catch(t){throw u.a.getInstance().reportFailure(e,t),t}}isNetworkAvailable(){const e="ClientApi.XrmPageContextClient.isNetworkAvailable";try{d.a.instance.reportCall(e);const t=Object(o.b)(p.getState());return d.a.instance.reportSuccess(e),t}catch(t){throw u.a.getInstance().reportFailure(e,t),t}}}var g=n("arV0"),h=n("NvOS"),m=n("xkcG"),b=n("Axoi"),y=n("NjDY"),_=n("E5IU"),v=n("YxC/"),S=n("EY5k");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class O{getMetadata(){return{boundParameter:null,operationName:"SaveSettingValue",operationType:0,parameterTypes:{AppUniqueName:{typeName:"Edm.String",structuralProperty:1},SettingName:{typeName:"Edm.String",structuralProperty:1},Value:{typeName:"Edm.String",structuralProperty:1},SolutionUniqueName:{typeName:"Edm.String",structuralProperty:1}}}}}var C=n("KeJu"),E=n("xmKQ"),I=n("aRLb"),w=n("zsAz"),j=n("hBJV");function P(e,t,n,r){return{type:"settings.saveSettingValue.async",async execute(a,o){try{await async function(e,t,n,r,a){const i=new O;i.AppUniqueName=r,i.SettingName=t,i.SolutionUniqueName=a,i.Value=n.toString(),await e.dispatch(Object(I.b)(i))}(a,e,t,n,r);const o=Object(_.k)(a.getState());if(!o)throw"Unable to retrieve app module id from app state.";await a.dispatch(Object(j.a)()),a.dispatch(Object(E.b)(null)),await a.dispatch(Object(C.d)(new i.a(o)))}catch(e){const t=Object(w.d)("Error in saving setting value",2415919107);throw t.innerError=e,o.EventManager.ReportComponentFailure("Settings.SaveSettingValue.failure",t),t}},getFailureParameters:(e,t)=>[{name:"Settings.SaveSettingValue.Error",value:e},{name:"Settings.SaveSettingValue.Failure",value:t}]}}var T=n("IaGr"),N=n("3yqi"),A=n("i1f0");let R;class D{constructor(e,t){R=e,this._pageId=t,this._clientApiExecutor=new r.b(R,"ClientApi.XrmGlobalContext.")}get client(){const e="ClientApi.XrmGlobalContext.client";try{return d.a.instance.reportCall(e),this._client||(this._client=new f(R)),d.a.instance.reportSuccess(e),this._client}catch(t){throw u.a.getInstance().reportFailure(e,t),t}}get userSettings(){const e="ClientApi.XrmGlobalContext.userSettings";try{return d.a.instance.reportCall(e),this._userSettings||(this._userSettings=new m.a(R)),d.a.instance.reportSuccess(e),this._userSettings}catch(t){throw u.a.getInstance().reportFailure(e,t),t}}get organizationSettings(){const e="ClientApi.XrmGlobalContext.organizationSettings";try{return d.a.instance.reportCall(e),this._organizationSettings||(this._organizationSettings=new b.a(R)),d.a.instance.reportSuccess(e),this._organizationSettings}catch(t){throw u.a.getInstance().reportFailure(e,t),t}}getAdvancedConfigSetting(e){const t="ClientApi.XrmGlobalContext.getAdvancedConfigSetting";try{d.a.instance.reportCall(t);const n=Object(y.D)(R.getState());let r=null;switch(e){case"MaxChildIncidentNumber":r=n.maxChildIncidentNumber;break;case"MaxIncidentMergeNumber":r=n.maxIncidentMergeNumber;break;case"MicrosoftFlowEnvironmentId":r=n.microsoftFlowEnvironmentId;break;case"MicrosoftFlowDestinationUrl":r=n.microsoftFlowDestinationUrl;break;case"MicrosoftFlowFirstPartyIntegrationSiteUrl":r=n.microsoftFlowFirstPartyIntegrationSiteUrl;break;case"IsMicrosoftFlowEnabled":r=n.isMicrosoftFlowEnabled;break;default:const a=[];return a.push({name:"setting",value:e}),u.a.getInstance().reportFailure(t,new Error("Not supported by advanced config settings"),null,a),null}return d.a.instance.reportSuccess(t),r}catch(e){throw u.a.getInstance().reportFailure(t,e),e}}getClientUrl(){const e="ClientApi.XrmGlobalContext.getClientUrl";try{d.a.instance.reportCall(e);const t=window.location.origin+Object(h.a)(R.getState(),"");return d.a.instance.reportSuccess(e),t}catch(t){throw u.a.getInstance().reportFailure(e,t),t}}getWebResourceUrl(e){return this._clientApiExecutor.execute("getWebResourceUrl",()=>Object(y.x)(R.getState())+e,[{name:"name",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"string"}])}getCurrentTheme(){return d.a.instance.reportUsage("ClientApi.XrmGlobalContext.getCurrentTheme"),"default"}getIsAutoSaveEnabled(){const e="ClientApi.XrmGlobalContext.getIsAutoSaveEnabled";try{d.a.instance.reportCall(e);const t=Object(A.ad)(R.getState());return d.a.instance.reportSuccess(e),t}catch(t){throw u.a.getInstance().reportFailure(e,t),t}}getAppointmentRichEditorExperience(){const e="ClientApi.XrmGlobalContext.getAppointmentRichEditorExperience";try{d.a.instance.reportCall(e);const t=this.organizationSettings.appointmentRichEditorExperience;return d.a.instance.reportSuccess(e),t}catch(t){throw u.a.getInstance().reportFailure(e,t),t}}getOrgLcid(){const e="ClientApi.XrmGlobalContext.getOrgLcid";try{d.a.instance.reportCall(e);const t=this.organizationSettings.languageId;return d.a.instance.reportSuccess(e),t}catch(t){throw u.a.getInstance().reportFailure(e,t),t}}getOrgUniqueName(){const e="ClientApi.XrmGlobalContext.getOrgUniqueName";try{d.a.instance.reportCall(e);const t=this.organizationSettings.uniqueName;return d.a.instance.reportSuccess(e),t}catch(t){throw u.a.getInstance().reportFailure(e,t),t}}getQueryStringParameters(){return this._clientApiExecutor.execute("getQueryStringParameters",(e,t)=>{let n={};if(!this._pageId)return T.a.getInstance().traceManager.getTracer(e+".pageId").error("Missing pageId",t),n;const r=Object(g.p)(R.getState(),this._pageId);t.push({name:"pageType",value:r});const a=Object(g.j)(R.getState(),this._pageId);if(!a)return T.a.getInstance().traceManager.getTracer(e+".pageInput").warn("Page input was not defined",t),n;if(r===N.a.Grid){const e=a;e.viewId&&(n.viewId=e.viewId.toString()),e.viewType&&(n.viewType=e.viewType.toString())}else{const e=a;e.data&&(n=e.data),e.entityTypeName&&(n.entityTypeName=e.entityTypeName),e.id&&(n.id=i.a.externalGuid(e.id)),e.formId&&(n.formId=i.a.externalGuid(e.formId)),e.pageType&&(n.pageType=e.pageType),e.recordSetQueryKey&&(n.recordSetQueryKey=i.a.externalGuid(i.a.fromExternalGuid(e.recordSetQueryKey.split(":",1)[0].substring(e.recordSetQueryKey.split(":",1)[0].indexOf("-")+1)))),e.processId&&(n.process=e.processId),e.processInstanceId&&(n.processinstanceid=e.processInstanceId),e.selectedStageId&&(n.selectedstageid=e.selectedStageId),e.isCrossEntityNavigate&&(n.isCrossEntityNavigate=e.isCrossEntityNavigate.toString())}return n})}getTimeZoneOffsetMinutes(){const e="ClientApi.XrmGlobalContext.getTimeZoneOffsetMinutes";try{d.a.instance.reportCall(e);const t=this.userSettings.getTimeZoneOffsetMinutes();return d.a.instance.reportSuccess(e),t}catch(t){throw u.a.getInstance().reportFailure(e,t),t}}getUserId(){const e="ClientApi.XrmGlobalContext.getUserId";try{d.a.instance.reportCall(e);const t=this.userSettings.userId;return d.a.instance.reportSuccess(e),t}catch(t){throw u.a.getInstance().reportFailure(e,t),t}}getUserLcid(){const e="ClientApi.XrmGlobalContext.getUserLcid";try{d.a.instance.reportCall(e);const t=this.userSettings.languageId;return d.a.instance.reportSuccess(e),t}catch(t){throw u.a.getInstance().reportFailure(e,t),t}}getUserName(){const e="ClientApi.XrmGlobalContext.getUserName";try{d.a.instance.reportCall(e);const t=this.userSettings.userName;return d.a.instance.reportSuccess(e),t}catch(t){throw u.a.getInstance().reportFailure(e,t),t}}getUserRoles(){const e="ClientApi.XrmGlobalContext.getUserRoles";try{d.a.instance.reportCall(e);const t=this.userSettings.securityRoles;return d.a.instance.reportSuccess(e),t}catch(t){throw u.a.getInstance().reportFailure(e,t),t}}getUserRolePrivileges(){const e="ClientApi.XrmGlobalContext.getUserRolePrivileges";try{d.a.instance.reportCall(e);const t=this.userSettings.securityRolePrivileges;return d.a.instance.reportSuccess(e),t}catch(t){throw u.a.getInstance().reportFailure(e,t),t}}prependOrgName(e){const t="ClientApi.XrmGlobalContext.prependOrgName";try{d.a.instance.reportCall(t);const n=Object(h.a)(R.getState(),e);return d.a.instance.reportSuccess(t),n}catch(e){throw u.a.getInstance().reportFailure(t,e),e}}isOnPremises(){const e="ClientApi.XrmGlobalContext.isOnPremises";try{d.a.instance.reportCall(e);const t=Object(a.x)(R.getState()),n=t&&!t.isLive;return d.a.instance.reportSuccess(e),n}catch(t){throw u.a.getInstance().reportFailure(e,t),t}}getVersion(){const e="ClientApi.XrmGlobalContext.getVersion";try{d.a.instance.reportCall(e);const t=Object(y.E)(R.getState()).serverVersion;return d.a.instance.reportSuccess(e),t}catch(t){throw u.a.getInstance().reportFailure(e,t),t}}getCurrentAppUrl(){const e="ClientApi.XrmGlobalContext.getCurrentAppUrl";try{d.a.instance.reportCall(e);let t=null;if("Mobile"!==this.client.getClient()){let e=this.getClientUrl();const n=Object(_.k)(R.getState());null!==n&&(e=e+"/main.aspx?appid="+n),t=e}return d.a.instance.reportSuccess(e),t}catch(t){throw u.a.getInstance().reportFailure(e,t),t}}getCurrentAppName(){return this._clientApiExecutor.executeAsync("getCurrentAppName",(e,t)=>{const n=Object(_.l)(R.getState());if(null!==n)return Promise.resolve(n);const r=Object(y.D)(R.getState());if(null==r?void 0:r.defaultCrmCustomName)return Promise.resolve(r.defaultCrmCustomName);this._clientApiExecutor.reportFailure(e,new Error("App Name is null"),t);const a=["AppModule.APIError"];return R.dispatch(Object(S.e)(a)).then(()=>{throw{errorCode:2147746581,message:Object(v.b)(R.getState(),"AppModule.APIError"),code:2147746581}})})}getCurrentAppProperties(){const e="ClientApi.XrmGlobalContext.getCurrentAppProperties";try{d.a.instance.reportCall(e);const t={};t.appId=Object(_.k)(R.getState()),t.displayName=Object(_.l)(R.getState());const n=Object(_.d)(R.getState());n&&(t.uniqueName=n.uniqueName,t.url=n.appUrl);const r=Object(_.g)(R.getState());r&&(t.webResourceId=r.guid,t.webResourceName=r.name);const a=Object(_.p)(R.getState());return a&&(t.welcomePageId=a.guid,t.welcomePageName=a.name),d.a.instance.reportSuccess(e),Promise.resolve(t)}catch(t){return Object(l.d)(R,t,e)}}getCurrentAppSettings(){const e="ClientApi.XrmGlobalContext.getCurrentAppSettings";try{d.a.instance.reportCall(e);const t={},n=Object(_.d)(R.getState());if(null==n?void 0:n.appSettings){const e=n.appSettings;for(const n in e)t[n]=e[n].value}return d.a.instance.reportSuccess(e),t}catch(t){throw u.a.getInstance().reportFailure(e,t),t}}getCurrentAppSetting(e){return this._clientApiExecutor.execute("getCurrentAppSetting",()=>{var t,n;const r=Object(_.d)(R.getState()),a=null===(n=null===(t=null==r?void 0:r.appSettings)||void 0===t?void 0:t[e])||void 0===n?void 0:n.value,i=[];return i.push({name:"settingName",value:e},{name:"value",value:a}),T.a.getInstance().eventManager.ReportComponentSuccess("ClientApi.XrmGlobalContext.getCurrentAppSetting",i),a},[{name:"settingName",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"string"}])}saveSettingValue(e,t,n){return this._clientApiExecutor.executeAsync("saveSettingValue",()=>{var r;const a=2===(null==n?void 0:n.overrideScope)?null===(r=Object(_.d)(R.getState()))||void 0===r?void 0:r.uniqueName:null,i=R.dispatch(P(e,t,a,null==n?void 0:n.solutionUniqueName)),o=[];return o.push({name:"settingName",value:e},{name:"value",value:t}),a&&o.push({name:"appUniqueName",value:a}),n&&o.push({name:"saveSettingsOptions",value:JSON.stringify(n)}),T.a.getInstance().eventManager.ReportComponentSuccess("ClientApi.XrmGlobalContext.saveSettingValue",o),i},[{name:"settingName",value:e,isRequired:!0,expectedDataType:"string"},{name:"value",value:t,isRequired:!0}])}getFeatureControlSetting(e,t){return this._clientApiExecutor.execute("getFeatureControlSetting",()=>{var n;const r=null===(n=function(e,t,n){var r;return null===(r=e.featureControlSettings[t])||void 0===r?void 0:r[n]}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(R.getState(),e,t))||void 0===n?void 0:n.value,a=[];return a.push({name:"namespaceValue",value:e},{name:"featureName",value:t},{name:"value",value:r}),T.a.getInstance().eventManager.ReportComponentSuccess("ClientApi.XrmGlobalContext.getFeatureControlSetting",a),r},[{name:"featureName",value:t,isRequired:!0,expectedDataType:"string"},{name:"namespaceValue",value:e,isRequired:!0,expectedDataType:"string"}])}}},E8F2:function(e,t,n){"use strict";n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return u})),n.d(t,"a",(function(){return h})),n.d(t,"e",(function(){return m})),n.d(t,"g",(function(){return y})),n.d(t,"f",(function(){return S})),n.d(t,"i",(function(){return b})),n.d(t,"h",(function(){return O})),n.d(t,"b",(function(){return C}));var r=n("ngeo"),a=n("i1f0"),i=n("Uv1Y"),o=n("pF61");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const s={[2147747079..toString()]:"Account loop being created violation encountered.",[2147746611..toString()]:"Duplicate records found violation encountered.",[2147746405..toString()]:"Isv aborted violation encountered.",[2147746340..toString()]:"Isv unexpected violation encountered.",[2147749377..toString()]:"Metadata no mapping violation encountered.",[-2147220969..toString()]:"A record with a provided id does not exist",[2147746327..toString()]:"A record with a provided id does not exist",[2147746353..toString()]:"Principal privilege denied violation encountered.",[2147746342..toString()]:"Read privilege violation encountered.",[2147757834..toString()]:"Team not assigned roles violation encountered.",[2147779334..toString()]:"Not enough privilege to access the Microsoft Dynamics 365 object or perform the requested operation.",[22e8.toString()]:"Create privilege violation encountered.",[2200000001..toString()]:"Non-UCI entity detected.",[2200000002..toString()]:"Read-only entity detected.",[2200000003..toString()]:"Saving in progress violation detected.",[2200000004..toString()]:"Saving a read-only form violation detected.",[2200000005..toString()]:"Cannot save due to PreventDefault encountered.",[2200000006..toString()]:"Cannot save due to no dirty changes.",[2200000007..toString()]:"Cannot save due to invalid form.",[2200000009..toString()]:"Invalid Form parameters",[2200000016..toString()]:"Unsupported action",[2200000017..toString()]:"The record you are trying to access does not have a form to display. Please contact your administrator for assistance.",[2200000018..toString()]:"An unexpected script error occurred. Please contact your administrator for further information.",[2200000019..toString()]:"This is a system entity that does not have a main form. Opening a record form for this entity is not supported."},c=/Could not find a property named '(.*)' on type '.*'/;function l(e,t){if(e&&s[e.toString()]){let n=s[e.toString()];return t&&t.length>0&&(n=String.format(n,t)),n}throw new Error("FormErrorCode: can't return error message for an invalid error code: "+e)}function u(e){const t="0x"+r.a.getHexErrorCodeFromInt(e);return["Error_Title_"+t,"Error_Message_"+t]}function d(e){return e&&null!=e.errorCode&&(2147746405===e.errorCode||2147746340===e.errorCode)}function p(e,t){d(e)&&t.push({name:"IsIsvViolation",value:!0})}function f(e){return e&&null!=e.errorCode&&(2147746342===e.errorCode||22e8===e.errorCode||2147757834===e.errorCode||2147746353===e.errorCode||2147779334===e.errorCode)}function g(e,t){f(e)&&t.push({name:"IsPermissionsError",value:!0})}function h(e,t){p(e,t),g(e,t),function(e,t){2147750146===e.errorCode&&t.push({name:"IsNoEntityError",value:!0})}(e,t)}function m(e){return null!=e&&(null!=e.reason&&2147746611===e.reason.errorCode||null!=e.errorCode&&2147746611===e.errorCode)}function b(e,t){if(e&&"boolean"==typeof e.blockErrorReporting){const n=e.blockErrorReporting;return e.blockErrorReporting=t,n}return null}function y(e){return null!=e&&(2200000004===e.errorCode||2200000005===e.errorCode||2200000006===e.errorCode||2200000007===e.errorCode||2200000019===e.errorCode)}function _(e){return m(e)||y(e)}function v(e,t,n,r){const o=n;return Object(i.g)(o)?{success:!0,message:"Authentication or permissions error occurred"}:2200000003===n.errorCode||2147747079===n.errorCode||2200000001===n.errorCode||2147746327===n.errorCode||-2147220969===n.errorCode||2147750146===n.errorCode||2200000002===n.errorCode&&Object(a.kd)(e,t)?{success:!0,message:s[n.errorCode.toString()]}:d(n)?(r&&p(n,r),{success:!0,message:"Isv violation occurred. Check EventContext for errorCode.",componentNamePrefix:"IsvViolation."}):f(n)?(r&&g(n,r),{success:!0,message:"Permissions error occurred. Check EventContext for errorCode."}):S(e,t,n)?{success:!0,message:"Fast navigation error occured."}:function(e){if(!e||!e.message)return!1;return null!=c.exec(e.message)}(n)?(r&&function(e,t){if(!e||!e.message)return;const n=c.exec(e.message);n&&t.push({name:"AttributeName",value:n[1]})}(n,r),{success:!0,message:"Deprecated attribute error occured."}):-2147093999===(null==n?void 0:n.errorCode)?{success:!0,message:"Failed to fetch is caused by unstable network and is not SLA impacting error."}:{success:!1}}function S(e,t,n){return n&&2200000008===n.errorCode||Object(o.m)(e,t)}function O(e,t,n,r,a,i){if(n){if(!_(n)){const o=v(e,t,n,r);o.success?(b(n,!0),a.TraceManager.getTracer(o.componentNamePrefix+i).warn(o.message,r)):a.EventManager.ReportComponentFailure(i,n,"Look at correlated traces via ActivityId or UserId around the TimeCreated",r)}}else a.EventManager.ReportComponentFailure(i,n,"Look at correlated traces via ActivityId or UserId around the TimeCreated",r)}function C(e,t,n,r,a,o){const s={errorCode:n},c=_(s)||v(e,t,s,null).success;return new i.a(null!=r?r:l(n),n,void 0,void 0,void 0,void 0,void 0,void 0,a,o,void 0,c)}},EAYf:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class r{constructor(e,t,n=[]){this._serviceName=e,this._operationName=t,this._parameters=n}getServiceName(){return this._serviceName}getOperationName(){return this._operationName}getParameters(){return this._parameters}}},EBJu:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * The unique name of the QuickCreateForm page module.
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="QuickCreateForm"},EDOo:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return i}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="ReadOnly",a="MenuItem_Label_AddObject",i=[r,a]},EHQq:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("5yoC");class a extends r.a{constructor(e,t,n,r,a,i,o,s){super(),this._currentEntityId=null,this._currentEntityLogicalName=null,this._nextEntityId=null,this._nextEntityLogicalName=null,this._newActiveStageId=null,this._newTraversedPath=null,this._processId=null,this._processInstanceId=null,this._currentEntityId=e,this._currentEntityLogicalName=t,this._nextEntityId=n,this._nextEntityLogicalName=r,this._newActiveStageId=a,this._newTraversedPath=i,this._processId=o,this._processInstanceId=s}get_name(){return"NavigateToNextEntity"}get_currentEntityId(){return this._currentEntityId}get_currentEntityLogicalName(){return this._currentEntityLogicalName}get_nextEntityId(){return this._nextEntityId}get_nextEntityLogicalName(){return this._nextEntityLogicalName}get_newActiveStageId(){return this._newActiveStageId}get_newTraversedPath(){return this._newTraversedPath}get_processId(){return this._processId}get_processInstanceId(){return this._processInstanceId}}},EU8S:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return o}));var r=n("SAYH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e){if(!e||0===e.length)return null;const t={};for(const n of e){const e={id:r.a.tryParse(n.Id),displayName:n.DisplayName,isEnabledForMobileClient:n.IsEnabledForMobileClient,name:n.Name,type:n.Type,content:n.Content,solutionName:n.SolutionName,solutionVersion:n.SolutionVersion,publisherName:n.PublisherName,versionNumber:n.VersionNumber,OverallVersionNumber:n.OverallVersionNumber};t[n.Id]=e}return t}function i(e){if(!e)return null;const t={};return e.CustomControls&&function(e,t){for(const n of e.CustomControls){const e=n.WebResourceStrings;if(e)for(const n in e){const r=e[n];t[n]={name:n,type:12..toString(),contentJson:"string"==typeof r?JSON.parse(r):r}}}}(e,t),e.WebResources&&function(e,t){for(const n in e.WebResources){const a=e.WebResources[n];if(a.Name){const e={id:r.a.tryParse(a.Id),displayName:a.DisplayName,isEnabledForMobileClient:a.IsEnabledForMobileClient,name:a.Name,type:a.Type,content:a.Content,contentJson:"string"==typeof a.ContentJson?JSON.parse(a.ContentJson):a.ContentJson,solutionName:a.SolutionName,solutionVersion:a.SolutionVersion,publisherName:a.PublisherName,dependency:a.Dependency,versionNumber:a.VersionNumber,OverallVersionNumber:a.OverallVersionNumber};t[a.Name]=e}}}(e,t),t}function o(e){let t;switch(e){case"6":t="image/jpeg";break;case"7":t="image/gif";break;case"10":t="image/vnd.microsoft.icon";break;case"11":t="image/svg+xml";break;case"5":default:t="image/png"}return"data:"+t+";base64,"}},EUSs:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return d}));var r,a=n("mMyr"),i=n("huli"),o=n("kXuq"),s=n("9lTt"),c=(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),l="openedPopups",u={position:"absolute",top:0,left:0,width:"100%",height:"100%"},d=function(e){function t(t){var n=e.call(this,t)||this;return n._rootBodyElement=null,n._seeMorePopupCount=null,n._rootBodyElement=t.rootBodyElement||document.body,n}return c(t,e),t.prototype._getPopupId=function(){return(this.props.parentCustomControlId?this.props.parentCustomControlId+"|":"")+this.props.id+"_popupContainer"},t.prototype._initializeRootNode=function(){this._rootNode||(this._rootNode=document.createElement("section"),this._rootNode.id=this._getPopupId(),Object.assign(this._rootNode.style,{position:"absolute",top:"0",left:"0",width:"100%",height:"100%"}),this._rootNode.setAttribute(l,""),this._rootBodyElement.appendChild(this._rootNode))},t.prototype._getChildrenWithProps=function(e){var t=this;return e?e.map?e.map((function(e){return a.cloneElement(e,{rootPopupId:t._getPopupId(),rootBodyElement:t._rootBodyElement})})):a.cloneElement(e,{rootPopupId:this._getPopupId(),rootBodyElement:this._rootBodyElement}):null},t.prototype._renderToBody=function(){null===this._seeMorePopupCount&&(this._seeMorePopupCount=s.a.getInstance().getPopupCount());var e=this.props.customZIndex||1,t=this.props.customZIndex||this._seeMorePopupCount>0,n=this.props.style?this.props.style:u;this._style||(this._style=t?Object.assign({zIndex:e},n):n),this._initializeRootNode()},t.prototype.componentWillReceiveProps=function(e){e.style!==this.props.style&&(this._style=null)},t.prototype.componentDidMount=function(){this.props.openPopup&&this.props.openPopup(this._getPopupId())},t.prototype.componentWillUnmount=function(){document.getElementById(this._rootNode.id)&&this._rootBodyElement.removeChild(this._rootNode),this.props.closePopup&&this.props.closePopup(this._getPopupId()),this._rootNode=null},t.prototype.render=function(){return this._renderToBody(),this.props.children?i.createPortal(a.createElement(o.a,{style:this._style,tabIndex:this.props.tabIndex},this._getChildrenWithProps(this.props.children)),this._rootNode):null},t}(a.Component)},EW4s:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class r{constructor(e){if(this._resolved=!1,this._rejected=!1,this._nativePromiseRejectionSuppressed=!1,e){this._wrappedPromise=e;const t=this._wrappedPromise;"function"==typeof t.isFulfilled&&t.isFulfilled()?(this._resolved=!0,this._resolvedValue=t.value()):"function"==typeof t.isRejected&&t.isRejected()&&(this._rejected=!0,this._rejectedError=t.reason())}else this._wrappedPromise=new Promise((e,t)=>{this._nativeResolve=e,this._nativeReject=t})}isPending(){return!this._resolved&&!this._rejected}allArray(e){const t=e.map(e=>"function"==typeof e.nativePromise?e.nativePromise():e);return new r(Promise.all(t))}always(e){return this._resolved?(e(this._resolvedValue),this):this._rejected?(e(this._rejectedError),this._suppressNativePromiseRejection(),this):(this._wrappedPromise.then(e,e),this)}done(e){return this._rejected?this:this._resolved?(e(this._resolvedValue),this):(this._wrappedPromise.then(e),this)}catch(e){return this._resolved?this:this._rejected?(e(this._rejectedError),this._suppressNativePromiseRejection(),this):(this._wrappedPromise.then(void 0,e),this)}fail(e){return this.catch(e)}then(e,t){if(this._resolved)return e(this._resolvedValue),this;if(this._rejected)return t&&(t(this._rejectedError),this._suppressNativePromiseRejection()),this;const n=this._wrappedPromise.then(e,t);return new r(n)}nativePromise(){return this._wrappedPromise}reject(e){return this.isPending()?(this._rejected=!0,this._rejectedError=e,this._nativeReject(e),this):this}resolve(e){return this.isPending()?(this._resolved=!0,this._resolvedValue=e,this._nativeResolve(e),this):this}_suppressNativePromiseRejection(){this._nativePromiseRejectionSuppressed||(this._nativePromiseRejectionSuppressed=!0,this._wrappedPromise.catch(e=>{}))}}},EXEJ:function(e,t,n){"use strict";var r=n("RNUx");function a(){}function i(){}i.resetWarningCache=a,e.exports=function(){function e(e,t,n,a,i,o){if(o!==r){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var n={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:i,resetWarningCache:a};return n.PropTypes=n,n}},EY5k:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"b",(function(){return p})),n.d(t,"e",(function(){return _})),n.d(t,"g",(function(){return b})),n.d(t,"d",(function(){return y})),n.d(t,"f",(function(){return v}));var r=n("eXjw"),a=n("K7RF"),i=n("Uv1Y"),o=n("YxC/"),s=n("y6/h"),c=n("iJGp"),l=n("eq9I");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const u="resourcestring.retrieve",d="resourcestring.update.missing",p="set.resource.strings";let f=null,g=null,h=null,m=null;function b(){null===f&&(f=[],g=new Promise((e,t)=>{h=e,m=t}))}function y(e){const t=f;f=null,e(_(t)).then(()=>{h(),h=null,g=null},e=>{m(e),m=null,g=null})}function _(e){return{type:"resourcestring.retrieve.async",execute({dispatch:t,getState:n},p){if(null!==f&&null!==g)return f.push(...e),g;let h=e;const m=n(),b=Object(o.f)(m,e);if(b){h=e.filter(e=>{const t=b[e];return null==t});const t=Object(o.a)(m);t&&t.length>0&&(h=h.filter(e=>-1===t.indexOf(e)))}return h.length>0?(t(function(e){const t=Object(o.g)(e)?r.a.Refreshing:r.a.Initializing;return{type:u,payload:{resourceStrings:{initialized:t}}}}(m)),t(function(e){return{type:u,execute({dispatch:t,getState:n},r){const o=Object(a.b)("resourcestring",null,null,null,!1,c.a.OnDemandWithoutContext,null,null,e,null);return t(o).then(r=>{let a=[];if(r&&r.resourceStrings){const n=r.resourceStrings.strings;n&&(a=Object.keys(n)),r.resourceStrings.missingStringIds=e.filter(e=>-1===a.indexOf(e)),t({type:d,payload:r})}Object(s.c)(n())}).catch(t=>{e.filter(e=>void 0===l.f.x).length>0&&Object(i.b)(t)})}}}(h))):Promise.resolve()}}}function v(){const e=Object(s.b)(),t={resourceStrings:{initialized:r.a.Initialized,strings:e&&e.strings,missingStringIds:e&&e.missingStrings}};return{type:p,payload:t}}},EbwQ:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n("Yb4o"),a=n("nA3O");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class i extends a.a{}var o=n("XjOj"),s=n("Div0"),c=n("NMtn");class l extends r.a{constructor(e){super(),this._bridge=null,this._available=!1,this._defaultDispatcherState=new i,this._bridge=e}get_dispatcherPerfDataLoggingEnabled(){return!1}get_IsAvailable(){return this._available}set_IsAvailable(e){return this._available=e,e}get_state(){return this._defaultDispatcherState}get_version(){return this._bridge.get_version()}setState(e){Object(c.b)(e,"state"),this.set_IsAvailable(!0),this.get_state().setValues(e)}changeState(e,t){Object(c.c)(e,"name");const n=this.get_state().getSchema();for(let r=0;r<n.get_count();r++){const a=n.get_item(r);if(a.get_name()===e){const n={};Object(o.f)(s.a.PAL,"Changing state, {0}",e),n[a.get_name()]=t;const r=a.get_jsonConverter().read(n,a),i=a.coerceToPropertyType(r);return this.get_state().setValue(a,i),!0}}return!1}raiseEvent(e,t){Object(c.c)(e,"name"),Object(o.f)(s.a.PAL,"Raising event, {0}",e),this.handleCustomEvent(e,t)}getFormattedPerfData(e,t){return String.format(":{0}:{1}",e,t)}callNativeMethod(e,t){if(!this.get_IsAvailable())throw Error.invalidOperation("Trying to call native method "+t.get_methodName()+" before dispatcher is available");this._bridge.callNativeMethod(this,e,t)}}},Eh65:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.High=0]="High",e[e.Low=1]="Low"}(r||(r={}))},EkzE:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return c}));var r=n("D4rv"),a=n("SAYH"),i=n("W1cF"),o=n("RMPf");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const s={lastSearchText:"",currentSuggestText:"",suggestions:[],suggestionsRetrievalPending:!1,displayTeachingBubble:null,isExpanded:!1,availableWidth:0,indexReady:!1,initiateRelevanceSearch:!1,filterFacetKeysStack:[],filters:{},relevanceSearchNavigationCache:{entityList:[],topResultEntities:new Set,selectedEntity:"",resultListScrollIndex:-1,filtersCache:{}},isRelevanceSearchFiltersPanelCollapsed:null};function c(e=s,t){switch(t.type){case i.c:const{lastSearchText:n}=t.payload;if(n!==e.lastSearchText)return Object.freeze(Object.assign(Object.assign({},e),{lastSearchText:n}));break;case i.h:const s=new Map;t.payload.suggestions.forEach(e=>{const t=e.document,{"@search.entityname":n,"@search.objectid":i,"@search.objecttypecode":o,entityimage_url:c}=t,l=Object(r.d)(t,["@search.entityname","@search.objectid","@search.objecttypecode","entityimage_url"]);s.has(n)||s.set(n,[]),s.get(n).push({suggestionInfo:{crmHitText:e.text,entityImageUrl:c,entityName:n,objectId:new a.a(i),objectTypeCode:o},record:l})});const c=Array.from(s.values()).reduce((e,t)=>e.concat(t),[]);return Object.freeze(Object.assign(Object.assign({},e),{suggestions:c,suggestionsRetrievalPending:!1}));case o.a:return Object.freeze(Object.assign(Object.assign({},e),{indexReady:!0}));case i.e:const{displayTeachingBubble:l}=t.payload;return Object.freeze(Object.assign(Object.assign({},e),{displayTeachingBubble:l}));case i.b:const{currentSuggestText:u}=t.payload;if(u!==e.currentSuggestText)return Object.freeze(Object.assign(Object.assign({},e),{currentSuggestText:u}));break;case i.i:return Object.freeze(Object.assign(Object.assign({},e),{suggestionsRetrievalPending:!0}));case i.g:const{isExpanded:d}=t.payload;return Object.freeze(Object.assign(Object.assign({},e),{isExpanded:d}));case i.m:const{relevanceSearchNavigationCache:p}=t.payload;return Object.freeze(Object.assign(Object.assign({},e),{relevanceSearchNavigationCache:p}));case i.f:const{initiateRelevanceSearch:f}=t.payload;return Object.freeze(Object.assign(Object.assign({},e),{initiateRelevanceSearch:f}));case i.k:const{filterFacetKeysStack:g}=t.payload;return Object.freeze(Object.assign(Object.assign({},e),{filterFacetKeysStack:g}));case i.l:const{filters:h}=t.payload;return Object.freeze(Object.assign(Object.assign({},e),{filters:h}));case i.d:const{availableWidth:m}=t.payload;return Object.freeze(Object.assign(Object.assign({},e),{availableWidth:m}));case i.j:const{isRelevanceSearchFiltersPanelCollapsed:b}=t.payload;return Object.freeze(Object.assign(Object.assign({},e),{isRelevanceSearchFiltersPanelCollapsed:b}))}return e}},"Eq/9":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="plg.updatePluginState";function a(e,t){return{type:r,payload:{name:e,state:t}}}},Eqw3:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r,a=n("QEBF"),i=n("hGVc"),o=n("ghc6"),s=n("8aze"),c=(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return c(t,e),t.prototype._handleSelected=function(e){this.props.onSelected&&this.props.onSelected(e)},t.prototype.componentWillReceiveProps=function(e){e.isSelected&&e.isSelected!==this.props.isSelected&&this._handleSelected(this)},t.prototype.getElementName=function(){return"li"},t.prototype.getElementProps=function(){var e;return(e={})[i.y]=this.props.isSelected,e["data-text"]=this.props.dataText,e["data-value"]=this.props.dataValue,e["data-expanded"]=this.props.dataExpanded,e},t.displayName="ListItem",t}(a.a);function u(e){return e&&e.style?e.isSelected&&e.selectedStyle?Object.assign({},Object.assign({},e.style,e.selectedStyle),Object(s.a)(e)):Object.assign(e.style,Object(s.a)(e)):{}}var d=o.a((function(e){return{rule:u(e)}}))(l)},Er26:function(e,t,n){"use strict";n.d(t,"h",(function(){return r})),n.d(t,"r",(function(){return a})),n.d(t,"t",(function(){return i})),n.d(t,"k",(function(){return s})),n.d(t,"o",(function(){return c})),n.d(t,"p",(function(){return l})),n.d(t,"f",(function(){return u})),n.d(t,"g",(function(){return d})),n.d(t,"c",(function(){return p})),n.d(t,"e",(function(){return f})),n.d(t,"j",(function(){return g})),n.d(t,"b",(function(){return h})),n.d(t,"a",(function(){return m})),n.d(t,"v",(function(){return b})),n.d(t,"y",(function(){return y})),n.d(t,"x",(function(){return _})),n.d(t,"z",(function(){return v})),n.d(t,"w",(function(){return S})),n.d(t,"i",(function(){return O})),n.d(t,"l",(function(){return C})),n.d(t,"d",(function(){return E})),n.d(t,"u",(function(){return I})),n.d(t,"s",(function(){return w})),n.d(t,"q",(function(){return j})),n.d(t,"n",(function(){return P})),n.d(t,"m",(function(){return T}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="ImmediateOfflineDataSync",a="SchedulePeriodicSyncJob",i="SignOutReconfigure",o="ModernDataLayer",s={ODataBuilder:o+".ODataBuilder",ModernDataSource:o+".ModernDataSource",ExpressionRuntime:o+".ExpressionRuntime",QueryBuilder:o+".QueryBuilder",ModernDataSourceGCM:o+".ModernDataSourceGCM",ModernDataSourceUserContext:o+".ModernDataSourceUserContext",ModernDataSourceExtendedUserContext:o+".ModernDataSourceExtendedUserContext",ModernDataSourceRM:o+".ModernDataSourceRM",ModernDataSourceEntityDefinition:o+".ModernDataSourceEntityDefinition",MdlHttpClient:o+".MdlHttpClient",MdlMetadataClient:o+".MdlMetadataClient",ModernDataSourceRetrieve:o+".ModernDataSourceRetrieve"},c={DataSync:"OfflineDataSync",Upsync:"Upsync"},l={ODataBuilder:"ODataBuilder",ModernDataSource:"ModernDataSource",ExpressionRuntimeHost:"ExpressionRuntimeHost",ModernQueryBuilder:"ModernQueryBuilder",MdlHttpClient:"MdlHttpClient",MdlMetadataClient:"MdlMetadataClient",ModernDataSourcePromiseCache:"ModernDataSourcePromiseCache"},u={ERROR_DETAIL:"Error-Detail",CLIENT_TYPE:"Client-Type",OPERATION_TYPE:"Operation-Type",OPERATIONTYPE:"OperationType",OPERATION_SUB_TYPE:"Operation-SubType",OPERATION_SOURCE:"Operation-Source",RUNTIME_CONTEXT:"Runtime-Context",ENTITY_NAME:"Entity-Name",IS_OFFLINE_BY_DEFAULT_REQUEST:"Is-Offline-By-Default-Request",EXECUTION_HINT:"Execution_Hint",METADATA_TYPE:"MetadataType",METADATA_SUB_TYPE:"MetadataSubType",DEPENDENCY_DEPTH:"DependencyDepth",METADATA_NAMES:"MetadataNames",GET_DEFAULT:"GetDefault",IS_PRELOAD_CALL:"IsPreloadCall",CHANGED_AFTER:"ChangedAfter",ENTITY_LOGICAL_NAME:"EntityLogicalName",UMV:"UMV",MV:"MV",EXCLUDE:"Exclude",METADATA_ID:"MetadataId",METADATA_REDUCTION_LEVEL:"MetadataReductionLevel",ENTITY_RECORD_ID:"EntityRecordId",PRIVILEGE:"Privilege",IS_CACHED_RESPONSE:"IsCachedResponse"},d={LIBRARY_NAME:"LibraryName",FUNCTIONAL_COMPONENT_NAME:"FunctionalComponentName",HOST_FUNCTION_NAME:"HostFunctionName",ERROR_EVENT:"ErrorEvent",CONTEXT_TOKEN:"ContextToken",DEPENDENCY_RESOLUTION_TIME:"DependencyResolutionTime",COMPONENT_RESOLUTION_TIME:"ComponentInfoResolutionTime",SDK_INITIALIZATION_TIME:"SdkInitializationTime",LIBRARY_METADATA_RETRIEVAL:"LibraryMetadataRetrieval",MER_STARTUP_TIME:"MerStartupTime"},p={remote:"remote",local:"local"},f="Entity-Name",g="Is-Offline-By-Default-Request",h="Xrm.WebApi.online",m="Xrm.WebApi.offline",b="Upsync",y="Waiting-For-Network-Result",_="Waiting few seconds for network as network is offline",v="Waiting few seconds for network succeeded and the subsequent request to server also succeeded",S="Waiting few seconds for network failed as network is still offline",O="InputRetrievalStrategy",C="MdlMetadataClientOperation",E="Column-Name",I="Table-Name",w="Segment-Name",j="Resource not found for the segment",P="SQL logic error (1) - no such table",T="SQL logic error (1) - no such column"},ErQw:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r={height:"16rem",width:"40rem",shadowColor:"#666666",type:"warning"},a={height:"16rem",width:"40rem",shadowColor:"#666666",type:"information"}},"Eua/":function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("M1jQ"),a=n("WSMw");class i{constructor(){this.tableName=null,this.values=null,this.filter=null,this.operationType=null}}class o{constructor(e){this._suppressTrigger=!1,this._txList=[],this._suppressTrigger=e}get_supppressTrigger(){return this._suppressTrigger}get_txList(){return this._txList}addCreate(e,t){const n=new i;n.tableName=e,n.values=t,n.operationType=a.b,this.get_txList().push(n)}addUpdate(e,t){const n=new i;n.tableName=e,n.values=t,n.operationType=a.d,this.get_txList().push(n)}addDelete(e,t){const n=new i;n.tableName=e,n.filter=t,n.operationType=a.a,this.get_txList().push(n)}}var s=n("jZCH");class c extends r.a{constructor(){super(),this._transaction=null,this._offlineDataStore=null,this._offlineDataStore=s.a.get_DefaultInstance().get_LocalDataSource().get_offlineDataStore()}get_transaction(){return this._transaction}_set_transaction(e){return this._transaction=e,e}create(e,t){this.get_transaction().addCreate(e,t)}retrieve(e,t){return this._offlineDataStore.retrieveLocalEntities(e,t)}update(e,t){this.get_transaction().addUpdate(e,t)}Delete(e,t){this.get_transaction().addDelete(e,t)}begin(e){this._set_transaction(new o(e))}Commit(e){return this._offlineDataStore.executeTransaction(e)}}},Exmh:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("5yoC");class a extends r.a{constructor(e,t,n){super(),this._target=null,this._processId=null,this._processInstanceId=null,this._target=e,this._processId=t,this._processInstanceId=n}get_name(){return"RetrieveProcessControlData"}get_target(){return this._target}set_target(e){return this._target=e,e}get_processId(){return this._processId}get_processInstanceId(){return this._processInstanceId}}},F1Lu:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("IpQH"),a=n("uM6Y"),i=n("VkXQ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class o extends r.a{constructor(e,t){super(e,t,a.i)}openUri(e,t){return this.execute(i.i.openUri.name,e,t)}updateBackBehavior(e){return this.execute(i.i.updateBackBehavior.name,e)}canOpenUri(e){return this.execute(i.i.canOpenUri.name,e)}switchApp(){return new Promise((e,t)=>{this.execute(i.i.switchApp.name),e({status:0,pageId:null})})}navigateBackOutOfApp(){return this.execute(i.i.navigateBackOutOfApp.name)}}},"F2/H":function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return l})),n.d(t,"d",(function(){return u}));var r=n("3/02"),a=n("Lyxw"),i=n("YPXd");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function o(){const e=new URL(window.location.href,window.location.origin),{isEmbedded:t,isRestore:n,channelId:r}=Object(i.a)(e);return void 0!==n?n:!(!t||!r)}function s(e){return Object(a.f)(e,r.vg)&&o()}function c(e){const t=e.searchParams.get("channelId");return t||null}function l(e){const t=e.searchParams.get("appid");return t||null}function u(e){const t=e.searchParams.get("entityId");return t||null}},F3eT:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class r{constructor(e,t,n,r){this.PageNumber=e,this.Count=t,this.ReturnTotalRecordCount=n,this.PagingCookie=r}getMetadata(){return{boundParameter:null,operationName:null,operationType:null,parameterTypes:{PageNumber:{typeName:"Edm.Int32",structuralProperty:1},Count:{typeName:"Edm.Int32",structuralProperty:1},ReturnTotalRecordCount:{typeName:"Edm.Boolean",structuralProperty:1},PagingCookie:{typeName:"Edm.String",structuralProperty:1}}}}}},F4Tg:function(e,t,n){"use strict";function r(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}n.d(t,"a",(function(){return r}))},F6M4:function(e,t,n){"use strict";function r(e){if(!e)return null;var t={};return t.display=e.display?e.display:"flex",t}function a(e){return!e||"flex"!==e&&"inlineflexbox"!==e?"":"flex"===e?"flexbox":"inlineflexbox"}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}))},FETf:function(e,t,n){"use strict";n.d(t,"d",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"f",(function(){return c})),n.d(t,"m",(function(){return l})),n.d(t,"l",(function(){return u})),n.d(t,"g",(function(){return d})),n.d(t,"k",(function(){return p})),n.d(t,"n",(function(){return f})),n.d(t,"j",(function(){return g})),n.d(t,"r",(function(){return v})),n.d(t,"o",(function(){return y})),n.d(t,"p",(function(){return O})),n.d(t,"q",(function(){return _})),n.d(t,"t",(function(){return C})),n.d(t,"s",(function(){return E})),n.d(t,"v",(function(){return I})),n.d(t,"x",(function(){return w})),n.d(t,"u",(function(){return j})),n.d(t,"w",(function(){return S})),n.d(t,"h",(function(){return h})),n.d(t,"i",(function(){return m})),n.d(t,"a",(function(){return b}));var r=n("LE5i");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="timelinewall.data.reset",i="timelinewall.data.init",o="timelinewall.data.notify",s="timelinewall.data.response",c="timelinewall.loading.status.set",l="timelinewall.updateRecordLastAccessedTime",u="timelinewall.updateEntityRecentItems",d="timelinewall.metadataRetrievalError",p="timelinewall.stateUpdateNotesAnalysisEnabled",f="timelinewall.setEntityTarget",g="timelinewall.setContextualDialogEntity",h="Notes",m="Posts",b="Activities";function y(e,t){let n=Object.keys(e.queueTypeToRequestMap);t===r.a.Data&&(n=[h,m,b]);const a={requestStatusMap:{},dataQueues:{},recordLastAccessedTime:null,entityRecentItems:{},isMetadataRetrievalError:!1,isNotesAnalysisEnabled:!1,target:null,contextualDialogEntityData:null,emailAction:null,responsesStatus:[],timelineUniqueName:null};let o=r.a.Data;for(let e=0;e<n.length;e++){const t=n[e];a.dataQueues[t]={isError:!1,errorMessage:null,dataResults:null,errorLocalizedMessage:null,errorCode:null},t!==r.a.Filters&&t!==r.a.WhatsChanged&&t!==r.a.MoreEmails||(o=t)}a.requestStatusMap[o]={status:1,requestId:e.requestId},a.requestStatusMap[r.a.InitiateRefresh]={status:2,requestId:e.requestId};const s={timlineWallInitDataState:a,id:e.controlId};return{type:i,payload:s}}function _(e,t,n){return{type:o,payload:{id:t,dataQueues:{[n]:e}}}}function v(e,t,n){const i={requestStatusMap:{},dataQueues:{},recordLastAccessedTime:null,entityRecentItems:t,isMetadataRetrievalError:!1,isNotesAnalysisEnabled:!1,target:null,contextualDialogEntityData:null,emailAction:null,responsesStatus:[],timelineUniqueName:n};for(const e in r.a)i.requestStatusMap[r.a[e]]={status:0,requestId:null};return{type:a,payload:{timlineWallResetDataState:i,id:e}}}function S(e,t,n,r){return{type:s,payload:{responseStatus:{isError:e,requestId:n,response:r},id:t}}}function O(e,t,n,r){const a={};a[t]={status:n,requestId:r};return{type:c,payload:{stateName:t,timlineWallDataState:{requestStatusMap:a,dataQueues:{},recordLastAccessedTime:null,entityRecentItems:{},isMetadataRetrievalError:!1,isNotesAnalysisEnabled:!1,target:null,contextualDialogEntityData:null,emailAction:null,responsesStatus:[],timelineUniqueName:null},id:e}}}function C(e,t){return{type:l,payload:{recordLastAccessedTime:t,id:e}}}function E(e,t){return{type:u,payload:{entityRecentItems:t,id:e}}}function I(e,t){return{type:d,payload:{isMetadataRetrievalError:t,id:e}}}function w(e,t){return{type:f,payload:{target:t,id:e}}}function j(e,t,n){return{type:g,payload:{contextualDialogEntityData:t,id:e,emailAction:n}}}},FJiw:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r={width:"100%",height:"100%",shadowColor:"rgba(0, 0, 0, 0.5)",backgroundColor:"transparent",windowPosition:"center",openInNewWindow:!1,useDefaultDialogChrome:!0,overflow:"hidden"}},FJpk:function(e,t,n){"use strict";n.d(t,"c",(function(){return p})),n.d(t,"d",(function(){return f})),n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return u}));var r=n("N2HV"),a=n("Fn63"),i=n("JDi5"),o=n("fA3V"),s=n("5oHv"),c=n("x6/I"),l=n("hO7G");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const u=Object(c.c)(l.a.tab,0),d=Object(c.c)(l.a.session,0);function p(e){if(!e)return"";let t=e.split(":");t.length>2&&(t=t.splice(2));const n=t.join(":");let r=n.lastIndexOf("-");r<0&&(r=void 0);const a=n.substring(0,r).trim();return a.length>0?a:e}function f(e){let t=null;switch(e){case o.a:t={type:r.b,value:a.a.URL.toString()};break;case i.a:t={type:r.b,value:a.a.SearchButton.toString()};break;case s.a:t={type:r.b,value:a.a.KnowledgeSearch.toString()}}return t}},FKgA:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("504W"),a=n("0Lym");const i=[1037,1025],o=[1041,2052,1028];class s{constructor(e,t,n,a,i,s,c,l,u,d,p,f,g,h,m,b,y,_,v,S,O,C,E,I){this._isFarEastLanguage=!1,this._userCultureName=null,this._formatInfoCultureName=null,this._numberFormatInfo=null,this._dateTimeFormatInfo=null,this._reportScriptErrors=0,this._savedfilters=null,this._defaultSavedFilter=null,this._timeZoneUtcOffsetMinutes=0,this._isGuidedHelpEnabled=!0,this._showCalendarWeeks=!1,this._isHighContrastEnabled=!1,this._defaultSearchExperience=0,this._defaultGridViews=null,this._selectedGlobalFilterId=null,this._isAdmin=!1,this._isCustomizer=!1,this._isSupportUser=!1,this._homepageArea="<Default>",this._homepageSubArea=null,this._isEmailConversationViewEnabled=!1,this._workDayStartTime="",this._autoCaptureUserStatus=0,this._languageId=-1,this._userCultureLcid=-1,this._recordsPerPage=-1,this._timeZoneAdjusters=[],this._languageId=e,this._userCultureLcid=t,this._isFarEastLanguage=!Object(r.a)(o)&&o.indexOf(t)>=0,this._userCultureName=Object(r.b)(n)?"":n,this._formatInfoCultureName=Object(r.b)(a)?"":a,this._numberFormatInfo=Object(r.a)(i)?{}:i,this._dateTimeFormatInfo=Object(r.a)(s)?{}:s,this._timeZoneUtcOffsetMinutes=c,this._timeZoneAdjusters=Object(r.a)(l)?new Array(0):l,this._recordsPerPage=u,this._reportScriptErrors=d,this._isGuidedHelpEnabled=p,this._showCalendarWeeks=f,this._isHighContrastEnabled=g,this._defaultSearchExperience=h,this._defaultGridViews=m,this._selectedGlobalFilterId=b,this._isAdmin=y,this._isCustomizer=_,this._homepageArea=v,this._homepageSubArea=S,this._isEmailConversationViewEnabled=O,this._workDayStartTime=C,this._autoCaptureUserStatus=E,this._isSupportUser=I}get_languageId(){return this._languageId}get_userCultureLcid(){return this._userCultureLcid}get_defaultSearchExperience(){return this._defaultSearchExperience}get_isFarEastLanguage(){return this._isFarEastLanguage}get_userCultureName(){return this._userCultureName}get_formatInfoCultureName(){return this._formatInfoCultureName}get_numberFormatInfo(){return this._numberFormatInfo}get_dateTimeFormatInfo(){return this._dateTimeFormatInfo}get_timeZoneUtcOffsetMinutes(){return this._timeZoneUtcOffsetMinutes}get_timeZoneAdjusters(){return this._timeZoneAdjusters}get_RecordsPerPage(){return this._recordsPerPage}get_reportScriptErrors(){return this._reportScriptErrors}get_savedfilters(){return this._savedfilters}get_defaultSavedFilter(){return this._defaultSavedFilter}get_IsGuidedHelpEnabled(){return this._isGuidedHelpEnabled}get_showCalendarWeeks(){return this._showCalendarWeeks}get_isRTL(){return i.indexOf(this.get_languageId())>=0}get_isHighContrastEnabled(){return this._isHighContrastEnabled}get_defaultGridViews(){return this._defaultGridViews}get_selectedGlobalFilterId(){return this._selectedGlobalFilterId}get_isAdmin(){return this._isAdmin}get_isCustomizer(){return this._isCustomizer}get_isSupportUser(){return this._isSupportUser}get_HomepageArea(){return this._homepageArea}get_HomepageSubArea(){return this._homepageSubArea}get_isEmailConversationViewEnabled(){return this._isEmailConversationViewEnabled}get_workDayStartTime(){return this._workDayStartTime}get_AutoCaptureUserStatus(){return this._autoCaptureUserStatus}getObjectData(){const e={};return e.languageid=this._languageId,e.userculturelcid=this._userCultureLcid,e.userCultureName=this._userCultureName,e.formatinfoculturename=this._formatInfoCultureName,e.numberformatinfo=this._numberFormatInfo,e.datetimeformatinfo=this._dateTimeFormatInfo,e.timezoneutcoffsetminutes=this._timeZoneUtcOffsetMinutes,e.defaultsearchexperience=this._defaultSearchExperience,e.timezoneadjusters=this._timeZoneAdjusters.map(e=>e.getObjectData()),e.recordsperpage=this._recordsPerPage,e.reportscripterrors=this._reportScriptErrors,e.isguidedhelpenabled=this._isGuidedHelpEnabled,e.showcalendarweeks=this._showCalendarWeeks,e.ishighcontrastenabled=this._isHighContrastEnabled,e.selectedglobalfilterid=this.get_selectedGlobalFilterId(),e.isadmin=this._isAdmin,e.iscustomizer=this._isCustomizer,e.issupportuser=this._isSupportUser,e.homepagearea=this._homepageArea,e.homepagesubarea=this._homepageSubArea,e}static createFromObjectData(e){const t=e.languageid,n=e.userculturelcid,r=e.userCultureName,i=e.formatinfoculturename,o=e.numberformatinfo,c=e.datetimeformatinfo,l=e.timezoneutcoffsetminutes,u=e.defaultsearchexperience,d=e.timezoneadjusters.map(e=>a.a.createFromObjectData(e)),p=e.recordsperpage,f=e.reportscripterrors,g=e.isguidedhelpenabled,h=e.ishighcontrastenabled,m=e.showcalendarweeks,b=e.defaultgridviews,y=e.selectedglobalfilterid,_=e.isadmin,v=e.iscustomizer,S=e.issupportuser,O=e.homepagearea,C=e.homepagesubarea,E=e.isEmailConversationViewEnabled,I=e.workDayStartTime,w=e.autoCaptureUserStatus;return new s(t,n,r,i,o,c,l,d,p,f,g,m,h,u,b,y,_,v,O,C,E,I,w,S)}}},"FM/+":function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e,t){if(t){const n=[];n.push("["+t+"]");return e.executeSync_DO_NOT_USE("eval",n,!0)}return null}function a(e,t){return e.toLowerCase()===t}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}))},FZDd:function(e,t,n){"use strict";n.d(t,"a",(function(){return C})),n.d(t,"b",(function(){return E})),n.d(t,"d",(function(){return I})),n.d(t,"f",(function(){return w})),n.d(t,"h",(function(){return j})),n.d(t,"e",(function(){return P})),n.d(t,"g",(function(){return T})),n.d(t,"c",(function(){return N}));var r=n("eXjw"),a=n("8VF0"),i=n("K7RF"),o=n("5KQF"),s=n("g0tL"),c=n("iZ7K"),l=n("LbMF"),u=n("Wgxh"),d=n("pF61"),p=n("ddoO"),f=n("2jAf"),g=n("iJGp"),h=n("/oKV"),m=n("3c7c"),b=n("504W"),y=n("Er26");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const _=["activityparty"];function v(e,t,n){const r=t&&Object.keys(t).sort(),a=Object(m.a)(JSON.stringify(t,r));return e(Object(i.b)(C,a,null,null,!1,g.a.OnDemandWithoutContext,null,[],[],s.b.Entity,h.a.LocalAndRemote,null,null))}function S(e,t,n,a,i,o){const s={},u={};for(const t in n)if(!Object(b.b)(t)){let d;const p=n[t],f=Object(c.h)(e,t);if(O(t)){const n=I(e,t,a,i,o);n&&(u[t]=n)}f&&f.Initialized!==r.a.Uninitialized&&f.Initialized!==r.a.Partial?(d=Object(l.g)(e,t,p||f.AttributeNames)).length>0&&(s[t]=d&&d.sort().filter((e,t,n)=>n.indexOf(e)===t)):s[t]=p&&p.sort().filter((e,t,n)=>n.indexOf(e)===t)}return Object.keys(u).length>0&&t(Object(f.e)(u,null)),s}function O(e){return-1===_.indexOf(e)}const C="entity",E="entity.retrieve";function I(e,t,n,r,a){var i;if(!e)return null;if(!a){a=Object(d.c)(e);const t=null===(i=n.Router.getHistoryManager())||void 0===i?void 0:i.GetCurrentUrl();if((null==t?void 0:t.indexOf(".crmlivetie.com"))>0&&r){const e=n.TraceManager.getTracer("RetrieveEntity"),t="getUpdatedEntityRefCount() called without pageId, action stack is : "+r.stack;e.info(t);const a=[];a.push({name:"errorString",value:t}),n.EventManager.ReportComponentSuccess("RetrieveEntity",a)}}if(a&&""!==a){const n=Object(p.g)(e,t),r=n&&n.slice();return Object(u.a)(r,a)}return null}function w(e,t,n,r){return{type:"entity.retrieve.async",execute({dispatch:a,getState:i},o,s){if(Object(b.b)(e)){const t=o.TraceManager.getTracer("RetrieveEntity"),n=[];n.push({name:y.f.ENTITY_LOGICAL_NAME,value:e});const r="Entity name is invalid";return null==t||t.error(r,n),Promise.reject(new Error(r))}const c={[e]:t?null:n},l=S(i(),a,c,o,s,r);if(0===Object.keys(l).length)return Promise.resolve();o.DataSource;return v(a,l)}}}function j(e,t){const n=Object(o.a)(e,s.b.Entity,null,null,null,null,t);return{type:i.a,payload:n}}function P(e,t){return{type:"entity.retrieve.async",execute({dispatch:n,getState:r},a,i){if(!e||0===Object.keys(e).length)return Promise.resolve();const o=S(r(),n,e,a,i,t);if(0===Object.keys(o).length)return Promise.resolve();a.DataSource;return v(n,o)}}}function T(e){const t={};e.forEach(e=>{t[e]={Initialized:r.a.Error}});const n={entities:t};return Object(a.b)(n)}function N(e){const t=JSON.parse(e.replace(/\\\"/gi,'"'));return Object.keys(t)}},FZk4:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("504W"),a=n("mKIe");class i{constructor(e,t,n,i,o){this._name=null,this._value=null,this._logicalOperator=0,this._condition=0,this._parenthesisType=0,this.set_name(e),this.set_value(t),this.set_logicalOperator(n),this.set_condition(i),this.set_parenthesisType(Object(r.a)(o)?a.a.none:o)}get_name(){return this._name}set_name(e){return this._name=e,e}get_value(){return this._value}set_value(e){return this._value=e,e}get_logicalOperator(){return this._logicalOperator}set_logicalOperator(e){return this._logicalOperator=e,e}get_condition(){return this._condition}set_condition(e){return this._condition=e,e}get_parenthesisType(){return this._parenthesisType}set_parenthesisType(e){return this._parenthesisType=e,e}}},Fb4j:function(e,t,n){"use strict";n.d(t,"b",(function(){return Pe})),n.d(t,"a",(function(){return Ne}));var r,a;
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */n("2v4m");!function(e){e.AuthFrame="AuthFrame",e.AuthFrameWithCookie="AuthFrameWithCookie",e.Host="Host",e.Proxy="Proxy"}(r||(r={})),function(e){e.AdalError="AdalError",e.CookiesBlocked="CookiesBlocked",e.Error="Error",e.PopupError="PopupError",e.StorageBlocked="StorageBlocked",e.TokenRequestError="TokenRequestError",e.UserCancelled="UserCancelled"}(a||(a={}));
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
var i,o=function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},s={},c={},l=0,u=window.parent;function d(e){i=e}function p(e,t){c[e]=t}function f(e,t){g(u,e,t)}function g(e,t,n){if(e){var r=y(t)?t:function(e){return o({id:l++,protocol:"PAAF"},e)}(t);e.postMessage(r,"*"),n&&(s[r.id]=n)}else _("Failed to send "+t.action+" request. No targetWindow")}function h(e,t,n){m(e.source,e.origin,t,n)}function m(e,t,n,r){if(e){var a=function(e,t){return o({id:e,protocol:"PAAF"},t)}(n,r);e.postMessage(a,t)}else _("Failed to send response. No targetWindow")}function b(e){if(e.data&&"PAAF"===e.data.protocol){var t,n,r=e.data;y(r)?function(e,t){var n=c[e.action];n?n(e,t):_("Received a "+e.action+" request without a handler")}(r,e):(n=s[(t=r).id])?(n(t),delete s[t.id]):_("Received a response without a callback")}}function y(e){return"id"in e&&"action"in e}function _(e){null==i||i(e)}function v(e){var t="Unknown error occurred";try{e&&(t=e instanceof Error?JSON.stringify(e,Object.getOwnPropertyNames(e)):JSON.stringify(e))}catch(e){}return{errorCode:a.Error,errorMessage:t}}function S(e){return{errorCode:a.PopupError,errorMessage:e}}function O(e){return{errorCode:a.TokenRequestError,errorMessage:e}}function C(){return{errorCode:a.UserCancelled,errorMessage:"User cancelled the auth flow"}}function E(e){return function(e){return!(!e||"string"!=typeof e.errorCode||"string"!=typeof e.errorMessage)}(e)?e:v(e)}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */var I={local:"https://apps.local.powerapps.com:44329",dev:"https://apps.dev.powerapps.com",test:"https://apps.test.powerapps.com",int:"https://apps.int.powerapps.com",preprod:"https://apps.preprod.powerapps.com",preview:"https://apps.preview.powerapps.com",prod:"https://apps.powerapps.com",gccmoderate:"https://apps.gov.powerapps.us",gcchigh:"https://apps.high.powerapps.us",dod:"https://play.apps.appsplatform.us",mooncake:"https://apps.powerapps.cn",ex:"https://apps.powerapps.eaglex.ic.gov",rx:"https://apps.powerapps.microsoft.scloud"},w=null;function j(e,t,n){w&&w.trackError(e+"."+t,n)}function P(e,t,n){w&&w.trackEvent(e+"."+t,n)}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */var T=function(){function e(e){this._anchor=document.createElement("a"),this._anchor.href=e}return Object.defineProperty(e.prototype,"host",{get:function(){return this._anchor.host},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hostname",{get:function(){return this._anchor.hostname},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"href",{get:function(){return this._anchor.href},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"port",{get:function(){return this._anchor.port},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"origin",{get:function(){return this.protocol+"//"+this.host},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"protocol",{get:function(){return this._anchor.protocol},enumerable:!1,configurable:!0}),e}();
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */function N(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){return function(e,t){var n=(e+16*Math.random())%16|0;return("x"===t?n:3&n|8).toString(16)}(e,t)}))}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */var A,R;!function(e){e[e.NotStarted=0]="NotStarted",e[e.Started=1]="Started",e[e.Completed=2]="Completed",e[e.Failed=3]="Failed"}(A||(A={}));var D,x=A.NotStarted,M=[];function F(e){return e===r.AuthFrame||e===r.AuthFrameWithCookie||e===r.Host}function k(){if(x===A.NotStarted){var e=Y(),t=e.loadFrameTimeout,n=e.region;x=A.Started;var r=function(e){return new T(I[e]+"/authflow/authframe")}(n).href;P("AuthenticationFrame","loadAuthFrame",{region:n,url:r}),D=setTimeout((function(){x=A.Failed,j("AuthenticationFrame","loadAuthFrameFailure"),V((function(e){return z(e)}))}),t),R=function(e,t,n){var r=document.createElement("iframe");return r.setAttribute("id",t),r.setAttribute("name",t),r.height="0px",r.width="0px",r.style.display="none",n&&r.addEventListener("load",n),r.src=e,document.body.appendChild(r),r}(r,"powerAppsAuthFlowFrame")}}function L(){clearTimeout(D),function(){if(x!==A.Started)return;x=A.Completed,P("AuthenticationFrame","loadAuthFrameSuccess"),V((function(e,t){return U(e,t)}))}()}function B(e,t){switch(Y(),x===A.NotStarted&&k(),x){case A.Completed:U(e,t);break;case A.Failed:z(e);break;default:M.push([e,t])}}function U(e,t){var n=R&&R.contentWindow;n?g(n,e,t):j("AuthenticationFrame","sendMessageRequestToAuthFrame",{message:"No frame window"})}function V(e){for(var t=0,n=M;t<n.length;t++){var r=n[t];e(r[0],r[1])}M=[]}function z(e){"getAccessToken"!==e.action&&"getAccessTokenCookie"!==e.action||function(e,t){var n=Y().hostWindow;m(function(e,t){for(var n=t,r=e.length;r>0;r--)n=n.frames[e[r-1]];return n}(e.frameIds,n),e.origin,e.id,t)}(e,{error:v("Failed to load the auth frame"),token:void 0})}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */var q,H=function(){return(H=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},W=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),a=0;for(t=0;t<n;t++)for(var i=arguments[t],o=0,s=i.length;o<s;o++,a++)r[a]=i[o];return r},G=!1;function K(e){void 0===e&&(e={}),q=function(e){var t=H({frameId:window.name,hostFunctions:{},hostWindow:window,loadFrameTimeout:15e3},e),n=t.authenticationMode;switch(n){case r.AuthFrame:Q(t,"openPopup");break;case r.AuthFrameWithCookie:Q(t,"getAccessTokenCookie");break;case r.Host:Q(t,"getAccessToken");break;case r.Proxy:if(!window.name)throw new Error("Proxy frames must have a name.")}if(F(n)&&!t.region)throw new Error("Region must be set when using "+n+" mode.");return t}(e),G=!0;var t=q.authenticationMode,n=q.logger;n&&function(e){w=e}(n),p("frameInitialized",J),t&&(p("getAccessToken",$),t===r.Host&&p("getAccessTokenFromHost",ee),t===r.AuthFrameWithCookie&&p("getAccessTokenCookie",Z)),F(t)&&p("openPopup",te),d((function(e){j("PowerAppsAuthFlow","messageError",{message:e})})),window.addEventListener("message",b)}function Q(e,t){if(!e.hostFunctions[t])throw new Error("The host must implement "+t+" when using "+e.authenticationMode+" mode.")}function X(e){var t=new T(e);for(var n in I)if(I[n]===t.origin)return!0;return!1}function Y(){if(!G)throw new Error("Auth flow has not been initialized.");return q}function J(e,t){var n=Y(),r=n.sessionId,a=n.tenantId,i=n.authenticationMode,o=n.hostType,s=n.loginHint;h(t,e.id,{sessionId:r,tenantId:a,authenticationMode:i,hostType:o,loginHint:s}),"powerAppsAuthFlowFrame"===e.frameId&&L()}function $(e){var t,n=Y(),a=n.authenticationMode,i=n.frameId,o=e.options;switch(o.correlationId=null!==(t=o.correlationId)&&void 0!==t?t:N(),P("PowerAppsAuthFlow","handleGetAccessToken",{authenticationMode:a,correlationId:o.correlationId,resource:o.resource}),a){case r.Host:case r.AuthFrame:case r.AuthFrameWithCookie:B(e);break;case r.Proxy:f(H(H({},e),{frameIds:W(e.frameIds,[i])}))}}function Z(e,t){if(X(t.origin)){var n=Y().hostFunctions,r=e.options,a=e.origin,i=e.cookieDetails;n.getAccessTokenCookie(r,a,i.name,i.domain,(function(n){h(t,e.id,{error:n&&E(n)})}))}else h(t,e.id,{error:O("Invalid request.")})}function ee(e,t){X(t.origin)?Y().hostFunctions.getAccessToken(e.options,(function(n,r){h(t,e.id,{error:n&&E(n),token:r})})):h(t,e.id,{error:O("Invalid request.")})}function te(e,t){if(X(t.origin)){var n,r=Y().hostFunctions,a=function(a){clearInterval(n),h(t,e.id,{error:a}),a&&r.handlePopupError&&r.handlePopupError(a)};p("popupComplete",(function(e){var t=e.error;a(t),p("popupComplete",null)})),r.openPopup(e.url,(function(e,t){!e&&t?(t.focus&&t.focus(),n=window.setInterval((function(){t&&!t.closed||a(C())}),500)):a(e?E(e):S("Failed to open the popup"))}))}else h(t,e.id,{error:S("Invalid request.")})}
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */var ne=n("kAKO"),re=n("yHIv"),ae=n("w1eR"),ie=n("Lyxw"),oe=n("3/02"),se=n("JRzo"),ce=n("si7p"),le=n("YxC/"),ue=n("ErQw"),de=n("pgSX"),pe=n("VCkP"),fe=n("dj6u"),ge=n("tICD"),he=n("NjDY"),me=n("hAdb"),be=n("SocB"),ye=n("UwOy"),_e=n("E5IU"),ve=n("gQ5I"),Se=n("pF61"),Oe=n("4leG");let Ce=!0,Ee="";const Ie={height:"16rem",width:"40rem",shadowColor:be.d.Grey.Grey2,type:"warning"},we="https://go.microsoft.com/fwlink/?LinkID=398563&";class je{constructor(e){this._applicationContext=e}trackError(e,t){this._applicationContext.EventManager.ReportComponentFailure("PowerAppsAuthFlow",this._addParametersToEvent(e,t))}trackEvent(e,t){this._applicationContext.EventManager.ReportComponentSuccess("PowerAppsAuthFlow",this._addParametersToEvent(e,t))}_addParametersToEvent(e,t){const n=[{name:"EventName",value:e}];if(t)for(const e of Object.keys(t))n.push({name:e,value:t[e]});return n}}function Pe(){return{diagnosticName:"InitializePowerAppsAuthSDK",boot:(e,t,n)=>{const i=e.getStore().getState(),o=t.TraceManager.getTracer("PowerAppsAuthFlow");if(function(e){return Object(ie.f)(e,oe.Qb)}(i)){const s=function(e){try{const t=Object(me.c)(e,"canvashostenv");if("TEST"===(null==t?void 0:t.toUpperCase()))return"test"}catch(e){}const t=window.location.origin,n=Ae.find(e=>e.allowedOriginRegex.test(t));return n?n.id:"prod"}(i),c=Object(le.e)(i,se.q),l=Object(le.c)(c,se.o),u=Object(le.c)(c,se.e),d=Object(le.c)(c,se.f),p=Object(le.c)(c,se.j),f=Object(le.c)(c,se.d),g=Object(le.c)(c,se.p),h=Object(ye.d)(i),m=e.getClientHost()===ae.a.MobileApplication,b=e.getClientHost()===ae.a.MailApp,y=Object(Oe.e)(i),_=h?r.Proxy:m?r.AuthFrameWithCookie:r.AuthFrame,v=Object(ie.f)(i,oe.Vb)&&!h&&!m&&!b&&!y,S=Object(_e.f)(i);if(K({authenticationMode:_,hostFunctions:{handlePopupError:e=>{let t="";switch(e.errorCode){case a.StorageBlocked,a.CookiesBlocked:t=c[se.c];break;case a.PopupError:t=c[se.b];break;default:return}const r=[{name:"error",value:null==e?void 0:e.errorCode}];o.error("Auth popup blocked",r);const i=function(e){const t=e?"&Error="+encodeURIComponent(e):"";return{errorCode:e,helpURL:`${we}client=PowerAppsAuthTask${t}`}}(e.errorCode);n.dispatch(Object(de.a)(ce.b,t,ue.a,p,g,null,null,null,null,!0,null,i))},getAccessTokenCookie:async(e,r,a,i,o)=>{const s=new pe.a(t,n);try{await s.beginSecureSessionForAuthFlow(e,r,a,i),o()}catch(e){o(E(e))}},openPopup:async(e,r)=>{o.warn("Showing login prompt"),Ce=v&&Ce&&S.length>0;const a=Ce?u:d,i=await n.dispatch(Object(de.a)(ce.a,a,Ie,l,f,null,null,null,null,!0,null,null,Ce));if(0===i.status){if((await n.dispatch(Object(ge.a)(i.pageId))).value.confirmed){Ce&&async function e(t){if(Ce){const n=t.getState(),r=Object(le.e)(n,se.q),a=Object(le.c)(r,se.e),i=Object(le.c)(r,se.o),o=Object(le.c)(r,se.d),s=await t.dispatch(Object(de.a)(ce.a,a,Ie,i,o,null,null,null,null,!0,null,null,!0));if(0===s.status){Ee=s.pageId;(await t.dispatch(Object(ge.a)(s.pageId))).value.confirmed&&e(t)}}}(n);r(null,window.open(e,"","width=500, height=500")),t.EventManager.ReportComponentSuccess("PowerAppsAuthTask",[{name:"wasAuthPromptBlocking",value:Ce}])}else o.error("PowerApps authflow dialog closed without login"),r(C()),t.EventManager.ReportComponentFailure("PowerAppsAuthTask","PowerApps authflow dialog closed without login",void 0,[{name:"wasAuthPromptBlocking",value:Ce}])}else r(E("Error occurred while opening powerapps auth sdk dialog"),null),t.EventManager.ReportComponentFailure("PowerAppsAuthTask","Error occurred while opening powerapps auth sdk dialog "+i.error,void 0,[{name:"wasAuthPromptBlocking",value:Ce}])}},region:s,loginHint:Object(fe.a)(),tenantId:Te(i,s),loadFrameTimeout:3e4,logger:new je(t),sessionId:t.EventManager.getCurrentSessionId(),hostType:"UCI"}),v&&S.length>0){Ne(i,{resource:"394866fc-eedb-4f01-8536-3ff84b16be2a",correlationId:t.EventManager.getCurrentSessionId(),isSilentRequest:!1}).then(()=>{Ce=!1;const t=e.getStore().getState();Ee&&Object(Se.l)(t,Ee)&&n.dispatch(Object(ve.e)(Ee))})}}},supportedClientHostTypes:re.a,supportedPageTypes:re.b,priority:ne.a.Normal}}function Te(e,t){return"test"===t||"local"===t?"":Object(fe.b)(e)}function Ne(e,t){const n=Object(he.D)(e);return new Promise((e,a)=>{(null==n?void 0:n.enableLivePersonaCardUCI)?function(e,t){var n=Y(),a=n.frameId,i=n.authenticationMode;i===r.AuthFrame||i===r.AuthFrameWithCookie?(P("PowerAppsAuthFlow","getAccessToken",{authenticationMode:i,correlationId:e.correlationId,resource:e.resource,origin:window.location.origin}),B({action:"getAccessToken",frameIds:[],origin:window.location.origin,options:e},(function(e){var n=e.error,r=e.token;t(n,r)}))):f({action:"getAccessToken",frameIds:[a],origin:window.location.origin,options:e},(function(e){var n=e.error,r=e.token;t(n,r)}))}(t,(t,n)=>{t?a(t):e(n)}):e(null)})}const Ae=[{id:"gccmoderate",allowedOriginRegex:/.*\.crm9\.dynamics\.com$/},{id:"gcchigh",allowedOriginRegex:/.*\.crm\.microsoftdynamics\.us$/},{id:"dod",allowedOriginRegex:/.*\.crm\.appsplatform\.us$/},{id:"mooncake",allowedOriginRegex:/.*\.crm\.dynamics\.cn$/},{id:"ex",allowedOriginRegex:/.*\.crm\.dynamics\.eaglex\.ic\.gov$/},{id:"rx",allowedOriginRegex:/.*\.crm\.dynamics\.microsoft\.scloud$/},{id:"test",allowedOriginRegex:/(.*.crm.dynamics-int.com$|.*.crm10.dynamics.com$|.*localhost.*)/}]},FdB0:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * The unique name of the Dialog page module.
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="Dialog"},FdKt:function(e,t,n){"use strict";n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return h})),n.d(t,"c",(function(){return m})),n.d(t,"d",(function(){return b})),n.d(t,"e",(function(){return y}));var r=n("zI6t"),a=n.n(r),i=n("5UJb"),o=n.n(i),s=n("oZ1k"),c=n("pEXn");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const l=[];let u=-1,d=-1,p=!0;function f(e){try{e&&e()}catch(e){setTimeout(()=>{throw e},0)}}function g(){if(S(),l.length>0){a.a.addCommonKpiParameters({[c.b.PageLoadParameters.IdleTasks]:"true"}),a.a.tagWorkBlock("Idle tasks");const e=o.a.trackWork("executeIdleTasks");for(;l.length>0;){const e=l.shift();e&&f(e.callback)}e()}}function h(e,t){m(e,{diagnosticId:t,type:"DefaultTaskType"})}function m(e,t){l.push({callback:e,taskContextToken:t}),p&&-1===d&&(d=setTimeout(g,2e4)),o.a.isAppIdle()&&_()}function b(){return l}function y(e){const t=l.findIndex(t=>t.taskContextToken.diagnosticId===e);-1!==t&&(f(l[t].callback),l.splice(t,1))}function _(){p&&-1===u&&b()&&(u=setTimeout(g,200))}function v(){clearTimeout(u),u=-1}function S(){v(),clearTimeout(d),d=-1}o.a.subscribeToAppIdle(_),o.a.subscribeToAppWorking(v),Object(s.subscribeToAutomationEvents)((e,t)=>{p=!e,p||S()})},FdXt:function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"h",(function(){return a})),n.d(t,"e",(function(){return i})),n.d(t,"g",(function(){return o})),n.d(t,"f",(function(){return s})),n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return l})),n.d(t,"d",(function(){return u})),n.d(t,"i",(function(){return d}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="FormToastNotification_Success_Save_Message",a="Web.NavBar.QC_ViewRecord",i="MenuItem_Label_SaveClose",o="MenuItem_Label_SaveFooterButton",s="MenuItem_Label_SaveAndNew",c="Button_Label_Cancel",l="Open_More_Flyout",u="FormDesigner.PropertiesTab.Options",d=[i,s,c,"Split_Button",l,"Split_Button_More_Flyout",r,a,u,o]},FfwU:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class r{getMetadata(){return{boundParameter:null,operationName:"ExecuteQuickFind",operationType:0,parameterTypes:{SearchText:{typeName:"Edm.String",structuralProperty:1},EntityGroupName:{typeName:"Edm.String",structuralProperty:1},EntityNames:{typeName:"Edm.String",structuralProperty:4},AppModule:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5}}}}}},Fgw8:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return s}));var r=n("oT5e");function a(e,t,n){let a;return t&&t.targetBrowsingContext?a=Object(r.a)(e,t.targetBrowsingContext):(a=Object(r.f)(e),n&&n.warn("Navigation options is not provided to MultiSessionHistoryManager GetHistoryLength method, returning history length of active tab")),a}function i(e,t){e.updateDialogs(t)}function o(e,t){return!(null==t?void 0:t.targetBrowsingContext)||t.targetBrowsingContext===Object(r.f)(e).id}function s(e,t){const n=a(e,t);if(n.history)return n.history[n.history.length-1]}},FhVi:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("mMyr"),a=n("hp2+"),i=n("cz9j"),o=n("FdKt"),s=n("ju1h");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class c extends r.Component{constructor(e){super(e),this._rootElementIdInternal="",this._isDisable=!1,this._elementBlurredHandler=this._elementBlurredHandler.bind(this),this._elementFocusedHandler=this._elementFocusedHandler.bind(this),this._onFocusForFakeButton=this._onFocusForFakeButton.bind(this),this._rootElementInActiveFocusedHandler=this._rootElementInActiveFocusedHandler.bind(this),this._checkContextVisibility=this._checkContextVisibility.bind(this)}render(){return null}componentDidMount(){const e=this.context;e&&(this._registerContext(e),this.props.rootElementId&&this.props.shouldManageFocus&&e.accessibilityComponentStack&&e.accessibilityComponentStack.subscribeOnToggleVisibility(this._checkContextVisibility))}_registerContext(e){this._firstEditableElement=null,this._firstFocusableElement=null,this._lastFocusableElement=null,this._lastFocusedElement=null,e&&e.accessibilityComponentStack&&e.accessibilityManager&&(this._rootElementIdInternal=e.isChildContext||!this.props.shouldManageFocus||this.props.isModal||0!==e.accessibilityComponentStack.length?this.props.rootElementId:e.rootElementId,e.accessibilityComponentStack.registerAccessibilityContext(this),e.accessibilityManager.registerKeyboardShortcuts(this.props.keyboardShortcuts))}get rootElementId(){return this._rootElementIdInternal}componentDidUpdate(e){if(this._isActive&&(e.rootElementId!==this.props.rootElementId||e.shouldManageFocus!==this.props.shouldManageFocus||e.isModal!==this.props.isModal)){const e=this.context;e&&e.accessibilityComponentStack&&e.accessibilityComponentStack.updateAccessibilityContext(this)}}componentWillUnmount(){this._isDisable=!0;const e=this.context;e&&(this.props.shouldManageFocus&&this.props.rootElementId&&e.accessibilityComponentStack&&e.accessibilityComponentStack.unsubscribeOnToggleVisibility(this._checkContextVisibility),this._deregisterContext(e))}_deregisterContext(e){e&&e.accessibilityComponentStack&&e.accessibilityManager&&(e.accessibilityComponentStack.deregisterAccessibilityContext(this),e.accessibilityManager.deregisterKeyboardShortcuts(this.props.keyboardShortcuts)),this.props.shouldManageFocus&&this.props.rootElementId&&(this._removeFocusAndBlurHandlers(),this._removeTrapFocusForModalDialog(),this._isActive=!1),this._firstEditableElement=null,this._firstFocusableElement=null,this._lastFocusableElement=null,this._lastFocusedElement=null}_checkContextVisibility(){const e=this.context,t=document.getElementById(this.props.rootElementId);t&&e&&(t.offsetParent?this._isDisable&&(this._registerContext(e),this._isDisable=!1):this._isDisable||(this._deregisterContext(e),this._isDisable=!0))}get mutationObserver(){return this._mutationObserver}updateMutationObserver(e){this._mutationObserver=e}popMutationObserver(){const e=this._mutationObserver;return this._mutationObserver=null,e}get isActive(){return this._isActive}set isActive(e){if(this._isActive=e,this._removeFocusAndBlurHandlers(),this._removeTrapFocusForModalDialog(),this._isActive)this._applyFocusAndBlurHandlers(),this._trapFocusForModalDialog();else{this.context.isChildContext&&this._applyFocusHandlerWhenInactive()}}checkIfCompletelyRendered(e,t){let n=!1;if(e){const t=this._getElement(e);if(t){const e=i.a(t);n=null!=e.editableElement||null!=e.focusableElement}}else if(this.props.defaultFocusId){const e=this._getElement(this.props.defaultFocusId);if(e){const t=i.a(e);n=null!=t.editableElement||null!=t.focusableElement}else t&&(n=this._checkSubtreeCompletelyRendered())}else n=this._checkSubtreeCompletelyRendered();return n}_checkSubtreeCompletelyRendered(){let e=!1;const t=this._getElement(this._rootElementIdInternal);if(t){const n=i.a(t);e=this.props.waitForEditable?null!=n.editableElement:null!=n.focusableElement}return e}redetermineFocusOnCurrentContext(e){let t=null,n=!1;if(e){const r=this._getElement(e);if(r){const e=i.a(r);t=e.editableElement||e.focusableElement,n=!0}}!t&&this._lastFocusedElement&&this._lastFocusedElement.offsetParent&&(t=this._lastFocusedElement);const r=i.a(this._getElement(this.props.overrideFocusId));if(t||(t=r.editableElement||r.focusableElement),!t&&this.props.defaultFocusId){const e=this._getElement(this.props.defaultFocusId);if(e){const n=i.a(e);t=n.editableElement||n.focusableElement}}if(!t&&this.props.defaultFocusSelector){const e=document.querySelector(this.props.defaultFocusSelector);if(e){const n=i.a(e);t=n.editableElement||n.focusableElement}}t||(this._recalculateFirstAndLastFocusableElement(),t=this._firstEditableElement||this._firstFocusableElement),t&&(i.c(t)?Object(o.b)(()=>this._setFirstFocusToContext(t,n),"Automatically set focus on desired element (AccessibilityManager)"):this._setFirstFocusToContext(t,n))}_setFirstFocusToContext(e,t){if(e&&this._isActive){const n=this._getElement(this._rootElementIdInternal);if(null==n?void 0:n.contains(e)){this.props.isModal&&(null==n?void 0:n.contains(document.activeElement))&&!t||(e.focus(),this._lastFocusedElement=e)}}}_getElement(e){return null==e?null:document.getElementById(e)}_recalculateFirstAndLastFocusableElement(){const e=document.getElementById(this._rootElementIdInternal);this._firstEditableElement=null,this._firstFocusableElement=null,this._lastFocusableElement=null,e&&(this._determineFirstFocusableAndEditableElementInSubtree(e),this._determineLastFocusableElementInSubTree(e))}_determineFirstFocusableAndEditableElementInSubtree(e){const{focusableElement:t,editableElement:n}=i.a(e);this._firstEditableElement=n,this._firstFocusableElement=t}_determineLastFocusableElementInSubTree(e){this._lastFocusableElement=i.b(e)}_removeTrapFocusForModalDialog(){if(this.props.isModal&&this.props.shouldManageFocus){const e=document.getElementById(this._rootElementIdInternal);if(e){const t=e.parentNode.querySelectorAll(`[${s.a}]`);for(let e=t.length-1;e>=0;e--)t[e].parentNode.removeChild(t[e])}}}_trapFocusForModalDialog(){if(this.props.isModal&&this.props.shouldManageFocus){const e=document.getElementById(this._rootElementIdInternal);e&&(this._makeAccessibilityButton(e,!0),this._makeAccessibilityButton(e,!1))}}_makeAccessibilityButton(e,t){const n=document.createElement("div");n.style.width="1px",n.style.height="1px",n.style.outline="0px",n.style.position="absolute",n.style.opacity="0",n.style.left="0",n.tabIndex=0,n.setAttribute("aria-hidden","true"),n.setAttribute(s.a,"true"),n.setAttribute(s.b,t?"first":"last"),n.addEventListener("focusin",this._onFocusForFakeButton),t?(n.style.top="0",e.parentNode.insertBefore(n,e)):(n.style.bottom="0",e.parentNode.appendChild(n))}_onFocusForFakeButton(e){if(!this._isActive)return;this._recalculateFirstAndLastFocusableElement();const t="first"===e.target.getAttribute(s.b)?this._lastFocusableElement:this._firstFocusableElement;t&&t.focus(),e.preventDefault(),e.stopPropagation()}_removeFocusAndBlurHandlers(){if(!this.props.shouldManageFocus)return;const e=document.getElementById(this._rootElementIdInternal);e&&e.children&&(e.removeEventListener("focus",this._elementFocusedHandler,!0),e.removeEventListener("blur",this._elementBlurredHandler,!0),e.removeEventListener("focus",this._rootElementInActiveFocusedHandler,!0))}_applyFocusAndBlurHandlers(){if(!this.props.shouldManageFocus)return;const e=document.getElementById(this._rootElementIdInternal);e&&e.children&&(e.addEventListener("focus",this._elementFocusedHandler,!0),e.addEventListener("blur",this._elementBlurredHandler,!0))}_applyFocusHandlerWhenInactive(){if(!this.props.shouldManageFocus)return;const e=document.getElementById(this._rootElementIdInternal);e&&e.children&&e.addEventListener("focus",this._rootElementInActiveFocusedHandler,!0)}_elementBlurredHandler(e){if(!this._isActive)return;const t=e.target;i.d(t)&&(this._lastFocusedElement=t)}_elementFocusedHandler(e){if(!this._isActive)return;const t=e.srcElement;i.d(t)&&(this._lastFocusedElement=t)}_rootElementInActiveFocusedHandler(e){const t=this.context;t&&t.accessibilityComponentStack&&t.accessibilityComponentStack.redetermineFocusOnCurrentContext()}gotoFirstFocusableElement(){if(this._rootElementIdInternal){this._recalculateFirstAndLastFocusableElement();const e=this._firstEditableElement||this._firstFocusableElement;e&&e.focus()}}}c.displayName="AccessibilityComponent",c.contextType=a.a},FkJY:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("nA3O"),a=n("8uvO");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class i extends r.a{get_version(){return this.getValue(i.versionProperty)}set_version(e){return this.setValue(i.versionProperty,e),e}}i.versionProperty=new a.a("Version",String,i,"")},Fn5S:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n("eXjw");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e){return e&&e.metadata&&e.metadata.taskBasedFlowGlobalMenu&&e.metadata.taskBasedFlowGlobalMenu.initialized?e.metadata.taskBasedFlowGlobalMenu:null}function i(e){const t=a(e);return t?t.initialized:r.a.Uninitialized}function o(e){return e.metadata.taskBasedFlowGlobalMenu.display||!1}},Fn63:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i})),function(e){e[e.Expanded=0]="Expanded",e[e.UpArrowHead=1]="UpArrowHead",e[e.LeftArrowHead=2]="LeftArrowHead",e[e.Collapsed=3]="Collapsed",e[e.Edit=4]="Edit",e[e.Save=5]="Save",e[e.Delete=6]="Delete",e[e.Remove=7]="Remove",e[e.Add=8]="Add",e[e.Cancel=9]="Cancel",e[e.HandClick=10]="HandClick",e[e.Accept=11]="Accept",e[e.More=12]="More",e[e.Forward=13]="Forward",e[e.Favorite=14]="Favorite",e[e.Placeholder=15]="Placeholder",e[e.RatingFull=16]="RatingFull",e[e.RatingEmpty=17]="RatingEmpty",e[e.Options=18]="Options",e[e.Manage=19]="Manage",e[e.Settings=20]="Settings",e[e.Find=21]="Find",e[e.Help=22]="Help",e[e.ViewNotifications=23]="ViewNotifications",e[e.StageAdvance=24]="StageAdvance",e[e.CheckMark=25]="CheckMark",e[e.Locked=26]="Locked",e[e.Lock=27]="Lock",e[e.MoreOptions=28]="MoreOptions",e[e.ContactInfo=29]="ContactInfo",e[e.Pin=30]="Pin",e[e.Unpin=31]="Unpin",e[e.Refresh=32]="Refresh",e[e.Details=33]="Details",e[e.VisualFilter=34]="VisualFilter",e[e.GlobalFilter=35]="GlobalFilter",e[e.Diamond=36]="Diamond",e[e.ApplyFilter=37]="ApplyFilter",e[e.CancelFilter=38]="CancelFilter",e[e.StreamView=39]="StreamView",e[e.TileView=40]="TileView",e[e.Import=41]="Import",e[e.Tools=42]="Tools",e[e.Attach=43]="Attach",e[e.Filter=44]="Filter",e[e.Copy=45]="Copy",e[e.HighPriority=46]="HighPriority",e[e.ReduceTile=47]="ReduceTile",e[e.ExpandTile=48]="ExpandTile",e[e.GlobalFilterExpand=49]="GlobalFilterExpand",e[e.GlobalFilterCollapse=50]="GlobalFilterCollapse",e[e.Clear=51]="Clear",e[e.Post=52]="Post",e[e.OneNote=53]="OneNote",e[e.Home=54]="Home",e[e.SetAsHome=55]="SetAsHome",e[e.BackButton=56]="BackButton",e[e.BackButtonWithoutBorder=57]="BackButtonWithoutBorder",e[e.UpArrow=58]="UpArrow",e[e.DownArrow=59]="DownArrow",e[e.SetActiveButton=60]="SetActiveButton",e[e.SearchButton=61]="SearchButton",e[e.ForwardButton=62]="ForwardButton",e[e.Mail=63]="Mail",e[e.CheckedMail=64]="CheckedMail",e[e.FailedMail=65]="FailedMail",e[e.Phone=66]="Phone",e[e.Chat=67]="Chat",e[e.OpenPane=68]="OpenPane",e[e.ClosePane=69]="ClosePane",e[e.AddFriend=70]="AddFriend",e[e.Arrow=71]="Arrow",e[e.DropdownArrow=72]="DropdownArrow",e[e.FlsLocked=73]="FlsLocked",e[e.LinkArticle=74]="LinkArticle",e[e.UnlinkArticle=75]="UnlinkArticle",e[e.CopyLink=76]="CopyLink",e[e.EmailLink=77]="EmailLink",e[e.Share=78]="Share",e[e.Assign=79]="Assign",e[e.Connect=80]="Connect",e[e.Opportunity=81]="Opportunity",e[e.Appointment=82]="Appointment",e[e.Task=83]="Task",e[e.Case=84]="Case",e[e.PhoneCallIncoming=85]="PhoneCallIncoming",e[e.PhoneCallOutgoing=86]="PhoneCallOutgoing",e[e.EmailIncoming=87]="EmailIncoming",e[e.EmailOutgoing=88]="EmailOutgoing",e[e.SendEmail=89]="SendEmail",e[e.ApplyTemplate=90]="ApplyTemplate",e[e.InsertKbArticle=91]="InsertKbArticle",e[e.SendSelected=92]="SendSelected",e[e.SaveAndClose=93]="SaveAndClose",e[e.ReplyEmail=94]="ReplyEmail",e[e.ReplyAllEmail=95]="ReplyAllEmail",e[e.ForwardEmail=96]="ForwardEmail",e[e.Close=97]="Close",e[e.Activate=98]="Activate",e[e.DeActivate=99]="DeActivate",e[e.DeleteBulk=100]="DeleteBulk",e[e.SocialActivityIncoming=101]="SocialActivityIncoming",e[e.SocialActivityOutgoing=102]="SocialActivityOutgoing",e[e.CustomActivity=103]="CustomActivity",e[e.SystemPost=104]="SystemPost",e[e.Convert=105]="Convert",e[e.MarkAsWon=106]="MarkAsWon",e[e.MarkAsLost=107]="MarkAsLost",e[e.SetRegarding=108]="SetRegarding",e[e.SaveAsComplete=109]="SaveAsComplete",e[e.SwitchProcess=110]="SwitchProcess",e[e.Recalculate=111]="Recalculate",e[e.SendDirectEmail=112]="SendDirectEmail",e[e.OpenMailbox=113]="OpenMailbox",e[e.ReOpenOpportunity=114]="ReOpenOpportunity",e[e.ReactivateLead=115]="ReactivateLead",e[e.Disqualify=116]="Disqualify",e[e.Qualify=117]="Qualify",e[e.SelectView=118]="SelectView",e[e.SelectChart=119]="SelectChart",e[e.OpenInBrowser=120]="OpenInBrowser",e[e.NewAppointment=121]="NewAppointment",e[e.NewRecurringAppointment=122]="NewRecurringAppointment",e[e.NewPhoneCall=123]="NewPhoneCall",e[e.NewTask=124]="NewTask",e[e.NewEmail=125]="NewEmail",e[e.AddExisting=126]="AddExisting",e[e.SaveAndEdit=127]="SaveAndEdit",e[e.Default=128]="Default",e[e.ScrollRight=129]="ScrollRight",e[e.ScrollLeft=130]="ScrollLeft",e[e.SaveAndRunRoutingRule=131]="SaveAndRunRoutingRule",e[e.RunRoutingRule=132]="RunRoutingRule",e[e.ResolveCase=133]="ResolveCase",e[e.CancelCase=134]="CancelCase",e[e.ReactivateCase=135]="ReactivateCase",e[e.AddToQueue=136]="AddToQueue",e[e.CreateChildCase=137]="CreateChildCase",e[e.QueueItemRoute=138]="QueueItemRoute",e[e.QueueItemRelease=139]="QueueItemRelease",e[e.QueueItemRemove=140]="QueueItemRemove",e[e.QueueItemPick=141]="QueueItemPick",e[e.Drilldown=142]="Drilldown",e[e.PopOverButton=143]="PopOverButton",e[e.ExitButton=144]="ExitButton",e[e.ExportToExcel=145]="ExportToExcel",e[e.WordTemplates=146]="WordTemplates",e[e.DocumentTemplates=147]="DocumentTemplates",e[e.OpenInPowerBI=148]="OpenInPowerBI",e[e.OpenPowerBIReport=149]="OpenPowerBIReport",e[e.OpenDelve=150]="OpenDelve",e[e.ArticleLink=151]="ArticleLink",e[e.ArchiveArticle=152]="ArchiveArticle",e[e.ApproveArticle=153]="ApproveArticle",e[e.DiscardArticle=154]="DiscardArticle",e[e.Minor=155]="Minor",e[e.Major=156]="Major",e[e.PublishKnowledgeArticle=157]="PublishKnowledgeArticle",e[e.RelateArticle=158]="RelateArticle",e[e.RelateProduct=159]="RelateProduct",e[e.RestoreArticle=160]="RestoreArticle",e[e.RevertToDraftArticle=161]="RevertToDraftArticle",e[e.Translate=162]="Translate",e[e.UpdateArticle=163]="UpdateArticle",e[e.RemoveFilter=164]="RemoveFilter",e[e.Article=165]="Article",e[e.Graph=166]="Graph",e[e.CSR=167]="CSR",e[e.MembersIcon=168]="MembersIcon",e[e.QueueIcon=169]="QueueIcon",e[e.SiteMap=170]="SiteMap",e[e.NormalPriority=171]="NormalPriority",e[e.LowPriority=172]="LowPriority",e[e.ViewIcon=173]="ViewIcon",e[e.RecentCases=174]="RecentCases",e[e.KBRecords=175]="KBRecords",e[e.NumberOfViews=176]="NumberOfViews",e[e.ResizeHandle=177]="ResizeHandle",e[e.TaskBasedFlow=178]="TaskBasedFlow",e[e.InformationIcon=179]="InformationIcon",e[e.PencilIcon=180]="PencilIcon",e[e.ErrorIcon=181]="ErrorIcon",e[e.SuccessIcon=182]="SuccessIcon",e[e.OptionsetIcon=183]="OptionsetIcon",e[e.NotificationIcon=184]="NotificationIcon",e[e.PanelHeaderImportDataIcon=185]="PanelHeaderImportDataIcon",e[e.SidePanelUpload=186]="SidePanelUpload",e[e.New=187]="New",e[e.DetailsPageClose=188]="DetailsPageClose",e[e.SettingsListIcon=189]="SettingsListIcon",e[e.ListIcon=190]="ListIcon",e[e.ForwardDisable=191]="ForwardDisable",e[e.PdfIconFile=192]="PdfIconFile",e[e.PresentationFile=193]="PresentationFile",e[e.OneNoteFile=194]="OneNoteFile",e[e.AccessFile=195]="AccessFile",e[e.VisioFile=196]="VisioFile",e[e.ProjectFile=197]="ProjectFile",e[e.Plus=198]="Plus",e[e.ChevronUp=199]="ChevronUp",e[e.ChevronDown=200]="ChevronDown",e[e.HappySmiley=201]="HappySmiley",e[e.SadSmiley=202]="SadSmiley",e[e.CaseResolution=203]="CaseResolution",e[e.CampaignResolution=204]="CampaignResolution",e[e.ServiceActivity=205]="ServiceActivity",e[e.Notes=206]="Notes",e[e.Audio=207]="Audio",e[e.Camera=208]="Camera",e[e.Video=209]="Video",e[e.Image=210]="Image",e[e.Html=211]="Html",e[e.SharePointEditDocument=212]="SharePointEditDocument",e[e.SharePointDeleteDocument=213]="SharePointDeleteDocument",e[e.SharePointCheckoutDocument=214]="SharePointCheckoutDocument",e[e.SharePointCheckinDocument=215]="SharePointCheckinDocument",e[e.SharePointEditDocumentProperties=216]="SharePointEditDocumentProperties",e[e.SharePointDiscardCheckoutDocument=217]="SharePointDiscardCheckoutDocument",e[e.SharePointNewDocument=218]="SharePointNewDocument",e[e.SharePointNewWordDocument=219]="SharePointNewWordDocument",e[e.SharePointNewExcelDocument=220]="SharePointNewExcelDocument",e[e.SharePointNewPowerPointDocument=221]="SharePointNewPowerPointDocument",e[e.SharePointNewOneNoteDocument=222]="SharePointNewOneNoteDocument",e[e.SharePointUploadDocument=223]="SharePointUploadDocument",e[e.SharePointChangeLocation=224]="SharePointChangeLocation",e[e.SharePointAddDocumentLocation=225]="SharePointAddDocumentLocation",e[e.SharePointEditLocation=226]="SharePointEditLocation",e[e.SharePointOpenLocation=227]="SharePointOpenLocation",e[e.SharePointOpenDocument=228]="SharePointOpenDocument",e[e.SendByEmail=229]="SendByEmail",e[e.CreateQuote=230]="CreateQuote",e[e.Reply=231]="Reply",e[e.Warning=232]="Warning",e[e.Play=233]="Play",e[e.ExpandButton=234]="ExpandButton",e[e.AssociatedArticle=235]="AssociatedArticle",e[e.DisassociatedArticle=236]="DisassociatedArticle",e[e.FormDesign=237]="FormDesign",e[e.GlobalFilterClearAll=238]="GlobalFilterClearAll",e[e.GlobalFilterExpandedRow=239]="GlobalFilterExpandedRow",e[e.GlobalFilterCollapsedRow=240]="GlobalFilterCollapsedRow",e[e.RelationshipAssistant=241]="RelationshipAssistant",e[e.AutomaticSuggestions=242]="AutomaticSuggestions",e[e.SemanticZoom=243]="SemanticZoom",e[e.SemanticZoomMirrored=244]="SemanticZoomMirrored",e[e.BackwardButton=245]="BackwardButton",e[e.MultiSelect=246]="MultiSelect",e[e.MultiSelectMirrored=247]="MultiSelectMirrored",e[e.Spinning=248]="Spinning",e[e.RetireProduct=249]="RetireProduct",e[e.AddProduct=250]="AddProduct",e[e.OfflineStatus=251]="OfflineStatus",e[e.Abandon=252]="Abandon",e[e.Reactivate=253]="Reactivate",e[e.FinishStage=254]="FinishStage",e[e.SortButton=255]="SortButton",e[e.Flows=256]="Flows",e[e.OpenEntityRecord=257]="OpenEntityRecord",e[e.View=258]="View",e[e.CreateView=259]="CreateView",e[e.EditView=260]="EditView",e[e.GuestUser=261]="GuestUser",e[e.History=262]="History",e[e.ReassignRecords=263]="ReassignRecords",e[e.ManageRoles=264]="ManageRoles",e[e.JoinTeams=265]="JoinTeams",e[e.ChangeManager=266]="ChangeManager",e[e.AddMembers=267]="AddMembers",e[e.RemoveMembers=268]="RemoveMembers",e[e.Download=269]="Download",e[e.SetAsDefaultView=270]="SetAsDefaultView",e[e.Pinned=271]="Pinned",e[e.DistributionList=272]="DistributionList",e[e.MergeRecords=273]="MergeRecords",e[e.AssociateChildCase=274]="AssociateChildCase",e[e.SetAsDefault=275]="SetAsDefault",e[e.ConvertKnowledgeArticle=276]="ConvertKnowledgeArticle",e[e.Messenger=277]="Messenger",e[e.AssociateCategory=278]="AssociateCategory",e[e.OfficeWaffle=279]="OfficeWaffle",e[e.TripleColumn=280]="TripleColumn",e[e.Tiles=281]="Tiles",e[e.HideVisualFilter=282]="HideVisualFilter",e[e.InteractiveDashboard=283]="InteractiveDashboard",e[e.Dynamics365=284]="Dynamics365",e[e.SalesLiterature=285]="SalesLiterature",e[e.SelectButton=286]="SelectButton",e[e.SelectButtonRTL=287]="SelectButtonRTL",e[e.LockPricing=288]="LockPricing",e[e.CreateInvoice=289]="CreateInvoice",e[e.FulfillOrder=290]="FulfillOrder",e[e.CancelInvoice=291]="CancelInvoice",e[e.ActivateQuote=292]="ActivateQuote",e[e.InvoicePaid=293]="InvoicePaid",e[e.GetProducts=294]="GetProducts",e[e.UnlockPricing=295]="UnlockPricing",e[e.Checkbox=296]="Checkbox",e[e.CheckboxComposite=297]="CheckboxComposite",e[e.RightChevron=298]="RightChevron",e[e.LeftChevron=299]="LeftChevron",e[e.UntrackedEmail=300]="UntrackedEmail",e[e.OpenEmail=301]="OpenEmail",e[e.GlobalFilterCollapsedRowRTL=302]="GlobalFilterCollapsedRowRTL",e[e.CancelOrder=303]="CancelOrder",e[e.URL=304]="URL",e[e.Ticker=305]="Ticker",e[e.UseCurrentPricing=306]="UseCurrentPricing",e[e.Process=307]="Process",e[e.FirstPageButton=308]="FirstPageButton",e[e.LinkedInLogo=309]="LinkedInLogo",e[e.Health=310]="Health",e[e.Family=311]="Family",e[e.Sports=312]="Sports",e[e.Entertainment=313]="Entertainment",e[e.OOF=314]="OOF",e[e.CarouselView=315]="CarouselView",e[e.HeartEmpty=316]="HeartEmpty",e[e.HeartFilled=317]="HeartFilled",e[e.Follow=318]="Follow",e[e.RunQuery=319]="RunQuery",e[e.GroupAnd=320]="GroupAnd",e[e.GroupOr=321]="GroupOr",e[e.Ungroup=322]="Ungroup",e[e.HideInSimpleMode=323]="HideInSimpleMode",e[e.ShowInSimpleMode=324]="ShowInSimpleMode",e[e.PinnedSolid=325]="PinnedSolid",e[e.FilterSolid=326]="FilterSolid",e[e.Bot=327]="Bot",e[e.SystemDocumentTemplates=328]="SystemDocumentTemplates",e[e.MyDocumentTemplates=329]="MyDocumentTemplates",e[e.ViewAllMyDocumentTemplates=330]="ViewAllMyDocumentTemplates",e[e.EnableSecurityRoles=331]="EnableSecurityRoles",e[e.DocumentTemplateUpload=332]="DocumentTemplateUpload",e[e.DocumentTemplateEdit=333]="DocumentTemplateEdit",e[e.DocumentTemplateActivate=334]="DocumentTemplateActivate",e[e.DocumentTemplateDeactivate=335]="DocumentTemplateDeactivate",e[e.YammerIcon=336]="YammerIcon",e[e.StopIcon=337]="StopIcon",e[e.ReplaceContentIcon=338]="ReplaceContentIcon",e[e.CloseDateComingSoon=339]="CloseDateComingSoon",e[e.NearbyCustomers=340]="NearbyCustomers",e[e.RelevantNews=341]="RelevantNews",e[e.UpcomingMeeting=342]="UpcomingMeeting",e[e.RecentMeeting=343]="RecentMeeting",e[e.ReminderWithCall=344]="ReminderWithCall",e[e.CardsTask=345]="CardsTask",e[e.CardsQuote=346]="CardsQuote",e[e.CardsOpportunity=347]="CardsOpportunity",e[e.CardsInvoice=348]="CardsInvoice",e[e.CardsDashboard=349]="CardsDashboard",e[e.CardsLeads=350]="CardsLeads",e[e.OpportunityNoActivity=351]="OpportunityNoActivity",e[e.CaseNoActivity=352]="CaseNoActivity",e[e.CompetitorMentioned=353]="CompetitorMentioned",e[e.MeetingRequest=354]="MeetingRequest",e[e.MissedCloseDate=355]="MissedCloseDate",e[e.IssueDetection=356]="IssueDetection",e[e.NoActivityWithAccount=357]="NoActivityWithAccount",e[e.YesNo=358]="YesNo",e[e.AgendaActivityServiceAppointment=359]="AgendaActivityServiceAppointment",e[e.AgendaActivityFax=360]="AgendaActivityFax",e[e.UpcomingFlight=361]="UpcomingFlight",e[e.OpportunityAtRiskSentiment=362]="OpportunityAtRiskSentiment",e[e.IconDue=363]="IconDue",e[e.AddProductFamily=364]="AddProductFamily",e[e.AddProductBundle=365]="AddProductBundle",e[e.ProductPublish=366]="ProductPublish",e[e.CloneProduct=367]="CloneProduct",e[e.CloseGoal=368]="CloseGoal",e[e.AlignWithFiscalPeriod=369]="AlignWithFiscalPeriod",e[e.Connection=370]="Connection",e[e.ConnectionToMe=371]="ConnectionToMe",e[e.ConnectionToOther=372]="ConnectionToOther",e[e.ProductUpsell=373]="ProductUpsell",e[e.SubscriptionAdd=374]="SubscriptionAdd",e[e.RefreshDevice=375]="RefreshDevice",e[e.BulletListRemove=376]="BulletListRemove",e[e.BulletListAdd=377]="BulletListAdd",e[e.ScatterChart=378]="ScatterChart",e[e.BarChartHorizontal=379]="BarChartHorizontal",e[e.BarChartVertical=380]="BarChartVertical",e[e.FunnelChart=381]="FunnelChart",e[e.PieDouble=382]="PieDouble",e[e.AALinkedInLogo=383]="AALinkedInLogo",e[e.SendAndClose=384]="SendAndClose",e[e.AdvFind=385]="AdvFind",e[e.DoubleChevronLeft=386]="DoubleChevronLeft",e[e.DoubleChevronRight=387]="DoubleChevronRight",e[e.AreaChart=388]="AreaChart",e[e.DonutChart=389]="DonutChart",e[e.TagChart=390]="TagChart",e[e.Teaser=391]="Teaser",e[e.Clone=392]="Clone",e[e.AreaChartMirrored=393]="AreaChartMirrored",e[e.BarChartHorizontalMirrored=394]="BarChartHorizontalMirrored",e[e.BarChartVerticalMirrored=395]="BarChartVerticalMirrored",e[e.People=396]="People",e[e.PeopleBlock=397]="PeopleBlock",e[e.BulletListDownArrow=398]="BulletListDownArrow",e[e.Recent=399]="Recent",e[e.SharePointIcon=400]="SharePointIcon",e[e.OneDriveIcon=401]="OneDriveIcon",e[e.FolderSharedIcon=402]="FolderSharedIcon",e[e.MSTeamsIcon=403]="MSTeamsIcon",e[e.ScrollUpDown=404]="ScrollUpDown",e[e.SendToCTI=405]="SendToCTI",e[e.CreateQuickCampaign=406]="CreateQuickCampaign",e[e.PageSolid=407]="PageSolid",e[e.Page=408]="Page",e[e.OpportunitiesList=409]="OpportunitiesList",e[e.BrowseCards=410]="BrowseCards",e[e.Letter=411]="Letter",e[e.Fax=412]="Fax",e[e.NewLetter=413]="NewLetter",e[e.NewFax=414]="NewFax",e[e.LetterIncoming=415]="LetterIncoming",e[e.LetterOutgoing=416]="LetterOutgoing",e[e.FaxIncoming=417]="FaxIncoming",e[e.FaxOutgoing=418]="FaxOutgoing",e[e.CreatePersonalView=419]="CreatePersonalView",e[e.ViewHierarchy=420]="ViewHierarchy",e[e.ProductPreview=421]="ProductPreview",e[e.AddTerritoryMember=422]="AddTerritoryMember",e[e.RemoveTerritoryMember=423]="RemoveTerritoryMember",e[e.Report=424]="Report",e[e.NewServiceActivity=425]="NewServiceActivity",e[e.Recurrence=426]="Recurrence",e[e.EditSeries=427]="EditSeries",e[e.EndSeries=428]="EndSeries",e[e.EditDefaultFilter=429]="EditDefaultFilter",e[e.QueueItemDetail=430]="QueueItemDetail",e[e.ThumbsUp=431]="ThumbsUp",e[e.ThumbsDown=432]="ThumbsDown",e[e.Lead=433]="Lead",e[e.TableLink=434]="TableLink",e[e.TableGroup=435]="TableGroup",e[e.ClearDefault=436]="ClearDefault",e[e.SetDefault=437]="SetDefault",e[e.SaveFilterToNewPersonalView=438]="SaveFilterToNewPersonalView",e[e.SaveFilterToCurrentPersonalView=439]="SaveFilterToCurrentPersonalView",e[e.Expand=440]="Expand",e[e.ChromeMinimize=441]="ChromeMinimize",e[e.ChromeMaximize=442]="ChromeMaximize",e[e.ConnectionRoleManageRecordType=443]="ConnectionRoleManageRecordType",e[e.Sync=444]="Sync",e[e.ThumbsUpSolid=445]="ThumbsUpSolid",e[e.ThumbsDownSolid=446]="ThumbsDownSolid",e[e.msdyn_enhancedsla=447]="msdyn_enhancedsla",e[e.msdyn_enhancedslakpi=448]="msdyn_enhancedslakpi",e[e.msdyn_enhancedslakpiinstance=449]="msdyn_enhancedslakpiinstance",e[e.CreateOrder=450]="CreateOrder",e[e.Revise=451]="Revise",e[e.CloseQuote=452]="CloseQuote",e[e.CommandChecker=453]="CommandChecker",e[e.MiniContract=454]="MiniContract",e[e.MiniExpand=455]="MiniExpand",e[e.Print=456]="Print",e[e.NoDataAvailable=457]="NoDataAvailable",e[e.MoreVertical=458]="MoreVertical",e[e.OpenInNewWindow=459]="OpenInNewWindow",e[e.EditEvent=460]="EditEvent",e[e.LinkToRecord=461]="LinkToRecord",e[e.UnlinkFromRecord=462]="UnlinkFromRecord",e[e.KnowledgeSearch=463]="KnowledgeSearch",e[e.ChevronDownMed=464]="ChevronDownMed",e[e.OpenFolderHorizontal=465]="OpenFolderHorizontal",e[e.TaskClipboard=466]="TaskClipboard",e[e.CustomList=467]="CustomList",e[e.ExpandAllRecords=468]="ExpandAllRecords",e[e.CollapseAllRecords=469]="CollapseAllRecords",e[e.SelectAll=470]="SelectAll",e[e.Embed=471]="Embed",e[e.MailTemplate=472]="MailTemplate",e[e.Monitor=473]="Monitor",e[e.Error=474]="Error",e[e.CustomEntity=475]="CustomEntity",e[e.EventAccepted=476]="EventAccepted",e[e.ClosePaneMirrored=477]="ClosePaneMirrored",e[e.RollupQuery=478]="RollupQuery",e[e.FontColor=479]="FontColor",e[e.AlignJustify=480]="AlignJustify",e[e.NumberedList=481]="NumberedList",e[e.Omega=482]="Omega",e[e.LineSpacing=483]="LineSpacing",e[e.Spelling=484]="Spelling",e[e.Strikethrough=485]="Strikethrough",e[e.Code=486]="Code",e[e.IncreaseIndent=487]="IncreaseIndent",e[e.DecreaseIndent=488]="DecreaseIndent",e[e.Subscript=489]="Subscript",e[e.Superscript=490]="Superscript",e[e.AllinOnePC=491]="AllinOnePC",e[e.ButtonControl=492]="ButtonControl",e[e.LineFocus1=493]="LineFocus1",e[e.CodeEdit=494]="CodeEdit",e[e.QRCode=495]="QRCode",e[e.CloudUpload=496]="CloudUpload",e[e.TextAlignLeft=497]="TextAlignLeft",e[e.TextAlignCenter=498]="TextAlignCenter",e[e.TextAlignRight=499]="TextAlignRight",e[e.TextAlignJustify=500]="TextAlignJustify",e[e.BulletedList=501]="BulletedList",e[e.Anchor=502]="Anchor",e[e.ClearNight=503]="ClearNight",e[e.SearchCampaigns=504]="SearchCampaigns",e[e.FileCode=505]="FileCode",e[e.DockBottom=506]="DockBottom",e[e.DockLeft=507]="DockLeft",e[e.DockRight=508]="DockRight",e[e.Brightness=509]="Brightness",e[e.AlignHorizontalLeft=510]="AlignHorizontalLeft",e[e.AlignHorizontalCenter=511]="AlignHorizontalCenter",e[e.AlignHorizontalRight=512]="AlignHorizontalRight",e[e.AlignVerticalTop=513]="AlignVerticalTop",e[e.AlignVerticalCenter=514]="AlignVerticalCenter",e[e.AlignVerticalBottom=515]="AlignVerticalBottom",e[e.SidePanelMirrored=516]="SidePanelMirrored",e[e.BackButtonRTL=517]="BackButtonRTL",e[e.InstagramIcon=518]="InstagramIcon",e[e.Bookmark=519]="Bookmark",e[e.RatingFullGrey=520]="RatingFullGrey",e[e.ContactSolid=521]="ContactSolid",e[e.ExploitProtectionSettings=522]="ExploitProtectionSettings",e[e.ColumnOptions=523]="ColumnOptions",e[e.CollaborationDisplay=524]="CollaborationDisplay"}(r||(r={}));var a={Expanded:"symbolFont Expanded-symbol",UpArrowHead:"symbolFont UpArrowHead-symbol",LeftArrowHead:"symbolFont LeftArrowHead-symbol",Collapsed:"symbolFont Collapsed-symbol",Edit:"symbolFont Edit-symbol",Save:"symbolFont Save-symbol",Delete:"symbolFont Delete-symbol",Remove:"symbolFont Remove-symbol",Add:"symbolFont Add-symbol",Cancel:"symbolFont Cancel-symbol",HandClick:"symbolFont HandClick-symbol",Accept:"symbolFont Accept-symbol",More:"symbolFont More-symbol",Forward:"symbolFont Forward-symbol",Favorite:"symbolFont Favorite-symbol",Placeholder:"symbolFont Placeholder-symbol",RatingFull:"symbolFont RatingFull-symbol",RatingEmpty:"symbolFont RatingEmpty-symbol",Options:"symbolFont Options-symbol",Manage:"symbolFont Manage-symbol",Settings:"symbolFont Settings-symbol",Find:"symbolFont Find-symbol",Help:"symbolFont Help-symbol",ViewNotifications:"symbolFont ViewNotifications-symbol",StageAdvance:"symbolFont StageAdvance-symbol",CheckMark:"symbolFont CheckMark-symbol",Locked:"symbolFont Locked-symbol",Lock:"symbolFont Lock-symbol",MoreOptions:"symbolFont MoreOptions-symbol",ContactInfo:"symbolFont ContactInfo-symbol",Pin:"symbolFont Pin-symbol",Unpin:"symbolFont Unpin-symbol",Refresh:"symbolFont Refresh-symbol",Details:"symbolFont Details-symbol",VisualFilter:"symbolFont VisualFilter-symbol",GlobalFilter:"symbolFont GlobalFilter-symbol",Diamond:"symbolFont Diamond-symbol",ApplyFilter:"symbolFont ApplyFilter-symbol",CancelFilter:"symbolFont CancelFilter-symbol",StreamView:"symbolFont StreamView-symbol",TileView:"symbolFont TileView-symbol",Import:"symbolFont Import-symbol",Tools:"symbolFont Tools-symbol",Attach:"symbolFont Attach-symbol",Filter:"symbolFont Filter-symbol",Copy:"symbolFont Copy-symbol",HighPriority:"symbolFont HighPriority-symbol",ReduceTile:"symbolFont ReduceTile-symbol",ExpandTile:"symbolFont ExpandTile-symbol",GlobalFilterExpand:"symbolFont GlobalFilterExpand-symbol",GlobalFilterCollapse:"symbolFont GlobalFilterCollapse-symbol",Clear:"symbolFont Clear-symbol",Post:"symbolFont Post-symbol",OneNote:"symbolFont OneNote-symbol",Home:"symbolFont Home-symbol",SetAsHome:"symbolFont SetAsHome-symbol",BackButton:"symbolFont BackButton-symbol",BackButtonWithoutBorder:"symbolFont BackButtonWithoutBorder-symbol",UpArrow:"symbolFont UpArrow-symbol",DownArrow:"symbolFont DownArrow-symbol",SetActiveButton:"symbolFont SetActiveButton-symbol",SearchButton:"symbolFont SearchButton-symbol",ForwardButton:"symbolFont ForwardButton-symbol",Mail:"symbolFont Mail-symbol",CheckedMail:"symbolFont CheckedMail-symbol",FailedMail:"symbolFont FailedMail-symbol",Phone:"symbolFont Phone-symbol",Chat:"symbolFont Chat-symbol",OpenPane:"symbolFont OpenPane-symbol",ClosePane:"symbolFont ClosePane-symbol",AddFriend:"symbolFont AddFriend-symbol",Arrow:"symbolFont Arrow-symbol",DropdownArrow:"symbolFont DropdownArrow-symbol",FlsLocked:"symbolFont FlsLocked-symbol",LinkArticle:"symbolFont LinkArticle-symbol",UnlinkArticle:"symbolFont UnlinkArticle-symbol",CopyLink:"symbolFont CopyLink-symbol",EmailLink:"symbolFont EmailLink-symbol",Share:"symbolFont Share-symbol",Assign:"symbolFont Assign-symbol",Connect:"symbolFont Connect-symbol",Opportunity:"symbolFont Opportunity-symbol",Appointment:"symbolFont Appointment-symbol",Task:"symbolFont Task-symbol",Case:"symbolFont Case-symbol",PhoneCallIncoming:"symbolFont PhoneCallIncoming-symbol",PhoneCallOutgoing:"symbolFont PhoneCallOutgoing-symbol",EmailIncoming:"symbolFont EmailIncoming-symbol",EmailOutgoing:"symbolFont EmailOutgoing-symbol",SendEmail:"symbolFont SendEmail-symbol",ApplyTemplate:"symbolFont ApplyTemplate-symbol",InsertKbArticle:"symbolFont InsertKbArticle-symbol",SendSelected:"symbolFont SendSelected-symbol",SaveAndClose:"symbolFont SaveAndClose-symbol",ReplyEmail:"symbolFont ReplyEmail-symbol",ReplyAllEmail:"symbolFont ReplyAllEmail-symbol",ForwardEmail:"symbolFont ForwardEmail-symbol",Close:"symbolFont Close-symbol",Activate:"symbolFont Activate-symbol",DeActivate:"symbolFont DeActivate-symbol",DeleteBulk:"symbolFont DeleteBulk-symbol",SocialActivityIncoming:"symbolFont SocialActivityIncoming-symbol",SocialActivityOutgoing:"symbolFont SocialActivityOutgoing-symbol",CustomActivity:"symbolFont CustomActivity-symbol",SystemPost:"symbolFont SystemPost-symbol",Convert:"symbolFont Convert-symbol",MarkAsWon:"symbolFont MarkAsWon-symbol",MarkAsLost:"symbolFont MarkAsLost-symbol",SetRegarding:"symbolFont SetRegarding-symbol",SaveAsComplete:"symbolFont SaveAsComplete-symbol",SwitchProcess:"symbolFont SwitchProcess-symbol",Recalculate:"symbolFont Recalculate-symbol",SendDirectEmail:"symbolFont SendDirectEmail-symbol",OpenMailbox:"symbolFont OpenMailbox-symbol",ReOpenOpportunity:"symbolFont ReOpenOpportunity-symbol",ReactivateLead:"symbolFont ReactivateLead-symbol",Disqualify:"symbolFont Disqualify-symbol",Qualify:"symbolFont Qualify-symbol",SelectView:"symbolFont SelectView-symbol",SelectChart:"symbolFont SelectChart-symbol",OpenInBrowser:"symbolFont OpenInBrowser-symbol",NewAppointment:"symbolFont NewAppointment-symbol",NewRecurringAppointment:"symbolFont NewRecurringAppointment-symbol",NewPhoneCall:"symbolFont NewPhoneCall-symbol",NewTask:"symbolFont NewTask-symbol",NewEmail:"symbolFont NewEmail-symbol",AddExisting:"symbolFont AddExisting-symbol",SaveAndEdit:"symbolFont SaveAndEdit-symbol",Default:"symbolFont Default-symbol",ScrollRight:"symbolFont ScrollRight-symbol",ScrollLeft:"symbolFont ScrollLeft-symbol",SaveAndRunRoutingRule:"symbolFont SaveAndRunRoutingRule-symbol",RunRoutingRule:"symbolFont RunRoutingRule-symbol",ResolveCase:"symbolFont ResolveCase-symbol",CancelCase:"symbolFont CancelCase-symbol",ReactivateCase:"symbolFont ReactivateCase-symbol",AddToQueue:"symbolFont AddToQueue-symbol",CreateChildCase:"symbolFont CreateChildCase-symbol",QueueItemRoute:"symbolFont QueueItemRoute-symbol",QueueItemRelease:"symbolFont QueueItemRelease-symbol",QueueItemRemove:"symbolFont QueueItemRemove-symbol",QueueItemPick:"symbolFont QueueItemPick-symbol",Drilldown:"symbolFont Drilldown-symbol",PopOverButton:"symbolFont PopOverButton-symbol",ExitButton:"symbolFont ExitButton-symbol",ExportToExcel:"symbolFont ExportToExcel-symbol",WordTemplates:"symbolFont WordTemplates-symbol",DocumentTemplates:"symbolFont DocumentTemplates-symbol",OpenInPowerBI:"symbolFont OpenInPowerBI-symbol",OpenPowerBIReport:"symbolFont OpenPowerBIReport-symbol",OpenDelve:"symbolFont OpenDelve-symbol",ArticleLink:"symbolFont ArticleLink-symbol",ArchiveArticle:"symbolFont ArchiveArticle-symbol",ApproveArticle:"symbolFont ApproveArticle-symbol",DiscardArticle:"symbolFont DiscardArticle-symbol",Minor:"symbolFont Minor-symbol",Major:"symbolFont Major-symbol",PublishKnowledgeArticle:"symbolFont PublishKnowledgeArticle-symbol",RelateArticle:"symbolFont RelateArticle-symbol",RelateProduct:"symbolFont RelateProduct-symbol",RestoreArticle:"symbolFont RestoreArticle-symbol",RevertToDraftArticle:"symbolFont RevertToDraftArticle-symbol",Translate:"symbolFont Translate-symbol",UpdateArticle:"symbolFont UpdateArticle-symbol",RemoveFilter:"symbolFont RemoveFilter-symbol",Article:"symbolFont Article-symbol",Graph:"symbolFont Graph-symbol",CSR:"symbolFont CSR-symbol",MembersIcon:"symbolFont MembersIcon-symbol",QueueIcon:"symbolFont QueueIcon-symbol",SiteMap:"symbolFont SiteMap-symbol",NormalPriority:"symbolFont NormalPriority-symbol",LowPriority:"symbolFont LowPriority-symbol",ViewIcon:"symbolFont ViewIcon-symbol",RecentCases:"symbolFont RecentCases-symbol",KBRecords:"symbolFont KBRecords-symbol",NumberOfViews:"symbolFont NumberOfViews-symbol",ResizeHandle:"symbolFont ResizeHandle-symbol",TaskBasedFlow:"symbolFont TaskBasedFlow-symbol",InformationIcon:"symbolFont InformationIcon-symbol",PencilIcon:"symbolFont PencilIcon-symbol",ErrorIcon:"symbolFont ErrorIcon-symbol",SuccessIcon:"symbolFont SuccessIcon-symbol",OptionsetIcon:"symbolFont OptionsetIcon-symbol",NotificationIcon:"symbolFont NotificationIcon-symbol",PanelHeaderImportDataIcon:"symbolFont PanelHeaderImportDataIcon-symbol",SidePanelUpload:"symbolFont SidePanelUpload-symbol",New:"symbolFont New-symbol",DetailsPageClose:"symbolFont DetailsPageClose-symbol",SettingsListIcon:"symbolFont SettingsListIcon-symbol",ListIcon:"symbolFont ListIcon-symbol",ForwardDisable:"symbolFont ForwardDisable-symbol",PdfIconFile:"symbolFont PdfIconFile-symbol",PresentationFile:"symbolFont PresentationFile-symbol",OneNoteFile:"symbolFont OneNoteFile-symbol",AccessFile:"symbolFont AccessFile-symbol",VisioFile:"symbolFont VisioFile-symbol",ProjectFile:"symbolFont ProjectFile-symbol",Plus:"symbolFont Plus-symbol",ChevronUp:"symbolFont ChevronUp-symbol",ChevronDown:"symbolFont ChevronDown-symbol",HappySmiley:"symbolFont HappySmiley-symbol",SadSmiley:"symbolFont SadSmiley-symbol",CaseResolution:"symbolFont CaseResolution-symbol",CampaignResolution:"symbolFont CampaignResolution-symbol",ServiceActivity:"symbolFont ServiceActivity-symbol",Notes:"symbolFont Notes-symbol",Audio:"symbolFont Audio-symbol",Camera:"symbolFont Camera-symbol",Video:"symbolFont Video-symbol",Image:"symbolFont Image-symbol",Html:"symbolFont Html-symbol",SharePointEditDocument:"symbolFont SharePointEditDocument-symbol",SharePointDeleteDocument:"symbolFont SharePointDeleteDocument-symbol",SharePointCheckoutDocument:"symbolFont SharePointCheckoutDocument-symbol",SharePointCheckinDocument:"symbolFont SharePointCheckinDocument-symbol",SharePointEditDocumentProperties:"symbolFont SharePointEditDocumentProperties-symbol",SharePointDiscardCheckoutDocument:"symbolFont SharePointDiscardCheckoutDocument-symbol",SharePointNewDocument:"symbolFont SharePointNewDocument-symbol",SharePointNewWordDocument:"symbolFont SharePointNewWordDocument-symbol",SharePointNewExcelDocument:"symbolFont SharePointNewExcelDocument-symbol",SharePointNewPowerPointDocument:"symbolFont SharePointNewPowerPointDocument-symbol",SharePointNewOneNoteDocument:"symbolFont SharePointNewOneNoteDocument-symbol",SharePointUploadDocument:"symbolFont SharePointUploadDocument-symbol",SharePointChangeLocation:"symbolFont SharePointChangeLocation-symbol",SharePointAddDocumentLocation:"symbolFont SharePointAddDocumentLocation-symbol",SharePointEditLocation:"symbolFont SharePointEditLocation-symbol",SharePointOpenLocation:"symbolFont SharePointOpenLocation-symbol",SharePointOpenDocument:"symbolFont SharePointOpenDocument-symbol",SendByEmail:"symbolFont SendByEmail-symbol",CreateQuote:"symbolFont CreateQuote-symbol",Reply:"symbolFont Reply-symbol",Warning:"symbolFont Warning-symbol",Play:"symbolFont Play-symbol",ExpandButton:"symbolFont ExpandButton-symbol",AssociatedArticle:"symbolFont AssociatedArticle-symbol",DisassociatedArticle:"symbolFont DisassociatedArticle-symbol",FormDesign:"symbolFont FormDesign-symbol",GlobalFilterClearAll:"symbolFont GlobalFilterClearAll-symbol",GlobalFilterExpandedRow:"symbolFont GlobalFilterExpandedRow-symbol",GlobalFilterCollapsedRow:"symbolFont GlobalFilterCollapsedRow-symbol",RelationshipAssistant:"symbolFont RelationshipAssistant-symbol",AutomaticSuggestions:"symbolFont AutomaticSuggestions-symbol",SemanticZoom:"symbolFont SemanticZoom-symbol",SemanticZoomMirrored:"symbolFont SemanticZoomMirrored-symbol",BackwardButton:"symbolFont BackwardButton-symbol",MultiSelect:"symbolFont MultiSelect-symbol",MultiSelectMirrored:"symbolFont MultiSelectMirrored-symbol",Spinning:"symbolFont Spinning-symbol",RetireProduct:"symbolFont RetireProduct-symbol",AddProduct:"symbolFont AddProduct-symbol",OfflineStatus:"symbolFont OfflineStatus-symbol",Abandon:"symbolFont Abandon-symbol",Reactivate:"symbolFont Reactivate-symbol",FinishStage:"symbolFont FinishStage-symbol",SortButton:"symbolFont SortButton-symbol",View:"symbolFont View-symbol",CreateView:"symbolFont CreateView-symbol",EditView:"symbolFont EditView-symbol",Flows:"symbolFont Flows-symbol",OpenEntityRecord:"symbolFont OpenEntityRecord-symbol",GuestUser:"symbolFont GuestUser-symbol",History:"symbolFont History-symbol",ReassignRecords:"symbolFont ReassignRecords-symbol",ManageRoles:"symbolFont ManageRoles-symbol",JoinTeams:"symbolFont JoinTeams-symbol",ChangeManager:"symbolFont ChangeManager-symbol",AddMembers:"symbolFont AddMembers-symbol",RemoveMembers:"symbolFont RemoveMembers-symbol",Download:"symbolFont Download-symbol",SetAsDefaultView:"symbolFont SetAsDefaultView-symbol",Pinned:"symbolFont Pinned-symbol",DistributionList:"symbolFont DistributionList-symbol",MergeRecords:"symbolFont MergeRecords-symbol",AssociateChildCase:"symbolFont AssociateChildCase-symbol",SetAsDefault:"symbolFont SetAsDefault-symbol",ConvertKnowledgeArticle:"symbolFont ConvertKnowledgeArticle-symbol",Messenger:"symbolFont Messenger-symbol",AssociateCategory:"symbolFont AssociateCategory-symbol",OfficeWaffle:"d365Shell OfficeWaffle-symbol",TripleColumn:"symbolFont TripleColumn-symbol",Tiles:"symbolFont Tiles-symbol",HideVisualFilter:"symbolFont HideVisualFilter-symbol",InteractiveDashboard:"symbolFont InteractiveDashboard-symbol",Dynamics365:"symbolFont Dynamics365-symbol",SalesLiterature:"symbolFont SalesLiterature-symbol",SelectButton:"symbolFont SelectButton-symbol",SelectButtonRTL:"symbolFont SelectButtonRTL-symbol",LockPricing:"symbolFont LockPricing-symbol",CreateInvoice:"symbolFont CreateInvoice-symbol",FulfillOrder:"symbolFont FulfillOrder-symbol",CancelInvoice:"symbolFont CancelInvoice-symbol",ActivateQuote:"symbolFont ActivateQuote-symbol",InvoicePaid:"symbolFont InvoicePaid-symbol",GetProducts:"symbolFont GetProducts-symbol",UnlockPricing:"symbolFont UnlockPricing-symbol",Checkbox:"symbolFont Checkbox-symbol",CheckboxComposite:"symbolFont CheckboxComposite-symbol",RightChevron:"symbolFont RightChevron-symbol",LeftChevron:"symbolFont LeftChevron-symbol",BackToStart:"symbolFont BackToStart-symbol",UntrackedEmail:"symbolFont UntrackedEmail-symbol",OpenEmail:"symbolFont OpenEmail-symbol",GlobalFilterCollapsedRowRTL:"symbolFont GlobalFilterCollapsedRowRTL-symbol",CancelOrder:"symbolFont CancelOrder-symbol",URL:"symbolFont URL-symbol",Ticker:"symbolFont Ticker-symbol",UseCurrentPricing:"symbolFont UseCurrentPricing-symbol",Process:"symbolFont Process-symbol",FirstPageButton:"symbolFont FirstPageButton-symbol",LinkedInLogo:"symbolFont LinkedInLogo-symbol",Health:"symbolFont Health-symbol",Family:"symbolFont Family-symbol",Sports:"symbolFont Sports-symbol",Entertainment:"symbolFont Entertainment-symbol",OOF:"symbolFont OOF-symbol",CarouselView:"symbolFont CarouselView-symbol",HeartEmpty:"symbolFont HeartEmpty-symbol",HeartFilled:"symbolFont HeartFilled-symbol",Follow:"symbolFont Follow-symbol",RunQuery:"symbolFont RunQuery-symbol",GroupAnd:"symbolFont GroupAnd-symbol",GroupOr:"symbolFont GroupOr-symbol",Ungroup:"symbolFont Ungroup-symbol",HideInSimpleMode:"symbolFont HideInSimpleMode-symbol",ShowInSimpleMode:"symbolFont ShowInSimpleMode-symbol",PinnedSolid:"symbolFont PinnedSolid-symbol",FilterSolid:"symbolFont FilterSolid-symbol",Bot:"symbolFont Bot-symbol",SystemDocumentTemplates:"symbolFont SystemDocumentTemplates-symbol",MyDocumentTemplates:"symbolFont MyDocumentTemplates-symbol",ViewAllMyDocumentTemplates:"symbolFont ViewAllMyDocumentTemplates-symbol",EnableSecurityRoles:"symbolFont EnableSecurityRoles-symbol",DocumentTemplateUpload:"symbolFont DocumentTemplateUpload-symbol",DocumentTemplateEdit:"symbolFont DocumentTemplateEdit-symbol",DocumentTemplateActivate:"symbolFont DocumentTemplateActivate-symbol",DocumentTemplateDeactivate:"symbolFont DocumentTemplateDeactivate-symbol",YammerIcon:"symbolFont YammerIcon-symbol",StopIcon:"symbolFont StopIcon-symbol",ReplaceContentIcon:"symbolFont ReplaceContentIcon-symbol",CloseDateComingSoon:"symbolFont CloseDateComingSoon-symbol",NearbyCustomers:"symbolFont NearbyCustomers-symbol",RelevantNews:"symbolFont RelevantNews-symbol",UpcomingMeeting:"symbolFont UpcomingMeeting-symbol",RecentMeeting:"symbolFont RecentMeeting-symbol",ReminderWithCall:"symbolFont ReminderWithCall-symbol",CardsTask:"symbolFont CardsTask-symbol",CardsQuote:"symbolFont CardsQuote-symbol",CardsOpportunity:"symbolFont CardsOpportunity-symbol",CardsInvoice:"symbolFont CardsInvoice-symbol",CardsDashboard:"symbolFont CardsDashboard-symbol",CardsLeads:"symbolFont CardsLeads-symbol",OpportunityNoActivity:"symbolFont OpportunityNoActivity-symbol",CaseNoActivity:"symbolFont CaseNoActivity-symbol",CompetitorMentioned:"symbolFont CompetitorMentioned-symbol",MeetingRequest:"symbolFont MeetingRequest-symbol",MissedCloseDate:"symbolFont MissedCloseDate-symbol",IssueDetection:"symbolFont IssueDetection-symbol",NoActivityWithAccount:"symbolFont NoActivityWithAccount-symbol",YesNo:"symbolFont YesNo-symbol",AgendaActivityServiceAppointment:"symbolFont AgendaActivityServiceAppointment-symbol",AgendaActivityFax:"symbolFont AgendaActivityFax-symbol",UpcomingFlight:"symbolFont UpcomingFlight-symbol",OpportunityAtRiskSentiment:"symbolFont OpportunityAtRiskSentiment-symbol",IconDue:"symbolFont IconDue-symbol",AddProductFamily:"symbolFont AddProductFamily-symbol",AddProductBundle:"symbolFont AddProductBundle-symbol",ProductPublish:"symbolFont ProductPublish-symbol",CloneProduct:"symbolFont CloneProduct-symbol",CloseGoal:"symbolFont CloseGoal-symbol",AlignWithFiscalPeriod:"symbolFont AlignWithFiscalPeriod-symbol",Connection:"symbolFont Connection-symbol",ConnectionToMe:"symbolFont ConnectionToMe-symbol",ConnectionToOther:"symbolFont ConnectionToOther-symbol",ProductUpsell:"symbolFont ProductUpsell-symbol",SubscriptionAdd:"symbolFont SubscriptionAdd-symbol",RefreshDevice:"symbolFont RefreshDevice-symbol",BulletListRemove:"symbolFont BulletListRemove-symbol",BulletListAdd:"symbolFont BulletListAdd-symbol",BulletListDownArrow:"symbolFont BulletListDownArrow-symbol",ScatterChart:"symbolFont ScatterChart-symbol",BarChartHorizontal:"symbolFont BarChartHorizontal-symbol",BarChartVertical:"symbolFont BarChartVertical-symbol",FunnelChart:"symbolFont FunnelChart-symbol",PieDouble:"symbolFont PieDouble-symbol",People:"symbolFont People-symbol",PeopleBlock:"symbolFont PeopleBlock-symbol",CreateQuickCampaign:"symbolFont CreateQuickCampaign-symbol",PageSolid:"symbolFont PageSolid-symbol",Page:"symbolFont Page-symbol",OpportunitiesList:"symbolFont OpportunitiesList-symbol",BrowseCards:"symbolFont BrowseCards-symbol",AALinkedInLogo:"symbolFont AALinkedInLogo-symbol",SendAndClose:"symbolFont SendAndClose-symbol",AdvFind:"symbolFont AdvFind-symbol",DoubleChevronLeft:"symbolFont DoubleChevronLeft-symbol",DoubleChevronRight:"symbolFont DoubleChevronRight-symbol",AreaChart:"symbolFont AreaChart-symbol",DonutChart:"symbolFont DonutChart-symbol",TagChart:"symbolFont TagChart-symbol",Teaser:"symbolFont Teaser-symbol",Clone:"symbolFont Clone-symbol",AreaChartMirrored:"symbolFont AreaChartMirrored-symbol",BarChartHorizontalMirrored:"symbolFont BarChartHorizontalMirrored-symbol",BarChartVerticalMirrored:"symbolFont BarChartVerticalMirrored-symbol",Recent:"symbolFont Recent-symbol",SharePointIcon:"symbolFont SharePointIcon-symbol",OneDriveIcon:"symbolFont OneDriveIcon-symbol",FolderSharedIcon:"symbolFont FolderSharedIcon-symbol",MSTeamsIcon:"symbolFont MSTeamsIcon-symbol",ScrollUpDown:"symbolFont AreaSwitcher-symbol",SendToCTI:"symbolFont SendToCTI-symbol",Letter:"symbolFont Letter-symbol",Fax:"symbolFont Fax-symbol",NewLetter:"symbolFont NewLetter-symbol",NewFax:"symbolFont NewFax-symbol",LetterIncoming:"symbolFont LetterIncoming-symbol",LetterOutgoing:"symbolFont LetterOutgoing-symbol",FaxIncoming:"symbolFont FaxIncoming-symbol",FaxOutgoing:"symbolFont FaxOutgoing-symbol",CreatePersonalView:"symbolFont CreatePersonalView-symbol",ViewHierarchy:"symbolFont ViewHierarchy-symbol",ProductPreview:"symbolFont ProductPreview-symbol",AddTerritoryMember:"symbolFont AddTerritoryMember-symbol",RemoveTerritoryMember:"symbolFont RemoveTerritoryMember-symbol",Report:"symbolFont Report-symbol",NewServiceActivity:"symbolFont NewServiceActivity-symbol",Recurrence:"symbolFont Recurrence-symbol",EditSeries:"symbolFont EditSeries-symbol",EndSeries:"symbolFont EndSeries-symbol",EditDefaultFilter:"symbolFont EditDefaultFilter-symbol",QueueItemDetail:"symbolFont QueueItemPick-symbol",ThumbsUp:"symbolFont ThumbsUp-symbol",ThumbsDown:"symbolFont ThumbsDown-symbol",Lead:"symbolFont Lead-symbol",TableLink:"symbolFont TableLink-symbol",TableGroup:"symbolFont TableGroup-symbol",ClearDefault:"symbolFont ClearDefault-symbol",SetDefault:"symbolFont SetDefault-symbol",SaveFilterToCurrentPersonalView:"symbolFont SaveFilterToCurrentPersonalView-symbol",SaveFilterToNewPersonalView:"symbolFont SaveFilterToNewPersonalView-symbol",Expand:"symbolFont Expand-symbol",ChromeMinimize:"symbolFont ChromeMinimize-symbol",ChromeMaximize:"symbolFont ChromeMaximize-symbol",ConnectionRoleManageRecordType:"symbolFont ConnectionRoleManageRecordType-symbol",Sync:"symbolFont Sync-symbol",ThumbsUpSolid:"symbolFont ThumbsUpSolid-symbol",ThumbsDownSolid:"symbolFont ThumbsDownSolid-symbol",msdyn_enhancedsla:"symbolFont msdyn_enhancedsla-symbol",msdyn_enhancedslakpi:"symbolFont msdyn_enhancedslakpi-symbol",msdyn_enhancedslakpiinstance:"symbolFont msdyn_enhancedslakpiinstance-symbol",CreateOrder:"symbolFont CreateOrder-symbol",Revise:"symbolFont Revise-symbol",CloseQuote:"symbolFont CloseQuote-symbol",CommandChecker:"symbolFont CommandChecker-symbol",MiniContract:"symbolFont MiniContract-symbol",MiniExpand:"symbolFont MiniExpand-symbol",Print:"symbolFont Print-symbol",NoDataAvailable:"symbolFont NoDataAvailable-symbol",MoreVertical:"symbolFont MoreVertical-symbol",OpenInNewWindow:"symbolFont OpenInNewWindow-symbol",EditEvent:"symbolFont EditEvent-symbol",LinkToRecord:"symbolFont LinkToRecord-symbol",UnlinkFromRecord:"symbolFont UnlinkFromRecord-symbol",KnowledgeSearch:"symbolFont KnowledgeSearch-symbol",ChevronDownMed:"symbolFont ChevronDownMed-symbol",OpenFolderHorizontal:"symbolFont OpenFolderHorizontal-symbol",TaskClipboard:"symbolFont TaskClipboard-symbol",CustomList:"symbolFont CustomList-symbol",ExpandAllRecords:"symbolFont ExpandAllRecords-symbol",CollapseAllRecords:"symbolFont CollapseAllRecords-symbol",SelectAll:"symbolFont SelectAll-symbol",Embed:"symbolFont Embed-symbol",MailTemplate:"symbolFont MailTemplate-symbol",Monitor:"symbolFont Monitor-symbol",Error:"symbolFont Error-symbol",CustomEntity:"symbolFont CustomEntity-symbol",EventAccepted:"symbolFont EventAccepted-symbol",ClosePaneMirrored:"symbolFont ClosePaneMirrored-symbol",RollupQuery:"symbolFont RollupQuery-symbol",SidePanelMirrored:"symbolFont SidePanelMirrored-symbol",FontColor:"symbolFont FontColor-symbol",AlignJustify:"symbolFont AlignJustify-symbol",NumberedList:"symbolFont NumberedList-symbol",Omega:"symbolFont Omega-symbol",LineSpacing:"symbolFont LineSpacing-symbol",Spelling:"symbolFont Spelling-symbol",Strikethrough:"symbolFont Strikethrough-symbol",Code:"symbolFont Code-symbol",IncreaseIndent:"symbolFont IncreaseIndent-symbol",DecreaseIndent:"symbolFont DecreaseIndent-symbol",Subscript:"symbolFont Subscript-symbol",Superscript:"symbolFont Superscript-symbol",AllinOnePC:"symbolFont AllinOnePC-symbol",ButtonControl:"symbolFont ButtonControl-symbol",LineFocus1:"symbolFont LineFocus1-symbol",CodeEdit:"symbolFont CodeEdit-symbol",QRCode:"symbolFont QRCode-symbol",CloudUpload:"symbolFont CloudUpload-symbol",TextAlignLeft:"symbolFont TextAlignLeft-symbol",TextAlignCenter:"symbolFont TextAlignCenter-symbol",TextAlignRight:"symbolFont TextAlignRight-symbol",TextAlignJustify:"symbolFont TextAlignJustify-symbol",BulletedList:"symbolFont BulletedList-symbol",Anchor:"symbolFont Anchor-symbol",ClearNight:"symbolFont ClearNight-symbol",SearchCampaigns:"symbolFont SearchCampaigns-symbol",FileCode:"symbolFont FileCode-symbol",DockBottom:"symbolFont DockBottom-symbol",DockLeft:"symbolFont DockLeft-symbol",DockRight:"symbolFont DockRight-symbol",Brightness:"symbolFont Brightness-symbol",AlignHorizontalLeft:"symbolFont AlignHorizontalLeft-symbol",AlignHorizontalCenter:"symbolFont AlignHorizontalCenter-symbol",AlignHorizontalRight:"symbolFont AlignHorizontalRight-symbol",AlignVerticalTop:"symbolFont AlignVerticalTop-symbol",AlignVerticalCenter:"symbolFont AlignVerticalCenter-symbol",AlignVerticalBottom:"symbolFont AlignVerticalBottom-symbol",BackButtonRTL:"symbolFont BackButtonRTL-symbol",InstagramIcon:"symbolFont InstagramIncon-symbol",Bookmark:"symbolFont Bookmark-symbol",RatingFullGrey:"symbolFont RatingFullGrey-symbol",ContactSolid:"symbolFont ContactSolid-symbol",ExploitProtectionSettings:"symbolFont ExploitProtectionSettings-symbol",ColumnOptions:"symbolFont ColumnOptions-symbol",CollaborationDisplay:"symbolFont CollaborationDisplay-symbol"};function i(e){return a[r[e]]||a.Default}},FoFY:function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s}));var r=n("zsAz");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e){return e.sessions}function i(e){const t=a(e);return Object.keys(t).length}function o(e,t){const n=e.sessions[t];if(!n)throw Object(r.d)("Session does not exist",2415919108,[{name:"SessionId",value:t}]);return n}function s(e,t){const n=a(e);for(const r in n){const n=o(e,r);if(n.tabs.indexOf(t)>=0)return n}return null}},G4xW:function(e,t,n){"use strict";function r(e){return{type:"preload.tag",execute:({dispatch:t},n,r)=>(Object.assign(r,{isPreloadCall:!0}),t(e))}}n.d(t,"a",(function(){return r}))},GD3x:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class r{constructor(e,t){this._continueOnError=!1,this._returnResponses=!1,this._continueOnError=e,this._returnResponses=t}get_continueOnError(){return this._continueOnError}get_returnResponses(){return this._returnResponses}}},GEbX:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.SingleSession=0]="SingleSession",e[e.MultiSession=1]="MultiSession"}(r||(r={}))},GL3b:function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"a",(function(){return c}));var r=n("SAYH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e){return e&&e.offline&&e.offline.server&&e.offline.server.profileId?e.offline.server.profileId:r.a.EMPTY}function i(e){return e&&e.offline&&e.offline.server&&e.offline.server.profileVersion?e.offline.server.profileVersion:""}function o(e){return e&&e.offline&&e.offline.server&&e.offline.server.profileAvailableEntities?e.offline.server.profileAvailableEntities:null}function s(e){return!!(e&&e.offline&&e.offline.server&&e.offline.server.profileAvailableEntities)&&e.offline.server.profileAvailableEntities.length>1}function c(e){return!!(e&&e.offline&&e.offline.client&&e.offline.client.isProfileChanged)&&e.offline.client.isProfileChanged}},GP49:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return o}));var r=n("RymD");function a(e){const t=i(e);return void 0!==t&&t>=r.d}function i(e){return e.appShellState&&e.appShellState.backNavTooltipState&&e.appShellState.backNavTooltipState.tooltipDismissCount}function o(e){return e.appShellState&&e.appShellState.backNavTooltipState&&!e.appShellState.backNavTooltipState.hideLongPressTooltip}},GT4X:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"e",(function(){return l})),n.d(t,"c",(function(){return u}));var r=n("P86a"),a=n("UIlN");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function i(e,t){return c(e,t,[r.a.CompletedInitialRuleEvaluation])}function o(e,t){return c(e,t,[r.a.Initializing])}function s(e,t){return c(e,t,[r.a.CompletedInitialRuleEvaluation,r.a.SkippedRuleEvaluation])}function c(e,t,n){const r=Object(a.a)(e,t);return r&&-1!==n.indexOf(r.initializationState)}function l(e,t){let n=null;const r=Object(a.a)(e,t);return r&&r.controlsMap&&(n=r.controlsMap),n}function u(e,t){const n=l(e,t);return n?Object.assign({},...Object.entries(n).filter(([e,t])=>t.hasVisibilityExpression||t.hasActionExpression).map(([e,t])=>({[e]:t}))):{}}},GWSs:function(e,t,n){"use strict";n.d(t,"f",(function(){return p})),n.d(t,"b",(function(){return f})),n.d(t,"g",(function(){return g})),n.d(t,"c",(function(){return h})),n.d(t,"d",(function(){return b})),n.d(t,"e",(function(){return m})),n.d(t,"h",(function(){return y})),n.d(t,"a",(function(){return d})),n.d(t,"i",(function(){return _}));var r=n("eXjw"),a=n("7HpW"),i=n("Wbnz"),o=n("n/MI"),s=n("Xi8U"),c=n("YxC/"),l=n("2FbK"),u=n("d6Hx");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const d="SITEMAP_RECENT_UNPIN";function p(e){return e&&e.metadata&&e.metadata.siteMap&&e.metadata.siteMap.initialized?e.metadata.siteMap:null}function f(e){const t=p(e);return t?t.initialized:r.a.Uninitialized}function g(e,t){return t===u.c?function(e){const t=Object(s.e)(e),n=Object(s.i)(e),r=t.map(t=>o.a.FromStateItem(t,!0,e)),a=n.map(t=>o.a.FromStateItem(t,!0,e)),i=[],l=Object(c.e)(e,["SITEMAP_RECENT_PIN",d,"SITEMAP_SUBACTION_NOTIFIER","SITEMAP_GROUP_FAVORITES","SITEMAP_GROUP_RECENTLY_USED"]),u=Object(c.c)(l,"SITEMAP_SUBACTION_NOTIFIER"),p=Object(c.c)(l,"SITEMAP_RECENT_PIN"),f=Object(c.c)(l,d),g=Object(c.c)(l,"SITEMAP_GROUP_FAVORITES"),h=Object(c.c)(l,"SITEMAP_GROUP_RECENTLY_USED");r.length&&i.push({title:g,entries:r,narratorTitle:String.format(u,f)});a.length&&i.push({title:h,entries:a,narratorTitle:String.format(u,p)});return i.length?i:null}(e):function(e,t){const n=Object(l.b)(e);if(!n)return[];const r=n.Areas[t],o=Object(a.c)(r),s=[];for(let t=0;t<o.length;t++){const n=Object(a.b)(o[t]);s[t]={title:o[t].Titles[0].Title,entries:[]};for(let r=0;r<n.length;r++){const a=i.a.FromStateItem(n[r],e);s[t].entries.push(a)}}return s}(e,t)}function h(e){const t=p(e);return!t||t.ShowHome}function m(e){const t=p(e);return!t||t.ShowRecents}function b(e){const t=p(e);return!t||t.ShowPinned}function y(e){const t=p(e);return!!t&&t.EnableCollapsibleGroups}function _(e,t){const n=p(e),r=[];if(!n)return[];for(const e of n.AreaIds){const a=n.Areas[e],i=a.VectorIcon;i?r.push({type:"Area",id:a.Id,iconPath:i}):t.warn("Area "+a.Id+" doesn't have a vector icon.");for(const e of a.GroupIds){const n=a.Groups[e];for(const e of n.SubAreaIds){const i=n.SubAreas[e],o=i.VectorIcon;o?r.push({type:"Subarea",id:i.Id,iconPath:o}):t.warn("SubArea "+i.Id+" in Area "+a.Id+" doesn't have a vector icon.")}}}return r}},GYDS:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return s}));var r=n("mpSO"),a=n("UIlN");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function i(e,t){return t||e}function o(e,t){const n=Object(a.b)(e);if(!n)return null;const r=[];for(const i in n){Object(a.a)(e,i).pageId===t&&r.push(i)}return r}function s(e,t=!1){return e&&(t?-1!==e.indexOf(r.e):e===r.e)}},GYEz:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"e",(function(){return g})),n.d(t,"d",(function(){return h})),n.d(t,"f",(function(){return m})),n.d(t,"i",(function(){return y})),n.d(t,"j",(function(){return v})),n.d(t,"b",(function(){return f})),n.d(t,"k",(function(){return _})),n.d(t,"g",(function(){return b})),n.d(t,"h",(function(){return p}));var r=n("w1eR"),a=n("eOoD"),i=n("UwOy"),o=n("ZePi"),s=n("OEF1"),c=n("hAdb"),l=n("4gfk");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function u(e){return(null==e?void 0:e.clientHost)?e.clientHost.type:null}function d(e){return(null==e?void 0:e.clientHost)?e.clientHost.installationId:null}function p(e){return(null==e?void 0:e.clientHost)?e.clientHost.deviceTelemetryParams:null}function f(e){return(null==e?void 0:e.clientHost)?e.clientHost.deviceModel:null}function g(e){return Object(c.e)(e,l.a)?a.a.Phone:(null==e?void 0:e.clientHost)?e.clientHost.subtype:null}function h(e){return Object(i.c)(u(e))}function m(e){switch(g(e)){case a.a.Phone:return"Phone";case a.a.Tablet:return"Tablet"}return""}function b(e){const t=Object(s.d)(e);return t||m(e)}function y(e){return(null==e?void 0:e.clientHost)?e.clientHost.version:null}function _(e){if(window.IsUSD)return o.a.unifiedServiceDesk;switch(u(e)){case r.a.MobileApplication:return o.a.mobile;default:return o.a.web}}function v(e){const t=y(e);return t&&t.version?t.version+"."+t.build+" ("+t.revision+","+t.nativeRevision+")":""}},GZHP:function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return u}));var r=n("PsCI"),a=n("3/02"),i=n("Lyxw"),o=n("rhTL"),s=n("ju1h"),c=n("Gilj");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function l(e){return Object(i.d)(e,a.kf,a.Th)}class u{constructor(e){this._applicationContext=e}registerShortCut(e){const t=new c.a([r.a.F2],this._popupKeyboardShortcutHandler.bind(this),!0,"Popup keyboard shortcut","Using F2 to navigate to popup");e.registerShortcut(t)}_getAllPopup(){return document.body.querySelectorAll(`[${s.c}=true]`)}_getCurrentPopupIndex(e,t){for(let n=0;n<e.length;n++)if(e[n].contains(t))return n;return-1}_getNextPopupFocus(e){const t=this._getAllPopup();if(0===t.length)return null;const n=this._getCurrentPopupIndex(t,e);let r=n+1;return(n<0||n===t.length-1)&&(r=0),r!==n?t[r]:null}_popupKeyboardShortcutHandler(e){const t=e.EVENT,n=this._getNextPopupFocus(t.target);n&&(this._applicationContext.AccessibilityManager.showOutlineState(!0),Object(o.a)(n,n.firstChild,!0))}}},Gbua:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e._ConvertNumberToArray=function(e,t){if(!e)return t?this._doubleZero:this._floatZero;var n=t?52:23,r=(1<<(t?11:8)-1)-1,a=1-r,i=r,o=e<0?1:0;e=Math.abs(e);for(var s=Math.floor(e),c=e-s,l=2*(r+2)+n,u=new Array(l),d=0;d<l;)u[d++]=0;for(d=r+2;d&&s;)u[--d]=s%2,s=Math.floor(s/2);for(d=r+1;d<l-1&&c>0;)(c*=2)>=1?(u[++d]=1,--c):u[++d]=0;for(var p=0;p<l&&!u[p];)p++;var f=r+1-p,g=p+n;if(u[g+1]){for(d=g;d>p&&(u[d]=1-u[d],!u);--d);d===p&&++f}if(f>i||s)return o?t?this._doubleNegInifinity:this._floatNegInifinity:t?this._doubleInifinity:this._floatInifinity;if(f<a)return t?this._doubleZero:this._floatZero;if(t){var h=0;for(d=0;d<20;++d)h=h<<1|u[++p];for(var m=0;d<52;++d)m=m<<1|u[++p];return[255&m,m>>8&255,m>>16&255,m>>>24,255&(h=o<<31|2147483647&(h|=f+r<<20)),h>>8&255,h>>16&255,h>>>24]}var b=0;for(d=0;d<23;++d)b=b<<1|u[++p];return[255&(b=o<<31|2147483647&(b|=f+r<<23)),b>>8&255,b>>16&255,b>>>24]},e._floatZero=[0,0,0,0],e._doubleZero=[0,0,0,0,0,0,0,0],e._floatInifinity=[0,0,128,127],e._floatNegInifinity=[0,0,128,255],e._doubleInifinity=[0,0,0,0,0,0,240,127],e._doubleNegInifinity=[0,0,0,0,0,0,240,255],e}();t.FloatUtils=r},GdzE:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("Uv1Y");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t,n,a=!1){return{type:"session.state.save.async",execute:({dispatch:i,getState:o},s)=>function(e,t,n,a,i=!1){return e.saveSessionState(t,n,a,i).nativePromise().catch(r.b)}(s.DataSource,e,t,n,a).then(e=>e)}}},Gi6V:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return p}));var r=n("Lyxw"),a=n("E5IU"),i=n("3/02"),o=n("dpM5"),s=n("jRy5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const c={appSetting:"AsyncOnLoad",fcbName:o.a},l={appSetting:"AsyncOnSave",fcbName:o.b};function u(e,t,n){const o=Object(a.i)(n.appSetting,e);return(null==t?void 0:t.contextTokenType)===s.a.MainForm&&Object(r.e)(e,n.fcbName,i.kf)&&null!=o&&Boolean(o)}function d(e,t){return u(e,t,c)}function p(e,t){return u(e,t,l)}},Gilj:function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class r{constructor(e,t,n,r,a,o,s,c=!1){this._keyCombination=e,this._shortcutHandler=t,this._isGlobal=n,this._shortcutType=s,this._shortcutType||(this._shortcutType=i.KeyDown),this._srcElementId=o,this._shortcutDescription=a,this._areaName=r}getKeyCombination(){return this._keyCombination}getShortcutHandler(){return this._shortcutHandler}getIsGlobal(){return this._isGlobal}getIsHidden(){return!1}getAreaName(){return this._areaName}getKeyboardShortcutType(){return this._shortcutType}getSrcElementId(){return this._srcElementId}getShortcutDescription(){return this._shortcutDescription}}class a{}var i;!function(e){e[e.KeyUp=0]="KeyUp",e[e.KeyDown=1]="KeyDown"}(i||(i={}))},"GjO+":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AWT_REAL_TIME="REAL_TIME",t.AWT_NEAR_REAL_TIME="NEAR_REAL_TIME",t.AWT_BEST_EFFORT="BEST_EFFORT"},Gjxs:function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},GotM:function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.forEachAdditionalWindow=t.setAdditionalWindows=void 0,t.setAdditionalWindows=function(e){r=e},t.forEachAdditionalWindow=function(e){if(r)for(var t=document.querySelectorAll("[id^="+r+"]"),n=function(n){if(t[n]instanceof HTMLIFrameElement)try{e(t[n])}catch(e){var r=new Error(e.message+", src: "+t[n].src);setTimeout((function(){throw r}),0)}},a=0;a<t.length;a++)n(a)}},Gxq8:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));class r{constructor(e,t,n){this._featureName=null,this._dataType=null,this._value=null,this._featureName=e,this._dataType=t,this._value=n}get_featureName(){return this._featureName}get_dataType(){return this._dataType}get_value(){return this._value}getObjectData(){const e={};return e.featurename=this.get_featureName(),e.datatype=this.get_dataType(),e.value=this.get_value(),e}static createFromObjectData(e){const t=e.featurename,n=e.datatype,a=e.value;return new r(t,n,a)}}},H4dV:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("504W"),a=n("a475");let i=null;class o{constructor(){this._palEnabled=!1,this._isBrowserIE=!1,this._isBrowserEdge=!1,this._isBrowserFirefox=!1,this._isBrowserChrome=!1,this._isBrowserSafari=!1,this._isIPhone=!1,this._isIPad=!1,this._isIPod=!1,this._isOutlookIos=!1,this._isAndroid=!1,this._isAndroidModern=!1,this._isAndroidJellyBean=!1,this._isAndroidPhone=!1,this._isMac=!1,this._isWin=!1,this._isWinDesktop=!1,this._isWinPhone=!1,this._rawValue=null,this._customControlUserAgent=null,this._isMailApp=!1,this._rawValue=window.navigator.userAgent,-1!==document.cookie.indexOf("PALEnabled")?this._palEnabled=!0:this._palEnabled=!1,this._isMailApp=-1!==window.location.search.indexOf("clienthost=3"),this.get_isMailApp()&&window.self!==window.parent&&(this._palEnabled=!0),this._isBrowserEdge=this._rawValue.toLowerCase().indexOf("edge")>-1&&this._rawValue.toLowerCase().indexOf("windows nt")>-1,this._isBrowserIE=!(-1===this._rawValue.indexOf("MSIE")&&-1===this._rawValue.indexOf("Trident")),this._isBrowserChrome=-1!==this._rawValue.indexOf("Chrome"),this._isBrowserFirefox=-1!==this._rawValue.indexOf("Firefox"),-1!==this._rawValue.indexOf("Safari")&&(-1!==this._rawValue.indexOf("Chrome")||-1!==this._rawValue.indexOf("Android")?this._isBrowserSafari=!1:this._isBrowserSafari=!0),this._isIPhone=-1!==this._rawValue.indexOf("iPhone"),this._isIPad=-1!==this._rawValue.indexOf("iPad"),!this._isIPhone||"iPad"!==window.navigator.platform||-1===this._rawValue.indexOf("9_1")&&-1===this._rawValue.indexOf("9_2")||(this._isIPhone=!1,this._isIPad=!0),this._isIPod=-1!==this._rawValue.indexOf("iPod"),this._isOutlookIos=-1!==this._rawValue.toLowerCase().indexOf("outlook-ios"),this._isAndroid=-1!==this._rawValue.indexOf("Android")&&-1===window.navigator.appVersion.indexOf("Win"),this._isAndroid&&(this._isAndroidModern=this._CheckIsModernAndroid(),this._isAndroidJellyBean=this._CheckIsAndroidJellyBean()),this._isAndroidPhone=this._isAndroid&&-1!==this._rawValue.indexOf("Mobile"),this._isMac=-1!==window.navigator.appVersion.indexOf("Mac"),this._isWin=-1!==window.navigator.appVersion.indexOf("Win")||-1!==window.navigator.appVersion.indexOf("NT"),this._isWinDesktop=this._isWin&&-1!==window.navigator.appVersion.indexOf("NT"),this._isWinPhone=this._isWin&&-1!==window.navigator.appVersion.indexOf("Phone"),this._customControlUserAgent=this._GetCustomControlUserAgent()}get_CustomControlUserAgent(){return this._customControlUserAgent}_GetCustomControlUserAgent(){return{isWin:this._isWin,isAndroid:this._isAndroid,isAndroidModern:this._isAndroidModern,isIos:this.get_IsIOS()||this._isOutlookIos,isBrowserIE:this._isBrowserIE,isBrowserChrome:this._isBrowserChrome,isBrowserFirefox:this._isBrowserFirefox,isBrowserSafari:this._isBrowserSafari}}get_PALEnabled(){return this._palEnabled||a.a.get_Instance().get_application().get_IsAvailable()}get_WebSqlDatabaseEnabled(){return void 0!==window.openDatabase}get_indexedDbFactory(){const e=window.self.indexedDB;return Object(r.a)(e)||Object(r.a)(e.deleteDatabase)?null:e}get_supportsNativeSqlBridge(){return a.a.get_Instance().get_sql().get_IsAvailable()}get_IsBrowser(){return this.get_IsBrowserEdge()||this.get_IsBrowserChrome()||this._isBrowserFirefox||this._isBrowserIE||this.get_isBrowserSafari()}get_IsBrowserIE(){return this._isBrowserIE}get_IsBrowserEdge(){return this._isBrowserEdge}get_IsBrowserFirefox(){return this._isBrowserFirefox}get_IsBrowserChrome(){return this._isBrowserChrome}get_isBrowserSafari(){return this._isBrowserSafari}get_isIPhone(){return this._isIPhone}get_isIPad(){return this._isIPad}get_IsIOS(){return this.get_isIPhone()||this.get_isIPad()||this._isIPod}get_IsAndroid(){return this._isAndroid}get_IsAndroidJellyBean(){return this._isAndroidJellyBean}get_IsAndroidPhone(){return this._isAndroidPhone}get_isWinPhone(){return this._isWinPhone}get_IsMobilePhone(){return this._isWinPhone||this.get_isIPhone()||this.get_IsAndroidPhone()}get_isMailApp(){return this._isMailApp}get_IsMacSafari(){return this.get_isBrowserSafari()&&this._isMac}get_IsMacSafariNotSupportAnchorDownload(){if(this.get_IsMacSafari()){const e=this._rawValue.indexOf("Version");if(-1!==e){const t=this._rawValue.substring(e+"Version".length+1,e+"Version".length+5);return parseFloat(t)<10.1}}return!1}get_IsWindows(){return this._isWin}get_IsWinDesktop(){return this._isWinDesktop}_CheckIsModernAndroid(){const e=this._rawValue.indexOf("Android");if(-1!==e){const t=this._rawValue.substring(e+"Android".length+1,e+"Android".length+4);return parseFloat(t)>=4.4}return!1}_CheckIsAndroidJellyBean(){const e=this._rawValue.indexOf("Android");if(-1!==e){return"4.3"===this._rawValue.substring(e+"Android".length+1,e+"Android".length+4)}return!1}static getInstance(){return i||(i=new o),i}}},HYaY:function(e,t,n){"use strict";n.d(t,"a",(function(){return w}));var r=n("tHaS"),a=n("wMH2"),i=n("84PK"),o=n("504W");function s(e,t){return!(!Object(o.a)(e)||!Object(o.a)(t))||!(Object(o.a)(e)&&!Object(o.a)(t)||Object(o.a)(t)&&!Object(o.a)(e))&&(e instanceof i.a&&t instanceof i.a||e.equals&&t.equals?e.equals(t):e.get_ValueString&&e.get_Label&&t.get_ValueString&&t.get_Label?e.get_ValueString()===t.get_ValueString()&&e.get_Label()===t.get_Label():e.get_value&&t.get_value?s(e.get_value(),t.get_value()):(e instanceof Date&&t instanceof Date&&(e=e.valueOf(),t=t.valueOf()),e===t))}var c=n("NMtn"),l=n("2F73"),u=n("XvL5"),d=n("rO1J"),p=n("d+dp"),f=n("WRF3"),g=n("IvgJ"),h=n("sdkC"),m=n("/A0C"),b=n("nTyX"),y=n("P68g"),_=n("odYE"),v=n("5Oca"),S=n("5qiD"),O=n("/oKV"),C=n("LbMF"),E=n("WePp"),I=n("64CY");class w{constructor(e,t,n,r,a,i,s,l){this._identifier=null,this._actionableIdentifier=null,this._fields=null,this._formattedValues=null,this._numericFormattedValues=null,this._relatedEntities=null,this._changedFieldNames=null,this._cleanFields=null,this._fieldTypes=null,this._columnSet=null,this._clientRetrieveOptions=null,this._accessRights=0,this._userSharedAttributePrivileges=null,this._entityRecordForProcess=null,this._globalNavigationData=null,e instanceof w?(t=e._fields,n=e._fieldTypes,r=e._formattedValues,a=e._numericFormattedValues,i=e._relatedEntities,l=e._clientRetrieveOptions,this._identifier=e._identifier):this._identifier=e,Object(c.d)(this._identifier,"identifier"),Object(c.d)(t,"fields"),Object(c.d)(n,"fieldTypes"),Object(c.d)(r,"formattedValues"),Object(c.d)(a,"numericFormattedValues"),Object(c.d)(i,"relatedEntities"),this._fields=t,this._fieldTypes=n,this._formattedValues=r,this._numericFormattedValues=a,this._relatedEntities=i,this._columnSet=Object(o.a)(s)?new u.a(new Array(0)):s,this.updateColumnSet(this.get_fieldNames()),this._changedFieldNames=[],this._cleanFields={},this._clientRetrieveOptions=l,this._accessRights=0;const d=this.getValue("activitytypecode");"activitypointer"===this._identifier.LogicalName&&d?this._actionableIdentifier=new f.a(d,this._identifier.Id):this._actionableIdentifier=this._identifier,this._userSharedAttributePrivileges={}}get fields(){return this._fields}get_identifier(){return this._identifier}get_actionableIdentifier(){return this._actionableIdentifier}get_fieldTypes(){return this._fieldTypes}get_formattedValues(){return this._formattedValues}get_numericFormattedValues(){return this._numericFormattedValues}get_relatedEntities(){return this._relatedEntities}get_fieldNames(){const e=[],t=this._fields;for(const n in t){const r={key:n,value:t[n]};e.push(r.key)}return e}get_changedFieldNames(){return this._changedFieldNames}get_columnSet(){return this._columnSet}get_key(){return this.get_identifier().get_key()}get_clientRetrieveOptions(){return this._clientRetrieveOptions}set_clientRetrieveOptions(e){this._clientRetrieveOptions=e;for(const t of this._relatedEntities.get_entityCollections())t.get_value().set_clientRetrieveOptions(e)}get_accessRights(){return this._accessRights}set_accessRights(e){this._accessRights=e}get_userSharedAttributePrivileges(){return this._userSharedAttributePrivileges}set_userSharedAttributePrivileges(e){this._userSharedAttributePrivileges=e}get_entityRecordForProcess(){return this._entityRecordForProcess}set_entityRecordForProcess(e){return this._entityRecordForProcess=e,e}get_globalNavigationData(){return this._globalNavigationData}set_globalNavigationData(e){this._globalNavigationData=e}isDirty(){return this.get_changedFieldNames().length>0}clone(){const e=this.getObjectData(),t=e.columnset;Object(o.a)(t)||(t.columns=t.columns.slice());const n=e.formattedfields,r={};for(const e in n){const t={key:e,value:n[e]};r[t.key]=t.value}const a=e.numericformattedfields,i={};for(const e in a){const t={key:e,value:a[e]};i[t.key]=t.value}return e.formattedfields=r,e.numericformattedfields=i,w.createFromObjectData(e)}getObjectData(){const e=this._columnSet instanceof l.a;return{identifier:this._identifier.getObjectData(),fields:this._GetFieldsObjectData(),fieldtypes:Object(b.d)(this._fieldTypes),formattedfields:this._formattedValues,numericformattedfields:this._numericFormattedValues,allcolumns:e,columnset:e?void 0:this._columnSet.getObjectData(),clientretrieveoptions:Object(o.a)(this._clientRetrieveOptions)?void 0:this._clientRetrieveOptions.getObjectData(),accessrights:this._accessRights,sharedattributeprivileges:Object(y.a)(this._userSharedAttributePrivileges,e=>e.getObjectData()),entityrecordforprocess:Object(o.a)(this.get_entityRecordForProcess())?void 0:this.get_entityRecordForProcess().getObjectData(),globalnavigationdata:Object(o.a)(this.get_globalNavigationData())?void 0:this.get_globalNavigationData().getObjectData()}}_GetFieldsObjectData(){return Object.keys(this._fields).reduce((e,t)=>(e[t]=this.getFieldObjectData(t),e),{})}getFieldObjectData(e){return w.InternalGetFieldObjectData(this.getValue(e),this._fieldTypes[e])}getFields(){return this._GetFieldsObjectData()}hasValue(e){return e in this._fields}hasField(e){return e in this._fieldTypes}getValue(e){return this._fields[e]}getFormattedValue(e){return Object(o.a)(this.get_formattedValues()[e])?this.get_fieldTypes()[e]===m.a.AliasedValue?this.getValue(e).get_value():this.getValue(e):this.get_formattedValues()[e]}getNumericFormattedValue(e){return this._numericFormattedValues[e]||this.getFormattedValue(e)}setValue(e,t){if(!(e in this.get_fieldTypes()))throw Error.argumentOutOfRange(e);t&&t.get_Label&&t.get_ValueString?this._fields[e]=g.a.createFromPicklistItem(t):this._fields[e]=t,this.updateColumnSet([e])}markFieldChanged(e){if(this.get_changedFieldNames().indexOf(e)<0&&(this._cleanFields[e]=this._fields[e],this.get_changedFieldNames().push(e),this._fields[e]instanceof a.a))for(const t of this._fields[e].get_entities())t._MarkAllFieldsChanged()}_MarkAllFieldsChanged(){for(const e of this.get_fieldNames())this.markFieldChanged(e)}resetChanges(){this._changedFieldNames=[],this._cleanFields={}}mergeChanges(e){Object(o.a)(this._clientRetrieveOptions)?this._clientRetrieveOptions=e._clientRetrieveOptions:this._clientRetrieveOptions.update(e._clientRetrieveOptions),this.set_accessRights(e.get_accessRights()),this.mergeEntityRecordFields(e),this._entityRecordForProcess=e._entityRecordForProcess,this._globalNavigationData=e._globalNavigationData}mergeEntityRecordFields(e){const t=e._fields;for(const e in t){const n={key:e,value:t[e]};n.key in this._fields&&s(this._fields[n.key],n.value)||(this._fields[n.key]=n.value)}const n=e._fieldTypes;for(const t in n){const r={key:t,value:n[t]}.key;r in this._fieldTypes||(this._fieldTypes[r]=e._fieldTypes[r]),r in this._fields&&!(r in e._fields)&&(delete this._fields[r],delete this._formattedValues[r],delete this._numericFormattedValues[r])}const r=e._formattedValues;for(const e in r){const t={key:e,value:r[e]};t.key in this._formattedValues&&s(this._formattedValues[t.key],t.value)||(this._formattedValues[t.key]=t.value)}e.get_columnSet()instanceof l.a?this.updateColumnSet(e.get_columnSet()):this.updateColumnSet(this.get_fieldNames())}initializeValue(e,t,n){this._fields[e]=t,e in this._fieldTypes||(this._fieldTypes[e]=n),this.updateColumnSet([e])}updateColumnSet(e,t){if(e=e,!(this.get_columnSet()instanceof l.a)){if(e instanceof l.a)this._columnSet=l.a.get_instance();else{let t;t=e instanceof u.a?e.get_Columns():e;const n=this._columnSet;for(const e of t)n.get_Columns().indexOf(e)<0&&n.get_Columns().push(e)}if(!Object(o.a)(t))for(const e of t){const t=this.get_relatedEntities().getByRelationship(e.get_relationship());for(const n of t.get_entities())n.updateColumnSet(e.get_ColumnSet())}}}static createFromObjectData(e){const t=Object(b.b)(e.fieldtypes),n=e.identifier&&f.a.createFromObjectData(e.identifier),r=w.createFieldsFromObjectData(e.fields,t);let a;a=e.allcolumns?l.a.get_instance():u.a.createFromObjectData(e.columnset);const i=e.clientretrieveoptions?p.a.createFromObjectData(e.clientretrieveoptions):null,s=new w(n,r,t,e.formattedfields,e.numericformattedfields,new h.a(new Array(0)),a,i);s.set_accessRights(e.accessrights);const c=Object(y.a)(e.sharedattributeprivileges,e=>d.a.createFromObjectData(e));s.set_userSharedAttributePrivileges(c);const g=e.entityrecordforprocess;Object(o.a)(g)||s.set_entityRecordForProcess(w.createFromObjectData(g));const m=e.globalnavigationdata;return Object(o.a)(m)||s.set_globalNavigationData(w.createFromObjectData(m)),s}static createSingleFieldFromObjectData(e,t){return w.InternalCreateFieldFromObjectData(e,t)}static createFieldsFromObjectData(e,t){const n={};for(const r in e){const a={key:r,value:e[r]};n[a.key]=w.InternalCreateFieldFromObjectData(a.value,t[a.key])}return n}static InternalCreateFieldFromObjectData(e,t){if(Object(o.a)(e))return null;switch(t){case m.a.AliasedValue:return r.a.createFromObjectData(e);case m.a.Customer:case m.a.Lookup:case m.a.Owner:return f.a.createFromObjectData(e);case m.a.UniqueIdentifier:return i.a.createFromObjectData(e);case m.a.DateTime:return new Date(Date.parse(e));case m.a.Status:case m.a.State:case m.a.Boolean:case m.a.PickList:return g.a.createFromObjectData(e);case m.a.PartyList:return a.a.createFromObjectData(e);default:return e}}static InternalGetFieldObjectData(e,t){if(Object(o.a)(e))return null;switch(t){case m.a.AliasedValue:return e.getObjectData();case m.a.Customer:case m.a.Lookup:case m.a.Owner:case m.a.UniqueIdentifier:return e.getObjectData();case m.a.DateTime:return e.toString();case m.a.Status:case m.a.State:case m.a.Boolean:case m.a.PickList:case m.a.PartyList:return e.getObjectData();default:return e}}static recordDataToLegacyEntityRecord(e,t,n,r,a,i=v.a.LatestEntered){const o=_.a.toLegacyEntityReference(t),s=new w(o,{},{},{},{},new h.a([]));s.set_clientRetrieveOptions(new p.a(S.a.Medium,O.a.LocalAndRemote));const c=Object(I.d)("fullname");for(const o in n){let n=Object(C.a)(e,t.etn,o);if(!n){const e=new E.a("uci_info"),n="Attribute "+o+" for entity "+t.etn+" could not be found.";e.addEventParameter("Message",n),a.warn("EntityRecord "+n);continue}const l=Object(v.D)(e,r,t,o,i);s.initializeValue(o,l,n.Type),s.markFieldChanged(o);const u=c.indexOf(o);if(-1!==u){c.splice(u,1);for(const r of c)if(n=Object(C.a)(e,t.etn,r),n){const a=Object(v.j)(e,t,r),o=Object(v.n)(e,t.etn,r,a,i);s.initializeValue(r,o,n.Type)}}}return s}}},HcnX:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n("0nOn"),a=n("ghNp"),i=n("ScMg"),o=n("i1f0"),s=n("Zpd/"),c=n("ZMWz"),l=n("e3W2"),u=n("+XGO"),d=n("w92Z"),p=n("16wZ"),f=n("fh2P");let g;class h extends i.a{constructor(e,t,n,a,i,o){super(e,t,n,i),g=e,this._formContext=o,this._controlDescriptor=a;const s=[{name:"store",value:e,isRequired:!0},{name:"contextToken",value:t,isRequired:!0},{name:"controlName",value:i,isRequired:!0,isEventParam:!0,expectedDataType:"string"},{name:"controlDescriptor",value:a,isRequired:!0}];this._clientApiExecutorControl=new r.a(e,"ClientApi.XrmControl.",n,t,s)}get formContext(){return this.clientApiExecutor.execute("formContext",()=>this._formContext)}get clientApiExecutor(){return this._clientApiExecutorControl}getControlType(){return this.clientApiExecutor.execute("getControlType",()=>{const e=Object(d.a)(g.getState(),this.controlDescriptor,this.pageId,this.contextToken);return e?"customcontrol:"+e.Name:"standard"})}getDisabled(){return this.clientApiExecutor.execute("getDisabled",()=>Object(o.v)(g.getState(),{id:this.pageId,controlName:this.name},this.contextToken))}getLabel(){return this._clientApiExecutorControl.execute("getLabel",()=>{const e=Object(o.y)(g.getState(),this.connectedControlProps,this.contextToken);return Object(p.a)(e)?this.controlDescriptor.Label?this.controlDescriptor.Label:"":e})}getParent(){return this.clientApiExecutor.execute("getParent",(e,t)=>{var n,r,i;if(!this._parent){if(this.getName().startsWith(f.b))return null;if(this._formContext||(this._formContext=g.dispatch(Object(a.b)(this.pageId,this.contextToken))),this._formContext)if((null===(n=this.controlDescriptor)||void 0===n?void 0:n.ParentTabId)&&(null===(r=this.controlDescriptor)||void 0===r?void 0:r.ParentSectionName)){const e=null===(i=Object(o.Oc)(g.getState(),this.pageId,this.controlDescriptor.ParentTabId,this.contextToken))||void 0===i?void 0:i.Name,n=this._formContext.ui.tabs.get(e);n?this._parent=n.sections.get(this.controlDescriptor.ParentSectionName):t.push({name:"controlTab",value:"not Found"})}else this._formContext.ui.headerSection.controls.get(this.getName())?this._parent=this._formContext.ui.headerSection:this._formContext.ui.footerSection.controls.get(this.getName())&&(this._parent=this._formContext.ui.footerSection);this._parent||(t.push({name:"controlDescriptor",value:this.controlDescriptor?"has value":"null"}),this.controlDescriptor&&(t.push({name:"parentTabId",value:this.controlDescriptor.ParentTabId}),t.push({name:"parentSectionName",value:this.controlDescriptor.ParentSectionName})),this.clientApiExecutor.reportFailure(e,new Error("Control's parent section cannot be retrieved."),t))}return this._parent})}setFocus(){this.clientApiExecutor.executeAsync("setFocus",()=>g.dispatch(Object(u.a)(this.pageId,this.contextToken,this.name)))}getVisible(){return this.clientApiExecutor.execute("getVisible",()=>{const e=Object(o.I)(g.getState(),this.connectedControlProps,this.contextToken);return Object(p.a)(e)?this.controlDescriptor.Visible:e})}setDisabled(e){this.clientApiExecutor.execute("setDisabled",()=>{g.dispatch(Object(s.b)(this.pageId,this.name,this.contextToken,!0===e)),this.controlStateObservable.notifyObservers(this.controlDescriptor)})}setLabel(e){this.clientApiExecutor.execute("setLabel",()=>{g.dispatch(Object(c.b)(this.pageId,this.name,this.contextToken,e)),this.controlStateObservable.notifyObservers(this.controlDescriptor)},[{name:"label",value:e,isRequired:!0}])}setVisible(e){this.clientApiExecutor.execute("setVisible",()=>{g.dispatch(Object(l.c)(this.pageId,this.name,this.contextToken,!0===e)),this.controlStateObservable.notifyObservers(this.controlDescriptor)})}get controlDescriptor(){return this._controlDescriptor}}},Hevb:function(e,t,n){"use strict";n.d(t,"c",(function(){return u})),n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return d}));var r=n("O4uv"),a=n("uIhY"),i=n("6zk2"),o=n("Wc7r"),s=n("g22U"),c=n("8i4h"),l=n("vSoM");function u(e,t){return{type:"SERIALIZE_UPDATE_REQUEST",execute({dispatch:n,getState:i},o){const s=e.get_target();return n(Object(r.d)(s,t)).then(()=>{const t=i(),n=s.get_identifier(),r=n.LogicalName,o=n.get_identifier();let c;try{c=Object(a.b)(t,s)}catch(e){return{serializationFailure:e.message}}return p(t,r,o,c,e.get_suppressDuplicateDetection(),d(e.get_concurrencyBehavior(),s.getValue("versionnumber")),e.get_returnRowVersion())})}}}function d(e,t){return e===i.a.IfRowVersionMatches&&t?'W/"'+t+'"':"*"}function p(e,t,n,a,i=!0,u,d,p,f,g,h,m={},b,y){let _=Object(l.g)(e,t,"Update",b);n&&(_=`${_}(${n})`),p&&(_+=p);let v=s.c.Update;g&&(v=s.c.BinaryUpload);const S=Object(s.g)(m),O={urlParameters:_,method:"PATCH",additionalHeaders:{[o.HEADER.MSCRM_SUPPRESS_DUPLICATION_DETECTION]:i.toString(),[o.HEADER.IF_MATCH]:u||"*",[o.HEADER.AUTO_DISASSOCIATE]:"true"},body:g?a:JSON.stringify(a),additionalParameters:Object(c.a)(s.d.UPDATE,S,t,v)};return f&&Object.assign(O.additionalHeaders,f),d&&(O.additionalHeaders[r.a]="true"),h&&Object(r.b)(O,h),y&&(O.additionalHeaders["MSCRM.SolutionUniqueName"]=y),O}},HfZT:function(e,t,n){"use strict";n.d(t,"b",(function(){return N})),n.d(t,"c",(function(){return A})),n.d(t,"e",(function(){return D})),n.d(t,"g",(function(){return k})),n.d(t,"a",(function(){return R})),n.d(t,"d",(function(){return q})),n.d(t,"h",(function(){return F})),n.d(t,"f",(function(){return V}));var r=n("eXjw"),a=n("SAYH"),i=n("vNXc"),o=n("Uv1Y"),s=n("5Oca"),c=n("q/7h"),l=n("iZ7K"),u=n("KBcj"),d=n("Wgxh"),p=n("pF61"),f=n("ddoO"),g=n("nxXM"),h=n("69Qu"),m=n("pEXn"),b=n("4r2D"),y=n("8o18"),_=n("5qiD"),v=n("/oKV"),S=n("d+dp"),O=n("a8hT"),C=n("/Zy9"),E=n("fYtF"),I=n("z+5+"),w=n("Er26"),j=n("jjPz"),P=n("VMrH"),T=n("WF3G");const N="gridData.retrieve",A="gridData.retrieve.async",R="E7A81278-8635-4D9E-8D4D-59480B391C5B";function D(e,t,n=!1){const r=arguments,c=[];return Object(j.a)(arguments,{type:A,execute({dispatch:d,getState:p},f,g){const h=p(),y=f.DataSource,_=new b.a(a.a.newGuid().guid,g&&g.isPreloadCall);c.push({name:m.b.ClientRequestId,value:_&&_.RequestId?_.RequestId():null}),c.push({name:"isRefresh",value:n});const v=e.key,S=Object(u.c)(h,e.viewId);let O,j,T;e.viewPrimaryEntityName=S?S.entityLogicalName:void 0;const N=Object(I.E)(h,e);if(N){const t=C.c.fromState(e),n=(null==S?void 0:S.entityLogicalName)||e.entityLogicalName,r=Object(l.G)(h,n),a=Object(s.w)(h,v,t.pageNumber-1);Object(l.q)(h,n)&&t.selectInternal("statecode",!1),t.selectInternal(r,!1),a&&(t.pagingCookie=a),O=t.getQueryState(p)}else{T=i.a.fromState(e,p),!T.hasColumn("statecode")&&Object(l.q)(h,T.entityLogicalName)&&(T.select("statecode"),T.removeFromSelects("statecode"));const t=Object(l.G)(h,T.entityLogicalName);T.hasColumn(t)||(T.select(t),T.removeFromSelects(t));const n=Object(s.w)(h,v,T.pageNumber-1);if(n&&(T.pagingCookie=n),j=T.getKeyQuery(),Object(l.q)(h,T.entityLogicalName)){const e=j.GetColumnNamesFromFetch();e&&e.length>0&&-1===e.indexOf("statecode")&&j.set_ColumnNames(e.concat("statecode"))}j.set_queryContext(e.queryContext)}const A=M(e,h,v),R=Object(I.A)(h);if(A&&!R){const e=x(h,v);return Promise.resolve(e)}d(L(v,N?O:j,n=!0===A||n));const D=f.TraceManager.getTracer(e.useModernQueryBuilder?w.k.QueryBuilder:E.a),F=e.useModernQueryBuilder?w.p.ModernQueryBuilder:E.a;return D.info(F+" RetrieveGridData action started",c),c.push(...Object(E.e)(e)),new Promise((e,n)=>{if(B(h,d,N?O:null,y,N?null:j,p,_,t).then(n=>{const a=V(h,d,v,N?O:T,n,t);d(a),d(Object(P.b)(0,r)),e(a.payload)},e=>{D.error(`${F} RetrieveGridData action failed with error: ${Object(o.d)(e)}`,c),n(e)}).catch(e=>n(e)),A){const t=x(h,v);e(t)}})},getFailureParameters:(e,t)=>c,getSuccessParameters:(e,t,n)=>c})}function x(e,t){const n=Object(s.o)(e,t),r={},i=n.records;for(const t in i){const n=i[t],o=n.etn,c=a.a.toString(n.id);r[o]||(r[o]={});const l=Object(s.h)(e,n.etn,a.a.toString(n.id));r[o][c]=l}return{entities:r,lists:{list:n}}}function M(e,t,n){if(!Object(I.c)(t))return!1;if(Object(s.p)(t,n)!==r.a.Initialized)return!1;const a=Object(s.t)(t,n);if(!a)return!1;const i=e.columnNames;for(const e in i)if(-1===a.indexOf(i[e]))return!1;return!0}function F(e,t){return{type:"grid.updateReference.async",sync:!0,execute({dispatch:n,getState:r},i){const o=r(),c={},l=Object(s.q)(o,t,void 0,!0);if(l)for(const e of l){const t=e.etn,n=a.a.toString(e.id),r=q(o,t,n);r&&(c[t]=c[t]||{},c[t][n]=r)}z(o,n,null,null,t,e,c)}}}function k(e,t,n,r=!1,o){return{type:"gridPage.retrieve.async",execute({dispatch:s,getState:c},l){const d=c(),p=new a.a(e),f=Object(u.c)(d,p);if(!f)return Promise.reject(`Failed to load page: view with id ${e} was not found.`);let g;Object(I.n)(d)?g=C.c.fromView(p):(g=i.a.fromXmlAndSql(f.fetchXML,f.offlineSqlQuery,p,null,null,c),g.setDefaultPageSize());const h=r?g.pageNumber+t:t;return o&&o.length&&g.select(...o),h<1?Promise.resolve(null):(g.pageNumber=h,s(D(g.getQueryState(Object(I.n)(d)?c:void 0),n)))}}}function L(e,t,n=!1){const a=t instanceof y.a?t.get_PageSize():t.pageSize,i={lists:{[e]:{initialized:n?r.a.Refreshing:r.a.Initializing,pageSize:a}}};return{type:N,payload:i}}async function B(e,t,n,r,a,i,s,c){if(Object(I.E)(e,n)){return t((await Object(O.b)()).retrieveMultiple(n,s,c)).then(e=>e).catch(o.b)}return new Promise((e,t)=>{const n=Object(h.c)(i())?v.a.Remote:v.a.Local,o=new S.a(_.a.Workspace,n);U(r,a,o,s,c).then(t=>e(t)).catch(o=>{n!==v.a.Remote||Object(h.c)(i())?t(o):U(r,a,new S.a(_.a.Workspace,v.a.Local),s,c).then(t=>e(t)).catch(e=>t(e))})})}function U(e,t,n,r,a){return e.retrieveMultiple(t,n,r,a).nativePromise().catch(o.b)}function V(e,t,n,i,o,s){var l;o.get_query()||o.set_query(new T.a(i.fetchXml));const u=Object(c.a)(o,e),d={},p=[],f={};for(let t=0;t<u.length;t++){const n=u[t].identifier.etn,r=a.a.toString(u[t].identifier.id);if(d[n]||(d[n]={}),d[n][r]=u[t],p.push(u[t].identifier),e){const t=q(e,n,r,void 0,s);if(t)if(f[n])f[n][r]=t;else{const e={[r]:t};f[n]=e}}}const g={entities:d,lists:{[n]:{initialized:r.a.Initialized,lastRetrieved:new Date,records:p,pages:{[i.pageNumber]:{pagingCookie:o.get_pagingCookie(),startGuid:p&&p.length&&p[0].id,startIndex:0,moreRecords:o.get_moreRecords()}},pageSize:i.pageSize,totalRecordCount:o.get_totalRecordCount(),totalRecordCountLimitExceeded:o.get_totalRecordCountLimitExceeded(),queryColumnNames:null===(l=o.get_queryState())||void 0===l?void 0:l.columnNames}}};return z(e,t,null,null,n,s,f),{type:N,payload:g}}function z(e,t,n,r,a,i,o){const s={},c=q(e,n,r,a,i);if(c&&(s[a]=c),o&&Object.keys(o).length>0||s&&Object.keys(s).length>0){const e={entities:o,lists:s,charts:null};t(Object(g.b)(e))}}function q(e,t,n,r,a){if(!e)return null;if(a||(a=Object(p.c)(e)),a&&""!==a){if(r){const t=Object(f.i)(e,r),n=t&&t.slice();return Object(d.a)(n,a)}const i=Object(f.h)(e,t,n),o=i&&i.slice();return Object(d.a)(o,a)}return null}},HkYq:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.none=0]="none",e[e.workspace=1]="workspace",e[e.form=2]="form",e[e.component=3]="component",e[e.entityCard=4]="entityCard",e[e.quickCreateForm=5]="quickCreateForm",e[e.customization=6]="customization",e[e.listQuery=7]="listQuery",e[e.grid=8]="grid",e[e.command=9]="command",e[e.siteMap=10]="siteMap",e[e.list=11]="list",e[e.dialog=12]="dialog",e[e.gridForm=13]="gridForm",e[e.inlineCreateForm=14]="inlineCreateForm",e[e.processControl=15]="processControl",e[e.fetchXml=16]="fetchXml",e[e.chartDrilldownForm=17]="chartDrilldownForm",e[e.entity=18]="entity",e[e.attribute=19]="attribute",e[e.webResource=20]="webResource",e[e.applicationMetadata=21]="applicationMetadata",e[e.mainFormDialog=22]="mainFormDialog",e[e.chart=23]="chart",e[e.uiStrings=24]="uiStrings",e[e.businessLogic=25]="businessLogic",e[e.searchPage=26]="searchPage",e[e.globalApplicationMetadata=27]="globalApplicationMetadata",e[e.applicationMetadataUserContext=28]="applicationMetadataUserContext",e[e.staticJSFile=29]="staticJSFile",e[e.layoutXml=30]="layoutXml",e[e.draftsPage=31]="draftsPage",e[e.duplicateRecordsPage=32]="duplicateRecordsPage",e[e.applicationMetadataSettings=33]="applicationMetadataSettings",e[e.senderFormPage=34]="senderFormPage",e[e.setRegarding=35]="setRegarding",e[e.senderCreateFormPage=36]="senderCreateFormPage",e[e.interactionCentricWorkspace=37]="interactionCentricWorkspace",e[e.taskBasedFlowGlobalMenu=38]="taskBasedFlowGlobalMenu",e[e.taskBasedFlow=39]="taskBasedFlow",e[e.interactionCentricForm=40]="interactionCentricForm",e[e.cardForm=41]="cardForm",e[e.controlConfiguration=42]="controlConfiguration",e[e.commandXaml=43]="commandXaml",e[e.documentTemplate=44]="documentTemplate",e[e.viewSelector=45]="viewSelector",e[e.customControl=46]="customControl",e[e.formSelector=47]="formSelector",e[e.resourceString=48]="resourceString",e[e.savedQueryVisualization=49]="savedQueryVisualization",e[e.label=50]="label",e[e.userView=51]="userView",e[e.savedView=52]="savedView",e[e.viewDefault=53]="viewDefault",e[e.homePageConfiguration=54]="homePageConfiguration",e[e.optionSet=56]="optionSet",e[e.quickCreateMenu=57]="quickCreateMenu",e[e.userContext=58]="userContext",e[e.businessProcessFlow=59]="businessProcessFlow",e[e.searchConfiguration=60]="searchConfiguration",e[e.userQueryVisualization=61]="userQueryVisualization",e[e.visualizationSelector=62]="visualizationSelector",e[e.dashboardSelector=63]="dashboardSelector",e[e.overallMetadataVersion=64]="overallMetadataVersion",e[e.appModule=65]="appModule",e[e.complexControl=66]="complexControl",e[e.displayString=67]="displayString",e[e.webResourceDescriptor=68]="webResourceDescriptor",e[e.isActivityFlags=69]="isActivityFlags",e[e.appModuleOfflineMetadata=70]="appModuleOfflineMetadata",e[e.appModuleSelector=71]="appModuleSelector",e[e.bpfSelector=72]="bpfSelector"}(r||(r={}))},"Hm+e":function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}));var r=n("NvOS");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let a;function i(e){a=new URL(Object(r.a)(e.getState(),"/Tools/Diagnostics/diag.aspx/GetMetrics"),window.location.origin)}function o(e){if(a){const t=e.getEvents().reduce((e,t)=>(t.parameters&&t.parameters.requestId&&e.push(new Promise(e=>{const n=new XMLHttpRequest;n.open("POST",a.href),n.setRequestHeader("Content-Type","application/json; charset=UTF-8"),n.onload=function(){const r=JSON.parse(n.response).d;for(const e in r)t.parameters[e]=r[e];e()},n.send(JSON.stringify({requestId:t.parameters.requestId}))})),e),[]);return Promise.all(t)}return Promise.resolve()}},HmIo:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BrowserTimelineTransport=void 0;var r=function(){function e(){this._nextMarkId=0}return e.prototype.writeMarker=function(e){if(performance.mark&&"function"==typeof performance.mark){var t=this._formatEvent(e),n=this._nextMarkId.toString();this._nextMarkId++,performance.mark(n),performance.measure(t,n,n),performance.clearMarks(n),performance.clearMeasures(t)}},e.prototype.writeRetroactiveTimespan=function(){},e.prototype.startTimespan=function(e){if(performance.mark&&"function"==typeof performance.mark){var t=this._formatEvent(e),n=this._nextMarkId.toString();return this._nextMarkId++,performance.mark(n),this._endTimespan.bind(this,t,n)}return function(){}},e.prototype._endTimespan=function(e,t){performance.measure(e,t),performance.clearMarks(t),performance.clearMeasures(e)},e.prototype._formatEvent=function(e){return e.getZone()+" "+e.getName()},e}();t.BrowserTimelineTransport=r},Hswk:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
Object.getType=function(e){let t=e.constructor;return null!=t&&!t.__typeName&&e.$$genericConstructor&&(t=e.$$genericConstructor),t&&"function"==typeof t&&"Object"!==t.__typeName?t:Object};const r=function(e,t,n){const r="$$d_"+n;return null==e[r]&&(e[r]=t.bind(e)),e[r]}},"I/gz":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"d",(function(){return a})),n.d(t,"e",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return s}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="bootPersona.Action",a="set.PresenceStatus.Action",i="set.ProfilePhoto.Action",o="remove.PresenceStatuses.Action",s="remove.ProfilePhotos.Action"},I1N9:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("504W"),a=n("yQs0"),i=n("YIt1"),o=n("RIwK");class s{constructor(e,t,n,a){this._FilterExpressionId=null,this._FilterOperator=0,this._IsQuickFindFields=!1,this._Hint=null,this._Conditions=null,this._FilterExpressions=null,this._set_filterOperator(e),this.set_filterExpressionId(t),this._set_filterExpressions([]),Object(r.a)(n)?this._set_isQuickFindFields(!1):this._set_isQuickFindFields(n),Object(r.a)(a)?this._set_hint(null):this._set_hint(a)}get_filterExpressionId(){return this._FilterExpressionId}set_filterExpressionId(e){return this._FilterExpressionId=e,e}get_filterOperator(){return this._FilterOperator}_set_filterOperator(e){return this._FilterOperator=e,e}get_isQuickFindFields(){return this._IsQuickFindFields}_set_isQuickFindFields(e){return this._IsQuickFindFields=e,e}get_hint(){return this._Hint}_set_hint(e){return this._Hint=e,e}get_conditions(){return this._Conditions}_set_conditions(e){return this._Conditions=e,e}get_filterExpressions(){return this._FilterExpressions}_set_filterExpressions(e){return this._FilterExpressions=e,e}addCondition(e,t,n,i,o){n=Object(r.a)(n)?null:n,o=Object(r.a)(o)?"":o;const s=new a.a(e,t,n);return s.set_entityName(i),s.set_conditionName(o),this.get_conditions()||this._set_conditions([]),this.get_conditions().push(s),this}addFilterExpression(e){return e?(this.get_filterExpressions()||this._set_filterExpressions([]),this.get_filterExpressions().push(e),this):this}clone(){const e=new s(this.get_filterOperator(),this.get_filterExpressionId());if(this.get_conditions()){e._set_conditions([]);for(let t=0;t<this.get_conditions().length;t++)e.get_conditions().push(this.get_conditions()[t].clone())}else e._set_conditions(null);if(this.get_filterExpressions()){e._set_filterExpressions([]);for(let t=0;t<this.get_filterExpressions().length;t++)e.get_filterExpressions().push(this.get_filterExpressions()[t].clone())}else e._set_filterExpressions(null);return e}toFetchXml(){return function e(t){let n="";if(!t||!(t.get_filterExpressions()&&t.get_filterExpressions().length||t.get_conditions()&&t.get_conditions().length))return n;if(t.get_conditions()){t.get_conditions().length>0&&(n+='<filter type="'+i.a[t.get_filterOperator()].toLowerCase()+'"',t.get_isQuickFindFields()&&(n+=' isquickfindfields="1"'),n+=">",Object(r.b)(t.get_hint())||(n+=' hint="'+t.get_hint().toLowerCase()+'"'));for(let e=0;e<t.get_conditions().length;e++){const a=t.get_conditions()[e];if(n+="<condition ",Object(r.b)(a.get_entityName())||(n+='entityname="'+a.get_entityName()+'" '),a.get_value())if(Object.getType(a.get_value())===String)n+='attribute="'+a.get_attributeName()+'" operator="'+a.get_operator()+'" value="'+Object(o.a)(a.get_value())+'" />';else{const e=a.get_value();n+='attribute="'+a.get_attributeName()+'" operator="'+a.get_operator()+'">';for(let t=0;t<e.length;t++)n+="<value>"+Object(o.b)(e[t])+"</value>";n+="</condition>"}else n+='attribute="'+a.get_attributeName()+'" operator="'+a.get_operator()+'"/>'}t.get_conditions().length>0&&(n+="</filter>")}else{t.get_filterExpressions().length>1&&(n+='<filter type="'+i.a[t.get_filterOperator()].toLowerCase()+'"',t.get_hint()&&(n+=' hint="'+t.get_hint().toLowerCase()+'"'),n+=">");for(let r=0;r<t.get_filterExpressions().length;r++)n+=e(t.get_filterExpressions()[r]);t.get_filterExpressions().length>1&&(n+="</filter>")}return n}(this)}}},I4Rv:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return c}));var r=n("GYDS"),a=n("P7gI");var i=n("Knfm"),o=n("GEbX");const s="commanding.registerCommandManagerToPage";function c(e,t){return{type:"commanding.registerCommandManagerToPage.sync",sync:!0,execute:({getState:n,dispatch:c},l)=>{const u=n();if(!(Object(i.a)(u)===o.a.MultiSession)||Object(r.c)(t,!0))return;const d=Object(r.b)(u,e);if(!d||0===d.length){const t=function(e){return(t,n)=>{const i=t(),o=Object(r.b)(i,e);return o&&o.length>0&&n(Object(a.a)(o)),Promise.resolve()}}(e);l.Router.registerPreCloseHandler(e,t)}c(function(e,t){return{type:s,payload:e,meta:{commandManagerId:t}}}(e,t))}}}},I6RZ:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n("0kGT"),a=n("z6CD"),i=n("si7p"),o=n("voMr"),s=n("n3bs"),c=n("b8TU");function l(e,t){var n;const l=Object(r.c)(e),u=Object(a.a)(e,t),d=Object(c.d)(e);return l&&((null==u?void 0:u.modalDialogType)===i.c&&(null===(n=null==u?void 0:u.dialogOptions)||void 0===n?void 0:n.allowNativeDialog)||d&&(null==u?void 0:u.pageType)===s.a.QUICK_CREATE)?o.a.Native:o.a.Web}},I8bZ:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.Error=1]="Error",e[e.Warning=2]="Warning",e[e.Information=3]="Information",e[e.UserDefined=4]="UserDefined"}(r||(r={}))},IJw9:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("lUjt");t._BondDataType=r._BondDataType;var a=n("6RYU");t._Encoding=a;var i=n("VS6r");t.IO=i;var o=n("SNT6");t.Int64=o.Int64,t.UInt64=o.UInt64,t.Number=o.Number;var s=function(){function e(e){this._stream=e}return e.prototype._WriteBlob=function(e){this._stream._Write(e,0,e.length)},e.prototype._WriteBool=function(e){this._stream._WriteByte(e?1:0)},e.prototype._WriteContainerBegin=function(e,t){this._WriteUInt8(t),this._WriteUInt32(e)},e.prototype._WriteMapContainerBegin=function(e,t,n){this._WriteUInt8(t),this._WriteUInt8(n),this._WriteUInt32(e)},e.prototype._WriteDouble=function(e){var t=a._Double_GetBytes(e);this._stream._Write(t,0,t.length)},e.prototype._WriteFieldBegin=function(e,t,n){t<=5?this._stream._WriteByte(e|t<<5):t<=255?(this._stream._WriteByte(192|e),this._stream._WriteByte(t)):(this._stream._WriteByte(224|e),this._stream._WriteByte(t),this._stream._WriteByte(t>>8))},e.prototype._WriteInt32=function(e){e=a._Zigzag_EncodeZigzag32(e),this._WriteUInt32(e)},e.prototype._WriteInt64=function(e){this._WriteUInt64(a._Zigzag_EncodeZigzag64(e))},e.prototype._WriteString=function(e){if(""===e)this._WriteUInt32(0);else{var t=a._Utf8_GetBytes(e);this._WriteUInt32(t.length),this._stream._Write(t,0,t.length)}},e.prototype._WriteStructEnd=function(e){this._WriteUInt8(e?r._BondDataType._BT_STOP_BASE:r._BondDataType._BT_STOP)},e.prototype._WriteUInt32=function(e){var t=a._Varint_GetBytes(o.Number._ToUInt32(e));this._stream._Write(t,0,t.length)},e.prototype._WriteUInt64=function(e){var t=a._Varint64_GetBytes(e);this._stream._Write(t,0,t.length)},e.prototype._WriteUInt8=function(e){this._stream._WriteByte(o.Number._ToUInt8(e))},e}();t.CompactBinaryProtocolWriter=s},IKHO:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s}));var r=n("omgb"),a=n("a475"),i=n("H4dV");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function o(){return i.a.getInstance().get_isMailApp()?r.a.MailApp:"phone"===a.a.get_Instance().get_device().get_DeviceState().get_formFactor().toLowerCase()?r.a.Phone:r.a.Slate}function s(){return o()===r.a.MailApp}},ILmX:function(e,t,n){"use strict";n.d(t,"a",(function(){return v})),n.d(t,"o",(function(){return O})),n.d(t,"k",(function(){return b})),n.d(t,"f",(function(){return d})),n.d(t,"g",(function(){return p})),n.d(t,"i",(function(){return f})),n.d(t,"m",(function(){return g})),n.d(t,"b",(function(){return h})),n.d(t,"h",(function(){return m})),n.d(t,"e",(function(){return E})),n.d(t,"n",(function(){return C})),n.d(t,"c",(function(){return w})),n.d(t,"l",(function(){return y})),n.d(t,"j",(function(){return T})),n.d(t,"p",(function(){return I})),n.d(t,"d",(function(){return N}));var r=n("arV0"),a=n("SRl2"),i=n("wgH2"),o=n("M0zh"),s=n("GT4X"),c=n("UIlN"),l=n("504W"),u=n("eD3A");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function d(e,t){const{entityTypeName:n}=Object(r.j)(e,t.id);return n?o.g+n:null}function p(e){return e?o.g+e:null}function f(e){return e?o.i+e:null}function g(e){return e?o.u+e:null}function h(e){return e?o.t+e:null}function m(){return o.h+"null"}function b(e,t){if(t){const n=Object(a.b)(e,t);if(n&&!0===(null==n?void 0:n.IsUncustomized)){const n=Object(i.a)(t),r=Object(i.b)(t);if("null"!==n)return Object(a.b)(e,`${r}:${o.c}`)}return n}return null}function y(e,t,n){const r=Object(c.a)(e,t);return(null==r?void 0:r.ribbonId)&&b(e,r.ribbonId)||b(e,n)}function _(e,t,n,r){if(null===e||" "===e||void 0===e)return!1;{const a=Object(s.e)(n,t),i=a&&a[e];if(!i)return!1;if("visible"===r)return i.visible;if("enabled"===r)return i.enabled;if("hasSelectionCountRule"===r)return i.hasSelectionCountRule;if("hasVisibilityExpression"===r)return i.hasVisibilityExpression;if("canBeVisibleOffline"===r)return i.canBeVisibleOffline;if("canBeVisibleForHierarchy"===r)return i.canBeVisibleForHierarchy}}function v(e,t){var n,r,a,i,o,s,c;const l=null==e?void 0:e.Layout;if(!l)return[];const u=[...null!==(n=l.Tabs.Tab)&&void 0!==n?n:[],...null!==(r=l.ContextualTabs.Tab)&&void 0!==r?r:[]],d=[];for(const e of u){const t=null!==(i=null===(a=null==e?void 0:e.Groups)||void 0===a?void 0:a.Group)&&void 0!==i?i:[];for(const e of t)Array.prototype.push.apply(d,e.Controls.Items)}if(t)for(let e=0;e<d.length;e++){const t=d[e];if(!("Menu"in t))continue;const n=null!==(s=null===(o=t.Menu)||void 0===o?void 0:o.MenuSection)&&void 0!==s?s:[];for(const e of n)Array.prototype.push.apply(d,null===(c=e.Item)||void 0===c?void 0:c.Items)}return d}function S(e,t){var n;const r=null===(n=null==t?void 0:t.controlsMap)||void 0===n?void 0:n[e];return r&&(!Object(l.a)(r.enabled)||!Object(l.a)(r.visible))}function O(e,t,n,r,a){var i;const o=null===(i=null==t?void 0:t.controlsMap)||void 0===i?void 0:i[e];if(!o)return!1;const{visible:s,enabled:c,hasSelectionCountRule:l,hasVisibilityExpression:u,canBeVisibleOffline:d,canBeVisibleForHierarchy:p}=o,f=t.controlAllowList;return s&&c&&(u||l||!n)&&(d||r)&&(p||!a)&&(!f||f[e])}function C(e,t,n,r,a){return E(e,v(t,!0),n,r,a)}function E(e,t,n,a,o){const s={};t=null!=t?t:[];const l=Object(c.a)(e,a),d=Object(r.j)(e,n),p=!Object(u.g)(e,null==d?void 0:d.entityTypeName),f=I(e,n);for(const e of t)if(e.Id){const t=T(e.Id,Object(i.a)(null==l?void 0:l.ribbonId));S(t,l)&&(s[t]=O(t,l,o,p,f))}return s}function I(e,t){const n=Object(r.j)(e,t);return n&&n.customControlId&&"mscrmcontrols.hierarchycontrol.hierarchycontrol"===n.customControlId.toLowerCase()}function w(e,t,n,a,i){var o;const s={};for(const l in t){const d=""===t[l].commandId||t[l].commandId?t[l].commandId.split("|"):[],p=d.length>0&&""===d[0]?"null":d[0],f=4===d.length?d[3]:"null",g=Object(r.j)(e,n),h=!Object(u.g)(e,null==g?void 0:g.entityTypeName),m=j(e,t,l,a),b=P(e,t,l,a),y=Object(c.a)(e,a),_=null===(o=null==y?void 0:y.controlsMap)||void 0===o?void 0:o[l],v=!i||_.hasSelectionCountRule||_.hasVisibilityExpression,S=h||_.canBeVisibleOffline,O=!I(e,n)||_.canBeVisibleForHierarchy,C=y.controlAllowList,E=!C||C[l],w={ControlId:l,LabelText:t[l].labelText?t[l].labelText:"null",CommandType:p,CanExecute:m&&b&&S&&O&&E,ShouldBeVisible:m&&b&&S&&O&&v&&E,CommandId:f,Priority:t[l].priority,Icon:t[l].icon,Tooltip:t[l].tooltip};s[l]=w}return s}function j(e,t,n,r){return t[n]&&void 0!==t[n].visible?t[n].visible:function(e,t,n){return _(t,n,e,"visible")}(e,n,r)}function P(e,t,n,r){return t[n]&&void 0!==t[n].enabled?t[n].enabled:function(e,t,n){return _(t,n,e,"enabled")}(e,n,r)}function T(e,t){let n=e;if(n){const e=n.split("|");n=e.length>0?e[e.length-1]:n}return t&&""!==t&&"null"!==t&&(n=n.replace(new RegExp(o.c,"g"),t)),n}function N(e,t,n){const r=function(e,t,n){var r;const a=Object(c.a)(e,t),o=T(n,Object(i.a)(null==a?void 0:a.ribbonId));return null===(r=null==a?void 0:a.controlsMap)||void 0===r?void 0:r[o]}(e,t,n);return null==r?void 0:r.commandValueId}},"IMR+":function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.logMessage=t.logIssue=t.clearLog=t.getLog=t.PerformanceEventLogLevel=void 0;var a,i=r(n("zI6t")),o=n("3ZMs");!function(e){e[e.General=0]="General",e[e.Warning=1]="Warning",e[e.Error=2]="Error"}(a||(a={})),t.PerformanceEventLogLevel=a;var s=[];function c(e){s.push({level:e.level===o.PerformanceIssueLevel.Error?a.Error:a.Warning,message:e})}i.default.subscribeToPerformanceIssues((function(e){c(e)})),t.getLog=function(){return s},t.logMessage=function(e){s.push({level:a.General,message:e})},t.logIssue=c,t.clearLog=function(){s=[]}},IVVt:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.All=0]="All",e[e.ValidForCreate=1]="ValidForCreate",e[e.ValidForUpdate=2]="ValidForUpdate",e[e.ValidForRead=3]="ValidForRead"}(r||(r={}))},IYuw:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return o}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="appshell.setHideAppNameInTopBar",a="appshell.setSuppressSessionCloseWarning";function i(e){return{type:r,payload:{hideAppNameInTopBar:e}}}function o(e){return{type:a,payload:{suppressSessionCloseWarning:e}}}},IaGr:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="clientApiGlobalStoreManager";class a{constructor(e,t){this._eventManager=e,this._traceManager=t}static initialize(e,t,n){e[r]=new a(t,n)}static getInstance(e,t){return window[r]||(window[r]=new a(e,t),t&&t.getTracer("XrmClientApiGlobalStore").warn("XrmClientApiGlobalStore accessed before initialization")),window[r]}get eventManager(){return this._eventManager}get traceManager(){return this._traceManager}}},IdrN:function(e,t,n){"use strict";n.d(t,"a",(function(){return j}));var r=n("iLty"),a=n("g73c"),i=n("84PK"),o=n("c7Og"),s=n("504W"),c=n("2JG5"),l=n("NMtn");class u{constructor(e,t,n,r){if(this._entityMetadata=null,this._entityMetadataNodes=null,this._deserialized=!1,this._deserializerCallback=null,Object(l.d)(t,"serverVersionStamp"),!(e.get_count&&e.get_item||e instanceof Array))throw Error.argumentType("data");this._entityMetadata=new Array(0),e.get_count&&e.get_item?(this._entityMetadataNodes=e,this._deserializerCallback=r,this._deserialized=!1):(this._entityMetadata=e,this._deserialized=!0)}get_count(){return this._deserialized?this._entityMetadata.length:this._entityMetadataNodes.get_count()}get_item(e){return Object(s.a)(this._entityMetadata[e])&&!Object(s.a)(this._entityMetadataNodes.get_item(e))&&(this._entityMetadata[e]=this._deserializerCallback(this._entityMetadataNodes.get_item(e).get_element()),this._entityMetadata[e]=this._entityMetadata[e]),this._entityMetadata[e]}}var d=n("KLhE"),p=n("dFCJ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function f(e){for(let t=0,n=e.childNodes.length;t<n;t++){const n=e.childNodes[t];if("a:value"===n.nodeName.toLowerCase())return Boolean.parse(n.firstChild.nodeValue).valueOf()}return!1}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class g{constructor(e,t){this._hasSecuredAttributes=!1,this._hasStateCode=!1,this._hasSecuredAttributes=e,this._hasStateCode=t}get_hasSecuredAttributes(){return this._hasSecuredAttributes}get_hasStateCode(){return this._hasStateCode}}var h,m=n("OBdv");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */!function(e){e[e.none=0]="none",e[e.create=1]="create",e[e.read=2]="read",e[e.write=3]="write",e[e.Delete=4]="Delete",e[e.assign=5]="assign",e[e.share=6]="share",e[e.append=7]="append",e[e.appendTo=8]="appendTo"}(h||(h={}));var b=n("b6oC"),y=n("VJwX"),_=n("Jz2d");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function v(e){const t=[];for(let n=0,r=e.childNodes.length;n<r;n++){const r=e.childNodes[n];let o=null,s=i.a.get_empty(),c=0,l=!1,u=!1,d=!1,p=!1;for(let e=0,t=r.childNodes.length;e<t;e++){const t=r.childNodes[e];if(t.namespaceURI===_.a.xrm2011MetadataNamespace){switch(Object(y.b)(t.nodeName)){case"Name":o=t.firstChild.nodeValue;break;case"PrivilegeId":s=new i.a(t.firstChild.nodeValue);break;case"PrivilegeType":c=Object(a.a)(h,t.firstChild.nodeValue);break;case"CanBeBasic":l=Boolean.parse(t.firstChild.nodeValue).valueOf();break;case"CanBeLocal":u=Boolean.parse(t.firstChild.nodeValue).valueOf();break;case"CanBeDeep":d=Boolean.parse(t.firstChild.nodeValue).valueOf();break;case"CanBeGlobal":p=Boolean.parse(t.firstChild.nodeValue).valueOf()}}}t.push(new b.a(o,s,c,l,u,d,p))}return t}var S=n("Z6YS"),O=n("fMBw"),C=n.n(O);function E(e){return function(e,t){let n=null,r=null,l=!0,u=!1,p=!1,g=null,h=i.a.get_empty(),b=!1,S=!0,O=!0,C=!1,E=-1,j=null,P=null,T=null,N=new Array(0),A=!1,R=!1,D=!1,x=!1,M=!1,F=!1,k=!1,L=!1,B=!1,U=!1,V=!1,z=!1,q=0,H=0,W=!1,G=null,K=!1,Q=!1,X=!1,Y=!1,J=null,$=!1,Z=!1;const ee={AllowMainFormDialogForCreate:!1,AllowMainFormDialogForEdit:!1};let te=!1,ne=!1,re=!1,ae=!1,ie=!1,oe=null,se=!1,ce=null,le=null,ue=null,de=null;for(let t=0,o=e.childNodes.length;t<o;t++){const o=e.childNodes[t];if(o.namespaceURI===_.a.xrm2011MetadataNamespace){if("true"===o.getAttribute("i:nil")||!o.firstChild)continue;switch(Object(y.b)(o.nodeName)){case"DisplayCollectionName":r=Object(m.a)(o);break;case"DisplayName":n=Object(m.a)(o);break;case"HasChanged":l=Boolean.parse(o.firstChild.nodeValue).valueOf();break;case"IsActivity":u=Boolean.parse(o.firstChild.nodeValue).valueOf();break;case"IsChildEntity":p=Boolean.parse(o.firstChild.nodeValue).valueOf();break;case"IsReadOnlyInMobileClient":b=w(o,b);break;case"IsVisibleInMobileClient":S=w(o,S);break;case"IsOfflineInMobileClient":O=w(o,O);break;case"IsOptimisticConcurrencyEnabled":C=Boolean.parse(o.firstChild.nodeValue).valueOf();break;case"LogicalName":g=o.firstChild.nodeValue;break;case"MetadataId":h=new i.a(o.firstChild.nodeValue);break;case"ManyToOneRelationships":ue=o;break;case"OneToManyRelationships":de=o;break;case"ObjectTypeCode":E=Number.parseInvariant(o.firstChild.nodeValue);break;case"PrimaryIdAttribute":j=o.firstChild.nodeValue;break;case"PrimaryNameAttribute":P=o.firstChild.nodeValue;break;case"PrimaryImageAttribute":T=o.firstChild.nodeValue;break;case"Privileges":N=v(o);break;case"IsValidForAdvancedFind":A=Boolean.parse(o.firstChild.nodeValue).valueOf();break;case"IsMailMergeEnabled":R=f(o);break;case"IsConnectionsEnabled":D=f(o);break;case"IsCustomizable":x=f(o);break;case"IsActivityParty":M=Boolean.parse(o.firstChild.nodeValue).valueOf();break;case"IsImportable":F=Boolean.parse(o.firstChild.nodeValue).valueOf();break;case"IsEnabledForCharts":k=Boolean.parse(o.firstChild.nodeValue).valueOf();break;case"IsCustomEntity":L=Boolean.parse(o.firstChild.nodeValue).valueOf();break;case"IsStateModelAware":B=Boolean.parse(o.firstChild.nodeValue).valueOf();break;case"EnforceStateTransitions":U=Boolean.parse(o.firstChild.nodeValue).valueOf();break;case"IsValidForQueue":V=w(o,V);break;case"ActivityTypeMask":q=Number.parseInvariant(o.firstChild.nodeValue);break;case"OwnershipType":H=Object(a.a)(d.a,o.firstChild.nodeValue);break;case"IsBusinessProcessEnabled":z=Boolean.parse(o.firstChild.nodeValue).valueOf();break;case"EntityHelpUrlEnabled":W=Boolean.parse(o.firstChild.nodeValue).valueOf();break;case"EntityHelpUrl":G=o.firstChild.nodeValue;break;case"IsDocumentManagementEnabled":K=Boolean.parse(o.firstChild.nodeValue).valueOf();break;case"IsOneNoteIntegrationEnabled":Q=Boolean.parse(o.firstChild.nodeValue).valueOf();break;case"IsMSTeamsIntegrationEnabled":X=Boolean.parse(o.firstChild.nodeValue).valueOf();break;case"EntityColor":J=o.firstChild.nodeValue;break;case"IsInteractionCentricEnabled":$=Boolean.parse(o.firstChild.nodeValue).valueOf();break;case"IsQuickCreateEnabled":Z=Boolean.parse(o.firstChild.nodeValue).valueOf();break;case"EntityClientSetting":ee.AllowMainFormDialogForCreate=Boolean.parse(o.firstChild.firstChild.nodeValue).valueOf(),ee.AllowMainFormDialogForEdit=Boolean.parse(o.childNodes[1].firstChild.nodeValue).valueOf();break;case"IsKnowledgeManagementEnabled":te=Boolean.parse(o.firstChild.nodeValue).valueOf();break;case"IsDocumentRecommendationsEnabled":re=Boolean.parse(o.firstChild.nodeValue).valueOf();break;case"IsIntersect":ae=Boolean.parse(o.firstChild.nodeValue).valueOf();break;case"UsesBusinessDataLabelTable":ne=Boolean.parse(o.firstChild.nodeValue).valueOf();break;case"IconVectorName":oe=o.firstChild.nodeValue;break;case"IsBPFEntity":se=Boolean.parse(o.firstChild.nodeValue).valueOf()}}}if(p&&ue){const e=function(e){for(let t=0,n=e.childNodes.length;t<n;t++){const n=e.childNodes[t];if(n.namespaceURI===_.a.xrm2011MetadataNamespace&&"OneToManyRelationshipMetadata"===Object(y.b)(n.nodeName)){let e=!1,t=null,r=null;for(let a=0,i=n.childNodes.length;a<i;a++){const i=n.childNodes[a];if(i.namespaceURI===_.a.xrm2011MetadataNamespace&&i.firstChild){switch(Object(y.b)(i.nodeName)){case"SecurityTypes":e="ParentChild"===i.firstChild.nodeValue;break;case"ReferencedEntity":t=i.firstChild.nodeValue;break;case"ReferencingAttribute":r=i.firstChild.nodeValue}}}if(e)return new o.a(t,r)}}return null}(ue);Object(s.a)(e)||(ce=e.get_key(),le=e.get_value())}de&&(Y=I(de,"activitypointer","regardingobjectid"),ie=I(de,"annotation","objectid"));return new c.a(h,g,n,r,E,j,P,T,N,b,S,O,C,l,u,p,ce,le,A,R,D,x,M,F,k,L,B,U,V,q,H,t.get_hasSecuredAttributes(),t.get_hasStateCode(),z,W,G,K,Q,X,Y,J,$,Z,ee,te,re,ae,ie,ne,oe,se,-1,-1,null)}(e,function(e){let t=null,n=!1,r=!1;const a=[];for(let i=0,o=e.childNodes.length;i<o;i++){const o=e.childNodes[i];if(o.namespaceURI===_.a.xrm2011MetadataNamespace){if("true"===o.getAttribute("i:nil")||!o.firstChild)continue;const e=Object(y.b)(o.nodeName);if("Attributes"===e){for(let e=0,t=o.childNodes.length;e<t;e++){const t=o.childNodes[e];if(t.namespaceURI===_.a.xrm2011MetadataNamespace&&"AttributeMetadata"===Object(y.b)(t.nodeName)){const e=Object(p.a)(t);e&&(e.get_isSecured()&&(n=!0),"statecode"===e.get_logicalName()&&(r=!0),a.push(e))}}if(!Object(s.a)(t))break}else if("LogicalName"===e&&(t=o.firstChild.nodeValue,!Object(s.a)(a)))break}}return new g(n,r)}(e))}function I(e,t,n){for(let r=0,a=e.childNodes.length;r<a;r++){const a=e.childNodes[r];if(a.namespaceURI===_.a.xrm2011MetadataNamespace&&"OneToManyRelationshipMetadata"===Object(y.b)(a.nodeName)){let e=!1,r=!1;for(let i=0,o=a.childNodes.length;i<o;i++){const o=a.childNodes[i];if(o.namespaceURI===_.a.xrm2011MetadataNamespace&&o.firstChild){const a=Object(y.b)(o.nodeName);"ReferencingEntity"===a&&o.firstChild.nodeValue===t?e=!0:"ReferencingAttribute"===a&&o.firstChild.nodeValue===n&&(r=!0)}}if(e&&r)return!0}}return!1}function w(e,t){for(let t=0,n=e.childNodes.length;t<n;t++)if(e.childNodes[t].namespaceURI===_.a.xrm2011ContractsNamespace&&"Value"===Object(y.b)(e.childNodes[t].nodeName))return Boolean.parse(e.childNodes[t].firstChild.nodeValue).valueOf();return t}class j extends r.a{constructor(e){super(e),this._responseResultsNode=null,this._entityMetadataCollection=null,e&&(this._responseResultsNode=e.selectSingleNode(".//d:ExecuteResult/a:Results"))}get_entityMetadataCollection(){return!this._entityMetadataCollection&&this.get_soapResponse()&&this._responseResultsNode&&(this._entityMetadataCollection=function(e){const t=C.a.createEvent("LoadFromCrmSoap","EntityMetadataCollection").startStopwatch(),n=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='ServerVersionStamp']/b:value").get_innerText();e.addNamespace("c",_.a.xrm2011MetadataNamespace);const r=e.selectNodes(".//a:KeyValuePairOfstringanyType[b:key='EntityMetadata']/b:value/a:EntityMetadata");e.addNamespace("c",_.a.xrm2011MetadataQueryNamespace),e.addNamespace("d",S.a.microsoft2003SerializationArraysNamespace);const a=e.selectNodes(".//a:KeyValuePairOfstringanyType[b:key='DeletedMetadata']/b:value/c:KeyValuePairOfDeletedMetadataFiltersArrayOfguidPlUv_PKtF[b:key='Attribute']/b:value/d:guid"),o=new Array(0),s=a.get_count();for(let e=0;e<s;e++)o[e]=new i.a(a.get_item(e).get_innerText());return t(),new u(r,n,o,E)}(this._responseResultsNode)),this._entityMetadataCollection}}},IfHN:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("Qjw6"),a=n("SAYH"),i=n("D+Bz"),o=n("n3bs"),s=n("N6E8"),c=n("xagu"),l=n("AKum");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const u={type:i.a.Page,pageType:o.a.ENTITY_RECORD,factory:r.b,isRedirect:!0,urlToInput(e){let t=null,n=null,r=null,i=null,s=null,l=null,u=null,d=null,p=null,f=null,g=null,h=null,m=null;const b=e.searchParams,y=b.get(c.u),_=a.a.tryParseOrNull(b.get(c.z)),v=new URLSearchParams(b.get(c.v)),S=b.get(c.J);b.has(c.D)&&"true"===b.get(c.D).toLowerCase()&&(h=!0);const O=S===o.a.ENTITY?o.a.ENTITY_RECORD:S;try{if(b.has(c.i)&&b.get(c.i)){const e=b.get(c.i),n=decodeURIComponent(e);t=JSON.parse(n)}}catch(e){throw Error(e)}return b.has(c.x)?n=a.a.tryParseOrNull(b.get(c.x)):b.has(c.v)&&(n=a.a.tryParseOrNull(v.get(c.x))),b.has(c.v)&&(t||(t={}),v.forEach((e,n)=>{n===c.x||n in t||(t[n]=e)})),b.has(c.T)&&(r=decodeURIComponent(b.get(c.T))),b.has(c.H)&&(f=b.get(c.H)),b.has(c.R)&&(i=b.get(c.R)),b.has(c.S)&&(s=b.get(c.S)),b.has(c.W)&&(l=b.get(c.W)),b.has(c.X)&&(u=b.get(c.X)),b.has(c.A)&&(d="true"===b.get(c.A)),b.has(c.C)&&(p="true"===b.get(c.C)),b.has(c.a)&&(g="true"===b.get(c.a)),b.has(c.w)&&(m="true"===b.get(c.w)),{entityTypeName:y,formId:n,id:_,pageType:O,data:t,recordSetQueryKey:r,processId:i,processInstanceId:s,selectedStageId:l,selectedTabId:u,isCrossEntityNavigate:d,isOfflineSyncError:p,navItemId:f,bodyOnly:g,isPreview:h,forceOfflineDataSync:m}},inputToUrl(e,t,n){let r=Object.assign({},t.data);const i=new URL(e,window.location.origin),o=i.searchParams,l=t.initWithEntity;if(void 0!==t.entityTypeName?o.set(c.u,t.entityTypeName):o.set(c.u,t.etn),l&&!(r.hasOwnProperty(s.d+"id")&&r.hasOwnProperty(s.d+"type")&&r.hasOwnProperty(s.d+"name"))){const e={[s.d+"id"]:l.id.guid,[s.d+"type"]:l.etn,[s.d+"name"]:l.name};r=Object.assign(Object.assign({},r),e),t.data=r}if(t.id&&!a.a.isNullOrEmpty(t.id)&&o.set(c.z,a.a.toString(t.id)),t.formId&&o.set(c.x,t.formId.guid.toString()),n&&r&&0!==Object.keys(r).length){const e=JSON.stringify(r),t=encodeURIComponent(e);o.set(c.i,t)}return t.processId&&o.set(c.R,t.processId),t.processInstanceId&&o.set(c.S,t.processInstanceId),t.selectedStageId&&o.set(c.W,t.selectedStageId),t.isCrossEntityNavigate&&o.set(c.A,t.isCrossEntityNavigate.toString()),t.isOfflineSyncError&&o.set(c.C,t.isOfflineSyncError.toString()),t.navItemId&&o.set(c.H,t.navItemId),null!=t.bodyOnly&&o.set(c.a,t.bodyOnly.toString()),t.forceOfflineDataSync&&o.set(c.w,encodeURIComponent(t.forceOfflineDataSync)),i.href},inputToWebUrl(e,t){const n=new URL(e,window.location.origin),r=n.searchParams;t.entityTypeName&&r.set(l.b,t.entityTypeName);const i=a.a.toString(t.id);return i&&r.set(l.d,i),r.set(l.e,"entityrecord"),n.href}};Object.freeze(u)},Ii8m:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("lq82"),a=n("arV0"),i=n("QiMq"),o=n("nC8a"),s=n("Tz6o");function c(e,t){return{type:"tab.remember_selected_tab",sync:!0,execute({dispatch:n,getState:c},l,u){if(!t)return;const d=Object(a.j)(c(),e);let p;"string"==typeof t?(p={selectedTabId:t,selectedRelatedEntity:void 0},d&&d.selectedTabId&&n(Object(i.b)(e,d.selectedTabId))):p={selectedTabId:void 0,selectedRelatedEntity:t};const f=Object.assign(Object.assign({},d),p);Object(a.h)(c(),e)||Object(o.a)(c(),e)?n(Object(s.d)(f,e)):n(Object(r.c)(f,e))}}}},InN9:function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return T})),n.d(t,"a",(function(){return j}));var r,a=n("mMyr"),i=n("huli");!function(e){e[e.left=0]="left",e[e.right=1]="right",e[e.up=2]="up",e[e.down=3]="down",e[e.leftup=4]="leftup",e[e.rightup=5]="rightup",e[e.upleft=6]="upleft",e[e.downleft=7]="downleft"}(r||(r={}));var o=n("pGYJ"),s=n("W8Pl");function c(){return{width:document.body.offsetWidth,height:document.body.offsetHeight}}function l(){var e=document.getElementById("topBar-mobile"),t=u(),n=c();return{left:document.body.scrollLeft,top:document.body.scrollTop,right:t.width-n.width-document.body.scrollLeft,bottom:e?e.offsetHeight:t.height-n.height-document.body.scrollTop}}function u(){return{width:document.body.scrollWidth,height:document.body.scrollHeight}}function d(e){return{width:e.offsetWidth-e.clientWidth+e.scrollWidth,height:e.offsetHeight-e.clientHeight+e.scrollHeight}}function p(e,t,n,r){void 0===n&&(n=c()),void 0===r&&(r=l());var a={},i=t.maxWidth&&t.width&&t.maxWidth>0&&t.maxWidth<t.width?t.maxWidth:t.width?t.width:0,o=t.maxHeight&&t.height&&t.maxHeight>0&&t.maxHeight<t.height?t.maxHeight:t.height?t.height:0;return"number"==typeof e.left?(a.width=Math.max(r.left-e.left,0),a.width+=Math.max(e.left+i-n.width-r.left,0)):"number"==typeof e.right&&(a.width=Math.max(r.right-e.right,0),a.width+=Math.max(e.right+i-n.width-r.right,0)),"number"==typeof e.top?(a.height=Math.max(r.top-e.top,0),a.height+=Math.max(e.top+o-n.height-r.top,0)):"number"==typeof e.bottom&&(a.height=Math.max(r.bottom-e.bottom,0),a.height+=Math.max(e.bottom+o-n.height-r.bottom,0)),a}function f(e){switch(e){case r.down:return[r.down,r.downleft,r.up,r.upleft,r.right,r.rightup,r.left,r.leftup];case r.downleft:return[r.downleft,r.down,r.upleft,r.up,r.right,r.rightup,r.left,r.leftup];case r.right:return[r.right,r.rightup,r.left,r.leftup,r.down,r.downleft,r.up,r.upleft];case r.rightup:return[r.rightup,r.right,r.leftup,r.left,r.down,r.downleft,r.up,r.upleft];case r.up:return[r.up,r.upleft,r.down,r.downleft,r.right,r.rightup,r.left,r.leftup];case r.upleft:return[r.upleft,r.up,r.downleft,r.down,r.right,r.rightup,r.left,r.leftup];case r.left:return[r.left,r.leftup,r.right,r.rightup,r.down,r.downleft,r.up,r.upleft];case r.leftup:return[r.leftup,r.left,r.rightup,r.right,r.down,r.downleft,r.up,r.upleft];default:var t="";try{t=JSON.stringify(e)}catch(e){t="Unable to parse initial direction"}var n=new Error("Unexpected initial direction: "+t);throw s.b.Reporting.reportFailure(o.a+".Primitive.Flyout",n),n}}function g(e,t,n){var a=function(e,t){void 0===t&&(t=document.body);var n=t.getBoundingClientRect(),r=e.getBoundingClientRect();return{top:r.top-n.top,left:r.left-n.left}}(n,document.body),i=n.getBoundingClientRect(),o=c(),s={top:a.top,left:a.left,width:i.width,height:i.height,right:a.left+i.width,bottom:a.top+i.height},l=s.top,u=s.right,d=null,p=null;function f(){return e.maxWidth&&e.maxWidth<e.width?e.maxWidth:e.width}function g(){return e.maxHeight&&e.maxHeight<e.height?e.maxHeight:e.height}switch(t){case r.rightup:e&&e.height?l=s.bottom-g():(l=void 0,p=o.height-s.bottom);break;case r.up:e&&e.height?l=s.top-g():(p=o.height-s.top,l=void 0),u=s.left;break;case r.upleft:e&&e.height?l=s.top-g():(p=o.height-s.top,l=void 0),e&&e.width?u=s.right-f():(u=void 0,d=o.width-s.right);break;case r.down:l=s.bottom,u=s.left;break;case r.downleft:l=s.bottom,e&&e.width?u=s.right-f():(u=void 0,d=o.width-s.right);break;case r.left:l=s.top,e&&e.width?u=s.left-f():d=o.width-s.left;break;case r.leftup:e&&e.height?l=s.bottom-g():(l=void 0,p=o.height-s.bottom),e&&e.width?u=s.left-f():d=o.width-s.left}return{left:u,top:l,right:d,bottom:p}}function h(e){var t=window.getComputedStyle(e);return e&&t&&("auto"===t.overflow||"scroll"===t.overflow||"auto"===t.overflowX||"scroll"===t.overflowX||"auto"===t.overflowY||"scroll"===t.overflowY)}var m,b,y=n("kXuq"),_=n("fueu"),v=function(){function e(){this._parentFlyoutNameToChildRootNameMap={}}return e.getInstance=function(){return m||(m=new e),m},e.prototype.mountChildFlyout=function(e,t){this._parentFlyoutNameToChildRootNameMap.hasOwnProperty(e)||(this._parentFlyoutNameToChildRootNameMap[e]=[]),this._parentFlyoutNameToChildRootNameMap[e].push(t)},e.prototype.unmountChildFlyout=function(e,t){if(this._parentFlyoutNameToChildRootNameMap.hasOwnProperty(e)){var n=this._parentFlyoutNameToChildRootNameMap[e],r=n.indexOf(t);return r>-1&&(n.splice(r,1),n.length<1&&delete this._parentFlyoutNameToChildRootNameMap[e]),!1}return!1},e.prototype.getChildRoots=function(e){return this._parentFlyoutNameToChildRootNameMap.hasOwnProperty(e)?this._parentFlyoutNameToChildRootNameMap[e]:[]},e}(),S=n("9lTt"),O=n("N911"),C=n("z0sv"),E=n("Wc1c"),I=(b=function(e,t){return(b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}b(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),w=function(){return(w=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},j="__flyoutRootNode",P=o.a+".Primitive.Flyout",T=function(e){function t(t){var n=e.call(this,t)||this;return n._wasInnerFocusRequested=!1,n._seeMorePopupCount=null,n._previousChildren=null,n._resizeHandler=n.debouncingFlyoutEvent((function(){n._flyoutElement&&n._flyoutElement.offsetHeight>0&&n.updateDom()})),n._scrollHandler=n.debouncingFlyoutEvent((function(){if(n.getIsRelative()&&!n.props.keepWhenRelativeToElementHides){for(var e in n._isOutOfRange=!1,n._scrollableAncestors)if(t=n._getRelativeElement(),r=n._scrollableAncestors[e],t.getBoundingClientRect().top<r.getBoundingClientRect().top||t.getBoundingClientRect().bottom>r.getBoundingClientRect().bottom){n._isOutOfRange=!0;break}var t,r;n.updateDom()}}),100),n.debouncingFlyoutEvent=n.debouncingFlyoutEvent.bind(n),n.handleMeasuring=n.handleMeasuring.bind(n),n.setFlyoutRef=n.setFlyoutRef.bind(n),n.handlePointerDown=n.handlePointerDown.bind(n),n.handleOnScroll=n.props.enableTrackOnScroll?n.handleOnScroll.bind(n):null,n.handleWindowBlur=n.handleWindowBlur.bind(n),n._isClickInsideFlyout=n._isClickInsideFlyout.bind(n),n._portal=a.createRef(),n}return I(t,e),Object.defineProperty(t.prototype,"flyoutElement",{get:function(){return this._flyoutElement},enumerable:!1,configurable:!0}),t.prototype.getFlyoutRootId=function(){return this.props.isPortalToElement&&this.props.portalContainerId?this.props.portalContainerId:t.generateFlyoutId(this.props.parentCustomControlId,this.props.groupId)},t.prototype.componentDidMount=function(){var e=this;this.props.hasDynamicContent&&(this._measuringSubscriber={onMeasure:this.handleMeasuring,getComponent:function(){return e._flyoutElement},getContext:function(){return e.context}},_.a.getInstance().addMeasuringSubscribers(this._measuringSubscriber)),this.updateDom(),this._subscribeFlyoutPopupManager()},t.generateFlyoutId=function(e,t){return(e?e+"|":"")+(t?j+"_"+t:j)},t.prototype.componentDidUpdate=function(){this.updateDom(),_.a.getInstance().updateMeasuringSubscribers(this._measuringSubscriber)},t.prototype.componentWillUnmount=function(){this.removeFromDom(),this.resetFocus(),this.props.hasDynamicContent&&_.a.getInstance().removeMeasuringSubscribers(this._measuringSubscriber),O.a.getInstance().removeSubscribers(this._managerSubscriber)},t.prototype._getRelativeElement=function(){var e=document.getElementById(this.props.relativeToElementId);return e&&this.props.relativeToElementIdSelector&&(e=this.props.relativeToElementIdSelector(e)),e},t.prototype.calculatePosition=function(){var e,t={position:"absolute",visibility:this._isOutOfRange?"hidden":"visible",overflowX:this.props.disableHorizontalScroll?"hidden":"auto",overflowY:this.props.disableVerticalScroll?"hidden":"auto"},n=Object.assign({},this.props.size);if(this.getIsAbsolute())e=this.props.position;else{if(!this.getIsRelative()){var a=new Error("Cannot recognize positioning approach");throw s.b.Reporting.reportFailure(P,a),a}var i=this._getRelativeElement();if(!i)return t.visibility="hidden",t;this._updateActualSize();var o=this.props.children;if(o&&o.props&&o.props.style){var u=new RegExp("^(\\d+)\\s*px$"),d=o.props.style,h=void 0;!n.maxHeight&&d.maxHeight&&(h=u.exec(d.maxHeight))&&(n.maxHeight=parseInt(h[1],10)),!n.maxWidth&&d.maxWidth&&(h=u.exec(d.maxWidth))&&(n.maxWidth=parseInt(h[1],10))}var m={width:n.width||this._actualSize&&this._actualSize.width,maxWidth:n.maxWidth||this._actualSize&&this._actualSize.maxWidth,height:n.height||this._actualSize&&this._actualSize.height,maxHeight:n.maxHeight||this._actualSize&&this._actualSize.maxHeight},b=null===this.props.flyoutDirection||void 0===this.props.flyoutDirection?r.right:this.props.flyoutDirection,y=null;if(null!==this._lastDirection&&void 0!==this._lastDirection&&(y=b,b=this._lastDirection),this.props.enforceDirection)e=g(m,b,i),this._lastDirection=b;else{var _=function(e,t,n,r){if(!e)return{Position:g(e,t,n),Direction:t};var a;null!==r&&r!==t?((a=f(r)).splice(a.indexOf(t),1),a.unshift(t)):a=f(t);for(var i,o,s=t,c=0,l=a;c<l.length;c++){var u=l[c],d=g(e,u,n),h=p(d,e);if(0===h.height&&0===h.width){o=d,s=u,i=h;break}if(i){var m=i.width+i.height;h.width+h.height<m&&(o=d,s=u,i=h)}else o=d,s=u,i=h}return{Position:o,Direction:s}}(m,b,i,y);e=_.Position,this._lastDirection=_.Direction}e.left=e.left>=0?e.left:0}if(this._actualSize){var v=p(e,this._actualSize),S=l();v.width&&!n.width&&(e.left<S.left&&(e.left=S.left),e.right<S.right&&(e.right=S.right)),!v.height||n.height||e.bottom||0===e.bottom||(e.top<S.top&&(e.top=S.top),e.bottom<S.bottom&&(e.bottom=S.bottom))}var O=function(e,t,n){void 0===t&&(t=c()),void 0===n&&(n=l());var r={};return"number"==typeof e.left?r.maxWidth=t.width+n.left-e.left:"number"==typeof e.right&&(r.maxWidth=t.width+n.right-e.right),"number"!=typeof e.top&&"number"!=typeof e.bottom||(r.maxHeight=t.height+n.top-e.top),r}(e),C=O;return n.maxHeight&&n.maxHeight<O.maxHeight&&(C.maxHeight=n.maxHeight),n.maxWidth&&n.maxWidth<O.maxWidth&&(C.maxWidth=n.maxWidth),Object.assign(t,e,C),n.height&&(t.height=n.height),n.width&&(t.width=n.width),t},t.prototype._updateActualSize=function(){if(this._actualSize){var e=d(this._flyoutElement);0!==e.width&&0!==e.height&&(this._actualSize.width===e.width&&this._actualSize.height===e.height||(this._actualSize=d(this._flyoutElement)))}},t.prototype.ensureRootNode=function(){this.rootNode||(this.rootNode=document.getElementById(this.getFlyoutRootId()),this.rootNode||(this.rootNode=document.createElement("div"),this.rootNode.id=this.getFlyoutRootId(),this.rootNode.setAttribute("data-id",this.rootNode.id),this.rootNode.setAttribute("flyoutRoot",this.props.isPortalToElement&&this.props.portalContainerId?"":j),document.body.appendChild(this.rootNode)))},t.prototype.debouncingFlyoutEvent=function(e,t){void 0===t&&(t=200);var n=0;return function(){n||(n=window.setTimeout((function(){e(),n=0}),t))}},t.prototype.handleMeasuring=function(e,t){this._actualSize.width===e&&this._actualSize.height===t||(this._actualSize.width=e,this._actualSize.height=t,this.updateDom())},t.prototype.getIsRelative=function(){return"relative"===this.props.positionType||!this.props.positionType&&this.props.relativeToElementId},t.prototype.getIsAbsolute=function(){return"absolute"===this.props.positionType||!this.props.positionType&&this.props.position},t.prototype.setFlyoutRef=function(e){this._flyoutElement=i.findDOMNode(e)},t.prototype._interceptClickEvent=function(){var e;return!(null===(e=null===s.b||void 0===s.b?void 0:s.b.Utils)||void 0===e?void 0:e.isFeatureEnabled("FlyoutPrimitveParentClickCheck"))||this.props.hasOnClickAncestor},t.prototype.updateDom=function(){var e=this;if(this.props.testhooks&&this.props.testhooks,this.props.children){null===this._seeMorePopupCount&&(this._seeMorePopupCount=S.a.getInstance().getPopupCount());var t=this._seeMorePopupCount>0;this.ensureRootNode(),this.parentFlyoutNode||(this.parentFlyoutNode=document.createElement("div"),this.rootNode.appendChild(this.parentFlyoutNode));var n=!!window.navigator.userAgent.match("MSIE")||!!window.navigator.userAgent.match("Trident"),r=this.calculatePosition(),i=Object.assign({},this.props.flyoutStyle,r,{boxSizing:"border-box"},this.props.rootZIndex||t?{zIndex:1}:{},n&&void 0===this._flyoutElement?{left:0}:{},n?{display:"initial"}:{}),o=!this._actualSize,s=this.props.children!==this._previousChildren;if(s&&(this._previousChildren=this.props.children),o){var c=u();Object.assign(i,{bottom:null,right:null,maxWidth:c.width,maxHeight:c.height,visibility:"hidden"})}var l=a.createElement(y.a,w({id:this.props.id,style:i,ref:this.setFlyoutRef,onClick:function(t){e._interceptClickEvent()&&t.stopPropagation()}},this.props),this.props.children);this._portal.current.bindDOMElement(l,this.parentFlyoutNode,"flyout",(function(){e.focusInnerElement(o),e._actualSize=d(e._flyoutElement);var t=e.calculatePosition();if(o=o||s&&(t.left!==r.left||t.top!==r.top||t.right!==r.right||t.bottom!==r.bottom),!e._isFlyoutShown&&(window.addEventListener("blur",e.handleWindowBlur),window.addEventListener("resize",e._resizeHandler),e.getIsRelative())){e._scrollableAncestors=function(e,t){var n=[];for(e=e&&e.parentElement;e&&e!==t;)h(e)&&n.push(e),e=e.parentElement;return n}(e._getRelativeElement(),document.body);for(var n=0,a=e._scrollableAncestors;n<a.length;n++){a[n].addEventListener("scroll",e._scrollHandler)}}e._isFlyoutShown=!0,o&&e.updateDom()}))}else this.removeFromDom(),this.resetFocus()},t.prototype.focusInnerElement=function(e){!e&&this.props.focusCallback&&this.props.focusElementId&&!this._wasInnerFocusRequested&&(this.props.focusCallback(this.props.focusElementId),this._wasInnerFocusRequested=!0)},t.prototype.removeFromDom=function(){if(this.parentFlyoutNode&&(this._portal.current.unbindDOMComponent("flyout"),this.rootNode.removeChild(this.parentFlyoutNode),this.parentFlyoutNode=void 0,0===this.rootNode.childElementCount&&(document.body.removeChild(this.rootNode),this.rootNode=void 0)),this._isFlyoutShown&&(window.removeEventListener("blur",this.handleWindowBlur),this.getIsRelative()&&(window.removeEventListener("resize",this._resizeHandler),this._scrollableAncestors)))for(var e=0,t=this._scrollableAncestors;e<t.length;e++){t[e].removeEventListener("scroll",this._scrollHandler)}this._isFlyoutShown=!1},t.prototype.resetFocus=function(){this.props.focusElementId&&this.props.relativeToElementId&&this.props.focusCallback&&this.props.focusCallback(this.props.relativeToElementId)},t.prototype._isClickInsideFlyout=function(e){if(this._flyoutElement&&this._flyoutElement.contains(e.target)||document.querySelector(".ms-Layer"))return!0;for(var t=v.getInstance().getChildRoots(this.getFlyoutRootId()),n=0;n<t.length;n++){var r=document.getElementById(t[n]);if(r&&r.contains(e.target))return!0}return!1},t.prototype.handleOnScroll=function(e){this.ensureRootNode(),!this._isClickInsideFlyout(e)&&this.props.dismissOnScroll&&this.props.onOutsideClick&&this.props.onOutsideClick(e)},t.prototype.handlePointerDown=function(e){this.ensureRootNode(),!this._isClickInsideFlyout(e)&&this.props.onOutsideClick&&this.props.onOutsideClick(e)},t.prototype.handleWindowBlur=function(e){if(this.ensureRootNode(),this.props.onOutsideClick&&!this.props.keepOpenOnWindowBlur){var t=document.activeElement;if(t&&"IFRAME"===t.tagName.toUpperCase()){var n=Object.create(e,{target:{value:t}});if(this._isClickInsideFlyout(n))return}var r=Object.create(e,{target:{value:this.rootNode}});this.props.onOutsideClick(r)}},t.prototype.render=function(){return a.createElement(E.a,{key:"portal",ref:this._portal,renderReactSubtree:i.createPortal})},t.prototype._subscribeFlyoutPopupManager=function(){var e=this;this._managerSubscriber={type:C.a.Flyout,isClickInsideSubscriber:this._isClickInsideFlyout,onPointerDown:this.handlePointerDown,onScroll:this.props.enableTrackOnScroll?this.handleOnScroll:null,getComponent:function(){return e._flyoutElement}},O.a.getInstance().addSubscribers(this._managerSubscriber)},t.displayName="Flyout",t}(a.Component)},IpQH:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n("zsAz");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t){return e&&e.availablePlatformServices?e.availablePlatformServices[t]:null}var i=n("d5d1"),o=n("EAYf"),s=n("fMBw"),c=n.n(s),l=n("5UJb"),u=n.n(l),d=n("ngeo"),p=n("Qois");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class f{constructor(e,t,n){this.applicationContext=e,this.applicationStore=t,this.serviceName=n}getServiceName(){return this.serviceName}isOperationAvailable(e){const t=this.applicationStore.getState(),n=a(t,this.getServiceName());if(n){const r=n.operations[e];if(r){const e=r.platformFeatureDependencies;return!e||e.every(e=>Object(i.c)(t,e))}}return!1}isOperationAvailableAndEnabled(e){const t=this.applicationStore.getState(),n=a(t,this.getServiceName());if(n){const r=n.operations[e];if(r){const e=r.platformFeatureDependencies;return!e||e.every(e=>Object(i.d)(t,e))}}return!1}execute(e,...t){if(!this.isOperationAvailable(e))return new Promise((t,n)=>{d.a.retrieveErrorMessage(this.applicationStore,p.a.ServiceAndOperationNotSupported,this.getServiceName()+"."+e).then(e=>{n({errorCode:p.a.ServiceAndOperationNotSupported,message:e})},e=>{n({errorCode:p.a.ServiceAndOperationNotSupported,message:e})})});if(!this.isOperationAvailableAndEnabled(e))return new Promise((e,t)=>{d.a.retrieveErrorMessage(this.applicationStore,p.a.FeatureNotEnabled).then(e=>{t({errorCode:p.a.FeatureNotEnabled,message:e})},e=>{t({errorCode:p.a.FeatureNotEnabled,message:e})})});const n=u.a.trackWork("PlatformComponents"),a=c.a.createEvent(e,"PlatformComponents").startStopwatch(),i=new o.a(this.getServiceName(),e,t);return new Promise((e,t)=>{this.applicationContext.PlatformContext.getPlatform().executeServiceOperation(i,this.applicationContext,this.applicationStore).then(t=>{a(),n(),e(t)},e=>{if(a(),n(),e&&null!==e.errorCode&&void 0!==e.errorCode){const n=Object(r.c)(e);n.innerError=e,d.a.retrieveErrorMessage(this.applicationStore,e.errorCode,e.param).then(e=>{n.displayMessage=e,t(n)},e=>{t(n)})}else t(e)})})}}},IqkD:function(e,t,n){"use strict";n.d(t,"y",(function(){return c})),n.d(t,"r",(function(){return l})),n.d(t,"x",(function(){return u})),n.d(t,"t",(function(){return d})),n.d(t,"q",(function(){return p})),n.d(t,"p",(function(){return f})),n.d(t,"g",(function(){return g})),n.d(t,"n",(function(){return m})),n.d(t,"v",(function(){return b})),n.d(t,"w",(function(){return y})),n.d(t,"u",(function(){return _})),n.d(t,"e",(function(){return v})),n.d(t,"f",(function(){return S})),n.d(t,"d",(function(){return O})),n.d(t,"l",(function(){return C})),n.d(t,"k",(function(){return E})),n.d(t,"b",(function(){return P})),n.d(t,"h",(function(){return h})),n.d(t,"j",(function(){return I})),n.d(t,"i",(function(){return w})),n.d(t,"a",(function(){return j})),n.d(t,"s",(function(){return T})),n.d(t,"c",(function(){return N})),n.d(t,"m",(function(){return A})),n.d(t,"o",(function(){return R}));var r=n("SAYH"),a=n("NjDY"),i=n("eXjw"),o=n("E5IU"),s=n("17x/");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function c(e){return e?e.user:null}function l(e){const t=c(e);return t?t.initialized:i.a.Uninitialized}function u(e){const t=c(e);return t?t.userSettings:null}function d(e){const t=c(e);return t?t.userDisplayName:null}function p(e){const t=c(e);return t?t.userId:null}function f(e){const t=c(e);return t?t.userEmail:null}function g(e){const t=u(e);return!!t&&t.isRTL}function h(e){const t=u(e);return t?t.recordsPerPage:null}function m(e){const t=c(e);return t?t.userAttributePrivileges:null}function b(e){const t=c(e);return t?t.userRolePrivileges:null}function y(e){const t=c(e);return t?t.userRolesToNames:null}function _(e){const t=c(e);return null==t?void 0:t.userParentRootRoles}function v(e){var t,n;if(Object(s.l)(e)){const a=Object(o.e)(e);return null!==(n=r.a.tryParseOrNull(null===(t=null==a?void 0:a.offlineProfile)||void 0===t?void 0:t.ProfileId))&&void 0!==n?n:r.a.EMPTY}const a=u(e);return a?a.offlineProfileId:r.a.EMPTY}function S(e){var t;if(Object(s.l)(e)){const n=Object(o.e)(e);return(null===(t=null==n?void 0:n.offlineProfile)||void 0===t?void 0:t.ProfileVersion)?n.offlineProfile.ProfileVersion.toString():""}const n=u(e);return n?n.offlineProfileVersion:""}function O(e){var t;if(Object(s.l)(e)){const n=Object(o.e)(e);return(null===(t=null==n?void 0:n.offlineProfile)||void 0===t?void 0:t.OfflineAvailableEntities)?n.offlineProfile.OfflineAvailableEntities:null}const n=u(e);return n?n.offlineProfileAvailableEntities:null}function C(e){const t=u(e);return t?t.timeZoneUtcOffsetMinutes:null}function E(e){const t=u(e);return t?t.timeZoneAdjusters:null}function I(e){const t=u(e);return t?t.selectedGlobalFilterId:null}function w(e){const t=u(e);return t?t.savedFilters:null}function j(e){const t=u(e);return t?t.defaultSavedFilter:null}function P(e){let t=null;const n=function(e){const t=u(e);return t?t.transactionCurrencyById:null}(e);if(n&&(t=n[r.a.toString(function(e){const t=u(e);return t?t.transactionCurrencyId:null}(e))],!t)){const i=Object(a.D)(e);if(i&&i.baseCurrencyId&&(t=n[r.a.toString(i.baseCurrencyId)],!t))return null}return t}function T(e){const t=u(e);return t?t.languageId:null}function N(e){return 2052===T(e)}function A(e){const t=u(e);return t?t.timeZoneDefinitionByCode:{}}function R(e){const t=u(e);return t?t.userCultureName||t.formatInfoCultureName:""}},Itgg:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this._killedTokenDictionary={}}return e.prototype.setKillSwitchTenants=function(e,t){if(e&&t)try{var n=e.split(",");if("this-request-only"===t)return n;for(var r=1e3*parseInt(t,10),a=0;a<n.length;++a)this._killedTokenDictionary[n[a]]=Date.now()+r}catch(e){return[]}return[]},e.prototype.isTenantKilled=function(e){return void 0!==this._killedTokenDictionary[e]&&this._killedTokenDictionary[e]>Date.now()||(delete this._killedTokenDictionary[e],!1)},e}();t.default=r},IuCO:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("eeMP"),a=n("SAYH"),i=n("PF3G"),o=n("LtP7"),s=n("WRF3");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function c(e,t){return{type:"DESERIALIZE_UPDATE_RESPONSE_ASYNC",execute({dispatch:n,getState:c},l){const u=Object(r.c)(e),d=a.a.toLegacyGuid(u),p=t instanceof i.a?t.get_target().get_identifier().LogicalName:t.etn,f=new s.a(p,d,null,Object(r.d)(e)),g=new o.a(f);return Promise.resolve(g)}}}},IvgJ:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return d})),function(e){e[e.Raw=0]="Raw",e[e.Numeric=1]="Numeric",e[e.Label=2]="Label",e[e.Value=3]="Value",e[e.State=4]="State",e[e.Id=5]="Id",e[e.Name=6]="Name",e[e.LogicalName=7]="LogicalName",e[e.AllowedStatusTransitions=8]="AllowedStatusTransitions",e[e.DefaultStatus=9]="DefaultStatus",e[e.Color=10]="Color"}(r||(r={}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const a=u(r.Label),i=u(r.Value),o=u(r.State),s=u(r.DefaultStatus),c=u(r.AllowedStatusTransitions),l=u(r.Color);function u(e){return"!"+r[e]}class d{constructor(e,t,n,r,a,i,o){this._label=null,this._val=0,this._state=0,this._defaultStatus=0,this._allowedStatusTransitions=null,this._color=null,this._invariantName=null,this._label=e,this._val=t,this._state=n,this._defaultStatus=r,this._allowedStatusTransitions=a,this._color=i,this._invariantName=o}get_Label(){return this._label}set_Label(e){return this._label=e,e}get_ValueString(){return this._val.toString()}get_allowedStatusTransitions(){return this._allowedStatusTransitions}get_color(){return this._color}get_value(){return this._val}get_state(){return this._state}get_defaultStatus(){return this._defaultStatus}get_invariantName(){return this._invariantName}getObjectData(){return{label:this._label,value:this._val,state:this._state,defaultstatus:this._defaultStatus,allowedstatustransitions:this._allowedStatusTransitions,color:this._color,invariantname:this._invariantName}}getODataObject(){return{Value:this._val,Color:this._color,Label:this._label,DefaultStatus:this._defaultStatus,State:this._state,TransitionData:this._allowedStatusTransitions,InvariantName:this._invariantName}}getValue(e){if(e===a||"label"===e)return this.get_Label();if(e===i||"value"===e)return this.get_value();if(e===o||"state"===e)return this.get_state();if(e===s||"defaultstatus"===e)return this._defaultStatus;if(e===c||"allowedstatustransitions"===e)return this.get_allowedStatusTransitions();if(e===l||"color"===e)return this.get_color();throw Error.argumentOutOfRange("fieldName",e)}static createFromPicklistItem(e){if(e instanceof d)return e;const t=e.get_Label(),n=Number.parseInvariant(e.get_ValueString());return new d(t,n,-1,-1,null,null,null)}static createFromObjectData(e){const t=e.label,n=e.value,r="state"in e?e.state:-1,a="defaultstatus"in e?e.defaultstatus:-1,i="allowedstatustransitions"in e?e.allowedstatustransitions:null,o="color"in e?e.color:null,s=e.invariantname;return new d(t,n,r,a,i,o,s)}static createFromOData(e){const t=e.Label,n=e.Value,r="State"in e?e.State:-1,a="DefaultStatus"in e?e.DefaultStatus:-1,i="TransitionData"in e?e.TransitionData:null,o="Color"in e?e.Color:null,s=e.Description;return new d(t,n,r,a,i,o,s)}}d.__typeName="Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.OptionMetadata"},IzVP:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return c})),function(e){e[e.all=0]="all",e[e.systemApplicationMetadata=1]="systemApplicationMetadata",e[e.userApplicationMetadata=2]="userApplicationMetadata"}(r||(r={}));var a=n("HkYq"),i=n("504W"),o=n("3umU"),s=n("xAYq");class c{constructor(e,t,n,a,o,s,c,l){if(this._metadataType=0,this._metadataSubtype=0,this._formFactor=0,this._associatedEntityLogicalName=null,this._isDefault=!1,this._sourceId=null,this._normalizedDisplayName=null,this._applicationMetadataType=0,this._isDefaultSpecified=!1,!e)throw Error.argument("Invalid application metadata type");this._metadataType=e,this._formFactor=t,this._associatedEntityLogicalName=n,this._applicationMetadataType=Object(i.a)(a)?r.systemApplicationMetadata:a,this._isDefaultSpecified=!Object(i.a)(o),this._isDefault=!!this._isDefaultSpecified&&o,this._sourceId=s,this._metadataSubtype=c,this._normalizedDisplayName=l}checkApplicationMetadata(e){return(!this.get_metadataType()||e.get_metadataType()===this.get_metadataType())&&(!(!Object(i.a)(this.get_metadataSubtype())&&e.get_metadataSubtype()!==this.get_metadataSubtype())&&(!(!Object(i.b)(this.get_sourceId())&&e.get_sourceId()!==this.get_sourceId())&&(!(!Object(i.b)(this.get_associatedEntityLogicalName())&&e.get_AssociatedEntityLogicalName()!==this.get_associatedEntityLogicalName())&&(!(this.get_formFactor()>0&&e.get_formFactor()!==this.get_formFactor())&&(!(this._isDefaultSpecified&&this._isDefault&&(Object(i.a)(e.get_isDefault())||!e.get_isDefault()))&&(!(this._applicationMetadataType===r.userApplicationMetadata&&!e.get_isUserRecord())&&!(!Object(i.b)(this.get_normalizedDisplayName())&&this.get_normalizedDisplayName()!==e.get_DisplayName().toUpperCase())))))))}get_keyPath(){return Object(i.b)(this.get_sourceId())?Object(i.b)(this.get_normalizedDisplayName())?Object(i.b)(this.get_associatedEntityLogicalName())||Object(i.a)(this.get_metadataSubtype())?Object(i.b)(this.get_associatedEntityLogicalName())?o.a.metadataTypeKeyPath:o.a.metadataTypeAssociatedEntityLogicalNameKeyPath:o.a.metadataTypeMetadataSubtypeAssociatedEntityLogicalNameKeyPath:o.a.metadataTypeNormalizedDisplayNameKeyPath:o.a.metadataTypeSourceIdKeyPath}get_keyValue(){const e=this.get_metadataType().toString(),t=this.get_keyPath();if(t===o.a.metadataTypeSourceIdKeyPath)return e+s.a+this.get_sourceId();if(t===o.a.metadataTypeAssociatedEntityLogicalNameKeyPath)return e+s.a+this.get_associatedEntityLogicalName();if(t===o.a.metadataTypeMetadataSubtypeAssociatedEntityLogicalNameKeyPath){const t=this.get_metadataSubtype().toString();return e+s.a+t+s.a+this.get_associatedEntityLogicalName()}return t===o.a.metadataTypeNormalizedDisplayNameKeyPath?e+s.a+this.get_normalizedDisplayName():this.get_metadataType()}get_metadataType(){return this._metadataType}get_metadataSubtype(){return this._metadataSubtype}get_formFactor(){return this._formFactor}get_associatedEntityLogicalName(){return this._associatedEntityLogicalName}get_sourceId(){return this._sourceId}get_normalizedDisplayName(){return this._normalizedDisplayName}toString(){let e=String.format("MetadataType: {0}; SourceId: {1}",a.a[this.get_metadataType()],this.get_sourceId());return Object(i.b)(this.get_associatedEntityLogicalName())||(e+=String.format("; EntityLogicalName: {0}",this.get_associatedEntityLogicalName())),this._applicationMetadataType===r.userApplicationMetadata&&(e+="; UserData"),e}}},"J+Y9":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){for(var n=0,r=e.length;n<r;++n)t(e[n],n,r,e)}},"J+j6":function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return l})),n.d(t,"d",(function(){return u})),n.d(t,"g",(function(){return d})),n.d(t,"f",(function(){return p})),n.d(t,"e",(function(){return f}));var r=n("SAYH"),a=n("WePp");let i;class o{constructor(){this._eventsToStoreCount=250,this._events=[];let e=0;try{e=parseInt(localStorage.getItem("ApplicationEventsHistoryCount"),10)}catch(e){}e&&this.setEventsToStoreLimit(e,!1)}static getInstance(){return i||(i=new o),i}getEvents(){return this._events}clearEvents(){this._events=[]}saveEvents(e){const t=e.map(e=>({uniqueId:r.a.newGuid(),applicationEvent:e}));this._events.push(...t),this._events.sort((e,t)=>{const n=e.applicationEvent.getEventTimestamp().getTime(),r=t.applicationEvent.getEventTimestamp().getTime();return n&&r&&n!==r?n>r?1:-1:0}),this._slice()}setEventsToStoreLimit(e,t=!0){e>1e3&&(e=1e3);const n=this._eventsToStoreCount;if(this._eventsToStoreCount=e,this._eventsToStoreCount<n&&this._slice(),t)try{localStorage.setItem("ApplicationEventsHistoryCount",this._eventsToStoreCount.toString())}catch(e){}}getEventsToStoreLimit(){return this._eventsToStoreCount}handleEvent(e,t){this.saveEvent(e)}saveEvent(e){this._events.push({uniqueId:r.a.newGuid(),applicationEvent:e}),this._slice()}_slice(){this._events.length>this._eventsToStoreCount&&(this._events=this._events.slice(this._events.length-this._eventsToStoreCount,this._events.length))}}function s(){return o.getInstance()}function c(){return o.getInstance().getEvents()}function l(){o.getInstance().clearEvents()}function u(){return o.getInstance().getEventsToStoreLimit()}function d(e){o.getInstance().setEventsToStoreLimit(e)}function p(e){const t=JSON.parse(e).map(e=>new a.a("").fromJSON(e));o.getInstance().saveEvents(t)}function f(e){o.getInstance().saveEvent(e)}},JC5U:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i}));var r=n("1OTd");function a(e){const t={navigating:!0,browsingContextId:e};return{type:r.m,payload:t}}function i(e){const t={navigating:!1,browsingContextId:e};return{type:r.m,payload:t}}},JDi5:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * The unique name of the Search page module.
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="Search"},JEGW:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="recordSetNav.toggle";function a(e){return{type:r,payload:{collapsed:e}}}},JEu3:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="offline.file.sync";function a(e){return{type:r,payload:{isFileSyncInProgress:e}}}},JHwY:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));const r="router.setstack";function a(e,t){return{type:r,payload:{dialogContextIds:e,browsingContextId:t}}}},JK2E:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"l",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"g",(function(){return c})),n.d(t,"i",(function(){return l})),n.d(t,"k",(function(){return u})),n.d(t,"d",(function(){return d})),n.d(t,"h",(function(){return p})),n.d(t,"f",(function(){return f})),n.d(t,"j",(function(){return g}));var r="alert",a="button",i="checkbox",o="switch",s="dialog",c="link",l="option",u="radio",d="combobox",p="listbox",f="group",g="presentation"},JOgp:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return l})),n.d(t,"a",(function(){return u}));var r=n("5Oca"),a=n("i1f0"),i=n("504W"),o=n("+QYJ"),s=n("64CY");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function c(e){const t=[];if(e&&null!=e.Parameters){const n=e.Parameters.AddressField;if(n&&(t.push({attributeName:n}),Object(s.f)(n))){Object(s.d)(n).forEach(e=>{t.push({attributeName:e})})}}return t}function l(e,t,n,a){const i=Object(s.d)(e);let c="";return i.forEach(e=>{const i=Object(r.D)(t,n,a,e);Object(o.b)(i)||(c+=i+" ")}),c}function u(e,t,n,r,c,l){const u=Object(s.d)(e);let d="",p="",f=!0,g=null;u.forEach(e=>{const s=Object(a.ab)(t,n,r,c,l,e);Object(i.a)(s)||(Object(o.b)(s.value)||(d+=s.value+" "),Object(i.a)(s.validationResult)||(Object(o.b)(s.validationResult.userInput)||(p+=s.validationResult.userInput.toString()+" "),Object(i.a)(s.validationResult.isValueValid)||(f=f&&s.validationResult.isValueValid)),g=Object(i.a)(g)||s.timestamp>g?s.timestamp:g)});return{value:d,formatted:d,timestamp:g,validationResult:{isValueValid:f,userInput:p}}}},JP46:function(e,t,n){"use strict";n.d(t,"a",(function(){return x})),n.d(t,"b",(function(){return A})),n.d(t,"d",(function(){return N})),n.d(t,"c",(function(){return B}));var r=n("WPtp"),a=n("/A0C"),i=n("odYE"),o=n("SAYH"),s=n("bT7G"),c=n("Xd5/"),l=n("LbMF"),u=n("9hJQ"),d=n("7kVW"),p=n("g2Nw"),f=n("YxC/"),g=n("uhZ3"),h=n("i1f0"),m=n("Qn2w"),b=n("8a7L"),y=n("3tOH"),_=n("arV0"),v=n("jTSi"),S=n("dHD5"),O=n("Ae6N"),C=n("Lyxw"),E=n("3/02"),I=n("8nT0"),w=n("5Oca"),j=n("O7zD"),P=n("MXaZ"),T=n("dpM5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const N="processid";function A(e,t,n,a=!1){const s=Object(r.e)(e),c=Object(r.e)(t);if(!e&&!t)return!1;if(!e&&t&&null!=c)return!0;if(!t&&e&&null!=s)return!0;const l=!e||!e.validationResult||e.validationResult.isValueValid,u=!t||!t.validationResult||t.validationResult.isValueValid;if(!e&&!c&&u)return!1;if(Object(r.j)(t))return s!==c||s===c&&!u||s===c&&!l;if(Object(r.i)(t))return s!==c||s===c&&!u||s===c&&!l;if(Object(r.h)(t)){if(s.length===c.length){for(let e=0;e<s.length;e++){const t=s[e].fields.partyid,n=c[e].fields.partyid;if(t&&!n||!t&&n)return!0;if(t&&n){if(!(a?i.a.equals:i.a.equalsIgnoreName)(t.reference,n.reference))return!0}else if(!t&&!n&&s[e].fields.addressused.value!==c[e].fields.addressused.value)return!0}if(u&&l)return!1}return!0}if(Object(r.g)(t))return!o.a.equals(s,c)||o.a.equals(s,c)&&!u||o.a.equals(s,c)&&!l;if(Object(r.k)(t)){const e=Object(C.f)(n,T.i)?i.a.equalsIgnoreNbsp:i.a.equals,t=a?e:i.a.equalsIgnoreName;return!t(s,c)||t(s,c)&&!u||t(s,c)&&!l}return!!Object(r.f)(t)&&A(s,c,n)}function R(e){if(e&&e.fields&&e.fields.partyid&&e.identifier)return e;let t=null;return e instanceof i.a?t=e:e&&e.id&&e.entityName&&(t=new i.a(e.entityName,new o.a(e.id),e.name)),{identifier:new i.a("activityparty"),fields:{partyid:{reference:t}}}}function D(e,t,n,r,s,c){var l,u;if(null==c)throw Error("validationResult is null for fieldName: "+e);switch(t){case a.a.PickList:case a.a.State:case a.a.Status:return{label:r,valueString:null!=n?n.toString():null,timestamp:s,validationResult:c};case a.a.Boolean:const e=null===n?-1:"1"===n||"true"===n||!0===n||1===n?1:0;return{label:-1===e?"---":r,valueString:e.toString(),timestamp:s,validationResult:c};case a.a.UniqueIdentifier:return{id:n,timestamp:s,validationResult:c};case a.a.Customer:case a.a.Owner:case a.a.Lookup:case a.a.Regarding:let t=null;return n instanceof i.a?t=n:(n instanceof b.a||n&&n.entityName&&n.id&&n.name)&&(t=new i.a(n.entityName,new o.a(n.id),n.name)),{reference:t,timestamp:s,validationResult:c};case a.a.PartyList:let d=[];return d=n&&n.map?n.map(e=>R(e)):[R(n)],{list:d,validationResult:c};case a.a.Date:case a.a.DateTime:return{value:null!==(u=null===(l=null==n?void 0:n.toISOString)||void 0===l?void 0:l.call(n))&&void 0!==u?u:null,formatted:r,timestamp:s,validationResult:c};case a.a.MultiSelectPickList:const p=(e,t)=>e-t;let f;return f=Array.isArray(n)?n.length>0?n.sort(p).join(","):null:n,{value:f,formatted:r,timestamp:s,validationResult:c};default:return{value:n,formatted:r,timestamp:s,validationResult:c}}}function x(e,t,n,i,b,y,S,I,w,T,R,x=!1,z=!1){const q={},H=Object(f.e)(e,p.a),W=Object(_.j)(e,I),G=Object(h.Hb)(e,I);for(const p in i){const f=i[p];if(!f)continue;if(G&&Object(h.hd)(e,null==n?void 0:n.etn,p))continue;let _=null,K=null;if(_=f.value,f.value&&f.value.formatted&&(K=f.value.formatted),p===N){let e=null;e=_&&_ instanceof o.a?_:o.a.tryParseOrNull(_);const t={isValueValid:!1,userInput:null,errorMessage:null,errorId:null,isOfflineSyncError:!1},n=D(N,a.a.UniqueIdentifier,e,null,new Date,t);q[p]=n;continue}const Q=I?Object(h.k)(e,I,y,n.etn,p):Object(l.a)(e,n.etn,p);if(!Q&&S){M(e,n,p,I,y,S,i,b);continue}Q.Type!==a.a.UniqueIdentifier||!_||_ instanceof o.a||(_=o.a.tryParseOrNull(_));let X=null;if(Q.Type===a.a.Money&&!Q.IsBaseCurrency){const r="transactioncurrencyid";X=Object(s.e)(e,t,n,r)}const Y=Object(c.A)(e,Q,X,_),J=Y.controlAttributes.Behavior;z||(Y.controlAttributes.Behavior=O.a.None);let $=K||Object(c.y)(_,Y,H);z||(Y.controlAttributes.Behavior=J);let Z=null;Object(P.O)(Q)&&V(_)&&Object(P.x)(e)?Z=Object(P.P)(_,Y.userSettings.timeZoneUtcOffsetMinutes,Y.userSettings.timeZoneAdjusters,Y.controlAttributes.Behavior):(Z=Object(c.E)($,Y,Y.cultureInfo,Y.controlAttributes.Format,H),Object(P.O)(Q)&&Z&&Z.getTime&&(null==_?void 0:_.getSeconds)&&(Z=new Date(Z.getTime()+1e3*new Date(_).getSeconds()))),(Object(d.b)(Q)||k(Z)&&!L(_))&&(Z=_);const ee=W&&W.isOfflineSyncError,te=!Object(g.b)(Z)||Object(u.a)(e,I,y,n,Q,x).attributeValidationNeeded;let ne=te?Object(u.c)(Z,Q,H,Y,ee):Object(u.b)(Z,ee);const re=Q.Type.toLowerCase(),ae=Object(s.e)(e,t,n,p);ne.isValueValid||B(Q)||($=Object(r.c)(ae),Z=Object(r.e)(ae),void 0===_&&(ne=te?Object(u.c)(Z,Q,H,Y,ee):Object(u.b)(Z,ee)),ne.isValueValid||"money"!==re||(ne.userInput=_));let ie=D(p,Q.Type,Z,$,new Date,ne);if(R||A(ae,ie,e,!0)){if(!z&&Object(P.O)(Q)){const e=te?Object(u.c)(Z,Q,H,Y,ee):Object(u.b)(Z,ee);ie=D(p,Q.Type,Z,$,new Date,e)}else re===a.a.PartyList&&Object(C.e)(e,E.Dh)&&F(e,t,p,W.entityTypeName,W.id,ie);if(q[p]=ie,b&&ne&&!ne.isValueValid&&(!Object(g.a)(ne.userInput)||B(Q))||ne&&ne.isValueValid){const t=Object(h.B)(e,I,y,p,T);if(t)for(const n of t){const t=ne.isValueValid&&!U(e,n,I,y);w(Object(m.b)(I,n,t,y))}ne&&ne.isValueValid&&w(Object(v.b)(y,I,Object(j.d)(I,p)))}}}return q}function M(e,t,n,r,a,i,s,c){const u=[],d=!!Object(l.a)(e,t.etn,n),p=Object(h.db)(e,r,a),f=p&&p.hasOwnProperty(n),g=Object(S.w)(a),m=Object(h.gc)(e,r),b=Object(h.ib)(e,{id:r},a);u.push({name:"Page Id",value:r},{name:"formId",value:o.a.toString(null==b?void 0:b.Id)},{name:"formName",value:null==b?void 0:b.Name},{name:"formLabel",value:null==b?void 0:b.Label},{name:"Attribute Name",value:n},{name:"isUpdatingFieldValue",value:c},{name:"attributeValuePairs",value:s?Object.keys(s).toString():"null"},{name:"Is Attribute part of Entity Attributes",value:d},{name:"Is Attribute part of Form Attributes",value:f},{name:"Entity Type Name",value:t?t.etn:"entityReference is null"},{name:"contextKey",value:g},{name:"page",value:m?"not null":"null"},{name:"page.metadata",value:m&&m.metadata?"not null":"null"},{name:"Object.keys(page.metadata)",value:m&&m.metadata?Object.keys(m.metadata).toString():"null"},{name:"page.metadata[contextKey].attributes",value:m&&m.metadata&&m.metadata[g]&&m.metadata[g].attributes?Object.keys(m.metadata[g].attributes).toString():"null"}),i.error("Attribute Descriptor is null in getChanges",u)}function F(e,t,n,a,c,l){var u,d,p,f,g;if("email"!==a||o.a.isNullOrEmpty(c)||!n||!Object(C.e)(e,E.Dh))return;const h=new i.a(a,c);let m=null;const b=Object(s.e)(e,t,h,I.y);if((null==b?void 0:b.valueString)&&"1"!==(null==b?void 0:b.valueString)){const t=Object(w.j)(e,h,n);t&&(m=Object(r.e)(t));const a=Object(r.e)(l);if(!a||!m||a.length!==m.length)return;let i=!1;for(let e=0;e<m.length;e++){const t=m[e].fields.partyid,n=a[e].fields.partyid,r=m[e].fields.addressused;if((null===(u=null==t?void 0:t.reference)||void 0===u?void 0:u.etn)&&"unresolvedaddress"!==t.reference.etn&&(null===(d=null==n?void 0:n.reference)||void 0===d?void 0:d.id)&&!o.a.equals(n.reference.id,t.reference.id))return;(!t&&(null==r?void 0:r.value)||"unresolvedaddress"===(null===(p=null==t?void 0:t.reference)||void 0===p?void 0:p.etn))&&(null===(f=null==n?void 0:n.reference)||void 0===f?void 0:f.etn)&&"unresolvedaddress"!==(null===(g=null==n?void 0:n.reference)||void 0===g?void 0:g.etn)&&(i=!0)}if(!i)return;for(let e=0;e<m.length;e++)m[e].fields&&a[e].fields&&(a[e].fields.activitypartyid=m[e].fields.activitypartyid)}}function k(e){return null==e}function L(e){return k(e)||""===e}function B(e){return 2===(null==e?void 0:e.RequiredLevel)||1===(null==e?void 0:e.RequiredLevel)}function U(e,t,n,r){const a=Object(h.C)(e,{controlName:t,id:n},r);return a&&Object.keys(a).some(e=>{if(a[e].notificationLevel===y.a.error)return!0})}function V(e){return"[object Date]"===Object.prototype.toString.call(e)&&!isNaN(e.getTime())}},JPoD:function(e,t,n){"use strict";n.d(t,"k",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return s})),n.d(t,"e",(function(){return c})),n.d(t,"f",(function(){return l})),n.d(t,"i",(function(){return u})),n.d(t,"j",(function(){return d})),n.d(t,"l",(function(){return p})),n.d(t,"h",(function(){return f})),n.d(t,"g",(function(){return g}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="syncerror",a="activitymimeattachment",i="activityparty",o="activitypointer",s="annotation",c="attachment",l="businessdatalocalizedlabel",u="postfollow",d="product",p="template",f="offlinecommanddefinition",g="businessprocessflowinstance"},JQqP:function(e,t,n){"use strict";n.d(t,"f",(function(){return a})),n.d(t,"g",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return c})),n.d(t,"d",(function(){return l})),n.d(t,"h",(function(){return u})),n.d(t,"e",(function(){return d})),n.d(t,"i",(function(){return p})),n.d(t,"j",(function(){return f})),n.d(t,"l",(function(){return m})),n.d(t,"m",(function(){return g})),n.d(t,"k",(function(){return h}));var r=n("/60z");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const a="IndexInEntityList",i="IndexInWholeList",o="IsTopResults",s={sessionId:"SearchSessionId",recordId:"RecordId",entityName:"EntityName",tabName:"Tabname",entityGroupIndex:"EntityGroupIndex",clickSuggestionRecord:"clickSuggestionRecord",clickRecentlyTypedQuery:"ClickRecentlyTypedQuery",clickRecentlyAccessedRecord:"ClickRecentlyAccessedRecord",excuteSearch:"excuteSearch",text:"Text",globalSearchBox:"GlobalSearchBox",textCleared:"TextCleared",emptySearchBoxClicked:"EmptySearchBoxClicked",searchTextCleared:"SearchTextCleared",indexInEntityList:"IndexInEntityList",indexInWholeList:"IndexInWholeList",searchTextLength:"SearchTextLength"},c="GlobalSearch.",l="Search.NewRelevanceSearch",u=l+".ClickOnOneResult",d="Search.NewRelevanceSearch.Filter",p={sessionId:"SearchSessionId",recordId:"RecordId",entityName:"EntityName",tabName:"Tabname",entityGroupIndex:"EntityGroupIndex",loadMoreFrom:"LoadMoreFrom",facetKey:"FacetKey",facetRemoveValue:"FacetRemoveValue",text:"Text",navigateToRecordBy:"NavigateToRecordBy",isPrimary:"IsPrimary",totalRecords:"TotalRecords",pageSize:"PageSize",pageNumber:"PageNumber",filterNewState:"FilterNewState",isNewSearchExperience:"IsNewSearchExperience",isTopResults:"IsTopResults",isPublicAPI:"IsPublicAPI",pageId:"PageId",searchTextLength:"SearchTextLength"},f="TopResults";function g(e,t,n){return[{name:p.sessionId,value:e},{name:p.entityName,value:t},{name:p.facetKey,value:n}]}function h(e,t,n){return[{name:p.sessionId,value:n},{name:p.entityName,value:e},{name:p.tabName,value:t[o]?f:e},{name:p.recordId,value:t[r.RECID]},{name:i,value:t[i]},{name:a,value:t[a]},{name:p.entityGroupIndex,value:t[p.entityGroupIndex]}]}function m(e,t,n,r){return[{name:"Search Session Id",value:e},{name:"Search type",value:t},{name:"Search Filter",value:n},{name:"Facet clicked",value:r}]}},JRzo:function(e,t,n){"use strict";n.d(t,"k",(function(){return r})),n.d(t,"l",(function(){return a})),n.d(t,"m",(function(){return i})),n.d(t,"o",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"f",(function(){return c})),n.d(t,"i",(function(){return l})),n.d(t,"j",(function(){return u})),n.d(t,"n",(function(){return d})),n.d(t,"h",(function(){return p})),n.d(t,"d",(function(){return f})),n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return h})),n.d(t,"c",(function(){return m})),n.d(t,"p",(function(){return b})),n.d(t,"g",(function(){return y})),n.d(t,"q",(function(){return _}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="Dialog_Reauthenticate_Dialog_Description",a="Dialog_Reauthenticate_Dialog_Expired_Description",i="Dialog_Reauthenticate_Dialog_Expired_Description_Embedded",o="Dialog_Reauthenticate_Signin_Button",s="PA_Dialog_Authenticate_Message_Blocking",c="PA_Dialog_Authenticate_Message_Non_Blocking",l="Dialog_Reauthenticate_Cancel_Button",u="Dialog_Reauthenticate_Close_Button",d="Brand_CRM_Online",p="Brand_CRM",f="Dialog_AuthError_Dialog_Title",g="Dialog_AuthError_Dialog_Description",h="common.scripts.global.js.PopupBlockerError",m="common.scripts.global.js.PopupBlockerError",b="ErrorIconAltWarning",y="ErrorIconAltInformation",_=[r,a,i,o,l,u,d,p,b,y,f,g,h,s,c]},JTy6:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * The unique name of the LookupDialog page module.
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="LookupDialog"},JUjK:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.Equals=0]="Equals",e[e.NotEquals=1]="NotEquals",e[e.LessThan=2]="LessThan",e[e.LessThanEqualTo=3]="LessThanEqualTo",e[e.GreaterThan=4]="GreaterThan",e[e.GreaterThanEqualTo=5]="GreaterThanEqualTo",e[e.IsNull=6]="IsNull",e[e.In=7]="In"}(r||(r={}))},JVKK:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="clear.pageNotificationAction";function a(e,t){return{type:"clear.pageNotificationAction.async",execute({dispatch:n}){const a={type:r,payload:{UniqueId:e},meta:{pageId:t}};return Promise.resolve(n(a))}}}},JZmp:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("qK01"),a=n("iLty"),i=n("nxt5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function o(e,t){return{type:"DESERIALIZE_DELTE_RESPONSE_ASYNC",execute({dispatch:e,getState:n},o){const s=t instanceof r.a?new a.a(null):new i.a(null);return Promise.resolve(s)}}}},JdSN:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("/Ndy"),a=n("504W"),i=n("XjOj"),o=n("Div0"),s=n("eruq"),c=n("RiLc"),l=n("SRlt");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class u extends r.a{constructor(e,t,n){if(super(e,t,n),this._organizationServiceFault=null,this._isErrorInOffline=!1,this._contentId=0,this._clientRequestId=null,this._serverResponseId=null,this._retryAfter=null,this._isRequestTooLong=!1,Object(a.a)(e)||4!==e.readyState)Object(a.b)(n)||(this._organizationServiceFault=c.b.parseFromJson(n));else if("parsererror"===t&&!Object(a.a)(n)&&(n.indexOf(r.a.HtmlHeader)>-1||n.toLowerCase().indexOf(r.a.HtmlHeader.toLowerCase())>-1))this._organizationServiceFault=c.b.parseFromHtml(n.substr(n.indexOf("<")));else{if(this._organizationServiceFault=Object(a.a)(e.responseXML)?null:c.b.parseFromXml(Object(s.a)(e.responseXML)),null===this._organizationServiceFault&&!Object(a.a)(e.responseText)){const t=Object(s.b)(e.responseText);Object(a.a)(t)||(this._organizationServiceFault=c.b.parseFromXml(Object(s.a)(t)))}null!==this._organizationServiceFault||Object(a.a)(e.responseText)||(this._organizationServiceFault=c.b.parseFromJson(e.responseText))}if(this._organizationServiceFault&&this._organizationServiceFault.get_messages()&&this._organizationServiceFault.get_messages().length){let e="Error Messages: \n";for(let t=0;t<this._organizationServiceFault.get_messages().length;t++)e+=t+1+": "+this._organizationServiceFault.get_messages()[t]+"\n";Object(i.d)(o.a.storage,e)}}get_organizationServiceFault(){return this._organizationServiceFault}set_organizationServiceFault(e){return this._organizationServiceFault=e,e}get_isErrorInOffline(){return this._isErrorInOffline}set_isErrorInOffline(e){return this._isErrorInOffline=e,e}get_isRequestTooLong(){return this._isRequestTooLong}set_isRequestTooLong(e){return this._isRequestTooLong=e,e}get_contentId(){return this._contentId}set_contentId(e){return this._contentId=e,e}get_clientRequestId(){return this._clientRequestId}set_clientRequestId(e){return this._clientRequestId=e,e}get_serverResponseId(){return this._serverResponseId}set_serverResponseId(e){return this._serverResponseId=e,e}get_retryAfter(){return this._retryAfter}set_retryAfter(e){return this._retryAfter=e,e}get_date(){return this._date}set_date(e){return this._date=e,e}get_responseMessage(){return Object(a.a)(this._organizationServiceFault)?super.get_responseMessage():this._organizationServiceFault.get_messages()[0]}static fromErrorCode(e){const t=new u(null,"","");return t._organizationServiceFault=c.b.fromErrorCode(e),t}static createFromHtml(e,t){let n=null;return n=t?new u(t,t.statusText,e):new u(null,"",""),(e.indexOf(r.a.HtmlHeader)>-1||e.toLowerCase().indexOf(r.a.HtmlHeader.toLowerCase())>-1)&&(n._organizationServiceFault=c.b.parseFromHtml(e.substr(e.indexOf("<"))),n.set_isRequestTooLong(e.indexOf("Bad Request - Request Too Long")>-1)),n}static createFromUnknown(e){const t=new u(e,(null==e?void 0:e.statusText)||l.c.UNKNOWN,"Unexpected response type returned (possibly from a proxy)");return t.set_isRequestTooLong(!1),t}}},JhlA:function(e,t,n){"use strict";n.d(t,"h",(function(){return r})),n.d(t,"g",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"k",(function(){return o})),n.d(t,"j",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return f})),n.d(t,"f",(function(){return u})),n.d(t,"e",(function(){return d})),n.d(t,"i",(function(){return p}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="offline_notification_text_header",a="offline_notification_text_body",i="offline_notification_reconnect_fail_text_body",o="offline_ui_blocker_notification_text_header",s="offline_ui_blocker_notification_text_body",c="offline_notification_reconnect_btn_text",l="offline_notification_cancel_btn_text",u="offline_notification_reconnect_success_text",d="offline_notification_reconnect_progress_indicator_text",p="offline_notification_user_offline_mode_text",f=[r,a,i,o,s,c,l,u,d,p]},Jj4w:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("5yoC");class a extends r.a{constructor(e,t,n,r){super(),this._entityMoniker=null,this._targetEntityName=null,this._targetFieldType=0,this._entityMoniker=e,this._targetEntityName=t,this._targetFieldType=n,this._skipParentalRelationshipMapping=r}get_name(){return"InitializeFrom"}get_entityMoniker(){return this._entityMoniker}get_targetEntityName(){return this._targetEntityName}get_targetFieldType(){return this._targetFieldType}get_skipParentalRelationshipMapping(){return this._skipParentalRelationshipMapping}}},Jsfi:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.String=1]="String",e[e.Attribute=2]="Attribute"}(r||(r={}))},Jz1I:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("nxt5");class a extends r.a{constructor(e){super("ExecuteQuickFind"),this._result=null,this._result=e}get_result(){return this._result}}},Jz2d:function(e,t,n){"use strict";n.d(t,"a",(function(){return Bt}));var r=n("Z6YS"),a=n("rWW8"),i=n("fskq"),o=n("IKHO"),s=n("84PK"),c=n("504W"),l=n("NMtn"),u=n("gg/8"),d=n("jPIj"),p=n("2mBq"),f=n("eruq");class g{constructor(e){this._nodes=null,this._nodes=e}get_count(){return this._nodes.length}get_item(e){return this._nodes[e]}}const h="http://schemas.datacontract.org/2004/07/System.Collections.Generic",m=new RegExp("xmlns:([\\w]+)=[\"']http://schemas.microsoft.com/xrm/2011/Contracts[\"']");class b extends d.a{constructor(e,t,n){if(super(),this._mainNode=null,this._metadataNodes=null,this._isMetadataValueNode=!1,this._xml=null,this._xml=e,Object(c.a)(t)){let t=e.match(m);const n=t[1];t=e.match(new RegExp("xmlns:([\\w]+)=[\"']"+h+"[\"']"));const r=t[1];t=e.match(new RegExp("xmlns:([\\w]+)=[\"']http://schemas.microsoft.com/xrm/2011/Metadata[\"']"));const a=t[1];t=e.match(new RegExp("xmlns:([\\w]+)=[\"']http://www.w3.org/2001/XMLSchema-instance[\"']"));const i=t[1],o=Object(p.a)("<{0}:EntityMetadata>",n),s=Object(p.a)("</{0}:EntityMetadata>",n),c=e.indexOf(o),l=e.lastIndexOf(s);if(c<0||l<0||c>=l)throw Error.argument("Not a valid RetrieveMetadataChanges response XML");this._mainNode=Object(f.a)(Object(f.b)(e.substring(0,c)+"<placeholder/>"+e.substring(l+s.length,e.length)));const u=String.format("<{0}:EntityMetadata xmlns:{0}='{1}' xmlns:{2}='{3}' xmlns:{4}='{5}' xmlns:{6}='{7}'>",n,"http://schemas.microsoft.com/xrm/2011/Contracts",r,h,a,"http://schemas.microsoft.com/xrm/2011/Metadata",i,"http://www.w3.org/2001/XMLSchema-instance");let d=c;const g=[];for(;d>0;){const t=Object(f.b)(u+e.substring(d+o.length,e.indexOf(s,d)+s.length));g.push(Object(f.a)(t).childNodes().get_item(0)),d=e.indexOf(o,d+1)}this._metadataNodes=g}else this._mainNode=t,this._metadataNodes=n;var r;this._isMetadataValueNode=(r=this._mainNode,!Object(c.a)(r.get_tagName())&&(r.get_tagName().endsWith(":value")||"value"===r.get_tagName())&&r.get_element().namespaceURI===h&&r.hasChildNodes()&&"placeholder"===r.childNodes().get_item(0).get_tagName())}get_element(){return this._mainNode.get_element()}get_innerText(){return this._mainNode.get_innerText()}get_outerXml(){if(Object(c.a)(this._xml)&&(this._xml=this._mainNode.get_outerXml(),this._xml.indexOf("<placeholder/>")>=0)){const e=this._xml.match(m)[1];let t="";for(const n of this._metadataNodes)t+=Object(p.a)("<{0}:EntityMetadata>",e),t+=n.childNodes().get_item(0).get_outerXml(),t+=Object(p.a)("</{0}:EntityMetadata>",e);this._xml=this._xml.replace("<placeholder/>",t.toString())}return this._xml}get_tagName(){return this._mainNode.get_tagName()}addNamespace(e,t){this._mainNode.addNamespace(e,t);for(const n of this._metadataNodes)n.addNamespace(e,t)}selectSingleNode(e){if(e.indexOf("a:EntityMetadata")>=0)throw Error.argumentOutOfRange("expression",e,"This XmlNode implementation doesn't support queries for EntityMetadata");return new b(null,this._mainNode.selectSingleNode(e),this._metadataNodes)}selectNodes(e){if(".//a:KeyValuePairOfstringanyType[b:key='EntityMetadata']/b:value/a:EntityMetadata"===e)return new g(this._metadataNodes);if(".//d:ExecuteResult/a:Results/a:KeyValuePairOfstringanyType/b:value[@i:type='a:EntityMetadataCollection']/a:EntityMetadata/c:Attributes/c:AttributeMetadata"===e){const t=e.substring(e.indexOf("a:EntityMetadata/")+17,e.length),n=[];for(const e of this._metadataNodes){const r=e.selectNodes(t);for(let e=0;e<r.get_count();e++)n.push(r.get_item(e))}return new g(n)}if(e.indexOf("a:EntityMetadata")>=0)throw Error.argumentOutOfRange("expression",e,"This XmlNode implementation doesn't support arbitrary queries for EntityMetadata");return this._mainNode.selectNodes(e)}getAttribute(e){return this._mainNode.getAttribute(e)}getElementsByTagName(e){const t=[];let n=this._mainNode.getElementsByTagName(e);for(let e=0;e<n.get_count();e++)t.push(new b(null,n.get_item(e),this._metadataNodes));for(const r of this._metadataNodes){n=r.getElementsByTagName(e);for(let e=0;e<n.get_count();e++)t.push(n.get_item(e))}return new g(t)}childNodes(){if(this._isMetadataValueNode)return new g(this._metadataNodes);const e=this._mainNode.childNodes(),t=[];for(let n=0;n<e.get_count();n++)t.push(new b(null,e.get_item(n),this._metadataNodes));return new g(t)}hasChildNodes(){return this._isMetadataValueNode?this._metadataNodes.length>0:this._mainNode.hasChildNodes()}}var y,_=n("tHaS"),v=n("6zk2"),S=n("HYaY"),O=n("WRF3"),C=n("IvgJ"),E=n("sdkC");!function(e){e[e.none=0]="none",e[e.related=1]="related",e[e.extended=2]="extended"}(y||(y={}));var I=n("IVVt"),w=n("2F73"),j=n("XvL5");var P=n("MUIu"),T=n("VJwX"),N=n("RIwK");function A(e){return R(e.get_element())}function R(e){let t=s.a.get_empty(),n=null,r=null,a=null;for(let i=0,o=e.childNodes.length;i<o;i++){const o=e.childNodes[i];if(o.namespaceURI===Bt.xrm2011ContractsNamespace&&o.firstChild){switch(Object(T.b)(o.nodeName)){case"Id":t=new s.a(o.textContent);break;case"LogicalName":n=o.firstChild.nodeValue;break;case"Name":r=o.firstChild.nodeValue;break;case"RowVersion":a=o.firstChild.nodeValue}}}return n?new O.a(n,t,r,a):O.a.get_empty()}function D(e){let t="<a:Id>"+Object(N.b)(e.Id.toString())+"</a:Id>";return t+="<a:LogicalName>"+Object(N.b)(e.LogicalName)+"</a:LogicalName>",t+=Object(c.a)(e.getValue("RowVersion"))?"":"<a:RowVersion>"+Object(N.b)(e.getValue("RowVersion").toString())+"</a:RowVersion>",Object(c.b)(e.Name)||(t+="<a:Name>"+Object(N.b)(e.Name)+"</a:Name>"),t}var x=n("GD3x");var M=n("XjOj"),F=n("Div0");var k=n("c7Og"),L=n("wMH2"),B=n("bEud"),U=n("g73c"),V=n("YhOF");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function z(e){let t=null,n=null,r=B.a.unknown;for(let t=0,a=e.childNodes.length;t<a;t++){const a=e.childNodes[t];if(a.namespaceURI===Bt.xrm2011ContractsNamespace&&a.firstChild){switch(Object(T.b)(a.nodeName)){case"SchemaName":n=a.firstChild.nodeValue;break;case"PrimaryEntityRole":"true"!==a.getAttribute("i:nil")&&(r=Object(U.a)(B.a,a.firstChild.nodeValue))}}}return n&&(t=new V.a(n,r)),t}var q=n("67s4"),H=n("fMBw"),W=n.n(H);function G(e,t){return K(e.get_element(),t)}function K(e,t){const n=W.a.createEvent("LoadFromCrmSoap","EntityCollection").startStopwatch(),r=new Array(0);let a=!1,i=0,o=!1,s=null;for(let t=0,n=e.childNodes.length;t<n;t++){const n=e.childNodes[t];if(n.namespaceURI===Bt.xrm2011ContractsNamespace){switch(Object(T.b)(n.nodeName)){case"Entities":s=n;break;case"MoreRecords":Object(c.a)(n.firstChild)||Object(c.b)(n.firstChild.nodeValue)||(a=Boolean.parse(n.firstChild.nodeValue).valueOf());break;case"TotalRecordCount":Object(c.a)(n.firstChild)||Object(c.b)(n.firstChild.nodeValue)||(i=Number.parseInvariant(n.firstChild.nodeValue));break;case"TotalRecordCountLimitExceeded":Object(c.a)(n.firstChild)||Object(c.b)(n.firstChild.nodeValue)||(o=Boolean.parse(n.firstChild.nodeValue).valueOf())}}}if(s){let e=0;for(let t=0,n=s.childNodes.length;t<n;t++){const n=s.childNodes[t];n.namespaceURI===Bt.xrm2011ContractsNamespace&&"Entity"===Object(T.b)(n.nodeName)&&(r[e]=$(n),e++)}}return n(),new L.a(r,a,i,o,t)}function Q(e){let t="<a:Entities>";for(const n of e.get_entities())t+=`<a:Entity>${Z(n,!1)}</a:Entity>`;return t+="</a:Entities>",t}var X=n("WF3G"),Y=n("/A0C");function J(e,t){return $(e.get_element(),t)}function $(e,t){if(!e.childNodes.length)return null;const n={},a={},i={};let o=null,l=null,u=null;for(let t=0,n=e.childNodes.length;t<n;t++){const n=e.childNodes[t];if(n.namespaceURI===Bt.xrm2011ContractsNamespace){switch(Object(T.b)(n.nodeName)){case"Id":o=n.textContent;break;case"LogicalName":l=n.firstChild.nodeValue;break;case"RelatedEntities":u=n}}}o||(o=s.a.get_empty().toString());const d=new O.a(l,new s.a(o));!function(e,t,n,a){let i=null,o=null;for(let t=0,n=e.childNodes.length;t<n;t++){const n=e.childNodes[t];if(n.namespaceURI===Bt.xrm2011ContractsNamespace){switch(Object(T.b)(n.nodeName)){case"Attributes":i=n;break;case"FormattedValues":o=n}}}(function(e,t,n){for(let a=0,i=e.childNodes.length;a<i;a++){const i=e.childNodes[a];if(i.namespaceURI===Bt.xrm2011ContractsNamespace&&"KeyValuePairOfstringanyType"===Object(T.b)(i.nodeName)){let e=null,a=null;for(let t=0,n=i.childNodes.length;t<n;t++){const n=i.childNodes[t];if(n.namespaceURI===r.a.genericCollectionsNamespace){switch(Object(T.b)(n.nodeName)){case"key":e=n.firstChild.nodeValue;break;case"value":a=n}}}if(!e||!a)continue;let o=a.getAttribute("i:type");if(ne(a,o))continue;let l=te(o),u=null;if(l===Y.a.AliasedValue){let e=null,t=null;for(let n=0,r=a.childNodes.length;n<r;n++){const r=a.childNodes[n];if(r.namespaceURI===Bt.xrm2011ContractsNamespace){switch(Object(T.b)(r.nodeName)){case"EntityLogicalName":e=r.firstChild.nodeValue;break;case"AttributeLogicalName":t=r.firstChild.nodeValue;break;case"Value":a=r}}}if(!e||!t||!a)continue;if(o=a.getAttribute("i:type"),ne(a,o))continue;l=te(o),u=new _.a(e,t,l)}if(l!==Y.a.Unknown){let r=null;switch(l){case Y.a.Lookup:r=R(a);break;case Y.a.PartyList:r=K(a,X.a.get_empty());break;case Y.a.DateTime:r=Object(P.a)(a);break;case Y.a.UniqueIdentifier:r=Object(c.a)(a.firstChild)||Object(c.b)(a.firstChild.nodeValue)?s.a.get_empty():new s.a(a.textContent);break;case Y.a.Integer:Object(c.a)(a.firstChild)||Object(c.b)(a.firstChild.nodeValue)||(r=parseInt(a.firstChild.nodeValue,10));break;case Y.a.Boolean:if(!Object(c.a)(a.firstChild)&&!Object(c.b)(a.firstChild.nodeValue)){r=Boolean.parse(a.firstChild.nodeValue)?new C.a(null,1,-1,-1,null,null,null):new C.a(null,0,-1,-1,null,null,null)}break;case Y.a.Money:r=parseFloat(re(a));break;case Y.a.Decimal:case Y.a.Double:Object(c.a)(a.firstChild)||Object(c.b)(a.firstChild.nodeValue)||(r=parseFloat(a.firstChild.nodeValue));break;case Y.a.Status:case Y.a.State:case Y.a.PickList:r=new C.a(null,parseInt(re(a),10),-1,-1,null,null,null);break;case Y.a.MultiSelectPickList:r=ae(a);break;default:r=Object(c.a)(a.firstChild)?null:a.firstChild.nodeValue}Object(c.a)(r)||(Object(c.a)(u)?(t[e]=r,n[e]=l):(u.set_value(r),t[e]=u,n[e]=Y.a.AliasedValue))}}}})(i,t,n),Object(c.a)(o)||function(e,t,n,a){for(let i=0,o=e.childNodes.length;i<o;i++){const o=e.childNodes[i];if(o.namespaceURI===Bt.xrm2011ContractsNamespace&&"KeyValuePairOfstringstring"===Object(T.b)(o.nodeName)){let e=null,i=null;for(let t=0,n=o.childNodes.length;t<n;t++){const n=o.childNodes[t];if(n.namespaceURI===r.a.genericCollectionsNamespace){switch(Object(T.b)(n.nodeName)){case"key":e=n;break;case"value":i=n}}}if(!Object(c.a)(e)&&!Object(c.a)(i)){const r=e.firstChild.nodeValue;if(!Object(c.b)(r)&&r in t){if(r in n){let e,a=n[r],o=null;a===Y.a.AliasedValue&&(o=t[r],a=o.get_attributeType()),a!==Y.a.PickList&&a!==Y.a.Boolean&&a!==Y.a.State&&a!==Y.a.Status&&a||(e=o?o.get_value():t[r],Object(c.a)(i.firstChild)||e.set_Label(i.firstChild.nodeValue))}Object(c.a)(i.firstChild)||(a[r]=i.firstChild.nodeValue)}}}}}(o,t,n,a)}(e,n,a,i);let p=null;return p=u?function(e,t,n){let a=null;if(!Object(c.a)(n)){a=new Array(n.length);for(let t=0;t<n.length;t++)a[t]=new q.a(n[t].get_key(),e,n[t].get_value())}const i=[];for(let e=0,n=t.childNodes.length;e<n;e++){const n=t.childNodes[e];if(n.nodeName.indexOf("KeyValuePairOfRelationshipEntityCollection")<0)return new E.a(i);let o=null,s=null;for(let e=0,t=n.childNodes.length;e<t;e++){const t=n.childNodes[e];if(t.namespaceURI===r.a.genericCollectionsNamespace)switch(Object(T.b)(t.nodeName)){case"key":o=t;break;case"value":s=t}}if(!o)continue;const l=z(o);if(l&&s){let e=null;if(!Object(c.a)(a))for(const t of a)if(t.get_relationship().toString()===l.toString()){e=t;break}const t=K(s,e);i.push(new k.a(l,t))}}return new E.a(i)}(d,u,t):new E.a(new Array(0)),"email"===d.LogicalName&&"safedescription"in n&&"description"in n&&(n.description=n.safedescription),new S.a(d,n,a,i,{},p)}function Z(e,t){Object(c.a)(t)&&(t=!0);const n=e.get_actionableIdentifier();return(t?String.format('<entity xmlns:a="{0}" xmlns:i="http://www.w3.org/2001/XMLSchema-instance">',Bt.xrm2011ContractsNamespace):"")+function(e){let t='<a:Attributes xmlns:b="'+r.a.genericCollectionsNamespace+'">';for(const n of e.get_changedFieldNames())Object(c.b)(n)||(t+=ee(n,e.getValue(n),e.get_fieldTypes()[n]));return t+="</a:Attributes>",t}(e)+'<a:EntityState i:nil="true"/>'+String.format('<a:FormattedValues xmlns:b="{0}"/>',r.a.genericCollectionsNamespace)+(n.Id.equals(s.a.get_empty())?"":"<a:Id>"+Object(N.b)(n.Id.toString())+"</a:Id>")+"<a:LogicalName>"+Object(N.b)(n.LogicalName)+"</a:LogicalName>"+(e.hasField("versionnumber")&&!Object(c.a)(e.getValue("versionnumber"))?"<a:RowVersion>"+Object(N.b)(e.getValue("versionnumber").toString())+"</a:RowVersion>":"")+function(e){let t='<a:RelatedEntities xmlns:b="http://schemas.datacontract.org/2004/07/System.Collections.Generic">',n="";for(const t of e.get_entityCollections()){const e=t.get_value();if(!Object(c.a)(e)&&e.get_count()>0){const r=e.get_entities().filter(e=>e.isDirty());r.length>0&&(n+="<a:KeyValuePairOfRelationshipEntityCollectionX_PsK4FkN>",n+="<b:key>",t.get_key().get_primaryEntityRole()!==B.a.unknown&&(n+="<a:PrimaryEntityRole>"+Object(T.a)(B.a,t.get_key().get_primaryEntityRole())+"</a:PrimaryEntityRole>"),n+="<a:SchemaName>"+Object(N.b)(t.get_key().get_schemaName())+"</a:SchemaName>",n+="</b:key>",n+="<b:value>"+Q(new L.a(r,e.get_moreRecords(),e.get_totalRecordCount(),e.get_totalRecordCountLimitExceeded(),e.get_query(),e.get_clientRetrieveOptions()))+"</b:value>",n+="</a:KeyValuePairOfRelationshipEntityCollectionX_PsK4FkN>")}}return t+=n,t+="</a:RelatedEntities>",t}(e.get_relatedEntities())+(t?"</entity>":"")}function ee(e,t,n,r,a){n!==Y.a.Unknown?r=function(e){switch(e){case Y.a.String:case Y.a.Memo:case Y.a.EntityName:return"c:string";case Y.a.Integer:return"c:int";case Y.a.UniqueIdentifier:return"c:guid";case Y.a.DateTime:return"c:dateTime";case Y.a.Boolean:return"c:boolean";case Y.a.Customer:case Y.a.Lookup:case Y.a.Owner:return"a:EntityReference";case Y.a.PickList:case Y.a.State:case Y.a.Status:return"a:OptionSetValue";case Y.a.AliasedValue:return"a:AliasedValue";case Y.a.Money:return"a:Money";case Y.a.Decimal:return"c:decimal";case Y.a.Double:return"c:double";case Y.a.PartyList:return"a:EntityCollection";case Y.a.MultiSelectPickList:return"c:OptionSetValueCollection";default:throw Error.create("field type is not supported: "+e)}}(n):n=te(r),Object(c.a)(a)&&(a=function(e){switch(e){case Y.a.String:case Y.a.DateTime:case Y.a.Decimal:case Y.a.Double:case Y.a.Boolean:case Y.a.Integer:case Y.a.Memo:case Y.a.EntityName:return'xmlns:c="http://www.w3.org/2001/XMLSchema"';case Y.a.UniqueIdentifier:return'xmlns:c="http://schemas.microsoft.com/2003/10/Serialization/"';default:return""}}(n));let i="<a:KeyValuePairOfstringanyType>";if(i+="<b:key>"+Object(N.b)(e)+"</b:key>",Object(c.a)(t))i+='<b:value i:nil="true" />';else{switch(i+='<b:value i:type="'+r+'"'+function(e){if("c:ConcurrencyBehavior"===e)return' xmlns:c="http://schemas.microsoft.com/xrm/7.1/Contracts"';if("c:OptionSetValueCollection"===e)return' xmlns:c="http://schemas.microsoft.com/xrm/9.0/Contracts"';return""}(r),Object(c.b)(a)||(i+=" "+a),i+=">",n){case Y.a.Customer:case Y.a.Lookup:case Y.a.Owner:i+=D(t);break;case Y.a.DateTime:i+=Object(P.c)(t);break;case Y.a.Boolean:let e;try{e="boolean"==typeof t?t.toString():(t.get_value()>0).toString()}catch(n){e=("1"===t.toString()).toString()}i+=e;break;case Y.a.Integer:i+=t.toString();break;case Y.a.Status:case Y.a.State:case Y.a.PickList:if("string"==typeof t)i+="<a:Value>"+t+"</a:Value>";else{i+="<a:Value>"+("number"==typeof t?t:t.get_value()).toString()+"</a:Value>"}break;case Y.a.MultiSelectPickList:if(!Object(c.a)(t)){const e=t.split(",");for(let t=0;t<e.length;t++)i+=`<c:OptionSetValue><a:Value>${e[t].trim()}</a:Value></c:OptionSetValue>`}break;case Y.a.UniqueIdentifier:i+=Object(N.b)(t.toString());break;case Y.a.Money:i+="<a:Value>"+t.toString()+"</a:Value>";break;case Y.a.PartyList:i+=Q(t);break;case Y.a.Unknown:i+=function(e,t){if("a:FetchExpression"===e)return"<a:Query>"+Object(N.b)(t)+"</a:Query>";if("c:QueryByEntityNameDictionary"===e)
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
return function(e){let t="";for(const n in e){const r={key:n,value:e[n]};t+="<c:KeyValuePairOfstringQueryBasegUGIFE1S>",t+="<b:key>"+Object(N.b)(r.key)+"</b:key>",t+='<b:value i:type="a:FetchExpression"><a:Query>'+Object(N.b)(r.value)+"</a:Query></b:value>",t+="</c:KeyValuePairOfstringQueryBasegUGIFE1S>"}return t}(t);if("c:InputArgumentCollection"===e)
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
return function(e){let t="<c:Arguments>";for(const n in e){const r={key:n,value:e[n]};let a;r.value instanceof String?a="string":(r.value instanceof Number||Object(M.i)(F.a.storage,"InputArgumentCollectionSerializer supports only integer and string types, need to enable support if any other type is specified"),a="int"),t+="<b:KeyValuePairOfstringanyType>",t+="<b:key>"+Object(N.b)(r.key)+"</b:key>",t+='<b:value xmlns:c="http://www.w3.org/2001/XMLSchema" i:type="c:'+a+'">'+Object(N.b)(r.value.toString())+"</b:value>",t+="</b:KeyValuePairOfstringanyType>"}return t+="</c:Arguments>",t}(t);if("a:ColumnSet"===e)return function(e){let t='<a:AllColumns i:type="c:boolean" xmlns:c="http://www.w3.org/2001/XMLSchema">'+(e instanceof w.a?"true":"false")+"</a:AllColumns>";if(e instanceof w.a)t+="<a:Columns />";else{if(!(e instanceof j.a))throw Error.argument("columnSet","XML serialization for this type of column set not supported");t+='<a:Columns xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays">';for(const n of e.get_Columns())t+="<b:string>"+n+"</b:string>";t+="</a:Columns>"}return t}(t);if("a:Entity"===e)return Z(t,!1);if("a:OrganizationRequestCollection"===e||"c:OrganizationRequestCollection"===e)return function(e){let t="";for(const n of e)t+='<c:OrganizationRequest i:type="a:'+n.get_name()+'Request">',t+="<a:Parameters>",t+=qe(n),null!==n.offlineData&&(t+='<a:KeyValuePairOfstringanyType><b:key>tag</b:key><b:value i:type="c:string" xmlns:c="http://www.w3.org/2001/XMLSchema">'+Object(N.b)("offlinePlayback")+"</b:value>",t+="</a:KeyValuePairOfstringanyType>"),t+="</a:Parameters>",t+="<a:RequestName>",t+=n.get_name(),t+="</a:RequestName>",t+="</c:OrganizationRequest>";return t}(t);if("a:ExecuteMultipleSettings"===e||"c:ExecuteMultipleSettings"===e)return"<c:ContinueOnError>"+(n=t).get_continueOnError()+"</c:ContinueOnError><c:ReturnResponses>"+n.get_returnResponses()+"</c:ReturnResponses>";if("a:RelationshipQueryCollection"===e)return function(e){let t="";for(const n of e)t+="<a:KeyValuePairOfRelationshipQueryBaseX_PsK4FkN>",t+="<b:key>",n.get_key().get_primaryEntityRole()!==B.a.unknown&&(t+="<a:PrimaryEntityRole>"+Object(T.a)(B.a,n.get_key().get_primaryEntityRole())+"</a:PrimaryEntityRole>"),t+="<a:SchemaName>"+Object(N.b)(n.get_key().get_schemaName())+"</a:SchemaName>",t+="</b:key>",t+='<b:value i:type="a:FetchExpression"><a:Query>'+Object(N.b)(n.get_value())+"</a:Query></b:value>",t+="</a:KeyValuePairOfRelationshipQueryBaseX_PsK4FkN>";return t}(t);if("a:TargetFieldType"===e)return Object(T.a)(I.a,t);if("a:Relationship"===e)return function(e){let t="";return Object(c.a)(e.get_primaryEntityRole())||e.get_primaryEntityRole()===B.a.unknown||(t+="<a:PrimaryEntityRole>"+Object(T.a)(B.a,e.get_primaryEntityRole())+"</a:PrimaryEntityRole>"),t+="<a:SchemaName>"+Object(N.b)(e.get_schemaName())+"</a:SchemaName>",t}(t);if("a:EntityReferenceCollection"===e)return function(e){let t="";for(const n of e)t+=`<a:EntityReference>${D(n)}</a:EntityReference>`;return t}(t);if("sa:ArrayOfstring"===e)return function(e){let t="";for(const n of e)t+="<sa:string>"+Object(N.b)(n)+"</sa:string>";return t}(t);if("a:RollupType"===e)return Object(T.a)(y,t);if("c:ConcurrencyBehavior"===e)return Object(T.a)(v.a,t);var n;return Object(N.b)(t)}(r,t);break;default:i+=Object(N.b)(t)}i+="</b:value>"}return i+="</a:KeyValuePairOfstringanyType>",i}function te(e){switch(e=e.substr(e.indexOf(":")+1)){case"AliasedValue":return Y.a.AliasedValue;case"boolean":return Y.a.Boolean;case"dateTime":return Y.a.DateTime;case"decimal":return Y.a.Decimal;case"double":return Y.a.Double;case"EntityCollection":return Y.a.PartyList;case"EntityReference":return Y.a.Lookup;case"guid":return Y.a.UniqueIdentifier;case"int":return Y.a.Integer;case"Money":return Y.a.Money;case"OptionSetValue":return Y.a.PickList;case"OptionSetValueCollection":return Y.a.MultiSelectPickList;case"string":return Y.a.String;default:return Y.a.Unknown}}function ne(e,t){return!!Object(c.b)(t)&&"true"===e.getAttribute("i:nil")}function re(e){let t=null;return Object(c.a)(e.firstElementChild)||Object(c.a)(e.firstElementChild.firstChild)||Object(c.b)(e.firstElementChild.firstChild.nodeValue)?Object(c.a)(e.firstChild)||Object(c.a)(e.firstChild.firstChild)||Object(c.b)(e.firstChild.firstChild.nodeValue)||(t=e.firstChild.firstChild.nodeValue):t=e.firstElementChild.firstChild.nodeValue,t}function ae(e){const t=[];if(!Object(c.a)(e))for(let n=0,r=e.childNodes.length;n<r;n++)Object(c.a)(e.childNodes[n])||t.push(parseInt(e.childNodes[n].firstChild.firstChild.nodeValue,10));return t}var ie=n("Xe7f");function oe(e){const t=e;return ee("Target",t.get_target(),Y.a.Unknown,"a:Entity")+ee("SuppressDuplicateDetection",t.get_suppressDuplicateDetection(),Y.a.Boolean)+ee("CalculateMatchCodeSynchronously",t.get_calculateMatchCodeSynchronously(),Y.a.Boolean)+ee("SolutionUniqueName",t.get_solutionUniqueName(),Y.a.String)+ee("MaintainLegacyAppServerBehavior",t.get_maintainLegacyAppServerBehavior(),Y.a.Boolean)+ee("ReturnRowVersion",t.get_returnRowVersion(),Y.a.Boolean)}function se(e){if(Object(c.a)(e))return null;let t=null,n=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='Target']/b:value");if(!Object(c.a)(n)){const e=n.selectSingleNode("entity");Object(c.a)(e)||(n=e),t=J(n)}const r=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='SuppressDuplicateDetection']/b:value");let a;if(Object(c.a)(r))throw Error.notImplemented();a=Boolean.parse(r.get_innerText()).valueOf();const i=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='CalculateMatchCodeSynchronously']/b:value");let o;if(Object(c.a)(i))throw Error.notImplemented();o=Boolean.parse(i.get_innerText()).valueOf();const s=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='SolutionUniqueName']/b:value"),l=Object(c.a)(s)?null:s.get_innerText(),u=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='MaintainLegacyAppServerBehavior']/b:value");let d;if(Object(c.a)(u))throw Error.notImplemented();d=Boolean.parse(u.get_innerText()).valueOf();const p=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='ReturnRowVersion']/b:value");let f;if(Object(c.a)(p))throw Error.notImplemented();return f=Boolean.parse(p.get_innerText()).valueOf(),new ie.a(t,a,o,l,d,f)}var ce=n("qK01");function le(e){return ee("Target",e.get_target(),Y.a.Lookup)+ee("SolutionUniqueName",e.get_solutionUniqueName(),Y.a.String)+ee("ConcurrencyBehavior",e.get_concurrencyBehavior(),Y.a.Unknown,"c:ConcurrencyBehavior")}function ue(e){if(Object(c.a)(e))return null;const t=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='Target']/b:value"),n=Object(c.a)(t)?null:A(t),r=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='SolutionUniqueName']/b:value"),a=Object(c.a)(r)?null:r.get_innerText(),i=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='ConcurrencyBehavior']/b:value");let o;if(Object(c.a)(i))throw Error.notImplemented();return o=Object(U.b)(v.a,Object(c.a)(i)?null:i.get_innerText()),new ce.a(n,a,o)}var de=n("hirD");function pe(e){const t=e;return ee("Requests",t.get_requests(),Y.a.Unknown,"c:OrganizationRequestCollection",'xmlns:c="http://schemas.microsoft.com/xrm/2012/Contracts"')+ee("Settings",t.get_settings(),Y.a.Unknown,"c:ExecuteMultipleSettings",'xmlns:c="http://schemas.microsoft.com/xrm/2012/Contracts"')}function fe(e){if(Object(c.a)(e))return null;const t=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='Requests']/b:value"),n=Object(c.a)(t)?null:function(e){const t=[];e.addNamespace("c","http://schemas.microsoft.com/xrm/2012/Contracts");const n=e.selectNodes("c:OrganizationRequest");for(let e=0;e<n.get_count();e++)t.push(He(n.get_item(e)));return t}(t),r=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='Settings']/b:value"),a=Object(c.a)(r)?null:function(e){const t=Boolean.parse(e.selectSingleNode("c:ContinueOnError").get_innerText()).valueOf(),n=Boolean.parse(e.selectSingleNode("c:ReturnResponses").get_innerText()).valueOf();return new x.a(t,n)}(r);return new de.a(n,a)}var ge=n("CrQY");function he(e){const t=e;return ee("SearchText",t.get_searchText(),Y.a.String)+ee("EntityGroupName",t.get_entityGroupName(),Y.a.String)+ee("EntityNames",t.get_entityNames(),Y.a.Unknown,"sa:ArrayOfstring",'xmlns:sa="http://schemas.microsoft.com/2003/10/Serialization/Arrays"')}function me(e){if(Object(c.a)(e))return null;const t=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='SearchText']/b:value"),n=Object(c.a)(t)?null:t.get_innerText(),r=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='EntityGroupName']/b:value"),a=Object(c.a)(r)?null:r.get_innerText(),i=e.selectNodes(".//a:KeyValuePairOfstringanyType[b:key='EntityNames']/b:value/sa:string");let o=null;if(!Object(c.a)(i)){o=new Array(i.get_count());for(let e=0;e<i.get_count();e++)o[e]=i.get_item(e).get_innerText()}return new ge.a(n,a,o)}var be=n("Jj4w");function ye(e){const t=e;return ee("EntityMoniker",t.get_entityMoniker(),Y.a.Lookup)+ee("TargetEntityName",t.get_targetEntityName(),Y.a.String)+ee("TargetFieldType",t.get_targetFieldType(),Y.a.Unknown,"a:TargetFieldType")}function _e(e){if(Object(c.a)(e))return null;const t=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='EntityMoniker']/b:value"),n=Object(c.a)(t)?null:A(t),r=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='TargetEntityName']/b:value"),a=Object(c.a)(r)?null:r.get_innerText(),i=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='TargetFieldType']/b:value"),o=Object(U.b)(I.a,Object(c.a)(i)?null:i.get_innerText());return new be.a(n,a,o)}var ve=n("EHQq");function Se(e){const t=e;return ee("CurrentEntityId",t.get_currentEntityId(),Y.a.UniqueIdentifier)+ee("CurrentEntityLogicalName",t.get_currentEntityLogicalName(),Y.a.String)+ee("NextEntityId",t.get_nextEntityId(),Y.a.UniqueIdentifier)+ee("NextEntityLogicalName",t.get_nextEntityLogicalName(),Y.a.String)+ee("NewActiveStageId",t.get_newActiveStageId(),Y.a.UniqueIdentifier)+ee("NewTraversedPath",t.get_newTraversedPath(),Y.a.String)+ee("ProcessId",t.get_processId(),Y.a.UniqueIdentifier)+ee("ProcessInstanceId",t.get_processInstanceId(),Y.a.UniqueIdentifier)}function Oe(e){if(Object(c.a)(e))return null;const t=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='CurrentEntityId']/b:value"),n=Object(c.a)(t)?null:new s.a(t.get_innerText()),r=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='CurrentEntityLogicalName']/b:value"),a=Object(c.a)(r)?null:r.get_innerText(),i=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='NextEntityId']/b:value"),o=Object(c.a)(i)?null:new s.a(i.get_innerText()),l=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='NextEntityLogicalName']/b:value"),u=Object(c.a)(l)?null:l.get_innerText(),d=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='NewActiveStageId']/b:value"),p=Object(c.a)(d)?null:new s.a(d.get_innerText()),f=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='NewTraversedPath']/b:value"),g=Object(c.a)(f)?null:f.get_innerText(),h=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='ProcessId']/b:value"),m=Object(c.a)(h)?null:new s.a(h.get_innerText()),b=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='ProcessInstanceId']/b:value"),y=Object(c.a)(b)?null:new s.a(b.get_innerText());return new ve.a(n,a,o,u,p,g,m,y)}var Ce=n("47MF");function Ee(e){const t=e;return ee("OuterQuery",t.get_outerQuery(),Y.a.Unknown,"a:FetchExpression")+ee("SubQueries",t.get_subQueries(),Y.a.Unknown,"c:QueryByEntityNameDictionary",'xmlns:c="http://schemas.microsoft.com/crm/2011/Contracts"')}function Ie(e){if(Object(c.a)(e))return null;const t=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='OuterQuery']/b:value/a:Query"),n=Object(c.a)(t)?null:t.get_innerText();e.addNamespace("c","http://schemas.microsoft.com/crm/2011/Contracts");let r=null;const a=e.selectNodes(".//a:KeyValuePairOfstringanyType[b:key='SubQueries']/b:value[@i:type='c:QueryByEntityNameDictionary']/c:KeyValuePairOfstringQueryBasegUGIFE1S");if(!Object(c.a)(a)){r={};for(let e=0;e<a.get_count();e++){const t=a.get_item(e).selectSingleNode("b:key");if(!Object(c.a)(t)){const n=a.get_item(e).selectSingleNode("b:value/a:Query");Object(c.a)(n)||(r[t.get_innerText()]=Object(c.a)(n)?null:n.get_innerText())}}}return new Ce.a(n,r)}var we=n("Mr6u");function je(e){return ee("Query",e.get_query(),Y.a.Unknown,"a:FetchExpression")}function Pe(e){if(Object(c.a)(e))return null;const t=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='Query']/b:value/a:Query"),n=Object(c.a)(t)?null:t.get_innerText();return new we.a(n)}var Te=n("QFnk");function Ne(e){const t=e;return ee("Target",t.get_target(),Y.a.Lookup)+ee("Principal",t.get_principal(),Y.a.Lookup)}function Ae(e){if(Object(c.a)(e))return null;const t=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='Target']/b:value"),n=Object(c.a)(t)?null:A(t),r=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='Principal']/b:value"),a=Object(c.a)(r)?null:A(r);return new Te.a(n,a)}var Re=n("Exmh");function De(e){const t=e;return ee("Target",t.get_target(),Y.a.Lookup)+ee("ProcessId",t.get_processId(),Y.a.Lookup)+ee("ProcessInstanceId",t.get_processInstanceId(),Y.a.Lookup)}function xe(e){if(Object(c.a)(e))return null;const t=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='Target']/b:value"),n=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='ProcessId']/b:value"),r=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='ProcessInstanceId']/b:value"),a=Object(c.a)(t)?null:A(t),i=Object(c.a)(n)?null:A(n),o=Object(c.a)(r)?null:A(r);return new Re.a(a,i,o)}var Me=n("v3UX");function Fe(e){const t=e;return ee("Target",t.get_target(),Y.a.Lookup)+ee("ColumnSet",t.get_columnSet(),Y.a.Unknown,"a:ColumnSet")+ee("RelatedEntitiesQuery",t.get_relatedEntitiesQuery(),Y.a.Unknown,"a:RelationshipQueryCollection")+ee("ReturnNotifications",t.get_returnNotifications(),Y.a.Boolean)}function ke(e){if(Object(c.a)(e))return null;const t=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='Target']/b:value"),n=Object(c.a)(t)?null:A(t),r=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='ColumnSet']/b:value"),a=Object(c.a)(r)?null:function(e){const t=e.selectSingleNode("a:AllColumns");if(!Object(c.a)(t)&&Boolean.parse(t.get_innerText()))return w.a.get_instance();e.addNamespace("sa","http://schemas.microsoft.com/2003/10/Serialization/Arrays");const n=e.selectNodes("a:Columns/sa:string"),r=[];for(let e=0;e<n.get_count();e++)r.push(n.get_item(e).get_innerText());return new j.a(r)}(r),i=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='RelatedEntitiesQuery']/b:value"),o=Object(c.a)(i)?null:function(e){const t=e.selectNodes("a:KeyValuePairOfRelationshipQueryBaseX_PsK4FkN"),n=new Array(t.get_count());for(let e=0;e<t.get_count();e++){const r=t.get_item(e).selectSingleNode("b:key/a:SchemaName").get_innerText(),a=t.get_item(e).selectSingleNode("b:key/a:PrimaryEntityRole");let i=B.a.unknown;Object(c.a)(a)||(i=Object(U.a)(B.a,a.get_innerText()));const o=t.get_item(e).selectSingleNode("b:value/a:Query").get_innerText();n[e]=new k.a(new V.a(r,i),o)}return n}(i),s=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='ReturnNotifications']/b:value");let l;if(Object(c.a)(s))throw Error.notImplemented();return l=Boolean.parse(s.get_innerText()).valueOf(),new Me.a(n,a,o,l)}var Le=n("PF3G");function Be(e){const t=e;return ee("Target",t.get_target(),Y.a.Unknown,"a:Entity")+ee("SuppressDuplicateDetection",t.get_suppressDuplicateDetection(),Y.a.Boolean)+ee("CalculateMatchCodeSynchronously",t.get_calculateMatchCodeSynchronously(),Y.a.Boolean)+ee("SolutionUniqueName",t.get_solutionUniqueName(),Y.a.String)+ee("MaintainLegacyAppServerBehavior",t.get_maintainLegacyAppServerBehavior(),Y.a.Boolean)+ee("ConcurrencyBehavior",t.get_concurrencyBehavior(),Y.a.Unknown,"c:ConcurrencyBehavior")+ee("ReturnRowVersion",t.get_returnRowVersion(),Y.a.Boolean)}function Ue(e){if(Object(c.a)(e))return null;let t=null,n=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='Target']/b:value");if(!Object(c.a)(n)){const e=n.selectSingleNode("entity");Object(c.a)(e)||(n=e),t=J(n)}const r=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='SuppressDuplicateDetection']/b:value");let a;if(Object(c.a)(r))throw Error.notImplemented();a=Boolean.parse(r.get_innerText()).valueOf();const i=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='CalculateMatchCodeSynchronously']/b:value");let o;if(Object(c.a)(i))throw Error.notImplemented();o=Boolean.parse(i.get_innerText()).valueOf();const s=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='SolutionUniqueName']/b:value"),l=Object(c.a)(s)?null:s.get_innerText(),u=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='MaintainLegacyAppServerBehavior']/b:value");let d;if(Object(c.a)(u))throw Error.notImplemented();d=Boolean.parse(u.get_innerText()).valueOf();const p=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='ConcurrencyBehavior']/b:value");let f;if(Object(c.a)(p))throw Error.notImplemented();f=Object(U.b)(v.a,Object(c.a)(p)?null:p.get_innerText());const g=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='ReturnRowVersion']/b:value");let h;if(Object(c.a)(g))throw Error.notImplemented();return h=Boolean.parse(g.get_innerText()).valueOf(),new Le.a(t,a,o,l,d,f,h)}const Ve={},ze={};function qe(e){return e.get_name()in Ve?Ve[e.get_name()](e):""}function He(e){return null in ze?ze.null(e):null}function We(e,t){Ve[e]=t}function Ge(e,t){ze[e]=t}We("Create",oe),Ge("Create",se),We("Delete",le),Ge("Delete",ue),We("ExecuteMultiple",pe),Ge("ExecuteMultiple",fe),We("ExecuteQuickFind",he),Ge("ExecuteQuickFind",me),We("InitializeFrom",ye),Ge("InitializeFrom",_e),We("NavigateToNextEntity",Se),Ge("NavigateToNextEntity",Oe),We("RetrieveEntitiesForAggregateQuery",Ee),Ge("RetrieveEntitiesForAggregateQuery",Ie),We("RetrieveMultiple",je),Ge("RetrieveMultiple",Pe),We("RetrievePrincipalAccess",Ne),Ge("RetrievePrincipalAccess",Ae),We("RetrieveProcessControlData",De),Ge("RetrieveProcessControlData",xe),We("Retrieve",Fe),Ge("Retrieve",ke),We("Update",Be),Ge("Update",Ue);var Ke=n("nxt5"),Qe=n("fVHw");function Xe(e,t){if(!Object(c.a)(e)){jt(e);let t=null;if(t=e.selectSingleNode(".//a:Results"),!Object(c.a)(t)){const e=t.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='id']/b:value"),n=Object(c.a)(e)?null:new s.a(e.get_innerText()),r=t.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='EntityReference']/b:value"),a=Object(c.a)(r)?null:A(r);return new Qe.a(n,a)}}return null}var Ye=n("V482"),Je=n("RiLc");var $e=n("XgcG");function Ze(e,t){if(!Object(c.a)(e)){jt(e);let n=null;if(n=e.selectSingleNode(".//a:Results"),!Object(c.a)(n)){const e=n.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='IsFaulted']/b:value");let r;if(Object(c.a)(e))throw Error.notImplemented();r=Boolean.parse(e.get_innerText()).valueOf();const a=n.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='Responses']/b:value"),i=Object(c.a)(a)?null:function(e,t){const n=t.get_requests(),r=[];e.addNamespace("c","http://schemas.microsoft.com/xrm/2012/Contracts");const a=e.selectNodes("c:ExecuteMultipleResponseItem");for(let e=0;e<a.get_count();e++){let t=null,i=null;const o=a.get_item(e).selectSingleNode("c:Fault");Object(c.a)(o)||"true"===o.getAttribute("i:nil")||(t=Je.b.parseFromXml(o));const s=Number.parseInvariant(a.get_item(e).selectSingleNode("c:RequestIndex").get_innerText()),l=a.get_item(e).selectSingleNode("c:Response");Object(c.a)(l)||"true"===l.getAttribute("i:nil")||(i=wt(l.selectSingleNode("a:ResponseName").get_innerText(),l,n[s])),r.push(new Ye.a(t,s,i))}return r}(a,t);return new $e.a(r,i)}}return null}var et=n("a1q1"),tt=n("kToj"),nt=n("c46F");function rt(e){if("a:QuickFindResult"===e.get_tagName()){const t=e.selectSingleNode("a:Data");if(t){const n=G(t,new X.a("")),r=Number.parseInvariant(e.selectSingleNode("a:ErrorCode").get_innerText()),a=t.selectSingleNode("a:EntityName").get_innerText();return new nt.a(a,n,r)}}return Object(tt.a)(!0,"Unknown xml format for QuickFindResult"),null}var at=n("Jz1I");function it(e,t){if(!Object(c.a)(e)){jt(e),e.addNamespace("c","http://schemas.datacontract.org/2004/07/System.Collections.Generic");const t=e.selectSingleNode(".//a:Results");if(!Object(c.a)(t)){const e=t.selectSingleNode(".//a:KeyValuePairOfstringanyType[c:key='Result']/c:value[@i:type='a:QuickFindResultCollection']");if(!Object(c.a)(e)){const t=function(e){if(Object(c.a)(e))return null;const t=new Array(0),n=e.selectNodes("a:QuickFindResult");for(let e=0;e<n.get_count();e++){const r=n.get_item(e);t[t.length]=rt(r)}return new et.a(t)}(e);return new at.a(t)}}}return null}var ot=n("lx8z");function st(e,t){if(!Object(c.a)(e)){jt(e);let t=null;if(t=e.selectSingleNode(".//a:Results"),!Object(c.a)(t)){let e=null,n=t.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='Entity']/b:value");if(!Object(c.a)(n)){const t=n.selectSingleNode("entity");Object(c.a)(t)||(n=t),e=J(n)}return new ot.a(e)}}return null}class ct extends Ke.a{constructor(e){super("RetrieveEntitiesForAggregateQuery"),this._entityCollection=null,this._entityCollection=e}get_entityCollection(){return this._entityCollection}}function lt(e,t){if(!Object(c.a)(e)){jt(e);let t=null;if(t=e.selectSingleNode(".//a:Results"),!Object(c.a)(t)){const e=t.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='EntityCollection']/b:value[@i:type='a:EntityCollection']");let n=null;return Object(c.a)(e)||(n=G(e,X.a.get_empty())),new ct(n)}}return null}var ut=n("jxo7");function dt(e,t){if(!Object(c.a)(e)){jt(e);let n=null;if(n=e.selectSingleNode(".//a:Results"),!Object(c.a)(n)){const e=n.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='EntityCollection']/b:value[@i:type='a:EntityCollection']");let r=null;return Object(c.a)(e)||(r=G(e,new X.a(t.get_query()))),new ut.a(r)}}return null}var pt=n("Y2Yg"),ft=n("wo7m");function gt(e,t){if(!Object(c.a)(e)){jt(e);let t=null;if(t=e.selectSingleNode(".//a:Results"),!Object(c.a)(t)){const e=t.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='AccessRights']/b:value");let n=0;if(Object(c.a)(e))throw Error.notImplemented();{const t=e.get_innerText().split(" ");for(const e of t)n|=Object(U.b)(pt.a,e)}return new ft.a(n)}}return null}var ht=n("7O3c");function mt(e,t){if(!Object(c.a)(e)){jt(e);let t=null;if(t=e.selectSingleNode(".//a:Results"),!Object(c.a)(t)){let e=null,n=t.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='Entity']/b:value");if(!Object(c.a)(n)){const t=n.selectSingleNode("entity");Object(c.a)(t)||(n=t),e=J(n)}let r=null,a=t.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='GlobalNavigationData']/b:value");if(!Object(c.a)(a)){const e=a.selectSingleNode("entity");Object(c.a)(e)||(a=e),r=J(a)}let i=null;const o=t.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='BpfDefinitionVersionNumber']/b:value");return Object(c.a)(o)||(i=o.get_innerText()),new ht.a(e,r,i)}}return null}var bt=n("S/Br"),yt=n("I8bZ");function _t(e){if(Object(c.a)(e))return null;let t=0;const n=e.selectSingleNode("b:Severity");n&&(t=Object(U.a)(yt.a,n.get_innerText()));let r="";const a=e.selectSingleNode("b:Message");return a&&(r=a.get_innerText()),new bt.a(t,r)}var vt=n("/d6W");function St(e,t){if(!Object(c.a)(e)){jt(e);let n=null;if(n=e.selectSingleNode(".//a:Results"),!Object(c.a)(n)){let e=null,r=n.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='Entity']/b:value");if(!Object(c.a)(r)){const n=r.selectSingleNode("entity");Object(c.a)(n)||(r=n),e=J(r,t.get_relatedEntitiesQuery());const a=Object(c.a)(e.get_relatedEntities())?new Array(0):e.get_relatedEntities().get_relatedEntityQueries();e.updateColumnSet(t.get_columnSet(),a)}const a=n.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='Notifications']/b:value"),i=Object(c.a)(a)?null:function(e){if(Object(c.a)(e))return null;const t=new Array(0),n=e.selectNodes("b:BusinessNotification");if(n)for(let e=0;e<n.get_count();e++){const r=n.get_item(e);t[t.length]=_t(r)}return t}(a);return new vt.a(e,i)}}return null}var Ot=n("LtP7");function Ct(e,t){if(!Object(c.a)(e)){jt(e);let t=null;if(t=e.selectSingleNode(".//a:Results"),!Object(c.a)(t)){const e=t.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='EntityReference']/b:value"),n=Object(c.a)(e)?null:A(e);return new Ot.a(n)}}return null}const Et={};function It(e,t){Et[e]=t}function wt(e,t,n){return e in Et?Et[e](t,n):new Ke.a(n.get_name())}function jt(e){e.addNamespace("s","http://schemas.xmlsoap.org/soap/envelope"),e.addNamespace("d","http://schemas.microsoft.com/xrm/2011/Contracts/Services"),e.addNamespace("a","http://schemas.microsoft.com/xrm/2011/Contracts"),e.addNamespace("b","http://schemas.datacontract.org/2004/07/System.Collections.Generic"),e.addNamespace("i","http://www.w3.org/2001/XMLSchema-instance")}It("Create",Xe),It("ExecuteMultiple",Ze),It("ExecuteQuickFind",it),It("InitializeFrom",st),It("RetrieveEntitiesForAggregateQuery",lt),It("RetrieveMultiple",dt),It("RetrievePrincipalAccess",gt),It("RetrieveProcessControlData",mt),It("Retrieve",St),It("Update",Ct);var Pt=n("uu/V"),Tt=n("DS+G"),Nt=n("JdSN"),At=n("iLty"),Rt=n("IdrN"),Dt=n("sjhR");class xt extends At.a{constructor(e,t){if(super(e),this._entityCollection=null,e){const n=e.selectSingleNode(".//d:ExecuteResult/a:Results/a:KeyValuePairOfstringanyType/b:value[@i:type='a:EntityCollection']");this._set_entityCollection(G(n,t));const r=n.selectSingleNode("a:PagingCookie");r&&!Object(c.b)(r.get_innerText())&&t.set_PagingCookie(r.get_innerText());for(let e=0;e<this.get_entityCollection().get_count();e++)this.get_entityCollection().get_item(e).updateColumnSet(t.get_ColumnSet())}}get_entityCollection(){return this._entityCollection}_set_entityCollection(e){return this._entityCollection=e,e}}var Mt=n("91WF");class Ft{constructor(){this.name=null,this.requestText=null,this.requestSize=0,this.requestOptions=null,this.childRequests=null,this.context=null}static create(e,t,n,r,a){const i=new Ft;return i.name=e,i.requestText=t,i.requestSize=Object(c.a)(t)?0:t.length,i.requestOptions=n,i.context=r,i.childRequests=a,i}}var kt=n("EW4s");const Lt="http://schemas.microsoft.com/xrm/2011/Contracts/Services/IOrganizationService/Execute";class Bt extends r.a{constructor(e,t,n){super(e,t,n),Object(l.d)(e,"serverUri"),Object(l.d)(t,"remoteCallRetryHandler"),this._userLanguageCode=0,this._organizationWebEndPoint=this.get_serverUrl()+"/XRMServices/2011/Organization.svc/web",this._processControlEndPoint=this.get_serverUrl()+"/AppWebServices/ProcessControl.asmx/",this._customerServiceEndPoint=this.get_serverUrl()+"/AppWebServices/CustomerService.asmx",this._sdkClientVersion=Object(u.a)()}get_name(){return"CrmSoapService"}get_performanceStopwatch(){return i.a}_get_organizationWebEndPoint(){return this._organizationWebEndPoint}get_clientVersion(){return this._sdkClientVersion}RetrieveExtendedUserContext(){throw Error.notImplemented()}RetrieveUserContext(e,t){throw Error.notImplemented()}GetIsActivityFlags(){throw Error.notImplemented()}Execute(e,t){const n=new kt.a;let i,o,l;e instanceof Mt.a?(l=this.get_serverUrl()+Mt.a.scriptErrorRelativeWebEndpointUrl,i=e.requestBody(),o=Mt.a.scriptErrorSendReportSoapAction):(l=this._get_organizationWebEndPoint(),i=this.createCrmExecuteRequestBody(e.get_name(),e.get_name()+"Request",qe(e),"b",e.get_xmlNamespace()),o="http://schemas.microsoft.com/xrm/2011/Contracts/Services/IOrganizationService/Execute");let u=null;if(e instanceof de.a){u=new Array(0);for(const t of e.get_requests())u.push(t.get_name())}const d=this.createSoapRequestOptions(l,o),p=t instanceof a.a&&!Object(c.a)(t.RequestId())?t.RequestId():s.a.newGuid().toString();return r.a.addRequestId(d,p),this.executeSoapRequest(Ft.create(e.get_name(),i,d,t,u)).then(t=>{n.resolve(wt(e.get_name(),t,e))},e=>{n.reject(e)}),n}ExecuteOData(e,t){throw Error.notImplemented()}WhoAmI(){const e=this.createCrmExecuteRequestBody("WhoAmI","WhoAmIRequest",null,"b","http://schemas.microsoft.com/crm/2011/Contracts"),t=new kt.a;return this.executeSoapRequest(Ft.create("WhoAmI",e,this.createSoapRequestOptions(this._get_organizationWebEndPoint(),Lt))).then(e=>{t.resolve(new Ke.a("WhoAmI"))},e=>{t.reject(e)}),t}RetrieveMultiple(e,t){const n=this.createCrmExecuteRequestBody("RetrieveMultiple","RetrieveMultipleRequest",'<a:KeyValuePairOfstringanyType><b:key>Query</b:key><b:value i:type="a:FetchExpression"><a:Query>'+Object(N.b)(e.get_FetchXml())+"</a:Query></b:value></a:KeyValuePairOfstringanyType>"),r=new kt.a;return this.executeSoapRequest(Ft.create("RetrieveMultiple",n,this.createSoapRequestOptions(this._get_organizationWebEndPoint(),Lt),t)).then(t=>{r.resolve(new xt(t,e))},e=>{r.reject(e)}),r}Create(e,t,n){const r=new kt.a;return this.Execute(new ie.a(e,t)).then(t=>{e.resetChanges(),r.resolve(t)},e=>{r.reject(e)}),r}Update(e,t,n){const r=new kt.a;return this.Execute(new Le.a(e,t)).then(t=>{e.resetChanges(),r.resolve(t)},e=>{r.reject(e)}),r}DeleteEntity(e,t){const n=this._CreateCrmRequestBody("Delete","<entityName>"+Object(N.b)(e.LogicalName)+"</entityName><id>"+Object(N.b)(e.Id.toString())+"</id>"),r=new kt.a;return this.executeSoapRequest(Ft.create("Delete",n,this.createSoapRequestOptions(this._get_organizationWebEndPoint(),"http://schemas.microsoft.com/xrm/2011/Contracts/Services/IOrganizationService/Delete"),t)).then(e=>{r.resolve(new At.a(e))},e=>{r.reject(e)}),r}retrieveEntityMetadata(e,t,n){const r=this.createCrmExecuteRequestBody("RetrieveMetadataChanges","RetrieveMetadataChangesRequest",'<a:KeyValuePairOfstringanyType><b:key>Query</b:key><b:value i:type="c:EntityQueryExpression" xmlns:c="http://schemas.microsoft.com/xrm/2011/Metadata/Query"><c:Criteria><c:Conditions><c:MetadataConditionExpression><c:ConditionOperator>Equals</c:ConditionOperator><c:PropertyName>LogicalName</c:PropertyName><c:Value i:type="d:string" xmlns:d="http://www.w3.org/2001/XMLSchema">'+Object(N.b)(e)+'</c:Value></c:MetadataConditionExpression></c:Conditions><c:FilterOperator>And</c:FilterOperator><c:Filters /></c:Criteria><c:Properties><c:AllProperties>false</c:AllProperties><c:PropertyNames xmlns:d="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><d:string>LogicalName</d:string>'+(Object(o.b)()?"":"<d:string>Attributes</d:string>")+'<d:string>DisplayCollectionName</d:string><d:string>DisplayName</d:string><d:string>IsActivity</d:string><d:string>IsActivityParty</d:string><d:string>IsChildEntity</d:string><d:string>IsConnectionsEnabled</d:string><d:string>IsCustomEntity</d:string><d:string>IsCustomizable</d:string><d:string>IsEnabledForCharts</d:string><d:string>IsImportable</d:string><d:string>IsMailMergeEnabled</d:string><d:string>IsReadOnlyInMobileClient</d:string><d:string>IsVisibleInMobileClient</d:string><d:string>IsOfflineInMobileClient</d:string><d:string>IsOptimisticConcurrencyEnabled</d:string><d:string>IsValidForAdvancedFind</d:string><d:string>ManyToOneRelationships</d:string><d:string>OneToManyRelationships</d:string><d:string>ObjectTypeCode</d:string><d:string>PrimaryIdAttribute</d:string><d:string>IsStateModelAware</d:string><d:string>EnforceStateTransitions</d:string><d:string>PrimaryNameAttribute</d:string><d:string>Privileges</d:string><d:string>IsValidForQueue</d:string><d:string>ActivityTypeMask</d:string><d:string>OwnershipType</d:string><d:string>IsBusinessProcessEnabled</d:string><d:string>EntityHelpUrlEnabled</d:string><d:string>EntityHelpUrl</d:string><d:string>IsDocumentManagementEnabled</d:string><d:string>IsOneNoteIntegrationEnabled</d:string><d:string>IsMSTeamsIntegrationEnabled</d:string><d:string>EntityColor</d:string><d:string>IsInteractionCentricEnabled</d:string><d:string>IsQuickCreateEnabled</d:string><d:string>EntityClientSetting</d:string><d:string>IsKnowledgeManagementEnabled</d:string><d:string>IsIntersect</d:string><d:string>IsBPFEntity</d:string></c:PropertyNames></c:Properties><c:AttributeQuery i:nil="true" /><c:LabelQuery><c:FilterLanguages xmlns:d="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><d:int>'+t+'</d:int></c:FilterLanguages><c:MissingLabelBehavior>1</c:MissingLabelBehavior></c:LabelQuery><c:RelationshipQuery i:nil="true" /></b:value></a:KeyValuePairOfstringanyType>'),a=new kt.a;return this.executeSoapRequest(Ft.create("RetrieveMetadataChanges",r,this.createSoapRequestOptions(this._get_organizationWebEndPoint(),Lt),n)).then(e=>{a.resolve(new Rt.a(e))},e=>{a.reject(e)}),a}RetrieveMultipleAttributeMetadata(e,t,n){let r='<a:KeyValuePairOfstringanyType><b:key>Query</b:key><b:value i:type="c:EntityQueryExpression" xmlns:c="http://schemas.microsoft.com/xrm/2011/Metadata/Query"><c:Criteria><c:Conditions><c:MetadataConditionExpression><c:ConditionOperator>Equals</c:ConditionOperator><c:PropertyName>LogicalName</c:PropertyName><c:Value i:type="d:string" xmlns:d="http://www.w3.org/2001/XMLSchema">'+Object(N.b)(e.get_EntityLogicalName())+'</c:Value></c:MetadataConditionExpression></c:Conditions><c:FilterOperator>And</c:FilterOperator><c:Filters /></c:Criteria><c:Properties><c:AllProperties>false</c:AllProperties><c:PropertyNames xmlns:d="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><d:string>Attributes</d:string></c:PropertyNames></c:Properties><c:AttributeQuery><c:Criteria>';if(Object(c.a)(e.get_AttributeNames()))r+="<c:Conditions />";else{r+="<c:Conditions>";for(const t of e.get_AttributeNames())r+='<c:MetadataConditionExpression><c:ConditionOperator>Equals</c:ConditionOperator><c:PropertyName>LogicalName</c:PropertyName><c:Value i:type="d:string" xmlns:d="http://www.w3.org/2001/XMLSchema">'+Object(N.b)(t)+"</c:Value></c:MetadataConditionExpression>";r+="</c:Conditions>"}r+='<c:FilterOperator>Or</c:FilterOperator><c:Filters /></c:Criteria><c:Properties><c:AllProperties>false</c:AllProperties><c:PropertyNames xmlns:d="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><d:string>AttributeType</d:string><d:string>DefaultFormValue</d:string><d:string>DefaultValue</d:string><d:string>DisplayName</d:string><d:string>EntityLogicalName</d:string><d:string>Format</d:string><d:string>FormatName</d:string><d:string>DateTimeBehavior</d:string><d:string>ImeMode</d:string><d:string>IsBaseCurrency</d:string><d:string>IsSecured</d:string><d:string>IsValidForCreate</d:string><d:string>IsValidForRead</d:string><d:string>IsValidForUpdate</d:string><d:string>IsSortableEnabled</d:string><d:string>InheritsFrom</d:string><d:string>LogicalName</d:string><d:string>MaxLength</d:string><d:string>MaxValue</d:string><d:string>MinValue</d:string><d:string>OptionSet</d:string><d:string>Precision</d:string><d:string>PrecisionSource</d:string><d:string>RequiredLevel</d:string><d:string>SourceType</d:string><d:string>Targets</d:string><d:string>AttributeOf</d:string></c:PropertyNames></c:Properties></c:AttributeQuery><c:LabelQuery><c:FilterLanguages xmlns:d="http://schemas.microsoft.com/2003/10/Serialization/Arrays"><d:int>'+t+'</d:int></c:FilterLanguages><c:MissingLabelBehavior>1</c:MissingLabelBehavior></c:LabelQuery><c:RelationshipQuery i:nil="true" /></b:value></a:KeyValuePairOfstringanyType>',r=this.createCrmExecuteRequestBody("RetrieveMetadataChanges","RetrieveMetadataChangesRequest",r);const a=new kt.a;return this.executeSoapRequest(Ft.create("RetrieveMetadataChanges",r,this.createSoapRequestOptions(this._get_organizationWebEndPoint(),Lt),n)).then(e=>{a.resolve(new Dt.a(e))},e=>{a.reject(e)}),a}retrieveNavigationEntities(e,t,n,r,a){const i=this._processControlEndPoint+"GetForwardNavigationEntities",o=JSON.stringify({currentEntityId:e,referencedEntityLogicalName:t,referencingEntityLogicalName:n,referencingEntityAttributeName:r}),s=new kt.a;return this.executeJsonRequest(Ft.create(i,o,this.createJsonRequestOptions(i),a)).then(e=>{s.resolve(this._CreateJsonResponse(e))},e=>{s.reject(e)}),s}changeProcessAndStage(e,t,n,r,a,i){const o=this._processControlEndPoint+"ChangeProcessAndStageMoca",s=JSON.stringify({currentEntityId:e,currentEntityTypeName:t,newProcessId:n,newStageId:r,traversedPath:a}),c=new kt.a;return this.executeJsonRequest(Ft.create(o,s,this.createJsonRequestOptions(o),i)).then(e=>{c.resolve(this._CreateJsonResponse(e))},e=>{c.reject(e)}),c}createNavigationEntity(e,t,n,r,a){const i=this._processControlEndPoint+"CreateForwardNavigationEntity",o=JSON.stringify({sourceEntityLogicalName:e,sourceEntityId:t.toString(),targetEntityLogicalName:n,targetEntityAttributeName:r}),s=new kt.a;return this.executeJsonRequest(Ft.create(i,o,this.createJsonRequestOptions(i),a)).then(e=>{s.resolve(this._CreateJsonResponse(e))},e=>{s.reject(e)}),s}GetClientMetadata(e,t){throw Error.notImplemented()}SyncClientMetadata(e){throw Error.notImplemented()}GetRecentItems(e,t,n,r,a,i,o){throw Error.notImplemented()}UpdateRecentItems(e,t){throw Error.notImplemented()}RetrieveUserLocalFacets(e,t){const n=new kt.a,r=this._customerServiceEndPoint,a=this.createSoapRequestBody('<GetLocalFacets xmlns="http://schemas.microsoft.com/crm/2009/WebServices"><entityName>'+e+"</entityName></GetLocalFacets>"),i=this.createSoapRequestOptions(r,"http://schemas.microsoft.com/crm/2009/WebServices/GetLocalFacets");return this.executeSoapRequest(Ft.create("GetLocalFacets",a,i,t)).then(e=>{const t=e.childNodes().get_item(0).childNodes().get_item(0).childNodes().get_item(0).childNodes().get_item(0);n.resolve({Value:t.get_innerText()})},e=>{n.reject(e)}),n}createCrmExecuteRequestBody(e,t,n,r,a){Object(l.a)(Object(c.a)(r)&&Object(c.a)(a)||!Object(c.a)(r)&&!Object(c.a)(a),"The namespace alias and namespace need to be set together");let i="";return Object(c.a)(r)&&(r="a"),"RetrieveRecordWall"===e?i='<Execute xmlns="http://schemas.microsoft.com/xrm/2011/Contracts/Services"><request i:type="a:OrganizationRequest" xmlns:a="http://schemas.microsoft.com/xrm/2011/Contracts" xmlns:i="http://www.w3.org/2001/XMLSchema-instance">':(i='<Execute xmlns="http://schemas.microsoft.com/xrm/2011/Contracts/Services" xmlns:i="http://www.w3.org/2001/XMLSchema-instance"><request i:type="'+r+":"+t+'" xmlns:a="http://schemas.microsoft.com/xrm/2011/Contracts"',Object(c.a)(a)||(i+=" xmlns:"+r+'="'+a+'"'),i+=">"),Object(c.b)(n)?i+='<a:Parameters i:nil="true" />':i+='<a:Parameters xmlns:b="http://schemas.datacontract.org/2004/07/System.Collections.Generic">'+n+"</a:Parameters>",i+='<a:RequestId i:nil="true" /><a:RequestName>'+e+"</a:RequestName></request></Execute>",this.createSoapRequestBody(i)}_CreateCrmRequestBody(e,t){const n="<"+e+' xmlns="http://schemas.microsoft.com/xrm/2011/Contracts/Services">'+t+"</"+e+">";return this.createSoapRequestBody(n)}getSoapHeaders(){return this._GetLanguagecodeOverride()+this._GetSdkClientVersionSoapHeader()+this._GetCrmMobileClientUniqueIdSoapHeader()}_GetLanguagecodeOverride(){return this._userLanguageCode>0?'<LanguageCodeOverride xmlns="http://schemas.microsoft.com/xrm/2011/Contracts">'+this._userLanguageCode+"</LanguageCodeOverride>":""}_GetSdkClientVersionSoapHeader(){return'<SdkClientVersion xmlns="http://schemas.microsoft.com/xrm/2011/Contracts">'+this.get_clientVersion()+"</SdkClientVersion>"}_GetCrmMobileClientUniqueIdSoapHeader(){return""}createErrorResponse(e,t,n){return new Nt.a(e,t,n)}createErrorResponseFromHtml(e){return Nt.a.createFromHtml(e,null)}hasNilNodes(e){return"RetrieveMetadataChanges"===e}handleSpecialCaseSoapResults(e,t,n){if("RetrieveMetadataChanges"===e.name)try{return n.resolve(new b(t)),!0}catch(e){return!1}return!1}canRetryServerError(e){const t=e;if(Object(c.a)(t)||Object(c.a)(t.get_organizationServiceFault()))return!1;switch(t.get_organizationServiceFault().get_errorCode()){case-2147180543:return!0;default:return!1}}addHeaders(e,t){e.ClientAppVersion=this.get_clientVersion();let n;try{n=localStorage.getItem("UCISessionID")}catch(e){}Object(c.b)(n)||(e.SessionId=n),e.ClientAppName="UCIClient"}createResponseData(e,t){return super.createResponseData(e,t)}_CreateJsonResponse(e,t){let n,r=null,a=0,i=null;const o=Object(c.a)(e.d);if(Object(c.a)(e)||o&&Object(c.a)(e.body))n=!1,r=Pt.a.invalidResponseMessage;else if(o)n=!0,i=e.body;else{const t=e.d;n=t.Success,n?i=t:(r=t.ErrorMessage,a=t.ErrorCode)}return Object(c.a)(t)||t!==Tt.a?new Pt.a(n,r,a,i):new Tt.a(n,r,a,i)}}Bt.xrm2011MetadataNamespace="http://schemas.microsoft.com/xrm/2011/Metadata",Bt.xrm2011MetadataQueryNamespace="http://schemas.microsoft.com/xrm/2011/Metadata/Query",Bt.xrm2011ContractsNamespace="http://schemas.microsoft.com/xrm/2011/Contracts"},"K+04":function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="set.CopresenceUsers.Action",a="set.CopresenceCurrentUserSessionId.Action",i="get.CopresenceUserInfo.Action"},K6rc:function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return y}));var r=n("YVjE"),a=n("ABtu"),i=n("/t1C"),o=n("WbTV"),s=n("fMBw"),c=n.n(s),l=n("SAYH"),u=n("SZCI"),d=n("H4dV"),p=n("ABCl"),f=n("17x/");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const g=window.Promise,h=d.a.getInstance().get_IsBrowserIE(),m=c.a.createEvent("ExecuteFunction",u.i),b="Timed out after 10000ms";class y{constructor(e,t,n,r,a,i,o){this.initialized=!1,this._iframe=e,this._tracing=t,this._telemetryEventManager=n,this._scriptManager=r,this._applicationContext=a,this._clientApiManager=o,this._store=i}initEventManager(e){this._eventManager=new i.a(e,this,this._tracing,this._telemetryEventManager,this._scriptManager,this._clientApiManager)}getEventManager(){return this._eventManager}get id(){return this._iframe.id}set iFrame(e){this._errorHandler=new a.a(this._applicationContext,e.contentWindow),this._iframe=e}get iFrame(){return this._validateIframeUse(),this._iframe}getIFrame(){return this._iframe}get errorHandler(){return this._errorHandler}initialize(){return Object(o.patchNetworkRequestsOnWindow)(this._iframe.contentWindow,this._iframe.id),this._setupMicrosoftObject(),this.setGlobalVariable("Microsoft",Microsoft),this._assetLoader=new r.a(this._iframe.contentWindow.document,this._applicationContext,this._store),h&&void 0===this._iframe.contentWindow.Promise&&(this._iframe.contentWindow.Promise=g),this.initialized=!0,this}loadWebResourceSync_DO_NOT_USE(e){this._validateIframeUse(),this._assetLoader.loadScriptSync_DO_NOT_USE(e)}loadWebResources(e){return this._validateIframeUse(),this._assetLoader.loadScripts(e)}loadWebResourcesForAllContexts(e,t,n,r,a){return this._validateIframeUse(),Promise.all(e.map(e=>this._assetLoader.loadWebResource(e,t,n,r,a))).then(()=>this._patchOfflineChecks())}_patchOfflineChecks(){var e,t,n,r,a,i,o;if(Object(f.j)(this._store.getState())){const s=()=>Xrm.Utility.getGlobalContext().client.getClientState()===Xrm.Constants.ClientStates.offline,c=this.iFrame.contentWindow||{};(null===(n=null===(t=null===(e=null==c?void 0:c.XrmCore)||void 0===e?void 0:e.InternalUtilities)||void 0===t?void 0:t.DialogUtilities)||void 0===n?void 0:n.isOffline)&&(c.XrmCore.InternalUtilities.DialogUtilities.isOffline=s),(null===(a=null===(r=null==c?void 0:c.Activities)||void 0===r?void 0:r.ClientApi)||void 0===a?void 0:a.IsMocaOffline)&&(c.Activities.ClientApi.IsMocaOffline=s),(null===(o=null===(i=null==c?void 0:c.ClientUtility)||void 0===i?void 0:i.ClientUtil)||void 0===o?void 0:o.isMobileOffline)&&(c.ClientUtility.ClientUtil.isMobileOffline=s)}}loadJavascriptString(e){this._validateIframeUse(),this._assetLoader.loadRawJavaScript(e.replace(/\\x([0-9A-Fa-f]{2})/g,(e,t)=>String.fromCharCode(parseInt(t,16))))}_setupMicrosoftObject(){window.Microsoft||(window.Microsoft={Crm:{}}),Microsoft.Crm.Application||(Microsoft.Crm.Application={SharedObjects:{ProcessUnificationConstants:{returnRawValueFlag:"ProcessUnification_ReturnRawValue",readOnlyFlagPrefix:"ProcessUnification_ReadOnly_",hiddenFlagPrefix:"ProcessUnification_Hidden_",processActionArgumentsPrefix:"ProcessUnification_Arguments_",mddOkButtonId:"ok_id",mddLastButtonClickedId:"last_button_clicked"}}})}setGlobalVariable(e,t,n=!1){const r=this._iframe.contentWindow,a=n||!r[e];if(a)r[e]=t;else{const t=[];t.push({name:"Container Variable",value:e});const n=new Error("ScriptContainer.setGlobalVariable can only be set once");this._tracing.info(n.message,t)}return a}getGlobalVariable(e){return this._iframe.contentWindow[e]}executeSync_DO_NOT_USE(e,t,n,r){const{func:a,thisContext:i,foundParts:o}=_(e,this.iFrame.contentWindow||{});return a&&"function"==typeof a?this._executeFunctionInternal(a,t,i,e,r):this._handleMethodNotExistError(e,i,o,n)}async execute(e,t,n,r,a){var i,o;let s,c,l,u=!1;if("string"==typeof e){l=e;const t=_(l,this.iFrame.contentWindow||{});s=t.func,c=t.thisContext;const r=t.foundParts;if(!s||"function"!=typeof s)return this._handleMethodNotExistError(l,c,r,n)}else l=e.name||"anonymous",s=e;const d=this._executeFunctionInternal(s,t,c,l,r);if(!d||"function"!=typeof d.then)return d;if("onsave"===(null==r?void 0:r.type)){a&&"function"==typeof(null===(i=a)||void 0===i?void 0:i.shouldDisableAsyncTimeout)&&(null===(o=a)||void 0===o?void 0:o.shouldDisableAsyncTimeout())&&(u=!0);const e=[{name:"AsyncOnSaveFired",value:!0}];e.push(...Object.keys(r).map(e=>({name:e,value:r[e]}))),this._telemetryEventManager.ReportComponentSuccess("Forms.AsyncOnSave",e)}else if("onload"===(null==r?void 0:r.type)){const e=[{name:"AsyncOnLoadFired",value:!0}];e.push(...Object.keys(r).map(e=>({name:e,value:r[e]}))),this._telemetryEventManager.ReportComponentSuccess("Forms.AsyncOnLoad",e)}let p=-1;const f=new Promise((e,t)=>{p=setTimeout(()=>{this._tracing.error(b,r?Object.keys(r).map(e=>({name:e,value:r[e]})):[]),t({message:b})},1e4)}),g=u?d:Promise.race([d,f]);try{return await g}finally{clearTimeout(p)}}_handleMethodNotExistError(e,t,n,r){const a=`Web resource method does not exist: ${e}${t&&"object"==typeof t&&n?`. However the closest object we found is ${n} that contains these properties: ${Object.keys(t)}. Please verify this object is not corrupt and is not an object of the same name defined elsewhere, such as another script. `:""}`;if(!r)return this._tracing.info(a),null;throw new ReferenceError(a)}_executeFunctionInternal(e,t,n,r,a){const i=m.startStopwatch(Object.assign({method:r},a)),s=[],c=Object(o.addNetworkRequestListener)(e=>{e.id=l.a.toString(l.a.newGuid()),s.push({id:e.id,sync:e.sync})});let u;this._currentInfo=a;try{u=e.apply(n,t)}catch(e){const t=[];throw e?t.push({name:"exception",value:(null==e?void 0:e.message)||(null==e?void 0:e.toString())}):t.push({name:"exception",value:null}),t.push({name:"function",value:r}),t.push({name:"exceptionStack",value:null==e?void 0:e.stack}),a&&t.push(...Object.keys(a).map(e=>({name:e,value:a[e]}))),this._tracing.error(p.a,t),e&&e instanceof Object&&!e.errorCode&&(e.errorCode=2153976091),e}finally{this._currentInfo=void 0}return c(),i(s.length>0?{requests:JSON.stringify(s)}:void 0),u}getCurrentInfo(){return this._currentInfo}_validateIframeUse(){if(!this.initialized){const e=[];e.push({name:"Container Id",value:this.id}),this._telemetryEventManager.ReportComponentFailure("container",new Error("Accessed IFrame before initialized"),null,e)}}}function _(e,t){if(!e)return{func:void 0,thisContext:void 0,foundParts:""};const n=e.split(".");let r,a=(t=t[n[0]])?n[0]:"";for(let e=1;e<n.length&&t;e++)r=t,(t=t[n[e]])&&(a+="."+n[e]);return{func:t,thisContext:r,foundParts:a}}},K7RF:function(e,t,n){"use strict";n.d(t,"b",(function(){return D})),n.d(t,"c",(function(){return k})),n.d(t,"e",(function(){return L})),n.d(t,"f",(function(){return B})),n.d(t,"a",(function(){return R})),n.d(t,"d",(function(){return U}));var r=n("g0tL"),a=n("Uv1Y"),i=n("5KQF"),o=n("SAYH"),s=n("E5IU"),c=n("BDhr"),l=n("wCzE"),u=n("x/aW"),d=n("eXjw"),p=n("pEXn"),f=n("69Qu"),g=n("FZDd"),h=n("iZ7K"),m=n("N6Lu"),b=n("iF9X"),y=n("37s6"),_=n("Lyxw"),v=n("SRlt"),S=n("4r2D"),O=n("/oKV"),C=n("0rLi"),E=n("fU7K"),I=n("fHQ8"),w=n("F2/H"),j=n("3/02"),P=n("1TGm");function T(e,t,n){return Object(w.e)(e)&&Object(_.f)(e,j.ug)&&Object(P.a)(t,n)}var N=n("eD3A"),A=n("wL2W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const R="gcm.retrieve";function D(e,t,c,u,d,g,h,_,v,w,j=O.a.LocalAndRemote,P=null,R=null,M,L){const B=[],U=arguments;return{type:"gcm.retrieve.async",execute({dispatch:O,getState:V},z,q){const H=new S.a(o.a.newGuid().guid),W=z.DataSource,G=V(),K=Object(s.k)(G),Q=o.a.toLegacyGuid(o.a.tryParseOrNull(K)),X=Object(l.a)(G),Y=z.TraceManager.getTracer("GetClientMetadata");T(G,e,g)&&O(Object(I.b)(U)),!h&&X&&X.currentVersion&&(h=X.currentVersion.toString()),B.push({name:p.b.MetadataTye,value:e},{name:p.b.MetadataSubType,value:t},{name:p.b.MetadataId,value:u?o.a.fromLegacyGuid(u).guid:null},{name:p.b.EntityName,value:c},{name:p.b.MetadataNames,value:v&&v.length>0?v.toString():null},{name:p.b.ServerAvailabilityStatus,value:Object(f.d)(G)},{name:p.b.LocalDataSourceAvailabilityStatus,value:W.get_IsLocalDataSourceAvailable()},{name:p.b.IsMocaOfflineFeatureEnabled,value:Object(b.a)(G)},{name:p.b.MobileOfflineFeatureStatus,value:Object(y.v)(G)},{name:p.b.OfflineStatus,value:Object(y.w)(G)},{name:p.b.ClientRequestId,value:H&&H.RequestId?H.RequestId():null});const J=new C.a(e,t,c,u,v,d,g,h,_,Q,L);return J.IsPreloadCall=q&&q.isPreloadCall,W.getClientMetadata(J,j,H,M).nativePromise().then(async t=>{const a=w===r.b.Dashboard&&v.length>0?v[0]:null;let o,s=null;G&&Object(N.r)(G)&&(s=await n.e(66).then(n.bind(null,"MY+P"))),Object(A.a)()&&(o=await n.e(71).then(n.bind(null,"xmOX")));const l=Object(i.a)(t,w,c,V(),a,u,Y,K,null==s?void 0:s.serializeAppActionDescriptor,o);x(V(),e,l,z);const d=l.webResourcesContent;if(l.webResourcesContent=null,O(k(l)),l.webResourcesContent=d,null!=t.WebResourceHash){const e=V(),n=t.WebResourceHash,r=Object(E.CrmUrlEncode)(n[0].toString());e.organization.organizationSettings.webResourceHash!==r&&O(Object(m.b)(r))}return l}).catch(n=>{if(12163===Object(a.c)(n).errorCode)return O(D(e,t,c,u,d,g,h,_,v,w,j,P,R,M));F(n,e,t,O,V())})},getFailureParameters:(e,t)=>B}}function x(e,t,n,r){const a=Object(c.b)(e);a&&n&&n.metadataVersion&&a.currentVersion!==n.metadataVersion.currentVersion&&M(u.a.MetadataVersion,a.currentVersion,n.metadataVersion.currentVersion,r);const i=Object(l.a)(e);i&&n&&n.userMetadataVersion&&i.currentVersion!==n.userMetadataVersion.currentVersion&&M(u.a.UserMetadataVersion,i.currentVersion,n.userMetadataVersion.currentVersion,r)}function M(e,t,n,r){const a=[];a.push({name:p.b.MetadataTye,value:e},{name:p.b.CurrentMetadataVersion,value:t},{name:p.b.ChangedMetadataVersion,value:n});r.TraceManager.getTracer(v.c.TRACER_CATEGORY_ID).warn("MetadataVersion Changed",a)}function F(e,t,n,r,i){if(t===g.a){const e=Object(g.c)(n),t=[];e.forEach(e=>{Object(h.h)(i,e)||t.push(e)}),r(Object(g.g)(t))}return Object(a.b)(e)}function k(e){return{type:R,payload:e}}function L(e,t){let n=!1;if(Object(f.c)(e)&&Object(c.c)(e)===d.a.Initialized){Object(c.b)(e).currentVersion>t&&(n=!0)}return n}function B(e,t){let n=!1;if(Object(f.c)(e)&&Object(l.b)(e)===d.a.Initialized){const r=Object(l.a)(e);-1!==t&&r.currentVersion>t&&(n=!0)}return n}function U(e,t,{OverallVersionNumber:n,OverallUserVersionNumber:r},a){const i=Object(_.f)(e,j.Nd);if(i&&t){const e=a();if(e&&e.OverallUserVersionNumber){const t=e.OverallUserVersionNumber;r=Math.max(r,t)}}const o=L(e,n),s=B(e,r);return i&&t&&o||(!i||!t)&&(o||s)?1:i&&t&&s?2:0}},K9oF:function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"g",(function(){return c})),n.d(t,"h",(function(){return l})),n.d(t,"f",(function(){return u}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="authentication.set.token",a="authentication.set.objectid",i="authentication.set.tenantid",o="authentication.set.cookies.available";function s(e){return{type:r,payload:e}}function c(e){return{type:a,payload:e}}function l(e){return{type:i,payload:e}}function u(e){return{type:o,payload:e}}},K9wp:function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var r=n("ABCl"),a=n("Nb1E"),i=n("69Qu"),o=n("odYE"),s=n("SAYH"),c=n("16wZ"),l=n("4ciL"),u=n("aRLb"),d=n("+YnR"),p=n("/oKV"),f=n("Er26"),g=n("z+5+"),h=n("+6s6"),m=n("iB7y");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
let b;class y{constructor(e,t){b=e,this._pageId=t,this._clientApiExecutor=new r.b(e,h.e)}execute(e){return this._execute("execute",(t,n)=>(this._verifyWebApiOnlineIsReady(n),Object(g.J)(e,n),b.dispatch(Object(u.b)(e,this._pageId,t))),[{name:"request",value:e,isRequired:!0,expectedDataType:"object"},{name:"request.getMetadata",value:e&&e.getMetadata,isRequired:!0,expectedDataType:"function"},{name:"operationName",value:e&&e.getMetadata&&e.getMetadata().operationName,isRequired:!0,isEventParam:!0},{name:"operationType",value:e&&e.getMetadata&&e.getMetadata().operationType,isRequired:!0,isEventParam:!0}])}executeMultiple(e){return this._execute("executeMultiple",(t,n)=>(this._verifyWebApiOnlineIsReady(n),b.dispatch(Object(l.b)(e,t,this._pageId)).then(t=>this._postProcessRequestsOnSuccess(t,e))),[{name:"requests",value:e,isRequired:!0}])}_postProcessRequestsOnSuccess(e,t){const n=this._getEntitiesToBeDeletedFromRequests(t);return n.length&&Object(d.b)(b,n,this._pageId),e}_getEntitiesToBeDeletedFromRequests(e){const t=[];return e.forEach((function e(n){const r=n;if(r.getMetadata){if(function(e){const t="Delete"===e.operationName,n=2===e.operationType,r=e.parameterTypes&&e.parameterTypes.entityReference;return t&&n&&!!r}(r.getMetadata())){const e=n.entityReference;t.push(e)}}else n.forEach(e)})),t}retrieveRecord(e,t,n){return this._execute("retrieveRecord",(r,i,l)=>{this._verifyWebApiOnlineIsReady(i,l),Object(g.K)(n,i,l);const u=s.a.tryParseOrNull(t);u||Object(c.k)(i,"guid","id",l);const d=new o.a(e,u);return b.dispatch(Object(a.d)(d,n,void 0,void 0,p.a.Remote,r,this._pageId))},[{name:"entityType",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"string"},{name:"id",value:t,isRequired:!0,isEventParam:!0,expectedDataType:"guid"},{name:"options",value:n,isRequired:!1,isEventParam:!1,expectedDataType:"string"}])}createRecord(e,t){return this._execute("createRecord",(n,r,i)=>(this._verifyWebApiOnlineIsReady(r,i),b.dispatch(Object(a.b)(e,t,p.a.Remote,n,this._pageId)).then(t=>({id:s.a.toString(t),entityType:e}))),[{name:"entityType",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"string",isClientAPICheckerParam:!0},{name:"data",value:t,isRequired:!0,expectedDataType:"object",isClientAPICheckerParam:!0}],!1,!0).finally(async()=>{const n=await Object(m.a)();n&&b.dispatch(n.runSaveRecordCheckerForXrmWebApi(e,void 0,t,!0))})}updateRecord(e,t,n){return this._execute("updateRecord",(r,i,l)=>{this._verifyWebApiOnlineIsReady(i);const u=s.a.tryParseOrNull(t);u||Object(c.k)(i,"guid","id",l);const d=new o.a(e,u);return b.dispatch(Object(a.f)(d,n,void 0,void 0,void 0,p.a.Remote,r,this._pageId)).then(()=>({id:t,entityType:e}))},[{name:"entityType",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"string",isClientAPICheckerParam:!0},{name:"id",value:t,isRequired:!0,isEventParam:!0,expectedDataType:"guid",isClientAPICheckerParam:!0},{name:"data",value:n,isRequired:!0,expectedDataType:"object",isClientAPICheckerParam:!0}],!1,!0).finally(async()=>{const r=await Object(m.a)();r&&b.dispatch(r.runSaveRecordCheckerForXrmWebApi(e,t,n,!1))})}deleteRecord(e,t){return this._execute("deleteRecord",(n,r,i)=>{this._verifyWebApiOnlineIsReady(r);const l=s.a.tryParseOrNull(t);l||Object(c.k)(r,"guid","id",i);const u=new o.a(e,l);return b.dispatch(Object(a.c)(u,void 0,p.a.Remote,n,this._pageId)).then(()=>{Object(d.a)(b,e,s.a.tryParse(t),this._pageId);return{id:t,entityType:e}})},[{name:"entityType",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"string"},{name:"id",value:t,isRequired:!0,isEventParam:!0,expectedDataType:"guid"}])}retrieveMultipleRecords(e,t,n,r){return this._execute("retrieveMultipleRecords",(i,o,s)=>(Object(g.K)(t,o,s),Object(g.I)(n,o,s),Object(g.H)(e,o,s),this._verifyWebApiOnlineIsReady(o),b.dispatch(Object(a.e)(e,t,n,p.a.Remote,i,this._pageId,r)).then(e=>{let t=null;if(e&&e.value){const n="@odata.nextLink",r="@Microsoft.Dynamics.CRM.fetchxmlpagingcookie";t={entities:e.value,nextLink:e[n]},e[r]&&(t.fetchXmlPagingCookie=e[r])}return t})),[{name:"entityType",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"string"},{name:"options",value:t,isRequired:!1,isEventParam:!1,expectedDataType:"string"},{name:"maxPageSize",value:n,isRequired:!1,isEventParam:!0,expectedDataType:"number"}])}_verifyWebApiOnlineIsReady(e,t){Object(i.d)(b.getState())||Object(c.e)(e,"API can be accessed only when online.",null,t)}_execute(e,t,n,r=!1,a=!1){const i={OperationSource:`${f.b}.${e}`};return this._clientApiExecutor.executeAsync(e,(e,n,r)=>t(i,e,n,r),n,r,a)}}},KBcj:function(e,t,n){"use strict";n.d(t,"c",(function(){return s})),n.d(t,"j",(function(){return c})),n.d(t,"a",(function(){return l})),n.d(t,"f",(function(){return u})),n.d(t,"e",(function(){return p})),n.d(t,"h",(function(){return d})),n.d(t,"d",(function(){return m})),n.d(t,"i",(function(){return f})),n.d(t,"b",(function(){return g})),n.d(t,"g",(function(){return h}));var r,a=n("eXjw"),i=n("SAYH"),o=n("d0w6");function s(e,t,n=!1){const r=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e){return e&&e.metadata&&e.metadata.views?e.metadata.views:null}(e),a=i.a.toString(t);if(!r||!r[a])return null;const o=r[a];return n&&(o.title="New view"),o}function c(e,t){const n=s(e,t);return n?n.initialized:a.a.Uninitialized}function l(e,t,n){if(!(e&&e.metadata&&e.metadata.viewDefaults&&t))return null;const r=e.metadata.viewDefaults[t];return r?r[o.a[n]]:null}function u(e,t,n){const r=f(e);if(!r||!t)return null;const a=r[t];return a?a[o.a[n]]:null}function d(e,t,n){return function(e,t,n,r){if(!(e&&e.metadata&&e.metadata.viewSelectorVersions&&t&&r))return null;const a=e.metadata.viewSelectorVersions[t];if(!a)return null;const i=a[o.a[n]];return i?i[r]:null}(e,t,n,r.OverallUserVersionNumber)}function p(e,t,n,r){const a=f(e);if(!a||!t)return null;const s=a[t];if(!s)return null;const c=s[o.a[n]];return c?c[i.a.toString(r)]:null}function f(e){return e&&e.metadata&&e.metadata.viewSelectors?e.metadata.viewSelectors:null}function g(e){return e&&e.metadata&&e.metadata.viewDefaults?e.metadata.viewDefaults:null}function h(e){return e&&e.metadata&&e.metadata.viewSelectorSortOrders?e.metadata.viewSelectorSortOrders:null}function m(e,t){const n=s(e,t);return n&&n.grid&&n.grid.customControlDescriptions?n.grid.customControlDescriptions:null}!function(e){e.OverallUserVersionNumber="overallUserVersionNumber",e.OverallVersionNumber="overallVersionNumber"}(r||(r={}))},KJT0:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.closed=0]="closed",e[e.openLeft=1]="openLeft",e[e.openRight=2]="openRight",e[e.open=3]="open"}(r||(r={}))},KLhE:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.none=0]="none",e[e.userOwned=1]="userOwned",e[e.teamOwned=2]="teamOwned",e[e.businessOwned=4]="businessOwned",e[e.organizationOwned=8]="organizationOwned",e[e.businessParented=16]="businessParented"}(r||(r={}))},KOTC:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("mMyr");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class a extends r.Component{constructor(e){super(e),this.state={component:null}}componentDidMount(){this.props.loader().then(e=>this.setState({component:e}))}render(){return this.state.component?r.createElement(this.state.component,this.props.props,this.props.children):null}}},KXDI:function(e,t,n){"use strict";n.d(t,"d",(function(){return d})),n.d(t,"b",(function(){return m})),n.d(t,"a",(function(){return b})),n.d(t,"c",(function(){return g}));var r=n("SAYH"),a=n("iZ7K"),i=n("uIhY"),o=n("CB5L"),s=n("3ZcW");const c={COLON:encodeURIComponent(":"),OPEN_BRACKET:encodeURIComponent("{"),CLOSED_BRACKET:encodeURIComponent("}"),COMMA:encodeURIComponent(","),EQUAL:encodeURIComponent("=")};function l(e,t,n,r){switch(e){case"Edm.String":return u(e,t,n,r);case"Edm.Guid":return u(e,t.guid,n,r);case"Edm.DateTimeOffset":if("object"==typeof t&&"function"==typeof t.toISOString)return u(e,t.toISOString(),n,r);default:return u("Edm.UndefinedType",t,n,r)}}function u(e,t,n,r){switch(function(e,t,n){let r=n?t?o.d.DoubleQuotesURL:o.d.NoQuotesURL:o.d.Contract;return r===o.d.Contract?"Edm.UndefinedType"===e?r=o.d.None:"Edm.String"===e&&(r=o.d.JsonifyURL):r===o.d.NoQuotesURL&&"Edm.String"===e?r=o.d.SingleQuotesURL:r===o.d.DoubleQuotesURL&&"Edm.UndefinedType"===e&&(r=o.d.NoQuotesURL),r}(e,n,r)){case o.d.JsonifyURL:return JSON.stringify(t);case o.d.SingleQuotesURL:return`'${Object(i.c)(t)}'`;case o.d.DoubleQuotesURL:return`"${Object(i.c)(t,!0)}"`;case o.d.NoQuotesURL:return Object(i.c)(t);case o.d.Contract:return`"${t}"`;default:return t}}function d(e,t,n,r=!1){if(t){let a="{",i="";const o=r?c.COLON:":";if(n){const e=t.getMetadata().typeName;e&&n.typeName!==e&&(a+=`"@odata.type"${o}"${e}"`,i=",")}for(const n in t)if("function"!=typeof t[n]){const s=g(e,t,n,!0,r);if(p(t,n,s))continue;a+=`${i}"${n}"${o}${s}`,i||(i=",")}return a+"}"}return"null"}function p(e,t,n){if(e instanceof s.a){if([null,"null","[]",""].indexOf(n)>=0)return!0;if("DependencyDepth"===t&&e[t]===o.b.OnDemandWithoutContext)return!0}return!1}function f(e,t,n,r){const a=Object(i.e)(e,t);return null==a?"":n?u(t.typeName,a.name,n,r):`${t.typeName}'${a.name}'`}function g(e,t,n,r=!1,a=!1,o){var s;const c=t.getMetadata();let u=t[n];if(n&&0===n.indexOf("@odata."))return`"${u}"`;const p=c.parameterTypes[n];if(void 0===p)return null==o||o.warn(`Unable to serialize complex parameter ${n} because type is not defined in ${c.operationName} metadata`),null;switch(p.structuralProperty){case 1:return null==u?null:"MetadataSubtype"===n&&"Edm.String"===p.typeName?`"${u}"`:l(p.typeName,u,r,a);case 5:return Object(i.f)(e,u,r,a,o);case 2:return d(e,u,p,a);case 3:return f(u,p,r,a);case 4:if(u&&u.length){const e=u.filter(e=>null!=e);e.length<u.length&&(null==o||o.warn("unexpected null or undefined value in function request collection type parameters")),u=e}if(!u)return"null";if(!u.length)return"[]";if(null===(s=u[0])||void 0===s?void 0:s.getMetadata){return"["+u.map(t=>d(e,t,void 0,a)).join(",")+"]"}return-1!==i.a.indexOf(p.typeName)?"["+u.map(e=>l(p.typeName,e,r,a)).join(",")+"]":p.enumProperties?"["+u.map(e=>f(e,p,r,a)).join(",")+"]":"number"==typeof u[0]?"["+u.map(e=>l("Edm.String",e,r,a)).join(",")+"]":"["+u.map(t=>Object(i.f)(e,t,r,a)).join(",")+"]"}}function h(e,t,n,i){var o,s;if(!t)throw new Error("Cannot generate base URL for the OData call: the routine name is empty.");if(!n)throw new Error("Cannot generate base URL for the OData call: the request is empty.");if(!n.getMetadata())throw new Error("Cannot generate base URL for the OData call: the request metadata is empty.");const c=n.getMetadata().boundParameter;if(c){const l=n.getMetadata();if(!l||!l.parameterTypes||!l.parameterTypes[c])return null==i||i.warn(`The parameterTypes or parameterTypes of ${c} in function request is null or undefined!`),null;if(4===l.parameterTypes[c].structuralProperty){const n=l.parameterTypes[c].typeName&&l.parameterTypes[c].typeName.split(".").pop();if(!n)return null==i||i.warn(`The entity logical name of parameterTypes for ${l.parameterTypes[c].typeName} in function request is null!`),null;const r=Object(a.o)(e,n);if(!r){const t=[];return t.push({name:"EntityDescriptorPresent",value:!!Object(a.h)(e,n)}),t.push({name:"LogicalNameOnState",value:null===(o=Object(a.h)(e,n))||void 0===o?void 0:o.EntityLogicalName}),t.push({name:"EntitySetNameOnState",value:null===(s=Object(a.h)(e,n))||void 0===s?void 0:s.EntitySetName}),null==i||i.warn(`The entitySet name for ${n} in function request is null!`,t),null}return`${r}/Microsoft.Dynamics.CRM.${t}`}const u=n[c];return`${Object(a.o)(e,u.entityType)}(${r.a.fromExternalGuid(u.id).guid})/Microsoft.Dynamics.CRM.${t}`}return""+t}function m(e,t,n){var r;return`${h(e,null===(r=t.getMetadata())||void 0===r?void 0:r.operationName,t,n)}${function(e,t,n){const r=t.getMetadata().boundParameter,a=[],i=Object.keys(t).filter(e=>"function"!=typeof t[e]&&e!==r).map(r=>{const i=t.getMetadata().parameterTypes[r],o=g(e,t,r,!1,!0,n);return void 0!==i&&3===i.structuralProperty?`${r}=${o}`:(a.push(`@${r}=${o}`),`${r}=@${r}`)});return a.length?`(${i.join(",")})?${a.join("&")}`:(i&&0!==i.length||null==n||n.warn("0 parameters were passed with the request "+t.getMetadata().operationName),`(${i.join(",")})`)}(e,t,n)}`}function b(e,t,n){return h(e,t.getMetadata().operationName,t,n)}},KXSk:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return c}));var r=n("jq7Z"),a=n("SDQ8"),i=n("zmL5");function o(e,t,n){return null!=Object(r.a)(e,Object(a.c)(t,n))}function s(e,t){var n;if(null===(n=e.pages)||void 0===n?void 0:n[t])return t;const r=Object.keys(e.pages);for(const n of r){const r=Object(i.c)(e,n);if(null==r?void 0:r.some(e=>e===t))return n}return t}function c(e){return null==e?void 0:e.includes(a.a)}},KdpX:function(e,t,n){"use strict";n.d(t,"c",(function(){return v})),n.d(t,"d",(function(){return C})),n.d(t,"a",(function(){return S})),n.d(t,"b",(function(){return O}));var r=n("SAYH"),a=n("Uv1Y"),i=n("OtHk"),o=n("pnQK"),s=n("eXjw"),c=n("g0tL"),l=n("IqkD"),u=n("K7RF"),d=n("ueZM"),p=n("pEXn"),f=n("YxC/"),g=n("MQTY"),h=n("/oKV"),m=n("iJGp"),b=n("Lyxw"),y=n("3/02"),_=n("3c7c");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const v="dashboard.retrieve",S="system",O="user";function C(e,t,n,c,p,b=!1,y){return{type:"dashboard.retrieve.async",execute({dispatch:_,getState:O},C){let w=h.a.LocalAndRemote;const A=O(),R=t,D=c,x=n&&n.length>0;if(p){const e=Object(l.x)(A),a=e&&e.defaultDashboardId;if(!r.a.isNullOrEmpty(a)){const e=Object(i.b)(A,a);if(!e||r.a.isNullOrEmpty(e.FormId)||r.a.equals(a,e.FormId)){t=a;const e=Object(o.a)(A,t,n);c=N(e)}}}const M=Object(i.d)(A,t,e,n);let F;if(M===s.a.Initialized){const r=Object(i.b)(A,t,e,n),a=()=>Object(o.a)(A,t,n),s=c===S;if(b)w=h.a.Remote;else{switch(Object(u.d)(A,s,r,a)){case 1:w=h.a.Remote;break;case 2:x||(F=_(T(n,w)))}}}if(M!==s.a.Initialized||w!==h.a.LocalAndRemote){_(function(e,t,n){const r={};""!==e&&null!=e?r.dashboardsByNavPath={[e]:{Initialized:s.a.Initializing}}:t?r.dashboards={[t.guid]:{Initialized:s.a.Initializing}}:n&&n.length>0&&(r.dashboardsByEntityName={[n]:{Initialized:s.a.Initializing}});return{type:v,payload:r}}(e,t,n));let o=m.a.OnDemandWithContext;if(w!==h.a.Remote){const e=x?Object(i.g)(A,n):Object(i.c)(A);if(e&&Object.keys(e).length>0&&e[t&&t.guid]){if(!b)if(x){const e=Object(f.e)(A,[g.SYSTEM_DASHBOARD_LABEL_ID]);if(e){Object(f.c)(e,g.SYSTEM_DASHBOARD_LABEL_ID)&&(o=m.a.OnDemandWithoutContext)}}else o=m.a.OnDemandWithoutContext;const n=e[t&&t.guid];c=N(n)}}const l=_(P(o,w,e,y,t,n,c,p));return E(C,e,c,p,t,n,l,a=>{const i=I(a);if(!i||p&&t&&!r.a.equals(i.FormId,t)){if(p&&t&&!r.a.equals(t,R)){const t=_(P(o,w,e,y,R,n,D,void 0));return E(C,e,D,!1,R,n,t,t=>{const r=I(t);return r?r.FormId:_(j(F,o,w,e,n,y))})}return _(j(F,o,w,e,n,y))}return t&&r.a.equals(i.FormId,t)||(t=i.FormId),t}).then(e=>e?_(Object(d.a)(e)).then(()=>e,a.b):e)}return Promise.resolve(Object(i.b)(A,t,e,n).FormId)},getFailureParameters:()=>w(e,c,p,t,n)}}function E(e,t,n,r,a,i,o,s){let c=!1;return o.then(e=>(c=!0,s(e))).catch(o=>{const l=o&&-2147093999===o.errorCode;if(c||!l)throw o;return e.TraceManager.getTracer(v).warn(o&&o.message,w(t,n,r,a,i)),s(null)})}function I(e){const t=e&&e.dashboards&&Object.keys(e.dashboards);return t&&t.length>0&&e.dashboards[t[0]]}function w(e,t,n,a,i){return[{name:p.b.DashboardNavPath,value:e},{name:p.b.DashboardType,value:t},{name:p.b.ShowDefaultDashboard,value:n},{name:p.b.DashboardId,value:r.a.toString(a)},{name:p.b.EntityName,value:i}]}function j(e,t,n,r,a,o){return{type:"dashboardFallback.retrieve.async",execute:({dispatch:s,getState:c},l)=>{let d;if(!e){const t=c();let r=!0;const o=a?Object(i.g)(t,a):Object(i.c)(t),l=o&&Object.keys(o);if(l&&l.length>0){const e=o[l[0]];r=Object(u.e)(t,e.OverallVersionNumber)}r?e=s(T(a,n)):d=Promise.resolve(o)}return e&&(d=e.then(e=>e&&(a?e.dashboardSelectorsByEntityName&&e.dashboardSelectorsByEntityName[a]:e.dashboardSelectors))),E(l,r,S,!1,null,a,d,e=>{if(e){let c=[];for(const t in e){const n=e[t];N(n)!==S||Object(i.i)(n.Id)||c.push(n)}c=c.sort((e,t)=>e.DisplayName>t.DisplayName?1:e.DisplayName<t.DisplayName?-1:0);const u=()=>{if(0===c.length)return null;const e=c.shift(),i=s(P(t,n,r,o,e.Id,a,S,void 0));return E(l,r,S,!1,e.Id,a,i,e=>{const t=I(e);return t?t.FormId:u()})};return u()}return null})}}}function P(e,t,n,i,o,s,l,d){return{type:"dashboard.retrieve.async",execute({dispatch:d,getState:p},f){const g=r.a.isNullOrEmpty(o),h=r.a.toLegacyGuid(o);let m="workspace";s||l===S?m="systemworkspace":l===O&&(m="userworkspace");const v=n=>d(Object(u.b)(m,null,s,h,g,e,null,null,n,c.b.Dashboard,t,void 0,void 0,i));return(!s&&Object(b.f)(p(),y.Jc)&&Object(b.f)(p(),y.mb)?(()=>{const e=Object(_.b)(p()).map(e=>v(e));return Promise.all(e).then(e=>e[0])})():v(n?[n]:[])).catch(a.b)},getFailureParameters:()=>w(n,l,d,o,s)}}function T(e,t){return Object(u.b)("dashboardselector",null,e,null,!0,m.a.OnDemandWithContext,null,null,[],null,t)}function N(e){switch(e&&+e.Type){case 1032:case 1030:case 1035:return S;case 1031:case 1034:return O}}},KeJu:function(e,t,n){"use strict";n.d(t,"b",(function(){return T})),n.d(t,"a",(function(){return N})),n.d(t,"d",(function(){return A})),n.d(t,"e",(function(){return R})),n.d(t,"f",(function(){return D})),n.d(t,"c",(function(){return x})),n.d(t,"g",(function(){return M}));var r=n("Uv1Y"),a=n("SAYH"),i=n("eXjw"),o=n("E5IU"),s=n("smSa"),c=n("SRlt"),l=n("pEXn"),u=n("rCFy"),d=n("17x/"),p=n("aRLb"),f=n("3ZcW"),g=n("UKgB"),h=n("K7RF"),m=n("g0tL"),b=n("GYEz"),y=n("504W"),_=n("4r2D"),v=n("iJGp"),S=n("/oKV"),O=n("0rLi"),C=n("dH1a"),E=n("Lyxw"),I=n("3/02"),w=n("wyQO"),j=n("XOSd"),P=n("x/aW");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const T="app.retrieve",N="app.timestamps.retrieve";function A(e,t){return{type:"app.retrieve.async",execute({dispatch:n,getState:s},c){const l=s(),u=Object(o.e)(l);return Object(o.k)(l)===a.a.toString(e)&&u.initialized===i.a.Initialized?(t&&Object(j.b)(s()),Promise.resolve(Object(o.e)(l))):n(function(e,t){return{type:"app.descriptor.async",execute({dispatch:n,getState:o},s){var c;const l=null===(c=s.TraceManager)||void 0===c?void 0:c.getTracer("retrieveAppContext");let u=!0;a.a.isNullOrEmpty(e)||(u=!1,n(function(e){const t={appContext:{initialized:i.a.Initializing,app:{appId:e?e.guid:null,appUrl:null,id:null,description:null,LastModifiedOn:null,status:null,title:null,uniqueName:null,clientType:null,navigationType:0,isFeatured:null,solutionId:null,versionNumber:null,components:null,appComponents:null,appSettings:null}}};return{type:T,payload:t}}(e)));const d=F(e,u,t,S.a.Local);return new Promise((r,a)=>{let i=null;Object(w.f)(o())&&Object(E.f)(o(),I.oe)&&(i=window.setTimeout(()=>{n(d).then(e=>{null!=e&&(null==l||l.warn(`Remote app context call taking more then ${w.b} seconds, continue with local store cached value`),r(e))})},w.b)),n(F(e,u,t,S.a.Remote)).then(e=>{r(e)}).catch(e=>{a(e)}).finally(()=>{Object(w.d)(o(),i,!0)})}).catch(e=>{if(e=Object(r.c)(e),Object(C.a)(e.getNegativeErrorCode()))return n(d).then(t=>{if(t&&t.appContext)return t;throw e},r.b);throw e})}}}(e,v.a.OnDemandWithoutContext)).then(e=>e.appContext)}}}function R(e){const t=[];return{type:"app.retrieve.async",execute({dispatch:n,getState:i},o){const s=S.a.Remote,c=o.DataSource,u=new _.a(a.a.newGuid().guid);return t.push({name:l.b.ClientRequestId,value:u&&u.RequestId?u.RequestId():null}),c.getClientMetadata(new O.a("appmodules",null,"appmodules",null,[],!0,v.a.Offline,null,[],null),s,u,e).nativePromise().then(e=>e&&e.AppModules?e.AppModules:[],r.b)},getFailureParameters:(e,n)=>t}}function D(e){const t=[];return{type:"app.retrieve.async",execute({dispatch:n,getState:r},i){const o=S.a.Local,s=i.DataSource,c=new _.a(a.a.newGuid().guid);return t.push({name:l.b.ClientRequestId,value:c&&c.RequestId?c.RequestId():null}),s.getClientMetadata(new O.a("appmoduleofflinemetadata",null,null,null,[],!0,v.a.Offline,null,[],null),o,c,e).nativePromise().then(e=>e&&e.AppModules?e.AppModules:[],e=>{})},getFailureParameters:(e,n)=>t}}function x(e){return{type:"app.timestamps.retrieve.async",execute({dispatch:t,getState:n},r){const i=[],h=r.TraceManager.getTracer(c.c.TRACER_CATEGORY_ID),m=new g.a;m.ClientMetadataQuery=new f.a,m.ClientMetadataQuery.MetadataType="appmodules",m.ClientMetadataQuery.MetadataSubtype="modifiedon",m.ClientMetadataQuery.EntityLogicalName="appmodules",m.ClientMetadataQuery.GetDefault=!0,m.ClientMetadataQuery.DependencyDepth=v.a.Offline,m.ClientMetadataQuery.MetadataNames=[],Object(d.l)(n())&&m.ClientMetadataQuery.MetadataNames.push(Object(o.k)(n()));const _=Object(b.c)(n());return Object(y.b)(_)?i.push({name:l.b.IsEmptyInstallationId,value:!0}):m.ClientMetadataQuery.MetadataNames.push(_),t(Object(p.b)(m,e)).then(e=>e.json()).then(e=>JSON.parse(e.Metadata)).then(e=>{const r=!(e&&e.AppModuleModifiedOn&&e.AppModuleModifiedOn.length>0);let o=null,c=!1,d=!1,p=!1,f=[];if(!r&&null!=e.AppModuleModifiedOn[0]&&(f=e.AppModuleModifiedOn[0].UnprocessedAppModuleIds,p=Object(y.a)(e.AppModuleModifiedOn[0].AppModuleToLastModifiedTimeMap)||0===Object.keys(e.AppModuleModifiedOn[0].AppModuleToLastModifiedTimeMap).length,d=e.AppModuleModifiedOn[0].UpdateInProgress,!d&&!p)){o=e.AppModuleModifiedOn[0].AppModuleToLastModifiedTimeMap;const t=n();for(const e in o)if(Object(s.a)(t,new a.a(e))<o[e]){c=!0;break}}if(e&&e.OfflineSubscriptionDetails&&e.OfflineSubscriptionDetails.length){const n=e.OfflineSubscriptionDetails[0],r=n.SubscriptionId;t(Object(u.b)("",n.SubscriptionErrorMessage)),Object(y.b)(r)&&(i.push({name:l.b.IsEmptySubscriptionId,value:!0}),i.push({name:l.b.SubscriptionErrorMessage,value:n.SubscriptionErrorMessage}))}return i.push({name:l.b.IsEmptyPayload,value:r}),i.push({name:l.b.UpdateInProgress,value:d}),i.push({name:l.b.IsAppModuleToLastModifiedTimeMapEmpty,value:p}),i.push({name:l.b.HaveTimestampsChanged,value:c}),i.push({name:l.b.UnprocessedAppModuleIds,value:f}),h.warn("getUpdatedAppModuleTimestamps response details",i),c?o:null})}}}function M(e){const t={offlineSync:{initialized:i.a.Initialized,appModuleTimestamps:e}};return{type:N,payload:t}}function F(e,t,n,r){return Object(h.b)(P.a.AppModules,null,P.a.AppModules,a.a.toLegacyGuid(e),t,n,null,null,[P.a.AppModules],m.b.Other,r)}},Keau:function(e,t,n){"use strict";n.r(t);var r=/[A-Z]/g,a=/^ms-/,i={};function o(e){return"-"+e.toLowerCase()}t.default=function(e){if(i.hasOwnProperty(e))return i[e];var t=e.replace(r,o);return i[e]=a.test(t)?"-"+t:t}},Kj0E:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPeakMemoryCollectionIntervalInMs=t.collectMemory=t.setMemoryCollector=void 0;var r=function(){return Promise.resolve(-1)},a=3e3;t.setMemoryCollector=function(e,t){r=e,t&&(a=t)},t.collectMemory=function(e){return r(e)},t.getPeakMemoryCollectionIntervalInMs=function(){return a}},Knfm:function(e,t,n){"use strict";n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return p}));var r=n("GEbX"),a=n("E5IU");var i=n("hAdb"),o=n("GYEz"),s=n("w1eR"),c=n("H4dV"),l=n("Lyxw"),u=n("3/02");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function d(e){const t=c.a.getInstance();return Object(o.a)(e)===s.a.Browser&&!t.get_IsBrowserIE()&&!t.get_IsMobilePhone()}function p(e){const t=function(e){if(e)switch(e.toLowerCase()){case r.a[r.a.MultiSession].toLowerCase():return r.a.MultiSession;case r.a[r.a.SingleSession].toLowerCase():return r.a.SingleSession;default:return}}(Object(i.c)(e,"navigationType"));if(void 0!==t)return t;if(!d(e))return r.a.SingleSession;if(Object(l.f)(e,u.Bc)&&"true"===new URLSearchParams(window.location.search).get("newWindow"))return r.a.SingleSession;const n=Object(a.m)(e);return null!=n?n:r.a.SingleSession}},Kxpb:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return s}));var r=n("3UxG");const a=(e,t)=>`${e}.${t}`,i={collapsedGroupState:{}};function o(e){return void 0!==e.collapsedGroupState}function s(e=i,t){switch(t.type){case r.b:if(!o(t.payload)){const{areaId:n,groupId:r,isExpanded:i}=t.payload,o=a(n,r),s=Object.assign(Object.assign({},e.collapsedGroupState),{[o]:i});return Object.freeze(Object.assign(Object.assign({},e),{collapsedGroupState:s}))}case r.a:if(o(t.payload)){const n=Object.assign(Object.assign({},t.payload.collapsedGroupState),e.collapsedGroupState);return Object.freeze(Object.assign(Object.assign({},e),{collapsedGroupState:n}))}}return e}},L4PC:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n("dHD5"),a=n("BFlg");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i="dataset.update.pagenumber";function o(e,t,n){return{type:"dataset.update.pagenumber.async",execute({dispatch:o,getState:s},c){const l=c.TraceManager.getTracer(a.P),u=a.N+".updatePageNumberAction";try{l.info("Updating the page number for the grid."),o(function(e,t,n){const a=Object(r.z)(t),o=Object(r.w)(t);return{type:i,payload:n,meta:{pageId:e,contextKey:a,dataSetContextKey:o}}}(e,t,n));const a=[];return a.push({name:"pageNumber",value:n}),c.EventManager.ReportComponentSuccess(u,a),Promise.resolve()}catch(e){const t="Updation of page number for the grid failed with error : "+e.message;c.EventManager.ReportComponentFailure(u,Error(t))}}}}},L6aH:function(e,t,n){"use strict";var r,a;n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.UserLocal=1]="UserLocal",e[e.DateOnly=2]="DateOnly",e[e.TimeZoneIndependent=3]="TimeZoneIndependent"}(r||(r={})),function(e){e[e.attribute=0]="attribute",e[e.organization=1]="organization",e[e.currency=2]="currency"}(a||(a={}))},LAGg:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return c}));var r=n("dHD5"),a=n("L4PC"),i=n("BFlg");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const o="update.grid.refresh.counter";function s(e,t){return{type:"update.grid.refresh.counter.async",execute({dispatch:n,getState:o},s){const l=s.TraceManager.getTracer(i.P),u=i.N+".updateGridRefreshCounterAction";try{const i=Object(r.v)(t);return n(c(e,i)),n(Object(a.b)(e,t,1)),l.info("Updating the grid refresh counter"),s.EventManager.ReportComponentSuccess(u),Promise.resolve()}catch(e){const t="Updating the grid refresh counter failed with error : "+e.message;s.EventManager.ReportComponentFailure(u,Error(t))}}}}function c(e,t){return{type:o,payload:Math.floor(1e3*Math.random()),meta:{pageId:e,dataSetContextKey:t}}}},LE5i:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r={Metadata:"metadata",Data:"data",WhatsChanged:"whatschanged",Filters:"filters",InitiateRefresh:"initiaterefresh",MoreEmails:"moreemails",ContextualDialogEntity:"contextualdialogentity"}},LFDu:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n("84PK");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class a{constructor(e){this._columnNames=null,this._columnTypeMap=null,this._columnTypeMap=e,this._columnNames=Object.keys(this._columnTypeMap)}get_columnNameTypeMap(){return this._columnTypeMap}get_columnNames(){return this._columnNames}}var i=n("504W"),o=n("/A0C"),s=n("nTyX");let c=null;class l{initialize(){c={},c[o.a.AliasedValue]=new a({attributelogicalname:String,entitylogicalname:String,attributetype:s.a}),c[o.a.Customer]=new a({id:r.a,logicalname:String,name:String}),c[o.a.Lookup]=new a({id:r.a,logicalname:String,name:String}),c[o.a.Owner]=new a({id:r.a,logicalname:String,name:String}),c[o.a.Status]=new a({"":String}),c[o.a.State]=new a({"":String}),c[o.a.Boolean]=new a({"":String}),c[o.a.PickList]=new a({"":String}),c[o.a.DateTime]=new a({"":Number}),c[o.a.String]=new a({"":String}),c[o.a.UniqueIdentifier]=new a({"":r.a}),c[o.a.Decimal]=new a({"":String}),c[o.a.Double]=new a({"":String}),c[o.a.Integer]=new a({"":String}),c[o.a.Memo]=new a({"":String}),c[o.a.Money]=new a({"":String}),c[o.a.Unknown]=new a({"":String}),c[o.a.PartyList]=new a({"":String}),c[o.a.CalendarRules]=new a({"":String}),c[o.a.Virtual]=new a({"":String}),c[o.a.BigInt]=new a({"":String}),c[o.a.ManagedProperty]=new a({"":String}),c[o.a.EntityName]=new a({"":String})}getAttributeMap(e){return!Object(i.b)(e)&&e in c?c[e]:null}getAttributeColumnNames(e){return!Object(i.b)(e)&&e in c?c[e].get_columnNames():null}getAttributeType(e,t){return c&&e in c?c[e].get_columnNameTypeMap()[t]:null}isComplexAttribute(e){switch(e){case o.a.AliasedValue:case o.a.Customer:case o.a.Lookup:case o.a.Owner:return!0;default:return!1}}}},LJro:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));const r="page.update.syncerrorstatus";function a(e,t){return{type:r,payload:{__isSyncErrorStatusUpdated:t},meta:{pageId:e}}}},LMh4:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="appprogressindicator.update";function a(e){return{type:r,payload:{inProgress:!!e,progressMessage:e||null}}}},LOik:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e){return e.metadata.appModulesList.appList}function a(e){const t=r(e);return null==t?void 0:t.find(e=>-1===e.clientType)}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}))},LTmj:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("3ri3");class a{constructor(e,t,n,r){this._Id=null,this._Name=null,this._Status=0,this._ActionData=null,this._CreatedOn=null,this._set_id(e),this.set_name(t),this.set_status(n),this.set_actionData(r),this.set_createdOn(new Date)}_get_id(){return this._Id}_set_id(e){return this._Id=e,e}get_name(){return this._Name}set_name(e){return this._Name=e,e}get_status(){return this._Status}set_status(e){return this._Status=e,e}get_actionData(){return this._ActionData}set_actionData(e){return this._ActionData=e,e}get_createdOn(){return this._CreatedOn}set_createdOn(e){return this._CreatedOn=e,e}toDictionary(){const e={};return e[r.f]=this._get_id(),e[r.g]=this.get_name(),e[r.m]=this.get_status(),e[r.d]=this.get_actionData(),e[r.e]=this.get_createdOn(),e}}},LTq1:function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"e",(function(){return s}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="Form_ReadOnly_Status",a="Form_ReadOnly_Permissions_Entity",i="Form_ReadOnly_Permissions_Record",o="Form_ReadOnly_Offline",s=[r,a,i,o,"Dialog_Label_Active","Dialog_Label_Inactive"]},LbAn:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return u}));var r,a,i,o=n("mMyr"),s=n("kXuq"),c=n("laoc"),l=(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});!function(e){e[e.Default=0]="Default",e[e.Small=1]="Small",e[e.Medium=2]="Medium",e[e.Large=3]="Large"}(a||(a={})),function(e){e[e.None=0]="None",e[e.Lookup=1]="Lookup",e[e.Grid=2]="Grid"}(i||(i={}));var u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._renderPresence=!1,t}return l(t,e),t.prototype._addPresenceInformation=function(){var e=this.props.displaySize?this.props.displaySize:a.Default,t=this.props.presenceTarget?this.props.presenceTarget:i.None;this._presenceInstance=new this._skypeChannelContext.SkypeChannelClient.Presence(this._presenceId,this.props.sipUrl,this.props.entityReference,e,this.props.parentControlId,this.props.accessibilityLabel,t),this._presenceInstance.buildPresence()},t.prototype.componentDidMount=function(){this._renderPresence&&this._addPresenceInformation()},t.prototype.componentWillUnmount=function(){this._presenceInstance&&(this._presenceInstance.close(),this._presenceInstance=null)},t.prototype._isSkypeChannelAvailable=function(){return this._skypeChannelContext=this.context?this.context.SkypeChannel:void 0,void 0!==this._skypeChannelContext},t.prototype._isPropsAvailable=function(){return!!this.props.sipUrl||this.props.entityReference&&this._skypeChannelContext.SkypeChannelClient.PresenceInformation&&this._skypeChannelContext.SkypeChannelClient.PresenceInformation.isPresenceEnabledEntity(this.props.entityReference.entityName)},t.prototype.render=function(){return this._presenceId=this.props.id?this.props.id:this.props.parentControlId+"_presence",this._renderPresence=this._isSkypeChannelAvailable()&&this._isPropsAvailable(),this._renderPresence?o.createElement(s.a,{id:this._presenceId,style:this.props.style}):null},t.displayName="PresenceIndicator",t}(o.Component);u.contextType=c.a},LbMF:function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"l",(function(){return c})),n.d(t,"a",(function(){return l})),n.d(t,"g",(function(){return o})),n.d(t,"c",(function(){return u})),n.d(t,"k",(function(){return s})),n.d(t,"h",(function(){return p})),n.d(t,"e",(function(){return f})),n.d(t,"f",(function(){return g})),n.d(t,"i",(function(){return h})),n.d(t,"j",(function(){return m})),n.d(t,"m",(function(){return y})),n.d(t,"b",(function(){return d}));var r=n("/A0C"),a=n("iZ7K");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function i(e,t){return e&&e.metadata&&e.metadata.attributes?e.metadata.attributes[t]:null}function o(e,t,n){if(!n||!n.length)return[];const r=i(e,t);if(!r)return n;const a=[];for(let e=0;e<n.length;e++)r[n[e]]||a.push(n[e]);return a}function s(e,t,n){const r=i(e,t);if(!r)return null;if(0===n.length)return r;const a={};return n.forEach(e=>{r.hasOwnProperty(e)&&(a[e]=r[e])}),a}function c(e,t){return i(e,t)}function l(e,t,n){const r=i(e,t);return r&&r.hasOwnProperty(n)?r[n]:null}function u(e,t,n){const r={},a=i(n,t);return a&&(e&&e.length?e.forEach(e=>{a[e]&&(r[e]=a[e].Type)}):Object.keys(a).forEach(e=>{r[e]=a[e].Type})),r}function d(e,t,n){const r=i(n,t);return r&&r[e]?r[e].Type:null}function p(e,t){const n=Object(a.h)(e,t);return n?n.PrimaryNameAttribute:null}function f(e,t,n){if(!n||0===n.length)return null;const a=s(e,t,n);if(!a)return null;const i={};for(const e in a){const t=a[e];t.Type!==r.a.PickList&&t.Type!==r.a.MultiSelectPickList||!(t.ParentPicklistLogicalName||t.ChildPicklistLogicalNames&&t.ChildPicklistLogicalNames.length>0)||(i[e]=t)}return i}function g(e,t,n){const r={};if(e.metadata&&e.metadata.attributes){const a=e.metadata.attributes[t];for(const e in a)a[e].Type===n&&(r[e]=a[e])}return r}function h(e,t,n){if(n){return b(Object(a.y)(e,t.entityLogicalName,n))}return null}function m(e,t,n){if(t){return b(Object(a.F)(n,e,t)||Object(a.x)(n,e,t))}return null}function b(e){if(e){return e.ReferencingAttribute}return null}function y(e,t,n){const r=l(e,t,n);return!(!r||!(r.ParentPicklistLogicalName||r.ChildPicklistLogicalNames&&r.ChildPicklistLogicalNames.length>0))}},Lc3p:function(e,t,n){"use strict";n.d(t,"a",(function(){return S})),n.d(t,"b",(function(){return O}));var r=n("ZuxC"),a=n("5w+f"),i=n("gQ5I"),o=n("Tz6o"),s=n("2YQW"),c=n("LJro"),l=n("ZFRl"),u=n("lza4");var d=n("BfRu"),p=n("JVKK");const f=Object(s.d)({[d.a]:function(e,t){const n=Object.assign(Object.assign({},e),{[t.payload.UniqueId]:t.payload});return Object.freeze(n)},[p.a]:function(e,t){const n=Object.assign({},e);return delete n[t.payload.UniqueId],Object.freeze(n)}},{});var g=n("NvqY"),h=n("VgPQ"),m=n("fHQ8"),b=n("3eJf"),y=n("VMrH"),_=n("1OTd"),v=n("nZiF");function S(e){return(t={},n)=>{if(n.type===g.b&&n.payload.pageState)return n.payload.pageState;if(n.meta&&n.meta.pageId){const r=n.meta.pageId,a=e[r];if(a){const e=t[r],i=function(e,t,n){const r=n.getRootReducer()(e,t);void 0===e&&(e={});const a=O(e,t),i=Object.assign(Object.assign({},r),a);if(Object(s.e)(e,i))return e;return Object.freeze(i)}(e,n,a);if(e!==i)return Object.freeze(Object.assign(Object.assign({},t),{[r]:i}))}if(n.type===i.c||n.type===i.b){const e={},n=Object.keys(t);for(const a of n)a!==r&&(e[a]=t[a]);return Object.freeze(e)}}return t}}function O(e,t){const n=function(e={},t){if(t.type===r.b||t.type===a.a||t.type===o.b)return Object.freeze(Object.assign({},t.payload.input));return e}(e.input,t),s=function(e,t){if(t.type===i.a)return Object.freeze(Object.assign({},t.payload.__output));return e}(e.__output,t),u=function(e,t){if(t.type===r.b||t.type===a.a)return t.payload.__pageName;return e}(e.__pageName,t),d=function(e,t){if(t.type===l.a)return t.payload.__pageTitle;return e}(e.__pageTitle,t);return{input:n,__output:s,__pageName:u,dialogOptions:function(e,t){if(t.type===a.a)return Object.freeze(Object.assign({},t.payload.dialogOptions));return e}(e.dialogOptions,t),isDialogStatus:function(e=!1,t){if(t.type===r.b||t.type===a.a)return t.payload.isDialogStatus;return e}(e.isDialogStatus,t),__isSyncErrorStatusUpdated:function(e=!1,t){if(t.type===c.a)return t.payload.__isSyncErrorStatusUpdated;return e}(e.__isSyncErrorStatusUpdated,t),__pageTitle:d,__hiddenCommandManagerIds:function(e,t){if(!("initialize.customControl.command"!==t.type||e&&e[t.payload.contextKey]&&e[t.payload.contextKey][t.payload.controlId]&&-1!==e[t.payload.contextKey][t.payload.controlId].indexOf(t.payload.commandManagerId))){const n=[];e&&e[t.payload.contextKey]&&e[t.payload.contextKey][t.payload.controlId]&&n.push(...e[t.payload.contextKey][t.payload.controlId]),n.push({commandManagerId:t.payload.commandManagerId,ribbonId:t.payload.ribbonId});const r={[t.payload.controlId]:n},a=Object.assign({},e);return a[t.payload.contextKey]=a[t.payload.contextKey]||{},Object.assign(a[t.payload.contextKey],r),Object.freeze(a)}return e}(e.__hiddenCommandManagerIds,t),__pendingCommandManagerIds:function(e,t){if(!("pending.customControl.command"!==t.type||e&&e[t.payload.contextKey]&&e[t.payload.contextKey][t.payload.controlId]&&-1!==e[t.payload.contextKey][t.payload.controlId].indexOf(t.payload.commandManagerId))){const n=[];e&&e[t.payload.contextKey]&&e[t.payload.contextKey][t.payload.controlId]&&n.push(...e[t.payload.contextKey][t.payload.controlId]),n.push(t.payload.commandManagerId);const r={[t.payload.controlId]:n},a=Object.assign({},e);return a[t.payload.contextKey]=a[t.payload.contextKey]||{},Object.assign(a[t.payload.contextKey],r),Object.freeze(a)}return e}(e.__pendingCommandManagerIds,t),commandXrmCache:C(e.commandXrmCache,t),pageViewConfigurations:function(e,t){"update.views.configuration"===t.type&&(e||(e={}),e=Object.assign(Object.assign({},e),t.payload));return e}(e.pageViewConfigurations,t),gridConfigurations:function(e,t){if("update.grid.configuration"!==t.type)return e;const n=t.payload;if(!n)return e;const r=Object.assign({},e);for(const e in n)r.hasOwnProperty(e)?Object.assign(r[e],n[e]):r[e]=n[e];return Object.freeze(r)}(e.gridConfigurations,t),__lookupKeys:function(e,t){if("update.lookupRequestDataKey"!==t.type)return e;let n,r;if(t&&t.payload){let a=Object.assign({},e);for(const i in t.payload){r=e&&e[i]?Object.assign({},e[i]):{};for(const a in t.payload[i]){if(e&&e[i]&&e[i][a]){const r=Object.assign(Object.assign({},e[i][a].dataKeys),t.payload[i][a].dataKeys);n=Object.assign(Object.assign(Object.assign({},e[i][a]),t.payload[i][a]),{dataKeys:r})}else n=t.payload[i][a];r[a]=n}a=Object.assign(a,{[i]:r})}return Object.freeze(a)}return e}(e.__lookupKeys,t),pageNotifications:f(e.pageNotifications,t),isPageUnmounted:function(e=!1,t){if(t.type===h.a)return t.payload.isPageUnmounted;return e}(e.isPageUnmounted,t),alwaysRender:function(e=!1,t){if(t.type===v.a)return t.payload;return e}(e.alwaysRender,t),metadataInputs:function(e=[],t){if(t.type===m.a)return[...e,t.payload.metadataInput];return e}(e.metadataInputs,t),dataInputs:function(e=[],t){if(t.type===y.a)return[...e,t.payload.dataInput];return e}(e.dataInputs,t),controlPersonalizations:Object(b.b)(e.controlPersonalizations,t),dialogContextOutputs:function(e,t){if(t.type===_.u){const{dialogContextId:n,output:r,pageType:a}=t.payload,i=e?Object.assign({},e):{};return i[n]||(i[n]=[]),Object.freeze(Object.assign(Object.assign({},i),{[n]:[...i[n],{pageType:a,output:r}]}))}return e}(e.dialogContextOutputs,t)}}const C=Object(s.b)("contextKey",(function(e,t){switch(t.type){case u.a:return t.payload;default:return e}}))},Lgxb:function(e,t,n){"use strict";var r=Object.prototype.hasOwnProperty;function a(e,t){return e===t?0!==e||0!==t||1/e==1/t:e!=e&&t!=t}function i(e,t){if(a(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(var o=0;o<n.length;o++)if(!r.call(t,n[o])||!a(e[n[o]],t[n[o]]))return!1;return!0}e.exports=function(e,t,n){return!i(e.props,t)||!i(e.state,n)}},Lohl:function(e,t,n){"use strict";n.d(t,"a",(function(){return E})),n.d(t,"b",(function(){return I})),n.d(t,"d",(function(){return P})),n.d(t,"c",(function(){return w}));var r=n("g0tL"),a=n("SAYH"),i=n("eXjw"),o=n("K7RF"),s=n("Uv1Y"),c=n("y60j"),l=n("lEFU"),u=n("ueZM"),d=n("pEXn"),p=n("TBkx"),f=n("69Qu"),g=n("iZ7K"),h=n("/oKV"),m=n("Lyxw"),b=n("3c7c"),y=n("3/02"),_=n("wL2W"),v=n("+Qpx"),S=n("iJGp");function O(e,t,n,i,l,u=[]){return{type:I,execute({dispatch:d,getState:p},f){const g=p(),m=Object(c.l)(g,t,i);let b=S.a.OnDemandWithoutContext;return m&&0!==Object.keys(m).length&&l!==h.a.Remote||(b=S.a.OnDemandWithContext),d(Object(o.b)(E,i,t,a.a.toLegacyGuid(e),a.a.isNullOrEmpty(e),b,null,null,u,r.b.Form,l,null,null,null,C(g,n))).catch(s.b)}}}function C(e,t){return!0===t&&Object(m.f)(e,y.Fc)}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const E="form",I="form.retrieve.async",w=new a.a("cad522ac-4af0-4825-befe-417de833ded7");let j=!0;function P(e,t,d,p=!0,v){return{type:I,async execute({dispatch:S,getState:E},I){let A=h.a.LocalAndRemote;const R=E(),D=e.etn;let x=t;const M=d||r.a,F=M===r.a,k=I.TraceManager.getTracer("RetrieveForm");if(!D)throw s.a.fromErrorCode(R,-2147098612,String(D));const L=Object(_.a)();let B=null;L&&(B=await n.e(71).then(n.bind(null,"xmOX")));const U=[];L&&F&&U.push((null==B?void 0:B.A28)+(a.a.isNullOrEmpty(t)?"form id not provided.":`the form id ${a.a.toString(t)} ${null==B?void 0:B.A29}`));let V=Object(c.m)(R,x);k.warn(`RetrieveForm called: for entity: '${D}', initial form id: '${a.a.toString(x)}', form state: '${V}, retrieval strategy: '${A}'`);const z=L&&String.format(null==B?void 0:B.A30,D);if(F)if(a.a.isNullOrEmpty(x)&&Object(f.c)(R))x=Object(l.b)(R,D),k.warn(`RetrieveForm called on edit form type, updated form id to selected form: '${a.a.toString(x)}'`),L&&U.push(`${z}. Result: ${a.a.isNullOrEmpty(x)?"not found":"form id is "+a.a.toString(x)}.`);else{const e="Did not retrieve user's personalization form as either the server is not available or a specific form is being retrieved";k.warn(e),L&&U.push(`${z} ${null==B?void 0:B.A31}`)}const q=L&&(null==B?void 0:B.A32);if(a.a.isNullOrEmpty(x)){if(Object(c.g)(R,D,M)===i.a.Error)return k.warn("Current form id is null or empty and form state is error, resolve with empty guid"),a.a.EMPTY;x=Object(c.f)(R,D,M),k.warn(`Updated form id is null or empty, getting the default form id: '${a.a.toString(x)}'`),L&&U.push(`${q}. Result: ${a.a.isNullOrEmpty(x)?"not found":a.a.toString(x)}.`)}else L&&U.push(q+" (skipped).");if(V=Object(c.m)(R,x),V===i.a.Initialized&&Object(o.e)(R,Object(c.h)(R,x).OverallVersionNumber)&&(A=h.a.Remote,k.warn("Form state initialized and metadata version changed, set retrieval strategy to remote")),V!==i.a.Initialized&&V!==i.a.Error||A!==h.a.LocalAndRemote){S(function(e){const t={forms:e?{[a.a.toString(e)]:{initialized:i.a.Initializing}}:null};return{type:o.a,payload:t}}(x));const n=()=>S(O(x,D,j,M,A)),l=()=>{const e=Object(b.b)(R,p).map(e=>S(O(x,D,j,M,A,e)));return Promise.all(e).then(e=>e[0])};return(M===r.a&&Object(f.c)(R)&&Object(m.f)(R,y.Jc)&&Object(m.f)(R,y.Gc)?l():n()).then(n=>{var r,l;const f=null==n?void 0:n.formSelectorFormCheckerInfo;L&&(null==f||f.push(null==B?void 0:B.A33));let g="";if(a.a.isNullOrEmpty(x))if(n&&n.formDefaults&&n.formDefaults[D])x=n.formDefaults[D][M].formId,g=`. Result: form id is ${a.a.toString(x)}.`;else{if(0===(null===(r=null==n?void 0:n.formDefaults)||void 0===r?void 0:r.length)&&0===(null===(l=null==n?void 0:n.formSelectors)||void 0===l?void 0:l.length))return w;x=a.a.EMPTY,S(function(e,t,n){const r={formDefaults:{[e]:{[t]:{formId:n,initialized:i.a.Error}}}};return{type:o.a,payload:r}}(D,d,x)),g=null==B?void 0:B.A36}else g=" (skipped).";L&&(null==U||U.push(String.format(null==B?void 0:B.A34,g)));const h=E(),m=x,b=!n||!n.forms||!n.forms.hasOwnProperty(a.a.toString(x));if(x=b?Object(c.f)(h,D,M):x,L&&b&&(null==U||U.push(String.format(null==B?void 0:B.A35,a.a.toString(m),a.a.toString(x)))),L&&(null==f||f.push({subSteps:U})),a.a.equals(m,x)||(k.warn(`Previous form id does not equal updated form id, previous form id: '${a.a.toString(m)}', updated form id: '${a.a.toString(x)}'`),S(function(e){const t={forms:e?{[a.a.toString(e)]:{initialized:i.a.Error}}:null};return{type:o.a,payload:t}}(m))),x&&x!==a.a.EMPTY){const e=Object(c.h)(h,x);return e&&!e.AreLabelsSubstituted?S(Object(u.a)(x,v)).then(()=>x).catch(e=>{L&&(null==f||f.push(e)),Object(s.b)(e)}).finally(()=>{L&&T(f,x,e,I,B)}):(e||k.warn(`Unable to get form descriptor from form id: '${a.a.toString(x)}'`),T(f,x,e,I,B),x)}if(C(R,j))return j=!1,k.warn("Form id not found with GCM server cache enabled, retrying with cache off",[{name:"etn",value:D}]),S(P(e,t,d,p,v));return N(Error("Default or required form id is not found"),I,D,x,M),x},e=>{throw N(e,I,D,x,M),e})}const H=Object(c.q)(R,x,D,M),W=Object(g.h)(R,D);if(H&&!H.AreLabelsSubstituted||W&&W.Initialized===i.a.Uninitialized)return S(Object(u.a)(H.Id,v)).then(()=>H.Id).catch(s.b);if(H)return H.Id;throw k.warn(`RetrieveForm called: form descriptor is null, for formid: '${a.a.toString(x)}'`),x}}}function T(e,t,n,r,i){var o,s;null==e||e.push(String.format(i.A37,n?"":" (form descriptor is not found)")),null==e||e.push({Id:a.a.toString(t),Name:null==n?void 0:n.Name}),null==e||e.push(null==i?void 0:i.A38),e&&(null===(s=null===(o=null==r?void 0:r.TraceManager)||void 0===o?void 0:o.getTracer(`${v.u}${v.w}`))||void 0===s||s.warn(v.B,[{name:d.l,value:v.w},{name:v.w,value:JSON.stringify(e)}]))}function N(e,t,n,r,i){if(t&&t.TraceManager&&t.EventManager){const o=t.TraceManager.getTracer("RetrieveForm"),s=Object(p.e)(e,o);!s.stack&&(s.stack="No stack available.");const c=[];c.push({name:"EntityLogicalName",value:n}),c.push({name:"FormType",value:i}),c.push({name:"FormID",value:r?a.a.toString(r):null}),t.EventManager.ReportComponentFailure("RetrieveForm",s,null,c)}}},LqfC:function(e,t,n){"use strict";n.d(t,"g",(function(){return r})),n.d(t,"f",(function(){return a})),n.d(t,"i",(function(){return i})),n.d(t,"j",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"d",(function(){return l})),n.d(t,"c",(function(){return u})),n.d(t,"v",(function(){return d})),n.d(t,"u",(function(){return p})),n.d(t,"s",(function(){return f})),n.d(t,"r",(function(){return g})),n.d(t,"h",(function(){return h})),n.d(t,"p",(function(){return m})),n.d(t,"n",(function(){return b})),n.d(t,"q",(function(){return y})),n.d(t,"w",(function(){return _})),n.d(t,"t",(function(){return v})),n.d(t,"o",(function(){return S})),n.d(t,"z",(function(){return O})),n.d(t,"e",(function(){return C})),n.d(t,"m",(function(){return E})),n.d(t,"k",(function(){return I})),n.d(t,"l",(function(){return w})),n.d(t,"A",(function(){return j})),n.d(t,"y",(function(){return P})),n.d(t,"x",(function(){return T}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="sidepanel.loadInternal",a="sidepanel.load",i="panel.setPanelOptions",o="panel.setPanelOptionsInternal",s="panel.closeSidePanel",c="panel.closeSidePanelInternal",l="panel.collapseAllSidePanels",u="panel.collapsePanels",d="23%",p=44,f=420,g=300,h="sidepanel.ready",m="SidePanel.Expand",b="SidePanel.Collapse",y="Side_Panel_Accessibility_Label",_="SidePanelWidth",v="SidePanelState",S="Side_Panel",O=340,C="panes.load",E="pane.set.selected",I="panes.set.state",w="pane.setPanelOptions",j=47,P="AppSidePanes",T="Side_Pane_Badge_Accessibility"},"Lr+c":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("SAYH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e){const t=[];return e.FormLibraries&&t.push(...e.FormLibraries),{UniqueId:e.UniqueId,CustomControls:i(e.CustomControls),FormLibraries:t,EventHandlers:e.EventHandlers,VersionNumber:e.VersionNumber,OverallVersionNumber:e.OverallVersionNumber,PrimaryEntityType:e.PrimaryEntityType}}function i(e){const t={};if(!e)return t;let n=0,a=-1;for(const i of e){if(null==i.FormFactor)continue;let e=i.FormFactor.toString();e||(e="unbound-"+n,n++);const s={};if(i.Parameters)for(const e of i.Parameters)s[e.Name]=e.Value;const c=s;for(const e in c)if(c[e].hasOwnProperty("Usage")){const t=c[e];t.Usage="number"==typeof t.Usage?t.Usage:o(t.Usage)}const l=r.a.isNullOrEmpty(r.a.tryParse(i.CustomControlId))?i.Name:i.CustomControlId;i.FormFactor<0&&(e=a.toString(),a--),t[e]={CustomControlId:l,Name:i.Name,DisplayNameKey:i.DisplayNameKey,FormFactor:i.FormFactor,Version:i.Version,Parameters:s,ShouldOverrideControlVisible:i.ShouldOverrideControlVisible}}return t}function o(e){switch(e){case"Bound":return 0;case"Input":return 1;case"Output":return 2;case"FalseBound":default:return 3}}},LtP7:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("nxt5");class a extends r.a{constructor(e){super("Update"),this._entityReference=null,this._entityReference=e}get_entityReference(){return this._entityReference}}},Lyxw:function(e,t,n){"use strict";n.d(t,"f",(function(){return a})),n.d(t,"g",(function(){return s})),n.d(t,"c",(function(){return p})),n.d(t,"e",(function(){return o})),n.d(t,"d",(function(){return l})),n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return d}));var r=n("SjFi");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t){return i(null==e?void 0:e.fcbs,t)}function i(e,t){if(null==e?void 0:e.clientFCBs){const n=e.clientFCBs[t];return void 0!==n&&(n||c(e,t))}return!1}function o(e,t,n,r){const i=null==n||a(e,n),o=a(e,t),s=null!=r&&a(e,r);return!(!o||!i&&!s)}function s(e,t){return c(e.fcbs,t)}function c(e,t){if(e){const n=e.nativeFCBContext;if(n&&void 0!==n[t])return n[t]}return!1}function l(e,...t){for(const n of t)if(a(e,n))return!0;return!1}function u(e){var t,n;return null===(n=null===(t=e.fcbs)||void 0===t?void 0:t.currentReleaseWave)||void 0===n?void 0:n.waveNumber}function d(e){var t,n;return null===(n=null===(t=e.fcbs)||void 0===t?void 0:t.currentReleaseWave)||void 0===n?void 0:n.waveYear}function p(e){const t=e.clientFCBs;if(t)return Object.keys(t).filter(e=>r.a.test(e)).filter(t=>i(e,t))}},LzVy:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e){return e&&e.platform?e.platform.type:null}n.d(t,"a",(function(){return r}))},"M+aw":function(e,t,n){"use strict";function r(e){return e.appNotifications}function a(e,t){return e.appNotifications[t]}function i(e){const t=e.appNotifications;let n=(new Date).toISOString();for(const e in t)n=new Date(n)>new Date(t[e].createdOn)?t[e].createdOn:n;return n}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return i}))},M0zh:function(e,t,n){"use strict";n.d(t,"l",(function(){return O})),n.d(t,"w",(function(){return G})),n.d(t,"g",(function(){return F})),n.d(t,"i",(function(){return k})),n.d(t,"u",(function(){return L})),n.d(t,"t",(function(){return B})),n.d(t,"c",(function(){return V})),n.d(t,"b",(function(){return z})),n.d(t,"e",(function(){return I})),n.d(t,"f",(function(){return w})),n.d(t,"d",(function(){return j})),n.d(t,"h",(function(){return U})),n.d(t,"j",(function(){return C})),n.d(t,"k",(function(){return E})),n.d(t,"s",(function(){return P})),n.d(t,"r",(function(){return T})),n.d(t,"p",(function(){return x})),n.d(t,"n",(function(){return M})),n.d(t,"o",(function(){return N})),n.d(t,"m",(function(){return A})),n.d(t,"q",(function(){return R})),n.d(t,"a",(function(){return D})),n.d(t,"v",(function(){return ee}));var r=n("SRl2"),a=n("Lyxw"),i=n("3/02"),o=n("eXjw"),s=n("iZ7K"),c=n("ZoNW"),l=n("Uv1Y"),u=n("FZDd"),d=n("2XFH"),p=n("K7RF"),f=n("EY5k"),g=n("YxC/"),h=n("99zj"),m=n("69Qu"),b=n("/oKV"),y=n("iJGp"),_=n("sZ+8"),v=n("eD3A");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const S="Commanding.Components.CommandManager",O="ribbon.retrieve",C="ribbon.commandingstate.initial",E="ribbon.commandingstate.batch",I="ribbon.evaluaterule",w="ribbon.evaluaterule.initial",j="ribbon.evaluaterules.batch",P="ribbon.storerulecontext",T="ribbon.storeribbonid",N="ribbon.createdcontainer",A="ribbon.storeallowlistmap",R="ribbon.storenoncacheablerulemap",D="ribbon.destroycommandbar",x="ribbon.storeflyoutxml",M="ribbon.storecontexttoken",F="Form:",k="HomePageGrid:",L="SubGridStandard:",B="SubGridAssociated:",U="Global:",V="EntityLogicalNameMarker",z="EntityLogicalNameCollectionMarker",q=/\{\!EntityDisplayName:([^)]+)\}/i,H=/\$Resources(?:\(([^)]+)\))?:(.+)/i,W=/\$LocLabels(?:\(([^)]+)\))?:(.+)/i;function G(e,t,n){return{type:"ribbon.retrieve.async",cacheKey:e,execute({dispatch:s,getState:c},l){let u=b.a.LocalAndRemote;const d=c(),f=Object(r.d)(d,e),h=e&&e.split(":");if(!h||2!==h.length||!h[0]||!h[1])return l.TraceManager.getTracer("Commanding").warn("The ribbonId passed to the retrieveRibbon function is not of the form ContextType:EntityType, it has the following value instead: "+e),Promise.resolve();const y=h[0],v=h[1];(Object(m.c)(d)||Object(_.r)(d,v))&&f===o.a.Initialized&&Object(p.e)(d,Object(r.b)(d,e).OverallVersionNumber)&&(u=b.a.Remote);const C=Object(r.a)(d,e)&&f!==o.a.Initializing&&f!==o.a.Refreshing;if(f===o.a.Uninitialized||f===o.a.Error||C||u!==b.a.LocalAndRemote)return s(function(e,t,n){const a=Object(r.b)(e,t),i=t?{[t]:Object.assign(Object.assign({},a),{initialized:n?o.a.Refreshing:o.a.Initializing})}:null;return{type:O,payload:{ribbons:i}}}(d,e.toString(),C)),ce(s,c,v,y,u).then(p=>{if(Object(a.f)(d,i.gf)&&"null"!==v&&v!==V&&(!p.ribbons[e]||!p.ribbons[e].Layout)){const a=y+":"+V,i=Object(r.b)(d,e);if((null==i?void 0:i.initialized)===o.a.Initialized){const t=function(e){const t={initialized:o.a.Initialized,IsUncustomized:!0,Localized:!0},n={ribbons:{}};return n.ribbons[e]=t,n}(e);return void s(le(t))}return ce(s,c,"RibbonClientMetadataCacheLoaderDummyEntity",y,u).then(r=>function(e,t,n,r,a,i,s,c){const l=i.ribbons[a],u={initialized:o.a.Initialized,IsUncustomized:!0};return i.ribbons[r]=u,te(t(),n,e,l,i.ribbonsLabelIds,a,V,s,c).then(()=>{const n=t(),r=n.metadata.labels,a=Object(g.d)(n);e(Q(t(),l,i.ribbonsLabelIds,r,a,V)),e(le(i))})}(s,c,l,e,a,r,t,n))}return K(s,c,l,e,p,v,t,n)}).catch(t=>{!function(e,t,n,r){const a=[];a.push({name:"RibbonId",value:n}),t.EventManager.ReportComponentFailure(S+".loadMetadata",r,"Error loading metadata",a),e(function(e,t){const n=e?{[e]:{initialized:o.a.Error,ErrorCode:t}}:null;return{type:O,payload:{ribbons:n}}}(n,null==r?void 0:r.errorCode))}(s,l,e,t)});const E=Object(r.b)(d,e);if(E&&E.Commands){const a={ribbons:{[e]:E}};if(!E.Localized)return a.ribbonsLabelIds=Object(r.c)(d),K(s,c,l,e,a,v,t,n);s(le(a))}return Promise.resolve()}}}function K(e,t,n,r,a,i,o,s){const c=a.ribbons[r];return te(t(),n,e,c,a.ribbonsLabelIds,r,i,o,s).then(()=>{const n=t(),r=n.metadata.labels,o=Object(g.d)(n);e(Q(n,c,a.ribbonsLabelIds,r,o,i)),e(le(a))})}function Q(e,t,n,r,a,i){return{type:"ribbon.localizeribbon",execute({dispatch:o,getState:s},c){if(t&&t.Layout){let s=new Array;t.Layout.Tabs.Tab&&(s=s.concat(t.Layout.Tabs.Tab)),t.Layout.ContextualTabs.Tab&&(s=s.concat(t.Layout.ContextualTabs.Tab)),s.forEach(t=>{t&&t.Groups&&t.Groups.Group&&t.Groups.Group.forEach(t=>{t.Controls.Items.forEach(t=>{const s=Y(e,o,n,r,a,i),c=X(e,o,n,r,a,i);c(t),Z(t,c,s)})})}),t.Localized=!0,t.LoadedWhileOffline=!Object(m.c)(e)}return Promise.resolve(t)}}}function X(e,t,n,r,a,i){return o=>{var s,c,l,u;return o&&(o.AltRaw=null!==(s=o.Alt)&&void 0!==s?s:"",o.LabelTextRaw=null!==(c=o.LabelText)&&void 0!==c?c:"",o.ToolTipDescriptionRaw=null!==(l=o.ToolTipDescription)&&void 0!==l?l:"",o.ToolTipTitleRaw=null!==(u=o.ToolTipTitle)&&void 0!==u?u:"",o.Alt=t(J(e,n,r,a,i,o.Alt)),o.LabelText=t(J(e,n,r,a,i,o.LabelText)),o.ToolTipDescription=t(J(e,n,r,a,i,o.ToolTipDescription)),o.ToolTipTitle=t(J(e,n,r,a,i,o.ToolTipTitle))),!0}}function Y(e,t,n,r,a,i){return o=>(o&&(o.Title=t(J(e,n,r,a,i,o.Title))),!0)}function J(e,t,n,r,a,i){return{type:"ribbon.localizestring",sync:!0,execute({dispatch:o,getState:c},l){let u=i;if(i){const o=q.exec(i),c=H.exec(i),l=W.exec(i);if(o&&o.length>1&&o[1]){u=Object(s.f)(e,o[1])||u}else if(c&&c.length>2){let t=r[c[2]];c[1]&&(t=$(e,a,c[1],t)),u=t||u}else if(l&&l.length>2&&l[2]){const r=t&&t[l[2]];r&&n[r]&&n[r][l[2]]&&(u=n[r][l[2]],l[1]&&(u=$(e,a,l[1],u)))}}return u}}}function $(e,t,n,r){if(!r)return null;let a=r;return"EntityDisplayName"===n.trim()?a=String.format(a,Object(s.f)(e,t)):"EntityPluralDisplayName"===n.trim()&&(a=String.format(a,Object(s.e)(e,t))),a}function Z(e,t,n){"Menu"in e&&e&&e.Menu&&e.Menu.MenuSection&&e.Menu.MenuSection.length&&(e.Menu.MenuSection=e.Menu.MenuSection.filter(e=>{const r=e&&n(e);return r&&e.Item&&e.Item.Items&&(e.Item.Items=e.Item.Items.filter(e=>{const r=e&&t(e);return r&&Z(e,t,n),r})),r}))}function ee(e,t,n,r,a,i,o){const s={},c=[],l=e(),d=e=>{const t=re(l,e.Title,s,i);return t&&se(e.Title,c),t},p=e=>{let t=re(l,e.Alt,s,i);return t=t&&re(l,e.LabelText,s,i),t=t&&re(l,e.ToolTipDescription,s,i),t=t&&re(l,e.ToolTipTitle,s,i),t&&(se(e.Alt,c),se(e.LabelText,c),se(e.ToolTipDescription,c),se(e.ToolTipTitle,c)),t};return r&&r.MenuSection&&r.MenuSection.length&&(r.MenuSection=r.MenuSection.filter(e=>(d(e),e.Item&&e.Item.Items&&e.Item.Items.length&&(e.Item.Items=e.Item.Items.filter(e=>{const t=e&&p(e);return t&&Z(e,p,d),t})),e.Item&&e.Item.Items&&e.Item.Items.length>0))),Promise.all([n(Object(u.e)(s,o)),n(Object(f.e)(c)).catch(e=>{const n=[];return n.push({name:"ResourceStrings",value:JSON.stringify(c)}),n.push({name:"RibbonId",value:null==r?void 0:r.Id}),t.EventManager.ReportComponentFailure(S+".retrieveResourceStrings",e,"RetriveRibbon: Error loading injected menu resource strings",n),c})]).then(()=>{const t=e(),i=t.metadata.labels,o=Object(g.d)(t),s=t.metadata.ribbonsLabelIds,c=Y(t,n,s,i,o,a),l=X(t,n,s,i,o,a);return r&&r.MenuSection&&r.MenuSection.length&&r.MenuSection.forEach(e=>{c(e),e.Item&&e.Item.Items&&e.Item.Items.length&&e.Item.Items.forEach(e=>{l(e),Z(e,l,c)})}),r})}function te(e,t,n,r,a,i,o,s,c){return Promise.all([ie(e,n,r,a),ne(e,t,n,r,i,o,s,c),oe(e,t,n,i,r)])}function ne(e,t,n,r,a,i,o,s){const c={},l=[];if(r&&r.Layout){const t=r.Layout;ae(e,c,i);let n=new Array;t.Tabs.Tab&&(n=n.concat(t.Tabs.Tab)),t.ContextualTabs.Tab&&(n=n.concat(t.ContextualTabs.Tab)),n.forEach(t=>{if(t){let n;if(t&&t.Groups&&t.Groups.Group)for(n=0;n<t.Groups.Group.length;n++){const r=t=>{const n=re(e,t.Title,c,o);return n&&se(t.Title,l),n},a=t=>{let n=re(e,t.Alt,c,o);return n=n&&re(e,t.LabelText,c,o),n=n&&re(e,t.ToolTipDescription,c,o),n=n&&re(e,t.ToolTipTitle,c,o),n&&(se(t.Alt,l),se(t.LabelText,l),se(t.ToolTipDescription,l),se(t.ToolTipTitle,l)),n};t.Groups.Group[n].Controls.Items?t.Groups.Group[n].Controls.Items=t.Groups.Group[n].Controls.Items.filter(e=>{const t=e&&a(e);return t&&Z(e,a,r),t}):t.Groups.Group[n].Controls.Items=[]}}})}return Promise.all([n(Object(u.e)(c,s)),n(Object(f.e)(l)).catch(e=>{const n=[];n.push({name:"ResourceStrings",value:JSON.stringify(l)}),n.push({name:"RibbonId",value:a}),t.EventManager.ReportComponentFailure(S+".retrieveResourceStrings",e,"Error loading resource strings for ribbon.",n)})])}function re(e,t,n,r){let a=!0;if(t){const i=q.exec(t);if(i&&i.length>1&&i[1]&&i[1].length>0){const t=i[1]&&i[1].toLowerCase();a=function(e,t,n){return Object(m.c)(e)||n(e,t)||Object(_.r)(e,t)}(e,t,r),a&&ae(e,n,t)}}return a}function ae(e,t,n){!n||"undefined"===n.toLowerCase()||"null"===n.toLowerCase()||Object(s.f)(e,n)&&Object(s.e)(e,n)||(t[n]=[])}function ie(e,t,n,r){let a=[];for(const e in r){const t=r[e]+":"+e;a.push(t)}return a=Object(c.a)(e,a),t(Object(d.a)(a))}function oe(e,t,n,r,a){if(a){const i=/^\$webresource:/i,o=new Set,s=r&&r.split(":"),c=s.length>1?s[1]:null,l=Object(v.g)(e,c);if(a.Commands){const e=a.Commands;for(const t in e)for(const n in e[t]){const r=e[t][n];if(r){if(l&&!Object(v.o)(a.EnableRules,r.EnableRules,t))continue;const e=r.Actions.filter(e=>3===e.ActionType);for(const t of e)if(t.Attributes){const e=t.Attributes;e.Library&&-1!==e.Library.search(i)&&o.add(e.Library)}}}}if(a.EnableRules){const e=a.EnableRules;for(const t in e)for(const n in e[t]){const r=e[t][n];if(r){const e=r.Rules.filter(e=>4===e.RuleType);for(const t of e)t.Library&&-1!==t.Library.search(i)&&o.add(t.Library)}}}if(o.size>0)return n(Object(h.d)(Array.from(o))).catch(e=>{const n=[];return n.push({name:"WebResources",value:JSON.stringify(o)}),n.push({name:"RibbonId",value:r}),t.EventManager.ReportComponentFailure(S+".retrieveWebResources",e,"Error loading web resources for RetrieveRibbon.",n),null})}return Promise.resolve([null])}function se(e,t){const n=H.exec(e);n&&n.length>2&&t.push(n[2])}function ce(e,t,n,r,o){return e(Object(p.b)("ribbon",null,n,null,!1,y.a.OnDemandWithoutContext,null,null,[r],null,o)).catch(s=>{if("RibbonClientMetadataCacheLoaderDummyEntity"!==n&&Object(a.f)(t(),i.gf))return function(e,t,n,r,a){return e(Object(p.b)("ribbon",null,t,null,!1,y.a.OnDemandWithoutContext,null,null,[n],null,r)).catch(l.b)}(e,"RibbonClientMetadataCacheLoaderDummyEntity",r,o);Object(l.b)(s)})}function le(e){return{type:O,payload:e}}},M1jQ:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));class r{}},M6xi:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));class r{read(e,t){return e[t.get_name()]}write(e,t,n){("number"!=typeof n||isFinite(n))&&(e[t.get_name()]=n)}}r.defaultConverter=new r},M8lA:function(e,t,n){"use strict";function r(e,t){return!!(e.appShellState&&e.appShellState.modalComponentState&&e.appShellState.modalComponentState.modalComponentsOpenState)&&e.appShellState.modalComponentState.modalComponentsOpenState[t]}function a(e){if(e.appShellState&&e.appShellState.modalComponentState&&e.appShellState.modalComponentState.modalComponentsOpenState){return Object.keys(e.appShellState.modalComponentState.modalComponentsOpenState).some(t=>r(e,t))}return!1}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}))},MIBb:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("arV0"),a=n("pF61"),i=n("IaGr");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function o(e,t,n,o,s){if(n.ScriptManager.containerExists(o))return n.ScriptManager.getContainer(o);s||(s=[]),e+=".safeGetContainer",s.push({name:"pageId",value:o});const c=Object(r.p)(t,o);return s.push({name:"pageType",value:c}),Object(a.m)(t,o)?(n.TraceManager.getTracer(e).warn("The page is dead, canceling the action",s),null):(i.a.getInstance().eventManager.ReportComponentFailure(e,new Error("ScriptContainer does not exist"),null,s),null)}},MOEv:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="formnotification_"},MQTY:function(e,t,n){"use strict";n.r(t),n.d(t,"SYSTEM_DASHBOARD_LABEL_ID",(function(){return r})),n.d(t,"USER_DASHBOARD_LABEL_ID",(function(){return a})),n.d(t,"DASHBOARD_SELECTOR_TOOLTIP",(function(){return i})),n.d(t,"labelList",(function(){return o}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="CRM_System_Dashboards_Group_Name",a="CRM_User_Dashboards_Group_Name",i="DashBoard_Selector_Text_UClient",o=[r,a,i]},MTWl:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r,a=n("QEBF"),i=n("ghc6"),o=n("8aze"),s=(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.getElementName=function(){return"a"},t.prototype.getElementProps=function(){var e={href:this.props.href||"#",target:this.props.target};return this.props.download&&Object.assign(e,{download:this.props.download}),e},t}(a.a),l=i.a(o.b)(c)},MUIu:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return d})),n.d(t,"d",(function(){return p}));var r=n("504W"),a=n("qCX6");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
let i=null,o=null;function s(){return new Date(0)}function c(){return i||(i=new RegExp("[Z,T]","ig"))}function l(e){if(Object(r.a)(e.firstChild)||Object(r.b)(e.firstChild.nodeValue))return s();let t=e.firstChild.nodeValue.replace(c()," ");return t=d(t),new Date(Date.parse(t))}function u(e){return Object(r.a)(e)||e===s()?"":e.toJSON()}function d(e){e=e.lastIndexOf(".")>-1?e.substr(0,e.lastIndexOf(".")):e;return a.a.get_instance().get_offlineDataSource().isDssOfflineEnabled()&&(e=e.replace(c()," ")),e.replace(o||(o=new RegExp("[-]","ig")),"/")+" UTC"}function p(e){return e.replace(c()," ")}},MXaZ:function(e,t,n){"use strict";n.d(t,"f",(function(){return s})),n.d(t,"d",(function(){return c})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return u})),n.d(t,"a",(function(){return d})),n.d(t,"I",(function(){return f})),n.d(t,"e",(function(){return b})),n.d(t,"r",(function(){return y})),n.d(t,"y",(function(){return _})),n.d(t,"s",(function(){return v})),n.d(t,"t",(function(){return S})),n.d(t,"o",(function(){return O})),n.d(t,"m",(function(){return C})),n.d(t,"l",(function(){return E})),n.d(t,"k",(function(){return I})),n.d(t,"q",(function(){return w})),n.d(t,"P",(function(){return j})),n.d(t,"L",(function(){return P})),n.d(t,"w",(function(){return N})),n.d(t,"M",(function(){return D})),n.d(t,"p",(function(){return x})),n.d(t,"u",(function(){return M})),n.d(t,"Q",(function(){return F})),n.d(t,"E",(function(){return k})),n.d(t,"F",(function(){return L})),n.d(t,"A",(function(){return B})),n.d(t,"z",(function(){return U})),n.d(t,"B",(function(){return V})),n.d(t,"C",(function(){return z})),n.d(t,"G",(function(){return q})),n.d(t,"H",(function(){return H})),n.d(t,"J",(function(){return W})),n.d(t,"K",(function(){return G})),n.d(t,"N",(function(){return K})),n.d(t,"g",(function(){return Q})),n.d(t,"i",(function(){return X})),n.d(t,"h",(function(){return Y})),n.d(t,"j",(function(){return J})),n.d(t,"n",(function(){return $})),n.d(t,"v",(function(){return Z})),n.d(t,"D",(function(){return ee})),n.d(t,"O",(function(){return te})),n.d(t,"x",(function(){return ne}));var r=n("Ae6N"),a=n("3/02"),i=n("dpM5"),o=n("Lyxw");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const s=6e4,c="date",l="dateonly",u="datetime",d="dateandtime";function p(e){return new Date(e.getTime()-e.getTimezoneOffset()*s)}function f(e){return new Date(e.getTime()+e.getTimezoneOffset()*s)}function g(e,t){return/8|3|5|10/.test(e.toString())?30:1!==e?31:h(t)?29:28}function h(e){return e%4==0&&e%100!=0||e%400==0}var m,b;function y(e,t){if(e.isFixedDateRule)return new Date(t,e.month,e.day,e.timeOfDay.getHours(),e.timeOfDay.getMinutes(),e.timeOfDay.getSeconds());const n=7*e.week-6,r=new Date(t,e.month,1).getDay();let a;return a=r>e.dayOfWeek?n+(7-r+e.dayOfWeek):n+(e.dayOfWeek-r),a>g(e.month,t)&&(a-=7),new Date(t,e.month,a,e.timeOfDay.getHours(),e.timeOfDay.getMinutes(),e.timeOfDay.getSeconds())}function _(e,t){const n=t.getFullYear(),r=y(e.daylightStart,n),a=y(e.daylightEnd,n);if(a<r){if(t>r||t<a)return e.delta}else if(t>r&&t<a)return e.delta;return 0}function v(e,t){if(!t)return 0;let n;const r=new Date(e.getTime());r.setHours(0),r.setMinutes(0),r.setSeconds(0),r.setMilliseconds(0);for(let e=0;e<t.length;e++){const a=t[e].dateStart,i=t[e].dateEnd;if(r>=a&&r<=i){n=t[e];break}}return n?_(n,e):0}function S(e,t){return v(e,t)/s}function O(e){const t=Date.parse(e);return isNaN(t)?void 0:new Date(t)}function C(e,t,n){if(!e)return e;let r=t*s;r+=v(e,n);const a=e.getTimezoneOffset()*s;return new Date(e.getTime()+r+a)}function E(e,t,n){if(!e)return e;let r=t*s;r+=v(e,n);const a=e.getTimezoneOffset()*s;return new Date(e.getTime()-r-a)}function I(e){if(!e)return e;const t=e.getTimezoneOffset()*s;return new Date(e.getTime()-t)}function w(e,t,n,a){switch(n){case r.a.DateOnly:case r.a.TimeZoneIndependent:return f(e);case r.a.UserLocal:return C(e,t,a);default:return new Date(e.getTime())}}function j(e,t,n,a){if(!e)return e;switch(a){case r.a.UserLocal:return E(e,t,n);case r.a.TimeZoneIndependent:return p(e);case r.a.DateOnly:return p(new Date(e.getFullYear(),e.getMonth(),e.getDate()));default:return new Date(e.getTime())}}function P(e,t,n,r=!1){return r?function(e,t,n){if(t<m.Sunday||t>m.Saturday)throw new Error("Argument 'firstDayOfWeek' is out of range");const r=T(e.getFullYear()-1,t,n),a=T(e.getFullYear(),t,n),i=T(e.getFullYear()+1,t,n);let o;o=e.valueOf()<a.valueOf()?r:e.valueOf()<i.valueOf()?a:i;const s=(e.valueOf()-o.valueOf()+864e5)/6048e5;return Math.ceil(s)}(e,t,n):function(e,t,n){if(t<m.Sunday||t>m.Saturday)throw new Error("Argument 'firstDayOfWeek' is out of range");return D(e,t,7)}(e,t)}function T(e,t,n){return R(new Date(e,0,A(n)),t)}function N(e,t,n,r){const a=7*(t-1);return R(new Date(e,0,A(r)+a),n)}function A(e){let t;switch(e){case b.FirstFourDayFullWeekOfTheYear:t=4;break;case b.FirstFullWeekOfTheYear:t=7;break;case b.FirstDayOfTheYear:default:t=1}return t}function R(e,t){e.setHours(0,0,0,0);const n=(e.getDay()+7-t)%7,r=new Date(e.getTime()-60*(24*n-2)*60*1e3);return r.setHours(0,0,0,0),r}function D(e,t,n){let r=function(e){let t=0;for(let n=0;n<e.getMonth();n++)t+=g(n,e.getFullYear());return t+=e.getDate(),t}(e)-1,a=e.getDay()-r%7,i=(t-a+14)%7;0!==i&&i>=n&&(i-=7);let o=r-i;if(o<0){r=h(e.getFullYear()-1)?366:365,a-=r%7,i=(t-a+14)%7,0!==i&&i>=n&&(i-=7),o=r-i}return Math.floor(o/7+1)}function x(e,t,n,a){switch(n){case r.a.DateOnly:case r.a.TimeZoneIndependent:return p(e);case r.a.UserLocal:return E(e,t,a);default:return new Date(e.getTime())}}function M(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate())}function F(e){return e.map(e=>({dateStart:e.get_DateStart(),dateEnd:e.get_DateEnd(),daylightStart:{day:e.get_DaylightStart().get_Day(),month:e.get_DaylightStart().get_Month(),dayOfWeek:e.get_DaylightStart().get_DayOfWeek(),week:e.get_DaylightStart().get_Week(),timeOfDay:new Date(e.get_DaylightStart().get_TimeOfDay()),isFixedDateRule:e.get_DaylightStart().get_IsFixedDataRule()},delta:e.get_Delta(),daylightEnd:{day:e.get_DaylightEnd().get_Day(),month:e.get_DaylightEnd().get_Month(),dayOfWeek:e.get_DaylightEnd().get_DayOfWeek(),week:e.get_DaylightEnd().get_Week(),timeOfDay:new Date(e.get_DaylightEnd().get_TimeOfDay()),isFixedDateRule:e.get_DaylightEnd().get_IsFixedDataRule()}}))}function k(e){const t=new Date(Date.now()),n=t.getTimezoneOffset()*s,r=e.get_UserSettings().get_timeZoneUtcOffsetMinutes()*s;return new Date(t.getTime()+n+r)}function L(e){const t=k(e),n=v(t,F(e.get_TimeZoneAdjusters()));return new Date(t.getTime()+n)}function B(e){return e.setMinutes(0,0,0),e}function U(e){return e.setHours(0,0,0,0),e}function V(e){const t=U(e);return t.setDate(1),t}function z(e){const t=V(e);return t.setMonth(0),t}function q(e){return Math.trunc(e.get_UserSettings().get_timeZoneUtcOffsetMinutes()/60)}function H(e){return e.get_UserSettings().get_timeZoneUtcOffsetMinutes()%60}function W(e){return-1*q(e)}function G(e){return-1*H(e)}function K(e,t){const n=e.get_UserSettings().get_dateTimeFormatInfo().FirstDayOfWeek;return(t=new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0)).getDay()<n?Q(t,n-t.getDay()-7):Q(t,n-t.getDay())}function Q(e,t){const n=new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds());return n.setDate(e.getDate()+t),n}function X(e,t){return Q(e,7*t)}function Y(e,t){const n=new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds());return n.setMonth(e.getMonth()+t),n}function J(e,t){const n=new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds());return n.setFullYear(e.getFullYear()+t),n}function $(e,t){let n=e.get_UserSettings().get_timeZoneUtcOffsetMinutes()*s;n+=v(t,F(e.get_TimeZoneAdjusters()));return new Date(t.getTime()-n)}function Z(e){return String.format("'{0}-{1:D2}-{2:D2} {3:D2}:{4:D2}:{5:D2}.{6:D3}'",e.getFullYear(),e.getMonth()+1,e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())}function ee(e,t){return Z($(e,t))}function te(e){var t;const n=null===(t=null==e?void 0:e.Type)||void 0===t?void 0:t.toLowerCase();return n===c||n===l||n===u||n===d}function ne(e){return Object(o.e)(e,i.v,a.p)}!function(e){e[e.Sunday=0]="Sunday",e[e.Monday=1]="Monday",e[e.Tuesday=2]="Tuesday",e[e.Wednesday=3]="Wednesday",e[e.Thursday=4]="Thursday",e[e.Friday=5]="Friday",e[e.Saturday=6]="Saturday"}(m||(m={})),function(e){e[e.FirstDayOfTheYear=0]="FirstDayOfTheYear",e[e.FirstFullWeekOfTheYear=1]="FirstFullWeekOfTheYear",e[e.FirstFourDayFullWeekOfTheYear=2]="FirstFourDayFullWeekOfTheYear"}(b||(b={}))},Me5Q:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("mpSO");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t){return{type:r.j,payload:{initializationState:e},meta:{commandManagerId:t}}}},MhnN:function(e,t,n){"use strict";n.d(t,"b",(function(){return p})),n.d(t,"c",(function(){return f})),n.d(t,"a",(function(){return u}));var r=n("mMyr"),a=n("/y4C"),i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};function o(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var s=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},c=Object(a.shape)({onComponentsChange:a.func.isRequired,removeOnComponentsChange:a.func.isRequired}),l=Object(a.shape)({emit:a.func.isRequired,on:a.func.isRequired,off:a.func.isRequired}),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.componentWillMount=function(){this.context.manager.onFillMount(this)},t.prototype.componentDidUpdate=function(){this.context.manager.onFillUpdated(this)},t.prototype.componentWillUnmount=function(){this.context.manager.onFillUnmount(this)},t.prototype.render=function(){return null},t.contextTypes={manager:c},t}(r.Component),d=function(){function e(){this._events=[],this._db={byName:new Map,byFill:new Map}}return e.prototype.onFillMount=function(e){var t=r.Children.toArray(e.props.children),n=e.props.name,a={fill:e,children:t,name:n},i=this._db.byName.get(n);i?(i.components.push(a),i.listeners.forEach((function(e){return e(i.components)}))):this._db.byName.set(n,{listeners:[],components:[a]}),this._db.byFill.set(e,a)},e.prototype.onFillUpdated=function(e){var t=this._db.byFill.get(e),n=r.Children.toArray(e.props.children);if(!t)throw new Error("component was expected to be defined");t.children=n;var a=t.name,i=this._db.byName.get(a);if(!i)throw new Error("registration was expected to be defined");i.listeners.forEach((function(e){return e(i.components)}))},e.prototype.onFillUnmount=function(e){var t=this._db.byFill.get(e);if(!t)throw new Error("component was expected to be defined");var n=t.name,r=this._db.byName.get(n);if(!r)throw new Error("registration was expected to be defined");var a=r.components;a.splice(a.indexOf(t),1),this._db.byFill.delete(e),0===r.listeners.length&&0===r.components.length?this._db.byName.delete(n):r.listeners.forEach((function(e){return e(r.components)}))},e.prototype.onComponentsChange=function(e,t){var n=this._db.byName.get(e);n?(n.listeners.push(t),t(n.components)):(this._db.byName.set(e,{listeners:[t],components:[]}),t([]))},e.prototype.getFillsByName=function(e){var t=this._db.byName.get(e);return t?t.components.map((function(e){return e.fill})):[]},e.prototype.getChildrenByName=function(e){var t=this._db.byName.get(e);return t?t.components.map((function(e){return e.children})).reduce((function(e,t){return e.concat(t)}),[]):[]},e.prototype.removeOnComponentsChange=function(e,t){var n=this._db.byName.get(e);if(!n)throw new Error("expected registration to be defined");var r=n.listeners;r.splice(r.indexOf(t),1)},e}(),p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._manager=new d,t}return o(t,e),t.prototype.getChildContext=function(){return{manager:this._manager}},t.prototype.render=function(){return this.props.children},t.prototype.getFillsByName=function(e){return this._manager.getFillsByName(e)},t.prototype.getChildrenByName=function(e){return this._manager.getChildrenByName(e)},t.childContextTypes={manager:c,bus:l},t}(r.Component),f=function(e){function t(t){var n=e.call(this,t)||this;return n.state={components:[]},n.handleComponentChange=n.handleComponentChange.bind(n),n}return o(t,e),t.prototype.componentWillMount=function(){this.context.manager.onComponentsChange(this.props.name,this.handleComponentChange)},t.prototype.handleComponentChange=function(e){this.setState({components:e})},Object.defineProperty(t.prototype,"fills",{get:function(){return this.state.components.map((function(e){return e.fill}))},enumerable:!0,configurable:!0}),t.prototype.componentWillReceiveProps=function(e){if(e.name!==this.props.name){this.context.manager.removeOnComponentsChange(this.props.name,this.handleComponentChange);var t=e.name;this.context.manager.onComponentsChange(t,this.handleComponentChange)}},t.prototype.componentWillUnmount=function(){var e=this.props.name;this.context.manager.removeOnComponentsChange(e,this.handleComponentChange)},t.prototype.render=function(){var e=this,t=[];if(this.state.components.forEach((function(n,a){var i=n.fill,o=n.children,c=e.props.fillChildProps;if(c){var l=Object.keys(c).reduce((function(t,n){var r=c[n];return t[n]="function"==typeof r?function(){return r(i,e.fills)}:r,t}),{});o.forEach((function(e,n){if("number"==typeof e||"string"==typeof e)throw new Error("Only element children will work here");t.push(Object(r.cloneElement)(e,s({key:a.toString()+n.toString()},l)))}))}else o.forEach((function(e,n){if("number"==typeof e||"string"==typeof e)throw new Error("Only element children will work here");t.push(Object(r.cloneElement)(e,{key:a.toString()+n.toString()}))}))})),"function"==typeof this.props.children){var n=this.props.children(t);if(Object(r.isValidElement)(n)||null===n)return n;var a=this._reactInternalInstance._currentElement._owner._instance.constructor,i=a.displayName||a.name;throw new Error("Slot rendered with function must return a valid React Element. Check the "+i+" render function.")}return t},t.contextTypes={manager:c},t}(r.Component)},MktZ:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="page.setLoadingState";function a(e,t){return{type:r,payload:t,meta:{pageId:e}}}},MqQG:function(e,t,n){"use strict";n.d(t,"b",(function(){return f})),n.d(t,"a",(function(){return p}));var r=n("mMyr"),a=n("huli"),i=n("kXuq"),o=n("nFP/"),s=n("Afz2"),c=n("/to1"),l=n("n2e+"),u=n("YxC/"),d=n("EUSs");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const p="appProgressIndicatorAccessibility";class f extends r.Component{constructor(e){super(e),this._viewKeyboardHandler=this._viewKeyboardHandler.bind(this),this._appProgressIndicatorRootViewRefFocus=this._appProgressIndicatorRootViewRefFocus.bind(this),this.state={hasFocused:!1,currentAnnounceMessage:e.message,reannounce:!1},l.a.some(t=>!Object(u.c)(e.resourceStrings,t))&&e.retrieveResourceStrings(l.a)}componentDidMount(){this._setIsProgressIndicatorVisibile()}componentDidUpdate(){this._setIsProgressIndicatorVisibile()}_appProgressIndicatorRootViewRefFocus(e){if(e){const t=a.findDOMNode(e);requestAnimationFrame(()=>{t.focus(),this.setState({hasFocused:!0})})}}_viewKeyboardHandler(e){e.stopPropagation(),e.preventDefault()}_renderProgressIndicator(){return r.createElement(o.a,{accessibilityHidden:!0,testhooks:{id:"globalAppProgressIndicator"},key:"globalAppProgressIndicator",id:"global-app-progress-indicator",progressType:"ring",active:!0,style:this.props.progressIndicatorIndicatorStyle})}_renderMessages(){const{message:e,progressIndicatorTextStyle:t}=this.props;return e&&e.indexOf("\n")>0?e.split("\n").map((e,n)=>r.createElement(c.a,{accessibilityLabel:e,id:"appProgressIndicatorMessage"+n,key:"appProgressIndicatorMessage"+n,style:t,testhooks:{id:"appProgressIndicatorMessage"+n},tabIndex:-1,accessibilityLive:"assertive",accessibilityHidden:!0},e)):e?r.createElement(c.a,{accessibilityLabel:this.props.message,id:"appProgressIndicatorMessage",key:"appProgressIndicatorMessage",style:t,testhooks:{id:"appProgressIndicatorMessage"},tabIndex:-1,accessibilityLive:"assertive",accessibilityHidden:!0},e):null}_renderAccessibilityAlert(){const{isInProgress:e,progressIndicatorAccessibilityAlertStyle:t}=this.props,{hasFocused:n,reannounce:o,currentAnnounceMessage:c}=this.state;return e&&n&&c&&!o?a.createPortal(r.createElement(i.a,{accessibilityLive:"assertive",role:s.a,style:t,key:p,id:p},c.replace(/\n/g," ")),document.body):null}_setIsProgressIndicatorVisibile(){this.props&&this.props.setIsProgressIndicatorVisibile&&this.props.setIsProgressIndicatorVisibile(this.props.isInProgress,"appProgressIndicatorView_popupContainer")}render(){const{isInProgress:e,progressIndicatorBackgroundContainerStyle:t,progressIndicatorContentStyle:n,progressIndicatorContainerStyle:a}=this.props;return r.createElement(r.Fragment,null,e?r.createElement(d.b,{id:"appProgressIndicatorView",key:"appProgressIndicatorPopup"},r.createElement(i.a,{tabIndex:-1,accessibilityLabel:" ",onKeyDown:this._viewKeyboardHandler,ref:this._appProgressIndicatorRootViewRefFocus,testhooks:{id:"appProgressIndicatorView"},id:"appProgressIndicatorView",key:"appProgressIndicatorView",style:t},r.createElement(i.a,{testhooks:{id:"appProgressIndicatorContent"},id:"appProgressIndicatorContent",key:"appProgressIndicatorContent",style:n,accessibilityHidden:!0},r.createElement(i.a,{testhooks:{id:"appProgressIndicatorContainer"},id:"appProgressIndicatorContainer",key:"appProgressIndicatorContainer",style:a,accessibilityHidden:!0},this._renderProgressIndicator()),this._renderMessages()))):null,this._renderAccessibilityAlert())}componentWillReceiveProps(e){if(this.props.isInProgress||!0!==e.isInProgress)e.isInProgress||!0!==this.props.isInProgress||clearInterval(this._setTimeIntervalId);else{let t=0;this.setState({currentAnnounceMessage:e.message});const n=()=>{this.setState({reannounce:!1}),this.forceUpdate()},r=()=>{t+=5e3,this.props.message===this.state.currentAnnounceMessage&&3e4!==t||this.setState({currentAnnounceMessage:this.props.message,reannounce:!0},n),3e4===t&&(t=0)};this._setTimeIntervalId=setInterval(r,5e3)}}}f.displayName="AppProgressIndicator"},Mr6u:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("5yoC");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class a extends r.a{constructor(e){super(),this._query=null,this._query=e}get_name(){return"RetrieveMultiple"}get_xmlNamespace(){return"http://schemas.microsoft.com/xrm/2011/Contracts"}get_query(){return this._query}}},MrAI:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r="polite"},MwwY:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r,a=n("mMyr"),i=n("huli"),o=n("/to1"),s=n("kXuq"),c=(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),l=function(e){function t(t){var n=e.call(this,t)||this;return n.mouseEnterHandler=n.mouseEnterHandler.bind(n),n.mouseLeaveHandler=n.mouseLeaveHandler.bind(n),n.setTargetRef=n.setTargetRef.bind(n),n.state={isOpened:!1},n}return c(t,e),t.prototype.generateTooltipStyle=function(){return Object.assign({},{backgroundColor:"#666666",padding:"5px 10px",position:"relative"},this.props.tooltipStyle)},t.prototype.generateTooltipContentStyle=function(){return Object.assign({},{color:"white"},this.props.tooltipContentStyle)},t.prototype.generatePopup=function(){var e=this._targetElement,t=e.offsetLeft,n=e.offsetHeight,r=e.offsetWidth,i={position:"absolute",width:this.props.width,bottom:n+5,left:t},c={};switch(this.props.direction||"top"){case"left":c={bottom:-5,transform:"translateX(-100%)",left:t};break;case"right":c={bottom:-5,left:r+5};break;case"top":c={bottom:n+5,left:t};break;case"bottom":c={bottom:-5,transform:"translateY(100%)",left:t}}return Object.assign(i,c),a.createElement(s.a,{style:i,role:"alertdialog",key:"tooltipPopup"},a.createElement(s.a,{style:this.generateTooltipStyle(),key:"tooltipWrapper"},a.createElement(o.a,{style:this.generateTooltipContentStyle(),role:"tooltip"},this.props.text),this.generatePopupArrow()))},t.prototype.generatePopupArrow=function(){var e={width:0,height:0,fontSize:0,lineHeight:0,borderColor:"transparent",borderTopColor:"#666666",borderWidth:5,borderStyle:"solid",position:"absolute",margin:"auto"},t={};switch(this.props.direction||"top"){case"left":t={transform:"rotate(-90deg)",top:0,bottom:0,right:-10};break;case"right":t={transform:"rotate(90deg)",top:0,bottom:0,left:-10};break;case"top":t={right:0,left:0,bottom:-10};break;case"bottom":t={transform:"rotate(180deg)",top:-10,left:0,right:0}}return Object.assign(e,t),a.createElement(o.a,{style:e})},t.prototype.mouseEnterHandler=function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),this.state.isOpened||this.setState({isOpened:!0})},t.prototype.mouseLeaveHandler=function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),this.state.isOpened&&this.setState({isOpened:!1})},t.prototype.setTargetRef=function(e){this._targetElement=Object(i.findDOMNode)(e)},t.prototype.render=function(){return a.createElement(s.a,{style:{position:"relative",display:"inline-flex",alignItems:"center"},accessibilityHidden:this.props.accessibilityHidden},a.createElement(s.a,{ref:this.setTargetRef,onPointerEnter:this.mouseEnterHandler,onPointerLeave:this.mouseLeaveHandler,onFocus:this.mouseEnterHandler,onBlur:this.mouseLeaveHandler},this.props.children),this.state.isOpened?this.generatePopup():null)},t}(a.Component);l.defaultProps={width:300}},N0PS:function(e,t,n){"use strict";n.d(t,"b",(function(){return $t})),n.d(t,"a",(function(){return Zt}));var r=n("ABCl"),a=n("Z4sG"),i=n("E7fB"),o=n("zsAz"),s=n("SAYH"),c=n("YxC/"),l=n("7tM0"),u=n("cUbT"),d=n("EY5k"),p=n("w72X"),f=n("FZDd"),g=n("K7RF"),h=n("g0tL"),m=n("iJGp"),b=n("/oKV"),y=n("y60j"),_=n("16wZ"),v=n("iZ7K"),S=n("LbMF"),O=n("ZIjf"),C=n("/A0C"),E=n("qshH");class I{constructor(e,t){this._attributeType=null;t||Object(_.j)("ClientApi.XrmAttributeMetadata.constructor","attributeDescriptor"),this._clientApiExecutor=new r.b(e,"ClientApi.XrmAttributeMetadata."),this.attributeDescriptor=t,this._logicalName=t.LogicalName,this._displayName=t.DisplayName,this._entityLogicalName=t.EntityLogicalName,this._isValidForGrid=t.IsValidForGrid,this._attributeTypeName=t.Type}get LogicalName(){return O.a.instance.reportUsage("ClientApi.XrmAttributeMetadata.LogicalName"),this._logicalName}get DisplayName(){return O.a.instance.reportUsage("ClientApi.XrmAttributeMetadata.DisplayName"),this._displayName}get AttributeType(){const e="ClientApi.XrmAttributeMetadata.AttributeType";try{if(O.a.instance.reportCall(e),!this._attributeType)switch(this.attributeDescriptor.Type){case C.a.String:this._attributeType=14;break;case C.a.DateTime:this._attributeType=2;break;case C.a.Decimal:this._attributeType=3;break;case C.a.Double:this._attributeType=4;break;case C.a.Integer:this._attributeType=5;break;case C.a.Lookup:this._attributeType=6;break;case C.a.Memo:this._attributeType=7;break;case C.a.Money:this._attributeType=8;break;case C.a.Owner:this._attributeType=9;break;case C.a.Customer:this._attributeType=1;break;case C.a.PartyList:this._attributeType=10;break;case C.a.UniqueIdentifier:this._attributeType=15;break;case C.a.BigInt:this._attributeType=18;break;case C.a.CalendarRules:this._attributeType=16;break;case C.a.Virtual:case C.a.MultiSelectPickList:this._attributeType=17;break;case C.a.EntityName:this._attributeType=20;break;case C.a.ManagedProperty:this._attributeType=19;break;case C.a.Image:this._attributeType=23;break;case C.a.Boolean:this._attributeType=0;break;case C.a.PickList:case C.a.OptionSet:this._attributeType=11;break;case C.a.State:this._attributeType=12;break;case C.a.Status:this._attributeType=13;break;default:Object(_.h)(e,"AttributeType",this.attributeDescriptor.Type)}return O.a.instance.reportSuccess(e),this._attributeType}catch(t){throw E.a.getInstance().reportFailure(e,t),t}}get EntityLogicalName(){return O.a.instance.reportUsage("ClientApi.XrmAttributeMetadata.EntityLogicalName"),this._entityLogicalName}get IsValidForGrid(){return this._clientApiExecutor.execute("IsValidForGrid",()=>this._isValidForGrid)}get AttributeTypeName(){return this._clientApiExecutor.execute("AttributeTypeName",()=>this._attributeTypeName)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class w extends I{constructor(e,t){super(e,t),this._optionSet=null,this.defaultFormValue=t.DefaultValue}get OptionSet(){const e="ClientApi.XrmEnumAttributeMetadata.OptionSet";try{if(O.a.instance.reportCall(e),null===this._optionSet){this._optionSet={};const e=this.attributeDescriptor.OptionSet;if(e)for(let t=0;t<e.length;t++){const n={text:e[t].Label,value:e[t].Value};this._optionSet[e[t].Value]=n}}return O.a.instance.reportSuccess(e),this._optionSet}catch(t){throw E.a.getInstance().reportFailure(e,t),t}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class j extends w{get DefaultFormValue(){return O.a.instance.reportUsage("ClientApi.XrmBooleanAttributeMetadata.DefaultFormValue"),!!this.defaultFormValue}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class P extends I{constructor(e,t){super(e,t),this._attributeTargets=t.Targets}get Targets(){return O.a.instance.reportUsage("ClientApi.XrmLookupAttributeMetadata.Targets"),this._attributeTargets}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class T extends w{get DefaultFormValue(){return O.a.instance.reportUsage("ClientApi.XrmPicklistAttributeMetadata.DefaultFormValue"),this.defaultFormValue}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let N;class A extends w{constructor(e,t){super(e,t),N=e}getDefaultStatus(e){const t="ClientApi.XrmStateAttributeMetadata.getDefaultStatus";(Object(_.a)(e)||isNaN(e))&&Object(_.h)(t,"state",e);try{O.a.instance.reportCall(t);const n=this.attributeDescriptor.OptionSet;if(n)for(let r=0;r<n.length;r++)if(n[r].Value===e)return O.a.instance.reportSuccess(t),n[r].DefaultStatus}catch(n){const r=[];throw r.push({name:"state",value:e}),r.push({name:"AttributeType",value:this.AttributeType}),r.push({name:"DisplayName",value:this.DisplayName}),r.push({name:"EntityLogicalName",value:this.EntityLogicalName}),r.push({name:"LogicalName",value:this.LogicalName}),E.a.getInstance().reportFailure(t,n,"",r),n}O.a.instance.reportSuccess(t),Object(_.h)(t,"state",e)}getStatusValuesForState(e){const t="ClientApi.XrmStateAttributeMetadata.getStatusValuesForState";(Object(_.a)(e)||isNaN(e))&&Object(_.h)(t,"state",e);try{O.a.instance.reportCall(t);const n=[],r=Object(S.a)(N.getState(),this.EntityLogicalName,"statuscode").OptionSet;if(r)for(const t of r)t.State===e&&n.push(t.Value);return O.a.instance.reportSuccess(t),n}catch(n){const r=[];throw r.push({name:"state",value:e}),r.push({name:"AttributeType",value:this.AttributeType}),r.push({name:"DisplayName",value:this.DisplayName}),r.push({name:"EntityLogicalName",value:this.EntityLogicalName}),r.push({name:"LogicalName",value:this.LogicalName}),E.a.getInstance().reportFailure(t,n,"",r),n}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class R extends w{getState(e){const t="ClientApi.XrmStatusAttributeMetadata.getState";(Object(_.a)(e)||isNaN(e))&&Object(_.h)(t,"status",e);try{O.a.instance.reportCall(t);const n=this.attributeDescriptor.OptionSet;if(n)for(let r=0;r<n.length;r++)if(n[r].Value===e)return O.a.instance.reportSuccess(t),n[r].State}catch(n){const r=[];throw r.push({name:"status",value:e}),r.push({name:"AttributeType",value:this.AttributeType}),r.push({name:"DisplayName",value:this.DisplayName}),r.push({name:"EntityLogicalName",value:this.EntityLogicalName}),r.push({name:"LogicalName",value:this.LogicalName}),E.a.getInstance().reportFailure(t,n,"",r),n}O.a.instance.reportSuccess(t),Object(_.h)(t,"status",e)}}var D=n("Ae6N"),x=n("errb");class M extends I{constructor(e,t){super(e,t),this._clientApiExecutorDateTime=new r.b(e,"ClientApi.XrmDateTimeAttributeMetadata.")}get Behavior(){return this._clientApiExecutorDateTime.execute("Behavior",()=>{switch(this.attributeDescriptor.Behavior){case D.a.UserLocal:return 1;case D.a.DateOnly:return 2;case D.a.TimeZoneIndependent:return 3;default:return 0}})}get Format(){return this._clientApiExecutorDateTime.execute("Format",()=>{switch(this.attributeDescriptor.Format){case x.a.date:return"date";case x.a.dateTime:return"dateandtime"}return null})}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class F extends I{constructor(e,t){super(e,t),this._clientApiExecutorInteger=new r.b(e,"ClientApi.XrmIntegerAttributeMetadata.")}get Format(){return this._clientApiExecutorInteger.execute("Format",()=>this.attributeDescriptor.Format)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class k extends I{constructor(e,t,n){super(e,t),this._clientApiExecutorNonInteger=new r.b(e,n)}get Precision(){return this._clientApiExecutorNonInteger.execute("Precision",()=>this.attributeDescriptor.Precision)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class L extends k{constructor(e,t){super(e,t,"ClientApi.XrmDecimalAttributeMetadata.")}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class B extends k{constructor(e,t){super(e,t,"ClientApi.XrmDoubleAttributeMetadata.")}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class U extends k{constructor(e,t){super(e,t,"ClientApi.XrmMoneyAttributeMetadata."),this._clientApiExecutorMoney=new r.b(e,"ClientApi.XrmMoneyAttributeMetadata.")}get PrecisionSource(){return this._clientApiExecutorMoney.execute("PrecisionSource",()=>this.attributeDescriptor.PrecisionSource)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function V(e,t){t||Object(_.j)("ClientApi.XrmAttributeMetadataFactory.getAttributeMetadataInstance","attributeDescriptor");let n=null;switch(t.Type){case C.a.State:n=new A(e,t);break;case C.a.Status:n=new R(e,t);break;case C.a.MultiSelectPickList:case C.a.OptionSet:case C.a.PickList:n=new T(e,t);break;case C.a.Boolean:n=new j(e,t);break;case C.a.Lookup:n=new P(e,t);break;case C.a.DateTime:n=new M(e,t);break;case C.a.Decimal:n=new L(e,t);break;case C.a.Double:n=new B(e,t);break;case C.a.Money:n=new U(e,t);break;case C.a.Integer:n=new F(e,t);break;default:n=new I(e,t)}return n}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class z{constructor(e){this._behavior=null,this._group=null;e||Object(_.j)("ClientApi.XrmAssociatedMenuConfiguration.constructor","associatedMenuConfiguration"),this._associatedMenuConfiguration=e,this._availableOffline=e.AvailableOffline,this._icon=e.Icon,this._isCustomizable=e.IsCustomizable,this._label=e.Label,this._menuId=e.MenuId,this._order=e.Order,this._queryApi=e.QueryApi,this._viewId=e.ViewId?e.ViewId.guid:null}get AvailableOffline(){return O.a.instance.reportUsage("ClientApi.XrmAssociatedMenuConfiguration.AvailableOffline"),this._availableOffline}get Behavior(){const e="ClientApi.XrmAssociatedMenuConfiguration.Behavior";try{if(O.a.instance.reportCall(e),null===this._behavior)switch(this._associatedMenuConfiguration.Behavior){case 2:this._behavior=2;break;case 0:this._behavior=0;break;case 1:this._behavior=1;break;default:Object(_.h)(e,"Behavior",this._associatedMenuConfiguration.Behavior)}return O.a.instance.reportSuccess(e),this._behavior}catch(t){throw E.a.getInstance().reportFailure(e,t),t}}get Group(){const e="ClientApi.XrmAssociatedMenuConfiguration.Group";try{if(O.a.instance.reportCall(e),null===this._group)switch(this._associatedMenuConfiguration.Group){case 0:this._group=0;break;case 3:this._group=3;break;case 1:this._group=1;break;case 2:this._group=2;break;default:Object(_.h)(e,"Group",this._associatedMenuConfiguration.Group)}return O.a.instance.reportSuccess(e),this._group}catch(t){throw E.a.getInstance().reportFailure(e,t),t}}get Icon(){return O.a.instance.reportUsage("ClientApi.XrmAssociatedMenuConfiguration.Icon"),this._icon}get IsCustomizable(){return O.a.instance.reportUsage("ClientApi.XrmAssociatedMenuConfiguration.IsCustomizable"),this._isCustomizable}get Label(){return O.a.instance.reportUsage("ClientApi.XrmAssociatedMenuConfiguration.Label"),this._label}get MenuId(){return O.a.instance.reportUsage("ClientApi.XrmAssociatedMenuConfiguration.MenuId"),this._menuId}get Order(){return O.a.instance.reportUsage("ClientApi.XrmAssociatedMenuConfiguration.Order"),this._order}get QueryApi(){return O.a.instance.reportUsage("ClientApi.XrmAssociatedMenuConfiguration.QueryApi"),this._queryApi}get ViewId(){return O.a.instance.reportUsage("ClientApi.XrmAssociatedMenuConfiguration.ViewId"),this._viewId}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class q{constructor(e){this._securityTypes=null;e||Object(_.j)("ClientApi.XrmRelationshipMetadataBase.constructor","relationshipMetadata"),this.relationshipMetadata=e,this._introducedVersion=e.IntroducedVersion,this._isCustomizable=e.IsCustomizable,this._isCustomRelationship=e.IsCustomRelationship,this._isManaged=e.IsManaged,this._isValidForAdvancedFind=e.IsValidForAdvancedFind,this._schemaName=e.SchemaName}get IntroducedVersion(){return O.a.instance.reportUsage("ClientApi.XrmRelationshipMetadataBase.IntroducedVersion"),this._introducedVersion}get IsCustomizable(){return O.a.instance.reportUsage("ClientApi.XrmRelationshipMetadataBase.IsCustomizable"),this._isCustomizable}get IsCustomRelationship(){return O.a.instance.reportUsage("ClientApi.XrmRelationshipMetadataBase.IsCustomRelationship"),this._isCustomRelationship}get IsManaged(){return O.a.instance.reportUsage("ClientApi.XrmRelationshipMetadataBase.IsManaged"),this._isManaged}get IsValidForAdvancedFind(){return O.a.instance.reportUsage("ClientApi.XrmRelationshipMetadataBase.IsValidForAdvancedFind"),this._isValidForAdvancedFind}get SchemaName(){return O.a.instance.reportUsage("ClientApi.XrmRelationshipMetadataBase.SchemaName"),this._schemaName}get SecurityTypes(){const e="ClientApi.XrmRelationshipMetadataBase.SecurityTypes";try{if(O.a.instance.reportCall(e),null===this._securityTypes)switch(this.relationshipMetadata.SecurityTypes){case 1:this._securityTypes=1;break;case 8:this._securityTypes=8;break;case 0:this._securityTypes=0;break;case 2:this._securityTypes=2;break;case 4:this._securityTypes=4;break;default:Object(_.h)(e,"SecurityTypes",this.relationshipMetadata.SecurityTypes)}return O.a.instance.reportSuccess(e),this._securityTypes}catch(t){throw E.a.getInstance().reportFailure(e,t),t}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class H extends q{constructor(e){super(e),this._entity1IntersectAttribute=e.Entity1IntersectAttribute,this._entity1LogicalName=e.Entity1LogicalName,this._entity1NavigationPropertyName=e.Entity1NavigationPropertyName,this._entity2IntersectAttribute=e.Entity2IntersectAttribute,this._entity2LogicalName=e.Entity2LogicalName,this._entity2NavigationPropertyName=e.Entity2NavigationPropertyName,this._intersectEntityName=e.IntersectEntityName}get Entity1AssociatedMenuConfiguration(){const e="ClientApi.XrmManyToManyRelationshipMetadata.Entity1AssociatedMenuConfiguration";try{return O.a.instance.reportCall(e),null===this._entity1AssociatedMenuConfiguration&&(this._entity1AssociatedMenuConfiguration=new z(this._manyToManyRelationshipMetadata.Entity1AssociatedMenuConfiguration)),O.a.instance.reportSuccess(e),this._entity1AssociatedMenuConfiguration}catch(t){throw E.a.getInstance().reportFailure(e,t),t}}get Entity1IntersectAttribute(){return O.a.instance.reportUsage("ClientApi.XrmManyToManyRelationshipMetadata.Entity1IntersectAttribute"),this._entity1IntersectAttribute}get Entity1LogicalName(){return O.a.instance.reportUsage("ClientApi.XrmManyToManyRelationshipMetadata.Entity1LogicalName"),this._entity1LogicalName}get Entity1NavigationPropertyName(){return O.a.instance.reportUsage("ClientApi.XrmManyToManyRelationshipMetadata.Entity1NavigationPropertyName"),this._entity1NavigationPropertyName}get Entity2AssociatedMenuConfiguration(){const e="ClientApi.XrmManyToManyRelationshipMetadata.Entity2AssociatedMenuConfiguration";try{return O.a.instance.reportCall(e),null===this._entity2AssociatedMenuConfiguration&&(this._entity2AssociatedMenuConfiguration=new z(this._manyToManyRelationshipMetadata.Entity2AssociatedMenuConfiguration)),O.a.instance.reportSuccess(e),this._entity2AssociatedMenuConfiguration}catch(t){throw E.a.getInstance().reportFailure(e,t),t}}get Entity2IntersectAttribute(){return O.a.instance.reportUsage("ClientApi.XrmManyToManyRelationshipMetadata.Entity2IntersectAttribute"),this._entity2IntersectAttribute}get Entity2LogicalName(){return O.a.instance.reportUsage("ClientApi.XrmManyToManyRelationshipMetadata.Entity2LogicalName"),this._entity2LogicalName}get Entity2NavigationPropertyName(){return O.a.instance.reportUsage("ClientApi.XrmManyToManyRelationshipMetadata.Entity2NavigationPropertyName"),this._entity2NavigationPropertyName}get IntersectEntityName(){return O.a.instance.reportUsage("ClientApi.XrmManyToManyRelationshipMetadata.IntersectEntityName"),this._intersectEntityName}get RelationshipType(){return O.a.instance.reportUsage("ClientApi.XrmManyToManyRelationshipMetadata.RelationshipType"),1}get _manyToManyRelationshipMetadata(){return this.relationshipMetadata}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class W{constructor(e){this._assign=null,this._delete=null,this._merge=null,this._reparent=null,this._share=null,this._unshare=null;e||Object(_.j)("ClientApi.XrmCascadeConfiguration.constructor","cascadeConfiguration"),this._cascadeConfiguration=e}get Assign(){const e="ClientApi.XrmCascadeConfiguration.Assign";try{return O.a.instance.reportCall(e),null===this._assign&&(this._assign=G(e,this._cascadeConfiguration.Assign)),O.a.instance.reportSuccess(e),this._assign}catch(t){throw E.a.getInstance().reportFailure(e,t),t}}get Delete(){const e="ClientApi.XrmCascadeConfiguration.Delete";try{return O.a.instance.reportCall(e),null===this._delete&&(this._delete=G(e,this._cascadeConfiguration.Delete)),O.a.instance.reportSuccess(e),this._delete}catch(t){throw E.a.getInstance().reportFailure(e,t),t}}get Merge(){const e="ClientApi.XrmCascadeConfiguration.Merge";try{return O.a.instance.reportCall(e),null===this._merge&&(this._merge=G(e,this._cascadeConfiguration.Merge)),O.a.instance.reportSuccess(e),this._merge}catch(t){throw E.a.getInstance().reportFailure(e,t),t}}get Reparent(){const e="ClientApi.XrmCascadeConfiguration.Reparent";try{return O.a.instance.reportCall(e),null===this._reparent&&(this._reparent=G(e,this._cascadeConfiguration.Reparent)),O.a.instance.reportSuccess(e),this._reparent}catch(t){throw E.a.getInstance().reportFailure(e,t),t}}get Share(){const e="ClientApi.XrmCascadeConfiguration.Share";try{return O.a.instance.reportCall(e),null===this._share&&(this._share=G(e,this._cascadeConfiguration.Share)),O.a.instance.reportSuccess(e),this._share}catch(t){throw E.a.getInstance().reportFailure(e,t),t}}get Unshare(){const e="ClientApi.XrmCascadeConfiguration.Unshare";try{return O.a.instance.reportCall(e),null===this._unshare&&(this._unshare=G(e,this._cascadeConfiguration.Unshare)),O.a.instance.reportSuccess(e),this._unshare}catch(t){throw E.a.getInstance().reportFailure(e,t),t}}}function G(e,t){let n;switch(e+="._convertCascadeType",t){case 2:n=2;break;case 1:n=1;break;case 0:n=0;break;case 4:n=4;break;case 5:n=5;break;case 3:n=3;break;default:Object(_.h)(e,"cascadeType",t)}return n}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class K extends q{constructor(e){super(e),this._associatedMenuConfiguration=null,this._cascadeConfiguration=null,this._isHierarchical=e.IsHierarchical,this._referencedAttribute=e.ReferencedAttribute,this._referencedEntity=e.ReferencedEntity,this._referencedEntityNavigationPropertyName=e.ReferencedEntityNavigationPropertyName,this._referencingAttribute=e.ReferencingAttribute,this._referencingEntity=e.ReferencingEntity,this._referencingEntityNavigationPropertyName=e.ReferencingEntityNavigationPropertyName}get AssociatedMenuConfiguration(){const e="ClientApi.XrmOneToManyRelationshipMetadata.AssociatedMenuConfiguration";try{return O.a.instance.reportCall(e),null===this._associatedMenuConfiguration&&(this._associatedMenuConfiguration=new z(this._oneToManyRelationshipMetadata.AssociatedMenuConfiguration)),O.a.instance.reportSuccess(e),this._associatedMenuConfiguration}catch(t){throw E.a.getInstance().reportFailure(e,t),t}}get CascadeConfiguration(){const e="ClientApi.XrmOneToManyRelationshipMetadata.CascadeConfiguration";try{return O.a.instance.reportCall(e),null===this._cascadeConfiguration&&(this._cascadeConfiguration=new W(this._oneToManyRelationshipMetadata.CascadeConfiguration)),O.a.instance.reportSuccess(e),this._cascadeConfiguration}catch(t){throw E.a.getInstance().reportFailure(e,t),t}}get IsHierarchical(){return O.a.instance.reportUsage("ClientApi.XrmOneToManyRelationshipMetadata.IsHierarchical"),this._isHierarchical}get ReferencedAttribute(){return O.a.instance.reportUsage("ClientApi.XrmOneToManyRelationshipMetadata.ReferencedAttribute"),this._referencedAttribute}get ReferencedEntity(){return O.a.instance.reportUsage("ClientApi.XrmOneToManyRelationshipMetadata.ReferencedEntity"),this._referencedEntity}get ReferencedEntityNavigationPropertyName(){return O.a.instance.reportUsage("ClientApi.XrmOneToManyRelationshipMetadata.ReferencedEntityNavigationPropertyName"),this._referencedEntityNavigationPropertyName}get ReferencingAttribute(){return O.a.instance.reportUsage("ClientApi.XrmOneToManyRelationshipMetadata.ReferencingAttribute"),this._referencingAttribute}get ReferencingEntity(){return O.a.instance.reportUsage("ClientApi.XrmOneToManyRelationshipMetadata.ReferencingEntity"),this._referencingEntity}get ReferencingEntityNavigationPropertyName(){return O.a.instance.reportUsage("ClientApi.XrmOneToManyRelationshipMetadata.ReferencingEntityNavigationPropertyName"),this._referencingEntityNavigationPropertyName}get RelationshipType(){return O.a.instance.reportUsage("ClientApi.XrmOneToManyRelationshipMetadata.RelationshipType"),0}get _oneToManyRelationshipMetadata(){return this.relationshipMetadata}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Q(e){const t="ClientApi.XrmRelationshipMetadataFactory.getRelationshipMetadataInstance";e||Object(_.j)(t,"relationshipMetadata");let n=null;switch(e.RelationshipType){case 0:n=new K(e);break;case 1:n=new H(e);break;default:Object(_.h)(t,"RelationshipType",e.RelationshipType)}return n}var X=n("Sbn7"),Y=n("IaGr");let J;class ${constructor(e,t,n,r){const a="ClientApi.XrmEntityMetadata.constructor";e||Object(_.j)(a,"store"),t||Object(_.j)(a,"entityDescriptor"),n||Object(_.j)(a,"entityType"),J=e,this._entityDescriptor=t,this._entityType=n,this._attributes=r||[];const i=this._entityDescriptor.OwnershipType;this._activityTypeMask=this._entityDescriptor.ActivityTypeMask,this._autoRouteToOwnerQueue=this._entityDescriptor.AutoRouteToOwnerQueue,this._canEnableSyncToExternalSearchIndex=this._entityDescriptor.CanEnableSyncToExternalSearchIndex,this._canTriggerWorkflow=this._entityDescriptor.CanTriggerWorkflow,this._description=this._entityDescriptor.Description,this._displayCollectionName=this._entityDescriptor.DisplayCollectionName,this._displayName=this._entityDescriptor.DisplayName,this._enforceStateTransitions=this._entityDescriptor.EnforceStateTransitions,this._entityColor=this._entityDescriptor.EntityColor,this._entitySetName=this._entityDescriptor.EntitySetName,this._hasActivities=this._entityDescriptor.HasActivities,this._iconVectorName=this._entityDescriptor.IconVectorName,this._isActivity=this._entityDescriptor.IsActivity,this._isActivityParty=this._entityDescriptor.IsActivityParty,this._isBusinessProcessEnabled=this._entityDescriptor.IsBusinessProcessEnabled,this._isBPFEntity=this._entityDescriptor.IsBPFEntity,this._isChildEntity=this._entityDescriptor.IsChildEntity,this._isConnectionsEnabled=this._entityDescriptor.IsConnectionsEnabled,this._isCustomEntity=this._entityDescriptor.IsCustomEntity,this._isCustomizable=this._entityDescriptor.IsCustomizable,this._isDocumentManagementEnabled=this._entityDescriptor.IsDocumentManagementEnabled,this._isDocumentRecommendationsEnabled=this._entityDescriptor.IsDocumentRecommendationsEnabled,this._isDuplicateDetectionEnabled=this._entityDescriptor.IsDuplicateDetectionEnabled,this._isEnabledForCharts=this._entityDescriptor.IsEnabledForCharts,this._isImportable=this._entityDescriptor.IsImportable,this._isInteractionCentricEnabled=this._entityDescriptor.IsInteractionCentricEnabled,this._isKnowledgeManagementEnabled=this._entityDescriptor.IsKnowledgeManagementEnabled,this._isMailMergeEnabled=this._entityDescriptor.IsMailMergeEnabled,this._isManaged=this._entityDescriptor.IsManaged,this._isOneNoteIntegrationEnabled=this._entityDescriptor.IsOneNoteIntegrationEnabled,this._entityHelpUrlEnabled=this._entityHelpUrlEnabled,this._entityHelpUrl=this._entityDescriptor.EntityHelpUrl,this._isMSTeamsIntegrationEnabled=this._entityDescriptor.IsMSTeamsIntegrationEnabled,this._isOptimisticConcurrencyEnabled=this._entityDescriptor.IsOptimisticConcurrencyEnabled,this._isQuickCreateEnabled=this._entityDescriptor.IsQuickCreateEnabled,this._entityClientSetting=this._entityDescriptor.EntityClientSetting,this._isReadOnlyInMobileClient=this._entityDescriptor.IsReadOnlyInMobileClient,this._isStateModelAware=this._entityDescriptor.IsStateModelAware,this._isValidForAdvancedFind=this._entityDescriptor.IsValidForAdvancedFind,this._isVisibleInMobileClient=this._entityDescriptor.IsVisibleInMobileClient,this._isEnabledInUnifiedInterface=this._entityDescriptor.IsEnabledInUnifiedInterface,this._logicalName=this._entityDescriptor.EntityLogicalName,this._objectTypeCode=this._entityDescriptor.ObjectTypeCode,this._ownershipType=i,this._primaryIdAttribute=this._entityDescriptor.PrimaryIdAttribute,this._primaryImageAttribute=this._entityDescriptor.PrimaryImageAttribute,this._primaryNameAttribute=this._entityDescriptor.PrimaryNameAttribute}static getInstance(e,t,n){e||Object(_.j)("ClientApi.XrmEntityMetadata.getInstance","store"),t||Object(_.j)("ClientApi.XrmEntityMetadata.getInstance","entityType");const r=Object(v.h)(e.getState(),t);return r?new $(e,r,t,n):null}get ActivityTypeMask(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.ActivityTypeMask"),this._activityTypeMask}get AutoRouteToOwnerQueue(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.AutoRouteToOwnerQueue"),this._autoRouteToOwnerQueue}get CanEnableSyncToExternalSearchIndex(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.CanEnableSyncToExternalSearchIndex"),this._canEnableSyncToExternalSearchIndex}get CanTriggerWorkflow(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.CanTriggerWorkflow"),this._canTriggerWorkflow}get Description(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.Description"),this._description}get DisplayCollectionName(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.DisplayCollectionName"),this._displayCollectionName}get DisplayName(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.DisplayName"),this._displayName}get EnforceStateTransitions(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.EnforceStateTransitions"),this._enforceStateTransitions}get EntityColor(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.EntityColor"),this._entityColor}get EntitySetName(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.EntitySetName"),this._entitySetName}get HasActivities(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.HasActivities"),this._hasActivities}get IconVectorName(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.IconVectorName"),this._iconVectorName}get IsActivity(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.IsActivity"),this._isActivity}get IsActivityParty(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.IsActivityParty"),this._isActivityParty}get IsBusinessProcessEnabled(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.IsBusinessProcessEnabled"),this._isBusinessProcessEnabled}get IsBPFEntity(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.IsBPFEntity"),this._isBPFEntity}get IsChildEntity(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.IsChildEntity"),this._isChildEntity}get IsConnectionsEnabled(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.IsConnectionsEnabled"),this._isConnectionsEnabled}get IsCustomEntity(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.IsCustomEntity"),this._isCustomEntity}get IsCustomizable(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.IsCustomizable"),this._isCustomizable}get EntityHelpUrlEnabled(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.EntityHelpUrlEnabled"),this._entityHelpUrlEnabled}get EntityHelpUrl(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.EntityHelpUrl"),this._entityHelpUrl}get IsDocumentManagementEnabled(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.IsDocumentManagementEnabled"),this._isDocumentManagementEnabled}get IsDocumentRecommendationsEnabled(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.IsDocumentRecommendationsEnabled"),this._isDocumentRecommendationsEnabled}get IsDuplicateDetectionEnabled(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.IsDuplicateDetectionEnabled"),this._isDuplicateDetectionEnabled}get IsEnabledForCharts(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.IsEnabledForCharts"),this._isEnabledForCharts}get IsImportable(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.IsImportable"),this._isImportable}get IsInteractionCentricEnabled(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.IsInteractionCentricEnabled"),this._isInteractionCentricEnabled}get IsKnowledgeManagementEnabled(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.IsKnowledgeManagementEnabled"),this._isKnowledgeManagementEnabled}get IsMailMergeEnabled(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.IsMailMergeEnabled"),this._isMailMergeEnabled}get IsManaged(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.IsManaged"),this._isManaged}get IsOneNoteIntegrationEnabled(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.IsOneNoteIntegrationEnabled"),this._isOneNoteIntegrationEnabled}get IsMSTeamsIntegrationEnabled(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.IsMSTeamsIntegrationEnabled"),this._isMSTeamsIntegrationEnabled}get IsOptimisticConcurrencyEnabled(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.IsOptimisticConcurrencyEnabled"),this._isOptimisticConcurrencyEnabled}get IsQuickCreateEnabled(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.IsQuickCreateEnabled"),this._isQuickCreateEnabled}get EntityClientSetting(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.EntityClientSetting"),this._entityClientSetting}get IsReadOnlyInMobileClient(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.IsReadOnlyInMobileClient"),this._isReadOnlyInMobileClient}get IsStateModelAware(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.IsStateModelAware"),this._isStateModelAware}get IsValidForAdvancedFind(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.IsValidForAdvancedFind"),this._isValidForAdvancedFind}get IsVisibleInMobileClient(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.IsVisibleInMobileClient"),this._isVisibleInMobileClient}get IsEnabledInUnifiedInterface(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.IsEnabledInUnifiedInterface"),this._isEnabledInUnifiedInterface}get LogicalCollectionName(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.LogicalCollectionName"),this._logicalCollectionName}get LogicalName(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.LogicalName"),this._logicalName}get ObjectTypeCode(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.ObjectTypeCode"),this._objectTypeCode}get OwnershipType(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.OwnershipType"),this._ownershipType}get PrimaryIdAttribute(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.PrimaryIdAttribute"),this._primaryIdAttribute}get PrimaryImageAttribute(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.PrimaryImageAttribute"),this._primaryImageAttribute}get PrimaryNameAttribute(){return O.a.instance.reportUsage("ClientApi.XrmEntityMetadata.PrimaryNameAttribute"),this._primaryNameAttribute}get Privileges(){const e="ClientApi.XrmEntityMetadata.Privileges";try{if(O.a.instance.reportCall(e),!this._privileges&&this._entityDescriptor.Privileges){this._privileges=[];for(let e=0;e<this._entityDescriptor.Privileges.length;e++){const t={CanBeBasic:this._entityDescriptor.Privileges[e].CanBeBasic,CanBeDeep:this._entityDescriptor.Privileges[e].CanBeDeep,CanBeGlobal:this._entityDescriptor.Privileges[e].CanBeGlobal,CanBeLocal:this._entityDescriptor.Privileges[e].CanBeLocal,CanBeEntityReference:this._entityDescriptor.Privileges[e].CanBeEntityReference,CanBeParentEntityReference:this._entityDescriptor.Privileges[e].CanBeParentEntityReference,Name:this._entityDescriptor.Privileges[e].Name,PrivilegeId:this._entityDescriptor.Privileges[e].PrivilegeId,PrivilegeType:this._entityDescriptor.Privileges[e].PrivilegeType};this._privileges.push(t)}}else if(!this._entityDescriptor.Privileges)return Y.a.getInstance().traceManager.getTracer(e).error("this._entityDescriptor.Privileges is null or undefined ",[{name:"entityName",value:this._entityDescriptor.EntityLogicalName}]),[];return O.a.instance.reportSuccess(e),this._privileges}catch(t){throw E.a.getInstance().reportFailure(e,t),t}}get Attributes(){const e="ClientApi.XrmEntityMetadata.Attributes";try{if(O.a.instance.reportCall(e),!this._attributesMetadata&&(this._attributesMetadata=new X.a(e),this._attributes&&this._attributes.length>0)){const e=Object(S.d)(J.getState(),this._entityType);for(let t=0;t<this._attributes.length;t++){const n=e[this._attributes[t]];if(n){const e=V(J,n);this._attributesMetadata.add(this._attributes[t],e)}}}return O.a.instance.reportSuccess(e),this._attributesMetadata}catch(t){throw E.a.getInstance().reportFailure(e,t),t}}get ManyToManyRelationships(){const e="ClientApi.XrmEntityMetadata.ManyToManyRelationships";try{return O.a.instance.reportCall(e),this._manyToManyRelationships||(this._manyToManyRelationships=Z(this._entityDescriptor.ManyToManyRelationships,e)),O.a.instance.reportSuccess(e),this._manyToManyRelationships}catch(t){throw E.a.getInstance().reportFailure(e,t),t}}get ManyToOneRelationships(){const e="ClientApi.XrmEntityMetadata.ManyToOneRelationships";try{return O.a.instance.reportCall(e),this._manyToOneRelationships||(this._manyToOneRelationships=Z(this._entityDescriptor.ManyToOneRelationships,e)),O.a.instance.reportSuccess(e),this._manyToOneRelationships}catch(t){throw E.a.getInstance().reportFailure(e,t),t}}get OneToManyRelationships(){const e="ClientApi.XrmEntityMetadata.OneToManyRelationships";try{return O.a.instance.reportCall(e),this._oneToManyRelationships||(this._oneToManyRelationships=Z(this._entityDescriptor.OneToManyRelationships,e)),O.a.instance.reportSuccess(e),this._oneToManyRelationships}catch(t){throw E.a.getInstance().reportFailure(e,t),t}}}function Z(e,t){let n;if(e&&Object.keys(e).length>0){n=new X.a(t);for(const t in e){const r=e[t];if(r){const e=Q(r);n.add(t,e)}}}return n}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class ee{constructor(e){var t;e||Object(_.j)("ClientApi.XrmEntityFormMetadata.constructor","formDescriptor"),this._id=e.Id,this._label=e.Label,this._name=e.Name,this._entityLogicalName=e.EntityLogicalName,this._showLabel=e.ShowLabel,this._visible=e.Visible,this._attributes=e.Attributes;const n={};for(const r in e.Sections){const a=e.Sections[r],i={AvailableForPhone:a.AvailableForPhone,Label:a.Label,Name:a.Name,ShowLabel:a.ShowLabel,Visible:a.Visible,Rows:null===(t=a.Rows)||void 0===t?void 0:t.map(e=>{var t;const n={};return n.Visible=e.Visible,n.Cells=null===(t=e.Cells)||void 0===t?void 0:t.map(e=>({AvailableForPhone:e.AvailableForPhone,ControlName:e.ControlName,ShowLabel:e.ShowLabel,Visible:e.Visible})),n})};n[r]=i}this._sections=n}get Id(){return O.a.instance.reportUsage("ClientApi.XrmEntityFormMetadata.Id"),this._id}get Label(){return O.a.instance.reportUsage("ClientApi.XrmEntityFormMetadata.Label"),this._label}get Name(){return O.a.instance.reportUsage("ClientApi.XrmEntityFormMetadata.Name"),this._name}get EntityLogicalName(){return O.a.instance.reportUsage("ClientApi.XrmEntityFormMetadata.EntityLogicalName"),this._entityLogicalName}get ShowLabel(){return O.a.instance.reportUsage("ClientApi.XrmEntityFormMetadata.ShowLabel"),this._showLabel}get Visible(){return O.a.instance.reportUsage("ClientApi.XrmEntityFormMetadata.Visible"),this._visible}get Attributes(){return O.a.instance.reportUsage("ClientApi.XrmEntityFormMetadata.Attributes"),this._attributes}get Sections(){return O.a.instance.reportUsage("ClientApi.XrmEntityFormMetadata.Sections"),this._sections}}var te=n("VDDv"),ne=n("2QCH"),re=n("9A3e"),ae=n("8MGk"),ie=n("IpQH"),oe=n("uM6Y"),se=n("VkXQ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class ce extends ie.a{constructor(e,t){super(e,t,oe.g)}getCurrentPosition(){return this.execute(se.g.getCurrentPosition.name,"GeolocationCode",{})}}var le=n("a475"),ue=n("2yvP");let de,pe;class fe{constructor(e,t){de=e,this._context=t}static getInstance(e,t){const n="ClientApi.XrmDevice.getInstance";e||Object(_.j)(n,"store"),t||Object(_.j)(n,"context");try{return pe||(pe=new fe(e,t)),pe}catch(e){throw E.a.getInstance().reportFailure(n,e),e}}captureImage(e){const t="ClientApi.XrmDevice.captureImage",n=Object(ue.a)();try{O.a.instance.reportCall(t);return new te.a(this._context,de).takePicture(e).then(e=>(O.a.instance.reportSuccess(t,n),e)).catch(e=>Object(_.d)(de,e,t,null,!0,!0,null,n))}catch(e){return Object(_.d)(de,e,t,null,!0,!0,null,n)}}captureAudio(e){const t="ClientApi.XrmDevice.captureAudio",n=Object(ue.a)();try{O.a.instance.reportCall(t);return new te.a(this._context,de).captureAudio(e).then(e=>(O.a.instance.reportSuccess(t,n),e)).catch(e=>Object(_.d)(de,e,t,null,!0,!0,null,n))}catch(e){return Object(_.d)(de,e,t,null,!0,!0,null,n)}}captureVideo(e){const t="ClientApi.XrmDevice.captureVideo",n=Object(ue.a)();try{O.a.instance.reportCall(t);return new te.a(this._context,de).captureVideo(e).then(e=>(O.a.instance.reportSuccess(t,n),e)).catch(e=>Object(_.d)(de,e,t,null,!0,!0,null,n))}catch(e){return Object(_.d)(de,e,t,null,!0,!0,null,n)}}pickFile(e){const t="ClientApi.XrmDevice.pickFile",n=Object(ue.a)();try{O.a.instance.reportCall(t);return new ae.a(this._context,de).pickFile(e).then(e=>(O.a.instance.reportSuccess(t,n),e)).catch(e=>Object(_.d)(de,e,t,null,!0,!0,null,n))}catch(e){return Object(_.d)(de,e,t,null,!0,!0,null,n)}}getBarcodeValue(){const e="ClientApi.XrmDevice.getBarcodeValue",t=Object(ue.a)();try{O.a.instance.reportCall(e);return new re.a(this._context,de).getBarcodeValue().then(n=>(O.a.instance.reportSuccess(e,t),n)).catch(n=>Object(_.d)(de,n,e,null,!0,!0,null,t))}catch(n){return Object(_.d)(de,n,e,null,!0,!0,null,t)}}getCurrentPosition(){const e="ClientApi.XrmDevice.getCurrentPosition",t=Object(ue.a)();try{O.a.instance.reportCall(e);return new ce(this._context,de).getCurrentPosition().then(n=>(O.a.instance.reportSuccess(e,t),n)).catch(n=>Object(_.d)(de,(null==n?void 0:n.displayMessage)?n:Object.assign(Object.assign({},n),{displayMessage:null==n?void 0:n.message}),e,null,!0,!0,null,t))}catch(n){return Object(_.d)(de,n,e,null,!0,!0,null,t)}}async openARViewer(e){const t="ClientApi.XrmDevice.openARViewer",n=Object(ue.a)();try{O.a.instance.reportCall(t);const r=new ne.a(this._context,de),a=await r.openARViewer(e);return O.a.instance.reportSuccess(t,n),a}catch(e){return Object(_.d)(de,e,t,null,!0,!0,null,n)}}tryShowRatingPrompt(){const e="ClientApi.XrmDevice.tryShowRatingPrompt";try{O.a.instance.reportCall(e);const t=le.a.get_Instance().get_device();t.get_IsAvailable()&&t.postMessage(JSON.stringify({name:"tryShowRatingPrompt"})),O.a.instance.reportSuccess(e)}catch(t){throw E.a.getInstance().reportFailure(e,t),t}}}var ge=n("VCkP"),he=n("0cBP"),me=n("nVeB"),be=n("jCkl"),ye=n("yJdb"),_e=n("+nNZ"),ve=n("NjDY"),Se=n("RiHV"),Oe=n("Uv1Y"),Ce=n("UwOy"),Ee=n("OEF1"),Ie=n("umme"),we=n("PR89"),je=n("MIBb"),Pe=n("BJ7u"),Te=n("eq+S"),Ne=n("eXjw"),Ae=n("amNf");let Re;class De{constructor(e,t,n,a,i){this._cancelButtonID="Button_Cancel",this._okButtonId="A4A4842B-7564-4BCF-B21D-4D6A78F17BE1",this._clientApiExecutor=new r.b(Re,"ClientApi.XrmUtility.");const o=this._clientApiExecutor.getComponentName("constructor");Object(_.g)(e,o,"store"),Object(_.g)(t,o,"globalContext"),Object(_.g)(n,o,"applicationContext"),Object(_.g)(a,o,"navigation"),Re=e,this._xrmDevice=fe.getInstance(e,n),this._globalContext=t,this._applicationContext=n,this._navigation=a,this._pageId=i}getGlobalContext(){return O.a.instance.reportUsage("ClientApi.XrmUtility.getGlobalContext"),this._globalContext}lookupObjects(e){return this._clientApiExecutor.executeAsync("lookupObjects",(t,n)=>(0===e.entityTypes.length&&Object(_.e)(t,"entityTypes cannot be empty."),Object(me.a)(e,this._pageId,Re.dispatch)),[{name:"lookupOptions",value:e,isRequired:!0},{name:"entityTypes",value:e&&e.entityTypes,isRequired:!0}])}openEntityForm(e,t,n,r){const a="ClientApi.XrmUtility.openEntityForm";t&&!s.a.tryParseOrNull(t)&&Object(_.h)(a,"id",t);try{O.a.instance.reportCall(a);const i={entityName:e,entityId:t,formId:n&&n.formid?n.formid:void 0,navbar:n&&n.navbar?n.navbar:void 0,cmdbar:!(n&&("false"===n.cmdbar||!1===n.cmdbar)),width:r&&r.width?r.width:void 0,height:r&&r.height?r.height:void 0,openInNewWindow:!(!r||!r.openInNewWindow)&&r.openInNewWindow};this._navigation.openForm(i,n),O.a.instance.reportSuccess(a)}catch(e){throw E.a.getInstance().reportFailure(a,e),e}}openQuickCreate(e,t,n){return this._clientApiExecutor.executeAsync("openQuickCreate",(r,a)=>{t&&!s.a.tryParseOrNull(t.id)?Object(_.h)(r,"createFromEntity.id",t.id,a):t&&!t.entityType&&Object(_.h)(r,"createFromEntity.entityType",t.entityType,a);const i={entityName:e,showDialog:!0,createFromEntity:t};return this._navigation.openForm(i,n).then(e=>{var t;let n=null;return(null===(t=null==e?void 0:e.savedEntityReference)||void 0===t?void 0:t[0])&&(n={savedEntityReference:e.savedEntityReference[0]}),n})},[{name:"entityLogicalName",value:e,isEventParam:!0}])}openWebResource(e,t,n,r){const a="ClientApi.XrmUtility.openWebResource";try{O.a.instance.reportCall(a);const i={height:r,width:n};this._navigation.openWebResource(e,i,t),O.a.instance.reportSuccess(a)}catch(e){throw E.a.getInstance().reportFailure(a,e),e}}alertDialog(e,t){this._clientApiExecutor.executeAsync("alertDialog",(n,a)=>{const i={},o={};i.text=e;const s=[this._okButtonId];return Re.dispatch(Object(d.e)(s)).then(()=>(i.confirmButtonLabel=Object(c.b)(Re.getState(),this._okButtonId),this._navigation.openAlertDialog(i,o).then(()=>{t&&Object(r.c)(n,a,()=>{t()})})))},[{name:"message",value:e,isRequired:!0}])}confirmDialog(e,t,n){this._clientApiExecutor.executeAsync("confirmDialog",(a,i)=>{const o={},s={};o.text=e;const l=[this._okButtonId,this._cancelButtonID];return Re.dispatch(Object(d.e)(l)).then(()=>(o.confirmButtonLabel=Object(c.b)(Re.getState(),this._okButtonId),o.cancelButtonLabel=Object(c.b)(Re.getState(),this._cancelButtonID),this._navigation.openConfirmDialog(o,s).then(e=>{e.confirmed?t&&(i.push({name:"button",value:"yes"}),Object(r.c)(a,i,()=>{t()})):n&&(i.push({name:"button",value:"no"}),Object(r.c)(a,i,()=>{n()}))})))},[{name:"message",value:e,isRequired:!0}])}isActivityType(e){const t="ClientApi.XrmUtility.isActivityType";e||Object(_.j)(t,"entityLogicalName");try{O.a.instance.reportCall(t);const n=Object(v.r)(Re.getState(),e);return O.a.instance.reportSuccess(t),n}catch(e){throw E.a.getInstance().reportFailure(t,e),e}}getBarcodeValue(){const e="ClientApi.XrmUtility.getBarcodeValue";try{return O.a.instance.reportCall(e),this._xrmDevice.getBarcodeValue().then(t=>(O.a.instance.reportSuccess(e),t)).catch(t=>Object(_.d)(Re,t,e+".getBarcodeValue"))}catch(t){return Object(_.d)(Re,t,e)}}getCurrentPosition(){const e="ClientApi.XrmUtility.getCurrentPosition";try{return O.a.instance.reportCall(e),this._xrmDevice.getCurrentPosition().then(t=>(O.a.instance.reportSuccess(e),t)).catch(t=>Object(_.d)(Re,t,e+".getCurrentPosition"))}catch(t){return Object(_.d)(Re,t,e)}}getEntityMetadata(e,t){return this._clientApiExecutor.executeAsync("getEntityMetadata",()=>{if(!e)throw Oe.a.fromErrorCode(Re.getState(),-2147098612,e);return t||(t=[]),-1!==t.indexOf("statecode")&&-1===t.indexOf("statuscode")&&t.push("statuscode"),Re.dispatch(Object(f.f)(e,!1,t,this._pageId)).then(()=>$.getInstance(Re,e,t))},[{name:"entityType",value:e,isRequired:!0}])}getEntityMainFormDescriptor(e,t){return this._clientApiExecutor.executeAsync("getEntityDefaultMainFormDescriptor",()=>{if(!e)throw Oe.a.fromErrorCode(Re.getState(),-2147098612,String(e));const n=Object(Pe.a)(Te.a.main);let r=s.a.tryParseOrNull(t);return s.a.isNullOrEmpty(r)&&(r=Object(y.f)(Re.getState(),e,n)),s.a.isNullOrEmpty(r)||Object(y.m)(Re.getState(),r)!==Ne.a.Initialized?Re.dispatch(Object(g.b)("form",n,e,s.a.toLegacyGuid(r),s.a.isNullOrEmpty(r),m.a.OnDemandWithContext,null,null,[],h.b.Form,b.a.LocalAndRemote)).then(()=>this._getEntityFormDescriptor(e,r,n)):Promise.resolve(Object(this._getEntityFormDescriptor(e,r,n)))},[{name:"entityName",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"string"}])}_getEntityFormDescriptor(e,t,n){const r=Object(y.q)(Re.getState(),t,e,n);if(r){return new ee(r)}return null}getEntitiesMetadata(e){return this._clientApiExecutor.executeAsync("getEntitiesMetadata",(t,n)=>Re.dispatch(Object(f.e)(e,this._pageId)).then(()=>{const r=[];for(const a in e){const i=e[a];-1!==i.indexOf("statecode")&&-1===i.indexOf("statuscode")&&i.push("statuscode");const o=$.getInstance(Re,a,i);if(!o){const e=new Oe.a("Entity name doesn't exist",2147750146);return n.push({name:"entityType",value:a}),Object(_.d)(Re,e,t+".getEntitiesMetadata",n,!1)}r.push(o)}return r}),[{name:"entityToAttributes",value:e,isRequired:!0}])}getResourceString(e,t){const n="ClientApi.XrmUtility.getResourceString";e||Object(_.j)(n,"webResourceName"),t||Object(_.j)(n,"key");try{O.a.instance.reportCall(n);const r=Object(l.b)(Re.getState(),e);if(r){const e=r[t];return O.a.instance.reportSuccess(n),e}const a=[];a.push({name:"webResourceName",value:e}),a.push({name:"validationError",value:"true"}),Y.a.getInstance().traceManager.getTracer(n).error("Resx web resource could not be found",a),O.a.instance.reportSuccess(n)}catch(r){const a=[];throw a.push({name:"key",value:t}),a.push({name:"webResourceName",value:e}),E.a.getInstance().reportFailure(n,r,null,a),r}throw new Error(`'${e}' does not exist.`)}showHierarchyPage(e,t){O.a.instance.reportUsage("ClientApi.XrmUtility.showHierarchyPage")}showProgressIndicator(e){const t="ClientApi.XrmUtility.showProgressIndicator";try{O.a.instance.reportCall(t),Re.dispatch(Object(be.b)(e)),O.a.instance.reportSuccess(t)}catch(e){throw E.a.getInstance().reportFailure(t,e),e}}closeProgressIndicator(){const e="ClientApi.XrmUtility.closeProgressIndicator";try{O.a.instance.reportCall(e),Re.dispatch(Object(ye.b)()),O.a.instance.reportSuccess(e)}catch(t){throw E.a.getInstance().reportFailure(e,t),t}}beginSecureSessionForResource(e,t,n,r){const a="ClientApi.XrmUtility.beginSecureSessionForResource",i=[{name:"resource",value:e},{name:"cookieName",value:t},{name:"cookieDomain",value:n},{name:"allowPrompt",value:r?"true":"false"}];try{O.a.instance.reportCall(a);const o=new ge.a(this._applicationContext,Re);return r?o.beginSecureSessionForResource(e,t,n).then(e=>(O.a.instance.reportSuccess(a),e)).catch(e=>Object(_.d)(Re,e,a+".beginSecureSessionForResource",i)):o.beginSecureSessionForResourceSilent(e,t,n).then(e=>(O.a.instance.reportSuccess(a),e)).catch(e=>Object(_.d)(Re,e,a+".beginSecureSessionForResourceSilent",i))}catch(e){return Object(_.d)(Re,e,a,i)}}getAllowedStatusTransitions(e,t){const n="ClientApi.XrmUtility.getAllowedStatusTransitions";e||Object(_.j)(n,"entityLogicalName"),Object(_.a)(t)&&Object(_.j)(n,"statusCode");try{O.a.instance.reportCall(n);const r=Object(he.b)(Re.getState(),e,t);return Promise.resolve(r).then(e=>(O.a.instance.reportSuccess(n),e)).catch(r=>{const a=[];return a.push({name:"entityLogicalName",value:e}),a.push({name:"statusCode",value:t}),Object(_.d)(Re,r,n+".getAllowedStatusTransitions",a)})}catch(r){const a=[];return a.push({name:"entityLogicalName",value:e}),a.push({name:"statusCode",value:t}),Object(_.d)(Re,r,n,a)}}invokeProcessAction(e,t){return this._clientApiExecutor.executeAsync("invokeProcessAction",()=>this.invokeProcessActionInternal(e,t,null),[{name:"name",value:e,isEventParam:!0}])}invokeProcessActionInternal(e,t,n=null){return this._clientApiExecutor.executeAsync("invokeProcessActionInternal",(r,a)=>t&&t.Target?this._getCurrentProcessIdValue(t.BusinessProcessFlowId).then(i=>{if(!i)return Object(_.d)(Re,{errorCode:2147746581,code:2147746581},r,a);const o=t.Target,l="Microsoft.Dynamics.CRM."+o.entityType,u=Object(_e.a)(Re.getState(),new s.a(i));let d=n;if(u&&u.businessProcessFlowActions){const t=u.businessProcessFlowActions;for(const n of Object.keys(t))t[n].uniqueName===e&&(d=t[n])}const f=Object.keys(t).length-3;(!d||f>Object.keys(d.inputParameters).length)&&(this._navigation.openErrorDialog({message:Object(c.b)(Re.getState(),"Error_Message_0x80060375"),errorCode:2147877749}),Object(_.e)(r,Object(c.b)(Re.getState(),"Error_Title_0x80060375")));const g={entity:{typeName:l,structuralProperty:5},BusinessProcessFlowId:{typeName:"Edm.String",structuralProperty:1},BusinessProcessFlowInstanceId:{typeName:"Edm.String",structuralProperty:1},ActionStepId:{typeName:"Edm.String",structuralProperty:1}};this._buildParameterDescriptors(g,t,d),this._convertParameterValuesToCompatibleFormat(t,d);const h={boundParameter:"entity",operationName:e,operationType:0,parameterTypes:g},m=Object.assign({getMetadata:()=>h,entity:o},t);return this._setPropertyNonEnumerable(m,"getMetadata"),this._setPropertyNonEnumerable(m,"Target"),Re.dispatch(Object(p.b)(m,this._pageId)).then(e=>e.text().then(e=>this._buildProcessActionResponse(e))).catch(e=>{var t,n;let i=0;return i=e instanceof Ie.a?e.get_HttpStatusCode():e instanceof Oe.a?e.httpStatusCode:null===(n=null===(t=e.get_request)||void 0===t?void 0:t.call(e))||void 0===n?void 0:n.status,404===i?Object(_.d)(Re,{errorCode:2147766354,code:2147766354},r,a):Object(_.d)(Re,e,r+".executeODataAction",a)})}):Object(_.d)(Re,{errorCode:2147746581,code:2147746581},r,a),[{name:"name",value:e,isEventParam:!0}])}_getCurrentProcessIdValue(e){if(e)return Promise.resolve(e);const t=window.parent.getCurrentXrm();return t.Page.data.process&&t.Page.data.process.getActiveProcess()?Promise.resolve(t.Page.data.process.getActiveProcess().getId()):Promise.resolve("")}_buildProcessActionResponse(e){let t={};""!==e&&("string"==typeof e?t=JSON.parse(e):e&&204!==e.status&&(t=e));const n={};Object.keys(t).forEach(e=>{n[e]=t[e]});return{get_outputParameters:()=>n}}_setPropertyNonEnumerable(e,t){const n=Object.getOwnPropertyDescriptor(e,t);n.enumerable=!1,Object.defineProperty(e,t,n)}_buildParameterDescriptors(e,t,n){for(const r of Object.keys(t))if(n&&n.inputParameters&&r in n.inputParameters){const t=n.inputParameters[r];e[r]={typeName:t.parameterType,structuralProperty:t.parameterStructuralProperty}}}_convertParameterValuesToCompatibleFormat(e,t){if(!Object(_.a)(t))for(const n of Object.keys(e))n in t.inputParameters&&"Edm.Boolean"===t.inputParameters[n].parameterType&&(e[n]=Boolean(Number(e[n])))}refreshParentGrid(e){const t="ClientApi.XrmUtility.refreshParentGrid";e&&e.entityType||Object(_.j)(t,"lookupValue or lookupValue.entityType");try{O.a.instance.reportCall(t),Re.dispatch(Object(u.a)(e.entityType)).then(()=>{O.a.instance.reportSuccess(t)}).catch(e=>Object(_.d)(Re,e,t))}catch(e){throw E.a.getInstance().reportFailure(t,e),e}}getLearningPathAttributeName(){const e="ClientApi.XrmUtility.getLearningPathAttributeName";try{O.a.instance.reportCall(e);const t=Se.a.LearningPathDOMAttributeName;return O.a.instance.reportSuccess(e),t}catch(t){E.a.getInstance().reportFailure(e,t)}}getPageContext(){return this._clientApiExecutor.execute("getPageContext",()=>(this._pageContext||(this._pageContext=new we.b(Re,this._pageId)),this._pageContext))}executeFunction(e,t,n,r){const a=[{name:"webResource",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"string"},{name:"method",value:t,isRequired:!0,isEventParam:!0,expectedDataType:"string"},{name:"runSync",value:r,isEventParam:!0,expectedDataType:"boolean"},{name:"pageId",value:this._pageId,isRequired:!0,isEventParam:!0,expectedDataType:"string"}];return r?this._clientApiExecutor.execute("executeFunction",(r,a)=>{Object(Ee.e)(Re.getState())!==Ce.a&&Object(_.e)(r,"Sync option is only available in USD",null,a);const i=Object(je.a)(r,Re.getState(),this._applicationContext,this._pageId,a);if(!i)throw Object(o.d)("Container does not exist",2415919125);const s=Object(ve.x)(Re.getState());return i.loadWebResourceSync_DO_NOT_USE(s+e),i.executeSync_DO_NOT_USE(t,n,!0)},a):this._clientApiExecutor.executeAsync("executeFunction",(r,a)=>{const i=Object(je.a)(r,Re.getState(),this._applicationContext,this._pageId,a);if(!i)throw Object(o.d)("Container does not exist",2415919125);return i.getEventManager().loadWebResources(Re.dispatch,this._applicationContext,this._pageId,Re.getState,[e],null,null,[]).then(()=>i.execute(t,n,!0))},a)}convertUrlToPageInput(e){return this._clientApiExecutor.execute("getPageInputFromUrl",(t,n)=>{const r=this._applicationContext.Router.getPageMappings().getPageFromUrl(e);return Object(Ae.b)(Re.getState(),r.input,t,n)||null},[{name:"url",value:e,isRequired:!0}])}}var xe=n("ScZZ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var Me=n("amok");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let Fe,ke;class Le{constructor(e,t){Fe=e,this._context=t,this._clientApiExecutor=new r.b(e,"ClientApi.XrmApplicationUI.")}static getInstance(e,t){if(!ke){const n="ClientApi.XrmApplicationUI.getInstance";Object(_.g)(e,n,"store"),ke=new Le(e,t)}return ke}addGlobalNotification(e,t,n,r,a,i){return this._clientApiExecutor.execute("addGlobalNotification",()=>{let o;return o=e&&"object"==typeof e?e:{type:e,level:t,message:n,title:r,action:a,onCloseHandler:i},Me.a.getInstance(Fe,this._context).addGlobalNotification(o)})}clearGlobalNotification(e){return this._clientApiExecutor.execute("clearGlobalNotification",()=>Me.a.getInstance(Fe,this._context).clearGlobalNotification(e))}clearGlobalNotifications(){return this._clientApiExecutor.execute("clearGlobalNotifications",()=>Fe.dispatch({type:"clear.toastNotificationsAction.async",execute({dispatch:e}){const t={type:xe.b,payload:""};return Promise.resolve(e(t))}}))}}var Be=n("rQHy");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let Ue;class Ve{constructor(e,t){if(!e){const e="ClientApi.XrmGridPageFormUI.constructor";Object(_.j)(e,"store")}Ue=e,this._pageId=t}get controls(){return O.a.instance.reportUsage("ClientApi.XrmGridPageFormUI.controls"),null}get headerSection(){return O.a.instance.reportUsage("ClientApi.XrmGridPageFormUI.headerSection"),null}get footerSection(){return O.a.instance.reportUsage("ClientApi.XrmGridPageFormUI.footerSection"),null}get formSelector(){return O.a.instance.reportUsage("ClientApi.XrmGridPageFormUI.formSelector"),null}get navigation(){return O.a.instance.reportUsage("ClientApi.XrmGridPageFormUI.navigation"),null}get process(){return O.a.instance.reportUsage("ClientApi.XrmGridPageFormUI.process"),null}get tabs(){return O.a.instance.reportUsage("ClientApi.XrmGridPageFormUI.tabs"),null}get quickForms(){return O.a.instance.reportUsage("ClientApi.XrmGridPageFormUI.quickForms"),null}clearFormNotification(e){return O.a.instance.reportUsage("ClientApi.XrmGridPageFormUI.clearFormNotification"),null}close(){O.a.instance.reportUsage("ClientApi.XrmGridPageFormUI.close")}getFormType(){return O.a.instance.reportUsage("ClientApi.XrmGridPageFormUI.getFormType"),null}isDialog(){return O.a.instance.reportUsage("ClientApi.XrmGridPageFormUI.isDialog"),null}getViewPortHeight(){return O.a.instance.reportUsage("ClientApi.XrmGridPageFormUI.getViewPortHeight"),null}getViewPortWidth(){return O.a.instance.reportUsage("ClientApi.XrmGridPageFormUI.getViewPortWidth"),null}refreshRibbon(e=!1){const t="ClientApi.XrmGridPageFormUI.refreshRibbon";try{O.a.instance.reportCall(t),Ue.dispatch(Object(Be.a)(this._pageId,null,e)).then(()=>{O.a.instance.reportSuccess(t)}).catch(e=>{const n=E.a.getInstance().getEventParameters(this.contextToken);return Object(_.d)(Ue,e,t+".refreshCommandManager",n)})}catch(e){const n=E.a.getInstance().getEventParameters(this.contextToken);throw E.a.getInstance().reportFailure(t,e,null,n),e}}setFormEntityName(e){O.a.instance.reportUsage("ClientApi.XrmGridPageFormUI.setFormEntityName")}setFormNotification(e,t,n){return O.a.instance.reportUsage("ClientApi.XrmGridPageFormUI.setFormNotification"),null}get contextToken(){return null}addOnLoad(e){O.a.instance.reportUsage("ClientApi.XrmGridPageFormUI.addOnLoad")}removeOnLoad(e){O.a.instance.reportUsage("ClientApi.XrmGridPageFormUI.removeOnLoad")}get formContext(){return O.a.instance.reportUsage("ClientApi.XrmGridPageFormUI.formContext"),null}refresh(){return O.a.instance.reportUsage("ClientApi.XrmGridPageFormUI.refresh"),null}getControls(){return O.a.instance.reportUsage("ClientApi.XrmGridPageFormUI.getControls"),null}}var ze=n("3yqi"),qe=n("arV0"),He=n("OQLa"),We=n("deGN");let Ge;class Ke{constructor(e,t){if(!e){const e="ClientApi.XrmGridPageForm.constructor";Object(_.j)(e,"store")}Ge=e,this._pageId=t}get context(){return O.a.instance.reportUsage("ClientApi.XrmGridPageForm.context.get"),this._globalContext}set context(e){this._globalContext=e}get data(){return O.a.instance.reportUsage("ClientApi.XrmGridPageForm.data"),null}get ui(){const e="ClientApi.XrmGridPageForm.ui";try{return O.a.instance.reportCall(e),this._ui||(this._ui=new Ve(Ge,this._pageId)),O.a.instance.reportSuccess(e),this._ui}catch(t){throw E.a.getInstance().reportFailure(e,t),t}}get entityReference(){return O.a.instance.reportUsage("ClientApi.XrmGridPageForm.entityReference"),null}getControl(e){return O.a.instance.reportUsage("ClientApi.XrmGridPageForm.getControl"),null}getAttribute(e){return O.a.instance.reportUsage("ClientApi.XrmGridPageForm.getAttribute"),null}getUrl(e){const t="ClientApi.XrmGridPageForm.getUrl";if(!this._pageId)throw Y.a.getInstance().traceManager.getTracer(t+".pageId").error("Missing pageId"),new Error("getUrl was called on a page where Client API was not initialized properly.");let n=null;try{if(O.a.instance.reportCall(t),n=Object(qe.p)(Ge.getState(),this._pageId),n===ze.a.Dashboard||n===ze.a.Grid){const r=Object(qe.j)(Ge.getState(),this._pageId);if(1===e){const e=Ge.dispatch(Object(He.a)(n,r));return O.a.instance.reportSuccess(t),e}const a=Object(We.a)(Ge,this._pageId),i=Ge.dispatch(Object(He.c)(a,n,r));return O.a.instance.reportSuccess(t),i}O.a.instance.reportSuccess(t)}catch(e){throw E.a.getInstance().reportFailure(t,e),e}const r=[];r.push({name:"pageType",value:n});const a="getUrl is not supported for this page type",i=`${a}: ${n}`;Object(_.e)(t,i,a,r)}}var Qe=n("9n4z"),Xe=n("B3HF"),Ye=n("rcL5"),Je=n("/leX"),$e=n("nJrx"),Ze=n("dNvO"),et=n("5X+N");let tt,nt,rt;class at{constructor(e,t){this._store=e,this._clientApiExecutor=new r.b(this._store,"ClientApi.XrmPanel.");const n=this._clientApiExecutor.getComponentName("constructor");Object(_.g)(e,n,"store"),Object(_.g)(t,n,"context"),this._onChannelMessageRecieved=this._onChannelMessageRecieved.bind(this),this._channel=t.ChannelManager.createChannel(Object($e.a)(),this._onChannelMessageRecieved)}static getInstance(e,t){return rt||(rt=new at(e,t)),rt}set position(e){this._clientApiExecutor.execute("position_set",()=>{this._legacyPanelId&&tt&&this._store.dispatch(tt(this._legacyPanelId,{sidePanelPosition:e}))},[{name:"panelPosition",value:e,isRequired:!0,isEventParam:!0}])}get position(){return this._clientApiExecutor.execute("position_get",()=>this._legacyPanelId?Object(Ye.i)(this._store.getState(),this._legacyPanelId).option.sidePanelPosition:1)}set state(e){this._clientApiExecutor.execute("state_set",()=>{this._legacyPanelId&&tt&&this._store.dispatch(tt(this._legacyPanelId,{sidePanelState:e}))},[{name:"panelState",value:e,isRequired:!0,isEventParam:!0}])}get state(){return this._clientApiExecutor.execute("state_get",()=>this._legacyPanelId?Object(Ye.b)(this._store.getState(),this._legacyPanelId).option.sidePanelState:2)}set title(e){this._clientApiExecutor.execute("title_set",()=>{this._legacyPanelId&&tt&&this._store.dispatch(tt(this._legacyPanelId,{sidePanelTitle:e}))},[{name:"panelTitle",value:e,isRequired:!0,expectedDataType:"string"}])}get title(){return this._clientApiExecutor.execute("title_get",()=>this._legacyPanelId?Object(Ye.i)(this._store.getState(),this._legacyPanelId).option.sidePanelTitle:"")}get url(){return this._clientApiExecutor.execute("url_get",()=>{const e=this._legacyPanelId?Object(Ye.i)(this._store.getState(),this._legacyPanelId):null;return e&&e.type===Je.b.IFrame?e.sidePanelURL:""})}set width(e){this._clientApiExecutor.execute("width_set",()=>{this._legacyPanelId&&tt&&this._store.dispatch(tt(this._legacyPanelId,{sidePanelWidth:e.toString()+"px"}))},[{name:"panelWidth",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"number"}])}get width(){return this._clientApiExecutor.execute("width_get",()=>this._legacyPanelId?nt(this._store.getState(),this._legacyPanelId):0)}loadPanel(e,t="",n){const r=this._clientApiExecutor.getComponentName("loadPanel"),a=[];if(this._legacyPanelId)return Promise.resolve();let i;try{i="string"==typeof e?this._convertOldInterfaceOptions(e,t,n,a):e}catch(e){return O.a.instance.reportCall(r),Object(_.d)(this._store,e,r+".convertOldInterfaceOptions",a)}return this._clientApiExecutor.executeAsync("loadPanel",()=>Object(et.b)().then(t=>(tt=t.setPanelOptions,nt=t.getPanelWidth,this._store.dispatch(t.loadSidePanelWithUrl(i.url,i.title,i.width,i.position,i.state,i.defaultCollapsedBehavior,true,false,true,false,true)).then(t=>{const r=t.sidePanelId;this._channel.subscribeTo(r),this._legacyPanelId||(this._legacyPanelId=r),"string"==typeof e&&n&&this._addCustomHandersInOldOptions(n,a)}))),[{name:"options",value:i,isRequired:!0},{name:"options.url",value:i&&i.url,isRequired:!0}])}postMessage(e){this._clientApiExecutor.execute("postMessage",()=>{this._legacyPanelId&&this._channel.sendTo(this._legacyPanelId,e)},[{name:"message",value:e,isRequired:!0}])}addOnMessageReceived(e){this._clientApiExecutor.execute("addOnMessageReceived",()=>{this._legacyPanelId&&this._store.dispatch(Object(Xe.c)(this._legacyPanelId,e))},[{name:"handler",value:e,isRequired:!0}])}removeOnMessageReceived(e){this._clientApiExecutor.execute("removeOnMessageReceived",()=>{this._legacyPanelId&&this._store.dispatch(Object(Xe.h)(this._legacyPanelId,e))},[{name:"handler",value:e,isRequired:!0}])}addOnSizeChange(e){this._clientApiExecutor.execute("addOnSizeChange",()=>{this._legacyPanelId&&this._store.dispatch(Object(Xe.d)(this._legacyPanelId,e))},[{name:"handler",value:e,isRequired:!0}])}removeOnSizeChange(e){this._clientApiExecutor.execute("removeOnSizeChange",()=>{this._legacyPanelId&&this._store.dispatch(Object(Xe.i)(this._legacyPanelId,e))},[{name:"handler",value:e,isRequired:!0}])}addOnStateChange(e){this._clientApiExecutor.execute("addOnStateChange",()=>{this._legacyPanelId&&this._store.dispatch(Object(Xe.e)(this._legacyPanelId,e))},[{name:"handler",value:e,isRequired:!0}])}removeOnStateChange(e){this._clientApiExecutor.execute("removeOnStateChange",()=>{this._legacyPanelId&&this._store.dispatch(Object(Xe.j)(this._legacyPanelId,e))},[{name:"handler",value:e,isRequired:!0}])}_onChannelMessageRecieved(e,t){if(this._legacyPanelId===t)switch(e.type){case Ze.a.PostMessage:const t={message:e.data.data,origin:e.data.origin};this._store.dispatch(Object(Xe.k)(this._legacyPanelId,this,t));break;case Ze.a.SizeChange:this._store.dispatch(Object(Xe.l)(this._legacyPanelId,this));break;case Ze.a.StateChange:this._store.dispatch(Object(Xe.m)(this._legacyPanelId,this))}}_convertOldInterfaceOptions(e,t,n,r){const a={url:e,title:t};return n&&(a.width=n.initialWidth,a.defaultCollapsedBehavior=n.defaultCollapsedBehavior,null!==n.defaultCollapsedBehavior&&void 0!==n.defaultCollapsedBehavior&&r.push({name:"defaultCollapsedBehavior",value:""+n.defaultCollapsedBehavior})),a}_addCustomHandersInOldOptions(e,t){e.onSizeChangeHandler&&(t.push({name:"sidePanelOnSizeChangeHandler",value:"true"}),this.addOnSizeChange(e.onSizeChangeHandler)),e.onStateChangeHandler&&(t.push({name:"sidePanelOnStateChangeHandler",value:"true"}),this.addOnStateChange(e.onStateChangeHandler))}}var it=n("nOdx"),ot=n("aKhm");let st;class ct{constructor(e,t,n){const a="ClientApi.XrmPowerTours.constructor";t||Object(_.j)(a,"id"),n||Object(_.j)(a,"path"),e||Object(_.j)(a,"store"),st=e,this._clientApiExecutor=new r.b(e,"ClientApi.XrmPowerTours."),this._id=t,this._path=n}getId(){return this._id}getTourPath(){return this._path}getCurrentStepIndex(){try{const e=Object(it.a)().getTourProgressRecord(this._path);return null==e?void 0:e.currentStepIndex}catch(e){throw E.a.getInstance().reportFailure("ClientApi.XrmPowerTours.getCurrentStepIndex",e),e}}getIsAborted(){try{const e=Object(it.a)().getTourProgressRecord(this._path);return null==e?void 0:e.aborted}catch(e){throw E.a.getInstance().reportFailure("ClientApi.XrmPowerTours.getCurrentStepIndex",e),e}}getIsCompleted(){try{const e=Object(it.a)().getTourProgressRecord(this._path);return null==e?void 0:e.completed}catch(e){throw E.a.getInstance().reportFailure("ClientApi.XrmPowerTours.getCurrentStepIndex",e),e}}getIsActive(){try{return Object(ot.e)(st.getState(),this._id)}catch(e){throw E.a.getInstance().reportFailure("ClientApi.XrmPowerTours.getIsActive",e),e}}abortTourProgress(){this._clientApiExecutor.execute("ClientApi.XrmPowerTours.abortTourProgress",()=>{Object(it.a)().setTourProgressRecord(this._path,e=>Object.assign(Object.assign({},e),{aborted:!0}))},[],!0,!0)}resetTourProgress(){this._clientApiExecutor.execute("ClientApi.XrmPowerTours.resetTourProgress",()=>{Object(it.a)().clearTourProgressRecord(this._path)},[],!0,!0)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class lt{constructor(e){this._store=e,this._clientApiExecutor=new r.b(this._store,"ClientApi.XrmPowerToursManager.")}async getActiveTour(){const{getActiveTourAsync:e}=await n.e(56).then(n.bind(null,"0boP")),t=await this._store.dispatch(e());return t?new ct(this._store,t.msdyn_tourid,t.msdyn_path):null}async getTour(e){const{getToursAsync:t}=await n.e(56).then(n.bind(null,"0boP")),r=(await this._store.dispatch(t())).find(t=>t.msdyn_path===e);return r?new ct(this._store,r.msdyn_tourid,r.msdyn_path):null}moveNext(){return this._clientApiExecutor.executeAsync("moveNext",async()=>{const{moveActiveTourToNextStepSync:e}=await n.e(143).then(n.bind(null,"ELzy"));await this._store.dispatch(e())},[],!0,!0)}movePrevious(){return this._clientApiExecutor.executeAsync("movePrevious",async()=>{const{moveActiveTourToPreviousStepSync:e}=await n.e(143).then(n.bind(null,"ELzy"));await this._store.dispatch(e())},[],!0,!0)}}var ut,dt=n("bpBl"),pt=n("SJlc"),ft=n("ZePi");!function(e){e.online="Online",e.offline="Offline"}(ut||(ut={}));var gt,ht,mt,bt,yt,_t,vt=n("7iDi");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */!function(e){e.save="save",e.saveAndClose="saveandclose",e.saveAndNew="saveandnew"}(gt||(gt={})),function(e){e.none="none",e.recommended="recommended",e.required="required"}(ht||(ht={})),function(e){e.dirty="dirty",e.always="always",e.never="never"}(mt||(mt={})),function(e){e.error="ERROR",e.warning="WARNING",e.information="INFO"}(bt||(bt={})),function(e){e.error="ERROR",e.recommendation="RECOMMENDATION"}(yt||(yt={})),function(e){e.ActivityParty="activityparty",e.ActivityPointer="activitypointer",e.Annotation="annotation",e.Attachment="attachment",e.Category="category",e.Connection="connection",e.ConnectionRole="connectionrole",e.SystemUser="systemuser",e.Team="team",e.TeamMembership="teammembership",e.WebResource="webresource"}(_t||(_t={}));var St,Ot,Ct,Et,It=n("cZbt");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */!function(e){e.Next="Next",e.Previous="Previous"}(St||(St={})),function(e){e.active="active",e.inactive="inactive"}(Ot||(Ot={})),(Et=Ct||(Ct={})).AttributeFormats=x.a,Et.AttributeTypes=pt.a,Et.ClientNames=ft.a,Et.ClientStates=ut,Et.ControlTypes=vt.a,Et.FormSaveActions=gt,Et.AttributeRequiredLevels=ht,Et.AttributeSubmitModes=mt,Et.TabDisplayStates=dt.a,Et.FormNotificationLevels=bt,Et.ControlNotificationLevel=yt,Et.EntityNames=_t,Et.ProcessInstanceStatuses=It.a,Et.ProcessNavigationDirections=St,Et.ProcessStageStatuses=Ot;var wt=n("n6Qt"),jt=n("wL2W");var Pt;let Tt;!function(e){e[e.Debug=0]="Debug",e[e.Info=1]="Info",e[e.Warning=2]="Warning",e[e.Error=3]="Error"}(Pt||(Pt={}));class Nt{constructor(e,t){this._applicationContext=t,this._clientApiExecutor=new r.b(e,"ClientApi.XrmDiagnostics."),this._isInMonitorSession=Object(jt.a)()}static getInstance(e,t){return Tt||(Object(_.g)(t,"ClientApi.XrmDiagnostics.getInstance","applicationContext"),Tt=new Nt(e,t)),Tt}isInMonitorSession(){return this._isInMonitorSession}traceError(e,t,n){this._trace(Pt.Error,e,t,n)}traceWarning(e,t,n){this._trace(Pt.Warning,e,t,n)}traceInfo(e,t,n){this._trace(Pt.Info,e,t,n)}traceDebug(e,t,n){this._trace(Pt.Debug,e,t,n)}_trace(e,t,n,r){const a=!t.startsWith("ClientApi.");return this._clientApiExecutor.execute("trace"+Pt[e],()=>{const a=this._applicationContext.TraceManager.getTracer(t);switch(e){case Pt.Debug:a.debug(n,r);break;case Pt.Info:a.info(n,r);break;case Pt.Warning:a.warn(n,r);break;case Pt.Error:a.error(n,r)}},[{name:"componentName",value:t,isRequired:!0},{name:"message",value:n,isRequired:!0}],a)}}var At=n("sZ+8"),Rt=n("rzss"),Dt=n("z+5+");let xt;class Mt{constructor(e,t){xt=e,this._pageId=t}_getXrmWebApiOffline(e,t){return Object(Rt.a)().then(t=>t.getXrmWebApiOfflineInstance(e,this._pageId)).catch(e=>Object(_.d)(xt,e,t+"._getXrmWebApiOffline"))}isOfflineEnabled(e){const t="ClientApi.XrmOffline.isOfflineEnabled";e||Object(_.j)(t,"entityType");try{O.a.instance.reportCall(t);const n=Object(At.n)(xt.getState(),e);return O.a.instance.reportSuccess(t),n}catch(e){throw E.a.getInstance().reportFailure(t,e),e}}retrieveRecord(e,t,n){const r="ClientApi.XrmOffline.retrieveRecord";e||Object(_.j)(r,"entityType"),t||Object(_.j)(r,"id"),s.a.tryParseOrNull(t)||Object(_.k)(r,"guid","id"),Object(Dt.K)(n,r);try{return O.a.instance.reportCall(r),this._getXrmWebApiOffline(xt,r).then(a=>a.retrieveRecord(e,t,n).then(e=>(O.a.instance.reportSuccess(r),e)).catch(n=>{const a=[];return a.push({name:"entityName",value:e}),a.push({name:"entityId",value:t}),Object(_.d)(xt,n,r+".retrieveRecord",a)}))}catch(n){const a=[];return a.push({name:"entityName",value:e}),a.push({name:"entityId",value:t}),Object(_.d)(xt,n,r,a)}}createRecord(e,t){const n="ClientApi.XrmOffline.createRecord";e||Object(_.j)(n,"entityType"),t&&0!==Object.keys(t).length||Object(_.j)(n,"data");try{return O.a.instance.reportCall(n),this._getXrmWebApiOffline(xt,n).then(r=>r.createRecord(e,t).then(e=>{const t=this._lookupValueToEntityReference(e);return O.a.instance.reportSuccess(n),t}).catch(t=>{const r=[];return r.push({name:"entityName",value:e}),Object(_.d)(xt,t,n+".createRecord",r)}))}catch(t){const r=[];return r.push({name:"entityName",value:e}),Object(_.d)(xt,t,n,r)}}updateRecord(e,t,n){const r="ClientApi.XrmOffline.updateRecord";e||Object(_.j)(r,"entityType"),t||Object(_.j)(r,"id"),s.a.tryParseOrNull(t)||Object(_.e)(r,t+" value is an invalid Guid"),n&&0!==Object.keys(n).length||Object(_.j)(r,"data");try{return O.a.instance.reportCall(r),this._getXrmWebApiOffline(xt,r).then(a=>a.updateRecord(e,t,n).then(e=>{const t=this._lookupValueToEntityReference(e);return O.a.instance.reportSuccess(r),t}).catch(n=>{const a=[];return a.push({name:"entityName",value:e}),a.push({name:"entityId",value:t}),Object(_.d)(xt,n,r+".updateRecord",a)}))}catch(n){const a=[];return a.push({name:"entityName",value:e}),a.push({name:"entityId",value:t}),Object(_.d)(xt,n,r,a)}}deleteRecord(e,t){const n="ClientApi.XrmOffline.deleteRecord";e||Object(_.j)(n,"entityType"),t||Object(_.j)(n,"id"),s.a.tryParseOrNull(t)||Object(_.e)(n,t+" value is an invalid Guid");try{return O.a.instance.reportCall(n),this._getXrmWebApiOffline(xt,n).then(r=>r.deleteRecord(e,t).then(e=>{const t=this._lookupValueToEntityReference(e);return O.a.instance.reportSuccess(n),t}).catch(r=>{const a=[];return a.push({name:"entityName",value:e}),a.push({name:"entityId",value:t}),Object(_.d)(xt,r,n+".deleteRecord",a)}))}catch(r){const a=[];return a.push({name:"entityName",value:e}),a.push({name:"entityId",value:t}),Object(_.d)(xt,r,n,a)}}retrieveMultipleRecords(e,t,n){const r="ClientApi.XrmOffline.retrieveMultipleRecords";e||Object(_.j)(r,"entityType"),Object(Dt.K)(t,r),Object(Dt.I)(n,r);try{return O.a.instance.reportCall(r),this._getXrmWebApiOffline(xt,r).then(a=>a.retrieveMultipleRecords(e,t,n).then(e=>(O.a.instance.reportSuccess(r),e)).catch(t=>{const n=[];return n.push({name:"entityName",value:e}),Object(_.d)(xt,t,r+".retrieveMultipleRecords",n)}))}catch(t){const n=[];return n.push({name:"entityName",value:e}),Object(_.d)(xt,t,r,n)}}_lookupValueToEntityReference(e){return{id:e.id,logicalName:e.entityType}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let Ft;class kt{constructor(e,t){Ft=e,this._pageId=t}get offline(){const e="ClientApi.XrmMobile.offline";try{O.a.instance.reportCall(e);const t=new Mt(Ft,this._pageId);return O.a.instance.reportSuccess(e),t}catch(t){throw E.a.getInstance().reportFailure(e,t),t}}}var Lt=n("69Qu"),Bt=n("K9wp"),Ut=n("17x/");let Vt;class zt{constructor(e,t){Vt=e,this._pageId=t,this._clientApiExecutor=new r.b(e,"ClientApi.XrmWebApiOfflineAsync.")}retrieveRecord(e,t,n){return this._clientApiExecutor.executeAsync("retrieveRecord",(r,a)=>(Object(Dt.K)(n,r,a),this._ensureUnderlyingApi(r).then(r=>r.retrieveRecord(e,t,n))),[{name:"entityType",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"string"},{name:"id",value:t,isRequired:!0,isEventParam:!0,expectedDataType:"guid"},{name:"options",value:n,isRequired:!1,isEventParam:!1,expectedDataType:"string"}])}createRecord(e,t){return this._clientApiExecutor.executeAsync("createRecord",n=>this._ensureUnderlyingApi(n).then(n=>n.createRecord(e,t)),[{name:"entityType",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"string"},{name:"data",value:t,isRequired:!0,expectedDataType:"object"}])}updateRecord(e,t,n){return this._clientApiExecutor.executeAsync("updateRecord",r=>this._ensureUnderlyingApi(r).then(r=>r.updateRecord(e,t,n)),[{name:"entityType",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"string"},{name:"id",value:t,isRequired:!0,isEventParam:!0,expectedDataType:"guid"},{name:"data",value:n,isRequired:!0,expectedDataType:"object"}])}deleteRecord(e,t){return this._clientApiExecutor.executeAsync("deleteRecord",n=>this._ensureUnderlyingApi(n).then(n=>n.deleteRecord(e,t)),[{name:"entityType",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"string"},{name:"id",value:t,isRequired:!0,isEventParam:!0,expectedDataType:"guid"}])}retrieveMultipleRecords(e,t,n){return this._clientApiExecutor.executeAsync("retrieveMultipleRecords",(r,a)=>(Object(Dt.K)(t,r,a),Object(Dt.I)(n,r,a),this._ensureUnderlyingApi(r).then(r=>r.retrieveMultipleRecords(e,t,n))),[{name:"entityType",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"string"},{name:"options",value:t,isRequired:!1,isEventParam:!1,expectedDataType:"string"},{name:"maxPageSize",value:n,isRequired:!1,isEventParam:!0,expectedDataType:"number"}])}execute(e,t){return this._clientApiExecutor.executeAsync("execute",n=>this._ensureUnderlyingApi(n).then(n=>n.execute(e,t)),[{name:"request",value:e,isRequired:!0,expectedDataType:"object"},{name:"request.getMetadata",value:e&&e.getMetadata,isRequired:!0,expectedDataType:"function"},{name:"operationName",value:e&&e.getMetadata&&e.getMetadata().operationName,isRequired:!0,isEventParam:!0}])}isAvailableOffline(e){return this._clientApiExecutor.execute("isAvailableOffline",()=>Object(At.n)(Vt.getState(),e),[{name:"entityType",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"string"}])}_ensureUnderlyingApi(e){return Object(Lt.c)(Vt.getState())&&Object(_.e)(e,"API can be accessed only when offline."),Object(Ut.c)(Vt.getState())||Object(_.e)(e,"API can be accessed only when offline is enabled."),this._actualXrmWebApiOffline?Promise.resolve(this._actualXrmWebApiOffline):Object(Rt.a)().then(e=>(this._actualXrmWebApiOffline=e.getXrmWebApiOfflineInstance(Vt,this._pageId),this._actualXrmWebApiOffline))}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let qt;class Ht{constructor(e,t){qt=e,this._pageId=t,this._clientApiExecutor=new r.b(e,"ClientApi.XrmWebApi.")}_getWebApiInstance(){return Object(Lt.c)(qt.getState())?this.online:this.offline}get online(){return this._clientApiExecutor.execute("online",()=>(this._webApiOnline||(this._webApiOnline=new Bt.a(qt,this._pageId)),this._webApiOnline))}get offline(){return this._clientApiExecutor.execute("offline",()=>(this._webApiOffline||(this._webApiOffline=new zt(qt,this._pageId)),this._webApiOffline))}retrieveRecord(e,t,n){return this._clientApiExecutor.executeAsync("retrieveRecord",(r,a)=>(Object(Dt.K)(n,r,a),this._getWebApiInstance().retrieveRecord(e,t,n)),[{name:"entityType",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"string"},{name:"id",value:t,isRequired:!0,isEventParam:!0,expectedDataType:"guid"},{name:"options",value:n,isRequired:!1,isEventParam:!1,expectedDataType:"string"}])}createRecord(e,t){return this._clientApiExecutor.executeAsync("createRecord",()=>this._getWebApiInstance().createRecord(e,t),[{name:"entityType",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"string"},{name:"data",value:t,isRequired:!0,expectedDataType:"object"}])}updateRecord(e,t,n){return this._clientApiExecutor.executeAsync("updateRecord",()=>this._getWebApiInstance().updateRecord(e,t,n),[{name:"entityType",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"string"},{name:"id",value:t,isRequired:!0,isEventParam:!0,expectedDataType:"guid"},{name:"data",value:n,isRequired:!0,expectedDataType:"object"}])}deleteRecord(e,t){return this._clientApiExecutor.executeAsync("deleteRecord",()=>this._getWebApiInstance().deleteRecord(e,t),[{name:"entityType",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"string"},{name:"id",value:t,isRequired:!0,isEventParam:!0,expectedDataType:"guid"}])}execute(e){return this._clientApiExecutor.executeAsync("execute",(t,n,r)=>this._getWebApiInstance().execute(e),[{name:"request",value:e,isRequired:!0,expectedDataType:"object"},{name:"request.getMetadata",value:e&&e.getMetadata,isRequired:!0,expectedDataType:"function"},{name:"operationName",value:e&&e.getMetadata&&e.getMetadata().operationName,isRequired:!0,isEventParam:!0},{name:"operationType",value:e&&e.getMetadata&&e.getMetadata().operationType,isRequired:!0,isEventParam:!0}])}executeMultiple(e){return this._clientApiExecutor.executeAsync("executeMultiple",(t,n,r)=>this._getWebApiInstance().executeMultiple?this._getWebApiInstance().executeMultiple(e):Promise.resolve(null),[{name:"requests",value:e,isRequired:!0}])}retrieveMultipleRecords(e,t,n,r){return this._clientApiExecutor.executeAsync("retrieveMultipleRecords",(a,i)=>(Object(Dt.K)(t,a,i),Object(Dt.I)(n,a,i),this._getWebApiInstance().retrieveMultipleRecords(e,t,n,r)),[{name:"entityType",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"string"},{name:"options",value:t,isRequired:!1,isEventParam:!1,expectedDataType:"string"},{name:"maxPageSize",value:n,isRequired:!1,isEventParam:!0,expectedDataType:"number"}])}}var Wt=n("CfSh");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let Gt;class Kt{constructor(e,t){this._externalContextService=new Wt.a(t,e),Gt=e}getExternalContextProperty(e,t,n){const r="ClientApi.XrmExternalContext.getExternalContextProperty";try{return O.a.instance.reportCall(r),this._externalContextService.getExternalContextProperty(e,t,n).then(e=>(O.a.instance.reportSuccess(r),e)).catch(n=>{const a=[];return a.push({name:"externalContextId",value:e}),a.push({name:"externalContextPropertyId",value:t}),Object(_.d)(Gt,n,r,a)})}catch(n){const a=[];return a.push({name:"externalContextId",value:e}),a.push({name:"externalContextPropertyId",value:t}),Object(_.d)(Gt,n,r,a)}}invokeExternalContextAction(e,t,n){const r="ClientApi.XrmExternalContext.invokeExternalContextAction";try{return O.a.instance.reportCall(r),this._externalContextService.invokeExternalContextAction(e,t,n).then(e=>(O.a.instance.reportSuccess(r),e)).catch(n=>{const a=[];throw a.push({name:"externalContextId",value:e}),a.push({name:"externalContextActionId",value:t}),Object(_.d)(Gt,n,r,a),n})}catch(n){const a=[];return a.push({name:"externalContextId",value:e}),a.push({name:"externalContextActionId",value:t}),Object(_.d)(Gt,n,r,a)}}getAvailableExternalContexts(){const e="ClientApi.XrmExternalContext.getAvailableExternalContexts";try{O.a.instance.reportCall(e);const t=this._externalContextService.getAvailableExternalContexts(),n=new X.a(e);return t&&Object.keys(t).map(n=>({id:n,actions:Array.isArray(t[n].actions)&&t[n].actions.reduce((e,t)=>(e.add(t,t),e),new X.a(e+".actions")),properties:Array.isArray(t[n].properties)&&t[n].properties.reduce((e,t)=>(e.add(t,t),e),new X.a(e+".properties"))})).reduce((e,t)=>(e.add(t.id,t),e),n),O.a.instance.reportSuccess(e),n}catch(t){throw E.a.getInstance().reportFailure(e,t),t}}removeExternalContextPropertyListener(e,t,n){const r="ClientApi.XrmExternalContext.removeExternalContextPropertyListener";try{O.a.instance.reportCall(r);const a=this._externalContextService.removeExternalContextPropertyListener(e,t,n);return O.a.instance.reportSuccess(r),a}catch(e){throw E.a.getInstance().reportFailure(r,e),e}}}var Qt=n("fU7K");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let Xt,Yt;class Jt{static getInstance(e){e||Object(_.j)("ClientApi.XrmEncoding.getInstance","store");try{return Xt||(Xt=new Jt),Xt}catch(e){throw E.a.getInstance().reportFailure("ClientApi.XrmEncoding.getInstance",e),e}}xmlEncode(e){const t="ClientApi.XrmEncoding.xmlEncode";e||Object(_.j)(t,"text");try{O.a.instance.reportCall(t);const n=Object(Qt.CrmXmlEncode)(e);return O.a.instance.reportSuccess(t),n}catch(e){throw E.a.getInstance().reportFailure(t,e),e}}xmlAttributeEncode(e){const t="ClientApi.XrmEncoding.xmlAttributeEncode";e||Object(_.j)(t,"text");try{O.a.instance.reportCall(t);const n=Object(Qt.CrmXmlAttributeEncode)(e);return O.a.instance.reportSuccess(t),n}catch(e){throw E.a.getInstance().reportFailure(t,e),e}}htmlEncode(e){const t="ClientApi.XrmEncoding.htmlEncode";try{if(O.a.instance.reportCall(t),!e)return O.a.instance.reportSuccess(t),e;const n=Object(Qt.CrmHtmlEncode)(e);return O.a.instance.reportSuccess(t),n}catch(e){throw E.a.getInstance().reportFailure(t,e),e}}htmlAttributeEncode(e){const t="ClientApi.XrmEncoding.htmlAttributeEncode";try{if(O.a.instance.reportCall(t),!e)return O.a.instance.reportSuccess(t),e;const n=Object(Qt.CrmHtmlAttributeEncode)(e);return O.a.instance.reportSuccess(t),n}catch(e){throw E.a.getInstance().reportFailure(t,e),e}}htmlDecode(e){const t="ClientApi.XrmEncoding.htmlDecode";try{if(O.a.instance.reportCall(t),!e)return O.a.instance.reportSuccess(t),e;const n=Object(Qt.CrmHtmlDecode)(e);return O.a.instance.reportSuccess(t),n}catch(e){throw E.a.getInstance().reportFailure(t,e),e}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function $t(e){return{type:"clientapi.create.xrm",sync:!0,execute(t,n){try{const r=new Zt(t,e,n);return Object(a.a)(t,n,e,r),r}catch(e){throw E.a.getInstance().reportFailure("ClientApi.Xrm.createXrm",e),e}}}}class Zt{constructor(e,t,n){Yt=e,this._pageId=t,this._applicationContext=n,this._clientApiExecutor=new r.b(Yt,"ClientApi.Xrm.",null,[{isEventParam:!0,name:"pageId",value:this._pageId}]),this._clientApiExecutor.execute("constructor",(e,t)=>{const n=Object(qe.p)(Yt.getState(),this._pageId);if(this._clientApiExecutor.addEventParameter({isEventParam:!0,name:"pageType",value:n}),!Yt){const n=new Error("Xrm instance created with null store");this._clientApiExecutor.reportFailure(e,n,t)}})}get Mobile(){return this._clientApiExecutor.execute("Mobile",()=>(this._mobile||(this._mobile=new kt(Yt,this._pageId)),this._mobile))}get Utility(){return this._clientApiExecutor.execute("Utility",()=>(this._utility||(this._navigation||(this._navigation=new Qe.b(Yt,this._applicationContext,this._globalContext,this._pageId)),this._utility=new De(Yt,this._globalContext,this._applicationContext,this._navigation,this._pageId)),this._utility))}get Navigation(){return this._clientApiExecutor.execute("Navigation",()=>(this._navigation||(this._navigation=new Qe.b(Yt,this._applicationContext,this._globalContext,this._pageId)),this._navigation))}get Panel(){return this._clientApiExecutor.execute("Panel",()=>(this._panel||(this._panel=at.getInstance(Yt,this._applicationContext)),this._panel))}get PowerTours(){return this._clientApiExecutor.execute("PowerTours",()=>(this._powerTours||(this._powerTours=new lt(Yt)),Promise.resolve(this._powerTours)))}get Device(){return this._clientApiExecutor.execute("Device",()=>(this._device||(this._device=fe.getInstance(Yt,this._applicationContext)),this._device))}get Page(){return this._clientApiExecutor.execute("Page_get",(e,t)=>{if(!this._page){this._page=new Ke(Yt,this._pageId),this._page.context=this._globalContext;const n=Object(qe.p)(Yt.getState(),this._pageId);if(n!==ze.a.Dashboard&&n!==ze.a.Grid&&n!==ze.a.CustomControl){const n=new Error("Xrm.Page.get is called before or without calling set.");this._clientApiExecutor.reportFailure(e,n,t)}}return this._page})}set Page(e){this._clientApiExecutor.execute("Page_set",(t,n)=>{this._page&&Y.a.getInstance().traceManager.getTracer(t).warn("Xrm.Page can only be initialized once.",n),this._page=e,this._page.context=this._globalContext},null,!1)}get Internal(){return this._clientApiExecutor.execute("Internal",()=>(this._internal||(this._internal=new wt.a(Yt,this._applicationContext,this._globalContext,this._pageId)),this._internal))}get WebApi(){return this._clientApiExecutor.execute("WebApi",()=>(this._webApi||(this._webApi=new Ht(Yt,this._pageId)),this._webApi))}get ExternalContext(){return this._clientApiExecutor.execute("ExternalContext",()=>(this._externalContext||(this._externalContext=new Kt(Yt,this._applicationContext)),this._externalContext))}get Constants(){return this._clientApiExecutor.execute("Constants",()=>(this._constants||(this._constants=Ct),this._constants))}get Reporting(){return this._clientApiExecutor.execute("Reporting",()=>(this._reporting||(this._reporting=E.a.getInstance(Yt)),this._reporting))}get Diagnostics(){return this._clientApiExecutor.execute("Diagnostics",()=>(this._diagnostics||(this._diagnostics=Nt.getInstance(Yt,this._applicationContext)),this._diagnostics))}get UI(){return this._clientApiExecutor.execute("UI",()=>(this._ui||(this._ui=Le.getInstance(Yt,this._applicationContext)),this._ui))}get NotificationLevel(){return this._clientApiExecutor.execute("NotificationLevel",()=>(this._notificationLevel||(this._notificationLevel=yt),this._notificationLevel))}get Encoding(){return this._clientApiExecutor.execute("Encoding",()=>(this._encoding||(this._encoding=Jt.getInstance(Yt)),this._encoding))}get App(){return this._clientApiExecutor.execute("App",()=>(this._app||(this._app=Me.a.getInstance(Yt,this._applicationContext)),this._app))}getPlugin(e){return this._clientApiExecutor.executeAsync("getPlugin",async()=>{var t;if(!this._applicationContext.AppHostClient){const e=await Promise.all([n.e(5),n.e(127)]).then(n.bind(null,"wge3"));await Yt.dispatch(e.initializeAppHostClient())}const r=await(null===(t=this._applicationContext.AppHostClient)||void 0===t?void 0:t.getPluginProvider().getExternalPluginsAsync());if(r)return r[e]})}get _globalContext(){return this._xrmGlobalContext||(this._xrmGlobalContext=new i.a(Yt,this._pageId)),this._xrmGlobalContext}}},N2HV:function(e,t,n){"use strict";n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return a}));var r,a,i=n("Z1+9"),o=n("Fn63"),s=n("ghc6"),c=n("8aze"),l=(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return l(t,e),t.prototype.getSymbolClassName=function(e){return Object(o.b)(e)},t}(i.a);!function(e){e[e.None=0]="None",e[e.Left=1]="Left",e[e.Top=2]="Top"}(a||(a={}));var d=s.a(c.b)(u)},N6E8:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return o}));
/**
 * Constants for the editform.
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="editFormRoot",a="mainFormDialogRoot",i="parentrecord",o="tab-section"},N6Lu:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));const r="update.orgwebresourcehash";function a(e){return{type:r,payload:e}}},N6mg:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n("eXjw"),a=n("K7RF"),i=n("Uv1Y"),o=n("dUiZ"),s=n("/oKV"),c=n("iJGp"),l=n("wL2W"),u=n("pEXn"),d=n("+Qpx");function p(e){return{type:"quickCreateMenu.retrieve.async",execute({dispatch:t,getState:n},p){let f=s.a.LocalAndRemote;p.DataSource;const g=n(),h=Object(l.a)(),m=Object(o.b)(g);return m===r.a.Initialized&&Object(a.e)(g,Object(o.a)(g).overallVersionNumber)&&(f=s.a.Remote),m===r.a.Uninitialized||f!==s.a.LocalAndRemote?(t(function(){const e={quickCreateMenu:{initialized:r.a.Initializing,quickCreateMenuItems:null}};return{type:a.a,payload:e}}()),t(function(e,t,n,r){return{type:"quickCreateMenu.retrieve.async",execute:({dispatch:e,getState:o},s)=>e(Object(a.b)("quickcreatemenu",n?"qcfchecker":null,null,null,!1,c.a.OnDemandWithoutContext,null,null,[],null,t,r)).catch(i.b)}}(0,f,h,e)).then(()=>(h&&t({type:"formChecker.QuickCreateMenu",execute({getState:e},t){var n;const r=null===(n=null==t?void 0:t.TraceManager)||void 0===n?void 0:n.getTracer(`${d.u}${d.C}`);if(!r)return Promise.resolve();const a=Object(o.a)(e());(null==a?void 0:a.missingQuickCreateMenuItems)&&r.warn(d.B,[{name:u.l,value:d.C},{name:d.C,value:JSON.stringify(a.missingQuickCreateMenuItems)}])}}),Object(o.a)(n())))):Promise.resolve(Object(o.a)(n()))}}}},N911:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r,a=n("z0sv"),i=n("+QYJ"),o=function(){function e(){this._subscribers=[],this._nextSubscriberId=0,this._addSubscribersQueue=[],this.fireEvent=this.fireEvent.bind(this)}return Object.defineProperty(e,"pointerDownEvent",{get:function(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream?"touchstart":"pointerdown"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"scrollEvent",{get:function(){return"scroll"},enumerable:!1,configurable:!0}),e.getInstance=function(){return r||(r=new e),r},Object.defineProperty(e.prototype,"subscribers",{get:function(){return this._subscribers},enumerable:!1,configurable:!0}),e.prototype.addSubscribers=function(t){var n=this,r=this._nextSubscriberId++;this._addSubscribersQueue.push({subscriber:t,id:r}),setTimeout((function(){for(var a=!1,o=0,c=n._addSubscribersQueue;o<c.length;o++){var l=c[o];if(r===l.id){a=!0;break}}a&&((Object(i.c)(n.subscribers)||n.subscribers.length<=0)&&(document.addEventListener(e.pointerDownEvent,n.fireEvent),t.onScroll&&document.addEventListener(e.scrollEvent,n.fireEvent,!0)),n._subscribers.push(t),n._addSubscribersQueue=s(n._addSubscribersQueue,r,(function(e){return e.id})))}),100)},e.prototype.removeSubscribers=function(t){this._addSubscribersQueue=s(this._addSubscribersQueue,t,(function(e){return e.subscriber})),this._subscribers=s(this._subscribers,t),(Object(i.c)(this.subscribers)||this.subscribers.length<=0)&&(document.removeEventListener(e.pointerDownEvent,this.fireEvent),document.removeEventListener(e.scrollEvent,this.fireEvent))},e.prototype.fireEvent=function(t){if(this.subscribers)for(var n=this._subscribers.length-1;n>=0;n--){var r=this.subscribers[n];if(r&&r.getComponent()&&(r.onPointerDown||r.onScroll)&&r.getComponent().offsetHeight>0){var i=r.isClickInsideSubscriber&&r.isClickInsideSubscriber(t);if(r.onPointerDown&&t.type===e.pointerDownEvent&&r.onPointerDown.bind(r,t)(),r.onScroll&&t.type===e.scrollEvent&&r.onScroll.bind(r,t)(),i)break}if(r&&r.type===a.a.Popup)break}},e}();function s(e,t,n){return e.filter((function(e){return(n?n(e):e)!==t}))}},NCdO:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e,t,n){const r=e&&e.filter(e=>e.Id===t&&e.LabelColumnName===n);if(r&&r.length>0)return r[0].Value}n.d(t,"a",(function(){return r}))},NM3A:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="userquery",a="savedquery"},NMtn:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"d",(function(){return s})),n.d(t,"f",(function(){return c})),n.d(t,"c",(function(){return l})),n.d(t,"e",(function(){return u})),n.d(t,"a",(function(){return d}));var r=n("504W"),a=n("Div0"),i=n("XjOj");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function o(e,t){if(null===e)throw Object(i.d)(a.a.framework,"ExceptionHelpers.ThrowOnNullArgument({0}, {1})",e,t),Error.argumentNull(t,"Argument can't be null")}function s(e,t){if(Object(r.a)(e))throw Object(i.d)(a.a.framework,"ExceptionHelpers.ThrowOnNullOrUndefinedArgument({0}, {1})",e,t),Error.argumentNull(t,"Argument can't be null or undefined")}function c(e,t){if(void 0===e)throw Object(i.d)(a.a.framework,"ExceptionHelpers.ThrowOnUndefinedArgument({0}, {1})",e,t),Error.argumentNull(t,"Argument can't be undefined")}function l(e,t){if(!e||!e.length)throw Object(i.d)(a.a.framework,"ExceptionHelpers.ThrowOnNullOrEmptyArgument({0}, {1})",e,t),Error.argumentNull(t,"Argument can't be null or empty")}function u(e,t,n,r){if(e<t||e>n)throw Object(i.d)(a.a.framework,"ExceptionHelpers.ThrowOnOutOfRange({0}, {1}, {2}, {3})",e,t,n,r),Error.argumentOutOfRange(r)}function d(e,t){if(!e)throw Object(i.d)(a.a.framework,"ExceptionHelpers.ThrowOnAssert({0})",t),Error.create("ExceptionHelpers.ThrowOnAssert("+t+")")}},NP1x:function(e,t,n){"use strict";n.d(t,"b",(function(){return g})),n.d(t,"d",(function(){return h})),n.d(t,"c",(function(){return m})),n.d(t,"a",(function(){return C}));var r=n("uNu9"),a=n("iZ7K"),i=n("NjDY"),o=n("3hnk"),s=n("Lyxw"),c=n("O7zD"),l=n("7XzV"),u=n("0l0t"),d=n("niX0"),p=n("+zjj"),f=n("3/02");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function g(e,t){const n=Object(a.h)(e,t),i=Object(d.c)(e).concat(Object(d.b)(e,t)),o={};if(n&&n.OneToManyRelationships){const e=Object.keys(n.OneToManyRelationships);for(let t=0;t<e.length;t++){const a=n.OneToManyRelationships[e[t]];if(a){if(a.ReferencingEntity===r.b&&!a.AssociatedMenuConfiguration.MenuId)continue;(a.IsCustomRelationship||S(a.AssociatedMenuConfiguration))&&(o[a.ReferencingEntity]=[])}}}if(n&&n.ManyToManyRelationships){const e=Object.keys(n.ManyToManyRelationships);for(let r=0;r<e.length;r++){const a=n.ManyToManyRelationships[e[r]];if(a){const{otherEntityLogicalName:e,otherEntityAssociatedMenuConfig:n}=v(a,t);if(!n.AvailableOffline)continue;(a.IsCustomRelationship||S(n))&&(o[e]=[])}}}return i&&i.forEach(e=>{o[e.entityName]=[]}),o}function h(e,t,n){const l=[],u=Object(a.h)(e,t);if(u&&u.OneToManyRelationships){const t=Object.keys(u.OneToManyRelationships);for(let d=0;d<t.length;d++){const g=u.OneToManyRelationships[t[d]];if(g){const t=g.AssociatedMenuConfiguration.Behavior!==c.f.DoNotDisplay;let d=t?p.a.Displayed_SetInRelationshipMetadata:p.a.NotDisplayed_SetInRelationshipMetadata;const h=Object(a.h)(e,g.ReferencingEntity);if(h){if(h.IsBPFEntity&&(d=p.a.NotDisplayed_IsBPFEntity,!n))continue;if(g.ReferencingEntity===r.Tb){const t=Object(i.D)(e),r=Object(s.f)(e,f.Mg)&&u.IsDocumentManagementEnabled;if(!(Object(s.f)(e,f.me)&&t.isMSTeamsEnabled&&u.IsMSTeamsIntegrationEnabled)&&!r&&(d=p.a.NotDisplayed_SPDocumentNotConfigured,!n))continue}if(!g.IsCustomRelationship&&!S(g.AssociatedMenuConfiguration)&&(d=p.a.NotDisplayed_NotCustomOrConfigurableSystemRelationship,!n))continue;if(!Object(o.g)(e,h.EntityLogicalName,2,0)&&(d=p.a.NotDisplayed_NoReadPermissionOnRelatedEntity,!n))continue;const a=g.SchemaName;let c="";c=S(g.AssociatedMenuConfiguration)?g.AssociatedMenuConfiguration.MenuId:"nav_"+a;const{label:m,labelSource:b}=_(g.AssociatedMenuConfiguration,h),y=O(g.AssociatedMenuConfiguration.Group);l.push({areaId:y,id:c,entityName:g.ReferencingEntity,relationshipName:g.SchemaName,iconPath:"",title:m,labelSource:b,order:g.AssociatedMenuConfiguration.Order,show:t,relationshipType:0,displayStateReason:d})}}}}return l}function m(e,t,n){const i=[],s=Object(a.h)(e,t);if(s&&s.ManyToManyRelationships){const c=Object.keys(s.ManyToManyRelationships);for(let l=0;l<c.length;l++){const u=s.ManyToManyRelationships[c[l]];if(u){let c;const{otherEntityLogicalName:l,otherEntityAssociatedMenuConfig:d}=v(u,t),f=Object(a.h)(e,l);if(f){if(!s.IsKnowledgeManagementEnabled&&f.EntityLogicalName===r.db&&(c=p.a.NotDisplayed_KnowledgeManagementNotEnabled,!n))continue;if(!u.IsCustomRelationship&&!S(d)&&(c=p.a.NotDisplayed_NotCustomOrConfigurableSystemRelationship,!n))continue;if(!Object(o.g)(e,f.EntityLogicalName,2,0)&&(c=p.a.NotDisplayed_NoReadPermissionOnRelatedEntity,!n))continue;if(i.push(y(u,f,d,1,c)),u.Entity1LogicalName===u.Entity2LogicalName){const e=u.Entity1AssociatedMenuConfiguration;(u.IsCustomRelationship||S(e))&&i.push(y(u,s,e,2,c))}}else{if(!n)continue;i.push(b(u,d,l))}}}}return i}function b(e,t,n){const r=e.SchemaName;return{areaId:O(t.Group),id:"nav_"+r,entityName:n,show:t.Behavior!==c.f.DoNotDisplay,displayStateReason:p.a.NotDisplayed_RelatedEntityMetadataNotAvailableInUnifiedClient}}function y(e,t,n,r,a){const i=e.SchemaName;let o="";o=S(n)?n.MenuId:"nav_"+i,e.Entity1LogicalName===e.Entity2LogicalName&&(o+=r.toString());const{label:s,labelSource:l}=_(n,t),u=O(n.Group),d=n.Behavior!==c.f.DoNotDisplay;return{areaId:u,id:o,entityName:t.EntityLogicalName,relationshipName:i,iconPath:"",title:s,labelSource:l,order:n.Order,show:d,ordinal:e.Entity1LogicalName===e.Entity2LogicalName?r:void 0,relationshipType:1,displayStateReason:a&&!Object(p.g)(a)?a:d?p.a.Displayed_SetInRelationshipMetadata:p.a.NotDisplayed_SetInRelationshipMetadata}}function _(e,t){const n=e.Behavior===c.f.UseLabel&&e.Label?p.b.RelationshipMetadata:t.DisplayCollectionName?p.b.EntityDisplayCollectionName:p.b.EntityDisplayName;return{label:n===p.b.RelationshipMetadata?e.Label:n===p.b.EntityDisplayCollectionName?t.DisplayCollectionName:t.DisplayName,labelSource:n}}function v(e,t){let n,r;return e.Entity1LogicalName!==t?(n=e.Entity1LogicalName,r=e.Entity1AssociatedMenuConfiguration):(n=e.Entity2LogicalName,r=e.Entity2AssociatedMenuConfiguration),{otherEntityLogicalName:n,otherEntityAssociatedMenuConfig:r}}function S(e){return e.IsCustomizable&&e.MenuId}function O(e){switch(e){case c.e.Details:return u.b;case c.e.Sales:return u.f;case c.e.Service:return u.g;case c.e.Marketing:return u.d;case c.e.InternetMarketing:return u.c;case c.e.Processes:return u.e;case c.e.Async:return u.a;default:return u.b}}function C(e){switch(e){case l.c:case l.b:return u.b;case l.h:return u.f;case l.i:return u.g;case l.e:return u.d;case l.d:return u.c;case l.g:case l.f:return u.e;case l.a:return u.a;default:return u.b}}},NRCx:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(){function e(){}return e.LearningPathAttributeSuffix="lp-id",e.LearningPathAttributeName="data-"+e.LearningPathAttributeSuffix,e.CCF="CustomControlFramework",e}()},NUY7:function(e,t,n){
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */},Nb1E:function(e,t,n){"use strict";n.d(t,"b",(function(){return I})),n.d(t,"d",(function(){return w})),n.d(t,"e",(function(){return j})),n.d(t,"f",(function(){return P})),n.d(t,"c",(function(){return T})),n.d(t,"a",(function(){return N}));var r=n("odYE"),a=n("eeMP"),i=n("FZDd"),o=n("f07+"),s=n("fMBw"),c=n.n(s),l=n("SZCI"),u=n("pEXn"),d=n("SAYH"),p=n("4r2D"),f=n("qAG9"),g=n("jjPz"),h=n("vSoM"),m=n("/oKV"),b=n("z+5+"),y=n("g22U");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const _=c.a.createEvent("oDataCreate",l.D),v=c.a.createEvent("oDataRetrieve",l.D),S=c.a.createEvent("oDataRetrieveMultiple",l.D),O=c.a.createEvent("oDataUpdate",l.D),C=c.a.createEvent("oDataDelete",l.D),E=c.a.createEvent("oDataAssociate",l.D);function I(e,t,n=m.a.Default,r={},s){const c=[];return{type:"oData.create.async",execute({getState:l,dispatch:f},g){const m=_.startStopwatch(),b=new p.a(d.a.newGuid().guid);c.push({name:u.b.ClientRequestId,value:b&&b.RequestId?b.RequestId():null});const y=f(Object(i.f)(e,!1,[],s)).then(()=>{const i=Object(h.d)(l(),g,[e],"oData.create.async");if(i)throw i;const s=new o.b(e,t);return g.DataSource.executeOData(s,b,n,c,r).nativePromise().then(e=>Object(a.c)(e))});return y.then(()=>m(),()=>m()),y},getFailureParameters:(e,t)=>c}}function w(e,t,n,r=!1,a=m.a.Default,s={},c){const l=[],g="oData.retrieve.async";return{type:g,execute({getState:m,dispatch:_},S){const O=v.startStopwatch(),C=Object(b.h)(m())&&s.OperationSource===y.b.ClientApiRetrieveRecord,E=new p.a(d.a.newGuid().guid,void 0,C);l.push({name:u.b.ClientRequestId,value:E&&E.RequestId?E.RequestId():null});const I=_(Object(i.f)(e.etn,!1,[],c)).then(()=>{const i=Object(h.d)(m(),S,[e.etn],g);if(i)throw i;const c=new o.j(e.etn,e.id.guid,t,n,null,r);return S.DataSource.executeOData(c,E,a,l,s).nativePromise().then(e=>{const t=C?e.clone():e,n=Object(f.a)(t.headers,"Content-Type");return n&&"application/octet-stream"===n?t.arrayBuffer():t.json()})});return I.then(()=>O(),()=>O()),I},getFailureParameters:(e,t)=>l}}function j(e,t,n,r=m.a.Default,a={},s,c){const l=[],f="oData.retrieveMultiple.async";return{type:f,execute({getState:g,dispatch:m},_){const v=S.startStopwatch(),O=Object(b.h)(g())&&a.OperationSource===y.b.ClientApiRetrieveMultipleRecords,C=new p.a(d.a.newGuid().guid,void 0,O);l.push({name:u.b.ClientRequestId,value:C&&C.RequestId?C.RequestId():null});const E=m(Object(i.f)(e,!1,[],s)).then(()=>{const i=Object(h.d)(g(),_,[e],f);if(i)throw i;const s=new o.j(e,null,t,null,n);return _.DataSource.executeOData(s,C,r,l,a,null,c).nativePromise().then(e=>O?e.clone().json():e.json())});return E.then(()=>v(),()=>v()),E},getFailureParameters:(e,t)=>l}}function P(e,t,n,r,a,s=m.a.Default,c={},l){const f=[];return{type:"oData.update.async",execute({getState:g,dispatch:m},b){const y=O.startStopwatch(),_=new p.a(d.a.newGuid().guid);f.push({name:u.b.ClientRequestId,value:_&&_.RequestId?_.RequestId():null});const v=m(Object(i.f)(e.etn,!1,[],l)).then(()=>{const i=Object(h.d)(g(),b,[e.etn],"oData.update.async");if(i)throw i;const l=new o.k(e.etn,e.id.guid,t,n,r,a);return b.DataSource.executeOData(l,_,s,f,c).nativePromise().then(e=>e)});return v.then(()=>y(),()=>y()),v},getFailureParameters:(e,t)=>f}}function T(e,t,n=m.a.Default,a={},s){const c=[],l="oData.delete.async";return Object(g.a)(arguments,{type:l,execute({getState:f,dispatch:g},m){const b=C.startStopwatch(),y=new p.a(d.a.newGuid().guid);c.push({name:u.b.ClientRequestId,value:y&&y.RequestId?y.RequestId():null});const _=g(Object(i.f)(e.etn,!1,[],s)).then(()=>{const i=Object(h.d)(f(),m,[e.etn],l);if(i)throw i;const s=r.a.toLegacyEntityReference(e),u=r.a.legacyToExternalEntityReference(s),d=new o.c(u,t);return m.DataSource.executeOData(d,y,n,c,a).nativePromise().then(e=>null)});return _.then(()=>b(),()=>b()),_},getFailureParameters:(e,t)=>c})}function N(e,t,n,a){const s=[],c="oData.associate.async";return{type:c,execute({getState:l,dispatch:f},g){const m=E.startStopwatch(),b=new p.a(d.a.newGuid().guid);s.push({name:u.b.ClientRequestId,value:b&&b.RequestId?b.RequestId():null});const y={[e.etn]:[]};n.forEach(e=>{y[e.etn]=[]});const _=f(Object(i.e)(y,a)).then(()=>{const a=Object(h.d)(l(),g,Object.keys(y),c);if(a)throw a;const i=r.a.toLegacyEntityReference(e),u=r.a.legacyToExternalEntityReference(i),d=n.map(e=>{const t=r.a.toLegacyEntityReference(e);return r.a.legacyToExternalEntityReference(t)}),p=new o.a(u,t,d);return g.DataSource.executeOData(p,b,void 0,s).nativePromise().then(e=>null)});return _.then(()=>m(),()=>m()),_},getFailureParameters:(e,t)=>s}}},NjDY:function(e,t,n){"use strict";n.d(t,"e",(function(){return j})),n.d(t,"E",(function(){return l})),n.d(t,"A",(function(){return H})),n.d(t,"B",(function(){return u})),n.d(t,"C",(function(){return d})),n.d(t,"D",(function(){return p})),n.d(t,"x",(function(){return g})),n.d(t,"a",(function(){return h})),n.d(t,"n",(function(){return m})),n.d(t,"l",(function(){return b})),n.d(t,"h",(function(){return y})),n.d(t,"g",(function(){return _})),n.d(t,"i",(function(){return v})),n.d(t,"v",(function(){return S})),n.d(t,"u",(function(){return O})),n.d(t,"p",(function(){return C})),n.d(t,"s",(function(){return E})),n.d(t,"t",(function(){return I})),n.d(t,"o",(function(){return x})),n.d(t,"r",(function(){return M})),n.d(t,"q",(function(){return D})),n.d(t,"m",(function(){return F})),n.d(t,"b",(function(){return w})),n.d(t,"J",(function(){return P})),n.d(t,"G",(function(){return T})),n.d(t,"f",(function(){return N})),n.d(t,"c",(function(){return f})),n.d(t,"j",(function(){return A})),n.d(t,"H",(function(){return R})),n.d(t,"F",(function(){return k})),n.d(t,"z",(function(){return L})),n.d(t,"k",(function(){return U})),n.d(t,"I",(function(){return V})),n.d(t,"d",(function(){return z})),n.d(t,"y",(function(){return q})),n.d(t,"w",(function(){return B}));var r=n("eXjw"),a=n("NvOS"),i=n("YxC/"),o=n("eq9I"),s=n("504W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
let c;function l(e){return e.organization}function u(e){const t=l(e);return t?t.initialized:r.a.Uninitialized}function d(e){return u(e)!==r.a.Initialized?null:e.organization.organizationName}function p(e){const t=l(e);return null==t?void 0:t.organizationSettings}function f(e){const t=p(e);return!!t&&!!t.allowLegacyDialogsEmbedding}function g(e){const t=p(e);return null!=t&&(c=Object(a.a)(e,"/"+t.webResourceHash+"/webresources/")),c}function h(e,t){const n=/^\$webresource:/i;if(t){let r=t.replace(n,"");return r=(r.startsWith("/")?"":e)+r,r}return""}function m(e){const t=p(e);return null!=t&&t.isMocaOfflineFeatureEnabled}function b(e){const t=p(e);return null!=t&&t.isConflictDetectionEnabledForMobileClient}function y(e){const t={};return e.organization.organizationSettings.enabledLanguages.map(n=>{const r=String.format(o.m,n);t[n]=Object(i.b)(e,r)}),t[0]=Object(i.b)(e,o.a),t[-1]=Object(i.b)(e,o.e),t}function _(e){const t=[],n=p(e);return n&&n.enabledLanguages&&n.enabledLanguages.map(n=>{const r=String.format(o.m,n),a={localeId:n,label:Object(i.b)(e,r)};t.push(a)}),t}function v(e){const t=p(e);return Object(s.a)(t)?null:t.fullNameConventionCode}function S(e){const t=p(e);return null!=t?t.norsyncServerConnectionString:""}function O(e){const t=p(e);return null!=t&&t.isTrialOrganization}function C(e){const t=p(e);return null!=t&&t.isPreviewOrganization}function E(e){const t=p(e);return null!=t&&t.isSandboxOrganization}function I(e){const t=p(e);return null!=t&&t.isSovereignCloud}function w(e){const t=p(e);return null!=t?t.advancedDebuggabilitySettings:""}function j(e){const t=p(e);return t&&t.currentThemeData?t.currentThemeData:""}function P(e){const t=p(e);return t?t.officePortalUrl:""}function T(e){const t=p(e);return t?t.ppacSettingsUrl:""}function N(e){const t=p(e);return t?t.customizationUrl:""}function A(e){const t=p(e);if(t&&t.globalHelpUrlEnabled&&t.globalHelpUrl)return t.globalHelpUrl}function R(e){const t=p(e);return t&&t.privacyStatementUrl?t.privacyStatementUrl:""}function D(e){const t=p(e);if(t)return!!t.isExternalSearchIndexEnabled}function x(e){const t=p(e);if(t)return!!t.newSearchExperienceEnabled}function M(e){const t=p(e);if(t)return!!t.relevanceSearchEnabledByPlatform}function F(e){const t=p(e);if(t)return!!t.improveSearchLoggingEnabled}function k(e){const t=l(e);return t&&t.organizationTenant}function L(e){const t=p(e);return t&&t.geoName}function B(e){const t=p(e);return t&&t.organizationExpiryDate}function U(e){const t=L(e);return"CHN"===(t&&t.toUpperCase())}function V(e){const t=p(e);return t&&t.useQuickFindViewForGridSearch}function z(e){const t=p(e);return t&&t.cdsCapabilityMode}function q(e){const t=p(e);return null==t?void 0:t.organizationBAPEnvironmentID}function H(e){const t=l(e);return null==t?void 0:t.organizationId}},"Nk+G":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * The unique name of the CustomControl page module.
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="Control"},Nnen:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("VJBm");class a extends r.a{constructor(e){super(e),this.set_dataAccessLayer(e)}create(e,t){this.get_dataAccessLayer().create(e,t)}retrieve(e,t){return this.get_dataAccessLayer().retrieve(e,t)}update(e,t){this.get_dataAccessLayer().update(e,t)}Delete(e,t){this.get_dataAccessLayer().Delete(e,t)}begin(e){this.get_dataAccessLayer().begin(e)}Commit(e){return this.get_dataAccessLayer().Commit(e)}}},NvOS:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("IqkD"),a=n("NjDY");function i(e,t){const n=Object(r.x)(e);let i=!1;n&&(i=n.usePathBasedUrls);const o=Object(a.D)(e);return i&&o&&o.organizationUniqueName?"/"+o.organizationUniqueName+t:t}},NvqY:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return s}));var r=n("D4rv");const a="reinitialize.router.state",i="reinitialize.appshell.state";function o(e,t){return{type:a,payload:{pageState:e,routerState:t}}}function s(e){return{type:"reinitialize.appshell.state.sync",sync:!0,execute({dispatch:t,getState:n},a){const{pages:o,router:s}=e,c=Object(r.d)(e,["pages","router"]);var l;t((l=c,{type:i,payload:Object.assign({},l)}))}}}},Nzmy:function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s}));var r=n("pEXn");let a;function i(e){a=e}function o(e,t){t.get_message()&&e.push({name:r.b.ErrorMessage,value:t.get_message()}),t.get_request()&&t.get_request().status&&e.push({name:r.b.RequestStatus,value:t.get_request().status})}function s(e){return e&&e.length>0&&e[0]&&e[0].urlParameters?e[0].urlParameters:""}},O4uv:function(e,t,n){"use strict";n.d(t,"b",(function(){return f})),n.d(t,"e",(function(){return h})),n.d(t,"c",(function(){return g})),n.d(t,"d",(function(){return m})),n.d(t,"a",(function(){return p}));var r=n("SAYH"),a=n("FZDd"),i=n("iZ7K"),o=n("uIhY"),s=n("5Oca"),c=n("Wc7r"),l=n("g22U"),u=n("8i4h"),d=n("vSoM");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const p="ReturnRowVersion";function f(e,t){t&&0!==Object.keys(t).length&&(e.additionalHeaders||(e.additionalHeaders={}),e.additionalHeaders.OfflineData=JSON.stringify(t)),function(e,t){if(e.urlParameters){const n="?tag="+t;e.urlParameters=e.urlParameters+n}}(e,"offlinePlayback")}function g(e,t,n,r=!0,a,i,o={},s,g){const h=Object(d.g)(e,t,"Create",s),m=Object(l.g)(o),b={urlParameters:""+h,body:JSON.stringify(n),additionalHeaders:{[c.HEADER.ACCEPT]:c.HEADER_VALUES.APPLICATION_JSON,[c.HEADER.MSCRM_SUPPRESS_DUPLICATION_DETECTION]:r.toString()},method:"POST",additionalParameters:Object(u.a)(l.d.CREATE,m,t)};return a&&(b.additionalHeaders[p]="true"),i&&f(b,i),g&&(b.additionalHeaders["MSCRM.SolutionUniqueName"]=g),b}function h(e,t){return{type:"SERIALIZE_CREATE_REQUEST_ASYNC",execute({dispatch:n,getState:a},s){const c=e.get_target();return n(m(c,t)).then(()=>{const t=c.get_identifier(),n=a(),s=t.get_identifier();let l;try{l=Object(o.b)(n,c)}catch(e){return{serializationFailure:e.message}}const u=e.get_suppressDuplicateDetection();if(!r.a.isNullOrEmpty(new r.a(s))){l[Object(i.h)(n,t.get_modelType()).PrimaryKeyName]=s}return g(n,t.LogicalName,l,u,e.get_returnRowVersion())})}}}function m(e,t,n=!1){return{type:"REQUEST_ADDITIONAL_METADATA_FOR_ENTITY_RECORD",execute({dispatch:r,getState:i},o){const c=Object(s.c)(i(),e,n);return r(Object(a.f)(e.get_identifier().LogicalName,!1,c,t)).then(()=>{let o=0;const c=Object(s.y)(i(),e,n).reduce((e,t)=>(e[t]=[],o++,e),{});if(o)return r(Object(a.e)(c,t))})}}}},O7zD:function(e,t,n){"use strict";n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return p})),n.d(t,"f",(function(){return m})),n.d(t,"e",(function(){return b})),n.d(t,"h",(function(){return f})),n.d(t,"a",(function(){return d})),n.d(t,"d",(function(){return g})),n.d(t,"g",(function(){return h}));var r=n("i1f0"),a=n("y60j"),i=n("arV0"),o=n("YxC/"),s=n("iZ7K"),c=n("KBcj"),l=n("jq7Z");function u(e,t,n,c){const u=Object(o.b)(n,"MenuItem_Label_AddObject"),d=Object(s.h)(n,t);if(d){const o=Object(r.H)(n,{id:e,controlName:d.PrimaryNameAttribute},c),s=Object(l.b)(n,e,c),p=d.DisplayName,f=Object(a.k)(n,t,s),g=f?f.name+": ":"",h=p&&u?String.format(u,p):"",m=Object(r.fc)(n,e,c),b=p?p+": "+g:"",{id:y}=Object(i.j)(n,e);return b+Object(r.tb)(y,o,h,m)}}function d(e,t,n){if(e)return e+"_url";if(t&&n){const e=Object(s.h)(t,n);if(e&&e.PrimaryImageAttribute)return e.PrimaryImageAttribute+"_url"}return null}function p(e,t,n,a,i){let o,l="";const u=Object(s.h)(n,t);u&&(l+=u.DisplayName,o=Object(r.H)(n,{id:e,controlName:u.PrimaryNameAttribute},i));const d=Object(c.c)(n,a);return d&&d.title&&(l?l+=": "+d.title:l=d.title),o&&(l?l+=": "+o:l=o),l}function f(e,t){return t?`${e}_${t}`:e}function g(e,t){return`${e}+${t}`}function h(e,t){if((null==e?void 0:e.length)&&(null==t?void 0:t.length))return e.substr(0,e.length-t.length-"_".length)}var m,b;!function(e){e[e.UseCollectionName=0]="UseCollectionName",e[e.UseLabel=1]="UseLabel",e[e.DoNotDisplay=2]="DoNotDisplay"}(m||(m={})),function(e){e[e.Details=0]="Details",e[e.Sales=1]="Sales",e[e.Service=2]="Service",e[e.Marketing=3]="Marketing",e[e.InternetMarketing=4]="InternetMarketing",e[e.Processes=5]="Processes",e[e.Async=6]="Async"}(b||(b={}))},OBdv:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("jZCH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e){let t=null,n=null;t=r.a.get_DefaultInstance().get_UserContext().get_UserSettings().get_languageId().toString(),n=r.a.get_DefaultInstance().get_UserContext().get_organizationSettings().get_languageCode().toString();const a={};for(let t=0,n=e.childNodes.length;t<n;t++){const n=e.childNodes[t];if("a:UserLocalizedLabel"===n.nodeName&&i(a,n),"a:LocalizedLabels"===n.nodeName)for(let e=0,t=n.childNodes.length;e<t;e++)i(a,n.childNodes[e])}return t in a?a[t]:n in a?a[n]:null}function i(e,t){let n=null,r=null;for(let e=0,a=t.childNodes.length;e<a;e++){const a=t.childNodes[e];"a:LanguageCode"===a.nodeName&&(n=a.firstChild.nodeValue),"a:Label"===a.nodeName&&a.firstChild&&(r=a.firstChild.nodeValue)}return e[n]=r,n}},OCdQ:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("GotM"),a=function(){function e(){var e=this;this._hasAlertedSinceLastIdle=!1,this._patchAlert(window),r.forEachAdditionalWindow((function(t){e._patchAlert(t.contentWindow)}))}return e.prototype.resetTracking=function(){var e=this;this._hasAlertedSinceLastIdle=!1,r.forEachAdditionalWindow((function(t){e._patchAlert(t.contentWindow)}))},e.prototype.hasAlertedSinceLastIdle=function(){return this._hasAlertedSinceLastIdle},e.prototype._patchAlert=function(e){var t=this;if(!e.alertPatched){var n=e.alert;e.alert=function(e){t._hasAlertedSinceLastIdle=!0,n(e)};var r=e.confirm;e.confirm=function(e){return t._hasAlertedSinceLastIdle=!0,r(e)},e.alertPatched=!0}},e}();t.default=a},OEF1:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e){return e.session.hostSubtype}function a(e){return e.session.hostType}function i(e){return e.session.playerName}function o(e){return e.session.hostData?e.session.hostData:[]}function s(e,t){const n=e.session.hostData;let r;return n&&(r=n.find(e=>e.key===t)),r}function c(e){return e.session.hostOptionInitialized}n.d(t,"d",(function(){return r})),n.d(t,"e",(function(){return a})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"f",(function(){return i}))},OEUm:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return c}));let r;class a{constructor(){this._enabledForSession=!1,this._enabledForSession=this._readEnabledFormStorage(),this._enabledForSession&&this.toggleForNextSession(!1)}static getInstance(){return r||(r=new a),r}enabledForCurrentSession(){return this._enabledForSession}enabledForNextSession(){return this._readEnabledFormStorage()}toggleForNextSession(e){try{localStorage.setItem("DeveloperToolsSwitch",e.toString())}catch(e){}}_readEnabledFormStorage(){try{return"true"===localStorage.getItem("DeveloperToolsSwitch")}catch(e){return!1}}}function i(){return a.getInstance().enabledForCurrentSession()}function o(){return a.getInstance().enabledForNextSession()}function s(){a.getInstance().toggleForNextSession(!0)}function c(e){a.getInstance().toggleForNextSession(e)}},OJOs:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("XjOj"),a=n("Div0"),i=n("2mBq"),o=n("NMtn"),s=n("qGFd"),c=n("504W"),l=n("Tsbx");class u{constructor(e,t,n,r,a=s.b.OrgDb){this._sql=null,this._args=null,this._storeDbType=null,this._successCallback=null,this._errorCallback=null,Object(o.c)(e,"sql"),Object(o.b)(t,"args"),Object(o.b)(n,"successCallback"),Object(o.b)(r,"errorCallback"),this._sql=e,this._args=t,this._successCallback=n,this._errorCallback=r,this._storeDbType=Object(c.a)(a)?s.b.OrgDb:a}addToBatch(e){e.addRequest(this._sql,this._args,e=>{this._successCallback(e)},e=>{const t=Object(i.a)("Sql error: ErrorCode = {0}, ErrorMessage = {1}",e.code,e.message);Object(r.d)(a.a.sql,t),this._errorCallback(e)})}get_storeDbType(){return this._storeDbType}calculateEstimatedSize(){return Object(l.a)(this._sql,this._args)}}},OKVy:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * The unique name of the Dashboard page module.
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="Dashboard"},OQLa:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return l}));var r=n("pF61"),a=n("arV0"),i=n("NvOS");function o(e,t){return{type:"clientapi.create.page.url",sync:!0,execute:(n,r)=>r.Router.createUrlForPage(e,t)}}function s(e,t){return{type:"clientapi.create.mobile.page.url",sync:!0,execute:(n,r)=>r.Router.createMobileClientUrlForPage(e,t)}}function c(e,t,n){return{type:"clientapi.create.web.page.url",sync:!0,execute:(r,a)=>a.Router.createWebUrlForPage(e,t,n)}}function l(){return{type:"clientapi.get.current.page.search.params",sync:!0,execute(e,t){const n=e.getState(),o=Object(i.a)(n,""),s=Object(r.c)(n),l=Object(a.p)(n,s),u=Object(a.j)(n,s),d=e.dispatch(c(o,l,u));return new URL(d,window.location.origin).searchParams.toString()}}}},ORLm:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e){return e.appShellState.globalSearchState}function a(e){return r(e).indexReady}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}))},ORpD:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return s}));var r=n("gNtT"),a=n("qJCH"),i=n("tHOi");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const o="userAccessibilitySettings.set";function s(e){return{type:o,payload:e}}function c(e){return{type:"userAccessibilitySettings.save",execute({dispatch:t}){t(s(e));const n=a.a.createFromObjectData({key:r.b,personalization:e});return t(Object(i.a)(n))}}}},OU7F:function(e,t,n){"use strict";n.d(t,"n",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return c})),n.d(t,"d",(function(){return l})),n.d(t,"l",(function(){return u})),n.d(t,"k",(function(){return d})),n.d(t,"i",(function(){return p})),n.d(t,"j",(function(){return f})),n.d(t,"e",(function(){return g})),n.d(t,"f",(function(){return h})),n.d(t,"o",(function(){return m})),n.d(t,"m",(function(){return b})),n.d(t,"g",(function(){return y})),n.d(t,"h",(function(){return _}));var r=n("nJrx"),a=n("JQqP");
/**
 * Constants for the search page
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i="search-root-select",o="CategorizedSearchResultsScrollWrapper",s=Object(r.a)(),c=Object(r.a)(),l=Object(r.a)(),u="MscrmControls.Containers.RelevanceSearchControl",d="searchresultsgrid",p="globalsearchflyoutmru",f="globalsearchflyoutsugggestions",g=2,h="/api/search/v1.0/query",m="/api/search/v1.0/suggest",b="/api/search/v1.0/status",y=a.e+".FilterClicked",_="search-page-side-pane"},Oawc:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("x0oY"),a=n("Jj4w"),i=n("lx8z");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function o(e,t,n){return{type:"DESERIALIZE_INITIALIZE_FROM_RESPONSE_ASYNC",execute:({dispatch:o,getState:s},c)=>e.json().then(e=>{const s=t instanceof a.a?t.get_targetEntityName():t.TargetEntityName;return o(Object(r.e)(e,s,n)).then(e=>new i.a(e))})}}},OcZc:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("FZDd"),a=n("iZ7K"),i=n("LbMF"),o=n("x0oY"),s=n("7O3c");function c(e){return e&&e["@odata.type"]?e["@odata.type"].split(".").pop():null}function l(e,t,n){if(!e||!t||!n)return null;const r=Object(a.h)(e,t),s=Object(i.d)(e,t);return Object(o.d)(e,n,r,s)}function u(e,t,n){return{type:"DESERIALIZE_RETRIEVE_PROCESS_CONTROL_DATA_RESPONSE_ASYNC",execute:({dispatch:t,getState:a},i)=>e.json().then(e=>{if(!e)throw new Error("Empty response is returned for RetrieveProcessControlData");const i=e.GlobalNavigationData,u=e.Entity,d=e.BpfDefinitionVersionNumber?e.BpfDefinitionVersionNumber.toString():null,p={},f=c(i),g=c(u);return f&&(p[f]=Object(o.h)(i)),g&&(p[g]=Object(o.h)(u)),t(Object(r.e)(p,n)).then(()=>{const e=a();return new s.a(l(e,g,u),l(e,f,i),d)})})}}},OiiO:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n("M0zh");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t=!1){return{type:"commanding.initializescriptcontainer.async",execute:({dispatch:n,getState:r},a)=>a.ScriptManager.initializeContainerForClientApi(e,!t)}}function i(e,t){const n={createdScriptContainer:e};return{type:r.o,payload:n,meta:{commandManagerId:t}}}},OmkB:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("oT5e"),a=n("zsAz"),i=n("+nTZ"),o=n("tFCh");function s(e,t){return{type:"router.close.popup.async",execute({dispatch:n,getState:s},c){const l=c.Router.getPopup(e);if(l){const c=Object(r.b)(s(),e);if(!c)throw Object(a.d)("Browsingcontext does not exist for pageId",2415919107,[{name:"pageId",value:e}]);const u=Object(i.b)(s(),e);if(!u)throw Object(a.d)("dialogContext does not exist for pageId",2415919107);t&&l.closeHandler&&l.closeHandler(),n(Object(o.c)(u.dialogContextId,e,c.id))}return Promise.resolve()}}}},OpjU:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="isReauthInProgress.set";function a(e){return{type:r,payload:{isReauthInProgress:e}}}},OtHk:function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return g})),n.d(t,"a",(function(){return h})),n.d(t,"h",(function(){return m})),n.d(t,"g",(function(){return d})),n.d(t,"f",(function(){return p})),n.d(t,"e",(function(){return f})),n.d(t,"i",(function(){return b}));var r=n("SAYH"),a=n("eXjw"),i=n("y60j"),o=n("AF/G"),s=n("iZ7K");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const c=["95f2e667-95c3-e611-80d6-00155db7dbc8"];function l(e,t,n,r){return e&&e.metadata?n&&e.metadata.dashboardsByNavPath?e.metadata.dashboardsByNavPath[n]:t&&e.metadata.dashboards?e.metadata.dashboards[t.guid]:r&&e.metadata.dashboardsByEntityName?e.metadata.dashboardsByEntityName[r]:null:null}function u(e){return e&&e.metadata&&e.metadata.dashboardSelectors?e.metadata.dashboardSelectors:null}function d(e,t){return e&&e.metadata&&e.metadata.dashboardSelectorsByEntityName&&t?e.metadata.dashboardSelectorsByEntityName[t]:null}function p(e,t){const n=f(e,t),a=d(e,t);return a?a[r.a.toString(n)]:null}function f(e,t){return e&&e.metadata&&e.metadata.dashboardsByEntityName&&e.metadata.dashboardsByEntityName[t]?e.metadata.dashboardsByEntityName[t].FormId:null}function g(e,t,n,r){const i=l(e,t,n,r);return i?i.Initialized:a.a.Uninitialized}function h(e,t){const n=Object(i.h)(e,t);return n&&n.TabAttributes&&n.TabAttributes.PrimaryEntity}function m(e,t){const n=Object(i.h)(e,t),a={};if(n&&n.Controls)for(const t in n.Controls){const i=n.Controls[t];if(i.ClassId&&i.ClassId.guid&&r.a.equals(i.ClassId,o.mb)){const t=i.Parameters&&i.Parameters[0]&&i.Parameters[0].StreamObjects&&i.Parameters[0].StreamObjects.StreamObjectCollection;if(t)for(const n of t)if(0===n.Type||2===n.Type){const t=Object(s.h)(e,n.LogicalEntityName),r=t&&t.ObjectTypeCode;a[n.LogicalEntityName]=null!=r?r.toString():"0"}}}return a}function b(e){return-1!==c.indexOf(r.a.toString(e))}},OwbH:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("UDbe");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class a{constructor(e){this._searchFields=null,this._searchFields=e||[]}get_queryFields(){return this._searchFields}get_field(){return this.get_queryFields()[0]}isSatisfiedByRecord(e,t){const n=this.get_field().get_path()===r.a.get_id().get_path()?e:this.get_field().getField(t);return this.testCondition(n)}isSatisfiedBy(e){const t=e[this.get_field().get_path()];return this.testCondition(t)}}},Oz8S:function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return s})),n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return l}));var r=n("2jAf");const a=[r.b,r.a],i={};function o(e=i,t){return-1!==a.indexOf(t.type)&&t&&t.payload&&t.payload.entities?t.type===r.a?l(e,t.payload.entities):c(e,t.payload.entities):e}function s(e=i,t){return-1!==a.indexOf(t.type)&&t&&t.payload&&t.payload.ribbons?t.type===r.a?l(e,t.payload.ribbons):c(e,t.payload.ribbons):e}function c(e,t){if(0===Object.keys(t).length)return e;const n=Object.assign({},e);for(const e in t)n[e]=Object.freeze(t[e]);return Object.freeze(n)}function l(e,t){if(0===Object.keys(t).length)return e;const n={};for(const r in e)void 0===t[r]&&(n[r]=e[r]);return Object.freeze(n)}},OzPR:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(){try{new URL(window.location.href,window.location.origin).searchParams.get("useLocal");return null}catch(e){return null}}n.d(t,"a",(function(){return r}))},"P+kM":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="dataSnapshot.setLock";function a(e,t,n){return{type:r,payload:t,meta:{snapshotId:e,selectedFields:n}}}},"P+p9":function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o}));var r=n("Ua4i");const a="clear.globalNotificationAction";function i(e){return{type:"clear.globalNotificationAction.async",execute({dispatch:t,getState:n}){const r={type:a,payload:e};return Promise.resolve(t(r))}}}function o(e){return{type:"clear.clearGlobalNotificationAndExecuteHandler.async",execute({dispatch:t,getState:n}){const a=Object(r.a)(n(),e);return t(i(e)).then(()=>{a.props.onCloseHandler&&a.props.onCloseHandler()})}}}},P4TJ:function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"d",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="set.apphostclient.initialized",a="set.apphostclient.initialize.error",i="set.apphostclientbundle.loaded",o="KNOWN_SERVERS"},P68g:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e,t){return e?Object.keys(e).reduce((n,r)=>(n[r]=t(e[r]),n),{}):null}n.d(t,"a",(function(){return r}))},P6DH:function(e,t,n){"use strict";n.d(t,"a",(function(){return K})),n.d(t,"i",(function(){return V})),n.d(t,"f",(function(){return z})),n.d(t,"h",(function(){return q})),n.d(t,"e",(function(){return H})),n.d(t,"g",(function(){return W})),n.d(t,"b",(function(){return G})),n.d(t,"c",(function(){return Q})),n.d(t,"d",(function(){return X})),n.d(t,"v",(function(){return Y})),n.d(t,"y",(function(){return J})),n.d(t,"ab",(function(){return $})),n.d(t,"U",(function(){return Z})),n.d(t,"eb",(function(){return Xe})),n.d(t,"E",(function(){return ee})),n.d(t,"J",(function(){return se})),n.d(t,"V",(function(){return te})),n.d(t,"r",(function(){return re})),n.d(t,"fb",(function(){return pe})),n.d(t,"R",(function(){return he})),n.d(t,"O",(function(){return me})),n.d(t,"M",(function(){return be})),n.d(t,"N",(function(){return ye})),n.d(t,"L",(function(){return _e})),n.d(t,"ib",(function(){return Oe})),n.d(t,"S",(function(){return Ce})),n.d(t,"P",(function(){return Ee})),n.d(t,"K",(function(){return Ie})),n.d(t,"j",(function(){return Pe})),n.d(t,"k",(function(){return Te})),n.d(t,"l",(function(){return Ne})),n.d(t,"W",(function(){return Ae})),n.d(t,"n",(function(){return xe})),n.d(t,"mb",(function(){return de})),n.d(t,"db",(function(){return Me})),n.d(t,"Z",(function(){return Fe})),n.d(t,"F",(function(){return Se})),n.d(t,"kb",(function(){return Be})),n.d(t,"pb",(function(){return Le})),n.d(t,"H",(function(){return ke})),n.d(t,"T",(function(){return qe})),n.d(t,"rb",(function(){return Ve})),n.d(t,"sb",(function(){return ze})),n.d(t,"I",(function(){return ce})),n.d(t,"D",(function(){return le})),n.d(t,"nb",(function(){return ue})),n.d(t,"B",(function(){return fe})),n.d(t,"x",(function(){return ge})),n.d(t,"bb",(function(){return we})),n.d(t,"vb",(function(){return Ge})),n.d(t,"t",(function(){return He})),n.d(t,"u",(function(){return We})),n.d(t,"w",(function(){return ne})),n.d(t,"jb",(function(){return Ye})),n.d(t,"yb",(function(){return Ke})),n.d(t,"q",(function(){return Je})),n.d(t,"C",(function(){return Ze})),n.d(t,"m",(function(){return et})),n.d(t,"cb",(function(){return nt})),n.d(t,"lb",(function(){return ie})),n.d(t,"X",(function(){return oe})),n.d(t,"s",(function(){return ae})),n.d(t,"p",(function(){return $e})),n.d(t,"qb",(function(){return at})),n.d(t,"gb",(function(){return it})),n.d(t,"ob",(function(){return rt})),n.d(t,"Bb",(function(){return je})),n.d(t,"A",(function(){return ot})),n.d(t,"z",(function(){return st})),n.d(t,"Q",(function(){return ve})),n.d(t,"Y",(function(){return Re})),n.d(t,"Ab",(function(){return De})),n.d(t,"o",(function(){return ct})),n.d(t,"ub",(function(){return lt})),n.d(t,"tb",(function(){return Ue})),n.d(t,"hb",(function(){return ut})),n.d(t,"wb",(function(){return dt})),n.d(t,"xb",(function(){return tt})),n.d(t,"G",(function(){return Qe})),n.d(t,"zb",(function(){return pt}));var r,a=n("SAYH"),i=n("eXjw"),o=n("arV0"),s=n("KBcj"),c=n("Z/4N"),l=n("DD48"),u=n("3hnk"),d=n("CngE"),p=n("5Oca"),f=n("LbMF"),g=n("d0w6"),h=n("vmcK"),m=n("g03H"),b=n("YxC/"),y=n("dHD5"),_=n("jRy5"),v=n("BFlg"),S=n("iZ7K"),O=n("E5IU"),C=n("IqkD"),E=n("9fGf"),I=n("BzGi"),w=n("69Qu"),j=n("3/02"),P=n("Lyxw"),T=n("jAuy"),N=n("whN/"),A=n("sZ+8"),R=n("NM3A"),D=n("+QYJ"),x=n("i1f0");!function(e){e[e.None=0]="None",e[e.CommunicationActivity=1]="CommunicationActivity"}(r||(r={}));var M=n("qLnS"),F=n("/A0C"),k=n("zmL5"),L=n("jq7Z"),B=n("uNu9"),U=n("NjDY");const V="task",z="fax",q="phonecall",H="email",W="letter",G="appointment",K=v.a,Q="HierarchyDataChildCount6dcd9e4c001441b09237d51a34853d55",X="CountChildren";function Y(e,t,n){const r=Object(L.a)(e,t);if(!(e&&t&&r))return null;const a=Object(y.w)(n),i=r;return i&&i.datasets&&i.datasets[a]?i.datasets[a]:null}function J(e,t,n){const r=Y(e,t,n);return r?r.pageNumber:null}function $(e,t,n){const r=Y(e,t,n);return!!r&&r.isNewPageRequested}function Z(e,t,n){const r=te(e,t.id,n);return r?Ue(e,r,t.id):null}function ee(e,t,n){const r=[],a=Ce(e,t.id,n);if(a){const t=Object(f.d)(e,a);if(t)for(const e of Object.keys(t)){const n=t[e];r.push(n.LogicalName)}}else{const a=Z(e,t,n);if(a&&a.grid&&a.grid.rows&&a.grid.rows.forEach(e=>{e.cells&&a.grid.rows[0].cells.forEach(e=>{e.name&&r.push(e.name)})}),a&&a.entityLogicalName===B.zb&&Object(P.f)(e,j.cg)){const a=ge(e,n,t.id);if(a)for(const e of a)-1===r.indexOf(e)&&r.push(e)}}return r}function te(e,t,n,r){const a=Y(e,t,n);return a&&a.viewId}function ne(e,t,n){const r=Y(e,t,n);return r&&r.commandManagerId}function re(e,t,n,r){const s=Y(e,t,n);let c=s&&s.visualizationId;const l=Object(o.j)(e,t);return!c&&l.visualizationId&&(c=l.visualizationId),c||(c=Object(d.j)(e,r)),c||Object(d.h)(e,r)!==i.a.Initialized||(c=a.a.EMPTY),c}function ae(e,t,n){const r=Y(e,t,n);let a=r&&r.chartVisualizationType;return a||(a=I.a.savedvisualization),a}function ie(e,t,n){const r=Y(e,t,n);return!(!r||!r.showChart)}function oe(e,t,n){const r=Y(e,t,n);return!(!r||!r.isChartOnTheRightSide)}function se(e,t,n){const r=te(e,n.id,t);if(r){const a=[],i=Ue(e,r,n.id);if(i&&i.grid){const r=i.grid.rows[0].cells;for(const e in r)r.hasOwnProperty(e)&&a.push(r[e].name);const o=Y(e,n.id,t);if(o){const t=o.queryKey,n=o.pageNumber;if(t&&n)return Object(p.r)(e,t,n,a)}}}return[]}function ce(e,t,n){if(!n){const{entityTypeName:r}=Object(o.j)(e,t.id);n=r}return Object(p.g)(e,n)}function le(e,t,n){if(t){const r=Y(e,t,n);if(r&&r.filters)return r.filters}return null}function ue(e,t,n){if(Object(w.c)(e)&&t){const r=Y(e,t,n);if(r&&r.useRollupView)return r.useRollupView}return!1}function de(e,t,n){const r=pe(e,t,n),a=Object(p.o)(e,r);return a?a.totalRecordCountLimitExceeded:null}function pe(e,t,n){const r=Y(e,n.id,t);return r&&r.queryKey?r.queryKey:null}function fe(e,t,n){const r=Y(e,n.id,t);return r&&r.fetchXml?r.fetchXml:null}function ge(e,t,n){const r=Y(e,n,t);return(null==r?void 0:r.fetchXmlColumns)||[]}function he(e,t,n){const r=Y(e,n.id,t);return r&&r.rowProperties?r.rowProperties:null}function me(e,t,n,r){const a=ve(e,t,n,r);if(a&&null!==a.requiredLevel)return a.requiredLevel;if(n.entityTypeName){const t=Object(f.d)(e,n.entityTypeName);if(t&&t[r])return t[r].RequiredLevel}return 0}function be(e,t,n,r,a,i){let o=!1;if(n&&(n.entityTypeName||i)){let s=n.entityTypeName||i;const c=Object(f.d)(e,s);let l=c&&c[r];if(!l&&Object(S.r)(e,s)){s=K;const t=Object(f.d)(e,K);l=t&&t[r]}if(l&&l.IsValidForUpdate){const t=Object(u.f)(e,s,r,M.a.CanUpdate,a),n=Object(u.g)(e,s,3,0);o=t&&n}if(o){const a=ve(e,t,n,r);o=!a||!a.isDisabled}}return o}function ye(e,t,n,r){const a=ve(e,t,n,r);return a&&a.notifications?a.notifications:null}function _e(e,t,n,r){const a=ye(e,t,n,r);if(a){const e=Object.keys(a);if(e&&e.length&&a[e[0]].messages&&a[e[0]].messages.length)return a[e[0]].messages[0]}return null}function ve(e,t,n,r){if(!e||!n||!r)return null;if(t&&n.recordId&&n.parentContextToken){const i=Y(e,t,n.parentContextToken);if(i&&i.rowProperties&&i.rowProperties.records){const e=i.rowProperties.records.filter(e=>Object.keys(e)[0]===a.a.toString(n.recordId));if(e&&e.length>0&&e[0][a.a.toString(n.recordId)]){const t=e[0][a.a.toString(n.recordId)].filter(e=>Object.keys(e)[0]===r);if(t&&t.length>0&&t[0][r])return t[0][r]}}}return null}function Se(e,t){return t&&t.entityLogicalName?Object(f.d)(e,t.entityLogicalName):null}function Oe(e,t,n){const r=Y(e,t,n);if(r)return r.selectedRows}function Ce(e,t,n){const r=Y(e,t,n);if(r)return r.selectedRelatedEntity}function Ee(e,t,n){const r=Y(e,t,n);return r?r.refreshCounter:0}function Ie(e,t,n){const r=Y(e,t,n);return r?r.pagingRefreshInput:0}function we(e,t,n){const r=Y(e,t,n);if(r)return r.pagingData}function je(e,t,n){return!(!Object(P.f)(e,j.tb)||!Object(T.g)(t,n))}function Pe(e=null){let t=null,n=null,r=null,i=null,s=!1;return(c,u,d)=>{const p=h.a,f=Object(o.j)(c,u),g=null==f?void 0:f.entityTypeName,b=!(!ie(c,u,d)&&!(null==f?void 0:f.showChart)),y=e||te(c,u,d),_=Object(E.b)(c);if(!(c&&c.metadata&&g&&p&&y&&y.guid))return null;const v=Object(L.a)(c,u);if(v&&v.pageViewConfigurations&&v.pageViewConfigurations[y.guid]&&v.pageViewConfigurations[y.guid].CustomControls&&v.pageViewConfigurations[y.guid].CustomControls[_])return v.pageViewConfigurations[y.guid];if(v&&v.gridConfigurations&&v.gridConfigurations[g]&&v.gridConfigurations[g][p]&&v.gridConfigurations[g][p].CustomControls&&v.gridConfigurations[g][p].CustomControls[_]){return v.gridConfigurations[g][p]}if(c.metadata.views[y.guid]&&c.metadata.views[y.guid].grid&&c.metadata.views[y.guid].grid.customControlDescriptions){const e=c.metadata.views[y.guid].grid.customControlDescriptions;if(v&&v.pageViewConfigurations&&null===v.pageViewConfigurations[y.guid]);else if(e&&e.CustomControls&&e.CustomControls[_])return e}const S=c.metadata.homePageConfigurations;if(S&&S[g]&&S[g][p]&&S[g][p].CustomControls&&S[g][p].CustomControls[_]&&!je(c,S[g][p].CustomControls[_],_)&&!function(e,t){return!(!Object(l.c)(e)||!function(e){return!!(null==e?void 0:e.advancedFindExperience)}(t))}(c,f))return S[g][p];if(n!==p||r!==g||!a.a.equals(i,y)||s!==b){n=p,r=g,i=y,s=b;const{pcfDatasetGridEnabled:e}=Object(U.D)(c),o=b?Object(m.x)(p,g,a.a.toString(y),e):Object(m.w)(p,g,a.a.toString(y),e);o.FormFactor=_,t={UniqueId:"00000000-0000-0000-0000-000000000000",CustomControls:{[_]:o}}}return t}}function Te(e,t,n){const r=h.a,{entityTypeName:a}=Object(o.j)(e,t);return e&&e.metadata&&e.metadata.homePageConfigurations&&e.metadata.homePageConfigurations[a]&&a&&r?e.metadata.homePageConfigurations[a][r]:null}function Ne(e,t){const n=h.a;return e&&e.metadata&&e.metadata.homePageConfigurations&&e.metadata.homePageConfigurations[t]&&t&&n?e.metadata.homePageConfigurations[t][n]:null}function Ae(e,t,n){const r=h.a,{entityTypeName:a}=Object(o.j)(e,t);if(!(e&&e.metadata&&a&&r))return null;const i=e.metadata.homePageBusinessLogics;return i&&i[a]&&i[a][r]?i[a][r]:null}function Re(e,t,n,r,a){const i=r.contextTokenType;if(i!==_.a.MainGrid&&i!==_.a.AssociatedGrid&&i!==_.a.SubGrid)return null;if(i===_.a.SubGrid)return De(e,t,r,a);if(i===_.a.AssociatedGrid){const r=function(e,t,n){if(!t)return null;const r=Object(E.b)(e);let a,i=e.metadata.homePageConfigurations;i&&i[t]&&i[t][h.a]&&i[t][h.a].CustomControls&&i[t][h.a].CustomControls[r]&&(a=i[t][h.a].CustomControls[r]);i=Object(L.a)(e,n).gridConfigurations,i&&i[t]&&i[t][h.a]&&i[t][h.a].CustomControls&&i[t][h.a].CustomControls[r]&&(a=i[t][h.a].CustomControls[r]);if(a)return!je(e,a,r)&&Ke(a.Parameters);return null}(e,n,t);return null===r?null:r}const o=Pe()(e,t,r),s=Object(E.b)(e);return Ke((o&&!Object(D.c)(s)&&o.CustomControls&&o.CustomControls[s]).Parameters)}function De(e,t,n,r){const a=Object(L.a)(e,t),i=Object(E.b)(e);let o;o=n.contextTokenType===_.a.SubGrid?n.parentContextToken:n;const s=Object(x.ib)(e,{id:t},o);if(a&&a.gridConfigurations){const n=Object(k.b)(e,t);if(s&&s.Controls&&i&&n){const t=n.guid,o=s.Controls[r];if(o){const n=o.UniqueId;if(n&&t&&a.gridConfigurations[t]&&a.gridConfigurations[t][n]&&a.gridConfigurations[t][n].CustomControls&&a.gridConfigurations[t][n].CustomControls[i]&&a.gridConfigurations[t][n].CustomControls[i].Parameters){const r=a.gridConfigurations[t][n].CustomControls[i];if(r)return!je(e,r,i)&&Ke(r.Parameters)}}}}if(s&&s.Controls){const t=s.Controls[r];if(t&&t.UniqueId&&s.ControlConfigurations){const n=s.ControlConfigurations[t.UniqueId];if(n&&n.CustomControls){const t=n.CustomControls[i];if(t)return!je(e,t,i)&&Ke(t.Parameters)}}}return!1}function xe(e,t,n,r,a){const i=h.a,o=Object(E.b)(e);if(!n||!t||!t.guid)return null;const s={DefaultViewId:t.guid,RelationshipName:r,TargetEntityType:n,EnableViewPicker:"true"},{pcfDatasetGridEnabled:c}=Object(U.D)(e),l=Object(m.z)(i,s,!0,c);let u;if(l.FormFactor=o,e.metadata.views[t.guid]&&e.metadata.views[t.guid].grid&&e.metadata.views[t.guid].grid.customControlDescriptions){const n=e.metadata.views[t.guid].grid.customControlDescriptions;n&&n.CustomControls&&n.CustomControls[o]&&(u=n.CustomControls[o])}let d=e.metadata.homePageConfigurations;d&&d[n]&&d[n][i]&&d[n][i].CustomControls&&d[n][i].CustomControls[o]&&(u=d[n][i].CustomControls[o]);const p=Object(L.a)(e,a);if(p&&p.pageViewConfigurations&&void 0!==p.pageViewConfigurations[t.guid]&&(u=p.pageViewConfigurations[t.guid].CustomControls[o]),d=p.gridConfigurations,d&&d[n]&&d[n][i]&&d[n][i].CustomControls&&d[n][i].CustomControls[o]&&(u=d[n][i].CustomControls[o]),u&&!je(e,u,o)){const a=Me(e,u.CustomControlId);return u.Parameters&&u.Parameters[a]&&(u.Parameters[a]=Object.assign(u.Parameters[a],{ViewId:t.guid,RelationshipName:r,TargetEntityType:n,EnableViewPicker:"true"})),u}return l}function Me(e,t){return function(e){if(!e||!e.Properties||!e.Properties.DataSetDefinitions)return null;for(const t in e.Properties.DataSetDefinitions)if(e.Properties.DataSetDefinitions[t].Primary)return t;return null}(Object(c.e)(e,t))}function Fe(e,t){return function(e){if(!e||!e.Properties||!e.Properties.DataSetDefinitions)return null;for(const t in e.Properties.DataSetDefinitions)if(!e.Properties.DataSetDefinitions[t].Primary)return t;return null}(Object(c.e)(e,t))}function ke(e,t,n,r){r=v.w;const a=Y(e,t,n);if(a){const e=a&&a.controls,t=e&&e[r]&&e[r].parameters;for(const e in t)if(t[e].Name===v.K)return t[e].Value}return null}function Le(e,t){const n=Object(b.e)(e,t.labelList),r=[{id:g.b.savedview.toString(),name:Object(b.c)(n,t.SYSTEM_VIEWS_LABEL_ID)},{id:g.b.userview.toString(),name:Object(b.c)(n,t.USER_VIEWS_LABEL_ID)}];return Object(P.f)(e,j.Of)?r.reverse():r}function Be(e,t,n,r){const i={TargetEntityType:null,ViewId:null,EnableViewPicker:!1};r=v.w;const o=Y(e,t,n),s=o&&o.viewId,c=o&&o.controls,l=c&&c[r]&&c[r].parameters;if(l){for(const e in l)l[e].Name===v.T&&(i.ViewId=l[e].Value),l[e].Name===v.K&&(i.TargetEntityType=l[e].Value),l[e].Name===v.q&&(i.EnableViewPicker=l[e].Value);return s&&(i.ViewId=a.a.toString(s)),i}return null}function Ue(e,t,n,r=!1){var a;let i=Object(s.c)(e,t,r);if(!i)return null;const c=Object(o.j)(e,n);if(null==c?void 0:c.pageToEditedViewMapId){const n=lt(e,c.pageToEditedViewMapId.guid,t.guid);n&&(i=Object.assign(Object.assign({},i),{fetchXML:n.fetchXml}),Object(P.e)(e,j.jf)&&(i.grid=null!==(a=n.gridDescriptor)&&void 0!==a?a:i.grid))}return i}function Ve(e,t,n){const r=Object(s.c)(e,a.a.tryParse(t));let i=null;return r&&(i=r.isUserView?R.b:R.a),i}function ze(e,t,n){const r=Object(s.e)(e,t,g.a.MAIN_APPLICATION_VIEW,n);return r?r.isUserView?g.b.userview:g.b.savedview:null}function qe(e,t,n){const r=Object(L.a)(e,t),a=Object(y.y)(n);if(r&&r.records&&r.records[a])return r.records[a].snapshotId}function He(e,t,n){const r=Y(e,t,n);return r&&r.customFilter?r.customFilter:null}function We(e,t,n){const r=He(e,t,n);return r&&r.customFilterXml?r.customFilterXml:null}function Ge(e,t){if(!e||!e.metadata||!t)return!1;const n=h.a,r=e.metadata.homePageConfigurations;if(r&&r[t]&&r[t][n]&&r[t][n].CustomControls)for(const e in r[t][n].CustomControls){if(Ke(r[t][n].CustomControls[e].Parameters))return!0}return!1}function Ke(e){return!!(e&&e.EnableEditing&&e.EnableEditing.Value)&&"yes"===e.EnableEditing.Value.toLowerCase()}function Qe(e){return Object(P.e)(e,j.xf)?v.y:pt(e)?v.C:v.D}function Xe(e){const t=[];if(e&&""!==e){const n=e.split(",");for(const e of n)t.push(a.a.toString(a.a.tryParse(e)))}return t}function Ye(e,t,n){const r=Object(L.a)(e,t.id),a=Object(y.w)(n);return r&&r.forms&&r.forms[a]?r.forms[a].selectedRelatedEntity:null}function Je(e,t,n){const r=Y(e,t,n),a=r&&r.chartFilterExpression,i=Object(o.j)(e,t);return a||i.filterExpression}function $e(e,t,n){const r=Y(e,t,n);return r&&r.chartDrillDownParameters}function Ze(e){let t=[K,V,z,q,H,W,G,"serviceappointment","campaignresponse","campaignactivity","recurringappointmentmaster","socialactivity"];const n=[],a=Object(S.a)(e);for(const e in a){const i=(a[e].ActivityTypeMask&r.CommunicationActivity)===r.CommunicationActivity;-1===t.indexOf(e)&&i&&a[e].IsEnabledInUnifiedInterface&&n.push(e)}return t=t.concat(n),function(e,t){const n=Object(O.c)(e),r=(n?n.entities:[]).map(e=>e.LogicalName),a=t.filter(e=>-1!==r.indexOf(e));return a.length?a:t}(e,t).filter(e=>!a[e]||!a[e].hasOwnProperty("IsEnabledInUnifiedInterface")||a[e].IsEnabledInUnifiedInterface)}function et(e){const t=Object(S.a)(e),n=[];for(const e in t)t[e].IsEnabledInUnifiedInterface&&n.push(e);return n}function tt(e,t){return t&&(t.toLowerCase()===K||Object(S.r)(e,t.toLowerCase()))}function nt(e){const t=Object(C.x)(e);let n={};t&&t.defaultGridViews&&(n=t.defaultGridViews);const r=Object(O.c)(e),a=(r?r.entities:[]).map(e=>e.LogicalName);for(const t in n)if(t===K||Object(S.r)(e,t)){if(a.indexOf(t)<0)break;if(Object(w.c)(e)||Object(A.n)(e,t)){const e=n[t];return{PinnedEntity:t,ViewId:e.ViewId,ViewType:e.ViewType}}}return null}function rt(e,t,n,r){const i={PinnedEntity:null,ViewId:null,ViewType:null,ExtraQueueFilter:null};if(t&&e&&e.defaultGridViews){const o=t!==K?e.defaultGridViews[t]:nt(r);o&&o.ViewId&&(n.info("User default view was found"),i.PinnedEntity=t!==K?t:o.PinnedEntity,i.ViewId=a.a.tryParse(o.ViewId),i.ViewType=o.ViewType,i.ExtraQueueFilter=Xe(o.QueueId))}return i}function at(e,t){return v.U+"_"+e+"_"+t}function it(e,t,n){let r;const a=Object(S.h)(e,t);if(a){const e=Object.assign(Object.assign(Object.assign({},a.ManyToManyRelationships),a.ManyToOneRelationships),a.OneToManyRelationships);if(e){const a=e[n];a&&1===a.RelationshipType&&(r=N.a.AssociationEntity,a.Entity2LogicalName===t&&(r=N.a.Referencing))}}return r}function ot(e,t,n,r){const a={},i=Object(f.f)(e,n,F.a.PickList),o=Object(f.f)(e,n,F.a.MultiSelectPickList),s=Object.assign(i,o),c=te(e,r,t);if(c){const t=Ue(e,c,r);if(t&&t.grid&&t.grid.rows){const e=[],n=t.grid.rows[0].cells;for(const t in n)n.hasOwnProperty(t)&&e.push(n[t].name);if(!(Object.keys(s).length>0))return null;for(let t=0;t<e.length;t++)if(s[e[t]]){const n=s[e[t]].ParentPicklistLogicalName,r=s[e[t]].ChildPicklistLogicalNames;(null!==n||null!=r&&r.length>0)&&(a[e[t]]=s[e[t]])}return a}}return null}function st(e,t,n){const r=Y(e,n,t);return r&&r.dependentOptionSetColumnStatus?r.dependentOptionSetColumnStatus:null}function ct(e,t){if(!Object(P.e)(e,j.Tc)||!Object(w.c)(e))return null;if(!Object(u.e)(e,"e3fed6f2-35c3-47a9-9273-9ee58e83489f",3))return null;let n;const r=Object(S.E)(e,t);for(const e in r){const t=r[e];if(t&&t.IsHierarchical){n={primaryAttribute:t.ReferencedAttribute,lookupAttribute:t.ReferencingAttribute};break}}return n}function lt(e,t,n){var r;return null===(r=e.editedViews[t])||void 0===r?void 0:r[n]}function ut(e,t,n){if((null==n?void 0:n.contextTokenType)===_.a.AssociatedGrid){const r=Y(e,t,n);if(null==r?void 0:r.useRollupView)return 1}return 0}function dt(e){return Object(P.e)(e,j.Qc,j.kf)}function pt(e){const{pcfDatasetGridEnabled:t}=Object(U.D)(e);return"on"===t||"off"!==t&&(!!Object(P.f)(e,j.p)||!Object(P.f)(e,j.Hf)&&Object(P.e)(e,j.Ef,j.kf))}},P74A:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("504W");class a{constructor(e){this._selectedFormsByEntity=null,this._selectedFormsByEntity=e}get_selectedFormsByEntity(){return this._selectedFormsByEntity}getObjectData(){const e={};return e.selectedFormsByEntity=this._selectedFormsByEntity,e}static createFromObjectData(e){const t=Object(r.a)(e.selectedFormsByEntity)?new Array(0):e.selectedFormsByEntity;return new a(t)}}},P7gI:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("M0zh");function a(e){return{type:r.a,payload:e,meta:{}}}},P86a:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.CompletedInitialRuleEvaluation=2]="CompletedInitialRuleEvaluation",e[e.SkippedRuleEvaluation=3]="SkippedRuleEvaluation"}(r||(r={}))},PF3G:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("5yoC");class a extends r.a{constructor(e,t,n,r,a,i,o){super(),this._target=null,this._suppressDuplicateDetection=!1,this._calculateMatchCodeSynchronously=!1,this._solutionUniqueName=null,this._maintainLegacyAppServerBehavior=!1,this._concurrencyBehavior=0,this._returnRowVersion=!1,this._target=e,this._suppressDuplicateDetection=t,this._calculateMatchCodeSynchronously=n,this._solutionUniqueName=r,this._maintainLegacyAppServerBehavior=a,this._concurrencyBehavior=i,this._returnRowVersion=o}get_name(){return"Update"}get_xmlNamespace(){return"http://schemas.microsoft.com/xrm/2011/Contracts"}get_target(){return this._target}get_suppressDuplicateDetection(){return this._suppressDuplicateDetection}get_calculateMatchCodeSynchronously(){return this._calculateMatchCodeSynchronously}get_solutionUniqueName(){return this._solutionUniqueName}get_maintainLegacyAppServerBehavior(){return this._maintainLegacyAppServerBehavior}get_concurrencyBehavior(){return this._concurrencyBehavior}set_concurrencyBehavior(e){return this._concurrencyBehavior=e,e}get_returnRowVersion(){return this._returnRowVersion}set_returnRowVersion(e){return this._returnRowVersion=e,e}}},PR89:function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return s}));var r=n("0nOn"),a=n("amNf"),i=n("+nTZ"),o=n("arV0");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const s="ClientApi.PageContext.";let c;class l{constructor(e,t){c=e,this._pageId=t,this._clientApiExecutor=new r.a(e,s,t)}get input(){return this._clientApiExecutor.execute("input",(e,t)=>{const n=Object(o.j)(c.getState(),this._pageId);return n||t.push({name:"pageId",value:this._pageId}),Object(a.b)(c.getState(),n,e,t)||null})}get options(){return this._clientApiExecutor.execute("options",()=>Object(i.b)(c.getState(),this._pageId)?{target:2}:{target:1})}}},PRsh:function(e,t,n){"use strict";
/*!
 * isobject <https://github.com/jonschlinkert/isobject>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */e.exports=function(e){return null!=e&&"object"==typeof e&&!1===Array.isArray(e)}},PRxu:function(e,t,n){"use strict";e.exports=function(e,t,n,r,a,i,o,s){if(!e){var c;if(void 0===t)c=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var l=[n,r,a,i,o,s],u=0;(c=new Error(t.replace(/%s/g,(function(){return l[u++]})))).name="Invariant Violation"}throw c.framesToPop=1,c}}},"PV+a":function(e,t,n){"use strict";n.d(t,"b",(function(){return B})),n.d(t,"d",(function(){return U})),n.d(t,"c",(function(){return V})),n.d(t,"a",(function(){return W}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
let r=1;class a{constructor(e,t){this._id=r++,this.schPriority=e,this._name=t}get id(){return this._id}get name(){return this._name}get priority(){return this.schPriority}set priority(e){this.schPriority=e}get nextNode(){return this._nextNode}removeNode(){const e=this._previousNode,t=this._nextNode;t&&(t._previousNode=e),e&&(e._nextNode=t),this._previousNode=null,this._nextNode=null}insertNodeBefore(e){const t=this._previousNode;t&&(t._nextNode=e),e._nextNode=this,e._previousNode=t,this._previousNode=e}insertNodeAfter(e){const t=this._nextNode;this._nextNode=e,e._nextNode=t,e._previousNode=this,t&&(t._previousNode=e)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class i extends a{get nextMarkerNode(){return this._nextMarkerNode}insertMarkerNodeAfter(e){const t=this._nextMarkerNode;this._nextMarkerNode=e,e._nextMarkerNode=t}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class o{constructor(e,t){this._job=t,this._yieldResult=null,this._yieldPolicy=0,this._shouldYield=e,this._publicApiDisabled=!1}get job(){return this._throwIfDisabled(),this._job}get yieldResult(){return this._yieldResult}get yieldPolicy(){return this._yieldPolicy}shouldYield(){return this._throwIfDisabled(),this._shouldYield()}setPromise(e){this._throwIfDisabled(),this._yieldResult=e,this._yieldPolicy=2}setWork(e){this._throwIfDisabled(),this._yieldResult=e,this._yieldPolicy=1}disablePublicApi(){this._publicApiDisabled=!0}_throwIfDisabled(){if(this._publicApiDisabled)throw new Error("Job info is no longer valid")}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function s(){return!1}function c(e){throw new Error(`Illegal call by job(${e.id.toString()}) in state: ${this.name}`)}class l{constructor(e){this._name=e,this._completed=!1,this.enter=c,this.execute=c,this.executeDone=c,this.blockedDone=c,this.cancel=c,this.resume=c,this.setPriority=c}get name(){return this._name}get completed(){return this._completed}set completed(e){throw new Error("'completed' is read-only")}set completedInternal(e){this._completed=e}}const u=new l("created"),d=new l("scheduled"),p=new l("paused"),f=new l("canceled"),g=new l("running"),h=new l("running_paused"),m=new l("running_resumed"),b=new l("running_canceled"),y=new l("running_canceled_blocked"),_=new l("cooperative_yield"),v=new l("cooperative_yield_paused"),S=new l("blocked"),O=new l("blocked_waiting"),C=new l("blocked_paused"),E=new l("blocked_paused_waiting"),I=new l("blocked_canceled"),w=new l("complete");function j(e){return function(t,n,r){t.setState(e,n,r)}}function P(e,t){e.setPriority(t)}u.enter=e=>{W.addJobAtTailOfPriority(e,e.priority),e.setState(d)},d.enter=()=>{W.startRunning()},d.execute=j(g),d.cancel=j(f),d.pause=j(p),d.resume=s,d.setPriority=(e,t)=>{e.priority!==t&&(e.setPriority(t),e.pause(),e.resume())},p.enter=e=>{e.removeNode()},p.cancel=j(f),p.pause=s,p.resume=e=>{W.addJobAtTailOfPriority(e,e.priority),e.setState(d)},p.setPriority=P,f.enter=e=>{e.removeNode(),e.work=null},f.cancel=s,f.pause=s,f.resume=s,f.setPriority=s,g.enter=(e,t)=>{e.removeNode();const n=e.priority,r=e.work;e.work=null;const a=new o(t,e);try{r&&r(a)}finally{a.disablePublicApi()}const i=e.executeDone(a.yieldPolicy);e.setState(i,a.yieldResult,n)},g.executeDone=(e,t)=>{switch(t){case 0:return w;case 1:return _;case 2:return S}},g.cancel=e=>{W.immediateYield=!0,e.setState(b)},g.pause=e=>{W.immediateYield=!0,e.setState(h)},g.resume=s,g.setPriority=P,h.enter=s,h.executeDone=(e,t)=>{switch(t){case 0:return w;case 1:return v;case 2:return C}},h.cancel=j(b),h.pause=s,h.resume=j(m),h.setPriority=P,m.enter=s,m.executeDone=(e,t)=>{switch(t){case 0:return w;case 1:return _;case 2:return S}},m.cancel=j(b),m.pause=j(h),m.resume=s,m.setPriority=P,b.enter=s,b.executeDone=(e,t)=>{switch(t){case 0:case 1:return f;case 2:return y}},b.cancel=s,b.pause=s,b.resume=s,b.setPriority=s,y.enter=(e,t)=>{t&&t.cancel&&t.cancel(),e.setState(f)},_.enter=(e,t,n)=>{n===e.priority?W.addJobAtHeadOfPriority(e,e.priority):W.addJobAtTailOfPriority(e,e.priority),e.work=t,e.setState(d)},v.enter=(e,t)=>{e.work=t,e.setState(p)},S.enter=(e,t,n)=>{e.setState(O),t.then(t=>{const r=e.blockedDone(t);e.setState(r,t,n)}).catch(()=>{e.setState(f)})},O.enter=s,O.blockedDone=(e,t)=>"function"==typeof t?_:w,O.cancel=j(I),O.pause=j(E),O.resume=s,O.setPriority=P,C.enter=(e,t,n)=>{e.setState(E),t.then(t=>{const r=e.blockedDone(t);e.setState(r,t,n)}).catch(()=>{e.setState(f)})},E.enter=s,E.blockedDone=(e,t)=>"function"==typeof t?v:w,E.cancel=j(I),E.pause=s,E.resume=j(O),E.setPriority=P,I.enter=e=>{e.work&&(e.work.cancel&&e.work.cancel(),e.work=null)},I.blockedDone=()=>f,I.cancel=s,I.pause=s,I.resume=s,I.setPriority=s,w.completedInternal=!0,w.enter=e=>{e.work=null},w.cancel=s,w.pause=s,w.resume=s,w.setPriority=s;function T(e){return e|=0,e=Math.min(e,15),e=Math.max(e,-15)}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class N extends a{constructor(e,t,n,r){super(t,n),this._state=r,this._work=e,this._owner=null,this.setPriority(t),this.setState(u)}get priority(){return this.schPriority}set priority(e){if(e!==this.schPriority){const t=T(e);this._state.setPriority(this,t)}}get completed(){return this._state.completed}get work(){return this._work}set work(e){this._work=e}get owner(){return this._owner}set owner(e){this._owner!==e&&(this._owner&&this._owner.removeJob(this),this._owner=e,this._owner&&this._owner.addJob(this))}cancel(){this._state.cancel(this)}pause(){this._state.pause(this)}resume(){this._state.resume(this)}setState(e,t,n){this._state=e,this._state.enter(this,t,n)}setPriority(e){this.schPriority=e}execute(e){this._state.execute(this,e)}executeDone(e){return this._state.executeDone(this,e)}blockedDone(e){return this._state.blockedDone(this,e)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class A{constructor(){this._jobs={}}addJob(e){this._jobs[e.id]=e}removeJob(e){delete this._jobs[e.id]}cancelAll(){const e=this._jobs;this._jobs={};for(const t in e)e.hasOwnProperty(t)&&e[t].cancel()}}var R=n("fMBw"),D=n.n(R),x=n("5UJb"),M=n.n(x),F=n("TEuE"),k=n("SZCI");const L=new
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class{constructor(){this._useSetImmediate=window.hasOwnProperty("setImmediate")}immediate(e){return this._useSetImmediate?{yieldId:setImmediate(e)}:{yieldId:setTimeout(e,0)}}},B=13,U=0,V=-13,z=D.a.createEvent("Run",k.y);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function q(){return performance.now()}let H=0;const W=new class{constructor(e){this._timeSliceDuration=20,this._highWaterMark=-15,this._immediateYield=!1,this._pumping=!1,this._scheduledVersion=0,this._executedVersion=0,this._runningJob=null,this._drainQueue=[],this._yieldProvider=e;const t=[new i(15,"max"),new i(14,"14"),new i(B,"high"),new i(12,"12"),new i(11,"11"),new i(10,"10"),new i(9,"aboveNormal"),new i(8,"8"),new i(7,"7"),new i(6,"6"),new i(5,"5"),new i(4,"4"),new i(3,"3"),new i(2,"2"),new i(1,"1"),new i(U,"normal"),new i(-1,"-1"),new i(-2,"-2"),new i(-3,"-3"),new i(-4,"-4"),new i(-5,"-5"),new i(-6,"-6"),new i(-7,"-7"),new i(-8,"-8"),new i(-9,"belowNormal"),new i(-10,"-10"),new i(-11,"-11"),new i(-12,"-12"),new i(V,"idle"),new i(-14,"-14"),new i(-15,"min"),new i(-16,"<TAIL>")];t.reduce((e,t)=>(e&&(e.insertNodeAfter(t),e.insertMarkerNodeAfter(t)),t)),this._priorities=t}set immediateYield(e){this._immediateYield=e}protectHighPriorityBrowserAsyncWork(e){Object(F.d)(e)}schedule(e,t,n){return new N(e,T(t),n,u)}createOwnerToken(){return new A}startRunning(){if(this._pumping)return;const e=++this._scheduledVersion;this._yieldProvider.immediate(()=>{this._executedVersion<e&&(this._executedVersion=this._scheduledVersion,this._run())})}_run(){const e=z.startStopwatch(),t=M.a.trackWork("Scheduler.Run");let n;this._pumping=!0;let r,a=!0,i=-16;this._immediateYield=!1;try{const o=q()+this._timeSliceDuration,s=()=>!!this._immediateYield||!(this._drainQueue.length>0)&&q()>o;for(;this._highWaterMark>=-15&&!s();){n=!1,r=this._markerFromPriority(this._highWaterMark).nextNode;do{r instanceof N?(i=r.priority,n=!0,a=!1,this._runningJob=r,r.execute(s),this._runningJob=null,a=!0):(this._highWaterMark=r.priority,n=this._notifyDrainListeners()),r=r.nextNode}while(r&&!n);this._immediateYield=!1}}catch(e){this._eventManager&&this._eventManager.ReportComponentFailure("Scheduler",e)}finally{this._runningJob=null,a||r&&r instanceof N&&r.cancel();let o=!1;for(;this._highWaterMark>=-15&&!o;){n=!1,r=this._markerFromPriority(this._highWaterMark).nextNode;do{r instanceof N?o=!0:(this._highWaterMark=r.priority,n=this._notifyDrainListeners()),r=r.nextNode}while(r&&!n&&!o)}this._pumping=!1,this._highWaterMark>=-15&&this.startRunning(),e({lastLoggedPriority:i.toString()}),t()}}addJobAtHeadOfPriority(e,t){const n=this._markerFromPriority(t);n.priority>this._highWaterMark&&(this._highWaterMark=n.priority,this._immediateYield=!0),n.insertNodeAfter(e)}addJobAtTailOfPriority(e,t){const n=this._markerFromPriority(t);n.priority>this._highWaterMark&&(this._highWaterMark=n.priority,this._immediateYield=!0),n.nextMarkerNode&&n.nextMarkerNode.insertNodeBefore(e)}requestDrain(e=-15,t){return t=t||"Drain request "+ ++H,new Promise(n=>{this._drainQueue.push({priority:T(e),complete:n,name:t||""}),1===this._drainQueue.length&&e>this._highWaterMark&&(this._highWaterMark=e,this._immediateYield=!0),this._pumping||this.startRunning()})}_currentDrainPriority(){return this._drainQueue.length>0?this._drainQueue[0].priority:-16}_notifyCurrentDrainListener(){const e=this._drainQueue.shift();e&&e.complete()}_notifyDrainListeners(){let e=!1;if(this._drainQueue.length>0){let t=this._currentDrainPriority();for(;-16!==t&&t>this._highWaterMark;)this._notifyCurrentDrainListener(),e=!0,t=this._currentDrainPriority()}return e}setEventManager(e){this._eventManager=e}retrieveState(){let e="Jobs:\n",t=this._markerFromPriority(this._highWaterMark),n=0;for(this._runningJob&&(e+=this._logJob(this._runningJob,!0),n++);t.priority>=-15;)t instanceof N&&(e+=this._logJob(t,!1),n++),t=t.nextNode;0===n&&(e+="     None\n"),e+="Drain requests:\n";const r=this._drainQueue.length;if(r>0)for(let t=0;t<r;t++)e+="     "+(0===t?"*":" ")+"priority: "+this._markerFromPriority(this._drainQueue[t].priority).name+", name: "+this._drainQueue[t].name+"\n";else e+="     None\n";return e}_logJob(e,t){return"    "+(t?"*":" ")+"id: "+e.id+", priority: "+this._markerFromPriority(e.priority).name+(e.name?"":",name: "+e.name)+"\n"}_markerFromPriority(e){return this._priorities[-1*(T(e)-15)]}}(L)},Pcet:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="dataSnapshot.updateIdentifier";function a(e,t){return{type:r,payload:t,meta:e}}},PidC:function(e,t,n){"use strict";n.d(t,"g",(function(){return I})),n.d(t,"b",(function(){return w})),n.d(t,"a",(function(){return A})),n.d(t,"h",(function(){return j})),n.d(t,"i",(function(){return N})),n.d(t,"c",(function(){return R})),n.d(t,"f",(function(){return x})),n.d(t,"j",(function(){return P})),n.d(t,"d",(function(){return D})),n.d(t,"k",(function(){return M})),n.d(t,"e",(function(){return F}));var r=n("iZ7K"),a=n("arV0"),i=n("i1f0"),o=n("NjDY"),s=n("unFF"),c=n("IqkD"),l=n("YxC/"),u=n("EDOo"),d=n("odYE"),p=n("WPtp"),f=n("2cSh"),g=n("d5d1"),h=n("SAYH"),m=n("AF/G"),b=n("4leG"),y=n("3hnk"),_=n("qLnS"),v=n("qFOq"),S=n("jq7Z"),O=n("Lyxw"),C=n("3/02"),E=n("dpM5");function I(){let e=null,t=!1,n=null,l=null,u=null,d=null,p=null;return function(f,h){const m=Object(a.j)(f,h.id),b=m.entityTypeName,y=m.id,_=Object(r.h)(f,b),v=Object(i.Y)(f,h),S=Object(i.jb)(f,h),O=_&&!!_.PrimaryImageAttribute,C=Object(r.i)(f,b),E=Object(o.x)(f),I=C?E+C:null,w=Object(i.lc)(f,b,y),j=Object(s.a)(f),P=Object(c.g)(f);return e===j&&t===O&&n===v&&l===S&&u===I&&d===w||(e=j,t=O,n=v,l=S,u=I,d=w,p={hasPrimaryImageAttribute:O,entitySipValue:v,entityImageUrl:S,entityIconUrl:I,primaryNameAttributeValue:w,cameraEnabled:Object(g.e)(f,"camera"),styles:{containerStyle:Object.assign({height:"40px",width:"40px",minWidth:"40px",lineHeight:"40px"},{border:"2px transparent solid",fontSize:j.fontSizes.Font150,marginRight:j.sizes.Measures.Measure100,marginTop:0,marginBottom:0,marginLeft:P?j.sizes.Measures.Measure150:0,backgroundColor:"transparent"}),circleStyle:Object.assign({height:"40px",width:"40px",minWidth:"40px",lineHeight:"40px"},{borderRadius:"50%",textAlign:"center",fontWeight:"bold",textTransform:"uppercase",color:"white",marginRight:0,fontSize:j.fontSizes.Font150}),entityImagePropStyle:Object.assign({height:"40px",width:"40px",minWidth:"40px",lineHeight:"40px"},{borderRadius:"50%",textAlign:"center",fontWeight:"bold",textTransform:"uppercase",color:"white",marginRight:0,fontSize:j.fontSizes.Font115})}}),p}}function w(e,t,n){const o=Object(a.j)(e,t),s=o.entityTypeName,c=o.id,d=Object(i.lc)(e,s,c),p=Object(l.b)(e,u.a),f=Object(r.h)(e,s),g=f?f.DisplayName:"",h=g&&p?String.format(p,g):"",m=Object(i.fc)(e,t,n);return Object(i.tb)(c,d,h,m)}function j(){let e=null;const t=function(){let e=null;return function(t){let n=!1;if(t){const r=Object.keys(t);e&&r.length===Object.keys(e).length||(n=!0),n||r.some(r=>{if(t[r]&&Object(p.k)(t[r])&&(null==e?void 0:e[r])&&(Object(p.a)(e[r])!==Object(p.a)(t[r])||Object(p.b)(e[r])!==Object(p.b)(t[r])))return n=!0,n})}return n&&(e=t),n}}();return function(n,r){const o=Object(i.yb)(n,r,r.contextToken,r.formId),s=null==o?void 0:o.filter(e=>P(e)),c=Object(i.kd)(n,r.id)&&!x(n,r,r.contextToken,r.formId)&&!Object(b.e)(n),l=[],u={},f={};if(s&&s.length>0)for(let e=0;e<s.length&&e<4;e++){const t=s[e],o=t.PreviewId,g=t.Name,h=t.DataFieldName,{entityTypeName:m,id:b}=Object(a.j)(n,r.id),v=Object(i.hc)(n,r.id,r.contextToken),S=Object(i.ab)(n,r.id,r.contextToken,v,new d.a(m,b),t.DataFieldName);f[g]=S;let O=Object(p.c)(S);if(!O&&c)continue;O=Object(y.f)(n,m,h,_.a.CanRead,b)?O||"---":"***";const C=[];if(Object(p.k)(S)){const e=T(Object(p.a)(S),Object(p.b)(S));C.push({displayValue:O,navigationInput:e})}else C.push({displayValue:O,navigationInput:null});l.push(g),u[g]={label:Object(i.y)(n,{id:r.id,controlName:g},r.contextToken),showLabel:t.ShowLabel,content:C,previewId:o}}let g=!1;e&&e.controlNames.length!==l.length&&(g=!0);if(t(f)&&(g=!0),!g)for(let t=0;t<l.length;t++){const n=l[t];if(e&&e.controlNames&&e.controlNames[t]!==n){g=!0;break}if(!e||!e.controls||!e.controls[n]){g=!0;break}const r=u[n],a=e.controls[n];if(r.label!==a.label){g=!0;break}for(let e=0;e<r.content.length;e++)if(r.content[e].displayValue!==a.content[e].displayValue){g=!0;break}if(g)break}return g&&(e={controlNames:l,controls:u}),e}}function P(e){return h.a.equals(e.ClassId,m.j)||h.a.equals(e.ClassId,m.q)||h.a.equals(e.ClassId,m.r)||h.a.equals(e.ClassId,m.s)||h.a.equals(e.ClassId,m.v)||h.a.equals(e.ClassId,m.B)||h.a.equals(e.ClassId,m.H)||h.a.equals(e.ClassId,m.K)||h.a.equals(e.ClassId,m.M)||h.a.equals(e.ClassId,m.P)||h.a.equals(e.ClassId,m.T)||h.a.equals(e.ClassId,m.U)||h.a.equals(e.ClassId,m.W)||h.a.equals(e.ClassId,m.bb)||h.a.equals(e.ClassId,m.fb)||h.a.equals(e.ClassId,m.ob)||h.a.equals(e.ClassId,m.pb)||h.a.equals(e.ClassId,m.sb)||h.a.equals(e.ClassId,m.tb)}function T(e,t){return e&&t?{entityTypeName:e.etn,id:t}:null}function N(){let e=null;const t=Object(i.ud)();return function(n,r){const a=t(n,r);return a!==e&&(e=a),e}}function A(e,t,n,r){const a=r?500:400;return Object(i.Nb)(e,t.id,n)&&Object(i.wb)(e,t,n)<a}function R(e,t,n,r){const a=Object(S.a)(e,t),o=Object(i.Eb)(a,r);let s=!1;if(o&&o.length>0){const e=n&&n.map(e=>e.Name),t=e?new Set(e):new Set;s=o.some(e=>t.has(e))}return s}function D(e,t,n){return Object(i.ib)(e,t,n).Header.PreviewId}function x(e,t,n,r){const a=Object(i.yb)(e,t,n,r),o=Object(i.ib)(e,t,n);return Object(O.e)(e,E.d,C.kf)?o.HeaderDensity!==f.a.HighReadOnlyValues&&(null==a?void 0:a.length)>0:o&&(o.HeaderDensity===f.a.HighWithControls||null==o.HeaderDensity)&&a&&a.length>0}function M(e,t,n,r,a){return r&&r.length>0||Object(i.Nb)(e,t,n)&&a!==v.a.NotReadOnly}function F(e,t,n){const r=Object(i.fb)(e,t,n);return r?r.header:null}},PrIm:function(e,t,n){"use strict";n.d(t,"a",(function(){return V}));var r=n("u+q+"),a=n("Ua4i"),i=n("mMyr"),o=n("kXuq"),s=n("/to1"),c=n("q441"),l=n("Fn63"),u=n("N2HV"),d=n("MwwY");function p(e){return Object.assign({display:"inline-flex",width:16,height:16,backgroundColor:"#3da3ff",borderRadius:"50%",justifyContent:"center",alignItems:"center",cursor:"pointer"},e.style)}function f(e){return Object.assign({},{color:"#fff",fontFamily:"Dyn CRM Symbol, Segoe MDL2 Assets",fontSize:"12px"},e.infoSymbolStyle)}function g(e){return i.createElement(d.a,{text:e.infoMessage,accessibilityHidden:e.accessibilityHidden},i.createElement(o.a,{style:p(e),accessibilityLabel:"Information"},i.createElement(u.b,{type:l.a.InformationIcon,style:f(e)})))}function h(e){return Object.assign({display:"inline-flex",width:16,height:16,backgroundColor:"#ff0000",borderRadius:"50%",justifyContent:"center",alignItems:"center",cursor:"pointer"},e.style)}function m(e){return Object.assign({},{color:"#fff",fontFamily:"Dyn CRM Symbol, Segoe MDL2 Assets",fontSize:"12px"},e.errorSymbolStyle)}function b(e){return i.createElement(d.a,{text:e.errorMessage},i.createElement(o.a,{style:h(e),accessibilityLabel:"Error"},i.createElement(u.b,{type:l.a.ErrorIcon,style:m(e)})))}function y(e){return Object.assign({display:"inline-flex",width:16,height:16,justifyContent:"center",alignItems:"center",cursor:"pointer"},e.style)}function _(e){return Object.assign({},{color:"#b22912",fontFamily:"Dyn CRM Symbol, Segoe MDL2 Assets",fontSize:"16px"},e.warningSymbolStyle)}function v(e){return i.createElement(d.a,{text:e.warningMessage},i.createElement(o.a,{style:y(e),accessibilityLabel:"Warning"},i.createElement(u.b,{type:l.a.Warning,style:_(e)})))}var S=n("Y7HL");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class O extends i.Component{constructor(e){super(e),this._onClose=this._onClose.bind(this),this._handleImageLoadFailure=this._handleImageLoadFailure.bind(this),this.state={isWebResourceError:!1}}componentDidMount(){this.props.close||this.props.retrieveResourceStrings()}render(){return i.createElement(o.a,{key:"globalNotificationRoot",style:this.props.styles.globalNotificationRootViewStyle},this._renderComponent())}_renderComponent(){return i.createElement(o.a,{key:"globalNotificationRoot",style:this.props.styles.globalNotificationViewStyle},this._renderNotificationIcon(),i.createElement(o.a,{key:"data-action-block",style:this.props.styles.globalNotificationDataActionBlockStyle},i.createElement(s.a,{key:"notificationIcon",style:this.props.styles.globalNotificationTextContainerStyle},this.props.title?i.createElement(s.a,{key:"globalnotification-title",style:this.props.styles.globalNotificationTitleStyle},this.props.title):null,i.createElement(s.a,{key:"globalnotification-message",testhooks:{id:"global-notification-message"}},this.props.message)),null!=this.props.action?this._renderActionButtonIcon():null),this.props.showCloseButton?this._renderCloseButtonIcon():null)}_handleImageLoadFailure(e){var t;const n=null==e?void 0:e.currentTarget;-1===(null===(t=null==n?void 0:n.src)||void 0===t?void 0:t.indexOf(this.props.backupIconResourceURL))?n.src=this.props.backupIconResourceURL:this.setState({isWebResourceError:!0})}_renderNotificationIcon(){let e;const t=Object.assign({},this.props.styles.globalNotificationIconWrapperStyle);if(this.props.iconResource&&this.props.isMobile&&!this.state.isWebResourceError)t.display="block",e=i.createElement(S.a,{key:"notificationIcon",source:this.props.iconResource,onError:this._handleImageLoadFailure,style:this.props.styles.globalNotificationWebResourceStyle});else{if(this.props.isMobile)return null;switch(this.props.level){case 4:e=i.createElement(g,{key:"notificationIcon",style:this.props.styles.globalNotificationIconStyle});break;case 3:e=i.createElement(v,{key:"notificationIcon",style:this.props.styles.globalNotificationIconStyle});break;case 2:e=i.createElement(b,{key:"notificationIcon",style:this.props.styles.globalNotificationIconStyle});break;default:return null}}return i.createElement(o.a,{key:"data-action-icon",style:t},e)}_renderCloseButtonIcon(){return i.createElement(c.a,{key:"closeButton",style:this.props.styles.globalNotificationCloseBtnStyle,onClick:this._onClose.bind(this),accessibilityLabel:this.props.closeLabel,testhooks:{id:"global-notification-close-button"}},i.createElement(u.b,{type:l.a.Close}))}_renderActionButtonIcon(){return i.createElement(c.a,{key:"actionButton",style:this.props.styles.globalNotificationActionBtnStyle,onClick:this.props.action.eventHandler,accessibilityLabel:this.props.action.actionLabel,testhooks:{id:"global-notification-action-button"}},i.createElement(s.a,null," ",this.props.action.actionLabel))}_onClose(){this.props&&this.props.close()}}var C=n("unFF"),E=n("GYEz"),I=n("w1eR"),w=n("0kGT");let j;function P(e){const t=Object(C.a)(e),n=Object(w.c)(e),r={globalNotificationsRootViewStyle:{flexShrink:0},globalNotificationsViewStyle:{display:"block",width:"100%",marginTop:t.sizes.Measures.Measure100,marginBottom:t.sizes.Measures.Measure100}};return n&&(r.globalNotificationsRootViewStyle.webkitBackdropFilter="blur(27.1828px)",r.globalNotificationsRootViewStyle.backdropFilter="blur(27.1828px)",r.globalNotificationsViewStyle.marginTop="0",r.globalNotificationsViewStyle.marginBottom="0"),r}function T(e){const t=Object(C.a)(e),n=Object(E.a)(e)===I.a.MobileApplication;if(j)return j;const r={globalNotificationRootViewStyle:{width:"100%",boxShadow:t.shadows.Shadow01},globalNotificationViewStyle:{width:"100%",backgroundColor:t.colors.WhiteBackground,overflowX:"hidden",overflowY:"auto",display:"flex",paddingRight:t.sizes.Measures.Measure050,paddingBottom:t.sizes.Measures.Measure100,paddingTop:t.sizes.Measures.Measure100},globalNotificationIconStyle:{display:"inline-flex",marginLeft:t.sizes.Measures.Measure050},globalNotificationIconWrapperStyle:{fontSize:t.sizes.Measures.Measure025,height:t.sizes.Measures.Measure150,alignSelf:n?"BaseLine":void 0},globalNotificationWebResourceStyle:{height:"32px",width:"32px",marginRight:"16px",marginLeft:"16px",marginTop:"4px"},globalNotificationDataActionBlockStyle:{display:"flex",flex:1,flexDirection:n?"column":"row",justifyContent:"space-between"},globalNotificationTitleStyle:{display:n?"flex":"inline-flex",fontFamily:t.fontFamilies.Semibold,paddingRight:t.sizes.Measures.Measure050},globalNotificationTextContainerStyle:{fontSize:t.fontSizes.Font100,fontFamily:t.fontFamilies.Regular,width:"100%",color:t.colors.BaseColor.Grey.Grey7,marginLeft:t.sizes.Measures.Measure050},globalNotificationActionBtnStyle:Object.assign(Object.assign({},t.buttons.Button02Primary),{marginTop:n?t.sizes.Measures.Measure100:void 0,alignSelf:n?"flex-start":void 0,color:t.colors.BaseColor.White,flexShrink:0,marginLeft:n?t.sizes.Measures.Measure050:0}),globalNotificationCloseBtnStyle:{backgroundColor:"transparent",borderColor:"transparent",outline:"0",cursor:"pointer",height:"18px",paddingRight:"0px",alignSelf:n?"end":void 0}};return Object(w.c)(e)&&(r.globalNotificationViewStyle.backgroundColor="#E1E1E1",r.globalNotificationCloseBtnStyle.color="#8E8E93",r.globalNotificationTextContainerStyle.color="#4D4D4D",r.globalNotificationViewStyle.paddingTop=t.sizes.Measures.Measure085,r.globalNotificationViewStyle.paddingBottom=t.sizes.Measures.Measure085,r.globalNotificationViewStyle.alignItems="center",r.globalNotificationIconWrapperStyle.display="none"),j=r}var N=n("P+p9"),A=n("NjDY"),R=n.p+"resources/images/PowerApps.png?v=1.4.3886-master",D=n.p+"resources/images/Sales.png?v=1.4.3886-master",x=n.p+"resources/images/FieldService.png?v=1.4.3886-master",M=n("EY5k"),F=n("YxC/");function k(e,t){return t?(t=t.toLowerCase().replace("webresources/",""),Object(A.x)(e)+t):null}function L(e){if(e){return{Sales:D,FieldService:x,PowerApps:R}[e.split(".")[0]]}return null}const B=Object(r.a)((function(e,t){const n=Object(a.a)(e,t.id);return{styles:T(e),level:n.props.level,message:n.props.message||"",title:n.props.title||"",isRtl:!1,action:n.props.action,onCloseHandler:n.props.onCloseHandler,showCloseButton:void 0===n.props.showCloseButton||n.props.showCloseButton,iconResource:k(e,n.props.imageSrc),backupIconResourceURL:L(n.props.imageSrc),isMobile:Object(w.c)(e),closeLabel:Object(F.b)(e,"Button_Label_Close")}}),(function(e,t){return{close(){e(Object(N.c)(t.id))},retrieveResourceStrings(){e(Object(M.e)(["Button_Label_Close"]))}}}))(O);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function U(e){return e.globalNotificationIds&&e.globalNotificationIds.length>0?i.createElement(o.a,{key:"globalNotificationsInner",style:Object.assign(Object.assign({},e.styles.globalNotificationsViewStyle),e.globalNotificationsViewStyle)},function(e){return e.globalNotificationIds.map(e=>{return t=e,i.createElement(B,{key:t,id:t});var t})}(e)):null}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const V=Object(r.a)(()=>{let e=null;return t=>{const n=Object(a.c)(t),r=Object(a.b)(t);if(null===e)return e={globalNotificationIds:n?Object.keys(n):[],styles:P(t)},e;if(0===e.globalNotificationIds.length&&0===r.length)return e;if(e.globalNotificationIds.length===r.length){if(!r.some(t=>e.globalNotificationIds.indexOf(t)<0))return e}return e={globalNotificationIds:n?Object.keys(n):[],styles:P(t)},e}})((function(e){return i.createElement(o.a,{key:"globalNotificationsRoot",style:e.styles.globalNotificationsRootViewStyle,testhooks:{id:"global-notification-container"}},U(e))}))},PsCI:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Backspace=8]="Backspace",e[e.Tab=9]="Tab",e[e.Enter=13]="Enter",e[e.Shift=16]="Shift",e[e.Ctrl=17]="Ctrl",e[e.Alt=18]="Alt",e[e.PauseBreak=19]="PauseBreak",e[e.Capslock=20]="Capslock",e[e.Escape=27]="Escape",e[e.Space=32]="Space",e[e.PageUp=33]="PageUp",e[e.PageDown=34]="PageDown",e[e.End=35]="End",e[e.Home=36]="Home",e[e.LeftArrow=37]="LeftArrow",e[e.UpArrow=38]="UpArrow",e[e.RightArrow=39]="RightArrow",e[e.DownArrow=40]="DownArrow",e[e.Insert=45]="Insert",e[e.Delete=46]="Delete",e[e.Num0=48]="Num0",e[e.Num1=49]="Num1",e[e.Num2=50]="Num2",e[e.Num3=51]="Num3",e[e.Num4=52]="Num4",e[e.Num5=53]="Num5",e[e.Num6=54]="Num6",e[e.Num7=55]="Num7",e[e.Num8=56]="Num8",e[e.Num9=57]="Num9",e[e.A=65]="A",e[e.B=66]="B",e[e.C=67]="C",e[e.D=68]="D",e[e.E=69]="E",e[e.F=70]="F",e[e.G=71]="G",e[e.H=72]="H",e[e.I=73]="I",e[e.J=74]="J",e[e.K=75]="K",e[e.L=76]="L",e[e.M=77]="M",e[e.N=78]="N",e[e.O=79]="O",e[e.P=80]="P",e[e.Q=81]="Q",e[e.R=82]="R",e[e.S=83]="S",e[e.T=84]="T",e[e.U=85]="U",e[e.V=86]="V",e[e.W=87]="W",e[e.X=88]="X",e[e.Y=89]="Y",e[e.Z=90]="Z",e[e.LeftWindowKey=91]="LeftWindowKey",e[e.RightWindowKey=92]="RightWindowKey",e[e.SelectKey=93]="SelectKey",e[e.NumPad0=96]="NumPad0",e[e.NumPad1=97]="NumPad1",e[e.NumPad2=98]="NumPad2",e[e.NumPad3=99]="NumPad3",e[e.NumPad4=100]="NumPad4",e[e.NumPad5=101]="NumPad5",e[e.NumPad6=102]="NumPad6",e[e.NumPad7=103]="NumPad7",e[e.NumPad8=104]="NumPad8",e[e.NumPad9=105]="NumPad9",e[e.Multiply=106]="Multiply",e[e.Add=107]="Add",e[e.Subtract=109]="Subtract",e[e.DecimalPoint=110]="DecimalPoint",e[e.Divide=111]="Divide",e[e.F1=112]="F1",e[e.F2=113]="F2",e[e.F3=114]="F3",e[e.F4=115]="F4",e[e.F5=116]="F5",e[e.F6=117]="F6",e[e.F7=118]="F7",e[e.F8=119]="F8",e[e.F9=120]="F9",e[e.F10=121]="F10",e[e.F11=122]="F11",e[e.F12=123]="F12",e[e.NumLock=144]="NumLock",e[e.ScrollLock=145]="ScrollLock",e[e.SemiColon=186]="SemiColon",e[e.EqualSign=187]="EqualSign",e[e.Comma=188]="Comma",e[e.Dash=189]="Dash",e[e.Period=190]="Period",e[e.ForwardSlash=191]="ForwardSlash",e[e.GraveAccent=192]="GraveAccent",e[e.OpenBracket=219]="OpenBracket",e[e.BackSlash=220]="BackSlash",e[e.CloseBraket=221]="CloseBraket",e[e.SingleQuote=222]="SingleQuote"}(r||(r={}))},PtYj:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return f}));var r=n("3/02"),a=n("Lyxw"),i=n("w1eR"),o=n("uNu9"),s=n("GYEz"),c=n("69Qu"),l=n("iZ7K"),u=n("3hnk"),d=n("arV0");function p(e,t){if(!t)return!1;const n=Object(u.e)(e,"1cd608fd-160c-45e5-9aee-52e8066e9ef6",3),d=Object(s.a)(e)===i.a.MailApp,p=!Object(c.c)(e),f=Object(s.a)(e)===i.a.MobileApplication,g=Object(l.h)(e,t),h=Object(a.f)(e,r.t),m=g&&g.IsCustomizable&&null!=g.IsAuditEnabled&&g.IsAuditEnabled.CanBeChanged,b=g&&g.IsCustomEntity||function(e){let t=!1;switch(e){case o.a:case o.d:case o.g:case o.h:case o.i:case o.j:case o.k:case o.l:case o.m:case o.n:case o.o:case o.p:case o.q:case o.r:case o.s:case o.t:case o.u:case o.v:case o.w:case o.x:case o.y:case o.A:case o.B:case o.D:case o.C:case o.E:case o.G:case o.H:case o.J:case o.K:case o.N:case o.P:case o.Q:case o.R:case o.S:case o.U:case o.V:case o.W:case o.Y:case o.Z:case o.ab:case o.bb:case o.cb:case o.db:case o.eb:case o.gb:case o.hb:case o.ib:case o.jb:case o.Fb:case o.mb:case o.nb:case o.pb:case o.sb:case o.ub:case o.wb:case o.vb:case o.xb:case o.zb:case o.yb:case o.Ab:case o.Bb:case o.Cb:case o.Db:case o.Eb:case o.Hb:case o.Ib:case o.Jb:case o.Kb:case o.Lb:case o.Mb:case o.Nb:case o.Pb:case o.Qb:case o.Rb:case o.Ub:case o.Ob:case o.Vb:case o.Wb:case o.Yb:case o.bc:case o.cc:case o.Gb:case o.L:case o.M:case o.Sb:case o.rb:case o.Xb:case o.z:case o.kb:case o.ac:case o.qb:case o.ob:case o.fb:case o.O:t=!0}return t}(t);return h&&!d&&!p&&!f&&n&&m&&b}function f(e,t,n){let r="";const a=Object(d.j)(e,t);a&&(r=a.entityTypeName);const i=p(e,r);return n&&n.entityName===o.f&&i}},"Py/t":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="update.offline.bpf.entities";function a(e){return{type:r,payload:{offlineBPFEntities:e}}}},Q7Xa:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class r{constructor(e,t,n){this._entity=null,this._operationPerformed=0,this._entityType=null,this._entity=e,this._operationPerformed=t,this._entityType=n}get_entity(){return this._entity}get_operationPerformed(){return this._operationPerformed}get_entityType(){return this._entityType}}},QARO:function(e,t,n){"use strict";n.d(t,"a",(function(){return h})),n.d(t,"b",(function(){return g}));var r=n("kAKO"),a=n("yHIv"),i=n("sclX"),o=n("LzVy"),s=n("zVFX"),c=n("Lyxw"),l=n("3/02"),u=n("0kGT"),d=n("E5IU"),p=n("NjDY");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
let f=!1;function g(){return f}function h(){return{diagnosticName:"FontSize",boot:(e,t,n)=>{const r=n.getState(),a=Object(o.a)(r),g=Object(c.f)(r,l.xc);a===i.b.Native?Object(u.c)(r)?g&&Object(s.f)():(document.documentElement.style.fontSize="initial",g&&Object(s.d)()):g&&Object(s.f)();const h=function(e){return!(!Object(c.f)(e,l.yc)||"msdyn_ConnectedStore"!==Object(d.n)(e))||Object(p.D)(e).isCrmOrg}(r);Object(s.e)(h),f=!0},supportedClientHostTypes:a.a,supportedPageTypes:a.b,priority:r.a.Normal}}},QBtP:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n("mMyr");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const a=r.createContext({}),i=r.createContext({})},QEBF:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r,a=n("mMyr"),i=n("hGVc"),o=n("NRCx"),s=(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),c=!!window.navigator.userAgent.match("MSIE")||!!window.navigator.userAgent.match("Trident"),l=!!window.navigator.userAgent.match("Edge"),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.getElementName=function(){return"div"},t.prototype.getElementProps=function(){return null},t.prototype.refCallbackTrigger=function(e){this.props.refCallback(e)},t.prototype.hasAriaProperty=function(){return!!(this.props.accessibilityLabel||this.props.accessibilityChecked||this.props.accessibilityLive||this.props.accessibilityRelevant||this.props.accessibilityAtomic||this.props.labelledByElementId||this.props.describedByElementId||this.props.controlsElementId||this.props.ownsElementId||this.props.accessibilityRequired||"boolean"==typeof this.props.accessibilityExpanded||"boolean"==typeof this.props.accessibilityHasPopup||"string"==typeof this.props.accessibilityHasPopup||"boolean"==typeof this.props.accessibilityPressed||"string"==typeof this.props.accessibilityPressed||"boolean"==typeof this.props.accessibilityReadOnly||"boolean"==typeof this.props.accessibilityDisabled||"number"==typeof this.props.accessibilityLevel||"boolean"==typeof this.props.accessibilityHidden||"boolean"==typeof this.props.isSelected||this.props.activeDescendantId||this.props.accessibilityCurrent||"number"==typeof this.props.accessibilityValueMin||"number"==typeof this.props.accessibilityValueMax||"number"==typeof this.props.accessibilityValueNow||"boolean"==typeof this.props.accessibilityModal||this.props.accessibilityValueText||this.props.role||this.props.accessibilityAriaOrientation)},t.prototype.getElementPropsInternal=function(){var e={};e.id=this.props.id,this.props.hidden&&(e[i.E]=!0),this.props.accessibilityLabel&&(e[i.m]=this.props.accessibilityLabel),this.props.accessibilityChecked&&(e[i.e]=this.props.accessibilityChecked),this.props.accessibilityLive&&(e[i.p]=this.props.accessibilityLive),this.props.accessibilityRelevant&&(e[i.w]=this.props.accessibilityRelevant),this.props.accessibilityAtomic&&(e[i.c]=this.props.accessibilityAtomic),this.props.labelledByElementId&&(e[i.n]=this.props.labelledByElementId),this.props.describedByElementId&&(e[i.h]=this.props.describedByElementId),this.props.controlsElementId&&(e[i.f]=this.props.controlsElementId),this.props.ownsElementId&&(e[i.t]=this.props.ownsElementId),this.props.accessibilityRequired&&(e[i.x]=this.props.accessibilityRequired),"boolean"==typeof this.props.accessibilityExpanded&&(e[i.j]=this.props.accessibilityExpanded),"string"!=typeof this.props.accessibilityHasPopup&&"boolean"!=typeof this.props.accessibilityHasPopup||(e[i.k]=this.props.accessibilityHasPopup),"string"!=typeof this.props.accessibilityPressed&&"boolean"!=typeof this.props.accessibilityPressed||(e[i.u]=this.props.accessibilityPressed),"boolean"==typeof this.props.accessibilityReadOnly&&(e[i.v]=this.props.accessibilityReadOnly),"boolean"==typeof this.props.accessibilityDisabled&&(e[i.i]=this.props.accessibilityDisabled),"number"==typeof this.props.accessibilityLevel&&(e[i.o]=this.props.accessibilityLevel),"boolean"==typeof this.props.accessibilityHidden&&(e[i.l]=this.props.accessibilityHidden),"boolean"==typeof this.props.isSelected&&(e[i.y]=this.props.isSelected),this.props.activeDescendantId&&(e[i.b]=this.props.activeDescendantId),this.props.accessibilityCurrent&&(e[i.g]=this.props.accessibilityCurrent),"number"==typeof this.props.accessibilityValueMin&&(e[i.A]=this.props.accessibilityValueMin),"number"==typeof this.props.accessibilityValueMax&&(e[i.z]=this.props.accessibilityValueMax),"number"==typeof this.props.accessibilityValueNow&&(e[i.B]=this.props.accessibilityValueNow),"boolean"==typeof this.props.accessibilityModal&&(e[i.q]=this.props.accessibilityModal),this.props.accessibilityValueText&&(e[i.C]=this.props.accessibilityValueText),this.props.role&&(e[i.F]=this.props.role),this.props.title&&(e[i.G]=this.props.title),this.props.accessibilityAriaOrientation&&(e[i.s]=this.props.accessibilityAriaOrientation),"number"==typeof this.props.tabIndex&&(e.tabIndex=this.props.tabIndex);var t=this.props[o.a.LearningPathAttributeName];if(t&&(e[o.a.LearningPathAttributeName]=t),this.props.testhooks){var n=this.props.testhooks;for(var r in n)e["data-"+r]=n[r]}null!=this.props.onClick&&(e.onClick=this.props.onClick),null!=this.props.onDoubleClick&&(e.onDoubleClick=this.props.onDoubleClick),null!=this.props.onDrag&&(e.onDrag=this.props.onDrag),null!=this.props.onDragEnd&&(e.onDragEnd=this.props.onDragEnd),null!=this.props.onDragEnter&&(e.onDragEnter=this.props.onDragEnter),null!=this.props.onDragExit&&(e.onDragExit=this.props.onDragExit),null!=this.props.onDragLeave&&(e.onDragLeave=this.props.onDragLeave),null!=this.props.onDragOver&&(e.onDragOver=this.props.onDragOver),null!=this.props.onDragStart&&(e.onDragStart=this.props.onDragStart),null!=this.props.onDrop&&(e.onDrop=this.props.onDrop),null!=this.props.onClickCapture&&(e.onClickCapture=this.props.onClickCapture),null!=this.props.onPointerOver&&(e.onPointerOver=this.props.onPointerOver),null!=this.props.onPointerOut&&(e.onPointerOut=this.props.onPointerOut),null!=this.props.onPointerUp&&(e.onPointerUp=this.props.onPointerUp),null!=this.props.onPointerDown&&(e.onPointerDown=this.props.onPointerDown),null!=this.props.onPointerEnter&&(e.onPointerEnter=this.props.onPointerEnter),null!=this.props.onPointerLeave&&(e.onPointerLeave=this.props.onPointerLeave),null!=this.props.onPointerMove&&(e.onPointerMove=this.props.onPointerMove),null!=this.props.onPointerCancel&&(e.onPointerCancel=this.props.onPointerCancel),null!=this.props.onBlur&&(e.onBlur=this.props.onBlur),null!=this.props.onFocus&&(e.onFocus=this.props.onFocus),null!=this.props.onMouseEnter&&(e.onMouseEnter=this.props.onMouseEnter),null!=this.props.onMouseLeave&&(e.onMouseLeave=this.props.onMouseLeave),null!=this.props.onKeyDown&&(e.onKeyDown=this.props.onKeyDown),null!=this.props.onKeyUp&&(e.onKeyUp=this.props.onKeyUp),null!=this.props.onScroll&&(e.onScroll=this.props.onScroll),Object.assign(e,this.getElementProps()),e.children=null,e.style=this.getElementStyle();var a=this.getElementClassName()+" "+this.getFlexClassName(e.style);return a.length>0&&(e.className=a,e.style={}),e},t.prototype.getElementStyle=function(){return this.props.style},t.prototype.getElementClassName=function(){return(this.props.styles?this.props.styles.rule:"")+(this.props.explicitStyles?" "+this.props.explicitStyles:"")},t.prototype.getFlexClassName=function(e){return""},t.prototype.getElementChildren=function(){var e=this.props.children;if(Array.isArray(e)){if(0===e.length)return null;e.length}return"string"==typeof e&&0===e.length?null:e},t.isElementScrollable=function(e){return"auto"===e.overflow||"auto"===e.overflowX||"auto"===e.overflowY||"scroll"===e.overflow||"scroll"===e.overflowX||"scroll"===e.overflowY},t.prototype.render=function(){return a.createElement(this.getElementName(),this.getElementPropsInternal(),this.getElementChildren())},Object.defineProperty(t.prototype,"isIE",{get:function(){return c},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isEdge",{get:function(){return l},enumerable:!1,configurable:!0}),t}(a.Component)},QFnk:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("5yoC");class a extends r.a{constructor(e,t){super(),this._target=null,this._principal=null,this._target=e,this._principal=t}get_name(){return"RetrievePrincipalAccess"}get_target(){return this._target}get_principal(){return this._principal}}},QFtu:function(e,t,n){"use strict";n.d(t,"o",(function(){return r})),n.d(t,"e",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"n",(function(){return s})),n.d(t,"m",(function(){return c})),n.d(t,"c",(function(){return l})),n.d(t,"h",(function(){return u})),n.d(t,"l",(function(){return d})),n.d(t,"k",(function(){return p})),n.d(t,"g",(function(){return f})),n.d(t,"f",(function(){return g})),n.d(t,"b",(function(){return h})),n.d(t,"i",(function(){return m})),n.d(t,"j",(function(){return b}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="UCISessionID",a="ErrorMessage",i="ActionName",o="EntityName",s="SyncResultMessageType",c="SyncResultMessage",l="Database",u="IsFirstTimeSync",d="SyncResultErrorCode",p="ModelJson",f="IsDssOfflineEnabled",g="IsApplicationMetadataDownloadInShimEnabled",h="ApplyApplicationMetadataChangeComplete",m="IsForcedSync",b="IsImmediateOfflineDataSync"},QGYZ:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"e",(function(){return l})),n.d(t,"d",(function(){return f})),n.d(t,"f",(function(){return g})),n.d(t,"c",(function(){return p})),n.d(t,"a",(function(){return d}));var r=n("FoFY"),a=n("zsAz"),i=n("oT5e"),o=n("arV0"),s=n("FJpk");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function c(e){return e.tabs}function l(e){const t=c(e);return Object.keys(t).length}function u(e,t){if(!e.tabs[t])throw Object(a.d)("Tab does not exist",2415919109,[{name:"tabId",value:t}]);return e.tabs[t]}function d(e,t){const n=c(e),r=Object.keys(n).find(e=>e===t);return r?n[r]:null}function p(e,t){if(!t)return null;const n=u(e,t);if(n.isTitleStatic)return n.title;const r=Object(i.a)(e,t),a=Object(o.n)(e,r.pageId);return a?Object(s.c)(a):""}function f(e,t){if(!t)return null;return Object(r.a)(e,t).tabs.map(t=>u(e,t))}function g(e,t){const n=f(e,t);return n&&n.length}},"QHx/":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("oT5e");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t,n){const a=Object(r.b)(e,t);return{source:n,targetBrowsingContext:a&&a.id}}},QMfC:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("kWiz"),a=n("pEXn");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i={[r.a.Error]:4,[r.a.Warning]:3,[r.a.Info]:1,[r.a.Verbose]:2};function o(e){const t=e.getEventName(),n=e.getEventParameter(a.b.ApplicationEventLevel).value;if(n)return n;switch(t){case a.r.Name:const t=e.getEventParameter(a.r.TraceLevel).value;return i[r.a.fromString(t)]||1;case a.o.Name:case a.i.Name:return 4;case a.n.Name:case a.k.Name:case a.q.Name:default:return 1}}},QRGJ:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n("eeMP"),a=n("SAYH"),i=n("Xe7f"),o=n("WRF3"),s=n("fVHw"),c=n("iZ7K"),l=n("16wZ"),u=n("Uv1Y");function d(e,t){return{type:"DESERIALIZE_CREATE_RESPONSE_ASYNC",async execute({dispatch:n,getState:d},p){const f=t instanceof i.a&&!Object(l.a)(t.get_target())&&!Object(l.a)(t.get_target().get_identifier())?t.get_target().get_identifier().LogicalName:t.etn;if(void 0===f){!function(e,t,n,r){const a=[];a.push({name:"CallStack",value:(new Error).stack}),a.push({name:"RequestObjectKeys",value:JSON.stringify(Object.keys(n))}),a.push({name:"ResponseStatus",value:r.status}),a.push({name:"ResponseStatusText",value:r.statusText});t.TraceManager.getTracer("CreateResponseDeserializer").error(e,a);throw new u.a(e,void 0,void 0,void 0,void 0,void 0,void 0,a)}("Unable to determine logicalname for deserializing response for the Create request.",p,t,e)}const g=Object(c.h)(d(),f).PrimaryIdAttribute,h=await Object(r.a)(g,e),m=a.a.toLegacyGuid(h),b=new o.a(f,m,null,Object(r.d)(e));return new s.a(m,b)}}}},"QT+q":function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="contextualHelp",a=340,i=5},QXIS:function(e,t,n){"use strict";n.d(t,"c",(function(){return f})),n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return l}));var r=n("kAKO"),a=n("yHIv"),i=n.p+"scripts/intersection-observer.js?v=1.4.3886-master",o=n("n3bs");class s{constructor(){this._observerMap=new Map}set(e,t){this._observerMap.set(e,t)}delete(e){this._observerMap.delete(e)}intersectAll(e){const t=this._observerMap.get(e);t&&t.intersectAll()}intersectAllForAllTabs(){this._observerMap.forEach(e=>e.intersectAll())}unintersectAll(){this._observerMap.forEach(e=>e.unintersectAll())}}class c{constructor(e){this._callback=e}observe(e){setTimeout(()=>{this._callback([{isIntersecting:!0,target:e}])},0)}unobserve(e){}disconnect(){}}class l{constructor(e,t,n,r){this._visibleComponents=[],this._observedComponentsMap=new Map,this._reactInstancePageCachingEnabled=r,this._observer=n?new IntersectionObserver(this._callback.bind(this),e):new c(this._callback.bind(this)),this._eventManager=t}unobserve(e){const t=e.getDomId();if(t){const e=document.getElementById(t);e&&this._observer.unobserve(e),this._observedComponentsMap&&this._observedComponentsMap.delete(t)}}observe(e){const t=e.getDomId();if(t){const n=document.getElementById(t);n&&(this._observedComponentsMap.set(t,e),this._observer.observe(n))}}cleanup(){this._observedComponentsMap.clear(),this._observer.disconnect()}intersectAll(){this._observedComponentsMap.forEach(this._unobserve.bind(this))}unintersectAll(){this._reactInstancePageCachingEnabled&&this._visibleComponents.forEach(e=>e.unintersect())}_unobserve(e){return!!e&&(e.intersecting(),this.unobserve(e),this._reactInstancePageCachingEnabled&&this._visibleComponents.push(e),!0)}_callback(e){e.forEach(e=>{if(e&&e.target&&e.isIntersecting){const t=this._observedComponentsMap.get(e.target.id);this._unobserve(t)||this._sendTelemetry(e.target,"IntersectionObserver.callback")}})}_sendTelemetry(e,t){if(this._eventManager&&this._eventManager.ReportComponentSuccess){const n=[];if(e){const t=e.attributes?e.attributes.getNamedItem("data-id"):null;n.push({name:"elementDataId",value:t?t.value:null})}"IntersectionObserver.callback"!==t?this._eventManager.ReportComponentSuccess(t,n):this._eventManager.ReportComponentFailure(t,n)}}}const u="IntersectionObserver"in window,d="IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype&&"isIntersecting"in window.IntersectionObserverEntry.prototype,p=!u||d;function f(){return{diagnosticName:"IntersectionObserver.boot",boot:(e,t,n)=>{t.IntersectionObserverManager=new s,u||t.AssetLoader.loadScript(i).catch(e=>{t.TraceManager.getTracer("IntersectionObserver.boot").error("Failed to load script: "+i)})},supportedClientHostTypes:a.a,supportedPageTypes:[o.a.ENTITY_RECORD.toString(),o.a.DASHBOARD.toString()],priority:r.a.Normal}}},QbIY:function(e,t,n){"use strict";n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return p}));var r=n("RiEM"),a=n("fWyz"),i=n("D+Bz"),o=n("0FMG"),s=n("qUtK"),c=n("AVDU"),l=n("uZvv"),u=n("3cEW");function d(){return{type:"sitemap.navgatetohome.async",execute:(e,t)=>e.dispatch(p())}}function p(e){return{type:"load.default.page",execute:(t,n)=>t.dispatch(Object(s.a)()).then(()=>{const n=t.getState(),{area:s,subArea:d}=Object(r.b)(n);s&&t.dispatch(Object(o.e)(s.Id));return e||(e={source:i.b.SiteMapSubArea}),t.dispatch(Object(a.b)(d,!0,()=>{Object(c.m)(n)&&1===Object(l.e)(n)&&t.dispatch(Object(u.b)())},e))})}}},QiMq:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="form.updatevisitedtabnames";function a(e,t){return{type:r,payload:t,meta:{pageId:e}}}},Qjw6:function(e,t,n){"use strict";n.d(t,"b",(function(){return y})),n.d(t,"c",(function(){return _})),n.d(t,"a",(function(){return v}));var r=n("SAYH"),a=n("odYE"),i=n("cfbi"),o=n("pEXn"),s=n("Lohl"),c=n("fILV"),l=n("uNu9"),u=n("sYIp"),d=n("zsAz"),p=n("TBkx"),f=n("i1f0"),g=n("KXSk");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const h=[l.b,l.yb];var m;function b(e,t){switch(t){case m.Inline:return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(7),n.e(10),n.e(4),n.e(5),n.e(6),n.e(9),n.e(8),n.e(11),n.e(12),n.e(13),n.e(14),n.e(15),n.e(16),n.e(17),n.e(19),n.e(23),n.e(26),n.e(28),n.e(37),n.e(43),n.e(46)]).then(n.bind(null,"CJeC")).then(({EditForm:t})=>new t(e));case m.MainFormDialog:return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(7),n.e(10),n.e(4),n.e(5),n.e(6),n.e(9),n.e(8),n.e(11),n.e(12),n.e(13),n.e(14),n.e(15),n.e(16),n.e(17),n.e(19),n.e(23),n.e(26),n.e(28),n.e(37),n.e(43),n.e(46)]).then(n.bind(null,"CJeC")).then(({MainFormDialog:t})=>new t(e));case m.BulkEdit:return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(7),n.e(10),n.e(4),n.e(5),n.e(6),n.e(9),n.e(8),n.e(11),n.e(12),n.e(13),n.e(14),n.e(15),n.e(16),n.e(17),n.e(19),n.e(23),n.e(26),n.e(28),n.e(37),n.e(43),n.e(46)]).then(n.bind(null,"CJeC")).then(({BulkEditForm:t})=>new t(e))}}!function(e){e[e.Inline=0]="Inline",e[e.MainFormDialog=1]="MainFormDialog",e[e.BulkEdit=2]="BulkEdit"}(m||(m={}));const y={getName:()=>i.b,getRequiredAttributes(){throw new Error("Not Implemented")},throwIfInvalidUrl(e){if(!e||!e.entityTypeName)throw Object(d.d)("Missing required URL parameter: etn",p.b)},preInitializePage(e,t){const{formId:n,entityTypeName:i,id:o,isPreview:c}=e,l=new a.a(i,o);return{type:"preInitialize.editFormAction.async",execute:({dispatch:a,getState:i},o,d)=>{const p=o.TraceManager.getTracer(f.c),h=this.getTelemetryAttributes(e,i());return p.info("preInitializePage started.",h),c?Object(u.b)().then(({retrievePreviewForm:e})=>a(e()).then(e=>({updatedFormId:e,error:void 0})).catch(e=>({error:e,updatedFormId:void 0}))):a(Object(s.d)(l,n,void 0,!Object(g.a)(t))).then(e=>(p&&(h.push({name:"updatedFormId",value:r.a.toString(e)}),p.info("preInitializePage completed.",h)),e===s.c?{updatedFormId:e,error:void 0,noFormsFound:!0}:{updatedFormId:e,error:void 0})).catch(e=>(p&&(h.push({name:"error",value:e&&e.toString()}),p.error("preInitializePage failed.",h)),{error:e,updatedFormId:void 0}))}}},createPageModule:e=>b(e,m.Inline),getTelemetryAttributes:e=>[{name:o.b.EntityName,value:e&&e.entityTypeName},{name:"entityId",value:e&&r.a.toString(e.id)},{name:o.b.FormId,value:e&&r.a.toString(e.formId)},{name:"isPreview",value:e&&e.isPreview}],getKeyForThawedCheck(e){const t=e.formId?e.formId.guid:"";return e.entityTypeName+t},getPredictedPageInput(e,t){if(e===c.a){const e=t;if(-1===h.indexOf(e.entityTypeName))return{entityTypeName:e.entityTypeName,id:r.a.EMPTY}}return null},forceRenderPage(e,t,n,r){r.intersectAllForAllTabs()},revertForceRenderOfPage(e,t,n,r){r.unintersectAll()}};Object.freeze(y);const _=Object.assign(Object.assign({},y),{getName:()=>i.c,createPageModule:e=>b(e,m.MainFormDialog)});Object.freeze(_);const v=Object.assign(Object.assign({},y),{getName:()=>i.a,createPageModule:e=>b(e,m.BulkEdit)});Object.freeze(v)},Qn2w:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return a}));var r=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="form.invalidControls";function i(e,t,n,i){const o=Object(r.w)(i);return{type:a,payload:{controlName:t,isValid:n},meta:{pageId:e,controlName:t,contextKey:o}}}},Qois:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.GenericError=0]="GenericError",e[e.FilePickerErrorFileSizeBreached=-2147205624]="FilePickerErrorFileSizeBreached",e[e.FilePickerErrorAttachmentTypeBlocked=-2147205623]="FilePickerErrorAttachmentTypeBlocked",e[e.FeatureNotEnabled=-2147094027]="FeatureNotEnabled",e[e.ServiceNotSupported=-2147094026]="ServiceNotSupported",e[e.ServiceAndOperationNotSupported=-2147094025]="ServiceAndOperationNotSupported",e[e.PluginCancelled=-2147094024]="PluginCancelled",e[e.NoApplicableAppFound=-2147094023]="NoApplicableAppFound",e[e.GetGeoLocationFailed=-2147094020]="GetGeoLocationFailed",e[e.BarCodeCaptureFailed=-2147094019]="BarCodeCaptureFailed",e[e.AudioCaptureFailed=-2147094018]="AudioCaptureFailed",e[e.VideoCaptureFailed=-2147094017]="VideoCaptureFailed",e[e.CameraCaptureFailed=-2147094016]="CameraCaptureFailed",e[e.FilePickerErrorFileSizeCannotBeZero=-2147094010]="FilePickerErrorFileSizeCannotBeZero",e[e.FilePickerErrorUnableToOpenFile=-2147094009]="FilePickerErrorUnableToOpenFile",e[e.GetPhotoFromGalleryFailed=-2147094008]="GetPhotoFromGalleryFailed",e[e.SaveDataFileErrorOutOfSpace=-2147094007]="SaveDataFileErrorOutOfSpace",e[e.OpenDocumentErrorCodeUnableToFindTheDataId=-2147094005]="OpenDocumentErrorCodeUnableToFindTheDataId",e[e.OpenDocumentErrorCodeGeneric=-2147094004]="OpenDocumentErrorCodeGeneric",e[e.BeginSecureSessionSilentFailed=-2147094006]="BeginSecureSessionSilentFailed",e[e.MethodNotAvailable=-2147094003]="MethodNotAvailable",e[e.OperationIsNotSupportedOnThisDevice=-2147094021]="OperationIsNotSupportedOnThisDevice"}(r||(r={}))},Qpqc:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return o}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="set.server.status.state.node.action",a="set.health.check.status";function i(e,t,n){return{type:r,payload:{isAvailable:e,isNetworkAvailable:t,isHealthCheckEnabled:n}}}function o(e){return{type:a,payload:{isHealthCheckEnabled:e}}}},Qu5s:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("eeMP"),a=n("XgcG"),i=n("RiLc"),o=n("JdSN"),s=n("V482");function c(e,t,n){return{type:"DESERIALIZE_EXECUTE_MULTIPLE_RESPONSE_ASYNC",execute({dispatch:n,getState:c},l){const u=l.DataSource.get_WebAPIService();return Object(r.b)(e).then(e=>{const r=e.map((e,r)=>{if(!e.ok)return e.json().then(n=>{let a;a=n.error?n.error:{code:e.status+"",message:e.statusText};const c=i.b.parseFromJsonRecord(a);if(t.get_settings().get_continueOnError())return new s.a(c,r,null);{const e=new o.a(null,null,null);throw e.set_organizationServiceFault(c),e}});const a=t.get_requests()[r],c=u.responseDeserializers[a.get_name()];return n(c(e,a)).then(e=>new s.a(null,r,e))});return Promise.all(r).then(e=>new a.a(!1,e))})}}}},R3zT:function(e,t,n){"use strict";
/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r="function"==typeof Symbol&&Symbol.for,a=r?Symbol.for("react.element"):60103,i=r?Symbol.for("react.portal"):60106,o=r?Symbol.for("react.fragment"):60107,s=r?Symbol.for("react.strict_mode"):60108,c=r?Symbol.for("react.profiler"):60114,l=r?Symbol.for("react.provider"):60109,u=r?Symbol.for("react.context"):60110,d=r?Symbol.for("react.async_mode"):60111,p=r?Symbol.for("react.concurrent_mode"):60111,f=r?Symbol.for("react.forward_ref"):60112,g=r?Symbol.for("react.suspense"):60113,h=r?Symbol.for("react.suspense_list"):60120,m=r?Symbol.for("react.memo"):60115,b=r?Symbol.for("react.lazy"):60116,y=r?Symbol.for("react.block"):60121,_=r?Symbol.for("react.fundamental"):60117,v=r?Symbol.for("react.responder"):60118,S=r?Symbol.for("react.scope"):60119;function O(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case a:switch(e=e.type){case d:case p:case o:case c:case s:case g:return e;default:switch(e=e&&e.$$typeof){case u:case f:case b:case m:case l:return e;default:return t}}case i:return t}}}function C(e){return O(e)===p}t.AsyncMode=d,t.ConcurrentMode=p,t.ContextConsumer=u,t.ContextProvider=l,t.Element=a,t.ForwardRef=f,t.Fragment=o,t.Lazy=b,t.Memo=m,t.Portal=i,t.Profiler=c,t.StrictMode=s,t.Suspense=g,t.isAsyncMode=function(e){return C(e)||O(e)===d},t.isConcurrentMode=C,t.isContextConsumer=function(e){return O(e)===u},t.isContextProvider=function(e){return O(e)===l},t.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===a},t.isForwardRef=function(e){return O(e)===f},t.isFragment=function(e){return O(e)===o},t.isLazy=function(e){return O(e)===b},t.isMemo=function(e){return O(e)===m},t.isPortal=function(e){return O(e)===i},t.isProfiler=function(e){return O(e)===c},t.isStrictMode=function(e){return O(e)===s},t.isSuspense=function(e){return O(e)===g},t.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===o||e===p||e===c||e===s||e===g||e===h||"object"==typeof e&&null!==e&&(e.$$typeof===b||e.$$typeof===m||e.$$typeof===l||e.$$typeof===u||e.$$typeof===f||e.$$typeof===_||e.$$typeof===v||e.$$typeof===S||e.$$typeof===y)},t.typeOf=O},RADj:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.Init=0]="Init",e[e.InSyncWithServer=1]="InSyncWithServer",e[e.SyncPending=2]="SyncPending",e[e.SyncPendingFromServer=3]="SyncPendingFromServer",e[e.SyncPendingFromMiddleware=4]="SyncPendingFromMiddleware",e[e.InProgress=5]="InProgress"}(r||(r={}))},RHUE:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("GjO+"),a=n("3BuU"),i=n("4m6s"),o=n("Ckvi"),s=n("1DaZ"),c=n("gFPh"),l=n("Ri7K"),u=function(){function e(){}return e.setEventsHandler=function(e){this._eventHandler=e},e.getEventsHandler=function(){return this._eventHandler},e.scheduleTimer=function(){var e=this,t=this._profiles[this._currentProfile][2];this._timeout<0&&t>=0&&!this._paused&&(this._eventHandler.hasEvents()?(0===t&&this._currentBackoffCount>0&&(t=1),this._timeout=setTimeout((function(){return e._batchAndSendEvents()}),t*(1<<this._currentBackoffCount)*1e3)):this._timerCount=0)},e.initialize=function(e){var t=this;this._newEventsAllowed=!0,this._config=e,this._eventHandler=new i.default(e.collectorUri,e.cacheMemorySizeLimitInNumberOfEvents,e.httpXHROverride,e.clockSkewRefreshDurationInMins),this._initializeProfiles(),o.default.initialize((function(e,n){if(t._config.canSendStatEvent("awt_stats")){var r=new s.default("awt_stats");for(var i in r.setEventPriority(a.AWTEventPriority.High),r.setProperty("TenantId",n),e)e.hasOwnProperty(i)&&r.setProperty(i,e[i].toString());c.default.getLogger(l.StatsApiKey).logEvent(r)}}))},e.setTransmitProfile=function(e){this._currentProfile!==e&&void 0!==this._profiles[e]&&(this.clearTimeout(),this._currentProfile=e,this.scheduleTimer())},e.loadTransmitProfiles=function(e){for(var t in this._resetTransmitProfiles(),e)if(e.hasOwnProperty(t)){if(3!==e[t].length)continue;for(var n=2;n>=0;--n)if(e[t][n]<0){for(var r=n;r>=0;--r)e[t][r]=-1;break}for(n=2;n>0;--n)if(e[t][n]>0&&e[t][n-1]>0){var a=e[t][n-1]/e[t][n];e[t][n-1]=Math.ceil(a)*e[t][n]}this._profiles[t]=e[t]}},e.sendEvent=function(e){this._newEventsAllowed&&(this._currentBackoffCount>0&&e.priority===a.AWTEventPriority.Immediate_sync&&(e.priority=a.AWTEventPriority.High),this._eventHandler.addEvent(e),this.scheduleTimer())},e.flush=function(e){var t=(new Date).getTime();!this._paused&&this._lastUploadNowCall+3e4<t&&(this._lastUploadNowCall=t,this._timeout>-1&&(clearTimeout(this._timeout),this._timeout=-1),this._eventHandler.uploadNow(e))},e.pauseTransmission=function(){this._paused||(this.clearTimeout(),this._eventHandler.pauseTransmission(),this._paused=!0)},e.resumeTransmision=function(){this._paused&&(this._paused=!1,this._eventHandler.resumeTransmission(),this.scheduleTimer())},e.flushAndTeardown=function(){o.default.teardown(),this._newEventsAllowed=!1,this.clearTimeout(),this._eventHandler.teardown()},e.backOffTransmission=function(){this._currentBackoffCount<4&&(this._currentBackoffCount++,this.clearTimeout(),this.scheduleTimer())},e.clearBackOff=function(){this._currentBackoffCount>0&&(this._currentBackoffCount=0,this.clearTimeout(),this.scheduleTimer())},e._resetTransmitProfiles=function(){this.clearTimeout(),this._initializeProfiles(),this._currentProfile=r.AWT_REAL_TIME,this.scheduleTimer()},e.clearTimeout=function(){this._timeout>0&&(clearTimeout(this._timeout),this._timeout=-1,this._timerCount=0)},e._batchAndSendEvents=function(){var e=a.AWTEventPriority.High;this._timerCount++,this._timerCount*this._profiles[this._currentProfile][2]===this._profiles[this._currentProfile][0]?(e=a.AWTEventPriority.Low,this._timerCount=0):this._timerCount*this._profiles[this._currentProfile][2]===this._profiles[this._currentProfile][1]&&(e=a.AWTEventPriority.Normal),this._eventHandler.sendEventsForPriorityAndAbove(e),this._timeout=-1,this.scheduleTimer()},e._initializeProfiles=function(){this._profiles={},this._profiles[r.AWT_REAL_TIME]=[4,2,1],this._profiles[r.AWT_NEAR_REAL_TIME]=[12,6,3],this._profiles[r.AWT_BEST_EFFORT]=[36,18,9]},e._newEventsAllowed=!1,e._currentProfile=r.AWT_REAL_TIME,e._timeout=-1,e._currentBackoffCount=0,e._paused=!1,e._timerCount=0,e._lastUploadNowCall=0,e}();t.default=u},RIJJ:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * The unique name of the LegacyDialog page module.
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="LegacyDialog"},RIwK:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n("504W"),a=n("fU7K");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function i(e){return Object(r.a)(e)?"":Object(a.CrmXmlAttributeEncode)(e)}function o(e){return Object(r.a)(e)?"":Object(a.CrmXmlEncode)(e)}},RJiR:function(e,t,n){"use strict";n.d(t,"j",(function(){return a})),n.d(t,"l",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"i",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"m",(function(){return l})),n.d(t,"e",(function(){return u})),n.d(t,"a",(function(){return d})),n.d(t,"d",(function(){return p})),n.d(t,"h",(function(){return f})),n.d(t,"f",(function(){return g})),n.d(t,"k",(function(){return h})),n.d(t,"g",(function(){return m}));var r=n("Az35");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 *
 * Use this file to export lazy loaded versions of the UCI react-native components.
 */Object(r.a)("GreetingLabel");const a=Object(r.a)("ProvidePageScrollContext"),i=(Object(r.a)("NavigationBar"),Object(r.a)("StackNavigator")),o=Object(r.a)("ConnectToPageScrollContext"),s=Object(r.a)("NavigationBarPageTitle"),c=Object(r.a)("FillNativeNavigationBar"),l=Object(r.a)("ViewSelector"),u=Object(r.a)("FullScreenModal"),d=Object(r.a)("ConfirmDialog"),p=Object(r.a)("FormFlyoutWithNativeHeader"),f=Object(r.a)("NativeSubgridCommandbarWrapper"),g=Object(r.a)("NativeItemLevelCommandDrawer"),h=Object(r.a)("QuickFindSearchBar"),m=Object(r.a)("NativeSortColumnDrawer")},RMPf:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return l}));var r=n("23jc"),a=n("SRlt"),i=n("OU7F"),o=n("g22U");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const s="relevancesearch.index.ready.set";function c(){return{type:s,payload:{}}}function l(){return{type:"relevance.search.Index.Status.retrieve.async",execute:async(e,t)=>{var n;try{const t=localStorage.getItem("RelevanceSearchIndexStatusTimestamp");if(t&&!Number.isNaN(Number.parseInt(t,10))){if(Number.parseInt(t,10)-(new Date).getTime()<432e5)return void e.dispatch(c())}}catch(e){}const s={endpoint:i.m,method:"GET",urlParameters:"",additionalParameters:{[o.a.TYPE]:o.d.FUNCTION,[o.a.SUB_TYPE]:o.c.RetrieveRelevanceSearchIndex,[o.a.SOURCE]:"relevance.search.Index.Status.retrieve.async"}};try{const i=await e.dispatch(Object(r.a)(s)),o=await Object(a.g)(i);if(o.code)throw t.EventManager.ReportComponentFailure("GlobalSearchAction.retrieveRelevanceSearchIndexStatus.apiError",o),new Error(o.message);if("provisioned"===(null===(n=o.value)||void 0===n?void 0:n.status)){try{localStorage.setItem("RelevanceSearchIndexStatusTimestamp",(new Date).getTime().toString())}catch(e){}e.dispatch(c())}}catch(e){t.EventManager.ReportComponentFailure("GlobalSearchAction.retrieveRelevanceSearchIndexStatus.error",e)}}}}},RNUx:function(e,t,n){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},RREX:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.attribute=0]="attribute",e[e.organization=1]="organization",e[e.currency=2]="currency"}(r||(r={}))},RVeV:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.DURATION=1]="DURATION",e[e.TIMEZONE=2]="TIMEZONE",e[e.LANGUAGE=3]="LANGUAGE"}(r||(r={}))},RWYE:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));const r="businessProcessFlow.instance.businessprocessflowsbyid.remove";function a(e){return{type:r,payload:e}}},RYFF:function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var r=n("EbwQ"),a=n("sJUk"),i=n("/Ypj"),o=n("ZhaJ"),s=n("504W"),c=n("8uvO");class l extends o.a{constructor(e,t,n,r){super(),this._batch=null,this._onBatchComplete=null,this._batch=e,this._onBatchComplete=t,this._shouldRetry=null!=r?r:function(){return!1},this.set_callContext(n)}_get_BatchResult(){return this.getValue(l.BatchResultProperty)}_get_MappingState(){return this.getValue(l.MappingStateProperty)}_get_UsedProfileId(){return this.getValue(l.UsedProfileIdProperty)}_get_CurrentProfileId(){return this.getValue(l.CurrentProfileIdProperty)}_get_newProfileId(){return this.getValue(l.NewProfileIdProperty)}call(){const e={sqlBatchResult:this._get_BatchResult(),mappingState:this._get_MappingState(),usedProfileId:this._get_UsedProfileId(),currentProfileId:this._get_CurrentProfileId(),newProfileId:this._get_newProfileId()},t=e.sqlBatchResult;if(this._shouldRetry(e))return this._onBatchComplete(!0,e),void(this._batch=null);for(let e=0;e<t.length;++e)if(this._IsErrorResult(t[e])){let n=t[e];Object(s.a)(n.message)&&(n=JSON.parse(t[e].toString())),this._batch.get_ErrorCallbacks()[e](n)}else{let n=t[e];Object(s.a)(n.rows)&&(n=JSON.parse(t[e].toString())),this._batch.get_SuccessCallbacks()[e](n)}this._onBatchComplete(!1,e),this._batch=null}_IsErrorResult(e){const t=e;return!Object(s.a)(t.code)}}l.BatchResultProperty=new c.a("sqlBatchResult",Array,l),l.MappingStateProperty=new c.a("mappingState",Number,l),l.CurrentProfileIdProperty=new c.a("currentProfileId",String,l),l.UsedProfileIdProperty=new c.a("usedProfileId",String,l),l.NewProfileIdProperty=new c.a("newProfileId",String,l);class u extends a.a{constructor(e,t,n,r){super(),this._hasBigArgs=!1,this.set_callContext(new i.a(e.get_CallId(),n)),this.setValue(u.StatementBatchProperty,e.get_Statements()),this.setValue(u.ParameterBatchProperty,e.get_Parameters()),this.setValue(u.BatchCompleteCallbackProperty,new l(e,t,this.get_callContext(),r)),this._hasBigArgs=e.get_estimatedSize()>y.bigArgStringLength}get_methodName(){return"executeSqlBatch"}get_hasBigArgs(){return this._hasBigArgs}}u.StatementBatchProperty=new c.a("statementBatch",Array,u),u.ParameterBatchProperty=new c.a("parameterBatch",Array,u),u.BatchCompleteCallbackProperty=new c.a("onBatchComplete",l,u);var d=n("paR0"),p=n("NMtn"),f=n("a475"),g=n("7Gx7");class h extends u{constructor(e,t,n,r){super(e,t,n,r),this.setValue(h.RequestIdProperty,e.get_RequestId()),this.setValue(h.extraParametersProperty,new g.a(e.get_ExtraParameters()))}get_methodName(){return"executeMetadataSqlBatch"}}h.RequestIdProperty=new c.a("requestId",String,h),h.extraParametersProperty=new c.a("extraParameters",g.a,h),h.BatchCompleteCallbackProperty=new c.a("onBatchComplete",l,h);var m=n("Tsbx");let b=0;class y extends r.a{get_namespaceName(){return"CrmSql"}get_dispatcherPerfDataLoggingEnabled(){return f.a.get_Instance().get_application().get_applicationState().get_dispatcherPerfLoggingEnabled()}createBatch(e,t){return new d.a(this,e,t)}getCallIdForSqlBatchExecution(){let e=null;return this.get_dispatcherPerfDataLoggingEnabled()&&(e=(++b).toString()),e}ExecuteSqlBatch(e,t){Object(p.b)(e,"batch");const n=new u(e,t,this);this.callNativeMethod(this.get_version().get_currentVersion(),n)}ExecuteMetadataSqlBatch(e,t,n){Object(p.b)(e,"batch");const r=new h(e,t,this,n);this.callNativeMethod(this.get_version().get_currentVersion(),r)}static CalculateEstimatedSize(e,t){return Object(m.a)(e,t)}}y.bigArgStringLength=256},Ri7K:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("SNT6"),a=n("3BuU"),i=/[xy]/g;t.EventNameAndTypeRegex=/^[a-zA-Z]([a-zA-Z0-9]|_){2,98}[a-zA-Z0-9]$/,t.EventNameDotRegex=/\./g,t.PropertyNameRegex=/^[a-zA-Z](([a-zA-Z0-9|_|\.]){0,98}[a-zA-Z0-9])?$/,t.StatsApiKey="a387cfcf60114a43a7699f9fbb49289e-9bceb9fe-1c06-460f-96c5-6a0b247358bc-7238";var o=null,s=null,c=null;function l(e){return"string"==typeof e}function u(e){return"number"==typeof e}function d(e){return"boolean"==typeof e}function p(e){return e instanceof Date}function f(e){return 1e4*(e+621355968e5)}function g(){return!("undefined"==typeof navigator||!navigator.product)&&"ReactNative"===navigator.product}function h(){return"object"==typeof self&&"ServiceWorkerGlobalScope"===self.constructor.name}function m(e){return e<10?"0"+e:e.toString()}function b(e){return null==e||""===e}t.numberToBondInt64=function(e){var t=new r.Int64("0");return t.low=4294967295&e,t.high=Math.floor(e/4294967296),t},t.newGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(i,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))},t.isString=l,t.isNumber=u,t.isBoolean=d,t.isDate=p,t.msToTicks=f,t.getTenantId=function(e){var t=e.indexOf("-");return t>-1?e.substring(0,t):""},t.isBeaconsSupported=function(){return null===o&&(o="undefined"!=typeof navigator&&Boolean(navigator.sendBeacon)),o},t.isUint8ArrayAvailable=function(){return null===s&&(s="undefined"!=typeof Uint8Array&&!function(){if("undefined"!=typeof navigator&&navigator.userAgent){var e=navigator.userAgent.toLowerCase();if((e.indexOf("safari")>=0||e.indexOf("firefox")>=0)&&e.indexOf("chrome")<0)return!0}return!1}()&&!g()),s},t.isPriority=function(e){return!(!u(e)||!(e>=1&&e<=3||5===e))},t.sanitizeProperty=function(e,n){return!t.PropertyNameRegex.test(e)||b(n)?null:(b(n.value)&&(n={value:n,type:a.AWTPropertyType.Unspecified}),n.type=function(e,t){switch(t=function(e){if(u(e)&&e>=0&&e<=4)return!0;return!1}(t)?t:a.AWTPropertyType.Unspecified){case a.AWTPropertyType.Unspecified:return function(e){switch(typeof e){case"string":return a.AWTPropertyType.String;case"boolean":return a.AWTPropertyType.Boolean;case"number":return a.AWTPropertyType.Double;case"object":return p(e)?a.AWTPropertyType.Date:null}return null}(e);case a.AWTPropertyType.String:return l(e)?t:null;case a.AWTPropertyType.Boolean:return d(e)?t:null;case a.AWTPropertyType.Date:return p(e)&&NaN!==e.getTime()?t:null;case a.AWTPropertyType.Int64:return u(e)&&e%1==0?t:null;case a.AWTPropertyType.Double:return u(e)?t:null}return null}(n.value,n.type),n.type?(p(n.value)&&(n.value=f(n.value.getTime())),n.pii>0&&n.cc>0?null:n.pii?function(e){if(u(e)&&e>=0&&e<=13)return!0;return!1}(n.pii)?n:null:n.cc?function(e){if(u(e)&&e>=0&&e<=1)return!0;return!1}(n.cc)?n:null:n):null)},t.getISOString=function(e){return e.getUTCFullYear()+"-"+m(e.getUTCMonth()+1)+"-"+m(e.getUTCDate())+"T"+m(e.getUTCHours())+":"+m(e.getUTCMinutes())+":"+m(e.getUTCSeconds())+"."+function(e){if(e<10)return"00"+e;if(e<100)return"0"+e;return e.toString()}(e.getUTCMilliseconds())+"Z"},t.useXDomainRequest=function(){if(null===c){var e=new XMLHttpRequest;c=void 0===e.withCredentials&&"undefined"!=typeof XDomainRequest}return c},t.useFetchRequest=function(){return g()||h()},t.isReactNative=g,t.isServiceWorkerGlobalScope=h},RiEM:function(e,t,n){"use strict";n.d(t,"d",(function(){return d})),n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return p}));var r=n("d6Hx"),a=n("2FbK"),i=n("IqkD"),o=n("GYEz"),s=n("w1eR"),c=n("uZvv");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const l="/workplace/home_search_page.aspx";function u(e){const t=Object(a.a)(e);if(t&&t.AreaIds){const n=function(e){const t=Object(a.a)(e);if(t&&t.AreaIds){const n=function(e){const t=Object(a.a)(e),n=Object(i.x)(e).homepageArea;if(Object(o.a)(e)===s.a.Browser&&t&&t.AreaIds&&n&&"<Default>"!==n&&t.AreaIds.indexOf(n)>-1)return n;return}(e),r=Object(i.x)(e).homepageSubArea;if(n){const e=t.Areas[n];if(r)for(const t of e.GroupIds){const n=e.Groups[t];if(n.SubAreaIds.indexOf(r)>-1)return{area:e,subArea:n.SubAreas[r]}}else for(const t of e.GroupIds){const n=e.Groups[t];for(const t of n.SubAreaIds){const r=n.SubAreas[t];if(!d(r))return{area:e,subArea:r}}}}}return}(e);if(n)return n;const c=t.AreaIds.filter(e=>e!==r.c);for(const e of c){const n=t.Areas[e];for(const e of n.GroupIds){const t=n.Groups[e];for(const e of t.SubAreaIds){const r=t.SubAreas[e];if(!d(r))return{area:n,subArea:r}}}}}return{area:void 0,subArea:{Url:l}}}function d(e){var t;return!(e.Entity||e.DefaultDashboard||e.Page||!(null===(t=e.Url)||void 0===t?void 0:t.toLowerCase().startsWith("http")))}function p(e){var t;const n=u(e),r=Object(c.c)(e);return(null===(t=null==n?void 0:n.subArea)||void 0===t?void 0:t.Id)===r}},RiHV:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e.LearningPathDOMAttributeSuffix="lp-id",e.LearningPathDOMAttributeName="data-"+e.LearningPathDOMAttributeSuffix,e.LearningPathFeatureName="GuidedHelp"}(r||(r={}))},RiLc:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return a}));var r=n("504W");const a="@Microsoft.PowerApps.CDS";class i{constructor(){this._responseXml=null,this._errorCode=0,this._innerFault=null,this._callStack=null,this._responseText=null,this._annotations=null,this._messages=[]}get_annotations(){return this._annotations}get_innerFault(){return this._innerFault}get_errorCode(){return this._errorCode}get_message(){return this._messages&&this._messages.length?this._messages[0]:null}get_messages(){return this._messages}get_responseXml(){return this._responseXml}_get_responseOuterXml(){return this._responseXml.get_outerXml()}get_responseText(){return Object(r.a)(this._responseXml)?this._responseText:this._get_responseOuterXml()}get_callStack(){return this._callStack}static parseFromXml(e){const t=new i;if(Object(r.a)(e))return t;e.addNamespace("d","http://schemas.microsoft.com/xrm/2011/Contracts/Services"),e.addNamespace("a","http://schemas.microsoft.com/xrm/2011/Contracts"),e.addNamespace("b","http://schemas.datacontract.org/2004/07/System.Collections.Generic"),e.addNamespace("c","http://schemas.microsoft.com/xrm/2012/Contracts"),e.addNamespace("i","http://www.w3.org/2001/XMLSchema-instance"),t._responseXml=e;let n=".//a:OrganizationServiceFault";const a=e.selectSingleNode(n);Object(r.a)(a)&&"c:Fault"===e.get_tagName()&&(n="./");const s=e.selectSingleNode(n+"/a:ErrorCode");Object(r.a)(s)||(t._errorCode=Number.parseInvariant(s.get_innerText()));const c=e.selectSingleNode(n+"/a:TraceText");Object(r.a)(c);const l=e.selectSingleNode(n+"/a:InnerFault[not(@i:nil)]"),u=e=>{const t=new i;if(Object(r.a)(e))return t;const n=o(e,"ErrorCode").get_item(0).get_innerText();t._errorCode=Number.parseInvariant(n),t._messages.push(o(e,"Message").get_item(0).get_innerText());const a=o(e,"InnerFault");if(a.get_count()>0){const e=a.get_item(0);e.hasChildNodes()&&(t._innerFault=u(e))}return t};Object(r.a)(l)||(t._innerFault=u(l));const d=e.selectSingleNode(".//a:KeyValuePairOfstringanyType[b:key='CallStack']/b:value");Object(r.a)(d)||(t._callStack=d.get_innerText());const p=e.getElementsByTagName("Message");if(!Object(r.a)(p)&&p.get_count())for(let e=0;e<p.get_count();e++)t._messages.push(p.get_item(e).get_innerText());else t._messages.push(e.get_outerXml());return t}static parseFromJson(e){var t;try{const n=JSON.parse(e),a=null!==(t=n.error)&&void 0!==t?t:n._error;let o=null;return o=Object(r.a)(a)?i.parseFromJsonRecord(n):i.parseFromJsonRecord(a),o._responseText=e,o}catch(t){const n=new i;return n._messages.push(e),n}}static parseFromJsonRecord(e){var t,n,o,s;const c=new i,l=null!==(n=null!==(t=e.code)&&void 0!==t?t:e.Code)&&void 0!==n?n:e.ErrorCode;Object(r.b)(l)||(c._errorCode=Number.parseInvariant(l.toString()));const u=null!==(s=null!==(o=e.message)&&void 0!==o?o:e.Message)&&void 0!==s?s:e.Description;Object(r.b)(u)?c._messages.push("No error message returned from server. Error code: "+l):c._messages.push(u);const d=e.tracetext;Object(r.b)(d);let p=e.stacktrace;Object(r.b)(p)?(p=e.StackTrace,Object(r.b)(p)||(c._callStack=p)):c._callStack=p;const f=a+".InnerError.Message";if(!Object(r.a)(e[f])){const t=new i;t._messages=[e[f]],c._innerFault=t}if(!Object(r.a)(e.innererror)){const t=e.innererror;c._innerFault=i.parseFromJsonRecord(t)}return c._annotations=function(e){const t={};return Object.keys(e).forEach(n=>{n.startsWith(a)&&(t[n]=e[n])}),t}(e),c}static parseFromHtml(e){var t,n,a;const o=new i;if(Object(r.b)(e))return o;const s=(new DOMParser).parseFromString(e,"text/html");let c=null===(t=s.querySelector("#errDescription"))||void 0===t?void 0:t.textContent;Object(r.b)(c)&&(c=null===(n=s.querySelector(".content-container"))||void 0===n?void 0:n.textContent),Object(r.b)(c)&&(c=e),o._messages.push(c);let l=null===(a=s.querySelector("#errNumber"))||void 0===a?void 0:a.textContent;Object(r.b)(l)&&s.querySelectorAll("th").forEach(e=>{var t;e.textContent.indexOf("Error Code")&&(l=null===(t=e.nextSibling)||void 0===t?void 0:t.textContent)});const u=parseInt(l,16),d=2147483648&u?-1:1;return o._errorCode=d*(1+~u),o}static fromErrorCode(e){const t=new i;return t._errorCode=e,t}}function o(e,t){const n=e.getElementsByTagName(t);return Object(r.a)(n)||!n.get_count()?e.getElementsByTagName("a:"+t):n}},Rj8P:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return o}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="offline.status.set",a="offline.issyncing";function i(e,t,n=null,a=null){return{type:r,payload:{status:e,statusReason:t,errorCode:n,errorMessage:a}}}function o(e){return{type:a,payload:{isSyncing:e}}}},RrRQ:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return i}));var r=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="dataSnapshot.discard";function i(e,t,n){return{type:"dataSnapshot.discard.async",sync:!0,execute({dispatch:i,getState:s},c){i(function(e,t,n){const i=Object(r.w)(n);return{type:a,payload:t,meta:{pageId:e,contextKey:i}}}(e,t,n)),i(o(t))}}}function o(e){return{type:a,payload:null,meta:e}}},RrRu:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return l}));var r=n("SAYH"),a=n("dHD5"),i=n("BFlg"),o=n("P6DH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const s="dataset.mark.selected.rows";function c(e,t,n){return{type:"mark.selected.rows.async",execute({dispatch:s,getState:c},u){const d=u.TraceManager.getTracer(i.P),p=i.N+".markedSelectedRowsAction";try{const i=Object(a.w)(t),f=c(),g=Object(o.ib)(f,e,t)||[];return(g.length!==n.length||n.some(e=>g.every(t=>!r.a.equals(t,e))))&&(s(l(e,i,n)),d.info("Marking the selected {0} rows"+n.length)),u.EventManager.ReportComponentSuccess(p),Promise.resolve()}catch(e){const t="marking the selected "+n.length+" failed";u.EventManager.ReportComponentFailure(p,Error(t))}}}}function l(e,t,n){return{type:s,payload:n,meta:{pageId:e,dataSetContextKey:t}}}},Rvih:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class r{getMetadata(){return{boundParameter:null,operationName:"UpdateRecentItems",operationType:0,parameterTypes:{items:{typeName:"mscrm.RecentItem",structuralProperty:4}}}}}},RvmO:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("jjPz"),a=n("a8hT"),i=n("3/02"),o=n("Lyxw"),s=n("Uv1Y");function c(e,t,n,c,l){return Object(r.a)(arguments,{type:"execute.expression.function",async execute({dispatch:r,getState:u},d){if(!Object(o.f)(u(),i.Fe))throw s.a.fromErrorCode(u(),-2147086061);const p=await Object(a.b)(),f=await p.executeExpressionFunction(e,t,n,c,u,r,l,d);return null==f?void 0:f.value}})}},RymD:function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return o}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r=2,a="back_nav_session_state_key",i="hide_tooltip_state_data_key",o="dimiss_count_state_data_key"},"S/Br":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class r{constructor(e,t){this.IsBusinessNotification=!1,this.IsBusinessNotification=!0}}},S70w:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.CurrencySymbol=0]="CurrencySymbol",e[e.CurrencyCode=1]="CurrencyCode"}(r||(r={}))},SAYH:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("84PK");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a=/^({?)((\d|[a-fA-F]){8}-(\d|[a-fA-F]){4}-(\d|[a-fA-F]){4}-(\d|[a-fA-F]){4}-(\d|[a-fA-F]){12})(}?)$/,i=/^([a-fA-F\d]{8})([a-fA-F\d]{4})([a-fA-F\d]{4})([a-fA-F\d]{4})([a-fA-F\d]{12})$/;class o{constructor(e,t=!1){if(t)this.guid=e;else{const t=s(e);if(!t)throw new Error(e+" is not a valid Guid value.");this.guid=t}Object.freeze(this)}static externalGuid(e){return e&&e.guid?"{"+e.guid.toUpperCase()+"}":o.EMPTYSTRING}static fromExternalGuid(e){return e?new o(e.replace(/[\{\}]/gi,"")):o.EMPTY}static validate(e){return null!=e&&null!==a.exec(e)}static toString(e){return e?e.guid:null}static tryParse(e){return o.tryParseOrNull(e)||o.EMPTY}static tryParseOrNull(e){const t=s(e);return t?new o(t,!0):null}static parse(e){return new o(e)}static toLegacyGuid(e){return e?r.a.createFromFormattedGuidStringAndSkipParsing(e.guid):null}static fromLegacyGuid(e){if(e){const t=e.toString();if(t)return new o(t,!0)}return null}static equals(e,t){return null==e||null==t?e===t:o.toString(e)===o.toString(t)}static isNullOrEmpty(e){return!e||o.equals(e,o.EMPTY)}static newGuid(){let e="";for(let t=0;t<36;t++)if(14===t)e+="4";else if(8===t||13===t||18===t||23===t)e+="-";else if(19===t){const t=Math.floor(16*Math.random());e+="0123456789abcdef".substr(3&t|8,1)}else e+="0123456789abcdef".substr(Math.floor(16*Math.random()),1);return new o(e,!0)}}function s(e){if(!e||"string"!=typeof e)return null;e=e.toLowerCase();const t=a.exec(e);if(t)return t[1].length!==t[8].length?null:t[2];const n=i.exec(e);return n?n.filter((e,t)=>t>0).join("-"):null}o.EMPTYGUIDSTRING="00000000-0000-0000-0000-000000000000",o.EMPTY=new o(o.EMPTYGUIDSTRING,!0),o.EMPTYSTRING=""},SDQ8:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"e",(function(){return o})),n.d(t,"d",(function(){return l})),n.d(t,"f",(function(){return s})),n.d(t,"b",(function(){return c}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r=".modelFormComponent.",a={};function i(e,t){return a[e]||(a[e]={}),a[e][t]||(a[e][t]=0),`${t}${r}${a[e][t]}${r}${e}`}function o(e,t){return s(e,t),i(e,t)}function s(e,t){var n;const r=null===(n=a[e])||void 0===n?void 0:n[t];null!=r&&(a[e][t]=r+1)}function c(e){delete a[e]}function l(e,t){return a[e][t]}},SEva:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("mMyr"),a=n("u+q+");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class i extends r.Component{constructor(e){super(e),this.state={error:null}}render(){const{fallback:e}=this.props,{error:t}=this.state;return t?e(t):this.props.children}componentDidCatch(e,t){const{onError:n,name:r}=this.props;this.props.reportError(r+".ErrorBoundary",e,[{name:"componentStack",value:t.componentStack}]),n(e,t)}}i.getDerivedStateFromError=e=>({error:e});const o=Object(a.a)(void 0,(function(e){return{reportError(t,n,r){e({type:"react.catch",execute:(e,a)=>(a.EventManager.ReportComponentFailure(t,n,void 0,r),Promise.resolve())})}}}))(i);o.displayName="ErrorBoundary",o.defaultProps={fallback:()=>null,onError:()=>{}}},SFgX:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return r}));const r="",a={activitypointer:"",account:"",audit:"",contact:"",connection:"",customeraddress:"",lead:"",opportunity:"",position:"",competitor:"",quote:"",salesorder:"",invoice:"",product:"",salesliterature:"",list:"",bulkoperation:"",goal:"",metric:"",goalrollupquery:"",report:"",task:"",appointment:"",email:"",phonecall:"",incident:"",queueitem:"",knowledgearticle:"",opportunityproduct:"",systemform:"",team:"",transactioncurrency:"",userform:"",defaulticon:"",defaultrecenticon:"",sharepointdocument:"",systemuser:"",service:"",serviceappointment:"",equipment:"",routingrule:"",routingruleitem:"",msdyn_knowledgearticletemplate:"",msdyn_servicelevelagreement:"",msdyn_servicelevelagreementkpi:"",msdyn_servicelevelagreementinstance:"",letter:"",campaignresponse:"",fax:"",site:""};function i(e,t){let n=a[e]||r;return t&&-1!==t.indexOf("/workplace/home_dashboards.aspx")&&(n=""),n}},SJ2k:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return u}));var r=n("kAKO"),a=n("yHIv");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class i{constructor(e,t){this.previousClientVersion=e,this.currentClientVersion=t,this._dataStore={}}storeData(e,t){this._dataStore[e]=t}getData(e){return this._dataStore[e]}}var o=n("jsc8"),s=n("GdzE"),c=n("ml6Y");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const l="8200000000";function u(){return{diagnosticName:"UpgradeHandler",boot:(e,t,r)=>{let a=!1;return function(e){return new Promise((t,n)=>{e.dispatch(Object(o.a)(c.a.ClientVersionKey)).then(n=>{null==n?e.dispatch(Object(o.a)("LastUserContextTime")).then(e=>{(n={})[c.a.ClientVersionKey]=null!=e?l:window.CLIENT_VERSION_VALUE,t({clientVersion:n,hasClientVersionKey:!1})}):t({clientVersion:n,hasClientVersionKey:!0})})})}(r).then(o=>{const{clientVersion:s,hasClientVersionKey:l}=o;a=l;const u=function(e){const t=e[c.a.ClientVersionKey],n=window.CLIENT_VERSION_VALUE;return new i(t,n)}(s);return u.previousClientVersion!==u.currentClientVersion?Promise.all([n.e(44),n.e(172)]).then(n.bind(null,"TUTw")).then(({runUpgradeHandlers:n})=>n(e,t,r,u)):u}).then(e=>{!function(e,t,n){if(t.currentClientVersion!==t.previousClientVersion||!n){const n={[c.a.ClientVersionKey]:t.currentClientVersion};e.dispatch(Object(s.a)(c.a.ClientVersionKey,n,!1))}}(r,e,a)})},supportedClientHostTypes:a.a,supportedPageTypes:a.b,priority:r.a.Normal}}},SJlc:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e.booleanType="boolean",e.dateTimeType="datetime",e.decimalType="decimal",e.doubleType="double",e.integerType="integer",e.lookupType="lookup",e.memoType="memo",e.moneyType="money",e.optionSetType="optionset",e.stringType="string",e.partylistType="partyList",e.multiSelectOptionSetType="multiselectoptionset",e.entityTypeOptionSet="entityname"}(r||(r={}))},SNT6:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.low=0,this.high=0,this.low=parseInt(e,10),this.low<0&&(this.high=-1)}return e.prototype._Equals=function(t){var n=new e(t);return this.low===n.low&&this.high===n.high},e}();t.Int64=r;var a=function(){function e(e){this.low=0,this.high=0,this.low=parseInt(e,10)}return e.prototype._Equals=function(t){var n=new e(t);return this.low===n.low&&this.high===n.high},e}();t.UInt64=a;var i=function(){function e(){}return e._ToByte=function(e){return this._ToUInt8(e)},e._ToUInt8=function(e){return 255&e},e._ToInt32=function(e){return 2147483647&e|2147483648&e},e._ToUInt32=function(e){return 4294967295&e},e}();t.Number=i},SRl2:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"d",(function(){return s})),n.d(t,"a",(function(){return c})),n.d(t,"c",(function(){return l}));var r=n("eXjw"),a=n("69Qu"),i=n("sZ+8");
/**form
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const o=(e,t)=>e&&e.metadata&&e.metadata.ribbons?e.metadata.ribbons[t]:null,s=(e,t)=>{const n=o(e,t);return n?n.initialized:r.a.Uninitialized},c=(e,t)=>{const n=o(e,t);if(n){const r=t&&t.split(":"),o=null==r?void 0:r[1];return(Object(a.c)(e)||Object(i.r)(e,o))&&n.LoadedWhileOffline}return!1},l=e=>e&&e.metadata?e.metadata.ribbonsLabelIds:null},SRlt:function(e,t,n){"use strict";n.d(t,"b",(function(){return Ye})),n.d(t,"a",(function(){return $e})),n.d(t,"c",(function(){return Ze})),n.d(t,"f",(function(){return et})),n.d(t,"e",(function(){return tt})),n.d(t,"g",(function(){return nt})),n.d(t,"d",(function(){return rt}));var r=n("D4rv"),a=n("3/02"),i=n("FZDd"),o=n("x/aW"),s=n("SZCI"),c=n("l0Rp"),l=n("tHtE"),u=n("GYEz"),d=n("E5IU"),p=n("/A0C"),f=n("w1eR"),g=n("0rLi"),h=n("Xe7f"),m=n("JdSN"),b=n("jxo7"),y=n("jZCH"),_=n("EW4s"),v=n("qK01"),S=n("Uv1Y"),O=n("c0fp"),C=n("UKgB"),E=n("AEtR"),I=n("SAYH"),w=n("Wc7r"),j=n("504W"),P=n("XvL5"),T=n("iJGp"),N=n("nxt5"),A=n("RADj"),R=n("fMBw"),D=n.n(R),x=n("zBbx"),M=n("sjhR");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class F{getMetadata(){return{boundParameter:null,operationName:"SyncClientMetadata",operationType:0,parameterTypes:{ClientMetadataQueries:{typeName:"mscrm.MetadataQuery",structuralProperty:4}}}}}var k=n("4r2D"),L=n("Rvih"),B=n("PF3G"),U=n("DS+G"),V=n("5UJb"),z=n.n(V),q=n("WbTV"),H=n("w72X"),W=n("sNgR"),G=n("4ciL"),K=n("QRGJ"),Q=n("JZmp"),X=n("Zit9"),Y=n("Qu5s"),J=n("49Vs"),$=n("/JYk"),Z=n("Oawc"),ee=n("Cxkq"),te=n("OcZc"),ne=n("x0oY"),re=n("IuCO"),ae=n("a8hT"),ie=n("4N6w"),oe=n("UwOy"),se=n("K7RF"),ce=n("hAdb"),le=n("x/BX"),ue=n("NvOS"),de=n("iZ7K"),pe=n("qAG9"),fe=n("BDhr"),ge=n("wCzE"),he=n("Lyxw"),me=n("7F2l"),be=n("yRo8"),ye=n("eeMP"),_e=n("jAuy"),ve=n("5KQF"),Se=n("O4uv"),Oe=n("01Vp"),Ce=n("iEjf"),Ee=n("aRLb"),Ie=n("FfwU");function we(e,t){return{type:"SERIALIZE_EXECUTEQUICKFIND_ASYNC",execute({dispatch:n,getState:r},a){const i=new Ie.a;i.SearchText=e.get_searchText(),i.EntityGroupName=e.get_entityGroupName(),i.EntityNames=e.get_entityNames();const o=Object(d.k)(r());if(o){const e={appmoduleid:o,"@odata.type":"Microsoft.Dynamics.CRM.appmodule"};i.AppModule=e}return n(Object(Ee.e)(t,i)).then(()=>Object(H.a)(r(),i))}}}function je(e){return{type:"SERIALIZE_GET_CLIENT_METADATA_ASYNC",execute({dispatch:t,getState:n},r){const a=e.get_clientMetadataQuery(),i=Object(o.b)(a),s=new C.a;return s.ClientMetadataQuery=i,Promise.resolve(Object(W.a)(n(),s))}}}var Pe=n("odYE"),Te=n("zJrS");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function Ne(e,t){return{type:"SERIALIZE_INITIALIZE_FROM_REQUEST_ASYNC",execute({dispatch:n,getState:r},a){const i=e.get_entityMoniker(),o=new Te.a(Pe.a.legacyToExternalEntityReference(i),e.get_targetEntityName(),e.get_targetFieldType(),!0,e.get_skipParentalRelationshipMapping());return n(Object(Ee.e)(t,o)).then(()=>Object(W.a)(r(),o))}}}var Ae=n("zoUO"),Re=n("uIhY"),De=n("g22U");function xe(e){return{type:"SERIALIZE_RETRIEVE_PRINCIPAL_ACCESS_REQUEST",execute({dispatch:t,getState:n},r){const a=n(),i=e.get_principal(),o=i.LogicalName,s=i.Id,c=Object(de.o)(a,o);if(!c)return Promise.resolve({serializationFailure:"Cannot find entity set name for the principal entity "+o});const l=e.get_target(),u=l.LogicalName,d=l.Id,p=Object(de.o)(a,u);if(!p)return Promise.resolve({serializationFailure:"Cannot find entity set name for the target entity "+p});const f=JSON.stringify({"@odata.id":`${p}(${d})`}),g={urlParameters:`${c}(${s})/Microsoft.Dynamics.CRM.RetrievePrincipalAccess(Target=@tid)?@tid=${Object(Re.c)(f)}`,body:"",method:"GET",additionalHeaders:{Accept:$e},additionalParameters:{[De.a.TYPE]:De.d.FUNCTION,[De.a.SUB_TYPE]:De.c.RetrievePrincipalAccess,[De.a.SOURCE]:"SERIALIZE_RETRIEVE_PRINCIPAL_ACCESS_REQUEST"}};return Promise.resolve(g)}}}var Me=n("3ybi");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Fe(e,t){return{type:"SERIALIZE_RETRIEVE_PROCESS_CONTROL_DATA_REQUEST_ASYNC",execute({dispatch:n,getState:r},a){const i=e.get_processId(),o=e.get_processInstanceId(),s=new Me.a(Pe.a.legacyToExternalEntityReference(e.get_target()),i?Pe.a.legacyToExternalEntityReference(i):null,o?Pe.a.legacyToExternalEntityReference(o):null);return n(Object(Ee.e)(t,s)).then(()=>Object(W.a)(r(),s))}}}var ke=n("ATrR"),Le=n("Hevb"),Be=n("Wiik"),Ue=n("/oKV"),Ve=n("dj6u"),ze=n("Er26"),qe=n("1TGm"),He=n("HkYq"),We=n("nfLm"),Ge=n("z+5+");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Ke=D.a.createEvent(s.z,s.G),Qe=D.a.createEvent("Execute",s.G),Xe=D.a.createEvent("ParseMetadata",s.G),Ye="Storage:WebAPIService",Je=["RetrieveEntitiesForAggregateQuery"],$e="application/json";class Ze{constructor(e,t,n,r,a){this._store=null,this._applicationContext=null,this._tracer=null,this._eventManager=null,this._settings=null,this._clientHost=null,this._remoteCallRetryHandler=null,this._requestSerializers={Retrieve:ke.c,RetrievePrincipalAccess:xe,Update:Le.c,Create:Se.e,Delete:Oe.c,ExecuteMultiple:c.c,InitializeFrom:Ne,RetrieveProcessControlData:Fe,RetrieveMultiple:Ae.a,Disassociate:Ce.b,ExecuteQuickFind:we,GetClientMetadata:je},this._responseDeserializers={Retrieve:ne.f,RetrievePrincipalAccess:ee.a,Update:re.a,Create:K.a,Delete:Q.a,ExecuteMultiple:Y.a,InitializeFrom:Z.a,RetrieveProcessControlData:te.a,RetrieveMultiple:l.c,Disassociate:X.a,ExecuteQuickFind:J.a,GetClientMetadata:$.a},this._noSerializerFallback=null,this._credentials="same-origin",this._store=e,this._tracer=a,this._applicationContext=t,this._eventManager=t.EventManager,this._clientHost=n,this._remoteCallRetryHandler=r}get noSerializerFallback(){return this._noSerializerFallback}set noSerializerFallback(e){this._noSerializerFallback=e;const t=this._noSerializerFallback,n=this;Object.getOwnPropertyNames(t).concat(Object.getOwnPropertyNames(t.__proto__)).forEach(e=>{"function"==typeof t[e]&&(n[e]||(n[e]=function(){return t[e].apply(t,arguments)}.bind(this)))});const r=[];r.push({name:"WASvcContext",value:Ze.AUTO_IMPLEMENT_SOAP_FALLBACK}),this._tracer&&this._tracer.info("Auto-implemented fallbacks to SOAP.",r)}get_Settings(){return this._settings}set_Settings(e){this._settings=e}get_EventManager(){return this._applicationContext.EventManager}_getFetchHeaders(){const e=new Headers,t=this._store.getState();e.append("Content-Type",$e),e.append("OData-MaxVersion","4.0"),e.append("OData-Version","4.0"),e.append("ClientHost",Object(oe.c)(this._clientHost));const n=Object(d.k)(t);n&&e.append("x-ms-app-id",n);const r=Object(d.o)(t);r&&e.append("x-ms-app-name",r);const a=this._buildUserAgentHeader(t,r);return e.append("x-ms-user-agent",a),e}_buildUserAgentHeader(e,t){const n=Object(oe.c)(this._clientHost),r=this._clientHost===f.a.Browser?n:`${n} - ${Object(u.g)(e)} - ${Object(u.j)(e)}`;return`PowerApps-UCI/${window.VERSION_NUMERIC_VALUE} (${r}; AppName=${t})`}_addRequestCorrelationHeaders(e){const t={[w.HEADER.SESSION_ID]:this._eventManager.getCurrentSessionId(),[w.HEADER.CORRELATION_ID]:this._eventManager.getActivityId()};void 0!==e.additionalHeaders&&null!==e.additionalHeaders||(e.additionalHeaders={}),null==e.additionalHeaders||e.additionalHeaders.hasOwnProperty(w.HEADER.CLIENT_REQUEST_ID)||(e.additionalHeaders[w.HEADER.CLIENT_REQUEST_ID]=I.a.newGuid().guid),Object.assign(e.additionalHeaders,t)}Execute(e,t,n={}){this._logAttemptToUseOData("Execute");const r=e.get_name(),a={};a[s.w]=r;const i=Qe.startStopwatch(a);if(-1!==Je.indexOf(r)){const n=!(t&&t.IsPreloadCall())&&z.a.trackWork("SOAP"),r=this.noSerializerFallback.Execute(e,t);return r.always(()=>{n&&n(),i()}),r}if(this._requestSerializers.hasOwnProperty(r)&&this._responseDeserializers.hasOwnProperty(r)){const a=new _.a,o=this._requestSerializers[r](e);return this._store.dispatch(o).then(i=>{if(!i.serializationFailure)return Ze.AddRequestId(i,t&&t.RequestId?t.RequestId():I.a.newGuid().guid),function(e,t){e.additionalParameters||(e.additionalParameters={});e.additionalParameters[De.a.SOURCE]&&e.additionalParameters[De.a.SOURCE]!==De.b.Default||(e.additionalParameters[De.a.SOURCE]=Object(De.g)(t))}(i,n),this.sendRequest(i).then(t=>{const n=this._responseDeserializers[r](t,e);return this._store.dispatch(n)}).then(e=>{a.resolve(e)}).catch(e=>{a.reject(e)});this._logRequestSerializationFailed(i,r,i.serializationFailure),a.reject(new m.a(null,"error",i.serializationFailure))}),a.always(()=>i()),a}this._logRequestSerializationFailed(null,r,"No serializer exists for this type of request");const o=this.noSerializerFallback.Execute(e,t);return o.always(()=>i()),o}ExecuteOData(e,t,n={}){const r=new _.a,a=e,i=Object(G.a)(this._store.getState(),a,n);return Ze.AddRequestId(i,t&&t.RequestId?t.RequestId():I.a.newGuid().guid),this.sendRequest(i).then(e=>{r.resolve(e)},e=>{r.reject(e)}),r}RetrieveMultipleAttributeMetadata(e,t){const n={[e.get_EntityLogicalName()]:e.get_AttributeNames()},r=new _.a;return this._store.dispatch(Object(i.e)(n)).then(()=>{const t=this._applicationContext.DataSource.get_MetadataCache().getMultipleAttributeMetadata(e.get_EntityLogicalName(),e.get_AttributeNames()),n=new M.a(null);n.set_AttributeMetadata(t),r.resolve(n)},e=>{r.reject(e)}),r}async _fetch(e,t,n){n&&n.AppendCallStack("WebAPIService._fetch"),Object(x.a)(this._store.getState(),e);const r=Object(Ve.c)(this._store.getState()),a=Object(Ve.b)(this._store.getState());e.additionalHeaders["x-ms-sw-objectid"]=null!=r?r:"",e.additionalHeaders["x-ms-sw-tenantid"]=null!=a?a:"";const i=e.additionalHeaders,o=this._getFetchHeaders();if(i)for(const e in i)Object(pe.a)(o,e)&&o.delete(e),o.append(e,i[e]);const s=e.endpoint||Ze.WEB_API_URL_FRAGMENT,c=Object(ue.a)(this._store.getState(),s);Object(j.a)(e.urlParameters)||(e.urlParameters=e.urlParameters.replace(/\t|\r|\n/g,""));const l=new Request(`${c}${e.urlParameters}`,{method:e.method,credentials:this._credentials,headers:o,body:e.body});let u=null;u||(n&&n.AppendCallStack("WebAPIService.fetch"),u=fetch(l),!t&&z.a.trackPendingPromise(u.then(e=>e.clone().arrayBuffer()),"WebAPI"));try{const t=await u;return this.handleODataResponse(t,e,n)}catch(t){const n=[];let r=Ze.FETCH_FAIL_DEFAULT_MESSAGE;const a=e&&e.additionalHeaders?e.additionalHeaders[w.HEADER.CLIENT_REQUEST_ID]:"Unknown";n.push({name:Ze.CLIENT_REQUEST_ID,value:a}),n.push({name:Ze.FETCH_ERROR_COMPLETE_TEXT,value:t.toString()}),n.push({name:Ze.FETCH_ERROR_NAME,value:t.name?t.name:Ze.UNKNOWN}),n.push({name:Ze.FETCH_ERROR_STACK,value:t.stack?t.stack:Ze.UNKNOWN}),t.message&&(r=t.message,n.push({name:Ze.FETCH_ERROR_MESSAGE,value:t.message?t.message:Ze.UNKNOWN}));const i=t instanceof m.a;n.push({name:Ze.IS_INSTANCE_OF_CRM_ERROR_RESPONSE,value:i});const o=Ze.trimUrl(l.url);if(n.push({name:Ze.REQUEST_URL,value:o}),this._tracer.error(r,n),i)throw t;return this._createOfflineErrorResponse(null==t?void 0:t.message,o,a)}}_createOfflineErrorResponse(e,t,n){const r=e?e+" url :"+t:"Fetch failed",a=new m.a(null,r,r);return a.set_isErrorInOffline(!0),a.set_clientRequestId(n),Promise.reject(a)}_retryAsBatch(e,t,n){n&&n.AppendCallStack("WebAPIService.__retryAsBatch");const r=[];return Ze.addCommonParametersToEventParameters(e,r),this._tracer.warn(Ze.LONG_URL_RETRY,r),this._executeSendRequest(t,r,!1,n,!0)}handleODataResponse(e,t,n){return n&&n.AppendCallStack("WebAPIService.handleODataResponse"),e.ok?(this._remoteCallRetryHandler.resetFailures(),e):401===e.status?this._remoteCallRetryHandler.handleAuthError(t).nativePromise().then(()=>this.sendRequest(t,void 0,n),t=>{if(this._tracer){const t=[],n=Ze.ODATA_ERROR_DETAILS_MESSAGE;Ze.addCommonParametersToEventParameters(e,t),this._tracer.error(n,t)}throw t}):414===e.status?this._retryAsBatch(e,t,n):e.url&&-1!==e.url.indexOf("$batch")||t&&t.urlParameters&&-1!==t.urlParameters.indexOf("$batch")?Object(ye.b)(e,n).then(n=>{if(null!=n&&n.length>0){const r=n.find(e=>!e.ok)||e;return Ze.throwCrmErrorFromResponse(r,t,this._tracer)}if(this._tracer){const t=[],n=e.url?Ze.trimUrl(e.url):null,r=e.headers?Object(pe.a)(e.headers,w.HEADER.SERVER_REQUEST_ID):Ze.UNKNOWN;t.push({name:Ze.HTTP_STATUS_CODE,value:e.status}),t.push({name:Ze.HTTP_RESPONSE_TYPE,value:e.type}),t.push({name:Ze.HTTP_RESPONSE_STATUSTEXT,value:e.statusText}),t.push({name:Ze.RESPONSE_URL,value:n}),t.push({name:Ze.SERVER_REQUEST_ID,value:r}),this._tracer.error(Ze.BATCH_REQUEST_PARSING_FAIL,t)}let r=null;throw r=new m.a(e,e.statusText,"Batch request failed with http Status : "+e.status),r}):Ze.throwCrmErrorFromResponse(e,t,this._tracer).catch(r=>{if(r.get_isRequestTooLong())return this._retryAsBatch(e,t,n);throw r})}static addCommonParametersToEventParameters(e,t){const n=e.headers?Object(pe.a)(e.headers,w.HEADER.SERVER_REQUEST_ID):Ze.UNKNOWN,r=e.status?e.status:null,a=e.type?e.type:null,i=e.statusText?e.statusText:null,o=e.url?Ze.trimUrl(e.url):null;t.push({name:Ze.HTTP_STATUS_CODE,value:r}),t.push({name:Ze.HTTP_RESPONSE_TYPE,value:a}),t.push({name:Ze.HTTP_RESPONSE_STATUSTEXT,value:i}),t.push({name:Ze.RESPONSE_URL,value:o}),t.push({name:Ze.SERVER_REQUEST_ID,value:n})}static canLogDetailsOfRequest(e){return!Object(j.a)(e)&&(-1!==e.indexOf("GetClientMetadata")||-1!==e.indexOf("EntityDefinitions")||-1!==e.indexOf("SyncClientMetadata"))}static isSearchRequest(e){return!Object(j.a)(e)&&"/api/search/indexes/default/Entities?api-version=9.0"===e}static trimUrl(e){if(Object(j.a)(e))return e;if(Ze.canLogDetailsOfRequest(e))return e;if(-1!==e.indexOf(Ze.FETCH_XML_PREFIX)){const t=e.indexOf(Ze.FETCH_XML_PREFIX),n=decodeURIComponent(e.substring(e.indexOf(Ze.FETCH_XML_PREFIX)+Ze.FETCH_XML_PREFIX.length,e.length));return e.substring(0,t+Ze.FETCH_XML_PREFIX.length)+Object(_e.j)(n)}const t=e.indexOf("?");if(-1===t){const t=e.indexOf("=");return-1===t?e:e.substring(0,t)}return e.substring(0,t)}static throwCrmErrorFromResponse(e,t,n){return e.text().then(r=>{let a=null;const i=r&&r.toLowerCase().indexOf("<!doctype html")>-1;a=i?m.a.createFromHtml(r,e):new m.a(e,e.statusText,r);const o=e.headers?Object(pe.a)(e.headers,"Retry-After"):null;a.set_retryAfter(o);const s=e.headers&&Object(pe.a)(e.headers,"Date")?new Date(Object(pe.a)(e.headers,"Date")):null;a.set_date(s);const c=a.get_organizationServiceFault().get_errorCode();if(n){const t=[],o=Ze.ODATA_ERROR_DETAILS_MESSAGE;Ze.addCommonParametersToEventParameters(e,t),Ze.canLogDetailsOfRequest(e.url)&&(t.push({name:Ze.ODATA_ERROR_RESPONSE_COMPLETE_TEXT,value:r}),t.push({name:Ze.CRM_ERROR_RESPONSE_COMPLETE_TEXT_FROM_ODATA_RESPONSE,value:JSON.stringify(a)})),t.push({name:Ze.ODATA_ERROR_RESPONSE_IS_HTML_TYPE,value:i}),isNaN(c)?t.push({name:Ze.ODATA_ERROR_CODE_TYPE,value:"Error code in server response JSON is a non-numeric string."}):0===c&&t.push({name:Ze.ODATA_ERROR_CODE_TYPE,value:"Error code is 0 meaning either no error code returned from server or no standard error code key in response JSON."}),n.error(o,t)}const l=e.headers?Object(pe.a)(e.headers,"Content-ID"):null;if(l){const e=Number.parseInt(l,10);e>-1&&a.set_contentId(e)}const u=e.headers?Object(pe.a)(e.headers,w.HEADER.SERVER_REQUEST_ID):Ze.UNKNOWN,d=t&&t.additionalHeaders&&t.additionalHeaders.hasOwnProperty(w.HEADER.CLIENT_REQUEST_ID)?t.additionalHeaders[w.HEADER.CLIENT_REQUEST_ID]:Ze.UNKNOWN;throw a.set_serverResponseId(u),a.set_clientRequestId(d),a})}_logRequestSerializationFailed(e,t,n){let r=null,a=null;const i=[];e&&(r="EndPoint : "+e.endpoint+", Method: "+e.method+", UrlParameters: "+Ze.trimUrl(e.urlParameters),a=Object(De.f)(e)),i.push({name:"RequestName",value:t}),i.push({name:"RequestDetails",value:r}),i.push({name:"ErrorMessage",value:n}),i.push({name:"Tags",value:Ze.WEB_API_SOAP_FALL_BACK+","+Ze.WEB_API_REQUEST_SERIALIZATION_FAILED}),a&&(i.push({name:ze.f.OPERATION_TYPE,value:a.type}),i.push({name:ze.f.OPERATION_SUB_TYPE,value:a.subType}),i.push({name:ze.f.OPERATION_SOURCE,value:a.source})),this._tracer&&this._tracer.warn("Request serialization failed, Falling back to SOAP.",i)}_executeSendRequest(e,t,n,r,a=!1){if(r&&r.AppendCallStack("WebAPIService._executeSendRequest"),!e)return Promise.reject(new Error("Specified serialized request is empty"));if(e.serializationFailure)return Promise.reject(new Error("Cannot send the request because of the serializatoin failure: "+e.serializationFailure));this._addRequestCorrelationHeaders(e),rt(e);const i="$batch"===e.urlParameters?e.body:e.urlParameters,o={};o[s.F]=i;const l=Ke.startStopwatch(o),u=performance.now();let d=a;const p=new Promise((t,i)=>{if(!this._simulateNetworkFailureIfConfigured(e,t)){const o=Object(Re.c)(e.urlParameters);if(a&&"$batch"!==e.urlParameters||"GET"===e.method&&o.length>Ze.VERY_LONG_URL){d=!0;const a=Object(c.a)(this._store.getState(),[e]);this._addRequestCorrelationHeaders(a);const o=Object(q.addNetworkRequestListener)(e=>{e.body=a.body}),s=this._fetch(a,n,r);o(),s.then(ye.b).then(n=>{t(this.handleODataResponse(n[0],e,r))}).catch(e=>i(e))}else{let a;e.body&&"$batch"===e.urlParameters&&(a=Object(q.addNetworkRequestListener)(t=>{t.body=e.body})),t(this._fetch(e,n,r)),a&&a()}}});return p.then(n=>{var r;let a=null;const i=performance.now()-u;let o=null,s=null,c=null,d=null;n&&(s=n.url,n.headers&&(a=Object(pe.a)(n.headers,w.HEADER.SERVER_REQUEST_ID),o=Object(pe.a)(n.headers,"Content-Length"))),e&&(c="EndPoint : "+e.endpoint+", Method: "+e.method+", UrlParameters: "+Ze.trimUrl(e.urlParameters),d=Object(De.f)(e)),t&&t.push({name:Ze.CLIENT_REQUEST_ID,value:e.additionalHeaders[w.HEADER.CLIENT_REQUEST_ID]});const p=[];p.push({name:Ze.SERVER_REQUEST_ID,value:a}),p.push({name:Ze.CLIENT_REQUEST_ID,value:e.additionalHeaders[w.HEADER.CLIENT_REQUEST_ID]}),p.push({name:Ze.RESPONSE_TIME,value:i}),p.push({name:Ze.RESPONSE_SIZE_IN_BYTES,value:o}),p.push({name:Ze.REQUEST_CONTEXT,value:Ze.trimUrl(s)}),c&&p.push({name:Ze.REQUEST_DETAILS,value:c}),this._remoteCallRetryHandler.isConnectivityRetryEnabled()&&p.push({name:Ze.CONNECTIVITY_RETRY_COUNT,value:null!==(r=e.connectivityRetryCount)&&void 0!==r?r:0}),d&&(p.push({name:ze.f.OPERATION_TYPE,value:d.type}),p.push({name:ze.f.OPERATION_SUB_TYPE,value:d.subType}),p.push({name:ze.f.OPERATION_SOURCE,value:d.source})),this._eventManager.ReportComponentSuccess(Ye,p);l(a?{requestId:a}:void 0)},n=>{var r;const a=[];let i=null,o=null;const s=n&&n.get_request?n.get_request():null,c=s?s.status:null;let p=null,f=null,g=n&&n.get_message?n.get_message():null;const h=s&&s.headers?Object(pe.a)(s.headers,w.HEADER.SERVER_REQUEST_ID):null,m=performance.now()-u,b=s?Ze.trimUrl(s.url):null,y=!(!n||!n.get_isErrorInOffline)&&n.get_isErrorInOffline();if(n.get_organizationServiceFault&&n.get_organizationServiceFault()){f=n.get_organizationServiceFault().get_errorCode();try{null==g&&(g=n.get_error())}catch(e){a.push({name:Ze.CRM_ERROR_RESPONSE_GET_ERROR,value:Ze.FAILED})}try{const e=JSON.parse(n.get_error());p=e.error&&e.error.innererror?e.error.innererror.stacktrace:null}catch(e){a.push({name:Ze.CRM_ERROR_RESPONSE_GET_ERROR_PARSING,value:Ze.FAILED})}}const _=this._getClientRequestId(e);t&&t.push({name:Ze.CLIENT_REQUEST_ID,value:_});let v=g||Ze.REQUEST_FAILURE;const O=s?s.type:null;a.push({name:Ze.HTTP_RESPONSE_TYPE,value:O}),a.push({name:Ze.HTTP_STATUS_CODE,value:c}),a.push({name:Ze.CRM_ERROR_CODE,value:f}),a.push({name:Ze.IS_ERROR_IN_OFFLINE,value:y}),a.push({name:Ze.REQUEST_CONTEXT,value:b}),a.push({name:Ze.CRM_CALL_STACK,value:p}),a.push({name:Ze.SERVER_REQUEST_ID,value:h}),a.push({name:Ze.CLIENT_REQUEST_ID,value:_}),a.push({name:Ze.RESPONSE_TIME,value:m}),a.push({name:Ze.IS_BATCH_REQUEST,value:d}),e&&(i="EndPoint : "+e.endpoint+", Method: "+e.method+", UrlParameters: "+Ze.trimUrl(e.urlParameters),Ze.isSearchRequest(e.endpoint)&&(v=Ze.UCIMONITOR_ERROR_MESSAGE),o=Object(De.f)(e)),a.push({name:Ze.CRM_ERROR_MESSAGE,value:v}),i&&a.push({name:Ze.REQUEST_DETAILS,value:i}),o&&(a.push({name:ze.f.OPERATION_TYPE,value:o.type}),a.push({name:ze.f.OPERATION_SUB_TYPE,value:o.subType}),a.push({name:ze.f.OPERATION_SOURCE,value:o.source}));const C=Object(ie.a)(this._store.getState());if(C&&a.push({name:Ze.TOKEN_LENGTH,value:C.length}),this._remoteCallRetryHandler.isConnectivityRetryEnabled()){const t=this._remoteCallRetryHandler.shouldRetryConnectivityError(e,n);a.push({name:Ze.WILL_RETRY_FOR_CONNECTIVITY,value:t}),a.push({name:Ze.CONNECTIVITY_RETRY_COUNT,value:null!==(r=e.connectivityRetryCount)&&void 0!==r?r:0})}if([400,404,500,503].indexOf(c)>-1&&Object(me.b)(Ye,f)&&Object(me.c)(o,f,e,this._store.getState())){const e=new S.a(v,f,null,null,null,null,null,a,null,null,null,null,null,null,c,_,h);this._eventManager.ReportComponentFailure(Ye,e,void 0,a)}else this._tracer&&this._tracer.error(v,a);l()}),p}_simulateNetworkFailureIfConfigured(e,t){let n=!1;const r=Object(ce.c)(this._store.getState(),"failurePercent");if(r){const a=Number.parseFloat(r);if(!Number.isNaN(a)&&a>0&&a<=100){if(Math.floor(100*Math.random()+1)<=a){n=!0;const r=Object(ce.c)(this._store.getState(),"failureTimeout");let a=r&&Number.parseFloat(r);a&&!Number.isNaN(a)||(a=2e4),setTimeout(()=>{t(this._createOfflineErrorResponse("Simulated network failure",e.urlParameters,this._getClientRequestId(e)))},a)}}}return n}_getClientRequestId(e){var t;return(null===(t=null==e?void 0:e.additionalHeaders)||void 0===t?void 0:t[w.HEADER.CLIENT_REQUEST_ID])||Ze.UNKNOWN}sendRequest(e,t,n,r=!1){n&&n.AppendCallStack("WebAPIService.sendRequest");const a=y.a.get_DefaultInstance();return new Promise((i,o)=>{if(a&&a.get_IsWaitingForNetwork()){const s=[];s.push({name:Ze.REQUEST_METHOD,value:e.method}),s.push({name:Ze.REQUEST_URL,value:e.urlParameters}),e.additionalHeaders&&e.additionalHeaders.hasOwnProperty(w.HEADER.CLIENT_REQUEST_ID)&&s.push({name:Ze.CLIENT_REQUEST_ID,value:e.additionalHeaders[w.HEADER.CLIENT_REQUEST_ID]}),this._tracer.warn(Ze.WAITING_FOR_NETWORK_MESSAGE,s);a.get_WaitingForNetworkPromise().always(c=>a.get_IsNetworkAvailable()?(s.push({name:Ze.WAITING_FOR_NETWORK_RESULT,value:Ze.SUCCESS}),this._executeSendRequest(e,t,r,n).then(e=>(this._tracer.warn(Ze.WAITING_FOR_NETWORK_SUCCEEDED_SERVER_REQUEST_SUCCEEDED_MESSAGE,s),i(e))).catch(e=>(this._tracer.error(Ze.WAITING_FOR_NETWORK_SUCCEEDED_SERVER_REQUEST_FAILED_MESSAGE,s),o(e)))):(s.push({name:Ze.WAITING_FOR_NETWORK_RESULT,value:Ze.FAILED}),this._tracer.error(Ze.WAITING_FOR_NETWORK_FAILED_MESSAGE,s),o(S.a.fromErrorCode(this._store.getState(),-2147093999))))}else this._executeSendRequest(e,t,r,n).then(e=>i(e)).catch(e=>o(e))}).catch(a=>{var i;if(this._remoteCallRetryHandler.shouldRetryConnectivityError(e,a)){e.connectivityRetryCount=(null!==(i=e.connectivityRetryCount)&&void 0!==i?i:0)+1;const a=[];return a.push({name:Ze.CLIENT_REQUEST_ID,value:this._getClientRequestId(e)}),this._tracer.warn(Ze.RETRYING_ON_CONNECTIVITY_ERROR,a),this.sendRequest(e,t,n,r)}throw a})}async RetrieveExtendedUserContext(){const e=new k.a(I.a.newGuid().guid),t=new g.a(null,"ExtendedUserContext",null,null,null,!1,T.a.UserContext,null,[],null);try{const n=await Object(ae.b)(),r=await this._store.dispatch(n.getClientMetadata(t,e,void 0,Ue.a.Remote)),a=[];if(a.push({name:Ze.OTHER_DETAILS,value:"ExtendedUserContext call succeeded in via MDL Remote "}),this._eventManager.ReportComponentSuccess(ze.k.ModernDataSourceExtendedUserContext,a),Object(j.a)(r)||Object(j.a)(r.UserContext)||Object(j.a)(r.UserContext[0])){const e="ExtendedUserContext was not returned from GetClientMetadata call";throw a.push({name:"ErrorMessage",value:e}),this._tracer.error(e,a),new m.a(null,"error","ExtendedUserContext was not returned from GetClientMetadata call")}if(Object.keys(r).length>1){const e=Object(ve.a)(r,null,null,this._store.getState(),null,null,this._tracer,null);e.webResourcesContent=null,this._store.dispatch(Object(se.c)(e))}return new U.a(!0,null,-1,r.UserContext[0])}catch(e){const t=[];t.push({name:Ze.CRM_ERROR_CODE,value:e._errorCode}),t.push({name:Ze.CRM_ERROR_MESSAGE,value:e.message}),t.push({name:Ze.CRM_CALL_STACK,value:e.stack}),t.push({name:Ze.OTHER_DETAILS,value:"ExtendedUserContext call failed in via MDL Remote."}),this._eventManager.ReportComponentFailure(ze.k.ModernDataSourceExtendedUserContext,new Error("ExtendedUserContext call failed in via MDL Remote, retry in legacy path again "),"",t)}}RetrieveUserContext(e,t){const n=new _.a,r=Object(d.k)(this._store.getState()),a=e=>{if(Object(j.a)(e)||Object(j.a)(e.UserContext)||Object(j.a)(e.UserContext[0])){const e=[];e.push({name:"ErrorMessage",value:"UserContext was not returned from GetClientMetadata call"});const t=Ze.PRELOAD_USERCONTEXT_CALL_DETAILS;this._tracer.error(t,e),n.reject(new m.a(null,"error","UserContext was not returned from GetClientMetadata call"))}else{if(Object.keys(e).length>1){const t=Object(ve.a)(e,null,null,this._store.getState(),null,null,this._tracer,r);t.webResourcesContent=null,this._store.dispatch(Object(se.c)(t))}n.resolve(new U.a(!0,null,-1,e.UserContext[0]))}},i=e=>{const t=new g.a(null,null,null,null,[],!1,T.a.UserContext,null,[],I.a.toLegacyGuid(I.a.tryParseOrNull(r))),o=new k.a(I.a.newGuid().guid);e?Object(ae.b)().then(async e=>{try{const n=await this._store.dispatch(e.getClientMetadata(t,o,void 0,Ue.a.Remote)),r=[];r.push({name:Ze.OTHER_DETAILS,value:"UserContext call succeeded in via MDL Remote "}),this._eventManager.ReportComponentSuccess(ze.k.ModernDataSourceUserContext,r),a(n)}catch(e){const t=[];t.push({name:Ze.CRM_ERROR_CODE,value:e._errorCode}),t.push({name:Ze.CRM_ERROR_MESSAGE,value:e.message}),t.push({name:Ze.CRM_CALL_STACK,value:e.stack}),t.push({name:Ze.OTHER_DETAILS,value:"UserContext call failed in via MDL Remote, retry in legacy path again "}),this._eventManager.ReportComponentFailure(ze.k.ModernDataSourceUserContext,new Error("UserContext call failed in via MDL Remote, retry in legacy path again "),"",t),i(!1)}}):this.GetClientMetadata(t,o).then(a,e=>{const t=[];t.push({name:Ze.CLIENT_REQUEST_ID,value:e.get_clientRequestId()}),t.push({name:Ze.OTHER_DETAILS,value:e.get_message()}),t.push({name:Ze.CRM_CALL_STACK,value:o.get_Stack()});const r=Ze.PRELOAD_USERCONTEXT_CALL_DETAILS;this._tracer.error(r,t),n.reject(e)}).catch(e=>{const t=[];t.push({name:Ze.CLIENT_REQUEST_ID,value:e.get_clientRequestId()}),t.push({name:Ze.OTHER_DETAILS,value:e.get_message()}),t.push({name:Ze.CRM_CALL_STACK,value:o.get_Stack()});const r=Ze.PRELOAD_USERCONTEXT_CALL_DETAILS;this._tracer.error(r,t),n.reject(e)})},o=window.__uciServerPreload;return!Object(he.g)(this._store.getState(),"MobileClientOneDbPerProfile")&&o&&o.userContext?o.userContext.then(e=>{o.userContext=null;const t=[],r=Ze.PRELOAD_USERCONTEXT_CALL_DETAILS;Ze.addCommonParametersToEventParameters(e,t),t.push({name:Ze.CLIENT_ACTIVITY_ID,value:window.__preload.initialActivityId}),e.ok?nt(e,this._tracer).then(e=>{e.Metadata?(t.push({name:Ze.OTHER_DETAILS,value:"Preload userContext call was successful."}),Object(Ge.a)(t,De.d.GCM),t.push({name:ze.f.OPERATION_SUB_TYPE,value:De.c.PreloadGCM}),t.push({name:ze.f.OPERATION_SOURCE,value:De.b.Preload}),t.push({name:ze.f.METADATA_TYPE,value:He.a.userContext}),t.push({name:ze.f.METADATA_SUB_TYPE,value:We.a.none}),t.push({name:ze.f.DEPENDENCY_DEPTH,value:De.c.UserContext}),this._eventManager.ReportComponentSuccess(ze.k.ModernDataSource,t),a(JSON.parse(e.Metadata))):(t.push({name:Ze.OTHER_DETAILS,value:"Preload userContext call was successful but response does not have any metadata.Request in the usual flow again."}),this._tracer&&this._tracer.error(r,t),i(y.a.useMDLForUserContextDuringBoot))}).catch(e=>{this._tracer&&this._tracer.error(e.message),n.reject(e)}):(t.push({name:Ze.OTHER_DETAILS,value:"Preload userContext call wasn't successful. Request in the usual flow again"}),this._tracer&&this._tracer.error(r,t),i(y.a.useMDLForUserContextDuringBoot))}):i(y.a.useMDLForUserContextDuringBoot),n}Create(e,t,n){const r=new _.a,a=e.get_fieldTypes(),o=e.get_fieldNames().filter(e=>a[e]===p.a.Lookup||a[e]===p.a.Customer||a[e]===p.a.Owner).map(t=>e.getValue(t).LogicalName).reduce((e,t)=>(e[t]=null,e),{}),s=e.get_identifier().LogicalName;return o.hasOwnProperty(s)||(o[s]=[]),this._store.dispatch(Object(i.e)(o)).then(()=>{const a=new h.a(e,t);return this.Execute(a,n).then(e=>r.resolve(e),e=>r.reject(e))}),r}Update(e,t,n){const r=new _.a;return this._store.dispatch(Object(i.f)(e.get_identifier().LogicalName,!1,[])).then(()=>{const a=new B.a(e,t);return this.Execute(a,n).then(e=>r.resolve(e),e=>r.reject(e))}),r}DeleteEntity(e,t){const n=new _.a;return this._store.dispatch(Object(i.f)(e.LogicalName,!1,[])).then(()=>{const r=new v.a(e);return this.Execute(r,t).then(e=>n.resolve(e),e=>n.reject(e))}),n}WhoAmI(){const e=new _.a,t={urlParameters:"WhoAmI",additionalHeaders:{Accept:$e},method:"GET",additionalParameters:{[De.a.TYPE]:De.d.FUNCTION,[De.a.SUB_TYPE]:De.c.WhoAmI}};return this.sendRequest(t).then(e=>nt(e,this._tracer)).then(t=>{e.resolve(new N.a("WhoAmI"))}).catch(t=>{e.reject(t)}),e}getQueryMetadataAndData(e,t=!1){const n=e.get_EntityLogicalName(),r=et(e),a=e.get_SourceId();return this._store.dispatch(Object(i.f)(n,r.getAllColumns,r.columnNames)).then(()=>{const r=this._store.getState(),i={urlParameters:`${Object(de.o)(r,n)}?fetchXml=${encodeURIComponent(e.get_FetchXml())}`,additionalHeaders:{Prefer:'odata.include-annotations="*"',Accept:$e,"x-ms-source-id":a},method:"GET",additionalParameters:{[De.a.TYPE]:De.d.RETRIEVE_MULTIPLE,[De.a.SUB_TYPE]:e&&e.get_queryContext()?e.get_queryContext():De.c.RetrieveMultipleOther}};return this.sendRequest(i,void 0,void 0,t).then(nt)})}RetrieveMultiple(e,t){const n=new _.a,r=Object(l.e)(this._store.getState(),e),a=Object(i.e)(r.entity2AttributesMap),o=this._store.dispatch(a),s=t&&t.IsPreloadCall();return Promise.all([o,this.getQueryMetadataAndData(e,s)]).then(t=>{const a=t.pop();if(a.error)n.reject(a.error);else{const t=this._store.getState(),i=Object(l.a)(t,e,r,a,null,null,this._tracer);n.resolve(new b.a(i))}},e=>{n.reject(e)}),n}_constructBodyParamsByRequest(e){const t=e;return Object.keys(e.getMetadata().parameterTypes).reduce((e,n)=>(e[n]=t[n],e),{})}_prepareSerializedPostFromRequest(e){const t=this._constructBodyParamsByRequest(e);return{urlParameters:e.getMetadata().operationName,additionalHeaders:{Accept:$e,Prefer:'odata.include-annotations="*"'},method:"POST",body:JSON.stringify(t),additionalParameters:{[De.a.TYPE]:De.d.ACTION,[De.a.SUB_TYPE]:e.getMetadata().operationName}}}GetRecentItems(e,t,n,r,a,i){const o=new _.a,s=new E.a;s.entityNames=t,s.preferredPinnedItems=n,s.preferredPinnedItemsPerEntity=a,s.preferredUnpinnedItems=r,s.preferredUnpinnedItemsPerEntity=i,s.appId=e.toString();const c=this._prepareSerializedPostFromRequest(s);return this.sendRequest(c).then(e=>nt(e,this._tracer)).then(e=>{o.resolve(e.recentItems)}).catch(e=>o.reject(e)),o}UpdateRecentItems(e){const t=new _.a,n=new L.a;n.items=e;const r=this._prepareSerializedPostFromRequest(n);return this.sendRequest(r).then(e=>{t.resolve(e.status)},e=>{t.reject(e)}),t}GetClientMetadata(e,t){t&&t.AppendCallStack("WebAPIService.GetClientMetadata");const n=new _.a;try{const r=Object(o.b)(e),i=this._store.getState();null===I.a.tryParseOrNull(Object(d.k)(i))&&"appmodules"===e.MetadataType&&(r.AppId=I.a.fromLegacyGuid(e.MetadataId));const s=Object(he.f)(i,a.Pd),c=s?new O.a:new C.a;c.ClientMetadataQuery=r;const l=Object(W.a)(this._store.getState(),c);if(Ze.AddRequestId(l,t&&t.RequestId?t.RequestId():I.a.newGuid().guid),l.urlParameters&&Object(qe.a)(e.MetadataType,e.DependencyDepth)){const e=Object(ge.a)(i),t=Object(fe.b)(i),n=e.currentVersion?e.currentVersion:-1,r=t.currentVersion?t.currentVersion:-1;l.urlParameters=l.urlParameters+`&umv=${n.toString()}&mv=${r.toString()}`}l.urlParameters=l.urlParameters+Ze.API_FRAGMENT_9_1,Object(le.a)(i)&&(l.additionalHeaders.Consistency="Strong",this._store.dispatch(Object(Be.b)(!1))),this.sendRequest(l,null,t,e.IsPreloadCall).then(e=>nt(e,this._tracer)).then(e=>{if(e.Metadata){const r=Xe.startStopwatch();t&&t.AppendCallStack("WebAPIService.JSON.parse"),n.resolve(this._parseResponse(e.Metadata,s)),r()}else e instanceof m.a?n.reject(e):n.resolve({})}).catch(e=>{const r=e&&e.message?e.message:"Error happens during GCM call",a=[];a.push({name:Ze.CLIENT_REQUEST_ID,value:l.additionalHeaders[w.HEADER.CLIENT_REQUEST_ID]}),a.push({name:Ze.CRM_CALL_STACK,value:t.get_Stack()}),this._tracer.error(r,a),n.reject(e)})}catch(e){e instanceof S.a||e instanceof m.a||(this._tracer.error(e.message),e=new m.a(null,"Error",e.message)),n.reject(e)}return n}static AddRequestId(e,t){null!=e&&null!=t&&(null==e.additionalHeaders||e.additionalHeaders.hasOwnProperty(w.HEADER.CLIENT_REQUEST_ID)||(e.additionalHeaders[w.HEADER.CLIENT_REQUEST_ID]=t))}SyncClientMetadata(e){const t=new _.a,n=new F;n.ClientMetadataQueries=e.map(o.b);const r=Object(H.a)(this._store.getState(),n),a=(new Date).getTime();return this.sendRequest(r).then(e=>(this._store.dispatch(Object(be.i)({syncStatus:A.a.InProgress,downloadTime:(new Date).getTime()-a})),nt(e,this._tracer))).then(e=>{if(e.Metadata){const n=(new Date).getTime(),r=JSON.parse(e.Metadata);this._store.dispatch(Object(be.i)({syncStatus:A.a.InProgress,downloadSize:e.Metadata.length,parseTime:(new Date).getTime()-n})),t.resolve(r)}else t.resolve({})}).catch(e=>{t.reject(e)}),t}ExecuteExternalSearch(e,t,n){const r=Object(d.k)(this._store.getState());null!=r&&(e+="&appid="+r);const a={endpoint:Ze.EXTERNAL_SEARCH_WEBAPI_URL_FRAGMENT,urlParameters:e,method:"GET",additionalParameters:{[De.a.TYPE]:De.d.FUNCTION,[De.a.SUB_TYPE]:De.c.ExternalSearch,[De.a.SOURCE]:s.G}};return this.sendRequest(a,n,t).then(e=>nt(e,this._tracer))}GetIsActivityFlags(){const e=new _.a,t={urlParameters:"EntityDefinitions?$select=IsActivity,IsVisibleInMobileClient,ObjectTypeCode,LogicalName,DisplayName,DisplayCollectionName,ActivityTypeMask&$filter=IsActivity eq true",additionalHeaders:{Accept:$e},method:"GET",additionalParameters:{[De.a.TYPE]:De.d.ENTITY_DEFINITION,[De.a.SUB_TYPE]:De.c.EntityDefinition,[De.a.SOURCE]:s.G}},n=()=>{this.sendRequest(t).then(t=>nt(t,this._tracer).then(t=>{e.resolve(t)})).catch(t=>{e.reject(t)})},r=window.__uciServerPreload;return r&&r.activityFlags?r.activityFlags.then(t=>{r.activityFlags=null;const a=[],i=Ze.PRELOAD_ACTIVITY_CALL_DETAILS;Ze.addCommonParametersToEventParameters(t,a),a.push({name:Ze.CLIENT_ACTIVITY_ID,value:window.__preload.initialActivityId}),t.ok?nt(t,this._tracer).then(t=>{t.value?(a.push({name:Ze.OTHER_DETAILS,value:"Preload IsActivity call was successful."}),Object(Ge.a)(a,De.d.GCM),a.push({name:ze.f.OPERATION_SUB_TYPE,value:De.c.PreloadGCM}),a.push({name:ze.f.METADATA_TYPE,value:He.a.isActivityFlags}),a.push({name:ze.f.OPERATION_SOURCE,value:De.b.Preload}),this._eventManager&&this._eventManager.ReportComponentSuccess(Ye,a),e.resolve(t)):(a.push({name:Ze.OTHER_DETAILS,value:"Preload isActitivty call was successful but response does not have any value. Request in the usual flow again."}),this._tracer&&this._tracer.error(i,a),n())}).catch(t=>{e.reject(t)}):(a.push({name:Ze.OTHER_DETAILS,value:"Preload IsActivity call wasn't successful. Request in the usual flow again."}),this._tracer&&this._tracer.error(i,a),n())}):n(),e}_logAttemptToUseOData(e){const t=[];t.push({name:"MethodName",value:e}),t.push({name:"Tags",value:Ze.WEB_API_ATTEMPT_TO_USE_ODATA}),this._tracer&&this._tracer.info("Method was called. Will attempt to use OData.",t)}get requestSerializers(){return this._requestSerializers}get responseDeserializers(){return this._responseDeserializers}_parseResponse(e,t,n){return n&&n.AppendCallStack("WebAPIService.parseResponse"),t?e&&e.OtherMetadata?this._parseGetClientMetadataExResponse(e,n):[]:this._parseGetClientMetadataResponse(e,n)}_parseGetClientMetadataResponse(e,t){return t&&t.AppendCallStack("WebAPIService.parseGetClientMetadataResponse"),JSON.parse(e)}_parseGetClientMetadataExResponse(e,t){t&&t.AppendCallStack("WebAPIService.parseGetClientMetadataExResponse");const{OtherMetadata:n}=e,a=Object(r.d)(e,["OtherMetadata"]),i=JSON.parse(e.OtherMetadata);if(Object.assign(a,i),a.Entities){const e=[];a.Entities.forEach(t=>{const n=Object.assign(Object.assign({},t.EntityMetadata),t.AttributeNames);e.push(n)}),a.Entities=e}if(a.RelationshipNavigationEntities){const e=[];a.RelationshipNavigationEntities.forEach(t=>{const n=Object.assign(Object.assign({},t.EntityMetadata),t.AttributeNames);e.push(n)}),a.RelationshipNavigationEntities=e}return a}}function et(e){return tt(e.get_ColumnSet())}function tt(e){const t=!(e instanceof P.a);let n;return t||(n=e.get_Columns()),{getAllColumns:t,columnNames:n}}function nt(e,t,n){return n&&n.AppendCallStack("WebAPIService.parseJsonResponse"),Promise.resolve().then(()=>{if(!e)throw new S.a("Null response from server");{const r=Object(pe.a)(e.headers,"Content-Type");if(t&&t.info("parsing reponse with content type: "+r),r&&r.indexOf("text/html")>-1)return n&&n.AppendCallStack("WebAPIService.response.text"),e.text().then(n=>{throw function(e,t){if(!t)return;const n=[];n.push({name:"HTMLResponse",value:e}),t.info("HTML response from server",n)}(n,t),m.a.createFromHtml(n,e)});try{n&&n.AppendCallStack("WebAPIService.response.json");const t=e.json();return n&&n.AppendCallStack("WebAPIService.response.json.Complete"),t}catch(t){throw n&&n.AppendCallStack("WebAPIService.response.unknown"),m.a.createFromUnknown(e)}}})}function rt(e){var t;(null===(t=e.urlParameters)||void 0===t?void 0:t.includes("$batch"))||(void 0!==e.additionalHeaders&&null!==e.additionalHeaders||(e.additionalHeaders={}),e.additionalHeaders.hasOwnProperty(w.HEADER.PREFER)?e.additionalHeaders[w.HEADER.PREFER].indexOf("odata.include-annotations=")<0?e.additionalHeaders[w.HEADER.PREFER]=`${e.additionalHeaders[w.HEADER.PREFER]},${w.HEADER_VALUES.ANNOTATIONS}`:e.additionalHeaders[w.HEADER.PREFER]=e.additionalHeaders[w.HEADER.PREFER].replace(/odata\.include-annotations="[^"]+"/,w.HEADER_VALUES.ANNOTATIONS):e.additionalHeaders[w.HEADER.PREFER]=w.HEADER_VALUES.ANNOTATIONS)}Ze.TRACER_CATEGORY_ID="WebApiService",Ze.WEB_API_SOAP_FALL_BACK="web_api_soap_fall_back",Ze.WEB_API_ATTEMPT_TO_USE_ODATA="web_api_attempt_to_use_odata",Ze.WEB_API_REQUEST_SERIALIZATION_FAILED="web_api_request_serialization_failed",Ze.AUTO_IMPLEMENT_SOAP_FALLBACK="auto_implement_soap_fallback",Ze.WEB_API_URL_FRAGMENT="/api/data/v9.0/",Ze.EXTERNAL_SEARCH_WEBAPI_URL_FRAGMENT="/api/search/indexes/default/Entities?api-version=9.0",Ze.API_FRAGMENT_9_1="&api-version=9.1",Ze.HTTP_STATUS_CODE="HTTP-Status-Code",Ze.HTTP_RESPONSE_TYPE="HTTP-Response-Type",Ze.HTTP_RESPONSE_STATUSTEXT="HTTP-Response-StatusText",Ze.RESPONSE_URL="Response-Url",Ze.RESPONSE_SIZE_IN_BYTES="Response-Size-In-Bytes",Ze.ODATA_ERROR_RESPONSE_COMPLETE_TEXT="Odata-Error-Response-Complete-text",Ze.ODATA_ERROR_RESPONSE_IS_HTML_TYPE="Odata-Error-Response-Is-Html-Type",Ze.ODATA_ERROR_CODE_TYPE="Odata-Error-Code-Type",Ze.CRM_ERROR_RESPONSE_COMPLETE_TEXT_FROM_ODATA_RESPONSE="Crm-Error-Response-From-OdataResponse",Ze.IS_INSTANCE_OF_CRM_ERROR_RESPONSE="IsInstanceOfCrmErrorResponse",Ze.FETCH_ERROR_COMPLETE_TEXT="Fetch-Error-Complete-Text",Ze.FETCH_ERROR_NAME="Fetch-Error-Name",Ze.FETCH_ERROR_STACK="Fetch-Error-Stack",Ze.FETCH_ERROR_MESSAGE="Fetch-Error-Message",Ze.CRM_ERROR_CODE="Crm-Error-Code",Ze.IS_ERROR_IN_OFFLINE="ErrorInOffline",Ze.CRM_ERROR_MESSAGE="Crm-Error-Message",Ze.REQUEST_DETAILS="Request-Details",Ze.REQUEST_CONTEXT="Request-Context",Ze.CRM_CALL_STACK="Crm-Call-Stack",Ze.RESPONSE_TIME="Response-Time",Ze.TOKEN_LENGTH="TokenLength",Ze.FETCH_FAIL_DEFAULT_MESSAGE="Fetch failed",Ze.REQUEST_URL="Request-Url",Ze.ODATA_ERROR_DETAILS_MESSAGE="WebAPIService:Odata Error Response Details",Ze.UCIMONITOR_ERROR_MESSAGE="WebAPIService:UciMonitor Error Response Details",Ze.UNKNOWN="Unknown",Ze.FAILED="Failed",Ze.SUCCESS="Success",Ze.CRM_ERROR_RESPONSE_GET_ERROR="Crm-Error-Response-Get-Error",Ze.CRM_ERROR_RESPONSE_GET_ERROR_PARSING="Crm-Error-Response-Get-Error-Parsing",Ze.REQUEST_FAILURE="Request Failure",Ze.IS_BATCH_REQUEST="Is-Batch-Request",Ze.BATCH_REQUEST_PARSING_FAIL="Batch response parsing has failed",Ze.OTHER_DETAILS="Other-Details",Ze.PRELOAD_USERCONTEXT_CALL_DETAILS="Preload:UserContext Call Details",Ze.PRELOAD_ACTIVITY_CALL_DETAILS="Preload:Activity Call Details",Ze.REQUEST_METHOD="Method",Ze.WAITING_FOR_NETWORK_RESULT="Waiting-For-Network-Result",Ze.WAITING_FOR_NETWORK_MESSAGE="Waiting few seconds for network as network is offline",Ze.WAITING_FOR_NETWORK_SUCCEEDED_SERVER_REQUEST_SUCCEEDED_MESSAGE="Waiting few seconds for network succeeded and the subsequent request to server also succeeded",Ze.WAITING_FOR_NETWORK_SUCCEEDED_SERVER_REQUEST_FAILED_MESSAGE="Waiting few seconds for network succeeded but the request to server failed",Ze.WAITING_FOR_NETWORK_FAILED_MESSAGE="Waiting few seconds for network failed as network is still offline",Ze.FETCH_XML_PREFIX="fetchXml=",Ze.RETRYING_ON_CONNECTIVITY_ERROR="Retrying request for connectivity error",Ze.WILL_RETRY_FOR_CONNECTIVITY="Will-Retry-For-Connectivity",Ze.CONNECTIVITY_RETRY_COUNT="Connectivity-Retry-Count",Ze.LONG_URL_RETRY="Retry-Due-To-Long-Url",Ze.CLIENT_REQUEST_ID="Client-Request-Id",Ze.SERVER_REQUEST_ID="Server-Request-Id",Ze.CLIENT_ACTIVITY_ID="Client-Activity-Id",Ze.VERY_LONG_URL=16300,Ze.RETRIEVE_MULTIPLE_URL_LENGTH_LIMIT=1500},"SSL+":function(e,t,n){"use strict";n.d(t,"b",(function(){return h})),n.d(t,"a",(function(){return m}));var r=n("fMBw"),a=n.n(r),i=n("zI6t"),o=n.n(i),s=n("5UJb"),c=n.n(s),l=n("pEXn"),u=n("SZCI"),d=n("WbTV"),p=n("SAYH"),f=n("Wc7r"),g=n("5ylf");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function h(e){return!!e&&e.indexOf("GetClientMetadata")>=0}function m(e,t){Object(d.setStopwatchHeadersGetter)(t=>{if(t&&(0===t.indexOf(e)||"/"===t[0]))return[{headerName:f.HEADER.SERVER_REQUEST_ID,parameterName:l.n.ServerActivityId}]}),Object(d.setAdditionalHeadersGetter)(n=>!n||0!==n.indexOf(e)&&"/"!==n[0]?{}:{[f.HEADER.SESSION_ID]:t.getCurrentSessionId(),[f.HEADER.CORRELATION_ID]:t.getActivityId(),[f.HEADER.CLIENT_REQUEST_ID]:p.a.newGuid().guid}),Object(d.setNetworkRequestTrackingFilter)(e=>e&&-1===e.indexOf("dc.services.visualstudio.com")&&-1===e.indexOf("dc.applicationinsights.microsoft.com")&&-1===e.indexOf("uci_cdn_connection_check")&&-1===e.indexOf("pipe.aria.microsoft.com")&&-1===e.indexOf(".ttf?")&&-1===e.indexOf(".woff?"));let n=0,r=0,i=0,s=0;const m=()=>{const e={metadata:n,webService:r,assetLoads:i,telemetry:s};o.a.addCommonKpiParameters({[l.b.PageLoadParameters.NetworkRequestInfo]:JSON.stringify(e)},!0)};c.a.subscribeToAppWorking(()=>{n=0,r=0,i=0,s=0,o.a.onNextIdleProcessing(m)}),c.a.isAppIdle()||o.a.onNextIdleProcessing(m),a.a.registerTransport({writeMarker(e,t,n){},writeRetroactiveTimespan(e,t,a,i){e.getName()===u.z&&(r+=1,h(i[u.F])&&(n+=1))},startTimespan:(e,t,a)=>(e.getName()===u.z&&(r+=1,h(a[u.F])&&(n+=1)),()=>{})},[u.G]),a.a.registerTransport({writeMarker(e,t,n){},writeRetroactiveTimespan(e,t,n,r){},startTimespan:(e,t,n)=>(i++,()=>{})},[u.c]),a.a.registerTransport({writeMarker(e,t,n){},writeRetroactiveTimespan(e,t,n,r){"XMLHttpRequest"===e.getName()&&r[g.RESOURCE_NAME].includes("pipe.aria.microsoft.com")&&s++},startTimespan:(e,t,n)=>()=>{}},[g.NETWORK_REQUEST_EVENT_NAME])}},SSc5:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("gQ5I"),a=n("OmkB"),i=n("aOhN"),o=n("InN9");function s(e){return{type:"router.backbutton.async",execute({dispatch:t,getState:n},o){const s=o.Router.getDialogIdStack(),l=n();if(s.length>0){let n=s[s.length-1];if(c(n))for(let e=s.length-1;e>=0;e--)if(!c(s[e])){n=s[e];break}return c(n)?t(Object(i.b)(null,e)):isNaN(parseInt(n,10))?t(Object(a.a)(n,!0)):t(Object(r.e)(n))}if(l.pages&&Object.keys(n().pages).length>0)return t(Object(i.b)(null,e))}}}function c(e){return-1!==e.indexOf(o.a)}},SWZ5:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return s}));var r=n("XlXz"),a=n("y60j"),i=n("zmL5"),o=n("5DN6");const s="staticTab";function c(e,t,n){return{type:"execute.markactivetab.async",execute({dispatch:c,getState:l},u){const d=l(),p=Object(o.c)(d,n),f=Object(i.b)(d,n),g=p.sessionTabs,h=p.controlNames.map(e=>Object(a.a)(d,n,f,e));if(e.type===s){if(t){const t=h.findIndex(t=>t.Id===e.id);if(t>-1){const e=h.splice(t,1);h.unshift(e[0])}}}else if(t){const t=g.findIndex(t=>t.id===e.id);if(t>-1){const e=g.splice(t,1);g.unshift(e[0])}}return c(function(e,t){return{type:r.g,payload:e,meta:{pageId:t}}}({sessionTabs:g,controlNames:h.map(e=>e.Name),activeTabId:e.id},n)),Promise.resolve()}}}},"SX+A":function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"d",(function(){return o})),n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return s}));var r=n("sclX");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="platform.initialize",i="platform.state.change";function o(e,t=r.a.Active){return{type:a,payload:{state:t,type:e}}}function s(e){return{type:i,payload:e}}},SZCI:function(e,t,n){"use strict";n.d(t,"A",(function(){return r})),n.d(t,"g",(function(){return a})),n.d(t,"y",(function(){return i})),n.d(t,"E",(function(){return o})),n.d(t,"i",(function(){return s})),n.d(t,"e",(function(){return c})),n.d(t,"f",(function(){return l})),n.d(t,"r",(function(){return u})),n.d(t,"t",(function(){return d})),n.d(t,"q",(function(){return p})),n.d(t,"s",(function(){return f})),n.d(t,"C",(function(){return g})),n.d(t,"j",(function(){return h})),n.d(t,"m",(function(){return m})),n.d(t,"x",(function(){return b})),n.d(t,"v",(function(){return y})),n.d(t,"k",(function(){return _})),n.d(t,"p",(function(){return v})),n.d(t,"B",(function(){return S})),n.d(t,"a",(function(){return O})),n.d(t,"l",(function(){return C})),n.d(t,"u",(function(){return E})),n.d(t,"c",(function(){return I})),n.d(t,"G",(function(){return w})),n.d(t,"z",(function(){return j})),n.d(t,"F",(function(){return P})),n.d(t,"w",(function(){return T})),n.d(t,"D",(function(){return N})),n.d(t,"d",(function(){return A})),n.d(t,"n",(function(){return R})),n.d(t,"h",(function(){return D})),n.d(t,"b",(function(){return x})),n.d(t,"o",(function(){return M}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="Shim",a="ClientAPI",i="Core.Scheduler",o="Core.Actions.Sync",s="CustomScripts",c="CustomControlsFramework",l="CustomControls",u="init",d="updateView",p="controlId",f="manifestControlName",g="SlowFrames",h="EditFormLoad",m="FullLoad",b="SaveForm",y="MscrmControls.Containers.RelevanceSearchControl",_="GlobalSearch",v="RelevanceSearch",S="MscrmControls.FieldControls.SimpleLookupControl",O="MscrmControls.FieldControls.AdvancedLookupControl",C="MscrmControls.KbSearchControl.KbSearchControl",E="perf",I="Core.AssetLoader",w="WebService",j="SendRequest",P="urlParameters",T="requestName",N="Storage",A="Core.Boot",R="LivePersonaCard",D="CustomPage",x="AppHostClient",M="MainPageViewSelector"},Sbn7:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n("ABCl"),a=n("16wZ"),i=n("IaGr"),o=n("64CY"),s=n("wL2W"),c=n("pEXn"),l=n("+Qpx"),u=n("4aOd");class d{constructor(e){this._collection={},this._clientApiExecutor=new r.b(null,"ClientApi.XrmCollection.",null,[{name:"callerComponentName",value:e,isEventParam:!0}])}forEach(e){this._clientApiExecutor.execute("forEach",(t,n)=>{if(!e)return n.push({name:"name",value:"handler"}),void i.a.getInstance().traceManager.getTracer(t).error("Required parameter is null or undefined",n);if("function"!=typeof e)return n.push({name:"expectedType",value:"function"}),n.push({name:"name",value:typeof e}),void i.a.getInstance().traceManager.getTracer(t).error("Parameter type validation error",n);let a=0;for(const i in this._collection){const o=this._collection[i];Object(r.c)(t,n,()=>{e(o,a)}),a++}})}add(e,t){return this._clientApiExecutor.execute("add",(n,r)=>{if(e in this._collection){const a="An element with the same key already exists in the dictionary";r.push({name:"valueIsEqual",value:t===this._collection[e]?"true":"false"}),this._clientApiExecutor.reportFailure(n,new Error(a),r)}this._collection[e]=t},[{name:"key",value:e,isRequired:!0,isEventParam:!0}],!1)}get(e){return this._clientApiExecutor.execute("get",(t,n)=>{let r=null;return null==e?r=this._getAll():"string"==typeof e?r=this._getByName(e.toString()):"number"==typeof e?r=this._getByIndex(Number(e)):"function"==typeof e?r=this._getByFilter(e,t,n):(n.push({name:"type",value:typeof e}),Object(a.k)(t,"string|number|function","parameter",n)),r})}getFirst(e){return this._clientApiExecutor.execute("getFirst",(t,n)=>{if("function"!=typeof e)return n.push({name:"expectedType",value:"function"}),n.push({name:"name",value:typeof e}),i.a.getInstance().traceManager.getTracer(t).error("Parameter type validation error",n),null;let a=0;for(const i in this._collection){const o=this._collection[i];if(Object(r.c)(t,n,()=>{if(e(o,a))return o}))return o;a++}return null},[{name:"filter",value:e,isRequired:!0}])}getLength(){return this._clientApiExecutor.execute("getLength",()=>Object.keys(this._collection).length)}remove(e){const t=Object.keys(this._collection).find(t=>this._collection[t]===e);t&&delete this._collection[t]}getAll(){return this._clientApiExecutor.execute("getAll",()=>this._getAll())}getByName(e){return this._clientApiExecutor.execute("getByName",()=>this._getByName(e),[{name:"name",value:e,isEventParam:!0}])}getByIndex(e){return this._clientApiExecutor.execute("getByIndex",()=>this._getByIndex(e),[{name:"position",value:e,isEventParam:!0}])}getByFilter(e){return this._clientApiExecutor.execute("getByFilter",(t,n)=>e?"function"!=typeof e?(n.push({name:"expectedType",value:"function"}),n.push({name:"name",value:typeof e}),i.a.getInstance().traceManager.getTracer(t).error("Parameter type validation error",n),[]):this._getByFilter(e,t,n):(n.push({name:"name",value:"filter"}),i.a.getInstance().traceManager.getTracer(t).error("Required parameter is null or undefined",n),[]))}_getAll(){return Object.keys(this._collection).map(e=>this._collection[e])}_getByName(e){let t=this._collection[e];if(void 0===t&&(t=null),Object(s.a)()){const t=Object(o.d)(e);t&&this._reportCompositeControlsFormChecker(e,t)}return t}_reportCompositeControlsFormChecker(e,t){var n;const r=new u.a(new Error).getStackTrace(),a={"A composite control accessed through a business rule or a custom script":e,"This action is unsupported. Contact the business rule or custom script owner to make the change to use these controls instead":t,Source:/pbl_[0-9a-fA-F]{32}/.test(r)?"Business rule":"Custom script (see callStack)",callStack:r};null===(n=i.a.getInstance().traceManager.getTracer(`${l.u}${l.r}`))||void 0===n||n.error(l.B,[{name:c.l,value:l.r},{name:l.r,value:JSON.stringify(a)}])}_getByIndex(e){let t=null;const n=Object.keys(this._collection);if(n.length>e){const r=n[e];t=this._collection[r]}return t}_getByFilter(e,t,n){const a=[];let i=0;for(const o in this._collection){const s=this._collection[o];Object(r.c)(t,n,()=>{e(s,i)&&a.push(s)}),i++}return a}}},ScMg:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class r{constructor(){this._stateObsrevers=[]}registerObserver(e){e&&-1===this._stateObsrevers.indexOf(e)&&this._stateObsrevers.push(e)}notifyObservers(e){this._stateObsrevers.forEach(t=>{t.update(e)})}}var a=n("ZIjf");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class i{constructor(e,t,n,a){this._controlName=a,this._pageId=n,this._contextToken=t,this._controlStateObservable=new r}getName(){return a.a.instance.reportUsage("ClientApi.XrmControlBase.getName"),this._controlName}get name(){return this._controlName}get pageId(){return this._pageId}get contextToken(){return this._contextToken}get connectedControlProps(){return{controlName:this.name,id:this.pageId}}get controlStateObservable(){return this._controlStateObservable}}},ScZZ:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="add.toastNotificationAction",a="clear.toastNotificationsAction",i="remove.toastNotificationAction"},SeXA:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="action.dummy";function a(){return{type:r,payload:null}}},SjFi:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"b",(function(){return s}));var r=n("Lyxw");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a=/^(October|April)\d{4}Update$/;function i(e){return(null==e?void 0:e.startsWith("October"))?2:1}function o(e){var t;return Number.parseInt(null===(t=null==e?void 0:e.match(/\d+/))||void 0===t?void 0:t[0],10)}function s(e){const t=Object(r.c)(e);if(t)return t.sort((e,t)=>{const n=o(e),r=o(t);if(n!==r)return n-r;return i(e)-i(t)}),t[t.length-1]}},"Sm/T":function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i}));var r=n("ZYsU");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e){return{type:r.b,payload:{loadingStatus:e}}}function i(e){return{type:r.a,payload:{loadingStatus:e}}}},SnEr:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));const r="record.remove";function a(e){const t={entities:{[e.etn]:{[e.id.guid]:null}}};return{type:r,payload:t}}},SoYb:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e){if(e)switch(e.toLowerCase()){case"false":case"0":return!1;case"true":case"1":return!0;default:return}}function a(e){const t=parseInt(e,10);if(!isNaN(t))return t}function i(e){const t=parseFloat(e);if(!isNaN(t))return t}function o(e){if(!e)return;let t,n,r,a=-1;const i=new RegExp("([1-9]|1[012]):([0-5][0-9]):([0-5][0-9])(\\s*)([aApP][mM]{0,2})").exec(e);return i&&(t=parseFloat(i[1]),"pm"===i[5]?t+=12:12===t&&(t=0),n=parseFloat(i[2]),r=parseFloat(i[3]),isNaN(t)||isNaN(n)||isNaN(r)||(a=3600*Math.floor(t)+60*Math.floor(n)+r)),a}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return o}))},SocB:function(e,t,n){"use strict";n.d(t,"d",(function(){return y})),n.d(t,"k",(function(){return c})),n.d(t,"i",(function(){return b})),n.d(t,"e",(function(){return s})),n.d(t,"j",(function(){return p})),n.d(t,"f",(function(){return l})),n.d(t,"g",(function(){return u})),n.d(t,"h",(function(){return d})),n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r=.41,a=.5,i=.68;var o;function s(e){return c(e).luminosity<.5?"#000000":"#FFFFFF"}function c(e,t){let n=String(e).replace(/[^0-9a-f]/gi,"");n.length<6&&(n=n[0]+n[0]+n[1]+n[1]+n[2]+n[2]),t||(t=0);let r="#";let a=0;for(let e=0;e<3;e++){let i=parseInt(n.substr(2*e,2),16);i=Math.round(Math.min(Math.max(0,i+255*t),255)),a+=e===o.red?.299*i:e===o.green?.587*i:.114*i;const s=i.toString(16);r+=("00"+s).substring(s.length)}return{rgb:r,luminosity:1-a/255}}function l(e){return{Fill:e,Text:s(e)}}function u(e,t){c(e).luminosity>.8&&(e=c(e,.25).rgb);const n=f("#ffffff",e,t);return{Fill:n,Text:s(n)}}function d(e){if(c(e).luminosity<.2){const t=f("#000000",e,.1);return{Fill:t,Text:s(t)}}const t=function(e,t){const n=function(e){const t=e[0]/255,n=e[1]/255,r=e[2]/255,a=Math.max(t,n,r),i=Math.min(t,n,r),o=(a+i)/2;let s,c;if(a===i)s=c=0;else{const e=a-i;switch(c=o>.5?e/(2-a-i):e/(a+i),a){case t:s=(n-r)/e+(n<r?6:0);break;case n:s=(r-t)/e+2;break;case r:s=(t-n)/e+4}s/=6}return[s,c,o]}(m(e)),r=Math.min(1,Math.max(0,n[2]+t)),a=g(n[0],n[1],Math.max(0,r));return h(a[0],a[1],a[2])}(e,-.1);return{Text:s(t),Fill:t}}function p(e,t,n){return function(e,t){const n=c(e).luminosity,r=c(t).luminosity;return n>r?(n+.05)/(r+.05):(r+.05)/(n+.05)}(e,n)<4.4?t:e}function f(e,t,n){const r=m(e),a=m(t);if(n<0||n>1)return"#000000";return h(Math.round(a[0]*(1-n)+r[0]*n),Math.round(a[1]*(1-n)+r[1]*n),Math.round(a[2]*(1-n)+r[2]*n))}function g(e,t,n){let r,a,i;if(0===t)r=a=i=n;else{const o=function(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e},s=n<.5?n*(1+t):n+t-n*t,c=2*n-s;r=o(c,s,e+1/3),a=o(c,s,e),i=o(c,s,e-1/3)}return[Math.round(255*r),Math.round(255*a),Math.round(255*i)]}function h(e,t,n){return"#"+("0"+e.toString(16)).slice(-2)+("0"+t.toString(16)).slice(-2)+("0"+n.toString(16)).slice(-2)}function m(e){return/^#(?:[0-9a-fA-F]{3}){1,2}$/.test(e)?(t=e,[parseInt(t.substring(1,3),16),parseInt(t.substring(3,5),16),parseInt(t.substring(5,7),16)]):[0,128,0];var t}function b(e){if(/^#(?:[0-9a-fA-F]{3}){1,2}$/.test(e))return e;const t=e.match(/^\d+|\d+\b|\d+(?=\w)/g);if(/rgb/.test(e))return h(parseInt(t[0],10),parseInt(t[1],10),parseInt(t[2],10));if(/hsl/.test(e)){const e=g(parseInt(t[0],10),parseInt(t[1],10),parseInt(t[2],10));return h(e[0],e[1],e[2])}return"#080"}!function(e){e[e.red=0]="red",e[e.green=1]="green",e[e.blue=2]="blue"}(o||(o={}));const y={Red:{Red1:"#ffa2a2",Red2:"#ff0c00",Red3:"#ea0600",Red4:"#bf0900",Red5:"#800600"},Blue:{Blue1:"#96bee2",Blue2:"#6199d1",Blue3:"#2975b2",Blue4:"#045999",Blue5:"#04437c",Blue6:"#3a96dd",Blue7:"#001433",Blue8:"#0742AB",Blue9:"#2266E3"},Teal:{Teal1:"#99ebed",Teal2:"#00ced3",Teal3:"#00b7c3",Teal4:"#008992",Teal5:"#005c62"},Orange:{Orange1:"#ffd199",Orange2:"#ffaf4d",Orange3:"#ff8c00",Orange4:"#f2670c",Orange5:"#c2530a"},Green:{Green1:"#bdf2a7",Green2:"#91ea6d",Green3:"#47c21d",Green4:"#358717",Green5:"#1c6512"},Yellow:{Yellow1:"#fae8a7",Yellow2:"#f7cf52",Yellow3:"#f2c624",Yellow4:"#bf991f",Yellow5:"#725a0d"},Clay:{Clay1:"#f4c0b9",Clay2:"#e2614f",Clay3:"#db3923",Clay4:"#a42b1a",Clay5:"#6e1d12"},Pink:{Pink1:"#ffddf2",Pink2:"#ffc7ea",Pink3:"#ffa8da",Pink4:"#b26491",Pink5:"#652f4e"},Violet:{Violet1:"#e6bdee",Violet2:"#b860c1",Violet3:"#a638b2",Violet4:"#6a1e7a",Violet5:"#47104c"},Purple:{Purple1:"#e9bbff",Purple2:"#a350c4",Purple3:"#8c2ab5",Purple4:"#691b88",Purple5:"#46125b",Purple6:"#742774",Purple7:"#672367"},Grey:{Grey1:"#efefef",Grey2:"#e2e2e2",Grey3:"#d8d8d8",Grey4:"#b3b3b3",Grey5:"#666666",Grey6:"#444444",Grey7:"#333333",Grey8:"#FAF9F8",Grey9:"#F3F2F1"},White:"#FFFFFF",Black:"#000000",Transparent:"#FFFFFF",CalculateContrast:s}},Sq7X:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("3BuU"),a=n("9fhM"),i=n("/uKC"),o=n("Itgg"),s=n("7CnF"),c=n("vPXf"),l=n("Ri7K"),u=n("E+70"),d=n("RHUE"),p=function(){function e(e,t,n,r,a){var i=this;this._requestQueue=e,this._queueManager=n,this._httpInterface=r,this._urlString="?qsp=true&content-type=application%2Fbond-compact-binary&client-id=NO_AUTH&sdk-version="+c.FullVersionString,this._killSwitch=new o.default,this._paused=!1,this._useBeacons=!1,this._activeConnections=0,this._clockSkewManager=new s.default(a),l.isUint8ArrayAvailable()||(this._urlString+="&content-encoding=base64"),this._urlString=t+this._urlString,this._httpInterface||(this._useBeacons=!l.isReactNative(),this._httpInterface={sendPOST:function(e,t,n,r,a,o){try{if(l.useFetchRequest())fetch(e,{body:t,method:"POST"}).then((function(e){var t={};e.headers&&e.headers.forEach((function(e,n){t[n]=e})),a(e.status,t)})).catch((function(e){r(0,{})}));else if(l.useXDomainRequest()){var s=new XDomainRequest;s.open("POST",e),s.onload=function(){a(200,null)},s.onerror=function(){r(400,null)},s.ontimeout=function(){n(500,null)},s.send(t)}else{var c=new XMLHttpRequest;c.open("POST",e,!o),c.onload=function(){a(c.status,i._convertAllHeadersToMap(c.getAllResponseHeaders()))},c.onerror=function(){r(c.status,i._convertAllHeadersToMap(c.getAllResponseHeaders()))},c.ontimeout=function(){n(c.status,i._convertAllHeadersToMap(c.getAllResponseHeaders()))},c.send(t)}}catch(e){r(400,null)}}})}return e.prototype.hasIdleConnection=function(){return this._activeConnections<2},e.prototype.sendQueuedRequests=function(){for(;this.hasIdleConnection()&&!this._paused&&this._requestQueue.length>0&&this._clockSkewManager.allowRequestSending();)this._activeConnections++,this._sendRequest(this._requestQueue.shift(),0,!1);this.hasIdleConnection()&&d.default.scheduleTimer()},e.prototype.isCompletelyIdle=function(){return 0===this._activeConnections},e.prototype.teardown=function(){for(;this._requestQueue.length>0;)this._sendRequest(this._requestQueue.shift(),0,!0)},e.prototype.pause=function(){this._paused=!0},e.prototype.resume=function(){this._paused=!1,this.sendQueuedRequests()},e.prototype.removeQueuedRequests=function(){this._requestQueue.length=0},e.prototype.sendSynchronousRequest=function(e,t){this._paused&&(e[t][0].priority=r.AWTEventPriority.High),this._activeConnections++,this._sendRequest(e,0,!1,!0)},e.prototype._sendRequest=function(e,t,n,i){var o=this;void 0===i&&(i=!1);try{if(this._paused)return this._activeConnections--,void this._queueManager.addBackRequest(e);var s=0,c="";for(var d in e)e.hasOwnProperty(d)&&(this._killSwitch.isTenantKilled(d)?(u.default.eventsRejected(e[d],r.AWTEventsRejectedReason.KillSwitch),delete e[d]):(c.length>0&&(c+=","),c+=d,s++));if(s>0){var p=a.default.getPayloadBlob(e,s);p.remainingRequest&&this._requestQueue.push(p.remainingRequest);var f=this._urlString+"&x-apikey="+c+"&client-time-epoch-millis="+Date.now().toString();this._clockSkewManager.shouldAddClockSkewHeaders()&&(f=f+"&time-delta-to-apply-millis="+this._clockSkewManager.getClockSkewHeaderValue());var g=void 0;for(var d in g=l.isUint8ArrayAvailable()?new Uint8Array(p.payloadBlob):a.default.base64Encode(p.payloadBlob),e)if(e.hasOwnProperty(d))for(var h=0;h<e[d].length;++h)e[d][h].sendAttempt>0?e[d][h].sendAttempt++:e[d][h].sendAttempt=1;if(this._useBeacons&&n&&l.isBeaconsSupported()&&navigator.sendBeacon(f,g))return;this._httpInterface.sendPOST(f,g,(function(r,a){o._retryRequestIfNeeded(r,a,e,s,c,t,n,i)}),(function(r,a){o._retryRequestIfNeeded(r,a,e,s,c,t,n,i)}),(function(r,a){o._retryRequestIfNeeded(r,a,e,s,c,t,n,i)}),n||i)}else n||this._handleRequestFinished(!1,{},n,i)}catch(e){this._handleRequestFinished(!1,{},n,i)}},e.prototype._retryRequestIfNeeded=function(e,t,n,a,o,s,c,l){var p=this,f=!0;if(void 0!==e){if(t){var g=this._killSwitch.setKillSwitchTenants(t["kill-tokens"],t["kill-duration-seconds"]);this._clockSkewManager.setClockSkew(t["time-delta-millis"]);for(var h=0;h<g.length;++h)u.default.eventsRejected(n[g[h]],r.AWTEventsRejectedReason.KillSwitch),delete n[g[h]],a--}else this._clockSkewManager.setClockSkew(null);if(200===e)return void this._handleRequestFinished(!0,n,c,l);(!i.default.shouldRetryForStatus(e)||a<=0)&&(f=!1)}if(f)if(l)this._activeConnections--,n[o][0].priority=r.AWTEventPriority.High,this._queueManager.addBackRequest(n);else if(s<1){for(var m in n)n.hasOwnProperty(m)&&u.default.eventsRetrying(n[m]);setTimeout((function(){return p._sendRequest(n,s+1,!1)}),i.default.getMillisToBackoffForRetry(s))}else this._activeConnections--,d.default.backOffTransmission(),this._queueManager.addBackRequest(n);else this._handleRequestFinished(!1,n,c,l)},e.prototype._handleRequestFinished=function(e,t,n,a){for(var i in e&&d.default.clearBackOff(),t)t.hasOwnProperty(i)&&(e?u.default.eventsSent(t[i]):u.default.eventsDropped(t[i],r.AWTEventsDroppedReason.NonRetryableStatus));this._activeConnections--,a||n||this.sendQueuedRequests()},e.prototype._convertAllHeadersToMap=function(e){var t={};if(e)for(var n=e.split("\n"),r=0;r<n.length;++r){var a=n[r].split(": ");t[a[0]]=a[1]}return t},e}();t.default=p},SzHS:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,i.default)(e)};var r,a=n("Keau"),i=(r=a)&&r.__esModule?r:{default:r}},T544:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("504W"),a=n("2F73"),i=n("XvL5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
let o=null;class s{constructor(e,t){this._entityLogicalName=null,this._attributeNames=null,this._ValidateNames(e,t)}get_EntityLogicalName(){return this._entityLogicalName}get_validAttributeRegExp(){return o||(o=new RegExp("^[A-Za-z]+[A-Za-z0-9_]*$")),o}get_AttributeNames(){return this._attributeNames}toString(){let e=this._entityLogicalName;return Object(r.a)(this._attributeNames)||(e+=" : "+this._attributeNames.join(", ")),e}_ValidateNames(e,t){if(this._entityLogicalName=e,t instanceof a.a?this._attributeNames=null:t instanceof i.a?this._attributeNames=t.get_Columns():this._attributeNames=t,!Object(r.a)(this._attributeNames))for(let e=0;e<this._attributeNames.length;e++){if(!this.get_validAttributeRegExp().test(this._attributeNames[e]))throw Error.argument(this._attributeNames[e],"Invalid attribute name")}}}},T6Zt:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n("ghNp"),a=n("16wZ"),i=n("ZIjf"),o=n("lJW1"),s=n("qshH");let c;class l{constructor(e,t,n){e||Object(a.j)("ClientApi.XrmKBSearchUI.constructor","store"),t||Object(a.j)("ClientApi.XrmKBSearchUI.constructor","contextToken"),c=e,this._contextToken=t,this._pageId=n}get control(){const e="ClientApi.XrmKBSearchUI.control";try{if(i.a.instance.reportCall(e),!this._xrmSearchWidgetControl){const e={};this._xrmSearchWidgetControl=new o.a(c,this._contextToken,this._pageId,e,"MscrmControls.KbSearchControl.KbSearchControl",null)}return i.a.instance.reportSuccess(e),this._xrmSearchWidgetControl}catch(t){throw s.a.getInstance().reportFailure(e,t),t}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let u;class d{constructor(e,t,n){const i="ClientApi.XrmKBSearch.constructor";e||Object(a.j)(i,"store"),n||Object(a.j)(i,"pageId"),t||Object(a.j)(i,"contextToken"),u=e,this._pageId=n,this._contextToken=t,u.dispatch(Object(r.a)(this,n,t))}get context(){return i.a.instance.reportUsage("ClientApi.XrmKBSearch.context_get"),this._globalContext}set context(e){i.a.instance.reportUsage("ClientApi.XrmKBSearch.context_set"),this._globalContext=e}get data(){return i.a.instance.reportUsage("ClientApi.XrmKBSearch.data"),null}get ui(){try{return i.a.instance.reportCall("ClientApi.XrmKBSearch.ui"),this._ui||(this._ui=new l(u,this._contextToken,this._pageId)),i.a.instance.reportSuccess("ClientApi.XrmKBSearch.ui"),this._ui}catch(e){const t=s.a.getInstance().getEventParameters(this._contextToken);throw s.a.getInstance().reportFailure("ClientApi.XrmKBSearch.ui",e,null,t),e}}getControl(){const e="ClientApi.XrmKBSearch.getControl";try{i.a.instance.reportCall(e);const t=this.ui.control;return i.a.instance.reportSuccess(e),t}catch(t){const n=s.a.getInstance().getEventParameters(this._contextToken);throw s.a.getInstance().reportFailure(e,t,null,n),t}}}},TBkx:function(e,t,n){"use strict";n.d(t,"e",(function(){return u})),n.d(t,"f",(function(){return d})),n.d(t,"i",(function(){return p})),n.d(t,"k",(function(){return f})),n.d(t,"h",(function(){return h})),n.d(t,"g",(function(){return m})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"d",(function(){return s})),n.d(t,"j",(function(){return g})),n.d(t,"b",(function(){return c}));var r=n("JdSN"),a=n("SAYH");const i=2147500038,o=2147500040,s=2147500039,c=-2147098623,l=/\b((\d|[a-fA-F]){8}-(\d|[a-fA-F]){4}-(\d|[a-fA-F]){4}-(\d|[a-fA-F]){4}-(\d|[a-fA-F]){12})\b/;function u(e,t){if(e instanceof Error)return e;if(!e){const e="No error data provided.";return t&&t.info(e),Error(e)}const n=function(e,t){const n=Error("blank");let a="";e.source&&(e.source.actionType&&(a+="\nactionType: "+e.source.actionType),e.source.contextId&&(a+="\ncontextId: "+e.source.contextId));e.reason&&(e=e.reason);if(e.errorFault&&(e.errorFault.get_Message||e.errorFault.get_message)&&e.errorFault.get_responseText)return n.message=(e.errorFault.get_message?e.errorFault.get_message():e.errorFault.get_Message())+a,n.stack=e.errorFault.get_responseText(),t&&t.warn("Unsupported codepath: Error object for telemetry being created from ErrorFault.",[{name:"ErrorMessage",value:n.message}]),n;if(e instanceof r.a)return n.message=e.get_message()+a,n.stack="No stack available.",t&&t.warn("Unsupported codepath: Error object for telemetry being created from OrganizationServiceFault.",[{name:"ErrorMessage",value:n.message}]),n;if(e.get_Message)return n.message=e.get_Message()+a,n.stack="No stack available.",n;if(e.message)return n.message=e.message+a,n.stack=e.stack||"No stack available.",n;return null}(e,t);if(n)return n;const a=Error("blank");if("string"==typeof e||e instanceof String)a.message=e.valueOf();else if(e.message)a.message=e.message;else{let n="";try{n=JSON.stringify(e)}catch(e){n="Error provided failed to be stringified: "+e.message}a.message=n;const r="Error provided lacks error message: "+n;t&&t.info(r)}return e.stack?a.stack=e.stack:a.stack="No stack available.",a}function d(e,t){const n=u(e);let r="Message: "+(n.message?n.message:t);return n.stack&&(r+="\nStack: "+n.stack),r}function p(e){return 2147811606===e}function f(e){return e===i||e===o}function g(e){return e&&e.errorCode&&e.getNegativeErrorCode&&-2147220960===e.getNegativeErrorCode()&&e.message&&e.message.includes("prvUseTabletApp")}function h(e){if(!e||!e.errorCode||!e.message||!e.message.includes("appmodule")&&!e.message.includes("App Module"))return!1;const t=e.getNegativeErrorCode();return-2147093987===t||-2147220969===t}function m(e){if(!e)return null;const t=l.exec(e);if(!t||!t.length)return null;const n=t[0].trim();return new a.a(n)}},TDVd:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var r=n("2yvP"),a=n("ghNp"),i=n("NjDY"),o=n("IqkD"),s=n("iZ7K"),c=n("odYE"),l=n("SAYH"),u=n("5Oca"),d=n("M0zh"),p=n("dHD5"),f=n("cUMa"),g=n("Sbn7"),h=n("ILmX");class m{constructor(){this._xrmPrimaryGridCache=null,this._xrmSubGridCache={},this._xrmPrimaryFormCache=null,this._xrmQuickFormCache={}}evaluateParameters(e,t,n,r,a,c,p,f,g){const m=[];let b;if(n){const y=Object(u.i)(c,n.EntityLogicalName);return y&&n.EntityId&&(b=y[n.EntityId.guid]),e.forEach(e=>{var u;switch(e.Name){case"BoolParameter":case"DecimalParameter":case"IntParameter":case"StringParameter":m.push({name:e.ParameterName,value:e.Value});break;case"CrmParameter":default:switch(e.ParameterType){case 18:case 19:case 20:case 21:m.push({name:e.ParameterName,value:e.Value});break;case 14:const y=Object(i.D)(c);y?m.push({name:e.ParameterName,value:y.organizationUniqueName}):m.push({name:e.ParameterName,value:null});break;case 15:const _=Object(i.D)(c);m.push({name:e.ParameterName,value:_.languageCode});break;case 16:const v=Object(o.x)(c);v?m.push({name:e.ParameterName,value:v.languageId}):m.push({name:e.ParameterName,value:null});break;case 1:if(b&&b.identifier){const t=Object(s.h)(c,b.identifier.etn);m.push({name:e.ParameterName,value:t.ObjectTypeCode})}else if(n.EntityLogicalName){const t=Object(s.p)(c,n.EntityLogicalName);m.push({name:e.ParameterName,value:t})}else m.push({name:e.ParameterName,value:null});break;case 2:b&&b.identifier?m.push({name:e.ParameterName,value:b.identifier.etn}):n.EntityLogicalName?m.push({name:e.ParameterName,value:n.EntityLogicalName}):m.push({name:e.ParameterName,value:null});break;case 3:if(n.EntityId){const t=[];t.push(l.a.externalGuid(n.EntityId)),m.push({name:e.ParameterName,value:t})}else m.push({name:e.ParameterName,value:null});break;case 4:n.EntityId?m.push({name:e.ParameterName,value:l.a.externalGuid(n.EntityId)}):m.push({name:e.ParameterName,value:null});break;case 7:case 8:let S=null;if(1===n.ContextType||3===n.ContextType||6===n.ContextType||4===n.ContextType||n.ContextEntityLogicalName?S=n.ContextEntityLogicalName:n.EntityLogicalName&&(S=n.EntityLogicalName),S&&7===e.ParameterType){const t=Object(s.p)(c,S);m.push({name:e.ParameterName,value:t})}else m.push({name:e.ParameterName,value:S});break;case 11:case 22:m.push({name:e.ParameterName,value:n.SelectedItems.length});break;case 25:m.push({name:e.ParameterName,value:n.AllItems.length});break;case 28:m.push({name:e.ParameterName,value:n.AllItems.length-n.SelectedItems.length});break;case 9:case 23:case 29:case 26:case 24:case 30:case 27:let O=!0;9!==e.ParameterType&&23!==e.ParameterType&&29!==e.ParameterType&&26!==e.ParameterType||(O=!1);const C=[],E=[];if(9===e.ParameterType||23===e.ParameterType||24===e.ParameterType)n.SelectedItems.length>0&&n.SelectedItems.forEach(e=>{const t=l.a.toString(e.EntityReference.id);C.push(t);const n=Object(s.h)(c,e.EntityReference.etn),r={Id:t,Name:e.EntityReference.name,TypeName:e.EntityReference.etn,TypeCode:n&&n.ObjectTypeCode};E.push(r)});else if(null!=n.AllItems){const t=[];29===e.ParameterType&&n.SelectedItems.length>0&&n.SelectedItems.forEach(e=>{t.push(l.a.externalGuid(e.EntityReference.id))}),n.AllItems.forEach(e=>{const n=l.a.toString(e.id);if(-1===t.indexOf(n)){C.push(n);const t=Object(s.h)(c,e.etn),r={Id:n,Name:e.name,TypeName:e.etn,TypeCode:t&&t.ObjectTypeCode};E.push(r)}})}1===t?m.push({name:e.ParameterName,value:C.join()}):O?m.push({name:e.ParameterName,value:E}):m.push({name:e.ParameterName,value:C});break;case 10:if(n.SelectedItems.length>0){const t=n.SelectedItems[0].EntityReference;m.push({name:e.ParameterName,value:l.a.externalGuid(t.id)})}else m.push({name:e.ParameterName,value:null});break;case 5:case 12:switch(n.ContextType){case 2:m.push({name:e.ParameterName,value:this.getForm(r,c,p)});break;case 1:f&&""!==f?m.push({name:e.ParameterName,value:this.getSubGrid(f,r,c,p,n)}):m.push({name:e.ParameterName,value:this.getGrid(r,c,p,n)});break;case 8:m.push({name:e.ParameterName,value:this.getDashboard(f,r,c,p)});break;case 3:case 4:case 6:5===e.ParameterType?m.push({name:e.ParameterName,value:this.getForm(r,c,p)}):m.push({name:e.ParameterName,value:this.getSubGrid(f,r,c,p,n)});break;case 7:5===e.ParameterType?m.push({name:e.ParameterName,value:this.getForm(r,c,p)}):m.push({name:e.ParameterName,value:this.getQuickForm(r,f,c,p)});break;default:m.push({name:e.ParameterName,value:null})}break;case 6:case 13:m.push({name:e.ParameterName,value:null});break;case 17:const I=null!==(u=n.ContextEntityLogicalName)&&void 0!==u?u:n.EntityLogicalName,w={SourceControlId:a.replace(new RegExp(d.c,"g"),I),CommandValueId:Object(h.d)(c,g,a)};n&&n.CustomControlType&&(w.CustomControlType=n.CustomControlType),m.push({name:e.ParameterName,value:w});break;case 0:default:m.push({name:e.ParameterName,value:null})}}}),m}}static containsCommandPropertiesReference(e){return e.some(e=>{switch(e.Name){case"BoolParameter":case"DecimalParameter":case"IntParameter":case"StringParameter":return!1;case"CrmParameter":default:return 17===e.ParameterType}})}_generateContextSpecificGridControl(e,t){return Object(r.b)("ribbon.parameters",()=>{let n=e;if(e&&e.getGrid&&e.getGrid()&&t&&t.SelectedItems){const r=e.getGrid(),a=r.getSelectedRows(),i=t.SelectedItems.map(e=>e.EntityReference),o=a.get().map(e=>e&&e.data&&e.data.entity&&e.data.entity.getId()&&e.data.entity.getEntityName()&&new c.a(e.data.entity.getEntityName(),new l.a(e.data.entity.getId())));if(!Object(f.a)(i,o,c.a.equals)){const t=Object.assign(Object.create(Object.getPrototypeOf(r)),r),a=r.getRows().get(),o=a.map(e=>e&&e.data&&e.data.entity&&e.data.entity.getId()&&e.data.entity.getEntityName()&&new c.a(e.data.entity.getEntityName(),new l.a(e.data.entity.getId())));t.getSelectedRows=()=>a.reduce((e,t,n)=>{for(let r=0;r<i.length;r++){const a=i[r];if(c.a.equals(a,o[n])){const n=a.id.guid;return e.add(n,t),e}}return e},new g.a("Commanding.EvaluateParameters._generateContextSpecificGridControl")),n=Object.assign(Object.create(Object.getPrototypeOf(e)),e),n.getGrid=()=>t}}return n})}getGrid(e,t,n,r){if(!this._xrmPrimaryGridCache){const a=this._getObject(t,n,null,e,p.l);this._xrmPrimaryGridCache=this._generateContextSpecificGridControl(a,r)}return this._xrmPrimaryGridCache}getSubGrid(e,t,n,r,a){if(!this._xrmSubGridCache[e]){const i=this._getObject(n,r,e,t,null);this._xrmSubGridCache[e]=this._generateContextSpecificGridControl(i,a)}return this._xrmSubGridCache[e]}getDashboard(e,t,n,r){return this._xrmPrimaryDashboardCache||(this._xrmPrimaryDashboardCache=this._getObject(n,r,e,t,p.j)),this._xrmPrimaryDashboardCache}getForm(e,t,n){return this._xrmPrimaryFormCache||(this._xrmPrimaryFormCache=this._getObject(t,n,null,e,p.j)),this._xrmPrimaryFormCache}getQuickForm(e,t,n,r){return this._xrmQuickFormCache[t]||(this._xrmQuickFormCache[t]=this._getObject(n,r,t,e,null)),this._xrmQuickFormCache[t]}_getObject(e,t,n,r,i){if(!n){if(!i)return null;n=Object(p.w)(i(e,r))}return Object(a.e)(r,n,t.ClientApiManager)}}},TEuE:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return d})),n.d(t,"d",(function(){return w})),n.d(t,"g",(function(){return A})),n.d(t,"c",(function(){return R})),n.d(t,"f",(function(){return T})),n.d(t,"e",(function(){return N}));var r=n("fMBw"),a=n.n(r),i=n("5UJb"),o=n.n(i),s=n("SZCI");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const c=a.a.createEvent("TaskSchedulerPause",s.y);let l;const u={priorityIndex:0,name:"Rendering"},d={priorityIndex:1,name:"Accessibility"};let p=-1;const f=[u,d],g=[],h=f.map(e=>({priority:e,perfEvent:a.a.createEvent("TaskScheduler."+e.name,s.y),tasks:[]}));let m=0,b=-1,y=!1,_=-1;const v=window.requestIdleCallback;const S=window.cancelIdleCallback;function O(e){S?S(e):clearTimeout(e)}function C(e){const t=m;m=Math.max(e,0),0===m?E(!1):1===m&&E(!0),m>t&&(b=performance.now())}function E(e){!y&&e&&(l=c.startStopwatch(),-1===_&&(_=setInterval(I,500)),O(p),p=-1),y=e,y||(l&&l(),l=null,P())}function I(){const e=performance.now()-b;y?e>400&&C(0):e>2e3&&(clearInterval(_),_=-1)}function w(e){C(m+1),e.then(()=>{C(m-1)},()=>{C(m-1)})}function j(e=!1){if(y&&!e)return;const t=o.a.trackWork("TaskScheduler",!1);let n;try{const r=f.slice(),a=()=>g.length>0?g.shift():r.shift();for(let t=a();null!=t;t=a()){const r=h[t.priorityIndex],a=r.tasks.slice();r.tasks=[],n=r.perfEvent.startStopwatch();let i=!1;for(;a.length>0;){const e=a.pop();void 0!==e&&(e(),i=!0)}if(n&&n(),n=void 0,0===g.length&&!e&&i)break}}finally{t(),n&&n(),A()&&P()}}function P(){var e;-1!==p||y||(e=()=>{p=-1,j()},p=v?v(e,{timeout:300}):setTimeout(e,1))}function T(e,t){const n=h[t.priorityIndex].tasks;return n.push(e),P(),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}function N(e){-1===g.indexOf(e)&&g.push(e)}function A(){for(const e of h)if(e.tasks.length>0)return!0;return!1}function R(){O(p),p=-1,j(!0)}},TFb5:function(e,t,n){"use strict";n.d(t,"w",(function(){return o})),n.d(t,"s",(function(){return s})),n.d(t,"A",(function(){return c})),n.d(t,"q",(function(){return p})),n.d(t,"r",(function(){return f})),n.d(t,"v",(function(){return g})),n.d(t,"b",(function(){return h})),n.d(t,"e",(function(){return b})),n.d(t,"i",(function(){return m})),n.d(t,"a",(function(){return y})),n.d(t,"g",(function(){return v})),n.d(t,"n",(function(){return S})),n.d(t,"l",(function(){return O})),n.d(t,"y",(function(){return C})),n.d(t,"k",(function(){return E})),n.d(t,"j",(function(){return I})),n.d(t,"c",(function(){return w})),n.d(t,"z",(function(){return T})),n.d(t,"p",(function(){return d})),n.d(t,"d",(function(){return _})),n.d(t,"o",(function(){return N})),n.d(t,"x",(function(){return A})),n.d(t,"h",(function(){return R})),n.d(t,"f",(function(){return D})),n.d(t,"u",(function(){return j})),n.d(t,"t",(function(){return P})),n.d(t,"m",(function(){return x}));var r=n("504W"),a=n("eruq"),i=n("q/4y");function o(e){return(new DOMParser).parseFromString(e,"text/xml")}function s(e,t){if(!Object(r.a)(e)&&!Object(r.a)(e.attributes)){const n=e.attributes.getNamedItem(t);if(!Object(r.a)(n))return n.nodeValue}return null}function c(e,t,n){if(e&&e.attributes&&e.attributes.getNamedItem){const r=e.attributes.getNamedItem(t);r&&(r.nodeValue=n)}}function l(e,t,n){const r=e.createAttribute(t);return r.value=n,r}function u(e,t,n){return s(e,n)===s(t,n)}function d(e){var t,n;const i=Object(a.b)(e);if(!i)return{};const o=i.getElementsByTagName("entity")[0].getAttribute("name"),s={[o]:[]},c=i.getElementsByTagName("attribute");for(let e=0;e<c.length;e++){const a=c[e],i=null===(t=a.attributes)||void 0===t?void 0:t.getNamedItem("name").nodeValue;if("link-entity"!==(null===(n=null==a?void 0:a.parentNode)||void 0===n?void 0:n.nodeName)||Object(r.a)(a.parentNode.getAttribute("name")))s[o].push(i);else{const e=a.parentNode.getAttribute("name"),t=a.getAttribute("name");Object(r.a)(s[e])?s[e]=[t]:s[e].push(t)}}return s}function p(e){if(Object(r.a)(e))return null;if(g(e))return null;const t=[],n=e.getElementsByTagName("attribute");for(let e=0;e<n.length;e++){const a=n[e],i=a.attributes.getNamedItem("name").nodeValue;if("link-entity"!==a.parentNode.nodeName||Object(r.a)(a.parentNode.attributes.getNamedItem("alias")))t[e]=i;else{const n=a.parentNode.attributes.getNamedItem("alias").nodeValue;t[e]=n+"."+i}}return t}function f(e){const t=null==e?void 0:e.getElementsByTagName("entity");if(!Object(r.a)(t)&&!Object(r.a)(t[0]))return t[0].getAttribute("name")}function g(e){return!Object(r.a)(e)&&e.getElementsByTagName("all-attributes").length>0}function h(e,t){if(Object(r.a)(t)||!t.length||Object(r.a)(e))return;const n=p(e),a=e.getElementsByTagName("entity");if(a&&a[0]){const r=a[0].firstChild;for(let i=0;i<t.length;i++)if(-1===n.indexOf(t[i])){const n=e.createElement("attribute");n.attributes.setNamedItem(l(e,"name",t[i])),a[0].insertBefore(n,r)}}}function m(e,t,n){let a='<link-entity name="'+e.name+'" from="'+e.from+'" to="'+e.to+'"';if(a+=e.linkType?' link-type="'+e.linkType+'"':"",a+=e.alias?' alias="'+e.alias+'"':"",0===t.length)return a+=" />",a;a+=">";for(let e=0;e<t.length;e++)a+='<attribute name="'+t[e]+'" />';if(!Object(r.a)(n)){a+=i.a.toLegacyFilterExpression(n).toFetchXml()}return a+="</link-entity>",a}function b(e,t){if(!Object(r.b)(t)){const n=e.getElementsByTagName("entity")[0];let a=!1;const i=o(t),s=e.getElementsByTagName("link-entity");if(!Object(r.a)(s)){const e=["alias","name","from","to","link-type"];for(let t=0;t<s.length;t++)if(e.every(e=>u(s[t],i.documentElement,e))){for(let e=0;e<i.documentElement.childNodes.length;e++)s[t].appendChild(i.documentElement.childNodes[e].cloneNode());a=!0}}a||Object(r.a)(n)||n.appendChild(i.documentElement)}}function y(e,t){const n=e.createElement("attribute");n.attributes.setNamedItem(l(e,"name",t)),n.attributes.setNamedItem(l(e,"rowaggregate","CountChildren")),n.attributes.setNamedItem(l(e,"alias","HierarchyDataChildCount6dcd9e4c001441b09237d51a34853d55")),e.getElementsByTagName("entity")[0].appendChild(n)}function _(e,t){if(!e)throw new Error("Invalid fetch xml document is passed");const n=Object(a.b)(t);e.getElementsByTagName("entity")[0].appendChild(n.firstChild)}function v(e,t,n){let r;if(-1===t.indexOf("."))r=e.getElementsByTagName("entity")[0];else{const n=t.split(".");if(2===n.length){r=S(e,n[0],t=n[1])}}if(r){const a=r.getElementsByTagName("order"),i=O(e,t,n);let o=!1;for(let e=0;e<a.length;e++)if(u(a[e],i,"attribute")){o=!0,a[e].setAttribute("descending",n?"true":"false");break}o||r.appendChild(i)}}function S(e,t,n){const r=e.getElementsByTagName("link-entity");for(let e=0;e<r.length;e++){const a=r[e];if(a.attributes.getNamedItem("alias")&&a.attributes.getNamedItem("alias").nodeValue===t){const e=a.childNodes;for(let t=0;t<e.length;t++){const r=e[t];if("attribute"===r.nodeName&&r.attributes.getNamedItem("name").nodeValue===n)return a}}}}function O(e,t,n){const r=e.createElement("order");return r.attributes.setNamedItem(l(e,"attribute",t)),r.attributes.setNamedItem(l(e,"descending",n.toString())),r}function C(e){const t=e.getElementsByTagName("order");for(;t.length;){const e=t[0];e.parentNode.removeChild(e)}}function E(e,t,n,r){return`<link-entity name="${e}" from="${t}" to="${n}" alias="bb">\n\t<filter type="and">\n\t\t<condition attribute="${r||t}" operator="eq" uitype="${e}" />\n\t</filter>\n\t</link-entity>`}function I(e,t,n,r,a,i){return`<link-entity name="${e}" intersect="true" visible="false" to="${t}" from="${i}">\n\t${E(r,a,n)}\n</link-entity>`}function w(e,t,n){if(!Object(r.b)(n)&&!Object(r.b)(t)){const a=e.getElementsByTagName("entity")[0],i=o(t),s=i.getElementsByTagName("condition")[0];Object(r.a)(s)||s.attributes.setNamedItem(l(i,"value",n)),Object(r.a)(a)||a.appendChild(i.firstChild)}}function j(e){const t=null==e?void 0:e.getElementsByTagName("fetch");if(!Object(r.a)(t)&&t.length>0&&!Object(r.a)(t[0])){const e=t[0].getAttribute("count");if(!Object(r.a)(e))return Number(e)}}function P(e){const t=null==e?void 0:e.getElementsByTagName("fetch");if(!Object(r.a)(t)&&t.length>0&&!Object(r.a)(t[0])){const e=t[0].getAttribute("page");if(!Object(r.a)(e))return Number(e)}}function T(e,t,n,a,i,o){Object(r.a)(e)||Object(r.a)(e.firstChild)||"fetch"!==e.firstChild.nodeName||(Object(r.a)(e.firstChild.attributes.getNamedItem("returntotalrecordcount"))&&e.firstChild.attributes.setNamedItem(l(e,"returntotalrecordcount",i.toString())),Object(r.a)(n)||e.firstChild.attributes.setNamedItem(l(e,"page",n.toString())),Object(r.a)(t)||e.firstChild.attributes.setNamedItem(l(e,"count",t.toString())),a&&e.firstChild.attributes.setNamedItem(l(e,"paging-cookie",a)),e.firstChild.attributes.setNamedItem(l(e,"no-lock",o.toString())))}function N(e){const t=e.getElementsByTagName("filter");if(!Object(r.a)(t))for(let e=0;e<t.length;e++)if(!Object(r.a)(s(t[e],"isquickfindfields")))return t[e];return null}function A(e){const t=new RegExp("{\\d}","g"),n=e.childNodes;for(let e=0;e<n.length;e++){const a=n[e];"condition"===a.nodeName&&((a.hasChildNodes()||!Object(r.a)(a.attributes.getNamedItem("value"))&&a.attributes.getNamedItem("value").nodeValue.match(t).length>0)&&(a.parentNode.removeChild(a),e--))}e.childNodes.length||e.parentNode.removeChild(e)}function R(e,t){return`\n\t\t\t\t<fetch version="1.0" output-format="xml-platform" mapping="logical" page="1" count="50">\n\t\t\t\t\t<entity name="${e}">\n\t\t\t\t\t\t<attribute name="${t}"/>\n\t\t\t\t\t\t<filter type="or" isquickfindfields="1">\n\t\t\t\t\t\t\t<condition attribute="${t}" operator="like" value="{0}" />\n\t\t\t\t\t\t</filter>\n\t\t\t\t\t</entity>\n\t\t\t\t</fetch>`}function D(e,t){if(e&&e.fetchXML){const n=o(e.fetchXML).getElementsByTagName("filter");for(let e=0;e<n.length;e++)n[e].attributes&&n[e].attributes.getNamedItem("isquickfindfields")&&t.getElementsByTagName("entity")[0].appendChild(n[e])}}function x(e,t){var n,r;if(!e||!t)return e;const i=Object(a.b)(e);if(!i)return e;const o=i.getElementsByTagName("attribute");if(!o.length)return e;for(let n=0;n<o.length;n++){const r=o[n];if("link-entity"===r.parentNode.nodeName)continue;if(r.attributes.getNamedItem("name").nodeValue===t&&!r.attributes.getNamedItem("rowaggregate"))return e}const s=i.getElementsByTagName("entity"),c=null===(n=s[0])||void 0===n?void 0:n.firstChild,u=i.createElement("attribute");u.attributes.setNamedItem(l(i,"name",t)),null===(r=s[0])||void 0===r||r.insertBefore(u,c);return(new XMLSerializer).serializeToString(i)}},TKDo:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * The unique name of the Inline Dialog page module.
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="InlineDialog"},TQVK:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("WLAV"),a=n("pEXn");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i={getName:()=>r.a,getRequiredAttributes(){throw new Error("Not Implemented")},createPageModule:e=>Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(7),n.e(10),n.e(4),n.e(5),n.e(6),n.e(9),n.e(8),n.e(11),n.e(12),n.e(13),n.e(14),n.e(15),n.e(156)]).then(n.bind(null,"L1d8")).then(({PowerBIFullScreen:t})=>new t(e)),getTelemetryAttributes:e=>[{name:a.b.PowerBIComponentTypeCode,value:e&&e.powerBIComponentTypeCode}]};Object.freeze(i);var o=n("D+Bz"),s=n("xagu");const c={type:o.a.Page,pageType:"powerbifullscreen",factory:i,urlToInput(e){let t,n,r,a,i,o,c;const l=e.searchParams;return l.has(s.M)&&l.get(s.M)&&(t=l.get(s.M)),l.has(s.N)&&l.get(s.N)&&(n=l.get(s.N)),l.has(s.L)&&l.get(s.L)&&(r=l.get(s.L)),l.has(s.Q)&&l.get(s.Q)&&(a=l.get(s.Q)),l.has(s.O)&&l.get(s.O)&&(i=l.get(s.O)),l.has(s.P)&&l.get(s.P)&&(o=l.get(s.P)),l.has(s.K)&&l.get(s.K)&&(c=l.get(s.K)),{powerBIEmbedUrl:t,powerBIGroupId:n,powerBIDashboardId:r,powerBITileId:a,powerBIReportId:i,powerBIReportUrl:o,powerBIComponentTypeCode:c}},inputToUrl(e,t){const n=new URL(e,window.location.origin),r=n.searchParams,a=t.powerBIEmbedUrl,i=t.powerBIGroupId,o=t.powerBIDashboardId,c=t.powerBITileId,l=t.powerBIReportId,u=t.powerBIReportUrl,d=t.powerBIComponentTypeCode;return a&&r.set(s.M,a),i&&r.set(s.N,i),o&&r.set(s.L,o),c&&r.set(s.Q,c),l&&r.set(s.O,l),u&&r.set(s.P,u),d&&r.set(s.K,d),n.href}};Object.freeze(c)},TRNQ:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var r=n("umme"),a=n("504W"),i=n("bRS5"),o=n("l3Ef"),s=n("Nnen"),c=n("Eua/"),l=n("2LZB"),u=n("thzq"),d=n("3ri3"),p=n("5qiD"),f=n("d+dp"),g=n("jZCH"),h=n("EW4s"),m=n("FZDd");class b{performOperations(e,t,n){const r=new h.a,a=new c.a,i=new s.a(a),o=this.prepareTransaction(a,i,e,t,n);return i.Commit(o).then(()=>{r.resolve(!0)},e=>{r.reject(e)}),r}prepareOperations(e,t,n){const r=new h.a,a=new c.a,i=new s.a(a),o=this.prepareTransaction(a,i,e,t,n);return g.a.get_DefaultInstance().get_LocalDataSource().get_offlineDataStore().prepareTransactionQueries(o).then(e=>{r.resolve(e)},e=>{r.reject(e)}),r}prepareTransaction(e,t,n,r,i){return t.begin(i),!Object(a.a)(r)&&r.length>0&&y(r,t),!Object(a.a)(n)&&n.length>0&&y(n,t),e.get_transaction()}retrieve(e,t){return(new c.a).retrieve(e,t)}generateUID(){return g.a.get_DefaultInstance().get_LocalDataSource().get_offlineDataStore().generateUID()}convertSQLiteResultsToEntityRecord(e,t,n,r,a){const i=new h.a;return g.a.get_DefaultInstance().get_Store().dispatch(Object(m.f)(n,!0,[],a)).then(()=>{const a=g.a.get_DefaultInstance().get_MetadataCache().getEntityMetadata(n);this._GetEntityRecord(n,a,e,t,r).then(e=>i.resolve(e),e=>i.reject(e))},e=>{i.reject(e)}),i}_GetEntityRecord(e,t,n,s,c){const l=new h.a;if(Object(a.a)(n)||Object(a.b)(n[t.get_primaryIdAttribute()]))l.resolve(null);else{const h=new Array(0);for(const e in n){const t={key:e,value:n[e]},r=t.key.toLowerCase();if(r.indexOf(d.u)<0&&r.toLowerCase()!==d.t.toLowerCase())if(r.indexOf(o.l)<0)h.push(t.key);else{const e=t.key.split(o.l),n=Object(a.b)(e[0])?"":e[0];Object(a.b)(n)||-1!==h.indexOf(n)||h.push(n)}}g.a.get_DefaultInstance().getAttributeTypes(e,h,null).then(e=>{const r=c!==u.a.Update?n:s,a=new f.a(p.a.NotCached,0);Object(i.a)(r,e,t,a,null,c===u.a.Update).then(t=>{Object(i.e)(t,e,c,n,s).then(e=>{t=e,l.resolve(t)},e=>{l.reject(e)})},e=>{l.reject(e)})},e=>{l.reject(r.a.FromMessage("Offline DB could not retrieve data"))})}return l}}function y(e,t){for(let n=0;n<e.length;n++){const r=e[n];if(r.get_operationPerformed()===u.a.Create){if(r.get_entity()instanceof Object){const e=r.get_entity();t.create(r.get_entityType(),e)}}else if(r.get_operationPerformed()===u.a.Delete){const e=r.get_entity();if(e){const n=new l.a(e);t.Delete(r.get_entityType(),n)}}else if(r.get_operationPerformed()===u.a.Update&&r.get_entity()instanceof Object){const e=r.get_entity();t.update(r.get_entityType(),e)}}}},TYIz:function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return y}));var r=n("dHD5"),a=n("i1f0"),i=n("Bo7t"),o=n("pEXn"),s=n("Ii8m"),c=n("jq7Z"),l=n("zI6t"),u=n.n(l),d=n("arV0"),p=n("SAYH"),f=n("zmL5"),g=n("y+Z1"),h=n("+Ajx"),m=n("+zjj");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const b="tab.selectformtab";function y(e,t,n){const l=Object(r.w)(n);return{type:"tab.selectformtab.sync",sync:!0,execute({dispatch:r,getState:y},v,S){const O=Object(a.Ec)(y(),{id:e},n);let C,E;const I=Object(c.b)(y(),e,n);if(I){const n=Object(a.sb)(y(),I,e);if(n)for(const e of n)(t===e.Id||e.RawTabId&&p.a.equals(p.a.tryParse(t),p.a.tryParse(e.RawTabId)))&&(E=e),O===e.Id&&(C=e.Name)}const w=Object(a.Tc)(y(),null==E?void 0:E.Id,e,n);if(O===(null==E?void 0:E.Id)||!1===w)return;!function(e,t,n){const r=Object(d.j)(e,t),a=p.a.toString(Object(f.b)(e,t)),i=null==r?void 0:r.entityTypeName;u.a.tagWorkBlock(g.a),u.a.addKeyPerformanceIndicatorOnIdle(g.a,{[o.b.FormId]:a,[o.b.EntityName]:i,[o.b.FormTabSwitch.TabName]:n})}(y(),e,null==E?void 0:E.Name),r({type:b,payload:!1,meta:{pageId:e,contextKey:l,tabId:null==E?void 0:E.Id}}),r({type:b,payload:!0,meta:{pageId:e,contextKey:l,tabId:O}});const j=v.ScriptManager.getContainer(e).getEventManager();_(r,j,n,C,v,S),_(r,j,n,null==E?void 0:E.Name,v,S),r(Object(s.a)(e,null==E?void 0:E.Id)),r(Object(i.b)(e,n,null==E?void 0:E.Id));const P=Object(m.e)(y(),{id:e},n);if(P&&P.isSelected){const t=Object.assign(Object.assign({},P),{isSelected:!1});r(Object(h.b)(e,n,t))}}}}function _(e,t,n,r,a,i){if(r)e(t.runOnTabStateChange(n,r));else{const e=[{name:"CorrelationId",value:i.correlationId},{name:"ContextId",value:i.contextId},{name:"ActionStack",value:i.stack}];a.TraceManager.getTracer(g.a).warn("Null/undefined tabName encountered.",e)}}},Tezb:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"f",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return s})),n.d(t,"e",(function(){return c}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="chart.retrieve",a="chart.odata.retrieve",i="chartselector.retrieve",o="chartData.retrieve",s="chartData.retrieve.core",c="chartData.retrieve.drillDown"},"Tf+h":function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return l})),n.d(t,"e",(function(){return r})),n.d(t,"g",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"f",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"i",(function(){return d})),n.d(t,"l",(function(){return p})),n.d(t,"h",(function(){return f})),n.d(t,"j",(function(){return g})),n.d(t,"k",(function(){return u}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="set.field.personalization",a="set.grid.personalization",i="set.dashboard.personalization",o="set.generic.personalization",s="set.control.global.personalization",c="dashboard",l="!newrecordid";function u(e,t){return{type:s,payload:{[e]:t},meta:{lastPropertyKey:e}}}function d(e,t,n){const{entityTypeName:a,recordGuid:i,formGuid:o,controlUniqueId:s,viewId:c="default"}=e;let u=null,d=i&&i.guid;return n&&(d=d||l),d&&o&&(u={[a]:{[d]:{[o.guid]:{[s]:{[c]:t}}}}}),{type:r,payload:u,meta:{lastPropertyKey:c,pageId:n}}}function p(e,t,n){const{entityTypeName:r,viewId:i="default"}=e;return{type:a,payload:{[r]:{[i]:t}},meta:{lastPropertyKey:i,pageId:n}}}function f(e,t,n){const{formGuid:r,controlUniqueId:a,viewId:o="default"}=e;return{type:i,payload:{[c]:{[r.guid]:{[a]:{[o]:t}}}},meta:{lastPropertyKey:o,pageId:n}}}function g(e,t,n){return{type:o,payload:{[e]:t},meta:{lastPropertyKey:e,pageId:n}}}},Tsbx:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i}));var r=n("504W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e){return Object(r.a)(e)?[]:"String"in e?o(e.String):"values"in e&&e.hasOwnProperty("values")?o(e.values):o(e)}function i(e,t){let n=e.length;for(let e=0;e<t.length;++e)t[e]instanceof String&&(n+=t[e].length);return n}function o(e){const t=[];if("length"in e){const n=e;for(let e=0;e<n.length;e++)t.push(n[e])}else t.push(e);return t}},Tz6o:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"d",(function(){return c})),n.d(t,"f",(function(){return l})),n.d(t,"e",(function(){return u})),n.d(t,"c",(function(){return d}));var r=n("lq82"),a=n("Lyxw"),i=n("3/02");const o="page.updateInput",s="input";function c(e,t){return{type:o+".wrapper",sync:!0,execute:({dispatch:n})=>{n(l(e,t)),n(u(e,t))}}}function l(e,t){return{type:o,payload:{input:e},meta:{pageId:t}}}function u(e,t){return{type:o+"InHistory",sync:!0,execute:({getState:n,dispatch:o})=>{Object(a.f)(n(),i.Yf)&&o(Object(r.b)(s,e,t))}}}function d(e){return{type:"page.getInputFromHistory",sync:!0,execute:({getState:t,dispatch:n})=>{if(!Object(a.f)(t(),i.Yf))return null;return n(Object(r.a)(s,e))}}}},Tzp9:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){var e=this;this._hidden="hidden",this._visibilityChange="visibilitychange",this._firstGoneIntoBackgroundTimeSinceLastIdle=-1;void 0!==document.webkitHidden&&(this._hidden="webkitHidden",this._visibilityChange="webkitvisibilitychange"),document.addEventListener(this._visibilityChange,(function(){-1===e._firstGoneIntoBackgroundTimeSinceLastIdle&&document[e._hidden]&&(e._firstGoneIntoBackgroundTimeSinceLastIdle=performance.now())}))}return e.prototype.resetTracking=function(){this._firstGoneIntoBackgroundTimeSinceLastIdle=-1},e.prototype.firstGoneIntoBackgroundTimeSinceLastIdle=function(){return this._firstGoneIntoBackgroundTimeSinceLastIdle},e}();t.default=r},"UAw+":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("h6c1"),a=n("7NKF");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function i(e){const t=Object(r.a)(e,a.b);return!!(null==t?void 0:t.ShouldReloadOnNavigate)}},UDbe:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("NMtn");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class a{constructor(e){this._path=null,Object(r.c)(e,"path"),this._path=e}get_path(){return this._path}getField(e){const t=this._path.split(".");let n=e;for(let e=0;e<t.length&&n;++e)n=n[t[e]];return n}static get_id(){return i}}const i=new a("id")},UGwp:function(e,t,n){"use strict";n.d(t,"a",(function(){return S}));var r=n("37s6"),a=n("o1og"),i=n("pEXn"),o=n("iF9X"),s=n("SZCI"),c=n("jZCH"),l=n("yRo8"),u=n("ml6Y"),d=n("eZ32"),p=n("lMS8"),f=n("/BiW"),g=n("fMBw"),h=n.n(g),m=n("Rj8P"),b=n("E5IU"),y=n("xnzJ"),_=n("t9aj"),v=n("JEu3");function S(){return{type:"apply.application.metadata.changes.async",execute({dispatch:e,getState:t},n){const g=t();if(Object(b.r)(g)?Object(r.l)(g)&&Object(r.a)(g):Object(r.a)(g)){e(Object(a.e)(!0));const b=n.TraceManager.getTracer(f.b),S=[];S.push({name:i.b.IsApplicationMetadataDownloadInShimEnabled,value:Object(o.e)(t())}),S.push({name:i.b.OfflineStatus,value:Object(r.w)(t())}),S.push({name:u.a.IsOfflineFirstTimeSyncCompletedKey,value:Object(r.q)(t())}),b.warn(`'${f.a}}' started applying changes`,S);const O=h.a.createEvent(f.a,s.D).startStopwatch();return c.a.get_DefaultInstance().applyApplicationMetadataChanges().nativePromise().then(o=>{if(e(Object(a.d)(false)),Object(l.j)(n,u.a.OfflineApplyApplicationMetadataChangesKey,false),e(Object(a.e)(!1)),S.push({name:u.a.OfflineApplyApplicationMetadataChangesKey,value:Object(r.a)(g)}),Object(r.r)(t())||c.a.get_DefaultInstance().createActivityPointerAndAttachmentView(),O(),b.warn(`'${f.a}' done applying changes`,S),!Object(r.k)(t())){const o=!0;return e(Object(a.f)(o)),Object(l.j)(n,u.a.IsFirstApplyApplicationMetadataChangesDoneKey,o),S.length=0,S.push({name:u.a.IsFirstApplyApplicationMetadataChangesDoneKey,value:o}),b.warn(`'${f.a}' first apply application metadata changes done`,S),n.OfflineProvider.calculateDisabledOfflineEntities().nativePromise().then(()=>{b.warn("OfflineSync: Offline Sync.MetadataValidation is completed"),e(Object(y.b)(!0)),Object(l.j)(n,u.a.IsFirstTimeMetadataValidationCompletedKey,!0);if(Object(r.l)(t())){e(Object(_.b)(!0)),Object(l.j)(n,u.a.IsOfflineFirstTimeSyncCompletedKey,!0),e(Object(m.c)(d.a.Available,0)),S.push({name:i.b.OfflineStatus,value:d.a.Available}),b.warn(`'${f.a}' offline set status to Available`,S);const a=Object(r.i)(t());a&&e(Object(v.b)(!0)),e(Object(p.c)(a)),S.push({name:u.a.IsOfflineFirstTimeSyncCompletedKey,value:!0}),b.warn(f.a+" Offline Sync Completed toast notification triggered",S)}},e=>{b.warn("Sync.MetadataValidation Error: "+e.get_Message())})}}).catch(t=>{throw e(Object(a.e)(!1)),O(),b.error(`'${f.a}}' error: ${t.message}`,S),t})}return Promise.resolve()}}}},UIlN:function(e,t,n){"use strict";function r(e){return e&&e.commands}function a(e,t){const n=r(e);return n&&t&&n[t]}function i(e){const t=r(e);return!t||!1!==t.perfRenderCmdBar}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return i}))},UJfx:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"c",(function(){return l})),n.d(t,"b",(function(){return u}));var r=n("SAYH"),a=n("LbMF"),i=n("5Oca"),o=n("IqkD"),s=n("qLnS");function c(e,t,n,r){const i=Object(a.a)(e,t,r);if(!i)return null;const c=(i.IsValidForCreate?s.a.CanCreate:s.a.None)|(i.IsValidForRead?s.a.CanRead:s.a.None)|(i.IsValidForUpdate?s.a.CanUpdate:s.a.None);let u=s.a.None;if(i.IsSecured){const a=Object(o.n)(e);if(!a)return null;const d=a[i.Id.guid];if(d&&(u=d.attributeAccessRights),u&s.a.CanRead&&u&s.a.CanUpdate)u=d.attributeAccessRights;else{const a=l(e,t,n.guid,r);a&&(u|=a.accessRightsMask)}u&=c}else u=c;return{attributeId:i.Id,canCreate:!!((d=u)&s.a.CanCreate),canRead:!!(d&s.a.CanRead),canUpdate:!!(d&s.a.CanUpdate),accessRightsMask:d};var d}function l(e,t,n,o){var s;const c=Object(i.i)(e,t),l=null===(s=Object(a.a)(e,t,o))||void 0===s?void 0:s.Id;return c&&n&&o&&c.hasOwnProperty(n)&&c[n].accessRights&&c[n].accessRights.attributePrivileges&&c[n].accessRights.attributePrivileges[r.a.toString(l)]?e.data.entities[t][n].accessRights.attributePrivileges[r.a.toString(l)]:null}function u(e,t,n){const r=Object(i.i)(e,t);return r&&n&&r.hasOwnProperty(n)&&r[n].accessRights&&r[n].accessRights.recordPrivileges?e.data.entities[t][n].accessRights.recordPrivileges:null}},UKgB:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class r{getMetadata(){return{boundParameter:null,operationName:"GetClientMetadata",operationType:1,parameterTypes:{ClientMetadataQuery:{typeName:"Microsoft.Dynamics.CRM.MetadataQuery",structuralProperty:2}}}}}},"UMB/":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return o}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="processid",a="activestageid",i="traversedpath",o="stageid"},UZFl:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * The unique name of the Apps page module.
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="Apps"},Ua4i:function(e,t,n){"use strict";function r(e){return e.globalNotifications}function a(e,t){return e.globalNotifications[t]}function i(e){const t=r(e);return t?Object.keys(t):[]}n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}))},UqMU:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"e",(function(){return c})),n.d(t,"c",(function(){return l})),n.d(t,"b",(function(){return u})),n.d(t,"d",(function(){return d}));var r=n("txA/"),a=n("2qKp"),i=n("31Vn"),o=n("WkRo");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function s(e,t,n){return Object.assign({type:r.a,payload:{browsingContextId:e,state:t,url:n}},Object(a.a)(e,[{name:"browsingContextId",value:e},{name:"state",value:JSON.stringify(t)},{name:"url",value:Object(i.a)(n)}]))}function c(e,t,n){return Object.assign({type:r.cb,payload:{browsingContextId:e,state:t,url:n}},Object(a.a)(e,[{name:"browsingContextId",value:e},{name:"state",value:JSON.stringify(t)},{name:"url",value:Object(i.a)(n)}]))}function l(e){return Object.assign({type:r.b,payload:{browsingContextId:e}},Object(a.a)(e,[{name:"browsingContextId",value:e}]))}function u(e){return{type:r.e,sync:!0,execute({dispatch:t},n){t(function(e){return Object.assign({type:r.d,payload:{browsingContextId:e}},Object(a.a)(e,[{name:"browsingContextId",value:e}]))}(e)),t(Object(o.c)(e))}}}function d(e,t){return Object.assign({type:r.bb,payload:{browsingContextId:e,history:t}},Object(a.a)(e,[{name:"browsingContextId",value:e}]))}},UuF9:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return u}));var r=n("uNu9");const a="Mscrm.AssignSelectedRecord",i="Mscrm.SendShortcutSelected.AlwaysEnabled",o="Mscrm.ShareSelectedRecord",s={account:[a,i,o],contact:[a,i,o],appointment:["Mscrm.SaveAsCompleted","Mscrm.SaveAsCancelled",i,a,"Mscrm.SetRegardingForSelected"],task:["Mscrm.SaveAsCompleted",a,"Mscrm.SaveAsCancelled",i,"Mscrm.SetRegardingForSelected"],phonecall:["Mscrm.SaveAsCompleted",a,"Mscrm.SaveAsCancelled",i,"Mscrm.SetRegardingForSelected"],email:["Mscrm.SaveAsCancelled","Mscrm.SetRegardingForSelected",o,i],queue:[a,o],queueitem:["Mscrm.HomepageGrid.queueitem.Pick","Mscrm.HomepageGrid.queueitem.Release","Mscrm.HomepageGrid.queueitem.RemoveLeo","Mscrm.HomepageGrid.queueitem.Route","Mscrm.HomepageGrid.queueitem.QueueItemDetail"],lead:[a,o,i],opportunity:[a,o,i]},c=[a,i,o];function l(e,t){return s[e]||t&&c||[]}function u(e,t){if(e&&t){return l(e.ContextEntityLogicalName===r.b?e.ActivityEntityLogicalName:e.ContextEntityLogicalName,!1).some(e=>e===t)}return!1}},Uv1Y:function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"c",(function(){return y})),n.d(t,"b",(function(){return b})),n.d(t,"d",(function(){return _})),n.d(t,"f",(function(){return h})),n.d(t,"g",(function(){return v})),n.d(t,"e",(function(){return g}));var r=n("YxC/"),a=n("zsAz"),i=n("umme"),o=n("7Gx7"),s=n("WWXV"),c=n("JdSN"),l=n("504W"),u=n("E8F2");function d(e){const t=Object.getOwnPropertyNames(f.prototype);for(const n of t){const t=Object.getOwnPropertyDescriptor(f.prototype,n);Object.defineProperty(e,n,t)}}function p(e,t,...n){let a=Object(r.b)(e,function(e){let t=e;return Object(l.a)(e)?null:(t<0&&(t=t+4294967295+1),"Error_Message_0x"+t.toString(16))}(t));return a||(a=Object(r.b)(e,f.DEFAULT_ERROR_MESSAGE_ID)),n?String.format(a,n):a}class f{constructor(e,t,n,r,i,o,s,c,l,p,h,m=!1,b=-1,y=null,_,v,S,O,C,E={}){const I=t||f.DEFAULT_ERROR_CODE,w=(j=e,(-2147220891===g(I)?j:null)||p);var j;const P=Object(a.d)(e,I,c,l,w,h,m,E);return P.message||(P.message=I.toString()),P.errorParameters||(P.errorParameters=[]),s&&P.errorParameters.push({name:"ErrorDetails",value:s}),o&&(Object(u.e)(P)||P.errorParameters.push({name:"ErrorFault",value:o})),i&&P.errorParameters.push({name:"ErrorSource",value:i}),n&&P.errorParameters.push({name:"Exception",value:n.message}),h&&P.errorParameters.push({name:"ErrorStack",value:h}),P._errorSource=i||f.DEFAULT_ERROR_SOURCE,P._exception=n,P._innerError=r,P._errorFault=o,P._details=s,P.blockErrorReporting=m,P.faultedRequestIndex=b,P.faultedSnapshotId=y,P.httpStatusCode=_,P.clientRequestId=v,P.serverResponseId=S,P.retryAfter=O,P.date=C,P._errorAnnotations=E,d(P),P}static fromErrorCode(e,t,...n){const r=p(e,t,n);return new f(r,t)}static fromExistingError(e){const t=e;return t.name||(t.name=a.a),void 0===t.errorCode&&(t.errorCode=f.DEFAULT_ERROR_CODE),void 0===t.blockErrorReporting&&(t.blockErrorReporting=!1),void 0===t.faultedRequestIndex&&(t.faultedRequestIndex=-1),void 0===t._errorSource&&(t._errorSource=f.DEFAULT_ERROR_SOURCE),d(t),t}static createEmpty(){return new f("ErrorStatus created with no information",this.DEFAULT_ERROR_CODE)}static toLegacyErrorStatus(e){if(!e)return null;const t=i.a.FromMessage(e.message,null);return t.set_ErrorCode(e.errorCode),t.set_ErrorFault(e.errorFault),t.set_Exception(e.exception),t.set_Stack(e.stack),t.set_InnerError(f.toLegacyErrorStatus(e.innerError)),t.set_BlockErrorReporting(e.blockErrorReporting),t.set_isRequestTooLong(e.isRequestTooLong),t}static fromLegacyErrorStatus(e,t){if(!e)return null;let n=e.get_Stack();if(!n){const t=e.get_ErrorFault();t&&t.get_innerFault()&&(n=t.get_innerFault().get_callStack())}const r=e.get_ErrorCode();let a=e.get_Message();Object(l.b)(a)&&null!=t&&(a=p(t,r));let i=-1;void 0!==e.get_FaultedRequestIndex&&(i=e.get_FaultedRequestIndex());const o=new f(a,r,e.get_Exception(),f.fromLegacyErrorStatus(e.get_InnerError()),e.get_ErrorSource(),e.get_ErrorFault(),n,null,null,null,n,e.get_BlockErrorReporting(),i,null,e.get_HttpStatusCode(),e.get_ClientRequestId(),e.get_ServerResponseId(),e.get_RetryAfter(),e.get_Date(),e.get_ErrorFault()?e.get_ErrorFault().get_annotations():null);return o._isRequestTooLong=e.get_isRequestTooLong(),o}static fromCrmErrorResponse(e){var t;if(!e)return null;const n=e.get_organizationServiceFault(),r=new f(n.get_message(),n.get_errorCode(),null,f.fromOrganizationServiceFault(n.get_innerFault()),null,null,null,null,null,null,n.get_callStack(),null,null,null,null===(t=e.get_request())||void 0===t?void 0:t.status,e.get_clientRequestId(),e.get_serverResponseId(),e.get_retryAfter(),e.get_date(),n.get_annotations());return r._isRequestTooLong=e.get_isRequestTooLong(),r}static fromOrganizationServiceFault(e){return e?new f(e.get_message(),e.get_errorCode(),null,f.fromOrganizationServiceFault(e.get_innerFault()),null,null,null,null,null,null,e.get_callStack(),null,null,null,null,null,null,null,null,e.get_annotations()):null}get errorFault(){return this._errorFault}get details(){return this._details}get exception(){return this._exception}get innerError(){return this._innerError}get errorSource(){return this._errorSource}set errorSource(e){this._errorSource=e}get errorAnnotations(){return this._errorAnnotations}get isRequestTooLong(){return this._isRequestTooLong}get localizedMessage(){if(this.message){const e=/, Error details: (.*)$/gi.exec(this.message);if(e&&e.length>1){const t=e[1];return"'"===t[0]&&"'"===t[t.length-1]?t.substring(1,t.length-1):t}}return null}containsErrorCode(e){return this.getNegativeErrorCode()===e||!!this._innerError&&this._innerError.containsErrorCode(e)}getNegativeErrorCode(){return g(this.errorCode)}}function g(e){let t=e;return e>0&&(t=~~e),t}function h(e){const t=function(e){e||(e=f.createEmpty());return{errorcode:e.errorCode,message:e.message}}(e);return e.innerError&&(t.innererror=h(e.innerError),t.details=e.innerError.message),new o.a(t)}function m(e){return void 0!==e.get_Message}function b(e){throw y(e)}function y(e){return e?m(e)?f.fromLegacyErrorStatus(e):function(e){return void 0!==e.get_organizationServiceFault}(e)?f.fromCrmErrorResponse(e):e instanceof Error?f.fromExistingError(e):e:f.createEmpty()}function _(e){if(e){if(m(e))return f.fromLegacyErrorStatus(e).message;if(e instanceof c.a)return e.get_error();if(e instanceof Error)return e.message}return"An error occured while processing the request. Please try again later"}function v(e){return e&&e.containsErrorCode&&(e.containsErrorCode(-2147209463)||e.containsErrorCode(-2147209460)||e.containsErrorCode(-2147220692)||e.containsErrorCode(-2147093995)||e.containsErrorCode(-2147220960)||e.containsErrorCode(-2146088112)||e.containsErrorCode(-2147220955)||e.containsErrorCode(-2147167669)||e.containsErrorCode(-2147015328)||e.containsErrorCode(-2147180284)||e.containsErrorCode(-2147094001)||e.containsErrorCode(-2147180269))}f.DEFAULT_ERROR_MESSAGE_ID="Error_Message_Generic_Mobile_Client",f.DEFAULT_ERROR_CODE=0,f.DEFAULT_ERROR_SOURCE=s.a.Unknown},UvHz:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n("rhTL"),a=n("ju1h");function i(){let e=document.querySelector("[role=main]:not([aria-hidden=true])");e||(e=document.querySelector("[role=complementary]:not([aria-hidden=true])")),e&&o(e)}function o(e){Object(r.a)(e,e.firstChild,!0).then(t=>{if(!t){if(e.querySelector("iframe[id=FullPageWebResource]")){return void e.querySelector("iframe[id=FullPageWebResource]").contentWindow.focus()}if(e.querySelector(`iframe[data-${a.q}=true]`)){e.querySelector(`iframe[data-${a.q}=true]`).contentWindow.focus()}}})}},UwOy:function(e,t,n){"use strict";n.d(t,"h",(function(){return g})),n.d(t,"d",(function(){return h})),n.d(t,"e",(function(){return m})),n.d(t,"f",(function(){return b})),n.d(t,"g",(function(){return y})),n.d(t,"c",(function(){return d})),n.d(t,"b",(function(){return p})),n.d(t,"a",(function(){return u}));var r=n("w1eR"),a=n("OEF1"),i=n("GYEz"),o=n("4leG"),s=n("Lyxw"),c=n("3/02"),l=n("4N6w");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const u="Embedded";function d(e){switch(e){case r.a.Browser:return"Browser";case r.a.MobileApplication:return"MobileApplication";case r.a.MailApp:return"MailApp"}return""}function p(e){const t=Object(a.e)(e);if(t)return t;const n=Object(i.a)(e);return function(e){return f()&&e===r.a.Browser}(n)?u:d(n)}function f(){try{return window.top!==window.self}catch(e){return!0}}function g(e){return Object(o.c)(e)||f()}function h(e){return Object(s.f)(e,c.sh)}function m(e){return h(e)&&!Object(l.b)(e)}function b(e){return h(e)&&Object(l.b)(e)}function y(e){return Object(o.c)(e)&&Object(s.f)(e,c.sh)&&!Object(l.a)(e)}},UyLX:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.Local=0]="Local",e[e.Remote=1]="Remote"}(r||(r={}))},V482:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));class r{constructor(e,t,n){this._fault=null,this._requestIndex=0,this._response=null,this._fault=e,this._requestIndex=t,this._response=n}get_fault(){return this._fault}get_requestIndex(){return this._requestIndex}get_response(){return this._response}}},V6aM:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("K7RF"),a=n("Uv1Y"),i=n("/oKV"),o=n("iJGp");function s(e){return{type:"webresource.retrieve.async",execute:({dispatch:t,getState:n},s)=>t(function(e,t=i.a.Local){return{type:"webresource.retrieve.async",execute:({dispatch:n,getState:i},s)=>n(Object(r.b)("webresource",null,null,null,!1,o.a.OnDemandWithoutContext,null,null,[e],null,t)).catch(a.b)}}(e)).then(e=>{if(e.webResourcesContent&&e.webResourcesContent.length)return e.webResourcesContent[0]})}}},"VA/h":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("EW4s");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e){return(new r.a).allArray(e)}},VCkP:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("IpQH"),a=n("uM6Y"),i=n("VkXQ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class o extends r.a{constructor(e,t){super(e,t,a.k)}authenticate(e){return this.execute(i.k.authenticate.name,e)}beginSecureSessionForAuthFlow(e,t,n,r){return this.execute(i.k.beginSecureSessionForAuthFlow.name,e,t,n,r)}beginSecureSessionForResourceSilent(e,t,n){return this.execute(i.k.beginSecureSessionForResource.name,e,t,n)}beginSecureSessionForResource(e,t,n){return this.execute(i.k.beginSecureSessionForResourceWithPrompt.name,e,t,n)}signOut(e,t){return this.execute(i.k.signOut.name,e,t)}reconfigure(){return this.execute(i.k.reconfigure.name)}handleAuthError(){return this.execute(i.k.handleAuthError.name)}}},VDDv:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("IpQH"),a=n("NjDY"),i=n("uM6Y"),o=n("VkXQ"),s=n("d5d1"),c=n("CEpr"),l=n("H4dV");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class u extends r.a{constructor(e,t){super(e,t,i.h)}takePicture(e={}){const t=this._checkArgs(e);if(t)return t;const n=this._getTransformedImageOptions(e);return this.execute(o.h.takePicture.name,"TakePicture",n)}captureVideo(e={}){const t=this._getTransformedVideoOptions(e);return this.execute(o.h.captureVideo.name,"CaptureVideo",t)}captureAudio(e={}){const t=this._getTransformedAudioOptions(e);return this.execute(o.h.captureAudio.name,"CaptureAudio",t)}_checkArgs(e){const t=[];return function(){const t=r(e.width),n=r(e.height);return t!==n;function r(e){return null!=e&&e>=0}}()&&t.push("Both width and height should be defined or undefined"),void 0!==e.quality&&(e.quality<=0||e.quality>100)&&t.push("Quality should be in (0, 100]"),t.length>0?Promise.reject(t.join("\n")):null}_getOrgMaxUploadFileSize(){const e=this.applicationStore.getState();return Object(a.D)(e).maxUploadFileSize}_getTransformedVideoOptions(e){return{useBinaryReader:!!(null==e?void 0:e.useBinaryReader),maxUploadFileSize:(null==e?void 0:e.maximumAllowedFileSize)||this._getOrgMaxUploadFileSize()}}_getTransformedAudioOptions(e){return{useBinaryReader:!!(null==e?void 0:e.useBinaryReader),maxUploadFileSize:(null==e?void 0:e.maximumAllowedFileSize)||this._getOrgMaxUploadFileSize()}}_getTransformedImageOptions(e){const t=this.applicationStore.getState(),n=l.a.getInstance(),r=this._getImageResolutionValue(Object(s.b)(t)),a=this.applicationContext.TraceManager.getTracer();let i=e.width,o=e.height,c=e.allowEdit;return void 0===i&&void 0===o&&(i=r.width,o=r.height),void 0===i&&void 0===o||(n.get_IsAndroid()?(c=!0,!1===e.allowEdit&&a.warn("allowEdit overwritten, allowEdit has to be true for android devices to apply given height and width to Cordova Plugin.")):n.get_IsIOS()&&(c=!1,e.allowEdit&&a.warn("allowEdit overwritten, allowEdit has to be false for IOS devices to apply given height and width to Cordova Plugin."))),{targetHeight:o,targetWidth:i,allowEdit:c,quality:e.quality,cameraDirection:e.preferFrontCamera?1:0,saveToPhotoAlbum:Object(s.f)(t),useBinaryReader:!!e.useBinaryReader,maxUploadFileSize:e.maximumAllowedFileSize}}_getImageResolutionValue(e){switch(e){case c.a.Res1024x768:return{height:768,width:1024};case c.a.Res1600x1200:return{height:1200,width:1600};case c.a.Res2048x1536:return{height:1536,width:2048};case c.a.Res2592x1936:return{height:1936,width:2592};case c.a.Res640x480:return{height:480,width:640};case c.a.DeviceDefault:default:return{height:void 0,width:void 0}}}}},VIXY:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e,t,n,r,a,i){return String.format(e,t,n,r,a,i)}n.d(t,"a",(function(){return r}))},VJBm:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("M1jQ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class a extends r.a{constructor(e){super(),this._dataAccessLayer=null,this.set_dataAccessLayer(e)}get_dataAccessLayer(){return this._dataAccessLayer}set_dataAccessLayer(e){return this._dataAccessLayer=e,e}}},VJwX:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}));var r=n("g73c"),a=n("504W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function i(e){return Object(a.b)(e)?"":e.indexOf(":")<0?e:e.substr(e.indexOf(":")+1)}function o(e,t){const n=Object(r.c)(e,t);return n.charAt(0).toString().toUpperCase()+n.substr(1)}},VKaO:function(e,t,n){"use strict";var r,a;Object.defineProperty(t,"__esModule",{value:!0}),t.setUCIPerformanceDataCollectionURL=t.getUCIPerformanceDataCollectionURL=t.getPerformanceAutomationConfig=void 0,t.getPerformanceAutomationConfig=function(){var e=window.PerformanceAutomationConfig;return null!=e&&a!==e&&(a=e,r=e),null==r&&(r={scenarioConfigs:[]}),r},t.getUCIPerformanceDataCollectionURL=function(){return window.UCIPerformanceDataCollectionUrl},t.setUCIPerformanceDataCollectionURL=function(e){window.UCIPerformanceDataCollectionUrl=e}},VKvO:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n("/D1P");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="offline.upsync.completed";function i(){const e={upSyncStatus:r.a.Completed};return{type:a,payload:e}}},VMrH:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s}));var r=n("pF61"),a=n("3/02"),i=n("Lyxw");const o="store.page.data";function s(e,t){return{type:"store.page.data.sync",sync:!0,execute({dispatch:n,getState:s}){if(!Object(r.g)(s())&&Object(i.f)(s(),a.vg)&&Object(i.f)(s(),a.tg)){const a=Array.from(t);n(function(e,t){return{type:o,payload:{dataInput:t},meta:{pageId:e}}}(Object(r.b)(s())||Object(r.c)(s()),{type:e,parameters:a}))}}}}},VS6r:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("SNT6"),a=function(){function e(){this._buffer=[]}return e.prototype._WriteByte=function(e){this._buffer.push(r.Number._ToByte(e))},e.prototype._Write=function(e,t,n){for(;n--;)this._WriteByte(e[t++])},e.prototype._GetBuffer=function(){return this._buffer},e}();t.MemoryStream=a},VWP5:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("0nOn"),a=n("ZIjf"),i=n("E7fB");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
let o;class s{constructor(e,t,n,a,i,s,c){this._sharedVariables={},o=e,this._clientApiExecutor=new r.a(o,"ClientApi.ExecutionContext.",t),this._eventSource=n,this._depth=a,this._eventArgs=i,this._pageId=t,this._formContext=s,c&&(this._sharedVariables=c._sharedVariables)}getContext(){return this._clientApiExecutor.execute("getContext",()=>(this._context||(this._context=new i.a(o,this._pageId)),this._context))}getDepth(){return a.a.instance.reportUsage("ClientApi.ExecutionContext.getDepth"),this._depth}getEventArgs(){return a.a.instance.reportUsage("ClientApi.ExecutionContext.getEventArgs"),this._eventArgs}getEventSource(){return a.a.instance.reportUsage("ClientApi.ExecutionContext.getEventSource"),this._eventSource}getFormContext(){return a.a.instance.reportUsage("ClientApi.ExecutionContext.getFormContext"),this._formContext}getSharedVariable(e){return a.a.instance.reportUsage("ClientApi.ExecutionContext.getSharedVariable"),this._sharedVariables[e]}setSharedVariable(e,t){a.a.instance.reportUsage("ClientApi.ExecutionContext.setSharedVariable"),this._sharedVariables[e]=t}}},"VX+W":function(e,t,n){"use strict";n.d(t,"a",(function(){return h})),n.d(t,"b",(function(){return m}));var r=n("g0tL"),a=n("Uv1Y"),i=n("eXjw"),o=n("hIjC"),s=n("K7RF"),c=n("ueZM"),l=n("TBkx"),u=n("y60j"),d=n("/oKV"),p=n("iJGp"),f=n("sYIp"),g=n("4leG");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const h="dialog.retrieve";function m(e,t){return{type:"dialog.retrieve.async",execute({dispatch:n,getState:m},b){let y=d.a.LocalAndRemote;const _=b.TraceManager.getTracer(Object(o.d)()),v=Object(o.c)()+".RetrieveDialog";if(!e){const e="Retrieve Dialog Failed: uniqueName is not provided";return _.error(e),b.EventManager.ReportComponentFailure(v,Error(e)),Promise.reject(new a.a(e))}const S=m(),O=[{name:"UniqueName",value:e}],C=Object(o.b)(S,e);if(C===i.a.Initialized&&Object(s.e)(S,Object(o.a)(S,e).overallVersionNumber)&&(y=d.a.Remote),C===i.a.Uninitialized||C===i.a.Initializing||y!==d.a.LocalAndRemote){_.info(`Dialog ${e} is not in the state, will be fetched from the server.`),n(function(e){const t=e?{[e]:{initialized:i.a.Initializing}}:null;return{type:h,payload:{dialogs:t}}}(e.toLowerCase()));return n(function(e){return{type:"dialog.retrieve.async",execute:({dispatch:t,getState:n},i)=>Object(g.e)(n())?Object(f.b)().then(({retrievePreviewDialogDescriptor:n})=>t(n(e))):t(Object(s.b)("dialog",null,null,null,!1,p.a.OnDemandWithoutContext,null,null,[e],r.b.Dialog,d.a.LocalAndRemote)).catch(a.b)}}(e)).then(r=>{const i=r&&r.dialogs?r.dialogs[e.toLowerCase()]:null;i?(_.info(`Received metadata response for dialog ${e} from server.`),b.EventManager.ReportComponentSuccess(v,O)):_.warn(`Dialog ${e} not found in metadata response.`);const o=i&&i.formId?i.formId:null;return o?n(Object(c.a)(o,t)).then(()=>o,a.b):o}).catch(t=>{const n=Object(l.e)(t,_);!n.stack&&(n.stack="No stack available.");const r=`Error retrieving dialog ${e}: Name: ${n.name}, Message: ${n.message}, Stack: ${n.stack} `;_.error(r);const a=[];throw a.push({name:"DialogName",value:e}),b.EventManager.ReportComponentFailure(v,n,null,a),t})}_.info(`Dialog ${e} found in the state.`),b.EventManager.ReportComponentSuccess(v,O);const E=Object(o.a)(S,e).formId,I=Object(u.h)(S,E);if(I&&!I.AreLabelsSubstituted)return n(Object(c.a)(E,t)).then(()=>E,a.b);if(!I){const e="FormId not found in the state : "+(E?E.guid:null),t=new Error(e);return Promise.reject(t)}return Promise.resolve(E)}}}},VgPQ:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));const r="page.unmounted";function a(e,t){return{type:r,payload:{isPageUnmounted:t},meta:{pageId:e}}}},VkXQ:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"e",(function(){return o})),n.d(t,"f",(function(){return s})),n.d(t,"g",(function(){return c})),n.d(t,"h",(function(){return l})),n.d(t,"i",(function(){return u})),n.d(t,"k",(function(){return d})),n.d(t,"d",(function(){return f})),n.d(t,"j",(function(){return p}));const r={ready:{name:"ready"},initialized:{name:"initialized"},bootError:{name:"bootError"},reloadWebView:{name:"reloadWebView"}},a={openARViewer:{name:"openARViewer",platformFeatureDependencies:["camera"]}},i={getBarcodeValue:{name:"getBarcodeValue",platformFeatureDependencies:["camera"]}},o={isFeedbackFormSupported:{name:"isFeedbackFormSupported"},openFeedbackForm:{name:"openFeedbackForm"}},s={openFile:{name:"openFile"},pickFile:{name:"pickFile"}},c={getCurrentPosition:{name:"getCurrentPosition",platformFeatureDependencies:["geolocation"]}},l={takePicture:{name:"takePicture",platformFeatureDependencies:["camera"]},captureVideo:{name:"captureVideo",platformFeatureDependencies:["video"]},captureAudio:{name:"captureAudio",platformFeatureDependencies:["microphone"]}},u={openUri:{name:"openUri"},updateBackBehavior:{name:"updateBackBehavior"},canOpenUri:{name:"canOpenUri"},openAuthPopup:{name:"openAuthPopup"},switchApp:{name:"switchApp"},navigateBackOutOfApp:{name:"navigateBackOutOfApp"}},d={authenticate:{name:"authenticate"},beginSecureSessionForAuthFlow:{name:"beginSecureSessionForAuthFlow"},beginSecureSessionForResource:{name:"beginSecureSessionForResource"},beginSecureSessionForResourceWithPrompt:{name:"beginSecureSessionForResourceWithPrompt"},signOut:{name:"signOut"},reconfigure:{name:"reconfigure"},authenticationValidationError:{name:"authenticationValidationError"},handleAuthError:{name:"handleAuthError"}},p={exec:{name:"exec"},onSyncStart:{name:"onSyncStart"},onSyncComplete:{name:"onSyncComplete"},onSyncError:{name:"onSyncError"}},f={getExternalContextProperty:{name:"getExternalContextProperty"},invokeExternalContextAction:{name:"invokeExternalContextAction"}}},VnTQ:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"d",(function(){return c})),n.d(t,"e",(function(){return l})),n.d(t,"c",(function(){return u}));var r=n("GP49"),a=n("RymD");const i="Back.Nav.Tooltip.Hide",o="Back.Nav.Tooltip.Init";function s(e,t,n){const r={[a.c]:t};return n&&(r[a.b]=n),Promise.resolve(e.DataSource.saveSessionState(a.a,r,!0))}function c(){return{type:"back.button.init",execute:({dispatch:e},t)=>function(e){return Promise.resolve(e.DataSource.retrieveSessionState(a.a)).then(e=>e&&{hideLongPressTooltip:e[a.c],tooltipDismissCount:e[a.b]})}(t).then(t=>{return t&&e((n=t.hideLongPressTooltip,r=t.tooltipDismissCount,{type:o,payload:{hideLongPressTooltip:n,tooltipDismissCount:r}}));var n,r})}}function l(){return{type:"back.button.tooltip.multiple",execute({dispatch:e,getState:t},n){if(!Object(r.c)(t())&&!Object(r.b)(t()))return e(d(!1)),s(n,!1)}}}function u(){return{type:"disable.back.button.tooltip",execute({dispatch:e,getState:t},n){e(d(!0));return s(n,!0,Object(r.a)(t()))}}}function d(e){return{type:i,payload:e}}},VqBP:function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return u})),n.d(t,"a",(function(){return c}));var r=n("izYK"),a=n("LbMF"),i=n("Z/4N"),o=n("9fGf"),s=n("/A0C");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const c="DisplayAsCustomer360Tile";function l(e,t,n){if(!n)return null;if(n.Parameters&&n.Parameters.QuickForms)return"true"===n.Parameters[c]?r.a.Card:r.a.QuickForm;if(n.Parameters&&n.Parameters.Dashboard)return r.a.Dashboard;if(n.Parameters&&n.Parameters.Url)return r.a.WebResourceHtmlControl;if(n&&"notescontrol"===n.Id)return r.a.TimelineWall;if(n.Parameters&&n.Parameters.TileUrl)return r.a.PowerBI;if(n&&n.Parameters&&n.Parameters.FailureTimeField)return r.a.Timer;const i=Object(a.a)(e,t,n.DataFieldName);if(i){let e=i.Format;return i.Type===s.a.Lookup&&"0"===i.Format&&i.Targets&&i.Targets.length>1&&(e="1"),i.Type+"."+e}return null}function u(e,t,n){const r=t.UniqueId,a=Object(o.b)(e),s=Object(i.b)(e,r,n);if(s&&s.CustomControls&&s.CustomControls[a]&&null!=s.CustomControls[a].CustomControlId){const t=s.CustomControls[a].CustomControlId,n=Object(i.e)(e,t);for(const e in n.Properties){const t=n.Properties[e];for(const e in t)if(t[e].Primary)return t[e].Type}}return null}},VtmT:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return o}));var r=n("NjDY");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t=""){const n=t.toLowerCase().startsWith(window.location.origin.toLowerCase())?t.substring(window.location.origin.length):t,r=n.toLowerCase();return r.startsWith("$webresource:")?n.substr("$webresource:".length):r.startsWith("/webresources/")?n.substr("/webresources/".length):r.startsWith(e)?n.substr(e.length):void 0}function i(e,t){const n=a(Object(r.x)(t),e);if(n)return`${window.location.origin}/api/data/v9.0/webresourceset?$filter=name eq '${n}'&$select=content`}function o(e,t){if(0!==t.indexOf(window.location.origin+"/api/data/v9.0/webresourceset"))return e;try{const n=JSON.parse(e),r=new URL(t,window.location.origin).searchParams.get("$filter");return r.split(" eq ")[1].includes(".svg")?n.value[0].content:function(e){const t=new Uint8Array(e.length);for(let n=0;n<t.length;n++)t[n]=e.charCodeAt(n);return(new TextDecoder).decode(t)}(atob(n.value[0].content))}catch(t){return e}}},Vv1C:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("4leG"),a=n("E5IU"),i=n("ZUus");function o(e){const t=Object(r.f)(e);return Object(a.i)("HideNavbar",e)||t!==i.a.On}},W1cF:function(e,t,n){"use strict";n.d(t,"a",(function(){return C})),n.d(t,"c",(function(){return E})),n.d(t,"s",(function(){return I})),n.d(t,"b",(function(){return w})),n.d(t,"i",(function(){return j})),n.d(t,"h",(function(){return P})),n.d(t,"n",(function(){return T})),n.d(t,"q",(function(){return N})),n.d(t,"p",(function(){return A})),n.d(t,"o",(function(){return R})),n.d(t,"e",(function(){return D})),n.d(t,"t",(function(){return x})),n.d(t,"g",(function(){return M})),n.d(t,"u",(function(){return F})),n.d(t,"f",(function(){return k})),n.d(t,"v",(function(){return L})),n.d(t,"m",(function(){return B})),n.d(t,"z",(function(){return U})),n.d(t,"l",(function(){return V})),n.d(t,"y",(function(){return z})),n.d(t,"k",(function(){return q})),n.d(t,"x",(function(){return H})),n.d(t,"d",(function(){return W})),n.d(t,"r",(function(){return G})),n.d(t,"j",(function(){return K})),n.d(t,"w",(function(){return Q}));var r=n("23jc"),a=n("SRlt"),i=n("fMBw"),o=n.n(i),s=n("SZCI"),c=n("KBcj"),l=n("ORLm"),u=n("OU7F"),d=n("a72m"),p=n("d0w6"),f=n("SAYH"),g=n("FZDd"),h=n("Uv1Y"),m=n("JQqP"),b=n("z8nh"),y=n("XmFW"),_=n("g22U"),v=n("nmJf"),S=n("M0zh");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const O=o.a.createEvent("retrieveSuggestionResults",s.k),C=7,E="globalsearch.last.search.text";function I(e){return{type:E,payload:{lastSearchText:e}}}const w="globalsearch.current.suggest.text";const j="globalsearch.suggestions.pending";const P="globalsearch.suggestions.set";function T(){return{type:P,payload:{suggestions:[]}}}function N(e,t,n=C,i){return{type:"globalsearch.suggestions.retrieve.async",execute:async(o,s)=>{var v,S,C;if(!e)return void o.dispatch(T());o.dispatch({type:j,payload:null}),o.dispatch({type:w,payload:{currentSuggestText:e}});const E={search:e,top:n,useFuzzy:!0};i&&(E.suggestType=i);const I={endpoint:u.o,method:"POST",urlParameters:"",additionalHeaders:{[b.m]:t},body:JSON.stringify(E),additionalParameters:{[_.a.TYPE]:_.d.ACTION,[_.a.SUB_TYPE]:_.c.GlobalSearchSuggestions,[_.a.SOURCE]:_.b.Default}},N=e.length.toString(),A=O.startStopwatch({searchSessionId:t,searchTextLength:N,SearchSessionId:t,SearchTextLength:N});let R;try{const e=[],n=await o.dispatch(Object(r.a)(I,void 0,e)),i=await Object(a.g)(n);e.push({name:"SuggestionCount",value:null!==(S=null===(v=null==i?void 0:i.value)||void 0===v?void 0:v.length)&&void 0!==S?S:0});const l={};for(const t of e)l[t.name]=t.value;if(A(l),i.code)throw s.EventManager.ReportComponentFailure("GlobalSearchAction.retrieveSuggestionResults.apiError",i),new Error(i.message);R=i.value;const u=new Set;let _=0;for(const e of R)e.document.hasOwnProperty(b.n)?_++:u.add(e.document[y.a]);if(_>0){const e=[];e.push({name:"suggestionCount",value:R.length}),e.push({name:"secondFieldHintCount",value:_}),s.EventManager.ReportComponentSuccess("GlobalSearchFlyout.Suggestions.secondfieldHint",e)}const O=Array.from(u.values()).map(async e=>{let n=Object(c.a)(o.getState(),e,p.a.QUICKFIND_SEARCH);if(n||(n=await o.dispatch(Object(d.a)(e,p.a.QUICKFIND_SEARCH,p.b.savedview))),f.a.isNullOrEmpty(n))s.EventManager.ReportComponentFailure("GlobalSearchAction.retrieveSuggestionResults.quickFindViewError",new h.a("ViewId is null or empty"),null,[{name:m.b.sessionId,value:t},{name:m.b.entityName,value:e}]);else{const e=X(o.getState(),n);o.dispatch(Object(g.e)(e))}});Promise.all(O)}catch(e){s.EventManager.ReportComponentFailure("GlobalSearchAction.retrieveSuggestionResults.error",e),R=[]}const D=Object(l.b)(o.getState());if(e===D.currentSuggestText)o.dispatch(function(e){return{type:P,payload:{suggestions:e}}}(R));else{const t=[];t.push({name:"searchTextCount",value:e.length}),t.push({name:"currentSuggestTextCount",value:null===(C=D.currentSuggestText)||void 0===C?void 0:C.length}),t.push({name:"suggestionCount",value:R.length}),s.EventManager.ReportComponentSuccess("GlobalSearchAction.Suggestions.staleResults",t)}}}}function A(e,t){return{type:"globalsearch.views.metadata.retrieve.async",execute:(n,r)=>{const a="GlobalSearchAction.retrieveRequiredViewsMetadata";try{null==e||e.map(e=>{n.dispatch(Object(d.a)(e,p.a.QUICKFIND_SEARCH,p.b.savedview)).then(i=>{if(f.a.isNullOrEmpty(i))r.EventManager.ReportComponentFailure(a,new h.a("ViewId is null or empty"),null,[{name:m.b.sessionId,value:t},{name:m.b.entityName,value:e}]);else{const e=X(n.getState(),i);n.dispatch(Object(g.e)(e))}})})}catch(e){r.EventManager.ReportComponentFailure(a,e)}return Promise.resolve()}}}function R(e,t){return{type:"globalsearch.ribbons.metadata.retrieve.async",execute:(n,r)=>{const a="GlobalSearchAction.retrieveRequiredRibbonsMetadata";try{null==e||e.map(e=>{n.dispatch(Object(v.a)(S.i+e)).catch(()=>{r.EventManager.ReportComponentFailure(a,new h.a("retrieveAndLocalizeRibbon error"),null,[{name:m.b.sessionId,value:t},{name:m.b.entityName,value:e}])})})}catch(e){r.EventManager.ReportComponentFailure(a,e)}return Promise.resolve()}}}const D="globalsearch.displayTeachingBubble";function x(e){return{type:D,payload:{displayTeachingBubble:e}}}const M="globalsearch.presentation.isexpanded";function F(e){return{type:M,payload:{isExpanded:e}}}const k="globalsearch.presentation.initiate.relevancesearch";function L(e){return{type:k,payload:{initiateRelevanceSearch:e}}}const B="globalsearch.relevance.native.relevanceSearchNavigation.cache";function U(e){return{type:B,payload:{relevanceSearchNavigationCache:e}}}const V="globalsearch.relevance.native.intermittent.filters";function z(e){return{type:V,payload:{filters:e}}}const q="globalsearch.relevance.native.intermittent.filterFacetKeysStack";function H(e){return{type:q,payload:{filterFacetKeysStack:e}}}const W="globalsearch.presentation.availablewidth";function G(e){return{type:W,payload:{availableWidth:e}}}const K="globalsearch.isRelevanceSearchFiltersPanelCollapsed";function Q(e){return{type:K,payload:{isRelevanceSearchFiltersPanelCollapsed:e}}}function X(e,t){var n,r,a;const i=Object(c.c)(e,t),o={},s=[];if(null===(a=null===(r=null===(n=null==i?void 0:i.grid)||void 0===n?void 0:n.rows)||void 0===r?void 0:r[0])||void 0===a?void 0:a.cells){i.grid.rows[0].cells.forEach(e=>{e.disableMetaDataBinding||e.relatedEntityName||-1===s.indexOf(e.name)&&s.push(e.name)})}const l=(new DOMParser).parseFromString(i.fetchXML,"text/xml").getElementsByTagName("filter");for(let e=0;e<l.length;e++)if(l[e].attributes&&l[e].attributes.getNamedItem("isquickfindfields")){const t=l[e].getElementsByTagName("condition");for(let e=0;e<t.length;e++){const n=t[e].getAttribute("attribute");s.includes(n)||s.push(n)}}return s.length>0&&(o[i.entityLogicalName]=s),o}},W8Pl:function(e,t,n){"use strict";n.d(t,"b",(function(){return a}));var r=n("0hkU"),a=new(function(){function e(){this._navigationContext={openAlertDialog:r.e,openErrorDialog:r.g,openConfirmDialog:r.f,openFile:null,openUrl:null,openWebResource:null,navigateTo:null,openDialog:null,openForm:null,openTaskFlow:null},this.UserSettings={userId:"{00000000-0000-0000-0000-000000000000}",getTimeZoneOffsetMinutes:r.d,isHighContrastEnabled:null,isRTL:!1,languageId:1033,locale:"en-US",userName:"",securityRoles:[],pagingLimit:null,formatInfoCultureName:"en-US",formatInfoCultureId:1033},this.OrgSettings={languageId:null,uniqueName:null,isAutoSaveEnabled:null,attributes:null},this.Utils={beginSecureSessionForResource:null,getEntityMetadata:null,getEntitiesMetadata:null,getResourceString:null,isFeatureEnabled:null,isDisruptiveFeatureEnabled:null,lookupObjects:null,getEntityName:null,getFormId:null,canOpenUrl:null,getUserSettings:null},this.Page={getClientUrl:null},this.Reporting={reportSuccess:null,reportFailure:null,reportEvent:null},this.Diagnostics={traceError:null,traceWarning:null,traceInfo:null,traceDebug:null,isInMonitorSession:null},this.IntelligenceApi={getPredictionSchemaAsync:null,predictAsync:null,getPreTrainedModelIdAsync:null,getLabelsForObjectDetectionModelAsync:null,invokeAiModelActionAsync:null,invokeGlobalOperationAsync:null},this.Client={getClient:r.a,getClientState:r.b,getFormFactor:r.c},this._applicationUI={addGlobalNotification:null,clearGlobalNotification:null,clearGlobalNotifications:null},this._webApiContext={online:{retrieveRecord:null,retrieveMultipleRecords:null,updateRecord:null,createRecord:null,deleteRecord:null,execute:null,executeMultiple:null},offline:{retrieveRecord:null,retrieveMultipleRecords:null,updateRecord:null,createRecord:null,deleteRecord:null,execute:null,executeMultiple:null}},this._unifiedWebApiContext=null,this.Initialized=!1}return e.prototype.setUserSettings=function(e){this.UserSettings=e},e.prototype.setOrgSettings=function(e){this.OrgSettings=e},e.prototype.setOffline=function(e){this.Offline=e},e.prototype.setUtils=function(e){var t,n=this;this.Utils=e,this.Utils.getUserSettings=null!==(t=this.Utils.getUserSettings)&&void 0!==t?t:function(){return Promise.resolve(n.UserSettings)}},e.prototype.setPage=function(e){this.Page=e},e.prototype.setReporting=function(e){this.Reporting=e},e.prototype.setIntelligenceApi=function(e){this.IntelligenceApi=e},e.prototype.setDiagnostics=function(e){this.Diagnostics=e},e.prototype.setClient=function(e){this.Client=e},e.prototype.setNavigationContext=function(e){this._navigationContext=e},e.prototype.setDeviceContext=function(e){this._deviceContext=e},e.prototype.setExternalContext=function(e){this._externalContext=e},e.prototype.setApplicationUI=function(e){this._applicationUI=e},e.prototype.setWebApi=function(e){this._webApiContext=e},e.prototype.setWebApiUnified=function(e){this._unifiedWebApiContext=e},e.prototype.openForm=function(e,t,n){return this._navigationContext.openForm(e,t,n)},e.prototype.openUrl=function(e,t,n){return this._navigationContext.openUrl(e,t,n)},e.prototype.openFile=function(e,t,n){return this._navigationContext.openFile(e,t,n)},e.prototype.openAlertDialog=function(e,t,n){return this._navigationContext.openAlertDialog(e,t,n)},e.prototype.openConfirmDialog=function(e,t,n){return this._navigationContext.openConfirmDialog(e,t,n)},e.prototype.openDialog=function(e,t,n,r){return this._navigationContext.openDialog(e,t,n,r)},e.prototype.openErrorDialog=function(e,t){return this._navigationContext.openErrorDialog(e,t)},e.prototype.openTaskFlow=function(e,t,n,r){return this._navigationContext.openTaskFlow(e,t,n,r)},e.prototype.openWebResource=function(e,t,n,r){return this._navigationContext.openWebResource(e,t,n,r)},e.prototype.navigateTo=function(e,t,n){return this._navigationContext.navigateTo(e,t,n)},e.prototype.captureImage=function(e){return this._deviceContext.captureImage(e)},e.prototype.captureAudio=function(e){return this._deviceContext.captureAudio(e)},e.prototype.captureVideo=function(e){return this._deviceContext.captureVideo(e)},e.prototype.pickFile=function(e){return this._deviceContext.pickFile(e)},e.prototype.getBarcodeValue=function(){return this._deviceContext.getBarcodeValue()},e.prototype.getCurrentPosition=function(){return this._deviceContext.getCurrentPosition()},e.prototype.getAvailableExternalContexts=function(){return this._externalContext.getAvailableExternalContexts()},e.prototype.getExternalContextProperty=function(e,t,n){return this._externalContext.getExternalContextProperty(e,t,n)},e.prototype.invokeExternalContextAction=function(e,t,n){return this._externalContext.invokeExternalContextAction(e,t,n)},e.prototype.removeExternalContextPropertyListener=function(e,t,n){return this._externalContext.removeExternalContextPropertyListener(e,t,n)},e.prototype.addGlobalNotification=function(e,t,n,r,a,i){return this._applicationUI.addGlobalNotification(e,t,n,r,a,i)},e.prototype.clearGlobalNotification=function(e){return this._applicationUI.clearGlobalNotification(e)},e.prototype.clearGlobalNotifications=function(){return this._applicationUI.clearGlobalNotifications()},e.prototype._getWebApiContext=function(){return this._unifiedWebApiContext||("Offline"===this.Client.getClientState()?this._webApiContext.offline:this._webApiContext.online)},e.prototype.retrieveRecord=function(e,t,n){return this._getWebApiContext().retrieveRecord(e,t,n)},e.prototype.createRecord=function(e,t){return this._getWebApiContext().createRecord(e,t)},e.prototype.updateRecord=function(e,t,n){return this._getWebApiContext().updateRecord(e,t,n)},e.prototype.deleteRecord=function(e,t){return this._getWebApiContext().deleteRecord(e,t)},e.prototype.retrieveMultipleRecords=function(e,t,n,r){return this._getWebApiContext().retrieveMultipleRecords(e,t,n,r)},e.prototype.execute=function(e){return this._getWebApiContext().execute(e)},e.prototype.executeMultiple=function(e){var t=this._getWebApiContext();return t.executeMultiple?t.executeMultiple(e):Promise.resolve(null)},e.prototype.openARViewer=function(e){return this._deviceContext.openARViewer(e)},e}());t.a=a},WF3G:function(e,t,n){"use strict";n.d(t,"a",(function(){return C}));var r=n("504W"),a=n("Ydwo"),i=n("2F73"),o=n("XvL5"),s=n("cgR4"),c=n("8tWD"),l=n("/bjP"),u=n("eruq"),d=n("TFb5"),p=n("MXaZ"),f=n("s/8p");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const g=new RegExp("'!start-of-current-hour-utc!'","g"),h=new RegExp("'!start-of-today-utc!'","g"),m=new RegExp("'!start-of-work-week-utc!'","g"),b=new RegExp("'!start-of-month-utc!'","g"),y=new RegExp("'!start-of-year-utc!'","g"),_=new RegExp("!user-timezone-hour-offset!","g"),v=new RegExp("!user-timezone-minute-offset!","g"),S=new RegExp("!utc-hour-offset!","g"),O=new RegExp("!utc-minute-offset!","g");class C{constructor(e){this._columnSet=null,this._descriptorSet=null,this._noLock=!1,this._pageNumber=1,this._pageSize=1,this._entityLogicalName=null,this._returnTotalRecordCount=!1,this._queryContext=null,this._status=[],this._pagingCookie="",Object(r.a)(e)||this._CreateQuery(e)}get_ColumnSet(){return this._columnSet}set_ColumnSet(e){return this._columnSet=e,e}set_ColumnNames(e){return this._columnNames=e,e}get_DescriptorSet(){return this._descriptorSet}get queryStatus(){return this._status}_set_DescriptorSet(e){return this._descriptorSet=e,e}get_FetchXml(){const e=this.rawFetchXmlDoc;return Object(r.a)(e)||Object(r.a)(e.firstChild)||"fetch"!==e.firstChild.nodeName?this.get_rawFetchXml():(Object(d.z)(this.rawFetchXmlDoc,this.get_PageSize(),this.get_PageNumber(),this.get_PagingCookie(),!0,this._get_NoLock()),Object(u.a)(e).get_outerXml())}set_FetchXml(e){if(Object(r.b)(e)||"<"!==e.substr(0,1))this.set_ColumnSet(new o.a(new Array(0)));else{const t=Object(u.b)(e);if(this.rawFetchXmlDoc=t,!Object(r.a)(t)){const e=Object(u.a)(t),n=e.selectSingleNode("/fetch");if(!Object(r.a)(n)){let a=n.getAttribute("page");Object(r.a)(a)||this.set_PageNumber(Number.parseInvariant(a)),a=n.getAttribute("count"),Object(r.a)(a)||this.set_PageSize(Number.parseInvariant(a)),a=n.getAttribute("paging-cookie"),Object(r.a)(a)||this.set_PagingCookie(a);const s=e.selectSingleNode("/fetch/entity");if(Object(r.a)(s)||this.set_EntityLogicalName(s.getAttribute("name")),Object(r.a)(e.selectSingleNode("/fetch/entity/all-attributes"))){const t=[],n=e.selectNodes("/fetch/entity/attribute");for(let e=0;e<n.get_count();e++)t.push(n.get_item(e).getAttribute("name"));this.set_ColumnSet(new o.a(t))}else this.set_ColumnSet(i.a.get_instance());const c=t.firstChild.attributes.getNamedItem("returntotalrecordcount");this._returnTotalRecordCount=!!Object(r.a)(c)||Boolean.parse(c.nodeValue).valueOf()}}}return e}get_sql(e){let t=this.get_DescriptorSet().tryGetDescriptor(c.a.Sql);if(!Object(r.b)(t)){t=t+" LIMIT "+(1+this.get_PageSize())+" OFFSET "+this.get_PageSize()*(this.get_PageNumber()-1),t=t.replace('"!eq-userid!"',"'"+e.get_UserId().toString()+"' COLLATE NOCASE"),t=this.substituteDateTimePlaceholders(e,t);const n="6";t=t.replace("@LanguageId0",e.get_UserSettings().get_languageId().toString()),t=t.replace("@LanguageId1",e.get_organizationSettings().get_languageCode().toString()),t=t.replace("@ObjectColumnName0",n),t=t.replace("@ObjectColumnName1",n)}return t}get_PageNumber(){return this._pageNumber}set_PageNumber(e){if(e<1)throw Error.argumentOutOfRange("value",e,"PageNumber cannot be less than 1");return this._pageNumber=e,e}_get_NoLock(){return this._noLock}set_NoLock(e){return this._noLock=e,e}get_PageSize(){return this._pageSize}set_PageSize(e){return this._pageSize=e,e}get_PagingCookie(){return this._pagingCookie}set_PagingCookie(e){return Object(r.b)(e)&&(this._pagingCookie=""),this._pagingCookie=e,e}get_EntityLogicalName(){return this._entityLogicalName}set_EntityLogicalName(e){return this._entityLogicalName=e,e}get_returnTotalRecordCount(){return this._returnTotalRecordCount}get_queryContext(){return this._queryContext}set_queryContext(e){this._queryContext=e}get_id(){return this.get_rawFetchXml()}get_RawSql(){return this.get_DescriptorSet().tryGetDescriptor(c.a.Sql)}set_RawSql(e){return Object(r.a)(this._descriptorSet)||this._descriptorSet.updateDescriptorSet(c.a.Sql,e),e}get_rawFetchXml(){return this.rawFetchXmlDoc?Object(u.a)(this.rawFetchXmlDoc).get_outerXml():""}get_FetchXmlForAliasedValues(){return this._fetchXmlForAliasedValues}set_FetchXmlForAliasedValues(e){this._fetchXmlForAliasedValues=e}_CreateQuery(e){if(e instanceof l.a){this._descriptorSet=new l.a;for(const t in e.get_descriptors()){const n=e.get_descriptors()[t];this._descriptorSet.get_descriptors()[c.a[n.Format]]=new s.a(n.Format,n.Data),n.Format===c.a.FetchXml&&this.set_FetchXml(n.Data)}}else this.set_FetchXml(e.toString()),this._set_DescriptorSet(l.a.createFromFetchXml(e.toString()))}toString(){return String.format("Query: {0}",this.get_rawFetchXml())}GetColumnNamesFromFetch(){return Object(r.a)(this._columnNames)?Object(d.q)(this.rawFetchXmlDoc):this._columnNames}updateSqlWithWhereClauseFromQueryFilter(e,t,n,a,i){const o=n.getElementsByTagName("condition");for(let n=0;n<o.length;n++){const s=Object(d.s)(o[n],"attribute");Object(r.b)(s)||a!==s&&i!==s||(t=this._UpdateSqlWithWhereClauseFromCondition(e,t,o[n],"and"))}return t}updateSqlWithWhereClauseFromRelationshipCondition(e,t,n){const r=n.getElementsByTagName("condition")[0],a=n.getElementsByTagName("filter")[0],i=Object(d.s)(a,"type");return this._UpdateSqlWithWhereClauseFromCondition(e,t,r,i)}_UpdateSqlWithWhereClauseFromCondition(e,t,n,i){let o=t;const s='"'+e+'0"';let c="";for(let e=0;e<n.childNodes.length;e++){const t=n.childNodes[e];if("value"===t.nodeName){const r=t.firstChild.nodeValue;c+=String.format("'{0}'",r),e!==n.childNodes.length-1&&(c+=", ")}}let l=null;if(0===c.length){const e=Object(d.s)(n,"value");e||this._status.push({failed:!0,offlineModeSpecific:!0,message:"Error.Missing.Value.Attribute"}),l=String.format(" '{0}' ",e)}else l=String.format(" ({0}) ",c);let u=Object(d.s)(n,"attribute");u=this.generateNorSyncAttributeName(e,u,Object(a.a)(()=>l,e=>l=e));const p=this._GetOperators(Object(d.s)(n,"operator"));Object(r.b)(p)&&this._status.push({failed:!0,offlineModeSpecific:!0,message:"Error.Unsupported.Query.Operator"});let g="WHERE (("+s+"."+u+" "+p+l+")) COLLATE NOCASE ";if(1===t.split(f.h).length)if(t.toUpperCase().indexOf("WHERE")===t.toUpperCase().lastIndexOf("WHERE")&&t.toUpperCase().indexOf("WHERE")>0){g+=i;let e=t.split("WHERE");1===e.length&&(e=t.split("where")),o=e[0]+g+e[1]}else t.toUpperCase().indexOf("WHERE")<=0&&(t.toUpperCase().indexOf("ORDER BY")>0?o=t.indexOf("ORDER BY")>0?t.replace("ORDER BY"," "+g+"ORDER BY"):t.replace("order by"," "+g+"ORDER BY"):o+=g);else{const e=t.split(f.j);if(2===e.length){g+=i;const t=e[1].replace(/where/i,g);o=`${e[0]} ${f.j} ${t}`}else if(1===e.length){const e=t.split(f.e);2===e.length?o=`${e[0]} ${f.j} ${g} ${f.i} ${f.e} ${e[1]}`:o+=` ${f.j} ${g} ${f.i}`}}return o}updateSqlWithJoinClauseFromContextFilter(e,t,n,r,a){const i=n.getElementsByTagName("filter")[0];let o=null,s="";const c='"'+e+'0"',l=c+" ";o=n.getElementsByTagName("link-entity")[0];n.getElementsByTagName("link-entity").length>1?(s=this._GenerateJoinClause(e,r,a,i,o,c,!0),e=Object(d.s)(o,"name"),o=n.getElementsByTagName("link-entity")[1],s=s+" "+this._GenerateJoinClause(e,r,a,i,o,e+"2",!1)):s=this._GenerateJoinClause(e,r,a,i,o,c,!1);const u=t.lastIndexOf(l),p=t.lastIndexOf(f.c);if(p>0){const e=t.substring(0,p),n=t.substring(p+f.c.length,t.length);t=`${e} ${s} ${n}`}else if(u>0){const e=t.substring(0,u),n=t.substring(u+l.length,t.length);t=e+c+s+n}else t+=s;return t}_GenerateJoinClause(e,t,n,r,i,o,s){let c=null,l="",u="";const p=Object(d.s)(i,"name");u=s?p+"2":Object(d.s)(i,"alias");const f=p+" AS "+u+" ON ("+o+"."+this.generateNorSyncAttributeName(e,Object(d.s)(i,"to"),Object(a.a)(()=>c,e=>c=e))+" = "+u+"."+this.generateNorSyncAttributeName(p,Object(d.s)(i,"from"),Object(a.a)(()=>c,e=>c=e));if(s)l=" JOIN "+f+" COLLATE NOCASE )";else{const e=u+"."+Object(d.s)(t,"attribute")+" "+this._GetOperators(Object(d.s)(t,"operator"))+" '"+n+"' COLLATE NOCASE ";l=" JOIN "+f+" COLLATE NOCASE "+Object(d.s)(r,"type")+" (( "+e+"))) "}return l}generateNorSyncAttributeName(e,t,n){return t}_GetOperators(e){let t="";switch(e){case"eq":t="=";break;case"not-eq ":case"ne":t="!=";break;case"like":t="like";break;case"in":t="in"}return t}substituteDateTimePlaceholders(e,t){const n=Object(p.F)(e);return t=(t=(t=(t=(t=(t=(t=(t=(t=t.replace(g,Object(p.D)(e,Object(p.A)(n)))).replace(h,Object(p.D)(e,Object(p.z)(n)))).replace(m,Object(p.D)(e,Object(p.N)(e,n)))).replace(b,Object(p.D)(e,Object(p.B)(n)))).replace(y,Object(p.D)(e,Object(p.C)(n)))).replace(_,Object(p.G)(e).toString())).replace(v,Object(p.H)(e).toString())).replace(S,Object(p.J)(e).toString())).replace(O,Object(p.K)(e).toString())}static get_empty(){return new C("")}}},WIoD:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"h",(function(){return i})),n.d(t,"i",(function(){return o})),n.d(t,"d",(function(){return s})),n.d(t,"a",(function(){return c})),n.d(t,"f",(function(){return l})),n.d(t,"g",(function(){return u})),n.d(t,"e",(function(){return d})),n.d(t,"c",(function(){return p}));var r=n("SAYH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a=new r.a("{e7a81278-8635-4d9e-8d4d-59480b391c5b}"),i=new r.a("{9fdf5f91-88b1-47f4-ad53-c11efc01a01d}"),o=new r.a("{587CDF98-C1D5-4bde-8473-14A0BC7644A7}"),s=new r.a("39354e4a-5015-4d74-8031-ea9eb73a1322"),c=new r.a("F9A8A302-114E-466A-B582-6771B2AE0D92"),l=new r.a("F3015350-44A2-4aa0-97B5-00166532B5E9"),u=new r.a("06375649-C143-495E-A496-C962E5B4488E"),d=new r.a("4aa28ab7-9c13-4f57-a73d-ad894d048b5f"),p=new r.a("fd2a7985-3187-444e-908d-6624b21f69c0")},WKRf:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="form.entityRecordDeleted.set";function i(e,t,n){const i=Object(r.w)(n);return{type:a,payload:t,meta:{pageId:e,contextKey:i}}}},WLAV:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * The unique name of the Search page module.
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="PowerBIFullScreen"},WNuT:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("eXjw"),a=n("d6Hx");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function i(e){if(!e||!e.length)return null;if(e.length>1)throw"More than one SiteMap detected";const t=e[0],{ShowHome:n,ShowPinned:i,ShowRecents:s,EnableCollapsibleGroups:c}=t,l=[],u={};if(t.Areas)for(const e of t.Areas)l.push(e.Id),u[e.Id]=o(e);return l.push(a.c),u[a.c]={Titles:[],Descriptions:[],GroupIds:[],Groups:{},Id:a.c},{initialized:r.a.Initialized,AreaIds:l,Areas:u,Url:t.Url,VersionNumber:t.VersionNumber,OverallVersionNumber:t.OverallVersionNumber,EnableCollapsibleGroups:"boolean"==typeof c&&c,ShowHome:"boolean"!=typeof n||n,ShowPinned:"boolean"!=typeof i||i,ShowRecents:"boolean"!=typeof s||s}}function o(e){const t=[],n={};for(const r of e.Groups)t.push(r.Id),n[r.Id]=s(r);return{Titles:l(e.Titles),Descriptions:u(e.Descriptions),GroupIds:t,Groups:n,Id:e.Id,Icon:e.Icon,VectorIcon:e.VectorIcon,Url:e.Url,ShowGroups:e.ShowGroups,ShowGroupsSpecified:e.ShowGroupsSpecified}}function s(e){const t=[],n={};for(const r of e.SubAreas)t.push(r.Id),n[r.Id]=c(r);return{Titles:l(e.Titles),Descriptions:u(e.Descriptions),SubAreaIds:t,SubAreas:n,Id:e.Id,Url:e.Url}}function c(e){return{Titles:l(e.Titles),Descriptions:u(e.Descriptions),Id:e.Id,Icon:e.Icon,VectorIcon:e.VectorIcon,OutlookShortcutIcon:e.OutlookShortcutIcon,Url:e.Url,PassParams:e.PassParams,PassParamsSpecified:e.PassParamsSpecified,AvailableOffline:e.AvailableOffline,AvailableOfflineSpecified:e.AvailableOfflineSpecified,Entity:e.Entity,DynamicPage:e.DynamicPage,Page:e.Page,GetStartedPanePath:e.GetStartedPanePath,GetStartedPanePathOutlook:e.GetStartedPanePathOutlook,GetStartedPanePathAdmin:e.GetStartedPanePathAdmin,DefaultDashboard:e.DefaultDashboard,GetStartedPanePathAdminOutlook:e.GetStartedPanePathAdminOutlook}}function l(e){const t=[];for(const n of e){const e={Title:n.Title,LCID:n.LCID};t.push(e)}return t}function u(e){const t=[];for(const n of e){const e={Description:n.Description,LCID:n.LCID};t.push(e)}return t}},WOnu:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class r{getMetadata(){return{boundParameter:null,operationName:null,operationType:null,parameterTypes:{DisplayName:{typeName:"Edm.String",structuralProperty:1},IconPath:{typeName:"Edm.String",structuralProperty:1},LastAccessedStr:{typeName:"Edm.String",structuralProperty:1},EntityTypeName:{typeName:"Edm.String",structuralProperty:1},ObjectId:{typeName:"Edm.String",structuralProperty:1},PinStatus:{typeName:"Edm.Boolean",structuralProperty:1},RecordType:{typeName:"Microsoft.Dynamics.CRM.RecentlyViewedRecordType",structuralProperty:3,enumProperties:[,{name:"Entity",value:0},{name:"Grid",value:1},{name:"Isv",value:2},{name:"Invalid",value:-1}]},IsUserView:{typeName:"Edm.Boolean",structuralProperty:1},Title:{typeName:"Edm.String",structuralProperty:1},IsDeleted:{typeName:"Edm.Boolean",structuralProperty:1}}}}}},WPtp:function(e,t,n){"use strict";n.d(t,"i",(function(){return s})),n.d(t,"g",(function(){return c})),n.d(t,"k",(function(){return l})),n.d(t,"j",(function(){return u})),n.d(t,"f",(function(){return d})),n.d(t,"h",(function(){return p})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return g})),n.d(t,"e",(function(){return o})),n.d(t,"b",(function(){return h})),n.d(t,"a",(function(){return m}));var r=n("SAYH"),a=n("504W");function i(e){if(!Object(a.a)(e)){if(u(e)){if(e.validationResult&&!e.validationResult.isValueValid){const t=e.validationResult.userInput;return t&&(null==t?void 0:t.toString())}return e.formatted||e.value&&e.value.toString()}if(s(e))return e.label;if(c(e))return r.a.toString(e.id);if(l(e))return e.reference&&e.reference.name||null;if(d(e))return i(e.innerValue);if(p(e)){let t="";for(const n of e.list){let e=null;n.fields&&(e=n.fields.partyid?n.fields.partyid:n.fields.addressused?n.fields.addressused:null,e&&(t=""!==t?`${t}, ${i(e)}`:i(e)))}return t}return f(e)}return null}function o(e){if(e){if(u(e)){if(e.validationResult&&!e.validationResult.isValueValid){return e.validationResult.userInput}return e.value}return s(e)?g(e):c(e)?e.id:l(e)?e.reference:d(e)?o(e.innerValue):p(e)?e.list:f(e)}return null}function s(e){return!!e&&e.hasOwnProperty("label")}function c(e){return!!e&&e.hasOwnProperty("id")}function l(e){return!!e&&e.hasOwnProperty("reference")}function u(e){return!!e&&e.hasOwnProperty("value")}function d(e){return!!e&&e.hasOwnProperty("innerValue")}function p(e){return!!e&&e.hasOwnProperty("list")}function f(e){return Object(a.a)(e)?null:e.toString()}function g(e){return e&&s(e)?e.valueString:null}function h(e){return e&&l(e)&&e.reference&&e.reference.id||null}function m(e){return l(e)&&e.reference||null}},WRF3:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("84PK"),a=n("504W"),i=n("NMtn"),o=n("jZCH");class s{constructor(e,t,n,r){this.Id=null,this.LogicalName=null,this.Name=null,this.TypeCode=0,this.TypeDisplayName=null,this.TypeName=null,this.__RowVersion=null,Object(i.d)(e,"logicalName"),Object(i.d)(t,"id"),this.LogicalName=e,this.Id=t,this.Name=n,this.set_rowVersion(r),this.TypeName=e,this.TypeDisplayName=e;try{if(o.a.get_DefaultInstance().get_MetadataCache()){const t=o.a.get_DefaultInstance().get_MetadataCache().getEntityMetadata(e);Object(a.a)(t)||(this.TypeCode=t.get_objectTypeCode())}}catch(e){}}get_key(){return this.Id.toString()}get_identifier(){return this.Id.toString()}get_modelType(){return this.LogicalName}get_rowVersion(){return this.__RowVersion}set_rowVersion(e){return this.__RowVersion=e,e}getObjectData(){return{logicalname:this.LogicalName,id:this.Id.getObjectData(),name:this.Name,rowversion:!Object(a.a)(this.get_rowVersion())&&this.get_rowVersion()}}equals(e){if(e instanceof s){const t=e;return t.LogicalName===this.LogicalName&&this.Id.equals(t.Id)&&this.Name===t.Name}return!1}toString(){return String.format("{0}:{1}",this.LogicalName,this.Id.toString())}getValue(e){return this[l(e)]}setValue(e,t){this[l(e)]=t}static get_empty(){return c||(c=new s("",r.a.get_empty(),""))}static createFromObjectData(e){const t=e.logicalname,n=r.a.createFromObjectData(e.id),a=e.name;if(e.rowversion){const r=e.rowversion;return new s(t,n,a,r)}return new s(t,n,a)}}let c=null;function l(e){return e.substr(0,1).toUpperCase()+e.substr(1)}s.__typeName="Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.EntityReference"},WSMw:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"d",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return o}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="Create",a="Update",i="Delete",o="Retrieve"},WTcq:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e.GLOBAL_CONTAINER_KEY="crm_header_global"}(r||(r={}))},WWG3:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("504W"),a=n("cfGX"),i=n("MXaZ");class o{constructor(e,t){this._timeZoneOffsetMinutes=0,this._adjusters=[],this._timeZoneOffsetMinutes=e,Object(r.a)(t)||(this._adjusters=Object(i.Q)(t))}parseIntegerValue(e){const t=this.parseDecimalValue(e);return Object(r.a)(t)?a.c:Math.floor(t)}parseDecimalValue(e,t){let n=a.b;if(!Object(r.a)(e)){const i=new RegExp("(\\s|‎|‏)","g");e=e.replace(i,"");const o=!(/^\(.*\)$/.test(e)===!(/^\-/.test(e)===/\-$/.test(e)));o&&(e=e.replace(/[\(\)\-]/g,"")),n=Number.parseLocale(e),isNaN(n)?n=a.b:(o&&(n=-n),Object(r.a)(t)||(n=parseFloat(n.toFixed(t))))}return n}formatShortDateValue(e,t){let n=a.d;if(o.isDateTime(e)){n=Object(i.q)(e,this._timeZoneOffsetMinutes,t,this._adjusters).localeFormat("d")}return n}formatShortDateTimeValue(e,t){let n=a.d;if(o.isDateTime(e)){const r=Sys.CultureInfo.CurrentCulture.dateTimeFormat.ShortDatePattern,a=Sys.CultureInfo.CurrentCulture.dateTimeFormat.ShortTimePattern.replace(":",Sys.CultureInfo.CurrentCulture.dateTimeFormat.TimeSeparator),o=Object(i.q)(e,this._timeZoneOffsetMinutes,t,this._adjusters);n=String.localeFormat("{0:"+r+" "+a+"}",o)}return n}static get_instance(){return s}static set_instance(e){return s=e,e}static isDateTime(e){return e instanceof Date||"[object Date]"===Object.prototype.toString.call(e)}}let s=null},WWXV:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.Unknown=0]="Unknown",e[e.Authentication=1]="Authentication",e[e.LocalStore=2]="LocalStore",e[e.RemoteStore=3]="RemoteStore",e[e.LocalStoreWhileOnline=4]="LocalStoreWhileOnline",e[e.LocalStoreWhileOffline=5]="LocalStoreWhileOffline"}(r||(r={}))},"WY/A":function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n("Dea/"),a=n("bT7G");const i="dataSnapshot.create";function o(e,t,n,o,s=r.a.Update){if(!t||!n)throw new Error("Cannot create snapshot: invalid parameters specified");const c=Object(a.a)(e),l=t.etn+":"+c;return{type:i,payload:{snapshotId:l,identifier:t,activeChanges:n,mode:s},meta:{contextKey:o,nextSnapshotNumber:c}}}},WbTV:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.setNetworkRequestTrackingFilter=t.addNetworkResponseListener=t.addNetworkRequestListener=t.getNetworkRequestsForVerification=t.shouldUseNetworkRequest=t.getNetworkRequestTypeFilter=t.setNetworkRequestTypeFilter=t.patchNetworkRequestsOnWindow=t.patchNetworkRequests=t.resetNetworkRequests=t.getNetworkRequests=t.setStopwatchHeadersGetter=t.setAdditionalHeadersGetter=t.SYNC_XHR_MESSAGE=void 0;var a=r(n("5UJb")),i=n("3ZMs"),o=n("GotM"),s=r(n("zI6t")),c=n("5ylf");t.SYNC_XHR_MESSAGE="Synchronous XHR sent";var l,u,d,p,f="function"==typeof window.fetch&&window.fetch,g=[],h=[],m=[];function b(e){return p&&p(e)||[]}function y(e){return e&&(!u||u(e))&&e.indexOf(window.UCIPerformanceDataCollectionUrl)<0}function _(e,n){!function(e,n){e.XMLHttpRequest&&function(e){var r=e.setRequestHeader;e.setRequestHeader=function(e){this._headers||(this._headers=[]),this._headers.push(e),r.apply(this,arguments)};var o=e.open;e.open=function(e,r,a){if(this._method=e,this._async=a||arguments.length<=2,!this._async){var c={type:i.PerformanceIssueType.SyncXHR,level:i.PerformanceIssueLevel.Warning,message:t.SYNC_XHR_MESSAGE,parameters:[r,n]};s.default.logPerformanceIssue(c)}this._url=r,o.apply(this,arguments)};var c=e.send;e.send=function(){var e=this;if(d){var t=d(this._url);for(var i in t)(!this._headers||this._headers.indexOf(i)<0)&&r.apply(this,[i,t[i]])}var o=!this._async&&a.default.trackWork("XHR"),s={url:this._url,fetch:!1,windowId:n,sync:!this._async,method:this._method};["error","abort","timeout","load"].forEach((function(t){e.addEventListener(t,(function(){null!==e.statusText&&void 0!==e.statusText&&(s.h2=""===e.statusText),e.responseURL&&(s.url=e.responseURL),b(e._url).forEach((function(t){s[t.parameterName]=e.getResponseHeader(t.headerName)})),s.patchDuration=performance.now()-s.patchStartTime,s.status=e.status,S(s),o&&o()}))})),s.patchStartTime=performance.now(),m.push(s),v(s),c.apply(this,arguments)}}(e.XMLHttpRequest.prototype)}(e,n),f&&(e.fetch=function(e,t){!function(e,t){if(d){var n=d(e instanceof Request?e.url:e);"string"!=typeof e&&e.headers||(t||(t={}),t.headers||(t.headers=new Headers));var r=function(r){e instanceof Request&&e.headers?e.headers.has(r)||e.headers.set(r,n[r]):t.headers instanceof Headers?t.headers.has(r)||t.headers.set(r,n[r]):t.headers instanceof Array?t.headers.some((function(e){return e[0]===r}))||t.headers.push([r,n[r]]):t.headers[r]||(t.headers[r]=n[r])};for(var a in n)r(a)}}(e,t);var r="string"==typeof e?e:e.url,a={url:r,patchStartTime:Math.round(performance.now()),fetch:!0,windowId:n,sync:!1,method:e instanceof Request?e.method:"GET"};m.push(a),v(a);var i=f(e,t);return i.then((function(e){return null!==e.statusText&&void 0!==e.statusText&&(a.h2=""===e.statusText),b(r).forEach((function(t){a[t.parameterName]=e.headers.get(t.headerName)})),a.status=e.status,S(a),e.clone().arrayBuffer()})).then((function(){a.patchDuration=Math.round(performance.now()-a.patchStartTime)})),i})}function v(e){g.forEach((function(t){try{t(e)}catch(e){setTimeout((function(){throw e}),0)}}))}function S(e){h.forEach((function(t){try{t(e)}catch(e){setTimeout((function(){throw e}),0)}}))}t.setAdditionalHeadersGetter=function(e){d=e},t.setStopwatchHeadersGetter=function(e){p=e},t.setNetworkRequestTypeFilter=function(e){l=e},t.getNetworkRequestTypeFilter=function(){return l},t.setNetworkRequestTrackingFilter=function(e){u=e},t.shouldUseNetworkRequest=y,t.getNetworkRequestsForVerification=function(e){return e.reduce((function(e,t){return y(t.parameters&&t.parameters[c.RESOURCE_NAME])&&e.push(t),e}),[])},t.getNetworkRequests=function(){return m},t.resetNetworkRequests=function(){m=[]},t.patchNetworkRequests=function(){_(window,"MainWindow"),o.forEachAdditionalWindow((function(e){_(e.contentWindow,e.id)}))},t.patchNetworkRequestsOnWindow=_,t.addNetworkRequestListener=function(e){return g.push(e),function(){g.splice(g.indexOf(e),1)}},t.addNetworkResponseListener=function(e){return h.push(e),function(){h.splice(h.indexOf(e),1)}}},Wbnz:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("uZvv"),a=n("iYXG");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class i{constructor(e,t,n,r,a,i,o){this._id=e,this._entityTypeName=t,this._title=r,this._icon=i,this._onClickHandler=a,this._subActionDescriptor=o}get id(){return this._id}get entityTypeName(){return this._entityTypeName}get title(){return this._title}get icon(){return this._icon}get subActionDescriptor(){return this._subActionDescriptor}get onClickHandler(){return this._onClickHandler}get isSelected(){return this._isSelected}set isSelected(e){this._isSelected=e}static FromStateItem(e,t){return e.Id?function(e,t){const n=Object(a.b)(e),o=e.Titles&&e.Titles.length?e.Titles[0].Title:"";let s;const c=new i(e.Id,e.Entity,e.DynamicPage,o,(t,n,r,a)=>a(e,t,n,r),n,s);Object(r.c)(t)===c.id&&(c.isSelected=!0);return c}(e,t):null}}},Wc1c:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r,a=n("mMyr"),i=(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=function(e){function t(t){var n=e.call(this,t)||this;return n.state={portals:new Map},n}return i(t,e),t.prototype.bindDOMElement=function(e,t,n,r){if(!t.isRemoveChildPatched){var a=t.removeChild,i=this.props.onError;t.removeChild=function(){try{return a.apply(this,arguments)}catch(e){if("NotFoundError"!==e.name&&"HierarchyRequestError"!==e.name)throw i&&i(e),e}},t.isRemoveChildPatched=!0}this.setState((function(r){var a=new Map(r.portals);return a.set(t,{element:e,id:n}),{portals:a}}),r)},t.prototype.unbindDOMComponent=function(e,t){this.setState((function(t){var n=new Map(t.portals);return n.forEach((function(t,r){t.id===e&&n.delete(r)})),{portals:n}}),t)},t.prototype.componentDidCatch=function(e){if("Failed to execute 'removeChild' on 'Node': The node to be removed is not a child of this node."!==e.message)throw e},t.prototype.render=function(){var e=this,t=[];return this.state.portals.forEach((function(n,r){t.push(e.props.renderReactSubtree(n.element,r))})),t},t}(a.Component)},Wc7r:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UPLOAD_FILENAME_URL_FRAGMENT=t.APP_ENTITY=t.WEB_API_URL_FRAGMENT=t.EXECUTION_HINTS=t.HEADER_VALUES=t.HEADER=void 0,
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
t.HEADER={ACCEPT:"Accept",PREFER:"Prefer",AUTO_DISASSOCIATE:"AutoDisassociate",IF_MATCH:"If-match",AUTHORIZATION_HEADER:"Authorization",CONSISTENCY:"Consistency",CONTENT_LENGTH:"Content-Length",CONTENT_TYPE:"Content-Type",CONTENT_ID:"Content-Id",RETRY_AFTER:"Retry-After",MSCRM_SUPPRESS_DUPLICATION_DETECTION:"MSCRM.SuppressDuplicateDetection",MSCRM_RETURN_NOTIFICATIONS:"MSCRM.ReturnNotifications",CLIENT_REQUEST_ID:"x-ms-client-request-id",SERVER_REQUEST_ID:"x-ms-service-request-id",SESSION_ID:"x-ms-client-session-id",SOURCE_ID:"x-ms-source-id",CORRELATION_ID:"x-ms-correlation-id",MS_USER_AGENT:"x-ms-user-agent",APP_ID:"x-ms-app-id",APP_NAME:"x-ms-app-name",OBJECT_ID:"x-ms-sw-objectid",TENANT_ID:"x-ms-sw-tenantid",CLIENT_HOST:"ClientHost",MSCRM_SOLUTION_UNIQUE_NAME:"MSCRM.SolutionUniqueName",VIEW_ID_HINT:"x-ms-mdl-viewId",PAGESIZE_HINT:"x-ms-mdl-pageSize",PAGE_NUMBER_HINT:"x-ms-mdl-pageNumber",SEARCH_HINT:"x-ms-mdl-search",FILTER_HINT:"x-ms-mdl-filter",ORDERBY_HINT:"x-ms-mdl-orderby",SELECT_HINT:"x-ms-mdl-select",LINK_HINT:"x-ms-mdl-link",EXECUTION_HINT:"x-ms-mdl-execution-hints",CONTEXT_FILTER:"x-ms-mdl-contextFilter",MERGE_QUICKFIND:"x-ms-mdl-mergeQuickFind",OPERATION_INFO:"x-ms-mdl-operation-info",FILE_URL:"x-ms-mdl-fileUrl",FILE_SIZE:"x-ms-mdl-fileSize",MIME_TYPE:"x-ms-mdl-mimeType",UPSYNC_REQUEST_HINT:"x-ms-mdl-upsync-request",SUPPRESS_TRIGGERS_HINT:"x-ms-mdl-suppress-triggers"},t.HEADER_VALUES={APPLICATION_JSON:"application/json",TEXT_HTML:"text/html",ANNOTATIONS:'odata.include-annotations="*"',STRONG:"Strong"},t.EXECUTION_HINTS={OFFLINE:"Offline",ONLINE:"Online",OFFLINE_THEN_ONLINE:"OfflineThenOnline"},t.WEB_API_URL_FRAGMENT="/api/data/v9.0/",t.APP_ENTITY="appmodules",t.UPLOAD_FILENAME_URL_FRAGMENT="?x-ms-file-name="},WePp:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return o}));var r=n("pEXn");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a=[];function i(e){a.push(e)}class o{constructor(e){this._timestamp=new Date,this._activityId="",this._eventname=e,this._eventParameters={},this._eventParameters[r.g.EventContext]={},this._eventParameters[r.d.ActionContext]={}}getEventTimestamp(){return this._timestamp}getActivityId(){return this._activityId}toAriaEventData(){const e={};for(const t in this._eventParameters){let n=this._eventParameters[t];if(!(null!=n&&0===Object.keys(n).length&&n.constructor===Object)){if(r.g.EventContext===t||r.d.ActionContext===t)try{for(const e of a)if(!e.eventNames||e.eventNames.includes(this._eventname))try{n=e.sanitize(this._eventname,this._eventParameters,n)}catch(t){n=`${e.diagnosticName} failed to sanitize: ${t.message}`;break}n=JSON.stringify(n)}catch(e){n="Failed to stringify: "+e.message}e[t]=s(n)}}return{ActivityId:this._activityId,EventName:this._eventname,EventValues:e}}toSendJSON(){const e={};for(const t in this._eventParameters){let n=this._eventParameters[t],a=!0;const i=!(null==n||0!==Object.keys(n).length||n.constructor!==Object);if(r.g.EventContext===t||r.d.ActionContext===t)if(i)a=!1;else try{n=JSON.stringify(n)}catch(e){n="Failed to stringify: "+e.message}a&&(e[t]=n)}return{ActivityId:this._activityId,EventName:this._eventname,EventValues:e}}fromJSON(e){const t=Object.create(o.prototype);return Object.assign(t,e)}getEventName(){return this._eventname}_addContextParameter(e,t,n){this._eventParameters[e][t]=n}_getContextParameter(e,t){return t in this._eventParameters[e]?this._eventParameters[e][t]:""}addEventParameter(e,t,n=!1){void 0===e&&(e="undefined"),void 0===t&&(t="undefined");const a=Object(r.t)(this.getEventName());r.g.ActivityId===e?this._activityId=""+t:!a&&Object(r.s)(e)?this._addContextParameter(r.d.ActionContext,e,t):n?(this._eventParameters[e]=t,this._addContextParameter(r.g.EventContext,e,t)):a||Object(r.u)(this.getEventName(),e)?(null!==this._eventParameters[e]&&void 0!==this._eventParameters[e]&&this._addContextParameter(r.g.EventContext,e,this._eventParameters[e]),this._eventParameters[e]=t):this._addContextParameter(r.g.EventContext,e,t)}getEventParameter(e){let t="";const n=Object(r.t)(this.getEventName());r.g.ActivityId===e?t=this._activityId:!n&&Object(r.s)(e)?t=this._getContextParameter(r.d.ActionContext,e):n||Object(r.u)(this.getEventName(),e)?this._eventParameters[e]&&(t=this._eventParameters[e]):t=this._getContextParameter(r.g.EventContext,e);return{name:e,value:t}}}function s(e){let t;if("string"==typeof e||"number"==typeof e||"boolean"==typeof e)t=e;else if(e instanceof Date)t=e.toISOString();else try{t=JSON.stringify(e)}catch(e){t="Failed to stringify: "+e.message}return t}},Wgxh:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e,t){if(e||(e=[]),-1===e.indexOf(t))return e.push(t),e}function a(e,t){if(!e)return;const n=e.indexOf(t);return-1!==n?1===e.length?[]:(e.splice(n,1),e):void 0}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}))},Wiik:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="preview.form.setConsistencyStrong";function a(e){return{type:r,payload:e}}},WkRo:function(e,t,n){"use strict";n.d(t,"c",(function(){return l})),n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return d}));var r=n("m2nm"),a=n("pF61"),i=n("0kGT"),o=n("RiEM"),s=n("oT5e"),c=n("InN9");function l(e){return{type:"updateBackButtonBehavior",sync:!0,execute({dispatch:t,getState:n},i){const o=i.Router,s=(0===o.getDialogIdStack().length||1===o.getDialogIdStack().length&&o.getDialogIdStack()[0].includes(c.a))&&1===o.getHistoryManager().GetHistoryLength({targetBrowsingContext:e});Object(a.e)(n(),e)!==s&&(t(Object(r.b)(s,e)),u())}}}function u(){let e;try{e=new Event("routerBackButtonChanged")}catch(t){e=document.createEvent("Event");const n=!1,r=!1;e.initEvent("routerBackButtonChanged",n,r)}document.dispatchEvent(e)}function d(e){const t=Object(s.g)(e);return Object(i.c)(e)?!Object(a.e)(e,t)||!Object(o.c)(e):!Object(a.e)(e,t)}},Wlg7:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class r{constructor(e){this._preventDefault=e||!1}isDefaultPrevented(){return this._preventDefault}preventDefault(){this._preventDefault=!0}}},WvT0:function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},Wz2A:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r={True:{toString:()=>"true"},False:{toString:()=>"false"},Skipped:{toString:()=>"skipped"},TimedOutDefaultTrue:{toString:()=>"timed out, default value true"},TimedOutDefaultFalse:{toString:()=>"timed out, default value false"},ErrorDefaultTrue:{toString:()=>"error, default value true"},ErrorDefaultFalse:{toString:()=>"error, default value false"},Offline:{toString:()=>"offline"}};function a(e){return!1===e?r.False:r.True}function i(e,t){return e.some(e=>!1===e||e===r.False)?r.False:t&&e.some(e=>e===r.Skipped)?r.Skipped:e.some(e=>e===r.TimedOutDefaultFalse||e===r.Offline||e===r.ErrorDefaultFalse)?r.False:r.True}},X37l:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r,a;n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),function(e){e[e.Invalid="Invalid"]="Invalid",e[e.Entity="Entity"]="Entity",e[e.Grid="Grid"]="Grid",e[e.Isv="Isv"]="Isv"}(r||(r={})),function(e){e[e.Invalid=-1]="Invalid",e[e.Entity=0]="Entity",e[e.Grid=1]="Grid",e[e.Isv=2]="Isv"}(a||(a={}))},X3qb:function(e,t,n){"use strict";n.d(t,"f",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"e",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return c})),n.d(t,"g",(function(){return l}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="Related_Tab_Label",a="Web.Tools.FormEditor.TabName",i="Grid.Search.ViewTitle.Format",o="Web.Tabs.MoreTabs",s="Web.Form.EditForm.Label",c="UCI_Form_BulkEdit_Header_Tab",l=[r,a,i,o,"Web.SemanticZoom.Button",s,c]},X6wG:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("3BuU"),a=n("sDlx"),i=n("1DaZ"),o=n("Ri7K"),s=n("Ckvi"),c=n("E+70"),l=n("RHUE"),u=n("mf7K"),d=n("vPXf"),p=n("XSLb"),f=n("3VnW"),g=function(){function e(e){this._apiKey=e,this._contextProperties=new i.default,this._semanticContext=new p.default(!1,this._contextProperties),this._sessionStartTime=0,this._createInitId()}return e.prototype.setContext=function(e,t,n){void 0===n&&(n=r.AWTPropertyType.Unspecified),this._contextProperties.setProperty(e,t,n)},e.prototype.setContextWithPii=function(e,t,n,a){void 0===a&&(a=r.AWTPropertyType.Unspecified),this._contextProperties.setPropertyWithPii(e,t,n,a)},e.prototype.setContextWithCustomerContent=function(e,t,n,a){void 0===a&&(a=r.AWTPropertyType.Unspecified),this._contextProperties.setPropertyWithCustomerContent(e,t,n,a)},e.prototype.getSemanticContext=function(){return this._semanticContext},e.prototype.logEvent=function(t){if(u.default.loggingEnabled){this._apiKey||(this._apiKey=u.default.defaultTenantToken,this._createInitId());var n=!0;o.isString(t)?t={name:t}:t instanceof i.default&&(t=t.getEvent(),n=!1),s.default.eventReceived(this._apiKey),e._logEvent(e._getInternalEvent(t,this._apiKey,n),this._contextProperties)}},e.prototype.logSession=function(t,n){if(u.default.sessionEnabled){var i={name:"session",type:"session",properties:{}};if(e._addPropertiesToEvent(i,n),i.priority=r.AWTEventPriority.High,t===a.AWTSessionState.Started){if(this._sessionStartTime>0)return;this._sessionStartTime=(new Date).getTime(),this._sessionId=o.newGuid(),this.setContext("Session.Id",this._sessionId),i.properties["Session.State"]="Started"}else{if(t!==a.AWTSessionState.Ended)return;if(0===this._sessionStartTime)return;var s=Math.floor(((new Date).getTime()-this._sessionStartTime)/1e3);i.properties["Session.Id"]=this._sessionId,i.properties["Session.State"]="Ended",i.properties["Session.Duration"]=s.toString(),i.properties["Session.DurationBucket"]=e._getSessionDurationFromTime(s),this._sessionStartTime=0,this.setContext("Session.Id",null),this._sessionId=void 0}i.properties["Session.FirstLaunchTime"]=f.default.firstLaunchTime,this.logEvent(i)}},e.prototype.getSessionId=function(){return this._sessionId},e.prototype.logFailure=function(t,n,a,i,o){if(t&&n){var s={name:"failure",type:"failure",properties:{}};e._addPropertiesToEvent(s,o),s.properties["Failure.Signature"]=t,s.properties["Failure.Detail"]=n,a&&(s.properties["Failure.Category"]=a),i&&(s.properties["Failure.Id"]=i),s.priority=r.AWTEventPriority.High,this.logEvent(s)}},e.prototype.logPageView=function(t,n,r,a,i,o){if(t&&n){var s={name:"pageview",type:"pageview",properties:{}};e._addPropertiesToEvent(s,o),s.properties["PageView.Id"]=t,s.properties["PageView.Name"]=n,r&&(s.properties["PageView.Category"]=r),a&&(s.properties["PageView.Uri"]=a),i&&(s.properties["PageView.ReferrerUri"]=i),this.logEvent(s)}},e.prototype._createInitId=function(){!e._initIdMap[this._apiKey]&&this._apiKey&&(e._initIdMap[this._apiKey]=o.newGuid())},e._addPropertiesToEvent=function(e,t){if(t)for(var n in t instanceof i.default&&(t=t.getEvent()),t.name&&(e.name=t.name),t.priority&&(e.priority=t.priority),t.properties)t.properties.hasOwnProperty(n)&&(e.properties[n]=t.properties[n])},e._getSessionDurationFromTime=function(e){return e<0?"Undefined":e<=3?"UpTo3Sec":e<=10?"UpTo10Sec":e<=30?"UpTo30Sec":e<=60?"UpTo60Sec":e<=180?"UpTo3Min":e<=600?"UpTo10Min":e<=1800?"UpTo30Min":"Above30Min"},e._logEvent=function(e,t){e.name&&o.isString(e.name)?(e.name=e.name.toLowerCase(),e.name=e.name.replace(o.EventNameDotRegex,"_"),e.type&&o.isString(e.type)?e.type=e.type.toLowerCase():e.type="custom",o.EventNameAndTypeRegex.test(e.name)&&o.EventNameAndTypeRegex.test(e.type)?((!o.isNumber(e.timestamp)||e.timestamp<0)&&(e.timestamp=(new Date).getTime()),e.properties||(e.properties={}),this._addContextIfAbsent(e,t.getPropertyMap()),this._addContextIfAbsent(e,u.default.logManagerContext.getPropertyMap()),this._setDefaultProperty(e,"EventInfo.InitId",this._getInitId(e.apiKey)),this._setDefaultProperty(e,"EventInfo.Sequence",this._getSequenceId(e.apiKey)),this._setDefaultProperty(e,"EventInfo.SdkVersion",d.FullVersionString),this._setDefaultProperty(e,"EventInfo.Name",e.name),this._setDefaultProperty(e,"EventInfo.Time",new Date(e.timestamp).toISOString()),o.isPriority(e.priority)||(e.priority=r.AWTEventPriority.Normal),this._sendEvent(e)):c.default.eventsRejected([e],r.AWTEventsRejectedReason.InvalidEvent)):c.default.eventsRejected([e],r.AWTEventsRejectedReason.InvalidEvent)},e._addContextIfAbsent=function(e,t){if(t)for(var n in t)t.hasOwnProperty(n)&&(e.properties[n]||(e.properties[n]=t[n]))},e._setDefaultProperty=function(e,t,n){e.properties[t]={value:n,pii:r.AWTPiiKind.NotSet,type:r.AWTPropertyType.String}},e._sendEvent=function(e){l.default.sendEvent(e)},e._getInternalEvent=function(e,t,n){if(e.properties=e.properties||{},n)for(var r in e.properties)e.properties.hasOwnProperty(r)&&(e.properties[r]=o.sanitizeProperty(r,e.properties[r]),null===e.properties[r]&&delete e.properties[r]);var a=e;return a.id=o.newGuid(),a.apiKey=t,a},e._getInitId=function(t){return e._initIdMap[t]},e._getSequenceId=function(t){return void 0===e._sequenceIdMap[t]&&(e._sequenceIdMap[t]=0),(++e._sequenceIdMap[t]).toString()},e._sequenceIdMap={},e._initIdMap={},e}();t.default=g},X7Nv:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));n("pgSX"),n("si7p"),n("GYEz"),n("YxC/"),n("EY5k"),n("tICD");var r=n("IqkD");n("Uv1Y"),n("91WF");var a;
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */n("SAYH");!function(e){e[e.None=0]="None",e[e.PromptBeforeReport=1]="PromptBeforeReport",e[e.AutoReport=2]="AutoReport",e[e.NeverReport=3]="NeverReport"}(a||(a={}));n("fU7K");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t){return{type:"form.unhandled.error.dialog",execute(e,t,n){const a=Object(r.x)(e.getState());if(null==a)return Promise.resolve();a.userReportScriptErrors;return Promise.resolve()}}}},XIaj:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n("6eYz"),a=n("zsAz");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i="add.popupNotificationAction";function o(e){return{type:"add.popupNotificationAction.async",execute({dispatch:t,getState:n},o){const s=e.details,c={};if(s){const e=Object.keys(s),t=e.length<=4?e.length:4;for(let n=0;n<t;n++)c[e[n]]=s[e[n]];if(e.length>4){const t=[];t.push({name:"detailsItemNumber",value:e.length}),t.push({name:"DetailsItemLimit",value:4});o.TraceManager.getTracer("PopupNotification").warn("The number of name/value pair provided as detals to addPopupNotification execeeds the limit",t)}}const l={type:i,payload:{props:Object.assign(Object.assign({},e),{details:c})}},u=Object(r.b)(n());return 1===(u?Object.keys(u):[]).length?Promise.reject(Object(a.d)("A popup notification is already opened",2415919123)):Promise.resolve(t(l))}}}},XOSd:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return d}));var r=n("GYEz"),a=n("w1eR"),i=n("Lyxw"),o=n("3/02"),s=n("H4dV"),c=n("1RM4");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function l(e,t){const n=Object(r.a)(e)===a.a.MailApp,c=s.a.getInstance().get_IsBrowserEdge();return!n&&Object(i.f)(e,o.Jg)&&!c}function u(e){navigator.serviceWorker&&navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage({name:c.b})}function d(){navigator.serviceWorker&&navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage({name:c.a,data:{}})}},XSLb:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("3VnW"),a=n("3BuU"),i=n("sDlx"),o=function(){function e(e,t){this._allowDeviceFields=e,this._properties=t}return e.prototype.setAppId=function(e){this._addContext("AppInfo.Id",e)},e.prototype.setAppVersion=function(e){this._addContext("AppInfo.Version",e)},e.prototype.setAppLanguage=function(e){this._addContext("AppInfo.Language",e)},e.prototype.setDeviceId=function(e){this._allowDeviceFields&&(r.default.checkAndSaveDeviceId(e),this._addContext("DeviceInfo.Id",e))},e.prototype.setDeviceOsName=function(e){this._allowDeviceFields&&this._addContext("DeviceInfo.OsName",e)},e.prototype.setDeviceOsVersion=function(e){this._allowDeviceFields&&this._addContext("DeviceInfo.OsVersion",e)},e.prototype.getDeviceBrowserName=function(){var e=this._properties.getPropertyMap()["DeviceInfo.BrowserName"];return e?e.value.toString():""},e.prototype.setDeviceBrowserName=function(e){this._allowDeviceFields&&this._addContext("DeviceInfo.BrowserName",e)},e.prototype.getDeviceBrowserVersion=function(){var e=this._properties.getPropertyMap()["DeviceInfo.BrowserVersion"];return e?e.value.toString():""},e.prototype.setDeviceBrowserVersion=function(e){this._allowDeviceFields&&this._addContext("DeviceInfo.BrowserVersion",e)},e.prototype.setDeviceMake=function(e){this._allowDeviceFields&&this._addContext("DeviceInfo.Make",e)},e.prototype.setDeviceModel=function(e){this._allowDeviceFields&&this._addContext("DeviceInfo.Model",e)},e.prototype.setUserId=function(e,t,n){if(!isNaN(n)&&null!==n&&n>=0&&n<=12)this._addContext("UserInfo.IdType",n.toString());else{var r=void 0;switch(t){case a.AWTPiiKind.SipAddress:r=i.AWTUserIdType.SipAddress;break;case a.AWTPiiKind.PhoneNumber:r=i.AWTUserIdType.PhoneNumber;break;case a.AWTPiiKind.SmtpAddress:r=i.AWTUserIdType.EmailAddress;break;default:r=i.AWTUserIdType.Unknown}this._addContext("UserInfo.IdType",r.toString())}if(isNaN(t)||null===t||t===a.AWTPiiKind.NotSet||t>13)switch(n){case i.AWTUserIdType.Skype:t=a.AWTPiiKind.Identity;break;case i.AWTUserIdType.EmailAddress:t=a.AWTPiiKind.SmtpAddress;break;case i.AWTUserIdType.PhoneNumber:t=a.AWTPiiKind.PhoneNumber;break;case i.AWTUserIdType.SipAddress:t=a.AWTPiiKind.SipAddress;break;default:t=a.AWTPiiKind.NotSet}this._addContextWithPii("UserInfo.Id",e,t)},e.prototype.setUserAdvertisingId=function(e){this._addContext("UserInfo.AdvertisingId",e)},e.prototype.setUserTimeZone=function(e){this._addContext("UserInfo.TimeZone",e)},e.prototype.setUserLanguage=function(e){this._addContext("UserInfo.Language",e)},e.prototype._addContext=function(e,t){"string"==typeof t&&this._properties.setProperty(e,t)},e.prototype._addContextWithPii=function(e,t,n){"string"==typeof t&&this._properties.setPropertyWithPii(e,t,n)},e}();t.default=o},"Xd5/":function(e,t,n){"use strict";n.d(t,"B",(function(){return P})),n.d(t,"C",(function(){return N})),n.d(t,"c",(function(){return L})),n.d(t,"D",(function(){return B})),n.d(t,"y",(function(){return U})),n.d(t,"E",(function(){return V})),n.d(t,"x",(function(){return z})),n.d(t,"w",(function(){return q})),n.d(t,"o",(function(){return H})),n.d(t,"k",(function(){return W})),n.d(t,"i",(function(){return G})),n.d(t,"z",(function(){return K})),n.d(t,"u",(function(){return Q})),n.d(t,"v",(function(){return X})),n.d(t,"p",(function(){return Y})),n.d(t,"m",(function(){return J})),n.d(t,"l",(function(){return $})),n.d(t,"j",(function(){return Z})),n.d(t,"e",(function(){return ee})),n.d(t,"d",(function(){return te})),n.d(t,"r",(function(){return ne})),n.d(t,"n",(function(){return re})),n.d(t,"t",(function(){return ae})),n.d(t,"s",(function(){return ie})),n.d(t,"q",(function(){return oe})),n.d(t,"g",(function(){return se})),n.d(t,"h",(function(){return ce})),n.d(t,"A",(function(){return le})),n.d(t,"b",(function(){return ue})),n.d(t,"a",(function(){return de})),n.d(t,"f",(function(){return fe}));var r=n("MXaZ"),a=n("lcrw"),i=n("zh0k"),o=n("RVeV"),s=n("NjDY"),c=n("CpcI"),l=n("YxC/"),u=n("IqkD"),d=n("L6aH"),p=n("0fHr"),f=n("RREX"),g=n("Xd5/"),h=n("504W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const m=String.fromCharCode(41),b=["/","-",".",". "];function y(e){return j(e,"CurrencyDecimalDigits")}function _(e){return j(e,"PricingDecimalPrecision")}function v(e){return j(e,"CurrencySymbol")}function S(e){return j(e,"NumberGroupSeparator")}function O(){return d.a.UserLocal}function C(e){return I(e,"ShortDatePattern","DateSeparator","/")}function E(e){return I(e,"ShortTimePattern","TimeSeparator",":")}function I(e,t,n,r){return e.dateTimeFormat[t].toString().replace(new RegExp(r,"g"),e.dateTimeFormat[n].toString())}function w(e,t){const n=e.dateTimeFormat.DateSeparator;let r=null;r=t.endsWith(n)?t.substring(0,t.length-1):t.concat(n);const a=[t,r],i="\\"+n,o=b.filter(e=>e!==i),s=new RegExp(i,"g");return a.reduce((e,t)=>e.concat(o.map(e=>t.replace(s,e))),[])}function j(e,t){return e.numberFormat[t]}function P(e){switch(e){case 1:return"-{0}";case 2:return"-"+m+"{0}";case 3:return"{0}-";case 4:return"{0}"+m+"-";default:return"({0})"}}function T(e,t,n){return Object(i.b)(e,"N"+(null!=n?n:function(e){return j(e,"NumberDecimalDigits")}(t)),t)}function N(e){const t=e.controlAttributes.Precision,n=e.controlAttributes.PrecisionSource;let r=t;if(n===f.a.organization)r=_(e.cultureInfo);else if(null==r||n===f.a.currency){const t=y(e.cultureInfo);null!=t&&(r=t)}return r}function A(e){return null==e?0:e}function R(e,t){if(null==e||""===e.trim())return null;const n=v(t);return x(e=e.split(n).join(""),function(e){return j(e,"CurrencyGroupSeparator")}(t),function(e){return j(e,"CurrencyDecimalSeparator")}(t))}function D(e,t){return x(e,S(t),function(e){return j(e,"NumberDecimalSeparator")}(t))}function x(e,t,n){if(null==e||""===e.trim())return null;const r=e.lastIndexOf(n);let a="";return-1!==r&&(a=e.slice(r),e=e.slice(0,-a.length)),e=e.split(t).join(""),e=(e+=a).split(n).join("."),Number(F(e))}function M(e,t,n,r,a,i){if(null==e||""===e.trim())return null;let s=parseInt(n,10);if(isNaN(s))switch(n){case p.b.duration:s=o.a.DURATION;break;case p.b.timeZone:s=o.a.TIMEZONE;break;case p.b.language:s=o.a.LANGUAGE}switch(s){case o.a.DURATION:return function(e,t){const n=e.split(" ");if(n.length>=2){const e=Object(l.c)(t,c.c).toLocaleLowerCase(),r=Object(l.c)(t,c.d).toLocaleLowerCase(),a=Object(l.c)(t,c.a).toLocaleLowerCase(),i=Object(l.c)(t,c.b).toLocaleLowerCase();if(!(e&&r&&a&&i))return null;const o=[e,r],s=[a,i],u=n[1].toLocaleLowerCase(),d=parseFloat(n[0].replace(",","."));let p=0;return p=-1!==o.indexOf(u)?60*d:-1!==s.indexOf(u)?60*d*24:d,Math.round(p)}return parseInt(n[0],10)}(e,i);case o.a.TIMEZONE:for(const t in r.timeZoneDefinitionByCode)if(r.timeZoneDefinitionByCode[t].userInterfaceName.toLowerCase()===e.toLowerCase())return r.timeZoneDefinitionByCode[t].timeZoneCode;break;case o.a.LANGUAGE:for(const t in a)if(a[t]&&a[t].toLowerCase()===e.toLowerCase())return parseInt(t,10)}const u=S(t);return e=e.split(u).join(""),Number(F(e))}function F(e){const t=e.includes("-")||e.includes("(")&&e.includes(")");return e=e.replace(/\(|\)|\-/g,"").trim(),t&&(e="-"+e),e}function k(e,t){switch(t){case r.c:case r.a:return C(e)+" "+E(e);case r.d:case r.b:default:return C(e)}}function L(e){const{formatInfoCultureName:t,numberFormatInfo:n,dateFormatInfo:r}=e;return new Sys.CultureInfo(t,n,r)}function B(e){switch(e.controlAttributes.Type){case"money":case"double":case"decimal":case"float":case"integer":return!0;default:return!1}}function U(e,t,n){let a=null;if(!Object(h.a)(e))switch(t.controlAttributes.Type){case"money":a=g.o(e,t);break;case"double":case"decimal":case"float":a=g.k(e,t.controlAttributes.Precision,t.cultureInfo);break;case r.c:a=g.i(e,t.userSettings,t.cultureInfo,t.controlAttributes.Format,t.controlAttributes.Behavior);break;case"integer":a=g.z(e,t.userSettings,t.cultureInfo,t.controlAttributes.Format,t.languagesByCode,n);break;case"picklist":case"state":case"status":a=g.p(e,t.controlAttributes.OptionSet);break;case"boolean":a=g.d(e,t.controlAttributes.OptionSet);break;case"string":case"memo":a=g.u(e,t.controlAttributes.Format);break;case"lookup":case"customer":case"owner":a="string"==typeof e?g.u(e,t.controlAttributes.Format):g.u(e.name,t.controlAttributes.Format);break;case"multiselectpicklist":a=function(e,t){if(!t)return;if(!e||0===e.length)return;const n=[];for(const r in e){const a=t.filter(t=>null!==t.Value&&void 0!==t.Value&&t.Value===e[r]);a&&a.length>0&&n.push(a[0].Label)}return n.length>0?n.join("; "):void 0}(e,t.controlAttributes.OptionSet);break;default:a=e}return a}function V(e,t,n,a,i){switch(t.controlAttributes.Type){case"money":return R(e,n);case"double":case"decimal":case"float":return D(e,n);case r.c:return function(e,t,n,a){if(null==e)return null;const i=de(e,t,n,a);switch(a.controlAttributes.Behavior){case d.a.UserLocal:return Object(r.l)(i,a.userSettings.timeZoneUtcOffsetMinutes,a.userSettings.timeZoneAdjusters);case d.a.TimeZoneIndependent:case d.a.DateOnly:return Object(r.k)(i);default:return i}}(e,a,n,t);case"integer":return M(e,n,a,t.userSettings,t.languagesByCode,i);case"string":return null==e?null:e;case"boolean":return function(e,t){if(null==e)return null;if("string"==typeof e){const n=t.filter(t=>t.Label===e);if(1===n.length)return 1===n[0].Value}else{if("number"==typeof e)return 1===e;if("boolean"==typeof e)return e}return null}(e,t.controlAttributes.OptionSet);case"multiselectpicklist":return function(e,t){if(!e||!(null==t?void 0:t.length))return[];const n=e.split("; ");if(!(null==n?void 0:n.length))return[];const r={};return t.forEach(e=>r[e.Label]=e.Value),n.map(e=>r[e])}(e,t.controlAttributes.OptionSet);default:return null}}function z(e,t,n){const a=null==t?void 0:t.timeZoneUtcOffsetMinutes,i=null==t?void 0:t.timeZoneAdjusters;return n===d.a.None?Object(r.P)(e,a,i,n).toString():Object(r.P)(Object(r.I)(e),a,i,n).toString()}function q(e,t,n){const a=new Date(e),i=null==t?void 0:t.timeZoneUtcOffsetMinutes,o=null==t?void 0:t.timeZoneAdjusters;return Object(r.q)(a,i,n,o)}function H(e,t){if(null!=e){let n=e;if("string"==typeof n&&(n=R(e.toString(),t.cultureInfo)),null!=n&&!isNaN(n))return function(e,t){const n=N(t),r=Object(i.b)(e,"C"+n,t.cultureInfo),a=v(t.cultureInfo);return null!=a?r.replace(v(t.cultureInfo),a):r}(n,t)}}function W(e,t,n){if(null!=e){const r="number"==typeof e?e:D(e.toString(),n);if(null!=r&&!isNaN(r))return Z(r,n,t)}}function G(e,t,n,a,i){let o;var s;if("string"==typeof e?o=Object(r.o)(e):e&&(s=e,"[object Date]"===Object.prototype.toString.call(s))&&(o=e),o){const e=null==i?O():i;switch(a&&(a=a.toLowerCase()),a){case r.c:case r.a:return oe(o,n,e,t.timeZoneUtcOffsetMinutes,t.timeZoneAdjusters);case r.d:case r.b:default:return ne(o,n,e,t.timeZoneUtcOffsetMinutes,t.timeZoneAdjusters)}}}function K(e,t,n,r,a,s){if(null!=e){const u="number"==typeof e?e:M(e.toString(),n,r,t,a,s);if(isNaN(u))return;if(null!=u){let e=parseInt(r,10);if(isNaN(e))switch(r){case p.b.duration:e=o.a.DURATION;break;case p.b.timeZone:e=o.a.TIMEZONE;break;case p.b.language:e=o.a.LANGUAGE}switch(e){case o.a.DURATION:return function(e,t,n){if(isNaN(e))return null;const r=1e-8;if((e=e>0?e:0)<60){const r=Object(l.c)(n,c.e),a=Object(l.c)(n,c.f);return r&&a?String.format(Object(i.b)(e,"N0",t)+" {0}",1===e?r:a):null}const a=e<1440?e/60:e/1440,o=Math.abs(a%1)<=r||Math.abs(a%1-1)<=r?0:2,s=Object(i.b)(a,"N"+o,t),u=Object(l.c)(n,c.c),d=Object(l.c)(n,c.d),p=Object(l.c)(n,c.a),f=Object(l.c)(n,c.b);if(!(u&&d&&p&&f))return null;return e<1440?String.format(s+" {0}",Math.abs(a-1)<=r?u:d):String.format(s+" {0}",Math.abs(a-1)<=r?p:f)}(u,n,s);case o.a.TIMEZONE:return X(u,t);case o.a.LANGUAGE:return J(u,a);default:return $(u,n)}}}}function Q(e,t){if(e&&"string"==typeof e&&e.length)switch(t&&(t=t.toLowerCase()),e=e.trim(),t){case"text":case"textarea":case"email":case"phone":return e;case"url":return new RegExp("^([a-z][a-z0-9+.-]*://)|^(tel:|onenote:)|^/").test(e.toLowerCase())||""===e?e:"https://".concat(e);case"tickersymbol":return e.toLocaleUpperCase();default:return e.toString()}}function X(e,t){const n=t.timeZoneDefinitionByCode[e];return n?n.userInterfaceName:null}function Y(e,t){if(!t)return;let n;if("number"!=typeof e){if(n=parseInt(e,10),isNaN(n))return}else n=e;const r=t.filter(e=>null!==e.Value&&void 0!==e.Value&&e.Value===n);return r.length>0?r[0].Label:null}function J(e,t){if(!(isNaN(e)||e<-1))return null===e||t&&t[e]?t[e]:e.toString()}function $(e,t){return Z(e,t,0)}function Z(e,t,n){return e<0?function(e,t,n){const r=Math.abs(e);return String.format(P(j(t,"NumberNegativePattern")),T(r,t,n))}(e,t,n):T(e,t,n)}function ee(e,t,n,r,a){const o=function(e,t,n,r){let a=n;if(r===f.a.organization)a=_(t);else if(null==a||r===f.a.currency){const e=y(t);null==a&&(a=e)}return Object(i.b)(e,"C"+a,t)}(e,t,r,a);return null!=n?o.replace(v(t),n):o}function te(e,t){let n=e;if("boolean"==typeof e)n=!0===e?1:0;else if("number"==typeof e)n=e;else if("string"==typeof e&&(n=parseInt(e,10),isNaN(n)))return;if(!t)return;const r=t.filter(e=>e.Value===n);return r.length>0?r[0].Label:void 0}function ne(e,t,n,i,o){null==n&&(n=O());const s=Object(r.q)(e,A(i),n,o);return Object(a.a)(s,"d",t)}function re(e,t,n,i,o){null==n&&(n=O());const s=Object(r.q)(e,A(i),n,o);return Object(a.a)(s,"D",t)}function ae(e,t,n){null==n&&(n=O());return ie(e,t,n).split("T")[0]}function ie(e,t,n,i,o){const s=Object(r.q)(e,A(i),n,o);return Object(a.a)(s,"s",Sys.CultureInfo.CurrentCulture)}function oe(e,t,n,i,o){null==n&&(n=O());const s=C(t),c=E(t),l=Object(r.q)(e,A(i),n,o);return Object(a.a)(l,s+" "+c,t)}function se(e,t,n,i,o){null==n&&(n=O());const s=Object(r.q)(e,A(i),n,o);let c=function(e){return I(e,"LongDatePattern","DateSeparator","/")}(t);return c=c.replace("MMMM","MMM"),c=c.replace("dddd","ddd"),Object(a.a)(s,c,t)}function ce(e,t,n,i,o){null==n&&(n=O());const s=Object(r.q)(e,A(i),n,o);return Object(a.a)(s,"Y",t)}function le(e,t,n,r){if(!t)return null;const a=Object(u.x)(e),i=L(a);!function(e,t,n){let r=null;n&&n.reference&&n.reference.id?r=n.reference.id:e&&e.transactionCurrencyId&&(r=e.transactionCurrencyId);if(r&&e&&e.transactionCurrencyById){const n=e.transactionCurrencyById[r.guid];if(n){const e="CurrencySymbol",r="CurrencyDecimalDigits";t.numberFormat[e]=n.currencySymbol,t.numberFormat[r]=n.currencyPrecision}}}(a,i,n);const o={Type:t.Type,Precision:t.Precision,PrecisionSource:t.PrecisionSource,Format:t.Format,Behavior:t.Behavior,OptionSet:t.OptionSet};if(o.PrecisionSource===f.a.organization){const t=Object(s.D)(e),n="PricingDecimalPrecision";i.numberFormat[n]=t.pricingDecimalPrecision}return{controlAttributes:o,userSettings:a,cultureInfo:i,languagesByCode:Object(s.h)(e),fieldValueContext:{rawValue:r}}}function ue(e){return y(L(e))}function de(e,t,n,i){const o=function(e,t){const n=[];let a=t;a&&(a=a.toLowerCase());let i=k(e,a);i=i?i.trim():i;let o=null;a===r.d?o=r.c:a===r.c&&(o=r.d);let s=k(e,o);return s=s?s.trim():s,n.push(i,s),a===r.d?n.push(...w(e,i)):o===r.d&&n.push(...w(e,s)),n}(n,t);for(let t=0;t<o.length;t++){const n=Object(a.b)(e,o[t],i.cultureInfo);if(n)return pe(n,i)}return null}function pe(e,t){var n;let a=e;const i=null===(n=null==t?void 0:t.fieldValueContext)||void 0===n?void 0:n.rawValue;if(null!=i&&i.getFullYear){const t=i.getFullYear()-e.getFullYear();if(Math.abs(t)>1){const n=10*Math.floor(t/10),i=n+10,o=t-n>i-t?i:n;a=Object(r.j)(e,o)}}return a}function fe(e,t,n,r,i){const o=C(i),s=E(i),c=Object(a.a)(e,s,i);if(function(e){return ge(e,new Date)}(e))return t.replace("{0}",c);if(function(e){const t=new Date,n=new Date(t.setDate(t.getDate()-1));return ge(e,n)}(e))return n.replace("{0}",c);const l=Object(a.a)(e,o,i);return r.replace("{0}",l).replace("{1}",c)}function ge(e,t){return e.getDate()===t.getDate()&&e.getMonth()===t.getMonth()&&e.getFullYear()===t.getFullYear()}},Xe7f:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("5yoC");class a extends r.a{constructor(e,t,n,r,a,i){super(),this._target=null,this._suppressDuplicateDetection=!1,this._calculateMatchCodeSynchronously=!1,this._solutionUniqueName=null,this._maintainLegacyAppServerBehavior=!1,this._returnRowVersion=!1,this._target=e,this._suppressDuplicateDetection=t,this._calculateMatchCodeSynchronously=n,this._solutionUniqueName=r,this._maintainLegacyAppServerBehavior=a,this._returnRowVersion=i}get_name(){return"Create"}get_xmlNamespace(){return"http://schemas.microsoft.com/xrm/2011/Contracts"}get_target(){return this._target}get_suppressDuplicateDetection(){return this._suppressDuplicateDetection}get_calculateMatchCodeSynchronously(){return this._calculateMatchCodeSynchronously}get_solutionUniqueName(){return this._solutionUniqueName}get_maintainLegacyAppServerBehavior(){return this._maintainLegacyAppServerBehavior}get_returnRowVersion(){return this._returnRowVersion}set_returnRowVersion(e){return this._returnRowVersion=e,e}}},XgcG:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("nxt5");class a extends r.a{constructor(e,t){super("ExecuteMultiple"),this._isFaulted=!1,this._responses=null,this._isFaulted=e,this._responses=t}get_isFaulted(){return this._isFaulted}get_responses(){return this._responses}}},XhkN:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return i}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="businessProcessFlow.addBusinessProcessFlowUIStateData",a="businessProcessFlow.updateDisplayState",i="businessProcessFlow.setLibraryLoaded"},Xi8U:function(e,t,n){"use strict";n.d(t,"f",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"i",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"h",(function(){return p})),n.d(t,"c",(function(){return f})),n.d(t,"a",(function(){return g})),n.d(t,"g",(function(){return l})),n.d(t,"b",(function(){return d}));var r=n("X37l"),a=n("GWSs"),i=n("iZ7K");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function o(e){return e.recentItems?e.recentItems.recentItems:[]}function s(e){return e.recentItems.recentItems.filter(e=>!0===e.PinStatus).sort((e,t)=>t.LastAccessed-e.LastAccessed)}function c(e){return e.recentItems.recentItems.filter(e=>!e.PinStatus).sort((e,t)=>t.LastAccessed-e.LastAccessed)}function l(e,t=[]){const n=t.filter(e=>e.RecordType===r.a.Entity).map(t=>{const n=Object(i.j)(e,t.EntityTypeName,t.ObjectId);if(null==n)return null;return{type:"Subarea",id:t.ObjectId.toString(),iconPath:n}}).filter(Boolean);return Array.from(new Set(n))}function u(e){const{lastSynced:t,recentItems:n}=e.recentItems;return null==t?n:n.filter(e=>e.LastAccessed>t)}function d(e){return e.recentItems.deletedRecentItems}function p(e){return e.recentItems.lastSynced}function f(e){return e.recentItems.dropdownRecentsDescriptor}const g=function(){const e={};return(t,n)=>{if(e[n])return e[n];const r=Object(a.f)(t);if(!r)return null;for(const t of r.AreaIds){const a=r.Areas[t];for(const t of a.GroupIds){const r=a.Groups[t];for(const t of r.SubAreaIds){const a=r.SubAreas[t];if(a.Entity===n)return e[n]=a.VectorIcon,a.VectorIcon}}}return null}}()},XjOj:function(e,t,n){"use strict";n.d(t,"c",(function(){return z})),n.d(t,"l",(function(){return q})),n.d(t,"b",(function(){return H})),n.d(t,"k",(function(){return W})),n.d(t,"e",(function(){return G})),n.d(t,"d",(function(){return K})),n.d(t,"i",(function(){return Q})),n.d(t,"f",(function(){return X})),n.d(t,"g",(function(){return Y})),n.d(t,"h",(function(){return J})),n.d(t,"a",(function(){return $})),n.d(t,"j",(function(){return Z}));var r=n("Ydwo");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var a=n("504W"),i=n("2mBq"),o=n("Div0");class s{constructor(e,t,n,r,a,i,s,c,l,u,d,p,f,g,h){this._data={},this._message=null,this._setValue("l",e);const m=o.a[t];!m&&Q(o.a.framework,"TraceComponent not found. Component: "+t),this._setValue("s",m),n&&(this._setValue("st",n),this._setValue("h",r)),a&&this._setValue("em",a),i&&(this._setValue("est",i),this._setValue("eh",s)),c&&this._setValue("ci",c),l&&this._setValue("f",l);this._SetTrucatedValue("0",u,2500),this._SetTrucatedValue("1",d,2500),this._SetTrucatedValue("2",p,2500),this._SetTrucatedValue("3",f,2500),this._SetTrucatedValue("4",g,2500),this._SetTrucatedValue("5",h,2500)}getValue(e){return this._data[e]}_setValue(e,t){this._assertKeyValue(t),this._data[e]=t}_assertKeyValue(e){if(Object(a.a)(e))Q(o.a.framework,"Cannot set a key value to null/undefined");else{const t=typeof e;"function"===t&&Q(o.a.framework,"Cannot set a key to value with type "+t)}}get_sourceKeyIdentifier(){return"s"}get_exceptionMessageKeyIdentifier(){return"em"}get_stackTraceKeyIdentifier(){return"st"}get_exceptionStackTraceKeyIdentifier(){return"est"}get_message(){if(!this._message){let e=Object(i.a)(this.getValue("f"),this.getValue("0"),this.getValue("1"),this.getValue("2"),this.getValue("3"),this.getValue("4"),this.getValue("5"));Object(a.a)(this.getValue("em"))||(e+=Object(i.a)("{0}Exception message:{1}{0}Exception stack trace:{0}{2}Exception stack trace hash: {3}","\r\n",this.getValue("em"),this.getValue("est"),this.getValue("eh"))),Object(a.a)(this.getValue("st"))||(e+=Object(i.a)("{0}{1}Call stack hash: {2}","\r\n",this.getValue("st"),this.getValue("h")));const t=this.getValue("s");this._message=t?"["+t+"] "+e:e}return this._message}_SetTrucatedValue(e,t,n){let r=null;Object(a.a)(t)||(r=t.toString(),r&&this._setValue(e,r.length>n?r.substr(0,n):r))}}var c=n("pNM1");let l=!1;function u(e,t){if(function(e){if("undefined"==typeof console)return!1;if(z()<e)return!1;return!0}(e)){const n=t().get_message();switch(e){case c.a.Warning:console.warn(n);break;case c.a.Error:console.error(n);break;case c.a.Perf:case c.a.Info:case c.a.Verbose:console.info(n)}}}let d=null;class p{getExceptionStackTrace(e,t){return p.internalGetStackTrace(e,0,t)}getStackTrace(e,t){const n=new Error;return p.internalGetStackTrace(n,e,t)}static get_clientInfo(){return d||(d=function(){const e=window.navigator;return{"CPU Class":e.cpuClass,Platform:window.navigator.platform,"Browser language":e.browserLanguage||window.navigator.language,"Cookie enabled":window.navigator.cookieEnabled,"User agent":window.navigator.userAgent,"Document.Cookie":window.document.cookie}}()),d}static internalGetStackTrace(e,t,n){if(n.val=0,Object(a.a)(e))return"GenericBrowserErrorHandler.InternalGetStackTrace: Extended error information not available from this browser.";const r=e.stack;if(Object(a.a)(r))return"GenericBrowserErrorHandler.InternalGetStackTrace: Exception stack trace not available from this browser.";const o=r.split("\n");"Error"===o[0]&&(t+=1),n.val=0;let s="";for(let e=t;e<o.length;e++){const t=o[e];if(""===t)continue;const r=f(t),a=Object(i.b)(r);n.val^=a,s+=t+"\r\n"}return s}}function f(e){e.startsWith("    at ")&&(e=e.substr("    at ".length));e.startsWith("Function.")&&(e=e.substr("Function.".length));const t=e.indexOf("("),n=e.indexOf(" ");let r;if(-1===t&&-1===n)return"anonymous";r=t>0&&n>0?Math.min(t,n):Math.max(t,n);const a=e.substring(0,r),i=a.indexOf("$",0);if(-1===i)return"anonymous";const o=a.indexOf("$",i+1);if(-1===o)return a;const s=a.indexOf("$",o+1);return-1===s?a:a.substring(o+1,s-i)}class g extends p{getStackTrace(e,t){try{throw Error.create()}catch(n){return p.internalGetStackTrace(n,e,t)}}}let h=null;function m(){return h||(h=(new Error).stack?new p:new g),h}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let b=c.a.Warning,y=!0,_=null,v=null,S=null,O=null,C=null,E=null,I=null,w=null,j=null,P=null,T=null;const N=[];let A=0,R=0,D=null,x=null,M=null,F=null,k=null,L=null,B=null,U=null,V=null;function z(){return b}function q(e){return b=e,se(b),e}function H(){return y}function W(e){return y=e,se(e?b:0),e}let G=function(e,t,n,r,a,i,o,s,l){s=s,ie(e,c.a.Error,t,n,r,a,i,o,s,l)},K=function(e,t,n,r,a,i,o,s){o=o,ie(e,c.a.Error,null,t,n,r,a,i,o,s)},Q=function(e,t,n,r,a,i,o,s){ie(e,c.a.Warning,null,t,n,r,a,i,o,s)},X=function(e,t,n,r,a,i,o,s){ie(e,c.a.Info,null,t,n,r,a,i,o,s)},Y=function(e,t,n,r,a,i,o,s){ie(e,c.a.Perf,null,t,n,r,a,i,o,s)},J=function(e,t,n,r,a,i,o,s){ie(e,c.a.Verbose,null,t,n,r,a,i,o,s)};function $(e){N.indexOf(e)<0&&N.push(e)}function Z(e){const t=N.indexOf(e);t>=0&&N.splice(t,1)}function ee(){}let te=function(){},ne=function(){},re=function(){},ae=function(){};function ie(e,t,n,r,a,i,o,s,c,l){!function(e,t,n,r,a,i,o,s,c,l){D=null,R=e,A=t,x=n,M=r,F=a,k=i,L=o,B=s,U=c,V=l}(e,t,n,r,a,i,o,s,c,l),H()&&function(e,t){for(let n=0;n<N.length;n++){(0,N[n])(e,t)}}(t,oe)}function oe(){if(!D){let e="",t=-1,n=null,i=-1,o=null,l=null;if(A===c.a.Error){const a=5;n=m().getStackTrace(a,Object(r.a)(()=>t,e=>t=e));const i=p.get_clientInfo();for(const t in i){const n={key:t,value:i[t]};e+=""+String.format("{0} = {1}{2}",n.key,n.value,"\r\n")}}Object(a.a)(x)||(o=m().getExceptionStackTrace(x,Object(r.a)(()=>i,e=>i=e)),l=x.message),D=new s(A,R,n,t,l,o,i,e,M,F,k,L,B,U,V)}return D}function se(e){O||(O=K,C=G,_=Q,E=Y,v=X,S=J,I=ee,w=te,j=ne,P=re,T=ae),e<c.a.Error?(K=I,G=I):(K=O,G=C),Q=e<c.a.Warning?I:_,Y=e<c.a.Perf?I:E,X=e<c.a.Info?I:v,e<c.a.Verbose?(J=I,te=I,ne=I,re=I,ae=I):(J=S,te=w,ne=j,re=P,ae=T)}var ce;(ce=!0)!==l&&(ce?$(u):Z(u),l=ce)},XlXz:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"d",(function(){return a})),n.d(t,"h",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"g",(function(){return c})),n.d(t,"f",(function(){return l})),n.d(t,"b",(function(){return u}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="execute.addsessiontab",a="execute.closesessiontab",i="execute.updatesessiontab",o="execute.closeallsessiontabs",s="execute.dismissmessage",c="execute.markactivetab",l="execute.initializereferencepanelcontrol",u="execute.cleanreferencepanelstate"},XmFW:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="@search.entityname"},XvL5:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("2F73");class a{constructor(e){this._columns=null,this._columns=e}get_Columns(){return this._columns}get_isEmpty(){return!(this._columns.length>0)}getObjectData(){const e={};return e.columns=this._columns,e}getDifference(e){if(e instanceof r.a)return e;const t=e.get_Columns().filter(e=>this.get_Columns().indexOf(e)<0);return new a(t)}static createFromObjectData(e){return new a(e.columns)}}},XvLr:function(e,t,n){"use strict";n.r(t),n.d(t,"SYSTEM_VIEWS_LABEL_ID",(function(){return a})),n.d(t,"USER_VIEWS_LABEL_ID",(function(){return i})),n.d(t,"SEE_MORE_DETAILS",(function(){return C})),n.d(t,"GRID_LOADING_PLACEHOLDER",(function(){return E})),n.d(t,"JUMPBAR_ALL_TITLE",(function(){return o})),n.d(t,"JUMPBAR_ALL",(function(){return s})),n.d(t,"ACTIVITYTYPE_SELECTALL",(function(){return O})),n.d(t,"JUMPBAR_NUMBER_TOOLTIP",(function(){return c})),n.d(t,"JUMPBAR_NUMBER_INDICATOR",(function(){return l})),n.d(t,"JUMPBAR_ALPHABET",(function(){return u})),n.d(t,"JUMPBAR_LETTER_TITLE",(function(){return d})),n.d(t,"SELECTEDFILTER_TEXT",(function(){return k})),n.d(t,"FILTERBY_ARIALABEL",(function(){return L})),n.d(t,"NUMBER_ARIALABEL",(function(){return B})),n.d(t,"JUMPBAR_ARIALABEL",(function(){return F})),n.d(t,"CLOSE_JUMPBAR_ARIALABEL",(function(){return U})),n.d(t,"QUICK_FIND_VIEWS_LABEL_ID",(function(){return V})),n.d(t,"ROLLUPVIEW_SWITCH_ON",(function(){return b})),n.d(t,"ROLLUPVIEW_SWITCH_OFF",(function(){return y})),n.d(t,"ROLLUPVIEW_SWITCH_LABEL",(function(){return _})),n.d(t,"ACTIVITY_DUE_DATE_FILTER_LABEL",(function(){return f})),n.d(t,"ACTIVITY_MGMT_DUE_DATE_LABEL",(function(){return v})),n.d(t,"ACTIVITY_MGMT_ACTIVITY_TYPE_LABEL",(function(){return S})),n.d(t,"CREATE_VIEW_LABEL",(function(){return ge})),n.d(t,"CREATE_VIEW_TOOLTIP_TITLE",(function(){return he})),n.d(t,"CREATE_VIEW_TOOLTIP_DESCRIPTION",(function(){return me})),n.d(t,"QUEUE_FILTER_LABEL",(function(){return g})),n.d(t,"QUICK_FIND_TEXT_BOX_PLACEHOLDER_TEXT",(function(){return H})),n.d(t,"QUICK_FIND_TOOLTIP_CLEAR_BUTTON",(function(){return q})),n.d(t,"QUICK_FIND_TOOLTIP_APPLY_BUTTON",(function(){return z})),n.d(t,"QUICK_FIND_COMMANDBAR_TEXT",(function(){return W})),n.d(t,"QUICK_FIND_TEXT_BOX_PLACEHOLDER_TEXT_SEARCH_THIS_VIEW",(function(){return G})),n.d(t,"QUICK_FIND_TEXT_BOX_PLACEHOLDER_TEXT_QUICK_FIND_VIEW",(function(){return K})),n.d(t,"QUICK_FIND_CANCEL_LABEL_ID",(function(){return Q})),n.d(t,"VIEWSELECTOR_TOOLTIP",(function(){return X})),n.d(t,"VIEWSELECTOR_DEFAULTVIEW",(function(){return Y})),n.d(t,"VIEWSELECTOR_SETDEFAULTVIEW",(function(){return J})),n.d(t,"VIEWSELECTOR_NEWVIEW",(function(){return $})),n.d(t,"VIEWSELECTOR_VIEWS",(function(){return Z})),n.d(t,"MAINVIEWSELECTOR_DEFAULT_VIEW",(function(){return ee})),n.d(t,"MAINVIEWSELECTOR_MANAGE_AND_SHARE",(function(){return ie})),n.d(t,"MAINVIEWSELECTOR_NO_MATCHES_FOUND",(function(){return ue})),n.d(t,"MAINVIEWSELECTOR_OPEN_POPUP_TO_CHANGE_VIEW",(function(){return de})),n.d(t,"MAINVIEWSELECTOR_PERSONAL_VIEW",(function(){return oe})),n.d(t,"MAINVIEWSELECTOR_RESET_ORG_DEFAULT",(function(){return te})),n.d(t,"MAINVIEWSELECTOR_RESET_ORG_DEFAULT_SUCCESS",(function(){return ne})),n.d(t,"MAINVIEWSELECTOR_SEARCH_VIEWS",(function(){return ce})),n.d(t,"MAINVIEWSELECTOR_SET_USER_DEFAULT",(function(){return re})),n.d(t,"MAINVIEWSELECTOR_SET_USER_DEFAULT_SUCCESS",(function(){return ae})),n.d(t,"MAINVIEWSELECTOR_SYSTEM_VIEW",(function(){return se})),n.d(t,"MAINVIEWSELECTOR_TRY_REWORDING_YOUR_SEARCH",(function(){return le})),n.d(t,"X_RECORDS_PRESENT",(function(){return Oe})),n.d(t,"NO_DATA_AVAILABLE",(function(){return Ce})),n.d(t,"CHARTS_HIDE_CHART_PANE_LABEL",(function(){return Ee})),n.d(t,"CHARTS_SHOW_CHART_PANE_LABEL",(function(){return Ie})),n.d(t,"UCI_DISABLED_ENTITY_ERROR",(function(){return T})),n.d(t,"VIEW_NOTAVAILABLE_IN_OFFLINE",(function(){return N})),n.d(t,"ENTITY_NOT_AVAILABLE_IN_PROFILE",(function(){return D})),n.d(t,"OFFLINE_NOT_READY_FOR_USE",(function(){return R})),n.d(t,"SQL_QUERY_NOT_AVAILABLE",(function(){return A})),n.d(t,"LINKED_ENTITY_NOT_SUPPORTED",(function(){return x})),n.d(t,"ACTIVITY_ENTITY_NOT_SUPPORTED_OFFLINE",(function(){return M})),n.d(t,"GRID_CONTROL_LOAD_ERROR",(function(){return P})),n.d(t,"READ_PRIVILEGE_VIOLATION_KEY",(function(){return j})),n.d(t,"OPEN_ENTITY_DASHBOARDS",(function(){return we})),n.d(t,"MAINVIEWSELECTOR_SAVE_AS_NEW",(function(){return pe})),n.d(t,"MAINVIEWSELECTOR_SAVE_CHANGES_TO_CURRENT",(function(){return fe})),n.d(t,"SEE_MORE_TOOL_TIP",(function(){return p})),n.d(t,"SEE_MORE_LABEL",(function(){return m})),n.d(t,"SWITCH_VISUALIZATION_BUTTON_LABEL",(function(){return je})),n.d(t,"DEFAULT_LABEL",(function(){return Pe})),n.d(t,"labelList",(function(){return Be})),n.d(t,"CRM_SAVE_TO_CURRENT_VIEW_TITLE",(function(){return ve})),n.d(t,"CRM_FILTER_SAVED",(function(){return Se})),n.d(t,"CRM_SAVE_TO_CURRENT_VIEW",(function(){return _e})),n.d(t,"CRM_SAVE_AS_NEW_VIEW",(function(){return be})),n.d(t,"CRM_SAVE_AS_NEW_VIEW_TITLE",(function(){return ye})),n.d(t,"GRID_FILTER_LABEL",(function(){return h})),n.d(t,"AdvancedFind_DiscardButton_Title",(function(){return Te})),n.d(t,"AdvancedFilter_DiscardButton_AccessibilityLabel",(function(){return Ne})),n.d(t,"ADVANCEDFILTER_OPEN_LABEL",(function(){return De})),n.d(t,"ColumnEditorButton",(function(){return Ae})),n.d(t,"ColumnEditorButtonLabel",(function(){return Re})),n.d(t,"EditFiltersButton",(function(){return xe})),n.d(t,"ColumnEditorButton_Tooltip",(function(){return Me})),n.d(t,"EditFiltersButton_Tooltip",(function(){return Fe})),n.d(t,"SEE_ALL_TOOL_TIP",(function(){return I})),n.d(t,"SEE_ALL_LABEL",(function(){return w})),n.d(t,"COLUMNEDITOR_SAVE_AS_NEW_VIEW",(function(){return ke})),n.d(t,"COLUMNEDITOR_SAVE_CHANGES_TO_CURRENT_VIEW",(function(){return Le}));var r=n("kKLx");n.d(t,"errorsLabelList",(function(){return r.c}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const a="CRM_System_View_Group_Name",i="CRM_User_View_Group_Name",o="Grid_Title_JumpBar_All",s="Grid_Selection_JumpBar_All",c="Grid_JumpBar_Number_ToolTip",l="Grid_JumpBar_Number_Indicator",u="Grid_JumpBar_Alphabet",d="Grid_Title_JumpBar_Letter",p="Grid_See_More_Tool_Tip",f="Web.View_Label_ViewByDate",g="Workplace_Queue_Selector_Title",h="Grid_Filter_Label_Filter",m="Grid_See_More_Label_Text",b="RollupView_Switch_On",y="RollupView_Switch_Off",_="RollupView_Switch_Label",v="ActivityMgmt_Label_ViewByDate",S="ActivityMgmt_Label_ViewByActivityType",O="GridFilters_SelectAll",C="Error_See_More_Details_Grid",E="Grid_Loading_Placeholder",I="Grid_See_All_Tool_Tip",w="Grid_See_All_Label_Text",j="Error_Message_0x80040226",P="Grid_Generic_Unknown_Error",T="Error.NonUCIEntity",N="View_NotAvailable_In_Offline",A="Sql_Query_Not_Available",R="Offline_Not_Ready_For_Usage",D="Entity_Not_Available_In_Profile",x="Linked_Entity_Not_Supported_In_Offline",M="Activity_Entity_Not_Supported_In_Offline",F="Jump Bar",k="Selected filter",L="Filter table by {0}",B="Number 0 to 9",U="Close Jump Bar",V="AdvancedFindSearchResultsViewName",z="Button_ToolTip_Go",q="Button_ToolTip_Clear",H="Field_Label_Find",W="Search_Label_Search",G="Field_Label_Search_This_View",K="Field_Label_Search_Quick_Find_View",Q="Button_Label_Cancel",X="View_Title_Tooltip",Y="OnDefaultViewToolTip",J="SetDefaultViewToolTip",$="NewView",Z="ViewSelector_Views",ee="MainPageViewSelector_DefaultView",te="MainPageViewSelector_ResetOrgDefault",ne="MainPageViewSelector_ResetOrgDefault_Success",re="MainPageViewSelector_SetUserDefault",ae="MainPageViewSelector_SetUserDefault_Success",ie="MainPageViewSelector_ManageAndShareViews",oe="MainPageViewSelector_PersonalView",se="MainPageViewSelector_SystemView",ce="MainPageViewSelector_SearchViews",le="MainPageViewSelector_TryRewordingYourSearch",ue="MainPageViewSelector_NoMatchesFound",de="MainPageViewSelector_OpenPopupToChangeView",pe="Grid_AdvancedFilter_ColumnEditor_SaveAsNewView",fe="Grid_AdvancedFilter_ColumnEditor_SaveChangesToCurrentView",ge="CRM_Create_View",he="CRM_Create_View_Tooltip_Title",me="CRM_Create_View_Tooltip_Description",be="CRM_Save_As_New_View",ye="CRM_Save_As_New_View",_e="CRM_Save_To_Current_View",ve="CRM_Save_To_Current_View",Se="GridFilters_SaveMessage",Oe="{0} records found",Ce="L_List_No_Records_Text",Ee="ttv_homepage_button_hideChart",Ie="ttv_homepage_button_showChart",we="Display_Entity_dashboard",je="MobileClient.Commands.ChangeControl",Pe="FormEditor_Default_Tab",Te="Grid_AdvancedFilter_DiscardButton_Title",Ne="Grid_AdvancedFilter_DiscardButton_AccessibilityLabel",Ae="Grid_AdvancedFilter_ColumnEditor_ColumnEditor",Re="Grid_AdvancedFilter_ColumnEditor_EditColumns",De="Grid_AdvancedFilter_OpenAdvancedFilterTitleAndAria",xe="Grid_AdvancedFilter_EditFiltersButton",Me="Grid_AdvancedFilter_ColumnEditorButton_Tooltip",Fe="Grid_AdvancedFilter_EditFiltersButton_Tooltip",ke="Grid_AdvancedFilter_ColumnEditor_SaveAsNewView",Le="Grid_AdvancedFilter_ColumnEditor_SaveChangesToCurrentView",Be=[a,i,o,c,C,E,T,N,A,D,x,M,l,s,O,u,d,V,b,y,_,f,v,S,ge,he,me,g,H,G,K,q,z,W,Q,X,Y,J,$,Z,ee,ie,ue,oe,te,ne,ce,re,ae,se,le,Ce,Ee,Ie,j,we,P,pe,fe,p,m,je,Pe,be,_e,Se,h,Te,Ne,De,Ae,Re,xe,Me,Fe,w,I,ke,Le,...r.c]},Y2Yg:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.ReadAccess=1]="ReadAccess",e[e.WriteAccess=2]="WriteAccess",e[e.AppendAccess=4]="AppendAccess",e[e.AppendToAccess=16]="AppendToAccess",e[e.CreateAccess=32]="CreateAccess",e[e.DeleteAccess=65536]="DeleteAccess",e[e.ShareAccess=262144]="ShareAccess",e[e.AssignAccess=524288]="AssignAccess"}(r||(r={}))},Y7HL:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r,a=n("QEBF"),i=n("ghc6"),o=n("8aze"),s=(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),c=function(e){function t(t){var n=e.call(this,t)||this;return n._onLoad=n._onLoad.bind(n),n}return s(t,e),t.prototype._onLoad=function(){this.props.onLoad&&this.props.onLoad()},t.prototype.getElementName=function(){return"img"},t.prototype.getElementProps=function(){return{src:this.props.source,onLoad:this._onLoad,alt:this.props.altText?this.props.altText:"",title:this.props.title?this.props.title:this.props.altText?this.props.altText:void 0,onError:this.props.onError}},t.displayName="Image",t}(a.a),l=i.a(o.b)(c)},YIt1:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.And=0]="And",e[e.Or=1]="Or",e[e.Not=2]="Not"}(r||(r={}))},YPXd:function(e,t,n){"use strict";n.d(t,"a",(function(){return h})),n.d(t,"e",(function(){return l})),n.d(t,"f",(function(){return d})),n.d(t,"c",(function(){return p})),n.d(t,"d",(function(){return g})),n.d(t,"b",(function(){return f}));var r=n("a6P5"),a=n("D6Jg"),i=n("+5Bq"),o=n("xagu");let s,c=!1;function l(){window.addOnAppLoad=u}function u(e){if(e){if(c)throw new Error("addOnAppLoad should only be called before UCI Boot");if(s)throw new Error("addOnAppLoad should only be called once");if("object"==typeof e)s=e;else{if("string"!=typeof e)throw new Error("Received unexpected input");s={loadHandler:{webResourceName:arguments[0],initFunctionName:arguments[1]}}}}}function d(){c=!0}function p(e){const t=e.TraceManager.getTracer("EmbeddedApi");if(!s)try{s=JSON.parse(window.HOST_CONTEXT.getHostOptions()),t.info(`HostOption accquired from window object, value: '${window.HOST_CONTEXT.getHostOptions()}'`)}catch(e){t.warn(`HostOption not available from window object: '${e.message}'`)}return s}function f(e){const t=e.searchParams,n=t.get("hostConfig");if(!n){const{isEmbedded:n,channelId:r}=h(e);if(t.get(o.D)){const e=t.get(o.y);return void(window.HOST_CONTEXT={getHostOptions:()=>{const t={externalCorrelationId:e,hostName:"Maker Portal"};return JSON.stringify(t)}})}return n&&r?{playerName:"ms-pa-teams-v0"}:void 0}const{correlationId:a,hostName:i}=Object(r.a)(n);return{externalCorrelationId:a,playerName:i}}function g(e){s=p(e);const t=e.TraceManager.getTracer("EmbeddedApi");if(!s)try{const e=window.localStorage.getItem("UCISessionID");s=e?{externalCorrelationId:e}:void 0,t.info(`HostOption accquired from localStorage, value: '${JSON.stringify(s)}'`)}catch(e){t.error(`Local storage is not accessible: '${e.message}'`)}return s}function h(e){const t=e.searchParams.get("flags");if(t){const n=Object(a.e)(t);return{isRestore:Object(i.a)(n.restore),isEmbedded:Object(i.a)(n.embedded),channelId:e.searchParams.get("channelId")}}return{isRestore:void 0,isEmbedded:void 0,channelId:void 0}}},YVjE:function(e,t,n){"use strict";n.d(t,"a",(function(){return j})),n.d(t,"d",(function(){return N})),n.d(t,"c",(function(){return P})),n.d(t,"b",(function(){return T}));var r=n("kAKO"),a=n("yHIv"),i=n("3bZx"),o=n("fMBw"),s=n.n(o),c=n("5UJb"),l=n.n(c),u=n("SZCI"),d=n("4N6w"),p=n("zsAz"),f=n("V6aM"),g=n("UwOy"),h=n("23jc"),m=n("g22U"),b=n("Uv1Y"),y=n("dH1a");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function _(e){return!!Object(d.a)(e)&&!Object(g.e)(e)}const v=/^\/_static\//i,S=s.a.createEvent("LoadScript",u.c),O=s.a.createEvent("LoadStylesheet",u.c),C=s.a.createEvent("LoadRawData",u.c),E=s.a.createEvent("LoadOfflineWebResource",u.c),I=s.a.createEvent("LoadJavaScript",u.c),w=s.a.createEvent("LoadRawStyle",u.c);class j{constructor(e=document,t,n){this._scriptChain=Promise.resolve(),this._jsLoadingPromises={},this._cssLoadingPromises={},this._rawDataPromises={},this._retriedDocuments=[],this._offlineWebResourcePromises={},this._loadedDocuments={},this._targetDocument=e,this._rawDataCache=new i.a,this._offlineErrorsList=new Set,this._scanForLoadedJsFiles(),this._store=n,this._tracer=t&&t.TraceManager.getTracer(j.ASSETLOADER_TRACER_CATEGORY)}loadScriptSync_DO_NOT_USE(e){if(this.isResourceLoaded(e))return;this._jsLoadingPromises[e]&&this._tracer.warn("Sync load of already loading file",[{name:"filename",value:e}]);const t=new XMLHttpRequest;if(t.open("GET",e,!1),t.send(null),200!==t.status){const n="Failed to load script sync";throw this._tracer.error(n,[{name:"status",value:t.status},{name:"file",value:e}]),new Error(n)}{const n=this._targetDocument.createElement("script");n.type="text/javascript",n.innerHTML=t.responseText+"\n//# sourceURL="+e,this._targetDocument.body.appendChild(n),this._jsLoadingPromises[e]=Promise.resolve(),this._loadedDocuments[e]=!0}}loadScript(e,t={}){const n=Object.assign({async:!0,crossOrigin:"anonymous",forceCrossOrigin:!1},t);if(N(e)){const t=[{name:"filePath",value:e}];return this._tracer&&this._tracer.warn("AssetLoader does not support loading static files.",t),Promise.resolve()}if(this._offlineErrorsList.has(e)&&this._jsLoadingPromises[e]&&(this._offlineErrorsList.delete(e),delete this._jsLoadingPromises[e]),!this._jsLoadingPromises[e]){const r=l.a.trackWork("loadScript"),a=S.startStopwatch({filename:e,options:JSON.stringify(t)});if(0===e.indexOf("/uclient/scripts/")||!_(this._store.getState())&&!Object(g.g)(this._store.getState())||!/^\/[^\/]/.test(e)&&0!==e.indexOf(window.location.origin)){let t;const r=async a=>{try{if(2===a){const t=await this.loadRawData(e);this.loadRawJavaScript(function(e){return atob(e)}(t),e)}else await function(e,t,n){return new Promise((r,a)=>{const i=e.createElement("script");i.addEventListener("load",()=>r()),i.addEventListener("error",t=>{a(t),e.body.removeChild(i)}),i.type="text/javascript",i.src=t,i.async=n.async,!n.forceCrossOrigin&&i.src.startsWith(e.location.origin+"/")||(i.crossOrigin=n.crossOrigin),e.body.appendChild(i)})}(this._targetDocument,e,n)}catch(n){if(0===a)t=JSON.stringify(n,["type","message","filename","lineno","colno","error"]),this._tracer.warn("LoadScript call failed on attempt 1",[{name:"filename",value:e}]),await r(1);else{if(1!==a){const r=Object(p.d)("The script "+e+" didn't load correctly.");throw Object(p.b)(r,[{name:"ErrorEvent",value:JSON.stringify({Attempt1:t,Attempt2:null==n?void 0:n.message})}]),r}this._tracer.warn("LoadScript call failed on attempt 2",[{name:"filename",value:e}]),await r(2)}}};this._jsLoadingPromises[e]=r(0)}else this._jsLoadingPromises[e]=n.async?this._loadUrlInternal(e):Promise.all([this._scriptChain,this._loadUrlInternal(e)]),this._jsLoadingPromises[e]=this._jsLoadingPromises[e].then(t=>{const r=n.async?t:t[1],a=this._targetDocument.createElement("script");a.type="text/javascript",a.innerHTML=r+"\n//# sourceURL="+e,this._targetDocument.body.appendChild(a)}),n.async||(this._scriptChain=this._jsLoadingPromises[e].catch(e=>{}));const i=t=>{a(),r(),this._loadedDocuments[e]=t};this._jsLoadingPromises[e].then(()=>i(!0),t=>{this._isOfflineError(t)&&this._offlineErrorsList.add(e),i(!1)})}return this._jsLoadingPromises[e]}_isOfflineError(e){if("Failed to fetch"===(null==e?void 0:e.message))return!0;const t=Object(b.c)(e);return Object(y.a)(t.getNegativeErrorCode())}loadStylesheet(e,t=""){if(this._offlineErrorsList.has(e)&&this._cssLoadingPromises[e]&&(this._offlineErrorsList.delete(e),delete this._cssLoadingPromises[e]),!this._cssLoadingPromises[e]){const n=l.a.trackWork("loadStylesheet"),r=O.startStopwatch({filename:e});if(!_(this._store.getState())&&!Object(g.g)(this._store.getState())||!/^\/[^\/]/.test(e)&&0!==e.indexOf(window.location.origin))this._cssLoadingPromises[e]=new Promise((n,r)=>{const a=this._targetDocument.createElement("link");a.onload=()=>{n()},a.onerror&&(a.onerror=function(e){const t=Object(p.d)("The stylesheet "+this.href+" didn't load correctly.");Object(p.b)(t,[{name:"ErrorEvent",value:JSON.stringify(e)}]),r(t)}),a.href=e+t,a.rel="stylesheet",a.type="text/css",this._targetDocument.body.appendChild(a)});else{let t;this._cssLoadingPromises[e]=new Promise(n=>{t=this._targetDocument.createElement("style"),this._targetDocument.body.appendChild(t),n(this._loadUrlInternal(e))}).then(e=>{t.innerHTML=e}),this._cssLoadingPromises[e].catch(()=>{this._targetDocument.body.removeChild(t)})}const a=()=>{r(),n(),this._loadedDocuments[e]=!0},i=t=>{r(),n(),this._loadedDocuments[e]=!1,this._isOfflineError(t)&&this._offlineErrorsList.add(e)};this._cssLoadingPromises[e].then(a,i)}return this._cssLoadingPromises[e]}loadScripts(e,t){return Promise.all(e.map(e=>this.loadScript(e,t)))}loadRawData(e){if(!this._rawDataPromises[e]){const t=l.a.trackWork("loadRawData"),n=C.startStopwatch({filepath:e}),r=this._rawDataCache;this._rawDataPromises[e]=new Promise((t,n)=>{const a=r.getItem(e);if(a)t(a);else{const a=new XMLHttpRequest;a.open("GET",e),a.responseType="arraybuffer",a.onload=function(){if(a.status>=200&&a.status<300){r.setItem(e,a.response);const n=function(e){const t=new Uint8Array(e);let n=t.length;const r=new Array(n);for(;n--;)r[n]=String.fromCharCode(t[n]);const a=r.join("");return window.btoa(a)}(a.response);t(n)}else n(new Error(`Failed to load ${e} (${a.statusText})`))},a.onerror=function(t){n(Object(p.d)("Failed to load script",void 0,[{name:"filepath",value:e}]))},a.send()}}),this._rawDataPromises[e].then(()=>{n(),t()},()=>{n(),t()})}return this._rawDataPromises[e]}loadOfflineWebResource(e){if(!this._offlineWebResourcePromises[e]){const t=l.a.trackWork("loadOfflineWebResource"),n=E.startStopwatch({webResourceName:e});this._offlineWebResourcePromises[e]=this._store.dispatch(Object(f.a)(e)),this._offlineWebResourcePromises[e].then(()=>{n(),t()},()=>{n(),t()})}return this._offlineWebResourcePromises[e]}loadRawJavaScript(e,t=""){const n=l.a.trackWork("loadRawJavaScript"),r=I.startStopwatch({name:t}),a=this._targetDocument.createElement("script");a.innerHTML=e,this._targetDocument.body.appendChild(a),r(),n()}loadRawStylesheet(e,t=""){const n=l.a.trackWork("loadRawStylesheet"),r=w.startStopwatch({name:t}),a=this._targetDocument.createElement("style");a.type="text/css",a.innerHTML=e,this._targetDocument.body.appendChild(a),r(),n()}loadWebResource(e,t,n,r,a,i=!0){if(a){if(3===n&&this._jsLoadingPromises[t+e])return this._jsLoadingPromises[t+e];if(2===n&&this._cssLoadingPromises[t+e])return this._cssLoadingPromises[t+e];const a=r(e).then(r=>{if(null==r)throw new Error(`Content of webresource was empty (${e})`);switch(n){case 2:this.loadRawStylesheet(r,e),this._loadedDocuments[t+e]=!0;break;case 3:default:this.loadRawJavaScript(r,e),this._loadedDocuments[t+e]=!0}});return 3===n?this._jsLoadingPromises[t+e]=a:2===n&&(this._cssLoadingPromises[t+e]=a),a}switch(n){case 2:return this.loadStylesheet(t+e);case 3:default:const n=N(e)?e:t+e;return this.loadScript(n,{async:i})}}isResourceLoaded(e){return this._loadedDocuments.hasOwnProperty(e)&&this._loadedDocuments[e]}async _loadUrlInternal(e){const t=await this.loadWithToken(e);return await t.text()}_scanForLoadedJsFiles(){const e=this._targetDocument.getElementsByTagName("script"),t=Promise.resolve();for(let n=0;n<e.length;n++){const r=e[n];if(r.src){const e=r.src,n=e.substr(e.indexOf("/uclient/scripts/")+"/uclient/scripts/".length).split("?")[0];this._jsLoadingPromises[n]||(this._jsLoadingPromises[n]=t)}}}resetFilePromiseForRetry(e,t,n){const r=e+t,a=2===n?this._cssLoadingPromises:this._jsLoadingPromises;a.hasOwnProperty(r)&&!this._retriedDocuments.includes(r)&&(this._retriedDocuments.push(r),delete a[r])}async loadWithToken(e){const t={endpoint:e,method:"GET",urlParameters:"",additionalParameters:{[m.a.TYPE]:m.d.FUNCTION,[m.a.SUB_TYPE]:m.c.AssetLoader,[m.a.SOURCE]:m.b.Default}};return await this._store.dispatch(Object(h.a)(t))}}function P(){return"?v="+window.VERSION_NUMERIC_VALUE}function T(e){return{diagnosticName:"AssetLoader",boot:(t,n,r)=>{const a=new j(e,n,r);n.AssetLoader=a},supportedClientHostTypes:a.a,supportedPageTypes:a.b,priority:r.a.Normal}}function N(e){return null!=e.match(v)}j.ASSETLOADER_TRACER_CATEGORY="assetloader"},YYhu:function(e,t,n){"use strict";n.d(t,"c",(function(){return P})),n.d(t,"d",(function(){return I})),n.d(t,"a",(function(){return E})),n.d(t,"b",(function(){return N}));var r=n("WPtp"),a=n("odYE"),i=n("SAYH"),o=n("bT7G"),s=n("lY/Z"),c=n("P+kM"),l=n("Pcet"),u=n("FZDd"),d=n("Uv1Y"),p=n("Dea/"),f=n("bi9n"),g=n("hirD"),h=n("GD3x"),m=n("V482"),b=n("Xe7f"),y=n("PF3G"),_=n("HYaY"),v=n("jjPz"),S=n("LbMF"),O=n("/A0C"),C=n("wF0i");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const E="dataSnapshot.removeLockedChanges";function I(e,t,n,r,a,i,s,l){return Object(v.a)(arguments,{type:"dataSnapshot.saveMultiple.async",execute({dispatch:u,getState:p},f){const b=[],y=new Map,_=f.TraceManager.getTracer("Forms.SaveForm"),v=[];for(const n of e){const e=w(p(),n,_,f.EventManager,t,a);if(!e)throw new d.a("Invalid snapshot with id "+n);b.push(...e);const r=y.size;for(let t=r;t<r+e.length;t++)y.set(t,n);u(Object(c.b)(n,!0))}v.push({name:"saveMultipleDataSnapshotsExecuteMultipleInnerRequests",value:e.map(e=>Object(o.d)(p(),e)).join(", ")});const S=new g.a(b,new h.a(!1,!0));return f.DataSource.execute(S,null,void 0,{OperationSource:"Forms.SaveForm"},f,v,i).nativePromise().then(async t=>{var a;let c;l&&await u(null==l?void 0:l.reportToMonitor(e,s));c=null!=(null===(a=t)||void 0===a?void 0:a.get_responses)?t.get_responses():[new m.a(null,0,t)],Object(C.e)();const d=p(),f=[];for(const e of c){const t=e.get_requestIndex(),a=S.get_requests()[t].get_name();if("Update"===a||"Create"===a){const a=y.get(t),s=Object(o.b)(d,a),c=e.get_response(),l=n&&n[s.identifier.etn];f.push(u(j(s,c,i,l,r)))}}return Promise.all(f)},d.b).catch(async t=>{l&&await u(null==l?void 0:l.reportToMonitor(e,s));const n=t.faultedRequestIndex;if(n>-1&&y.size>n){const e=y.get(n);t.FaultedSnapshotId=e}throw e.forEach(e=>u(Object(c.b)(e,!1))),t})}})}function w(e,t,n,r,a,i){const s=Object(o.b)(e,t);if(s&&s.identifier){const t=N(e,s,n);if(s.mode===p.a.Create)return[new b.a(t,a,null,i)];return[new y.a(t,a)]}return null}function j(e,t,n,r,o){return{type:"dataSnapshot.refreshRecordAndUpdateSnapshot.async",execute({dispatch:c,getState:u},d){const g=e.mode===p.a.Create,h=t.get_entityReference();g&&c(Object(f.b)(e.snapshotId,p.a.Update));let m=e.identifier;return i.a.isNullOrEmpty(e.identifier.id)&&(m=a.a.fromLegacyEntityReference(h),c(Object(l.b)(e.snapshotId,m))),r?(g&&null!=o&&i.a.equals(i.a.fromLegacyGuid(o.get_target().Id),i.a.EMPTY)&&o.set_target(h),c(Object(s.d)(m,r,o,void 0,n)).then(()=>(c(T(e.snapshotId)),m))):(c(T(e.snapshotId)),Promise.resolve(m))}}}function P(e,t,n,i,s,l,f,m){return Object(v.a)(arguments,{type:"dataSnapshot.save.async",execute:({getState:b,dispatch:y},_)=>{const v=b(),E=Object(o.b)(v,e),I=[];if(E&&E.identifier){const o=a.a.toLegacyEntityReference(E.identifier),P=n?n.slice(0):[],T={[o.LogicalName]:P};for(const t in E.activeChanges){const n=Object(S.a)(v,o.LogicalName,t);if(((null==n?void 0:n.Type)===O.a.File||(null==n?void 0:n.Type)===O.a.Image)&&(E.mode===p.a.Update&&!(null==n?void 0:n.IsValidForUpdate)||E.mode===p.a.Create&&!(null==n?void 0:n.IsValidForCreate)))return Promise.reject(new d.a(`Invalid snapshot. Update is not allowed for field ${t} in snapshot with id ${e}`));P.push(t);const a=E.activeChanges[t];if(Object(r.h)(a)){const e=a;if(e.list)for(const t of e.list){const e=t.identifier.etn;T[e]?T[e]=Array.from(new Set(T[e].concat(Object.keys(t.fields)))):T[e]=Object.keys(t.fields)}}}return y(Object(u.e)(T,l)).then(()=>{const r=_.TraceManager.getTracer("Forms.SaveForm"),a=w(b(),e,r,_.EventManager,t,s);y(Object(c.b)(e,!0));let o=null;a.length>1?(I.push({name:"saveDataSnapshotExecuteMultipleInnerRequests",value:a.map(e=>e.get_name()).join(",")}),o=new g.a(a,new h.a(!1,!0))):o=a[0];return _.DataSource.execute(o,null,void 0,{OperationSource:"Forms.SaveForm"},_,I,l).nativePromise().then(async t=>{m&&await y(null==m?void 0:m.reportToMonitor([e],f));let r=null;if(a.length>1){r=t.get_responses().filter(e=>{const t=a[e.get_requestIndex()].get_name();return"Update"===t||"Create"===t})[0].get_response()}else r=t;return Object(C.e)(),y(j(E,r,l,n,i))}).catch(async t=>(m&&await y(null==m?void 0:m.reportToMonitor([e],f)),y(Object(c.b)(e,!1)),Object(d.b)(t)))})}return Promise.reject(new d.a("Invalid snapshot with id "+e))}})}function T(e){return{type:E,payload:null,meta:e}}function N(e,t,n){return _.a.recordDataToLegacyEntityRecord(e,t.identifier,t.activeChanges,t.snapshotId,n)}},YaQb:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){for(var r=0,a=e.length;r<a;++r)n=t(n,e[r],r,a,e);return n}},Yb4o:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("nA3O");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class a extends r.a{constructor(){super(...arguments),this._eventHandlers={}}apcl(e,t){this._eventHandlers[e]||(this._eventHandlers[e]=[]),this._eventHandlers[e].push(t)}rpcl(e,t){var n;const r=null===(n=this._eventHandlers[e])||void 0===n?void 0:n.indexOf(t);r>=0&&this._eventHandlers[e].splice(r,1)}addCustomEventHandler(e,t){this.apcl("~"+e,t)}removeCustomEventHandler(e,t){this.rpcl("~"+e,t)}firePropertyChanged(e){var t;null===(t=this._eventHandlers[e])||void 0===t||t.slice().forEach(t=>{t(this,e)})}handleCustomEvent(e,t){var n;null===(n=this._eventHandlers["~"+e])||void 0===n||n.slice().forEach(e=>{e(t)})}onPropertyChanged(e){super.onPropertyChanged(e),this.firePropertyChanged(e)}}},Ydwo:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class r{constructor(e,t){this._use=e,this._assign=t}get val(){return this._use()}set val(e){this._assign(e)}}const a=(e,t)=>new r(e,t)},YhOF:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("504W"),a=n("bEud");class i{constructor(e,t){this._schemaName=null,this._primaryEntityRole=0,this._schemaName=e,this._primaryEntityRole=Object(r.a)(t)?a.a.unknown:t}get_schemaName(){return this._schemaName}get_primaryEntityRole(){return this._primaryEntityRole}getObjectData(){const e={};return e.schemaname=this._schemaName,e.role=this._primaryEntityRole,e}toString(){return a.a[this._primaryEntityRole]+","+this._schemaName}equals(e){return!Object(r.a)(e)&&e.toString()===this.toString()}}},YiEf:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("RHUE"),a=function(){function e(){}return e.setEventsHandler=function(e){r.default.setEventsHandler(e)},e.getEventsHandler=function(){return r.default.getEventsHandler()},e.scheduleTimer=function(){r.default.scheduleTimer()},e}();t.default=a},YkaX:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"d",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return o}));const r="appusersetting",a="settingdefinition";var i;!function(e){e.NotificationsLastViewedOn="NotificationsLastViewedOn",e.NotificationsLastAlertedOn="NotificationsLastAlertedOn",e.NotificationsLastDismissedAllOn="NotificationsLastDismissedAllOn",e.NotificationToastFadeInterval="NotificationToastFadeInterval",e.AllowNotificationSoundAlerts="AllowNotificationSoundAlerts",e.AllowNotificationToasts="AllowNotificationToasts"}(i||(i={}));const o={NotificationsLastViewedOn:{name:i.NotificationsLastAlertedOn,id:null,value:"2021-01-07T01:23:07.022Z",dataType:1},NotificationsLastAlertedOn:{name:i.NotificationsLastAlertedOn,id:null,value:"2021-01-07T01:40:52.042Z",dataType:1},NotificationsLastDismissedAllOn:{name:i.NotificationsLastDismissedAllOn,id:null,value:"2021-01-05T23:29:07.479Z",dataType:1},NotificationToastFadeInterval:{name:i.NotificationToastFadeInterval,id:null,value:6,dataType:0},AllowNotificationSoundAlerts:{name:i.AllowNotificationSoundAlerts,id:null,value:"false",dataType:2},AllowNotificationToasts:{name:i.AllowNotificationToasts,id:null,value:"true",dataType:2}}},"YxC/":function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"f",(function(){return u})),n.d(t,"h",(function(){return p})),n.d(t,"g",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return c})),n.d(t,"e",(function(){return l})),n.d(t,"c",(function(){return f})),n.d(t,"i",(function(){return g}));var r=n("eq9I");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e){return e&&e.metadata&&e.metadata.resourceStrings?e.metadata.resourceStrings:null}function i(e){const t=a(e);return t?t.missingStringIds:[]}function o(e,t){var n;const a=s(e,t);return null!==(n=null!=a?a:r.f[t])&&void 0!==n?n:a}function s(e,t){const n=a(e);return n&&n.strings?n.strings[t]:null}function c(e){const t=a(e);return t&&t.strings?t.strings:{}}function l(e,t){return d(e,t,o)}function u(e,t){return d(e,t,s)}function d(e,t,n){const r={};for(let a=0;a<t.length;a++){const i=t[a];r[i]=n(e,i)}return r}function p(){let e=null;return function(t,n){const r=l(t,n);if(e){if(r)if(Object.keys(r).length!==Object.keys(e).length)e=r;else for(const t in r)if(e[t]!==r[t]){e=r;break}}else e=r;return e}}function f(e,t){return e&&e[t]?e[t]:""}function g(e,t){return t.every(t=>e&&e[t])}},Yz6o:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return h})),n.d(t,"b",(function(){return m})),function(e){e[e.APP_NAV_SETTING_SETUP=0]="APP_NAV_SETTING_SETUP",e[e.BASIC_SETUP=1]="BASIC_SETUP",e[e.APP_NAV_SETTING_SETUP_SUMMARY=2]="APP_NAV_SETTING_SETUP_SUMMARY",e[e.BASIC_SETUP_SUMMARY=3]="BASIC_SETUP_SUMMARY"}(r||(r={}));var a=n("Uv1Y"),i=n("8unZ"),o=n("E5IU"),s=n("Nb1E"),c=n("eXjw"),l=n("fMBw"),u=n.n(l),d=n("odYE"),p=n("SAYH"),f=n("504W"),g=n("Zvo8");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const h="appsettings.retrieve";function m(e){return{type:"appsettings.retrieve.async",execute({dispatch:t,getState:n},l){const m=Object(i.b)(n()),_=l.TraceManager.getTracer("InAppShell");if(_.info("Action retrieveAppSettings started, appSettingsInitState: "+m),!m||m===c.a.Uninitialized){t(function(){const e={Groups:[],GroupsCollapsedState:[]},t={initialized:c.a.Initializing,appNavSettings:e};return{type:h,payload:t}}());const i=Object(o.k)(n());if(i){const o=u.a.createEvent("retrieveAppShellSettings","InAppShell.Actions.Async").startStopwatch();let m="appconfig",v=`?$filter=_appmoduleid_value eq ${i}&$select=appconfigid`;const S=function(e,t,n,r){return e(Object(s.e)(t,n,void 0,void 0,void 0,r))}(t,m,v,e);return _.info("Retrieving appconfig for appId: "+i),S.then(n=>{if(_.debug("OData AppConfig Retrieve Response: "+JSON.stringify(n)),n&&n.value){const a=new p.a(n.value[0].appconfigid);_.info("AppConfigId retrieved successfully, AppConfigId:"+JSON.stringify(a)+", now retrieving navigation settings for this appConfigId"),m="appconfig",v="?$expand=appconfig_navigationsetting($orderby=advancedsettingorder asc)";const i=Object(s.d)(new d.a(m,a),v,{"Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache",Expires:"0","If-None-Match":""},void 0,void 0,void 0,e);return t(i).then(e=>{_.debug("Navigation Settings Retrieve Response: "+JSON.stringify(e)),_.info("Navigation Settings Retrieved Successfully"),o(),t(function(e,t,n){const a=[],i=[],o=[],s=[],l=[];let u=null,d=null;const p=new Map,m=t.appconfig_navigationsetting;for(let e=0;e<m.length;e++){const t=m[e],n=Object(g.b)("navigationSettingVisitedCookie_"+t.navigationsettingid);if(t.settingtype===r.APP_NAV_SETTING_SETUP_SUMMARY)u=t;else if(t.settingtype===r.BASIC_SETUP_SUMMARY)t.progressstate=t.progressstate||null!==n,d=t;else if(null==t.parentnavigationsettingid||void 0===t.parentnavigationsettingid){const e={name:t.name,navigationsettingid:t.navigationsettingid,description:t.description,SubAreas:[]};p.set(e.navigationsettingid,e),a.push(e)}else s.push(t),t.settingtype===r.BASIC_SETUP&&(t.progressstate=t.progressstate||null!==n,o.push(t))}for(const e of s){const t=p.get(e.parentnavigationsettingid);t&&t.SubAreas.push(e)}for(let e=0;e<a.length;e++)a[e].SubAreas.length>0&&(l.push(a[e]),i.push(!1));const y=o.sort(b);Object(f.a)(d)||y.push(d);for(let e=0;e<y.length;e++)y[e].quicksettingorder=e;const _={setupSummaryNode:u,Groups:l,GroupsCollapsedState:i},v={initialized:c.a.Initialized,appConfigId:e,appNavSettings:_};return n.debug("Navigation Settings Metadata State:"+v),{type:h,payload:v}}(n.value[0].appconfigid,e,_))})}o()}).catch(e=>{const t=JSON.stringify(e);throw _.error("Retrieve Navigation Settings - OData Failure, Error Message: "+t),y(n,l,e,"Retrieve Navigation Settings - OData Failure"),new a.a("Retrieve Navigation Settings - OData Failure, Error Message: "+t)})}return _.error("Retrieve Navigation Settings - AppContext not available in the metadata store"),y(n,l,new Error("AppContext not available in the metadata store"),"Retrieve Navigation Settings"),Promise.reject(new a.a("Retrieve Navigation Settings - AppContext not available in the metadata store"))}}}}function b(e,t){return Object(f.a)(t.quicksettingorder)?0:Object(f.a)(e.quicksettingorder)?1:e.quicksettingorder-t.quicksettingorder}function y(e,t,n,r){const a=Object(o.d)(e()),i=a?a.uniqueName:"",s=[];s.push({name:"AppUniqueName",value:i}),s.push({name:"ErrorSource",value:r}),t.EventManager.ReportComponentFailure("InAppShell",n,"",s)}},"Z/4N":function(e,t,n){"use strict";n.d(t,"e",(function(){return o})),n.d(t,"d",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return d})),n.d(t,"f",(function(){return u})),n.d(t,"c",(function(){return l}));var r=n("y60j"),a=n("jq7Z"),i=n("9fGf");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function o(e,t){return e&&e.metadata&&e.metadata.controlManifests&&t&&e.metadata.controlManifests.hasOwnProperty(t)?e.metadata.controlManifests[t]:null}function s(e,t,n){if(!(e&&e.metadata&&e.metadata.homePageConfigurations&&t&&n))return null;const r=e.metadata.homePageConfigurations[t];return r?r[n]:null}function c(e,t,n){const a=Object(r.h)(e,n);return a&&a.ControlConfigurations&&a.ControlConfigurations.hasOwnProperty(t)&&a.ControlConfigurations[t]?a.ControlConfigurations[t]:null}function l(e,t,n){var r,a;const o=Object(i.b)(e),s=c(e,t,n);if(null===(a=null===(r=null==s?void 0:s.CustomControls)||void 0===r?void 0:r[o])||void 0===a?void 0:a.CustomControlId)return s.CustomControls[o].Name}function u(e,t,n,r){const i=Object(a.a)(e,t);return i&&i.gridConfigurations&&i.gridConfigurations[r.guid]&&i.gridConfigurations[r.guid][n]?i.gridConfigurations[r.guid][n]:null}function d(e,t,n){if(e&&e.UniqueId&&t.Id&&null!=t.ControlConfigurations){if(5===t.FormType)switch(n){case i.a.Phone:n=3;break;case i.a.Tablet:n=2;break;case i.a.Web:n=1}const r=t.ControlConfigurations[e.UniqueId];if(r&&r.CustomControls&&r.CustomControls[n])return r.CustomControls[n]}return null}},"Z1+9":function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r,a=n("QEBF"),i=n("W8Pl"),o=n("pGYJ"),s=(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),c=o.a+".Primitive.FontIcon",l=function(e){function t(t){var n=e.call(this,t)||this;if(t&&void 0===t.type){var r=Error("FontIcon type property cannot be null");i.b.Reporting.reportFailure(c,r)}return n}return s(t,e),t.prototype.getElementName=function(){return"span"},t.prototype.getElementClassName=function(){var e=this.props.styles?" "+this.props.styles.rule:"";return this.getSymbolClassName(this.props.type)+e},t.displayName="FontIcon",t}(a.a)},Z4sG:function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var r=n("2yvP"),a=n("W8Pl"),i=n("16wZ"),o=n("ABCl"),s=n("69Qu"),c=n("aRLb"),l=n("37s6");class u{constructor(e){this._store=e,this._clientApiExecutor=new o.b(this._store,"ClientApi.XrmIntelligenceApi.")}getPredictionSchemaAsync(){const e=this._clientApiExecutor.getComponentName("getPredictionSchemaAsync");return Object(i.j)(e,"Not Supported"),null}predictAsync(e,t){const n=this._clientApiExecutor.getComponentName("predictAsync");let r,a;if(Xrm.Utility.getGlobalContext().client.isOffline()&&Object(i.j)(n,"No supported in Offline"),"string"==typeof t)try{const e=JSON.parse(t);e&&(r=e.request,a=e.version)}catch(e){}return this._clientApiExecutor.executeAsync("predictAsync",(t,n)=>{const o={boundParameter:"entity",operationName:"Predict",operationType:0,parameterTypes:{entity:{typeName:"Microsoft.Dynamics.CRM.msdyn_aimodel",structuralProperty:5},version:{typeName:"Edm.String",structuralProperty:1},request:{typeName:"Edm.String",structuralProperty:1}}},s={getMetadata:()=>o,entity:{id:e,entityType:"msdyn_aimodel"},version:a,request:r};let c;const l=new Promise(e=>{c=e});return Xrm.WebApi.online.execute(s).then(e=>e.json().then(e=>c({success:!0,body:{response:e.response}}))).catch(e=>{let r;r=2147746327===e.errorCode?2:3;const a={success:!1,error:r,body:{response:JSON.stringify({error:e})}};return Object(i.d)(this._store,e,t,n).then(()=>c(a)).catch(()=>c(a))}),l},[{name:"modelId",value:e,isRequired:!0,isEventParam:!0},{name:"version",value:a,isRequired:!0,isEventParam:!0},{name:"request",value:r,isRequired:!0}])}invokeGlobalOperationAsync(e,t){return this._clientApiExecutor.executeAsync("invokeGlobalOperationAsync",async(n,r)=>{this._verifyWebApiOnlineIsReady(n);const a=this._buildODataContract(e,t);try{const e=await this._executeOnlineRequest(a);return{success:!0,body:await e.json()}}catch(e){try{const t=await Object(i.d)(this._store,e,n,r);throw new Error(`Should never happen ${t}. Using never variable so the compiler is happy :)`)}catch(e){}return{success:!1,error:3,body:{response:JSON.stringify({error:e})}}}})}invokeAiModelActionAsync(e,t){return this._clientApiExecutor.executeAsync("invokeAiModelActionAsync",async(n,r)=>{var a,o;this._verifyWebApiOnlineIsReady(n);const s=Object.assign(Object.assign({},null===(a=t.payload)||void 0===a?void 0:a.parameterTypes),{entity:{typeName:"Microsoft.Dynamics.CRM.msdyn_aimodel",structuralProperty:5}}),c={boundParameter:"entity",operationName:t.operationName,operationType:0,parameterTypes:s},l=Object.assign(Object.assign({},null===(o=t.payload)||void 0===o?void 0:o.request),{getMetadata:()=>c,entity:{id:e,entityType:"msdyn_aimodel"}});try{const e=await this._executeOnlineRequest(l);return{success:!0,body:await e.json()}}catch(e){try{const t=await Object(i.d)(this._store,e,n,r);throw new Error(`Should never happen ${t}. Using never variable so the compiler is happy :)`)}catch(e){}let t;return t=e&&2147746327===e.errorCode?2:3,{success:!1,error:t,body:{response:JSON.stringify({error:e})}}}})}getPreTrainedModelIdAsync(e){const t=this._clientApiExecutor.getComponentName("getPreTrainedModelIdAsync");return Xrm.Utility.getGlobalContext().client.isOffline()&&Object(i.j)(t,"No supported in Offline"),this._clientApiExecutor.executeAsync("getPreTrainedModelIdAsync",(t,n)=>{let r,a;const o=new Promise((e,t)=>{r=e,a=t});return Xrm.WebApi.retrieveMultipleRecords("msdyn_aimodel",`?$filter=msdyn_TemplateId/msdyn_uniquename eq '${e}'&$select=msdyn_aimodelid&$top=1`).then(t=>{t&&t.entities&&t.entities.length>0?r({success:!0,body:t.entities[0].msdyn_aimodelid}):r({success:!1,error:2,body:e+" not found"})}).catch(e=>{Object(i.d)(this._store,e,t,n).catch(e=>{a(e)})}),o},[{name:"templateUniqueName",value:e,isRequired:!0,isEventParam:!0}])}getLabelsForObjectDetectionModelAsync(){const e=this._clientApiExecutor.getComponentName("getLabelsForObjectDetectionModelAsync");return Object(i.j)(e,"Not Supported"),null}_verifyWebApiOnlineIsReady(e){(Object(l.E)(this._store.getState())?Object(s.b)(this._store.getState()):Object(s.c)(this._store.getState()))||Object(i.e)(e,"API can be accessed only when online.")}_executeOnlineRequest(e){return this._store.dispatch(Object(c.b)(e))}_buildODataContract(e,t){function n(){}const r={boundParameter:void 0,operationName:t.operationName,operationType:e,parameterTypes:t.payload?t.payload.parameterTypes:{}};n.prototype.getMetadata=function(){return r};const a=Object.create(n.prototype);return t.payload&&Object.assign(a,Object.assign({},t.payload.request)),a}}var d=n("N0PS"),p=n("9n4z"),f=n("IqkD");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function g(e,t,n,i){const o=a.a;if(!o.Initialized){i||(i=new d.a(e,n,t));const a=i.Utility.getGlobalContext(),s=a.userSettings;let c,l,g,h,m;i.Internal&&(c=i.Internal.isFeatureEnabled.bind(i.Internal),l=i.Internal.isDisruptiveFeatureEnabled.bind(i.Internal),g=i.Internal.getEntityName.bind(i.Internal),h=i.Internal.canOpenUrl.bind(i.Internal),m=i.Internal.getFormId.bind(i.Internal));const b=n=>n?new p.b(e,t,a,n):i.Navigation,y=a.client,_=a.organizationSettings,v={getTimeZoneOffsetMinutes:()=>Object(r.b)("pcfControl.xrmProxy",()=>s.getTimeZoneOffsetMinutes()),get userId(){return Object(r.b)("pcfControl.xrmProxy",()=>s.userId)},get userName(){return Object(r.b)("pcfControl.xrmProxy",()=>s.userName)},get languageId(){return Object(r.b)("pcfControl.xrmProxy",()=>s.languageId)},get locale(){return Object(r.b)("pcfControl.xrmProxy",()=>Object(f.o)(e.getState()))},get securityRoles(){return Object(r.b)("pcfControl.xrmProxy",()=>s.securityRoles)},get isHighContrastEnabled(){return Object(r.b)("pcfControl.xrmProxy",()=>s.isHighContrastEnabled)},get isRTL(){return Object(r.b)("pcfControl.xrmProxy",()=>s.isRTL)},get pagingLimit(){return Object(r.b)("pcfControl.xrmProxy",()=>s.pagingLimit)},get formatInfoCultureName(){return Object(r.b)("pcfControl.xrmProxy",()=>s.formatInfoCultureName)},get formatInfoCultureId(){return Object(r.b)("pcfControl.xrmProxy",()=>Object(f.x)(e.getState()).userCultureLCID)}};o.setUserSettings(v),o.setOrgSettings({get languageId(){return Object(r.b)("pcfControl.xrmProxy",()=>_.languageId)},get uniqueName(){return Object(r.b)("pcfControl.xrmProxy",()=>_.uniqueName)},get isAutoSaveEnabled(){return Object(r.b)("pcfControl.xrmProxy",()=>_.isAutoSaveEnabled)},get attributes(){return Object(r.b)("pcfControl.xrmProxy",()=>_.attributes)}});const S={beginSecureSessionForResource:(e,t,n,a)=>Object(r.b)("pcfControl.xrmProxy",()=>i.Utility.beginSecureSessionForResource(e,t,n,a)),getEntityMetadata:(e,t)=>Object(r.b)("pcfControl.xrmProxy",()=>i.Utility.getEntityMetadata(e,t)),getEntitiesMetadata:e=>Object(r.b)("pcfControl.xrmProxy",()=>i.Utility.getEntitiesMetadata(e)),getResourceString:(e,t)=>Object(r.b)("pcfControl.xrmProxy",()=>i.Utility.getResourceString(e,t)),isFeatureEnabled:e=>Object(r.b)("pcfControl.xrmProxy",()=>c(e)),isDisruptiveFeatureEnabled:(e,t,n)=>Object(r.b)("pcfControl.xrmProxy",()=>l(e,t,n)),lookupObjects:e=>Object(r.b)("pcfControl.xrmProxy",()=>i.Utility.lookupObjects(e)),getEntityName:e=>Object(r.b)("pcfControl.xrmProxy",()=>g(e)),getFormId:(e,t)=>Object(r.b)("pcfControl.xrmProxy",()=>m(e,t)),canOpenUrl:e=>Object(r.b)("pcfControl.xrmProxy",()=>h(e))};o.setUtils(S),o.setOffline({isOfflineEnabled:e=>Object(r.b)("pcfControl.xrmProxy",()=>i.Mobile.offline.isOfflineEnabled(e))}),o.setPage({getClientUrl:()=>Object(r.b)("pcfControl.xrmProxy",()=>a.getClientUrl())}),o.setClient({getFormFactor:()=>Object(r.b)("pcfControl.xrmProxy",()=>y.getFormFactor()),getClient:()=>Object(r.b)("pcfControl.xrmProxy",()=>y.getClient()),getClientState:()=>Object(r.b)("pcfControl.xrmProxy",()=>y.getClientState())}),o.setReporting({reportSuccess:(e,t)=>{Object(r.b)("pcfControl.xrmProxy",()=>{i.Reporting.reportSuccess(e,t)})},reportFailure:(e,t,n,a)=>{Object(r.b)("pcfControl.xrmProxy",()=>{i.Reporting.reportFailure(e,t,n,a)})},reportEvent:e=>{Object(r.b)("pcfControl.xrmProxy",()=>{i.Reporting.reportEvent(e)})}}),o.setDiagnostics({traceError:(e,t,n)=>{Object(r.b)("pcfControl.xrmProxy",()=>{i.Diagnostics.traceError(e,t,n)})},traceWarning:(e,t,n)=>{Object(r.b)("pcfControl.xrmProxy",()=>{i.Diagnostics.traceWarning(e,t,n)})},traceInfo:(e,t,n)=>{Object(r.b)("pcfControl.xrmProxy",()=>{i.Diagnostics.traceInfo(e,t,n)})},traceDebug:(e,t,n)=>{Object(r.b)("pcfControl.xrmProxy",()=>{i.Diagnostics.traceDebug(e,t,n)})},isInMonitorSession:()=>Object(r.b)("pcfControl.xrmProxy",()=>i.Diagnostics.isInMonitorSession())}),o.setNavigationContext({openAlertDialog:(e,t,n)=>Object(r.b)("pcfControl.xrmProxy",()=>b(n).openAlertDialog(e,t)),openConfirmDialog:(e,t,n)=>Object(r.b)("pcfControl.xrmProxy",()=>b(n).openConfirmDialog(e,t)),openDialog:(e,t,n,a)=>Object(r.b)("pcfControl.xrmProxy",()=>b(a).openDialog(e,t,n)),openErrorDialog:(e,t)=>Object(r.b)("pcfControl.xrmProxy",()=>b(t).openErrorDialog(e)),openFile:(e,t,n)=>Object(r.b)("pcfControl.xrmProxy",()=>b(n).openFile(e,t)),openForm:(e,t,n)=>Object(r.b)("pcfControl.xrmProxy",()=>b(n).openForm(e,t)),openTaskFlow:(e,t,n,a)=>Object(r.b)("pcfControl.xrmProxy",()=>b(a).openTaskFlow(e,t,n)),openUrl:(e,t,n)=>{Object(r.b)("pcfControl.xrmProxy",()=>b(n).openUrl(e,t))},openWebResource:(e,t,n)=>Object(r.b)("pcfControl.xrmProxy",()=>b(n).openWebResource(e,t)),navigateTo:(e,t,n)=>Object(r.b)("pcfControl.xrmProxy",()=>b(n).navigateTo(e,t))}),o.setDeviceContext({captureImage:e=>Object(r.b)("pcfControl.xrmProxy",()=>i.Device.captureImage(e)),captureAudio:e=>Object(r.b)("pcfControl.xrmProxy",()=>i.Device.captureAudio(e)),captureVideo:e=>Object(r.b)("pcfControl.xrmProxy",()=>i.Device.captureVideo(e)),pickFile:e=>Object(r.b)("pcfControl.xrmProxy",()=>i.Device.pickFile(e)),getBarcodeValue:()=>Object(r.b)("pcfControl.xrmProxy",()=>i.Device.getBarcodeValue()),isGetBarcodeValueAvailable:()=>Object(r.b)("pcfControl.xrmProxy",()=>!1),getCurrentPosition:()=>Object(r.b)("pcfControl.xrmProxy",()=>i.Device.getCurrentPosition()),openARViewer:e=>Object(r.b)("pcfControl.xrmProxy",()=>i.Device.openARViewer(e)),isOpenARViewerAvailable:()=>Object(r.b)("pcfControl.xrmProxy",()=>!1)}),o.setExternalContext({getExternalContextProperty:(e,t,n)=>Object(r.b)("pcfControl.xrmProxy",()=>i.ExternalContext.getExternalContextProperty(e,t,n)),invokeExternalContextAction:(e,t,n)=>Object(r.b)("pcfControl.xrmProxy",()=>i.ExternalContext.invokeExternalContextAction(e,t,n)),getAvailableExternalContexts:()=>Object(r.b)("pcfControl.xrmProxy",()=>i.ExternalContext.getAvailableExternalContexts()),removeExternalContextPropertyListener:(e,t,n)=>Object(r.b)("pcfControl.xrmProxy",()=>i.ExternalContext.removeExternalContextPropertyListener(e,t,n))}),o.setApplicationUI({addGlobalNotification:(e,t,n,a,o,s)=>Object(r.b)("pcfControl.xrmProxy",()=>i.UI.addGlobalNotification(e,t,n,a,o,s)),clearGlobalNotification:e=>Object(r.b)("pcfControl.xrmProxy",()=>i.App.clearGlobalNotification(e)),clearGlobalNotifications:()=>Object(r.b)("pcfControl.xrmProxy",()=>i.UI.clearGlobalNotifications())}),o.setWebApi({get offline(){return Object(r.b)("pcfControl.xrmProxy",()=>({retrieveRecord:(e,t,n)=>Object(r.b)("pcfControl.xrmProxy",()=>i.WebApi.offline.retrieveRecord(e,t,n)),createRecord:(e,t)=>Object(r.b)("pcfControl.xrmProxy",()=>i.WebApi.offline.createRecord(e,t)),updateRecord:(e,t,n)=>Object(r.b)("pcfControl.xrmProxy",()=>i.WebApi.offline.updateRecord(e,t,n)),deleteRecord:(e,t)=>Object(r.b)("pcfControl.xrmProxy",()=>i.WebApi.offline.deleteRecord(e,t)),retrieveMultipleRecords:(e,t,n)=>Object(r.b)("pcfControl.xrmProxy",()=>i.WebApi.offline.retrieveMultipleRecords(e,t,n)),execute:e=>Object(r.b)("pcfControl.xrmProxy",()=>i.WebApi.offline.execute(e))}))},get online(){return Object(r.b)("pcfControl.xrmProxy",()=>({retrieveRecord:(e,t,n)=>Object(r.b)("pcfControl.xrmProxy",()=>i.WebApi.online.retrieveRecord(e,t,n)),createRecord:(e,t)=>Object(r.b)("pcfControl.xrmProxy",()=>i.WebApi.online.createRecord(e,t)),updateRecord:(e,t,n)=>Object(r.b)("pcfControl.xrmProxy",()=>i.WebApi.online.updateRecord(e,t,n)),deleteRecord:(e,t)=>Object(r.b)("pcfControl.xrmProxy",()=>i.WebApi.online.deleteRecord(e,t)),retrieveMultipleRecords:(e,t,n)=>Object(r.b)("pcfControl.xrmProxy",()=>i.WebApi.online.retrieveMultipleRecords(e,t,n)),execute:e=>Object(r.b)("pcfControl.xrmProxy",()=>i.WebApi.online.execute(e)),executeMultiple:e=>Object(r.b)("pcfControl.xrmProxy",()=>i.WebApi.online.executeMultiple(e))}))}}),o.setWebApiUnified({retrieveRecord:(e,t,n)=>Object(r.b)("pcfControl.xrmProxy",()=>i.WebApi.retrieveRecord(e,t,n)),createRecord:(e,t)=>Object(r.b)("pcfControl.xrmProxy",()=>i.WebApi.createRecord(e,t)),updateRecord:(e,t,n)=>Object(r.b)("pcfControl.xrmProxy",()=>i.WebApi.updateRecord(e,t,n)),deleteRecord:(e,t)=>Object(r.b)("pcfControl.xrmProxy",()=>i.WebApi.deleteRecord(e,t)),retrieveMultipleRecords:(e,t,n,a)=>Object(r.b)("pcfControl.xrmProxy",()=>i.WebApi.retrieveMultipleRecords(e,t,n,a)),execute:e=>Object(r.b)("pcfControl.xrmProxy",()=>i.WebApi.execute(e)),executeMultiple:e=>Object(r.b)("pcfControl.xrmProxy",()=>i.WebApi.executeMultiple(e))});const O=new u(e);return o.setIntelligenceApi({getPredictionSchemaAsync:(e,t)=>Object(r.b)("pcfControl.xrmProxy",()=>O.getPredictionSchemaAsync()),predictAsync:(e,t)=>Object(r.b)("pcfControl.xrmProxy",()=>O.predictAsync(e,t)),getPreTrainedModelIdAsync:e=>Object(r.b)("pcfControl.xrmProxy",()=>O.getPreTrainedModelIdAsync(e)),getLabelsForObjectDetectionModelAsync:e=>Object(r.b)("pcfControl.xrmProxy",()=>O.getLabelsForObjectDetectionModelAsync()),invokeAiModelActionAsync:(e,t)=>Object(r.b)("pcfControl.xrmProxy",()=>O.invokeAiModelActionAsync(e,t)),invokeGlobalOperationAsync:(e,t)=>Object(r.b)("pcfControl.xrmProxy",()=>O.invokeGlobalOperationAsync(e,t))}),o.Initialized=!0,i}}},"Z6+u":function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"j",(function(){return i})),n.d(t,"k",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return c})),n.d(t,"e",(function(){return l})),n.d(t,"g",(function(){return u})),n.d(t,"f",(function(){return d})),n.d(t,"h",(function(){return p})),n.d(t,"i",(function(){return f}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="core.applicationshell.powertours.retrieved.sync",a="core.applicationshell.powertours.fullyrendercontext.sync",i="tours.updateinitializationstatuswebresourceaction.sync",o="tours.updateinitializerstatuswebresourceaction.sync",s="tours.loadwebresourceaction.sync",c="tours.executewebresourceaction.sync",l="tours.containerdimensionschanged.sync",u="tours.navigatetostep.sync",d="tours.flushnavigatetostep.sync",p="tours.progresschanged.sync",f="tours.progressended.sync"},Z6YS:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var r=n("ufH1"),a=n("504W"),i=n("zW2f"),o=n("H4dV"),s=n("eruq"),c=n("/Ndy");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class l{constructor(){this.endPointUrl=null,this.requestType=null,this.contentType=null,this.dataType=null,this.soapAction=null,this.oDataVersion=null,this.oDataMaxVersion=null,this.prefer=null,this.additionalHeaders=null}static create(e,t,n,r,a){const i=new l;return i.endPointUrl=e,i.requestType=t,i.contentType=n,i.dataType=r,i.soapAction=a,i.additionalHeaders={},i}}l.jsonDataType="text",l.soapDataResponseAsText="text",l.soapDataResponseAsXml="xml",l.jsonContentType="application/json; charset=utf-8",l.soapContentType="text/xml; charset=utf-8";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class u{constructor(){this.responseText=null,this.headers=null,this.responseSize=0,this.data=null,this.status=0,this.statusText=null,this.responseTelemetryId=null}}var d=n("EW4s"),p=n("fMBw"),f=n.n(p),g=n("Div0"),h=n("Wc7r");class m{constructor(e,t,n){this._serverUrl=null,this._remoteCallRetryHandler=null,this.applicationStatusProvider=null,this._webServiceSettings=null,this._ODataVersionRegex=new RegExp("^odata-version:","im"),this._remoteCallRetryHandler=t,this.applicationStatusProvider=n,this._serverUrl=m.getNormalizedServerUrl(e)}get_serverUrl(){return this._serverUrl}get_Settings(){return this._webServiceSettings}set_Settings(e){return this._webServiceSettings=e,e}createSoapRequestBody(e){return'<s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/"><s:Header>'+this.getSoapHeaders()+"</s:Header><s:Body>"+e+"</s:Body></s:Envelope>"}getSoapHeaders(){return null}executeJsonRequest(e){const t=new d.a;return this._ExecuteRequest(e).then(e=>{const n=e,i=n.data;let o={};if(o.headers=n.headers,o.status=n.status,o.statusText=n.statusText,Object(a.a)(i))t.resolve(o);else{const e=i;if(e.indexOf("--batchresponse"))if(this._ODataVersionRegex.test(n.headers))o.body=JSON.parse(e),t.resolve(o);else try{o=JSON.parse(e),t.resolve(o)}catch(n){e.indexOf(c.a.HtmlHeader)>-1?(Object(r.b)(this.get_name()+m.executeJsonRequestName,g.a.storage,e),t.reject(this.createErrorResponseFromHtml(e))):(Object(r.b)(this.get_name()+m.executeJsonRequestName,g.a.storage,m.responseTypeUnknown),t.reject(this.createErrorResponse(new XMLHttpRequest,"",this.get_name()+m.responseTypeUnknown)))}else o.body=i,t.resolve(o)}},e=>{Object(r.b)(this.get_name()+m.executeJsonRequestName,g.a.storage,e.get_message()),t.reject(e)}),t}executeSoapRequest(e){const t=new d.a;return this._ExecuteRequest(e).then(n=>{const r=n.data;if(e.requestOptions.dataType===l.soapDataResponseAsText){let n=r;return(n.length>1e7||this.hasNilNodes(e.name))&&(n=m.removeNilNodes(n)),void(this.handleSpecialCaseSoapResults(e,n,t)||(o.a.getInstance().get_IsIOS()&&n.length>1e7?t.reject(this.createErrorResponse(new XMLHttpRequest,"XML Too Large","Error: XML response for "+e.name+" is too large! Max length allowed is 10000000, length of input XML is "+n.length)):this._ParseAndResolve(n,t)))}t.resolve(Object(s.a)(r))},e=>{t.reject(e)}),t}_ParseAndResolve(e,t){const n=Object(s.b)(e);Object(a.a)(n)?t.reject(this.createErrorResponse(new XMLHttpRequest,"parsererror","Unable to parse XML response: "+e)):t.resolve(Object(s.a)(n))}_ExecuteRequest(e){$.support.cors=!0;const t={async:!0,cache:!0};t.type=e.requestOptions.requestType,t.data=e.requestText,t.contentType=e.requestOptions.contentType,t.dataType=e.requestOptions.dataType,t.url=e.requestOptions.endPointUrl,t.beforeSend=t=>{if(Object(a.a)(e.requestOptions.soapAction)||t.setRequestHeader("SOAPAction",e.requestOptions.soapAction),Object(a.a)(e.requestOptions.oDataVersion)||(t.setRequestHeader("OData-MaxVersion",e.requestOptions.oDataMaxVersion),t.setRequestHeader("OData-Version",e.requestOptions.oDataVersion)),Object(a.a)(e.requestOptions.prefer)||t.setRequestHeader("Prefer",e.requestOptions.prefer),t.setRequestHeader("ClientHost",function(){const e=o.a.getInstance();if(e.get_isMailApp())return"MailApp";if(e.get_PALEnabled())return"MobileApplication";if(e.get_IsBrowser())return"Browser";return""}()),!Object(a.a)(this.applicationStatusProvider)){const e=this.applicationStatusProvider.getCurrentAppId();Object(a.a)(e)||t.setRequestHeader("x-ms-app-id",e);const n=this.applicationStatusProvider.getCurrentAppUniqueNameOrDefault();Object(a.a)(n)||t.setRequestHeader("x-ms-app-name",n),this.applicationStatusProvider.addAuthorizationHeader(t)}if(!Object(a.a)(e.requestOptions.additionalHeaders)){const n=e.requestOptions.additionalHeaders,r=Object.keys(n);for(let e=0;e<r.length;e++){const a={key:r[e],value:n[r[e]]};t.setRequestHeader(a.key,a.value.toString())}}t.setRequestHeader("Client-Name","UCI")};const n={};"POST"===e.requestOptions.requestType&&(n["cache-control"]="no-cache"),this.addHeaders(n,e),t.headers=n;const i=new d.a,s=new d.a,c=window.performance.now();s.always(t=>{this._SetRequestPerformance(e,t,c)}).then(e=>{i.resolve(e)},e=>{Object(r.b)(this.get_name()+m.executeRequestName,g.a.storage,e.get_message()),i.reject(e)});let l=null;this.get_Settings()&&(l=this.get_Settings().getWebServiceCallRetryPolicy(e.requestOptions.endPointUrl));const u=l?l.TotalRetryCount:0,p=l?l.RetryWaitIntervalMilliseconds:0;return this._ExecuteRequestWithRetry(t,s,u,p,0,0,5),i}_SetRequestPerformance(e,t,n){const r=window.performance.now(),o=f.a.createEvent(this.get_performanceStopwatch(),"WebService"),s={};let c=e.name;const l=new Array(0);if(!Object(a.a)(e.childRequests)){for(const t of e.childRequests)l.push(t);l.length>0&&(c+=","+l.join(","))}s.requestName=c;const d=Object(a.a)(e.context)?i.a.get_instance():e.context;if(s.context=d.toString(),s.requestSize=e.requestSize.toString(),t instanceof u){const e=t;s.responseSize=e.responseSize.toString(),Object(a.b)(e.responseTelemetryId)||(s.requestId=e.responseTelemetryId)}else s.responseSize="0";o.createRetroactiveStopwatch(n,r-n,s)}_ExecuteRequestWithRetry(e,t,n,i,s,c,l){const u=$.ajax(e);u.done(d=>{const p=this.createResponseData(u,d);Object(a.a)(d)?(Object(r.e)(this.get_name()+"_ExecuteRequest",g.a.storage,"Warning: Response data null or undefined"),t.resolve(p)):!p.responseSize&&o.a.getInstance().get_IsAndroidJellyBean()?n>0?(n--,window.setTimeout(()=>{this._ExecuteRequestWithRetry(e,t,n,i,s,c,l)},i)):(Object(r.b)(this.get_name()+m.executeRequestWithRetryName,g.a.storage,String.format("Response: {0}",p.responseText)),t.reject(this.createErrorResponse(new XMLHttpRequest,"",this.get_name()+"Error: Response text empty"))):t.resolve(p)}).fail((o,u,d)=>{if(401!==o.status||Object(a.a)(this._remoteCallRetryHandler))if(400===o.status&&s<5)this._LogRetryRequest(e.url,o.status,d.toString(),5-s),++s,this._ExecuteRequestWithRetry(e,t,n,i,s,c,l);else if(503===o.status&&n>0)this._LogRetryRequest(e.url,o.status,d.toString(),n),--n,window.setTimeout(()=>{this._ExecuteRequestWithRetry(e,t,n,i,s,c,l)},i);else if(!o.status&&c<1)this._LogRetryRequest(e.url,o.status,d.toString(),1-c),++c,this._ExecuteRequestWithRetry(e,t,n,i,s,c,l);else if(500===o.status&&this.canRetryServerError(this.createErrorResponse(o,u,d.toString()))&&l>0)this._LogRetryRequest(e.url,o.status,d.toString(),l-1),--l,window.setTimeout(()=>{this._ExecuteRequestWithRetry(e,t,n,i,s,c,l)},1e3);else{const e=this.createErrorResponse(o,u,d.toString());Object(r.b)(this.get_name()+m.executeRequestWithRetryName,g.a.storage,String.format("Response: {0}",e.get_message())),t.reject(e)}else this._remoteCallRetryHandler.handleAuthError(o).then(r=>{this._ExecuteRequestWithRetry(e,t,n,i,s,c,l)},e=>{Object(r.b)(this.get_name()+m.executeRequestWithRetryName,g.a.storage,m.authorizedError+" "+e.get_Message()),t.reject(this.createErrorResponse(o,u,this.get_name()+m.authorizedError+" "+e.get_Message()))})})}_LogRetryRequest(e,t,n,a){Object(r.e)(this.get_name()+m.executeRequestWithRetryName,g.a.storage,"Request Failed: "+e+" Status: "+t+" Message: '"+n+"' Retries Remaining: "+a)}hasNilNodes(e){return!1}handleSpecialCaseSoapResults(e,t,n){return!1}addHeaders(e,t){}canRetryServerError(e){return!1}createResponseData(e,t){const n=new u;n.responseText=Object(a.a)(e.responseText)?"":e.responseText,n.responseSize=n.responseText.length,n.headers=e.getAllResponseHeaders(),n.data=t,n.status=e.status,n.statusText=e.statusText;const r=e.getResponseHeader(h.HEADER.SERVER_REQUEST_ID);return Object(a.b)(r)||(n.responseTelemetryId=r),n}createJsonRequestOptions(e){return l.create(e,"POST",l.jsonContentType,l.jsonDataType,e)}createSoapRequestOptions(e,t){let n;return n=o.a.getInstance().get_IsIOS()?l.soapDataResponseAsText:l.soapDataResponseAsXml,l.create(e,"POST",l.soapContentType,n,t)}static removeNilNodes(e){return e.replace(new RegExp('\\<[\\w+:]+ i:nil="true"( xmlns:\\w+="[\\w:\\/.]+")?\\ ?/>',"g"),"")}static getNormalizedServerUrl(e){return"/"===e.substring(e.length-1,e.length)?e.substring(0,e.length-1):e}static addRequestId(e,t){Object(a.a)(e)||Object(a.a)(t)||Object(a.a)(e.additionalHeaders)||h.HEADER.CLIENT_REQUEST_ID in e.additionalHeaders||(e.additionalHeaders[h.HEADER.CLIENT_REQUEST_ID]=t,Object(r.d)(m.webServiceBaseName+m.addRequestIdName,g.a.storage,t))}}m.microsoft2003SerializationArraysNamespace="http://schemas.microsoft.com/2003/10/Serialization/Arrays",m.genericCollectionsNamespace="http://schemas.datacontract.org/2004/07/System.Collections.Generic",m.executeJsonRequestName="_ExecuteJsonRequest_Failure",m.executeRequestName="_ExecuteRequest_Failure",m.executeRequestWithRetryName="_ExecuteRequestWithRetry_Failure",m.responseTypeUnknown="Error: Response data type unknown",m.authorizedError="Error: Not Authorized.",m.addRequestIdName="_AddRequestId",m.webServiceBaseName="WebServiceBase"},Z9sG:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("IpQH"),a=n("uM6Y"),i=n("VkXQ"),o=n("FkJY"),s=n("Lyxw"),c=n("3/02"),l=n("bktA");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class u extends r.a{constructor(e,t){super(e,t,a.a)}ready(){return new Promise((e,t)=>{this.execute(i.a.ready.name,new o.a),e()})}initialized(){return new Promise((e,t)=>{this.execute(i.a.initialized.name),e()})}bootError(e,t){return this.execute(i.a.bootError.name,e,t)}reloadWebView(e){return new Promise((t,n)=>{if(Object(s.f)(this.applicationStore.getState(),c.i))this.execute(i.a.reloadWebView.name,e),t();else{const e=l.a+".reloadWebView",t={name:"UnsupportedWebViewReload",message:"reloadWebView called in an unsupported environment"};this.applicationContext.EventManager.ReportComponentFailure(e,t),n(t)}})}}},ZFRl:function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"c",(function(){return h})),n.d(t,"b",(function(){return m}));var r=n("pF61"),a=n("arV0"),i=n("NjDY"),o=n("YxC/"),s=n("m4EA"),c=n("E5IU"),l=n("Knfm"),u=n("GEbX"),d=n("Lyxw"),p=n("3/02");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const f="router.set.pagetitle";let g="";function h(e,t){return{type:"router.set.pagetitleSync",sync:!0,execute({getState:n,dispatch:h}){var m;const y=n();g||(g=Object(o.b)(y,(null===(m=Object(i.D)(y))||void 0===m?void 0:m.isCrmOrg)?s.a:s.b));const _=b(t),v=Object(d.f)(y,p.o),S=Object(l.a)(y);if(v&&S===u.a.MultiSession)document.title=Object(c.l)(y);else{const t=Object(r.c)(y),n=Object(a.h)(y,e);e!==t||n||(document.title=_)}return h(function(e,t){return{type:f,payload:{__pageTitle:t},meta:{pageId:e}}}(e,_)),Promise.resolve()}}}function m(e){document.title=b(e)}function b(e){return e?-1!==e.indexOf(g)?e:String.format("{0} - {1}",e,g):g}},ZFkP:function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return b}));var r=n("0buK"),a=n("SAYH"),i=n("ruPX"),o=n("oqdd"),s=n("onzm"),c=n("g440"),l=n("a72m"),u=n("d0w6"),d=n("Lohl"),p=n("odYE"),f=n("htFu"),g=n("BJ7u"),h=n("zsAz");function m(e,t,n,a,o){const s={entityTypeName:e,uniqueName:t,id:n,data:a};return Object(i.a)(r.a,s,o)}function b(e,t,n,r){const{uniqueName:i,id:m,entityTypeName:b}=e,y=t.TraceManager.getTracer(Object(s.c)()),_=Object(s.b)()+".prePageRenderTaskBasedFlow";y.info(`Executing prePageRenderTaskBasedFlow action. uniqueName: ${i} id: ${a.a.toString(m)} entityTypeName: ${b}`);const v={resultType:o.a.Fail,resultValue:null};if(!i)return t.EventManager.ReportComponentFailure(_,Error(`TBX not opened because uniqueName was falsy uniqueName: ${i} id: ${a.a.toString(m)} entityTypeName: ${b}`)),y.error(`uniqueName: ${i} id: ${m} entityTypeName: ${b}`),Promise.resolve(v);const S=n(Object(c.b)(i));let O=null;const C=S.then(e=>{let r=null;return e?e.primaryModelName!==b&&(r=`Error starting Task Flow. Entity type mismatch between record id '${a.a.toString(m)}' (${e.primaryModelName}) and Task Flow '${i}' (${b})`):r=`Error starting Task Flow. No published Task Flow '${i}' (${b}) could be found.`,null!=r?(t.EventManager.ReportComponentFailure(_,Error(r)),v.resultValue=Object(h.d)(r,2415919107),v):(O=new p.a(e.primaryModelName,m),y.info(`Retrieving default lookup view for entity  ${e.primaryModelName} and form descriptor for formId ${e.formId} uniqueName: ${i} id: ${a.a.toString(m)} entityTypeName: ${b}`),n(Object(l.a)(e.primaryModelName,u.a.LOOKUP_VIEW,u.b.savedview)).catch(n=>(t.EventManager.ReportComponentFailure(_,Error(`No default view for lookup for entity: ${e.primaryModelName} uniqueName: ${i} id: ${a.a.toString(m)} entityTypeName: ${b}`)),v)),n(Object(d.d)(O,e.formId,Object(g.a)(12))).then(e=>a.a.isNullOrEmpty(e)?(t.EventManager.ReportComponentFailure(_,Error(`TBX not opened because retrievedFormId was: ${a.a.toString(e)} uniqueName: ${i} id: ${a.a.toString(m)} entityTypeName: ${b}`)),v):{resultType:o.a.Success}).catch(n=>{n=n&&n.reason?n.reason:n;const r=`TBX not opened because of error during form retrieval. descriptor.formId was: ${a.a.toString(e.formId)}. Old error: ${n} uniqueName: ${i} id: ${a.a.toString(m)} entityTypeName: ${b}`;return t.EventManager.ReportComponentFailure(_,Error(r)),v}))});return n(Object(f.c)()).catch(e=>{y.error("Task Based Flow Global Menu was not retrieved.")}),C.then(e=>(e&&e.resultType!==o.a.Fail||y.error(`TBX not retrieved. uniqueName: ${i} id: ${a.a.toString(m)} entityTypeName: ${b}`),e))}},ZIjf:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("2yvP");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class a{constructor(e,t){this.componentName=e,this.source=t.sourceName,this.totalCalls=0,this.success=0,this.failure=0}}var i=n("IaGr");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let o;class s{constructor(){this._usage={},this._usageList=[]}static get instance(){return o||(o=new s),o}get usageList(){return this._usageList}reportCall(e,t){try{this._getUsageCounter(e,t).totalCalls++}catch(t){const n=[];n.push({name:"componentName",value:e}),i.a.getInstance().eventManager.ReportComponentFailure("ClientApi.ClientApiUsageCounters.reportCall",t,null,n)}}reportFailure(e,t){try{this._getUsageCounter(e,t).failure++}catch(t){const n=[];n.push({name:"componentName",value:e}),i.a.getInstance().eventManager.ReportComponentFailure("ClientApi.ClientApiUsageCounters.reportFailure",t,null,n)}}reportSuccess(e,t){try{this._getUsageCounter(e,t).success++}catch(t){const n=[];n.push({name:"componentName",value:e}),i.a.getInstance().eventManager.ReportComponentFailure("ClientApi.ClientApiUsageCounters.reportSuccess",t,null,n)}}static trimComponentName(e){const t=e.split(".");if(t.length<3){const t=[];t.push({name:"componentName",value:e});const n=new Error("Client API componentName should contain at least three parts.");i.a.getInstance().eventManager.ReportComponentFailure("ClientApi.ClientApiUsageCounters._trimComponentName.componentName",n,null,t)}else t.length>3&&(e=t[0]+"."+t[1]+"."+t[2]);return e}_getUsageCounter(e,t){t||(t=Object(r.a)()),e=s.trimComponentName(e);const n=`${t.sourceName}-${e}`;let i=this._usage[n];return i||(i=new a(e,t),this._usage[n]=i,this._usageList.push(i)),i}reportUsage(e){try{this.reportCall(e),this.reportSuccess(e)}catch(t){const n=[];n.push({name:"componentName",value:e}),i.a.getInstance().eventManager.ReportComponentFailure("ClientApi.ClientApiUsageCounters.reportUsage",t,null,n)}}sendReportData(){try{if(s.instance.usageList.length>0){const e=[];e.push({name:"clientApiUsage",value:JSON.stringify(s.instance.usageList)}),i.a.getInstance().eventManager.ReportComponentSuccess("ClientApi.UsageMonitor",e),o=null}}catch(e){i.a.getInstance().eventManager.ReportComponentFailure("ClientApi.ClientApiUsageCounters.sendReportData",e)}}}},ZJD9:function(e,t,n){"use strict";n.d(t,"a",(function(){return w}));var r=n("ufH1"),a=n("84PK"),i=n("504W"),o=n("Div0"),s=n("VA/h"),c=n("l3Ef");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var l;
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function u(e,t,n,r){t=d(t).trim(),n=d(n).trim(),r=d(r).trim();let a="";n.length>0&&(a=n.substring(0,1));let i="";switch(e){case 0:i=r.length>0&&t.length>0?r+", "+t:r+" "+t;break;case l.firstLast:i=t+" "+r;break;case l.lastFirstMiddleInitial:i=function(e,t,n){let r="";t.length>0&&(r=t);t.length>0&&(e.length>0||n.length>0)&&(r+=",");e.length>0&&(r=r+" "+e);n.length>0&&(r=r+" "+n+".");return r.toString().trim()}(t,r,a);break;case l.firstMiddleInitialLast:i=t,n.length>0&&(i=i+" "+a+"."),i=i+" "+r;break;case l.lastFirstMiddle:r.length>0&&(i=r),r.length>0&&(t.length>0||n.length>0)&&(i+=","),t.length>0&&(i=i+" "+t),n.length>0&&(i=i+" "+n);break;case l.firstMiddleLast:i=t,n.length>0&&(i=i+" "+n),i=i+" "+r;break;case l.lastSpaceFirst:i=r+" "+t;break;case l.lastNoSpaceFirst:i=r+t;break;default:i=r}return i.toString().trim()}function d(e){return Object(i.a)(e)?"":e}!function(e){e[e.lastFirst=0]="lastFirst",e[e.firstLast=1]="firstLast",e[e.lastFirstMiddleInitial=2]="lastFirstMiddleInitial",e[e.firstMiddleInitialLast=3]="firstMiddleInitialLast",e[e.lastFirstMiddle=4]="lastFirstMiddle",e[e.firstMiddleLast=5]="firstMiddleLast",e[e.lastSpaceFirst=6]="lastSpaceFirst",e[e.lastNoSpaceFirst=7]="lastNoSpaceFirst"}(l||(l={}));var p=n("lR0U"),f=n("ti3l"),g=n("HYaY"),h=n("WRF3"),m=n("IvgJ"),b=n("KLhE"),y=n("sdkC"),_=n("T544"),v=n("jZCH"),S=n("JPoD"),O=n("bRS5"),C=n("03Hu"),E=n("EW4s"),I=n("/A0C");class w{constructor(e,t,n,r){this._userContext=null,this._record=null,this._operation=0,this._entityMetadata=null,this._columns=new Array(0),this._values=new Array(0),this._partiesToCreate=new Array(0),this._partiesToRetain=new Array(0),this._existingParties=new Array(0),this._entityMetadata=n,this._userContext=r,this._operation=t,this._record=e}_IntializeQueryWithDefaultValues(e){const t=new E.a;return this._GetDefaultFields().then(n=>{Object(O.b)(this._record,n,e).then(e=>{this._record=e,Object(r.d)("OfflineQueryData._IntializeQueryWithDefaultValues",o.a.offlineDataStore,"IntializeQueryWithDefaultValues completed succesfully"),t.resolve(!0)},e=>{Object(r.b)("OfflineQueryData._IntializeQueryWithDefaultValues.Failed",o.a.offlineDataStore,"IntializeQueryWithDefaultValues failed with error "+e.get_Message()),t.reject(e)})},e=>{Object(r.b)("OfflineQueryData._IntializeQueryWithDefaultValues.Failed",o.a.offlineDataStore,"IntializeQueryWithDefaultValues failed with error "+e.get_Message()),t.reject(e)}),t}get_columns(){return this._columns}get_values(){return this._values}get_partiesToCreate(){return this._partiesToCreate}get_partiesToRetain(){return this._partiesToRetain}set_existingParties(e){return this._existingParties=e,e}setColumnsAndValues(e,t){const n=new E.a,l=this._operation===f.a.update?this._record.get_changedFieldNames().concat(w.get_defaultValues()):this._record.get_fieldNames(),u=[],d=this._record.get_fieldTypes();for(let e=0;e<l.length;e++)if(d[l[e]]===I.a.PartyList){const n=new Array(0);if(!Object(i.a)(this._record.getValue(l[e])))for(const r of this._record.getValue(l[e]).get_entities()){const i=r.hasField(c.e)?r.getValue(c.e):a.a.get_empty();this._operation===f.a.update&&r.hasValue(c.e)&&i!==a.a.get_empty()&&this._existingParties.indexOf(i.toString().toUpperCase())>=0?n[n.length]=r.getValue(c.e).toString().toUpperCase():u.push(this._PrepareActivityPartyRecord(l[e],r,t.toString()))}this._operation===f.a.update&&(this._partiesToRetain[this._partiesToRetain.length]=this._PreparePartiesToRetain(t.toString().toUpperCase(),n.length>0?n:[""],l[e]))}else{const t=Object(p.b)(l[e],d[l[e]],this._record.getValue(l[e]));for(const n in t){const r={key:n,value:t[n]};this._columns[this._columns.length]=r.key,d[l[e]]===I.a.PickList?this._values[this._values.length]=Object(i.a)(r.value)?null:r.value.toString():this._values[this._values.length]=Object(i.a)(r.value)?"":r.value.toString()}}if(this._record.get_identifier().LogicalName===S.d&&this._operation===f.a.create&&this._record.hasValue(c.O)){const e=this._record.getValue(c.O);Object(i.a)(e)||(this._columns[this._columns.length]=c.P,this._values[this._values.length]=e.LogicalName)}if(Object(i.a)(this._record.get_identifier().get_rowVersion())||(this._columns[this._columns.length]=c.fb,this._values[this._values.length]=this._record.get_identifier().get_rowVersion()),this._operation)this._operation===f.a.update&&(this._values[this._values.length]=t.toString().toUpperCase());else if((!(e in this._record.fields)||Object(i.a)(this._record.get_identifier())||Object(i.a)(this._record.get_identifier().Id)||this._record.get_identifier().Id===a.a.get_empty())&&(this._columns[this._columns.length]=e,this._values[this._values.length]=t.toString().toUpperCase()),!Object(i.a)(this._entityMetadata)&&this._entityMetadata.get_isActivity()){const e=new h.a(c.d,a.a.get_empty()),n=new y.a(new Array(0)),r=new g.a(e,{},{},{},{},n);r.initializeValue(c.W,this._record.getValue(c.Q),I.a.Lookup),u.push(this._PrepareActivityPartyRecord(c.R,r,t.toString()))}return u.length<=0?n.resolve(!0):Object(s.a)(u).then(e=>{for(const t of e)this._partiesToCreate.push(t);Object(r.e)("OfflineQueryData.setColumnsAndValues",o.a.offlineDataStore,"Set columns and Values succeeded"),n.resolve(!0)},e=>{Object(r.e)("OfflineQueryData.setColumnsAndValues.Failed",o.a.offlineDataStore,e.get_Message()),n.reject(e)}),n}_GetDefaultFields(){const e=[],t=new E.a;if(!this._operation){const t=w.get_createDefaultValues();t.push(...w.get_stateAndStatusFields());const n=t.indexOf(c.Q);n>=0&&this._entityMetadata.get_ownershipType()===b.a.organizationOwned&&t.splice(n,1);for(const n of t)this._record.hasValue(n)||e.push(n);if(!Object(i.a)(this._entityMetadata)&&this._entityMetadata.get_isActivity()&&(this._record.hasValue(c.f)||this._record.initializeValue(c.f,this._entityMetadata.get_logicalName(),I.a.String),!this._record.hasValue(c.G))){const e={};e[c.db]=this._IsRegularActivity()?"1":"0",this._record.initializeValue(c.G,m.a.createFromObjectData(e),I.a.Boolean)}}if(this._operation&&this._operation!==f.a.update)Object(r.e)("OfflineQueryData._GetDefaultFields",o.a.offlineDataStore,"Get default fields succeeded for entity "+this._entityMetadata.get_logicalName()),t.resolve(e);else{for(const t of w.get_defaultValues())e[e.length]=t;v.a.get_DefaultInstance().retrieveMultipleAttributeMetadata(new _.a(this._record.get_identifier().LogicalName),null).then(n=>{if(!Object(i.a)(n)&&this._isAttributeAvailable(n,c.z))for(const e of this._record.get_changedFieldNames())if(c.A.indexOf(e)>=0){this._record.initializeValue(c.z,u(this._userContext.get_organizationSettings().get_fullNameConventionCode(),this._record.getValue(c.y),this._record.getValue(c.K),this._record.getValue(c.I)),I.a.String),this._record.get_changedFieldNames().push(c.z);break}if(!this._operation)for(const t of n)(!Object(i.a)(t.get_defaultValue())||!Object(i.a)(t.get_defaultFormValue()))&&(this._record.get_fieldNames().indexOf(t.get_logicalName())<0||Object(i.a)(this._record.fields[t.get_logicalName()]))&&e.indexOf(t.get_logicalName())<0&&(e[e.length]=t.get_logicalName());Object(r.e)("OfflineQueryData._GetDefaultFields",o.a.offlineDataStore,"Get default fields succeeded for entity "+this._entityMetadata.get_logicalName()),t.resolve(e)},e=>{Object(r.e)("OfflineQueryData._GetDefaultFields.Failed",o.a.offlineDataStore,"Get default fields failed for entity "+this._entityMetadata.get_logicalName()+" with error "+e.get_Message()),t.reject(e)})}return t}_isAttributeAvailable(e,t){for(const n of e)if(n.get_logicalName().toLowerCase()===t)return!0;return!1}_IsRegularActivity(){switch(this._entityMetadata.get_objectTypeCode()){case 4208:case 4209:case 4211:case 4206:case 4406:case 4251:return!1}return!!this._entityMetadata.get_activityTypeMask()}_PrepareActivityPartyRecord(e,t,n){const s=new E.a,l=t.getFieldObjectData(c.W);return v.a.get_DefaultInstance().retrieveMultipleAttributeMetadata(new _.a(c.d,[c.F]),null).then(u=>{const d=u[0],p=t.hasField(c.e)&&t.getValue(c.e)!==a.a.get_empty()?t.getValue(c.e):a.a.newGuid();v.a.get_DefaultInstance().retrieveEntityMetadata(l[c.J].toString(),null).then(u=>{const f=[p.toString().toUpperCase(),n.toUpperCase(),this._record.get_identifier().Name,this._record.get_identifier().LogicalName,c.S[e].toString(),a.a.createFromObjectData(l[c.B]).toString().toUpperCase(),Object(i.a)(l[c.a])?"":l[c.a].toString(),l[c.J].toString(),!Object(i.a)(d)&&d.get_defaultValue()?"1":"0"];Object(r.e)("OfflineQueryData._PrepareActivityPartyRecord",o.a.offlineDataStore,"PrepareActivityPartyRecord succeeded"),s.resolve({entityreference:t.get_identifier(),columns:[c.e,c.c+c.l+c.B,c.c+c.l+c.a,c.c+c.l+c.J,c.T,c.W+c.l+c.B,c.W+c.l+c.a,c.W+c.l+c.J,c.F],values:f})},e=>{Object(r.e)("OfflineQueryData._PrepareActivityPartyRecord.Failed",o.a.offlineDataStore,"PrepareActivityPartyRecord failed with error "+e.get_Message()),s.reject(e)})},e=>{Object(r.e)("OfflineQueryData._PrepareActivityPartyRecord.Failed",o.a.offlineDataStore,"PrepareActivityPartyRecord failed with error "+e.get_Message()),s.reject(e)}),s}_PreparePartiesToRetain(e,t,n){return{activityid:e,participationtypemask:c.S[n].toString(),resolvedparties:t}}static get_createDefaultValues(){return[c.p,c.o,c.Q,c.M,c.L]}static get_defaultValues(){return[c.M,c.L]}static get_stateAndStatusFields(){return[c.ab,c.bb]}static getOfflineQueryDataObject(e,t,n,a,s,c){const l=new E.a,u=new w(e,t,s,c);return u._IntializeQueryWithDefaultValues(s).then(t=>{!Object(i.a)(s)&&s.get_isActivity()?C.a.get_DefaultInstance().getExistingActivityParties(e).then(e=>{u.set_existingParties(e),u.setColumnsAndValues(n,a).then(e=>{Object(r.d)("OfflineQueryData_GetOfflineQueryDataObject",o.a.offlineDataStore,"GetOfflineQueryDataObject completed succesfully"),l.resolve(u)},e=>{Object(r.e)("OfflineQueryData_GetOfflineQueryDataObject.Failed",o.a.offlineDataStore,e.get_Message()),l.reject(e)})},e=>{Object(r.e)("OfflineQueryData_GetOfflineQueryDataObject.Failed",o.a.offlineDataStore,e.get_Message()),l.reject(e)}):(u.setColumnsAndValues(n,a).then(e=>{Object(r.d)("OfflineQueryData_GetOfflineQueryDataObject",o.a.offlineDataStore,"GetOfflineQueryDataObject completed succesfully"),l.resolve(u)},e=>{Object(r.e)("OfflineQueryData_GetOfflineQueryDataObject.Failed",o.a.offlineDataStore,e.get_Message()),l.reject(e)}),Object(r.d)("OfflineQueryData_GetOfflineQueryDataObject",o.a.offlineDataStore,"GetOfflineQueryDataObject completed succesfully"),l.resolve(u))},e=>{Object(r.e)("OfflineQueryData_GetOfflineQueryDataObject.Failed",o.a.offlineDataStore,e.get_Message()),l.reject(e)}),l}}},ZMWz:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="control.setlabel";function i(e,t,n,i){const o=Object(r.w)(n);return{type:a,payload:i,meta:{pageId:e,controlName:t,contextKey:o}}}},ZPAw:function(e,t,n){"use strict";n.d(t,"c",(function(){return x})),n.d(t,"a",(function(){return j})),n.d(t,"b",(function(){return R}));var r=n("LbMF"),a=n("qAG9"),i=n("qpML"),o=n("8nT0"),s=n("+pAH"),c=n("lY/Z"),l=n("iZ7K"),u=n("5Oca"),d=n("/A0C"),p=n("69Qu"),f=n("37s6"),g=n("sZ+8"),h=n("f07+"),m=n("4r2D"),b=n("SAYH"),y=n("Wc7r"),_=n("GYEz"),v=n("w1eR"),S=n("/oKV"),O=n("l3Ef"),C=n("Uv1Y"),E=n("np5s");function I(e,t,n,r,a){const o={fileProgress:n,operationType:i.a.Upload,pageId:r};return a&&(o.fileName=a.fileName,o.mimeType=a.mimeType,o.fileSize=a.fileSize),{type:s.a,payload:{identifier:e,attributeName:t,fileState:o}}}function w(e,t){return e.read().then(e=>e||null).catch(e=>{throw t.error("Failed to read next chunk"),e})}function j(e,t,n,r){let a="";if(r===d.a.File){const n=Object(l.D)(e,t.etn,O.w,O.x);n&&(a=n.ReferencedEntityNavigationPropertyName)}else if(r===d.a.Image){const r=Object(l.A)(e,t.etn,O.C,n+"id");r&&(a=r.ReferencingEntityNavigationPropertyName)}if(!a)throw new Error("Unable to retrieve file navigation property, attribute type = "+r+", target entity = "+t.etn+", file attribute name = "+n);return a}function P(e,t,n){const r={"Content-Type":"application/octet-stream"};return t&&(r["x-ms-transfer-mode"]="chunked"),n&&(r["Content-Range"]=n),r}function T(e,t,n){let r=`/${t}${y.UPLOAD_FILENAME_URL_FRAGMENT}${encodeURIComponent(e.fileName)}`;return n&&(r=r+"&"+n),r}async function N(e,t,n,r,o,s,c,l,d){const p=T(t,n),f=P(0,!0),g=new h.k(r.etn,r.id.guid.toString(),"",p,f,!0);let y=b.a.newGuid().guid;l.push({name:"REQUEST_ID",value:y});const _=await s.DataSource.executeOData(g,new m.a(y),S.a.Remote);if(_&&200===_.status){const f=T(t,n,function(e,t){const n=Object(a.a)(e,"Location");if(n){const e=n.indexOf(t);return n.substring(e+t.length+1,n.length)}return null}(_.headers,p)),g=function(e,t){const n=Object(a.a)(e,"x-ms-chunk-size");return n?Number(n):(t.error("Server didn't return x-ms-chunk-size in headers, taking default value of 4 MB"),4194304)}(_.headers,c),E=t.getBinaryReader(g);let j=E.getCurrentIndex(),N=await w(E,c),A=Object(u.k)(e(),r,n),R="";for(l.push({name:"MaximumChunkSizePerUpload",value:g}),l.push({name:"UrlForChunkUploadRequest",value:f});!N.done&&A!==i.b.Cancelled;){const a=N.value;if(!a)throw l.push({name:"FailureReason",value:"Next chunk is not present"}),l.push({name:"CurrentChunkIndex",value:j}),c.error("Chunk upload failed ",l),o(I(r,n,i.b.Failed,d)),new Error("Next chunk is not present");{const p=(v=j,O=j+a.length-1,C=t.fileSize,"bytes "+v.toString()+"-"+O.toString()+"/"+C.toString());R=R+"|"+p;const g=P(0,!1,p),_=new h.k(r.etn,r.id.guid.toString(),a,f,g,!0);y=b.a.newGuid().guid,l.push({name:"REQUEST_ID",value:y});const T=await s.DataSource.executeOData(_,new m.a(y),S.a.Remote);if(!T||204!==T.status&&206!==T.status)throw l.push({name:"HttpStatus",value:T.status}),l.push({name:"ChunkRange",value:p}),l.push({name:"FailureReason",value:"Chunk upload failed"}),c.error("Chunk upload failed ",l),o(I(r,n,i.b.Failed,d)),new Error("chunk upload failed with http status = "+T.status);j=E.getCurrentIndex(),N=await w(E,c),A=Object(u.k)(e(),r,n)}}return l.push({name:"ChunkRange",value:R}),void(A===i.b.Cancelled?l.push({name:"UploadCancelled",value:!0}):o(I(r,n,i.b.Finished,d)))}var v,O,C;throw o(I(r,n,i.b.Failed,d)),l.push({name:"FailureReason",value:"First call to server failed"}),c.error("Chunk upload failed ",l),new Error("chunking upload failed")}async function A(e,t,n,r,a,o,s,c){const l=s.slice();try{if(r.fileUrl){const n=P(0,!1);n[y.HEADER.FILE_URL]=r.fileUrl,n[y.HEADER.FILE_SIZE]=r.fileSize.toString(),n[y.HEADER.MIME_TYPE]=r.mimeType;const s=T(r,a);l.push({name:"UrlForSingleUploadRequest",value:s});const u=new h.k(o.etn,o.id.guid.toString(),"",s,n,!0),d=b.a.newGuid().guid;return l.push({name:"REQUEST_ID",value:d}),await t.DataSource.executeOData(u,new m.a(d),S.a.Local),void e(I(o,a,i.b.Finished,c))}throw new Error("Offline upload failed: fileUrl is not present in file object ")}catch(t){const n=new Error("Offline upload failed with exception - "+t);throw e(I(o,a,i.b.Failed,c)),n}}function R(e,t,n,a){if(Object(_.a)(e)!==v.a.MobileApplication)return!1;if(a)return!1;const i=Object(r.b)(n,t.etn,e);return!(Object(p.c)(e)||!Object(f.D)(e)||!Object(g.n)(e,t.etn)||!(i===d.a.Image&&Object(g.n)(e,O.C)||i===d.a.File&&Object(g.n)(e,O.w)))}async function D(e,t,n,r,a,o,s,c,l){const u=t.TraceManager.getTracer("UploadFile");e(I(o,a,i.b.InProgress,l,r));let d=!1;c.push({name:"IsChunkUpload",value:d}),c.push({name:"IsUpSync",value:s});const p=R(n(),o,a,s);c.push({name:"IsOfflineUpload",value:p});const f=c.slice();u.warn("Starting upload of new file.",f);try{if(p){const i=Object(E.b)(n());if(r.fileUrl.startsWith(i))await A(e,t,n(),r,a,o,c,l);else{c.push({name:"UploadToLWSBeforeOfflineUpload",value:!0});const s=i+r.fileName,d=(await r.getBinaryReader(r.fileSize).read()).value;if(!(await fetch(s,{method:"PUT",mode:"cors",headers:{"Content-Type":r.mimeType},body:d})).ok)throw u.error("Uploading file to local web server failed.",f),new C.a("Uploading file to local web server failed. Response was not ok");r.fileUrl=s,await A(e,t,n(),r,a,o,c,l)}}else d=function(e){return e.fileSize>16777216}(r),d?await N(n,r,a,o,e,t,u,f,l):await async function(e,t,n,r,a,o,s,c){let l;try{l=await n.getBinaryReader(n.fileSize).read()}catch(t){const n=s.slice();throw n.push({name:"FailureReason",value:(null==t?void 0:t.message)||"Reading from file failed"}),n.push({name:"ErrorDetails",value:t}),o.error("Single chunk upload failed. File read failed",n),e(I(a,r,i.b.Failed,c)),t}const u=P(0,!1),d=T(n,r),p=l.value,f=s.slice();f.push({name:"UrlForSingleUploadRequest",value:d}),f.push({name:"ChunkValueLengthReadFromFile",value:p.length});const g=new h.k(a.etn,a.id.guid.toString(),p,d,u,!0);try{const n=b.a.newGuid().guid;f.push({name:"REQUEST_ID",value:n});const s=await t.DataSource.executeOData(g,new m.a(n),S.a.Remote);if(s){if(204===s.status)return void e(I(a,r,i.b.Finished,c));throw e(I(a,r,i.b.Failed,c)),f.push({name:"HttpStatus",value:s.status}),f.push({name:"FailureReason",value:"Server returned non 204 response"}),o.error("Single chunk upload failed ",f),new Error("Server returned non 204 response")}throw f.push({name:"FailureReason",value:"Upload response from server is null"}),o.error("Single chunk upload failed",f),e(I(a,r,i.b.Failed,c)),new Error("Upload response from server is null")}catch(t){throw f.push({name:"FailureReason",value:(null==t?void 0:t.message)||"Upload to server failed"}),f.push({name:"ErrorDetails",value:t}),o.error("Single chunk upload failed ",f),e(I(a,r,i.b.Failed,c)),t}}(e,t,r,a,o,u,f,l);return void t.EventManager.ReportComponentSuccess("UploadFile",f)}catch(n){const r=Object(C.c)(n);throw t.EventManager.ReportComponentFailure("UploadFile",r,"",f),e(I(o,a,i.b.Failed,l)),r}}function x(e,t,n,a,s=!1){return{type:"upload.file",async execute({dispatch:p,getState:f},g){const h=g.TraceManager.getTracer("UploadFile"),m=[];if(m.push({name:"FileSize",value:e.fileSize}),m.push({name:"MimeType",value:e.mimeType}),m.push({name:"AttributeName",value:t}),m.push({name:"EntityName",value:n.etn}),m.push({name:"RecordId",value:n.id.guid.toString()}),0===e.fileSize)throw h.error("Empty file not allowed",m),new C.a("Empty file not allowed");try{await D(p,g,f,e,t,n,s,m,a);if(Object(u.k)(f(),n,t)===i.b.Cancelled)return h.warn("upload request was cancelled ",m),null;if(s)return null;const b=Object(r.b)(t,n.etn,f()),y=j(f(),n,t,b),_=function(e){let t=o.j;return e===d.a.File?[t,o.h,o.r,o.g,o.u,o.B]:(t=o.i,[t,o.h,o.r,o.k,o.m,o.o,o.n,o.b,o.q])}(b),v=function(e,t,n){let a=[];const i=Object(l.H)(e,t.etn);return a=Object(r.b)(n,t.etn,e)===d.a.File?[i,n,n+"_name"]:[i],a}(f(),n,t),S=[];S.push({navigationProperty:y,columnNames:_});try{await p(Object(c.e)(n,v,null,S,void 0,a));return Object(u.z)(f(),n,y,t)}catch(e){return m.push({name:"ErrorDetails",value:e}),h.error("upload request succeeded but retrieve record data failed ",m),null}}catch(e){throw h.error("upload request failed ",m),p(I(n,t,i.b.Failed,a)),e}}}}},ZUus:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.On=1]="On",e[e.Off=2]="Off",e[e.Entity=3]="Entity"}(r||(r={}))},ZYsU:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="core.boot.perf.changedelayloadingstatus.sync",a="core.boot.perf.changeshellcomponentsdelayloadingstatus.sync"},ZePi:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e.mobile="Mobile",e.outlook="Outlook",e.web="Web",e.unifiedServiceDesk="UnifiedServiceDesk"}(r||(r={}))},ZhaJ:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("nA3O"),a=n("/Ypj"),i=n("NMtn");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
let o=0;class s extends r.a{constructor(){super(),this._callbackID=null,this._callContext=null,this._serialNumber=o++,this._callbackID=Object.getType(this).getName()+this._serialNumber}get_callbackID(){return this._callbackID}get_callContext(){return this._callContext||(this._callContext=new a.a(null,null)),this._callContext}set_callContext(e){return this._callContext=e,e}callback(e){Object(i.b)(e,"args"),this.verifyArgs(e)&&this.call()}verifyArgs(e){return this.setValues(e),!0}}},Zit9:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("iLty");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t){return{type:"DESERIALIZE_DISASSOCIATE_RESPONSE_ASYNC",execute({dispatch:e,getState:t},n){const a=new r.a(null);return Promise.resolve(a)}}}},Ziun:function(e,t,n){"use strict";n.d(t,"b",(function(){return W})),n.d(t,"a",(function(){return V}));var r=n("mMyr"),a=n("huli"),i=n("Afz2"),o=n("kXuq"),s=n("MTWl"),c=n("u+q+"),l=n("unFF"),u=n("wE9H"),d=n("LzVy"),p=n("sclX"),f=n("b8TU"),g=n("nJrx"),h=n("/to1"),m=n("NjDY"),b=n("EY5k"),y=n("YxC/"),_=n("BM7Q"),v=n("GYEz"),S=n("FhVi"),O=n("Gilj"),C=n("3rse"),E=n("w1eR"),I=n("CXmn"),w=n("KOTC"),j=n("gxvI"),P=n("glAs"),T=n("IYuw"),N=n("SocB"),A=n("2c85"),R=n("IqkD"),D=n("ju1h"),x=n("dfL6"),M=n("mpSO"),F=n("QBtP"),k=n("UvHz");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const L=Object(g.a)(),B=Object(g.a)(),U=Object(g.a)(),V="topBar";function z(e){const{theme:t,isRTL:n}=e,r=n?"right":"left";if(!e.displaySkipLink)return{position:"absolute",[r]:-1e3};const a=p.b.Native&&e.clientHost===E.a.MailApp,i=a?Object(N.g)(N.d.Blue.Blue6,N.b).Fill:e.styles.buttonHover.backgroundColor,o=a?"inherit":e.styles.textColor,s=e.styles.focusOutlineColor;return{position:"absolute",[r]:-1e3,height:a?t.sizes.NavBarHeightMobile:e.styles.navbarHeight,backgroundColor:i,color:o,zIndex:1,outline:"none !important",textDecoration:"none",alignItems:"center",display:"flex",padding:"0 1em",":focus":{[r]:e.renderWaffle||e.renderToggleButton?e.styles.navbarHeight:0},"> span":{border:"1px solid "+s,padding:"3px",":hover":{textDecoration:"underline"}}}}const q={justifyContent:"flex-start",flexShrink:0};class H extends r.Component{constructor(e){super(e),this._appNameWidth=0,this._watermarkWidth=0,this._topBarWidth=0,this._leftWidth=0,this._rightWidth=0,this._onMeasureHandler=this._onMeasureHandler.bind(this),this._focusMainPageContentClickHandler=this._focusMainPageContentClickHandler.bind(this),this._focusMainPageContentKeyDownHandler=this._focusMainPageContentKeyDownHandler.bind(this),this.state={globalCommandBarSize:0,hideWatermark:!1};const t=[_.e];this.props.isPreviewOrg&&!Object(y.c)(e.resourceStrings,_.f)?t.push(_.f):this.props.isSandboxOrg&&!Object(y.c)(e.resourceStrings,_.g)&&t.push(_.g),this.props.showMooncakeBranding&&t.push(_.c),e.retrieveResourceStrings(t)}_onMeasureHandler(e){e>0&&this.state.globalCommandBarSize!==e&&this.setState({globalCommandBarSize:e})}_calculateElementsToHide(){const e=this._getWatermarkWidth(),t=this._getAppNameWidth();let n=!1,r=!1;if(t&&this._topBarWidth){const a=this._topBarWidth-this._leftWidth-this._rightWidth;a<t+e&&(r=!0,n=a<t),this.props.hideAppName!==n&&this.props.setHideAppNameInTopBar(n),this.state.hideWatermark!==r&&this.setState({hideWatermark:r})}}_getAppNameWidth(){if(!this._appNameWidth&&this._appNameRef){const e=a.findDOMNode(this._appNameRef);this._appNameWidth=e?e.offsetWidth:0}return this._appNameWidth}_getWatermarkWidth(){if(this._topBarWidth<M.f)return 48;const e=a.findDOMNode(this._watermarkRef);return!this._watermarkWidth&&e&&(this._watermarkWidth=e.offsetWidth),this._watermarkWidth||48}_renderTopBar(){const e=this.props.clientHost===E.a.MailApp,t=e?(n=this.props.theme,Object.assign(function(e){return{backgroundColor:e.colors.SiteMap.NavigationBarMobile.Fill,height:e.sizes.NavBarHeightMobile}}(n),{color:n.colors.NavBar.NavBar1.Text,backgroundColor:n.colors.NavBar.NavBar1.Fill,justifyContent:"space-between"})):function(e){const{theme:t}=e;return{position:"relative",backgroundColor:e.styles.backgroundColor,justifyContent:"space-between",height:e.styles.navbarHeight,color:e.styles.textColor,borderBottom:e.isEmbededTopBar2020Update?"1px solid "+t.colors.NavBar.NavBar3.Fill:void 0,boxSizing:"border-box"}}(this.props);var n;return r.createElement(o.a,{key:"topbarLandmark",role:i.c},this._renderSkipToMainContentLink(),r.createElement(o.a,{style:t,testhooks:{id:V},id:V,key:V,isRequestedMeasuring:!0,onMeasuring:e=>{this._topBarWidth=e,this._calculateElementsToHide()}},r.createElement(o.a,{style:q,key:"navbar-left-wrapper",id:L},r.createElement(o.a,{style:q,key:"navbar-left",isRequestedMeasuring:!0,onMeasuring:e=>{this._leftWidth=e,this._calculateElementsToHide()}},this._renderOfficeWaffle(),this._renderSitemapToggleButton(e),this._renderDynamicsButton()),this._renderBreadCrumbBar()),this._renderGlobalSearchBox(),this._renderWatermark(),r.createElement(o.a,{key:"global-command-bar-wrapper",id:B,isRequestedMeasuring:!0,onMeasuring:e=>{this._rightWidth=e,this._calculateElementsToHide()}},this._renderGlobalCommandBar(u.a.BrowserNormal))))}_renderSkipToMainContentLink(){const e=Object(y.c)(this.props.resourceStrings,_.e);return r.createElement(r.Fragment,null,r.createElement(s.a,{key:"focusMainPageContent",style:z(this.props),accessibilityLabel:e,title:e,id:"focusMainPageContent",tabIndex:this.props.displaySkipLink?0:-1,onKeyDown:this._focusMainPageContentKeyDownHandler,onClick:this._focusMainPageContentClickHandler,testhooks:{[D.o]:!0}},r.createElement(h.a,null,e)),!this.props.isEnableLandmarkFeature&&r.createElement(S.a,{key:"focusMainPageContentAccessibility",rootElementId:"focusMainPageContent",isModal:!1,shouldManageFocus:!1,waitForEditable:!1,keyboardShortcuts:this._createKeyboardShortcuts()}))}_renderGlobalCommandBar(e){return r.createElement(w.a,{key:"global-command-bar",loader:()=>Promise.all([n.e(6),n.e(12),n.e(63),n.e(123)]).then(n.bind(null,"jsLW")).then(e=>e.GlobalCommandBar),props:{cmdbarType:e}})}_renderSitemapToggleButton(e){if(!this.props.renderToggleButton)return null;const t=e?this.props.theme.sizes.NavBarHeightMobile:this.props.styles.navbarHeight;return r.createElement(j.a,{hoverBackgroundColor:this.props.theme.colors.NavBar.NavBar2.Fill,iconColor:this.props.styles.textColor,isHeaderButton:!0,overwriteStyle:{padding:0,height:t,width:t}})}_renderOfficeWaffle(){return this.props.renderWaffle?r.createElement(w.a,{key:"officeAppLauncher",loader:()=>Promise.all([n.e(192),n.e(5),n.e(148)]).then(n.bind(null,"Byjr")).then(e=>e.OfficeAppLauncherWrapper)}):null}_renderDynamicsButton(){return!this.props.hideBrandName&&r.createElement(w.a,{key:"dynamicsOct2020",ref:e=>this._appNameRef=e,loader:()=>n.e(114).then(n.bind(null,"WbbL")).then(e=>e.DynamicsButtonOct2020)})}_renderBreadCrumbBar(){return this.props.hideAppName?null:r.createElement(w.a,{key:"appNameBar",ref:e=>this._appNameRef=e,loader:()=>n.e(95).then(n.bind(null,"I53g")).then(e=>e.AppNameBar)})}_renderGlobalSearchBox(){return this.props.isGlobalSearchEnabled?r.createElement(w.a,{key:"GlobalSearchContainer",loader:()=>Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(187),n.e(63),n.e(121)]).then(n.bind(null,"SCqX")).then(e=>e.GlobalSearchContainer)}):null}_renderWatermark(){if(this.props.viewportWidth<960||this.state.hideWatermark)return null;let e=null;if(this.props.isPreviewOrg)e=Object(y.c)(this.props.resourceStrings,_.f);else{if(!this.props.isSandboxOrg)return null;e=Object(y.c)(this.props.resourceStrings,_.g)}return r.createElement(o.a,{id:U,key:"navbar-watermark",ref:e=>this._watermarkRef=e},r.createElement(h.a,{style:(t=this.props.theme,n=this.props.styles,{color:n.textColor,fontFamily:n.fontFamilies.Semilight,fontSize:"40px",lineHeight:"44px",paddingLeft:t.sizes.Measures.Measure100,paddingRight:t.sizes.Measures.Measure100,whiteSpace:"nowrap"})},e));var t,n}render(){return this._renderTopBar()}_createKeyboardShortcuts(){const e=this._focusMainPageContentShortcutHandler.bind(this),t=[],n=new O.a([C.a.Ctrl,C.a.OpenBracket],e,!0,"","");return t.push(n),t}_focusMainPageContentShortcutHandler(e){const t=e.EVENT;t.ctrlKey&&t.keyCode===C.a.OpenBracket&&!this.props.getIsDialogOpen()&&(e.APPLICATION_CONTEXT.AccessibilityManager.showOutlineState(!0),this._focusToMainContent(),t.stopPropagation())}_focusMainPageContentKeyDownHandler(e){switch(e.keyCode){case C.a.Enter:case C.a.Space:this._focusToMainContent(),e.stopPropagation(),e.preventDefault()}}_focusMainPageContentClickHandler(e){this._focusToMainContent(),e.stopPropagation(),e.preventDefault()}_focusToMainContent(){Object(k.a)(),this.context.AccessibilityManager.showOutlineState(!0)}}const W=Object(c.a)((function(){const e=Object(y.h)();return function(t,n){const r=Object(l.a)(t),a=Object(A.a)(t),i=Object(d.a)(t),o=Object(f.c)(t),s=Object(m.p)(t),c=Object(m.s)(t),u=e(t,_.d),p=Object(I.c)(t),g=Object(v.a)(t),h=Object(I.k)(t),b=Object(I.i)(t),y=Object(I.m)(t),S=Object(I.j)(t),O=Object(I.d)(t);return{theme:r,styles:a,platformType:i,viewportWidth:o,isPreviewOrg:s,isSandboxOrg:c,resourceStrings:u,clientHost:g,showMooncakeBranding:h,renderToggleButton:b,useThemedMobileHeader:y,renderWaffle:S,isEmbededTopBar2020Update:p,hideBrandName:Object(I.f)(t),hideAppName:Object(I.e)(t)||Object(P.a)(t),isGlobalSearchEnabled:O,displaySkipLink:Object(I.h)(t),isRTL:Object(R.g)(t),isEnableLandmarkFeature:Object(x.b)(t)}}}),(function(e,t){return{retrieveResourceStrings:t=>e(Object(b.e)(t)),setHideAppNameInTopBar:t=>e(Object(T.c)(t))}}))(H);H.contextType=F.a},ZkVb:function(e,t,n){"use strict";
/** @license React v16.10.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */Object.defineProperty(t,"__esModule",{value:!0});var r="function"==typeof Symbol&&Symbol.for,a=r?Symbol.for("react.element"):60103,i=r?Symbol.for("react.portal"):60106,o=r?Symbol.for("react.fragment"):60107,s=r?Symbol.for("react.strict_mode"):60108,c=r?Symbol.for("react.profiler"):60114,l=r?Symbol.for("react.provider"):60109,u=r?Symbol.for("react.context"):60110,d=r?Symbol.for("react.async_mode"):60111,p=r?Symbol.for("react.concurrent_mode"):60111,f=r?Symbol.for("react.forward_ref"):60112,g=r?Symbol.for("react.suspense"):60113,h=r?Symbol.for("react.suspense_list"):60120,m=r?Symbol.for("react.memo"):60115,b=r?Symbol.for("react.lazy"):60116,y=r?Symbol.for("react.fundamental"):60117,_=r?Symbol.for("react.responder"):60118,v=r?Symbol.for("react.scope"):60119;function S(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case a:switch(e=e.type){case d:case p:case o:case c:case s:case g:return e;default:switch(e=e&&e.$$typeof){case u:case f:case l:return e;default:return t}}case b:case m:case i:return t}}}function O(e){return S(e)===p}t.typeOf=S,t.AsyncMode=d,t.ConcurrentMode=p,t.ContextConsumer=u,t.ContextProvider=l,t.Element=a,t.ForwardRef=f,t.Fragment=o,t.Lazy=b,t.Memo=m,t.Portal=i,t.Profiler=c,t.StrictMode=s,t.Suspense=g,t.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===o||e===p||e===c||e===s||e===g||e===h||"object"==typeof e&&null!==e&&(e.$$typeof===b||e.$$typeof===m||e.$$typeof===l||e.$$typeof===u||e.$$typeof===f||e.$$typeof===y||e.$$typeof===_||e.$$typeof===v)},t.isAsyncMode=function(e){return O(e)||S(e)===d},t.isConcurrentMode=O,t.isContextConsumer=function(e){return S(e)===u},t.isContextProvider=function(e){return S(e)===l},t.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===a},t.isForwardRef=function(e){return S(e)===f},t.isFragment=function(e){return S(e)===o},t.isLazy=function(e){return S(e)===b},t.isMemo=function(e){return S(e)===m},t.isPortal=function(e){return S(e)===i},t.isProfiler=function(e){return S(e)===c},t.isStrictMode=function(e){return S(e)===s},t.isSuspense=function(e){return S(e)===g}},Zn5P:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return s}));const r="indicator.notification.add",a="indicator.notification.remove";let i=0;function o(e){return{type:r,payload:{id:"indicatorId-"+i++,type:e}}}function s(e){return{type:a,payload:e}}},Znsu:function(e,t,n){"use strict";n.d(t,"j",(function(){return r})),n.d(t,"w",(function(){return a})),n.d(t,"n",(function(){return i})),n.d(t,"r",(function(){return o})),n.d(t,"i",(function(){return s})),n.d(t,"s",(function(){return c})),n.d(t,"o",(function(){return l})),n.d(t,"g",(function(){return u})),n.d(t,"k",(function(){return d})),n.d(t,"l",(function(){return p})),n.d(t,"q",(function(){return f})),n.d(t,"p",(function(){return g})),n.d(t,"v",(function(){return h})),n.d(t,"m",(function(){return m})),n.d(t,"u",(function(){return b})),n.d(t,"t",(function(){return y})),n.d(t,"x",(function(){return _})),n.d(t,"z",(function(){return v})),n.d(t,"y",(function(){return S})),n.d(t,"e",(function(){return O})),n.d(t,"f",(function(){return C})),n.d(t,"A",(function(){return E})),n.d(t,"c",(function(){return I})),n.d(t,"a",(function(){return w})),n.d(t,"d",(function(){return j})),n.d(t,"b",(function(){return P})),n.d(t,"h",(function(){return T}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="balloon",a="TourStep",i="msdyn_tour",o="msdyn_path",s="apps",c="/",l="?$select=msdyn_displayname,msdyn_path,msdyn_tourdefinition,msdyn_tourid,msdyn_labelsresource",u="PowerTours",d="Cancel",p="Complete",f="Tour Name",g="Tour Id",h="Total Steps",m="Current Step Number",b="StepChanged",y="Tour Run Id",_=/\${([^}]+)}/g,v="UCI",S="SwitchTab",O="ExecuteWebResource",C=".js",E="navigationcontextprovider",I="drawerStep",w="balloonStep",j="drawer",P="balloon",T="PowerToursScriptContainer"},Znul:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class r{constructor(e,t,n,r,a,i){this.LookupEntityByName=e,this.EntityAndAttribute=t,this.AppId=n,this.RelatedRecordId=r,this.QueryString=a,this.ReturnMetadata=i}getMetadata(){return{boundParameter:null,operationName:null,operationType:null,parameterTypes:{LookupEntityByName:{typeName:"mscrm.LookupEntityInfo",structuralProperty:4},EntityAndAttribute:{typeName:"Microsoft.Dynamics.CRM.EntityAndAttribute",structuralProperty:2},AppId:{typeName:"Edm.Guid",structuralProperty:1},RelatedRecordId:{typeName:"Edm.Guid",structuralProperty:1},QueryString:{typeName:"Edm.String",structuralProperty:1},ReturnMetadata:{typeName:"Edm.Boolean",structuralProperty:1}}}}}},ZoNW:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e,t){if(!(t&&t.length&&e&&e.metadata&&e.metadata.labels))return[];const n=e.metadata.labels,r=[];for(let e=0;e<t.length;e++){const a=t[e].split(":",2);n[a[0]]&&n[a[0]][a[1]]||r.push(t[e])}return r}n.d(t,"a",(function(){return r}))},"Zpd/":function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return g}));var r=n("jRy5"),a=n("dHD5"),i=n("ApeL"),o=n("i1f0"),s=n("wL2W"),c=n("4aOd"),l=n("pEXn"),u=n("+Qpx"),d=n("tWr6"),p=n("d4Lp");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const f="control.disabled";function g(e,t,n,g){return{type:"control.disabled.sync",sync:!0,execute({dispatch:h,getState:m},b){var y;const _=m();if(n&&n.contextTokenType&&n.contextTokenType===r.a.GridRow)return void h(Object(i.c)(e,n,t,g));if(!Object(o.md)(_,e,n)&&(h(function(e,t,n,r){const i=Object(a.w)(n);return{type:f,payload:r,meta:{pageId:e,controlName:t,contextKey:i}}}(e,t,n,g)),g)){const r=Object(o.u)(_,{id:e,controlName:t},n),a=Object(o.l)(r,t);h(Object(p.a)(e,n,a))}if(Object(s.a)()){const r=m(),a={id:e,controlName:t},i=null===(y=null==b?void 0:b.TraceManager)||void 0===y?void 0:y.getTracer(`${u.u}${u.t}`),s=Object(o.v)(_,a,n),p=Object(o.v)(r,a,n),f=Object(d.a)(_,e);f.push({name:"controlName",value:t}),f.push({name:"controlLabel",value:Object(o.y)(r,a,n)}),f.push({name:"disabled state before change",value:null==s?void 0:s.toString()}),f.push({name:"intended disabled state",value:null==g?void 0:g.toString()}),f.push({name:"disabled state after change",value:null==p?void 0:p.toString()}),f.push({name:"callstack",value:new c.a(new Error).getStackTrace()}),null==i||i.warn(u.B,[{name:l.l,value:u.t+".disabled"},{name:u.t,value:JSON.stringify(f)}])}}}}},ZrDD:function(e,t,n){"use strict";var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.PerformanceEvent=void 0;var a=function(){},i=function(){function e(e,t,n){this._eventName=e,this._zone=t,this._getTransports=n}return e.prototype.getName=function(){return this._eventName},e.prototype.getZone=function(){return this._zone},e.prototype.getTransports=function(){return this._getTransports()},e.prototype.createMarker=function(e,t){var n,a;void 0===e&&(e=null),void 0===t&&(t=null);var i=null!=t?t:performance.now();try{for(var o=r(this._getTransports()),s=o.next();!s.done;s=o.next()){var c=s.value;try{c.writeMarker(this,i,e)}catch(e){setTimeout((function(){throw e}),0)}}}catch(e){n={error:e}}finally{try{s&&!s.done&&(a=o.return)&&a.call(o)}finally{if(n)throw n.error}}},e.prototype.createRetroactiveStopwatch=function(e,t,n){var a,i;void 0===n&&(n=null);try{for(var o=r(this._getTransports()),s=o.next();!s.done;s=o.next()){var c=s.value;try{c.writeRetroactiveTimespan(this,e,t,n)}catch(e){setTimeout((function(){throw e}),0)}}}catch(e){a={error:e}}finally{try{s&&!s.done&&(i=o.return)&&i.call(o)}finally{if(a)throw a.error}}},e.prototype.startStopwatch=function(e){var t,n,i=performance.now(),o=this._getTransports();if(0===o.length)return a;var s=[];try{for(var c=r(o),l=c.next();!l.done;l=c.next()){var u=l.value;try{s.push(u.startTimespan(this,i,e))}catch(e){setTimeout((function(){throw e}),0)}}}catch(e){t={error:e}}finally{try{l&&!l.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}return this._endStopwatch.bind(this,s,i)},e.prototype._endStopwatch=function(e,t,n){var a,i,o=performance.now()-t;try{for(var s=r(e),c=s.next();!c.done;c=s.next()){var l=c.value;try{l(o,n)}catch(e){setTimeout((function(){throw e}),0)}}}catch(e){a={error:e}}finally{try{c&&!c.done&&(i=s.return)&&i.call(s)}finally{if(a)throw a.error}}},e}();t.PerformanceEvent=i},ZuxC:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return l})),n.d(t,"a",(function(){return s}));var r=n("MktZ"),a=n("f/sd"),i=n("D+Bz"),o=n("Tz6o");const s="LastNavigatedPageKey",c="page.initialize";function l(e,t,n=!1,l=null,u=i.b.Other){return{type:"page.initialize.async",execute({dispatch:d},p){const f=e.getId(),g=e.getName();d(Object(r.b)(f,a.a.Loading)),d(function(e,t,n,r,a=i.b.Other){return{type:c,payload:{input:e,__pageName:t,isDialogStatus:r},meta:{pageId:n,source:a}}}(t,g,f,n,u)),d(Object(o.e)(t,f));const h=d(e.getInitializationAction(l));return h.then(()=>{if(g&&t){const e=p.Router.createUrlForPage(g,t),n=e&&new URL(e,window.location.origin);if(n&&function(e,t){if("EditForm"===e&&t.searchParams.get("id"))return!0;if("Dashboard"===e||"Search"===e||"WebResource"===e||"EntityList"===e||"Control"===e)return!0;return!1}(g,n)){const t=n.searchParams.get("appid"),r=p.DataSource;if(t&&r){const n={};n[t]=e,r.saveSessionState(s,n,!0)}}}else p.TraceManager.getTracer("Router.Actions.InitializePage").error("Failed to save URL",[{name:"pageName",value:g},{name:"input.pageType",value:t?t.pageType||"undefined pageType":"null input"}])},()=>{}),h.then(()=>({status:0,pageId:f}))}}}},ZvAk:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.pending=0]="pending",e[e.active=1]="active",e[e.done=2]="done"}(r||(r={}))},Zvo8:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e,t,n,r,a=2){let i="";if(n){const e=new Date;e.setTime(e.getTime()+24*n*60*60*1e3),i="; expires="+e.toUTCString()}else i="";let o=e+"="+t+i+"; path=/";r&&(o+=" ;domain="+r),0===a?o+=" ;SameSite=None;Secure":2===a?o+=" ;SameSite=Lax":1===a&&(o+=" ;SameSite=Strict"),document.cookie=o}function a(e){const t=e+"=",n=document.cookie.split(";");for(let e=0;e<n.length;e++){let r=n[e];for(;" "===r.charAt(0);)r=r.substring(1,r.length);if(0===r.indexOf(t))return r.substring(t.length,r.length)}return null}function i(e,t){r(e,"",-1,t)}function o(){let e=!1;try{e=navigator.cookieEnabled}catch(e){}if(!0===e)try{if(document.cookie)return!0;const e="testcookie";r(e,"1",10,null,0);const t=!!a(e);return i(e),t}catch(e){}return!1}n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return o}))},"Zz+h":function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"d",(function(){return c})),n.d(t,"c",(function(){return l})),n.d(t,"e",(function(){return u}));var r=n("arV0"),a=n("y60j"),i=n("hIjC");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function o(e,t){const n=Object(r.j)(e,t.id),o=Object(i.a)(e,n.uniqueName);return o&&o.formId?Object(a.h)(e,o.formId):null}function s(e,t){const{dialogOptions:n}=Object(r.j)(e,t.id);return n}function c(e,t){const{uniqueName:n}=Object(r.j)(e,t.id);return n}function l(e,t){return"inline"===u(e,t)}function u(e,t){const n=Object(r.j)(e,t);return n&&n.dialogOptions&&n.dialogOptions.windowPosition?n.dialogOptions.windowPosition:n&&"inlinedialog"===n.pageType?"inline":"center"}},a1q1:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("NMtn");class a{constructor(e){this._resultsList=null,Object(r.d)(e,"entities"),this._resultsList=e}get_resultsList(){return this._resultsList}static createFromEntities(e){return new a(e)}}},a475:function(e,t,n){"use strict";n.d(t,"a",(function(){return De}));var r,a,i=n("Yb4o"),o=n("kToj");!function(e){e[e.created=0]="created",e[e.submitted=1]="submitted",e[e.executing=2]="executing",e[e.completed=3]="completed"}(r||(r={})),function(e){e[e.submitted=1]="submitted",e[e.executing=2]="executing",e[e.succeeded=3]="succeeded",e[e.failed=4]="failed"}(a||(a={}));var s,c=n("XjOj"),l=n("Div0"),u=n("8uvO");!function(e){e[e.synchronous=0]="synchronous",e[e.asynchronous=1]="asynchronous"}(s||(s={}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class d extends i.a{constructor(){super(),this._name=null,this._baseName=null,this._completionCallback=null,this._error=null,this._serialNumber=p++,this._baseName=Object.getType(this).getName(),this._name=this._baseName+" "+this.get_serialNumber()}get_name(){return this._name}get_baseName(){return this._baseName}get_serialNumber(){return this._serialNumber}get_state(){return this.getValue(d.stateProperty)}_set_state(e){return this.setValue(d.stateProperty,e),e}get_isUsingExclusiveChannel(){return!1}get_instrumentationContext(){return""}internalSubmit(){Object(o.a)(!this.get_state(),this.get_name()+" can only be submitted once."),this._set_state(r.submitted),this.onSubmitted()}internalExecute(e){Object(o.a)(this.get_state()===r.submitted,this.get_name()+" can only be executed once.");let t=null,n=s.synchronous;try{this._completionCallback=e,this._set_state(r.executing),this.instrument(a.executing),n=this.onExecute()}catch(e){throw Object(c.d)(l.a.actions,"Action execution failed. Error: {0}",e),t=e,e}finally{n===s.synchronous&&this.get_state()!==r.completed&&this.complete(t)}}complete(e){Object(o.a)(this.get_state()===r.submitted&&!!e||this.get_state()===r.executing,this.get_name()+" cannot call complete in the current state.");try{try{this._error=e,this._ReportSuccessOrFailure()}finally{this._ReportCompletion()}}finally{this.instrument(e?a.failed:a.succeeded),this._InvokeCompletionCallback()}}onSubmitted(){}onError(){}instrument(e){Object(c.g)(l.a.actions,"Excuting action,name={0},id={1},state={2},context={3}",this.get_baseName(),this.get_serialNumber(),e,this.get_instrumentationContext())}_InvokeCompletionCallback(){try{this._completionCallback&&this._completionCallback()}finally{this._completionCallback=()=>{!function(e){throw Error.invalidOperation(e+" cannot try to call the completion callback twice.")}(this.get_name())}}}_ReportSuccessOrFailure(){this._error&&this._ReportFailure()}_ReportFailure(){try{this.onError()}finally{}}_ReportCompletion(){try{this._set_state(r.completed)}finally{}}}d.stateProperty=new u.a("State",r,d,0);let p=0;var f=n("/Ypj"),g=n("NMtn");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class h extends d{constructor(e,t,n,r,a,i,o){super(),Object(g.c)(e,"key"),Object(g.c)(t,"namespaceName"),Object(g.c)(n,"version"),Object(g.c)(r,"method"),Object(g.b)(a,"args"),Object(g.b)(i,"callbacks"),this._key=e,this._namespaceName=t,this._version=n,this._method=r,this._args=a,this._callbacks=i,this._callContext=o}get_key(){return this._key}get_namespaceName(){return this._namespaceName}get_version(){return this._version}get_method(){return this._method}get_args(){return this._args}get_callbacks(){return this._callbacks}get_callContext(){return this._callContext||(this._callContext=new f.a(null,null)),this._callContext}onExecute(){return this.call(),s.synchronous}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class m{constructor(e,t,n){this.source=t,this.action=n,this.traceComponent=e}}var b=n("Hswk");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let y=null;class _{constructor(e,t){this._quantaSize=0,this._timeoutInterval=0,this._callbackHandle=0,this._taskQueue=[],this._quantaSize=e,this._timeoutInterval=t}queueTask(e,t,n,r){const a=new m(e,t,n);this._taskQueue.push(a),r||this._SetQuantaCallback()}_RunForQuanta(){this._callbackHandle=0;const e=new Date;let t=0;for(;this._taskQueue.length>0&&t<this._quantaSize;){v(this._taskQueue.shift()),t=(new Date).getTime()-e.getTime()}this._taskQueue.length>0&&this._SetQuantaCallback()}_SetQuantaCallback(){this._callbackHandle||(this._timeoutInterval<0?this._RunForQuanta():this._callbackHandle=_.queueTimerCallback(l.a.taskRunner,"_RunForQuanta",Object(b.a)(this,this._RunForQuanta,"RunForQuanta"),this._timeoutInterval))}static get_instance(){return y||(y=new _(50,0)),y}static queueTimerCallback(e,t,n,r){return window.setTimeout(()=>{v(new m(e,t,n))},r)}}function v(e){const t=new Date;!function(e,t,n){try{n()}catch(n){Object(c.e)(e,n,"Exception context: {0}",t)}}(e.traceComponent,e.source,e.action);const n=new Date;"_RunForQuanta"!==e.source&&n.getTime()-t.getTime()>50&&Object(c.f)(e.traceComponent,"Task {0} took too long ({1}ms) to complete",e.source,n.getTime()-t.getTime())}let S=0;class O{constructor(){this._hasScheduledAction=!1,this._isExecutingActionOnExclusiveChannel=!1,this._name=null,this._actionSubmitted=null,this._queue=[],this._serialNumber=S++,this._name="Action Manager "+this._serialNumber}get_name(){return this._name}submit(e){const t=e instanceof h?e:null;this.logNativeCallActionPerfData(t,"ActionManager.Submit.Start"),this.logNativeCallActionPerfData(t,"ActionManager.InternalSubmit.Start"),e.internalSubmit(),this.logNativeCallActionPerfData(t,"ActionManager.InternalSubmit.End"),this._actionSubmitted&&(this.logNativeCallActionPerfData(t,"ActionManager.actionSubmitted.Start"),this._actionSubmitted(e),this.logNativeCallActionPerfData(t,"ActionManager.actionSubmitted.End")),this.logNativeCallActionPerfData(t,"ActionManager.ScheduleNextAction.Start"),Object(c.f)(l.a.actions,"{0} enqueued {1}",this.get_name(),e.get_name()),this._queue.push(e),this._ScheduleNextAction(),this.logNativeCallActionPerfData(t,"ActionManager.ScheduleNextAction.End"),this.logNativeCallActionPerfData(t,"ActionManager.Submit.End")}logNativeCallActionPerfData(e,t){}executeAction(e,t){Object(c.f)(l.a.actions,"{0} is executing {1}",this.get_name(),e.get_name()),this._ExecuteActionInternal(e,t)}_ExecuteActionInternal(e,t){e.internalExecute(()=>{Object(c.f)(l.a.actions,"{0} finished executing {1}",this.get_name(),e.get_name()),this._isExecutingActionOnExclusiveChannel=!1,t&&this._ScheduleNextAction()})}_ScheduleNextAction(){if(this._hasScheduledAction||this._isExecutingActionOnExclusiveChannel)return;if(!this._queue.length)return;const e=this._queue[0];e.get_isUsingExclusiveChannel()?(Object(c.h)(l.a.actions,"{0} scheduled {1} with timeout 0",this.get_name(),e.get_name()),this._hasScheduledAction||_.queueTimerCallback(l.a.actions,"Process"+e.get_name(),Object(b.a)(this,this._ProcessNextAction,"ProcessNextAction"),0)):(Object(c.h)(l.a.actions,"{0} scheduled {1} into action queue",this.get_name(),e.get_name()),this._hasScheduledAction||_.get_instance().queueTask(l.a.actions,"Process"+e.get_name(),Object(b.a)(this,this._ProcessNextAction,"ProcessNextAction"))),this._hasScheduledAction=!0}_ProcessNextAction(){this._hasScheduledAction=!1,Object(o.a)(this._queue.length>0,this.get_name()+" must not try to process an empty queue.");const e=this._queue.shift();this._isExecutingActionOnExclusiveChannel=e.get_isUsingExclusiveChannel(),this.executeAction(e,!0)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function C(e,t){let n=null;try{n=JSON.parse(e)}catch(r){Object(c.h)(l.a.framework,"JSON parse failed: {0}",r.message);const a=function(e){const t=new RegExp("[­-؀-؄܏឴឵‌-‏\u2028- ⁠-⁯\ufeff￰-￿]","g");if(t.test(e))return e.replace(t,E);return e}(e);if(a!==e){Object(c.h)(l.a.framework,"JSON response needed to be encoded due to unescaped Unicode content. Will try to parse again."),e=a;try{n=JSON.parse(e),r=null}catch(e){Object(c.f)(l.a.framework,"JSON parse failed again. Error: {0}.",e.message)}}r&&t(r)}return n}function E(e){const t=e.charCodeAt(0).toString(16);return"\\u0000".substring(0,6-t.length)+t}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class I{constructor(e,t){this.deviceStateJson=null,this.nativeCallKey=null,this.nativeCallKey=e,this.deviceStateJson=t}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class w extends h{call(){this.get_callContext().get_callId()&&""!==this.get_callContext().get_callId()&&(this.get_args()[f.a.get_dispatcherCallIdName()]=this.get_callContext().get_callId()),PALJavaScriptInterface.callMethod(this.get_key(),this.get_namespaceName(),this.get_method(),this.get_version(),JSON.stringify(this.get_args()),JSON.stringify(this.get_callbacks()))}}var j=n("504W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class P extends h{constructor(e,t,n,r,a,i,o){super(e,t,n,r,a,i,o),Object(j.b)(o.get_callId())||(this.get_args()[f.a.get_dispatcherCallIdName()]=o.get_callId())}get_isUsingExclusiveChannel(){return!0}get_instrumentationContext(){return this.get_method()}call(){const e=this.generateUrl();this.loadUrl(e)}generateUrl(){return String.format("http://pal/?k={0}&n={1}&m={2}&v={3}&a={4}&c={5}",encodeURIComponent(this.get_key()),encodeURIComponent(this.get_namespaceName()),encodeURIComponent(this.get_method()),encodeURIComponent(this.get_version()),encodeURIComponent(JSON.stringify(this.get_args())),encodeURIComponent(JSON.stringify(this.get_callbacks())))}loadUrl(e){window.location.href=e}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const T={};class N extends P{constructor(e,t,n,r,a,i,o){super(e,t,n,r,{},i,o),Object(g.b)(a,"args"),this._pullArgsId=this.get_name(),Object(j.b)(o.get_callId())||(a[f.a.get_dispatcherCallIdName()]=o.get_callId()),T[this._pullArgsId]=a}get_pullArgsId(){return this._pullArgsId}generateUrl(){const e=super.generateUrl();return String.format("{0}&p={1}",e,encodeURIComponent(this._pullArgsId))}static pullArgs(e){const t=T[e];if(!t){const t=String.format("Couldn't find pull args matching id '{0}'",e);throw Object(c.d)(l.a.PAL,t),Error.invalidOperation(t)}return delete T[e],t}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class A extends h{call(){this.get_callContext().get_callId()&&""!==this.get_callContext().get_callId()&&(this.get_args()[f.a.get_dispatcherCallIdName()]=this.get_callContext().get_callId()),window.webkit.messageHandlers.PALNativeBridge.postMessage({key:this.get_key(),namespace:this.get_namespaceName(),method:this.get_method(),version:this.get_version(),args:this.get_args(),callbacks:this.get_callbacks()})}}var R=n("fMBw"),D=n.n(R);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class x{constructor(){this.webViewMessageEventHandler=null,this.webViewMessageEventHandler=Object(b.a)(this,this.webViewMessageHandler,"webViewMessageHandler"),window.addEventListener("message",Object(b.a)(this,this.postMessageHandler,"postMessageHandler"),!1)}_createPerfMarker(e,t,n){let r=e;const a="deviceEvent"===e,i=Object(j.b)(t[0])?"":t[0],o=Object(j.b)(t[1])?"":t[1];if(a&&"Application"===i&&"ReportPerformance"===o)return;"deviceReady"!==e&&(Object(j.b)(i)||(r+="."+i),Object(j.b)(o)||"deviceCallback"===e||(r+="."+o));const s=(new Date).getTime()-n;D.a.createEvent("PostMessage."+r,"PAL").createRetroactiveStopwatch(window.performance.now()-s,s)}webViewMessageHandler(e){this.messageHandlerInternal(e)}postMessageHandler(e){const t=e,n=t.origin.toLowerCase();let r="";if(!Object(j.a)(window.location)){const e=window.location.port;r=window.location.protocol+"//"+window.location.hostname,Object(j.a)(e)||""===e||(r+=":"+e)}if("ms-appx://microsoft.microsoftdynamicscrm"!==n&&"ms-appx://microsoft.microsoftdynamicscrmforwindows8.1"!==n&&"ms-appx://microsoft.microsoftdynamicscrmforwindows10"!==n&&n!==r.toLowerCase())return;if("object"==typeof t.data)return;if(!isNaN(t.data))return;const a=t.data;if(Object(j.a)(a)||""===a||a.startsWith("ms.rx.schedule"))return;try{if("PALNativeBridge"!==JSON.parse(a).target)return}catch(e){return}e.stopImmediatePropagation(),this.messageHandlerInternal(a)}messageHandlerInternal(e){let t;try{t=JSON.parse(e)}catch(e){return void Object(c.e)(l.a.PAL,e,"Failed to parse message")}if("PALNativeBridge"!==t.target)return;const n=t.functionName,r=t.functionArguments,a=t.timestamp;switch(Object(j.a)(a)||this._createPerfMarker(n,Object(j.a)(r)?[]:r,a),n){case"prepareStates":return void PALNativeBridge.prepareStates(e);case"clientReady":return void PALNativeBridge.clientReady(e);case"deviceReady":return void De.get_Instance().deviceReady(r[0],r[1]);case"deviceActive":return void De.get_Instance().deviceActive();case"deviceInactive":return void De.get_Instance().deviceInactive();case"deviceResume":return void De.get_Instance().deviceResume();case"devicePause":return void De.get_Instance().devicePause();case"deviceCallback":return void De.get_Instance().deviceCallback(r[0],r[1],r[2]);case"deviceUnregisterCallback":return void De.get_Instance().deviceUnregisterCallback(r[0]);case"deviceEvent":return void De.get_Instance().deviceEvent(r[0],r[1],r[2]);case"devicePullArgs":return void De.get_Instance().devicePullArgs(r[0]);case"deviceSearch":return void De.get_Instance().deviceSearch(r[0]);case"voiceCommand":return void De.get_Instance().voiceCommand(r[0]);case"tileActivation":return void De.get_Instance().tileActivation(r[0]);case"appLink":return void De.get_Instance().appLink(r[0]);default:Object(c.d)(l.a.PAL,"Attempting to call unknown method: {0}",n)}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class M extends h{constructor(e,t,n,r,a,i,s,c,l){super(e,t,n,r,a,i,l),Object(o.a)(!Object(j.b)(s),"applicationName should not be NullOrEmpty"),Object(o.a)(!Object(j.b)(c),"protocol should not be NullOrEmpty"),this._applicationName=s,this._protocol=c}call(){this.get_callContext().get_callId()&&""!==this.get_callContext().get_callId()&&(this.get_args()[f.a.get_dispatcherCallIdName()]=this.get_callContext().get_callId());const e=this.generateMessage();this.callInternal(e)}callInternal(e){const t=this._protocol+"//"+this._applicationName.toLowerCase(),n=e+"&t="+Date.now();window.parent.postMessage(n,t)}generateMessage(){return String.format("http://pal/?k={0}&n={1}&m={2}&v={3}&a={4}&c={5}",encodeURIComponent(this.get_key()),encodeURIComponent(this.get_namespaceName()),encodeURIComponent(this.get_method()),encodeURIComponent(this.get_version()),encodeURIComponent(JSON.stringify(this.get_args())),encodeURIComponent(JSON.stringify(this.get_callbacks())))}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class F extends M{callInternal(e){window.self.appSharedObject.sendMessageToApp(e)}generateMessage(){return{k:this.get_key(),n:this.get_namespaceName(),m:this.get_method(),v:this.get_version(),a:JSON.stringify(this.get_args()),c:JSON.stringify(this.get_callbacks())}}}var k,L=n("EbwQ"),B=n("sJUk"),U=n("ZhaJ");!function(e){e[e.unexpecteD_ERROR=-1]="unexpecteD_ERROR",e[e.invaliD_CREDENTIALS=1]="invaliD_CREDENTIALS",e[e.invaliD_ENDPOINT=2]="invaliD_ENDPOINT",e[e.credentialS_REJECTED_BY_SERVER=3]="credentialS_REJECTED_BY_SERVER",e[e.unexpecteD_SERVER_RESPONSE=4]="unexpecteD_SERVER_RESPONSE",e[e.missinG_REQUIRED_COOKIES=5]="missinG_REQUIRED_COOKIES",e[e.connectioN_INIT_FAILED=6]="connectioN_INIT_FAILED",e[e.unknowN_AUTH_METHOD=7]="unknowN_AUTH_METHOD",e[e.unsupporteD_AUTH_METHOD=8]="unsupporteD_AUTH_METHOD"}(k||(k={}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class V extends U.a{constructor(e){super(),this._onAuthenticateFailure=null,this._onAuthenticateFailure=e}_get_Error(){return this.getValue(V.errorProperty)}call(){this._onAuthenticateFailure(this._get_Error())}}V.errorProperty=new u.a("error",k,V);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class z extends U.a{constructor(e){super(),this._onAuthenticateSuccess=null,this._onAuthenticateSuccess=e}call(){this._onAuthenticateSuccess()}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class q extends B.a{constructor(e,t){super(),this.setValue(q.onAuthenticateSuccessProperty,new z(e)),this.setValue(q.onAuthenticateFailureProperty,new V(t))}get_methodName(){return"authenticate"}}q.onAuthenticateSuccessProperty=new u.a("onAuthenticateSuccess",z,q),q.onAuthenticateFailureProperty=new u.a("onAuthenticateFailure",V,q);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class H extends U.a{constructor(e){super(),this._onBeginSecureSessionForResourceResponse=null,this._onBeginSecureSessionForResourceResponse=e}get_beginSecureSessionResponseCode(){return this.getValue(H.BeginSecureSessionForResourceResponseCode)}get_beginSecureSessionExpiresOn(){return this.getValue(H.BeginSecureSessionForResourceExpiresOn)}call(){this._onBeginSecureSessionForResourceResponse(this.get_beginSecureSessionResponseCode(),this.get_beginSecureSessionExpiresOn())}}H.BeginSecureSessionForResourceResponseCode=new u.a("responseCode",Number,H),H.BeginSecureSessionForResourceExpiresOn=new u.a("expiresOn",String,H);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class W extends B.a{constructor(e,t,n,r){super(),this.setValue(W.resource,e),this.setValue(W.cookieName,t),this.setValue(W.cookieDomain,n),this.setValue(W.onBeginSecureSessionForResourceResponse,new H(r))}get_methodName(){return"beginSecureSessionForResource"}}W.resource=new u.a("resource",String,W),W.cookieName=new u.a("cookieName",String,W),W.cookieDomain=new u.a("cookieDomain",String,W),W.onBeginSecureSessionForResourceResponse=new u.a("onBeginSecureSessionForResourceResponse",H,W);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class G extends B.a{get_methodName(){return"reconfigure"}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class K extends U.a{constructor(e){super(),this._onRequestSecurityTokenResponse=null,this._onRequestSecurityTokenResponse=e}get_requestSecurityTokenResponse(){return this.getValue(K.RequestSecurityTokenResponseProperty)}get_status(){return this.getValue(K.StatusProperty)}get_errorCode(){return this.getValue(K.ErrorCodeProperty)}get_errorDescription(){return this.getValue(K.ErrorDescriptionProperty)}get_isAutoSignInResponse(){return this.getValue(K.IsAutoSignInProperty)}call(){this._onRequestSecurityTokenResponse(this.get_requestSecurityTokenResponse(),this.get_status(),this.get_errorCode(),this.get_errorDescription(),this.get_isAutoSignInResponse())}}K.RequestSecurityTokenResponseProperty=new u.a("requestSecurityTokenResponse",String,K),K.StatusProperty=new u.a("status",Number,K),K.ErrorCodeProperty=new u.a("errorCode",String,K),K.ErrorDescriptionProperty=new u.a("errorDescription",String,K),K.IsAutoSignInProperty=new u.a("isAutoSignIn",Boolean,K);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class Q extends B.a{constructor(e,t){super(),this.setValue(Q.ExpiredTokenProperty,e),this.setValue(Q.onRequestSecurityTokenResponseProperty,new K(t))}get_methodName(){return"requestSecurityToken"}}Q.ExpiredTokenProperty=new u.a("refreshToken",Boolean,Q),Q.onRequestSecurityTokenResponseProperty=new u.a("onRequestSecurityTokenResponse",K,Q);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class X extends B.a{constructor(e,t){super(),this.setValue(X.justification,e),this.setValue(X.triggeredBy,t)}get_methodName(){return"signOutV2"}}X.justification=new u.a("justification",String,X),X.triggeredBy=new u.a("triggeredBy",String,X);class Y extends B.a{get_methodName(){return"signOut"}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class J extends B.a{constructor(e,t,n,r){super(),this.setValue(J.resource,e),this.setValue(J.cookieName,t),this.setValue(J.cookieDomain,n),this.setValue(J.onbeginSecureSessionForResourceWithPromptResponse,new H(r))}get_methodName(){return"beginSecureSessionForResourceWithPrompt"}}J.resource=new u.a("resource",String,J),J.cookieName=new u.a("cookieName",String,J),J.cookieDomain=new u.a("cookieDomain",String,J),J.onbeginSecureSessionForResourceWithPromptResponse=new u.a("onBeginSecureSessionForResourceResponse",H,J);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class $ extends B.a{constructor(e,t,n,r,a){super(),this.setValue($.options,e),this.setValue($.origin,t),this.setValue($.cookieName,n),this.setValue($.cookieDomain,r),this.setValue($.onBeginSecureSessionForAuthFlowResponse,new H(a))}get_methodName(){return"beginSecureSessionForAuthFlow"}}$.options=new u.a("options",Object,$),$.origin=new u.a("origin",String,$),$.cookieName=new u.a("cookieName",String,$),$.cookieDomain=new u.a("cookieDomain",String,$),$.onBeginSecureSessionForAuthFlowResponse=new u.a("onBeginSecureSessionForAuthFlowResponse",H,$);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class Z extends i.a{get_isSignOutV2Available(){return this.getValue(Z.isSignOutV2AvailableProperty)}}Z.isSignOutV2AvailableProperty=new u.a("IsSignOutV2Available",Boolean,Z,!1);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class ee extends L.a{constructor(e){super(e),this._accountState=new Z}get_namespaceName(){return"Account"}get_accountState(){return this.get_state()}get_state(){return this._accountState}authenticate(e,t){Object(g.b)(e,"onAuthenticateSuccess"),Object(g.b)(t,"onAuthenticateFailure");const n=new q(e,t);this.callNativeMethod(this.get_version().get_currentVersion(),n)}requestSecurityToken(e,t){const n=new Q(e,t);this.callNativeMethod(this.get_version().get_currentVersion(),n)}beginSecureSessionForAuthFlow(e,t,n,r,a){const i=new $(e,t,n,r,a);this.callNativeMethod(this.get_version().get_currentVersion(),i)}beginSecureSessionForResource(e,t,n,r){const a=new W(e,t,n,r);this.callNativeMethod(this.get_version().get_currentVersion(),a)}beginSecureSessionForResourceWithPrompt(e,t,n,r){const a=new J(e,t,n,r);this.callNativeMethod(this.get_version().get_currentVersion(),a)}signOut(e,t){if(this.get_accountState().get_isSignOutV2Available()){const n=new X(e,t?"user":"system");this.callNativeMethod(this.get_version().get_currentVersion(),n)}else{const e=new Y;this.callNativeMethod(this.get_version().get_currentVersion(),e)}}reconfigure(){const e=new G;this.callNativeMethod(this.get_version().get_currentVersion(),e)}}var te=n("pNM1");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let ne=te.a.Info;function re(e){return ne=e,e}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class ae extends B.a{constructor(e,t){super(),this.setValue(ae.DeviceErrorActionProperty,e),this.setValue(ae.ErrorDetailsProperty,t)}get_methodName(){return"clientBootError"}}ae.DeviceErrorActionProperty=new u.a("deviceErrorAction",Number,ae),ae.ErrorDetailsProperty=new u.a("errorDetails",Object,ae);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class ie extends B.a{constructor(e,t){super()}get_methodName(){return"clientInitialized"}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class oe extends U.a{constructor(e){super(),this._onFloatResult=null,this._onFloatResult=e}_get_Value(){return this.getValue(oe.ValueProperty)}call(){this._onFloatResult(this._get_Value())}}oe.ValueProperty=new u.a("value",Number,oe);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class se extends B.a{constructor(e){super(),this.setValue(se.OnFloatResultProperty,new oe(e))}get_methodName(){return"getMemoryUsage"}}se.OnFloatResultProperty=new u.a("onFloatResult",oe,se);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class ce extends B.a{constructor(e,t){super(),this.setValue(ce.ValueNameProperty,e),this.setValue(ce.ValueProperty,t)}get_methodName(){return"setBoolValue"}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var le;ce.ValueNameProperty=new u.a("valueName",String,ce),ce.ValueProperty=new u.a("value",Boolean,ce),function(e){e[e.compatible=0]="compatible",e[e.needsToUpgrade=1]="needsToUpgrade",e[e.needsToDowngrade=2]="needsToDowngrade"}(le||(le={}));var ue=n("H4dV");class de extends i.a{get_currentVersion(){return de.get_currentVersionName()}get_hasSupportedVersion(){return this.get_version1()}get_versionCompatibility(){return!this.get_hasSupportedVersion()||!this.get_hasSupportedCallMechanism()||this.get_hasLatestPALVersion()&&de.get_currentRevision()>this.get_revision()||this.get_iOSUpdateRevision()!==de.iOSUpdateRevisionProperty.get_defaultValue()&&de.get_serveriOSUpdateRevision()>this.get_iOSUpdateRevision()||this.get_win8UpdateRevision()!==de.win8UpdateRevisionProperty.get_defaultValue()&&de.get_serverWin8UpdateRevision()>this.get_win8UpdateRevision()||this.get_androidUpdateRevision()!==de.androidUpdateRevisionProperty.get_defaultValue()&&de.get_serverAndroidUpdateRevision()>this.get_androidUpdateRevision()?le.needsToUpgrade:this.get_hasLatestPALVersion()&&de.get_currentRevision()<this.get_revision()?le.needsToDowngrade:0}get_nativeRevision(){return ue.a.getInstance().get_IsIOS()?this.get_iOSUpdateRevision():ue.a.getInstance().get_IsAndroid()?this.get_androidUpdateRevision():this.get_win8UpdateRevision()}get_hasLatestPALVersion(){const e=this.getValue(de.lastPALVersion);return this.get_currentVersion()===e}get_version1(){return this.getValue(de.version1Property)}get_hasSupportedCallMechanism(){return this.get_windowLocation()||this.get_webKitMessageHandler()||this.get_javaInterface()||this.get_pushToPull()||this.get_messageInterface()||this.get_objectShareInterface()}get_windowLocation(){return this.getValue(de.windowLocationProperty)}get_webKitMessageHandler(){return this.getValue(de.webKitMessageHandlerProperty)}get_pushToPull(){return this.getValue(de.pushToPullProperty)}get_javaInterface(){return this.getValue(de.javaInterfaceProperty)}get_messageInterface(){return this.getValue(de.messageInterfaceProperty)}get_messageProtocol(){return this.getValue(de.messageProtocolProperty)}get_objectShareInterface(){return this.getValue(de.objectShareInterfaceProperty)}get_osVersion(){return this.getValue(de.osVersionProperty)}get_language(){return this.getValue(de.languageProperty)}get_version(){return this.getValue(de.versionProperty)}get_build(){return this.getValue(de.buildProperty)}get_revision(){return this.getValue(de.revisionProperty)}get_iOSUpdateRevision(){return this.getValue(de.iOSUpdateRevisionProperty)}get_win8UpdateRevision(){return this.getValue(de.win8UpdateRevisionProperty)}get_androidUpdateRevision(){return this.getValue(de.androidUpdateRevisionProperty)}get_installationId(){return this.getValue(de.installationIdProperty)}get_telemetryEventsParams(){return this.getValue(de.telemetryEventsParamsProperty)}get_applicationName(){return this.getValue(de.applicationNameProperty)}get_diagnosticsEnabled(){return this.getValue(de.diagnosticsEnabledProperty)}get_dispatcherPerfLoggingEnabled(){return this.getValue(de.dispatcherPerfLoggingEnabledProperty)}get_loggingEnabled(){return this.getValue(de.loggingEnabledProperty)}get_hasReconfigureSupport(){return this.getValue(de.hasReconfigureSupportProperty)}get_hasOneNoteSupport(){return this.getValue(de.hasOneNoteSupportProperty)}get_hasOfficeDocumentsSupport(){return this.getValue(de.hasOfficeDocumentsSupportProperty)}get_shimStartTime(){return this.getValue(de.shimStartTimeProperty)}get_ShimPerformanceMetrics(){return this.getValue(de.shimPerformanceMetricsProperty)}get_isManaged(){return this.getValue(de.isManagedProperty)}get_nativeFCBContext(){return this.getValue(de.nativeFCBContextProperty)}get_hasMashupSupport(){return this.getValue(de.hasMashupSupportProperty)}get_hasMashupDiagnoticsSupport(){return this.getValue(de.hasMashupDiagnosticsSupportProperty)}get_shouldSkipTransfer(){return this.getValue(de.shouldSkipTransferProperty)}get_hideCommandBar(){return this.getValue(de.hideCommandBarProperty)}get_proxyMetadataSyncEventsToShim(){return this.getValue(de.proxyMetadataSyncEventsToShimProperty)}get_appId(){return this.getValue(de.appIdProperty)}get_hasAppList(){return this.getValue(de.hasAppListProperty)}get_canNavigateBackToHost(){return this.getValue(de.canNavigateBackToHostProperty)}static get_currentVersionName(){return pe}static set_currentVersionName(e){return pe=e,e}static get_currentRevision(){return fe}static set_currentRevision(e){return fe=e,e}static get_serveriOSUpdateRevision(){return ge}static set_serveriOSUpdateRevision(e){return ge=e,e}static get_serverWin8UpdateRevision(){return he}static set_serverWin8UpdateRevision(e){return he=e,e}static get_serverAndroidUpdateRevision(){return me}static set_serverAndroidUpdateRevision(e){return me=e,e}}de.version1Name="Version1",de.revisionSupported=1,de.iOSUpdateRevisionSupported=1,de.win8UpdateRevisionSupported=1,de.androidUpdateRevisionSupported=1,de.version1Property=new u.a(de.version1Name,Boolean,de,!1),de.lastPALVersion=new u.a("LastPALVersion",String,de,""),de.windowLocationProperty=new u.a("WindowLocation",Boolean,de,!1),de.webKitMessageHandlerProperty=new u.a("WebKitMessageHandler",Boolean,de,!1),de.pushToPullProperty=new u.a("PushToPull",Boolean,de,!1),de.javaInterfaceProperty=new u.a("JavaInterface",Boolean,de,!1),de.messageInterfaceProperty=new u.a("MessageInterface",Boolean,de,!1),de.messageProtocolProperty=new u.a("MessageProtocol",String,de,"ms-appx:"),de.objectShareInterfaceProperty=new u.a("ObjectShareInterface",Boolean,de,!1),de.osVersionProperty=new u.a("OSVersion",String,de,""),de.languageProperty=new u.a("Language",String,de,""),de.versionProperty=new u.a("Version",String,de,""),de.buildProperty=new u.a("Build",Number,de,-1),de.revisionProperty=new u.a("Revision",Number,de,-1),de.iOSUpdateRevisionProperty=new u.a("iOSUpdateRevision",Number,de,-1),de.win8UpdateRevisionProperty=new u.a("Win8UpdateRevision",Number,de,-1),de.androidUpdateRevisionProperty=new u.a("AndroidUpdateRevision",Number,de,-1),de.installationIdProperty=new u.a("InstallationId",String,de,""),de.telemetryEventsParamsProperty=new u.a("TelemetryEventsParams",Object,de,null),de.applicationNameProperty=new u.a("ApplicationName",String,de,"microsoft.microsoftdynamicscrm"),de.diagnosticsEnabledProperty=new u.a("DiagnosticsEnabled",Boolean,de,!1),de.dispatcherPerfLoggingEnabledProperty=new u.a("DispatcherPerfLoggingEnabled",Boolean,de,!1),de.loggingEnabledProperty=new u.a("loggingEnabled",Boolean,de,!1),de.hasReconfigureSupportProperty=new u.a("HasReconfigureSupport",Boolean,de,!1),de.hasOneNoteSupportProperty=new u.a("HasOneNoteSupport",Boolean,de,!1),de.hasOfficeDocumentsSupportProperty=new u.a("HasOfficeDocumentsSupport",Boolean,de,!1),de.shimStartTimeProperty=new u.a("ShimStartTime",Number,de,-1),de.shimPerformanceMetricsProperty=new u.a("ShimPerformanceMetrics",Array,de,null),de.isManagedProperty=new u.a("IsManaged",Boolean,de,!1),de.hasMashupSupportProperty=new u.a("HasMashupSupport",Boolean,de,!1),de.hasMashupDiagnosticsSupportProperty=new u.a("HasMashupDiagnosticsSupport",Boolean,de,!1),de.nativeFCBContextProperty=new u.a("NativeFCBContext",Object,de,null),de.shouldSkipTransferProperty=new u.a("ShouldSkipTransfer",Boolean,de,!1),de.hideCommandBarProperty=new u.a("HideCommandBar",Boolean,de,!1),de.proxyMetadataSyncEventsToShimProperty=new u.a("ProxyMetadataSyncEventsToShim",Boolean,de,!1),de.appIdProperty=new u.a("AppId",String,de,null),de.pageUrlProperty=new u.a("PageUrl",String,de,null),de.shouldRestoreStateProperty=new u.a("ShouldRestoreState",Boolean,de,null),de.hasAppListProperty=new u.a("HasAppList",Boolean,de,!1),de.shouldReloadOnNavigate=new u.a("ShouldReloadOnNavigate",Boolean,de,!1),de.canNavigateBackToHostProperty=new u.a("CanNavigateBackToHost",Boolean,de,!1);let pe=de.version1Name,fe=de.revisionSupported,ge=de.iOSUpdateRevisionSupported,he=de.win8UpdateRevisionSupported,me=de.androidUpdateRevisionSupported;var be=n("FkJY");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class ye extends B.a{constructor(e,t,n){super(),this.setValue(ye.ClientStateProperty,e)}get_methodName(){return"clientReady"}}ye.ClientStateProperty=new u.a("clientState",be.a,ye);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class _e extends B.a{constructor(e,t,n){super(),this.setValue(_e.PageUrlProperty,e)}get_methodName(){return"reloadWebView"}}_e.PageUrlProperty=new u.a("pageUrl",String,_e);class ve extends L.a{constructor(e,t){super(e),this._clientReadyBridge=null,this._applicationState=new de,this._clientReadyBridge=t,this.get_applicationState().apcl(de.diagnosticsEnabledProperty.get_name(),()=>{Object(c.f)(l.a.PAL,"DiagnosticsEnabled property has changed to: {0}",this.get_applicationState().get_diagnosticsEnabled()),this.get_applicationState().get_diagnosticsEnabled()?Object(c.l)(re(te.a.Verbose)):Object(c.l)(re(te.a.Info)),Object(c.k)(!!Object(c.c)()),Object(c.f)(l.a.PAL,"TraceLevel set to: {0}, PALWebScriptLogProcessor.PALWebscriptLogLevel set to {1}",Object(c.c)(),ne)})}add_reportPerformance(e){this.addCustomEventHandler("ReportPerformance",e)}remove_reportPerformance(e){this.removeCustomEventHandler("ReportPerformance",e)}get_namespaceName(){return"Application"}get_applicationState(){return this.get_state()}get_state(){return this._applicationState}clientInitialized(e,t){const n=new ie(e,t);this.callNativeMethod(this.get_version().get_currentVersion(),n),e()}clientBootError(e,t){const n=new ae(e,t);this.callNativeMethod(this.get_version().get_currentVersion(),n)}setBoolValue(e,t){Object(g.c)(e,"argumentName");const n=new ce(e,t);this.callNativeMethod(this.get_version().get_currentVersion(),n)}getMemoryUsage(e){Object(g.b)(e,"onFloatResult");const t=new se(e);this.callNativeMethod(this.get_version().get_currentVersion(),t)}clientReady(e,t,n){const r=new ye(e,t,n);this._callClientReadyNativeMethod(this.get_version().get_currentVersion(),r),t()}reloadWebView(e,t,n){const r=new _e(e,t,n);this.callNativeMethod(this.get_version().get_currentVersion(),r)}_callClientReadyNativeMethod(e,t){if(!this.get_IsAvailable())throw Error.invalidOperation("Trying to call native method "+t.get_methodName()+" before dispatcher is available");this._clientReadyBridge.callClientReadyNativeMethod(this,e,t)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class Se extends B.a{constructor(e){super(),this.setValue(Se.MessageProperty,e)}get_methodName(){return"postMessage"}}Se.MessageProperty=new u.a("message",String,Se);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class Oe extends i.a{get_deviceModel(){return this.getValue(Oe.deviceModelProperty)}get_deviceMemoryRestricted(){return(ue.a.getInstance().get_IsAndroidPhone()||ue.a.getInstance().get_isIPhone()||ue.a.getInstance().get_isWinPhone())&&this.getValue(Oe.deviceMemoryRestrictedProperty)}get_CameraAvailable(){return this.getValue(Oe.cameraAvailableProperty)}get_MicrophoneAvailable(){return this.getValue(Oe.microphoneAvailableProperty)}get_GeolocationAvailable(){return this.getValue(Oe.geolocationAvailableProperty)}get_IsNarratorActive(){return this.getValue(Oe.isNarratorActiveProperty)}get_deviceMaxBatchSize(){return this.getValue(Oe.deviceMaxBatchSizeProperty)}get_connectionAvailable(){return this.getValue(Oe.connectionAvailableProperty)}get_formFactor(){return this.getValue(Oe.formFactorProperty)}}Oe.deviceModelProperty=new u.a("DeviceModel",String,Oe,""),Oe.deviceMemoryRestrictedProperty=new u.a("DeviceMemoryRestricted",Boolean,Oe,!1),Oe.deviceMaxBatchSizeProperty=new u.a("DeviceMaxBatchSize",Number,Oe,25),Oe.connectionAvailableProperty=new u.a("ConnectionAvailable",Boolean,Oe,!0),Oe.formFactorProperty=new u.a("FormFactor",String,Oe,"slate"),Oe.isNarratorActiveProperty=new u.a("IsNarratorActive",Boolean,Oe,!1),Oe.cameraAvailableProperty=new u.a("CameraAvailable",Boolean,Oe,!1),Oe.microphoneAvailableProperty=new u.a("MicrophoneAvailable",Boolean,Oe,!1),Oe.geolocationAvailableProperty=new u.a("GeolocationAvailable",Boolean,Oe,!1);class Ce extends L.a{constructor(e){super(e),this._deviceState=new Oe}add_onStatusBarPressed(e){this.addCustomEventHandler("OnStatusBarPressed",e)}remove_onStatusBarPressed(e){this.removeCustomEventHandler("OnStatusBarPressed",e)}get_namespaceName(){return"Device"}get_DeviceState(){return this.get_state()}postMessage(e){const t=new Se(e);this.callNativeMethod(this.get_version().get_currentVersion(),t)}get_state(){return this._deviceState}}var Ee=n("RYFF");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class Ie extends U.a{constructor(e){super(),this._onResults=null,this._onResults=e}_get_Result(){return this.getValue(Ie.ResultProperty)}call(){this._onResults&&this._onResults(this._get_Result())}}Ie.ResultProperty=new u.a("result",String,Ie);class we extends B.a{constructor(e,t,n,r,a){super(),this.setValue(we.OnSuccessCallbackProperty,new Ie(e)),this.setValue(we.OnFailureCallbackProperty,new Ie(t)),this.setValue(we.ServiceName,n),this.setValue(we.ActionName,r),this.setValue(we.Args,a)}get_methodName(){return"exec"}}we.OnSuccessCallbackProperty=new u.a("onSuccess",Ie,we),we.OnFailureCallbackProperty=new u.a("onFailure",Ie,we),we.ServiceName=new u.a("serviceName",String,we),we.ActionName=new u.a("actionName",String,we),we.Args=new u.a("args",Array,we);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class je extends B.a{get_methodName(){return"onSyncComplete"}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class Pe extends B.a{get_methodName(){return"onSyncError"}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class Te extends B.a{get_methodName(){return"onSyncStart"}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class Ne extends i.a{get_filesDownloadStatus(){const e=this.get_filesDownloadStatusJson();return null==e||""===e?null:JSON.parse(e)}get_filesDownloadStatusJson(){return this.getValue(Ne.FilesDownloadStatusProperty)}get_dataSyncStatusJson(){return this.getValue(Ne.DataSyncStatusProperty)}get_dataSyncStatus(){const e=this.get_dataSyncStatusJson();return e?JSON.parse(e):null}get_metadataSyncStatusJson(){return this.getValue(Ne.MetadataSyncStatusProperty)}get_metadataSyncStatus(){const e=this.get_metadataSyncStatusJson();return e?JSON.parse(e):null}testHook_set_filesDownloadStatusJson(e){return this.setValue(Ne.FilesDownloadStatusProperty,e)}}Ne.FilesDownloadStatusProperty=new u.a("FilesDownloadStatus",String,Ne,""),Ne.DataSyncStatusProperty=new u.a("DataSyncStatus",String,Ne,""),Ne.MetadataSyncStatusProperty=new u.a("MetadataSyncStatus",String,Ne,"");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class Ae extends L.a{constructor(e){super(e),this._cordovaState=new Ne}get_namespaceName(){return"Cordova"}get_CordovaState(){return this.get_state()}get_state(){return this._cordovaState}exec(e,t,n,r,a){Object(g.c)(n,"serviceName"),Object(g.c)(r,"actionName");const i=new we(e,t,n,r,a);this.callNativeMethod(this.get_version().get_currentVersion(),i)}onSyncStart(){const e=new Te;this.callNativeMethod(this.get_version().get_currentVersion(),e)}onSyncComplete(){const e=new je;this.callNativeMethod(this.get_version().get_currentVersion(),e)}onSyncError(){const e=new Pe;this.callNativeMethod(this.get_version().get_currentVersion(),e)}}let Re=null;class De extends i.a{constructor(e){super(),this._ready=!1,this._paused=!1,this._key=null,this._actionSubmitter=null,this._preReadyCalls=null,this._accountDispatcher=null,this._multimediaDispatcher=null,this._arViewerDispatcher=null,this._feedbackDispatcher=null,this._applicationDispatcher=null,this._deviceDispatcher=null,this._navigationDispatcher=null,this._networkDispatcher=null,this._documentDispatcher=null,this._sqlDispatcher=null,this._dataDispatcher=null,this._windows8Message=null,this._cordovaDispatcher=null,this._externalContextDispatcher=null,this._cordovaMediaDispatcher=null,this._callbacks={},this.dispatchers={},this._actionSubmitter=e,this._preReadyCalls=new Array(0),this._deviceDispatcherState=null,this.set_application(new ve(this,this)),this._windows8Message=new x,this.registerDispatchers()}async add_onReadyOrNow(e){this.get_isReady()?await e():this.addCustomEventHandler("OnReady",e)}remove_onReadyOrNow(e){this.removeCustomEventHandler("OnReady",e)}add_onActive(e){this.addCustomEventHandler("OnActive",e)}remove_onActive(e){this.removeCustomEventHandler("OnActive",e)}add_onInactive(e){this.addCustomEventHandler("OnInactive",e)}remove_onInactive(e){this.removeCustomEventHandler("OnInactive",e)}add_onAppLink(e){this.addCustomEventHandler("OnAppLink",e)}remove_onAppLink(e){this.removeCustomEventHandler("OnAppLink",e)}add_onShellApiRequest(e){this.addCustomEventHandler("OnShellApiRequest",e)}get_isReady(){return this._ready}set_isReady(e){return this._ready=e,e}get_isPaused(){return this._paused}set_isPaused(e){return this._paused=e,e}get_key(){return this._key}_set_key(e){return this._key=e,e}get_version(){return this.get_application().get_applicationState()}get_callMechanism(){return this.get_application().get_applicationState()}get_account(){return this._accountDispatcher}set_account(e){return this._accountDispatcher=e,e}async get_multimedia(){if(!this._multimediaDispatcher){const e=new((await n.e(140).then(n.bind(null,"XLOu"))).MultimediaDispatcher)(this);this.registerAndSetStateOnDispatcher(e),this._multimediaDispatcher=e}return this._multimediaDispatcher}set_multimedia(e){return this._multimediaDispatcher=e,e}async get_ARViewer(){if(!this._arViewerDispatcher){const e=new((await n.e(98).then(n.bind(null,"jzNO"))).ARViewerDispatcher)(this);this.registerAndSetStateOnDispatcher(e),this._arViewerDispatcher=e}return this._arViewerDispatcher}set_ARViewer(e){return this._arViewerDispatcher=e,e}async get_FeedbackManager(){if(!this._feedbackDispatcher){const e=new((await n.e(119).then(n.bind(null,"lztb"))).FeedbackDispatcher)(this);this.registerAndSetStateOnDispatcher(e),this._feedbackDispatcher=e}return this._feedbackDispatcher}set_FeedbackManager(e){return this._feedbackDispatcher=e,e}get_application(){return this._applicationDispatcher}set_application(e){return this._applicationDispatcher=e,e}get_device(){return this._deviceDispatcher}set_device(e){return this._deviceDispatcher=e,e}async get_navigation(){if(!this._navigationDispatcher){const e=new((await n.e(144).then(n.bind(null,"lBpF"))).NavigationDispatcher)(this);this.registerAndSetStateOnDispatcher(e),this._navigationDispatcher=e}return this._navigationDispatcher}set_navigation(e){return this._navigationDispatcher=e,e}async get_network(){if(!this._networkDispatcher){const e=new((await n.e(145).then(n.bind(null,"N39u"))).NetworkDispatcher)(this);this.registerAndSetStateOnDispatcher(e),this._networkDispatcher=e}return this._networkDispatcher}set_network(e){return this._networkDispatcher=e,e}async get_document(){if(!this._documentDispatcher){const e=new((await n.e(113).then(n.bind(null,"4ell"))).DocumentDispatcher)(this);this.registerAndSetStateOnDispatcher(e),this._documentDispatcher=e}return this._documentDispatcher}set_document(e){return this._documentDispatcher=e,e}get_sql(){return this._sqlDispatcher}set_sql(e){return this._sqlDispatcher=e,e}async get_data(){if(!this._dataDispatcher){const e=new((await n.e(111).then(n.bind(null,"B5IK"))).DataDispatcher)(this);this.registerAndSetStateOnDispatcher(e),this._dataDispatcher=e}return this._dataDispatcher}set_data(e){return this._dataDispatcher=e,e}get_Cordova(){return this._cordovaDispatcher}set_Cordova(e){return this._cordovaDispatcher=e,e}async get_externalContext(){if(!this._externalContextDispatcher){const e=new((await n.e(118).then(n.bind(null,"U9za"))).ExternalContextDispatcher)(this);this.registerAndSetStateOnDispatcher(e),this._externalContextDispatcher=e}return this._externalContextDispatcher}set_externalContext(e){return this._externalContextDispatcher=e,e}async get_CordovaMedia(){if(!this._cordovaMediaDispatcher){const e=new((await n.e(106).then(n.bind(null,"XkVh"))).CordovaMediaDispatcher)(this);this.registerAndSetStateOnDispatcher(e),this._cordovaMediaDispatcher=e}return this._cordovaMediaDispatcher}set_CordovaMedia(e){return this._cordovaMediaDispatcher=e,e}deviceReady(e,t){Object(g.c)(e,"key"),Object(g.c)(t,"jsonStates"),Object(c.f)(l.a.PAL,"Ready, key {0} states {1}",e,t);const n=JSON.parse(t);if("object"!=typeof n){const e="Invalid JSON for ready states, "+t;throw Object(c.d)(l.a.PAL,e),Error.invalidOperation(e)}localStorage.setItem("DeviceReadyCachedState",JSON.stringify(new I(e,t))),this.deviceReadyInternal(e,n)}deviceActive(){this.verifyReady(),Object(c.f)(l.a.PAL,"Device going to Active state"),this.deviceActiveInternal()}deviceInactive(){this.verifyReady(),Object(c.i)(l.a.PAL,"Device going to Inactive state"),this.handleCustomEvent("OnInactive")}deviceResume(){this.verifyReady(),Object(c.f)(l.a.PAL,"Resume"),this.deviceResumeInternal()}devicePause(){this.verifyReady(),Object(c.i)(l.a.PAL,"Device going to Pause state"),this.set_isPaused(!0),this.handleCustomEvent("OnPause")}deviceCallback(e,t,n){Object(g.c)(e,"callbackID"),Object(g.c)(t,"jsonArgs"),this.verifyReady(),Object(c.h)(l.a.PAL,"Callback, Callback Id: {0}, Unregister: {1}",e,n),Object(c.h)(l.a.PAL,"Callback, JSONArgs: {0}",t);const r=C(t,null);if("object"==typeof r)return this.deviceCallbackInternal(e,r,n),"";const a="Invalid JSON for callback args, "+t;throw Object(c.i)(l.a.PAL,a),Error.invalidOperation(a)}deviceUnregisterCallback(e){if(Object(g.c)(e,"callbackID"),this.verifyReady(),Object(c.h)(l.a.PAL,"Unregister, {0}",e),!(e in this._callbacks)){const t="Attempting to unregister unknown callback, "+e;throw Object(c.i)(l.a.PAL,t),Error.invalidOperation(t)}delete this._callbacks[e]}deviceEvent(e,t,n){if(Object(g.c)(e,"namespaceName"),Object(g.c)(t,"name"),Object(g.c)(n,"value"),this.verifyReady(),Object(c.f)(l.a.PAL,"Event, {0}, {1}, {2}",e,t,n),!(e in this.dispatchers)){const t="Attempting to raise event in unknown namespace, "+e;throw Object(c.i)(l.a.PAL,t),Error.invalidOperation(t)}const r=this.dispatchers[e],a=JSON.parse(n);if(!(a instanceof Array)){const e="Event value is not an Array";throw Object(c.i)(l.a.PAL,e),Error.invalidOperation(e)}const i=a;if(1!==i.length){const e="Event value array should contain exactly one element. Actual length = "+i.length;throw Object(c.i)(l.a.PAL,e),Error.invalidOperation(e)}const o=i[0];if(void 0===o){const e="Invalid or missing event value";throw Object(c.i)(l.a.PAL,e),Error.invalidOperation(e)}r.changeState(t,o)||r.raiseEvent(t,o)}devicePullArgs(e){Object(g.c)(e,"pullArgsId"),Object(c.h)(l.a.PAL,"DevicePullArgs, {0}",e);const t=N.pullArgs(e);return JSON.stringify(t)}deviceSearch(e){Object(g.c)(e,"searchText"),Object(c.h)(l.a.PAL,"DeviceSearch, {0}",e),this.handleCustomEvent("OnSearch",e)}voiceCommand(e){Object(g.c)(e,"command"),Object(c.h)(l.a.PAL,"VoiceCommand, {0}",e),this.handleCustomEvent("OnVoiceCommand",e)}tileActivation(e){Object(g.c)(e,"urlArguments"),Object(c.h)(l.a.PAL,"Tile Activation, {0}",e),this.handleCustomEvent("OnTileActivation",e)}appLink(e){Object(g.b)(e,"urlArguments"),Object(c.h)(l.a.PAL,"App Link, {0}",e),this.handleCustomEvent("OnAppLink",e)}shellApiRequest(e){Object(g.c)(e,"jsonArguments should not be null or empty"),Object(c.h)(l.a.PAL,"Shell API request, {0}",e),this.handleCustomEvent("OnShellApiRequest",e)}callNativeMethod(e,t,n){Object(c.h)(l.a.PAL,"Calling native method, {0}, {1}",t,n.get_methodName());const r=this.createNativeCall(e,t,n);r&&(this.get_isReady()?this._actionSubmitter.submit(r):this._preReadyCalls.push(r))}callClientReadyNativeMethod(e,t,n){Object(c.h)(l.a.PAL,"Calling native method, {0}, {1}",t,n.get_methodName());const r=this.createNativeCall(e,t,n);this._actionSubmitter.submit(r)}registerNativeCallback(e,t){Object(g.b)(e,"call"),Object(g.b)(t,"callback");const n=e.get_methodName()+t.get_callbackID();return Object(c.h)(l.a.PAL,"Registering callback, {0}",n),this._callbacks[n]=t,n}forceDeviceReady(){const e=localStorage.getItem("DeviceReadyCachedState");if(Object(j.a)(e))Object(c.d)(l.a.PAL,"ForceDeviceReady: No cached device state data found to force DeviceReady");else{const t=JSON.parse(e);Object(j.a)(t.deviceStateJson)?Object(c.d)(l.a.PAL,"ForceDeviceReady: DeviceStateJsonNull. deviceReadyCachedStateString: "+e):this.deviceReadyInternal(t.nativeCallKey,JSON.parse(t.deviceStateJson))}}registerAndSetStateOnDispatcher(e){this.registerDispatcher(e);const t=this.getDeviceReadyCachedState()[e.get_namespaceName()];if(t instanceof Object)e.setState(t);else{const e="Invalid state JSON or device not ready yet."+t;Object(c.i)(l.a.PAL,e)}}getDeviceReadyCachedState(){if(this._deviceDispatcherState)return this._deviceDispatcherState;const e=localStorage.getItem("DeviceReadyCachedState");if(Object(j.a)(e))Object(c.i)(l.a.PAL,"getDeviceReadyCachedState: No cached device state data found.");else{const t=JSON.parse(e);if(!Object(j.a)(t.deviceStateJson))return this._deviceDispatcherState=JSON.parse(t.deviceStateJson),this._deviceDispatcherState;Object(c.i)(l.a.PAL,"getDeviceReadyCachedState: DeviceStateJsonNull. deviceReadyCachedStateString: "+e)}return{}}registerDispatchers(){this.registerDispatcher(this.get_application()),this.set_account(new ee(this)),this.registerDispatcher(this.get_account()),this.set_device(new Ce(this)),this.registerDispatcher(this.get_device()),this.set_sql(new Ee.a(this)),this.registerDispatcher(this.get_sql()),this.set_Cordova(new Ae(this)),this.registerDispatcher(this.get_Cordova())}registerDispatcher(e){this.dispatchers[e.get_namespaceName()]=e}deviceReadyInternal(e,t){if(this.get_isReady()){const e="Ready may happen only once";Object(c.i)(l.a.PAL,e)}if(this._set_key(e),this._setDispatcherStates(t),!this.get_version().get_hasSupportedVersion()){const e="No supported version available";throw Object(c.d)(l.a.PAL,e),Error.invalidOperation(e)}if(!this.get_callMechanism().get_hasSupportedCallMechanism()){const e="No native call mechanism available";throw Object(c.d)(l.a.PAL,e),Error.invalidOperation(e)}if(this.set_isReady(!0),this.handleCustomEvent("OnReady"),this.deviceActiveInternal(),this.deviceResumeInternal(),this._preReadyCalls){Object(c.f)(l.a.PAL,"Ready with {0} pre-ready calls",l.a.PAL,this._preReadyCalls.length);for(const e of this._preReadyCalls)this._actionSubmitter.submit(e);this._preReadyCalls=null}}verifyReady(){if(!this.get_isReady())throw Error.invalidOperation("Trying to call native method before device is ready")}deviceActiveInternal(){this.handleCustomEvent("OnActive"),Object(c.f)(l.a.PAL,"Active")}deviceResumeInternal(){this.set_isPaused(!1),this.handleCustomEvent("OnResume"),Object(c.i)(l.a.PAL,"Device going to Resume state")}deviceCallbackInternal(e,t,n){if(!(e in this._callbacks)){const t="Attempting to call unknown callback, "+e;throw Object(c.i)(l.a.PAL,t),Error.invalidOperation(t)}{const r=this._callbacks[e];n&&this.deviceUnregisterCallback(e),Object(c.h)(l.a.PAL,"Calling callback, {0}",e),r.callback(t)}}createNativeCall(e,t,n){const r=n.get_methodName(),a=n.getValues(),i=n.getCallbacks(this);return this.get_callMechanism().get_webKitMessageHandler()?new A(this.get_key(),e.get_namespaceName(),t,r,a,i,n.get_callContext()):this.get_callMechanism().get_pushToPull()&&n.get_hasBigArgs()?new N(this.get_key(),e.get_namespaceName(),t,r,a,i,n.get_callContext()):this.get_callMechanism().get_windowLocation()?new P(this.get_key(),e.get_namespaceName(),t,r,a,i,n.get_callContext()):this.get_callMechanism().get_javaInterface()?new w(this.get_key(),e.get_namespaceName(),t,r,a,i,n.get_callContext()):this.get_callMechanism().get_objectShareInterface()?new F(this.get_key(),e.get_namespaceName(),t,r,a,i,De.get_Instance().get_application().get_applicationState().get_applicationName(),this.get_callMechanism().get_messageProtocol(),n.get_callContext()):this.get_callMechanism().get_messageInterface()?new M(this.get_key(),e.get_namespaceName(),t,r,a,i,De.get_Instance().get_application().get_applicationState().get_applicationName(),this.get_callMechanism().get_messageProtocol(),n.get_callContext()):(Object(c.i)(l.a.PAL,"No native call mechanism available"),null)}_setDispatcherStates(e){for(const t in e){const n={key:t,value:e[t]};if(n.key in this.dispatchers){const e=this.dispatchers[n.key];if(Object(c.f)(l.a.PAL,"Setting state, {0}",n.key),!(n.value instanceof Object)){const e="Invalid state JSON, "+n.value;throw Object(c.i)(l.a.PAL,e),Error.invalidOperation(e)}e.setState(n.value)}else Object(c.i)(l.a.PAL,"Unknown dispatcher state, {0}",n.key)}}willDispatcherBeAvailableFromDevice(e){return e in this.getDeviceReadyCachedState()}static get_Instance(){return Re||(Re=new De(new O)),Re}static set_Instance(e){return Re=e,e}static initializeDOMBridge(){window.PALNativeBridge=De.get_Instance(),window.PALWebViewMessageHandler=De.get_Instance()._windows8Message.webViewMessageEventHandler}}De.palIncompatibleCookieName="PALIncompatible",De.initializeDOMBridge()},a6P5:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("SAYH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e){if(!e)return;const t={};return decodeURIComponent(e).split(",").forEach(e=>{const n=e.match(/^(\w+)=(.*)$/);if(n){const e=n[1],r=n[2];switch(e){case"endpoint":t.endpoint=function(e){try{return new URL(e),e}catch(e){return}}(r);break;case"antiCSRFToken":t.antiCSRFToken=i(r);break;case"correlationId":t.correlationId=i(r);break;case"hostName":t.hostName=function(e){if(/[\w]/.test(e))return e;return}(r);break;case"environmentId":t.environmentId=r;break;case"appModuleName":t.appModuleName=r}}else;}),t}function i(e){if(r.a.validate(e))return e}},a72m:function(e,t,n){"use strict";n.d(t,"a",(function(){return h})),n.d(t,"b",(function(){return b})),n.d(t,"c",(function(){return _}));var r=n("K7RF"),a=n("Uv1Y"),i=n("d0w6"),o=n("SAYH"),s=n("eXjw"),c=n("KBcj"),l=n("g0tL"),u=n("504W"),d=n("2XFH"),p=n("sZ+8"),f=n("iJGp"),g=n("/oKV");function h(e,t,n,l,d,h=!1,b=!1,y=!1){return{type:"view.retrieve.async",execute({dispatch:_,getState:v},S,O){const C=[{name:"entityTypeName",value:e},{name:"viewQueryType",value:t},{name:"viewType",value:n},{name:"viewId",value:o.a.toString(l)},{name:"isViewSelectorItemsNeeded",value:d},{name:"allowCheckForUserView",value:h}];let E=!0;n||(n=i.b.savedview,E=!1);let I=g.a.LocalAndRemote;const w=v();let j=l,P=f.a.OnDemandWithContext,T=!1;if((Object(c.f)(w,e,t)||null==t||void 0!==d&&!d)&&(P=f.a.OnDemandWithoutContext),o.a.isNullOrEmpty(j)&&(j=Object(c.a)(w,e,t)),o.a.isNullOrEmpty(j)){if(n===i.b.userview)return b||S.EventManager.ReportComponentSuccess("RetrieveView.retrieveView",C),Promise.reject(new a.a("Cannot fetch a user view without specifying id"))}else{const t=Object(c.j)(w,j),a=Object(c.c)(w,j);if(t===s.a.Initialized&&((Object(r.e)(w,a.OverallVersionNumber)||n===i.b.userview&&Object(r.f)(w,a.OverallUserVersionNumber))&&!Object(p.n)(w,e)||y?(I=g.a.Remote,P=f.a.OnDemandWithContext,T=!0):Object(p.n)(w,e)&&!a.offlineSqlQuery&&(T=!0),!T))return b||(C.push({name:"isRefresh",value:T}),S.EventManager.ReportComponentSuccess("RetrieveView.retrieveView",C)),Promise.resolve(j)}return C.push({name:"retrievalStrategy",value:I},{name:"isRefresh",value:T}),_(m(e,j,n,t,P,I,T,C,b)).then(r=>{if(Object(u.a)(l)){const r=Object(c.a)(v(),e,t);return Object(c.j)(v(),r)===s.a.Initialized?(b||(C.push({name:"defaultViewId",value:o.a.toString(r)}),S.EventManager.ReportComponentSuccess("RetrieveView.retrieveView",C)),r):_(m(e,r,n,t,P,I,T,C,b)).then(e=>e)}if(h&&!E&&!o.a.isNullOrEmpty(j)&&!o.a.equals(j,r)){return _(m(e,j,i.b.userview,t,P,I,T,C,b)).then(e=>o.a.isNullOrEmpty(e)?r:e,a.b)}return r}).catch(e=>{if(!o.a.isNullOrEmpty(j))return _(function(e){const t=o.a.isNullOrEmpty(e)?{}:{views:{[o.a.toString(e)]:{initialized:s.a.Error}}};return{type:r.a,payload:t}}(j)),Object(a.b)(e)})}}}function m(e,t,n,u,p,f,g,h,m=!1){return{type:"view.default.descriptor.async",execute({dispatch:b,getState:y},_){let v=!0;return o.a.isNullOrEmpty(t)||(v=!1,g||b(function(e){const t=o.a.isNullOrEmpty(e)?null:{views:{[o.a.toString(e)]:{initialized:s.a.Initializing}}};return{type:r.a,payload:t}}(t))),b(Object(r.b)(i.b[n],i.a[u],e,o.a.toLegacyGuid(t),v,p,null,null,[],l.b.View,f)).then(e=>{var n;if(e&&e.queryId)return e.queryId;const r=[];for(const t in e.views)h.push({name:"offlineSqlQuery_viewId_"+t,value:!!(null===(n=e.views[t])||void 0===n?void 0:n.offlineSqlQuery)}),r.push(t);let i=null;return o.a.isNullOrEmpty(t)?i=r.length>0?new o.a(r[0]):null:e.views.hasOwnProperty(o.a.toString(t))&&(i=t),m||_.EventManager.ReportComponentSuccess("RetrieveView._retrieveViewDescriptor",h),b(function(e){return{type:"view.dependencies.update.async",execute({dispatch:t,getState:n},r){const i="name",s=[];for(const t in e)s.push(e[t]+":"+i);if(s.length>0){return t(Object(d.a)(s)).then(()=>{const r=[],a=n();for(const t in e){const n=e[t],s=Object(c.c)(a,new o.a(n));s&&n&&a.metadata.labels&&a.metadata.labels[n]&&a.metadata.labels[n][i]&&(s.title=a.metadata.labels[n][i],r.push(s))}r.length>0&&t(function(e){const t={};for(const n in e)t[o.a.toString(e[n].viewId)]=e[n];return{type:"view.descriptors.update",payload:{views:t}}}(r))},a.b)}return Promise.resolve()}}}(r)).then(()=>i,a.b)},a.b)}}}function b(e,t,n=!1){return{type:"view.selectors.async",execute({dispatch:a,getState:o},s){const l=o();let u=g.a.LocalAndRemote;const d=f.a.OnDemandWithoutContext,p=Object(c.h)(l,e,t);return n||p&&t===i.a.MAIN_APPLICATION_VIEW&&Object(r.f)(l,p)?(u=g.a.Remote,a(y(e,"viewselector",t,d,u))):Object(c.f)(l,e,t)?Promise.resolve(l.metadata):a(y(e,"viewselector",t,d,u))}}}function y(e,t,n,o,s){return{type:"view.selectors.descriptor.async",execute:({dispatch:c},l)=>c(Object(r.b)(t,i.a[n],e,null,!0,o,null,null,[],null,s)).catch(a.b)}}function _(e,t,n=!1){return{type:"view.selectors.async",execute({dispatch:n,getState:o},s){const c=g.a.Remote,l=f.a.OnDemandWithoutContext;return n(function(e,t,n,o,s){return{type:"view.selectors.descriptors.async",execute({dispatch:c},l){let u="HASDISTINCTNEEDED";return n.forEach(e=>{u+=":"+i.a[e]}),c(Object(r.b)(t,u,e,null,!0,o,null,null,[],null,s)).catch(a.b)}}}(e,"viewselector",t,l,c))}}}},a8hT:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(){return Promise.all([n.e(35),n.e(4),n.e(5),n.e(9),n.e(8),n.e(40),n.e(34),n.e(45),n.e(44),n.e(47),n.e(135)]).then(n.bind(null,"CsVN"))}function a(){return Promise.all([n.e(4),n.e(9),n.e(34),n.e(150)]).then(n.bind(null,"jRuK"))}function i(){return n.e(90).then(n.bind(null,"EXJz"))}function o(){return n.e(34).then(n.bind(null,"bcN9"))}function s(){return Promise.all([n.e(35),n.e(181),n.e(4),n.e(5),n.e(40),n.e(45),n.e(53),n.e(74)]).then(n.bind(null,"vUNb"))}function c(){return Promise.resolve().then(n.bind(null,"dDbD"))}function l(){return n.e(77).then(n.bind(null,"d+rv"))}function u(){return n.e(35).then(n.t.bind(null,"+wex",7))}function d(){return n.e(85).then(n.bind(null,"beko"))}function p(){return n.e(86).then(n.bind(null,"vnfk"))}n.d(t,"b",(function(){return r})),n.d(t,"f",(function(){return a})),n.d(t,"j",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"g",(function(){return c})),n.d(t,"e",(function(){return l})),n.d(t,"a",(function(){return u})),n.d(t,"h",(function(){return d})),n.d(t,"i",(function(){return p}))},aF0N:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return s}));var r=n("Lyxw"),a=n("3/02");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function i(e,t,n){if(!(e&&e.metadata&&e.metadata.homePageBusinessLogics&&t&&n))return null;const r=e.metadata.homePageBusinessLogics[t];return r?r[n]:null}function o(e){return Object(r.f)(e,a.Cb)}function s(e){return Object(r.f)(e,a.Bb)}},aKhm:function(e,t,n){"use strict";n.d(t,"d",(function(){return s})),n.d(t,"g",(function(){return c})),n.d(t,"h",(function(){return l})),n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return p})),n.d(t,"e",(function(){return f})),n.d(t,"f",(function(){return g})),n.d(t,"i",(function(){return h}));var r=n("SAYH"),a=n("n3bs"),i=n("E5IU"),o=n("+cdD");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function s(e,t){var n;const s=Object(i.o)(e),c=null===(n=e.tours)||void 0===n?void 0:n.fullyRenderContexts,l=Object(o.d)(s,a.a.DASHBOARD,r.a.toString(t));return c.includes(l)}function c(e){var t;return null===(t=e.tours)||void 0===t?void 0:t.containerDimensions}function l(e){var t;return null===(t=e.tours)||void 0===t?void 0:t.tourMetadata}function u(e,t){var n,r;return null===(r=null===(n=l(e))||void 0===n?void 0:n[t])||void 0===r?void 0:r.status}function d(e,t){var n,r;return null===(r=null===(n=null==e?void 0:e.tours)||void 0===n?void 0:n.tourMetadata[t])||void 0===r?void 0:r.initializationActions}function p(e){const t=function(e){var t,n;if(null===(t=null==e?void 0:e.tours)||void 0===t?void 0:t.tourMetadata)return Object.keys(null===(n=null==e?void 0:e.tours)||void 0===n?void 0:n.tourMetadata).find(t=>{var n;return null===(n=null==e?void 0:e.tours)||void 0===n?void 0:n.tourMetadata[t].isActive})}(e);return null==e?void 0:e.tours.tours.find(e=>e.msdyn_tourid===t)}function f(e,t){var n,r,a;return null!==(a=null===(r=null===(n=null==e?void 0:e.tours)||void 0===n?void 0:n.tourMetadata[t])||void 0===r?void 0:r.isActive)&&void 0!==a&&a}function g(e,t){var n,r;return null===(r=null===(n=null==e?void 0:e.tours)||void 0===n?void 0:n.tourMetadata[t])||void 0===r?void 0:r.nextStepIndex}function h(e){var t;return null===(t=e.tours)||void 0===t?void 0:t.tours}},aMuN:function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"f",(function(){return c}));const r="metadata.rootCanvasApp.set",a="metadata.rootCanvasApp.dataComponent.update",i="metadata.rootCanvasApp.functionalComponent.update";function o(e){return{type:r,payload:e}}function s(e){return{type:a,payload:{dataComponentApp:e}}}function c(e){return{type:i,payload:{functionalComponentApp:e}}}},aOBz:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("OwbH"),a=n("504W"),i=n("uTcl");class o extends r.a{constructor(e,t,n,r){super([e]),this._borderValue=null,this._borderType=0,this._operatorType=0,this._borderValue=t,this._borderType=n,this._operatorType=r}get_borderValue(){return this._borderValue}get_borderType(){return this._borderType}get_operatorType(){return this._operatorType}testCondition(e){let t=!1;return Object(a.a)(e)||(t=this.get_operatorType()?this.get_borderType()===i.a.closed?e<=this.get_borderValue():e<this.get_borderValue():this.get_borderType()===i.a.closed?e>=this.get_borderValue():e>this.get_borderValue()),t}}},aOIB:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("Uv1Y");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t,n){return{type:"offline.information.save.async",async execute({dispatch:a,getState:i},o){const s=o.DataSource;return await function(e,t,n,a){return e.saveOfflineInformation(t,n,a).nativePromise().catch(r.b)}(s,e,t,n)}}}},aOhN:function(e,t,n){"use strict";n.d(t,"c",(function(){return f})),n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return h}));var r=n("JC5U"),a=n("xPbo"),i=n("ZuxC"),o=n("gQ5I"),s=n("pF61"),c=n("QHx/"),l=n("VgPQ"),u=n("oT5e"),d=n("llMO"),p=n("ruPX");function f(e,t){return{type:"router.canNavigateBack",execute:({dispatch:n,getState:r},a)=>a.Router.shouldNavigate(void 0,!1,t,e).then(a=>a?(e||(e=Object(c.a)(r(),t||Object(s.c)(r()))),n(Object(o.d)(e.targetBrowsingContext)).then(e=>e)):a)}}function g(e){return{type:"router.forceNavigateBack",execute(t,n){var o;const{dispatch:f,getState:g}=t,h=n.Router;if(!e){const t=Object(s.c)(g());e=Object(c.a)(g(),t)}const m=[{name:"Options",value:Object(p.d)(e)}];if(Object(s.o)(g())){const t=null===(o=Object(u.a)(g(),e.targetBrowsingContext))||void 0===o?void 0:o.pageId;f(Object(l.b)(t,!0)),Object(d.a)(),m.push({name:"pageUnmounted",value:!0})}if(h.getHistoryManager().GetHistoryLength(e)<=1)return h.navigateBackOutOfApp(e).then(t=>1===t.status?(m.unshift({name:"redirectToDefault",value:!0}),n.EventManager.ReportComponentSuccess("Navigation.Back",m),h.redirectToDefault(e)):(m.unshift({name:"navigateBackOutOfApp",value:!0}),n.EventManager.ReportComponentSuccess("Navigation.Back",m),t));f(Object(r.b)(e.targetBrowsingContext));return h.navigateBack(e).then(([t,n,r,o,s,c])=>{const l=t.getId();return f(Object(a.d)(l,l,e.targetBrowsingContext)),m.unshift(...s),m.unshift({name:"IsDialog",value:""+r}),m.unshift({name:"PageName",value:t.getName()}),m.unshift({name:"PageId",value:l}),m.unshift({name:"BrowsingContextType",value:Object(u.c)(g(),e.targetBrowsingContext)}),f(Object(i.c)(t,n,r,c))}).then(t=>(f(Object(r.a)(e.targetBrowsingContext)),n.EventManager.ReportComponentSuccess("Navigation.Back",m),t)).catch(t=>(t&&(t={name:t.name,errorCode:t.errorCode,message:t.message,stack:t.stack}),f(Object(r.a)(e.targetBrowsingContext)),f(Object(a.e)(t,e.targetBrowsingContext)),n.EventManager.ReportComponentFailure("Navigation.Back",t,"",m),{status:1,error:t}))}}}function h(e,t){return{type:"router.navigateBack.async",execute:({dispatch:n,getState:r},a)=>(t||(t=Object(c.a)(r(),e||Object(s.c)(r()))),t.targetBrowsingContext||(t.targetBrowsingContext=Object(u.g)(r())),n(f(t,e)).then(e=>e?n(g(t)):{status:1,error:new Error("Navigation is not allowed")}))}}},aRLb:function(e,t,n){"use strict";n.d(t,"d",(function(){return E})),n.d(t,"b",(function(){return O})),n.d(t,"e",(function(){return C})),n.d(t,"a",(function(){return I})),n.d(t,"c",(function(){return w}));var r=n("FZDd"),a=n("4ciL"),i=n("x0oY"),o=n("uIhY"),s=n("pEXn"),c=n("SAYH"),l=n("4r2D"),u=n("/oKV"),d=n("Uv1Y"),p=n("ATrR"),f=n("cetF"),g=n("504W"),h=n("g22U"),m=n("Er26"),b=n("69Qu"),y=n("TBkx"),_=n("a8hT"),v=n("vSoM"),S=n("z+5+");function O(e,t,n={}){const r=[];return{type:"executeOData.execute",async execute({dispatch:a,getState:i},o){Object(S.J)(e);const p=new l.a(c.a.newGuid().guid);r.push({name:s.b.ClientRequestId,value:p&&p.RequestId?p.RequestId():null});try{return await a(C(t,e)),o.DataSource.executeOData(e,p,u.a.Remote,r,n)}catch(e){throw Object(d.b)(e)}},getFailureParameters:(e,t)=>r}}function C(e,...t){return{type:"executeOData.requestAdditionalMetadata.async",execute({dispatch:n,getState:a},i){if(!t)return Promise.resolve();const o=i.TraceManager.getTracer("RequestAdditionalMetadataForRequest"),s=t.reduce(w(a(),o),{});return n(Object(r.e)(s,e))}}}function E(e,t,n,a,o){return{type:"requestAdditionalMetadata.async",async execute(s,c){const l={},u=t.additionalHeaders["x-ms-mdl-etn-name"];if(u)switch(e){case h.d.CREATE:case h.d.UPDATE:I(l,u,Object(i.h)(JSON.parse(t.body)));return s.dispatch(Object(r.e)(l,o));case h.d.RETRIEVE_MULTIPLE:const e=t.urlParameters,d=decodeURIComponent(e.substring(e.indexOf("?"),e.length).replace(/\+/g," "));if(Object(b.c)(s.getState()))await s.dispatch(Object(r.f)(u,!1,[],o));else{const e=await Object(_.j)();e.basicValidator(u,5,s,o);const t=new((await Object(_.d)()).ODataQueryOptions)(d);try{await e.optionsValidator(5,u,t,s,o)}catch(e){throw n.error(`${m.p.MdlHttpClient} RetrieveMultiple query option not valid with error ${Object(y.f)(e)}`,a),e}const r=await Object(_.f)();await s.dispatch(r.retrieveMissingMetadata(u,o,t))}Object(v.d)(s.getState(),c,[u],h.b.MdlHttpClient+"."+h.d.RETRIEVE_MULTIPLE)}}}}function I(e,t,n){Object(g.b)(t)||(e.hasOwnProperty(t)?e[t]=Array.from(new Set(e[t].concat(n))):e[t]=n)}function w(e,t){return(n,r)=>{if(Object(a.d)(r))return r.reduce(w(e,t),{});if(Object(a.e)(r)){let a=null;if(!r||"function"!=typeof r.getMetadata||!(a=r.getMetadata()))return n;if("Create"===a.operationName){const e=r,t=Object(i.h)(e.payload);I(n,e.etn,t)}else if("Update"===a.operationName){const e=r;let t=[];e.isBinaryPayload||(t=Object(i.h)(e.payload)),I(n,e.etn,t)}else if("Retrieve"===a.operationName){const a=r,i=a.entityReference.entityType;I(n,i,a.columns),Object(p.d)(n,e,i,a.navigationPropertyDetails,t)}else if("Delete"===a.operationName){I(n,r.entityReference.entityType,[])}else if("RetrieveWithUrlParams"===a.operationName){const e=r.etn;Object(f.c)(e)&&!Object(f.d)(Object(f.b)(e))?I(n,Object(f.b)(e),null):I(n,e,[])}else if("Associate"===a.operationName){const e=r;if(I(n,e.target.entityType,[]),e.relatedEntities)for(const t of e.relatedEntities)I(n,t.entityType,[])}else if("Disassociate"===a.operationName){I(n,r.target.entityType,[])}else{const e=function e(t){let n=null,r=null;if(!t||"function"!=typeof t.getMetadata||!(n=t.getMetadata())||!(r=n.parameterTypes))return[];const a=new Set;for(const i of Object.keys(t)){const s=t[i];if(null!=s)if(n.boundParameter===i)4===r[i].structuralProperty?a.add(s):a.add(s.entityType);else if(r[i])switch(r[i].structuralProperty){case 4:if(s&&s.length)if(s[0].getMetadata){const t=s;for(const n of t)e(n).forEach(e=>a.add(e))}else if(-1===o.a.indexOf(r[i].typeName)){const e=s;for(const t of e)"object"==typeof t&&"entityType"in t&&"id"in t&&a.add(t.entityType)}break;case 5:"object"==typeof s&&"entityType"in s&&"id"in s&&a.add(s.entityType);break;case 2:e(s).forEach(e=>a.add(e))}}return Array.from(a)}(r);for(const t of e)I(n,t,[])}return n}}}},aT9V:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return i}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="add.AppNotificationsAction",a="remove.appnotificationAction",i="remove.appnotificationsAction"},adUS:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class r extends
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class{constructor(){this.code=0,this.message=null}}{constructor(e,t){super(),this.code=e,this.message=t}}var a=n("XjOj"),i=n("Div0"),o=n("NMtn");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.

/**
 * Sql transaction queue
 */
class s{constructor(){this._transactionList=null,this._transactionList=[]}peek(){return this._transactionList.length>0?this._transactionList[0]:null}enqueue(e){this._transactionList.push(e)}dequeue(){const e=this.peek();return e&&this._transactionList.splice(0,1),e}}var c=n("OJOs"),l=n("ZvAk"),u=n("4Gtd"),d=n("+Szo");class p{constructor(e,t,n,r,a,i){this._jsQueue=null,this._onSuccess=null,this._onError=null,this._sqlDispatcher=null,this._onDone=null,this._state=0,this._queuedStatements=null,this._isDispatcherBusy=!1,this._executeSqlCalled=!1,this._isPendingDispatch=!1,this._readTransaction=!1,this._transactionId=0,this._sqlDispatcher=e,this._jsQueue=t,this._onSuccess=n,this._onError=r,this._readTransaction=a,this._transactionId=i,this._state=0,this._queuedStatements=[],this._readTransaction||this._EnqueueBeginTransactionStatement(r)}get_ReadTransaction(){return this._readTransaction}executeSql(e,t,n,r,a){if(this._executeSqlCalled=!0,this._state===l.a.done)throw Error.invalidOperation("ExecuteSql cannot be invoked on a completed transaction.");const i=new c.a(e,t,this._CreateExecuteSqlSuccessCallback(n),this._CreateExecuteSqlErrorCallback(r));this._queuedStatements.push(i),this._state&&!this._isPendingDispatch&&(this._isPendingDispatch=!0,this._jsQueue.setTimeout(()=>{this._isPendingDispatch=!1,this._DispatchNextBatch()},0))}startExecution(e){this._AssertTransactionState(0),this._onDone=e,this._executeSqlCalled?(Object(a.f)(i.a.sqlDbTransactionAdapter,"Starting execution of the transaction"),this._state=l.a.active,this._DispatchNextBatch()):(Object(a.f)(i.a.sqlDbTransactionAdapter,"Completing transaction because no statements were queued."),this._state=l.a.done,this._jsQueue.setTimeout(this._CompleteTransactionSuccess.bind(this),0))}_Commit(){if(Object(a.f)(i.a.sqlDbTransactionAdapter,"Committing transaction"),this._AssertTransactionState(l.a.active),this._state=l.a.done,this._readTransaction)Object(a.f)(i.a.sqlDbTransactionAdapter,"Complete transaction success."),this._CompleteTransactionSuccess();else{const e=new c.a("COMMIT TRANSACTION",[],()=>{Object(a.f)(i.a.sqlDbTransactionAdapter,"Commit success."),this._CompleteTransactionSuccess()},e=>{Object(a.d)(i.a.sqlDbTransactionAdapter,"Commit error: {0}",e.message),this._CompleteTransactionError(e)});this._queuedStatements.push(e),this._DispatchNextBatch()}}_CompleteTransactionSuccess(){this._CompleteTransaction(),this._onSuccess&&this._onSuccess()}_CompleteTransactionError(e){this._CompleteTransaction(),this._onError&&this._onError(e)}_CompleteTransaction(){this._sqlDispatcher=null,this._onDone&&this._onDone()}_RollbackWithException(e){const t=new r(0,u.a+e.message);this._RollbackWithError(t)}_RollbackWithError(e){if(Object(a.f)(i.a.sqlDbTransactionAdapter,"Rolling back transaction"),this._AssertTransactionState(l.a.active),this._state=l.a.done,this._queuedStatements=[],this._readTransaction)Object(a.d)(i.a.sqlDbTransactionAdapter,"RollbackWithError:Complete Transaction Error."),this._CompleteTransactionError(e);else{const t=new c.a("ROLLBACK TRANSACTION",[],()=>{Object(a.f)(i.a.sqlDbTransactionAdapter,"Rollback success."),this._CompleteTransactionError(e)},t=>{Object(a.d)(i.a.sqlDbTransactionAdapter,"RollbackWithError:Rollback error: {0}",t.message),this._CompleteTransactionError(e)});this._queuedStatements.push(t),this._DispatchNextBatch()}}_Rollback(){if(Object(a.f)(i.a.sqlDbTransactionAdapter,"Rolling back transaction"),this._AssertTransactionState(l.a.active),this._state=l.a.done,this._queuedStatements=[],this._readTransaction)Object(a.f)(i.a.sqlDbTransactionAdapter,"Rollback:Complete Transaction Error."),this._CompleteTransaction();else{const e=new c.a("ROLLBACK TRANSACTION",[],()=>{Object(a.f)(i.a.sqlDbTransactionAdapter,"Rollback success."),this._CompleteTransaction()},e=>{Object(a.d)(i.a.sqlDbTransactionAdapter,"Rollback:Rollback error: {0}",e.message),this._CompleteTransaction()});this._queuedStatements.push(e),this._DispatchNextBatch()}}_CreateExecuteSqlSuccessCallback(e){return t=>{this._state!==l.a.done&&(Object(a.h)(i.a.sqlDbTransactionAdapter,"ExecuteSql success"),e&&this._InvokeSuccessCallbackAndRollbackOnExecption(e,t))}}_CreateExecuteSqlErrorCallback(e){return t=>{Object(a.d)(i.a.sqlDbTransactionAdapter,"ExecuteSql error :Code = "+t.code+":Message = "+t.message),this._state!==l.a.done&&this._RollbackWithError(t),e&&e(this,t)}}_InvokeSuccessCallbackAndRollbackOnExecption(e,t){try{e(this,{insertId:t.insertId,rowsAffected:t.rowsAffected,columnNames:t.columnNames,rows:new d.a(t)})}catch(e){Object(a.e)(i.a.sqlDbTransactionAdapter,e,"Exception during transaction callback."),this._RollbackWithException(e)}}_CommitIfThereAreNoQueuedStatements(){this._queuedStatements.length||this._Commit()}_EnqueueBeginTransactionStatement(e){const t=new c.a("BEGIN TRANSACTION",[],()=>{},t=>{t&&"cannot start a transaction within a transaction"===t.message?(Object(a.i)(i.a.sqlDbTransactionAdapter,"Rolling back uncommitted transaction and starting new transaction : {0}",t.message),this._Rollback(),this._EnqueueBeginTransactionStatement(e),Object(a.i)(i.a.sqlDbTransactionAdapter,"{0}","Rollback of uncommitted transaction completed and new transaction started")):(Object(a.d)(i.a.sqlDbTransactionAdapter,"BEGIN error: Message = {0}",t.message+":Code = "+t.code),e&&e(t))});this._queuedStatements.push(t)}_DispatchNextBatch(){if(!this._isDispatcherBusy&&this._queuedStatements.length>0){const e=this._sqlDispatcher.createBatch(this._transactionId.toString(),this._readTransaction);for(;this._queuedStatements.length>0&&e.get_estimatedSize()<m.maximumBatchSize;){this._queuedStatements.shift().addToBatch(e)}this._isDispatcherBusy=!0,e.execute(()=>{this._isDispatcherBusy=!1,this._state!==l.a.done&&this._CommitIfThereAreNoQueuedStatements(),this._DispatchNextBatch()})}}_AssertTransactionState(e){if(this._state!==e)throw Error.invalidOperation(String.format("transaction state expected {0}.  Actual {1}.",e,this._state))}}var f=n("a8hT"),g=n("17x/");let h=0;class m{constructor(e,t,n){this._sqlDispatcher=null,this._jsQueue=null,this._runningTransactionCount=0,this._isRunningTransactionRead=!1,this._transactionQueue=null,this._store=null,this._sqlDispatcher=e,this._jsQueue=t,this._transactionQueue=new s,this._runningTransactionCount=0,this._isRunningTransactionRead=!1,this._store=n}transactionWithType(e,t,n,s){Object(o.b)(e,"transaction");let c=null;Object(f.h)().then(o=>{c=Object(g.l)(this._store.getState())&&Object(g.k)(this._store.getState())?new o.SqlDbTransactionAdapterV2(this._sqlDispatcher,this._jsQueue,n,t,s,++h,this._store):new p(this._sqlDispatcher,this._jsQueue,n,t,s,++h);try{e(c),this._transactionQueue.enqueue(c),this._ExecuteNextTransaction()}catch(e){if(Object(a.e)(i.a.sql,e,"Exception caught in transaction callback."),t){const n=String.format("Exception caught in transaction callback. {0}",e.message),a=new r(0,n);t(a)}}})}transaction(e,t,n){this.transactionWithType(e,t,n,!1)}readTransaction(e,t,n){this.transactionWithType(e,t,n,!0)}_ExecuteNextTransaction(){const e=this._transactionQueue.peek();if(e&&(!this._runningTransactionCount||this._isRunningTransactionRead&&e.get_ReadTransaction())){this._runningTransactionCount++;const e=this._transactionQueue.dequeue();this._isRunningTransactionRead=e.get_ReadTransaction(),this._jsQueue.setTimeout(()=>{e.startExecution(()=>{this._runningTransactionCount--,this._ExecuteNextTransaction()})},0)}}}m.maximumBatchSize=4194304},ai6P:function(e,t,n){"use strict";n.d(t,"a",(function(){return T}));var r=n("ufH1"),a=n("84PK"),i=n("504W"),o=n("Div0"),s=n("gg/8"),c=n("gvQo"),l=n("rO1J");function u(e){const t=e;return new l.a(new a.a(t.AttributeId),t.CanCreate,t.CanRead,t.CanUpdate)}var d=n("ngzy");var p=n("j63P");function f(e){const t=e,n=t.PrivilegeName?t.PrivilegeName:void 0;return new c.a(new a.a(t.PrivilegeId),new a.a(t.BusinessUnitId),t.Depth,n)}var g=n("P74A");var h=n("/KPo");var m=n("/XAI");function b(e){const t=e;return new m.a(t.Bias,t.TimeZoneCode,t.UserInterfaceName)}var y=n("xP3K");function _(e){const t=e;return new y.a(new a.a(t.CurrencyId),t.CurrencyName,t.CurrencySymbol,t.CurrencyCode,t.CurrencyPrecision)}var v=n("FKgA"),S=n("0Lym"),O=n("+Kwi");function C(e){const t=e,n=new Date(t.DateStart),r=new Date(t.DateEnd),a=function(e){const t=e.toString().split(":"),n=36e5,r=6e4,a=1e3;return Number.parseInvariant(t[0])*n+Number.parseInvariant(t[1])*r+Number.parseInvariant(t[2])*a}(t.DaylightDelta),i=new O.a(t.DaylightTransitionStart.Day,t.DaylightTransitionStart.DayOfWeek,t.DaylightTransitionStart.Month-1,t.DaylightTransitionStart.Week,new Date(t.DaylightTransitionStart.TimeOfDay),t.DaylightTransitionStart.IsFixedDateRule),o=new O.a(t.DaylightTransitionEnd.Day,t.DaylightTransitionEnd.DayOfWeek,t.DaylightTransitionEnd.Month-1,t.DaylightTransitionEnd.Week,new Date(t.DaylightTransitionEnd.TimeOfDay),t.DaylightTransitionEnd.IsFixedDateRule);return new S.a(r,n,a,i,o)}var E=n("Gxq8");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var I=n("3sOn");function w(e){const t={};if(void 0!==e.ReducedRolePrivileges&&null!==e.ReducedRolePrivileges){const n=e.ReducedRolePrivileges;for(const e of n){const n=e.BusinessUnitId;for(const r of e.PrivilegesInfo){const e=r.Depth;for(const i of r.Privileges){const r=-1!==i.indexOf(",")?i.split(",")[0]:void 0,o=-1!==i.indexOf(",")?i.split(",")[1]:i,s=new c.a(new a.a(o),new a.a(n),e,r);t[s.get_privilegeId().toString()]=s}}}}else if(void 0!==e.RolePrivileges&&null!==e.RolePrivileges)for(const n of e.RolePrivileges){const e=f(n);t[e.get_privilegeId().toString()]=e}return t}function j(e){if(e.FeatureControlSettings){return function(e){const t={};for(const n of e){const e=n.Type;for(const r of n.FeatureControlSettingsInfoList){const n=r.NameSpaceValue,a=[];for(const t of r.FeatureControlSettingValueList)a.push(new E.a(t.Name,e,t.Value));Object(i.a)(t[n])?t[n]=a:t[n]=t[n].concat(a)}}return t}(e.FeatureControlSettings)}return{}}function P(e){const t=e,n=new a.a(t.UserId),c=t.UserName,l=t.UserEmail,f=t.MetadataLastModifiedTime,m=t.UserMetadataLastModifiedTime,y=t.UserRoles.map(e=>new a.a(e)),S=t.ParentRootRoles?t.ParentRootRoles.map(e=>new a.a(e)):[],O=t.RoleNames,E=function(e){const t=e,n=new p.a(new a.a(t.OrganizationId),t.OrganizationName,t.LanguageCode,t.EnabledLanguages,t.CurrencyDisplayOption,t.BlockedAttachmentExtensions,t.MaxUploadFileSize,t.ReportScriptErrors,t.IsAutoSaveEnabled,t.IsDuplicateDetectionEnabled,t.IsDuplicateDetectionEnabledForOnlineCreateUpdate,t.OrgCultureInfoLcid,t.FullNameConventionCode,t.FiscalCalendarStart,t.FiscalPeriodFormatPeriod,t.FiscalYearFormatPrefix,t.FiscalYearFormatYear,t.FiscalYearFormatSuffix,t.FiscalPeriodType,t.FiscalYearDisplayCode,t.FiscalPeriodConnector,t.IsSOPIntegrationEnabled,new a.a(t.BaseCurrencyId),t.OrganizationUniqueName,t.UseSkypeProtocol,t.DefaultCountryCode,t.GeoName,t.PricingDecimalPrecision,t.IsTelemetryEnabled,t.IsMocaOfflineFeatureEnabled,t.MobileOfflineSyncInterval,t.NorsyncServerConnectionString,t.OverrideTrackInCrmBehaviour,t.ShowWeekNumber,t.DefaultThemeData,t.LogoImagePath,t.LogoTooltip,t.SessionTimeoutInSeconds,t.SessionTimeoutReminderInSeconds,t.InactivityTimeoutInSeconds,t.InactivityTimeoutReminderInSeconds,t.DelveUrl,t.KmUseExternalPortal,t.KmExternalPortalUrl,t.IsParature,t.IsKMConfigured,t.MaxIncidentMergeNumber,t.MaxChildIncidentNumber,t.IsConflictDetectionEnabledForMobileClient,t.WebResourceHash,t.IsPowerBIEnabled,t.FirstPartyIntegrationSiteUrl,t.EnableLPAuthoring,t.IsContextualHelpEnabled,t.IsMicrosoftFlowEnabled,t.MicrosoftFlowFirstPartyIntegrationSiteUrl,t.IsExternalSearchIndexEnabled,t.MicrosoftFlowDestinationUrl,t.MicrosoftFlowEnvironmentId,t.SharePointDeploymentType,t.IsOneDriveEnabled,t.IsMSTeamsEnabled,t.IsContextualEmailEnabled,t.IsAutoDataCaptureV2Enabled,t.IsManualSalesForecastingEnabled,t.IsActionCardEnabled,t.EnableImmersiveSkypeIntegration,t.IsEmailMonitoringAllowed,t.AllowUnresolvedPartiesOnEmailSend,t.IsPresenceEnabled,t.BoundDashboardDefaultCardExpanded,t.IsPreviewOrganization,t.IsSandboxOrganization,t.IsSovereignCloud,t.AdvancedDebuggabilitySettings,t.OfficePortalUrl,t.IsCrmOrg,t.YammerGroupId,t.YammerNetworkName,t.YammerOAuthAccessTokenExpired,t.YammerPostMethod,t.AppointmentRichEditorExperience,t.EnableBingMapsIntegration,t.BingMapsApiKey,t.AvailableBingMapLocales,t.ExcludedCountriesForMaps,t.BFDatacenter,t.AllowLegacyDialogsEmbedding,t.AllowLegacyClientExperience,t.CdsCapabilityMode,t.EnableUnifiedInterfaceShellRefresh,t.GlobalHelpUrl,t.PrivacyStatementUrl,t.OrganizationTenant,t.SecuritySettingForEmail,t.EnableActivitiesTimeLinePerfImprovement,t.GridTotalRecordCountLimit,t.EnableLivePersonaCardUCI,t.LivePersonaCardComplianceEnvironment,t.LivePersonaCardCulture,t.LivePersonaCardFirstPartyIntegrationUrl,t.LivePersonaCardRegion,t.GlobalHelpUrlEnabled,t.GlobalAppendUrlParametersEnabled,t.AreJquery3IncompatibleSolutionsInstalled,t.UseQuickFindViewForGridSearch,t.PpacSettingsUrl,t.IsRichTextNotesEnabled,t.DefaultCrmCustomName,t.CustomizationUrl,t.NewSearchExperienceEnabled,t.ImproveSearchLoggingEnabled,t.LookupCharacterCountBeforeResolve,t.LookupResolveDelayMS,t.OrganizationBAPEnvironmentID,t.IsTrialOrganization,t.OrganizationExpiryDate,t.AdvancedLookupEnabled,t.RelevanceSearchEnabledByPlatform,t.QuickActionToOpenRecordsInSidePaneEnabled,t.IsCollaborationExperienceEnabled,t.IsSharingInOrgAllowed,t.CopresenceRefreshRate,t.AdvancedColumnEditorEnabled,t.AdvancedColumnFilteringEnabled,t.ModernAdvancedFindFiltering,t.AllowUsersHidingSystemViews,t.EnableAsyncMergeAPIForUCI,t.UserRatingEnabled,t.PcfDatasetGridEnabled,t.AppointmentWithTeamsMeeting);return n.set_webServiceCallRetryPolicies(t.WebServiceCallRetryPolicies),n}(t.OrganizationSettings),P=Object(i.a)(t.SelectedForms)?null:function(e){const t=e;return Object(i.a)(t.SelectedFormsByEntity)?null:new g.a(t.SelectedFormsByEntity)}(t.SelectedForms),T=function(e){const t=e,n=JSON.parse(t.ClientCultureInfo),a=n.dateTimeFormat;a.eras=n.eras;const s=[];if(Object(i.a)(t.TimeZoneAdjustmentRules))Object(r.e)("UserContextSerializer.LoadFromJson:",o.a.storage," User context retrieved from server Does not have any TimeZoneAdjustmentRules");else for(const e of t.TimeZoneAdjustmentRules){const t=C(e);s.push(t)}return new v.a(t.LanguageId,t.UserCultureLcid,t.UserCultureName,n.name,n.numberFormat,a,t.TimeZoneUtcOffsetMinutes,s,t.RecordsPerPage,t.ReportScriptErrors,t.IsGuidedHelpEnabled,t.ShowCalendarWeeks,t.IsHighContrastEnabled,t.DefaultSearchExperience,t.DefaultGridViews,t.SelectedGlobalFilterId,t.IsAdmin,t.IsCustomizer,t.HomepageArea,t.HomepageSubArea,t.IsEmailConversationViewEnabled,t.WorkDayStartTime,t.AutoCaptureUserStatus,t.IsSupportUser)}(t.UserSettings),N=Object(i.a)(t.OfflineProfile)?null:function(e){const t=e;return Object(i.a)(t)?null:new d.a(new a.a(t.ProfileId),t.OfflineAvailableEntities,t.ProfileVersion)}(t.OfflineProfile),A=w(e),R={};for(const e of t.AttributePrivileges){const t=u(e);R[t.get_AttributeId().toString()]=t}const D=function(e){const t=e;return new h.a(t.ServerVersion,t.DatabaseVersion)}(t.ServerContext),x=Object(i.a)(t.FullServerVersion)?Object(s.a)():t.FullServerVersion,M=new a.a(t.TransactionCurrencyId),F=new a.a(t.DefaultDashboardId),k=new a.a(t.DefaultHomepageId),L=new a.a(t.DefaultInteractionCentricDashboardId),B={};for(const e of t.TransactionCurrencies){const t=_(e);B[t.get_TransactionCurrencyId().toString()]=t}const U={};if(!Object(i.a)(t.TimeZoneDefinitions)&&t.TimeZoneDefinitions.length>0)for(const e of t.TimeZoneDefinitions){const t=b(e);U[t.get_TimeZoneCode().toString()]=t}else Object(r.e)("UserContextSerializer.LoadFromJson:",o.a.storage," User context Does not have any TimeZoneDefinitions");const V={};V[I.a.transactionCurrencyByIdExternalContextField]=B,V[I.a.timeZoneDefinitionByCodeExternalContextField]=U,V[I.a.isLiveExternalContextField]=t.IsLive,V[I.a.isOsdpOrganizationExternalContextField]=t.IsOsdpOrganization,V[I.a.usePathBasedUrlsExternalContextField]=t.UsePathBasedUrls,V[I.a.entityMetadataSyncConfigurationExternalContextField]=t.EntityMetadataSyncConfiguration;const z=function(e){const t={};if(void 0!==e.SimpleFCBContext&&null!==e.SimpleFCBContext)return e.SimpleFCBContext;if(void 0!==e.ReducedFCBContext&&null!==e.ReducedFCBContext){const n=e.ReducedFCBContext;if(void 0!==n.Reduced&&null!==n.Reduced)for(const e of n.Reduced){for(const n of e.Enabled)t[n]=!0;for(const n of e.Disabled)t[n]=!1}if(void 0!==n.NonReduced&&null!==n.NonReduced)for(const e of n.NonReduced)t[e.FeatureName]=e.Value}else if(void 0!==e.FCBContext&&null!==e.FCBContext){if(void 0!==e.FCBContext.length&&0===e.FCBContext.length)return t;for(const n of e.FCBContext)t[n.FeatureName]=n.Value}return t}(e),q=j(e);return new I.a(n,c,l,y,S,E,T,A,R,D,O,f,m,M,F,k,L,x,N,V,z,P,q)}function T(e){return e.ExtendedUserContext?function(e){const t=w(e);return new I.a(void 0,void 0,void 0,void 0,void 0,void 0,void 0,t,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0)}(e.ExtendedUserContext):P(e)}},amNf:function(e,t,n){"use strict";n.d(t,"i",(function(){return G})),n.d(t,"d",(function(){return J})),n.d(t,"e",(function(){return Y})),n.d(t,"f",(function(){return Z})),n.d(t,"g",(function(){return ee})),n.d(t,"b",(function(){return X})),n.d(t,"c",(function(){return $})),n.d(t,"h",(function(){return K})),n.d(t,"a",(function(){return Q}));var r=n("arV0"),a=n("zsAz"),i=n("fU4N"),o=n("TKDo"),s=n("cfbi"),c=n("JDi5"),l=n("fILV"),u=n("Nk+G"),d=n("OKVy"),p=n("gw2m"),f=n("fA3V"),g=n("16wZ"),h=n("ruPX"),m=n("tICD"),b=n("SAYH");var y=n("n3bs"),_=n("qshH");var v=n("odYE");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function S(e){let t;e.createFromEntity&&(t=new v.a(e.createFromEntity.entityType,b.a.tryParseOrNull(e.createFromEntity.id),e.createFromEntity.name));return{entityTypeName:e.entityName,ids:e.entityIds?e.entityIds.map(e=>b.a.parse(e)):void 0,id:e.entityId?new b.a(e.entityId):void 0,data:e.data?e.data:void 0,formId:e.formId?new b.a(e.formId):void 0,processId:e.processId,processInstanceId:e.processInstanceId,selectedStageId:e.selectedStageId,isCrossEntityNavigate:e.isCrossEntityNavigate,initWithEntity:t,isOfflineSyncError:e.isOfflineSyncError,recordSetQueryKey:e.recordSetQueryKey,formType:e.formType,lookupAttributeName:e.lookupAttributeName,selectedTabName:e.tabName}}var O=n("d0w6");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function C(e){return"savedview"===e||"savedquery"===e?O.b.savedview:"userview"===e||"userquery"===e?O.b.userview:null}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var E=n("EBJu"),I=n("6QGX"),w=n("5Oca"),j=n("Nb1E"),P=n("+nTZ");var T=n("Lyxw"),N=n("3/02"),A=n("e5YD"),R=n("nzu+"),D=n("+BIz"),x=n("tT9w"),M=n("i1f0"),F=n("YxC/"),k=n("Uv1Y"),L=n("vr5N"),B=n("EY5k");function U(e,t,n,r,a){return{type:"form.navigateTo.async",async execute({dispatch:i,getState:o}){var s,c;let l=n;if("bulkedit"===t.toLowerCase()){await e.dispatch(Object(B.e)(L.n));const t=await async function(e,t,n){var r;const a=null===(r=null==t?void 0:t.ids)||void 0===r?void 0:r.filter(n=>!Object(M.Rb)(e.getState(),t.entityTypeName,n));if(!a)return null;const i=t.ids.length-a.length;if(0===a.length){const t=Object(F.e)(e.getState(),L.n),r=Object(A.b)(t,L.c),a=Object(A.b)(t,L.b),i=Object(A.b)(t,L.a),o=await e.dispatch(Object(R.a)({title:r,text:a,confirmButtonLabel:i},void 0,n));if(0!==o.status)throw o.error}else if(i>0){await e.dispatch(Object(B.e)(L.n));const n=Object(F.e)(e.getState(),L.n),r=Object(A.b)(n,L.f),o=Object(A.b)(n,L.g),s=Object(A.b)(n,L.e),c=Object(A.b)(n,L.d),l=await e.dispatch(Object(D.a)(String.format(r,i,t.ids.length),{},o,void 0,void 0,s,c));if(0===l.status){return(await e.dispatch(Object(m.a)(l.pageId))).value.confirmed?a:[]}throw l.error}return a}(e,n,r);if(!(null==t?void 0:t.length)){return{navResult:{status:null===t?1:0},prehandlingResponse:null}}if(l=Object.assign(Object.assign({},n),{ids:t}),l.dialogOptions){const n=Object(F.e)(e.getState(),L.n),r=Object(A.b)(n,L.j),a=String.format(r,null==t?void 0:t.length);l.dialogOptions.title=a}}const u=await i(Object(h.a)(t,l,r,a)),d={navResult:u,prehandlingResponse:null};if(0===u.status)return d;if("bulkedit"===(null==n?void 0:n.pageType)){const e=!(null===(s=u.error)||void 0===s?void 0:s.errorCode)&&(null===(c=u.error)||void 0===c?void 0:c.message)?new k.a(u.error.message,u.error.errorCode,u.error,null,null,null,u.error.stack):Object(k.c)(u.error);throw i(Object(x.b)(e)),e}return d}}}var V=n("LbMF"),z=n("504W"),q=n("69Qu"),H=n("dHD5"),W=n("dpM5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function G(e,t,n,a,i,o,c,l){"recordlist"===(null==n?void 0:n.pageType)&&(n.pageType="entitylist");const u=function(e,t){const n=[{name:"pageInput",value:e,isRequired:!0},{name:"pageType",value:null==e?void 0:e.pageType,isRequired:!0,isEventParam:!0}];if(!e)return n;switch(e.pageType){case"dashboard":n.push({name:"dashboardId",value:e.dashboardId,isEventParam:!0,expectedDataType:"guid"}),n.push({name:"entityType",value:e.entityType,isEventParam:!0,expectedDataType:"string"}),n.push({name:"navPath",value:e.navigationPath,isEventParam:!0,expectedDataType:"string"}),n.push({name:"type",value:e.type,isEventParam:!0});break;case"control":n.push({name:"controlName",value:e.controlName,isRequired:!0,isEventParam:!0,expectedDataType:"string"});break;case"inlinedialog":n.push({name:"uniqueName",value:e.uniqueName,isRequired:!0,isEventParam:!0,expectedDataType:"string"});break;case"entityrecord":n.push({name:"entityName",value:e.entityName,isRequired:!0,isEventParam:!0,expectedDataType:"string"}),n.push({name:"entityId",value:e.entityId,isEventParam:!0,expectedDataType:"guid"}),n.push({name:"formId",value:e.formId,isEventParam:!0,expectedDataType:"guid"}),n.push({name:"processId",value:e.processId,isEventParam:!0,expectedDataType:"string"}),n.push({name:"selectedStageId",value:e.selectedStageId,isEventParam:!0,expectedDataType:"string"});break;case"bulkedit":n.push({name:"entityName",value:e.entityName,isRequired:!0,isEventParam:!0,expectedDataType:"string"}),n.push({name:"formId",value:e.formId,isEventParam:!0,expectedDataType:"guid"}),n.push({name:"entityIds",value:e.entityIds,isRequired:!0,isEventParam:!0,expectedDataType:"array"});break;case"entitylist":n.push({name:"viewId",value:e.viewId,isEventParam:!0,expectedDataType:"guid"}),n.push({name:"viewType",value:e.viewType,isEventParam:!0,expectedDataType:"string"}),n.push({name:"entityName",value:e.entityName,isRequired:!0,isEventParam:!0,expectedDataType:"string"});break;case"search":n.push({name:"searchType",value:e.searchType,isEventParam:!0}),n.push({name:"EntityGroupName",value:e.EntityGroupName,isEventParam:!0}),n.push({name:"EntityNames",value:Array.isArray(e.EntityNames)?e.EntityNames.join(","):"",isEventParam:!0,expectedDataType:"string"});break;case"webresource":n.push({name:"webresourceName",value:e.webresourceName,isRequired:!0,isEventParam:!0});break;case"custom":n.push({name:"appname",value:e.name,isEventParam:!0});break;default:throw Object(g.e)(t,"Unexpected xrm page input",null,n)}return n}(n,t.getComponentName(a));return t.executeAsync(a,()=>{const t=Y(n,i),a=J(n);a.dialogOptions=o,a.newWindowOptions=c;return(function(e){return e===s.a}(t)?e.dispatch(U(e,t,a,l,i)):e.dispatch(Object(h.a)(t,a,l,i)).then(e=>({navResult:e,prehandlingResponse:null}))).then(t=>{if(t.prehandlingResponse)return t.prehandlingResponse;const a=t.navResult;return 0===a.status&&Object(r.h)(e.getState(),a.pageId)?K(e,a,n):void 0})},u)}function K(e,t,n){var a,i,o;const{dialogContextId:s,sourcePageId:c}=Object(P.b)(e.getState(),t.pageId),l=Object(r.p)(e.getState(),t.pageId),u=new Promise(t=>{const n=e.subscribe(e=>Object(P.d)(e)[s],e=>{e||(n(),t())})}),d=Object(H.j)(e.getState(),t.pageId),p=null===(i=null===(a=n)||void 0===a?void 0:a.relationship)||void 0===i?void 0:i.attributeName,f=(null===(o=Object(M.B)(e.getState(),t.pageId,d,p))||void 0===o?void 0:o.length)>0;return Promise.all([u,e.dispatch(Object(m.a)(t.pageId))]).then(t=>{const a=t[1];switch(null==n?void 0:n.pageType){case"entityrecord":return function(e,t,n,a,i,o,s){var c;let l=t;Object(T.f)(e.getState(),W.q)&&s===E.a&&(l=null!==(c=function(e,t,n){const a=Object(r.d)(e,t,n),i=null==a?void 0:a.filter(e=>(null==e?void 0:e.pageType)===E.a);if(!i||0===i.length)return null;return i.map(e=>{var t,n;return null===(n=null===(t=null==e?void 0:e.output)||void 0===t?void 0:t.value)||void 0===n?void 0:n[0]})}(e.getState(),o,i))&&void 0!==c?c:l);if(!(null==n?void 0:n.entityId)&&l.length>0){const t=l.filter(e=>e).map((e,t,n)=>({id:b.a.externalGuid(b.a.fromExternalGuid(e.id.guid)),entityType:e.etn,name:e.name}));if(0===t.length)return Promise.resolve({savedEntityReference:null});if(a)return Promise.resolve({savedEntityReference:t});const r=t.map(t=>Q(e,t,n.createFromEntity,n.relationship));return Promise.all(r).then(()=>({savedEntityReference:t}))}return Promise.resolve({savedEntityReference:null})}(e,null==a?void 0:a.value,n,f,s,c,l);case"webresource":return new Promise(e=>e({returnValue:null==a?void 0:a.value}));default:return null}})}function Q(e,t,n,r){var a;if(r&&r.attributeName&&n&&t&&t.id&&t.entityType){const i=e.getState(),o=Object(I.d)(Object(w.j)(i,new v.a(t.entityType,new b.a(t.id)),r.attributeName)),s=null===(a=Object(V.a)(i,t.entityType,r.attributeName))||void 0===a?void 0:a.IsLogical,c=!Object(q.c)(i);if(!o&&!s&&!c){if(r.roleType&&2===r.roleType){const e=t;t=n,n=e}const a=[new v.a(t.entityType,b.a.tryParseOrNull(t.id),t.name)],i=new v.a(n.entityType,b.a.tryParseOrNull(n.id),n.name);return e.dispatch(Object(j.a)(i,r.name,a))}}return Promise.resolve()}function X(e,t,n,r){if(r||(r=[]),t)switch(r.push({name:"pageType",value:t.pageType}),t.pageType){case y.a.DASHBOARD:
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
return function(e,t){const n={pageType:"dashboard",canOverride:e.canOverride,entityName:e.etn,dashboardId:e.dashboardId?b.a.externalGuid(e.dashboardId):void 0,entityType:e.etn,navigationPath:e.navPath};return e.type?n.type="system"===e.type?"system":"user":n.type=null,n}(t);case y.a.ENTITY_LIST:case y.a.VIEW:return function(e,t){const n={entityName:e.entityTypeName,pageType:"entitylist",viewId:e.viewId?b.a.externalGuid(e.viewId):void 0};return e.viewType?n.viewType=e.viewType===O.b.savedview?"savedquery":"userquery":n.viewType=null,n}(t);case y.a.ENTITY_RECORD:case y.a.ENTITY:case y.a.MAIN_FORM_DIALOG:case y.a.QUICK_CREATE:return function(e,t){const n={entityName:e.entityTypeName,data:e.data,entityId:e.id?b.a.externalGuid(e.id):void 0,formId:e.formId?b.a.externalGuid(e.formId):void 0,isCrossEntityNavigate:e.isCrossEntityNavigate,isOfflineSyncError:e.isOfflineSyncError,processId:e.processId,processInstanceId:e.processInstanceId,selectedStageId:e.selectedStageId,relationship:e.createFromRelationship,pageType:"entityrecord",formType:e.formType};return e.initWithEntity?n.createFromEntity={id:e.initWithEntity.id?b.a.externalGuid(e.initWithEntity.id):void 0,name:e.initWithEntity.name,entityType:e.initWithEntity.etn}:e.createFromEntity?n.createFromEntity={id:e.createFromEntity.id?b.a.externalGuid(e.createFromEntity.id):void 0,name:e.createFromEntity.name,entityType:e.createFromEntity.etn}:n.createFromEntity=null,n}(t);case y.a.INLINE_DIALOG:case y.a.DIALOG:
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
return function(e,t,n){const r={data:e.data,uniqueName:e.uniqueName,pageType:null};switch(e.pageType){case y.a.INLINE_DIALOG:r.pageType="inlinedialog";break;case y.a.DIALOG:r.pageType="dialog";break;default:return _.a.getInstance().reportFailure(t,new Error("Invalid page type"),null,n),null}return r}(t,n,r);case y.a.TASKBASED_FLOW:return{entityName:(o=t).entityTypeName,pageType:"taskbasedflow",uniqueName:o.uniqueName,entityId:o.id?b.a.externalGuid(o.id):void 0};case y.a.CONTROL:return Object(T.e)(e,N.fb,N.o)?{pageType:"control",controlName:(a=t).customControlId,data:a.data}:void 0;case y.a.SEARCH:return Object(T.e)(e,N.fb,N.o)?
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e){let t=null;if(e&&e.searchType)switch(+e.searchType){case i.a.CategorizedSearch:t=1;break;case i.a.RelevanceSearch:t=0;break;case i.a.CustomSearch:t=2}return{pageType:"search",searchText:e.searchText,searchType:t,EntityNames:e.SearchFilters,EntityGroupName:e.EntityGroupName}}(t):void 0;case y.a.CUSTOM:return t;default:return void _.a.getInstance().reportFailure(n,new Error("UnSupported PageType"),null,r)}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var a,o;_.a.getInstance().reportFailure(n,new Error("PageInput is null"),null,r)}function Y(e,t){switch(e.pageType){case"dashboard":return d.a;case"control":return u.a;case"inlinedialog":return o.a;case"entityrecord":if(null===e.formType||void 0===e.formType||2===e.formType)return s.b;if(9===e.formType){if(t&&"dialog"!==t.target)throw Object(a.d)("Unexpected target of navigationOptions for formType QuickCreate: "+t.target);return E.a}throw Object(a.d)("Unexpected formType of xrm page input: "+e.formType);case"bulkedit":return s.a;case"entitylist":return l.a;case"search":return c.a;case"webresource":return f.a;case"custom":return p.a;default:throw Object(a.d)("Unexpected xrm page type")}}function J(e){switch(e.pageType){case"dashboard":return{navPath:(t=e).navigationPath,dashboardId:t.dashboardId&&new b.a(t.dashboardId),etn:t.entityName||t.entityType,type:t.type,canOverride:t.canOverride};case"control":return function(e){return{customControlId:e.controlName,data:e.data}}(e);case"inlinedialog":return function(e){return{uniqueName:e.uniqueName,entityTypeName:e.uniqueName,data:e.data}}(e);case"entityrecord":case"bulkedit":return S(e);case"entitylist":return function(e){return{viewId:e.viewId&&new b.a(e.viewId),viewType:C(e.viewType),entityTypeName:e.entityName}}(e);case"search":return function(e){let t=null;if(!Object(z.a)(e.searchType))switch(+e.searchType){case 1:t=i.a.CategorizedSearch;break;case 0:t=i.a.RelevanceSearch;break;case 2:t=i.a.CustomSearch}return{pageType:e.pageType,searchType:t,searchText:e.searchText,EntityGroupName:e.EntityGroupName,SearchFilters:e.EntityNames}}(e);case"webresource":return function(e){return{webresourceName:e.webresourceName,webresourceData:{webresourceData:e.data}}}(e);case"custom":return function(e){return{name:e.name,entityName:e.entityName,recordId:e.recordId}}(e);default:throw Object(a.d)("Unexpected xrm page input")}var t}function $(e,t){switch(t.target){case 1:return{target:"inline"};case 2:return{target:"dialog"};case 3:return{target:"newWindow"};default:Object(g.j)(e+".convertXrmNavigationOptionsToRouter","navigationOptions.target")}}function Z(e,t){let n,r,a,i,o=!1;t.position&&(n=1===t.position?"center":"side"),!t.width||"number"!=typeof t.width&&isNaN(+t.width)&&!te(t.width)?t.width&&Object(g.j)(e+".createDialogOptionsForRouter","DialogNavigationOptions.width"):r=ne(e,t.width),!t.height||"number"!=typeof t.height&&isNaN(+t.width)&&!te(t.height)?t.height&&Object(g.j)(e+".createDialogOptionsForRouter","DialogNavigationOptions.height"):a=ne(e,t.height),t.hideDialogHeader&&(o="boolean"==typeof t.hideDialogHeader&&t.hideDialogHeader),t.title&&"string"==typeof t.title?i=t.title:t.title&&Object(g.k)(e,"string","DialogNavigationOptions.title");return{width:r,height:a,windowPosition:n,hideDialogHeader:o,title:i}}function ee(e,t){let n,r,a;return t&&(!t.width||"number"!=typeof t.width&&isNaN(+t.width)&&!te(t.width)?t.width&&Object(g.j)(e+".createNewWindowOptionsForRouter","NewWindowNavigationOptions.width"):n=ne(e,t.width),!t.height||"number"!=typeof t.height&&isNaN(+t.width)&&!te(t.height)?t.height&&Object(g.j)(e+".createNewWindowOptionsForRouter","NewWindowNavigationOptions.height"):r=ne(e,t.height),t.toolbar&&"boolean"==typeof t.toolbar&&(a=t.toolbar)),{width:n,height:r,toolbar:a}}function te(e){return"object"==typeof e&&"unit"in e&&"value"in e}function ne(e,t){if(!te(t))return+t;switch(t.unit){case"px":return t.value;case"%":return t.value+"%";default:Object(g.j)(e+"._getLengthFromSizeValue","DialogNavigationOptions.SizeValue")}}},amok:function(e,t,n){"use strict";n.d(t,"a",(function(){return O})),n.d(t,"b",(function(){return S}));var r=n("eL04"),a=n("P+p9"),i=n("ABCl"),o=n("SAYH"),s=n("sHzf"),c=n("16wZ"),l=n("amNf"),u=n("5X+N");class d{constructor(e,t){this._sidePanels={};Object(c.g)(e,"ClientApi.XrmAppPanels.constructor","store"),Object(c.g)(t,"ClientApi.XrmAppPanels.constructor","context"),this._applicationContext=t,this._store=e,this._clientApiExecutor=new i.b(e,"ClientApi.XrmAppPanels.")}loadPanel(e){return this._clientApiExecutor.executeAsync("loadPanel",()=>Object(u.b)().then(t=>{const n=e.pageInput?t.loadSidePanelWithPageInput(Object(l.e)(e.pageInput),Object(l.d)(e.pageInput),e.title,e.width,e.position,e.state,e.defaultCollapsedBehavior,e.replaceIfExisted,e.canBeClosed,e.canBeCollapsed,e.isTitleStatic,e.showTitle):t.loadSidePanelWithUrl(e.url,e.title,e.width,e.position,e.state,e.defaultCollapsedBehavior,!1,e.canBeClosed,e.canBeCollapsed,e.isTitleStatic,e.showTitle);return this._store.dispatch(n).then(e=>{const n=e.sidePanelId;return this._sidePanels[n]=new t.XrmAppPanel(this._store,this._applicationContext,n),n})}),[{name:"options",value:e,isRequired:!0},{name:"options.url_pageInput",value:e&&(e.url||e.pageInput),isRequired:!0}])}getPanel(e){return this._clientApiExecutor.execute("getPanel",()=>this._sidePanels[e],[{name:"id",value:e,isRequired:!0}])}}var p=n("3peg"),f=n("r0fD"),g=n("Sbn7"),h=n("rcL5");class m{constructor(e,t){this._clientApiExecutor=new i.b(e,"ClientApi.AppSidePanes."),this._store=e,this._context=t}getAllPanes(){return this._clientApiExecutor.execute("getAll",e=>{const t=new g.a(e),n=Object(p.a)(this._store.getState()).panes;return n.length&&n.forEach(e=>{t.add(e,new(Object(u.a)().XrmAppSidePane)(this._store,this._context,e))}),t})}getPane(e){return this._clientApiExecutor.execute("getPanel",()=>{if(Object(h.d)(this._store.getState()).panes[e])return new(Object(u.a)().XrmAppSidePane)(this._store,this._context,e)},[{name:"id",value:e,isRequired:!0}])}getSelectedPane(){return this._clientApiExecutor.execute("getSelectedPane",()=>{const e=Object(p.a)(this._store.getState()).selectedPane;return e?new(Object(u.a)().XrmAppSidePane)(this._store,this._context,e):null})}createPane(e){return this._clientApiExecutor.executeAsync("createPane",()=>Object(u.b)().then(async t=>{const n=await this._store.dispatch(t.loadSidePane(e));return new t.XrmAppSidePane(this._store,this._context,n.sidePanelId)}))}get state(){return this._clientApiExecutor.execute("state_get",()=>Object(p.b)(this._store.getState()))}set state(e){const t=1===e?"expand":"collapse";this._clientApiExecutor.execute(t,()=>this._store.dispatch(Object(f.a)(e)))}}var b=n("E5IU");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let y,_,v;function S(e){_=e}class O{constructor(e,t){Object(c.g)(e,"ClientApi.XrmApp.constructor","store"),Object(c.g)(t,"ClientApi.XrmApp.constructor","context"),this._context=t,y=e,this._clientApiExecutor=new i.b(e,"ClientApi.XrmApp.")}static getInstance(e,t){return Object(c.g)(e,"ClientApi.XrmApp.getInstance","store"),Object(c.g)(t,"ClientApi.XrmApp.getInstance","context"),v||(v=new O(e,t)),v}addGlobalNotification(e){return this._clientApiExecutor.execute("addGlobalNotification",()=>{const t=Object.assign(Object.assign({id:o.a.newGuid().guid},e),{imageSrc:e.imageSrc||e.iconResource});switch(e.type){case 1:return this._addToastNotification(t);case 2:return y.dispatch(Object(r.b)(t)).then(()=>t.id);default:return Promise.reject("Notification type is not supported")}},[{name:"options",value:e,isRequired:!0},{name:"options.type",value:null==e?void 0:e.type,isRequired:!0}])}clearGlobalNotification(e){return this._clientApiExecutor.execute("clearGlobalNotification",()=>Promise.all([y.dispatch(Object(s.removeToastNotification)(e)),y.dispatch(Object(a.b)(e))]).then(()=>{}),[{name:"id",value:e,isRequired:!0,expectedDataType:"string"}])}get sessions(){return this._clientApiExecutor.execute("sessions_get",()=>(!this._sessions&&_&&(this._sessions=new _(y,this._context)),this._sessions))}get panels(){return this._clientApiExecutor.execute("panels_get",()=>(this._panels||(this._panels=new d(y,this._context)),this._panels))}get sidePanes(){return this._clientApiExecutor.execute("sidePanes_get",()=>(this._sidePanes||(this._sidePanes=new m(y,this._context)),this._sidePanes))}async _addToastNotification(e){const t=await n.e(93).then(n.bind(null,"bvqZ"));return y.dispatch(t.addToastNotification(e)).then(()=>e.id)}getCurrentAppComponents(){return this._clientApiExecutor.execute("getCurrentAppComponents",()=>Object(b.c)(y.getState()))}}},arV0:function(e,t,n){"use strict";n.d(t,"s",(function(){return E})),n.d(t,"k",(function(){return I})),n.d(t,"t",(function(){return j})),n.d(t,"i",(function(){return P})),n.d(t,"j",(function(){return p})),n.d(t,"a",(function(){return h})),n.d(t,"e",(function(){return m})),n.d(t,"f",(function(){return b})),n.d(t,"h",(function(){return _})),n.d(t,"m",(function(){return g})),n.d(t,"o",(function(){return S})),n.d(t,"p",(function(){return O})),n.d(t,"n",(function(){return C})),n.d(t,"g",(function(){return y})),n.d(t,"b",(function(){return v})),n.d(t,"l",(function(){return f})),n.d(t,"q",(function(){return T})),n.d(t,"c",(function(){return N})),n.d(t,"d",(function(){return A})),n.d(t,"r",(function(){return w}));var r=n("oT5e"),a=(n("+nTZ"),n("jq7Z")),i=n("9fGf"),o=n("dHD5"),s=n("P6DH"),c=n("gw2m"),l=n("3/02"),u=n("Lyxw"),d=n("b8TU");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function p(e,t){var n;return null===(n=Object(a.a)(e,t))||void 0===n?void 0:n.input}function f(e,t){var n;return null===(n=Object(a.a)(e,t))||void 0===n?void 0:n.pageNotifications}function g(e,t){const n=Object(a.a)(e,t);if(n)return n.output}function h(e,t){return p(e,t.id)}function m(e,t){var n;return null===(n=Object(a.a)(e,t))||void 0===n?void 0:n.dialogOptions}function b(e,t){var n;return null===(n=p(e,t))||void 0===n?void 0:n.dialogOptions}function y(e,t){var n;return(null===(n=b(e,t))||void 0===n?void 0:n.title)||C(e,t)}function _(e,t){const n=Object(a.a)(e,t);return!(!n||!n.isDialogStatus)&&n.isDialogStatus}function v(e,t){var n,r;const a=Object(o.l)(e,t),c=Object(s.j)()(e,t,a),l=Object(i.b)(e);return null===(r=null===(n=null==c?void 0:c.CustomControls)||void 0===n?void 0:n[l.toString()])||void 0===r?void 0:r.CustomControlId}function S(e,t){var n,r;return null!==(r=null===(n=p(e,t.id))||void 0===n?void 0:n.pageType)&&void 0!==r?r:null}function O(e,t){var n;return null===(n=Object(a.a)(e,t))||void 0===n?void 0:n.__pageName}function C(e,t){var n;return null===(n=Object(a.a)(e,t))||void 0===n?void 0:n.__pageTitle}function E(e,t){const n=Object(a.a)(e,t);return null==n?void 0:n.isPageUnmounted}function I(e,t){const n=Object(a.a)(e,t);return null==n?void 0:n.metadataInputs}function w(e,t){var n;return null===(n=Object(a.a)(e,t))||void 0===n?void 0:n.alwaysRender}function j(e,t){if(!Object(u.f)(e,l.ib))return!1;const n=p(e,t);return(null==n?void 0:n.pageType)===c.a}function P(e,t){const n=Object(a.a)(e,t);return null==n?void 0:n.dataInputs}function T(e,t){const n=_(e,t),a=Object(r.b)(e,t),i=Object(d.a)(e);return n&&0===(null==a?void 0:a.type)?{height:null==i?void 0:i.deviceHeight,width:null==i?void 0:i.deviceWidth}:Object(r.d)(e,t)}function N(e,t){const n=Object(a.a)(e,t);return null==n?void 0:n.dialogContextOutputs}function A(e,t,n){var r;return null===(r=N(e,t))||void 0===r?void 0:r[n]}},b02z:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e,t,n,r){return{validate:e,errorCode:t,errorMessage:n,parameters:r}}n.d(t,"a",(function(){return r}))},b2mI:function(e,t,n){"use strict";n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return h}));var r=n("Ydwo"),a=n("504W"),i=n("UDbe"),o=n("VA/h"),s=n("jPIj"),c=n("jZCH"),l=n("qCX6"),u=n("EW4s"),d=n("bATk"),p=n("/A0C"),f=n("TFb5");function g(e,t,n,r){if(!Object(a.a)(e)){const i=e.getAttributeMetadata(t,n);if(Object(a.a)(i))n="!attr-"+t+"-"+n+"!";else if(i.get_type()===p.a.Lookup||i.get_type()===p.a.Customer||i.get_type()===p.a.Owner)n="["+n+"!id]";else if(!Object(a.a)(i.get_attributeOf())){const o=e.getAttributeMetadata(t,i.get_attributeOf());Object(a.a)(o)||o.get_type()!==p.a.Lookup&&o.get_type()!==p.a.Customer&&o.get_type()!==p.a.Owner||(i.get_type()===p.a.EntityName?(n="["+i.get_attributeOf()+"!logicalname]",Object(a.a)(r.val)||(r.val=e.getEntityMetadataByTypeCode(Number.parseInvariant(r.val)).get_logicalName())):n="["+i.get_attributeOf()+"!name]")}}return n}function h(e,t){const n=new u.a;return function(e){const t=new u.a,n=[],r=new DOMParser;for(const t of e){const e=r.parseFromString(t.get_value(),"text/xml").getElementsByTagName("entity")[0].attributes.getNamedItem("name").nodeValue;l.a.get_instance().get_offlineDataSource().isEntityAvailableForOfflineUsage(e)&&n.push(c.a.get_DefaultInstance().retrieveEntityMetadata(e,null))}return Object(o.a)(n).then(e=>{const n={};for(const t of e)n[t.get_logicalName()]=t;t.resolve(n)},e=>{t.reject(e)}),t}(e).then(o=>{const u={},p=new DOMParser;for(const h of e){const e=[];let m=null;const b=h.get_value(),y="BaseEntityAlias",_=p.parseFromString(b,"text/xml"),v=_.getElementsByTagName("entity")[0].attributes.getNamedItem("name").nodeValue;if(l.a.get_instance().get_offlineDataSource().isEntityAvailableForOfflineUsage(v)){const n=_.getElementsByTagName("attribute"),l=_.getElementsByTagName("link-entity")[0],p=_.getElementsByTagName("filter")[0],b=_.getElementsByTagName("condition")[0];Object(a.a)(b)||b.attributes.setNamedItem(s.a.createAttribute(_,"value",t.get_identifier()));for(let t=0;t<n.length;t++){const a=n[t].attributes.getNamedItem("name").nodeValue;let o=g(c.a.get_DefaultInstance().get_MetadataCache(),v,a,Object(r.a)(()=>m,e=>m=e));o=o.replace(new RegExp("[\\[\\]]","g"),""),o===a+"!id"&&e.push(new i.a(y+"."+a+"!logicalname")),o=y+"."+o,e.push(new i.a(o))}e.push(new i.a(y+"."+o[v].get_primaryIdAttribute()));let S=null;const O=Object(d.a)(null,v,!0);S=Object(a.a)(e)?O.selectAllColumns():O.selectIndexedColumnsStatement(e);const C=S.replace(new RegExp(" \\[BaseEntityAlias\\.","g")," [BaseEntityAlias].[");S=C+" as "+y;const E=Object(f.s)(l,"name"),I=Object(f.s)(l,"alias"),w="["+E+"] AS "+I+" ON (["+y+"]."+g(c.a.get_DefaultInstance().get_MetadataCache(),v,Object(f.s)(l,"to"),Object(r.a)(()=>m,e=>m=e))+" = ["+I+"]."+g(c.a.get_DefaultInstance().get_MetadataCache(),E,Object(f.s)(l,"from"),Object(r.a)(()=>m,e=>m=e)),j="["+I+"].["+Object(f.s)(b,"attribute")+"] = '"+b.attributes.getNamedItem("value").nodeValue+"' COLLATE NOCASE ",P=" JOIN "+w+" COLLATE NOCASE "+Object(f.s)(p,"type")+" (( "+j+"))) ";u[h.get_key().get_schemaName()]=S+P}n.resolve(u)}},e=>{n.reject(e)}),n}},b6oC:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("84PK"),a=n("NMtn");class i{constructor(e,t,n,r,i,o,s){this._name=null,this._privilegeId=null,this._privilegeType=0,this._canBeBasic=!1,this._canBeLocal=!1,this._canBeDeep=!1,this._canBeGlobal=!1,Object(a.d)(e,"name"),Object(a.d)(t,"privilegeId"),this._name=e,this._privilegeId=t,this._privilegeType=n,this._canBeBasic=r,this._canBeLocal=i,this._canBeDeep=o,this._canBeGlobal=s}get_privilegeId(){return this._privilegeId}get_privilegeType(){return this._privilegeType}get_privilegeTypeKey(){return i.getPrivilegeTypeKey(this.get_privilegeType())}get_canBeGlobal(){return this._canBeGlobal}getObjectData(){const e={};return e.name=this._name,e.privilegeid=this._privilegeId.getObjectData(),e.privilegetype=this._privilegeType,e.canbebasic=this._canBeBasic,e.canbelocal=this._canBeLocal,e.canbedeep=this._canBeDeep,e.canbeglobal=this.get_canBeGlobal(),e}getODataObject(){const e={};return e.Name=this._name,e.PrivilegeId=this._privilegeId.toString(),e.PrivilegeType=this._privilegeType,e.CanBeBasic=this._canBeBasic,e.CanBeLocal=this._canBeLocal,e.CanBeDeep=this._canBeDeep,e.CanBeGlobal=this.get_canBeGlobal(),e}static getPrivilegeTypeKey(e){return e.toString()}static createFromObjectData(e){const t=e.name,n=r.a.createFromObjectData(e.privilegeid),a=e.privilegetype,o=e.canbebasic,s=e.canbelocal,c=e.canbedeep,l=e.canbeglobal;return new i(t,n,a,o,s,c,l)}static createFromOData(e){const t=e.Name,n=r.a.tryCreate(e.PrivilegeId),a=e.PrivilegeType,o=e.CanBeBasic,s=e.CanBeLocal,c=e.CanBeDeep,l=e.CanBeGlobal;return new i(t,n,a,o,s,c,l)}}},b8TU:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"e",(function(){return l}));var r=n("unFF"),a=n("dbr2");function i(e){return e.deviceSize}function o(e){const t=i(e);return Math.min(t.deviceWidth,t.deviceHeight)<a.a}function s(e){const t=i(e),{deviceHeight:n}=t;return n}function c(e){const t=i(e),{deviceWidth:n}=t;return n}function l(e){const t=Object(r.a)(e);return c(e)<=t.sizes.Breakpoints.DimensionS}},bATk:function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var r=n("504W"),a=n("hgKT"),i=n("BSGX"),o=n("8N/3"),s=n("aOBz"),c=n("4Gtd"),l=n("qGFd");class u{constructor(e,t,n=l.b.OrgDb){this._query=null,this._storeName=null,this.collateNoCase=!1,this._doPaging=!1,this._offset=0,this._limit=0,this._storeDbType=l.b.OrgDb,this._query=e,this._storeName=t,this._storeDbType=n}get_storeDbType(){return this._storeDbType}set_storeDbType(e){this._storeDbType=e}get_selectJsonStatement(){return this.buildSelect(c.c+", "+c.d)+(this.get_doPaging()?" LIMIT "+this.get_limit()+" OFFSET "+this.get_offset():"")}get_selectIdStatement(){return this.buildSelect(c.c)+(this.get_doPaging()?" LIMIT "+this.get_limit()+" OFFSET "+this.get_offset():"")}get_selectCountStatement(){return this.buildSelect("COUNT(*)")}get_sqlArguments(){return this.get_whereArgs()}get_doPaging(){return this._doPaging}set_doPaging(e){return this._doPaging=e,e}get_offset(){return this._offset}set_offset(e){return this._offset=e,e}get_limit(){return this._limit}set_limit(e){return this._limit=e,e}get_whereSql(){return""}get_whereArgs(){return[]}_get_OrderBySql(){let e="";if(this._HasSortBy()){e="ORDER BY";for(let t=0;t<this._query.get_sortBy().length;++t){const n=this._query.get_sortBy()[t];e+=" ["+n.get_sortField().get_path()+"] "+(n.get_sortOrder()?"DESC":"ASC")+(t<this._query.get_sortBy().length-1?",":"")}}return e}selectAllColumns(){return this.buildSelect("*")}selectIndexedColumnsStatement(e){let t="";for(let n=0;n<e.length;++n)t+="["+e[n].get_path()+"]",n+1<e.length&&(t+=", ");return this.buildSelect(t)+(this.get_doPaging()?" LIMIT "+this.get_limit()+" OFFSET "+this.get_offset():"")}_HasSortBy(){return!!this._query&&!!this._query.get_sortBy()&&this._query.get_sortBy().length>0}buildSelect(e){let t="SELECT "+e+" FROM ["+this._storeName+"]";const n=this.get_whereSql();n&&(t+=" "+n),this.collateNoCase&&(t+=" COLLATE NOCASE");const r=this._get_OrderBySql();return r&&(t+=" "+r),t}}class d extends u{constructor(e,t){super(e,t),this._filter=null,this._filter=e.get_filter()}get_whereSql(){return"WHERE ["+this._filter.get_field().get_path()+"] = ?"}get_whereArgs(){return[this._filter.get_fieldValue()]}}var p=n("KJT0");class f extends u{constructor(e,t){super(e,t),this._filter=null,this._filter=e.get_filter()}get_whereSql(){const e=" ["+this._filter.get_field().get_path()+"] ";return"WHERE"+e+this._get_LeftOp()+" ? AND"+e+this._get_RightOp()+" ?"}get_whereArgs(){return[this._filter.get_leftBound(),this._filter.get_rightBound()]}_get_LeftOp(){let e=">";return this._filter.get_intervalType()&&this._filter.get_intervalType()!==p.a.openRight||(e+="="),e}_get_RightOp(){let e="<";return this._filter.get_intervalType()&&this._filter.get_intervalType()!==p.a.openLeft||(e+="="),e}}var g=n("uTcl"),h=n("84uC");class m extends u{constructor(e,t){super(e,t),this._filter=null,this._filter=e.get_filter()}get_whereSql(){let e;switch(this._filter.get_operatorType()){case 0:e=this._filter.get_borderType()===g.a.closed?">=":">";break;case h.a.lessThan:e=this._filter.get_borderType()===g.a.closed?"<=":"<";break;default:throw Error.invalidOperation("OperatorType is not supported.")}return"WHERE ["+this._filter.get_field().get_path()+"] "+e+" ?"}get_whereArgs(){return[this._filter.get_borderValue()]}}class b extends u{constructor(e,t){super(e,t),this._filter=null,this._filter=e.get_filter()}get_selectJsonStatement(){return this.buildSelect(c.c+", "+c.d)}get_selectIdStatement(){return this.buildSelect(c.c)}selectIndexedColumnsStatement(e){let t="";for(let n=0;n<e.length;++n)t+="["+e[n].get_path()+"]",n+1<e.length&&(t+=", ");return this.buildSelect(t)}get_whereSql(){let e="WHERE ["+this._filter.get_field().get_path()+"] "+this._get_InOp()+" (",t="";for(let n=this._get_InStartIndex();n<this._get_InEndIndex();n++)e+=t+this._get_InPlaceholder(),t=",";return e+=")",e}get_whereArgs(){const e=[];for(let t=this._get_InStartIndex();t<this._get_InEndIndex();t++)e.push(this._filter.get_inValues()[t]);return e}_get_InStartIndex(){return this.get_doPaging()?this.get_offset():0}_get_InEndIndex(){return this.get_doPaging()&&this.get_offset()+this.get_limit()<this._filter.get_inValues().length?this.get_offset()+this.get_limit():this._filter.get_inValues().length}_get_InPlaceholder(){return"?"}_get_InOp(){return"IN"}}function y(e,t,n){let c=null;return e&&e.get_filter()?e.get_filter()instanceof i.a?c=new d(e,t):e.get_filter()instanceof o.a?c=new f(e,t):e.get_filter()instanceof s.a?c=new m(e,t):e.get_filter()instanceof a.a&&(c=new b(e,t)):c=new u(e,t),Object(r.a)(n)||n||(c.collateNoCase=n),c}},bEud:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.unknown=-1]="unknown",e[e.referencing=0]="referencing",e[e.referenced=1]="referenced"}(r||(r={}))},bJSG:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="Field.Information.SelectParent",a="Field.Information.IncompleteChain",i=[r,a]},bK23:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return g}));var r,a=n("504W"),i=n("NMtn"),o=n("zsAz");!function(e){e[e.Svg=0]="Svg"}(r||(r={}));const s=String.format("{0}.{0}.{0}.{0}","(?:[0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])"),c=String.format("(?:{0}|{1}|{2})*","[A-Za-z0-9-\\._~]","%[A-Fa-f0-9][A-Fa-f0-9]","[!\\$&'\\(\\)\\*\\+,;=]"),l=String.format("({0}|{1})",s,c),u=String.format("((?:{0}|{1}|{2}|:)*)","[A-Za-z0-9-\\._~]","%[A-Fa-f0-9][A-Fa-f0-9]","[!\\$&'\\(\\)\\*\\+,;=]"),d=String.format("^(?:{0}@)?{1}(?::([0-9]*))?$",u,l),p=new RegExp("^(?:([^:/?#]+):)?(?://([^/?#]*))?([^?#]*)(?:\\?([^#]*))?(?:#(.*))?$"),f=new RegExp(d);class g{constructor(e){if(this._originalString=null,this._scheme=null,this._authority=null,this._host=null,this._port=null,Object(i.c)(e,"uri"),!p.test(e))throw Error.format("Input string is not a valid URI: "+e);const t=p.exec(e);if(this._originalString=e,this._scheme=t[1],this._authority=t[2],!Object(a.b)(this._authority)){if(!f.test(this._authority))throw Error.format("Input string is not a valid URI: "+e);const t=f.exec(this._authority);this._host=t[2],this._port=t[3]}}get_originalString(){return this._originalString}get_scheme(){return this._scheme}get_host(){return this._host}get_port(){return this._port}toString(){return this.get_originalString()}static createDataUri(e,t,n="base64"){let a;switch(e){case r.Svg:a="image/svg+xml";break;default:throw Object(o.d)("Unexpected URI Mime Type")}return new g(`data:${a};${n},${t}`)}}g.uriSchemeHttps="https"},bRS5:function(e,t,n){"use strict";n.d(t,"c",(function(){return P})),n.d(t,"b",(function(){return T})),n.d(t,"a",(function(){return N})),n.d(t,"d",(function(){return x})),n.d(t,"e",(function(){return M}));var r=n("Ae6N"),a=n("umme"),i=n("84PK"),o=n("504W"),s=n("Div0"),c=n("VA/h"),l=n("LFDu"),u=n("l3Ef"),d=n("03Hu"),p=n("ZJD9"),f=n("thzq"),g=n("WWG3"),h=n("HYaY"),m=n("WRF3"),b=n("IvgJ"),y=n("KLhE"),_=n("sdkC"),v=n("MUIu"),S=n("T544"),O=n("jZCH"),C=n("EW4s"),E=n("lR0U"),I=n("/A0C"),w=n("ufH1");let j=null;function P(){j=new l.a,j.initialize(),Object(E.d)(j)}function T(e,t,n){const r=new C.a;return O.a.get_DefaultInstance().retrieveMultipleAttributeMetadata(new S.a(e.get_identifier().LogicalName,t),null).then(a=>{for(const r of a){const a={};switch(r.get_logicalName()){case u.ab:if(n.get_hasStateCode()&&(a[u.db]=Object(o.a)(r.get_defaultFormValue())?0:r.get_defaultFormValue(),e.initializeValue(r.get_logicalName(),b.a.createFromObjectData(a),I.a.State)),-1!==t.indexOf(u.bb)&&!Object(o.a)(e.getFieldObjectData(u.ab))){const t=e.getFieldObjectData(u.ab)[u.db],n=r.get_optionSet().get_options()[t.toString()].get_defaultStatus();a[u.db]=n,e.initializeValue(u.bb,b.a.createFromObjectData(a),I.a.Status)}break;case u.bb:break;case u.p:case u.M:a[r.get_logicalName()]=new Date(Date.now()),e.initializeValue(r.get_logicalName(),a[r.get_logicalName()],I.a.DateTime);break;case u.o:case u.L:case u.Q:r.get_logicalName()===u.Q&&n.get_ownershipType()!==y.a.userOwned||(a[u.B]=d.a.get_DefaultInstance().get_offlineTypescriptInterface().getUserId().getObjectData(),a[u.J]=u.cb,a[u.a]=d.a.get_DefaultInstance().get_offlineTypescriptInterface().getUserName(),e.initializeValue(r.get_logicalName(),m.a.createFromObjectData(a),I.a.Lookup));break;default:r.get_type()!==I.a.PickList||Object(o.a)(r.get_defaultFormValue())||(a[u.db]=r.get_defaultFormValue(),e.initializeValue(r.get_logicalName(),b.a.createFromObjectData(a),r.get_type())),r.get_type()||(a[u.db]=Object(o.a)(r.get_defaultFormValue())?r.get_defaultValue()?1:0:r.get_defaultFormValue(),e.initializeValue(r.get_logicalName(),b.a.createFromObjectData(a),r.get_type()))}}r.resolve(e)},e=>{r.reject(e)}),r}function N(e,t,n,r,a,s=!1){let l={};const d={},p=new C.a,f=new _.a(new Array(0));let g,b=i.a.get_empty();const y=[];for(const r in e){const c={key:r,value:e[r]};c.key===n.get_primaryIdAttribute()?b=i.a.tryCreate(c.value.toString().toUpperCase()):c.key===n.get_primaryNameAttribute()&&(g=c.value);const p=c.key.split(u.l),f=Object(o.a)(p[0])?"":p[0],h=2!==p.length||Object(o.a)(p[1])?"":p[1];y.push(A(l,d,t[f],f,h.toLowerCase(),c.value,n.get_logicalName(),a,null,s))}return Object(c.a)(y).then(()=>{const e=new m.a(n.get_logicalName(),b,g);n.get_isOptimisticConcurrencyEnabled()&&u.fb in l&&!Object(o.a)(l[u.fb])&&e.setValue(u.Z,l[u.fb].toString()),l=function(e,t){const n={};for(const r in e){const a={key:r,value:e[r]};switch(t[a.key]){case I.a.Owner:case I.a.Customer:case I.a.Lookup:Object(o.a)(a.value[u.B])?n[a.key]=null:n[a.key]=h.a.createSingleFieldFromObjectData(a.value,t[a.key]);break;default:n[a.key]=h.a.createSingleFieldFromObjectData(a.value,t[a.key])}}return n}(l,t);const a=new h.a(e,l,t,d,{},f);a.set_clientRetrieveOptions(r),p.resolve(a)},e=>{p.reject(e)}),p}function A(e,t,n,c,l,d,p,f,h,m=!1){const b=new C.a;if(!x(n))return b.resolve();if(p===u.d&&c===u.Q)return b.resolve();const y=j.isComplexAttribute(n),_=j.getAttributeType(n,l);if(y)switch(c in e||(e[c]={}),_===i.a?e[c][l]=Object(o.a)(d)||i.a.isNullOrEmpty(d.toString())?null:{rawguid:d.toString()}:Object(o.b)(l)||(e[c][l]=d),n){case I.a.Owner:case I.a.Lookup:case I.a.Customer:O.a.get_DefaultInstance().retrieveMultipleAttributeMetadata(new S.a(p,[c]),null).then(t=>{if(t&&t.length>0){const n=t[0];Object(o.a)(n)||Object(o.a)(n.get_targets())||1!==n.get_targets().length||(e[c][u.J]=n.get_targets()[0]),b.resolve()}else b.reject(a.a.FromMessage("AttributeMetadata not found for "+c))},e=>{b.reject(e)});break;case I.a.AliasedValue:if(Object(o.a)(d))b.resolve();else if(!Object(o.a)(f))if(c in f){const n=f[c],r=n[u.h],a=n[u.i],i=[a];e[c][u.r]=r,e[c][u.j]=a,O.a.get_DefaultInstance().getAttributeTypes(r,i,null).then(n=>{a in n&&(e[c][u.k]=n[a],A(e,t,n[a],a,l,d,r,null,c).then(()=>{b.resolve()},e=>{b.reject(e)}))},e=>{b.reject(e)})}else b.reject(a.a.FromMessage("AttributeMetadata not found for "+c));break;default:b.resolve()}else switch(n){case I.a.PickList:case I.a.State:case I.a.Status:case I.a.Boolean:case I.a.DateTime:!Object(o.a)(d)||m&&void 0!==d?O.a.get_DefaultInstance().retrieveMultipleAttributeMetadata(new S.a(p,[c]),null).then(i=>{if(i&&i.length>0){const a=i[0];if(n===I.a.DateTime)D(t,c,null,h),R(e,c,(null==d?void 0:d.toString().length)>0?Object(v.b)(d.toString()):null,h),Object(o.a)(d)||Object(o.a)(a)||Object(o.a)(e[c])||(a.get_behavior()===r.a.UserLocal||a.get_behavior()===r.a.TimeZoneIndependent?D(t,c,g.a.get_instance().formatShortDateTimeValue(new Date(Date.parse(e[c])),a.get_behavior()),h):a.get_behavior()===r.a.DateOnly&&D(t,c,g.a.get_instance().formatShortDateValue(new Date(Date.parse(e[c])),r.a.DateOnly),h));else{let t="";if(null===d)t=void 0;else if(Object(o.a)(a)||Object(o.a)(a.get_optionSet())||Object(o.a)(a.get_optionSet().get_options())||!(d.toString()in a.get_optionSet().get_options())){const e=Object(o.a)(a)?"attributemetadata is null ":Object(o.a)(a.get_optionSet())?"attributemetadata.OptionSet is null ":Object(o.a)(a.get_optionSet().get_options())?"attributemetadata.OptionSet.Options is null ":"attributemetadata.OptionSet.Options does not contain option for given value : "+d;Object(w.e)("Entitybuilder.FillColumnValue",s.a.offlineDataStore,e+", entitylogicalname = "+p+", attributeType = "+n)}else t=a.get_optionSet().get_options()[d.toString()].get_Label();R(e,c,{value:null===d?null:Number.parseInvariant(d.toString()),label:t},h)}b.resolve()}else b.reject(a.a.FromMessage("AttributeMetadata not found for "+c))},e=>{b.reject(e)}):(Object(w.e)("Entitybuilder.FillColumnValue",s.a.offlineDataStore,"Value is null for entitylogicalname = "+p+", attributeType = "+n),R(e,c,null,h),b.resolve());break;case I.a.MultiSelectPickList:!m||null!==d&&""!==d.toString()?(Object(o.a)(d)||Object(o.b)(d.toString()))&&(d=null):d=[],R(e,c,d,h),b.resolve();break;case I.a.UniqueIdentifier:R(e,c,Object(o.a)(d)||Object(o.b)(d.toString())?null:{rawguid:d.toString()},h),b.resolve();break;case I.a.EntityName:Object(o.a)(d)?(R(e,c,null,h),b.resolve()):O.a.get_DefaultInstance().retrieveEntityMetadata(d.toString(),null).then(n=>{Object(o.a)(n)||(R(e,c,n.get_logicalName(),h),D(t,c,n.get_displayName(),h)),b.resolve()},e=>{b.reject(e)});break;default:Object(o.a)(d)||Object(o.b)(d.toString())?R(e,c,null,h):R(e,c,d,h),b.resolve()}return b}function R(e,t,n,r){Object(o.a)(r)||Object(o.a)(e[r])?e[t]=n:e[r][u.db]=n}function D(e,t,n,r){Object(o.a)(r)?e[t]=n:e[r]=n}function x(e){switch(e){case I.a.Unknown:case I.a.Decimal:case I.a.Double:case I.a.Integer:case I.a.Memo:case I.a.Money:case I.a.String:case I.a.UniqueIdentifier:case I.a.BigInt:case I.a.Owner:case I.a.Customer:case I.a.Lookup:case I.a.DateTime:case I.a.PickList:case I.a.State:case I.a.Status:case I.a.Boolean:case I.a.EntityName:case I.a.AliasedValue:case I.a.MultiSelectPickList:case I.a.File:case I.a.Image:return!0;default:return!1}}function M(e,t,n,r,a){const i=new C.a,s=p.a.get_createDefaultValues();s.push(u.fb);const l=s.indexOf(u.Q);if(l>=0&&s.splice(l,1),n===f.a.Create){const n=[];for(const a of e.get_fieldNames())s.indexOf(a)<0&&n.push(k(e,t[a],r,a));n.length<=0?i.resolve(e):Object(c.a)(n).then(()=>{i.resolve(e)},e=>{i.reject(e)})}else if(n===f.a.Update){const n=[];for(const i of e.get_fieldNames())if(s.indexOf(i)<0){const s=t[i];if(Object(o.a)(s)||s!==I.a.Lookup&&s!==I.a.Customer&&s!==I.a.Owner)Object(o.a)(s)||s!==I.a.Image?r[i]!==a[i]&&e.get_changedFieldNames().push(i):n.push(F(e,r,a,i));else{const t=i+"!id";r[t]!==a[t]&&e.get_changedFieldNames().push(i)}}n.length<=0?i.resolve(e):Object(c.a)(n).then(()=>{i.resolve(e)},e=>{i.reject(e)})}else i.resolve(e);return i}function F(e,t,n,r){const a=new C.a;return O.a.get_DefaultInstance().retrieveMultipleAttributeMetadata(new S.a(e.get_identifier().LogicalName,[r]),null).then(i=>{if(i&&i.length>0){const a=i[0];if(!Object(o.a)(a)){const i=a.get_attributeOf();t[i]!==n[i]&&e.get_changedFieldNames().push(r)}}a.resolve(!0)},e=>{a.reject(e)}),a}function k(e,t,n,r){const i=new C.a;if(Object(o.a)(t)||t!==I.a.Lookup&&t!==I.a.Customer&&t!==I.a.Owner)if(Object(o.a)(n[r]))i.resolve(!0);else{const n=t===I.a.Status?u.ab:r;O.a.get_DefaultInstance().retrieveMultipleAttributeMetadata(new S.a(e.get_identifier().LogicalName,[n]),null).then(n=>{if(n&&n.length>0){const a=n[0];if(t===I.a.Boolean||t===I.a.PickList||t===I.a.State){const t=e.getValue(r).get_value();if(!(Object(o.a)(a)||Object(o.a)(a.get_defaultValue())&&Object(o.a)(a.get_defaultFormValue()))){if((Object(o.a)(a.get_defaultFormValue())?a.get_defaultValue()?1:0:a.get_defaultFormValue())===t)return void i.resolve(!0)}}else if(t===I.a.Status&&!Object(o.a)(a)){const t=e.getValue(u.ab).get_value(),n=a.get_optionSet().get_options()[t.toString()].get_defaultStatus();if(e.getValue(r).get_value()===n)return void i.resolve(!0)}e.get_changedFieldNames().push(r),i.resolve(!0)}else i.reject(a.a.FromMessage("AttributeMetadata not found for "+r+" in  entity "+e.get_identifier().get_identifier()))},e=>{i.reject(e)})}else{const t=function(e,t){const n=t[e+"!id"],r=t[e+"!logicalname"],a=t[e+"!name"];if(!Object(o.a)(n)&&!Object(o.a)(r))return Object(o.a)(a)?new m.a(r.toString(),n):new m.a(r.toString(),n,a.toString());return null}(r,n);Object(o.a)(t)||e.get_changedFieldNames().push(r),i.resolve(!0)}return i}},bT7G:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"d",(function(){return c})),n.d(t,"c",(function(){return l})),n.d(t,"e",(function(){return u})),n.d(t,"f",(function(){return p})),n.d(t,"h",(function(){return f})),n.d(t,"i",(function(){return g})),n.d(t,"g",(function(){return d}));var r=n("odYE"),a=n("Dea/"),i=n("5Oca");function o(e){const t=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e){return e&&e.data&&void 0!==e.data.lastSnapshotNumber?e.data.lastSnapshotNumber:null}(e);return null===t?0:t+1}function s(e,t){return e&&e.data&&e.data.snapshots&&t&&e.data.snapshots.hasOwnProperty(t)?e.data.snapshots[t]:null}function c(e,t){var n;const r=s(e,t);if(r){return`${r.mode===a.a.Create?"Create":"Update"}-${(null===(n=r.identifier)||void 0===n?void 0:n.etn)||"Unknown"}`}return null}function l(e,t){if(!e||!e.data||!e.data.snapshots)return null;const n=Object.keys(e.data.snapshots).filter(n=>r.a.equals(e.data.snapshots[n].identifier,t));return n&&n.length>0?e.data.snapshots[n[n.length-1]]:null}function u(e,t,n,r){const a=s(e,t);if(a){const e=a.activeChanges?a.activeChanges[r]:a.lockedChanges?a.lockedChanges[r]:null;if(e)return e}return Object(i.j)(e,n,r)}function d(e,t,n){const r=s(e,t);return!!r&&(r.activeChanges&&null!=r.activeChanges[n])}function p(e,t,n){const r=s(e,t);return!(!r||!r.activeChanges)&&r.activeChanges.hasOwnProperty(n)}function f(e,t){const n=s(e,t);return!(!n||!n.activeChanges)}function g(e,t,n,r,a){const i={initialized:n.initialized,identifier:r,fields:{}};if(n)for(const n of a)i.fields[n]=u(e,t,r,n);return i}},bUa6:function(e,t,n){"use strict";n.d(t,"a",(function(){return k}));var r=n("mMyr"),a=n("u+q+"),i=n("pF61"),o=n("kXuq"),s=n("/to1"),c=n("q441"),l=n("wipL"),u=n("Afz2"),d=n("FhVi"),p=n("3rse"),f=n("nJrx");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const g=Object(f.a)(),h=Object(f.a)(),m={margin:"auto"};function b(e,t){return{display:"flex",flexDirection:"column",alignSelf:"flex-end",justifyContent:"flex-end",margin:"auto",boxSizing:"border-box",padding:t?e.sizes.Measures.Measure100:e.sizes.Measures.Measure150,width:"40rem",maxWidth:"100vw",maxHeight:"80vh",border:e.borders.Border01,boxShadow:e.shadows.Shadow01,backgroundColor:e.colors.BaseColor.White}}function y(e){const t={lineHeight:e.sizes.Measures.Measure250,position:"relative"};return Object.assign(Object.assign({},e.buttons.ActionIconButton01),t)}function _(e){return{color:e.colors.BaseColor.Grey.Grey6,fontSize:e.fontSizes.Font100,textAlign:"center"}}class v extends r.Component{constructor(e){super(e),this._onClickHandler=this._onClickHandler.bind(this),this._onKeyDownHandler=this._onKeyDownHandler.bind(this)}componentDidMount(){document.addEventListener("keydown",this._onKeyDownHandler)}componentWillUnmount(){document.removeEventListener("keydown",this._onKeyDownHandler)}_onKeyDownHandler(e){e.keyCode===p.a.Escape&&(e.stopImmediatePropagation(),this._onClickHandler())}_onClickHandler(){this.props.onOkHandler&&this.props.onOkHandler()}render(){if(!this.props.errorPopupDescriptor)return null;const{theme:e,isViewportSmall:t}=this.props,n=Object.assign(Object.assign({},e.buttons.Button01Primary),function(e,t){return{alignSelf:t?"stretch":"flex-end",flexShrink:0,marginTop:e.sizes.Measures.Measure125}}(e,t));return this._previousTheme!==this.props.theme&&(this._previousTheme=this.props.theme,this._closeButtonDescriptor={closeErrorPopup:this._onClickHandler,errorPopupCloseIconButtonStyle:y(e),errorPopupCloseIconStyle:_(e)}),r.createElement(o.a,{id:g,style:b(e,t),role:u.b,labelledByElementId:l.b,describedByElementId:l.a},r.createElement(d.a,{key:"errorPopupAccessibility",rootElementId:g,isModal:!0,defaultFocusId:h,overrideFocusId:h,shouldManageFocus:!0}),r.createElement(l.c,{errorDescriptor:this.props.errorPopupDescriptor,inlineDisplay:!0,closeButtonDescriptor:this._closeButtonDescriptor,dynamicHelpOptions:this.props.dynamicHelpOptions,openURL:this.props.openURL}),r.createElement(c.a,{key:"basic-error-okButton",id:h,onClick:this._onClickHandler,style:n,accessibilityLabel:this.props.okButtonLabel},r.createElement(s.a,{style:m},this.props.okButtonLabel)))}}var S=n("vIHs"),O=n("unFF"),C=n("huli"),E=n("b8TU"),I=n("QBtP"),w=n("NjDY"),j=n("IqkD"),P=n("69Qu"),T=n("gQ5I"),N=n("aOhN"),A=n("Knfm"),R=n("GEbX"),D=n("QbIY");var x=n("d4He");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const M={display:"flex",flexDirection:"column",height:"100%",flexGrow:1};class F extends r.Component{constructor(e){super(e),this.state={errorPopupData:null}}componentDidMount(){this._getErrorPopupDescriptor(this.props);const e=C.findDOMNode(this);if(e){const t=e.style.opacity;e.style.opacity="1",e.style.opacity=t}}_getErrorPopupDescriptor(e){const t=this.context.EventManager.getActivityId(),n=this.context.EventManager.getCurrentSessionId();this.props.getErrorPopupData(e.error,t,n).then(e=>{this.setState({errorPopupData:e})})}render(){const e=this.state.errorPopupData;return e?(this.props.dynamicHelpOptions&&(this.props.dynamicHelpOptions.helpLabel=e.helpLinkLabel),r.createElement(o.a,{style:M},r.createElement(v,{errorPopupDescriptor:e.errorPopupDescriptor,theme:this.props.theme,isViewportSmall:this.props.isViewportSmall,okButtonLabel:e.okButtonLabel,onOkHandler:this.props.closePage,dynamicHelpOptions:this.props.dynamicHelpOptions,openURL:this.props.openURL}))):null}}F.contextType=I.a;const k=Object(a.a)((function(e,t){const n=t.error||Object(i.i)(e),r=Object(O.a)(e),a=Object(E.c)(e),o=function(e,t,n){var r,a,i,o;if(Object(P.b)(e)){const t=Object(w.E)(e);return{errorRegion:null==n?void 0:n.name,errorCode:null===(a=null===(r=n)||void 0===r?void 0:r.errorCode)||void 0===a?void 0:a.toString(),serverVersion:t.serverVersion,orgId:null===(i=t.organizationId)||void 0===i?void 0:i.guid,isOnPrem:null===(o=Object(j.x)(e))||void 0===o?void 0:o.usePathBasedUrls}}return null}(e,t.pageId,t.error);return{error:n,theme:r,isViewportSmall:a<=r.sizes.Breakpoints.DimensionS,dynamicHelpOptions:o}}),(function(e,t){return{closePage:()=>{var n;e((n=t.pageId,{type:"error.page.okay.action",execute:({dispatch:e,getState:t},r)=>Object(A.a)(t())===R.a.SingleSession&&r.Router.getHistoryManager().GetHistoryLength()<=1&&n===Object(i.c)(t())?e(Object(D.a)({replaceState:!0})):e(n?Object(T.e)(n):Object(N.b)(n))}))},getErrorPopupData:(t,n,r)=>e({type:"GET_ERROR_POPUP_DATA",execute:({getState:a})=>Object(S.a)(t,e,a,{activityId:n,sessionId:r})}),openURL:t=>e(Object(x.a)(t))}}))(F)},baQL:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * The unique name of the Query page module.
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="Query"},bfoP:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n("pJDo"),a=n("B65h"),i=n("TEuE"),o=n("fMBw"),s=n.n(o);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const c=["PerformanceInterface","PerformanceWidget","PerformanceWidgetTab","PerformanceTimelineControl","TimelinePicker","Draggable","PerformanceTimelineScrubber","PerformanceTimelineView","TinyTimelineView","TimelineEventInformation","PerformanceTooltip","TimelineExportButton"];function l(){for(;Object(i.g)();)Object(i.c)();const e=new r.AggregationTransport;return s.a.registerTransport(e),()=>{const t=new a.PerformanceTimeline(e.getEvents()),n=[];return t.getEvents().forEach(e=>{if(e.name.indexOf("[update]")>-1){const t=e.name.split(" ")[0];-1===c.indexOf(t)&&-1===n.indexOf(t)&&n.push(t)}}),s.a.removeTransport(e),n.sort()}}},bi9n:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="dataSnapshot.updateMode";function a(e,t){return{type:r,payload:t,meta:e}}},bktA:function(e,t,n){"use strict";n.d(t,"b",(function(){return p})),n.d(t,"a",(function(){return d}));var r=n("kAKO"),a=n("3/02"),i=n("Lyxw"),o=n("UAw+"),s=n("oT5e"),c=n("Z9sG"),l=n("yHIv"),u=n("w1eR");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const d="HardReloadHandler";function p(){return{diagnosticName:"RouterHardReloadHandler",boot:(e,t,n)=>{if(Object(i.f)(n.getState(),a.i)){const e=new c.a(t,n);if(e.isOperationAvailable("reloadWebView")){const r=d+".globalOnPreNavigation";t.Router.addGlobalOnPreNavigation(async c=>{var l;try{const u=n.getState(),d=c.getEventArgs();if(function(e,t){var n;const r=Object(s.i)(e,null===(n=null==t?void 0:t.navigationOptions)||void 0===n?void 0:n.targetBrowsingContext);return Object(o.a)(e)||Object(i.f)(e,a.md)&&0!==r&&r%function(e){let t=0;Object(i.f)(e,a.nd)&&(t+=1);Object(i.f)(e,a.od)&&(t+=2);Object(i.f)(e,a.pd)&&(t+=4);Object(i.f)(e,a.qd)&&(t+=8);Object(i.f)(e,a.rd)&&(t+=16);return t}(e)==0}(u,d)){if(!(null===(l=null==d?void 0:d.navigationOptions)||void 0===l?void 0:l.source)){t.RestoreStateManager.persistState();const n=[];t.EventManager.ReportComponentSuccess(r,n);const a=null==d?void 0:d.pageUrl;await e.reloadWebView(a)}}}catch(e){t.EventManager.ReportComponentFailure(r,e)}})}}},supportedClientHostTypes:[u.a.MobileApplication.toString()],supportedPageTypes:l.b,priority:r.a.Normal}}},bo6D:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="contextualHelpBrowser.open";function a(e){return{type:r,payload:{url:e}}}},bpBl:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e.expanded="expanded",e.collapsed="collapsed",e.floating="floating"}(r||(r={}))},bqQC:function(e,t,n){"use strict";function r(e){var t,n=e.Symbol;return"function"==typeof n?n.observable?t=n.observable:(t=n("observable"),n.observable=t):t="@@observable",t}n.d(t,"a",(function(){return r}))},bsQO:function(e,t,n){"use strict";n.d(t,"b",(function(){return f})),n.d(t,"a",(function(){return g})),n.d(t,"c",(function(){return h}));var r=n("5ylf"),a=n("SZCI"),i=n("3ZMs"),o=n("SSL+"),s=n("zI6t"),c=n.n(s),l=n("5UJb"),u=n.n(l);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
let d=!1,p=!1;function f(){d=!0}function g(){p=!0}function h(e){u.a.subscribeToAppWorking(()=>{c.a.onNextIdleProcessing(()=>{e&&c.a.addMetadataToTimeline({telemetryActivityId:e.getActivityId()})})}),u.a.isAppIdle()||c.a.onNextIdleProcessing(()=>{e&&c.a.addMetadataToTimeline({telemetryActivityId:e.getActivityId()})}),c.a.addTimelineProcessor(e=>{p&&function(e){const t={"MscrmControls.FieldControls.SimpleLookupControl":2,"MscrmControls.FieldControls.DateTimeControl":2,"MscrmControls.FieldControls.EmailAddressControl":2,"MscrmControls.Containers.QuickForm":2,"MscrmControls.WebResource.WebResourceHtmlControl":2,"MscrmControls.TimelineWallControl.TimelineWall":-1,"MscrmControls.CardFeedContainer.CardFeedContainer":-1,"MscrmControls.Grid.ReadOnlyGrid":-1},n=e.getEvents().filter(e=>e.zone===a.f&&e.name===a.r),r={};for(const e of n){const t=e.parameters[a.q];t in r?c.a.logPerformanceIssue({type:i.PerformanceIssueType.ExcessiveRendering,level:i.PerformanceIssueLevel.Warning,message:"Control initialized more than once during form load",parameters:[t,e.parameters[a.s]]}):r[t]=1}const o=e.getEvents().filter(e=>e.zone===a.f&&e.name===a.t).reduce((e,t)=>{const n=t.parameters[a.q];return e[n]?e[n].updateCount++:e[n]={manifestControlName:t.parameters[a.s],updateCount:1},e},{});for(const e in o){const n=o[e];let r=t[n.manifestControlName]||1;const a=o[e+".fieldControl"];a&&(r=a.updateCount),-1!==r&&n.updateCount!==r&&c.a.logPerformanceIssue({type:i.PerformanceIssueType.ExcessiveRendering,level:i.PerformanceIssueLevel.Warning,message:"Excessive rendering during form load",parameters:[e,n.manifestControlName,n.updateCount.toString()]})}}(e),function(e){const t=e.getNetworkRequests(),n=e.filter(e=>e.zone===a.G&&("CrmSoapServiceCall"===e.name||e.name===a.z)).getEvents();t.forEach(e=>{const t=e.parameters[r.RESOURCE_NAME],a=n.findIndex(e=>-1!==t.indexOf(e.parameters.requestName));void 0!==a?n.splice(a,1):c.a.logPerformanceIssue({type:i.PerformanceIssueType.ExternalNetworkRequest,level:i.PerformanceIssueLevel.Warning,message:"External request detected",parameters:[t]})})}(e),d&&(!function(e){const t=e.getNetworkRequests().reduce((e,t)=>(Object(o.b)(t.parameters[r.RESOURCE_NAME])&&e.push(t.parameters[r.RESOURCE_NAME]),e),[]);t.length>0&&c.a.logPerformanceIssue({type:i.PerformanceIssueType.MetadataCallDuringWarmLoad,level:i.PerformanceIssueLevel.Warning,message:"Metadata calls during warm load",parameters:t.sort()})}(e),d=!1)})}},bwbe:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return u})),n.d(t,"f",(function(){return d})),n.d(t,"e",(function(){return f})),n.d(t,"d",(function(){return p}));var r=n("E5IU"),a=n("SAYH"),i=n("5bWN"),o=n("84PK"),s=n("pgj4");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const c="recentItems.populateState",l="systemform",u="userform";function d(){return{type:"recentItems.retrieve.async",execute:({dispatch:e,getState:t},n)=>function(e,t,n,a,c,l,u,d){const f=Object(r.d)(a),g=Object(s.a)(f),h=o.a.tryCreate(Object(r.k)(a));return e.getRecentItems(h,g,c,l,u,d,null).nativePromise().then(m,b);function m(e){const t=[];return e.forEach(e=>{const r=p(e);Object(i.a)(r,n)&&t.push(r)}),t}function b(e){return n.TraceManager.getTracer("Recents").error("Retrieving recent items from data source failed with error: "+e.get_Message()),Promise.reject(e)}}(n.DataSource,0,n,t())}}function p(e){var t;return{LastAccessed:(t=e.LastAccessedStr,t?new Date(t+" UTC"):null),ObjectId:function(e){return e?new a.a(e):null}(e.ObjectId),EntityTypeName:e.EntityTypeName,PinStatus:e.PinStatus,RecordType:e.RecordType,IsUserView:e.IsUserView,Title:e.Title,IconPath:e.IconPath}}function f(e,t=[]){return{type:c,payload:{newRecents:e,oldRecents:t}}}},"c/rA":function(e,t,n){"use strict";n.d(t,"a",(function(){return le}));var r=n("mMyr"),a=n("huli"),i=n("bUa6"),o=n("oT5e"),s=n("u+q+"),c=n("QBtP"),l=n("fueu"),u=n("eIlw"),d=n("nFP/"),p=n("KOTC"),f=n("arV0"),g=n("kXuq"),h=n("Knfm"),m=n("GEbX"),b=n("SAYH"),y=n("i1f0"),_=n("O7zD"),v=n("74Tm"),S=n("HfZT"),O=n("5Oca"),C=n("q441"),E=n("xqqo"),I=n("Eqw3"),w=n("unFF"),j=n("/to1"),P=n("IqkD"),T=n("tJ+6");var N=n("WPtp"),A=n("Afz2"),R=n("iZ7K"),D=n("N2HV"),x=n("Fn63"),M=n("YxC/"),F=n("KBcj"),k=n("3rse"),L=n("FhVi"),B=n("nInZ"),U=n("+7Rg"),V=n("nJrx"),z=n("JEGW"),q=n("ruPX"),H=n("aOhN"),W=n("2YQW"),G=n("dHD5"),K=n("P6DH"),Q=n("H4dV"),X=n("Lyxw"),Y=n("3/02"),J=n("n3bs");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const $="record-set-navigator-list",Z=Object(V.a)(),ee=Object(V.a)();class te extends r.Component{constructor(e){super(e),this._nextPageNumberOffset=0,this._navigateToGridClick=this._navigateToGridClick.bind(this),this._onCloseButtonClick=this._onCloseButtonClick.bind(this),this._onScrollList=this._onScrollList.bind(this)}componentDidUpdate(e){if(this._shouldDisplayNavigator()){const t=a.findDOMNode(this.refs[$]);t&&t.addEventListener("scroll",this._onScrollList);const n=Math.floor(this.props.totalRecordCount/this.props.pageSize);this._nextPageNumberOffset=this.props.totalRecordCount%this.props.pageSize==0?n:n+1;const{id:r}=this.props.inputs;if(this.props.availableEntityRecords&&this.props.availableEntityRecords.length>0&&r)for(const e of Object.keys(this.props.availableEntityRecords)){const t=parseInt(e,10),n=ae(this.props.availableEntityRecords[t]);b.a.equals(n,r)&&(this._currentRecordIndex=t,this._previousRecordIndex=t-1,this._nextRecordIndex=t>=this.props.availableEntityRecords.length?-1:t+1)}if(0!==this.props.navigatorOpenState&&t&&this._currentRecordIndex>-1&&(0===e.navigatorOpenState||!e.recordSetQueryKey)){const e="__recordListItem"+this.props.availableEntityRecords[this._currentRecordIndex].identifier.id.guid,t=this.refs[e],n=a.findDOMNode(t),r=Q.a.getInstance();n&&(r.get_isIPad()?n.parentElement.scrollTop=n.offsetTop-n.parentElement.offsetTop:n.scrollIntoView(),n.tabIndex=0,n.focus())}}const t=document.getElementById("collapseExpandBtn");0===this.props.navigatorOpenState&&t&&t.focus()}componentWillUnmount(){const e=a.findDOMNode(this.refs[$]);e&&e.removeEventListener("scroll",this._onScrollList)}_shouldDisplayNavigator(){if(this.props.isReactInstancePageCachingEnabled&&this.props.pageType!==J.a.ENTITY_RECORD)return!1;const e=this.props.entityDetails&&this.props.entityDetails.EntityLogicalName;return("queueitem"!==e||"queueitem"===e&&this.props.isRecordSetNavigatorEnabledForQueueItem)&&0!==this.props.navigatorOpenState&&this.props.availableEntityRecords&&Object.keys(this.props.availableEntityRecords).length>1&&!(!this.props.inputs||!this.props.inputs.recordSetQueryKey)}_onScrollList(){const e=a.findDOMNode(this.refs[$]);e.clientHeight+e.scrollTop+30>=e.scrollHeight&&this._retrieveGridPage(!0)}_getEntityImageKey(e){return e+"_image"}_renderRecordListItems(){const e=this.props.entityDetails.PrimaryNameAttribute,t=this.props.entityDetails.PrimaryImageAttribute?Object(_.a)(this.props.entityDetails.PrimaryImageAttribute,null,null):null,n=this.props.inputs,a=[];for(const i of this.props.availableEntityRecords){const o={entityTypeName:re(i),id:ae(i),formId:n.formId,recordSetQueryKey:n.recordSetQueryKey},s=b.a.equals(n.id,ae(i)),c=s?Object.assign(Object.assign({},this.props.recordListItemStyle),this.props.recordListItemSelectedStyle):this.props.recordListItemStyle,l=i.fields[e],u=l?l.value:"---",d="__recordListItem"+i.identifier.id.guid,p=t&&i.fields[t]?i.fields[t].value:void 0,f=Object.assign(Object.assign(Object.assign({},this.props.recordImageStyle),{textAlign:"center",fontWeight:"bold",textTransform:"uppercase"}),s?this.props.entityImageHoveredStyle:{}),h=i.fields[e]?i.fields[e].value:null,m=this.props.hasPrimaryImageField?r.createElement(B.a,{key:this._getEntityImageKey(d),ref:this._getEntityImageKey(d),alt:u,imageSrc:p,entityPrimaryField:h,style:f,hasPrimaryImageField:this.props.hasPrimaryImageField}):null,y=Object.assign(Object.assign({},this.props.recordPrimaryNameStyle),this.props.hasPrimaryImageField?{}:{maxWidth:"185px"});a.push(r.createElement(I.a,{ref:d,id:d,key:"record"+i.identifier.id.guid,style:c,hoveredStyle:this.props.recordListItemHoverStyle,onKeyDown:this._onListItemKeyDown.bind(this,i.identifier.id,o),role:A.u,describedByElementId:s?d+"_link":"",accessibilityLabel:u,tabIndex:s?0:-1,onClick:this._onClick.bind(this,o)},r.createElement(g.a,{id:d+"_link",ref:d+"link",key:d+"link",title:h,style:this.props.recordListItemLinkStyle},m,r.createElement(g.a,{key:d+"_name_and_attributes",style:this.props.recordNameAttributeWrapperStyle},r.createElement(j.a,{key:d+"_name",style:y},u),this.renderFirstFieldForRecord(i)))))}return a}renderFirstFieldForRecord(e){const t=[],n=Object.assign(Object.assign({},this.props.recordFirstAttributeStyle),this.props.hasPrimaryImageField?{}:{maxWidth:"185px"});for(const a of this.props.firstField){const i=Object(N.c)(e.fields[a])||"---";t.push(r.createElement(j.a,{key:e.identifier.id.guid+a,style:n},i))}return t}_onListItemKeyDown(e,t,n){n.keyCode===k.a.Enter?(n.preventDefault(),this.props.navigateTo(this.props.pageName,Object.assign(Object.assign({},t),this._getSelectedEntityInfo(t))),-1!==this.props.recordSetQueryKey.indexOf("activitypointer")&&this._retrieveGridPage(!1)):this._onContentInExpandStateKeyDown(n)}_escapeKeyDown(e){e.keyCode===k.a.Escape&&2===this.props.navigatorOpenState&&this.props.toggleRecordSetNavigatorCollapsedState(!0)}_onCloseButtonClick(e){this.props.toggleRecordSetNavigatorCollapsedState(0!==this.props.navigatorOpenState)}_onClick(e,t){t.preventDefault(),this.props.navigateTo(this.props.pageName,Object.assign(Object.assign({},e),this._getSelectedEntityInfo(e))),-1!==this.props.recordSetQueryKey.indexOf("activitypointer")&&this._retrieveGridPage(!1)}_retrieveGridPage(e){const t=[];let{entityTypeName:n}=this.props.inputs;if(this.props.hasPrimaryImageField&&this.props.entityDetails&&this.props.entityDetails.PrimaryImageAttribute){const e=Object(_.a)(this.props.entityDetails.PrimaryImageAttribute,null,null);t.push(e)}const r=this.props.recordSetQueryKey&&this.props.recordSetQueryKey.split("-")[0];r&&("activitypointer"===r?n="activitypointer":"queueitem"===r&&(n="queueitem"));const a=this.props.recordSetQueryKey.replace(n,"").substring(1,37);this.props.retrieveGridPage(a,this._nextPageNumberOffset,e,t).then(t=>{e&&t&&t.lists&&t.lists[this.props.recordSetQueryKey]&&t.lists[this.props.recordSetQueryKey].records&&0!==t.lists[this.props.recordSetQueryKey].records.length&&this._nextPageNumberOffset++})}_getSelectedEntityInfo(e){return this.props.selectedEntityMap.find(t=>t.selectedEntityName===e.entityTypeName)}_renderViewTitle(){var e,t,n;const a=0===this.props.navigatorOpenState,i=null!==(n=null===(t=null===(e=this.props)||void 0===e?void 0:e.view)||void 0===t?void 0:t.title)&&void 0!==n?n:"",o=Object(M.c)(this.props.resourceStrings,U.a)+" "+Object(M.c)(this.props.resourceStrings,U.b),s=Object.assign(Object.assign({},this.props.closeButtonStyle),a?{display:"none"}:{}),c=Object(M.c)(this.props.resourceStrings,U.a);return r.createElement(g.a,{style:Object.assign(Object.assign({},this.props.viewTitleContainerStyle),a?{paddingLeft:0,paddingRight:0}:{}),key:"view-title-section"},r.createElement(C.a,{id:Z,tabIndex:0,onClick:this._navigateToGridClick,style:this.props.viewTitleButtonStyle,accessibilityLabel:i,disabled:a},r.createElement(j.a,{style:this.props.viewTitleStyle,testhooks:{id:"headerTitle"}},i.toUpperCase())),r.createElement(C.a,{id:"rsnCloseButton",key:"rsnCloseButton",title:c,accessibilityLabel:o,onClick:this._onCloseButtonClick,style:s,disabled:a},r.createElement(D.b,{style:this.props.closeButtonSymbolStyle,id:ee,type:x.a.Cancel,testhooks:{id:"recordSetNavCollapseIcon"}})))}_navigateToGridClick(e){this.props.navigateBack()}_renderContent(){var e,t,n;const{entityTypeName:a}=this.props.inputs,i=(null!==(n=null===(t=null===(e=this.props)||void 0===e?void 0:e.view)||void 0===t?void 0:t.title)&&void 0!==n?n:a)+" "+Object(M.c)(this.props.resourceStrings,U.b);return r.createElement(g.a,{id:"content-in-expand-state",style:Object.assign(Object.assign({},this.props.expandContentStyle),0===this.props.navigatorOpenState?{display:"none"}:{}),key:"content-in-expand-state"},r.createElement(E.a,{accessibilityLabel:i,key:"recordlist",style:this._transformRecordListStyle(),ref:$,testhooks:{id:"recordSetNavList"},role:A.m},this._renderRecordListItems()))}_transformRecordSetContainerStyle(){return Object.assign(Object.assign(Object.assign({},this.props.recordSetNavContainer),2===this.props.navigatorOpenState?this.props.overlayStyle:{}),0===this.props.navigatorOpenState?{display:"none"}:{})}_transformRecordListContainerStyle(){return Object.assign(Object.assign({},this.props.recordListContainerStyle),0===this.props.navigatorOpenState?this.props.recordListContainerCollapseStyle:this.props.recordListContainerExpandStyle)}_transformRecordListStyle(){return Object.assign(Object.assign(Object.assign({},this.props.recordListStyle),{listStyleType:"none"}),0===this.props.navigatorOpenState?{display:"none"}:{})}_onContentInExpandStateKeyDown(e){if(0!==this.props.navigatorOpenState){const t=this.props.availableEntityRecords.length;if(e.keyCode===k.a.DownArrow){if(e.preventDefault(),this._nextRecordIndex>-1){const e="__recordListItem"+this.props.availableEntityRecords[this._nextRecordIndex].identifier.id.guid,n=this.refs[e],r=a.findDOMNode(n);r&&(r.scrollIntoView(),r.focus(),this._nextRecordIndex=this._nextRecordIndex+1>=this.props.availableEntityRecords.length?-1:this._nextRecordIndex+1,this._previousRecordIndex=-1===this._nextRecordIndex?t-2:this._nextRecordIndex-2)}}else if(e.keyCode===k.a.UpArrow&&(e.preventDefault(),this._previousRecordIndex>-1)){const e="__recordListItem"+this.props.availableEntityRecords[this._previousRecordIndex].identifier.id.guid,t=this.refs[e],n=a.findDOMNode(t);n&&(n.scrollIntoView(),n.focus(),this._nextRecordIndex=-1===this._nextRecordIndex?this.props.availableEntityRecords.length-1:this._nextRecordIndex-1,this._previousRecordIndex=this._nextRecordIndex-2)}}}_renderInternal(){if(!this._shouldDisplayNavigator())return null;const e=Object(M.c)(this.props.resourceStrings,U.b);return r.createElement(g.a,{id:"recordSetNavContainer",key:"recordSetNavContainer",style:this._transformRecordSetContainerStyle(),onKeyDown:this._escapeKeyDown.bind(this)},r.createElement(g.a,{accessKey:this.props.accessKey,id:"recordSetNav",key:"recordSetNav",style:this._transformRecordListContainerStyle(),role:A.t,accessibilityLabel:e,testhooks:{id:"recordSetNav"}},r.createElement(L.a,{key:"recordSetNavigatorAccessibility",rootElementId:"recordSetNav",shouldManageFocus:!1}),this._renderViewTitle(),this._renderContent()))}render(){const e=r.Children.only(this.props.children);if(this.props.pageType===J.a.ENTITY_RECORD||this.props.isReactInstancePageCachingEnabled){const t=2===this.props.navigatorOpenState?[e,this._renderInternal()]:[this._renderInternal(),e];return r.createElement(g.a,{style:this.props.rootStyle},t)}return e}}function ne(e,t){const n=[];if(e&&e.grid&&e.grid.rows&&e.grid.rows.length>0){const r=e.grid.rows[0];if(r.cells){const e=r.cells;for(const r of e){if(n.length>=1)break;const e=r.name;e===t.PrimaryNameAttribute||r.isHidden||n.push(e)}}}return n}function re(e){if("activitypointer"===e.identifier.etn)return e.fields.activitytypecode.value;if("queueitem"===e.identifier.etn){const t=e.fields&&e.fields.objectid,n=t&&t.reference;if(n)return n.etn}return e.identifier.etn}function ae(e){if("queueitem"===e.identifier.etn){const t=e.fields&&e.fields.objectid,n=t&&t.reference;if(n)return n.id}return e.identifier.id}te.displayName="RecordSetNavigator";const ie=Object(s.a)((function(){let e=[],t=[],n=[],r=null,a=null,i=null;const o=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(){let e=null,t=null,n=null;return function(r,a){var i,o;const s=Object(w.a)(r),c=Object(P.g)(r),l=Object(T.b)(r)?Object(T.a)(r):null,u=null==l?void 0:l.Colors;return t===s&&n===u||(t=s,n=u,e={rootStyle:{display:"flex",flexGrow:1,position:"relative",height:"inherit",width:"inherit"},recordSetNavContainer:{display:"flex",borderRightWidth:c?void 0:"1px",borderLeftWidth:c?"1px":void 0,borderStyle:"solid",borderRightColor:c?void 0:s.colors.BaseColor.Grey.Grey4,borderLeftColor:c?s.colors.BaseColor.Grey.Grey4:void 0,transition:"0.1s ease-in-out all","-webkit-overflow-scrolling":"touch"},recordListContainerStyle:{width:s.sizes.RecordSetNavigator.width,backgroundColor:null!==(o=null===(i=null==u?void 0:u.Patterns)||void 0===i?void 0:i.Background)&&void 0!==o?o:s.colors.BaseColor.White,flexGrow:1,display:"flex",flexDirection:"column",flexWrap:"nowrap",borderStyle:"none",boxShadow:"",transition:"0.1s ease-in-out all"},recordListContainerExpandStyle:{width:s.sizes.RecordSetNavigator.width,opacity:1},recordListContainerCollapseStyle:{width:0,opacity:0},expandContentStyle:{flex:"1 0 0px",flexDirection:"column",overflow:"hidden"},recordListStyle:{display:"block",overflow:"auto",flex:"1 0 0px",marginRight:c?void 0:s.sizes.Measures.Measure025,marginLeft:c?s.sizes.Measures.Measure025:void 0,paddingRight:c?void 0:"2px",paddingLeft:c?"2px":void 0},recordListItemStyle:{display:"flex",flexDirection:"row",cursor:"pointer",height:s.sizes.RecordSetNavigator.listItemHeight,minHeight:s.sizes.RecordSetNavigator.listItemHeight,borderBottom:s.borders.Border02},recordListItemHoverStyle:{backgroundColor:s.colors.BaseColor.Grey.Grey3||"#000080"},recordListItemSelectedStyle:{backgroundColor:s.colors.MainThemeColor.MainColor2.Fill||"#000080"},recordListItemLinkStyle:{display:"flex",width:"100%",height:"100%",color:s.colors.BaseColor.Black,textDecoration:"none",padding:"0",boxSizing:"border-box"},viewTitleContainerStyle:{height:s.sizes.Measures.Measure300,lineHeight:s.sizes.Measures.Measure300,verticalAlign:"middle",flexDirection:"row",justifyContent:"space-between",paddingRight:c?s.sizes.Measures.Measure150:s.sizes.Measures.Measure125,paddingTop:s.sizes.Measures.Measure100,paddingBottom:s.sizes.Measures.Measure100,paddingLeft:c?s.sizes.Measures.Measure125:s.sizes.Measures.Measure150},viewTitleButtonStyle:{color:s.colors.BaseColor.Grey.Grey7,height:s.sizes.Measures.Measure300,lineHeight:s.sizes.Measures.Measure300,textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",borderStyle:"none",backgroundColor:"transparent",paddingLeft:0,padding:0},viewTitleStyle:{fontSize:s.fontSizes.Font100,color:s.colors.BaseColor.Grey.Grey7,textOverflow:"ellipsis",overflow:"hidden"},recordImageStyle:{height:s.sizes.Measures.Measure300,width:s.sizes.Measures.Measure300,color:s.colors.BaseColor.White,lineHeight:s.sizes.Measures.Measure300,borderRadius:s.sizes.Measures.Measure150,marginLeft:c?0:s.sizes.Measures.Measure150,marginTop:s.sizes.RecordSetNavigator.entityImageMarginTop,marginRight:c?s.sizes.Measures.Measure150:0},recordNameAttributeWrapperStyle:{display:"block",flexGrow:1,maxWidth:s.sizes.RecordSetNavigator.recordNameAttributeWrapperMaxWidth,marginLeft:c?void 0:s.sizes.Measures.Measure100,marginRight:c?s.sizes.Measures.Measure100:void 0,paddingTop:s.sizes.Measures.Measure100,paddingBottom:s.sizes.Measures.Measure100,paddingRight:c?void 0:s.sizes.Measures.Measure150,paddingLeft:c?s.sizes.Measures.Measure150:void 0,height:s.sizes.RecordSetNavigator.listItemHeight,lineHeight:s.sizes.RecordSetNavigator.listItemLineHeight,boxSizing:"border-box"},recordPrimaryNameStyle:{display:"block",color:s.colors.BaseColor.Black,fontFamily:s.fontFamilies.Regular,maxWidth:s.sizes.RecordSetNavigator.listItemTextMaxWidth,maxHeight:s.sizes.RecordSetNavigator.recordPrimaryNameMaxHeight,whiteSpace:"normal",overflow:"hidden",textOverflow:"ellipsis",height:"auto",lineHeight:s.sizes.RecordSetNavigator.listItemLineHeight},recordFirstAttributeStyle:{display:"block",color:s.colors.BaseColor.Black,maxWidth:s.sizes.RecordSetNavigator.listItemTextMaxWidth,lineHeight:s.sizes.RecordSetNavigator.listItemLineHeight,height:s.sizes.RecordSetNavigator.listItemLineHeight,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},navigateToGridTextStyle:{fontSize:s.fontSizes.Font100,color:s.colors.BaseColor.Blue.Blue3,fontFamily:s.fontFamilies.Semilight},closeButtonStyle:{cursor:"pointer",color:s.colors.BaseColor.Grey.Grey7,borderStyle:"none",backgroundColor:"transparent",height:s.sizes.Measures.Measure300,width:s.sizes.Measures.Measure300,lineHeight:s.sizes.Measures.Measure300,paddingRight:0,paddingLeft:0},closeButtonSymbolStyle:{height:"100%",width:"100%",textAlign:"center"},ariaDescribedByStyle:{display:"flex",width:"0px"},overlayStyle:{position:"absolute",height:"100%",boxShadow:s.shadows.Shadow01,borderWidth:0,left:c?void 0:0,right:c?0:void 0},entityImageHoveredStyle:{color:s.colors.BaseColor.White}}),e}}(),s=Object(M.h)();return function(c,l){var u;const d=Object(w.a)(c).sizes.Breakpoints.DimensionXL,p=Object(y.rc)(c,l),g=Object(y.Uc)(c,l),h=Object(f.a)(c,l),m=null===(u=Object(f.q)(c,l.id))||void 0===u?void 0:u.width,S=o(c,l),C=h,E=p?Object(F.c)(c,new b.a(p.replace(p.split("-")[0],"").substring(1,37)),C.isQueryMode&&C.isAdvancedFindView):null,I=E?E.entityLogicalName:"",j=Object(O.s)(c,p),P=s(c,U.c),T=Object(R.h)(c,I),N=h?h.pageType:a,A=Object(X.f)(c,Y.wf),D=Object(X.f)(c,Y.ig),x=A||D;let M=0;if(Object(v.a)(c)||(M=m&&m<d?2:1),N!==a&&(a=N),T!==r?(e=ne(E,T),r=T):0===e.length&&null!=E?e=ne(E,T):null!=p&&i!==p&&(e=ne(E,T),i=p),0!==M){const a=function(e,t,n,r,a,i){const o=[],s=[];if(n){const c=[n.PrimaryNameAttribute];a&&"activitypointer"===a?c.push("activitytypecode"):a&&"queueitem"===a&&c.push("objectid");const l=Object(O.r)(e,t,1,c,!0);if(l&&l.length)for(const t of l){if(n&&n.PrimaryImageAttribute){const r=Object(_.a)(n.PrimaryImageAttribute,null,null);t.fields[r]=Object(O.j)(e,t.identifier,r)}for(const n of r)t.fields[n]=Object(O.j)(e,t.identifier,n);const a=re(t);if(!s.find(e=>e.selectedEntityName===a)){const t=Object(G.h)(a);s.push({selectedEntityName:a,selectedTabId:Object(y.Ec)(e,i,t),selectedRelatedEntity:Object(K.jb)(e,i,t)})}o.push(t)}}return{entries:o,map:s}}(c,p,r,e,I,l),i=a.entries;let o=!1;if(i.length!==t.length)o=!0;else for(let e=0;e<i.length;e++)if(!Object(W.e)(i[e].fields,t[e].fields)){o=!0;break}o&&(t=i),function(e,t){if(e.length!==t.length)return!0;for(const n in t){const r=t[n],a=e.find(e=>e.selectedEntityName===r.selectedEntityName);if(!a||r.selectedTabId!==a.selectedTabId||r.selectedRelatedEntity!==a.selectedRelatedEntity)return!0}return!1}(n,a.map)&&(n=a.map)}const k=Object(X.f)(c,Y.gg);return{recordSetQueryKey:p,totalRecordCount:g,rootStyle:S.rootStyle,recordSetNavContainer:S.recordSetNavContainer,recordListContainerStyle:S.recordListContainerStyle,recordListContainerExpandStyle:S.recordListContainerExpandStyle,recordListContainerCollapseStyle:S.recordListContainerCollapseStyle,expandContentStyle:S.expandContentStyle,recordListStyle:S.recordListStyle,recordListItemStyle:S.recordListItemStyle,recordListItemHoverStyle:S.recordListItemHoverStyle,recordListItemSelectedStyle:S.recordListItemSelectedStyle,recordListItemLinkStyle:S.recordListItemLinkStyle,viewTitleContainerStyle:S.viewTitleContainerStyle,viewTitleButtonStyle:S.viewTitleButtonStyle,viewTitleStyle:S.viewTitleStyle,recordImageStyle:S.recordImageStyle,recordNameAttributeWrapperStyle:S.recordNameAttributeWrapperStyle,recordPrimaryNameStyle:S.recordPrimaryNameStyle,recordFirstAttributeStyle:S.recordFirstAttributeStyle,navigateToGridTextStyle:S.navigateToGridTextStyle,closeButtonStyle:S.closeButtonStyle,closeButtonSymbolStyle:S.closeButtonSymbolStyle,overlayStyle:S.overlayStyle,entityImageHoveredStyle:S.entityImageHoveredStyle,availableEntityRecords:t,inputs:h,entityDetails:T,view:E,pageSize:j,hasPrimaryImageField:T&&!!T.PrimaryImageAttribute,resourceStrings:P,firstField:e,navigatorOpenState:M,pageType:a,selectedEntityMap:n,isRecordSetNavigatorEnabledForQueueItem:x,isReactInstancePageCachingEnabled:k}}}),(function(e,t){return{retrieveGridPage:(n,r,a,i)=>e(Object(S.g)(n,r,t.id,a,i)),toggleRecordSetNavigatorCollapsedState:t=>{e(Object(z.b)(t))},navigateBack:()=>{e(Object(H.b)(t.id))},navigateTo:(n,r)=>{e(Object(q.a)(n,r,t.id))}}}))(te);var oe=n("Qjw6"),se=n("SEva");class ce extends r.Component{constructor(){super(...arguments),this._pageRef=r.createRef(),this._measuringHandlerContext={groupId:void 0}}shouldComponentUpdate(e){return e.visibility||e.visibility!==this.props.visibility}componentDidUpdate(){const e=a.findDOMNode(this._pageRef.current);e&&(this.props.visibility||"none"===e.style.display?this.props.visibility&&"none"===e.style.display&&(e.style.display=this._displayStyle):(this._displayStyle=e.style.display,e.style.display="none"))}render(){const e=this.props.component;return this.props.id!==this._measuringHandlerContext.groupId&&(this._measuringHandlerContext={groupId:this.props.id}),r.createElement(l.b.Provider,{value:this._measuringHandlerContext},r.createElement(e,{id:this.props.id,ref:this._pageRef,visibility:this.props.visibility}))}}function le(e){return r.createElement(se.a,{name:"PageHost"},function({pageId:e,isProgressIndicatorActive:t,isMainPage:n,isReactInstancePageCachingEnabled:a,isDialog:l}){const u=r.useContext(c.a).Router,d=Object(s.d)(t=>Object(o.b)(t,e)),p=Object(s.d)(e=>Object(o.f)(e)),g=!Object(s.d)(t=>Object(f.s)(t,e)),b=Object(s.d)(e=>Object(h.a)(e)),y=Object(s.d)(e=>Object(X.f)(e,Y.ib));if((null==d?void 0:d.error)&&!l)return r.createElement(i.a,{pageId:d.pageId,error:d.error});if(!e||!d)return ue(t);if(a&&n){const t=u.getAliveTemplates(e).map(e=>r.createElement(ce,{key:e.templateName,id:e.pageId,visibility:p.pageId===e.pageId,component:e.component}));return r.createElement(r.Fragment,null,...t)}const _=u.getPage(e);if(y&&n&&b===m.a.MultiSession)return r.createElement(de,{currentPageId:e,isProgressIndicatorActive:t});if(_&&g)return r.createElement(pe,{isMainPage:n,pageId:e});return ue(t)}(e))}function ue(e){return r.createElement(d.a,{key:"progressIndicator",id:"boot-loading-indicator",progressType:"ring",active:null==e||e,displayDelay:1e3,style:{display:"flex"}})}function de({currentPageId:e,isProgressIndicatorActive:t}){const n=r.useContext(c.a).Router,a=Object(s.d)(t=>Object.values(t.tabs).map(e=>Object(o.a)(t,e.id).pageId).filter(n=>e===n||Object(f.t)(t,n)));return r.createElement(r.Fragment,null,a.map(a=>n.getPage(a)?r.createElement(g.a,{key:a,style:a===e?ge:he},r.createElement(pe,{pageId:a,isMainPage:!0})):r.createElement(d.a,{key:"progressIndicator",id:"boot-loading-indicator",progressType:"ring",active:null==t||t,displayDelay:1e3,style:{display:"flex"}})))}function pe({isMainPage:e,pageId:t}){var n;const a=r.useContext(c.a).Router,i=a.getPageModuleInput(t),o=a.getPage(t),s=e&&null!=i&&null!=i.input&&null!=i.input.appshellmode?r.createElement(fe,{pageId:t,router:a}):r.createElement(o,{key:t,id:t});return r.createElement(ie,{id:t,key:"recordSetNav",pageName:oe.b.getName(),accessKey:"R",arialControls:"tab-section"},r.createElement(u.a,{key:t,pageId:t,pageType:null===(n=null==i?void 0:i.input)||void 0===n?void 0:n.pageType},s))}function fe({pageId:e,router:t}){return r.createElement(p.a,{loader:()=>n.e(96).then(n.bind(null,"eKGD")).then(e=>e.AppShellPage),props:{pageModuleInput:t.getPageModuleInput(e),page:t.getPage(e),router:t,currentPage:e}})}const ge={display:"flex",flexDirection:"column",flex:"1",maxWidth:"100%",overflow:"hidden",height:"100%"},he=Object.assign(Object.assign({},ge),{display:"none"})},c0fp:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class r{getMetadata(){return{boundParameter:null,operationName:"GetClientMetadataEx",operationType:1,parameterTypes:{ClientMetadataQuery:{typeName:"Microsoft.Dynamics.CRM.MetadataQuery",structuralProperty:2}}}}}},c46F:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));class r{constructor(e,t,n){this._data=null,this._entityLogicalName=null,this._errorCode=0,this._entityLogicalName=e,this._data=t,this._errorCode=n}get_entityLogicalName(){return this._entityLogicalName}get_errorCode(){return this._errorCode}get_data(){return this._data}}},c77n:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e){return!(!e||!e.globalProgressIndicator)&&(null!==e.globalProgressIndicator.inProgress&&void 0!==e.globalProgressIndicator.inProgress&&e.globalProgressIndicator.inProgress)}function a(e){return e&&e.globalProgressIndicator&&e.globalProgressIndicator.progressMessage?e.globalProgressIndicator.progressMessage:null}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}))},c7Og:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class r{constructor(e,t){this._key=e,this._value=t}get_key(){return this._key}get_value(){return this._value}}},c7jw:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n("SAYH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="businessProcessFlow.addInstanceToRecordData";function i(e,t){const n={entities:{[e.etn]:{[r.a.toString(e.id)]:t}}};return{type:a,payload:n}}},cUMa:function(e,t,n){"use strict";n.d(t,"f",(function(){return d})),n.d(t,"d",(function(){return p})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return u})),n.d(t,"a",(function(){return m})),n.d(t,"g",(function(){return g})),n.d(t,"e",(function(){return h}));var r=n("ILmX"),a=n("i1f0"),i=n("odYE"),o=n("P6DH"),s=n("SAYH"),c=n("5Oca");function l(e,t){const n=Object(a.sc)(e,t);return n?n.valueString:null}function u(e,t){const n=Object(a.tc)(e,t);return n?n.valueString:null}function d(){let e=null;return function(t,n,r,a){if(null!=n)e=n;else{let n=null;if(a){const l=Object(o.ib)(t,r,a);if(l&&l.length){const e=Object(o.v)(t,r,a),i=(e&&e.queryKey&&Object(c.r)(t,e.queryKey,null,null,!0)||[]).filter(e=>l.some(t=>e.identifier&&s.a.equals(t,e.identifier.id)));n=[];for(let e=0;e<i.length;e++){const r=f(t,i[e]);n.push(r)}}e&&n&&m(e,n,i.a.equals)||(e=n)}}return e}}function p(){let e=[];return function(t,n,r,a){if(null!=n)e=n;else{let n=null;if(a){const s=Object(o.v)(t,r,a),l=s&&s.queryKey&&Object(c.r)(t,s.queryKey,null,null,!0)||[];if(l.length){n=[];for(let e=0;e<l.length;e++)if(l[e]&&l[e].identifier&&l[e].identifier.id){const r=f(t,l[e]);n.push(r)}}e&&n&&m(e,n,i.a.equals)||(e=n)}}return e}}function f(e,t){const n=t.identifier.id;let r=t.identifier.etn,o=t.identifier.name||Object(a.lc)(e,r,n);if("activitypointer"===r){r=t.fields.activitytypecode.value}else if("connection"===r&&null==o){const t=new i.a(r,n,o),a=Object(c.j)(e,t,"record2id");o=a&&a.reference&&a.reference.name||""}return new i.a(r,n,o)}function g(){let e;return function(t,n){const a=Object(r.n)(t,n.ribbonDescriptor,n.pageId,n.commandManagerId,n.selectedRecords&&n.selectedRecords.length>0);if(e&&Object.keys(e).length===Object.keys(a).length){Object.keys(e).every(t=>a[t]===e[t])||(e=a)}else e=a;return e}}function h(){let e;return function(t,n){var a;const i=(null===(a=n.menuItems)||void 0===a?void 0:a.Sections)?n.menuItems.Sections.reduce((e,t)=>e.concat(t.Item.Items),[]):[],o=Object(r.e)(t,i,n.pageId,n.commandManagerId,n.areRecordsSelected);if(e&&Object.keys(e).length===Object.keys(o).length){Object.keys(e).every(t=>o[t]===e[t])||(e=o)}else e=o;return e}}function m(e,t,n){let r=!0;return r=e&&t?e.length===t.length&&e.every((r,a)=>n?n(e[a],t[a]):e[a]===t[a]):e===t,r}},cUbT:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n("LAGg"),a=n("RrRu"),i=n("jRHm"),o=n("BFlg"),s=n("iZ7K"),c=n("jq7Z");function l(e){return{type:"grids.etn.refresh.async",execute({dispatch:t,getState:n},r){const a=r.TraceManager.getTracer(o.P),i=o.N+".refreshGridforEntityTypeNameAction";try{let c=[];const l=n();return Object(s.r)(l,e)&&(a.info("Refreshing all the grids for the entity type - "+o.a),u(l,o.a,t),c.push({name:"entityName",value:o.a}),r.EventManager.ReportComponentSuccess(i,c)),a.info("Refreshing all the grids for the entity type - "+e),u(l,e,t),c=[],c.push({name:"entityName",value:e}),r.EventManager.ReportComponentSuccess(i,c),Promise.resolve()}catch(t){let n="Refresh action for grid of entity type "+e+"failed";t&&t.message&&(n+="with the error message as : "+t.message),r.EventManager.ReportComponentFailure(i,Error(n))}}}}function u(e,t,n){for(const r in e.pages)d(e,t,n,r);for(const r in e.formInstances)d(e,t,n,r)}function d(e,t,n,s){const l=Object(c.a)(e,s);if(l.datasets)for(const e in l.datasets){const c=l.datasets[e];if(c.controls&&c.controls[o.w]&&c.controls[o.w].parameters){const l=c.controls[o.w].parameters;for(const o in l)"TargetEntityType"===l[o].Name&&l[o].Value===t&&(n(Object(r.c)(s,e)),n(Object(a.c)(s,e,[])),n(Object(i.c)(s,e,null)))}}}},cZbt:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e.active="active",e.finished="finished",e.aborted="aborted",e.invalid="invalid"}(r||(r={}))},cetF:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return c}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r=["command","commandoperation"],a=["NORSYNC_SID","NORSYNC_LOG_SID","NORSYNC_TABLE_ID","NORSYNC_LOG_TYPE"];function i(e){return e&&("_NORSYNC_MAIN_LOG_TABLE"===e||r.indexOf(e)>-1)}function o(e){return e&&e.startsWith("_NORSYNC_LOG_")}function s(e){return o(e)||"_NORSYNC_MAIN_LOG_TABLE"===e}function c(e){return o(e)?e.substring("_NORSYNC_LOG_".length):e}},cfGX:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"d",(function(){return o}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r=void 0,a=void 0,i=void 0,o=void 0},cfbi:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return i}));
/**
 * The unique name of the edit form page module.
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="EditForm",a="MainFormDialog",i="BulkEdit"},cgR4:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class r{constructor(e,t){this.Format=0,this.Data=null,this.Format=e,this.Data=t}}},cz9j:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"d",(function(){return l})),n.d(t,"c",(function(){return d})),n.d(t,"g",(function(){return f})),n.d(t,"e",(function(){return g})),n.d(t,"f",(function(){return h}));var r,a=n("ju1h");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */!function(e){e.DownArrow="UIKeyInputDownArrow",e.UpArrow="UIKeyInputUpArrow",e.LeftArrow="UIKeyInputLeftArrow",e.RightArrow="UIKeyInputRightArrow",e.Escape="UIKeyInputEscape"}(r||(r={}));var i=n("3rse"),o=n("H4dV");function s(e){return function e(t,n=null,r=null){if(t&&(u(t)&&
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e){return!e.hasAttribute(a.g)}(t)&&(d(t)&&!n&&(n=t),r||(r=t)),t.children))for(let a=0;a<t.children.length&&(!n||!r);a++){const i=t.children.item(a),{focusableElement:o,editableElement:s}=e(i,n,r);n||(n=s),r||(r=o)}return{focusableElement:r,editableElement:n}}(e)}function c(e){if(e){if(e.children)for(let t=e.children.length-1;t>-1;t--){const n=c(e.children.item(t));if(n)return n}if(u(e))return e}return null}function l(e){return p(e)}function u(e){return p(e,!0)}function d(e){const t=e.tagName?e.tagName.toLowerCase():null;return"input"===t||"textarea"===t||"true"===e.contentEditable}function p(e,t=!1){let n=!1;if(e){const r=e.getAttribute("tabindex"),a=t?0:-1;(["input","iframe","button","select","textarea"].indexOf(e.tagName.toLowerCase())>=0||["a","area"].indexOf(e.tagName.toLowerCase())>=0&&e.getAttribute("href")||"true"===e.contentEditable||null!=r&&!isNaN(+r)&&Number(r)>=a)&&(n=!0,function(e){return!e.hidden&&(e.offsetWidth||e.offsetHeight||e.getClientRects().length)&&(!e.style||"hidden"!==e.style.visibility&&"collapse"!==e.style.visibility)}(e)&&!function(e){return e.hasAttribute("disabled")}(e)||(n=!1))}return n}function f(e){const t=document.querySelector("[id='ApplicationShell']");t&&t.setAttribute("aria-hidden",e.toString());const n=document.querySelectorAll("section[id^=DialogContainer]");for(let t=0;t<n.length;t++)n.item(t).setAttribute("aria-hidden",e.toString())}function g(e){let t=e.keyCode;if(!t)switch(e.key){case r.DownArrow:t=i.a.DownArrow;break;case r.UpArrow:t=i.a.UpArrow;break;case r.LeftArrow:t=i.a.LeftArrow;break;case r.RightArrow:t=i.a.RightArrow;break;case r.Escape:t=i.a.Escape}return t}function h(){return o.a.getInstance().get_IsIOS()||o.a.getInstance().get_IsAndroid()||o.a.getInstance().get_IsMobilePhone()}},"d+dp":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("504W"),a=n("5qiD"),i=n("/oKV");class o{constructor(e,t,n){this._timestamp=null,this._cachePriority=0,this._retrievalStrategy=0,this._cachePriority=e,this._retrievalStrategy=t,this._timestamp=Object(r.a)(n)?new Date:n}get_timestamp(){return this._timestamp}get_cachePriority(){return this._cachePriority}set_cachePriority(e){return this._cachePriority=e,e}get_retrievalStrategy(){return this._retrievalStrategy}set_retrievalStrategy(e){return this._retrievalStrategy=e,e}get_sortableTimestamp(){return o.getSortableString(this._timestamp)}getObjectData(){const e={};return e[o.timestampPath]=this.get_sortableTimestamp(),e.priority_timestamp=o.priorityTimestampKey(this._cachePriority,this._timestamp),e}update(e){Object(r.a)(e)||(this._timestamp=e._timestamp,e._cachePriority<this._cachePriority&&(this._cachePriority=e._cachePriority))}static shouldBeCached(e){return!Object(r.a)(e)&&e.get_cachePriority()!==a.a.NotCached}static getSortableString(e){return e.format("s")}static priorityTimestampKey(e,t){return e+"|"+o.getSortableString(t)}static createFromObjectData(e){const t=Date.parseInvariant(e[o.timestampPath]),n=e.priority_timestamp,r=Number.parseInvariant(n.substr(0,1));return new o(r,i.a.LocalAndRemote,t)}}o.timestampPath="timestamp",o.embeddedPriorityTimestampPath="clientretrieveoptions.priority_timestamp"},d0w6:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r,a;function i(e){return e===a.savedview?"SystemView":"UserView"}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),function(e){e[e.MAIN_APPLICATION_VIEW=0]="MAIN_APPLICATION_VIEW",e[e.ADVANCED_SEARCH=1]="ADVANCED_SEARCH",e[e.SUB_GRID=2]="SUB_GRID",e[e.QUICKFIND_SEARCH=4]="QUICKFIND_SEARCH",e[e.REPORTING=8]="REPORTING",e[e.OFFLINE_FILTERS=16]="OFFLINE_FILTERS",e[e.MA_SEARCH=32]="MA_SEARCH",e[e.LOOKUP_VIEW=64]="LOOKUP_VIEW",e[e.SM_APPOINTMENTBOOK_VIEW=128]="SM_APPOINTMENTBOOK_VIEW",e[e.OUTLOOK_FILTERS=256]="OUTLOOK_FILTERS",e[e.ADDRESSBOOK_FILTERS=512]="ADDRESSBOOK_FILTERS",e[e.SAVEDQUERYTYPE_OTHER=2048]="SAVEDQUERYTYPE_OTHER",e[e.INTERACTIVE_WORKFLOW_VIEW=4096]="INTERACTIVE_WORKFLOW_VIEW",e[e.OFFLINE_TEMPLATE=8192]="OFFLINE_TEMPLATE",e[e.OUTLOOK_TEMPLATE=131072]="OUTLOOK_TEMPLATE",e[e.CUSTOM_DEFINED_VIEW=16384]="CUSTOM_DEFINED_VIEW"}(r||(r={})),function(e){e[e.savedview=1039]="savedview",e[e.userview=4230]="userview"}(a||(a={}))},d4He:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("F1Lu");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t){return{type:"external.url.open",execute:(n,a)=>new r.a(a,n).openUri(e,t),shouldReceiveFullStore:!0}}},d4Lp:function(e,t,n){"use strict";n.d(t,"b",(function(){return v})),n.d(t,"a",(function(){return O}));var r=n("i1f0"),a=n("arV0"),i=n("dHD5"),o=n("odYE"),s=n("JP46"),c=n("SAYH"),l=n("Dea/"),u=n("bT7G"),d=n("sX6v"),p=n("RrRQ"),f=n("WY/A"),g=n("qTme"),h=n("+Zk2"),m=n("LbMF"),b=n("5Oca"),y=n("jq7Z"),_=n("wL2W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function v(e,t){return{type:h.d,sync:!0,execute({dispatch:a,getState:i},o){const s=i(),{missingFields:c,allRequiredFields:l}=Object(r.qc)(s,{id:e},t);Object(_.a)()&&n.e(81).then(n.bind(null,"vqYC")).then(n=>{a(n.requiredFieldValidationChecker(e,t,null,l))}),S(s,a,o,e,c)}}}function S(e,t,n,m,b){const y={};if(!((null==b?void 0:b.length)>0))return;for(const e of b)y[e]={fieldName:e,value:""};const _=Object(a.j)(e,m),v=new o.a(null==_?void 0:_.entityTypeName,null==_?void 0:_.id),S=Object(i.j)(e,m),O=Object(r.hc)(e,m,S),C=Object(s.a)(e,O,v,y,!0,Object(i.t)(S),n.TraceManager.getTracer(h.e),m,t,null,!0,!0),E=c.a.isNullOrEmpty(v.id)?l.a.Create:l.a.Update,I=Object(i.w)(S),w=Object(u.b)(e,O);if(O&&w&&(o.a.equals(v,w.identifier)||E===l.a.Create))t(Object(d.b)(e,O,C));else{O&&t(Object(p.c)(m,O,S));const n=Object(f.b)(e,v,C,I,E),r=n.payload.snapshotId;t(n),t(Object(g.b)(m,r,S))}}function O(e,t,n){return{type:h.d,sync:!0,execute({dispatch:i,getState:c},l){var d,p,f;const g=c(),h=Object(a.j)(g,e),_=Object(m.a)(g,null==h?void 0:h.entityTypeName,n),v=Object(u.e)(g,Object(r.hc)(g,e,t),new o.a(null==h?void 0:h.entityTypeName,null==h?void 0:h.id),n),O=Object(y.a)(g,e),C=null!==(d=Object(r.B)(g,e,t,n))&&void 0!==d?d:[],E=null!==(p=Object(r.Eb)(O,t))&&void 0!==p?p:[],I=C.some(e=>E.includes(e)),w=(null!==(f=Object(r.Db)(O,t))&&void 0!==f?f:[]).includes(n);Object(s.c)(_)&&Object(b.E)(v,g,null==h?void 0:h.entityTypeName,n)&&(I||w)&&S(g,i,l,e,[n])}}}},d5N6:function(e,t,n){"use strict";n.d(t,"e",(function(){return r})),n.d(t,"f",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"g",(function(){return c})),n.d(t,"a",(function(){return l}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="InlineDialog",a=r+"_Iframe",i="Close",o="close",s="CloseCancel",c="butBegin",l="cmdDialogCancel"},d5d1:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e){return e&&e.platform?e.platform.features:{}}function a(e,t){return!!(e&&e.platform&&e.platform.features&&e.platform.features[t])&&e.platform.features[t].isEnabled}function i(e,t){return!!(e&&e.platform&&e.platform.features&&e.platform.features[t])&&e.platform.features[t].isAvailable}function o(e,t){return i(e,t)&&a(e,t)}function s(e){return e&&e.platform&&e.platform.features&&e.platform.features.camera&&e.platform.features.camera.imageRes}function c(e){return e&&e.platform&&e.platform.features&&e.platform.features.camera&&e.platform.features.camera.savePhoto}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return s})),n.d(t,"e",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"f",(function(){return c}))},d6Hx:function(e,t,n){"use strict";n.d(t,"k",(function(){return a})),n.d(t,"g",(function(){return i})),n.d(t,"f",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"d",(function(){return c})),n.d(t,"c",(function(){return l})),n.d(t,"l",(function(){return u})),n.d(t,"j",(function(){return d})),n.d(t,"h",(function(){return p})),n.d(t,"i",(function(){return f})),n.d(t,"o",(function(){return g})),n.d(t,"m",(function(){return h})),n.d(t,"b",(function(){return m})),n.d(t,"a",(function(){return b})),n.d(t,"n",(function(){return y}));var r=n("nJrx");
/**
 * Constants for the editform.
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a=Object(r.a)(),i=Object(r.a)(),o="navbutton",s=Object(r.a)(),c=Object(r.a)(),l="$most-recently-used",u=Object(r.a)(),d="searchLauncher",p="quickCreateLauncher",f="quickCreateMenuButton",g="SiteMap",h="SiteMapCollapsedGroup",m="backButton",b="advancedFindLauncher",y="SiteMap.SubAreaNavigation"},d7fm:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;function a(e){switch(e){case"campaignactivity":return["partners","from"];case"fax":return["from","to"];case"email":case"letter":return["from","to","cc","bcc"];case"phonecall":return["from","to"];case"appointment":return["optionalattendees","organizer","requiredattendees"];case"campaignresponse":return["customer","partner","from"];case"recurringappointmentmaster":return["optionalattendees","organizer","requiredattendees"];case"serviceappointment":return["customers","resources"];default:return["bcc","cc","customers","optionalattendees","organizer","requiredattendees","resources","sendermailboxid","to","from","partners"]}}function i(e,t){switch(`${e}.${t}`.toLowerCase()){case"campaignactivity.from":case"campaignresponse.from":case"fax.from":case"email.from":case"letter.from":case"phonecall.from":return r.Sender;case"email.to":case"fax.to":case"letter.to":case"phonecall.to":return r.ToRecipient;case"email.cc":return r.CCRecipient;case"email.bcc":case"letter.bcc":return r.BccRecipient;case"appointment.optionalattendees":case"recurringappointmentmaster.optionalattendees":return r.OptionalAttendee;case"appointment.organizer":case"recurringappointmentmaster.organizer":return r.Organizer;case"appointment.requiredattendees":case"recurringappointmentmaster.requiredattendees":return r.RequiredAttendee;case"campaignresponse.customer":case"serviceappointment.customer":return r.Customer;case"serviceappointment.resources":return r.Resource;case"campaignactivity.partners":case"campaignresponse.partner":return r.Partner;default:return function(e){switch(e){case"bcc":return r.BccRecipient;case"cc":return r.CCRecipient;case"customers":return r.Customer;case"partners":return r.Partner;case"optionalattendees":return r.OptionalAttendee;case"organizer":return r.Organizer;case"requiredattendees":return r.RequiredAttendee;case"resources":return r.Resource;case"sendermailboxid":case"from":return r.Sender;case"to":return r.ToRecipient;case"regarding":return r.Regarding;case"owner":return r.Owner;default:return}}(t)}}n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a})),function(e){e[e.Sender=1]="Sender",e[e.ToRecipient=2]="ToRecipient",e[e.CCRecipient=3]="CCRecipient",e[e.BccRecipient=4]="BccRecipient",e[e.RequiredAttendee=5]="RequiredAttendee",e[e.OptionalAttendee=6]="OptionalAttendee",e[e.Organizer=7]="Organizer",e[e.Regarding=8]="Regarding",e[e.Owner=9]="Owner",e[e.Resource=10]="Resource",e[e.Customer=11]="Customer",e[e.Partner=12]="Partner"}(r||(r={}))},d8rx:function(e,t,n){"use strict";n.d(t,"g",(function(){return a})),n.d(t,"f",(function(){return i})),n.d(t,"h",(function(){return o})),n.d(t,"d",(function(){return s})),n.d(t,"i",(function(){return c})),n.d(t,"e",(function(){return l})),n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return d})),n.d(t,"c",(function(){return p}));var r=n("PsCI");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t){return!e&&t===r.a.RightArrow||e&&t===r.a.LeftArrow}function i(e,t){return!e&&t===r.a.LeftArrow||e&&t===r.a.RightArrow}function o(e){return e?"marginRight":"marginLeft"}function s(e){return e?"marginLeft":"marginRight"}function c(e){return e?"paddingRight":"paddingLeft"}function l(e){return"paddingRight"}function u(e){return e?"right":"left"}function d(e){return e?"left":"right"}function p(e){return e?"borderLeft":"borderRight"}},dDbD:function(e,t,n){"use strict";n.r(t),n.d(t,"pingServer",(function(){return p})),n.d(t,"checkServerHealth",(function(){return f}));var r=n("Uv1Y"),a=n("WePp");class i extends a.a{constructor(e,t){super("MoCAServerPingTelemetryEvent"),this.addEventParameter("PingResponse",e),this.addEventParameter("ResponseReason",t)}}var o=n("37s6"),s=n("69Qu"),c=n("Qpqc"),l=n("3/02"),u=n("Lyxw"),d=n("a8hT");function p(){return{type:"ping.server.async",execute({dispatch:e,getState:t},n){const a=n.DataSource.get_WebAPIService().get_EventManager();return n.DataSource.ping().nativePromise().then(e=>{const t=new i(e?"PingSuccessful":"Pingfailed",null);return a&&a.ReportEvent(t),e}).catch(e=>{const t=new i("Pingfailed",e.get_Message());return a&&a.ReportEvent(t),Object(r.b)(e)})}}}function f(){return{type:"check.server.health.obd.async",execute:({dispatch:e,getState:t},n)=>new Promise((r,a)=>{const i=n.TraceManager.getTracer("CheckServerHealth"),f=n.DataSource;try{if(Object(u.f)(t(),l.pe)&&Object(o.E)(t(),!1)&&Object(s.a)(t())){const n=Date.now(),a=window.setTimeout(async()=>{var n;if(Object(s.a)(t())){e(Object(c.d)(!1,!1,!0)),f.get_ClientMetadataQueryPromiseCache().rejectRemotePromises();null===(n=(await Object(d.b)()).getRetrieveMultipleCache())||void 0===n||n.rejectRemotePromises()}i.warn("checkServerHealth timed out for OBD ready to use app, making server and network availability to false"),r()},5e3);e(p()).finally(async()=>{var o;if(Date.now()-n<5e3)window.clearTimeout(a),Object(s.d)(t())||e(Object(c.d)(!0,!0,!0)),r();else{e(Object(c.d)(!1,!1,!0)),f.get_ClientMetadataQueryPromiseCache().rejectRemotePromises();null===(o=(await Object(d.b)()).getRetrieveMultipleCache())||void 0===o||o.rejectRemotePromises(),i.warn("checkServerHealth responded late for OBD ready to use app, making server and network availability to false"),r()}})}else r()}catch(e){i.warn(null==e?void 0:e.message),r()}})}}},dFCJ:function(e,t,n){"use strict";n.d(t,"b",(function(){return E})),n.d(t,"a",(function(){return I})),n.d(t,"e",(function(){return j})),n.d(t,"d",(function(){return P})),n.d(t,"c",(function(){return T}));var r,a=n("mDek");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */!function(e){e[e.Auto=0]="Auto",e[e.Inactive=1]="Inactive",e[e.Active=2]="Active",e[e.Disabled=3]="Disabled"}(r||(r={}));var i,o=n("Ae6N"),s=n("ufH1"),c=n("g73c"),l=n("84PK"),u=n("504W"),d=n("Div0"),p=n("cfGX"),f=n("RREX");!function(e){e[e.unknown=-1]="unknown",e[e.none=0]="none",e[e.systemRequired=1]="systemRequired",e[e.applicationRequired=2]="applicationRequired",e[e.recommended=3]="recommended"}(i||(i={}));var g=n("OBdv"),h=n("XjOj"),m=n("IvgJ"),b=n("jFgV"),y=n("eruq"),_=n("VJwX"),v=n("Jz2d");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function S(e){let t={};for(let n=0,r=e.childNodes.length;n<r;n++){const r=e.childNodes[n];if(r.namespaceURI===v.a.xrm2011MetadataNamespace&&"Options"===Object(_.b)(r.nodeName))for(let e=0,n=r.childNodes.length;e<n;e++)t=O(t,r,r.childNodes[e],e);else r.namespaceURI!==v.a.xrm2011MetadataNamespace||"FalseOption"!==Object(_.b)(r.nodeName)&&"TrueOption"!==Object(_.b)(r.nodeName)||(t=O(t,r,r,n))}return new b.a(t)}function O(e,t,n,r){let a=-1,i=null,o=-1,s=-1,c=null,l=null,u=null;for(let e=0,r=n.childNodes.length;e<r;e++){const r=n.childNodes[e];if(t.namespaceURI===v.a.xrm2011MetadataNamespace){switch(Object(_.b)(r.nodeName)){case"Value":a=Number.parseInvariant(r.firstChild.nodeValue);break;case"Label":i=Object(g.a)(r);break;case"State":o=Number.parseInvariant(r.firstChild.nodeValue);break;case"DefaultStatus":s=Number.parseInvariant(r.firstChild.nodeValue);break;case"TransitionData":if(r.childNodes.length>0&&null!==r.firstChild.nodeValue){c=new Array(0);const e=Object(y.b)(r.firstChild.nodeValue);let t=Object(y.a)(e).childNodes();if(t.get_count()>0){t=t.get_item(0).childNodes();let e=0;for(let n=0;n<t.get_count();n++)if(t.get_item(n).getAttribute("tostatusid")){const r=Number.parseInvariant(t.get_item(n).getAttribute("tostatusid").toString());c[e]=r,e++}}}break;case"Color":l=r.firstChild?r.firstChild.nodeValue:null;break;case"InvariantName":u=r.firstChild.nodeValue}}}return-1===a&&Object(h.d)(d.a.storage,"OptionSetMetadata with unexpected value: {0}",i),e[r.toString()]=new m.a(i,a,o,s,c,l,u),e}var C=n("/A0C");function E(e){const t=[];if(!Object(u.a)(e))for(let n=0;n<e.get_count();n++){const r=I(e.get_item(n).get_element());r&&t.push(r)}return t}function I(e){try{let t=null,n=null,s=null,d=null,h=C.a.Unknown,m=i.unknown,b=!1,y=!1,O=!1,E=!1,I=!1,T=0,N=0,A=0,R=0,D=f.a.currency,x="",M="",F=o.a.UserLocal,k=p.c,L=p.a,B=!1,U=null,V=null,z=null,q=null,H=!0,W=!1,G=0,K=0,Q=!1;for(let a=0,i=e.childNodes.length;a<i;a++){const i=e.childNodes[a];if("true"!==i.getAttribute("i:nil")&&i.firstChild&&i.namespaceURI===v.a.xrm2011MetadataNamespace){switch(Object(_.b)(i.nodeName)){case"MetadataId":t=new l.a(i.firstChild.nodeValue);break;case"LogicalName":n=i.firstChild.nodeValue;break;case"EntityLogicalName":s=i.firstChild.nodeValue;break;case"DisplayName":d=Object(g.a)(i);break;case"AttributeType":h=w(i.firstChild.nodeValue);break;case"RequiredLevel":m=j(i.childNodes[2].firstChild.nodeValue);break;case"IsSecured":b=Boolean.parse(i.firstChild.nodeValue).valueOf();break;case"IsValidForCreate":y=Boolean.parse(i.firstChild.nodeValue).valueOf();break;case"IsValidForRead":O=Boolean.parse(i.firstChild.nodeValue).valueOf();break;case"IsValidForUpdate":E=Boolean.parse(i.firstChild.nodeValue).valueOf();break;case"IsValidForGrid":I=Boolean.parse(i.firstChild.nodeValue).valueOf();break;case"MaxLength":T=parseInt(i.firstChild.nodeValue,10);break;case"MinValue":N=parseFloat(i.firstChild.nodeValue);break;case"MaxValue":A=parseFloat(i.firstChild.nodeValue);break;case"Precision":R=parseInt(i.firstChild.nodeValue,10);break;case"PrecisionSource":D=parseInt(i.firstChild.nodeValue,10);break;case"Format":x=i.firstChild.nodeValue;break;case"FormatName":if(!i.firstChild.firstChild)continue;M=i.firstChild.firstChild.nodeValue;break;case"DateTimeBehavior":if(!i.firstChild.firstChild)continue;F=P(i.firstChild.firstChild.nodeValue);break;case"DefaultFormValue":k=parseInt(i.firstChild.nodeValue,10);break;case"DefaultValue":L=Boolean.parse(i.firstChild.nodeValue).valueOf();break;case"OptionSet":U=S(i);break;case"IsBaseCurrency":B=Boolean.parse(i.firstChild.nodeValue).valueOf();break;case"ImeMode":K=Object(c.a)(r,i.firstChild.nodeValue);break;case"Targets":const e=i.childNodes,a=e.length;if(a>0){const t=[];for(let n=0;n<a;n++)t.push(e[n].firstChild.nodeValue);V=t}break;case"AttributeOf":z=i.firstChild.nodeValue;break;case"HasChanged":H=Boolean.parse(i.firstChild.nodeValue).valueOf();break;case"IsSortableEnabled":const o=i.childNodes;W=!!(o.length>=2&&"a:Value"===o[2].nodeName&&o[2].firstChild&&o[2].firstChild.nodeValue)&&Boolean.parse(o[2].firstChild.nodeValue).valueOf();break;case"InheritsFrom":q=i.firstChild.nodeValue;break;case"SourceType":G=parseInt(i.firstChild.nodeValue,10);break;case"IsLocalizable":Q=Boolean.parse(i.firstChild.nodeValue).valueOf()}}}const X=Object(u.b)(M)?x:M;return new a.a(n,t,s,h,d,b,y,O,E,I,m,T,N,A,R,D,X,F,k,L,U,B,V,z,H,K,W,q,G,Q)}catch(e){return Object(s.c)("AttributeMetadataSerializer",d.a.storage,String.format("Error extracting attribute metadata from SOAP response. Exception: {0}",e.toString())),null}}function w(e){switch(e){case"Boolean":return C.a.Boolean;case"Customer":return C.a.Customer;case"DateTime":return C.a.DateTime;case"Integer":return C.a.Integer;case"Lookup":return C.a.Lookup;case"Memo":return C.a.Memo;case"Money":return C.a.Money;case"Owner":return C.a.Owner;case"Picklist":return C.a.PickList;case"String":return C.a.String;case"Status":return C.a.Status;case"Uniqueidentifier":return C.a.UniqueIdentifier;case"BigInt":return C.a.BigInt;case"Virtual":return C.a.Virtual;case"State":return C.a.State;case"Double":return C.a.Double;case"ManagedProperty":return C.a.ManagedProperty;case"Decimal":return C.a.Decimal;case"PartyList":return C.a.PartyList;case"EntityName":return C.a.EntityName;default:return C.a.Unknown}}function j(e){switch(e){case"None":return 0;case"ApplicationRequired":return i.applicationRequired;case"Recommended":return i.recommended;case"SystemRequired":return i.systemRequired;default:return i.unknown}}function P(e){switch(e){case"None":return 0;case"UserLocal":return o.a.UserLocal;case"DateOnly":return o.a.DateOnly;case"TimeZoneIndependent":return o.a.TimeZoneIndependent;default:return o.a.UserLocal}}function T(e){switch(e){case 0:return"None";case o.a.UserLocal:return"UserLocal";case o.a.DateOnly:return"DateOnly";case o.a.TimeZoneIndependent:return"TimeZoneIndependent";default:return"UserLocal"}}},dGG5:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i}));var r=n("MOEv");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t){return`${r.a}${e}placeholder${t}`}function i(e,t,n,r){n=n||[];for(const i in n){const n=a(t,i);r.doesOnClickEventExist(e,n)&&r.getOnClickEvents(e,n).forEach(t=>r.removeOnClickEvent(e,n,t))}}},dH1a:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e){return-2147093997===e||-2147093999===e}n.d(t,"a",(function(){return r}))},dHD5:function(e,t,n){"use strict";n.d(t,"k",(function(){return c})),n.d(t,"c",(function(){return m})),n.d(t,"h",(function(){return s})),n.d(t,"j",(function(){return l})),n.d(t,"i",(function(){return u})),n.d(t,"o",(function(){return f})),n.d(t,"w",(function(){return E})),n.d(t,"y",(function(){return I})),n.d(t,"q",(function(){return h})),n.d(t,"e",(function(){return O})),n.d(t,"p",(function(){return C})),n.d(t,"f",(function(){return g})),n.d(t,"l",(function(){return P})),n.d(t,"v",(function(){return T})),n.d(t,"z",(function(){return N})),n.d(t,"r",(function(){return y})),n.d(t,"m",(function(){return _})),n.d(t,"n",(function(){return v})),n.d(t,"a",(function(){return S})),n.d(t,"d",(function(){return d})),n.d(t,"b",(function(){return p})),n.d(t,"g",(function(){return b})),n.d(t,"t",(function(){return w})),n.d(t,"u",(function(){return A})),n.d(t,"s",(function(){return R})),n.d(t,"x",(function(){return D}));var r=n("jRy5"),a=n("arV0"),i=n("SAYH"),o=n("n3bs");function s(e){return e?{contextTokenType:r.a.MainForm,entityTypeName:e}:null}function c(e){return e?{contextTokenType:r.a.MainGrid,entityTypeName:e}:null}function l(e,t){return u(Object(a.j)(e,t))}function u(e){return e?e.uniqueName?e.formId?s(i.a.toString(e.formId)):s(e.entityTypeName):e.dashboardId?y(void 0,e.dashboardId):e.pageType&&e.pageType===o.a.ENTITY_LIST?c(e.entityTypeName):s(e.entityTypeName):null}function d(e,t){return t?y(void 0,t):null}function p(e,t){const{customControlId:n}=Object(a.j)(e,t);return n?O(void 0,n):null}function f(e,t){return{contextTokenType:r.a.SearchWidget,parentContextToken:e,controlName:t}}function g(e,t,n){return{contextTokenType:r.a.GridRow,parentContextToken:e,recordId:t,entityTypeName:n}}function h(e,t){return{contextTokenType:r.a.SubGrid,parentContextToken:e,controlName:t}}function m(e,t){return{contextTokenType:r.a.CustomGrid,parentContextToken:e,controlName:t}}function b(e,t,n){return{contextTokenType:r.a.LookupDialog,parentContextToken:e,entityTypeName:t+"_"+n}}function y(e,t){return{contextTokenType:r.a.UnboundForm,parentContextToken:e,formId:t}}function _(e,t,n){return{contextTokenType:r.a.QuickViewForm,parentContextToken:e,controlName:t,entityTypeName:n}}function v(e,t){return{contextTokenType:r.a.RelatedEntity,parentContextToken:e,relationshipName:t}}function S(e,t,n){return{contextTokenType:r.a.AssociatedGrid,parentContextToken:e,relationshipName:t,roleOrd:n}}function O(e,t){return{contextTokenType:r.a.FormControl,parentContextToken:e,controlName:t}}function C(e,t,n,r){return h(e,t+n+r)}function E(e){const t=function e(t,n){return t?(t.parentContextToken?e(t.parentContextToken,n):t.entityTypeName?n.push(t.entityTypeName):t.formId&&n.push(t.formId.guid),t.recordId&&!t.controlName?(n.push(t.recordId.guid),t.relationshipName&&n.push(t.relationshipName)):t.controlName?(n.push(t.controlName),t.entityTypeName&&n.push(t.entityTypeName),t.recordId&&(n.push(t.recordId.guid),t.relationshipName&&n.push(t.relationshipName))):t.relationshipName&&(n.push(t.relationshipName),t.roleOrd&&n.push(t.roleOrd)),n):n}(e,[]);return 0===t.length?"_":t.join(":")}function I(e){return E(j(e))}function w(e){return j(e)}function j(e){if(null!=e&&null!=e.relationshipName){const t=Object.assign({},e);return t.relationshipName=null,t}return e}function P(e,t){return l(e,t)}function T(e){return E(e)}function N(e){return e?e.parentContextToken?N(e.parentContextToken):e.entityTypeName?e.entityTypeName:e.formId?e.formId.guid:e.controlName?e.controlName:void 0:""}function A(e){return e.contextTokenType&&e.contextTokenType===r.a.GridRow?e.parentContextToken&&e.parentContextToken.controlName?e.parentContextToken.controlName:"entity_control":null}function R(e){return e.contextTokenType&&e.contextTokenType===r.a.GridRow?e.parentContextToken:e}function D(e){return e&&e.contextTokenType===r.a.RelatedEntity?e.parentContextToken:e}},dJ44:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return d})),n.d(t,"c",(function(){return p})),n.d(t,"d",(function(){return f}));var r=n("Lyxw"),a=n("3/02"),i=n("E5IU"),o=n("504W"),s=n("0kGT"),c=n("dpM5"),l=n("rcL5");function u(e){return Object(i.i)("HighDensityPageHeader",e)&&Object(r.f)(e,a.zd)&&!Object(s.c)(e)}function d(e){const t=Object(i.i)("HeroIconLengthInHighDensityPageHeaderInTeams",e);return Object(o.a)(t)?1:t}function p(e){return u(e)&&Object(r.f)(e,c.n)}function f(e,t){return Object(r.f)(e,c.o)&&Object(l.a)(e,t)&&!Object(s.c)(e)}},dL4i:function(e,t,n){"use strict";e.exports=n("R3zT")},dNvO:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.PostMessage=0]="PostMessage",e[e.SizeChange=1]="SizeChange",e[e.StateChange=2]="StateChange",e[e.LoadCompleted=3]="LoadCompleted"}(r||(r={}))},dUiZ:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n("eXjw");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e){return e&&e.metadata&&e.metadata.quickCreateMenu&&e.metadata.quickCreateMenu.initialized?e.metadata.quickCreateMenu:null}function i(e){const t=a(e);return t?t.initialized:r.a.Uninitialized}},db6h:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));const r="deviceSettings.featureAvailable.change",a={CameraAvailable:["camera","video"],MicrophoneAvailable:["microphone"],GeolocationAvailable:["geolocation"]};function i(e,t){const n={};return a[e].forEach(e=>{n[e]={featureName:e,isAvailable:t}}),{type:r,payload:n}}},dbr2:function(e,t,n){"use strict";n.d(t,"c",(function(){return d})),n.d(t,"b",(function(){return p})),n.d(t,"a",(function(){return l}));var r=n("unFF"),a=n("IqkD"),i=n("0kGT"),o=n("w1eR"),s=n("GYEz"),c=n("arV0");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const l=500;function u(e,t,n){var a;const o=Object(r.a)(e);let s=p(e,t);const l=null===(a=Object(c.q)(e,t))||void 0===a?void 0:a.width,u=Object(i.c)(e);n&&(s-=18);const d=l<=o.sizes.Breakpoints.DimensionS?o.sizes.Measures.Measure100:o.sizes.Measures.Measure150;return{paddingLeft:d,paddingTop:u?0:d,paddingBottom:d,paddingRight:d,flex:1,flexWrap:"nowrap",width:s,alignContent:"flex-start",flexDirection:"column",boxSizing:"border-box",height:"100%",backgroundColor:"#FFFFFF",borderLeftWidth:"1px",borderLeftColor:o.colors.BaseColor.White,borderLeftStyle:"solid"}}function d(){let e=null,t=null,n=null,i=null,l=null;return function(d,p){var f,g;const h=Object(r.a)(d),m=null===(f=Object(c.q)(d,p))||void 0===f?void 0:f.height,b=null===(g=Object(c.q)(d,p))||void 0===g?void 0:g.width,y=Object(a.g)(d),_=Object(s.a)(d)===o.a.Browser,v=b<h.sizes.Breakpoints.DimensionXS&&_;return t===h&&n===m&&i===v&&l===y||(t=h,n=m,i=v,l=y,e={rootContainerStyle:{position:"relative",height:v?"200%":"100%",width:"100%",alignItems:"flex-end",flex:1,flexDirection:"column",overflow:v?"auto":void 0},rootStyle:u(d,p,v),formHeaderContainerStyle:{display:"flex",flex:"0 0 auto",flexDirection:"row",justifyContent:"space-between",marginBottom:h.sizes.Measures.Measure125},formHeaderStyle:{textOverflow:"ellipsis",overflow:"hidden",marginTop:0,marginBottom:0,fontSize:h.fontSizes.Font125,fontFamily:h.fontFamilies.Semilight,color:h.colors.BaseColor.Grey.Grey7},overlayStyle:{position:"absolute",height:"100%",width:"100%",backgroundColor:h.colors.BaseColor.White,top:0,left:0,opacity:.8},overlayTextStyle:{width:"100%",textAlign:"center",fontSize:h.fontSizes.Font100,color:h.colors.BaseColor.Grey.Grey7,lineHeight:n.toString()+"px"},tabContainerStyle:{display:"flex",flexDirection:"column",flex:"1 1 0px",overflow:"auto"},tabStyle:{display:"block",maxWidth:"100%"},customFormNotificationStyle:{marginTop:0,paddingLeft:0,paddingRight:0,marginBottom:h.sizes.Measures.Measure100}}),e}}function p(e,t){var n;const r=null===(n=Object(c.q)(e,t))||void 0===n?void 0:n.width;return r<l?r:l}},ddoO:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e){return e&&e.garbageCollector?e.garbageCollector.metadata:null}function a(e){const t=r(e);return t?t.ribbons:null}function i(e,t){const n=r(e);return n&&n.ribbons?n.ribbons[t]:null}function o(e){const t=r(e);return t?t.entities:null}function s(e,t){const n=r(e);return n&&n.entities?n.entities[t]:null}function c(e){return e&&e.garbageCollector?e.garbageCollector.data:null}function l(e){const t=c(e);return t&&t.entities?t.entities:null}function u(e,t,n){const r=c(e);return r&&r.entities&&r.entities[t]?r.entities[t][n]:null}function d(e){const t=c(e);return t&&t.charts?t.charts:null}function p(e){const t=c(e);return t&&t.chartData?t.chartData:null}function f(e,t,n){const r=c(e);return r&&r.charts&&r.charts[t]?r.charts[t][n]:null}function g(e,t){const n=c(e);return n&&n.chartData&&n.chartData[t]?n.chartData[t]:null}function h(e){const t=c(e);return t&&t.lists?t.lists:null}function m(e,t){const n=c(e);return n&&n.lists&&n.lists[t]?n.lists[t]:null}n.d(t,"l",(function(){return a})),n.d(t,"k",(function(){return i})),n.d(t,"f",(function(){return o})),n.d(t,"g",(function(){return s})),n.d(t,"e",(function(){return l})),n.d(t,"h",(function(){return u})),n.d(t,"d",(function(){return d})),n.d(t,"a",(function(){return p})),n.d(t,"c",(function(){return f})),n.d(t,"b",(function(){return g})),n.d(t,"j",(function(){return h})),n.d(t,"i",(function(){return m}))},deGN:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("E7fB"),a=n("E5IU"),i=n("IaGr");function o(e,t){try{const n=new r.a(e,t),i=Object(a.k)(e.getState()),o="Mobile"===n.client.getClient()?"/main.aspx?":`/main.aspx?appid=${encodeURIComponent(i)}&`;return n.getClientUrl()+o}catch(e){throw i.a.getInstance().eventManager.ReportComponentFailure("ClientApi.RetrieveDeviceApplicationUrl.getDeviceApplicationUrl",e),e}}},dfL6:function(e,t,n){"use strict";n.d(t,"b",(function(){return m})),n.d(t,"a",(function(){return b}));var r=n("nJrx"),a=n("Afz2"),i=n("ke4y"),o=n("ju1h"),s=n("Lyxw"),c=n("3/02"),l=n("InN9"),u=n("eIIO"),d=n("suJD"),p=n("hGVc"),f=n("3rse"),g=n("rhTL"),h=n("UvHz");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function m(e){return Object(s.e)(e,c.Ud,c.kf,c.Th)}class b{constructor(e){this._regionsLastFocusElement=[],this._applicationContext=e,this._elementFocusHandler=this._elementFocusHandler.bind(this),this._onKeydownHandler=this._onKeydownHandler.bind(this),this._onClickHandler=this._onClickHandler.bind(this)}registerGlobalShortCut(){document.body.addEventListener("pointerup",this._onClickHandler,!0),document.body.addEventListener("keydown",this._onKeydownHandler,!0),document.body.addEventListener("focus",this._elementFocusHandler,!0)}_getVisualOrder(e){const t=e.getAttribute(p.F);if(t===a.o)return 0;if(t===a.e&&"true"===e.getAttribute(o.d))return 2;const n=e.getAttribute(o.h);return t===a.e&&n?n===d.a?-1:1:void 0}_updateRegionList(){const e=document.body.querySelectorAll(`[role='${a.c}'],[role='${a.t}'],#${u.a} [role='${a.o}'],#${u.a} [role='${a.e}']`),t=[];for(let n=0;n<e.length;n++){const a=e[n];if(!a.offsetParent||"true"===a.getAttribute(p.l))continue;a.id||(a.id=Object(r.a)());const i=a.id,o=this._regionsLastFocusElement.find(e=>e.regionId===i),s=a.getAttribute(p.F);t.push({regionId:i,role:s,visualOrder:this._getVisualOrder(a),lastFocusedElement:o?o.lastFocusedElement:null})}this._regionsLastFocusElement=t.sort((e,t)=>void 0!==e.visualOrder&&void 0!==t.visualOrder?e.visualOrder>t.visualOrder?1:-1:0)}_getActiveRegionIndex(){let e=this._getRegionIndexByElement(document.activeElement);return e<0&&this._lastFocusRegionId&&(e=this._regionsLastFocusElement.findIndex(e=>e.regionId===this._lastFocusRegionId)),e}_getRegionIndexByElement(e){for(let t=0;t<this._regionsLastFocusElement.length;t++){const n=document.getElementById(this._regionsLastFocusElement[t].regionId);if(n&&n.contains(e))return t}return-1}_moveToNextRegion(){this._applicationContext.AccessibilityManager.showOutlineState(!0),this._updateRegionList();const e=this._getActiveRegionIndex(),t=e<0||e===this._regionsLastFocusElement.length-1?0:e+1;this._moveToRegion(t)}_moveToPreviousRegion(){this._applicationContext.AccessibilityManager.showOutlineState(!0),this._updateRegionList();const e=this._getActiveRegionIndex(),t=e<=0?this._regionsLastFocusElement.length-1:e-1;this._moveToRegion(t)}_moveToRegion(e){const t=this._regionsLastFocusElement[e];if(!t)return;const n="string"==typeof t.lastFocusedElement?document.getElementById(t.lastFocusedElement):t.lastFocusedElement;n?Object(g.c)().then(e=>{e.isElementTabbable(n)&&e.isElementVisible(n)?n.focus():this._focusToRegion(t.regionId)}):this._focusToRegion(t.regionId)}_focusToRegion(e){const t=document.getElementById(e);t&&Object(h.b)(t)}_elementFocusHandler(e){var t;const n=e.target;(null===(t=document.getElementById(i.a))||void 0===t?void 0:t.contains(n))&&(this._focusToElement(n)||(this._updateRegionList(),this._focusToElement(n)))}_focusToFirstLastElement(e){this._applicationContext.AccessibilityManager.showOutlineState(!0);const t=this._getActiveRegionIndex(),n=t>=0&&this._regionsLastFocusElement[t],r=n&&document.getElementById(n.regionId);r&&(e?Object(g.a)(r,r.firstChild,!0):Object(g.b)(r,r.lastChild,!0))}_onClickHandler(e){if(this._updateRegionList(),this._regionsLastFocusElement.length){const t=this._getRegionIndexByElement(e.target);t>=0&&(this._lastFocusRegionId=this._regionsLastFocusElement[t].regionId)}}_onKeydownHandler(e){this._enableHotKey()&&e.keyCode===f.a.F6&&e.ctrlKey&&(e.shiftKey?this._moveToPreviousRegion():this._moveToNextRegion(),e.stopPropagation(),e.preventDefault()),e.keyCode!==f.a.Home&&e.keyCode!==f.a.End||!e.ctrlKey||(this._focusToFirstLastElement(e.keyCode===f.a.Home),e.stopPropagation(),e.preventDefault())}_focusToElement(e){const t=this._getRegionIndexByElement(e);return t>=0&&(this._regionsLastFocusElement[t].lastFocusedElement=e,!0)}_enableHotKey(){return"true"!==document.getElementById(u.b).getAttribute(p.l)&&!document.getElementById(l.a)}}},dj6u:function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}));var r=n("4N6w");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e){return Object(r.c)(e)||window.__preload&&window.__preload.aadObjectId}function i(e){return Object(r.e)(e)||window.__preload&&window.__preload.aadTenantId}function o(){return window.__preload&&window.__preload.aadLoginHint}},dpM5:function(e,t,n){"use strict";n.d(t,"n",(function(){return r})),n.d(t,"k",(function(){return a})),n.d(t,"x",(function(){return i})),n.d(t,"f",(function(){return o})),n.d(t,"l",(function(){return s})),n.d(t,"v",(function(){return c})),n.d(t,"c",(function(){return l})),n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return d})),n.d(t,"e",(function(){return p})),n.d(t,"d",(function(){return f})),n.d(t,"j",(function(){return g})),n.d(t,"w",(function(){return h})),n.d(t,"q",(function(){return m})),n.d(t,"i",(function(){return b})),n.d(t,"h",(function(){return y})),n.d(t,"y",(function(){return _})),n.d(t,"o",(function(){return v})),n.d(t,"s",(function(){return S})),n.d(t,"p",(function(){return O})),n.d(t,"r",(function(){return C})),n.d(t,"u",(function(){return E})),n.d(t,"m",(function(){return I})),n.d(t,"t",(function(){return w})),n.d(t,"g",(function(){return j}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="HighDensityPageHeaderForDashboard",a="FormHeaderV2",i="UpdateSelectedStageIdUrlParameter",o="DoNotBlockStageNavigationForDisabledOrHiddenFields",s="FormLargeImageFile",c="UpdateDateValueParsing",l="BPFFormSaveIntegration",u="AsyncOnLoadHandler",d="AsyncOnSaveHandler",p="DeprecateTBX",f="DeprecateLowDensityHeader",g="FormFooterDeprecation",h="UpdateFCIdsWithEmptySnapshotsUnconditionally",m="NavigateOnQuickCreateSaveAndNew",b="FixNbspEqualityEntityReference",y="FilterStatusReasonForBulkEdit",_="UsePreciseRoundingUCIFormatter",v="HighDensityPageHeaderForSidePane",S="SetServerNotificationsPostSave",O="KeepFormTabsOnAssociativeGridTabSwitch",C="OnlyRenderSelectedFormTab",E="SkipFormComponentPreInitializeIfMemoryConstraint",I="GlobalCommandsIOS",w="SkipFormComponentPreInitialization",j=[{name:r,value:!0},{name:i,value:!0},{name:s,value:!0},{name:"BulkEditNativeUCI",value:!0},{name:g,value:!0},{name:f,value:!0},{name:p,value:!0},{name:u,value:!0},{name:b,value:!0},{name:y,value:!0},{name:o,value:!1},{name:v,value:!1},{name:S,value:!0},{name:I,value:!1}]},dzep:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));class r{constructor(e,t){this._parameterName=null,this._value=null,this._parameterName=e,this._value=t}getObjectData(){const e={};return e.name=this._parameterName,e.value=this._value,e}}function a(e,t,n){var a,i;null!==t&&null!==n&&(a=e,i=new r(t,n),a.push(i.getObjectData()))}function i(e,t,n){for(const r in e)if(e[r].name===t){e[r].value=n;break}}},e3W2:function(e,t,n){"use strict";n.d(t,"b",(function(){return g})),n.d(t,"c",(function(){return m})),n.d(t,"a",(function(){return h}));var r=n("jRy5"),a=n("dHD5"),i=n("ApeL"),o=n("i1f0"),s=n("vlcQ"),c=n("wL2W"),l=n("pEXn"),u=n("+Qpx"),d=n("4aOd"),p=n("tWr6"),f=n("d4Lp");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const g="control.visible",h=u.t+".visible";function m(e,t,n,m,b){return{type:"control.visible.sync",sync:!0,execute({dispatch:y,getState:_},v){var S;const O=_(),C=Object(o.E)(O,e,t,n);if(C&&C.parentSectionName&&m&&y(Object(s.c)(e,n,C.parentSectionName,!0)),y(function(e,t,n,o){if(n&&n.contextTokenType&&n.contextTokenType===r.a.GridRow)return Object(i.g)(e,n,t,o);const s=Object(a.w)(n);return{type:g,payload:o,meta:{pageId:e,controlName:t,contextKey:s}}}(e,t,n,m)),!m){const r=Object(o.u)(O,{id:e,controlName:t},n),a=Object(o.l)(r,t);y(Object(f.a)(e,n,a))}const E=_();if(Object(c.a)()){const r=null===(S=null==v?void 0:v.TraceManager)||void 0===S?void 0:S.getTracer(`${u.u}${u.t}`),a={id:e,controlName:t},i=Object(o.I)(O,a,n),s=Object(o.I)(E,a,n),c=Object(p.a)(O,e);c.push({name:"controlName",value:t}),c.push({name:"controlLabel",value:Object(o.y)(E,a,n)}),c.push({name:"visible state before change",value:null==i?void 0:i.toString()}),c.push({name:"visible state after change",value:null==s?void 0:s.toString()}),b&&c.push({name:"reason",value:b}),c.push({name:"callstack",value:new d.a(new Error).getStackTrace()}),null==r||r.warn(u.B,[{name:l.l,value:h},{name:u.t,value:JSON.stringify(c)}])}}}}},e5YD:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n("504W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e){let t=[];return e.setupSummaryNode&&t.push(e.setupSummaryNode),t=t.concat(e.Groups?e.Groups.reduce((e,t)=>e=e.concat(t.SubAreas),[]):[]),t}function i(e,t){const n=s(new URL(e,window.location.origin).searchParams).toString();if(!Object(r.b)(e)&&t&&t.length)for(let e=0;e<t.length;e++){const r=t[e];if(s(new URL(r.pageurl,window.location.origin).searchParams).toString()===n)return r}return null}function o(e,t){return e&&e[t]?e[t]:t}function s(e){return["scriptsHost","org","liveid","clienthost","navbar","cmdbar","defaulttracelevel","perf","appid","appId","sitemap","appshellmode","viewid","viewType","solutionid","extraqs","useLocal"].forEach(t=>e.delete(t)),e.sort(),e}},e6Wn:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){for(var r in e)n=t(n,e[r],r,e);return n}},"e8+c":function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="UCIQuickActions",a="QuickActions"},eBJ0:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZoneActivitySummaryTransport=void 0;var r=function(){function e(){this._status={},this._retroactiveStopwatches={}}return e.prototype.reset=function(){this._status={}},e.prototype.getSummary=function(){var e=this,t=Object.keys(this._status),n=function(n){if(t.indexOf(n)<0){var a=r._retroactiveStopwatches[n];a.sort((function(e,t){return e.startTime<t.startTime?-1:e.startTime>t.startTime?1:0})),a.forEach((function(t){return e._trackActivity(n,t.startTime,t.duration)}))}},r=this;for(var a in this._retroactiveStopwatches)n(a);return this._retroactiveStopwatches={},Object.keys(this._status).reduce((function(t,n){return t[n]=Math.round(e._status[n].duration),t}),{})},e.prototype.writeMarker=function(){},e.prototype.writeRetroactiveTimespan=function(e,t,n){e.getZone()in this._status||(e.getZone()in this._retroactiveStopwatches||(this._retroactiveStopwatches[e.getZone()]=[]),this._retroactiveStopwatches[e.getZone()].push({startTime:t,duration:n}))},e.prototype.startTimespan=function(e,t){return this._trackActivity.bind(this,e.getZone(),t)},e.prototype._trackActivity=function(e,t,n){var r=t+n;if(e in this._status){var a=this._status[e];r>a.endTime&&(a.duration+=r-Math.max(t,a.endTime),a.endTime=r)}else this._status[e]={endTime:r,duration:n}},e}();t.ZoneActivitySummaryTransport=r},eD3A:function(e,t,n){"use strict";n.d(t,"k",(function(){return _})),n.d(t,"d",(function(){return v})),n.d(t,"j",(function(){return S})),n.d(t,"l",(function(){return O})),n.d(t,"h",(function(){return E})),n.d(t,"w",(function(){return I})),n.d(t,"g",(function(){return w})),n.d(t,"o",(function(){return j})),n.d(t,"n",(function(){return P})),n.d(t,"p",(function(){return T})),n.d(t,"q",(function(){return N})),n.d(t,"a",(function(){return A})),n.d(t,"m",(function(){return R})),n.d(t,"x",(function(){return D})),n.d(t,"v",(function(){return x})),n.d(t,"s",(function(){return M})),n.d(t,"t",(function(){return F})),n.d(t,"r",(function(){return k})),n.d(t,"c",(function(){return L})),n.d(t,"e",(function(){return B})),n.d(t,"f",(function(){return q})),n.d(t,"i",(function(){return H})),n.d(t,"u",(function(){return W})),n.d(t,"b",(function(){return G}));var r=n("WTcq"),a=n("OiiO"),i=n("GYDS"),o=n("M0zh"),s=n("TDVd"),c=n("Lyxw"),l=n("3/02"),u=n("yc+y"),d=n("mpSO"),p=n("UuF9"),f=n("E5IU"),g=n("sZ+8"),h=n("69Qu");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const m=["XrmCore.Rules.Online.IsEntityAvailableForUserInMocaOffline".toLowerCase(),"XrmCore.Rules.Online.IsCustomActivityAvailableForUserInMocaOffline".toLowerCase()],b=["XrmCore.Rules.HierarchyView.isValidForHierarchyPageInUC".toLowerCase()],y=/<[/]*br\s*[\/]?>/gi;function _(e,t,n){return e?t&&t!==e?e.replace(y,"\n")+"\n\n"+t.replace(y,"\n"):e.replace(y,"\n"):t?t.replace(y,"\n"):n||""}function v(e){return e?e.replace(y,"\n"):""}function S(e,t,n,i){const o=C(n,i);return e.ScriptManager.containerExists(o)?Promise.resolve(e.ScriptManager.getContainer(o)):o===r.a.GLOBAL_CONTAINER_KEY?t(Object(a.a)(o,!0)):t(Object(a.a)(o,!1))}function O(e,t,n){return e.ClientApiManager.getClientApiEntry(C(t,n)).xrmInstance}function C(e,t){return Object(i.c)(e)||Object(i.c)(t)?r.a.GLOBAL_CONTAINER_KEY:t}function E(e){return null==e?"":-1===e.indexOf(":")?e:e.substring(e.lastIndexOf(-1!==e.indexOf(".")?".":-1!==e.indexOf("_")?"_":"!")+1)}function I(e,t,n){return null==e?"":(e&&t&&(e=(e=e.replace("{0}",t)).replace(new RegExp(o.c,"g"),t)),e&&n&&(e=e.replace(new RegExp(o.b,"g"),n)),e)}function w(e,t){return Object(g.p)(e,t)||!Object(h.c)(e)&&!Object(g.r)(e,t)}function j(e,t,n){return V(e,t,n,m)}function P(e,t,n){return V(e,t,n,b)}function T(e,t,n){return U(e,t,n,5)}function N(e,t,n){return U(e,t,n,48)}function A(e){for(const t of e.Actions)if(5===t.ActionType)return!0;return!1}function R(e,t,n){return U(e,t,n,53)}function D(e,t,n){return!(!Object(u.c)(e)||(null==t?void 0:t.ContextTypeMask)!==d.c.QuickActionCommand)&&!Object(p.b)(t,n)}function x(e,t,n){return z(e,[t],n,4,e=>s.a.containsCommandPropertiesReference(e.Parameters))}function M(e){return Object(c.f)(e,l.Kb)}function F(e){return Object(c.f)(e,l.Nb)&&Object(c.f)(e,l.Lb)}function k(e){return M(e)||F(e)}function L(e){return M(e)}async function B(e,t){var n;const r=null===(n=null==t?void 0:t.TraceManager)||void 0===n?void 0:n.getTracer("CommandingUtil"),a=Object(f.h)(e),i=null==a?void 0:a.map(e=>({libraryId:e.objectId,logicalName:e.objectName}));if((null==i?void 0:i.length)>1){const n=[];n.push({name:"AppId",value:Object(f.k)(e)}),n.push({name:"TotalNumberOfLibraries",value:i.length}),n.push({name:"Libraries",value:JSON.stringify(i)});try{const e=await async function(e,t,n,r){var a,i;const o=[];if(e)for(const r of e){const e=await(await K()).getLibraryMetadata(r.logicalName,t,n);(null===(a=null==e?void 0:e.componentLibraryPackageDetails)||void 0===a?void 0:a.componentNameMap)&&0!==Object.keys(null===(i=null==e?void 0:e.componentLibraryPackageDetails)||void 0===i?void 0:i.componentNameMap).length&&o.push(r)}if(r.push({name:"NumberOfLibrariesWithComponents",value:o.length}),r.push({name:"LibrariesWithComponents",value:JSON.stringify(o)}),(null==o?void 0:o.length)>0)return o[0];return}(i,t,r,n);return null==r||r.warn("CommandingUtil found multiple component libraries. Picking the first one that has atleast 1 component",n),e}catch(e){null==r||r.error("CommandingUtil something went wrong when attempting to select libraries. Picking the first one "+(null==e?void 0:e.message),n)}}return null==i?void 0:i[0]}function U(e,t,n,r){return z(e,t,n,r,()=>!0)}function V(e,t,n,r){return z(e,t,n,4,e=>e&&e.FunctionName&&-1!==r.indexOf(e.FunctionName.toLowerCase()))}function z(e,t,n,r,a){return t.some(t=>{if(e&&e[n]){const i=e[n];if(i&&i[t]){const e=i[t];return e&&function e(t,n,r){return t&&t.some(t=>{switch(t.RuleType){case n:return r(t);case 2:const a=t;return a.OrGroups&&a.OrGroups.some(t=>e(t.Rules,n,r))}return!1})}(e.Rules,r,a)}}return!1})}function q(e){return e?e.hasAttribute("tabindex")?e:e.querySelector("[tabindex]"):e}function H(e){if(!e)return e;const t=e.querySelectorAll("[tabindex]");return t.length?t[t.length-1]:e.hasAttribute("tabindex")?e:null}function W(e,t){if(""!==e.id&&e.id===t)return!0;const n=e.querySelectorAll("[tabindex]");for(let e=0;e<n.length;e++)if(n[e].id===t)return!0;return!1}function G(){return Promise.all([n.e(35),n.e(4),n.e(5),n.e(40),n.e(45),n.e(117)]).then(n.bind(null,"R8mP"))}function K(){return Promise.all([n.e(35),n.e(4),n.e(5),n.e(40),n.e(45),n.e(117)]).then(n.bind(null,"gw5+"))}},eIIO:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return i}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="shell-container",a="panels",i="smallscroll"},eIlw:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("mMyr"),a=n("SEva"),i=n("bUa6"),o=n("QBtP");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function s({children:e,pageId:t,pageType:n}){const s=r.useContext(o.a).EventManager;return r.createElement(a.a,{name:"Page",fallback:e=>r.createElement(i.a,{error:e,pageId:t}),onError:(e,r)=>s.ReportComponentFailure("Page.Render",e,void 0,[{name:"componentStack",value:r.componentStack},{name:"pageId",value:t},{name:"pageType",value:n}])},e)}},eL04:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="add.globalNotificationAction";function a(e){return{type:"add.globalNotificationAction.async",execute({dispatch:t,getState:n},a){const i={type:r,payload:{props:e}};return Promise.resolve(t(i))}}}},eL7I:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="notificationExpandIcon",a="headerFieldsExpandButton"},eOoD:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.Phone=1]="Phone",e[e.Tablet=2]="Tablet"}(r||(r={}))},eVWz:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return o}));var r=n("GYEz"),a=n("w1eR"),i=n("H4dV");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function o(e){return!function(e){const t=Object(r.a)(e);return t===a.a.MobileApplication||t===a.a.MailApp||i.a.getInstance().get_IsAndroid()||i.a.getInstance().get_isWinPhone()||i.a.getInstance().get_IsIOS()}(e)}function s(e){return Object(r.a)(e)===a.a.Browser}},eXjw:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;function a(e){return e===r.Initialized||e===r.Refreshing}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized",e[e.Refreshing=3]="Refreshing",e[e.Error=4]="Error",e[e.Partial=5]="Partial"}(r||(r={}))},eYZY:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"j",(function(){return a})),n.d(t,"i",(function(){return i})),n.d(t,"f",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"g",(function(){return l})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return d})),n.d(t,"k",(function(){return p})),n.d(t,"h",(function(){return f}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="id",a="metadatatype",i="metadatasubtype",o="formfactor",s="displayname",c="associatedentitylogicalname",l="isdefault",u="data",d="dependency",p="sourceid",f="isuserrecord"},eZ32:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.NotAvailable=0]="NotAvailable",e[e.Initializing=1]="Initializing",e[e.Available=2]="Available"}(r||(r={}))},eagp:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"d",(function(){return c})),n.d(t,"c",(function(){return l}));var r=n("OmkB"),a=n("M8lA"),i=n("tOh6");const o="show.modal.component",s="dismiss.modal.component";function c(e,t){return{type:"show.modal.async",sync:!0,execute({dispatch:n,getState:r},s){if(!Object(a.b)(r(),e)){const r=[{name:"ShowModalComponent",value:!0}];n(function(e){return{type:o,payload:{modalId:e}}}(e)),s.EventManager.ReportComponentSuccess(e,r),n(Object(i.a)(e,()=>{n(u(e)),t&&t()}))}}}}function l(e){return{type:"dismiss.modal.async",sync:!0,execute({dispatch:t,getState:n},i){const o=[{name:"DismissModalComponent",value:!0}];Object(a.b)(n(),e)&&(i.EventManager.ReportComponentSuccess(e,o),t(u(e)),t(Object(r.a)(e)))}}}function u(e){return{type:s,payload:{modalId:e}}}},eeMP:function(e,t,n){"use strict";n.d(t,"c",(function(){return l})),n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return d})),n.d(t,"d",(function(){return p}));var r=n("SAYH"),a=n("fMBw"),i=n.n(a),o=n("qAG9"),s=n("a8hT");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const c=i.a.createEvent("parseBatchResponse","Storage");function l(e){const t=Object(o.a)(e.headers,"OData-EntityId");if(t){const e=t.indexOf("(")+1,n=t.substring(e,t.length-1);return r.a.tryParse(n)}return null}async function u(e,t){const n=l(t);if(!n){const n=await t.json();return r.a.tryParse(n[e])}return n}async function d(e,t){t&&t.AppendCallStack("Parsers.parseBatchResponse");const n=c.startStopwatch(),r=await Object(s.a)(),a=await r.extractIndividualResponsesFromBatchResponse(e);return n(),a}function p(e){const t=Object(o.a)(e.headers,"ETag");if(!t)return null;const n=t.indexOf('"')+1;return t.substring(n,t.length-1)}},"eq+S":function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.none=-1]="none",e[e.appointmentBook=0]="appointmentBook",e[e.hardcoded=1]="hardcoded",e[e.main=2]="main",e[e.miniCampaignBO=3]="miniCampaignBO",e[e.preview=4]="preview",e[e.dashboard=5]="dashboard",e[e.quick=6]="quick",e[e.mobile=7]="mobile",e[e.read=8]="read",e[e.quickCreate=9]="quickCreate",e[e.dialog=10]="dialog",e[e.card=11]="card",e[e.taskBasedForm=12]="taskBasedForm",e[e.interactionCentricDashboard=13]="interactionCentricDashboard",e[e.powerbiDashboard=14]="powerbiDashboard"}(r||(r={}))},eq7e:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Trace=0]="Trace",e[e.Debug=1]="Debug",e[e.Info=2]="Info",e[e.Warning=3]="Warning",e[e.Error=4]="Error",e[e.Critical=5]="Critical"}(r||(r={}))},eq9I:function(e,t,n){"use strict";n.d(t,"m",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"e",(function(){return o})),n.d(t,"k",(function(){return s})),n.d(t,"l",(function(){return c})),n.d(t,"p",(function(){return l})),n.d(t,"q",(function(){return u})),n.d(t,"n",(function(){return d})),n.d(t,"d",(function(){return p})),n.d(t,"o",(function(){return f})),n.d(t,"j",(function(){return g})),n.d(t,"h",(function(){return h})),n.d(t,"i",(function(){return m})),n.d(t,"b",(function(){return b})),n.d(t,"c",(function(){return y})),n.d(t,"g",(function(){return _})),n.d(t,"f",(function(){return v}));var r=n("lKf0");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="Locale_DisplayName_{0}",i="PickList_Language_All",o="PickList_Language_Empty",s="First_Sync_Complete_Notification",c="First_Sync_Complete_Notification_Offline_By_Default",l="Request_Apply_Metadata_Notification",u="Request_Apply_Metadata_Notification_Offline_By_Default",d="Metadata_Download_Notification",p="Download_Progress",f="Offline_Date_Update_Completed",g="D365_UCI_OfflineStatus_Offline_Data_Ready_To_Use_Syncing_Now_Text",h="D365_UCI_OfflineStatus_Offline_File_Ready_To_Use_Text",m="D365_UCI_OfflineStatus_Offline_File_Synced_With_Errors_Text",b="Commanding_FX_Component_Not_Found_Text",y="Commanding_FX_Function_Not_Found_Text",_=["Error_Message_0x8005f211","Error_Message_0x8005F249","Error_Message_0x8005F24A","Error_Message_0x8005F24B","Error_Message_0x80042F09","Error_Message_0x80042f0c","Error_Message_0x80040225","Error_Message_0x8004032c","Error_Message_0x80040226","Error_Message_0x8005f215","Error_Message_0x80154b50","Error_Message_0x8004D24B","Error_Message_0x80072560","Error_Message_0x8004A104","Error_Message_0x8004A113","Error_Message_0x8005f21d","Error_Message_0x80061113","Error_Message_Generic_Mobile_Client","Button_Label_Close","Button_Label_OK","Button_Label_Cancel","DIALOG_LABELS_LIST","Leave_This_Page","Leave_Page_Text","Dialog_AuthError_Dialog_Title","Dialog_AuthError_Dialog_Description","Dialog_Reauthenticate_Signin_Button","Dialog_Reauthenticate_Cancel_Button","Updating_Offline_Data",s,c,l,u,"MailtoLink_ReportToAdmin",f,"L_Offline_Updating",g,h,m,"ServerUnavailableNotification_Offline_By_Default_Message",r.k,b,y],v={Error_Message_0x8005f211:"This operation failed because you're offline. Reconnect and try again.",Error_Message_0x8005F249:"Authentication failed",Error_Message_0x8005F20A:"Authentication failed - user cancelled",Error_Message_0x8005F20B:"Authentication failed - cookie setup failed",Error_Message_0x80042F09:"Access has not yet been fully configured for this user. The user needs at least one security role before you can continue.",Error_Message_0x80042f0c:"Your access has not yet been fully configured. Contact your administrator so that they can assign you a security role before proceeding.",Error_Message_0x80040225:"The system could not log you on. This could be because your user record or the business unit you belong to has been disabled",Error_Message_0x8004032c:"The system could not log you on. This could be because your user record or the business unit you belong to has been disabled in {#Brand_CRM}. For more information, contact your system administrator.",Error_Message_0x80040226:"You do not have permission to access these records. Contact your administrator for help.",Error_Message_0x8005f215:"You can't view this type of record on your device. Contact your system administrator.",Error_Message_0x80154b50:"You do not have sufficient permissions.",Error_Message_0x8004D24B:"Your user account has not been assigned a license. Contact your administrator.",Error_Message_0x80072560:"Your user account is not a member of this organization. Please contact your administrator.",Error_Message_0x8004A104:"Your user account is part of a disabled organization. Please contact your administrator",Error_Message_0x8004A113:"Sign-in is currently disabled. Only system administrators or system customizers can sign in at this time. Please contact your administrator",Error_Message_0x8005f21d:"Not in local store with key '{0}'",Error_Message_Generic_Mobile_Client:"Sorry, something went wrong. Please try again, or restart the app.",Button_Label_Close:"Close",Button_Label_OK:"OK",Button_Label_Cancel:"Cancel",Leave_This_Page:"Leave this page?",Leave_Page_Text:"You won’t be able to return to this page. To stay here and continue working, select Cancel.",Dialog_AuthError_Dialog_Title:"Please sign in again",Dialog_AuthError_Dialog_Description:"To continue working, please sign in again.",Dialog_Reauthenticate_Signin_Button:"Sign In",Dialog_Reauthenticate_Cancel_Button:"Cancel",Updating_Offline_Data:"Updating offline data",First_Sync_Complete_Notification:"Offline data is ready to use. You can now work offline.",First_Sync_Complete_Notification_Offline_By_Default:"App can now be used offline.",Request_Apply_Metadata_Notification:"Offline data will be ready to use after you navigate.",Request_Apply_Metadata_Notification_Offline_By_Default:"App will be ready to use offline when you navigate.",Metadata_Download_Notification:"Downloading offline data, this may take some time.",Download_Progress:"See download progress.",MailtoLink_ReportToAdmin:"{0} Click here {1} to share the information about this error screen with your Microsoft administrator.",Offline_Date_Update_Completed:"Offline data update completed",L_Offline_Updating:"Updating",First_Sync_Complete_File_Sync_Starting_Notification:"Your data is ready to be used offline. Syncing your files now...",File_Sync_Completed_Notification:"Offline files are ready to use. You can now work offline.",File_Sync_Completed_Notification_With_Error:"Error downloading the offline files. Check out the offline status page.",ServerUnavailableNotification_Offline_By_Default_Message:"Network unavailable.",Commanding_FX_Component_Not_Found_Text:"The Component Library is still publishing. Please try again.",Commanding_FX_Function_Not_Found_Text:"There was an error retrieving your formula. Please make sure your formula has no errors."}},errb:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e.date="date",e.dateTime="datetime",e.duration="duration",e.email="email",e.language="language",e.none="none",e.phone="phone",e.text="text",e.textArea="textarea",e.tickerSymbol="tickersymbol",e.timeZone="timezone",e.url="url",e.regarding="regarding"}(r||(r={}))},eruq:function(e,t,n){"use strict";n.d(t,"a",(function(){return v})),n.d(t,"b",(function(){return S}));var r,a=n("504W"),i=n("XjOj"),o=n("Div0"),s=n("H4dV"),c=n("NMtn"),l=n("jPIj"),u=n("kToj");class d{constructor(e){this._list=null,Object(u.a)(!Object(a.a)(e),"Node list obj should not be null"),this._list=e}get_count(){return this._list.length}get_item(e){return this._list[e]}}class p extends l.a{constructor(e,t){super(),this._element=null,this._namespaces=null,Object(u.a)(!Object(a.a)(e),"The element should not be null"),this._element=e,this._namespaces=Object(a.a)(t)?{}:t}get_innerText(){return this._element.hasChildNodes()?this._element.firstChild.nodeValue:null}get_outerXml(){return(new XMLSerializer).serializeToString(this._element)}get_tagName(){return this._element.nodeName}get_element(){return this._element}getAttribute(e){return this._element.getAttribute(e)}addNamespace(e,t){this._namespaces[e]=t}selectSingleNode(e){const t=this._SelectElements(e,!0);return t.get_count()?t.get_item(0):null}selectNodes(e){return this._SelectElements(e,!1)}getElementsByTagName(e){let t;t=Object(a.a)(this._element.ownerDocument)?this._element.getElementsByTagName(e):this._element.ownerDocument.getElementsByTagName(e);const n=[];for(let e=0;e<t.length;e++)n.push(t[e]);const r=this._GetElementsByTagNameWithDefaultNamespace(e);n.push(...r);const i=n.map(e=>new p(e,this._namespaces));return new d(i)}childNodes(){const e=[];for(let t=0,n=this._element.childNodes.length;t<n;t++)e.push(new p(this._element.childNodes[t],this._namespaces));return new d(e)}hasChildNodes(){return this._element.hasChildNodes()}_SelectElements(e,t){let n=[];if(e.startsWith("//")||e.startsWith(".//")){let r=2,i=!1;e.startsWith(".")&&(r++,i=!0);let o,s,c,l,u,d=(e=e.substr(r)).indexOf("/");d<0?(o=e,s=null):(o=e.substr(0,d),s=e.substr(d+1)),d=o.indexOf("["),d<0?(c=o,l=null):(c=o.substr(0,d),l=o.substr(d+1),d=l.indexOf("]"),l=l.substr(0,d)),u=i||Object(a.a)(this._element.ownerDocument)?this._element.getElementsByTagName(c):this._element.ownerDocument.getElementsByTagName(c);const p=[];for(let e=0;e<u.length;e++)p.push(u[e]);const f=this._GetElementsByTagNameWithDefaultNamespace(c);p.push(...f);let g=p;p.length>0&&null!==l&&(g=this._FilterElementList(p,l)),n=g.length&&null!==s?this._SearchElementList(g,s,t):g}else e.startsWith("/")?(Object(a.a)(this._element.ownerDocument)?n.push(this._element):n.push(this._element.ownerDocument),n=this._SearchElementList(n,e.substr(1),t)):(n.push(this._element),n=this._SearchElementList(n,e,t));const r=n.map(e=>new p(e,this._namespaces));return new d(r)}_SearchElementList(e,t,n){return n?this._SearchSingleNodeElementList(e,t):this._SearchNodesElementList(e,t)}_SearchSingleNodeElementList(e,t){if(Object(a.a)(t)||t.length<1)return e;const n=[];for(let r=0;r<e.length;r++){const i=this._SearchSingleNodeElement(e[r],t);if(!Object(a.a)(i)){n.push(i);break}}return n}_SearchSingleNodeElement(e,t){if(Object(a.a)(t)||t.length<1)return e;let n,r,i,o,s=t.indexOf("/");s<0?(n=t,r=null):(n=t.substr(0,s),r=t.substr(s+1)),s=n.indexOf("["),s<0?(i=n,o=null):(i=n.substr(0,s),o=n.substr(s+1),s=o.indexOf("]"),o=o.substr(0,s));let c=null;for(let t=0,n=e.childNodes.length;t<n;t++)if(this._IsNodeNameEqual(e.childNodes[t],i)){const n=[e.childNodes[t]];let a=n;if(null!==o&&(a=this._FilterElementList(n,o)),a.length>0){if(null===r){c=a[0];break}if(c=this._SearchSingleNodeElement(a[0],r),c)break}}return c}_SearchNodesElementList(e,t){if(Object(a.a)(t)||t.length<1)return e;const n=t.indexOf("/");let r,i;n<0?(r=t,i=null):(r=t.substr(0,n),i=t.substr(n+1));const o=[];let s;for(let t=0;t<e.length;t++)s=this._SearchElement(e[t],r),s.length>0&&o.push(...s);return o.length&&null!==i?this._SearchNodesElementList(o,i):o}_SearchElement(e,t){let n,r,a=t.indexOf("[");a<0?(n=t,r=null):(n=t.substr(0,a),r=t.substr(a+1),a=r.indexOf("]"),r=r.substr(0,a));const i=[];for(let t=0,r=e.childNodes.length;t<r;t++)this._IsNodeNameEqual(e.childNodes[t],n)&&i.push(e.childNodes[t]);let o=i;return i.length>0&&null!==r&&(o=this._FilterElementList(i,r)),o}_FilterElementList(e,t){const n=t.startsWith("@");n&&(t=t.substr(1));const r=t.indexOf("=");let a,i;r<0?(a=t,i=null):(a=t.substr(0,r),i=t.substr(r+1),i=i.substr(1),i=i.substr(0,i.length-1));const o=[];for(let t=0;t<e.length;t++){const r=e[t];(n&&this._FilterElementAttribute(r,a,i)||this._FilterElementChildElement(r,a,i))&&o.push(r)}return o}_FilterElementAttribute(e,t,n){return null===n?e.hasAttribute(t):n===e.getAttribute(t)}_FilterElementChildElement(e,t,n){for(let r=0,a=e.childNodes.length;r<a;r++)if(this._IsNodeNameEqual(e.childNodes[r],t)){if(null===n)return!0;if(e.childNodes[r].firstChild.nodeValue===n)return!0}return!1}_GetElementsByTagNameWithDefaultNamespace(e){const t=[],n=this._GetNamespaceForFullName(e);if(Object(a.a)(n)||n.length<1)return t;const r=this._GetLocalNameForFullName(e);let i;i=Object(a.a)(this._element.ownerDocument)?this._element.getElementsByTagName(r):this._element.ownerDocument.getElementsByTagName(r);for(let e=0;e<i.length;e++)i[e].namespaceURI===n&&t.push(i[e]);return t}_GetNamespaceForFullName(e){const t=e.indexOf(":");if(t<0)return"";const n=e.substr(0,t);return this._namespaces[n]}_GetLocalNameForFullName(e){const t=e.indexOf(":");return t<0?e:e.substr(t+1)}_IsNodeNameEqual(e,t){if(e.nodeName===t||"*"===t)return!0;const n=this._GetNamespaceForFullName(t);if(Object(a.a)(n)||n.length<1)return!1;const r=this._GetLocalNameForFullName(t);return e.namespaceURI===n&&e.localName===r}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */!function(e){e[e.ANY_TYPE=0]="ANY_TYPE",e[e.NUMBER_TYPE=1]="NUMBER_TYPE",e[e.STRING_TYPE=2]="STRING_TYPE",e[e.BOOLEAN_TYPE=3]="BOOLEAN_TYPE",e[e.UNORDERED_NODE_ITERATOR_TYPE=4]="UNORDERED_NODE_ITERATOR_TYPE",e[e.ORDERED_NODE_ITERATOR_TYPE=5]="ORDERED_NODE_ITERATOR_TYPE",e[e.UNORDERED_NODE_SNAPSHOT_TYPE=6]="UNORDERED_NODE_SNAPSHOT_TYPE",e[e.ORDERED_NODE_SNAPSHOT_TYPE=7]="ORDERED_NODE_SNAPSHOT_TYPE",e[e.ANY_UNORDERED_NODE_TYPE=8]="ANY_UNORDERED_NODE_TYPE",e[e.FIRST_ORDERED_NODE_TYPE=9]="FIRST_ORDERED_NODE_TYPE"}(r||(r={}));class f{constructor(e,t,n){if(this._list=null,Object(u.a)(!Object(a.a)(e),"XPathEvaluator should not be null"),Object(u.a)(!Object(a.a)(t),"Node list obj should not be null"),this._list=[],t instanceof XPathResult){const r=t;for(let t=0;t<r.snapshotLength;t++)this._list.push(new m(e,r.snapshotItem(t),n))}else{const r=t;for(let t=0;t<r.length;t++)this._list.push(new m(e,r[t],n))}}get_count(){return this._list.length}get_item(e){return this._list[e]}}var g,h=n("Hswk");class m extends l.a{constructor(e,t,n){super(),this._namespaces=null,this._evaluator=null,this._element=null,Object(u.a)(!Object(a.a)(e),"The XPathEvaluator should not be null"),this._evaluator=e,this._element=Object(a.a)(t)?e:t,this._namespaces=Object(a.a)(n)?{}:n}get_innerText(){return this._element.hasChildNodes()?this._element.firstChild.nodeValue:null}get_outerXml(){return(new XMLSerializer).serializeToString(this._element)}get_tagName(){return this._element.tagName}get_element(){return this._element}addNamespace(e,t){this._namespaces[e]=t}selectSingleNode(e){const t=this._evaluator.evaluate(e,this._element,Object(h.a)(this,this._ResolveNamespaces,"ResolveNamespaces"),r.FIRST_ORDERED_NODE_TYPE,null);return Object(a.a)(t.singleNodeValue)?null:new m(this._evaluator,t.singleNodeValue,this._namespaces)}selectNodes(e){return new f(this._evaluator,this._evaluator.evaluate(e,this._element,Object(h.a)(this,this._ResolveNamespaces,"ResolveNamespaces"),r.ORDERED_NODE_SNAPSHOT_TYPE,null),this._namespaces)}getAttribute(e){return this._element.getAttribute(e)}getElementsByTagName(e){return new f(this._evaluator,this._element.getElementsByTagName(e),this._namespaces)}childNodes(){return new f(this._evaluator,this._element.childNodes,this._namespaces)}hasChildNodes(){return this._element.hasChildNodes()}_ResolveNamespaces(e){return e in this._namespaces?this._namespaces[e]:null}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */!function(e){e[e[void 0]=-1]="undefined",e[e.xPath=0]="xPath",e[e.domParser=1]="domParser"}(g||(g={}));let b=g.undefined;function y(){return b}function _(e){return b=e,e}function v(e){return Object(a.a)(e)?null:(y()===g.undefined&&function(e){if(function(e){const t=document.evaluate,n=document.createNSResolver&&document.createNSResolver(e),r=s.a.getInstance().get_IsBrowserIE();return!Object(a.a)(t)&&n&&!r}(e)){const t=new m(e);try{t.selectSingleNode("/root"),_(0)}catch(e){Object(i.f)(o.a.xmlNodeFactory,"XPathEvaluator doesn't work on this browser.")}}y()===g.undefined&&function(){const e=window.DOMParser;return!Object(a.a)(e)}()&&_(g.domParser);y()===g.undefined&&Object(c.d)(y(),"PreferredXmlEvaluator")}(e),y()?new p(e):new m(e))}function S(e){let t=null;if(Object(a.a)(t)&&(t=(new DOMParser).parseFromString(e,"text/xml")),!Object(a.a)(t)){const e=t.getElementsByTagName("parsererror");!Object(a.a)(e)&&e.length>0&&(Object(i.i)(o.a.xmlNodeFactory,"XML Parsing failure in ParseXmlDocument"),t=null)}return t}},"f+LF":function(e,t,n){"use strict";n.d(t,"f",(function(){return p})),n.d(t,"b",(function(){return g})),n.d(t,"g",(function(){return h})),n.d(t,"j",(function(){return f})),n.d(t,"h",(function(){return m})),n.d(t,"i",(function(){return b})),n.d(t,"a",(function(){return y})),n.d(t,"c",(function(){return _})),n.d(t,"e",(function(){return v})),n.d(t,"d",(function(){return S})),n.d(t,"k",(function(){return O}));var r=n("5Wsx"),a=n("E5IU"),i=n("M+aw"),o=n("69Qu"),s=n("Lyxw"),c=n("3/02"),l=n("YkaX"),u=n("DsuF"),d=n("3hnk");function p(e){const t=Object(o.c)(e);return Object(a.i)("AllowNotificationsEarlyAccess",e)&&t}function f(e){return Object(s.f)(e,c.lf)||p(e)}function g(e,t){const n=p(e),r=Object(d.g)(e,u.a,2,0);if(n&&!r&&t){t.TraceManager.getTracer("AppNotificationBellButtonDisplay").warn("User lacks privilege for the operation on app notification entity, notification bell not rendering.")}return n&&r}function h(e){return e.notificationCenter.initialized}function m(e){return e.notificationCenter.isNotificationPanelVisible}function b(e){return e.notificationCenter.isNotificationSettingsPanelVisible}function y(e){return e.notificationCenter.appNotificationIds}function _(e){const t=Object(r.a)(e,l.c.NotificationsLastAlertedOn);return t&&t.value}function v(e){const t=Object(r.a)(e,l.c.NotificationsLastViewedOn);return t&&t.value}function S(e){const t=Object(r.a)(e,l.c.NotificationsLastDismissedAllOn);return t&&t.value}function O(e){let t=0;const n=y(e),r=Object(i.b)(e),a=v(e);return n.forEach(e=>{r[e]&&r[e].createdOn>a&&t++}),t}},"f/sd":function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.Initial=0]="Initial",e[e.Loading=1]="Loading",e[e.MetadataRetrieved=2]="MetadataRetrieved",e[e.OnLoadReady=3]="OnLoadReady",e[e.EditReady=4]="EditReady",e[e.FullLoad=5]="FullLoad",e[e.Error=6]="Error"}(r||(r={}))},"f07+":function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"k",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"i",(function(){return o})),n.d(t,"f",(function(){return s})),n.d(t,"j",(function(){return c})),n.d(t,"d",(function(){return l})),n.d(t,"a",(function(){return u})),n.d(t,"e",(function(){return d})),n.d(t,"h",(function(){return p})),n.d(t,"g",(function(){return f}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class r{constructor(e,t,n=!0,r=!1,a=null,i=null){this.etn=e,this.payload=t,this.suppressDupeDetection=n,this.returnRowVersion=r,this.offlineData=a,this.solutionUniqueName=i}getMetadata(){return{boundParameter:void 0,parameterTypes:{},operationName:"Create",operationType:2}}}class a{constructor(e,t,n,r,a,i,o,s,c,l,u=null){this.etn=e,this.id=t,this.payload=n,this.urlParams=r,this.headers=a,this.isBinaryPayload=i,this.suppressDupeDetection=o,this.ifMatch=s,this.returnRowVersion=c,this.offlineData=l,this.solutionUniqueName=u}getMetadata(){return{boundParameter:void 0,parameterTypes:{},operationName:"Update",operationType:2}}}class i{constructor(e,t,n,r){this.entityReference=e,this.attributeName=t,this.ifMatch=n,this.offlineData=r}getMetadata(){return{boundParameter:void 0,parameterTypes:{entityReference:{typeName:"mscrm.crmbaseentity",structuralProperty:5}},operationName:"Delete",operationType:2}}}class o{constructor(e,t,n){this.entityReference=e,this.columns=t,this.navigationPropertyDetails=n}getMetadata(){return{boundParameter:void 0,parameterTypes:{},operationName:"Retrieve",operationType:2}}}class s{constructor(e,t=!1){this.requests=e,this.continueOnError=t}getMetadata(){return{boundParameter:void 0,parameterTypes:{},operationName:"ExecuteMultiple",operationType:3}}}class c{constructor(e,t,n,r,a,i=!1){this.etn=e,this.id=t,this.urlParams=n,this.headers=r,this.maxPageSize=a,this.isBinary=i}getMetadata(){return{boundParameter:void 0,parameterTypes:{},operationName:"RetrieveWithUrlParams",operationType:2}}}class l{constructor(e,t,n,r,a){this.etn=e,this.id=t,this.urlParams=n,this.ifMatch=r,this.offlineData=a}getMetadata(){return{boundParameter:void 0,parameterTypes:{},operationName:"DeleteWithUrlParams",operationType:2}}}class u{constructor(e,t,n){this.target=e,this.relationship=t,this.relatedEntities=n}getMetadata(){return{boundParameter:"target",parameterTypes:{target:{typeName:"mscrm.crmbaseentity",structuralProperty:5},relationship:{typeName:"Edm.String",structuralProperty:1},relatedEntities:{typeName:"mscrm.crmbaseentity",structuralProperty:4}},operationName:"Associate",operationType:2}}}class d{constructor(e,t,n){this.target=e,this.relationship=t,this.relatedEntityId=n||null}getMetadata(){return{boundParameter:"target",parameterTypes:{},operationName:"Disassociate",operationType:2}}}class p{constructor(e,t,n){this.filter=e,this.columns=t,this.query=n}getMetadata(){return{boundParameter:void 0,parameterTypes:{},operationName:"EntityDefinitions",operationType:2}}}class f{constructor(e,t){this.Target=e,this.principal=t}getMetadata(){return{boundParameter:"principal",parameterTypes:{principal:{structuralProperty:5,typeName:"Microsoft.Dynamics.CRM.systemuser"},Target:{structuralProperty:5,typeName:"Microsoft.Dynamics.CRM.crmbaseentity"}},operationName:"RetrievePrincipalAccess",operationType:1}}}},fA3V:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * The unique name of the WebResource page module.
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="WebResource"},fC8v:function(e,t,n){"use strict";n.d(t,"d",(function(){return m})),n.d(t,"f",(function(){return g})),n.d(t,"e",(function(){return p})),n.d(t,"c",(function(){return b})),n.d(t,"b",(function(){return _})),n.d(t,"a",(function(){return S}));var r=n("eXjw"),a=n("SAYH"),i=n("504W"),o=n("pEXn"),s=n("Ae6N"),c=n("/A0C"),l=n("nTyX"),u=n("vSoM");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function d(e){if(!e)return null;let t;return"AttributeTypeName"in e&&e.AttributeTypeName.Value?t=e.AttributeTypeName.Value.replace(/Type/g,""):"AttributeType"in e&&e.AttributeType&&"string"==typeof e.AttributeType&&(t=e.AttributeType),t?"Float"===t?c.a.Double:t.toLowerCase():null}function p(e,t,n){const r=t.Attributes,a={};if(r)for(const i of r){const r=h(e,i,t,n);a[r.LogicalName]=r}return a}function f(e){if("string"!=typeof e)return"number"==typeof e?e:null;switch(e){case"Auto":return 0;case"Inactive":return 1;case"Active":return 2;case"Disabled":return 3;default:return null}}function g(e,t,n){if(Object(i.a)(e))t&&t.warn("RequiredLevel is set to Unknown with null or undefined value",n);else{let r;if(r=Object(i.a)(e.Value)?e:e.Value,"string"==typeof r)switch(e){case"None":return 0;case"SystemRequired":return 1;case"ApplicationRequired":return 2;case"Recommended":return 3;default:return t&&t.warn("RequiredLevel is set to Unknown with value "+e,n),-1}if("number"==typeof r)return r}return-1}function h(e,t,n,i){var c;let l=null;const p=t,h=Object(u.b)(e),y=Object(u.c)(e);if(p.DateTimeBehavior)for(const e in p.DateTimeBehavior)switch(p.DateTimeBehavior[e]){case"None":l=s.a.None;break;case"DateOnly":l=s.a.DateOnly;break;case"TimeZoneIndependent":l=s.a.TimeZoneIndependent;break;case"UserLocal":l=s.a.UserLocal;break;default:l=s.a.None}const S=t,O=[{name:o.b.EntityName,value:t.EntityLogicalName},{name:o.b.AttributeName,value:t.LogicalName}];return{Initialized:r.a.Initialized,LogicalName:t.LogicalName,Id:a.a.tryParseOrNull(t.MetadataId),EntityLogicalName:S.EntityLogicalName,Type:d(t),DisplayName:_(h,y,S.DisplayName),Description:_(h,y,S.Description),IsGlobalFilterEnabled:!!S.IsGlobalFilterEnabled&&S.IsGlobalFilterEnabled.Value,IsSecured:S.IsSecured,IsSortableEnabled:!!S.IsSortableEnabled&&S.IsSortableEnabled.Value,IsEntityReferenceStored:S.IsEntityReferenceStored,IsValidForAdvancedFind:!!S.IsValidForAdvancedFind&&S.IsValidForAdvancedFind.Value,IsValidForGrid:Object(u.a)(h,y,S.IsValidForGrid),IsValidForCreate:S.IsValidForCreate,IsValidForRead:S.IsValidForRead,IsValidForUpdate:S.IsValidForUpdate,IsRetrievable:Object(u.a)(h,y,S.IsRetrievable),IsCustomAttribute:Object(u.a)(h,y,S.IsCustomAttribute),IsLogical:S.IsLogical,ColumnNumber:S.ColumnNumber,MaxLength:S.MaxLength,MinValue:S.MinValue,MaxValue:S.MaxValue,Precision:S.Precision,PrecisionSource:S.PrecisionSource,Format:v(S),FormatName:null===(c=S.FormatName)||void 0===c?void 0:c.Value,Behavior:l,DefaultFormValue:S.DefaultFormValue,DefaultValue:"number"==typeof S.DefaultFormValue?S.DefaultFormValue:Object(u.a)(h,y,S.DefaultValue),IsBaseCurrency:Object(u.a)(h,y,S.IsBaseCurrency),Targets:S.Targets,AttributeOf:S.AttributeOf,HasChanged:Object(u.a)(h,y,S.HasChanged),ImeMode:f(S.ImeMode),OptionSetId:S.OptionSet&&S.OptionSet.MetadataId?S.OptionSet.MetadataId:null,OptionSetName:S.OptionSet&&S.OptionSet.Name?S.OptionSet.Name:null,OptionSetType:S.OptionSet?m(h,y,S.OptionSet.OptionSetType):null,OptionSet:b(e,S.OptionSet),ParentPicklistLogicalName:S.OptionSet&&S.ParentPicklistLogicalName?S.ParentPicklistLogicalName:null,ChildPicklistLogicalNames:S.OptionSet&&S.ChildPicklistLogicalNames?S.ChildPicklistLogicalNames:null,RequiredLevel:g(S.RequiredLevel,i,O),SourceType:S.SourceType,SourceTypeMask:S.SourceTypeMask,InheritsFrom:S.InheritsFrom,CanBeSecuredForCreate:Object(u.a)(h,y,S.CanBeSecuredForCreate),CanBeSecuredForRead:Object(u.a)(h,y,S.CanBeSecuredForRead),CanBeSecuredForUpdate:Object(u.a)(h,y,S.CanBeSecuredForUpdate)}}function m(e,t,n){return e&&t&&Object(i.a)(n)?0:n}function b(e,t){let n=null;if(t&&(n=[],t.FalseOption&&n.push(y(e,t.FalseOption)),t.TrueOption&&n.push(y(e,t.TrueOption)),t.Options)){const r=t.Options;for(const t of r)n.push(y(e,t))}return n}function y(e,t){const n=[],r=t.TransitionData,a=Object(u.b)(e),i=Object(u.c)(e);if(r){const e=(new DOMParser).parseFromString(r,"text/xml");if("parsererror"!==e.documentElement.nodeName)for(let t=0;t<e.documentElement.childNodes.length;t++){const r=e.documentElement.childNodes[t];if("allowedtransition"===r.nodeName)for(const e in r.attributes){"tostatusid"===r.attributes[e].name&&n.push(Number(r.attributes[e].value))}}}return{Color:t.Color,Label:_(a,i,t.Label),Value:t.Value,DefaultStatus:t.DefaultStatus,State:t.State,TransitionData:r?n:null,InvariantName:t.InvariantName,ParentValues:t.ParentValues}}function _(e,t,n){var r;return n&&n.UserLocalizedLabel?e&&t&&Object(i.a)(n.UserLocalizedLabel.Label)?"":null!==(r=n.UserLocalizedLabel.Label)&&void 0!==r?r:null:null}function v(e){const t=e,n=t.FormatName?t.FormatName.Value:null;return S(Object(l.c)(t.AttributeType),n,t.Format)}function S(e,t,n){if(e===c.a.String&&"string"==typeof t)return t;let r="";if(null==n)r=n;else if(e&&e===c.a.DateTime)switch(n){case 0:r=c.a.Date;break;case 1:r=c.a.DateTime;break;default:r=n.toString()}else r=n.toString();return r}},fHQ8:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n("pF61");const a="store.page.metadata";function i(e){return{type:"store.page.metadata.sync",sync:!0,execute({dispatch:t,getState:n}){const i=Array.from(e);t(function(e,t){return{type:a,payload:{metadataInput:t},meta:{pageId:e}}}(Object(r.b)(n())||Object(r.c)(n()),i))}}}},fILV:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * The unique name of the Grid page module.
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="EntityList"},fMBw:function(e,t,n){"use strict";var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.PerformanceEventTracker=void 0;var a=n("ZrDD"),i=function(){function e(){this._transportVersion=0,this._transportFunctionsByZone={},this.resetTransports()}return e.prototype.getTransports=function(e){var t=this._transports[e];return t?this._transports.__all__.concat(t):this._transports.__all__},e.prototype._getTransportFunction=function(e){var t,n,r=this;if(this._transportFunctionsByZone[e])return this._transportFunctionsByZone[e];var a=function(){return(!t||r._transportVersion>n)&&(t=r.getTransports(e),n=r._transportVersion),t};return this._transportFunctionsByZone[e]=a,a},e.prototype.resetTransports=function(){var e;this._transports=((e={}).__all__=[],e),this._transportVersion++},e.prototype.registerTransport=function(e,t){var n,a;if(void 0===t&&(t=null),t&&0!==t.length)try{for(var i=r(t),o=i.next();!o.done;o=i.next()){var s=o.value;this._transports[s]?this._transports[s].push(e):this._transports[s]=[e]}}catch(e){n={error:e}}finally{try{o&&!o.done&&(a=i.return)&&a.call(i)}finally{if(n)throw n.error}}else this._transports.__all__.push(e);this._transportVersion++},e.prototype.removeTransport=function(e){var t,n,a=Object.keys(this._transports);try{for(var i=r(a),o=i.next();!o.done;o=i.next()){var s=o.value,c=this._transports[s],l=c.indexOf(e);l>-1&&c.splice(l,1)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}this._transportVersion++},e.prototype.createEvent=function(e,t){return new a.PerformanceEvent(e,t,this._getTransportFunction(t))},e}();t.PerformanceEventTracker=i;var o=new i;t.default=o},fU4N:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.Unknown=-1]="Unknown",e[e.RelevanceSearch=0]="RelevanceSearch",e[e.CategorizedSearch=1]="CategorizedSearch",e[e.CustomSearch=2]="CustomSearch",e[e.Default=1]="Default"}(r||(r={}))},fU7K:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e){return null==e}function a(e){return r(e)?e:("string"!=typeof e&&(e=e.toString()),e=e.replace(/%u[a-fA-F0-9]{4}/g,e=>String.fromCharCode(parseInt(e.substr(2,e.length-2),16))),decodeURIComponent(e))}function i(e){return r(e)?e:("string"!=typeof e&&(e=e.toString()),e=(e=(e=function(e){let t,n="";if(null===e)return null;if(""===e)return"";for(let r=0;r<e.length;r++)t=e.charCodeAt(r),t>96&&t<123||t>64&&t<91||t>47&&t<58||46===t||45===t||95===t?n+=String.fromCharCode(t):n=t>127?n+"%u"+O(t):n+"%"+S(t);return n}(e)).replace(/%u[dD][89aAbB][a-fA-F0-9]{2}%u[dD][cCdDeEfF][a-fA-F0-9]{2}/g,e=>encodeURIComponent(String.fromCharCode(parseInt(e.substring(2,6),16))+String.fromCharCode(parseInt(e.substring(8),16))))).replace(/%u[a-fA-F0-9]{4}/g,e=>encodeURIComponent(String.fromCharCode(parseInt(e.substr(2,e.length-2),16)))))}function o(e){return r(e)?e:("string"!=typeof e&&(e=e.toString()),i(e))}function s(e){return r(e)?e:("string"!=typeof e&&(e=e.toString()),a(e))}function c(e){return r(e)?e:e=e.replace(/&[^;]+;/g,e=>{switch(e){case"&lt;":return"<";case"&gt;":return">";case"&amp;":return"&";case"&quot;":return'"';case"&apos;":return"'";case"&nbsp;":return" "}return e.match(/&#[0-9]+;/g)?l(e.substr(2,e.length-3)):e.match(/&#x[a-fA-F0-9]+;/g)?l(parseInt(e.substr(3,e.length-4),16)):e})}function l(e){return e>65535&&e<1114112?(e-=65536,String.fromCharCode(55296+(e>>10),56320+(1023&e))):String.fromCharCode(e)}function u(e){return r(e)?e:("string"!=typeof e&&(e=e.toString()),m(e,_))}function d(e){return c(e)}function p(e){return r(e)?e:("string"!=typeof e&&(e=e.toString()),m(e,b))}function f(e){return r(e)?e:("string"!=typeof e&&(e=e.toString()),m(e,y))}function g(e){return r(e)?e:("string"!=typeof e&&(e=e.toString()),m(e,v))}function h(e){return r(e)?e:("string"!=typeof e&&(e=e.toString()),function(e){let t,n="";if(null==e)return null;if(""===e)return"";for(let r=0;r<e.length;r++)t=e.charCodeAt(r),t>96&&t<123||t>64&&t<91||32===t||t>47&&t<58||46===t||44===t||45===t||95===t?n+=String.fromCharCode(t):n=t>127?n+"\\u"+O(t):n+"\\x"+S(t);return"'"+n+"'"}(e))}function m(e,t){return e=(e=(e=t(e=(e=e.replace(new RegExp("([\\uD800-\\uDBFF][\\uDC00-\\uDFFF])","g"),e=>"CRMEntityReferenceOpen"+(1024*(e.charCodeAt(0)-55296)+(1023&e.charCodeAt(1))+65536).toString(16)+"CRMEntityReferenceClose")).replace(new RegExp("[\\uD800-\\uDFFF]","g"),"�"))).replace(/CRMEntityReferenceOpen/g,"&#x")).replace(/CRMEntityReferenceClose/g,";")}function b(e){let t,n="",r="";let a=0;if(null===e)return null;if(""===e)return"";for(let i=0;i<e.length;i++)t=e.charCodeAt(i),r+=t>96&&t<123||t>64&&t<91||32===t||t>47&&t<58||46===t||44===t||45===t||95===t?String.fromCharCode(t):"&#"+t+";",500==++a&&(n+=r,r="",a=0);return r.length&&(n+=r),n}function y(e){let t,n="";if(null===e)return null;if(""===e)return"";for(let r=0;r<e.length;r++)t=e.charCodeAt(r),t>96&&t<123||t>64&&t<91||t>47&&t<58||46===t||44===t||45===t||95===t?n+=String.fromCharCode(t):n=n+"&#"+t+";";return n}function _(e){return b(e)}function v(e){return y(e)}function S(e){if(null===e)return"";let t=e.toString(16);for(let e=t.length;e<2;e++)t="0"+t;return t}function O(e){if(null===e)return"";let t=e.toString(16);for(let e=t.length;e<4;e++)t="0"+t;return t}n.r(t),n.d(t,"CrmUrlDecode",(function(){return a})),n.d(t,"CrmUrlEncode",(function(){return i})),n.d(t,"CrmNameValueEncode",(function(){return o})),n.d(t,"CrmNameValueDecode",(function(){return s})),n.d(t,"CrmXmlDecode",(function(){return c})),n.d(t,"CrmXmlEncode",(function(){return u})),n.d(t,"CrmHtmlDecode",(function(){return d})),n.d(t,"CrmHtmlEncode",(function(){return p})),n.d(t,"CrmHtmlAttributeEncode",(function(){return f})),n.d(t,"CrmXmlAttributeEncode",(function(){return g})),n.d(t,"CrmJavaScriptEncode",(function(){return h}))},fVHw:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("nxt5");class a extends r.a{constructor(e,t){super("Create"),this._id=null,this._entityReference=null,this._id=e,this._entityReference=t}get_id(){return this._id}get_entityReference(){return this._entityReference}set_entityReference(e){return this._entityReference=e,e}}},fWyz:function(e,t,n){"use strict";n.d(t,"b",(function(){return F})),n.d(t,"c",(function(){return k})),n.d(t,"a",(function(){return L}));var r=n("w1eR"),a=n("0uKS"),i=n("fA3V"),o=n("ruPX");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function s(e,t,n,r,a){const s={webresourceName:e,webresourceData:t,passParams:n};return Object(o.a)(i.a,s,a,r)}var c=n("+baL"),l=n("wRZP"),u=n("zu1I"),d=n("NjDY"),p=n("SAYH"),f=n("D+Bz"),g=n("X37l"),h=n("cfbi"),m=n("gw2m"),b=n("GYEz"),y=n("d4He"),_=n("d0w6");function v(e){const t=[];return e?(t.push({name:"Entity",value:e.Entity}),t.push({name:"DefaultDashboard",value:e.DefaultDashboard}),t.push({name:"Id",value:e.Id}),t.push({name:"Url",value:e.Url}),t):t}var S=n("d6Hx"),O=n("RiEM"),C=n("lYcl"),E=n("pgSX"),I=n("si7p"),w=n("YxC/"),j=n("EY5k"),P=n("ngeo");var T=n("Uv1Y"),N=n("KdpX"),A=n("bwbe"),R=n("0FMG"),D=n("qn5m");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const x=[A.b,A.c],M=/(http|https):\/\/(\w+:{0,1}\w*)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%!\-\/]))?/;function F(e,t,n,i,g){const h="object"==typeof i?i:{source:i||f.b.Other};return{type:"Navigate to sitemap SitemapAreaEntry",execute(i,_){const{dispatch:A,getState:x}=i;let F=null,k=null;const B=v(e);B.push({name:"Source",value:null==h?void 0:h.source});const U=Object(d.x)(x()),V=U&&U.split("/"),z=V&&(V.length>1?V[V.length-2]+"/":void 0);if(U&&e.Url&&e.Url.toLowerCase().startsWith(U.toLowerCase())){const t=e.Url.substring(U.length);F=A("msdyn_appmanagementcontrol"===t?Object(l.a)(t,h):s(t,void 0,!!e.PassParams,h))}else if(e.Entity)F=A(Object(a.a)(e.Entity,void 0,void 0,void 0,void 0,void 0,void 0,h,void 0,void 0,g));else if(L(e,_.TraceManager.getTracer(S.n))){const t=e.DefaultDashboard?new p.a(e.DefaultDashboard):null,n=Object(b.a)(x())!==r.a.MailApp;F=A(Object(c.a)(null,t,h,null,N.a,n))}else if(e.Url&&/^\/([0-9a-zA-Z_]+\/)?main.aspx/.test(e.Url))F=A(Object(o.a)(e.Url,null,void 0,h));else if(e.Url&&e.Url===O.a)F=A(Object(C.a)(""));else if(e.Url&&e.Url.startsWith("http"))if(M.test(e.Url)){let t=e.Url;e.PassParams&&(t=Object(D.a)(x(),t)),A(Object(y.a)(t)),F=Promise.resolve({status:0,pageId:null})}else k=new T.a("Sub area "+e.Id+" with Url "+e.Url+" has an unsupported Url scheme");else if(z&&e.Url){const t=e.Url.toLowerCase().indexOf(z.toLowerCase());if(t>=0){_.TraceManager.getTracer(S.n).info("Opening SubArea web resource relative path: "+e.Url,B);const n=e.Url.substring(t+z.length);F=A(s(n,void 0,!!e.PassParams,h))}else k=new T.a("Sub area "+e.Id+" with relative Url "+e.Url+" was expected to map to a webresource, but doesn’t contain web resource path "+z)}else if(e.DynamicPage){const t={windowPosition:"inline"};F=A(Object(u.b)(e.DynamicPage,t,null))}else if(e.Page){const t={name:e.Page};F=A(Object(o.a)(m.a,t,void 0,h))}else k=U?new T.a("Sub area with ID "+e.Id+" could not be mapped to a supported navigation route"):new T.a("Webresource path was null when trying to open SubArea",-2147220970);if(k){const t=e.Titles&&e.Titles.length&&e.Titles[0].Title;A(function(e,t){return{type:"sitemap.subarea.error.dialog",execute(n,r,a){let i="SubArea_InvalidSitemapConfig_Error_Title",o="SubArea_InvalidSitemapConfig_Error_Message";if(t.errorCode){const e="0x"+P.a.getHexErrorCodeFromInt(t.errorCode);i="Error_Title_"+e,o="Error_Message_"+e}const s=[i,o,"Button_Label_OK","L_Show_Details_Text"];return n.dispatch(Object(j.e)(s)).then(()=>{const r=Object(w.e)(n.getState(),s),a=Object(w.c)(r,i),c=Object(w.c)(r,o),l=Object(w.c)(r,"Button_Label_OK"),u=Object(w.c)(r,"L_Show_Details_Text"),d=c.replace("{0}",e);n.dispatch(Object(E.a)(I.d,"",{type:"error"},"",a,d,l,u,[t.message]))})}}}(t,k)),F=Promise.resolve({status:1,error:k}),_.EventManager.ReportComponentFailure(S.n,k,"Utilize event params to understand failure",B)}return t&&n&&n(),F?(F.then(t=>{0===t.status&&t.pageId&&(h.source===f.b.SiteMapSubArea&&A(Object(R.f)(e.Id,t.pageId)),B.push({name:"PageId",value:t.pageId})),B.push({name:"NavigationStatus",value:t.status}),_.EventManager.ReportComponentSuccess(S.n,B)}),F):Promise.resolve(void 0)}}}function k(e,t,n,r){return r=r||f.b.Other,{type:"Navigate to sitemap SitemapAreaEntry",execute(i,s){const{dispatch:l}=i;let u=null;if(e.RecordType===g.a.Grid)u=e.IsUserView?l(Object(a.a)(e.EntityTypeName,void 0,e.ObjectId,void 0,void 0,void 0,void 0,r,_.b.userview)):l(Object(a.a)(e.EntityTypeName,void 0,e.ObjectId,void 0,void 0,void 0,void 0,r));else if(e.RecordType===g.a.Isv||x.indexOf(e.EntityTypeName)>-1){const t=e.EntityTypeName===A.b?N.a:e.EntityTypeName===A.c?N.b:null;u=l(Object(c.a)(null,e.ObjectId,r,null,t))}else if(e.RecordType===g.a.Entity)if("report"===e.EntityTypeName){const t={};t.entityName=e.EntityTypeName,t.entityId=e.ObjectId.guid?e.ObjectId.guid:void 0,Xrm.Navigation.openForm(t).then(e=>{},e=>{})}else{let t={};t={entityTypeName:e.EntityTypeName,id:e.ObjectId.guid?new p.a(e.ObjectId.guid):void 0},u=l(Object(o.a)(h.b,t,void 0,r))}else s.EventManager.ReportComponentFailure(S.n,"Unsupported SubArea of type "+e.RecordType,"Utilize event params to understand failure",function(e){const t=[];return e&&(t.push({name:"EntityTypeName",value:e.EntityTypeName}),t.push({name:"IsUserView",value:e.IsUserView}),t.push({name:"LastAccessed",value:e.LastAccessed}),t.push({name:"IsUserView",value:e.Title}),t.push({name:"PinStatus",value:e.PinStatus}),e.ObjectId&&t.push({name:"ObjectId",value:e.ObjectId.guid}),e.RecordType&&t.push({name:"RecordType",value:e.RecordType.toString()})),t}(e));return t&&n&&n(),u||Promise.resolve(void 0)}}}function L(e,t){return!!e.DefaultDashboard||!(!e.Url||!new URL(e.Url,window.location.origin).pathname.endsWith("workplace/home_dashboards.aspx"))&&(t&&!e.Url.endsWith("workplace/home_dashboards.aspx")&&t.warn("Unexpected Dashboard URL",v(e)),!0)}},fYtF:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"e",(function(){return p})),n.d(t,"c",(function(){return f})),n.d(t,"d",(function(){return d})),n.d(t,"a",(function(){return l}));var r=n("SAYH"),a=n("jRy5"),i=n("g22U"),o=n("Wc7r"),s=n("504W"),c=n("BFlg");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const l="QueryBuilder";class u{constructor(){this._telemetryMessage="",this._telemetryParameters=[],this._operations=[]}addOperation(e,t){this._telemetryMessage="to"===e||"from"===e?this._telemetryMessage?`${this._telemetryMessage}, ${t}`:t:this._telemetryMessage?`${this._telemetryMessage}, ${e}`:e,t&&this._operations.push({name:e,value:t})}addQueryInfoAndSendLog(e,t){u.tracer&&(this._addTelemetryParameter("viewId",e),this._addTelemetryParameter("entityLogicalName",t),this._addTelemetryParameter("operations",this._operations),u.tracer.info(`[${l}] ${t}-${e}: `+this._telemetryMessage,this._telemetryParameters))}_addTelemetryParameter(e,t){t&&this._telemetryParameters.push({name:e,value:t})}}function d(e,t){e&&(e.additionalHeaders[o.HEADER.VIEW_ID_HINT]&&t.push({name:"viewId",value:e.additionalHeaders[o.HEADER.VIEW_ID_HINT]}),e.additionalHeaders[o.HEADER.PAGESIZE_HINT]&&t.push({name:"pageSize",value:e.additionalHeaders[o.HEADER.PAGESIZE_HINT]}),e.additionalHeaders[o.HEADER.PAGE_NUMBER_HINT]&&t.push({name:"pageNumber",value:e.additionalHeaders[o.HEADER.PAGE_NUMBER_HINT]}),e.additionalHeaders[o.HEADER.ORDERBY_HINT]&&t.push({name:"orderBy",value:e.additionalHeaders[o.HEADER.ORDERBY_HINT]}),e.additionalHeaders[o.HEADER.SELECT_HINT]&&t.push({name:"select",value:e.additionalHeaders[o.HEADER.SELECT_HINT]}),e.additionalHeaders[o.HEADER.LINK_HINT]&&t.push({name:"linkentity",value:!0}),e.additionalHeaders[o.HEADER.SEARCH_HINT]&&t.push({name:"isQuickFindSearch",value:!0}),e.additionalHeaders[o.HEADER.FILTER_HINT]&&t.push({name:"filter",value:!0}),e.additionalHeaders[o.HEADER.CONTEXT_FILTER]&&t.push({name:"contextfilter",value:!0}))}function p(e){const t=[];return e&&(e.viewId&&t.push({name:"viewId",value:r.a.toString(e.viewId)}),e.entityLogicalName&&t.push({name:"entityLogicalName",value:e.entityLogicalName}),e.pageSize&&t.push({name:"pageSize",value:e.pageSize}),e.pageNumber&&t.push({name:"pageNumber",value:e.pageNumber}),t.push({name:"useModernQueryBuilder",value:e.useModernQueryBuilder||!1}),t.push({name:"isQuickFindSearch",value:e.isQuickFindSearch||!1}),e.selects&&e.selects.length>0&&t.push({name:"select",value:e.selects.toString()}),e.sorts&&e.sorts.length>0&&t.push({name:"orderBy",value:e.sorts.toString()}),!Object(s.a)(e.rollupType)&&t.push({name:"rollupcontextfilter",value:e.rollupType.toString()}),e.wheres&&e.wheres.length>0&&t.push({name:"filter",value:e.wheres.length}),e.linkEntities&&e.linkEntities.length>0&&t.push({name:"linkentity",value:e.linkEntities.length}),e.contextFiltersAndIds&&e.contextFiltersAndIds.length>0&&t.push({name:"contextfilter",value:e.contextFiltersAndIds.length})),t}function f(e,t,n){return e&&(!0===e.isCustomView?e.queryContext=i.c.CustomView:e.searchString?e.queryContext=i.c.Quickfind:"MscrmControls.FieldControls.SimpleLookupControl"===n?e.queryContext=i.c.Lookup:!t||t!==a.a.SubGrid&&t!==a.a.AssociatedGrid?n===c.D||n===c.y||n===c.C||t===a.a.MainGrid?e.queryContext=i.c.Grid:e.queryContext=i.c.RetrieveMultipleOther:e.queryContext=i.c.Subgrid),e}},ff1s:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return s}));var r=n("17x/");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e){return e.cache.isCacheEnabled}function i(e){return r.e(e)?3:e.cache.codeCacheState}function o(e){return!!r.e(e)||3===e.cache.codeCacheState}function s(e){return!r.e(e)&&4===e.cache.codeCacheState}},fh2P:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return c})),n.d(t,"e",(function(){return d})),n.d(t,"f",(function(){return l})),n.d(t,"g",(function(){return u}));var r=n("5Oca"),a=n("i1f0");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i="header_process",o=i+"_",s="_actionstep",c="_flowstep";function l(e,t,n){if(e&&t&&n){if(Object(a.kd)(e,n)){const n=Object(r.b)(t)(e,t.etn);if(n&&n.ignoreBpfOnRecord)return!0}}return!1}function u(e){return!!(e&&e.data&&e.data.nextStageId)}function d(e,t,n){const r=(null==t?void 0:t.endsWith(s))||(null==t?void 0:t.endsWith(c)),a=!r&&(null==t?void 0:t.indexOf(":"))<0;if(r||a)return t;if(!e)return null;const i=o+e;let l=i,u=1;if(!n)return l;for(;n[l];)l=i+"_"+u++;return l}},fskq:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="CrmSoapServiceCall",a="DataSource_OfflineSync"},ftQm:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("504W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let a;class i{constructor(){this._processManagerCollection={}}setProcessManagerByPageId(e,t){Object(r.a)(t)||Object(r.b)(e)||(this._processManagerCollection[e]=t)}getProcessManagerByPageId(e){return this._processManagerCollection&&this._processManagerCollection[e]}cleanUpProcessmanagerByPageId(e){this._processManagerCollection&&this._processManagerCollection[e]&&delete this._processManagerCollection[e]}static get Instance(){return a||(a=new i),a}}},fueu:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return s}));var r,a=n("mMyr"),i=function(){function e(){var e=this;this._previousDimensions={},this._subscribers={},this._groupIdBySubscriber=new Map,this._pendingSubscribers={},this._pendingUpdates={},this._schedule=function(){e.takeMeasurements(),e.flushPendingMeasuringNotifications()}}return e.getInstance=function(){return r||(r=new e),r},e.prototype.setSchedulingFunction=function(e){this._schedule=e},e.prototype.addMeasuringSubscribers=function(e){if(e){var t=o(e.getContext());this._subscribers[t]||(this._subscribers[t]=[]),this._subscribers[t].push(e),this._groupIdBySubscriber.set(e,t),this.scheduleMeasuringUpdate()}},e.prototype.updateMeasuringSubscribers=function(e){if(e){var t=this._groupIdBySubscriber.get(e);if(t)o(e.getContext())!==t&&(this.removeMeasuringSubscribers(e),this.addMeasuringSubscribers(e))}},e.prototype.removeMeasuringSubscribers=function(e){var t,n,r,a;if(this._subscribers&&e){var i=o(e.getContext()),s=this._subscribers[i];if(s){var c=s.indexOf(e);c>-1&&(s.splice(c,1),null===(n=null===(t=this._previousDimensions)||void 0===t?void 0:t[i])||void 0===n||n.delete(e),this._groupIdBySubscriber.delete(e),0===s.length&&delete this._subscribers[i],0===(null===(a=null===(r=this._previousDimensions)||void 0===r?void 0:r[i])||void 0===a?void 0:a.size)&&delete this._previousDimensions[i])}}},e.prototype.scheduleMeasuringUpdate=function(){this._schedule()},e.prototype.flushPendingMeasuringNotifications=function(e){var t,n,r=[o()];e&&r.push(e);for(var a=0,i=0,s=r;i<s.length;i++){var c=s[i],l=null!==(n=null===(t=this._pendingUpdates[c])||void 0===t?void 0:t.length)&&void 0!==n?n:0;a+=l;for(var u=0;u<l;u++)this._pendingUpdates[c][u]();delete this._pendingUpdates[c],delete this._pendingSubscribers[c]}return a},e.prototype.takeMeasurements=function(e){var t,n,r,a=[o()];e&&a.push(e);for(var i=0,s=a;i<s.length;i++){var c=s[i];if(null===(t=this._subscribers)||void 0===t?void 0:t[c])for(var l=0;l<this._subscribers[c].length;l++){var u=this._subscribers[c][l],d=u.getComponent();if(d){var p=null===(n=this._previousDimensions[c])||void 0===n?void 0:n.get(u),f=d.getBoundingClientRect(),g=f.width,h=f.height;if(!p||p.Width!==g||p.Height!==h||this._subscribers[c][l].forceMeasure){var m=null===(r=this._pendingSubscribers[c])||void 0===r?void 0:r.indexOf(u);m>-1&&(this._pendingSubscribers[c].splice(m,1),this._pendingUpdates[c].splice(m,1)),this._previousDimensions[c]||(this._previousDimensions[c]=new Map),this._pendingUpdates[c]||(this._pendingUpdates[c]=[]),this._pendingSubscribers[c]||(this._pendingSubscribers[c]=[]),this._previousDimensions[c].set(u,{Width:g,Height:h}),this._pendingUpdates[c].push(u.onMeasure.bind(u,g,h)),this._pendingSubscribers[c].push(u)}}}}},e}();function o(e){var t;return null!==(t=null==e?void 0:e.groupId)&&void 0!==t?t:"defaultMeasuringHandlerGroup"}var s=a.createContext({})},g03H:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"i",(function(){return fe})),n.d(t,"h",(function(){return V})),n.d(t,"q",(function(){return G})),n.d(t,"o",(function(){return K})),n.d(t,"E",(function(){return Q})),n.d(t,"F",(function(){return X})),n.d(t,"A",(function(){return Y})),n.d(t,"D",(function(){return J})),n.d(t,"l",(function(){return H})),n.d(t,"t",(function(){return W})),n.d(t,"z",(function(){return $})),n.d(t,"w",(function(){return Z})),n.d(t,"x",(function(){return ee})),n.d(t,"v",(function(){return oe})),n.d(t,"r",(function(){return se})),n.d(t,"y",(function(){return le})),n.d(t,"u",(function(){return ue})),n.d(t,"m",(function(){return ce})),n.d(t,"s",(function(){return de})),n.d(t,"g",(function(){return q})),n.d(t,"H",(function(){return z})),n.d(t,"p",(function(){return pe})),n.d(t,"C",(function(){return he})),n.d(t,"B",(function(){return me})),n.d(t,"k",(function(){return be})),n.d(t,"n",(function(){return ge})),n.d(t,"b",(function(){return d})),n.d(t,"c",(function(){return m})),n.d(t,"f",(function(){return b})),n.d(t,"d",(function(){return A})),n.d(t,"e",(function(){return R})),n.d(t,"G",(function(){return x})),n.d(t,"j",(function(){return M}));var r,a,i,o,s=n("izYK"),c=n("rpfD"),l=n("W8Pl"),u=n("0fHr"),d="MscrmControls.Containers.FieldSectionItem",p="MscrmControls.Grid.GridControl",f="MscrmControls.Grid.PCFGridControl",g="Microsoft.PowerApps.PowerAppsOneGrid",h="MscrmControls.Chart.ChartControl",m="{fd2a7985-3187-444e-908d-6624b21f69c0}",b="{9fdf5f91-88b1-47f4-ad53-c11efc01a01d}",y={"3ef39988-22bb-4f0b-bbbe-64b5a3748aee":"picklist","67fac785-cd58-4f9f-abb3-4b7ddc6ed5ed":"radio","b0c6723a-8503-4fd7-bb28-c8a06ac933c2":"checkbox"},_="MscrmControls.WebResource.WebResourceHtmlControl",v="MscrmControls.TimelineWallControl.TimelineWall",S={},O={},C={},E={},I={},w={},j={},P={};!function(e){e[e.Read=0]="Read",e[e.Edit=1]="Edit",e[e.Both=2]="Both"}(r||(r={})),function(e){e[e.Normal=0]="Normal",e[e.Card=1]="Card"}(a||(a={})),function(e){e[e.Text=0]="Text",e[e.Icon=1]="Icon"}(i||(i={})),function(e){e[e.GridContainer=0]="GridContainer",e[e.DashboardContainer=1]="DashboardContainer",e[e.QuickCreateForm=2]="QuickCreateForm",e[e.FieldSectionContainer=3]="FieldSectionContainer",e[e.TimelineContainer=4]="TimelineContainer",e[e.ChartControl=5]="ChartControl",e[e.WebresourceControl=6]="WebresourceControl",e[e.DummyControl=7]="DummyControl",e[e.CalendarControl=8]="CalendarControl"}(o||(o={}));var T,N,A={"MscrmControls.MultiSelectPicklist.UpdMSPicklistControl":"MscrmControls.MultiSelectPicklist.MultiSelectPicklistControl"},R={"MscrmControls.Grid.ReadOnlyGrid":{newControlName:function(){var e,t;return(null===(t=null===(e=l.b.Utils)||void 0===e?void 0:e.isDisruptiveFeatureEnabled)||void 0===t?void 0:t.call(e,"FCB.PAOneGrid"))?g:f},enabled:function(e,t){var n,r;return(null===(r=null===(n=l.b.Utils)||void 0===n?void 0:n.isDisruptiveFeatureEnabled)||void 0===r?void 0:r.call(n,"FCB.PAOneGrid"))?k("grid"===e):F("grid"===e,null==t?void 0:t.pcfDatasetGridEnabled)}},"MscrmControls.Grid.PCFGridControl":{newControlName:function(){return g},enabled:function(e){return k("grid"===e)}}},D={};function x(e,t){D[e]=t}function M(e){return D.hasOwnProperty(e)?D[e]:e}function F(e,t){var n,r,a,i,o;if((null===(n=l.b.Utils)||void 0===n?void 0:n.isFeatureEnabled("PcfDatasetGridMainGridOnly"))&&!e)return!1;if(void 0===T){var s=3===l.b.Client.getFormFactor()||2===l.b.Client.getFormFactor(),c=window.navigator.userAgent.match("MSIE")||window.navigator.userAgent.match("Trident");T=!s&&!c&&"off"!==t&&(!("on"!==t&&!(null===(r=l.b.Utils)||void 0===r?void 0:r.isFeatureEnabled("April2022Update")))||!(null===(a=l.b.Utils)||void 0===a?void 0:a.isFeatureEnabled("PcfDatasetGridSlowDeployment"))&&(null===(o=null===(i=l.b.Utils)||void 0===i?void 0:i.isDisruptiveFeatureEnabled)||void 0===o?void 0:o.call(i,"FCB.PcfDatasetGrid","FCB.October2021Update")))}return T}function k(e){var t,n,r;return!((null===(t=l.b.Utils)||void 0===t?void 0:t.isFeatureEnabled("PAOneGridMainGridOnly"))&&!e)&&(void 0===N&&(N=3!==l.b.Client.getFormFactor()&&2!==l.b.Client.getFormFactor()&&(null===(r=null===(n=l.b.Utils)||void 0===n?void 0:n.isDisruptiveFeatureEnabled)||void 0===r?void 0:r.call(n,"FCB.PAOneGrid"))),N)}function L(e){for(var t in e.Parameters){var n=e.Parameters[t];if(n.Primary)return n}return null}function B(e){return{Usage:1,Static:!0,Type:s.a.SingleLineText,Value:JSON.stringify(e),Primary:!1}}function U(e){return{Usage:1,Static:!0,Type:s.a.SingleLineText,Value:y[e],Primary:!1}}function V(e,t){if(e.CustomControlId!==d)return null;var n=L(e);return function(e){return e&&"b0c6723a-8503-4fd7-bb28-c8a06ac933c2"===e||"67fac785-cd58-4f9f-abb3-4b7ddc6ed5ed"===e||"3ef39988-22bb-4f0b-bbbe-64b5a3748aee"===e}(t)?{valueSpecification:B(n),twoOptionRenderParam:U(t)}:{valueSpecification:B(n)}}function z(e,t){var n=L(e);return n?{FormFactor:2,CustomControlId:d,Name:"",Version:"1.0.0",Parameters:{value:n,valueSpecification:B(n),controlMode:{Usage:1,Static:!0,Type:"Enum",Value:r[t.ControlMode],Primary:!1},displayMode:{Usage:1,Static:!0,Type:"Enum",Value:a.Normal,Primary:!1},labelMode:{Usage:1,Static:!0,Type:"Enum",Value:i.Text,Primary:!1}},ShouldOverrideControlVisible:e.ShouldOverrideControlVisible,Children:{fieldControl:e}}:e}function q(e,t){switch(e.Type){case s.a.Grid:var n=t.Parameters,r=e;r.EnableViewPicker="true"===n.EnableViewPicker,r.RelationshipName=n.RelationshipName,r.TargetEntityType=n.TargetEntityType,r.ViewId=n.ViewId||n.DefaultViewId||n.defaultviewid;break;case s.a.LookupSimple:n=t.Parameters;(l=e).EnableViewPicker=n.DisableViewPicker&&"true"!==n.DisableViewPicker||!n.DisableViewPicker,l.TargetEntityType=n.TargetEntityType,l.ViewId=n.ViewId||n.DefaultViewId||n.defaultviewid,l.AllowFilterOff="true"===n.AllowFilterOff,l.AvailableViewIds=n.AvailableViewIds,l.DependentAttributeName=n.DependentAttributeName,l.DependentAttributeType=n.DependentAttributeType,l.DisableQuickFind="true"===n.DisableQuickFind,l.ExtraCondition=n.ExtraCondition,l.FilterRelationshipName=n.FilterRelationshipName,l.DisableMru=n.DisableMru;for(var a=0;a<n.length;a++){var i=n[a];if(i&&i.TargetEntities&&i.TargetEntities.length){i.TargetEntities.length>1&&(l.Type=s.a.LookupMultiEntity);var o=i.TargetEntities[0];!l.ViewId&&o.DefaultViewId&&(l.ViewId=o.DefaultViewId),!l.TargetEntityType&&o.EntityLogicalName&&(l.TargetEntityType=o.EntityLogicalName)}}case s.a.LookupCustomer:case s.a.LookupOwner:case s.a.LookupPartyList:case s.a.LookupRegarding:case s.a.LookupMultiEntity:var l;n=t.Parameters;(l=e).UseMainFormDialogForCreate="true"===n.useMainFormDialogForCreate,l.UseMainFormDialogForEdit="true"===n.useMainFormDialogForEdit;break;case s.a.SingleLineText:if(Object(c.a)("{39354E4A-5015-4D74-8031-EA9EB73A1322}",t.ClassId.guid))e.Value=t.Label;break;case s.a.Timer:var u=t.Parameters;e.TimerParameters=function(e){var t={};return t.CancelConditionName=e.CancelConditionName,t.CancelConditionValue=e.CancelConditionValue,t.FailureConditionName=e.FailureConditionName,t.FailureConditionValue=e.FailureConditionValue,t.FailureTimeField=e.FailureTimeField,t.PauseConditionName=e.PauseConditionName,t.PauseConditionValue=e.PauseConditionValue,t.SuccessConditionName=e.SuccessConditionName,t.SuccessConditionValue=e.SuccessConditionValue,t.WarningConditionName=e.WarningConditionName,t.WarningConditionValue=e.WarningConditionValue,t}(u)}return e}function H(e){return null==e}function W(e,t,n,o,u,p,f){var g=(o?o.toLowerCase()+"-":"")+e;if(!t){if("mapcontrol"===e&&Object(c.a)("62b0df79-0464-470f-8af7-4483cfea0c7d",u)){var h=e+"-"+p.Parameters.AddressField;return E[h]||(E[h]={FormFactor:2,CustomControlId:d,Name:e,Version:"1.0.0",Parameters:{value:{Usage:0,Static:!1,Type:s.a.SingleLineAddress,Value:p.Parameters.AddressField,Primary:!0},controlMode:{Usage:2,Static:!0,Type:"Enum",Value:r.Read,Primary:!1}},ShouldOverrideControlVisible:!1}),E[h]}if("MscrmControls.Containers.RelevanceSearchControl"===n)return S[e]||(S[e]={FormFactor:2,CustomControlId:"MscrmControls.Containers.RelevanceSearchControl",Name:e,Version:"1.0.0",Parameters:{value:{Type:s.a.Search,Primary:!0}},ShouldOverrideControlVisible:!1}),S[e];if(u&&(Object(c.a)("{e616a57f-20e0-4534-8662-a101b5ddf4e0}",u)||Object(c.a)("{7CCD1494-1F7A-4E3A-8BDE-F32069DAEB9F}",u))){if(!S[g]){var m=p&&p.Parameters&&"true"===p.Parameters.EnableAutoSuggestions&&"0"===p.Parameters.AutoSuggestionSource?p.Parameters.SearchForAutoSuggestionsUsing:void 0;S[g]={FormFactor:2,CustomControlId:"MscrmControls.KbSearchControl.KbSearchControl",Name:e,Version:"1.0.0",Parameters:{value:{Type:s.a.SearchWidget,Primary:!0},AutoSuggestionField:{Type:"all",Primary:!1,Static:!1,Usage:0,Value:m}},ShouldOverrideControlVisible:!1}}return S[g]}return u&&Object(c.a)(u,"{03c5aed6-ee88-404e-b63c-4c53429c8bfb}")&&(S[e]={FormFactor:2,CustomControlId:"MscrmControls.KbArticleControl.KbArticleControl",Name:e,Version:"1.0.0",Parameters:{value:{Type:s.a.KbArticle,Primary:!0}},ShouldOverrideControlVisible:!1}),u&&Object(c.a)(u,"{1b9fc842-b45e-4fc1-b080-81e96b6d857f}")&&(S[e]={FormFactor:2,CustomControlId:"MscrmControls.KbContentControl.KbContentControl",Name:e,Version:"1.0.0",Parameters:{value:{Type:s.a.KbContent,Primary:!0}},ShouldOverrideControlVisible:!1}),u&&Object(c.a)("{26E9760F-7454-40DE-BB07-F6DCCCB82040}",u)?(S[e]||(S[e]={FormFactor:2,CustomControlId:"MscrmControls.EmailEngagement.EmailView",Name:e,Version:"1.0.0",Parameters:{value:{Type:s.a.EmailEngagementRecipientActivity,Primary:!0}},ShouldOverrideControlVisible:!1}),S[e]):!H(l.b)&&!H(l.b.Utils)&&!H(l.b.Utils.isFeatureEnabled)&&l.b.Utils.isFeatureEnabled("EmailEngagementComposeForUCI")&&u&&Object(c.a)("{F454228D-1D25-4319-E12F-D27968BC0234}",u)?(S[e]||(S[e]={FormFactor:2,CustomControlId:"MscrmControls.EmailEngagement.EmailEngagementActionsControl",Name:e,Version:"1.0.0",Parameters:{value:{Type:s.a.EmailEngagementActions,Primary:!0},toparams:{Usage:0,Static:!1,Type:s.a.LookupPartyList,Value:"to",Primary:!1},ccparams:{Usage:0,Static:!1,Type:s.a.LookupPartyList,Value:"cc",Primary:!1},directioncode:{Usage:0,Static:!1,Type:s.a.TwoOptions,Value:"directioncode",Primary:!1},isemailfollowed:{Usage:0,Static:!1,Type:s.a.TwoOptions,Value:"isemailfollowed",Primary:!1},followemailuserpreference:{Usage:0,Static:!1,Type:s.a.TwoOptions,Value:"followemailuserpreference",Primary:!1},emailreminderstatus:{Usage:0,Static:!1,Type:s.a.OptionSet,Value:"emailreminderstatus",Primary:!1},emailremindertype:{Usage:0,Static:!1,Type:s.a.OptionSet,Value:"emailremindertype",Primary:!1},emailremindertext:{Usage:0,Static:!1,Type:s.a.SingleLineText,Value:"emailremindertext",Primary:!1},emailreminderexpirytime:{Usage:0,Static:!1,Type:s.a.DateAndTimeDateAndTime,Value:"emailreminderexpirytime",Primary:!1},delayedemailsendtime:{Usage:0,Static:!1,Type:s.a.DateAndTimeDateAndTime,Value:"delayedemailsendtime",Primary:!1},statuscode:{Usage:0,Static:!1,Type:s.a.OptionSet,Value:"statuscode",Primary:!1}},ShouldOverrideControlVisible:!1}),S[e]):n===s.a.WebResourceHtmlControl?(j[e]||(j[e]={FormFactor:2,CustomControlId:_,Name:e,Version:"1.0.0",Parameters:{value:{Usage:0,Type:s.a.WebResourceHtmlControl,Value:null,Static:!1,Primary:!0}},ShouldOverrideControlVisible:!1}),j[e]):n===s.a.TimelineWall?{FormFactor:2,CustomControlId:v,Name:e,Version:"1.0.0",Parameters:{value:{Type:s.a.TimelineWall,Primary:!0}},ShouldOverrideControlVisible:!1}:l.b&&l.b.Utils&&l.b.Utils.isFeatureEnabled&&!l.b.Utils.isFeatureEnabled("SocialInsightsMapping")||!u||!Object(c.a)("{86b9e25e-695e-4fef-ac69-f05cfa96739c}",u)?(C[e]||(C[e]={FormFactor:2,CustomControlId:"MscrmControls.FieldControls.DummyControl",Name:e,Version:"1.0.0",Parameters:{value:{Usage:1,Static:!0,Type:u||n,Value:null,Primary:!0},controlMode:{Usage:1,Static:!0,Type:"Enum",Value:r.Both,Primary:!1}},ShouldOverrideControlVisible:!1}),C[e]):(O[e]||(O[e]={FormFactor:2,CustomControlId:"MscrmControls.SocialInsightsControl.SocialInsightsControl",Name:e,Version:"1.0.0",Parameters:{value:{Type:s.a.SocialInsightsControl,Primary:!0}},ShouldOverrideControlVisible:!1}),O[e])}if(u&&(Object(c.a)("{6F3FB987-393B-4d2d-859F-9D0F0349B6AD}",u)||Object(c.a)("{F94DB24F-263D-44A7-B38E-A35E9854812B}",u)))return-1===n.indexOf("memo")&&n!==s.a.SingleLineText&&n!==s.a.SingleLineTextArea&&n!==s.a.Multiple||S[e]||(S[e]={FormFactor:2,CustomControlId:"MscrmControls.ActivityControls.ActivityEditorControl",Name:e,Version:"1.0.0",Parameters:{value:{Usage:0,Static:!1,Type:n,Value:t,Primary:!0},isUnsafe:{Usage:1,Static:!1,Type:s.a.WholeNone,Value:"isunsafe",Primary:!1}},ShouldOverrideControlVisible:!1}),S[e];if(u&&Object(c.a)("{39354E4A-5015-4D74-8031-EA9EB73A1322}",u))return P[e]||(P[e]={FormFactor:2,CustomControlId:"MscrmControls.FieldControls.LabelControl",Name:e,Version:"1.0.0",Parameters:{value:{Type:s.a.SingleLineText,Static:!0,Primary:!0}},ShouldOverrideControlVisible:!1}),P[e];if(n===s.a.QuickForm){var b=ye(p,f);return I[e]&&I[e].Parameters.value.Value===b||(I[e]={FormFactor:2,CustomControlId:"MscrmControls.Containers.QuickForm",Name:e,Version:"1.0.0",Parameters:{value:{Usage:0,Type:s.a.QuickForm,Value:b,Static:!1,Primary:!0,FirstDataRequestType:f&&f.chartDataRequestType?f.chartDataRequestType:1}},ShouldOverrideControlVisible:!1}),I[e]}if(n===s.a.Card){b=ye(p,f);return w[e]&&w[e].Parameters.value.Value===b||(w[e]={FormFactor:2,CustomControlId:"MscrmControls.Containers.QuickFormCardControl",Name:e,Version:"1.0.0",Parameters:{value:{Usage:0,Type:s.a.QuickForm,Value:b,Static:!1,Primary:!0}},ShouldOverrideControlVisible:!1}),w[e]}var y=pe(n,u),T=function(e){return e===s.a.Timer?r.Read:r.Both}(y),N=function(e){return e===s.a.Timer?2:1}(y);return E[g]||(E[g]={FormFactor:2,CustomControlId:d,Name:e,Version:"1.0.0",Parameters:{value:{Usage:0,Static:!1,Type:y,Value:t,Primary:!0},controlMode:{Usage:N,Static:!0,Type:"Enum",Value:T,Primary:!1},displayMode:{Usage:N,Static:!0,Type:"Enum",Value:a.Normal,Primary:!1},labelMode:{Usage:N,Static:!0,Type:"Enum",Value:i.Text,Primary:!1}},ShouldOverrideControlVisible:!1}),E[g]}function G(e){return{FormFactor:2,CustomControlId:e,Name:e,Version:"1.0.0",Parameters:{value:{Type:s.a.BusinessProcessFlow}},ShouldOverrideControlVisible:!1}}function K(e,t,n,r,a,i,o,c,u){var d,p=!H(l.b)&&!H(l.b.Utils)&&!H(l.b.Utils.isFeatureEnabled)&&l.b.Utils.isFeatureEnabled("EditableGridLookupRecordCountConfig");return{FormFactor:t,CustomControlId:e,Name:e,Version:"1.0.0",Parameters:(d={},d[a]={Type:s.a.Grid,ViewId:n,TargetEntityType:r,AllowFilterOff:null!=i&&i,RelationshipName:o,DependentAttributeType:c,DependentAttributeName:u,PagingInput:p?{Static:!0,Value:'{"firstPageNumber":1,"lastPageNumber":1,"pageSize":100}'}:void 0},d),ShouldOverrideControlVisible:!1}}function Q(e,t,n,r,a){return{FormFactor:2,CustomControlId:e,Name:e,Version:"1.0.0",Parameters:{value:{Usage:3,Type:s.a.LookupSimple,ViewId:t,Attributes:{LogicalName:"falseBoundLookup",Targets:new Array(n),DisplayName:r},Callback:a}},ShouldOverrideControlVisible:!1}}function X(e,t,n,r,a,i,o,s,c,l,u,d,p){var f;return void 0===l&&(l=!1),void 0===d&&(d=!1),void 0===p&&(p=!1),r&&0!==r.length?f=r:n&&(f=[n]),{FormFactor:2,CustomControlId:e,Name:e,Version:"1.0.0",Parameters:{value:{Usage:3,Type:a,ViewId:t,Attributes:{LogicalName:"falseBoundLookup",Targets:f,SearchText:u},Callback:i,ExtraFilters:o,Value:c,AdditionalTargetExtraFilters:s,DisableMru:l,UseMainFormDialogForCreate:p,UseMainFormDialogForEdit:d},displayMode:{Usage:1,Static:!0,Type:"Enum",Value:1,Primary:!1}},ShouldOverrideControlVisible:!1}}function Y(e){return{FormFactor:2,CustomControlId:e,Name:e,Version:"1.0.0",Parameters:{value:{Usage:0,Type:s.a.Dashboard,Value:null,Static:!1,Primary:!0}},ShouldOverrideControlVisible:!1}}function J(e){return{FormFactor:2,CustomControlId:e,Name:e,Version:"1.0.0",Parameters:{value:{Usage:0,Type:s.a.ReferencePanel,Value:null,Static:!1,Primary:!0}},ShouldOverrideControlVisible:!1}}function $(e,t,n,r){return void 0===n&&(n=!1),{FormFactor:1,DisplayNameKey:"CC_ReadOnlyGrid_Name",CustomControlId:ie(t.TargetEntityType,r),Name:e,Version:"1.0.0",Parameters:ne(t,n,r),ShouldOverrideControlVisible:!1,isDefaultConfig:!0}}function Z(e,t,n,r){return{FormFactor:1,CustomControlId:te(!0,r),Name:e,DisplayNameKey:"CC_ReadOnlyGrid_Name",Version:"1.0.0",Parameters:re(t,n,r),ShouldOverrideControlVisible:!1,isDefaultConfig:!0}}function ee(e,t,n,r){return{FormFactor:1,CustomControlId:te(!0,r),DisplayNameKey:"CC_ReadOnlyGrid_Name",Name:e,Version:"1.0.0",Parameters:ae(t,n,r),ShouldOverrideControlVisible:!1,isDefaultConfig:!0}}function te(e,t){return k(e)?g:F(e,t)?f:"MscrmControls.Grid.ReadOnlyGrid"}function ne(e,t,n){if("sharepointdocument"===e.TargetEntityType)return{Grid:{Type:s.a.Grid,ViewId:e.DefaultViewId||e.ViewId,TargetEntityType:e.TargetEntityType,EnableViewPicker:"true"===e.EnableViewPicker,RelationshipName:e.RelationshipName,Columns:[],Primary:!0,DataSetUIOptions:{displayQuickFind:!1,displayIndex:!1,displayCommandBar:!0,displayViewSelector:!0}},EnableEditing:{Usage:1,Static:!0,Type:"Enum",Value:"No",Primary:!1},EnableGroupBy:{Usage:1,Static:!0,Type:"Enum",Value:"No",Primary:!1},EnableFiltering:{Usage:1,Static:!0,Type:"Enum",Value:"No",Primary:!1}};if("connection"===e.TargetEntityType&&e.ViewId&&("{FE4BC089-8901-466C-A41B-1C1090F204D4}"===e.ViewId.toUpperCase()||"{4E3600FA-B9C8-49F4-B69A-51EBA06D9BDF}"===e.ViewId.toUpperCase())&&(H(l.b)||H(l.b.Utils)||H(l.b.Utils.isFeatureEnabled)||!l.b.Utils.isFeatureEnabled("DisableEditableGridControlOnPhone")||H(l.b.Client.getFormFactor)||3!==l.b.Client.getFormFactor()))return{Grid:{Type:s.a.Grid,ViewId:e.DefaultViewId||e.ViewId,TargetEntityType:e.TargetEntityType,EnableViewPicker:"true"===e.EnableViewPicker,RelationshipName:e.RelationshipName,Columns:[],Primary:!0},EnableEditing:{Usage:1,Static:!0,Type:"Enum",Value:"Yes",Primary:!1},EnableGroupBy:{Usage:1,Static:!0,Type:"Enum",Value:"No",Primary:!1},EnableFiltering:{Usage:1,Static:!0,Type:"Enum",Value:"Yes",Primary:!1}};if("connection"===e.TargetEntityType||!F(!1,n)){var r={Grid:{Type:s.a.Grid,ViewId:e.DefaultViewId||e.ViewId,TargetEntityType:e.TargetEntityType,EnableViewPicker:"true"===e.EnableViewPicker,RelationshipName:e.RelationshipName,Columns:[],Primary:!0},EnableEditing:{Usage:1,Static:!0,Type:"Enum",Value:"No",Primary:!1},EnableGroupBy:{Usage:1,Static:!0,Type:"Enum",Value:"No",Primary:!1},EnableFiltering:{Usage:1,Static:!0,Type:"Enum",Value:"Yes",Primary:!1}};return t&&(r.EnableFiltering.Value="Yes"),r}var a=_e();return a.Items={Type:s.a.Grid,ViewId:e.DefaultViewId||e.ViewId,TargetEntityType:e.TargetEntityType,EnableViewPicker:"true"===e.EnableViewPicker,RelationshipName:e.RelationshipName,Columns:[],Primary:!0},a}function re(e,t,n){if(!F(!0,n))return{Grid:{Type:s.a.Grid,EntityName:e,ViewId:t},EnableEditing:{Usage:1,Static:!0,Type:"Enum",Value:"No",Primary:!1},EnableGroupBy:{Usage:1,Static:!0,Type:"Enum",Value:"No",Primary:!1},EnableFiltering:{Usage:1,Static:!0,Type:"Enum",Value:"Yes",Primary:!1}};var r=_e();return r.Items={Type:s.a.Grid,EntityName:e,ViewId:t},r}function ae(e,t,n){if(F(!0,n)){var r=_e();return r.Items={Type:s.a.Grid,EntityName:e,ViewId:t},r}return{Grid:{Type:s.a.Grid,EntityName:e,ViewId:t},EnableEditing:{Usage:1,Static:!0,Type:"Enum",Value:"No",Primary:!1},EnableGroupBy:{Usage:1,Static:!0,Type:"Enum",Value:"No",Primary:!1},EnableFiltering:{Usage:1,Static:!0,Type:"Enum",Value:"Yes",Primary:!1}}}function ie(e,t){return"sharepointdocument"===e?"MscrmControls.SharepointAssociatedGrid.SharepointControl":"connection"===e?p:te(!1,t)}function oe(e,t,n,r,a,i,o,c,l,u,d,p,f,g,h){void 0===p&&(p=!0),void 0===f&&(f=!1),void 0===g&&(g=!1),void 0===h&&(h=!1);var m=i||null,b=o?"true":"false",y=l?"true":"false";return{FormFactor:1,CustomControlId:e,Name:e,Version:"1.0.0",Parameters:{ChartDataSet:{Type:s.a.Grid,EntityName:t,ViewId:n,VisualizationId:r,ChartGridMode:"Chart",HighchartFilterExpression:m,ExtraFilters:u,IsUserChart:b,ChartDrillDownParameters:c,FirstDataRequestType:2,IsUserView:y,RefreshInput:{Value:a,Static:!0},LinkingInput:{Value:d,Static:!0}},Parent:{Type:"SingleLine.Text",Primary:!1,Static:!0,Usage:1,Value:"DataSetHost"},ChartSelectorMode:{Type:"Enum",Primary:!1,Static:!0,Usage:1,Value:"ChartSelector"},CommandMode:{Type:"Enum",Primary:!1,Static:!0,Usage:1,Value:"GridChartCommand"},EnableExpandButton:{Type:"Enum",Primary:!1,Static:!0,Usage:1,Value:p?"Yes":"No"},EnableCloseButton:{Type:"Enum",Primary:!1,Static:!0,Usage:1,Value:f?"Yes":"No"},IsChartOnTheRightSide:{Type:"Boolean",Primary:!1,Static:!0,Usage:1,Value:g},IsEmbeddedInTeams:{Type:"Boolean",Primary:!1,Static:!0,Usage:1,Value:h}},ShouldOverrideControlVisible:!1,isDefaultConfig:!0}}function se(e,t,n,r,a,i,o,c,l,u,d,p){void 0===d&&(d=!1),void 0===p&&(p=!1);var f=o?"true":"false",g=c?"true":"false";return{FormFactor:1,CustomControlId:e,Name:e,Version:"1.0.0",Parameters:{ChartDataSet:{Type:s.a.Grid,EntityName:t,ViewId:n,VisualizationId:r,ChartGridMode:"Chart",HighchartFilterExpression:null,ExtraFilters:l,IsUserChart:f,FirstDataRequestType:1,IsUserView:g,RelationshipName:a,RefreshInput:{Value:i,Static:!0},LinkingInput:{Value:u,Static:!0}},Parent:{Type:"SingleLine.Text",Primary:!1,Static:!0,Usage:1,Value:"AssociatedGrid"},ChartSelectorMode:{Type:"Enum",Primary:!1,Static:!0,Usage:1,Value:"ChartSelector"},CommandMode:{Type:"Enum",Primary:!1,Static:!0,Usage:1,Value:"GridChartCommand"},EnableExpandButton:{Type:"Enum",Primary:!1,Static:!0,Usage:1,Value:"Yes"},EnableCloseButton:{Type:"Enum",Primary:!1,Static:!0,Usage:1,Value:d?"Yes":"No"},IsChartOnTheRightSide:{Type:"Boolean",Primary:!1,Static:!0,Usage:1,Value:p}},ShouldOverrideControlVisible:!1,isDefaultConfig:!0}}function ce(e,t,n){return{FormFactor:t,CustomControlId:n,Name:"MscrmControls.PowerBI.PowerBIControl",Version:"1.0.0",Parameters:{value:{TileUrl:e.TileUrl,PowerBIGroupId:e.PowerBIGroupId,PowerBIDashboardId:e.PowerBIDashboardId,PowerBIType:e.Type,PowerBIReportId:e.PowerBIReportId,PowerBIFilter:e.PowerBIFilter,EnableInMobile:e.EnableInMobile||!1,TileId:e.TileId,IsPowerBIEnabled:e.IsPowerBIEnabled||!0,Type:s.a.PowerBI,Primary:!0,FirstPartyIntegrationSiteUrl:e.FirstPartyIntegrationSiteUrl,Tenant:e.Tenant}},ShouldOverrideControlVisible:!1,isDefaultConfig:!0}}function le(e,t,n){void 0===t&&(t=1),void 0===n&&(n=!0);var r=ue(e,t);return r.Parameters.Parent.Value="QuickViewForm",r.Parameters.CommandMode.Value=n?"FormChartCommand":"No",r}function ue(e,t,n){void 0===t&&(t=2);var r=e.EnableChartPicker&&"true"===e.EnableChartPicker?"ChartSelector":"ChartTitle",a=e.EnableViewPicker&&"true"===e.EnableViewPicker?"ViewSelector":"ViewTitle",i={Type:s.a.Grid,EntityName:e.TargetEntityType,ViewId:e.ViewId,VisualizationId:e.VisualizationId,ChartGridMode:"Chart",HighchartFilterExpression:null,IsUserChart:e.IsUserChart,FirstDataRequestType:t,IsUserView:e.IsUserView,ViewIds:e.ViewIds,RelationshipName:e.RelationshipName,EnableViewPicker:"true"===e.EnableViewPicker,EnableChartPicker:"true"===e.EnableChartPicker};return H(n)||(i.RefreshInput={Value:n,Static:!0}),{FormFactor:1,CustomControlId:h,Name:h,Version:"1.0.0",Parameters:{ChartDataSet:i,Parent:{Type:"SingleLine.Text",Primary:!1,Static:!0,Usage:1,Value:"EditForm"},ChartSelectorMode:{Type:"Enum",Primary:!1,Static:!0,Usage:1,Value:r},ViewSelectorMode:{Type:"Enum",Primary:!1,Static:!0,Usage:1,Value:a},CommandMode:{Type:"Enum",Primary:!1,Static:!0,Usage:1,Value:"FormChartCommand"},EnableExpandButton:{Type:"Enum",Primary:!1,Static:!0,Usage:1,Value:"Yes"}},ShouldOverrideControlVisible:!1,isDefaultConfig:!0}}function de(e,t,n,r,a,i,o){var s,l=L(s=i&&(Object(c.a)(i,"{E7A81278-8635-4D9E-8D4D-59480B391C5B}")||Object(c.a)(i,"{02d4264b-47e2-4b4c-aa95-f439f3f4d458}"))?$(e,r.Parameters,!1,o):W(e,t,n,a,i,r));l&&q(l,r);var u=V(s,i);return null!==u&&Object.assign(s.Parameters,u),s}function pe(e,t){var n,r=e?e.split("."):[null,null],a=r[0],i=r[1];switch(a||(a=t&&s.a.ClassIdTypeMap[t]||"string"),i&&"null"!==i&&"undefined"!==i||(i=t&&s.a.ClassIdControlMap[t]||"text"),a){case"boolean":n=s.a.TwoOptions;break;case"customer":n=s.a.LookupCustomer;break;case"datetime":switch(i.toLowerCase()){case"date":case"0":n=s.a.DateAndTimeDateOnly;break;case"datetime":case"dateandtime":case"1":n=s.a.DateAndTimeDateAndTime;break;default:n=s.a.DateAndTimeDateOnly}break;case"decimal":n=s.a.Decimal;break;case"file":n=s.a.File;break;case"float":case"double":n=s.a.FP;break;case"image":n=s.a.Image;break;case"integer":switch(i.toLowerCase()){case"duration":case"1":n=s.a.WholeDuration;break;case"timezone":case"2":n=s.a.WholeTimeZone;break;case"language":case"3":n=s.a.WholeLanguage;break;default:n=s.a.WholeNone}break;case"lookup":switch(i.toLowerCase()){case"connection":case"regarding":case"1":case"2":n=s.a.LookupRegarding;break;default:n=s.a.LookupSimple}break;case"memo":n=s.a.Multiple;break;case"money":n=s.a.Currency;break;case"owner":n=s.a.LookupOwner;break;case"partylist":n=s.a.LookupPartyList;break;case"multiselectpicklist":n=s.a.MultiSelectPicklist;break;case"picklist":case"state":n=s.a.OptionSet;break;case"status":n=s.a.StatusOptionSet;break;case"text":case"string":switch(i.toLowerCase()){case"email":case"0":n=s.a.SingleLineEmail;break;case"textarea":case"2":n=s.a.Multiple;break;case"url":case"3":n=s.a.SingleLineURL;break;case"tickersymbol":case"4":n=s.a.SingleLineTickerSymbol;break;case"phone":case"7":n=s.a.SingleLinePhone;break;case"memo":n=s.a.Multiple;break;default:n=s.a.SingleLineText}break;case"Timer":n=s.a.Timer;break;default:n=s.a.SingleLineText}return n}function fe(e,t){switch(t&&"null"!==t&&"undefined"!==t||(t="text"),e.toLowerCase()){case"datetime":switch(t.toLowerCase()){case"date":case"0":return u.b.date;case"datetime":case"dateandtime":case"1":return u.b.dateTime;default:return u.b.date}case"integer":switch(t.toLowerCase()){case"duration":case"1":return u.b.duration;case"timezone":case"2":return u.b.timeZone;case"language":case"3":return u.b.language;default:return u.b.none}case"lookup":switch(t.toLowerCase()){case"connection":case"1":return u.b.connection;case"regarding":case"2":return u.b.regarding}case"text":case"string":switch(t.toLowerCase()){case"email":case"0":return u.b.email;case"textarea":case"2":return u.b.textArea;case"url":case"3":return u.b.url;case"tickersymbol":case"4":return u.b.tickerSymbol;case"phone":case"7":return u.b.phone}case"customer":switch(t.toLowerCase()){case"none":case"0":return u.b.none}}return t}function ge(e){switch(e){case"MscrmControls.Grid.ReadOnlyGrid":case f:case g:case p:return o.GridContainer;case"MscrmControls.Containers.DashboardControl":return o.DashboardContainer;case"MscrmControls.Containers.QuickForm":return o.QuickCreateForm;case d:return o.FieldSectionContainer;case v:return o.TimelineContainer;case h:return o.ChartControl;case _:return o.WebresourceControl;case"MscrmControls.Calendar.CalendarControl":return o.CalendarControl;case"MscrmControls.FieldControls.DummyControl":return o.DummyControl}}function he(e,t){var n;switch(e){case"TwoOptions":n="MscrmControls.FieldControls.CheckboxControl";break;case"Currency":n="MscrmControls.FieldControls.CurrencyControl";break;case"Decimal":n="MscrmControls.FieldControls.DecimalNumberControl";break;case"SingleLine.Email":n="MscrmControls.FieldControls.EmailAddressControl";break;case"FP":n="MscrmControls.FieldControls.FloatingPointNumberInput";break;case"Whole.Language":n="MscrmControls.FieldControls.LanguagePickerControl";break;case"OptionSet":n="MscrmControls.FieldControls.OptionSet";break;case"StatusOptionSet":n="MscrmControls.FieldControls.PicklistStatusControl";break;case"SingleLine.Phone":n="MscrmControls.FieldControls.PhoneNumberControl";break;case"SingleLine.Text":case"Multiple":n=t&&"RichText"===t.FormatName?"MscrmControls.RichTextEditor.RichTextEditorControl":"MscrmControls.FieldControls.TextBoxControl";break;case"SingleLine.Ticker":n="MscrmControls.FieldControls.TickerSymbolControl";break;case"Whole.TimeZone":n="MscrmControls.FieldControls.TimeZonePickListControl";break;case"SingleLine.URL":n="MscrmControls.FieldControls.UrlControl";break;case"Whole.None":n="MscrmControls.FieldControls.WholeNumberControl";break;case"Whole.Duration":n="MscrmControls.FieldControls.DurationControl";break;case"Lookup.PartyList":case"Lookup.Regarding":case"Lookup.Simple":case"Lookup.Owner":case"Lookup.Customer":case"Lookup.MultiEntity":n=function(e,t){return"Lookup.Simple"===e&&t&&t.Targets&&1===t.Targets.length&&"subject"===t.Targets[0]?"MscrmControls.FieldControls.SubjectTreeControl":"MscrmControls.FieldControls.SimpleLookupControl"}(e,t);break;case"MultiSelectPicklist":n="MscrmControls.MultiSelectPicklist.UpdMSPicklistControl";break;case"DateAndTime.DateOnly":case"DateAndTime.DateAndTime":n="MscrmControls.FieldControls.DateTimeControl";break;case"Grid":n="MscrmControls.Grid.ReadOnlyGrid";break;case"SearchWidget":case"SearchWidget.SearchWidget":case"ReferencePanelSearchWidget":n="MscrmControls.KbSearchControl.KbSearchControl";break;case"KbArticle":n="MscrmControls.KbArticleControl.KbArticleControl";break;case"KbContent":n="MscrmControls.KbContentControl.KbContentControl";break;case"Timer":n="MscrmControls.FieldControls.TimerControl";break;case s.a.SingleLineAddress:n="MscrmControls.Map.MapControl";break;case s.a.File:n="MscrmControls.FieldControls.FileControl";break;case s.a.Image:n="MscrmControls.FieldControls.ImageControl";break;case"SingleLine.TextArea":default:n="MscrmControls.FieldControls.DummyControl"}return n=M(n)}function me(e){if(!e)return null;var t=L(e);return t?he(t.Type):null}function be(e){switch(e.CustomControlId){case"MscrmControls.Calendar.CalendarControl":case p:case"MscrmControls.Grid.ReadOnlyGrid":case f:case"MscrmControls.Timeline.TimelineControl":case"MscrmControls.ActionCard.ActionCardView":return!0;default:return!1}}function ye(e,t){var n=t?t.quickFormId:"00000000-0000-0000-0000-000000000000",r=e?e.DataFieldName:"";return n+(r?"|"+r:"")}function _e(){var e;return{ColumnResizing:{Usage:1,Static:!0,Type:"Enum",Value:"Enable",Primary:!1},ColumnMoving:{Usage:1,Static:!0,Type:"Enum",Value:"Enable",Primary:!1},ColumnPinning:{Usage:1,Static:!0,Type:"Enum",Value:"Disable",Primary:!1},RowSelection:{Usage:1,Static:!0,Type:"Enum",Value:"Multiple",Primary:!1},RowHeightMobile:{Usage:1,Static:!0,Type:"Whole.None",Value:72,Primary:!1},RowHeight:{Usage:1,Static:!0,Type:"Whole.None",Value:42,Primary:!1},HeaderHeight:{Usage:1,Static:!0,Type:"Whole.None",Value:42,Primary:!1},SelectionColumn:{Usage:1,Static:!0,Type:"Enum",Value:"Enable",Primary:!1},RowStyle:{Usage:1,Static:!0,Type:"Enum",Value:"Flat",Primary:!1},GridInnerLeftPadding:{Usage:1,Static:!0,Type:"Whole.None",Value:32,Primary:!1},GridInnerRightPadding:{Usage:1,Static:!0,Type:"Whole.None",Value:32,Primary:!1},JumpBar:{Usage:1,Static:!0,Type:"Enum",Value:(null===(e=l.b.Utils)||void 0===e?void 0:e.isFeatureEnabled("PcfDatasetGridShowJumpBar"))?"Enable":"Disable",Primary:!1},ReflowBehavior:{Usage:1,Static:!0,Type:"Enum",Value:"Reflow",Primary:!1},Footer:{Usage:1,Static:!0,Type:"Enum",Value:"Enable",Primary:!1},IsReadOnly:{Usage:1,Static:!0,Type:"Enum",Value:"Enable",Primary:!1},EnableEditing:{Usage:1,Static:!0,Type:"Enum",Value:"No",Primary:!1}}}},g0tL:function(e,t,n){"use strict";n.d(t,"a",(function(){return R})),n.d(t,"b",(function(){return D})),n.d(t,"h",(function(){return x})),n.d(t,"g",(function(){return X})),n.d(t,"e",(function(){return oe})),n.d(t,"f",(function(){return ie})),n.d(t,"c",(function(){return B})),n.d(t,"d",(function(){return U}));var r=n("eXjw"),a=n("SAYH"),i=n("nJrx"),o=n("/oKV"),s=n("2cSh"),c=n("1pQz"),l=n("olXY"),u=n("Lr+c"),d=n("AF/G");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class p{constructor(){this._names={}}getUniqueName(e){if(null==e)return null;let t=e;for(;null!=this._names[t];){t=e+ ++this._names[e]}return this._names[t]=0,t}}var f=n("BJ7u");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var g=n("JOgp"),h=n("504W"),m=n("unFF"),b=n("Ae6N"),y=n("/A0C"),_=n("nTyX"),v=n("64CY"),S=n("NjDY"),O=n("lju1"),C=n("9fGf"),E=n("fh2P"),I=n("IqkD"),w=n("Lyxw"),j=n("3/02"),P=n("wL2W"),T=n("E5IU"),N=n("+Qpx"),A=n("+6s6");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const R="Main";var D;function x(e,t,n,r,a){if(!n)return{formSelectors:null,formDefaults:null};const i=Object(w.f)(e,j.Fc)&&t===o.a.Remote,s={},c={},l={},u=Object(P.a)()?[]:null;for(const t of n)if(t.hasOwnProperty("EntityLogicalName")){if(!(i&&t.ResponseCacheEnabled?F(e,t,s,c,l,u,a):M(t,s,c,l)))return{formSelectors:[],formDefaults:[]}}return{formSelectors:s,formSelectorUnfilteredIdsCountByEntity:c,formDefaults:l,formSelectorFormCheckerInfo:u}}function M(e,t,n,i){for(const n of e.SelectorItems){const r=Object(f.a)(n.FormType);t[e.EntityLogicalName]||(t[e.EntityLogicalName]={}),t[e.EntityLogicalName][r]||(t[e.EntityLogicalName][r]={}),t[e.EntityLogicalName][r][n.Id]={name:n.Name,description:n.Description}}if(n[e.EntityLogicalName]=e.UnfilteredIdsCount,e.SelectorItems.length){const t=e.SelectorItems[0],n=Object(f.a)(t.FormType),o=new a.a(t.Id);if(i[e.EntityLogicalName]||(i[e.EntityLogicalName]={}),!i[e.EntityLogicalName][n]){const t={formId:o,initialized:r.a.Initialized};i[e.EntityLogicalName][n]=t}}else if(0===e.SelectorItems.length&&0===e.UnfilteredIdsCount)return!1;return!0}function F(e,t,n,i,o,s,c){var l,u,d,p;const g=Object(P.a)(),h=[],m=t.SelectorItems.some(t=>function(e,t){return k(e,t).userHasPermissionToForm}(t,e)&&t.IsInApp),b=e=>e?{Id:e.Id,Name:e.Name,Description:e.Description,isInCurrentAppModule:e.IsInApp,isFallbackForm:e.IsFallbackForm}:"null",y=e=>e?{Id:e.Id,Name:e.Name}:"null";if(g){s.push(String.format(null==c?void 0:c.A2,t.EntityLogicalName,null===(l=t.SelectorItems)||void 0===l?void 0:l.length)),s.push(String.format(null==c?void 0:c.A3,N.m,A.a+".setVisible"));const n=Object(I.y)(e),r=Object(I.u)(e);s.push({userInfomation:{displayName:null==n?void 0:n.userDisplayName,id:null===(u=null==n?void 0:n.userId)||void 0===u?void 0:u.guid,email:null==n?void 0:n.userEmail,"securityRoles (id and name)":Object(I.w)(e),"parentSecurityRoles (id)":r?Array.from(r):null}});const a=Object(T.d)(e);s.push({currentAppModule:{displayName:null==a?void 0:a.title,uniqueName:null==a?void 0:a.uniqueName,appId:null==a?void 0:a.appId,formsIncludedInAppModule:null===(p=null===(d=t.SelectorItems)||void 0===d?void 0:d.filter(e=>e.IsInApp))||void 0===p?void 0:p.map(e=>b(e))}}),s.push(null==c?void 0:c.A1),m||s.push(null==c?void 0:c.A4)}const _=[];for(const r of t.SelectorItems){const a=Object(f.a)(r.FormType),i=g&&b(r);let o="";if(a===R){const{userHasPermissionToForm:t,reason:n}=k(r,e,c);if(o=n,g&&!t&&_.push({form:i,selectionResult:String.format(null==c?void 0:c.A5,n)}),!t)continue}!m||r.IsInApp?(L(n,t,a,r,h),g&&_.push({form:i,selectionResult:(r.IsInApp?null==c?void 0:c.A7:null==c?void 0:c.A8)+` Reason why this user has permission: ${o}.`})):g&&_.push({form:i,selectionResult:null==c?void 0:c.A6})}if(g&&(s.push({forms:_}),s.push(`Summary of step 1: ${h.length} ${h.length>1||0===h.length?"forms are":"form is"} selected:`+(1===(null==h?void 0:h.length)?null==c?void 0:c.A9:(null==h?void 0:h.length)>1?null==c?void 0:c.A10:"")),s.push(h.map(e=>y(e))),s.push((null==c?void 0:c.A11)+(h.length?" (skipped).":"."))),0===h.length){const e=e=>Object(f.a)(e.FormType)===R,r=t=>e(t)&&t.IsFallbackForm,a=t.SelectorItems.some(e=>r(e)&&e.IsInApp),i=[];for(const e of t.SelectorItems){const t=g&&b(e),n=Object(f.a)(e.FormType);n===R?e.IsFallbackForm?!a||e.IsInApp?(i.push(e),g&&s.push({form:t,selectionResult:null==c?void 0:c.A15})):g&&s.push({form:t,selectionResult:null==c?void 0:c.A14}):g&&s.push({form:t,selectionResult:null==c?void 0:c.A13}):g&&s.push({form:t,selectionResult:String.format(null==c?void 0:c.A12,n)})}let o;0===i.length?(o=[t.SelectorItems.find(e)],g&&s.push(String.format(null==c?void 0:c.A16,JSON.stringify(b(o[0]))))):(o=i,g&&s.push(`Summary of step 2: ${i.length} fallback forms are selected.`)),o.forEach(e=>{L(n,t,R,e,h)})}if(i[t.EntityLogicalName]=t.UnfilteredIdsCount,g&&(s.push(null==c?void 0:c.A17),s.push(null==c?void 0:c.A18),s.push(null==c?void 0:c.A19)),h.length){const e=h[0],n=Object(f.a)(e.FormType),i=new a.a(e.Id);if(o[t.EntityLogicalName]||(o[t.EntityLogicalName]={}),!o[t.EntityLogicalName][n]){const e={formId:i,initialized:r.a.Initialized};o[t.EntityLogicalName][n]=e}g&&(s.push(null==c?void 0:c.A20),s.push(y(e)))}else if(0===h.length&&0===t.UnfilteredIdsCount)return g&&s.push(null==c?void 0:c.A21),!1;return!0}function k(e,t,n){var r,a,i;let o=e.Everyone,s="";if(o&&(s=null==n?void 0:n.A22),!o){const i=Object(I.w)(t);i&&(null===(r=null==e?void 0:e.RoleIds)||void 0===r?void 0:r.length)?(o=e.RoleIds.some(e=>i[e]),s=n&&String.format(null==n?void 0:n.A23,e.RoleIds)+(o?" and at least one":" but none")+" of user's security roles are included"):(i||(s=null==n?void 0:n.A24),(null===(a=null==e?void 0:e.RoleIds)||void 0===a?void 0:a.length)||(s=null==n?void 0:n.A25))}if(!o){const r=Object(I.u)(t);r&&(null===(i=null==e?void 0:e.RoleIds)||void 0===i?void 0:i.length)?(o=e.RoleIds.some(e=>r.has(e)),s+=(o?". However at least one":". Additionally none")+(null==n?void 0:n.A26)):s+=null==n?void 0:n.A27}return{userHasPermissionToForm:o,reason:s}}function L(e,t,n,r,a){e[t.EntityLogicalName]||(e[t.EntityLogicalName]={}),e[t.EntityLogicalName][n]||(e[t.EntityLogicalName][n]={}),e[t.EntityLogicalName][n][r.Id]={name:r.Name,description:r.Description},a.push(r)}function B(e,t,n,r,a,i,o,s,c="displayname"){return U(e,t,n,r,a,i,o,s,c).label}function U(e,t,n,r,a,i,o,s,c="displayname"){var l;let u,d;if(t&&c&&i&&i[t]&&i[t][c])u=i[t][c],d=O.a.ControlLablelInFormDescriptorForUserLanguage;else if(r&&n&&o&&o[r]&&o[r][n])u=o[r][n].DisplayName,d=O.a.AttributeName;else if(a&&s&&s[a]&&s[a].DisplayCollectionName)u=s[a].DisplayCollectionName,d=O.a.TargetEntityPluralName;else if(c&&(null==i?void 0:i[t])){const n=Object(S.D)(e),r=`${c}_${null===(l=null==n?void 0:n.languageCode)||void 0===l?void 0:l.toString()}`;i[t][r]&&(u=i[t][r],d=O.a.ControlLabelInBaseLanguage)}return{label:u,labelSource:d}}function V(e){const t=[],n={};for(const r of e)if(r.relationship){const e=r.relationship,t=r.attributeName;e in n?n[e].push(t):n[e]=[t]}else t.push(r.attributeName);return{attributes:t,relatedEntityAttributes:n}}function z(e,t){return{attributeName:e,relationship:t}}function q(e){const t=[];for(const n in e.Parameters){const r=e.Parameters[n];!1===r.Static&&t.push(r.Value)}return t}function H(e,t){t.CustomControls[1]=null,t.CustomControls[2]=null,t.CustomControls[3]=null;for(const n in e.CustomControls)switch(n){case C.a.Web.toString():t.CustomControls[1]=e.CustomControls[n];break;case C.a.Tablet.toString():t.CustomControls[2]=e.CustomControls[n];break;case C.a.Phone.toString():t.CustomControls[3]=e.CustomControls[n]}return t}function W(e){return Array.isArray(e)?e:e&&e.Controls?e.Controls:null}function G(e){return e?(e.forEach(e=>{!e||e.hasOwnProperty("Enabled")&&!Object(h.a)(e.Enabled)||(e.Enabled=!0)}),e):[]}function K(e=null){switch(e){case"expandAvailableSpace":case"singleComponent":return"singleComponent";default:return"cardSections"}}function Q(e){if(e){const t=e.PreviewId;if(t)return t}}function X(e,t,n,o,c,d,g){if(!e)return null;const m={},b={},y={},_={};let S;for(const O of e){const e=new a.a(O.Id);let C;S=O.EntityLogicalName||o;const E=[],I=[],w={},j=new p,P={},T=new p,N=[],A={},R={},x={},M={},F={},k={},L={},B=O.FormType,U=!!(g&&g[S]&&g[S].IsBPFEntity);if(O.Charts){const e=O.Charts;for(const t in e){const n=Object(l.a)(e[t]);_[t]=n}}if(O.TabAttributes&&(C={DashboardCategory:O.TabAttributes.dashboardCategory,PrimaryEntity:O.TabAttributes.primaryentitylogicalname,FilterBy:O.TabAttributes.filterby,TimeFrame:O.TabAttributes.timeframe}),O.Tabs){let e=0;const r="tab";for(const o of O.Tabs){const s=[];for(const c of o.Columns){const o=[];for(const s of c.Sections){const c=j.getUniqueName(s.Name||s.Id),l=[];for(const i of s.Rows){const o=[];let s=0;const u=[];for(const l of i.Cells){const d=l.Control;if(d){const p=re(d,S);let f=0;for(const h of p){const m=Y(l),b=ne(h,O.Id,B,l.RowSpan,n);if(1===p.length?b.LabelId=a.a.toString(new a.a(b.LabelId||l.Id)):b.LabelId=null,$(b,h,t,N,P,A,L,B,U),b.Name=T.getUniqueName(b.Name),!b.Label){const e="TargetEntityType";b.Parameters&&b.Parameters[e],b.Relationship&&g&&g[S]&&g[S].ManyToOneRelationships&&g[S].ManyToOneRelationships[b.Relationship]&&g[S].ManyToOneRelationships[b.Relationship].ReferencedEntity}if(b.ParentSectionName=c,b.ParentTabId=r+e,b.ParentCellId=m.Id,b.IsRequired=d.IsRequired,P[b.Name]=b,m.ControlName=b.Name,0===f){1===p.length&&(b.ShowLabel=l.ShowLabel);let e=!1;for(const t of o)t&&t.ControlName&&t.ControlName.indexOf(v.a)>-1&&m.ControlName&&m.ControlName.indexOf(v.a)>-1&&(e=!0);if(e){const e=[];for(let t=0;t<s;t++)e.push(Y(l));e.push(m);for(let t=s+1;t<i.Cells.length;t++)e.push(Y(l));const t={Visible:i.Visible,Height:i.Height,Cells:e};u.push(t),f=u.length}else o.push(m)}else if(m.Id=a.a.toString(a.a.newGuid()),u.length>=f)u[f-1].Cells.push(m);else{const e=[];for(let t=0;t<s;t++)e.push(Y(l));e.push(m);for(let t=s+1;t<i.Cells.length;t++)e.push(Y(l));const t={Visible:i.Visible,Height:i.Height,Cells:e};u.push(t)}f++}}else{const e=Y(l);o.push(e)}s++}const d={Visible:i.Visible,Height:i.Height,Cells:o};l.push(d);for(const e of u)l.push(e)}const u=new a.a(s.Id),d=new a.a(s.LabelId||s.Id);o.push(c);const p={Id:u,Label:s.Label,Name:c,Columns:s.Columns,ShowLabel:s.ShowLabel,Visible:s.Visible,Rows:l,CellLabel:s.CellLabel,DomId:Object(i.a)(),PreviewId:Q(s),SemanticZoomDomId:Object(i.a)(),AvailableForPhone:s.AvailableForPhone,Height:s.Height,LabelId:a.a.toString(d)};p.Label,w[c]=p}const l={Width:c.Width,SectionNames:o};s.push(l)}const l=o?J(o.TabFooter,t,N,b,A,L,c,d,g,P,T,O.Id,S,B):null,u=o?J(o.TabHeader,t,N,b,A,L,c,d,g,P,T,O.Id,S,B):null,p=o.Name||o.Id,f=o.LabelId||o.Id;E.push(p);const m={Id:r+e++,Label:o.Label,Name:p,ShowLabel:o.ShowLabel,Visible:o.Visible,EventHandlers:G(o.EventHandlers),Expanded:!!Object(h.a)(o.Expanded)||o.Expanded,Columns:s,LabelId:a.a.toString(new a.a(f)),DomId:Object(i.a)(),PreviewId:Q(o),Header:u,Footer:l,AvailableForPhone:o.AvailableForPhone,RawTabId:Object(h.a)(o.Id)?o.Id:o.Id.toLowerCase(),ContentType:K(o.ContentType)};m.Label,I.push(m)}}const X=[],ie=W(O.Header);if(ie)for(const e of ie){const n=re(e,S);for(const e of n){const n=ne(e,O.Id,null,null,null);$(n,e,t,N,P,A,L,B,U),n.Name=T.getUniqueName(n.Name),n.Label||(n.LabelId=n.LabelId?a.a.toString(new a.a(n.LabelId)):null),P[n.Name]=n,X.push(n)}}const oe={DomId:Object(i.a)(),PreviewId:Q(O.Header),AvailableForPhone:O.Header?O.Header.AvailableForPhone:null,Controls:X,CommandBarVisible:O.Header?O.Header.ShowCommandBar:null,BodyVisible:O.Header?O.Header.ShowBody:null,TabNavigatorVisible:O.Header?O.Header.ShowTabNavigator:null},ce=[],le=W(O.Footer);if(le)for(const e of le){const n=re(e,S);for(const e of n){const n=ne(e,O.Id,null,null,null);$(n,e,t,N,P,A,L,B,U),n.Name=T.getUniqueName(n.Name),n.Label||(n.LabelId=n.LabelId?a.a.toString(new a.a(n.LabelId)):null),P[n.Name]=n,ce.push(n)}}const de={DomId:Object(i.a)(),PreviewId:Q(O.Footer),AvailableForPhone:O.Footer?O.Footer.AvailableForPhone:null,Controls:ce,Visible:O.Footer?O.Footer.Visible:null},pe=[];if(10!==B&&O.HiddenFields)for(const e of O.HiddenFields){(t===D.Form||12===B)&&ae(e)&&e.DataFieldName&&(e.relationship?N.push(z(e.Id,e.relationship)):N.push(z(e.DataFieldName,e.relationship)));const n=ne(e,O.Id,null,null,null);n.Name=T.getUniqueName(n.Name),$(n,e,t,N,P,A,L,B,U),P[n.Name]=n,Z(n,L),pe.push(n)}const fe=te(O.FormParameters);if(fe)for(const e of fe){N.push(z(e.Name)),A[e.Name]=se(e);const t=ue(e);t.Name=T.getUniqueName(t.Name),P[t.Name]=t}const ge=[];if(O.InlineEditGridRow)for(const e of O.InlineEditGridRow){const n=ne(e,O.Id,null,null,null);$(n,e,t,N,P,A,L,B,U),n.Name=T.getUniqueName(n.Name),P[n.Name]=n,ge.push(n)}const{attributes:he,relatedEntityAttributes:me}=V(N);Object.keys(A).length>0&&(y[O.Id]=A);let be=!1;const ye=Object(f.a)(O.FormType);O.FormType&&ye&&"dashboard"===ye.toLowerCase()&&(be=!0);const _e=[];if(O.CustomControlConfigurations)for(const e of O.CustomControlConfigurations){const t=Object(u.a)(e);let n=null;be&&(n=JSON.parse(JSON.stringify(t)),H(t,n));const r=null==n?t:n;for(const e in r.CustomControls)if(r.CustomControls[e]){const t=q(r.CustomControls[e]);for(const e of t)-1===he.indexOf(e)&&-1===_e.indexOf(e)&&_e.push(e)}R[t.UniqueId]=r}const ve=new a.a("e7a81278-8635-4d9e-8d4d-59480b391c5b"),Se=new a.a("f9a8a302-114e-466a-b582-6771b2ae0d92"),Oe="ViewId",Ce=[];for(const e in P){const t=P[e];(a.a.equals(t.ClassId,ve)||a.a.equals(t.ClassId,Se)&&t.UniqueId&&!t.DataFieldName)&&t.Parameters&&t.Parameters[Oe]&&(t.HasContext=!0,Ce.push(new a.a(t.Parameters[Oe])))}if(O.Navigation){if(O.Navigation.NavBarAreas.NavBarAreas&&O.Navigation.NavBarAreas.NavBarAreas)for(const e of O.Navigation.NavBarAreas.NavBarAreas){const t={id:e.Id,titles:ee(e.Titles),PreviewId:Q(e)};x[e.Id]=t}if(O.Navigation.NavPaneIsvItems.NavBarIsvItems)for(const e of O.Navigation.NavPaneIsvItems.NavBarIsvItems){const t={id:e.Id,titles:ee(e.Titles),icon:e.Icon,url:e.Url,passParams:e.PassParams,sequence:e.Sequence,area:e.Area,client:e.Client,availableOffline:e.AvailableOffline,PreviewId:Q(e)};M[e.Id]=t}if(O.Navigation.NavBarByRelationshipItems)for(const e of O.Navigation.NavBarByRelationshipItems){const t=[];if(e.Privileges)for(const n of e.Privileges)t.push({entity:n.Entity,privilege:n.Privilege});const n={titles:e.Titles,tooltipTitles:e.TooltipTitles,privileges:t,relationshipName:e.RelationshipName,id:e.Id,area:e.Area,titleResourceId:e.TitleResourceId,client:e.Client,availableOffline:e.AvailableOffline,icon:e.Icon,sequence:e.Sequence,show:e.Show,viewId:e.ViewId,PreviewId:Q(e)};F[e.Id]=n}if(O.Navigation.NavBarItems)for(const e of O.Navigation.NavBarItems){const t={titles:e.Titles,icon:e.Icon,url:e.Url,id:e.Id,passparams:e.PassParams,sequence:e.Sequence,area:e.Area,client:e.Client,availableOffline:e.AvailableOffline};k[e.Id]=t}}const Ee={navBarAreas:x,navPaneIsvItems:M,navBarByRelationshipItems:F,navBarItems:k},Ie=[];Ie.push(...O.FormLibraries),Ie.push(...O.ClientResources);const we={initialized:r.a.Initialized,SubGrids:O.SubGrids,TabAttributes:C,TabNames:E,Tabs:I,ControlConfigurations:R,Sections:w,Controls:P,Id:e,Label:O.Label,Name:O.Name,EntityLogicalName:S,ShowLabel:O.ShowLabel,Visible:O.Visible,FormType:O.FormType,EventHandlers:G(O.EventHandlers),FormLibraries:Ie,Header:Array.isArray(O.Header)?X:oe,Footer:Array.isArray(O.Footer)?ce:de,HiddenFields:pe,InlineEditGridRow:ge,InlineQuickForms:L,LinkControlSections:O.LinkControlSections,Attributes:he,ControlConfigAttributes:_e,RelatedEntityAttributes:me,BusinessLogic:O.BusinessLogic,Charts:O.Charts,SubgridViewIds:Ce,Navigation:Ee,FormParameters:fe,ShowNavigationBar:O.ShowNavigationBar,ShowEntityImage:O.ShowEntityImage,HeaderDensity:s.a[O.HeaderDensity],VersionNumber:O.VersionNumber,OverallVersionNumber:O.OverallVersionNumber};m[a.a.toString(e)]=we}return{forms:m,attributes:y,entities:{},charts:_}}function Y(e){return{Id:e.Id,ColSpan:e.ColSpan,RowSpan:e.RowSpan,AutoExpand:e.AutoExpand,IsInFirstColumnOfSection:e.IsInFirstColumnOfSection,IsInLastColumnOfSection:e.IsInLastColumnOfSection,ShowLabel:e.ShowLabel,Visible:e.Visible,Locklevel:e.Locklevel,AvailableForPhone:e.AvailableForPhone,UserSpacer:e.UserSpacer,IsPreviewCell:e.IsPreviewCell,IsStreamCell:e.IsStreamCell,IsChartCell:e.IsChartCell,IsTileCell:e.IsTileCell,DomId:Object(i.a)(),PreviewId:Q(e)}}function J(e,t,n,r,i,o,s,c,l,u,d,p,f,g){const h=[];if(!e)return null;for(const r of e){const e=re(r,f);for(const r of e){r.LabelId=r.LabelId?a.a.toString(new a.a(r.LabelId)):r.Id;const e=ne(r,p,null);$(e,r,t,n,u,i,o,g,!1),u[e.Name]=e,h.push(e)}}return h}function $(e,t,n,r,i,o,s,c,l){if(a.a.equals(e.ClassId,d.rb)){t.DataFieldName=function(e){return e.Parameters&&e.Parameters.FailureTimeField?e.Parameters.FailureTimeField:""}(t);const e=function(e){const t=[];return e&&null!=e.Parameters&&(e.Parameters.CancelConditionName&&t.push({attributeName:e.Parameters.CancelConditionName}),e.Parameters.FailureConditionName&&t.push({attributeName:e.Parameters.FailureConditionName}),e.Parameters.FailureTimeField&&t.push({attributeName:e.Parameters.FailureTimeField}),e.Parameters.PauseConditionName&&t.push({attributeName:e.Parameters.PauseConditionName}),e.Parameters.SuccessConditionName&&t.push({attributeName:e.Parameters.SuccessConditionName}),e.Parameters.WarningConditionName&&t.push({attributeName:e.Parameters.WarningConditionName})),t}(t);e&&r.push(...e)}if(a.a.equals(e.ClassId,d.h)){const e=Object(g.b)(t);e&&r.push(...e)}if(l&&!t.IsUnbound&&ae(t)&&t.DataFieldName&&(e.DataFieldName=t.DataFieldName,e.Id=Object(E.e)(t.DataFieldName,t.Id,i),e.Name=e.Id),10===c&&function(e){const t=[d.C];for(let n=0;n<t.length;n++)if(a.a.equals(e,t[n]))return!1;return!0}(e.ClassId)||(n===D.Form||12===c)&&t.IsUnbound&&!t.DataFieldName?(a.a.equals(e.ClassId,d.Q)&&10===c&&(t.Type=24),a.a.equals(e.ClassId,d.J)||r.push(z(e.Name,e.Relationship)),e.DataFieldName=e.Name,o[e.Name]=function(e){const t=ce(e.Id,Object(_.c)(e.Type),e.RequiredLevel);return function(e,t){if(!e||!t)return;e.ClassId&&a.a.equals(d.fb,new a.a(e.ClassId))&&(t.Type=y.a.Lookup,t.Format="regarding");e.IsRequired&&(t.RequiredLevel=1);const n=e.ClassId&&a.a.equals(d.q,new a.a(e.ClassId)),r="Date";if(!e.Parameters||!e.Parameters.length)return void(n&&(t.Format=r,t.Behavior=b.a.DateOnly));for(const n of e.Parameters){const e=n.Name,r=n.Value,i=n.TargetEntities;if("OptionSetId"===e)t.OptionSetId=a.a.toString(a.a.fromExternalGuid(r));else if(i&&Array.isArray(i))for(const e of i)t.Targets.push(e.EntityLogicalName);else if(-1!==["LogicalName","Id","Type","EntityLogicalName","DisplayName","IsSecured","IsValidForCreate","IsValidForRead","IsValidForUpdate","RequiredLevel","PrecisionSource","Format","Behavior","DefaultFormValue","IsBaseCurrency","Targets","OptionSetName","AttributeOf","HasChanged","ImeMode"].indexOf(e))t[e]=r;else if(-1!==["MaxLength","MinValue","MaxValue","Precision","DefaultValue"].indexOf(e)){const n=parseInt(r,10);t[e]=isNaN(n)?r:n}}n&&(t.Format||(t.Format=r),t.Behavior=t.Format===r?b.a.DateOnly:b.a.UserLocal)}(e,t),t}(t)):(n===D.Form||12===c||11===c||l&&2===c)&&!t.IsUnbound&&ae(t)&&t.DataFieldName&&(r.push(z(t.DataFieldName,t.relationship)),e.DataFieldName=t.DataFieldName,Z(e,s)),function(e){const t=new a.a("7ccd1494-1f7a-4e3a-8bde-f32069daeb9f"),n=new a.a("e616a57f-20e0-4534-8662-a101b5ddf4e0");return a.a.equals(e.ClassId,t)||a.a.equals(e.ClassId,n)}(e)){const t="SearchForAutoSuggestionsUsing",n="EnableAutoSuggestions",a="AutoSuggestionSource";"true"===e.Parameters[n]&&"0"===e.Parameters[a]&&e.Parameters[t]&&r.push(z(e.Parameters[t]))}}function Z(e,t){if(e.Parameters&&e.Parameters.QuickForms){if(!e.DataFieldName)return;const n={},r=e.Parameters.QuickForms.match(/(?!entityname=")[A-Za-z0-9_]+(?=".*<\/QuickFormId>)/g),i=e.Parameters.QuickForms.match(/[A-Za-z0-9]+-[A-Za-z0-9]+-[A-Za-z0-9]+-[A-Za-z0-9]+-[A-Za-z0-9]+(?=<\/QuickFormId>)/g);for(let e=0;e<r.length;e++)n[r[e]]=a.a.tryParseOrNull(i[e]);t[e.Id]=n}}function ee(e){const t=[];for(const n of e)t.push({LCID:n.LCID,text:n.Text});return t}function te(e){const t=[];if(e)for(const n of e){const e={Name:n.Name,Type:n.Value};t.push(e)}return t}function ne(e,t,n,r,o){let s=e.Parameters;if(e.Parameters)for(const t of e.Parameters)s[t.Name]=t.Value;return o&&(s=function(e,t,n,r,a){if(5===r&&a&&n&&n.ChartGridMode&&"Chart"!==n.ChartGridMode){const r="true"===n.EnableViewPicker,o="true"===n.EnableQuickFind,s=t.ShowLabel,c="true"===n.EnableJumpBar,l=26,u=26,d=22,p=40,f=Object(m.a)(e),g=(i=f.sizes.Section.cellHeightInRem,parseFloat(window.getComputedStyle(document.documentElement).fontSize)*parseFloat(i));let h=0,b=0;r||o||s||c?(h=r||s?h+l:h+0,h=o?h+u:h+0,h=c?h+d:h+0):h=2,b=h>a?a-Math.ceil((h+26+20)/30):a-h;let y=0;o||y++,n.RecordsPerPage===b.toString()&&(n.RecordsPerPage=parseInt(b*(g/p)+y,10).toString())}var i;return n}(o,e,s,n,r)),{Id:e.Id,Label:e.Label,Name:e.Id,ShowLabel:e.ShowLabel,Visible:e.Visible,ClassId:new a.a(e.ClassId),Disabled:e.Disabled,Parameters:s,ControlLayout:e.ControlLayout,UniqueId:e.UniqueId,LabelId:e.LabelId,Relationship:e.relationship,DomId:Object(i.b)(t),PreviewId:Q(e),IsUnbound:e.IsUnbound}}function re(e,t){const n=e.DataFieldName;if(n){if(Object(v.e)(t)){const t=Object(v.d)(n),r=[];if(t){for(const n in t){const a=t[n];a&&r.push({ClassId:e.ClassId,ControlLayout:e.ControlLayout,Disabled:e.Disabled,IsRequired:e.IsRequired,Id:e.Id+v.a+a,Label:null,Name:a,Parameters:e.Parameters,relationship:e.relationship,RequiredLevel:e.RequiredLevel,ShowLabel:e.ShowLabel,Type:e.Type,Visible:e.Visible,DataFieldName:a})}return Object(v.f)(n)&&r.push(e),r}}}return[e]}function ae(e){return e.hasOwnProperty("DataFieldName")}function ie(e,t){const n=[],r={};if(null!=e&&null!=t){for(const r in e)for(const e in t)r===e&&n.push(r);for(const a in n){const i=n[a],o=e[i],s=t[i];if(o===s)continue;const l=Object(c.a)(o,s);r[l.EntityLogicalName]=l}}if(null!=e)for(const t in e)-1===n.indexOf(t)&&(r[t]=e[t]);if(null!=t)for(const e in t)-1===n.indexOf(e)&&(r[e]=t[e]);return r}function oe(e,t){const n=Object.assign({},e);for(const e in t)n.hasOwnProperty(e)?Object.assign(n[e],t[e]):n[e]=t[e];return n}function se(e){const t=function(e){switch(e){case"SafeString":return y.a.String;case"UniqueId":return y.a.UniqueIdentifier;case"Boolean":return y.a.Boolean;case"DateTime":return y.a.DateTime;case"Double":return y.a.Double;case"EntityType":case"PositiveInteger":case"UnsignedInt":case"Integer":return y.a.Integer;case"Long":return y.a.BigInt;default:return y.a.Unknown}}(e.Type);switch(e.Type){case"EntityType":case"UnsignedInt":case"PositiveInteger":return ce(e.Name,t,0,0,!0);case"Double":return ce(e.Name,t,0,null,!0,10);default:return ce(e.Name,t,0,null,!0)}}function ce(e,t,n,a,i,o){return{Initialized:r.a.Initialized,LogicalName:e,Id:null,Type:t,EntityLogicalName:null,DisplayName:null,IsSecured:!1,IsValidForCreate:!0,IsValidForRead:!0,IsValidForUpdate:!0,RequiredLevel:n,MinValue:null!=a?a:null,Precision:null!=o?o:0,PrecisionSource:0,Format:le(t),Behavior:null,DefaultValue:null,IsBaseCurrency:!1,Targets:[],AttributeOf:null,HasChanged:!1,ImeMode:null,OptionSetName:null,OptionSetType:null,OptionSet:[],OptionSetId:null,IsFormParameter:!(!i||!0!==i)&&i}}function le(e){switch(e){case y.a.DateTime:return y.a.DateTime;default:return null}}function ue(e){return{Id:e.Name,Label:null,Name:e.Name,ShowLabel:!1,Visible:!1,ClassId:a.a.EMPTY,Disabled:!1,Parameters:{formParameter:!0},ControlLayout:0,UniqueId:null,LabelId:null}}!function(e){e[e.Other=0]="Other",e[e.Form=1]="Form",e[e.Dialog=2]="Dialog",e[e.Dashboard=3]="Dashboard",e[e.Entity=4]="Entity",e[e.View=5]="View"}(D||(D={}))},g22U:function(e,t,n){"use strict";n.d(t,"d",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"a",(function(){return c})),n.d(t,"f",(function(){return l})),n.d(t,"g",(function(){return u}));var r=n("Er26");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a={UPDATE:"Update",CREATE:"Create",DELETE:"Delete",RETRIEVE:"Retrieve",RETRIEVE_MULTIPLE:"RetrieveMultiple",Execution_Multiple:"ExecutionMultiple",ACTION:"Action",FUNCTION:"Function",GCM:"GetClientMetadata",GCMEX:"GetClientMetadataEx",SCM:"SyncClientMetadata",ENTITY_DEFINITION:"EntityDefinition",EXPRESSION_FUNCTION:"ExpressionRuntimeFunction"},i={Update:"Update",Associate:"Associate",BinaryUpload:"BinaryUpload",Create:"Create",Delete:"Delete",Disassociate:"Disassociate",BinaryDelete:"BinaryDelete",DeleteWithUrlParams:"DeleteWithUrlParams",Retrieve:"Retrieve",BinaryDownload:"BinaryDownload",RetrieveMultipleOther:"RetrieveMultipleOther",Grid:"Grid",Subgrid:"Subgrid",Lookup:"Lookup",Quickfind:"Quickfind",CustomView:"CustomView",CustomQuery:"CustomQuery",GetClientMetadata:"GetClientMetadata",UserContext:"UserContext",PreloadGCM:"PreloadGetClientMetadata",SyncClientMetadata:"SyncClientMetadata",ExecutionMultiple:"ExecutionMultiple",SetProcessRequest:"SetProcess",SetProcessInstanceRequest:"SetProcessInstance",ExecuteWorkflowRequest:"ExecuteWorkflow",RetrieveServerTime:"RetrieveServerTime",ExecuteQuickFindRequest:"ExecuteQuickFind",InvokeProcessActionInternal:"InvokeProcessActionInternal",GlobalSearchSuggestions:"GlobalSearchSuggestions",ExternalSearch:"ExternalSearch",SubmitNaturalLanguageFeedback:"SubmitNaturalLanguageFeedback",RetrieveProcessInstances:"RetrieveProcessInstances",RetrieveFilteredProcesses:"RetrieveFilteredProcesses",RollupRequest:"Rollup",RetrieveLookupData:"RetrieveLookupData",InitializeFromRequest:"InitializeFrom",RetrieveProcessControlDataRequest:"RetrieveProcessControlData",WhoAmI:"WhoAmI",RetrieveRelevanceSearchIndex:"RetrieveRelevanceSearchIndex",RetrievePrincipalAccess:"RetrievePrincipalAccess",AssetLoader:"AssetLoader",RetrieveNaturalLanguage:"RetrieveNaturalLanguage",RetrievePersonalWall:"RetrievePersonalWall",RetrieveRecordWall:"RetrieveRecordWall",RetrieveTimelineWallRecords:"RetrieveTimelineWallRecords",EntityDefinition:"EntityDefinition",Initialization:"Initialization",ExecuteHostFunction:"ExecuteHostFunction",ExecuteExpressionRequest:"ExecuteExpressionRequest",RecalculateDependencies:"RecalculateDependencies",LoadAdditionalScripts:"LoadAdditionalScripts"},o={Preload:"Preload",Default:"Default",ExpressionRuntime:"ExpressionRuntimeRequest",MdlHttpClient:"MdlHttpClient",MdlMetadataClient:"MdlMetadataClient",ClientApiRetrieveRecord:"Xrm.WebApi.online.retrieveRecord",ClientApiRetrieveMultipleRecords:"Xrm.WebApi.online.retrieveMultipleRecords"},s="Unknown",c={TYPE:r.f.OPERATION_TYPE,SUB_TYPE:r.f.OPERATION_SUB_TYPE,SOURCE:r.f.OPERATION_SOURCE};function l(e){var t,n,r;return{type:(null===(t=e.additionalParameters)||void 0===t?void 0:t[c.TYPE])||s,subType:(null===(n=e.additionalParameters)||void 0===n?void 0:n[c.SUB_TYPE])||s,source:(null===(r=e.additionalParameters)||void 0===r?void 0:r[c.SOURCE])||o.Default}}function u(e){let t=o.Default;return e.OperationSource&&(t=e.OperationSource),t}},g2Nw:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("09gH"),a=n("CpcI");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i=r.o.concat(a.g)},g440:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return g}));var r=n("Uv1Y"),a=n("eXjw"),i=n("K7RF"),o=n("sw/s"),s=n("Fn5S"),c=n("g0tL"),l=n("ueZM"),u=n("/oKV"),d=n("iJGp");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const p="taskBasedFlow.retrieve",f="TaskBasedFlow.retrieveTaskBasedFlow";function g(e,t){return{type:"taskBasedFlow.retrieve.async",execute({dispatch:n,getState:g},h){let m=u.a.LocalAndRemote;h.DataSource;const b=g(),y=h.TraceManager.getTracer("TaskBasedFlow"),_=Object(s.a)(b);if(!(_&&_.taskBasedFlowUniqueNames&&_.taskBasedFlowUniqueNames.indexOf(e)>=0)){const t=`Task ${e} was deactivated, deleted or its role privileges were changed.`;return y.warn(t),h.EventManager.ReportComponentFailure(p,Error(t)),Promise.resolve(null)}const v=Object(o.b)(b,e);if(v===a.a.Initialized&&Object(i.e)(b,Object(o.a)(b,e).overallVersionNumber)&&(m=u.a.Remote),v===a.a.Uninitialized||m!==u.a.LocalAndRemote)return y.info("Task flow with name:"+e+" is not in state. Fetching from server..."),n(function(e){const t=e?{[e]:{initialized:a.a.Initializing}}:null;return{type:p,payload:{taskBasedFlows:t}}}(e)),n(function(e,t,n){return{type:"taskBasedFlow.retrieve.async",execute:({dispatch:e,getState:a},o)=>e(Object(i.b)("taskbasedflow",null,null,null,!0,d.a.OnDemandWithoutContext,null,null,[t],c.b.Form,n)).catch(r.b)}}(0,e,m)).then(a=>{n(function(e){return{type:p,payload:e}}(a)),y.info("Task flow server fetch for name:"+e+" completed.");const i=a&&a.taskBasedFlows&&a.taskBasedFlows[e];return i?(h.EventManager.ReportComponentSuccess(f),n(Object(l.a)(i.formId,t)).then(()=>i,r.b)):(h.EventManager.ReportComponentFailure(f,Error("No taskbasedflow found in metadata response for uniquename:"+e)),null)});const S=Object(o.a)(b,e);return S?h.EventManager.ReportComponentSuccess(f):h.EventManager.ReportComponentFailure(f,Error("Task based flow not found in state. getTaskBasedFlow returned null for:"+e)),Promise.resolve(S)}}}},g73c:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e,t){return a(e,t)}function a(e,t){const n=t.charCodeAt(0);if(n<=57&&n>=0){const e=parseInt(t,10);if(isFinite(e)&&e>=0)return e}try{const n=e[t];return null!=n?n:null}catch(e){const n=parseInt(t,10);if(isFinite(n)&&n>=0)return n;throw e}}function i(e,t){const n=e;return n[t]&&n[t].toString()||null}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i}))},gFPh:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("3BuU"),a=n("sDlx"),i=n("mf7K"),o=n("X6wG"),s=n("RHUE"),c=n("E+70"),l=n("3VnW"),u=function(){function e(){}return e.initialize=function(e,t){if(void 0===t&&(t={}),!this._isInitialized)return this._isInitialized=!0,i.default.defaultTenantToken=e,this._overrideValuesFromConfig(t),this._config.disableCookiesUsage&&!this._config.propertyStorageOverride&&(i.default.sessionEnabled=!1),l.default.addPropertyStorageOverride(this._config.propertyStorageOverride),l.default.autoCollect(i.default.semanticContext,this._config.disableCookiesUsage,this._config.userAgent),s.default.initialize(this._config),i.default.loggingEnabled=!0,this._config.enableAutoUserSession&&(this.getLogger().logSession(a.AWTSessionState.Started),window.addEventListener("beforeunload",this.flushAndTeardown)),this.getLogger()},e.getSemanticContext=function(){return i.default.semanticContext},e.flush=function(e){this._isInitialized&&!this._isDestroyed&&s.default.flush(e)},e.flushAndTeardown=function(){this._isInitialized&&!this._isDestroyed&&(this._config.enableAutoUserSession&&this.getLogger().logSession(a.AWTSessionState.Ended),s.default.flushAndTeardown(),i.default.loggingEnabled=!1,this._isDestroyed=!0)},e.pauseTransmission=function(){this._isInitialized&&!this._isDestroyed&&s.default.pauseTransmission()},e.resumeTransmision=function(){this._isInitialized&&!this._isDestroyed&&s.default.resumeTransmision()},e.setTransmitProfile=function(e){this._isInitialized&&!this._isDestroyed&&s.default.setTransmitProfile(e)},e.loadTransmitProfiles=function(e){this._isInitialized&&!this._isDestroyed&&s.default.loadTransmitProfiles(e)},e.setContext=function(e,t,n){void 0===n&&(n=r.AWTPropertyType.Unspecified),i.default.logManagerContext.setProperty(e,t,n)},e.setContextWithPii=function(e,t,n,a){void 0===a&&(a=r.AWTPropertyType.Unspecified),i.default.logManagerContext.setPropertyWithPii(e,t,n,a)},e.setContextWithCustomerContent=function(e,t,n,a){void 0===a&&(a=r.AWTPropertyType.Unspecified),i.default.logManagerContext.setPropertyWithCustomerContent(e,t,n,a)},e.getLogger=function(e){var t=e;return t&&t!==i.default.defaultTenantToken||(t=""),this._loggers[t]||(this._loggers[t]=new o.default(t)),this._loggers[t]},e.addNotificationListener=function(e){c.default.addNotificationListener(e)},e.removeNotificationListener=function(e){c.default.removeNotificationListener(e)},e._overrideValuesFromConfig=function(e){e.collectorUri&&(this._config.collectorUri=e.collectorUri),e.cacheMemorySizeLimitInNumberOfEvents>0&&(this._config.cacheMemorySizeLimitInNumberOfEvents=e.cacheMemorySizeLimitInNumberOfEvents),e.httpXHROverride&&e.httpXHROverride.sendPOST&&(this._config.httpXHROverride=e.httpXHROverride),e.propertyStorageOverride&&e.propertyStorageOverride.getProperty&&e.propertyStorageOverride.setProperty&&(this._config.propertyStorageOverride=e.propertyStorageOverride),e.userAgent&&(this._config.userAgent=e.userAgent),e.disableCookiesUsage&&(this._config.disableCookiesUsage=e.disableCookiesUsage),e.canSendStatEvent&&(this._config.canSendStatEvent=e.canSendStatEvent),e.enableAutoUserSession&&"undefined"!=typeof window&&window.addEventListener&&(this._config.enableAutoUserSession=e.enableAutoUserSession),e.clockSkewRefreshDurationInMins>0&&(this._config.clockSkewRefreshDurationInMins=e.clockSkewRefreshDurationInMins)},e._loggers={},e._isInitialized=!1,e._isDestroyed=!1,e._config={collectorUri:"https://browser.pipe.aria.microsoft.com/Collector/3.0/",cacheMemorySizeLimitInNumberOfEvents:1e4,disableCookiesUsage:!1,canSendStatEvent:function(e){return!0},clockSkewRefreshDurationInMins:0},e}();t.default=u},gNtT:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="deviceSettingInformation",a="userAccessibilitySetting"},gQ5I:function(e,t,n){"use strict";n.d(t,"a",(function(){return _})),n.d(t,"c",(function(){return v})),n.d(t,"e",(function(){return O})),n.d(t,"d",(function(){return C})),n.d(t,"f",(function(){return I})),n.d(t,"b",(function(){return S}));var r=n("aOhN"),a=n("pCLb"),i=n("oqdd"),o=n("arV0"),s=n("xPbo"),c=n("QHx/"),l=n("/iCT"),u=n("xHmU"),d=n("tFCh"),p=n("+nTZ"),f=n("zsAz"),g=n("1OTd"),h=n("pF61"),m=n("oT5e"),b=n("Lyxw"),y=n("3/02");const _="router.close",v="router.remove_closed_page",S="router.garbage_collect_page";function O(e,t="close"){return{type:"router.close.async",execute({dispatch:n,getState:a},l){if(Object(h.m)(a(),e))return Promise.reject(Object(f.d)("Trying to close the page which was already closed",2415919107,[{name:"PageId",value:e}]));const u=Object(c.a)(a(),e);return l.Router.preCloseCheck(e,t).then(s=>{if(s.resultType===i.a.Fail)return Promise.resolve(s.resultValue);if(s.resultType===i.a.Success){if(!Object(o.h)(a(),e)){return l.Router.closePage(e,t).then(()=>{if(l.Router.browsingContextCouldNavigateBack(u))return n(Object(r.b)(e));const t=Object(m.a)(a(),u.targetBrowsingContext);return l.BrowsingContextHandlerFactory.getHandler(t.type).close(u.targetBrowsingContext).then(t=>({status:t?0:1,pageId:e}),t=>{if(2415919132===(null==t?void 0:t.errorCode))return n(Object(r.b)(e));throw t})})}return l.Router.shouldDialogClose(e).then(r=>{if(r){return l.Router.closePage(e,t).then(t=>{n(E(e,u.targetBrowsingContext,t.output))})}const a=[{name:"PageId",value:e}];throw Object(f.d)("Couldn't close page ",2415919107,a)})}},e=>{throw u.targetBrowsingContext&&n(Object(s.e)(e,u.targetBrowsingContext)),e})}}}function C(e){return{type:"router.close_all_dialogs",execute({dispatch:t,getState:n},r){let a=Object(u.a)(n(),e);let o=Promise.resolve(!0);return a=[].concat(a).reverse(),a.forEach(n=>{o=o.then(()=>r.Router.preCloseCheck(n,"close").then(a=>{if(a.resultType===i.a.Fail)throw a.resultValue;if(a.resultType===i.a.Success)return r.Router.shouldDialogClose(n).then(a=>{if(a){return r.Router.closePage(n,"close").then(r=>(t(E(n,e,r.output)),!0))}throw Object(f.d)(g.l,2415919106)})},n=>{throw t(Object(s.e)(n,e)),n}))}),o}}}function E(e,t,n){return{type:"close.dialog.internal",sync:!0,execute({dispatch:r,getState:i},o){const s=Object(p.b)(i(),e);if(!s){const n=[{name:"PageId",value:e},{name:"BrowsingContextId",value:t}];throw Object(f.d)("dialogContext does not exist for pageId",2415919107,n)}r(function(e,t,n){return{type:_,payload:{__output:e,pageId:t,browsingContextId:n},meta:{pageId:t}}}(n,e,t)),r(Object(d.c)(s.dialogContextId,e,t)),Object(l.a)(e),r(Object(a.a)(e)),Object(b.f)(i(),y.Lc)?(r(w(e)),o.Router.cleanUp(e)):r({type:v,payload:{},meta:{pageId:e}})}}}function I(e,t="garbage collection"){return{type:"router.close.async",execute:({dispatch:n},r)=>r.Router.closePage(e,t).then(()=>{Object(l.a)(e),n(Object(a.a)(e)),n(w(e)),r.Router.cleanUp(e)})}}function w(e){return{type:S,payload:{},meta:{pageId:e}}}},"gg/8":function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(){const e=window.SERVER_VERSION_VALUE||"8.0.0000.0000";return String.format("{0}.{1}.{2}.{3}",e.substr(0,1),e.substr(1,1),e.substr(2,4),e.substr(6))}n.d(t,"a",(function(){return r}))},ghNp:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"h",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"f",(function(){return l})),n.d(t,"g",(function(){return u})),n.d(t,"d",(function(){return p})),n.d(t,"e",(function(){return f}));var r=n("dHD5"),a=n("lza4");function i(e,t,n){return{type:"clientapi.add.to.contextdictionary",sync:!0,execute(i,o){const s=o.ClientApiManager.getClientApiEntry(t),c=Object(r.w)(n);if(s.xrmObjectCache[c]){const e=[{name:"ContextKey",value:c}],t="Verify that the context token used to add the item to the cache is correct.",n="XrmObjectCache already contains an item with ContextKey";throw o.EventManager.ReportComponentFailure("ClientApi.XrmObjectCache.addXrmObjectToCache",new Error(n),t,e),new Error(`${n} ${c}`)}s.xrmObjectCache[c]=e,i.dispatch(Object(a.b)(t,c,!0))}}}function o(e,t){return{type:"clientapi.remove.from.contextdictionary",sync:!0,execute(n,a){const i=a.ClientApiManager.getClientApiEntry(e),o=Object(r.w)(t);delete i.xrmObjectCache[o]}}}function s(e,t){return d(e,t)}function c(e,t){return d(e,t)}function l(e,t){return d(e,t)}function u(e,t){return d(e,t)}function d(e,t){return{type:"clientapi.get.from.contextdictionary",sync:!0,execute:(n,r)=>p(e,t,r.ClientApiManager)}}function p(e,t,n){if(n){const a=Object(r.w)(t);return n.getClientApiEntry(e).xrmObjectCache[a]}return null}function f(e,t,n){return n?n.getClientApiEntry(e).xrmObjectCache[t]:null}},glAs:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e){return e&&e.appShellState?e.appShellState.hideAppNameInTopBar:null}function a(e){var t;return null===(t=null==e?void 0:e.appShellState)||void 0===t?void 0:t.suppressSessionCloseWarning}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}))},go4y:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e.SkypeChannelIframeSuffix="SkypeChannelIFrame",e.ConversationManagerContainerId="ConversationManagerContainer",e.WebResourcePath="msdyn_/Scripts/SkypeChannelLoader.js"}(r||(r={}))},gqKu:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.Default=0]="Default",e[e.TeamsDefault=1]="TeamsDefault",e[e.TeamsDark=2]="TeamsDark",e[e.TeamsHighContrast=3]="TeamsHighContrast",e[e.Wacky=4]="Wacky"}(r||(r={}))},gvQo:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("84PK");class a{constructor(e,t,n,r){this._depth=0,this._privilegeId=null,this._businessUnitId=null,this._depth=n,this._privilegeId=e,this._businessUnitId=t,this._privilegeName=r}get_depth(){return this._depth}get_privilegeId(){return this._privilegeId}get_businessUnitId(){return this._businessUnitId}get_privilegeName(){return this._privilegeName}getObjectData(){return{depth:this._depth,privilegeid:this._privilegeId.getObjectData(),businessunitid:this._businessUnitId.getObjectData(),privilegename:this._privilegeName}}static createFromObjectData(e){const t=r.a.createFromObjectData(e.privilegeid),n=r.a.createFromObjectData(e.businessunitid);return new a(t,n,e.depth,e.privilegename)}}},gw2m:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * The unique name of the page module.
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="custom"},gxvI:function(e,t,n){"use strict";n.d(t,"a",(function(){return B}));var r=n("mMyr"),a=n("q441"),i=n("/to1"),o=n("kXuq"),s=n("RiHV"),c=n("Fn63"),l=n("N2HV"),u=n("hoir"),d=n("d6Hx"),p=n("QBtP"),f=n("uZvv"),g=n("u+q+"),h=n("3cEW"),m=n("unFF"),b=n("zVFX"),y=n("YxC/"),_=n("eD3A"),v=n("EY5k"),S=n("ws6F"),O=n("Knfm"),C=n("GEbX"),E=n("4leG"),I=n("0FMG"),w=n("GYEz"),j=n("w1eR"),P=n("SocB"),T=n("LzVy"),N=n("sclX"),A=n("3rse"),R=n("tJ+6"),D=n("q43A"),x=n("Lyxw"),M=n("3/02"),F=n("AVDU"),k=n("ju1h");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class L extends r.Component{constructor(e,t){super(e),this._hoverBackgroundColr="",this._onClickHandler=this._onClickHandler.bind(this),this._onKeyDownHandler=this._onKeyDownHandler.bind(this),t.hiddenAction&&(this._hiddenActionTriggerCallback=Object(u.a)(t.hiddenAction)),this.props.shouldApplyModernMultiSessionLayout?this.props.isRenderedInSessionListFlyout2022&&this.props.setSitemapExpandedState(0):this.props.isHeaderButton?this.props.setSitemapExpandedState(0):this.props.loadPanelStateFromLocalStorage(this.props.needCollapsedByDefault?0:1),S.z.some(t=>!Object(y.c)(e.resourceStrings,t))&&e.retrieveResourceStrings(S.z);const n=this.props.designLanguage,r=n?n.Components.Navigation.Rest.Hover.BackgroundColor:this.props.theme.colors.BaseColor.White;this._hoverBackgroundColr=this.props.isMailApp?Object(P.g)(P.d.Blue.Blue6,P.b).Fill:this.props.hoverBackgroundColor||r}_onClickHandler(){this.props.toggleSiteMap(),this._hiddenActionTriggerCallback&&this._hiddenActionTriggerCallback()}_getIconStyle(){return{fontFamily:"Dyn CRM Symbol",fontSize:"16px"}}_getButtonStyle(){const{iconColor:e,navigationType:t,isHeaderButton:n,theme:r,designLanguage:a,overwriteStyle:i,isApril2021Update:o}=this.props,s=t===C.a.MultiSession&&o?b.a.sizes.Measures.Measure225:42;return Object.assign({display:"block",cursor:this.props.forceCollapsed?"auto":"pointer",backgroundColor:"transparent",height:s,width:44,borderStyle:"none",flexShrink:0,color:e,":hover":!this.props.forceCollapsed&&{"> div":{backgroundColor:this._hoverBackgroundColr,boxShadow:"0px 4px 8px rgba(0,0,0,0.1)",borderRadius:"2px"}},":focus":n?Object(D.c)(r,a):void 0,padding:6},i)}_getButtonContainerStyle(){return{width:"100%",height:"100%",justifyContent:"center",alignItems:"center",margin:"auto"}}_getPanelStatusString(){return Object(y.c)(this.props.resourceStrings,1===this.props.panelState?S.d:S.e)}_getTitle(){if(this.props.navigationType===C.a.MultiSession){const e=Object(y.c)(this.props.resourceStrings,S.g);return e&&String.format(e,this._getPanelStatusString())}const e=this._getAccessibilityLabel();return e&&Object(_.k)(e,e,void 0)}_getAccessibilityLabel(){if(this.props.navigationType===C.a.MultiSession){const e=Object(y.c)(this.props.resourceStrings,S.f);return e&&String.format(e,this._getPanelStatusString())}return Object(y.c)(this.props.resourceStrings,S.E)}_onKeyDownHandler(e){e.keyCode===A.a.Enter&&e.stopPropagation()}render(){const e=1===this.props.panelState;return r.createElement(a.a,{id:this.props.isRenderedInSessionListFlyout2022?d.k:d.g,style:this._getButtonStyle(),onClick:this._onClickHandler,accessibilityLabel:this._getAccessibilityLabel(),title:this._getTitle(),accessibilityExpanded:e,onKeyDown:this._onKeyDownHandler,testhooks:{id:d.f,[s.a.LearningPathDOMAttributeSuffix]:"sitemap-launcher",[k.o]:!0},disabled:this.props.forceCollapsed},r.createElement(o.a,{style:this._getButtonContainerStyle()},r.createElement(i.a,{style:this._getIconStyle()},r.createElement(l.b,{type:c.a.SiteMap}))))}}L.contextType=p.b;const B=Object(g.a)((function(){const e=Object(y.h)();return t=>{const n=e(t,S.z),r=Object(f.e)(t),a=Object(m.a)(t),i=Object(R.b)(t)?Object(R.a)(t):null,o=Object(O.a)(t),s=Object(E.c)(t),c=Object(T.a)(t)===N.b.Native;return{panelState:r,theme:a,designLanguage:i,resourceStrings:n,navigationType:o,needCollapsedByDefault:s||c,isMailApp:Object(w.a)(t)===j.a.MailApp,isApril2021Update:Object(x.f)(t,M.o),shouldApplyModernMultiSessionLayout:Object(F.d)(t)}}}),(function(e){return{retrieveResourceStrings:t=>e(Object(v.e)(t)),loadPanelStateFromLocalStorage:t=>{e(Object(h.a)(t))},toggleSiteMap:()=>{e(Object(h.b)(!0))},setSitemapExpandedState:t=>{e(Object(I.g)(t))}}}))(L)},"gy+e":function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return u}));var r=n("kAKO"),a=n("yHIv"),i=n("VCkP"),o=n("Z9sG"),s=n("zI6t"),c=n.n(s);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function l(){return{diagnosticName:"AuthenticateUser",boot:(e,t,n)=>u(t,n).then(r=>{c.a.addKeyPerformanceIndicator("AuthenticationComplete"),e.getShimBootType()&&(e.getShimBootType().autoSignIn=r);const a=new o.a(t,n),i=[];return a.isOperationAvailable("ready")&&i.push(a.ready()),a.isOperationAvailable("initialized")&&i.push(a.initialized()),Promise.all(i)}),supportedClientHostTypes:a.a,supportedPageTypes:a.b,priority:r.a.Normal}}function u(e,t){const n=new i.a(e,t);return n.isOperationAvailable("authenticate")?n.authenticate(!1):Promise.resolve(!0)}},gzcE:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e._IsDataViewSupport=function(){return"undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView},e}();t.BrowserChecker=r},h34H:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return i}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="metadata.powerbi.report.retrieveasync",a="metadata.powerbi.report.retrievesuccess",i="uniqueName"},h4iz:function(e,t,n){"use strict";n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return s})),n.d(t,"d",(function(){return l})),n.d(t,"e",(function(){return c}));var r=n("arV0"),a=n("E5IU"),i=n("Zvo8"),o=n("jq7Z");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function s(e){return Object(a.k)(e)}function c(e){const t=s(e),n=Object(i.b)("persistentNavTourCookie_"+t);return null!==n&&"true"===n}function l(e,t){const{welcomePageName:n}=Object(r.j)(e,t.id);return n}function u(e,t){const n=Object(o.a)(e,t);return n?n.output:null}function d(e,t){const{dialogOptions:n}=Object(r.j)(e,t.id);return n}},h6c1:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e,t){return e.pluginState[t]}n.d(t,"a",(function(){return r}))},hAdb:function(e,t,n){"use strict";n.d(t,"g",(function(){return a})),n.d(t,"h",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"e",(function(){return l})),n.d(t,"d",(function(){return u})),n.d(t,"f",(function(){return d})),n.d(t,"i",(function(){return p}));var r=n("D6Jg");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e){return e.configuration&&e.configuration.performanceUiEnabled}function i(e){return e.configuration&&e.configuration.ribbonDebug}function o(e){return e.configuration&&e.configuration.fcbs}function s(e,t){const n=o(e);return!(!n||!t)&&n["FCB."+t]}function c(e,t){const n=function(e,t){var n;return null===(n=null==e?void 0:e.configuration)||void 0===n?void 0:n.flags[null==t?void 0:t.toLowerCase()]}(e,t);if(n&&/[\W]/.test(n))throw new Error(`The value of the flag '${t}' contains characters that are not supported.`);return n}function l(e,t){return Object(r.c)(c(e,t))}function u(e,t){var n,r;return null===(r=null===(n=c(e,t))||void 0===n?void 0:n.split("_"))||void 0===r?void 0:r.filter(e=>e.length)}function d(e){return e.configuration.hostConfig}function p(e){var t;return null===(t=e.configuration)||void 0===t?void 0:t.solutionUniqueName}},hBJV:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("K7RF"),a=n("Uv1Y"),i=n("x/aW"),o=n("iJGp"),s=n("/oKV");function c(){return{type:"metadataversion.retrieve.async",execute:({dispatch:e,getState:t},n)=>e(Object(r.b)(i.a.MetadataVersion,null,null,null,!1,o.a.OnDemandWithoutContext,null,null,[],null,s.a.Remote)).catch(e=>{null!=e&&null!=e.message?-2147093999!==e.errorCode&&Object(a.b)(e):Object(a.b)(e)})}}},hGVc:function(e,t,n){"use strict";n.d(t,"F",(function(){return r})),n.d(t,"G",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"E",(function(){return o})),n.d(t,"D",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return u})),n.d(t,"f",(function(){return d})),n.d(t,"e",(function(){return p})),n.d(t,"h",(function(){return f})),n.d(t,"i",(function(){return g})),n.d(t,"j",(function(){return h})),n.d(t,"k",(function(){return m})),n.d(t,"l",(function(){return b})),n.d(t,"m",(function(){return y})),n.d(t,"n",(function(){return _})),n.d(t,"o",(function(){return v})),n.d(t,"p",(function(){return S})),n.d(t,"q",(function(){return O})),n.d(t,"r",(function(){return C})),n.d(t,"t",(function(){return E})),n.d(t,"u",(function(){return I})),n.d(t,"w",(function(){return w})),n.d(t,"v",(function(){return j})),n.d(t,"x",(function(){return P})),n.d(t,"y",(function(){return T})),n.d(t,"g",(function(){return N})),n.d(t,"z",(function(){return A})),n.d(t,"A",(function(){return R})),n.d(t,"B",(function(){return D})),n.d(t,"C",(function(){return x})),n.d(t,"s",(function(){return M}));var r="role",a="title",i="accessKey",o="hidden",s="disabled",c="aria-activedescendant",l="aria-atomic",u="aria-autocomplete",d="aria-controls",p="aria-checked",f="aria-describedby",g="aria-disabled",h="aria-expanded",m="aria-haspopup",b="aria-hidden",y="aria-label",_="aria-labelledby",v="aria-level",S="aria-live",O="aria-modal",C="aria-multiline",E="aria-owns",I="aria-pressed",w="aria-relevant",j="aria-readonly",P="aria-required",T="aria-selected",N="aria-current",A="aria-valuemax",R="aria-valuemin",D="aria-valuenow",x="aria-valuetext",M="aria-orientation"},hIjC:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return s}));var r=n("eXjw");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t){return e&&e.metadata&&e.metadata.dialogs&&t?e.metadata.dialogs[t.toLowerCase()]:null}function i(e,t){const n=a(e,t);return n?n.initialized:r.a.Uninitialized}function o(){return"Dialog"}function s(){return"Dialog"}},hK10:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e,t){if(!e||!e.titles||0===e.titles.length)return null;const n=t?t.toString():"",r=Object.keys(e.titles);for(let t=0;t<r.length;t++){const a=r[t];if(!e.titles[a])continue;const i=e.titles[a];if(i.Name===n)return i}return null}function a(e,t){if(!e)return null;const n=Object.assign({},e);if(e.titles){const a={},i=r(e,t);i&&(a[""]=Object.assign({},i)),n.titles=a}return n}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}))},hO7G:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e.tab="tab-id",e.session="session-id",e.browsingContext="browsing-context-id",e.sidePane="sidePanel"}(r||(r={}))},hVsf:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return d}));var r=n("eXjw"),a=n("fC8v"),i=n("504W"),o=n("8VF0"),s=n("Uv1Y"),c=n("Div0"),l=n("ufH1");function u(e){return{type:"executeOData.getIsActivity",execute:({dispatch:t,getState:n},r)=>new Promise((n,a)=>{r.DataSource.getIsActivityFlags(e).then(e=>{const r=d(e);t(Object(o.b)(r)),n()}).catch(e=>{e=Object(s.c)(e),a(e)})})}}function d(e){if(Object(i.a)(e)||Object(i.a)(e.value)||0===Object.keys(e.value).length)return Object(l.e)("GetIsActivityFlags.SerializeIsActivityFlags",c.a.storage,`Failed to convert entity definitions data response to entity metadata because the '${Object(i.a)(e)||0===Object.keys(e).length?"EntityDefinitions":"EntityDefinitions.value"}' payload is empty or null. Return empty metadata state.`),{};return{entities:e.value.reduce((e,t)=>{const n={Initialized:r.a.Uninitialized,IsActivity:t.IsActivity,ObjectTypeCode:t.ObjectTypeCode,IsEnabledInUnifiedInterface:!!Object(i.a)(t.IsVisibleInMobileClient)||(t.IsVisibleInMobileClient.Value||t.IsVisibleInMobileClient.CanBeChanged),DisplayName:Object(a.b)(!1,!1,t.DisplayName),DisplayCollectionName:Object(a.b)(!1,!1,t.DisplayCollectionName),ActivityTypeMask:t.ActivityTypeMask,EntityLogicalName:t.LogicalName,Id:t.MetadataId};return e[t.LogicalName]=n,e},{})}}},hgKT:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("OwbH");class a extends r.a{constructor(e,t){super([e]),this._inValues=null,this._inValues=t}get_inValues(){return this._inValues}testCondition(e){return this.get_inValues().indexOf(e)>=0}}},hirD:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("5yoC");class a extends r.a{constructor(e,t){super(),this._requests=null,this._settings=null,this._requests=e,this._settings=t}get_name(){return"ExecuteMultiple"}get_xmlNamespace(){return"http://schemas.microsoft.com/xrm/2011/Contracts"}get_requests(){return this._requests}get_settings(){return this._settings}}},hoir:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));function r(e,t=10,n=2500){let r=0,a=0;return()=>{if(clearTimeout(r),a++,a===t)return a=0,void e();r=setTimeout(()=>{a=0},n)}}},"hp2+":function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n("mMyr");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const a={},i=r.createContext(a)},hs84:function(e,t,n){"use strict";n.d(t,"a",(function(){return L}));var r=n("IKHO"),a=n("ufH1"),i=n("umme"),o=n("Uv1Y"),s=n("c7Og"),c=n("a475"),l=n("504W"),u=n("Div0"),d=n("H4dV"),p=n("XvL5"),f=n("rO1J"),g=n("2JG5"),h=n("WRF3"),m=n("GD3x"),b=n("UMB/"),y=n("eruq"),_=n("Jz2d"),v=n("JdSN"),S=n("IdrN"),O=n("xiom"),C=n("T544"),E=n("jZCH"),I=n("WF3G"),w=n("hirD"),j=n("47MF"),P=n("Mr6u"),T=n("QFnk"),N=n("v3UX"),A=n("jxo7"),R=n("wo7m"),D=n("7O3c"),x=n("/d6W"),M=n("EW4s"),F=n("Hswk"),k=n("g03H");class L{constructor(e,t,n){this._serverUri=null,this._proxy=null,this._eventManager=null,this._parentDataSource=null,this._isAvailable=!1,this._isNetworkAvailable=!1,this._isWaitingForNetwork=!1,this.waitingForNetworkPromise=null,this._networkWaitTimeOutCallbackId=0,this._WaitTimeToCheckNetworkStatus=5e3,this._serverUri=e,this._proxy=new _.a(this._serverUri,n,t.get_ApplicationStatusProvider()),d.a.getInstance().get_IsAndroid()?(c.a.get_Instance().get_device().get_DeviceState().apcl("ConnectionAvailable",Object(F.a)(this,this._ConnectivityHandler,"ConnectivityHandler")),window.addEventListener("deviceready",Object(F.a)(this,this._oneTimeDeviceReadyEventListener,"oneTimeDeviceReadyEventListener"),!1)):this._addNetworkEventListeners(),this._eventManager=t.get_EventManager(),this._parentDataSource=t;const r=B();Object(a.e)("CrmServerDataSource:",u.a.crmServerDataSource,"Setting server availability to "+r),this.set_isAvailable(r),this._isWaitingForNetwork=!1,this.waitingForNetworkPromise=new M.a}_addNetworkEventListeners(){window.addEventListener("offline",Object(F.a)(this,this._OfflineEvent,"OfflineEvent"),!1),window.addEventListener("online",Object(F.a)(this,this._OnlineEvent,"OnlineEvent"),!1)}_oneTimeDeviceReadyEventListener(e){this._addNetworkEventListeners(),window.removeEventListener("deviceready",Object(F.a)(this,this._oneTimeDeviceReadyEventListener,"oneTimeDeviceReadyEventListener"),!1)}get_isNetworkAvailable(){return B()}get_isAvailable(){return this._isAvailable&&(this.get_isNetworkAvailable()||this._isWaitingForNetwork)}set_isAvailable(e,t){return this._isAvailable===e&&this._isNetworkAvailable===e||(d.a.getInstance().get_PALEnabled()&&c.a.get_Instance().get_application().get_IsAvailable()&&!Object(l.a)(c.a.get_Instance().get_application().get_applicationState().get_nativeFCBContext())&&"MobileClientOfflineWebResources"in c.a.get_Instance().get_application().get_applicationState().get_nativeFCBContext()&&c.a.get_Instance().get_application().get_applicationState().get_nativeFCBContext().MobileClientOfflineWebResources&&c.a.get_Instance().get_application().setBoolValue("IsClientOffline",!e),Object(a.e)("IsAvailable:",u.a.crmServerDataSource,"Setting server availability to "+e+":Network status = "+this.get_isNetworkAvailable()+": Navigator value = "+window.navigator.onLine+": previous network available value = "+this._isNetworkAvailable+":passed network status value = "+t),this._isAvailable=e,this._isNetworkAvailable=this.get_isNetworkAvailable(),Object(k.l)(t)||(this._isNetworkAvailable=t),this._eventManager.OnServerAvailabilityChange(this._isAvailable,this._isNetworkAvailable)),e}get_isWaitingForNetwork(){return this._isWaitingForNetwork}get_waitingForNetworkPromise(){return this.waitingForNetworkPromise}set_settings(e){return Object(l.a)(this._proxy)||this._proxy.set_Settings(e),e}get_proxy(){return this._proxy}setWebAPIService(e){const t=e;t.parentDataSource=this._parentDataSource,t.noSerializerFallback=this._proxy,this._proxy=e}get_parentDataSource(){return this._parentDataSource}initialize(e){const t=new M.a;return t.resolve(),t}getClientMetadata(e,t,n){const r=new M.a;return this.get_proxy().GetClientMetadata(e,n).then(e=>{r.resolve(e)},this._OperationFailure(r)),r}syncClientMetadata(e){const t=new M.a;return this.get_proxy().SyncClientMetadata(e).then(e=>{t.resolve(e)},this._OperationFailure(t)),t}getRecentItems(e,t,n,r,a,o,s){const c=new M.a;return this.get_proxy().GetRecentItems(e,t,n,r,a,o,s).then(e=>{c.resolve(e)},e=>{c.reject(i.a.FromMessage(e.get_message()))}),c}UpdateRecentItems(e,t){const n=new M.a;return this.get_proxy().UpdateRecentItems(e,t).then(e=>{n.resolve(e)},e=>{n.reject(i.a.FromMessage(e.get_message()))}),n}getIsActivityFlags(){const e=new M.a;return this.get_proxy().GetIsActivityFlags().then(t=>{e.resolve(t)},t=>{e.reject(i.a.FromMessage(t.get_message()))}),e}async retrieveExtendedUserContext(){const e=await this.get_proxy().RetrieveExtendedUserContext();if(!e.get_success())throw Object(a.b)("retrieveExtendedUserContext:",u.a.crmServerDataSource,"Error Message:"+e.get_errorMessage()),o.a.fromLegacyErrorStatus(i.a.fromErrorCode(e.get_errorCode()));return e.get_userContext()}retrieveUserContext(e,t){const n=new M.a;return this.get_proxy().RetrieveUserContext(e,t).then(e=>{e.get_success()?n.resolve(e.get_userContext()):(Object(a.b)("retrieveUserContext:",u.a.crmServerDataSource,"Error Message:"+e.get_errorMessage()),n.reject(i.a.fromErrorCode(e.get_errorCode())))},this._OperationFailure(n)),n}create(e,t,n){const r=new M.a;return this.get_proxy().Create(e,t,n).then(t=>{r.resolve(new h.a(e.get_identifier().LogicalName,t.get_id()))},this._OperationFailure(r)),r}retrieveRelatedEntities(e,t,n,r,a,o,c,u){const d=new M.a;let f=new Array(0);if(this.get_parentDataSource().get_UserContext().get_organizationSettings().get_isMocaOfflineFeatureEnabled()&&!Object(l.a)(r)){const e=new DOMParser;for(const t of r){const n=e.parseFromString(t.get_value(),"text/xml"),r=n.getElementsByTagName("link-entity")[0];Object(l.a)(r)||Object(l.a)(r.attributes.getNamedItem("mobileClientOffline"))||"true"!==r.attributes.getNamedItem("mobileClientOffline").nodeValue||n.getElementsByTagName("entity")[0].removeChild(r),f.push(new s.a(t.get_key(),Object(y.a)(n).get_outerXml()))}}else f=r;if(g.a.hasAccessRights(e.LogicalName,this.get_parentDataSource().get_MetadataCache())){const n=this.get_parentDataSource().get_MetadataCache().getEntityMetadata(e.LogicalName);if(Object(l.a)(n))d.reject(i.a.FromMessage("Retrieve - Entity metadata not found."));else if(n.get_isChildEntity()){if(t instanceof p.a){const e=t.get_Columns();e.indexOf(n.get_parentEntityReferencingAttribute())<0&&(e.push(n.get_parentEntityReferencingAttribute()),t=new p.a(e))}this.get_proxy().Execute(new N.a(e,t,f,!1,null,u),o).then(e=>{const r=e.get_entity(),s=r.getValue(n.get_parentEntityReferencingAttribute()),c=[new T.a(s,new h.a("systemuser",this.get_parentDataSource().get_UserContext().get_UserId()))];this._CheckHasAllSecuredAttributePrivileges(n,t,o).then(e=>{e||c.push(new P.a(this._GetUserSharedAttributePermissionsQuery(s))),this.get_proxy().Execute(new w.a(c,new m.a(!1,!0)),o).then(e=>{const t=e;if(t.get_isFaulted()){const e=t.get_responses()[0];Object(l.a)(e)||Object(l.a)(e.get_fault())?d.reject(i.a.FromMessage("Retrieve - ExecuteMultiple faulted")):d.reject(i.a.fromErrorCode(e.get_fault().get_errorCode()))}else{let e=null,n=null;for(const r of t.get_responses())r.get_response()instanceof R.a?e=r.get_response():r.get_response()instanceof A.a&&(n=r.get_response());r.set_accessRights(e.get_accessRights()),r.set_clientRetrieveOptions(a),Object(l.a)(n)||r.set_userSharedAttributePrivileges(this._GetUserSharedAttributePermissionsFromCollection(n.get_entityCollection())),d.resolve(r)}},this._OperationFailure(d))})},this._OperationFailure(d))}else{const r=[new N.a(e,t,f,!1,null,u),new T.a(e,new h.a("systemuser",this.get_parentDataSource().get_UserContext().get_UserId()))];n.getEntityCanBeUsedInBusinessProcess()&&c&&r.push(c),this._CheckHasAllSecuredAttributePrivileges(n,t,o).then(t=>{t||r.push(new P.a(this._GetUserSharedAttributePermissionsQuery(e))),this.get_proxy().Execute(new w.a(r,new m.a(!1,!0)),o).then(e=>{const t=e;if(t.get_isFaulted()){const e=t.get_responses()[0];Object(l.a)(e)||Object(l.a)(e.get_fault())?d.reject(i.a.FromMessage("Retrieve - ExecuteMultiple faulted")):d.reject(i.a.fromErrorCode(e.get_fault().get_errorCode()))}else{let e=null,n=null,r=null,i=null;for(const a of t.get_responses())a.get_response()instanceof R.a?e=a.get_response():a.get_response()instanceof x.a?n=a.get_response():a.get_response()instanceof D.a?r=a.get_response():a.get_response()instanceof A.a&&(i=a.get_response());const o=n.get_entity();o.set_accessRights(e.get_accessRights()),o.set_clientRetrieveOptions(a),Object(l.a)(r)||(o.set_entityRecordForProcess(r.get_entity()),Object(l.a)(o.get_entityRecordForProcess())||(o.get_entityRecordForProcess().mergeEntityRecordFields(o),o.mergeEntityRecordFields(o.get_entityRecordForProcess())),Object(l.a)(r.get_globalNavigationData())||Object(l.a)(r.get_globalNavigationData().fields)||(o.set_globalNavigationData(r.get_globalNavigationData()),this.get_isAvailable()&&(o.get_globalNavigationData().fields.bpfDefinitionVersionNumber=r.get_bpfDefinitionVersionNumber()))),Object(l.a)(i)||o.set_userSharedAttributePrivileges(this._GetUserSharedAttributePermissionsFromCollection(i.get_entityCollection())),d.resolve(o)}},this._OperationFailure(d))})}}else this._RetrieveRecordWithProcessData(e,c,t,f,a,u,o,d);return d}retrieveMultiple(e,t,n){const r=new M.a;return this.get_proxy().RetrieveMultiple(e,n).then(e=>{e.get_entityCollection().set_clientRetrieveOptions(t),r.resolve(e.get_entityCollection())},this._OperationFailure(r)),r}retrieveEntitiesForAggregateQuery(e,t,n){const r=new M.a,a={},o=Object.keys(t);for(let e=0;e<o.length;e++){const n={key:o[e],value:t[o[e]]};a[n.key]=n.value instanceof I.a?n.value.get_FetchXml():n.value.toString()}return this.get_proxy().Execute(new j.a(e.get_FetchXml(),a),n).then(n=>{if(n){const a=n;a.get_entityCollection().set_query(new O.a(e,t)),r.resolve(a.get_entityCollection())}else r.reject(i.a.FromMessage("Response from server is null"))},this._OperationFailure(r)),r}update(e,t,n,r){const a=new M.a;return this.get_proxy().Update(t,n,r).then(t=>{a.resolve(e)},this._OperationFailure(a)),a}Delete(e,t){const n=new M.a;return this.get_proxy().DeleteEntity(e,t).then(t=>{n.resolve(e)},this._OperationFailure(n)),n}execute(e,t){const n=new M.a;return this.get_proxy().Execute(e,t).then(e=>{n.resolve(e)},this._OperationFailure(n)),n}executeOData(e,t,n,r=[],a={}){const i=new M.a;return this.get_proxy().ExecuteOData(e,t,a).then(e=>{i.resolve(e)},this._OperationFailure(i)),i}retrieveEntityMetadata(e,t){const n=new M.a;if(Object(r.b)()&&!Object(l.a)(Mscrm.MailAppInlineData.entityMetadata)){const t=Mscrm.MailAppInlineData.entityMetadata.Metadata;if(e in t)return n.resolve(new S.a(Object(y.a)(t[e])).get_entityMetadataCollection().get_item(0)),delete t[e],n}return this.get_proxy().retrieveEntityMetadata(e,this.get_parentDataSource().get_UserContext().get_UserSettings().get_languageId(),t).then(e=>{e.get_entityMetadataCollection().get_count()>0?n.resolve(e.get_entityMetadataCollection().get_item(0)):n.reject(i.a.fromErrorCode(-2147220969))},this._OperationFailure(n)),n}retrieveMultipleAttributeMetadata(e,t){const n=new M.a;return this.get_proxy().RetrieveMultipleAttributeMetadata(e,this.get_parentDataSource().get_UserContext().get_UserSettings().get_languageId(),t).then(t=>{if(t&&t.get_AttributeMetadata()&&t.get_AttributeMetadata().length>0){const e=t.get_AttributeMetadata();n.resolve(e)}else n.reject(i.a.FromMessage("Entity {0} has no AttributeMetadata of {1}",e.get_EntityLogicalName(),e.get_AttributeNames()))},this._OperationFailure(n)),n}ping(){const e=new M.a;return this.get_isNetworkAvailable()?this.get_proxy().WhoAmI().then(()=>{this.set_isAvailable(!0),Object(a.e)("Ping:",u.a.crmServerDataSource,"Setting server availability to "+this.get_isAvailable()+". Ping server was successfull."),e.resolve(!0)},t=>{if(U(t))Object(a.e)("Ping:",u.a.crmServerDataSource,"Setting server availability to Unchanged. Ping server failed."),e.reject(L.GetErrorStatusFromErrorResponse(t));else{const n=Object(l.a)(t.get_request())?-1:t.get_request().status;this.set_isAvailable(!0),Object(a.e)("Ping:",u.a.crmServerDataSource,"Setting server availability to "+this.get_isAvailable()+". Ping server failed but this is not an offline error. IsErrorInOffline = "+t.get_isErrorInOffline()+", httpStatus = "+n),e.resolve(!0)}}):(Object(a.e)("Ping:",u.a.crmServerDataSource,"Setting server availability to Unchanged. Network is not available."),e.resolve(!1)),e}changeProcessAndStage(e,t,n,r,a,o){const s=new M.a;return this.get_proxy().changeProcessAndStage(e,t,n,r,a,o).then(e=>{e.get_success()?s.resolve(e.get_response()):s.reject(i.a.FromMessage(e.get_errorMessage()))},this._OperationFailure(s)),s}createNavigationEntity(e,t,n,r,a){const o=new M.a;return this.get_proxy().createNavigationEntity(e,t,n,r,a).then(e=>{e.get_success()?o.resolve(e.get_response()):o.reject(i.a.FromMessage(e.get_errorMessage()))},this._OperationFailure(o)),o}retrieveNavigationEntities(e,t,n,r,a){const o=new M.a;return Object(l.b)(t)||Object(l.b)(n)?o.resolve():(this.get_proxy().retrieveNavigationEntities(e,t,n,r,a).then(e=>{e.get_success()?o.resolve(e.get_response()):o.reject(i.a.FromMessage(e.get_errorMessage()))},this._OperationFailure(o)),o)}retrieveUserLocalFacets(e,t){const n=new M.a;return this.get_proxy().RetrieveUserLocalFacets(e,t).then(e=>{e&&n.resolve(e)},this._OperationFailure(n)),n}_OperationFailure(e){return t=>{try{const n=this.get_isAvailable();this._HandleOfflineError(t),n!==this.get_isAvailable()&&Object(a.e)("OperationFailure:",u.a.crmServerDataSource,"Setting server availability to "+this.get_isAvailable()+". Previous server availability was "+n);const r=L.GetErrorStatusFromErrorResponse(t);this.get_isAvailable()||(r.set_ErrorCode(-2147093999),Object(l.b)(r.get_Message())&&r.set_Message(i.a.fromErrorCode(r.get_ErrorCode()).get_Message())),e.reject(r)}catch(t){e.reject(t)}}}_HandleOfflineError(e){if(this._isAvailable&&this.get_isNetworkAvailable()&&U(e)){const t=Object(l.a)(e.get_request())?-1:e.get_request().status;this.set_isAvailable(!1),Object(a.e)("HandleOfflineError:",u.a.crmServerDataSource,"Setting server availability to "+this.get_isAvailable()+". IsErrorOffline = "+e.get_isErrorInOffline()+", httpStatus= "+t)}}_OfflineEvent(e){this.get_isNetworkAvailable()||this._isWaitingForNetwork?this.get_isNetworkAvailable()?Object(a.e)("OfflineEvent:",u.a.crmServerDataSource,"Received offline event when network is available, so not setting the network to offline."):this._isWaitingForNetwork?Object(a.e)("OfflineEvent:",u.a.crmServerDataSource,"Received another offline event while waiting for network to comeback, so not setting the network to offline."):(Object(a.e)("OfflineEvent:",u.a.crmServerDataSource,"Setting server availability to false.: isWaitingForNetwork = "+this._isWaitingForNetwork+":window.navigator.onLine = "+window.navigator.onLine+":this.get_isNetworkAvailable() = "+this.get_isNetworkAvailable()),this.set_isAvailable(!1,!1)):(this._isWaitingForNetwork=!0,this.waitingForNetworkPromise=new M.a,Object(a.e)("OfflineEvent:",u.a.crmServerDataSource,"Waiting for network to comeback with SetTimeout of 5 seconds"),this._networkWaitTimeOutCallbackId=window.setTimeout(()=>{this.get_isNetworkAvailable()?Object(a.e)("OfflineEvent:",u.a.crmServerDataSource,String.format("{0} unchanged after waiting for {1} seconds. Earlier Server availability status = {2}.","Setting server availability to ",this._WaitTimeToCheckNetworkStatus,this.get_isAvailable())):(this.set_isAvailable(!1,!1),Object(a.e)("OfflineEvent:",u.a.crmServerDataSource,"Setting server availability to "+this.get_isAvailable())),this._isWaitingForNetwork=!1,this.waitingForNetworkPromise.resolve()},this._WaitTimeToCheckNetworkStatus))}_OnlineEvent(e){Object(a.e)("OnlineEvent:",u.a.crmServerDataSource,"Setting server availability to . IsNetworkAvailable = "+this.get_isNetworkAvailable()),this._isWaitingForNetwork&&(this._isWaitingForNetwork=!1,this.waitingForNetworkPromise.resolve(),window.clearTimeout(this._networkWaitTimeOutCallbackId)),this._eventManager.OnServerAvailabilityChange(this._isAvailable,!0)}_SetNativeConnectivityOffline(){d.a.getInstance().get_PALEnabled()&&c.a.get_Instance().get_application().get_IsAvailable()&&!Object(l.a)(c.a.get_Instance().get_application().get_applicationState().get_nativeFCBContext())&&"MobileClientOfflineWebResources"in c.a.get_Instance().get_application().get_applicationState().get_nativeFCBContext()&&c.a.get_Instance().get_application().get_applicationState().get_nativeFCBContext().MobileClientOfflineWebResources&&c.a.get_Instance().get_application().setBoolValue("IsClientOffline",!0),this._isAvailable=this._isNetworkAvailable=c.a.get_Instance().get_device().get_DeviceState().get_connectionAvailable(),Object(a.e)("_SetNativeConnectivityOffline:",u.a.crmServerDataSource,"Setting server availability to "+this._isAvailable+". NetWork Status = "+this._isNetworkAvailable),this._eventManager.OnServerAvailabilityChange(this._isAvailable,this._isNetworkAvailable)}_ConnectivityHandler(){if(c.a.get_Instance().get_device().get_DeviceState().get_connectionAvailable()||this._isWaitingForNetwork)Object(a.e)("ConnectivityHandler:",u.a.crmServerDataSource,"Setting server availability to Unchanged. ConnectionAvailable = "+c.a.get_Instance().get_device().get_DeviceState().get_connectionAvailable()),this._isWaitingForNetwork&&(this._isWaitingForNetwork=!1,this.waitingForNetworkPromise.resolve(),window.clearTimeout(this._networkWaitTimeOutCallbackId)),this._eventManager.OnServerAvailabilityChange(this._isAvailable,!0);else{const e=c.a.get_Instance().get_device().get_DeviceState().get_connectionAvailable();this._isAvailable===e&&this._isNetworkAvailable===e||(this._isWaitingForNetwork=!0,this.waitingForNetworkPromise=new M.a,Object(a.e)("ConnectivityHandler:",u.a.crmServerDataSource,"Waiting for network to comeback with SetTimeout of 5 seconds"),this._networkWaitTimeOutCallbackId=window.setTimeout(()=>{c.a.get_Instance().get_device().get_DeviceState().get_connectionAvailable()?Object(a.e)("ConnectivityHandler:",u.a.crmServerDataSource,"Setting server availability to Unchanged(After waiting for few seconds). ConnectionAvailable = "+c.a.get_Instance().get_device().get_DeviceState().get_connectionAvailable()):(this._SetNativeConnectivityOffline(),Object(a.e)("ConnectivityHandler:",u.a.crmServerDataSource,"Setting server availability to "+this._isAvailable+". ConnectionAvailable = "+c.a.get_Instance().get_device().get_DeviceState().get_connectionAvailable())),this._isWaitingForNetwork=!1,this.waitingForNetworkPromise.resolve()},this._WaitTimeToCheckNetworkStatus))}}_GetUserSharedAttributePermissionsQuery(e){return'<fetch distinct="false" no-lock="false" mapping="logical"><entity name="principalobjectattributeaccess"><attribute name="attributeid" /><attribute name="readaccess" /><attribute name="updateaccess" /><filter type="and"><condition attribute="objectid" operator="eq" value="'+e.Id+'" /><condition attribute="principalid" operator="eq-useroruserteams" /></filter></entity></fetch>'}_GetUserSharedAttributePermissionsFromCollection(e){const t={};for(let n=0;n<e.get_count();n++){const r=e.get_item(n).getValue("attributeid"),a=1===e.get_item(n).getValue("readaccess").get_value(),i=1===e.get_item(n).getValue("updateaccess").get_value();if(r.toString()in t&&(a||i)){const e=new f.a(r,!1,a||t[r.toString()].get_CanRead(),i||t[r.toString()].get_CanUpdate());t[r.toString()]=e}else r.toString()in t||(t[r.toString()]=new f.a(r,!1,a,i))}return t}_CheckHasAllSecuredAttributePrivileges(e,t,n){const r=new M.a;if(e.get_hasSecuredAttributes()){let a=null;t instanceof p.a&&(a=t.get_Columns()),E.a.get_DefaultInstance().retrieveMultipleAttributeMetadata(new C.a(e.get_logicalName(),a),n).then(e=>{let t=!0;for(let n=0;n<e.length;n++)if(e[n].get_isSecured()){const r=E.a.get_DefaultInstance().get_UserContext().get_attributePrivileges()[e[n].get_id().toString()];if(Object(l.a)(r)||!r.get_CanRead()||!r.get_CanUpdate()){t=!1;break}}r.resolve(t)},e=>{r.resolve(!1)})}else r.resolve(!0);return r}_RetrieveRecordWithProcessData(e,t,n,r,a,o,s,c){const u=this.get_parentDataSource().get_MetadataCache().getEntityMetadata(e.LogicalName);if(Object(l.a)(u)||!u.get_isBusinessProcessEnabled()||Object(l.a)(t))this.get_proxy().Execute(new N.a(e,n,r,!1,null,o),s).then(e=>{const t=e;Object(l.a)(t.get_entity())?c.reject(i.a.FromMessage("Entity record not found.")):(t.get_entity().set_clientRetrieveOptions(a),c.resolve(t.get_entity()))},this._OperationFailure(c));else{const u=[new N.a(e,n,r,!1,null,o),t];this.get_proxy().Execute(new w.a(u,new m.a(!1,!0)),s).then(e=>{const t=e;if(t.get_isFaulted()){const e=t.get_responses()[0];Object(l.a)(e)||Object(l.a)(e.get_fault())?c.reject(i.a.FromMessage("Retrieve - ExecuteMultiple faulted")):c.reject(i.a.fromErrorCode(e.get_fault().get_errorCode()))}else{let e=null,n=null;for(const r of t.get_responses())r.get_response()instanceof x.a?e=r.get_response():r.get_response()instanceof D.a&&(n=r.get_response());const r=e.get_entity();r.set_clientRetrieveOptions(a),r.set_entityRecordForProcess(n.get_entity()),Object(l.a)(r.get_entityRecordForProcess())||(r.get_entityRecordForProcess().mergeEntityRecordFields(r),r.mergeEntityRecordFields(r.get_entityRecordForProcess())),r.set_globalNavigationData(n.get_globalNavigationData()),r.get_globalNavigationData()&&(r.fields[b.a]=r.get_globalNavigationData().fields[b.a].Id,r.fields[b.c]=r.get_globalNavigationData().fields[b.b],r.fields[b.d]=r.get_globalNavigationData().fields[b.d]),c.resolve(r)}},this._OperationFailure(c))}}static GetErrorStatusFromErrorResponse(e){const t=function(e){if(e instanceof i.a)return e;if(!(e instanceof v.a))return i.a.fromGenericError(e);const t=e;return i.a.FromMessage(t.get_message())}(e);return e instanceof v.a&&(Object(l.a)(e.get_organizationServiceFault())||(t.set_ErrorCode(e.get_organizationServiceFault().get_errorCode()),t.set_ErrorFault(e.get_organizationServiceFault())),e.get_request()&&401===e.get_request().status&&t.set_ErrorCode(-2147093995),!t.get_ErrorCode()&&e.get_request()&&(t.set_ErrorCode(function(e,t){if(!t.get_ErrorCode()){let t=0;return t=400===e.get_request().status?-2147015424:401===e.get_request().status?-2147015423:403===e.get_request().status?-2147015422:404===e.get_request().status?-2147015421:429===e.get_request().status?-2147015420:500===e.get_request().status?-2147015419:501===e.get_request().status?-2147015418:502===e.get_request().status?-2147015417:503===e.get_request().status?-2147015416:504===e.get_request().status?-2147015415:-2147015414,t}return t.get_ErrorCode()}(e,t)),Object(a.e)("GetErrorStatusFromErrorResponse:",u.a.crmServerDataSource,"HTTP Status : "+e.get_request().status+": Map CrmErrorCode : 0 : to ErrorCode: "+t.get_ErrorCode())),Object(l.a)(e.get_request())||Object(l.a)(e.get_request().status)||t.set_HttpStatusCode(e.get_request().status),Object(l.a)(e.get_clientRequestId())||t.set_ClientRequestId(e.get_clientRequestId()),Object(l.a)(e.get_serverResponseId())||t.set_ServerResponseId(e.get_serverResponseId()),Object(l.a)(e.get_retryAfter())||t.set_RetryAfter(e.get_retryAfter()),Object(l.a)(e.get_date())||t.set_Date(e.get_date()),!Object(l.a)(e.get_contentId())&&e.get_contentId()>0?t.set_FaultedRequestIndex(e.get_contentId()-1):t.set_FaultedRequestIndex(-1),e.get_isRequestTooLong()&&t.set_isRequestTooLong(!0)),t}}function B(){let e=!1;return e=window.navigator.onLine,d.a.getInstance().get_IsAndroid()&&(e=c.a.get_Instance().get_device().get_DeviceState().get_connectionAvailable()),e}function U(e){return e instanceof v.a&&(!!e.get_isErrorInOffline()||!Object(l.a)(e.get_request())&&(!e.get_request().status||502===e.get_request().status))}},htFu:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return p})),n.d(t,"d",(function(){return f}));var r=n("Uv1Y"),a=n("eXjw"),i=n("K7RF"),o=n("Fn5S"),s=n("/oKV"),c=n("iJGp");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const l="taskBasedFlowGlobalMenu.retrieve",u="taskBasedFlowGlobalMenu.display",d="TaskBasedFlow.RetrieveTaskBasedFlowGlobalMenu";function p(){return{type:"taskBasedFlowGlobalMenu.retrieve.async",execute({dispatch:e,getState:t},n){n.DataSource;const u=t();let p=s.a.LocalAndRemote;const f=Object(o.c)(u);if(f===a.a.Initialized&&Object(i.e)(u,Object(o.a)(u).overallVersionNumber)&&(p=s.a.Remote),f===a.a.Uninitialized||p===s.a.Remote)return e(function(){const e={initialized:a.a.Initializing};return{type:l,payload:{taskBasedFlowGlobalMenu:e}}}()),e(function(e,t){return{type:"taskBasedFlowGlobalMenu.retrieve.async",execute:({dispatch:e,getState:n},a)=>e(Object(i.b)("taskbasedflowglobalmenu",null,null,null,!0,c.a.OnDemandWithContext,null,null,[],null,t)).catch(r.b)}}(0,p)).then(t=>{t?n.EventManager.ReportComponentSuccess(d):n.EventManager.ReportComponentFailure(d,Error("Global menu metadata descriptor is null")),e(function(e){return{type:l,payload:e}}(t))});return Object(o.a)(u)?n.EventManager.ReportComponentSuccess(d):n.EventManager.ReportComponentFailure(d,Error("Task based flow global menu not found in state")),Promise.resolve()}}}function f(e){return{type:u,payload:{taskBasedFlowGlobalMenu:{display:e}}}}},hvSt:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.Active=1]="Active",e[e.Finished=2]="Finished",e[e.Aborted=3]="Aborted"}(r||(r={}))},i1f0:function(e,t,n){"use strict";n.d(t,"c",(function(){return Le})),n.d(t,"ad",(function(){return la})),n.d(t,"Tb",(function(){return ua})),n.d(t,"a",(function(){return Be})),n.d(t,"e",(function(){return Ve})),n.d(t,"g",(function(){return Ue})),n.d(t,"gc",(function(){return En})),n.d(t,"ib",(function(){return Ge})),n.d(t,"bb",(function(){return tt})),n.d(t,"Oc",(function(){return nt})),n.d(t,"Pc",(function(){return rt})),n.d(t,"r",(function(){return st})),n.d(t,"yc",(function(){return ct})),n.d(t,"C",(function(){return An})),n.d(t,"Mc",(function(){return ht})),n.d(t,"H",(function(){return Kt})),n.d(t,"kb",(function(){return Qt})),n.d(t,"Tc",(function(){return mt})),n.d(t,"Sc",(function(){return mr})),n.d(t,"Bc",(function(){return Tt})),n.d(t,"zc",(function(){return Nt})),n.d(t,"u",(function(){return Zt})),n.d(t,"Vc",(function(){return At})),n.d(t,"I",(function(){return Rt})),n.d(t,"y",(function(){return qt})),n.d(t,"Ec",(function(){return tn})),n.d(t,"o",(function(){return Ot})),n.d(t,"qd",(function(){return Pt})),n.d(t,"Kb",(function(){return yt})),n.d(t,"X",(function(){return _t})),n.d(t,"vc",(function(){return St})),n.d(t,"Qc",(function(){return ft})),n.d(t,"Rc",(function(){return gt})),n.d(t,"t",(function(){return mn})),n.d(t,"M",(function(){return On})),n.d(t,"K",(function(){return Cn})),n.d(t,"ud",(function(){return lt})),n.d(t,"yb",(function(){return ut})),n.d(t,"td",(function(){return dt})),n.d(t,"cb",(function(){return pt})),n.d(t,"qc",(function(){return Ye})),n.d(t,"cd",(function(){return $e})),n.d(t,"rc",(function(){return Sn})),n.d(t,"xc",(function(){return In})),n.d(t,"Ic",(function(){return wn})),n.d(t,"h",(function(){return sn})),n.d(t,"Mb",(function(){return cn})),n.d(t,"R",(function(){return jn})),n.d(t,"od",(function(){return Pn})),n.d(t,"pd",(function(){return Tn})),n.d(t,"j",(function(){return Nn})),n.d(t,"xb",(function(){return Rn})),n.d(t,"Cb",(function(){return Sr})),n.d(t,"bc",(function(){return Or})),n.d(t,"d",(function(){return qe})),n.d(t,"v",(function(){return xn})),n.d(t,"x",(function(){return Mn})),n.d(t,"w",(function(){return Dn})),n.d(t,"b",(function(){return We})),n.d(t,"Bb",(function(){return Bn})),n.d(t,"Xb",(function(){return qn})),n.d(t,"Yb",(function(){return Hn})),n.d(t,"ac",(function(){return Gn})),n.d(t,"Zb",(function(){return Wn})),n.d(t,"Jc",(function(){return Kn})),n.d(t,"sc",(function(){return Qn})),n.d(t,"pb",(function(){return $n})),n.d(t,"mb",(function(){return Zn})),n.d(t,"E",(function(){return gr})),n.d(t,"Db",(function(){return un})),n.d(t,"A",(function(){return dn})),n.d(t,"Ac",(function(){return hr})),n.d(t,"Ab",(function(){return br})),n.d(t,"m",(function(){return yr})),n.d(t,"Rb",(function(){return Yn})),n.d(t,"Sb",(function(){return ot})),n.d(t,"nb",(function(){return lr})),n.d(t,"jd",(function(){return dr})),n.d(t,"gd",(function(){return Je})),n.d(t,"ub",(function(){return pr})),n.d(t,"D",(function(){return Ir})),n.d(t,"Vb",(function(){return jr})),n.d(t,"Wb",(function(){return Pr})),n.d(t,"jb",(function(){return _r})),n.d(t,"fb",(function(){return Un})),n.d(t,"db",(function(){return Vn})),n.d(t,"Xc",(function(){return Tr})),n.d(t,"P",(function(){return on})),n.d(t,"hc",(function(){return Dr})),n.d(t,"Wc",(function(){return Nr})),n.d(t,"Zc",(function(){return Ar})),n.d(t,"fc",(function(){return Mr})),n.d(t,"tb",(function(){return Fr})),n.d(t,"mc",(function(){return kr})),n.d(t,"Kc",(function(){return fr})),n.d(t,"pc",(function(){return Lr})),n.d(t,"lc",(function(){return Xt})),n.d(t,"kc",(function(){return Cr})),n.d(t,"tc",(function(){return Xn})),n.d(t,"U",(function(){return Vr})),n.d(t,"V",(function(){return zr})),n.d(t,"Uc",(function(){return Hr})),n.d(t,"N",(function(){return vn})),n.d(t,"Y",(function(){return vr})),n.d(t,"k",(function(){return bn})),n.d(t,"cc",(function(){return cr})),n.d(t,"wc",(function(){return vt})),n.d(t,"Dc",(function(){return an})),n.d(t,"Eb",(function(){return ln})),n.d(t,"Cc",(function(){return nn})),n.d(t,"ic",(function(){return gn})),n.d(t,"jc",(function(){return hn})),n.d(t,"Ub",(function(){return Ze})),n.d(t,"Pb",(function(){return et})),n.d(t,"Fb",(function(){return pn})),n.d(t,"Lc",(function(){return Ke})),n.d(t,"B",(function(){return Er})),n.d(t,"wb",(function(){return nr})),n.d(t,"vb",(function(){return rr})),n.d(t,"Fc",(function(){return ar})),n.d(t,"zb",(function(){return ir})),n.d(t,"Z",(function(){return or})),n.d(t,"rd",(function(){return Vt})),n.d(t,"ed",(function(){return Wr})),n.d(t,"wd",(function(){return bt})),n.d(t,"O",(function(){return yn})),n.d(t,"F",(function(){return Ht})),n.d(t,"G",(function(){return Wt})),n.d(t,"ab",(function(){return Yt})),n.d(t,"gb",(function(){return Gr})),n.d(t,"i",(function(){return Qr})),n.d(t,"nc",(function(){return ta})),n.d(t,"Gb",(function(){return er})),n.d(t,"lb",(function(){return tr})),n.d(t,"hb",(function(){return Yr})),n.d(t,"W",(function(){return Jr})),n.d(t,"Nc",(function(){return at})),n.d(t,"id",(function(){return $r})),n.d(t,"Q",(function(){return Zr})),n.d(t,"dd",(function(){return ea})),n.d(t,"S",(function(){return na})),n.d(t,"z",(function(){return Gt})),n.d(t,"q",(function(){return Ut})),n.d(t,"Ob",(function(){return xt})),n.d(t,"kd",(function(){return Dt})),n.d(t,"hd",(function(){return Jt})),n.d(t,"Hb",(function(){return Mt})),n.d(t,"Qb",(function(){return kt})),n.d(t,"Jb",(function(){return Lt})),n.d(t,"L",(function(){return ra})),n.d(t,"Ib",(function(){return Bt})),n.d(t,"sd",(function(){return aa})),n.d(t,"Nb",(function(){return ca})),n.d(t,"vd",(function(){return ia})),n.d(t,"ob",(function(){return ur})),n.d(t,"uc",(function(){return Jn})),n.d(t,"Yc",(function(){return xr})),n.d(t,"fd",(function(){return Xr})),n.d(t,"eb",(function(){return zn})),n.d(t,"oc",(function(){return Ur})),n.d(t,"ec",(function(){return oa})),n.d(t,"dc",(function(){return sa})),n.d(t,"n",(function(){return da})),n.d(t,"md",(function(){return Fn})),n.d(t,"f",(function(){return ze})),n.d(t,"Hc",(function(){return Br})),n.d(t,"Lb",(function(){return rn})),n.d(t,"T",(function(){return Ft})),n.d(t,"qb",(function(){return en})),n.d(t,"s",(function(){return fa})),n.d(t,"p",(function(){return ga})),n.d(t,"l",(function(){return pa})),n.d(t,"ld",(function(){return $t})),n.d(t,"nd",(function(){return Qe})),n.d(t,"Gc",(function(){return ha})),n.d(t,"sb",(function(){return Et})),n.d(t,"J",(function(){return jt})),n.d(t,"rb",(function(){return wt})),n.d(t,"bd",(function(){return fn}));var r,a=n("SAYH"),i=n("2cSh"),o=n("arV0"),s=n("y60j"),c=n("LbMF"),l=n("odYE"),u=n("bT7G"),d=n("WPtp"),p=n("5Oca"),f=n("iZ7K"),g=n("BvQu"),h=n("IqkD");!function(e){e[e.Active=0]="Active",e[e.Inactive=1]="Inactive"}(r||(r={}));var m=n("8nT0"),b=n("NjDY"),y=n("uNu9"),_=n("jRy5"),v=n("+nNZ"),S=n("dHD5"),O=n("eXjw"),C=n("r/9v"),E=n("Xd5/"),I=n("3hnk"),w=n("JP46"),j=n("sw/s"),P=n("2YQW"),T=n("P6DH"),N=n("YxC/"),A=n("X3qb"),R=n("3tOH"),D=n("504W"),x=n("g2Nw"),M=n("Z/4N"),F=n("9fGf"),k=n("izYK"),L=n("WIoD"),B=n("g03H"),U=n("VqBP"),V=n("JOgp"),z=n("3/02"),q=n("Lyxw"),H=n("hK10"),W=n("cfbi"),G=n("dUiZ"),K=n("A09F"),Q=n("4leG"),X=n("eOoD"),Y=n("GYEz"),J=n("EBJu"),$=n("69Qu"),Z=n("sZ+8"),ee=n("iF9X"),te=n("unFF"),ne=n("PidC"),re=n("qFOq"),ae=n("0cBP"),ie=n("D9jM"),oe=n("1fn7"),se=n("Y2Yg"),ce=n("qLnS"),le=n("0kGT"),ue=n("GL3b"),de=n("+pAH"),pe=n("9wSR"),fe=n("/A0C"),ge=n("O7zD"),he=n("zmL5"),me=n("jq7Z"),be=n("CYtR"),ye=n("RVeV"),_e=n("xHmU"),ve=n("+zjj"),Se=n("64CY"),Oe=n("hAdb"),Ce=n("fh2P"),Ee=n("37s6"),Ie=n("dJ44"),we=n("pF61"),je=n("oT5e"),Pe=n("zGWw"),Te=n("mL5Q"),Ne=n("f/sd"),Ae=n("wL2W"),Re=n("Gi6V"),De=n("BFlg"),xe=n("uhZ3"),Me=n("nJrx");var Fe=n("dpM5"),ke=n("nC8a");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Le="Forms.EditForm",Be="activitypointer",Ue="regardingobjectid",Ve="QuickForms",ze="ref_pan",qe="notificationWrapper",He=[L.c,L.h],We={Enabled_ContextTokenIsNull:{reason:"Control_Enabled_ContextTokenIsNull",disabled:!1},Enabled_GridRecordIsEditable:{reason:"Control_Enabled_GridRecordIsEditable",disabled:!1},Enabled_ClientAPI:{reason:"Control_Enabled_ClientAPI",disabled:!1},Enabled_FormDescriptor:{reason:"Control_Enabled_FormDescriptor",disabled:!1},Enabled_RecordIsActive:{reason:"Control_Enabled_RecordIsActive",disabled:!1},Disabled_ConfigFlag:{reason:"Control_Disabled_ConfigFlag",disabled:!0},Disabled_ClientAPI:{reason:"Control_Disabled_ClientAPI",disabled:!0},Disabled_GridRecordIsNotEditable:{reason:"Control_Disabled_GridRecordIsNotEditable",disabled:!0},Disabled_QuickViewFormAlwaysDisabled:{reason:"Control_Disabled_QuickViewFormAlwaysDisabled",disabled:!0},Disabled_IsUCIReadOnlyEntity:{reason:"Control_Disabled_IsUCIReadOnlyEntity",disabled:!0},Disabled_EntityNotAvailableInOffline:{reason:"Control_Disabled_EntityNotAvailableInOffline",disabled:!0},Disabled_NoRecordWritePermissions:{reason:"Control_Disabled_NoRecordWritePermissions",disabled:!0},Disabled_LookupNoAppendPrivilege:{reason:"Control_Disabled_LookupNoAppendPrivilege",disabled:!0},Disabled_AttributeNotValidForCreate:{reason:"Control_Disabled_AttributeNotValidForCreate",disabled:!0},Disabled_AttributeNotValidForUpdate:{reason:"Control_Disabled_AttributeNotValidForUpdate",disabled:!0},Disabled_NoAssignPermissionsForOwnerField:{reason:"Control_Disabled_NoAssignPermissionsForOwnerField",disabled:!0},Disabled_NoWritePermissionsByFieldLevelSecurity:{reason:"Control_Disabled_NoWritePermissionsByFieldLevelSecurity",disabled:!0},Disabled_FormDescriptor:{reason:"Control_Disabled_FormDescriptor",disabled:!0},Disabled_RecordIsInactive:{reason:"Control_Disabled_RecordIsInactive",disabled:!0},Disabled_FileOrImageAttribute:{reason:"Control_Disabled_FileOrImageAttribute",disabled:!0}};function Ge(e,t,n){const r=Object(me.b)(e,t.id,n);return r?Object(s.h)(e,r):null}function Ke(e,t,n){if(t&&t.id&&n&&n.parentContextToken){const r=Object(u.b)(e,Dr(e,t.id,n.parentContextToken));if(r){const a=Zt(e,t,n.parentContextToken);if(a){const n=r.activeChanges?r.activeChanges[a.DataFieldName]:null;if(n){const r=Object(o.j)(e,t.id);if(r&&r.isOfflineSyncError&&n.validationResult&&n.validationResult.isOfflineSyncError)return!0}}}}return!1}function Qe(e,t,n,r){const a=Object(S.w)(n),i=Object(me.a)(e,t.id);return!!(i&&i.forms[a]&&i.forms[a].controls&&i.forms[a].controls[r]&&i.forms[a].controls[r].parameters&&i.forms[a].controls[r].parameters.QuickForms)}function Xe(e,t,n){const{missingFields:r}=Ye(e,t,n);return r}function Ye(e,t,n){const r=[],a=[];if(Mt(e,t.id))return{missingFields:r,allRequiredFields:a};const i=Object(me.a)(e,t.id),c=Object(o.j)(e,t.id);if(!i||!c)return{missingFields:r,allRequiredFields:a};const{entityTypeName:d,id:p}=c,g=function(e,t,n,r){const a=Object(S.w)(r),i=Object(me.a)(e,t);if(i&&i.metadata&&i.metadata[a]&&i.metadata[a].attributes){const t=i.metadata[a].attributes,r=Object(f.h)(e,n);if(t){const e={};for(const n of Object.keys(t)){const a=t[n];n===(null==r?void 0:r.PrimaryIdAttribute)||2!==a.RequiredLevel&&1!==a.RequiredLevel||(e[n]=a)}return e}}return null}(e,t.id,d,n),h=new l.a(d,p);let m;if(g){const o=Ge(e,t,n);if(o){const c=o.Controls;for(const l of Object.keys(g)){const d=[];if(c)for(const e in c)c[e].DataFieldName===l&&(m=c[e].Name,d.push(c[e].Name));m||(m=l);let p=!1;const f=Object(s.a)(e,t.id,i.formId,m);f&&o.HiddenFields&&(p=o.HiddenFields.findIndex(e=>e.Id===f.Id)>=0);const g=Dr(e,t.id,n),b=Je(Object(u.e)(e,g,h,l)),y={attributeName:l,controlValidationResults:[],concludedResult:void 0};b?d.length?p?y.concludedResult=3:(d.forEach(r=>{let a;a=xn(e,{id:t.id,controlName:r},n)?1:Rt(e,{id:t.id,controlName:r},n)?Qe(e,t,n,r)?3:0:2,y.controlValidationResults.push({controlName:r,validationResult:a})}),y.concludedResult=y.controlValidationResults.some(e=>0===e.validationResult)?0:4):y.concludedResult=1:y.concludedResult=2,a.push(y),0===y.concludedResult&&r.push(y.attributeName)}}}return{missingFields:r,allRequiredFields:a}}function Je(e){if(!e)return!0;if(Object(d.k)(e)){const t=e;return!t.reference||!t.reference.id}if(Object(d.h)(e))return!e.list||0===e.list.length;const t=Object(d.c)(e);return!t||""===t}function $e(e,t,n,r){const a=Ce.c.concat(r);return null!=Object(v.e)(e,t,n,a)}function Ze(e,t,n){var r,a;let i=[t];const o=null===(a=null===(r=Object(me.a)(e,t))||void 0===r?void 0:r.formInstances)||void 0===a?void 0:a.list;o&&(i=i.concat(o));for(const t of i){Object(ke.a)(e,t)&&(n=Object(S.j)(e,t));const r=Rr(e,t,n);if(!r||!r.updatedFields)continue;const a=Object.keys(r.updatedFields),i=Dr(e,t,n);if(0!==a.length&&i)for(const r in a){if(et(e,t,n,a[r]))return!0}}return!1}function et(e,t,n,r){const a=Rr(e,t,n);if(!a||!a.updatedFields)return!1;if(wn(e,t,n,r)===g.a.Never)return!1;const i=Object(he.b)(e,t),o=Object(s.h)(e,i);if(Ar(e,t,r)&&o&&10!==o.FormType)return!1;const c=Dr(e,t,n);if(!c)return!1;const l=Object(u.b)(e,c),p=l?l.activeChanges:null;let f;if(p&&p[r]&&(f=p[r]),!f)return!1;const h=a.updatedFields[r];if(Object(w.b)(h,f,e)){const e=Object(d.e)(f);if(null!==h||null!==e&&""!==e||!1===f.validationResult.isValueValid&&!Object(xe.b)(f.validationResult.userInput))return!0}}function tt(e,t,n){const r=Object(me.b)(e,t.id,n);if(r){const n=Et(e,r,t.id);if(n)for(const e of n)if(e&&e.Visible)return e}return null}function nt(e,t,n,r){const a=Object(me.b)(e,t,r);return a?Ct(e,a,n,t):null}function rt(e,t,n,r){var a;const i=Object(me.b)(e,t,r);if(i){return Ct(e,i,null===(a=Et(e,i,t).find(e=>e.Name===n))||void 0===a?void 0:a.Id,t)}return null}function at(e,t,n){var r;return null===(r=Et(e,Object(me.b)(e,t,n),t))||void 0===r?void 0:r.length}function it(e,t,n,r){if(n&&n.Id){const a=Ct(e,n.Id,t,r);return a?null===a.AvailableForPhone||void 0===a.AvailableForPhone||a.AvailableForPhone:null}return null}function ot(e,t){return t&&t.startsWith(ze)}function st(e,t,n){const r=Object(me.b)(e,t.id,n);return r?function(e,t,n,r,a){var i;const o=Ct(e,t,n,a);return null===(i=null==o?void 0:o.Columns)||void 0===i?void 0:i[r]}(e,r,t.tabName,t.columnIndex,t.id):null}function ct(e,t,n,r,a){var i;const o=wt(e,r,a,t);return o&&(null===(i=Object.values(o))||void 0===i?void 0:i.find(e=>e.Name===n))}function lt(){let e=null;return function(t,n){const r=ut(t,n,n.contextToken,n.formId);return r&&e&&r.length===e.length&&e.every((e,t)=>r[t]&&e.Id===r[t].Id)||(e=r),e}}function ut(e,t,n,r){const i=Object(s.d)(e,r,t.id);if(!i)return null;const o=new a.a("06e9f7af-1f54-4681-8eec-1e21a1ceb465");return i.filter(r=>{const i={controlName:r.Name,id:t.id},s=Rt(e,i,n);return!a.a.equals(r.ClassId,o)&&!a.a.equals(r.ClassId,a.a.EMPTY)&&s})}function dt(){let e=null;return function(t,n){const r=pt(t,n,n.contextToken);return r&&e&&r.length===e.length&&e.every((e,t)=>r[t]&&e.Id===r[t].Id)||(e=r),e}}function pt(e,t,n){const r=Object(me.b)(e,t.id,n);if(r){const a=Object(s.b)(e,r,t.id);if(a)return a.filter(r=>{const a={controlName:r.Name,id:t.id};return Rt(e,a,n)})}return null}function ft(e,t,n,r){const a=mr(e,n,t,r);return a?a.label?a.label:Object(N.b)(e,A.b):null}function gt(e,t,n,r){var a;const i=Object(me.b)(e,n,r);if(i){return null===(a=Et(e,i,n).find(e=>e.Id===t))||void 0===a?void 0:a.Name}}function ht(e,t,n,r){const a=mr(e,n,t,r);return a?a.collapsed:null}function mt(e,t,n,r){const a=mr(e,n,t,r);return a?a.visible:null}function bt(e,t,n,r){if(Object(Q.e)(e))return!0;let a=!1;const i=zt(e,t,r),o=ct(e,n,t.sectionName,t.id,r);if(o&&o.Rows&&o.Rows.length>0)for(const e of o.Rows){if(e.Cells&&e.Cells.length>0)for(const t of e.Cells)if(t.ControlName&&i&&i[t.ControlName]){a=!0;break}if(a)break}return a}function yt(e,t,n){const r=Object(me.a)(e,t.id),a=Object(S.w)(n);return r&&r.records[a]?r.records[a].isDeleted:null}function _t(e,t,n){const r=Object(me.a)(e,t.id);return r&&r.entityReferenceByRelationship&&r.entityReferenceByRelationship[n]?r.entityReferenceByRelationship[n]:null}function vt(e,t,n){const r=Object(me.a)(e,t.id);return r&&r.entityReferenceByRelationship?r.entityReferenceByRelationship:null}function St(e,t){const n=Object(me.a)(e,t.id);return n&&n.referenceInformationByRelationship?n.referenceInformationByRelationship:null}function Ot(e,t,n){var r;const a=[];if(!(null===(r=null==t?void 0:t.Tabs)||void 0===r?void 0:r.length))return a;const i=Object(Y.e)(e);for(const r of t.Tabs){(it(e,r.Id,t,n)||i!==X.a.Phone)&&a.push(r)}if(Mt(e,n)){const n=ma(e,t);a.push(n)}return a}function Ct(e,t,n,r){var a;const i=Object(s.h)(e,t);if((null===(a=null==i?void 0:i.Tabs)||void 0===a?void 0:a.length)&&Mt(e,r)){return Object.assign(Object.assign({},i),{Tabs:[...i.Tabs,ma(e,i)]}).Tabs.find(e=>e.Id===n)}return Object(s.t)(e,t,n)}function Et(e,t,n){var r;const a=Object(s.h)(e,t);if(n&&(null===(r=null==a?void 0:a.Tabs)||void 0===r?void 0:r.length)&&Mt(e,n)){return Object.assign(Object.assign({},a),{Tabs:[...a.Tabs,ma(e,a)]}).Tabs}return Object(s.v)(e,t)}function It(e,t,n,r,a){const i=ct(e,n,r,t,a);return i&&i.Rows?Object(s.e)(e,i,t,n):null}function wt(e,t,n,r){const a=Object(s.h)(e,r),i=(null==a?void 0:a.Sections)&&Object.values(a.Sections);if(!(null==i?void 0:i.length))return null;if(Mt(e,t)){const r={};return[...i].concat([ba(e,t,n,i,a)]).map(e=>r[e.Name]=e),r}return a.Sections}function jt(e,t,n,r,a){var i,o;const s=Ct(e,n,r,t),c={};if(!(null===(i=null==s?void 0:s.Columns)||void 0===i?void 0:i.length))return null;let l=0;for(;s.Columns[l];){const r=s.Columns[l];null===(o=null==r?void 0:r.SectionNames)||void 0===o||o.forEach(r=>{const i=It(e,t,n,r,a);i&&Object.assign(c,i)}),l++}return c}function Pt(){let e=[],t=[];return function(n,r,a){const i=r.Tabs;if(i!==t){const o=Ot(n,r,a);e=o,t=i}return e}}function Tt(e,t,n){const r=Object(me.a)(e,t.id),a=Object(S.w)(n);return r&&r.forms&&r.forms[a]&&r.forms[a].sections&&r.forms[a].sections[t.sectionName]?r.forms[a].sections[t.sectionName].visible:null}function Nt(e,t,n){const r=Object(me.a)(e,t.id),a=Object(S.w)(n);return r&&r.forms&&r.forms[a]&&r.forms[a].sections&&r.forms[a].sections[t.sectionName]?r.forms[a].sections[t.sectionName].label:null}function At(e,t,n){const r=Object(me.a)(e,t.id),a=Object(S.w)(n);return r&&r.forms&&r.forms[a]&&r.forms[a].controls[t.controlName]?r.forms[a].controls[t.controlName]:null}function Rt(e,t,n){if(n&&n.contextTokenType&&n.contextTokenType===_.a.GridRow)return!0;const r=At(e,t,n);return r?r.visible:null}function Dt(e,t){let n=!1;const r=Object(o.j)(e,t),i=Mt(e,t);return r&&a.a.isNullOrEmpty(r.id)&&!i&&(n=!0),n}function xt(e,t){return Lt(e,t)&&Object(o.h)(e,t)}function Mt(e,t){return Object(o.p)(e,t)===W.a}function Ft(e){const t=Object(_e.b)(e);return t?t[t.length-1]:void 0}function kt(e,t){return Object(o.p)(e,t)===J.a}function Lt(e,t){return Object(o.p)(e,t)===W.b}function Bt(e,t,n){var r;const a=fa(e);if(!Object(Q.a)(e)||a)return!1;let i=!1;const s=Object(te.a)(e);if(s){const n=s.sizes.Breakpoints.DimensionS;i=window.innerWidth<=n||(null===(r=Object(o.q)(e,t))||void 0===r?void 0:r.width)<=n}const c=ca(e,t,n);return!i||c}function Ut(e,t,n){const r=Object(o.j)(e,t);if(!r)return!1;const{entityTypeName:i,id:s}=r,c=new l.a(i,s),u=Object(p.e)(e,c);return!(!Object(Ce.g)(r)&&Object(Ce.f)(e,c,t))&&(!(a.a.isNullOrEmpty(u)||!Object(v.h)(e,a.a.toString(u)))&&Rt(e,{id:t,controlName:Ce.b},n))}function Vt(){let e={};return function(t,n,r){const a=zt(t,n,r);return Object(P.e)(e,a)||(e=a),e}}function zt(e,t,n){const r={},i=new a.a("5c5600e0-1d6e-4205-a272-be80da87fd42"),s=Cn(e,t,n);if(s){const c=Object.keys(s);for(const f of c){const c=s[f];if(c)if(a.a.equals(c.ClassId,i)){const a=Rt(e,{controlName:f,id:t.id},n);if(null===a||a)if(Object(Q.e)(e))r[f]=!0;else{const{entityTypeName:i,id:s}=Object(o.j)(e,t.id),g=c.DataFieldName?c.DataFieldName:null;if(g){const a=Object(u.e)(e,Dr(e,t.id,n),new l.a(i),g);if(a){const e=!!Object(d.b)(a);r[f]=e}else{const t=!!Object(p.j)(e,new l.a(i,s),g);r[f]=t}}else r[f]=a}else r[f]=a}else{const a=Rt(e,{controlName:f,id:t.id},n);null!=a&&(r[f]=a)}}}return r}function qt(e,t,n){const r=At(e,t,n);return r?r.label:null}function Ht(e,t,n){const r=At(e,t,n);return r&&r.parameters?r.parameters.Url:null}function Wt(e,t,n){const r=At(e,t,n);return!(!r||!r.parameters)&&r.parameters.isCustomSrc}function Gt(e,t,n){const r=At(e,t,n);return r&&r.parameters?r.parameters.DisableMru:null}function Kt(e,t,n){const{entityTypeName:r,id:a}=Object(o.j)(e,t.id),i=Dr(e,t.id,n),s=a?new l.a(r,a):new l.a(r),c=Object(u.e)(e,i,s,t.controlName);return Object(d.c)(c)}function Qt(e,t){const{entityTypeName:n,id:r}=Object(o.j)(e,t.id);return Xt(e,n,r)}function Xt(e,t,n){const r=Object(f.h)(e,t);if(r){const a=new l.a(t,n);let i=Object(p.j)(e,a,r.PrimaryNameAttribute);if(null==i){const n=Object(c.a)(e,t,r.PrimaryNameAttribute);if(null==n?void 0:n.AttributeOf){const r=n.AttributeOf,o=Object(c.a)(e,t,r);(null==o?void 0:o.Type)===fe.a.Lookup&&(i=Object(p.j)(e,a,r))}}return Object(d.c)(i)}return null}function Yt(e,t,n,r,a,i,o){if(Object(Se.f)(i))return Object(V.a)(i,e,t,n,r,a);let s=Object(u.e)(e,r,a,i);if(Jt(e,null==a?void 0:a.etn,i)&&o){const e=o(Object(de.c)(i,a,t,n));e&&(s=Object(p.m)(e,null==s?void 0:s.timestamp,null==s?void 0:s.validationResult))}if(Object(d.j)(s)){const r=t?bn(e,t,n,a.etn,i):Object(c.a)(e,a.etn,i);if(!s.formatted||function(e){if("integer"===e.Type){const t=parseInt(e.Format,10);return t===ye.a.DURATION||t===ye.a.TIMEZONE||t===ye.a.LANGUAGE}return!1}(r)){const t=Object(E.A)(e,r),n=Object(N.e)(e,x.a);s.formatted=Object(E.y)(s.value,t,n)}}return s}function Jt(e,t,n){return function(e,t,n){const r=Object(c.f)(e,t,fe.a.File);return Object(q.f)(e,z.Od)&&Object(q.f)(e,Fe.l)&&r&&r.hasOwnProperty(n)}(e,t,n)||function(e,t,n){const r=Object(c.f)(e,t,fe.a.Image);return Object(q.f)(e,z.Qd)&&Object(q.f)(e,Fe.l)&&r&&r.hasOwnProperty(n)}(e,t,n)}function $t(e,t){return Object(q.f)(e,z.Qf)&&!Mt(e,t)}function Zt(e,t,n){if(e&&t&&t.controlName){if(fn(t.controlName)){const n=Object(o.j)(e,t.id),r=n?new l.a(n.entityTypeName,n.id):null,a=r?r.etn:null,i=r?Object(p.e)(e,r):null;return Object(v.e)(e,i,a,t.controlName)}const r=Object(me.b)(e,t.id,n);if(r)return Object(s.a)(e,t.id,r,t.controlName)}return null}function en(e,t,n){var r,a,i,o;const s=Object(S.w)(n);return null===(o=null===(i=null===(a=null===(r=null==e?void 0:e.pages)||void 0===r?void 0:r[t])||void 0===a?void 0:a.forms)||void 0===i?void 0:i[s])||void 0===o?void 0:o.formScrollAndFocusState}function tn(e,t,n){return nn(e,t.id,n)}function nn(e,t,n){const r=Object(me.a)(e,t),a=Object(S.w)(n);return r&&r.forms&&r.forms[a]&&r.forms[a].selectedTab?r.forms[a].selectedTab.tabId:""}function rn(e,t,n,r,i){a.a.isNullOrEmpty(i)&&(i=Object(he.b)(e,t));const o=Object(s.a)(e,t,i,r),c=nn(e,t,n);if(Object(q.f)(e,z.gg)){const n=Object(je.b)(e,t);return!!(Object(we.f)(e,null==n?void 0:n.id)===t)&&(!c||!(null==o?void 0:o.ParentTabId)||(null==o?void 0:o.ParentTabId)===c)}return!c||!(null==o?void 0:o.ParentTabId)||(null==o?void 0:o.ParentTabId)===c}function an(e,t,n){const r=Object(me.a)(e,t),a=Object(S.w)(n);return r&&r.forms&&r.forms[a]&&r.forms[a].selectedTab?r.forms[a].selectedTab.navigationStack:null}function on(e,t,n){const r=Un(e,t,n);if(r&&r.selectedTab&&r.selectedTab.tabId){if("TaskBasedFlow"===Object(o.p)(e,t)){const a=Object(o.j)(e,t);if(a&&a.uniqueName){const i=Object(j.a)(e,a.uniqueName),o=gt(e,r.selectedTab.tabId,t,n);if(i&&i.defaultNextPageByTabName&&i.defaultNextPageByTabName.hasOwnProperty(o))return i.defaultNextPageByTabName[o]}}if(r.tabs){let a=!1;for(const i in r.tabs){if(a)return gt(e,i,t,n);a=i===r.selectedTab.tabId}}}return""}function sn(e,t,n,r){return cn(e,t,n.id,r)}function cn(e,t,n,r){return!function(e,t){const n=ln(e,t);return n&&n.length>0}(e,r)&&!function(e,t){const n=un(e,t);return n&&n.length>0}(e,r)&&0===Object.keys(Xe(t,{id:n},r)).length}function ln(e,t){const n=Object(S.w)(t);return e&&e.forms&&e.forms[n]&&e.forms[n]&&e.forms[n].invalidControls?Object.keys(e.forms[n].invalidControls):null}function un(e,t){const n=Object(S.w)(t);return e&&e.forms&&e.forms[n]&&e.forms[n]&&e.forms[n].invalidAttributes?Object.keys(e.forms[n].invalidAttributes):null}function dn(e,t,n){const r=un(Object(me.a)(e,t),n),a=[];if(r){for(let i=0;i<r.length;i++){const o=Er(e,t,n,r[i]);for(let e=0;e<o.length;e++)a.push(o[e])}return a}return null}function pn(e,t,n){const r=Object(me.a)(e,t),a=Dr(e,t,n),i=Object(u.b)(e,a),s=ln(r,n),l=dn(e,t,n),d=(null!=s?s:[]).concat(l),p={},f=new Map,g=new Set;for(const r of d){const a=pa(Zt(e,{id:t,controlName:r},n),r);f.set(r,a),fn(r)||g.add(a)}return d.map(r=>{var a,s,l,u,d,h;if(!Qe(e,{id:t},n,r)){const m=f.get(r);if(m){let f;i&&(f=i.activeChanges?i.activeChanges[m]:i.lockedChanges?i.lockedChanges[m]:null);const b=Rt(e,{controlName:r,id:t},n);let y=qt(e,{id:t,controlName:r},n);if(!y){const n=null===(a=Object(o.j)(e,t))||void 0===a?void 0:a.entityTypeName;y=(null===(s=Object(c.a)(e,n,m))||void 0===s?void 0:s.DisplayName)||r}const _=fn(r)&&g.has(m);if(f&&f.validationResult&&!f.validationResult.isValueValid&&!_){const e={label:y,errorMessage:f.validationResult.errorMessage};p.hasOwnProperty(m)&&!b||(p[m]=e)}else{const a=gr(e,t,r,n),i=function(e,t,n,r){const a=Un(e,t,r).controls[n].dataFieldName,i=function(e,t,n){const r=Object(me.a)(e,t);if(r&&r.metadata){const e=Object(S.w)(n);return r.metadata[e]}return null}(e,t,r);if(i&&i.attributes&&i.attributes[a])return i.attributes[a];return null}(e,t,r,n);if(null==a?void 0:a.notifications)for(const e in a.notifications)if(null===(u=null===(l=a.notifications[e])||void 0===l?void 0:l.messages)||void 0===u?void 0:u.length){const t={label:y,errorMessage:a.notifications[e].messages[0]};p.hasOwnProperty(m)&&!b||(p[m]=t)}if(null===(h=null===(d=null==i?void 0:i.notifications)||void 0===d?void 0:d.messages)||void 0===h?void 0:h.length){const e={label:y,errorMessage:i.notifications.messages[0]};p.hasOwnProperty(m)&&!b||(p[m]=e)}}}}}),p}function fn(e){return e&&e.startsWith(Ce.c)}function gn(e,t,n){const r=Object(S.w)(n);return e&&e.forms&&e.forms[r]&&e.forms[r].controls&&e.forms[r].controls[t]?e.forms[r].controls[t].parentSectionName:null}function hn(e,t,n){const r=Object(S.w)(n);return e&&e.forms&&e.forms[r]&&e.forms[r].sections&&e.forms[r].sections[t]?e.forms[r].sections[t].parentTabId:null}function mn(e,t,n,r,a){const i=Zt(e,{id:r,controlName:n},a);if(!i)return null;const o=i.DataFieldName;let s;if(t)s=Object(c.a)(e,t,o);else{const t=Tr(e,r);t&&(s=t[o])}const l=Object(me.a)(e,r),u=Object(S.w)(a);if(l&&l.metadata&&l.metadata[u]&&l.metadata[u].attributes){const e=l.metadata[u].attributes[o];if(!s)return Object.assign({},e);if(s.OptionSet){const t=[...s.OptionSet];return Object.assign(Object.assign({},s),Object.assign(Object.assign({},e),{OptionSet:t}))}return Object.assign(Object.assign({},s),e)}return s}function bn(e,t,n,r,i){if(n&&n.contextTokenType&&n.contextTokenType===_.a.GridRow)return function(e,t,n,r,a){const i=Object(c.a)(e,r,a),o=yn(e,r,a);if(!o)return i;return o.RequiredLevel=Object(T.O)(e,t,n,a),Object.assign(Object.assign({},i),o)}(e,t,n,r,i);let o;o=n&&n.contextTokenType===_.a.RelatedEntity?Object(S.w)(n):Object(S.y)(n);const s=Object(me.a)(e,t);let l=null;s&&s.metadata&&s.metadata[o]&&s.metadata[o].attributes&&s.metadata[o].attributes[i]&&(l=s.metadata[o].attributes[i]);let u=Object(c.a)(e,r,i);if(!u){const n=Object(he.b)(e,t);if(!a.a.isNullOrEmpty(n)){const t=Object(c.l)(e,n.guid);t&&(u=t[i])}}return l?Object.assign(Object.assign({},u),l):u}function yn(e,t,n){let r=null;const i=Object(c.a)(e,t,n);if(i){const n="regarding"===i.Format;let o=i.Targets;if(n&&(!o||0===o.length)&&a.a.validate(t)){o=function(e){const t=Object(c.d)(e,Be);if(!t)return null;if(t.hasOwnProperty(Ue)&&t[Ue]&&t[Ue].Targets)return t[Ue].Targets;return null}(e)||o}r={Precision:_n(e,i),PrecisionSource:i.PrecisionSource,RequiredLevel:i.RequiredLevel,Format:i.Format,OptionSet:i.OptionSet,IsValidForCreate:i.IsValidForCreate,IsValidForUpdate:i.IsValidForUpdate,Targets:o}}return r}function _n(e,t){if(!t)return 2;if(t.Type===fe.a.Integer)return 0;let n;switch(t.PrecisionSource){case void 0:case 0:n=t.Precision;break;case 1:const r=Object(b.D)(e);r&&(n=r.pricingDecimalPrecision);break;case 2:n=Object(E.b)(Object(h.x)(e))}return(null==n||n<0)&&(n=2),n}function vn(e,t,n,r){const a=gr(e,t,n,r);return a&&a.parameters&&a.parameters.ViewId?a.parameters.ViewId:null}function Sn(e,t){const n=Object(o.j)(e,t.id);return n?n.recordSetQueryKey:null}function On(e,t){const n=Object(o.j)(e,t.id);return n&&n.id?n.id:null}function Cn(e,t,n){const r=t.id,a=Object(me.b)(e,r,n);return a?It(e,r,a,t.sectionName,n):null}function En(e,t){return Object(me.a)(e,t)}function In(e,t,n,r){if(n&&n.contextTokenType&&n.contextTokenType===_.a.GridRow)return Object(T.O)(e,t,n,r);const a=En(e,t),i=Object(S.w)(n);let o;return a&&a.metadata[i]&&a.metadata[i].attributes[r]&&(o=a.metadata[i].attributes[r].RequiredLevel),null!=o?o:0}function wn(e,t,n,r){const a=En(e,t),i=Object(S.y)(n);let o;return a&&a.metadata[i]&&a.metadata[i].submitModes[r]&&(o=a.metadata[i].submitModes[r]),null!=o?o:g.a.Dirty}function jn(e,t,n,r){const a=Object(me.a)(e,t),i=Object(S.w)(r);if(a&&a.forms&&a.forms[i]&&a.forms[i].controls[n]&&a.forms[i].controls[n].parameters&&a.forms[i].controls[n].parameters.hasOwnProperty("defaultviewid"))return a.forms[i].controls[n].parameters.defaultviewid}function Pn(){let e=null,t=null;const n=Tn();return function(r,a){const i=n(r,a);return i&&e!==i&&(e=i,t=Object.keys(i)),t}}function Tn(){let e=null;const t=new Map;return function(n,r){var a,i;const o=Object(me.a)(n,r),s=null===(i=null===(a=Object(me.a)(n,r))||void 0===a?void 0:a.formInstances)||void 0===i?void 0:i.list;let c=!1;if((null==o?void 0:o.notifications)!==t.get(r)&&(t.set(r,null==o?void 0:o.notifications),c=!0),!c&&s)for(const e of s){const r=Object(me.a)(n,e);(null==r?void 0:r.notifications)!==t.get(e)&&(t.set(e,null==r?void 0:r.notifications),c=!0)}if(c){e={},(null==o?void 0:o.notifications)&&(e=Object.assign(Object.assign({},e),o.notifications));for(const t of s){const r=Object(me.a)(n,t);(null==r?void 0:r.notifications)&&(e=Object.assign(Object.assign({},e),null==r?void 0:r.notifications))}}return e}}function Nn(e,t){var n,r;const a=Object(me.a)(e,t),i=null===(r=null===(n=Object(me.a)(e,t))||void 0===n?void 0:n.formInstances)||void 0===r?void 0:r.list;let o={};if((null==a?void 0:a.notifications)&&(o=Object.assign(Object.assign({},o),a.notifications)),i)for(const t of i){const n=Object(me.a)(e,t);(null==n?void 0:n.notifications)&&(o=Object.assign(Object.assign({},o),null==n?void 0:n.notifications))}return o}function An(e,t,n){if(n&&n.contextTokenType&&n.contextTokenType===_.a.GridRow)return Object(T.N)(e,t.id,n,t.controlName);const r=Object(me.a)(e,t.id);let a;if(a=n&&n.contextTokenType===_.a.RelatedEntity?Object(S.w)(n.parentContextToken):Object(S.w)(n),r&&r.forms&&r.forms[a]&&r.forms[a].controls){const e=r.forms[a].controls[t.controlName];return e?e.notifications:null}return null}function Rn(e,t,n){const r=Object(me.b)(e,t.id,n),a=Object(s.a)(e,t.id,r,t.controlName);if(a&&a.Url)return a.Url;if(a&&a.Parameters){const e="Url";return a.Parameters[e]}}function Dn(e,t,n){if(!n)return!1;const r=Zt(e,t,n);if(Object(Oe.e)(e,"DisableWebResourceControls")&&He.some(e=>a.a.equals(e,null==r?void 0:r.ClassId)))return!0;const i=Object(Oe.c)(e,"DisableFormControl");return!(!t.controlName||(null==i?void 0:i.toLocaleLowerCase())!==t.controlName.toLocaleLowerCase())}function xn(e,t,n){const r=Mn(e,t,n);return null==r?void 0:r.disabled}function Mn(e,t,n){var r;if(!n)return We.Enabled_ContextTokenIsNull;if(n&&n.contextTokenType&&n.contextTokenType===_.a.GridRow)return Object(T.M)(e,t.id,n,t.controlName)?We.Enabled_GridRecordIsEditable:We.Disabled_GridRecordIsNotEditable;if(Dn(e,t,n))return We.Disabled_ConfigFlag;if(Fn(e,t.id,n))return We.Disabled_QuickViewFormAlwaysDisabled;if(Object(I.c)(e,n.entityTypeName))return We.Disabled_IsUCIReadOnlyEntity;const a=Object(o.o)(e,t);if((Object(Ee.E)(e)?!Object($.b)(e):!Object($.c)(e))&&(!Object(ee.a)(e)||"dialog"!==a&&!Object(Z.n)(e,n.entityTypeName)))return We.Disabled_EntityNotAvailableInOffline;if(!Ln(e,n.entityTypeName,t.id))return We.Disabled_NoRecordWritePermissions;const i=Un(e,t.id,n),l=i&&i.controls&&i.controls[t.controlName]?i.controls[t.controlName]:null;if(!l)return;const u=l.dataFieldName?Object(c.a)(e,n.entityTypeName,l.dataFieldName):null;if(u){const r=Dt(e,t.id);if(r&&!u.IsValidForCreate)return We.Disabled_AttributeNotValidForCreate;if(!r&&!u.IsValidForUpdate)return Jt(e,n.entityTypeName,u.LogicalName)?We.Control_Disabled_FileOrImageAttribute:We.Disabled_AttributeNotValidForUpdate;if(u.Type===fe.a.Owner&&!function(e,t,n){return!!Dt(e,n)||kn(e,t,5)}(e,n.entityTypeName,t.id))return We.Disabled_NoAssignPermissionsForOwnerField}const d=Object(o.j)(e,t.id);if(!(!l.dataFieldName||$r(e,n.entityTypeName,null==d?void 0:d.id,t.id,l.dataFieldName)))return We.Disabled_NoWritePermissionsByFieldLevelSecurity;if(void 0!==l.disabledByClientApi&&null!==l.disabledByClientApi)return l.disabledByClientApi?We.Disabled_ClientAPI:We.Enabled_ClientAPI;const p=Object(he.b)(e,t.id),f=Object(s.a)(e,t.id,p,t.controlName),g=f&&f.Disabled,h=Object(s.h)(e,p);if(h&&10===h.FormType)return g?We.Disabled_FormDescriptor:We.Enabled_FormDescriptor;if(g)return We.Disabled_FormDescriptor;const m=(null==u?void 0:u.Type)===fe.a.Lookup?(null===(r=function(e,t,n,r){const a=Vn(e,t,n);if(null==a?void 0:a[r])return a[r];return null}(e,t.id,n,l.dataFieldName))||void 0===r?void 0:r.Targets)||u.Targets:null;if(m){if(!kn(e,n.entityTypeName,7,!0))return We.Disabled_LookupNoAppendPrivilege;if(-1===m.findIndex(t=>!0===kn(e,t,8,!0)))return We.Disabled_LookupNoAppendPrivilege}return!!d&&Yn(e,n.entityTypeName,d.id)?We.Disabled_RecordIsInactive:We.Enabled_RecordIsActive}function Fn(e,t,n){const r=n&&n.controlName?n.controlName:null;if(r){const a=Object(me.b)(e,t,n),i=Un(e,t,n.parentContextToken),o=i?i.inlineQuickForms[r]:null;return a===(o?o[n.entityTypeName]:"")}return!1}function kn(e,t,n,r){return Object(I.g)(e,t,n,0,r)}function Ln(e,t,n){let r=!0;const i=Object(o.j)(e,n);i&&(r=Object(I.h)(e,t,a.a.toString(i.id),se.a.WriteAccess));return(!!Dt(e,n)||kn(e,t,3))&&r}function Bn(e,t,n){const r=Object(me.a)(e,t.id),a=Object(S.w)(n);if(r&&r.forms&&r.forms[a]&&r.forms[a].controls[t.controlName]){const e="Url";return r.forms[a].controls[t.controlName].parameters[e]}}function Un(e,t,n){const r=Object(me.a)(e,t);if(r&&r.forms){const e=Object(S.w)(n);return r.forms[e]}return null}function Vn(e,t,n){const r=En(e,t),a=Object(S.w)(n);return r&&r.metadata&&r.metadata[a]&&r.metadata[a].attributes?r.metadata[a].attributes:null}function zn(e,t,n){const r=Vn(e,t,n);if(!r)return[];const a=Object(me.b)(e,t,n),i=Object(s.d)(e,a,t),o=new Set(i?i.map(e=>e.Name):[]),c=[],l=Object.keys(r);for(const r of l){const a=Er(e,t,n,r);a&&0!==a.length?a.some(r=>{if(!o.has(r))return!0;const a=Zt(e,{controlName:r,id:t},n);return!!ia(e,t,a,n)})&&c.push(r):c.push(r)}return c}function qn(e,t,n,r){var a;return null===(a=Hn(e,t,n,r))||void 0===a?void 0:a.label}function Hn(e,t,n,r){var a,i;const o=Object(me.a)(e,t);if(!(null==o?void 0:o.navigation))return null;const s=Object(h.s)(e),c=Object(b.D)(e),l=c&&c.languageCode;if(null===(a=o.navigation.navBarItems[n])||void 0===a?void 0:a.titles){const e=Object(H.b)(o.navigation.navBarItems[n],s),t=o.navigation.navBarItems[n].PreviewId;if(e)return{label:e.Value,labelSource:ve.b.NavLinkFormDescriptorForCurrentUserLanguage,previewId:t};const r=Object(H.b)(o.navigation.navBarItems[n],l);if(r)return{label:r.Value,labelSource:ve.b.NavLinkFormDescriptorForBaseLanguage,previewId:t};const a=Object(H.b)(o.navigation.navBarItems[n],1033);return a?{label:a.Value,labelSource:ve.b.NavLinkFormDescriptorForEnglish,previewId:t}:{label:"",labelSource:ve.b.NavLinkFormDescriptorNoTitle,previewId:t}}if(null===(i=o.navigation.navBarByRelationshipItems[n])||void 0===i?void 0:i.titles){const e=o.navigation.navBarByRelationshipItems[n].PreviewId,t=Object(H.b)(o.navigation.navBarByRelationshipItems[n],s);if(t)return{label:t.Value,labelSource:ve.b.FormDescriptorForCurrentUserLanguage,previewId:e};if(r)return{label:r,labelSource:ve.b.EntityDisplayCollectionName,previewId:e};const a=Object(H.b)(o.navigation.navBarByRelationshipItems[n],l);if(a)return{label:a.Value,labelSource:ve.b.FormDescriptorForBaseLanguage,previewId:e};const i=Object(H.b)(o.navigation.navBarByRelationshipItems[n],1033);if(i)return{label:i.Value,labelSource:ve.b.FormDescriptorForEnglish,previewId:e}}return null}function Wn(e,t,n){var r,a;const i=Object(me.a)(e,t);return null===(a=null===(r=null==i?void 0:i.navigation)||void 0===r?void 0:r.navBarByRelationshipItems)||void 0===a?void 0:a[n]}function Gn(e,t,n){const r=Wn(e,t,n);return null==r?void 0:r.show}function Kn(e,t,n){const r=En(e,t),a=Object(S.y)(n);return r&&r.metadata[a]&&r.metadata[a].submitModes?r.metadata[a].submitModes:null}function Qn(e,t){if(t.id){const n="statecode",r=Object(o.j)(e,t.id);if(r){const t=r.id?new l.a(r.entityTypeName,r.id):new l.a(r.entityTypeName);return Object(p.j)(e,t,n)}}return null}function Xn(e,t){if(t.id){const n="statuscode",r=Object(o.j)(e,t.id);if(r){const t=r.id?new l.a(r.entityTypeName,r.id):new l.a(r.entityTypeName);return Object(p.j)(e,t,n)}}return null}function Yn(e,t,n){const a=n?new l.a(t,n):new l.a(t),i=Object(p.j)(e,a,"statecode"),o=Object(d.d)(i);if(t===y.Ub){const t=Object(p.j)(e,a,"isdisabled");return!!(!Object(D.a)(t)&&"1"===t.valueString)&&"1"===Object(d.d)(t)}if(i){let n=function(e,t,n,r){switch(t){case y.cb:const a=Object(p.j)(e,n,"majorversionnumber"),i=Object(p.j)(e,n,"minorversionnumber");if(null!=a&&null!=i&&0===a.value&&0===i.value)return!0;if("2"===r||"3"===r){const t="7c538e3d-8e82-4f73-922e-471472954c52",n=Object(h.v)(e)[t];return null==n}return"5"===r||"6"===r;case y.d:case y.Eb:return!("0"===r||"3"===r);case y.ub:return"1"===r;case y.vb:return!("2"===r);case y.I:return"0"===r||"2"===r;case y.Lb:return!("0"===r||"3"===r);case y.c:return"0"===r;case y.Ib:const o=Object(b.D)(e);if(!Object(D.a)(o)&&!Object(D.a)(o.isSOPIntegrationEnabled)&&!o.isSOPIntegrationEnabled&&"1"===r)return!1;default:if(e&&e.metadata&&t&&e.metadata.entities&&e.metadata.entities[t]&&e.metadata.entities[t].hasOwnProperty("IsActivity")&&e.metadata.entities[t].IsActivity)return!("0"===r||"3"===r)}return}(e,t,a,o);return void 0===n&&(n=o!==String(r.Active)),n}return!1}function Jn(e,t,n){const r=Qn(e,{id:t});if(r)return Object(d.c)(r);let a="";const i=Object(o.j)(e,t),s=i&&i.entityTypeName,c=Object(ae.c)(e,s);if(s&&null!=c&&c>-1&&(a=Object(ie.b)(e,s,m.x,c)),!a){const t=Yn(e,s,i.id);a=Object(N.c)(n,t?oe.e:oe.a)}return a}function $n(e,t,n){const r=Object(me.a)(e,t.id),a=Object(S.w)(n);return!!(r&&r.forms&&r.forms[a])&&r.forms[a].isSaving}function Zn(e,t){return Object(he.a)(e,t).some(t=>{const n=Object(S.j)(e,t);return $n(e,{id:t},n)})}function er(e,t,n){const r=Object(me.a)(e,t.id),a=Object(S.w)(n);return!!(r&&r.forms&&r.forms[a])&&r.forms[a].isAutoSaving}function tr(e,t){return Object(he.a)(e,t).some(t=>{const n=Object(S.j)(e,t);return er(e,{id:t},n)})}function nr(e,t,n){const r=Object(me.a)(e,t.id),a=Object(S.w)(n);return r&&r.forms&&r.forms[a]?r.forms[a].viewportWidth:null}function rr(e,t,n){const r=Object(me.a)(e,t.id),a=Object(S.w)(n);return r&&r.forms&&r.forms[a]?r.forms[a].viewportHeight:null}function ar(e,t,n){const r=Object(me.a)(e,t.id),a=Object(S.w)(n);return r&&r.forms&&r.forms[a]?r.forms[a].showHeaderFieldsInSection:null}function ir(e,t,n){const r=Object(me.a)(e,t),a=Object(S.w)(n);if(r&&r.forms&&r.forms[a]){return r.forms[a].headerFieldsInFlyout}return null}function or(e,t,n,r,a){for(const i of a){const a=Zt(e,{id:n,controlName:i},t),o=xn(e,{id:n,controlName:i},t),s=Rt(e,{controlName:i,id:n},t),c=sr(e,{controlName:i,id:n},t),l=s&&c,u=Qe(e,{id:n},t,i);if(pa(a,i)===r&&!o&&l&&!u)return i}}function sr(e,t,n){const{parentSectionName:r}=gr(e,t.id,t.controlName,n);let a;const i=hr(e,t.id,r,n);let o=!1,s=!1;return i&&(a=i.parentTabId,s=mt(e,a,t.id,n),o=i.visible),o&&s}function cr(e,t,n){const r=Object(me.a)(e,t.id),a=Object(S.w)(n);return!!(r&&r.forms&&r.forms[a])&&r.forms[a].hasOfflineChanges}function lr(e,t,n){const r=t.id;return!!Object(o.j)(e,r)&&ur(e,t,n)!==re.a.NotReadOnly}function ur(e,t,n){const r=t.id,a=Object(o.j)(e,r);if(!a||!n)return re.a.NotReadOnly;const i=n.entityTypeName,s=a.id;if(Object(I.c)(e,i))return re.a.EntityPermissions;if(!Ln(e,i,r))return re.a.RecordPermissions;if(Yn(e,i,s))return re.a.RecordStatus;return!(Object(Ee.E)(e)?!Object($.b)(e):!Object($.c)(e))||Object(ee.a)(e)&&Object(Z.n)(e,i)?re.a.NotReadOnly:re.a.Offline}function dr(e,t,n){if(Mt(e,t))return!1;if(n){const r=ur(e,{id:t},n);return r!==re.a.NotReadOnly&&r!==re.a.RecordStatus}return!1}function pr(e,t,n){const r=Object(o.j)(e,t);if(r&&Yn(e,r.entityTypeName,r.id))return 4;if(r&&r.entityTypeName&&!Object(I.g)(e,r.entityTypeName,a.a.isNullOrEmpty(r.id)?1:3,0))return 3;switch(Object(o.p)(e,t)){case W.b:case W.c:return a.a.isNullOrEmpty(r&&r.id)?1:2;case W.a:return 6;case"QuickCreateForm":return 1;case"Dialog":return 12;case"TaskBasedFlow":return 5;default:return 0}}function fr(e,t){if(Mt(e,t))return!0;const n=Object(me.a)(e,t);return!(!n||!n.suppressDuplicateDetection)&&n.suppressDuplicateDetection}function gr(e,t,n,r){const a=Un(e,t,r);return a&&a.controls&&a.controls[n]?a.controls[n]:null}function hr(e,t,n,r){const a=Un(e,t,r);return a&&a.sections&&a.sections[n]?a.sections[n]:null}function mr(e,t,n,r){const a=Un(e,t,r);return a&&a.tabs&&n?a.tabs[n]:null}function br(e,t,n,r){const a=gr(e,t,n,r);if(a){const n=hr(e,t,a.parentSectionName,r);if(n){const a=mr(e,t,n.parentTabId,r),i={id:t};return a&&n.parentTabId===tn(e,i,r)&&!1===a.collapsed?null:n.parentTabId}}return null}function yr(e,t,n,r){if(n&&n.contextTokenType&&n.contextTokenType===_.a.GridRow){const t=Object(c.a)(e,n.entityTypeName,r);return t?t.Precision:null}const a=Dr(e,t,n),i=Object(o.j)(e,t),s=new l.a(i.entityTypeName,i.id),d=Object(u.e)(e,a,s,"transactioncurrencyid"),p=Object(E.A)(e,bn(e,t,n,s.etn,r),d);return Object(E.C)(p)}function _r(e,t){const{entityTypeName:n,id:r}=Object(o.j)(e,t.id),a=r?new l.a(n,r):new l.a(n),i=Object(p.j)(e,a,Object(ge.a)(null,e,n));return i?Object(d.c)(i):null}function vr(e,t){const{entityTypeName:n,id:r}=Object(o.j)(e,t.id);if(!n)return null;const a=Object(C.a)(n);if(a){const t=r?new l.a(n,r):new l.a(n),i=Object(p.j)(e,t,a);if(i)return Object(d.c)(i)}return null}function Sr(e,t,n){return t&&n?document.getElementById(n):null}function Or(e){return`${qe}${e}`}function Cr(e,t,n,r){const a=Object(f.h)(e,null==t?void 0:t.entityTypeName);if(a){const t=Zt(e,{id:n,controlName:a.PrimaryNameAttribute},r);if(t)return t.DomId}return null}function Er(e,t,n,r,a){const i=Un(e,t,n);if(i&&i.controls){const e=e=>!a&&!e||a===e,t=[];for(const n in i.controls)i.controls[n].dataFieldName===r&&e(i.controls[n].relationship)&&t.push(n);return t}return null}function Ir(e,t,n,r){const a=Zt(e,{id:t,controlName:r},n);if(!a)return null;const i=a.DataFieldName,o=En(e,t),s=Object(S.y)(n);if(o&&o.metadata[s]&&o.metadata[s].attributes[i]){if(o.metadata[s].attributes[i].OptionSet)return o.metadata[s].attributes[i].OptionSet;if(n&&n.entityTypeName){const t=Object(c.a)(e,n.entityTypeName,i);if(t&&t.Type===fe.a.Integer&&t.Format===3..toString()){const t=[],n=Object(b.h)(e);if(n)return Object.keys(n).forEach(e=>{const r=parseInt(e,10);r>0&&t.push({Value:r,Label:n[r]})}),t}}}return null}function wr(e,t,n,r,a){var i;let s;if(n&&n.contextTokenType===_.a.RelatedEntity){const r=St(e,{id:t}),a=r[n.relationshipName]&&r[n.relationshipName].referencedEntity;a&&(s=a)}else s=n?n.entityTypeName:void 0;r=function(e,t,n,r,a){const i=Object(c.a)(e,a,r),s=bn(e,t,n,a,r);if(!Object(D.a)(a)&&"email"===a&&"from"===r&&!function(e,t){const n=e.Targets,r=t.Targets;return n&&r&&!function(e,t){return e.length===t.length&&e.every((e,n)=>e===t[n])}(n,r)}(i,s)){const n=Object(o.j)(e,t),i=null==n?void 0:n.id;if(!Object(D.a)(i)){const t=new l.a(a,i),n=Object(p.j)(e,t,m.y),o=Object(p.j)(e,t,m.e);(null==n?void 0:n.valueString)&&("4"===(null==n?void 0:n.valueString)||"2"===(null==n?void 0:n.valueString)&&"0"===(null==o?void 0:o.valueString))&&(r="to")}}return r}(e,t,n,r,s);const u=a?Object(c.a)(e,s,r):bn(e,t,n,s,r);if(!u)return null;const d=u.Targets.filter(t=>{const n=Object(f.h)(e,t);return(null==n?void 0:n.Initialized)!==O.a.Initialized||Object(I.g)(e,t,2,0)});return"partylist"===u.Type&&(null===(i=Object(b.D)(e))||void 0===i?void 0:i.allowUnresolvedPartiesOnEmailSend)&&d.push("unresolvedaddress"),d}function jr(e,t,n,r){return wr(e,t,n,r,!1)}function Pr(e,t,n,r){return wr(e,t,n,r,!0)}function Tr(e,t){const n=Object(he.b)(e,t);return Object(c.l)(e,a.a.toString(n))}function Nr(e,t,n){const r=Tr(e,t);if(r){const e=r[n];if(e)return e}return null}function Ar(e,t,n){const r=Object(he.b)(e,t),a=Object(s.h)(e,r),i=null==a?void 0:a.EntityLogicalName;if(Nr(e,t,n)){const t=Object(c.d)(e,i);return!(null==t?void 0:t[n])}return!1}function Rr(e,t,n){const r=Object(me.a)(e,t),a=Object(S.w)(n);if(r&&r.records)return r.records[a]}function Dr(e,t,n){const r=Rr(e,t,n);if(r)return r.snapshotId}function xr(e,t,n){const r=Rr(e,t,n);return r&&null!=r.updatedFields?Object.keys(r.updatedFields):[]}function Mr(e,t,n){const r=Un(e,t,n);return r?r.label:""}function Fr(e,t,n,r){return r.length>0?r+(e?t?": "+t:"":n.length>0?": "+n:""):e&&t||n}function kr(e,t,n){const r=Un(e,t,n);return r?r.inlineQuickForms:null}function Lr(e,t,n){const r=Object(o.j)(e,t);if(!(r&&n&&n.controlName&&n.entityTypeName&&n.parentContextToken))return!1;const a=new l.a(r.entityTypeName,r.id),i=Dr(e,t,n.parentContextToken),c=gr(e,t,n.controlName,n.parentContextToken),d=c?c.dataFieldName:null,f=Object(u.e)(e,i,a,d);if(!f||!f.reference)return!1;const g=Object(p.b)(f.reference)(e),h=Un(e,t,n),m=Object(he.b)(e,t),b=Object(s.h)(e,m);return h&&g&&g.initialized===O.a.Initialized&&Ur(n.controlName,b,f.reference.etn)}function Br(e,t,n){const r=Object(o.j)(e,t);if(!r)return!1;const a=new l.a(r.entityTypeName,r.id),i=Object(p.b)(a)(e);return Un(e,t,n)&&i&&i.initialized===O.a.Initialized}function Ur(e,t,n){return t&&t.InlineQuickForms&&t.InlineQuickForms[e]&&t.InlineQuickForms[e][n]&&t.InlineQuickForms[e][n]!==a.a.EMPTY}function Vr(e,...t){return qr(e?"Forms.MainFormDialog":"Forms.EditForm",t)}function zr(e,...t){return qr(e?"Forms.MainFormDialog":Le,t)}function qr(e,t){return t&&0!==t.length?e.concat(".",t.join(".")):e}function Hr(e,t){const n=function(e,t){const n=Object(o.j)(e,t.id);return n?Object(p.o)(e,n.recordSetQueryKey):null}(e,t);return n&&n.records?n.records.length:null}function Wr(e,t,n,r){const a=Object(o.j)(e,t),i=Dr(e,t,n),s=Object(u.e)(e,i,{etn:a.entityTypeName,id:a.id},"");if(s&&s.validationResult&&!s.validationResult.isValueValid)return!0;const c=An(e,{controlName:r,id:t},n);return c&&Object.keys(c).some(e=>{if(c[e].notificationLevel===R.a.error)return!0})}function Gr(e,t,n,r=!1,a=s.c){const i={},o=a(e,n,t);if(o)for(const a in o){const i=o[a],l=Qr(),u=Object(s.h)(e,n);if(u){const a=l(e,i,t,n,u.EntityLogicalName,r);if(a&&(c(a),a.Children))for(const e in a.Children){c(a.Children[e])}}}return i;function c(t){let n=t.CustomControlId,r=n&&Object(M.e)(e,n);r&&(i[r.CustomControlId]=r),n=Object(B.B)(t),r=n&&Object(M.e)(e,n),r&&(i[r.CustomControlId]=r,function(t,n){if(t===be.b){if(!n[be.a]){const t=Object(M.e)(e,be.a);t&&(n[be.a]=t)}if(!n[be.d]){const t=Object(M.e)(e,be.d);t&&(n[be.d]=t)}}}(r.CustomControlId,i))}}function Kr(e,t,n,r){const a=r&&Object(T.db)(e,r.CustomControlId);if(!a)return r;const i=Xr(e,t,n)?{FirstDataRequestType:Object(q.f)(e,z.dh)?0:1}:null;return Object.assign(Object.assign({},r),{Parameters:Object.assign(Object.assign({},r.Parameters),{[a]:Object.assign(Object.assign({},r.Parameters[a]),i)})})}function Qr(){let e=null,t=null,n=null,r=0,i=!1;const s=function(){let e,t;return(n,r)=>(n!==e&&(e=n,t=Object(B.H)(n,r)),t)}();return(c,d,p,f,g,h=!1,m)=>{var _;const v=Object(F.b)(c);let O=null,C=null,E=null;d&&d.UniqueId&&f&&(O=Object(M.f)(c,p,d.UniqueId,f),C=O||Object(M.b)(c,d.UniqueId,f),E=null===(_=null==C?void 0:C.CustomControls)||void 0===_?void 0:_[v]);let I=d&&d.ClassId&&d.ClassId.guid?d.ClassId.guid:null;if(function(e,t,n,r){const a=Object(o.j)(e,t),i=Object(q.f)(e,z.p),s=Object(q.f)(e,z.Pb),c=Object(q.f)(e,z.zc),l=Object(q.f)(e,z.ac),u=Object(q.f)(e,z.Ac),d=Object(b.D)(e),p=!((null==a?void 0:a.entityTypeName)!==y.d&&(null==a?void 0:a.entityTypeName)!==y.Eb||(null==n?void 0:n.DataFieldName)!==y.F||"64c06392-12e9-4c27-b1b0-9c30df417844"!==(null==r?void 0:r.UniqueId)&&"28470007-a604-46ad-9cb2-9289a24ef4c7"!==(null==r?void 0:r.UniqueId)||s&&((null==d?void 0:d.appointmentWithTeamsMeeting)||c)),f=(null==a?void 0:a.entityTypeName)===y.J&&(null==n?void 0:n.DataFieldName)===y.F&&"0fcab5f6-0317-4359-bcd1-57cba2b0ea69"===(null==r?void 0:r.UniqueId)&&!(i&&l||u);return p||f}(c,p,d,C)&&(E=null,C=null,I=function(e,t){const n=Object(o.j)(e,t);return(null==n?void 0:n.entityTypeName)===y.d||(null==n?void 0:n.entityTypeName)===y.Eb?"e0dece4b-6fc8-4a8f-a065-082708572369":(null==n?void 0:n.entityTypeName)===y.J?"6F3FB987-393B-4d2d-859F-9D0F0349B6AD":"e0dece4b-6fc8-4a8f-a065-082708572369"}(c,p)),function(e,t,n,r){const a=Object(o.j)(e,n);if(Object(D.a)(a))return!1;const i=("appointment"===a.entityTypeName||"recurringappointmentmaster"===a.entityTypeName)&&"description"===t.DataFieldName&&Object(b.D)(e).appointmentRichEditorExperience&&"MscrmControls.RichTextEditor.RichTextEditorControl"!==(null==r?void 0:r.Name);let s=!1,c=!1,l=!1;return s="MscrmControls.RichTextEditor.RichTextEditorControl"===(null==r?void 0:r.Name)&&"email"===a.entityTypeName&&"description"===t.DataFieldName&&!Object(q.e)(e,z.Gb,z.o),c="MscrmControls.RichTextEditor.RichTextEditorControl"===(null==r?void 0:r.Name)&&"template"===a.entityTypeName&&"safehtml"===t.DataFieldName&&!Object(q.e)(e,z.lh,z.o),l="MscrmControls.RichTextEditor.RichTextEditorControl"===(null==r?void 0:r.Name)&&"emailsignature"===a.entityTypeName&&"safehtml"===t.DataFieldName&&!Object(q.e)(e,z.Rg,z.o),i||s||c||l}(c,d,p,E)&&(I="6f3fb987-393b-4d2d-859f-9d0f0349b6ad",E=null),Object(q.f)(c,z.O)){const t=d.Parameters;if(f&&I&&t&&t.VisualizationId&&t.ChartGridMode){const o=a.a.tryParse(t.VisualizationId);if(!a.a.isNullOrEmpty(o)&&"Chart"===t.ChartGridMode){if(!m){const e=Object(S.j)(c,p);m=Object(S.q)(e,d.Name)}const a=Object(T.P)(c,p,m);if(!e||r!==a||n&&(n.TargetEntityType!==t.TargetEntityType||n.ViewId!==t.ViewId||n.RelationshipName!==t.RelationshipName||n.EnableViewPicker!==t.EnableViewPicker||n.ViewIds!==t.ViewIds||n.EnableChartPicker!==t.EnableChartPicker||n.IsUserView!==t.IsUserView||n.IsUserChart!==t.IsUserChart||n.VisualizationId!==t.VisualizationId)){const o=Xr(c,p,d),s=Dt(c,p),l=t.RelationshipName,u=!o||(s||i)&&l?1:2;e=Object(B.u)(t,u,a),e.FormFactor=v,n=t,r=a,i=s}return e}}}if(I&&d&&d.Parameters&&"powerBITile"===k.a.ClassIdControlMap[I.toLowerCase()]&&Object(q.f)(c,z.Sf)){const e=d.Parameters;return Object(B.m)(e,v,d.Name)}let w=!1;if(d&&d.UniqueId&&f){if(E&&!Object(T.Bb)(c,E,v)){const t=[be.c];if(d.DataFieldName&&-1===t.indexOf(E.Name)){const t=Object(M.e)(c,E.Name);return t&&(e=s(E,t)),e}const n=function(e){const t=[De.D,Pe.e,Pe.a,De.C];return e&&-1!==t.indexOf(e.Name)}(E),r=C.CustomControls[v];return n?Kr(c,p,d,r):r}w=!0}const j=d.Parameters;if(f&&I&&(k.a.ClassIdControlMap[I.toLowerCase()]===De.J||"referencepanelsubgrid"===k.a.ClassIdControlMap[I.toLowerCase()]||w&&I.toLowerCase()===L.a.guid.toLowerCase()&&null!=j.ViewId&&null!=j.TargetEntityType)){let n=null;if(c&&e){const t=Object(T.db)(c,e.CustomControlId);if(t){const r=e.Parameters[t];n=r&&r.ViewId}}if(!e||t&&(t.ViewId!==j.ViewId||t.TargetEntityType!==j.TargetEntityType||t.EnableViewPicker!==j.EnableViewPicker||t.RelationshipName!==j.RelationshipName||n&&n.replace(/[\{\}]/gi,"")!==j.ViewId.replace(/[\{\}]/gi,""))){if(h){const e=a.a.tryParse(d.Parameters.VisualizationId);if(!a.a.isNullOrEmpty(e)&&"Chart"===d.Parameters.ChartGridMode)return{CustomControlId:"MscrmControls.Chart.ChartControl"}}const{pcfDatasetGridEnabled:n}=Object(b.D)(c);e=Object(B.z)(d.Id,j,!1,n),e.FormFactor=v,t=j,k.a.ClassIdControlMap[I.toLowerCase()]===De.J&&(e=Kr(c,p,d,e))}return e}const P=Object(o.j)(c,p),N=g||(P?P.entityTypeName:null),A=Object(U.b)(c,N,d),R={};if(A===k.a.QuickForm||A===k.a.Card){R.quickFormId=function(e,t,n,r,i){if(t.Parameters.hasOwnProperty(Ve)&&r){const o=new l.a(r.entityTypeName,a.a.isNullOrEmpty(r.id)?a.a.EMPTY:r.id),s=Dr(e,n,i),c=Object(u.e)(e,s,o,t.DataFieldName),d=c?c.reference:null;if(Object(Q.e)(e)){const r=kr(e,n,i);if(r){const e=r[t.Id];if(e){const t=Object.keys(e);if(t&&t.length>0){const n=t[0];return a.a.toString(e[n])}}}return a.a.toString(a.a.EMPTY)}if(d){const r=kr(e,n,i);if(r){const e=d.etn,n=r[t.Id][e];return a.a.isNullOrEmpty(n)?a.a.toString(a.a.EMPTY):a.a.toString(n)}}}return a.a.toString(a.a.EMPTY)}(c,d,p,P,Object(S.j)(c,p));const e=Xr(c,p,d),t=Dt(c,p),n=e&&!t?2:1;R.chartDataRequestType=n}if(h&&d.Parameters&&d.Parameters[0]&&d.Parameters[0].StreamObjects)return{Children:{stream:{CustomControlId:Object(T.G)(c)},tile:{CustomControlId:"MscrmControls.KPICard.KPICardControl"}}};const x=Object(B.t)(d.Name,d.DataFieldName,A,N,I,d,R)||Object(B.t)(d.Id,d.DataFieldName,A,N,I,d,R);if(x!==e){if(x.Parameters&&x.Parameters.value){const e=x.Parameters.value;x.Parameters.value=Object(B.g)(e,d)}const t=Object(B.h)(x,I);null!==t&&Object.assign(x.Parameters,t),e=x}return e}}function Xr(e,t,n){const r=n,a=Object(me.a)(e,t);return a&&a.visitedTabNames&&r&&r.ParentTabId&&a.visitedTabNames.has(r.ParentTabId)}function Yr(e,t,n){const r=En(e,t),a=Object(S.w)(n);return r&&r.forms&&r.forms[a]&&r.forms[a].controls?r.forms[a].controls:null}function Jr(e,t,n){const r=En(e,t);if(r&&r.referenceInformationByRelationship)for(const e in r.referenceInformationByRelationship)if(e===n)return r.referenceInformationByRelationship[e].referencedEntity;return null}function $r(e,t,n,r,a){const i=Dt(e,r)?ce.a.CanCreate:ce.a.CanUpdate;return Object(I.f)(e,t,a,i,n)}function Zr(e,t,n){let r=null;const a=Ot(e,Object(s.h)(e,t),n);if(a)for(const e of a)if(e.Visible){if(e.Expanded)return e.Id;r||(r=e.Id)}return r}function ea(e,t,n){const r=Tr(e,t);return n&&n.DataFieldName&&(!r||!r[n.DataFieldName])&&!n.Relationship&&!a.a.equals(n.ClassId,L.d)}function ta(e,t,n){const r=Object(s.h)(e,t),a=r.InlineQuickForms,i=[];if(a)for(const e in a){const t=a[e];if(t){if(n){const t=r.Controls[e];if(t&&t.ParentTabId!==n)continue}for(const e in t){const n=t[e];i.push(n)}}}return i}function na(e,t,n,r){const a={},i=Object(c.f)(e,n,fe.a.PickList),o=Object(c.f)(e,n,fe.a.MultiSelectPickList),s=Object.assign(i,o),l=Yr(e,r,t);if(!(Object.keys(s).length>0))return null;for(const e in l)if(l.hasOwnProperty(e)){const t=l[e].dataFieldName;if(s[t]){const e=s[t].ParentPicklistLogicalName,n=s[t].ChildPicklistLogicalNames;(e||n&&n.length>0)&&(a[t]=s[t])}}return a}function ra(e,t,n){var r,a;const i=Object(Ae.a)();if(n)return{mode:K.a.MainFormDialog,reason:"The Main Form Dialog is opened due to the flag 'forceShowMainFormDialog' being set."};const o=Object(G.a)(e),s=o?o.quickCreateMenuItems:null,c=s?s[t]:null;if(c&&9===c.formType)return{mode:K.a.QuickCreateForm,reason:"A Quick Create Form was found for the entity."};let l="Please use form checker to find the reason.";return i&&(l=null===(a=null===(r=null==o?void 0:o.missingQuickCreateMenuItems)||void 0===r?void 0:r[t])||void 0===a?void 0:a.toString()),{mode:K.a.EditForm,reason:l}}function aa(){let e=new Set,t=!1,n=null,r=!1;return function(a,o,s){const c=Object(q.e)(a,Fe.k),l=Ge(a,o,s),u=l&&l.HeaderDensity,d=Object(q.e)(a,z.Ec,z.jf),p=Object(q.e)(a,Fe.d,z.kf),f=Object(q.f)(a,Fe.p);return t===c&&n===u&&r===f||(e=new Set,t=c,n=u,r=f,c&&(u!==i.a.Low||p)&&e.add(Fe.k),d&&e.add(z.Ec),f&&e.add(Fe.p)),e}}function ia(e,t,n,r){if(!Object(q.e)(e,Fe.k)&&!Object(q.e)(e,z.zd))return!0;const a=Ge(e,{id:t},r);if(a&&a.HeaderDensity===i.a.Low)return!0;if(!n)return!1;const o=Object(he.b)(e,t);return!0!==Object(s.d)(e,o,t).some(e=>e&&e.Name===n.Name)||(!!Object(ne.f)(e,{id:t},r,o)||Object(ne.j)(n))}function oa(e){const t=new Set,n=Object(ue.b)(e);return n&&n.length>0&&n.forEach(e=>{t.add(e)}),t}function sa(e,t){const n=oa(e);if(!n||!t||0===t.length)return t;return t.filter(e=>n.has(e))}function ca(e,t,n){const r=Object(q.e)(e,Fe.k),a=Ge(e,{id:t},n);return Object(q.e)(e,Fe.d,z.kf)?Object(Ie.b)(e)||r:Object(Ie.b)(e)||r&&a&&a.HeaderDensity!==i.a.Low}function la(e){return!Object(le.c)(e)&&Object(b.D)(e).isAutoSaveEnabled}function ua(e,t,n){var r;return"singleComponent"===(null===(r=mr(e,t,nn(e,t,n),n))||void 0===r?void 0:r.contentType)}function da(e,t){const n=Object(me.a)(e,t);return n?n.autoSaveInterval:pe.a}function pa(e,t){let n=null==e?void 0:e.DataFieldName;return n||Object(Se.f)(t)&&(n=t),n}function fa(e){return Object(Oe.e)(e,"DisableFormCommandbar")}function ga(e){return Object(Oe.e)(e,"DisableBusinessProcessFlow")}function ha(e,t,n){return Object(Re.a)(e,n)&&Object(Te.a)(e,t)<Ne.a.EditReady}function ma(e,t){var n;const r=function(e){var t;if(!(null===(t=null==e?void 0:e.TabNames)||void 0===t?void 0:t.length))return"HEADER";let n="HEADER",r=1;for(;e.TabNames.find(e=>e===n);)n="HEADER"+r,r++;return n}(t),a={Width:"100%",SectionNames:[ya(t)]};return{Id:"tab_bulkEditHeader",Name:r,Label:Object(N.b)(e,A.a),Columns:[a],DomId:Object(Me.a)(),LabelId:null,ShowLabel:!0,Visible:!0,EventHandlers:null,Expanded:!(null===(n=null==t?void 0:t.Tabs)||void 0===n?void 0:n.length),AvailableForPhone:!0}}function ba(e,t,n,r,i){const o=ya(i),s=function(e){return null==e?void 0:e.map(e=>({Id:e.Id,ColSpan:1,RowSpan:1,AutoExpand:!0,IsInFirstColumnOfSection:!0,IsInLastColumnOfSection:!1,ShowLabel:!0,Visible:e.Visible,ControlName:e.Name,DomId:e.DomId,Locklevel:null,AvailableForPhone:!0,UserSpacer:!1,IsPreviewCell:!1,IsStreamCell:!1,IsChartCell:!1,IsTileCell:!1,PreviewId:e.PreviewId}))}(ut(e,{id:t},n,null==i?void 0:i.Id)),c=[];s.map(e=>{const t=e&&{Visible:!0,Height:"30%",Cells:[e]};t&&c.push(t)});return{Id:a.a.newGuid(),Label:null,Name:o,ShowLabel:!1,Visible:!0,Rows:c,CellLabel:null,DomId:Object(Me.a)(),Columns:1,AvailableForPhone:!0,SemanticZoomDomId:null,Height:null}}function ya(e){let t="HEADER",n=1;const r=(null==e?void 0:e.Sections)&&Object.keys(e.Sections);for(;null==r?void 0:r.find(e=>e===t);)t="HEADER"+n,n++;return t}},i4Wf:function(e,t,n){"use strict";
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var r=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable;function o(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(e){r[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var n,s,c=o(e),l=1;l<arguments.length;l++){for(var u in n=Object(arguments[l]))a.call(n,u)&&(c[u]=n[u]);if(r){s=r(n);for(var d=0;d<s.length;d++)i.call(n,s[d])&&(c[s[d]]=n[s[d]])}}return c}},i8tO:function(e,t,n){"use strict";n.d(t,"b",(function(){return vt})),n.d(t,"a",(function(){return St}));var r=n("QFtu"),a=n("fskq"),i=n("ufH1"),o=n("umme"),s=n("omgb"),c=n("84PK"),l=n("nfLm"),u=n("HkYq"),d=n("PV+a"),p=n("504W"),f=n("UDbe"),g=n("2mBq"),h=n("dzep"),m=n("Div0");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const b="offlineDataStore";var y,_,v,S=n("VA/h"),O=n("l3Ef");!function(e){e[e.pending=0]="pending",e[e.completed=1]="completed",e[e.notTracked=2]="notTracked",e[e.inProgress=3]="inProgress",e[e.failed=4]="failed"}(y||(y={})),function(e){e[e.sqlSyncUnsupportedNorsyncVersion=-35]="sqlSyncUnsupportedNorsyncVersion"}(_||(_={})),function(e){e[e.none=0]="none",e[e.metadataVersion=1]="metadataVersion",e[e.offlineProfile=2]="offlineProfile"}(v||(v={}));var C=n("lR0U");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var E;!function(e){e[e.none=0]="none",e[e.profileUnavailable=1]="profileUnavailable",e[e.databaseUnavailable=2]="databaseUnavailable",e[e.metadataChanged=3]="metadataChanged",e[e.syncFailure=-1]="syncFailure",e[e.upgradeClient=-2]="upgradeClient"}(E||(E={}));class I{constructor(e,t){this._metadataVersionUsed=null,this._offlineDisabledEntities=null,this._metadataVersionUsed=e,this._offlineDisabledEntities=t}get_metadataVersionUsed(){return this._metadataVersionUsed}getObjectData(){const e={};return e.metadataversionused=this._metadataVersionUsed,e.offlinedisabledentities=this._offlineDisabledEntities,e}static createFromObjectData(e){let t="";return Object(p.a)(e)||Object(p.b)(e.metadataversionused.toString())||(t=e.metadataversionused.toString()),new I(t,[])}}var w=n("RADj"),j=n("2LZB"),P=n("/A0C");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function T(e){switch(e){case P.a.Customer:case P.a.Lookup:case P.a.Memo:case P.a.Owner:case P.a.String:case P.a.UniqueIdentifier:case P.a.EntityName:return"text";case P.a.Double:return"real";case P.a.Money:case P.a.Decimal:return"fixed";case P.a.DateTime:return"datetime";case P.a.BigInt:case P.a.Integer:case P.a.Boolean:case P.a.PickList:case P.a.State:case P.a.Status:case P.a.ManagedProperty:return"integer";default:return""}}var N=n("03Hu"),A=n("T544"),R=n("JPoD"),D=n("EW4s"),x=n("ml6Y");const M=[P.a.Virtual,P.a.PartyList];class F{constructor(e,t){this._parentDataSource=null,this._offlineDisabledEntities=null,this._localContext=null,this._entitySkipList=[R.c.toLowerCase()],this._parentDataSource=e,this._localContext=t}calculateAndSetOfflineDisabledEntities(e,t){const n=new D.a,r=[];let a=w.a.InSyncWithServer;return this._CalculateMetadataMismatchEntities(e,t).then(()=>{null!==this._offlineDisabledEntities&&this._offlineDisabledEntities.length>0&&Object(i.e)("OfflineMetadataManager_CalculateAndSetOfflineDisabledEntities",m.a.offlineMetadataSync,"List of offline disabled entities, entities are present in offline profile but not in schema : "+this._offlineDisabledEntities.toString()),N.a.get_DefaultInstance().get_offlineTypescriptInterface().setOfflineDisableInformation(this._offlineDisabledEntities,t.toString(),void 0),N.a.get_DefaultInstance().get_offlineTypescriptInterface().setCalculationOfDisabledOfflineEntitiesPending(!1),null!==this._offlineDisabledEntities&&this._offlineDisabledEntities.length>0?(a=w.a.SyncPending,N.a.get_DefaultInstance().get_offlineTypescriptInterface().setMetadataSyncStatus(w.a.SyncPending)):a=w.a.InSyncWithServer,N.a.get_DefaultInstance().get_offlineTypescriptInterface().setMetadataSyncStatus(a);const e=new I(t.toString(),this._offlineDisabledEntities),o={};o[x.a.OfflineMetatdataSyncStatusKey]=a,r.push(this._parentDataSource.saveOfflineInformation(x.a.OfflineDisabledInfoKey,e.getObjectData(),!1)),r.push(this._parentDataSource.saveOfflineInformation(x.a.OfflineMetatdataSyncStatusKey,o,!1)),Object(S.a)(r).then(()=>{Object(i.c)("OfflineMetadataManager_CalculateAndSetOfflineDisabledEntities",m.a.offlineMetadataSync,"Successfully saved the offline disabled info and metadata status in the session state."),n.resolve(!0)},e=>{Object(i.e)("OfflineMetadataManager_CalculateAndSetOfflineDisabledEntities_Error",m.a.offlineMetadataSync,"Saving offline disabled info and metadata sync status in session state failed with error : "+e.get_Message()),n.reject(e)}),n.resolve(!0)},e=>{Object(i.e)("OfflineMetadataManager_CalculateAndSetOfflineDisabledEntities_Error",m.a.offlineMetadataSync,"Calculation of offline disabled entities failed with error : "+e.get_Message()),n.reject(e)}),n}_CalculateMetadataMismatchEntities(e,t){const n=new D.a;if(this._offlineDisabledEntities=[],null!==e&&!Object(p.b)(e.userData)&&e.userData.split("#").length>1){const t=e.userData.split("#");if(t[0]===N.a.get_DefaultInstance().get_offlineTypescriptInterface().getOfflineProfileVersion()&&t[1]===N.a.get_DefaultInstance().get_offlineTypescriptInterface().getLastMetadataVersionUsedForValidation())n.resolve(!0);else{const t=[],r={};for(const t of e.tables)r[t.name]=t;for(const e of N.a.get_DefaultInstance().get_offlineTypescriptInterface().getOfflineProfileAvailableEntities())e in r?t.push(this._CompareMetadata(r[e])):this._entitySkipList.indexOf(e)<0&&this._offlineDisabledEntities.push(e);Object(S.a)(t).then(()=>{n.resolve(!0)},e=>{n.reject(e)})}}else n.reject(o.a.FromMessage("Retrieved client model is corrupt or empty."));return n}_CompareMetadata(e){const t=new D.a,n=N.a.get_DefaultInstance().get_offlineTypescriptInterface().isApplicationMetadataDownloadInShimEnabled();return this._parentDataSource.retrieveMultipleAttributeMetadata(new A.a(e.name),this._localContext).then(r=>{const a={};for(const t of e.column)a[t.name]=t.type;for(const t of r){const r=t.get_type()===P.a.Lookup||t.get_type()===P.a.Owner||t.get_type()===P.a.Customer?t.get_logicalName()+O.l+O.B:t.get_logicalName();let o=!1;if(N.a.get_DefaultInstance().get_offlineTypescriptInterface().isDssOfflineEnabled()||(o=a[r]!==T(t.get_type())),M.indexOf(t.get_type())<0&&(!(r in a)||o)){n||(this._offlineDisabledEntities.push(e.name),Object(i.e)("OfflineMetadataManager_CalculateAndSetOfflineDisabledEntities",m.a.offlineMetadataSync,"Offline disable entities due to lookup metadata mismatch : "+r+" "+e.name));break}}t.resolve()},r=>{n||(this._offlineDisabledEntities.push(e.name),Object(i.e)("OfflineMetadataManager_MetadataSchemaValidator_Error:RetrieveMultipleAttributeMetadata failed for Entity "+e.name,m.a.offlineMetadataSync,r.get_Message())),t.resolve()}),t}}var k=n("yRo8");class L{constructor(){this._middlewareProfileVersion=0,this._middlewareMetadataVersion=0,this._clientMetadataVersion=0,this._parentDataSource=null,this._localContext=null,this._clientModelTables=null}get_clientModelTables(){return this._clientModelTables}_get_ClientProfileVersion(){return Number.parseInvariant(N.a.get_DefaultInstance().get_offlineTypescriptInterface().getOfflineProfileVersion())}initialize(e,t,n){this._parentDataSource=t,this._localContext=n}isServerMetadataSyncRequired(){let e=!1;if(N.a.get_DefaultInstance().get_offlineTypescriptInterface().isDssOfflineEnabled()){const t=N.a.get_DefaultInstance().get_offlineTypescriptInterface().getIsProfileChanged(),n=[];N.a.get_DefaultInstance().get_offlineTypescriptInterface().getMetadataSyncStatus()===w.a.SyncPending&&(t||this._middlewareMetadataVersion>this._clientMetadataVersion?(N.a.get_DefaultInstance().get_offlineTypescriptInterface().setOfflineStatus(null,E.metadataChanged),N.a.get_DefaultInstance().get_offlineTypescriptInterface().setMetadataSyncStatus(w.a.SyncPendingFromServer),Object(h.a)(n,"OfflineMetadtaSyncStatus",w.a.SyncPendingFromServer.toString()),e=!0,N.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentWarn(k.f,"[offlineMetadataManager] isServerMetadataSyncRequired: Profile is changed",n)):this._middlewareMetadataVersion!==this._clientMetadataVersion&&N.a.get_DefaultInstance().get_offlineTypescriptInterface().setMetadataSyncStatus(w.a.SyncPendingFromMiddleware))}else N.a.get_DefaultInstance().get_offlineTypescriptInterface().getMetadataSyncStatus()!==w.a.SyncPending||N.a.get_DefaultInstance().get_offlineTypescriptInterface().getIsProfileChanged()||(this._middlewareProfileVersion>this._get_ClientProfileVersion()||this._middlewareMetadataVersion>this._clientMetadataVersion?(N.a.get_DefaultInstance().get_offlineTypescriptInterface().setOfflineStatus(null,E.metadataChanged),N.a.get_DefaultInstance().get_offlineTypescriptInterface().setMetadataSyncStatus(w.a.SyncPendingFromServer),e=!0):this._middlewareProfileVersion===this._get_ClientProfileVersion()&&this._middlewareMetadataVersion===this._clientMetadataVersion||N.a.get_DefaultInstance().get_offlineTypescriptInterface().setMetadataSyncStatus(w.a.SyncPendingFromMiddleware));return e}calculateDisabledOfflineEntitiesAfterMetadataSync(){const e=new D.a;return this._SetClientMetadataVersion().always(()=>{this._ShouldRecalculateAfterMetadataSync().then(t=>{t?this.calculateDisabledOfflineEntities().always(()=>{this.isServerMetadataSyncRequired(),e.resolve()}):e.resolve()},t=>{e.reject(t)})}),e}_ShouldRecalculateAfterMetadataSync(){const e=new D.a;return Object(p.a)(this._parentDataSource)?e.resolve(!1):(this._parentDataSource.retrieveOfflineInformation(x.a.OfflineDisabledInfoKey).then(t=>{if(Object(p.a)(t))e.resolve(!0);else{const n=I.createFromObjectData(t);Object(p.b)(n.get_metadataVersionUsed())?e.resolve(!0):n.get_metadataVersionUsed()===this._clientMetadataVersion.toString()?e.resolve(!1):e.resolve(!0)}},t=>{Object(i.e)("OfflineMetadataManager_ShouldReCalculateAfterMetadataSync_Error",m.a.offlineMetadataSync,"Retrieval of offline disabled info failed. Error: "+t.get_Message()),e.reject(t)}),e)}calculateDisabledOfflineEntities(){const e=new D.a;return Object(i.e)("OfflineMetadataManager_CalculateDisabledOfflineEntities",m.a.offlineMetadataSync,"Calculation of disabled offline entities started"),this._GetClientSyncModel().then(t=>{if(null!==t&&!Object(p.b)(t.userData)&&t.userData.split("#").length>1){const n=t.userData.split("#");this._middlewareProfileVersion=Number.parseInvariant(n[0]),this._middlewareMetadataVersion=Number.parseInvariant(n[1]);const r=new F(this._parentDataSource,this._localContext);this._SetClientMetadataVersion().then(()=>{r.calculateAndSetOfflineDisabledEntities(t,this._clientMetadataVersion).then(t=>{Object(i.e)("OfflineMetadataManager_CalculateDisabledOfflineEntities",m.a.offlineMetadataSync,"Successfully calculated and saved the offline disabled info as session state."),e.resolve(t)},t=>{Object(i.e)("OfflineMetadataSync_CalculateDisabledOfflineEntities_Error",m.a.offlineMetadataSync,t.get_Message()),e.reject(t)})},t=>{Object(i.e)("OfflineMetadataManager_CalculateDisabledOfflineEntities",m.a.offlineMetadataSync,t.get_Message()),e.reject(t)})}else e.reject(o.a.FromMessage("Retrieved client model is corrupt or empty."))},t=>{e.reject(t)}),e}async isDataModelChanged(e){Object(i.e)("OfflineMetadataManager_IsDataModelChanged",m.a.offlineMetadataSync,"Checking if data model change started");try{const t=await this._GetClientSyncModel().nativePromise();let n=this._clientMetadataVersion;null!==t&&!Object(p.b)(t.userData)&&t.userData.split("#").length>1&&(n=Number.parseInvariant(t.userData.split("#")[1]));let r=0;if(n!==this._clientMetadataVersion)r=v.metadataVersion;else if(!Object(p.a)(e)){const n=this._GetClientModelTables(t);if(n.length!==e.length)r=v.offlineProfile;else{n.sort(),e.sort();for(let t=0;t<n.length;t++)if(n[t]!==e[t]){r=v.offlineProfile;break}}}return Object(i.e)("OfflineMetadataManager_IsDataModelChanged",m.a.offlineMetadataSync,"Data model change check completed, data model change type is "+r),r}catch(e){const t=e instanceof o.a?e:o.a.fromGenericError(e);return Object(i.e)("OfflineMetadataManager_IsDataModelChanged_Error",m.a.offlineMetadataSync,t.get_Message()),0}}_SetClientMetadataVersion(){const e=new D.a;return this._GetClientMetadataVersion().then(t=>{this._clientMetadataVersion=Number.parseInvariant(t),e.resolve(!0)},t=>{Object(i.e)("OfflineMetadataManager_SetClientMetadataVersion_Error",m.a.offlineMetadataSync,t.get_Message()),e.reject(t)}),e}retrieveClientModelTables(){const e=new D.a;return Object(i.e)("OfflineMetadataManager_RetrieveClientModelTables",m.a.offlineMetadataSync,"Retrieval of client model tables started"),this._GetClientSyncModel().then(t=>{this._clientModelTables=this._GetClientModelTables(t),e.resolve(this._clientModelTables)},t=>{e.reject(t)}),e}_GetClientModelTables(e){const t=[];if(!Object(p.a)(e)&&!Object(p.a)(e.tables))for(const n of e.tables)t[t.length]=n.name;return t}_GetDeserializedClientModel(e){try{return JSON.parse(e)}catch(e){Object(i.e)("OfflineMetadataManager_GetDeserializedClientModel_Error",m.a.offlineMetadataSync,e.message)}return null}_GetClientSyncModel(){const e=new D.a,t=new j.a(new Array(0));return this._parentDataSource.get_offlineDataStore().retrieveLocalEntities("_NORSYNC_SYSTEM_TABLE",t).then(t=>{if(!Object(p.a)(t)&&t.rows.length>0&&!Object(p.a)(t.rows.item(0).DATA_MODEL)){const n=t.rows.item(0).DATA_MODEL.toString(),r=this._GetDeserializedClientModel(n);e.resolve(r)}else e.reject(o.a.FromMessage("Error in the retrieved client model from offline db."))},t=>{Object(i.e)("OfflineMetadataManager_GetClientSyncModel_Error",m.a.offlineMetadataSync,t.get_Message()),e.reject(t)}),e}_GetClientMetadataVersion(){const e=new D.a;return Object(p.a)(this._parentDataSource)?e.reject(o.a.FromMessage("parent datasource is null.")):(this._parentDataSource.retrieveEntityMetadataVersionStamp().then(t=>{t.length>0?e.resolve(t.split("!")[0]):e.reject(o.a.FromMessage("Retrieved entity metadata version stamp is null or empty."))},t=>{Object(i.e)("OfflineMetadataManager_GetClientMetadataVersion_Error",m.a.offlineMetadataSync,t.get_Message()),e.reject(t)}),e)}}var B=n("ZJD9"),U=n("BSGX"),V=n("iJxC"),z=n("LFDu"),q=n("JUjK"),H=n("3fL6"),W=n("mKIe"),G=n("3ri3"),K=n("jZCH"),Q=n("bATk");let X=null;class Y{generateInsertQuery(e,t){let n="",r="";for(let e=0;e<t.length;e++){const a=e>0?",":"";n+=a+"["+t[e]+"]",r+=a+"?"}return"INSERT INTO ["+e.LogicalName+"] ("+n+") VALUES ("+r+")"}generateRetrieveQuery(e,t,n){const r=e.LogicalName,a=new U.a(new f.a(n),e.get_key()),i=new V.a(a,null),o=Object(Q.a)(i,r,!0);return(Object(p.a)(t)?o.selectAllColumns():o.selectIndexedColumnsStatement(t))+" COLLATE NOCASE"}generateUpdateQuery(e,t,n){let r="UPDATE "+e.LogicalName+" SET ";for(let e=0;e<t.length;e++)r+=(e>0?",":"")+"["+t[e]+"] = ?";return r+=" WHERE ["+n+"] = ?",r+" COLLATE NOCASE"}generateDeleteQuery(e,t){const n=t.get_filterCriteria();let r="DELETE FROM ["+e.LogicalName+"] ";return n&&n.length>0&&(r=r+"WHERE "+this._CreateWhereClause(n)+" COLLATE NOCASE"),r}generateExistsQuery(e,t){return"SELECT EXISTS(SELECT 1 FROM "+e.LogicalName+" WHERE ["+t+"] = ? LIMIT 1)"}generateRetreiveLookupQuery(e,t,n){let r="",a="";for(let e=0;e<t.length;e++){r+=(e>0?",":"")+"["+t[e]+"]"}for(let t=0;t<e;t++){a+=(t>0?" OR":"")+"["+n.get_primaryIdAttribute()+"] = ?  COLLATE NOCASE"}return"SELECT "+r+" FROM "+n.get_logicalName()+" WHERE "+a}generateRetrieveQueryWithConditions(e,t,n,r){const a=t.get_filterCriteria();let i="SELECT * FROM "+e;return a&&a.length>0&&(i=i+" WHERE "+this._CreateWhereClause(a)+this._CreateOrderClause(n,r)+this._CreateLimitClause(t)+" COLLATE NOCASE"),i}_CreateOrderClause(e,t){let n="";return Object(p.b)(e)||(n=" ORDER BY "+e+(t?" ASC ":" DESC ")),n}_CreateLimitClause(e){let t="";if(!Object(p.a)(e.get_batchSize())&&e.get_batchSize()>0){const n=Object(p.a)(e.get_batchOffset())?"":" OFFSET "+e.get_batchOffset().toString();t+=" LIMIT "+e.get_batchSize().toString()+n}return t}_CreateWhereClause(e){let t="";for(let n=0;n<e.length;n++){const r=e[n].get_parenthesisType()?"":" (",a=e[n].get_parenthesisType()===W.a.end?" )":"";if(t+=n?" "+$(e[n].get_logicalOperator())+r+" ["+e[n].get_name()+"] "+J(e[n].get_condition()):r+" ["+e[n].get_name()+"] "+J(e[n].get_condition()),e[n].get_condition()===q.a.In){const r=e[n].get_value().length;t+=r>0?"(?":"(";for(let e=1;e<r;e++)t+=", ?";t+=")"}else e[n].get_condition()!==q.a.IsNull&&(t+=" ?");t+=a}return t}generateRetrievePartyListQuery(e,t,n){let r="",a="",i="";for(let t=0;t<e.length;t++)r+="["+e[t].get_path()+"],";r=""!==r?r.substr(0,r.length-1):r,a="["+O.c+O.l+O.B+"] = ?";for(let e=0;e<Object.keys(t).length;e++)i+="?,";""!==i&&(i=i.substr(0,i.length-1),a+=" AND ["+O.T+"] in ("+i+")");return"SELECT "+r+" FROM "+n+" WHERE "+a+" COLLATE NOCASE ORDER BY ["+O.T+"]"}generateDeleteAllActivityPartiesQuery(){return"DELETE FROM ["+O.d+"] WHERE ["+O.c+O.l+O.B+"] = ? COLLATE NOCASE"}generateDeleteFilteredActivityPartiesQuery(e){let t="";for(let n=e;n>0;n--)t+=n>1?"?,":"?";return"DELETE FROM ["+O.d+"] WHERE ["+O.c+O.l+O.B+"] = ? AND ["+O.T+"] = ?  AND ["+O.e+"] NOT IN ("+t+") COLLATE NOCASE"}updateActivityPartiesQuery(e){let t="";for(let n=e;n>0;n--)t+="?,";t.length>1&&(t=t.substring(0,t.length-1));return"UPDATE ["+O.d+"] SET ["+O.c+O.l+O.B+"] = ? WHERE ["+O.c+O.l+O.B+"] = ? AND ["+O.T+"] = ?  AND ["+O.e+"] IN ("+t+") COLLATE NOCASE"}generateCreateActiviyPointerViewQuery(e,t,n){let r="CREATE VIEW "+R.c+" AS ";const a=new D.a;return this.getActivityEntities(e,t,n).then(t=>{this._GenerateSelectForActivityEntity(t,e).then(e=>{r+=e,a.resolve(r)},()=>{a.reject(o.a.FromMessage("Offline DB could not create view query."))})},e=>{Object(i.e)("Offline.OfflineSqlQueryBuilder.GenerateCreateActiviyPointerViewQuery.Fail",m.a.offlineDataStore,e.get_Message()),a.reject(e)}),a}generateCreateActiviyAttachmentViewQuery(e){let t="CREATE VIEW "+O.b+" AS ";const n=e.indexOf(R.l)>-1,r=new D.a;return t+=this._GenerateSelectForActivityAttachment(n),r.resolve(t),r}generateDropViewQuery(e){return"DROP VIEW IF EXISTS "+e}_GenerateSelectForActivityEntity(e,t){const n=new D.a;let r="",a="",i="",s="",c=0;const l=new z.a,u=[],d=new A.a(R.c.toLocaleLowerCase());u.push(K.a.get_DefaultInstance().retrieveMultipleAttributeMetadata(d,t));for(let n=0;n<e.length;n++){const r=new A.a(e[n].toString());u.push(K.a.get_DefaultInstance().retrieveMultipleAttributeMetadata(r,t))}return Object(S.a)(u).then(e=>{if(e&&e.length>0){const t=e[0];for(let n=1;n<e.length;n++){const o=e[n];r="SELECT ",c=0;for(let e=0;e<t.length;e++){const n=t[e];if(n.get_type()!==P.a.Virtual){for(let e=0;e<o.length;e++){a="";const t=o[e];if(!Object(p.a)(t.get_inheritsFrom())&&t.get_inheritsFrom()===n.get_logicalName()){if(l.isComplexAttribute(t.get_type())){const e=l.getAttributeMap(t.get_type()).get_columnNameTypeMap();for(let r=0;r<Object.keys(e).length;r++){const i=Object.keys(e)[r],o="["+t.get_logicalName()+O.l+i+"] AS ["+n.get_logicalName()+O.l+i+"]";a+=r!==Object.keys(e).length-1?o+", ":o}}else a+=t.get_logicalName()+" AS "+n.get_logicalName();s=t.get_entityLogicalName();break}}if(!a.length&&l.isComplexAttribute(n.get_type())){const e=l.getAttributeMap(n.get_type()).get_columnNameTypeMap();for(let t=0;t<Object.keys(e).length;t++){const r=Object.keys(e)[t],i="NULL AS ["+n.get_logicalName()+O.l+r+"]";a+=t!==Object.keys(e).length-1?i+", ":i}}else a.length||(a+="NULL AS "+n.get_logicalName());r+=c>0?", "+a:a,c++}}i+=(i.length>0?" UNION ALL ":"")+r+" FROM "+s}n.resolve(i)}else n.reject(o.a.FromMessage("GenerateSelectForActivityEntity: No results when trying to retrieve attribute metadata for activities."))},()=>{n.reject(o.a.FromMessage("Offline DB could not create view query."))}),n}_GenerateSelectForActivityAttachment(e){return Object(g.a)("select xxemail.activityid, xxattachment.body, xxattachment.filename, xxattachment.filesize, xxattachment.mimetype, xxattachment.subject,{0},{1},{2},{3},[xxactivitymimeattachment].[attachmentnumber],[xxactivitymimeattachment].[activitymimeattachmentid],[xxactivitymimeattachment].[versionnumber],[xxactivitymimeattachment].[attachmentid!id],[xxactivitymimeattachment].[attachmentid!name],[xxactivitymimeattachment].[attachmentid!logicalname],[xxactivitymimeattachment].[objectid!id],[xxactivitymimeattachment].[objectid!name],[xxactivitymimeattachment].[objectid!logicalname],[xxactivitymimeattachment].[objecttypecode],[xxactivitymimeattachment].[componentstate],[xxactivitymimeattachment].[overwritetime],[xxactivitymimeattachment].[solutionid],[xxactivitymimeattachment].[supportingsolutionid],[xxactivitymimeattachment].[activitymimeattachmentidunique],[xxactivitymimeattachment].[ismanaged],[xxactivitymimeattachment].[attachmentcontentid], [xxactivitymimeattachment].[isfollowed], [xxactivitymimeattachment].[anonymouslink] from[activitymimeattachment][xxactivitymimeattachment] left join activitypointer xxemail on xxactivitymimeattachment.[objectid!id] = xxemail.activityid and xxemail.activitytypecode='email' {4} left join attachment xxattachment on xxactivitymimeattachment.[attachmentid!id] = xxattachment.attachmentid where (datetime(xxactivitymimeattachment.overwritetime) = datetime('1900-01-01') or xxactivitymimeattachment.overwritetime is null) and xxactivitymimeattachment.componentstate = 0","case when coalesce(xxemail.owneridtype, "+(e?"xxtemplate.owneridtype":'""')+") = 8 then coalesce(xxemail.["+O.Q+O.l+O.B+"],"+(e?"xxtemplate.["+O.Q+O.l+O.B+"]":'""')+") else null end as 'owninguser'","coalesce(xxemail.["+O.Q+O.l+O.B+"], "+(e?"xxtemplate.["+O.Q+O.l+O.B+"]":'""')+") as '"+O.Q+O.l+O.B+"',coalesce(xxemail.["+O.Q+O.l+O.J+"], "+(e?"xxtemplate.["+O.Q+O.l+O.J+"]":'""')+") as '"+O.Q+O.l+O.J+"',coalesce(xxemail.["+O.Q+O.l+"name], "+(e?"xxtemplate.["+O.Q+O.l+"name]":'""')+") as '"+O.Q+O.l+O.a+"'","coalesce(xxemail.owneridtype, "+(e?"xxtemplate.owneridtype":'""')+") as 'owneridtype'","coalesce(xxemail.[owningbusinessunit"+O.l+O.B+"], "+(e?"xxtemplate.[owningbusinessunit"+O.l+O.B+"]":'""')+") as 'owningbusinessunit"+O.l+O.B+"',coalesce(xxemail.[owningbusinessunit"+O.l+O.J+"], "+(e?"xxtemplate.[owningbusinessunit"+O.l+O.J+"]":'""')+") as 'owningbusinessunit"+O.l+O.J+"',coalesce(xxemail.[owningbusinessunit"+O.l+O.a+"], "+(e?"xxtemplate.[owningbusinessunit"+O.l+O.a+"]":'""')+") as 'owningbusinessunit"+O.l+O.a+"'",e?" left join template xxtemplate on xxactivitymimeattachment.[objectid"+O.l+O.B+"] = xxtemplate.templateid":"")}generateInsertForUpSyncTransactionLog(){const e=G.L+","+G.I+","+G.H+","+G.J;return"INSERT INTO ["+G.B+"] ("+e+") VALUES ( DATETIME('NOW'), ? , sqlite_source_id(), ?)"}getActivityEntities(e,t,n){const r=new D.a,a=[],o=[];for(const t of n)o.push(K.a.get_DefaultInstance().retrieveEntityMetadata(t,e));return Object(S.a)(o).then(e=>{for(const r of e)if(!Object(p.a)(r)){const e=r;e.get_isActivity()&&e.get_logicalName().toLowerCase()!==R.c.toLowerCase()&&n.indexOf(e.get_logicalName().toLowerCase())>=0&&(Object(p.a)(t)||t.indexOf(e.get_logicalName().toLowerCase())>=0)&&(a.push(e.get_logicalName().toLowerCase()),Object(i.d)("Offline.OfflineSqlQueryBuilder.GetActivityEntities",m.a.offlineDataStore,e.get_logicalName().toLowerCase()+"added to acitivity list"))}r.resolve(a)},e=>{Object(i.e)("Offline.OfflineSqlQueryBuilder.GetActivityEntities.Fail",m.a.offlineDataStore,e.get_Message()),r.reject(e)}),r}retrieveDataSyncStatusQuery(){return Object(g.a)("SELECT * FROM {0} ",O.v)}retrieveAllEntityMetadataOfflineInfoQuery(){return Object(g.a)("SELECT "+O.J+" FROM {0} ",O.t)}generateSuppressTriggerQuery(){return"INSERT INTO _NORSYNC_SUPPRESS_TRIGGERS(value) VALUES(1)"}generateUnsuppressTriggerQuery(){return"DELETE FROM _NORSYNC_SUPPRESS_TRIGGERS"}static get_instance(){return X||(X=new Y),X}}function J(e){let t="";switch(e){case 0:t="=";break;case q.a.NotEquals:t="<>";break;case q.a.LessThan:t="<";break;case q.a.LessThanEqualTo:t="<=";break;case q.a.GreaterThan:t=">";break;case q.a.GreaterThanEqualTo:t=">=";break;case q.a.IsNull:t="ISNULL";break;case q.a.In:t="IN"}return t}function $(e){let t="";switch(e){case H.a.Or:t="OR";break;case 0:t="AND"}return t}var Z=n("eZ32"),ee=n("8CLP"),te=n("FZk4"),ne=n("WSMw");class re{constructor(e,t){if(this._fields=[],this._fieldValue=[],Object(p.a)(t)){let t=0;for(const n in e){const r={key:n,value:e[n]};this.get_fields()[t]=r.key,this.get_fieldValue()[t]=this._GetFormattedValue(r.value),t++}}else for(let e=0;e<t.length;e++)if(t[e].get_condition()===q.a.In){const n=t[e].get_value();for(let e=0;e<n.length;e++)this.get_fieldValue().push(this._GetFormattedValue(n[e]))}else this.get_fieldValue().push(this._GetFormattedValue(t[e].get_value()))}get_fields(){return this._fields}get_fieldValue(){return this._fieldValue}_GetFormattedValue(e){return e instanceof c.a?e.toString():e}}var ae=n("MUIu"),ie=n("TRNQ");let oe=null;class se{_StoreMaxDate(e){const t={};t[x.a.MaxTimeKey]=e,K.a.get_DefaultInstance().get_LocalDataSource().saveOfflineInformation(x.a.MaxTimeKey,t,!1).then(t=>{Object(i.d)("SecurityUtil",m.a.storage,"StoreMaxDate: New Date is "+e)},e=>{Object(i.e)("SecurityUtilFailureErrors",m.a.storage,"StoreMaxDate Error: "+e.get_Message())})}_RetrieveMaxDate(){const e=new D.a;return K.a.get_DefaultInstance().get_LocalDataSource().retrieveOfflineInformation(x.a.MaxTimeKey).then(t=>{let n="";Object(p.a)(t)||!(x.a.MaxTimeKey in t)||Object(p.a)(t[x.a.MaxTimeKey])||(n=t[x.a.MaxTimeKey].toString()),Object(i.d)("SecurityUtil",m.a.storage,"RetrieveMaxDate: "+n),e.resolve(n)},t=>{Object(i.e)("SecurityUtilFailureErrors",m.a.storage,"RetrieveMaxDate Error: "+t.get_Message()),e.reject(t)}),e}isFullSyncRequired(){const e=new D.a;return this._RetrieveMaxDate().then(t=>{Object(p.b)(t)&&(t=null),this.calculateAndStoreMaxDate(t).then(n=>{Object(p.b)(t)||(t=Object(ae.b)(t)),!Object(p.a)(n)&&n>new Date(t)?e.resolve(!0):e.resolve(!1)},t=>{Object(i.e)("SecurityUtilFailureErrors",m.a.storage,"IsFullSyncRequired: CalculateAndStoreMaxDate Error: "+t.get_Message()),e.reject(t)})},t=>{Object(i.e)("SecurityUtilFailureErrors",m.a.storage,"IsFullSyncRequired: RetrieveMaxDate Error: "+t.get_Message()),e.reject(t)}),e}calculateAndStoreMaxDate(e){const t=new D.a,n=new Array(0);let r=e;Object(p.a)(e)||(e=Object(ae.b)(e),n[0]=new te.a("CreatedOn",r,H.a.Or,q.a.GreaterThan));let a=new j.a(n);const o=new ie.a;return o.retrieve("UserEntityAttributeMap",a).then(n=>{let a=new Date(e);if(n.rows.length>0)for(let e=0;e<n.rows.length;e++)if(!Object(p.a)(n.rows.item(e))){const t=n.rows.item(e).CreatedOn;if(Object(p.b)(t))Object(i.e)("SecurityUtil",m.a.storage,"CalculateAndStoreMaxDate date is not stored for row: "+e);else{const e=new Date(Object(ae.b)(t));a<e&&(a=e,r=t)}}this._StoreMaxDate(r),t.resolve(a)},n=>{if(Object(p.a)(e))Object(i.e)("SecurityUtilFailureErrors",m.a.storage,"CalculateAndStoreMaxDate retrieve data was null Error: "+n.get_Message()),t.reject(n);else{const e=new Array(0);a=new j.a(e),o.retrieve("UserEntityAttributeMap",a).then(e=>{Object(i.e)("SecurityUtil",m.a.storage,"CalculateAndStoreMaxDate retrieve data Error: "+n.get_Message()),t.reject(n)},()=>{t.resolve(new Date),this._StoreMaxDate("1970-01-01 00:00:00.000")})}}),t}static get_defaultInstance(){return Object(p.a)(oe)&&(oe=new se),oe}}var ce,le=n("ti3l");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */!function(e){e[e.trace=1]="trace",e[e.debug=2]="debug",e[e.perf=3]="perf",e[e.info=4]="info",e[e.warning=5]="warning",e[e.error=6]="error",e[e.fatal=7]="fatal"}(ce||(ce={}));var ue=n("/D1P"),de=n("XvL5"),pe=n("3c60"),fe=n("5qiD"),ge=n("d+dp"),he=n("8tWD"),me=n("/bjP"),be=n("wMH2"),ye=n("WRF3"),_e=n("V482"),ve=n("ngzy"),Se=n("c46F"),Oe=n("a1q1"),Ce=n("IzVP"),Ee=n("qCX6"),Ie=n("pah4"),we=n("Xe7f"),je=n("kGsI"),Pe=n("hirD"),Te=n("CrQY"),Ne=n("PF3G"),Ae=n("fVHw"),Re=n("XgcG"),De=n("Jz1I"),xe=n("LtP7"),Me=n("3sOn"),Fe=n("1Xob"),ke=n("bRS5"),Le=n("bK23");class Be{constructor(e,t,n,a){this._dataBaseName=null,this._userContext=null,this._profileId=null,this._authToken=null,this._norsyncServerEndpoint=null,this._sessionId=null,this._subscriptionId=null,this._isApplicationMetadataDownloadInShimEnabled=!1,this._appId=null,this._offlineResourceSrings=null,this._syncBehavior=null,this._dataBaseName=e,this._userContext=t,this._norsyncServerEndpoint=new Le.a(N.a.get_DefaultInstance().get_offlineTypescriptInterface().getNorsyncServerConnectionString()),this._authToken=n,this._syncBehavior=a;const i=N.a.get_DefaultInstance().get_offlineTypescriptInterface().getOfflineProfileId();""===this._dataBaseName||c.a.tryCreate(this._dataBaseName).equals(c.a.get_empty())||this._dataBaseName===i?this._profileId=i:this._profileId=this._dataBaseName,this._sessionId=localStorage.getItem(r.o),this._subscriptionId=N.a.get_DefaultInstance().get_offlineTypescriptInterface().getSubscriptionId(),this._isApplicationMetadataDownloadInShimEnabled=N.a.get_DefaultInstance().get_offlineTypescriptInterface().isApplicationMetadataDownloadInShimEnabled(),this._appId=N.a.get_DefaultInstance().get_offlineTypescriptInterface().getCurrentAppId();const o=N.a.get_DefaultInstance().get_offlineTypescriptInterface().getOfflineResourceStrings();this._offlineResourceSrings=this._isApplicationMetadataDownloadInShimEnabled?JSON.stringify(o):JSON.stringify([])}checkWhetherLoginParametersChanged(e){if(Object(p.a)(e))return Object(i.e)("CheckWhetherLoginParametersChanged",m.a.offlineDataStore,"Login Parameters are empty"),!0;const t=e.getObjectData(),n=this.getObjectData();for(const e in t){const r={key:e,value:t[e]};if(n[r.key]!==r.value)return Object(i.e)("CheckWhetherLoginParametersChanged",m.a.offlineDataStore,"Login Parameter"+r.key+"Changed"),!0}return Object(i.e)("CheckWhetherLoginParametersChanged",m.a.offlineDataStore,"Login Parameteres Didn't change"),!1}get_dataBaseName(){return this._dataBaseName}get_userId(){return this._userContext.get_UserId().toString()}get_port(){const e=this._norsyncServerEndpoint.get_port();return Object(p.b)(e)?0:Number.parseInvariant(e)}get_host(){return this._norsyncServerEndpoint.get_host()}get_serverDataBaseName(){return this._userContext.get_OrganizationId().toString()}get_isSSL(){return this._norsyncServerEndpoint.get_scheme()===Le.a.uriSchemeHttps}get_authToken(){return this._authToken}get_sessionId(){return this._sessionId}get_subscriptionId(){return this._subscriptionId}get_profileId(){return this._profileId}get_isApplicationMetadataDownloadInShimEnabled(){return this._isApplicationMetadataDownloadInShimEnabled}get_appId(){return this._appId}get_offlineResourceSrings(){return this._offlineResourceSrings}get_syncBehavior(){return this._syncBehavior}getObjectData(){const e={};return e.DataBaseName=this.get_dataBaseName(),e.UserId=this.get_userId(),e.Host=this.get_host(),e.Port=this.get_port().toString(),e.IsSSL=this.get_isSSL().toString(),e.ServerDataBaseName=this.get_serverDataBaseName(),e.ProfileId=this.get_profileId(),e.AuthToken=this.get_authToken(),e.SessionId=this.get_sessionId(),e.syncBehavior=this.get_syncBehavior(),e}}Be.modelVersion=-1,Be.offlineDatabasePath="/data/data/no.norsync.cordova/databases";var Ue=n("Hswk"),Ve=n("fMBw"),ze=n.n(Ve),qe=n("MXaZ"),He=n("0rLi"),We=n("iJGp"),Ge=n("/oKV");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class Ke{constructor(e,t,n){this.Query=e,this.FieldValues=t,this.ErrorMessage=n}}var Qe=n("b2mI"),Xe=n("Ydwo"),Ye=n("FZDd"),Je=n("6lVV"),$e=n("37s6"),Ze=n("xnzJ"),et=n("uZkZ"),tt=n("t9aj"),nt=n("lMS8"),rt=n("E5IU"),at=n("JEu3"),it=n("17x/"),ot=n("FdKt"),st=n("wyQO"),ct=n("Uv1Y"),lt=n("Er26"),ut=n("aOIB"),dt=n("Lyxw"),pt=n("3/02"),ft=n("a8hT"),gt=n("pEXn"),ht=n("IqkD"),mt=n("SAYH"),bt=n("sZ+8"),yt=n("KeJu");let _t=null;const vt="SingleOfflineDb";class St{constructor(){this._syncIntervalInMilliseconds=0,this._plugin=null,this._offlineMetadataManager=null,this._regenerateViews=!0,this._localContext=null,this._syncJobNode=null,this._timerId=0,this._retryWaitTime=0,this._minRetryWaitTime=3e4,this._offlineByDefaultSyncInterval=3e5,this._retryMultiplier=2,this._isRetried=!1,this._parentDataSource=null,this._userContext=null,this._immediateSyncInProgress=!1,this._periodicSyncDeferralInterval=5e3,this._entitySkipList=[R.c.toLowerCase(),R.k.toLowerCase(),R.b.toLowerCase(),R.i.toLowerCase(),R.f.toLowerCase(),R.h.toLocaleLowerCase(),R.g.toLocaleLowerCase(),R.a.toLocaleLowerCase()],this._offlineMetadataManager=new L}get_offlineMetadataManager(){return this._offlineMetadataManager}get_Plugin(){return Object(p.a)(this._plugin)&&(this._plugin=N.a.get_DefaultInstance().get_offlineTypescriptInterface().getOfflineSyncPlugin("OfflineDataSource")),this._plugin}_set_Plugin(e){return this._plugin=e,e}get_ImmediateSyncInProgress(){return this._immediateSyncInProgress}initialize(e,t,n,r){wt("OfflineDataStore.Initialize","Offline DataStore Initialize started");const a=new D.a,i=K.a.get_DefaultInstance().get_Store(),o=Object(rt.r)(i.getState());this._syncIntervalInMilliseconds=o?this._offlineByDefaultSyncInterval:e.get_organizationSettings().get_mobileOfflineSyncInterval(),this._userContext=e,Object(ke.c)(),this._parentDataSource=n,this._localContext=r,this._regenerateViews=!0;let s=N.a.get_DefaultInstance().get_offlineTypescriptInterface().getOfflineDatabaseName();return s=Object(p.a)(s)?N.a.get_DefaultInstance().get_offlineTypescriptInterface().getOfflineProfileId():s,this._offlineMetadataManager.initialize(t,n,r),this._InitAndLogin(s,e).then(()=>{wt("OfflineDataStore.Initialize","Offline data store Initialize completed succesfully"),a.resolve(!0)},e=>{It("OfflineDataStore.Initialize","Offline data store Initialize failed with error "+e.get_Message()),a.reject(e)}),a}cleanUpDatabases(e){wt("OfflineDataStore.CleanUpDatabases","Offline DataStore CleanUpDatabases started");const t=new D.a,n=c.a.tryCreate(e),r=new ve.a(n,[],""),a=new Me.a(this._userContext.get_UserId(),this._userContext.get_UserName(),this._userContext.get_UserEmail(),this._userContext.get_userRoles(),this._userContext.get_parentRootRoles(),this._userContext.get_organizationSettings(),this._userContext.get_UserSettings(),this._userContext.get_rolePrivileges(),this._userContext.get_attributePrivileges(),this._userContext.get_serverContext(),this._userContext.get_roleNames(),this._userContext.get_MetadataLastModifiedTime(),this._userContext.get_UserMetadataLastModifiedTime(),this._userContext.get_TransactionCurrencyId(),this._userContext.get_DefaultDashboardId(),this._userContext.get_DefaultHomepageId(),this._userContext.get_DefaultInteractionCentricDashboardId(),this._userContext.get_fullServerVersion(),r,this._userContext.get_externalContext(),this._userContext.get_FCBContext(),this._userContext.get_personalizationSettings(),this._userContext.get_FeatureControlSettings());return this._clearStore(e,a).then(e=>{wt("OfflineDataStore.CleanUpDatabases","Offline DataStore ClearStore succeeded. Status - "+e),t.resolve(!0)},()=>{It("CleanUpDatabases.CleanUpDatabases","cleanup database failed for database : "+e),t.reject(o.a.FromMessage("Could not delete database"))}),t}schedulePeriodicSyncJob(e,t){wt("OfflineDataStore.SchedulePeriodicSyncJob","Offline DataStore SchedulePeriodicSyncJob started"),window.__UCITestHook.syncCompleteFlag=0;const n=!Object(p.a)(t)&&t.length>0,r=new D.a,a=t&&t.length?lt.h:lt.r;return a===lt.h&&(this._immediateSyncInProgress=!0),this._StopSync(a,n).always(()=>{const n=!N.a.get_DefaultInstance().get_offlineTypescriptInterface().getServerStatus();try{this._OfflineSync(e,t).always(()=>{r.resolve(!0)}).then(()=>{wt("OfflineDataStore.SchedulePeriodicSyncJob","Offline DataStore sync finished")}).catch(e=>{this._immediateSyncInProgress=!1,It("SchedulePeriodicSyncJob.SyncFailed",e.get_Message()),r.reject(e)})}catch(e){It("SchedulePeriodicSyncJob.SyncFailed",o.a.fromGenericError(e).get_Message()),this._immediateSyncInProgress=!1,r.resolve(!1)}n||N.a.get_DefaultInstance().get_offlineTypescriptInterface().getUpSyncStatus()!==ue.a.Completed||r.resolve(!1)}),r}cancelSync(e){wt("OfflineDataStore.CancelSync","Offline DataStore CancelSync started");const t=new D.a;return this._StopSync(e).then(()=>{wt("OfflineDataStore.CancelSync","Succesfully cancel all running sync calls"),t.resolve(!0)},e=>{wt("OfflineDataStore.CancelSync","Failed to cancel all running sync calls with error "+e.get_Message().toString()),t.reject(e)}),t}_StopSync(e,t){wt("OfflineDataStore._StopSync","Offline DataStore StopSync started by "+e);const n=new D.a;return Object(p.a)(this._syncJobNode)||this._syncJobNode.completed||this._syncJobNode.cancel(),Object(p.a)(this._timerId)||!1!==t||(window.clearTimeout(this._timerId),this._timerId=0),this.get_Plugin().abort(()=>{wt("OfflineDataStore._StopSync","Succesfully stopped the all running sync calls"),n.resolve(!0)},()=>{It("OfflineDataStore._StopSync","Couldnt stop the running sync call"),n.resolve(!1)},!0,e),wt("OfflineDataStore._StopSync","Offline DataStore StopSync finished"),this._syncJobNode=null,n}applyApplicationMetadataChanges(){wt("OfflineDataStore.ApplyApplicationMetadataChanges","Offline DataStore ApplyApplicationMetadataChanges started");const e=new D.a;return this.get_Plugin().applyApplicationMetadataChanges(()=>{wt("OfflineDataStore.ApplyApplicationMetadataChanges","Succesfully applied application metadata changes"),e.resolve(!0)},t=>{It("OfflineDataStore.ApplyApplicationMetadataChanges","Could not apply application metadata changes"),e.reject(o.a.FromMessage("Failed to Apply Application Metadata changes. Error: "+t))}),wt("OfflineDataStore.ApplyApplicationMetadataChanges","Offline DataStore ApplyApplicationMetadataChanges finished"),e}_InitAndLogin(e,t){wt("OfflineDataStore._InitAndLogin","Offline DataStore InitAndLogin started");const n=new D.a,r=N.a.get_DefaultInstance().get_applicationStatusProvider().getAuthToken(),a=K.a.get_DefaultInstance().get_Store().getState(),i=Object(it.l)(a),s=new Be(e,t,r,!0===i?"OneDbPerProfile":vt);return s.checkWhetherLoginParametersChanged(_t)?(wt("InitAndLogin.LoginParameters","UserId:- "+s.get_userId()+" NorsyncServerEndpointHost:- "+s.get_host()+" NorsyncServerPort:- "+s.get_port()+" OfflineDatabasePath:- "+Be.offlineDatabasePath+" ServerDatabaseName :- "+s.get_serverDataBaseName()+" ProfileId:- "+s.get_profileId()+" ModelVersion:- "+Be.modelVersion+" UCISessionId:- "+s.get_sessionId()+" isApplicationMetadataDownloadInShimEnabled:- "+s.get_isApplicationMetadataDownloadInShimEnabled()+" AppId:- "+s.get_appId()+" OfflineResourceStrings:- "+s.get_offlineResourceSrings()+" SyncBehavior:- "+s.get_syncBehavior()),this._set_Plugin(N.a.get_DefaultInstance().get_offlineTypescriptInterface().getOfflineSyncPlugin(s.get_dataBaseName())),this.get_Plugin().login(s.get_dataBaseName(),s.get_userId(),"",s.get_host(),s.get_port(),Be.offlineDatabasePath,s.get_isSSL(),()=>{_t=s,Object(p.b)(e)&&N.a.get_DefaultInstance().get_offlineTypescriptInterface().setOfflineStatus(0,ee.a.DatabaseUnavailable),wt("InitAndLogin.LoginSuccess",s.get_dataBaseName()),n.resolve(!0)},()=>{It("InitAndLogin.LoginFailure",s.get_dataBaseName()),n.reject(o.a.FromMessage("Offline Store Initialize Failed"))},s.get_serverDataBaseName(),s.get_profileId(),Be.modelVersion,s.get_authToken(),s.get_subscriptionId(),s.get_sessionId(),s.get_isApplicationMetadataDownloadInShimEnabled(),s.get_appId(),s.get_offlineResourceSrings(),s.get_syncBehavior())):(wt("InitAndLogin.LoginSuccess","Already Logged In"),n.resolve(!0)),n}_ScheduleSync(){wt("OfflineDataStore._ScheduleSync","Offline DataStore ScheduleSync started"),Object(p.a)(this._syncJobNode)?this._syncJobNode=d.a.schedule(()=>{try{this._OfflineSync().catch(e=>{wt("OfflineDataStore._ScheduleSync",Object(ct.d)(e))})}catch(e){wt("OfflineDataStore._ScheduleSync",Object(ct.d)(e))}},d.d,"Norsync Sync"):this._syncJobNode.completed||(wt("OfflineDataStore._ScheduleSync","Offline DataStore ScheduleSync priority increased"),this._syncJobNode.priority=d.b)}_initializeUpsyncIfNeeded(e){const t=K.a.get_DefaultInstance().get_Store();return Object(rt.r)(t.getState())&&!e?this._importDependenciesAndInitializeUpsync():Promise.resolve(!0)}async _importDependenciesAndInitializeUpsync(){const e=K.a.get_DefaultInstance().get_Store();if(!N.a.get_DefaultInstance().get_offlineTypescriptInterface().getServerStatus())return wt("Sync.SkipUpsync","Skip upsync due to no network connectivity"),!1;try{const{initializeOfflineUpsyncProcessAsyncAction:t}=await Promise.resolve().then(n.bind(null,"zmAS"));wt("OfflineDataStore.Sync","Upsync Start"),await e.dispatch(t(!0))}catch(e){throw wt("OfflineDataStore.Sync","Upsync failed with exception: "+Object(ct.d)(e)),e}return!0}deferSync(){this._syncJobNode=null,this._ScheduleNextSync(!1,this._periodicSyncDeferralInterval)}_OfflineSync(e,t){const n=K.a.get_DefaultInstance().get_Store(),i=new D.a;if(Object(dt.f)(n.getState(),pt.ob)&&this._immediateSyncInProgress&&(!t||!t.length))return It("OfflineDataStore.Sync","Offline DataStore Sync deferred due to ongoing immediate sync"),this.deferSync(),i.resolve(!0),i;It("OfflineDataStore.Sync","Offline DataStore Sync started");const s=ze.a.createEvent(a.b,"DataSource").startStopwatch(),c=Object(Je.d)();this._updateIsForcedSyncState("Forced Sync started",e),N.a.get_DefaultInstance().get_offlineTypescriptInterface().setIsSyncing(!0);const l=N.a.get_DefaultInstance().get_offlineTypescriptInterface().getOfflineDatabaseName(),u=N.a.get_DefaultInstance().get_offlineTypescriptInterface().getOfflineProfileId(),d=!!Object(p.b)(l),f=d?u:l,g=[];try{this._initializeUpsyncIfNeeded(d).then(a=>{this._InitAndLogin(f,this._userContext).then(()=>{if(!a||!this._ShouldStartSyncJob())return i.resolve(!1),this._syncJobNode=null,void N.a.get_DefaultInstance().get_offlineTypescriptInterface().setIsSyncing(!1);d&&N.a.get_DefaultInstance().get_offlineTypescriptInterface().setOfflineStatus(Z.a.Initializing,null);const l=N.a.get_DefaultInstance().get_offlineTypescriptInterface().isDssOfflineEnabled();Object(h.a)(g,r.g,l.toString()),Object(h.a)(g,r.h,d.toString()),Object(h.a)(g,r.i,!Object(p.a)(e)),Object(h.a)(g,r.j,Object($e.o)(n.getState())),N.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentWarn(b,"[offlineDataStore] OfflineSync: Offline Sync Started",g);const u=new Date,m=l?this._GetClientSyncProperties(e,t):this._GetSyncProperties(),y=N.a.get_DefaultInstance().get_offlineTypescriptInterface().isApplicationMetadataDownloadInShimEnabled(),v=this._offlineMetadataManager.get_clientModelTables();this.get_Plugin().synchronize(Ot,a=>{if(Object(h.a)(g,r.n,a.type),Object(h.a)(g,r.m,a.message),N.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentWarn(b,"[offlineDataStore] OfflineSync: Offline DataStore Plugin Synchronize progress",g),y&&"on-application-metadata-download-complete"===a.type){Object(h.a)(g,r.f,y.toString());const e=!0;N.a.get_DefaultInstance().get_offlineTypescriptInterface().setApplyApplicationMetadataChanges(e),Object(h.a)(g,r.b,e.toString()),this._saveBooleanInformationToOfflineInformation(g,x.a.OfflineApplyApplicationMetadataChangesKey,e,"[offlineDataStore] OfflineSync: SaveApplyApplicationMetadataChangesInformationToSessionState.Success","[offlineDataStore] OfflineSync: saveApplyApplicationMetadataChangesInformationToSessionState.Failed"),N.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentSuccess("Offline: Application Metadata Download",g)}else if("on-data-database-reset"===a.type)Object(h.a)(g,r.m,a.message),Object(h.a)(g,r.n,a.type),N.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentWarn(b,"[offlineDataStore] OfflineSync: Data database dropped",g),N.a.get_DefaultInstance().get_offlineTypescriptInterface().setOfflineStatus(Z.a.Initializing,ee.a.MetadataChanged);else if("on-sync-complete"===a.type){const r=Object(rt.r)(n.getState());this._isImmediateSyncCompletedNeeded(r,d,e,t)?this._offlineSyncCompleted(g,a,s,d,f,l,i,u,e,t,v,c):(It(b,"OfflineSyncCompleted is scheduled to run during app idle work block"),Object(ot.b)(()=>{this._offlineSyncCompleted(g,a,s,d,f,l,i,u,e,t,v,c)},"execute offline sync complete work when app is idle"))}},n=>{this._syncJobNode=null;let a=0,s="";if(Object(p.a)(n.errorcode)||(a=n.errorcode,Object(p.a)(n.errormessage)||(s=n.errormessage)),Object(h.a)(g,r.m,n.message),Object(h.a)(g,r.n,n.type),Object(h.a)(g,r.l,a.toString()),Object(h.a)(g,r.e,s),this._addRoleBasedOfflinProfileFlagToOfflineSyncReport(g),N.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentWarn(b,"[offlineDataStore] OfflineSync: Received sync failure callback",g),y&&"on-application-metadata-download-complete"===n.type){Object(h.a)(g,r.f,y.toString()),N.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentWarn(b,"[offlineDataStore] OfflineSync: Application Metadata Download Complete with Failure",g);const e=!1;N.a.get_DefaultInstance().get_offlineTypescriptInterface().setApplyApplicationMetadataChanges(e),Object(h.a)(g,r.b,e.toString()),this._saveBooleanInformationToOfflineInformation(g,x.a.OfflineApplyApplicationMetadataChangesKey,e,"[offlineDataStore] OfflineSync: SaveApplyApplicationMetadataChangesInformationToSessionState.Success","[offlineDataStore] OfflineSync: saveApplyApplicationMetadataChangesInformationToSessionState.Failed"),N.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentFailure("Offline: Application Metadata Download",o.a.FromMessage(n.message))}else if("on-sync-complete"===n.type){Object(h.a)(g,r.c,N.a.get_DefaultInstance().get_offlineTypescriptInterface().getOfflineDatabaseName()),N.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentWarn(b,"[offlineDataStore] OfflineSync: Failure",g),n.code===_.sqlSyncUnsupportedNorsyncVersion?N.a.get_DefaultInstance().get_offlineTypescriptInterface().setOfflineStatus(null,ee.a.UpgradeClient,a,s):a===Fe.a.InvalidSubscription?N.a.get_DefaultInstance().get_offlineTypescriptInterface().setOfflineStatus(null,ee.a.ProfileUnavailable,a,s):N.a.get_DefaultInstance().get_offlineTypescriptInterface().getOfflineStatusReason()!==ee.a.MetadataChanged&&(a===Fe.a.InvalidMetadata?N.a.get_DefaultInstance().get_offlineTypescriptInterface().setOfflineStatus(null,ee.a.MetadataChanged,a,s):N.a.get_DefaultInstance().get_offlineTypescriptInterface().setOfflineStatus(null,ee.a.SyncFailure,a,s)),this._updateIsForcedSyncState("Forced Sync failed",e),this._updateImmediateOfflineDataSyncState("Immediate offline data sync failed",t,g,c),N.a.get_DefaultInstance().get_offlineTypescriptInterface().setIsSyncing(!1),t&&t.length>0?N.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentWarn(b,"[offlineDataStore] OfflineSync: Immediate sync failed. Not retying the sync as sync will continue in normal periodic sync cycle",g):this._RetrySyncAfterFailure();const l=o.a.fromErrorCodeAndMessage(a,s);N.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentFailure(lt.o.DataSync,l,"",g),i.reject(o.a.FromMessage(n.message)),window.__UCITestHook.syncCompleteFlag=a}},Be.modelVersion,e=>N.a.get_DefaultInstance().get_offlineTypescriptInterface().getMetadataSyncStatus()===w.a.InProgress?(N.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentWarn(b,"[offlineDataStore] OfflineSync: Aborting - Returning false for syncing data model changes as metadata sync is in progress",g),!1):(Object(h.a)(g,r.k,e.toString()),this._HandleDataModelChanged(g),!0),m)},e=>{this._reportComponentErrorAndReject(i,e,g)}).catch(e=>{this._reportComponentErrorAndReject(i,e,g)})},e=>{N.a.get_DefaultInstance().get_offlineTypescriptInterface().setIsSyncing(!1),this._reportComponentErrorAndReject(i,e,g)}).catch(e=>{N.a.get_DefaultInstance().get_offlineTypescriptInterface().setIsSyncing(!1),this._reportComponentErrorAndReject(i,e,g)})}catch(e){if(N.a.get_DefaultInstance().get_offlineTypescriptInterface().setIsSyncing(!1),!(e instanceof o.a)){const t="Unexpected offline sync error: "+Object(ct.d)(e);e=o.a.FromMessage(t)}N.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentError(lt.o.DataSync,"[offlineDataStore] OfflineSync: Offline sync failed with unexpected error: "+e.get_Message(),g),i.reject(e)}return i}_reportComponentErrorAndReject(e,t,n){N.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentError(lt.o.DataSync,"[offlineDataStore] OfflineSync: Upsync failed with error: "+Object(ct.d)(t),n),e.reject(this._ConvertToLegacyErrorStatus(t))}_ConvertToLegacyErrorStatus(e){return e instanceof o.a?e:e instanceof ct.a?ct.a.toLegacyErrorStatus(e):e instanceof Error?ct.a.toLegacyErrorStatus(ct.a.fromExistingError(e)):void 0}_isImmediateSyncCompletedNeeded(e,t,n,r){return!!(!e||t||!Object(p.a)(this._syncJobNode)||!Object(p.a)(n)&&n||r&&r.length>0)}async _offlineSyncCompleted(e,t,n,a,i,o,s,c,l,u,d,f){N.a.get_DefaultInstance().get_offlineTypescriptInterface().setOfflineEntityPluralNamesAction(),Object(h.a)(e,r.c,t.dbname),this._addRoleBasedOfflinProfileFlagToOfflineSyncReport(e),N.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentWarn(b,"[offlineDataStore] OfflineSync: Offline DataStore Plugin Synchronize completed",e),this._isRetried=!1,this._retryWaitTime=this._minRetryWaitTime,this._syncJobNode=null,n(),N.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentWarn(b,"[offlineDataStore] OfflineSync: Success",e);let g=v.none;o&&(g=await this._offlineMetadataManager.isDataModelChanged(d),g&&this._HandleDataModelChanged(e));const m=this._UpdateOfflineAvailableEntities(g,e);a&&(await m,this._completeFirstTimeDataSync(i,o,e)),this._CompleteOfflineSync(s,a,g,lt.o.DataSync,c,e,l,u,f),N.a.get_DefaultInstance().get_offlineTypescriptInterface().setIsSyncing(!1),window.__UCITestHook.syncCompleteFlag=1;const y=!Object(p.a)(u)&&u.length>0;this._immediateSyncInProgress=!1,this._ScheduleNextSync(y)}_addRoleBasedOfflinProfileFlagToOfflineSyncReport(e){const t=K.a.get_DefaultInstance().get_Store().getState(),n=!!Object(rt.i)(gt.b.EnableRoleBasedOfflineProfileAccess,t);Object(h.a)(e,gt.b.EnableRoleBasedOfflineProfileSetting,n);const r=Object(it.l)(t);Object(h.a)(e,gt.b.EnableServerAndNativeFCBForRoleBasedProfileAccess,r),Object(h.a)(e,gt.b.EnableRoleBasedOfflineProfileAccess,r&&n);const a=mt.a.toString(Object(ht.e)(t));Object(h.a)(e,gt.b.OfflineProfileId,a)}async _completeFirstTimeDataSync(e,t,n){N.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentWarn(b,"[offlineDataStore] OfflineSync: Initial Sync",n),N.a.get_DefaultInstance().get_offlineTypescriptInterface().setOfflineDatabaseName(e);const a={};a[x.a.OfflineDatabaseKey]=e;const i=K.a.get_DefaultInstance().get_Store();try{await i.dispatch(Object(ut.a)(x.a.OfflineDatabaseKey,a,!1)),N.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentWarn(b,"[offlineDataStore] OfflineSync: SaveOfflineDatabaseInformation.Success",n)}catch(e){Object(h.a)(n,r.e,e.message||"unknown error"),N.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentWarn(b,"[offlineDataStore] OfflineSync: SaveOfflineDatabaseInformation.Failed",n)}const o={[x.a.IsFirstTimeDataSyncCompletedKey]:!0};try{await i.dispatch(Object(ut.a)(x.a.IsFirstTimeDataSyncCompletedKey,o,!1)),N.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentWarn(b,"[offlineDataStore] OfflineSync: SaveFirstTimeDataSyncCompleted.Success",n)}catch(e){Object(h.a)(n,r.e,e.message||"unknown error"),N.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentWarn(b,"[offlineDataStore] OfflineSync: SaveFirstTimeDataSyncCompleted.Failed",n)}finally{i.dispatch(Object(et.b)(!0))}t||se.get_defaultInstance().calculateAndStoreMaxDate(null)}_ScheduleNextSync(e,t){Object(p.a)(t)&&(t=this._syncIntervalInMilliseconds),e?wt("Sync.ScheduleNextSync","Immediate entity sync completed. Next sync should run as per schedule."):(wt("Sync.ScheduleNextSync",Object(g.a)("Scheduling next sync to happen in {0} milliseconds.",t)),this._timerId=setTimeout(this._ScheduleSync.bind(this),t))}_HandleDataModelChanged(e){this._regenerateViews=!0,N.a.get_DefaultInstance().get_offlineTypescriptInterface().setCalculationOfDisabledOfflineEntitiesPending(!0),N.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentWarn(b,"[offlineDataStore] OfflineSync: ModelChanged",e)}createActivityPointerAndAttachmentView(){this._regenerateViews&&this._offlineMetadataManager.retrieveClientModelTables().then(e=>{this._CreateActivityPointerView(e)})}_CompleteOfflineSync(e,t,n,r,a,i,o,s,c){this._regenerateViews?this._offlineMetadataManager.retrieveClientModelTables().then(e=>{this._CreateActivityPointerView(e)}).always(()=>{N.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentSuccess(r,i),this._OfflineValidations(e,t,n,o,s,c)}):(N.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentSuccess(r,i),this._OfflineValidations(e,t,n,o,s,c))}_OfflineValidations(e,t,n,a,i,s){const c=[],l=K.a.get_DefaultInstance().get_Store(),u=[];Object(h.a)(u,r.h,t);const d=N.a.get_DefaultInstance().get_offlineTypescriptInterface().isApplicationMetadataDownloadInShimEnabled();Object(h.a)(u,r.f,d);const f=N.a.get_DefaultInstance().get_offlineTypescriptInterface().getApplyApplicationMetadataChanges();if(Object(h.a)(u,x.a.OfflineApplyApplicationMetadataChangesKey,f),Object(h.a)(u,x.a.IsOfflineFirstTimeSyncCompletedKey,!0),t&&d)f?(Object(h.a)(u,"offlinestatus",N.a.get_DefaultInstance().get_offlineTypescriptInterface().getOfflineStatus()),N.a.get_DefaultInstance().get_offlineTypescriptInterface().triggerFirstTimeRequestToApplyApplicationMetadataChangeNotification(),N.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentWarn(b,"[offlineDataStore] OfflineSync: Offline First Time Data Sync is Completed, but application metadata change is not applying or is not successfully applied yet.",u),N.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentWarn(b,"[offlineDataStore] OfflineSync: Offline Sync.MetadataValidation is skipped with due to pending apply metadata changes.",u),c.push((new D.a).resolve(!0))):Object($e.m)(l.getState())?(N.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentWarn(b,"[offlineDataStore] OfflineSync: Offline Sync.MetadataValidation is verified to be done.",u),l.dispatch(Object(tt.b)(!0)),this._saveBooleanInformationToOfflineInformation(u,x.a.IsOfflineFirstTimeSyncCompletedKey,t,"[offlineDataStore] OfflineSync: SaveIsOfflineFirstTimeSyncCompletedInformation.Success","[offlineDataStore] OfflineSync: SaveIsOfflineFirstTimeSyncCompletedInformation.Failed"),N.a.get_DefaultInstance().get_offlineTypescriptInterface().setOfflineStatus(Z.a.Available,ee.a.None),Object(h.a)(u,"offlinestatus",Z.a.Available),N.a.get_DefaultInstance().get_offlineTypescriptInterface().setOfflineStatus(Z.a.Available,ee.a.None),Object(h.a)(u,"offlinestatus",Z.a.Available),N.a.get_DefaultInstance().get_offlineTypescriptInterface().triggerDisplayForFirstTimeSyncCompleteNotification(),N.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentWarn(b,"[offlineDataStore] OfflineSync: Offline Sync Completed toast notification triggered",u),c.push((new D.a).resolve(!0))):c.push((new D.a).reject(o.a.FromMessage("Sync.MetadataValidation Error: metadata validation failed in previous stage during this sync.")));else if(t&&!d||N.a.get_DefaultInstance().get_offlineTypescriptInterface().getCalculationOfDisabledOfflineEntitiesPending()){const e=this._offlineMetadataManager.calculateDisabledOfflineEntities();c.push(e),e.then(()=>{N.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentWarn(b,"[offlineDataStore] OfflineSync: Offline Sync.MetadataValidation is completed",u),t&&(l.dispatch(Object(Ze.b)(!0)),this._saveBooleanInformationToOfflineInformation(u,x.a.IsFirstTimeMetadataValidationCompletedKey,!0),l.dispatch(Object(tt.b)(!0)),this._saveBooleanInformationToOfflineInformation(u,x.a.IsOfflineFirstTimeSyncCompletedKey,t,"[offlineDataStore] OfflineSync: SaveIsOfflineFirstTimeSyncCompletedInformation.Success","[offlineDataStore] OfflineSync: SaveIsOfflineFirstTimeSyncCompletedInformation.Failed")),N.a.get_DefaultInstance().get_offlineTypescriptInterface().setOfflineStatus(Z.a.Available,ee.a.None),Object(h.a)(u,"offlinestatus",Z.a.Available),N.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentWarn(b,"[offlineDataStore] OfflineSync: Foreground application metadata sync - Offline Sync Cycle is completed",u)},e=>{It("Sync.MetadataValidation","Error: "+e.get_Message())})}else N.a.get_DefaultInstance().get_offlineTypescriptInterface().setOfflineStatus(Z.a.Available,0);if(N.a.get_DefaultInstance().get_offlineTypescriptInterface().isDssOfflineEnabled())n===v.offlineProfile&&N.a.get_DefaultInstance().get_offlineTypescriptInterface().setOfflineProfileChanged(!0);else{const e=this._CheckForOfflineProfileChange();if(c.push(e),e.then(e=>{e&&N.a.get_DefaultInstance().get_offlineTypescriptInterface().setOfflineProfileChanged(!0)}),!t){const e=se.get_defaultInstance().isFullSyncRequired();c.push(e),e.then(e=>{e&&N.a.get_DefaultInstance().get_offlineTypescriptInterface().setDatabaseCleanUpFlag(!0)},e=>{It("Sync.IsFullSyncRequired","Error: "+e.get_Message())})}}return Object(S.a)(c).then(()=>{const t=this._offlineMetadataManager.isServerMetadataSyncRequired();N.a.get_DefaultInstance().get_offlineTypescriptInterface().processOfflineValidationsComplete(void 0),It("Sync.OfflineValidation","OfflineSync validation succeeded, sync required is "+t),this._updateIsForcedSyncState("Forced sync completed",Object(p.a)(a)?a:!a,!0),this._updateImmediateOfflineDataSyncState("Immediate offline data sync completed",i,u,s),e.resolve(t)},t=>{It("Sync.OfflineValidation","OfflineSync validation failed"),this._updateIsForcedSyncState("Forced sync completed",Object(p.a)(a)?a:!a),this._updateImmediateOfflineDataSyncState("Immediate offline data sync completed",i,u,s),e.reject(t)}),e}_RetrySyncAfterFailure(){this._isRetried||(this._isRetried=!0,this._retryWaitTime=this._minRetryWaitTime),this._retryWaitTime<this._syncIntervalInMilliseconds&&(window.setTimeout(()=>{wt("Sync.Retry","Retrying after failure"),this._ScheduleSync()},this._retryWaitTime),this._retryWaitTime=this._retryMultiplier*this._retryWaitTime)}_CheckForOfflineProfileChange(){wt("OfflineDataStore._CheckForOfflineProfileChange","Offline DataStore CheckForOfflineProfileChange started");const e=new D.a,t=[new te.a("systemuserid",N.a.get_DefaultInstance().get_offlineTypescriptInterface().getUserId().toString(),0,0)],n=new j.a(t);return this.retrieveLocalEntities("_systemuser",n).then(t=>{Object(p.a)(t)||!t.rows.length?(It("CheckForOfflineProfileChange.NosystemUser","No system user records found in offline db."),e.reject(o.a.FromMessage("No system user records found in offline db."))):!("mobileofflineprofileid"+O.l+O.B in t.rows.item(0))||Object(p.a)(t.rows.item(0)["mobileofflineprofileid"+O.l+O.B])||t.rows.item(0)["mobileofflineprofileid"+O.l+O.B].toString().toLowerCase()!==N.a.get_DefaultInstance().get_offlineTypescriptInterface().getOfflineProfileId().toLowerCase()?(wt("CheckForOfflineProfileChange.Detected","Offline Profile Change detected on offline sync completion"),e.resolve(!0)):e.resolve(!1)},t=>{It("CheckForOfflineProfileChange.RetrieveSystemUserFailed",t.get_Message()),e.reject(t)}),e}_ShouldStartSyncJob(){if(N.a.get_DefaultInstance().get_offlineTypescriptInterface().getServerStatus())if(N.a.get_DefaultInstance().get_offlineTypescriptInterface().getMetadataSyncStatus()===w.a.InProgress)wt("Sync.NotStarted","Sync not started because metadata sync is in progress.");else{if(N.a.get_DefaultInstance().get_offlineTypescriptInterface().getUpSyncStatus()===ue.a.Completed)return!0;wt("Sync.NotStarted","Sync not started because upsync is not yet completed.")}else wt("Sync.NotStarted","Sync not started due to no network connectivity");return!1}_updateIsForcedSyncState(e,t,n){if(!Object(p.a)(t)){const r=K.a.get_DefaultInstance().get_Store();if(!Object($e.n)(r.getState())&&t)It("OfflineDataStore.Sync","Offline DataStore Sync "+e),r.dispatch(Object(Je.g)(t));else if(Object($e.n)(r.getState())&&!t&&(It("OfflineDataStore.Sync","Offline DataStore Sync "+e),r.dispatch(Object(Je.g)(t)),n)){const e=Object($e.i)(r.getState());e&&r.dispatch(Object(at.b)(!0)),r.dispatch(Object(nt.e)(e))}}}_updateImmediateOfflineDataSyncState(e,t,n,a){const i=K.a.get_DefaultInstance().get_Store();t&&t.length>0&&(It("OfflineDataStore.Sync","Offline DataStore Sync "+e),Object($e.o)(i.getState())&&a===Object(Je.d)()&&(i.dispatch(Object(Je.h)(!1)),Object(Je.f)(),Object(h.b)(n,r.j,Object($e.o)(i.getState()))))}_GetSyncProperties(){const e=Object(qe.E)(K.a.get_DefaultInstance().get_UserContext()),t=K.a.get_DefaultInstance().get_UserContext().get_TimeZoneAdjusters(),n=Object(qe.s)(e,Object(qe.Q)(t)),r=new Date(e.getTime()+n),a=this._userContext.get_TimeZoneUtcOffsetMinutes()*pe.i,i={};return i.$_NORSYNC_CURRENT_TIME=String.format("'{0}-{1:D2}-{2:D2} {3:D2}:{4:D2}:{5:D2}.{6:D3}'",r.getFullYear(),r.getMonth()+1,r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds()),i.$_NORSYNC_TIMEZONE_OFFSET=a.toString(),i.$_NORSYNC_DST_ADJUSTMENT=n.toString(),i}_GetClientSyncProperties(e,t){const n=N.a.get_DefaultInstance().get_offlineTypescriptInterface().isUCIOfflineSyncAdaptivePagingEnabled(),r={};return r.IsUCIOfflineSyncAdaptivePagingEnabled=n.toString(),r.IsForcedSync=e||t&&t.length>0?"true":"false",r.ImmediateOfflineDataSyncEntities=t&&t.length>0?JSON.stringify(t):JSON.stringify([]),r}_GetNonCrmTables(){const e={};return e[G.l]=G.h,e[G.n]=G.f,e[G.b]=G.a,e}cache(e,t,n){if(N.a.get_DefaultInstance().get_offlineTypescriptInterface().getUpSyncStatus()!==ue.a.Completed)return;const r=[];r.push(this._CacheCreateOrUpdateQueryIfExists(e,t,n));const a=e.get_globalNavigationData();!Object(p.a)(a)&&"bpfDefinitionVersionNumber"in a.fields&&delete a.fields.bpfDefinitionVersionNumber,!Object(p.a)(a)&&Ee.a.get_instance().get_offlineDataSource().isEntityAvailableForOfflineUsage(a.get_identifier().LogicalName)&&r.push(this._CacheCreateOrUpdateQueryIfExists(a,t,n)),Object(S.a)(r).then(t=>{this._ExecuteQueriesInTransaction(t).then(()=>{wt("OfflineDataStore.Cache.Success",e.get_identifier().toString())})},t=>{It("OfflineDataStore.Cache.SqlPreparationFailure",e.get_identifier().toString()+" - "+t.get_Message())})}_CacheCreateOrUpdateQueryIfExists(e,t,n){const r=new D.a;return K.a.get_DefaultInstance().retrieveEntityMetadata(e.get_identifier().LogicalName,null).then(a=>{Object(p.a)(e.get_identifier().Id)||K.a.get_DefaultInstance().getAttributeTypes(e.get_identifier().LogicalName,null,t).then(i=>{const o=e.get_fieldTypes();for(const e in o)o[e]===P.a.Unknown&&(o[e]=i[e]);this._DoesRecordExistsInOffline(e.get_identifier(),a.get_primaryIdAttribute()).then(i=>{let o;if(i){const r=e.fields;for(const t in r){const n={key:t,value:r[t]};e.get_changedFieldNames().push(n.key)}o=this._UpdateInternal(e.get_identifier(),e,!0,t,!0,n)}else o=this._CreateInternal(e,!0,a,e.get_identifier().Id,n);o.then(e=>{r.resolve(e)},e=>{r.reject(e)})},t=>{It("OfflineDataStore.Cache.CheckForRecordFailure",e.get_identifier().toString()+" - "+t)})},t=>{It("OfflineDataStore.Cache.GetAttributeTypes.Failure",e.get_identifier().toString()+" - "+t.get_Message())})},t=>{It("OfflineDataStore.Cache.RetrieveEntityMetadata.Failure",e.get_identifier().toString()+" - "+t.get_Message())}),r}_DoesRecordExistsInOffline(e,t){const n=new D.a,r=Y.get_instance().generateExistsQuery(e,t),a=[e.Id.toString()];return this._plugin.transaction(t=>{t.executeSql(r,a,(e,t)=>{if(Object(p.a)(t.rows)||1!==t.rows.length)return void n.reject("OfflineDataStore.Cache._DoesRecordExistsInOffline Only one record should be returned");const r=t.rows.item(0);let a=!1;for(const e in r){a={key:e,value:r[e]}.value}n.resolve(a)},(t,r)=>{It("OfflineDataStore.Cache._SqlExecutionFailure",`${e.toString()} - ${t}`),n.reject(t)})},(t,r)=>{It("OfflineDataStore.Cache._TransactionFailure",`${e.toString()} - ${r}`),n.reject(r)},null),n}_RemoveDisassociateRequests(e){const t=e.get_requests();for(let e=t.length-1;e>=0;e--)t[e]instanceof je.a&&t.splice(e,1);return 1===t.length?t[0]:e}execute(e,t,n){const r=new D.a;wt("OfflineDataStore.Execute","Offline DataStore Execute started");const a=e instanceof Pe.a?this._RemoveDisassociateRequests(e):e;return a instanceof we.a?(wt("OfflineDataStore.Execute","This looks like a create request. Calling Offline.Create"),this.create(a.get_target(),a.get_suppressDuplicateDetection(),t,n).then(e=>{const t=new Ae.a(e.Id);t.set_entityReference(e),wt("OfflineDataStore.Execute","Create completed succesfully: "+e.toString()),r.resolve(t)},e=>{It("OfflineDataStore.Execute.Fail","Create request failed with error "+e.get_Message()),r.reject(e)})):a instanceof Ne.a?(wt("OfflineDataStore.Execute","This looks like a update request. Calling Offline.Update"),this.update(a.get_target().get_actionableIdentifier(),a.get_target(),a.get_suppressDuplicateDetection(),t,n).then(e=>{const t=new xe.a(e);wt("OfflineDataStore.Execute","Update completed succesfully: "+e.toString()),r.resolve(t)},e=>{It("OfflineDataStore.Execute.Fail","Update request failed with error "+e.get_Message()),r.reject(e)})):a instanceof Pe.a?(wt("OfflineDataStore.Execute","This looks like a ExecuteMultipleRequest request. Calling Offline._ExecuteMultipleRequest"),this._ExecuteMultiple(a,t,n).then(e=>{const t=new Array(0);for(let n=0;n<e.length;n++){wt("OfflineDataStore.Execute",`ExecuteMultipleRequest adding ${e[n].toString()} to ExecuteMultiple request`);const r=new xe.a(e[n]);t.push(new _e.a(null,n,r))}wt("OfflineDataStore.Execute","ExecuteMultipleRequest completed succesfully");const n=new Re.a(!1,t);r.resolve(n)},e=>{It("OfflineDataStore.Execute.Fail","ExecuteMultipleRequest request failed with error "+e.get_Message()),r.reject(e)})):a instanceof Te.a?(wt("OfflineDataStore.Execute","This looks like a quick find request. Calling Offline.QuickFind"),this.quickFind(a.get_searchText(),a.get_entityNames()[0],t).then(e=>{wt("OfflineDataStore.Execute","Quick find completed succesfully");const t=[e];r.resolve(new De.a(Oe.a.createFromEntities(t)))},e=>{It("OfflineDataStore.Execute.Fail","Quick find request failed with error "+e.get_Message()),r.reject(e)})):(It("OfflineDataStore.Execute.Fail","This request is not supported in offline."),r.reject(o.a.FromMessage("The provided request is not supported in offline"))),r}quickFind(e,t,n){const r=new D.a,a=new Ce.a(u.a.savedView,s.a.Desktop,t,0,!1,null,l.a.quickFindSearch);return K.a.get_DefaultInstance().retrieveMultipleApplicationMetadata(a,n).then(a=>{if(a.length){const i=a[0].getDescriptor();let s=null,c=null,l=null;i&&"OfflineSqlQuery"in i&&(s="string"==typeof i.OfflineSqlQuery?i.OfflineSqlQuery:null),i&&"ViewId"in i&&(c="string"==typeof i.ViewId?i.ViewId:null),i&&"FetchXml"in i&&(l="string"==typeof i.FetchXml?i.FetchXml:null);const u=new me.a;u.updateDescriptorSet(he.a.Sql,s);const d=new Ie.a(u,e,[t],c);s=d.get_sql(K.a.get_DefaultInstance().get_UserContext()),d.set_FetchXml(l),Object(p.b)(s)?(It("OfflineDataStore.QuickFind.Fail","Quick find sql not available for offline"),r.reject(o.a.fromErrorCode(-2147093989))):(wt("OfflineDataStore.QuickFind","Updated sql query: "+s),K.a.get_DefaultInstance().retrieveMultiple(d,new ge.a(fe.a.NotCached,0),n).then(e=>{wt("OfflineDataStore.QuickFind","QuickFind succeeded"),r.resolve(new Se.a(t,e,0))},e=>{It("OfflineDataStore.QuickFind.Fail",e.get_Message()),r.reject(e)}))}else It("OfflineDataStore.QuickFind.Fail","Quick find view not available for offline"),r.reject(o.a.fromErrorCode(-2147093989))},e=>{It("OfflineDataStore.QuickFind.Fail",e.get_Message()),r.reject(e)}),r}create(e,t,n,r,a){jt("OfflineDataStore.Create","Create started","Create",e.get_identifier());const i=new D.a;return a=!Object(p.a)(a)&&a,K.a.get_DefaultInstance().retrieveEntityMetadata(e.get_identifier().LogicalName,null).then(t=>{const n=t,o=Object(p.a)(e.get_identifier().Id)||e.get_identifier().Id.equals(c.a.get_empty())?Object(p.a)(e.fields[n.get_primaryIdAttribute()])?c.a.newGuid():e.fields[n.get_primaryIdAttribute()]:e.get_identifier().Id;this._CreateInternal(e,a,n,o,r,!0).then(t=>{this.get_Plugin().transaction(n=>{const r=[];this._UpdateAndExecuteQueries(n,r,t),Object(S.a)(r).then(t=>{e.get_identifier().Id=o,jt("OfflineDataStore.Create","Create succeeded","Create",e.get_identifier()),i.resolve(e.get_identifier())},t=>{jt("OfflineDataStore.Create.Fail",t.get_Message(),"Create",e.get_identifier()),i.reject(t)})},Ct(i,"Create"),null)},t=>{jt("OfflineDataStore.Create.Fail",t.get_Message(),"Create",e.get_identifier()),i.reject(t)})},t=>{jt("OfflineDataStore._Create.Fail, Cannot retrieve entity metadata",t.get_Message(),"Create",e.get_identifier()),i.reject(t)}),i}_CreateUpSyncTransactionLog(e,t){const n=new D.a;if(t)n.resolve();else{const t=[],r=e?G.E:G.F;t.push(new Ke(Y.get_instance().generateInsertForUpSyncTransactionLog(),[r,G.o],"Transaction.Create")),n.resolve(t)}return n}_ExecuteQueriesInTransaction(e){const t=new D.a;return this.get_Plugin().transaction(n=>{const r=[];e.forEach(e=>{this._UpdateAndExecuteQueries(n,r,e)}),Object(S.a)(r).then(e=>{t.resolve(e)},e=>{It("OfflineDataStore._ExecuteQueriesInTransaction.Fail",e.get_Message()),t.reject(e)})},Ct(t,"ExecuteQueriesInTransaction"),null),t}_UpdateAndExecuteQueries(e,t,n){for(let r=0;r<n.length;r++){const a=n[r],i=a.Query.replace(new RegExp("^@ActivityParty@[0-9]+"),"");t.push(this._ExecuteInternal(e,i,a.FieldValues))}}_GetEntityIdAttributeFromBpfEntity(e,t){const n=new D.a;return K.a.get_DefaultInstance().retrieveMultipleAttributeMetadata(new A.a(e),null).then(e=>{let r=null;const a=[];a.push("createdby"),a.push("modifiedby"),a.push("createdonbehalfbyname"),a.push("modifiedonbehalfbyname");for(const n of e){const e=n;if(!(a.indexOf(e.get_logicalName())>=0)&&(e.get_type()===P.a.Lookup&&!Object(p.a)(e.get_targets())&&1===e.get_targets().length&&e.get_targets()[0]===t)){if(!e.get_isCustomAttribute()){r=e;break}e.get_logicalName().startsWith("bpf_")&&(Object(p.a)(r)||r.get_columnNumber()>e.get_columnNumber())&&(r=e)}}Object(p.a)(r)?n.reject(o.a.FromMessage("OfflineDataStore.getEntityIdAttributeFromBpfEntity.Fail : Cannot find an attribute that matches the lookup target in the entity ")):n.resolve(r.get_logicalName())},t=>{wt("OfflineDataStore.getEntityIdAttributeFromBpfEntity.Fail"," Cannot fetch attribute metadata for "+e),n.reject(t)}),n}_CreateInternal(e,t,n,r,a,i){const s=new D.a;if(Object(p.a)(e.get_identifier())&&(It("OfflineDataStore.Create.Fail","Entity Record Identifier cannot be null"),s.reject(o.a.FromMessage("Entity Record Identifier cannot be null"))),i=!Object(p.a)(i)&&i){const i=new we.a(e);N.a.get_DefaultInstance().get_offlineTypescriptInterface().createCustomOfflineCommandQueries(i,e.get_identifier().LogicalName,r,a).then(a=>{Object(p.a)(a)?this._DoCreateInternal(s,e,t,n,r):s.resolve(this._PrepareFinalQueryList(a,t))},e=>{It("OfflineDataStore.Create.CreateCustomOfflineCommandQueries.Fail",e.get_Message()),s.reject(e)})}else this._DoCreateInternal(s,e,t,n,r);return s}_DoCreateInternal(e,t,n,r,a){const i=[];B.a.getOfflineQueryDataObject(t,le.a.create,r.get_primaryIdAttribute(),a,r,this._userContext).then(o=>{if(i.push(new Ke(Y.get_instance().generateInsertQuery(t.get_identifier(),o.get_columns()),o.get_values(),"Transaction.Create")),r.get_isActivity()&&!Object(p.a)(o.get_partiesToCreate())){t.get_identifier().Id=a;let e=0;for(const t of o.get_partiesToCreate()){const n="@ActivityParty@"+e+Y.get_instance().generateInsertQuery(t[O.u],t[O.m]);i.push(new Ke(n,t[O.eb],"Transaction.Create")),e++}}e.resolve(this._PrepareFinalQueryList(i,n))},t=>{It("OfflineDataStore.Create.GetOfflineQueryDataObject.Fail",t.get_Message()),e.reject(t)})}_PrepareFinalQueryList(e,t,n){const r=[];if(t&&(wt("OfflineDataStore.PrepareFinalQuerySet","called with triggers suppressed"),r.push(new Ke(Y.get_instance().generateSuppressTriggerQuery(),null,"Transaction.SuppressTrigger.Failed"))),!Object(p.a)(n))for(let e=0;e<n.length;e++)r.push(n[e]);for(let t=0;t<e.length;t++)r.push(e[t]);return t&&r.push(new Ke(Y.get_instance().generateUnsuppressTriggerQuery(),null,"Transaction.UnSuppressTrigger.Failed")),r}executeTransaction(e){wt("OfflineDataStore.ExecuteTransaction","Offline DataStore ExecuteTransaction started");const t=new D.a,n=e.get_txList(),r=e.get_supppressTrigger();return this.prepareTransactionQueries(e).then(e=>{this._ExecuteTransactionInternal(r,e,n,t)},e=>{It("OfflineDataStore.ExecuteTransaction.Fail",e.get_Message()),t.reject(e)}),t}prepareTransactionQueries(e){const t=new D.a,n=e.get_txList(),r=e.get_supppressTrigger();return this.generateUID().then(e=>{const a=[];r&&a.push(new Ke(Y.get_instance().generateSuppressTriggerQuery(),null,"Transaction.SuppressTrigger.Failed"));const i=[];for(let t=0;t<n.length;t++){const r=Object(p.a)(n[t].filter)?null:n[t].filter.get_filterCriteria(),o=new re(n[t].values,r);let s="";if(o.get_fields().length>0||n[t].operationType===ne.a)switch(n[t].operationType){case ne.b:s=Y.get_instance().generateInsertQuery(new ye.a(n[t].tableName,e),o.get_fields()),a.push(new Ke(s,o.get_fieldValue(),"Transaction.Create"));break;case ne.a:s=Y.get_instance().generateDeleteQuery(new ye.a(n[t].tableName,e),n[t].filter),a.push(new Ke(s,o.get_fieldValue(),"Transaction.Delete"));break;case ne.d:let r="";const c=this._GetNonCrmTables();if(n[t].tableName in c&&!Object(p.a)(c[n[t].tableName])){r=c[n[t].tableName].toString();const i=this._GenerateUpdateQuery(n[t],o,e,r);a.push(new Ke(i.query,i.fieldValue,"Transaction.Update"))}else{const r=n[t].tableName.startsWith(G.y)?n[t].tableName.replace(G.y,""):n[t].tableName;i.push(this._GetUpdateQueryFromMetadata(n[t],o,e,r))}}}i.length<=0?t.resolve(a):Object(S.a)(i).then(e=>{for(const t of e)a.push(new Ke(t.query,t.fieldValue,"Transaction.Update"));t.resolve(a)},e=>{It("OfflineDataStore.ExecuteTransaction.Fail",e.get_Message()),t.reject(e)})},e=>{It("OfflineDataStore.ExecuteTransaction._plugin.Transaction",e.get_Message()),t.reject(e)}),t}_GetUpdateQueryFromMetadata(e,t,n,r){const a=new D.a;return K.a.get_DefaultInstance().retrieveEntityMetadata(r,null).then(r=>{a.resolve(this._GenerateUpdateQuery(e,t,n,r.get_primaryIdAttribute()))},e=>{a.reject(e)}),a}_GenerateUpdateQuery(e,t,n,r){const a=[];let i=null;const o=new Array(0);let s=-1;for(let e=0;e<t.get_fields().length;e++)t.get_fields()[e].toString()!==r?(o[o.length]=t.get_fields()[e].toString(),a.push(t.get_fieldValue()[e])):s=e;-1!==s&&a.push(t.get_fieldValue()[s]),i=Y.get_instance().generateUpdateQuery(new ye.a(e.tableName,n),o,r);const c={};return c.query=i,c.fieldValue=a,c}_ExecuteTransactionInternal(e,t,n,r){const a=new D.a;e&&t.push(new Ke(Y.get_instance().generateUnsuppressTriggerQuery(),null,"Transaction.UnSuppressTrigger.Failed")),this._plugin.transaction(r=>{wt("OfflineDataStore.ExecuteTransaction._plugin.Transaction","Succeeded");const i=e?n.length+2:n.length;for(let e=0;e<i;e++){const n=t[e];r.executeSql(n.Query,n.FieldValues,null,Et(a,n.ErrorMessage))}},Ct(r,"Transaction failed!"),()=>{r.resolve(!0)})}generateUID(){wt("OfflineDataStore.GenerateUID","Offline DataStore GenerateUID started");const e=new D.a;return this.get_Plugin().generateUUID(t=>{const n=c.a.tryCreate(t);n.equals(c.a.get_empty())?(It("OfflineDataStore.GenerateUID","Invalid GUID returned from generateUUID: "+t),e.reject(o.a.FromMessage("Invalid GUID generated"))):(wt("OfflineDataStore.GenerateUID","Generated GUID - "+n),e.resolve(n))},()=>{It("OfflineDataStore.GenerateUID","Unknown error generating the UUID"),e.reject()}),e}retrieveLocalEntities(e,t){return this._retrieveLocalEntitiesWithOrder(e,t,null,!1)}_retrieveLocalEntitiesWithOrder(e,t,n,r){const a=t,i=Object(p.a)(a)?null:a.get_filterCriteria();wt("OfflineDataStore.RetrieveLocalEntitiesWithOrder","Offline DataStore RetrieveLocalEntitiesWithOrder started");const s=new D.a,c=[];if(!Object(p.a)(i))for(let e=0;e<i.length;e++)if(i[e].get_condition()===q.a.In){const t=i[e].get_value();for(let e=0;e<t.length;e++)c.push(t[e])}else i[e].get_condition()!==q.a.IsNull&&c.push(i[e].get_value());const l=Y.get_instance().generateRetrieveQueryWithConditions(e,a,n,r);return this.get_Plugin().transaction(e=>{e.executeSql(l,c,(e,t)=>{wt("OfflineDataStore.RetrieveLocalEntitiesWithOrder.Plugin.Transaction","RetrieveLocalEntitiesWithOrder succeeded"),s.resolve(t)},Et(s,"Retrieve_DAL"))},Ct(s,"Retrieve_Dal"),()=>{s.reject(o.a.FromMessage("No records found"))}),s}_RetrieveBPFUniqueNames(e,t){const n=new D.a;if(Object(p.a)(e))return n.resolve(null),n;if(null!==e.get_processId()&&!e.get_processId().Id.equals(c.a.get_empty()))return this._RetrieveBPFUniqueNameByProcessId(e.get_processId().Id,t).then(t=>{Object(p.b)(t)?(It("OfflineDataStore.RetrieveBPFUniqueNames.Success","Not found uniquename for BPF "+e.get_processId().toString()),n.resolve(null)):(wt("OfflineDataStore.RetrieveBPFUniqueNames.Success","Successfully retrieve uniquename for BPF "+e.get_processId().toString()),n.resolve([t]))},t=>{It("OfflineDataStore.RetrieveBPFUniqueNames.Fail","Error to RetrieveBPFUniqueNameByProcessId for BPF "+e.get_processId().toString()+". "+t.get_Message()),n.reject(t)}),n;if(Object(p.a)(e.get_target())||Object(p.b)(e.get_target().LogicalName))return It("OfflineDataStore.RetrieveBPFUniqueNames.Fail","Assert: Target must participating entity logical name. "+this._GetLogStringForRetrieveProcessControlRequest(e)),n.resolve(null),n;const r=N.a.get_DefaultInstance().get_offlineTypescriptInterface().getCurrentAppId(),a=new He.a("bpfselector",null,e.get_target().LogicalName,null,[],!1,We.a.OnDemandWithContext,null,null,new c.a(r));return K.a.get_DefaultInstance().getClientMetadata(a,Ge.a.Local,t).then(t=>{if("BPFSelectors"in t){const r=t.BPFSelectors[0];if(!Object(p.a)(r)&&"SelectorItems"in r){const t=r.SelectorItems;if(!Object(p.a)(t)&&t.length>0){const r=t.map(e=>e.UniqueName);wt("OfflineDataStore.RetrieveBPFUniqueNames.Success","Successfully retrieve all BPF uniquenames for participating entity "+e.get_target().LogicalName),n.resolve(r)}}}n.resolve(null)},t=>{It("OfflineDataStore.RetrieveBPFUniqueNames.Warn","Error to GetClientMetadata for participating entity "+e.get_target().LogicalName+". "+t.get_Message()),n.resolve(null)}),n}_RetrieveBPFUniqueNameByProcessId(e,t){const n=new D.a,r=new He.a("businessprocessflow",null,"workflow",e,[],!1,We.a.OnDemandWithContext,null,null,null);return K.a.get_DefaultInstance().getClientMetadata(r,Ge.a.Local,t).then(t=>{let r=null;if("BusinessProcessFlowMetadata"in t){const e=t.BusinessProcessFlowMetadata[0];!Object(p.a)(e)&&"BusinessProcessFlowUniqueName"in e&&(r=e.BusinessProcessFlowUniqueName)}wt("OfflineDataStore.RetrieveBPFUniqueNameByProcessId.Success","Successfully retrieve uniquename for BPF "+e.toString()),n.resolve(r)},t=>{It("OfflineDataStore.RetrieveBPFUniqueNameByProcessId.Warn","Error to GetClientMetadata for process "+e.toString()+". "+t.get_Message()),n.resolve(null)}),n}_ConstructBpfRecord(e,t,n,r){const a=new D.a;return K.a.get_DefaultInstance().retrieveEntityMetadata(t,r).then(i=>{K.a.get_DefaultInstance().getAttributeTypes(t,null,r).then(r=>{Object(ke.a)(e,r,i,n).then(e=>{wt("OfflineDataStore._ConstructBpfRecord.Success","Successfully constructed Bpf record for "+t),a.resolve(e)},e=>{It("OfflineDataStore._ConstructBpfRecord.Fail","Error to CreateEntityRecord for "+t+". "+e.get_Message()),a.reject(e)})},e=>{It("OfflineDataStore._ConstructBpfRecord.Fail","Error to GetAttributeTypes for "+t+". "+e.get_Message()),a.reject(e)})},e=>{It("OfflineDataStore._ConstructBpfRecord.Fail","Error to RetrieveEntityMetadata for "+t+". "+e.get_Message()),a.reject(e)}),a}_RetrieveBpfInstanceRecordByProcess(e,t,n,r){const a=new D.a;return this._GetEntityIdAttributeFromBpfEntity(t,e.LogicalName).then(i=>{const o=new j.a([new te.a(i+"!id",e.Id.toString(),H.a.Or,0)],1);this._retrieveLocalEntitiesWithOrder(t,o,"modifiedon",!1).then(i=>{!Object(p.a)(i.rows)&&i.rows.length>0?(wt("OfflineDataStore._RetrieveBpfInstanceRecordByProcess.Success","Data present for "+t),this._ConstructBpfRecord(i.rows.item(0),t,n,r).then(e=>{wt("OfflineDataStore._RetrieveBpfInstanceRecordByProcess.Success","Record created for "+t),a.resolve(e)},n=>{It("OfflineDataStore._RetrieveBpfInstanceRecordByProcess.Fail","Error to ConstructBpfRecord for BPF entity "+t+" and participating entity "+e.LogicalName+". "+n.get_Message()),a.resolve(null)})):(wt("OfflineDataStore._RetrieveBpfInstanceRecordByProcess.Success","No BPF instance found for "+t),a.resolve(null))},n=>{It("OfflineDataStore._RetrieveBpfInstanceRecordByProcess.Fail","Error to RetrieveLocalEntitiesWithOrder for BPF entity "+t+" and participating entity "+e.LogicalName+". "+n.get_Message()),a.resolve(null)})},n=>{It("OfflineDataStore.RetrieveBpfInstanceRecordByProcess.Fail","Error to GetEntityIdAttributeFromBpfEntity for BPF entity "+t+" and participating entity "+e.LogicalName+". "+n.get_Message()),a.resolve(null)}),a}_RetrieveBpfInstanceRecordById(e,t,n,r){const a=new D.a,i=new j.a([new te.a("businessprocessflowinstanceid",e.toString(),H.a.Or,q.a.Equals)]);return this.retrieveLocalEntities(t,i).then(i=>{!Object(p.a)(i.rows)&&i.rows.length>0?(wt("OfflineDataStore.RetrieveBpfInstanceRecordById.Success","Data present for "+t),this._ConstructBpfRecord(i.rows.item(0),t,n,r).then(e=>{wt("OfflineDataStore.RetrieveBpfInstanceRecordById.Success","Record created for "+t),a.resolve(e)},e=>{It("OfflineDataStore.RetrieveBpfInstanceRecordById.Fail","Error to ConstructBpfRecord for BPF entity "+t+". "+e.get_Message()),a.resolve(null)})):(wt("OfflineDataStore.RetrieveBpfInstanceRecordById.Success","No BPF instance found for "+t+" with instance id "+e.toString()),a.resolve(null))},e=>{It("OfflineDataStore._RetrieveBpfInstanceRecordById.Fail","Error to RetrieveLocalEntities for BPF entity "+t+". "+e.get_Message()),a.resolve(null)}),a}_GetLogStringForRetrieveProcessControlRequest(e){let t="";return Object(p.a)(e)||(Object(p.a)(e.get_target())?Object(p.a)(e.get_processId())?Object(p.a)(e.get_processInstanceId())||(t+=", BPF Instance "+e.get_processInstanceId().Id.toString()):t+=", BPF Process "+e.get_processId().Id.toString():t="Participating entity "+e.get_target().LogicalName),t}_RetrieveGlobalNavigationDataRecord(e,t,n,r){const a=new D.a;return!t||Object(p.a)(e)?(a.resolve(null),a):(this._RetrieveBPFUniqueNames(e,r).then(t=>{if(Object(p.a)(t)||!t.length)return void a.resolve(null);const i=[];null===e.get_processId()||e.get_processId().Id.equals(c.a.get_empty())||null===e.get_processInstanceId()||e.get_processInstanceId().Id.equals(c.a.get_empty())?t.forEach(t=>{i.push(this._RetrieveBpfInstanceRecordByProcess(e.get_target(),t,n,r)),wt("OfflineDataStore.RetrieveGlobalNavigationDataRecord.Info","Retrieve multiple BPF instances. "+this._GetLogStringForRetrieveProcessControlRequest(e))}):(i.push(this._RetrieveBpfInstanceRecordById(e.get_processInstanceId().Id,t[0],n,r)),wt("OfflineDataStore.RetrieveGlobalNavigationDataRecord.Info","Retrieve BPF instance from "+t[0]+". "+this._GetLogStringForRetrieveProcessControlRequest(e))),Object(S.a)(i).then(t=>{let n=null,r=null;t.forEach(e=>{if(null!==e){const t=e.getValue("modifiedon");(null===r||t>r)&&(n=e,r=t)}}),wt("OfflineDataStore.RetrieveGlobalNavigationDataRecord.Success","Retrieve multiple BPF instances. "+this._GetLogStringForRetrieveProcessControlRequest(e)),a.resolve(n)},t=>{It("OfflineDataStore.RetrieveGlobalNavigationDataRecord.Fail","Errot to RetrieveBpfInstanceRecord. "+this._GetLogStringForRetrieveProcessControlRequest(e)+". "+t.Message),a.resolve(null)})},t=>{It("OfflineDataStore.RetrieveGlobalNavigationDataRecord.Fail","Errot to RetrieveBPFUniqueNames. "+this._GetLogStringForRetrieveProcessControlRequest(e)+". "+t.get_Message()),a.resolve(null)}),a)}retrieve(e,t,n,r,a,i){const s=new D.a;return jt("OfflineDataStore.Retrieve",e.get_key()+".Retrieve Started","Retrieve",e),K.a.get_DefaultInstance().retrieveEntityMetadata(e.LogicalName,r).then(l=>{const u=l;let d=t instanceof de.a?t.get_Columns():null;d=this._AddRequiredAttributes(u,d),this._RetrieveGlobalNavigationDataRecord(a,u.get_isBusinessProcessEnabled(),n,r).then(a=>{const l=Object(p.a)(a)?null:a.getValue("processid"),f=Object(p.a)(l)||!Object(p.a)(l)&&l.Id.equals(c.a.get_empty())?null:l.Id;N.a.get_DefaultInstance().get_offlineTypescriptInterface().getBusinessProcessFlowControlData(f,e.LogicalName).then(c=>{if(!Object(p.a)(c)&&c.length)for(const e of c)-1===d.indexOf(e)&&d.push(e);K.a.get_DefaultInstance().getAttributeTypes(e.LogicalName,d,r).then(c=>{wt("OfflineDataStore.Retrieve.GetAttributeTypes","GetAttributeTypes succeeded");const l=this._GetPhysicalFieldsForQuery(c,r),d=Y.get_instance().generateRetrieveQuery(e,l,u.get_primaryIdAttribute()),f=[e.Id.toString().toUpperCase()];this.get_Plugin().transaction(l=>{l.executeSql(d,f,(l,d)=>{Object(p.a)(d.rows)||!d.rows.length?(jt("OfflineDataStore.Retrieve.NoRecordsFound",e.get_key(),"Retrieve",e),s.reject(o.a.FromMessage("No records found"))):this._getEntityRecordFromSQLResult(e,t,d.rows.item(0),u,c,n,i).then(t=>{u.get_isBusinessProcessEnabled()&&!Object(p.a)(a)&&t.set_globalNavigationData(a),u.get_isActivity()?(wt("OfflineDataStore.Retrieve","Entity metadata is activity"),this._FillActivityParty(t,c,n,r).then(t=>{wt("OfflineDataStore.Retrieve._FillActivityParty","Succeeded"),jt("OfflineDataStore.Retrieve","Retrieve Succeeded","Retrieve",e),s.resolve(t)},e=>{It("OfflineDataStore.Retrieve._FillActivityParty",e.get_Message()),s.reject(e)})):(wt("OfflineDataStore.Retrieve","Entity metadata is not activity"),jt("OfflineDataStore.Retrieve","Retrieve Succeeded","Retrieve",e),s.resolve(t))},t=>{jt("OfflineDataStore.Retrieve.CreateEntityRecord.Failure",t.get_Message(),"Retrieve",e),s.reject(t)})},Et(s,"Retrieve"+e.get_key()))},Ct(s,"Retrieve"+e.get_key()),null)},t=>{jt("OfflineDataStore.Retrieve.GetAttributeTypes.Failure",t.get_Message(),"Retrieve",e),s.reject(t)})},t=>{jt("OfflineDataStore.Retrieve.getBusinessProcessFlowContolData.Failure",t.get_Message(),"Retrieve",e),s.reject(t)})},t=>{jt("OfflineDataStore.Retrieve._RetrieveGlobalNavigationDataRecord.Failure",t.get_Message(),"Retrieve",e),s.reject(t)})},t=>{jt("OfflineDataStore.Retrieve.RetrieveEntityMetadata.Failure",t.get_Message(),"Retrieve",e),s.reject(t)}),s}retrieveLookupRecords(e,t,n,r){wt("OfflineDataStore.RetrieveLookupRecords","RetrieveLookupRecords started for "+(t+": "+e.join()));const a=new D.a;return K.a.get_DefaultInstance().retrieveEntityMetadata(t,n).then(i=>{const o=[i.get_primaryIdAttribute(),i.get_primaryNameAttribute()];K.a.get_DefaultInstance().getAttributeTypes(t,o,n).then(t=>{const n=Y.get_instance().generateRetreiveLookupQuery(e.length,o,i);this._plugin.transaction(o=>{o.executeSql(n,e,(e,n)=>{wt("OfflineDataStore.RetrieveLookupRecords","RetrieveLookupRecords succeeded");this._GenerateEntityArray(n,t,i,r).then(e=>{a.resolve(new be.a(e,false,n.rows.length,!1))},e=>{wt("OfflineDataStore.RetrieveLookupRecords",e.get_Message()),a.reject(e)})},()=>{wt("OfflineDataStore.RetrieveLookupRecords","No records found"),a.resolve(new be.a(new Array(0),!1,0,!1))})},Ct(a,"RetrieveLookupRecords"+i.get_id().toString()),null)},e=>{wt("OfflineDataStore.RetrieveLookupRecords.GetAttributeTypes","RetrieveLookupRecords failed"),a.reject(e)})},e=>{wt("OfflineDataStore.RetrieveLookupRecords.RetrieveEntityMetadata","RetrieveLookupRecords failed"),a.reject(e)}),a}retrieveMultiple(e,t,n){const r=new D.a;wt("OfflineDataStore.RetrieveMultiple.Start",e.get_PublicKey());let a=!1;const i=e.get_sql(K.a.get_DefaultInstance().get_UserContext());return Object(p.b)(i)?(It("OfflineDataStore.RetrieveMultiple.SqlQueryNotFound",e.get_PublicKey()),r.resolve(new be.a(new Array(0),!1,0,!1,e))):(this._replaceMissingMetadataTokens(i).then(i=>{i=unescape(i),this.get_Plugin().transaction(o=>{o.executeSql(i,null,(i,o)=>{a=!0,wt("OfflineDataStore.RetrieveMultiple.SqlSuccess",e.get_PublicKey());let s=!1;const c=o.rows.length;let l=!1;o.rows.length>e.get_PageSize()&&(o.rows.length=e.get_PageSize(),s=!0,l=!0),wt("OfflineDataStore.RetrieveMultiple.SqlSuccess",`Results count: ${c} - more Records: ${s}`),this._getEntityCollectionFromSQLResults(e,o,s,c,l,t,n).then(e=>{r.resolve(e)},e=>{It("OfflineDataStore.RetrieveMultiple.GetEntityCollectionFromSQLResultsFailed",e.get_Message()),r.reject(e)})},Et(r,"OfflineDataStore.RetrieveMultiple.QueryId"+e.get_PublicKey()))},Ct(r,"OfflineDataStore.RetrieveMultiple.QueryId"+e.get_PublicKey()),()=>{a||(It("OfflineDataStore.RetrieveMultiple.TransactionSuccessWithExecuteSqlNotCompleted","QueryId"+e.get_PublicKey()),r.resolve(new be.a(new Array(0),!1,0,!1,e,t))),It("OfflineDataStore.RetrieveMultiple.TransactionSuccess","QueryId"+e.get_PublicKey())})}),r)}_replaceMissingMetadataTokens(e){if(e.includes("!attr-")){let t={};const n=e.split("!attr-");n.shift(),n.forEach(e=>{const n=e.split("-"),r=n[0],a=n[1].substring(0,n[1].indexOf("!"));t=this._addMissingInfo(t,r,a)});return K.a.get_DefaultInstance().get_Store().dispatch(Object(Ye.e)(t)).then(()=>{for(const n in t)t[n].forEach(t=>{e=this._finalTokenReplace(n,t,e)});return e})}return new Promise(t=>{t(e)})}_addMissingInfo(e,t,n){return null!=e[t]?e[t].includes(n)||e[t].push(n):e[t]=[n],e}_finalTokenReplace(e,t,n){let r=null;const a=K.a.get_DefaultInstance().get_MetadataCache(),i=Object(Qe.a)(a,e,t,Object(Xe.a)(()=>r,e=>r=e)),o="!attr-"+e+"-"+t+"!";return n.replace(o,i)}_getEntityCollectionFromSQLResults(e,t,n,r,a,i,o){if(N.a.get_DefaultInstance().get_offlineTypescriptInterface().isExtendedOfflineClientApiSupportEnabled())return N.a.get_DefaultInstance().get_offlineTypescriptInterface().getEntityCollectionFromSQLResults(e,t,n,r,a);const s=new D.a,c=e.get_ColumnSet()instanceof de.a&&!e.get_ColumnSet().get_isEmpty()?e.get_ColumnSet().get_Columns():null,l=e.GetColumnNamesFromFetch(),u=N.a.get_DefaultInstance().get_offlineTypescriptInterface().parseFetchXmlForAliasedValues(e.get_FetchXml()),d=Object(p.a)(u[O.g])?null:u[O.g];return K.a.get_DefaultInstance().getAttributeTypesForEntities(e.get_EntityLogicalName(),l,c,d,o).then(c=>{K.a.get_DefaultInstance().retrieveEntityMetadata(e.get_EntityLogicalName(),o).then(o=>{this._GenerateEntityArray(t,c,o,i,d).then(t=>{s.resolve(new be.a(t,n,r,a,e))},e=>{It("OfflineDataStore.GetEntityCollectionFromSQLResults._GenerateEntityArrayFailed",e.get_Message()),s.reject(e)})},t=>{It("OfflineDataStore.GetEntityCollectionFromSQLResults.EntityMetadataRetrieveFailed",t.get_Message()+".QueryId"+e.get_id()),s.reject(t)})},t=>{It("OfflineDataStore.GetEntityCollectionFromSQLResults.AttributeTypeRetrieveFailed",t.get_Message()+".QueryId"+e.get_id()),s.reject(t)}),s}_getEntityRecordFromSQLResult(e,t,n,r,a,i,o){return N.a.get_DefaultInstance().get_offlineTypescriptInterface().isExtendedOfflineClientApiSupportEnabled()?N.a.get_DefaultInstance().get_offlineTypescriptInterface().getEntityRecordFromSQLResult(e,t,n,i,o):Object(ke.a)(n,a,r,i)}_retrieveAllEntitySyncTime(e,t){const n=new D.a;Object.keys(e).length||n.resolve(null);const r={},a=Object(p.a)(t)||Object(p.a)(t.rows)?0:t.rows.length,i=a>0&&O.E in t.rows.item(0);for(let e=0;e<a;e++){const n=t.rows.item(e);if(!Object(p.a)(n)){const e={};i?(e[O.E.toLowerCase()]=Object(p.a)(n[O.E])?y[y.completed]:n[O.E].toString(),e[O.D.toLowerCase()]=Object(p.a)(n[O.D])?"0":n[O.D].toString()):(e[O.E.toLowerCase()]=y[y.completed],e[O.D.toLowerCase()]="0"),e[O.H.toLowerCase()]=Object(p.a)(n[O.H])?"00:00:00":n[O.H].toString(),r[n[O.q].toString()]=e,wt("OfflineDataStore.RetrieveLastSyncTime",String.format("Data Sync Status is added to  offline Entities list For The Entity-{0} - lastSync: {1}",n[O.q].toString(),e[O.H.toLowerCase()]))}}return n.resolve(r),n}_ExecuteMultiple(e,t,n){const r=new D.a,a=this._retrieveEntityMetadataForExecuteMultipleRequest(e);return a?(Object(S.a)(a).then(a=>{let i=!e.get_settings().get_continueOnError();if(i)for(const e of a)if(e){const t=e;if(t&&t.get_isBPFEntity()){i=!1;break}}const s=[];i&&s.push(this._CreateUpSyncTransactionLog(!0,!1));let c=0;for(const r of e.get_requests())c++,wt("OfflineDataStore._ExecuteMultiple",`Adding query ${r} to ExecuteMultiple list`),this._AddRequest(r,s,a,t,n);wt("OfflineDataStore._ExecuteMultiple",`A Total of ${c} requests added to ExecuteMultiple`),i&&s.push(this._CreateUpSyncTransactionLog(!1,!1)),Object(S.a)(s).then(t=>{this._ExecuteQueriesInTransaction(t).then(t=>{wt("OfflineDataStore._ExecuteMultiple","ExecuteMultiple succeeded");const n=new Array(0),a=e.get_requests();for(let e=0;e<a.length;e++)if(a[e]instanceof Ne.a){const s=2*e+(i?1:0);if(Object(p.a)(t[s])||!t[s].rows.length)return It("OfflineStore._ExecuteMultiple.Failure","You can’t update this record because it doesn’t exist in the offline mode"),void r.reject(o.a.fromErrorCode(-2147093980));n.push(a[e].get_target().get_identifier())}else a[e]instanceof we.a&&n.push(a[e].get_target().get_identifier());r.resolve(n)},e=>{It("OfflineStore._ExecuteMultiple.Failure","Failed on _ExecuteQueriesInTransaction "+e.get_Message()),r.reject(e)})},e=>{It("OfflineStore._ExecuteMultiple.Failure",e.get_Message()),r.reject(e)})},e=>{It("OfflineStore._ExecuteMultiple.Failure","Failed on _shouldBeInTransaction "+e.get_Message()),r.reject(e)}),r):r.resolve(null)}_retrieveEntityMetadataForExecuteMultipleRequest(e){if(!(e instanceof Pe.a))return null;const t=[],n=e.get_requests();for(let e=0;e<n.length;e++){let r=null;(n[e]instanceof we.a||n[e]instanceof Ne.a)&&(r=n[e].get_target()),r&&r.get_identifier()&&r.get_identifier().LogicalName&&t.push(K.a.get_DefaultInstance().retrieveEntityMetadata(r.get_identifier().LogicalName,null))}return t}_AddRequest(e,t,n,r,a){if(e&&t&&n)if(e instanceof Ne.a){const n=e;t.push(this._UpdateInternal(n.get_target().get_actionableIdentifier(),n.get_target(),n.get_suppressDuplicateDetection(),r,!1,a))}else if(e instanceof we.a){const r=e,i=r.get_target();let o=null;for(const e of n)if(e&&e.get_logicalName()===i.get_identifier().LogicalName){o=e;break}if(!o)return;const s=Object(p.a)(i.get_identifier().Id)||i.get_identifier().Id.equals(c.a.get_empty())?Object(p.a)(i.getFields()[o.get_primaryIdAttribute()])?c.a.newGuid():i.getFields()[o.get_primaryIdAttribute()]:i.get_identifier().Id;t.push(this._CreateInternal(i,r.get_suppressDuplicateDetection(),o,s,a))}}update(e,t,n,r,a,i){jt("OfflineDataStore.Update","Update started","Update",e);const s=new D.a;return this._UpdateInternal(e,t,n,r,i,a,!0).then(n=>{this.get_Plugin().transaction(r=>{const a=[];this._UpdateAndExecuteQueries(r,a,n),Object(S.a)(a).then(n=>{Object(p.a)(n[0])||!n[0].rows.length?(jt("OfflineDataStore.Update.Failure","You can’t update this record because it doesn’t exist in the offline mode","Update",e),s.reject(o.a.fromErrorCode(-2147093980))):(jt("OfflineDataStore.Update","Update succeeded","Update",e),s.resolve(t.get_identifier()))},t=>{jt("OfflineDataStore.Update.Failure",t.get_Message(),"Update",e),s.reject(t)})},Ct(s,"Update"),null)},t=>{jt("OfflineDataStore._UpdateInternal.Failure",t.get_Message(),"Update",e),s.reject(t)}),s}_UpdateInternal(e,t,n,r,a,i,o){wt("OfflineDataStore._UpdateInternal","Update Internal started");const s=new D.a;return a=!Object(p.a)(a)&&a,K.a.get_DefaultInstance().retrieveEntityMetadata(e.LogicalName,null).then(l=>{const u=l;if(o=!Object(p.a)(o)&&o){const o=new Ne.a(t);N.a.get_DefaultInstance().get_offlineTypescriptInterface().createCustomOfflineCommandQueries(o,e.LogicalName,c.a.get_empty(),i).then(i=>{if(Object(p.a)(i))this._DoUpdateInternal(s,e,t,n,r,a,u);else{const t=[];t.push(new Ke(Y.get_instance().generateRetrieveQuery(e,[new f.a(u.get_primaryIdAttribute())],u.get_primaryIdAttribute()),[e.Id.toString()],"Transaction.Retrieve")),s.resolve(this._PrepareFinalQueryList(i,a,t))}},e=>{It("OfflineDataStore.Create.CreateCustomOfflineCommandQueries.Fail",e.get_Message()),s.reject(e)})}else this._DoUpdateInternal(s,e,t,n,r,a,u)},e=>{It("OfflineDataStore.UpdateInternal.Fail",e.get_Message()),s.reject(e)}),s}_DoUpdateInternal(e,t,n,r,a,i,o){const s=[];B.a.getOfflineQueryDataObject(n,le.a.update,o.get_primaryIdAttribute(),t.Id,o,this._userContext).then(n=>{if(s.push(new Ke(Y.get_instance().generateRetrieveQuery(t,[new f.a(o.get_primaryIdAttribute())],o.get_primaryIdAttribute()),[t.Id.toString()],"Transaction.Retrieve")),s.push(new Ke(Y.get_instance().generateUpdateQuery(t,n.get_columns(),o.get_primaryIdAttribute()),n.get_values(),"Transaction.Update")),o.get_isActivity()){wt("OfflineDataStore._UpdateInternal","Entity metadata is activity");let e=0;for(const t of n.get_partiesToRetain()){const n=t[O.Y].length,r="@ActivityParty@"+e+Y.get_instance().generateDeleteFilteredActivityPartiesQuery(n);s.push(new Ke(r,Pt(t),"Transaction.Delete")),e++}e=0;for(const t of n.get_partiesToCreate()){const n="@ActivityParty@"+e+Y.get_instance().generateInsertQuery(t[O.u],t[O.m]);s.push(new Ke(n,t[O.eb],"Transaction.Create")),e++}e=0;for(const t of n.get_partiesToRetain()){const n=t[O.Y].length,r="@ActivityParty@"+e+Y.get_instance().updateActivityPartiesQuery(n);s.push(new Ke(r,Tt(t),"Transaction.Update")),e++}}e.resolve(this._PrepareFinalQueryList(s,i))},t=>{It("OfflineStore._UpdateInternal.GetOfflineQueryDataObject.Failure",t.get_Message()),e.reject(t)})}_ExecuteInternal(e,t,n){const r=new D.a;return e.executeSql(t,n,(e,t)=>{r.resolve(t)},Et(r,"ExecuteInternal")),r}Delete(e,t,n){jt("OfflineDataStore.Delete","Delete started","Delete",e);const r=new D.a;return n=!Object(p.a)(n)&&n,K.a.get_DefaultInstance().retrieveEntityMetadata(e.LogicalName,t).then(t=>{this.get_Plugin().transaction(a=>{const i=[new te.a(t.get_primaryIdAttribute(),null,H.a.Or,0)],s=new j.a(i),c=Y.get_instance().generateDeleteQuery(e,s),l=[e.Id.toString()],u=[];u.push(this._ExecuteInternal(a,Y.get_instance().generateRetrieveQuery(e,[new f.a(t.get_primaryIdAttribute())],t.get_primaryIdAttribute()),[e.Id.toString()])),n&&(wt("OfflineDataStore.Delete","Delete called with triggers suppressed"),u.push(this._ExecuteInternal(a,Y.get_instance().generateSuppressTriggerQuery(),null))),u.push(this._ExecuteInternal(a,c,l)),t.get_isActivity()&&(wt("OfflineDataStore.Delete","Entity metadata is activity"),u.push(this._ExecuteInternal(a,Y.get_instance().generateDeleteAllActivityPartiesQuery(),l))),n&&u.push(this._ExecuteInternal(a,Y.get_instance().generateUnsuppressTriggerQuery(),null)),Object(S.a)(u).then(t=>{Object(p.a)(t[0])||!t[0].rows.length?(jt("OfflineDataStore.Delete.Failure","You can’t delete this record because it doesn’t exist in the offline mode","Update",e),r.reject(o.a.fromErrorCode(-2147093944))):(jt("OfflineDataStore.Delete","Delete succeeded","Delete",e),r.resolve(e))},t=>{jt("OfflineDataStore.Delete.Failure",t.get_Message(),"Delete",e),r.reject(t)})},Ct(r,"Delete"),null)},t=>{jt("OfflineDataStore.Delete.Failure",t.get_Message(),"Delete",e),r.reject(t)}),r}_GenerateEntityArray(e,t,n,r,a){const i=Object(p.a)(e)||Object(p.a)(e.rows)?0:e.rows.length,o=new D.a,s=[];for(let o=0;o<i;o++){const i=e.rows.item(o);Object(p.a)(i)||Object(p.b)(i[n.get_primaryIdAttribute()])||s.push(Object(ke.a)(i,t,n,r,a))}return Object(S.a)(s).then(e=>{o.resolve(e)},e=>{It("OfflineStore._GenerateEntityArray.Failure",e.get_Message()),o.reject(e)}),o}flushAll(e){const t=new D.a;return this._parentDataSource.retrieveOfflineInformation(x.a.OfflineDatabaseKey).then(n=>{if(Object(p.a)(n)||!(x.a.OfflineDatabaseKey in n)||Object(p.a)(n[x.a.OfflineDatabaseKey]))wt("OfflineDataStore.FlushAll","Offline store not available. So nothing to be deleted"),t.resolve(!0);else{const r=n[x.a.OfflineDatabaseKey].toString();this._clearStore(r,e).then(()=>{wt("OfflineDataStore.FlushAll","Offline store delete successful"),this._ClearOfflineSessionState().then(()=>{wt("OfflineDataStore.FlushAll","Offline store session state cleanup successful."),t.resolve(!0)},e=>{It("OfflineDataStore.FlushAll","Offline store session state cleanup failed. Error Message: "+e.get_Message()),t.reject(e)})},e=>{It("OfflineDataStore.FlushAll","Offline store delete failed. Error Message: "+e.get_Message()),t.reject(e)})}},e=>{It("OfflineDataStore.FlushAll","Clear data store failed as database name was not retrieved. Error Message: "+e.get_Message()),t.reject(e)}),t}_clearStore(e,t){wt("OfflineDataStore.ClearStore","ClearStore started");const n=new D.a;return Object(p.b)(e)?(wt("OfflineStore.ClearStore","Database name is empty"),n.resolve(!1)):(this._StopSync(lt.t).always(()=>{N.a.get_DefaultInstance().get_offlineTypescriptInterface().getOfflineStatus()!==Z.a.Available?this._InitAndLogin(e,t).then(()=>{wt("OfflineStore.ClearStore","InitAndLogin succeeded"),this._DeleteDatabase(e,n)},e=>{It("OfflineStore.ClearStore._InitAndLogin.Failure",e.get_Message()),n.reject(e)}):this._DeleteDatabase(e,n)}),n)}_DeleteDatabase(e,t){this.get_Plugin().deleteDatabase(e,()=>{wt("OfflineStore._DeleteDatabase","Database delete successful for database : "+e),N.a.get_DefaultInstance().get_offlineTypescriptInterface().setOfflineStatus(0,ee.a.DatabaseUnavailable),this._regenerateViews=!0,_t=null,t.resolve(!0)},()=>{It("OfflineStore._DeleteDatabase.Failure",e),t.reject(o.a.FromMessage("Could not delete database"))})}_RetrievePartyRecords(e,t,n,r){wt("OfflineDataStore._RetrievePartyRecords","RetrievePartyRecords started");const a=new D.a;return K.a.get_DefaultInstance().getAttributeTypes(O.d,O.V,r).then(i=>{wt("OfflineDataStore._RetrievePartyRecords.GetAttributeTypes","GetAttributeTypes succeded");const o=this._GetPhysicalFieldsForQuery(i,r);let s=!1;K.a.get_DefaultInstance().retrieveEntityMetadata(O.d,r).then(r=>{const c=Y.get_instance().generateRetrievePartyListQuery(o,t,r.get_logicalName()),l=[e.Id.toString().toUpperCase()];for(const e in t){const n={key:e,value:t[e]};l[l.length]=n.key}this._plugin.transaction(e=>{e.executeSql(c,l,(e,t)=>{const o=t.rows.length,c=[];s=!0;for(let e=0;e<o;e++)Object(p.a)(t.rows.item(e))||c.push(Object(ke.a)(t.rows.item(e),i,r,n));Object(S.a)(c).then(e=>{wt("OfflineDataStore._RetrievePartyRecords","Executesql succeded"),a.resolve(new be.a(e,!1,t.rows.length,!1))},e=>{It("OfflineStore._RetrievePartyRecords.Failure",e.get_Message()),a.reject(e)})},Et(a,"RetrievePartyRecords"))},Ct(a,"RetrievePartyRecords"),()=>{It("RetreivePartyRecords.TransactionSuccess","Identifier"+e.get_key()),s||a.resolve(new be.a(new Array(0),!1,0,!1))})},t=>{It("Retrieve.RetrieveEntityMetadata.Failure",e.LogicalName+"."+t.get_Message()),a.reject(t)})},t=>{It("Retrieve.GetAttributeTypes.Failure",e.LogicalName+"."+t.get_Message()),a.reject(t)}),a}_FillActivityParty(e,t,n,r){wt("OfflineDataStore._FillActivityParty","FillActivityParty started");const a=new D.a;let i=!1;const o={};for(const e in t)if(t[e]===P.a.PartyList){const t=O.S[e];o[t]=e,i=!0}return i?(this._RetrievePartyRecords(e.get_identifier(),o,n,r).then(t=>{if(wt("OfflineDataStore._FillActivityParty","RetrievePartyRecords succeeded"),!Object(p.a)(t.get_entities())&&t.get_entities().length>0){let n=new Array(0),r="";for(const a of t.get_entities())r!==a.getValue(O.T).get_ValueString()&&(n.length>0&&(e.initializeValue(o[r].toString(),new be.a(n,!1,n.length,!1),P.a.PartyList),n=new Array(0)),r=a.getValue(O.T).get_ValueString()),n[n.length]=a;e.initializeValue(o[r].toString(),new be.a(n,!1,n.length,!1),P.a.PartyList)}wt("OfflineDataStore._FillActivityParty","FillActivityparty succeeded"),a.resolve(e)},e=>{It("Retrieve._RetrievePartyRecords.Failure",e.get_Message()),a.reject(e)}),a):(a.resolve(e),a)}_GetPhysicalFieldsForQuery(e,t){const n=Object(C.c)(e,t),r=new Array(0);for(const e in n){const t=n[{key:e,value:n[e]}.key];for(let e=0;e<t.length;e++)r.push(new f.a(t[e].toString()))}return r}_AddRequiredAttributes(e,t){const n=new Array(0);if(Object(p.a)(e.get_primaryIdAttribute())||(n[n.length]=e.get_primaryIdAttribute()),Object(p.a)(e.get_primaryNameAttribute())||(n[n.length]=e.get_primaryNameAttribute()),n.length>0){for(const e of t){const t=n.indexOf(e);if(t>=0&&(n.splice(t,1),!n.length))break}for(const e of n)t[t.length]=e}return t}_CreateActivityPointerView(e){wt("OfflineDataStore._CreateActivityPointerView","CreateActivityPointerView started");const t=[];!Object(p.a)(e)&&e.length>0&&(t.push(this._DropView(R.c)),t.push(this._DropView(O.b)));const n=N.a.get_DefaultInstance().get_offlineTypescriptInterface().getOfflineEnabledEntities();-1===n.indexOf(R.c.toLowerCase())?wt("CreateActivityPointerView","View not created as ActivityPointer is not offline available"):Object(S.a)(t).always(()=>{this._CreateActivityPointerViewInternal(e,n)})}_CreateActivityPointerViewInternal(e,t){Y.get_instance().generateCreateActiviyPointerViewQuery(this._localContext,e,t).then(e=>{wt("OfflineDataStore._CreateActivityPointerView","CreateActivityPointerView query :"+e),this._plugin.transaction(t=>{t.executeSql(e,null,()=>{wt("OfflineDataStore.CreateActivityPointerView creation successful","CreateActivityPointerView"),this._IsActivityAttachmentEnabled()?this._CreateActivityAttachmentView():this._regenerateViews=!1},Object(Ue.a)(this,this._ActivityPointerChangeFailedCallback,"ActivityPointerChangeFailedCallback"))},()=>{It("transaction failed while creating the view","CreateActivityPointerView")},null)},null)}_IsActivityAttachmentEnabled(){const e=N.a.get_DefaultInstance().get_offlineTypescriptInterface().getOfflineEnabledEntities();return-1!==e.indexOf(R.a)&&-1!==e.indexOf(R.e)&&-1!==e.indexOf(R.c)||(wt("CreateActivityAttachmentView","View not created as ActivityAttachment or Attachment or ActivityPointer is not offline available"),!1)}_CreateActivityAttachmentView(){wt("OfflineDataStore._CreateActivityAttachmentView","CreateActivityAttachmentView started"),Y.get_instance().generateCreateActiviyAttachmentViewQuery(N.a.get_DefaultInstance().get_offlineTypescriptInterface().getOfflineEnabledEntities()).then(e=>{wt("OfflineDataStore._CreateActivityAttachmentView","CreateActivityAttachmentView query :"+e),this._plugin.transaction(t=>{t.executeSql(e,null,()=>{wt("OfflineDataStore.CreateActivityPointerView creation successful","CreateActivityAttachmentView"),this._regenerateViews=!1},Object(Ue.a)(this,this._ActivityAttachmentFailedCallback,"ActivityAttachmentFailedCallback"))},()=>{It("transaction failed while creating the view","CreateActivityAttachmentView")},null)},null)}_ActivityPointerChangeFailedCallback(e,t){It("view creation/removal failed","ActivityPointerChangeFailed with error message : "+e)}_ActivityAttachmentFailedCallback(e,t){It("view creation/removal failed","ActivityAttachmentView creation failed with error message : "+e)}_DropView(e){const t=new D.a;return this._plugin.transaction(n=>{const r=Y.get_instance().generateDropViewQuery(e);n.executeSql(r,null,()=>{wt("DropView: "+e,"success"),t.resolve(!0)},(e,n)=>{this._ActivityPointerChangeFailedCallback(e,n),t.resolve(!1)})},()=>{It("DropView: "+e,"transaction failed"),t.resolve(!1)},null),t}async retrieveMetadata(e){const t=[],n=[];for(const r of e)try{const e=await K.a.get_DefaultInstance().retrieveEntityMetadata(r,null).nativePromise();t.push(e)}catch(e){n.push(r)}return n.length>0&&It("OfflineDataStore: UpdateOfflineAvailablePrimaryEntities","Failed to get the entity metadata "+n.join(",")),t}async _UpdateOfflineContext(){const e=K.a.get_DefaultInstance().get_Store(),t=Object(it.l)(e.getState());try{if(t){const t=Object(rt.k)(e.getState());await e.dispatch(Object(yt.d)(new mt.a(t),!0)),Object(dt.f)(e.getState(),pt.se)&&await e.dispatch(Object(st.h)(void 0,!1,!0))}else await e.dispatch(Object(st.h)(void 0,!1,!0))}catch(e){It("OfflineDataStore: UpdateOfflineAvailablePrimaryEntities.UpdateOfflineContext","Failed to retrieve the offline context from the "+(t?"AppContext":"UserContext")+" with error: "+e.message||!1)}}async _UpdateOfflineAvailableEntities(e,t){e&&await this._UpdateOfflineContext();const n=K.a.get_DefaultInstance().get_Store().getState();let r=Object(bt.i)(n)||{};const a=Object(bt.g)(n)||{},i=Object(bt.h)(n)||{},s={};let c,l={},u={};const d={offlinePrimaryAvailableEntities:null,offlineAvailableEntities:null,offlineAvailableEntityMetadataInfo:null};try{c=await this.retrieveMetadata(N.a.get_DefaultInstance().get_offlineTypescriptInterface().getOfflineProfileAvailableEntities())}catch(e){return void It("OfflineDataStore: UpdateOfflineAvailablePrimaryEntities","Failed to get the entity metadata "+(e instanceof o.a?e:o.a.fromGenericError(e)).get_Message())}for(const e of c){const t=e;!t.get_isBPFEntity()&&!t.get_isIntersect()&&this._entitySkipList.indexOf(t.get_logicalName())<0&&(s[t.get_logicalName()]=e.get_displayName())}for(const e of Object.keys(r)){let t=!1;for(const n in s)if(n===e){t=!0;break}t||(delete r[e],d.offlinePrimaryAvailableEntities=r)}const f=new D.a;let g={};if(Object.keys(s).length>0)try{this.get_Plugin().transaction(e=>{this._ExecuteInternal(e,Y.get_instance().retrieveDataSyncStatusQuery(),null).then(async e=>{g=await this._retrieveAllEntitySyncTime(s,e).nativePromise();try{for(const e of Object.keys(s))e in g?(g[e].displayname=s[e],e in r||(d.offlinePrimaryAvailableEntities=r),r[e]=g[e]):r[e]={initialdatadownloadstatus:"1",displayname:s[e]};const e=Object.keys(a).length;for(const e of Object.keys(g))e in a||(d.offlineAvailableEntities=l),l[e]=g[e];e!==l.length&&(d.offlineAvailableEntities=l);const n={sqlStatements:[],sqlParameters:new Array};n.sqlStatements.push(Y.get_instance().retrieveAllEntityMetadataOfflineInfoQuery()),n.sqlParameters.push([]);const o=await(new((await Object(ft.i)()).SqlExecutorImpl)).executeSqlStatementsOnMetadataDB(n).then(e=>{var t,n;return Object(p.b)(e)?It("OfflineDataStore: UpdateOfflineAvailablePrimaryEntities","Query for entity metadata from metadata database returned an invalid result set"):(!(null===(t=e[0])||void 0===t?void 0:t.rows)||(null===(n=e[0])||void 0===n?void 0:n.rows.length)<=0)&&It("OfflineDataStore: UpdateOfflineAvailablePrimaryEntities","Query for entity metadata from metadata database returned no rows in the result set"),e}),c=Object.keys(i).length;for(const e of o)if(e.rows&&e.rows.length>0)for(let t=0;t<e.rows.length;t++){const n=e.rows.item(t);("organization"!==n[O.J]||l.organization)&&(n[O.J]in i||(d.offlineAvailableEntityMetadataInfo=u),u[n[O.J]]=n)}c!==u.length&&(d.offlineAvailableEntityMetadataInfo=u);for(const e in d)d[e]&&Object(h.a)(t,e,d[e]);N.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentWarn(b,"[offlineDataStore] _UpdateOfflineAvailableEntities.Success Lists update complete. Updated lists: ["+Object.keys(d).filter(e=>d[e])+"] Not updated lists: ["+Object.keys(d).filter(e=>!d[e])+"]",t);for(const e in d){const n=t.findIndex(t=>t.name===e);t.splice(n,1)}}catch(e){const t=e instanceof o.a?e:o.a.fromGenericError(e);r={},l={},u={},It("OfflineDataStore._UpdateOfflineAvailableEntities.InnerFail ",t.get_Message())}finally{N.a.get_DefaultInstance().get_offlineTypescriptInterface().setOfflineAvailablePrimaryEntities(r),N.a.get_DefaultInstance().get_offlineTypescriptInterface().setOfflineAvailableEntities(l),N.a.get_DefaultInstance().get_offlineTypescriptInterface().setOfflineAvailableEntityMetadata(u),this._parentDataSource.saveOfflineInformation(x.a.OfflinePrimaryAvailableEntitiesKey,r,!1),this._parentDataSource.saveOfflineInformation("offlineavailableentitieskey",l,!1)}},e=>{It("OfflineDataStore.RetrieveLastSyncTime",e.get_Message()),f.reject(e)})},Ct(f,"RetrieveLastSyncTime"),null)}catch(e){const t=e instanceof o.a?e:o.a.fromGenericError(e);r={},l={},u={},It("OfflineDataStore._UpdateOfflineAvailableEntities.Fail ",t.get_Message())}finally{N.a.get_DefaultInstance().get_offlineTypescriptInterface().setOfflineAvailablePrimaryEntities(r),N.a.get_DefaultInstance().get_offlineTypescriptInterface().setOfflineAvailableEntities(l),N.a.get_DefaultInstance().get_offlineTypescriptInterface().setOfflineAvailableEntityMetadata(u),this._parentDataSource.saveOfflineInformation(x.a.OfflinePrimaryAvailableEntitiesKey,r,!1),this._parentDataSource.saveOfflineInformation("offlineavailableentitieskey",l,!1)}}_saveBooleanInformationToOfflineInformation(e,t,n,a,i){a=a||`[offlineDataStore] OfflineSync: Save${t}ToSessionState.Success`,i=i||`[offlineDataStore] OfflineSync: Save${t}ToSessionState.Failed`;const o={};o[t]=n,this._parentDataSource.saveOfflineInformation(t,o,!1).then(()=>{N.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentWarn(b,a,e)},t=>{Object(h.a)(e,r.e,t.get_Message()),N.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentWarn(b,i,e)})}_ClearOfflineSessionState(){const e=new D.a,t=[];return t.push(this._parentDataSource.deleteOfflineInformation(x.a.OfflineDatabaseKey)),t.push(this._parentDataSource.deleteOfflineInformation(x.a.MaxTimeKey)),Object(S.a)(t).then(()=>{e.resolve(!0)},t=>{e.reject(t)}),e}ExecuteSqlStatements(e){const t=new D.a,n=[];for(let t=0;t<e.sqlStatements.length;t++)n.push(new Ke(e.sqlStatements[t],e.sqlParameters[t],"Transaction.ExecuteSqlStatements"));return this.get_Plugin().transaction(e=>{const r=[];this._UpdateAndExecuteQueries(e,r,n),Object(S.a)(r).then(e=>t.resolve(e),e=>t.reject(e))},Ct(t,"ExecuteSqlStatements"),null),new Promise((e,n)=>{t.then(t=>e(t)).catch(e=>n(e))})}}function Ot(e){switch(e.code){case ce.warning:case ce.error:case ce.fatal:It("Sync.Progress",e.message);break;default:wt("Sync.Progress",e.message)}}function Ct(e,t){return(n,r)=>{It(t+".TxFailure",r),e.reject(o.a.FromMessage(r))}}function Et(e,t){return(n,r)=>{It(t+".SqlFailure",n),e.reject(o.a.FromMessage(n))}}function It(e,t){Object(i.e)(e,m.a.offlineDataStore,t)}function wt(e,t){Object(i.e)(e,m.a.offlineDataStore,t)}function jt(e,t,n,a){const o=new Date;let s=String.format("{0} -- {1} -- {2}",e,t,Object(i.a)(o));s=String.format("[{0}]{1}",b,s);const c=[];Object(h.a)(c,r.a,n),Object(p.a)(a)||Object(p.a)(a.LogicalName)?Object(h.a)(c,r.d,"unknown"):Object(h.a)(c,r.d,a.LogicalName),N.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentWarn(b,s,c)}function Pt(e){const t=[];t[t.length]=e[O.c].toString(),t[t.length]=e[O.T].toString();for(const n of e[O.Y])t[t.length]=n;return t}function Tt(e){const t=[];t[t.length]=e[O.c].toString(),t[t.length]=e[O.c].toString(),t[t.length]=e[O.T].toString();for(const n of e[O.Y])t[t.length]=n;return t}},iB7y:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return s}));var r=n("YYhu"),a=n("wL2W");function i(e,t,n,a,i,o,c){return{type:"dataSnapshotForWithMonitor.save.async",async execute({getState:l,dispatch:u},d){const p=await s();return u(Object(r.c)(e,t,n,a,i,o,c,p))}}}function o(e,t,n,a,i,o,c){return{type:"dataSnapshotForWithMonitor.saveMultiple.async",async execute({getState:l,dispatch:u},d){const p=await s();return u(Object(r.d)(e,t,n,a,i,o,c,p))}}}function s(){return Object(a.a)()?n.e(84).then(n.bind(null,"HplF")):null}},iEjf:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return u}));var r=n("odYE"),a=n("SRlt"),i=n("vF3j"),o=n("FZDd"),s=n("iZ7K"),c=n("g22U");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function l(e,t,n,r,o={},l){if(!e||!t||!n)return{serializationFailure:"Cannot serialize disassociate request. All required parameters are mandatory, but some were passed in empty"};const u=Object(s.o)(e,t.etn);u||null==l||l.warn(`The entity set name of ${t.etn} in buildDisassociateRequest is null or undefined!`);const{navigationProperty:d,serializationFailure:p}=Object(i.a)(e,t.etn,n);if(p)return{serializationFailure:p};const f=Object(c.g)(o);return{urlParameters:`${u}(${t.id.guid})/${d}`+(r?`(${r})`:"")+"/$ref",additionalHeaders:{Accept:a.a},method:"DELETE",additionalParameters:{[c.a.TYPE]:c.d.DELETE,[c.a.SUB_TYPE]:c.c.Disassociate,[c.a.SOURCE]:f}}}function u(e,t){return{type:"SERIALIZE_DISASSOCIATE_REQUEST_ASYNC",execute({dispatch:n,getState:a},i){const s=e.get_target();return n(Object(o.f)(s.LogicalName,!1,[],t)).then(()=>l(a(),r.a.fromLegacyEntityReference(s),e.get_relationship().get_schemaName()))}}}},iF9X:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return l})),n.d(t,"d",(function(){return u})),n.d(t,"g",(function(){return d})),n.d(t,"f",(function(){return p})),n.d(t,"e",(function(){return f})),n.d(t,"h",(function(){return g}));var r=n("504W"),a=n("17x/"),i=n("Lyxw"),o=n("3/02");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function s(e){return e&&e.offline&&e.offline.server&&!Object(r.a)(e.offline.server.isMocaOfflineFeatureEnabled)?e.offline.server.isMocaOfflineFeatureEnabled||Object(a.e)(e):!!Object(a.e)(e)}function c(e){return e&&e.offline&&e.offline.server&&e.offline.server.norsyncServerConnectionString?e.offline.server.norsyncServerConnectionString:""}function l(e){return!(!(e&&e.offline&&e.offline.server)||Object(r.a)(e.offline.server.isTrialOrganization))&&e.offline.server.isTrialOrganization}function u(e){return e&&e.offline&&e.offline.server&&e.offline.server.subscriptionId?e.offline.server.subscriptionId:""}function d(e){return Object(i.f)(e,o.Zb)&&(Object(i.g)(e,"MobileClientDssSync")||Object(a.e)(e))}function p(e){return Object(a.e)(e)&&Object(i.f)(e,o.Zb)}function f(e){return Object(i.f)(e,o.th)&&Object(i.g)(e,"MobileClientApplicationMetadataSync")}function g(e){return Object(i.f)(e,o.oc)}},iJGp:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.Unknown=0]="Unknown",e[e.OnDemandWithContext=1]="OnDemandWithContext",e[e.OnDemandWithoutContext=2]="OnDemandWithoutContext",e[e.OnDemandContextOnly=3]="OnDemandContextOnly",e[e.Offline=4]="Offline",e[e.Mobile=5]="Mobile",e[e.UserContext=6]="UserContext"}(r||(r={}))},iJxC:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("504W"),a=n("BSGX"),i=n("2mBq");class o{constructor(e,t,n,a,i){if(this._filter=null,this._sortBy=null,this._offset=0,this._pageSize=0,this._getIdOnly=!1,this._allowPartialResults=!1,t&&t.length>2)throw Error.invalidOperation("SortBy can have at most 2 sort fields.");this._getIdOnly=!1,this._filter=e,this._sortBy=t,this._offset=Object(r.a)(n)?0:n,this._pageSize=Object(r.a)(n)?-1:a,this._allowPartialResults=i}get_filter(){return this._filter}get_sortBy(){return this._sortBy}get_offset(){return this._offset}get_pageSize(){return this._pageSize}get_allowPartialResults(){return this._allowPartialResults}get_getIdOnly(){return this._getIdOnly}toString(){if(!this.get_filter())return"";let e="";return this.get_filter()instanceof a.a&&(e=this.get_filter().get_fieldValue().toString()),Object(i.a)("Query: '{0}'='{1}'",this.get_filter().get_field().get_path(),e)}}},iLty:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));class r{constructor(e){this._soapResponse=null,this._soapResponse=e,e&&(this._soapResponse.addNamespace("s","http://schemas.xmlsoap.org/soap/envelope/"),this._soapResponse.addNamespace("d","http://schemas.microsoft.com/xrm/2011/Contracts/Services"),this._soapResponse.addNamespace("a","http://schemas.microsoft.com/xrm/2011/Contracts"),this._soapResponse.addNamespace("b","http://schemas.datacontract.org/2004/07/System.Collections.Generic"),this._soapResponse.addNamespace("i","http://www.w3.org/2001/XMLSchema-instance"))}get_soapResponse(){return this._soapResponse}}},iQAP:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="featureControlManager.nativeFCBContextRetrieved";function a(e){return{type:r,payload:e}}},iYXG:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return c}));var r=n("iZ7K"),a=n("NjDY"),i=n("Y7HL"),o=n("SFgX");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function s(e,t){const n=Object(r.h)(e,t);return n?n.IconVectorName?{type:i.a,value:Object(a.x)(e)+n.IconVectorName}:{type:null,value:n.EntityIcon||""}:null}function c(e){return e.VectorIcon?{type:i.a,value:e.VectorIcon}:{type:null,value:Object(o.c)(e.Entity,e.Url)}}},iZ7K:function(e,t,n){"use strict";n.d(t,"n",(function(){return v})),n.d(t,"l",(function(){return y})),n.d(t,"m",(function(){return _})),n.d(t,"p",(function(){return S})),n.d(t,"h",(function(){return b})),n.d(t,"g",(function(){return j})),n.d(t,"o",(function(){return O})),n.d(t,"a",(function(){return C})),n.d(t,"r",(function(){return E})),n.d(t,"s",(function(){return w})),n.d(t,"e",(function(){return P})),n.d(t,"f",(function(){return T})),n.d(t,"E",(function(){return A})),n.d(t,"B",(function(){return R})),n.d(t,"q",(function(){return I})),n.d(t,"C",(function(){return D})),n.d(t,"b",(function(){return B})),n.d(t,"x",(function(){return H})),n.d(t,"c",(function(){return x})),n.d(t,"F",(function(){return q})),n.d(t,"D",(function(){return M})),n.d(t,"A",(function(){return L})),n.d(t,"z",(function(){return U})),n.d(t,"y",(function(){return F})),n.d(t,"v",(function(){return V})),n.d(t,"K",(function(){return z})),n.d(t,"G",(function(){return Y})),n.d(t,"d",(function(){return J})),n.d(t,"H",(function(){return $})),n.d(t,"w",(function(){return Z})),n.d(t,"j",(function(){return ee})),n.d(t,"k",(function(){return te})),n.d(t,"i",(function(){return ne})),n.d(t,"L",(function(){return Q})),n.d(t,"I",(function(){return K})),n.d(t,"J",(function(){return X})),n.d(t,"u",(function(){return N})),n.d(t,"t",(function(){return re}));var r=n("eXjw"),a=n("odYE"),i=n("5Oca"),o=n("M0zh"),s=n("WPtp"),c=n("w1eR"),l=n("sZ+8"),u=n("69Qu"),d=n("cetF"),p=n("O7zD"),f=n("3/02"),g=n("Lyxw"),h=n("504W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const m={systemuser:"systemusers",team:"teams"};function b(e,t){if(!e||!e.metadata||!e.metadata.entities)return null;const n=["connectionrole","team","systemuser"],r=["connection"];Object(g.e)(e,f.bc,f.jf)?r.push("email"):n.push("email");const a=e.metadata.entities[t];if(a&&!a.IsReadOnlyInMobileClient&&(n.find(e=>e===t)&&e.clientHost&&e.clientHost.type===c.a.MobileApplication||r.find(e=>e===t)&&!Object(u.c)(e)&&Object(l.n)(e,t))){const e=Object.assign({},a);return e.IsReadOnlyInMobileClient=!0,e}return!a&&Object(d.d)(t)?{EntityLogicalName:t}:a}function y(e,t){const n=b(e,t);return n?n.Initialized:r.a.Uninitialized}function _(e,t){return e.metadata.entitiesByTypeCode[t]}function v(e,t){if(!e||!e.metadata||!e.metadata.entities)return null;const n=e.metadata.entities;for(const e in n)if(n[e].EntitySetName===t)return n[e].EntityLogicalName;return null}function S(e,t){return null==b(e,t)?null:b(e,t).ObjectTypeCode}function O(e,t){const n=b(e,t);if(n&&n.EntitySetName)return n.EntitySetName;const r=m[t];return r||(Object(d.c)(t)||Object(d.d)(t)?t+"s":null)}function C(e){const t=j(e),n={};for(const r in t)E(e,r)&&(n[r]=t[r]);return n}function E(e,t){const n=b(e,t);return!(!n||!n.hasOwnProperty("IsActivity"))&&n.IsActivity}function I(e,t){const n=b(e,t);return!(!n||!n.hasOwnProperty("HasStateCode"))&&n.HasStateCode}function w(e,t){const n=b(e,t);return!(!n||!n.hasOwnProperty("IsIntersect"))&&n.IsIntersect}function j(e){return e&&e.metadata?e.metadata.entities:null}function P(e,t){if(t===o.c)return o.b;const n=b(e,t);return n&&n.DisplayCollectionName?n.DisplayCollectionName:null}function T(e,t){if(t===o.c)return o.c;const n=b(e,t);return n&&n.DisplayName?n.DisplayName:null}function N(e,t){const n=new Map;for(const r of t)n.set(r,T(e,r));return n}function A(e,t){const n=b(e,t);return n&&n.OneToManyRelationships?n.OneToManyRelationships:null}function R(e,t){const n=b(e,t);return n?n.ManyToOneRelationships:null}function D(e,t,n){const r=A(e,t);return r&&r.hasOwnProperty(n)?r[n]:null}function x(e,t,n){const r=A(e,t);if(!r)return null;const a=[];for(const e in r){const i=r[e];i.ReferencedEntity===t&&i.ReferencingEntity===n&&a.push(i)}return a}function M(e,t,n,r){const a=A(e,t);if(!a)return null;for(const e in a){const t=a[e];if(t.ReferencingEntity===n&&t.ReferencingAttribute===r)return t}return null}function F(e,t,n){const r=b(e,t);return r&&r.ManyToOneRelationships&&r.ManyToOneRelationships.hasOwnProperty(n)?r.ManyToOneRelationships[n]:null}function k(e,t,n,r){const a=b(e,t);if(a&&a.ManyToOneRelationships)for(const e in a.ManyToOneRelationships){const t=a.ManyToOneRelationships[e];if(t.ReferencedEntity===n&&t.ReferencingAttribute===r)return t}return null}function L(e,t,n,r){let a=k(e,t,n,r);if(!a){const i=b(e,t);i&&i.ManyToOneRelationships&&i.IsActivity&&(a=k(e,"activitypointer",n,r))}return a}function B(e,t){const n=A(e,t);if(!n)return null;const r=[];for(const e in n){const a=n[e];if(a.ReferencedEntity===t&&"activityparty"===a.ReferencingEntity){if("campaignactivity"===t&&"campaignactivity_activity_parties"!==e||"bulkoperation"===t&&"bulkoperation_activity_parties"!==e)continue;r.push(a)}}return 1===r.length?r[0]:null}function U(e,t,n){const r=b(e,t);if(r&&r.ManyToOneRelationships)for(const e in r.ManyToOneRelationships){const t=r.ManyToOneRelationships[e];if(t.ReferencingEntityNavigationPropertyName===n)return t}return null}function V(e,t,n){const r=b(e,t);return r&&r.ManyToManyRelationships&&r.ManyToManyRelationships.hasOwnProperty(n)?r.ManyToManyRelationships[n]:null}function z(e,t,n){return D(e,t,n)?0:V(e,t,n)?1:F(e,t,n)?-1:null}function q(e,t,n){var r;return null===(r=W(e,t,n))||void 0===r?void 0:r.relationship}function H(e,t,n){var r;return null===(r=G(e,t,n))||void 0===r?void 0:r.relationship}function W(e,t,n){const r=A(e,t);if(r)for(const e of Object.keys(r)){const t=r[e];if(t.ReferencedEntityNavigationPropertyName===n)return{name:e,relationship:t}}return null}function G(e,t,n){const r=R(e,t);if(r)for(const e of Object.keys(r)){const t=r[e];if(t.ReferencingEntityNavigationPropertyName===n)return{name:e,relationship:t}}return null}function K(e,t,n){const r=H(e,t,n);return r||q(e,t,n)}function Q(e,t,n){return q(e,t,n)?0:H(e,t,n)?2:-1}function X(e,t,n){const r=G(e,t,n);return r||W(e,t,n)}function Y(e,t){return e&&e.metadata&&e.metadata.entities&&t&&e.metadata.entities[t]?e.metadata.entities[t].PrimaryIdAttribute:null}function J(e,t){const n=b(e,t);return n?new Set(n.AttributeNames):null}function $(e,t){const n=t?b(e,t):null;return n?n.PrimaryNameAttribute:null}function Z(e,t){const n=b(e,t);return n&&n.ManyToManyRelationships?n.ManyToManyRelationships:null}function ee(e,t,n){return te(e,new a.a(t,n))}function te(e,t){const n=Object(p.a)(null,e,t.etn),r=Object(i.j)(e,t,n);return r?Object(s.c)(r):null}function ne(e,t){const n=b(e,t);return n&&n.IconVectorName?n.IconVectorName:null}function re(e,t,n,r){const a=A(e,t);for(const e in a){const t=a[e];if(Object(h.a)(r))return!1;if(t.ReferencedEntity===t.ReferencingEntity&&t.ReferencedEntity===n.etn&&t.ReferencingAttribute===r&&ae(t))return!0}return!1}function ae(e){return 1===e.CascadeConfiguration.Delete||ie(e.CascadeConfiguration.Assign)||ie(e.CascadeConfiguration.Share)||ie(e.CascadeConfiguration.Unshare)||ie(e.CascadeConfiguration.Reparent)}function ie(e){return 1===e||2===e||3===e}},idRo:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="add.appusersettings",a="update.appusersettings"},ijzp:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s}));var r=n("SAYH"),a=n("eXjw"),i=n("LbMF");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const o="businessProcessflow.instance.update.navigationentities";function s(e,t){return{type:"businessProcessflow.instance.update.navigationentities.sync",sync:!0,execute({dispatch:n,getState:s},c,l){const u=e.etn+"id",d="bpf_"+u,p=null!=Object(i.a)(s(),t.etn,d)?d:u;null!=Object(i.a)(s(),t.etn,p)||c.TraceManager.getTracer("BusinessProcessFlow.UpdateBusinessProcessNavigationEntities").error("Attribute does not exist",[{name:"attribute",value:p},{name:"entity",value:e.etn}]),n(function(e,t,n){const i={entities:{[t.etn]:{[r.a.toString(t.id)]:{initialized:a.a.Initialized,fields:{[n]:{reference:e,timestamp:new Date,validationResult:{isValueValid:!0,errorMessage:null,errorId:null,userInput:""}}}}}}};return{type:o,payload:i}}(e,t,p))}}}},izYK:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(){function e(){}return e.TwoOptions="TwoOptions",e.DateAndTimeDateOnly="DateAndTime.DateOnly",e.DateAndTimeDateAndTime="DateAndTime.DateAndTime",e.Decimal="Decimal",e.FP="FP",e.WholeNone="Whole.None",e.WholeDuration="Whole.Duration",e.WholeTimeZone="Whole.TimeZone",e.WholeLanguage="Whole.Language",e.LookupSimple="Lookup.Simple",e.LookupCustomer="Lookup.Customer",e.LookupOwner="Lookup.Owner",e.LookupPartyList="Lookup.PartyList",e.LookupRegarding="Lookup.Regarding",e.LookupMultiEntity="Lookup.MultiEntity",e.MultiSelectPicklist="MultiSelectPicklist",e.Multiple="Multiple",e.Currency="Currency",e.Object="Object",e.OptionSet="OptionSet",e.StatusOptionSet="StatusOptionSet",e.EntityNameOptionSet="EntityNameOptionSet",e.SingleLineEmail="SingleLine.Email",e.SingleLineText="SingleLine.Text",e.SingleLineTextArea="SingleLine.TextArea",e.SingleLineURL="SingleLine.URL",e.SingleLineTickerSymbol="SingleLine.Ticker",e.SingleLinePhone="SingleLine.Phone",e.Grid="Grid",e.BusinessProcessFlow="BusinessProcessFlow",e.WebResourceHtmlControl="WebResource.HTML",e.TimelineWall="TimelineWall",e.QuickForm="Form.QuickForm",e.Card="Card",e.Dashboard="Dashboard",e.Search="Search",e.SearchWidget="SearchWidget.SearchWidget",e.KbArticle="KbArticle",e.KbContent="KbContent",e.PowerBI="PowerBI",e.MicrosoftFlow="MicrosoftFlow",e.EmailEngagementRecipientActivity="emailrecipientactivitycontrol",e.ReferencePanelSearchWidget="SearchWidget.ReferencePanelSearchWidget",e.Timer="Timer",e.SingleLineAddress="SingleLine.Address",e.GlobalFilter="GlobalFilter",e.AppliedFilters="AppliedFilters",e.ReferencePanel="ReferencePanel",e.EmailEngagementActions="emailengagementactionscontrol",e.SocialInsightsControl="SocialInsightsControl",e.File="File",e.Image="Image",e.ClassIdTypeMap={"67fac785-cd58-4f9f-abb3-4b7ddc6ed5ed":"boolean","b0c6723a-8503-4fd7-bb28-c8a06ac933c2":"boolean","5b773807-9fb2-42db-97c3-7a91eff8adff":"datetime","c3efe0c3-0ec6-42be-8349-cbd9079dfd8e":"decimal","0a7ff475-b016-4687-9ce5-042bfdbd6519":"file","0d2c745a-e5a8-4c8f-ba63-c6d3bb604660":"float","7e548b0d-209c-477b-9dcd-f0f44472381d":"image","aa987274-ce4e-4271-a803-66164311a958":"integer","c6d124ca-7eda-4a60-aea9-7fb8d318b68f":"integer","671a9387-ca5a-4d1e-8ab7-06e39ddcf6b5":"integer","7c624a0b-f59e-493d-9583-638d34759266":"integer","270bd3db-d9af-4782-9025-509e298dec0a":"lookup","3246f906-1f71-45f7-b11f-d7be0f9d04c9":"lookup","f3015350-44a2-4aa0-97b5-00166532b5e9":"lookup","cbfb742c-14e7-4a17-96bb-1a13f7f64aa2":"partylist","e0dece4b-6fc8-4a8f-a065-082708572369":"memo","533b9e00-756b-4312-95a0-dc888637ac78":"money","3ef39988-22bb-4f0b-bbbe-64b5a3748aee":"picklist","5d68b988-0661-4db2-bc3e-17598ad3be6c":"status","ada2203e-b4cd-49be-9ddf-234642b43b52":"text","4273edbd-ac1d-40d3-9fb2-095c621b552d":"text","8c10015a-b339-4982-9474-a95fe05631a5":"text","71716b6c-711e-476c-8ab8-5d11542bfb47":"text","1e1fc551-f7a8-43af-ac34-a8dc35c7b6d4":"text","9c5ca0a1-ab4d-4781-be7e-8dfbe867b87e":"Timer"},e.ClassIdControlMap={"fd2a7985-3187-444e-908d-6624b21f69c0":"iframe","270bd3db-d9af-4782-9025-509e298dec0a":"lookup","f3015350-44a2-4aa0-97b5-00166532b5e9":"regarding","cbfb742c-14e7-4a17-96bb-1a13f7f64aa2":"partylist","aa987274-ce4e-4271-a803-66164311a958":"duration","c6d124ca-7eda-4a60-aea9-7fb8d318b68f":"integer","0d2c745a-e5a8-4c8f-ba63-c6d3bb604660":"float","533b9e00-756b-4312-95a0-dc888637ac78":"money","c3efe0c3-0ec6-42be-8349-cbd9079dfd8e":"decimal","ada2203e-b4cd-49be-9ddf-234642b43b52":"email","6f3fb987-393b-4d2d-859f-9d0f0349b6ad":"emailbody","4273edbd-ac1d-40d3-9fb2-095c621b552d":"text","e0dece4b-6fc8-4a8f-a065-082708572369":"memo","71716b6c-711e-476c-8ab8-5d11542bfb47":"url","1e1fc551-f7a8-43af-ac34-a8dc35c7b6d4":"tickersymbol","3ef39988-22bb-4f0b-bbbe-64b5a3748aee":"picklist","5d68b988-0661-4db2-bc3e-17598ad3be6c":"status","5b773807-9fb2-42db-97c3-7a91eff8adff":"datetime","67fac785-cd58-4f9f-abb3-4b7ddc6ed5ed":"boolean","b0c6723a-8503-4fd7-bb28-c8a06ac933c2":"boolean","671a9387-ca5a-4d1e-8ab7-06e39ddcf6b5":"language","e7a81278-8635-4d9e-8d4d-59480b391c5b":"subgrid","7c624a0b-f59e-493d-9583-638d34759266":"timezone","3246f906-1f71-45f7-b11f-d7be0f9d04c9":"connection","821acf1a-7e46-4a0c-965d-fe14a57d78c7":"connectionroleojbjecttypecodelist","9fdf5f91-88b1-47f4-ad53-c11efc01a01d":"webResourceHtml","587cdf98-c1d5-4bde-8473-14a0bc7644a7":"webResourceImage","080677db-86ec-4544-ac42-f927e74b491f":"webResourceSilverlight","8c54228c-1b25-4909-a12a-f2b968bb0d62":"powerBITile","06375649-c143-495e-a496-c962e5b4488e":"notes","5c5600e0-1d6e-4205-a272-be80da87fd42":"quickformcollection","b68b05f0-a46d-43f8-843b-917920af806a":"referencepanelquickformcollection","02d4264b-47e2-4b4c-aa95-f439f3f4d458":"referencepanelsubgrid","1f179106-fa28-4495-961e-f6bd93c21974":"interactionwall","62b0df79-0464-470f-8af7-4483cfea0c7d":"bingmap","86b9e25e-695e-4fef-ac69-f05cfa96739c":"socialInsight","76b9e25e-695e-4fef-ac69-f05cfa96739c":"orgInsights","9c5ca0a1-ab4d-4781-be7e-8dfbe867b87e":"timercontrol","e616a57f-20e0-4534-8662-a101b5ddf4e0":"searchwidget","03c5aed6-ee88-404e-b63c-4c53429c8bfb":"kbarticle","1b9fc842-b45e-4fc1-b080-81e96b6d857f":"kbcontent","7ccd1494-1f7a-4e3a-8bde-f32069daeb9f":"referencepanelsearchwidget","ee9078c8-6946-4e2c-b8f8-35e65f4be6a8":"queuecontainer","f130d8ae-ce5b-43c5-bed1-1a6a5856cf3d":"multiplepiechart","6fae836f-fc01-48de-9b63-9b68a8fd86b8":"tagcontrol","f9a8a302-114e-466a-b582-6771b2ae0d92":"customControl","c8bfbbef-6851-4401-a0cc-7450062fe085":"aci","8c10015a-b339-4982-9474-a95fe05631a5":"phone","d2561f53-b292-42d9-b222-478e40ffe29f":"dashboard","7c7059a6-74d9-4b02-80ad-19bc60426393":"search","39354e4a-5015-4d74-8031-ea9eb73a1322":"label","fff0e632-9d7b-4f21-bbc1-05d1567ad144":"globalfilter","9c310a73-a360-42c5-8943-47a06f1b51ea":"appliedfilters","7e548b0d-209c-477b-9dcd-f0f44472381d":"image","0a7ff475-b016-4687-9ce5-042bfdbd6519":"file"},e}()},j074:function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function o(e){return e.filter((function(t,n){return e.lastIndexOf(t)===n}))}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(t){for(var n=0,i=arguments.length<=1?0:arguments.length-1;n<i;++n){var s=n+1<1||arguments.length<=n+1?void 0:arguments[n+1];for(var c in s){var l=s[c],u=t[c];if(u&&l){if(Array.isArray(u)){t[c]=o(u.concat(l));continue}if(Array.isArray(l)){t[c]=o([u].concat(a(l)));continue}if("object"===r(l)){t[c]=e({},u,l);continue}}t[c]=l}}return t}},j63P:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("84PK"),a=n("504W");class i{constructor(e,t,n,o,s,c,l,u,d,p,f,g,h,m,b,y,_,v,S,O,C,E,I,w,j,P,T,N,A,R,D,x,M,F,k,L,B,U,V,z,q,H,W,G,K,Q,X,Y,J,$,Z,ee,te,ne,re,ae,ie,oe,se,ce,le,ue,de,pe,fe,ge,he,me,be,ye,_e,ve,Se,Oe,Ce,Ee,Ie,we,je,Pe,Te,Ne,Ae,Re,De,xe,Me,Fe,ke,Le,Be,Ue,Ve,ze,qe,He,We,Ge,Ke,Qe,Xe,Ye,Je,$e,Ze,et,tt,nt,rt,at,it,ot,st,ct,lt,ut,dt,pt,ft,gt,ht,mt,bt,yt,_t,vt,St,Ot,Ct,Et,It){this._organizationId=null,this._organizationName=null,this._organizationUniqueName=null,this._languageCode=0,this._enabledLanguages=null,this._currencyDisplayOption=0,this._blockedAttachments=null,this._reportScriptErrors=0,this._orgCultureInfoLcid=0,this._fullNameConventionCode=0,this._fiscalPeriodFormatPeriod=0,this._fiscalYearFormatPrefix=0,this._fiscalYearFormatYear=0,this._fiscalYearFormatSuffix=0,this._fiscalPeriodType=0,this._fiscalYearDisplayCode=0,this._fiscalPeriodConnector=null,this._isAutoSaveEnabled=!0,this._appointmentRichEditorExperience=!1,this._allowLegacyDialogsEmbedding=!1,this._allowLegacyClientExperience=!1,this._cdsCapabilityMode=2,this._enableUnifiedInterfaceShellRefresh=!1,this._isDuplicateDetectionEnabled=!1,this._isDuplicateDetectionEnabledForOnlineCreateUpdate=!1,this._isTelemetryEnabled=!1,this._isTrialOrganization=!1,this._orgExpiryDate=null,this._isPreviewOrganization=!1,this._isSandboxOrganization=!1,this._isSovereignCloud=!1,this._advancedDebuggabilitySettings="",this._showWeekNumber=!1,this._isSOPIntegrationEnabled=!1,this._baseCurrencyId=null,this._useSkypeProtocol=!1,this._defaultCountryCode=null,this._geoName=null,this._pricingDecimalPrecision=0,this._isMocaOfflineFeatureEnabled=!1,this._mobileOfflineSyncInterval=0,this._norsyncServerConnectionString=null,this._overrideTrackInCrmBehaviour=!1,this._currentThemeData=null,this._logoTooltip=null,this._logoImagePath=null,this._sessionTimeoutInSeconds=0,this._sessionTimeoutReminderInSeconds=0,this._inactivityTimeoutInSeconds=0,this._inactivityTimeoutReminderInSeconds=0,this._webServiceCallRetryPolicies=null,this._delveUrl=null,this._kmUseExternalPortal=!1,this._kmExternalPortalUrl=null,this._isParature=!1,this._isKMConfigured=!1,this._maxIncidentMergeNumber=0,this._maxChildIncidentNumber=0,this._isConflictDetectionEnabledForMobileClient=!1,this._webResourceHash=null,this._isPowerBIEnabled=!1,this._firstPartyIntegrationSiteUrl=null,this._isMicrosoftFlowEnabled=!1,this._microsoftFlowEnvironmentId=null,this._microsoftFlowFirstPartyIntegrationSiteUrl=null,this._microsoftFlowDestinationUrl=null,this._enableLPAuthoring=!1,this._isContextualHelpEnabled=!1,this._isExternalSearchIndexEnabled=!1,this._sharePointDeploymentType=0,this._isOneDriveEnabled=!1,this._isMSTeamsEnabled=!1,this._isContextualEmailEnabled=!1,this._isRichTextNotesEnabled=!1,this._isAutoDataCaptureV2Enabled=!1,this._isManualSalesForecastingEnabled=!1,this._isActionCardEnabled=!1,this._enableImmersiveSkypeIntegration=!1,this._isEmailMonitoringAllowed=!1,this._allowUnresolvedPartiesOnEmailSend=!1,this._isPresenceEnabled=!1,this._boundDashboardDefaultCardExpanded=!1,this._officePortalUrl="",this._ppacSettingsUrl="",this._customizationUrl="",this._isCrmOrg=!0,this._yammerGroupId=0,this._yammerNetworkName=null,this._yammerOAuthAccessTokenExpired=!1,this._yammerPostMethod=0,this._enableBingMapsIntegration=!1,this._bingMapsApiKey=null,this._availableBingMapLocales=null,this._excludedCountriesForMaps=null,this._bFDatacenter=!1,this._globalHelpUrl=null,this._globalHelpUrlEnabled=!1,this._globalAppendUrlParametersEnabled=!1,this._privacyStatementUrl=null,this._organizationTenant=null,this._securitySettingForEmail=0,this._enableActivitiesTimeLinePerfImprovement=0,this._gridTotalRecordCountLimit=0,this._enableLivePersonaCardUCI=!1,this._livePersonaCardComplianceEnvironment=null,this._livePersonaCardCulture=null,this._livePersonaCardFirstPartyIntegrationUrl=null,this._livePersonaCardRegion=null,this._areJquery3IncompatibleSolutionsInstalled=!1,this._useQuickFindViewForGridSearch=!1,this._newSearchExperienceEnabled=!1,this._relevanceSearchEnabledByPlatform=!1,this._improveSearchLoggingEnabled=!1,this._lookupCharacterCountBeforeResolve=null,this._lookupResolveDelayMS=null,this._defaultCrmCustomName=null,this._organizationBAPEnvironmentID=null,this._advancedLookupEnabled=null,this._advancedColumnEditorEnabled=!0,this._advancedColumnFilteringEnabled=!0,this._modernAdvancedFindFiltering=!1,this._allowUsersHidingSystemViews=!1,this._quickActionToOpenRecordsInSidePaneEnabled=null,this._isCollaborationExperienceEnabled=null,this._isSharingInOrgAllowed=null,this._copresenceRefreshRate=null,this._enableAsyncMergeAPIForUCI=null,this._pcfDatasetGridEnabled=null,this._userRatingEnabled=!0,this._appointmentWithTeamsMeetingEnabled=null,this._maxUploadFileSize=i.defaultMaxUploadFileSize,this._fiscalCalendarStart=new Date(0,0,1),this._organizationId=Object(a.a)(e)?r.a.get_empty():e,this._organizationName=Object(a.b)(t)?"":t,this._languageCode=n,this._enabledLanguages=Object(a.a)(o)?new Array(0):o,this._currencyDisplayOption=s,this._blockedAttachments=Object(a.b)(c)?"":c,this._maxUploadFileSize=l,this._reportScriptErrors=u,this._orgCultureInfoLcid=g,this._fullNameConventionCode=h,this._fiscalCalendarStart=Object(a.a)(m)?new Date:m,this._fiscalPeriodFormatPeriod=b,this._fiscalYearFormatYear=_,this._fiscalYearFormatPrefix=y,this._fiscalYearFormatSuffix=v,this._fiscalPeriodType=S,this._fiscalYearDisplayCode=O,this._fiscalPeriodConnector=Object(a.b)(C)?"":C,this._isAutoSaveEnabled=d,this._appointmentRichEditorExperience=Ne,this._isDuplicateDetectionEnabled=p,this._isDuplicateDetectionEnabledForOnlineCreateUpdate=f,this._isSOPIntegrationEnabled=E,this._baseCurrencyId=Object(a.a)(I)?r.a.get_empty():I,this._organizationUniqueName=Object(a.b)(w)?"":w,this._useSkypeProtocol=j,this._defaultCountryCode=Object(a.b)(P)?"":P,this._geoName=Object(a.b)(T)?"":T,this._pricingDecimalPrecision=N,this._isTelemetryEnabled=A,this._isMocaOfflineFeatureEnabled=R,this._mobileOfflineSyncInterval=D,this._norsyncServerConnectionString=Object(a.b)(x)?"":x,this._overrideTrackInCrmBehaviour=M,this._showWeekNumber=F,this._currentThemeData=Object(a.b)(k)?"":k,this._logoImagePath=L,this._logoTooltip=B,this._sessionTimeoutInSeconds=U,this._sessionTimeoutReminderInSeconds=V,this._inactivityTimeoutInSeconds=z,this._inactivityTimeoutReminderInSeconds=q,this._delveUrl=Object(a.b)(H)?"":H,this._kmUseExternalPortal=W,this._kmExternalPortalUrl=Object(a.b)(G)?"":G,this._isParature=K,this._isKMConfigured=Q,this._maxIncidentMergeNumber=X,this._maxChildIncidentNumber=Y,this._isConflictDetectionEnabledForMobileClient=J,this._webResourceHash=$,this._isPowerBIEnabled=Z,this._firstPartyIntegrationSiteUrl=ee,this._enableLPAuthoring=te,this._isContextualHelpEnabled=ne,this._isMicrosoftFlowEnabled=re,this._microsoftFlowFirstPartyIntegrationSiteUrl=ae,this._isExternalSearchIndexEnabled=ie,this._microsoftFlowDestinationUrl=oe,this._microsoftFlowEnvironmentId=se,this._sharePointDeploymentType=ce,this._isOneDriveEnabled=le,this._isMSTeamsEnabled=ue,this._isContextualEmailEnabled=de,this._isRichTextNotesEnabled=nt,this._isAutoDataCaptureV2Enabled=pe,this._isManualSalesForecastingEnabled=fe,this._isActionCardEnabled=ge,this._enableImmersiveSkypeIntegration=he,this._isEmailMonitoringAllowed=me,this._allowUnresolvedPartiesOnEmailSend=be,this._isPresenceEnabled=ye,this._boundDashboardDefaultCardExpanded=_e,this._isPreviewOrganization=ve,this._isSandboxOrganization=Se,this._isSovereignCloud=Oe,this._advancedDebuggabilitySettings=Ce,this._officePortalUrl=Ee,this._ppacSettingsUrl=Object(a.b)(tt)?"":tt,this._customizationUrl=Object(a.b)(at)?"":at,this._isCrmOrg=Ie,this._yammerGroupId=we,this._yammerNetworkName=je,this._yammerOAuthAccessTokenExpired=Pe,this._yammerPostMethod=Te,this._enableBingMapsIntegration=Ae,this._bingMapsApiKey=Re,this._availableBingMapLocales=De,this._excludedCountriesForMaps=xe,this._bFDatacenter=Me,this._allowLegacyDialogsEmbedding=Fe,this._allowLegacyClientExperience=ke,this._cdsCapabilityMode=Le,this._enableUnifiedInterfaceShellRefresh=Be,this._globalHelpUrl=Ue,this._privacyStatementUrl=Ve,this._organizationTenant=ze,this._securitySettingForEmail=qe,this._enableActivitiesTimeLinePerfImprovement=He,this._gridTotalRecordCountLimit=We,this._enableLivePersonaCardUCI=Ge,this._livePersonaCardComplianceEnvironment=Ke,this._livePersonaCardCulture=Qe,this._livePersonaCardFirstPartyIntegrationUrl=Xe,this._livePersonaCardRegion=Ye,this._globalHelpUrlEnabled=Je,this._globalAppendUrlParametersEnabled=$e,this._areJquery3IncompatibleSolutionsInstalled=Ze,this._useQuickFindViewForGridSearch=et,this._newSearchExperienceEnabled=it,this._relevanceSearchEnabledByPlatform=ft,this._improveSearchLoggingEnabled=ot,this._lookupCharacterCountBeforeResolve=st,this._lookupResolveDelayMS=ct,this._defaultCrmCustomName=rt,this._organizationBAPEnvironmentID=lt,this._isTrialOrganization=ut,this._orgExpiryDate=dt,this._advancedLookupEnabled=pt,this._quickActionToOpenRecordsInSidePaneEnabled=gt,this._isCollaborationExperienceEnabled=ht,this._isSharingInOrgAllowed=mt,this._copresenceRefreshRate=bt,this._advancedColumnEditorEnabled=yt,this._advancedColumnFilteringEnabled=_t,this._modernAdvancedFindFiltering=vt,this._allowUsersHidingSystemViews=St,this._enableAsyncMergeAPIForUCI=Ot,this._userRatingEnabled=Ct,this._pcfDatasetGridEnabled=Et,this._appointmentWithTeamsMeetingEnabled=It}get_organizationId(){return this._organizationId}get_organizationName(){return this._organizationName}get_delveUrl(){return this._delveUrl}get_kmUseExternalPortal(){return this._kmUseExternalPortal}get_kmExternalPortalUrl(){return this._kmExternalPortalUrl}get_organizationUniqueName(){return this._organizationUniqueName}get_languageCode(){return this._languageCode}get_enabledLanguages(){return this._enabledLanguages}get_currencyDisplayOption(){return this._currencyDisplayOption}get_blockedAttachments(){return this._blockedAttachments}get_maxUploadFileSize(){return this._maxUploadFileSize}get_reportScriptErrors(){return this._reportScriptErrors}get_orgCultureInfoLcid(){return this._orgCultureInfoLcid}get_fullNameConventionCode(){return this._fullNameConventionCode}get_fiscalCalendarStart(){return this._fiscalCalendarStart}get_fiscalPeriodFormatPeriod(){return this._fiscalPeriodFormatPeriod}get_fiscalPeriodType(){return this._fiscalPeriodType}get_fiscalYearFormatYear(){return this._fiscalYearFormatYear}get_fiscalYearFormatPrefix(){return this._fiscalYearFormatPrefix}get_fiscalYearFormatSuffix(){return this._fiscalYearFormatSuffix}get_fiscalYearDisplayCode(){return this._fiscalYearDisplayCode}get_fiscalPeriodConnector(){return this._fiscalPeriodConnector}get_isAutoSaveEnabled(){return this._isAutoSaveEnabled}get_appointmentRichEditorExperience(){return this._appointmentRichEditorExperience}get_allowLegacyDialogsEmbedding(){return this._allowLegacyDialogsEmbedding}get_allowLegacyClientExperience(){return this._allowLegacyClientExperience}get_cdsCapabilityMode(){return this._cdsCapabilityMode}get_enableUnifiedInterfaceShellRefresh(){return this._enableUnifiedInterfaceShellRefresh}get_isDuplicateDetectionEnabled(){return this._isDuplicateDetectionEnabled}get_isDuplicateDetectionEnabledForOnlineCreateUpdate(){return this._isDuplicateDetectionEnabledForOnlineCreateUpdate}get_isTelemetryEnabled(){return this._isTelemetryEnabled}get_isTrialOrganization(){return this._isTrialOrganization}get_orgExpiryDate(){return this._orgExpiryDate}get_isPreviewOrganization(){return this._isPreviewOrganization}get_isSandboxOrganization(){return this._isSandboxOrganization}get_isSovereignCloud(){return this._isSovereignCloud}get_advancedDebuggabilitySettings(){return this._advancedDebuggabilitySettings}get_isMocaOfflineFeatureEnabled(){return this._isMocaOfflineFeatureEnabled}get_mobileOfflineSyncInterval(){return this._mobileOfflineSyncInterval}get_norsyncServerConnectionString(){return this._norsyncServerConnectionString}get_isSOPIntegrationEnabled(){return this._isSOPIntegrationEnabled}get_baseCurrencyId(){return this._baseCurrencyId}get_defaultCountryCode(){return this._defaultCountryCode}get_geoName(){return this._geoName}get_useSkypeProtocol(){return this._useSkypeProtocol}get_overrideTrackInCrmBehaviour(){return this._overrideTrackInCrmBehaviour}get_currentThemeData(){return this._currentThemeData}get_logoImagePath(){return this._logoImagePath}get_logoTooltip(){return this._logoTooltip}get_sessionTimeoutInSeconds(){return this._sessionTimeoutInSeconds}get_sessionTimeoutReminderInSeconds(){return this._sessionTimeoutReminderInSeconds}get_inactivityTimeoutInSeconds(){return this._inactivityTimeoutInSeconds}get_inactivityTimeoutReminderInSeconds(){return this._inactivityTimeoutReminderInSeconds}get_pricingDecimalPrecision(){return this._pricingDecimalPrecision}get_showWeekNumber(){return this._showWeekNumber}get_isParature(){return this._isParature}get_isKMConfigured(){return this._isKMConfigured}get_maxIncidentMergeNumber(){return this._maxIncidentMergeNumber}get_maxChildIncidentNumber(){return this._maxChildIncidentNumber}get_isConflictDetectionEnabledForMobileClient(){return this._isConflictDetectionEnabledForMobileClient}get_webResourceHash(){return this._webResourceHash}get_isPowerBIEnabled(){return this._isPowerBIEnabled}get_firstPartyIntegrationSiteUrl(){return this._firstPartyIntegrationSiteUrl}get_isMicrosoftFlowEnabled(){return this._isMicrosoftFlowEnabled}get_microsoftFlowEnvironmentId(){return this._microsoftFlowEnvironmentId}get_microsoftFlowFirstPartyIntegrationSiteUrl(){return this._microsoftFlowFirstPartyIntegrationSiteUrl}get_microsoftFlowDestinationUrl(){return this._microsoftFlowDestinationUrl}get_enableLPAuthoring(){return this._enableLPAuthoring}get_isContextualHelpEnabled(){return this._isContextualHelpEnabled}get_isExternalSearchIndexEnabled(){return this._isExternalSearchIndexEnabled}get_sharePointDeploymentType(){return this._sharePointDeploymentType}get_isOneDriveEnabled(){return this._isOneDriveEnabled}get_isMSTeamsEnabled(){return this._isMSTeamsEnabled}get_isContextualEmailEnabled(){return this._isContextualEmailEnabled}get_isRichTextNotesEnabled(){return this._isRichTextNotesEnabled}get_isAutoDataCaptureV2Enabled(){return this._isAutoDataCaptureV2Enabled}get_isManualSalesForecastingEnabled(){return this._isManualSalesForecastingEnabled}get_isActionCardEnabled(){return this._isActionCardEnabled}get_enableImmersiveSkypeIntegration(){return this._enableImmersiveSkypeIntegration}get_isEmailMonitoringAllowed(){return this._isEmailMonitoringAllowed}get_allowUnresolvedPartiesOnEmailSend(){return this._allowUnresolvedPartiesOnEmailSend}get_isPresenceEnabled(){return this._isPresenceEnabled}get_boundDashboardDefaultCardExpanded(){return this._boundDashboardDefaultCardExpanded}get_officePortalUrl(){return this._officePortalUrl}get_ppacSettingsUrl(){return this._ppacSettingsUrl}get_customizationUrl(){return this._customizationUrl}get_isCrmOrg(){return this._isCrmOrg}get_yammerGroupId(){return this._yammerGroupId}get_yammerNetworkName(){return this._yammerNetworkName}get_yammerOAuthAccessTokenExpired(){return this._yammerOAuthAccessTokenExpired}get_yammerPostMethod(){return this._yammerPostMethod}get_enableBingMapsIntegration(){return this._enableBingMapsIntegration}get_bingMapsApiKey(){return this._bingMapsApiKey}get_availableBingMapLocales(){return this._availableBingMapLocales}get_excludedCountriesForMaps(){return this._excludedCountriesForMaps}get_bfDatacenter(){return this._bFDatacenter}get_globalHelpUrl(){return this._globalHelpUrl}get_globalHelpUrlEnabled(){return this._globalHelpUrlEnabled}get_globalAppendUrlParametersEnabled(){return this._globalAppendUrlParametersEnabled}get_privacyStatementUrl(){return this._privacyStatementUrl}get_organizationTenant(){return this._organizationTenant}get_securitySettingForEmail(){return this._securitySettingForEmail}get_enableActivitiesTimeLinePerfImprovement(){return this._enableActivitiesTimeLinePerfImprovement}get_gridTotalRecordCountLimit(){return this._gridTotalRecordCountLimit}get_enableLivePersonaCardUCI(){return this._enableLivePersonaCardUCI}get_livePersonaCardComplianceEnvironment(){return this._livePersonaCardComplianceEnvironment}get_livePersonaCardCulture(){return this._livePersonaCardCulture}get_livePersonaCardFirstPartyIntegrationUrl(){return this._livePersonaCardFirstPartyIntegrationUrl}get_defaultCrmCustomName(){return this._defaultCrmCustomName}get_organizationBAPEnvironmentID(){return this._organizationBAPEnvironmentID}get_livePersonaCardRegion(){return this._livePersonaCardRegion}get_areJquery3IncompatibleSolutionsInstalled(){return this._areJquery3IncompatibleSolutionsInstalled}get_useQuickFindViewForGridSearch(){return this._useQuickFindViewForGridSearch}get_newSearchExperienceEnabled(){return this._newSearchExperienceEnabled}get_relevanceSearchEnabledByPlatform(){return this._relevanceSearchEnabledByPlatform}get_improveSearchLoggingEnabled(){return this._improveSearchLoggingEnabled}get_lookupCharacterCountBeforeResolve(){return this._lookupCharacterCountBeforeResolve}get_lookupResolveDelayMS(){return this._lookupResolveDelayMS}get_webServiceCallRetryPolicies(){return this._webServiceCallRetryPolicies}set_webServiceCallRetryPolicies(e){return this._webServiceCallRetryPolicies=e,e}get_advancedLookupEnabled(){return this._advancedLookupEnabled}get_quickActionToOpenRecordsInSidePaneEnabled(){return this._quickActionToOpenRecordsInSidePaneEnabled}get_advancedColumnFilteringEnabled(){return this._advancedColumnFilteringEnabled}get_modernAdvancedFindFiltering(){return this._modernAdvancedFindFiltering}get_allowUsersHidingSystemViews(){return this._allowUsersHidingSystemViews}get_advancedColumnEditorEnabled(){return this._advancedColumnEditorEnabled}get_isCollaborationExperienceEnabled(){return this._isCollaborationExperienceEnabled}get_isSharingInOrgAllowed(){return this._isSharingInOrgAllowed}get_copresenceRefreshRate(){return this._copresenceRefreshRate}get_enableAsyncMergeAPIForUCI(){return this._enableAsyncMergeAPIForUCI}get_userRatingEnabled(){return this._userRatingEnabled}get_pcfDatasetGridEnabled(){return this._pcfDatasetGridEnabled}get_appointmentWithTeamsMeetingEnabled(){return this._appointmentWithTeamsMeetingEnabled}getObjectData(){const e={};return e.organizationid=this._organizationId.getObjectData(),e.organizationname=this._organizationName,e.languagecode=this._languageCode,e.enabledlanguages=this._enabledLanguages,e.currencydisplayoption=this._currencyDisplayOption,e.blockedattachments=this._blockedAttachments,e.maxuploadfilesize=this._maxUploadFileSize,e.reportscripterrors=this._reportScriptErrors,e.orgcultureinfolcid=this._orgCultureInfoLcid,e.fullnameconventioncode=this._fullNameConventionCode,e.fiscalcalendarstart=this._fiscalCalendarStart,e.issopintegrationenabled=this._isSOPIntegrationEnabled,e.basecurrencyid=this._baseCurrencyId.getObjectData(),e.webservicecallretrypolicies=this._webServiceCallRetryPolicies,e.isAutoSaveEnabled=this._isAutoSaveEnabled,e.appointmentRichEditorExperience=this._appointmentRichEditorExperience,e.allowLegacyDialogsEmbedding=this._allowLegacyDialogsEmbedding,e.allowLegacyClientExperience=this._allowLegacyClientExperience,e.cdsCapabilityMode=this._cdsCapabilityMode,e.enableUnifiedInterfaceShellRefresh=this._enableUnifiedInterfaceShellRefresh,e.isDuplicateDetectionEnabled=this._isDuplicateDetectionEnabled,e.isDuplicateDetectionEnabledForOnlineCreateUpdate=this._isDuplicateDetectionEnabledForOnlineCreateUpdate,e.organizationuniquename=this._organizationUniqueName,e.useskypeprotocol=this.get_useSkypeProtocol(),e.defaultcountrycode=this.get_defaultCountryCode(),e.geoName=this.get_geoName(),e.pricingdecimalprecision=this.get_pricingDecimalPrecision(),e.istelemetryenabled=this._isTelemetryEnabled,e.ismocaofflinefeatureenabled=this._isMocaOfflineFeatureEnabled,e.mobileOfflineSyncInterval=this._mobileOfflineSyncInterval,e.norsyncServerConnectionString=this._norsyncServerConnectionString,e.overridetrackincrmbehaviour=this.get_overrideTrackInCrmBehaviour(),e.defaultthemedata=this.get_currentThemeData(),e.logoImagePath=this._logoImagePath,e.logoTooltip=this._logoTooltip,e.fiscalperiodformatperiod=this._fiscalPeriodFormatPeriod,e.fiscalyearformatprefix=this._fiscalYearFormatPrefix,e.fiscalyearformatyear=this._fiscalYearFormatYear,e.fiscalyearformatsuffix=this._fiscalYearFormatYear,e.fiscalperiodtype=this._fiscalPeriodType,e.fiscalyeardisplaycode=this._fiscalYearDisplayCode,e.fiscalperiodconnector=this._fiscalPeriodConnector,e.showweeknumber=this._showWeekNumber,e.kmuseexternalportal=this._kmUseExternalPortal,e.kmuseexternalportalurl=this._kmExternalPortalUrl,e.isParature=this._isParature,e.iskmconfigured=this._isKMConfigured,e.webresourcehash=this._webResourceHash,e.maxincidentmergenumber=this._maxIncidentMergeNumber,e.maxchildincidentnumber=this._maxChildIncidentNumber,e.isconflictdetectionenabledformobileclient=this._isConflictDetectionEnabledForMobileClient,e.enablelpauthoring=this._enableLPAuthoring,e.isContextualHelpEnabled=this._isContextualHelpEnabled,e.isMicrosoftFlowEnabled=this._isMicrosoftFlowEnabled,e.microsoftFlowEnvironmentId=this._microsoftFlowEnvironmentId,e.isExternalSearchIndexEnabled=this._isExternalSearchIndexEnabled,e.microsoftFlowFirstPartyIntegrationSiteUrl=this._microsoftFlowFirstPartyIntegrationSiteUrl,e.microsoftFlowDestinationUrl=this._microsoftFlowDestinationUrl,e.sharepointdeploymenttype=this._sharePointDeploymentType,e.isonedriveenabled=this._isOneDriveEnabled,e.ismsteamsenabled=this._isMSTeamsEnabled,e.isRichTextNotesEnabled=this._isRichTextNotesEnabled,e.iscontextualemailenabled=this._isContextualEmailEnabled,e.isAutoDataCaptureV2Enabled=this._isAutoDataCaptureV2Enabled,e.ismanualsalesforecastingenabled=this._isManualSalesForecastingEnabled,e.isActionCardEnabled=this._isActionCardEnabled,e.enableImmersiveSkypeIntegration=this._enableImmersiveSkypeIntegration,e.isEmailMonitoringAllowed=this.get_isEmailMonitoringAllowed(),e.allowUnresolvedPartiesOnEmailSend=this.get_allowUnresolvedPartiesOnEmailSend(),e.isPresenceEnabled=this.get_isPresenceEnabled(),e.boundDashboardDefaultCardExpanded=this.get_boundDashboardDefaultCardExpanded(),e.organizationTenant=this.get_organizationTenant(),e.securitySettingForEmail=this._securitySettingForEmail,e.enableActivitiesTimeLinePerfImprovement=this._enableActivitiesTimeLinePerfImprovement,e.gridTotalRecordCountLimit=this._gridTotalRecordCountLimit,e.enableLivePersonaCardUCI=this._enableLivePersonaCardUCI,e.livePersonaCardComplianceEnvironment=this._livePersonaCardComplianceEnvironment,e.livePersonaCardCulture=this._livePersonaCardCulture,e.livePersonaCardFirstPartyIntegrationUrl=this._livePersonaCardFirstPartyIntegrationUrl,e.livePersonaCardRegion=this._livePersonaCardRegion,e.areJquery3IncompatibleSolutionsInstalled=this._areJquery3IncompatibleSolutionsInstalled,e.useQuickFindViewForGridSearch=this._useQuickFindViewForGridSearch,e.newSearchExperienceEnabled=this._newSearchExperienceEnabled,e.relevanceSearchEnabledByPlatform=this._relevanceSearchEnabledByPlatform,e.improveSearchLoggingEnabled=this._improveSearchLoggingEnabled,e.lookupCharacterCountBeforeResolve=this._lookupCharacterCountBeforeResolve,e.lookupResolveDelayMS=this._lookupResolveDelayMS,e.isCrmOrg=this._isCrmOrg,e.organizationBAPEnvironmentID=this._organizationBAPEnvironmentID,e.isTrialOrganization=this._isTrialOrganization,e.orgExpiryDate=this._orgExpiryDate,e.advancedLookupEnabled=this._advancedLookupEnabled,e.quickActionToOpenRecordsInSidePaneEnabled=this._quickActionToOpenRecordsInSidePaneEnabled,e.isCollaborationExperienceEnabled=this._isCollaborationExperienceEnabled,e.isSharingInOrgAllowed=this._isSharingInOrgAllowed,e.copresenceRefreshRate=this._copresenceRefreshRate,e.advancedColumnEditorEnabled=this._advancedColumnEditorEnabled,e.advancedColumnFilteringEnabled=this._advancedColumnFilteringEnabled,e.modernAdvancedFindFiltering=this._modernAdvancedFindFiltering,e.allowUsersHidingSystemViews=this._allowUsersHidingSystemViews,e.enableAsyncMergeAPIForUCI=this._enableAsyncMergeAPIForUCI,e.userRatingEnabled=this._userRatingEnabled,e.pcfDatasetGridEnabled=this._pcfDatasetGridEnabled,e.appointmentWithTeamsMeetingEnabled=this._appointmentWithTeamsMeetingEnabled,e}getWebServiceCallRetryPolicy(e){if(!this._webServiceCallRetryPolicies)return null;for(let t=0;t<this._webServiceCallRetryPolicies.length;t++){const n=this._webServiceCallRetryPolicies[t];if(e.toLowerCase().indexOf(n.WebServiceUrl.toLowerCase())>=0)return n}return null}static createFromObjectData(e){const t=r.a.createFromObjectData(e.organizationid),n=e.organizationname,a=e.fiscalcalendarstart,o=e.fiscalperiodformatperiod,s=e.fiscalyearformatprefix,c=e.fiscalyearformatyear,l=e.fiscalyearformatsuffix,u=e.fiscalperiodtype,d=e.fiscalyeardisplaycode,p=e.fiscalperiodconnector,f=e.issopintegrationenabled,g=e.languagecode,h=e.enabledlanguages,m=e.currencydisplayoption,b=e.blockedattachments,y=e.maxuploadfilesize,_=e.reportscripterrors,v=e.isAutoSaveEnabled,S=e.appointmentRichEditorExperience,O=e.isDuplicateDetectionEnabled,C=e.isDuplicateDetectionEnabledForOnlineCreateUpdate,E=e.orgcultureinfolcid,I=e.fullnameconventioncode,w=r.a.createFromObjectData(e.basecurrencyid),j=e.organizationuniquename,P=e.useskypeprotocol,T=e.defaultcountrycode,N=e.geoName,A=e.pricingdecimalprecision,R=e.istelemetryenabled,D=e.ismocaofflinefeatureenabled,x=e.mobileOfflineSyncInterval,M=e.norsyncServerConnectionString,F=e.overridetrackincrmbehaviour,k=e.showweeknumber,L=e.defaultthemedata,B=e.delveurl,U=e.kmUseExternalPortal,V=e.kmExternalPortalUrl,z=e.isParature,q=e.iskmconfigured,H=e.maxincidentmergenumber,W=e.maxchildincidentnumber,G=e.webresourcehash,K=e.isconflictdetectionenabledformobileclient,Q=e.enablelpauthoring,X=e.iscontextualhelpenabled,Y=e.ispowerbienabled,J=e.firstpartyintegrationsiteurl,$=e.isMicrosoftFlowEnabled,Z=e.microsoftFlowFirstPartyIntegrationSiteUrl,ee=e.isExternalSearchIndexEnabled,te=e.microsoftFlowDestinationUrl,ne=e.microsoftFlowEnvironmentId,re=e.sharepointdeploymenttype,ae=e.isonedriveenabled,ie=e.ismsteamsenabled,oe=e.iscontextualemailenabled,se=e.isRichTextNotesEnabled,ce=e.isautodatacapturev2enabled,le=e.ismanualsalesforecastingenabled,ue=e.isActionCardEnabled,de=e.enableImmersiveSkypeIntegration,pe=e.isEmailMonitoringAllowed,fe=e.allowUnresolvedPartiesOnEmailSend,ge=e.isPresenceEnabled,he=e.boundDashboardDefaultCardExpanded,me=e.isPreviewOrganization,be=e.isSandboxOrganization,ye=e.isSovereignCloud,_e=e.advancedDebuggabilitySettings,ve=e.logoImagePath,Se=e.logoTooltip,Oe=e.sessionTimeoutInSeconds,Ce=e.sessionTimeoutReminderInSeconds,Ee=e.inactivityTimeoutInSeconds,Ie=e.inactivityTimeoutReminderInSeconds,we=e.officePortalUrl,je=e.ppacSettingsUrl,Pe=e.customizationUrl,Te=e.isCrmOrg,Ne=e.yammerGroupId,Ae=e.yammerNetworkName,Re=e.yammerOAuthAccessTokenExpired,De=e.yammerPostMethod,xe=e.enableBingMapsIntegration,Me=e.bingMapApiKey,Fe=e.availableBingMapLocales,ke=e.excludedCountriesForMaps,Le=e.bFDatacenter,Be=e.allowLegacyDialogsEmbedding,Ue=e.allowLegacyClientExperience,Ve=e.cdsCapabilityMode,ze=e.enableUnifiedInterfaceShellRefresh,qe=e.globalHelpUrl,He=e.privacyStatementUrl,We=e.organizationTenant,Ge=e.securitySettingForEmail,Ke=e.enableActivitiesTimeLinePerfImprovement,Qe=e.gridTotalRecordCountLimit,Xe=e.enableLivePersonaCardUCI,Ye=e.livePersonaCardComplianceEnvironment,Je=e.livePersonaCardCulture,$e=e.livePersonaCardFirstPartyIntegrationUrl,Ze=e.livePersonaCardRegion,et=e.globalHelpUrlEnabled,tt=e.globalAppendUrlParametersEnabled,nt=e.areJquery3IncompatibleSolutionsInstalled,rt=e.useQuickFindViewForGridSearch,at=e.defaultCrmCustomName,it=e.newSearchExperienceEnabled,ot=e.relevanceSearchEnabledByPlatform,st=e.improveSearchLoggingEnabled,ct=e.lookupCharacterCountBeforeResolve,lt=e.lookupResolveDelayMS,ut=e.organizationBAPEnvironmentID,dt=e.isTrialOrganization,pt=e.orgExpiryDate,ft=e.advancedLookupEnabled,gt=e.quickActionToOpenRecordsInSidePaneEnabled,ht=e.isCollaborationExperienceEnabled,mt=e.isSharingInOrgAllowed,bt=e.copresenceRefreshRate,yt=e.advancedColumnEditorEnabled,_t=e.advancedColumnFilteringEnabled,vt=e.modernAdvancedFindFiltering,St=e.allowUsersHidingSystemViews,Ot=e.enableAsyncMergeAPIForUCI,Ct=e.userRatingEnabled,Et=e.pcfDatasetGridEnabled,It=e.appointmentwithteamsmeeting,wt=new i(t,n,g,h,m,b,y,_,v,O,C,E,I,a,o,s,c,l,u,d,p,f,w,j,P,T,N,A,R,D,x,M,F,k,L,ve,Se,Oe,Ce,Ee,Ie,B,U,V,z,q,H,W,K,G,Y,J,Q,X,$,Z,ee,te,ne,re,ae,ie,oe,ce,le,ue,de,pe,fe,ge,he,me,be,ye,_e,we,Te,Ne,Ae,Re,De,S,xe,Me,Fe,ke,Le,Be,Ue,Ve,ze,qe,He,We,Ge,Ke,Qe,Xe,Ye,Je,$e,Ze,et,tt,nt,rt,je,se,at,Pe,it,st,ct,lt,ut,dt,pt,ft,ot,gt,ht,mt,bt,yt,_t,vt,St,Ot,Ct,Et,It);return wt.set_webServiceCallRetryPolicies(e.webservicecallretrypolicies),wt}}i.defaultMaxUploadFileSize=5242880},jAuy:function(e,t,n){"use strict";n.d(t,"h",(function(){return g})),n.d(t,"g",(function(){return h})),n.d(t,"j",(function(){return m})),n.d(t,"k",(function(){return v})),n.d(t,"f",(function(){return S})),n.d(t,"d",(function(){return C})),n.d(t,"c",(function(){return E})),n.d(t,"m",(function(){return I})),n.d(t,"a",(function(){return O})),n.d(t,"b",(function(){return _})),n.d(t,"e",(function(){return w})),n.d(t,"l",(function(){return j})),n.d(t,"i",(function(){return b}));var r=n("9fGf"),a=n("BFlg"),i=n("jRy5"),o=n("nJrx"),s=n("Lyxw"),c=n("3/02"),l=n("P6DH"),u=n("NjDY"),d=n("69Qu"),p=n("arV0"),f=n("sZ+8");function g(e,t,n){if(!n)return!1;const r=Object(s.f)(e,c.cd),a=Object(s.f)(e,c.cd),i=Object(s.f)(e,c.dd),o=Object(s.f)(e,c.fc);switch(t){case"Account_ActivityPointers":case"Contact_ActivityPointers":case"Opportunity_ActivityPointers":return!0;case"Lead_ActivityPointers":return o;case"opportunity_customer_accounts":case"quote_customer_accounts":case"order_customer_accounts":case"invoice_customer_accounts":case"incident_customer_accounts":case"account_contracts_as_customer":case"opportunity_customer_contacts":case"quote_customer_contacts":case"order_customer_contacts":case"invoice_customer_contacts":case"incident_customer_contacts":case"contact_contracts_as_customer":return r||a&&i}return!1}function h(e,t){return!!(t===r.a.Phone&&e&&e.Name===a.u&&e.Parameters&&e.Parameters.EnableEditing&&e.Parameters.EnableEditing.Value&&"yes"===e.Parameters.EnableEditing.Value.toLowerCase())}function m(e){const t=new DOMParser,n=new XMLSerializer;if(e){const r=t.parseFromString(e,"text/xml");if(r){const e=Array.prototype.slice.call(r.getElementsByTagName("condition"));return e&&e.forEach(e=>{e.getAttribute("value")&&e.setAttribute("value","X"),e.getAttribute("uiname")&&e.setAttribute("uiname","X");const t=Array.prototype.slice.call(e.getElementsByTagName("value"));t&&t.forEach(e=>{e.getAttribute("uiname")&&e.setAttribute("uiname","X"),e.textContent="X"})}),n.serializeToString(r)}return null}return null}function b(e){const t=new DOMParser;if(e){const n=t.parseFromString(e,"text/xml");if(n){const e=Array.prototype.slice.call(n.getElementsByTagName("condition")),t=Array.prototype.slice.call(n.getElementsByTagName("link-entity"));if(t&&e)for(const n of t)if("outer"===n.getAttribute("link-type"))for(const t of e)if(t.getAttribute("entityname")===n.getAttribute("alias"))return!0;if(e)for(const t of e)if(t.getAttribute("entityname"))return!1}}return!0}function y(e){if(e){const t=Array.prototype.slice.call(e.getElementsByTagName("attribute"));if(t)for(const e of t)if(e.getAttribute("alias")===l.c&&e.getAttribute("rowaggregate")===l.d)return e}return null}function _(e){if(e){if(y((new DOMParser).parseFromString(e,"text/xml")))return!0}return!1}function v(e){if(e){const t=new DOMParser,n=new XMLSerializer,r=t.parseFromString(e,"text/xml"),a=null==r?void 0:r.getElementsByTagName("fetch")[0];null==a||a.removeAttribute("returntotalrecordcount"),null==a||a.removeAttribute("count"),null==a||a.removeAttribute("page");const i=y(r);return i&&i.parentNode.removeChild(i),n.serializeToString(r)}return null}function S(e,t){for(const n of e)if(n.value===t)return n.text;return null}function O(e){return e?e+"_url":null}function C(e,t){return t.contextTokenType===i.a.MainGrid&&e}function E(e,t){return C(e,t)||Object(o.a)()}function I(e){e&&e.Name===a.D&&e.Parameters&&e.Parameters.EnableFiltering&&(e.Parameters.EnableFiltering.Value="yes")}function w(e){return Object(s.e)(e,c.r,null,c.q)}function j(e,t){const n=Object(p.j)(e,t),r=n&&n.entityTypeName?n.entityTypeName:"";return Object(s.f)(e,c.fd)&&(Object(d.c)(e)||Object(f.r)(e,r))&&!Object(u.I)(e)}},jCkl:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="appprogressindicator.create";function a(e){return{type:r,payload:{inProgress:!0,progressMessage:e}}}},jFgV:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("504W"),a=n("NMtn"),i=n("IvgJ"),o=n("P68g");class s{constructor(e){this._options=null,this._optionsInDisplayOrder=null,Object(a.d)(e,"options"),this._optionsInDisplayOrder=e,this._options=function(e){const t={};for(const n in e){const r={key:n,value:e[n]}.value;t[r.get_ValueString()]=r}return t}(e)}get_options(){return this._options}get_optionsInDisplayOrder(){return this._optionsInDisplayOrder}getObjectData(){return Object(r.a)(this._optionsInDisplayOrder)?{}:{optionsindisplayorder:Object(o.a)(this._optionsInDisplayOrder,e=>e.getObjectData())}}getODataObject(){if(Object(r.a)(this.get_optionsInDisplayOrder()))return null;const e={},t=[],n=this.get_optionsInDisplayOrder();for(const e in n){const r={key:e,value:n[e]};t.push(r.value.getODataObject())}return e.Options=t,e}static createFromObjectData(e){const t=e.optionsindisplayorder?e.optionsindisplayorder:{};return new s(Object(o.a)(t,e=>i.a.createFromObjectData(e)))}static createFromOData(e){const t={};for(let n=0;n<e.length;++n){const r=i.a.createFromOData(e[n]);t[n.toString()]=r}return new s(t)}}},jMf1:function(e,t){
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */},jPIj:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));class r{static createAttribute(e,t,n){const r=e.createAttribute(t);return r.value=n,r}}},jRHm:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return c}));var r=n("dHD5"),a=n("BFlg"),i=n("P6DH");const o="dataset.mark.selected.entity";function s(e,t,n){return{type:"mark.selected.entity.async",execute({dispatch:o,getState:s},l){const u=l.TraceManager.getTracer(a.P),d=a.N+".markedSelectedRelatedEntityAction";try{const a=Object(r.w)(t),p=s();return Object(i.S)(p,e,t)!==n&&o(c(e,a,n)),u.info("Marking "+n+" as the selected entity"),l.EventManager.ReportComponentSuccess(d),Promise.resolve()}catch(e){const t="Marking "+n+" as selected entity failed";l.EventManager.ReportComponentFailure(d,Error(t))}}}}function c(e,t,n){return{type:o,payload:n,meta:{pageId:e,dataSetContextKey:t}}}},jRy5:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.MainForm=1]="MainForm",e[e.MainGrid=2]="MainGrid",e[e.SearchWidget=3]="SearchWidget",e[e.GridRow=4]="GridRow",e[e.SubGrid=5]="SubGrid",e[e.UnboundForm=6]="UnboundForm",e[e.QuickViewForm=7]="QuickViewForm",e[e.RelatedEntity=8]="RelatedEntity",e[e.AssociatedGrid=9]="AssociatedGrid",e[e.FormControl=10]="FormControl",e[e.LookupDialog=11]="LookupDialog",e[e.CustomGrid=12]="CustomGrid",e[e.CanvasCommanding=13]="CanvasCommanding"}(r||(r={}))},jS4H:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e,t){var n;return null===(n=null==e?void 0:e.pages)||void 0===n?void 0:n[t]}n.d(t,"a",(function(){return r}))},jSnv:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return c}));var r={Primary01:"#0078D4",Primary02:"#106EBE",Primary03:"#005A9E",Primary04:"#004578",Primary05:"#2B88D8",Primary06:"#C7E0F4",Primary07:"#DEECF9",Primary08:"#EFF6FC",Secondary01:"#0078D4",Error01:"#a80000",Error02:"#fde7e9",Error03:"#d83b01",Error04:"#fed9cc",Error05:"#107c10",Error06:"#dff6dd",Error07:"#6e6f77",Error08:"#fff4ce",Error09:"#6e6f77",Error10:"#e1dfdd",Neutral01:"#FFFFFF",Neutral02:"#FAF9F8",Neutral03:"#F3F2F1",Neutral04:"#EDEBE9",Neutral05:"#E1DFDD",Neutral06:"#D2D0CE",Neutral07:"#C8C6C4",Neutral08:"#BEBBB8",Neutral09:"#B3B0AD",Neutral10:"#A19F9D",Neutral11:"#8A8886",Neutral12:"#605E5C",Neutral13:"#323130",Neutral14:"#201F1E",Data01:"#118DFF",Data02:"#12239E",Data03:"#E66C37",Data04:"#6B007B",Data05:"#E044A7",Data06:"#744EC2",Data07:"#D98300",Data08:"#D64550",Data09:"#197278",Data10:"#1AAB40",Data11:"#15C6F4",DataEmpty:"#e6e6e6"};function a(e){e=Object.assign({},r,e);var t={};return t.Contrast=e.Neutral01,t.Text01=e.Neutral13,t.Text02=e.Neutral14,t.Text03=e.Neutral12,t.Text04=e.Neutral11,t.Background=t.Contrast,t.DisabledBackground=e.Neutral03,t.DisabledForeground=e.Neutral10,t.InputBorder=e.Neutral12,t.InputFocusBorder=e.Primary01,t.KeyboardFocusBorder=e.Neutral12,t.PivotColor=e.Primary01,{Palette:e,Patterns:t}}a({});function i(e){return{TextInput:{PrefixBackgroundColor:e.Palette.Neutral03,PrefixForegroundColor:e.Palette.Neutral12,SuffixBackgroundColor:e.Palette.Neutral03,SuffixForegroundColor:e.Palette.Neutral12,Disabled:{TextColor:e.Patterns.DisabledForeground,BackgroundColor:e.Patterns.DisabledBackground,BorderColor:e.Palette.Neutral03,LinkColor:e.Patterns.DisabledForeground},View:{TextColor:e.Patterns.Text01,BackgroundColor:e.Patterns.Background,BorderColor:e.Patterns.InputBorder,LinkColor:e.Patterns.Text01},Edit:{TextColor:e.Patterns.Text01,BackgroundColor:e.Patterns.Background,BorderColor:e.Patterns.InputBorder,LinkColor:e.Palette.Primary01,Valid:{Hover:{BorderColor:e.Palette.Neutral13},Focus:{BorderColor:e.Patterns.InputFocusBorder},Open:{BorderColor:e.Palette.Neutral09}},Invalid:{BorderColor:e.Palette.Error01,ErrortextColor:e.Palette.Error01}}},Link:{Enabled:{TextColor:e.Palette.Primary01,Hover:{TextColor:e.Palette.Primary04}},Disabled:{TextColor:e.Patterns.DisabledForeground}},ButtonPrimary:{BackgroundColor:e.Palette.Primary01,TextColor:e.Patterns.Contrast,Disabled:{BackgroundColor:e.Patterns.DisabledBackground,TextColor:e.Patterns.DisabledForeground},Enabled:{Hover:{BackgroundColor:e.Palette.Primary02,TextColor:e.Patterns.Contrast},Pressed:{BackgroundColor:e.Palette.Primary03,TextColor:e.Patterns.Contrast}}},ButtonSecondary:{BackgroundColor:e.Patterns.Background,TextColor:e.Patterns.Text01,BorderColor:e.Palette.Neutral11,Disabled:{BackgroundColor:e.Patterns.DisabledBackground,TextColor:e.Patterns.DisabledForeground},Enabled:{Hover:{BackgroundColor:e.Palette.Neutral03,TextColor:e.Patterns.Text01},Pressed:{BackgroundColor:e.Palette.Neutral04,TextColor:e.Patterns.Text02}}},Label:{TextColor:e.Patterns.Text01,Disabled:{TextColor:e.Patterns.DisabledForeground}},Dropdown:{TextColor:e.Patterns.Text01,BorderColor:e.Patterns.InputBorder,Disabled:{TextColor:e.Patterns.DisabledForeground,BackgroundColor:e.Patterns.DisabledBackground,BorderColor:e.Palette.Neutral03},Enabled:{TextColor:e.Patterns.Text01,BackgroundColor:e.Patterns.Background,Valid:{Hover:{BorderColor:e.Palette.Neutral13},Focus:{BorderColor:e.Patterns.InputFocusBorder},Open:{BorderColor:e.Palette.Neutral09}},Invalid:{BorderColor:e.Palette.Error01}}},DropdownMenu:{BackgroundColor:e.Patterns.Background,Menuitem:{BackgroundColor:e.Patterns.Background,BorderColor:e.Patterns.Background,Disabled:{TextColor:e.Patterns.DisabledForeground},Enabled:{Hover:{TextColor:e.Patterns.Text02,BackgroundColor:e.Palette.Neutral03,BorderColor:e.Palette.Neutral03},Focus:{TextColor:e.Patterns.Text01,BackgroundColor:e.Patterns.Background,BorderColor:e.Patterns.KeyboardFocusBorder},Selected:{TextColor:e.Patterns.Text02,BackgroundColor:e.Palette.Neutral04,BorderColor:e.Palette.Neutral04}}}},Gauge:{TextColor:e.Patterns.Text01,BackgroundColor:e.Patterns.Background,FullArcColor:e.Palette.Primary01,EmptyArcColor:e.Palette.DataEmpty},CommandBar:{BackgroundColor:e.Patterns.Background,Command:{TextColor:e.Patterns.Text01,IconColor:e.Palette.Primary01,Hover:{BackgroundColor:e.Palette.Neutral03},Pressed:{BackgroundColor:e.Palette.Neutral04},Focus:{BorderColor:e.Patterns.KeyboardFocusBorder}}},Form:{PivotColor:e.Patterns.PivotColor,FooterCommand:{TextColor:e.Patterns.Text01,BackgroundColor:e.Palette.Neutral06,IconColor:e.Palette.Neutral13,DividerColor:e.Palette.Neutral08,Hover:{BackgroundColor:e.Palette.Neutral07},Press:{BackgroundColor:e.Palette.Neutral08},Focus:{BorderColor:e.Patterns.KeyboardFocusBorder}}},MessageBar:{Info:{TextColor:e.Patterns.Text01,BackgroundColor:e.Palette.Neutral03,IconColor:e.Palette.Neutral12},SevereWarning:{TextColor:e.Patterns.Text01,BackgroundColor:e.Palette.Error04,IconColor:e.Palette.Error03},Blocked:{TextColor:e.Patterns.Text01,BackgroundColor:e.Palette.Error02,IconColor:e.Palette.Error01},Locked:{TextColor:e.Patterns.Text01,BackgroundColor:e.Palette.Neutral05,IconColor:e.Palette.Neutral12}},Grid:{ColumnHeader:{TextColor:e.Patterns.Text01,BackgroundColor:e.Patterns.Background,CheckmarkIconColor:e.Palette.Neutral11,SortFilterIconColor:e.Palette.Neutral12,DividerColor:e.Palette.Neutral04,Focus:{BorderColor:e.Patterns.KeyboardFocusBorder}},Cell:{TextColor:e.Patterns.Text01,BackgroundColor:e.Patterns.Background,LinkColor:e.Palette.Primary01,Hover:{TextColor:e.Patterns.Text02,BackgroundColor:e.Palette.Neutral03},Selected:{TextColor:e.Patterns.Text02,BackgroundColor:e.Palette.Neutral04,CheckmarkIconColor:e.Palette.Neutral11},Focus:{BorderColor:e.Patterns.KeyboardFocusBorder}},Footer:{TextColor:e.Patterns.Text01,BackgroundColor:e.Patterns.Background,IconColor:e.Palette.Primary01,Focus:{BorderColor:e.Patterns.KeyboardFocusBorder},Disabled:{IconColor:e.Patterns.DisabledForeground}}},AppHeader:{TextColor:e.Patterns.Contrast,BackgroundColor:e.Palette.Primary01,IconColor:e.Palette.Neutral01,Hover:{BackgroundColor:e.Palette.Primary03},Pressed:{BackgroundColor:e.Patterns.Background,IconColor:e.Palette.Neutral13},Focus:{BorderColor:e.Patterns.Background}},Navigation:{Rest:{TextColor:e.Palette.Neutral13,IconColor:e.Palette.Neutral12,BackgroundColor:e.Palette.Neutral03,DividerColor:e.Palette.Neutral04,Hover:{TextColor:e.Palette.Neutral14,IconColor:e.Palette.Neutral12,BackgroundColor:e.Palette.Neutral01},Focus:{BorderColor:e.Patterns.KeyboardFocusBorder}},Selected:{TextColor:e.Palette.Neutral14,IconColor:e.Palette.Neutral12,BackgroundColor:e.Palette.Neutral01,PivotColor:e.Patterns.PivotColor,Focus:{BorderColor:e.Patterns.KeyboardFocusBorder}}},Dashboard:{TextColor:e.Patterns.Text01,BackgroundColor:e.Palette.Neutral02,ViewSelector:{TextColor:e.Patterns.Text01,ChevronColor:e.Palette.Neutral13,ChevronBackgroundColor:e.Palette.Neutral02,Hover:{ChevronBackgroundColor:e.Palette.Neutral04},Pressed:{ChevronBackgroundColor:e.Palette.Neutral04},Open:{ChevronBackgroundColor:e.Palette.Neutral04}},Card:{TextColor:e.Patterns.Text01,BackgroundColor:e.Patterns.Background,DividerColor:e.Palette.Neutral04,ActionButton:{Rest:{TextColor:e.Patterns.Text01,IconColor:e.Palette.Primary01,BackgroundColor:e.Patterns.Background,BorderColor:e.Patterns.Background,Focus:{BorderColor:e.Patterns.KeyboardFocusBorder},Hover:{TextColor:e.Patterns.Text02,IconColor:e.Palette.Primary03,BackgroundColor:e.Palette.Neutral03}},Selected:{TextColor:e.Patterns.Text02,IconColor:e.Palette.Primary03,BackgroundColor:e.Palette.Neutral04,BorderColor:e.Palette.Neutral04,Focus:{BorderColor:e.Patterns.KeyboardFocusBorder},Hover:{BackgroundColor:e.Palette.Neutral05}},Disabled:{TextColor:e.Patterns.DisabledForeground,IconColor:e.Patterns.DisabledForeground,BackgroundColor:e.Patterns.Background}}}}}}var o,s,c=(o={},s={},{Colors:o=Object.assign({},a(r),o),Components:s=Object.assign({},i(o),s),DesignLanguageId:"Fluent",ThemeId:"default"})},jTSi:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s}));var r=n("i1f0"),a=n("dGG5"),i=n("/Ikn");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const o="form.notification.clear";function s(e,t,n){const s=[{name:"uniqueId",value:n}];return{type:o,sync:!0,execute({dispatch:o,getState:l},u,d){try{const d=Object(r.j)(l(),t),p=d?Object.keys(d):[];if(s.push({name:"objectKeys.length",value:p.length}),d&&p.length>0){if(n){if(!!p.find(e=>e===n)){const r=u.ScriptManager.getContainer(t).getEventManager();return Object(i.a)(e,n,d[n].Buttons,r),Object(a.a)(e,n,d[n].MessagePlaceholders,r),o(c(t,n)),!0}return!1}return p.forEach(n=>{const r=u.ScriptManager.getContainer(t).getEventManager();Object(i.a)(e,n,d[n].Buttons,r),Object(a.a)(e,n,d[n].MessagePlaceholders,r)}),o(c(t,n)),!0}return!1}catch(e){return s.push({name:"CorrelationId",value:d.correlationId},{name:"ContextId",value:d.contextId},{name:"ActionStack",value:d.stack}),u.EventManager.ReportComponentFailure("Forms.ClearFormNotification",Error(JSON.stringify(e)),void 0,s),!1}},getFailureParameters:(e,t)=>s}}function c(e,t){return{type:o,payload:{uniqueId:t},meta:{pageId:e}}}},jZCH:function(e,t,n){"use strict";n.d(t,"a",(function(){return fr}));var r=n("fMBw"),a=n.n(r),i=n("EW4s"),o=n("SAYH"),s=n("504W"),c=n("zmAS"),l=n("sZ+8"),u=n("37s6"),d=n("17x/"),p=n("GYEz"),f=n("/A0C"),g=n("f07+"),h=n("3ybi"),m=n("E5IU"),b=n("69Qu"),y=n("a8hT"),_=n("Uv1Y"),v=n("g22U"),S=n("z+5+"),O=n("Div0"),C=n("4r2D"),E=n("CrQY"),I=n("Jj4w"),w=n("odYE"),j=n("uAlF"),P=n("dH1a"),T=n("IKHO"),N=n("ufH1"),A=n("umme"),R=n("84PK"),D=n("HkYq"),x=n("a475"),M=n("H4dV"),F=n("NMtn"),k=n("VA/h"),L=n("WWG3"),B=n("XvL5"),U=n("5qiD"),V=n("d+dp"),z=n("2JG5"),q=n("HYaY"),H=n("iJGp"),W=n("WRF3"),G=n("IvgJ"),K=n("sdkC"),Q=n("/oKV");class X{constructor(e){this._organizationSettings=null,this._organizationSettings=e}getWebServiceCallRetryPolicy(e){return this._organizationSettings.getWebServiceCallRetryPolicy(e)}}var Y=n("xiom"),J=n("IzVP"),$=n("T544"),Z=n("Ydwo"),ee=n("PV+a"),te=n("Hswk");class ne{constructor(e,t){this._queueName=null,this._priorityAdjustmentFactor=0,this._callbackQueue=null,this._queuePumpJobNode=null,this._queueName=e,this._priorityAdjustmentFactor=t,this._callbackQueue=[],this._queuePumpJobNode=null}queueCallback(e,t){this._callbackQueue.push(e);let n=ee.d;Object(s.a)(t)||(n=Math.max(this._priorityAdjustmentFactor,ee.c)),Object(s.a)(this._queuePumpJobNode)?this._queuePumpJobNode=ee.a.schedule(Object(te.a)(this,this._PumpCallbackQueue,"PumpCallbackQueue"),n,this._queueName):this._queuePumpJobNode.priority<n&&(this._queuePumpJobNode.priority=n)}_PumpCallbackQueue(){this._queuePumpJobNode=null;const e=this._callbackQueue.length,t=new Array(e);for(let n=0;n<e;n++)t[n]=this._callbackQueue.shift();for(let n=0;n<e;n++)t[n]()}}var re,ae=n("WWXV"),ie=n("omgb"),oe=n("eq+S"),se=n("nfLm");!function(e){e[e.maiN_APPLICATION_VIEW=0]="maiN_APPLICATION_VIEW",e[e.advanceD_SEARCH=1]="advanceD_SEARCH",e[e.suB_GRID=2]="suB_GRID",e[e.quickfinD_SEARCH=4]="quickfinD_SEARCH",e[e.REPORTING=8]="REPORTING",e[e.offlinE_FILTERS=16]="offlinE_FILTERS",e[e.mA_SEARCH=32]="mA_SEARCH",e[e.lookuP_VIEW=64]="lookuP_VIEW",e[e.sM_APPOINTMENTBOOK_VIEW=128]="sM_APPOINTMENTBOOK_VIEW",e[e.outlooK_FILTERS=256]="outlooK_FILTERS",e[e.addressbooK_FILTERS=512]="addressbooK_FILTERS",e[e.savedquerytypE_OTHER=2048]="savedquerytypE_OTHER",e[e.interactivE_WORKFLOW_VIEW=4096]="interactivE_WORKFLOW_VIEW",e[e.offlinE_TEMPLATE=8192]="offlinE_TEMPLATE",e[e.outlooK_TEMPLATE=131072]="outlooK_TEMPLATE",e[e.custoM_DEFINED_VIEW=16384]="custoM_DEFINED_VIEW"}(re||(re={}));var ce=n("XjOj");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let le=0,ue=0;
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var de;!function(){let e=ee.b;e--,le=e,e--;const t=e;e<=ee.c&&Object(ce.d)(O.a.scheduler,"Too many scheduler priority buckets specified."),e=ee.c,ue=e}(),function(e){e[e.unknownError=0]="unknownError",e[e.constraintError=1]="constraintError",e[e.notFoundError=2]="notFoundError",e[e.quotaError=3]="quotaError",e[e.timeoutError=4]="timeoutError",e[e.aborted=5]="aborted",e[e.databaseError=6]="databaseError",e[e.syntaxError=7]="syntaxError",e[e.tooLargeError=8]="tooLargeError",e[e.versionError=8]="versionError",e[e.dataError=9]="dataError",e[e.invalidAccessError=10]="invalidAccessError",e[e.invalidStateError=11]="invalidStateError",e[e.transactionInactiveError=12]="transactionInactiveError"}(de||(de={}));var pe=n("UDbe"),fe=n("hgKT"),ge=n("BSGX"),he=n("8N/3"),me=n("aOBz"),be=n("iJxC");class ye{constructor(e,t){this._sortField=null,this._sortOrder=0,Object(F.b)(e,"sortField"),this._sortField=e,this._sortOrder=t}get_sortField(){return this._sortField}get_sortOrder(){return this._sortOrder}}var _e,ve=n("uTcl"),Se=n("KJT0"),Oe=n("84uC");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class Ce{constructor(){this._handlers=[],this._isResolved=!1}resolve(e){if(!this._isResolved){this._value=e,this._isResolved=!0;for(let e=0;e<this._handlers.length;e++)this._handlers[e](this._value)}}done(e){this._isResolved?e(this._value):this._handlers.push(e)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class Ee{constructor(){this._results=null,this._awaiting=0,this._batchPromise=null}waitForArray(e){this._batchPromise=new Ce,this._awaiting=e.length,this._results=new Array(this._awaiting);for(let t=0;t<this._awaiting;t++)this._TrackPromise(e[t],t);return this._batchPromise}_TrackPromise(e,t){e.done(e=>{this._results[t]=e,this._awaiting--,this._awaiting||this._batchPromise.resolve(this._results)})}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */!function(e){e[e.none=0]="none",e[e.html=1]="html",e[e.css=2]="css",e[e.jScript=3]="jScript",e[e.xml=4]="xml",e[e.png=5]="png",e[e.jpg=6]="jpg",e[e.gif=7]="gif",e[e.silverlight=8]="silverlight",e[e.xsl=9]="xsl",e[e.ico=10]="ico",e[e.resx=12]="resx"}(_e||(_e={}));var Ie=n("3umU"),we=n("eYZY"),je=n("mDek"),Pe=n("8tWD"),Te=n("wMH2"),Ne=n("V482");class Ae{constructor(e,t){this._key=null,this._stateData=null,this._key=e,this._stateData=t}get_stateData(){return this._stateData}get_key(){return this._key}getObjectData(){const e={};return e[Ae.keyPath]=this._key,e.statedata=this._stateData,e}Merge(e){for(const t in e){const n={key:t,value:e[t]};this.get_stateData()[n.key]=n.value}}static createFromObjectData(e){const t=e[Ae.keyPath],n=e.statedata;return new Ae(t,n)}}Ae.keyPath="statekey";var Re,De=n("qJCH"),xe=n("b2mI"),Me=n("xAYq");!function(e){e[e.local=1]="local",e[e.session=2]="session",e[e.both=3]="both"}(Re||(Re={}));var Fe=n("0rLi"),ke=n("BSqk"),Le=n("0lM4"),Be=n("8o18");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class Ue{constructor(e,t,n){this._MetadataType=0,this._PayloadKey=null,this._UniqueKey=null,this._set_metadataType(e),this._set_uniqueKey(t),this._set_payloadKey(n)}get_metadataType(){return this._MetadataType}_set_metadataType(e){return this._MetadataType=e,e}get_payloadKey(){return this._PayloadKey}_set_payloadKey(e){return this._PayloadKey=e,e}get_uniqueKey(){return this._UniqueKey}_set_uniqueKey(e){return this._UniqueKey=e,e}}var Ve=n("qCX6"),ze=n("67s4"),qe=n("Xe7f"),He=n("kGsI"),We=n("hirD"),Ge=n("5yoC");class Ke extends Ge.a{constructor(e){super(),this._clientMetadataQuery=null,this._clientMetadataQuery=e}get_name(){return"GetClientMetadata"}get_xmlNamespace(){return"http://schemas.microsoft.com/xrm/2011/Contracts"}get_clientMetadataQuery(){return this._clientMetadataQuery}}var Qe,Xe,Ye=n("PF3G"),Je=n("nxt5"),$e=n("XgcG"),Ze=n("3sOn"),et=n("c7Og");class tt{constructor(e,t){this._path=null,this._type=0,this._path=e,this._type=t}get_keyPath(){return this._path}get_dataType(){return this._type}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */!function(e){e[e.text=0]="text",e[e.integer=1]="integer"}(Qe||(Qe={}));class nt{constructor(e,t){this._name=null,this._fields=null,Object(F.c)(e,"name"),Object(F.b)(t,"fields"),Object(F.e)(t.length,1,2,"fields must be a 1 or 2 length array"),this._name=e,this._fields=t}get_name(){return this._name}get_fields(){return this._fields}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */!function(e){e[e.explicitString=0]="explicitString",e[e.autoIncrementedInteger=1]="autoIncrementedInteger"}(Xe||(Xe={}));var rt=n("qGFd");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class at{constructor(e,t,n,r,a,i){this._name=null,this._version=null,this._indexes=null,this._idType=0,this._isMetadataStore=!1,this._storeDbType=rt.b.OrgDb,this._name=e.toLowerCase(),this._version=t,this._indexes=n||[],this._idType=r,this._isMetadataStore=a,this._storeDbType=i}get_storeDbType(){return this._storeDbType}set_storeDbType(e){this._storeDbType=e}get_name(){return this._name}get_version(){return this._version}get_indexes(){return this._indexes}get_idType(){return this._idType}get_isMetadataStore(){return this._isMetadataStore}}class it{constructor(){this._objectStores=null,this._version="";const e=st(it.metadataVersionStampStore),t=st("TempMetadataVersionStamp"),n=ct(it.applicationMetadataStore),r=ct("TempApplicationMetadata"),a=lt(it.entityMetadataStore),i=lt("TempEntityMetadata"),o=ut(it.attributeMetadataStore),s=ut("TempAttributeMetadata"),c=(l=it.userContextStore,new at(l,l+"#1",new Array(0),0,!0,ot(it.userContextStore)));var l;const u=function(e){return new at(e,e+"#1",new Array(0),0,!0,ot(it.sessionStateStore))}(it.sessionStateStore),d=function(e){const t=e+"#1",n=new pe.a(V.a.embeddedPriorityTimestampPath),r=[new tt(n,0)],a=[new nt("priority_timestamp",r)];return new at(e,t,a,0,!1,ot(it.entityRecordStore))}(it.entityRecordStore),p=function(e){const t=e+"#1",n=new pe.a("query"),r=new pe.a(V.a.embeddedPriorityTimestampPath),a=[new tt(r,0)],i=[new tt(n,0)],o=[new nt("query",i),new nt("priority_timestamp",a)];return new at(e,t,o,Xe.autoIncrementedInteger,!1,ot(it.listStore))}(it.listStore),f=function(e){return new at(e,e+"#1",new Array(0),0,!1,ot(it.userPersonalizationStore))}(it.userPersonalizationStore),g=function(e){const t=e+"#1",n=new pe.a(V.a.timestampPath),r=[new tt(n,0)],a=[new nt(V.a.timestampPath,r)];return new at(e,t,a,Xe.autoIncrementedInteger,!1,ot(it.navigationDataStore))}(it.navigationDataStore),h=function(e){return new at(e,e+"#1",new Array(0),0,!1,ot(it.offlineDatabaseInformationStore))}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(it.offlineDatabaseInformationStore);r.set_storeDbType(rt.b.OrgDb),i.set_storeDbType(rt.b.OrgDb),t.set_storeDbType(rt.b.OrgDb),s.set_storeDbType(rt.b.OrgDb),this._objectStores=[n,r,a,i,o,s,d,p,e,t,c,f,u,g,h];for(const e of this._objectStores)this._version+="_"+e.get_version()}get_version(){return this._version}get_objectStores(){return this._objectStores}get_metadataStoreNames(){return this._objectStores.filter(e=>e.get_isMetadataStore()).map(e=>e.get_name())}get_dataStoreNames(){return this._objectStores.filter(e=>!e.get_isMetadataStore()).map(e=>e.get_name())}getSchemaFromObjectStoreName(e){if(Object(s.a)(e))return null;for(let t=0;t<this._objectStores.length;++t)if(this._objectStores[t].get_name().toLowerCase()===e.toLowerCase())return this._objectStores[t];return null}}function ot(e){return null!==it.storeToDbTypeMap[e.toLowerCase()]&&void 0!==it.storeToDbTypeMap[e.toLowerCase()]?it.storeToDbTypeMap[e.toLowerCase()]:rt.b.OrgDb}function st(e){return new at(e,e+"#1",new Array(0),0,!0,ot(it.metadataVersionStampStore))}function ct(e){const t=e+"#2",n=[new tt(Ie.a.metadataTypeKeyPath,Qe.integer)],r=[new tt(Ie.a.metadataTypeSourceIdKeyPath,0)],a=[new tt(Ie.a.metadataTypeAssociatedEntityLogicalNameKeyPath,0)],i=[new tt(Ie.a.metadataTypeMetadataSubtypeAssociatedEntityLogicalNameKeyPath,0)],o=[new tt(Ie.a.metadataTypeNormalizedDisplayNameKeyPath,0)],s=[new nt(Ie.a.metadataTypeKeyPath.get_path(),n),new nt(Ie.a.metadataTypeSourceIdKeyPath.get_path(),r),new nt(Ie.a.metadataTypeAssociatedEntityLogicalNameKeyPath.get_path(),a),new nt(Ie.a.metadataTypeMetadataSubtypeAssociatedEntityLogicalNameKeyPath.get_path(),i),new nt(Ie.a.metadataTypeNormalizedDisplayNameKeyPath.get_path(),o)];return new at(e,t,s,0,!0,ot(it.applicationMetadataStore))}function lt(e){const t=e+"#1",n=new pe.a("logicalname"),r=[new tt(n,0)],a=[new nt("logicalname",r)];return new at(e,t,a,0,!0,ot(it.entityMetadataStore))}function ut(e){const t=e+"#1",n=new pe.a(je.a.logicalNamePath),r=new pe.a(je.a.entityLogicalNamePath),a=new pe.a(je.a.entityAttributeLogicalNamesPath),i=[new tt(n,0)],o=[new tt(r,0)],s=[new tt(a,0)],c=[new nt(je.a.logicalNamePath,i),new nt(je.a.entityLogicalNamePath,o),new nt(je.a.entityAttributeLogicalNamesPath,s)];return new at(e,t,c,0,!0,ot(it.attributeMetadataStore))}it.applicationMetadataStore="ApplicationMetadata",it.entityMetadataStore="EntityMetadata",it.attributeMetadataStore="AttributeMetadata",it.entityRecordStore="EntityRecord",it.listStore="List",it.metadataVersionStampStore="MetadataVersionStamp",it.offlineDatabaseInformationStore="OfflineDatabaseInformation",it.userContextStore="UserContext",it.userPersonalizationStore="UserPersonalization",it.sessionStateStore="SessionState",it.navigationDataStore="NavigationData",it.storeToDbTypeMap={[it.navigationDataStore.toLowerCase()]:rt.b.OrgDb,[it.sessionStateStore.toLowerCase()]:rt.b.OrgDb,[it.userPersonalizationStore.toLowerCase()]:rt.b.OrgDb,[it.userContextStore.toLowerCase()]:rt.b.OrgDb,[it.offlineDatabaseInformationStore.toLowerCase()]:rt.b.OrgDb,[it.metadataVersionStampStore.toLowerCase()]:rt.b.OrgDb,[it.listStore.toLowerCase()]:rt.b.OrgDb,[it.entityRecordStore.toLowerCase()]:rt.b.OrgDb,[it.attributeMetadataStore.toLowerCase()]:rt.b.ProfileDb,[it.entityMetadataStore.toLowerCase()]:rt.b.ProfileDb,[it.applicationMetadataStore.toLowerCase()]:rt.b.ProfileDb};class dt{constructor(e){if(this._keyValue=null,e){const t=Object.getType(e);if(t!==String&&t!==Number&&t!==Number&&t!==Date)throw Error.argumentType("keyValue",t,null,"keyValue must be a javascript primitive (string, int, float, Datetime (or null))")}this._keyValue=e}toString(){return this._keyValue?""+this.toKeyValue():null}toKeyValue(){return this._keyValue}}var pt=n("zW2f");class ft{constructor(e,t){this._results=null,this._results=Object(s.a)(e)?[]:e}get_results(){return this._results}}var gt=n("4Gtd"),ht=n("5UJb"),mt=n.n(ht);class bt{constructor(e,t){this._innerTransaction=null,this._databaseName=null,this._openedStores=null,this._result=null,this._transactionEvent=null,this._transactionEvent=a.a.createEvent("ClientBrowserStoreTransaction","LocalStore"),this._innerTransaction=e,this._databaseName=t,this._openedStores={}}get_result(){return this._result}set_result(e){return this._result=e,e}add(e,t,n,r){Object(N.d)("ClientBrowserStoreTransaction_Add",O.a.storage,this._databaseName);const a=new Ce;this._InitPerformanceStopWatch(a,"Add",n,r,{key:e,data:t});return this._OpenObjectStore(n).putItem(new dt(e),t,e=>{a.resolve(e.toKeyValue())},null),a}addMultiple(e,t,n,r){Object(N.d)("ClientBrowserStoreTransaction_AddMultiple",O.a.storage,this._databaseName);const a=new Ce;this._InitPerformanceStopWatch(a,"AddMultiple",n,r,{extractKey:e,dataSet:t});const i=this._OpenObjectStore(n);return this._AddMultipleRecursive(0,e,i,t,[],a),a}_AddMultipleRecursive(e,t,n,r,a,i){this._AddMultipleByBatch(e,t,n,r,o=>{a.push(...o),e+o.length<r.length?this._AddMultipleRecursive(e+o.length,t,n,r,a,i):i.resolve(a)})}_AddMultipleByBatch(e,t,n,r,a){const i=x.a.get_Instance().get_device().get_DeviceState().get_deviceMaxBatchSize(),o=[],s=Math.min(e+i,r.length);let c=s-e;if(c)for(let i=e;i<s;i++){Object(F.d)(r[i],"dataSet["+i+"]");const e=r[i],s=t?t(e):null,l=new dt(s);n.putItem(l,e,e=>{o.push(e.toKeyValue()),c--,c||a(o)},null)}else a([])}addMultipleByKey(e,t,n,r){Object(N.d)("ClientBrowserStoreTransaction_AddMultipleByKey",O.a.storage,this._databaseName);const a=new Ce;this._InitPerformanceStopWatch(a,"AddMultipleByKey",n,r,{keys:e,dataSet:t});const i=this._OpenObjectStore(n);let o=t.length;if(!o)return a.resolve([]),a;for(let n=0;n<t.length;n++){Object(F.d)(t[n],"dataSet["+n+"]");const r=t[n],s=e[n],c=new dt(s);i.putItem(c,r,e=>{o--,o||a.resolve([e.toKeyValue()])},null)}return a}flush(e,t,n){Object(N.d)("ClientBrowserStoreTransaction_Flush",O.a.storage,this._databaseName);const r=new Ce;this._InitPerformanceStopWatch(r,"Flush",t,n,{key:e});return this._OpenObjectStore(t).deleteItem(new dt(e),()=>{r.resolve(null)},null),r}flushMultiple(e,t,n){Object(N.d)("ClientBrowserStoreTransaction_FlushMultiple",O.a.storage,this._databaseName);const r=new Ce;this._InitPerformanceStopWatch(r,"FlushMultiple",t,n,{keys:e});const a=this._OpenObjectStore(t);let i=e.length;if(!i)return r.resolve(0),r;for(let t=0;t<e.length;t++)a.deleteItem(new dt(e[t]),()=>{i--,i||r.resolve(e.length)},null);return r}flushAll(e,t){Object(N.d)("ClientBrowserStore_FlushAll_Transaction",O.a.storage,this._databaseName);const n=new Ce;this._InitPerformanceStopWatch(n,"FlushAll",e,t,{});return this._OpenObjectStore(e).clear(()=>{n.resolve(null)},null),n}flushByQuery(e,t,n){Object(N.d)("ClientBrowserStoreTransaction_FlushByQuery",O.a.storage,this._databaseName);const r=new Ce;return this._InitPerformanceStopWatch(r,"FlushByQuery",t,n,{query:e}),this.retrieveMultipleByQuery(e,t,n).done(e=>{const a=e.get_results();if(!Object(s.a)(a)&&a.length>0){const e=new Array(a.length);for(let t=0;t<a.length;t++)e[t]=a[t].get_key();this.flushMultiple(e,t,n).done(()=>{r.resolve(a.length)})}else r.resolve(0)}),r}retrieve(e,t,n){Object(N.d)("ClientBrowserStoreTransaction_Retrieve_Transaction",O.a.storage,this._databaseName);const r=new Ce;this._InitPerformanceStopWatch(r,"Retrieve",t,n,{key:e});return this._OpenObjectStore(t).getItem(new dt(e),e=>{r.resolve(e)},null),r}retrieveMultipleByQuery(e,t,n){Object(N.d)("ClientBrowserStore_RetrieveMultipleByQuery_Transaction",O.a.storage,this._databaseName);const r=new Ce;this._InitPerformanceStopWatch(r,"RetrieveMultipleByQuery",t,n,{query:e});return this._OpenObjectStore(t).objectQuery(e,t=>{const n=e.get_pageSize()<0,a=n?Object(gt.b)():e.get_pageSize(),i=e.get_offset(),o=e.get_getIdOnly(),s=e.get_allowPartialResults();t.skip(i,()=>{this._IterateOverResults(n,o,s,a,0,0,t,[],r)},null)},null),r}_IterateOverResults(e,t,n,r,a,i,o,s,c){const l=Math.min(r,Object(gt.b)());o.next(l,t,(u,d)=>{const p=d.length;for(let e=0;e<p;++e)s.push(new et.a(d[e].get_id().toKeyValue(),d[e].get_json()));if(a+=p,i+=l,e)if(p<l){const e=new ft(s,a);o.dispose(),c.resolve(e)}else this._IterateOverResults(e,t,n,r,a,i,o,s,c);else n&&i<r||a<r&&p===l?this._IterateOverResults(e,t,n,r,a,i,o,s,c):o.approximateCount(e=>{const t=new ft(s,e);o.dispose(),c.resolve(t)},null)},null)}_OpenObjectStore(e){return e in this._openedStores||(this._openedStores[e]=this._innerTransaction.openObjectStore(e)),this._openedStores[e]}_InitPerformanceStopWatch(e,t,n,r,a){const i={};i.action=t;const o=Object(s.a)(r)?pt.a.get_instance():r;i.context=o.toString(),i.storeName=n,i.transactionType=this._innerTransaction.get_isReadOnly()?"(read)":"(read/write)";for(const e in a){const t={key:e,value:a[e]};t.value&&(i[t.key]="keys"===t.key||"extractKey"===t.key||"dataSet"===t.key?"["+t.key+"]":t.value.toString())}const c=this._transactionEvent.startStopwatch(i);if(e.done(()=>{c()}),n!==it.sessionStateStore){const t=mt.a.trackWork("ClientBrowserStoreTransaction");e.done(()=>{t()})}}}var yt=n("adUS");class _t{constructor(e,t,n){this._sqlDispatcher=null,this._workQueue=null,this._store=null,this._sqlDispatcher=e,this._workQueue=t,this._store=n}openDatabase(e,t,n,r,a){return new yt.a(this._sqlDispatcher,this._workQueue,this._store)}}class vt{}var St,Ot,Ct=n("kToj");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function Et(){return IDBKeyRange.lowerBound(-Number.MAX_VALUE,!0)}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */!function(e){e[e.IndexSizeError=1]="IndexSizeError",e[e.DomStringSizeError=2]="DomStringSizeError",e[e.HierarchyRequestError=3]="HierarchyRequestError",e[e.WrongDocumentError=4]="WrongDocumentError",e[e.InvalidCharacterError=5]="InvalidCharacterError",e[e.NoDataAllowedError=6]="NoDataAllowedError",e[e.NoModificationAllowedError=7]="NoModificationAllowedError",e[e.NotFoundError=8]="NotFoundError",e[e.NotSupportedError=9]="NotSupportedError",e[e.InUseAttributeError=10]="InUseAttributeError",e[e.InvalidStateError=11]="InvalidStateError",e[e.SyntaxError=12]="SyntaxError",e[e.InvalidModificationError=13]="InvalidModificationError",e[e.NamespaceError=14]="NamespaceError",e[e.InvalidAccessError=15]="InvalidAccessError",e[e.ValidationError=16]="ValidationError",e[e.TypeMismatchError=17]="TypeMismatchError",e[e.SecurityError=18]="SecurityError",e[e.NetworkError=19]="NetworkError",e[e.AbortError=20]="AbortError",e[e.URLMismatchError=21]="URLMismatchError",e[e.QuotaExceededError=22]="QuotaExceededError",e[e.TimeoutError=23]="TimeoutError",e[e.InvalidNodeTypeError=24]="InvalidNodeTypeError",e[e.DataCloneError=25]="DataCloneError",e[e.EncodingError=26]="EncodingError",e[e.NotReadableError=27]="NotReadableError",e[e.UnknownError=28]="UnknownError",e[e.ConstraintError=29]="ConstraintError",e[e.DataError=30]="DataError",e[e.TransactionInactiveError=31]="TransactionInactiveError",e[e.ReadOnlyError=32]="ReadOnlyError",e[e.VersionError=33]="VersionError",e[e.OperationError=34]="OperationError"}(St||(St={}));class It{constructor(e,t){this.keypath=null,this.autoIncrement=!1,Object(s.b)(e)&&(this.keypath=e),this.autoIncrement=t}static forAutoIncrementedKey(){return new It(null,!0)}static forExternalKey(){return new It(null,!1)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class wt{constructor(e,t){this._message=null,this._code=0,this._code=e,this._message=function(e,t){let n="BrowserDbError: ";switch(e){case de.constraintError:n+="ConstraintError. ";break;case de.notFoundError:n+="NotFoundError. ";break;case de.quotaError:n+="QuotaError. ";break;case de.timeoutError:n+="TimeoutError. ";break;case de.aborted:n+="AbortError. ";break;case de.databaseError:n+="DatabaseError. ";break;case de.syntaxError:n+="SyntaxError. ";break;default:de[e]?n+=de[e]+". ":n+="UnknownError. "}return n+t}(e,t)}get_message(){return this._message}get_code(){return this._code}static throwException(e,t){const n=new wt(e,t);throw Error.create(n.get_message())}}class jt{constructor(e){this._subscriptionEntries=null,this._subscriptionEntries={}}get_subscriptionEntries(){return this._subscriptionEntries}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class Pt extends wt{static reportIdbError(e,t){const n=St[e],r=function(e){let t=0;switch(e){case St.UnknownError:t=0;break;case St.ConstraintError:t=de.constraintError;break;case St.DataError:t=de.dataError;break;case St.TransactionInactiveError:t=de.transactionInactiveError;break;case St.ReadOnlyError:t=de.constraintError;break;case St.VersionError:t=de.versionError;break;case St.NotFoundError:t=de.notFoundError;break;case St.InvalidStateError:t=de.invalidStateError;break;case St.InvalidAccessError:t=de.invalidAccessError;break;case St.TimeoutError:t=de.timeoutError;break;case St.AbortError:t=de.aborted;break;case St.QuotaExceededError:t=de.quotaError;break;case St.SyntaxError:t=de.syntaxError;break;case St.DataCloneError:t=de.constraintError}return t}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(e);Object(ce.d)(O.a.indexedDb,"IndexedDb Error: Message : {0} : Code : {1}",n,e),Pt.reportError(r,n,t)}static reportError(e,t,n){n&&n(new Pt(e,t))}static reportSuccess(e){e&&e()}}!function(e){e[e.addItem=0]="addItem",e[e.changeItem=1]="changeItem",e[e.deleteItem=2]="deleteItem"}(Ot||(Ot={}));class Tt{constructor(){this._events={}}get_Events(){const e=[],t=this._events;for(const n in t){const r={key:n,value:t[n]};e.push(r.value)}return e}AddEvent(e){this._events[e.get_id().toString()]=e}}class Nt{constructor(){this._adds=null,this._changes=null,this._deletes=null,this._adds=new Tt,this._changes=new Tt,this._deletes=new Tt}get_hasWriteEvents(){return this.get_addEvents().length>0||this.get_changeEvents().length>0||this.get_deleteEvents().length>0}get_addEvents(){return this._adds.get_Events()}get_changeEvents(){return this._changes.get_Events()}get_deleteEvents(){return this._deletes.get_Events()}recordEvent(e,t){switch(t){case 0:Object(Ct.a)(!!e.get_json(),"json value cannot be null"),this._adds.AddEvent(e);break;case Ot.changeItem:Object(Ct.a)(!!e.get_json(),"json value cannot be null"),this._changes.AddEvent(e);break;case Ot.deleteItem:Object(Ct.a)(!e.get_json(),"We don't support returning data values for deletes"),this._deletes.AddEvent(e);break;default:Object(Ct.a)(!1,"Invalid notification event type")}}}class At{constructor(e,t){this._id=null,this._json=null,Object(F.b)(e,"id"),this._id=e,this._json=t}get_id(){return this._id}get_json(){return this._json}}class Rt{constructor(e){this._subscriptionsPerDb=null,this._notificationDataPerTransaction=null,this._subscriptionsPerDb=e,this._notificationDataPerTransaction={};const t=this._subscriptionsPerDb.get_subscriptionEntries();for(const e in t){const n={key:e,value:t[e]};this._notificationDataPerTransaction[n.key]=new Nt}}queueNotificationEvents(e,t,n,r){Object(Ct.a)(!!e,"objectStore name cannot be null since it is called from an object store"),Object(Ct.a)(!!n,"id cannot be null - it is the key to add to the notification list");const a=e.toLowerCase();if(a in this._notificationDataPerTransaction){this._notificationDataPerTransaction[a].recordEvent(new At(n,r),t)}}publishNotificationEvents(){const e=this._notificationDataPerTransaction;for(const t in e){const n={key:t,value:e[t]},r=this._subscriptionsPerDb.get_subscriptionEntries()[n.key];if(r){const e=n.value;e.get_hasWriteEvents()&&r(n.key,e)}}}}class Dt{constructor(){this._observationsPerId=null,this._observationsPerId={}}onBeforePut(e,t,n){this._CheckForLoop(t.toKeyValue())}onBeforeDelete(e,t){this._CheckForLoop(t.toKeyValue())}onBeforeClear(e){this._CheckForLoop(e.get_name())}_CheckForLoop(e){if(e){const t=e.toString(),n=this._observationsPerId[t];let r=1;if(Object(s.a)(n)||(r=n+1),r>64)throw Error.invalidOperation("loop detected in transaction observer for id "+e);this._observationsPerId[t]=r}}}class xt{constructor(e,t){this._id=null,this._json=null,this._id=e,this._json=t}get_id(){return this._id}get_json(){return this._json}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var Mt;!function(e){e[e.before=0]="before",e[e.during=1]="during",e[e.after=2]="after"}(Mt||(Mt={}));class Ft{constructor(e,t){this._tx=null,this._strategy=null,this._tx=e,this._strategy=t}approximateCount(e,t){this._strategy.approximateCount(e,t)}next(e,t,n,r){Object(F.b)(n,"successCallback"),this._strategy.get_position()===Mt.after?n(this._tx,[]):this._AdvanceStrategyAndAddToResults(e,[],n,r)}skip(e,t,n){this._strategy.skip(e,t,n)}_AdvanceStrategyAndAddToResults(e,t,n,r){Object(Ct.a)(this._strategy.get_position()!==Mt.after,"can't be called after content"),this._strategy.next(()=>{if(Object(Ct.a)(!!this._strategy.get_position(),"must be on or after content"),this._strategy.get_position()===Mt.after)n(this._tx,t);else{const a=this._strategy.get_currentRecord(),i=this._strategy.get_currentKey(),o=new xt(new dt(i),a.data);t.push(o),--e>0?this._AdvanceStrategyAndAddToResults(e,t,n,r):n(this._tx,t)}},e=>{Pt.reportIdbError(e,r),this.dispose()})}dispose(){Object(s.a)(this._strategy)||this._strategy.dispose()}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class kt{constructor(e,t){this.data=null,this.metadata=null,this.data=e,this.metadata=t}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Lt(e,t){return Bt(e)+""+Bt(t)}function Bt(e){return"string"==typeof e?"S"+function(e){if(e.indexOf("")>=0)return Object(ce.i)(O.a.indexedDb,"A composite key is being constructed with the composite key meta-character and will be stripped of the character.  Consequently, sorts and filters, will ignore that character in any comparisons. {0}",e),e.replace("","");return e}(e):"number"==typeof e?"N"+function(e){e>0xfffffffffffff&&(e=0xfffffffffffff);e<-0xffffffffffff&&(e=-0xffffffffffff);if(e>=0)return"P"+e.toString(16).padStart(13,"0");const t=(0xfffffffffffff+e+1).toString(16);return Object(Ct.a)(13===t.length,"negative key must be 13 digits!"),"N"+t}(e):(Object(Ct.a)(!1,"unknown type: "+Object.getType(e)),null)}class Ut{constructor(e){this._innerStrategy=null,this._position=0,this._innerStrategy=e,this._position=0}get_innerStrategy(){return this._innerStrategy}get_currentRecord(){return this._AssertInitialized(),this.get_internalCurrentRecord()}get_currentKey(){return this._AssertInitialized(),this.get_internalCurrentKey()}get_currentGroupId(){return this._AssertInitialized(),this.get_internalCurrentGroupId()}get_position(){return this._position}approximateCount(e,t){this.get_innerStrategy().approximateCount(e,t)}next(e,t){switch(this._position){case 0:this.initialize(()=>{this._SetCurrentPosition(),e()},t);break;case Mt.during:this.internalNext(()=>{this._SetCurrentPosition(),e()},t);break;case Mt.after:throw Error.invalidOperation("The end of the content was reached by the previous call to next!")}}skip(e,t,n){if(e&&this.get_position()!==Mt.after)switch(this._position){case 0:this.initialize(()=>{this._SetCurrentPosition(),this.skip(e-1,t,n)},e=>{Pt.reportIdbError(e,n)});break;case Mt.during:this.internalSkip(e,()=>{this._SetCurrentPosition(),Pt.reportSuccess(t)},e=>{Pt.reportIdbError(e,n)});break;case Mt.after:throw Error.invalidOperation("The end of the content was reached by the previous call to next!")}else Pt.reportSuccess(t)}dispose(){Object(s.a)(this.get_innerStrategy())||this.get_innerStrategy().dispose(),this.internalDispose()}internalDispose(){}initialize(e,t){this.internalNext(e,t)}internalSkip(e,t,n){e&&this.get_position()!==Mt.after?(Object(Ct.a)(e>0,"number to skip must be positive"),this.next(()=>{this.internalSkip(e-1,t,n)},n)):t()}_InternalSeekTo(e,t,n){this.next(()=>{this.get_position()===Mt.after?t(!1):e.isSatisfiedByRecord(this.get_currentKey(),this.get_currentRecord())?(this._position=0,t(!0)):this._InternalSeekTo(e,t,n)},e=>{Pt.reportIdbError(e,n)})}_AssertInitialized(){if(!this._position)throw Error.invalidOperation("cannot ask for value before calling next")}_SetCurrentPosition(){this._position=this.get_internalCurrentRecord()?Mt.during:Mt.after}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class Vt{constructor(e,t){this._success=null,this._error=null,this._success=e,this._error=t}get_success(){return this._success}get_error(){return this._error}}class zt extends Ut{constructor(e,t){super(null),Object(F.b)(e,"idbCursorRequest"),this._pendingCallback=null,this._idbCursorRequest=e,this._range=t,this._idbCursorRequest.onsuccess=Object(te.a)(this,this._HandleNextSuccess,"HandleNextSuccess"),this._idbCursorRequest.onerror=Object(te.a)(this,this._HandleNextError,"HandleNextError")}get_internalCurrentRecord(){let e=null;return this._idbCursorRequest.result&&(e=this._idbCursorRequest.result.value),e}get_internalCurrentKey(){let e=null;return this._idbCursorRequest.result&&(e=this._idbCursorRequest.result.primaryKey),e}get_internalCurrentGroupId(){return""}approximateCount(e,t){const n=this._range?this._idbCursorRequest.source.count(this._range):this._idbCursorRequest.source.count();n.onsuccess=t=>{e(t.target.result)},n.onerror=e=>{Pt.reportIdbError(e.target.errorCode,t)}}internalDispose(){Object(s.a)(this._idbCursorRequest)||(this._idbCursorRequest.onsuccess=null,this._idbCursorRequest.onerror=null,this._idbCursorRequest=null)}internalSkip(e,t,n){Object(Ct.a)(!this._pendingCallback,"Skip cannot be called until the previous request completed"),this._pendingCallback=new Vt(t,n),this._idbCursorRequest.result.advance(e)}internalNext(e,t){Object(Ct.a)(!this._pendingCallback,"Next cannot be called until the previous request completed"),this._pendingCallback=new Vt(e,t),this._idbCursorRequest.result.continue()}initialize(e,t){e()}_HandleNextSuccess(e){Object(Ct.a)(!!this._pendingCallback,"There must be a pending callback");const t=this._pendingCallback;this._pendingCallback=null,t.get_success()()}_HandleNextError(e){Object(Ct.a)(!!this._pendingCallback,"There must be a pending callback");const t=this._pendingCallback;this._pendingCallback=null,t.get_error()(e.target.errorCode)}}class qt extends Ut{constructor(e,t){super(t),this._groupBy=null,this._groupBy=e}get_internalCurrentRecord(){return this.get_innerStrategy().get_currentRecord()}get_internalCurrentKey(){return this.get_innerStrategy().get_currentKey()}get_internalCurrentGroupId(){let e="";for(let t=0;t<this._groupBy.length;++t){const n=this._groupBy[t].get_path()===pe.a.get_id().get_path()?this.get_innerStrategy().get_currentKey():this._groupBy[t].getField(this.get_innerStrategy().get_currentRecord().data);Object(s.a)(n)||(e+=n.toString())}return e}internalNext(e,t){this.get_innerStrategy().next(e,t)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class Ht{constructor(e,t){this._key=null,this._sortFieldValue=null,this._key=e,this._sortFieldValue=t}get_key(){return this._key}get_sortFieldValue(){return this._sortFieldValue}compareTo(e){return"number"==typeof this.get_sortFieldValue()&&"number"==typeof e.get_sortFieldValue()?this.get_sortFieldValue()-e.get_sortFieldValue():"string"==typeof this.get_sortFieldValue()&&"string"==typeof e.get_sortFieldValue()?this.get_sortFieldValue()===e.get_sortFieldValue()?0:this.get_sortFieldValue()>e.get_sortFieldValue()?1:-1:(Object(Ct.a)(!1,"unknown sort types"),0)}}class Wt extends qt{constructor(e,t,n,r){super([t],r),this._objectStore=null,this._sortField=null,this._sortOrder=0,this._currentRecord=null,this._currentKey=null,this._currentGroupId=null,this._groupBatch=null,this._groupBatchPosition=0,this._objectStore=e,this._sortField=t,this._sortOrder=n,this._groupBatchPosition=0,this._groupBatch=new Array(0)}get_internalCurrentRecord(){return this._currentRecord}get_internalCurrentKey(){return this._currentKey}get_internalCurrentGroupId(){return this._currentGroupId.toString()}internalNext(e,t){this._SetCurrentRecord(null,null),this._groupBatchPosition<this._groupBatch.length?this._ReadNextItemInBatchFromObjectStore(e,t):this.get_innerStrategy().get_position()===Mt.after?e():this._PopulateNextBatchFromInnerStrategy(()=>{this.internalNext(e,t)},t)}initialize(e,t){this.get_innerStrategy().next(()=>{this.internalNext(e,t)},t)}_PopulateNextBatchFromInnerStrategy(e,t){this._groupBatch=new Array(0),this._groupBatchPosition=0;let n="";this.get_innerStrategy().get_position()===Mt.after?e():(n=this.get_innerStrategy().get_currentGroupId(),this._AddToBatchWhileGroupIdMatches(n,e,t))}_AddToBatchWhileGroupIdMatches(e,t,n){if(this.get_innerStrategy().get_position()===Mt.during&&this.get_innerStrategy().get_currentGroupId()===e){const r=this._sortField.get_path()===pe.a.get_id().get_path()?this.get_innerStrategy().get_currentKey():this._sortField.getField(this.get_innerStrategy().get_currentRecord().data);this._groupBatch.push(new Ht(this.get_innerStrategy().get_currentKey(),r)),this.get_innerStrategy().next(()=>{this._AddToBatchWhileGroupIdMatches(e,t,n)},n)}else this._SortBatch(),t()}_SortBatch(){this._groupBatch.length>0&&this._groupBatch.sort(Object(te.a)(this,this._CompareSortRecords,"CompareSortRecords"))}_CompareSortRecords(e,t){const n=e,r=t;return this._sortOrder?r.compareTo(n):n.compareTo(r)}_ReadNextItemInBatchFromObjectStore(e,t){const n=this._groupBatch[this._groupBatchPosition].get_key(),r=this._objectStore.get(n);this._groupBatch[this._groupBatchPosition]=null,this._groupBatchPosition++,r.onsuccess=t=>{this._SetCurrentRecord(n,t.target.result),e()},r.onerror=()=>{t(r.errorCode)}}_SetCurrentRecord(e,t){this._currentKey=e,this._currentRecord=t,this._currentGroupId=t?this._sortField.getField(t.data):null}}class Gt extends Ut{constructor(e,t){super(t),this._filter=null,this._filter=e}get_internalCurrentRecord(){return this.get_innerStrategy().get_currentRecord()}get_internalCurrentKey(){return this.get_innerStrategy().get_currentKey()}get_internalCurrentGroupId(){return this.get_innerStrategy().get_currentGroupId()}approximateCount(e,t){Object(ce.i)(O.a.indexedDb,"Asking for ApproximateCount on a filtered strategy will not provide an accurate count!"),super.approximateCount(e,t)}internalNext(e,t){this.get_innerStrategy().next(()=>{this.get_innerStrategy().get_position()===Mt.after||this._filter.isSatisfiedByRecord(this.get_innerStrategy().get_currentKey(),this.get_innerStrategy().get_currentRecord().data)?e():this.internalNext(e,t)},e=>{t(e)})}}function Kt(e,t,n,r,a,i){Object(F.b)(t,"object store"),Object(F.b)(a,"success"),a=function(e,t,n){const r=e.onerror;e.onerror=t=>{e.onerror=r,Pt.reportIdbError(t.target.errorCode,n),r&&r.apply(e,t)};const a=t;return t=t=>{e.onerror=r,a(t)}}(e,a,i),function(e){return!e}(r)?Qt(t,a):function(e){return!!e&&!e.get_filter()}(r)?function(e,t,n,r){switch(tn(n)){case 0:Qt(e,r);break;case 1:!function(e,t,n,r){const a=n.get_sortBy()[0].get_sortField(),i=n.get_sortBy()[0].get_sortOrder(),o=t.getCursorFactory(e,a);o?en(o,i,null,r):function(e,t,n,r){Object(ce.f)(O.a.indexedDb,"Creating Sort(Cursor) strategy.");const a=Et();e.openCursor(a,nn(r)).onsuccess=i=>{const o=new zt(i.target,a),s=new Wt(e,n,r,o);t(s)}}(e,r,a,i)}(e,t,n,r);break;case 2:!function(e,t,n,r){const a=t.getCursorFactoryForComposite(e,n.get_sortBy()[0].get_sortField(),n.get_sortBy()[1].get_sortField()),i=n.get_sortBy()[0].get_sortOrder(),o=n.get_sortBy()[1].get_sortOrder();i===o&&a?en(a,i,null,r):function(e,t,n,r){Object(ce.f)(O.a.indexedDb,"Creating Sort(Sort(Cursor)) strategy.");const a=Et();e.openCursor(a,"next").onsuccess=i=>{const o=new zt(i.target,a),s=new Wt(e,t.get_sortField(),t.get_sortOrder(),o),c=new Wt(e,n.get_sortField(),n.get_sortOrder(),s);r(c)}}(e,n.get_sortBy()[0],n.get_sortBy()[1],r)}(e,t,n,r)}}(t,n,r,a):function(e){return!!e&&!!e.get_filter()&&e.get_filter()instanceof ge.a}(r)?function(e,t,n,r){switch(tn(n)){case 0:!function(e,t,n,r){Xt(e,t,n,r)}(e,t,n,r);break;case 1:!function(e,t,n,r){const a=n.get_filter(),i=n.get_sortBy()[0];if(a.get_field().get_path()===i.get_sortField().get_path()){const n=t.getCursorFactory(e,a.get_field());if(n){const e=rn(a);en(n,i.get_sortOrder(),e,r)}else Object(ce.i)(O.a.indexedDb,"This query would run faster with an index on {0}",a.get_field().get_path()),Jt(e,a,i,r)}else{const n=t.getCursorFactoryForComposite(e,a.get_field(),i.get_sortField());if(n){const e=IDBKeyRange.bound(Lt(a.get_fieldValue(),""),Lt(a.get_fieldValue(),"￿"),!0,!0);en(n,i.get_sortOrder(),e,r)}else Object(ce.i)(O.a.indexedDb,"This query would run faster with an index on {0}:{1}",a.get_field().get_path(),i.get_sortField().get_path()),Jt(e,a,i,r)}}(e,t,n,r);break;case 2:!function(e,t,n,r){const a=n.get_filter(),i=n.get_sortBy()[0],o=n.get_sortBy()[1];let s=t.getCursorFactoryForComposite(e,a.get_field(),i.get_sortField());if(s){!function(e,t,n,r,a,i,o){Object(ce.f)(O.a.indexedDb,"Creating Sort(Group((Index)) strategy.");t.openCursor(n,r).onsuccess=t=>{const r=new zt(t.target,n),s=new qt(a,r),c=new Wt(e,i.get_sortField(),i.get_sortOrder(),s);o(c)}}(e,s,IDBKeyRange.bound(Lt(a.get_fieldValue(),""),Lt(a.get_fieldValue(),"￿"),!0,!0),nn(i.get_sortOrder()),[a.get_field(),i.get_sortField()],o,r)}else i.get_sortOrder()===o.get_sortOrder()?(s=t.getCursorFactoryForComposite(e,i.get_sortField(),o.get_sortField()),s?Yt(s,null,a,r):(Object(ce.i)(O.a.indexedDb,"This query would run faster with an index on {0}:{1}",i.get_sortField().get_path(),o.get_sortField().get_path()),$t(e,a,i,o,r))):(Object(ce.i)(O.a.indexedDb,"This query would run faster with an index on {0}:{1}",a.get_field().get_path(),i.get_sortField().get_path()),$t(e,a,i,o,r))}(e,t,n,r)}}(t,n,r,a):function(e){return!!e&&!!e.get_filter()&&(e.get_filter()instanceof he.a||e.get_filter()instanceof me.a)}(r)?function(e,t,n,r){switch(tn(n)){case 0:!function(e,t,n,r){Xt(e,t,n,r)}(e,t,n,r);break;case 1:!function(e,t,n,r){const a=n.get_filter(),i=n.get_sortBy()[0],o=t.getCursorFactory(e,a.get_field());if(o){const t=rn(a);a.get_field().get_path()===i.get_sortField().get_path()?en(o,i.get_sortOrder(),t,r):function(e,t,n,r,a){Object(ce.f)(O.a.indexedDb,"Creating Sort(Index) strategy.");t.openCursor(n,"next").onsuccess=t=>{const i=new zt(t.target,n),o=new Wt(e,r.get_sortField(),r.get_sortOrder(),i);a(o)}}(e,o,t,i,r)}else Object(ce.i)(O.a.indexedDb,"This query would run faster with an index on {0}",a.get_field().get_path()),Jt(e,a,i,r)}(e,t,n,r);break;case 2:!function(e,t,n,r){const a=n.get_filter(),i=n.get_sortBy()[0],o=n.get_sortBy()[1],s=t.getCursorFactory(e,a.get_field());if(s){!function(e,t,n,r,a,i){Object(ce.f)(O.a.indexedDb,"Creating Sort(Sort(Index)) strategy.");t.openCursor(n,"next").onsuccess=t=>{const o=new zt(t.target,n),s=new Wt(e,r.get_sortField(),r.get_sortOrder(),o),c=new Wt(e,a.get_sortField(),a.get_sortOrder(),s);i(c)}}(e,s,rn(a),i,o,r)}else Object(ce.i)(O.a.indexedDb,"This query would run faster with an index on {0}",a.get_field().get_path()),$t(e,a,i,o,r)}(e,t,n,r)}}(t,n,r,a):function(e){return!!e&&!!e.get_filter()&&e.get_filter()instanceof fe.a}(r)?function(e,t,n,r){switch(tn(n)){case 0:!function(e,t,n,r){const a=t.getCursorFactory(e,n.get_filter().get_queryFields()[0]);if(a){Yt(a,rn(n.get_filter()),n.get_filter(),r)}else Object(ce.i)(O.a.indexedDb,"This query would run faster with an index on {0}",n.get_filter().get_queryFields()[0].get_path()),Zt(e,n.get_filter(),r)}(e,t,n,r);break;case 1:!function(e,t,n,r){const a=n.get_filter(),i=n.get_sortBy()[0],o=t.getCursorFactory(e,a.get_field());if(o){const t=rn(a);a.get_field().get_path()===i.get_sortField().get_path()?Yt(o,t,n.get_filter(),r):function(e,t,n,r,a,i){Object(ce.f)(O.a.indexedDb,"Creating Sort(Filter(Index)) strategy.");t.openCursor(n,"next").onsuccess=t=>{const o=new zt(t.target,n),s=new Gt(r,o),c=new Wt(e,a.get_sortField(),a.get_sortOrder(),s);i(c)}}(e,o,t,n.get_filter(),i,r)}else Object(ce.i)(O.a.indexedDb,"This query would run faster with an index on {0}",a.get_field().get_path()),Jt(e,a,i,r)}(e,t,n,r);break;case 2:!function(e,t,n,r){const a=n.get_filter(),i=n.get_sortBy()[0],o=n.get_sortBy()[1],s=t.getCursorFactory(e,a.get_field());if(s){!function(e,t,n,r,a,i,o){Object(ce.f)(O.a.indexedDb,"Creating Sort(Sort(Filter(Index))) strategy.");t.openCursor(n,"next").onsuccess=t=>{const s=new zt(t.target,n),c=new Gt(r,s),l=new Wt(e,a.get_sortField(),a.get_sortOrder(),c),u=new Wt(e,i.get_sortField(),i.get_sortOrder(),l);o(u)}}(e,s,rn(a),n.get_filter(),i,o,r)}else Object(ce.i)(O.a.indexedDb,"This query would run faster with an index on {0}",a.get_field().get_path()),$t(e,a,i,o,r)}(e,t,n,r)}}(t,n,r,a):Object(Ct.a)(!1,"unknown query type")}function Qt(e,t){!function(e,t){Object(ce.f)(O.a.indexedDb,"Creating Cursor strategy.");const n=Et();e.openCursor(n,"next").onsuccess=e=>{t(new zt(e.target,n))}}(e,t)}function Xt(e,t,n,r){const a=t.getCursorFactory(e,n.get_filter().get_queryFields()[0]);if(a){en(a,0,rn(n.get_filter()),r)}else Object(ce.i)(O.a.indexedDb,"This query would run faster with an index on {0}",n.get_filter().get_queryFields()[0].get_path()),Zt(e,n.get_filter(),r)}function Yt(e,t,n,r){Object(ce.f)(O.a.indexedDb,"Creating Filter(Index) strategy.");e.openCursor(t,"next").onsuccess=e=>{const a=new zt(e.target,t),i=new Gt(n,a);r(i)}}function Jt(e,t,n,r){Object(ce.f)(O.a.indexedDb,"Creating Sort(Filter((Cursor)) strategy.");const a=Et();e.openCursor(a,"next").onsuccess=i=>{const o=new zt(i.target,a),s=new Gt(t,o),c=new Wt(e,n.get_sortField(),n.get_sortOrder(),s);r(c)}}function $t(e,t,n,r,a){Object(ce.f)(O.a.indexedDb,"Creating Sort(Sort(Filter((Cursor))) strategy.");const i=Et();e.openCursor(i,"next").onsuccess=o=>{const s=new zt(o.target,i),c=new Gt(t,s),l=new Wt(e,n.get_sortField(),n.get_sortOrder(),c),u=new Wt(e,r.get_sortField(),r.get_sortOrder(),l);a(u)}}function Zt(e,t,n){Object(ce.f)(O.a.indexedDb,"Creating Filter(Cursor) strategy.");const r=Et();e.openCursor(r,"next").onsuccess=e=>{const a=new zt(e.target,r),i=new Gt(t,a);n(i)}}function en(e,t,n,r){Object(ce.f)(O.a.indexedDb,"Creating Index strategy.");e.openCursor(n,nn(t)).onsuccess=e=>{r(new zt(e.target,n))}}function tn(e){return e.get_sortBy()&&e.get_sortBy().length?1===e.get_sortBy().length?1:2===e.get_sortBy().length?2:(Object(Ct.a)(!1,"invalid number of sorts: "+e.get_sortBy().length),0):0}function nn(e){return e?"prev":"next"}function rn(e){let t=null;if(e instanceof he.a){const n=e;switch(n.get_intervalType()){case 0:t=IDBKeyRange.bound(n.get_leftBound(),n.get_rightBound(),!1,!1);break;case Se.a.open:t=IDBKeyRange.bound(n.get_leftBound(),n.get_rightBound(),!0,!0);break;case Se.a.openLeft:t=IDBKeyRange.bound(n.get_leftBound(),n.get_rightBound(),!0,!1);break;case Se.a.openRight:t=IDBKeyRange.bound(n.get_leftBound(),n.get_rightBound(),!1,!0);break;default:Object(Ct.a)(!1,"unknown range interval in CreateRangeFromQueryFilter")}}else if(e instanceof me.a){const n=e,r=!n.get_borderType();t=n.get_operatorType()?IDBKeyRange.upperBound(n.get_borderValue(),r):IDBKeyRange.lowerBound(n.get_borderValue(),r)}else if(e instanceof ge.a){const n=e;t=IDBKeyRange.only(n.get_fieldValue())}else if(e instanceof fe.a){const n=e;n.get_inValues().sort(),t=IDBKeyRange.bound(n.get_inValues()[0],n.get_inValues()[n.get_inValues().length-1],!1,!1)}else Object(Ct.a)(!1,"unknown filter type in CreateRangeFromQueryFilter");return t}class an{constructor(e,t,n,r){this._tx=null,this._os=null,this._metadata=null,this._observations=null,this._tx=e,this._os=t,this._metadata=n,this._observations=r}get_name(){return this._metadata.get_name()}getItem(e,t,n){const r=on(e);Object(F.b)(t,"successCallback");const a=this._os.get(r);a.onerror=e=>{Object(ce.d)(O.a.indexedDb,"Error getting object from store:{0} with id:{1}. Error:{2}",this.get_name(),r,e.target.errorCode),Pt.reportIdbError(e.target.errorCode,n)},a.onsuccess=e=>{let n=null;const a=e.target.result;a&&(Object(Ct.a)(void 0!==a.data,"the record for id:"+r+" in store "+this.get_name()+" does not have a data segment!"),Object(Ct.a)(void 0!==a.metadata,"the record for id:"+r+" in store "+this.get_name()+" does not have a metadata segment!"),n=a.data),t(n)}}deleteItem(e,t,n){this._observations.onBeforeDelete(this,e),this._tx.get_notificationCallback()(this.get_name(),Ot.deleteItem,e,null);const r=on(e),a=this._os.delete(r);a.onerror=t=>{Object(ce.d)(O.a.indexedDb,"Error deleting from object store:{0} the id:{1}. ErrorCode:{2}",this.get_name(),e.toKeyValue(),t.target.errorCode),Pt.reportIdbError(t.target.errorCode,n)},a.onsuccess=()=>{Pt.reportSuccess(t)}}clear(e,t){this._observations.onBeforeClear(this);const n=this._os.clear();n.onerror=e=>{Object(ce.d)(O.a.indexedDb,"Error clearing from object store:{0}. ErrorCode:{1}",this.get_name(),e.target.errorCode),Pt.reportIdbError(e.target.errorCode,t)},n.onsuccess=()=>{Pt.reportSuccess(e)}}putItem(e,t,n,r){Object(F.b)(t,"json"),this._observations.onBeforePut(this,e,t),this._tx.get_notificationCallback()(this.get_name(),Ot.changeItem,e,t);const a=new kt(t,{});for(let t=0;t<this._metadata.get_indexes().length;++t)this._metadata.get_indexes()[t].applyTo(a,e,this.get_name());const i=e.toKeyValue(),o=null===i?this._os.put(a):this._os.put(a,i);o.onerror=e=>{Object(ce.d)(O.a.indexedDb,"PutItem: putRequest error"),Pt.reportIdbError(e.target.errorCode,r)},o.onsuccess=e=>{n&&n(new dt(e.target.result))}}objectQuery(e,t,n){Object(F.b)(t,"successCallback"),e&&this._CheckIfIndexedFieldsExist(e),Kt(this._tx.get_idbTransaction(),this._os,this._metadata,e,e=>{t(new Ft(this._tx,e))},n)}_CheckIfIndexedFieldsExist(e){this._CheckIfQueryFieldsExist(e),this._CheckIfSortFieldsExist(e)}_CheckIfSortFieldsExist(e){if(e.get_sortBy())for(let t=0;t<e.get_sortBy().length;++t)if(!this._metadata.hasIndexedField(e.get_sortBy()[t].get_sortField().get_path())){const n=String.format("KeyPath {0} is being sorted but it is not an indexed field",e.get_sortBy()[t].get_sortField().get_path());wt.throwException(de.constraintError,n)}}_CheckIfQueryFieldsExist(e){if(e.get_filter()){const t=e.get_filter().get_queryFields();for(let e=0;e<t.length;++e)if(!this._metadata.hasIndexedField(t[e].get_path())){const n=String.format("KeyPath {0} is being queried but it is not an indexed field",t[e].get_path());wt.throwException(de.constraintError,n)}}}}function on(e){Object(F.b)(e,"id");const t=e.toKeyValue();return Object(F.b)(t,"id must be provided"),Object(F.c)(t.toString(),"id must be provided"),t}class sn{constructor(e,t,n,r){this._idbTransaction=null,this._metadata=null,this._observations=null,this._notificationEvents=null,this._isReadOnly=!1,this._publishNotifications=!1,this._aborted=!1,this._idbTransaction=e,this._observations=new Dt,this._metadata=t,this._publishNotifications=!0,this._isReadOnly=r,this._notificationEvents=new Rt(n)}get_isReadOnly(){return this._isReadOnly}get_idbTransaction(){return this._idbTransaction}get_aborted(){return this._aborted}get_notificationCallback(){return Object(te.a)(this._notificationEvents,this._notificationEvents.queueNotificationEvents,"queueNotificationEvents")}publishNotificationEvents(){this._publishNotifications&&this._notificationEvents.publishNotificationEvents()}openObjectStore(e){if(e=e.toLowerCase(),!this._metadata.storeExists(e))throw Error.invalidOperation("storeName "+e+" does not exist.");const t=this._idbTransaction.objectStore(e),n=this._publishNotifications?this._observations:new Dt;return new an(this,t,this._metadata.getStore(e),n)}}class cn{constructor(e,t){this._version=null,this._name=null,this._indexNamesToMetadataMap=null,this._singleIndexFieldsToMetadataMap=null,this._compositeIndexFieldsToMetadataMap=null,this._allIndexedFields=null,this._indexMetadata=null,this._name=e,this._version=t,this._indexNamesToMetadataMap={},this._singleIndexFieldsToMetadataMap={},this._compositeIndexFieldsToMetadataMap={},this._allIndexedFields=[],this._indexMetadata=[]}get_name(){return this._name}get_indexes(){return this._indexMetadata}addIndex(e){this._indexNamesToMetadataMap[e.get_indexName()]=e;for(let t=0;t<e.get_sourceFields().length;++t)this._allIndexedFields.indexOf(e.get_sourceFields()[t].get_path())<0&&this._allIndexedFields.push(e.get_sourceFields()[t].get_path());1===e.get_sourceFields().length?this._singleIndexFieldsToMetadataMap[e.get_sourceFields()[0].get_path()]=e:this._compositeIndexFieldsToMetadataMap[e.get_sourceFields()[0].get_path()+e.get_sourceFields()[1].get_path()]=e,this._indexMetadata.push(e)}indexExists(e){return e in this._indexNamesToMetadataMap}hasIndexedField(e){if(e===pe.a.get_id().get_path())return!0;for(let t=0;t<this._allIndexedFields.length;++t)if(this._allIndexedFields[t]===e)return!0;return!1}getCursorFactory(e,t){let n=null;if(t.get_path()===pe.a.get_id().get_path())n=e;else{const r=this._singleIndexFieldsToMetadataMap[t.get_path()];r&&(n=e.index(r.get_indexName()))}return n}getCursorFactoryForComposite(e,t,n){let r=null;if(t===n)r=this.getCursorFactory(e,t);else{const a=this._compositeIndexFieldsToMetadataMap[t.get_path()+n.get_path()];a&&(r=e.index(a.get_indexName()))}return r}clone(){const e=new cn(this._name,this._version);for(const t of this.get_indexes())e.addIndex(t);return e}}class ln{constructor(){this._objectStores=null,this._objectStores={}}get_objectStores(){return Object.keys(this._objectStores)}getStore(e){return Object(Ct.a)(this.storeExists(e),"the store doesn't exist"+e),this._objectStores[e]}add(e,t){Object(Ct.a)(!this.storeExists(e),"the object store: "+e+" already exists."),this._objectStores[e]=new cn(e,t)}storeExists(e){return e in this._objectStores}clone(){const e=new ln;e._objectStores={};const t=this._objectStores;for(const n in t){const r={key:n,value:t[n]},a=r.value;e._objectStores[r.key]=a.clone()}return e}remove(e){delete this._objectStores[e]}addIndex(e,t){const n=this._objectStores[e];Object(Ct.a)(!!n,"cannot add index unless object store exists"),n.addIndex(t)}indexExists(e,t){const n=this._objectStores[e];return Object(Ct.a)(!!n,"cannot query index information unless object store exists"),n.indexExists(t)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class un{constructor(e,t){this.unique=!1,this.multirow=!1,this.unique=e,this.multirow=t}static get_defaultOptions(){return dn}}const dn=new un(!1,!1);class pn{constructor(e,t,n){this.storeName=null,this.indexName=null,this.keyPaths=null,this.storeName=e,this.indexName=t,this.keyPaths=new Array(n.length);for(let e=0;e<n.length;++e)this.keyPaths[e]=n[e].get_keyPath().get_path()}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class fn{constructor(e,t){this.name=null,this.version=null,this.name=e.toLowerCase(),this.version=t}}class gn{constructor(e,t,n){this._indexName=null,this._sourceFields=null,this._keyPathInIdbRecord=null,this._indexName=e,this._sourceFields=new Array(0),this._keyPathInIdbRecord=n;for(let e=0;e<t.length;++e)this._sourceFields.push(new pe.a(t[e]))}get_keyPathInIdbRecord(){return this._keyPathInIdbRecord}get_sourceFields(){return this._sourceFields}get_indexName(){return this._indexName}static validateSourceField(e,t,n,r){const a=e.getField(t.data);if(Object(s.a)(a)){const t=String.format("KeyPath {0} is a declared index on store {1} but does not exist in object with id {2}",e.get_path(),r,n.toKeyValue());throw Object(ce.d)(O.a.indexedDb,t),Error.invalidOperation(t)}if("string"!=typeof a&&"number"!=typeof a){const t=String.format("KeyPath {0} is a declared index on store {1} but the object with id {2} is attempting to store the non-primitive type {3}.",e.get_path(),r,n.toKeyValue(),Object.getType(a).getName());throw Error.invalidOperation(t)}}}class hn extends gn{constructor(e,t){super(e,t,new pe.a("data."+t[0]))}applyTo(e,t,n){gn.validateSourceField(this.get_sourceFields()[0],e,t,n)}}class mn extends gn{constructor(e,t){super(e,t,new pe.a("metadata."+e))}applyTo(e,t,n){gn.validateSourceField(this.get_sourceFields()[0],e,t,n),gn.validateSourceField(this.get_sourceFields()[1],e,t,n);const r=this.get_sourceFields()[0].getField(e.data),a=this.get_sourceFields()[1].getField(e.data);e.metadata[this.get_indexName()]=Lt(r,a)}}function bn(e){if(1===e.keyPaths.length)return new hn(e.indexName,e.keyPaths);if(2===e.keyPaths.length)return new mn(e.indexName,e.keyPaths);throw Error.argument("fields","composite keys can only have two columns")}class yn{constructor(e,t,n){this._db=null,this._tx=null,this._versionObjectStore=null,this._indexObjectStore=null,this._metadata=null,this._db=e,this._tx=t,this._metadata=n,this._versionObjectStore=t.objectStore("__versions"),this._indexObjectStore=t.objectStore("__indexes")}createObjectStore(e,t,n){if(this._metadata.storeExists(e))throw Error.invalidOperation("the object store: "+e+" already exists.");if(e.startsWith("__"))throw Error.invalidOperation("the object store: "+e+" begins with the reserved prefix __.");this._db.createObjectStore(e,new It(null,n)),this._metadata.add(e,t),this._versionObjectStore.put(new fn(e,t),e)}removeObjectStore(e){if(!this._metadata.storeExists(e))throw Error.invalidOperation("the object store: "+e+" does not exist.");this._db.deleteObjectStore(e),this._metadata.remove(e),this._versionObjectStore.delete(e);this._indexObjectStore.openCursor(Et(),"next").onsuccess=t=>{const n=t.target.result;if(n){n.value.storeName===e&&n.delete(),n.continue()}}}createIndex(e,t,n){if(!this._metadata.storeExists(t))throw Error.invalidOperation("the object store: "+t+" does not exist.");if(this._metadata.indexExists(t,e))throw Error.invalidOperation("the object store: "+t+" already has index "+e+" declared.");const r=new pn(t,e,n);this._indexObjectStore.put(r);const a=this._tx.objectStore(t),i=bn(r);a.createIndex(e,i.get_keyPathInIdbRecord().get_path(),un.get_defaultOptions()),this._metadata.addIndex(r.storeName,i)}}var _n,vn,Sn=n("g73c");function On(e,t,n){Object(Ct.a)(Object(s.a)(e.onabort),"onabort should not be subscribed yet"),Object(Ct.a)(Object(s.a)(e.oncomplete),"onsuccess should not be subscribed yet"),Object(Ct.a)(Object(s.a)(e.onerror),"onerror should not be subscribed yet"),e.oncomplete=()=>{Object(ce.f)(O.a.indexedDb,"idb transaction successfully completed"),Pt.reportSuccess(t),e.onabort=null,e.oncomplete=null},e.onabort=t=>{Object(ce.i)(O.a.indexedDb,"idb transaction aborted!");let r=St.AbortError;const a=t.target.error;a&&(r=Object(Sn.a)(St,a.name),Object(ce.d)(O.a.indexedDb,"aborted due to error: "+r+":Error name = "+a.name+":Mode = "+e.mode)),Pt.reportIdbError(r,n),e.onabort=null,e.oncomplete=null}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */!function(e){e.readonly="readonly",e.readwrite="readwrite",e.versionchange="versionchange"}(_n||(_n={}));class Cn{constructor(e,t){this._factory=null,this._name=null,this._subscriptions=null,this._version=null,this._db=null,this._metadata=null,this._factory=e,this._name=t,this._SetUninitialized()}get_version(){return this._version}get_objectStores(){return this._metadata.get_objectStores()}changeSchema(e,t,n,r){this._EnsureInitialized(()=>{this._InternalChangeSchema(e,t,n,r)},r)}transaction(e,t,n,r){this._TransactionInternal(e,t,n,r,!1)}readOnlyTransaction(e,t,n,r){this._TransactionInternal(e,t,n,r,!0)}_TransactionInternal(e,t,n,r,a){if(this._IsInitialized()){const i=this._db.transaction(e||this.get_objectStores(),a?_n.readonly:_n.readwrite),o=new sn(i,this._metadata,this._subscriptions,a);On(i,()=>{o.publishNotificationEvents(),Pt.reportSuccess(n),n=null,r=null},t=>{r&&(Object(ce.d)(O.a.indexedDb,"TransactionInternal.Subscribe: Error. Transaction type - readOnly = "+a+" :objectStores = "+e.toString()),t=o.get_aborted()?new wt(de.aborted,"Transaction manually aborted."):t,r(t)),n=null,r=null});try{t(o)}catch(t){Object(ce.e)(O.a.indexedDb,t,"TransactionInternal:IDB caught an exception on the transaction callback and will abort.Transaction type - readOnly = "+a+" :objectStores = "+e.toString()),i.abort()}}else Object(ce.d)(O.a.indexedDb,"TransactionInternal: Trying to acesss database when database is not initialized. Transaction type - readOnly = "+a+" :objectStores = "+e.toString())}wipe(e,t){Object(ce.i)(O.a.indexedDb,"Wipe: Wipe/Uninitialize the database, IsInitialized = "+this._IsInitialized()),this._IsInitialized()&&this._db.close();const n=this._factory.deleteDatabase(this._name);n.onsuccess=()=>{Object(ce.i)(O.a.indexedDb,"Wipe: DeleteDatabase success"),this._SetUninitialized(),Pt.reportSuccess(e)},n.onerror=e=>{Object(ce.d)(O.a.indexedDb,"Wipe: DeleteDatabase error"),Pt.reportIdbError(e.target.errorCode,t)}}Initialize(e,t){Object(Ct.a)(!this._db,"Initialize cannot be called with an active database");const n=this._factory.open(this._name);n.onsuccess=n=>{if(this._db=n.target.result,this._InternalObjectStoresExist()){const n=this._db.transaction(Array.from(this._db.objectStoreNames),_n.readwrite);On(n,e,t),this._PopulateMetadataFromInternalStores(n),Object(ce.i)(O.a.indexedDb,"Initialize: Initialized the db, PopulateMetadataFromInternalStore")}else Object(ce.i)(O.a.indexedDb,"Initialize: Initialized the db"),e()},n.onerror=e=>{Object(ce.d)(O.a.indexedDb,"Initialize: factory.Open failed , errorcode = "+e.target.errorCode),Pt.reportIdbError(e.target.errorCode,t)}}_InternalObjectStoresExist(){return this._VersionStoreExists()&&this._IndexStoreExists()}_IndexStoreExists(){return this._db.objectStoreNames.contains("__indexes")}_VersionStoreExists(){return this._db.objectStoreNames.contains("__versions")}_EnsureInternalObjectStores(){this._VersionStoreExists()||this._db.createObjectStore("__versions",It.forExternalKey()),this._IndexStoreExists()||this._db.createObjectStore("__indexes",It.forAutoIncrementedKey())}_PopulateMetadataFromInternalStores(e){this._PopulateVersionInformation(e),this._PopulateIndexInformation(e)}_PopulateIndexInformation(e){e.objectStore("__indexes").openCursor(Et(),"next").onsuccess=e=>{const t=e.target.result;if(t){const e=t.value,n=bn(e);this._metadata.addIndex(e.storeName,n),t.continue()}}}_PopulateVersionInformation(e){const t=e.objectStore("__versions");this._PopulateDatabaseVersion(t),this._PopulateObjectStoreVersions(t)}_PopulateObjectStoreVersions(e){for(let t=0;t<this._db.objectStoreNames.length;++t)if(!this._db.objectStoreNames[t].startsWith("__")){e.get(this._db.objectStoreNames[t]).onsuccess=e=>{const t=e.target.result;this._metadata.add(t.name,t.version)}}}_PopulateDatabaseVersion(e){e.get("__db").onsuccess=e=>{const t=e.target.result;this._version=t.version}}_CreateAndReportOnSchemaUpdater(e,t,n){const r=new yn(this._db,n,t);try{e(r)}catch(e){Object(ce.d)(O.a.indexedDb,"aborting transaction due to exception during schema update: "+e.message),n.abort()}}_SetDatabaseVersion(e,t){t.objectStore("__versions").put(new fn("__db",e),"__db")}_InternalChangeSchema(e,t,n,r){const a=this._metadata.clone(),i=this._db.version+1;Object(ce.i)(O.a.indexedDb,"InternalChangeSchema: newIdbVersion = "+i+" :uninitialize the old db and upgrade"),this._db.close();const o=this._factory.deleteDatabase(this._name);o.onsuccess=()=>{this._SetUninitialized(),Object(ce.i)(O.a.indexedDb,"InternalChangeSchema:Deleted old database now open new database");const o=this._factory.open(this._name,i);o.onupgradeneeded=n=>{const i=n.target;this._db=i.result,Object(ce.i)(O.a.indexedDb,"InternalChangeSchema: Initialized the db : this._db exists ?  "+this._IsInitialized()),this._UpgradeDatabaseVersion(e,a,i.transaction,t,r)},o.onsuccess=()=>{this._IsInitialized()?(Object(ce.i)(O.a.indexedDb,"InternalChangeSchema:open new database : Success "),Pt.reportSuccess(n)):(Object(ce.i)(O.a.indexedDb,"InternalChangeSchema:Failed because open new database was Success but Onupgradeneeded event was not fired "),Pt.reportIdbError(St.InvalidStateError,r))},o.onerror=e=>{Object(ce.d)(O.a.indexedDb,"InternalChangeSchema: factory.Open error , errorcode = "+e.target.errorCode),Pt.reportIdbError(e.target.errorCode,r)}},o.onerror=e=>{Object(ce.d)(O.a.indexedDb,"InternalChangeSchema: factory.DeleteDatabase error , errorcode = "+e.target.errorCode),Pt.reportIdbError(e.target.errorCode,r)}}_UpgradeDatabaseVersion(e,t,n,r,a){Object(ce.i)(O.a.indexedDb,"UpgradeDatabaseVersion:open new database : newVersion = "+e),On(n,()=>{this._metadata=t,this._version=e},a),this._EnsureInternalObjectStores(),this._SetDatabaseVersion(e,n),this._CreateAndReportOnSchemaUpdater(r,t,n)}_IsInitialized(){return!Object(s.a)(this._db)}_SetUninitialized(){this._db=null,this._version="",this._metadata=new ln,this._subscriptions=new jt(this),Object(ce.i)(O.a.indexedDb,"SetUninitialized: Uninitialized the db")}_EnsureInitialized(e,t){this._IsInitialized()?e():this.Initialize(e,t)}}class En extends vt{constructor(e){super(),this._factory=null,this._factory=e}openDatabase(e,t,n,r){Object(F.b)(n,"successCallback"),Object(F.c)(e,"name");const a=new Cn(this._factory,e);a.Initialize(()=>{n(a)},r)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */!function(e){e[e.unknownErr=0]="unknownErr",e[e.databaseErr=1]="databaseErr",e[e.versionErr=2]="versionErr",e[e.tooLargeErr=3]="tooLargeErr",e[e.quotaErr=4]="quotaErr",e[e.syntaxErr=5]="syntaxErr",e[e.constraintErr=6]="constraintErr",e[e.timeoutErr=7]="timeoutErr"}(vn||(vn={}));class In extends wt{static reportSqlError(e,t){const n=e.message,r=function(e){let t=0;switch(e.code){case vn.constraintErr:t=de.constraintError;break;case vn.databaseErr:t=de.databaseError;break;case vn.quotaErr:t=de.quotaError;break;case vn.syntaxErr:t=de.syntaxError;break;case vn.timeoutErr:t=de.timeoutError;break;case vn.tooLargeErr:t=de.tooLargeError;break;case 0:t=0;break;case vn.versionErr:t=de.versionError}return t}(e);Object(ce.d)(O.a.sql,"SQL Error - code "+r+": {0}",n+":original sql error.code = "+e.code),In.reportError(r,n,t)}static reportError(e,t,n){n&&n(new In(e,t))}}class wn{constructor(e,t){this._sqlQueryBuilder=null,this._tx=null,this._offset=0,this._seeking=!1,this._tx=e,this._sqlQueryBuilder=t}_set_offset(e){return this._offset=e,e}approximateCount(e,t){const n=Object(rt.c)(this._sqlQueryBuilder.get_storeDbType());Tn.ExecuteSql(this._tx.get_SqlTransaction(),this._sqlQueryBuilder.get_selectCountStatement(),this._sqlQueryBuilder.get_sqlArguments(),(t,n)=>{const r=n.rows.item(0)["COUNT(*)"];e(r)},t,n)}next(e,t,n,r){this._ThrowIfSeeking(),this._sqlQueryBuilder.set_doPaging(!0),this._sqlQueryBuilder.set_offset(this._offset),this._sqlQueryBuilder.set_limit(e);const a=t?this._sqlQueryBuilder.get_selectIdStatement():this._sqlQueryBuilder.get_selectJsonStatement();this._set_offset(this._offset+e);const i=Object(rt.c)(this._sqlQueryBuilder.get_storeDbType());Tn.ExecuteSql(this._tx.get_SqlTransaction(),a,this._sqlQueryBuilder.get_sqlArguments(),(e,r)=>{if(n){const e=[];for(let n=0;n<r.rows.length;++n){const a=wn.getEntry(n,r,t);e.push(a)}n(this._tx,e)}},r,i)}skip(e,t,n){this._offset+=e,t()}internalSeekTo(e,t,n,r){this._sqlQueryBuilder.set_doPaging(!0),this._sqlQueryBuilder.set_offset(t),this._sqlQueryBuilder.set_limit(gt.m);const a=this._sqlQueryBuilder.selectIndexedColumnsStatement(e.get_queryFields()),i=Object(rt.c)(this._sqlQueryBuilder.get_storeDbType());Tn.ExecuteSql(this._tx.get_SqlTransaction(),a,this._sqlQueryBuilder.get_sqlArguments(),(a,i)=>{const o=function(e,t){for(let n=0;n<e.rows.length;++n)if(t.isSatisfiedBy(e.rows.item(n)))return n;return-1}(i,e),s=-1!==o,c=i.rows.length>0;s||!c?(this._seeking=!1,this._set_offset(t+o),n(s)):this.internalSeekTo(e,t+i.rows.length,n,r)},e=>{this._seeking=!1,r&&r(e)},i)}dispose(){}_ThrowIfSeeking(){if(this._seeking)throw Error.invalidOperation("A seek operation is currently in progress")}static getEntry(e,t,n){const r=t.rows.item(e),a=r[gt.c];if(Object(Ct.a)(!Object(s.a)(a),"id cannot be null because put would have failed"),n)return new xt(new dt(a),null);const i=r[gt.d];Object(Ct.a)(!!i,"serialized json cannot be null because put would have failed");const o=JSON.parse(i);return Object(Ct.a)(!Object(s.a)(o),"JSON cannot be null or undefined because put would have failed.  Serialized JSON: "+i),new xt(new dt(a),o)}}var jn=n("bATk");class Pn{constructor(e,t,n,r){this._tx=null,this._metadata=null,this._queueEventsCallback=null,this._observations=null,this._tx=e,this._metadata=t,this._queueEventsCallback=n,this._observations=r}get_name(){return this._metadata.get_objectStore()}_get_indexedFields(){return this._metadata.get_indexedFields()}getItem(e,t,n){Object(F.b)(e,"id must be provided"),Object(F.b)(e.toKeyValue(),"id must be provided"),Object(F.b)(t,"success callback must be provided");const r=e.toKeyValue();Object(F.b)(r,"id must be provided"),Object(F.c)(r.toString(),"id must be provided");const a=String.format("SELECT * FROM [{0}] WHERE {1} = ?",this._metadata.get_objectStore(),gt.c),i=[r],o=Object(rt.c)(this._metadata.get_storeDbType());Tn.ExecuteSql(this._tx.get_SqlTransaction(),a,i,(e,n)=>{const r=function(e){let t=null;e.rows.length&&(Object(Ct.a)(1===e.rows.length,"if row length is not 0 it must be 1 for primary key query"),t=wn.getEntry(0,e,!1).get_json());return t}(n);t(r)},n,o)}deleteItem(e,t,n){Object(F.b)(e,"id must be provided");const r=e.toKeyValue();Object(F.b)(r,"id must be provided"),Object(F.c)(r.toString(),"id must be provided");const a=String.format("DELETE FROM [{0}] WHERE {1} = ?",this._metadata.get_objectStore(),gt.c),i=[r];this._observations.onBeforeDelete(this,e);const o=Object(rt.c)(this._metadata.get_storeDbType());Tn.ExecuteSql(this._tx.get_SqlTransaction(),a,i,()=>{this._queueEventsCallback&&this._queueEventsCallback(this.get_name(),Ot.deleteItem,e,null),t&&t()},n,o)}clear(e,t){const n=String.format("DELETE FROM [{0}]",this._metadata.get_objectStore());this._observations.onBeforeClear(this);const r=Object(rt.c)(this._metadata.get_storeDbType());Tn.ExecuteSql(this._tx.get_SqlTransaction(),n,[],()=>{e&&e()},t,r)}putItem(e,t,n,r){Object(F.b)(e,"id must be provided"),Object(F.b)(t,"json must be provided");const a=String.format("INSERT OR REPLACE INTO [{0}] {1} VALUES {2}",this._metadata.get_objectStore(),this._BuildColumnNamesForPut(),this._BuildValuePlaceHoldersForPut()),i=this._BuildValueArgumentsForPut(e.toKeyValue(),t);this._observations.onBeforePut(this,e,t);const o=Object(rt.c)(this._metadata.get_storeDbType());Tn.ExecuteSql(this._tx.get_SqlTransaction(),a,i,(r,a)=>{this._queueEventsCallback&&this._queueEventsCallback(this.get_name(),Ot.changeItem,e,t),e.toKeyValue()||(Object(Ct.a)(!!a.insertId,"sqlite begins ids at 1"),e=new dt(a.insertId)),n&&n(e)},r,o)}objectQuery(e,t,n){Object(F.b)(t,"success"),this._CheckRequiredFieldsAreIndexed(e);const r=Object(jn.a)(e,this._metadata.get_objectStore());r.set_storeDbType(this._metadata.get_storeDbType()),t(new wn(this._tx,r))}_CheckRequiredFieldsAreIndexed(e){e&&(this._CheckQueryFieldsAreIndexed(e),this._CheckSortFieldsAreIndexed(e))}_CheckSortFieldsAreIndexed(e){if(e.get_sortBy())for(let t=0;t<e.get_sortBy().length;++t)if(!this._metadata.hasIndexedField(e.get_sortBy()[t].get_sortField().get_path())){const n=String.format("KeyPath {0} is being sorted but it is not an indexed field",e.get_sortBy()[t].get_sortField().get_path());wt.throwException(de.constraintError,n)}}_CheckQueryFieldsAreIndexed(e){if(e.get_filter()){const t=e.get_filter().get_queryFields();for(let e=0;e<t.length;++e)if(!this._metadata.hasIndexedField(t[e].get_path())){const n=String.format("KeyPath {0} is being queried but it is not an indexed field",t[e].get_path());wt.throwException(de.constraintError,n)}}}_BuildValueArgumentsForPut(e,t){const n=[e,JSON.stringify(t)];for(let r=0;r<this._get_indexedFields().length;++r){const a=new pe.a(this._get_indexedFields()[r]).getField(t);this._ThrowIfKeyPathValueIsMissing(e,this._get_indexedFields()[r],a),this._ThrowIfKeyPathValueIsNonPrimitive(e,this._get_indexedFields()[r],a),n.push(a)}return n}_ThrowIfKeyPathValueIsMissing(e,t,n){if(Object(s.a)(n)){const n=String.format("KeyPath {0} is a declared index on store {1} but does not exist in object with id {2}",t,this._metadata.get_objectStore(),e);wt.throwException(de.constraintError,n)}}_ThrowIfKeyPathValueIsNonPrimitive(e,t,n){if("string"!=typeof n&&"number"!=typeof n){const r=String.format("KeyPath {0} is a declared index on store {1} but the object with id {2} is attempting to store the non-primitive type {3}.",t,this._metadata.get_objectStore(),e,Object.getType(n).getName());wt.throwException(de.constraintError,r)}}_BuildValuePlaceHoldersForPut(){let e="(?, ?";for(let t=0;t<this._get_indexedFields().length;++t)e+=", ?";return e+")"}_BuildColumnNamesForPut(){let e=String.format("({0}, {1}",gt.c,gt.d);for(let t=0;t<this._get_indexedFields().length;++t)e+=String.format(", [{0}]",this._get_indexedFields()[t]);return e+")"}}class Tn{constructor(e,t,n,r){this._tx=null,this._metadata=null,this._isReadOnly=!1,this._notificationEvents=null,this._observations=null,this._publishNotifications=!1,this._aborted=!1,this._tx=e,this._metadata=t,this._observations=new Dt,this._notificationEvents=null,this._publishNotifications=!0,this._isReadOnly=r,n&&(this._notificationEvents=new Rt(n))}get_isReadOnly(){return this._isReadOnly}get_aborted(){return this._aborted}get_eventCallback(){let e=null;return this._notificationEvents&&(e=Object(te.a)(this._notificationEvents,this._notificationEvents.queueNotificationEvents,"queueNotificationEvents")),e}get_SqlTransaction(){return this._tx}openObjectStore(e){const t=this._metadata.getObjectStoreMetadata(e);if(!t)throw Error.invalidOperation(String.format("Object store {0} does not exist",e));const n=this._publishNotifications?this._observations:new Dt;return new Pn(this,t,this.get_eventCallback(),n)}publishNotificationEvents(){this._publishNotifications&&this._notificationEvents&&this._notificationEvents.publishNotificationEvents()}static ExecuteSql(e,t,n,r,a,i){let o="";Object(ce.b)()&&(o=String.format("ExecuteSql => {0}",t)),void 0===i[rt.a.StoreDbType]&&(i[rt.a.StoreDbType]=rt.b.OrgDb),e.executeSql(t,n,(e,t)=>{Object(ce.b)()&&Object(ce.f)(O.a.sql,"SUCCESS!: {0}",o),r&&r(e,t)},(e,t)=>(Object(ce.b)()&&Object(ce.d)(O.a.sql,"ERROR! error Message ='{0}': {1} :error Code = {2}",t.message,o,t.code),In.reportSqlError(t,a),!0),i)}}class Nn{constructor(e,t,n){this._storeName=null,this._version=null,this._indexNames=null,this._storeDbType=null,this._indexedFields=null,this._storeName=e,this._version=t,this._indexNames={},this._indexedFields={},this._storeDbType=n}get_storeDbType(){return this._storeDbType}get_objectStore(){return this._storeName}get_version(){return this._version}get_indexedFields(){return Object.keys(this._indexedFields).map(e=>this._indexedFields[e])}isEqual(e){return this._storeName.toLowerCase()===e.toLowerCase()}clone(){const e=new Nn(this.get_objectStore(),this.get_version(),this.get_storeDbType());return e._indexNames=Object.assign({},this._indexNames),e._indexedFields=Object.assign({},this._indexedFields),e}addIndex(e){this._indexNames[e.toLowerCase()]=e}addIndexedField(e){this._indexedFields[e.toLowerCase()]=e}hasIndex(e){return e.toLowerCase()in this._indexNames}hasIndexedField(e){return e.toLowerCase()in this._indexedFields||e.toLowerCase()===gt.c}}class An{constructor(){this._entries=[]}get_objectStores(){const e=[];for(let t=0;t<this._entries.length;++t){const n=this._GetEntryAt(t);e.push(n.get_objectStore())}return e}add(e,t,n=rt.b.OrgDb){null==n&&(n=rt.b.OrgDb),this._FindOrCreateEntry(e,t,n)}remove(e){for(let t=0;t<this._entries.length;++t){if(this._GetEntryAt(t).isEqual(e.get_objectStore())){this._entries.splice(t,1);break}}}clone(){const e=new An;for(let t=0;t<this._entries.length;++t){const n=this._GetEntryAt(t);e._entries.push(n.clone())}return e}exists(e){return!!this.findEntry(e)}findEntry(e){let t=null;for(let n=0;n<this._entries.length;++n){const r=this._GetEntryAt(n);if(r.isEqual(e)){t=r;break}}return t}getObjectStoreMetadata(e){return this.findEntry(e)}_GetEntryAt(e){return this._entries[e]}_FindOrCreateEntry(e,t,n){let r=this.findEntry(e);return r||(r=new Nn(e,t,n),this._entries.push(r)),r}static createEmpty(){return new An}static createFromResultSets(e,t){const n=new An,r={};for(let e=0;e<t.rows.length;++e){const n=t.rows.item(e);r[n[gt.j].toLowerCase()]=n[gt.l]}const a=e.rows;for(let e=0;e<a.length;++e){const t=a.item(e),i=t[gt.h],o=t[gt.e],c=t[gt.f],l=n._FindOrCreateEntry(i,r[i.toLowerCase()],ot(i));Object(s.b)(o)||l.addIndex(o),Object(s.b)(c)||l.addIndexedField(c)}return n}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function Rn(e){if(!new RegExp("^[@\\#\\$\\w]+(\\.[@\\#\\$\\w]+)?$").test(e))throw Error.invalidOperation("'"+e+"' is not a valid SQL identifier name.");return e}class Dn{constructor(e,t){this._objectStoreMetadata=null,this._transaction=null,this._transaction=e,this._objectStoreMetadata=t}createObjectStore(e,t,n,r){this._EnsureExistingTableDoesNotExist(e),function(e){if(e.startsWith("__"))throw Error.create("An object store cannot be created with a name beginning with __")}(e),this._RemoveUnderlyingObjectStoreTable(e,r),this._CreateUnderlyingObjectStoreTable(e,n,r),this._AddStoreVersionToVersionsTable(e,t),this._AddStoreNameToObjectStoreMetadata(e,t,r)}removeObjectStore(e){const t=this._EnsureExistingTableExistsAndReturnMetadata(e);this._RemoveUnderlyingObjectStoreTable(t.get_objectStore(),t.get_storeDbType()),this._RemoveStoreNameFromObjectStoreMetadata(t)}createIndex(e,t,n){!function(e){if(e.length>2)throw Error.invalidOperation("Cannot create a multi-column index with more than two fields")}(n);const r=this._EnsureExistingTableExistsAndReturnMetadata(t);!function(e,t){if(e.hasIndex(t))throw Error.invalidOperation(String.format("The index {0} already exists",t))}(r,e),this._CreateColumnsForIndexedFields(e,n,r),this._CreateSqlIndexOnColumns(e,r,n,r.get_storeDbType()),r.addIndex(e)}purgeObjectStoreMetadata(){const e=String.format("DELETE FROM {0}",gt.g),t=new Array(0),n=Object(rt.c)(rt.b.OrgDb);Tn.ExecuteSql(this._transaction,e,t,null,null,n)}purgeVersionMetadata(){const e=String.format("DELETE FROM {0}",gt.k),t=new Array(0),n=Object(rt.c)(rt.b.OrgDb);Tn.ExecuteSql(this._transaction,e,t,null,null,n)}_CreateColumnsForIndexedFields(e,t,n){for(let r=0;r<t.length;++r){const a=t[r];n.hasIndexedField(a.get_keyPath().get_path())||(this._AlterTableToAddColumnForIndex(n,a,n.get_storeDbType()),this._AddIndexInformationToMetaTable(n,e,a))}}_CreateUnderlyingObjectStoreTable(e,t,n){n=Object(rt.d)(n);const r=t?"INTEGER PRIMARY KEY AUTOINCREMENT":"TEXT PRIMARY KEY",a=String.format("CREATE TABLE [{0}]({1} {3}, {2} BLOB)",Rn(e),gt.c,gt.d,r),i=new Array(0),o=Object(rt.c)(n);Tn.ExecuteSql(this._transaction,a,i,null,null,o)}_AddStoreVersionToVersionsTable(e,t){const n=String.format("INSERT OR REPLACE INTO {0} ({1}, {2}) VALUES (?, ?)",gt.k,gt.j,gt.l),r=[Rn(e),Rn(t)],a=Object(rt.c)(rt.b.OrgDb);Tn.ExecuteSql(this._transaction,n,r,null,null,a)}_AddStoreNameToObjectStoreMetadata(e,t,n){const r=String.format("INSERT INTO {0} VALUES(?,?,?)",gt.g),a=[e,"",""],i=Object(rt.c)(rt.b.OrgDb);Tn.ExecuteSql(this._transaction,r,a,null,null,i),this._objectStoreMetadata.add(e,t,n)}_RemoveStoreNameFromObjectStoreMetadata(e){const t=e.get_storeDbType(),n=String.format("DELETE FROM {0} WHERE {1} = ?",gt.g,gt.h),r=[e.get_objectStore()],a=Object(rt.c)(t);Tn.ExecuteSql(this._transaction,n,r,null,null,a),this._objectStoreMetadata.remove(e)}_RemoveUnderlyingObjectStoreTable(e,t){t=Object(rt.d)(t);const n=String.format("DROP TABLE IF EXISTS [{0}]",Rn(e)),r=new Array(0),a=Object(rt.c)(t);Tn.ExecuteSql(this._transaction,n,r,null,null,a)}_EnsureExistingTableDoesNotExist(e){if(this._objectStoreMetadata.exists(e)){const t=new In(de.constraintError,String.format("The object store {0} already exists.",e));throw Error.create(t.get_message(),t)}}_EnsureExistingTableExistsAndReturnMetadata(e){const t=this._objectStoreMetadata.findEntry(e);if(!t){const t=new In(de.constraintError,String.format("The object store {0} was not found.",Rn(e)));throw Error.create(t.get_message(),t)}return t}_CreateSqlIndexOnColumns(e,t,n,r){r=Object(rt.d)(r);const a=function(e){let t="(";for(let n=0;n<e.length;++n)n>0&&(t+=", "),t+=String.format("[{0}]",e[n].get_keyPath().get_path());return t+=")",t}(n),i=String.format("CREATE INDEX [{0}] ON [{1}] {2}",e,t.get_objectStore(),a),o=new Array(0),s=Object(rt.c)(r);Tn.ExecuteSql(this._transaction,i,o,null,null,s)}_AddIndexInformationToMetaTable(e,t,n){const r=String.format("INSERT INTO {0} VALUES(?,?,?)",gt.g),a=[e.get_objectStore(),t,n.get_keyPath().get_path()],i=Object(rt.c)(rt.b.OrgDb);Tn.ExecuteSql(this._transaction,r,a,null,null,i),e.addIndexedField(n.get_keyPath().get_path())}_AlterTableToAddColumnForIndex(e,t,n){n=Object(rt.d)(n);const r=String.format("ALTER TABLE [{0}] ADD COLUMN [{1}] {2}",e.get_objectStore(),t.get_keyPath().get_path(),function(e){let t="";if(!Object(s.a)(e)){switch(e){case 0:t="TEXT";break;case Qe.integer:t="INTEGER"}Object(Ct.a)(!Object(s.b)(t),"Unknown KeyPathDataType: "+e)}return t}(t.get_dataType())),a=new Array(0),i=Object(rt.c)(n);Tn.ExecuteSql(this._transaction,r,a,null,null,i)}}class xn{constructor(e){this._db=null,this._metadata=null,this._subscriptions=null,this._version=null,this._db=e,this._metadata=An.createEmpty(),this._subscriptions=new jt(this),this._version=""}get_version(){return this._version}get_objectStores(){return this._metadata.get_objectStores()}changeSchema(e,t,n,r){const a=this._metadata.clone();this._db.transaction(n=>{Mn(t,n,a),function(e,t){const n=String.format("INSERT OR REPLACE INTO {0} ({1}, {2}) VALUES(?, ?)",gt.k,gt.j,gt.l),r=[gt.i,t],a=Object(rt.c)(rt.b.OrgDb);Tn.ExecuteSql(e,n,r,null,null,a)}(n,e)},e=>{Object(ce.d)(O.a.sql,"ChangeSchema:Error - code "+e.code+": {0}",e.message),In.reportSqlError(e,r)},()=>{this._metadata=a.clone(),this._version=e,n&&n()})}transaction(e,t,n,r){this._TransactionInternal(t,n,r,!1)}readOnlyTransaction(e,t,n,r){this._TransactionInternal(t,n,r,!0)}_TransactionInternal(e,t,n,r){let a=null,i=Object(te.a)(this._db,this._db.transaction,"transaction");r&&(i=Object(te.a)(this._db,this._db.readTransaction,"readTransaction")),i(t=>{a=new Tn(t,this._metadata,this._subscriptions,r),e(a)},e=>{a&&a.get_aborted()&&n?(Object(ce.d)(O.a.sql,"TransactionInternal:SQL Error, transaction aborted - code "+e.code+": {0}",e.message),n(new wt(de.aborted,"transaction aborted."))):(Object(ce.d)(O.a.sql,"TransactionInternal:SQL Error - code "+e.code+": {0}",e.message),In.reportSqlError(e,n))},()=>{a&&a.publishNotificationEvents(),t&&t()})}wipe(e,t){const n=()=>{e&&e()},r=e=>{Object(ce.d)(O.a.sql,"Wipe:Error - code "+e.get_code()+": {0}",e.get_message()),t&&t(e)};M.a.getInstance().get_IsAndroid()||M.a.getInstance().get_IsWindows()?this._WipeMultipleTransactions(n,r):this.changeSchema("",Object(te.a)(this,this._InternalWipe,"InternalWipe"),n,r)}_WipeMultipleTransactions(e,t){const n=this.get_objectStores()[0],r=e=>{Object(s.a)(n)||e.removeObjectStore(n,this._metadata.findEntry(n).get_storeDbType())},a=this._metadata.clone();this._db.transaction(e=>{Mn(r,e,a)},e=>{Object(ce.d)(O.a.sql,"WipeMultipleTransactions:Error - code :"+e.code+":Message : {0}",e.message),In.reportSqlError(e,t)},()=>{this._metadata=a.clone(),this.get_objectStores().length>0?this._WipeMultipleTransactions(e,t):this.changeSchema("",Object(te.a)(this,this._InternalWipe,"InternalWipe"),e,t)})}initialize(e,t){Object(F.b)(e,"success"),this._db.transaction(e=>{!function(e){const t=String.format("CREATE TABLE IF NOT EXISTS {0}({1} TEXT, {2} TEXT, {3} TEXT)",gt.g,gt.h,gt.e,gt.f),n=new Array(0),r=Object(rt.c)(rt.b.OrgDb);Tn.ExecuteSql(e,t,n,null,null,r)}(e),function(e){const t=String.format("CREATE TABLE IF NOT EXISTS {0}({1} TEXT PRIMARY KEY, {2} TEXT)",gt.k,gt.j,gt.l),n=new Array(0),r=Object(rt.c)(rt.b.OrgDb);Tn.ExecuteSql(e,t,n,null,null,r)}(e),this._PopulateMetadataFromDatabase(e)},e=>{Object(ce.d)(O.a.sql,"Initialize:Error - code :"+e.code+":Message :"+e.message),In.reportSqlError(e,t)},()=>{e()})}_InternalWipe(e){const t=e,n=this.get_objectStores();for(let e=0;e<n.length;++e)t.removeObjectStore(n[e]);t.purgeObjectStoreMetadata(),t.purgeVersionMetadata()}_PopulateMetadataFromDatabase(e){let t=String.format("SELECT * FROM {0}",gt.g);const n=new Array(0),r=Object(rt.c)(rt.b.OrgDb);Tn.ExecuteSql(e,t,n,(r,a)=>{t=String.format("SELECT * FROM {0}",gt.k);const i=Object(rt.c)(rt.b.OrgDb);Tn.ExecuteSql(e,t,n,(e,t)=>{this._metadata=An.createFromResultSets(a,t),this._SetDatabaseVersion(t)},null,i)},null,r)}_SetDatabaseVersion(e){for(let t=0;t<e.rows.length;++t){const n=e.rows.item(t);if(n[gt.j]===gt.i){this._version=n[gt.l];break}}}}function Mn(e,t,n){let r=null;try{r=new Dn(t,n),e(r)}finally{}}class Fn extends vt{constructor(e,t){super(),this._windowDb=null,this._windowDb=e,this._store=t}openDatabase(e,t,n,r){let a,i;if(Object(F.b)(n,"success"),this._TryGetDatabase(e,t,Object(Z.a)(()=>a,e=>a=e),Object(Z.a)(()=>i,e=>i=e))){const e=new xn(a);e.initialize(()=>{n(e)},e=>{r&&r(e)})}else r&&r(new wt(0,i))}_TryGetDatabase(e,t,n,r){Object(F.c)(e,"name"),n.val=null,r.val="";try{n.val=this._windowDb.openDatabase(e,"","",1048576*t,null,Object(m.k)(this._store.getState()))}catch(e){r.val=e.message,n.val=null}return!!n.val}}function kn(e,t){let n=null;return!function(e){return e.get_supportsNativeSqlBridge()}(e)?!function(e){if(Object(T.b)()&&M.a.getInstance().get_isBrowserSafari())return!1;const t=M.a.getInstance().get_IsIOS()||M.a.getInstance().get_IsAndroid()||M.a.getInstance().get_isBrowserSafari();return!!e.get_indexedDbFactory()&&(!t||t&&!e.get_WebSqlDatabaseEnabled())}(e)?function(e){return e.get_WebSqlDatabaseEnabled()}(e)&&(n=function(e,t){const n=window.self;return new Fn(n,t)}(0,t)):n=new En(e.get_indexedDbFactory()):n=function(e,t){const n=x.a.get_Instance().get_sql(),r=window.self,a=new _t(n,r,t);return new Fn(a,t)}(0,t),n}const Ln="{0} -- {1} ERROR -- {2}",Bn="Local store is not available. Make sure the local store is installed.";class Un{constructor(e,t){this._databaseName=null,this._preferredDatabaseSizeMb=0,this._database=null,this._localStoreSchema=null,this._installDeferred=null,this._store=null,this._personalizationDatabases=[it.userPersonalizationStore,it.entityRecordStore],Object(F.c)(e,"databaseName"),Object(F.d)(t,"store"),this._store=t,this._databaseName=e.toLowerCase(),this._preferredDatabaseSizeMb=50,Object(N.e)("ClientBrowserStore_ClientBrowserStore",O.a.storage,this._databaseName),this._installDeferred=null}get_localStoreSchema(){return this._localStoreSchema}get_installPromise(){return this._installDeferred?this._installDeferred:null}get_isAvailable(){return!!this._database}get_dbFactory(){return kn(M.a.getInstance(),this._store)}install(e){if(Object(N.c)("ClientBrowserStore_Install_Start",O.a.storage,this._databaseName),Object(F.b)(e,"schema"),this._installDeferred)return this.get_installPromise();this._installDeferred=new i.a;const t=this.get_dbFactory();return t?this._InternalInstall(t,e,this._installDeferred):this._HandleInstallError("Unable to create Database Factory. User agent must support Web SQL Database Indexed Database or native SQL bridge.",this._installDeferred),this.get_installPromise()}upgrade(){return Object(N.e)("ClientBrowserStore_Upgrade_Start",O.a.storage,this._databaseName),this._installDeferred=new i.a,this._database.get_version()===this._localStoreSchema.get_version()?(this._HandleInstallSuccess(this._database,this._localStoreSchema,this._installDeferred),this.get_installPromise()):(this._RebuildDatabase(this._database,this._localStoreSchema,this._installDeferred),this.get_installPromise())}add(e,t,n,r){Object(N.d)("ClientBrowserStore_Add_Start",O.a.storage,this._databaseName),Object(F.d)(t,"data"),Object(F.c)(n,"storeName");const a=new i.a;if(this.get_isAvailable()){this.get_localStoreSchema().getSchemaFromObjectStoreName(n).get_idType()||Object(F.d)(e,"key"),this._TrackPendingOperation(a);let i=null;this._database.transaction(this._NormalizeObjectStoresNames([n]),a=>{this.createTransaction(a).add(e,t,n,r).done(e=>{i=e})},()=>{Object(N.d)("ClientBrowserStore_Add_End",O.a.storage,this._databaseName),a.resolve(i)},t=>{const r=A.a.fromLocalStoreError(-2147015599,Ln,this._databaseName,"Add",t.get_message());Object(N.b)("ClientBrowserStore_Add_End",O.a.storage,"Browser error code = "+t.get_code()+" : Error message = "+r.get_Message()+": storeName : "+n+" : Key :"+e.toString()),a.reject(r)})}else{const e=A.a.FromMessage(Ln,this._databaseName,"Add",Bn);Object(N.b)("ClientBrowserStore_Add_End",O.a.storage,e.get_Message()+": storeName : "+n),a.reject(e)}return a}addMultiple(e,t,n,r){Object(N.d)("ClientBrowserStore_AddMultiple_Start",O.a.storage,this._databaseName),Object(F.c)(n,"storeName"),Object(F.b)(t,"dataSet");const a=new i.a;if(this.get_isAvailable()){this._localStoreSchema.getSchemaFromObjectStoreName(n).get_idType()||Object(F.b)(e,"extractKey"),this._TrackPendingOperation(a);let i=null;this._database.transaction(this._NormalizeObjectStoresNames([n]),a=>{this.createTransaction(a).addMultiple(e,t,n,r).done(e=>{i=e})},()=>{Object(N.d)("ClientBrowserStore_AddMultiple_End",O.a.storage,this._databaseName),a.resolve(i)},t=>{const n=A.a.fromLocalStoreError(-2147015599,Ln,this._databaseName,"AddMultiple",t.get_message());Object(N.b)("ClientBrowserStore_AddMultiple_End",O.a.storage,"Browser error code = "+t.get_code()+" : Error message = "+n.get_Message()+" : extractKey = "+e.toString()),a.reject(n)})}else{const e=A.a.FromMessage(Ln,this._databaseName,"AddMultiple",Bn);Object(N.b)("ClientBrowserStore_AddMultiple_End",O.a.storage,e.get_Message()),a.reject(e)}return a}addMultipleByKey(e,t,n,r){Object(N.d)("ClientBrowserStore_AddMultipleByKey_Start",O.a.storage,this._databaseName),Object(F.c)(n,"storeName"),Object(F.b)(t,"dataSet");const a=new i.a;if(this.get_isAvailable()){this._TrackPendingOperation(a);let i=null;this._database.transaction(this._NormalizeObjectStoresNames([n]),a=>{this.createTransaction(a).addMultipleByKey(e,t,n,r).done(e=>{i=e})},()=>{Object(N.d)("ClientBrowserStore_AddMultipleByKey_End",O.a.storage,this._databaseName),a.resolve(i)},t=>{const n=A.a.fromLocalStoreError(-2147015599,Ln,this._databaseName,"AddMultiple",t.get_message());Object(N.b)("ClientBrowserStore_AddMultipleByKey_End",O.a.storage,"Browser error code = "+t.get_code()+" : Error message = "+n.get_Message()+" : keySet= "+e.join()),a.reject(n)})}else{const e=A.a.FromMessage(Ln,this._databaseName,"AddMultipleByKey",Bn);Object(N.b)("ClientBrowserStore_AddMultipleByKey_End",O.a.storage,e.get_Message()),a.reject(e)}return a}flush(e,t,n){Object(N.d)("ClientBrowserStore_Flush_Start",O.a.storage,this._databaseName),Object(F.f)(e,"key"),Object(F.c)(t,"storeName");const r=new i.a;if(this.get_isAvailable())this._TrackPendingOperation(r),this._database.transaction(this._NormalizeObjectStoresNames([t]),r=>{this.createTransaction(r).flush(e,t,n)},()=>{Object(N.d)("ClientBrowserStore_Flush_End",O.a.storage,this._databaseName),r.resolve()},t=>{const n=A.a.fromLocalStoreError(-2147015599,Ln,this._databaseName,"Flush",t.get_message());Object(N.b)("ClientBrowserStore_Flush_End",O.a.storage,"Browser error code = "+t.get_code()+" : Error message = "+n.get_Message()+" : Key :"+e.toString()),r.reject(n)});else{const e=A.a.FromMessage(Ln,this._databaseName,"Flush",Bn);Object(N.b)("ClientBrowserStore_Flush_End",O.a.storage,e.get_Message()),r.reject(e)}return r}flushAll(e,t){Object(N.d)("ClientBrowserStore_FlushAll_Start",O.a.storage,this._databaseName),Object(F.c)(e,"storeName");const n=new i.a;if(this.get_isAvailable())this._TrackPendingOperation(n),this._database.transaction(this._NormalizeObjectStoresNames([e]),n=>{this.createTransaction(n).flushAll(e,t)},()=>{Object(N.d)("ClientBrowserStore_FlushAll_End",O.a.storage,this._databaseName),n.resolve()},t=>{const r=A.a.fromLocalStoreError(-2147015599,Ln,this._databaseName,"FlushAll",t.get_message());Object(N.b)("ClientBrowserStore_FlushAll_End",O.a.storage,"Browser error code = "+t.get_code()+" : Error message = "+r.get_Message()+" : storeName :"+e),n.reject(r)});else{const e=A.a.FromMessage(Ln,this._databaseName,"FlushAll",Bn);Object(N.b)("ClientBrowserStore_FlushAll_End",O.a.storage,e.get_Message()),n.reject(e)}return n}retrieve(e,t,n){Object(N.d)("ClientBrowserStore_Retrieve_Start",O.a.storage,this._databaseName),Object(F.f)(e,"key"),Object(F.c)(t,"storeName");const r=new i.a;if(this.get_isAvailable()){this._TrackPendingOperation(r);let a=null;this._database.readOnlyTransaction(this._NormalizeObjectStoresNames([t]),r=>{this.createTransaction(r).retrieve(e,t,n).done(e=>{a=e})},()=>{Object(N.d)("ClientBrowserStore_Retrieve_End",O.a.storage,this._databaseName),r.resolve(a)},t=>{const n=A.a.fromLocalStoreError(-2147015599,Ln,this._databaseName,"Retrieve",t.get_message());Object(N.b)("ClientBrowserStore_Retrieve_End",O.a.storage,"Browser error code = "+t.get_code()+" : Error message = "+n.get_Message()+" : Key :"+e.toString()),r.reject(n)})}else{const n=A.a.FromMessage(Ln,this._databaseName,"Retrieve",Bn);Object(N.b)("ClientBrowserStore_Retrieve_End",O.a.storage,n.get_Message()+":databaseName = "+this._databaseName+":storeName = "+t+" :Key :"+e.toString()),r.reject(n)}return r}retrieveMultiple(e,t,n,r){Object(N.d)("ClientBrowserStore_RetrieveMultiple_Start",O.a.storage,this._databaseName),Object(F.c)(e,"keyPath"),"string"==typeof t?Object(F.c)(t,"keyValue"):Object(F.d)(t,"keyValue"),Object(F.c)(n,"storeName");const a=new ge.a(new pe.a(e),t),i=new be.a(a,null);return this._ExtractResults(this.retrieveMultipleByQuery(i,n,r))}retrieveAll(e,t){return this._ExtractResults(this.retrieveMultipleByQuery(new be.a(null,new Array(0)),e,t))}retrieveMultipleByQuery(e,t,n){Object(N.d)("ClientBrowserStore_RetrieveMultipleByQuery_Start",O.a.storage,this._databaseName),Object(F.d)(e,"query"),Object(F.c)(t,"storeName");const r=new i.a;if(this.get_isAvailable()){this._TrackPendingOperation(r);let a=new ft;this._database.readOnlyTransaction(this._NormalizeObjectStoresNames([t]),r=>{this.createTransaction(r).retrieveMultipleByQuery(e,t,n).done(e=>{a=e})},()=>{Object(N.d)("ClientBrowserStore_RetrieveMultipleByQuery_End",O.a.storage,this._databaseName),r.resolve(a)},t=>{const n=A.a.fromLocalStoreError(-2147015599,Ln,this._databaseName,"RetrieveMultipleByQuery",t.get_message());Object(N.b)("ClientBrowserStore_RetrieveMultipleByQuery_End",O.a.storage,"Browser error code = "+t.get_code()+" : Error message = "+n.get_Message()+" : query = "+e.toString()),r.reject(n)})}else{const e=A.a.FromMessage(Ln,this._databaseName,"RetrieveMultipleByQuery",Bn);Object(N.b)("ClientBrowserStore_RetrieveMultipleByQuery_End",O.a.storage,e.get_Message()),r.reject(e)}return r}transaction(e,t){return this._TransactionInternal(e,t,!1)}readOnlyTransaction(e,t){return this._TransactionInternal(e,t,!0)}_TransactionInternal(e,t,n){Object(N.d)("ClientBrowserStore_Transaction_Start",O.a.storage,this._databaseName);const r=new i.a;if(this.get_isAvailable()){this._TrackPendingOperation(r);let a=Object(te.a)(this._database,this._database.transaction,"transaction");n&&(a=Object(te.a)(this._database,this._database.readOnlyTransaction,"readOnlyTransaction"));let i=null;a(this._NormalizeObjectStoresNames(e),e=>{Object(N.d)("ClientBrowserStore_Transaction_Transaction",O.a.storage,this._databaseName),i=this.createTransaction(e),t(i)},()=>{Object(N.d)("ClientBrowserStore_Transaction_End",O.a.storage,this._databaseName),r.resolve(i.get_result())},e=>{const t=A.a.fromLocalStoreError(-2147015599,Ln,this._databaseName,"Transaction",e.get_message());Object(N.b)("ClientBrowserStore_Transaction_End",O.a.storage,"Browser error code = "+e.get_code()+" : Error message = "+t.get_Message()),r.reject(t)})}else{const e=A.a.FromMessage(Ln,this._databaseName,"Transaction",Bn);Object(N.b)("ClientBrowserStore_Transaction_End",O.a.storage,e.get_Message()),r.reject(e)}return r}createTransaction(e){return new bt(e,this._databaseName)}_InternalInstall(e,t,n){Object(N.e)("ClientBrowserStore_Install_InternalInstall_Start",O.a.storage,this._databaseName),e.openDatabase(this._databaseName,this._preferredDatabaseSizeMb,e=>{Object(N.e)("ClientBrowserStore_Install_InternalInstall_OpenDatabase",O.a.storage,this._databaseName),Object(s.b)(e.get_version())?this._RebuildDatabase(e,t,n):this._HandleInstallSuccess(e,t,n)},e=>{Object(N.e)("ClientBrowserStore_Install_InternalInstall_End",O.a.storage,String.format(Ln,this._databaseName,"InternalInstall",e.get_message())),this._HandleInstallError(e.get_message(),n)})}pullPersonalizations(){const e=new i.a;if(!this._database.get_objectStores().length)return e.resolve(null),e;const t=new Array(this._personalizationDatabases.length);for(let e=0;e<this._personalizationDatabases.length;e++)t[e]=this.pullPersonalizationsInternal(this._personalizationDatabases[e].toLowerCase());return Object(k.a)(t).then(t=>{const n={};for(let e=0;e<this._personalizationDatabases.length;e++)n[this._personalizationDatabases[e].toLowerCase()]=t[e];e.resolve(n)},t=>{e.reject(t)}),e}pullPersonalizationsInternal(e){const t=new i.a;return this.retrieveAll(e,null).then(e=>{const n=[],r=[];for(let t=0;t<e.length;t++)n.push(e[t].get_key()),r.push(e[t].get_value());const a=new et.a(n,r);t.resolve(a)},e=>{t.reject(e)}),t}pushPersonalizations(e){const t=new i.a;if(Object.keys(e.count).length<1)return t.resolve(!1),t;const n=new Array(this._personalizationDatabases.length);for(let t=0;t<this._personalizationDatabases.length;t++){const r=this._personalizationDatabases[t].toLowerCase();n[t]=this.addMultipleByKey(e[r].get_key(),e[r].get_value(),r,null)}return Object(k.a)(n).then(()=>{t.resolve(!0)},e=>{t.reject(e)}),t}_RebuildDatabase(e,t,n){Object(N.e)("ClientBrowserStore_Install_RebuildDatabase_Start",O.a.storage,this._databaseName),e.wipe(()=>{Object(N.e)("ClientBrowserStore_Install_RebuildDatabase_Wipe",O.a.storage,this._databaseName),this._BuildDatabase(e,t,n)},e=>{Object(N.b)("ClientBrowserStore_Install_RebuildDatabase_End",O.a.storage,String.format(Ln,this._databaseName,"RebuildDatabase",e.get_message())),this._HandleInstallError(e.get_message(),n)})}_BuildDatabase(e,t,n){Object(N.e)("ClientBrowserStore_Install_BuildDatabase_Start",O.a.storage,this._databaseName),e.changeSchema(t.get_version(),e=>{Object(N.e)("ClientBrowserStore_Install_BuildDatabase_ChangeSchema",O.a.storage,this._databaseName);for(let n=0;n<t.get_objectStores().length;n++){const r=t.get_objectStores()[n],a=r.get_idType()===Xe.autoIncrementedInteger;e.createObjectStore(r.get_name(),r.get_version(),a,r.get_storeDbType());for(let t=0;t<r.get_indexes().length;++t)e.createIndex(r.get_name()+"_"+r.get_indexes()[t].get_name(),r.get_name(),r.get_indexes()[t].get_fields(),r.get_storeDbType())}},()=>{Object(N.e)("ClientBrowserStore_Install_BuildDatabase_End",O.a.storage,this._databaseName),this._HandleInstallSuccess(e,t,n)},e=>{Object(N.b)("ClientBrowserStore_Install_BuildDatabase_End",O.a.storage,String.format(Ln,this._databaseName,"BuildDatabase",e.get_message())),this._HandleInstallError(e.get_message(),n)})}_HandleInstallSuccess(e,t,n){Object(N.e)("ClientBrowserStore_HandleInstallSuccess_Start",O.a.storage,this._databaseName),this._database=e,this._localStoreSchema=t,n.resolve(this._databaseName),Object(N.e)("ClientBrowserStore_HandleInstallSuccess_End",O.a.storage,":DatabaseName = "+this._databaseName+" :database.Version = "+this._database.get_version()+":localStoreSchema.Version = "+this._localStoreSchema.get_version())}_HandleInstallError(e,t){const n=A.a.FromMessage(Ln,this._databaseName,"Install",e);Object(N.e)("ClientBrowserStore_Install_End",O.a.storage,n.get_Message()),this._Cleanup(),t.reject(n)}_NormalizeObjectStoresNames(e){const t=e.length,n=new Array(t);for(let r=0;r<t;r++)n[r]=e[r].toLowerCase();return n}_TrackPendingOperation(e){window.__UCCacheModeEnabled&&ee.a.protectHighPriorityBrowserAsyncWork(e)}_Cleanup(){Object(N.e)("ClientBrowserStore_Cleanup",O.a.storage,"cleaning up database and localStoreSchema"),this._database=null,this._localStoreSchema=null}_ExtractResults(e){const t=new i.a;return e.then(e=>{t.resolve(e.get_results())},e=>{t.reject(e)}),t}}class Vn{constructor(e,t,n,r,a,i){if(this._query=null,this._indexId=0,this._logicalName=null,this._totalRecordCount=0,this._clientRetrieveOptions=null,this._entityIndex=null,"string"==typeof e)this._query=e,this._indexId=t,this._logicalName=n,this._totalRecordCount=r,this._clientRetrieveOptions=a,this._entityIndex=i;else{const t=e;t.get_query()instanceof Be.a&&(this._query=t.get_query().get_key(),this._indexId=0,this._logicalName=t.get_query().get_EntityLogicalName(),this.update(t))}}get_indexId(){return this._indexId}get_logicalName(){return this._logicalName}get_totalRecordCount(){return this._totalRecordCount}get_clientRetrieveOptions(){return this._clientRetrieveOptions}get_entityIndex(){return this._entityIndex}get_moreRecords(){return this._totalRecordCount>this._entityIndex.length}getObjectData(){return{indexid:this._indexId,[Vn.queryPath]:this._query,logicalname:this._logicalName,totalrecordcount:this._totalRecordCount,clientretrieveoptions:!Object(s.a)(this._clientRetrieveOptions)&&this._clientRetrieveOptions.getObjectData(),entityindex:this._entityIndex.map(e=>e.getObjectData())}}update(e){this._totalRecordCount=e.get_totalRecordCount(),Object(s.a)(this._clientRetrieveOptions)?this._clientRetrieveOptions=e.get_clientRetrieveOptions():this._clientRetrieveOptions.update(e.get_clientRetrieveOptions()),this._entityIndex=e.get_entities().map(e=>e.get_identifier().Id)}static createFromObjectData(e,t){const n="clientretrieveoptions"in t?V.a.createFromObjectData(t.clientretrieveoptions):null;return new Vn(t.query,e,t.logicalname,t.totalrecordcount,n,t.entityindex.map(e=>R.a.createFromObjectData(e)))}}Vn.queryPath="query";class zn{approximateCount(e,t){e(0)}next(e,t,n,r){n(new Hn(!1),[])}skip(e,t,n){t()}dispose(){}}class qn{constructor(e){this._name=null,this._name=e}get_name(){return this._name}getItem(e,t,n){Object(N.d)(this._name+" :NoDb_GetItem",O.a.storage,JSON.stringify(e)),t(null)}deleteItem(e,t,n){Object(N.d)(this._name+" :NoDb_DeleteItem",O.a.storage,JSON.stringify(e)),t()}clear(e,t){Object(N.d)(this._name+" :NoDb_Clear",O.a.storage,null),e()}putItem(e,t,n,r){Object(N.d)(this._name+" :NoDb_PutItem",O.a.storage,e+": "+t),n(e)}objectQuery(e,t,n){Object(N.d)(this._name+" :NoDb_ObjectQuery",O.a.storage,JSON.stringify(e)),t(new zn)}}class Hn{constructor(e){this._isReadonly=!1,this._isReadonly=e}get_isReadOnly(){return this._isReadonly}openObjectStore(e){return new qn(e)}}class Wn{constructor(){this._databaseName=null,this._schema=null}get_isAvailable(){return!0}get_localStoreSchema(){return this._schema}install(e){const t=new i.a;return this._schema=e,t.resolve(this._databaseName),t}upgrade(){const e=new i.a;return e.resolve(this._databaseName),e}pullPersonalizations(){const e=new i.a;return e.resolve(null),e}pushPersonalizations(e){const t=new i.a;return t.resolve(!0),t}add(e,t,n,r){const a=new i.a;return a.resolve(new dt(e).toKeyValue()),a}addMultiple(e,t,n,r){const a=new i.a;return a.resolve(t.map(t=>e(t))),a}flush(e,t,n){const r=new i.a;return r.resolve(new dt(e).toKeyValue()),r}flushAll(e,t){const n=new i.a;return n.resolve(),n}retrieve(e,t,n){const r=new i.a;return r.resolve(null),r}retrieveMultiple(e,t,n,r){const a=new i.a;return a.resolve([]),a}retrieveMultipleByQuery(e,t,n){const r=new i.a;return r.resolve(new ft([])),r}transaction(e,t){const n=new i.a;return t(new bt(new Hn(!0),this._databaseName)),n.resolve(null),n}readOnlyTransaction(e,t){const n=new i.a;return t(new bt(new Hn(!0),this._databaseName)),n.resolve(null),n}}var Gn=n("IqkD"),Kn=n("B/QL"),Qn=n("3/02"),Xn=n("Lyxw");class Yn{constructor(e,t){this._serverUri=null,this._offlineDataStore=null,this._batchedCallbackRunner=null,this._localStore=null,this._sessionStateStore=null,this._isAvailable=!1,this._wasInitializedWithLocalStore=!1,this._purgingDeferred=null,this._addingNavigationDataDeferred=null,this._retrieveAttributeMetadataPromiseCache=null,this._parentDataSource=null,this._metadataTypeToKeys=null,this._payloadKeyToMetadataTypeMap=null,Object(N.e)("ClientBrowserStore_ClientBrowserDataSource",O.a.storage,":serverUri:"+e),this._serverUri=e,this._isAvailable=!1,this._localStore=new Un(this._serverUri,t.get_Store()),this._sessionStateStore=this._localStore,this._batchedCallbackRunner=new ne("ClientBrowserDataSource.BatchedCallbackRunner",-2),this._retrieveAttributeMetadataPromiseCache=new ke.a,this._parentDataSource=t,this._metadataTypeToKeys={},this._metadataTypeToKeys.form=[new Ue(D.a.formSelector,"Id","FormSelectors"),new Ue(D.a.form,"FormId","Forms")],this._metadataTypeToKeys.savedview=[new Ue(D.a.viewSelector,"ViewId","ViewSelectors"),new Ue(D.a.savedView,"ViewId","Views")],this._metadataTypeToKeys.workspace=[new Ue(D.a.dashboardSelector,"Id","DashboardSelectors"),new Ue(D.a.form,"FormId","Forms"),new Ue(D.a.workspace,"FormId","Dashboards"),new Ue(D.a.interactionCentricWorkspace,"FormId","Dashboards")],this._metadataTypeToKeys.systemworkspace=[new Ue(D.a.dashboardSelector,"Id","DashboardSelectors"),new Ue(D.a.form,"FormId","Forms"),new Ue(D.a.workspace,"FormId","Dashboards"),new Ue(D.a.interactionCentricWorkspace,"FormId","Dashboards")],this._metadataTypeToKeys.userworkspace=[new Ue(D.a.dashboardSelector,"Id","DashboardSelectors"),new Ue(D.a.form,"FormId","Forms"),new Ue(D.a.workspace,"FormId","Dashboards"),new Ue(D.a.interactionCentricWorkspace,"FormId","Dashboards")],this._metadataTypeToKeys.savedvisualization=[new Ue(D.a.visualizationSelector,"Id","VisualizationSelectors"),new Ue(D.a.savedQueryVisualization,"Id","SavedQueryVisualizations")],this._payloadKeyToMetadataTypeMap={},this._payloadKeyToMetadataTypeMap.AppModuleSelectors="appmoduleselector",this._payloadKeyToMetadataTypeMap.ViewSelectors="viewselector",this._payloadKeyToMetadataTypeMap.FormSelectors="formselector",this._payloadKeyToMetadataTypeMap.DashboardSelectors="dashboardselector",this._payloadKeyToMetadataTypeMap.VisualizationSelectors="visualizationselector",this._payloadKeyToMetadataTypeMap.BPFSelectors="bpfselector"}get_isAvailable(){return this._isAvailable&&this.get_localStore().get_isAvailable()}set_isAvailable(e){return this._isAvailable=e,e}get_IsAvailableOffline(){return this.get_isAvailable()&&!(this.get_localStore instanceof Wn)}getClientMetadata(e){const t=new i.a;let n,r=null;const a=this._GetLegacyMetadataTypeForQuery(e.MetadataType,e.MetadataSubtype,Object(Z.a)(()=>n,e=>n=e));if(e.MetadataId&&(r=e.MetadataId.toString()),"entity"===e.MetadataType){const n=e.MetadataSubtype.replace(/\\\"/g,'"'),r=JSON.parse(n),a=[];for(const e in r){const t={key:e,value:r[e]};this._AddSingleEntityRetrievalPromise(a,t.key,t.value)}Object(k.a)(a).then(e=>{const n={};n.Entities=e,t.resolve(n)},e=>{Object(N.e)("ClientBrowserDataSource:GetClientMetadata:Entity_Failure",O.a.storage,e.get_Message()),t.reject(e)})}else if("savedview"===e.MetadataType||"form"===e.MetadataType||"workspace"===e.MetadataType||"systemworkspace"===e.MetadataType||"userworkspace"===e.MetadataType||"savedvisualization"===e.MetadataType)this._RetrieveSelectableMetadata(e,t);else if("dialog"===e.MetadataType||"taskbasedflow"===e.MetadataType)this._RetrieveMetadataWithHardDependency(e,t);else if((a===D.a.resourceString||a===D.a.label)&&e.MetadataNames&&e.MetadataNames.length>0){e.MetadataNames=this._RemoveDuplicates(e.MetadataNames);const n=[];for(const t of e.MetadataNames)if(a===D.a.label){const e=t.split(":");e&&2===e.length?n.push(this._CreateLocalStoreId(null,a,e[0],e[1])):Object(N.e)("ClientBrowserDataSource:GetClientMetadata:InvalidLabelName",O.a.storage,t)}else n.push(this._CreateLocalStoreId(null,a,null,t));const r=a===D.a.resourceString;0===n.length?t.resolve(this._WrapInOData(a,[],null)):this._RetrieveMultipleApplicationMetadataByKeys(pe.a.get_id(),n,!0).then(i=>{if(r&&i.length!==n.length){const r=this._GetMissingResourceStringKeys(e,i),o=A.a.fromLocalStoreError(-2147093987,"GetClientMetadata: Not able to find {0} keys out of {1} of type {2}. Missing keys: {3}.",n.length-i.length,n.length,D.a[a],r);Object(N.e)("ClientBrowserDataSource:GetClientMetadata:MissingResourceStrings",O.a.storage,o.get_Message());const s=this._parentDataSource.get_Store().getState();Object(u.k)(s)||t.reject(o)}t.resolve(this._WrapInOData(a,i,null))},e=>{t.reject(e)})}else if((a===D.a.optionSet||a===D.a.webResource||a===D.a.webResourceDescriptor||a===D.a.complexControl)&&e.MetadataNames&&e.MetadataNames.length>0){const n=[];for(const t of e.MetadataNames)r=this._CreateLocalStoreId(e.EntityLogicalName,a,null,t),n.push(this.retrieveApplicationMetadata(r,null));Object(k.a)(n).then(n=>{n?t.resolve(this._WrapInOData(a,n,e.MetadataNames)):t.reject(A.a.fromLocalStoreError(-2147093987,"GetClientMetadata: Not able to find some of the keys for type '{0}'",D.a[a]))},e=>{t.reject(e)})}else if(a===D.a.command&&e.MetadataNames&&e.MetadataNames.length>0)r=this._CreateLocalStoreId(e.EntityLogicalName,a,null,e.MetadataNames[0]),this.retrieveApplicationMetadata(r,null).then(e=>{if(e){const n=[e];t.resolve(this._WrapInOData(a,n,null))}else t.reject(A.a.fromLocalStoreError(-2147093987,"GetClientMetadata: Not able to find the key '{0}' for type '{1}'",r,D.a[a]))},e=>{t.reject(e)});else if(a!==D.a.appModule||Object(s.b)(r))if(a===D.a.appModuleOfflineMetadata)r=this._CreateLocalStoreId(null,a,null,null,0,null),this.retrieveApplicationMetadata(r,null).then(e=>{if(e){const n=[e];t.resolve(this._WrapInOData(a,n,null))}else t.resolve(null)},e=>{t.reject(e)});else if(!Object(s.b)(r)||a!==D.a.resourceString&&e.MetadataNames&&e.MetadataNames.length>0||a===D.a.taskBasedFlowGlobalMenu||a===D.a.quickCreateMenu||a===D.a.searchConfiguration||a===D.a.siteMap){const n=!e.AppId||e.AppId.equals(R.a.get_empty())?null:e.AppId.toString();r=this._CreateLocalStoreId(e.EntityLogicalName,a,r,e.MetadataNames[0],0,n),this.retrieveApplicationMetadata(r,null).then(e=>{if(e){const n=[e];t.resolve(this._WrapInOData(a,n,null))}else t.reject(A.a.fromLocalStoreError(-2147093987,"GetClientMetadata: Not able to find the key '{0}' for type '{1}'",r,D.a[a]))},e=>{t.reject(e)})}else if(a===D.a.isActivityFlags)r=this._CreateLocalStoreId(null,a,null,"entitydefinitionstype"),this.retrieveApplicationMetadata(r,null).then(e=>{if(e){const n=[e];t.resolve(this._WrapInOData(a,n,null))}else t.reject(A.a.fromLocalStoreError(-2147093987,"GetClientMetadata: Not able to find the key '{0}' for type '{1}'",r,D.a[a]))},e=>{t.reject(e)});else if(a===D.a.viewSelector){const i=!e.AppId||e.AppId.equals(R.a.get_empty())?e.MetadataId?e.MetadataId.toString():null:e.AppId.toString();r=this._CreateLocalStoreId(e.EntityLogicalName,D.a.viewSelector,null,null,n,i),this.retrieveApplicationMetadata(r,null).then(e=>{if(e){const n=[e];t.resolve(this._WrapInOData(a,n,null))}else t.reject(A.a.fromLocalStoreError(-2147093987,"GetClientMetadata: Not able to find the key '{0}' for type '{1}'",r,D.a[a]))},e=>{t.reject(e)})}else if(a===D.a.homePageConfiguration)r=this._CreateLocalStoreId(e.EntityLogicalName,D.a.homePageConfiguration,null,null,0,null),this.retrieveApplicationMetadata(r,null).then(e=>{if(Object(s.a)(e))t.reject(A.a.fromLocalStoreError(-2147093987,"GetClientMetadata: Not able to find the key '{0}' for type '{1}'",r,D.a[a]));else{const n=[e];t.resolve(this._WrapInOData(a,n,null))}},e=>{t.reject(e)});else{const i=new J.a(a,ie.a.Desktop,e.EntityLogicalName,0,e.GetDefault,r,n,null);this.retrieveMultipleApplicationMetadata(i,null).then(e=>{e.length?t.resolve(this._WrapInOData(a,e,null)):t.reject(A.a.fromLocalStoreError(-2147093987,"GetClientMetadata: Not able to find the key '{0}' for type '{1}'",r,D.a[a]))},e=>{t.reject(e)})}else{const n=!e.AppId||e.AppId.equals(R.a.get_empty())?e.MetadataId.toString():e.AppId.toString();r=this._CreateLocalStoreId(e.EntityLogicalName,a,r,e.MetadataNames[0],0,n),this.retrieveApplicationMetadata(r,null).then(e=>{if(e){const n=[e];t.resolve(this._WrapInOData(a,n,null))}else t.reject(A.a.fromLocalStoreError(-2147093987,"GetClientMetadata: Not able to find the key '{0}' for type '{1}'",r,D.a[a]))},e=>{t.reject(e)})}return t}_GetMissingResourceStringKeys(e,t){const n=t.filter(e=>e).map(e=>e.getDescriptor().Key);let r="";for(const t of e.MetadataNames){let e=!1;for(const r of n)if(t===r){e=!0;break}e||(r=Object(s.b)(r)?t:r+", "+t)}return r}_RemoveDuplicates(e){e.sort();const t=[];let n="";for(const r of e)r!==n&&(n=r,t.push(r));return t}getIsActivityFlags(){const e=new i.a,t=new Fe.a("isactivityflags",null,null,null,null,!1,H.a.Offline,null,null,null);return this.getClientMetadata(t).then(t=>{e.resolve(t)},t=>{Object(N.e)("ClientBrowserStore_ClientBrowserDataSource:GetIsActivityFlags",O.a.storage,t.get_Message()),e.resolve(null)}),e}getInitialEntities(){const e=new i.a,t=new Fe.a("entity",'{\\"activityparty\\":null}',null,null,null,!1,H.a.Offline,null,null,null);return this.getClientMetadata(t).then(t=>{e.resolve(t)},t=>{Object(N.e)("ClientBrowserStore_ClientBrowserDataSource:GetInitialEntities",O.a.storage,t.get_Message()),e.resolve(null)}),e}_AddSingleEntityRetrievalPromise(e,t,n){const r=new i.a;e.push(r),this.retrieveEntityMetadata(t,null).then(e=>{const a=e.getODataObject();let i=null;if(!Object(s.a)(n)){const e=a.AttributeNames,t=n;e.indexOf("statecode")>=0&&t.indexOf("statecode")<0&&t.push("statecode"),e.indexOf("statuscode")>=0&&t.indexOf("statuscode")<0&&t.push("statuscode"),i=t}try{Object(s.a)(i)||i.length>0?this.retrieveMultipleAttributeMetadata(new $.a(t,i),null).then(e=>{const i=[],o={};let s=!1;for(let t=0;t<e.length;t++)i.push(e[t].getODataObject()),o[e[t].get_logicalName()]=!0;n||(n=a.AttributeNames||new Array(0));const c=n.filter(e=>!o[e]);c.length>0&&(s=!0),s?r.reject(A.a.fromLocalStoreError(-2147093987,"Local store does not contain all requested attributes for {0}. Missing attributes are: {1}.",t,c.toString())):(a.Attributes=i,r.resolve(a))},e=>{r.reject(e)}):r.resolve(a)}catch(e){r.reject(A.a.fromGenericError(e))}},e=>{r.reject(e)})}_RetrieveMetadataWithHardDependency(e,t){if(!Object(s.a)(e.MetadataNames)&&e.MetadataNames.length>0){let n;const r=this._GetLegacyMetadataTypeForQuery(e.MetadataType,e.MetadataSubtype,Object(Z.a)(()=>n,e=>n=e)),a=[],o=[],s=[],c=e.MetadataNames;for(let e=0;e<c.length;++e){const n=new i.a,l=this._CreateLocalStoreId(null,r,null,c[e]);this.retrieveApplicationMetadata(l,null).then(e=>{if(e){o.push(e);const a=e.getDescriptor().FormId,i=this._CreateLocalStoreId(null,D.a.form,a,null);this.retrieveApplicationMetadata(i,null).then(e=>{e?(s.push(e),n.resolve()):n.reject(A.a.fromLocalStoreError(-2147093987,"GetClientMetadata: Not able to find the key '{0}' for type '{1}'",i,D.a[r]))},e=>{t.reject(e)})}else t.reject(A.a.fromLocalStoreError(-2147093987,"GetClientMetadata: Not able to find the key '{0}' for type '{1}'",l,D.a[r]))},e=>{t.reject(e)}),a.push(n)}Object(k.a)(a).then(e=>{const n=this._WrapInOData(r,o,null);n.Forms=this._WrapInOData(D.a.form,s,null).Forms,t.resolve(n)},e=>{t.reject(e)})}else t.reject(A.a.fromLocalStoreError(-2147093987,"Specified dialog wasn't found in the local store"))}_RetrieveNonSelectorKeychainMetadata(e,t,n){Object(s.a)(n)&&(n=[]);const r=this._GetLegacySubtype(e.MetadataType,e.MetadataSubtype);for(let a=0;a<t.length;++a){const i=t[a].get_metadataType(),o=e.MetadataId?new J.a(i,ie.a.Desktop,e.EntityLogicalName,0,!1,e.MetadataId.toString()):new J.a(i,ie.a.Desktop,e.EntityLogicalName,0,!1,null,r);n.push(this.retrieveMultipleApplicationMetadata(o,null))}return n}_GetLegacySubtype(e,t){let n;switch(e){case"form":case"formselector":case"dashboardselector":n=this._GetLegacyFormSubtype(t);break;case"viewselector":case"savedview":case"userview":n=this._GetLegacyViewSubtype(t);break;case"workspace":case"systemworkspace":case"userworkspace":n=se.a.dashboard;break;default:n=0}return n}_RetrieveKeychainMetadata(e,t){let n=[];const r=this._GetLegacySubtype(e.MetadataType,e.MetadataSubtype),a=t[0];if(Object(s.a)(e.EntityLogicalName)&&"workspace"!==e.MetadataType&&"systemworkspace"!==e.MetadataType&&"userworkspace"!==e.MetadataType){const e=new J.a(a.get_metadataType(),ie.a.Desktop,null,0,!1,null,r),t=new i.a;this.retrieveMultipleApplicationMetadata(e,null).then(e=>{!Object(s.a)(e)&&e.length>0?t.resolve(e):t.reject(A.a.fromLocalStoreError(-2147093987,"The selector with the specified parameters wasn't found in the local store."))},e=>{t.reject(e)}),n.push(t)}else{const t=this._CreateLocalStoreId(e.EntityLogicalName,a.get_metadataType(),null,null,r,!e.AppId||e.AppId.equals(R.a.get_empty())?null:e.AppId.toString()),o=new i.a;this.retrieveApplicationMetadata(t,null).then(e=>{o.resolve([e])},e=>{o.reject(e)}),n.push(o)}return n=this._RetrieveNonSelectorKeychainMetadata(e,t.slice(1,t.length),n),Object(k.a)(n)}_RetrieveSelectableMetadata(e,t){const n=this._metadataTypeToKeys[e.MetadataType];if(!Object(s.a)(e.MetadataId)||e.MetadataNames&&e.MetadataNames.length)if(e.DependencyDepth===H.a.OnDemandWithContext)this._RetrieveKeychainMetadata(e,n).then(e=>{this._BuildPayload(t,e,n)},e=>{t.reject(e)});else{const r=n.slice(1,n.length),a=this._RetrieveNonSelectorKeychainMetadata(e,r);Object(k.a)(a).then(e=>{this._BuildPayload(t,e,r)},e=>{t.reject(e)})}else Object(s.a)(e.GetDefault)||!e.GetDefault?t.reject(A.a.fromLocalStoreError(-2147093987,"A query with empty MetadataId and non-true GetDefault parameters is considered invalid.")):Object(s.a)(e.EntityLogicalName)&&"workspace"!==e.MetadataType&&"systemworkspace"!==e.MetadataType&&"userworkspace"!==e.MetadataType?t.reject(A.a.fromLocalStoreError(-2147093987,"This query requests defaults and/or selectors, but does not specify the context. This query is considered invalid.")):this._RetrieveKeychainMetadata(e,n).then(r=>{if(Object(s.a)(r)||r.length<2)return void t.reject(A.a.fromLocalStoreError(-2147093987,"The local store does not contain metadata fragments or selectors for the specified query."));const a=r[0][0],i=n[0],o=this._FindDefaultSelectorItem(a);if(Object(s.a)(o))return void t.reject(A.a.fromLocalStoreError(-2147093987,"The default selector item cannot be found."));const c={};for(let e=1;e<r.length;++e){const t=r[e],a=n[e];for(let e=0;e<t.length;e++){const n=t[e];if(o[i.get_uniqueKey()]===n.getDescriptor()[a.get_uniqueKey()]){c[a.get_payloadKey()]=this._WrapInOData(a.get_metadataType(),[n],null)[a.get_payloadKey()];break}}}e.DependencyDepth===H.a.OnDemandWithContext&&(c[i.get_payloadKey()]=this._WrapInOData(i.get_metadataType(),[a],null)[i.get_payloadKey()]),t.resolve(c)},e=>{t.reject(e)})}_BuildPayload(e,t,n){if(Object(s.a)(t)||!t.length)return void e.reject(A.a.fromLocalStoreError(-2147093987,"The local store does not contain metadata fragments or selectors for the specified query."));const r={};for(let e=0;e<t.length;++e){const a=t[e],i=n[e];for(let e=0;e<a.length;e++){const t=a[e];r[i.get_payloadKey()]=this._WrapInOData(i.get_metadataType(),[t],null)[i.get_payloadKey()]}}for(let t=0;t<n.length;++t){const a=n[t];if(!(a.get_payloadKey()in r)||!r[a.get_payloadKey()].length)return void e.reject(A.a.fromLocalStoreError(-2147093987,"The local store does not contain {0} requested metadata.",a.get_payloadKey()))}e.resolve(r)}_FindDefaultSelectorItem(e){const t=e.getDescriptor().SelectorItems;if(!Object(s.a)(t)&&t.length>0){for(let e=0;e<t.length;e++){const n=t[e];if(n.IsDefault)return n}return t[0]}return null}filterClientMetadata(e){const t=new i.a;return t.resolve(e),t}_CreateLocalStoreId(e,t,n,r,a,i){let o="";switch(t){case D.a.overallMetadataVersion:o=String.format("{0}",Yn.applicationMetadataVersionStampKey);break;case D.a.quickCreateMenu:o=String.format("{0}_quickcreatemenu_{1}",t,i);break;case D.a.searchConfiguration:o=String.format("{0}_searchconfiguration",t);break;case D.a.taskBasedFlowGlobalMenu:o=String.format("{0}_taskbasedflowglobalmenu",t);break;case D.a.siteMap:o=String.format("{0}_sitemap_{1}",t,i);break;case D.a.appModule:o=String.format("{0}_appmodules_{1}",t,i);break;case D.a.appModuleOfflineMetadata:o=String.format("{0}_appmoduleofflinemetadata",t);break;case D.a.taskBasedFlow:case D.a.customControl:case D.a.resourceString:case D.a.complexControl:o=String.format("{0}_{1}",t,r);break;case D.a.dialog:o=String.format("{0}_{1}",t,r.toLowerCase());break;case D.a.label:o=String.format("{0}_{1}_{2}",t,n,r);break;case D.a.homePageConfiguration:o=String.format("{0}_{1}",t,e);break;case D.a.optionSet:o=String.format("{0}_{1}",t,Object(s.b)(n)?r:n);break;case D.a.appModuleSelector:o=String.format("{0}_{1}",t,a);break;case D.a.viewSelector:case D.a.formSelector:case D.a.dashboardSelector:case D.a.visualizationSelector:o=String.format("{0}_{1}_{2}_{3}",t,e,a,i);break;case D.a.bpfSelector:o=String.format("{0}_{1}_{2}",t,e,i);break;case D.a.command:o=String.format("{0}_{1}_{2}",t,r,e);break;case D.a.isActivityFlags:case D.a.webResource:case D.a.webResourceDescriptor:o=String.format("{0}_{1}",t,r);break;case D.a.businessProcessFlow:case D.a.form:case D.a.savedQueryVisualization:case D.a.displayString:default:o=String.format("{0}_{1}",t,n)}return o}_WrapInOData(e,t,n){const r=t.filter(e=>e).map(e=>e.getDescriptor()),a=r,i={};switch(e){case D.a.userView:case D.a.savedView:return i.Views=a,i;case D.a.form:return i.Forms=a,i;case D.a.appModuleSelector:return i.AppModuleSelector=a,i;case D.a.viewSelector:return i.ViewSelectors=a,i;case D.a.dashboardSelector:return i.DashboardSelectors=a,i;case D.a.visualizationSelector:return i.VisualizationSelectors=a,i;case D.a.interactionCentricWorkspace:case D.a.workspace:return i.Dashboards=a,i;case D.a.quickCreateMenu:case D.a.taskBasedFlowGlobalMenu:case D.a.searchConfiguration:case D.a.isActivityFlags:return r[0];case D.a.formSelector:return i.FormSelectors=a,i;case D.a.bpfSelector:i.BPFSelectors=a;case D.a.label:return i.Labels=a,i;case D.a.resourceString:const e=[];return e.push(a),i.ResourceStrings=e,i;case D.a.displayString:const t=[];return t.push(a),i.DisplayStrings=t,i;case D.a.webResourceDescriptor:return i.WebResources=a,i;case D.a.webResource:return i.WebResourcesContent=a,i;case D.a.customControl:return i.CustomControls=a,i;case D.a.savedQueryVisualization:return i.SavedQueryVisualizations=a,i;case D.a.optionSet:return i.OptionSets=a,i;case D.a.homePageConfiguration:return i.CustomControlConfigurations=a,i;case D.a.businessProcessFlow:return i.BusinessProcessFlowMetadata=a,i;case D.a.dialog:return i.Dialogs=a,i;case D.a.taskBasedFlow:return i.TaskBasedFlows=a,i;case D.a.userQueryVisualization:return i.UserQueryVisualizations=a,i;case D.a.command:return i.Ribbons=a,i;case D.a.siteMap:return i.Sitemap=a,i;case D.a.appModule:return i.AppModulePublished=a,i;case D.a.appModuleOfflineMetadata:return i.AppModules=a,i;case D.a.overallMetadataVersion:return i.MetadataVersion=a,i;case D.a.complexControl:return i.ComplexControls=a,i;default:return null}}StoreApplicationMetadata(e){const t=new i.a,n=[],r=[],a=[];let o=null,c=-1,l=-1;try{e.EntityMetadataVersionStamp&&(c=e.EntityMetadataVersionStamp[0]),e.MetadataVersion&&(l=e.MetadataVersion[0]);for(const t in e){const i={key:t,value:e[t]};let u,d,p,f=null;switch(i.key){case"Forms":for(const e of i.value)d=this._GetLegacyMetadataTypeForQuery("form",oe.a[e.FormType].toLowerCase(),Object(Z.a)(()=>u,e=>u=e)),f=this._CreateLocalStoreId(null,d,e.Id,null),n.push(this._ConvertMetadataToApplicationMetadata(e,d,u,e.EntityLogicalName,f,e.IsDefault,e.Id));break;case"Dashboards":d=this._GetLegacyMetadataTypeForQuery("workspace",null,Object(Z.a)(()=>u,e=>u=e));for(const e of i.value)f=this._CreateLocalStoreId(null,d,e.FormId,null),n.push(this._ConvertMetadataToApplicationMetadata(e,d,u,null,f,!1,e.FormId));break;case"Views":for(const e of i.value)d=e.IsUserView?this._GetLegacyMetadataTypeForQuery("userview",re[e.QueryType].toUpperCase(),Object(Z.a)(()=>u,e=>u=e)):this._GetLegacyMetadataTypeForQuery("savedview",re[e.QueryType].toUpperCase(),Object(Z.a)(()=>u,e=>u=e)),f=this._CreateLocalStoreId(null,d,e.ViewId,null),n.push(this._ConvertMetadataToApplicationMetadata(e,d,u,e.EntityLogicalName,f,e.IsDefault,e.ViewId));break;case"Entities":const e=[],t=Object(Xn.f)(this._parentDataSource.get_Store().getState(),Qn.qe)&&!Object(Xn.f)(this._parentDataSource.get_Store().getState(),Qn.je);for(const n of i.value){const i=z.a.createFromOData(n);e.push(i.get_logicalName()),t||(n.VersionNumber=c,n.OverallVersionNumber=l,r.push(i),n.Attributes&&a.push(...this._ConvertToAttributeMetadata(n.Attributes)))}Object(N.e)("ClientBrowserStore_StoreApplicationMetadata.Entities",O.a.storage,"OnlyUseSyncedMetadata: "+t+", "+(t?"skip storing":"store")+" entity and attribute metadata outside of sync, this is by design and not an error. Entities: "+e.toString());break;case"AppModuleSelectors":case"ViewSelectors":case"FormSelectors":case"DashboardSelectors":case"VisualizationSelectors":p=this._payloadKeyToMetadataTypeMap[i.key];for(const e of i.value)d=this._GetLegacyMetadataTypeForQuery(p,e.MetadataSubtype,Object(Z.a)(()=>u,e=>u=e)),f=this._CreateLocalStoreId(e.EntityLogicalName,d,null,null,u,e.AppId),n.push(this._ConvertMetadataToApplicationMetadata(e,d,u,e.EntityLogicalName,f,!1));break;case"BPFSelectors":p=this._payloadKeyToMetadataTypeMap[i.key],d=this._GetLegacyMetadataTypeForQuery(p,null,Object(Z.a)(()=>u,e=>u=e));for(const e of i.value)f=this._CreateLocalStoreId(e.EntityLogicalName,d,null,null,u,e.AppId),n.push(this._ConvertMetadataToApplicationMetadata(e,d,u,e.EntityLogicalName,f,!1));break;case"SavedQueryVisualizations":for(const e of i.value)d=e.IsUserQueryVisualization?this._GetLegacyMetadataTypeForQuery("uservisualization",null,Object(Z.a)(()=>u,e=>u=e)):this._GetLegacyMetadataTypeForQuery("savedvisualization",null,Object(Z.a)(()=>u,e=>u=e)),f=this._CreateLocalStoreId(null,d,e.Id,null),n.push(this._ConvertMetadataToApplicationMetadata(e,d,u,e.PrimaryEntityTypeCode,f,e.IsDefault,e.Id));break;case"CustomControls":d=this._GetLegacyMetadataTypeForQuery("customcontrol",null,Object(Z.a)(()=>u,e=>u=e));for(const e of i.value)f=this._CreateLocalStoreId(null,d,null,e.Name),n.push(this._ConvertMetadataToApplicationMetadata(e,d,u,null,f,!1));break;case"Labels":d=this._GetLegacyMetadataTypeForQuery("label",null,Object(Z.a)(()=>u,e=>u=e));for(const e of i.value)f=this._CreateLocalStoreId(null,d,e.Id,e.LabelColumnName),n.push(this._ConvertMetadataToApplicationMetadata(e,d,u,null,f,!1));break;case"ResourceStrings":d=this._GetLegacyMetadataTypeForQuery("resourcestring",null,Object(Z.a)(()=>u,e=>u=e));for(const e of i.value)for(const t of e)f=this._CreateLocalStoreId(null,d,null,t.Key),n.push(this._ConvertMetadataToApplicationMetadata(t,d,u,null,f,!1));break;case"DisplayStrings":d=this._GetLegacyMetadataTypeForQuery("displaystring",null,Object(Z.a)(()=>u,e=>u=e));for(const e of i.value)for(const t of e)f=this._CreateLocalStoreId(null,d,t.Key,null),n.push(this._ConvertMetadataToApplicationMetadata(t,d,u,null,f,!1));break;case"WebResources":for(const e of i.value)Object(s.a)(e.Content)||Object(s.a)(e.Type)||(d=this._GetLegacyMetadataTypeForQuery("webresource",_e[parseInt(e.Type.toString(),10)],Object(Z.a)(()=>u,e=>u=e)),f=this._CreateLocalStoreId(null,d,null,e.Name),n.push(this._ConvertMetadataToApplicationMetadata(e.Content,d,u,null,f,!1,e.Name)),e.Content=null),d=this._GetLegacyMetadataTypeForQuery("webresourcedescriptor",null,Object(Z.a)(()=>u,e=>u=e)),f=this._CreateLocalStoreId(null,d,null,e.Name),n.push(this._ConvertMetadataToApplicationMetadata(e,d,u,null,f,!1,e.Id));break;case"Ribbons":d=this._GetLegacyMetadataTypeForQuery("ribbon",null,Object(Z.a)(()=>u,e=>u=e));for(const e of i.value)f=this._CreateLocalStoreId(e.EntityLogicalName,d,null,e.Context),n.push(this._ConvertMetadataToApplicationMetadata(e,d,u,null,f,!1));break;case"QuickCreateMenu":d=this._GetLegacyMetadataTypeForQuery("quickcreatemenu",null,Object(Z.a)(()=>u,e=>u=e));const g={};for(const e of i.value)f=this._CreateLocalStoreId(null,d,null,null,0,e.AppId),f in g||(Object.keys(g).push(f),g[f]=[]),g[f].push(e);for(const e of Object.keys(g)){const t={};t.QuickCreateMenu=g[e],n.push(this._ConvertMetadataToApplicationMetadata(t,d,u,null,e,!1))}break;case"OptionSets":d=this._GetLegacyMetadataTypeForQuery("optionset",null,Object(Z.a)(()=>u,e=>u=e));for(const e of i.value)f=this._CreateLocalStoreId(null,d,e.MetadataId,e.OptionSetName),e.VersionNumber=c,e.OverallVersionNumber=l,n.push(this._ConvertMetadataToApplicationMetadata(e,d,u,null,f,!1));break;case"CustomControlConfigurations":d=this._GetLegacyMetadataTypeForQuery("customcontroldefaultconfig",null,Object(Z.a)(()=>u,e=>u=e));for(const e of i.value)f=this._CreateLocalStoreId(e.PrimaryEntityType,d,e.CustomControlId,e.Name),n.push(this._ConvertMetadataToApplicationMetadata(e,d,u,null,f,!0));break;case"BusinessProcessFlowMetadata":d=this._GetLegacyMetadataTypeForQuery("businessprocessflow",null,Object(Z.a)(()=>u,e=>u=e));for(const e of i.value)f=this._CreateLocalStoreId(null,d,e.BusinessProcessFlowId,null),n.push(this._ConvertMetadataToApplicationMetadata(e,d,u,null,f,!0));break;case"Dialogs":d=this._GetLegacyMetadataTypeForQuery("dialog",null,Object(Z.a)(()=>u,e=>u=e));for(const e of i.value)f=this._CreateLocalStoreId(null,d,null,e.UniqueName),n.push(this._ConvertMetadataToApplicationMetadata(e,d,u,null,f,!0));break;case"TaskBasedFlows":d=this._GetLegacyMetadataTypeForQuery("taskbasedflow",null,Object(Z.a)(()=>u,e=>u=e));for(const e of i.value)f=this._CreateLocalStoreId(null,d,null,e.UniqueName),n.push(this._ConvertMetadataToApplicationMetadata(e,d,u,null,f,!0));break;case"TaskBasedFlowGlobalMenu":const h={};h.TaskBasedFlowGlobalMenu=i.value,d=this._GetLegacyMetadataTypeForQuery("taskbasedflowglobalmenu",null,Object(Z.a)(()=>u,e=>u=e)),f=this._CreateLocalStoreId(null,d,null,null),n.push(this._ConvertMetadataToApplicationMetadata(h,d,u,null,f,!0));break;case"Search":const m={};m.Search=i.value,d=this._GetLegacyMetadataTypeForQuery("search",null,Object(Z.a)(()=>u,e=>u=e)),f=this._CreateLocalStoreId(null,d,null,null),n.push(this._ConvertMetadataToApplicationMetadata(m,d,u,null,f,!0));break;case"Sitemap":d=this._GetLegacyMetadataTypeForQuery("sitemap",null,Object(Z.a)(()=>u,e=>u=e));for(const e of i.value)f=this._CreateLocalStoreId(null,d,null,null,0,e.AppId),n.push(this._ConvertMetadataToApplicationMetadata(e,d,u,null,f,!0));break;case"AppModulePublished":d=this._GetLegacyMetadataTypeForQuery("appmodules",null,Object(Z.a)(()=>u,e=>u=e));for(const e of i.value)f=this._CreateLocalStoreId(null,d,null,null,0,e.appInfo.AppId),n.push(this._ConvertMetadataToApplicationMetadata(e,d,u,null,f,!0));break;case"AppModules":d=this._GetLegacyMetadataTypeForQuery("appmoduleofflinemetadata",null,Object(Z.a)(()=>u,e=>u=e)),f=this._CreateLocalStoreId(null,d,null,null,0,null),n.push(this._ConvertMetadataToApplicationMetadata(i.value[0],d,u,null,f,!0));break;case"ComplexControls":d=this._GetLegacyMetadataTypeForQuery("complexcontrol",null,Object(Z.a)(()=>u,e=>u=e));for(const e of i.value)f=this._CreateLocalStoreId(null,d,null,e.Name),n.push(this._ConvertMetadataToApplicationMetadata(e,d,u,null,f,!1));break;case"EntityMetadataVersionStamp":o=i.value[0];break;case"IsActivityFlags":d=this._GetLegacyMetadataTypeForQuery("isactivityflags",null,Object(Z.a)(()=>u,e=>u=e)),f=this._CreateLocalStoreId(null,d,null,"entitydefinitionstype"),n.push(this._ConvertMetadataToApplicationMetadata(i.value,d,u,null,f,!1))}}}catch(e){Object(N.b)("ClientBrowserStore_StoreApplicationMetadata:format object data",O.a.storage,"format object data failed with error"+(null==e?void 0:e.message))}const u=[this._createMultipleApplicationMetadata(n),this._CreateMultipleEntityMetadata(r),this.createMultipleAttributeMetadata(a)];return o&&u.push(this._updateEntityMetadataVersionStamp(o)),-1!==l&&this.updateApplicationMetadataVersionStamps({"":l}),Object(k.a)(u).then(e=>{const n=e[0];t.resolve(n)},e=>{t.reject(e)}),t}_GetLegacyFormSubtype(e){let t=0;if(!Object(s.a)(e))switch(e.toLowerCase()){case"appointmentbook":t=se.a.appointment;break;case"hardcoded":t=se.a.hardcoded;break;case"main":t=se.a.main;break;case"minicampaignbo":t=se.a.miniCampaignBO;break;case"preview":t=se.a.preview;break;case"dashboard":t=se.a.dashboard;break;case"quick":t=se.a.quick;break;case"mobile":t=se.a.mobile;break;case"read":t=se.a.read;break;case"quickcreate":t=se.a.quickCreate;break;case"dialog":t=se.a.dialog;break;case"card":t=se.a.card;break;case"taskbasedform":t=se.a.taskBased;break;case"interactioncentricdashboard":t=se.a.interactionCentricDashboard;break;default:t=0}return t}_GetLegacyMetadataTypeForQuery(e,t,n){switch(e){case"form":return n.val=this._GetLegacyFormSubtype(t),D.a.form;case"workspace":case"systemworkspace":case"userworkspace":return n.val=se.a.dashboard,D.a.workspace;case"formselector":return n.val=this._GetLegacyFormSubtype(t),D.a.formSelector;case"bpfselector":return n.val=se.a.none,D.a.bpfSelector;case"dashboardselector":return n.val=se.a.dashboard,D.a.dashboardSelector;case"search":return n.val=0,D.a.searchConfiguration;case"customcontrol":return n.val=0,D.a.customControl;case"resourcestring":return n.val=0,D.a.resourceString;case"visualizationselector":return n.val=0,D.a.visualizationSelector;case"savedvisualization":return n.val=0,D.a.savedQueryVisualization;case"uservisualization":return n.val=0,D.a.userQueryVisualization;case"label":return n.val=0,D.a.label;case"displaystring":return n.val=0,D.a.displayString;case"webresource":return n.val=this._GetLegacyWebResourceSubtype(t),D.a.webResource;case"webresourcedescriptor":return n.val=0,D.a.webResourceDescriptor;case"customcontroldefaultconfig":return n.val=0,D.a.homePageConfiguration;case"optionset":return n.val=0,D.a.optionSet;case"quickcreatemenu":return n.val=0,D.a.quickCreateMenu;case"businessprocessflow":return n.val=0,D.a.businessProcessFlow;case"dialog":return n.val=0,D.a.dialog;case"taskbasedflow":return n.val=0,D.a.taskBasedFlow;case"taskbasedflowglobalmenu":return n.val=0,D.a.taskBasedFlowGlobalMenu;case"sitemap":return n.val=0,D.a.siteMap;case"viewselector":return n.val=this._GetLegacyViewSubtype(t),D.a.viewSelector;case"savedview":return n.val=this._GetLegacyViewSubtype(t),D.a.savedView;case"userview":return n.val=this._GetLegacyViewSubtype(t),D.a.userView;case"ribbon":return n.val=0,D.a.command;case"appmodules":return n.val=0,D.a.appModule;case"appmoduleselector":return n.val=0,D.a.appModuleSelector;case"metadataversion":return n.val=0,D.a.overallMetadataVersion;case"complexcontrol":return n.val=0,D.a.complexControl;case"isactivityflags":return n.val=0,D.a.isActivityFlags;case"appmoduleofflinemetadata":return n.val=0,D.a.appModuleOfflineMetadata;default:return n.val=0,0}}_GetLegacyViewSubtype(e){let t=0;if(!Object(s.a)(e))switch(e.toUpperCase()){case"MAIN_APPLICATION_VIEW":t=se.a.main;break;case"ADVANCED_SEARCH":t=se.a.advancedSearch;break;case"SUB_GRID":t=se.a.subGrid;break;case"QUICKFIND_SEARCH":t=se.a.quickFindSearch;break;case"REPORTING":t=se.a.reporting;break;case"OFFLINE_FILTERS":t=se.a.offlineFilters;break;case"MA_SEARCH":t=se.a.maSearch;break;case"LOOKUP_VIEW":t=se.a.lookup;break;case"SM_APPOINTMENTBOOK_VIEW":t=se.a.smAppointmentBook;break;case"OUTLOOK_FILTERS":t=se.a.outlookFilters;break;case"ADDRESSBOOK_FILTERS":t=se.a.addressbookFilters;break;case"SAVEDQUERYTYPE_OTHER":t=se.a.savedQueryTypeOther;break;case"INTERACTIVE_WORKFLOW_VIEW":t=se.a.interactiveWorkFlow;break;case"OFFLINE_TEMPLATE":t=se.a.offlineTemplate;break;case"OUTLOOK_TEMPLATE":t=se.a.outlookTemplate;break;case"CUSTOM_DEFINED_VIEW":t=se.a.customDefined;break;default:t=0}return t}_GetLegacyWebResourceSubtype(e){let t=0;if(!Object(s.a)(e))switch(e.toUpperCase()){case"HTML":t=10;break;case"CSS":t=6;break;case"JSCRIPT":t=5;break;case"XML":t=11;break;case"PNG":t=7;break;case"JPG":t=8;break;case"RESX":t=12;break;case"GIF":case"SILVERLIGHT":case"XSL":case"ICO":default:t=0}return t}_ConvertMetadataToApplicationMetadata(e,t,n,r,a,i,o){const s={};return s[we.a]=a,s[we.k]=o,s[we.j]=t,s[we.i]=n,s[we.f]=ie.a.Desktop,s[we.c]=e,s[we.g]=i,s[we.b]=r,s[we.h]=!1,new Ie.a(s)}_ConvertToAttributeMetadata(e){const t=[];for(const n of e)t.push(je.a.createFromODataResponse(n));return t}getRecentItems(e,t,n,r,a,o,s){return(new i.a).reject(A.a.fromErrorCode(-2147093999))}get_localStore(){return this._localStore}get_offlineDataStore(){return this._offlineDataStore}set_offlineDataStore(e){return this._offlineDataStore=e,e}nullifyStores(){const e=new i.a;let t;return this._localStore instanceof Wn&&this._sessionStateStore instanceof Wn?e.resolve():(t=this._NullifyLocalStore(),t.then(t=>{this._sessionStateStore=this.get_localStore(),e.resolve()},t=>{Object(N.e)("ClientBrowserDataSource_NullifyStores",O.a.storage,"Nullify Store failed"),e.reject(t)})),e}initialize(e){const t=new i.a,n=new it;if(e)this._localStore instanceof Wn&&(Object(s.a)(this._sessionStateStore)||this._sessionStateStore instanceof Wn?(Object(N.e)("ClientBrowserStore_Initialize",O.a.storage,"init localStore and sessionStateStore"),this._localStore=new Un(this._serverUri,this._parentDataSource.get_Store()),this._sessionStateStore=this._localStore):(Object(N.e)("ClientBrowserStore_Initialize",O.a.storage,"init localStore"),this._localStore=this._sessionStateStore)),this._InstallOrNullify(this.get_localStore(),n,Re.both,t);else{let e=(new i.a).resolve(null);this._wasInitializedWithLocalStore&&!M.a.getInstance().get_PALEnabled()&&(Object(N.e)("ClientBrowserStore_Initialize:cleanupMetadatataPromise",O.a.storage,"create promise for ClearAllMetadataStores"+this._serverUri),e=this.clearAllMetadataStores(!1,!0)),e.then(e=>{Object(s.a)(this._localStore)||this._localStore instanceof Wn?(this._sessionStateStore=new Un(this._serverUri,this._parentDataSource.get_Store()),Object(N.e)("ClientBrowserStore_Initialize:cleanupMetadatataPromise",O.a.storage,"init sessionStateStore this._serverUri = "+this._serverUri)):(this._sessionStateStore=this._localStore,Object(N.e)("ClientBrowserStore_Initialize:cleanupMetadatataPromise",O.a.storage,"init sessionStateStore with localStore"));const r=[this._InstallOrNullify(this._sessionStateStore,n,Re.session),this._NullifyLocalStore()];Object(k.a)(r).then(e=>{t.resolve()},e=>{t.reject(e)})},e=>{Object(N.b)("ClientBrowserStore_Initialize:cleanupMetadatataPromise",O.a.storage,"cleanup metadata failed with error: "+e.get_Message()),t.reject(e)})}return t}_InstallOrNullify(e,t,n,r){let a=!0;return Object(s.a)(r)&&(a=!1,r=new i.a),e.install(t).then(e=>{this._wasInitializedWithLocalStore=a,r.resolve()},e=>{Object(N.e)("ClientBrowserStore_InstallOrNullify:store.Install",O.a.storage,"failed :nullifyStore storetype = "+Re[n]);let t=(new i.a).resolve(null);t=n===Re.session?this._NullifySessionStore():this._NullifyLocalStore(),t.then(e=>{n===Re.both&&(this._sessionStateStore=this.get_localStore()),r.resolve()},e=>{Object(N.e)("ClientBrowserStore_InstallOrNullify:store.Install",O.a.storage,"Nullify Store failed : storetype = "+Re[n]),r.reject(e)})}),r}upgrade(){const e=new i.a;return this.get_localStore().upgrade().then(t=>{e.resolve(t)},t=>{e.reject(t)}),e}pullPersonalizations(){const e=new i.a;return this.get_localStore().pullPersonalizations().then(t=>{e.resolve(t)},t=>{e.reject(t)}),e}pushPersonalizations(e){const t=new i.a;return this.get_localStore().pushPersonalizations(e).then(e=>{t.resolve(e)},e=>{t.reject(e)}),t}initializeOfflineComponents(e){return this.get_offlineDataStore().initialize(e,this._parentDataSource.get_EventManager(),this,null)}_getNetworkAvailability(){return this._parentDataSource.get_IsServerAvailable()}retrieveDataFromOfflineStore(e){const t=new i.a;return this.get_localStore().retrieve(e,it.offlineDatabaseInformationStore,null).then(e=>{t.resolve(e)},e=>{t.reject(e)}),t}clearAllMetadataStores(e,t){return this._WriteOperation(n=>{const r=this.get_localStore().get_localStoreSchema().get_metadataStoreNames(),a=[];for(const n of r)n===it.sessionStateStore.toLowerCase()?!Object(s.a)(t)&&t||a.push(this._sessionStateStore.flushAll(n,null)):!Object(s.a)(e)&&e&&n===it.userContextStore.toLowerCase()||a.push(this.get_localStore().flushAll(n,null));return Object(k.a)(a).then(()=>{n.resolve(r)},e=>{e.get_Message().indexOf("does not exist")>0?n.resolve(r):n.reject(e)}),n})}clearEntityAttributeApplicationMetadataStores(){return this._WriteOperation(e=>{const t=[it.entityMetadataStore,it.attributeMetadataStore,it.applicationMetadataStore],n=t.map(e=>this.get_localStore().flushAll(e,null));return Object(k.a)(n).then(()=>{e.resolve(t)},t=>{e.reject(t)}),e})}clearAllDataStores(){return this._WriteOperation(e=>{const t=this.get_localStore().get_localStoreSchema().get_dataStoreNames(),n=[];Ve.a.get_instance().isOfflineDataSourceInitialized()&&!Object(s.a)(this.get_offlineDataStore())&&n.push(this.get_offlineDataStore().flushAll(this._parentDataSource.get_UserContext()));for(const e of t)n.push(this.get_localStore().flushAll(e,null));return Object(k.a)(n).then(()=>{e.resolve(t)},t=>{e.reject(t)}),e})}UpdateUserContext(e){return this._WriteOperation(t=>(e?this.get_localStore().add("contextkey",e.getObjectData(),it.userContextStore,null).then(()=>{t.resolve(!0)},e=>{Object(N.b)("ClientBrowserDataSource:UpdateUserContext",O.a.storage,e.get_Message()),t.reject(e)}):this.get_localStore().flush("contextkey",it.userContextStore,null).then(()=>{t.resolve(!0)},e=>{t.reject(e)}),t))}retrieveUserContext(){const e=new i.a;return this.get_localStore().retrieve("contextkey",it.userContextStore,null).then(function(e,t){return n=>{if(n)try{e.resolve(t(n))}catch(t){Object(N.e)("RetrieveSuccessForUserContext",O.a.dataSource,"RetrieveUserContext threw exception trying to create the object data, resolving with null. Message:"+t.message),e.resolve(null)}else e.resolve(null)}}(e,Ze.a.createFromObjectData),er(e,"contextkey")),e}cache(e,t,n){Ve.a.get_instance().get_offlineDataSource().isEntityAvailableForOfflineUsage(e.get_identifier().LogicalName)?ee.a.schedule(()=>{this.get_offlineDataStore().cache(e,t,n)},ue,"ClientBrowserDataSource.Cache.WriteToOfflineDataStore"):ee.a.schedule(()=>{this._CreateInternal(e,t)},ue,"ClientBrowserDataSource.Cache.WriteToCache")}cacheMultiple(e,t,n){Ve.a.get_instance().get_offlineDataSource().isEntityAvailableForOfflineUsage(e.get_EntityLogicalName())||ee.a.schedule(()=>{this._createMultiple(e,t,n)},ue,"ClientBrowserDataSource.CacheMultiple.WriteToCache")}uncache(e,t){Ve.a.get_instance().get_offlineDataSource().isEntityAvailableForOfflineUsage(e.LogicalName)||ee.a.schedule(()=>{this.Delete(e,t)},ue,"ClientBrowserDataSource.Uncache.DeleteFromCache")}create(e,t,n,r){const a=new i.a;return Ve.a.get_instance().get_offlineDataSource().isOfflineOptedIn()?Ve.a.get_instance().get_offlineDataSource().isEntityAvailableForOfflineUsage(e.get_identifier().LogicalName)?(this.get_offlineDataStore().create(e,t,n,r).then(e=>{a.resolve(e)},e=>{a.reject(e)}),a):a.reject(A.a.fromErrorCode(-2147093996)):(this._CreateInternal(e,n).then(e=>{a.resolve(e)},e=>{a.reject(e)}),a)}_createMultiple(e,t,n){return this._WriteOperation(r=>{const a=e.get_key();return this.get_localStore().transaction([it.entityRecordStore,it.listStore],e=>{e.set_result(a),e.retrieveMultipleByQuery(new be.a(new ge.a(new pe.a(Vn.queryPath),a),null),it.listStore,n).done(a=>{if(Object(s.a)(a)||!a.get_results().length){const a=new Vn(t);e.add(null,a.getObjectData(),it.listStore,n).done(a=>{const i=[];for(let r=0;r<t.get_count();r++)i.push(this._MergeAndSaveEntity(e,t.get_item(r),n));Object(k.a)(i).then(e=>{},e=>{r.reject(e)})})}else{const i=Vn.createFromObjectData(a.get_results()[0].get_key(),a.get_results()[0].get_value());i.update(t),e.add(i.get_indexId(),i.getObjectData(),it.listStore,n).done(()=>{const a=[];for(let r=0;r<t.get_count();r++)a.push(this._MergeAndSaveEntity(e,t.get_item(r),n));Object(k.a)(a).then(()=>{},e=>{r.reject(e)})})}})}).then(e=>{r.resolve(e)},e=>{r.reject(e)}),r},t.get_clientRetrieveOptions(),n)}retrieveRelatedEntities(e,t,n,r,a,o,c,l,u){const d=e.toString(),p=new i.a;return Ve.a.get_instance().get_offlineDataSource().isEntityAvailableForOfflineUsage(e.LogicalName)?(this.get_offlineDataStore().retrieve(e,t,a,o,c,u).then(t=>{t?Object(s.a)(r)?Ve.a.get_instance().get_offlineDataSource().refreshLookupData(e,t,a,o).then(e=>{p.resolve(e)},()=>{p.resolve(t)}):this._RetrieveRelatedEntitiesForRecord(t,r,a,o,u).then(t=>{Ve.a.get_instance().get_offlineDataSource().refreshLookupData(e,t,a,o).then(e=>{p.resolve(e)},()=>{p.resolve(t)})},e=>{p.reject(e)}):p.reject(A.a.FromMessage("Not in offline store with key '{0}'",d))},Zn(p,d)),p):(this._batchedCallbackRunner.queueCallback(()=>{this.get_localStore().retrieve(d,it.entityRecordStore,o).then(e=>{if(e){const t=q.a.createFromObjectData(e);Object(s.a)(r)?p.resolve(t):this._RetrieveRelatedEntitiesForRecord(t,r,a,o,u).then(e=>{p.resolve(t)},e=>{p.reject(e)})}else Ve.a.get_instance().get_offlineDataSource().isOfflineFeatureEnabledForOrganization()?p.reject(A.a.fromErrorCode(-2147093987,d)):p.reject(A.a.FromMessage("Not in local store with key '{0}'",d))},er(p,d))},o),p)}retrieveMultiple(e,t,n){const r=new i.a;if(Ve.a.get_instance().get_offlineDataSource().isEntityAvailableForOfflineUsage(e.get_EntityLogicalName()))return this._batchedCallbackRunner.queueCallback(()=>{this.get_offlineDataStore().retrieveMultiple(e,t,n).then(a=>{a?Ve.a.get_instance().get_offlineDataSource().refreshRetrieveMultipleLookupData(a,t,n).always(e=>{r.resolve(e)}):r.reject(A.a.FromMessage("Not in offline store with key '{0}'",e.get_PublicKey()))},Zn(r,e.get_key()))},n),r;const a=e.get_key();return this._batchedCallbackRunner.queueCallback(()=>{this.get_localStore().readOnlyTransaction([it.listStore,it.entityRecordStore],t=>{t.retrieveMultipleByQuery(new be.a(new ge.a(new pe.a(Vn.queryPath),a),null),it.listStore,n).done(r=>{if(!Object(s.a)(r)&&r.get_results().length>0){const a=Vn.createFromObjectData(r.get_results()[0].get_key(),r.get_results()[0].get_value());if(a.get_entityIndex().length>0){const r=[];for(const e of a.get_entityIndex()){const i=new W.a(a.get_logicalName(),e);r.push(t.retrieve(i.toString(),it.entityRecordStore,n))}(new Ee).waitForArray(r).done(n=>{const r=[];for(let e=0;e<n.length;e++)Object(s.a)(n[e])||r.push(q.a.createFromObjectData(n[e]));const i=new Te.a(r,a.get_moreRecords(),a.get_totalRecordCount(),!1,e,a.get_clientRetrieveOptions());t.set_result(i)})}else{const n=new Te.a(new Array(0),!1,0,!1,e,a.get_clientRetrieveOptions());t.set_result(n)}}})}).then(e=>{e?r.resolve(e):Ve.a.get_instance().get_offlineDataSource().isOfflineFeatureEnabledForOrganization()?r.reject(A.a.fromErrorCode(-2147093987,a)):r.reject(A.a.FromMessage("Not in local store with key '{0}'",a))},e=>{r.reject(A.a.fromErrorCodeAndMessage(-2147015599,String.format("Local store failed with error: '{0}' while trying to retrieve with key '{1}'",e.get_Message(),a)))})},n),r}retrieveEntitiesForAggregateQuery(e,t,n){throw Error.notImplemented("RetrieveEntitiesForAggregateQuery")}update(e,t,n,r,a){if(Ve.a.get_instance().get_offlineDataSource().isEntityAvailableForOfflineUsage(e.LogicalName))return this.get_offlineDataStore().update(e,t,n,r,a).catch(e=>{Object(N.d)("DataSource_Update_LocalError",O.a.storage,e.get_Message())});return(new i.a).reject(A.a.fromErrorCode(-2147093999))}Delete(e,t){if(e.get_identifier()===R.a.get_empty().toString())throw Error.argumentType("Record has an empty identifier. Cannot be deleted from Delete implementation in Local Store");if(Ve.a.get_instance().get_offlineDataSource().isEntityAvailableForOfflineUsage(e.LogicalName))return this._WriteOperation(n=>(this.get_offlineDataStore().Delete(e,t,this._getNetworkAvailability()).then(t=>{n.resolve(e)},t=>{n.reject(A.a.FromMessage("Offline store failed with error: '{0}' while trying to delete with key '{1}'",t.get_Message(),e.toString()))}),n));if(Ve.a.get_instance().get_offlineDataSource().isOfflineOptedIn()&&!this._getNetworkAvailability()){return(new i.a).reject(A.a.fromErrorCode(-2147093999))}return this._WriteOperation(n=>{const r=e.toString();return this.get_localStore().flush(r,it.entityRecordStore,t).then(()=>{n.resolve(e)},e=>{n.reject(A.a.FromMessage("Local store failed with error: '{0}' while trying to delete with key '{1}'",e.get_Message(),r))}),n})}_OfflineExecuteMultipleRequestValidation(e){for(const t of e.get_requests()){if(t instanceof He.a)continue;const e=t instanceof qe.a||t instanceof Ye.a?t.get_target():null;if(Object(s.a)(e)||!Ve.a.get_instance().get_offlineDataSource().isEntityAvailableForOfflineUsage(e.get_identifier().LogicalName))return!1}return!0}_OfflineGetClientMetadataExecuteMultipleRequestValidation(e){for(const t of e.get_requests())if(!(t instanceof Ke))return!1;return!0}_OfflineExecuteQuickFindValidation(e){const t=e;return!!(t&&t.get_entityNames()&&t.get_entityNames().length>0)&&Ve.a.get_instance().get_offlineDataSource().isEntityAvailableForOfflineUsage(t.get_entityNames()[0])}execute(e,t,n){const r=new i.a;if(e instanceof We.a&&this._OfflineExecuteMultipleRequestValidation(e)||e instanceof qe.a&&Ve.a.get_instance().get_offlineDataSource().isEntityAvailableForOfflineUsage(e.get_target().get_identifier().LogicalName)||e instanceof Ye.a&&Ve.a.get_instance().get_offlineDataSource().isEntityAvailableForOfflineUsage(e.get_target().get_identifier().LogicalName)||e instanceof E.a&&this._OfflineExecuteQuickFindValidation(e))return this.get_offlineDataStore().execute(e,t,n);if(e instanceof We.a&&this._OfflineGetClientMetadataExecuteMultipleRequestValidation(e)){const t=[];for(const n of e.get_requests())if(n instanceof Ke){const e=n;t.push(this.getClientMetadata(e.get_clientMetadataQuery()))}return Object(k.a)(t).then(e=>{const t=new Array(0);for(let n=0;n<e.length;n++){const e=new Je.a("GetClientMetadata");t.push(new Ne.a(null,n,e))}const n=new $e.a(!1,t);r.resolve(n)},e=>{r.reject(e)}),r}let a;return a=Ve.a.get_instance().get_offlineDataSource().isOfflineOptedIn()?"You have opted in for offline mode, but either offline database is not available, or the entity is not available for offline. Therefore, the request is unable to be sent.":"You have not opted in for offline mode and the connection to the remote server has been lost. Therefore, the request is unable to be sent.",Object(N.d)("ClientBrowserDataSource.Execute",O.a.storage,a),r.reject(A.a.fromErrorCode(-2147093999))}executeOData(e,t){return(new i.a).reject(A.a.fromErrorCode(-2147093999))}_CreateMultipleEntityMetadata(e){return this._WriteOperation(t=>{const n=new Array(e.length),r=this._parentDataSource.get_LocalDataSource().get_isAvailable(),a=Object(S.m)(this._parentDataSource.get_Store().getState(),void 0,r);for(let t=0;t<n.length;t++)n[t]=a?e[t].getStorableODataObject():e[t].getObjectData();return this.get_localStore().addMultiple(z.a.extractKey,n,it.entityMetadataStore,null).then(e=>{t.resolve(e)},e=>{Object(N.b)("ClientBrowserDataSource:CreateMultipleEntityMetadata",O.a.storage,e.get_Message()),Jn(t)}),t})}retrieveEntityMetadata(e,t){const n=new i.a,r=e;return this.get_localStore().retrieveMultiple(z.a.logicalNamePath,r,it.entityMetadataStore,t).then(e=>{e.length>0?n.resolve(z.a.createFromObjectData(e[0].get_value())):n.reject(A.a.fromLocalStoreError(-2147093987,"Not able to retrieve in local store with logicalname '{0}'",r))},er(n,r)),n}createMultipleAttributeMetadata(e){return this._WriteOperation(t=>{const n=[],r=this._parentDataSource.get_LocalDataSource().get_isAvailable(),a=Object(S.m)(this._parentDataSource.get_Store().getState(),void 0,r);for(let t=0;t<e.length;t++)a?n.push(e[t].getStorableODataObject()):n.push(e[t].getObjectData());return this.get_localStore().addMultiple(je.a.extractKey,n,it.attributeMetadataStore,null).then(e=>{t.resolve(e)},e=>{Object(N.b)("ClientBrowserDataSource:CreateMultipleAttributeMetadata",O.a.storage,e.get_Message()),t.reject(e)}),t})}retrieveMultipleAttributeMetadata(e,t){const n=new i.a;if(Object(s.a)(e.get_AttributeNames()))Object(ce.i)(O.a.localDataSource,"Attempting to retrieve all attribute metadata for an entity from local store"),this.get_localStore().retrieveMultiple(je.a.entityLogicalNamePath,e.get_EntityLogicalName(),it.attributeMetadataStore,t).then(t=>{if(t.length>0){const e=[];for(let n=0;n<t.length;n++)e.push(je.a.createFromObjectData(t[n].get_value()));n.resolve(e)}else n.reject(A.a.fromLocalStoreError(-2147093987,"Not in local store with key '{0}'",e.get_EntityLogicalName()))},er(n,e.get_EntityLogicalName()));else{const r=[],a=new Array(0);for(const t of e.get_AttributeNames()){const n=e.get_EntityLogicalName()+Me.a+t,i=this._retrieveAttributeMetadataPromiseCache.get(n);i?r.push(i.getPromise()):a.push(t)}const o=new i.a;this.get_localStore().readOnlyTransaction([it.attributeMetadataStore],n=>{for(const i of a){const a=e.get_EntityLogicalName()+Me.a+i,o=this._RetrieveLocalAttributeMetadata(e.get_EntityLogicalName(),a,n,t);this._retrieveAttributeMetadataPromiseCache.put(a,new Le.a(o,a,"RetrieveAttributeMetadata")),r.push(o)}}).then(()=>{o.resolve()},e=>{o.reject(e)}),o.then(()=>{Object(k.a)(r).then(e=>{const t=[];for(const n of e)n&&t.push(n);n.resolve(t)},t=>{const r=t instanceof A.a?t.get_Message():"[Unknown Error]";n.reject(A.a.fromLocalStoreError(-2147093987,"Local store failed with error: '{0}' while trying to retrieve with key '{1}'",r,e.toString()))})},t=>{n.reject(A.a.fromLocalStoreError(-2147093987,"Local store failed with error: '{0}' while trying to retrieve with key '{1}'",t.get_Message(),e.toString()))})}return n}_createMultipleApplicationMetadata(e){return this._WriteOperation(t=>{const n=new Array(e.length);for(let t=0;t<n.length;t++)n[t]=e[t].getObjectData();return this.get_localStore().addMultiple(Ie.a.extractKey,n,it.applicationMetadataStore,null).then(e=>{t.resolve(e)},e=>{Object(N.b)("ClientBrowserDataSource:CreateMultipleApplicationMetadata",O.a.storage,e.get_Message()),Jn(t)}),t})}retrieveApplicationMetadata(e,t){const n=new i.a,r=e.toString();return this.get_localStore().retrieve(r,it.applicationMetadataStore,t).then($n(n,r,Ie.a.createFromObjectData),er(n,r)),n}retrieveMultipleApplicationMetadata(e,t){const n=new i.a;return this.get_localStore().retrieveMultiple(e.get_keyPath().get_path(),e.get_keyValue(),it.applicationMetadataStore,t).then(t=>{const r=[];for(let n=0;n<t.length;n++){const a=Ie.a.createFromObjectData(t[n].get_value());e.checkApplicationMetadata(a)&&r.push(a)}n.resolve(r)},er(n,e.get_keyValue().toString())),n}_RetrieveMultipleApplicationMetadataByKeys(e,t,n){const r=new i.a,a=new fe.a(e,t),o=new be.a(a,[new ye(new pe.a(we.j),0)],0,t.length,n);return this.get_localStore().retrieveMultipleByQuery(o,it.applicationMetadataStore,null).then(e=>{const t=[];for(let n=0;n<e.get_results().length;n++)t.push(Ie.a.createFromObjectData(e.get_results()[n].get_value()));r.resolve(t)},e=>{r.reject(e)}),r}createUserPersonalization(e){return this._WriteOperation(t=>(this.get_localStore().add(e.get_key(),e.getObjectData(),it.userPersonalizationStore,null).then(e=>{t.resolve(e)},e=>{Object(N.b)("ClientBrowserDataSource:CreateUserPersonalization",O.a.storage,e.get_Message()),t.reject(e)}),t))}deleteUserPersonalization(e){return this._WriteOperation(t=>(this.get_localStore().flush(e,it.userPersonalizationStore,null).then(e=>{t.resolve(e)},e=>{t.reject(e)}),t))}retrieveUserPersonalization(e){const t=new i.a;return this.get_localStore().retrieve(e,it.userPersonalizationStore,null).then($n(t,e,De.a.createFromObjectData),er(t,e)),t}_updateEntityMetadataVersionStamp(e){return this._WriteOperation(t=>(this.get_localStore().add(Yn.entityMetadataVersionStampKey,e,it.metadataVersionStampStore,null).then(e=>{t.resolve(e)},e=>{Object(N.b)("ClientBrowserDataSource:UpdateEntityMetadataVersionStamp",O.a.storage,e.get_Message()),t.reject(e)}),t))}retrieveEntityMetadataVersionStamp(){const e=new i.a;return this.get_localStore().retrieve(Yn.entityMetadataVersionStampKey,it.metadataVersionStampStore,null).then(t=>{t?e.resolve(t.toString()):e.reject(A.a.FromMessage("Not able to retrieve in local store with key '{0}'",Yn.entityMetadataVersionStampKey))},t=>{e.reject(A.a.FromMessage("Local store failed with error: '{0}' while trying to retrieve with key '{1}'",t.get_Message(),Yn.entityMetadataVersionStampKey))}),e}updateApplicationMetadataVersionStamps(e){return this._WriteOperation(t=>{const n=[];for(const t in e){const r={key:t,value:e[t]},a=r.value;Object(s.b)(r.key)?n.push(this.get_localStore().add(Yn.applicationMetadataVersionStampKey,a,it.metadataVersionStampStore,null)):n.push(this.get_localStore().add(String.format("appmodule_{0}_versionstamp",r.key),a,it.metadataVersionStampStore,null))}return Object(k.a)(n).then(e=>{t.resolve(e)},e=>{Object(N.b)("ClientBrowserDataSource:UpdateApplicationMetadataVersionStamps",O.a.storage,e.get_Message()),t.reject(e)}),t})}retrieveApplicationMetadataVersionStamps(){const e=new i.a,t=new be.a(new me.a(pe.a.get_id(),Yn.entityMetadataVersionStampKey,0,Oe.a.lessThan),null);return this.get_localStore().retrieveMultipleByQuery(t,it.metadataVersionStampStore,null).then(t=>{const n={},r=t.get_results();if(!Object(s.a)(r)&&r.length>0)for(const e of r){let t="";const r=e.get_key();if(r!==Yn.applicationMetadataVersionStampKey){const n=r.split("_");!Object(s.a)(n)&&n.length>1?t=n[1]:Object(ce.d)(O.a.localDataSource,"Can't parse AppMetadataVersionStampKey: "+e.get_key())}n[t]=e.get_value()}e.resolve(n)},t=>{e.reject(A.a.FromMessage("Local store failed with error: '{0}' while trying to retrieve with key '{1}'",t.get_Message(),Yn.applicationMetadataVersionStampKey))}),e}_GetLocalStoreKey(e){return e.get_identifier().toString()}_MergeAndSaveEntity(e,t,n){const r=new i.a,a=this._GetLocalStoreKey(t),o=it.entityRecordStore;return e.retrieve(a,o,n).done(i=>{let c=t;Object(s.a)(i)||(c=q.a.createFromObjectData(i),c.mergeChanges(t)),e.add(a,c.getObjectData(),o,n).done(e=>{r.resolve(e)})}),r}_WriteOperation(e,t,n){const r=new i.a;return this._AddNavigationData(t,n).then(()=>{const a=new i.a;e(a).then(e=>{r.resolve(e)},a=>{tr(a)?this._PurgeData(n).then(()=>{this._WriteOperation(e,t,n).then(e=>{r.resolve(e)},a=>{Object(T.b)()&&tr(a)?this._FallbackToNullifyOnWrite(e,t,n,r):r.reject(a)})},i=>{Object(T.b)()?this._FallbackToNullifyOnWrite(e,t,n,r):(i.chainError(a),r.reject(i))}):r.reject(a)})}),r}_AddNavigationData(e,t){const n=new i.a;return Object(s.a)(e)?n.resolve(null):Object(s.a)(this._addingNavigationDataDeferred)?(this._addingNavigationDataDeferred=n.then(e=>(this._addingNavigationDataDeferred=null,e),e=>(this._addingNavigationDataDeferred=null,e)),this.get_localStore().retrieveMultiple(V.a.timestampPath,e.get_sortableTimestamp(),it.navigationDataStore,t).then(r=>{Object(s.a)(r)||!r.length?this.get_localStore().add(null,e.getObjectData(),it.navigationDataStore,t).then(()=>{n.resolve(e)},r=>{tr(r)?this._PurgeData(t).then(()=>{this.get_localStore().add(null,e.getObjectData(),it.navigationDataStore,t).then(()=>{n.resolve(e)},e=>{Object(N.b)("ClientBrowserDataSource:AddNavigationData:retryError",O.a.storage,e.get_Message()),n.reject(e)})},e=>{Object(N.b)("ClientBrowserDataSource:AddNavigationData:purgeError",O.a.storage,e.get_Message()),n.reject(e)}):(Object(N.b)("ClientBrowserDataSource:AddNavigationData:QuotaError",O.a.storage,r.get_Message()),n.reject(r))}):n.resolve(e)},e=>{Object(N.b)("ClientBrowserDataSource:AddNavigationData:RetrieveMultiple error",O.a.storage,e.get_Message()),n.reject(e)})):this._addingNavigationDataDeferred.then(r=>{e.get_sortableTimestamp()!==r.get_sortableTimestamp()?this._AddNavigationData(e,t).then(()=>{n.resolve(e)},e=>{Object(N.b)("ClientBrowserDataSource:AddNavigationData:addingNavigationDataDeferred:AddNavigationData error",O.a.storage,e.get_Message()),n.reject(e)}):n.resolve(r)},e=>{Object(N.b)("ClientBrowserDataSource:AddNavigationData:addingNavigationDataDeferred error",O.a.storage,e.get_Message()),n.reject(e)}),n}_PurgeData(e){return Object(s.a)(this._purgingDeferred)?(this._purgingDeferred=new i.a,this._purgingDeferred.always(()=>{this._purgingDeferred=null}),this.get_localStore().transaction([it.navigationDataStore,it.entityRecordStore,it.listStore],t=>{t.retrieveMultipleByQuery(new be.a(null,[new ye(new pe.a(V.a.timestampPath),0)]),it.navigationDataStore,e).done(n=>{const r=n.get_results();if(!Object(s.a)(r)&&r.length>0){const n=r.length>5?4:r.length-1,a=V.a.createFromObjectData(r[n].get_value()),i=new be.a(new he.a(new pe.a(V.a.embeddedPriorityTimestampPath),"0|9","1|"+a.get_sortableTimestamp(),Se.a.openLeft),null),o=[t.flushByQuery(i,it.entityRecordStore,e),t.flushByQuery(i,it.listStore,e)];(new Ee).waitForArray(o).done(i=>{if(Object(s.a)(i)||i.length<2||!(i[0]instanceof Number)||!(i[1]instanceof Number)||i[0]+i[1]<=0){let i=a.get_timestamp(),o=-1,s=!1;for(let e=0;e<r.length;e++){const t=V.a.createFromObjectData(r[e].get_value());if(!t.get_cachePriority()){if(!(e<n)){s=!0;break}i=t.get_timestamp(),o=e}}const c=[];if(!s&&!o&&r.length>0){const a=new Array(n-1);for(let e=1;e<n;e++)a[e-1]=r[e].get_key();c.push(t.flushMultiple(a,it.navigationDataStore,e))}else{let l,u,d;s||-1===o?(u=a.get_timestamp(),l=0,d=n):(u=i,l=ve.a.closed,d=o-1);const p=new be.a(new me.a(new pe.a(V.a.embeddedPriorityTimestampPath),V.a.priorityTimestampKey(0,u),l,Oe.a.lessThan),null),f=new Array(d);for(let e=0;e<d;e++)f[e]=r[e].get_key();c.push(t.flushByQuery(p,it.entityRecordStore,e)),c.push(t.flushByQuery(p,it.listStore,e)),c.push(t.flushMultiple(f,it.navigationDataStore,e))}(new Ee).waitForArray(c).done(e=>{let n=!0;for(const t of e)if("number"==typeof t&&t>0){n=!1;break}n&&t.set_result(A.a.FromMessage("At default frame, no more frames to purge"))})}})}else t.set_result(A.a.FromMessage("No frames to purge"))})}).then(e=>{e instanceof A.a?this._purgingDeferred.reject(A.a.fromErrorCodeAndMessage(-2147015599,String.format("Local store failed with error: '{0}' while trying to purge data",e.get_Message()))):this._purgingDeferred.resolve(null)},e=>{this._purgingDeferred.reject(A.a.fromErrorCodeAndMessage(-2147015599,String.format("Local store failed with error: '{0}' while trying to purge data",e.get_Message())))}),this._purgingDeferred):this._purgingDeferred}_NullifyLocalStore(){return Object(ce.i)(O.a.localDataSource,"NullifyLocalStore: Nullifying local store..."),this._localStore=new Wn,this.get_localStore().install(new it)}_NullifySessionStore(){return Object(ce.i)(O.a.localDataSource,"NullifySessionStore:Nullifying session State Store"),this._sessionStateStore=new Wn,this._sessionStateStore.install(new it)}_FallbackToNullifyOnWrite(e,t,n,r){Object(ce.f)(O.a.localDataSource,"Quota Error Handled after purging and retry. Nullifying database..."),this._NullifyLocalStore().then(()=>{e(r)},e=>{r.reject(e)})}_RetrieveLocalAttributeMetadata(e,t,n,r){const a=new i.a,o=new be.a(new ge.a(new pe.a(je.a.entityAttributeLogicalNamesPath),t),null);return n.retrieveMultipleByQuery(o,it.attributeMetadataStore,r).done(t=>{const n=t.get_results();let r=null;if(n.length>0)for(let t=0;t<n.length;t++){const a=je.a.createFromObjectData(n[t].get_value());if(a.get_entityLogicalName()===e){r=a;break}}a.resolve(r)}),a}_RetrieveMultipleRelatedEntitiesForRecord(e,t,n,r,a){if(Ve.a.get_instance().get_offlineDataSource().isEntityAvailableForOfflineUsage(e.get_identifier().LogicalName)){const e=new i.a;return this.retrieveMultiple(t,n,r).then(t=>{e.resolve(t)},r=>{-2147093987===r.get_ErrorCode()?e.resolve(new Te.a(new Array(0),!1,0,!1,t,n)):e.reject(r)}),e}return this.retrieveMultiple(t,n,r)}_CreateInternal(e,t){return this._WriteOperation(n=>(this.get_localStore().transaction([it.entityRecordStore],r=>{if(this._MergeAndSaveEntity(r,e,t),e.get_relatedEntities().get_entityCollections().length>0){const r=[];for(const n of e.get_relatedEntities().get_entityCollections())n.get_value().get_query()instanceof Be.a&&r.push(this._createMultiple(n.get_value().get_query(),n.get_value(),t));Object(k.a)(r).then(e=>{},e=>{n.reject(e)})}}).then(()=>{n.resolve(e.get_identifier())},e=>{n.reject(e)}),n),e.get_clientRetrieveOptions(),t)}_RetrieveRelatedEntitiesForRecord(e,t,n,r,a){const o=new i.a,c=[],l=[];return Object(s.a)(t)||(!this._getNetworkAvailability()&&Ve.a.get_instance().get_offlineDataSource().isOfflineAvailableForUse()&&l.push(Object(xe.b)(t,e.get_identifier())),Object(k.a)(l).then(i=>{let l=null;i.length&&(l=i[0]);for(const i of t){const t=new ze.a(i.get_key(),e.get_identifier(),i.get_value());Object(s.a)(l)||Object(s.a)(l[i.get_key().get_schemaName()])||t.get_DescriptorSet().updateDescriptorSet(Pe.a.Sql,l[i.get_key().get_schemaName()]),c.push(this._RetrieveMultipleRelatedEntitiesForRecord(e,t,n,r,a))}Object(k.a)(c).then(t=>{for(const n of t){const t=n,r=t.get_query().get_relationship();e.get_relatedEntities().addRelationship(r,t)}o.resolve(e)},e=>{o.reject(e)})},e=>{o.reject(e)})),o}saveSessionState(e,t,n){return this._WriteOperation(r=>{if(n)this._sessionStateStore.retrieve(e,it.sessionStateStore,null).then(a=>{let i;Object(s.a)(a)?i=new Ae(e,t):(i=Ae.createFromObjectData(a),i.Merge(t)),this._sessionStateStore.add(i.get_key(),i.getObjectData(),it.sessionStateStore,null).then(e=>{r.resolve(e)},t=>{Object(N.b)("ClientBrowserDataSource:SaveSessionState - Add, mergeState = "+n+" key = "+e,O.a.storage,t.get_Message()),r.reject(t)})},t=>{Object(N.b)("ClientBrowserDataSource:SaveSessionState - Retrieve, mergeState = "+n+" key = "+e,O.a.storage,t.get_Message()),r.reject(t)});else{const a=new Ae(e,t);this._sessionStateStore.add(a.get_key(),a.getObjectData(),it.sessionStateStore,null).then(e=>{r.resolve(e)},t=>{Object(N.b)("ClientBrowserDataSource:SaveSessionState - Add, mergeState = "+n+" key = "+e,O.a.storage,t.get_Message()),r.reject(t)})}return r})}retrieveSessionState(e){const t=new i.a;return this._sessionStateStore.retrieve(e,it.sessionStateStore,null).then(e=>{if(Object(s.a)(e))Object(N.e)("ClientBrowserDataSource:RetrieveSessionState - Retrieve",O.a.storage,"Resolve the result"),t.resolve(null);else{const n=Ae.createFromObjectData(e);t.resolve(n.get_stateData())}},n=>{Object(N.b)("ClientBrowserDataSource:RetrieveSessionState - Retrieve",O.a.storage,n.get_Message()+":key = "+e),t.reject(n)}),t}retrieveMultipleSessionStates(e){const t=new i.a;if(e.length>Object(gt.b)()){const e="The size of keys exceed the limit.";Object(N.b)("ClientBrowserDataSource:retrieveMultipleSessionStates - Retrieves",O.a.storage,e),t.reject(A.a.FromMessage(e))}return this._sessionStateStore.retrieveMultipleByQuery(new be.a(new fe.a(new pe.a("id"),e),null),it.sessionStateStore,null).then(e=>{const n=new Map;if(Object(s.a)(e))Object(N.e)("ClientBrowserDataSource:retrieveMultipleSessionStates - Retrieves",O.a.storage,"Resolve the empty results"),t.resolve(n);else{const r=e.get_results();for(const e of r){const t=e.get_key(),r=e.get_value();if(Object(s.a)(t)||Object(s.a)(r))Object(N.e)("ClientBrowserDataSource:retrieveMultipleSessionStates - Retrieves",O.a.storage,"Resolve the empty result for key: "+t);else{const e=Ae.createFromObjectData(r);n.set(t,e.get_stateData())}}t.resolve(n)}},n=>{Object(N.b)("ClientBrowserDataSource:retrieveMultipleSessionStates - Retrieves",O.a.storage,n.get_Message()+":keys = "+e),t.reject(n)}),t}deleteSessionState(e){const t=new i.a;return this._sessionStateStore.flush(e,it.sessionStateStore,null).then(e=>{t.resolve(e)},e=>{t.reject(e)}),t}saveOfflineInformation(e,t,n){const r=this._parentDataSource.get_Store().getState(),a=this._resolveKeyName(e,r);return this.saveSessionState(a,t,n)}retrieveOfflineInformation(e){const t=this._parentDataSource.get_Store().getState(),n=this._resolveKeyName(e,t);return this.retrieveSessionState(n)}retrieveMultipleOfflineInformation(e){const t=this._parentDataSource.get_Store().getState(),n=e.map(e=>this._resolveKeyName(e,t));return this.retrieveMultipleSessionStates(n)}deleteOfflineInformation(e){const t=this._parentDataSource.get_Store().getState(),n=this._resolveKeyName(e,t);return this.deleteSessionState(n)}_resolveKeyName(e,t){let n=e;if(Object(d.l)(t)){const r=Object(Gn.e)(t),a=Object(m.k)(t);n=Object(Kn.a)(e,a,r.guid)}return n}}function Jn(e){return t=>{e.reject(t)}}function $n(e,t,n){return r=>{r?e.resolve(n(r)):e.reject(A.a.fromLocalStoreError(-2147093987,"Not in local store with key '{0}'",t))}}function Zn(e,t){return n=>{e.reject(A.a.FromMessage("Offline store failed with error: '{0}' while trying to retrieve with key '{1}'",n.get_Message(),t))}}function er(e,t){return n=>{e.reject(A.a.fromLocalStoreError(-2147093987,"Local store failed with error: '{0}' while trying to retrieve with key '{1}'",n.get_Message(),t))}}function tr(e){return e.get_ErrorSource()===ae.a.LocalStore&&e.get_ErrorCode()===de.quotaError}Yn.entityMetadataVersionStampKey="entitymetadataversionstamp",Yn.applicationMetadataVersionStampKey="applicationmetadataversionstamp";var nr=n("hs84");class rr{constructor(){this._entityRetrievedEvents={}}add_serverAvailabilityChanged(e){this._onServerAvailabilityChanged=e}addRetrievedHandlerRecord(e,t){this._entityRetrievedEvents[e]||(this._entityRetrievedEvents[e]=[]),this._entityRetrievedEvents[e].push(t)}deleteRetrievedHandlerRecord(e,t){var n;const r=null===(n=this._entityRetrievedEvents[e])||void 0===n?void 0:n.indexOf(t);r>=0&&0===this._entityRetrievedEvents[e].splice(r,1).length&&delete this._entityRetrievedEvents[e]}OnRetrieved(e){const t=e.key;ee.a.schedule(()=>{this._entityRetrievedEvents[t]&&(Object(N.d)("DataSource_OnRetrieved",O.a.storage,t),this._entityRetrievedEvents[t].slice().forEach(t=>{t(e)}))},le,"DataSourceEventManager.OnRetrieved")}OnServerAvailabilityChange(e,t){this._onServerAvailabilityChanged&&(Object(N.e)("DataSource_OnServerAvailabilityChange",O.a.storage,"Server available = "+e.toString()+". Network available = "+t.toString()),this._onServerAvailabilityChanged(e,t))}}var ar=n("/Viv");class ir extends Ge.a{constructor(e,t){super(),this._request=null,this._offlineCallback=null,this._request=e,this._offlineCallback=t}get_request(){return this._request}get_offlineCallback(){return this._offlineCallback}executeCallback(e){return this._offlineCallback()}}var or=n("/d6W"),sr=n("tZZc"),cr=n("UyLX"),lr=n("w1eR"),ur=n("x/aW");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const dr={};let pr=null;class fr{constructor(e,t,n){this._serverUri=null,this._remoteCallRetryHandler=null,this._eventManager=null,this._localDataSource=null,this._remoteDataSource=null,this._webAPIService=null,this._metadataCache=null,this._store=null,this._applicationStatusProvider=null,this._getClientMetadataQueryPromiseCache=null,this._retrievePromiseCache=null,this._retrieveMultiplePromiseCache=null,this._retrieveApplicationMetadataPromiseCache=null,this._userContext=null,this._versionStampFromLocalStore=null,this._appModuleVersionStamps=null,Object(F.d)(e,"serverUri"),this._serverUri=e,this._remoteCallRetryHandler=t,this._retrievePromiseCache=new ar.a,this._retrieveMultiplePromiseCache=new ar.a,this._getClientMetadataQueryPromiseCache=new ke.a,this._retrieveApplicationMetadataPromiseCache=new ke.a,this._eventManager=new rr,this._store=n}get_ClientMetadataQueryPromiseCache(){return this._getClientMetadataQueryPromiseCache}get_isAvailable(){return this.get_remoteDataSource().get_isAvailable()||this.get_LocalDataSource().get_isAvailable()}set_isAvailable(e){return e}get_IsLocalDataSourceAvailable(){return this.get_LocalDataSource().get_isAvailable()}set_IsLocalDataSourceAvailable(e){return this.get_LocalDataSource().set_isAvailable(e),e}get_IsLocalDataSourceAvailableOffline(){return this.get_LocalDataSource().get_IsAvailableOffline()}get_Store(){return this._store}get_IsNetworkAvailable(){return this.get_remoteDataSource().get_isNetworkAvailable()}get_IsWaitingForNetwork(){return this.get_remoteDataSource().get_isWaitingForNetwork()}get_WaitingForNetworkPromise(){return this.get_remoteDataSource().get_waitingForNetworkPromise()}get_EventManager(){return this._eventManager}get_UserContext(){if(!this.isUserContextInitialized())throw Error.invalidOperation("UserContext is not initialized");return this._userContext}set_UserContext(e){return this._userContext=e,e}get_MetadataCache(){return this._metadataCache}set_MetadataCache(e){this._metadataCache=e}get_ApplicationStatusProvider(){return this._applicationStatusProvider}set_ApplicationStatusProvider(e){this._applicationStatusProvider=e}get_ServerUri(){return this._serverUri}get_RemoteCallRetryHandler(){return this._remoteCallRetryHandler}get_IsServerAvailable(){return this.get_remoteDataSource().get_isAvailable()}set_IsServerAvailable(e){return this.get_remoteDataSource().set_isAvailable(e),e}get_LocalDataSource(){return this._localDataSource}_set_LocalDataSource(e){this._localDataSource=e}get_appModuleVersionStamps(){return Object(s.a)(this._appModuleVersionStamps)?{}:this._appModuleVersionStamps}get_remoteDataSource(){return this._remoteDataSource}_set_remoteDataSource(e){return this._remoteDataSource=e,e}get_WebAPIService(){return this._webAPIService}set_WebAPIService(e){this.get_remoteDataSource().setWebAPIService(e),this._webAPIService=e}initialize(e){const t=a.a.createEvent("Init","DataSource").startStopwatch();Object(N.c)("DataSource_Initialize_Start",O.a.storage,this.get_ServerUri());const n=new i.a;return n.always(()=>{t()}),M.a.getInstance().get_PALEnabled()?x.a.get_Instance().add_onReadyOrNow(()=>{this._InitializeLocalDataSource(e,n)}):this._InitializeLocalDataSource(e,n),n}_GetLocalDataSourceInitializationTimeOut(){return M.a.getInstance().get_isMailApp()?2e4:12e4}_CanNullifyStores(){return!!M.a.getInstance().get_isMailApp()||(!M.a.getInstance().get_PALEnabled()||!(M.a.getInstance().get_PALEnabled()&&Ve.a.get_instance().get_offlineDataSource().isOfflineFeatureEnabledForOrganization()&&Ve.a.get_instance().get_offlineDataSource().isAppAvailableOffline()))}_HandleLocalDataSourceInitializeError(e,t){this._CanNullifyStores()?this.get_LocalDataSource().nullifyStores().then(()=>{t.resolve(null)},n=>{Object(N.b)("DataSource_HandleLocalDataSourceInitializeError",O.a.storage,"Nullify store failed with message - "+n.get_Message());const r=A.a.fromErrorCodeAndMessage(-2147094e3,e);r.chainError(n),t.reject(r)}):(Object(N.b)("DataSource_HandleLocalDataSourceInitializeError",O.a.storage,e+" : Nullify store is not possible , fail with DataSourceInitializeFailedErrorCode"),t.reject(A.a.fromErrorCodeAndMessage(-2147094e3,e)))}_InitializeLocalDataSource(e,t){const n=this._GetLocalDataSourceInitializationTimeOut();let r=!1;const a=window.setTimeout(()=>{const e="LocalDataSource initialize timeout after "+n+" milliseconds.";Object(N.e)("DataSource_InitializeLocalDataSource_Initialize",O.a.storage,e),r=!0,this._HandleLocalDataSourceInitializeError(e,t)},n);this.get_LocalDataSource().initialize(e).then(()=>{if(r){window.clearTimeout(a);const r="LocalDataSource Initialize completed even after timeout of "+n+" milliseconds,  reinitialize the stores to null stores. cache mode = "+e;Object(N.e)("DataSource_InitializeLocalDataSource_Initialize",O.a.storage,r),this._HandleLocalDataSourceInitializeError(r,t)}else this.syncInitialData().then(e=>{window.clearTimeout(a),t.resolve(e)},e=>{if(window.clearTimeout(a),!r){Object(N.e)("DataSource_InitializeLocalDataSource_Initialize_SyncInitialData_Error",O.a.storage,e.get_Message());const n="LocalDataSource Initialize succeded but SyncInitialData failed with error message - "+e.get_Message();this._HandleLocalDataSourceInitializeError(n,t)}})},e=>{Object(N.e)("DataSource_InitializeLocalDataSource_Initialize_Error",O.a.storage,e.get_Message()),window.clearTimeout(a),this._HandleLocalDataSourceInitializeError("Local data source initialization failed with "+e.get_Message(),t)})}upgrade(){return this.get_LocalDataSource().upgrade()}pullPersonalizations(){return this.get_LocalDataSource().pullPersonalizations()}pushPersonalizations(e){return this.get_LocalDataSource().pushPersonalizations(e)}syncInitialData(){const e=new i.a;return this.get_LocalDataSource().retrieveUserContext().then(t=>{Object(s.a)(t)?e.resolve(null):Object(k.a)([this.initializeUIStrings(!0),this.get_LocalDataSource().retrieveApplicationMetadataVersionStamps(),this.get_LocalDataSource().getIsActivityFlags(),this.get_LocalDataSource().getInitialEntities()]).then(n=>{if(n.length>0){const[,r,a,i]=n,o=t;this.set_UserContext(o),this._UserContextLoaded(o),Object(s.a)(r)||(Object(s.a)(r[""])||(this._versionStampFromLocalStore=r[""],o.set_MetadataLastModifiedTime(this._versionStampFromLocalStore)),delete r[""],this._appModuleVersionStamps=r),e.resolve(o),Object(s.a)(a)||this.get_MetadataCache().cacheIsActivityFlags(a),Object(s.a)(i)||this.get_MetadataCache().cacheInitialEntities(i)}else e.resolve(null)},t=>{Object(N.e)("DataSource_SyncInitialData_Error",O.a.storage,"RetrieveUserContext failed in DeferredPromiseHelper bulk call"),e.reject(t)})},t=>{Object(N.e)("DataSource_SyncInitialData_Error",O.a.storage,"RetrieveUserContext failed"),e.reject(t)}),e}updateApplicationMetadataVersionStamps(e){return this.get_LocalDataSource().updateApplicationMetadataVersionStamps(e)}getClientMetadata(e,t,n,r){const a=new i.a;let c=e.toString();Object(Xn.f)(this._store.getState(),Qn.oe)&&e.MetadataType===ur.a.AppModules&&(c=e.toString()+(null==t?void 0:t.toString()));let l=c;if(n){const e=n.RequestId();l=l+", ClientRequestId: "+e+", IsLocalStoreAvailable: "+(!!this.get_LocalDataSource()&&this.get_LocalDataSource().get_isAvailable()).toString(),n.AppendCallStack("DataSource.GetClientMetadata")}const u=this._getClientMetadataQueryPromiseCache.get(c);if(!Object(s.a)(u))return u.getPromise();if(this._getClientMetadataQueryPromiseCache.put(c,new Le.a(a,l,"GetClientMetadata",t),n),Object(S.m)(this._store.getState(),e,this.get_LocalDataSource().get_isAvailable(),t))Object(y.b)().then(i=>{this._store.dispatch(i.getClientMetadata(e,n,r,t)).then(t=>{var n,r;const i=null==t?void 0:t.finalRetrievalStrategy;!this.get_LocalDataSource().get_isAvailable()||this.get_ApplicationStatusProvider().isOfflineSyncDone()||"entity"===e.MetadataType||i!==Q.a.Remote||Object(d.l)(this._store.getState())&&null===(Object(d.l)(this._store.getState())&&o.a.tryParseOrNull(null===(r=null===(n=Object(m.e)(this._store.getState()))||void 0===n?void 0:n.offlineProfile)||void 0===r?void 0:r.ProfileId))?a.resolve(t):this.get_LocalDataSource().StoreApplicationMetadata(t).then(()=>{Object(N.e)("DataSource_GetClientMetadata_StoreApplicationMetadataSuccess",O.a.storage,"Offline sync not complete, updated application metadata stored locally in MDL GetClientMetadata, Query: "+l),a.resolve(t)},this._GetClientMetadataFailure(a,"DataSource_GetClientMetadata_StoreApplicationMetadataError",l))},e=>{const t=_.a.toLegacyErrorStatus(Object(_.c)(e));Object(N.e)("DataSource_GetClientMetadata_Error",O.a.storage,"Error in MDL GetClientMetadata = "+t.get_Message()),a.reject(t)})});else if(t===Q.a.LocalAndRemote)this.get_LocalDataSource().get_isAvailable()?this.get_LocalDataSource().getClientMetadata(e).then(r=>{this.get_remoteDataSource().get_isAvailable()&&this._HasMetadataVersionChanged(r)?this.get_remoteDataSource().getClientMetadata(e,t,n).then(e=>{this.get_ApplicationStatusProvider().isOfflineSyncDone()?a.resolve(e):this.get_LocalDataSource().StoreApplicationMetadata(e).then(()=>{Object(N.e)("DataSource_GetClientMetadata_StoreApplicationMetadataSuccess",O.a.storage,"Offline sync not complete, updated application metadata stored locally, Query: "+l),a.resolve(e)},this._GetClientMetadataFailure(a,"DataSource_GetClientMetadata_StoreApplicationMetadataError",l))},this._GetClientMetadataFailure(a,"DataSource_GetClientMetadata_RemoteError",l)):a.resolve(r)},r=>{if(this.get_remoteDataSource().get_isAvailable())Object(N.e)("DataSource_GetClientMetadata_Error",O.a.storage,"RemoteDataSource is available and error in LocalDataSource.GetClientMetadata, retrying with RemoteDataSource. LocalDataSource failure error message = "+r.get_Message()),this.get_remoteDataSource().getClientMetadata(e,t,n).then(e=>{this.get_ApplicationStatusProvider().isOfflineSyncDone()?a.resolve(e):this.get_LocalDataSource().StoreApplicationMetadata(e).then(()=>{Object(N.e)("DataSource_GetClientMetadata_StoreApplicationMetadataSuccess",O.a.storage,"Offline sync not complete, remote retrieved application metadata stored locally after local error, Query: "+l),a.resolve(e)},this._GetClientMetadataFailure(a,"DataSource_GetClientMetadata_StoreApplicationMetadataError",l))},this._GetClientMetadataFailure(a,"DataSource_GetClientMetadata_RemoteError",l));else{Object(N.e)("DataSource_GetClientMetadata_Error",O.a.storage,"RemoteDataSource is not available and error in LocalDataSource.GetClientMetadata, LocalDataSource failure error message = "+r.get_Message());const e=A.a.fromErrorCode(-2147093999);e.chainError(r),a.reject(e)}}):this.get_remoteDataSource().get_isAvailable()?this.get_remoteDataSource().getClientMetadata(e,t,n).then(this._RetrieveSuccess(a,"DataSource_GetClientMetadata_RemoteEnd",null),this._GetClientMetadataFailure(a,"DataSource_GetClientMetadata_RemoteError",l)):(Object(N.e)("DataSource_GetClientMetadata_Error",O.a.storage,"RemoteDataSource and LocalDataSource are not available so error in GetClientMetadata"),a.reject(A.a.fromErrorCode(-2147093999)));else if(t===Q.a.Local)if(this.get_LocalDataSource().get_isAvailable())this.get_LocalDataSource().getClientMetadata(e).then(e=>{a.resolve(e)},this._GetClientMetadataFailure(a,"DataSource_GetClientMetadata_LocalError",l));else{const t=String.format("LocalDataSource is not available and retrievalStrategy is Local and  GCM Query = {0}",e.toString());Object(N.e)("DataSource_GetClientMetadata_Warning",O.a.storage,t),a.resolve({})}else this.get_remoteDataSource().get_isAvailable()&&t===Q.a.Remote?this.get_remoteDataSource().getClientMetadata(e,t,n).then(e=>{this.get_LocalDataSource().get_isAvailable()&&!this.get_ApplicationStatusProvider().isOfflineSyncDone()?this.get_LocalDataSource().StoreApplicationMetadata(e).then(()=>{Object(N.e)("DataSource_GetClientMetadata_StoreApplicationMetadataSuccess",O.a.storage,"Offline sync not complete, remote retrieved application metadata stored locally, Query: "+l),a.resolve(e)},this._GetClientMetadataFailure(a,"DataSource_GetClientMetadata_StoreApplicationMetadataError",l)):a.resolve(e)},this._GetClientMetadataFailure(a,"DataSource_GetClientMetadata_RemoteError",l)):(Object(N.e)("DataSource_GetClientMetadata_Error",O.a.storage,"RemoteDataSource is not available and retrievalStrategy is remote, so error in GetClientMetadata"),a.reject(A.a.fromErrorCode(-2147093999)));return a}_GetClientMetadataFailure(e,t,n){return r=>{Object(N.e)(t,O.a.storage,`${r.get_Message()}, Query: ${n}`),e.reject(r)}}_HasMetadataVersionChanged(e){if(e&&!this.get_ApplicationStatusProvider().isOfflineSyncDone())for(const t in e){const n={key:t,value:e[t]};for(const e of n.value){if(e.OverallVersionNumber&&this.get_UserContext()&&this.get_UserContext().get_MetadataLastModifiedTime()&&e.OverallVersionNumber<parseInt(this.get_UserContext().get_MetadataLastModifiedTime(),10))return!0;if(e.OverallUserVersionNumber&&this.get_UserContext()&&this.get_UserContext().get_UserMetadataLastModifiedTime()&&e.OverallUserVersionNumber<parseInt(this.get_UserContext().get_UserMetadataLastModifiedTime(),10))return!0}}return!1}syncClientMetadata(e){const t=new i.a;return this.get_LocalDataSource().get_isAvailable()?this.get_LocalDataSource().filterClientMetadata(e).then(e=>{this.get_remoteDataSource().syncClientMetadata(e).then(e=>{this.get_LocalDataSource().StoreApplicationMetadata(e).then(()=>{t.resolve(e)},this._RetrieveFailure(t,"DataSource_SyncClientMetadata_StoreApplicationMetadataError"))},this._RetrieveFailure(t,"DataSource_SyncClientMetadata_RemoteError"))},this._RetrieveFailure(t,"DataSource_SyncClientMetadata_FilterLocalError")):(Object(N.e)("DataSource_SyncClientMetadata_Error",O.a.storage,"Cannot sync, local store is not available"),t.reject(A.a.FromMessage("Cannot sync, local store is not available"))),t}getIsActivityFlags(e){const t=new i.a,n=new Fe.a("isactivityflags",null,null,null,null,!1,H.a.Offline,null,null,null),r=new C.a(o.a.newGuid().guid);return fr.useMDLForGetEntityDefinition?Object(y.b)().then(a=>{if(this.get_remoteDataSource().get_isAvailable())this._store.dispatch(a.getIsActivityFlags(e)).then(e=>{this._storeGetActivityFlagsResult(e,t)},i=>{if(this.get_LocalDataSource().get_isAvailable())this._store.dispatch(a.getClientMetadata(n,r,e,Q.a.Local)).then(e=>{t.resolve(e)},e=>{const r=_.a.toLegacyErrorStatus(Object(_.c)(e));Object(N.e)("ModernDataSource_GetClientMetadata_LocalError",O.a.storage,r.get_Message()),this._getIsActivityFlagsViaLegacyFallBack(t,n)});else{const e=_.a.toLegacyErrorStatus(Object(_.c)(i));Object(N.e)("ModernDataSource_RetrieveEntityDefinitions_LocalError",O.a.storage,e.get_Message()),this._getIsActivityFlagsViaLegacyFallBack(t,n)}});else if(this.get_LocalDataSource().get_isAvailable())this._store.dispatch(a.getClientMetadata(n,r,e,Q.a.Local)).then(e=>{t.resolve(e)},e=>{const r=_.a.toLegacyErrorStatus(Object(_.c)(e));Object(N.e)("ModernDataSource_GetClientMetadata_LocalError",O.a.storage,r.get_Message()),this._getIsActivityFlagsViaLegacyFallBack(t,n)});else{Object(N.e)("DataSource_GetIsActivityFlags",O.a.storage,"Data source not available");const e=A.a.fromErrorCode(-2147093999);t.reject(e)}}):this._getIsActivityFlagsViaLegacyFallBack(t,n),t}getRecentItems(e,t,n,r,a,o,s,c){const l=new i.a;return this.get_remoteDataSource().get_isAvailable()?Object(S.t)(this._store.getState(),v.d.FUNCTION)?Object(y.b)().then(i=>{this._store.dispatch(i.getRecentItems(e,t,n,r,a,o,s,c)).then(e=>{this._RetrieveSuccess(l,"DataSource_GetRecentItems_RemoteEnd",null)(e)},e=>{const t=_.a.toLegacyErrorStatus(Object(_.c)(e));this._RetrieveFailure(l,"DataSource_GetRecentItems_RemoteError")(t)})}):this.get_remoteDataSource().getRecentItems(e,t,n,r,a,o,s).then(this._RetrieveSuccess(l,"DataSource_GetRecentItems_RemoteEnd",null),this._RetrieveFailure(l,"DataSource_GetRecentItems_RemoteError")):this.get_LocalDataSource().getRecentItems(e,t,n,r,a,o,s).then(this._RetrieveSuccess(l,"DataSource_GetRecentItems_LocalEnd",null),this._RetrieveFailure(l,"DataSource_GetRecentItems_LocalError")),l}UpdateRecentItems(e,t,n){const r=new i.a;if(this.get_remoteDataSource().get_isAvailable())Object(S.t)(this._store.getState(),v.d.ACTION)?Object(y.b)().then(a=>{this._store.dispatch(a.updateRecentItems(e,t,n)).then(e=>{this._RetrieveSuccess(r,"DataSource_UpdateRecentItems_RemoteEnd",null)(e)},e=>{const t=_.a.toLegacyErrorStatus(Object(_.c)(e));this._RetrieveFailure(r,"DataSource_UpdateRecentItems_RemoteError")(t)})}):this.get_remoteDataSource().UpdateRecentItems(e,t).then(this._RetrieveSuccess(r,"DataSource_UpdateRecentItems_RemoteEnd",null),this._RetrieveFailure(r,"DataSource_UpdateRecentItems_RemoteError"));else{this._RetrieveFailure(r,"DataSource_UpdateRecentItems_LocalError");const e="Method is not supported by local store";Object(N.b)("DataSource_UpdateRecentItems_LocalError",O.a.storage,e);const t=A.a.FromMessage(e);t.set_ErrorCode(-2147093999),r.reject(t)}return r}applyApplicationMetadataChanges(){return Ve.a.get_instance().applyApplicationMetadataChanges()}createActivityPointerAndAttachmentView(){Ve.a.get_instance().createActivityPointerAndAttachmentView()}isUserContextInitialized(){return!Object(s.a)(this._userContext)}updateSecureContext(){const e=new i.a,t=Ze.a.createSecureContext(this._userContext);return this.get_LocalDataSource().UpdateUserContext(t).then(n=>{this.set_UserContext(t),e.resolve(n)},t=>{e.reject(t)}),e}ping(){return this.get_remoteDataSource().ping()}async retrieveExtendedUserContext(){if(Object(N.d)("Datasource_RetrieveExtendedUserContext_Start",O.a.storage,"?"),!this.get_remoteDataSource().get_isAvailable()){Object(N.e)("Datasource_RetrieveExtendedUserContext_Error",O.a.storage,"RemoteDataSource not available");throw A.a.fromErrorCode(-2147093999)}return await this.get_remoteDataSource().retrieveExtendedUserContext()}retrieveUserContext(){Object(N.d)("DataSource_RetrieveUserContext_Start",O.a.storage,"?");const e=new i.a;if(this.get_remoteDataSource().get_isAvailable())this.get_remoteDataSource().retrieveUserContext().then(t=>{this._UserContextLoaded(t),this.get_LocalDataSource().UpdateUserContext(t).catch(e=>{Object(N.e)("DataSource_UpdateUserContext_Error",O.a.storage,e.get_Message())}),e.resolve(t)},t=>{!Object(s.a)(t)&&A.a.isAuthenticationErrorCode(t.get_ErrorCode())?(Object(N.e)("DataSource_RetrieveUserContext_Error",O.a.storage,"Authentication ErrorCode:"+t.get_ErrorCode()),e.reject(t)):(Object(N.e)("DataSource_RetrieveUserContext_Error",O.a.storage,"Non Authentication ErrorCode"),e.reject(t))});else{Object(N.e)("DataSource_RetrieveUserContext_Error",O.a.storage,"RemoteDataSource not available");const t=A.a.fromErrorCode(-2147093999);e.reject(t)}return e}retrieveLocalDataSourceUserContext(){if(Object(N.d)("DataSource_RetrieveLocalDataSourceUserContext_Start",O.a.storage,"?"),!fr.useMDLForUserContextDuringBoot||Object(p.a)(this._store.getState())===lr.a.Browser)return this._localDataSource.retrieveUserContext();try{const e=new i.a;return this.get_LocalDataSource().get_isAvailable()?(Object(N.d)("DataSource_RetrieveLocalDataSourceUserContext_Start",O.a.storage,"get from mdl"),this._getUserContextFromMDS(Q.a.Local,e)):(Object(N.e)("DataSource_RetrieveLocalDataSourceUserContext_MDL",O.a.storage,"Offline data source not initialized"),e.resolve(null)),e}catch(e){return Object(N.b)("DataSource_RetrieveLocalDataSourceUserContext_MDL",O.a.storage,"Error in mdl code path try in legacy way to get user context"),this._localDataSource.retrieveUserContext()}}_getIsActivityFlagsViaLegacyFallBack(e,t){if(fr.useMDLForGetEntityDefinition&&Object(N.e)("ModernDataSource_RetrieveEntityDefinitions_Error",O.a.storage,"Failed to retrieve isActivityFlags in MDL, fallback to legacy path"),this.get_remoteDataSource().get_isAvailable())this.get_remoteDataSource().getIsActivityFlags().then(t=>{this._storeGetActivityFlagsResult(t,e)},n=>{this.get_LocalDataSource().get_isAvailable()?this.get_LocalDataSource().getClientMetadata(t).then(t=>{e.resolve(t)},this._RetrieveFailure(e,"DataSource_GetClientMetadata_LocalError")):(Object(N.e)("DataSource_RetrieveEntityDefinitions_LocalError",O.a.storage,n.get_Message()),e.reject(n))});else if(this.get_LocalDataSource().get_isAvailable())this.get_LocalDataSource().getClientMetadata(t).then(t=>{e.resolve(t)},this._RetrieveFailure(e,"DataSource_GetClientMetadata_LocalError"));else{Object(N.e)("DataSource_GetIsActivityFlags",O.a.storage,"Data source not available");const t=A.a.fromErrorCode(-2147093999);e.reject(t)}}_storeGetActivityFlagsResult(e,t){if(this.get_LocalDataSource().get_isAvailable()&&!this.get_ApplicationStatusProvider().isOfflineSyncDone()){const n={};n.IsActivityFlags=e,this.get_LocalDataSource().StoreApplicationMetadata(n).then(()=>{t.resolve(e)},this._RetrieveFailure(t,"DataSource_RetrieveEntityDefinitions_StoreApplicationMetadataError"))}else t.resolve(e)}_getUserContextFromMDS(e,t){Object(y.b)().then(n=>{this._store.dispatch(n.getUserContext(e)).then(n=>{Object(N.d)("DataSource_RetrieveUserContext_MDL",O.a.storage,"?"),e===Q.a.Remote&&(this._UserContextLoaded(n),this.get_LocalDataSource().UpdateUserContext(n).catch(e=>{Object(N.e)("DataSource_UpdateUserContext_Error",O.a.storage,e.get_Message())})),t.resolve(n)},e=>{const t=Object(_.c)(e);return Object(N.b)("DataSource_RetrieveUserContextError_MDL",O.a.storage,"Error in MDL GetClientMetadata = "+t.message+t.stack),this._localDataSource.retrieveUserContext()})})}_UserContextLoaded(e){if(e.get_isErrorContext())return;L.a.set_instance(new L.a(e.get_TimeZoneUtcOffsetMinutes(),e.get_TimeZoneAdjusters()));const t=e.get_UserSettings().get_formatInfoCultureName(),n=e.get_UserSettings().get_numberFormatInfo(),r=e.get_UserSettings().get_dateTimeFormatInfo();this.setCurrentCultureInfo(t,n,r),Object(s.a)(e)||Object(s.a)(this.get_remoteDataSource())||this.get_remoteDataSource().set_settings(new X(e.get_organizationSettings()))}setCurrentCultureInfo(e,t,n){Sys.CultureInfo.CurrentCulture.name=e,Sys.CultureInfo.CurrentCulture.numberFormat=t,Sys.CultureInfo.CurrentCulture.dateTimeFormat=n}createEmptyEntityRecord(e,t){Object(N.d)("DataSource_CreateEmptyEntityRecord_Start",O.a.storage,e);const n=new i.a,r=t instanceof B.a?t.get_Columns():null;return this.getAttributeTypes(e,r,null).then(t=>{Object(N.d)("DataSource_CreateEmptyEntityRecord_End",O.a.storage,e),this._GetFieldsWithDefaultValue(e,r).then(r=>{const a=new q.a(new W.a(e,R.a.get_empty()),r,t,{},{},new K.a(new Array(0)));for(const e in r){const t={key:e,value:r[e]};a.markFieldChanged(t.key)}n.resolve(a)})},t=>{Object(N.e)("DataSource_CreateEmptyEntityRecord_Error",O.a.storage,e),n.reject(t)}),n}_GetFieldsWithDefaultValue(e,t){const n=new i.a,r={};return this.retrieveMultipleAttributeMetadata(new $.a(e,t),null).then(e=>{for(const t of e)if(t.get_type()||Object(s.a)(t.get_defaultValue())){if(t.get_type()===f.a.PickList&&!Object(s.a)(t.get_defaultFormValue())){const e=t.get_defaultFormValue();-1!==e&&(r[t.get_logicalName()]=new G.a(t.get_optionSet().get_options()[e.toString()].get_Label(),e,-1,-1,t.get_optionSet().get_options()[e.toString()].get_allowedStatusTransitions(),t.get_optionSet().get_options()[e.toString()].get_color(),t.get_optionSet().get_options()[e.toString()].get_invariantName()))}}else t.get_defaultValue()?r[t.get_logicalName()]=new G.a(t.get_optionSet().get_options()[1].get_Label(),1,-1,-1,null,null,null):r[t.get_logicalName()]=new G.a(t.get_optionSet().get_options()[0].get_Label(),0,-1,-1,null,null,null);n.resolve(r)},()=>{n.resolve(r)}),n}clearAllMetadata(e){const t=new i.a;return this.get_LocalDataSource().clearAllMetadataStores(e).then(()=>{t.resolve(!0)},e=>{t.reject(e)}),t}clearEntityAttributeApplicationMetadata(){const e=new i.a;return this.get_LocalDataSource().clearEntityAttributeApplicationMetadataStores().then(()=>{e.resolve(!0)},t=>{e.reject(t)}),e}clearAllData(){const e=new i.a;return this.get_LocalDataSource().clearAllDataStores().then(()=>{e.resolve(!0)},t=>{e.reject(t)}),e}create(e,t,n,r){var a;Object(N.d)("DataSource_Create_Start",O.a.storage,e.get_identifier().toString());const o=new i.a;let s;const u=Object(l.q)(this._store.getState(),null===(a=e.get_identifier())||void 0===a?void 0:a.LogicalName);return this.get_remoteDataSource().get_isAvailable()&&!u?s=this.get_remoteDataSource().create(e,t,n,r):(e.set_clientRetrieveOptions(new V.a(U.a.NotCached,0)),s=this.get_LocalDataSource().create(e,t,n,r)),s.then(t=>{u&&this._store.dispatch(Object(c.initializeOfflineUpsyncProcessAsyncAction)(!0)),Object(N.d)("DataSource_Create_Success",O.a.storage,e.get_identifier().toString()),o.resolve(t)},e=>{Object(N.e)("DataSource_Create_Error",O.a.storage,e.get_Message()),o.reject(e)}),o}retrieve(e,t,n,r,a,i,o,s){return this.retrieveRelatedEntities(e,t,t,null,n,r,a,o,i,s)}_convertLegacyBPFRequestToODataRequest(e){return e?new h.a(e.get_target()?w.a.legacyToExternalEntityReference(e.get_target()):null,e.get_processId()?w.a.legacyToExternalEntityReference(e.get_processId()):null,e.get_processInstanceId()?w.a.legacyToExternalEntityReference(e.get_processInstanceId()):null):null}_executeRetrieveViaMDL(e,t,n,r,a,o,s){const c=new i.a;return Object(y.b)().then(i=>{this._store.dispatch(i.retrieve(w.a.fromLegacyEntityReference(e),t instanceof B.a?t.get_Columns():null,r,a?this._convertLegacyBPFRequestToODataRequest(a):null,s,o,n.get_retrievalStrategy())).then(t=>{t&&(t.get_clientRetrieveOptions().get_retrievalStrategy()===Q.a.Local?this._RetrieveEntityRecordSuccess(e,c,"DataSource_Retrieve_LocalEnd",e.toString(),r)(t):this._RetrieveRemoteSuccess(e,c,n,r,s)(t))},t=>{const a=_.a.toLegacyErrorStatus(Object(_.c)(t)),i=Object(d.i)(this._store.getState())&&Object(l.n)(this._store.getState(),e.LogicalName);n.get_retrievalStrategy()===Q.a.Local||i||!Object(b.d)(this._store.getState())&&Object(l.n)(this._store.getState(),e.LogicalName)?this._RetrieveLocalFailure(e,c,"DataSource_Retrieve_LocalError")(a):this._RetrieveRemoteFailure(e,c,"DataSource_Retrieve_RemoteError",r)(a)})}),c}retrieveRelatedEntities(e,t,n,r,a,i,o,c,u,d){if(Object(N.d)("DataSource_RetrieveRelatedEntities_Start",O.a.storage,e.toString()),Object(s.a)(d)&&(d=Object(S.p)(this._store.getState(),a.get_retrievalStrategy())&&!r),d)return this._executeRetrieveViaMDL(e,t,a,i,o,c,u);a=this._AdjustClientRetrieveOptions(a);const p=Object(l.q)(this._store.getState(),e.LogicalName);return p&&a.set_retrievalStrategy(Q.a.Local),this._RetrieveWithStrategy(a.get_retrievalStrategy(),this._retrievePromiseCache,e.get_key(),t,i,(s,l)=>{switch(s){case 0:this.get_LocalDataSource().retrieveRelatedEntities(e,t,n,r,a,i,o,c,u).then(this._RetrieveEntityRecordSuccess(e,l,"DataSource_Retrieve_LocalEnd",e.toString(),i),s=>{if(Object(N.d)("DataSource_Retrieve_LocalError",O.a.storage,s.get_Message()),!p&&this.get_remoteDataSource().get_isAvailable())this.get_remoteDataSource().retrieveRelatedEntities(e,t,n,r,a,i,o,c,u).then(t=>{Object(N.d)("DataSource_Retrieve_RemoteEnd",O.a.storage,e.toString()),V.a.shouldBeCached(a)&&this.get_LocalDataSource().cache(t,i,u),this.get_EventManager().OnRetrieved({key:e.get_key(),data:null,retrieveState:sr.a.Success,sourceStore:cr.a.Remote}),l.resolve(t)},t=>{Object(N.d)("DataSource_Retrieve_RemoteError",O.a.storage,t.get_Message()),this.get_EventManager().OnRetrieved({key:e.get_key(),data:null,retrieveState:sr.a.Error,sourceStore:cr.a.Remote}),l.reject(t)});else{const t=A.a.fromErrorCode(Ve.a.get_instance().get_offlineDataSource().isOfflineAvailableForUse()?-2147220969:-2147093999);this.get_EventManager().OnRetrieved({key:e.get_key(),data:null,retrieveState:sr.a.Error,sourceStore:0}),l.reject(t)}});break;case Q.a.Remote:this.get_remoteDataSource().retrieveRelatedEntities(e,t,n,r,a,i,o,c,u).then(this._RetrieveRemoteSuccess(e,l,a,i,u),this._RetrieveRemoteFailure(e,l,"DataSource_Retrieve_RemoteError",i));break;case Q.a.LocalAndRemote:this.get_LocalDataSource().retrieveRelatedEntities(e,t,n,r,a,i,o,c,u).then(this._RetrieveEntityRecordSuccess(e,l,"DataSource_Retrieve_LocalEnd",e.toString(),i),e=>{Object(N.b)("DataSource_Retrieve_LocalError",O.a.storage,e.get_Message())}),this.get_remoteDataSource().retrieveRelatedEntities(e,t,n,r,a,i,o,c,u).then(this._RetrieveRemoteSuccess(e,l,a,i,u),this._RetrieveRemoteFailureWhenOnline(e,l,"DataSource_Retrieve_RemoteError",i))}return l})}_AdjustClientRetrieveOptions(e){return Object(s.a)(e)&&(e=new V.a(U.a.NotCached,Q.a.Remote)),this.get_remoteDataSource().get_isAvailable()?this.get_IsLocalDataSourceAvailable()||e.get_retrievalStrategy()!==Q.a.LocalAndRemote||e.set_retrievalStrategy(Q.a.Remote):e.set_retrievalStrategy(0),Object(T.b)()&&(e.set_retrievalStrategy(Q.a.Remote),e.set_cachePriority(U.a.NotCached)),e}retrieveMultiple(e,t,n,r){Object(N.d)("DataSource_RetrieveMultiple_Start",O.a.storage,e.toString()),t=this._AdjustClientRetrieveOptions(t);const a=Object(l.q)(this._store.getState(),e.get_EntityLogicalName());return a&&t.set_retrievalStrategy(Q.a.Local),this._RetrieveWithStrategy(t.get_retrievalStrategy(),this._retrieveMultiplePromiseCache,e.get_DataLayerInternalCachingKey(),e.get_ColumnSet(),n,(i,o)=>{switch(i){case 0:this.get_LocalDataSource().retrieveMultiple(e,t,n,r).then(this._RetrieveSuccess(o,"DataSource_RetrieveMultiple_End",e.toString()),i=>{if(Object(N.d)("DataSource_RetrieveMultiple_LocalError",O.a.storage,i.get_Message()),!a&&this.get_remoteDataSource().get_isAvailable())this.get_remoteDataSource().retrieveMultiple(e,t,n,r).then(r=>{Object(N.d)("DataSource_RetrieveMultiple_RemoteEnd",O.a.storage,e.toString()),V.a.shouldBeCached(t)&&this.get_LocalDataSource().cacheMultiple(e,r,n),o.resolve(r)},this._RetrieveFailure(o,"DataSource_RetrieveMultiple_RemoteError"));else{const e=A.a.fromErrorCode(-2147093999);e.set_InnerError(i),o.reject(e)}});break;case Q.a.Remote:this.get_remoteDataSource().retrieveMultiple(e,t,n,r).then(this._RetrieveMultipleRemoteSuccess(e,o,t,n),this._RetrieveMultipleFailure(e,o,"DataSource_RetrieveMultiple_RemoteError",n));break;case Q.a.LocalAndRemote:this.get_LocalDataSource().retrieveMultiple(e,t,n,r).then(this._RetrieveSuccess(o,"DataSource_RetrieveMultiple_LocalEnd",e.toString()),e=>{Object(N.b)("DataSource_RetrieveMultiple_LocalError",O.a.storage,e.get_Message())}),this.get_remoteDataSource().retrieveMultiple(e,t,n,r).then(this._RetrieveMultipleRemoteSuccess(e,o,t,n),this._RetrieveMultipleFailure(e,o,"DataSource_RetrieveMultiple_RemoteError",n))}return o})}retrieveEntitiesForAggregateQuery(e,t,n){const r=new Y.a(e,t);Object(N.d)("DataSource_RetrieveEntitiesForAggregateQuery_Start",O.a.storage,r.toString());const a=new i.a;return this.get_remoteDataSource().get_isAvailable()?this.get_remoteDataSource().retrieveEntitiesForAggregateQuery(e,t,n).then(e=>{Object(N.d)("DataSource_RetrieveEntitiesForAggregateQuery_End",O.a.storage,r.toString()),a.resolve(e)},e=>{Object(N.d)("DataSource_RetrieveEntitiesForAggregateQuery_Error",O.a.storage,e.get_Message()),a.reject(e)}):a.reject(A.a.fromErrorCode(-2147093999)),a}update(e,t,n,r,a){Object(N.d)("DataSource_Update_Start",O.a.storage,e.toString());const o=new i.a,s=Object(l.q)(this._store.getState(),e.LogicalName);return this.get_remoteDataSource().get_isAvailable()&&!s?this.get_remoteDataSource().update(e,t,n,r,a).then(n=>{Object(N.d)("DataSource_Update_RemoteCreateEnd",O.a.storage,e.toString()),this.get_LocalDataSource().cache(t,r,a),o.resolve(n)},e=>{Object(N.d)("DataSource_Update_RemoteError",O.a.storage,e.get_Message()),o.reject(e)}):this.get_LocalDataSource().update(e,t,n,r,a).then(e=>{s&&this._store.dispatch(Object(c.initializeOfflineUpsyncProcessAsyncAction)(!0)),o.resolve(e)},e=>{o.reject(e)}),o}Delete(e,t){Object(N.d)("DataSource_Delete_Start",O.a.storage,e.toString());const n=new i.a,r=Object(l.q)(this._store.getState(),e.LogicalName);return this.get_remoteDataSource().get_isAvailable()&&!r?this.get_remoteDataSource().Delete(e,t).then(e=>{this._DeleteFromLocalStore(e,t).then(e=>{n.resolve(e)},e=>{Object(N.d)("DataSource_Delete_LocalDeleteError",O.a.storage,e.get_Message()),n.reject(e)})},e=>{Object(N.d)("DataSource_Delete_RemoteError",O.a.storage,e.get_Message()),n.reject(e)}):Ve.a.get_instance().get_offlineDataSource().isOfflineAvailableForUse()?this._DeleteFromLocalStore(e,t).then(e=>{r&&this._store.dispatch(Object(c.initializeOfflineUpsyncProcessAsyncAction)(!0)),n.resolve(e)},e=>{Object(N.d)("DataSource_Delete_LocalDeleteError",O.a.storage,e.get_Message()),n.reject(e)}):n.reject(A.a.fromErrorCode(-2147093999)),n}_DeleteFromLocalStore(e,t){const n=new i.a;if(Object(S.t)(this._store.getState(),v.d.DELETE)){const r=w.a.legacyToExternalEntityReference(e),a=new g.c(r);this.executeOData(a,t).then(()=>{n.resolve(e)}).catch(t=>{Object(N.d)("DataSource_Delete_LocalDeleteEnd : Unable to delete from local store",O.a.storage,e.toString()),n.reject(t)})}else this.get_LocalDataSource().Delete(e,t).then(()=>{Object(N.d)("DataSource_Delete_LocalDeleteEnd",O.a.storage,e.toString()),n.resolve(e)},e=>{n.reject(e)});return n}execute(e,t,n=Q.a.Default,r={},a,o,s){var d;Object(N.d)("DataSource_Execute_Start",O.a.storage,e.toString());const p=null==a?void 0:a.TraceManager.getTracer("DataSource.execute");if(Object(S.q)(this._store.getState(),e))return new i.a(this._executeViaMDL(e,s,t,n,r,o));if(this._logNonMdlExecutionToTelemetry(e,p,o),n===Q.a.Default){if(e instanceof E.a&&Object(l.q)(this._store.getState(),null===(d=e.get_entityNames())||void 0===d?void 0:d[0])||e instanceof I.a&&Object(l.q)(this._store.getState(),e.get_targetEntityName()))return this.get_LocalDataSource().execute(e,t);if(Object(m.r)(this._store.getState())&&Object(u.D)(this._store.getState())&&e instanceof We.a&&this._isValidOfflineExecuteMultipleRequest(e)||(e instanceof qe.a||e instanceof Ye.a)&&Object(l.q)(this._store.getState(),e.get_target().get_identifier().LogicalName))return this.get_LocalDataSource().execute(e,t).then(e=>{const t=(new i.a).resolve(e);return this._store.dispatch(Object(c.initializeOfflineUpsyncProcessAsyncAction)(!0)),t},n=>-2147093999===n.get_ErrorCode()?this._executeInternal(e,t,s):(new i.a).reject(n))}return this._executeInternal(e,t,s,n)}_logNonMdlExecutionToTelemetry(e,t,n=[]){n.push({name:"RequestName",value:e.get_name()}),e instanceof We.a&&n.push({name:"ExecuteMultipleInnerRequests",value:e.get_requests().map(e=>e.get_name()).join(", ")}),null==t||t.warn("[DataSource.execute] Executing non-mdl code path for Datasource.execute with request type: "+e.get_name(),n)}_isValidOfflineExecuteMultipleRequest(e){for(const t of e.get_requests()){if(t instanceof He.a)continue;const e=t instanceof qe.a||t instanceof Ye.a?t.get_target():null;if(Object(s.a)(e)||!Object(l.n)(this._store.getState(),e.get_identifier().LogicalName))return!1}return!0}_executeInternal(e,t,n,r=Q.a.Default){if(this.get_remoteDataSource().get_isAvailable()&&r!==Q.a.Local){e instanceof ir&&(e=e.get_request());const r=new i.a;return this.get_remoteDataSource().execute(e,t).then(a=>{if(a instanceof or.a)this._HandleRetrieveResponse(e,a,null,t,n);else if(a instanceof $e.a){const r=a;for(const a of r.get_responses())a.get_response()instanceof or.a&&this._HandleRetrieveResponse(e.get_requests()[a.get_requestIndex()],a.get_response(),a.get_fault(),t,n)}r.resolve(a)},e=>{r.reject(e)}),r}return e instanceof ir&&!Object(s.a)(e.get_offlineCallback())?e.executeCallback():r!==Q.a.Remote?this.get_LocalDataSource().execute(e,t):(new i.a).reject(A.a.FromMessage("Can't execute 'Online' request as server is NOT available"))}async _executeViaMDL(e,t,n,r=Q.a.Default,a={},i=[]){const o=await Object(y.b)();return this._store.dispatch(o.execute(e,this._store,t,r,n,i,a))}executeOData(e,t,n=Q.a.Default,r=[],a={},o,c){if(Object(S.s)(this._store.getState(),e)||Object(S.v)(this._store.getState(),e))return new i.a(this._executeODataViaMDL(e,t,o,n,r,a,c));if(Object(N.d)("DataSource_ExecuteOData_Start",O.a.storage,e.toString()),this.get_remoteDataSource().get_isAvailable()){const n=new i.a;return this.get_remoteDataSource().executeOData(e,t,void 0,void 0,a).then(r=>{if(2===e.getMetadata().operationType&&"delete"===e.getMetadata().operationName.toLowerCase()){const n="entityType",r="id",a="entityreference";for(const i in e){const o={key:i,value:e[i]};if(o.key.toLowerCase()===a&&!Object(s.a)(o.value[n])&&!Object(s.a)(o.value[r])){const e=new W.a(o.value[n],R.a.tryCreate(o.value[r]));this.get_LocalDataSource().Delete(e,t);break}}}n.resolve(r)},e=>{n.reject(e)}),n}return this.get_LocalDataSource().executeOData(e,t)}async _executeODataViaMDL(e,t,n,r=Q.a.Default,a=[],i={},o){const s=await Object(y.b)();return this._store.dispatch(s.executeOData(e,r,t,a,i,n,o))}retrieveEntityMetadata(e,t,n){Object(N.d)("DataSource_RetrieveEntityMetadata_Start",O.a.storage,e);const r=new i.a,a=this.get_MetadataCache().getEntityMetadata(e);if(a)return r.resolve(a),r;let o=null;Object(s.b)(e)||(o='{\\"'+e+'\\":[]}');const c=new Fe.a("entity",o,null,null,new Array(0),!1,H.a.OnDemandWithContext,null,null,null);return this.getClientMetadata(c,Q.a.LocalAndRemote,t,n).then(e=>{let t=null;e.Entities&&(t=z.a.createFromOData(e.Entities[0]),Object(s.a)(t)||this.get_MetadataCache().cacheEntityMetadata(t)),r.resolve(t)},e=>{r.reject(e)}),r}retrieveMultipleAttributeMetadata(e,t){Object(N.d)("DataSource_RetrieveMultipleAttributeMetadata_Start",O.a.storage,e.toString());const n=new i.a;if(Object(s.a)(e.get_AttributeNames()))this.retrieveEntityMetadata(e.get_EntityLogicalName(),t).then(r=>{const a=r,i=this._metadataCache.getMultipleAttributeMetadata(e.get_EntityLogicalName(),e.get_AttributeNames());Object(s.a)(i)||!Object(s.a)(a.get_attributeNames())&&a.get_attributeNames().length!==i.length?this.get_LocalDataSource().retrieveMultipleAttributeMetadata(e,t).then(t=>{Object(N.d)("DataSource_RetrieveMultipleAttributeMetadata_LocalEnd",O.a.storage,e.toString()),n.resolve(t)},this._RetrieveFailure(n,"DataSource_RetrieveMultipleAttributeMetadata_LocalError")):(Object(N.d)("DataSource_RetrieveMultipleAttributeMetadata_CacheEnd",O.a.storage,e.toString()),n.resolve(i))},e=>{Object(N.d)("DataSource_RetrieveMultipleAttributeMetadata_LocalError",O.a.storage,e.get_Message()),n.reject(e)});else if(e.get_AttributeNames().length){let r=this.get_MetadataCache().getMultipleAttributeMetadata(e.get_EntityLogicalName(),e.get_AttributeNames());if(Object(s.a)(r)&&(r=new Array(0)),r.length===e.get_AttributeNames().length)n.resolve(r);else{let a=this._GetMissingAttributes(e.get_AttributeNames(),r);const i=new $.a(e.get_EntityLogicalName(),a);this.get_LocalDataSource().retrieveMultipleAttributeMetadata(i,t).then(o=>{if(this.get_MetadataCache().cacheAttributeMetadata(i.get_EntityLogicalName(),!1,o),o.push(...r),o.length===e.get_AttributeNames().length)Object(N.d)("DataSource_RetrieveMultipleAttributeMetadata_LocalEnd",O.a.storage,e.toString()),n.resolve(o);else if(this.get_IsServerAvailable()){a=this._GetMissingAttributes(a,o);const r=new $.a(e.get_EntityLogicalName(),a);this._GetRemoteAttributeMetadata(r,t,o,n)}else n.resolve(o)},()=>{this.get_IsServerAvailable()?this._GetRemoteAttributeMetadata(i,t,r,n):n.reject(A.a.fromErrorCode(-2147093999))})}}else Object(N.d)("DataSource_RetrieveMultipleAttributeMetadata_End",O.a.storage,e.toString()),n.resolve([]);return n}getAttributeTypesForEntities(e,t,n,r,a){const o=new i.a;return this.getAttributeTypes(e,n,a).then(e=>{if(!Object(s.a)(r)&&!Object(s.a)(t))for(const n of t)n in r&&(e[n]=f.a.AliasedValue);o.resolve(e)},e=>{Object(N.d)("DataSource_GetAttributeTypesForEntities_Error.",O.a.storage,e.get_Message()),o.reject(e)}),o}getAttributeTypes(e,t,n){const r=new i.a,a=this.get_MetadataCache().getAttributeTypes(e,t);let o=[];const c=Object(s.a)(t)||!t.length;if(c||(o=t.filter(e=>!(e in a))),o.length>0||c){const t=c?null:o;this.retrieveMultipleAttributeMetadata(new $.a(e,t),n).then(t=>{for(let e=0;e<t.length;e++){const n=t[e];a[n.get_logicalName()]=n.get_type()}this.get_MetadataCache().cacheAttributeMetadata(e,c,t),Object(N.d)("Successfully returning attribute types dictionary",O.a.storage,""),r.resolve(a)},e=>{Object(N.b)("DataSource_GetAttributeTypes_Error",O.a.storage,e.get_Message()),r.reject(e)})}else Object(N.d)("Successfully returning attribute types dictionary",O.a.storage,""),r.resolve(a);return r}_GetMissingAttributes(e,t){const n={};for(let e=0;e<t.length;e++)n[t[e].get_logicalName()]=null;const r=new Array(0);for(const t of e)t in n||r.push(t);return r}_GetRemoteAttributeMetadata(e,t,n,r){this.get_remoteDataSource().retrieveMultipleAttributeMetadata(e,t).then(t=>{this.get_MetadataCache().cacheAttributeMetadata(e.get_EntityLogicalName(),!1,t),t.push(...n),Object(T.b)()&&this.get_LocalDataSource().createMultipleAttributeMetadata(t),Object(N.d)("DataSource_RetrieveMultipleAttributeMetadata_RemoteEnd",O.a.storage,e.toString()),r.resolve(t)},this._RetrieveFailure(r,"DataSource_RetrieveMultipleAttributeMetadata_RemoteError"))}retrieveApplicationMetadata(e,t){Object(N.d)("DataSource_RetrieveApplicationMetadata_Start",O.a.storage,e.toString());const n=new i.a;return this.get_LocalDataSource().retrieveApplicationMetadata(e,t).then(this._RetrieveSuccess(n,"DataSource_RetrieveApplicationMetadata_LocalEnd",e.toString()),e=>{n.reject(e)}),n}retrieveMultipleApplicationMetadata(e,t){return this._RetrieveMultipleApplicationMetadataInternal(e,!1,t,!1)}_RetrieveMultipleApplicationMetadataInternal(e,t,n,r){const a=e.toString();Object(N.d)("DataSource_RetrieveMultipleApplicationMetadata_Start",O.a.storage,a);const o=new i.a,c=this._retrieveApplicationMetadataPromiseCache.get(a);return Object(s.a)(c)||t?(this._retrieveApplicationMetadataPromiseCache.put(a,new Le.a(o,a,"RetrieveMultipleApplicationMetadata")),this.get_LocalDataSource().retrieveMultipleApplicationMetadata(e,n).then(e=>{Object(N.d)("DataSource_RetrieveMultipleApplicationMetadata",O.a.storage,"From database - Query : "+a+" callbacksafeArrayLength : "+e.length.toString()),o.resolve(e)},e=>{Object(N.b)("DataSource_RetrieveMultipleApplicationMetadata:Failed in LocalDataSource.RetrieveMultipleApplicationMetadata",O.a.storage,e.get_Message()),o.reject(e)})):(Object(N.d)("DataSource_RetrieveMultipleApplicationMetadata",O.a.storage,"Waiting for pending retrieve to finish - Query : "+a),c.getPromise().always(()=>{this._RetrieveMultipleApplicationMetadataInternal(e,!0,n,r).then(e=>{o.resolve(e)},e=>{Object(N.b)("DataSource_RetrieveMultipleApplicationMetadata:Failed in RetrieveMultipleApplicationMetadataInternal",O.a.storage,e.get_Message()),o.reject(e)})})),o}createUserPersonalization(e){return this.get_LocalDataSource().createUserPersonalization(e)}deleteUserPersonalization(e){return this.get_LocalDataSource().deleteUserPersonalization(e)}retrieveUserPersonalization(e){return this.get_IsLocalDataSourceAvailable()?this.get_LocalDataSource().retrieveUserPersonalization(e):(new i.a).resolve(null)}changeProcessAndStage(e,t,n,r,a,o){const s=new i.a;return this.get_remoteDataSource().get_isAvailable()?this.get_remoteDataSource().changeProcessAndStage(e,t,n,r,a,o).then(this._RetrieveSuccess(s,"DataSource_ChangeProcessAndStage_RemoteEnd",t),this._RetrieveFailure(s,"DataSource_ChangeProcessAndStage_RemoteError")):s.reject(A.a.fromErrorCode(-2147093999)),s}createNavigationEntity(e,t,n,r,a){const o=new i.a;return this.get_remoteDataSource().get_isAvailable()?this.get_remoteDataSource().createNavigationEntity(e,t,n,r,a).then(this._RetrieveSuccess(o,"DataSource_CreateNavigationEntity_RemoteEnd",t.toString()),this._RetrieveFailure(o,"DataSource_CreateNavigationEntity_RemoteError")):o.reject(A.a.fromErrorCode(-2147093999)),o}retrieveNavigationEntities(e,t,n,r,a){const o=new i.a;return this.get_remoteDataSource().get_isAvailable()?this.get_remoteDataSource().retrieveNavigationEntities(e,t,n,r,a).then(this._RetrieveSuccess(o,"DataSource_RetrieveNavigationEntities_RemoteEnd",e),this._RetrieveFailure(o,"DataSource_RetrieveNavigationEntities_RemoteError")):o.reject(A.a.fromErrorCode(-2147093999)),o}retrieveUserLocalFacets(e,t){const n=new i.a;return this.get_remoteDataSource().get_isAvailable()?this.get_remoteDataSource().retrieveUserLocalFacets(e,t).then(this._RetrieveSuccess(n,"DataSource_RetrieveUserLocalFacets_RemoteEnd",e.toString()),this._RetrieveFailure(n,"DataSource_RetrieveUserLocalFacets_RemoteError")):n.reject(A.a.fromErrorCode(-2147093999)),n}saveSessionState(e,t,n,r){const a=new i.a;return this.get_LocalDataSource().saveSessionState(e,t,n).then(e=>{a.resolve(e)},e=>{r?this.get_LocalDataSource().nullifyStores().then(()=>{a.resolve(null)},t=>{Object(N.b)("DataSource_SaveSessionState",O.a.storage,"SaveSessionState failed and then nullify store failed with message - "+e.get_Message()),e.chainError(t),a.reject(e)}):a.reject(e)}),a}retrieveSessionState(e,t){const n=new i.a;return this.get_LocalDataSource().retrieveSessionState(e).then(e=>{n.resolve(e)},r=>{t?this.get_LocalDataSource().nullifyStores().then(()=>{n.resolve(null)},t=>{Object(N.b)("DataSource_RetrieveSessionState",O.a.storage,"RetrieveSessionState failed and then nullify store failed with message - "+r.get_Message()+" :key = "+e),r.chainError(t),n.reject(r)}):(Object(N.b)("DataSource_RetrieveSessionState",O.a.storage,"RetrieveSessionState failed with message - "+r.get_Message()+" :key = "+e),n.reject(r))}),n}retrieveMultipleSessionStates(e,t){const n=new i.a;return this.get_LocalDataSource().retrieveMultipleSessionStates(e).then(e=>{n.resolve(e)},r=>{t?this.get_LocalDataSource().nullifyStores().then(()=>{const e=new Map;n.resolve(e)},t=>{Object(N.b)("DataSource_retrieveMultipleSessionStates",O.a.storage,"retrieveMultipleSessionStates failed and then nullify store failed with message - "+r.get_Message()+" :keys = "+e),r.chainError(t),n.reject(r)}):(Object(N.b)("DataSource_retrieveMultipleSessionStates",O.a.storage,"retrieveMultipleSessionStates failed with message - "+r.get_Message()+" :keys = "+e),n.reject(r))}),n}deleteSessionState(e){return this.get_LocalDataSource().deleteSessionState(e)}saveOfflineInformation(e,t,n){return this.get_LocalDataSource().saveOfflineInformation(e,t,n)}retrieveOfflineInformation(e){return this.get_LocalDataSource().retrieveOfflineInformation(e)}retrieveMultipleOfflineInformation(e){return this.get_LocalDataSource().retrieveMultipleOfflineInformation(e)}deleteOfflineInformation(e){return this.get_LocalDataSource().deleteOfflineInformation(e)}retrieveDataFromOfflineStore(e){return this.get_LocalDataSource().retrieveDataFromOfflineStore(e)}initializeUIStrings(e){const t=new J.a(D.a.uiStrings,Object(T.a)(),"uistrings");Object(N.d)("DataSource_InitializeUIStrings_Start",O.a.storage,t.toString());const n=new i.a;return this._RetrieveMultipleApplicationMetadataInternal(t,!1,null,e).then(e=>{e.length>0?(Object(j.c)(e[0].get_metadata()),n.resolve(!0)):n.resolve(!1)},e=>{Object(T.b)()?n.resolve(!1):(Object(N.b)("DataSource_InitializeUIStrings_LocalError",O.a.storage,e.get_Message()),n.reject(e))}),n}_RetrieveWithStrategy(e,t,n,r,a,o){const c=t.get(n,r,e);if(!Object(s.a)(c))return c;const l=new i.a;return t.put(l,n,r,e,a),Object(s.a)(e)?(this._RetrieveFailure(l,"DataSource_RetrieveMultiple_RetrievalStrategyError"),l):o(e,l)}_RetrieveSuccess(e,t,n){return r=>{Object(N.d)(t,O.a.storage,n),e.resolve(r)}}_RetrieveFailure(e,t){return n=>{Object(N.e)(t,O.a.storage,n.get_Message()),e.reject(n)}}_RetrieveEntityRecordSuccess(e,t,n,r,a){return a=>{Object(N.d)(n,O.a.storage,r),t.resolve(a),this.get_EventManager().OnRetrieved({key:e.get_key(),data:a,retrieveState:sr.a.Success,sourceStore:0})}}_RetrieveRemoteSuccess(e,t,n,r,a){return i=>{Object(N.d)("DataSource_Retrieve_RemoteEnd",O.a.storage,e.toString()),V.a.shouldBeCached(n)&&this.get_LocalDataSource().cache(i,r,a),t.resolve(i),this.get_EventManager().OnRetrieved({key:e.get_key(),data:i,retrieveState:sr.a.Success,sourceStore:cr.a.Remote})}}_RetrieveMultipleRemoteSuccess(e,t,n,r){return a=>{Object(N.d)("DataSource_RetrieveMultiple_RemoteEnd",O.a.storage,e.toString()),V.a.shouldBeCached(n)&&this.get_LocalDataSource().cacheMultiple(e,a,r),t.resolve(a),this.get_EventManager().OnRetrieved({key:e.get_DataLayerInternalCachingKey(),data:a,retrieveState:sr.a.Success,sourceStore:cr.a.Remote})}}_RetrieveMultipleFailure(e,t,n,r){return r=>{Object(N.d)(n,O.a.storage,r.get_Message()),t.reject(r),this.get_EventManager().OnRetrieved({key:e.get_DataLayerInternalCachingKey(),data:null,retrieveState:sr.a.Error,sourceStore:cr.a.Remote})}}_RetrieveRemoteFailure(e,t,n,r){return a=>{Object(N.d)(n,O.a.storage,a.get_Message()),Object(P.a)(a.get_ErrorCode())||this.get_LocalDataSource().uncache(e,r),t.reject(a),this.get_EventManager().OnRetrieved({key:e.get_key(),data:null,retrieveState:sr.a.Deleted,sourceStore:cr.a.Remote})}}_RetrieveLocalFailure(e,t,n){return r=>{Object(N.d)(n,O.a.storage,r.get_Message());const a=A.a.fromErrorCode(Ve.a.get_instance().get_offlineDataSource().isOfflineAvailableForUse()?-2147220969:-2147093999);a.set_InnerError(r),this.get_EventManager().OnRetrieved({key:e.get_key(),data:null,retrieveState:sr.a.Error,sourceStore:0}),t.reject(a)}}_RetrieveRemoteFailureWhenOnline(e,t,n,r){return a=>{Object(N.d)(n,O.a.storage,a.get_Message()),-2147093999!==a.get_ErrorCode()&&this._RetrieveRemoteFailure(e,t,n,r)(a)}}_HandleRetrieveResponse(e,t,n,r,a){const i=e.get_clientRetrieveOptions(),o=t.get_entity();if(Object(s.a)(n)||Object(s.a)(o)){if(!Object(s.a)(o)){o.set_clientRetrieveOptions(i);const t=Object(s.a)(o.get_relatedEntities())?new Array(0):o.get_relatedEntities().get_relatedEntityQueries();o.updateColumnSet(e.get_columnSet(),t),V.a.shouldBeCached(i)&&this.get_LocalDataSource().cache(o,r,a),fr.get_DefaultInstance().get_EventManager().OnRetrieved({key:o.get_identifier().get_key(),data:o,retrieveState:sr.a.Success,sourceStore:cr.a.Remote})}}else fr.get_DefaultInstance().get_EventManager().OnRetrieved({key:o.get_identifier().get_key(),data:o,retrieveState:sr.a.Error,sourceStore:cr.a.Remote})}static get_DefaultInstance(){return pr}static set_DefaultInstance(e){return pr=e,e}static getInstance(e,t,n,r){if(Object(N.c)("DataSource_GetInstance_Start",O.a.storage,e),Object(s.a)(dr[e])){const a=new fr(e,t,r);a.set_ApplicationStatusProvider(n),a._set_remoteDataSource(new nr.a(e,a,t)),a._set_LocalDataSource(new Yn(e,a)),dr[e]=a}return Object(N.c)("DataSource_GetInstance_End",O.a.storage,e),dr[e]}async executeSerializedRequest(e,t,n,r){const a=n||(e.additionalParameters?e.additionalParameters[v.a.TYPE]:null);if(a&&Object(S.u)(this._store.getState(),a)){const n=await Object(y.b)();return await this._store.dispatch(n.executeSerializedRequest(e,t,r,Q.a.Remote))}return this.get_WebAPIService().sendRequest(e,r)}}fr.useMDLForUserContextDuringBoot=!0,fr.useMDLForGetEntityDefinition=!0,fr.MdlBootWithCachedValue=!0},jhff:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return o}));var r=n("FoFY"),a=n("pulT"),i=n("QGYZ");function o(e,t){
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
return function(e,t){const n=Object(r.a)(e,t);return Object(i.b)(e,n.focusedTabId)}(e,t).id}function s(e){const t=Object(a.b)(e);return Object(i.b)(e,t.focusedTabId)}function c(e){return s(e).id}},jjPz:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("Lyxw"),a=n("3/02"),i=n("a8hT"),o=n("Uv1Y");function s(e,t){return{type:t.type,execute:async({getState:n,dispatch:s},c,l)=>{if(Object(r.f)(n(),a.cb)){const r=c.TraceManager.getTracer("MdlProvider"),a=[{name:"Forwarded-Action",value:t.type}];try{const o=(await Object(i.c)()).MdlProvider.getDefaultInstance().getAction(t.type,e,n);if(o)return r.warn("Forwarding action to MDL",a),o.apply(null,e).execute({getState:n,dispatch:s},c,l)}catch(e){throw r.error(e.message,a),e}}if(t.execute)return t.execute({getState:n,dispatch:s},c,l);throw new o.a("Unable to execute.  No base action execute and no forwarded action for "+t.type)}}}},jq7Z:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n("jS4H"),a=n("dHD5");function i(e,t){var n;const a=Object(r.a)(e,t);return null!=a?a:null===(n=null==e?void 0:e.formInstances)||void 0===n?void 0:n[t]}function o(e,t,n){var r,o,s;const c=Object(a.w)(n);return null===(s=null===(o=null===(r=i(e,t))||void 0===r?void 0:r.forms)||void 0===o?void 0:o[c])||void 0===s?void 0:s.formId}},jqlv:function(e,t,n){"use strict";n.d(t,"e",(function(){return g})),n.d(t,"a",(function(){return h})),n.d(t,"m",(function(){return m})),n.d(t,"l",(function(){return b})),n.d(t,"k",(function(){return y})),n.d(t,"i",(function(){return _})),n.d(t,"d",(function(){return v})),n.d(t,"f",(function(){return S})),n.d(t,"g",(function(){return O})),n.d(t,"c",(function(){return C})),n.d(t,"b",(function(){return E})),n.d(t,"h",(function(){return I})),n.d(t,"j",(function(){return w}));var r=n("ufH1"),a=n("84PK"),i=n("504W"),o=n("Div0"),s=n("WSMw"),c=n("zAhX"),l=n("thzq"),u=n("3ri3"),d=n("LTmj");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class p{constructor(){this._SID=0,this._LogTableID=null,this._OperationType=0}get_SID(){return this._SID}set_SID(e){return this._SID=e,e}get_logTableID(){return this._LogTableID}set_logTableID(e){return this._LogTableID=e,e}get_operationType(){return this._OperationType}set_operationType(e){return this._OperationType=e,e}}var f=n("DijY");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function g(e){return u.y+e}function h(e){const t=new Array(e.rows.length);for(let n=0;n<e.rows.length;n++){const r=e.rows.item(n),a=new p;a.set_SID(r[u.K]),a.set_logTableID(r[u.I].toString()),a.set_operationType(r[u.J]),t[n]=a}return t}function m(e,t){Object(r.e)(e,o.a.offlineUpSync,t)}function b(e,t){Object(r.d)(e,o.a.offlineUpSync,t)}function y(e,t){Object(r.b)(e,o.a.offlineUpSync,t)}function _(e){return e.get_logTableID()}function v(e){return e.replace(u.y,"")}function S(e,t){if(Object(i.a)(e))return null;const n=C(e),r=e.get_SID();if(Object(i.a)(n)||Object(i.a)(t)||!(n in t))return null;const a=t[n];if(Object(i.a)(a)||Object(i.a)(a[r.toString()]))return null;return a[r.toString()][0]}function O(e,t){if(Object(i.a)(e))return null;const n=C(e),r=e.get_SID(),a=e.get_operationType();if(a===l.a.Create||a===l.a.Delete||Object(i.a)(n)||Object(i.a)(t)||!(n in t))return null;const o=t[n][r.toString()];return Object(i.a)(o)?null:o[1]}function C(e){return _(e).replace(u.y,"")}function E(e){if(!Object(i.a)(e)){const t=e[u.f],n=e[u.g].toString(),r=e[u.m],a=e[u.d].toString();return new d.a(t,n,r,a)}return new d.a(a.a.get_empty(),null,c.a.InProgress,null)}function I(e){let t="";switch(e){case l.a.Create:t=s.b;break;case l.a.Delete:t=s.a;break;case l.a.Update:t=s.d;break;case l.a.Retrieve:t=s.c}return t}function w(e){let t="";switch(e){case f.a.changeProcessAndStage:t="changeProcessAndStage";break;case f.a.crud:t="crud";break;case f.a.nonCrud:t="nonCrud"}return t}},jsc8:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("Uv1Y");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t=!1){return{type:"session.state.retrieve.async",execute:({getState:n},a)=>function(e,t,n=!1){return e.retrieveSessionState(t,n).nativePromise().catch(r.b)}(a.DataSource,e,t).then(e=>e)}}},ju1h:function(e,t,n){"use strict";n.d(t,"o",(function(){return r})),n.d(t,"g",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"k",(function(){return s})),n.d(t,"d",(function(){return c})),n.d(t,"p",(function(){return l})),n.d(t,"h",(function(){return u})),n.d(t,"e",(function(){return d})),n.d(t,"i",(function(){return p})),n.d(t,"j",(function(){return f})),n.d(t,"c",(function(){return g})),n.d(t,"n",(function(){return h})),n.d(t,"f",(function(){return m})),n.d(t,"q",(function(){return b})),n.d(t,"m",(function(){return y})),n.d(t,"l",(function(){return _}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="pa-no-auto-focus",a="data-"+r,i="data-accessibilityButton",o="data-buttonPosition",s="float-panel",c="data-"+s,l="panel-position",u="data-"+l,d="data-id",p="data-text",f="pa-dialog-popup",g="data-"+f,h="pa-notification",m="data-"+h,b="sidePanelIFrame",y="is-visible",_="is-focusable"},jxo7:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("nxt5");class a extends r.a{constructor(e){super("RetrieveMultiple"),this._entityCollection=e}get_entityCollection(){return this._entityCollection}}},jzeE:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("nJrx");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a=Object(r.a)()},k1f1:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n("SAYH"),a=n("eXjw");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i="businessProcessFlow.addInstanceIdToRecordData";function o(e,t){const n={entities:{[t.etn]:{[r.a.toString(t.id)]:{initialized:a.a.Initialized,businessProcessFlowInstanceId:e}}}};return{type:i,payload:n}}},kAKO:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.Normal=0]="Normal",e[e.OnIdle=1]="OnIdle"}(r||(r={}))},kGsI:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("5yoC");class a extends r.a{constructor(e,t,n){super(),this._target=null,this._relationship=null,this._target=e,this._relationship=t}get_name(){return"Disassociate"}get_xmlNamespace(){return"http://schemas.microsoft.com/xrm/2011/Contracts"}get_target(){return this._target}get_relationship(){return this._relationship}}},kKLx:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="Error_Entity_NotAvailable",a="Error_View_NotAvailable",i=[r,a]},kToj:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));n("XjOj"),n("Div0");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e,t){0}},kWiz:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r,a=n("pNM1");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */!function(e){e[e.Off=0]="Off",e[e.Error=1]="Error",e[e.Warning=2]="Warning",e[e.Info=3]="Info",e[e.Verbose=4]="Verbose"}(r||(r={})),function(e){e.toString=function(t){switch(t){case e.Off:return"Off";case e.Error:return"Error";case e.Warning:return"Warning";case e.Info:return"Info";case e.Verbose:return"Verbose";default:return`Unknown TracerLogLevel: ${t}. Please update TracerLogLevel`}},e.fromString=function(t){switch(t){case"Off":return e.Off;case"Error":return e.Error;case"Warning":return e.Warning;case"Info":return e.Info;case"Verbose":return e.Verbose;default:return e.Info}},e.fromLegacyLogLevel=function(t){switch(t){case a.a.Error:return e.Error;case a.a.Info:return e.Info;case a.a.Off:return e.Off;case a.a.Perf:return e.Info;case a.a.Verbose:return e.Verbose;case a.a.Warning:return e.Warning;default:return e.Info}}}(r||(r={}))},kX6F:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));const r="selectedForm.update";function a(e,t,n){return{type:r,payload:{selectedForms:{[e]:{formId:t,userEntityUISettingsId:n}}}}}},kXuq:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r,a=n("mMyr"),i=n("huli"),o=n("F6M4"),s=n("QEBF"),c=n("fueu"),l=n("ghc6"),u=n("8aze"),d=n("9lTt"),p=(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),f=function(e){function t(t){var n=e.call(this,t)||this;return n._subscriber=null,n._mountedElement=null,n._getReference=n._getReference.bind(n),n.refCallbackTrigger=n.refCallbackTrigger.bind(n),n}return p(t,e),t.prototype.getElementName=function(){return this.props.semanticTag||"div"},t.prototype.getFlexClassName=function(e){return Object(o.b)(e?e.display:null)},t.prototype.componentDidMount=function(){var e=this;this.props.isRequestedMeasuring&&(this._subscriber={forceMeasure:this.props.forceMeasure,getComponent:this.getComponent.bind(this),onMeasure:this.props.onMeasuring,getContext:function(){return e.context}},c.a.getInstance().addMeasuringSubscribers(this._subscriber))},t.prototype.componentDidUpdate=function(){this.props.isRequestedMeasuring&&(this._mountedElement=i.findDOMNode(this),c.a.getInstance().updateMeasuringSubscribers(this._subscriber))},t.prototype._getReference=function(e){e&&this.props.isRequestedMeasuring&&(this._mountedElement=i.findDOMNode(e))},t.prototype.getComponent=function(){return this._mountedElement},t.prototype.componentWillUnmount=function(){this.props.isRequestedMeasuring&&c.a.getInstance().removeMeasuringSubscribers(this._subscriber),this._mountedElement=null},t.prototype.getElementStyle=function(){if(this.props.style)return Object(o.a)(this.props.style)},t.prototype.getElementClassName=function(){var n=e.prototype.getElementClassName.call(this);return this.props&&this.props.className&&(n+=" "+this.props.className),this.props.style&&t.isElementScrollable(this.props.style)&&(n+=d.a.getInstance().getDisableScrollStyle()&&!this.props.isWithinATopMostSeeMore?" webkitScrollAuto":" webkitScroll"),n},t.prototype.getElementProps=function(){var e={id:this.props.id,accessKey:""===this.props.accessKey?null:this.props.accessKey,ref:this.setRefCallbackAndReference.bind(this)};return"boolean"==typeof this.props.isRTL&&(e.dir=this.props.isRTL?"rtl":"ltr"),this.isIE||this.hasAriaProperty()||"number"==typeof this.props.tabIndex||this.props.semanticTag&&"div"!==this.props.semanticTag&&"span"!==this.props.semanticTag||(e.role="presentation"),e},t.prototype.setRefCallbackAndReference=function(e){return this.props.isRequestedMeasuring&&!0===this.props.isRequestedMeasuring?this._getReference(e):this.props.refCallback?this.refCallbackTrigger(e):void 0},t.prototype.render=function(){return a.createElement(this.getElementName(),this.getElementPropsInternal(),this.getElementChildren())},t.displayName="View",t.contextType=c.b,t}(s.a);function g(e){return e&&e.style?Object.assign(e.style,Object(u.a)(e)):{}}var h=l.a((function(e){return{rule:g(e)}}))(f)},ke4y:function(e,t,n){"use strict";n.d(t,"b",(function(){return ze})),n.d(t,"a",(function(){return xe}));var r=n("mMyr"),a=n("huli"),i=n("MhnN"),o=n("jzeE"),s=n("u+q+"),c=n("QBtP"),l=n("hp2+"),u=n("pF61"),d=n("hAdb"),p=n("unFF"),f=n("1dXh"),g=n("qUtK"),h=n("kXuq"),m=n("Ziun"),b=n("3rse"),y=n("d6Hx"),_=n("ngeo"),v=n("tT9w");var S=n("KOTC"),O=n("uZvv"),C=n("0FMG"),E=n("Knfm"),I=n("GEbX"),w=n("wE9H"),j=n("3cEW"),P=n("AVDU"),T=n("Vv1C");class N extends r.Component{constructor(e){super(e),this.toggleSiteMap=this.toggleSiteMap.bind(this),this.closeSiteMap=this.closeSiteMap.bind(this),this.selectArea=this.selectArea.bind(this),this.keyDownHandler=this.keyDownHandler.bind(this),this._childContext={toggleSiteMap:this.toggleSiteMap,hiddenAction:this.props.hiddenAction,isInMobileModeForOct2019:this.props.isInMobileModeForOct2019}}_fetchSiteMapDescriptor(){this.props.fetchSiteMapDescriptor().catch(e=>{this.props.handleFetchError(e)})}componentDidMount(){this.props.isInMobileModeForOct2019||this._fetchSiteMapDescriptor()}componentDidUpdate(e){if(e.isSiteMapOpened!==this.props.isSiteMapOpened){if(this.props.isSiteMapOpened)this._fetchSiteMapDescriptor();else{const e=document.getElementById(y.g);e&&e.focus()}this.props.onToggle&&this.props.onToggle(this.props.isSiteMapOpened)}}toggleSiteMap(e){this.props.togglePanelStateAction(e)}closeSiteMap(){this.props.isSiteMapOpened&&this.toggleSiteMap(!0)}selectArea(e){this.props.setSelectedAreaId(e)}keyDownHandler(e){const t=e.target;switch(e.keyCode){case b.a.Enter:if(t.id===y.g)if(this.props.isSiteMapOpened){const e=document.getElementById(y.e);e&&e.firstChild&&e.firstChild.focus()}else this.toggleSiteMap(!0);break;case b.a.Escape:(this.props.isInFlyoutMode||this.props.shouldApplyModernMultiSessionLayout)&&this.closeSiteMap()}}_renderSitemapPanel(){return this.props.navigationType!==I.a.MultiSession||this.props.shouldApplyModernMultiSessionLayout?r.createElement(S.a,{key:"sitemappanel",loader:()=>Promise.all([n.e(0),n.e(1),n.e(51),n.e(58),n.e(167)]).then(n.bind(null,"lq5R")).then(e=>e.SitemapPanel),props:{forceCollapsed:this.props.forceCollapsed}}):r.createElement(S.a,{key:"sessionpanel",loader:()=>Promise.all([n.e(0),n.e(1),n.e(6),n.e(51),n.e(58),n.e(62),n.e(164)]).then(n.bind(null,"m0Y6")).then(e=>e.SessionPanel),props:{forceCollapsed:this.props.forceCollapsed}})}render(){return this.props.hideNavbar?null:this.props.isInMobileModeForOct2019?r.createElement(c.b.Provider,{value:this._childContext},r.createElement(S.a,{key:"global-command-bar",loader:()=>Promise.all([n.e(6),n.e(12),n.e(63),n.e(123)]).then(n.bind(null,"jsLW")).then(e=>e.GlobalCommandBar),props:{cmdbarType:w.a.BrowserMobileSize}})):r.createElement(c.b.Provider,{value:this._childContext},r.createElement(h.a,{key:"siteMapView",onKeyDown:this.keyDownHandler},r.createElement(m.b,{key:"top-bar-id",getIsDialogOpen:this.props.getIsDialogOpen,areaId:this.props.selectedAreaId}),this._renderSitemapPanel()))}}const A=Object(s.a)((function(){return function(e){const t=Object(E.a)(e);return{selectedAreaId:Object(O.a)(e),navigationType:t,isSiteMapOpened:1===Object(O.e)(e),isInFlyoutMode:Object(P.m)(e),hideNavbar:Object(T.a)(e),shouldApplyModernMultiSessionLayout:Object(P.d)(e)}}}),(function(e){return{fetchSiteMapDescriptor:()=>e(Object(g.a)()),setSelectedAreaId:t=>e(Object(C.e)(t)),handleFetchError:t=>{e(
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e){return{type:"Handle SiteMapDescriptor fetch error",sync:!0,execute({dispatch:t,getState:n},r){"0x"+_.a.getHexErrorCodeFromInt(e.errorCode)===v.a?(r.TraceManager.getTracer(y.o).warn("Failed to retrieve Site Map metadata: "+e.message),t(Object(v.b)(e,!0))):r.EventManager.ReportComponentFailure(y.o,e,"Failed to retrieve Site Map metadata")}}}(t))},togglePanelStateAction:t=>e(Object(j.b)(t))}}))(N);var R=n("1S8a"),D=n("rwix");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function x(){return r.createElement(D.a,null,r.createElement(S.a,{loader:()=>Promise.all([n.e(182),n.e(64),n.e(153)]).then(n.bind(null,"Aoj4")).then(e=>e.PerformanceInterfaceRoot)}))}x.displayName="PerformanceInterfaceHook";var M=n("fueu"),F=n("LzVy"),k=n("sclX"),L=n("f+LF");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const B=r.memo(()=>Object(s.d)(L.j)?r.createElement(S.a,{key:"appnotificationtoastcontainer",loader:()=>Promise.all([n.e(0),n.e(87)]).then(n.bind(null,"LhUq")).then(e=>e.ToastContainerInner)}):r.createElement(S.a,{key:"appnotificationtoastcontainer",loader:()=>n.e(88).then(n.bind(null,"rHFu")).then(e=>e.ToastNotificationContainer)}));var U=n("6eYz"),V=n("/to1"),z=n("Afz2"),q=n("wFY3");function H(e){const t=e.popupNotifications?Object.keys(e.popupNotifications):[];if(0===t.length)return null;const i=t[0],o=e.popupNotifications[i].props.title;return a.createPortal(r.createElement(h.a,{key:"popupNotificationListRoot",id:"popupNotificationListRoot",testhooks:{id:"popup-notification"}},(s=i,r.createElement(S.a,{key:s,loader:()=>n.e(155).then(n.bind(null,"bmL+")).then(e=>e.PopupNotification),props:{id:s}})),function(e){return r.createElement(h.a,{key:"popupNotificationListRoot_Accessibility",id:"popupNotificationListRoot_Accessibility",accessibilityLive:q.a,role:z.a,style:{width:0,height:0,overflow:"hidden"}},r.createElement(V.a,null,e))}(o)),document.body);var s}H.displayName="PopupNotificationList";const W=Object(s.a)(e=>({popupNotifications:Object(U.b)(e)}))(H);var G=n("n2e+"),K=n("PrIm"),Q=n("1SVz"),X=n("go4y"),Y=n("Lyxw"),J=n("3/02");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const $={ContainerStyle:{display:"none"}};const Z=Object(s.a)((function(){return function(e,t){return{isSkypeFeatureEnabled:Object(Y.f)(e,J.Tg)}}}))((function(e){return e.isSkypeFeatureEnabled?r.createElement(h.a,{style:$.ContainerStyle,id:X.a.ConversationManagerContainerId}):null}));var ee=n("IqkD"),te=n("b8TU"),ne=n("4leG"),re=n("mlvZ"),ae=n("OEUm");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function ie(){return r.createElement(D.a,null,r.createElement(S.a,{loader:()=>Promise.all([n.e(190),n.e(112)]).then(n.bind(null,"Pg0t")).then(e=>e.DeveloperConsole)}))}ie.displayName="DeveloperConsoleHook";var oe=n("rcL5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var se=n("5X+N"),ce=n("eIIO"),le=n("1Bax"),ue=n("dfL6"),de=n("3peg"),pe=n("arV0"),fe=n("FJpk"),ge=n("/aHX");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class he extends r.Component{constructor(e){super(e),this._mainPaneSizeRequired=this.props.theme.sizes.Breakpoints.DimensionS,this.state={forcedSidePanelFlyout:!1,nearPanesMinSizeRequired:0,farPanesMinSizeRequired:0},this._onPanesMinSizeRequiredChanged=this._onPanesMinSizeRequiredChanged.bind(this)}componentDidMount(){this._onMainPanelSizeChanged(!0)}_onMainPanelSizeChanged(e=!1){const t=this.state.nearPanesMinSizeRequired+this.state.farPanesMinSizeRequired+this._mainPaneSizeRequired;this.props.onMainPanelSizeChanged&&this.props.isAllowCollapseSitemapWhenResize?this.props.onMainPanelSizeChanged(t,()=>this._checkAvailableSpace(e)):this._checkAvailableSpace(e)}_checkAvailableSpace(e=!1){const t=this.props.shouldApplyModernMultisessionLayout?a.findDOMNode(this._panelDiv):a.findDOMNode(this._panels);if(!t)return;const n=t.offsetWidth-this.state.nearPanesMinSizeRequired-this.state.farPanesMinSizeRequired<this._mainPaneSizeRequired;n!==this.state.forcedSidePanelFlyout&&(this.setState({forcedSidePanelFlyout:n}),n&&e&&this.props.collapseAllSidePanels())}_onPanesMinSizeRequiredChanged(e,t){1===e?this.setState({nearPanesMinSizeRequired:t},this._onMainPanelSizeChanged):this.setState({farPanesMinSizeRequired:t},this._onMainPanelSizeChanged)}render(){const e={display:"flex",height:"100%"},t=!!Object.keys(this.props.sidePanels.panes);return this.props.shouldApplyModernMultisessionLayout?r.createElement(h.a,{style:e,ref:e=>this._panelDiv=e},r.createElement(h.a,{style:{position:"relative",display:"flex",height:"100%",flex:1,maxWidth:"100%",flexDirection:"column",overflow:"hidden",order:0}},this._renderSessionTabList(),r.createElement(h.a,{key:"panelManager",id:ce.a,style:e,onMeasuring:()=>this._onMainPanelSizeChanged(!0),isRequestedMeasuring:t,ref:e=>this._panels=e},r.createElement(h.a,{style:{position:"relative",display:"flex",height:"100%",flex:1,maxWidth:"100%",flexDirection:"column",overflow:"hidden",order:0}},this._renderTabList(),this._renderMainPanel()),t&&this._renderNearPane())),t&&this._renderFarPane()):r.createElement(h.a,{key:"panelManager",id:ce.a,style:e,onMeasuring:()=>this._onMainPanelSizeChanged(!0),isRequestedMeasuring:t,ref:e=>this._panels=e},this._renderMainPanel(),t&&r.createElement(r.Fragment,null,this._renderNearPane(),this._renderFarPane()))}_renderTabList(){if(this.props.navigationType===I.a.MultiSession&&!this.props.enableWCAG21FeaturesInFlyout)return r.createElement(S.a,{loader:()=>Object(ge.b)().then(e=>e.TabListApr2022)})}_renderSessionTabList(){return r.createElement(S.a,{loader:()=>Object(ge.b)().then(e=>e.SessionListApr2022)})}_renderNearPane(){return r.createElement(S.a,{loader:()=>Object(se.b)().then(e=>e.NearPanes),props:{isFlyoutMode:this.state.forcedSidePanelFlyout,isEnableLandmarkFeature:this.props.isEnableLandmarkFeature,onMinSizeRequiredChanged:this._onPanesMinSizeRequiredChanged},key:"NearPanes"})}_renderFarPane(){return r.createElement(S.a,{loader:()=>Object(se.b)().then(e=>e.FarPanes),props:{isFlyoutMode:this.state.forcedSidePanelFlyout,isEnableLandmarkFeature:this.props.isEnableLandmarkFeature,onMinSizeRequiredChanged:this._onPanesMinSizeRequiredChanged},key:"FarPanes"})}_renderMainPanel(){let e={position:"relative",display:"flex",height:"100%",flex:1,maxWidth:"100%",flexDirection:"column",overflow:"hidden",order:0};this.props.hasAnyPaneExpanded&&this.props.enableWCAG21FeaturesInFlyout&&(e=Object.assign(Object.assign({},e),{display:"none"}));const t=!(!this.props.hasAnyPaneExpanded||!this.state.forcedSidePanelFlyout)||void 0;return r.createElement(h.a,{key:"mainLandmark",shouldReflow:!0,style:e,role:z.o,accessibilityHidden:t,accessibilityLabel:this.props.currentPageTitle},this.props.children)}}const me=Object(s.a)((function(){return e=>{const t=Object(u.c)(e),n=Object(fe.c)(Object(pe.n)(e,t)),r=Object(E.a)(e),a=Object(P.d)(e);return{sidePanels:Object(oe.d)(e),theme:Object(p.a)(e),isEnableLandmarkFeature:Object(ue.b)(e),isAllowCollapseSitemapWhenResize:Object(Y.d)(e,J.kf,J.Th),enableWCAG21FeaturesInFlyout:Object(P.e)(e),hasAnyPaneExpanded:Object(de.c)(e,1)||Object(de.c)(e,2),currentPageTitle:n,navigationType:r,shouldApplyModernMultisessionLayout:a}}}),(function(e,t){return{collapseAllSidePanels:()=>e(Object(le.a)())}}))(he);var be=n("9lTt"),ye=n("H4dV"),_e=n("RJiR"),ve=n("0kGT"),Se=n("w1eR"),Oe=n("GYEz"),Ce=n("OzPR");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Ee=Object(Ce.a)(),Ie=r.memo(()=>{const e=Object(s.d)(Oe.a),t=Object(s.d)(e=>Object(d.e)(e,"mobileRefreshButton"));return e===Se.a.Browser?null:Ee&&!1!==t?r.createElement(D.a,null,r.createElement(S.a,{loader:()=>n.e(132).then(n.bind(null,"XFb3")).then(e=>e.LocalDeploymentHandlerRoot),props:{localFileOrigin:Ee,mobileRefreshButtonFlag:t}})):null});var we=n("SEva"),je=n("9tpK"),Pe=n("MqQG"),Te=n("c/rA"),Ne=n("hGVc");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
let Ae=0;function Re(e){return 0===Ae&&(Ae=function(e){if(e.indexOf("px")>0)return parseInt(e,10);if(e.indexOf("em")>0||e.indexOf("rem")>0){const n=parseFloat(e);return n*function(e){return parseFloat(getComputedStyle(e||document.documentElement).fontSize)}(t)}var t}(e)),Ae}var De=n("1c32");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const xe="ApplicationShell",Me={display:"flex",flexDirection:"column",flex:"1",maxWidth:"100%",overflow:"hidden",height:"100%"},Fe={display:"flex",flexDirection:"row",height:"100%",maxWidth:"100%",flex:"1",overflow:"hidden"};function ke(e){return e===k.b.Native?Object.assign(Object.assign({},Me),{flexDirection:"column"}):Me}const Le=[];function Be(e){if(!e)return!1;const t=e.tagName.toUpperCase();if("SCRIPT"===t||"LINK"===t)return!1;const n=e.getAttribute(Ne.l);return!n||"true"!==n.toLowerCase()}function Ue(e,t){const n=[je.a,"AppNotificationContainerRoot","popupNotificationListRoot",Pe.a];if(e){const e=[],r=document.getElementsByTagName("BODY")[0].children;for(let a=0;a<r.length;a++){const i=r.item(a);Be(i)&&(!t||i.id!==t)&&n.indexOf(i.id)<0&&(i.setAttribute(Ne.l,"true"),e.push(i))}Le.push(e)}else{const e=Le&&Le.pop();null==e||e.forEach(e=>{e.removeAttribute(Ne.l)})}}class Ve extends r.Component{constructor(e){super(e),this._childrenHiddenInAccessibilityTree=!1,this._dialogState={},this._setAppShellAriaVisibility=this._setAppShellAriaVisibility.bind(this),this._setAppShellContainerRef=this._setAppShellContainerRef.bind(this),this._toggleAppShellVisibilityForSitemap=this._toggleAppShellVisibilityForSitemap.bind(this),this._setProgressIndicatorVisibility=this._setProgressIndicatorVisibility.bind(this),this._getIsDialogOpen=this._getIsDialogOpen.bind(this),this._onMainPanelSizeChanged=this._onMainPanelSizeChanged.bind(this),this.state={isProgressIndicatorVisible:!1,forceSitemapCollapsed:!1}}componentDidMount(){const e=this.context.MutationObserverHandler,t=M.a.getInstance();this._observerTarget=new MutationObserver(()=>{t.scheduleMeasuringUpdate()}),e.addObserverTarget(this._observerTarget),Object.assign(l.b,{accessibilityManager:this.context.AccessibilityManager,rootElementId:xe,accessibilityComponentStack:new De.a(this.context,this.props.isInMobileModeForOct2019),isChildContext:!1});this.context.AccessibilityManager.setMainAccessibilityComponentStack(l.b.accessibilityComponentStack)}componentWillUnmount(){this.context.MutationObserverHandler.removeObserverTarget(this._observerTarget)}componentDidUpdate(e){this.props.isReactInstancePageCachingEnabled&&e.currentPage&&this.props.currentPage!==e.currentPage&&this.context.IntersectionObserverManager.unintersectAll()}_setAppShellAriaVisibility(e){this._topDialogId!==e&&(!e||this._dialogState[e]?Ue(!1,null):(Ue(!0,e),this._dialogState[e]=!0),this._topDialogId=e)}_setProgressIndicatorVisibility(e,t){if(e!==this.state.isProgressIndicatorVisible&&(Ue(e,t),this.setState({isProgressIndicatorVisible:e}),!e)){const e=this.context.AccessibilityManager.getAccessibilityComponentStack(this.props.currentPage);null==e||e.redetermineFocusOnCurrentContext()}}_toggleAppShellVisibilityForSitemap(e){const t=this.props.isInMobileModeForOct2019||this.props.renderSitemapInFlyout;if((e&&t)!==this._childrenHiddenInAccessibilityTree){this._childrenHiddenInAccessibilityTree=e;const t=document.getElementById(xe);t&&(e?t.setAttribute(Ne.l,e.toString()):t.removeAttribute(Ne.l))}}_getIsDialogOpen(){return null!=this._topDialogId}_setAppShellContainerRef(e){this._appShell=e}_renderNavigationBar(){return r.createElement(A,{key:"siteMap",hiddenAction:this._enableDevAndPerfTools,getIsDialogOpen:this._getIsDialogOpen,onToggle:this._toggleAppShellVisibilityForSitemap,isInMobileModeForOct2019:this.props.isInMobileModeForOct2019,forceCollapsed:this.state.forceSitemapCollapsed})}_enableDevAndPerfTools(){Object(re.e)(),Object(ae.c)()}_renderDialogConductor(){return r.createElement(f.a,{key:"dialogConductor",setAppShellAriaVisibility:this._setAppShellAriaVisibility})}_renderNotification(){return[r.createElement(B,{key:"AppNotificationToastContainer"}),r.createElement(W,{key:"PopupNotificationContainer"})]}_renderAppProgressIndicator(){return r.createElement(G.b,{key:"globalAppProgressIndicatorRoot",setIsProgressIndicatorVisibile:this._setProgressIndicatorVisibility})}_renderConversationManagerContainer(){return r.createElement(Z,null)}_renderReconnectNotification(){return r.createElement(Q.c,{key:"reconnect_notification_key"})}_renderPanelManager(){return r.createElement(me,{onMainPanelSizeChanged:this._onMainPanelSizeChanged},!this.props.shouldApplyModernMultiSessionLayout&&this._renderTabList(),this._renderPageHost())}_renderTabList(){if(this.props.navigationType===I.a.MultiSession&&!this.props.renderTabListInSessionMenu)return r.createElement(S.a,{loader:()=>Object(ge.b)().then(e=>e.TabList)})}_renderPageHost(){const e=r.createElement(Te.a,{pageId:this.props.currentPage,isProgressIndicatorActive:!this.state.isProgressIndicatorVisible,isMainPage:!0,isReactInstancePageCachingEnabled:this.props.isReactInstancePageCachingEnabled});return this.props.navigationType===I.a.MultiSession?r.createElement(h.a,{role:z.z,id:"tabcontent",style:{position:"relative",display:"flex",height:"100%",flex:1,maxWidth:"100%",flexDirection:"column",overflow:"hidden",order:0}},e):e}_renderStackNavigator(){return r.createElement(_e.l,{pageDefinitions:this.props.router.getPageDefinitions()})}_renderMainContent(){return r.createElement(h.a,{tabIndex:-1,key:"applicationShellChild",id:"mainContent",style:(this.props,Object.assign(Object.assign({},Me),{marginLeft:0,marginRight:0,overflow:"hidden",height:"100%",position:"relative"}))},this._renderGlobalNotification(),this.props.isInMobileModeForOct2019?this._renderStackNavigator():this._renderPanelManager(),this.props.performanceUiEnabled&&r.createElement(x,null),r.createElement(Ie,null),Object(ae.a)()&&r.createElement(ie,null))}_renderGlobalNotification(){return this.props.isBarNotificationEnabled||this.props.isInMobileModeForOct2019?null:r.createElement(K.a,{key:"globalNotificationList"})}_renderGlobalBarNotification(){return this.props.isBarNotificationEnabled&&!this.props.isInMobileModeForOct2019?r.createElement(we.a,{name:"GlobalBarNotification",key:"globalbarnotification"},r.createElement(S.a,{key:"globalbarnotification",loader:()=>Promise.all([n.e(19),n.e(122)]).then(n.bind(null,"1dcX")).then(e=>e.GlobalBarNotification)})):null}_renderTourContextProvider(){return this.props.isPowerToursInUCIEnabled?r.createElement(we.a,{name:"TourContextProvider",key:"tourcontextprovidererrorboundary"},r.createElement(S.a,{key:"tourcontextprovider",loader:()=>Promise.all([n.e(0),n.e(1),n.e(2),n.e(59),n.e(188),n.e(56),n.e(171)]).then(n.bind(null,"Htl/")).then(e=>e.TourContextProvider)})):null}_isEdge(){return ye.a.getInstance().get_IsBrowserEdge()}render(){if(this.props.isInMobileModeForOct2019)return r.createElement(l.a.Provider,{value:l.b},r.createElement(i.b,null,r.createElement(h.a,{key:"applicationShell",id:xe,style:ke(this.props.platformType),ref:this._setAppShellContainerRef},r.createElement(_e.j,null,this._renderReconnectNotification(),this._renderConversationManagerContainer(),this._renderMainContent(),this._renderDialogConductor(),this._renderNotification(),this._renderAppProgressIndicator(),this._renderNavigationBar()))));const e=be.a.getInstance().getDisableScrollStyle()||!this._isEdge()?"forceNewStackContextInert":"forceNewStackContext";return r.createElement(l.a.Provider,{value:l.b},r.createElement(h.a,{key:"applicationShell",id:xe,style:ke(this.props.platformType),ref:this._setAppShellContainerRef,explicitStyles:e},this._renderNavigationBar(),this._renderGlobalBarNotification(),this._renderReconnectNotification(),this._renderConversationManagerContainer(),r.createElement(h.a,{style:Fe},r.createElement(h.a,{id:o.a}),this._renderMainContent()),this._renderDialogConductor(),this._renderNotification(),this._renderAppProgressIndicator(),this._renderTourContextProvider()))}_onMainPanelSizeChanged(e,t){const n=a.findDOMNode(this._appShell);if(!n||this.props.renderSitemapInFlyout)return void(null==t||t());let r=!1;e&&(r=n.offsetWidth-this.props.sitemapRequiredWidth<e),this.state.forceSitemapCollapsed!==r?this.setState({forceSitemapCollapsed:r},t):null==t||t()}}Ve.displayName=xe;const ze=Object(s.a)((function(e){const t=Object(E.a)(e),n=Object(u.c)(e),r=Object(u.h)(e),a=Object(p.a)(e),i=Object(d.g)(e),o=Object(F.a)(e),s=Object(ee.g)(e),c=Object(te.c)(e),l=a.sizes.Breakpoints.DimensionS,f=Object(ne.f)(e),g=Object(R.c)(e),h=Object(ne.c)(e),m=Object(ve.c)(e),b=Object(Y.f)(e,J.Mc),y=Object(Y.f)(e,J.gg),_=Object(Y.f)(e,J.jc),v=Object(P.m)(e),S=Object(P.e)(e),O=Re(a.sizes.SiteMap.RefreshedWidth),C=Object(P.d)(e);return{currentPage:n,error:r,performanceUiEnabled:i,quickLaunchBarWidth:a.sizes.NavbarHeight,platformType:o,isRTL:s,viewportWidth:c,smallBreakPoint:l,navbarParam:f,shouldHideSideBar:g,navigationType:t,isEmbedded:h,isInMobileModeForOct2019:m,isBarNotificationEnabled:b,isReactInstancePageCachingEnabled:y,isPowerToursInUCIEnabled:_,renderSitemapInFlyout:v,renderTabListInSessionMenu:S,sitemapRequiredWidth:O,shouldApplyModernMultiSessionLayout:C}}))(Ve);Ve.contextType=c.a},kgxE:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getAutomationState=t.clearAutomationState=t.saveAutomationState=void 0;t.saveAutomationState=function(e){sessionStorage.setItem("automationState",JSON.stringify(e))},t.clearAutomationState=function(){sessionStorage.removeItem("automationState")},t.getAutomationState=function(){var e=sessionStorage.getItem("automationState");return e?JSON.parse(e):null}},"l+eg":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(i.hasOwnProperty(e))return i[e];var t=e.replace(r,o).replace(a,"ms");return i[e]=t,t};var r=/-([a-z])/g,a=/^Ms/g,i={};function o(e){return e[1].toUpperCase()}},l0Rp:function(e,t,n){"use strict";n.d(t,"c",(function(){return u})),n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return p}));var r=n("+QYJ"),a=n("g22U"),i=n("NvOS"),o=n("Wc7r"),s=n("SRlt");function c(e,t,n){let r="",a=1;for(const i of n){if(i.serializationFailure)throw i.serializationFailure;r+="--"+t+"\n",r+="Content-Type: application/http\nContent-Transfer-Encoding: binary\n",r+="Content-ID: "+a+++"\n",r+="\n",r+=l(e,i),r+="\n"}return r+="--"+t+"--\n",r}function l(e,t){var n,a;let i=`${e}${s.c.WEB_API_URL_FRAGMENT}`;(!Object(r.b)(e)&&(null===(n=t.urlParameters)||void 0===n?void 0:n.startsWith(e))||(null===(a=t.urlParameters)||void 0===a?void 0:a.startsWith(s.c.WEB_API_URL_FRAGMENT)))&&(i="");let c=`${t.method} ${i}${t.urlParameters} HTTP/1.1\n`;for(const e in t.additionalHeaders)c+=`${e}: ${t.additionalHeaders[e]}\n`;return"GET"===t.method||t.additionalHeaders.hasOwnProperty(o.HEADER.CONTENT_TYPE)||(c+="Content-Type: application/json;type=entry\n"),t.body&&(c+="\n"+t.body),c}function u(e,t){return{type:"SERIALIZE_EXECUTE_MULTIPLE_REQUEST",execute({dispatch:n,getState:r},a){t||(t="batch_"+(new Date).getTime());const i=a.DataSource.get_WebAPIService(),o=e.get_requests().map(e=>{const r=e.get_name(),a=i.requestSerializers[r];if(!a)return Promise.resolve({serializationFailure:`Current ExecuteMultiple request cannot be serialized, because inner ${r} request has no serializer associated with it`});return n(a(e,t))});return Promise.all(o).then(n=>{const a=n.filter(e=>e.serializationFailure);if(a.length)return{serializationFailure:"Failed to serialize some inner requests with the following errors: "+a.map(e=>e.serializationFailure).join("; ")};if(e.get_settings().get_continueOnError())return d(r(),n,!0,t);let i=0,o=0;for(const e of n)"GET"===e.method?i++:o++;if(i>0)return o>0?{serializationFailure:"Failed to serialize some inner requests with the following errors: A mixture of GETs and POSTs cannot be run in an OData changeset"}:d(r(),n,!1,t);const s=n;return d(r(),[s],!1,t)})}}}function d(e,t,n=!1,r,a={}){if(!t||!t.length)return{serializationFailure:"Attempted to create an OData batch with empty list of requests"};let o="";r||(r="batch_"+(new Date).getTime());const s=Object(i.a)(e,"");for(const e of t){o+="--"+r+"\n";let t="";if(Array.isArray(e)){const n=e,r="changeset_"+(new Date).getTime();t=c(s,r,n),o+=`Content-Type: multipart/mixed;boundary=${r}\n`}else{const n=e;if(n.serializationFailure)return n;t=l(s,n),o+="Content-Type: application/http\nContent-Transfer-Encoding: binary\n"}o+="\n",o+=t,o+="\n"}const u=`--${r}--\r\n\0`;o.endsWith(u+"\n")?o=o.substr(0,o.length-1):o+=u;return p(o,n,r,a)}function p(e,t,n,r={}){n=n||"batch_"+(new Date).getTime();const i=Object(a.g)(r),o={urlParameters:"$batch",additionalHeaders:{"Content-Type":"multipart/mixed;boundary="+n,Accept:s.a},body:e,method:"POST",additionalParameters:{[a.a.TYPE]:a.d.Execution_Multiple,[a.a.SUB_TYPE]:a.c.ExecutionMultiple,[a.a.SOURCE]:i}};return t&&(o.additionalHeaders.Prefer="odata.continue-on-error"),o}},l3Ef:function(e,t,n){"use strict";n.d(t,"l",(function(){return r})),n.d(t,"cb",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"X",(function(){return o})),n.d(t,"n",(function(){return s})),n.d(t,"M",(function(){return c})),n.d(t,"L",(function(){return l})),n.d(t,"fb",(function(){return u})),n.d(t,"Z",(function(){return d})),n.d(t,"ab",(function(){return p})),n.d(t,"bb",(function(){return f})),n.d(t,"p",(function(){return g})),n.d(t,"o",(function(){return h})),n.d(t,"Q",(function(){return m})),n.d(t,"y",(function(){return b})),n.d(t,"I",(function(){return y})),n.d(t,"K",(function(){return _})),n.d(t,"z",(function(){return v})),n.d(t,"A",(function(){return S})),n.d(t,"j",(function(){return O})),n.d(t,"q",(function(){return C})),n.d(t,"s",(function(){return E})),n.d(t,"r",(function(){return I})),n.d(t,"g",(function(){return w})),n.d(t,"h",(function(){return j})),n.d(t,"i",(function(){return P})),n.d(t,"H",(function(){return T})),n.d(t,"D",(function(){return N})),n.d(t,"E",(function(){return A})),n.d(t,"v",(function(){return R})),n.d(t,"t",(function(){return D})),n.d(t,"k",(function(){return x})),n.d(t,"N",(function(){return M})),n.d(t,"B",(function(){return F})),n.d(t,"J",(function(){return k})),n.d(t,"a",(function(){return L})),n.d(t,"O",(function(){return B})),n.d(t,"P",(function(){return U})),n.d(t,"db",(function(){return V})),n.d(t,"d",(function(){return z})),n.d(t,"w",(function(){return q})),n.d(t,"x",(function(){return H})),n.d(t,"C",(function(){return W})),n.d(t,"e",(function(){return G})),n.d(t,"c",(function(){return K})),n.d(t,"T",(function(){return Q})),n.d(t,"W",(function(){return X})),n.d(t,"R",(function(){return Y})),n.d(t,"F",(function(){return J})),n.d(t,"u",(function(){return $})),n.d(t,"m",(function(){return Z})),n.d(t,"eb",(function(){return ee})),n.d(t,"Y",(function(){return te})),n.d(t,"f",(function(){return ne})),n.d(t,"G",(function(){return re})),n.d(t,"V",(function(){return ae})),n.d(t,"S",(function(){return ie})),n.d(t,"U",(function(){return oe}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="!",a="systemuser",i="activityattachment",o="syncerror__regardingentityid",s="create",c="modifiedon",l="modifiedby",u="versionnumber",d="RowVersion",p="statecode",f="statuscode",g="createdon",h="createdby",m="ownerid",b="firstname",y="lastname",_="middlename",v="fullname",S=[b,_,y],O="attributeLogicalname",C="EntityLogicalName",E="entitylogicalname",I="entityLogicalName",w="aliasedValueDescriptors",j="aliasedValueEtn",P="aliasedValueFieldName",T="LastDataSyncTime",N="InitialDataDownloadETAInMinutes",A="InitialDataDownloadStatus",R="entitysettings",D="entitymetadata",x="attributeType",M="@odata.context",F="id",k="logicalname",L="name",B="objectid",U="objecttypecode",V="value",z="activityparty",q="fileattachment",H="objectid",W="imagedescriptor",G="activitypartyid",K="activityid",Q="participationtypemask",X="partyid",Y="owner",J="ispartydeleted",$="entityreference",Z="columns",ee="values",te="resolvedparties",ne="activitytypecode",re="isregularactivity",ae=[Q,K,G,X,J,"partyobjecttypecode","addressused"],ie={from:"1",to:"2",cc:"3",bcc:"4",requiredattendees:"5",optionalattendees:"6",organizer:"7",regarding:"8",owner:"9",resources:"10",customer:"11",partner:"12"},oe={1:"from",2:"to",3:"cc",4:"bcc",5:"requiredattendees",6:"optionalattendees",7:"organizer",8:"regarding",9:"owner",10:"resources",11:"customer",12:"partner"}},"lD6+":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="teams";function a(e,t){return e.availablePlatformPlugins.includes(t)}},lEFU:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return d})),n.d(t,"c",(function(){return p}));var r=n("Tf+h"),a=n("jq7Z");function i(e,t,n,r){const i=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e){return e&&e.personalizations?e.personalizations.controls:null}(e),u=i&&function(e,t){if(!t||!e[t])return null;return e[t]}(i,n);if(t){const{areaType:u}=t,d=function(e,t){const n=Object(a.a)(e,t);return null==n?void 0:n.controlPersonalizations}(e,r);for(const e of[d,i])if(e){let r;if(r="form"===u?o(e,t):"grid"===u?s(e,t):"dashboard"===u?c(e,t):l(e,n),r)return r}}return u||null}function o(e,t){const{entityTypeName:n,recordGuid:a,formGuid:i,viewId:o="default",controlUniqueId:s}=t,c=a&&a.guid||r.b;return n&&e[n]&&c&&e[n][c]&&i&&e[n][c][i.guid]&&s&&e[n][c][i.guid][s]&&o&&e[n][c][i.guid][s][o]?e[n][c][i.guid][s][o]:null}function s(e,t){const{entityTypeName:n,viewId:r="default"}=t;return"grid"!==t.areaType||n&&e[n]&&r&&e[n][r]?e[n][r]:null}function c(e,t){const{formGuid:n,viewId:a="default",controlUniqueId:i}=t;return e[r.a]&&n&&e[r.a][n.guid]&&i&&e[r.a][n.guid][i]&&a&&e[r.a][n.guid][i][a]?e[r.a][n.guid][i][a]:null}function l(e,t){return e&&e.hasOwnProperty(t)?e[t]:null}function u(e,t){if(!(e&&e.personalizations&&e.personalizations.selectedForms&&t&&e.personalizations.selectedForms[t]))return null;return e.personalizations.selectedForms[t]||null}function d(e,t){const n=u(e,t);if(!n||!n.formId)return null;return n.formId||null}function p(e,t){const n=u(e,t);if(!n||!n.userEntityUISettingsId)return null;return n.userEntityUISettingsId||null}},lJW1:function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var r=n("HcnX"),a=n("1kth"),i=n("16wZ"),o=n("dHD5"),s=n("uxy2"),c=n("5d8d"),l=n("qshH"),u=n("NjDY"),d=n("ZIjf");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const p="ClientApi.XrmControlSearchWidget.";let f;class g extends r.a{constructor(e,t,n,r,a,s){const c=p+"constructor";super(e,t,n,r,a,s),t||Object(i.j)(c,"contextToken"),e||Object(i.j)(c,"store"),f=e,this._searchWidgetToken=Object(o.o)(t,a)}setSearchQuery(e){const t=p+"setSearchQuery";try{d.a.instance.reportCall(t),f.dispatch(Object(s.d)(this._searchWidgetToken,e)),d.a.instance.reportSuccess(t)}catch(e){const n=l.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),l.a.getInstance().reportFailure(t,e,null,n),e}}getSearchQuery(){const e=p+"getSearchQuery";try{d.a.instance.reportCall(e);const t=Object(c.d)(this._searchWidgetToken,f.getState());return d.a.instance.reportSuccess(e),t}catch(t){const n=l.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),l.a.getInstance().reportFailure(e,t,null,n),t}}getSelectedResults(){const e=p+"getSelectedResults";try{d.a.instance.reportCall(e);const t=Object(c.e)(this._searchWidgetToken,f.getState()),n=this._kbrecordToKBSearchResult(t);return d.a.instance.reportSuccess(e),n}catch(t){const n=l.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),l.a.getInstance().reportFailure(e,t,null,n),t}}openSearchResult(e,t){const n=p+"openSearchResult";try{d.a.instance.reportCall(n);const t=Object(c.f)(this._searchWidgetToken,f.getState(),e-1);return 0===t||-1===t?(d.a.instance.reportSuccess(n),t):(f.dispatch(Object(s.b)(this.pageId,t,this._searchWidgetToken)),d.a.instance.reportSuccess(n),1)}catch(e){const t=l.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.getName()}),l.a.getInstance().reportFailure(n,e,null,t),e}}getTotalResultCount(){const e=p+"getTotalResultCount";try{d.a.instance.reportCall(e);const t=Object(c.g)(this._searchWidgetToken,f.getState());return d.a.instance.reportSuccess(e),t}catch(t){const n=l.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),l.a.getInstance().reportFailure(e,t,null,n),t}}changeSelectedMenuItem(e,t){const n=p+"changeSelectedMenuItem";Object(i.a)(e)&&Object(i.j)(n,"command"),Object(i.a)(t)&&Object(i.j)(n,"value");try{d.a.instance.reportCall(n),f.dispatch(Object(s.a)(this._searchWidgetToken,e,t)),d.a.instance.reportSuccess(n)}catch(e){const t=l.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.getName()}),l.a.getInstance().reportFailure(n,e,null,t),e}}getUseNativeCrm(){const e=p+"getUseNativeCrm";try{d.a.instance.reportCall(e);const t=!Object(u.D)(f.getState()).isParature;return d.a.instance.reportSuccess(e),t}catch(t){const n=l.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),l.a.getInstance().reportFailure(e,t,null,n),t}}setNumberOfResults(e){const t=p+"setNumberOfResults";try{d.a.instance.reportCall(t),f.dispatch(Object(s.e)(this._searchWidgetToken,e)),d.a.instance.reportSuccess(t)}catch(e){const n=l.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),l.a.getInstance().reportFailure(t,e,null,n),e}}setBlockResult(e){const t=p+"setBlockResult";try{d.a.instance.reportCall(t),f.dispatch(Object(s.c)(this._searchWidgetToken,e)),d.a.instance.reportSuccess(t)}catch(e){const n=l.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),l.a.getInstance().reportFailure(t,e,null,n),e}}addOnSelection(e){const t=p+"addOnSelection";e||Object(i.j)(t,"handler");try{d.a.instance.reportCall(t),f.dispatch(Object(a.q)(this._searchWidgetToken,this.pageId,e,this.name)),d.a.instance.reportSuccess(t)}catch(e){const n=l.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),l.a.getInstance().reportFailure(t,e,null,n),e}}removeOnSelection(e){const t=p+"removeOnSelection";e||Object(i.j)(t,"handler");try{d.a.instance.reportCall(t),f.dispatch(Object(a.M)(this._searchWidgetToken,this.pageId,e,this.name)),d.a.instance.reportSuccess(t)}catch(e){const n=l.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),l.a.getInstance().reportFailure(t,e,null,n),e}}addOnResultOpened(e){const t=p+"addOnResultOpened";e||Object(i.j)(t,"handler");try{d.a.instance.reportCall(t),f.dispatch(Object(a.o)(this._searchWidgetToken,this.pageId,e,this.name)),d.a.instance.reportSuccess(t)}catch(e){const n=l.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),l.a.getInstance().reportFailure(t,e,null,n),e}}removeOnResultOpened(e){const t=p+"removeOnResultOpened";e||Object(i.j)(t,"handler");try{d.a.instance.reportCall(t),f.dispatch(Object(a.K)(this._searchWidgetToken,this.pageId,e,this.name)),d.a.instance.reportSuccess(t)}catch(e){const n=l.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),l.a.getInstance().reportFailure(t,e,null,n),e}}addOnPostSearch(e){const t=p+"addOnPostSearch";e||Object(i.j)(t,"handler");try{d.a.instance.reportCall(t),f.dispatch(Object(a.i)(this._searchWidgetToken,this.pageId,e,this.name)),d.a.instance.reportSuccess(t)}catch(e){const n=l.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),l.a.getInstance().reportFailure(t,e,null,n),e}}removeOnPostSearch(e){const t=p+"removeOnPostSearch";e||Object(i.j)(t,"handler");try{d.a.instance.reportCall(t),f.dispatch(Object(a.E)(this._searchWidgetToken,this.pageId,e,this.name)),d.a.instance.reportSuccess(t)}catch(e){const n=l.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),l.a.getInstance().reportFailure(t,e,null,n),e}}getControlType(){return d.a.instance.reportUsage(p+"getControlType"),"kbsearch"}_kbrecordToKBSearchResult(e){if(!e)return null;try{return{answer:e.content,articleId:e.articlePublicNumber+"_"+e.knowledgeArticleId,articleUid:e.knowledgeArticleId,attachmentCount:0,createdOn:e.createdon,expiredDate:e.expirationdate,folderHref:"",href:"",isAssociated:e.hasOwnProperty("articleActions")?!e.articleActions.find(e=>0===e):e.isAssociated,lastModifiedOn:e.modifiedOn,publicUrl:this._getKmExternalPortalUrl(e.articlePublicNumber),published:3===e.stateCode,question:e.title,rating:e.rating,searchBlurb:e.content,serviceDeskUri:"",timesViewed:e.knowledgeArticleViews}}catch(e){const t=l.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.getName()}),l.a.getInstance().reportFailure("ClientApi.XrmControlSearchWidget._kbrecordToKBSearchResult",e,null,t),e}}_getKmExternalPortalUrl(e){try{const t=f.getState().organization.organizationSettings.kmExternalPortalUrl;return t.replace("{kbnum}",e)}catch(e){const t=l.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.getName()}),l.a.getInstance().reportFailure("ClientApi.XrmControlSearchWidget._getKmExternalPortalUrl",e,null,t),e}}}},lKf0:function(e,t,n){"use strict";n.d(t,"e",(function(){return p})),n.d(t,"d",(function(){return f})),n.d(t,"m",(function(){return g})),n.d(t,"l",(function(){return h})),n.d(t,"i",(function(){return m})),n.d(t,"h",(function(){return b})),n.d(t,"k",(function(){return y})),n.d(t,"j",(function(){return _})),n.d(t,"w",(function(){return v})),n.d(t,"v",(function(){return S})),n.d(t,"z",(function(){return O})),n.d(t,"y",(function(){return C})),n.d(t,"a",(function(){return E})),n.d(t,"b",(function(){return I})),n.d(t,"c",(function(){return w})),n.d(t,"t",(function(){return r})),n.d(t,"u",(function(){return a})),n.d(t,"r",(function(){return i})),n.d(t,"s",(function(){return j})),n.d(t,"g",(function(){return P})),n.d(t,"f",(function(){return o})),n.d(t,"o",(function(){return s})),n.d(t,"p",(function(){return c})),n.d(t,"n",(function(){return d})),n.d(t,"q",(function(){return l})),n.d(t,"x",(function(){return u}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="ServerUnavailableNotification_Message",a="ServerUnavailableNotification_Offline_By_Default_Message",i="L_Reconnect_Text",o="Boot_Notification_Button_Text",s="Legacy_App_Present_Notification_Text",c="Legacy_App_Running_Notification_Text",l="Recommend_Update_Mobile_Application_Notification_Text",u="Update_Mobile_Application_Button_Text",d="Kitchen_Sink_App_Running_Notification_Text",p="App_Less_Mode_Notification_Text",f="App_Less_Mode_Notification_Button_Text",g="IE_Support_End_Warning_Notification_Text",h="IE_Support_End_Warning_Notification_Button_Text",m="IE_Block_Pending_Error_Notification_Text",b="IE_Block_Pending_Error_Notification_Button_Text",y="IE_No_Custom_Page_Support_Notification_Text",_="IE_No_Custom_Page_Support_Notification_Button_Text",v="Unsupported_Browser_Notification_Text",S="Unsupported_Browser_Notification_Button_Text",O="WEBAPI_CACHE_GCM_REVALIDATE_UPDATE_TEXT",C="WEBAPI_CACHE_GCM_REVALIDATE_UPDATE_BUTTON_TEXT",E="appid",I="app",w="apps",j=["ServerUnavailableNotification_Title",r,a,i],P=[o,u,s,c,l,d,p,f,g,h,m,b,v,S]},lMS8:function(e,t,n){"use strict";n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return d})),n.d(t,"e",(function(){return l})),n.d(t,"a",(function(){return p})),n.d(t,"d",(function(){return f}));var r=n("YxC/"),a=n("EY5k"),i=n("eq9I"),o=n("E5IU"),s=n("Lyxw"),c=n("3/02");function l(e=!1){return{type:"offline.date.update.completed.notification",sync:!0,execute({dispatch:t,getState:n},o){t(Object(a.e)([i.o,i.j])).then(()=>{const a=e?Object(r.b)(n(),i.j):Object(r.b)(n(),i.o);g(t,1,a,e?i.j:i.o)})}}}function u(e=!1){return{type:"offline.trigger.first.time.sync.complete.notification",sync:!0,async execute({dispatch:t,getState:n},s){const c=Object(o.r)(n()),l=e?i.j:c?i.l:i.k;await t(Object(a.e)([l]));g(t,1,Object(r.b)(n(),l),l)}}}function d(){return{type:"offline.trigger.first.time.request.apply.application.metadata.change.notification",sync:!0,async execute({dispatch:e,getState:t},n){const s=Object(o.r)(t())?i.p:i.q;await e(Object(a.e)([s]));g(e,3,Object(r.b)(t(),s),i.p)}}}function p(e){return{type:"offline.trigger.file.sync.completed.notification",sync:!0,execute({dispatch:t,getState:n},o){t(Object(a.e)([i.h,i.i])).then(()=>{const a=e?Object(r.b)(n(),i.i):Object(r.b)(n(),i.h);g(t,e?2:1,a,e?i.i:i.h)})}}}function f(){return{type:"offline.metadata.download.notification.async",async execute({dispatch:e,getState:t}){if(Object(s.d)(t(),c.pf,c.p))return;const o=[i.n,i.d];await e(Object(a.e)(o));const l=Object(r.b)(t(),i.n),u=Object(r.b)(t(),i.d),{openOfflineStatusDialogAction:d}=await n.e(80).then(n.bind(null,"rrts")),{removeToastNotification:p}=await n.e(80).then(n.bind(null,"sHzf")),f={actionLabel:u,eventHandler:()=>{e(d()),e(p(i.n))}};g(e,4,l,i.n,f)}}}function g(e,t,r,a,i){if(t&&r){!async function(e,t){const r=await n.e(93).then(n.bind(null,"bvqZ"));e(r.addToastNotification(t))}(e,{id:a,level:t,message:r,title:null,type:1,onCloseHandler:null,action:i})}}},lR0U:function(e,t,n){"use strict";n.d(t,"d",(function(){return l})),n.d(t,"a",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"b",(function(){return p}));var r=n("84PK"),a=n("504W"),i=n("l3Ef"),o=n("bRS5"),s=n("/A0C");let c=null;function l(e){c=e}function u(e,t){if(!c)return new Array(0);const n=[];if(Object(o.d)(t))if(c.isComplexAttribute(t)){const r=c.getAttributeColumnNames(t),a=e+i.l;for(const e of r)n[n.length]=a+e}else n[n.length]=e;return n}function d(e,t){const n={};for(const t in e)n[t]=u(t,e[t]);return n}function p(e,t,n){if(!c)return{};const o={},l=function(e,t){let n={};if(Object(a.a)(t))return n;switch(e){case s.a.Owner:case s.a.Lookup:case s.a.Customer:n=t.getObjectData();break;case s.a.PickList:case s.a.Boolean:case s.a.State:case s.a.Status:case s.a.AliasedValue:case s.a.PartyList:case s.a.UniqueIdentifier:n=t.getObjectData()}return n}(t,n);if(c.isComplexAttribute(t)){const n=c.getAttributeMap(t).get_columnNameTypeMap();for(const t of Object.keys(n))n[t]===r.a?o[e+i.l+t]=t in l?r.a.createFromObjectData(l[t]).toString().toUpperCase():"":o[e+i.l+t]=t in l?l[t]:""}else switch(t){case s.a.Status:case s.a.State:case s.a.Boolean:o[e]=Object(a.a)(l[i.db])?-1:l[i.db];break;case s.a.UniqueIdentifier:o[e]=Object(a.a)(n)||Object(a.b)(n.toString())?"":n.toString().toUpperCase();break;case s.a.DateTime:o[e]=Object(a.a)(n)?"":n.toISOString();break;case s.a.PartyList:break;case s.a.PickList:o[e]=Object(a.a)(l[i.db])?null:l[i.db];break;default:o[e]=n}return o}},lULv:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("LqfC"),a=n("rcL5"),i=n("oT5e"),o=n("xPbo"),s=n("/leX");function c(e){return{type:r.a,execute({dispatch:t,getState:n},r){const c=Object(a.i)(n(),e);if(c.type!==s.b.IFrame){const a=Object(i.a)(n(),c.browsingContextId);return r.Router.shouldNavigate(null,null,a.pageId).then(n=>!!n&&(t(Object(o.a)(c.browsingContextId)),t(l(e)),!0))}const u=r.ChannelManager.getChannel(e);return u&&r.ChannelManager.destroyChannel(u),t(l(e)),Promise.resolve(!0)}}}function l(e){return{type:r.b,payload:{sidePanelId:e}}}},lUjt:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e._BT_STOP=0]="_BT_STOP",e[e._BT_STOP_BASE=1]="_BT_STOP_BASE",e[e._BT_BOOL=2]="_BT_BOOL",e[e._BT_DOUBLE=8]="_BT_DOUBLE",e[e._BT_STRING=9]="_BT_STRING",e[e._BT_STRUCT=10]="_BT_STRUCT",e[e._BT_LIST=11]="_BT_LIST",e[e._BT_MAP=13]="_BT_MAP",e[e._BT_INT32=16]="_BT_INT32",e[e._BT_INT64=17]="_BT_INT64"}(t._BondDataType||(t._BondDataType={}))},"lY/Z":function(e,t,n){"use strict";n.d(t,"b",(function(){return V})),n.d(t,"a",(function(){return z})),n.d(t,"e",(function(){return H})),n.d(t,"h",(function(){return $})),n.d(t,"f",(function(){return G})),n.d(t,"d",(function(){return X})),n.d(t,"g",(function(){return Q})),n.d(t,"c",(function(){return K}));var r=n("SAYH"),a=n("odYE"),i=n("eXjw"),o=n("Uv1Y"),s=n("1qQb"),c=n("y60j"),l=n("5Oca"),u=n("k1f1"),d=n("rodW"),p=n("AFlp"),f=n("504W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function g(e,t){if(Object(f.a)(t))return!1;if(Object(f.a)(e)||Object(f.a)(e.fields))return!0;const n=function(e,t){const n="activestageid",r=t.getValue(n),a=e.fields[n]&&e.fields[n].reference&&e.fields[n].reference.id?e.fields[n].reference.id.guid:null;if(r.Id.toString()!==a)return!0;return!1}(e,t),r=function(e,t){const n="traversedpath",r=t.getValue(n),a=e.fields[n]?e.fields[n].value:null;if(r!==a)return!0;return!1}(e,t),a=function(e,t){const n="businessprocessflowinstanceid",r=t.getValue(n),a=e.fields[n]&&e.fields[n].id?e.fields[n].id.guid:null;if(r.toString()!==a)return!0;return!1}(e,t),i=function(e,t){const n="processid",r=t.getValue(n),a=e.fields[n]&&e.fields[n].reference&&e.fields[n].reference.id?e.fields[n].reference.id.guid:null;if(r.Id.toString()!==a)return!0;return!1}(e,t),o=function(e,t){const n="statecode",r=t.getValue(n)?t.getValue(n).get_ValueString():null,a=e.fields[n]?e.fields[n].valueString:null;if(r!==a)return!0;return!1}(e,t),s=function(e,t){const n="statuscode",r=t.getValue(n),a=e.fields[n];if(r)return!a||a.valueString!==r.get_ValueString();return!1}(e,t),c=function(e,t){const n=t.get_fieldNames(),r=[];for(const t in e.fields)e.fields.hasOwnProperty(t)&&r.push(t);if(n.length!==r.length)return!0;for(let n=0;n<r.length;n++){const a=r[n];if(a&&0===a.indexOf("bpf_")){const n=e.fields[a],r=t.getValue(a);if(null!=n)if(null!=n.value){if(n.value!==r)return!0}else if(null!=n.reference&&null!=r){if(n.reference.id.guid!==r.Id.toString())return!0}}}return!1}(e,t);return n||r||a||i||o||s||c}var h=n("3mEc"),m=n("LbMF"),b=n("nxXM"),y=n("NjDY"),_=n("quej"),v=n("pEXn"),S=n("w1eR"),O=n("4r2D"),C=n("tZZc"),E=n("XvL5"),I=n("UyLX"),w=n("/oKV"),j=n("d+dp"),P=n("5qiD"),T=n("iZ7K"),N=n("ZPAw"),A=n("8nT0"),R=n("Lyxw"),D=n("3/02"),x=n("dpM5"),M=n("0eNV"),F=n("/A0C"),k=n("69Qu"),L=n("VMrH"),B=n("z+5+"),U=n("l3Ef");const V="recordData.retrieve",z="recordData.refresh";function q(e,t,n,r,i,s,c){const l=u=>{if(u.retrieveState===C.a.Success){const d=u.data;if(d){const n=d.get_columnSet();if(n&&!function(e,t){const n=e.get_Columns();return t.filter(e=>-1===n.indexOf(e)).length<=0}(n,s))return;const o=d.get_identifier(),p=a.a.fromLegacyEntityReference(o),f=d.get_globalNavigationData();let g=null;if(null!=f){const t=f.get_identifier();null!=e&&null!=e.data&&null!=e.data.entities&&null!=e.data.entities[t.LogicalName]&&null!=e.data.entities[t.LogicalName][t.Id.toString()]&&(g=e.data.entities[t.LogicalName][t.Id.toString()])}r($(e,p,d)),Z(e,g,p,d,r,u.sourceStore===I.a.Remote&&c),r(Object(b.c)([p])),u.sourceStore===I.a.Remote&&i.deleteRetrievedHandlerRecord(o.get_identifier(),l),t(null)}else n(new o.a("DataSource retrieval completed with empty data."))}};return l}function H(e,t,n,a,o,s){const c=arguments,u=[];return{type:"recordData.retrieve.async",execute({dispatch:d,getState:p},f){const g=p(),h=new O.a(r.a.newGuid().guid);u.push({name:v.b.ClientRequestId,value:h&&h.RequestId?h.RequestId():null});const m=Object(l.b)(e)(g,e.etn),b=Object(l.x)(g,e),y=m&&Object(i.b)(b);if(a)for(const t of a){const n=t.navigationProperty,r=Object(T.x)(g,e.etn,n);if(r&&r.ReferencedEntity===U.C){const e=["imagedescription","fullimageurl","imagepixelwidth","imagepixelheight","filesizebytes","fullimagedata","mimetype","filename"];t.columnNames=t.columnNames.concat(e),t.columnNames=t.columnNames.filter((e,t,n)=>t===n.indexOf(e))}}if(!t||!t.length)return Promise.resolve();const _=W(g,m,t,a),S=Object(B.A)(g);if(_&&!S)return Promise.resolve();d(Y(e,y));const C=f.DataSource,E=C.get_EventManager();return new Promise((i,l)=>{E.addRetrievedHandlerRecord(r.a.toString(e.id),q(g,i,l,d,E,t,!!n)),J(C,e,t,n,a,h,s,o).then(()=>{d(Object(L.b)(1,c))}).catch(e=>{l(e)}),_&&i(null)})},getFailureParameters:(e,t)=>u}}function W(e,t,n,r){if(!t||!t.queryColumnNames)return!1;if(!Object(B.c)(e))return!1;const a=t.queryColumnNames;if(!a)return!1;for(const e in n)if(-1===a.indexOf(n[e]))return!1;for(const e in r)if(-1===a.indexOf(r[e].navigationProperty))return!1;return!0}function G(e,t,n,a,i,o){return{type:"recordRecordData.forForm.async",execute({dispatch:s,getState:l},u){if(!r.a.isNullOrEmpty(e.id)&&!r.a.isNullOrEmpty(t)){const r=l(),d=Object(c.w)(r,t),p=new Set(d),f=Object(c.h)(r,t);if(i){const t=Object(m.h)(r,e.etn);if(t){const n=Object(m.a)(r,e.etn,t);(n&&n.IsRetrievable||r.clientHost&&r.clientHost.type===S.a.MailApp&&f&&6===f.FormType)&&p.add(t)}}if(a)for(const e of a)p.add(e);const g=Object(h.d)(r,f.FormLibraries,[e.etn]);if(g)for(const e of g)p.has(e)||p.add(e);const b=Array.from(p),y=u.TraceManager.getTracer("Forms.LargeImageFileAttribute"),_=K(r,e,b,y),v=Object(k.c)(r)?w.a.Remote:void 0;return s(H(e,b,n,_,v,o))}return Promise.resolve()}}}function K(e,t,n,r){let a=null;const i=Object(R.f)(e,D.Od)&&Object(R.f)(e,x.l),o=Object(R.f)(e,D.Qd)&&Object(R.f)(e,x.l);if(i||o){const s=Object(m.f)(e,t.etn,F.a.File),c=Object(m.f)(e,t.etn,F.a.Image),l={[F.a.File]:e=>i&&s&&s.hasOwnProperty(e),[F.a.Image]:e=>o&&c&&c.hasOwnProperty(e)};let u=!1;for(let i=0;i<n.length;i++){const o=[F.a.File,F.a.Image].find(e=>l[e](n[i]));if(o){const s=Object(N.a)(e,t,n[i],o);null===a&&(a=[]);const c="Attribute type file/image attribute was added to the form.";r&&r.info(c),o===F.a.File?u||(a.push({navigationProperty:s,columnNames:[A.j,A.h,A.r,A.u]}),u=!0):a.push({navigationProperty:s,columnNames:[A.i,A.h,A.r,A.k,A.m,A.o,A.n,A.b,A.q,A.p]})}}}return a}function Q(e,t){return{type:"recordRecordData.forOrg.async",execute({dispatch:n,getState:a},i){const o=Object(y.E)(a()),s={etn:"organization",id:o.organizationId};let c=Object(h.d)(a(),e,[s.etn]);c=Array.from(new Set(c));const u=Object(l.h)(a(),"organization",r.a.toString(o.organizationId));if(c&&c.length>0){const e=[];for(let t=0;t<c.length;t++)u&&u.fields&&u.fields.hasOwnProperty(c[t])||e.push(c[t]);if(e.length>0)return n(H(s,e,void 0,void 0,void 0,t)).catch(e=>{-2147093999!==e.errorCode&&Promise.reject(e)});n(Object(b.c)([u.identifier]))}return Promise.resolve()}}}function X(e,t,n,a,c){const l=[];return{type:"recordData.refresh.async",async execute({dispatch:u,getState:d},p){if(t&&t.length){const f=new O.a(r.a.newGuid().guid);l.push({name:v.b.ClientRequestId,value:f&&f.RequestId?f.RequestId():null}),u(function(e){const t={entities:{[e.etn]:{[r.a.toString(e.id)]:{initialized:i.a.Refreshing}}}};return{type:z,payload:t}}(e));const g=p.DataSource;try{const i=await function(e,t,n,r,a,i,o){return J(e,t,n,o,r,a,i,w.a.Remote)}(g,e,t,a,f,c,n);let o=null;const l=i.get_globalNavigationData();if(null!=l){const e=l.get_identifier(),t=d();null!=t.data.entities[e.LogicalName]&&null!=t.data.entities[e.LogicalName][e.Id.toString()]&&(o=t.data.entities[e.LogicalName][e.Id.toString()])}u(function(e,t,n){const a={entities:{[t.etn]:{[r.a.toString(t.id)]:Object(s.a)(n,e)}}};return{type:z,payload:a}}(d(),e,i));const p=[];p.push(e),u(Object(b.c)(p)),Z(d(),o,e,i,u,!1)}catch(e){Object(o.b)(e)}}},getFailureParameters:(e,t)=>l}}function Y(e,t){const n={entities:{[e.etn]:{[r.a.toString(e.id)]:{initialized:t?i.a.Refreshing:i.a.Initializing}}}};return{type:V,payload:n}}function J(e,t,n,r,i,s,c,l){const u=a.a.toLegacyEntityReference(t),d=new E.a(n),p=i?i.map(e=>new M.a(e.navigationProperty,e.columnNames)):null,f=new j.a(P.a.Workspace,null!=l?l:w.a.LocalAndRemote);return e.retrieveRelatedEntities(u,d,d,null,f,s,r,p,c).then(e=>{const t=e.get_fieldNames(),r=n.filter(e=>-1===t.indexOf(e));return r.length&&r.forEach(t=>e.initializeValue(t,null,F.a.Unknown)),e}).nativePromise().catch(o.b)}function $(e,t,n){const a={entities:{[t.etn]:{[r.a.toString(t.id)]:Object(s.a)(n,e)}}};return{type:V,payload:a}}function Z(e,t,n,i,o,s){const c=i.get_globalNavigationData();if(c){const r=a.a.fromLegacyEntityReference(c.get_identifier());o($(e,r,c)),o(Object(u.b)(r.id,n)),g(t,c)&&(o(Object(d.b)(!0,n)),o(Object(_.b)(n)));const i=[],s=new a.a(r.etn,r.id);i.push(s),o(Object(b.c)(i));const l=c.getValue("processid");if(l){const e=a.a.fromLegacyEntityReference(l);o(Object(p.b)(e.id,n))}}else s&&(o(Object(u.b)(r.a.EMPTY,n)),o(Object(p.b)(r.a.EMPTY,n)),g(t,c)&&o(Object(d.b)(!0,n)))}},lYcl:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("JDi5"),a=n("ruPX");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function i(e,t,n,i){const o={searchText:e,searchType:t,searchSessionId:i};return Object(a.a)(r.a,o,n)}},laoc:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("mMyr"),a=r.createContext({})},lcRi:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * The unique name of the Benchmark page module.
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="Benchmark"},lcrw:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e,t){return e[t]}function a(e,t){let n=0,r=!1;for(let a=0,i=e.length;a<i;a++){const i=e.charAt(a);switch(i){case"'":r?t.str+="'":n++,r=!1;break;case"\\":r&&(t.str+="\\"),r=!r;break;default:t.str+=i,r=!1}}return n}function i(e,t){t||(t="F");const n=t.length;if(1===n)switch(t){case"d":return r(e,"ShortDatePattern");case"D":return r(e,"LongDatePattern");case"t":return r(e,"ShortTimePattern");case"T":return r(e,"LongTimePattern");case"f":return`${r(e,"LongDatePattern")} ${r(e,"ShortTimePattern")}`;case"F":return r(e,"FullDateTimePattern");case"M":case"m":return r(e,"MonthDayPattern");case"s":return r(e,"SortableDateTimePattern");case"Y":case"y":return r(e,"YearMonthPattern");default:throw Error("Sys.Res.formatInvalidString")}else 2===n&&"%"===t.charAt(0)&&(t=t.charAt(1));return t}function o(e,t){if(!t)return 0;let n;const r=e.getTime();for(let e=0;t[e];e+=4)if(n=t[e+2],null===n||r>=n)return e;return 0}function s(e,t,n,a){let i=e.getFullYear();return!a&&r(t,"eras")&&(i-=r(t,"eras")[n+3]),i}function c(e){return e.split(" ").join(" ").toUpperCase()}function l(e){const t=[];for(let n=0,r=e.length;n<r;n++)t[n]=c(e[n]);return t}function u(e,t,n){const r=c(e);let a=t.indexOf(r);return-1===a&&(a=n.indexOf(r)),a}function d(e,t){return u(t,l(e.dateTimeFormat.MonthNames),l(e.dateTimeFormat.MonthGenitiveNames))}function p(e,t){return u(t,l(r(e.dateTimeFormat,"AbbreviatedMonthNames")),l(r(e.dateTimeFormat,"AbbreviatedMonthGenitiveNames")))}function f(e,t){return l(r(e.dateTimeFormat,"DayNames")).indexOf(c(t))}function g(e,t){return l(r(e.dateTimeFormat,"AbbreviatedDayNames")).indexOf(c(t))}function h(e,t){const n=new Date,a=o(n,r(e,"eras"));if(t<100){const i=s(n,e,a);(t+=i-i%100)>r(r(e,"Calendar"),"TwoDigitYearMax")&&(t-=100)}return t}function m(e,t,n){return function e(t,n,c){const l=c.dateTimeFormat,u=r(l,"Calendar").convert;if(!n||!n.length||"i"===n){if(c&&c.name.length){if(u)return e(t,r(l,"FullDateTimePattern"),c);const n=new Date(t.getTime()),a=o(t,r(l,"eras"));return n.setFullYear(s(t,l,a)),n.toLocaleString()}return t.toString()}const d=r(l,"eras"),p="s"===n;n=i(l,n);const f={str:""};let g,h,m;function b(e){return e<10?"0"+e:e.toString()}function y(e){return e<10?"00"+e:e<100?"0"+e:e.toString()}const _=/([^d]|^)(d|dd)([^d]|$)/g;function v(){return h||m||(h=_.test(n),m=!0),h}let S=0;const O=/\/|dddd|ddd|dd|d|MMMM|MMM|MM|M|yyyy|yy|y|hh|h|HH|H|mm|m|ss|s|tt|t|fff|ff|f|zzz|zz|z|gg|g/g;let C;function E(e,t){if(C)return C[t];switch(t){case 0:return e.getFullYear();case 1:return e.getMonth();case 2:return e.getDate()}}for(!p&&u&&(C=u.fromGregorian(t));;){const e=O.lastIndex,i=O.exec(n);if(S+=a(n.slice(e,i?i.index:n.length),f),!i)break;if(S%2!=1)switch(i[0]){case"dddd":f.str+=r(l,"DayNames")[t.getDay()];break;case"ddd":f.str+=r(l,"AbbreviatedDayNames")[t.getDay()];break;case"dd":h=!0,f.str+=b(E(t,2));break;case"d":h=!0,f.str+=E(t,2).toString();break;case"MMMM":f.str+=r(l,"MonthGenitiveNames")&&v()?r(l,"MonthGenitiveNames")[E(t,1)]:r(l,"MonthNames")[E(t,1)];break;case"MMM":f.str+=r(l,"AbbreviatedMonthGenitiveNames")&&v()?r(l,"AbbreviatedMonthGenitiveNames")[E(t,1)]:r(l,"AbbreviatedMonthNames")[E(t,1)];break;case"MM":f.str+=b(E(t,1)+1);break;case"M":f.str+=(E(t,1)+1).toString();break;case"yyyy":f.str+=(I=C?C[0]:s(t,l,o(t,d),p))<10?"000"+I:I<100?"00"+I:I<1e3?"0"+I:I.toString();break;case"yy":f.str+=b((C?C[0]:s(t,l,o(t,d),p))%100);break;case"y":f.str+=C?C[0].toString():(s(t,l,o(t,d),p)%100).toString();break;case"hh":g=t.getHours()%12,0===g&&(g=12),f.str+=b(g);break;case"h":g=t.getHours()%12,0===g&&(g=12),f.str+=g.toString();break;case"HH":f.str+=b(t.getHours());break;case"H":f.str+=t.getHours().toString();break;case"mm":f.str+=b(t.getMinutes());break;case"m":f.str+=t.getMinutes().toString();break;case"ss":f.str+=b(t.getSeconds());break;case"s":f.str+=t.getSeconds().toString();break;case"tt":f.str+=t.getHours()<12?r(l,"AMDesignator"):r(l,"PMDesignator");break;case"t":f.str+=(t.getHours()<12?r(l,"AMDesignator"):r(l,"PMDesignator")).charAt(0);break;case"f":f.str+=y(t.getMilliseconds()).charAt(0);break;case"ff":f.str+=y(t.getMilliseconds()).substr(0,2);break;case"fff":f.str+=y(t.getMilliseconds());break;case"z":g=t.getTimezoneOffset()/60,f.str+=(g<=0?"+":"-")+Math.floor(Math.abs(g));break;case"zz":g=t.getTimezoneOffset()/60,f.str+=(g<=0?"+":"-")+b(Math.floor(Math.abs(g)));break;case"zzz":g=t.getTimezoneOffset()/60,f.str+=`${(g<=0?"+":"-")+b(Math.floor(Math.abs(g)))}:${b(Math.abs(t.getTimezoneOffset()%60))}`;break;case"g":case"gg":r(l,"eras")&&(f.str+=r(l,"eras")[o(t,d)+1]);break;case"/":f.str+=r(l,"DateSeparator");break;default:throw Error("Invalid date format pattern")}else f.str+=i[0]}var I;return f.str}(e,t,n)}function b(e,t,n){e=e.trim();const o=n.dateTimeFormat,s=function(e,t){let n=i(e,t);n=n.replace(/([\^\$\.\*\+\?\|\[\]\(\)\{\}])/g,"\\\\$1");const r={str:"^"},o=[];let s=0,c=0;const l=/\/|dddd|ddd|dd|d|MMMM|MMM|MM|M|yyyy|yy|y|hh|h|HH|H|mm|m|ss|s|tt|t|fff|ff|f|zzz|zz|z|gg|g/g;let u;for(;null!==(u=l.exec(n));){const e=n.slice(s,u.index);if(s=l.lastIndex,c+=a(e,r),c%2!=1){switch(u[0]){case"dddd":case"ddd":case"MMMM":case"MMM":case"gg":case"g":r.str+="(\\D+)";break;case"tt":case"t":r.str+="(\\D*)";break;case"yyyy":r.str+="(\\d{4})";break;case"fff":r.str+="(\\d{3})";break;case"ff":r.str+="(\\d{2})";break;case"f":r.str+="(\\d)";break;case"dd":case"d":case"MM":case"M":case"yy":case"y":case"HH":case"H":case"hh":case"h":case"mm":case"m":case"ss":case"s":r.str+="(\\d\\d?)";break;case"zzz":r.str+="([+-]?\\d\\d?:\\d{2})";break;case"zz":case"z":r.str+="([+-]?\\d\\d?)";break;case"/":r.str+="(\\/)";break;case".":r.str+="(\\.)";break;case"-":r.str+="(\\-)";break;default:throw Error("Invalid date format pattern")}o.push(u[0])}else r.str+=u[0]}return a(n.slice(s),r),r.str+="$",{regExp:r.str.replace(/\s+/g,"\\s+"),groups:o}}(o,t),c=new RegExp(s.regExp).exec(e);if(null===c)return null;const l=s.groups;let u,m=null,b=null,y=null,_=null,v=null,S=0,O=0,C=0,E=0,I=null,w=!1;for(let e=0,t=l.length;e<t;e++){const t=c[e+1];if(t)switch(l[e]){case"dd":case"d":if(_=parseInt(t,10),_<1||_>31)return null;break;case"MMMM":if(y=d(n,t),y<0||y>11)return null;break;case"MMM":if(y=p(n,t),y<0||y>11)return null;break;case"M":case"MM":if(y=parseInt(t,10)-1,y<0||y>11)return null;break;case"y":case"yy":if(b=h(o,parseInt(t,10)),b<0||b>9999)return null;break;case"yyyy":if(b=parseInt(t,10),b<0||b>9999)return null;break;case"h":case"hh":if(S=parseInt(t,10),12===S&&(S=0),S<0||S>11)return null;break;case"H":case"HH":if(S=parseInt(t,10),S<0||S>23)return null;break;case"m":case"mm":if(O=parseInt(t,10),O<0||O>59)return null;break;case"s":case"ss":if(C=parseInt(t,10),C<0||C>59)return null;break;case"tt":case"t":const e=t.toUpperCase();if(w=e===r(o,"PMDesignator").toUpperCase(),!w&&e!==r(o,"AMDesignator").toUpperCase())return null;break;case"f":if(E=100*parseInt(t,10),E<0||E>999)return null;break;case"ff":if(E=10*parseInt(t,10),E<0||E>999)return null;break;case"fff":if(E=parseInt(t,10),E<0||E>999)return null;break;case"dddd":if(v=f(n,t),v<0||v>6)return null;break;case"ddd":if(v=g(n,t),v<0||v>6)return null;break;case"zzz":const a=t.split(/:/);if(2!==a.length)return null;if(u=parseInt(a[0],10),u<-12||u>13)return null;const i=parseInt(a[1],10);if(i<0||i>59)return null;I=60*u+(t.startsWith("-")?-i:i);break;case"z":case"zz":if(u=parseInt(t,10),u<-12||u>13)return null;I=60*u;break;case"g":case"gg":let s=t;const c=r(o,"eras");if(!s||!c)return null;s=s.toLowerCase().trim();for(let e=0,t=Object.keys(c).length;e<t;e+=4)if(s===c[e+1].toLowerCase()){m=e;break}if(null===m)return null}}let j,P=new Date;const T=r(o,"Calendar").convert;if(j=T?T.fromGregorian(P)[0]:P.getFullYear(),null===b?b=j:r(o,"eras")&&(b+=r(o,"eras")[(m||0)+3]),null===y&&(y=0),null===_&&(_=1),T){if(P=T.toGregorian(b,y,_),null===P)return null}else{if(P.setFullYear(b,y,_),P.getDate()!==_)return null;if(null!==v&&P.getDay()!==v)return null}if(w&&S<12&&(S+=12),P.setHours(S,O,C,E),null!==I){const e=P.getMinutes()-(I+P.getTimezoneOffset());P.setHours(P.getHours()+e/60,e%60)}return P}n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return b}))},ldKl:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return s}));var r=n("+hKY");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const a=[{id:"PROD",allowedOriginRegex:/.*\.crm([2-8]|11|12|14|15|16|17)?\.dynamics\.com$/,config:{instrumentationKey:"0b14a44360bf4cae8e1e090ac91a04e5-3c17b97e-6b3a-4a9b-8407-6e450ff03cd2-7084"}},{id:"GCCHigh",allowedOriginRegex:/.*\.crm\.microsoftdynamics\.us$/,config:{instrumentationKey:"7d390bf951b748828d76e5d3c027faa0-9ef46ec8-2e5e-40ba-9f69-b4a13b9feca1-7148",endpointUrl:r.AWT_COLLECTOR_URL_USGOV_DOJ}},{id:"GCCModerate",allowedOriginRegex:/.*\.crm9\.dynamics\.com$/,config:{instrumentationKey:"774241b9d70e40efb34ddfb995dbfb92-37f51c02-1551-4d6c-acdd-de4f47ee6a98-7274",endpointUrl:r.AWT_COLLECTOR_URL_USGOV_DOJ}},{id:"USDoD",allowedOriginRegex:/.*\.crm\.appsplatform\.us$/,config:{instrumentationKey:"8ed6ca832b3c48d48be9c06fdc376398-e81cde17-794e-4380-852b-d01450e08d5c-7306",endpointUrl:r.AWT_COLLECTOR_URL_USGOV_DOD}},{id:"Blackforest",allowedOriginRegex:/.*\.crm\.microsoftdynamics\.de$/,config:{instrumentationKey:"1d4b56b9dd4d4ca098d7fa7c7af55ece-55115f9e-4619-474c-9aab-80a9f2027a5b-6876",endpointUrl:r.AWT_COLLECTOR_URL_GERMANY}},{id:"Mooncake",allowedOriginRegex:/.*\.crm\.dynamics\.cn$/,config:{instrumentationKey:"37e9adcd41524eb0865f13e4cc45f881-c454a26b-c97a-4b92-8df3-1f142b28b65c-7422"}},{id:"Eaglex",allowedOriginRegex:/.*\.crm\.dynamics\.eaglex\.ic\.gov$/,config:{instrumentationKey:"f466d931816843df9ecd076b45f8de3d-8f12482d-84e4-40a3-bf10-3ebc96f942ca-7776",endpointUrl:"https://collector.azure.eaglex.ic.gov/Collector/3.0/"}},{id:"TIP",allowedOriginRegex:/.*\.crm10\.dynamics\.com$/,config:{instrumentationKey:"0b14a44360bf4cae8e1e090ac91a04e5-3c17b97e-6b3a-4a9b-8407-6e450ff03cd2-7084"}},{id:"TEST",allowedOriginRegex:/(.*\.crm\.dynamics-int\.com$|.*\.crm[2]?\.crmlivetie\.com$|.*\.contoso\.com:444$|.*\.microsoft\.com$|.*\.msmecrm\.com$|.*\.crm\.crmlivetoday\.com$|.*\.crm\.1boxtest\.com$|.*\.mocaifd\d*\.com:444$|.*\.crm\.crmifd\.com$|.*\.msmecrm\.com:444$|.*localhost.*)/,config:{instrumentationKey:"2602733e020348908569f871ef40fc4b-ecb43f9d-b1e2-4034-aee3-f38471962c48-7333"}},{id:"TEST",allowedOriginRegex:/http:\/\/(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/,config:{instrumentationKey:"2602733e020348908569f871ef40fc4b-ecb43f9d-b1e2-4034-aee3-f38471962c48-7333"}}];function i(e){const t=a.find(t=>t.allowedOriginRegex.test(e));return void 0!==t?t.config:{instrumentationKey:"",endpointUrl:""}}function o(e){const t=a.find(t=>t.id===e);return void 0!==t?t.config:{instrumentationKey:"",endpointUrl:""}}function s(e){const t=a.find(t=>t.allowedOriginRegex.test(e));return void 0!==t?t.id:""}},liLA:function(e,t,n){"use strict";var r=n("nhx2");function a(){}function i(){}i.resetWarningCache=a,e.exports=function(){function e(e,t,n,a,i,o){if(o!==r){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:i,resetWarningCache:a};return n.PropTypes=n,n}},lju1:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r={ControlLablelInFormDescriptorForUserLanguage:"Control_LabelSource_ControlLablelInFormDescriptorInUserLanguage",AttributeName:"Control_LabelSource_ControlLabelNotAvailable_Fallback_To_AttributeName",TargetEntityPluralName:"Control_LabelSource_AttributeNotAvailable_Fallback_To_TargetEntityPluralName",ControlLabelInBaseLanguage:"Control_LabelSource_AttributeNotAvailable_Fallback_To_ControlLabelInBaseLanguage",ClientAPI:"Control_LabelSource_ClientAPI"}},lk80:function(e,t,n){"use strict";n.d(t,"a",(function(){return oe})),n.d(t,"b",(function(){return se}));var r=n("mMyr"),a=n("huli"),i=n("FbdD"),o=n("kAKO"),s=n("yHIv"),c=n("w1eR"),l=n("Q6x1"),u=n("6cfr"),d=n("ke4y"),p=n("QBtP"),f=n("b8TU"),g=n("eq9I"),h=n("lKf0"),m=n("olZa"),b=n("JhlA"),y=n("JRzo"),_=n("EY5k"),v=n("NjDY"),S=n("BzKn"),O=n("LOik"),C=n("K7RF");var E=n("Lyxw"),I=n("3/02");var w=n("go4y"),j=n("K9wp"),P=n("Axoi"),T=n("xkcG"),N=n("qshH");let A,R,D;class x{constructor(){this._orgSettings=new P.a(R),this._userSettings=new T.a(R),this._reporting=N.a.getInstance()}static getInstance(e,t){if(!A){if(!e)throw new Error("store is null or undefined");if(R=e,!t)throw new Error("context is null or undefined");D=t,A=new x}return A}get orgSettings(){return this._orgSettings}get firstPartyIntegrationSiteUrl(){return"https://d365fpi.azureedge.net"}get userSettings(){return this._userSettings}get OnlineSdk(){return new j.a(R,"")}get reporting(){return this._reporting}set skypeChannel(e){D.SkypeChannel.SkypeChannelClient=e}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var M=n("r/9v"),F=n("FdKt");function k(){return{type:"skypeChannel.initialize.async",execute(e,t){const n=e.getState(),r=Object(v.D)(n);return!Object(E.f)(n,I.wb)&&r.isPresenceEnabled&&Object(E.f)(n,I.Tg)&&(Object(M.c)(!0,t),e.dispatch({type:"skypeContext.initialize.async",execute:(e,t)=>t.ScriptManager.initializeContainer(w.a.SkypeChannelIframeSuffix).then(n=>{t.SkypeChannel={SkypeChannelClient:{}};let r={Context:x.getInstance(e,t)};r=Object.freeze(r),n.setGlobalVariable("SkypeContext",r)}),shouldReceiveFullStore:!0}).then(()=>{const e=t.ScriptManager.getContainer(w.a.SkypeChannelIframeSuffix);Object(F.b)(()=>e.loadWebResources([Xrm.Utility.getGlobalContext().getWebResourceUrl(w.a.WebResourcePath)]),"Load Skype Webresources")})),Promise.resolve()}}}var L=n("X7Nv"),B=n("0iNb"),U=n("E5IU"),V=n("BgaZ"),z=n("TBkx"),q=n("zI6t"),H=n.n(q),W=n("Knfm"),G=n("GEbX"),K=n("txA/"),Q=n("H4dV"),X=n("0kGT"),Y=n("IqkD"),J=n("VnTQ"),$=n("q0Q1"),Z=n("laoc"),ee=n("tJ+6"),te=n("zVFX"),ne=n("/aHX"),re=n("eIIO"),ae=n("A8zQ"),ie=n("UwOy");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const oe={renderer:Object(u.a)({selectorPrefix:"pa-"})};function se(){return{diagnosticName:"RenderApplicationShell",boot:async(e,t,o)=>{const s=t.TraceManager.getTracer("RenderApplicationShell");s.debug("MainClient renderUI started.");const u=Object(U.k)(o.getState());u&&e.getBaseUrl().searchParams.set("appid",u),H.a.addKeyPerformanceIndicator("ApplicationShellInit"),Object(_.g)();const w=Object(v.D)(o.getState());if(w&&!w.enabledLanguages){const e=[];e.push({name:"organization.initialized",value:Object(v.B)(o.getState())}),e.push({name:"organization.organizationSettings.languageCode",value:w.languageCode}),t.TraceManager.getTracer("RenderApplicationShell").error("organizationSettings.enabledLanguages not defined",e)}const j=w.enabledLanguages.map(e=>String.format(g.m,e));j.push(...y.q),j.push(...m.d),j.push(...h.s),j.push(...b.b),j.push(...g.g);const P=Object(W.a)(o.getState());let T;P===G.a.MultiSession&&j.push(...K.T),j.push(g.a),o.dispatch(Object(_.e)(j)).then(()=>{P===G.a.MultiSession&&Object(ne.b)().then(e=>o.dispatch(e.updateHomeSessionTitleAction()))}),o.dispatch(Object($.b)(o.getState())),Object(ee.b)(o.getState())&&Object(te.c)(o.getState().designLanguage),o.dispatch(Object(S.b)(o.getState())),e.getClientHost()!==c.a.MobileApplication&&o.dispatch({type:"retrieve.published.appmodule.list",execute({dispatch:e,getState:t},n){const r=Object(O.a)(t());if(!(r&&r.length>0))return e(Object(C.b)("appmodules",null,"AppModule",null,!1,1,null,[],[],null))}}),await function(e,t){const o=document.getElementById("error-app-loading-indicator");o?o.classList.add("hideErrorBlock"):t.TraceManager.getTracer("RenderApplicationShell").error("DOM element with id 'error-app-loading-indicator' was not found");const s=e.getStore();e.getClientHost()===c.a.Browser&&(document.body.style.overflow="hidden",document.body.classList.add("browserScroll"));const u={router:t.Router},g=r.createElement(d.b,u),h=r.createElement(Z.a.Provider,{value:t},g),m=r.createElement(p.a.Provider,{value:t},h),b=r.createElement(i.a,{store:s},m),y=r.createElement(l.a,oe,b),_=document.getElementById(re.b);let v;if(Object(X.c)(s.getState())){const e=document.createElement("style");document.head.appendChild(e),e.sheet.insertRule("body { -webkit-font-smoothing: antialiased; -webkit-user-select: none; user-select: none; }"),v=n.e(41).then(n.bind(null,"oi4v")).then(e=>{e.AppRegistry.registerComponent("App",()=>()=>y),e.I18nManager.forceRTL(Object(Y.g)(s.getState())),e.AppRegistry.runApplication("App",{initialProps:{},rootTag:_})}),s.dispatch(Object(J.d)())}else a.render(y,_),v=Promise.resolve();var S;if((S=_).addEventListener("pointerdown",()=>{}),S.addEventListener("mousedown",()=>{}),Q.a.getInstance().get_IsAndroid()){const t=document.getElementById("viewport-meta"),n=Object(f.b)(e.getStore().getState());t.content+=`, height=${n}px`}return t.AccessibilityManager.showOutlineState(!1),v}(e,t),s.debug("MainClient renderUI completed successfully."),Object(_.d)(o.dispatch),T=t.RestoreStateManager.shouldReInitializePages?t.RestoreStateManager.initializePages(e):e.getIsPreload()?Promise.resolve(null):Object(B.b)(e,t);const N=e.getClientHost();if(N!==c.a.MailApp){Q.a.getInstance().get_IsBrowserIE()||Object(E.f)(o.getState(),I.qf)&&!Object(ae.a)(o.getState())||o.dispatch({type:"npssurvey.initialize.async",execute(e,t){var n;const r=null===(n=Object(v.D)(e.getState()))||void 0===n?void 0:n.isCrmOrg;return Object(E.f)(e.getState(),I.Ye)&&r?t.AssetLoader.loadScript("/WebResources/msdyn_LoadNPSSurvey.js"):Promise.resolve()}}),function(e,t){e!==c.a.MobileApplication&&t.dispatch(k())}(N,o)}const A=Object(ie.d)(o.getState());return w.enableLivePersonaCardUCI&&e.getClientHost()===c.a.Browser&&!A&&n.e(131).then(n.bind(null,"FVrQ")).then(({initializeLivePersonaCard:e})=>{o.dispatch(e())}),t.ErrorHandler.addEventHandler((e,t)=>{if(t&&Object(z.i)(t.errorCode))return Object(V.a)(o)}),t.ErrorHandler.replaceBaseHandler((e,n,r,a,i,s)=>o.dispatch(Object(L.a)(s,t))),T},supportedClientHostTypes:s.a,supportedPageTypes:s.b,priority:o.a.Normal}}},llMO:function(e,t,n){"use strict";n.d(t,"a",(function(){return O})),n.d(t,"c",(function(){return w})),n.d(t,"d",(function(){return j})),n.d(t,"b",(function(){return A})),n.d(t,"e",(function(){return N}));var r=n("huli"),a=n("TEuE"),i=n("fueu"),o=n("mfAb"),s=n("SZCI"),c=n("fMBw"),l=n.n(c),u=n("pF61"),d=n("Lyxw"),p=n("3/02");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const f=l.a.createEvent("RenderingUpdate",s.y);let g,h=[],m=!1,b=[],y=b,_=[],v=!1,S=!1;function O(){P()}function C(){m||(m=!0,Object(a.f)(P,a.b))}function E(){y===b&&(y=b.slice())}function I(e){if("function"!=typeof e)throw new Error("Expected listener to be a function.");let t=!0;return E(),y.push(e),function(){if(!t)return;t=!1,E();const n=y.indexOf(e);y.splice(n,1)}}function w(e){v?e():(_.push(e),C())}function j(){S=!0,C()}function P(){m=!1;const e=h.length>0,t=f.startStopwatch({actions:h,controlUpdates:_.length});h=[];let n=0;v=!0;try{r.unstable_batchedUpdates(()=>{const t=i.a.getInstance(),r=null==g?void 0:g.getState(),a=Object(d.f)(r,p.gg),o=Object(u.f)(r);if(S&&(t.takeMeasurements(a?o:void 0),S=!1),n=t.flushPendingMeasuringNotifications(a?o:void 0),function(){const e=_.slice();_=[],e.forEach(e=>e())}(),e){const e=b=y;for(let t=0;t<e.length;t++)e[t]()}})}finally{v=!1}t({measuringUpdates:n.toString()})}function T(e,t){const n=e(t);return Object(o.b)(t)&&(h.push(t.type),C()),n}function N(e){g=e}function A(e){return(t,n)=>{const r=e(t,n),a=T.bind(null,r.dispatch);return r.dispatch=a,r.subscribeImmediate=r.subscribe,r.subscribe=I,r}}},lmfa:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("ruPX"),a=n("3rse"),i=n("H4dV"),o=n("oT5e");class s{constructor(e,t){this.store=e,this.context=t,this._setClickEvent=this._setClickEvent.bind(this),this._setKeyboardEvent=this._setKeyboardEvent.bind(this),this._clearClickEvent=this._clearClickEvent.bind(this),this._clearKeyboardEvent=this._clearKeyboardEvent.bind(this),this._registerGlobalEventHandler(e.getState(),"click",this._setClickEvent,this._clearClickEvent),this._registerGlobalEventHandler(e.getState(),"keydown",this._setKeyboardEvent,this._clearKeyboardEvent)}handleNavigation(e,t,n,r){const a=t&&t.targetBrowsingContext;if(a)return Promise.resolve(void 0);if(!a){if(r){const e=Object(o.b)(this.store.getState(),r);t.targetBrowsingContext=e&&e.id}t.targetBrowsingContext||(t.targetBrowsingContext=Object(o.g)(this.store.getState()))}if(this.context.Router.isPageADialog(n.getState(),e,t,r))return Promise.resolve(void 0);const i=window.event&&"click"===window.event.type?window.event:this._clickEvent,s=this._keydownEvent;return this._clearClickEvent(),this._clearKeyboardEvent(),this.handleNavigationInternal(e,t,i,s,n,this.context)}handleNavigationInternal(e,t,n,a,i,o){return this.shouldPerformCtrlKeyAction(n,a)?Promise.resolve(Object(r.b)(o,e.pageName,e.input)):this.shouldPerformShiftKeyAction(n,a)?i.dispatch(Object(r.c)(e.pageName,e.input)):Promise.resolve(void 0)}shouldPerformCtrlKeyAction(e,t){return e&&this.wasCmdOrCtrlKeyPressed(e)||t&&t.keyCode===a.a.Enter&&this.wasCmdOrCtrlKeyPressed(t)}shouldPerformShiftKeyAction(e,t){return e&&e.shiftKey||t&&t.keyCode===a.a.Enter&&t.shiftKey}wasCmdOrCtrlKeyPressed(e){return e.ctrlKey||this._wasMacCmdKeyPressed(e)}_wasMacCmdKeyPressed(e){const t=i.a.getInstance();return t&&!t.get_IsWinDesktop()&&e.metaKey}_clearClickEvent(){this._clickEvent=void 0}_clearKeyboardEvent(){this._keydownEvent=void 0}_setClickEvent(e){this._clickEvent=e}_setKeyboardEvent(e){this._keydownEvent=e}_registerGlobalEventHandler(e,t,n,r){window.addEventListener(t,e=>{n(e),setTimeout(()=>setTimeout(()=>setTimeout(()=>setTimeout(()=>setTimeout(()=>setTimeout(r,0),0),0),0),0),0)},!0)}}},lq82:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return l})),n.d(t,"c",(function(){return s}));var r=n("Tz6o"),a=n("QHx/"),i=n("Lyxw"),o=n("3/02");function s(e,t){return{type:"update.navigation.history.sync",sync:!0,execute({dispatch:n,getState:s},c){const l=c.Router.getHistoryManager();let u=l.GetState();if(n(Object(r.f)(e,t||u.pageId)),Object(i.f)(s(),o.Yf)&&(u=Object.assign(Object.assign({},u),{[r.a]:e})),!t||u.pageId===t){const t=c.Router.createUrlForPage(u.pageName,e),n=Object(a.a)(s(),u.pageId);l.ReplaceState(u,t,n)}}}}function c(e,t,n){return{type:"set.item.in.history.state",sync:!0,execute({dispatch:r,getState:i},o){const s=o.Router.getHistoryManager(),c=s.GetState();if(!n||c.pageId===n){const n=o.Router.getHistoryManager().GetCurrentUrl(),r=Object(a.a)(i(),c.pageId),l=Object.assign(Object.assign({},c),{[e]:t});s.ReplaceState(l,n,r)}}}}function l(e,t){return{type:"get.item.from.history.state",sync:!0,execute({dispatch:n,getState:r},a){const i=a.Router.getHistoryManager().GetState();if(!t||i.pageId===t)return i[e]}}}},lx8z:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("nxt5");class a extends r.a{constructor(e){super("InitializeFrom"),this._entity=null,this._entity=e}get_entity(){return this._entity}}},lza4:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="commanding.set.xmrobjectready";function a(e,t,n){return{type:r,payload:n,meta:{pageId:e,contextKey:t}}}},m2nm:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="router.set.disable.navigateback";function a(e,t){return{type:r,payload:{disableNavigateBack:e,browsingContextId:t}}}},m4EA:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="Brand_CRM_Short",a="Brand_PowerApps",i=[r,a]},mASP:function(e,t,n){"use strict";n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return s}));var r=n("K7RF"),a=n("eXjw"),i=n("BHck"),o=n("iJGp");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const s="purgeAppRelatedMetadata.sync";function c(){return{type:"retrieveOfflineAppDescriptors.async",execute({dispatch:e,getState:t},n){const s=t(),c=Object(i.a)(s);if(c.offlineAppDescriptorsInitialized===a.a.Initialized)return Promise.resolve(c);e(function(){const e={landingPageOfflineMetadata:{offlineAppDescriptorsInitialized:a.a.Initializing}};return{type:r.a,payload:e}}());return e(Object(r.b)("appmoduleselector",null,null,null,!1,o.a.OnDemandWithoutContext,null,null,[],null))}}}function l(){return{type:s,payload:{views:undefined,viewDefaults:undefined,viewSelectors:undefined,forms:undefined,formDefaults:undefined,formSelectors:undefined,charts:undefined,chartDefaults:undefined,chartSelectors:undefined,dashboards:undefined,dashboardSelectors:undefined,dashboardsByNavPath:undefined,dashboardsByEntityName:undefined,dashboardSelectorsByEntityName:undefined,dialogs:undefined,businessProcessFlows:undefined,businessProcessFlowsDefault:undefined,quickCreateMenu:undefined,appShellSettings:undefined,offlineSync:undefined,siteMap:undefined,appContext:undefined}}}},mDek:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n("84PK"),a=n("504W"),i=n("NMtn"),o=n("2JG5"),s=n("jFgV"),c=n("xAYq"),l=n("dFCJ"),u=n("/A0C"),d=n("nTyX");class p{constructor(e,t,n,r,a,o,s,c,l,d,p,f,g,h,m,b,y,_,v,S,O,C,E,I,w,j,P,T,N,A,R,D,x,M,F,k){this._id=null,this._logicalName=null,this._type=u.a.Boolean,this._sourceType=0,this._entityLogicalName=null,this._displayName=null,this._formatName=null,this._attributeTypeName=null,this._description=null,this._columnNumber=0,this._sourceTypeMask=0,this._isSecured=!1,this._isValidForCreate=!1,this._isValidForRead=!1,this._isValidForUpdate=!1,this._isValidForGrid=!1,this._requiredLevel=0,this._maxLength=0,this._minValue=0,this._maxValue=0,this._precision=0,this._precisionSource=0,this._format=null,this._behavior=0,this._defaultFormValue=0,this._defaultValue=!1,this._isBaseCurrency=!1,this._optionSet=null,this._targets=null,this._attributeOf=null,this._hasChanged=!1,this._isSortableEnabled=!1,this._imeMode=0,this._inheritsFrom=null,this._isLocalizable=!1,this._isCustomAttribute=!1,this._canBeSecuredForCreate=!1,this._canBeSecuredForRead=!1,this._canBeSecuredForUpdate=!1,this._isLogical=!1,Object(i.d)(e,"logicalName"),Object(i.d)(t,"id"),Object(i.d)(r,"type"),Object(i.d)(p,"requiredLevel"),Object(i.d)(o,"isSecured"),Object(i.d)(s,"isValidForCreate"),Object(i.d)(c,"isValidForRead"),Object(i.d)(l,"isValidForUpdate"),this._logicalName=e,this._id=t,this._entityLogicalName=n,this._type=r,this._sourceType=N,this._displayName=a,this._isSecured=o,this._isValidForCreate=s,this._isValidForRead=c,this._isValidForUpdate=l,this._isValidForGrid=d,this._requiredLevel=p,this._maxLength=f,this._minValue=g,this._maxValue=h,this._precision=m,this._precisionSource=b,this._format=y,this._behavior=_,this._defaultFormValue=v,this._defaultValue=S,this._optionSet=O,this._targets=E,this._isBaseCurrency=C,this._attributeOf=I,this._hasChanged=w,this._isSortableEnabled=P,this._imeMode=j,this._inheritsFrom=T,this._isLocalizable=A,this._isCustomAttribute=R,this._columnNumber=D,this._canBeSecuredForCreate=x,this._canBeSecuredForRead=M,this._canBeSecuredForUpdate=F,this._isLogical=k}get_id(){return this._id}get_logicalName(){return this._logicalName}get_entityLogicalName(){return this._entityLogicalName}get_type(){return this._type}get_sourceType(){return this._sourceType}get_displayName(){return this._displayName}get_isValidForCreate(){return this._isValidForCreate}get_isSecured(){return this._isSecured}get_isValidForUpdate(){return this._isValidForUpdate}get_isValidForGrid(){return this._isValidForGrid}get_isValidForRead(){return this._isValidForRead}get_requiredLevel(){return this._requiredLevel}get_maxLength(){return this._maxLength}get_minValue(){return this._minValue}get_maxValue(){return this._maxValue}get_precision(){return this._precision}get_precisionSource(){return this._precisionSource}get_format(){return this._format}get_formatName(){return this._formatName}get_behavior(){return this._behavior}get_isBaseCurrency(){return this._isBaseCurrency}get_defaultFormValue(){return this._defaultFormValue}get_defaultValue(){return this._defaultValue}get_optionSet(){return this._optionSet}get_targets(){return this._targets}get_attributeOf(){return this._attributeOf}get_hasChanged(){return this._hasChanged}get_isSortableEnabled(){return this._isSortableEnabled}get_imeMode(){return this._imeMode}get_inheritsFrom(){return this._inheritsFrom}get_isLocalizable(){return this._isLocalizable}get_isCustomAttribute(){return this._isCustomAttribute}get_columnNumber(){return this._columnNumber}get_canBeSecuredForCreate(){return this._canBeSecuredForCreate}get_canBeSecuredForRead(){return this._canBeSecuredForRead}get_canBeSecuredForUpdate(){return this._canBeSecuredForUpdate}get_isLogical(){return this._isLogical}getObjectData(){const e=this._getKeyPaths();return Object.assign(Object.assign({},e),{type:Object(d.e)(this._type),sourcetype:this._sourceType,displayname:this._displayName,issecured:this._isSecured,issortableenabled:this._isSortableEnabled,isvalidforcreate:this._isValidForCreate,isvalidforupdate:this._isValidForUpdate,isvalidforread:this._isValidForRead,isvalidforgrid:this._isValidForGrid,requiredlevel:this._requiredLevel,maxlength:this._maxLength,minvalue:this._minValue,maxvalue:this._maxValue,precision:this._precision,precisionsource:this._precisionSource,defaultformvalue:this._defaultFormValue,defaultvalue:this._defaultValue,format:this._format,behavior:this._behavior,isbasecurrency:this._isBaseCurrency,attributeof:this._attributeOf,haschanged:this._hasChanged,imemode:this._imeMode,inheritsfrom:this._inheritsFrom,islocalizable:this._isLocalizable,formatName:this._formatName,description:this._description,columnNumber:this._columnNumber,sourceTypeMask:this._sourceTypeMask,attributeTypeName:this._attributeTypeName,IsCustomAttribute:this._isCustomAttribute,optionset:Object(a.a)(this._optionSet)?void 0:this._optionSet.getObjectData(),targets:Object(a.a)(this._targets)?void 0:this._targets,canBeSecuredForCreate:this._canBeSecuredForCreate,canBeSecuredForRead:this._canBeSecuredForRead,canBeSecuredForUpdate:this._canBeSecuredForUpdate,isLogical:this._isLogical})}getODataObject(){return{LogicalName:this._logicalName,MetadataId:this._id.toString(),EntityLogicalName:this._entityLogicalName,EntityAttributeLogicalNames:this._entityLogicalName+c.a+this._logicalName,AttributeType:Object(d.e)(this._type),AttributeTypeName:p.addValueWrapper(("double"===this._attributeTypeName?"Float":this._attributeTypeName)+"Type"),Description:o.a.convertToLabel(this._description),ColumnNumber:this._columnNumber,FormatName:p.addValueWrapper(this._formatName),SourceTypeMask:this._sourceTypeMask,OptionSet:Object(a.a)(this._optionSet)?void 0:this._optionSet.getODataObject(),SourceType:this._sourceType,DisplayName:o.a.convertToLabel(this._displayName),IsSecured:this._isSecured,IsSortableEnabled:p.addValueWrapper(this._isSortableEnabled),IsValidForCreate:this._isValidForCreate,IsValidForUpdate:this._isValidForUpdate,IsValidForRead:this._isValidForRead,IsValidForGrid:this._isValidForGrid,RequiredLevel:p.addValueWrapper(this._requiredLevel),MaxLength:this._maxLength,MinValue:this._minValue,MaxValue:this._maxValue,Precision:this._precision,PrecisionSource:this._precisionSource,DefaultFormValue:this._defaultFormValue,DefaultValue:this._defaultValue,Format:Object(a.a)(this._format)?void 0:parseInt(this._format,10),DateTimeBehavior:p.addValueWrapper(Object(l.c)(this._behavior)),IsBaseCurrency:this._isBaseCurrency,AttributeOf:this._attributeOf,HasChanged:this._hasChanged,ImeMode:this._imeMode,InheritsFrom:this._inheritsFrom,IsLocalizable:this._isLocalizable,IsCustomAttribute:this._isCustomAttribute,Targets:Object(a.a)(this._targets)?void 0:this._targets,CanBeSecuredForCreate:this._canBeSecuredForCreate,CanBeSecuredForRead:this._canBeSecuredForRead,CanBeSecuredForUpdate:this._canBeSecuredForUpdate,isLogical:this._isLogical}}getStorableODataObject(){return Object.assign(Object.assign({},this._getKeyPaths()),this.getODataObject())}_getKeyPaths(){return{id:this._id.getObjectData(),[p.logicalNamePath]:this._logicalName,[p.entityLogicalNamePath]:this._entityLogicalName,[p.entityAttributeLogicalNamesPath]:this._entityLogicalName+c.a+this._logicalName}}static extractKey(e){const t=e.id;return t?r.a.createFromObjectData(t).toString():e.Id}static addValueWrapper(e){const t={};return t.Value=e,t}static removeValueWrapper(e){return e?e.Value:null}static createFromObjectData(e){if(!Object(a.b)(e.MetadataId)){e=p.createFromODataResponse(e).getObjectData()}const t=new p(e.logicalname,r.a.createFromObjectData(e.id),e.entitylogicalname,Object(d.c)(e.type),e.displayname,e.issecured,e.isvalidforcreate,e.isvalidforread,e.isvalidforupdate,e.isvalidforgrid,e.requiredlevel,e.maxlength,e.minvalue,e.maxvalue,e.precision,e.precisionsource,e.format,e.behavior,e.defaultformvalue,e.defaultvalue,e.optionset&&s.a.createFromObjectData(e.optionset),e.isbasecurrency,e.targets,e.attributeof,e.haschanged,e.imemode,e.issortableenabled,e.inheritsfrom,e.sourcetype,e.islocalizable,e.IsCustomAttribute,e.columnNumber,e.canBeSecuredForCreate,e.canBeSecuredForRead,e.canBeSecuredForUpdate,e.isLogical);return t._formatName=e.formatName,t._description=e.description,t._sourceTypeMask=e.sourceTypeMask,t._attributeTypeName=e.attributeTypeName,e.type===d.a.Virtual&&(e.attributeTypeName===u.a.File&&(t._type=u.a.File),e.attributeTypeName===u.a.Image&&(t._type=u.a.Image)),t}static createFromODataResponse(e){const t=e.LogicalName,n=r.a.tryCreate(e.MetadataId),i=e.EntityLogicalName,c=Object(d.c)(e.AttributeType);let u=p.removeValueWrapper(e.AttributeTypeName);const f=new RegExp("Type","g");u=u.replace(f,"").toLowerCase(),"float"===u&&(u="double");const g=e.SourceType,h=o.a.getLabelString(e.Description),m=o.a.getLabelString(e.DisplayName),b=p.removeValueWrapper(e.RequiredLevel);let y;y="string"==typeof b?Object(l.e)(b):b;const _=e.IsSecured,v=e.IsValidForCreate,S=e.IsValidForUpdate,O=e.IsValidForGrid,C=e.IsValidForRead,E=e.ColumnNumber,I=e.SourceTypeMask,w=e.MaxLength,j=e.MinValue,P=e.MaxValue,T=e.Precision,N=e.PrecisionSource,A=e.Format;let R=null;Object(a.a)(A)||(R=A.toString());const D=p.removeValueWrapper(e.FormatName),x=p.removeValueWrapper(e.DateTimeBehavior);let M=0;Object(a.a)(x)||(M=Object(l.d)(x));const F=e.DefaultFormValue,k=e.DefaultValue,L=e.IsBaseCurrency,B=e.AttributeOf,U=e.HasChanged,V=p.removeValueWrapper(e.IsSortableEnabled),z=e.ImeMode,q=e.InheritsFrom,H=e.IsLocalizable,W=e.IsCustomAttribute;let G=null;const K=e.OptionSet;if(!Object(a.a)(K)&&"object"==typeof K){const e=K.Options;if(Object(a.a)(e)){const e=K.TrueOption,t=K.FalseOption;if(e&&t){const n=[t,e];G=s.a.createFromOData(n)}}else G=s.a.createFromOData(e)}const Q=e.Targets,X=e.CanBeSecuredForCreate,Y=e.CanBeSecuredForRead,J=e.CanBeSecuredForUpdate,$=e.isLogical,Z=new p(t,n,i,c,m,_,v,C,S,O,y,w,j,P,T,N,R,M,F,k,G,L,Q,B,U,z,V,q,g,H,W,E,X,Y,J,$);return Z._formatName=D,Z._description=h,Z._sourceTypeMask=I,Z._attributeTypeName=u,Z}}p.entityLogicalNamePath="entitylogicalname",p.logicalNamePath="logicalname",p.entityAttributeLogicalNamesPath="entitylogicalname_logicalname"},mKIe:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.start=0]="start",e[e.end=1]="end",e[e.none=2]="none"}(r||(r={}))},mL5Q:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("jq7Z");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t){var n;return null===(n=Object(r.a)(e,t))||void 0===n?void 0:n.loadingState}},mf7K:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("1DaZ"),a=n("XSLb"),i=function(){function e(){}return e.logManagerContext=new r.default,e.sessionEnabled=!0,e.loggingEnabled=!1,e.defaultTenantToken="",e.semanticContext=new a.default(!0,e.logManagerContext),e}();t.default=i},mfAb:function(e,t,n){"use strict";function r(e){return void 0===e.execute}function a(e){return!r(e)&&!e.sync}n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r}))},mfZ0:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="plugins.initialize";function a(e){return{type:r,payload:e}}},ml6Y:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e.offlineDatabaseInformationKey="offlinedatabaseinformation",e.isMobileOfflineOptedInKey="ismobileofflineoptedin",e.isMobileOfflineOptedOutKey="ismobileofflineoptedout",e.norsyncServerConnectionStringKey="norsyncserverconnectionstring",e.isTrialOrganizationKey="offlineistrialdeployment",e.isMocaOfflineFCBEnabledKey="isMocaOfflineFeatureEnabled",e.OfflineProfileIdKey="profileid",e.OfflineProfileVersionKey="profileversion",e.OfflineProfileAvailableEntitiesKey="offlineavailableentities",e.OfflineEntityPluralNamesKey="offlineentitypluralnames",e.OfflineProfileDataKey="LastRetrievedOfflineProfileData",e.OfflineDatabaseKey="offlinedatabasekey",e.OfflineDisabledInfoKey="offlinedisabledinfo",e.MetadataVersionUsedKey="metadataversionused",e.OfflineDisabledEntitiesKey="offlinedisabledentities",e.OfflineMetatdataSyncStatusKey="offlinemetadatasyncstatus",e.LastSuccessfulSaveOnCrmKey="lastsuccessfulsaveoncrm",e.SyncErrorFailureMapKey="SyncErrorFailureMap",e.MaxTimeKey="MaxTime",e.OfflinePrimaryAvailableEntitiesKey="offlineprimaryavailableentitieskey",e.IsOfflineUpgradeDoneKey="isofflineupgradedone",e.OfflineApplyApplicationMetadataChangesKey="offlineapplyapplicationmetadatachangeskey",e.IsFirstApplyApplicationMetadataChangesDoneKey="isfirstapplyapplicationmetadatachangesdonekey",e.IsFirstApplicationMetadataDownloadConfirmationDoneKey="isfirstapplicationmetadatadownloadconfirmationdonekey",e.IsOfflineFirstTimeSyncCompletedKey="isofflinefirsttimesynccompletedkey",e.IsFirstTimeDataSyncCompletedKey="isfirsttimedatasynccompletedkey",e.IsFirstTimeMetadataValidationCompletedKey="isfirsttimemetadatavalidationcompletedkey",e.ClientVersionKey="clientVersion",e.IsUserSelectOffline="isuserselectofflinevalue"}(r||(r={}))},mlvZ:function(e,t,n){"use strict";n.d(t,"b",(function(){return U})),n.d(t,"f",(function(){return V})),n.d(t,"e",(function(){return q})),n.d(t,"j",(function(){return H})),n.d(t,"i",(function(){return W})),n.d(t,"d",(function(){return z})),n.d(t,"g",(function(){return G})),n.d(t,"c",(function(){return K})),n.d(t,"h",(function(){return X})),n.d(t,"a",(function(){return L}));var r=n("8mbc"),a=n("5UJb"),i=n.n(a),o=n("pEXn"),s=n("zI6t"),c=n.n(s),l=n("5ylf"),u=n("SZCI"),d=n("wF0i"),p=n("uvnT"),f=n("y+Z1");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const g={};g[s.KPI_ZONE]={[u.m]:[o.b.LookupDialogParameters.DefaultEntityType,o.b.LookupDialogParameters.DefaultViewId,o.b.LookupDialogParameters.EntityTypes,o.b.LookupDialogParameters.ViewIds,o.b.LookupDialogParameters.AllowMultiSelect,o.b.EntityName,o.b.WebResourceName,o.b.ModalDialogType,o.b.UniqueName,o.b.PowerBIComponentTypeCode,o.b.ViewId,o.b.VisualizationId,o.b.DesignerType,o.b.SolutionId,o.b.ComponentId,o.b.CustomControlId,o.b.DashboardNavPath,o.b.DashboardId,o.b.DashboardType,o.b.ShowDefaultDashboard,o.b.DashboardTypeFlags,o.b.BoundDashboardEntity,o.b.RetrievedDashboardId,o.b.BenchmarkControlName,o.b.BenchmarkElementNumber,o.b.ModelFormComponent.IsPreInitialized,o.b.SearchParameters.IsNewSearchExperience,o.b.FormId,o.b.PageLoadParameters.JsHeapSizeLimit,o.b.PageLoadParameters.TotalJSHeapSize,o.b.PageLoadParameters.UsedJSHeapSize],[d.a]:[o.b.PageLoadParameters.NumberOfControls],[d.b]:[o.b.PageLoadParameters.NumberOfRibbons],[d.c]:[o.b.PageInfraReadyParameters.RenderedControls,o.b.EntityName,o.b.DashboardId,o.b.DashboardType,o.b.ShowDefaultDashboard,o.b.DashboardTypeFlags,o.b.BoundDashboardEntity,o.b.RetrievedDashboardId,o.b.CustomControlId],SaveForm:[o.a.CorrelationId,o.b.SaveFormParameters.SaveMode,o.b.FormParameters.PageId,o.b.FormParameters.IsMainFormDialog,o.b.EntityName,o.b.FormParameters.EntityId,o.b.FormId],CategorizedSearch:[o.b.SearchParameters.SearchFilter,o.b.SearchParameters.IsBarcodeScan],RelevanceSearch:[o.b.SearchParameters.SearchWithoutFilters,o.b.SearchParameters.SearchSessionId,o.b.SearchParameters.IsNewSearchExperience],GlobalSearchFlyout:[o.b.SearchParameters.SearchSessionId,o.b.SearchParameters.UsingSuggestion],"TaskBasedFlow.loadDataAndInitializeComponentsAction":[o.b.TaskBasedFlowParameters.PrimaryModelName,o.b.TaskBasedFlowParameters.RecordId],"Commanding.Actions.ExecuteCommand":[o.b.CommandingParameters.CommandType,o.b.CommandingParameters.CommandId,o.b.CommandingParameters.ControlId,o.b.CommandingParameters.CommandManagerId,o.b.CommandingParameters.PageId,o.b.CommandingParameters.ExecuteWarningEntityName,o.b.CommandingParameters.SelectedItemsCount,o.b.CommandingParameters.UrlActionCount,o.b.CommandingParameters.JavascriptActionCount,o.b.CommandingParameters.LibraryCount],"MDD.Performance.DialogButtonClick":[o.b.DialogButtonClickParameters.ControlId,o.b.DialogButtonClickParameters.DialogUniqueName],"MDD.Performance.DialogXClick":[o.b.DialogXClickParameters.DialogUniqueName,o.b.DialogXClickParameters.SourceType],"Forms.QuickFormCardControl.UpdateView":[o.b.QuickFormCardControlUpdateViewParameters.HasParametersValue,o.b.QuickFormCardControlUpdateViewParameters.PageType,o.b.QuickFormCardControlUpdateViewParameters.PageEntityType,o.b.QuickFormCardControlUpdateViewParameters.EntityType,o.b.QuickFormCardControlUpdateViewParameters.ControlId,o.b.QuickFormCardControlUpdateViewParameters.TraceLocation],"BPF.StageButtonClick":[o.b.BpfStageButtonClickParameters.StageButtonName,o.b.BpfStageButtonClickParameters.StageId],"BPF.RenderProcessControl":[o.b.BpfProcessControlRenderParameters.ProcessId,o.b.BpfProcessControlRenderParameters.BusinessProcessFlowInstanceId,o.b.BpfProcessControlRenderParameters.PageId,o.b.BpfProcessControlRenderParameters.EntityTypeCode,o.b.BpfProcessControlRenderParameters.EntityId,o.b.BpfProcessControlRenderParameters.CorrelationId],"BPF.ActionStepButtonClick":[o.b.BpfActionStepButtonClickParameters.ActionStepIdKey],[f.a]:[o.b.FormTabSwitch.TabName]},g[u.d]={[p.a]:[o.b.BootPerformanceParameters.BundleName]};const h={};h[s.KPI_ZONE]=[o.n.CleanLoad,o.b.PageLoadParameters.LoadQuality,o.b.PageLoadParameters.FirstInteractionName,o.b.PageLoadParameters.FirstInteractionTime,o.b.PageLoadParameters.Interactions,o.n.IsBoot,o.b.PageLoadParameters.NetworkRequestInfo,o.b.PageLoadParameters.NetworkRequests,o.b.PageLoadParameters.FirstAppStart,o.b.BootPerformanceParameters.IsStateRestore,o.n.PageName,o.n.LoadType,o.b.PageLoadParameters.NavigationOrigin,o.b.PageLoadParameters.TimeSinceIdle,o.b.PageLoadParameters.ColdLatency,o.b.PageLoadParameters.WarmLatency,o.b.PageLoadParameters.WarmThroughput,o.b.PageLoadParameters.Automation,o.b.PageLoadParameters.IdleTasks,o.b.ShimBootParameters.ShimBootType,o.b.PageLoadParameters.Attribution,o.b.PageLoadParameters.CustomScriptTime,o.b.PageLoadParameters.SyncRequestTime,o.b.WorkBlockKpi,o.b.MultipleWorkBlockKpi,o.b.PageLoadParameters.ZoneActivity,o.b.FormId,o.b.FormParameters.PageId,o.b.FormParameters.IsMainFormDialog],h[l.NETWORK_REQUEST_EVENT_NAME]=[],h.Shim=[],h[u.B]=[],h[u.a]=[],h[u.C]=[],h[u.n]=[],h[u.v]=[],h[u.k]=[],h[u.l]=[],h[u.p]=[],h[u.h]=[];const m=[],b=["Fetch","XMLHttpRequest","RequestPatch"];class y{constructor(e){this._eventManager=e}writeMarker(e,t,n){const r=i.a.getLastWorkBlockStartTime();n||(n={}),this._sendToTelemetry(e,t-r,n,r)}writeRetroactiveTimespan(e,t,n,r){this._sendToTelemetry(e,n,r,t)}startTimespan(e,t,n){return(r,a)=>{this._sendToTelemetry(e,r,Object.assign(Object.assign({},n),a),t)}}_sendToTelemetry(e,t,n,r){let a=[];const i=e.getZone();if(i===u.g)e.getName().startsWith("msdyn.")&&(n&&(a=Object.keys(n).map(e=>({name:e,value:n[e]}))),this._reportEvent(e,t,a,r));else{if((i===l.NETWORK_REQUEST_EVENT_NAME&&-1===b.indexOf(e.getName())||i===u.d)&&t<50)return;if(n){const r="name",c="url";if(n[r]&&n[r].indexOf("crminsightseventdata")>=0||n[c]&&n[c].indexOf("crminsightseventdata")>=0||n[r]&&n[r].indexOf("pipe.aria.microsoft.com")>=0||n[c]&&n[c].indexOf("pipe.aria.microsoft.com")>=0)return;i===s.KPI_ZONE&&void 0!==n[o.b.PageLoadParameters.TimeSinceIdle]&&(n[o.n.CleanLoad]=function(e,t,n){if(t<0)return 0;const r=n[o.b.PageLoadParameters.LoadQuality];if(r&&0!=(7&Number(r)))return 0;const a=n[o.b.PageLoadParameters.IdleTasks];if(e===u.m&&"true"===a)return 0;const i=n[o.b.MultipleWorkBlockKpi];if(i&&"true"===i.toString())return 0;const s="true"===n[o.n.IsBoot].toString(),c=n[o.b.PageLoadParameters.TimeSinceIdle];if(!s&&c&&Number(c)>=600)return-1;const l=n[o.b.PageLoadParameters.FirstInteractionTime];return l&&Number(l)>300?-2:1}(e.getName(),t,n).toString());const l=h[i],d=g[i]&&g[i][e.getName()]||[];for(const e in n)(l&&(0===l.length||l.indexOf(e)>=0)||d.indexOf(e)>=0)&&a.push({name:e,value:n[e],forceOwnColumn:m.indexOf(e)>-1})}this._reportEvent(e,t,a,r)}}_reportEvent(e,t,n,r){this._eventManager.ReportComponentPerformance(e.getZone(),e.getName(),t,n,r)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class _{constructor(){this._workBlockKPIs=[];const e=localStorage.getItem("WorkBlockKPI");e?this._workBlockKPIs=JSON.parse(e):localStorage.setItem("WorkBlockKPI",JSON.stringify([]))}writeMarker(e,t,n){const r=n[o.b.WorkBlockKpi];if(r&&"true"===r.toString()){const r=i.a.getLastWorkBlockStartTime();this._workBlockKPIs.push({name:e.getName(),duration:t-r,parameters:n}),localStorage.setItem("WorkBlockKPI",JSON.stringify(this._workBlockKPIs))}}writeRetroactiveTimespan(e,t,n,r){}startTimespan(e,t,n){return(e,t)=>{}}getWorkBlockKPIs(){return this._workBlockKPIs}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class v{constructor(e,t){this._traceManager=e,this._durationThresholds=t}writeMarker(e,t,n){this._checkThreshold(e,t-i.a.getLastWorkBlockStartTime(),n)}writeRetroactiveTimespan(e,t,n,r){this._checkThreshold(e,n,r)}startTimespan(e,t,n){return(t,r)=>{this._checkThreshold(e,t,Object.assign(Object.assign({},n),r))}}_checkThreshold(e,t,n){const r=this._durationThresholds[e.getZone()];if(r&&t>r){const a=[];a.push({name:"Zone",value:e.getZone()}),a.push({name:"Name",value:e.getName()}),a.push({name:"Duration",value:t}),a.push({name:"Threshold",value:r});for(const e in n)a.push({name:e,value:n[e]});this._traceManager.getTracer("Performance").warn("Duration for stopwatch exceeded threshold.",a)}}}var S=n("HmIo"),O=n("fMBw"),C=n.n(O),E=n("bsQO"),I=n("Kj0E"),w=n("WbTV"),j=n("SSL+"),P=n("a475"),T=n("31Vn"),N=n("SRlt"),A=n("GYEz"),R=n("w1eR");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
let D,x,M,F,k=!1;const L="enable.performance.ui",B={};function U(e){const t=e.searchParams.get(u.u),n=window.UCIPerformanceToolsEnabled;k=(!0===n||"true"===t)&&!(!1===n||"false"===t),k&&e.searchParams.set(u.u,"true")}function V(){return k}function z(e){c.a.enableOptionalComponents(),-1!==navigator.userAgent.indexOf("Chrome")&&"Google Inc."===navigator.vendor&&C.a.registerTransport(new S.BrowserTimelineTransport,[u.y,u.E,"Core.Boot"]),Object(E.c)(F);const t=!!performance.memory;if(e===R.a.MobileApplication){const e=P.a.get_Instance();e.add_onReadyOrNow(()=>{Object(I.setMemoryCollector)(()=>new Promise(t=>{e.get_application().getMemoryUsage(e=>{t(e)})}),1e3)})}else t?Object(I.setMemoryCollector)(e=>new Promise(t=>{if(e){const e=window.gc;e?e():console.log('[PerfUtils] Garbage collector is not exposed. You may want to start Chrome with --js-flags="--expose-gc" (and --enable-precise-memory-info) for more accurate memory measurement')}t(performance.memory.usedJSHeapSize)}),1e3):console.warn("Memory collection is not supported on this platform.");Object(w.setNetworkRequestTypeFilter)({metadata:j.b})}function q(){if(M){if(V())return;k=!0;z(Object(A.a)(M.getState())),M.dispatch({type:L,payload:!0})}}function H(e){M=e}function W(e){F=e}function G(e){e.DebugSettingsHandler.registerSettingsHandler(r.b.Performance,t=>function(e,t,n){const r=[s.KPI_ZONE,"Core.Boot",u.A,u.j,"InAppShell",l.NETWORK_REQUEST_EVENT_NAME,u.g,u.C,u.n,u.h];t&&r.push(...t),r.push("MscrmControls.EstimatesGridControls.EstimatesGridControl","MscrmControls.ProjectTaskControls.ProjectTaskControl","MscrmControls.ReconciliationControls.ReconciliationControl",u.v,u.B,u.a,u.k,u.l,u.p),D&&C.a.removeTransport(D),D=new y(e.EventManager),C.a.registerTransport(D,r);const a=Object.assign(Object.assign({},B),n);x&&C.a.removeTransport(x),x=new v(e.TraceManager,a),C.a.registerTransport(x,Object.keys(a));try{localStorage.getItem("WorkBlockKPI")&&window.CollectKPI()}catch(e){}}(e,t.Zones,t.Thresholds))}function K(e){return e.reduce((e,t)=>(e[t.name]=t.value&&t.value.toString()||"",e),{})}function Q(e){return N.c.canLogDetailsOfRequest(e)?e:Object(T.a)(e,!0)}function X(e,t,n){var r;try{const a=Object.assign({},n);if(e===o.r.Name){const e=t[o.r.CommonError.Message];e===w.SYNC_XHR_MESSAGE?a.Param0&&(a.Param0=Q(a.Param0)):"Duration for stopwatch exceeded threshold."===e&&(a[u.F]&&(a[u.F]=Q(a[u.F])),a[u.w]&&(a[u.w]=Q(a[u.w])))}else if(e===o.n.Name&&t[o.n.CommonAction.Common.ComponentName]===l.NETWORK_REQUEST_EVENT_NAME&&(a.name&&(a.name=Q(a.name)),a.url&&(a.url=Q(a.url)),a.body)){const e=null===(r=a.body.split("GET "))||void 0===r?void 0:r.slice(1);e&&(a.body=JSON.stringify(e.map(Q)))}return a}catch(e){return n}}B.WebService=5e3;let Y=null;window.CollectKPI=()=>{Y||(Y=new _,C.a.registerTransport(Y,[s.KPI_ZONE]))},window.StopCollectingKPI=()=>{if(Y){C.a.removeTransport(Y);const e=Y.getWorkBlockKPIs();return Y=null,localStorage.removeItem("WorkBlockKPI"),e}}},mpSO:function(e,t,n){"use strict";n.d(t,"g",(function(){return r})),n.d(t,"h",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"e",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"j",(function(){return l})),n.d(t,"f",(function(){return u})),n.d(t,"l",(function(){return d})),n.d(t,"m",(function(){return p})),n.d(t,"n",(function(){return f})),n.d(t,"k",(function(){return g})),n.d(t,"i",(function(){return h})),n.d(t,"o",(function(){return m})),n.d(t,"c",(function(){return b}));
/**
 * Constants for the editform.
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="OverflowButton",a="OverflowFlyout",i="CommandBar",o="crm_header_global",s="Commanding",c="CreateCommandManager",l="ribbon.setCmdInitState",u=960,d=768,p="ribbon.storeaddedcommands",f="ribbon.storeappendedcommands",g="NULL",h="More",m="MoreVertical";var b;!function(e){e[e.TableGridCommand=1]="TableGridCommand",e[e.QuickActionCommand=2]="QuickActionCommand",e[e.TableGridAndQuickActionCommand=3]="TableGridAndQuickActionCommand"}(b||(b={}))},"n/MI":function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var r=n("X37l"),a=n("SFgX"),i=n("A2T2"),o=n("69Qu"),s=n("iZ7K"),c=n("Xi8U"),l=n("YxC/"),u=n("8a7L"),d=n("nInZ"),p=n("ws6F"),f=n("Fn63"),g=n("N2HV");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const h=["systemform","userform"];class m{constructor(e,t,n,r,a,i,o){this._id=e,this._entityTypeName=t,this._title=n,this._icon=a,this._onClickHandler=r,this._subActionDescriptor=i,this._pinStatus=o}get pinStatus(){return this._pinStatus}get id(){return this._id}get entityTypeName(){return this._entityTypeName}get title(){return this._title}get icon(){return this._icon}get subActionDescriptor(){return this._subActionDescriptor}get onClickHandler(){return this._onClickHandler}static FromStateItem(e,t,n){return e.ObjectId?function(e,t,n){const b=d.a,y=function(e){if(h.indexOf(e)>-1)return new u.a("dashboard");return new u.a(e)}(e.EntityTypeName),_=e.HasPrimaryImageField,v=e.Title;let S,O,C;if(e.RecordType===r.a.Grid){const t=a.a[e.EntityTypeName];t?S=t:O=Object(c.a)(n,e.EntityTypeName)}else e.RecordType===r.a.Entity&&(S=Object(s.j)(n,e.EntityTypeName,e.ObjectId));t&&(C=function(e,t){const n={opacity:t&&Object(o.c)(t)?1:.5},r=Object(l.e)(t,[p.u,p.C,p.t,p.B,p.o]),a=Object(l.c)(r,p.t),s=Object(l.c)(r,p.B),c=e.PinStatus?a:s,u=Object(l.c)(r,p.o),d=e.PinStatus?Object(l.c)(r,p.C):Object(l.c)(r,p.u);return{icon:{type:g.b,value:e.PinStatus?f.a.Unpin.toString():f.a.Pin.toString(),dynamicStyles:n},onClickHandler:()=>e.PinStatus?Object(i.d)(e):Object(i.c)(e),narratorTitle:String.format(d,u),subactionAccessibilityLabel:c,toolTip:c}}(e,n));return new m(e.ObjectId.guid,e.EntityTypeName,e.Title,(t,n,r,a)=>a(e,t,n,r),{type:b,value:S,entityReference:y,hasPrimaryImageField:_,imageSrc:S,customEntityIcon:O,entityPrimaryField:v},C,e.PinStatus)}(e,t,n):null}}},"n/Vw":function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.UnhandledError=0]="UnhandledError",e[e.UnhandledRejection=1]="UnhandledRejection"}(r||(r={}))},"n2e+":function(e,t,n){"use strict";n.d(t,"b",(function(){return S})),n.d(t,"a",(function(){return v}));var r=n("u+q+"),a=n("unFF"),i=n("b8TU");var o=n("MqQG"),s=n("c77n"),c=n("pF61"),l=n("smSa"),u=n("ybGo"),d=n("YxC/"),p=n("yRo8"),f=n("EY5k"),g=n("RADj"),h=n("/D1P"),m=n("Lyxw"),b=n("3/02"),y=n("iF9X"),_=n("37s6");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const v=[p.b,"SitemapDesigner.Processing"];const S=Object(r.a)((function(){const e=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(){let e=null,t=null,n=null;return function(r,o){const s=Object(a.a)(r),c=Object(i.a)(r);return t===s&&n&&n.deviceHeight===c.deviceHeight&&n.deviceWidth===c.deviceWidth||(t=s,n=c,e={progressIndicatorBackgroundContainerStyle:{top:0,left:0,opacity:.8,backgroundColor:s.colors.BaseColor.White,position:"absolute",width:c.deviceWidth+"px",height:c.deviceHeight+"px",alignContent:"center",justifyContent:"center",flexDirection:"column",alignItems:"center"},progressIndicatorContentStyle:{width:"inherit",height:"inherit",alignContent:"center",justifyContent:"center",margin:"auto",flexDirection:"column"},progressIndicatorContainerStyle:{alignSelf:"center",height:"64px",width:"64px"},progressIndicatorIndicatorStyle:{height:"inherit",width:"inherit"},progressIndicatorTextStyle:{color:s.colors.BaseColor.Black,fontSize:s.fontSizes.Font225,textAlign:"center",position:"absolute",top:"calc(50% + 32px)",width:"100%"},progressIndicatorAccessibilityAlertStyle:{opacity:0}}),e}}(),t=Object(d.h)();return function(n,r){let a=Object(s.b)(n),i=Object(s.a)(n)||Object(c.k)(n);const o=e(n,r),f=Object(l.c)(n),v=t(n,[p.b,"SitemapDesigner.Processing","Updating_Offline_Data"]),S=Object(u.b)(n),O=Object(m.f)(n,b.v),C=Object(y.e)(n),E=Object(_.a)(n),I=Object(_.b)(n);if(f===g.a.InProgress){const e=Object(l.d)(n);e&&e.itemsToSync>0&&"number"==typeof e.itemsSynced&&(a=String.format(Object(d.c)(v,p.b),Math.floor(100*e.itemsSynced/e.itemsToSync))),i=!0}else S!==h.a.InProgress||O?C&&E&&I&&(a=Object(d.c)(v,"Updating_Offline_Data"),i=!0):(a=Object(d.c)(v,"SitemapDesigner.Processing"),i=!0);return{message:a,isInProgress:i,progressIndicatorBackgroundContainerStyle:o.progressIndicatorBackgroundContainerStyle,progressIndicatorContentStyle:o.progressIndicatorContentStyle,progressIndicatorContainerStyle:o.progressIndicatorContainerStyle,progressIndicatorIndicatorStyle:o.progressIndicatorIndicatorStyle,progressIndicatorTextStyle:o.progressIndicatorTextStyle,progressIndicatorAccessibilityAlertStyle:o.progressIndicatorAccessibilityAlertStyle}}}),(function(e,t){return{retrieveResourceStrings:t=>e(Object(f.e)(t))}}))(o.b)},n3bs:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e.QUICK_CREATE="quickcreate",e.CREATE="create",e.MAIN_FORM_DIALOG="mainformdialog",e.BULK_EDIT="bulkedit",e.ENTITY_RECORD="entityrecord",e.ENTITY="entity",e.VIEW="view",e.ENTITY_LIST="entitylist",e.DASHBOARD="dashboard",e.DIALOG="dialog",e.INLINE_DIALOG="inlinedialog",e.TASKBASED_FLOW="taskbasedflow",e.OFFLINESTATUS_FORM="offlinestatusform",e.CONTROL="control",e.SEARCH="search",e.CUSTOM="custom",e.APPS="apps"}(r||(r={}))},n48k:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.Required=0]="Required",e[e.Number=1]="Number",e[e.Integer=2]="Integer",e[e.Email=3]="Email",e[e.MinValue=4]="MinValue",e[e.MaxValue=5]="MaxValue",e[e.Precision=6]="Precision",e[e.MaxLength=7]="MaxLength",e[e.DateTime=8]="DateTime",e[e.Duration=9]="Duration"}(r||(r={}))},n6Qt:function(e,t,n){"use strict";n.d(t,"a",(function(){return Y}));var r,a=n("ABCl"),i=n("OQLa"),o=n("Lyxw"),s=n("16wZ"),c=n("iZ7K"),l=n("fMBw"),u=n.n(l),d=n("3yqi");!function(e){e.entityTypeName="entityTypeName",e.id="id",e.pageType="pageType",e.entityrecord="entityrecord",e.viewid="viewid",e.viewType="viewType"}(r||(r={}));var p=n("SAYH"),f=n("F1Lu"),g=n("4N6w"),h=n("f07+"),m=n("aRLb"),b=n("Lohl"),y=n("odYE"),_=n("y60j"),v=n("E5IU"),S=n("BlGn"),O=n("tICD"),C=n("NjDY"),E=n("d5N6"),I=n("SZCI"),w=n("a72m"),j=n("d0w6"),P=n("hBJV"),T=n("uCpV"),N=n("X37l"),A=n("IaGr"),R=n("XIaj"),D=n("yGgp"),x=n("1Ibc"),M=n("bo6D"),F=n("xE5/"),k=n("arV0"),L=n("zmL5"),B=n("6lVV"),U=n("3/02"),V=n("37s6"),z=n("pZYY"),q=n("+bek"),H=n("sZ+8"),W=n("+hKY"),G=n("Nb1E"),K=n("qshH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Q={};let X;class Y{constructor(e,t,n,r){this._clientApiExecutor=new a.b(e,"ClientApi.XrmInternal.");const i=this._clientApiExecutor.getComponentName("constructor");Object(s.g)(e,i,"store"),Object(s.g)(t,i,"context"),Object(s.g)(n,i,"globalContext"),X=e,this._context=t,this._globalContextInstance=n,this._pageId=r,window.addEventListener("message",this._xmlInternalMessageHandler)}_xmlInternalMessageHandler(e){e&&e.data&&"userViewChanged"===e.data.eventName&&e.data.viewData&&e.data.viewData.entityName&&(X.dispatch(Object(w.b)(e.data.viewData.entityName,j.a.MAIN_APPLICATION_VIEW,!0)),X.dispatch(Object(P.a)()))}initiateOfflineDataSync(e){return this._clientApiExecutor.executeAsync("initiateOfflineDataSync",()=>{const t=A.a.getInstance().traceManager.getTracer(B.c);if(!(Object(o.f)(X.getState(),U.Kd)&&Object(o.f)(X.getState(),U.mf)&&Object(V.D)(X.getState())&&e&&e.length))return t.warn("immediateOfflineDataSync: FCB FCB.ImmediateOfflineDataSync / FCB.OfflineByDefault not enabled or app is not offline enabled or entities is null or empty"),Promise.resolve();for(const n of e)if(!Object(H.n)(X.getState(),n))return t.warn(`immediateOfflineDataSync: Entity ${n} is not available for offline usage`),Promise.resolve();const n="initiateOfflineDataSync"+this._pageId;return X.dispatch(Object(B.e)(e,n))},[{name:"entities",value:e,isRequired:!0}])}getEntityName(e){return this._clientApiExecutor.execute("getEntityName",()=>Object(c.m)(X.getState(),e)||"",[{name:"entityTypeCode",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"number"}])}openLegacyWebDialog(e,t,n,r,i){this._clientApiExecutor.execute("openLegacyWebDialog",(r,o)=>{let s={};t&&(s={width:t.width,height:t.height}),s.windowPosition="center",X.dispatch(Object(S.a)(e,s,n,this._pageId)).then(e=>{0===e.status&&X.dispatch(Object(O.a)(e.pageId)).then(e=>{e.reason!==E.b&&e.reason!==E.d||!i||Object(a.c)(r,o,()=>{i({inboundArgs:n,outboundArgs:e.value})})})})},[{name:"url",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"string"},{name:"options",value:t,isRequired:!0}])}getEntityNameAsync(e){return this._clientApiExecutor.executeAsync("getEntityNameAsync",()=>{const t=this.getEntityName(e);if(t)return Promise.resolve(t);const n="$filter=ObjectTypeCode eq "+e,r=new h.h(n,["LogicalName"]);X.dispatch(Object(m.b)(r,this._pageId)).then(e=>{e.json().then(e=>{if(e&&e.value&&e.value[0]&&e.value[0].LogicalName)return e.value[0].LogicalName;Promise.reject(new Error("Entity name is null"))})})},[{name:"entityTypeCode",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"number"}])}isFeatureEnabled(e){return this._clientApiExecutor.execute("isFeatureEnabled",()=>Object(o.f)(X.getState(),e),[{name:"featureName",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"string"}])}isNativeFeatureEnabled(e){return this._clientApiExecutor.execute("isNativeFeatureEnabled",()=>Object(o.g)(X.getState(),e),[{name:"featureName",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"string"}])}isUci(){return this._clientApiExecutor.execute("isUci",()=>!0)}createPerformanceStopwatch(e,t){return this._clientApiExecutor.execute("createPerformanceStopwatch",()=>(Q[e]||(Q[e]=u.a.createEvent(e,I.g)),Q[e].startStopwatch(t)),[{name:"name",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"string"}])}reportToWatson(e,t,n,r,a,i,o){return this._clientApiExecutor.executeAsync("reportToWatson",(e,t)=>(A.a.getInstance().traceManager.getTracer(e).error("Watson error report",t),Promise.resolve()),[{name:"message",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"string"},{name:"url",value:t,isRequired:!0,isEventParam:!0,expectedDataType:"string"},{name:"lineNumber",value:n,isRequired:!0,isEventParam:!0,expectedDataType:"number"},{name:"sendReportToWatson",value:r,isRequired:!0,isEventParam:!0,expectedDataType:"boolean"},{name:"callerFunction",value:a,isRequired:!0},{name:"exceptionNumber",value:i,isRequired:!0,isEventParam:!0,expectedDataType:"number"},{name:"reportFunctionBody",value:o,isRequired:!0,isEventParam:!0,expectedDataType:"boolean"}])}getEntityCode(e){return this._clientApiExecutor.execute("getEntityCode",()=>Object(c.p)(X.getState(),e),[{name:"entityTypeName",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"string"}])}getCurrentPageUrl(e,t){return this._clientApiExecutor.execute("getCurrentPageUrl",()=>{const n={entityTypeName:e.entityType,etn:e.name,id:p.a.fromExternalGuid(e.id)},r=X.getState(),a=Object(k.j)(r,this._pageId);Object(k.p)(r,this._pageId)===d.a.EditForm&&a.entityTypeName===n.entityTypeName&&p.a.equals(a.id,n.id)&&(n.formId=Object(L.b)(r,this._pageId));let o=null;return o=1===t?X.dispatch(Object(i.a)(d.a.EditForm,n)):X.dispatch(Object(i.b)(d.a.EditForm,n)),o},[{name:"entityRef",value:e,isRequired:!0}])}getEmailLink(e){return this._clientApiExecutor.execute("getEmailLink",()=>{const t=this._globalContextInstance.getQueryStringParameters(),n=e?e.entityType:t&&t[r.entityTypeName]?t[r.entityTypeName]:"",a=r.entityrecord,i=e?e.id:t&&t[r.id]?t[r.id].substring(1,t[r.id].length-1):"",o=this._globalContextInstance.getClientUrl(),s=Object(v.k)(X.getState());let c="";if("report"===n){c=`${o}${`/crmreports/viewer/viewer.aspx?${s?`appid=${encodeURIComponent(s)}&`:""}id=`}${encodeURIComponent(i)}`}else{c=`${o}${`/main.aspx?appid=${encodeURIComponent(s)}&`}etn=${encodeURIComponent(n)}&id=${encodeURIComponent(i)}&pagetype=${a}`}return c})}getActivityId(){return this._context.EventManager.getActivityId()}canOpenUrl(e){return this._clientApiExecutor.executeAsync("canOpenUrl",()=>new f.a(this._context,X).canOpenUri(e),[{name:"url",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"string"}])}getAuthToken(){return this._clientApiExecutor.execute("getAuthToken",()=>Object(g.a)(X.getState())||null)}getFormId(e,t){return this._clientApiExecutor.executeAsync("getFormId",()=>{const n=new y.a(e);return X.dispatch(Object(b.d)(n,null,t)).then(()=>{const n=Object(_.f)(X.getState(),e,t);let r=null;return n&&(r=n.guid),r})},[{name:"entityType",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"string"},{name:"formType",value:t,isRequired:!0,isEventParam:!0,expectedDataType:"string"}])}getAllowLegacyDialogsEmbedding(){return this._clientApiExecutor.execute("getAllowLegacyDialogsEmbedding",()=>{let e=!1;const t=Object(C.D)(X.getState());return t&&(e=!!t.allowLegacyDialogsEmbedding),e})}addRecentItem(e){this._clientApiExecutor.execute("addRecentItem",()=>{const t={RecordType:e.recordType?e.recordType:N.a.Invalid,ObjectId:e.objectId?p.a.fromExternalGuid(e.objectId):p.a.EMPTY,EntityTypeName:e.entityTypeName?e.entityTypeName:"",Title:e.title?e.title:"",LastAccessed:new Date,PinStatus:e.pinStatus,IsUserView:e.isUserView?e.isUserView:null,IconPath:e.iconPath?e.iconPath:null,HasPrimaryImageField:e.hasPrimaryImageField?e.hasPrimaryImageField:null};X.dispatch(Object(T.b)(t))},[{name:"recent",value:e,isRequired:!0}])}addPopupNotification(e){const t=e.entityLookUpValue;return this._clientApiExecutor.execute("addPopupNotification",()=>{let n;t&&(n=new y.a(t.entityType,new p.a(t.id),t.name));const r={id:p.a.newGuid().guid,title:e.title,entityReference:n,imageUrl:e.imageUrl,details:e.details,type:e.type,acceptAction:e.acceptAction,declineAction:e.declineAction,timeoutAction:e.timeoutAction,themeType:e.themeType||"dark"};return X.dispatch(Object(R.b)(r)).then(()=>r.id)},[{name:"popupNotification",value:e,isRequired:!0}])}clearPopupNotification(e){return this._clientApiExecutor.execute("clearPopupNotification",()=>X.dispatch(Object(D.b)(e)),[{name:"id",value:e,isRequired:!0}])}isDisruptiveFeatureEnabled(e,t,n){return this._clientApiExecutor.execute("isDisruptiveFeatureEnabled",()=>Object(o.e)(X.getState(),null==e?void 0:e.substr(4),null==t?void 0:t.substr(4),null==n?void 0:n.substr(4)),[{name:"featureFCBName",value:e,isRequired:!0,expectedDataType:"string"},{name:"serverSidePreviewFCB",value:t,isRequired:!1,expectedDataType:"string"},{name:"groupFeatureOverrideFCB",value:n,isRequired:!1,expectedDataType:"string"}])}isContextualHelpBrowserEnabled(){return Object(x.a)(X.getState())}openContextualHelpBrowser(e){return this._clientApiExecutor.execute("openContextualHelpBrowser",()=>{const t=X.getState();Object(x.a)(t)&&(e?new URL(e):e=Object(z.a)(Object(q.a)(t)),X.dispatch(Object(M.b)(e)))},[{name:"url",value:e,isRequired:!1,expectedDataType:"string"}])}closeContextualHelpBrowser(){Object(x.a)(X.getState())&&X.dispatch(Object(F.b)())}getBAPEnvironmentId(){const e=this._clientApiExecutor.execute("getBAPEnvironmentId",()=>Object(C.y)(X.getState()),[]);return Promise.resolve(e)}receiveNPSMessage(e){var t;const n=Object(C.D)(X.getState());if("FormResponseSubmitted"===(null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.msgType)&&Object(o.f)(X.getState(),U.Sh)&&(null==n?void 0:n.userRatingEnabled))try{const t=e.data.questions.Score,n=e.data.questions.Comment,r=W.AWTLogManager.getSemanticContext().getDeviceBrowserName(),a=this._globalContextInstance.client.getClient();X.dispatch(Object(G.b)("userrating",{score:t,comment:n,"AppModuleId@odata.bind":`/appmodules(${Object(v.k)(X.getState())})`,browser:r,device:a}))}catch(e){throw K.a.getInstance().reportFailure("ClientApi.XrmInternal.receiveNPSMessage",e),e}}}},nA3O:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("kToj"),a=n("8uvO");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class i{constructor(e){this._properties=[];for(const t in e)e[t]instanceof a.a&&this._properties.push(e[t]);for(const t in e.constructor)e.constructor[t]instanceof a.a&&this._properties.push(e.constructor[t])}get_count(){return this._properties.length}get_item(e){return this._properties[e]}}var o=n("504W");class s{getSchema(){return new i(this)}getValue(e){this._AssertPropertyOwnerType(e);const t=this[e.get_name()];return void 0===t?e.get_defaultValue():t}setValue(e,t){this._AssertPropertyOwnerType(e),e.AssertPropertyValue(t);this.getValue(e)!==t&&(this[e.get_name()]=t,this.onPropertyChanged(e.get_name()))}setValues(e){e=e;const t=this.getSchema();for(let n=0;n<t.get_count();n++)this.setSinglePropertyFromDictionary(e,t.get_item(n))}getValues(){const e={},t=this.getSchema();for(let n=0;n<t.get_count();n++)this.putSinglePropertyIntoDictionary(e,t.get_item(n));return e}setSinglePropertyFromDictionary(e,t){const n=t.get_jsonConverter().read(e,t),r=t.coerceToPropertyType(n);this.setValue(t,r)}putSinglePropertyIntoDictionary(e,t){const n=this.getValue(t);if(!Object(o.a)(n)){const r=t.coerceToJsonType(n);t.get_jsonConverter().write(e,t,r)}}onPropertyChanged(e){}_AssertPropertyOwnerType(e){Object(r.a)(!Object(o.a)(e),"Property of "+Object.getType(this).getName()+" cannot be null or undefined."),Object(r.a)(this instanceof e.get_ownerType(),String.format("{0} is not intended to be used with {1}.",e.get_name(),Object.getType(this).getName()))}}},nC8a:function(e,t,n){"use strict";function r(e,t){return e&&!!e.formInstances&&void 0!==e.formInstances[t]}n.d(t,"a",(function(){return r}))},nDua:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r,a;n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),function(e){e.ADVANCED="advanced",e.APP_SHELL_BREAK_POINT=768,e.APP_SHELL_QUERY_PARAM="appshellmode",e.APP_SHELL_TRACER_CATEGORY="InAppShell",e.SUB_AREA_ID_PREFIX="appShellSubArea_",e.GROUP_BUTTON_ID_PREFIX="appShellGroupCollapseExpandButton_",e.GROUP_ID_PREFIX="appShellGroup_",e.SETUP_SUMMARY_LIST_ITEM_ID="appShellSetupSummaryListItem",e.APP_SHELL_TELEMETRY_ZONE="InAppShell"}(r||(r={})),function(e){e.QUICKSHELLID="QuickShellId",e.ADVANCEDSHELLID="AdvancedShellId",e.APPID="AppId",e.SUBAREAURL="SubAreaUrl",e.NAVSETTINGSID="NavigationSettingsId",e.GROUPID="GroupId",e.ERRORSOURCE="ErrorSource",e.APP_SHELL_COMPONENT_NAME="InAppShell"}(a||(a={}))},"nFP/":function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r,a=n("mMyr"),i=n("F6M4"),o=n("QEBF"),s=n("ghc6"),c=n("8aze"),l=(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});var u=function(e){function t(t){var n=e.call(this,t)||this;n._delayTimeoutId=void 0;var r=t.displayDelay>0;return n.state={renderIndicator:!r},r&&(n._delayTimeoutId=setTimeout((function(){return n.setState({renderIndicator:!0})}),t.displayDelay)),n}return l(t,e),t.prototype.componentWillUnmount=function(){void 0!==this._delayTimeoutId&&(clearTimeout(this._delayTimeoutId),this._delayTimeoutId=void 0)},t.prototype.shouldComponentUpdate=function(e,t){return this.props.active!==e.active||this.props.progressType!==e.progressType||this.state.renderIndicator!==t.renderIndicator},t.prototype.getElementName=function(){return"div"},t.prototype.getFlexClassName=function(e){var t,n="";return e?(t=Object.assign(Object(i.a)(e)),this.props.progressType&&"bar"!==this.props.progressType?"ring"===this.props.progressType&&(n+="indeterminateProgressRing"):n+="indeterminateProgressBar",!0!==this.props.active&&!0!==this.props.animating&&(n+=" hideProgressBar"),n+=" "+Object(i.b)(t?t.display:null)):null},t.prototype.getElementChildren=function(){if("ring"===this.props.progressType&&this.state.renderIndicator)return this.isIE?a.createElement("div",null,"......"):a.createElement("div",null,a.createElement("div",{className:"progressDot"}),a.createElement("div",{className:"progressDot"}),a.createElement("div",{className:"progressDot"}),a.createElement("div",{className:"progressDot"}),a.createElement("div",{className:"progressDot"}))},t.displayName="ProgressIndicator",t}(o.a),d=s.a(c.b)(u)},nInZ:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return _})),n.d(t,"a",(function(){return S}));var r,a,i=n("mMyr"),o=n("QEBF"),s=n("kXuq"),c=n("ghc6"),l=n("8aze"),u=n("LbAn"),d=n("rpfD"),p=n("BHBs"),f=n("xRzR"),g=n("Y7HL"),h=(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),m=function(){return(m=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},b=/[0-9]*\.?[0-9]+(px|%|em|rem)?/i,y=[{min:1,max:39,color:"#FF0000"},{min:40,max:59,color:"#FFBB00"},{min:60,max:100,color:"#00EE00"}];!function(e){e[e.CustomImage=0]="CustomImage",e[e.Initials=1]="Initials",e[e.CustomEntityIcon=2]="CustomEntityIcon",e[e.DefaultEntityIcon=3]="DefaultEntityIcon"}(a||(a={}));var _=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return h(t,e),t.getMode=function(e){return e.hasPrimaryImageField&&e.imageSrc?a.CustomImage:e.hasPrimaryImageField&&e.entityPrimaryField?a.Initials:e.customEntityIcon?a.CustomEntityIcon:e.entityReference&&e.entityReference.entityName?a.DefaultEntityIcon:void 0},t.prototype._isCustomImageMode=function(){return t.getMode(this.props)===a.CustomImage},t.prototype._isInitialsMode=function(){return t.getMode(this.props)===a.Initials},t.prototype._isCustomEntityIconMode=function(){return t.getMode(this.props)===a.CustomEntityIcon},t.prototype._isDefaultEntityIconMode=function(){return t.getMode(this.props)===a.DefaultEntityIcon},t.prototype._renderHealthCircle=function(e){var t=this,n=b.exec(this.props.style.width+"")[1],r=parseFloat(this.props.style.width+""),a=360*this.props.entityHealthScore/100,o={width:r+n,height:r+n,position:"relative",display:"block"},c={clip:"rect(0, "+(r+n)+", "+(r+n)+", "+(r/2+n)+")",height:"100%",width:"100%",left:"0",position:"absolute",top:"0"},l={clip:"rect(0, "+(r/2+n)+", "+(r+n)+", 0)",transform:"rotate("+a+"deg)",height:"100%",width:"100%",border:"4px solid transparent",borderRadius:"50%",left:"0",position:"absolute",top:"0",borderColor:"transparent",boxSizing:"border-box"};y.forEach((function(e){t.props.entityHealthScore>=e.min&&t.props.entityHealthScore<=e.max&&(l.borderColor=e.color)}));var u=Object.assign({},l),d=Object.assign({display:"none"},l);return a>180&&(c.clip="rect(auto, auto, auto, auto)",u.transform="rotate(180deg)",d.display="block"),i.createElement(s.a,{style:o},e,i.createElement(s.a,{style:c},i.createElement(s.a,{style:u}),i.createElement(s.a,{style:d})))},t.prototype.getElementName=function(){return"span"},t.prototype.getElementProps=function(){return{alt:this.props.alt?this.props.alt:""}},t.prototype.getElementChildren=function(){return this._isInitialsMode()?function(e){var t="";if(e){for(var n=e.split(" "),r=0;r<n.length&&t.length<2;r++)if(n[r].length>0){var a=n[r].charCodeAt(0);if(!(a>=97&&a<=122||a>=65&&a<=90)){t+=n[r].charAt(0);break}t+=n[r].charAt(0)}if(t.length<=1){t="";for(var i=0;i<e.length&&t.length<2;i++){var o=e.charCodeAt(i);if(!(o>=97&&o<=122||o>=65&&o<=90)){t+=e.charAt(i);break}t+=e.charAt(i)}}}return t}(this.props.entityPrimaryField):this._isDefaultEntityIconMode()?i.createElement(p.a,{type:this.props.entityReference.entityName,style:this.props.iconStyle}):void 0},t.prototype._renderEntityImageWithPresence=function(e){var t="id_"+Object(d.b)(),n=i.createElement(u.a,{key:t+"_presence",id:t+"_presence",parentControlId:t,style:{right:"0px",bottom:"0px",position:"absolute"},entityReference:this.props.entityReference,sipUrl:this.props.sipUrl,displaySize:this.props.presenceIndicatorSize,accessibilityLabel:this.props.entityPrimaryField});return i.createElement(s.a,{id:t,style:{position:"relative"}},e,n)},t.prototype.render=function(){var e;if(this._isCustomImageMode()||this._isCustomEntityIconMode())if(window.navigator.userAgent.match("MSIE")||window.navigator.userAgent.match("Trident")){var t={source:this._isCustomImageMode()?this.props.imageSrc:this.props.customEntityIcon,style:this.props.style,fallbackToImage:!0,altText:this.props.alt,title:this.props.title};e=i.createElement(f.a,m({},t))}else{var n={source:this._isCustomImageMode()?this.props.imageSrc:this.props.customEntityIcon,style:this.props.style,altText:this.props.alt,title:this.props.title};e=i.createElement(g.a,m({},n))}else{var r=this.getElementPropsInternal(),a=Object.assign({},r,{role:r.role||"img","aria-label":this.props.alt||""});e=i.createElement(this.getElementName(),a,this.getElementChildren())}return this.props.wrapperStyle&&(e=i.createElement(s.a,{style:this.props.wrapperStyle},e)),this.props.entityHealthScore&&(e=this._renderHealthCircle(e)),(this.props.entityReference||this.props.sipUrl)&&(e=this._renderEntityImageWithPresence(e)),e},t.displayName="EntityImage",t.backgroundColors=["#005C62","#358717","#725A0D","#A42B1A","#652F4E","#6A1E7A","#315FA2"],t}(o.a);function v(e){if(e&&e.style){if(!e.style.backgroundColor&&(_.getMode(e)===a.Initials||_.getMode(e)===a.DefaultEntityIcon)){var t=_.backgroundColors[0];if(e.entityPrimaryField){for(var n=0,r=e.entityPrimaryField.length-1;r>=0;r--){var i=e.entityPrimaryField.charCodeAt(r),o=r%8;n^=(i<<o)+(i>>8-o)}t=_.backgroundColors[n%_.backgroundColors.length]}return Object.assign({backgroundColor:t},Object(l.a)(e))}return Object.assign(e.style,Object(l.a)(e))}return{}}var S=c.a((function(e){return{rule:v(e)}}))(_)},nJrx:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r=function(){let e=0;return()=>"id-"+ ++e}(),a=function(){const e={};return t=>(e[t]||(e[t]=0),`id-${t}-${++e[t]}`)}()},nOdx:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return c}));var r=n("SAYH"),a=n("Znsu");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
let i,o;const s=async e=>(o=r.a.toString(e),i=await Promise.all([n.e(0),n.e(1),n.e(2),n.e(29),n.e(36),n.e(59),n.e(183),n.e(157)]).then(n.bind(null,"4bpV")),c()),c=()=>{if(!i)throw new Error("TourComponentUtils not initialized.");return{abortOtherInProgressTours:l,getTourProgressRecord:u,setTourProgressRecord:d,clearTourProgressRecord:p}},l=e=>{if(!i)return;const t=i.getProgressRecords(a.z,o);Object.keys(t).forEach(n=>{n===e||t[n].aborted||t[n].completed||i.setTourProgressRecord(a.z,o,n,Object.assign(Object.assign({},t[n]),{aborted:!0}))})},u=e=>{if(i)return i.getTourProgressRecord(a.z,o,e)},d=(e,t)=>{i&&i.setTourProgressRecord(a.z,o,e,t)},p=e=>{i&&i.clearTourProgressRecord(a.z,o,e)}},nTyX:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"e",(function(){return l}));var r,a=n("/A0C"),i=n("P68g");function o(e){return Object(i.a)(e,e=>l(e))}function s(e){return Object(i.a)(e,e=>c(e))}function c(e){switch(e){case r.Boolean:return a.a.Boolean;case r.Customer:return a.a.Customer;case r.DateTime:return a.a.DateTime;case r.Decimal:return a.a.Decimal;case r.Double:return a.a.Double;case r.Integer:return a.a.Integer;case r.Lookup:return a.a.Lookup;case r.Memo:return a.a.Memo;case r.Money:return a.a.Money;case r.Owner:return a.a.Owner;case r.PartyList:return a.a.PartyList;case r.Picklist:return a.a.PickList;case r.State:return a.a.State;case r.Status:return a.a.Status;case r.String:return a.a.String;case r.UniqueIdentifier:return a.a.UniqueIdentifier;case r.CalendarRules:return a.a.CalendarRules;case r.Virtual:return a.a.Virtual;case r.BigInt:return a.a.BigInt;case r.ManagedProperty:return a.a.ManagedProperty;case r.EntityName:return a.a.EntityName;case r.AliasedValue:return a.a.AliasedValue;case r.EntityImage:return a.a.EntityImage;case r.MultiSelectPicklist:return a.a.MultiSelectPickList;case r.File:return a.a.File;case r.NavigationProperty:return a.a.NavigationProperty;default:return a.a.Unknown}}function l(e){switch(e){case a.a.Boolean:return r.Boolean;case a.a.Customer:return r.Customer;case a.a.DateTime:return r.DateTime;case a.a.Decimal:return r.Decimal;case a.a.Double:return r.Double;case a.a.Integer:return r.Integer;case a.a.Lookup:return r.Lookup;case a.a.Memo:return r.Memo;case a.a.Money:return r.Money;case a.a.Owner:return r.Owner;case a.a.PartyList:return r.PartyList;case a.a.PickList:return r.Picklist;case a.a.State:return r.State;case a.a.Status:return r.Status;case a.a.String:return r.String;case a.a.UniqueIdentifier:return r.UniqueIdentifier;case a.a.CalendarRules:return r.CalendarRules;case a.a.Virtual:return r.Virtual;case a.a.BigInt:return r.BigInt;case a.a.ManagedProperty:return r.ManagedProperty;case a.a.EntityName:return r.EntityName;case a.a.AliasedValue:return r.AliasedValue;case a.a.EntityImage:return r.EntityImage;case a.a.MultiSelectPickList:return r.MultiSelectPicklist;case a.a.File:return r.File;case a.a.NavigationProperty:return r.NavigationProperty;default:return r.Unknown}}!function(e){e[e.Unknown=-1]="Unknown",e[e.Boolean=0]="Boolean",e[e.Customer=1]="Customer",e[e.DateTime=2]="DateTime",e[e.Decimal=3]="Decimal",e[e.Double=4]="Double",e[e.Integer=5]="Integer",e[e.Lookup=6]="Lookup",e[e.Memo=7]="Memo",e[e.Money=8]="Money",e[e.Owner=9]="Owner",e[e.PartyList=10]="PartyList",e[e.Picklist=11]="Picklist",e[e.State=12]="State",e[e.Status=13]="Status",e[e.String=14]="String",e[e.UniqueIdentifier=15]="UniqueIdentifier",e[e.CalendarRules=16]="CalendarRules",e[e.Virtual=17]="Virtual",e[e.BigInt=18]="BigInt",e[e.ManagedProperty=19]="ManagedProperty",e[e.EntityName=20]="EntityName",e[e.AliasedValue=21]="AliasedValue",e[e.EntityImage=23]="EntityImage",e[e.MultiSelectPicklist=24]="MultiSelectPicklist",e[e.File=25]="File",e[e.NavigationProperty=26]="NavigationProperty"}(r||(r={}))},nVeB:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n("JTy6"),a=n("ruPX"),i=n("tICD"),o=n("2SCk"),s=n("SAYH");function c(e,t,n,i,c,l,u,d,p,f,g,h,m){const b=d?function(e){if(!e)return null;const t={};for(let n=0;n<e.length;n++){const r=e[n];if(r&&r.filterXml){let e="GENERAL_FILTER_NAME";r.entityLogicalName&&(e=r.entityLogicalName),t[e]||(t[e]=[]);const n=Object(o.i)(r.filterXml);n&&(n.conditions&&n.conditions.length>0||n.filters&&n.filters.length>0)&&t[e].push(JSON.stringify(n))}}return t}(d):null;let y=null;b&&(y=b.GENERAL_FILTER_NAME,delete b.GENERAL_FILTER_NAME);const _={defaultEntityType:t,defaultViewId:n,entityTypes:i,viewIds:c,allowMultiSelect:l,lookupType:e,data:u,extraFilters:y,additionalTargetExtraFilters:b,disableMru:p,entityTypeName:g,id:s.a.tryParse(h),searchText:m};return Object(a.a)(r.a,_,f)}function l(e,t,n){const{allowMultiSelect:r,createFromEntity:a,defaultViewId:o,disableMru:l,entityTypes:u,filters:d,searchText:p,viewIds:f}=e;return n(c(r?"Lookup.PartyList":u.length>1?"Lookup.MultiEntity":"Lookup.Simple",u[0],o,u,f,r,null,d,l,t,null==a?void 0:a.entityType,null==a?void 0:a.id,p)).then(e=>{if(1===e.status)throw e.error;return n(Object(i.a)(e.pageId)).then(e=>{var t;let n=[];const r=null===(t=null==e?void 0:e.value)||void 0===t?void 0:t.length,a=1===r&&!e.value[0];return r&&!a&&(n=e.value.map(e=>({id:s.a.externalGuid(s.a.fromExternalGuid(e.id)),entityType:e.entityName,name:e.name}))),n})})}},nZ7Q:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("3BuU"),a=function(){function e(e,t){this._outboundQueue=e,this._maxNumberOfEvents=t,this._currentBatch={},this._currentNumEventsInBatch=0}return e.prototype.addEventToBatch=function(e){if(e.priority===r.AWTEventPriority.Immediate_sync){var t={};return t[e.apiKey]=[e],t}return this._currentNumEventsInBatch>=this._maxNumberOfEvents&&this.flushBatch(),void 0===this._currentBatch[e.apiKey]&&(this._currentBatch[e.apiKey]=[]),this._currentBatch[e.apiKey].push(e),this._currentNumEventsInBatch++,null},e.prototype.flushBatch=function(){this._currentNumEventsInBatch>0&&(this._outboundQueue.push(this._currentBatch),this._currentBatch={},this._currentNumEventsInBatch=0)},e.prototype.hasBatch=function(){return this._currentNumEventsInBatch>0},e}();t.default=a},nZiF:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="router.set.pagealwaysrender";function a(e,t){return{type:r,payload:t,meta:{pageId:e}}}},nfLm:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.none=0]="none",e[e.main=1]="main",e[e.appointment=2]="appointment",e[e.hardcoded=3]="hardcoded",e[e.miniCampaignBO=4]="miniCampaignBO",e[e.preview=5]="preview",e[e.dashboard=6]="dashboard",e[e.quick=7]="quick",e[e.quickCreate=8]="quickCreate",e[e.mobile=9]="mobile",e[e.read=10]="read",e[e.card=11]="card",e[e.dialog=12]="dialog",e[e.taskBased=14]="taskBased",e[e.interactionCentricDashboard=15]="interactionCentricDashboard",e[e.advancedSearch=16]="advancedSearch",e[e.subGrid=17]="subGrid",e[e.quickFindSearch=18]="quickFindSearch",e[e.reporting=19]="reporting",e[e.offlineFilters=20]="offlineFilters",e[e.maSearch=21]="maSearch",e[e.lookup=22]="lookup",e[e.smAppointmentBook=23]="smAppointmentBook",e[e.outlookFilters=24]="outlookFilters",e[e.addressbookFilters=25]="addressbookFilters",e[e.savedQueryTypeOther=26]="savedQueryTypeOther",e[e.interactiveWorkFlow=27]="interactiveWorkFlow",e[e.offlineTemplate=28]="offlineTemplate",e[e.outlookTemplate=29]="outlookTemplate",e[e.customDefined=30]="customDefined",e[e.jScript=31]="jScript",e[e.css=32]="css",e[e.png=33]="png",e[e.jpg=34]="jpg",e[e.gif=35]="gif",e[e.advancedFind=36]="advancedFind"}(r||(r={}))},ngeo:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("YxC/"),a=n("EY5k"),i=n("Uv1Y");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class o{constructor(e,t){this._store=null,this._tracer=null,this._store=e,this._tracer=t}updateResources(e){this._tracer&&this._tracer.info("updateResources stub was called.")}getLocalizedString(e){return Object(r.b)(this._store.getState(),e)}getErrorMessage(e,t){if(t){const n=this.getLocalizedString(e)||e;return String.format(n,t)}return this.getLocalizedString(e)}static getHexErrorCodeFromInt(e){let t=e;return t<0&&(t=t+4294967295+1),t.toString(16)}static retrieveErrorMessage(e,t,...n){return new Promise((s,c)=>{const l=0===t?i.a.DEFAULT_ERROR_MESSAGE_ID:"Error_Message_0x"+o.getHexErrorCodeFromInt(t);e.dispatch(Object(a.e)([l])).then(()=>{const t=Object(r.b)(e.getState(),l);t&&n&&n.length>0?s(String.format(t,n)):s(t)},()=>{c(Object(r.b)(e.getState(),i.a.DEFAULT_ERROR_MESSAGE_ID))})})}}o.TRACER_CATEGORY_ID="ResourceManager"},ngzy:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("84PK"),a=n("504W");class i{constructor(e,t,n){this._profileId=null,this._profileVersion=null,this._offlineAvailableEntities=null,this._profileId=Object(a.a)(e)?r.a.get_empty():e,this._offlineAvailableEntities=t,this._profileVersion=Object(a.b)(n)?"":n}get_profileId(){return this._profileId}get_profileVersion(){return this._profileVersion}get_offlineAvailableEntities(){return this._offlineAvailableEntities}getObjectData(){const e={};return e.profileid=this._profileId.getObjectData(),e.offlineavailableentities=this._offlineAvailableEntities,e.profileversion=this._profileVersion,e}static createFromObjectData(e){let t=r.a.get_empty(),n="",o=[];if(e){if(e.profileid.toString()!==r.a.get_empty().toString()&&(t=r.a.createFromObjectData(e.profileid)),Object.getType(e.offlineavailableentities)===Object){const t=e.offlineavailableentities;for(const e in t){const n={key:e,value:t[e]};o.push(n.value.toString())}}else o=e.offlineavailableentities;Object(a.b)(e.profileversion.toString())||(n=e.profileversion.toString())}return new i(t,o,n)}}},nhx2:function(e,t,n){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},niX0:function(e,t,n){"use strict";n.d(t,"c",(function(){return f})),n.d(t,"b",(function(){return h})),n.d(t,"a",(function(){return m}));var r=n("uNu9"),a=n("iZ7K"),i=n("YxC/"),o=n("p9KN"),s=n("37s6"),c=n("w1eR"),l=n("GYEz"),u=n("0l0t"),d=n("PtYj"),p=n("eZ32");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function f(e){const t=[];return t.push({areaId:u.e,id:"navAsyncOperations",entityName:r.e,title:Object(i.b)(e,o.b),order:9500,show:!0}),t.push({areaId:u.b,id:"navConnections",entityName:r.y,title:Object(i.b)(e,o.c),order:8500,show:!0}),t.push({areaId:u.b,id:"navFeedback",entityName:r.S,title:Object(i.b)(e,o.e),order:9958,show:!0}),t.push({areaId:u.e,id:"navProcessSessions",entityName:r.tb,title:Object(i.b)(e,o.p),order:9700,show:!0}),t.push({areaId:u.b,id:"navTraces",entityName:r.Zb,iconPath:"/_imgs/area/18_alerts.png",title:null,order:8050,show:!0}),t}const g={[r.e]:"regardingobjectid",[r.y]:"record1id",[r.S]:"regardingobjectid",[r.tb]:"regardingobjectid",[r.Tb]:"regardingobjectid",[r.vb]:"associatedproduct",[r.A]:"contactid"};function h(e,t,n){const a=[];if(Object(d.a)(e,n||t)){const t="Audit.Incontext.AreaTitle",n=Object(i.b)(e,t);a.push({areaId:u.b,id:"navAudit",entityName:r.f,title:n,order:9600,show:!0})}switch(t){case r.ub:a.push({areaId:u.b,id:"navProductBundles",entityName:r.vb,iconPath:"/_imgs/ico_18_1024.gif",title:Object(i.b)(e,o.o),order:0,show:!0}),a.push({areaId:u.b,id:"navPrices",entityName:r.wb,order:0,show:!0});break;case r.Ab:a.push({areaId:u.b,id:"navOrders",entityName:r.Ib,order:0,show:!0});break;case r.p:a.push({areaId:u.b,id:"navActivities",entityName:r.b,iconPath:"/_imgs/ico_18_camptask.gif",title:Object(i.b)(e,o.m),order:0,show:!0}),a.push({areaId:u.b,id:"navCampaignActivities",entityName:r.q,order:0,show:!0}),a.push({areaId:u.b,id:"navCampaignResponses",entityName:r.r,order:0,show:!0}),a.push({areaId:u.f,id:"navTargetProducts",entityName:r.ub,title:Object(i.b)(e,o.w),order:0,show:!0}),a.push({areaId:u.f,id:"navCollaterals",entityName:r.Hb,order:0,show:!0}),a.push({areaId:u.c,id:"navWebLeads",entityName:r.lb,title:Object(i.b)(e,o.x),order:0,show:!0}),a.push({areaId:u.d,id:"navTargetLists",entityName:r.hb,title:Object(i.b)(e,o.v),order:0,show:!0}),a.push({areaId:u.d,id:"navCampaigns",entityName:r.p,iconPath:"/_imgs/ico_18_camp.gif",title:Object(i.b)(e,o.q),order:0,show:!0});break;case r.x:a.push({areaId:u.f,id:"navOpportunities",entityName:r.mb,order:0,show:!0});break;case r.C:a.push({areaId:u.g,id:"navCases",entityName:r.Y,iconPath:"/_imgs/ico_18_112.gif",order:0,show:!0});break;case r.B:a.push({areaId:u.b,id:"navContractLines",entityName:r.C,iconPath:"/_imgs/ico_18_1011.gif",order:0,show:!0}),a.push({areaId:u.g,id:"navCases",entityName:r.Y,iconPath:"/_imgs/ico_18_112.gif",order:0,show:!0}),a.push({areaId:u.b,id:"navActivities",entityName:r.b,iconPath:"/_imgs/ico_18_act.gif",order:0,show:!0});break;case r.eb:a.push({areaId:u.d,id:"navCampaignsInSFA",entityName:r.p,order:0,show:!0});break;case r.hb:a.push({areaId:u.b,id:"navListMember",entityName:r.lb,iconPath:"/_imgs/ico_18_4301.gif",title:Object(i.b)(e,o.i),order:0,show:!0}),a.push({areaId:u.d,id:"navCampaignsInList",entityName:r.p,order:0,show:!0}),a.push({areaId:u.d,id:"navMiniCampaignsForList",entityName:r.o,iconPath:"/_imgs/ico_18_minicamps.gif",order:0,show:!0});break;case r.Hb:a.push({areaId:u.b,id:"navDoc",entityName:r.Hb,order:0,show:!0}),a.push({areaId:u.f,id:"navComp",entityName:r.x,order:0,show:!0}),a.push({areaId:u.b,id:"navProducts",entityName:r.ub,order:0,show:!0});break;case r.Ub:a.push({areaId:u.b,id:"navTeams",entityName:r.Wb,order:0,show:!0}),Object(s.w)(e)===p.a.Available&&Object(l.a)(e)!==c.a.MailApp&&a.push({areaId:u.b,id:"navFieldSecurityProfiles",entityName:r.T,order:0,show:!0}),Object(s.w)(e)===p.a.NotAvailable&&(a.push({areaId:u.g,id:"navServices",entityName:r.Kb,title:Object(i.b)(e,o.u),order:0,show:!0}),a.push({areaId:u.g,id:"navResourceGroups",entityName:r.z,title:Object(i.b)(e,o.r),order:0,show:!0}),a.push({areaId:u.b,id:"navMonthlyCalendar",entityName:r.lb,iconPath:"/_imgs/area/18_calendar.gif",title:Object(i.b)(e,o.y),order:0,show:!0}));break;case r.Wb:Object(s.w)(e)===p.a.Available&&Object(l.a)(e)!==c.a.MailApp&&a.push({areaId:u.b,id:"navFieldSecurityProfiles",entityName:r.T,order:0,show:!0});break;case r.Yb:a.push({areaId:u.b,id:"navMembers",entityName:r.Ub,iconPath:"/_imgs/ico_18_team_inc.gif",title:Object(i.b)(e,o.j),order:0,show:!0});break;case r.W:a.push({areaId:u.b,id:"navSuccesses",entityName:r.lb,order:0,show:!0}),a.push({areaId:u.b,id:"navPartialFailures",entityName:r.lb,order:0,show:!0}),a.push({areaId:u.b,id:"navFailures",entityName:r.X,title:Object(i.b)(e,o.f),order:0,show:!0}),a.push({areaId:u.e,id:"navAsyncOperations",entityName:r.e,title:Object(i.b)(e,o.a),order:0,show:!0});break;case r.Z:a.push({areaId:u.b,id:"navContacts",entityName:r.A,title:Object(i.b)(e,o.l),order:0,show:!0}),a.push({areaId:u.b,id:"navActivities",entityName:r.b,iconPath:"/_imgs/ico_18_act.gif",order:0,show:!0}),a.push({areaId:u.b,id:"navActivityHistory",entityName:r.lb,iconPath:"/_imgs/ico_18_history.gif",title:Object(i.b)(e,o.k),order:0,show:!0});break;case r.H:a.push({areaId:u.b,id:"navDiscounts",entityName:r.G,iconPath:"/_imgs/ico_16_1013.gif",order:0,show:!0});break;case r.sb:a.push({areaId:u.b,id:"navItems",entityName:r.wb,iconPath:"/_imgs/ico_18_1026.gif",order:0,show:!0});break;case r.cc:a.push({areaId:u.b,id:"navUnits",entityName:r.bc,order:0,show:!0});break;case r.lb:a.push({areaId:u.b,id:"navActivities",entityName:r.b,iconPath:"/_imgs/ico_18_act.gif",order:0,show:!0})}return a}function m(e,t,n,i){if("navTeams"===i)return{relationshipName:"teammembership_association",referencingEntity:"team"};const o=Object(a.E)(e,t);if(!o)return;const s=Object.keys(o),c=g[n];for(const e of s){const t=o[e];if(!(t.ReferencingEntity!==n||c&&t.ReferencingAttribute!==c))return{relationshipName:e,referencingEntity:t.ReferencingEntity};if(i){if("navAudit"===i)return{relationshipName:"audit",referencingEntity:r.f};if(i&&t.AssociatedMenuConfiguration.MenuId===i)return{relationshipName:e,referencingEntity:t.ReferencingEntity}}}const l=Object(a.w)(e,t);if(!l)return;const u=Object.keys(l);for(const e of u){const r=l[e],a=r.Entity1LogicalName!==t?r.Entity1IntersectAttribute:r.Entity2IntersectAttribute,o=r.Entity1LogicalName===n?r.Entity1LogicalName:r.Entity2LogicalName;if(t===n){if(r.Entity1LogicalName===r.Entity2LogicalName&&r.Entity1IntersectAttribute&&r.Entity2IntersectAttribute)return{relationshipName:e,referencingEntity:n}}else{if(o===n&&a)return{relationshipName:e,referencingEntity:o};if(i&&(r.Entity1AssociatedMenuConfiguration.MenuId===i||r.Entity2AssociatedMenuConfiguration.MenuId===i)){return{relationshipName:e,referencingEntity:r.Entity1AssociatedMenuConfiguration.MenuId===i?r.Entity1LogicalName:r.Entity2LogicalName}}}}}},nlPs:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return u}));var r=n("arV0"),a=n("dHD5"),i=n("OtHk"),o=n("cfbi"),s=n("UIlN"),c=n("pnQK"),l=n("zmL5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function u(e,t){const n=Object(s.a)(e,t);return n&&n.contextToken}function d(e,t){const n=Object(r.p)(e,t);if("EditForm"===n||"QuickCreateForm"===n||"ModalDialog"===n||"Dialog"===n||n===o.c)return Object(a.j)(e,t);if("Grid"===n)return Object(a.l)(e,t);if("Dashboard"===n){const n=Object(r.j)(e,t);let o=n.dashboardId;const s=n.etn;return!o&&s?o=Object(i.e)(e,s):o||(o=Object(l.b)(e,t)),o||(o=Object(c.b)(e,s)),Object(a.d)(e,o)}return"Control"===n?Object(a.b)(e,t):null}},nmJf:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("M0zh"),a=n("sZ+8");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function i(e,t){return Object(r.w)(e,a.n,t)}},np5s:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}));var r=n("h6c1"),a=n("7NKF");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function i(e){const t=Object(r.a)(e,a.a);return null==t?void 0:t.BaseUrlForTemporaryData}function o(e){const t=Object(r.a)(e,a.a);return null==t?void 0:t.BaseUrlForEntityData}},nxXM:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return d})),n.d(t,"c",(function(){return u}));var r=n("Wgxh"),a=n("9692"),i=n("ddoO"),o=n("SAYH"),s=n("HfZT"),c=n("2jAf");function l(e){return{type:"garbage.collect.data.sync",sync:!0,execute({dispatch:t,getState:n},o){const s=n(),l={},u={},p=Object(i.e)(s);for(const t in p){const n=p[t];for(const a in n){const i=n[a]&&n[a].slice(),o=Object(r.b)(i,e);if(o)if(0===o.length)if(u[t])u[t][a]=null;else{const e={[a]:null};u[t]=e}else l[t]||(l[t]={}),l[t][a]=o}}const f={},g={},h=Object(i.j)(s);for(const t in h){const n=h[t]&&h[t].slice(),a=Object(r.b)(n,e);a&&(0===a.length?g[t]=null:f[t]=a)}const m={},b={},y={},_=Object(i.d)(s);for(const t in _){const n=_[t];for(const a in n){const i=n[a]&&n[a].slice(),o=Object(r.b)(i,e);if(o)if(0===o.length)if(b[t])b[t][a]=null;else{const e={[a]:null};b[t]=e}else m[t]||(m[t]={}),m[t][a]=o}b[t]&&n&&Object.keys(n).length===Object.keys(b[t]).length&&(y[t]=null)}const v={},S={},O=Object(i.a)(s);for(const t in O){const n=O[t]&&O[t].slice(),a=Object(r.b)(n,e);a&&(0===a.length?S[t]=null:v[t]=a)}if(Object.keys(l).length>0||Object.keys(f).length>0||Object.keys(m).length>0||Object.keys(v).length>0){t(d({entities:l,lists:f,charts:m,chartData:v}))}if(Object.keys(u).length>0||Object.keys(g).length>0||Object.keys(b).length>0||Object.keys(S).length>0){t((C={entities:u,lists:g,charts:b,chartData:S},{type:a.a,payload:C}))}var C;if(Object.keys(y).length>0){const e={charts:y};t(Object(c.d)(e))}}}}function u(e){return{type:"garbage.collector.update.data.entities.sync",sync:!0,execute({dispatch:t,getState:n},r){const a={};for(let t=0;t<e.length;t++){const r=o.a.toString(e[t].id),i=e[t].etn,c=Object(s.d)(n(),i,r);if(c)if(a[i])a[i][r]=c;else{const e={[r]:c};a[i]=e}}if(Object.keys(a).length>0){t(d({entities:a,lists:null,charts:null}))}}}}function d(e){return{type:a.b,payload:e}}},nxt5:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class r{constructor(e){this._name=null,this._name=e}get_name(){return this._name}}},"nzu+":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("pgSX"),a=n("si7p");function i(e,t,n){"string"==typeof e&&(e={text:e});const{text:i,title:o,confirmButtonLabel:s}=e;return{type:"form.openAlertDialog",execute:({dispatch:e})=>e(Object(r.a)(a.a,i,t,s,o,void 0,void 0,void 0,void 0,void 0,n)),getFailureParameters:(e,n)=>[{name:"dialogHeight",value:t&&t.height},{name:"dialogWidth",value:t&&t.width},{name:"dialogPosition",value:t&&t.position},{name:"dialogWindowPosition",value:t&&t.windowPosition}]}}},o1og:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"a",(function(){return a})),n.d(t,"e",(function(){return s})),n.d(t,"c",(function(){return i})),n.d(t,"f",(function(){return c}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="offline.apply.application.metadata.changes",a="offline.applying.application.metadata.changes",i="offline.first.apply.application.metadata.changes";function o(e){return{type:r,payload:{applyApplicationMetadataChanges:e}}}function s(e){return{type:a,payload:{applyingApplicationMetadataChanges:e}}}function c(e){return{type:i,payload:{isFirstApplyApplicationMetadataChangesDone:e}}}},o68e:function(e,t,n){"use strict";function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}n.d(t,"a",(function(){return r}))},oB6S:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r=320;var a;function i(e,t){switch(t=t||{},e){case a.Zoom300:return o(426,340,t.checkWidth,t.checkHeight);case a.Zoom400:return o(r,256,t.checkWidth,t.checkHeight)}return!1}function o(e,t,n,r){return!(!1!==n&&window.innerWidth>e)&&!(!1!==r&&window.innerHeight>t)}!function(e){e[e.Zoom300=0]="Zoom300",e[e.Zoom400=1]="Zoom400"}(a||(a={}))},oLL6:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));const r="businessProcessFlow.instance.businessprocessflowsbyid.update";function a(e){return{type:r,payload:e}}},oOvK:function(e,t,n){"use strict";n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return l}));var r=n("Uv1Y"),a=n("Z/4N"),i=n("K7RF"),o=n("/oKV"),s=n("iJGp");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const c="retrieve.customcontrol.manifest",l="dummy.customcontrol.manifest.async";function u(e,t,n=!0){return{type:"retrieve.customcontrol.manifest.async",execute({dispatch:c,getState:l},u){const p=o.a.LocalAndRemote,f=(u.DataSource,l());return Object(a.e)(f,e)&&p===o.a.LocalAndRemote?Promise.resolve():c(function(e,t,n,a,o){return{type:"retrieve.customcontrol.manifest.async",execute({dispatch:e,getState:c},l){const u=Object(i.b)("customcontrol",null,null,null,!1,s.a.OnDemandWithContext,null,null,[t],null,a);return e(u).then(c=>!c||!c.controlManifests||Object.keys(c.controlManifests).length<1?(n&&n!==t||d(e,t,o),e(Object(i.b)("customcontrol",null,null,null,!1,s.a.OnDemandWithContext,null,null,[n],null,a)).then(n=>((!n||!n.controlManifests||Object.keys(n.controlManifests).length<1)&&d(e,t,o),n)).catch(r.b)):c).catch(c=>{if(n&&n!==t)return e(Object(i.b)("customcontrol",null,null,null,!1,s.a.OnDemandWithContext,null,null,[n],null,a)).then(n=>((!n||!n.controlManifests||Object.keys(n.controlManifests).length<1)&&d(e,t,o),n)).catch(r.b);d(e,t,o)})}}}(0,e,t,p,n))}}}function d(e,t,n){if(e({type:l,payload:{controlManifests:{[t]:null}}}),n)throw new r.a("No manifest found")}},oSQy:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"e",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"f",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return c})),n.d(t,"g",(function(){return l})),n.d(t,"h",(function(){return u}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="TabFlyout.KeyboardShortCut.Area",a="Flyout.KeyboardShortCut.Tab.NotAllowed",i="TabFlyout.KeyboardShortCut.Down",o="TabFlyout.KeyboardShortCut.Up",s="TabFlyout.KeyboardShortCut.Enter",c="TabFlyout.KeyboardShortCut.Escape",l="L_List_No_Records_Text",u=[r,a,i,o,s,c,l]},oT5e:function(e,t,n){"use strict";n.d(t,"e",(function(){return l})),n.d(t,"f",(function(){return c})),n.d(t,"g",(function(){return s})),n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return p})),n.d(t,"c",(function(){return d})),n.d(t,"h",(function(){return f})),n.d(t,"i",(function(){return g})),n.d(t,"d",(function(){return h}));var r=n("jhff"),a=n("zsAz"),i=n("+nTZ"),o=n("b8TU");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function s(e){return Object(r.b)(e)}function c(e){return u(e,s(e))}function l(e){return null==e?void 0:e.browsingContexts}function u(e,t){var n;const r=null===(n=l(e))||void 0===n?void 0:n[t];if(!r)throw Object(a.d)("Browsingcontext does not exist",2415919107,[{name:"id",value:t}]);return r}function d(e,t){return u(e,t).type}function p(e,t){const n=l(e);for(const r in n){if(n[r].pageId===t)return n[r];if(n[r].dialogContextIds)for(const a of n[r].dialogContextIds){const o=Object(i.a)(e,a);if(o.contentPageId===t||o.pageStack&&o.pageStack.indexOf(t)>=0)return n[r]}}return null}function f(e,t){return u(e,t).navigating}function g(e,t){return u(e,t).navigationsCount||0}function h(e,t){var n,r;const a=p(e,t),i=Object(o.a)(e);return(null===(n=null==a?void 0:a.viewport)||void 0===n?void 0:n.height)||(null===(r=null==a?void 0:a.viewport)||void 0===r?void 0:r.width)?null==a?void 0:a.viewport:{height:null==i?void 0:i.deviceHeight,width:null==i?void 0:i.deviceWidth}}},oZ1k:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},i=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},o=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(i(arguments[t]));return e},s=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.saveAutomationState=t.setShouldCollectMemory=t.checkForContinuingPerformanceAutomation=t.continuePerformanceAutomation=t.subscribeToAutomationEvents=t.cancelPerformanceAutomation=t.runPerformanceAutomation=t.validateNetworkRequests=void 0;var l,u=n("Ci56"),d=n("VKaO"),p=n("B65h"),f=c(n("zI6t")),g=n("IMR+"),h=n("3ZMs"),m=n("p6uC"),b=n("kgxE"),y=n("WbTV"),_=n("Kj0E"),v=n("5ylf"),S=[],O=null,C=null,E=!1;function I(e){l=e}function w(e,t,n){if(null!=t){for(var r=e.slice(),a=y.getNetworkRequestTypeFilter(),i=function(e){var i=t[e];void 0!==i.min&&null!==i.min||(i.min=1),void 0!==i.max&&null!==i.max||(i.max=1);for(var o,s=function(e){var n=t[e];i.url===n.url&&i.regex===n.regex&&Array.isArray(i.types)&&Array.isArray(n.types)&&i.types.length===n.types.length&&i.types.every((function(e,t){return e===n.types[t]}))?(i.min+=void 0===n.min||null===n.min?1:n.min,i.max+=void 0===n.max||null===n.max?1:n.max,t.splice(e,1)):e++,o=e},c=e+1;c<t.length;)s(c),c=o;var l=i.url,u=r.filter((function(e){var t=e.parameters[v.RESOURCE_NAME],n=(i.regex?new RegExp(i.url).test(t):t===i.url)&&"true"===e.parameters[v.CACHED_NAME]==i.types.indexOf("cached")>=0;if(n)for(var r in a)if(a[r](t)!==i.types.indexOf(r)>=0)return!1;return n})),d=u.length;g.logMessage("Request restriction: "+l.toString()+", Expected: "+JSON.stringify(i)+", Actual: "+d),(d<i.min||d>i.max)&&n.logPerformanceIssue({type:h.PerformanceIssueType.NetworkRequestQuotaIssues,level:h.PerformanceIssueLevel.Warning,message:"Restricted requests not met",parameters:[JSON.stringify(i),d.toString()]});for(c=0;c<d;c++)r.splice(r.indexOf(u[c]),1)},o=0;o<t.length;o++)i(o);r.forEach((function(e){n.logPerformanceIssue({type:h.PerformanceIssueType.NetworkRequestQuotaIssues,level:h.PerformanceIssueLevel.Warning,message:"New request found",parameters:[e.parameters[v.RESOURCE_NAME]]})}))}}function j(e,t,n,r,a,i,s){f.default.addMetadataToTimeline({automationScenario:t.displayName}),f.default.addCommonKpiParameters({Automation:"true"});var c={keyPerformanceIndicators:[],issues:null},u=null;return r.processNextWorkBlock((function(){a(),e<=1&&t.validation&&!t.validation()&&r.logPerformanceIssue({type:h.PerformanceIssueType.ErrorDuringAutomation,level:h.PerformanceIssueLevel.Error,message:"Scenario failed validation",parameters:[t.displayName,e.toString()]})}),(function(a){if(u=a.timeline,n&&(e>0||t.isBoot)){var i=a.workBlockEndTime-a.workBlockStartTime,o=n.expectedNetworkRequests,s=n.expectedKeyPerformanceIndicators,c=n.minimumWorkTime,l=n.maximumWorkTime;if(w(y.getNetworkRequestsForVerification(a.timeline.getNetworkRequests()),o,r),null!=c&&i<c&&r.logPerformanceIssue({type:h.PerformanceIssueType.WorkTimeOutOfBounds,level:h.PerformanceIssueLevel.Warning,message:"Work time is below minimum",parameters:[c.toString(),i.toString()]}),null!=l&&i>l&&r.logPerformanceIssue({type:h.PerformanceIssueType.WorkTimeOutOfBounds,level:h.PerformanceIssueLevel.Warning,message:"Work time exceeded maximum",parameters:[l.toString(),i.toString()]}),null!=s){var d=a.timeline.getKeyPerformanceIndicators().map((function(e){return e.name}));JSON.stringify(s.sort())!==JSON.stringify(d.sort())&&r.logPerformanceIssue({type:h.PerformanceIssueType.MismatchedKeyPerformanceIndicators,level:h.PerformanceIssueLevel.Error,message:"Mismatched key performance indicator(s)",parameters:d})}}}),(function(e){c.issues=e.issues.concat(e.issuesFromTimelineProcessing);var t=e.timeline.getKeyPerformanceIndicators();0===t.filter((function(t){return t.value===e.workBlockEndTime-e.workBlockStartTime})).length&&t.push({name:"WorkComplete",value:e.workBlockEndTime-e.workBlockStartTime}),c.keyPerformanceIndicators=t})).then((function(e){var t;if(e.forEach(r.logPerformanceIssue),(t=c.issues).push.apply(t,o(e)),l)return s&&clearInterval(s),_.collectMemory(!0).then((function(e){e>=0&&(c.memory={peakMemoryUsage:null==i?void 0:i.value,finalMemoryUsage:e})}))})).then((function(){if(c.issues.length>0&&c.issues.some((function(e){return e.level===h.PerformanceIssueLevel.Error})))throw new Error("Critical issues found during scenario");var n={timeline:p.timelineToSerializable(u),keyPerformanceIndicators:c.keyPerformanceIndicators,issues:c.issues};return c.memory&&(n.memory=c.memory),m.uploadIterationResult(t.displayName,e,n)})).then((function(){return c}))}function P(e,t,n,i,o){if(void 0===o&&(o=null),g.logMessage("Running scenario: "+t.displayName),t.action.isComposite)return Promise.reject("Scenario "+t.displayName+" is invalid: main action is composite");var s=o;s||(s={scenarioConfig:e,iterationResults:[],setupExecuted:!1},O.scenarios.push(s));var c,d=t.setupAction,p=t.cleanupAction,f=!s.setupExecuted&&null!=d;return s.setupExecuted=!0,f?(g.logMessage("Running setup step for "+t.displayName),c=u.runAction(d,!0,n,void 0,e.parameters)):c=n.waitForIdle(),c.then((function(){for(var o=Promise.resolve(),c=function(c){o=o.then((function(){return t.preIterationAction?u.runAction(t.preIterationAction,!0,n,void 0,e.parameters):n.waitForIdle()})).then((function(){var e;return null===(e=n.executeIdleTasks)||void 0===e||e.call(n),n.waitForIdle()})).then((function(){return function(e,t,n,i,o,s){var c,d=this;g.logMessage("Running scenario "+t.displayName+" iteration "+e);var p={value:0};if(l){var f=_.getPeakMemoryCollectionIntervalInMs();c=setInterval((function(){return r(d,void 0,void 0,(function(){var e;return a(this,(function(t){switch(t.label){case 0:return[4,_.collectMemory(!1)];case 1:return e=t.sent(),p.value=Math.max(e,p.value),[2]}}))}))}),f)}return u.runAction(t.action,!1,i,void 0,s).then((function(){return j(e,t,n,i,o,p,c)}))}(c,t,e.verification,n,i,e.parameters)})).then((function(r){return s.iterationResults.push(r),E?Promise.reject("Automation cancelled"):t.postIterationAction&&c<e.iterations-1?(g.logMessage("Running post-iteration step for scenario "+t.displayName+" iteration "+c),u.runAction(t.postIterationAction,!0,n,void 0,e.parameters)):void 0}))},d=s.iterationResults.length;d<e.iterations;d++)c(d);return o})).then((function(){if(p)return g.logMessage("Running cleanup step for "+t.displayName),u.runAction(p,!0,n,void 0,e.parameters)})).then((function(){return s}))}function T(e,t,n,r,a){return void 0===r&&(r=null),void 0===a&&(a=null),void 0!==e.collectMemory&&I(e.collectMemory),C=e,S.forEach((function(e){return e(!0)})),n.waitForIdle().then((function(){if(!r)return m.startCollectionSession();m.setSessionId(r)})).then((function(){return function(e,t,n,r){return void 0===r&&(r=null),O=r||{scenarios:[]},e.scenarioConfigs.reduce((function(e,r,a){var i=t.getScenario(r.scenarioName),o=O.scenarios.length>a&&O.scenarios[a];return o&&(r.iterations===o.iterationResults.length||o.failed)?e:i?e.then((function(){return P(r,i,n,t.validate,o)})).catch((function(e){if(E)throw e;O.scenarios[O.scenarios.length-1].failed=!0,n.logPerformanceIssue({type:h.PerformanceIssueType.ErrorDuringAutomation,level:h.PerformanceIssueLevel.Error,message:"Scenario failed. Skipping to next scenario.",parameters:[i.displayName,e.message]})})):e.then((function(){n.logPerformanceIssue({type:h.PerformanceIssueType.ErrorDuringAutomation,level:h.PerformanceIssueLevel.Error,message:"Scenario not found. Skipping to next scenario.",parameters:[r.scenarioName]}),O.scenarios.push({scenarioConfig:r,iterationResults:[],setupExecuted:!1,failed:!0})}))}),Promise.resolve()).then((function(){return O}),(function(e){return E=!1,O.error=e,n.logPerformanceIssue({type:h.PerformanceIssueType.ErrorDuringAutomation,level:h.PerformanceIssueLevel.Error,message:"Error during automation",parameters:[e]}),O}))}(e,t,n,a)})).then((function(e){return window.UCIPerformanceRunResult=JSON.stringify(e),window.UCIPerformanceRunLog=JSON.stringify(g.getLog()),m.uploadResultSummary(e).then((function(){return e}))})).then((function(e){return b.clearAutomationState(),S.forEach((function(t){return t(!1,e)})),e}),(function(e){return b.clearAutomationState(),S.forEach((function(e){return e(!1,null)})),n.logPerformanceIssue({type:h.PerformanceIssueType.ErrorDuringAutomation,level:h.PerformanceIssueLevel.Error,message:"Automation result upload failed. Please check that the data collector is running and is reachable.",parameters:[e]}),O}))}function N(e,t,n){var r,a=e.config,i=e.results,s=e.log,c=e.collectorUrl,l=e.collectorSessionId;try{var u=a.scenarioConfigs[i.scenarios.length-1],p=i.scenarios[i.scenarios.length-1],f=p.iterationResults.length;if(e)return c&&d.setUCIPerformanceDataCollectionURL(c),l&&m.setSessionId(l),(r=g.getLog()).push.apply(r,o(s)),t.getScenario(u.scenarioName).isBoot?j(f,t.getScenario(u.scenarioName),u.verification,n,t.validate).then((function(e){return p.iterationResults.push(e),T(a,t,n,l,i)}),(function(e){return p.failed=!0,n.logPerformanceIssue({type:h.PerformanceIssueType.ErrorDuringAutomation,level:h.PerformanceIssueLevel.Error,message:"Scenario failed. Skipping to next scenario.",parameters:[u.scenarioName,e.message]}),T(a,t,n,l,i)})):T(a,t,n,l,i)}catch(e){return i.error=e,n.logPerformanceIssue({type:h.PerformanceIssueType.ErrorDuringAutomation,level:h.PerformanceIssueLevel.Error,message:"Error during automation",parameters:[e]}),Promise.resolve(i)}}function A(e){S.push(e)}t.setShouldCollectMemory=I,t.saveAutomationState=function(){b.saveAutomationState({config:C,results:O,log:g.getLog(),collectorUrl:d.getUCIPerformanceDataCollectionURL(),collectorSessionId:m.getSessionId()})},t.validateNetworkRequests=w,t.runPerformanceAutomation=T,t.continuePerformanceAutomation=N,t.checkForContinuingPerformanceAutomation=function(e,t){var n=b.getAutomationState();if(n)return N(n,e,t);var r=d.getPerformanceAutomationConfig();return r&&r.autoStart&&T(r,e,t),Promise.resolve(null)},t.cancelPerformanceAutomation=function(){E=!0},t.subscribeToAutomationEvents=A,A((function(e,t){var n,r;if(window.PerformanceAutomationRunning=e,e&&g.logMessage("Automation run start"),t){g.logMessage("Full automation run results:");try{for(var a=s(t.scenarios),i=a.next();!i.done;i=a.next())for(var o=i.value,c=0;c<o.iterationResults.length;c++){var l=o.iterationResults[c],u=l.keyPerformanceIndicators.reduce((function(e,t){return e+", "+t.name+": "+t.value.toFixed()}),""),d=o.scenarioConfig.scenarioName+" "+c+u;l.memory&&(d+=", MemoryDiagnostics: "+JSON.stringify(l.memory)),g.logMessage(d)}}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}t.error&&g.logMessage("Run terminated with error: "+t.error)}e||g.logMessage("Automation run end")}))},odYE:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("SAYH"),a=n("WRF3");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class i{constructor(e,t,n){this.etn=e,this.id=t||r.a.EMPTY,this.name=n,Object.freeze(this)}static toString(e){return`${e.etn}:${r.a.toString(e.id)}`}static equals(e,t){let n=i.equalsIgnoreName(e,t);return e&&t?(e.name&&t.name&&(n=n&&e.name===t.name),n):n}static equalsIgnoreNbsp(e,t){let n=i.equalsIgnoreName(e,t);return e&&t?(e.name&&t.name&&(n=n&&e.name.replace(/\u00a0/g," ")===t.name.replace(/\u00a0/g," ")),n):n}static equalsIgnoreName(e,t){return!e&&!t||!(!e||!t)&&(e.etn===t.etn&&r.a.equals(e.id,t.id))}static toLegacyEntityReference(e){return new a.a(e.etn,r.a.toLegacyGuid(e.id),e.name)}static fromLegacyEntityReference(e){return new i(e.LogicalName,r.a.fromLegacyGuid(e.Id),e.Name)}static fromExternalEntityReference(e){return new i(e.entityType,r.a.fromExternalGuid(e.id))}static legacyToExternalEntityReference(e){return{id:r.a.externalGuid(r.a.fromLegacyGuid(e.Id)),entityType:e.LogicalName}}static toExternalEntityReference(e){return{id:r.a.externalGuid(e.id),entityType:e.etn}}}i.EMPTY=new i("")},olF5:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i}));var r=n("504W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t){if(Object(r.a)(e))throw Error.argumentNull(t)}function i(e,t){if(e<1)throw Error.create(t)}},olXY:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return c}));var r=n("eXjw"),a=n("SAYH"),i=n("BzGi");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function o(e){return{initialized:r.a.Initialized,oDataInitialized:r.a.Uninitialized,Name:e.Name,PresentationDescription:e.PresentationDescription,DataDescription:e.DataDescription,PrimaryEntityTypeCode:e.PrimaryEntityTypeCode,IsDefault:e.IsDefault,ModifiedOn:e.ModifiedOn,WebResourceId:a.a.tryParseOrNull(e.WebResourceId),VersionNumber:e.VersionNumber,OverallVersionNumber:e.OverallVersionNumber,OverallUserVersionNumber:e.OverallUserVersionNumber}}function s(e){if(!e||0===e.length)return null;const t={};for(const n in e){const r=e[n];t[r.Id]=o(r)}return t}function c(e){if(!e||0===e.length)return null;const t={};let n={},o={};const s={};for(const c of e)if(c.hasOwnProperty("EntityLogicalName")){for(const e of c.SelectorItems){const r={Id:new a.a(e.Id),Name:e.Name,IsDefault:e.IsDefault,IsUserChart:e.IsUserChart,OverallVersionNumber:e.OverallVersionNumber,OverallUserVersionNumber:e.OverallUserVersionNumber};t.hasOwnProperty(c.EntityLogicalName)||(t[c.EntityLogicalName]=new a.a(e.Id)),e.IsUserChart?o[e.Id]=r:n[e.Id]=r}s[c.EntityLogicalName]={initialized:r.a.Initialized,chartTypes:{[i.a[i.a.savedvisualization]]:n,[i.a[i.a.uservisualization]]:o}},o={},n={}}return{chartDefaults:t,chartSelectors:s}}},olZa:function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"g",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"d",(function(){return l})),n.d(t,"e",(function(){return s})),n.d(t,"f",(function(){return c})),n.d(t,"a",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="Button_Label_Close",a="Web.NavBar.Back_Caption",i="Button_Label_OK",o="Button_Label_Cancel",s="Leave_This_Page",c="Leave_Page_Text",l=[r,i,o,s,c,a]},omKH:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return o}));var r=n("odYE"),a=n("Nb1E"),i=n("IqkD");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const o="userSettingsMobileApp.set";function s(){return{type:"userSettingsMobileApp.retrieve",execute({dispatch:e,getState:t}){const n=t(),o=Object(i.q)(n);if(!o)return Promise.reject("Cannot fetch personal settings because there is no user id.");const s=new r.a("usersettings",o);return e(Object(a.d)(s,"?$select=paginglimit,defaultcalendarview,workdaystarttime,workdaystoptime,timezonecode")).then(t=>{const n={defaultCalendarView:(r=t).defaultcalendarview,recordsPerPage:r.paginglimit,timeZoneCode:r.timezonecode,workDayStartTime:r.workdaystarttime,workDayStopTime:r.workdaystoptime};var r;return e(l(n)),n})}}}function c(e){return{type:"userSettingsMobileApp.save",execute({dispatch:t,getState:n}){t(l(e));const o=n(),s=Object(i.q)(o);if(!s)return Promise.reject("Cannot save personal settings because there is no user id.");const c=new r.a("usersettings",s),d=function(e){const t={};return Object.keys(e).forEach(n=>{const r=u[n];if(!r)throw new Error("Unrecognized setting "+r);t[r]=e[n]}),t}(e);return Object.keys(d).length?t(Object(a.f)(c,d)).then(e=>{}):Promise.resolve()}}}function l(e){return{type:o,payload:e}}const u={defaultCalendarView:"defaultcalendarview",recordsPerPage:"paginglimit",timeZoneCode:"timezonecode",workDayStartTime:"workdaystarttime",workDayStopTime:"workdaystoptime"}},omgb:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.Slate=1]="Slate",e[e.Phone=2]="Phone",e[e.Desktop=3]="Desktop",e[e.MailApp=4]="MailApp"}(r||(r={}))},onzm:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return s}));var r=n("sw/s"),a=n("arV0");function i(e,t){const n=Object(a.a)(e,t);return n&&n.uniqueName?Object(r.a)(e,n.uniqueName):null}function o(){return"TaskBasedFlow"}function s(){return"TaskBasedFlow"}},oqdd:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.Success=0]="Success",e[e.Redirect=1]="Redirect",e[e.Fail=2]="Fail"}(r||(r={}))},"p/Kg":function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="editedview.update.pagemap",a="editedview.remove.pagemap";function i(e,t,n,a){return{type:r,payload:{gridDescriptor:a,fetchXml:n},meta:{pageToEditedViewMapId:e,viewId:t}}}function o(e,t){return{type:a,payload:{},meta:{pageToEditedViewMapId:e,viewId:t}}}},p0fx:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r=["Header_Fields_Label"]},p6uC:function(e,t,n){"use strict";var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.getSessionId=t.setSessionId=t.uploadResultSummary=t.uploadIterationResult=t.startCollectionSession=t.isCollectorActive=void 0;var a=n("VKaO"),i=null;function o(e,t){var n=a.getUCIPerformanceDataCollectionURL();return n?new Promise((function(r,a){var i=new XMLHttpRequest;i.open("POST",n+e,!0),i.onload=function(){r(i.responseText)},i.onerror=a,i.setRequestHeader("Content-type","application/json; charset=utf-8"),i.send(t)})):Promise.resolve()}t.isCollectorActive=function(){var e=a.getUCIPerformanceDataCollectionURL();return null!=e&&e.length>0},t.startCollectionSession=function(){return o("/startsession/","").then((function(e){i=e}))},t.uploadIterationResult=function(e,t,n){return o("/saveiterationresult/",JSON.stringify({sessionId:i,scenarioName:e,iteration:t,json:JSON.stringify(n)}))},t.uploadResultSummary=function(e){var t,n,a,s,c,l,u="";e.error&&(u="Error, "+e.error+"\n");try{for(var d=r(e.scenarios),p=d.next();!p.done;p=d.next()){var f=p.value;if(0!==f.iterationResults.length){u+="Scenario, Iteration, Issues";var g=f.iterationResults[0];try{for(var h=(a=void 0,r(g.keyPerformanceIndicators)),m=h.next();!m.done;m=h.next()){u+=", "+m.value.name}}catch(e){a={error:e}}finally{try{m&&!m.done&&(s=h.return)&&s.call(h)}finally{if(a)throw a.error}}u+="\n";for(var b=0;b<f.iterationResults.length;b++){var y=f.iterationResults[b];u+=f.scenarioConfig.scenarioName+", "+b.toString()+", ",y.issues&&y.issues.length>0&&(u+=y.issues.map((function(e){return e.message})).join(" "));try{for(var _=(c=void 0,r(y.keyPerformanceIndicators)),v=_.next();!v.done;v=_.next()){u+=", "+v.value.value.toFixed()}}catch(e){c={error:e}}finally{try{v&&!v.done&&(l=_.return)&&l.call(_)}finally{if(c)throw c.error}}u+="\n"}}}}catch(e){t={error:e}}finally{try{p&&!p.done&&(n=d.return)&&n.call(d)}finally{if(t)throw t.error}}return o("/saverunresults/",JSON.stringify({sessionId:i,result:u}))},t.setSessionId=function(e){i=e},t.getSessionId=function(){return i}},p9KN:function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"s",(function(){return a})),n.d(t,"t",(function(){return i})),n.d(t,"h",(function(){return o})),n.d(t,"g",(function(){return s})),n.d(t,"n",(function(){return c})),n.d(t,"o",(function(){return l})),n.d(t,"l",(function(){return u})),n.d(t,"m",(function(){return d})),n.d(t,"v",(function(){return p})),n.d(t,"q",(function(){return f})),n.d(t,"w",(function(){return g})),n.d(t,"x",(function(){return h})),n.d(t,"i",(function(){return m})),n.d(t,"f",(function(){return b})),n.d(t,"a",(function(){return y})),n.d(t,"k",(function(){return _})),n.d(t,"b",(function(){return v})),n.d(t,"p",(function(){return S})),n.d(t,"u",(function(){return O})),n.d(t,"r",(function(){return C})),n.d(t,"y",(function(){return E})),n.d(t,"e",(function(){return I})),n.d(t,"c",(function(){return w})),n.d(t,"j",(function(){return j}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="NavBar_DetailedPage_Area_Info",a="NavBar_DetailedPage_Area_SFA",i="NavBar_DetailedPage_Area_CS_SM",o="NavBar_DetailedPage_Area_MA",s="NavBar_DetailedPage_Area_IMA",c="NavBar_DetailedPage_Area_PROCESS",l="Area_Label_ProductBundles",u="Area_Label_OtherContacts",d="Tab_Label_PlanningTasks",p="Tab_Label_TargetLists",f="Tab_Label_RelatedCampaigns",g="Tab_Label_TargetProducts",h="Tab_Label_WebLeads",m="MA.List.ListMember.Details.MarketingList",b="ImportFailures_View",y="AsyncOperationAreaTitle",_="Tab_Label_History",v="FormEditor_Nav_Workflows_Label",S="FormEditor_Nav_ProcessSessions_Label",O="Tab_Label_Services",C="Tab_Label_ResourceGroups",E="Tab_Label_Working_Hours",I="Tab_Label_FeedBack",w="Tab_Label_Connections",j="Object_Plural_Member"},pCLb:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));function r(e){return{type:"clientapi.recycle.async",execute:(t,n)=>(n.ScriptManager.removeContainer(e),Promise.resolve())}}},pEXn:function(e,t,n){"use strict";n.d(t,"g",(function(){return i})),n.d(t,"p",(function(){return o})),n.d(t,"j",(function(){return s})),n.d(t,"f",(function(){return c})),n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return p})),n.d(t,"e",(function(){return d})),n.d(t,"b",(function(){return b})),n.d(t,"k",(function(){return u})),n.d(t,"n",(function(){return _})),n.d(t,"q",(function(){return f})),n.d(t,"i",(function(){return g})),n.d(t,"r",(function(){return h})),n.d(t,"o",(function(){return m})),n.d(t,"a",(function(){return y})),n.d(t,"u",(function(){return E})),n.d(t,"t",(function(){return C})),n.d(t,"s",(function(){return w})),n.d(t,"m",(function(){return j})),n.d(t,"l",(function(){return a})),n.d(t,"h",(function(){return P}));var r=n("+Qpx");const a="operation",i={ActivityId:"ActivityId",SessionId:"SessionId",ComponentName:"ComponentName",SessionContext:"SessionContext",EventContext:"EventContext",UserAgent:"UserAgent",Origin:"Origin"},o={SessionId:"SessionId",ServerVersion:"ServerVersion",HostVersion:"AppVersion",ClientVersion:"ClientVersion",OrganizationId:"OrgId",UserId:"UserId",AadObjectId:"AadObjectId",AadTenantId:"AadTenantId",HostType:"HostType",HostSubType:"HostSubType",PlayerName:"PlayerName",NavigationType:"NavigationType",AppId:"AppId",AppModule:"AppModule",AppModuleClientType:"AppModuleClientType",StateRestoreEnabled:"StateRestoreEnabled"},s={ServerConnectivityState:"ServerConnectivityState",NetworkConnectivityState:"NetworkConnectivityState",OfflineFeatureAvailableForUse:"OfflineFeatureAvailableForUse",HasUserForcedOffline:"HasUserForcedOffline",IsOfflineByDefaultApp:"IsOfflineByDefaultApp",UseLocal:"UseLocal"},c={Name:"uci_context",Common:i,WindowResolution:"WindowResolution",ScreenResolution:"ScreenResolution",InstallId:"InstallId",DeviceModel:"DeviceModel",DeviceMemory:"DeviceMemory",HardwareConcurrency:"HardwareConcurrency",OrganizationParameters:{Language:"OrgLanguage",OrgName:"OrgName"},UserParameters:{Language:"UserLanguage"}},l={AllowLegacyClientExperience:"AllowLegacyClientExperience",Error:"Error"},u={Name:"uci_init",StartTime:"StartTime",Common:i},d={Message:"Message",CallStack:"CallStack"},p={Common:i,ActionContext:"ActionContext"},f={Name:"uci_monitor_success",CommonAction:p},g={Name:"uci_monitor_failure",CommonAction:p,CommonError:d,SuggestedMitigation:"SuggestedMitigation"},h={Name:"uci_trace",CommonAction:p,CommonError:d,TraceLevel:"TraceLevel"},m={Name:"uci_script_error",CommonAction:p,CommonError:d,FunctionName:"FunctionName",FileName:"FileName",LineNumber:"LineNumber",ColumnNumber:"ColumnNumber",WindowName:"WindowName"},b={PageLoadParameters:{LoadQuality:"LoadQuality",FirstInteractionName:"FirstInteractionName",FirstInteractionTime:"FirstInteractionTime",Interactions:"Interactions",NavigationOrigin:"NavigationOrigin",TimeSinceIdle:"TimeSinceIdle",NetworkRequestInfo:"NetworkRequestInfo",NetworkRequests:"NetworkRequests",FirstAppStart:"FirstAppStart",ZoneActivity:"ZoneActivity",ColdLatency:"coldLatency",WarmLatency:"warmLatency",WarmThroughput:"warmThroughput",Automation:"Automation",IdleTasks:"IdleTasks",Attribution:"Attribution",CustomScriptTime:"CustomScriptTime",SyncRequestTime:"SyncRequestTime",NumberOfRibbons:"NumberOfRibbons",NumberOfControls:"NumberOfControls",JsHeapSizeLimit:"JsHeapSizeLimit",TotalJSHeapSize:"TotalJSHeapSize",UsedJSHeapSize:"UsedJSHeapSize"},CommandingParameters:{CommandManagerId:"CommandManagerId",EntityName:"EntityName",ContextKey:"ContextKey",RibbonId:"RibbonId",CommandType:"CommandType",CommandId:"CommandId",ControlId:"ControlId",PageId:"PageId",ExecuteWarningEntityName:"ExecuteWarningEntityName",SelectedItemsCount:"SelectedItemsCount",UrlActionCount:"UrlActionCount",JavascriptActionCount:"JavascriptActionCount",LibraryCount:"LibraryCount"},LookupDialogParameters:{DefaultEntityType:"DefaultEntityType",DefaultViewId:"DefaultViewId",EntityTypes:"EntityTypes",ViewIds:"ViewIds",AllowMultiSelect:"AllowMultiSelect",SearchText:"SearchText"},OfflineStatusPageParameters:{CodeCacheState:"OfflineStatusPage.CodeCacheState",OfflineStatus:"OfflineStatusPage.Status",OfflineStatusReason:"OfflineStatusPage.StatusReason",OfflineEnabledEntities:"OfflineStatusPage.EnabledEntities",OfflineDisabledEntities:"OfflineStatusPage.DisabledEntities",OfflineMetadataDownloadRequired:"OfflineStatusPage.MetadataDownloadRequired"},FormParameters:{PageId:"PageId",IsMainFormDialog:"IsMainFormDialog",EntityId:"EntityId"},SaveFormParameters:{SaveMode:"SaveMode"},DialogButtonClickParameters:{ControlId:"ControlId",DialogUniqueName:"DialogUniqueName"},DialogXClickParameters:{DialogUniqueName:"DialogUniqueName",SourceType:"SourceType"},QuickFormCardControlUpdateViewParameters:{HasParametersValue:"HasParametersValue",PageType:"PageType",PageEntityType:"PageEntityType",EntityType:"EntityType",ControlId:"ControlId",TraceLocation:"TraceLocation"},BpfStageButtonClickParameters:{StageButtonName:"StageButtonName",StageId:"StageId"},BpfProcessControlRenderParameters:{ProcessId:"ProcessId",BusinessProcessFlowInstanceId:"BusinessProcessFlowInstanceId",PageId:"PageId",EntityTypeCode:"EntityTypeCode",EntityId:"EntityId",CorrelationId:"CorrelationId"},BpfActionStepButtonClickParameters:{ActionStepIdKey:"ActionStepIdKey"},SearchParameters:{SearchSessionId:"SearchSessionId",SearchWithoutFilters:"SearchWithoutFilters",SearchFilter:"SearchFilter",IsBarcodeScan:"IsBarcodeScan",UsingSuggestion:"UsingSuggestion",IsNewSearchExperience:"IsNewSearchExperience"},CommonErrorParameters:{ErrorStack:"ErrorStack"},TaskBasedFlowParameters:{PrimaryModelName:"PrimaryModelName",RecordId:"RecordId"},PageInfraReadyParameters:{RenderedControls:"RenderedControls"},ShimBootParameters:{ShimBootType:"ShimBootType"},DashboardCommandsParameters:{Error:"Error",Failure:"Failure",IsPowerBIDashboard:"isPowerBIDashboard",PowerBIDashboardId:"PowerBIDashboardId",PowerBIGroupId:"PowerBIGroupId",CrmDashboardId:"CrmDashboardId"},BootPerformanceParameters:{BundleName:"bundleName",IsStateRestore:"IsStateRestore"},CustomPageEventParameters:{AppName:"appName",IsRenderingInline:"isRenderingInline"},AdvancedFindLookupResolverParameters:{Name:"RetrieveRecordsForAdvancedFindLookup",PrimaryEntity:"PrimaryEntityName",Targets:"LookupTargets",SearchString:"SearchString",EntityMetadataUnavailable:"MissingEntityMetadata",RetrieveRequestSuccess:"RetrieveAFLookupDataSuccess",RetrieveRequestFail:"RetrieveAFLookupDataFail"},ModelFormComponent:{IsPreInitialized:"IsPreInitialized"},WebResourceParameterNames:{FunctionName:"FunctionName",WebResourceName:"WebResourceName",SolutionName:"SolutionName",PublisherName:"PublisherName"},FormTabSwitch:{TabName:"TabName"},UpsyncParameters:{commandType:"CommandType",operationType:"OperationType",upsyncRequestId:"UpsyncRequestId",upsyncId:"UpsyncId",errorCode:"ErrorCode",errorMessage:"ErrorMessage",isCrudTransactionBatch:"IsCrudTransactionBatch",syncErrorCount:"SyncErrorCount",responseTime:"ResponseTime"},EntityKind:"EntityKind",EntityName:"EntityName",AttributeName:"AttributeName",RecordId:"RecordId",Id:"Id",ActionType:"ActionType",ActionList:"ActionList",WebResourceName:"WebResourceName",CustomControlId:"CustomControlId",PowerBIComponentTypeCode:"PowerBIComponentTypeCode",ViewId:"ViewId",VisualizationId:"VisualizationId",DesignerType:"DesignerType",ModalDialogType:"ModalDialogType",UniqueName:"UniqueName",SolutionId:"SolutionId",ComponentId:"ComponentId",DashboardId:"DashboardId",RetrievedDashboardId:"RetrievedDashboardId",DashboardNavPath:"DashboardNavPath",DashboardType:"DashboardType",DashboardTypeFlags:"DashboardTypeFlags",BoundDashboardEntity:"BoundDashboardEntity",ShowDefaultDashboard:"ShowDefaultDashboard",WelcomePageName:"WelcomePageName",MetadataTye:"MetadataType",MetadataSubType:"MetadataSubType",MetadataId:"MetadataId",MetadataNames:"MetadataNames",ApplicationEventLevel:"ApplicationEventLevel",ServerAvailabilityStatus:"ServerAvailabilityStatus",BenchmarkControlName:"BenchmarkControlName",BenchmarkElementNumber:"BenchmarkElementNumber",LegacyDialogUrl:"LegacyDialogUrl",LegacyDialogOptions:"LegacyDialogOptions",LocalDataSourceAvailabilityStatus:"LocalDataSourceAvailabilityStatus",IsMocaOfflineFeatureEnabled:"IsMocaOfflineFeatureEnabled",MobileOfflineFeatureStatus:"MobileOfflineFeatureStatus",OfflineStatus:"OfflineStatus",IsMocaOfflineFeatureEnabledInOrg:"IsMocaOfflineFeatureEnabledInOrg",IsEmptyPayload:"IsEmptyPayload",UpdateInProgress:"UpdateInProgress",IsAppModuleToLastModifiedTimeMapEmpty:"IsAppModuleToLastModifiedTimeMapEmpty",HaveTimestampsChanged:"HaveTimestampsChanged",UnprocessedAppModuleIds:"UnprocessedAppModuleIds",ClientRequestId:"ClientRequestId",CurrentMetadataVersion:"CurrentMetadataVersion",ChangedMetadataVersion:"ChangedMetadataVersion",WorkBlockKpi:"WorkBlockKpi",MultipleWorkBlockKpi:"MultipleWorkBlockKpi",IsGridRoot:"IsGridRoot",IsAssociatedGrid:"IsAssociatedGrid",IsSubGrid:"IsSubGrid",IsEmptyFetch:"IsEmptyFetch",IsEmptyOfflineSqlQuery:"IsEmptyOfflineSqlQuery",IsEntityAvailableForOfflineUsage:"IsEntityAvailableForOfflineUsage",IsValidFetchXmlForOfflineUsage:"IsValidFetchXmlForOfflineUsage",OfflineConfigurationErrorCode:"OfflineConfigurationErrorCode",RelatedEntityUnavailableOffline:"RelatedEntityUnavailableOffline",ViewName:"ViewName",IsEmptyInstallationId:"IsEmptyInstallationId",IsEmptySubscriptionId:"IsEmptySubscriptionId",ErrorMessage:"ErrorMessage",RequestStatus:"RequestStatus",SubscriptionErrorMessage:"SubscriptionErrorMessage",ReconnectErrorMessage:"ReconnectErrorMessage",ComponentType:"ComponentType",IsApplicationMetadataDownloadInShimEnabled:"IsApplicationMetadataDownloadInShimEnabled",AutomaticReconnect:"AutomaticReconnect",QueryNavPath:"QueryNavPath",IsFirstDownloadPromptAlreadyTriggered:"IsFirstDownloadPromptAlreadyTriggered",FormId:"FormId",IsCodeCacheReady:"IsCodeCacheReady",OfflineStatusReason:"OfflineStatusReason",IsForcedSync:"IsForcedSync",EnableRoleBasedOfflineProfileAccess:"EnableRoleBasedOfflineProfileAccess",EnableRoleBasedOfflineProfileSetting:"EnableRoleBasedOfflineProfileSetting",EnableServerAndNativeFCBForRoleBasedProfileAccess:"EnableServerAndNativeFCBForRoleBasedProfileAccess",OfflineProfileId:"OfflineProfileId"},y={CorrelationId:"CorrelationId",ContextId:"ContextId",ActionType:"ActionType",ActionStack:"ActionStack",EntryStack:"EntryStack",SourceContextId:"SourceContextId",ParentContextId:"ParentContextId"},_={Name:"uci_monitor_performance",CommonAction:p,MetricName:"MetricName",StartTime:"StartTime",MetricValue:"MetricValue",PageName:"PageName",LoadType:"LoadType",IsBoot:"IsBoot",CleanLoad:"CleanLoad",[b.EntityName]:b.EntityName,ServerActivityId:"ServerActivityId"},v=[c,u,_,f,g,h,m];let S;function O(e){let t=[];for(const n in e)"Name"!==n&&("string"==typeof e[n]||e[n]instanceof String?t.push(e[n]):t=t.concat(O(e[n])));return t}function C(e){return!S[e]}function E(e,t){if(S[e]){const n=S[e];for(let e=0;e<n.length;e++)if(t===n[e])return!0}return!1}!function(){if(!S){S={};for(let e=0;e<v.length;e++)S[v[e].Name]=O(v[e])}}();const I=O(y);function w(e){for(const t in I)if(e===I[t])return!0;return!1}const j="uci_powerbi_events",P=[c.Name,u.Name,f.Name,_.Name,g.Name,h.Name,m.Name,"uci_bounddashboard_load","uci_dashboard_load","uci_dashboard_time","uci_daterangefilter","uci_globalfilter_apply",j,"uci_chart_usage_monitor","uci_controlframework_usage","uciknowledgearticleribbonactions","ucikbsearchcontrol","kbsearchcontrolusage","kbsearchcontrolperformance","kbsearchcontrolerror","mdfsearchevent","servicewebresources","service_opendialogaction","documenttemplates","doctemplatedownloadcontrolinit","exporttoexcelonline","excelonlinecontrolinit","excelonlinefilecreated","excelcontrolinit","exporttoexcelfailure","excelonlinecontrolfailure","salesproeventinfo","salesprofailureeventinfo","sitraceevent","sitracecievent","sitracebievent","createfeedbackrecord","updatefeedbackrecord","leadscore360cardcontrolloadevent","salesintelligencetelemetry","leadscorefeedbackevent","leadscorefailureevent","leadscoreperfmarkers","leadscorereasonparsefailureevent","leadscoremodeloperationevent","leadscoreinfocontrolloadevent","leadscoreloadercontrolloadevent","closedleadrecordsevent","leadscoreconfigcontrolloadevent","actiononemailengagementactions","emailengagementactionentrypoint","notesanalysispopupactioninvoked","notesanalysispopuperror","notesanalysispopupinit","notesanalysispopupcloseclick","notesanalysispopupclick","notesanalysispopupkeydown","notesanalysiscontrolinsightretrievesuccess","notesanalysiscontrolinsightretrievefailure","talkingpointscount","talkingpointsviewswitched","talkingpointsmarkedasfavourite","talkingpointsexpanded","talkingpointscategoryiconclicked","relationshipassistantentrypoint","actiononrelationshipassistantcard","assistantstudioerror","assistantstudioinformation","assistantstudioparenterror","uci_commanding_command_execution","actiononrelationshipassistantcard","relationshipassistantentrypoint","actioncardfeedback","actioncarddisplay","relationshipcardactiontaken","unifiedconfigucitelemetry","salesinsightsadminconfiguration","processdesignersaved","processdesigneractivated","processdesignerdeactivated","processdesignerlaunched","kmratingevent","autocaptureeventinfo","autocapturefailureeventinfo","ucikbarticlecontrol","skypechannelinitialpresencereceivedevent","skypechannelcontactcardloadevent","skypechannelmakecallevent","skypechannelsendimevent"].concat(r.J).concat(r.i).concat(r.n)},pF61:function(e,t,n){"use strict";n.d(t,"h",(function(){return S})),n.d(t,"c",(function(){return O})),n.d(t,"b",(function(){return I})),n.d(t,"i",(function(){return C})),n.d(t,"a",(function(){return R})),n.d(t,"k",(function(){return D})),n.d(t,"e",(function(){return x})),n.d(t,"j",(function(){return A})),n.d(t,"m",(function(){return E})),n.d(t,"f",(function(){return P})),n.d(t,"l",(function(){return T})),n.d(t,"d",(function(){return j})),n.d(t,"o",(function(){return M})),n.d(t,"g",(function(){return F})),n.d(t,"n",(function(){return N}));var r=n("oT5e"),a=n("xHmU"),i=n("D+Bz"),o=n("/2Q6"),s=n("FJiw"),c=n("IfHN"),l=n("q27N"),u=n("0kGT"),d=n("TQVK"),p=n("Lyxw"),f=n("3/02"),g=n("arV0"),h=n("504W"),m=n("H4dV"),b=n("r0R4"),y=n("3peg"),_=n("9xX1"),v=n("n3bs");function S(e){return!!Object(r.f)(e).error}function O(e,t){return t?Object(r.a)(e,t).pageId:Object(r.f)(e).pageId}function C(e,t){return t?Object(r.a)(e,t).error||void 0:Object(r.f)(e).error||void 0}function E(e,t){if(Object(u.c)(e)){const n=Object(r.f)(e).history;if(n&&n.some(e=>e.state&&e.state.pageId===t))return!1}const n=Object(r.b)(e,t);return null==n}function I(e,t){const n=Object(a.a)(e,t);return n.length>0?n[n.length-1]:null}function w(e,t){if(!t||!t.mapping)return!1;if(t.mapping.pageType===o.a.pageType||t.mapping.pageType===l.a.pageType||t.mapping.pageType===b.a.pageType||t.mapping.pageType===v.a.ENTITY_LIST)return!0;if(t.mapping.pageType===c.a.pageType||t.mapping.pageType===_.a.pageType){const e=t.input;return t.input&&e.entityTypeName&&(null===e.formType||void 0===e.formType||2===e.formType)}return t.mapping.pageType===d.a.pageType&&Object(p.f)(e,f.Rf)}function j(e,t,n,r){var o;let c,l=!1;return t.isDialog||t.mapping&&t.mapping.type===i.a.Dialog?(c=t.mapping.getDialogOptions(t.input),l=!0):n&&"dialog"===n.target&&t.mapping&&w(e,t)?(t.mapping.getDialogOptions&&(c=t.mapping.getDialogOptions(t.input)),c=c||s.a,c.useDefaultDialogChrome=!0,l=!0,(null===(o=t.input)||void 0===o?void 0:o.dialogOptions)&&(c.inExpandMode=t.input.dialogOptions.inExpandMode)):!Object(h.b)(r)&&-1!==Object(a.a)(e).indexOf(r)&&n.replaceState&&t.mapping&&w(e,t)&&(l=!0,t.mapping.getDialogOptions?c=t.mapping.getDialogOptions(t.input):Object(g.e)(e,r)&&(c=Object(g.e)(e,r)),c=c||s.a),{isDialogNavigation:l,dialogOptions:c}}function P(e,t){return I(e,t)||O(e,t)}function T(e,t){var n;return P(e,null===(n=Object(r.b)(e,t))||void 0===n?void 0:n.id)===t}function N(e,t){if(Object(g.h)(e,t))return!0;const n=Object(r.b)(e,t);return 1===(null==n?void 0:n.type)?Object(y.f)(e,t):O(e)===t}function A(e,t){if(e&&t&&e.pages){const n=e.pages[t];if(n)return n.input&&n.input.pageType}return null}function R(e){return e.router.baseUrl}function D(e){return e.router.preRendering}function x(e,t){return Object(r.a)(e,t).disableNavigateBack}function M(e){return Object(p.f)(e,f.Gh)&&!m.a.getInstance().get_IsBrowserChrome()&&!m.a.getInstance().get_IsBrowserEdge()}function F(e){var t;return null===(t=e.router)||void 0===t?void 0:t.preLoading}},pGYJ:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return a}));var r=n("W8Pl"),a="CustomControlFramework",i=new(function(){function e(){}return e.prototype.reportUsage=function(e,t){var n={eventName:"uci_controlframework_usage",eventParameters:this.generateEventParams(e,null,null,t)};r.b&&r.b.Reporting&&r.b.Reporting.reportEvent&&r.b.Reporting.reportEvent(n)},e.prototype.reportEventFailure=function(e,t,n,i,o,s,c){var l,u,d=(null===(l=null==e?void 0:e.manifest)||void 0===l?void 0:l.ConstructorName)||(null===(u=null==e?void 0:e.configuration)||void 0===u?void 0:u.CustomControlId)||"Unknown";s&&"ControlFramework"===s&&(d=a+"."+d),r.b&&r.b.Reporting&&r.b.Reporting.reportFailure&&r.b.Reporting.reportFailure(d,t,o,this.generateEventParams(e,n,i,null,c))},e.prototype.reportEventSuccess=function(e,t){var n=e.manifest?e.manifest.ConstructorName:e.configuration.CustomControlId;n=a+"."+n,r.b&&r.b.Reporting&&r.b.Reporting.reportSuccess&&r.b.Reporting.reportSuccess(n,this.generateEventParams(e,t))},e.prototype.generateEventParams=function(e,t,n,r,a){var i=[],o={name:"ControlName",value:e?e.controlId:""},s={name:"ControlId",value:e&&e.manifest?e.manifest.CustomControlId:""},c={name:"APIName",value:t},l={name:"HostPage",value:e?e.pageType:""},u={name:"ResourceArrayLength",value:e&&e.manifest?e.manifest.Properties.Resources.length:""};if(i.push(o),i.push(s),i.push(l),i.push(u),r){var d={name:"ControlLoadStatus",value:r};i.push(d)}if(t&&i.push(c),n){var p={name:"ParentCCContext",value:n};i.push(p)}if(e.propBagData){var f={name:"Entity",value:e.propBagData&&e.propBagData.modeData?e.propBagData.modeData.entityTypeName:null};i.push(f)}return a&&i.push.apply(i,a),i},e}())},pHbk:function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var r=n("ufH1"),a=n("504W"),i=n("Div0"),o=n("03Hu"),s=n("EW4s"),c=n("8Mff"),l=n("eZ32");class u{constructor(e){this._localDataSource=null,this._localDataSource=e}createOfflineSyncErrorLog(e,t,n){const a=new s.a;return this._localDataSource.get_offlineDataStore().create(e,!0,t,n).then(e=>{Object(r.e)("MOCADataSyncFailureErrors",i.a.storage,"CreateOfflineSyncErrorLog Success"),a.resolve(e)},e=>{Object(r.e)("MOCADataSyncFailureErrors",i.a.storage,"CreateOfflineSyncErrorLog Error: "+e.get_Message()),a.reject(e)}),a}saveOfflineErrorState(e,t){const n=new s.a;return this._localDataSource.saveOfflineInformation(e,t,!0).then(e=>{n.resolve(e)},e=>{n.reject(e)}),n}isOfflineDatabaseAvailable(){return!Object(a.a)(this._localDataSource)&&!Object(a.a)(this._localDataSource.get_offlineDataStore())&&o.a.get_DefaultInstance().get_offlineTypescriptInterface().getOfflineFeatureStatus()===c.a.Enabled&&o.a.get_DefaultInstance().get_offlineTypescriptInterface().getOfflineStatus()===l.a.Available}}var d=n("jZCH"),p=n("3eti");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
let f=null;class g{constructor(e){this.offlineSyncErrorLogProvider=null,this.offlineSyncErrorLogProvider=new u(e)}createSyncErrorLog(e,t,n){return f.offlineSyncErrorLogProvider.createOfflineSyncErrorLog(e,t,n).nativePromise()}saveOfflineErrorState(e,t){f.offlineSyncErrorLogProvider.saveOfflineErrorState(e,t)}retrieveOfflineErrorState(e){return d.a.get_DefaultInstance().get_Store().dispatch(Object(p.a)(e))}isOfflineDatabaseAvailable(){return this.offlineSyncErrorLogProvider.isOfflineDatabaseAvailable()}static get_instance(){return Object(a.a)(f)&&(f=new g(d.a.get_DefaultInstance().get_LocalDataSource())),f}}},pJDo:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AggregationTransport=void 0;var r=function(){function e(){this._events=[]}return e.prototype.getEvents=function(){return this._events},e.prototype.reset=function(){this._events=[]},e.prototype.writeMarker=function(e,t,n){this._events.push({name:e.getName(),zone:e.getZone(),time:t,parameters:n})},e.prototype.writeRetroactiveTimespan=function(e,t,n,r){this._events.push({name:e.getName(),zone:e.getZone(),time:t,timeEnd:t+n,parameters:r})},e.prototype.startTimespan=function(e,t,n){var r=this;return function(a,i){r._events.push({name:e.getName(),zone:e.getZone(),time:t,timeEnd:t+a,parameters:n||i?Object.assign({},n,i):null})}},e}();t.AggregationTransport=r},pNM1:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.Off=0]="Off",e[e.Error=1]="Error",e[e.Warning=2]="Warning",e[e.Perf=3]="Perf",e[e.Info=4]="Info",e[e.Verbose=5]="Verbose"}(r||(r={}))},pZYY:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("n3bs"),a=n("SAYH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function i({appId:e,pageInput:t}){if(!t)return`help://CDS/Apps/${e}/Default`;switch(t.pageType){case r.a.ENTITY_LIST:return`help://CDS/Apps/${e}/Entities/${t.entityTypeName}/Views/Default`;case r.a.ENTITY_RECORD:return`help://CDS/Apps/${e}/Entities/${t.entityTypeName}/Forms/Default`;case r.a.DASHBOARD:{const n=t;return n.etn?`help://CDS/Apps/${e}/Entities/${n.etn}/Dashboards/${n.dashboardId?a.a.toString(n.dashboardId):"Default"}`:`help://CDS/Apps/${e}/Dashboards/${n.dashboardId?a.a.toString(n.dashboardId):"Default"}`}default:return`help://CDS/Apps/${e}/Default`}}},paR0:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("RYFF"),a=n("XjOj"),i=n("Div0"),o=n("qGFd");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class s{constructor(e,t,n){this._callId=null,this._dispatcher=null,this._size=0,this._sqlStatements=null,this._sqlParameters=null,this._requestId=null,this._extraParameters=null,this._successCallbacks=null,this._errorCallbacks=null,this._storeDbType=null,this._dispatcher=e,this._sqlStatements=new Array(0),this._sqlParameters=new Array(0),this._successCallbacks=new Array(0),this._errorCallbacks=new Array(0),this._size=0,this._callId=this._dispatcher.getCallIdForSqlBatchExecution(),this._requestId=null,this._extraParameters={},this._storeDbType=o.b.OrgDb}get_StoreDbType(){return this._storeDbType}set_StoreDbType(e){this._storeDbType=e}get_estimatedSize(){return this._size}get_RequestId(){return this._requestId}get_ExtraParameters(){return this._extraParameters}get_Statements(){return this._sqlStatements}get_Parameters(){return this._sqlParameters}get_SuccessCallbacks(){return this._successCallbacks}get_ErrorCallbacks(){return this._errorCallbacks}get_CallId(){return this._callId}addRequestId(e,t,n){this._requestId=e,this._successCallbacks.push(t),this._errorCallbacks.push(n),this._size+=e.length}addExtraParameters(e,t,n,r){this._extraParameters[e]=t,this._successCallbacks.push(n),this._errorCallbacks.push(r),this._size+=e.length+t.length}addRequest(e,t,n,a){this._sqlStatements.push(e),this._sqlParameters.push(t),this._successCallbacks.push(n),this._errorCallbacks.push(a),this._size+=r.a.CalculateEstimatedSize(e,t)}execute(e){for(let e=0;e<this.get_Statements().length;e++){const t=this.get_Statements()[e];Object(a.g)(i.a.sqlBatch,"ExecuteSqlBatch start, statement{0} = {1}",e,t)}this._dispatcher.ExecuteSqlBatch(this,()=>{Object(a.g)(i.a.sqlBatch,"ExecuteSqlBatch end"),e()})}executeV2(e,t){for(let e=0;e<this.get_Statements().length;e++){const t=this.get_Statements()[e];Object(a.g)(i.a.sqlBatch,"ExecuteMetadataSqlBatch start, statement{0} = {1}",e,t)}this._dispatcher.ExecuteMetadataSqlBatch(this,(t,n)=>{Object(a.g)(i.a.sqlBatch,"ExecuteMetadataSqlBatch end"),e(t,n)},t)}}},pah4:function(e,t,n){"use strict";n.d(t,"a",(function(){return S}));var r,a=n("Ydwo"),i=n("8o18"),o=n("ufH1"),s=n("504W"),c=n("Div0"),l=n("WWG3"),u=n("8tWD"),d=n("eruq"),p=n("jZCH");!function(e){e[e.string=0]="string",e[e.integer=1]="integer",e[e.currency=2]="currency",e[e.dateTime=3]="dateTime",e[e.float=4]="float"}(r||(r={}));var f=n("LbMF"),g=n("Lyxw"),h=n("3/02"),m=n("/A0C"),b=n("s/8p"),y=n("x8sc"),_=n("IqkD");const v=new RegExp("{\\d}","g");class S extends i.a{constructor(e,t,n,r,a){super(e,r),this._searchText=t,this._searchEntities=n,this._getState=a;let i=null;this._getState&&Object(g.f)(this._getState(),h.eg)&&(i=Object(_.h)(this._getState())),this.set_PageSize(i||25),this._UpdateDescriptorSetWithQuickFindSql(),this._UpdateRawFetchXmlWithQuickFindFetchXml()}get_searchText(){return this._searchText}static getInternalQuickFindQuery(e){const t=Object(y.a)(b.g,["/","*"])+"([\\S\\s]*)"+Object(y.a)(b.f,["/","*"]),n=new RegExp(t,"i"),r=e.match(n);return r&&r.length>0?r[1]:(Object(o.b)("Could not locate the QuickFind tokens in SQL query",c.a.quickFind,null),null)}static getInternalQuickFindQueryBwCompat(e){const t=new RegExp("WITH __QuickFind__ AS \\(SELECT \\[[\\S\\s]*\\] from \\(([\\s\\S]*)\\) AS \\[__QuickFindInternal__\\]\\)","i"),n=e.match(t);return n&&n.length>0?n[1]:null}static formatSql(e,t,n){if(0===t.length)return Object(o.b)("Could not locate the QuickFInd tokens in SQL query",c.a.quickFind,null),null;O(t),O(n);const r=t[t.length-1].split("where");if(0===r.length)return Object(o.b)("The QuickFind query does not contain 'WHERE' clause",c.a.quickFind,null),null;const a=r[0]+(n.length>0?" where "+n.join(" OR "):"");return e.replace(t[t.length-1],a)}static formatSqlBwCompat(e,t,n){O(t),O(n);const r=t[t.length-1].split("where")[0];t[t.length-1]=r+(n.length>0?" where "+n.join(" OR "):"");const a=e.split(") as [__QuickFindInternal__]");return a[0].match(new RegExp("(WITH __QuickFind__ as \\(select \\[[\\S\\s]*\\] from \\()"))[0]+t.join("UNION")+") as [__QuickFindInternal__]"+a[1]}static findQuickFindFilter(e){const t=new RegExp("SELECT [\\S\\s]* FROM [\\S\\s]* WHERE [\\S\\s]* IN \\(SELECT [\\S\\s]* FROM [\\S\\s]* WHERE ([\\S\\s]*)\\)","i"),n=new RegExp("SELECT [\\S\\s]* FROM [\\S\\s]* WHERE ([\\S\\s]*)","i"),r=[],a=[],i={};let o=e[e.length-1].match(n);o&&a.push(...o[1].split("OR"));for(let a=0;a<e.length-1;a++)o=e[a].match(t),o||(o=e[a].match(n))?r.push(o[1]):r.push("");return i.lookup=r,i.other=a,i}static modifyFilterBasedOnPlaceholder(e,t,n,r,a,i,o){if(i){const i=a?a.replace(/\\/g,"\\\\").replace(/}/g,"\\}").replace(/{/g,"\\{"):a,s=new RegExp(i,"g"),c=t[r].replace(s,o);e&&(n[r]=n[r].replace(t[r],c)),t[r]=c}else t[r]="",e&&(n[r]="")}_PopulateQuickFindSql(e,t){let n=!0,r=S.getInternalQuickFindQuery(e);if(!r&&(r=S.getInternalQuickFindQueryBwCompat(e),n=!1,!r))return Object(o.b)("QuickFindQuery._ModifyFilterBasedOnPlaceholder",c.a.quickFind,"No internal QuickFind query found:\n"+e),null;const a=this._searchEntities[0],i=p.a.get_DefaultInstance().get_MetadataCache().getEntityMetadata(a),s=r.split("UNION"),l=S.findQuickFindFilter(s),u=l.lookup,d=l.other;if(!l.lookup.length&&!l.other.length){if(!i.get_primaryNameAttribute())return Object(o.b)("QuickFindQuery._ModifyFilterBasedOnPlaceholder",c.a.quickFind,"Could not extract search conditions from the QuickFind query:\n"+e),null;r=String.format("SELECT {0} FROM {1} WHERE {0} LIKE ",i.get_primaryNameAttribute(),a)+"{0}"}return"*"===t?(s.splice(0,u.length),u.length=0,d.length=0,n?S.formatSql(e,s,d):S.formatSqlBwCompat(e,s,d)):(this._UpdateConditionsAndSearchFields(t,s,u,d),n?S.formatSql(e,s,d):S.formatSqlBwCompat(e,s,d))}_UpdateConditionsAndSearchFields(e,t,n,a){const i=S.trimWildCards(e);e=S.convertUserFindToLike(e),e=e.replace(/'/g,"''");const o={};o[r[0]]=String.format("'{0}'",e);const s=l.a.get_instance().parseIntegerValue(i);!isNaN(s)&&isFinite(s)&&s.toString()===i&&(o[r[r.integer]]=s.toString());const c=l.a.get_instance().parseDecimalValue(i);!isNaN(c)&&isFinite(c)&&(o[r[r.float]]=o[r[r.currency]]=c.toString());const u=Date.parseInvariant(i);u&&(o[r[r.dateTime]]=String.format("'{0}'",u.toString())),this._UpdateFilters(t,!0,n,o),this._UpdateFilters(t,!1,a,o)}_UpdateFilters(e,t,n,r){for(let a=0;a<n.length;a++){const i=n[a].match(new RegExp("({\\d})"));if(!i)continue;const o=this._FindPlaceHolderMatch(i[1]);S.modifyFilterBasedOnPlaceholder(t,n,e,a,i[1],o in r,o in r?r[o].toString():null)}}_FindPlaceHolderMatch(e){let t="";switch(e){case"{4}":t=r[r.float];break;case"{3}":t=r[r.dateTime];break;case"{2}":t=r[r.currency];break;case"{1}":t=r[r.integer];break;case"{0}":t=r[0]}return t}static trimWildCards(e){let t=e;if(!t)return t;"*"===t[0]&&(t=t.substring(1));return"*"===t[t.length-1]&&(t=t.substring(0,t.length-1)),t}_UpdateDescriptorSetWithQuickFindSql(){let e=null;const t=this.get_DescriptorSet().tryGetDescriptor(u.a.Sql);Object(s.b)(t)||(e=this._PopulateQuickFindSql(t,this.get_searchText()),e||Object(o.b)("The QuickFind SQL for this entity is malformed",c.a.quickFind,t)),this.get_DescriptorSet().updateDescriptorSet(u.a.Sql,e),this._updatedQuickFindSQL=e}_UpdateRawFetchXmlWithQuickFindFetchXml(){if(!Object(s.a)(this.rawFetchXmlDoc)){let e;const t=this._searchEntities[0];!function(e,t,n,r,a){t.val=!1;let i=C(n);const o=p.a.get_DefaultInstance().get_MetadataCache().getEntityMetadata(r);if(!e||"*"===e||"%"===e)return t.val=!0,void(i&&function(e){const t=e.childNodes;for(let e=0;e<t.length;e++){const n=t[e];"condition"===n.nodeName&&((n.hasChildNodes()||!Object(s.a)(n.attributes.getNamedItem("value"))&&n.attributes.getNamedItem("value").nodeValue.match(v).length>0)&&(n.parentNode.removeChild(n),e--))}e.childNodes.length||e.parentNode.removeChild(e)}(i));if(!i){if(!o.get_primaryNameAttribute())return void(t.val=!1);const e=o.get_logicalName(),r=o.get_primaryNameAttribute();let a='<fetch version="1.0" output-format="xml-platform" mapping="logical" page="1" count="50">';a+='<entity name="',a+=e,a+='">',a+='<attribute name="'+r+'"/>',a+='<filter type="or" isquickfindfields="1">',a+='<condition attribute="',a+=r,a+='"',a+=' operator="like" value="{0}" />',a+="</filter>",a+="</entity>",a+="</fetch>",i=C(n=Object(d.b)(a))}const c=S.trimWildCards(e);e=S.convertUserFindToLike(e);let u="",b="",y=!1,_=!1,O=!1;const E=l.a.get_instance().parseDecimalValue(c);if(!isNaN(E)&&isFinite(E)){b=u=E.toString(),O=_=y=!0;const e=l.a.get_instance().parseIntegerValue(c);!isNaN(e)&&isFinite(e)&&e>=-2147483648&&e<=2147483647&&e.toString()===c||(_=!1,b="")}let I="",w=!1;const j=Date.parseLocale(c);j&&(I=j.getFullYear()+"-"+(j.getMonth()<9?"0":"")+(j.getMonth()+1)+"-"+(j.getDate()<10?"0":"")+j.getDate(),w=!0);if(function(e,t,n,r,a,i,o,s,c,l,u,d){const p=t.childNodes;for(let b=0;b<p.length;b++){const y=p[b];if("condition"===y.nodeName)if(y.hasChildNodes()){if(e&&""!==e){const n=d();if(Object(g.f)(n,h.We)){const r=e.substring(0,e.length-1),a=y.attributes&&y.attributes.getNamedItem("attribute"),i=a&&a.value;if(Object(f.b)(i,l.get_logicalName(),n)===m.a.MultiSelectPickList){const e=Object(f.a)(n,l.get_logicalName(),i),a=e&&e.OptionSet,o=a&&a.filter(e=>e.Label&&e.Label.match(new RegExp(r,"i"))).map(e=>e.Value);o&&o.length>0?o.forEach((e,t)=>{if(0===t)y.firstElementChild.textContent=e&&e.toString();else{const t=u.createElement("value");t.textContent=e&&e.toString(),y.appendChild(t)}}):(t.removeChild(y),b--)}}else t.removeChild(y),b--}}else switch(y.attributes.getNamedItem("value").nodeValue){case"{4}":a?y.attributes.getNamedItem("value").nodeValue=n:(t.removeChild(y),b--);break;case"{3}":c?y.attributes.getNamedItem("value").nodeValue=s:(t.removeChild(y),b--);break;case"{2}":o?y.attributes.getNamedItem("value").nodeValue=n:(t.removeChild(y),b--);break;case"{1}":i?y.attributes.getNamedItem("value").nodeValue=r:(t.removeChild(y),b--);break;case"{0}":y.attributes.getNamedItem("value").nodeValue=e}}}(e,i,u,b,y,_,O,I,w,o,n,a),!i.hasChildNodes())return void(t.val=!1);t.val=!0}(this.get_searchText(),Object(a.a)(()=>e,t=>e=t),this.rawFetchXmlDoc,t,this._getState)}}getUpdatedSql(){return this._updatedQuickFindSQL}getUpdatedFetchXml(){return this.get_FetchXml()}static convertUserFindToLike(e){let t="";for(let n=0;n<e.length;n++)switch(e.charAt(n)){case"[":t+="[[]";break;case"_":t+="[_]";break;case"%":t+="[%]";break;case"*":t+="%";break;default:t+=e.charAt(n)}return e.length&&e.endsWith("*")||(t+="%"),t}}function O(e){for(let t=0;t<e.length;t++)Object(s.b)(e[t])&&(e.splice(t,1),t--)}function C(e){const t=e.getElementsByTagName("filter");if(!Object(s.a)(t))for(let e=0;e<t.length;e++)if(!Object(s.a)((n=t[e],r="isquickfindfields",n&&n.attributes.getNamedItem(r)?n.attributes.getNamedItem(r).nodeValue:null)))return t[e];var n,r;return null}},pgSX:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("yHXp"),a=n("ruPX");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function i(e,t,n,i,o,s,c,l,u,d,p,f,g){const h={modalDialogType:e,text:t,dialogOptions:n,title:o,subtitle:s,confirmButtonLabel:i,cancelButtonLabel:c,showDetailsLabel:l,errorDetails:u,hideDownloadLogLink:d,dynamicHelpOptions:f,blockClose:g};return Object(a.a)(r.a,h,p)}},pgj4:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));function r(e){const t=[];return e&&e.appComponents&&e.appComponents.entities&&(e.appComponents.entities.forEach(e=>{t.push(e.LogicalName)}),t.push("systemform","userform")),t}},pnQK:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return s}));var r=n("SAYH"),a=n("OtHk");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function i(e,t,n){if(n&&t){const r=Object(a.g)(e,n),i=r&&r[t.guid];if(i)return i}else if(n)return Object(a.f)(e,n);if(t){const n=Object(a.c)(e);return n&&n[t.guid]}}function o(e){switch(e&&+e.Type){case 1031:case 1034:return!0}return!1}function s(e,t){const n=t?Object(a.g)(e,t):Object(a.c)(e),i=n&&Object.keys(n).filter(e=>!Object(a.i)(new r.a(e))).sort((e,t)=>{const r=n[e],a=n[t],i=r.DisplayName.toUpperCase(),s=a.DisplayName.toUpperCase(),c=o(r),l=o(a),u=c===l;return!c&&l||u&&i<s?-1:c&&!l||u&&i>s?1:0});return r.a.tryParseOrNull(i&&i[0])}},pulT:function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}));var r=n("FoFY");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e){return e.appShellState.focusedSessionId}function i(e){return Object(r.a)(e,a(e))}function o(e){return e.appShellState.defaultSessionId}},"q/4y":function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"d",(function(){return f})),n.d(t,"a",(function(){return d})),n.d(t,"c",(function(){return c}));var r=n("SAYH");function a(e){return!!e.attributeName}function i(e){return null!==e.value&&void 0!==e.value}function o(e){return!!e.entityName}var s,c,l=n("YIt1"),u=n("I1N9");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class d{constructor(e,...t){this._operator=null,this._terms=null,this._hint=null,this._operator=e,this._terms=t}get operator(){return this._operator}set operator(e){this._operator=e}get hint(){return this._hint}set hint(e){this._hint=e}get terms(){return this._terms}set terms(e){this._terms=e}static toLegacyFilterExpression(e,t){const n="or"===e.operator?l.a.Or:l.a.And,s=r.a.newGuid().guid,c=new u.a(n,s,null,t?null:e.hint);if(p(e)){const{attributeName:t,operator:n,value:r,entityName:s}=function(e){let t=null,n=null,r=null;for(const s of e.terms)a(s)?t=s.attributeName:i(s)?n=s.value:o(s)&&(r=s.entityName);return{attributeName:t,operator:e.operator,value:n,entityName:r}}(e);c.addCondition(t,n,r,s)}else{let n=t;for(const t of e.terms)c.addFilterExpression(d.toLegacyFilterExpression(t,n)),n=n||!!t.hint}return c}}function p(e){return e.terms.every(e=>!e.terms)}function f(e,t=c.Hints){var n;let r="";if(!(null==e?void 0:e.terms)||0===e.terms.length)return"";if(p(e)){if(t===c.Hints){const t=e.terms.find(e=>a(e)),n=e.terms.find(e=>i(e));return r=(null==n?void 0:n.value)?`${t.attributeName} ${e.operator} '${n.value}'`:`${t.attributeName} ${e.operator}`,r}return function(e){const t=e.terms.find(e=>a(e)),n=e.terms.find(e=>i(e));let r;switch(e.operator){case"like":r="Contains";break;case"in":r="In";break;case"equalsUserId":r="EqualUserId"}switch(e.operator){case"eq":case"ne":case"gt":case"ge":case"lt":case"le":const a="number"==typeof(null==n?void 0:n.value)?n.value:`'${null==n?void 0:n.value}'`;return`${t.attributeName} ${e.operator} ${a}`;case"like":case"in":case"equalsUserId":const i=["PropertyName=@p1"],o=[`&@p1='${t.attributeName}'`];if(n){let e;Array.isArray(n.value)?(i.push("PropertyValues=@p2"),e="&@p2=["+n.value.map(e=>`'${e}'`).join(",")+"]"):(i.push("PropertyValue=@p2"),e=`&@p2='${n.value}'`),o.push(e)}return`Microsoft.Dynamics.CRM.${r}(${i.join(",")})${o.join("")}`;default:throw Error("Unsupported expression operation type "+e.operator)}}(e)}if(1===e.terms.length){const a=null===(n=e.operator)||void 0===n?void 0:n.toLowerCase();switch(a){case s.and:case s.or:return f(e.terms[0],t);case s.not:return r=""+f(e.terms[0],t),p(e.terms[0])||(r=`(${r})`),r;default:throw new Error(`Invalid logical operator ${a}.`)}}else{r=f(e.terms[0],t),p(e.terms[0])||(r=`(${r})`);for(let n=1;n<e.terms.length;n++){let a=f(e.terms[n],t);p(e.terms[n])||(a=`(${a})`),r=`${r} ${e.operator} ${a}`}}return r}!function(e){e.and="and",e.or="or",e.not="not"}(s||(s={})),function(e){e[e.Hints=0]="Hints",e[e.ODataUri=1]="ODataUri"}(c||(c={}))},"q/7h":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("1qQb");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t){var n;const a=e.get_entities(),i=e.get_query();let o=[];o=i&&i.GetColumnNamesFromFetch?i.GetColumnNamesFromFetch():null===(n=e.get_queryState())||void 0===n?void 0:n.columnNames;const s=[];for(let e=0;e<a.length;e++){const n=Object(r.a)(a[e],t);n.queryColumnNames=o,delete n.accessRights,s.push(n)}return s}},q0Q1:function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return g}));var r=n("jSnv");const a=Object(r.b)({Primary01:"#6264A7",Primary02:"#494B83",Primary03:"#464775",Primary04:"#3D3E66",Primary05:"#C7C9FF",Primary06:"#9EA2FF",Error01:"#C4314B",Error02:"#FCF4F6",Error03:"#A72037",Error04:"#F3D6D8",Neutral01:"#FFFFFF",Neutral02:"#FAFAFA",Neutral03:"#F5F5F5",Neutral04:"#F0F0F0",Neutral05:"#EBEBEB",Neutral06:"#E0E0E0",Neutral07:"#C7C7C7",Neutral08:"#BDBDBD",Neutral09:"#B3B3B3",Neutral10:"#949494",Neutral11:"#616161",Neutral12:"#424242",Neutral13:"#333333",Neutral14:"#242424"});const i=(o={},s={},(o=Object.assign(a,o)).Patterns.Text01=o.Palette.Neutral14,o.Patterns.Background=o.Palette.Neutral03,o.Patterns.DisabledBackground=o.Palette.Neutral05,o.Patterns.DisabledForeground=o.Palette.Neutral07,o.Patterns.InputBorder=o.Patterns.Contrast,(s=Object.assign(Object(r.c)(o),s)).TextInput.View.BackgroundColor=o.Patterns.Contrast,s.TextInput.Edit.BackgroundColor=o.Patterns.Contrast,s.ButtonPrimary.TextColor=o.Palette.Neutral01,s.ButtonPrimary.Enabled.Hover.TextColor=o.Palette.Neutral01,s.ButtonPrimary.Enabled.Pressed.TextColor=o.Palette.Neutral01,s.ButtonSecondary.BackgroundColor=o.Patterns.Contrast,s.ButtonSecondary.BorderColor=o.Palette.Neutral07,s.ButtonSecondary.Enabled.Pressed.BackgroundColor=o.Palette.Neutral05,s.ButtonSecondary.Enabled.Pressed.TextColor=o.Patterns.Text01,s.Dropdown.Disabled.BorderColor=o.Patterns.DisabledBackground,s.Dropdown.Enabled.BackgroundColor=o.Patterns.Contrast,s.DropdownMenu.BackgroundColor=o.Patterns.Contrast,s.DropdownMenu.Menuitem.BackgroundColor=o.Patterns.Contrast,s.DropdownMenu.Menuitem.BorderColor=o.Patterns.Contrast,s.DropdownMenu.Menuitem.Enabled.Focus.BackgroundColor=o.Patterns.Contrast,s.CommandBar.Command.Hover.BackgroundColor=o.Palette.Neutral05,s.CommandBar.Command.Pressed.BackgroundColor=o.Palette.Neutral06,s.Form.FooterCommand.BackgroundColor=o.Palette.Neutral05,s.Form.FooterCommand.IconColor=o.Patterns.Text01,s.Grid.ColumnHeader.TextColor=o.Palette.Neutral11,s.Grid.ColumnHeader.SortFilterIconColor=o.Palette.Neutral11,s.Grid.ColumnHeader.DividerColor=o.Palette.Neutral07,s.Grid.Cell.Hover.BackgroundColor=o.Palette.Neutral05,s.Grid.Cell.Selected.BackgroundColor=o.Palette.Neutral06,s.AppHeader.BackgroundColor=o.Palette.Primary03,s.AppHeader.IconColor=o.Patterns.Contrast,s.AppHeader.Hover.BackgroundColor=o.Palette.Primary01,s.AppHeader.Pressed.BackgroundColor=o.Palette.Primary01,s.AppHeader.Pressed.IconColor=o.Patterns.Contrast,s.Navigation.Rest.TextColor=o.Patterns.Text01,s.Navigation.Rest.IconColor=o.Patterns.Text01,s.Navigation.Rest.BackgroundColor=o.Palette.Neutral04,s.Navigation.Rest.Hover.TextColor=o.Patterns.Text01,s.Navigation.Rest.Hover.IconColor=o.Patterns.Text01,s.Navigation.Selected.TextColor=o.Patterns.Text01,s.Navigation.Selected.IconColor=o.Patterns.Text01,s.Dashboard.BackgroundColor=o.Patterns.Background,s.Dashboard.ViewSelector.ChevronBackgroundColor=o.Patterns.Background,s.Dashboard.ViewSelector.Hover.ChevronBackgroundColor=o.Palette.Neutral05,s.Dashboard.ViewSelector.Pressed.ChevronBackgroundColor=o.Palette.Neutral06,s.Dashboard.ViewSelector.Open.ChevronBackgroundColor=o.Palette.Neutral06,s.Dashboard.Card.BackgroundColor=o.Patterns.Contrast,{Colors:o,Components:s,DesignLanguageId:"Fluent",ThemeId:"DefaultTeamsTheme"});var o,s;const c=Object(r.b)({Primary01:"#FC6FE5",Primary02:"#FC6FE5",Primary03:"#FC6FE5",Primary04:"#FC6FE5",Primary05:"#FC6FE5",Primary06:"#FC6FE5",Error01:"#FC6FE5",Error02:"#FC6FE5",Error03:"#FC6FE5",Error04:"#FC6FE5",Neutral01:"#6FE5FC",Neutral02:"#6FE5FC",Neutral03:"#6FE5FC",Neutral04:"#6FE5FC",Neutral05:"#6FE5FC",Neutral06:"#6FE5FC",Neutral07:"#6FE5FC",Neutral08:"#FFFD55",Neutral09:"#FFFD55",Neutral10:"#FFFD55",Neutral11:"#FFFD55",Neutral12:"#FFFD55",Neutral13:"#FFFD55",Neutral14:"#FFFD55",Data01:"#FC6FE5",Data02:"#FC6FE5",Data03:"#FC6FE5",Data04:"#FC6FE5",Data05:"#FC6FE5",Data06:"#FC6FE5",DataEmpty:"#FC6FE5"});const l=function(e,t){return{Colors:e=Object.assign(c,e),Components:t=Object.assign(Object(r.c)(e),t),DesignLanguageId:"Fluent",ThemeId:"WackyTheme"}}({},{});var u=n("4leG"),d=n("gqKu"),p=n("lD6+");const f="designlanguage.initialize";function g(e){let t=r.a;const n=Object(u.h)(e),a=Object(p.b)(e,p.a);switch(n){case d.a.TeamsDefault:t=i;break;case d.a.Wacky:t=l;break;default:t=a?i:r.a}return{type:f,payload:t}}},q27N:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("gw2m");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a={getName:()=>r.a,getRequiredAttributes(){throw new Error("Not Implemented")},createPageModule:e=>Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(7),n.e(10),n.e(35),n.e(4),n.e(5),n.e(6),n.e(9),n.e(8),n.e(11),n.e(12),n.e(13),n.e(14),n.e(15),n.e(16),n.e(17),n.e(40),n.e(34),n.e(45),n.e(44),n.e(47),n.e(109)]).then(n.bind(null,"i+Mw")).then(({CustomPage:t})=>new t(e)),getTelemetryAttributes:e=>[{name:"pageName",value:e.name}]};var i=n("D+Bz"),o=n("n3bs");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const s={type:i.a.Page,pageType:o.a.CUSTOM,factory:a,isRedirect:!1,urlToInput(e){const t=e.searchParams;if(!t.has("name"))throw new Error("Missing required parameter 'name'");return{name:t.get("name"),entityName:t.get("etn"),recordId:t.get("id")}},inputToUrl(e,t){const n=new URL(e,window.location.origin);return n.searchParams.set("name",t.name),t.entityName&&n.searchParams.set("etn",t.entityName),t.recordId&&n.searchParams.set("id",t.recordId),n.href},inputToWebUrl(e,t){return this.inputToUrl(e,t,!1)}}},q43A:function(e,t,n){"use strict";n.d(t,"d",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return l}));var r=n("H4dV"),a=n("SocB");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i=r.a.getInstance().get_IsBrowserIE();function o(e,t){const n={":hover":{backgroundColor:t,color:Object(a.e)(t.toString())}};return Object.assign(Object.assign({},e),n)}function s(e,t,n,r){const o=Object(a.e)(t),s="#000000"===o?"invert(20%)":"invert(100%)";let c=o;"#000000"===o&&(c=r);const l=i?{fill:c}:{"-webkit-filter":s,filter:s},u=n?{":hover .svgIcon":l}:l;return Object.assign(Object.assign({},e),u)}function c(e,t){return{backgroundColor:t?t.Components.AppHeader.Hover.BackgroundColor:e.colors.NavBar.NavBar2.Fill,outline:"1px solid !important",outlineColor:(t?t.Components.AppHeader.Focus.BorderColor:e.colors.NavBar.NavBar3.Text)+" !important",outlineOffset:"-2px !important"}}function l(){return{backgroundColor:a.d.Black+" !important",filter:"invert(100%)"}}},q441:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r,a=n("F6M4"),i=n("QEBF"),o=n("hGVc"),s=n("ghc6"),c=n("8aze"),l=(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return l(t,e),t.prototype.getElementName=function(){return"button"},t.prototype.getElementProps=function(){var e={type:"button",ref:this.props.refCallback?this.refCallbackTrigger.bind(this):null};return e[o.a]=this.props.accessKey,this.props.disabled&&(e[o.D]=!0),e},t.prototype.getElementClassName=function(){var t=e.prototype.getElementClassName.call(this);return this.props&&this.props.className&&(t+=" "+this.props.className),t},t.prototype.getFlexClassName=function(e){return Object(a.b)(e?e.display:null)},t.prototype.getElementStyle=function(){if(this.props.style)return Object.assign({},Object(a.a)(this.props.style))},t.displayName="Button",t}(i.a),d=s.a(c.b)(u)},q6Ks:function(e,t,n){"use strict";n.d(t,"e",(function(){return A})),n.d(t,"b",(function(){return P})),n.d(t,"c",(function(){return j})),n.d(t,"d",(function(){return N})),n.d(t,"a",(function(){return R}));var r=n("SAYH"),a=n("eXjw"),i=n("Xd5/"),o=n("MXaZ"),s=n("IqkD"),c=n("5Oca"),l=n("iZ7K"),u=n("3hnk"),d=n("NjDY"),p=n("69Qu"),f=n("unFF"),g=n("YxC/"),h=n("3mEc"),m=n("0zhR"),b=n("GYEz"),y=n("w1eR"),_=n("5ZBI"),v=n("H4dV"),S=n("4leG"),O=n("tJ+6"),C=n("fU7K"),E=n("L6aH"),I=n("CpcI");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const w="CustomControlFramework.Selectors.CustomControlHostPropertyBagSelectors";function j(){let e={},t={};return n=>{_.a.info(w+": createRetrieveFormattingSettingsInfo started");const r=Object(s.x)(n),a=Object(d.h)(n),o=[];return r!==e&&(t.dateTimeFormatInfo!==r.dateFormatInfo&&o.push("dateTimeFormatInfo"),t.numberFormatInfo!==r.numberFormatInfo&&o.push("numberFormatInfo"),t.timeZoneUtcOffsetMinutes!==r.timeZoneUtcOffsetMinutes&&o.push("userTimeZoneUtcOffsetMinutes"),e=r,t={timeZoneUtcOffsetMinutes:r.timeZoneUtcOffsetMinutes,dateTimeFormatInfo:{AMDesignator:r.dateFormatInfo.AMDesignator,AbbreviatedDayNames:r.dateFormatInfo.AbbreviatedDayNames,AbbreviatedMonthGenitiveNames:r.dateFormatInfo.AbbreviatedMonthGenitiveNames,AbbreviatedMonthNames:r.dateFormatInfo.AbbreviatedMonthNames,CalendarWeekRule:r.dateFormatInfo.CalendarWeekRule,Calendar:r.dateFormatInfo.Calendar,DateSeparator:r.dateFormatInfo.DateSeparator,DayNames:r.dateFormatInfo.DayNames,Eras:r.dateFormatInfo.eras,FirstDayOfWeek:r.dateFormatInfo.FirstDayOfWeek,FullDateTimePattern:r.dateFormatInfo.FullDateTimePattern,LongDatePattern:r.dateFormatInfo.LongDatePattern,LongTimePattern:r.dateFormatInfo.LongTimePattern,MonthDayPattern:r.dateFormatInfo.MonthDayPattern,MonthGenitiveNames:r.dateFormatInfo.MonthGenitiveNames,MonthNames:r.dateFormatInfo.MonthNames,PMDesignator:r.dateFormatInfo.PMDesignator,ShortDatePattern:r.dateFormatInfo.ShortDatePattern,ShortTimePattern:r.dateFormatInfo.ShortTimePattern,ShortestDayNames:r.dateFormatInfo.ShortestDayNames,SortableDateTimePattern:r.dateFormatInfo.SortableDateTimePattern,TimeSeparator:r.dateFormatInfo.TimeSeparator,UniversalSortableDateTimePattern:r.dateFormatInfo.UniversalSortableDateTimePattern,YearMonthPattern:r.dateFormatInfo.YearMonthPattern,amDesignator:r.dateFormatInfo.AMDesignator,abbreviatedDayNames:r.dateFormatInfo.AbbreviatedDayNames,abbreviatedMonthGenitiveNames:r.dateFormatInfo.AbbreviatedMonthGenitiveNames,abbreviatedMonthNames:r.dateFormatInfo.AbbreviatedMonthNames,calendarWeekRule:r.dateFormatInfo.CalendarWeekRule,calendar:r.dateFormatInfo.Calendar,dateSeparator:r.dateFormatInfo.DateSeparator,dayNames:r.dateFormatInfo.DayNames,eras:r.dateFormatInfo.eras,firstDayOfWeek:r.dateFormatInfo.FirstDayOfWeek,fullDateTimePattern:r.dateFormatInfo.FullDateTimePattern,longDatePattern:r.dateFormatInfo.LongDatePattern,longTimePattern:r.dateFormatInfo.LongTimePattern,monthDayPattern:r.dateFormatInfo.MonthDayPattern,monthGenitiveNames:r.dateFormatInfo.MonthGenitiveNames,monthNames:r.dateFormatInfo.MonthNames,pmDesignator:r.dateFormatInfo.PMDesignator,shortDatePattern:r.dateFormatInfo.ShortDatePattern,shortTimePattern:r.dateFormatInfo.ShortTimePattern,shortestDayNames:r.dateFormatInfo.ShortestDayNames,sortableDateTimePattern:r.dateFormatInfo.SortableDateTimePattern,timeSeparator:r.dateFormatInfo.TimeSeparator,universalSortableDateTimePattern:r.dateFormatInfo.UniversalSortableDateTimePattern,yearMonthPattern:r.dateFormatInfo.YearMonthPattern},numberFormatInfo:{CurrencyDecimalDigits:r.numberFormatInfo.CurrencyDecimalDigits,CurrencyDecimalSeparator:r.numberFormatInfo.CurrencyDecimalSeparator,CurrencyGroupSeparator:r.numberFormatInfo.CurrencyGroupSeparator,CurrencyGroupSizes:r.numberFormatInfo.CurrencyGroupSizes,CurrencyNegativePattern:r.numberFormatInfo.CurrencyNegativePattern,CurrencyPositivePattern:r.numberFormatInfo.CurrencyPositivePattern,CurrencySymbol:r.numberFormatInfo.CurrencySymbol,NANSymbol:r.numberFormatInfo.NANSymbol,NativeDigits:r.numberFormatInfo.NativeDigits,NegativeInfinitySymbol:r.numberFormatInfo.NegativeInfinitySymbol,NegativeSign:r.numberFormatInfo.NegativeSign,NumberDecimalDigits:r.numberFormatInfo.NumberDecimalDigits,NumberDecimalSeparator:r.numberFormatInfo.NumberDecimalSeparator,NumberGroupSeparator:r.numberFormatInfo.NumberGroupSeparator,NumberGroupSizes:r.numberFormatInfo.NumberGroupSizes,NumberNegativePattern:r.numberFormatInfo.NumberNegativePattern,PerMilleSymbol:r.numberFormatInfo.PerMilleSymbol,PercentDecimalDigits:r.numberFormatInfo.PercentDecimalDigits,PercentDecimalSeparator:r.numberFormatInfo.PercentDecimalSeparator,PercentGroupSeparator:r.numberFormatInfo.PercentGroupSeparator,PercentGroupSizes:r.numberFormatInfo.PercentGroupSizes,PercentNegativePattern:r.numberFormatInfo.PercentNegativePattern,PercentPositivePattern:r.numberFormatInfo.PercentPositivePattern,PercentSymbol:r.numberFormatInfo.PercentSymbol,PositiveInfinitySymbol:r.numberFormatInfo.PositiveInfinitySymbol,PositiveSign:r.numberFormatInfo.PositiveSign,currencyDecimalDigits:r.numberFormatInfo.CurrencyDecimalDigits,currencyDecimalSeparator:r.numberFormatInfo.CurrencyDecimalSeparator,currencyGroupSeparator:r.numberFormatInfo.CurrencyGroupSeparator,currencyGroupSizes:r.numberFormatInfo.CurrencyGroupSizes,currencyNegativePattern:r.numberFormatInfo.CurrencyNegativePattern,currencyPositivePattern:r.numberFormatInfo.CurrencyPositivePattern,currencySymbol:r.numberFormatInfo.CurrencySymbol,nanSymbol:r.numberFormatInfo.NANSymbol,nativeDigits:r.numberFormatInfo.NativeDigits,negativeInfinitySymbol:r.numberFormatInfo.NegativeInfinitySymbol,negativeSign:r.numberFormatInfo.NegativeSign,numberDecimalDigits:r.numberFormatInfo.NumberDecimalDigits,numberDecimalSeparator:r.numberFormatInfo.NumberDecimalSeparator,numberGroupSeparator:r.numberFormatInfo.NumberGroupSeparator,numberGroupSizes:r.numberFormatInfo.NumberGroupSizes,numberNegativePattern:r.numberFormatInfo.NumberNegativePattern,perMilleSymbol:r.numberFormatInfo.PerMilleSymbol,percentDecimalDigits:r.numberFormatInfo.PercentDecimalDigits,percentDecimalSeparator:r.numberFormatInfo.PercentDecimalSeparator,percentGroupSeparator:r.numberFormatInfo.PercentGroupSeparator,percentGroupSizes:r.numberFormatInfo.PercentGroupSizes,percentNegativePattern:r.numberFormatInfo.PercentNegativePattern,percentPositivePattern:r.numberFormatInfo.PercentPositivePattern,percentSymbol:r.numberFormatInfo.PercentSymbol,positiveInfinitySymbol:r.numberFormatInfo.PositiveInfinitySymbol,positiveSign:r.numberFormatInfo.PositiveSign},timeZoneAdjusters:r.timeZoneAdjusters,formatInfoCultureName:r.formatInfoCultureName,workDayStartTime:r.workDayStartTime,formatter:{ParseDateFromString:i.a,formatIntegerValue:i.l,formatCurrencyValue:i.e,formatShortDateValue:i.r,formatLongDateValue:i.n,formatSortableDateValue:i.t,formatSortableDateTimeValue:i.s,formatShortDateTimeValue:i.q,formatDateLongAbbreviated:i.g,formatDateYearMonthValue:i.h,formatDecimalValue:i.j,formatLanguageValue:i.m,parseFormatted:i.E,formatUserDateTimeToUTC:(e,t)=>i.x(e,r,null!=t?t:E.a.UserLocal),formatUTCDateTimeToUserDate:(e,t)=>i.w(e,r,null!=t?t:E.a.UserLocal),formatUserInput:(e,t)=>{const r=i.A(n,t),a=Object(g.e)(n,I.g);return i.y(e,r,a)},parseDateFromInput:(e,t)=>{const r=i.A(n,t);return i.a(e,r.controlAttributes.Format,r.cultureInfo,r)}},languagesByCode:a}),_.a.info(w+": createRetrieveFormattingSettingsInfo finished"),{response:t,updatedProperties:o}}}function P(){let e={},t={},n={},a={};return i=>{_.a.info(w+": createRetrieveClientSettingsInfo started");const o=[],c=Object(s.x)(i),l=Object(d.D)(i),u=Object(d.E)(i),p=Object(b.a)(i)===y.a.MobileApplication;if(l!==e){o.push("orgSettings"),e=l;const t={isRTL:!1,fiscalYearStartDate:l.fiscalYearStartDate,fiscalPeriodFormat:l.fiscalPeriodFormat,fiscalPeriodType:l.fiscalPeriodType,fiscalYearFormatYear:l.fiscalYearFormatYear,fiscalYearFormatPrefix:l.fiscalYearFormatPrefix,fiscalYearFormatSuffix:l.fiscalYearFormatSuffix,fiscalYearDisplayCode:l.fiscalYearDisplayCode,fiscalPeriodConnector:l.fiscalPeriodConnector,showWeekNumber:l.showWeekNumber,boundDashboardDefaultCardExpanded:l.boundDashboardDefaultCardExpanded,organizationId:r.a.externalGuid(u.organizationId),isActionCardEnabled:l.isActionCardEnabled,isEmailMonitoringAllowed:l.isEmailMonitoringAllowed,allowUnresolvedPartiesOnEmailSend:null,webResourceHash:l.webResourceHash,enableBingMapsIntegration:l.enableBingMapsIntegration,bingMapsApiKey:l.bingMapsApiKey,availableBingMapLocales:l.availableBingMapLocales,excludedCountriesForMaps:l.excludedCountriesForMaps,bFDatacenter:l.bFDatacenter,securitySettingForEmail:l.securitySettingForEmail,appointmentRichEditorExperience:l.appointmentRichEditorExperience,gridTotalRecordCountLimit:l.gridTotalRecordCountLimit,lookupCharacterCountBeforeResolve:l.lookupCharacterCountBeforeResolve,lookupResolveDelayMS:l.lookupResolveDelayMS,advancedLookupEnabled:l.advancedLookupEnabled,isCollaborationExperienceEnabled:l.isCollaborationExperienceEnabled,pcfDatasetGridEnabled:l.pcfDatasetGridEnabled,allowUsersHidingSystemViews:l.allowUsersHidingSystemViews};n=Object.assign(Object.assign({},n),{orgSettingsData:t}),a={allowUnresolvedPartiesOnEmailSend:l.allowUnresolvedPartiesOnEmailSend}}return c===t&&p===n.disableScroll||(t.languageId!==c.languageId&&o.push("languageCode"),t.formatInfoCultureName!==c.formatInfoCultureName&&o.push("locale"),t.isRTL!==c.isRTL&&o.push("isRTL"),n.disableScroll!==p&&o.push("disableScroll"),t=c,n=Object.assign(Object.assign({},n),{languageCode:c.languageId,isRTL:c.isRTL,showWeekNumber:c.showWeekNumber,locale:c.formatInfoCultureName,userAgent:v.a.getInstance().get_CustomControlUserAgent(),usePathBasedUrls:c.usePathBasedUrls,organizationUniqueName:l.organizationUniqueName,disableScroll:p})),_.a.info(w+": createRetrieveClientSettingsInfo finished"),{updatedProperties:o,response:n,ancillaryData:a}}}function T(e,t,n){switch(n){case"email":case"appointment":case"recurringappointmentmaster":return void 0===t||t;default:return!1}}function N(e){let t={},n={};const r=function(e){return t=>{const n=Object(l.h)(e(),t);return n?n.EntityColor:null}}(e);return e=>{_.a.info(w+": createRetrieveThemingData started");const a=Object(f.a)(e),i=Object(O.b)(e),o=[];let s=!1;return a===n&&i===t.shouldUseDesignSystem||(n=a,s=!0,t=Object.assign(Object.assign({},t),{getEntityColor:r,shouldUseDesignSystem:i,defaultThemingData:{defaultthemingcolor:a.colors.MainThemeColor.MainColor1.Fill,mainthemecolor:a.colors.MainThemeColor.MainColor1.Fill,accentthemecolor:a.colors.AccentThemeColor.Accent1.Fill,navbarshelfcolor:a.colors.SiteMap.NavigationShelf,headercolor:a.colors.HeaderText,globallinkcolor:a.colors.Link.Normal.Text,selectedlinkeffect:a.colors.FocusHighlight,selectedlinkeffectcolor:a.colors.FocusHighlight,hoverlinkeffectcolor:a.colors.Link.Hover.Text,processcontrolcolor:a.colors.ProcessControl,defaultentitycolor:a.colors.MainThemeColor.MainColor1.Fill,defaultcustomentitycolor:a.colors.MainThemeColor.MainColor1.Fill,controlshadecolor:a.colors.MainThemeColor.MainColor1.Fill,controlbordercolor:a.colors.MainThemeColor.MainColor1.Fill,textboxfonticonsize:a.fontSizes.TextBox.FontIcon,textboxfontweight:a.fontSizes.TextBox.FontWeight,textboxcontentfontweight:a.fontSizes.TextBox.ContentFontWeight,textboxfontsize:a.fontSizes.TextBox.Font,textboxerrorfontsize:a.fontSizes.TextBox.ErrorFont,textboxspacing:a.sizes.TextBox.Spacing,textboxnotificationiconcontainerheight:a.sizes.TextBox.NotificationIconContainerHeight,textboxcontainerspacing:a.sizes.TextBox.ContainerSpacing,textboxrightmargin:a.sizes.TextBox.RightMargin,textboxlineheight:a.sizes.TextBox.LineHeight,textboxlinethickness:a.sizes.TextBox.LineThickness,textboxhorizontalpadding:a.sizes.TextBox.HorizontalPadding,textboxverticalpadding:a.sizes.TextBox.VerticalPadding,lookuptagpadding:a.sizes.LookupControl.TagPadding,lookuptagmargin:a.sizes.LookupControl.TagMargin,textboxmaxlength:a.sizes.TextBox.MaxLength,normalfontfamily:a.fontFamilies.Normal,normalfontcolor:a.colors.NormalText,normalfontsize:a.fontSizes.Normal,solidborderstyle:a.display.SolidBorderStyle,noneborderstyle:a.display.NoneBorderStyle,colors:{whitebackground:a.colors.BaseColor.White,defaulttheming:a.colors.MainThemeColor.MainColor1.Fill,navbarshelf:a.colors.SiteMap.NavigationShelf,header:a.colors.HeaderText,globallink:a.colors.Link.Normal.Text,selectedlinkeffect:a.colors.FocusHighlight,selectedlinkeffectcolor:a.colors.FocusHighlight,hoverlinkeffect:a.colors.Link.Hover.Text,processcontrol:a.colors.ProcessControl,defaultentity:a.colors.Entity.Fill,defaultcustomentity:a.colors.CustomEntity.Fill,controlshade:a.colors.Control.Fill,controlborder:a.colors.Control.Stroke,control:{text:a.colors.Control.Text,fill:a.colors.Control.Fill,stroke:a.colors.Control.Stroke},navbar:{navbar1:{text:a.colors.NavBar.NavBar1.Text,fill:a.colors.NavBar.NavBar1.Fill},navbar2:{text:a.colors.NavBar.NavBar2.Text,fill:a.colors.NavBar.NavBar2.Fill},navbar3:{text:a.colors.NavBar.NavBar3.Text,fill:a.colors.NavBar.NavBar3.Fill}},pageheader:{text:a.colors.PageHeader.Text,fill:a.colors.PageHeader.Fill},pagepanel:{text:a.colors.PagePanel.Text,fill:a.colors.PagePanel.Text},defaultsurface:{text:a.colors.DefaultSurface.Text,fill:a.colors.DefaultSurface.Fill},customentity:{text:a.colors.CustomEntity.Text,fill:a.colors.CustomEntity.Fill},entity:{text:a.colors.Entity.Text,fill:a.colors.Entity.Fill},title:{text:a.colors.Title.Text,fill:a.colors.Title.Fill},status:{neutral:a.colors.Status.Positive1.Text,error:a.colors.Status.Priority3.Text,warning:a.colors.Status.Priority2.Text,success:a.colors.Status.Positive2.Text,info:a.colors.Status.Positive1.Text},statuscolor:{alert1:{text:a.colors.Status.Alert1.Text,fill:a.colors.Status.Alert1.Fill},alert2:{text:a.colors.Status.Alert2.Text,fill:a.colors.Status.Alert2.Fill},priority1:{text:a.colors.Status.Priority1.Text,fill:a.colors.Status.Priority1.Fill},priority2:{text:a.colors.Status.Priority2.Text,fill:a.colors.Status.Priority2.Fill},priority3:{text:a.colors.Status.Priority3.Text,fill:a.colors.Status.Priority3.Fill},positive1:{text:a.colors.Status.Positive1.Text,fill:a.colors.Status.Positive1.Fill},positive2:{text:a.colors.Status.Positive2.Text,fill:a.colors.Status.Positive2.Fill},info1:{text:a.colors.Status.Info1.Text,fill:a.colors.Status.Info1.Fill},neutral1:{text:a.colors.Status.Neutral1.Text,fill:a.colors.Status.Neutral1.Fill}},accent:{accent1:{text:a.colors.AccentThemeColor.Accent1.Text,fill:a.colors.AccentThemeColor.Accent1.Fill},accent2:{text:a.colors.AccentThemeColor.Accent2.Text,fill:a.colors.AccentThemeColor.Accent2.Fill},accent3:{text:a.colors.AccentThemeColor.Accent3.Text,fill:a.colors.AccentThemeColor.Accent3.Fill}},maintheme:{maincolor1:{fill:a.colors.MainThemeColor.MainColor1.Fill,text:a.colors.MainThemeColor.MainColor1.Text},maincolor2:{fill:a.colors.MainThemeColor.MainColor2.Fill,text:a.colors.MainThemeColor.MainColor2.Text},maincolor3:{fill:a.colors.MainThemeColor.MainColor3.Fill,text:a.colors.MainThemeColor.MainColor3.Text}},base:{white:a.colors.BaseColor.White,black:a.colors.BaseColor.Black,red:a.colors.BaseColor.Red.Red1,orange:a.colors.BaseColor.Orange.Orange1,yellow:a.colors.BaseColor.Yellow.Yellow1,green:a.colors.BaseColor.Green.Green1,blue:a.colors.BaseColor.Blue.Blue1,teal:a.colors.BaseColor.Violet.Voilet1,purple:a.colors.BaseColor.Purple.Purple1},basecolor:{red:{red1:a.colors.BaseColor.Red.Red1,red2:a.colors.BaseColor.Red.Red2,red3:a.colors.BaseColor.Red.Red3,red4:a.colors.BaseColor.Red.Red4,red5:a.colors.BaseColor.Red.Red5},orange:{orange1:a.colors.BaseColor.Orange.Orange1,orange2:a.colors.BaseColor.Orange.Orange2,orange3:a.colors.BaseColor.Orange.Orange3,orange4:a.colors.BaseColor.Orange.Orange4,orange5:a.colors.BaseColor.Orange.Orange5},blue:{blue1:a.colors.BaseColor.Blue.Blue1,blue2:a.colors.BaseColor.Blue.Blue2,blue3:a.colors.BaseColor.Blue.Blue3,blue4:a.colors.BaseColor.Blue.Blue4,blue5:a.colors.BaseColor.Blue.Blue5},green:{green1:a.colors.BaseColor.Green.Green1,green2:a.colors.BaseColor.Green.Green2,green3:a.colors.BaseColor.Green.Green3,green4:a.colors.BaseColor.Green.Green4,green5:a.colors.BaseColor.Green.Green5},teal:{teal1:a.colors.BaseColor.Teal.Teal1,teal2:a.colors.BaseColor.Teal.Teal2,teal3:a.colors.BaseColor.Teal.Teal3,teal4:a.colors.BaseColor.Teal.Teal4,teal5:a.colors.BaseColor.Teal.Teal5},yellow:{yellow1:a.colors.BaseColor.Yellow.Yellow1,yellow2:a.colors.BaseColor.Yellow.Yellow2,yellow3:a.colors.BaseColor.Yellow.Yellow3,yellow4:a.colors.BaseColor.Yellow.Yellow4,yellow5:a.colors.BaseColor.Yellow.Yellow5},clay:{clay1:a.colors.BaseColor.Clay.Clay1,clay2:a.colors.BaseColor.Clay.Clay2,clay3:a.colors.BaseColor.Clay.Clay3,clay4:a.colors.BaseColor.Clay.Clay4,clay5:a.colors.BaseColor.Clay.Clay5},pink:{pink1:a.colors.BaseColor.Pink.Pink1,pink2:a.colors.BaseColor.Pink.Pink2,pink3:a.colors.BaseColor.Pink.Pink3,pink4:a.colors.BaseColor.Pink.Pink4,pink5:a.colors.BaseColor.Pink.Pink5},violet:{violet1:a.colors.BaseColor.Violet.Violet1,violet2:a.colors.BaseColor.Violet.Violet2,violet3:a.colors.BaseColor.Violet.Violet3,violet4:a.colors.BaseColor.Violet.Violet4,violet5:a.colors.BaseColor.Violet.Violet5},purple:{purple1:a.colors.BaseColor.Purple.Purple1,purple2:a.colors.BaseColor.Purple.Purple2,purple3:a.colors.BaseColor.Purple.Purple3,purple4:a.colors.BaseColor.Purple.Purple4,purple5:a.colors.BaseColor.Purple.Purple5},grey:{grey1:a.colors.BaseColor.Grey.Grey1,grey2:a.colors.BaseColor.Grey.Grey2,grey3:a.colors.BaseColor.Grey.Grey3,grey4:a.colors.BaseColor.Grey.Grey4,grey5:a.colors.BaseColor.Grey.Grey5,grey6:a.colors.BaseColor.Grey.Grey6,grey7:a.colors.BaseColor.Grey.Grey7},white:a.colors.BaseColor.White,black:a.colors.BaseColor.Black,transparent:a.colors.BaseColor.Transparent},links:{default:a.colors.Link.Normal.Text,visited:a.colors.Link.Visited.Text,disabled:a.colors.Link.Disabled.Text},linkcolor:{normal:{text:a.colors.Link.Normal.Text,fill:a.colors.Link.Normal.Fill},hover:{text:a.colors.Link.Hover.Text,fill:a.colors.Link.Hover.Fill},visited:{text:a.colors.Link.Visited.Text,fill:a.colors.Link.Visited.Fill},pressed:{text:a.colors.Link.Pressed.Text,fill:a.colors.Link.Pressed.Fill},disabled:{text:a.colors.Link.Disabled.Text,fill:a.colors.Link.Disabled.Text}},grays:{gray01:a.colors.BaseColor.Grey.Grey1,gray02:a.colors.BaseColor.Grey.Grey2,gray03:a.colors.BaseColor.Grey.Grey3,gray04:a.colors.BaseColor.Grey.Grey4,gray05:a.colors.BaseColor.Grey.Grey5,gray06:a.colors.BaseColor.Grey.Grey6,gray07:a.colors.BaseColor.Grey.Grey7,gray08:a.colors.BaseColor.Grey.Grey8,gray09:void 0},statustheme:void 0,baseColor:void 0,linkstheme:void 0},textbox:{fonticonsize:a.fontSizes.TextBox.FontIcon,fontweight:a.fontSizes.TextBox.FontWeight,contentfontweight:a.fontSizes.TextBox.ContentFontWeight,fontsize:a.fontSizes.TextBox.Font,errorfontsize:a.fontSizes.TextBox.ErrorFont,spacing:a.sizes.TextBox.Spacing,notificationiconcontainerheight:a.sizes.TextBox.NotificationIconContainerHeight,containerspacing:a.sizes.TextBox.ContainerSpacing,rightmargin:a.sizes.TextBox.RightMargin,lineheight:a.sizes.TextBox.LineHeight,linethickness:a.sizes.TextBox.LineThickness,errorlinethickness:a.sizes.TextBox.ErrorLineThickness,horizontalpadding:a.sizes.TextBox.HorizontalPadding,verticalpadding:a.sizes.TextBox.VerticalPadding,maxlength:a.sizes.TextBox.MaxLength,labelcolor:a.colors.TextBox.Label,contentcolor:a.colors.TextBox.Content,linecolor:a.colors.TextBox.Line,hoverboxcolor:a.colors.TextBox.HoverBox,backgroundcolor:a.colors.TextBox.Background,errorbackgroundcolor:a.colors.TextBox.ErrorBackground,redcolor:a.colors.TextBox.Red,bluecolor:a.colors.TextBox.Blue,restmodecolor:a.colors.TextBox.RestMode,cellheightinrem:a.sizes.Section.cellHeightInRem},spacings:{xshorizontal:a.spacings.HorizXs,shorizontal:a.spacings.HorizS,bhorizontal:a.spacings.HorizB,mhorizontal:a.spacings.HorizM,lhorizontal:a.spacings.HorizL,xlhorizontal:a.spacings.HorizXl,xxlhorizontal:a.spacings.HorizXxl,xsvertical:a.spacings.VertXs,svertical:a.spacings.VertS,bvertical:a.spacings.VertB,mvertical:a.spacings.VertM,lvertical:a.spacings.VertL,xlvertical:a.spacings.VertXl,xxlvertical:a.spacings.VertXxl},fontfamilies:{semilight:a.fontFamilies.Semilight,semibold:a.fontFamilies.Semibold,regular:a.fontFamilies.Regular,bold:a.fontFamilies.Bold},fontsizes:{xsfontsize:a.fontSizes.FontXS,sfontsize:a.fontSizes.FontS,bfontsize:a.fontSizes.FontB,mfontsize:a.fontSizes.FontM,lfontsize:a.fontSizes.FontL,xlfontsize:a.fontSizes.FontXL,font225:a.fontSizes.Font225,font200:a.fontSizes.Font200,font175:a.fontSizes.Font175,font150:a.fontSizes.Font150,font125:a.fontSizes.Font125,font115:a.fontSizes.Font115,font100:a.fontSizes.Font100,font085:a.fontSizes.Font085,font075:a.fontSizes.Font075,font1143:a.fontSizes.Font1143,font10px:a.fontSizes.Font10px,font12px:a.fontSizes.Font12px,font14px:a.fontSizes.Font14px,font16px:a.fontSizes.Font16px,font18px:a.fontSizes.Font18px,font20px:a.fontSizes.Font20px,font21px:a.fontSizes.Font21px,font24px:a.fontSizes.Font24px,font28px:a.fontSizes.Font28px,font32px:a.fontSizes.Font32px},breakpoints:{dimensionxs:a.sizes.Breakpoints.DimensionXS,dimensions:a.sizes.Breakpoints.DimensionS,dimensionm:a.sizes.Breakpoints.DimensionM,dimensionl:a.sizes.Breakpoints.DimensionL,dimensionxl:a.sizes.Breakpoints.DimensionXL},measures:{measure015:a.sizes.Measures.Measure015,measure025:a.sizes.Measures.Measure025,measure050:a.sizes.Measures.Measure050,measure075:a.sizes.Measures.Measure075,measure100:a.sizes.Measures.Measure100,measure125:a.sizes.Measures.Measure125,measure150:a.sizes.Measures.Measure150,measure175:a.sizes.Measures.Measure175,measure200:a.sizes.Measures.Measure200,measure225:a.sizes.Measures.Measure225,measure250:a.sizes.Measures.Measure250,measure275:a.sizes.Measures.Measure275,measure300:a.sizes.Measures.Measure300,measure325:a.sizes.Measures.Measure325,measure350:a.sizes.Measures.Measure350,measure400:a.sizes.Measures.Measure400,measure450:a.sizes.Measures.Measure450,measure500:a.sizes.Measures.Measure500,measure550:a.sizes.Measures.Measure550,measure600:a.sizes.Measures.Measure600,measure700:a.sizes.Measures.Measure700,measure750:a.sizes.Measures.Measure750,measure775:a.sizes.Measures.Measure775,measure900:a.sizes.Measures.Measure900,measure1075:a.sizes.Measures.Measure1075,measure1143:a.sizes.Measures.Measure1143,measure2875:a.sizes.Measures.Measure2875},lookup:{tagpadding:a.sizes.LookupControl.TagPadding,tagmargin:a.sizes.LookupControl.TagMargin,tagbackgroundcolor:a.colors.LookupTagBackground},borders:{border01:a.borders.Border01,border02:a.borders.Border02,border03:a.borders.Border03,border04:a.borders.Border04,border05:a.borders.Border05},shadows:{shadow01:a.shadows.Shadow01},buttons:{button01primary:a.buttons.Button01Primary,button01secondary:a.buttons.Button01Secondary,buttonprimarytext:a.buttons.ButtonPrimaryText,buttonsecondarytext:a.buttons.ButtonSecondaryText,actioniconbutton01:a.buttons.ActionIconButton01,button02primary:a.buttons.Button02Primary,button02secondary:a.buttons.Button02Secondary},links:{TouchTarget:a.links.TouchTarget,Reset:a.links.Reset,Focus:a.links.Focus,Hover:a.links.Hover,Pressed:a.links.Pressed,Visited:a.links.Visited}}})),s&&o.push("theming"),_.a.info(w+": createRetrieveThemingData finished"),{response:t,updatedProperties:o}}}function A(e){return{encoder:{CrmUrlEncode:C.CrmUrlEncode,CrmHtmlEncode:C.CrmHtmlEncode},dateTimeUtils:{getConstraintByYear:o.r,getLocalAdjustmentFromDate:o.y,getDSTAdjustment:o.s,getDSTAdjustmentMinutes:o.t,convertStringToDate:o.o,convertDateTimeFromUtcToUserDisplay:o.m,convertDateTimeFromUserDisplayToUTC:o.l,convertDateTimeFromUserDisplayToTimezoneIndependent:o.k,convertTimeToBehaviorDisplay:o.q,getWeekOfYear:o.L,getWeekOfYearFullDays:o.M,convertTimeFromBehaviorDisplay:o.p,getDatePart:o.u},hasEntityPrivilege:(t,n,r)=>Object(u.g)(e(),t,n,r)}}function R(){const e=function(){let e={strings:{},stringsLoaded:!0};const t={};return(n,r)=>{const i=r?r.ConstructorName+"."+w:w;_.a.info(i+": createRetrieveResourcesData started");const o=r?m.a.getControlsResourceKeyList(r.CustomControlId):null,s=Object(g.d)(n);if(s&&o){let t=!1;const n={};for(const r of o)s[r]&&null!==s[r]&&(n[r]=s[r],e.strings[r]&&e.strings[r]===n[r]||(t=!0));if(t){const t=Object.assign(Object.assign({},e.strings),n);e={strings:t,stringsLoaded:!0}}}const c=Object(h.k)(n);if(!c)return e;if(r)for(const n of r.Properties.Resources)if(5===n.Type){const r=c[n.Name];if(!r||r&&!r.contentJson&&r.state!==a.a.Error){e=Object.assign(Object.assign({},e),{stringsLoaded:!1});break}if(r.contentJson!==t[n.Name]){t[n.Name]=r.contentJson;const a=Object.assign(Object.assign({},e.strings),r.contentJson);e={strings:a,stringsLoaded:!0}}}return _.a.info(i+"."+w+": createRetrieveResourcesData finished"),e}}(),t=function(){let e={};return(t,n)=>{_.a.info(w+": createRetrievePageInfo started");const r=function(e,t){return{appId:e.metadata.appContext&&e.metadata.appContext.app?e.metadata.appContext.app.appId:null,isPageReadOnly:t}}(t,n),a=[],i=r.isPageReadOnly!==e.isPageReadOnly,o=r.appId!==e.appId;return(i||o)&&(o&&a.push("appId"),i&&a.push("isPageReadOnly"),e=r),_.a.info(w+": createRetrievePageInfo finished"),{response:e,updatedProperties:a}}}();let n={},i={},o={},s={},u="",d={};return(a,f,g,h,m)=>{let b=[];const y=m.getCommonPropertyBagData(a),_=y.ancillaryData;if(y.response!==s&&(d={},b=b.concat(y.updatedProperties),o=Object.assign(Object.assign({},o),y.response),s=y.response),_!==d||u!==g.entityTypeName){const e=Object.assign(Object.assign({},o.clientData),{orgSettingsData:Object.assign(Object.assign({},o.clientData.orgSettingsData),{allowUnresolvedPartiesOnEmailSend:T(0,_.allowUnresolvedPartiesOnEmailSend,g.entityTypeName)})});o=Object.assign(Object.assign({},o),{clientData:e}),d=_,u=g.entityTypeName}const v=t(a,h);v.response!==i&&(b=b.concat(v.updatedProperties),o=Object.assign(Object.assign({},o),{pageData:v.response}),i=v.response);const O=e(a,f);O!==n&&(o=Object.assign(Object.assign({},o),{resourcesData:O}),n=O);const C="quickcreate"===g.pageType?r.a.EMPTY.guid:g&&g.id&&g.id.guid,E=g.entityTypeName,I=!Object(p.c)(a),w=Object(S.e)(a),j=C!==(o.modeData?o.modeData.entityId:null),P=E!==(o.modeData?o.modeData.entityTypeName:null),N=I!==(o.modeData?o.modeData.isOffline:null);if(j||P||N){let e=null;const t=Object(c.i)(a,E),n=Object(l.h)(a,E);if(t&&n&&C){const r=t[C],a=n.PrimaryNameAttribute;r&&a&&r.fields&&r.fields[a]&&null!=r.fields[a].value&&(e=r.fields[a].value)}j&&b.push("entityId"),P&&b.push("entityName"),N&&b.push("isOffline"),o=Object.assign(Object.assign({},o),{modeData:{entityTypeName:E,entityId:C,entityRecordName:e,isOffline:I,isAuthoringMode:w}})}return{response:o,updatedProperties:b}}}},qAG9:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e,t){if(!e)return null;let n=e.get(t);return n||(n=e.get(t.toLowerCase())),n}n.d(t,"a",(function(){return r}))},qCX6:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("umme"),a=n("504W"),i=n("EW4s");class o{get_isOfflineDataSourceInitialized(){return!0}get_applicationStatusProvider(){throw Error.invalidOperation("OfflineDataSourceForOfflineModeNotEnabled.get_ApplicationStatusProvider is not supported")}get_offlineTypescriptInterface(){throw Error.invalidOperation("OfflineDataSourceForOfflineModeNotEnabled.get_OfflineTypescriptInterface is not supported")}set_offlineTypescriptInterface(e){throw Error.invalidOperation("OfflineDataSourceForOfflineModeNotEnabled.set_OfflineTypescriptInterface is not supported")}initialize(e){const t=new i.a;return t.resolve(!0),t}calculateDisabledOfflineEntities(){throw Error.invalidOperation("OfflineDataSourceForOfflineModeNotEnabled.CalculateDisabledOfflineEntities is not supported")}refreshLookupData(e,t,n,r){throw Error.invalidOperation("OfflineDataSourceForOfflineModeNotEnabled.RefreshLookupData is not supported")}refreshRetrieveMultipleLookupData(e,t,n){throw Error.invalidOperation("OfflineDataSourceForOfflineModeNotEnabled.RefreshRetrieveMultipleLookupData is not supported")}getExistingActivityParties(e){throw Error.invalidOperation("OfflineDataSourceForOfflineModeNotEnabled.GetExistingActivityParties is not supported")}startPlayback(e){throw Error.invalidOperation("OfflineDataSourceForOfflineModeNotEnabled.StartPlayback is not supported")}hasItemsToUpsync(){throw Error.invalidOperation("OfflineDataSourceForOfflineModeNotEnabled.HasItemsToUpsync is not supported")}hasOfflineChanges(e,t){throw Error.invalidOperation("OfflineDataSourceForOfflineModeNotEnabled.hasOfflineChanges is not supported")}get_localDataSource(){throw Error.invalidOperation("OfflineDataSourceForOfflineModeNotEnabled.get_LocalDataSource is not supported")}isEntityAvailableForOfflineUsage(e){return!1}isOfflineAvailableForUse(){return!1}isOfflineFeatureEnabledForOrganization(){return!1}isAppAvailableOffline(){return!1}isOfflineOptedIn(){return!1}isDssOfflineEnabled(){return!1}get_syncErrorCount(){throw Error.invalidOperation("OfflineDataSourceForOfflineModeNotEnabled.get_SyncErrorCount is not supported")}set_syncErrorCount(e){throw Error.invalidOperation("OfflineDataSourceForOfflineModeNotEnabled.set_SyncErrorCount is not supported")}applyApplicationMetadataChanges(){const e=new i.a;return e.resolve(!0),e}createActivityPointerAndAttachmentView(){}}let s=null;class c{constructor(){this._OfflineDataSource=null}get_offlineDataSource(){return this._OfflineDataSource}set_offlineDataSource(e){return this._OfflineDataSource=e,e}isOfflineDataSourceInitialized(){return!!this.get_offlineDataSource()&&this.get_offlineDataSource().get_isOfflineDataSourceInitialized()}initializeOfflineDataSource(e){return this.get_offlineDataSource()?this.get_offlineDataSource().initialize(e):(new i.a).reject(r.a.FromMessage("Cannot Initialize Offline data source as the object is not available"))}calculateDisabledOfflineEntities(){return this.get_offlineDataSource()?this.get_offlineDataSource().calculateDisabledOfflineEntities():(new i.a).reject(r.a.FromMessage("Cannot calculate disabled offline entities as the OfflineDataSource object is not available"))}applyApplicationMetadataChanges(){return this.get_offlineDataSource().applyApplicationMetadataChanges()}createActivityPointerAndAttachmentView(){this._OfflineDataSource.createActivityPointerAndAttachmentView()}startPlayback(e){return this.get_offlineDataSource().startPlayback(e)}hasItemsToUpsync(){return this.get_offlineDataSource().hasItemsToUpsync()}hasOfflineChanges(e,t){return this.get_offlineDataSource().hasOfflineChanges(e,t)}cleanUpDatabases(e){return this.get_offlineDataSource().get_localDataSource().get_offlineDataStore().cleanUpDatabases(e)}schedulePeriodicSyncJob(e,t){return this.get_offlineDataSource().get_localDataSource().get_offlineDataStore().schedulePeriodicSyncJob(e,t)}cancelSync(e){return this.get_offlineDataSource().get_localDataSource().get_offlineDataStore().cancelSync(e)}set_offlineTypescriptInterface(e){this.get_offlineDataSource().set_offlineTypescriptInterface(e)}get_syncErrorCount(){return this.get_offlineDataSource().get_syncErrorCount()}verifyIfLinkedEntitiesOfflineEnabled(e){const t=(new DOMParser).parseFromString(e,"text/xml");if(t.getElementsByTagName("link-entity").length>0){const e=t.getElementsByTagName("link-entity");for(let n=0;n<e.length;n++)if(!Object(a.a)(t.getElementsByTagName("link-entity")[n].attributes.getNamedItem("name"))){const e=t.getElementsByTagName("link-entity")[n].attributes.getNamedItem("name").nodeValue;if(!this.isOfflineDataSourceInitialized()||!this.get_offlineDataSource().isEntityAvailableForOfflineUsage(e))return!1}}return!0}static get_instance(){return Object(a.a)(s)&&(s=new c,s.set_offlineDataSource(new o)),s}}},qFOq:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.NotReadOnly=0]="NotReadOnly",e[e.RecordStatus=1]="RecordStatus",e[e.RecordPermissions=2]="RecordPermissions",e[e.EntityPermissions=3]="EntityPermissions",e[e.Offline=4]="Offline"}(r||(r={}))},qGFd:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"d",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return o}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r={StoreDbType:"StoreDbType"};function a(e){return null==e?o.OrgDb:e}function i(e,t={}){return t[r.StoreDbType]||(t[r.StoreDbType]=e),t}var o;!function(e){e[e.OrgDb=1]="OrgDb",e[e.ProfileDb=2]="ProfileDb"}(o||(o={}))},qJCH:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));class r{constructor(e,t){this._key=null,this._personalization=null,this._key=e,this._personalization=t}get_personalization(){return this._personalization}get_key(){return this._key}getObjectData(){const e={};return e[r.KeyPath]=this._key,e.personalization=this._personalization,e}static createFromObjectData(e){const t=e[r.KeyPath],n=e.personalization;return new r(t,n)}}r.KeyPath="key"},qK01:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("5yoC");class a extends r.a{constructor(e,t,n){super(),this._target=null,this._solutionUniqueName=null,this._concurrencyBehavior=0,this._target=e,this._solutionUniqueName=t,this._concurrencyBehavior=n}get_name(){return"Delete"}get_xmlNamespace(){return"http://schemas.microsoft.com/xrm/2011/Contracts"}get_target(){return this._target}get_solutionUniqueName(){return this._solutionUniqueName}get_concurrencyBehavior(){return this._concurrencyBehavior}set_concurrencyBehavior(e){return this._concurrencyBehavior=e,e}}},qLnS:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.CanCreate=1]="CanCreate",e[e.CanRead=2]="CanRead",e[e.CanUpdate=4]="CanUpdate"}(r||(r={}))},qMYv:function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"e",(function(){return s}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="Button_Label_Save_Footer",a="Web.Form.RecordSave.Success",i="Footer_Caption",o="Footer_StatusControl_Save_ToolTip",s=[r,a,i,o,"Dialog_Label_Active"]},qTme:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n("dHD5"),a=n("BFlg");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i="dataSnapshotNumber.setFormMetadata";function o(e,t,n){return{type:"grid.setCustomFilter.async",execute({dispatch:o,getState:s},c){const l=c.TraceManager.getTracer(a.P),u=a.N+".setDataSnapshotNumberAction";try{l.info("Updating the data snapshot id for the grid. ");const a=Object(r.w)(n);return o(function(e,t,n){return{type:i,payload:t,meta:{pageId:e,contextKey:n}}}(e,t,a)),c.EventManager.ReportComponentSuccess(u),Promise.resolve()}catch(e){const t="Updating data snapshot id failed with error : "+e.message;c.EventManager.ReportComponentFailure(u,Error(t))}}}}},qUtK:function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var r=n("K7RF"),a=n("FdKt"),i=n("eXjw"),o=n("GWSs"),s=n("wyQO"),c=n("Brg7"),l=n("2FbK"),u=n("/oKV"),d=n("iJGp"),p=n("4leG");let f=!0;function g(e){return{type:"sitemap.retrieve.async",execute({dispatch:t,getState:n},l){let f=u.a.LocalAndRemote;const g=n();if(Object(p.e)(g))return Promise.resolve();const m=Object(o.b)(g);if(m===i.a.Initialized&&Object(r.e)(g,Object(o.f)(g).OverallVersionNumber)&&(f=u.a.Remote),m===i.a.Initializing||m===i.a.Uninitialized||f!==u.a.LocalAndRemote){let p=Promise.resolve();t(function(){const e={siteMap:{initialized:i.a.Initializing}};return{type:r.a,payload:e}}()),f===u.a.Remote&&(p=t(Object(s.h)(e,!0)));const g=t(function(e){return{type:"sitemap.retrieve.async",execute({dispatch:t,getState:n},i){const s=t(Object(r.b)("sitemap",null,null,null,!0,d.a.OnDemandWithoutContext,null,null,[],null,e));return s.then(()=>{Object(a.b)(()=>t(Object(c.a)(o.i)),"SiteMapLoadImages")}),s}}}(f));return g.then(()=>{h(n(),l)}),Promise.all([p,g])}return h(n(),l),Promise.resolve()}}}function h(e,t){try{if(f){const n=Object(l.a)(e);if(n&&n.Areas){f=!1;const e=n.Areas;let r=0;const a=Object.keys(e).length,i=[],o=[];for(const t in e){const n=e[t];if(n&&n.Groups){const e=Object.keys(n.Groups).length;r+=e,i.push(e);for(const e in n.Groups)if(n.Groups[e].SubAreas){const t=Object.keys(n.Groups[e].SubAreas).length;o.push(t),r+=t}}}const s=[];s.push({name:"ic",value:r}),s.push({name:"ac",value:a}),s.push({name:"ars",value:JSON.stringify(i)}),s.push({name:"gs",value:JSON.stringify(o)}),t.EventManager.ReportComponentSuccess("NPSSitMap.structure",s)}else t.EventManager.ReportComponentFailure("retrieveSiteMap.siteMapTelemetry",new Error("site map is null or undefined"))}}catch(e){t.EventManager.ReportComponentFailure("retrieveSiteMap.siteMapTelemetry",e)}}},"qk+o":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * The unique name of the KbArticle page module.
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="KbArticle"},qn5m:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("NjDY"),a=n("IqkD"),i=n("3mEc");function o(e,t){const n=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e){const t=Object(r.D)(e),n=Object(a.x)(e);return{orgname:t.organizationUniqueName,orglcid:t.orgCultureInfoLCID&&t.orgCultureInfoLCID.toString(),userlcid:n.languageId&&n.languageId.toString()}}(e);return n&&t?Object.keys(n).reduce((e,t)=>Object(i.b)(e,t,n[t]),t):t}},qpML:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r,a;n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a})),function(e){e[e.InProgress=0]="InProgress",e[e.Finished=1]="Finished",e[e.Failed=2]="Failed",e[e.Cancelled=3]="Cancelled"}(r||(r={})),function(e){e[e.Upload=0]="Upload",e[e.Download=1]="Download",e[e.Delete=2]="Delete"}(a||(a={}))},qshH:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("16wZ"),a=n("WePp"),i=n("IaGr"),o=n("ZIjf"),s=n("dHD5");let c,l;class u{static getInstance(e){try{return!c&&e&&(c=e),l||(l=new u),l}catch(e){throw u.getInstance().reportFailure("ClientApi.XrmReporting.getInstance",e),e}}reportSuccess(e,t){const n="ClientApi.XrmReporting.reportSuccess";e||Object(r.j)(n,"componentName");try{e.startsWith("ClientApi.")||o.a.instance.reportCall(n),i.a.getInstance().eventManager.ReportComponentSuccess(e,t),e.startsWith("ClientApi.")||o.a.instance.reportSuccess(n)}catch(e){throw this.reportFailure(n,e),e}}reportFailure(e,t,n,a){const s="ClientApi.XrmReporting.reportFailure";e||Object(r.j)(s,"componentName"),t||Object(r.j)(s,"failureError");try{e.startsWith("ClientApi.")||o.a.instance.reportCall(s),e.startsWith("ClientApi.")&&o.a.instance.reportFailure(e)}catch(e){i.a.getInstance().eventManager.ReportComponentFailure(s+".reportClientApiFailure",e)}i.a.getInstance().eventManager.ReportComponentFailure(e,t,n,a);try{e.startsWith("ClientApi.")||o.a.instance.reportSuccess(s)}catch(e){i.a.getInstance().eventManager.ReportComponentFailure(s+".reportClientApiSuccess",e)}}reportEvent(e){e||Object(r.j)("ClientApi.XrmReporting.reportEvent","event");try{o.a.instance.reportCall("ClientApi.XrmReporting.reportEvent");const t=new a.a(e.eventName);for(const n of e.eventParameters)t.addEventParameter(n.name,n.value);i.a.getInstance().eventManager.ReportEvent(t),o.a.instance.reportSuccess("ClientApi.XrmReporting.reportEvent")}catch(e){throw this.reportFailure("ClientApi.XrmReporting.reportEvent",e),e}}getEventParameters(e){const t=[];return t.push({name:"contextKey",value:Object(s.w)(e)}),t}}},quej:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n("SAYH"),a=n("eXjw");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i="businessProcessFlow.instance.update.timestamp";function o(e){const t=(new Date).getTime(),n={entities:{[e.etn]:{[r.a.toString(e.id)]:{initialized:a.a.Initialized,processInstanceModifiedTimestamp:t}}}};return{type:i,payload:n}}},"r/9v":function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return s}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
let r,a=!1;function i(e){return r&&r.SkypeChannel&&r.SkypeChannel.SkypeChannelClient&&r.SkypeChannel.SkypeChannelClient.PresenceInformation?r.SkypeChannel.SkypeChannelClient.PresenceInformation.getPresenceMappedField(e):null}function o(e){return!!(r&&r.SkypeChannel&&r.SkypeChannel.SkypeChannelClient&&r.SkypeChannel.SkypeChannelClient.PresenceInformation&&a)&&r.SkypeChannel.SkypeChannelClient.PresenceInformation.isPresenceEnabledEntity(e)}function s(e,t){a=e,r=t}},r0R4:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("UZFl"),a=n("pEXn");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i={getName:()=>r.a,getRequiredAttributes(){throw new Error("Not Implemented")},createPageModule:e=>n.e(97).then(n.bind(null,"TQrM")).then(({Apps:t})=>new t(e)),getTelemetryAttributes:e=>[{name:a.b.WebResourceName,value:e&&e.webresourceName}]};Object.freeze(i);var o=n("D+Bz"),s=n("xagu");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const c={type:o.a.Page,pageType:"apps",factory:i,urlToInput:e=>({webresourceName:e.searchParams.get(s.E)}),inputToUrl(e,t){const n=new URL(e,window.location.origin);return n.searchParams.set(s.E,t.webresourceName),n.href}}},r0fD:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return u}));var r=n("LqfC"),a=n("zsAz"),i=n("3peg"),o=n("rcL5"),s=n("1Bax");function c(e=1){switch(e){case 0:case 1:return e;default:throw Object(a.d)("Invalid panes state",2415919121,[{name:"state",value:e}])}}function l(e,t=2){return{type:r.k,sync:!0,execute({dispatch:n,getState:r}){if(Object(i.d)(r())&&2===t){const a=Object(o.h)(r(),t);if(a){const t=0===e?0:1;return n(Object(s.b)(a.sidePanelId,{sidePanelState:t}))}}n(u(e,t))}}}function u(e,t=2){return{type:r.k,payload:{panesState:c(e)},meta:{position:t}}}},r1yn:function(e,t,n){"use strict";e.exports=n("1Utt")},rCFy:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="offline.subscription.set";function a(e,t){return{type:r,payload:{subscriptionId:e,subscriptionErrorMessage:t}}}},rJ1v:function(e,t,n){"use strict";function r(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}n.d(t,"a",(function(){return r}))},rO1J:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("84PK"),a=n("qLnS");class i{constructor(e,t,n,r){this._attributeId=null,this._canCreate=!1,this._canRead=!1,this._canUpdate=!1,this._accessRightsMask=0,this._attributeId=e,this._canCreate=t,this._canRead=n,this._canUpdate=r,this._accessRightsMask=0,this._accessRightsMask=this._canCreate?this.get_AccessRightsMask()|a.a.CanCreate:this._accessRightsMask,this._accessRightsMask=this._canRead?this.get_AccessRightsMask()|a.a.CanRead:this._accessRightsMask,this._accessRightsMask=this._canUpdate?this.get_AccessRightsMask()|a.a.CanUpdate:this._accessRightsMask}get_AttributeId(){return this._attributeId}get_CanCreate(){return this._canCreate}get_CanRead(){return this._canRead}get_CanUpdate(){return this._canUpdate}get_AccessRightsMask(){return this._accessRightsMask}getObjectData(){return{attributeid:this._attributeId.getObjectData(),cancreate:this._canCreate,canread:this._canRead,canupdate:this._canUpdate}}static createFromObjectData(e){const t=r.a.createFromObjectData(e.attributeid);return new i(t,e.cancreate,e.canread,e.canupdate)}}},rQHy:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n("6hHv"),a=n("ILmX"),i=n("wgH2"),o=n("GYDS"),s=n("nlPs"),c=n("dHD5");function l(e,t,n){return{type:"commandbar.refresh.async",execute({dispatch:l,getState:u},d){const p=u(),f=p&&p.commands,g=[];if(f)if(n)for(const e in f)g.push(e);else{const n=Object(o.a)(e,t);g.push(n)}return Promise.all(g.map(t=>{const n=Object(s.b)(u(),t),o=Object(c.w)(n),d=Object(a.l)(u(),t,null),p=Object(i.c)(u(),t);return l(Object(r.c)(d,p,e,t,o,!0))})).then(e=>!0)}}}},rWW8:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("504W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class a{constructor(e,t,n){this.requestId=null,this._callerName=null,this._stack=[],this._useCommonPromiseCache=!1,this._callerName=Object(r.b)(t)?a.unknown:t,this._useCommonPromiseCache=null!=n&&n}get_callerName(){return this._callerName}get_Stack(){return JSON.stringify(this._stack)}AppendCallStack(e){Object(r.a)(e)||this._stack.push({callerName:""+e,executionTime:Date.now()})}IsPreloadCall(){return!1}get_UseCommonPromiseCache(){return this._useCommonPromiseCache}}a.unknown="unknown"},rcL5:function(e,t,n){"use strict";n.d(t,"i",(function(){return u})),n.d(t,"d",(function(){return s})),n.d(t,"h",(function(){return g})),n.d(t,"c",(function(){return f})),n.d(t,"a",(function(){return h})),n.d(t,"k",(function(){return c})),n.d(t,"b",(function(){return l})),n.d(t,"j",(function(){return p})),n.d(t,"e",(function(){return d})),n.d(t,"g",(function(){return b})),n.d(t,"f",(function(){return m}));var r=n("/leX"),a=n("zsAz"),i=n("oT5e"),o=n("rvu9");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function s(e){return e.panelManager}function c(e,t){return s(e).appPaneDescriptors[t]}function l(e,t){const n=u(e,t);if(n.type!==r.b.Pane)return n}function u(e,t){const n=s(e).panes[t];if(!n)throw Object(a.d)("SidePanel does not exist",2415919126,[{name:"sidePanelId",value:t}]);return n}function d(e,t){const n=c(e,t);return n.selectedPane&&u(e,n.selectedPane)}function p(e,t){var n;const a=u(e,t);return a.type===r.b.IFrame?null!==(n=a.option.sidePanelTitle)&&void 0!==n?n:"":Object(o.e)(e,t)}function f(e,t){const n=s(e).panes,a=Object.keys(n);for(let e=0;e<a.length;e++){const i=n[a[e]];if(i.type===r.b.Page&&i.option.sidePanelPosition===t)return i}return null}function g(e,t){const n=s(e).panes,a=Object.keys(n);for(let e=0;e<a.length;e++){const i=n[a[e]];if(i.type!==r.b.Pane&&i.option.sidePanelPosition===t)return i}return null}function h(e,t){const n=Object(i.b)(e,t);return!!n&&1===n.type}function m(e,t){return y(e,Object(i.a)(e,t))}function b(e,t){return y(e,Object(i.b)(e,t))}function y(e,t){if(1===(null==t?void 0:t.type)){const n=s(e).panes,a=Object.keys(n);for(let e=0;e<a.length;e++){const i=n[a[e]];if(i.type!==r.b.IFrame&&i.browsingContextId===t.id)return i}}return null}},rhTL:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(7),n.e(18),n.e(20),n.e(21),n.e(24),n.e(22),n.e(25),n.e(30),n.e(27),n.e(29),n.e(31),n.e(36),n.e(39),n.e(42),n.e(50),n.e(57),n.e(120)]).then(n.bind(null,"4XPS"))}function a(e,t,n,a){return r().then(r=>{const i=!a,o=e?r.getFirstTabbable(t,n,a,i):r.getLastTabbable(t,n,a,i);return!!o&&(o.focus(),!0)})}function i(e,t,n){return a(!0,e,t,n)}function o(e,t,n){return a(!1,e,t,n)}n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}))},rodW:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n("SAYH"),a=n("eXjw");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i="businessProcessFlow.addRefreshGlobalNavigationDataFlagToRecordData";function o(e,t){const n={entities:{[t.etn]:{[r.a.toString(t.id)]:{initialized:a.a.Initialized,refreshGlobalNavigationData:e}}}};return{type:i,payload:n}}},rpfD:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=/^\{?([0-9a-f]{8}(-?)[0-9a-f]{4}\2[a-f\d]{4}\2[0-9a-f]{4}\2[0-9a-f]{12})}?$/;function a(e,t){var n=r.exec(e.toLocaleLowerCase()),a=r.exec(t.toLocaleLowerCase());return n[1]===a[1]}function i(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}},ruPX:function(e,t,n){"use strict";n.d(t,"a",(function(){return y})),n.d(t,"c",(function(){return S})),n.d(t,"b",(function(){return O})),n.d(t,"d",(function(){return C}));var r=n("JC5U"),a=n("xPbo"),i=n("gQ5I"),o=n("ZuxC"),s=n("5w+f"),c=n("JHwY"),l=n("pF61"),u=n("D+Bz"),d=n("oqdd"),p=n("zsAz"),f=n("31Vn"),g=n("1OTd"),h=n("oT5e"),m=n("GYEz"),b=n("w1eR");function y(e,t,n,y){return{type:g.j,execute(O,E){const I={pageName:e,input:t};let w;if("object"==typeof y)w=Object.assign({},y);else{w={source:y}}const j=w.source===u.b.Redirect;return j&&(w.replaceState=j),E.CustomNavigationHandler.handleNavigation(I,w,O,n).then(e=>e||function(e,t,n,y,O){if(t.source===u.b.SwitchApp){const t=n.getState(),r=t&&t.metadata&&t.metadata.appContext&&t.metadata.appContext.app&&t.metadata.appContext.app.appId;e.input=Object.assign(Object.assign({},e.input),{appId:r})}const E=y.Router;return E.preRenderCheck(e).then(u=>{if(u.resultType===d.a.Redirect)e=u.resultValue;else if(u.resultType===d.a.Fail){const n=e&&e.input&&e.input.uniqueName,r=e&&e.input&&e.input.entityTypeName,a=[{name:"Options",value:C(t)},{name:"PageName",value:e&&e.pageName},{name:"EntityTypeName",value:r},{name:"UniqueName",value:n},{name:"PreRenderStatusResultType",value:d.a[u.resultType]}];return y.EventManager.ReportComponentFailure("Navigation.Page",u.resultValue,"Analyze event parameters to understand why prePageRender failed.",a),{status:1,error:u.resultValue}}return function(e,t,n,u,d,y){let O=Promise.resolve(!0);const E=y||Object(l.c)(u.getState(),n.targetBrowsingContext);E&&(O=e.shouldNavigate(t,!0,E,n));return O.then(O=>{if(O)return function(e,t,n,u,d,g){const y=e.isPageADialog(u.getState(),t,n,g);if(!y){if("newWindow"===(null==n?void 0:n.target)&&Object(m.a)(u.getState())===b.a.Browser){const e=u.dispatch(S(t.pageName,t.input)),r=[];return r.unshift({name:"Options",value:""+C(n)}),r.unshift({name:"Url",value:Object(f.a)(t.pageName)}),r.unshift({name:"IsDialog",value:""+y}),r.unshift({name:"PageName",value:t.pageName}),e}return u.dispatch(Object(i.d)(n.targetBrowsingContext)).then(()=>{u.dispatch(Object(r.b)(n.targetBrowsingContext));return e.navigateTo(t,n,u,g).then(([e,r,i,s,c,p])=>{const g=u.getState(),m=e.getId(),b=i?Object(l.c)(g):m;c.unshift({name:"Options",value:C(n)}),c.unshift({name:"Url",value:Object(f.a)(t.pageName)}),c.unshift({name:"IsDialog",value:""+i}),c.unshift({name:"BrowsingContextType",value:Object(h.c)(g,n.targetBrowsingContext)}),c.unshift({name:"PageName",value:e.getName()}),c.unshift({name:"PageId",value:m}),Object(l.c)(g)&&c.unshift({name:"CurrentPageId",value:Object(l.c)(g)}),u.dispatch(Object(a.d)(b,m,n.targetBrowsingContext));return u.dispatch(Object(o.c)(e,r,i,p,n.source)).then(e=>(d.EventManager.ReportComponentSuccess("Navigation.Page",c),e),e=>(e=_(e),d.EventManager.ReportComponentFailure("Navigation.Page",e,"Check error details to know why navigation failed.",c),u.dispatch(Object(a.e)(e,n.targetBrowsingContext)),{status:1,error:e}))},e=>{const r=[{name:"Url",value:Object(f.a)(t.pageName)},{name:"Options",value:C(n)}];return d.EventManager.ReportComponentFailure("Navigation.Page",e,"Check error details to know why navigation failed.",r),v(e,u,n.targetBrowsingContext)}).then(e=>(u.dispatch(Object(r.a)(n.targetBrowsingContext)),e))},e=>{if(e&&2415919106===e.errorCode){const r=[{name:"PageName",value:t.pageName},{name:"Options",value:C(n)}];Object(p.b)(e,r),d.EventManager.ReportComponentSuccess("Navigation.Page.Cancel",r)}throw e}).catch(e=>({status:1,error:e}))}u.dispatch(Object(r.b)(n.targetBrowsingContext));return e.navigateTo(t,n,u,g).then(([e,r,a,o,p,g])=>{const m=u.getState(),b=e.getId();p.unshift({name:"Options",value:C(n)}),p.unshift({name:"Url",value:Object(f.a)(t.pageName)}),p.unshift({name:"IsDialog",value:""+a}),p.unshift({name:"PageName",value:e.getName()}),p.unshift({name:"PageId",value:b}),Object(l.c)(m)&&p.unshift({name:"CurrentPageId",value:Object(l.c)(m)});const y=Object(h.a)(m,n.targetBrowsingContext);p.unshift({name:"BrowsingContextType",value:y.type}),u.dispatch(Object(c.b)(y.dialogContextIds,n.targetBrowsingContext));return u.dispatch(Object(s.b)(e,r,a,o,g)).then(e=>(d.EventManager.ReportComponentSuccess("Navigation.Page",p),{status:0,pageId:e}),t=>(t=_(t),d.EventManager.ReportComponentFailure("Navigation.Page",t,"Check error details to know why navigation failed.",p),u.dispatch(Object(i.e)(e.getId(),"dismiss")),{status:1,error:t}))},e=>{const r=[{name:"Url",value:Object(f.a)(t.pageName)},{name:"Options",value:C(n)}];return d.EventManager.ReportComponentFailure("Navigation.Page",e,"Check error details to know why navigation failed.",r),v(e,u,n.targetBrowsingContext)}).then(e=>(u.dispatch(Object(r.a)(n.targetBrowsingContext)),e))}(e,t,n,u,d,y);const E=[{name:"PageName",value:t.pageName},{name:"Options",value:C(n)}];d.EventManager.ReportComponentSuccess("Navigation.Page.Cancel",E);return{status:1,error:Object(p.d)(g.l,2415919106,E)}})}(E,e,t,n,y,O)}).catch(e=>v(e,n,t.targetBrowsingContext))}(I,w,O,E,n))}}}function _(e){return e||Object(p.d)("Navigate Error",2415919107)}function v(e,t,n){return e=_(e),t.dispatch(Object(a.e)(e,n)),Promise.resolve({status:1,error:e})}function S(e,t,n){return{type:g.k,execute({dispatch:r,getState:a},i){var o,s,c,l,u,d;if(!t.newWindowOptions||!(null===(o=t.newWindowOptions)||void 0===o?void 0:o.height)&&!(null===(s=t.newWindowOptions)||void 0===s?void 0:s.width)&&!(null===(c=t.newWindowOptions)||void 0===c?void 0:c.toolbar))return Promise.resolve(O(i,e,t));n||(n="_blank");const f=new URL(i.Router.createUrlForPage(e,t,void 0,!0),window.location.origin);if(f.searchParams.set("newWindow","true"),Object(m.a)(a())===b.a.MobileApplication)return i.Router.navigateToNewWindow(f.toString());const g=null===(l=t.newWindowOptions)||void 0===l?void 0:l.toolbar,h=window.open(f.toString(),n,"width="+(null===(u=t.newWindowOptions)||void 0===u?void 0:u.width)+",height="+(null===(d=t.newWindowOptions)||void 0===d?void 0:d.height)+",toolbar="+g+",resizable=1");if(null==h){const e=Object(p.d)("The window could not be opened.",2147873356);return Promise.resolve({status:1,error:e})}return Promise.resolve({status:0,pageId:void 0,windowProxy:h})}}}function O(e,t,n){const r=new URL(e.Router.createUrlForPage(t,n,void 0,!0),window.location.origin);r.searchParams.set("newWindow","true");const a=window.open(r.toString());if(null==a){return{status:1,error:Object(p.d)("The window could not be opened.",2147873356)}}return{status:0,pageId:void 0,windowProxy:a}}function C(e){return[{name:"source",value:e.source},{name:"sourceBrowsingContext",value:e.sourceBrowsingContext},{name:"targetBrowsingContext",value:e.targetBrowsingContext},{name:"replaceState",value:e.replaceState},{name:"resetHistory",value:e.resetHistory}]}},rvu9:function(e,t,n){"use strict";n.d(t,"c",(function(){return f})),n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return h})),n.d(t,"d",(function(){return m})),n.d(t,"f",(function(){return b})),n.d(t,"e",(function(){return y}));var r=n("/leX"),a=n("rcL5"),i=n("VtmT"),o=n("NjDY"),s=n("oT5e"),c=n("arV0"),l=n("FJpk"),u=n("zsAz"),d=n("g03H"),p=n("Y7HL");function f(e,t){const n=Object(a.d)(e).panes[t];if(!n)throw Object(u.d)("Pane does not exist",2415919129,[{name:"paneId",value:t}]);return n}function g(e,t){const n=f(e,t).option.badge;return"string"==typeof n?b(e,n):n}function h(e,t){return b(e,f(e,t).option.imageSrc)}function m(e,t){const n=h(e,t);return Object(d.l)(n)?{type:null,value:""}:{type:p.a,value:n}}function b(e,t){const n=Object(o.x)(e),r=t&&Object(i.b)(n,t);return r?n+r:t}function y(e,t){const n=f(e,t);if(n.option.sidePanelTitle)return n.option.sidePanelTitle;if(n.type===r.b.IFrame)return"";const a=Object(s.a)(e,n.browsingContextId),i=Object(c.n)(e,a.pageId);return i?Object(l.c)(i):""}},rwix:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("huli");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function a(e){return r.createPortal(e.children,document.getElementById("PortalRoot"))}a.displayName="PortalToBody"},ryEF:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return o}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="offlineSyncNotification",a="offlineManualRefreshNotification",i="offlineSyncWhenOutOfDateNotification",o="offlineSyncFinishedPromptRefreshNotification"},rzss:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
let r=null;async function a(){return r||(r=await Promise.all([n.e(4),n.e(9),n.e(8),n.e(40),n.e(34),n.e(44),n.e(47)]).then(n.bind(null,"TwA0"))),r}},"s/8p":function(e,t,n){"use strict";n.d(t,"g",(function(){return r})),n.d(t,"f",(function(){return a})),n.d(t,"h",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return c})),n.d(t,"j",(function(){return l})),n.d(t,"i",(function(){return u})),n.d(t,"e",(function(){return d})),n.d(t,"d",(function(){return p}));
/**
 * OfflineSqlConstants for the data api.
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="/*QuickFindStart*/",a="/*QuickFindEnd*/",i="/*SelectStart*/",o="/*FromEnd*/",s="/*CTEStart*/",c="/*CTEEnd*/",l="/*WhereStart*/",u="/*WhereEnd*/",d="/*OrderByStart*/",p="/*OrderByEnd*/"},s1hL:function(e,t,n){"use strict";n.d(t,"a",(function(){return y})),n.d(t,"b",(function(){return _})),n.d(t,"c",(function(){return v}));var r=n("D6Jg"),a=n("3/02"),i=n("Lyxw"),o=n("odYE"),s=n("SAYH"),c=n("uNu9"),l=n("F1Lu"),u=n("WPtp"),d=n("lY/Z"),p=n("5Oca"),f=n("a475"),g=n("d4He"),h=n("NvOS"),m=n("9n4z"),b=n("ABCl");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function y(e,t,n){let a;e.createFromEntity&&(a=new o.a(e.createFromEntity.entityType,new s.a(e.createFromEntity.id),e.createFromEntity.name));const i=e.recordSetQueryKey&&e.recordSetQueryKey.split("-")[0];return i&&i!==e.entityName&&i!==c.b&&i!==c.zb&&e.entityId&&e.entityName&&(e.recordSetQueryKey=`${e.entityName}-${e.entityId}`),{entityTypeName:e.entityName,id:e.entityId?new s.a(e.entityId):void 0,data:t||void 0,formId:e.formId?new s.a(e.formId):void 0,processId:e.processId,processInstanceId:e.processInstanceId,selectedStageId:e.selectedStageId,isCrossEntityNavigate:e.isCrossEntityNavigate,bpfDisplayStateForCrossEntityNavigation:e.bpfDisplayStateForCrossEntityNavigation,initWithEntity:a,cmdbar:e.cmdbar,recordSetQueryKey:e.recordSetQueryKey,isOfflineSyncError:e.isOfflineSyncError,navbar:Object(r.f)(e.navbar),isQueryMode:n&&n.isQueryMode,isAdvancedFindView:n&&n.isAdvancedFindView}}function _(e,t,n,r,a){const i=new o.a("report",e.id),c=["reporttypecode","filename","bodybinary","filesize","mimetype"];return t.dispatch(Object(d.e)(i,c)).then(()=>{const o=Object(p.j)(t.getState(),i,"reporttypecode"),c=o?parseInt(o.valueString,10):null;if(2===c){const e=Object(u.c)(Object(p.j)(t.getState(),i,"filename")),r=Object(u.c)(Object(p.j)(t.getState(),i,"bodybinary")),o=Object(u.c)(Object(p.j)(t.getState(),i,"filesize")),s=parseInt(o,10),c=Object(u.c)(Object(p.j)(t.getState(),i,"mimetype"));return n({fileName:e,fileContent:r,fileSize:s,mimeType:c},{openMode:2}),a}if(1===c||3===c){const n=s.a.toString(e.id),i=Object(h.a)(t.getState(),"/crmreports/viewer/viewer.aspx?id="+encodeURIComponent(n));return r(i),a}})}async function v(e,t,n,r,o){new b.b(r,m.a).runClientApiChecker(e,[{name:"url",value:t,isClientAPICheckerParam:!0},{name:"options",value:JSON.stringify(o),isClientAPICheckerParam:!0}]);if((Object(i.f)(r.getState(),a.o)||Object(i.f)(r.getState(),a.uf))&&o&&!1!==o.openInNewWindow&&(o.height||o.width)&&(o.openInNewWindow=!0),Object(i.f)(r.getState(),a.df))return r.dispatch(Object(g.a)(t,o));if(o&&o.isExternal){const e=f.a.get_Instance(),n=e?e.get_document():null;if(e.willDispatcherBeAvailableFromDevice("Document")&&n){return void(await n).openExternalUrl(t)}}return new l.a(n,r).openUri(t,o)}},sDlx:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Unknown=0]="Unknown",e[e.MSACID=1]="MSACID",e[e.MSAPUID=2]="MSAPUID",e[e.ANID=3]="ANID",e[e.OrgIdCID=4]="OrgIdCID",e[e.OrgIdPUID=5]="OrgIdPUID",e[e.UserObjectId=6]="UserObjectId",e[e.Skype=7]="Skype",e[e.Yammer=8]="Yammer",e[e.EmailAddress=9]="EmailAddress",e[e.PhoneNumber=10]="PhoneNumber",e[e.SipAddress=11]="SipAddress",e[e.MUID=12]="MUID"}(t.AWTUserIdType||(t.AWTUserIdType={})),function(e){e[e.Started=0]="Started",e[e.Ended=1]="Ended"}(t.AWTSessionState||(t.AWTSessionState={}))},sHzf:function(e,t,n){"use strict";n.r(t),n.d(t,"removeToastNotification",(function(){return a}));var r=n("ScZZ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e){return{type:"remove.toastNotificationAction.async",execute({dispatch:t}){const n={type:r.c,payload:e};return Promise.resolve(t(n))}}}},sJUk:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("nA3O"),a=n("/Ypj"),i=n("XjOj"),o=n("Div0"),s=n("NMtn");class c extends r.a{constructor(){super(),this._callContext=null}get_hasBigArgs(){return!1}get_callContext(){return this._callContext||(this._callContext=new a.a(null,null)),this._callContext}set_callContext(e){return this._callContext=e,e}getValues(){const e={},t=this.getSchema();for(let n=0;n<t.get_count();n++){const r=t.get_item(n);r.get_propertyType().prototype&&r.get_propertyType().prototype.get_callbackID||this.putSinglePropertyIntoDictionary(e,r)}return e}getCallbacks(e){Object(s.b)(e,"bridge");const t={},n=this.getSchema();for(let r=0;r<n.get_count();r++){const a=n.get_item(r);if(a.get_propertyType().prototype&&a.get_propertyType().prototype.get_callbackID){Object(i.h)(o.a.PAL,"Registering callback object for callback, {0}",a.get_name());const n=this.getValue(a),r=e.registerNativeCallback(this,n);a.get_jsonConverter().write(t,a,r)}}return t}}},sNgR:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return l}));var r=n("aRLb"),a=n("SRlt"),i=n("KXDI"),o=n("g22U"),s=n("Uv1Y");function c(e,t,n={}){return{type:"executeOData.function.async",async execute({dispatch:a,getState:i},o){try{return await a(Object(r.e)(t,e)),a(Object(r.b)(e,t,n))}catch(e){Object(s.b)(e)}}}}function l(e,t,n={},r){try{const s=Object(i.b)(e,t,r);let c=o.d.FUNCTION;const l=t.getMetadata().operationName||o.e;l!==o.d.GCM&&l!==o.d.GCMEX||(c=o.d.GCM);const u=Object(o.g)(n);return{urlParameters:s,additionalHeaders:{Accept:a.a,Prefer:'odata.include-annotations="*"'},method:"GET",additionalParameters:{[o.a.TYPE]:c,[o.a.SUB_TYPE]:l,[o.a.SOURCE]:u}}}catch(e){return{serializationFailure:e.message}}}},sX6v:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s}));var r=n("iZ7K"),a=n("bT7G"),i=n("504W");const o="dataSnapshot.update";function s(e,t,n,s){if(!t||!n)throw new Error("Cannot update snapshot: invalid parameters specified");let c=null;if(!(c=Object(a.b)(e,t)))throw new Error("Cannot update snapshot: a snapshot with specified id does not exist");const l=[];s&&l.push({id:s});let u=null,d=null;(u=Object(r.h)(e,c.identifier.etn))&&(d=u.PrimaryNameAttribute)&&n.hasOwnProperty(d)&&(Object(i.a)(n[d])||l.push({name:n[d].value}));const p=l.length?Object.assign({},c.identifier,...l):null;return{type:o,payload:n,meta:{snapshotId:t,flavor:0,entityReference:p}}}},sYIp:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(7),n.e(10),n.e(4),n.e(5),n.e(6),n.e(9),n.e(8),n.e(11),n.e(12),n.e(13),n.e(14),n.e(15),n.e(16),n.e(17),n.e(23),n.e(26),n.e(48),n.e(158)]).then(n.bind(null,"u+sw"))}function a(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(7),n.e(10),n.e(4),n.e(5),n.e(6),n.e(9),n.e(8),n.e(11),n.e(12),n.e(13),n.e(14),n.e(15),n.e(16),n.e(17),n.e(23),n.e(26),n.e(48),n.e(152)]).then(n.bind(null,"/nFP")).then(({onNavigation:e})=>e)}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}))},"sZ+8":function(e,t,n){"use strict";n.d(t,"c",(function(){return d})),n.d(t,"j",(function(){return p})),n.d(t,"l",(function(){return v})),n.d(t,"a",(function(){return r})),n.d(t,"e",(function(){return _})),n.d(t,"n",(function(){return g})),n.d(t,"p",(function(){return f})),n.d(t,"b",(function(){return y})),n.d(t,"k",(function(){return S})),n.d(t,"m",(function(){return b})),n.d(t,"i",(function(){return O})),n.d(t,"g",(function(){return I})),n.d(t,"d",(function(){return C})),n.d(t,"f",(function(){return E})),n.d(t,"q",(function(){return h})),n.d(t,"r",(function(){return m})),n.d(t,"o",(function(){return w})),n.d(t,"h",(function(){return j}));var r,a=n("GL3b"),i=n("504W"),o=n("37s6"),s=n("17x/"),c=n("69Qu"),l=n("E5IU");!function(e){e[e.NotAvailable=0]="NotAvailable",e[e.Disabled=1]="Disabled",e[e.Enabled=2]="Enabled"}(r||(r={}));const u=["fax","letter","serviceappointment","campaignresponse","campaignactivity","recurringappointmentmaster","socialactivity"];function d(e){return!!(e&&e.offline&&e.offline.client&&e.offline.client.isCalculationOfDisabledEntitiesPending)&&e.offline.client.isCalculationOfDisabledEntitiesPending}function p(e){return e&&e.offline&&e.offline.client&&e.offline.client.offlineDisabledEntities?e.offline.client.offlineDisabledEntities:null}function f(e,t){var n;return Object(l.r)(e)&&(!t||-1!==(null===(n=v(e))||void 0===n?void 0:n.indexOf(t)))}function g(e,t){return Object(o.D)(e)&&-1!==v(e).indexOf(t)}function h(e,t){return t&&Object(s.i)(e)&&-1!==v(e).indexOf(t)}function m(e,t){return t&&Object(o.E)(e)&&Object(c.b)(e)&&-1===v(e).indexOf(t)}function b(e){return!e||-1===u.indexOf(e)}function y(e,t){if(t){const n=(new DOMParser).parseFromString(t,"text/xml"),r=n?n.getElementsByTagName("link-entity"):null;if(r&&r.length>0)for(let t=0;t<r.length;t++){const n=r[t];if(n&&n.attributes){const t=n.attributes.getNamedItem("name"),r=t?t.value:null;if(r&&!g(e,r))return{error:!0,relatedEntityUnavailableOffline:r}}}}return{error:!1}}function _(e,t){if(Object(o.D)(e)){if((Object(a.b)(e)||[]).indexOf(t)>=0){return(p(e)||[]).indexOf(t)<0?r.Enabled:r.Disabled}}return r.NotAvailable}function v(e){const t=Object(a.b)(e)||[],n=p(e)||[];return t.filter(e=>-1===n.indexOf(e))}function S(e){return e&&e.offline&&e.offline.client&&e.offline.client.offlineDisabledPrimaryEntities?e.offline.client.offlineDisabledPrimaryEntities:null}function O(e){return e&&e.offline&&e.offline.client&&e.offline.client.offlineAvailablePrimaryEntities?e.offline.client.offlineAvailablePrimaryEntities:null}function C(e,t){return e&&e.offline&&e.offline.client&&!Object(i.a)(e.offline.client.entityPluralName)&&!Object(i.a)(e.offline.client.entityPluralName[t])?e.offline.client.entityPluralName[t]:null}function E(e){return e&&e.offline&&e.offline.client&&!Object(i.a)(e.offline.client.entityPluralName)?e.offline.client.entityPluralName:null}function I(e){return e&&e.offline&&e.offline.client&&e.offline.client.offlineAvailableEntities?e.offline.client.offlineAvailableEntities:{}}function w(e,t){return Object(o.D)(e)&&j(e)[t]}function j(e){return e&&e.offline&&e.offline.client&&e.offline.client.offlineAvailableEntityMetadata?e.offline.client.offlineAvailableEntityMetadata:{}}},sclX:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r,a;n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),function(e){e[e.Active=1]="Active",e[e.Inactive=2]="Inactive"}(r||(r={})),function(e){e[e.Web=1]="Web",e[e.Native=2]="Native"}(a||(a={}))},sdkC:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("c7Og"),a=n("NMtn");class i{constructor(e){this._entityCollections=null,this._relatedEntityQueries=null,Object(a.d)(e,"entityCollections"),this._entityCollections=e,this._relatedEntityQueries=this._entityCollections.map(e=>e.get_value().get_query())}get_entityCollections(){return this._entityCollections}get_relatedEntityQueries(){return this._relatedEntityQueries}getObjectData(){const e={},t=[];for(const e of this._entityCollections){const n={};n.key=e.get_key().getObjectData(),n.value=e.get_value().getObjectData(),t.push(n)}return e.entitycollections=t,e}getByRelationship(e){for(const t of this._entityCollections)if(t.get_key().equals(e))return t.get_value();return null}addRelationship(e,t){for(let n=0;n<this._entityCollections.length;n++)if(this._entityCollections[n].get_key().equals(e))return void(this._entityCollections[n]=new r.a(e,t));this._entityCollections.push(new r.a(e,t))}}},si7p:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"e",(function(){return o})),n.d(t,"f",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"g",(function(){return l}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="alert",a="confirm",i="errorDialog",o="routerDialog",s="sessionTimeout",c="authError",l="unhandledErrorDialog"},sjKS:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
let r;function a(e){r=e}function i(){return r}n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i}))},sjhR:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("iLty"),a=n("Jz2d"),i=n("dFCJ");class o extends r.a{constructor(e){if(super(e),this._attributeMetadata=null,e){e.addNamespace("c",a.a.xrm2011MetadataNamespace);const t=e.selectNodes(".//d:ExecuteResult/a:Results/a:KeyValuePairOfstringanyType/b:value[@i:type='a:EntityMetadataCollection']/a:EntityMetadata/c:Attributes/c:AttributeMetadata");this.set_AttributeMetadata(Object(i.b)(t))}}get_AttributeMetadata(){return this._attributeMetadata}set_AttributeMetadata(e){return this._attributeMetadata=e,e}}},smSa:function(e,t,n){"use strict";n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return l}));var r=n("504W"),a=n("SAYH"),i=n("RADj");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function o(e){return e&&e.metadata&&e.metadata.offlineSync?e.metadata.offlineSync:null}function s(e){return e&&e.metadata&&e.metadata.offlineSync&&!Object(r.a)(e.metadata.offlineSync.syncStatus)?e.metadata.offlineSync.syncStatus:i.a.Init}function c(e){return!(!(e&&e.metadata&&e.metadata.offlineSync)||Object(r.a)(e.metadata.offlineSync.metadataAvailable))&&e.metadata.offlineSync.metadataAvailable}function l(e,t){return e&&e.metadata&&e.metadata.offlineSync&&e.metadata.offlineSync.appModuleTimestamps&&e.metadata.offlineSync.appModuleTimestamps[a.a.toString(t)]||0}},sptG:function(e,t,n){"use strict";n.d(t,"g",(function(){return r})),n.d(t,"f",(function(){return a})),n.d(t,"e",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"d",(function(){return s})),n.d(t,"h",(function(){return c})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return u})),n.d(t,"i",(function(){return d}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="Form_ReadOnly_Notification_Message",a="Form_Notification_LongMessage_Truncate_Text",i="Form_Notification_LongMessage_Expand_Text",o="Button_Label_Close",s="NOTIFICATIONS_COUNT_MESSAGE_BAR",c="RecordClosed.SyncError.Notification.Error.Text",l="Form_Notification_FocusShortcut",u="FormNotification_FooterControls_Monitor",d=["ProcessControl.Notification","ProcessControl.Configurator.Expand","ToastNotification_Error","ToastNotification_Warning","ToastNotification_Information",s,c,r,a,i,l,u,o]},suJD:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="right",a="left"},"sw/s":function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n("eXjw");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t){return e&&e.metadata&&e.metadata.taskBasedFlows?e.metadata.taskBasedFlows[t]:null}function i(e,t){const n=a(e,t);return n?n.initialized:r.a.Uninitialized}},syUe:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return g}));var r,a,i=n("mMyr"),o=n("huli"),s=n("kXuq"),c=n("EUSs"),l=n("N911"),u=n("z0sv"),d=(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),p=function(){return(p=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function f(e,t){return{display:e?t.display?t.display:"flex":"none"}}!function(e){e[e.Root=1]="Root",e[e.Nested=2]="Nested"}(a||(a={}));var g=function(e){function t(t){var n=e.call(this,t)||this;return n._rootElement=null,n._popupElement=null,n._stopPropagation=function(e){e.stopPropagation()},n._forceClosePopup=function(e){n._stopPropagation(e),n.props.closeOnOutsideClick&&(n.setState({forceClose:!0}),n.props.onPopupForcedClosed&&n.props.onPopupForcedClosed())},n.state={forceClose:!1},n._rootElement=document.getElementById(t.rootPopupId),n._accessibilityComponent=n._createAccessibilityComponentIfNeeded(),n}return d(t,e),t.prototype._getId=function(){return this.props.rootPopupId+"_"+(this.props.id||"innerPopup")},t.prototype._getCurrentPopupToOpen=function(e,t){var n="";!e&&t&&(n=t.split(".")[0]);return n},t.prototype._getNextPopupToOpen=function(e,t){var n="";if(!e&&t){var r=t.split(".");r.splice(0,1),n=r.join(".")}return n},t.prototype._getChildrenProps=function(){return{type:a.Nested,parent:this._popupElement,popupToOpen:this._getNextPopupToOpen(this.state.forceClose,this.props.popupToOpen),rootPopupId:this.props.rootPopupId}},t.prototype._getChildrenWithProps=function(e){var n=this;return e?e.map?e.map((function(e){return e.type===t?i.cloneElement(e,n._getChildrenProps()):e})):e===t?i.cloneElement(e,this._getChildrenProps()):e:null},t.prototype._isVisible=function(){return this._getCurrentPopupToOpen(this.state.forceClose,this.props.popupToOpen)===this.props.name},t.prototype._applyRootNodeStyle=function(){Object.assign(this._rootElement.style,this.props.rootStyle),this._toggleRootElementVisibility()},t.prototype._toggleRootElementVisibility=function(){this.props.isDialogPopup||(this._rootElement.getAttribute(c.a)?"none"===this._rootElement.style.display&&(this._rootElement.style.display="flex"):this._rootElement.style.display="none")},t.prototype._getStaticContent=function(){var e=null;return this.props.content&&(e=i.createElement(s.a,{ref:"staticContent"})),e},t.prototype._createAccessibilityComponentIfNeeded=function(){var e=this.props,t=e.createAccessibilityComponent,n=e.rootPopupId;return t&&n?t({id:this._getId(),rootElementId:n,shouldManageFocus:!0}):null},t.prototype._registerPopup=function(e,t){var n=e.name,r=e.popupToOpen,a=t.forceClose,i=this._rootElement.getAttribute(c.a),o=(i=i||"").indexOf(n);a||n!==this._getCurrentPopupToOpen(a,r)?~o&&this._rootElement.setAttribute(c.a,i.replace("."+n,"")):~o||this._rootElement.setAttribute(c.a,i.concat("."+n))},t.prototype._subscribeFlyoutPopupManager=function(){var e=this;this._managerSubscriber={type:u.a.Popup,onPointerDown:function(t){t.target===document.getElementById(e._getId())&&e._forceClosePopup(t)},getComponent:function(){return e._popupElement}},l.a.getInstance().addSubscribers(this._managerSubscriber)},t.prototype.componentWillMount=function(){this.props.isDialogPopup||this._registerPopup(this.props,this.state)},t.prototype.componentDidMount=function(){var e=this;this._popupElement=o.findDOMNode(this.refs.popup),this.forceUpdate((function(){var t=e.refs.staticContent;t&&o.findDOMNode(t).appendChild(e.props.content)})),this._subscribeFlyoutPopupManager()},t.prototype.componentWillReceiveProps=function(){this.setState({forceClose:!1})},t.prototype.componentWillUpdate=function(e,t){this._registerPopup(e,t);var n=this.refs.staticContent;if(n){for(var r=o.findDOMNode(n);r.firstChild;)r.removeChild(r.firstChild);r.appendChild(e.content)}},t.prototype.componentDidUpdate=function(e){this.props.createAccessibilityComponent&&e.rootPopupId!==this.props.rootPopupId&&console.warn("rootPopupId changed for "+this._getId()+". Focus will not be managed for this popup.")},t.prototype.componentWillUnmount=function(){l.a.getInstance().removeSubscribers(this._managerSubscriber)},t.prototype._adjustPixelValue=function(e,t){if(!e||"number"==typeof e||-1===e.indexOf("px"))return e;e=e.substring(0,e.indexOf("px"));var n=t?this.props.rootBodyElement.getBoundingClientRect().width:this.props.rootBodyElement.getBoundingClientRect().height,r=t?this.props.rootBodyElement.offsetWidth:this.props.rootBodyElement.offsetHeight;return(Number.parseFloat(e)-(t?this.props.rootBodyElement.getBoundingClientRect().left:this.props.rootBodyElement.getBoundingClientRect().top))/(n/r)+"px"},t.prototype._generatePopupStyle=function(){var e=Object.assign({},this.props.popupStyle);return!e.position||"absolute"!==e.position.toLowerCase()&&"fixed"!==e.position.toLowerCase()||this.props.rootBodyElement&&this.props.rootBodyElement!==document.body&&(e.left=this._adjustPixelValue(e.left,!0),e.right=this._adjustPixelValue(e.right,!0),e.top=this._adjustPixelValue(e.top,!1),e.bottom=this._adjustPixelValue(e.bottom,!1)),Object.assign({},e,this.props.isDialogPopup?{}:f(this._isVisible(),this.props.popupStyle))},t.prototype.render=function(){var e,t,n=this.props,r=n.children,a=n.isDialogPopup,o=n.parent,c=n.shadowStyle,u=n.style,d=a?u:Object.assign({},u,function(e,t){var n=Object.assign({},e),r=t&&t.getBoundingClientRect();return r&&(n.top=parseInt(n.top,10)-r.top+"px",n.left=parseInt(n.left,10)-r.left+"px"),n}(c,o),f(this._isVisible(),c)),g=this._generatePopupStyle();this._applyRootNodeStyle();var h=((e={})[l.a.pointerDownEvent]=this._forceClosePopup,e),m=((t={})[l.a.pointerDownEvent]=this._stopPropagation,t);return i.createElement(s.a,p({id:this._getId(),style:d},h),i.createElement(s.a,p({style:g},m,{ref:"popup"}),this._getStaticContent(),this._getChildrenWithProps(r)),this._accessibilityComponent)},t}(i.Component);g.defaultProps={shadowStyle:{position:"absolute",top:0,left:0,width:"100%",height:"100%",backgroundColor:"rgba(0, 0, 0, 0.3)"},isDialogPopup:!1,type:a.Root,closeOnOutsideClick:!1}},t6P7:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return l}));var r=n("3ZMs"),a=n("TEuE"),i=n("SeXA"),o=n("bfoP");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
let s;function c(e){s=e}function l(){if(!s)return Promise.resolve([]);const e=[],t=Object(o.a)();return s.dispatch(Object(i.b)()),Object(a.c)(),Promise.resolve().then(()=>{const n=t();return n.length>0&&e.push({type:r.PerformanceIssueType.UnmemoizedSelector,level:r.PerformanceIssueLevel.Warning,message:"Unmemoized component(s)",parameters:n}),e})}},t9aj:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="offline.first.time.sync.completed";function a(e){return{type:r,payload:{isOfflineFirstTimeSyncCompleted:e}}}},tFCh:function(e,t,n){"use strict";n.d(t,"d",(function(){return l})),n.d(t,"c",(function(){return u})),n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return f}));var r=n("zsAz"),a=n("1OTd"),i=n("+nTZ"),o=n("oT5e"),s=n("pF61"),c=n("gQ5I");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function l(e,t,n,r){return{type:a.s,sync:!0,execute({dispatch:i}){i(function(e,t){return{type:a.t,payload:{pageId:t,dialogContextId:e}}}(e,t)),n.replaceState&&(i(u(e,r,n.targetBrowsingContext)),i(Object(c.f)(r)))}}}function u(e,t,n){return{type:a.o,sync:!0,execute({dispatch:r,getState:o},s){r(function(e,t){return{type:a.p,payload:{dialogContextId:e,pageId:t}}}(e,t)),s.Router.removeDialogFromStack(t);const c=Object(i.a)(o(),e);c&&0===c.pageStack.length&&(r(p(e)),r(g(e,n)))}}}function d(e){return{type:a.e,sync:!0,execute({dispatch:t,getState:n},r){const a=Object(o.a)(n(),e);for(const n in a.dialogContextIds)t(p(n)),t(g(n,e))}}}function p(e){return{type:a.d,payload:{dialogContextId:e}}}function f(e,t,n,c){return{type:a.h,sync:!0,execute({dispatch:l,getState:u}){if(Object(i.d)(u())[e])throw Object(r.d)("Dialog context id already been used",2415919107,[{name:"id",value:e}]);c||(c=Object(o.g)(u())),n=n||Object(s.c)(u(),c),l(function(e,t){return{type:a.a,payload:{dialogContextId:e,browsingContextId:t}}}(e,c)),l(function(e,t,n){return{type:a.i,payload:{dialogContextId:e,pageId:t,sourcePageId:n}}}(e,t,n))}}}function g(e,t){return{type:a.n,payload:{dialogContextId:e,browsingContextId:t}}}},tHOi:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n("Uv1Y");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e){return{type:"create.user.personalization",execute:({dispatch:t,getState:n},a)=>function(e,t){return e.createUserPersonalization(t).nativePromise().catch(r.b)}(a.DataSource,e).then(e=>e)}}function i(e){return{type:"retrieve.user.personalization",execute:({dispatch:t,getState:n},a)=>function(e,t){return e.retrieveUserPersonalization(t).nativePromise().catch(r.b)}(a.DataSource,e).then(e=>e,e=>null)}}},tHaS:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("HYaY"),a=n("nTyX");class i{constructor(e,t,n){this._entityLogicalName=null,this._attributeLogicalName=null,this._innerValue=null,this._entityLogicalName=e,this._attributeLogicalName=t,this._attributeType=n,this._innerValue=null}get_entityLogicalName(){return this._entityLogicalName}get_attributeLogicalName(){return this._attributeLogicalName}get_attributeType(){return this._attributeType}get_value(){return this._innerValue}set_value(e){return this._innerValue=e,e}getObjectData(){return{entityLogicalName:this._entityLogicalName,attributeLogicalName:this._attributeLogicalName,attributeType:Object(a.e)(this._attributeType),value:r.a.InternalGetFieldObjectData(this._innerValue,this._attributeType)}}static createFromObjectData({attributeLogicalName:e,entityLogicalName:t,attributeType:n,value:o}){const s=Object(a.c)(n),c=new i(t,e,s);return c.set_value(r.a.InternalCreateFieldFromObjectData(o,s)),c}}i.__typeName="Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.AliasedValue"},tHtE:function(e,t,n){"use strict";n.d(t,"e",(function(){return I})),n.d(t,"c",(function(){return v})),n.d(t,"a",(function(){return S})),n.d(t,"b",(function(){return O})),n.d(t,"d",(function(){return w}));var r=n("x0oY"),a=n("vNXc"),i=n("odYE"),o=n("LbMF"),s=n("iZ7K"),c=n("cetF"),l=n("WF3G"),u=n("wMH2"),d=n("jxo7"),p=n("504W"),f=n("eruq"),g=n("XvL5"),h=n("2F73"),m=n("l3Ef"),b=n("ZPAw"),y=n("/A0C"),_=n("8nT0");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function v(e,t,n){return{type:"DESERIALIZE_FETCHXML_WEB_RESPONSE_ASYNC",execute:({dispatch:r,getState:i},o)=>e.json().then(e=>{const o=a.a.fromXml(t.get_query()).getKeyQuery();if(e&&e.value&&0===e.value.length){const t=E(e,o,[]);return new d.a(t)}return(t=>r(O(o,t,e,n)).then(e=>new d.a(e)))(I(i(),o))})}}function S(e,t,n,a,i,u,d,p=r.b.OData,f,g){let h=t instanceof l.a?t.get_EntityLogicalName():t.entityLogicalName,m=!1;Object(c.c)(h)&&(h=Object(c.b)(h),m=!0);const b=Object(s.h)(e,h),y=Object(o.d)(e,h),_=t instanceof l.a?t.GetColumnNamesFromFetch():t.columnNames,v=t instanceof l.a?t.get_ColumnSet():P(t);n&&n.additionalColumns&&n.additionalColumns.map(e=>{_.push(e)});return E(a,t,C(a,p).map(t=>Object(r.d)(e,t,b,y,_,v,null,n,d,p,null,null==n?void 0:n.aliasedNavigationProperties,m)),i,u,f,g)}function O(e,t,n,a,i,o,s,c=r.b.OData,u,d){return{type:"DESERIALIZE_ENTITY_COLLECTION_ASYNC",execute({dispatch:p,getState:f},g){const h=e instanceof l.a?e.get_EntityLogicalName():e.entityLogicalName,m=e instanceof l.a?e.GetColumnNamesFromFetch():e.columnNames,b=e instanceof l.a?e.get_ColumnSet():P(e),y=C(n,c).map(e=>p(Object(r.e)(e,h,a,m,b,null,t,s,c)));return Promise.all(y).then(t=>E(n,e,t,i,o,u,d))}}}function C(e,t){let n=null;if(t===r.b.SQL&&e.rows&&e.rows.length){n=[];for(let t=0;t<e.rows.length;t++)n.push(e.rows.item(t))}else n=t===r.b.OData&&e&&e.value&&e.value.length?e.value:[];return n}function E(e,t,n,r,a,i,o){if(Object(p.a)(o)&&(o=e["@Microsoft.Dynamics.CRM.totalrecordcountlimitexceeded"]||!1),o?r=-1:Object(p.a)(r)&&(r=e["@Microsoft.Dynamics.CRM.totalrecordcount"]||n.length),Object(p.a)(i)&&(i=e["@Microsoft.Dynamics.CRM.morerecords"]),!a){const t=e["@Microsoft.Dynamics.CRM.fetchxmlpagingcookie"];if(t){const e=Object(f.b)(t);(a=null==e?void 0:e.documentElement.getAttribute("pagingcookie"))&&(a=decodeURIComponent(decodeURIComponent(a)))}}return new u.a(n,i,r,o,t,null,a)}function I(e,t){return w(e,t.get_FetchXml())}function w(e,t){const n={},r={},a={},o=(new DOMParser).parseFromString(t,"text/xml"),s=o.getElementsByTagName("entity"),c=s&&s[0]?s[0].getAttribute("name"):"",l=[],u=o.getElementsByTagName("link-entity");for(let t=0;t<u.length;++t){const o=u[t],s=o.getAttribute("alias"),d=o.getAttribute("name"),p=o.getElementsByTagName("attribute"),f=-1!==[m.w,m.C].indexOf(d),g=m.C===d;let h=null;if(p.length){if(f){const t=d===m.w?y.a.File:y.a.Image;h=o.getAttribute("to"),t===y.a.Image&&(h=h.replace(/id$/,""));const n=Object(b.a)(e,new i.a(c),h,t),r=t===y.a.Image?s+".imagedescriptorid":h;a[h]={alias:s,navigationPropertyName:n,idField:r,columnNames:[]}}for(let e=0;e<p.length;++e){const t=p.item(e).getAttribute("name"),i="_x002e_",o=`${s}.${t}`,c=`${s}${i}${t}`;n[o]={alias:s,aliasedValueEtn:d,aliasedValueFieldName:t,oDataAlias:[o,c],oDataSeparator:[".",i]},n[c]={alias:s,aliasedValueEtn:d,aliasedValueFieldName:t,oDataAlias:[c,o],oDataSeparator:[i,"."]},r.hasOwnProperty(d)?r[d].push(t):r[d]=[t],f&&a[h].columnNames.push(o)}f&&j(n,r,d,s,h,l,a,_.c),g&&j(n,r,d,s,h,l,a,_.d)}}const d=o.querySelectorAll("entity > attribute[alias]");for(let e=0;e<d.length;++e){const t=d[e],r=t.getAttribute("alias"),a=t.getAttribute("name"),i=t.getAttribute("rowaggregate"),o=!0;n[""+a]={alias:r,aliasedValueEtn:c,aliasedValueFieldName:a,oDataAlias:[""+r],oDataSeparator:[""],isAttributeAlias:o,rowaggregate:i}}return{aliasedValueDescriptors:n,entity2AttributesMap:r,aliasedNavigationProperties:a,additionalColumns:l}}function j(e,t,n,r,a,i,o,s){const c=`${r}.${s}`;i.push(c),o[a].columnNames.push(c),e[c]={alias:r,aliasedValueEtn:n,aliasedValueFieldName:s,oDataAlias:[c],oDataSeparator:[]},t.hasOwnProperty(n)?t[n].push(s):t[n]=[s]}function P(e){return e.isAllColumns?h.a.get_instance():new g.a(e.columnNames)}},tICD:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));function r(e){return{type:"router.retrieve_page_output.async",execute:({dispatch:t},n)=>n.Router.getPageOutputPromise(e)}}},"tJ+6":function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s}));var r=n("Lyxw"),a=n("3/02"),i=n("E5IU");function o(e){return e?e.designLanguage:null}function s(e){var t;const n=null!==(t=Object(i.i)("EnableDesignLanguageThemeSystem",e))&&void 0!==t&&t;return Object(r.e)(e,a.rb,a.jf,a.nh)||n}},tOh6:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("oT5e");function a(e,t){return{type:"create.popup.async",execute({dispatch:n,getState:a},i){const o=i.Router,s=Object(r.f)(a());return o.addPopup(e,s.id,t),Promise.resolve()}}}},tT9w:function(e,t,n){"use strict";n.d(t,"b",(function(){return m})),n.d(t,"a",(function(){return g}));var r=n("pgSX"),a=n("si7p"),i=n("Uv1Y"),o=n("ngeo"),s=n("YxC/"),c=n("EY5k"),l=n("tICD"),u=n("8MGk"),d=n("E8F2"),p=n("zsAz"),f=n("RiLc");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const g="0x80050110",h={type:"error"};function m(e,t=!1,n){const m=[],_=e.errorRegion;return{type:"form.server.error.dialog",execute(v,S,O){e=new i.a(e.message,e.errorCode,e.exception,e.innerError,e.errorSource,e.errorFault,e.details,null,null,null,null,null,null,null,null,null,null,null,e.date,e.errorAnnotations);const C="0x"+o.a.getHexErrorCodeFromInt(e.errorCode),E="Error_Title_"+C,I="Error_Message_"+C,w=[E,I,"SolutionWizard.Button.Export.Tooltip","Button_Label_OK","Web.Dialog.ErrorCode_Caption","Error_Title_0x8004b056","Error_Title_0x80700000","L_Show_Details_Text","L_Client_Session_Id","L_Server_Activity_Id","L_Current_Time","Error_Title_Generic","Error_Message_Incorrect_Error_Code","L_Help_Label_Text"],j=["Error_Title_Generic","Error_Message_Incorrect_Error_Code"],P=S.TraceManager.getTracer("Forms.ServerErrorDialog");return v.dispatch(Object(c.e)(w)).then(()=>{const i=Object(s.e)(v.getState(),w);let c=Object(s.c)(i,E);const d=Object(s.c)(i,"Error_Title_Generic");c=c||d;const O=Object(s.c)(i,I),j=Object(s.c)(i,"Error_Message_Incorrect_Error_Code"),T=function(e,t,n,r,a,i){let o;const s=Object(p.h)(n||r,t);"0x80040265"===e?t.innerError&&t.innerError.message?o=""+t.innerError.message:t.message&&(o=""+t.message):"0x80043e08"===e&&t.message||"0x8003f454"===e&&t.message?o=t.message:"0x80044331"===e||e===g?o=n||r:t.message&&a?o=""+t.message:s&&!s.includes("{0}")?o=s:t.message&&(s&&s.includes("{0}")||!n)?(o=""+t.message,i.info("Failed to localized server error as the message contains params, for error code: "+t.errorCode+" errorMessage: "+t.message)):o=n;return o}(C,e,O,j,t||!1,P),N=Object(s.c)(i,"SolutionWizard.Button.Export.Tooltip"),A=Object(s.c)(i,"Button_Label_OK"),R=Object(s.c)(i,"Web.Dialog.ErrorCode_Caption"),D=Object(s.c)(i,"L_Show_Details_Text"),x=Object(s.c)(i,"L_Client_Session_Id"),M=Object(s.c)(i,"L_Current_Time"),F=Object(s.c)(i,"L_Server_Activity_Id"),k=Object(s.c)(i,"L_Help_Label_Text"),L=R+" "+C,B=x.replace("{0}",S.EventManager.getCurrentSessionId()),U=F.replace("{0}",S.EventManager.getActivityId()),V=M.replace("{0}",""+new Date),z=[L,B,U,V];m.push({name:"errorTitle",value:c},{name:"errorMessage",value:T},{name:"errorCodeContainer",value:L});const q={errorCode:o.a.getHexErrorCodeFromInt(e.errorCode),errorRegion:_,dynamicHelpLabel:k};return v.dispatch(Object(r.a)(a.d,L,h,N,c,T,A,D,z,!e.errorFault&&!e.details,n,q)).then(t=>{if(0===t.status)return v.dispatch(Object(l.a)(t.pageId)).then(t=>{if(t.value.confirmed){const t=function(e,t,n,r){const a=n.TraceManager.getTracer("Forms.ServerErrorDialog.DownloadLog");let i="";if(e){e.message&&e.errorCode&&e.getNegativeErrorCode?(i+="Exception Message: "+e.message,i+="\n\nErrorCode: "+e.getNegativeErrorCode(),i+="\nHexErrorCode: 0x"+o.a.getHexErrorCodeFromInt(e.errorCode)):a.warn("Unable to get error.message or error.errorCode",r);const t=Object(p.e)(e);if(e.details)e.errorFault?i+="\nCall Stack: "+e.errorFault.get_innerFault().get_callStack():i+="\nError Details: "+e.details;else if(t){const e={},n=new Map([[f.a,e]]);for(const[e,r]of Object.entries(t))y(e,r,n);for(const[t,n]of Object.entries(e))"InnerError"!==t&&(i+="\n\n"+t+": ",i+="TraceText"===t?"\n\t"+n.replace(/\n/g,"\n\t").trim():"object"==typeof n?b(n,"",0):n)}else a.warn("No annotations were retrieved",r)}else a.warn("The error object is null or undefined",r);t&&(i+="\n\n"+t.join("\n"));return n.EventManager.ReportComponentSuccess("Forms.ServerErrorDialog.DownloadLog",r),i}(e,[U],S,m),n={mimeType:"text/plain",fileName:"ErrorDetails.txt",fileContent:btoa(unescape(encodeURIComponent(t))),fileSize:t?t.length:0},r={openMode:2};new u.a(S,v).openFile(n,r)}});throw t.error})},e=>{if(!Object(d.e)(e)){const t=JSON.stringify(e);m.push({name:"originalError",value:t})}v.dispatch(Object(c.e)(j)).then(()=>{const e=Object(s.e)(v.getState(),j),t=Object(s.c)(e,"Error_Title_Generic"),i=Object(s.c)(e,"Error_Message_Incorrect_Error_Code");m.push({name:"titleLabel",value:t},{name:"messageLabel",value:i}),v.dispatch(Object(r.a)(a.d,"",h,"",t,i,void 0,void 0,void 0,void 0,n)).then(e=>e)})})},getFailureParameters:(e,t)=>m}}function b(e,t,n){n++;for(const[r,a]of Object.entries(e))"object"==typeof a?t=b(a,t+"\n"+"\t".repeat(n)+r+": ",n):t+="\n"+"\t".repeat(n)+r+": "+a;return t}function y(e,t,n){const r=e.lastIndexOf("."),a=e.substring(0,r),i=e.substring(r+1);if(n.has(a))n.get(a)[i]=t;else{const e={[i]:t};n.set(a,e),y(a,e,n)}}},tWr6:function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return u}));var r=n("+Qpx"),a=n("pEXn"),i=n("arV0"),o=n("SAYH"),s=n("zmL5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const c="Value is removed for security reasons";function l(e,t,n){try{const i=Object.assign({},n);if(e===a.r.Name){const e=t[a.g.ComponentName].toString();(null==e?void 0:e.indexOf(`${r.u}${r.z}`))>=0?i[r.z]&&(i[r.z]=function(e){const t=e&&JSON.parse(e);let n=!1;return null==t||t.forEach(e=>{var t;(null===(t=e.event)||void 0===t?void 0:t.errorMessage)&&(n=!0,e.event=Object.assign(Object.assign({},e.event),{errorMessage:"Error message is sanitized as it could be thrown from custom scripts."}))}),n?JSON.stringify(t):e}(i[r.z])):e===`${r.u}${r.I}`?i[r.I]&&(i[r.I]=function(e){var t,n;const r=e&&JSON.parse(e),a=null===(t=null==r?void 0:r[1])||void 0===t?void 0:t["All attributes modified"],i=null===(n=null==r?void 0:r[2])||void 0===n?void 0:n["Unsaved changes"];for(const e in a){const t=a[e];for(const e in t)t[e]=c}for(const e in i){const t=i[e];for(const e in t){const n=t[e];for(const e of n)e.newValue=c,e.previousValue=c}}return JSON.stringify(r)}(i[r.I])):e===`${r.u}${r.s}`?i[r.s]&&(i[r.s]=function(e){const t=e&&JSON.parse(e);for(const e in t){const n=t[e];for(const e of n)e["Control Value"]=c,e["Source of the default value"]=c}return JSON.stringify(t)}(i[r.s])):e===`${r.u}${r.A}`?i[r.A]&&(i[r.A]=function(e){const t=e&&JSON.parse(e);for(const e of t)"Invalid Parameter Value"===e.name&&(e.value=c);return JSON.stringify(t)}(i[r.A])):e===`${r.u}${r.F}`&&i[r.F]&&(i[r.F]="<sanitized>")}return i}catch(e){return n}}function u(e,t){const n=Object(i.j)(e,t),r=Object(s.b)(e,t);return[{name:"entityTypeName",value:null==n?void 0:n.entityTypeName},{name:"formId",value:o.a.toString(r)}]}},tZZc:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.Success=1]="Success",e[e.Deleted=2]="Deleted",e[e.Error=3]="Error"}(r||(r={}))},thZs:function(e,t,n){"use strict";n.d(t,"a",(function(){return _})),n.d(t,"d",(function(){return v})),n.d(t,"c",(function(){return S})),n.d(t,"b",(function(){return O}));var r=n("Uv1Y"),a=n("Znul");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class i{constructor(e){this.LookupDataRequest=e}getMetadata(){return{boundParameter:null,operationName:"RetrieveLookupData",operationType:1,parameterTypes:{LookupDataRequest:{typeName:"Microsoft.Dynamics.CRM.LookupDataRequest",structuralProperty:2}}}}}var o=n("sNgR"),s=n("SRlt"),c=n("u2Wk"),l=n("eXjw"),u=n("SAYH");function d(e){if(!(e&&e.Metadata&&e.Metadata.Entity&&e.Metadata.View))return null;const t={Initialized:l.a.Partial,IsReadOnlyInMobileClient:e.Metadata.Entity.IsReadOnlyInMobileClient,IsEnabledInUnifiedInterface:e.Metadata.Entity.IsEnabledInUnifiedInterface,DisplayName:e.Metadata.Entity.DisplayName,PrimaryNameAttribute:e.Metadata.Entity.PrimaryNameAttribute,EntityLogicalName:e.Metadata.Entity.LogicalName,DisplayCollectionName:e.Metadata.Entity.DisplayCollectionName,IconVectorName:e.Metadata.Entity.IconVectorName,PrimaryKeyName:e.Metadata.Entity.PrimaryIdAttribute,PrimaryIdAttribute:e.Metadata.Entity.PrimaryIdAttribute},{viewColumns:n,attributesByName:r}=function(e){const t=[],n={};for(const r of e){const e={alias:r.Alias,format:r.Format,dataType:r.DataType,logicalName:r.AttributeLogicalName,entityLogicalName:r.EntityLogicalName};t.push(e);const a={Initialized:l.a.Partial,LogicalName:r.AttributeLogicalName,EntityLogicalName:r.EntityLogicalName,Type:r.DataType,Format:r.Format};n[a.LogicalName]=a}return{viewColumns:t,attributesByName:n}}(e.Metadata.View.Columns),a={viewId:p(e.Metadata.View.ViewId),viewName:e.Metadata.View.ViewName,columns:n,fetchXml:e.Metadata.View.FetchXml,layoutJson:e.Metadata.View.LayoutJson};t.AttributeNames=Object.keys(r);return{lookupMetadata:{initialized:l.a.Initialized,entity:t,view:a},entity:t,attributesByName:r}}function p(e){return"string"==typeof e?new u.a(e):e}var f=n("tHtE"),g=n("vNXc"),h=n("E3i9"),m=n("HfZT");function b(e,t){if(e.LookupEntityByName){const n=e.LookupEntityByName.find(e=>e.EntityLogicalName===t);if(n)return n.PagingInfo}return null}var y=n("KXDI");const _="retrieve.lookup";function v(e,t=!1){return{type:"retrieve.lookup.async",execute({dispatch:t,getState:n},a){const c=n(),l=e.ReturnMetadata&&S(c,e);return t(function(e){const t={};e&&(t.metadata={lookup:{[e]:{}}});return{type:_,payload:t}}(l)),function(e,t,n){const a=new i(n);return t(Object(o.b)(a)).then(e=>Object(s.g)(e).then(e=>{if(e.Result)return e.Result;throw e})).catch(r.b)}(0,t,e).then(r=>{r&&e.ReturnMetadata&&t(function(e,t,n,r){const a=S(e(),n),i=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t){const n={},r={},a={},i={};if(e&&e.length)for(const t of e){const{lookupMetadata:e,entity:a,attributesByName:o}=d(t);i[e.entity.EntityLogicalName]=e,n[e.entity.EntityLogicalName]=a,r[e.entity.EntityLogicalName]=o}return a[t]=i,{lookup:a,entities:n,attributes:r}}(r.EntityResponses,a);return{type:_,payload:i}}(n,0,e,r)),r&&t(function(e,t,n,r){let a=null;r&&r.EntityResponses&&(a=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t,n,r){const a={},i={},o=S(e,r);if(n&&n.length)for(const s of n){const n=Object(h.c)(e,o,s.EntityLogicalName),c=n&&n.fetchXml,l=n&&n.viewId,u=O(e,s.EntityLogicalName,r),d=g.a.fromXml(c,l),p=b(r,s.EntityLogicalName);d.pageSize=p?p.Count:g.a.defaultPageSize,d.pageNumber=p?p.PageNumber:1;const y=Object(f.e)(e,d.getKeyQuery()),_=Object(f.a)(e,d.getKeyQuery(),y,{value:s.Data},s.TotalRecordCount,s.PagingCookie),v=Object(m.f)(e,t,u,d,_);if(v&&v.payload){if(v.payload.entities)for(const e in v.payload.entities)a[e]=v.payload.entities[e];if(v.payload.lists)for(const e in v.payload.lists)i[e]=v.payload.lists[e]}}return{entities:a,lists:i}}(e(),t,r.EntityResponses,n));return{type:m.b,payload:a}}(n,t,e,r))}).catch(e=>{Object(r.b)(e)})}}}function S(e,t){const n=new a.a([],t.EntityAndAttribute,t.AppId,null,null,t.ReturnMetadata);if(null!=t.LookupEntityByName)for(const e of t.LookupEntityByName){const t=new c.a(e.EntityLogicalName,e.ViewId,e.CustomFilter,e.RelationshipName,e.FetchXml,e.LayoutJson,null);n.LookupEntityByName.push(t)}return Object.keys(n).filter(e=>"ReturnMetadata"!==e).map(t=>Object(y.c)(e,n,t)).join(":")}function O(e,t,n){const r=S(e,n);return`${t}:${n.QueryString||""}:${r}`}},thzq:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.Create=1]="Create",e[e.Delete=2]="Delete",e[e.Update=3]="Update",e[e.Retrieve=4]="Retrieve"}(r||(r={}))},ti3l:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.create=0]="create",e[e.update=1]="update",e[e.Delete=3]="Delete"}(r||(r={}))},tlcF:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n("9L53"),a=n("jhff"),i=n("UqMU"),o=n("zsAz"),s=n("oT5e"),c=n("Fgw8");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class l{constructor(e,t){this._store=e,this._tracer=t.getTracer("InternalHistoryManager")}HistoryBack(e){if(!e||!e.targetBrowsingContext)throw Object(o.d)("InternalHistoryManager tried to invoke historyback for invalid tab",2415919109);{if(this.GetHistoryLength(e)<=1)throw Object(o.d)("InternalHistoryManager: there are no more pages in history stack to go back to",2415919117);this._store.dispatch(Object(i.c)(e.targetBrowsingContext));const t=Object(s.a)(this._store.getState(),e.targetBrowsingContext).history,n=t[t.length-1],a=new r.a;a.state=n.state,this._onPop(a,e)}}ClearHistory(e){let t;e&&e.targetBrowsingContext?t=e.targetBrowsingContext:(t=Object(a.a)(this._store.getState()).id,this._tracer.warn("Navigation options is not provided to InternalHistoryManager ClearHistory method, clearing history of active tab")),this._store.dispatch(Object(i.b)(t))}PushState(e,t,n){if(!n||!n.targetBrowsingContext)throw Object(o.d)("InternalHistoryManager tried to push state to invalid tab",2415919109);this._store.dispatch(Object(i.a)(n.targetBrowsingContext,e,t)),n.resetHistory&&this._store.dispatch(Object(i.b)(n.targetBrowsingContext))}ReplaceState(e,t,n){if(!n||!n.targetBrowsingContext)throw Object(o.d)("InternalHistoryManager tried to replace state of invalid tab",2415919109);this._store.dispatch(Object(i.e)(n.targetBrowsingContext,e,t))}RegisterOnPopState(e){this._onPop=e}RegisterOnBeforeUnload(e){this._onBeforeUnload=e,window.addEventListener("beforeunload",e)}Dispose(){window.removeEventListener("beforeunload",this._onBeforeUnload),this._onPop=void 0,this._onBeforeUnload=void 0}GetHistoryLength(e){return Object(c.a)(this._store.getState(),e,this._tracer).history.length}GetState(e){return this._getCurrentHistoryEntry(e=>e.state,e)}GetCurrentUrl(e){return this._getCurrentHistoryEntry(e=>e.url,e)}_getCurrentHistoryEntry(e,t){const n=Object(c.a)(this._store.getState(),t,this._tracer);if(n.history){const t=n.history[n.history.length-1];if(t)return e(t)}}}},tpyD:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return(0,i.default)(e)+":"+t};var r,a=n("SzHS"),i=(r=a)&&r.__esModule?r:{default:r}},tr5s:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t="";for(var n in e){var r=e[n];"string"!=typeof r&&"number"!=typeof r||(t&&(t+=";"),t+=(0,i.default)(n,r))}return t};var r,a=n("tpyD"),i=(r=a)&&r.__esModule?r:{default:r}},"txA/":function(e,t,n){"use strict";n.d(t,"gb",(function(){return a})),n.d(t,"m",(function(){return i})),n.d(t,"n",(function(){return o})),n.d(t,"l",(function(){return s})),n.d(t,"y",(function(){return c})),n.d(t,"A",(function(){return l})),n.d(t,"z",(function(){return u})),n.d(t,"ib",(function(){return d})),n.d(t,"hb",(function(){return p})),n.d(t,"pb",(function(){return f})),n.d(t,"lb",(function(){return g})),n.d(t,"nb",(function(){return h})),n.d(t,"qb",(function(){return m})),n.d(t,"mb",(function(){return b})),n.d(t,"ob",(function(){return y})),n.d(t,"kb",(function(){return _})),n.d(t,"jb",(function(){return v})),n.d(t,"g",(function(){return S})),n.d(t,"h",(function(){return O})),n.d(t,"w",(function(){return C})),n.d(t,"x",(function(){return E})),n.d(t,"v",(function(){return I})),n.d(t,"eb",(function(){return w})),n.d(t,"s",(function(){return j})),n.d(t,"db",(function(){return P})),n.d(t,"p",(function(){return T})),n.d(t,"q",(function(){return N})),n.d(t,"r",(function(){return A})),n.d(t,"o",(function(){return R})),n.d(t,"i",(function(){return D})),n.d(t,"j",(function(){return x})),n.d(t,"tb",(function(){return M})),n.d(t,"ub",(function(){return F})),n.d(t,"rb",(function(){return k})),n.d(t,"sb",(function(){return L})),n.d(t,"t",(function(){return B})),n.d(t,"Y",(function(){return U})),n.d(t,"k",(function(){return V})),n.d(t,"c",(function(){return z})),n.d(t,"a",(function(){return q})),n.d(t,"cb",(function(){return H})),n.d(t,"b",(function(){return W})),n.d(t,"d",(function(){return G})),n.d(t,"e",(function(){return K})),n.d(t,"bb",(function(){return Q})),n.d(t,"D",(function(){return X})),n.d(t,"E",(function(){return Y})),n.d(t,"C",(function(){return J})),n.d(t,"Z",(function(){return $})),n.d(t,"B",(function(){return Z})),n.d(t,"Q",(function(){return ee})),n.d(t,"R",(function(){return te})),n.d(t,"S",(function(){return ne})),n.d(t,"L",(function(){return re})),n.d(t,"J",(function(){return ae})),n.d(t,"K",(function(){return ie})),n.d(t,"I",(function(){return oe})),n.d(t,"G",(function(){return se})),n.d(t,"H",(function(){return ce})),n.d(t,"F",(function(){return le})),n.d(t,"P",(function(){return ue})),n.d(t,"O",(function(){return de})),n.d(t,"U",(function(){return pe})),n.d(t,"V",(function(){return fe})),n.d(t,"W",(function(){return ge})),n.d(t,"X",(function(){return he})),n.d(t,"N",(function(){return me})),n.d(t,"M",(function(){return be})),n.d(t,"f",(function(){return ye})),n.d(t,"fb",(function(){return _e})),n.d(t,"ab",(function(){return ve})),n.d(t,"u",(function(){return Se})),n.d(t,"T",(function(){return Oe}));var r=n("nJrx");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="Session.UpdateHomeSessionTitleSync",i="session.CreateSessionAsync",o="session.CreateSessionInternalAsync",s="session.CreateSession",c="session.FocusTab",l="session.FocusTabSync",u="session.FocusTabInternal",d="session.UpdateSessionCloseableSync",p="session.UpdateSessionCloseableInternal",f="session.UpdateSessionTitle",g="session.UpdateSessionIcon",h="session.UpdateSessionIconTitle",m="session.UpdateSessionTitleSync",b="session.UpdateSessionIconSync",y="session.UpdateSessionIconTitleSync",_="session.UpdateSessionFocusRequestedSync",v="session.UpdateSessionFocusRequestedInternal",S="session.CloseSession",O="session.CloseSessionAsync",C="session.FocusSessionSync",E="session.FocusSessionInternalSync",I="session.FocusSession",w="session.CloseSessionConfirmationDialog",j="session.ExecuteCreateHandlersAsync",P="session.NavigateInternal",T="session.CreateTabStateInternal",N="session.CreateTabWithPageInputAsync",A="session.CreateTabWithSitemapDescriptorAsync",R="session.CreateTabAndNavigateInternal",D="session.CloseTab",x="session.CloseTabAsync",M="session.updateTabTitle",F="session.updateTabTitleSync",k="session.tabCanClose",L="session.tabCanCloseAsync",B="session.ExecuteTabHandlers",U="session.NavigateBackInTab",V="session.CloseTabInternal",z="session.cleanupSession",q="session.addHistory",H="session.replaceTopHistory",W="session.backNavigationHistory",G="session.clearHistory",K="session.clearHistorySync",Q="browsing.replaceHistory",X=10,Y=10,J=7,$=Object(r.a)(),Z="Menu_Label_Home",ee="MultiSession.NewTabInformationLabel",te="MultiSession.NewTabMenuAriaLabel",ne="MultiSession.NewTabMenuTooltip",re="MultiSession.CloseTabTooltip",ae="MultiSession.CloseTabAriaLabel",ie="MultiSession.CloseTabDescribedBy",oe="MultiSession.CloseSessionTooltip",se="MultiSession.CloseSessionAriaLabel",ce="MultiSession.CloseSessionDescribedBy",le="MultiSession.ActivityIndicatorDescribedBy",ue="MultiSession.NavigateBackButtonTooltip",de="MultiSession.NavigateBackButtonAriaLabel",pe="MultiSession.ScrollLeft",fe="MultiSession.ScrollRight",ge="MultiSession.NewSessionLoadingTitle",he="MultiSession.NewTabLoadingTitle",me="MultiSession.CloseSessionDialogTitle",be="MultiSession.CloseSessionDialogDescription",ye="close-button",_e="tab-header-inner",ve="no-tab-navigation",Se="focused",Oe=[Z,he,ge,oe,se,ce,re,ae,ie,le,ee,te,ne,ue,de,pe,fe]},"u+q+":function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"e",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return c}));var r=n("FbdD");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a=r.c,i=r.e,o=r.f,s=r.d,c=r.b},u2Wk:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class r{constructor(e,t,n,r,a,i,o){this.EntityLogicalName=e,this.ViewId=t,this.CustomFilter=n,this.RelationshipName=r,this.FetchXml=a,this.LayoutJson=i,this.PagingInfo=o}getMetadata(){return{boundParameter:null,operationName:null,operationType:null,parameterTypes:{EntityLogicalName:{typeName:"Edm.String",structuralProperty:1},ViewId:{typeName:"Edm.Guid",structuralProperty:1},CustomFilter:{typeName:"Edm.String",structuralProperty:1},RelationshipName:{typeName:"Edm.String",structuralProperty:1},FetchXml:{typeName:"Edm.String",structuralProperty:1},LayoutJson:{typeName:"Edm.String",structuralProperty:1},PagingInfo:{typeName:"Microsoft.Dynamics.CRM.PagingInfo",structuralProperty:2}}}}}},uAcA:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * The unique name of the OfflineStatusDialog page module.
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="OfflineStatusDialog"},uAlF:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return s}));var r=n("504W");let a=null;function i(e){Object(r.a)(a)&&(a=e)}function o(e){a.updateResources(e)}function s(e,t){const n=function(e){let t=e;t<0&&(t=t+4294967295+1);const n=t.toString(16);return"Error_Message_0x"+n}(e);return a.getErrorMessage(n,t)}},uCpV:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s}));var r=n("E5IU"),a=n("pgj4"),i=n("5bWN");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const o="recentItem.add";function s(e){return{type:"recentItem.add.sync",sync:!0,execute(t,n){const s=Object(r.d)(t.getState()),c=Object(a.a)(s);Object(i.a)(e,n)&&c.includes(e.EntityTypeName)&&(t.dispatch(function(e){return{type:o,payload:e}}(e)),n.RecentItemsSyncManager.notifyRecentItemsUpdate())}}}},uIhY:function(e,t,n){"use strict";n.d(t,"a",(function(){return y})),n.d(t,"b",(function(){return O})),n.d(t,"g",(function(){return E})),n.d(t,"f",(function(){return _})),n.d(t,"e",(function(){return S})),n.d(t,"c",(function(){return v})),n.d(t,"d",(function(){return I}));var r=n("odYE"),a=n("504W"),i=n("SAYH"),o=n("d7fm"),s=n("iZ7K"),c=n("5Oca"),l=n("LbMF"),u=n("Ae6N"),d=n("x0oY"),p=n("/A0C"),f=n("g03H"),g=n("Lyxw"),h=n("3/02"),m=n("z+5+"),b=n("vSoM");const y=["Edm.Boolean","Edm.String","Edm.Byte","Edm.Decimal","Edm.Double","Edm.Int16","Edm.Int32","Edm.Int64","Edm.SByte","Edm.Single","Edm.Date","Edm.Guid","Edm.DateTimeOffset","Edm.Duration","Edm.Stream","Edm.Binary","Edm.TimeOfDay","Edm.Geography","Edm.GeographyPoint","Edm.GeographyLineString","Edm.GeographyPolygon","Edm.GeographyMultiPoint","Edm.GeographyMultiLineString","Edm.GeographyMultiPolygon","Edm.GeographyCollection","Edm.Geometry","Edm.GeometryPoint","Edm.GeometryLineString","Edm.GeometryPolygon","Edm.GeometryMultiPoint","Edm.GeometryMultiLineString","Edm.GeometryMultiPolygon","Edm.GeometryCollection"];function _(e,t,n=!1,r=!1,o){if(Object(a.a)(t))return null==o||o.warn("No parameter value provided for entity type parameter"),"null";if("object"==typeof t&&"entityType"in t&&"id"in t){const a=function(e,t,n){if(n){const n=Object(s.h)(e,t.entityType);return{"@odata.type":"Microsoft.Dynamics.CRM."+t.entityType,[n.PrimaryKeyName]:i.a.fromExternalGuid(t.id).guid}}return{"@odata.id":`${Object(s.o)(e,t.entityType)}(${i.a.fromExternalGuid(t.id).guid})`}}(e,t,n),o=JSON.stringify(a);return r?v(o):o}const c=JSON.stringify(t);return r?v(c):c}function v(e,t=!1){let n=e;if(t&&"string"==typeof n&&-1!==n.indexOf('"')&&(n=n.replace(/^"/,'\\"'),n=n.replace(/([^\\])"/g,'$1\\"')),n=encodeURIComponent(n),-1!==n.indexOf("'")){const e=/\'/g;return n.replace(e,"''")}return n}function S(e,t){if(null==e||!t||!t.enumProperties||!t.enumProperties.length)return null;return t.enumProperties.filter(t=>t.value===e)[0]}function O(e,t,n=0){const a=t.get_identifier(),l=a.LogicalName;let u=[];if(t)if(0===n){const e=t.get_changedFieldNames();e&&(u=e)}else u=t.get_fieldNames();const d=u.reduce((r,a)=>{const i=E(e,l,a,t,n),o=Object.keys(r),s=Object.keys(i)[0];return o&&-1!==o.indexOf(s)&&i[s]&&i[s].length?(r[s]=r[s].concat(i[s]),r):Object.assign(i,r)},{}),p=Object(s.h)(e,l);if(p&&p.IsActivity){const t=Object(o.b)(l),n=u.filter(e=>t.indexOf(e)>-1),s=t.filter(e=>-1===n.indexOf(e));if(n.length&&s.length){const t=[],n=Object(c.b)(r.a.fromLegacyEntityReference(a))(e,l);if(n&&n.fields){const a="participationtypemask",o="partyid",c="addressused",l="activitypartyid";for(const u of s)if(u in n.fields){const s=n.fields[u].list.map(t=>{const n=t.fields[a]?Number(t.fields[a].valueString):0,s=t.fields[o];let u=null;if(Object(g.e)(e,h.Dh)){const e=t.fields[l];u=e&&!i.a.isNullOrEmpty(e.id)?i.a.toString(e.id):null}if(Object(g.e)(e,h.Fb))return{participationtypemask:n,activitypartyid:u};const d=s?s.reference:new r.a("unresolvedaddress",i.a.EMPTY,t.fields[c].value);return w(e,n,d,u)});t.push(...s)}}const o=C(e,l);o&&(d[o]?d[o].push(...t):0!==t.length&&(d[o]=t))}}const f=t.get_relatedEntities();return 1===n&&f&&f.get_entityCollections()&&f.get_entityCollections().forEach(t=>{const r=t.get_value().get_entities().map(t=>O(e,t,n)),a=r&&1===r.length&&Object(s.z)(e,l,t.get_key().get_schemaName())?r[0]:r;d[t.get_key().get_schemaName()]=a}),d}function C(e,t){const n=Object(s.b)(e,t);if(!n||!n.ReferencedEntityNavigationPropertyName)return null;return n.ReferencedEntityNavigationPropertyName}function E(e,t,n,c,f=0){let y=c.getValue(n);if(!e||!t||!n||void 0===y||1===f&&null===y)return{};let _=null;const v={},S=c.get_fieldTypes();let O=null;if(S[n]===p.a.AliasedValue){const t=y;_=t.get_attributeType(),v[n+"@OData.Community.Display.V1.AttributeName"]=t.get_attributeLogicalName(),O=Object(l.a)(e,t.get_entityLogicalName(),t.get_attributeLogicalName()),y=t.get_value()}else{if(O=Object(l.a)(e,t,n),!O)return{};_=O.Type}switch(_){case p.a.MultiSelectPickList:{if(Object(a.a)(y))return{};const e=Array.isArray(y)?y.length>0?y.join(","):null:y;if(e&&1===f){const e=O.OptionSet?O.OptionSet.length:0;v[Object(d.j)(n)]=y.map(t=>{for(let n=0;n<e;n++)if(t===O.OptionSet[n].Value)return O.OptionSet[n].Label;return""}).join(";")}return v[n]=e,v}case p.a.PartyList:{if(Object(a.a)(y))return{};const i=y.get_entities(),s=C(e,t);if(!s)return{};const c=Object(o.a)(t,n),l=i.map(t=>{const n=t.getValue("partyid");let a=null;if(Object(g.e)(e,h.Dh)){const e=t.getValue("activitypartyid");a=e?e.toString():null}const i=r.a.fromLegacyEntityReference(n);return w(e,c,i,a)});return v[s]=l,v}case p.a.Boolean:{if(Object(a.a)(y))return{};const e=y.get_ValueString();return 1===f&&(v[Object(d.j)(n)]=y.get_Label()),v[n]="0"===e||"1"===e?"1"===e:null,v}case p.a.PickList:case p.a.State:case p.a.Status:return Object(a.a)(y)?{}:(1===f&&(v[Object(d.j)(n)]=y.get_Label()),v[n]=y.getValue("value"),v);case p.a.Customer:case p.a.Lookup:case p.a.Owner:{const r=Object(d.l)(n);if(Object(a.a)(y))return{[r]:null};const o=y,c=Object(b.g)(e,o.LogicalName,"Lookup"),l=i.a.fromLegacyGuid(o.Id).guid;let u,g=null;if(_===p.a.Owner&&(g=Object(s.A)(e,t,"owner",n)),Object(a.a)(g)&&(g=Object(s.A)(e,t,o.LogicalName,n)),_===p.a.Owner&&Object(a.a)(g))return{};if(Object(a.a)(g))throw new Error(`Unable to find many-to-one relationship, entity: ${t}, referenced entity: ${u}, field: ${n}`);return 0===f?(v[I(g.ReferencingEntityNavigationPropertyName)]=`/${c}(${l})`,Object(m.k)(e)&&(v[Object(d.j)(g.ReferencingEntityNavigationPropertyName)]=o.Name)):(v[Object(d.j)(r)]=o.Name,v[Object(d.k)(r)]=o.LogicalName,v[r]=l),v}case p.a.UniqueIdentifier:return Object(a.a)(y)?{}:(v[n]=i.a.fromLegacyGuid(y).guid,v);case p.a.Date:case p.a.DateTime:if(Object(a.a)(y))return{[n]:null};if(O.Behavior===u.a.DateOnly&&"function"==typeof y.toISOString){const e=y.toISOString().match(/(\d{4}-\d{2}-\d{2})T\d{2}\:\d{2}\:\d{2}\.\d{3}[+-Z]/i);e[1]&&(1===f&&(v[Object(d.j)(n)]=c.getFormattedValue(n)),v[n]=e[1])}else 1===f?(v[Object(d.j)(n)]=c.getFormattedValue(n),v[n]=y.toISOString().replace(/.\d{3}Z/,"Z")):v[n]=y;return v;case p.a.Money:case p.a.Decimal:case p.a.Double:case p.a.Integer:case p.a.BigInt:if(1===f){if(Object(a.a)(y))return{};v[Object(d.j)(n)]=c.getNumericFormattedValue(n)}return v[n]=y,v;default:return v[n]=y,v}}function I(e){return e+"@odata.bind"}function w(e,t,n,r){const i=n.id.guid,o=n.etn;if("unresolvedaddress"===o){const e={addressused:n.name,participationtypemask:t};return Object(f.l)(r)||(e.activitypartyid=r),e}const c=Object(s.o)(e,o),l=Object(s.b)(e,o);if(Object(a.a)(l))throw new Error(`Unable to find one-to-many relationship, entity: ${o}, referencing entity: activityparty`);const u={[l.ReferencingEntityNavigationPropertyName+"@odata.bind"]:`/${c}(${i})`,participationtypemask:t};return Object(a.a)(r)||(u.activitypartyid=r),u}},uM6Y:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"e",(function(){return o})),n.d(t,"f",(function(){return s})),n.d(t,"g",(function(){return c})),n.d(t,"h",(function(){return l})),n.d(t,"i",(function(){return u})),n.d(t,"k",(function(){return d})),n.d(t,"d",(function(){return p})),n.d(t,"j",(function(){return f}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="Application",a="ARContentManager",i="BarcodeManager",o="FeedbackManager",s="FileManager",c="GeoLocationManager",l="MediaContentManager",u="NavigationManager",d="Account",p="ExternalContext",f="Cordova"},uNu9:function(e,t,n){"use strict";n.d(t,"lb",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"y",(function(){return i})),n.d(t,"S",(function(){return o})),n.d(t,"f",(function(){return s})),n.d(t,"Zb",(function(){return c})),n.d(t,"ub",(function(){return l})),n.d(t,"Tb",(function(){return u})),n.d(t,"Ab",(function(){return d})),n.d(t,"Z",(function(){return p})),n.d(t,"Ib",(function(){return f})),n.d(t,"mb",(function(){return g})),n.d(t,"cb",(function(){return h})),n.d(t,"d",(function(){return m})),n.d(t,"Eb",(function(){return b})),n.d(t,"dc",(function(){return y})),n.d(t,"e",(function(){return _})),n.d(t,"tb",(function(){return v})),n.d(t,"b",(function(){return S})),n.d(t,"db",(function(){return O})),n.d(t,"xb",(function(){return C})),n.d(t,"wb",(function(){return E})),n.d(t,"Hb",(function(){return I})),n.d(t,"vb",(function(){return w})),n.d(t,"x",(function(){return j})),n.d(t,"A",(function(){return P})),n.d(t,"p",(function(){return T})),n.d(t,"q",(function(){return N})),n.d(t,"bc",(function(){return A})),n.d(t,"r",(function(){return R})),n.d(t,"hb",(function(){return D})),n.d(t,"C",(function(){return x})),n.d(t,"Y",(function(){return M})),n.d(t,"B",(function(){return F})),n.d(t,"eb",(function(){return k})),n.d(t,"o",(function(){return L})),n.d(t,"rb",(function(){return B})),n.d(t,"Ub",(function(){return U})),n.d(t,"Wb",(function(){return V})),n.d(t,"W",(function(){return z})),n.d(t,"X",(function(){return q})),n.d(t,"T",(function(){return H})),n.d(t,"Kb",(function(){return W})),n.d(t,"z",(function(){return G})),n.d(t,"Ob",(function(){return K})),n.d(t,"H",(function(){return Q})),n.d(t,"G",(function(){return X})),n.d(t,"sb",(function(){return Y})),n.d(t,"cc",(function(){return J})),n.d(t,"Mb",(function(){return $})),n.d(t,"I",(function(){return Z})),n.d(t,"Lb",(function(){return ee})),n.d(t,"Yb",(function(){return te})),n.d(t,"c",(function(){return ne})),n.d(t,"yb",(function(){return re})),n.d(t,"g",(function(){return ae})),n.d(t,"h",(function(){return ie})),n.d(t,"i",(function(){return oe})),n.d(t,"j",(function(){return se})),n.d(t,"k",(function(){return ce})),n.d(t,"l",(function(){return le})),n.d(t,"m",(function(){return ue})),n.d(t,"n",(function(){return de})),n.d(t,"s",(function(){return pe})),n.d(t,"t",(function(){return fe})),n.d(t,"u",(function(){return ge})),n.d(t,"v",(function(){return he})),n.d(t,"w",(function(){return me})),n.d(t,"D",(function(){return be})),n.d(t,"E",(function(){return ye})),n.d(t,"J",(function(){return _e})),n.d(t,"F",(function(){return ve})),n.d(t,"K",(function(){return Se})),n.d(t,"N",(function(){return Oe})),n.d(t,"P",(function(){return Ce})),n.d(t,"Q",(function(){return Ee})),n.d(t,"R",(function(){return Ie})),n.d(t,"U",(function(){return we})),n.d(t,"V",(function(){return je})),n.d(t,"ab",(function(){return Pe})),n.d(t,"bb",(function(){return Te})),n.d(t,"gb",(function(){return Ne})),n.d(t,"ib",(function(){return Ae})),n.d(t,"jb",(function(){return Re})),n.d(t,"Fb",(function(){return De})),n.d(t,"nb",(function(){return xe})),n.d(t,"pb",(function(){return Me})),n.d(t,"zb",(function(){return Fe})),n.d(t,"Bb",(function(){return ke})),n.d(t,"Cb",(function(){return Le})),n.d(t,"Db",(function(){return Be})),n.d(t,"Jb",(function(){return Ue})),n.d(t,"Nb",(function(){return Ve})),n.d(t,"Pb",(function(){return ze})),n.d(t,"Qb",(function(){return qe})),n.d(t,"Rb",(function(){return He})),n.d(t,"Vb",(function(){return We})),n.d(t,"Gb",(function(){return Ge})),n.d(t,"L",(function(){return Ke})),n.d(t,"M",(function(){return Qe})),n.d(t,"Sb",(function(){return Xe})),n.d(t,"Xb",(function(){return Ye})),n.d(t,"kb",(function(){return Je})),n.d(t,"ac",(function(){return $e})),n.d(t,"qb",(function(){return Ze})),n.d(t,"ob",(function(){return et})),n.d(t,"fb",(function(){return tt})),n.d(t,"O",(function(){return nt}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="none",a="account",i="connection",o="feedback",s="audit",c="tracelog",l="product",u="sharepointdocument",d="quote",p="invoice",f="salesorder",g="opportunity",h="knowledgearticle",m="appointment",b="recurringappointmentmaster",y="workflow",_="asyncoperation",v="processsession",S="activitypointer",O="knowledgebaserecord",C="productsubstitute",E="productpricelevel",I="salesliterature",w="productassociation",j="competitor",P="contact",T="campaign",N="campaignactivity",A="uom",R="campaignresponse",D="list",x="contractdetail",M="incident",F="contract",k="lead",L="bulkoperation",B="position",U="systemuser",V="team",z="importfile",q="importlog",H="fieldsecurityprofile",W="service",G="constraintbasedgroup",K="site",Q="discounttype",X="discount",Y="pricelevel",J="uomschedule",$="sharepointdocumentlocation",Z="dynamicproperty",ee="serviceappointment",te="territory",ne="advancedsimilarityrule",re="queue",ae="bookableresource",ie="bookableresourcebooking",oe="bookableresourcebookingheader",se="bookableresourcecategory",ce="bookableresourcecategoryassn",le="bookableresourcecharacteristic",ue="bookableresourcegroup",de="bookingstatus",pe="category",fe="channelaccessprofile",ge="channelaccessprofilerule",he="channelaccessprofileruleitem",me="characteristic",be="contracttemplate",ye="customeraddress",_e="email",ve="description",Se="emailserverprofile",Oe="equipment",Ce="externalparty",Ee="externalpartyitem",Ie="fax",we="goal",je="goalrollupquery",Pe="invoicedetail",Te="kbarticle",Ne="letter",Ae="mailbox",Re="metric",De="rollupfield",xe="opportunityproduct",Me="phonecall",Fe="queueitem",ke="quotedetail",Le="ratingmodel",Be="ratingvalue",Ue="salesorderdetail",Ve="sharepointsite",ze="sla",qe="slakpiinstance",He="socialactivity",We="task",Ge="routingruleitem",Ke="entitlement",Qe="entitlementtemplate",Xe="socialprofile",Ye="teamtemplate",Je="newprocess",$e="translationprocess",Ze="phonetocaseprocess",et="opportunitysalesprocess",tt="leadtoopportunitysalesprocess",nt="expiredprocess"},uTcl:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.open=0]="open",e[e.closed=1]="closed"}(r||(r={}))},uUCw:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"d",(function(){return a})),n.d(t,"e",(function(){return i})),n.d(t,"f",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"g",(function(){return l})),n.d(t,"i",(function(){return u})),n.d(t,"j",(function(){return d})),n.d(t,"l",(function(){return p})),n.d(t,"h",(function(){return f})),n.d(t,"k",(function(){return g}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="clientHost.initialize",a="clientHost.changeInstallationId",i="clientHost.changeSubtype",o="clientHost.changeVersion",s="clientHost.changeDeviceModel",c="clientHost.changeTelemetryEventsParams";function l(e){return{type:r,payload:e}}function u(e){return{type:a,payload:e}}function d(e){return{type:i,payload:e}}function p(e,t,n,r,a){return{type:o,payload:{version:e,build:t,revision:n,nativeRevision:r,osVersion:a}}}function f(e){return{type:s,payload:e}}function g(e){return{type:c,payload:e}}},uWQm:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return o}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="recentItem.delete.FromState",a="recentItem.delete.multiple";function i(e,t){return{type:"recentItem.delete",sync:!0,execute(n,a){n.dispatch(function(e,t){return{type:r,payload:{id:e,isOnline:t}}}(e,t)),a.RecentItemsSyncManager.notifyRecentItemsUpdate()}}}function o(e,t){return{type:a,payload:{ids:e,isOnline:t}}}},uZkZ:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="offline.first.time.data.sync.completed";function a(e){return{type:r,payload:{isFirstTimeDataSyncCompleted:e}}}},uZvv:function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"e",(function(){return l})),n.d(t,"d",(function(){return u}));var r=n("2FbK"),a=n("d6Hx");function i(e){return e&&e.appShellState&&e.appShellState.sitemapState?e.appShellState.sitemapState:null}function o(e){const t=i(e);if(t)return t.selectedSubAreaId}function s(e){const t=i(e);return t&&t.selectedAreaId?t.selectedAreaId:null}function c(e){const t=s(e);if(t)return t;const n=Object(r.b)(e);return n&&(n.AreaIds[0]!==a.c?n.AreaIds[0]:n.AreaIds[1])}function l(e){const t=i(e);if(t)return t.sitemapExpandedState}function u(e){var t;return null===(t=null==e?void 0:e.appShellState)||void 0===t?void 0:t.sitemapCollapsedState}},ueZM:function(e,t,n){"use strict";n.d(t,"a",(function(){return _}));var r=n("SAYH"),a=n("eXjw"),i=n("K7RF"),o=n("2XFH"),s=n("Uv1Y"),c=n("y60j"),l=n("g0tL"),u=n("FZDd"),d=n("AF/G"),p=n("99zj");var f=n("/oKV"),g=n("iJGp");function h(e){return{type:"complexcontrol.retrieve.async",execute({dispatch:t,getState:n},r){const a=f.a.Local;return function(e,t){var n;const r=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e){var t;return null===(t=null==e?void 0:e.metadata)||void 0===t?void 0:t.complexControls}(e);return null===(n=null==r?void 0:r.complexControls)||void 0===n?void 0:n[t]}(n(),e)?Promise.resolve():t(function(e,t){return{type:"complexcontrol.retrieve.async",execute:({dispatch:n,getState:r},a)=>n(Object(i.b)("complexcontrol",null,null,null,!1,g.a.OnDemandWithoutContext,null,null,[e],null,t)).catch(s.b)}}(e,a))}}}var m=n("YVjE"),b=n("64CY"),y=n("wL2W");function _(e,t){return{type:"form.dependencies.update.async",execute({dispatch:n,getState:f},g){let _=f();const C=Object(c.h)(_,e);if(C&&C.initialized===a.a.Initialized){const a=function(e){if(!e)return null;const t=e.EntityLogicalName,n={},a={},i=[];i.push(r.a.toString(e.Id)+":name"),t&&(a[t]=[]);const o=e.Tabs;for(const e of o)e.LabelId&&i.push(e.LabelId+":displayname");const s=e.Sections;for(const e in s){const t=s[e];t.LabelId&&i.push(t.LabelId+":displayname")}const c=e.Controls;for(const e in c){const o=c[e];!o.DataFieldName||!t||o.Relationship||r.a.equals(o.ClassId,d.J)||r.a.equals(o.ClassId,d.i)||o.IsUnbound||a[t].push(o.DataFieldName),o.LabelId&&i.push(o.LabelId+":displayname"),o.Relationship&&(n[o.Relationship]||(n[o.Relationship]=[]),n[o.Relationship].push(o.DataFieldName))}return{labelIdsAndColumnNames:i,entityAndAttributes:a,relationshipAndAttributes:n}}(C),g=[],E=C.FormLibraries?C.FormLibraries.filter(e=>!Object(m.d)(e)):null;if(E&&E.length>0&&g.push(n(Object(p.d)(E))),a&&a.labelIdsAndColumnNames&&a.labelIdsAndColumnNames.length){const e=n(Object(o.a)(a.labelIdsAndColumnNames));g.push(e)}if(a&&a.entityAndAttributes&&Object.keys(a.entityAndAttributes).length)for(const e in a.entityAndAttributes)g.push(n(Object(u.f)(e,!1,a.entityAndAttributes[e],t)));return Promise.all(g).then(()=>{const o=[],d={},p=C.EntityLogicalName;if(_=f(),p&&a&&a.relationshipAndAttributes&&Object.keys(a.relationshipAndAttributes).length&&_&&_.metadata&&_.metadata.entities){const e=_.metadata.entities;for(const t in a.relationshipAndAttributes)if(e[p]&&e[p].ManyToOneRelationships&&e[p].ManyToOneRelationships[t]&&e[p].ManyToOneRelationships[t].ReferencedEntity){const n=e[p].ManyToOneRelationships[t].ReferencedEntity;n&&(d[n]||(d[n]=[]),d[n].push(...a.relationshipAndAttributes[t]))}}if(d&&Object.keys(d).length)for(const e in d)o.push(n(Object(u.f)(e,!1,d[e],t)));const g=n(function(e){return{type:"compositeControls.loadMetaData.async",execute({dispatch:t,getState:n},r,a){const i=n(),o=Object(c.h)(i,e),s=Object(c.i)(i),l=[];if(o){const e=[];Object.keys(o.Controls).map(e=>o.Controls[e]).filter(e=>e.Name&&e.Name.indexOf("compositionLinkControl")>0).forEach(t=>{if(!t.Name)return;const n=function(e){const t=["header","footer"],n=e.split("_"),r=t.indexOf(n[0])<0?n[0]:n[1];if(!r)return null;let a=r.replace(/[0-9]/g,"").toLowerCase().replace(/^yomi/,"");a="shipto"===a||"billto"===a?"address":a;const i=b.b.filter(e=>e.toLowerCase().indexOf(a)>-1);return i.length>0?i[0]:null}(t.Name);n&&e.indexOf(n)<0&&e.push(n),s&&Object.keys(s).filter(e=>e===n.toLowerCase()).length>0&&e.pop()}),e.forEach(e=>{l.push(t(h(e)))})}return Promise.all(l)}}}(e));return Promise.all([o,g]).then(e=>{const t=function(e,t){if(!t||!e||!e.metadata)return null;const n={},a=r.a.toString(t.Id);if(t.Name=Object(l.c)(e,a,null,null,null,e.metadata.labels,e.metadata.attributes,e.metadata.entities,"name"),t.Label=t.Name,t.Tabs)for(const n of t.Tabs)n&&!n.Label&&(n.Label=Object(l.c)(e,n.LabelId,null,null,null,e.metadata.labels,e.metadata.attributes,e.metadata.entities));if(t.Sections)for(const n in t.Sections)t.Sections[n]&&!t.Sections[n].Label&&(t.Sections[n].Label=Object(l.c)(e,t.Sections[n].LabelId,n.toLowerCase(),t.EntityLogicalName,null,e.metadata.labels,e.metadata.attributes,e.metadata.entities));if(t.Controls){const n=Object(y.a)();for(const r in t.Controls)if(t.Controls[r]&&!t.Controls[r].Label){let a;const i="TargetEntityType";if(t.Controls[r].Parameters&&t.Controls[r].Parameters[i]&&(a=t.Controls[r].Parameters[i]),t.Controls[r].Relationship&&e.metadata.entities&&e.metadata.entities[t.EntityLogicalName]&&e.metadata.entities[t.EntityLogicalName].ManyToOneRelationships&&e.metadata.entities[t.EntityLogicalName].ManyToOneRelationships[t.Controls[r].Relationship]&&e.metadata.entities[t.EntityLogicalName].ManyToOneRelationships[t.Controls[r].Relationship].ReferencedEntity){const a=e.metadata.entities[t.EntityLogicalName].ManyToOneRelationships[t.Controls[r].Relationship].ReferencedEntity,{label:i,labelSource:o}=Object(l.d)(e,t.Controls[r].LabelId,t.Controls[r].DataFieldName,a,t.EntityLogicalName,e.metadata.labels,e.metadata.attributes,e.metadata.entities);t.Controls[r].Label=i,n&&(t.Controls[r].LabelSource=o)}else{const{label:i,labelSource:o}=Object(l.d)(e,t.Controls[r].LabelId,t.Controls[r].DataFieldName,t.EntityLogicalName,a,e.metadata.labels,e.metadata.attributes,e.metadata.entities);t.Controls[r].Label=i,n&&(t.Controls[r].LabelSource=o)}}}const i=Object(b.e)(t.EntityLogicalName),o=Object(c.i)(e);i&&o&&(!function(e,t){for(const n in e.Sections)if(e.Sections[n]){const r=[],a=[];let i=0,o=0;for(let s=0;s<e.Sections[n].Rows.length;s++){const c=e.Sections[n].Rows[s];let l=0;for(const e of c.Cells)if(e.ControlName&&e.ControlName.indexOf("compositionLinkControl")>0){const n=c.Cells.indexOf(e),s=c.Cells[n].ControlName.split("_"),l=s[0];if(!l){S(c,o,r),o++;break}a.indexOf(l)<0&&(i=o,a.push(l));const u=O(l,s[s.length-1],t),d=i+u;if(u>-1){S(c,d,r),o++;break}}else l++;l===c.Cells.length&&(S(c,o,r),o++)}e.Sections[n].Rows=r}}(t,o),t.Header.Controls=v(t.Header.Controls,o),t.Footer.Controls=v(t.Footer.Controls,o));return t.AreLabelsSubstituted=!0,n[a]=t,{forms:n}}(f(),C);var a;n((a=t,{type:i.a,payload:a}))}).catch(s.b)}).catch(s.b)}return Promise.resolve()}}}function v(e,t){const n=[],r=[];let a=0;return e.forEach((e,i)=>{if(e.Name&&e.Name.indexOf("compositionLinkControl")>0){const o=e.Name.split("_"),s=o[1];if(!s)return void S(e,i,n);r.indexOf(s)<0&&(a=i,r.push(s));const c=O(s,o[o.length-1],t),l=i,u=a+c;if(c>-1&&l!==u)return void S(e,u,n)}S(e,i,n)}),n}function S(e,t,n){n[t]?n.push(e):n[t]=e}function O(e,t,n){let r=e.replace(/[0-9]/g,"").toLowerCase().replace(/^yomi/,"");r="shipto"===r||"billto"===r?"address":r;const a=n[r+"compositionLinkControl".toLowerCase()];if(a){t=t.replace(/^yomi/,"");const e=a.indexOf(t);if(e>-1)return e;const n=a.indexOf(t.slice(0,t.length-1));return n>-1?n:-1}}},ufH1:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"e",(function(){return c})),n.d(t,"d",(function(){return l})),n.d(t,"b",(function(){return u}));var r=n("XjOj"),a=n("Div0"),i=n("504W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function o(e){const t=e.getMilliseconds();return e.format("HH:mm:ss.")+(t<100?"0":"")+(t<10?"0":"")+t.toString()}function s(e,t,n){const s=new Date;Object(i.b)(n)?Object(r.f)(t,"{0} -- {1}",e,o(s)):Object(r.f)(t,"{0} -- {1} -- {2}",e,n,o(s)),window[a.a[t]+"_"+e]=s.getTime()}function c(e,t,n){const s=new Date;Object(i.b)(n)?Object(r.i)(t,"{0} -- {1}",e,o(s)):Object(r.i)(t,"{0} -- {1} -- {2}",e,n,o(s)),window[a.a[t]+"_"+e]=s.getTime()}function l(e,t,n){const s=new Date;Object(i.b)(n)?Object(r.h)(t,"{0} -- {1}",e,o(s)):Object(r.h)(t,"{0} -- {1} -- {2}",e,n,o(s)),window[a.a[t]+"_"+e]=s.getTime()}function u(e,t,n){const s=new Date;Object(i.b)(n)?Object(r.d)(t,"{0} -- {1}",e,o(s)):Object(r.d)(t,"{0} -- {1} -- {2}",e,n,o(s)),window[a.a[t]+"_"+e]=s.getTime()}},uhZ3:function(e,t,n){"use strict";function r(e){
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
return function(e){return null==e||""===e}(e)||""===e.toString().trim()}function a(e){return null==e}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}))},umme:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("uAlF"),a=n("7Gx7"),i=n("WWXV"),o=n("504W");class s{constructor(e){this._errorCode=0,this._errorFault=null,this._message=null,this._exception=null,this._innerError=null,this._errorSource=0,this._blockErrorReporting=!1,this._stack=null,this._faultedRequestIndex=0,this._clientRequestId=null,this._serverResponseId=null,this._httpStatusCode=0,this._retryAfter=null,this._date=null,this._message=e,this._errorSource=0,this._blockErrorReporting=!1,this._isRequestTooLong=!1}get_ErrorCode(){return this._errorCode}set_ErrorCode(e){return this._errorCode=e,e}get_Message(){return this._message}set_Message(e){return this._message=e,e}get_Exception(){return this._exception}set_Exception(e){return this._exception=e,e}get_InnerError(){return this._innerError}set_InnerError(e){return this._innerError=e,e}get_ErrorFault(){return this._errorFault}set_ErrorFault(e){return this._errorFault=e,e}get_ErrorSource(){return this._errorSource}set_ErrorSource(e){return this._errorSource=e,this._errorSource}get_BlockErrorReporting(){return this._blockErrorReporting}set_BlockErrorReporting(e){return this._blockErrorReporting=e,e}get_Stack(){return this._stack}set_Stack(e){return this._stack=e,e}get_Date(){return this._date}set_Date(e){return this._date=e,e}get_FaultedRequestIndex(){return this._faultedRequestIndex}set_FaultedRequestIndex(e){return this._faultedRequestIndex=e,e}get_ServerResponseId(){return this._serverResponseId}set_ServerResponseId(e){return this._serverResponseId=e,e}get_ClientRequestId(){return this._clientRequestId}set_ClientRequestId(e){return this._clientRequestId=e,e}get_HttpStatusCode(){return this._httpStatusCode}set_HttpStatusCode(e){return this._httpStatusCode=e,e}get_RetryAfter(){return this._retryAfter}set_RetryAfter(e){return this._retryAfter=e,e}get_isRequestTooLong(){return this._isRequestTooLong}set_isRequestTooLong(e){return this._isRequestTooLong=e,e}chainError(e){this.set_Message(this.get_Message()+"\nInner Error Message:\n"+e.get_Message()),this.set_InnerError(e)}getObjectDataForApplicationDispatcher(){const e=this.getObjectData();return"innererror"in e&&(e.innererror=e.innererror.getObjectDataForApplicationDispatcher()),new a.a(e)}getObjectData(){const e={};return e.errorcode=this.get_ErrorCode(),e.message=this.get_Message(),Object(o.a)(this.get_InnerError())||(e.innererror=this.get_InnerError().getObjectData()),e}static FromMessage(e,...t){let n="";return Object(o.b)(e)||(n=!Object(o.a)(t)&&t.length>0?String.format(e,...t):e),new s(n)}static fromGenericError(e){const t=Object(o.a)(e)?s.fromErrorCode(1):s.FromMessage(e.message);return t._blockErrorReporting=e.blockErrorReporting,Object(o.a)(e.errorCode)||(t._errorCode=e.errorCode),Object(o.a)(e.stack)||(t._stack=e.stack),t}static fromErrorCode(e,...t){const n=new s(Object(r.a)(e,t));return n.set_ErrorCode(e),n}static fromErrorCodeAndMessage(e,t){const n=new s("");return n.set_ErrorCode(e),n.set_Message(t),n}static fromLocalStoreError(e,t,...n){const r=new s(String.format(t,...n));return r._errorSource=i.a.LocalStore,r._errorCode=e,r}static isAuthenticationErrorCode(e){return-2147209463===e||-2147209460===e||-2147220692===e||-2147093995===e||-2147220960===e||-2146088112===e||-2147220955===e}}},unFF:function(e,t,n){"use strict";function r(e){return e?e.theme:null}n.d(t,"a",(function(){return r}))},"uu/V":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class r{constructor(e,t,n,r){this.response=null,this.success=!1,this.errorMessage=null,this.errorCode=0,this.success=e,this.errorMessage=t,this.errorCode=n,this.response=r}get_response(){return this.response}get_errorMessage(){return this.errorMessage}get_errorCode(){return this.errorCode}get_success(){return this.success}}r.invalidResponseMessage="JSON response is null or undefined."},uufl:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e){return e.sessionTimeoutStatus?e.sessionTimeoutStatus.isReauthInProgress:null}n.d(t,"a",(function(){return r}))},uvnT:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return l}));var r=n("kAKO"),a=n("yHIv"),i=n("fMBw"),o=n.n(i),s=n("SZCI"),c=n("pEXn");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const l="scriptEvaluation";function u(){return{diagnosticName:l,boot:(e,t,n)=>{const r=()=>{const e=window.bundleExecutionMarkers;for(const t in e){const n=e[t].begin,r=e[t].end,a={[c.b.BootPerformanceParameters.BundleName]:t};o.a.createEvent(l,s.d).createRetroactiveStopwatch(n,r-n,a)}window.bundleExecutionMarkers={}};r(),window.reportBundleExecutionTimes=r},supportedClientHostTypes:a.a,supportedPageTypes:a.b,priority:r.a.Normal}}},uxy2:function(e,t,n){"use strict";n.d(t,"c",(function(){return u})),n.d(t,"a",(function(){return l})),n.d(t,"e",(function(){return o})),n.d(t,"b",(function(){return p})),n.d(t,"d",(function(){return d})),n.d(t,"g",(function(){return s})),n.d(t,"f",(function(){return c}));var r=n("dHD5"),a=n("SAYH"),i=n("/J/l");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function o(e,t){const n=Object(r.w)(e);return{type:i.f,payload:{numberOfResults:t},meta:{contextKey:n}}}function s(e,t){const n=Object(r.w)(e);return{type:i.b,payload:{selectedResult:t},meta:{contextKey:n}}}function c(e,t){const n=Object(r.w)(e);return{type:i.g,payload:{records:t},meta:{contextKey:n}}}function l(e,t,n){const a={command:t,value:n},o=Object(r.w)(e);return{type:i.c,payload:{filterQueryParams:a},meta:{contextKey:o}}}function u(e,t){const n=Object(r.w)(e);return{type:i.d,payload:{blockClick:t},meta:{contextKey:n}}}function d(e,t){const n=Object(r.w)(e);return{type:i.e,payload:{currentSearchText:t},meta:{contextKey:n}}}function p(e,t,n){const o={articleId:t},s=Object(r.w)(n),c={action:{Id:6,ActionExecutionId:a.a.toString(a.a.newGuid()),Name:"OpenResult",TitleResourceName:null,TooltipResourceName:null,Title:()=>null,Tooltip:()=>null},payload:o};return{type:i.a,payload:c,meta:{contextKey:s}}}},v3UX:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("5yoC");class a extends r.a{constructor(e,t,n,r,a,i){super(),this._target=e,this._columnSet=t,this._relatedEntitiesQuery=n,this._returnNotifications=r,this._clientRetrieveOptions=a,this._navigationProperty=i}get_name(){return"Retrieve"}get_xmlNamespace(){return"http://schemas.microsoft.com/xrm/2011/Contracts"}get_target(){return this._target}get_columnSet(){return this._columnSet}get_relatedEntitiesQuery(){return this._relatedEntitiesQuery}get_returnNotifications(){return this._returnNotifications}get_clientRetrieveOptions(){return this._clientRetrieveOptions}get_navigationProperty(){return this._navigationProperty}}},vF3j:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("iZ7K");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t,n){let a,i,o;if(o=Object(r.C)(e,t,n))a="POST",i=o.ReferencedEntityNavigationPropertyName;else if(o=Object(r.v)(e,t,n))if(a="POST",t===o.Entity1LogicalName)i=o.Entity1NavigationPropertyName;else{if(t!==o.Entity2LogicalName)return{serializationFailure:`No navigation property found for the N:N relationship with the name ${n} and target entity ${t}`};i=o.Entity2NavigationPropertyName}else{if(!(o=Object(r.y)(e,t,n)))return{serializationFailure:`No metadata is available for the relationship with the name ${n} and target entity ${t}`};a="PUT",i=o.ReferencingEntityNavigationPropertyName}return{navigationProperty:i,method:a}}},vIHs:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n("EY5k"),a=n("ngeo"),i=n("YxC/"),o=n("qAG9");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const s={errorCode:{labelId:"ErrorPopup.ErrorCode",defaultValue:"Error Code"},sessionId:{labelId:"ErrorPopup.SessionId",defaultValue:"Session Id"},activityId:{labelId:"ErrorPopup.ActivityId",defaultValue:"Activity Id"},requestId:{labelId:"ErrorPopup.RequestId",defaultValue:"Request Id"},timestamp:{labelId:"ErrorPopup.Timestamp",defaultValue:"Timestamp"},errorDetailsShowLabel:{labelId:"ErrorPopup.ErrorDetailsLabel",defaultValue:"Show details"},errorDetailsHideLabel:{labelId:"ErrorPopup.ErrorDetailsHideLabel",defaultValue:"Hide details"},helpLabel:{labelId:"Help_Link_Label",defaultValue:"Learn more"},Button_Label_OK:{labelId:"Button_Label_OK",defaultValue:"OK"},Button_Label_Close:{labelId:"Button_Label_Close",defaultValue:"Close"},Error_Title_Generic:{labelId:"Error_Title_Generic",defaultValue:"Error"}};n("NUY7");var c=n("Wc7r");function l(e,t,n,l){const d=window.__preload&&window.__preload.localizedStrings,p=window.__preload&&window.__preload.isRTL,f=d&&d.errors,g=d&&d.labels,h=e&&e.get_request&&e.get_request(),m=e&&e.errorCode,b=e&&e.errorParameters;let y=e&&e.displayTitle,_=e&&e.displayMessage;const v=[],S={};let O=null,C=null,E=null,I=null,w=null;if(m&&(C="0x"+a.a.getHexErrorCodeFromInt(m)),h&&(w=h.status,O=h&&h.headers?Object(o.a)(h.headers,c.HEADER.SERVER_REQUEST_ID):null),t&&n){const e=[];for(const t in s)e.push(s[t].labelId);m&&(y||(E="Error_Title_"+C,e.push(E)),_||(I="Error_Message_"+C,e.push(I))),v.push(t(Object(r.e)(e)).then(()=>{const t=Object(i.e)(n(),e);for(const e in s)S[e]=Object(i.c)(t,s[e].labelId);if(m&&(y=y||Object(i.c)(t,E),!_&&(_=Object(i.c)(t,I),_&&b&&b.length))){const e=b.map(e=>e.value);_=String.format(_,...e)}}).catch(()=>{}))}else if(f&&(w||C)){const e=w?"Status"+w:"Error_"+C;f&&f[e]&&(y=y||f[e].errorTitle,_=_||f[e].errorMessage)}return Promise.all(v).then(()=>{y=y||f&&f.UnknownError.errorTitle||"Error",_=_||f&&f.UnknownError.errorMessage||"Something went wrong";const t=S.errorDetailsShowLabel||g&&g.errorDetailsShowLabel||s.errorDetailsShowLabel.defaultValue,n=S.errorDetailsHideLabel||g&&g.errorDetailsHideLabel||s.errorDetailsHideLabel.defaultValue,r=S.helpLabel||g&&g.helpLabel||s.helpLabel.defaultValue,a=S.Button_Label_OK||g&&g.Button_Label_OK||s.Button_Label_OK.defaultValue,i=S.Button_Label_Close||g&&g.Button_Label_Close||s.Button_Label_Close.defaultValue,o=S.Error_Title_Generic||f&&f.UnknownError.errorTitle||s.Error_Title_Generic.defaultValue,c={errorCode:m,sessionId:l&&l.sessionId,activityId:l&&l.activityId,requestId:O,timestamp:new Date},d={detailsShowLabel:t,detailsHideLabel:n,errorMessage:e&&e.message,stack:e&&e.stack};return{errorPopupDescriptor:{title:y,message:_,closeButtonLabel:i,accessibilityLabelPrefix:o,errorInformation:u(c,S,g,p),errorTechnicalDetails:d,isRTL:p},helpLinkLabel:r,okButtonLabel:a}})}function u(e,t,n,r){const a={};for(const i in e)if(e[i]){const o=t[i]||n&&n[i]||s[i].defaultValue;a[i]=r?e[i]+" :"+o:o+": "+e[i]}return a}},vNXc:function(e,t,n){"use strict";n.d(t,"a",(function(){return G}));var r=n("q/4y"),a=n("SAYH"),i=n("odYE"),o=n("+5Bq"),s=n("zsAz");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class c extends
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class{getMetadata(){return{boundParameter:null,operationName:null,operationType:null,parameterTypes:{}}}}{constructor(e,t,n,r,a,i,o,s,c){super(),this.Distinct=e,this.NoLock=t,this.PageInfo=n,this.LinkEntities=r,this.Criteria=a,this.Orders=i,this.EntityName=o,this.ColumnSet=s,this.TopCount=c}getMetadata(){return{boundParameter:null,operationName:null,operationType:null,parameterTypes:{Distinct:{typeName:"Edm.Boolean",structuralProperty:1},NoLock:{typeName:"Edm.Boolean",structuralProperty:1},PageInfo:{typeName:"Microsoft.Dynamics.CRM.PagingInfo",structuralProperty:2},LinkEntities:{typeName:"mscrm.LinkEntity",structuralProperty:4},Criteria:{typeName:"Microsoft.Dynamics.CRM.FilterExpression",structuralProperty:2},Orders:{typeName:"mscrm.OrderExpression",structuralProperty:4},EntityName:{typeName:"Edm.String",structuralProperty:1},ColumnSet:{typeName:"Microsoft.Dynamics.CRM.ColumnSet",structuralProperty:2},TopCount:{typeName:"Edm.Int32",structuralProperty:1}},typeName:"Microsoft.Dynamics.CRM.QueryExpression"}}}var l=n("F3eT");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class u{constructor(e,t){this.AllColumns=e,this.Columns=t}getMetadata(){return{boundParameter:null,operationName:null,operationType:null,parameterTypes:{AllColumns:{typeName:"Edm.Boolean",structuralProperty:1},Columns:{typeName:"Edm.String",structuralProperty:4}}}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class d{constructor(e,t){this.AttributeName=e,this.OrderType=t}getMetadata(){return{boundParameter:null,operationName:null,operationType:null,parameterTypes:{AttributeName:{typeName:"Edm.String",structuralProperty:1},OrderType:{typeName:"Microsoft.Dynamics.CRM.OrderType",structuralProperty:3,enumProperties:[,{name:"Ascending",value:0},{name:"Descending",value:1}]}}}}}var p=n("CB5L");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class f{constructor(e,t,n,r,a,i,o,s,c,l){this.LinkFromAttributeName=e,this.LinkFromEntityName=t,this.LinkToEntityName=n,this.LinkToAttributeName=r,this.JoinOperator=a,this.LinkCriteria=i,this.LinkEntities=o,this.Columns=s,this.EntityAlias=c,this.Orders=l}getMetadata(){return{boundParameter:null,operationName:null,operationType:null,parameterTypes:{LinkFromAttributeName:{typeName:"Edm.String",structuralProperty:1},LinkFromEntityName:{typeName:"Edm.String",structuralProperty:1},LinkToEntityName:{typeName:"Edm.String",structuralProperty:1},LinkToAttributeName:{typeName:"Edm.String",structuralProperty:1},JoinOperator:{typeName:"Microsoft.Dynamics.CRM.JoinOperator",structuralProperty:3,enumProperties:[{name:"Inner",value:0},{name:"LeftOuter",value:1},{name:"Natural",value:2},{name:"MatchFirstRowUsingCrossApply",value:3},{name:"In",value:4},{name:"Exists",value:5}]},LinkCriteria:{typeName:"Microsoft.Dynamics.CRM.FilterExpression",structuralProperty:2},LinkEntities:{typeName:"mscrm.LinkEntity",structuralProperty:4},Columns:{typeName:"Microsoft.Dynamics.CRM.ColumnSet",structuralProperty:2},EntityAlias:{typeName:"Edm.String",structuralProperty:1},Orders:{typeName:"mscrm.OrderExpression",structuralProperty:4}}}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class g{constructor(e,t,n,r,a){this.FilterOperator=e,this.FilterHint=t,this.Conditions=n,this.Filters=r,this.IsQuickFindFilter=a}getMetadata(){return{boundParameter:null,operationName:null,operationType:null,parameterTypes:{FilterOperator:{typeName:"Microsoft.Dynamics.CRM.LogicalOperator",structuralProperty:3,enumProperties:[,{name:"And",value:0},{name:"Or",value:1}]},FilterHint:{typeName:"Edm.String",structuralProperty:1},Conditions:{typeName:"mscrm.ConditionExpression",structuralProperty:4},Filters:{typeName:"mscrm.FilterExpression",structuralProperty:4},IsQuickFindFilter:{typeName:"Edm.Boolean",structuralProperty:1}}}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class h{constructor(e,t,n,r){this.EntityName=e,this.AttributeName=t,this.Operator=n,this.Values=r}getMetadata(){return{boundParameter:null,operationName:null,operationType:null,parameterTypes:{EntityName:{typeName:"Edm.String",structuralProperty:1},AttributeName:{typeName:"Edm.String",structuralProperty:1},Operator:{typeName:"Microsoft.Dynamics.CRM.ConditionOperator",structuralProperty:3,enumProperties:[,{name:"Equal",value:0},{name:"NotEqual",value:1},{name:"GreaterThan",value:2},{name:"LessThan",value:3},{name:"GreaterEqual",value:4},{name:"LessEqual",value:5},{name:"Like",value:6},{name:"NotLike",value:7},{name:"In",value:8},{name:"NotIn",value:9},{name:"Between",value:10},{name:"NotBetween",value:11},{name:"Null",value:12},{name:"NotNull",value:13},{name:"Yesterday",value:14},{name:"Today",value:15},{name:"Tomorrow",value:16},{name:"Last7Days",value:17},{name:"Next7Days",value:18},{name:"LastWeek",value:19},{name:"ThisWeek",value:20},{name:"NextWeek",value:21},{name:"LastMonth",value:22},{name:"ThisMonth",value:23},{name:"NextMonth",value:24},{name:"On",value:25},{name:"OnOrBefore",value:26},{name:"OnOrAfter",value:27},{name:"LastYear",value:28},{name:"ThisYear",value:29},{name:"NextYear",value:30},{name:"LastXHours",value:31},{name:"NextXHours",value:32},{name:"LastXDays",value:33},{name:"NextXDays",value:34},{name:"LastXWeeks",value:35},{name:"NextXWeeks",value:36},{name:"LastXMonths",value:37},{name:"NextXMonths",value:38},{name:"LastXYears",value:39},{name:"NextXYears",value:40},{name:"EqualUserId",value:41},{name:"NotEqualUserId",value:42},{name:"EqualBusinessId",value:43},{name:"NotEqualBusinessId",value:44},{name:"ChildOf",value:45},{name:"Mask",value:46},{name:"NotMask",value:47},{name:"MasksSelect",value:48},{name:"Contains",value:49},{name:"DoesNotContain",value:50},{name:"EqualUserLanguage",value:51},{name:"NotOn",value:52},{name:"OlderThanXMonths",value:53},{name:"BeginsWith",value:54},{name:"DoesNotBeginWith",value:55},{name:"EndsWith",value:56},{name:"DoesNotEndWith",value:57},{name:"ThisFiscalYear",value:58},{name:"ThisFiscalPeriod",value:59},{name:"NextFiscalYear",value:60},{name:"NextFiscalPeriod",value:61},{name:"LastFiscalYear",value:62},{name:"LastFiscalPeriod",value:63},{name:"LastXFiscalYears",value:64},{name:"LastXFiscalPeriods",value:65},{name:"NextXFiscalYears",value:66},{name:"NextXFiscalPeriods",value:67},{name:"InFiscalYear",value:68},{name:"InFiscalPeriod",value:69},{name:"InFiscalPeriodAndYear",value:70},{name:"InOrBeforeFiscalPeriodAndYear",value:71},{name:"InOrAfterFiscalPeriodAndYear",value:72},{name:"EqualUserTeams",value:73},{name:"EqualUserOrUserTeams",value:74},{name:"Under",value:75},{name:"NotUnder",value:76},{name:"UnderOrEqual",value:77},{name:"Above",value:78},{name:"AboveOrEqual",value:79},{name:"EqualUserOrUserHierarchy",value:80},{name:"EqualUserOrUserHierarchyAndTeams",value:81},{name:"OlderThanXYears",value:82},{name:"OlderThanXWeeks",value:83},{name:"OlderThanXDays",value:84},{name:"OlderThanXHours",value:85},{name:"OlderThanXMinutes",value:86},{name:"ContainValues",value:87},{name:"DoesNotContainValues",value:88}]},Values:{typeName:"mscrm.Object",structuralProperty:4}}}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class m{constructor(e,t){this.Type=e,this.Value=t}getMetadata(){return{boundParameter:null,operationName:null,operationType:null,parameterTypes:{Type:{typeName:"Edm.String",structuralProperty:1},Value:{typeName:"Edm.String",structuralProperty:1}}}}}var b=n("FZDd"),y=n("LbMF");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function _(e,t,n,r){const a=function(e){const t={},n=(new DOMParser).parseFromString(e,"text/xml"),r=n.getElementsByTagName("entity");r&&r.length;const a=n.getElementsByTagName("condition");for(let e=0;e<a.length;++e){const n=a[e],r=O(n,"entityName"),i=O(n,"attribute"),o=r||N(n);t.hasOwnProperty(o)?-1===t[o].indexOf(i)&&t[o].push(i):t[o]=[i]}return t}(e);return n(Object(b.e)(a,r)).then(()=>{const n=t(),r=(new DOMParser).parseFromString(e,"text/xml").documentElement,a=v(r,"returntotalrecordcount"),i=S(r,"page"),o=S(r,"count"),s=v(r,"no-lock"),u=O(r,"paging-cookie"),d=S(r,"top"),f=v(r,"distinct");let h=null;const m=[],b=[];let y=null,_=null;const w=r&&r.getElementsByTagName("entity");if(w&&w.length){const e=w[0];h=O(e,"name"),_=C(e),y=E(e);const t=e.childNodes;for(let e=0;e<t.length;e++){const r=t[e].nodeName;"filter"===r?b.push(I(t[e],h,n)):"link-entity"===r&&m.push(T(t[e],h,n))}}let j=null;return 1===b.length?j=b[0]:b.length>1&&(j=new g(p.f.And,null,[],b,!1)),new c(f,s,new l.a(i,o,a,u),m,j,y,h,_,d)})}function v(e,t){return Object(o.a)(O(e,t))}function S(e,t,n){const r=O(e,t);return r?parseInt(r,10):n}function O(e,t){const n=e;return n&&n.attributes&&n.attributes.getNamedItem(t)&&n.attributes.getNamedItem(t).value}function C(e){const t=e.childNodes,n=new u(!1,[]);for(let e=0;e<t.length;e++){const r=t[e].nodeName;"all-attributes"===r?n.AllColumns=!0:"attribute"===r&&n.Columns.push(O(t[e],"name"))}return n}function E(e){const t=e.childNodes,n=[];for(let e=0;e<t.length;e++){if("order"===t[e].nodeName){const r=O(t[e],"attribute");let a=v(t[e],"descending");null==a&&(a=!0),n.push(new d(r,a?p.g.Descending:p.g.Ascending))}}return n}function I(e,t,n){const r=v(e,"isquickfindfields"),a="or"===O(e,"type")?p.f.Or:p.f.And,i=[],o=[],s=e.childNodes;for(let e=0;e<s.length;e++){const r=s[e].nodeName;"filter"===r?i.push(I(s[e],t,n)):"condition"===r&&o.push(w(s[e],t,n))}return new g(a,null,o,i,r)}function w(e,t,n){const r=O(e,"entityname"),a=O(e,"attribute"),i=function(e){switch(O(e,"operator")){case"eq":return p.a.Equal;case"neq":case"ne":return p.a.NotEqual;case"gt":return p.a.GreaterThan;case"ge":return p.a.GreaterEqual;case"le":return p.a.LessEqual;case"lt":return p.a.LessThan;case"like":return p.a.Like;case"not-like":return p.a.NotLike;case"in":return p.a.In;case"not-in":return p.a.NotIn;case"between":return p.a.Between;case"not-between":return p.a.NotBetween;case"null":return p.a.Null;case"not-null":return p.a.NotNull;case"yesterday":return p.a.Yesterday;case"today":return p.a.Today;case"tomorrow":return p.a.Tomorrow;case"last-seven-days":return p.a.Last7Days;case"next-seven-days":return p.a.Next7Days;case"last-week":return p.a.LastWeek;case"this-week":return p.a.ThisWeek;case"next-week":return p.a.NextWeek;case"last-month":return p.a.LastMonth;case"this-month":return p.a.ThisMonth;case"next-month":return p.a.NextMonth;case"on":return p.a.On;case"on-or-before":return p.a.OnOrBefore;case"on-or-after":return p.a.OnOrAfter;case"last-year":return p.a.LastYear;case"this-year":return p.a.ThisYear;case"next-year":return p.a.NextYear;case"last-x-hours":return p.a.LastXHours;case"next-x-hours":return p.a.NextXHours;case"last-x-days":return p.a.LastXDays;case"next-x-days":return p.a.NextXDays;case"last-x-weeks":return p.a.LastXWeeks;case"next-x-weeks":return p.a.NextXWeeks;case"last-x-months":return p.a.LastXMonths;case"next-x-months":return p.a.NextXMonths;case"olderthan-x-months":return p.a.OlderThanXMonths;case"olderthan-x-years":return p.a.OlderThanXYears;case"olderthan-x-weeks":return p.a.OlderThanXWeeks;case"olderthan-x-days":return p.a.OlderThanXDays;case"olderthan-x-hours":return p.a.OlderThanXHours;case"olderthan-x-minutes":return p.a.OlderThanXMinutes;case"last-x-years":return p.a.LastXYears;case"next-x-years":return p.a.NextXYears;case"eq-userid":return p.a.EqualUserId;case"ne-userid":return p.a.NotEqualUserId;case"eq-userteams":return p.a.EqualUserTeams;case"eq-useroruserteams":return p.a.EqualUserOrUserTeams;case"eq-useroruserhierarchy":return p.a.EqualUserOrUserHierarchy;case"eq-useroruserhierarchyandteams":return p.a.EqualUserOrUserHierarchyAndTeams;case"eq-businessid":return p.a.EqualBusinessId;case"ne-businessid":return p.a.NotEqualBusinessId;case"eq-userlanguage":return p.a.EqualUserLanguage;case"this-fiscal-year":return p.a.ThisFiscalYear;case"this-fiscal-period":return p.a.ThisFiscalPeriod;case"next-fiscal-year":return p.a.NextFiscalYear;case"next-fiscal-period":return p.a.NextFiscalPeriod;case"last-fiscal-year":return p.a.LastFiscalYear;case"last-fiscal-period":return p.a.LastFiscalPeriod;case"last-x-fiscal-years":return p.a.LastXFiscalYears;case"last-x-fiscal-periods":return p.a.LastXFiscalPeriods;case"next-x-fiscal-years":return p.a.NextXFiscalYears;case"next-x-fiscal-periods":return p.a.NextXFiscalPeriods;case"in-fiscal-year":return p.a.InFiscalYear;case"in-fiscal-period":return p.a.InFiscalPeriod;case"in-fiscal-period-and-year":return p.a.InFiscalPeriodAndYear;case"in-or-before-fiscal-period-and-year":return p.a.InOrBeforeFiscalPeriodAndYear;case"in-or-after-fiscal-period-and-year":return p.a.InOrAfterFiscalPeriodAndYear;case"begins-with":return p.a.BeginsWith;case"not-begin-with":return p.a.DoesNotBeginWith;case"ends-with":return p.a.EndsWith;case"not-end-with":return p.a.DoesNotEndWith;case"under":return p.a.Under;case"eq-or-under":return p.a.UnderOrEqual;case"not-under":return p.a.NotUnder;case"above":return p.a.Above;case"eq-or-above":return p.a.AboveOrEqual;default:throw Object(s.d)("Unable to parse operator from fetchXml Node: "+(new XMLSerializer).serializeToString(e))}}(e),o=function(e,t,n,r,a){const i=O(e,"value"),o=Object(y.a)(a,t,n);if(o){if(i){const e=j(o.Type,i),t=P(o.Type,r,e);return[new m(t,e)]}const t=[],n=e.childNodes;for(let e=0;e<n.length;e++)if("value"===n[e].nodeName){const a=j(o.Type,n[e].textContent),i=P(o.Type,r,a);t.push(new m(i,a))}return t}throw Object(s.d)("Unable to parse values from fetchXml Node: "+(new XMLSerializer).serializeToString(e))}(e,r||t,a,i,n);return new h(t,a,i,o)}function j(e,t){switch(e){case"boolean":let e=Object(o.a)(t);return void 0===e&&(e=1===parseInt(t,10)),e.toString();case"datetime":case"money":case"decimal":case"double":case"integer":case"picklist":case"state":case"status":case"entityname":case"string":case"memo":case"uniqueidentifier":case"bigint":case"calendarrules":case"virtual":case"managedproperty":case"entityname":case"customer":case"aliasedvalue":case"lookup":case"owner":case"partylist":default:return t}}function P(e,t,n){switch(e){case"boolean":return"System.Boolean";case"datetime":switch(t){case p.a.LastXHours:case p.a.NextXHours:case p.a.LastXDays:case p.a.NextXDays:case p.a.LastXWeeks:case p.a.NextXWeeks:case p.a.LastXMonths:case p.a.NextXMonths:case p.a.OlderThanXMonths:case p.a.OlderThanXYears:case p.a.OlderThanXWeeks:case p.a.OlderThanXDays:case p.a.OlderThanXHours:case p.a.OlderThanXMinutes:case p.a.LastXYears:case p.a.NextXYears:case p.a.InFiscalYear:case p.a.InFiscalPeriod:case p.a.InFiscalPeriodAndYear:case p.a.InOrBeforeFiscalPeriodAndYear:case p.a.InOrAfterFiscalPeriodAndYear:return"System.Int32";default:return"System.DateTime"}case"money":case"decimal":return"System.Decimal";case"double":return"System.Double";case"integer":return"System.Int32";case"picklist":case"state":case"status":case"entityname":return function(e){return Number.isInteger(Number(e))}(n)?"System.Int32":"System.String";case"string":case"memo":return"System.String";case"uniqueidentifier":return"System.Guid";case"bigint":return"System.Int64";case"calendarrules":case"virtual":case"managedproperty":case"entityname":case"customer":case"aliasedvalue":case"lookup":case"owner":case"partylist":default:return"System.Object"}}function T(e,t,n){const r=C(e),a=E(e);let i=null;const o=[],s=t,c=O(e,"name"),l=O(e,"from"),u=O(e,"to"),d=function(e){switch(O(e,"link-type")){case"outer":return p.e.LeftOuter;case"inner":return p.e.Inner;case"natural":return p.e.Natural;case"exists":return p.e.Exists;case"in":return p.e.In;case"matchfirstrowusingcrossapply":return p.e.MatchFirstRowUsingCrossApply;default:return p.e.Natural}}(e),g=O(e,"alias"),h=e.childNodes;for(let e=0;e<h.length;e++){const t=h[e].nodeName;"filter"===t?i=I(h[e],c,n):"link-entity"===t&&o.push(T(h[e],c,n))}return new f(u,s,c,l,d,i,o,r,g,a)}function N(e){let t=e.parentNode;for(;t;){if("link-entity"===t.nodeName||"entity"===t.nodeName)return O(t,"name");t=t.parentNode}}var A,R=n("whN/"),D=n("zjrO"),x=n("jZCH"),M=n("XvL5"),F=n("pah4"),k=n("/bjP"),L=n("504W");class B{constructor(e,t,n,r,a){this._Name=null,this._From=null,this._To=null,this._LinkType=null,this._Alias=null,this._RetrieveAllAttributes=!1,this._Attributes=null,this._Order=null,this._LinkEntity=null,this._Filters=null,this._set_name(e),this._set_from(t),this._set_to(n),this._set_linkType(Object(L.a)(r)?"":r),this._set_alias(Object(L.a)(a)?"":a),this._set_retrieveAllAttributes(!1),this.set_attributes([]),this._set_order(null),this._set_linkEntity(null),this._set_filters([])}_get_name(){return this._Name}_set_name(e){return this._Name=e,e}_get_from(){return this._From}_set_from(e){return this._From=e,e}_get_to(){return this._To}_set_to(e){return this._To=e,e}_get_linkType(){return this._LinkType}_set_linkType(e){return this._LinkType=e,e}_get_alias(){return this._Alias}_set_alias(e){return this._Alias=e,e}_get_retrieveAllAttributes(){return this._RetrieveAllAttributes}_set_retrieveAllAttributes(e){return this._RetrieveAllAttributes=e,e}get_attributes(){return this._Attributes}set_attributes(e){return this._Attributes=e,e}_get_order(){return this._Order}_set_order(e){return this._Order=e,e}_get_linkEntity(){return this._LinkEntity}_set_linkEntity(e){return this._LinkEntity=e,e}_get_filters(){return this._Filters}_set_filters(e){return this._Filters=e,e}getFetchXMLString(){let e='<link-entity name="'+this._get_name()+'" from="'+this._get_from()+'" to="'+this._get_to()+'"';if(e+=Object(L.a)(this._get_linkType())||Object(L.b)(this._get_linkType())?"":' link-type="'+this._get_linkType()+'"',e+=Object(L.a)(this._get_alias())||Object(L.b)(this._get_alias())?"":' alias="'+this._get_alias()+'"',e+=">",this._get_retrieveAllAttributes())e+="<all-attributes />";else for(let t=0;t<this.get_attributes().length;t++)e+=this.get_attributes()[t].toString();Object(L.a)(this._get_order())||(e+=this._get_order().toString());for(let t=0;t<this._get_filters().length;t++)e+=this._get_filters()[t].toFetchXml();return Object(L.a)(this._get_linkEntity())||(e+=this._get_linkEntity().getFetchXMLString()),e+="</link-entity>",e}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */!function(e){e[e.count=0]="count",e[e.countcolumn=1]="countcolumn",e[e.sum=2]="sum",e[e.avg=3]="avg",e[e.min=4]="min",e[e.max=5]="max"}(A||(A={}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class U{constructor(e,t,n,r){this._Name=null,this._Alias=null,this._Aggregate=null,this._GroupBy=null,this._set_name(e),this.set_alias(Object(L.a)(t)?"":t),this.set_aggregate(n),this.set_groupBy(r)}_get_name(){return this._Name}_set_name(e){return this._Name=e,e}get_alias(){return this._Alias}set_alias(e){return this._Alias=e,e}get_aggregate(){return this._Aggregate}set_aggregate(e){return this._Aggregate=e,e}get_groupBy(){return this._GroupBy}set_groupBy(e){return this._GroupBy=e,e}toString(){let e='<attribute name="'+this._get_name()+'"';return e+=Object(L.a)(this.get_alias())||Object(L.b)(this.get_alias())?"":' alias="'+this.get_alias()+'"',e+=null!=this.get_aggregate()?' aggregate="'+A[this.get_aggregate()]+'"':"",e+=null!=this.get_groupBy()?' groupby="'+this.get_groupBy().toString()+'"':"",e+=" />",e}}var V=n("SRlt"),z=n("8tWD"),q=n("fYtF"),H=n("sZ+8"),W=n("/Zy9");class G{constructor(){this._wheres=[],this._sorts=[],this._selects=[],this._contextFiltersAndIds=[],this._linkEntities=[],this._isWheresDirty=!1,this._isContextFiltersAndIdsDirty=!1,this._isSortsDirty=!1,this._isSelectsDirty=!1,this._searchString="",this._isQuickFindSearch=!1,this._queryBuilderTelemetryHelper=new q.b}getQueryState(){return this._queryBuilderTelemetryHelper.addOperation("to","getQueryState"),this._queryBuilderTelemetryHelper.addQueryInfoAndSendLog(a.a.toString(this._sourceId),this.entityLogicalName),{expression:null,fetchXml:this.fetchXml,key:this.getKey(),viewId:this._sourceId,wheres:this._wheres,sorts:this._sorts,selects:this._selects,contextFiltersAndIds:this._contextFiltersAndIds,linkEntities:this._linkEntities,offlineSql:this.offlineSql,searchString:this._searchString,isQuickFindSearch:this._isQuickFindSearch,rollupType:this._rollupType,target:this._target}}get pageSize(){return this._query.get_PageSize()}get entityLogicalName(){return this._query.get_EntityLogicalName()}get fetchXml(){return this._query.get_FetchXml()}get offlineSql(){return this._query.get_RawSql()}get queryStatus(){return this._query.queryStatus}set pageSize(e){e&&this._queryBuilderTelemetryHelper.addOperation("setPageSize",e.toString()),this._query.set_PageSize(e)}get pageNumber(){return this._query.get_PageNumber()}set pageNumber(e){e&&this._queryBuilderTelemetryHelper.addOperation("setPageNumber",e.toString()),this._query.set_PageNumber(e)}get pagingCookie(){return this._query.get_PagingCookie()}set pagingCookie(e){this._query.set_PagingCookie(e)}get target(){return this._target}get rollupType(){return this._rollupType}setQuickFindSearch(e){this._searchString=e,this._isQuickFindSearch=!1,this._searchString?(this._isQuickFindSearch=!0,this._queryBuilderTelemetryHelper.addOperation("searchString")):this._searchString=""}_getBaseKey(){return this._sourceId?`${this._query.get_EntityLogicalName()}-${a.a.toString(this._sourceId)}`:this._query.get_EntityLogicalName()}removeFromSelects(e){let t;this._queryBuilderTelemetryHelper.addOperation("removeFromSelects",e),-1!==(t=this._selects.indexOf(e))&&this._selects.splice(t)}hasColumn(e){return-1!==this._selects.indexOf(e)}_sortIfRequired(){this._isWheresDirty&&(this._wheres.sort(),this._isWheresDirty=!1),this._isSortsDirty&&(this._sorts.sort(),this._isSortsDirty=!1),this._isContextFiltersAndIdsDirty&&(this._contextFiltersAndIds.sort(),this._isContextFiltersAndIdsDirty=!1),this._isSelectsDirty&&(this._selects.sort(),this._isSelectsDirty=!1)}getKey(){return this._sortIfRequired(),`${this._getBaseKey()}: ${this._selects}: ${this._wheres}: ${this._sorts}: ${this._contextFiltersAndIds}: ${this._linkEntities}: ${this._isQuickFindSearch}: ${this._searchString}: ${this.pageSize}${this._getRollupKey()}`}getPublicKey(){return this._sortIfRequired(),`${this._getBaseKey()}: ${this._selects}: ${this._sorts}: ${this._contextFiltersAndIds}: ${this._linkEntities}: ${this._isQuickFindSearch}: ${this.pageSize}${this._getRollupKey()}`}getKeyQuery(){return this._queryBuilderTelemetryHelper.addOperation("to","getKeyQuery"),this._queryBuilderTelemetryHelper.addQueryInfoAndSendLog(a.a.toString(this._sourceId),this.entityLogicalName),this._query}orderBy(e,t=!1){const n=this._query.get_SortingInfo();n.addSorter(e,t),this._sorts=[];for(const e of n.get_Sorters())this._sorts.push(e.toString()),this._queryBuilderTelemetryHelper.addOperation("orderBy",e.toString());return this._query.setSortingInfo(n,x.a.get_DefaultInstance().get_MetadataCache()),this._isSortsDirty=!0,this}where(e,t,n){const a=r.a.toLegacyFilterExpression(e,n).toFetchXml();return this._query.setContextFilterAndExtraConditions(null,null,a,null,null,x.a.get_DefaultInstance().get_MetadataCache()),t?this._wheres=[a]:this._wheres.push(a),this._isWheresDirty=!0,this._queryBuilderTelemetryHelper.addOperation("where"),this}select(...e){if(!Object(V.f)(this._query).getAllColumns){const t=this._query.get_ColumnSet().get_Columns().concat(e),n=new M.a(t);this._query.set_ColumnSet(n);const r=[];for(let t=0;t<e.length;t++)-1===this._selects.indexOf(e[t])&&r.push(e[t]);this._query.setExtraAttributes(r),this._selects.push(...r)}return this._isSelectsDirty=!0,this._queryBuilderTelemetryHelper.addOperation("select",e.toString()),this}addChildCountAttribute(e){return this._query.addChildCountAttribute(e),this._queryBuilderTelemetryHelper.addOperation("addChildCountAttribute",e),this}validateLinkedEntity(e,t){e&&!Object(H.n)(e,t.name)&&this.queryStatus.push({failed:!0,offlineModeSpecific:!0,message:"Error.LinkedEntity.NotAvailable.Offline",parameter:t.name})}addLinkedEntity(e,t){const n=new B(e.name,e.from,e.to,e.linkType,e.alias),r=n.get_attributes();for(const e of t){const t=new U(e);r.push(t)}n.set_attributes(r);const a=n.getFetchXMLString();return-1===this._linkEntities.indexOf(a)&&(this._query.setContextFilterAndExtraConditions(null,null,null,null,a,x.a.get_DefaultInstance().get_MetadataCache()),this._linkEntities.push(a)),this._queryBuilderTelemetryHelper.addOperation("addLinkedEntity",a),this}applyContextFilter(e,t,n,r=R.a.Referencing){const i=this._query.get_EntityLogicalName(),o=Object(W.d)(e,i,r,n),s=a.a.toString(t);return this._query.setContextFilterAndExtraConditions(s,o.contextFilter,null,null,null,x.a.get_DefaultInstance().get_MetadataCache()),this.addExistingContextFilterToKey(s,o.contextFilter),this._queryBuilderTelemetryHelper.addOperation("applyContextFilter",`${s}=${o.contextFilter}`),this}addExistingContextFilterToKey(e,t){this._contextFiltersAndIds.push(`${e}=${t}`),this._isContextFiltersAndIdsDirty=!0}static fromState(e,t){const n=G.fromXmlAndSql(e.fetchXml,e.offlineSql,e.viewId,e.searchString,e.viewPrimaryEntityName,t);n._queryBuilderTelemetryHelper.addOperation("from","fromState"),n._wheres=e.wheres,n._sorts=e.sorts,n._contextFiltersAndIds=e.contextFiltersAndIds,n._selects=e.selects,n._linkEntities=e.linkEntities,n._rollupType=e.rollupType,n._target=e.target,n._searchString=e.searchString,n._isQuickFindSearch=e.isQuickFindSearch;const r=n._query.get_SortingInfo();for(const t of e.sorts){const e=t.split("="),n=e[0].trim(),a=e[1].trim();r.addSorter(n,"true"===a)}return n._query.set_OverrideKey(n.getKey()),n._query.set_PublicKey(n.getPublicKey()),n}static fromXmlAndSql(e,t,n,r,i,o){const s=n&&a.a.toString(n),c=new k.a;if(c.updateDescriptorSet(z.a.FetchXml,e),t&&c.updateDescriptorSet(z.a.Sql,t),r){const e=new F.a(c,r,[i],s,o),n=e.getUpdatedSql(),a=e.getUpdatedFetchXml();c.updateDescriptorSet(z.a.FetchXml,a),t&&c.updateDescriptorSet(z.a.Sql,n)}const l=new G;return l._sourceId=n,l._query=new D.a(c,s),l._query.get_ColumnSet()||l._query.set_ColumnSet(new M.a([])),l._query.get_PageSize()||l._query.set_PageSize(G.defaultPageSize),l._query.get_PageNumber()||l._query.set_PageNumber(1),t&&i&&o&&"function"==typeof o&&(Object(H.n)(o(),i)||l.queryStatus.push({failed:!0,offlineModeSpecific:!0,message:"Error.MainEntity.NotAvailable.Offline",parameter:i}),c.updateDescriptorSet(z.a.Sql,t)),l._queryBuilderTelemetryHelper.addOperation("from","fromXmlAndSql"),r&&l._queryBuilderTelemetryHelper.addOperation("searchString"),l}static fromXml(e,t){const n=t&&a.a.toString(t),r=new G;return r._sourceId=t,r._query=new D.a(e,n),r._query.get_PageSize()||r._query.set_PageSize(G.defaultPageSize),r._query.get_PageNumber()||r._query.set_PageNumber(1),r._queryBuilderTelemetryHelper.addOperation("from","fromXml"),r}static getSortsFromXml(e,t){if(e){const n=G.fromXml(e,t);if(n){n._query.setSortingInfo(null);const e=n._query.get_SortingInfo();if(e){n._sorts||(n._sorts=[]);for(const t of e.get_Sorters())t&&n._sorts.push(t.toString());n._sorts.sort()}const t=n.getQueryState();if(t)return t.sorts}}return[]}static get defaultPageSize(){return 25}setDefaultPageSize(){this.pageSize=G.defaultPageSize}applyRollupContextFilter(e,t){this._target=e,this._rollupType=t,this._query.set_OverrideKey(this.getKey()),e&&this._queryBuilderTelemetryHelper.addOperation("applyRollupContextFilter",`${i.a.toString(e)}=${t}`)}toQueryExpression(e,t,n){return this._queryBuilderTelemetryHelper.addOperation("to","toQueryExpression"),this._queryBuilderTelemetryHelper.addQueryInfoAndSendLog(a.a.toString(this._sourceId),this.entityLogicalName),_(this.fetchXml,e,t,n)}containsError(){return this.queryStatus.some(e=>e.failed)}getErrors(){return this.queryStatus.filter(e=>e.failed)}getFirstError(){return this.queryStatus.find(e=>e.failed)}_getRollupKey(){return null!==this._rollupType&&void 0!==this._rollupType&&this._target?`: ${this._rollupType}: ${i.a.toString(this._target)}`:""}}},vONk:function(e,t,n){"use strict";n.d(t,"a",(function(){return ce}));var r,a=n("8kVO"),i=n("JdSN"),o=n("umme"),s=n("84PK"),c=n("504W"),l=n("l3Ef"),u=n("03Hu"),d=n("Q7Xa"),p=n("FZk4");!function(e){e[e.conflict=0]="conflict",e[e.recordNotFound=1]="recordNotFound",e[e.recordAlreadyExists=2]="recordAlreadyExists",e[e.others=3]="others"}(r||(r={}));var f=n("3ri3"),g=n("HYaY"),h=n("WRF3"),m=n("IvgJ"),b=n("sdkC"),y=n("T544"),_=n("jZCH"),v=n("JPoD"),S=n("EW4s"),O=n("/A0C"),C=n("Uv1Y");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function E(e,t,n,a,i,o,u,d,p,E,I,w){const j=new S.a,P=function(e){let t;switch(e=Object(C.e)(e)){case-2147220969:t=r.recordNotFound;break;case-2147220685:case-2147220937:t=r.recordAlreadyExists;break;case-2147088254:case-2147088253:t=0;break;default:t=r.others}return t}(E),T=P!==r.recordNotFound&&t.toLowerCase()!==l.n?new h.a(e,n,a):null,N={},A={},R=new Array(0);R.push(f.S),N[f.S]=O.a.String,A[f.S]=e,R.push(f.Q),N[f.Q]=O.a.String,A[f.Q]=t,Object(c.a)(T)||(R.push(f.V),N[f.V]=O.a.Lookup,A[f.V]=T),R.push(f.R),N[f.R]=O.a.String,A[f.R]=null==u?void 0:u.substring(0,9999),R.push(f.U),N[f.U]=O.a.DateTime,A[f.U]=d||new Date,R.push(f.X),N[f.X]=O.a.String,A[f.X]=p,R.push(f.N),N[f.N]=O.a.String,A[f.N]=null==E?void 0:E.toString();const D={};D[l.db]=P,R.push(f.P),N[f.P]=O.a.PickList,A[f.P]=m.a.createFromObjectData(D),R.push(f.T),N[f.T]=O.a.String,R.push(f.O),N[f.O]=O.a.String;const x={};return x[f.T]=o,x[f.O]=I,function(e){const t=new S.a,n=new y.a(v.k,Object.keys(e));return _.a.get_DefaultInstance().retrieveMultipleAttributeMetadata(n,null).then(n=>{for(const t of n){const n=e[t.get_logicalName()];!Object(c.a)(t)&&!Object(c.a)(n)&&n.length>t.get_maxLength()&&(e[t.get_logicalName()]=n.substring(0,t.get_maxLength()))}t.resolve(e)},e=>{t.reject(e)}),t}(x).then(e=>{for(const t in e)A[t]=e[t];let t=w;Object(c.a)(t)&&(t=new h.a(v.k,s.a.newGuid())),j.resolve(new g.a(t,A,N,{},{},new b.a(new Array(0))))},e=>{A[f.O]="Empty Error details as RetreiveAttributeMetadata failed for UpSyncConstants.SyncErrorErrorDetail",A[f.T]="Empty Error message as RetreiveAttributeMetadata failed for UpSyncConstants.SyncErrorLogErrorMessage";let t=w;Object(c.a)(t)&&(t=new h.a(v.k,s.a.newGuid())),j.resolve(new g.a(t,A,N,{},{},new b.a(new Array(0))))}),j}var I,w=n("1nJ/");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */!function(e){e[e.draft=0]="draft",e[e.inProgress=1]="inProgress",e[e.completed=2]="completed",e[e.failed=3]="failed"}(I||(I={}));var j=n("DijY"),P=n("pHbk"),T=n("3fL6"),N=n("thzq"),A=n("jqlv"),R=n("MUIu"),D=n("31Vn");const x=[f.Z,f.M,f.G];class M{constructor(e){this._NorSyncLogHelper=null,this._set_NorSyncLogHelper(e)}_get_NorSyncLogHelper(){return this._NorSyncLogHelper}_set_NorSyncLogHelper(e){return this._NorSyncLogHelper=e,e}async handle(e,t,n){var r;try{e.get_commandType()?await this._RollbackNonCRUDCommand(e):await this._RollbackCRUDCommand(e)}catch(e){Object(A.m)("OfflineUpSync.RollBackHandler.RollbackCommand.Failure",(null===(r=e.get_Message)||void 0===r?void 0:r.call(e))||e.message)}try{const r=await this._AddRecordSyncErrorLog(e,t,n);return w.a.IncrementSyncErrorsCount(),Object(A.l)("OfflineUpSync.RollBackHandler.Handle.Success",`Rollback of failed ${Object(A.j)(e.get_commandType())} command succeeded`),r}catch(e){throw e=e instanceof o.a?e:o.a.fromGenericError(e),Object(A.k)("OfflineUpSync.RollBackHandler.Handle.Failure",e.get_Message()),e}}async _RollbackCRUDCommand(e){const t=[],n=[];if(n.push(this._RollbackOperation(e.get_associatedEntityLog(),e.get_entityRecord().get_identifier().LogicalName,e.get_sqlOperation())),!Object(c.a)(e.get_associatedActivityParties())&&e.get_associatedActivityParties().length>0)for(const t of e.get_associatedActivityParties())n.push(this._RollbackOperation(t.get_associatedEntityLog(),l.d,t.get_sqlOperation()));const r=await Promise.all(n);return!Object(c.a)(r)&&(t.push(...r),await this._get_NorSyncLogHelper().performOperations(t,null,!0),!0)}async _RollbackNonCRUDCommand(e){const t=e.get_command(),n=e.get_associatedCommandMainLogs(),r=e.get_associatedCommandEntityLogs(),a=[],i=[],o=[];for(let e=n.length-1;e>=0;e--){const t=n[e],a=r[t.get_SID().toString()],i=Object(A.c)(t);o.push(this._RollbackOperation(a,i,t.get_operationType()))}const s=await Promise.all(o);for(const e of s)Object(c.a)(e)||a.push(e);const l=this._get_NorSyncLogHelper().updateCommandStatus(t,I.failed);return Object(c.a)(l)||i.push(l),await this._get_NorSyncLogHelper().performOperations(a,i,!0),!0}async _AddRecordSyncErrorLog(e,t,n){if(Object(A.l)("OfflineUpSync.RollBackHandler._AddRecordSyncErrorLog.Start","Sync Error Creation Started"),!e.get_commandType())return this._CreateSyncErrorLog(e,t,n);const r=e,a=r.get_command();let i="",c=s.a.get_empty(),l=null;try{if(e.get_commandType()===j.a.changeProcessAndStage){const e=JSON.parse(a.get_actionData());i=e[f.r].toString(),l=await _.a.get_DefaultInstance().retrieveEntityMetadata(i,null).nativePromise(),c=s.a.tryCreate(e[f.q].toString())}else{const e=r.get_associatedCommandMainLogs()[r.get_associatedCommandMainLogs().length-1],t=r.get_associatedCommandEntityLogs()[e.get_SID().toString()];i=Object(A.c)(e),l=await _.a.get_DefaultInstance().retrieveEntityMetadata(i,null).nativePromise(),c=s.a.tryCreate(t[l.get_primaryIdAttribute()].toString())}await this._CreateSyncErrorRecordAndLog(i,a.get_name(),c,i,l.get_logicalName(),t.get_message(),"",t.get_errorTime(),"",t.get_errorCode(),t.get_errorDetail(),n)}catch(e){throw e=e instanceof o.a?e:o.a.fromGenericError(e),Object(A.k)("OfflineUpSync.RollBackHandler._AddRecordSyncErrorLog.Fail",e.get_Message()),e}}async _CreateSyncErrorRecordAndLog(e,t,n,r,a,i,s,c,l,u,d,p){const f=await E(e,t,n,r,0,i,s,c,l,u,d);try{return await P.a.get_instance().createSyncErrorLog(f,null,p),Object(A.l)("OfflineUpSync.RollBackHandler._AddRecordSyncErrorLog.Success","Sync Error Creation Succeeded"),!0}catch(e){throw e=e instanceof o.a?e:o.a.fromGenericError(e),Object(A.k)("OfflineUpSync.RollBackHandler._AddRecordSyncErrorLog.Fail: CreateSyncErrorLog Fail",e.get_Message()),e}}async _CreateSyncErrorLog(e,t,n){const r=Object(A.i)(e.get_associatedMainLog()),a=Object(A.d)(r),i=await _.a.get_DefaultInstance().retrieveEntityMetadata(a,null).nativePromise(),s=e.get_entityRecord(),u=s.get_identifier().Id;if(!Object(c.a)(s)){const r=!!i&&(i.get_isActivity()||a===l.d),d=e.get_sqlOperation();let p=await async function(e,t,n,r){Object(A.l)("RollbackHandler:CreateActionData","Started");let a=r;!Object(c.a)(a)&&a.length||(a=e.get_changedFieldNames());const i=await _.a.get_DefaultInstance().retrieveEntityMetadata(e.get_identifier().LogicalName,null).nativePromise(),s=new y.a(i.get_logicalName(),a);try{const t=await _.a.get_DefaultInstance().retrieveMultipleAttributeMetadata(s,null).nativePromise();let r="",a="";const o="/n";for(const s of t)if(!Object(c.a)(s)&&s.get_type()!==O.a.UniqueIdentifier){const t=s.get_displayName(),u=s.get_logicalName(),d=e.getValue(u);if(Object(c.a)(d))r+=`${t} - ${o}`,a+=`${u} - ${o}`;else if(s.get_type()===O.a.Lookup||s.get_type()===O.a.Customer||s.get_type()===O.a.Owner){const e=d.Name,n=Object(D.b)(e);r+=`${t} - ${e}${o}`,a+=`${u} - ${n}${o}`}else if(s.get_type()!==O.a.State&&s.get_type()!==O.a.Status&&s.get_type()!==O.a.PickList&&s.get_type()){if(s.get_type()===O.a.EntityName&&n===l.n)continue;if(s.get_type()===O.a.DateTime){const e=Object(c.a)(d)?"":Object(R.c)(d);r+=`${t} - ${e}${o}`,a+=`${u} - ${e}${o}`}else{const e=d.toString(),n=Object(D.b)(e);r+=`${t} - ${e}${o}`,a+=`${u} - ${n}${o}`}}else{if(F(i,n,u))continue;const e=d.get_ValueString(),l="-1"===e||Object(c.a)(s.get_optionSet().get_options()[e])?"":s.get_optionSet().get_options()[e].get_Label();r+=`${t} - ${l}${o}`,a+=`${u} - ${l}${o}`}}return Object(A.l)("RollbackHandler:CreateActionData","Completed"+a),r}catch(e){return e=e instanceof o.a?e:o.a.fromGenericError(e),Object(A.m)("RollbackHandler: CreateActionData Failure",e.get_Message()),""}}(s,0,N.a[d]),f=await this._CreateRequestData(s,i,u.toString(),d);if(f=this._IsRequestDataRequired(d)?f:null,r){const t=this._GetActivityPartySyncErrorDetails(e,d,i);if(Object(c.a)(t.ActivityPartyActionData)||(p+=t.ActivityPartyActionData),this._IsRequestDataRequired(d)&&!Object(c.a)(t.ActivityPartyCollection)){const e=JSON.parse(f),n=t.ActivityPartyCollection;for(const t in n){const r={key:t,value:n[t]};e[r.key]=r.value}f=this._ConvertDictionaryToJsonString(e)}}return this._CreateSyncErrorRecordAndLog(a,N.a[d],u,Object(c.a)(s.getValue(i.get_primaryNameAttribute()))?"":s.getValue(i.get_primaryNameAttribute()).toString(),i.get_logicalName(),t.get_message(),p,t.get_errorTime(),f,t.get_errorCode(),t.get_errorDetail(),n)}Promise.resolve(!1)}_GetActivityPartySyncErrorDetails(e,t,n){const r=e.get_associatedActivityParties();let a="";const i={},o={},s=e.get_entityRecord();for(const e of r){const r=e.get_associatedMainLog(),i=e.get_entityRecord();if(!n.get_isActivity()||t!==N.a.Create||!this._IsOwnerActivityParty(i)){if(s.hasField(l.c)){const e=i.getValue(l.c),t=s.getValue(l.c);e.Id.toString()===t.toString()&&(a+=this._GetActivityPartyData(i)+"\r\n")}if(this._IsRequestDataRequired(t)&&r.get_operationType()!==N.a.Delete){const e=i.getValue(l.T);if(!Object(c.a)(e)){const t=l.U[e.get_value().toString()],n=i.getValue("partyid");if(!Object(c.a)(n)){const e=n.getObjectData();Object(c.a)(o[t])&&(o[t]=[]),o[t].push(e)}}}}}return i.ActivityPartyCollection=o,i.ActivityPartyActionData=a,i}_IsOwnerActivityParty(e){const t=e.getValue(l.T);if(!Object(c.a)(t)){if(l.U[t.get_value().toString()]===l.R)return!0}return!1}_GetActivityPartyData(e){const t=e.getValue(l.T);if(!Object(c.a)(t)){const n=l.U[t.get_value().toString()],r=e.getValue("partyid");if(!Object(c.a)(r)){return n+" - "+r.Name}}return""}_RollbackOperation(e,t,n){let r=null;return n===N.a.Create?this._RollBackCreateOperation(e,t):n===N.a.Delete?(r=this._RollBackDeleteOperation(e,t),Promise.resolve(r)):n===N.a.Update?(r=this._RollBackUpdateOperation(e,t),Promise.resolve(r)):void 0}async _RollBackCreateOperation(e,t){let n=null;const r=new Array(0);if(t===f.l.toLowerCase())return r[0]=new p.a(f.f,e[f.f].toString(),T.a.Or,0),new d.a(r,N.a.Delete,t);if(t===f.b.toLowerCase())return r[0]=new p.a(f.a,e[f.a].toString(),T.a.Or,0),new d.a(r,N.a.Delete,t);const a=await _.a.get_DefaultInstance().retrieveEntityMetadata(t,null).nativePromise();return Object(c.a)(e)||Object(c.a)(a)||(r[0]=new p.a(a.get_primaryIdAttribute(),e[a.get_primaryIdAttribute()].toString(),T.a.Or,0)),n=new d.a(r,N.a.Delete,t),n}_RollBackUpdateOperation(e,t){let n=null;return Object(c.a)(e)||(e=this._RemoveUnwantedEntityLog(e),n=new d.a(e,N.a.Update,t)),n}_RollBackDeleteOperation(e,t){let n=null;return Object(c.a)(e)||(e=this._RemoveUnwantedEntityLog(e),n=new d.a(e,N.a.Create,t)),n}_RemoveUnwantedEntityLog(e){return delete e[f.C],delete e[f.z],delete e[f.D],delete e[f.A],e}async _CreateRequestData(e,t,n,r){Object(A.l)("RollbackHandler:CreateRequestData","Started");const a=e.get_changedFieldNames(),i={},o=x,s=t.get_isBPFEntity();r===N.a.Create&&(o.push(t.get_primaryIdAttribute()),i[t.get_primaryIdAttribute()]=n),t.get_isActivity()&&o.push(l.U[9]),i[l.X]=n,i[l.s]=t.get_logicalName();for(let e=0;e<a.length;e++){const t=a[e];o.indexOf(t)>=0&&a.splice(e,1)}const d=new y.a(t.get_logicalName(),a),p=await _.a.get_DefaultInstance().retrieveMultipleAttributeMetadata(d,null).nativePromise();for(const n of p)if(!Object(c.a)(n))if(s){const r=JSON.parse(u.a.get_DefaultInstance().get_offlineTypescriptInterface().transformToODataValue(t.get_logicalName(),n.get_logicalName(),e)),a=Object.keys(r)[0];i[a]=r[a].toString()}else if(Object(c.a)(e.getValue(n.get_logicalName())))i[n.get_logicalName()]="";else if(n.get_type()===O.a.Lookup||n.get_type()===O.a.Customer||n.get_type()===O.a.Owner){const t=e.getValue(n.get_logicalName()),r=t.getObjectData();r.id=t.get_key(),r.entityType=t.getValue("LogicalName");const a=[];a.push(r),i[n.get_logicalName()]=a}else if(n.get_type()!==O.a.State&&n.get_type()!==O.a.Status&&n.get_type()!==O.a.PickList&&n.get_type()){if(n.get_type()===O.a.EntityName&&r===N.a.Create)continue;n.get_type()===O.a.DateTime?i[n.get_logicalName()]=Object(c.a)(e.getValue(n.get_logicalName()))?"":Object(R.c)(e.getValue(n.get_logicalName())):i[n.get_logicalName()]=e.getValue(n.get_logicalName()).toString()}else{if(F(t,Object(A.h)(r),n.get_logicalName()))continue;const a=e.getValue(n.get_logicalName()).get_ValueString();i[n.get_logicalName()]="-1"!==a?a:""}return Object(A.l)("RollbackHandler:CreateRequestData","Completed"+i.toString()),this._ConvertDictionaryToJsonString(i)}_ConvertDictionaryToJsonString(e){return JSON.stringify(e)}_IsRequestDataRequired(e){return e===N.a.Create||e===N.a.Update}}function F(e,t,n){return!(Object(c.a)(e)||t.toLowerCase()!==l.n||!(e.get_isActivity()&&n===l.G||e.get_isCustomEntity()&&n===l.ab))}var k=n("WWG3");class L{constructor(e){this._norSyncLogHelper=null,this._norSyncLogHelper=e}async handle(e,t){if(!e.get_commandType())return this._SetLastSuccessfulSaveOnCrmKey(),!0;const n=e.get_command();if(!Object(c.a)(n)){const e=[],t=this._norSyncLogHelper.updateCommandStatus(n,I.completed);return e.push(t),await this._norSyncLogHelper.performOperations(null,e,!0),this._SetLastSuccessfulSaveOnCrmKey(),!0}return!1}_SetLastSuccessfulSaveOnCrmKey(){const e=new Date,t={};t[f.s]=k.a.get_instance().formatShortDateTimeValue(e,0),P.a.get_instance().saveOfflineErrorState(f.s,t)}}var B=n("QFtu"),U=n("dzep"),V=n("rWW8");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class z extends V.a{constructor(e,t,n){super(e,t),this.requestId=n}RequestId(){return this.requestId}toString(){return"["+this.get_callerName()+"]"}}var q=n("Jz2d"),H=n("SRlt"),W=n("NMtn"),G=n("6zk2"),K=n("GD3x"),Q=n("Xe7f"),X=n("qK01"),Y=n("hirD"),J=n("PF3G");async function $(e,t){let n=null;const r=await _.a.get_DefaultInstance().retrieveEntityMetadata(e.get_identifier().LogicalName,null).nativePromise(),a=r;switch(t){case N.a.Update:n=new J.a(e),!Object(c.a)(a)&&a.get_isOptimisticConcurrencyEnabled()&&u.a.get_DefaultInstance().get_offlineTypescriptInterface().getIsConflictDetectionEnabledForMobileClient()&&n.set_concurrencyBehavior(G.a.IfRowVersionMatches),n.set_returnRowVersion(!0),n.offlineData={[r.get_primaryIdAttribute()]:e.get_identifier().Id.toString()};break;case N.a.Delete:n=new X.a(e.get_identifier()),!Object(c.a)(a)&&a.get_isOptimisticConcurrencyEnabled()&&_.a.get_DefaultInstance().get_UserContext().get_organizationSettings().get_isConflictDetectionEnabledForMobileClient()&&n.set_concurrencyBehavior(G.a.IfRowVersionMatches),n.offlineData={[r.get_primaryIdAttribute()]:e.get_identifier().Id.toString()};break;case N.a.Create:n=new Q.a(e),n.offlineData={[r.get_primaryIdAttribute()]:e.get_identifier().Id.toString()},n.set_returnRowVersion(!0)}return n}var Z=n("/oKV");let ee=null;class te{constructor(){this._proxy=null}get_proxy(){if(!this._proxy){const e=_.a.get_DefaultInstance().get_ServerUri();this._proxy=new q.a(e,_.a.get_DefaultInstance().get_RemoteCallRetryHandler())}return this._proxy}async upSync(e,t,n){let r;try{r=await async function(e,t){Object(W.b)(e,f.p);const n=[];let r=null;const a=[];for(const t of e){const e=t;a.push($(e.get_entityRecord(),e.get_sqlOperation()))}const i=await Promise.all(a);return n.push(...i),r=new Y.a(n,new K.a(t,!0)),r}(e,!t)}catch(e){throw e=e instanceof o.a?e:o.a.fromGenericError(e),i.a.fromErrorCode(e.get_ErrorCode())}try{const e=s.a.newGuid().toString();return Object(U.a)(n,H.c.CLIENT_REQUEST_ID,e),_.a.get_DefaultInstance().execute(r,new z("","MobileClient-OfflineSync",e),Z.a.Remote)}catch(e){let t;throw e instanceof i.a?t=e:(e=e instanceof o.a?e:o.a.fromGenericError(e),t=new i.a(null,"",e.get_Message())),Object(U.a)(n,B.e,t.get_message()),u.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentError("Offline.Upsync","Upsync.Failure.Cud",n),t}}upSyncJson(e){const t=JSON.parse(e[0].get_command().get_actionData());return Object(c.a)(t)?Promise.resolve(null):this.get_proxy().changeProcessAndStage(t[f.q].toString(),t[f.r].toString(),t[f.G].toString(),t[f.M].toString(),t[f.Z].toString()).nativePromise()}static get_instance(){return ee||(ee=new te),ee}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class ne{constructor(){this._Message=null,this._ErrorDetail=null,this._ErrorCode=0,this._ErrorTime=null}get_message(){return this._Message}set_message(e){return this._Message=e,e}get_errorDetail(){return this._ErrorDetail}set_errorDetail(e){return this._ErrorDetail=e,e}get_errorCode(){return this._ErrorCode}set_errorCode(e){return this._ErrorCode=e,e}get_errorTime(){return this._ErrorTime}set_errorTime(e){return this._ErrorTime=e,e}}var re=n("eruq"),ae=n("pEXn"),ie=n("SAYH"),oe=n("Er26");let se=null;class ce{constructor(e){this._NorSyncLogHelper=null,this._ActionDataList=null,this._RowVersionMap=null,this._syncErrorRetryLimit=3,this._SidToDelete=null,this._CommandId=null,this._StartTransaction=!1,this._EndTransaction=!1,this._SyncErrorSid=null,this._EntityLogTables=null,this._PlaybackQueue=null,this._HasNetworkIssueDuringUpsync=!1,this._entityReferenceMap={},this._set_NorSyncLogHelper(e),this._set_hasNetworkIssueDuringUpsync(!1),this._set_ActionDataList([]),this.set_playbackQueue([]),this._set_RowVersionMap({}),this._set_SidToDelete([]),this._set_SyncErrorSid([]),this._set_EntityLogTables([]),this._set_CommandId(s.a.get_empty()),this._set_StartTransaction(!1),this._set_EndTransaction(!1)}static get_OverallSyncErrorMessage(){return se}static set_OverallSyncErrorMessage(e){se=e}_get_NorSyncLogHelper(){return this._NorSyncLogHelper}_set_NorSyncLogHelper(e){return this._NorSyncLogHelper=e,e}_get_ActionDataList(){return this._ActionDataList}_set_ActionDataList(e){return this._ActionDataList=e,e}_get_RowVersionMap(){return this._RowVersionMap}_set_RowVersionMap(e){return this._RowVersionMap=e,e}_get_SidToDelete(){return this._SidToDelete}_set_SidToDelete(e){return this._SidToDelete=e,e}_get_CommandId(){return this._CommandId}_set_CommandId(e){return this._CommandId=e,e}_get_StartTransaction(){return this._StartTransaction}_set_StartTransaction(e){return this._StartTransaction=e,e}_get_EndTransaction(){return this._EndTransaction}_set_EndTransaction(e){return this._EndTransaction=e,e}_get_SyncErrorSid(){return this._SyncErrorSid}_set_SyncErrorSid(e){return this._SyncErrorSid=e,e}_get_EntityLogTables(){return this._EntityLogTables}_set_EntityLogTables(e){return this._EntityLogTables=e,e}get_playbackQueue(){return this._PlaybackQueue}set_playbackQueue(e){return this._PlaybackQueue=e,e}get_hasNetworkIssueDuringUpsync(){return this._HasNetworkIssueDuringUpsync}_set_hasNetworkIssueDuringUpsync(e){return this._HasNetworkIssueDuringUpsync=e,e}async processBatchForUpSync(e){try{if(this.get_hasNetworkIssueDuringUpsync())return Object(A.l)("OfflineUpSync.PlaybackBatchManager.ProcessBatchForUpSync.NetworkFailure","ProcessPlaybackQueue Stopped"),this.set_playbackQueue([]),!1;if(!this.get_playbackQueue().length)return this._get_SidToDelete().length>0&&this._get_NorSyncLogHelper().clearNorSyncLogs(this._get_SidToDelete(),this._get_EntityLogTables(),this._get_CommandId()),await this._ProcessActionDataList(!0,e),Object(A.l)("OfflineUpSync.PlaybackBatchManager.ProcessBatchForUpSync.Success","ProcessPlaybackQueue Completed"),!0;const t=this.get_playbackQueue().shift();return await this._ProcessUpSyncDataList(t,0,e),t.length>0&&Object(A.l)("OfflineUpSync.PlaybackBatchManager.ProcessBatchForUpSync.Success",`Total Number of ${t[0].get_commandType()?"Non ":""}CRUD Commands for current batch is ${t.length}`),Object(A.l)("OfflineUpSync.PlaybackBatchManager.ProcessBatchForUpSync.Success","BatchItem Processed"),!0}catch(e){throw e=e instanceof o.a?e:o.a.fromGenericError(e),Object(A.k)("OfflineUpSync.PlaybackBatchManager.ProcessBatchForUpSync.Failure",e.get_Message()),e}}async _ProcessUpSyncDataList(e,t,n){if(Object(A.l)("OfflineUpSync.PlaybackBatchManager._ProcessUpSyncDataList","ProcessUpSyncDataList Started"),Object(c.a)(e)||e.length===t||this.get_hasNetworkIssueDuringUpsync())return Object(A.l)("OfflineUpSync.PlaybackBatchManager._ProcessUpSyncDataList.Success","ProcessUpSyncDataList Completed"),!0;try{return await this._ProcessUpSyncDataItem(e[t],n),await this._ProcessUpSyncDataList(e,++t,n),!0}catch(e){throw e=e instanceof o.a?e:o.a.fromGenericError(e),Object(A.k)("OfflineUpSync.PlaybackBatchManager._ProcessUpSyncDataList.Failure",e.get_Message()),e}}async _ProcessUpSyncDataItem(e,t){if(Object(A.l)("OfflineUpSync.PlaybackBatchManager._ProcessUpSyncDataItem.Started","ProcessUpSyncDataList Started"),Object(c.a)(e))return Object(A.l)("OfflineUpSync.PlaybackBatchManager._ProcessUpSyncDataItem.Success","ProcessUpSyncDataList Completed"),!0;try{if(await this._ExecuteActionDataListIfRequired(e,t)&&!this.get_hasNetworkIssueDuringUpsync()){if(e.get_commandType()){if(e.get_commandType()===j.a.transaction){if(!this._get_StartTransaction()&&e.get_associatedMainLog().get_logTableID().toLowerCase()===f.E.toLowerCase())return this._set_StartTransaction(!0),Object(A.l)("OfflineUpSync.PlaybackBatchManager._ProcessUpSyncDataItem.Success","ProcessUpSyncDataList Completed"),!0;if(this._get_StartTransaction()===this._get_EndTransaction())return Object(A.l)("OfflineUpSync.PlaybackBatchManager._ProcessUpSyncDataItem.Success","ProcessUpSyncDataList Completed"),!0;throw o.a.FromMessage("Invalid Transaction")}return await this._ProcessNonCRUDItem(e,t),Object(A.l)("OfflineUpSync.PlaybackBatchManager._ProcessUpSyncDataItem.Success","ProcessUpSyncDataList Completed"),!0}return this._isFileOrImageTypeOperation(e)?(Object(A.l)("OfflineUpSync.PlaybackBatchManager._ProcessUpSyncDataItem","ProcessCRUDItem for file attachment or image"),await this._ProcessFileOrImageTypeItem(e,t),Object(A.l)("OfflineUpSync.PlaybackBatchManager._ProcessUpSyncDataItem.Success","File/image upsync Completed"),!0):(await this._ProcessCRUDItem(e,t),Object(A.l)("OfflineUpSync.PlaybackBatchManager._ProcessUpSyncDataItem.Success","ProcessUpSyncDataList Completed"),!0)}return Object(A.l)("OfflineUpSync.PlaybackBatchManager._ProcessUpSyncDataItem.Success","ProcessUpSyncDataList Completed"),!0}catch(e){throw e=e instanceof o.a?e:o.a.fromGenericError(e),Object(A.k)("OfflineUpSync.PlaybackBatchManager._ProcessUpSyncDataItem.Failure",e.get_Message()),e}}_ExecuteActionDataListIfRequired(e,t){Object(A.l)("OfflineUpSync.PlaybackBatchManager._ExecuteActionDataListIfRequired","ExecuteActionDataListIfRequired Started");const n=e.get_associatedMainLog().get_logTableID();if(w.a.get_skipTables().indexOf(n)>=0)return Object(A.l)("OfflineUpSync.PlaybackBatchManager._ExecuteActionDataListIfRequired.Success","ExecuteActionDataListIfRequired Completed"),this._AddNorSyncLogtoDelete(e.get_associatedMainLog()),Promise.resolve(!1);if(e.get_commandType()===j.a.transaction)return n===f.F&&this._set_EndTransaction(!0),this._AddNorSyncLogtoDelete(e.get_associatedMainLog()),this._ProcessActionDataList(!0,t);if(e.get_commandType())return Object(A.l)("OfflineUpSync.PlaybackBatchManager._ExecuteActionDataListIfRequired.Non-CRUDActionEncountered","ExecuteActionDataListIfRequired Completed"),this._ProcessActionDataList(!0,t);const r=Object(A.c)(e.get_associatedMainLog());return this._isFileOrImageTypeOperation(e)?(Object(A.l)("OfflineUpSync.PlaybackBatchManager._ExecuteActionDataListIfRequired.FileOrImageTypeOperationEncountered","ExecuteActionDataListIfRequired Completed"),this._ProcessActionDataList(!0,t)):r===l.d||this._get_ActionDataList().length!==w.a.get_DefaultInstance().get_maxBatchSize()||this._get_StartTransaction()?(Object(A.l)("OfflineUpSync.PlaybackBatchManager.CheckActionDataListForExecution.Success","CheckActionDataListForExecution Completed"),Promise.resolve(!0)):(Object(A.l)("OfflineUpSync.PlaybackBatchManager._ExecuteActionDataListIfRequired.Success","ExecuteActionDataListIfRequired Completed"),this._ProcessActionDataList(!0,t))}_isFileOrImageTypeOperation(e){let t=!1;if(e.get_sqlOperation()===N.a.Update){const n=e.get_entityRecord(),r=n.get_fieldTypes();if(r){const e=n.get_changedFieldNames();e.forEach(n=>{r[n]!==O.a.Image&&r[n]!==O.a.File||(Object(A.l)("OfflineUpSync.PlaybackBatchManager._isFileOrImageTypeOperation","Found a file or image type operation. Changed field count = "+e.length),t=!0)})}else Object(A.k)("OfflineUpSync.PlaybackBatchManager._isFileOrImageTypeOperation","fieldTypes value is null")}return t}_ProcessCRUDItem(e,t){Object(A.l)("OfflineUpSync.PlaybackBatchManager._ProcessCRUDItem","ProcessCRUDItem Started");return e.get_entityRecord().get_identifier().LogicalName===l.d?(Object(A.l)("OfflineUpSync.PlaybackBatchManager._ProcessCRUDItem.Success","ProcessCRUDItem Completed"),this._HandleActivityParty(e)):(Object(A.l)("OfflineUpSync.PlaybackBatchManager._ProcessCRUDItem.Success","ProcessCRUDItem Completed"),this._get_ActionDataList().push(e),this._ProcessActionDataList(!1,t))}async _ProcessActionDataList(e,t){if(Object(A.l)("OfflineUpSync.PlaybackBatchManager._ProcessActionDataList","ProcessActionDataList Started"),this._get_ActionDataList().length>0){if(e&&this._get_StartTransaction()===this._get_EndTransaction())return Object(A.l)("OfflineUpSync.PlaybackBatchManager._ProcessActionDataList.Success","CRUD Criteria satisfied for Execution"),await this._ExecuteCUDBatch(t),!0;if(this._get_ActionDataList().length===w.a.get_DefaultInstance().get_maxBatchSize()&&!this._get_StartTransaction()){let e;try{e=await this._IsLastLogActivity()}catch(e){throw e=e instanceof o.a?e:o.a.fromGenericError(e),Object(A.l)("OfflineUpSync.PlaybackBatchManager._ProcessActionDataList.Failure",e.get_Message()),e}return e?(Object(A.l)("OfflineUpSync.PlaybackBatchManager._ProcessActionDataList.Success","ProcessActionDataList Completed"),!0):(Object(A.l)("OfflineUpSync.PlaybackBatchManager._ProcessActionDataList.Success","CRUD Criteria satisfied for Execution"),await this._ExecuteCUDBatch(t),!0)}return Object(A.l)("OfflineUpSync.PlaybackBatchManager._ProcessActionDataList.Success","ProcessActionDataList Completed"),!0}return Object(A.l)("OfflineUpSync.PlaybackBatchManager._ProcessActionDataList.Success","ProcessActionDataList Completed"),!0}_ExecuteCUDBatch(e){Object(A.l)("OfflineUpSync.PlaybackBatchManager._ProcessActionDataList.Success","Execution Started");return this._ProcessCrudCommandAction(),this._executeCommand(0,[],e)}_ProcessCrudCommandAction(){const e=[];Object(A.l)("OfflineUpSync.PlaybackBatchManager._ProcessCrudCommandAction","ProcessCrudCommandAction Started");for(let t=0;t<this._get_ActionDataList().length;t++){const n=this._get_ActionDataList()[t];if(!Object(c.a)(n))if(e.indexOf(n.get_entityRecord().get_key())>=0)l.fb in n.get_entityRecord().fields&&(delete n.get_entityRecord().fields[l.fb],n.get_sqlOperation()===N.a.Delete&&n.get_entityRecord().get_identifier().set_rowVersion(""));else{const t=n.get_entityRecord().get_key();if(e.push(t),t in this._get_RowVersionMap()){n.get_entityRecord().initializeValue(l.fb,this._get_RowVersionMap()[t].toString(),O.a.String),n.get_entityRecord().get_identifier().set_rowVersion(this._get_RowVersionMap()[t].toString());const e=n.get_entityRecord().get_changedFieldNames().indexOf(l.fb);e>=0&&n.get_entityRecord().get_changedFieldNames().splice(e,1)}}}Object(A.l)("OfflineUpSync.PlaybackBatchManager._ProcessCrudCommandAction.Success","ProcessCrudCommandAction Completed")}async _IsLastLogActivity(){const e=this._get_ActionDataList()[this._get_ActionDataList().length-1];if(!Object(c.a)(e)){const t=e.get_entityRecord().get_identifier().LogicalName,n=await _.a.get_DefaultInstance().retrieveEntityMetadata(t,null).nativePromise();return!(Object(c.a)(n)||!n.get_isActivity())}return!1}async _HandleActivityParty(e){Object(A.l)("OfflineUpSync.PlaybackBatchManager._HandleActivityParty","HandleActivityParty Started");try{if(!this._get_ActionDataList().length)return Object(A.l)("OfflineUpSync.PlaybackBatchManager._HandleActivityParty","HandleActivityParty Completed as there are no ActionDataList"),!0;if(e.get_sqlOperation()!==N.a.Delete){const t=this._get_ActionDataList().length-1;if(t>=0&&!Object(c.a)(this._get_ActionDataList()[t])){const n=this._get_ActionDataList()[t];if(!Object(c.a)(n)){const t=n.get_entityRecord(),r=await _.a.get_DefaultInstance().retrieveEntityMetadata(t.get_identifier().LogicalName,null).nativePromise();return!Object(c.a)(r)&&r.get_isActivity()&&n.get_associatedActivityParties().push(e),Object(A.l)("OfflineUpSync.PlaybackBatchManager._HandleActivityParty","HandleActivityParty Completed"),!0}}}else if(e.get_sqlOperation()===N.a.Delete)return Object(A.l)("OfflineUpSync.PlaybackBatchManager._HandleActivityParty","HandleActivityParty(Delete) Completed"),!0}catch(e){throw e=e instanceof o.a?e:o.a.fromGenericError(e),Object(A.k)("OfflineUpSync.PlaybackBatchManager._HandleActivityParty.Failure",e.get_Message()),e}}_ProcessNonCRUDItem(e,t){return Object(A.l)("OfflineUpSync.PlaybackBatchManager._ProcessNonCRUDItem","ProcessNonCRUDItem Started"),this._get_ActionDataList().push(e),this._executeCommand(e.get_commandType(),[],t)}async _executeCommand(e,t,n,r){const a=ie.a.newGuid().guid;t.push({name:ae.b.UpsyncParameters.upsyncRequestId,value:a}),t.push({name:ae.b.UpsyncParameters.commandType,value:Object(A.j)(e)}),t.push({name:ae.b.UpsyncParameters.isCrudTransactionBatch,value:this._get_StartTransaction()&&this._get_EndTransaction()}),t.push({name:ae.b.UpsyncParameters.upsyncId,value:w.a.get_upsyncId()});try{const a=await this._CommandExecutor(e,t,n,r);await this._HandleSuccessResponse(a,e,t,r,n)}catch(a){await this._HandleCrmErrorResponse(a,e,t,n,r)}finally{this._HandleCommandAfterExecution()}return!0}async _CommandExecutor(e,t,r,a){Object(A.l)("OfflineUpSync.PlaybackBatchManager._CommandExecutor.Success","CommandExecutor Started");const i=new Date;try{switch(e){case j.a.changeProcessAndStage:return await te.get_instance().upSyncJson(this._get_ActionDataList());case j.a.crud:if(a){const{UpsyncOfflineFileOrImage:e}=await n.e(53).then(n.bind(null,"LHHT")),a=this._get_ActionDataList()[0],i=_.a.get_DefaultInstance().get_Store();return await i.dispatch(e(a.get_entityRecord(),t,r))}return await te.get_instance().upSync(this._get_ActionDataList(),this._get_StartTransaction()&&this._get_EndTransaction(),t);case j.a.nonCrud:const e=this._get_ActionDataList()[0],i=_.a.get_DefaultInstance().get_Store(),{executeNonCUDUpSyncRequest:o}=await n.e(116).then(n.bind(null,"WEHS"));return await i.dispatch(o(e.get_command().get_actionData(),e.get_entitiesInCommand(),r,t))}}finally{t.push({name:ae.b.UpsyncParameters.responseTime,value:+new Date-+i})}}_HandleCommandAfterExecution(){this._set_CommandId(s.a.get_empty()),this._set_ActionDataList([]),this._set_SidToDelete([]),this._set_EntityLogTables([]),this._set_SyncErrorSid([]),this._get_StartTransaction()&&this._get_EndTransaction()&&(this._set_StartTransaction(!1),this._set_EndTransaction(!1))}async _processSuccessResponseForNonCUD(e){Object(A.l)("OfflineUpSync.PlaybackBatchManager.ProcessSuccessResponseForNonCUD","ProcessSuccessResponseForNonCUD Started"),this._entityReferenceMap={};const t=[];if(Object(A.l)("OfflineUpSync.PlaybackBatchManager.ProcessSuccessResponseForNonCUD.Success","Command Execution Succeeded At Server"),!e.length)return!0;for(let n=0;n<e.length;n++)t.push(this._processSuccessMultipleResponseItemForNonCUD(this._get_ActionDataList(),e[n],n));try{return await Promise.all(t),await this._ProcessReturnedRowVersions(),Object(A.l)("OfflineUpSync.PlaybackBatchManager.ProcessSuccessResponseForNonCUD.Success","Processing Success Response succeeded"),!0}catch(e){throw e=e instanceof o.a?e:o.a.fromGenericError(e),Object(A.k)("OfflineUpSync.PlaybackBatchManager.ProcessSuccessResponseForNonCUD.Fail",e.get_Message()),e}}async _processSuccessMultipleResponseItemForNonCUD(e,t,n){Object(A.l)("OfflineUpSync.PlaybackBatchManager.ProcessSuccessMultipleResponseItemForNonCUD","ProcessSuccessMultipleResponseItemForNonCUD Started");try{if(n){Object(A.l)("OfflineUpSync.PlaybackBatchManager.ProcessSuccessMultipleResponseItemForNonCUD.Success","ProcessSuccessMultipleResponseItemForNonCUD Completed");const e=await t.json();if(!Object(c.a)(e)){const t=e[l.N].split(new RegExp("\\#(.*?)\\("))[1],n=u.a.get_DefaultInstance().get_offlineTypescriptInterface().getEntityDictionaryFromPluralName(t)[l.s],r=await _.a.get_DefaultInstance().retrieveEntityMetadata(n,null).nativePromise(),a=e[l.fb],i=e[r.get_primaryIdAttribute()],o=new h.a(n,i,null,a);return Object(c.a)(a)||Object(c.a)(i)||(this._entityReferenceMap[i.toString()]=o),!0}return!1}{const t=new ne;if(Object(c.a)(e[n])||Object(c.a)(e[n].get_associatedMainLog()))return Object(A.l)("OfflineUpSync.PlaybackBatchManager.ProcessSuccessMultipleResponseItemForNonCUD.Success","Empty Data"),!1;const r=e[n].get_associatedMainLog().get_SID();r.toString()in w.a.get_syncErrorRetryCountMap()&&delete w.a.get_syncErrorRetryCountMap()[r.toString()];const a=new L(this._get_NorSyncLogHelper());await a.handle(e[n],t),Object(A.l)("OfflineUpSync.PlaybackBatchManager.ProcessSuccessMultipleResponseItemForNonCUD.Success","ProcessSuccessMultipleResponseItem Completed")}}catch(e){throw e=e instanceof o.a?e:o.a.fromGenericError(e),Object(A.k)("OfflineUpSync.PlaybackBatchManager.ProcessSuccessMultipleResponseItemForNonCUD.Failure",e.get_Message()),e}}async _ProcessFailureResponseForNonCUD(e,t,n){if(Object(A.l)("OfflineUpSync.PlaybackBatchManager._ProcessFailureResponseForNonCUD.Start","Processing Failure Response Started"),Object(c.a)(e))return Object(A.m)("OfflineUpSync.PlaybackBatchManager._ProcessFailureResponseForNonCUD.Success","Processing Failure Response succeeded with no response.Error response was null or empty."),!0;let r=new ne;if(e instanceof i.a)r=this._BuildUpsyncResponseForNonCUD(e.get_organizationServiceFault()),Object(c.a)(e.get_error())||(r.set_errorDetail(Object(c.a)(r.get_errorDetail())||Object(c.b)(r.get_errorDetail())?e.get_error():r.get_errorDetail()),r.set_message(Object(c.a)(r.get_message())||Object(c.b)(r.get_message())?e.get_error():r.get_message()));else{const n=Object(C.d)(e);r.set_message(n),t.push({name:"ErrorMessage",value:n}),u.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentWarn(oe.o.Upsync,"_ProcessFailureResponseForNonCUD: error in not instanceof CrmErrorResponse",t)}const a=[];for(let e=this._get_ActionDataList().length-1;e>=0;e--)if(this._IsSyncError(this._get_ActionDataList()[e]))this._ManageSyncError(this._get_ActionDataList()[e].get_associatedMainLog().get_SID()),Object(A.l)("OfflineUpSync.PlaybackBatchManager.ProcessFailureResponse.Warning","One Sync Error Entity Failed to Upsync");else{const t=new M(this._get_NorSyncLogHelper());a.push(t.handle(this._get_ActionDataList()[e],r,n))}this._addEventParametersForFaultedUpSyncResponse(r,t),u.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentFailure(oe.o.Upsync,o.a.FromMessage(r.get_message()),"sync error returned from server for nonCrud command",t);try{return await Promise.all(a),Object(A.l)("OfflineUpSync.PlaybackBatchManager._ProcessFailureResponseForNonCUD.Success","Processing Failure Response succeeded"),!0}catch(e){throw e=e instanceof o.a?e:o.a.fromGenericError(e),Object(A.k)("OfflineUpSync.PlaybackBatchManager._ProcessFailureResponseForNonCUD.Fail",e.get_Message()),e}}async _HandleSuccessResponse(e,t,n,r,a){let i=!1;try{switch(t){case j.a.changeProcessAndStage:u.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentSuccess(oe.o.Upsync,n),i=await this._processSuccessJsonResponse(e);break;case j.a.crud:r?(this._addEventParametersForCrudCommandData(this._get_ActionDataList()[0],n),u.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentSuccess(oe.o.Upsync,n),i=!0):i=await this._processSuccessResponseForCrud(t,e,n,a);break;case j.a.nonCrud:u.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentSuccess(oe.o.Upsync,n),i=await this._processSuccessResponseForNonCUD(e)}}catch(e){throw e=e instanceof o.a?e:o.a.fromGenericError(e),Object(A.k)("OfflineUpSync.PlaybackBatchManager._HandleSuccessResponse.Fail."+Object(A.j)(t),e.get_Message()),e}return!!i&&(await this._ProcessActionDataListToDelete(),!0)}async _HandleCrmErrorResponse(e,t,n,r,a){let i,s;n.push({name:"CommandType",value:t}),n.push({name:"IsFileOrImageTypeOperation",value:a}),i=t===j.a.nonCrud?this._ProcessFailureResponseForNonCUD(e,n,r):this._processFailureResponseForCUD(e,n,r);try{s=await i}catch(e){if(!a)throw e=e instanceof o.a?e:C.a.toLegacyErrorStatus(Object(C.c)(e)),Object(A.k)("OfflineUpSync.PlaybackBatchManager._HandleCrmErrorResponse.Fail."+Object(A.j)(t),e.get_Message()),e;Object(A.k)("OfflineUpSync.PlaybackBatchManager._HandleCrmErrorResponse.Fail.FileImage."+Object(A.j)(t),Object(C.d)(e)),s=!0}return!!s&&(await this._ProcessActionDataListToDelete(),!0)}async _processFailureResponseForCUD(e,t,n){if(Object(A.l)("OfflineUpSync.PlaybackBatchManager.ProcessFailureResponse.Start","Processing Failure Response Started"),Object(c.a)(e))return Object(A.m)("OfflineUpSync.PlaybackBatchManager.ProcessFailureResponse.Success","Processing Failure Response succeeded with no response. Error response was null or empty."),!0;let r=new ne;if(e instanceof i.a){if(!(Object(c.a)(e.get_request())||e.get_request().status&&503!==e.get_request().status))return Object(A.l)("OfflineUpSync.PlaybackBatchManager.ProcessFailureResponse.Success","Processing Failure Response succeeded with unknown status"),this._set_hasNetworkIssueDuringUpsync(!0),!1;!Object(c.a)(e.get_request())&&!Object(c.a)(e.get_organizationServiceFault())&&!Object(c.a)(e.get_organizationServiceFault().get_message())&&e.get_organizationServiceFault().get_messages().length>0&&(e.get_organizationServiceFault().get_messages()[0]=e.get_request().responseText),r=this._BuildUpsyncResponse(e.get_organizationServiceFault()),Object(c.a)(e.get_error())||(r.set_errorDetail(Object(c.a)(r.get_errorDetail())||Object(c.b)(r.get_errorDetail())?e.get_error():r.get_errorDetail()),r.set_message(Object(c.a)(r.get_message())||Object(c.b)(r.get_message())?e.get_error():r.get_message()))}else{const n=Object(C.d)(e);r.set_message(n),t.push({name:"ErrorMessage",value:n}),u.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentWarn(oe.o.Upsync,"_processFailureResponseForCUD: Error in not instanceof CrmErrorResponse",t)}const s=[];for(let e=this._get_ActionDataList().length-1;e>=0;e--){const i=t.concat([]);if(this._IsSyncError(this._get_ActionDataList()[e]))this._ManageSyncError(this._get_ActionDataList()[e].get_associatedMainLog().get_SID()),Object(A.l)("OfflineUpSync.PlaybackBatchManager.ProcessFailureResponse.Warning","One Sync Error Entity Failed to Upsync");else{const t=new M(this._get_NorSyncLogHelper());s.push(t.handle(this._get_ActionDataList()[e],r,n))}this._get_ActionDataList()[e]instanceof a.a&&this._addEventParametersForCrudCommandData(this._get_ActionDataList()[e],i),this._addEventParametersForFaultedUpSyncResponse(r,i),u.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentFailure(oe.o.Upsync,o.a.FromMessage(r.get_message()),"sync error returned from server for the whole crud batch",i)}try{return await Promise.all(s),Object(A.l)("OfflineUpSync.PlaybackBatchManager.ProcessFailureResponse.Success","Processing Failure Response succeeded"),!0}catch(e){throw e=e instanceof o.a?e:o.a.fromGenericError(e),Object(A.k)("OfflineUpSync.PlaybackBatchManager.ProcessFailureResponse.Fail",e.get_Message()),e}}async _processSuccessResponseForCrud(e,t,n,r){var a,i;Object(A.l)("OfflineUpSync.PlaybackBatchManager.ProcessSuccessResponse","ProcessSuccessResponse Started"),this._entityReferenceMap={};const s=[],l=t;if(!l.get_responses().length)return Object(A.l)("OfflineUpSync.PlaybackBatchManager.ProcessSuccessResponse.Success","Command Execution Succeeded At Server"),!0;let d=!1;for(const e of l.get_responses())if(!Object(c.a)(e.get_fault())){d=!0;break}let p=!1;if(this._get_StartTransaction()&&this._get_EndTransaction())for(let e=l.get_responses().length-1;e>=0;e--){const t=l.get_responses()[e];if((null===(i=null===(a=t.get_fault())||void 0===a?void 0:a.get_messages())||void 0===i?void 0:i.length)>0){p=!0;const e=this._BuildUpsyncResponse(t.get_fault());for(let t=0;t<this._get_ActionDataList().length;t++)if(this._get_ActionDataList()[t]){const a=new M(this._get_NorSyncLogHelper());s.push(a.handle(this._get_ActionDataList()[t],e,r));const i=n.concat([]);this._addEventParametersForCrudCommandData(this._get_ActionDataList()[t],i),this._addEventParametersForFaultedUpSyncResponse(e,i),u.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentFailure(oe.o.Upsync,o.a.FromMessage(e.get_message()),"sync error returned from server for crud transactionBatch",i)}break}}if(d||p){Object(A.l)("OfflineUpSync.PlaybackBatchManager.ProcessSuccessResponse.ServerFailure","Few Command Execution failed At Server");for(let t=l.get_responses().length-1;t>=0;t--){const a=l.get_responses()[t];if(!Object(c.a)(a.get_fault())&&!Object(c.a)(a.get_fault().get_messages())&&a.get_fault().get_messages().length>0){const e=this._BuildUpsyncResponse(a.get_fault());if(!Object(c.a)(this._get_ActionDataList()[a.get_requestIndex()])){if(this._IsSyncError(this._get_ActionDataList()[a.get_requestIndex()])){const e=a.get_fault();if(-2147220960===e.get_errorCode()){const t=o.a.fromErrorCodeAndMessage(e.get_errorCode(),e.get_innerFault()?e.get_innerFault().get_message():e.get_message());Object(A.m)("OfflineUpSync.PlaybackBatchManager.ProcessSuccessResponse.ServerFailure",t.get_Message()),ce.set_OverallSyncErrorMessage(t.get_Message())}this._ManageSyncError(this._get_ActionDataList()[a.get_requestIndex()].get_associatedMainLog().get_SID())}else{const t=new M(this._get_NorSyncLogHelper());s.push(t.handle(this._get_ActionDataList()[a.get_requestIndex()],e,r))}const t=n.concat([]);this._addEventParametersForCrudCommandData(this._get_ActionDataList()[a.get_requestIndex()],t),this._addEventParametersForFaultedUpSyncResponse(e,t),u.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentFailure(oe.o.Upsync,o.a.FromMessage(e.get_message()),"sync error returned from server for single crud command",t)}}else{s.push(this._processSuccessMultipleResponseItem(e,this._get_ActionDataList()[a.get_requestIndex()],a));const t=n.concat([]);this._addEventParametersForCrudCommandData(this._get_ActionDataList()[a.get_requestIndex()],t),u.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentSuccess(oe.o.Upsync,t)}}}else{Object(A.l)("OfflineUpSync.PlaybackBatchManager.ProcessSuccessResponse.Success","Command Execution Succeeded At Server");for(const t of l.get_responses()){s.push(this._processSuccessMultipleResponseItem(e,this._get_ActionDataList()[t.get_requestIndex()],t));const r=n.concat([]);this._addEventParametersForCrudCommandData(this._get_ActionDataList()[t.get_requestIndex()],r),u.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentSuccess(oe.o.Upsync,r)}}if(u.a.get_DefaultInstance().get_offlineTypescriptInterface().reportOfflineComponentWarn("Offline.Upsync","Upsync.Success.Cud",n),!s.length)return!0;try{return await Promise.all(s),await this._ProcessReturnedRowVersions(),Object(A.l)("OfflineUpSync.PlaybackBatchManager.ProcessSuccessResponse.Success","Processing Success Response succeeded"),!0}catch(e){throw e=e instanceof o.a?e:o.a.fromGenericError(e),Object(A.k)("OfflineUpSync.PlaybackBatchManager.ProcessSuccessResponse.Fail",e.get_Message()),e}}_addEventParametersForCrudCommandData(e,t){var n,r,a;t.push({name:ae.b.UpsyncParameters.operationType,value:Object(A.h)(e.get_sqlOperation())}),t.push({name:ae.b.EntityName,value:null===(r=null===(n=e.get_entityRecord())||void 0===n?void 0:n.get_identifier())||void 0===r?void 0:r.LogicalName}),t.push({name:ae.b.RecordId,value:null===(a=e.get_entityRecord())||void 0===a?void 0:a.get_key()})}_addEventParametersForFaultedUpSyncResponse(e,t){t.push({name:ae.b.UpsyncParameters.errorMessage,value:e.get_message()}),t.push({name:ae.b.UpsyncParameters.errorCode,value:e.get_errorCode()})}async _processSuccessMultipleResponseItem(e,t,n){if(Object(A.l)("OfflineUpSync.PlaybackBatchManager.ProcessSuccessMultipleResponseItem","ProcessSuccessMultipleResponseItem Started"),e===j.a.nonCrud&&"Retrieve"===n.get_response().get_name()){Object(A.l)("OfflineUpSync.PlaybackBatchManager.ProcessSuccessMultipleResponseItem.Success","ProcessSuccessMultipleResponseItem Completed");const e=n.get_response().get_entity();return Object(c.a)(e.get_identifier().get_rowVersion())||(this._entityReferenceMap[e.get_key()]=e.get_identifier()),!0}const r=new ne;if(Object(c.a)(t)||Object(c.a)(t.get_associatedMainLog()))return Object(A.l)("OfflineUpSync.PlaybackBatchManager.ProcessSuccessMultipleResponseItem.Success","Empty Data"),!1;const a=t.get_associatedMainLog().get_SID();a.toString()in w.a.get_syncErrorRetryCountMap()&&delete w.a.get_syncErrorRetryCountMap()[a.toString()];const i=new L(this._get_NorSyncLogHelper());try{if(await i.handle(t,r),Object(A.l)("OfflineUpSync.PlaybackBatchManager.ProcessSuccessMultipleResponseItem.Success","ProcessSuccessMultipleResponseItem Completed"),!e&&(t.get_associatedMainLog().get_operationType()===f.o||t.get_associatedMainLog().get_operationType()===f.ab)){if("Create"===n.get_response().get_name()){const e=n.get_response().get_entityReference();this._entityReferenceMap[e.Id.toString()]=e}if("Update"===n.get_response().get_name()){const e=n.get_response().get_entityReference();this._entityReferenceMap[e.Id.toString()]=e}}return!0}catch(e){throw e=e instanceof o.a?e:o.a.fromGenericError(e),Object(A.k)("OfflineUpSync.PlaybackBatchManager.ProcessSuccessMultipleResponseItem.Failure",e.get_Message()),e}}async _processSuccessJsonResponse(e){Object(A.l)("OfflineUpSync.PlaybackBatchManager.ProcessSuccessJsonResponse","ProcessSuccessJsonResponse Started");const t=this._get_ActionDataList()[0];if(e.get_success())return Object(A.l)("OfflineUpSync.PlaybackBatchManager.ProcessSuccessJsonResponse.Success ","Command Execution Succeeded At Server Processed Sucessfully"),!0;if(Object(c.a)(t.get_associatedMainLog()))return Object(A.l)("OfflineUpSync.PlaybackBatchManager.ProcessSuccessJsonResponse.Success ","Command Execution Succeeded At Server Processed Sucessfully"),!1;Object(A.l)("OfflineUpSync.PlaybackBatchManager.ProcessSuccessJsonResponse.ServerFailure.Start ","Command Execution Failed At Server Processing Started");const n=new ne,r=new L(this._get_NorSyncLogHelper());try{return await r.handle(t,n),Object(A.l)("OfflineUpSync.PlaybackBatchManager.ProcessSuccessJsonResponse.ServerFailure.Success ","Command Execution Failed At Server Processed Sucessfully"),!0}catch(e){throw e=e instanceof o.a?e:o.a.fromGenericError(e),Object(A.k)("OfflineUpSync.PlaybackBatchManager.ProcessSuccessJsonResponse.ServerFailure.Fail ",e.get_Message()),e}}async _ProcessReturnedRowVersions(){Object(A.l)("OfflineUpSync.PlaybackBatchManager._ProcessReturnedRowVersions.Start","Process Returned Row Versions Started");const e=[];if(!Object.keys(this._entityReferenceMap).length)return Object(A.l)("OfflineUpSync.PlaybackBatchManager._ProcessReturnedRowVersions.Success","Process Returned Row Versions succeeded"),!0;for(const t in this._entityReferenceMap)e.push(this._UpdateRowVersion(t));const t=[];try{const n=await Promise.all(e);for(const e of n)if(!Object(c.a)(e)){const n=e;t.push(...n)}return await this._get_NorSyncLogHelper().performOperations(t,null,!0),Object(A.l)("OfflineUpSync.PlaybackBatchManager._ProcessReturnedRowVersions.Success","Updation of Row Version Succeeded"),!0}catch(e){throw e=e instanceof o.a?e:o.a.fromGenericError(e),Object(A.k)("OfflineUpSync.PlaybackBatchManager._ProcessReturnedRowVersions.Fail",e.get_Message()),e}}async _UpdateRowVersion(e){Object(A.l)("OfflineUpSync.PlaybackBatchManager._UpdateRowVersion.Start","Updation of Row Version started");const t=this._entityReferenceMap[e];if(Object(c.a)(t)||Object(c.a)(t.get_rowVersion()))return Object(A.l)("OfflineUpSync.PlaybackBatchManager._UpdateRowVersion.Success","Updation of Row Version Succeeded"),null;try{const e=await _.a.get_DefaultInstance().retrieveEntityMetadata(t.LogicalName,null).nativePromise();Object(A.l)("OfflineUpSync.PlaybackBatchManager._UpdateRowVersion.Success","Updation of Row Version Succeeded");const n={};n[l.fb]=t.get_rowVersion(),n[e.get_primaryIdAttribute()]=t.get_identifier(),this._get_RowVersionMap()[t.get_key()]=t.get_rowVersion();return[new d.a(n,N.a.Update,t.LogicalName),new d.a(n,N.a.Update,f.y+t.LogicalName)]}catch(e){throw e=e instanceof o.a?e:o.a.fromGenericError(e),Object(A.k)("OfflineUpSync.PlaybackBatchManager._UpdateRowVersion.Fail",e.get_Message()),e}}_BuildUpsyncResponse(e){const t=new ne;if(t.set_errorDetail(Object(c.a)(e)||Object(c.a)(e.get_responseXml())?"":e.get_responseXml().get_outerXml()),Object(c.a)(e)||Object(c.a)(e.get_messages()))t.set_message(""),t.set_errorTime(new Date);else{const n=(new DOMParser).parseFromString(e.get_messages()[0],"text/xml");if(n){const r=Object(re.a)(n);r.addNamespace("d","http://schemas.microsoft.com/xrm/2011/Contracts/Services"),r.addNamespace("a","http://schemas.microsoft.com/xrm/2011/Contracts"),r.addNamespace("b","http://schemas.datacontract.org/2004/07/System.Collections.Generic"),r.addNamespace("c","http://schemas.microsoft.com/xrm/2012/Contracts"),r.addNamespace("i","http://www.w3.org/2001/XMLSchema-instance"),t.set_errorCode(Object(c.a)(r.selectSingleNode(".//a:ErrorCode"))?Object(c.a)(e.get_errorCode())?-1:e.get_errorCode():Number.parseInvariant(r.selectSingleNode(".//a:ErrorCode").get_innerText())),t.set_message(Object(c.a)(r.selectSingleNode(".//a:Message"))?Object(c.b)(e.get_message())?"":e.get_message():r.selectSingleNode(".//a:Message").get_innerText());const a=Object(c.a)(r.selectSingleNode(".//a:Timestamp"))?"":r.selectSingleNode(".//a:Timestamp").get_innerText(),i=Object(c.b)(a)?new Date:new Date(Date.parse(a.toString()));t.set_errorTime(i)}else t.set_message(e.get_message()),t.set_errorTime(new Date)}return t}_BuildUpsyncResponseForNonCUD(e){const t=new ne;return t.set_errorDetail(Object(c.a)(e)||Object(c.a)(e.get_responseText())?"":e.get_responseText()),Object(c.a)(e)||Object(c.a)(e.get_messages())?(t.set_message(""),t.set_errorTime(new Date)):(t.set_errorCode(Object(c.a)(e.get_errorCode())?-1:e.get_errorCode()),t.set_message(Object(c.b)(e.get_message())?"":e.get_message()),t.set_errorTime(new Date)),t}async _ProcessActionDataListToDelete(){Object(A.l)("OfflineUpSync.PlaybackBatchManager._ProcessActionDataListToDelete","ProcessActionDataListToDelete Started");for(const e of this._get_ActionDataList())switch(e.get_commandType()){case 0:this._ProcessCRUDItemForDelete(e);break;case j.a.changeProcessAndStage:case j.a.nonCrud:this._ProcessNonCRUDItemForDelete(e);break;case j.a.transaction:this._AddNorSyncLogtoDelete(e.get_associatedMainLog())}try{return await this._get_NorSyncLogHelper().clearNorSyncLogs(this._get_SidToDelete(),this._get_EntityLogTables(),this._get_CommandId()),Object(A.l)("OfflineUpSync.PlaybackBatchManager._ProcessActionDataListToDelete.Success","ProcessActionDataListToDelete Completed"),!0}catch(e){throw e=e instanceof o.a?e:o.a.fromGenericError(e),Object(A.k)("OfflineUpSync.PlaybackBatchManager._ProcessActionDataListToDelete.Failure","ProcessActionDataListToDelete Failed"),e}}_ProcessCRUDItemForDelete(e){if(this._AddNorSyncLogtoDelete(e.get_associatedMainLog()),!Object(c.a)(e.get_associatedActivityParties()))for(const t of e.get_associatedActivityParties())Object(c.a)(t)||this._AddNorSyncLogtoDelete(t.get_associatedMainLog())}_ProcessNonCRUDItemForDelete(e){if(this._AddNorSyncLogtoDelete(e.get_associatedMainLog()),!Object(c.a)(e.get_associatedCommandMainLogs())){this._set_CommandId(e.get_commandId());for(const t of e.get_associatedCommandMainLogs())this._AddNorSyncLogtoDelete(t)}}_AddNorSyncLogtoDelete(e){if(!Object(c.a)(e)&&this._get_SyncErrorSid().indexOf(e.get_SID())<0){this._get_SidToDelete().push(e.get_SID());const t=e.get_logTableID().toLowerCase()===f.E.toLowerCase()||e.get_logTableID().toLowerCase()===f.F.toLowerCase();this._get_EntityLogTables().indexOf(e.get_logTableID())<0&&!t&&this._get_EntityLogTables().push(e.get_logTableID())}}_IsSyncError(e){return!Object(c.a)(e)&&!Object(c.a)(e.get_associatedMainLog())&&Object(A.i)(e.get_associatedMainLog())===f.W}_ManageSyncError(e){let t=e.toString()in w.a.get_syncErrorRetryCountMap()?w.a.get_syncErrorRetryCountMap()[e.toString()]:this._syncErrorRetryLimit;t>0?(w.a.get_syncErrorRetryCountMap()[e.toString()]=--t,this._get_SyncErrorSid().push(e)):delete w.a.get_syncErrorRetryCountMap()[e.toString()]}_ProcessFileOrImageTypeItem(e,t){return Object(A.l)("OfflineUpSync.PlaybackBatchManager._ProcessFileOrImageTypeItem","_ProcessFileOrImageTypeItem Started"),this._get_ActionDataList().push(e),this._executeCommand(e.get_commandType(),[],t,!0)}}},vPXf:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Version="1.8.9",t.FullVersionString="AWT-Web-JS-"+t.Version},vSoM:function(e,t,n){"use strict";n.d(t,"d",(function(){return u})),n.d(t,"g",(function(){return p})),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return g})),n.d(t,"a",(function(){return h})),n.d(t,"f",(function(){return m})),n.d(t,"e",(function(){return b}));var r,a=n("Uv1Y"),i=n("iZ7K"),o=n("SRlt"),s=n("Lyxw"),c=n("3/02"),l=n("504W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function u(e,t,n,r){if(n&&e&&t&&n.length){for(const a of n){const n=d(e,a,r,t);if("string"!=typeof n)return n}return null}return null}function d(e,t,n,r,s){const c=Object(i.o)(e,t);if(!c){const e=new a.a(n+": Entity "+t+" metadata does not exist on the server",-2147098612,null,null,null,null,null,[{name:"EntityLogicalName",value:t}]);return r&&!s&&(s=r.TraceManager.getTracer(o.c.TRACER_CATEGORY_ID)),null==s||s.warn(e.message),e}return c}function p(e,t,n,r){const a=d(e,t,n,null,r);if("string"==typeof a)return a;throw a}function f(e){return Object(s.f)(e,c.Hc)}function g(e){return Object(s.f)(e,c.Ic)}function h(e,t,n){return n}function m(e,t,n){return e&&t&&Object(l.a)(n)?"":n}function b(e,t){if(Object(l.b)(e)||Object(l.b)(t))return null;const n=new RegExp(`prv([a-zA-Z]+)${t}$`,"i"),a=e.match(n);if(!a||0===a.length)throw new Error("Invalid privilege name "+e);return r[a[1]]}!function(e){e[e.None=0]="None",e[e.Create=1]="Create",e[e.Read=2]="Read",e[e.Write=3]="Write",e[e.Delete=4]="Delete",e[e.Assign=5]="Assign",e[e.Share=6]="Share",e[e.Append=7]="Append",e[e.AppendTo=8]="AppendTo"}(r||(r={}))},vZNJ:function(e,t,n){e.exports=n("EXEJ")()},vlcQ:function(e,t,n){"use strict";n.d(t,"b",(function(){return d})),n.d(t,"c",(function(){return p})),n.d(t,"a",(function(){return u}));var r=n("dHD5"),a=n("wL2W"),i=n("pEXn"),o=n("+Qpx"),s=n("4aOd"),c=n("tWr6"),l=n("i1f0");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const u=o.G+".visible",d="section.visible";function p(e,t,n,p,f){return{type:"section.visible.sync",sync:!0,execute({dispatch:g,getState:h},m){var b;const y=h();if(g(function(e,t,n,a){const i=Object(r.w)(t);return{type:d,payload:a,meta:{pageId:e,contextKey:i,sectionName:n}}}(e,t,n,p)),Object(a.a)()){const r=null===(b=null==m?void 0:m.TraceManager)||void 0===b?void 0:b.getTracer(`${o.u}${o.G}`),a=Object(l.Bc)(y,{id:e,sectionName:n},t),d=Object(l.Bc)(h(),{id:e,sectionName:n},t),p=Object(c.a)(y,e);p.push({name:"sectionName",value:n}),p.push({name:"visible state before change",value:null==a?void 0:a.toString()}),p.push({name:"visible state after change",value:null==d?void 0:d.toString()}),f&&p.push({name:"reason",value:f}),p.push({name:"callstack",value:new s.a(new Error).getStackTrace()}),null==r||r.warn(o.B,[{name:i.l,value:u},{name:o.G,value:JSON.stringify(p)}])}}}}},vmcK:function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return m})),n.d(t,"a",(function(){return c}));var r=n("SAYH"),a=n("eXjw"),i=n("d0w6"),o=n("Lr+c"),s=n("pEXn");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const c="entity_control";function l(e,t,n){let r={};if(t)for(const a in t){const{views:i}=u(e,t[a],n);r=Object.assign(Object.assign({},i),r)}return{views:r}}function u(e,t,n){const i=t.Entities,o={initialized:a.a.Initialized,viewId:new r.a(t.ViewId),fetchXML:t.FetchXml,entityLogicalName:i?i[0].LogicalName:t.EntityLogicalName,queryApi:t.QueryApi,columnXML:t.ColumnXml,title:t.Title,idColumName:t.IdColumnName,queryType:t.QueryType,layoutXML:t.LayoutXml,grid:d(t.Grid),offlineSqlQuery:t.OfflineSqlQuery?t.OfflineSqlQuery:null,versionNumber:t.VersionNumber,OverallVersionNumber:t.OverallVersionNumber,OverallUserVersionNumber:t.OverallUserVersionNumber,isUserView:t.IsUserView};if(n){const r=[];if(r.push({name:s.b.ViewId,value:t.ViewId},{name:s.b.EntityName,value:o.entityLogicalName},{name:s.b.ViewName,value:o.title},{name:s.b.IsEmptyOfflineSqlQuery,value:!o.offlineSqlQuery}),e&&e.metadata&&e.metadata.views&&e.metadata.views[t.ViewId]&&e.metadata.views[t.ViewId].initialized===a.a.Initialized){if(e.metadata.views[t.ViewId].initialized===a.a.Initialized&&!e.metadata.views[t.ViewId].offlineSqlQuery&&t.OfflineSqlQuery){const e="OfflineSqlQuery value changed from NULL to non-NULL in state";n.warn(e,r)}else if(e.metadata.views[t.ViewId].initialized===a.a.Initialized&&e.metadata.views[t.ViewId].offlineSqlQuery&&!t.OfflineSqlQuery){const e="OfflineSqlQuery value changed from non-NULL to NULL in state";n.warn(e,r)}}else{const e=t.OfflineSqlQuery?"OfflineSqlQuery initial value set to non-NULL in state":"OfflineSqlQuery initial value set to NULL in state";n.warn(e,r)}}return{views:{[r.a.toString(o.viewId)]:o}}}function d(e){if(!e)return null;const t=e.Rows&&e.Rows.map(p),n=function(e){if(e.CustomControlDescriptions&&e.CustomControlDescriptions[0]&&e.CustomControlDescriptions[0].CustomControls){return Object(o.a)(e.CustomControlDescriptions[0])}}(e);return{name:e.Name,object:e.Object,rows:t,customControlDescriptions:n,jump:e.Jump,select:e.Select,icon:e.Icon,preview:e.Preview,iconRenderer:e.IconRenderer}}function p(e){const t=e.Cells.map(f);return{name:e.Name,id:e.Id,cells:t,multiObjectIdField:e.MultiObjectIdField,layoutStyle:e.LayoutStyle}}function f(e){return{name:e.Name,width:e.Width,relatedEntityName:e.RelatedEntityName,disableMetaDataBinding:e.DisableMetaDataBinding,labelId:e.LabelId,isHidden:e.IsHidden,disableSorting:e.DisableSorting,addedBy:e.AddedBy,desc:e.Desc,cellType:e.CellType,imageProviderWebresource:e.ImageProviderWebresource,imageProviderFunctionName:e.ImageProviderFunctionName}}function g(e){return e&&e.length?e.reduce((e,t)=>(e[t.ViewId]=b(t),e),{}):null}function h(e){if(!e||!e.length)return null;let t=e.filter(e=>e.IsDefault)[0];return t||(t=e[0]),new r.a(t.ViewId)}function m(e,t){if(!e||0===e.length)return null;const n=new Map,a=new Map,o={},s={};for(const c of e)if(c.hasOwnProperty("EntityLogicalName")){const e=c.MetadataSubtype;n.has(c.EntityLogicalName)?(n.get(c.EntityLogicalName)[e]=g(c.SelectorItems),a.get(c.EntityLogicalName)[e]=h(c.SelectorItems)):(n.set(c.EntityLogicalName,{[e]:g(c.SelectorItems)}),a.set(c.EntityLogicalName,{[e]:h(c.SelectorItems)})),s[c.EntityLogicalName]||(s[c.EntityLogicalName]={}),s[c.EntityLogicalName][e]={overallVersionNumber:c.OverallVersionNumber,overallUserVersionNumber:c.OverallUserVersionNumber},o[c.EntityLogicalName]||(o[c.EntityLogicalName]={}),o[c.EntityLogicalName][e]=c.SortOrder}else{if(!t)return null;{const e=i.a[c.QueryType];n.has(t)?n.get(t).hasOwnProperty(e)?n.get(t)[e][c.ViewId]=b(c):n.get(t)[e]={[c.ViewId]:b(c)}:n.set(t,{[e]:{[c.ViewId]:b(c)}}),c.IsDefault&&(a.has(t)?a.get(t).hasOwnProperty(e)||(a.get(t)[e]=new r.a(c.ViewId)):a.set(t,{[e]:new r.a(c.ViewId)}))}}return{viewSelectors:Object.fromEntries(n),viewDefaults:Object.fromEntries(a),viewSelectorVersions:s,viewSelectorSortOrders:o}}function b(e){return{name:e.Name,queryType:e.QueryType,isDefault:e.IsDefault,isQuickFindQuery:e.IsQuickFindQuery,isUserView:e.IsUserView||!1,isPinned:e.IsPinned||!1,relatedEntityName:e.RelatedEntityName,isAvailableInOffline:e.IsAvailableInOffline||!1,hasDistinct:e.HasDistinct||!1}}},voMr:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.Web=0]="Web",e[e.Native=1]="Native"}(r||(r={}))},vr5N:function(e,t,n){"use strict";n.d(t,"i",(function(){return r})),n.d(t,"j",(function(){return a})),n.d(t,"k",(function(){return i})),n.d(t,"h",(function(){return o})),n.d(t,"l",(function(){return s})),n.d(t,"m",(function(){return c})),n.d(t,"f",(function(){return l})),n.d(t,"g",(function(){return u})),n.d(t,"e",(function(){return d})),n.d(t,"d",(function(){return p})),n.d(t,"c",(function(){return f})),n.d(t,"b",(function(){return g})),n.d(t,"a",(function(){return h})),n.d(t,"n",(function(){return m}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="UCI_Form_BulkEdit_PrimaryAttribute_Placeholder",a="UCI_Form_BulkEdit_Title",i="UCI_Form_BulkEdit_Title_Description",o="Bulk_Edit_Error_Message",s="Error_Title_0x80631106",c="UCI_Form_BulkEdit_Saving_Progress",l="Bulk_Edit_Confirm_Dialog_text",u="Bulk_Edit_Confirm_Dialog_title",d="Bulk_Edit_Confirm_Dialog_button_continue",p="Bulk_Edit_Confirm_Dialog_button_cancel",f="Bulk_Edit_Alert_Dialog_title",g="Bulk_Edit_Alert_Dialog_text",h="Bulk_Edit_Alert_Dialog_button_close",m=[r,a,i,"UCI_Form_BulkEdit_Header_Tab",o,s,c,l,u,d,p,f,g,h]},"w+N3":function(e,t,n){"use strict";n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return o}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="PickList_DateFilter_Overdue",a="PickList_DateFilter_Today",i="PickList_DateFilter_Tomorrow",o="PickList_DateFilter_All",s=[r,a,i,"PickList_DateFilter_Next7Days","PickList_DateFilter_Next30Days","PickList_DateFilter_Next90Days","PickList_DateFilter_Next6Months","PickList_DateFilter_Next12Months",o],c={overdue:{filterLabel:r,filterValue:"Overdue"},today:{filterLabel:a,filterValue:"Today"},tomorrow:{filterLabel:i,filterValue:"Tomorrow"},next7days:{filterLabel:"PickList_DateFilter_Next7Days",filterValue:"NextXDays;7"},next30days:{filterLabel:"PickList_DateFilter_Next30Days",filterValue:"NextXDays;30"},next90days:{filterLabel:"PickList_DateFilter_Next90Days",filterValue:"NextXDays;90"},next6months:{filterLabel:"PickList_DateFilter_Next6Months",filterValue:"NextXMonths;6"},next12months:{filterLabel:"PickList_DateFilter_Next12Months",filterValue:"NextXMonths;12"},all:{filterLabel:o,filterValue:"All"}}},w1eR:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.Browser=1]="Browser",e[e.MobileApplication=2]="MobileApplication",e[e.MailApp=3]="MailApp"}(r||(r={}))},w72X:function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return u}));var r=n("aRLb"),a=n("SRlt"),i=n("KXDI"),o=n("g22U"),s=n("Uv1Y"),c=n("O4uv");function l(e,t,n={}){return{type:"executeOData.action.async",async execute({dispatch:a,getState:i},o){try{return await a(Object(r.e)(t,e)),a(Object(r.b)(e,t,n))}catch(e){Object(s.b)(e)}}}}function u(e,t,n={},r){var s;try{const l=Object(i.a)(e,t,r);let u=o.d.ACTION;const d=t.getMetadata().operationName||o.e;d===o.d.SCM&&(u=o.d.SCM);const p=Object(o.g)(n);let f;(null===(s=t.getMetadata().parameterTypes)||void 0===s?void 0:s.offlineData)||(f=t.offlineData,delete t.offlineData);const g={urlParameters:l,additionalHeaders:{Accept:a.a,Prefer:'odata.include-annotations="*"'},body:Object(i.d)(e,t),method:"POST",additionalParameters:{[o.a.TYPE]:u,[o.a.SUB_TYPE]:d,[o.a.SOURCE]:p}};return f&&Object(c.b)(g,f),g}catch(e){return{serializationFailure:e.message}}}},w92Z:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("y60j"),a=n("Z/4N"),i=n("9fGf"),o=n("jq7Z");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function s(e,t,n,s){const c=Object(o.b)(e,n,s),l=Object(r.h)(e,c),u=Object(i.b)(e);return Object(a.a)(t,l,u)}},wCzE:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n("eXjw");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e){return e&&e.metadata&&e.metadata.userMetadataVersion?e.metadata.userMetadataVersion:null}function i(e){const t=a(e);return t?t.initialized:r.a.Uninitialized}},wE9H:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.Mobile=1]="Mobile",e[e.BrowserNormal=2]="BrowserNormal",e[e.BrowserMobileSize=3]="BrowserMobileSize"}(r||(r={}))},wF0i:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return g})),n.d(t,"f",(function(){return b})),n.d(t,"d",(function(){return y})),n.d(t,"e",(function(){return _}));var r=n("fMBw"),a=n.n(r),i=n("mpSO"),o=n("zI6t"),s=n.n(o),c=n("pEXn"),l=n("5UJb"),u=n.n(l),d=n("SZCI");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const p="AllControlsInitialized",f="AllRibbonsInitialized",g="PageInfraReady";let h=!1;class m{constructor(e){this._callbackCalled=!1,this._allRibbonsInitTime=0,this._numberOfRibbons=0,this._allControlsInitTime=0,this._numberOfControls=0,this._controlsToRender=[],this._callback=e,h=!1}writeMarker(e,t,n){this._receivedEvent(e,t,n)}writeRetroactiveTimespan(e,t,n,r){this._receivedEvent(e,t+n,r)}startTimespan(e,t,n){return(r,a)=>{this._receivedEvent(e,t+r,n)}}_receivedEvent(e,t,n){if(this._callbackCalled)return;const r=e.getName();if(r===d.r)this._controlsToRender.push(n[d.q]),this._numberOfControls=this._numberOfControls+1;else if(h&&r===d.t){const e=this._controlsToRender.indexOf(n[d.q]);e>-1&&(this._allControlsInitTime<t&&(this._allControlsInitTime=t),this._controlsToRender.splice(e,1))}else r===i.b?(this._allRibbonsInitTime<t&&(this._allRibbonsInitTime=t),this._numberOfRibbons=this._numberOfRibbons+1):r===d.m&&(this._callbackCalled=!0,this._callback(this._allRibbonsInitTime,this._numberOfRibbons,this._allControlsInitTime,this._numberOfControls))}}function b(e,t){s.a.addKeyPerformanceIndicator("PageNavigationStart"),s.a.tagWorkBlock(e+" page"),s.a.addCommonKpiParameters({[c.b.PageLoadParameters.TimeSinceIdle]:(performance.now()-u.a.getLastWorkBlockStartTime()).toFixed().toString()});const n=performance.memory;n&&s.a.addCommonKpiParameters({[c.b.PageLoadParameters.JsHeapSizeLimit]:n.jsHeapSizeLimit,[c.b.PageLoadParameters.TotalJSHeapSize]:n.totalJSHeapSize,[c.b.PageLoadParameters.UsedJSHeapSize]:n.usedJSHeapSize}),s.a.addKeyPerformanceIndicatorOnIdle(d.m,t);const r=new m((e,t,n,i)=>{a.a.removeTransport(r),e>0&&s.a.addKeyPerformanceIndicator(f,{[c.b.PageLoadParameters.NumberOfRibbons]:t.toString()},e),n>0&&s.a.addKeyPerformanceIndicator(p,{[c.b.PageLoadParameters.NumberOfControls]:i.toString()},n)});a.a.registerTransport(r,[o.KPI_ZONE,i.a,d.f])}function y(){s.a.addKeyPerformanceIndicator("PageDataReady"),h=!0}function _(){s.a.addKeyPerformanceIndicator("PageDataSaved")}},wFY3:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="polite",a="assertive"},wHbR:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r,a,i,o;n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"d",(function(){return o})),function(e){e.FilterQueryOption="$filter",e.ExpandQueryOption="$expand",e.SelectQueryOption="$select",e.TopQueryOption="$top",e.SkipTokenQueryOption="$skiptoken",e.OrderByQueryOption="$orderby",e.ApplyQueryOption="$apply",e.FetchXmlQueryOption="fetchXml",e.SavedQueryOption="savedQuery",e.GetOnlyRelatedEntity="$getOnlyRelatedEntity",e.ODataOrderByAscending="asc",e.ODataOrderByDescending="desc",e.ODataNextLinkString="@odata.nextLink"}(r||(r={})),function(e){e.Equal="eq",e.NotEqual="ne",e.Null="null",e.NotNull="not-null",e.In="in",e.NotIn="not-in",e.Like="like",e.NotLike="not-like",e.BeginsWith="begins-with",e.NotBeginWith="not-begin-with",e.EndsWith="ends-with",e.NotEndWith="not-end-with",e.GreaterThan="gt",e.GreaterThanEqual="ge",e.LessThan="lt",e.LessThanEqual="le",e.EqualsUserId="eq-userid",e.NotEqualsUserId="ne-userid",e.EqualsUserTeams="eq-userteams",e.EqualsUserOrUserTeams="eq-useroruserteams"}(a||(a={})),function(e){e.ActivityParty="activityparty",e.OwnerId="ownerid",e.Value="value",e.RawGuid="rawguid",e.Id="id",e.LogicalName="logicalname",e.Name="name",e.PartyId="partyid",e.TransactionCurrencyId="transactioncurrencyid",e.TransactionCurrency="transactioncurrency",e.ColumnDelimiter="!",e.Fields="fields",e.VersionNumber="versionnumber",e.RowVersion="RowVersion"}(i||(i={})),function(e){e.API="API",e.EntityType="entityType",e.Id="id",e.Attributes="attributes",e.Options="options",e.MaxPageSize="maxPageSize",e.retrieveRecord="{Xrm.Mobile.offline}.{retrieveRecord}"}(o||(o={}))},wJNo:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="deviceSettings.change";function a(e){return{type:r,payload:e}}},wL2W:function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return u})),n.d(t,"c",(function(){return d}));var r=n("EY5k");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a=["Monitor_Dialog_Button_Allow","Monitor_Dialog_Button_Deny","Monitor_Prompt_Title","Monitor_Prompt_Message","Monitor_Notification_Message"];var i=n("YxC/"),o=n("+BIz"),s=n("tICD"),c=n("eL04");function l(){try{const e=sessionStorage.getItem("monitorData");return e?JSON.parse(e):{}}catch(e){return{}}}function u(){const e=l();return e&&Object.keys(e).length>0}async function d(e,t,n){const{u:c,s:u}=l(),d=n.searchParams,f=d.get("u"),g=d.get("s");if(f&&g&&(f!==c||g!==u)){const n=e.dispatch;await n(Object(r.e)(a));const c=Object(i.e)(e.getState(),a),l=Object(i.c)(c,"Monitor_Prompt_Title"),u=Object(i.c)(c,"Monitor_Prompt_Message"),d=Object(i.c)(c,"Monitor_Dialog_Button_Allow"),h=Object(i.c)(c,"Monitor_Dialog_Button_Deny"),m=await n(Object(o.a)(u,{},l,void 0,"",d,h));if(0===m.status){(await n(Object(s.a)(m.pageId))).value.confirmed?(sessionStorage.setItem("monitorData",JSON.stringify({u:f,s:g})),await p(n,c,t,f,g)):sessionStorage.removeItem("monitorData")}}else if(c&&u){const n=e.dispatch;await n(Object(r.e)(["Monitor_Notification_Message"]));const a=Object(i.e)(e.getState(),["Monitor_Notification_Message"]);await p(n,a,t,c,u)}}async function p(e,t,r,a,o){try{Error.stackTraceLimit=200}catch(e){}const s=Object(i.c)(t,"Monitor_Notification_Message");e(Object(c.b)({id:"monitorNotification",level:4,message:s,type:2}));const l=await n.e(139).then(n.bind(null,"j0Kh"));r.addTelemetryListener(new l.MonitorManager(a,o,e=>{r.ReportComponentFailure("Monitor",new Error(e))})),r.ReportComponentSuccess("Monitor",[{name:"endpoint",value:a},{name:"sessionState",value:o}])}},wMH2:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("WF3G"),a=n("504W"),i=n("NMtn"),o=n("d+dp"),s=n("HYaY");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class c{constructor(e,t,n,o,s,c,l){var u;this._entities=null,this._moreRecords=!1,this._totalRecordCount=0,this._totalRecordCountLimitExceeded=!1,this._query=null,this._queryState=null,this._clientRetrieveOptions=null,Object(i.d)(e,"entities"),this._moreRecords=t,this._totalRecordCount=n,this._totalRecordCountLimitExceeded=o,this._entities=e,s instanceof r.a?(this._query=s,this._pagingCookie=null!==(u=null!=l?l:null==s?void 0:s.get_PagingCookie())&&void 0!==u?u:""):(this._queryState=s,this._pagingCookie=null!=l?l:""),this.set_clientRetrieveOptions(Object(a.a)(c)?this._entities.length>0?this._entities[0].get_clientRetrieveOptions():null:c)}get_entities(){return this._entities}get_moreRecords(){return this._moreRecords}get_totalRecordCountLimitExceeded(){return this._totalRecordCountLimitExceeded}get_totalRecordCount(){return this._totalRecordCount}get_count(){return this.get_entities().length}get_query(){return this._query}set_query(e){this._query=e}get_queryState(){return this._queryState}get_key(){return!Object(a.a)(this._query)&&this._query.get_key?this._query.get_key():""}get_pagingCookie(){return this._pagingCookie}get_clientRetrieveOptions(){return this._clientRetrieveOptions}set_clientRetrieveOptions(e){if(this._clientRetrieveOptions=e,!Object(a.a)(this._clientRetrieveOptions))for(let e=0;e<this._entities.length;e++)Object(a.a)(this._entities[e].get_clientRetrieveOptions())&&this._entities[e].set_clientRetrieveOptions(this._clientRetrieveOptions)}get_item(e){return this.get_entities()[e]}getObjectData(){const e={},t=new Array(this.get_entities().length);for(let e=0;e<this.get_entities().length;e++)t[e]=this.get_entities()[e].getObjectData();return e.entities=t,e.morerecords=this._moreRecords,e.totalrecordcount=this._totalRecordCount,e.totalRecordCountLimitExceeded=this._totalRecordCountLimitExceeded,Object(a.a)(this._clientRetrieveOptions)||(e.clientretrieveoptions=this._clientRetrieveOptions.getObjectData()),e}add(e){this._entities.push(e)}static createFromObjectData(e){const t=new Array(0),n=e.entities;for(let e=0;e<n.length;e++)t[e]=s.a.createFromObjectData(n[e]);const r=e.morerecords,a=e.totalrecordcount,i="totalRecordCountLimitExceeded"in e&&e.totalRecordCountLimitExceeded,l="clientretrieveoptions"in e?o.a.createFromObjectData(e.clientretrieveoptions):null;return new c(t,r,a,i,null,l)}}c.__typeName="Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.EntityCollection"},wO8k:function(e,t,n){"use strict";n.d(t,"b",(function(){return y})),n.d(t,"a",(function(){return _}));var r=n("pgSX"),a=n("tICD"),i=n("EY5k"),o=n("YxC/"),s=n("si7p");const c=["DialogTitle_UnSyncedRecords","Offline_Records_Warning_Message"];function l(e){return{type:"check.for.offline.record.changes.async.action",execute:async({dispatch:t,getState:n},l)=>!await l.OfflineProvider.hasItemsToUpsync()||t(function(e){return{type:"offline.record.changes.dialog.async.action",execute({dispatch:t,getState:n}){const l=e?"ButtonText_Signout":"ButtonText_Reconfigure";return c.push(l),t(Object(i.e)(c)).then(()=>{const e=Object(o.e)(n(),c),i=Object(o.c)(e,l),u=Object(o.c)(e,"DialogTitle_UnSyncedRecords"),d=String.format(Object(o.c)(e,"Offline_Records_Warning_Message"),i);return t(Object(r.a)(s.c,d,{},i,u,"")).then(e=>{if(0===e.status)return t(Object(a.a)(e.pageId)).then(e=>e.value.confirmed);throw e.error})}).catch(e=>{throw e})}}}(e))}}var u=n("37s6"),d=n("SAYH"),p=n("0uKS"),f=n("8Mff");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const g=["ButtonText_ViewSyncErrors","DialogTitle_UnResolvedSyncErrors","Offline_SyncError_Records_Warning_Message"];function h(e){return{type:"check.for.sync.error.records",execute({dispatch:t,getState:n},c){const h=Object(u.e)(n());return Object(u.v)(n())===f.a.Disabled||null===h||""===h||d.a.equals(d.a.parse(h),d.a.EMPTY)?Promise.resolve(!0):t(l(e)).then(n=>n&&c.OfflineProvider.get_syncErrorCount()>0?t(function(e){return{type:"offline.sync.error.record.async.action",execute({dispatch:t,getState:n}){const c=e?"ButtonText_Signout":"ButtonText_Reconfigure";return g.push(c),t(Object(i.e)(g)).then(()=>{const e=Object(o.e)(n(),g),i=Object(o.c)(e,"ButtonText_ViewSyncErrors"),l=Object(o.c)(e,c),u=Object(o.c)(e,"DialogTitle_UnResolvedSyncErrors"),d=String.format(Object(o.c)(e,"Offline_SyncError_Records_Warning_Message"),l);return t(Object(r.a)(s.c,d,{},i,u,"",l)).then(e=>{if(0===e.status)return t(Object(a.a)(e.pageId)).then(n=>void 0!==n.value.confirmed&&null!==n.value.confirmed&&(!n.value.confirmed||(t(Object(p.a)("syncerror",e.pageId,null,null,null,null,null)),!1)));throw e.error})}).catch(e=>{throw e})}}}(e)):n).catch(e=>{throw e})}}}var m=n("VCkP"),b=n("XOSd");function y(e,t){return{type:"user.signout",execute(n,r){r.TraceManager.getTracer("SignOut").warn("SignOutUser requested with justification",[{name:"isTriggeredByUser",value:t},{name:"justification",value:e}]);const a=new m.a(r,n);if(a.isOperationAvailable("signOut"))return Object(b.b)(n.getState()),n.dispatch(h(!0)).then(n=>{if(n){return r.Router.shouldNavigate().then(n=>{if(n)return a.signOut(e,t)})}})}}}function _(){return{type:"user.reconfigure",execute(e,t){const n=new m.a(t,e);if(n.isOperationAvailable("reconfigure"))return Object(b.b)(e.getState()),e.dispatch(h(!1)).then(e=>{if(e){return t.Router.shouldNavigate().then(e=>{if(e)return n.reconfigure()})}})}}}},wRZP:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return c}));var r=n("UZFl"),a=n("ruPX"),i=n("F1Lu"),o=n("b8TU");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function s(e,t){return{type:"OPEN_APP_LANDING_PAGE",execute(n,o){const s=new i.a(o,n);if(s.isOperationAvailable("switchApp"))return s.switchApp();const c={webresourceName:e};return n.dispatch(Object(a.a)(r.a,c,void 0,t))}}}function c(){return{type:"OPEN_APP_DIALOGS",execute(e,t){const n=new i.a(t,e);if(n.isOperationAvailable("switchApp"))return n.switchApp();const s=e.getState(),c={webresourceName:"",dialogOptions:{hideDialogHeader:!1,inExpandMode:Object(o.e)(s)}};return e.dispatch(Object(a.a)(r.a,c,void 0,{target:"dialog"}))}}}},wgH2:function(e,t,n){"use strict";n.d(t,"d",(function(){return c})),n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return l}));var r=n("arV0"),a=n("NjDY"),i=n("cUMa"),o=n("UIlN");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function s(e,t){const n=Object(o.a)(e,t);return n&&n.ruleContext||null}function c(){const e=Object(i.f)(),t=Object(i.d)();let n,o,s,c,d,p,f,g,h;return function(i,m,b,y,_,v,S,O){const C=Object(r.j)(i,m),E=i.serverStatus.isAvailable,I=Object(a.x)(i),w=e(i,S,m,_),j=t(i,O,m,_);null==y&&_&&(y=_.relationshipType),null==y&&(y=-1);const P=c!==w;if(g!==C.id||h!==C.entityTypeName||n!==E||o!==I||s!==b||P||d!==j){let e;if(g=C.id,h=null==C?void 0:C.entityTypeName,n=E,o=I,s=b,c=w,d=j,b){const t=function(e){let t=0;switch(e){case"Form":t=2;break;case"HomePageGrid":t=1;break;case"SubGridRelated":t=4;break;case"SubGridStandard":t=3;break;case"SubGridAssociated":t=6;break;case"QuickForm":t=7;break;case"Dashboard":t=8;break;case"Global":t=10}return t}(l(b)),{id:n}=C,r=C&&C.entityTypeName,a=function(e){let t=e&&e.parentContextToken;for(;t;){if(t.entityTypeName)return t.entityTypeName;t=t.parentContextToken}return null}(_)||r,i=u(b);P&&(f=w?w.map(e=>({EntityReference:e})):[]),e={IsServerAvailable:E,EntityLogicalName:a||i,EntityId:n,ContextType:t,WebResourcePath:I,SelectedItems:f,AllItems:j||[],IsReferencingAttributeRequired:!1,RelationshipType:y,ContextEntityLogicalName:i,CustomControlType:v}}p=e}return p}}function l(e){if(e){const t=e.split(":");return 2===t.length?t[0]:""}return""}function u(e){if(e){const t=e.split(":");return 2===t.length?t[1]:""}return""}},"whN/":function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.Referencing=1]="Referencing",e[e.AssociationEntity=2]="AssociationEntity"}(r||(r={}))},wipL:function(e,t,n){"use strict";n.d(t,"c",(function(){return F})),n.d(t,"b",(function(){return E})),n.d(t,"a",(function(){return I})),n.d(t,"d",(function(){return M}));var r=n("mMyr"),a=n("kXuq"),i=n("/to1"),o=n("q441"),s=n("xqqo"),c=n("Eqw3"),l=n("3/02"),u=n("QBtP"),d=n("u+q+"),p=n("YxC/"),f=n("dj6u"),g=n("MTWl"),h=n("Lyxw"),m=n("z0a7"),b=n("NjDY");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function y(e){const t=Object(m.a)(["TechnicalDetails.OrganizationUrlLabel","TechnicalDetails.OrganizationIdLabel","TechnicalDetails.UserObjectIdLabel","TechnicalDetails.SystemUserIdLabel","TechnicalDetails.UserTenantIdLabel","TechnicalDetails.EnvironmentFriendlyNameLabel","TechnicalDetails.EnvironmentIdLabel","MailtoLink_ReportToAdmin","ErrorPopup.ErrorDetailsLabel"]),n=r.useContext(u.a),i=Object(d.d)(e=>Object(h.f)(e,l.qc)),o=Object(p.c)(t,"TechnicalDetails.EnvironmentFriendlyNameLabel"),s=Object(p.c)(t,"TechnicalDetails.OrganizationUrlLabel"),c=Object(p.c)(t,"TechnicalDetails.OrganizationIdLabel"),y=Object(p.c)(t,"TechnicalDetails.UserObjectIdLabel"),v=Object(p.c)(t,"TechnicalDetails.SystemUserIdLabel"),S=Object(p.c)(t,"TechnicalDetails.UserTenantIdLabel"),O=Object(p.c)(t,"TechnicalDetails.EnvironmentIdLabel"),C=Object(p.c)(t,"ErrorPopup.ErrorDetailsLabel"),E=Object(p.c)(t,"MailtoLink_ReportToAdmin"),I=Object(d.d)(e=>e&&e.organization&&e.organization.organizationName),w=window.location.origin,j=Object(d.d)(e=>{var t;return null===(t=e.organization.organizationId)||void 0===t?void 0:t.guid}),P=Object(d.d)(e=>e&&e.user&&e.user.userId&&e.user.userId.guid),T=Object(d.d)(e=>Object(f.c)(e)),N=Object(d.d)(e=>Object(f.b)(e)),A=Object(d.d)(e=>Object(b.y)(e));if(!i)return null;const R=C+"\n\t"+Object.values(e.errorDescriptor.errorInformation).join("\n\t"),D=encodeURIComponent(R+("\n\t"+o+" "+(I||"N/A")+"\n\t"+s+" "+(w||"N/A")+"\n\t"+c+" "+(j||"N/A")+"\n\t"+y+" "+(T||"N/A")+"\n\t"+v+" "+(P||"N/A")+"\n\t"+S+" "+(N||"N/A")+"\n\t"+O+" "+(A||"N/A"))),x=D.length>2e3-"mailto:?body=".length?"mailto:?body="+encodeURIComponent(R):"mailto:?body="+D,M=String.format(E,"",",").split(" ,");return r.createElement(a.a,null,r.createElement(g.a,{key:"report-to-admin-mailtolink",href:x,onClick:()=>_(n),accessibilityLabel:x},M[0]),M[1])}const _=e=>{e.EventManager.ReportComponentSuccess("MailtoLink")};var v=n("Fn63"),S=n("N2HV"),O=n("Afz2"),C=n("nJrx");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const E=Object(C.a)(),I=Object(C.a)();const w={backgroundColor:"#ffffff",boxSizing:"border-box",padding:"1.5rem",width:"40rem",border:"1px solid #efefef",boxShadow:"0px 2px 4px 0px rgba(0, 0, 0, 0.5)",maxHeight:"80vh",maxWidth:"100vw",margin:"auto"},j={flexDirection:"column",flexShrink:0,marginBottom:"1.25rem"},P={listStyleType:"none",flexDirection:"column",flexShrink:0},T={flexDirection:"column",alignItems:"flex-start",marginTop:"1.25rem",overflow:"auto"},N={flexDirection:"column",wordBreak:"break-all",marginTop:"1.25rem"},A={border:"none",backgroundColor:"transparent",padding:"5px 0",cursor:"pointer",flexShrink:0,color:"#006699"},R={fontSize:"1.25rem",marginBottom:"1.25rem",alignItems:"center",justifyContent:"space-between"},D={fontSize:"inherit",fontWeight:"normal",flexGrow:1},x={width:"24px",height:"24px",fontSize:"24px",marginRight:"0.5rem",color:"#EA0600"};function M(e,t){if(e.helpURL)t(e.helpURL);else{const n="https://go.microsoft.com/fwlink/?LinkID=398563&",r=e.isOnPrem?"onprem":"online";t(n+"client="+encodeURIComponent(e.errorRegion)+"&Error="+encodeURIComponent(e.errorCode)+"&sv="+encodeURIComponent(e.serverVersion)+"&oid="+encodeURIComponent(e.orgId)+"&de="+encodeURIComponent(r))}}class F extends r.Component{constructor(e){super(e),this._onExpandDetailsHandler=this._onExpandDetailsHandler.bind(this),this._onDynamicHelpLinkClicked=this._onDynamicHelpLinkClicked.bind(this),this.state={isExpanded:!1}}_onExpandDetailsHandler(){this.setState({isExpanded:!this.state.isExpanded})}_renderTechnicalInformation(e){if(!e.errorMessage&&!e.stack)return null;const t=e.errorMessage?r.createElement(a.a,{key:"basic-error-errorMessage"},e.errorMessage):null,n=e.stack?r.createElement(a.a,{key:"basic-error-stack"},e.stack):null;return r.createElement(a.a,{key:"basic-error-technicalDetails",style:N},t,n)}_renderErrorInformation(e){const t=[];for(const n in e)t.push(r.createElement(c.a,{key:n+"_key",accessibilityLabel:e[n]},e[n]));return t}_renderTechnicalDetails(e,t){return this.state.isExpanded?r.createElement(a.a,{key:"basic-error-technicalDetailsBlock",style:T},r.createElement(s.a,{key:"basic-error-details",style:P},this._renderErrorInformation(t)),this._renderTechnicalInformation(e)):null}_renderCloseIconButton(e,t){return e?r.createElement(o.a,{key:"basic-error-closeButton",onClick:e.closeErrorPopup,style:e.errorPopupCloseIconButtonStyle,accessibilityLabel:t,title:t},r.createElement(S.b,{type:v.a.Cancel,style:e.errorPopupCloseIconStyle})):null}_renderDynamicHelpLink(e){if((null==e?void 0:e.errorRegion)||(null==e?void 0:e.helpURL))return r.createElement(o.a,{key:"basic-help-linkButton",accessibilityLabel:e.helpLabel,onClick:this._onDynamicHelpLinkClicked,style:A},e.helpLabel)}_onDynamicHelpLinkClicked(){M(this.props.dynamicHelpOptions,this.props.openURL)}render(){const e=this.props.errorDescriptor;let t={flexDirection:"column",textAlign:e.isRTL?"right":"left",overflow:"hidden",color:"#000"};this.props.inlineDisplay||(t=Object.assign(Object.assign({},t),w));const n=e.isRTL?e.title+" :"+e.accessibilityLabelPrefix:e.accessibilityLabelPrefix+": "+e.title,s=this.state.isExpanded?e.errorTechnicalDetails.detailsHideLabel:e.errorTechnicalDetails.detailsShowLabel;return r.createElement(a.a,{key:"basic-error-popup",style:t},r.createElement(a.a,{key:"basic-error-header",style:j},r.createElement(a.a,{key:"basic-error-title",style:R},r.createElement(S.b,{key:"basic-error-titleIcon",type:v.a.Abandon,role:O.v,style:x}),r.createElement(i.a,{key:E,id:E,accessibilityLabel:n,semanticTag:"h1",style:D},e.title),this._renderCloseIconButton(this.props.closeButtonDescriptor,e.closeButtonLabel)),r.createElement(a.a,{key:I,id:I,accessibilityLabel:e.message},e.message)),r.createElement(y,{key:"mailtoLink-class-component",errorDescriptor:this.props.errorDescriptor}),this._renderDynamicHelpLink(this.props.dynamicHelpOptions),r.createElement(o.a,{key:"basic-error-technicalDetailsButton",onClick:this._onExpandDetailsHandler,style:A,accessibilityExpanded:this.state.isExpanded,accessibilityLabel:s},s),this._renderTechnicalDetails(e.errorTechnicalDetails,e.errorInformation))}}},wje5:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n("/D1P");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="offline.upsync.start";function i(){const e={upSyncStatus:r.a.InProgress};return{type:a,payload:e}}},wo7m:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("nxt5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class a extends r.a{constructor(e){super("RetrievePrincipalAccess"),this._accessRights=e}get_accessRights(){return this._accessRights}}},ws6F:function(e,t,n){"use strict";n.d(t,"h",(function(){return a})),n.d(t,"E",(function(){return i})),n.d(t,"m",(function(){return o})),n.d(t,"n",(function(){return s})),n.d(t,"v",(function(){return c})),n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"o",(function(){return p})),n.d(t,"p",(function(){return f})),n.d(t,"A",(function(){return g})),n.d(t,"l",(function(){return h})),n.d(t,"k",(function(){return m})),n.d(t,"u",(function(){return b})),n.d(t,"C",(function(){return y})),n.d(t,"t",(function(){return _})),n.d(t,"B",(function(){return v})),n.d(t,"y",(function(){return S})),n.d(t,"s",(function(){return O})),n.d(t,"x",(function(){return C})),n.d(t,"w",(function(){return E})),n.d(t,"r",(function(){return I})),n.d(t,"q",(function(){return w})),n.d(t,"f",(function(){return j})),n.d(t,"g",(function(){return P})),n.d(t,"e",(function(){return T})),n.d(t,"d",(function(){return N})),n.d(t,"i",(function(){return A})),n.d(t,"j",(function(){return R})),n.d(t,"z",(function(){return D})),n.d(t,"D",(function(){return x}));var r=n("txA/");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="Web.NavBar.Navigate_Dynamics365",i="Web.NavBar.SiteMap",o="Web.SitemapPanel.Office.Title",s="Web.NavBar.AppSwitcher_Caption",c="Web.SitemapPanel.Recent",l="SITEMAP_APPS_BUTTON",u="Change_App_ToolTip",d="Combine_String_Template",p="Web.SitemapPanel.Pinned",f="Web.SitemapPanel.PinnedStatus",g="Web.SitemapPanel.UnPinnedStatus",h="Web.SitemapPanel.NoRecentMessage",m="Web.SitemapPanel.NoPinnedMessage",b="Web.SitemapPanel.PinAriaLabel",y="Web.SitemapPanel.UnpinAriaLabel",_="Web.SitemapPanel.PinnedItemTooltip",v="Web.SitemapPanel.UnpinnedItemTooltip",S="Web.SitemapPanel.RecentItems",O="Web.SitemapPanel.PinnedItems",C="Web.SitemapPanel.Recent.ExpandTooltip",E="Web.SitemapPanel.Recent.CollapseTooltip",I="Web.SitemapPanel.Pinned.ExpandTooltip",w="Web.SitemapPanel.Pinned.CollapseTooltip",j="MultiSession.NavAriaLabel",P="MultiSession.NavTooltip",T="MultiSession.Expand",N="MultiSession.Collapse",A="Web.SitemapPanel.ChangeAreaLabel",R="Web.SitemapPanel.AreaSwitcherTooltip",D=["Web.NavBar.Switch_App_Text",a,"Web.NavBar.Close_Site_Map","Web.NavBar.Favorites_And_Recent","Web.NavBar.All_Areas","Web.NavBar.NavigationTip","Available_Offline","Not_Available_Offline",i,l,u,"App_Modules_SubArea_ToolTip",d,r.P,r.O,c,p,f,g,h,m,b,y,_,v,S,O,A,R,C,E,I,w,T,N,P,j],x=[o,s]},wyQO:function(e,t,n){"use strict";n.d(t,"b",(function(){return w})),n.d(t,"d",(function(){return D})),n.d(t,"f",(function(){return x})),n.d(t,"c",(function(){return j})),n.d(t,"a",(function(){return P})),n.d(t,"j",(function(){return k})),n.d(t,"h",(function(){return R})),n.d(t,"i",(function(){return U})),n.d(t,"e",(function(){return L})),n.d(t,"g",(function(){return A}));var r=n("hVsf"),a=n("Uv1Y"),i=n("TBkx"),o=n("eXjw"),s=n("SAYH"),c=n("FZDd"),l=n("B+9Q"),u=n("K7RF"),d=n("69Qu"),p=n("MXaZ"),f=n("D6Jg");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function g(e,t){const n=e.configuration&&e.configuration.flags;if(n&&Object.keys(n).length&&t){const e=Object.assign({},t);for(const r in t){const t=n[r.toLowerCase()];if(void 0!==t)if(void 0!==Object(f.c)(t))e[r]=Object(f.c)(t);else if(Number.isNaN(Number.parseInt(t,10))){if(/[\W]/.test(t))throw new Error(`The value of the flag '${r}' contains characters that are not supported.`);e[r]=t}else e[r]=Number.parseInt(t,10)}return e}return t}var h=n("y6/h"),m=n("BDhr"),b=n("wCzE"),y=n("EY5k"),_=n("dH1a"),v=n("jZCH"),S=n("504W"),O=n("XOSd"),C=n("H4dV"),E=n("GYEz"),I=n("w1eR");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const w=1e4,j="user.retrieve",P="modify.pinned.view";function T(e,t){return e(Object(r.a)(t))}function N(e,t){return e(Object(c.f)("activityparty",!0,[],t))}function A(){return{type:"user.extended.retrieve.async",async execute({dispatch:e,getState:t},n){const r=n.TraceManager&&n.TraceManager.getTracer("retrieveExtendedUserContext");if(!Object(d.d)(t()))return void r.warn("[RetrieveUserContext] Extended UserContext can only be retrieved when online.");const a=n.DataSource;e(function(e){return{sync:!0,type:"Retrieve.Extended.User.Context.Sync",execute({dispatch:t,getState:n}){const r=Object.assign({},n().user),a=V(e,n());r.userRolePrivileges=a;t(function(e){return{type:j,payload:e}}({userState:r}))}}}(await a.retrieveExtendedUserContext()))}}}function R(e,t=!1,n=!1,r=!1){return{type:"user.retrieve.async",execute({dispatch:a,getState:s},c){var l;const u=c.DataSource,p=u.get_IsLocalDataSourceAvailable();a(function(){const e={initialized:o.a.Initializing},t={initialized:o.a.Initializing};return{type:j,payload:{userState:e,orgState:t,selectedForms:{},featureControlSettings:{}}}}());const f=null===(l=c.TraceManager)||void 0===l?void 0:l.getTracer("retrieveUserContext");let g=null;const h=u.retrieveLocalDataSourceUserContext().nativePromise();Object(d.d)(s())?(n&&Object(O.b)(s()),g=new Promise((e,t)=>{let n=null;r&&x(s())&&v.a.MdlBootWithCachedValue&&(n=window.setTimeout(()=>{h.then(t=>{null!==t&&(null==f||f.warn(`Remote user context call taking more then ${w} seconds, continue with local store cached value`),e(t))}).catch(e=>t(e))},w)),u.retrieveUserContext().nativePromise().then(t=>{e(t)}).catch(e=>{t(e)}).finally(()=>{D(s(),n,r)})})):g=h;let m=Promise.all([g,h]);return p&&!t?m.then(t=>{const n=t[0],r=t[1];if(null==r||n.MetadataLastModifiedTime!==r.MetadataLastModifiedTime&&n.UserMetadataLastModifiedTime!==r.UserMetadataLastModifiedTime)return Promise.all([T(a,e),N(a,e)]).catch(async e=>{Object(i.h)(e)||await M(e,h,u,{dispatch:a,getState:s},f)})}).catch(async e=>{await M(e,h,u,{dispatch:a,getState:s},f)}):t||(m=Promise.all([m,T(a,e)])),Promise.all([m,g]).then(t=>N(a,e).then(()=>t[1]).catch(async e=>{if(Object(i.h)(e))return t[1];await M(e,h,u,{dispatch:a,getState:s},f)})).then(e=>{F(e,u,{dispatch:a,getState:s},f)}).catch(async e=>{await M(e,h,u,{dispatch:a,getState:s},f)})}}}function D(e,t,n=!1){n&&t&&x(e)&&v.a.MdlBootWithCachedValue&&window.clearTimeout(t)}function x(e){return Object(E.a)(e)===I.a.MobileApplication&&C.a.getInstance().get_IsIOS()&&(C.a.getInstance().get_isIPhone()||C.a.getInstance().get_isIPad())}async function M(e,t,n,{dispatch:r,getState:i},o){const s=(e=Object(a.c)(e)).getNegativeErrorCode();if(!Object(_.a)(s)||!n.get_IsLocalDataSourceAvailable())throw o.error("handleRetrieveUserContextError:Non offline error or local data source is not available. ErrorCode = "+s),e;try{o.warn("handleRetrieveUserContextError:Retrying the request from local store, as this is an offline error. ErrorCode = "+s);F(await t,n,{dispatch:r,getState:i},o)}catch(t){o.error("handleRetrieveUserContextError:Exception during handling offline error, ErrorCode = "+s),Object(a.b)(e)}}function F(e,t,{dispatch:n,getState:r},i){if(Object(S.a)(e)){i.error("handleRetrieveUserContextSuccess: User context is null or empty");const e=r();throw Object(d.d)(e)?a.a.fromErrorCode(e,-2147015414):a.a.fromErrorCode(e,-2147093999)}{t.set_UserContext(e),L(n,e);const a=Object(h.b)();a&&a.metadataVersion===Object(m.b)(r()).currentVersion&&a.userMetadataVersion===Object(b.a)(r()).currentVersion&&n(Object(y.f)())}}function k(e,t){return{type:P,payload:{etn:t,pinnedView:e}}}function L(e,t){e(function(e){return{sync:!0,type:"Retrieve.User.Context.Sync",execute({dispatch:t,getState:n}){const r=e.get_TimeZoneDefinitionByCode(),a={};for(const e in r){const t=r[e];a[e]={bias:t.get_Bias(),timeZoneCode:t.get_TimeZoneCode(),userInterfaceName:t.get_UserInterfaceName()}}const i=e.get_TransactionCurrencyById(),c={};for(const e in i){const t=i[e];c[e]={transactionCurrencyId:s.a.fromLegacyGuid(t.get_TransactionCurrencyId()),currencyCode:t.get_CurrencyCode(),currencyName:t.get_CurrencyName(),currencyPrecision:t.get_CurrencyPrecision(),currencySymbol:t.get_CurrencySymbol()}}const l=e.get_UserRolesToNames(),u={};for(const e in l)u[e]=l[e];const d=V(e,n()),f=e.get_parentRootRoles(),h=new Set;null==f||f.forEach(e=>{var t;const n=null===(t=null==e?void 0:e.toString)||void 0===t?void 0:t.call(e);n&&h.add(n)});const m=e.get_UserAttributePrivileges(),b={};for(const e in m){const t=m[e];b[e]={attributeId:s.a.fromLegacyGuid(t.get_AttributeId()),canCreate:t.get_CanCreate(),canRead:t.get_CanRead(),canUpdate:t.get_CanUpdate(),attributeAccessRights:t.get_AccessRightsMask()}}const y={languageId:e.get_LanguageId(),isRTL:e.get_IsRTL(),isHighContrastEnabled:e.get_IsHighContrastEnabled(),userCultureLCID:e.get_UserCultureLcid(),timeZoneUtcOffsetMinutes:e.get_TimeZoneUtcOffsetMinutes(),userReportScriptErrors:e.get_UserReportScriptErrors(),savedFilters:e.get_SavedFilters(),defaultSavedFilter:e.get_DefaultSavedFilter(),timeZoneAdjusters:Object(p.Q)(e.get_TimeZoneAdjusters()),offlineProfileId:s.a.fromLegacyGuid(e.get_OfflineProfileId()),offlineProfileVersion:e.get_OfflineProfileVersion(),offlineProfileAvailableEntities:e.get_OfflineProfileAvailableEntities(),defaultSearchExperience:e.get_DefaultSearchExperience(),defaultDashboardId:s.a.fromLegacyGuid(e.get_DefaultDashboardId()),transactionCurrencyId:s.a.fromLegacyGuid(e.get_TransactionCurrencyId()),defaultHomepageId:s.a.fromLegacyGuid(e.get_DefaultHomepageId()),defaultInteractionCentricDashboardId:s.a.fromLegacyGuid(e.get_DefaultInteractionCentricDashboardId()),isLive:e.get_IsLive(),isFarEastLanguage:e.get_IsFarEastLanguage(),usePathBasedUrls:e.get_UsePathBasedUrls(),timeZoneDefinitionByCode:a,transactionCurrencyById:c,numberFormatInfo:e.get_NumberFormatInfo(),dateFormatInfo:e.get_DateTimeFormatInfo(),showWeekNumber:e.get_ShowCalendarWeeks(),userCultureName:e.get_userCultureName(),formatInfoCultureName:e.get_FormatInfoCultureName(),isGuidedHelpEnabled:e.get_UserSettings().get_IsGuidedHelpEnabled(),recordsPerPage:e.get_UserSettings().get_RecordsPerPage(),defaultGridViews:e.get_DefaultGridViews(),selectedGlobalFilterId:s.a.fromLegacyGuid(e.get_SelectedGlobalFilterId()),isAdmin:e.get_IsAdmin(),isCustomizer:e.get_IsCustomizer(),isSupportUser:e.get_IsSupportUser(),homepageArea:e.get_UserSettings().get_HomepageArea(),homepageSubArea:e.get_UserSettings().get_HomepageSubArea(),isEmailConversationViewEnabled:e.get_IsEmailConversationViewEnabled(),workDayStartTime:e.get_WorkDayStartTime(),autoCaptureUserStatus:e.get_AutoCaptureUserStatus()},_={initialized:o.a.Initialized,userDisplayName:e.get_UserName(),userId:s.a.fromLegacyGuid(e.get_UserId()),userEmail:e.get_UserEmail(),userRolePrivileges:d,userParentRootRoles:h,userAttributePrivileges:b,userRolesToNames:u,userSettings:g(n(),y)},v=e.get_SelectedFormsByEntity().reduce((e,t)=>(e[t.EntityName.toLowerCase()]={formId:s.a.fromLegacyGuid(t.FormId),userEntityUISettingsId:s.a.fromLegacyGuid(t.UserEntityUISettingId)},e),{}),S={languageCode:e.get_LanguageCode(),baseCurrencyId:s.a.fromLegacyGuid(e.get_BaseCurrencyId()),defaultCountryCode:e.get_DefaultCountryCode(),geoName:e.get_GeoName(),fullNameConventionCode:e.get_FullNameConventionCode(),pricingDecimalPrecision:e.get_PricingDecimalPrecision(),organizationUniqueName:e.get_OrganizationUniqueName(),norsyncServerConnectionString:e.get_NorsyncServerConnectionString(),currentThemeData:e.get_CurrentThemeData(),delveUrl:e.get_DelveUrl(),isAutoSaveEnabled:e.get_IsAutoSaveEnabled(),appointmentRichEditorExperience:e.get_AppointmentRichEditorExperience(),allowLegacyDialogsEmbedding:e.get_AllowLegacyDialogsEmbedding(),allowLegacyClientExperience:e.get_AllowLegacyClientExperience(),cdsCapabilityMode:e.get_CdsCapabilityMode(),enableUnifiedInterfaceShellRefresh:e.get_EnableUnifiedInterfaceShellRefresh(),webServiceCallRetryPolicies:e.get_WebServiceCallRetryPolicies(),kmUseExternalPortal:e.get_KmUseExternalPortal(),kmExternalPortalUrl:e.get_KmExternalPortalUrl(),maxIncidentMergeNumber:e.get_MaxIncidentMergeNumber(),maxChildIncidentNumber:e.get_MaxChildIncidentNumber(),isConflictDetectionEnabledForMobileClient:e.get_IsConflictDetectionEnabledForMobileClient(),isParature:e.get_IsParature(),isKMConfigured:e.get_IsKMConfigured(),mobileOfflineSyncInterval:e.get_MobileOfflineSyncInterval(),overrideTrackInCrmBehaviour:e.get_OverrideTrackInCrmBehavior(),showWeekNumber:e.get_ShowWeekNumber(),isMocaOfflineFeatureEnabled:e.get_IsMocaOfflineFeatureEnabled(),isSOPIntegrationEnabled:e.get_IsSOPIntegrationEnabled(),isTelemeteryEnabled:e.get_IsTelemeteryEnabled(),useSkypeProtocol:e.get_UseSkypeProtocol(),currencyDisplayOption:e.get_CurrencyDisplayOption(),orgCultureInfoLCID:e.get_OrgCultureInfoLcid(),enabledLanguages:e.get_EnabledLanguages(),blockedAttachments:e.get_BlockedAttachments(),maxUploadFileSize:e.get_MaxUploadFileSize(),orgReportScriptErrors:e.get_OrganizationReportScriptErrors(),isDuplicateDetectionEnabled:e.get_IsDuplicateDetectionEnabled(),isDuplicateDetectionEnabledForOnlineCreateUpdate:e.get_IsDuplicateDetectionEnabledForOnlineCreateUpdate(),isOsdpOrganization:e.get_IsOsdpOrganization(),fiscalYearStartDate:new Date(e.get_FiscalCalendarStart()),fiscalPeriodFormat:e.get_FiscalPeriodFormatPeriod(),fiscalPeriodType:e.get_FiscalPeriodType(),fiscalYearFormatYear:e.get_FiscalYearFormatYear(),fiscalYearDisplayCode:e.get_FiscalYearDisplayCode(),fiscalYearFormatPrefix:e.get_FiscalYearFormatPrefix(),fiscalYearFormatSuffix:e.get_FiscalYearFormatSuffix(),fiscalPeriodConnector:e.get_FiscalPeriodConnector(),webResourceHash:B(e.get_WebResourceHash()),isPowerBIEnabled:e.get_IsPowerBIEnabled(),firstPartyIntegrationSiteUrl:e.get_FirstPartyIntegrationSiteUrl(),isTrialOrganization:e.get_IsTrialOrganization(),organizationExpiryDate:e.get_organizationSettings().get_orgExpiryDate()?new Date(e.get_organizationSettings().get_orgExpiryDate()):null,isPreviewOrganization:e.get_IsPreviewOrganization(),isSandboxOrganization:e.get_IsSandboxOrganization(),isSovereignCloud:e.get_IsSovereignCloud(),advancedDebuggabilitySettings:e.get_AdvancedDebuggabilitySettings(),enableLPAuthoring:e.get_EnableLPAuthoring(),isContextualHelpEnabled:e.get_IsContextualHelpEnabled(),isMicrosoftFlowEnabled:e.get_IsMicrosoftFlowEnabled(),microsoftFlowFirstPartyIntegrationSiteUrl:e.get_MicrosoftFlowFirstPartyIntegrationSiteUrl(),isExternalSearchIndexEnabled:e.get_IsExternalSearchIndexEnabled(),microsoftFlowDestinationUrl:e.get_MicrosoftFlowDestinationUrl(),microsoftFlowEnvironmentId:e.get_MicrosoftFlowEnvironmentId(),sharePointDeploymentType:e.get_SharePointDeploymentType(),isOneDriveEnabled:e.get_IsOneDriveEnabled(),isMSTeamsEnabled:e.get_IsMSTeamsEnabled(),isContextualEmailEnabled:e.get_IsContextualEmailEnabled(),isRichTextNotesEnabled:e.get_IsRichTextNotesEnabled(),isAutoDataCaptureV2Enabled:e.get_IsAutoDataCaptureV2Enabled(),isManualSalesForecastingEnabled:e.get_IsManualSalesForecastingEnabled(),isActionCardEnabled:e.get_IsActionCardEnabled(),enableImmersiveSkypeIntegration:e.get_EnableImmersiveSkypeIntegration(),isEmailMonitoringAllowed:e.get_IsEmailMonitoringAllowed(),allowUnresolvedPartiesOnEmailSend:e.get_AllowUnresolvedPartiesOnEmailSend(),isPresenceEnabled:e.get_IsPresenceEnabled(),boundDashboardDefaultCardExpanded:e.get_BoundDashboardDefaultCardExpanded(),logoImagePath:e.get_LogoImagePath(),logoTooltip:e.get_LogoTooltip(),sessionTimeoutInSeconds:e.get_SessionTimeoutInSeconds(),sessionTimeoutReminderInSeconds:e.get_SessionTimeoutReminderInSeconds(),inactivityTimeoutInSeconds:e.get_InactivityTimeoutInSeconds(),inactivityTimeoutReminderInSeconds:e.get_InactivityTimeoutReminderInSeconds(),transactionCurrencyById:c,officePortalUrl:e.get_OfficePortalUrl(),ppacSettingsUrl:e.get_PpacSettingsUrl(),customizationUrl:e.get_CustomizationUrl(),isCrmOrg:e.get_IsCrmOrg(),yammerGroupId:e.get_YammerGroupId(),yammerNetworkName:e.get_YammerNetworkName(),yammerOAuthAccessTokenExpired:e.get_YammerOAuthAccessTokenExpired(),yammerPostMethod:e.get_YammerPostMethod(),globalHelpUrl:e.get_GlobalHelpUrl(),privacyStatementUrl:e.get_PrivacyStatementUrl(),enableBingMapsIntegration:e.get_EnableBingMapsIntegration(),bingMapsApiKey:e.get_BingMapsApiKey(),availableBingMapLocales:e.get_AvailableBingMapLocales(),excludedCountriesForMaps:e.get_ExcludedCountriesForMaps(),bFDatacenter:e.get_BFDatacenter(),securitySettingForEmail:e.get_SecuritySettingForEmail(),enableActivitiesTimeLinePerfImprovement:e.get_EnableActivitiesTimeLinePerfImprovement(),gridTotalRecordCountLimit:e.get_GridTotalRecordCountLimit(),enableLivePersonaCardUCI:e.get_EnableLivePersonaCardUCI(),livePersonaCardComplianceEnvironment:e.get_LivePersonaCardComplianceEnvironment(),livePersonaCardCulture:e.get_LivePersonaCardCulture(),livePersonaCardFirstPartyIntegrationUrl:e.get_LivePersonaCardFirstPartyIntegrationUrl(),livePersonaCardRegion:e.get_LivePersonaCardRegion(),globalHelpUrlEnabled:e.get_GlobalHelpUrlEnabled(),globalAppendUrlParametersEnabled:e.get_GlobalAppendUrlParametersEnabled(),areJquery3IncompatibleSolutionsInstalled:e.get_AreJquery3IncompatibleSolutionsInstalled(),useQuickFindViewForGridSearch:e.get_UseQuickFindViewForGridSearch(),defaultCrmCustomName:e.get_DefaultCrmCustomName(),newSearchExperienceEnabled:e.get_NewSearchExperienceEnabled(),improveSearchLoggingEnabled:e.get_ImproveSearchLoggingEnabled(),lookupCharacterCountBeforeResolve:e.get_LookupCharacterCountBeforeResolve(),lookupResolveDelayMS:e.get_LookupResolveDelayMS(),organizationBAPEnvironmentID:e.get_organizationBAPEnvironmentID(),advancedLookupEnabled:e.get_AdvancedLookupEnabled(),relevanceSearchEnabledByPlatform:e.get_RelevanceSearchEnabledByPlatform(),quickActionToOpenRecordsInSidePaneEnabled:e.get_QuickActionToOpenRecordsInSidePaneEnabled(),isCollaborationExperienceEnabled:e.get_IsCollaborationExperienceEnabled(),isSharingInOrgAllowed:e.get_IsSharingInOrgAllowed(),copresenceRefreshRate:e.get_CopresenceRefreshRate(),advancedColumnEditorEnabled:e.get_AdvancedColumnEditorEnabled(),advancedColumnFilteringEnabled:e.get_AdvancedColumnFilteringEnabled(),modernAdvancedFindFiltering:e.get_ModernAdvancedFindFiltering(),allowUsersHidingSystemViews:e.get_AllowUsersHidingSystemViews(),enableAsyncMergeAPIForUCI:e.get_EnableAsyncMergeAPIForUCI(),userRatingEnabled:e.get_UserRatingEnabled(),pcfDatasetGridEnabled:e.get_PcfDatasetGridEnabled(),appointmentWithTeamsMeeting:e.get_AppointmentWithTeamsMeetingEnabled()},O={initialized:o.a.Initialized,organizationName:e.get_OrganizationName(),organizationId:s.a.fromLegacyGuid(e.get_OrganizationId()),serverVersion:e.get_ServerVersion(),serverDatabaseVersion:e.get_ServerDatabaseVersion(),organizationSettings:g(n(),S),overallVersionNumber:Number(e.get_MetadataLastModifiedTime()),organizationTenant:e.get_OrganizationTenant()},C=e.get_FeatureControlSettings(),E={};for(const e of Object.keys(C)){const t=C[e],n={};for(const e in t)n[t[e].get_featureName()]={value:t[e].get_value(),featureName:t[e].get_featureName()};E[e]=n}t(function(e){return{type:j,payload:e}}({userState:_,orgState:O,selectedForms:v,featureControlSettings:E}))}}}(t)),e(Object(l.c)(t)),e(function(e){if(!e)return null;const t=Number(e.get_MetadataLastModifiedTime()),n=Number(e.get_UserMetadataLastModifiedTime()),r={initialized:o.a.Initialized,lastVersion:t,currentVersion:t},a={initialized:o.a.Initialized,lastVersion:n,currentVersion:n};return{type:u.a,payload:{metadataVersion:r,userMetadataVersion:a}}}(t))}function B(e){for(;e&&-1!==e.indexOf("\\x");)e=e.replace("\\x","%");for(;e&&-1!==e.indexOf("'");)e=e.replace("'","");return e}function U(e,t){return{type:j,payload:{userState:{initialized:o.a.Uninitialized,userSettings:{usePathBasedUrls:!t}},orgState:{initialized:o.a.Uninitialized,organizationSettings:{organizationUniqueName:e}},selectedForms:{},featureControlSettings:{}}}}function V(e,t){var n,r;const a=e.get_UserRolePrivileges(),i={};for(const e in a){const o=a[e];if(i[e]={privilegeId:s.a.fromLegacyGuid(o.get_privilegeId()),privilegeDepth:o.get_depth(),businessUnitId:s.a.fromLegacyGuid(o.get_businessUnitId())},o.get_privilegeName&&void 0!==o.get_privilegeName())i[e].privilegeName=o.get_privilegeName();else{const a=(null===(n=t.user)||void 0===n?void 0:n.userRolePrivileges)?null===(r=t.user.userRolePrivileges[e])||void 0===r?void 0:r.privilegeName:void 0;void 0!==a&&""!==a&&(i[e].privilegeName=a)}}return i}},"x/BX":function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e){return!!(e&&e.metadata&&e.metadata.consistencyStrong)&&e.metadata.consistencyStrong}n.d(t,"a",(function(){return r}))},"x/aW":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));var r,a=n("SAYH"),i=n("3ZcW");function o(e){const t=e&&Array.isArray(e.Exclude)&&e.Exclude.map(a.a.fromLegacyGuid)||[],n=new i.a;var r;return n.MetadataType=(r=e.MetadataType)&&s[r]?s[r]:r,n.MetadataSubtype=e.MetadataSubtype,n.EntityLogicalName=e.EntityLogicalName,n.MetadataId=a.a.fromLegacyGuid(e.MetadataId),n.MetadataNames=e.MetadataNames,n.GetDefault=e.GetDefault,n.DependencyDepth=e.DependencyDepth,n.ChangedAfter=e.ChangedAfter,n.Exclude=t,n.AppId=e.AppId&&a.a.fromLegacyGuid(e.AppId)||null,n}!function(e){e.BusinessProcessFlow="businessprocessflow",e.MetadataVersion="metadataversion",e.UserMetadataVersion="usermetadataversion",e.BPFSelector="bpfselector",e.AppModules="appmodules"}(r||(r={}));const s={webresourcedescriptor:"webresource"}},x0oY:function(e,t,n){"use strict";n.d(t,"a",(function(){return R})),n.d(t,"c",(function(){return D})),n.d(t,"f",(function(){return A})),n.d(t,"d",(function(){return w})),n.d(t,"e",(function(){return j})),n.d(t,"h",(function(){return T})),n.d(t,"g",(function(){return N})),n.d(t,"l",(function(){return B})),n.d(t,"k",(function(){return U})),n.d(t,"j",(function(){return V})),n.d(t,"i",(function(){return L})),n.d(t,"b",(function(){return I}));var r=n("odYE"),a=n("SAYH"),i=n("504W"),o=n("d7fm"),s=n("LbMF"),c=n("iZ7K"),l=n("cetF"),u=n("FZDd"),d=n("HYaY"),p=n("sdkC"),f=n("S/Br"),g=n("/d6W"),h=n("Jsfi"),m=n("tHaS"),b=n("Ae6N"),y=n("IvgJ"),_=n("wMH2"),v=n("Xd5/"),S=n("SRlt"),O=n("MUIu"),C=n("/A0C"),E=n("8nT0");var I;function w(e,t,n,s,c,u,f,g,h,m=I.OData,b,y,_=!1){const v=f||n.PrimaryKeyName;c||(c=T(t,m)),-1===c.indexOf("versionnumber")&&t.hasOwnProperty("@odata.etag")&&c.push("versionnumber");const S="string"==typeof t[v]?new a.a(t[v]):a.a.EMPTY,O=new r.a(n.EntityLogicalName,S),E=r.a.toLegacyEntityReference(O);let w=null;Object(i.a)(g)||(w=g.aliasedValueDescriptors);const j=function(e,t,n,r,a,s,c,u,d=I.OData,p,f=!1){const g={fieldTypes:{},formattedValues:{},numericFormattedValues:{},fields:{}};if(f&&Object(l.d)(n.EntityLogicalName))return g.fields=a,g;for(const p of t)if(Object(i.b)(p)){const e=[{name:"EntityLogicalName",value:null!=n?n.EntityLogicalName:"null"}];null==c||c.warn("Empty field name encountered while trying to construct entity record",e)}else if(f&&l.a.indexOf(p)>-1)g.fields[p]=a[p];else if("versionnumber"===p){const t=C.a.BigInt;g.fields[p]=z(e,a,p,t,n,r,!1,s,c,d),g.fieldTypes[p]=t}else if(u&&a&&a.hasOwnProperty(p)&&u.filter(e=>e.get_relationShipName()===p).length>0)M(e,p,n,a,g,c,u);else{let t=!1;const i=s&&s.hasOwnProperty(p);if(!i&&null==r[p])continue;let l=a.hasOwnProperty(q(p,a,s,i));if(l||(l=a.hasOwnProperty(W(p,d,i))),!l){const r=H(e,p,n,a,s,i);l=a.hasOwnProperty(r)&&a[r].filter(e=>e.participationtypemask===Object(o.a)(i?s[p].aliasedValueEtn:n.EntityLogicalName,i?s[p].aliasedValueFieldName:p)).length>0,t=l}if(l){const o=i?C.a.AliasedValue:r[p].Type,l=q(p,a,s,i&&s[p].isAttributeAlias),u=q(p,a,s,i&&s[p].oDataAlias.length>1);g.fields[l]=z(e,a,u,o,n,r,t,i?s:null,c,d),g.fieldTypes[l]=o,k(e,u,g,a,d,r,o,n.EntityLogicalName,c)}}if(p)for(const t in p)(g.fields.hasOwnProperty(t)||g.fields.hasOwnProperty(p[t].idField))&&F(e,n,g,p[t]);return g}(e,c,n,s,t,w,h,b,m,y,_);return new d.a(E,j.fields,j.fieldTypes,j.formattedValues,j.numericFormattedValues,new p.a([]),u)}function j(e,t,n,r,a,i,o,l,d=I.OData,p){return{type:"CREATE_ENTITY_RECORD_FROM_RESPONSE_ASYNC",execute({dispatch:f,getState:g},h){const m=T(e,d),b=function(e,t,n,r,a,i){const o=P(n,r).filter(e=>-1===e.indexOf("."));let s;if(o&&o.length>0)if(a){s=a.entity2AttributesMap?a.entity2AttributesMap:{};const e=P(s[t],o);s[t]=e}else s={[t]:o};else s={};if(i)for(const n of i){const r=n.get_relationShipName(),a=Object(c.I)(e,t,r);if(a){const i=0===Object(c.L)(e,t,r)?a.ReferencingEntity:a.ReferencedEntity,o=n.get_columnNames();s[i]=P(s[i],o)}}return s}(g(),t,r,m,o,p);return f(Object(u.e)(b,n)).then(()=>{const n=Object(s.d)(g(),t),u=Object(c.h)(g(),t),f=(r||[]).concat(0===Object.keys(b).length?[]:b[t].filter(e=>n.hasOwnProperty(e)));return w(g(),e,u,n,f,a,i,o,l,d,p)})}}}function P(e,t){const n=new Set(e||[]),r=e&&e.slice(0)?e.slice(0):[];if(t)for(const e of t)n.has(e)||r.push(e);return r}function T(e,t=I.OData){const n=Object.keys(e).reduce((e,n)=>(-1===n.indexOf("@")&&e.add(N(n,t)),e),new Set);return Array.from(n)}function N(e,t=I.OData){let n=null;return n=t===I.OData?e.match(/^_(\w+)_value$/i):e.match(/(\w+\.?\w+)!(id|name|logicalname)$/i),n&&n[1]?n[1]:e}function A(e,t,n){return{type:"DESERIALIZE_RETRIEVE_RESPONSE_ASYNC",execute({dispatch:a,getState:i},o){const s=i(),l=t.get_target(),d=l.LogicalName,p=Object(c.h)(s,d),f=t.get_columnSet();let{columnNames:g}=Object(S.e)(f);const m=t.get_navigationProperty();if(m){const e=[];for(const t of m){const n=t.get_relationShipName();e.push(n)}g=g.concat(e)}const b=[];return e.json().then(e=>{const t=function(e){let t=null;const n=e["@Microsoft.Dynamics.CRM.servernotifications"];if(n)try{t=JSON.parse(n)}catch(e){}return t}(e),i=r.a.fromLegacyEntityReference(l);return t&&t.length?(t.forEach(e=>{e.forRecord=i,e.Parameters.forEach(e=>{if(e.ParameterType===h.a.Attribute){const t=e.Data;g.indexOf(t)<0&&(g.push(t),b.push(t))}})}),a({type:R,payload:{notifications:t}}),a(Object(u.f)(d,!1,b,n)).then(()=>a(x(d,p,f,g,t,e,m,n)))):(a(function(e){return{type:D,payload:null,meta:e}}(i)),a(x(d,p,f,g,t,e,m,n)))})}}}!function(e){e[e.OData=0]="OData",e[e.SQL=1]="SQL"}(I||(I={}));const R="notifications.add",D="notification.remove";function x(e,t,n,r,a,i,o,s,c=I.OData){return{type:"CREATE_RETRIEVE_RESPONSE_ASYNC",execute({dispatch:t,getState:l},u){const d=(p=a)?p.map(e=>new f.a(e.Severity,e.Message)):null;var p;return t(j(i,e,s,r,n,null,null,null,c,o)).then(e=>new g.a(e,d))}}}function M(e,t,n,i,o,l,u){for(const f of u){let u=null;const g=f.get_relationShipName();if(g===t){const h=Object(c.I)(e,n.EntityLogicalName,g);if(h){const m=Object(c.L)(e,n.EntityLogicalName,g),b=0===m?h.ReferencingEntity:h.ReferencedEntity,y=f.get_columnNames(),_=Object(s.d)(e,b);if(_){const n=[],s=Object(c.h)(e,b),f=s.PrimaryKeyName;if(0===m){const t=i[g];if(t)for(const i of t){const t={fieldTypes:{},formattedValues:{},numericFormattedValues:{},fields:{}},o=new a.a(i[f]),c=new r.a(s.EntityLogicalName,o),g=r.a.toLegacyEntityReference(c);for(const n of y)if(_.hasOwnProperty(n)){u=_[n].Type;const r=z(e,i,n,u,s,_,!1,null,l);t.fields[n]=r,t.fieldTypes[n]=u}if(i.hasOwnProperty(E.c)){u=C.a.String;const n=z(e,i,E.c,u,s,_,!1,null,l);t.fields.devicefilepath=n,t.fieldTypes.devicefilepath=u}const h=new d.a(g,t.fields,t.fieldTypes,t.formattedValues,t.numericFormattedValues,new p.a([]));n.push(h)}}else if(2===m){const o=i[g];if(o){const c={fieldTypes:{},formattedValues:{},numericFormattedValues:{},fields:{}},g=new a.a(o[f]),h=new r.a(s.EntityLogicalName,g),m=r.a.toLegacyEntityReference(h);for(const n of y)if(_.hasOwnProperty(n)){u=_[n].Type;const r=z(e,i[t],n,u,s,_,!1,null,l);c.fields[n]=r,c.fieldTypes[n]=u}o.hasOwnProperty(E.c)&&(c.fields.devicefilepath=z(e,o,E.c,u,s,_,!1,null,l),c.fieldTypes.devicefilepath=C.a.String),o.hasOwnProperty(E.d)&&(c.fields.devicethumbnailpath=z(e,o,E.d,u,s,_,!1,null,l),c.fieldTypes.devicethumbnailpath=C.a.String);const b=new d.a(m,c.fields,c.fieldTypes,c.formattedValues,c.numericFormattedValues,new p.a([]));n.push(b)}}o.fields[g]=n,o.fieldTypes[g]=C.a.NavigationProperty}}}}}function F(e,t,n,i){const o=Object(c.J)(e,t.EntityLogicalName,i.navigationPropertyName);if(o){const l=Object(c.L)(e,t.EntityLogicalName,o.name),u=o.relationship,f=0===l?u.ReferencingEntity:u.ReferencedEntity;if(Object(s.d)(e,f)){const e=[],o={fieldTypes:{},formattedValues:{},numericFormattedValues:{},fields:{}},s=n.fields[i.idField],c=s.get_value?s.get_value().toString():s,l=new r.a(t.EntityLogicalName,new a.a(c)),u=r.a.toLegacyEntityReference(l);for(const e of i.columnNames){const t=n.fields[e];t&&(o.fields[t.get_attributeLogicalName()]=t.get_value(),o.fieldTypes[t.get_attributeLogicalName()]=t.get_attributeType())}const f=`${i.alias}${E.c}`;if(n.fields.hasOwnProperty(f)){const e=n.fields[f];o.fields.devicefilepath=e.get_value(),o.fieldTypes.devicefilepath=e.get_attributeType()}const g=`${i.alias}${E.d}`;if(n.fields.hasOwnProperty(g)){const e=n.fields[g];o.fields.devicethumbnailpath=e.get_value(),o.fieldTypes.devicethumbnailpath=e.get_attributeType()}const h=new d.a(u,o.fields,o.fieldTypes,o.formattedValues,o.numericFormattedValues,new p.a([]));e.push(h),n.fields[i.navigationPropertyName]=e,n.fieldTypes[i.navigationPropertyName]=C.a.NavigationProperty}}}function k(e,t,n,r,a,o,s,c,l){if(a===I.OData){const e=V(t);r.hasOwnProperty(e)&&(n.formattedValues[t]=r[e])}else switch(s){case C.a.MultiSelectPickList:n.formattedValues[t]=function(e,t){if(!Object(i.a)(e)){const n=e.split(","),r=[];return n.forEach(e=>{const n=t.find(t=>String(t.Value)===e.trim());n&&r.push(n.Label)}),r.join("; ")}return null}(n.fields[t],o[t].OptionSet);break;case C.a.PickList:case C.a.Boolean:case C.a.State:case C.a.Status:{const e=n.fields[t];e instanceof y.a&&(n.formattedValues[t]=e.get_Label());break}case C.a.Customer:case C.a.Owner:case C.a.Lookup:case C.a.DateTime:case C.a.Double:case C.a.Decimal:case C.a.Integer:case C.a.BigInt:case C.a.Money:{const r=n.fields[t];if(!Object(i.a)(r)){const a=L(e,o,t,s,r,s===C.a.Money&&n.fields[E.z]?n.fields[E.z]:null,c,l);Object(i.a)(a)||(n.formattedValues[t]=a)}break}}}function L(e,t,n,a,o,s,c,l){let u=null;if(!(null==t?void 0:t[n]))return null==l||l.warn(`No attribute descriptor found for ${n} on ${c}`),u;switch(a){case C.a.Customer:case C.a.Owner:case C.a.Lookup:case C.a.DateTime:case C.a.Double:case C.a.Decimal:case C.a.Integer:case C.a.BigInt:case C.a.Money:if(!Object(i.a)(o)){const i=t[n];let c=null;if(a===C.a.Money&&s){const e=r.a.fromLegacyEntityReference(s);c=e?{reference:e}:void 0}const l=Object(v.A)(e,i,c);u="integer"===l.controlAttributes.Type?Object(v.l)(o,l.cultureInfo):Object(v.y)(o,l)}}return u}function B(e){return`_${e}_value`}function U(e){return e+"@Microsoft.Dynamics.CRM.lookuplogicalname"}function V(e){return e+"@OData.Community.Display.V1.FormattedValue"}function z(e,t,n,l,u,d,p,f,g,h=I.OData){let v,S,j=W(n,h);if("versionnumber"===n&&h===I.OData&&t["@odata.etag"]){const e=t["@odata.etag"].match(/W\/\"([0-9a-zA-Z]+)\"/);if(e&&e[1])return e[1]}if(!(p||t.hasOwnProperty(n)||t.hasOwnProperty(j)||f))return null;if(d&&d[n]&&-1!==[C.a.Lookup,C.a.Customer,C.a.Owner].indexOf(d[n].Type))f&&f.hasOwnProperty(n)&&(j=W(n,h,!0)),v=t[j];else if(d&&d[n]){const e=G(f,t,n),r=f&&f[n]&&f[n].oDataAlias&&f[n].oDataAlias[e]||n;if(S=f&&f[n]&&f[n].rowaggregate||null,v=t[r],f&&f[n]&&f[n].isAttributeAlias&&Object(i.a)(S))return v}else v=t[n];if(!p&&null===v)return null;switch(l){case C.a.AliasedValue:const{aliasedValueEtn:l,aliasedValueFieldName:P}=f[n],T=Object(c.h)(e,l),N=Object(s.a)(e,l,P);let A;A="CountChildren"===S?C.a.Integer:P===E.c||P===E.d?C.a.String:N.Type;const R=new m.a(l,P,A);return v=z(e,t,n,A,T,{[n]:N},p,f,g,h),null==v?null:(R.set_value(v),R);case C.a.Customer:case C.a.Lookup:case C.a.Owner:const D=t[function(e,t,n=I.OData){return n===I.OData?U(t):e+"!logicalname"}(n,j,h)],x=t[function(e,t,n=I.OData){return n===I.OData?V(t):e+"!name"}(n,j,h)];if(D&&v)return r.a.toLegacyEntityReference(new r.a(D,new a.a(v),x));const M=[];return M.push({name:"EntityLogicalName",value:null==d[n]?"null":d[n].EntityLogicalName}),M.push({name:"Attribute Name",value:null==d[n]?"null":d[n].LogicalName}),M.push({name:"Lookup Field EntityLogicalName",value:null==D?"null":D}),M.push({name:"FieldValue",value:null==v?"null":v}),M.push({name:"lookupFormattedValue",value:null==x?"null":x}),function(e,t,n){n&&n.error(e,t)}("_constructFieldValue: Lookup Field EntityLogicalName or FieldValue is null",M),null;case C.a.UniqueIdentifier:const F=a.a.tryParseOrNull(v);return F?a.a.toLegacyGuid(F):null;case C.a.DateTime:let k;return k=h===I.OData?d&&d[n]&&d[n].Behavior===b.a.TimeZoneIndependent?v.replace(/-\d{2}:\d{2}$/,"Z"):v:Object(O.b)(v),Object(i.b)(v)?null:new Date(Date.parse(k));case C.a.Status:case C.a.State:case C.a.Boolean:case C.a.PickList:const L=t[V(n)];let B;const q=d[n].OptionSet;return q&&(null==v&&q.DefaultValue&&-1!==q.DefaultValue&&(v=q.DefaultValue),null!=v&&(B=q.find(e=>Number(e.Value)===Number(v)))),B?new y.a(L||B.Label,B.Value,null,null,null,B.Color,null):new y.a(L,v,null,null,null,null,null);case C.a.PartyList:return function(e,t,n,r,a,i=!1){if(r&&r.OneToManyRelationships){const l=H(e,t,r,n,a,i);if(!l)return null;const u=n[l];if(!u)return null;const d=Object(c.h)(e,"activityparty"),p=Object(s.d)(e,"activityparty"),f=Object.keys(p),g=u.filter(e=>e.participationtypemask===Object(o.a)(i?a[t].aliasedValueEtn:r.EntityLogicalName,i?a[t].aliasedValueFieldName:t)).map(t=>w(e,t,d,p,f));return new _.a(g,!1,g.length,!1,null,null)}return new _.a([],!1,0,!1,null,null)}(e,n,t,u,f,null!=f&&null!=f[n]);default:return v}}function q(e,t,n,r=!1){if(r&&n&&n[e]){const r=G(n,t,e);return n[e].oDataAlias[r]}return e}function H(e,t,n,r,a,i=!1){const o=i?a[t].aliasedValueEtn:n.EntityLogicalName,s=Object(c.b)(e,o);if(!s)return null;if(i){const e=G(a,r,t);return`${a[t].alias}${a[t].oDataSeparator[e]}${s.ReferencedEntityNavigationPropertyName}`}return""+s.ReferencedEntityNavigationPropertyName}function W(e,t=I.OData,n=!1){return t===I.OData?n?e:B(e):e+"!id"}function G(e,t,n){if(e&&e.hasOwnProperty(n)&&e[n].oDataAlias.length>0)for(let r=0;r<e[n].oDataAlias.length;r++)if(t.hasOwnProperty(e[n].oDataAlias[r]))return r;return 0}},"x6/I":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i}));const r="set.counter.value";function a(e,t=0){return{type:"generate-"+e,sync:!0,execute({dispatch:n,getState:a}){const o=(s=a(),c=e,s.appShellState.componentCounters[c]||t);var s,c;return n(function(e,t){return{type:r,payload:{counterType:e,value:t}}}(e,o+1)),i(e,o)}}}function i(e,t){return`${e}-${t}`}},x8sc:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r=(e,t)=>{if(!t||0===t.length)return e;let n=e;return t.forEach(e=>{const t=new RegExp("\\"+e,"g");n=n.replace(t,"\\"+e)}),n}},xAYq:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="_"},xAwK:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n("fMBw"),a=n.n(r),i=n("5UJb"),o=n.n(i),s=n("SZCI");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
let c=!0;function l(e,t,n){if(t&&Array.isArray(t)){if(!performance||!performance.timing||null==performance.timing.navigationStart){if(n){const e=[];e.push({name:"window.performance exists?",value:!!performance}),e.push({name:"window.performance.timing exists?",value:!!performance.timing}),e.push({name:"window.performance.timing.navigationStart exists?",value:null!=performance.timing.navigationStart}),n.warn("Shim metrics have been supplied, but window.performance.timing.navigationStart is not available, preventing any metric comparison",e)}return}c&&(c=!1,function(e){let t=null;try{t=window.parent&&window.parent.performance&&window.parent.performance.timing&&window.parent.performance.timing.navigationStart}catch(t){e&&e.warn("Could not zero performance timeline - failed to get parent NavigationStart")}if(null!==t){const n=t-performance.timing.navigationStart;if(n<0)o.a.overrideWorkBlockStartTime(n);else if(e){const t=[{name:"Difference",value:n}];e.warn("Could not zero performance timeline - bad difference",t)}}}(n)),t.map(t=>{if(!t)return;const r=t.Name,i=t.StartTime,o=t.StopTime,c=t.Parameters;if(!r||"string"!=typeof r||!i||"number"!=typeof i||!o||"number"!=typeof o){if(n){const e=[];e.push({name:"Name",value:r}),e.push({name:"StartTime",value:i}),e.push({name:"StopTime",value:o}),n.warn("Malformed shim performance metric",e)}return}const l=i-performance.timing.navigationStart,u=o-performance.timing.navigationStart,d=Object.assign(Object.assign({},e),c),p=a.a.createEvent(r,s.A);-1===o?p.createMarker(d,l):p.createRetroactiveStopwatch(l,u-l,d)})}}},"xE5/":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="contextualHelpBrowser.close";function a(){return{type:r,payload:{}}}},xHmU:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}));var r=n("oT5e"),a=n("+nTZ");function i(e,t){let n;const i=[];n=t?Object(r.a)(e,t):Object(r.f)(e);for(const t of n.dialogContextIds){const n=Object(a.a)(e,t);if(n)for(const e of n.pageStack)i.push(e)}return i}function o(e,t){const n=[],r=i(e,t);for(let e=0;e<r.length;e++)-1!==r[e].indexOf("_")&&isNaN(parseInt(r[e],10))||n.push(r[e]);return n}},"xM/W":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));const r="offline.setshowreconnectnotificationafterupsync";function a(e){return{type:r,payload:{showReconnectNotificationAfterUpsync:e}}}},xP3K:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("84PK"),a=n("S70w");class i{constructor(e,t,n,r,a){this._transactionCurrencyId=null,this._currencyName=null,this._currencySymbol=null,this._currencyCode=null,this._currencyPrecision=0,this._transactionCurrencyId=e,this._currencyName=t,this._currencySymbol=n,this._currencyCode=r,this._currencyPrecision=a}get_TransactionCurrencyId(){return this._transactionCurrencyId}get_CurrencyName(){return this._currencyName}get_CurrencySymbol(){return this._currencySymbol}get_CurrencyCode(){return this._currencyCode}get_CurrencyPrecision(){return this._currencyPrecision}getObjectData(){const e={};return e.transactioncurrencyid=this._transactionCurrencyId.getObjectData(),e.currencyname=this._currencyName,e.currencysymbol=this._currencySymbol,e.currencycode=this._currencyCode,e.currencyprecision=this._currencyPrecision,e}getCurrencyDisplaySymbol(e){return e===a.a.CurrencyCode?this.get_CurrencyCode():this.get_CurrencySymbol()}static createFromObjectData(e){const t=r.a.createFromObjectData(e.transactioncurrencyid),n=e.currencyname,a=e.currencysymbol,o=e.currencycode,s=e.currencyprecision;return new i(t,n,a,o,s)}}},xPbo:function(e,t,n){"use strict";n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return c})),n.d(t,"e",(function(){return l})),n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return p}));var r=n("zsAz"),a=n("1OTd"),i=n("oT5e"),o=n("gQ5I"),s=n("tFCh");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function c(e,t,n){return{type:a.q,payload:{currentPage:e,error:null,browsingContextId:n},meta:{pageId:t}}}function l(e,t){return{type:a.q,payload:{currentPage:null,error:e,browsingContextId:t},meta:{pageId:null}}}function u(e){return{type:a.q,payload:{currentPage:null,error:null,browsingContextId:e}}}function d(e){return{type:a.b,execute({dispatch:t,getState:n},r){const c=Object(i.a)(n(),e);return t(Object(o.d)(e)).then(()=>c.pageId&&t(Object(o.f)(c.pageId))).then(()=>t(Object(s.a)(e))).then(()=>t(function(e){return{type:a.c,payload:{browsingContextId:e}}}(e)))}}}function p(e,t){return{type:a.f,sync:!0,execute({dispatch:n,getState:o},s){if(Object(i.e)(o())[e])throw Object(r.d)("Browsingcontext id already been used",2415919107,[{name:"id",value:e}]);n(function(e,t){return{type:a.g,payload:{browsingContextId:e,type:t}}}(e,t))}}}},xRzR:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n("mMyr"),a=n("QEBF");function i(e,t){return new Promise((function(n,r){var a=new XMLHttpRequest;a.onreadystatechange=function(){if(a.readyState===XMLHttpRequest.DONE){var e=a.responseText;/<svg[\s\S]*>/i.test(e)?n(function(e){return(new DOMParser).parseFromString(e,"text/xml").getElementsByTagName("svg")[0]}(e)):r(new Error("Provided file isn't a valid SVG"))}},a.open("GET",e,!0),t&&a.setRequestHeader("Authorization","Bearer "+t),a.send()}))}var o,s=n("ghc6"),c=n("8aze"),l=n("Y7HL"),u=(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),d=function(e){function t(t){var n=e.call(this,t)||this;return n.state={},n}return u(t,e),t.prototype.componentDidMount=function(){this.props.source&&this._inlineSvgImage(this.props.source)},t.prototype.componentDidUpdate=function(e){this.props.source!==e.source&&this._inlineSvgImage(this.props.source)},t.prototype._inlineSvgImage=function(e){var t,n,r=this;(t=e,n=this.props.token,i(t,n).then((function(e){var t,n,r=null;return e&&(function(e){for(var t=e.getElementsByTagName("script"),n=t.length-1;n>=0;n--)t[n].parentNode.removeChild(t[n])}(e),(r=function(e){for(var t={},n=0;n<e.attributes.length;n++){var r=e.attributes[n].name,a=e.attributes[n].value;"style"===r?a=i(a):"class"===r&&(r="className"),t[r]=a}return t;function i(e){if(!e)return null;for(var t={},n=0,r=e.split(";").filter((function(e){return e&&-1!==e.indexOf(":")}));n<r.length;n++){var a=r[n].split(":"),i=a[0].trim().replace(/-\S/g,(function(e){return e[1].toUpperCase()})),o=a[1].trim();t[i]=o}return t}}(e)).dangerouslySetInnerHTML={__html:(t=e,n=new XMLSerializer,Array.prototype.reduce.call(t.childNodes,(function(e,t){return e+n.serializeToString(t)}),""))},r=Object.freeze(r)),r}))).then((function(e){e?r.setState({parsedSvgProps:e}):r.props.onParsingError&&r.props.onParsingError("File content is empty")}),(function(e){r.props.onParsingError&&r.props.onParsingError(e.message)}))},t.prototype._shouldRenderImg=function(){return this.props.source&&this.props.fallbackToImage&&!this.state.parsedSvgProps},t.prototype.getElementName=function(){return"svg"},t.prototype.getElementProps=function(){return Object.assign({},this.state.parsedSvgProps,this.props)},t.prototype.getElementClassName=function(){var t,n,r=e.prototype.getElementClassName.call(this)||"";return(null===(n=null===(t=this.state.parsedSvgProps)||void 0===t?void 0:t.className)||void 0===n?void 0:n.length)&&(r.length&&" "!==r[r.length-1]&&(r+=" "),r+=this.state.parsedSvgProps.className),r},t.prototype.render=function(){if(this._shouldRenderImg()){var e=void 0;return this.props.source&&(e=this.props.source.replace(/\\/g,"/")),r.createElement(l.a,{source:e,style:this.props.style,altText:this.props.altText,title:this.props.title})}return r.createElement(this.getElementName(),this.getElementPropsInternal(),this.getElementChildren())},t.displayName="Svg",t}(a.a),p=s.a(c.b)(d)},xagu:function(e,t,n){"use strict";n.d(t,"e",(function(){return o})),n.d(t,"f",(function(){return r})),n.d(t,"g",(function(){return a})),n.d(t,"h",(function(){return s})),n.d(t,"i",(function(){return c})),n.d(t,"j",(function(){return l})),n.d(t,"k",(function(){return u})),n.d(t,"l",(function(){return p})),n.d(t,"m",(function(){return d})),n.d(t,"n",(function(){return f})),n.d(t,"o",(function(){return g})),n.d(t,"p",(function(){return h})),n.d(t,"q",(function(){return m})),n.d(t,"r",(function(){return b})),n.d(t,"s",(function(){return y})),n.d(t,"t",(function(){return _})),n.d(t,"u",(function(){return v})),n.d(t,"v",(function(){return S})),n.d(t,"x",(function(){return O})),n.d(t,"a",(function(){return T})),n.d(t,"z",(function(){return C})),n.d(t,"A",(function(){return E})),n.d(t,"F",(function(){return I})),n.d(t,"H",(function(){return w})),n.d(t,"I",(function(){return j})),n.d(t,"G",(function(){return P})),n.d(t,"J",(function(){return N})),n.d(t,"R",(function(){return A})),n.d(t,"S",(function(){return R})),n.d(t,"M",(function(){return D})),n.d(t,"N",(function(){return x})),n.d(t,"L",(function(){return M})),n.d(t,"Q",(function(){return F})),n.d(t,"O",(function(){return k})),n.d(t,"P",(function(){return L})),n.d(t,"K",(function(){return B})),n.d(t,"T",(function(){return U})),n.d(t,"b",(function(){return i})),n.d(t,"U",(function(){return V})),n.d(t,"V",(function(){return z})),n.d(t,"W",(function(){return q})),n.d(t,"X",(function(){return H})),n.d(t,"Z",(function(){return W})),n.d(t,"ab",(function(){return G})),n.d(t,"bb",(function(){return K})),n.d(t,"cb",(function(){return Q})),n.d(t,"db",(function(){return X})),n.d(t,"eb",(function(){return Y})),n.d(t,"fb",(function(){return J})),n.d(t,"hb",(function(){return $})),n.d(t,"gb",(function(){return Z})),n.d(t,"E",(function(){return ee})),n.d(t,"C",(function(){return te})),n.d(t,"D",(function(){return ne})),n.d(t,"c",(function(){return re})),n.d(t,"y",(function(){return ae})),n.d(t,"B",(function(){return ie})),n.d(t,"d",(function(){return oe})),n.d(t,"Y",(function(){return se})),n.d(t,"w",(function(){return ce}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="customControlId",a="controlName",i="_canOverride",o="cmdbar",s="dashboardid",c="data",l="dialogCancelLabel",u="dialogConfirmLabel",d="dialogHideDownloadLogLink",p="dialogErrorText",f="dialogOptions",g="dialogShowDetailsLabel",h="dialogSubtitle",m="messageText",b="dialogTitle",y="dialogType",_="Unknown ModalDialog Type",v="etn",S="extraqs",O="formid",C="id",E="isCrossEntityNavigate",I="name",w="navitemid",j="navpath",P="navbar",T="bodyOnly",N="pagetype",A="process",R="processinstanceid",D="powerbiembedurl",x="powerbigroupid",M="powerbidashboardid",F="powerbitileid",k="powerbireportid",L="powerbireporturl",B="powerbicomponenttype",U="recordSetQueryKey",V="searchText",z="searchType",q="selectedstageid",H="selectedTabId",W="type",G="uniquename",K="viewid",Q="viewType",X="visualizationid",Y="visualizationPaneMode",J="visualizationType",$="webresourceName",Z="webresourceData",ee="landingPage",te="isOfflineSyncError",ne="preview",re="channelId",ae="hostCorrelationId",ie="embedded",oe="clienthost",se="themeoption",ce="forceOfflineDataSync"},xggx:function(e,t,n){"use strict";n.d(t,"d",(function(){return d})),n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return s}));var r=n("/leX"),a=n("rcL5"),i=n("AVDU"),o=n("3peg");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function s(e){return e.type!==r.b.Pane?2!==e.option.sidePanelState:!e.option.hidden}function c(e){let t=null,n=null;return function(r){const i=Object(a.d)(r).panes;return t&&n===i||(t=function(e,t){return Object(a.k)(e,t).panes.map(t=>Object(a.i)(e,t)).filter(e=>s(e))}(r,e),n=i),t}}const l=c(2),u=c(1);function d(e){if(Object(i.e)(e))return!1;const t=l(e),n=Object(a.k)(e,2);return Object(o.d)(e)?t.length>=1:t.length>1||1===t.length&&(t[0].type===r.b.Pane||0===n.panesState||n.selectedPane!==t[0].sidePanelId)}},xhhr:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i}));var r=n("NjDY");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e){const t=Object(r.D)(e);return{isPowerBIEnabled:i(e),firstPartyIntegrationSiteUrl:t&&t.firstPartyIntegrationSiteUrl}}function i(e){const t=Object(r.D)(e);return t&&t.isPowerBIEnabled}},xiom:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("WF3G");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class a extends r.a{constructor(e,t){super(e.get_FetchXml()),this._subQueries=t}get_id(){let e=super.get_id();const t=this._subQueries;for(const n in t){const r={key:n,value:t[n]};e+=","+r.key+":"+r.value.get_id()}return e}toString(){let e=super.toString();const t=this._subQueries;for(const n in t){const r={key:n,value:t[n]};e+=","+r.key+":"+r.value.toString()}return e}}},xkcG:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n("ABCl"),a=n("IqkD"),i=n("qshH"),o=n("SAYH"),s=n("MXaZ"),c=n("ZIjf"),l=n("Sbn7"),u=n("69Qu");let d;class p{constructor(e){d=e,this._clientApiExecutor=new r.b(e,"ClientApi.XrmUserSettings.")}getTimeZoneOffsetMinutes(){const e="ClientApi.XrmUserSettings.getTimeZoneOffsetMinutes";try{c.a.instance.reportCall(e);const t=Object(a.x)(d.getState()),n=t?t.timeZoneUtcOffsetMinutes+Object(s.t)(new Date,t.timeZoneAdjusters):null;return c.a.instance.reportSuccess(e),n}catch(t){throw i.a.getInstance().reportFailure(e,t),t}}get userId(){const e="ClientApi.XrmUserSettings.userId";try{c.a.instance.reportCall(e);const t=Object(a.y)(d.getState()),n=t?o.a.externalGuid(t.userId):null;return c.a.instance.reportSuccess(e),n}catch(t){throw i.a.getInstance().reportFailure(e,t),t}}get languageId(){const e="ClientApi.XrmUserSettings.languageId";try{c.a.instance.reportCall(e);const t=Object(a.x)(d.getState()),n=t?t.languageId:null;return c.a.instance.reportSuccess(e),n}catch(t){throw i.a.getInstance().reportFailure(e,t),t}}get pagingLimit(){const e="ClientApi.XrmUserSettings.pagingLimit";try{c.a.instance.reportCall(e);const t=Object(a.x)(d.getState()),n=t?t.recordsPerPage:null;return c.a.instance.reportSuccess(e),n}catch(t){throw i.a.getInstance().reportFailure(e,t),t}}get roles(){return this._clientApiExecutor.execute("roles_get",e=>{const t=new l.a(e),n=Object(a.w)(d.getState());for(const e in n){const r={id:e,name:n[e]};t.add(e,r)}return t})}get securityRoles(){const e="ClientApi.XrmUserSettings.securityRoles";try{c.a.instance.reportCall(e);const t=new Array,n=Object(a.w)(d.getState());for(const e in n)t.push(e);return c.a.instance.reportSuccess(e),t}catch(t){throw i.a.getInstance().reportFailure(e,t),t}}get securityRolePrivileges(){const e="ClientApi.XrmUserSettings.securityRolePrivileges";try{c.a.instance.reportCall(e);const t=new Array,n=Object(a.v)(d.getState());for(const e in n)t.push(n[e].privilegeId.guid);return c.a.instance.reportSuccess(e),t}catch(t){throw i.a.getInstance().reportFailure(e,t),t}}getSecurityRolePrivilegesInfo(){var e,t;const n="securityRolePrivilegesInfo",r="ClientApi.XrmUserSettings."+n,o=Object(u.c)(d.getState());if(c.a.instance.reportCall(r),!o){const e=`Xrm.Utility.getGlobalContext().userSettings.${n} is only available in online mode.`,t={eventName:"ApiUnsupportedOffline",eventParameters:[{name:"Api",value:"Xrm.Utilty.getGlobalContext().userSettings."+n}]};throw i.a.getInstance().reportEvent(t),new Error(e)}try{const n=Object(a.v)(d.getState()),o={};let s=0;const l=Object.keys(n).length;for(const r in n)void 0===n[r].privilegeName&&s++,o[r]={id:null===(e=n[r].privilegeId)||void 0===e?void 0:e.guid,businessUnitId:null===(t=n[r].businessUnitId)||void 0===t?void 0:t.guid,privilegeName:n[r].privilegeName,depth:n[r].privilegeDepth};const u={eventName:"getSecurityRolePrivilegesInfo_PrivilegeCount",eventParameters:[{name:"TotalPrivilegeCount",value:l},{name:"UndefinedPrivilegeNamesCount",value:s}]};return i.a.getInstance().reportEvent(u),c.a.instance.reportSuccess(r),Promise.resolve(o)}catch(e){throw i.a.getInstance().reportFailure(r,e),e}}get userName(){const e="ClientApi.XrmUserSettings.userName";try{c.a.instance.reportCall(e);const t=Object(a.t)(d.getState());return c.a.instance.reportSuccess(e),t}catch(t){throw i.a.getInstance().reportFailure(e,t),t}}get isGuidedHelpEnabled(){const e="ClientApi.XrmUserSettings.isGuidedHelpEnabled";try{c.a.instance.reportCall(e);const t=Object(a.x)(d.getState()),n=t?t.isGuidedHelpEnabled:null;return c.a.instance.reportSuccess(e),n}catch(t){throw i.a.getInstance().reportFailure(e,t),t}}get isHighContrastEnabled(){const e="ClientApi.XrmUserSettings.isHighContrastEnabled";try{c.a.instance.reportCall(e);const t=Object(a.x)(d.getState()),n=t?t.isHighContrastEnabled:null;return c.a.instance.reportSuccess(e),n}catch(t){throw i.a.getInstance().reportFailure(e,t),t}}get isRTL(){const e="ClientApi.XrmUserSettings.isRTL";try{c.a.instance.reportCall(e);const t=Object(a.x)(d.getState()),n=t?t.isRTL:null;return c.a.instance.reportSuccess(e),n}catch(t){throw i.a.getInstance().reportFailure(e,t),t}}get isEmailConversationViewEnabled(){const e="ClientApi.XrmUserSettings.isEmailConversationViewEnabled";try{c.a.instance.reportCall(e);const t=Object(a.x)(d.getState()),n=t&&!0===t.isEmailConversationViewEnabled;return c.a.instance.reportSuccess(e),n}catch(t){throw i.a.getInstance().reportFailure(e,t),t}}get autoCaptureUserStatus(){return this._clientApiExecutor.execute("autoCaptureUserStatus_get",()=>{const e=Object(a.x)(d.getState());return e?e.autoCaptureUserStatus:0})}get formatInfoCultureName(){const e="ClientApi.XrmUserSettings.formatInfoCultureName";try{c.a.instance.reportCall(e);const t=Object(a.x)(d.getState()),n=t?t.formatInfoCultureName:null;return c.a.instance.reportSuccess(e),n}catch(t){throw i.a.getInstance().reportFailure(e,t),t}}get transactionCurrencyId(){const e="ClientApi.XrmUserSettings.transactionCurrencyId";try{c.a.instance.reportCall(e);const t=this.transactionCurrency,n=t?t.id:null;return c.a.instance.reportSuccess(e),n}catch(t){throw i.a.getInstance().reportFailure(e,t),t}}get dateFormattingInfo(){const e="ClientApi.XrmUserSettings.dateFormattingInfo";try{c.a.instance.reportCall(e);const t=Object(a.x)(d.getState()),n=t?t.dateFormatInfo:null;return c.a.instance.reportSuccess(e),n}catch(t){throw i.a.getInstance().reportFailure(e,t),t}}get defaultDashboardId(){const e="ClientApi.XrmUserSettings.defaultDashboardId";try{c.a.instance.reportCall(e);const t=Object(a.x)(d.getState()),n=t?o.a.toString(t.defaultDashboardId):null;return c.a.instance.reportSuccess(e),n}catch(t){throw i.a.getInstance().reportFailure(e,t),t}}get transactionCurrency(){const e="ClientApi.XrmUserSettings.transactionCurrency";try{c.a.instance.reportCall(e);const t=Object(a.x)(d.getState());if(t){const n={id:o.a.toString(t.transactionCurrencyId),entityType:"transactioncurrency",name:t.transactionCurrencyById[o.a.toString(t.transactionCurrencyId)].currencyName};return c.a.instance.reportSuccess(e),n}return i.a.getInstance().reportFailure(e,new Error("User Settings are null")),null}catch(t){throw i.a.getInstance().reportFailure(e,t),t}}}},xmKQ:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="update.appid";function a(e){return{type:r,payload:{appContext:{app:{appId:e}}}}}},xnzJ:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="offline.first.time.metadata.validation.completed";function a(e){return{type:r,payload:{isFirstTimeMetadataValidationCompleted:e}}}},xqqo:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r,a=n("F6M4"),i=n("QEBF"),o=n("hGVc"),s=n("MrAI"),c=n("ghc6"),l=n("8aze"),u=(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),d=function(e){function t(t){var n=e.call(this,t)||this;return n.refCallbackTrigger=n.refCallbackTrigger.bind(n),n}return u(t,e),t.prototype.getElementName=function(){return"ul"},t.prototype.getFlexClassName=function(e){return Object(a.b)(e?e.display:null)},t.prototype.getElementProps=function(){var e={ref:this.props.refCallback?this.refCallbackTrigger:null};return!0===this.props.announceAccessibilityNotification&&(e[o.p]=this.props.notificationType||s.a),e},t.prototype.getElementStyle=function(){if(this.props.style)return Object.assign({},Object(a.a)(this.props.style))},t.displayName="List",t}(i.a),p=c.a(l.b)(d)},xy1J:function(e,t,n){"use strict";n.d(t,"p",(function(){return y})),n.d(t,"e",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"m",(function(){return s})),n.d(t,"a",(function(){return c})),n.d(t,"k",(function(){return l})),n.d(t,"f",(function(){return u})),n.d(t,"i",(function(){return d})),n.d(t,"h",(function(){return p})),n.d(t,"g",(function(){return f})),n.d(t,"j",(function(){return g})),n.d(t,"l",(function(){return h})),n.d(t,"n",(function(){return m})),n.d(t,"o",(function(){return b}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="Error_Text_FormToastNotification",a="Duplicates_Detected_Notification_Message",i="Duplicates_Ignore_And_Save",o="Duplicates_View_Duplicates",s="Error_Title_0x8004b056",c="Error_Message_Double_Save",l="Form_NotificationLabel_NameValuePair",u="Form_File_Uploading_Message",d="Form_Image_Uploading_Message",p="Form_Image_File_Upload_Fail_Message",f="Form_File_Upload_Cancelled_Message",g="Form_Image_Upload_Cancelled_Message",h="Error_Title_0x83215611",m="FormNotificationButton_UnsavedChanges_Monitor",b="FormNotification_UnsavedChanges_Monitor",y=[r,a,i,o,"Crm.GenericErrorMessage",s,"Error_Title_0x80040220",c,l,"L_InteractionWall_Title",u,d,p,f,g,h,m,b]},"y+Z1":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="Forms.SelectFormTab"},"y6/h":function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return l}));var r=n("YxC/"),a=n("BDhr"),i=n("wCzE");let o=null;function s(){try{if(null==o){const e=localStorage.getItem("UCI_RESOURCE_STRINGS");o=JSON.parse(e)}return o}catch(e){return null}}function c(e){try{o={strings:Object(r.d)(e),missingStrings:Object(r.a)(e),metadataVersion:Object(a.b)(e).currentVersion,userMetadataVersion:Object(i.a)(e).currentVersion},localStorage.setItem("UCI_RESOURCE_STRINGS",JSON.stringify(o))}catch(e){}}function l(e){try{const t=s();t&&(t.metadataVersion<Object(a.b)(e).currentVersion||t.userMetadataVersion<Object(i.a)(e).currentVersion)&&(localStorage.removeItem("UCI_RESOURCE_STRINGS"),o=null)}catch(e){}}},y60j:function(e,t,n){"use strict";n.d(t,"h",(function(){return y})),n.d(t,"m",(function(){return _})),n.d(t,"v",(function(){return v})),n.d(t,"u",(function(){return S})),n.d(t,"t",(function(){return O})),n.d(t,"r",(function(){return C})),n.d(t,"a",(function(){return E})),n.d(t,"c",(function(){return P})),n.d(t,"d",(function(){return T})),n.d(t,"b",(function(){return A})),n.d(t,"f",(function(){return F})),n.d(t,"g",(function(){return L})),n.d(t,"l",(function(){return B})),n.d(t,"k",(function(){return U})),n.d(t,"p",(function(){return V})),n.d(t,"n",(function(){return R})),n.d(t,"o",(function(){return N})),n.d(t,"i",(function(){return z})),n.d(t,"s",(function(){return q})),n.d(t,"w",(function(){return D})),n.d(t,"j",(function(){return x})),n.d(t,"q",(function(){return k})),n.d(t,"e",(function(){return j}));var r=n("SAYH"),a=n("AF/G");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i=[new r.a("DFDF1CDE-837B-4AC9-98CF-AC74361FD89D")];var o=n("eXjw"),s=n("3hnk"),c=n("arV0"),l=n("5Oca"),u=n("odYE"),d=n("bT7G"),p=n("BJ7u"),f=n("NjDY"),g=n("iZ7K"),h=n("i1f0"),m=n("LbMF"),b=n("64CY");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function y(e,t){return e&&e.metadata&&e.metadata.forms&&t?e.metadata.forms[r.a.toString(t)]:null}function _(e,t){const n=y(e,t);return n?n.initialized:o.a.Uninitialized}function v(e,t){const n=y(e,t);return n&&n.Tabs?n.Tabs:null}function S(e,t){const n=y(e,t);return n&&n.TabNames?Object.keys(n.TabNames).length:null}function O(e,t,n){const r=y(e,t);return r&&r.Tabs?r.Tabs.find(e=>e.Id===n):null}function C(e,t,n){const r=y(e,t);return r&&r.Sections?r.Sections[n]:null}function E(e,t,n,r){const a=y(e,n);return a&&a.Controls?2===a.FormType||9===a.FormType?I(e,a.Controls[r],a,t):a.Controls[r]:null}function I(e,t,n,r){const o=t&&t.ClassId&&t.ClassId.guid?t.ClassId.guid.toLowerCase():null;if(o){if(i.filter(e=>e.guid===o).length>0)return null}if(t&&t.DataFieldName&&Object(b.f)(t.DataFieldName))return null;if(o&&(o===a.Z.guid||o===a.E.guid||o===a.ab.guid)){let i=!0;if(o===a.Z.guid||o===a.ab.guid){const a=Object(c.j)(e,r);if(a&&a.entityTypeName&&a.id){const r=new u.a(a.entityTypeName,a.id),o=Object(d.c)(e,r);let c="";if(o){const n=Object(d.e)(e,o.snapshotId,r,t.DataFieldName);c=n&&n.reference?n.reference.etn:null}else{const n=Object(l.j)(e,r,t.DataFieldName);c=n&&n.reference?n.reference.etn:null}if(!Object(h.oc)(t.Id,n,c))return t;i=c?Object(s.b)(e,c):i}}else if(o===a.E.guid){let n=null;if(t.Parameters&&Object.keys(t.Parameters).length>0)for(const e of Object.keys(t.Parameters)){const r=t.Parameters[e];r&&"TargetEntityType"===r.Name&&(n=r.Value)}n&&(i=Object(s.b)(e,n))}return i?t:null}return t}function w(e,t,n,r,a){return null==n?void 0:n.filter(t=>t.Name&&I(e,t,r,a))}function j(e,t,n,r){const a={};for(const i of t.Rows)for(const t of i.Cells){const i=t.ControlName;if(i){const t=E(e,n,r,i);t&&(a[i]=t)}}return a}function P(e,t,n){const r=y(e,t);return r&&r.Controls?2===r.FormType||9===r.FormType?function(e,t,n){const r={};return Object.keys(t.Controls).forEach(a=>{if(a){const i=I(e,t.Controls[a],t,n);i&&(r[a]=i)}}),r}(e,r,n):r.Controls:null}function T(e,t,n){const r=y(e,t);if(!r||!r.Header)return null;const a=r.Header.Controls;return a?2===r.FormType||9===r.FormType?w(e,0,a,r,n):a:null}function N(e,t){const n=y(e,t);return n&&n.Header?!!Array.isArray(n.Header)||n.Header.AvailableForPhone:null}function A(e,t,n){const r=y(e,t);if(!r||!r.Footer)return null;const a=r.Footer.Controls;return a?2===r.FormType||9===r.FormType?w(e,0,a,r,n):a:null}function R(e,t){const n=y(e,t);return n&&n.Footer?!!Array.isArray(n.Footer)||n.Footer.AvailableForPhone:null}function D(e,t){let n=null;const r=y(e,t);if(r){const t=Object(g.d)(e,r.EntityLogicalName);if(t&&r.Attributes&&(n=r.Attributes.filter(e=>t.has(e))),t&&r.ControlConfigAttributes)for(let a of r.ControlConfigAttributes){const i=Object(m.a)(e,r.EntityLogicalName,a);i&&(a=i.AttributeOf||a),-1===n.indexOf(a)&&t.has(a)&&n.push(a)}}return n}function x(e,t){const n=y(e,t);return n&&n.FormParameters&&n.FormParameters.length>0?n.FormParameters.map(e=>e.Name):null}function M(e,t,n){if(e&&t&&n){if(!e.metadata.formDefaults)return null;const r=e.metadata.formDefaults[t];if(!r)return null;const a=r[n];return a||null}return null}function F(e,t,n){const r=M(e,t,n);return r?r.formId:null}function k(e,t,n,r){if(null!==t){const n=y(e,t);if(n.initialized!==o.a.Error)return n}const a=F(e,n,r);return null!==a?y(e,a):null}function L(e,t,n){const r=M(e,t,n);return r?r.initialized:o.a.Uninitialized}function B(e,t,n){if(e){const r=e.metadata.formSelectors;if(r&&r[t])return n||(n=Object(p.a)(2)),r[t][n]}return null}function U(e,t,n){if(e){const r=B(e,t);if(r&&n)return r[n.guid]}return null}function V(e,t){const n=y(e,t);return n?n.InlineQuickForms:null}function z(e){if(e.metadata.complexControls&&e.metadata.complexControls.initialized&&e.metadata.complexControls.complexControls&&Object.keys(e.metadata.complexControls.complexControls).length>0){const t={};if(Object.keys(e.metadata.complexControls.complexControls).forEach(n=>t[n.toLowerCase()]=e.metadata.complexControls.complexControls[n]),e.metadata.complexControls.complexControls.FullNameCompositionLinkControl){const n="firstname",r="middlename",a="lastname",i=e.metadata.complexControls.complexControls.FullNameCompositionLinkControl,o=Object(f.i)(e),s=i.indexOf(n),c=i.indexOf(r),l=i.indexOf(a);-1===function(e,t,n,r){t=t||"",n=n||"",r=r||"";let a,i="";i.length>0&&(i=n.substring(0,1));switch(e){case 0:r.length>0&&t.length>0&&(a=[r,t]);break;case 1:t.length>0&&r.length>0&&(a=[t,r]);break;case 2:r.length>0&&(a=[r]),t.length>0&&(a=[r,t]),i.length>0&&(a=[r,t,i]);break;case 3:t.length>0&&(a=[t]),i.length>0&&(a=[t,i]),r.length>0&&(a=[t,i,r]);break;case 4:r.length>0&&(a=[r]),t.length>0&&(a=[r,t]),n.length>0&&(a=[r,t,n]);break;case 5:t.length>0&&(a=[t]),n.length>0&&(a=[t,n]),r.length>0&&(a=[t,n,r]);break;case 6:case 7:a=[r,t];break;default:a=[r]}return a}(o,i[s],i[c],i[l]).indexOf(r)?t.fullnamecompositionlinkcontrol=[n,a]:t.fullnamecompositionlinkcontrol=[n,r,a]}return t}return null}function q(e,t){const n=y(e,t);return n&&n.Sections?Object.keys(n.Sections).length:null}},y9sT:function(e,t,n){"use strict";var r=n("dL4i"),a={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},i={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},o={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},s={};function c(e){return r.isMemo(e)?o:s[e.$$typeof]||a}s[r.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0};var l=Object.defineProperty,u=Object.getOwnPropertyNames,d=Object.getOwnPropertySymbols,p=Object.getOwnPropertyDescriptor,f=Object.getPrototypeOf,g=Object.prototype;e.exports=function e(t,n,r){if("string"!=typeof n){if(g){var a=f(n);a&&a!==g&&e(t,a,r)}var o=u(n);d&&(o=o.concat(d(n)));for(var s=c(t),h=c(n),m=0;m<o.length;++m){var b=o[m];if(!(i[b]||r&&r[b]||h&&h[b]||s&&s[b])){var y=p(n,b);try{l(t,b,y)}catch(e){}}}return t}return t}},yGgp:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));const r="clear.popupNotificationAction";function a(e){return{type:r,payload:e}}},yHAP:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return l})),n.d(t,"c",(function(){return u}));var r=n("pEXn"),a=n("i1f0"),i=n("nC8a"),o=n("+Qpx");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const s={};function c(e,t){if(!s[e]){const n={[t]:[]};s[e]=n}return s[e][t]||(s[e][t]=[]),s[e][t]}function l(e,t,n,a){var i,c,l,u;const d=null===(i=s[t])||void 0===i?void 0:i[n];d&&(d.length>0&&(a&&d.push(a),null===(l=null===(c=null==e?void 0:e.TraceManager)||void 0===c?void 0:c.getTracer(`${o.u}${o.z}`))||void 0===l||l.warn(o.B,[{name:r.l,value:`${o.z}.${n}`},{name:o.z,value:JSON.stringify(d)}])),null===(u=s[t])||void 0===u||delete u[n],0===Object.keys(s[t]).length&&delete s[t])}function u(e,t,n){let r="";const o=Object(a.ib)(e,{id:t},n);return Object(i.a)(e,t)&&(r=`for subform ${null==o?void 0:o.Name} `),`${r}for entity ${null==o?void 0:o.EntityLogicalName}`}},yHIv:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n("n3bs"),a=n("w1eR");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i=Object.keys(a.a).map(e=>e.toString()),o=Object.values(r.a).map(e=>e.toString())},yHXp:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * The unique name of the ModalDialog page module.
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="ModalDialog"},yJdb:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="appprogressindicator.remove";function a(){return{type:r,payload:{inProgress:!1,progressMessage:null}}}},yQs0:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("504W");class a{constructor(e,t,n){this._entityName=null,this._AttributeName=null,this._Operator=null,this._Value=null,this._ConditionName=null,this._set_attributeName(e),this.set_operator(t),this.set_value(n)}get_entityName(){return Object(r.a)(this._entityName)&&(this._entityName=""),this._entityName}set_entityName(e){return this._entityName=e,e}get_attributeName(){return this._AttributeName}_set_attributeName(e){return this._AttributeName=e,e}get_operator(){return this._Operator}set_operator(e){return this._Operator=e,e}get_value(){return this._Value}set_value(e){return this._Value=e,e}_get_conditionName(){return this._ConditionName}set_conditionName(e){return this._ConditionName=e,e}clone(){const e=new a(this.get_attributeName(),this.get_operator(),this.get_value());return e.set_entityName(this.get_entityName()),e.set_conditionName(this._get_conditionName()),e}}},yRo8:function(e,t,n){"use strict";n.d(t,"h",(function(){return E})),n.d(t,"i",(function(){return w})),n.d(t,"e",(function(){return h})),n.d(t,"a",(function(){return b})),n.d(t,"d",(function(){return _})),n.d(t,"b",(function(){return m})),n.d(t,"c",(function(){return y})),n.d(t,"g",(function(){return v})),n.d(t,"j",(function(){return I})),n.d(t,"f",(function(){return S}));var r=n("eXjw"),a=n("SAYH"),i=n("Uv1Y"),o=n("pEXn"),s=n("KeJu"),c=n("EY5k"),l=n("Py/t"),u=n("wCzE"),d=n("0rLi"),p=n("iJGp"),f=n("RADj"),g=n("iF9X");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const h="offline.sync",m="UC_Download_Metadata_Message",b="offlinebpfentities",y="metadataavailable",_="offlinemetadatasyncstatus",v=[],S="Offline";function O(e,t,n){return e&&e.Metadata?e.Metadata.reduce((r,i)=>{const s=new d.a(null,null,null,a.a.toLegacyGuid(new a.a(i.Id)),[],!1,p.a.Offline,t,[],null);switch(i.Type){case-1:s.MetadataType="ribbon",r.push(s);break;case 1:s.MetadataType="entity",r.push(s);break;case 2:s.MetadataType="attribute",r.push(s);break;case 3:break;case 7:s.MetadataType="label",r.push(s);break;case 9:s.MetadataType="optionset",r.push(s);break;case 10:case 20:break;case 22:s.MetadataType="displaystring",r.push(s);break;case 26:s.MetadataType="savedview",r.push(s);break;case 29:s.MetadataType="businessprocessflow",r.push(s);break;case 59:s.MetadataType="savedvisualization",r.push(s);break;case 60:s.MetadataType="form",r.push(s);break;case 61:s.MetadataType="webresource",r.push(s);break;case 62:s.MetadataType="sitemap";const t=e.AppSpecificMetadata;if(t.SiteMapSelectors&&t.SiteMapSelectors.length){const e=t.SiteMapSelectors.filter(e=>e&&e.SelectorItems&&e.SelectorItems.length&&e.SelectorItems[0].Id===i.Id);e&&e.length&&(s.AppId=e[0].AppId)}r.push(s);break;case 64:s.MetadataType="complexcontrol",r.push(s);break;case 66:s.MetadataType="customcontrol",r.push(s);break;case 68:s.MetadataType="customcontroldefaultconfig",r.push(s);break;case 80:s.MetadataType="appmodules",r.push(s);break;case 161:break;default:const a=[],c="Unknown metadata component type in offline sync";a.push({name:o.b.ComponentType,value:i.Type}),n.error(c,a)}return r},[]):null}function C(e,t,n=p.a.Offline,r=null){return new d.a(e,null,null,null,[],!1,n,t,[],r)}function E(e=null,t){return{type:"offline.sync.async",execute({dispatch:n,getState:r},i){const o=r(),d=i.TraceManager.getTracer(S),h=[];if(e||d.warn("OfflineSync: Download the offline Data via Download button on the status page."),!Object(g.e)(o))return n(w({syncStatus:f.a.InProgress})),n(Object(c.e)([m])).then(()=>{const e=i.DataSource;return e.get_ApplicationStatusProvider().isOfflineSyncDone()?null:e.clearEntityAttributeApplicationMetadata().nativePromise()}).then(()=>{if(!e)return n(Object(s.c)(t)).then(t=>{t&&(e=t)})}).then(()=>n(Object(s.f)(t))).then(o=>n(Object(s.e)(t)).then(t=>{const c=r(),d=Object(u.a)(c);let g="";!g&&d&&d.currentVersion&&(g=d.currentVersion.toString());const h=function(e,t,n,r){let i=[];const o={metadataQueries:[],selectorPromises:[]},s=t.TraceManager.getTracer(S);for(const n of e){o.metadataQueries.push(...O(n,r,s)),i=i.concat(n.BPFEntities);const e=t.DataSource.get_LocalDataSource().StoreApplicationMetadata(n.AppSpecificMetadata).nativePromise();if(o.selectorPromises.push(e),n.ResourceStrings&&n.ResourceStrings.length||v&&v.length){const e=C("resourcestring",r);n.ResourceStrings&&n.ResourceStrings.length&&(e.MetadataNames=n.ResourceStrings),v&&v.length&&e.MetadataNames.push(...v),o.metadataQueries.push(e)}const c=n.AppSpecificMetadata;c&&c.AppModuleSelectors&&c.AppModuleSelectors.length&&c.AppModuleSelectors.forEach(e=>{e.SelectorItems&&e.SelectorItems.length&&e.SelectorItems.forEach(e=>{e.IsOfflineEnabled&&o.metadataQueries.push(C("quickcreatemenu",r,p.a.Offline,a.a.toLegacyGuid(a.a.tryParseOrNull(e.Id))))})})}n(Object(l.b)(i)),t.DataSource.saveOfflineInformation(b,i,!1);const c=["userworkspace","userview","uservisualization"].map(e=>C(e,r,p.a.OnDemandWithoutContext));o.metadataQueries.push(...c);const u=["search"].map(e=>C(e,r));return o.metadataQueries.push(...u),o}(function(e,t){if(!t||!t.length||!e.length)return e;const n=e[0],r=t[0],a=n.ResourceStrings.filter(e=>-1===r.ResourceStrings.indexOf(e));n.ResourceStrings=a;const i={};r.Metadata.forEach(e=>{i[e.Id]=e});const o=n.Metadata.filter(e=>{if(!i[e.Id])return!0;const t=i[e.Id];return e.Version!==t.Version||!e.Version||!t.Version});return n.Metadata=o,[n]}(t,o),i,n,g),m=function(e,t,n=750){const r=e.length;let a=null,i=0,o=0;for(;i<r;){const s=e.slice(i,i+n);if(s.length>0){i+=s.length;const e=()=>t(j(s,r,o)).then(e=>o+=e);a=a?a.then(e):e()}}a||(t(w({syncStatus:f.a.InSyncWithServer,itemsToSync:r,itemsSynced:0,metadataAvailable:!0})),a=Promise.resolve());return a}(h.metadataQueries,n);return Promise.all(h.selectorPromises.concat(m)).then(()=>{e&&(n(Object(s.g)(e)),i.DataSource.updateApplicationMetadataVersionStamps(e))})})).then(()=>{I(i,y,!0),I(i,_,f.a.InSyncWithServer),i.EventManager.ReportComponentSuccess("OfflineSync")},e=>{throw I(i,_,f.a.SyncPendingFromServer),i.EventManager.ReportComponentFailure("OfflineSync",e),e});{const e=!0;n(w({syncStatus:f.a.InSyncWithServer,metadataAvailable:e})),I(i,y,e),h.push({name:y,value:e}),I(i,_,f.a.InSyncWithServer),h.push({name:_,value:f.a.InSyncWithServer}),d.warn("OfflineSync: Application Metadata is downloading in the background.",h)}}}}function I(e,t,n){if(e&&e.DataSource&&"function"==typeof e.DataSource.saveSessionState&&"string"==typeof t){const r={};r[t]=n,e.DataSource.saveOfflineInformation(t,r,!1)}}function w(e){const t={offlineSync:Object.assign({initialized:r.a.Initialized},e)};return{type:h,payload:t}}function j(e,t,n){return{type:"offline.sync.batch.async",execute({dispatch:r,getState:a},o){const s=o.DataSource;return r(w({syncStatus:f.a.InProgress,itemsToSync:t,itemsSynced:n})),s.syncClientMetadata(e).nativePromise().then(()=>{const a=n+e.length,i=t!==a?f.a.InProgress:f.a.InSyncWithServer;return i===f.a.InSyncWithServer?(r(w({syncStatus:i,itemsToSync:t,itemsSynced:a,metadataAvailable:!0})),I(o,y,!0),I(o,_,f.a.InSyncWithServer)):r(w({syncStatus:i,itemsToSync:t,itemsSynced:a})),e.length},e=>(r(w({syncStatus:f.a.SyncPendingFromServer})),Object(i.b)(e),null))}}}},ybGo:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}));var r=n("504W"),a=n("jq7Z");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function i(e){return e&&e.offline&&e.offline.client&&!Object(r.a)(e.offline.client.upSyncStatus)?e.offline.client.upSyncStatus:null}function o(e,t){let n=!1;const r=Object(a.a)(e,t);return r&&(n=!!r.__isSyncErrorStatusUpdated),n}},"yc+y":function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return c}));var r=n("e8+c"),a=n("3/02"),i=n("Lyxw");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function o(e,t){return`${r.b}_${t}_${e}`}function s(e){return e&&e.startsWith(r.b)}function c(e){return Object(i.e)(e,a.Fg,a.o)}},ycdb:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n("SAYH"),a=n("eXjw");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i="businessProcessFlow.addIgnoreBpfCheckToRecordData";function o(e,t){if(r.a.equals(t.id,r.a.EMPTY)){const n={entities:{[t.etn]:{[r.a.toString(t.id)]:{initialized:a.a.Initialized,ignoreBpfOnRecord:e}}}};return{type:i,payload:n}}return null}},yyjc:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r={ERROR_LOADING_CONTROL:"Error loading control",VALIDATION_FAILED_EMAIL:"Value is not a valid email",VALIDATION_FAILED_BOOL:"Value is not a valid boolean",VALIDATION_FAILED_DATE:"Value is not a valid Date object",VALIDATION_FAILED_NUM:"Value is not a valid number",VALIDATION_FAILED_INT:"Number is not a valid integer",VALIDATION_FAILED_RANGE:"Value is not within the defined range for this property. Range is {0} to {1}",SELECT_TO_ENTER_DATA:"Select to enter data."},a=r;function i(e){return a[e]}function o(e){a=Object.assign(a,e)}},"z+5+":function(e,t,n){"use strict";n.d(t,"f",(function(){return k})),n.d(t,"n",(function(){return q})),n.d(t,"o",(function(){return W})),n.d(t,"E",(function(){return G})),n.d(t,"D",(function(){return K})),n.d(t,"m",(function(){return Q})),n.d(t,"p",(function(){return X})),n.d(t,"g",(function(){return Y})),n.d(t,"h",(function(){return J})),n.d(t,"i",(function(){return $})),n.d(t,"q",(function(){return te})),n.d(t,"A",(function(){return ne})),n.d(t,"c",(function(){return re})),n.d(t,"k",(function(){return ae})),n.d(t,"l",(function(){return ie})),n.d(t,"r",(function(){return oe})),n.d(t,"u",(function(){return se})),n.d(t,"v",(function(){return ce})),n.d(t,"t",(function(){return le})),n.d(t,"s",(function(){return ue})),n.d(t,"x",(function(){return pe})),n.d(t,"y",(function(){return fe})),n.d(t,"z",(function(){return ge})),n.d(t,"F",(function(){return me})),n.d(t,"d",(function(){return be})),n.d(t,"H",(function(){return ye})),n.d(t,"K",(function(){return _e})),n.d(t,"J",(function(){return ve})),n.d(t,"I",(function(){return Se})),n.d(t,"j",(function(){return Oe})),n.d(t,"a",(function(){return Ce})),n.d(t,"e",(function(){return Ee})),n.d(t,"C",(function(){return Ie})),n.d(t,"B",(function(){return we})),n.d(t,"b",(function(){return je})),n.d(t,"w",(function(){return Pe})),n.d(t,"G",(function(){return Te}));var r=n("w1eR"),a=n("3/02"),i=n("Lyxw"),o=n("504W"),s=n("pF61"),c=n("sZ+8"),l=n("17x/"),u=n("GYEz"),d=n("g22U"),p=n("/oKV"),f=n("5yoC"),g=n("Xe7f"),h=n("qK01"),m=n("hirD"),b=n("v3UX"),y=n("PF3G"),_=n("4ciL"),v=n("f07+"),S=n("69Qu"),O=n("CrQY"),C=n("16wZ"),E=n("Uv1Y"),I=n("WWXV"),w=n("Er26"),j=n("wHbR"),P=n("7F2l"),T=n("eD3A"),N=n("HkYq"),A=n("iZ7K"),R=n("FZDd");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const D=["Create","Update"],x=["Create","Update","Delete","Associate","Disassociate","EntityDefinitions"],M=[],F=[],k=["Create","Update","Delete","ExecuteMultiple"],L=["Create","Update","Delete","ExecuteMultiple","Retrieve","RetrievePrincipalAccess","InitializeFrom","RetrieveProcessControlData","RetrieveMultiple","Disassociate","ExecuteQuickFind","GetClientMetadata"],B=["Create","Update","Delete","ExecuteMultiple","Retrieve","RetrieveMultiple","GetClientMetadata"],U=["Create","Retrieve","Update","Delete","GetClientMetadata","ExecuteMultiple","RetrieveWithUrlParams"],V=[d.d.FUNCTION,d.d.ACTION];function z(e){return!!Object(o.a)(e)||(Object(u.a)(e)===r.a.Browser?Object(S.c)(e)||Object(l.j)(e):!(Object(u.a)(e)===r.a.MailApp&&!Object(i.f)(e,a.Ie)))}function q(e){return ee(e,a.Ke)}function H(e){return ee(e,a.Le)}function W(e){return ee(e,a.Me)}function G(e,t){return q(e)&&t&&t.useModernQueryBuilder}function K(e){return ee(e,a.db)}function Q(e,t,n,r){return ee(e,a.He)&&function(e,t,n=p.a.LocalAndRemote){if(n!==p.a.Remote&&(n!==p.a.LocalAndRemote||t)&&!Object(o.a)(e)&&!Object(o.a)(e.MetadataType))switch(e.MetadataType.toLowerCase()){case"webresource":case"webresourcedescriptor":return!1}return!0}(t,n,r)}function X(e,t){return ee(e,a.Ne)}function Y(e){return Object(i.f)(e,a.Jh)}function J(e){return Y(e)&&Object(i.f)(e,a.Kh)}function $(e){return Y(e)&&Object(i.f)(e,a.Lh)}function Z(e){return Object(i.f)(e,a.De)&&z(e)}function ee(e,t){return Object(i.f)(e,t)&&z(e)}function te(e,t){return Z(e)&&M.includes(t.get_name())||function(e,t){return ae(e)&&D.includes(t)}(e,t.get_name())||function(e,t){return ee(e,a.Ee)&&t instanceof m.a&&function e(t,n,r){const a=r.get_requests();if(0===a.length)return!1;let i=!0;for(let r=0;i&&r<a.length;r++){const o=a[r];i=o instanceof m.a?i&&-1!==L.indexOf(o.get_name())&&e(t,n,a[r]):i&&-1!==L.indexOf(o.get_name())&&(!!n||he(t,o))}return i}(e,Object(S.d)(e),t)}(e,t)||function(e,t){return ee(e,a.Ge)&&t instanceof O.a&&Object(S.d)(e)}(e,t)}function ne(e){return Object(i.f)(e,a.rg)}function re(e){return Object(s.g)(e)&&(Object(i.f)(e,a.tg)||Object(i.f)(e,a.rg))}function ae(e){return ee(e,a.Be)}function ie(e){return ee(e,a.Ce)}function oe(e,t){return ee(e,a.Ee)&&"ExecuteMultiple"===t.getMetadata().operationName&&function e(t,n,r){let a=[];Object(_.e)(n)&&"ExecuteMultiple"===n.getMetadata().operationName?a=n.requests:Object(_.d)(n)&&(a=n);if(!r||0===a.length)return!1;let i=!0;for(let n=0;i&&n<a.length;n++){const s=a[n];i=Object(_.e)(s)&&"ExecuteMultiple"!==s.getMetadata().operationName?i&&!Object(o.a)(s.getMetadata().operationType)&&(!!t||he(r,s)):!(!Object(_.d)(s)&&"ExecuteMultiple"!==s.getMetadata().operationName)&&(i&&e(t,s,r))}return i}(Object(S.d)(e),t,e)}function se(e,t){return z(e)&&Object(S.d)(e)&&(ee(e,a.Ee)&&t===d.d.Execution_Multiple||de(e,t)||ee(e,a.He)&&t===d.d.GCM||ee(e,a.Ne)&&t===d.d.RETRIEVE||ee(e,a.Ge)&&V.includes(t)||ee(e,a.Ke)&&ee(e,a.Le)&&ee(e,a.Me)&&t===d.d.RETRIEVE_MULTIPLE)}function ce(e,t){const n=t.getMetadata().operationName;return W(e)&&"RetrieveWithUrlParams"===n&&Object(o.a)(t.id)}function le(e,t){return Z(e)&&F.includes(t)||function(e,t){return de(e,t)||function(e,t){return Object(S.d)(e)&&ee(e,a.Ge)&&V.includes(t)}(e,t)}(e,t)}function ue(e,t){return le(e,t.getMetadata().operationName)||oe(e,t)||function(e,t){const n=t.getMetadata().operationName;return ee(e,a.Ne)&&("Retrieve"===n||"RetrieveWithUrlParams"===n&&!Object(o.a)(t.id))}(e,t)||function(e,t){return Object(S.d)(e)&&ee(e,a.Ge)&&t&&t.getMetadata()&&(0===t.getMetadata().operationType||1===t.getMetadata().operationType)}(e,t)||function(e,t){return"GetClientMetadata"===t.getMetadata().operationName&&Q(e,t.ClientMetadataQuery)}(e,t)}function de(e,t){return ae(e)&&x.includes(t)}function pe(e,t,n,r,a,i,o,s,c){return q(e)&&t&&!n&&!r&&!a&&!i&&!o&&!s&&!c}function fe(e,t,n,r,a){return q(e)&&H(e)&&!t&&!n&&!r&&!a}function ge(e,t,n,r){return q(e)&&H(e)&&W(e)&&!t&&!n&&!r}function he(e,t){try{let n="";if(t instanceof f.a){if(-1===B.indexOf(t.get_name()))return!1;if(t instanceof b.a)n=t.get_target().LogicalName;else if(t instanceof g.a)n=t.get_target().get_identifier().LogicalName;else if(t instanceof y.a)n=t.get_target().get_identifier().LogicalName;else{if(!(t instanceof h.a))return!0;n=t.get_target().LogicalName}if(n)return Object(c.n)(e,n)}else if(Object(_.e)(t)){if(-1===U.indexOf(t.getMetadata().operationName))return!1;if(t instanceof v.i)n=t.entityReference.name;else if(t instanceof v.b)n=t.etn;else if(t instanceof v.k)n=t.etn;else if(t instanceof v.c)n=t.entityReference.name;else{if(!(t instanceof v.j))return!0;n=t.etn}if(n)return Object(c.n)(e,n)}}catch(e){}return!1}function me(e){return{url:e.urlParameters,method:e.method,additionalHeaders:e.additionalHeaders,body:e.body}}function be(e){return{url:decodeURIComponent(e.urlParameters),method:e.method,additionalHeaders:e.additionalHeaders,body:e.body}}function ye(e,t,n=[]){Object(o.b)(e)&&Object(C.e)(t,"Entity name is null","Entity name is null",n)}function _e(e,t,n=[]){e&&e.length>0&&!e.startsWith("?")&&Object(C.e)(t,'Option Parameter should begin with "?"',null,n)}function ve(e,t){var n,r;e&&e.getMetadata&&e.getMetadata()||Object(C.e)(t,"invalid request");const a=e.getMetadata().boundParameter;a&&"string"!=typeof a&&Object(C.e)(t,"boundParameterName must be a empty or a string");const i=null===(n=null==e?void 0:e.getMetadata)||void 0===n?void 0:n.call(e).operationName,s=null===(r=null==e?void 0:e.getMetadata)||void 0===r?void 0:r.call(e).operationType;switch(1!==s&&0!==s||i||Object(C.e)(t,"Cannot generate base URL for the OData call: the routine name is empty."),i){case"RetrievePrincipalAccess":e.Target&&e.Target.entityType||Object(C.e)(t,"Target must be provided for RetrievePrincipalAccess"),Object(o.a)(e.principal)||e.principal.entityType||Object(C.e)(t,"Principal must be provided for RetrievePrincipalAccess")}}function Se(e,t,n=[]){null!==e&&e<0&&Object(C.e)(t,"Max Page Size should be a positive integer.",null,n)}function Oe(e){const t=Object(E.c)(e);return t&&(t.errorSource===I.a.LocalStore||t.errorSource===I.a.LocalStoreWhileOffline||t.errorSource===I.a.LocalStoreWhileOnline)}function Ce(e,t){if(!Object(o.a)(e)){for(const n in e)if(e[n].name===w.f.OPERATION_TYPE&&e[n].value===t)return;e.push({name:w.f.OPERATION_TYPE,value:t}),e.push({name:w.f.OPERATIONTYPE,value:t,forceOwnColumn:!0})}}function Ee(e,t){return e.indexOf("?")>-1?decodeURIComponent(e.substring(e.indexOf("?"),e.length).replace(/\+/g," ")):""}function Ie(e,t){const n=new URLSearchParams(e);return n.forEach((e,r)=>{switch(r){case j.c.SelectQueryOption:case j.c.OrderByQueryOption:case j.c.TopQueryOption:case j.c.SavedQueryOption:break;case j.c.FilterQueryOption:case j.c.ApplyQueryOption:case j.c.ExpandQueryOption:n.set(r,"X");break;default:null==t||t.warn(`Unexpected ${r} query parameter`),n.set(r,"X")}}),n.toString()}function we(e,t,n,r,a){var i,o;const s=null!==(i=w.k[n])&&void 0!==i?i:n,c=null!==(o=w.p[n])&&void 0!==o?o:n;Object(P.b)(s,t.errorCode,Object(E.d)(t))?e.EventManager.ReportComponentFailure(s,t,"",a):(r||(r=e.TraceManager.getTracer(s)),r.error(`[${c}] ${Object(E.d)(t)}`,a))}function je(e){return Object(T.c)(e)}function Pe(e){var t,n,r;return!((null===(t=e.additionalParameters)||void 0===t?void 0:t.metadatatype)&&(null===(n=e.additionalParameters)||void 0===n?void 0:n.metadatatype.length)>=0&&(null===(r=e.additionalParameters)||void 0===r?void 0:r.metadatatype[0])===N.a.userContext)}async function Te(e,t,n,r,a=[],i){await r(Object(R.f)(e,0===t.length,t,i));const s=Object(A.h)(n(),e),c=null==s?void 0:s.AttributeNames;let l=[];if(Object(o.a)(c)||(l=t.filter(e=>!c.includes(e))),l.length>0)throw a.push({name:"InvalidAttributes",value:JSON.stringify(l)}),new E.a("Operation called with invalid attributes in columnSet.",-2147015424)}},z0a7:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("mMyr"),a=n("u+q+"),i=n("EY5k"),o=n("YxC/"),s=n("2YQW");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function c(e){const t=Object(a.c)(),n=Object(a.d)(t=>Object(o.e)(t,e),s.e);return r.useEffect(()=>{t(Object(i.e)(e))},[t,e]),n}},z0sv:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Flyout=1]="Flyout",e[e.Popup=2]="Popup"}(r||(r={}))},z6CD:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n("arV0"),a=n("jq7Z");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function i(e,t){return Object(r.j)(e,t)}function o(e,t){const n=Object(a.a)(e,t);return n?n.output:null}},z8nh:function(e,t,n){"use strict";n.d(t,"g",(function(){return r})),n.d(t,"k",(function(){return a})),n.d(t,"l",(function(){return i})),n.d(t,"j",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"h",(function(){return l})),n.d(t,"i",(function(){return u})),n.d(t,"o",(function(){return d})),n.d(t,"d",(function(){return p})),n.d(t,"c",(function(){return f})),n.d(t,"e",(function(){return g})),n.d(t,"n",(function(){return h})),n.d(t,"m",(function(){return m})),n.d(t,"f",(function(){return b}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r=7,a=30,i=20,o="ownerid",s=10,c=275,l=4,u="NumberOfResultsBasedOnFields",d="msft_relevanceSearch_showHitsImageCell",p="{crmhit}",f="{/crmhit}",g="gm",h="@search.secondfield.hint",m="x-ms-searchsessionid",b="**"},zAhX:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.Draft=0]="Draft",e[e.InProgress=1]="InProgress",e[e.Completed=2]="Completed",e[e.Failed=3]="Failed",e[e.NetworkError=4]="NetworkError"}(r||(r={}))},zBbx:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("4N6w"),a=n("Wc7r");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function i(e,t){const n=Object(r.a)(e);if(n){const e="Bearer "+n;if("function"==typeof t.setRequestHeader)t.setRequestHeader(a.HEADER.AUTHORIZATION_HEADER,e);else{const n=t;n.additionalHeaders||(n.additionalHeaders={}),n.additionalHeaders[a.HEADER.AUTHORIZATION_HEADER]=e}return t}}},zGWw:function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"e",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r=n("WIoD").a.guid.toUpperCase(),a="MscrmControls.Chart.ChartControl",i="MscrmControls.MailApp.MailAppListControl",o="MscrmControls.AuditAssociatedGrid.AuditControl",s="CardForm"},zI6t:function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},a=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(r(arguments[t]));return e},i=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.PerformanceTracker=t.WORK_START_EVENT_NAME=t.KPI_ZONE=t.PERFORMANCE_OBSERVER_ZONE=void 0;var s=o(n("fMBw")),c=n("pJDo"),l=n("WbTV"),u=n("5ylf"),d=o(n("Tzp9")),p=o(n("4RdG")),f=o(n("OCdQ")),g=n("eBJ0"),h=n("B65h"),m=n("3ZMs"),b=o(n("5UJb"));t.WORK_START_EVENT_NAME="WorkStart";t.KPI_ZONE="Core.KPI";t.PERFORMANCE_OBSERVER_ZONE="PerformanceObserver";var y=s.default.createEvent("WorkStart","Core.Performance"),_=s.default.createEvent("WorkEnd","Core.Performance"),v=["element","first-input","layout-shift","longtask","navigation","paint"],S={};v.forEach((function(e){S[e]=s.default.createEvent(e,t.PERFORMANCE_OBSERVER_ZONE)}));var O=function(){function e(e,t){var n=this;void 0===t&&(t=!1),this._visibilityTracker=new d.default,this._userInteractionTracker=new p.default,this._alertTracker=new f.default,this._workBlockIssues=[],this._issueListeners=[],this._metadata={},this._commonMetadata={},this._commonKpiParameters=null,this._workBlockKpiParameters=null,this._aggregationTransport=null,this._zoneActivityTracker=null,this._timelineProcessors=[],this._idleProcessingCallbacks=[],this._timelineDataCallbacks=[],this._perfDataCallbacks=[],this._queuedKPIs=[],this._workBlockKPICount=0,this._tags=[],this._bootInitializers=[],this._rethrowErrors=t,l.patchNetworkRequests(),e.setPerformanceIssueHook(this.logPerformanceIssue.bind(this)),e.subscribeToAppWorking(this._handleAppWorkingEvent.bind(this)),e.subscribeToAppIdle(this._handleAppIdleEvent.bind(this)),this._performanceObserver=window.PerformanceObserver&&new PerformanceObserver((function(e){n._handlePerformanceObserverEvents(e.getEntries())}))}return e.prototype.initializeOnBoot=function(e){this._bootInitializers.push(e)},e.prototype.initializeZoneActivityTracking=function(e){this._zoneActivityTracker||(this._zoneActivityTracker=new g.ZoneActivitySummaryTransport,s.default.registerTransport(this._zoneActivityTracker,e))},e.prototype.tagWorkBlock=function(e){-1===this._tags.indexOf(e)&&(this._tags=a([e],this._tags))},e.prototype.addKeyPerformanceIndicator=function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=null),this._queuedKPIs.push({name:e,parameters:t,retroactiveTimestamp:null!=n?n:performance.now()})},e.prototype.addKeyPerformanceIndicatorOnIdle=function(e,t){var n=this;void 0===t&&(t=null);var r=performance.now();this.onNextIdleProcessing((function(a){t||(t={}),t.TimeSinceIdle=(r-a.workBlockStartTime).toFixed().toString(),n.addKeyPerformanceIndicator(e,t,a.workBlockEndTime),n._queuedKPIs[n._queuedKPIs.length-1].workBlockKpi=!0,n._workBlockKPICount++}))},e.prototype.enableOptionalComponents=function(){null===this._aggregationTransport&&(this._aggregationTransport=new c.AggregationTransport,s.default.registerTransport(this._aggregationTransport))},e.prototype.addCommonKpiParameters=function(e,t){!0===t?this._workBlockKpiParameters=Object.assign({},this._workBlockKpiParameters,e):this._commonKpiParameters=Object.assign({},this._commonKpiParameters,e)},e.prototype.setCommonTimelineMetadata=function(e){this._commonMetadata=e},e.prototype.addMetadataToTimeline=function(e){this._metadata=Object.assign({},this._metadata,e)},e.prototype.logPerformanceIssue=function(e){e.timestamp=performance.now(),this._workBlockIssues.push(e),m.writeToConsole(e);for(var t=0;t<this._issueListeners.length;t++)this._safelyCallCallback(this._issueListeners[t],e)},e.prototype.subscribeToPerformanceIssues=function(e){this._issueListeners.push(e)},e.prototype._handleAppWorkingEvent=function(e){e.isBoot||(this._visibilityTracker.resetTracking(),this._userInteractionTracker.resetTracking(),this._alertTracker.resetTracking(),this._workBlockIssues=[],this._tags=[],u.clearBrowserResourceTimings(),null!==this._zoneActivityTracker&&this._zoneActivityTracker.reset(),null!==this._aggregationTransport&&this._aggregationTransport.reset()),this._attachPerformanceObserver()},e.prototype._handleAppIdleEvent=function(e){var t,n,r=this;if(y.createMarker(null,e.appWorkingTime),_.createMarker(null,e.appIdleTime),e.isBoot){var a=this._bootInitializers;this._bootInitializers=[],a.forEach((function(e){return r._safelyCallCallback(e)}))}var o=this._visibilityTracker.firstGoneIntoBackgroundTimeSinceLastIdle(),c=this._userInteractionTracker.userInteractions(),l=this._alertTracker.hasAlertedSinceLastIdle(),d={isBoot:e.isBoot,workBlockStartTime:e.appWorkingTime,workBlockEndTime:e.appIdleTime,hasGoneIntoBackground:o>0,hasUserInteracted:Object.keys(c).length>0,hasAlerted:l,issues:this._workBlockIssues};this._workBlockIssues=[],u.processBrowserResourceTimings(),this._processPerformanceObserverEvents();var p=this._idleProcessingCallbacks.slice();this._idleProcessingCallbacks=[],p.forEach((function(e){return r._safelyCallCallback(e,d)}));var f=Object.assign({IsBoot:e.isBoot},this._commonKpiParameters);this._commonKpiParameters=null,null!==this._zoneActivityTracker&&(this._workBlockKpiParameters.ZoneActivity=JSON.stringify(this._zoneActivityTracker.getSummary()));try{for(var g=i(this._queuedKPIs),m=g.next();!m.done;m=g.next()){var b=m.value,v=s.default.createEvent(b.name,"Core.KPI"),S=this._determineLoadQuality(b,o,l,d.issues),O=this._summarizeInteractions(b,c,d.workBlockStartTime),C=Object.assign({LoadQuality:S},b.parameters,f,O);!0===b.workBlockKpi&&Object.assign(C,this._workBlockKpiParameters,{WorkBlockKpi:!0}),this._workBlockKPICount>1&&Object.assign(C,{MultipleWorkBlockKpi:!0}),v.createMarker(C,b.retroactiveTimestamp)}}catch(e){t={error:e}}finally{try{m&&!m.done&&(n=g.return)&&n.call(g)}finally{if(t)throw t.error}}this._workBlockKpiParameters=null,this._queuedKPIs=[],this._workBlockKPICount=0;var E=null;if(null!==this._aggregationTransport){(E=new h.PerformanceTimeline(this._aggregationTransport.getEvents(),Object.assign({},this._commonMetadata,this._metadata,f,{timestamp:(new Date).toString(),windowWidth:window.innerWidth,windowHeight:window.innerHeight}))).setTags(this._tags),this._aggregationTransport.reset(),this._timelineProcessors.forEach((function(e){return r._safelyCallCallback(e,E)}));var I=Object.assign({},d,{timeline:E}),w=this._timelineDataCallbacks.slice();this._timelineDataCallbacks=[],w.forEach((function(e){return r._safelyCallCallback(e,I)}))}var j=Object.assign({},d,{tags:this._tags,timeline:E,issuesFromTimelineProcessing:this._workBlockIssues}),P=this._perfDataCallbacks.slice();this._perfDataCallbacks=[],P.forEach((function(e){return r._safelyCallCallback(e,j)}))},e.prototype.onNextIdleProcessing=function(e){this._idleProcessingCallbacks.push(e)},e.prototype.addTimelineProcessor=function(e){this._timelineProcessors.push(e)},e.prototype.onNextTimelineData=function(e){this._timelineDataCallbacks.push(e)},e.prototype.onNextPerfData=function(e){this._perfDataCallbacks.push(e)},e.prototype.processNextWorkBlock=function(e,t,n){var r=this;return new Promise((function(a){r.onNextIdleProcessing(e),r.onNextTimelineData(t),r.onNextPerfData(n),r.onNextPerfData((function(){return a()}))}))},e.prototype._determineLoadQuality=function(e,t,n,r){var a=0;return t>=0&&t<e.retroactiveTimestamp&&(a|=1),n&&(a|=2),r&&r.forEach((function(t){if(t.timestamp&&t.timestamp<e.retroactiveTimestamp){var n=4<<t.type;a|=n}})),a},e.prototype._summarizeInteractions=function(e,t,n){var r,a,o=n+300,s={},c="",l=Number.MAX_VALUE,u=function(n){t[n].forEach((function(t){o<t&&t<e.retroactiveTimestamp&&(t<l&&(c=n,l=t),s[n]=s[n]?s[n]+1:1)}))};try{for(var d=i(Object.keys(t)),p=d.next();!p.done;p=d.next()){u(p.value)}}catch(e){r={error:e}}finally{try{p&&!p.done&&(a=d.return)&&a.call(d)}finally{if(r)throw r.error}}return c?{FirstInteractionName:c,FirstInteractionTime:l-n,Interactions:s}:{}},e.prototype._safelyCallCallback=function(e,t){try{e.call(null,t)}catch(e){this._rethrowErrors&&setTimeout((function(){throw e}),0)}},e.prototype._handlePerformanceObserverEvents=function(e){e.forEach((function(e){var t;null===(t=S[e.entryType])||void 0===t||t.createRetroactiveStopwatch(e.startTime,e.duration,{name:e.name})}))},e.prototype._attachPerformanceObserver=function(){this._performanceObserver&&this._performanceObserver.observe({entryTypes:v})},e.prototype._processPerformanceObserverEvents=function(){this._performanceObserver&&(this._performanceObserver.takeRecords&&this._handlePerformanceObserverEvents(this._performanceObserver.takeRecords()),this._performanceObserver.disconnect())},e}();t.PerformanceTracker=O;var C=new O(b.default);t.default=C},zJrS:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("504W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class a{constructor(e,t,n,a,i){this.EntityMoniker=e,this.TargetEntityName=t,this.TargetFieldType=n,this.RetrieveConsumableRecord=a,Object(r.a)(i)||(this.SkipParentalRelationshipMapping=i)}getMetadata(){return{boundParameter:null,operationName:"InitializeFrom",operationType:1,parameterTypes:{EntityMoniker:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5},TargetEntityName:{typeName:"Edm.String",structuralProperty:1},TargetFieldType:{typeName:"Microsoft.Dynamics.CRM.TargetFieldType",structuralProperty:3,enumProperties:[,{name:"All",value:0},{name:"ValidForCreate",value:1},{name:"ValidForUpdate",value:2},{name:"ValidForRead",value:3}]},RetrieveConsumableRecord:{typeName:"Edm.Boolean",structuralProperty:1},SkipParentalRelationshipMapping:{typeName:"Edm.Boolean",structuralProperty:1}}}}}},zVFX:function(e,t,n){"use strict";n.d(t,"b",(function(){return F})),n.d(t,"a",(function(){return M})),n.d(t,"d",(function(){return N})),n.d(t,"f",(function(){return A})),n.d(t,"e",(function(){return R})),n.d(t,"c",(function(){return D}));var r=n("BzKn"),a=n("SocB");const i="'Segoe UI Regular', 'SegoeUI', 'Segoe UI'",o="1px dashed black",s=a.d.Blue.Blue3,c=a.d.Clay.Clay3,l=a.d.Black,u=a.d.Blue.Blue7,d=a.d.Blue.Blue8,p=a.d.Purple.Purple6,f=a.d.Purple.Purple7,g=a.d.Blue.Blue3,h={MEASURE015:"0.125rem",MEASURE025:"0.25rem",MEASURE050:"0.5rem",MEASURE075:"0.75rem",MEASURE085:"0.875rem",MEASURE100:"1.00rem",MEASURE115:"1.125rem",MEASURE1143:"1.125rem",MEASURE125:"1.25rem",MEASURE150:"1.50rem",MEASURE175:"1.75rem",MEASURE200:"2.00rem",MEASURE225:"2.25rem",MEASURE250:"2.50rem",MEASURE275:"2.75rem",MEASURE285:"2.875rem",MEASURE300:"3.00rem",MEASURE325:"3.25rem",MEASURE350:"3.50rem",MEASURE375:"3.75rem",MEASURE400:"4.00rem",MEASURE450:"4.50rem",MEASURE500:"5.00rem",MEASURE550:"5.50rem",MEASURE600:"6.00rem",MEASURE675:"6.75rem",MEASURE700:"7.00rem",MEASURE750:"7.50rem",MEASURE775:"7.75rem",MEASURE900:"9.00rem",MEASURE1075:"10.75rem",MEASURE2875:"28.75rem"},m={MEASURE015:"0.142857rem",MEASURE025:"0.285714rem",MEASURE050:"0.5rem",MEASURE075:"0.714286rem",MEASURE085:"0.857142rem",MEASURE100:"1.00rem",MEASURE115:"1.143rem",MEASURE1143:"1.143rem",MEASURE125:"1.285714rem",MEASURE150:"1.50rem",MEASURE175:"1.714286rem",MEASURE200:"2.00rem",MEASURE225:"2.285714rem",MEASURE250:"2.50rem",MEASURE275:"2.714286rem",MEASURE285:"2.857142rem",MEASURE300:"3.00rem",MEASURE325:"3.285714rem",MEASURE350:"3.50rem",MEASURE375:"3.714286rem",MEASURE400:"4.00rem",MEASURE450:"4.50rem",MEASURE500:"5.00rem",MEASURE550:"5.50rem",MEASURE600:"6.00rem",MEASURE675:"6.714286rem",MEASURE700:"7.00rem",MEASURE750:"7.50rem",MEASURE775:"7.714286rem",MEASURE900:"9.00rem",MEASURE1075:"10.714286rem",MEASURE2875:"28.714286rem"};let b={MEASURE015:"0.15rem",MEASURE025:"0.25rem",MEASURE050:"0.5rem",MEASURE075:"0.75rem",MEASURE085:"0.85rem",MEASURE100:"1.00rem",MEASURE115:"1.15rem",MEASURE1143:"1.143rem",MEASURE125:"1.25rem",MEASURE150:"1.50rem",MEASURE175:"1.75rem",MEASURE200:"2.00rem",MEASURE225:"2.25rem",MEASURE250:"2.50rem",MEASURE275:"2.75rem",MEASURE285:"2.85rem",MEASURE300:"3.00rem",MEASURE325:"3.25rem",MEASURE350:"3.50rem",MEASURE375:"3.75rem",MEASURE400:"4.00rem",MEASURE450:"4.50rem",MEASURE500:"5.00rem",MEASURE550:"5.50rem",MEASURE600:"6.00rem",MEASURE675:"6.75rem",MEASURE700:"7.00rem",MEASURE750:"7.50rem",MEASURE775:"7.75rem",MEASURE900:"9.00rem",MEASURE1075:"10.75rem",MEASURE2875:"28.75rem"};const y=200,_=300,v=400,S=600,O=700,C={FontXS:"0.7142857rem",FontS:"0.8571428rem",FontB:"1rem",FontM:"1rem",FontL:"1.2142857rem",FontXL:"1.5rem",Font065:"0.642857rem",Font075:"0.7142857rem",Font085:"0.8571428rem",Font100:"1.00rem",Font1143:"1.143rem",Font115:"1.143rem",Font125:"1.2142857rem",Font150:"1.50rem",Font175:"1.785714rem",Font200:"2.00rem",Font225:"2.2857143rem",Font10px:"0.7142857rem",Font12px:"0.8571428rem",Font14px:"1rem",Font16px:"1.143rem",Font18px:"1.2857143rem",Font20px:"1.4285714rem",Font21px:"1.5rem",Font24px:"1.7142857rem",Font28px:"2.00rem",Font32px:"2.2857143rem",SiteMapOfflineStatusIcon:"1.00rem",TextBox:{FontIcon:"1.00rem",Font:"1.00rem",ErrorFont:"0.92857rem",FontWeight:400,ContentFontWeight:600}},E={FontXS:"0.750rem",FontS:"0.875rem",FontB:"1rem",FontM:"1rem",FontL:"1.25rem",FontXL:"1.5rem",Font065:"0.625rem",Font075:"0.75rem",Font085:"0.875rem",Font100:"1.00rem",Font1143:"1.125rem",Font115:"1.125rem",Font125:"1.25rem",Font150:"1.50rem",Font175:"1.75rem",Font200:"2.00rem",Font225:"2.25rem",Font10px:"0.625rem",Font12px:"0.75rem",Font14px:"0.875rem",Font16px:"1.00rem",Font18px:"1.124rem",Font20px:"1.25rem",Font21px:"1.3125rem",Font24px:"1.5rem",Font28px:"1.75rem",Font32px:"2.00rem",SiteMapOfflineStatusIcon:"1.00rem",TextBox:{FontIcon:"1.00rem",Font:"1.00rem",ErrorFont:"0.875rem",FontWeight:400,ContentFontWeight:600}};let I={FontXS:"0.750rem",FontS:"0.875rem",FontB:"1rem",FontM:"1rem",FontL:"1.25rem",FontXL:"1.5rem",Font065:"0.65rem",Font075:"0.75rem",Font085:"0.85rem",Font100:"1.00rem",Font1143:"1.143rem",Font115:"1.15rem",Font125:"1.25rem",Font150:"1.50rem",Font175:"1.75rem",Font200:"2.00rem",Font225:"2.25rem",Font10px:"0.7142857rem",Font12px:"0.8571428rem",Font14px:"1rem",Font16px:"1.143rem",Font18px:"1.2857143rem",Font20px:"1.4285714rem",Font21px:"1.5rem",Font24px:"1.7142857rem",Font28px:"2.00rem",Font32px:"2.2857143rem",SiteMapOfflineStatusIcon:"1.00rem",TextBox:{FontIcon:"1.00rem",Font:"1.00rem",ErrorFont:"0.9rem",FontWeight:400,ContentFontWeight:600}},w=l,j=Object(a.g)(l,a.c),P="1px solid "+a.d.Grey.Grey5,T="0.857em";function N(){b=h,I=E,M=x()}function A(){b=m,I=C,M=x()}function R(e){w=e?u:p,j=e?Object(a.f)(d):Object(a.f)(f),P="none",T=0,M=x()}function D(e){const t=e.Colors;a.d.Blue.Blue3=t.Palette.Primary01,a.d.Blue.Blue5=t.Palette.Primary04,a.d.Grey.Grey1=t.Palette.Neutral03,a.d.Grey.Grey3=t.Palette.Neutral06,a.d.Grey.Grey5=t.Palette.Neutral12,a.d.Grey.Grey6="#484644",a.d.Grey.Grey7=t.Palette.Neutral13,a.d.Clay.Clay3=t.Palette.Primary01,M=x(),M.colors.TextBox.Red=t.Palette.Error01}function x(){return{fontSizes:{Normal:"13px",Small:"10px",RecordSetNavigatorItem:"1.2em",QuickLaunchBarIcon:"16px",FontXS:I.FontXS,FontS:I.FontS,FontB:I.FontB,FontM:I.FontM,FontL:I.FontL,FontXL:I.FontXL,Font065:I.Font065,Font075:I.Font075,Font085:I.Font085,Font100:I.Font100,Font1143:I.Font1143,Font115:I.Font115,Font125:I.Font125,Font150:I.Font150,Font175:I.Font175,Font200:I.Font200,Font225:I.Font225,Font10px:I.Font10px,Font12px:I.Font12px,Font14px:I.Font14px,Font16px:I.Font16px,Font18px:I.Font18px,Font20px:I.Font20px,Font21px:I.Font21px,Font24px:I.Font24px,Font28px:I.Font28px,Font32px:I.Font32px,SiteMapOfflineStatusIcon:I.SiteMapOfflineStatusIcon,TextBox:I.TextBox,Header:{Header1:"2.5em",Header2:"1.875em",Header3:"1.0em",Header4:"0.587em",Header5:"0.354em"},Dialog:{TitleFontSize:"21px",SubtitleFontSize:"14px",TextFontSize:"14px"}},colors:{Highlight:"#F7EE7F",FocusHighlight:"#F26158",NormalText:"#F26197",HeaderText:"#F26151",Section:"#F26157",Column:"#D26057",Page:"#F20057",QuickLaunchBar:a.d.Grey.Grey7,QuickLaunchBarHover:a.d.Grey.Grey5,EntityIcon:a.d.White,EntityLabel:a.d.White,QuickLaunchBarIcon:a.d.White,QuickLaunchBarButtonBorderColor:a.d.Teal.Teal2,ProcessControl:"#D24726",SectionBorder:"#CFCDCC",LookupTagBackground:"#ECF4FA",WhiteBackground:a.d.White,SemanticZoomOverlayBackground:"rgba(0,0,0,0.2)",SemanticZoomTileBackground:"grey",QuickCreateFormButtonBackgroundColor:"transparent",QuickCreateFormButtonWidth:"40%",FormHeaderBackgroundColor:"#ffffff",SemanticZoomHighlightedItemColor:"orange",SiteMap:{Default:a.d.Grey.Grey7,RefreshedDefault:a.d.Grey.Grey1,GroupText:a.d.Teal.Teal2,RefreshedGroupText:a.d.Grey.Grey7,RefreshedPinUnpinFill:a.d.Grey.Grey3,CollapsedGroupSeparator:a.d.Grey.Grey3,AreaBar:a.d.Grey.Grey6,AreaBarItemText:a.d.White,AreaBarItemIcon:a.d.White,RefreshedBarItemIcon:a.d.Grey.Grey7,AreaBarItemActive:a.d.Grey.Grey5,SubAreaItemActive:a.d.Grey.Grey5,AppLauncherBar:a.d.Grey.Grey6,AppLauncherBorder:a.d.Teal.Teal2,AreaItemBorder:a.d.Teal.Teal2,AppLauncherText:a.d.White,EntityOfflineStatusIcon:{Disabled:a.d.Red.Red2,Enabled:a.d.Green.Green2},DWaffle:{Text:a.d.White,Fill:a.d.Teal.Teal2},NavigationBarMobile:{Text:a.d.Grey.Grey6,Fill:a.d.Grey.Grey3},NavigationBarMobileActive:{Text:a.d.White,Fill:a.d.Grey.Grey5},NavigationItem:{Text:a.d.White,Fill:a.d.Grey.Grey6},NavigationTitle:{Text:a.d.Teal.Teal2,Fill:a.d.Transparent},NavigationShelf:{Text:a.d.White,Fill:a.d.Grey.Grey6,Stroke:a.d.Teal.Teal2},NavBarAppButton:{Text:Object(a.e)("#1ab7c2"),Fill:"#1ab7c2"},NavBarAreaIcon:{Text:Object(a.e)("#EEEEEE"),Fill:"#EEEEEE"},RefreshedRow:{Text:a.d.Grey.Grey7,Fill:a.d.White}},BaseColor:a.d,FormFooter:{PrimaryButtonBackground:"rgba(22, 155, 213, 1)"},TextBox:{Label:"#444444",Content:"#000000",Line:"#DDDDDD",HoverBox:a.d.Grey.Grey5,Background:a.d.White,ErrorBackground:a.d.White,Red:"#EA0600",Blue:"#0000FF",RestMode:"#FFFFFF"},Dialog:{Border:"#EAEAEA",CloseIconBackground:"transparent",HeaderFont:"#333333",PrimaryButtonBackground:"rgba(22, 155, 213, 1)",DefaultButtonBackground:"rgba(255, 255, 255, 1)",DefaultButtonBorder:"rgba(204, 204, 204, 1)",PrimaryButtonText:"white",BackgroundShadow:"rgba(0, 0, 0, 0.5)"},AppShell:{Selected:"#0063B1",NotSelected:"#616161",SetupButtonContainerBorder:"#BDC3C7",SetupName:"#F1F1F1",AdvancedSetupSummaryStyle:"#4A4A4A",AdvancedSettingBackgroundColor:"#696969",AdvancedSettingScrollbarColor:"#555555",NotificationIconError:"#C3574B",NotificationIconSuccess:"#4BDA11",NotificationIconInformation:"#2BB2F5",NotificationIconAttention:"#616161",NotificationViewError:"#F2DEDE",NotificationViewSuccess:"#DFF0D8",NotificationViewInformation:"#D9EDF7",NotificationViewAttention:"#FCF8E3"},Title:{Text:"#F26151",Fill:a.d.Transparent},Entity:{Text:Object(a.e)("#006551"),Fill:"#001CA5"},CustomEntity:{Text:Object(a.e)("#006551"),Fill:"#006551"},Control:{Text:Object(a.e)("#F3F1F1"),Fill:"#F3F1F1",Stroke:"#CCCCCC"},Link:{Normal:{Text:a.d.Blue.Blue3,Fill:a.d.Transparent},Hover:{Text:a.d.Blue.Blue5,Fill:a.d.Transparent},Visited:{Text:a.d.Purple.Purple4,Fill:a.d.Transparent},Pressed:{Text:a.d.Blue.Blue5,Fill:a.d.Transparent},Disabled:{Text:a.d.Grey.Grey5,Fill:a.d.Transparent}},Status:{Alert1:{Fill:a.d.Red.Red4,Text:a.d.White},Alert2:{Fill:a.d.Red.Red2,Text:a.d.Black},Priority1:{Fill:a.d.Orange.Orange4,Text:a.d.White},Priority2:{Fill:a.d.Orange.Orange3,Text:a.d.Black},Priority3:{Fill:a.d.Yellow.Yellow3,Text:a.d.Black},Positive1:{Fill:a.d.Green.Green4,Text:a.d.White},Positive2:{Fill:a.d.Green.Green3,Text:a.d.Black},Info1:{Fill:a.d.Blue.Blue3,Text:a.d.White},Neutral1:{Fill:a.d.Grey.Grey5,Text:a.d.White}},AccentThemeColor:{Accent1:Object(a.f)(c),Accent2:Object(a.g)(c,a.a),Accent3:Object(a.h)(c)},MainThemeColor:{MainColor1:Object(a.f)(s),MainColor2:Object(a.g)(s,a.c),MainColor3:Object(a.h)(s)},PageHeader:{Text:"",Fill:""},PagePanel:{Text:"",Fill:""},DefaultSurface:{Text:a.d.Black,Fill:a.d.White},NavBar:{NavBar1:Object(a.f)(w),NavBar2:j,NavBar3:Object(a.h)(w)}},sizes:{NavbarHeight:"3.43rem",NavButtonHeight:b.MEASURE300,NavBarHeightMobile:b.MEASURE300,EntityLabelMarginLeft:"15px",ControlPadding:"5px",SectionBorderWidth:"2px",TabBorderWidth:"3px",SmallMargin:"7px",SmallPadding:"5px",RecordSetNavigator:{listItemHeight:"6.00rem",listItemLineHeight:"1.40rem",listItemTextMaxWidth:"9.375rem",entityImageMarginTop:"1.50rem",recordNameAttributeWrapperMaxWidth:"14.79rem",recordPrimaryNameMaxHeight:"2.80rem",width:"19.29rem"},EditForm:{MainSectionPadding:"15px",TabHeaderBodyContainerMargin:"0.5%",TabPlaceholdRowHeightEm:3,TabListItemMaxWidth:"30ch",ScrollableTabListItemMaxWidth:"66vw",TabListItemMargin:"20px",ScrollableTabListItemPadding:"16px"},QuickCreateForm:{CancelButtonPadding:"0.625rem",ButtonMinWidth:"6em",ButtonMaxWidth:"25em"},LookupControl:{TagPadding:"6px",TagMargin:"-5px"},Dialog:{Width:"30rem",Height:"20rem",AlertHeight:"14rem",MobileModeSize:480,GeneralMargin:"30px",ContentContainerMargin:"30px 30px 0 30px",BorderWidth:"1px",CloseIconSize:"32px",ButtonHeight:"32px",ButtonWidth:"75px",ButtonMargin:"26px",DefaultButtonBorderWidth:"1px",TitleLineHeight:"28px",SubtitleLineHeight:"19px",TextLineHeight:"19px",ButtonViewWidth:"160px",CloseIconPositionOffsetSmallScreen:"-0.75rem",CloseIconPositionOffsetLargeScreen:"-0.5rem"},TextBox:{Spacing:"0.25em",NotificationIconContainerHeight:"calc(100% - 0.5em)",ContainerSpacing:"0.75em",RightMargin:"2em",LineHeight:"1.5em",LineThickness:"1px",ErrorLineThickness:"2px",HorizontalPadding:"0.5em",VerticalPadding:"0.5em",MaxLength:200},Section:{SectionWidth:340,cellHeightInRem:3.5,CellBreakPointWidth:340},SiteMap:{Width:"19.29em",AreaItemBorder:b.MEASURE025,AppLauncherBorder:"1px",EntityOfflineStatusIconWidth:"2.5rem",RefreshedWidth:"14.286em",RefreshedWidthCollapsed:"3.143em"},QuickLaunchBar:{ButtonBorderSize:b.MEASURE025},HeaderFields:{MinimumCellWidthEm:17,HeaderFieldMarginEm:3,MaximumCellWidth:"17em",ExpandButtonWidthPx:42,ExpandButtonMarginTop:"0.695rem",ExpandButtonMarginTopHeaderCollapsed:"0.3rem",CellContainerSpacerWidthPx:42},FooterFields:{MinimumCellWidthEm:22,MaximumCellWidth:"17em",CellContainerSpacerWidthPx:70},FormHeader:{Height:"9.28rem"},FormFooter:{},Icon:{MinWidth:"16px",MinHeight:"16px",MaxWidth:"32px",MaxHeight:"32px"},Breakpoints:{DimensionXS:340,DimensionS:480,DimensionM:768,DimensionL:1024,DimensionXL:1200},TabNavigator:{SemanticZoomTabListItemWidthInEm:3,OverflowtItemWidthInEm:3},GlobalCommandBarMargin:T,Measures:{Measure015:b.MEASURE015,Measure025:b.MEASURE025,Measure050:b.MEASURE050,Measure075:b.MEASURE075,Measure085:b.MEASURE085,Measure100:b.MEASURE100,Measure115:b.MEASURE115,Measure125:b.MEASURE125,Measure150:b.MEASURE150,Measure175:b.MEASURE175,Measure200:b.MEASURE200,Measure225:b.MEASURE225,Measure250:b.MEASURE250,Measure275:b.MEASURE275,Measure285:b.MEASURE285,Measure300:b.MEASURE300,Measure325:b.MEASURE325,Measure350:b.MEASURE350,Measure400:b.MEASURE400,Measure450:b.MEASURE450,Measure500:b.MEASURE500,Measure550:b.MEASURE550,Measure600:b.MEASURE600,Measure675:b.MEASURE675,Measure700:b.MEASURE700,Measure750:b.MEASURE750,Measure775:b.MEASURE775,Measure900:b.MEASURE900,Measure1075:b.MEASURE1075,Measure1143:b.MEASURE1143,Measure2875:b.MEASURE2875},FontWeights:{Light:y,Semilight:_,Normal:v,Semibold:S,Bold:O},DockablePanel:{PanelWidthS:"3.00rem",PanelWidthM:"16.875rem",PanelWidthL:"20.00rem",PanelWidthXL:"33.75rem"},Flyout:{MaxHeight:"23.75rem"}},fontFamilies:{Normal:"'SegoeUI', 'Segoe UI'",Semilight:"'SegoeUI-Light', 'Segoe UI Semilight', 'Segoe UI Regular', 'Segoe UI'",Semibold:"'SegoeUI-Semibold', 'Segoe UI Semibold', 'Segoe UI Regular', 'Segoe UI'",Weighted:"'Segoe UI'",Regular:i,Bold:"'SegoeUI-Bold', 'Segoe UI Bold', 'Segoe UI'"},display:{SolidBorderStyle:"solid",NoneBorderStyle:"none",PointerCursorStyle:"pointer",DottedBorderStyle:"dotted"},spacings:{HorizXs:"0.5em",HorizS:"0.5em",HorizB:"1em",HorizM:"2em",HorizL:"2.5em",HorizXl:"3.5em",HorizXxl:"4.5em",VertXs:"0.5em",VertS:"0.5em",VertB:"1em",VertM:"2em",VertL:"2.5em",VertXl:"3.5em",VertXxl:"4.5em"},shadows:{Shadow01:"0px 2px 4px 0px rgba(0, 0, 0, 0.5);",Shadow01Height:"4px",Shadow02:"0px 4px 8px rgba(0,0,0,0.1);"},borders:{Border01:"1px solid "+a.d.Grey.Grey1,Border02:"1px solid "+a.d.Grey.Grey3,Border03:o,Border04:P,Border05:"1px dashed "+Object(a.e)(g),Border06:"2px solid #0066FF",Border06Radius:"22px"},buttons:{Button01Primary:{borderColor:"transparent",backgroundColor:Object(a.f)(s).Fill,color:Object(a.f)(s).Text,height:b.MEASURE250,minWidth:b.MEASURE600,cursor:"pointer",justifyContent:"center",alignItems:"center",paddingLeft:b.MEASURE100,paddingRight:b.MEASURE100,"> span":{color:Object(a.f)(s).Text},":focus":{outline:o},":hover":{backgroundColor:Object(a.h)(s).Fill,color:Object(a.h)(s).Text,"-webkit-transition":"background 200ms linear",transition:"background 200ms linear",":disabled":{"> span":{color:a.d.Grey.Grey1}}},":active":{color:Object(a.h)(s).Text,backgroundColor:Object(a.h)(s).Fill,outline:"1px solid "+Object(a.h)(s).Fill,border:"1px solid white",":disabled":{outline:0,border:"1px solid transparent"}},":disabled":{backgroundColor:a.d.Grey.Grey1,cursor:"not-allowed","> span":{color:a.d.Grey.Grey5}}},Button01Secondary:{border:"1px solid "+Object(a.f)(s).Fill,backgroundColor:a.d.White,height:b.MEASURE250,minWidth:b.MEASURE600,cursor:"pointer",justifyContent:"center",alignItems:"center",paddingLeft:b.MEASURE100,paddingRight:b.MEASURE100,"> span":{color:Object(a.f)(s).Fill},":focus":{outline:o},":hover":{backgroundColor:Object(a.h)(s).Fill,borderColor:"transparent","> span":{color:Object(a.h)(s).Text},":disabled":{"> span":{color:a.d.Grey.Grey1}},"-webkit-transition":"background 200ms linear",transition:"background 200ms linear"},":active":{backgroundColor:Object(a.h)(s).Fill,outline:"1px solid "+Object(a.h)(s).Fill,border:"1px solid white",borderColor:"transparent","> span":{color:Object(a.h)(s).Text},":disabled":{outline:0,border:"1px solid transparent"}},":disabled":{backgroundColor:a.d.Grey.Grey1,cursor:"not-allowed",borderColor:"transparent","> span":{color:a.d.Grey.Grey5}}},ButtonPrimaryText:{fontSize:b.MEASURE100,fontFamily:i,color:a.d.White,textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"},ButtonSecondaryText:{fontSize:b.MEASURE100,fontFamily:i,color:Object(a.f)(s).Fill,textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"},ActionIconButton01:{height:b.MEASURE250,width:b.MEASURE250,borderStyle:"none",backgroundColor:"transparent",justifyContent:"center",alignItems:"center",cursor:"pointer","> span":{fontSize:b.MEASURE100,color:a.d.Grey.Grey7},":focus":{outline:o},":hover":{backgroundColor:a.d.Grey.Grey1},":disabled":{cursor:"not-allowed","> span":{color:a.d.Grey.Grey4}}},Button02Primary:{borderWidth:0,borderColor:"transparent",backgroundColor:Object(a.f)(s).Fill,color:Object(a.f)(s).Text,height:b.MEASURE150,minWidth:b.MEASURE400,cursor:"pointer",justifyContent:"center",alignItems:"center",paddingLeft:b.MEASURE050,paddingRight:b.MEASURE050,paddingTop:0,paddingBottom:0,":focus":{outline:o},":hover":{backgroundColor:Object(a.h)(s).Fill,color:Object(a.h)(s).Text,"-webkit-transition":"background 200ms linear",transition:"background 200ms linear"},":active":{color:Object(a.h)(s).Text,backgroundColor:Object(a.h)(s).Fill,outline:"1px solid "+Object(a.h)(s).Fill,border:"1px solid white",":disabled":{outline:0,border:"1px solid transparent"}},":disabled":{backgroundColor:a.d.Grey.Grey1,cursor:"not-allowed","> span":{color:a.d.Grey.Grey5}}},Button02Secondary:{border:"1px solid "+Object(a.f)(s).Fill,backgroundColor:a.d.White,height:b.MEASURE150,minWidth:b.MEASURE400,cursor:"pointer",justifyContent:"center",alignItems:"center",paddingLeft:b.MEASURE050,paddingRight:b.MEASURE050,paddingTop:0,paddingBottom:0,"> span":{color:Object(a.f)(s).Fill},":focus":{outline:o},":hover":{backgroundColor:Object(a.h)(s).Fill,borderColor:"transparent","> span":{color:Object(a.h)(s).Text},":disabled":{"> span":{color:a.d.Grey.Grey1}},"-webkit-transition":"background 200ms linear",transition:"background 200ms linear"},":active":{backgroundColor:Object(a.h)(s).Fill,outline:"1px solid "+Object(a.h)(s).Fill,border:"1px solid white",borderColor:"transparent","> span":{color:Object(a.h)(s).Text},":disabled":{outline:0,border:"1px solid transparent"}},":disabled":{backgroundColor:a.d.Grey.Grey1,cursor:"not-allowed",borderColor:"transparent","> span":{color:a.d.Grey.Grey5}}},Button03Primary:{borderWidth:0,borderColor:"transparent",height:b.MEASURE200,minWidth:"9.93em",justifyContent:"center",alignItems:"center",paddingTop:0,paddingBottom:0,borderRadius:"3px","> span":{color:"#F2F2F2",fontSize:b.MEASURE100,lineHeight:"1.21rem",fontFamily:i,textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"}}},links:{TouchTarget:{height:b.MEASURE200,fontSize:b.MEASURE100,fontFamily:i,color:a.d.Blue.Blue3},Reset:{height:b.MEASURE200,fontSize:b.MEASURE100,fontFamily:i,color:a.d.Blue.Blue3},Focus:{height:b.MEASURE200,fontSize:b.MEASURE100,fontFamily:i,color:a.d.Blue.Blue3,border:o},Hover:{height:b.MEASURE200,fontSize:b.MEASURE100,fontFamily:i,color:a.d.Blue.Blue3,cursor:"pointer",textDecoration:"underline"},Pressed:{height:b.MEASURE200,fontSize:b.MEASURE100,fontFamily:i,color:a.d.Blue.Blue5,cursor:"pointer",textDecoration:"underline"},Visited:{height:b.MEASURE200,fontSize:b.MEASURE100,fontFamily:i,color:a.d.Blue.Blue5}}}}let M=x();function F(e=M,t){switch(t.type){case r.a:return function e(t,n=null){if(null===t||"object"!=typeof t)return t;if(t.constructor!==Object&&t.constructor!==Array)return t;if(t.constructor===Date||t.constructor===RegExp||t.constructor===Function||t.constructor===String||t.constructor===Number||t.constructor===Boolean)return new t.constructor(t);n=n||new t.constructor;for(const r in t)n[r]=void 0===n[r]?e(t[r],null):n[r];return n}(e,t.payload);default:return e}}},zW2f:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("rWW8"),a=n("504W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
let i=null;class o extends r.a{constructor(){super(r.a.unknown,r.a.unknown)}RequestId(){return this.requestId}toString(){return"["+r.a.unknown+"]"}static get_instance(){return Object(a.a)(i)&&(i=new o),i}}},zWTC:function(e,t,n){"use strict";e.exports=n("ZkVb")},zh0k:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return c})),n.d(t,"c",(function(){return s}));var r=n("dpM5"),a=n("zhw7");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function i(e,t){return e[t]}function o(e,t,n){return function(e,t,n){if(!t||0===t.length||"i"===t)return n&&n.name.length>0?e.toLocaleString():e.toString();const r=["n %","n%","%n"],a=["-n %","-n%","-%n"],o=["(n)","-n","- n","n-","n -"],l=["$n","n$","$ n","n $"],u=["($n)","-$n","$-n","$n-","(n$)","-n$","n-$","n$-","-n $","-$ n","n $-","$ n-","$ -n","n- $","($ n)","(n $)"],d=n.numberFormat;let p=Math.abs(e).toString();t||(t="D");let f,g=-1;switch(t.length>1&&(g=parseInt(t.slice(1),10)),t.charAt(0)){case"d":case"D":f="n",p=Math.abs(Math.floor(e)).toString(),-1!==g&&(p=s(""+p,g,!0)),e<0&&(p=(-p).toString());break;case"f":case"F":f=e<0?o[i(d,"NumberNegativePattern")]:"n",-1===g&&(g=i(d,"NumberDecimalDigits")),p=c(+Math.abs(e).toFixed(g),g,i(d,"NumberGroupSizes"),i(d,"NumberGroupSeparator"),i(d,"NumberDecimalSeparator"));break;case"c":case"C":f=e<0?u[i(d,"CurrencyNegativePattern")]:l[i(d,"CurrencyPositivePattern")],-1===g&&(g=i(d,"CurrencyDecimalDigits")),p=c(Math.abs(e),g,i(d,"CurrencyGroupSizes"),i(d,"CurrencyGroupSeparator"),i(d,"CurrencyDecimalSeparator"));break;case"n":case"N":f=e<0?o[i(d,"NumberNegativePattern")]:"n",-1===g&&(g=i(d,"NumberDecimalDigits")),p=c(Math.abs(e),g,i(d,"NumberGroupSizes"),i(d,"NumberGroupSeparator"),i(d,"NumberDecimalSeparator"));break;case"p":case"P":f=e<0?a[i(d,"PercentNegativePattern")]:r[i(d,"PercentPositivePattern")],-1===g&&(g=i(d,"PercentDecimalDigits")),p=c(100*Math.abs(e),g,i(d,"PercentGroupSizes"),i(d,"PercentGroupSeparator"),i(d,"PercentDecimalSeparator"));break;default:throw Error("Sys.Res.formatBadFormatSpecifier")}const h=/n|\$|-|%/g;let m="";for(;;){const e=h.lastIndex,t=h.exec(f);if(m+=f.slice(e,t?t.index:f.length),!t)break;switch(t[0]){case"n":m+=p;break;case"$":m+=i(d,"CurrencySymbol");break;case"-":/[1-9]/.test(p)&&(m+=i(d,"NegativeSign"));break;case"%":m+=i(d,"PercentSymbol");break;default:throw Error("Invalid number format pattern")}}return m}(e,t,n)}function s(e,t,n){for(let r=e.length;r<t;r++)e=n?"0"+e:e+"0";return e}function c(e,t,n,i,o){let c,l=n[0],u=1;if(Object(a.a)(r.y)){let n=Object(a.b)();"object"==typeof n&&(n=n.Big);let r=new n(e);r=r.round(t,n.roundHalfUp),c=r.toString()}else{const n=Math.pow(10,t);let r=Math.round(e*n)/n;isFinite(r)||(r=e),c=(e=r).toString()}let d,p="",f=c.split(/e/i);c=f[0],d=f.length>1?parseInt(f[1],10):0,f=c.split("."),c=f[0],p=f.length>1?f[1]:"",d>0?(p=s(p,d,!1),c+=p.slice(0,d),p=p.substr(d)):d<0&&(d=-d,c=s(c,d+1,!0),p=c.slice(-d,c.length)+p,c=c.slice(0,-d)),t>0?(p=p.length>t?p.slice(0,t):s(p,t,!1),p=o+p):p="";let g=c.length-1,h="";for(;g>=0;){if(0===l||l>g)return h.length>0?c.slice(0,g+1)+i+h+p:c.slice(0,g+1)+p;h=h.length>0?c.slice(g-l+1,g+1)+i+h:c.slice(g-l+1,g+1),g-=l,u<n.length&&(l=n[u],u++)}return c.slice(0,g+1)+i+h+p}},zhw7:function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return c}));var r=n("Lyxw");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let a=null,i=null;function o(e,t){a=e,i=t}function s(){return i}function c(e){return Object(r.f)(a.getState(),e)}},zipJ:function(e,t,n){"use strict";n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return p}));var r=n("b02z"),a=n("n48k"),i=n("YxC/"),o=n("09gH"),s=n("7kVW"),c=n("/A0C"),l=n("Xd5/");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function u(e){if("string"==typeof e||"number"==typeof e){const t=Number(e);return!isNaN(t)}return!1}function d(e){if("string"==typeof e||"number"==typeof e){const t=Number(e);return!isNaN(t)&&t>=0}return!1}function p(e,t,n){let d=null;const p=e.Type===c.a.Money?Object(i.c)(t,o.a):Object(i.c)(t,o.m),f=n?Object(l.y)(e.MinValue,n,t):e.MinValue,g=n?Object(l.y)(e.MaxValue,n,t):e.MaxValue;switch(e.Type){case"integer":case"decimal":case"double":case"money":Object(s.b)(e)||(d=void 0!==e.MinValue&&null!==e.MinValue&&void 0!==e.MaxValue&&null!==e.MaxValue?Object(r.a)(u,a.a[a.a.Number],String.format(p,f,g)):null)}return d}},zjrO:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n("8o18"),a=n("504W");class i{constructor(e,t){this._sortByField=null,this._sortDescending=!1,this._sortByField=e,this._sortDescending=!Object(a.a)(t)&&t}get_sortByField(){return this._sortByField}get_sortDescending(){return this._sortDescending}set_sortDescending(e){return this._sortDescending=e,e}toString(){return this._sortByField+"="+this._sortDescending}getObjectData(){const e={};return e.sortbyfield=this._sortByField,e.sortdescending=this._sortDescending,e}static createFromObjectData(e){const t=e.sortbyfield,n=e.sortdescending;return new i(t,n)}}class o{constructor(e){if(this._sorters=null,this._sorters=[],!Object(a.a)(e))for(let t=0;t<e.length;t++)this.addSorterItem(i.createFromObjectData(e[t]))}get_Sorters(){return this._sorters}updateSorter(e,t){const n=new i(e,t);for(const e of this._sorters)if(e.get_sortByField()===n.get_sortByField())return e.get_sortDescending()!==n.get_sortDescending()&&e.set_sortDescending(n.get_sortDescending()),!0;return!1}addSorter(e,t){Object(a.b)(e)||this.addSorterItem(new i(e,t))}addSorterItem(e){this.updateSorter(e.get_sortByField(),e.get_sortDescending())||this._sorters.push(e)}getObjectData(){const e={};return e.sorters=this._sorters,e}static createFromFetchXml(e){var t,n,r;const i=new o,s=e.getElementsByTagName("order");for(let e=0;e<s.length;e++){const o=s[e].attributes.getNamedItem("attribute");if(!Object(a.a)(o)){let c=o.nodeValue;if("link-entity"===(null===(n=null===(t=s[e])||void 0===t?void 0:t.parentElement)||void 0===n?void 0:n.nodeName)){const t=null===(r=s[e].parentElement.attributes.getNamedItem("alias"))||void 0===r?void 0:r.nodeValue;c=t?t+"."+c:void 0}const l=s[e].attributes.getNamedItem("descending"),u=!Object(a.a)(l)&&"true"===l.nodeValue;i.addSorter(c,u)}}return i.get_Sorters().length?i:null}}var s=n("8tWD"),c=n("b2mI"),l=n("jPIj"),u=n("eruq"),d=n("qCX6"),p=n("/A0C"),f=n("TFb5"),g=n("s/8p");class h extends r.a{constructor(e,t){super(e,t),this._sortingInfo=null,this._metadataCache=null,this._relationshipCondition="",this._contextFilter="",this._filter=""}get_SortingInfo(){return Object(a.a)(this._sortingInfo)&&(this._sortingInfo=new o),this._sortingInfo}get_key(){return Object(a.b)(this.get_OverrideKey())?super.get_key()+","+this._relationshipCondition+","+this._contextId+","+this._contextFilter+","+this._filter:this.get_OverrideKey()}setContextFilterAndExtraConditions(e,t,n,r,i,o){const c=this.rawFetchXmlDoc.getElementsByTagName("entity")[0],p=c.attributes.getNamedItem("name").nodeValue;let g=this.get_DescriptorSet().tryGetDescriptor(s.a.Sql);if(this._metadataCache=o,!Object(a.b)(e)&&!Object(a.b)(t)){const n=Object(u.b)(t),r=n.getElementsByTagName("condition")[0];Object(a.a)(r)||(r.attributes.setNamedItem(l.a.createAttribute(n,"value",e)),!Object(a.b)(g)&&d.a.get_instance().get_offlineDataSource().isEntityAvailableForOfflineUsage(n.getElementsByTagName("link-entity")[0].attributes.getNamedItem("name").nodeValue)&&(g=this.updateSqlWithJoinClauseFromContextFilter(p,g,n,r,e))),Object(a.a)(c)||c.appendChild(n.firstChild),this._contextFilter=t,this._contextId=e}if(!Object(a.b)(n)){const e=Object(u.b)(n);Object(a.a)(c)||(g=this.getSqlForQueryFilters(e,g,o,p),c.appendChild(e.firstChild)),this._filter=n}if(!Object(a.b)(r)){const e=Object(u.b)(r);Object(a.a)(c)||(Object(a.b)(g)||(g=this.updateSqlWithWhereClauseFromRelationshipCondition(p,g,e)),c.appendChild(e.firstChild)),this._relationshipCondition=r}Object(a.b)(i)||Object(f.e)(this.rawFetchXmlDoc,i),Object(a.b)(g)||this.get_DescriptorSet().updateDescriptorSet(s.a.Sql,g)}setExtraAttributes(e){Object(f.b)(this.rawFetchXmlDoc,e)}setSortingInfo(e,t){const n=this.rawFetchXmlDoc,r=n.getElementsByTagName("order"),i=[];let s=null;if(!Object(a.a)(e)&&e.get_Sorters().length>0){for(;r.length;){const e=r[0];e.parentNode.removeChild(e)}for(const t of e.get_Sorters())Object(a.a)(e)||Object(a.b)(t.get_sortByField())||(t.get_sortByField().indexOf(".")>-1?this._SortLinkEntityAttribute(n,t)&&i.push(t):n.getElementsByTagName("entity")[0].appendChild(Object(f.l)(n,t.get_sortByField(),t.get_sortDescending())));this._sortingInfo=e}else{const e=o.createFromFetchXml(n);this._sortingInfo=e}if(s=this.get_RawSql(),!Object(a.b)(s)){const e=s.toUpperCase().lastIndexOf("ORDER BY"),n=s.lastIndexOf(g.e);let r=s;-1!==n&&s.length>n+g.e.length?r=s.substr(0,n+g.e.length):-1!==e&&(r=s.substr(0,e));let a="";for(const e of this._sortingInfo.get_Sorters()){a.length>0&&(a+=', "');let n=this.get_EntityLogicalName()+"0",r=this._GetSortByPhysicalAttributeForOffline(t,this.get_EntityLogicalName(),e.get_sortByField());if(i.indexOf(e)>=0){const t=e.get_sortByField().split(".");n=t[0],r=t[1]}a+=n+'".'+r+(e.get_sortDescending()?" DESC":" ASC")}s=`${r} ORDER BY "${a}`,-1!==n&&(s+=" "+g.d)}Object(a.b)(s)||this.set_RawSql(s)}_SortLinkEntityAttribute(e,t){const n=t.get_sortByField().split(".");if(2===n.length){const r=n[0],a=n[1],i=Object(f.n)(e,r,a);if(i)return i.appendChild(Object(f.l)(e,a,t.get_sortDescending())),!0}return!1}addChildCountAttribute(e){Object(f.a)(this.rawFetchXmlDoc,e)}generateNorSyncAttributeName(e,t,n){return Object(c.a)(this._metadataCache,e,t,n)}_GetSortByPhysicalAttributeForOffline(e,t,n){let r=n;if(!Object(a.a)(e)){const i=e.getAttributeMetadata(t,n);Object(a.a)(i)||i.get_type()!==p.a.Lookup&&i.get_type()!==p.a.Customer&&i.get_type()!==p.a.Owner||(r="["+n+"!name]")}return r}getSqlForQueryFilters(e,t,n,r){if(!Object(a.a)(e)&&!Object(a.b)(t)){const a=n.getEntityMetadata(r).get_primaryNameAttribute(),i=n.getEntityMetadata(r).get_primaryIdAttribute();t=this.updateSqlWithWhereClauseFromQueryFilter(r,t,e,a,i)}return t}}},zmAS:function(e,t,n){"use strict";n.r(t),n.d(t,"getUpsyncConfig",(function(){return D})),n.d(t,"OFFLINE_UPSYNC_HANDLE_ACTION",(function(){return N})),n.d(t,"initializeOfflineUpsyncProcessAsyncAction",(function(){return x}));var r=n("6u68"),a=n("TBkx"),i=n("YxC/"),o=n("Nzmy"),s=n("0uKS"),c=n("pgSX"),l=n("tICD"),u=n("EY5k"),d=n("si7p"),p=n("vONk"),f=n("504W");var g=n("wje5"),h=n("VKvO"),m=n("ybGo"),b=n("/D1P"),y=n("umme"),_=n("Lyxw"),v=n("xM/W"),S=n("6fj+"),O=n("fMBw"),C=n.n(O),E=n("SZCI"),I=n("pEXn"),w=n("3/02"),j=n("NjDY"),P=n("a8hT"),T=n("jZCH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const N="offline.upsync.process.async";let A=null;const R=C.a.createEvent("initializeUpsync",E.D);function D(e){return{isConflictDetectionEnabled:Object(j.l)(e)}}function x(e=!1,t=[]){return{type:N,async execute(n,v){const S=Object(m.b)(n.getState()),O=v.TraceManager.getTracer("UpsyncAction");if(t.push({name:"IsForceSync",value:e}),e||S!==b.a.Completed)if(null!=A)O.warn("Upsync promise is pending. ",t),await A;else try{await(A=async function(e,t,n=[]){const m="CompleteUpsyncAction",b=t.TraceManager.getTracer(m),y=R.startStopwatch();let v;b.warn("initializeUpsync: Starting upsync action");try{v=await t.OfflineProvider.hasItemsToUpsync()}catch(e){throw n.push({name:"ErrorDetails",value:e}),b.error("initializeUpsync: hasItemsToUpsync function call Failed",n),t.EventManager.ReportComponentFailure(m,e,null,n),e}if(v){b.warn("initializeUpsync: Starting upsync pipeline because there are Items To Upsync"),e.dispatch(Object(g.b)());try{let r;if(Object(_.f)(e.getState(),w.Pe)){n.push({name:"ModernDataLayerUpsyncFCBEnabled",value:!0});const a=(await Object(P.c)()).MdlProvider.getInstance(T.a.get_DefaultInstance().get_ServerUri(),e,t),i=new((await Object(P.a)()).PlaybackManager)(a.getApplicationContext(),D(e.getState()));r=await i.startPlayback()}else r=await t.OfflineProvider.startPlayback(void 0),n.push({name:"ModernDataLayerUpsyncFCBEnabled",value:!1});e.dispatch(Object(h.b)()),Object(f.a)(r)||0!==r.get_errorCount()?(b.warn("initializeUpsync: Upsync completed with conflict",n),e.dispatch((S=String(r.get_lastSuccessfulSaveOnCrm()),{type:"offline.syncerror.dialog.async",execute({dispatch:e,getState:t},n){const r=["L_Show_Details_Text","Sync_Status_Error_Message","L_Last_Save_To_CRM_Server_Text","Sync_Status_Dialog_Title","Dialog_Button_Ok"];return e(Object(u.e)(r)).then(()=>{const n=Object(i.e)(t(),r),u=Object(i.c)(n,"L_Show_Details_Text"),g=Object(i.c)(n,"Sync_Status_Error_Message"),h=Object(i.c)(n,"L_Last_Save_To_CRM_Server_Text"),m=Object(i.c)(n,"Sync_Status_Dialog_Title"),b=Object(i.c)(n,"Dialog_Button_Ok"),y=g+"\n"+h;let _="";return _=Object(f.b)(p.a.get_OverallSyncErrorMessage())?y.replace("{0}",S):p.a.get_OverallSyncErrorMessage(),e(Object(c.a)(d.c,_,{},u,m,"",b)).then(t=>{if(0===t.status)return e(Object(l.a)(t.pageId)).then(n=>{n.value.confirmed&&e(Object(s.a)("syncerror",t.pageId,null,null,null,null,null))});throw o.c.error("Offline: Error in Sync error dialog creation "+Object(a.f)(t.error)),t.error})}).catch(e=>{throw o.c.error("Offline: Error in Sync error dialog creation "+Object(a.f)(e)),e})}}))):(await M(e),b.warn("initializeUpsync: Upsync completed without conflict",n)),n.push({name:I.b.UpsyncParameters.syncErrorCount,value:r.get_errorCount()}),t.EventManager.ReportComponentSuccess(m,n)}catch(a){throw b.error("initializeUpsync: Upsync Error",n),e.dispatch(Object(r.b)()),t.EventManager.ReportComponentFailure(m,a,null,n),a}finally{y()}return}var S;b.warn("initializeUpsync: Upsync has no items to sync",n),e.dispatch(Object(h.b)()),await M(e)}(n,v,t))}catch(e){if(t.push({name:"ErrorDetails",value:e}),O.error("initializeOfflineUpsyncProcessAsyncAction:initializeUpsync failed. ",t),!(e instanceof y.a)){const t=(null==e?void 0:e.message)||"Unexpected upsync error";e=y.a.FromMessage(t)}throw e}finally{A=null}else O.warn("initializeOfflineUpsyncProcessAsyncAction:Upsync status is completed. Return without doing any upsync",t)}}}async function M(e){if(Object(_.f)(e.getState(),w.v)&&Object(S.e)(e.getState())){const t=["offline_notification_reconnect_success_text"];await e.dispatch(Object(u.e)(t));const r={id:"upsync_complete_toast",level:1,message:Object(i.b)(e.getState(),t[0]),title:null,type:1,onCloseHandler:null};e.dispatch(Object(v.b)(!1));const a=await n.e(93).then(n.bind(null,"bvqZ"));e.dispatch(a.addToastNotification(r))}}},zmL5:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return c}));var r=n("SAYH"),a=n("jq7Z"),i=n("i1f0");function o(e,t){const n=Object(a.a)(e,t);return n?n.formId:r.a.EMPTY}function s(e,t){let n=[t];if(Object(i.Hb)(e,t))return n;const r=c(e,t);return r&&(n=n.concat(r)),n}function c(e,t){var n,r;return(null===(r=null===(n=Object(a.a)(e,t))||void 0===n?void 0:n.formInstances)||void 0===r?void 0:r.list)||[]}},zoUO:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n("FZDd"),a=n("iZ7K"),i=n("SRlt"),o=n("vNXc"),s=n("fU7K"),c=n("g22U");function l(e,t){return{type:"SERIALIZE_FETCHXML_WEB_REQUEST_ASYNC",execute({dispatch:n,getState:l},u){const d=e.get_query(),p=o.a.fromXml(d,null).getKeyQuery(),f=p.get_EntityLogicalName(),g=p.get_ColumnSet();return n(Object(r.f)(f,!1,g.get_Columns(),t)).then(()=>function(e,t,n){return{urlParameters:Object(a.o)(e,t)+"?fetchXml="+Object(s.CrmUrlEncode)(n),method:"GET",additionalHeaders:{Accept:i.a,Prefer:"odata.include-annotations=*"},additionalParameters:{[c.a.TYPE]:c.d.RETRIEVE_MULTIPLE,[c.a.SUB_TYPE]:c.c.RetrieveMultipleOther}}}(l(),f,d))}}}},zsAz:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"g",(function(){return c})),n.d(t,"f",(function(){return l})),n.d(t,"e",(function(){return u})),n.d(t,"h",(function(){return d}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="UciError",a=/\{(\d+)\}/g;function i(e,t,n,a,i,o,s=!1,c={}){const l=new Error(e);return l.name=r,l.errorCode=t,l.errorParameters=n,l.displayTitle=a,l.displayMessage=i,l.blockErrorReporting=s,l.errorAnnotations=c,o&&(l.stack=o),l}function o(e){if(!e){const e=new Error("Received blank error object");return e.name=r,e.errorCode=2147746581,e}const t=new Error(e.message);return t.name=r,t.errorCode=e.errorCode||2147746581,t.errorParameters=e.errorParameters,t.displayTitle=e.displayTitle,t.displayMessage=e.displayMessage,t.blockErrorReporting=e.blockErrorReporting,t.innerError=e.innerError,t.errorAnnotations=e.errorAnnotations,e.stack&&(t.stack=e.stack),t}function s(e,t){e&&t&&(e.errorParameters?e.errorParameters=e.errorParameters.concat(t):e.errorParameters=t)}function c(e){return e&&e.errorCode}function l(e){return null==e?void 0:e.get_ErrorCode}function u(e){let t;return l(e)&&(t=e.get_ErrorFault()),t?t.get_annotations():e.errorAnnotations}function d(e,t){if((null==e?void 0:e.match(a))&&t){const n=u(t);return n?e.replace(a,(e,t)=>{var r;return null!==(r=n["@Microsoft.PowerApps.CDS.ErrorDetails."+t])&&void 0!==r?r:e}):e}return e}},zu1I:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s}));var r=n("FdB0"),a=n("TKDo"),i=n("ruPX");function o(e,t,n,r,a){return{uniqueName:e,entityTypeName:a,data:r,dialogOptions:n}}function s(e,t,n,s){const c=[{name:"dialogName",value:e},{name:"dialogHeight",value:t.height},{name:"dialogWidth",value:t.width},{name:"dialogPosition",value:t.position},{name:"dialogWindowPosition",value:t.windowPosition}];return{type:"form.openDialog",execute:({dispatch:c,getState:l},u,d)=>c(
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t){if(e&&e.dialogOptions&&"inline"===e.dialogOptions.windowPosition)return Object(i.a)(a.a,e,t);return Object(i.a)(r.a,e,t)}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(o(e,l(),t,n),s)),getFailureParameters:(e,t)=>c}}},zwYV:function(e,t,n){"use strict";n.d(t,"e",(function(){return s})),n.d(t,"d",(function(){return o})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"j",(function(){return p})),n.d(t,"i",(function(){return d})),n.d(t,"g",(function(){return u})),n.d(t,"f",(function(){return c})),n.d(t,"h",(function(){return l}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="externalcontext.property.listener.add",a="externalcontext.property.listener.remove",i="externalcontext.properties.intialize",o="externalcontext.descriptors.update",s="externalcontext.property.update";function c(e,t,n){return{type:r,payload:{contextId:e,propertyId:t,listener:n}}}function l(e,t,n){return{type:a,payload:{contextId:e,propertyId:t,listener:n}}}function u(e){return{type:i,payload:e}}function d(e){return{type:o,payload:e}}function p(e){return{type:s,payload:e}}}}),window.bundleExecutionMarkers["scripts/app.js?v=1.4.3886-master"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();