(window.webpackJsonp=window.webpackJsonp||[]).push([[206],{6458:function(e,t,n){"use strict";n.r(t),n.d(t,"flowUpdatesPanelScope",(function(){return f})),n.d(t,"retrieveFlowUpdatesScenario",(function(){return w})),n.d(t,"FlowUpdatesPanel",(function(){return v}));var o=n(4013),a=n(1259),s=n(245),r=n(6459),c=n(2868),i=n(2869),l=n(2879),d=n(217),u=n(6460);function m(){return(m=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}function p(e,t,n,o,a,s,r){try{var c=e[s](r),i=c.value}catch(l){return void n(l)}c.done?t(i):Promise.resolve(i).then(o,a)}var f="powerappsportal/flowUpdatesPanel",w="flowUpdatesPanel/retrieveFlowUpdates",v=e=>{var t=Object(i.getResources)(),[n,w]=Object(s.useState)([]),v=function(){var t,n=(t=function*(){var t=Object(d.trackOtherScenario)(f,u.flowUpdatesMessageBarScope,{objectId:e.objectId});try{var n=yield c.MetadataClientInstance.getInstance().executeOperation("RetrieveFlowUpdates","POST",{},{ObjectId:e.objectId});w(n.value),t.complete()}catch(o){w([]),t.failure({errorCode:o.code,serverErrorCode:o.serverErrorCode,message:o.message})}},function(){var e=this,n=arguments;return new Promise((function(o,a){var s=t.apply(e,n);function r(e){p(s,o,a,r,c,"next",e)}function c(e){p(s,o,a,r,c,"throw",e)}r(void 0)}))});return function(){return n.apply(this,arguments)}}();return Object(s.useEffect)(()=>{v()},[]),s.createElement(o.Panel,m({},e.defaultPanelProps,{type:a.PanelType.large,headerText:t.Model.Solutions.FlowUpdates.Panel.title,onDismiss:e.onDismissPanel,closeButtonType:o.PanelCloseButtonType.Back,closeButtonAriaLabel:t.Common.close}),s.createElement(a.ActionButton,{iconProps:{iconName:l.fabricIcons.Refresh},onClick:()=>{v()}},t.Model.Solutions.FlowUpdates.Panel.refresh),s.createElement(r.FlowUpdatesList,{flowUpdates:n}))}},6459:function(e,t,n){"use strict";n.r(t),n.d(t,"FlowUpdatesList",(function(){return l}));var o,a,s=n(3064),r=n(245),c=n(2869),i=n(2830);!function(e){e.name="name",e.status="status",e.completedOn="completedon",e.message="message"}(o||(o={})),function(e){e[e.commonMin=50]="commonMin",e[e.commonMax=150]="commonMax",e[e.nameMax=350]="nameMax"}(a||(a={}));var l=e=>{var t,n={columns:(t=Object(c.getResources)(),[{key:o.name,name:t.Model.Solutions.FlowUpdates.List.name,fieldName:o.name,minWidth:a.commonMin,maxWidth:a.nameMax,isResizable:!0},{key:o.status,name:t.Model.Solutions.FlowUpdates.List.status,fieldName:o.status,minWidth:a.commonMin,maxWidth:a.commonMax,isResizable:!0},{key:o.completedOn,name:t.Model.Solutions.FlowUpdates.List.completedOn,fieldName:o.completedOn,minWidth:a.commonMin,maxWidth:a.commonMax,isResizable:!0},{key:o.message,name:t.Model.Solutions.FlowUpdates.List.message,fieldName:o.message,minWidth:a.commonMin,isResizable:!0}]),items:d(e.flowUpdates)};return r.createElement(s.DetailsList,n)};function d(e){var t=[];return e?(e.forEach(e=>{t.push({key:e.workflowid,name:e.name,status:u(e.statuscode),completedon:e.statecode===i.AsyncOperationStateCode.Completed&&e.completedon?new Date(e.completedon).toLocaleString():void 0,message:e.statecode===i.AsyncOperationStateCode.Completed&&e.statuscode!==i.AsyncOperationStatusCode.Succeeded?e.message:void 0})}),t):t}function u(e){var t=Object(c.getResources)();switch(e){case i.AsyncOperationStatusCode.Succeeded:return t.Model.Solutions.Components.AsyncOperationStatus.succeeded;case i.AsyncOperationStatusCode.Failed:return t.Model.Solutions.Components.AsyncOperationStatus.failed;case i.AsyncOperationStatusCode.Canceled:return t.Model.Solutions.Components.AsyncOperationStatus.canceled;default:return t.Model.Solutions.Components.AsyncOperationStatus.inProgress}}},6460:function(e,t,n){"use strict";n.r(t),n.d(t,"flowUpdatesMessageBarScope",(function(){return u})),n.d(t,"fetchFCBEnableAsyncModernFlowUpdateScenario",(function(){return m})),n.d(t,"FlowUpdatesMessageBar",(function(){return p}));var o=n(1259),a=n(217),s=n(245),r=n(2868),c=n(2882),i=n(2869),l=n(2880);function d(e,t,n,o,a,s,r){try{var c=e[s](r),i=c.value}catch(l){return void n(l)}c.done?t(i):Promise.resolve(i).then(o,a)}var u="powerappsportal/flowUpdatesMessageBar",m="flowUpdatesMessageBar/fetchFCBEnableAsyncModernFlowUpdate",p=e=>{var[t,n]=Object(s.useState)(!1),p=function(){var e,t=(e=function*(){var e=Object(a.trackOtherScenario)(u,m);try{var t=yield r.MetadataClientInstance.getInstance().executeAction("SdkMessages","GetFeatureEnabledState",void 0,{FeatureName:"FCB.EnableAsyncModernFlowUpdate"});n(t.IsFeatureEnabled),e.complete({IsFeatureEnabled:t.IsFeatureEnabled})}catch(o){n(!1),e.failure({errorCode:o.code,serverErrorCode:o.serverErrorCode,message:o.message})}},function(){var t=this,n=arguments;return new Promise((function(o,a){var s=e.apply(t,n);function r(e){d(s,o,a,r,c,"next",e)}function c(e){d(s,o,a,r,c,"throw",e)}r(void 0)}))});return function(){return t.apply(this,arguments)}}();if(Object(s.useEffect)(()=>{p()},[]),!t)return s.createElement(s.Fragment,null);var f=Object(i.getResources)();return s.createElement(s.Fragment,null,e.objects.map(t=>s.createElement(o.MessageBar,{key:t.objectId,messageBarType:o.MessageBarType.warning,onDismiss:()=>{e.onDismissMessage(t.objectId)}},Object(l.formatResourceString)(f.Model.Solutions.FlowUpdates.MessageBar.message,t.displayName)," ",s.createElement(o.Link,{style:{color:c.fabricColors.communicationBlue},onClick:()=>e.openFlowUpdatesPanel(t.objectId)},f.Model.Solutions.FlowUpdates.MessageBar.flowUpdatesLink))))}}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/206.e4e2e0df.chunk.js.map