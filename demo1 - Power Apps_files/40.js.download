(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/40.js?v=1.4.3886-master"]={begin:performance.now()},(window.__wpJsonpUci=window.__wpJsonpUci||[]).push([[40],{"5ZTD":function(e,t,n){"use strict";n.d(t,"h",(function(){return pe})),n.d(t,"f",(function(){return fe})),n.d(t,"g",(function(){return he})),n.d(t,"a",(function(){return ge})),n.d(t,"c",(function(){return Oe})),n.d(t,"i",(function(){return ye})),n.d(t,"d",(function(){return be})),n.d(t,"e",(function(){return Ce})),n.d(t,"b",(function(){return Ee}));var r,a,o=n("4ciL"),i=n("Nt68");!function(e){e.BooleanType="boolean",e.NullableType="nullable",e.IntegerType="integer",e.Int64Type="int64",e.FloatType="float",e.TimeType="time",e.ShortTimeType="shorttime",e.ShortDateType="shortdate",e.DateMonthType="datemonth",e.CurrencyType="currency",e.DecimalType="decimal",e.StringType="string"}(r||(r={})),function(e){e.SystemUser="systemuser",e.ModifiedOn="modifiedon",e.CreatedOn="createdon",e.ModifiedBy="modifiedby",e.CreatedBy="createdby",e.StateCode="statecode",e.StatusCode="statuscode",e.OwnerId="ownerid"}(a||(a={}));var s,c=n("Xd5/"),u=n("SAYH"),m=n("504W"),d=n("Nzmy"),l=n("+5Bq");!function(e){e.EqualOperator="Equal",e.NotEqualOperator="NotEqual",e.GreaterThanOperator="GreaterThan",e.GreaterThanOrEqualOperator="GreaterThanOrEqual",e.LessThanOperator="LessThan",e.LessThanOrEqualOperator="LessThanOrEqual",e.AndOperator="And"}(s||(s={}));var p=n("MXaZ"),f=n("SoYb"),h=n("FZk4"),g=n("3fL6"),O=n("JUjK"),y=n("lR0U"),b=n("/A0C");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const C={parseValue:N,addAttributesInValues:function(e,t,n){const r={};return e.forEach(e=>{const n=!!f.a(e.IsResettable);let a=C.parseValue(t,e.Value,n);(a||null===a&&n)&&(a instanceof u.a&&(a=u.a.toString(a)),r[e.Field]=a)}),r},addAttributesFromSource:function(e,t){const n={};if(e){const r=C.parseValue(t,e);for(const e in r){const t=r[e];t&&t.hasOwnProperty("id")?(n[e+"!id"]=t.id,n[e+"!name"]=t.name,n[e+"!logicalname"]=t.entityType):n[e]=t}}return n},addDefaultAttributes:function(e,t){let n={};t&&t.userId&&t.userDisplayName&&(n=Object.assign(C.setOwnerId(a.OwnerId,t),C.setOwnerId(a.CreatedBy,t),C.setOwnerId(a.ModifiedBy,t)));return n[a.CreatedOn]=E(new Date),n[a.ModifiedOn]=E(new Date),n[a.StateCode]=0,n[a.StatusCode]=1,n},setOwnerId:function(e,t){const n={},r=Object(y.a)(e,b.a.Owner);return n[r[0]]=u.a.toString(t.userId),n[r[1]]="systemuser",n[r[2]]=t.userDisplayName,n},getEntityName:function(e,t){if(!t)return null;const n=C.parseValue(e,t);return n?n.toString():null},getConditionResult:function(e,t,n,a,o){switch(a){case r.BooleanType:return t===s.AndOperator?e&&f.a(n):C.getConditionValue(e,t,f.a(n));case r.NullableType:return t===s.EqualOperator?Object(m.a)(e):t===s.NotEqualOperator&&!Object(m.a)(e);case r.IntegerType:return C.getConditionValue(e,t,f.b(n));case r.Int64Type:case r.FloatType:case r.DecimalType:return C.getConditionValue(e,t,f.c(n));case r.TimeType:return C.getConditionValue(e,t,f.d(n));case r.ShortTimeType:case r.ShortDateType:const a=Object(p.o)(n);return t===s.EqualOperator?!!n&&e.getTime()===a.getTime():t===s.NotEqualOperator?!n||e.getTime()!==a.getTime():C.getConditionValue(e,t,a);case r.CurrencyType:const{formatInfoCultureName:i,numberFormatInfo:u,dateFormatInfo:d}=o.userSettings,l=new Sys.CultureInfo(i,u,d);return C.getConditionValue(e,t,Object(c.E)(n,{controlAttributes:{Type:"money"}},l,""));case r.StringType:return C.getConditionValue(e,t,n);default:return!1}},getConditionValue:function(e,t,n){switch(t){case s.GreaterThanOperator:return e>n;case s.GreaterThanOrEqualOperator:return e>=n;case s.LessThanOperator:return e<n;case s.LessThanOrEqualOperator:return e<=n;case s.EqualOperator:return e===n;case s.NotEqualOperator:return e!==n;default:return!1}},getAndOrConditions:function(e,t,n){return e.map(e=>{if(e.LeftOperand&&e.RightOperand)return C.getConditionResult(N(t,e.LeftOperand),e.Operator,N(t,e.RightOperand),e.Type,n)}).filter(e=>!Object(m.a)(e))},createFilterCriteria:function(e,t,n,r,a){if(!(e&&t&&n&&r))throw new Error("Name, Value, OperatorType and Conditiontype must have a value provided.");const o=n===s.AndOperator?g.a.And:g.a.Or;let i=N(a,t);!i||i instanceof u.a||(i=u.a.tryParse(i.toString()));i=u.a.toString(i);let c=O.a.Equals;switch(r){case s.EqualOperator:c=O.a.Equals;break;case s.GreaterThanOperator:c=O.a.GreaterThan;break;case s.GreaterThanOrEqualOperator:c=O.a.GreaterThanEqualTo;break;case s.LessThanOperator:c=O.a.LessThan;break;case s.LessThanOrEqualOperator:c=O.a.LessThanEqualTo;break;case s.NotEqualOperator:c=O.a.NotEquals}return new h.a(e,i,o,c)},getReferenceValue:function(e,t){const{key:n,path:r}=w(e);let a;t&&t.has(n)&&(a=t.get(n),S(a)&&(a=a.rows.item(0)),a=C.getObjectFromMap(r,a));return a},getReferenceValueLength:function(e,t){const{key:n}=w(e);if(t&&t.has(n)){const e=t.get(n);if(S(e))return e.rows.length}return 1},getObjectFromMap:function(e,t){return e.forEach(e=>{t=t&&t.hasOwnProperty(e)?t[e]:void 0}),t}};function N(e,t,n=!1){if(!t){if(n)return t;throw new TypeError("Xml attribute param to parse must have a value provided")}let r=null;switch(t){case i.a.DateTimeNowString:r=E(new Date).trim();break;case i.a.OppCloseDateString:const n=C.getReferenceValue(t,e);if(n){r=E(new Date(n.toString())).trim()}break;default:if(t.startsWith(i.a.NegatedReference)){t=t.substr(i.a.FirstIndex,t.length);const n=C.getReferenceValue(t,e);Object(m.a)(n)||(r=!Object(l.a)(n.toString()))}else r=t.startsWith(i.a.Reference)?C.getReferenceValue(t,e):t===i.a.NullString?null:t}return n||(r=void 0===r?null:r),d.c.info(`CommandStepsCommon: ParseValue: Parsed ${t} to ${r?r.toString():null}`),r}function E(e){return e.toISOString().replace(/T|Z/g," ")}function S(e){return e&&e.hasOwnProperty("rows")}function w(e){const t=e.split(i.a.DotSeperator);return{key:t[0].slice(1),path:t.slice(1)}}var I=n("Uv1Y"),F=n("TBkx"),A=n("iZ7K"),v=n("iF9X"),R=n("Q7Xa"),T=n("TRNQ"),j=n("thzq"),P=n("2LZB"),L=n("3ri3");class _{constructor(e,t,n,r){this._Id=null,this._CommandId=null,this._EntityName=null,this._Operation=0,this._set_id(e),this._set_commandId(t),this.set_entityName(n),this.set_operation(r)}get_id(){return this._Id}_set_id(e){return this._Id=e,e}get_commandId(){return this._CommandId}_set_commandId(e){return this._CommandId=e,e}get_entityName(){return this._EntityName}set_entityName(e){return this._EntityName=e,e}get_operation(){return this._Operation}set_operation(e){return this._Operation=e,e}toDictionary(){const e={};return e[L.j]=this.get_id(),e[L.h]=this.get_commandId(),e[L.i]=this.get_entityName(),e[L.k]=this.get_operation(),e}}var q=n("7tM0");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const x={processCreateStep:function(e,t,n,r,a,o){if(e.EntityName){return(new T.a).generateUID().nativePromise().then(s=>{d.c.info("OFFLINE: CommandStepProcessor: processCreateStep: creating "+e.EntityName+" with Id "+s+" for "+e.OperationName+".");const c=C.getEntityName(t,e.EntityName),m=c+i.a.Id,l=e.Attribute.find(e=>e.Field===m);l&&(l.Value===i.a.GuidString?l.Value=u.a.toString(u.a.fromLegacyGuid(s)):l.Value=C.parseValue(t,l.Value));const p=Object.assign(C.addDefaultAttributes(e.EntityName,o),C.addAttributesFromSource(e.Source,t),C.addAttributesInValues(e.Attribute,t));return n.push(new R.a(p,j.a.Create,c)),t.set(e.Result.Name,{entityType:c,id:u.a.tryParse(p[c+i.a.Id])}),l&&(r[m]=l.Value),d.c.info("OFFLINE: CommandStepProcessor: processCreateStep: Creating command entity operation for "+e.EntityName),x.createCommandEntityOperation(a,e.EntityName,1)}).catch(e=>(d.c.error("OFFLINE: CommandStepProcessor: processCreateStep: failed generating UID with error for :"+Object(F.f)(e)),Object(I.b)(e)))}return d.c.error("OFFLINE: CommandStepProcessor: processCreateStep: failed because entity name is null or an empty string in operation for commandId as "+a+" ."),Promise.reject(new I.a("Entity Name is null/empty string in operation."))},processUpdateStep:function(e,t,n,r,a){if(!(e.Attribute&&e.Identifier&&e.Result&&e.EntityName))return d.c.error("OFFLINE: CommandStepProcessor: processUpdateStep: Attribute/Identifier/Result/EntityName is not defined in the operation"),Promise.reject(new I.a("Attribute/Identifier/Result/EntityName is not defined in the operation"));const o=C.getEntityName(t,e.EntityName),s=Object.assign(C.addAttributesFromSource(e.Source,t),C.addAttributesInValues(e.Attribute,t)),c=C.parseValue(t,e.Identifier.Value);s[e.Identifier.Name]=!c||c instanceof u.a?c:u.a.toString(u.a.tryParse(c.toString())),n.push(new R.a(s,j.a.Update,o));let m=o;const l=Object(A.h)(a,o);if(l&&l.IsBPFEntity&&Object(v.g)(a))return Promise.resolve(null);l&&l.IsBPFEntity?m=i.a.BusinessProcessFlowInstance:l&&l.IsActivity&&(m=i.a.ActivityString);const p=null!==s[m+i.a.Id]?s[m+i.a.Id].toString():null;if(!p)return d.c.error("OFFLINE: CommandStepProcessor: processUpdateStep: Failed to parse entityid: "+p+i.a.Id),Promise.reject(new I.a("Failed to parse entityid: "+p+i.a.Id));return t.set(e.Result.Name,{entityType:o,id:u.a.tryParse(p)}),d.c.info("OFFLINE: CommandStepProcessor: processUpdateStep: Creating command entity operation for "+e.EntityName),x.createCommandEntityOperation(r,o,3)},processDeleteStep:function(e,t,n,r){if(!e.Attribute||!e.EntityName)return d.c.error("OFFLINE: CommandStepProcessor: processDeleteStep: Attribute/EntityName is not defined in the operation"),Promise.reject(new I.a("Attribute/EntityName is not defined in the operation"));return n.push(new R.a(C.addAttributesInValues(e.Attribute,t),j.a.Delete,C.getEntityName(t,e.EntityName))),d.c.info("OFFLINE: CommandStepProcessor: processDeleteStep: Creating command entity operation for "+e.EntityName),x.createCommandEntityOperation(r,e.EntityName,2)},processRetrieveStep:function(e,t){if(!e.MultipleCheck||!e.Result||!e.EntityName)return d.c.error("OFFLINE: CommandStepProcessor: processRetrieveStep: Attribute/MultipleCheck/Result/EntityName is not defined in the operation"),Promise.reject(new I.a("Identifier/Result/EntityName is not defined in the operation"));const n=new Array;e.MultipleCheck.forEach(e=>{e.Condition.forEach(e=>{n.push(C.createFilterCriteria(e.LeftOperand,e.RightOperand,e.Type,e.Operator,t))})});const r=new P.a(n),a=new T.a,o=C.getEntityName(t,e.EntityName);return a.retrieve(o,r).nativePromise().then(n=>(t.set(e.Result.Name,n),d.c.info("OFFLINE: CommandStepProcessor: processRetrieveStep: Succeeded resolving the promise with true"),null)).catch(e=>{d.c.error("OFFLINE: CommandStepProcessor: processRetrieveStep: Failed with error: "+Object(F.f)(e)),Object(I.b)(e)})},processConditionCheckStep:function(e,t,n){if(e.MultipleCheck&&0!==Object.keys(e.MultipleCheck).length){const r=[],a=[];let o=!1;d.c.info("OFFLINE: CommandStepProcessor: processConditionCheckStep:  Processing Multiple check for opertion."),e.MultipleCheck.forEach(e=>{if(d.c.info("OFFLINE: CommandStepProcessor: processConditionCheckStep: Processing Multiple check with Multiple Check "+e.Type+" for Condition opertion."),e.Type===s.AndOperator){const a=C.getAndOrConditions(e.Condition,t,n);r.push(...a)}else{const r=C.getAndOrConditions(e.Condition,t,n);a.push(...r)}});const i=e=>!(e.indexOf(!1)>-1),c=e=>e.indexOf(!0)>-1;return r.length>0&&a.length>0?o=c(a)&&i(r):r.length>0?o=i(r):a.length>0&&(o=c(a)),d.c.info("OFFLINE: CommandStepProcessor: processConditionCheckStep setting "+e.Result.Name+" to:"+o),t.set(e.Result.Name,o),Promise.resolve(null)}return d.c.error("OFFLINE: CommandStepProcessor: processConditionCheckStep failed : MultipleCheck is not defined in operation."),Promise.reject(new I.a("MultipleCheck is not defined in operation."))},processSetValueStep:function(e,t){if(e.Result)return t.set(e.Result.Name,C.parseValue(t,e.Result.Value)),d.c.info("OFFLINE: CommandStepProcessor: processSetValueStep setting "+e.Result.Name+" to: "+t.get(e.Result.Name)),Promise.resolve(null);return d.c.error("OFFLINE: CommandStepProcessor: processSetValueStep failed : Result is not defined in operation."),Promise.reject(new I.a("Result is not defined in operation."))},processFailureStep:function(e,t,n){if(e.Message){let r=null;if(e.Message.WebResourceName){const t=Object(q.b)(n,e.Message.WebResourceName);r=t?t[e.Message.Key]:e.Message.Key}return r?Promise.reject(new I.a(C.parseValue(t,r),-2147220891)):(d.c.error("OFFLINE: CommandStepProcessor: processSetValueStep failed : No Message is defined in operation."),Promise.reject(new I.a("Message not defined in operation.")))}return d.c.error("OFFLINE: CommandStepProcessor: processSetValueStep failed : Messages is not defined in operation."),Promise.reject(new I.a("Messages is not defined in operation."))},createCommandEntityOperation:function(e,t,n){return(new T.a).generateUID().nativePromise().then(r=>(d.c.info("OFFLINE: CommandStepProcessor: createCommandEntityOperation: Successfully created command entity operation for "+t),new R.a(new _(r,e,t,n).toDictionary(),j.a.Create,i.a.CommandOperationString))).catch(e=>(d.c.error("OFFLINE: CommandStepProcessor: createCommandEntityOperation: Failed in creating command entity operation because of generate UID failure with error "+Object(F.f)(e)),Object(I.b)(e)))}};var D=n("zAhX"),M=n("LTmj"),V=n("O4uv");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const k={executeCommand:function(e,t,n,r,a){return B(e,t,n,r,a).then(e=>(d.c.info("OFFLINE: CommandExecutionEngine: executeCommand: Initializing the process to create batch and perform operations."),k.createBatchAndPerformOperations(t,n,e.entityOperations,e.offlineData,e.commandEntities,e.commandId,a))).then(e=>(d.c.info("OFFLINE: CommandExecutionEngine: executeCommand: resolving promise with EntityOperations."),e)).catch(n=>{const r=n.get_Message?new I.a(n.get_Message()):n,o=Object(A.h)(a,e)?Object(A.h)(a,e).Id:null;throw d.c.error("OFFLINE: CommandExecutionEngine: executeCommand: failed with error: "+r.message+" for entity: "+o+" and command: "+t),r})},prepareCommandQueries:function(e,t,n,r,a){return B(e,t,n,r,a).then(e=>(d.c.info("OFFLINE: CommandExecutionEngine: prepareCommandQueries: Initializing the process to create batch and perform operations."),k.createBatch(t,n,e.entityOperations,e.offlineData,e.commandEntities,e.commandId,a))).then(e=>(d.c.info("OFFLINE: CommandExecutionEngine: prepareCommandQueries: resolving promise with EntityOperations."),e)).catch(n=>{const r=n.get_Message?new I.a(n.get_Message()):n,o=Object(A.h)(a,e)?Object(A.h)(a,e).Id:null;throw d.c.error("OFFLINE: CommandExecutionEngine: prepareCommandQueries: failed with error: "+r.message+" for entity: "+o+" and command: "+t),r})},processOperationsSequentially:function(e,t,n,r,a,o){if(e&&0===e.length||t&&0===t.size||Object(m.a)(n)||Object(m.a)(r))return Promise.reject(new I.a("Either operations/updatedMembers is empty or entityOperations/offlineData is null. Invalid input arguments passed."));d.c.info("OFFLINE: CommandExecutionEngine: processOperationsSequentially : Processing each operation sequentially");let i=Promise.resolve([]);return e.forEach(e=>{d.c.info("OFFLINE: CommandExecutionEngine: processOperationsSequentially : processing operation : "+e.OperationName),i=i.then(i=>(e=>{const i=C.parseValue(t,e.IsExecutable);if(i&&Object(f.a)(i.toString()))return d.c.info("OFFLINE: CommandExecutionEngine: processOperationsSequentially : processOperation: executing operation : "+e.OperationName),k.processCommandStep(e,t,n,r,a,o);return Promise.resolve(null)})(e).then(t=>(t&&(d.c.info("OFFLINE: CommandExecutionEngine: processOperationsSequentially : adding command entity operation : "+e.OperationName),i.push(t)),i)).catch(t=>{if(d.c.error("OFFLINE: CommandExecutionEngine: processOperationsSequentially : processing operation : "+e.OperationName+" failed with error: "+Object(F.f)(t)),-2147220891===t.getNegativeErrorCode())throw t;const n=Object(A.h)(o,e.EntityName)?Object(A.h)(o,e.EntityName).Id:null;throw new I.a(`Processing of operation ${e.OperationName} for entityId ${n} failed with error: ${t.message}`)}))}),i},processCommandStep:function(e,t,n,r,a,o){switch(e.OperationName){case i.a.CreateStep:return x.processCreateStep(e,t,n,r,a,o.user);case i.a.RetrieveStep:return x.processRetrieveStep(e,t);case i.a.UpdateStep:return x.processUpdateStep(e,t,n,a,o);case i.a.DeleteStep:return x.processDeleteStep(e,t,n,a);case i.a.SetValueStep:return x.processSetValueStep(e,t);case i.a.ConditionStep:return x.processConditionCheckStep(e,t,o.user);case i.a.FailureStep:return x.processFailureStep(e,t,o)}},createBatchAndPerformOperations:function(e,t,n,r,a,o,i){const s=X(e,t,n,r,a,o,i);if(s)return Promise.reject(s);const c=new T.a;return d.c.info("OFFLINE: CommandExecutionEngine: createBatchAndPerformOperations: Initiating performing of operations."),c.performOperations(n,a,!1).nativePromise().then(e=>n).catch(e=>(d.c.info("OFFLINE: CommandExecutionEngine: createBatchAndPerformOperations: entityOperations: Failed"+Object(F.f)(e)),Object(I.b)(e)))},createBatch:function(e,t,n,r,a,o,i){const s=X(e,t,n,r,a,o,i);if(s)return Promise.reject(s);const c=new T.a;return d.c.info("OFFLINE: CommandExecutionEngine: createBatch: Initiating performing of operations."),c.prepareOperations(n,a,!1).nativePromise().then(e=>e).catch(e=>(d.c.info("OFFLINE: CommandExecutionEngine: createBatch: entityOperations: Failed"+Object(F.f)(e)),Object(I.b)(e)))},createCommand:U,prepareCommandOperation:X};function B(e,t,n,r,a){if(!e||!t||n&&0===Object.keys(n).length||!r)return Promise.reject(new I.a("CommandExecutionEngine _prepareCommandQueries failed due to empty/invalid inputs."));d.c.info("OFFLINE: CommandExecutionEngine: _prepareCommandQueries: Initializing the execution of the command operations corresponding to entityLogicalName as "+e+" and commandName as "+t+" .");const o=[],i=r.CommandRequestData,s={},c=new T.a;return d.c.info("OFFLINE: CommandExecutionEngine: _prepareCommandQueries: Creating a new guid."),c.generateUID().nativePromise().then(e=>(d.c.info("OFFLINE: CommandExecutionEngine: _prepareCommandQueries: Initiating the processing of operations sequentially."),k.processOperationsSequentially(r.Operations,i,o,s,e,a).then(t=>({commandId:e,commandEntities:t,entityOperations:o,offlineData:s}))))}function X(e,t,n,r,a,o,i){return 0===n.length||0===a.length?(d.c.error("OFFLINE: CommandExecutionEngine: prepareCommandOperation: failed because entityOperations or commandEntities are null."),new I.a("Operation could not be performed at the moment. Please try again.")):(a.unshift(U(e,t,r,o,i)),null)}function U(e,t,n,r,a){const s=Object(o.a)(a,t);return s.additionalHeaders||(s.additionalHeaders={}),Object(V.b)(s,n),new R.a(new M.a(r,e,D.a.InProgress,JSON.stringify(s)).toDictionary(),j.a.Create,i.a.CommandString)}var G,Q,H=n("8CAN");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function W(e,t){const n=new Map;return Array.prototype.forEach.call(e.getElementsByTagName(Q.PropertyNode),e=>{if(!e.hasAttribute(G.NameAttribute))throw d.c.error("XamlParser.GetCommandRequestData:CommandRequestData node must have a Name attribute provided."+e),new Error("CommandRequestData node must have a Name attribute provided.");const r=e.getAttribute(G.NameAttribute);n.set(r,t.get(r))}),n}function z(e){const t={};if(!e.hasAttribute(G.OperationNameAttribute)||!e.hasAttribute(G.EntityNameAttribute)||!e.hasAttribute(G.IsExecutableAttribute))throw d.c.error("XamlParser.GetOperation:Operation node must have a OperationName, EntityName and IsExecutable attributes provided."+e),new Error("Operation node must have a OperationName, EntityName and IsExecutable attributes provided.");return t.OperationName=e.getAttribute(G.OperationNameAttribute),t.EntityName=e.getAttribute(G.EntityNameAttribute),t.IsExecutable=e.getAttribute(G.IsExecutableAttribute),e.hasAttribute(G.SourceAttribute)&&(t.Source=e.getAttribute(G.SourceAttribute)),Array.prototype.forEach.call(e.childNodes,n=>{switch(n.nodeName){case Q.AttributesNode:t.Attribute=(r=e,Array.prototype.map.call(r.getElementsByTagName(Q.AttributeNode),e=>{const t={};if(!e.hasAttribute(G.FieldAttribute))throw d.c.error("XamlParser.GetAttributes:Attribute node must have a Field attribute provided."+e),new Error("Attribute node must have a Field attribute provided.");t.Field=e.getAttribute(G.FieldAttribute),t.Value=e.firstChild.nodeValue;const n=e.getAttribute(G.IsResettableAttribute);return n&&(t.IsResettable=n),t}));break;case Q.ConditionsNode:t.MultipleCheck=function(e){return Array.prototype.map.call(e.getElementsByTagName(Q.MultipleCheckNode),e=>{const t={};if(!e.hasAttribute(G.TypeAttribute))throw d.c.error("XamlParser.GetMultipleChecks:MultipleCheck node must have a Type attribute provided."+e),new Error("MultipleCheck node must have a Type attribute provided.");return t.Type=e.getAttribute(G.TypeAttribute),t.Condition=function(e){return Array.prototype.map.call(e.getElementsByTagName(Q.ConditionNode),e=>{const t={};if(!(e.hasAttribute(G.LeftOperandAttribute)&&e.hasAttribute(G.RightOperandAttribute)&&e.hasAttribute(G.OperatorAttribute)&&e.hasAttribute(G.TypeAttribute)))throw d.c.error("XamlParser.GetConditions:Condition node must have a Left Operand, Right Operand, Operator and Type attribute provided."+e),new Error("Condition node must have a Left Operand, Right Operand, Operator and Type attribute provided.");return t.LeftOperand=e.getAttribute(G.LeftOperandAttribute),t.RightOperand=e.getAttribute(G.RightOperandAttribute),t.Operator=e.getAttribute(G.OperatorAttribute),t.Type=e.getAttribute(G.TypeAttribute),t})}(e),t})}(e);break;case Q.ResultNode:t.Result=function(e){const t=K(e,Q.ResultNode);if(!t)throw d.c.error("XamlParser.GetResult:Result node must have a Name and Value attributes provided."+e),new Error("Result node must have a Name and Value attributes provided.");return t}(e);break;case Q.IdentifierNode:t.Identifier=function(e){const t=K(e,Q.IdentifierNode);if(!t)throw d.c.error("XamlParser.GetIdentifier:Identifier node must have a Name and Value attributes provided."+e),Error("Identifier node must have a Name and Value attributes provided.");return t}(e);break;case Q.MessageNode:t.Message=function(e){const t=e.getElementsByTagName(Q.MessageNode);if(t&&t.length>0){if(1===t.length){const e=t[0];return{WebResourceName:e.getAttribute(G.WebResourceNameAttribute),Key:e.getAttribute(G.KeyAttribute)}}throw new Error("More than one message found.")}return null}(e)}var r}),t}function K(e,t){const n=e.getElementsByTagName(t),r=(null!=n&&n.length)>0?n[0]:e;return r.hasAttribute(G.NameAttribute)&&r.hasAttribute(G.ValueAttribute)?{Name:r.getAttribute(G.NameAttribute),Value:r.getAttribute(G.ValueAttribute)}:null}!function(e){e.NameAttribute="Name",e.OperationNameAttribute="OperationName",e.EntityNameAttribute="EntityName",e.IsExecutableAttribute="IsExecutable",e.FieldAttribute="field",e.IsResettableAttribute="IsResettable",e.OperatorAttribute="Operator",e.RightOperandAttribute="RightOperand",e.LeftOperandAttribute="LeftOperand",e.TypeAttribute="Type",e.ValueAttribute="Value",e.SourceAttribute="Source",e.WebResourceNameAttribute="WebResourceName",e.KeyAttribute="Key"}(G||(G={})),function(e){e.RootNode="Activity",e.OperationNode="Operation",e.PropertyNode="Property",e.AttributesNode="Attributes",e.ConditionsNode="Conditions",e.ResultNode="Result",e.IdentifierNode="Identifier",e.MultipleCheckNode="MultipleCheck",e.ConditionNode="Condition",e.AttributeNode="Attribute",e.MessageNode="Message"}(Q||(Q={}));var Z,J=n("eXjw"),Y=n("3hnk"),$=n("sZ+8"),ee=n("FZDd"),te=n("ROKC"),ne=n("8o18"),re=n("/bjP"),ae=n("XvL5"),oe=n("8tWD");!function(e){e.QualifyLeadCommandName="QualifyLead",e.ConvertActivityCommandName="ConvertActivity",e.LoseOpportunityCommandName="LoseOpportunity",e.WinOpportunityCommandName="WinOpportunity",e.ResolveCaseCommandName="CloseIncident",e.SetState="SetState",e.CloseActivityCommandName="CloseActivity",e.ResolveIncidentCommandName="ResolveIncident"}(Z||(Z={}));var ie=n("Lyxw"),se=n("3/02"),ce=n("f07+"),ue=n("uIhY"),me=n("odYE"),de=n("EXJz");let le;function pe(e,t,n,r,a){return{type:"offline.noncud.request.process",execute:({dispatch:o,getState:i},s)=>fe(e,t,n,{dispatch:o,getState:i},r,a).then(r=>(d.c.info("OFFLINE: CommandHandler: processCommandRequest: Executing the command operations."),k.executeCommand(e,t,n,r,i()))).then(e=>(d.c.info("OFFLINE: CommandHandler: processCommandRequest: Resolving promise with entity operations."),e)).catch(n=>{throw d.c.error("OFFLINE: CommandHandler: processCommandRequest: failed with error: "+Object(F.f)(n)+" for entity: "+e+" and command: "+t),n})}}function fe(e,t,n,r,a,o){if(d.c.info("OFFLINE: CommandHandler: processCommandRequest: Initializing processing of non cud request with entityName as "+e+", commandName as "+t+"."),!e||!t||!n||0===Object.keys(n).length)return d.c.error("OFFLINE: CommandHandler: processCommandRequest: failed because entity/command/request is empty."),Promise.reject(new I.a("The entityName/commandName/request is empty."));d.c.info("OFFLINE: CommandHandler: processCommandRequest: Retrieving user privilege and custom entity flag for the entity "+e+".");const{getState:s,dispatch:c}=r;return Oe(e,r,a).then(t=>{if(!t.get("isPrivileged")){const t=Object(A.h)(s(),e)?Object(A.h)(r.getState(),e).Id:null;throw d.c.error("OFFLINE: CommandHandler: processCommandRequest: failed because the user does not have the privilege of the entity or the write permission on the entity "+t+"."),new I.a("The user does not have the privilege of the entity or the write permission on the entity.")}return t}).then(u=>(d.c.info("OFFLINE: CommandHandler: processCommandRequest: Retrieving command xaml for command "+t+"."),ye(u.get("isActivity")&&u.get("isCustomEntity")&&t===Z.ConvertActivityCommandName?"CustomActivity":e,t,r,a).then(u=>{if(!u)throw d.c.error("OFFLINE: CommandHandler: processCommandRequest: Retrieving command xaml failed because Xaml was not found or was empty for entity "+e+" and command "+t+"."),new I.a("Xaml not found or was empty.");d.c.info("OFFLINE: CommandHandler: processCommandRequest: Parsing the command xaml to get corresponding command operations for command "+t+".");const m=function(e,t){const n=(new DOMParser).parseFromString(e,"text/xml");if(d.c.info("XamlParser.createObjectFromXaml:Creates command operations from commandXaml: "+e),!n.hasChildNodes()||n.childNodes[0].nodeName!==Q.RootNode)throw d.c.error("XamlParser.CreateObjectFromXaml:CreateObjectFromXaml must have a valid root node with name Activity. "+e),new Error("CreateObjectFromXaml must have a valid root node with name Activity.");const r=n.getElementsByTagName(Q.RootNode)[0];return{CommandRequestData:W(r,t),Operations:Array.prototype.map.call(r.getElementsByTagName(Q.OperationNode),z)}}(u,function(e,t,n){const r=new Map,a=e,o=n&&n.EntityLogicalName;Object.keys(e).filter(e=>a[e]&&("function"!=typeof a[e]||"name"===e||"xmlNamespace"===e)).forEach(i=>{if("entityMoniker"!==i){let s=null;a[i].hasOwnProperty("@odata.type")&&(s=a[i]["@odata.type"].replace(/#Microsoft.Dynamics.CRM./,""));const c=Object.keys(a[i]).filter(e=>Object(de.getAttributeBindMatchFromOdata)(e)),u=Object.keys(a[i]).filter(e=>Object(de.getAttributeValueMatchFromOdata)(e));if(c&&0!==c.length||u&&0!==u.length){let e=Object.assign({},a[i]);c&&0!==c.length&&c.forEach(r=>{const a=Ee(e[r]),i=Object(de.getAttributeBindMatchFromOdata)(r)[1],c=Object(A.z)(t,s||o,i);let u=c&&c.ReferencingAttribute;if(u||(u=i.split("_")[0]),a){delete e[r];const o=Object($.d)(t,a[0]),i=o&&o.entitylogicalname;if(o){const t={id:a[1],entityType:i,typeCode:f.b(o.objecttypecode)};n&&n[u]&&n[u].name&&(t.name=n[u].name,delete n[u]),e=Object.assign({[u]:t},e)}}}),u&&0!==u.length&&u.forEach(t=>{const n=Object(de.getAttributeValueMatchFromOdata)(t)[1];if(n&&null==e[t]){const r={id:null,entityType:null,name:null};delete e[t],e=Object.assign({[n]:r},e)}}),r.set(i,e)}else r.set(i,e[i])}else r.set("entityId",a[i].get_identifier()),r.set("entityName",a[i].get_displayName())}),n&&Object.keys(n).forEach(e=>{r.set(e,n[e])});return r}(n,r.getState(),o));if(!m||!m.Operations||!m.CommandRequestData)throw d.c.error("OFFLINE: CommandHandler: processCommandRequest: failed because the creation of command operations from command xaml failed for command "+t+"."),new I.a("The creation of command operations from command xaml failed.");const l=[];for(const e of m.Operations){const t=C.getEntityName(m.CommandRequestData,e.EntityName);if(i.a.UpdateStep===e.OperationName&&t){const e=Object(A.h)(s(),t);e&&Object(J.b)(e.Initialized)||l.push(c(Object(ee.f)(t,!1,[],a)))}}return Promise.all(l).then(()=>m)})))}function he(e,t,n,r,a){return{type:"offline.noncud.request.process",execute:({dispatch:o,getState:i},s)=>fe(e,t,n,{dispatch:o,getState:i},r,a).then(r=>(d.c.info("OFFLINE: CommandHandler: prepareCommandRequestQueries: Preparing the command queries."),k.prepareCommandQueries(e,t,n,r,i()))).then(e=>(d.c.info("OFFLINE: CommandHandler: prepareCommandRequestQueries: Resolving promise with queryset dictionary."),e)).catch(n=>{throw d.c.error("OFFLINE: CommandHandler: prepareCommandRequestQueries: failed with error: "+Object(F.f)(n)+" for entity: "+e+" and command: "+t),n})}}function ge(e,t){const n=e.map(e=>{var n;if(e.get_operationPerformed()===j.a.Create){const r=null!==(n=Object(A.G)(t.getState(),e.get_entityType()))&&void 0!==n?n:e.get_entityType()+"id";return{LogicalName:e.get_entityType(),Id:e.get_entity()[r]}}}).filter(e=>e);return{ok:!0,status:n.length?200:204,json:()=>Promise.resolve({createdEntities:n}),text:()=>Promise.resolve(JSON.stringify({createdEntities:n}))}}function Oe(e,t,n){return t.dispatch(Object(ee.f)(e,!1,[],n)).then(()=>{const n=Object(A.h)(t.getState(),e);return(new Map).set("isPrivileged",Object(Y.g)(t.getState(),e,3,-1)).set("isActivity",n.IsActivity).set("isCustomEntity",n.IsCustomEntity)}).catch(e=>{throw d.c.error("retrieveEntity fails"+Object(F.f)(e)),e})}function ye(e,t,n,r){const a=String.format(H.a.CommandXamlRetrievalQuery,t,e);d.c.info("Retrieving commandxaml for "+e+" with sql value: "+a);const o=new ne.a(new re.a,null);return o.set_EntityLogicalName(H.a.OfflineCommandDefinition),o.set_ColumnSet(new ae.a([])),o.get_DescriptorSet().updateDescriptorSet(oe.a.Sql,a),n.dispatch(Object(te.a)(o,null,r)).then(e=>{const t=e.get_entities();if(t&&1===t.length)return d.c.info("Able to successfully retrieve multiple record from offline db"),t[0].getValue("commanddefinition");throw d.c.error("Retrieved more than one command xaml from db."),Error("Retrieved more than one command xaml from db.")},e=>{throw d.c.error("Unable to Retrieve xaml from offline db "+Object(F.f)(e)),e})}function be(e,t,n,r){switch(t){case Z.QualifyLeadCommandName:case Z.ConvertActivityCommandName:case Z.WinOpportunityCommandName:case Z.LoseOpportunityCommandName:case Z.ResolveIncidentCommandName:return Promise.resolve(!0);default:return Object(ie.f)(e.getState(),se.hb)?function(e,t){if(!le)return function(e,t){d.c.info("Retrieving all command names");const n=new ne.a(new re.a,null);return n.set_EntityLogicalName(H.a.OfflineCommandDefinition),n.set_ColumnSet(new ae.a([])),n.set_PageSize(100),n.get_DescriptorSet().updateDescriptorSet(oe.a.Sql,H.a.CommandsRetrievalQuery),e.dispatch(Object(te.a)(n,null,t)).then(e=>{const t=e.get_entities();if(t&&t.length>0)return d.c.info("Able to successfully retrieve multiple commands from offline db"),t.reduce((e,t)=>{const n=t.getValue("commandname"),r=t.getValue("primaryentitylogicalname");return e.hasOwnProperty(n)?e[n].push(r):e[n]=[r],e},{});throw d.c.error("Retrieved no commands from db."),Error("Retrieved no commands from db.")},e=>{throw d.c.error("Unable to Retrieve commands from offline db "+Object(F.f)(e)),e})}(e,t).then(e=>{le=e});return Promise.resolve()}(e,r).then(()=>function(e,t){return le&&le[e]&&-1!==le[e].indexOf(t)}(t,n)):Promise.resolve(!1)}}function Ce(e,t,n,r){switch(t.get_name()){case"Create":{const a=t,o=a.get_target(),i=Object(ue.b)(e.getState(),o),s=o.get_identifier().LogicalName;n=n||u.a.fromLegacyGuid(o.get_identifier().Id);const c=s+"id";i.hasOwnProperty(c)||u.a.isNullOrEmpty(n)||(i[c]=u.a.toString(n)),r&&Ne(o,r);const m=a.get_suppressDuplicateDetection();return new ce.b(s,i,m)}case"Update":{const n=t,a=n.get_target();r&&Ne(a,r);const o=n.get_suppressDuplicateDetection();return new ce.k(a.get_identifier().LogicalName,a.get_identifier().Id.toString(),Object(ue.b)(e.getState(),a),null,null,!1,o)}case"Delete":{const e=t.get_target();return new ce.c(me.a.legacyToExternalEntityReference(e))}case"ExecuteMultiple":{const n=t,r=n.get_requests().map(t=>Ce(e,t));return n.get_settings().get_continueOnError()?new ce.f(r):new ce.f([r])}default:return null}}function Ne(e,t){e.get_changedFieldNames().forEach(n=>{const r=e.getValue(n);r&&r.hasOwnProperty("Id")&&(t[n]={name:r.Name})})}function Ee(e){const t=e.match("/(.*)\\((.*)\\)");return t&&3===t.length?[t[1],t[2]]:null}},"8CAN":function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e.OfflineCommandDefinition="offlinecommanddefinition",e.CommandXamlRetrievalQuery="select commanddefinition, commanddefinitionid from offlinecommanddefinition where commandname='{0}' and primaryentitylogicalname='{1}'",e.CommandsRetrievalQuery="select commanddefinitionid, commandname, primaryentitylogicalname from offlinecommanddefinition"}(r||(r={}))},Nt68:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e.LogicalName="LogicalName",e.Id="id",e.Reference="@",e.NullString="null",e.GuidString="@GUID",e.CommandString="Command",e.CommandOperationString="CommandOperation",e.DotSeperator=".",e.CommaSeperator=",",e.DefaultIndex=0,e.FirstIndex=1,e.NegatedReference="!@",e.DateTimeNowString="@DateTime.Now",e.OppCloseDateString="@OpportunityClose.actualend",e.CreateStep="Create",e.RetrieveStep="Retrieve",e.UpdateStep="Update",e.DeleteStep="Delete",e.SetValueStep="SetValue",e.ConditionStep="Condition",e.FailureStep="Failure",e.ActivityString="activity",e.BusinessProcessFlowInstance="businessprocessflowinstance"}(r||(r={}))}}]),window.bundleExecutionMarkers["scripts/40.js?v=1.4.3886-master"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();