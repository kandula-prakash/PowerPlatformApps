/*! For license information please see 56.ccd1489e.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[56],{3569:function(e,n,t){"use strict";t.r(n),t.d(n,"ConnectionReferencesFlowWidgetBase",(function(){return y})),t.d(n,"ConnectionReferencesFlowWidget",(function(){return S})),t.d(n,"mapTeamsThemeToWidgetTheme",(function(){return k}));var o=t(922),r=(t(3570),t(245)),i=t.n(r),a=t(2807),c=t(215),s=t(217),l=t(2698),d=t(3571),u=t(545);function f(){return(f=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e}).apply(this,arguments)}function m(e,n,t,o,r,i,a){try{var c=e[i](a),s=c.value}catch(l){return void t(l)}c.done?n(s):Promise.resolve(s).then(o,r)}var g=i.a.lazy(()=>t.e(107).then(t.bind(null,5368)).then(e=>({default:e.EmptyState}))),w="GET_ACCESS_TOKEN",p="WIDGET_READY",h="connectionsConfirmed",v="ConnectionReferencesFlowWidget.Load",C="ConnectionReferencesFlowWidget.AcquireToken";var y=Object(u.styled)((function(e){var{environmentId:n,connectionReferences:t,onChangeConnectionSelection:f,t:g,setErrorMessage:y,styles:S,themeName:k,setIsLoadingConnectionReferencesFlowWidget:b,setStateError:W}=e,O={environmentId:n},[R,N]=i.a.useState(!1),[F,j]=i.a.useState(!1),I=i.a.useRef(!1);I.current=R;var P=Object(u.classNamesFunction)()(S),x=new MsFlowSdk({hostId:"ConnectionReferences",hostName:a.settings.powerAppsFlowHostName,locale:Object(o.getCurrentLocale)()}),A=e=>{W(e),y(e)},z=function(){var e,n=(e=function*(e,n){var t=Object(s.trackLoadScenario)("powerapps-connections",C),o=a.settings.powerAppsFlowWidgetAuthorizationEndpoint;try{var r=yield Object(c.acquireTokenSilentAsync)(o);t.complete(O),n(null,{token:r.accessToken})}catch(i){t.failure({data:O,error:i}),A(g("Common.request.failed"))}},function(){var n=this,t=arguments;return new Promise((function(o,r){var i=e.apply(n,t);function a(e){m(i,o,r,a,c,"next",e)}function c(e){m(i,o,r,a,c,"throw",e)}a(void 0)}))});return function(e,t){return n.apply(this,arguments)}}(),_=e=>{A(g("Common.request.failed")),Object(s.trackErrorTrace)(l.PortalScope,{eventName:"Flows/ConnectionReferences/onConnectionWizardError",eventData:{error:e}})};return Object(r.useEffect)(()=>{var e,o=Object(s.trackLoadScenario)("powerapps-connections",v),r=!1,i=-1;b&&b(!0);try{var a;e=x.renderWidget("connectionWizard",{container:"flow-widget-container-connectionreferences",enableOnBehalfOfTokens:!0,environmentId:n,widgetStyleSettings:{themeName:k||"default"},connectionWizardSettings:{connectionReferences:E(t),onConnectionReferencesConfirmed:e=>{r=!1,Object.keys(e).forEach(n=>{var o=e[n],r=t.find(e=>e.connectionreferencelogicalname===n);r&&r.selectedConnectionName!==o.selectedConnectionName&&f(r,o.selectedConnectionName)})},onConnectionWizardConfirmationButtonDetailsChanged:n=>{I.current&&!n.disabled&&(r||(r=!0,e.notify(h,null)))},onConnectionWizardError:_}}),o.progress({widgetId:T(null===(a=e)||void 0===a?void 0:a.url)}),e.listen(w,z),e.listen(p,()=>{o.complete(O),N(!0),window.clearTimeout(i),window.setTimeout(()=>{b&&b(!1),j(!0)},1e3)}),i=window.setTimeout(()=>{if(!I.current){var n,t,r=T(null===(n=e)||void 0===n?void 0:n.url);A(g("MultiConnectionsPicker.TimeoutLoadingPicker",{requestId:r})),b&&b(!1),o.failure({error:"The flows connection reference widget didn't load after 1 minute",widgetId:r,widgetUrl:null===(t=e)||void 0===t?void 0:t.url})}},6e4)}catch(c){o.failure({error:c,telemetryData:O})}return()=>{e&&(o.progress({disposed:!0}),window.clearTimeout(i),e.dispose())}},[n]),i.a.createElement("div",{className:P.headerContainer,style:{display:F?"flex":"none"}},i.a.createElement("div",{className:P.title},g("MultiConnectionsPicker.inlineConnection.title")),i.a.createElement("div",{className:P.subtitle},g("MultiConnectionsPicker.inlineConnection.info")),i.a.createElement("div",{id:"flow-widget-container-connectionreferences",className:d.ConnectionReferencesFlowWidgetStyles.iframeContainer}))}),d.getStyles);function S(e){var{t:n,setErrorMessage:t}=e,[o,r]=i.a.useState(void 0);return i.a.createElement(i.a.Fragment,null,!o&&i.a.createElement(y,f({},e,{setStateError:r})),o&&i.a.createElement(i.a.Suspense,{fallback:null},i.a.createElement(g,{iconProps:{iconName:"StatusCircleErrorX"},title:n("MultiConnectionsWidget.loadError"),showActionButton:!0,actionButtonText:n("Common.request.tryAgain"),onActionButtonClick:()=>{r(void 0),t("")}})))}function E(e){var n={};return e.forEach(e=>{n[e.connectionreferencelogicalname]={connectionProviderId:e.connectorid}}),n}function k(e,n){switch(e){case"contrast":return"teams_high_contrast";case"dark":return n?"teams_modal_dark":"teams_dark";case"default":default:return n?"teams_modal":"teams"}}function T(e){var n;try{n=new URLSearchParams(new URL(e).search).get("widgetId")||"00000000-0000-0000-0000-000000000000"}catch(t){n="00000000-0000-0000-0000-000000000001"}return n}},3571:function(e,n,t){"use strict";t.r(n),t.d(n,"getStyles",(function(){return r})),t.d(n,"ConnectionReferencesFlowWidgetStyles",(function(){return i}));var o=t(719);function r(e){return{headerContainer:{height:"100%",width:"100%",flexDirection:"column",display:"flex"},title:{fontSize:"12px",fontWeight:600,paddingTop:"5px"},subtitle:{fontWeight:400,paddingTop:"4px",paddingBottom:"20px",fontSize:"12px"}}}var i=Object(o.mergeStyleSets)({iframeContainer:{width:"100%",height:"100%",selectors:{"& > iframe":{width:"100%",height:"100%"}}}})}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/56.ccd1489e.chunk.js.map