(window.webpackJsonp=window.webpackJsonp||[]).push([[220],{6693:function(e,n,t){"use strict";t.r(n),t.d(n,"UpdateEnvVarValuesPanel",(function(){return V}));var r=t(1573),a=t(245),o=t(5466),i=t(6694),s=t(6706),l=t(6710),c=t(3144),u=t(6713),d=t(6714),p=t(6753),v=t(6754),f=t(6398),m=t(6701),b=t(2869),g=t(2868);function E(){return(E=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e}).apply(this,arguments)}function O(e,n,t,r,a,o,i){try{var s=e[o](i),l=s.value}catch(c){return void t(c)}s.done?n(l):Promise.resolve(l).then(r,a)}var V=e=>{var n=Object(u.getUpdateEnvVarValuesPanelLabels)(Object(b.getResources)()),{environmentClient:t}=Object(a.useContext)(c.ApolloClientContext),[V,P]=Object(a.useState)(s.UpdateEnvVarValuesPanelSteps.connections),[S,y]=Object(a.useState)(new Map),[C,h]=Object(a.useState)(void 0),[j,D]=Object(a.useState)(!1),[x,w]=Object(a.useState)(void 0),{connectionTypes:U,loadConnectionTypesErrorMessage:B,loadConnectionsErrorMessage:k,isLoadingConnections:R,isLoadingConnectionTypes:L,onRefreshConnections:T,onChangeConnectionSelection:M}=Object(l.useConnectionReferenceBehavior)(t,y,x,w,n.Errors.StandardErrorMessages,{environmentVariableDefinitions:C,setEnvironmentVariableDefinitions:h},!0),F={hasCloseButton:!0,closeButtonAriaLabel:n.close,type:r.PanelType.medium,headerText:n.title},I={title:n.DismissPanel.title,confirmButtonText:n.DismissPanel.confirmButtonText,cancelButtonText:n.DismissPanel.cancelButtonText};Object(a.useEffect)(()=>{(function(){var n,t=(n=function*(){D(!0);var n=yield g.MetadataClientInstance.getInstance().fetchList("EnvironmentVariableDefinition",void 0);if(n){for(var t=n.data;n.hasNext&&(yield n.next());)t=t.concat(n.data);var r=[];t.forEach(e=>{Object(f.isDataSourceEnvironmentVariableDefinition)(e)&&!Object(f.isDataSourceChildEnvironmentVariableDefinition)(e)&&r.push(e)});var a=yield Object(v.getEnvironmentVariableValuesForDefinitions)(yield g.MetadataClientInstance.getInstance(),r),o=Object(p.convertEnvironmentVariablesToUserSelection)(e.envVariablesNeedUpdate,a,r),i=Object(m.getConnectionReferencesFromDataSourceEnvironmentVariables)(o,[]);h(o),w(i),D(!1),null!=i&&i.length||P(s.UpdateEnvVarValuesPanelSteps.environmentVariables)}else D(!1)},function(){var e=this,t=arguments;return new Promise((function(r,a){var o=n.apply(e,t);function i(e){O(o,r,a,i,s,"next",e)}function s(e){O(o,r,a,i,s,"throw",e)}i(void 0)}))});return function(){return t.apply(this,arguments)}})()()},[]);var A=[Object(i.useConnectionReferencesPanel)(F,n,x,S,U,M,T,B||k,R||L||j),Object(d.useEnvironmentVariablesPanel)(F,n,C,h,e.updateEnvVariables,e.onDismissPanel)];return a.createElement(o.MultistepPanel,E({customWidth:void 0,dismissOnEscape:void 0,isBlocking:!0,isHiddenOnDismiss:!0,onDismissed:void 0,onLightDismissClick:void 0,isLightDismiss:!1,onOuterClick:void 0,isOpen:void 0},e.defaultPanelProps,{onDismiss:()=>{e.onDismissPanel()},showDismissDialog:!0,dismissDialog:I,panelsListProps:A,panelOpenIndex:V,setPanelOpenIndex:P,hideLeftHeaderBackButton:V==s.UpdateEnvVarValuesPanelSteps.connections||V==s.UpdateEnvVarValuesPanelSteps.environmentVariables&&(!x||!x.length),onLeftHeaderBackButtonClicked:e=>e-1}))}},6694:function(e,n,t){"use strict";t.r(n),t.d(n,"useConnectionReferencesPanel",(function(){return g}));var r=t(245),a=t.n(r),o=t(1697),i=t(1201),s=t(217),l=t(1106),c=t(6695),u=t(6701),d=t(6706),p=t(6707),v=t(6709);function f(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function m(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?f(Object(t),!0).forEach((function(n){b(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):f(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function b(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function g(e,n,t,f,b,g,E,O,V){var P,S,{currentEnvironment:y}=Object(r.useContext)(l.EnvironmentContext),[C,h]=Object(r.useState)(),[j,D]=a.a.useState(!1);(O||C)&&(P={messageBarProps:{messageBarType:o.MessageBarType.error,dismissButtonAriaLabel:n.close},onRenderBody:()=>a.a.createElement("div",null,O&&a.a.createElement("div",null,O),C&&a.a.createElement("div",null,C))}),(V||j)&&(S={spinnerProps:{size:i.SpinnerSize.large,label:n.loading,ariaLabel:n.loading,ariaLive:"polite",role:"alert"}});var x=m({currentStep:p.FriendlyUpdateEnvVarValuesPanelSteps.get(d.UpdateEnvVarValuesPanelSteps.connections)},Object(p.getConnectionReferencesTelemetryData)(t,f));return m(m({},e),{},{messageBar:P,children:a.a.createElement(c.MultiConnectionsPicker,{setErrorMessage:h,connectionReferences:t,connections:f,connectionTypes:b,onChangeConnectionSelection:g,onRefreshConnections:E,telemetryScope:p.SolutionEventScope,environmentName:null==y?void 0:y.name,setIsLoadingConnectionReferencesFlowWidget:D}),className:v.panelContentStyles.panelStyles,styles:{content:{display:"flex",width:"100%"},contentInner:{display:"flex"},scrollableContent:{display:"flex",padding:"0px 24px 24px 24px"}},loadingOverlay:S,footerButtons:[{primary:!0,navigateableOnClick:()=>{var e=d.UpdateEnvVarValuesPanelSteps.environmentVariables;return Object(s.trackUserActionClickButton)(p.SolutionEventScope,p.SolutionEventNames.GoForward,m(m({},x),{},{nextStep:p.FriendlyUpdateEnvVarValuesPanelSteps.get(e)})),e},disabled:!Object(u.areAllConnectionsSelected)(t),ariaLabel:n.next,text:n.next},{ariaLabel:n.cancel,text:n.cancel,navigateableOnClick:(e,n)=>(n(),null)}]})}},6706:function(e,n,t){"use strict";var r;t.r(n),t.d(n,"UpdateEnvVarValuesPanelSteps",(function(){return r})),function(e){e[e.connections=0]="connections",e[e.environmentVariables=1]="environmentVariables"}(r||(r={}))},6707:function(e,n,t){"use strict";t.r(n),t.d(n,"SolutionEventNames",(function(){return o})),t.d(n,"SolutionEventScope",(function(){return i})),t.d(n,"FriendlyUpdateEnvVarValuesPanelSteps",(function(){return s})),t.d(n,"FriendlyUpdateConRefsPanelSteps",(function(){return l})),t.d(n,"getConnectionReferencesTelemetryData",(function(){return c})),t.d(n,"getEnvironmentVariableTelemetryData",(function(){return u}));var r=t(6706),a=t(6708),o={Dismiss:"importPanel/dismiss",GoBack:"importPanel/goBack",GoForward:"importPanel/GoForward",RefreshConnections:"importPanel/refreshConnections"},i="powerappsportal/solution",s=new Map([[r.UpdateEnvVarValuesPanelSteps.connections,"connections"],[r.UpdateEnvVarValuesPanelSteps.environmentVariables,"environmentVariables"]]),l=new Map([[a.UpdateConRefsPanelSteps.conRefs,"connectionReferences"]]);function c(e,n){return{connectionReferences:null==e?void 0:e.map(e=>{var t;return{connectorId:e.connectorid,availableConnectionsLength:null==n||null===(t=n.get(e.connectorid))||void 0===t?void 0:t.length}})}}function u(e){return{environmentVariableDefinitionsLength:null==e?void 0:e.length}}},6708:function(e,n,t){"use strict";var r;t.r(n),t.d(n,"UpdateConRefsPanelSteps",(function(){return r})),function(e){e[e.conRefs=0]="conRefs"}(r||(r={}))},6709:function(e,n,t){"use strict";t.r(n),t.d(n,"panelContentStyles",(function(){return a}));var r=t(719),a=Object(r.mergeStyleSets)({panelStyles:{selectors:{"& .ba-Panel-headerContainer":{padding:"16px 24px 24px"},"& .ba-Panel-content":{display:"flex",flexDirection:"column",width:"100%"}}}})},6713:function(e,n,t){"use strict";function r(e){return{close:e.Common.close,next:e.Common.next,saveClose:e.Model.Solutions.UpdateEnvVarValuesPanel.saveClose,cancel:e.Common.Save.cancel,title:e.Model.Solutions.UpdateEnvVarValuesPanel.title,loading:e.Model.Solutions.UpdateEnvVarValuesPanel.loading,saving:e.Model.Solutions.UpdateEnvVarValuesPanel.saving,DismissPanel:{title:e.Common.DismissDialog.title,confirmButtonText:e.Common.DismissDialog.confirmButtonText,cancelButtonText:e.Common.DismissDialog.cancelButtonText},Errors:{StandardErrorMessages:{authenticationError:e.Common.StandardErrorMessages.authenticationError,authorizationError:e.Common.StandardErrorMessages.authorizationError,serverResponseCodeError:e.Common.StandardErrorMessages.serverResponseCodeError,unknownErrorType:e.Common.StandardErrorMessages.unknownErrorType},requestFailed:e.Common.Request.Failed}}}t.r(n),t.d(n,"getUpdateEnvVarValuesPanelLabels",(function(){return r}))},6714:function(e,n,t){"use strict";t.r(n),t.d(n,"useEnvironmentVariablesPanel",(function(){return f}));var r=t(245),a=t(217),o=t(6703),i=t(6715),s=t(6753),l=t(6707),c=t(6706),u=t(1201);function d(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function p(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?d(Object(t),!0).forEach((function(n){v(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):d(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function v(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function f(e,n,t,d,v,f){var b,g=p({currentStep:l.FriendlyUpdateEnvVarValuesPanelSteps.get(c.UpdateEnvVarValuesPanelSteps.environmentVariables)},Object(l.getEnvironmentVariableTelemetryData)(t)),[E,O]=r.useState(!1);return E&&(b={spinnerProps:{size:u.SpinnerSize.large,label:n.loading,ariaLabel:n.loading,ariaLive:"polite",role:"alert"}}),p(p({},e),{},{children:r.createElement(i.MultiEnvironmentVariablesPicker,{environmentVariableDefinitions:t,onUpdateEnvironmentVariableDefinitions:d,hideHeader:!0}),loadingOverlay:b,footerButtons:[{primary:!0,navigateableOnClick:(e,n)=>{Object(a.trackUserActionClickButton)(l.SolutionEventScope,l.SolutionEventNames.GoForward,p({},g));var r=[];t.forEach(e=>{Object(o.isPickerParentConnectorEnvironmentVariableDefinition)(e)&&e.childVariables.forEach(e=>{m(e,r)}),m(e,r)}),O(!0);var i=v(r);return i||(i=Promise.resolve()),i.then(()=>{O(!1),f()}),null},disabled:!Object(s.areAllEnvironmentVariablesValid)(t)||E,ariaLabel:n.saveClose,text:n.saveClose},{ariaLabel:n.cancel,text:n.cancel,navigateableOnClick:(e,n)=>(n(),null)}]})}function m(e,n){!e.preventUpdates&&e.userSelectedValue&&n.push({value:e.userSelectedValue.value,environmentVariableDefinitionId:e.environmentvariabledefinitionid})}}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/220.b6de38cc.chunk.js.map