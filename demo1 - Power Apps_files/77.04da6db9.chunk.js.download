/*! For license information please see 77.04da6db9.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[77],{3824:function(e,n,t){"use strict";t.r(n),t.d(n,"planInfo",(function(){return h})),t.d(n,"getDefaultPlanContext",(function(){return w})),t.d(n,"ConnectedPlansProvider",(function(){return N})),t.d(n,"PlansProvider",(function(){return L})),t.d(n,"withPlans",(function(){return O}));var i=t(1088),s=t(3602),o=t(1141),r=t(216),a=t(1072),l=t(1144),m=t(922),p=t(1156),c=t(1201),u=t(245),d=t(3825),v=t(3826),P=t(3827),g=t(303);function b(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function f(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?b(Object(t),!0).forEach((function(n){y(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):b(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function y(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}var h=[{licenseSku:v.LicenseSku.P2,isTrial:!0}];function w(){return{activeUserPlans:[],expiredUserPlans:[],currentPlansMetaData:{canAccessPremiumAnalyticsReports:!1,canAccessOnPremGateway:!1,canAccessPremiumApis:!1,doesUserHaveActivePremiumPlan:!1,doesUserHaveExpiredPremiumPlan:!1,doesUserHaveExpiredP2Plan:!1,doesUserHaveActiveDevPlan:!1,doesUserHaveActiveP2Plan:!1,doesUserHaveO365Plan:!1,getEnabledP2AndDevPlansSkuAndTrialInfo:h,additionalAllowedPremiumApis:[]},requestP2PlanRenewal:()=>S,signUpForP2Trial:(e,n)=>S,markRenewTrialAsDismissed:()=>S,resetRenewTrialValues:()=>S,plansLoadingStatus:a.ProviderLoadingStatus.NotLoaded}}var S=new Promise(()=>{}),A=u.createContext(w());class N extends u.Component{constructor(e){super(e),this.syncPlansPollingPeriod=5e3,this.syncPlansPollingRetries=9e4/this.syncPlansPollingPeriod,this.timeoutId=void 0,this.requestP2PlanRenewal=()=>this.props.getUserSettings(d.UserSettingNames.renewTrial),this.signUpForP2Trial=(e,n)=>{var t="https://bap-rp/providers/Microsoft.BusinessAppPlatform/servicePlans?api-version=".concat(e),i={licenseid:n};return this.props.httpClient.post(t,i).then(e=>e.data)},this.getPlansFromRp=()=>{this.props.httpClient.get(function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return"https://pa-rp/api/providers/Microsoft.PowerApps/objectIds/".concat(e,"/plans?api-version=").concat(i.RpApiVersion,"&refreshCache=").concat(n)}(this.props.oid,!!this.state.syncPlans)).then(e=>{this._setPlanState(Object(P.filterPlansByExpiration)(e.data.value),Object(P.filterPlansByExpiration)(e.data.value,!0)),this.props.persistentStorage.setItemAsync("user-plans",e.data.value)}).catch(()=>{this.props.persistentStorage.removeItemAsync("user-plans")})};var n=this.props.enrollmentLoadingStatus===a.ProviderLoadingStatus.NotLoaded&&this.isDevOfferInQuery();this.state=f(f({},w()),{},{syncPlans:!!e.syncPlans,waitingForEnrollments:n})}componentWillUnmount(){clearTimeout(this.timeoutId)}componentDidMount(){this.props.hasUserEnrolledAtLeastOnce&&(this.props.persistentStorage.getItemAsync("user-plans").then(e=>{e&&this.state.plansLoadingStatus===a.ProviderLoadingStatus.NotLoaded&&this._setPlanState(Object(P.filterPlansByExpiration)(e),Object(P.filterPlansByExpiration)(e,!0))}),this.getPlansFromRp())}UNSAFE_componentWillReceiveProps(e){e.enrollmentLoadingStatus===a.ProviderLoadingStatus.Loaded&&this._setPlanState(e.enrollmentAndUserDetails.activeUserPlans,e.enrollmentAndUserDetails.expiredUserPlans,{waitingForEnrollments:this.state.waitingForEnrollments&&!e.enrollmentFullyLoaded})}render(){var e=f(f({},this.state),{},{requestP2PlanRenewal:this.requestP2PlanRenewal,signUpForP2Trial:this.signUpForP2Trial,resetRenewTrialValues:this.resetRenewTrialValues,markRenewTrialAsDismissed:this.markRenewTrialAsDismissed}),n=this.state.waitingForEnrollments||this.state.syncPlans?u.createElement(I,null):this.props.children;return u.createElement(A.Provider,{value:e},u.createElement(u.Fragment,null,n))}markRenewTrialAsDismissed(){return this.updateRenewTrialValues("true")}resetRenewTrialValues(){return this.updateRenewTrialValues("false")}waitToSyncPlans(){return!!this.props.syncPlans&&!this.userHasRequiredSyncPlans()}updateRenewTrialValues(e){return this.props.setUserSettings(d.UserSettingNames.renewTrial,"dismissed",e)}_setPlanState(e,n,t){var i=this.syncPlansPollingRetries&&this.waitToSyncPlans(),s=i?this.state.plansLoadingStatus:a.ProviderLoadingStatus.Loaded;this.setState(f({activeUserPlans:e,expiredUserPlans:n,currentPlansMetaData:{canAccessOnPremGateway:Object(P.canAccessOnPremGateway)(e),canAccessPremiumAnalyticsReports:Object(P.canAccessPremiumAnalyticsReports)(e),canAccessPremiumApis:Object(P.canAccessPremiumApis)(e),doesUserHaveActiveDevPlan:Object(P.doesUserHaveActiveDevPlan)(e),doesUserHaveActiveP2Plan:Object(P.doesUserHaveActiveP2Plan)(e),doesUserHaveActivePremiumPlan:Object(P.doesUserHaveActivePremiumPlan)(e),doesUserHaveExpiredPremiumPlan:Object(P.doesUserHaveExpiredPremiumPlan)(n),doesUserHaveExpiredP2Plan:Object(P.doesUserHaveExpiredP2Plan)(n),doesUserHaveO365Plan:Object(P.doesUserHaveO365Plan)(e),getEnabledP2AndDevPlansSkuAndTrialInfo:Object(P.getEnabledP2AndDevPlansSkuAndTrialInfo)(e),additionalAllowedPremiumApis:Object(P.getAdditionalAllowedPremiumApis)(e)},plansLoadingStatus:s,syncPlans:!!i},t)),i&&this.schedulePlanRefresh()}userHasRequiredSyncPlans(){return Object(P.doesUserHaveActiveP2Plan)(this.state.activeUserPlans)}schedulePlanRefresh(){this.timeoutId=this.syncPlansPollingRetries&&window.setTimeout(this.getPlansFromRp,this.syncPlansPollingPeriod),this.syncPlansPollingRetries--}isDevOfferInQuery(){try{return"dev"===new URLSearchParams(this.props.location.search).get("offer")}catch(e){return!1}}}var I=Object(m.translateService)("PlansProvider")(e=>u.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%"}},u.createElement("h4",{style:{maxWidth:"50%"}},e.t&&e.t("SyncPlans.message"),u.createElement(c.Spinner,{size:c.SpinnerSize.large,style:{marginTop:"10px"}})))),L=Object(p.withPersistentStorage)(Object(g.withRouter)(Object(s.withEnrollment)(Object(r.withUserInfo)(Object(o.withUserSettings)(Object(l.withHttpClient)(N)))))),O=Object(a.getWithProviderFunction)(A,"plansLoadingStatus")},3825:function(e,n,t){"use strict";var i;t.r(n),t.d(n,"UserSettingNames",(function(){return i})),function(e){e.renewTrial="renewTrial"}(i||(i={}))},3826:function(e,n,t){"use strict";t.r(n),t.d(n,"LicenseSku",(function(){return i})),t.d(n,"UserPlanCapabilityStatus",(function(){return s}));var i={P1:"P1",P2:"P2",SeededO365:"SeededO365",SeededD365:"SeededD365",Dev:"Dev",Free:"Free"},s={Enabled:"Enabled",Disabled:"Disabled",Expired:"Expired"}},3827:function(e,n,t){"use strict";t.r(n),t.d(n,"doesUserHaveSpecificPlan",(function(){return o})),t.d(n,"canAccessOnPremGateway",(function(){return r})),t.d(n,"canAccessPremiumAnalyticsReports",(function(){return a})),t.d(n,"doesUserHaveActiveDevPlan",(function(){return l})),t.d(n,"doesUserHaveActiveP2Plan",(function(){return m})),t.d(n,"doesUserHaveActivePremiumPlan",(function(){return p})),t.d(n,"doesUserHaveExpiredPremiumPlan",(function(){return c})),t.d(n,"doesUserHaveExpiredP2Plan",(function(){return u})),t.d(n,"doesUserHaveO365Plan",(function(){return d})),t.d(n,"getEnabledP2AndDevPlansSkuAndTrialInfo",(function(){return v})),t.d(n,"filterPlansByExpiration",(function(){return P})),t.d(n,"canAccessPremiumApis",(function(){return g})),t.d(n,"getAdditionalAllowedPremiumApis",(function(){return b}));var i=t(3828),s=t(2812);function o(e,n){return e&&s.some(e,e=>e.properties.licenseSku===i.LicenseSku.P1||e.properties.licenseSku===i.LicenseSku.P2&&e.properties.capabilityStatus===n)}function r(e){return e&&s.some(e,e=>e.properties&&e.properties.policies&&e.properties.policies.accessOnPremGateway)}function a(e){return e&&s.some(e,e=>e.properties&&e.properties.policies&&e.properties.policies.canAccessPremiumAnalyticsReports)}function l(e){return e&&s.some(e,e=>e.properties.licenseSku===i.LicenseSku.Dev&&e.properties.capabilityStatus===i.UserPlanCapabilityStatus.Enabled)}function m(e){return e&&s.some(e,e=>e.properties.licenseSku===i.LicenseSku.P2&&e.properties.capabilityStatus===i.UserPlanCapabilityStatus.Enabled)}function p(e){return o(e,i.UserPlanCapabilityStatus.Enabled)}function c(e){return o(e,i.UserPlanCapabilityStatus.Expired)}function u(e){return e&&s.some(e,e=>e.properties.licenseSku===i.LicenseSku.P2&&e.properties.capabilityStatus===i.UserPlanCapabilityStatus.Expired)}function d(e){return e&&s.some(e,e=>e.properties.licenseSku===i.LicenseSku.SeededO365&&e.properties.capabilityStatus===i.UserPlanCapabilityStatus.Enabled)}function v(e){return e?e.filter(e=>e.properties&&(e.properties.licenseSku===i.LicenseSku.P2||e.properties.licenseSku===i.LicenseSku.Dev)&&e.properties.capabilityStatus===i.UserPlanCapabilityStatus.Enabled).map(e=>({licenseSku:e.properties.licenseSku,isTrial:e.properties.isTrial})):[]}function P(e,n){return n?e.filter(e=>e.properties.capabilityStatus===i.UserPlanCapabilityStatus.Expired):e.filter(e=>e.properties.capabilityStatus===i.UserPlanCapabilityStatus.Enabled)}function g(e){return e.some(e=>e.properties&&e.properties.policies&&e.properties.policies.accessPremiumApis)}function b(e){return e?e.filter(e=>e.properties&&e.properties.policies&&e.properties.policies.additionalAllowedPremiumApis).reduce((e,n)=>e.concat(n.properties.policies.additionalAllowedPremiumApis||[]),[]):[]}},3828:function(e,n,t){"use strict";t.r(n),t.d(n,"LicenseSku",(function(){return i})),t.d(n,"UserPlanCapabilityStatus",(function(){return s}));var i={P1:"P1",P2:"P2",SeededO365:"SeededO365",SeededD365:"SeededD365",Dev:"Dev",Free:"Free"},s={Enabled:"Enabled",Disabled:"Disabled",Expired:"Expired"}},3831:function(e,n,t){"use strict";var i,s;t.r(n),t.d(n,"AppPivotUrlStrings",(function(){return i})),t.d(n,"AppComponentLibraryManagementPivotUrlStrings",(function(){return s})),t.d(n,"RoutePaths",(function(){return o})),t.d(n,"FriendlyRouteNames",(function(){return r})),function(e){e.Apps="apps",e.ComponentLibraries="libraries"}(i||(i={})),function(e){e.Details="details",e.Versions="versions",e.Components="components"}(s||(s={}));var o={home:"/environments/:environmentName/home",appsList:"/environments/:environmentName/".concat(i.Apps),appComponentLibrariesList:"/environments/:environmentName/".concat(i.ComponentLibraries),appManagement:"/environments/:environmentName/apps/:apps/:manageTab",appComponentLibraryManagement:"/environments/:environmentName/".concat(i.ComponentLibraries,"/:appComponentLibraries/:manageTab"),connectionManagement:"/environments/:environmentName/connections/:apiId/:connectionId/:tabName",connectionsList:"/environments/:environmentName/connections",createNewConnection:"/environments/:environmentName/connections/available",dataIntegrationProjectsAction:"/environments/:environmentName/dataintegration/:dataflowId/:dataflowAction",dataIntegrationProjects:"/environments/:environmentName/dataintegration",newConnection:"/environments/:environmentName/connections/available/:tabName?",gateways:"/environments/:environmentName/gateways",gatewayClusters:"/environments/:environmentName/gatewayClusters",gatewaysManagement:"/environments/:environmentName/gateways/:gatewayId/:drillInTab?",gatewayRuns:"/environments/:environmentName/gateways/:gatewayId/runs",learn:"/environments/:environmentName/learn",refreshApps:"/environments/:environmentName/refreshApps",functionsList:"/environments/:environmentName/functions",templates:"/environments/:environmentName/templates",performance:"/environments/:environmentId/insights/:appId/:uniqueName/:origin/:readable/:type/",solutionsList:"/environments/:environmentName/solutions",solutionHistory:"/environments/:environmentName/history",solutionLayer:"/environments/:environmentName/solutions/:solutionId/solutioncomponent/:solutionComponentId/layers",entityComponentLayer:"/environments/:environmentName/solutions/:solutionId/:componentType/:solutionComponentId/layers",solutionSmartDiff:"/environments/:environmentName/solutions/:solutionId/solutioncomponent/:solutionComponentId/smartDiff/:solutionComponentTypeName/:selectedLayerIndex",solutionHistoryForSelectedSolution:"/environments/:environmentName/solutions/:solutionId/history",solutionOverviewForSelectedSolution:"/environments/:environmentName/solutions/:solutionId/overview",solutionComponentLayers:"/environments/:environmentName/solutions/:solutionId/overview/layers/:objectId",solutionDependencies:"/environments/:environmentName/solutions/:solutionId/overview/dependencies",solutionComponentsList:"/environments/:environmentName/solutions/:solutionId",solutionCheckerResultsList:"/environments/:environmentName/solutioncheckerresults/:solutionId/:createdOn",solutionCheckerResultsContainer:"/environments/:environmentName/solutions/:solutionId/overview/checkerResults",flows:"/environments/:environmentName/logicflows",flowPrefix:"/environments/:environmentName/flows",customApis:"/environments/:environmentName/customconnectors/:pageName?",importReplat:"/environments/:environmentId/entities/:namespaceId/importReplat",importReplatEntity:"/environments/:environmentId/entities/:namespaceId/importReplat/:entityId?",exportReplat:"/environments/:environmentId/entities/:namespaceId/exportReplat",exportReplatEntity:"/environments/:environmentId/entities/:namespaceId/exportReplat/:entityId?",oldSolutionRoutes:{solutionsList:"/environments/:environmentName/projects",solutionComponentsList:"/environments/:environmentName/projects/:solutionId",solutionCheckerResultsList:"/environments/:environmentName/projectcheckerresults/:solutionId/:createdOn",model:{solutionsList:"/environments/:environmentName/model/projects",solutionComponentsList:"/environments/:environmentName/model/projects/:solutionId",solutionCheckerResultsList:"/environments/:environmentName/model/projectcheckerresults/:solutionId/:createdOn"}},model:{home:"/environments/:environmentName/model/home",learn:"/environments/:environmentName/model/learn",appModulesList:"/environments/:environmentName/model/apps",solutionsList:"/environments/:environmentName/model/solutions",solutionComponentsList:"/environments/:environmentName/model/solutions/:solutionId",solutionCheckerResultsList:"/environments/:environmentName/model/solutioncheckerresults/:solutionId/:createdOn",flows:"/environments/:environmentName/model/logicflows",solutionAppManagement:"/environments/:environmentName/solutions/:solutionId/apps/:apps/:manageTab",dataIntegrationProjects:"/environments/:environmentName/model/dataintegration"},widget:{project:"/widget/environments/:environmentName/projects/:solutionId/(objects|overview)?/(entities|layers)?/:namespaceId?/:entityName?/:subComponentType?/:objectId?/(layers)?",projects:"/widget/environments/:environmentName/projects",connections:"/widget/environments/:environmentName/connections",connectionManagement:"/widget/environments/:environmentName/connections/:apiId/:connectionId/:tabName",gateways:"/widget/environments/:environmentName/gateways",gatewayManagement:"/widget/environments/:environmentName/gateways/:gatewayId/:drillInTab?",flowImport:"/widget/environments/:environmentName/flows/import",flowExport:"/widget/environments/:environmentName/flows/:flowName/export"},appSharing:{homeCanvasApp:"/environments/:environmentName/home/canvasApp/:apps/:manageTab",homeModelDrivenApp:"/environments/:environmentName/home/appModel/:apps/:manageTab",adminCanvasAppSharing:"/environments/:environmentName/testadminscopeapps/canvasApp/:apps/:manageTab",adminAppModelSharing:"/environments/:environmentName/testadminscopeapps/appModel/:apps/:manageTab",adminAppCanvasAppSharing:"/environments/:environmentName/powerapps/canvasApp/:apps/:manageTab",adminAppModelDrivenAppSharing:"/environments/:environmentName/powerapps/appModel/:apps/:manageTab"},powerPortalDetailsPage:"/environments/:environmentName/powerportals/:portalId/details",aiCreateEnvironment:"/environment/:environmentName/aibuilder/(build|models)/createEnvironment",aiCreateDatabase:"/environment/:environmentName/aibuilder/(build|models)/createDatabase",paCreateDatabase:"/environments/:environmentName/processadvisor/(create|start|processes|tasks|home)/addDatabase",entitiesAddSubcomponents:"/environments/:environmentId/solutions/:solutionId/entities/:namespaceId/:entityName/subcomponents/:objectId",solutionComponent:"/environments/:environmentName/solutions/:solutionId/(objects|overview)?/(entities|layers)?/:namespaceId?/:entityName?/:subComponentType?/:objectId?/(layers)?",search:"/environments/:environmentName/search",canvas:"/e/:environmentId/canvas",canvasRedirect:"/canvasRedirect"},r={apps:"Apps",connections:"Connections",gateways:"Gateways",learn:"Learn",notifications:"Notifications",home:"Home",solutions:"Solutions",templates:"Templates",modelHome:"ModelHome",modelLearn:"ModelLearn",appModules:"AppModules",modelNotifications:"ModelNotifications",modelSolutions:"ModelSolutions",modelFlows:"ModelFlows",modelPickLists:"ModelPickLists",modelDataIntegration:"ModelDataIntegration",flows:"Flows",dataIntegration:"DataIntegration",powerPortalDetailsPage:"PowerPortalDetailsPage"}}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/77.04da6db9.chunk.js.map