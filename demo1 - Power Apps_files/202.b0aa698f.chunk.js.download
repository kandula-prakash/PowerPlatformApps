/*! For license information please see 202.b0aa698f.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[202],{6435:function(e,n,r){"use strict";r.r(n),r.d(n,"useGetEnvironmentByHeaderLocationServerPolling",(function(){return c})),r.d(n,"useGetEnvironmentByHeaderLocationPolling",(function(){return v})),r.d(n,"useGetEnvironmentByName",(function(){return d})),r.d(n,"useGetAvailableEnvironments",(function(){return g}));var o=r(3152),t=r(217),i=r(245),a=r(3192),l=r(3197),s=r(3193),m=r(6436);function c(e,n,r,l){var c=arguments.length>4&&void 0!==arguments[4]&&arguments[4],v=s.TelemetryScenarioNames.teamsServerPollingCreateEnvironment,[u,d]=Object(i.useState)(),[g,y]=Object(i.useState)(""),{loading:E,data:p}=Object(o.useQuery)(m.environmentByLocationHeaderPollingQuery,{client:e||void 0,skip:c,variables:n,onCompleted:e=>{var n;u&&u.complete({environmentId:null==e||null===(n=e.environmentByLocationHeaderPolling)||void 0===n?void 0:n.id})},onError:e=>{if(u){var n=Object(a.getResponseMessageFromApolloError)(e,l);y(n),u.failure({error:n,clientError:e&&(null==e?void 0:e.message)})}}});return Object(i.useEffect)(()=>{E&&(y(""),d(Object(t.trackLoadScenario)(r,v)))},[E]),{loading:E,errorMessage:g,environment:null==p?void 0:p.environmentByLocationHeaderPolling}}function v(e,n,r,c){var v=arguments.length>4&&void 0!==arguments[4]&&arguments[4],u=arguments.length>5?arguments[5]:void 0,d=s.TelemetryScenarioNames.teamsPollingCreateEnvironment,[g,y]=Object(i.useState)(),[E,p]=Object(i.useState)(""),{loading:b,data:f}=Object(o.useQuery)(m.environmentByLocationHeaderQuery,{client:e||void 0,skip:v,variables:n,pollInterval:u?1e3*parseInt(u,10):l.DefaultPollTimeInMs,fetchPolicy:"no-cache",notifyOnNetworkStatusChange:!0,onCompleted:e=>{var n;g&&g.complete({environmentId:null==e||null===(n=e.environmentByLocationHeader)||void 0===n?void 0:n.environmentName})},onError:e=>{if(g){var n=Object(a.getResponseMessageFromApolloError)(e,c);p(n),e&&e.message&&e.message===s.supportedErrorMessages.networkError?g.completeWithError({error:n,clientError:e.message}):g.failure({error:n,clientError:e&&(null==e?void 0:e.message)})}}});return Object(i.useEffect)(()=>{b&&y(Object(t.trackLoadScenario)(r,d))},[b]),{loading:b,errorMessage:E,environmentName:null==f?void 0:f.environmentByLocationHeader}}var u="EnvironmentAccess";function d(e,n,r,l){var c=arguments.length>4&&void 0!==arguments[4]&&arguments[4],v=s.TelemetryScenarioNames.environmentByName,[d,g]=Object(i.useState)(),[y,E]=Object(i.useState)(""),{loading:p,data:b}=Object(o.useQuery)(m.environmentByNameQuery,{client:e||void 0,skip:c,variables:n,onCompleted:e=>{var n;d&&d.complete({environmentId:null==e||null===(n=e.environmentByName)||void 0===n?void 0:n.id})},onError:e=>{if(d){var n=Object(a.getResponseMessageFromApolloError)(e,l),{code:r}=Object(a.getCleanObjectFromGraphQlError)(e.graphQLErrors).data.error;E(n),r===u&&d.completeWithError({error:n,clientError:e&&(null==e?void 0:e.message)}),e&&e.message&&e.message===s.supportedErrorMessages.networkError?d.completeWithError({error:n,clientError:e.message}):d.failure({error:n,clientError:e&&(null==e?void 0:e.message)})}}});return Object(i.useEffect)(()=>{p&&g(Object(t.trackLoadScenario)(r,v))},[p]),{loading:p,errorMessage:y,environment:null==b?void 0:b.environmentByName}}function g(e,n,r){var l=s.TelemetryScenarioNames.environmentByName,[c,v]=Object(i.useState)(),[u,d]=Object(i.useState)(""),{loading:g,data:y}=Object(o.useQuery)(m.availableEnvironmentsQuery,{client:e||void 0,onCompleted:e=>{var n;c&&c.complete({environments:null==e||null===(n=e.availableEnvironments)||void 0===n?void 0:n.length})},onError:e=>{if(c){var n=Object(a.getResponseMessageFromApolloError)(e,r);d(n),e&&e.message&&e.message===s.supportedErrorMessages.networkError?c.completeWithError({error:n,clientError:e.message}):c.failure({error:n,clientError:e&&(null==e?void 0:e.message)})}}});return Object(i.useEffect)(()=>{g&&v(Object(t.trackLoadScenario)(n,l))},[g]),{loading:g,errorMessage:u,environments:null==y?void 0:y.availableEnvironments}}},6436:function(e,n,r){"use strict";r.r(n),r.d(n,"environmentByLocationHeaderPollingQuery",(function(){return c})),r.d(n,"environmentByLocationHeaderQuery",(function(){return v})),r.d(n,"environmentByNameQuery",(function(){return u})),r.d(n,"availableEnvironmentsQuery",(function(){return d}));var o,t,i,a,l=r(3128),s=r.n(l);function m(e,n){return n||(n=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(n)}}))}var c=s()(o||(o=m(["\n  query environmentByLocationHeaderPolling(\n    $locationHeader: String!\n    $environmentName: String!\n    $pollingRetryTime: String\n  ) {\n    environmentByLocationHeaderPolling(\n      locationHeader: $locationHeader\n      environmentName: $environmentName\n      pollingRetryTime: $pollingRetryTime\n    ) {\n      id\n      name\n      isEnvironmentPollingCancelled\n      location\n      provisioningState\n    }\n  }\n"]))),v=s()(t||(t=m(["\n  query environmentByLocationHeader($locationHeader: String!) {\n    environmentByLocationHeader(locationHeader: $locationHeader) {\n      environmentName\n    }\n  }\n"]))),u=s()(i||(i=m(["\n  query environmentByName($environmentName: String!) {\n    environmentByName(environmentName: $environmentName) {\n      id\n      name\n      location\n      provisioningState\n    }\n  }\n"]))),d=s()(a||(a=m(["\n  query availableEnvironmentsList {\n    availableEnvironments {\n      id\n      displayName\n      orgUrl\n    }\n  }\n"])))}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/202.b0aa698f.chunk.js.map