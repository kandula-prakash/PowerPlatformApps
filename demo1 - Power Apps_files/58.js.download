(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/58.js?v=1.4.3886-master"]={begin:performance.now()},(window.__wpJsonpUci=window.__wpJsonpUci||[]).push([[58],{"/QjR":function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const o="[role='treeitem'][tabindex]";class r{constructor(e){this._paneId=e}_getSitemapPane(){return document.getElementById(this._paneId)}_getAllSitemapItems(){const e=this._getSitemapPane();return e?e.querySelectorAll(o):null}_getCurrentIndex(e,t){if(!t)return-1;for(let n=0;n<t.length;n++)if(t[n]===e)return n;return-1}_getItemAtIndex(e,t){return t&&e>=0&&e<=t.length?t[e]:null}_modulo(e,t){return(e%t+t)%t}getNextSibling(e){if(!e)return null;const t=this._getAllSitemapItems(),n=this._getCurrentIndex(e,t);return n>=0?this._getItemAtIndex(this._modulo(n+1,t.length),t):null}getPrevSibling(e){if(!e)return null;const t=this._getAllSitemapItems(),n=this._getCurrentIndex(e,t);return n>=0?this._getItemAtIndex(this._modulo(n-1,t.length),t):null}getFirstItemOfEntityNavBar(){const e=this._getAllSitemapItems();return this._getItemAtIndex(0,e)}getLastItemofEntityNavBar(){const e=this._getAllSitemapItems();return this._getItemAtIndex(e.length-1,e)}}},"0U+K":function(e,t,n){"use strict";function o(e,t){const n=function(e){return[e.colors.BaseColor.Blue.Blue3,e.colors.BaseColor.Orange.Orange5,e.colors.BaseColor.Teal.Teal5,e.colors.BaseColor.Clay.Clay4,e.colors.BaseColor.Violet.Violet4,e.colors.BaseColor.Blue.Blue4,e.colors.BaseColor.Red.Red5,e.colors.BaseColor.Yellow.Yellow5,e.colors.BaseColor.Pink.Pink5,e.colors.BaseColor.Green.Green5,e.colors.BaseColor.Purple.Purple2,e.colors.BaseColor.Blue.Blue5,e.colors.BaseColor.Clay.Clay5]}(t);return n[e%n.length]}function r(e){let t="";if(e)for(let n=e.split(" "),o=0;o<n.length&&t.length<2;o++)if(n[o].length>0){const e=n[o].charCodeAt(0);if(!(e>=97&&e<=122||e>=65&&e<=90)){t+=n[o].charAt(0);break}t+=n[o].charAt(0)}return t}n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return r}))},"3mNF":function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var o=n("huli"),r=n("3rse"),s=n("cz9j");function i(e){const t=e.target;switch(Object(s.e)(e.nativeEvent)){case r.a.DownArrow:const n=t.nextElementSibling;return n&&n.focus(),!0;case r.a.UpArrow:const o=t.previousElementSibling;return o&&o.focus(),!0;case r.a.Tab:return e.preventDefault(),!0;case r.a.Enter:return t.click(),!1;case r.a.Escape:return!1;default:return!0}}function a(e){requestAnimationFrame(()=>{if(!e)return;const t=o.findDOMNode(e);t&&t.firstElementChild&&t.firstElementChild.focus()})}},"46jN":function(e,t,n){"use strict";n.d(t,"e",(function(){return o})),n.d(t,"p",(function(){return r})),n.d(t,"o",(function(){return s})),n.d(t,"j",(function(){return i})),n.d(t,"n",(function(){return a})),n.d(t,"r",(function(){return l})),n.d(t,"m",(function(){return c})),n.d(t,"h",(function(){return u})),n.d(t,"q",(function(){return p})),n.d(t,"s",(function(){return d})),n.d(t,"d",(function(){return h})),n.d(t,"c",(function(){return b})),n.d(t,"b",(function(){return y})),n.d(t,"t",(function(){return m})),n.d(t,"a",(function(){return f})),n.d(t,"i",(function(){return g})),n.d(t,"g",(function(){return S})),n.d(t,"f",(function(){return v})),n.d(t,"l",(function(){return w})),n.d(t,"k",(function(){return I})),n.d(t,"u",(function(){return C}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const o="Web.NavBar.Home_Title",r="Web.NavBar.Search_Title",s="Web.NavBar.Relationship_Assistant_Caption",i="Web.NavBar.Notification_Center_Caption",a="Web.NavBar.Quick_Create_Menu_Caption",l="Web.NavBar.Start_Task_Flow_Caption",c="Web.NavBar.Offline_Status_Caption",u="Web.NavBar.Immersive_Skype_Caption",p="Web.NavBar.Settings_Caption",d="Web.NavBar.User_Information_Caption",h="Web.NavBar.Help_Title",b="Web.NavBar.Go_Back",y="Web.NavBar.Feedback_Caption",m="Web.NavBar.SiteMap",f="Web.NavBar.AdvancedFind_Title",g="Monitor.Monitor.Label",S="Web.NavBar.Home_Title",v="Web.NavBar.Home_Desc",w="Web.NavBar.Notification_Center_New_Notification_Desc",I="Web.NavBar.Notification_Center_New_Notifications_Desc",C=[o,r,s,i,a,l,c,"Web.NavBar.See_Welcome_Screen_Caption",u,p,d,f,g,h,"Web.NavBar.Search_Title","Web.NavBar.Search_Desc","Web.NavBar.Settings_Title","Web.NavBar.Settings_Desc","Web.NavBar.Help_Title","Web.NavBar.Help_Desc",S,v,"Web.NavBar.Relationship_Assistant_Title","Web.NavBar.Relationship_Assistant_Desc","Web.NavBar.QuickCreateMenu_Title","Web.NavBar.QuickCreateMenu_Desc","Web.NavBar.TaskFlow_Title","Web.NavBar.TaskFlow_Desc","Web.NavBar.Notification_Center_Title","Web.NavBar.Notification_Center_Desc",w,I,"Web.NavBar.SeeWelcomeScreen_Title","Web.NavBar.SeeWelcomeScreen_Desc","Web.NavBar.ImmersiveSkype_Title","Web.NavBar.ImmersiveSkype_Desc","Web.NavBar.User_Information_Title","Web.NavBar.User_Information_Desc","Web.NavBar.OfflineStatus_Title","Web.NavBar.OfflineStatus_Desc",b,y,"Web.NavBar.AdvancedFind_Title","Web.NavBar.AdvancedFind_Desc","Web.NavBar.ModernAdvancedFind_Title","Web.NavBar.ModernAdvancedFind_Desc",m]},"7VeL":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var o=n("FoFY"),r=n("txA/");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function s(e,t){if(!t)return null;return Object(o.a)(e,t).tabs.length<r.E}},"9KYq":function(e,t,n){"use strict";n.d(t,"a",(function(){return R}));var o=n("mMyr"),r=n("q441"),s=n("/to1"),i=n("kXuq"),a=n("QBtP"),l=n("u+q+"),c=n("unFF"),u=n("YxC/"),p=n("EY5k"),d=n("ws6F"),h=n("wRZP"),b=n("N2HV"),y=n("Fn63"),m=n("IqkD"),f=n("nJrx"),g=n("ju1h"),S=n("GWSs");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const v=Object(f.a)(),w={width:"100%",height:"100%",justifyContent:"center",alignItems:"center",margin:"auto"},I={fontSize:"14px",height:21};function C(e,t){const n=t?"paddingRight":"paddingLeft";return{fontFamily:"CRM MDL2",fontSize:"14px",width:"16px",height:e.sizes.Measures.Measure150,display:"flex",alignItems:"center",[n]:5}}function O(e,t){const n={display:"block",cursor:"pointer",backgroundColor:"transparent",height:42,width:80,borderStyle:"none",flexShrink:0,":hover":{"> div":{backgroundColor:e.colors.BaseColor.White,boxShadow:"0px 4px 8px rgba(0,0,0,0.1)",borderRadius:"2px"}},padding:6,color:"#2165E4",fontWeight:400};return t&&Object.assign(n,t),n}class _ extends o.Component{constructor(e,t){super(e),this._onClickHandler=this._onClickHandler.bind(this),d.z.some(t=>!Object(u.c)(e.resourceStrings,t))&&e.retrieveResourceStrings(d.z)}_onClickHandler(e){if(this.props.isInFlyoutMode){this.context.toggleSiteMap()}this.props.openAppsDialog(),e.preventDefault(),e.stopPropagation()}render(){const e=Object(u.c)(this.props.resourceStrings,d.b),t=Object(u.c)(this.props.resourceStrings,d.a);return o.createElement(r.a,{id:v,style:O(this.props.theme,this.props.overwriteStyle),onClick:this._onClickHandler,accessibilityLabel:e,title:e,testhooks:{[g.o]:!0},key:"appButton",tabIndex:this.props.isHomeShown?-1:0},o.createElement(i.a,{style:w},o.createElement(s.a,{style:I,key:"title"},t),o.createElement(s.a,{style:C(this.props.theme,this.props.isRTL),key:"icon"},o.createElement(b.b,{type:this.props.isRTL?y.a.BackButtonWithoutBorder:y.a.Forward}))))}}_.contextType=a.b;const R=Object(l.a)((function(){const e=Object(u.h)();return t=>{const n=e(t,d.z);return{theme:Object(c.a)(t),resourceStrings:n,isRTL:Object(m.g)(t),isHomeShown:Object(S.c)(t)}}}),(function(e){return{retrieveResourceStrings:t=>e(Object(p.e)(t)),openAppsDialog:()=>e(Object(h.b)())}}),void 0,{forwardRef:!0})(_)},B9ov:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var o=n("d4He"),r=n("NjDY");function s(){return{type:"sitemap.navigatetooffice.async",execute(e,t){const n=e.getState(),s=Object(r.J)(n),i=s?"OfficeWaffle.NavigateOfficePortal":"OfficeWaffle.NavigateOfficePortal.SiteWide";return t.EventManager.ReportComponentSuccess(i),e.dispatch(Object(o.a)(s||"https://go.microsoft.com/fwlink/?LinkID=246804"))}}}},DCyf:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var o=n("/leX"),r=n("xggx"),s=n("rcL5"),i=n("rvu9");let a=[];function l(){return function(e,t){const n=function(e,t){const n=Object(s.k)(e,2),a=Object(s.k)(e,1),l=1===n.panesState;return Object(r.b)(e).concat(Object(r.a)(e)).map(t=>{const r=t.sidePanelId;return{id:r,title:Object(i.e)(e,r),icon:Object(i.d)(e,r),isSelected:t.type!==o.b.Pane?1===t.option.sidePanelState&&(r===n.selectedPane||r===a.selectedPane):l&&r===n.selectedPane,position:t.option.sidePanelPosition,canBeClosed:t.option.canBeClosed}})}(e);if(a){if(n)if(Object.keys(n).length!==Object.keys(a).length)a=n;else for(const e in n)if(a[e]!==n[e]){a=n;break}}else a=n;return a}}},GSS1:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return a}));var o=n("d8rx");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function r(e,t,n,r=!1){return{color:t?t.Components.Navigation.Rest.TextColor:e.colors.SiteMap.RefreshedGroupText,display:"flex",fontSize:e.fontSizes.Font100,fontFamily:e.fontFamilies.Weighted,fontWeight:e.sizes.FontWeights.Semibold,minHeight:e.sizes.Measures.Measure250,height:"auto",marginTop:e.sizes.Measures.Measure025,marginBottom:e.sizes.Measures.Measure025,alignItems:"center",justifyContent:"flex-start",[Object(o.h)(n)]:r?e.sizes.Measures.Measure325:e.sizes.Measures.Measure100,[Object(o.d)(n)]:e.sizes.Measures.Measure050}}function s(e,t,n,o,r){const s={flexGrow:0},i="1px solid "+(t?t.Components.Navigation.Rest.DividerColor:e.colors.SiteMap.CollapsedGroupSeparator);return n&&(s.marginBottom=e.sizes.Measures.Measure100),o&&(s.borderTop=i),r&&(s.borderBottom=i),s}function i(){return{listStyleType:"none",flexDirection:"column",flexShrink:0}}function a(){return{listStyleType:"none",flexDirection:"column",width:"270px"}}},HCHE:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function o(e){return e?"sitemap-entity-"+e.id:""}n.d(t,"a",(function(){return o}))},Oxat:function(e,t,n){"use strict";n.d(t,"a",(function(){return j}));var o=n("mMyr"),r=n("u+q+"),s=n("Afz2"),i=n("HCHE"),a=n("fTeK"),l=n("nJrx"),c=n("kFXL"),u=n("3cEW"),p=n("r0fD"),d=n("DCyf"),h=n("5X+N"),b=n("vYkK"),y=n("Wbnz"),m=n("2FbK");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const f=Object(l.a)();function g(e){const t={id:"CURRENT_PAGE",entityTypeName:null,title:e.currentPage.title,tooltip:e.currentPage.tooltip,icon:e.currentPage.icon,isSelected:e.isSelected,onClickHandler:()=>{var t;return null===(t=e.onSelectHandler)||void 0===t?void 0:t.call(e)}},n=Object(i.a)(t);return o.createElement(a.a,{key:f,entry:t,accessibilityRole:s.C,sitemapRowId:n,onKeyboardFocus:e.onKeyboardFocus})}g.displayName="SitemapCurrentPage";const S=Object(r.a)((function(){return e=>{const t=Object(m.b)(e),n=Object(b.b)(e,t);return{currentPage:y.a.FromStateItem(n,e)}}}))(g);var v=n("eytu"),w=n("N2HV"),I=n("Fn63"),C=n("YxC/"),O=n("LqfC"),_=n("hBbW"),R=n("IqkD"),A=n("lULv");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const M=Object(l.a)();function E(e){const{hasPaneSelected:t,panes:n}=function(e){let t=!1;const n=e.sidePanes.map(n=>{const r={id:M+n.id,entityTypeName:null,title:n.title,tooltip:n.title,icon:n.icon,isSelected:n.isSelected,onClickHandler:()=>e.selectSidePane(n.id,n.position),subActionDescriptor:n.canBeClosed&&{icon:{type:w.b,value:I.a.Close.toString()},onClickHandler:()=>{e.closeSidePane(n.id)},toolTip:String.format(e.isRTL?"{1} {0}":"{0} {1}",e.closeLabel,n.title||e.sidePanelLabel)}};n.isSelected&&(t=!0);const l=Object(i.a)(r);return o.createElement(a.a,{key:r.id,entry:r,accessibilityRole:s.C,sitemapRowId:l,onKeyboardFocus:e.onKeyboardFocus})});return{hasPaneSelected:t,panes:n}}(e);return e.sidePanes.length>0&&o.createElement(v.a,{key:"sitemap-pane-swicher",groupTitle:"Panes",showTitle:!1,showTopBorder:e.showBorder,showBottomBother:e.showBorder,needMarginBottom:!1},e.renderCurrentPage?o.createElement(S,Object.assign({isSelected:!t,onSelectHandler:e.selectSidePane},e)):null,n)}E.displayName="SitemapSidePane";const j=Object(r.a)((function(){const e=Object(d.a)();return t=>({sidePanes:e(t),isRTL:Object(R.g)(t),closeLabel:Object(C.b)(t,_.b.CLOSE_BUTTON_LABEL_ID),sidePanelLabel:Object(C.b)(t,O.q)})}),(function(e){return{selectSidePane:(t,n)=>{e(Object(u.b)()),t&&(e(Object(c.b)(t,n)),e(Object(p.a)(1,n)),Object(h.b)().then(n=>{e(n.setPanelOptions(t,{sidePanelState:1}))}))},closeSidePane:t=>{e(Object(u.b)()),e(Object(A.a)(t))}}}))(E)},PZ34:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var o=n("ruPX"),r=n("baQL");function s(e,t){return Object(o.a)(r.a,{},t,e)}},QfU7:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));function o(e,t=10){return e.recentItems&&e.recentItems.recentItems.sort((e,t)=>t.LastAccessed-e.LastAccessed).slice(0,t)}},TnQP:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var o,r;n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return r})),function(e){e.SessionSwitched="SessionSwitched",e.SessionClosed="SessionClosed",e.SessionCreated="SessionCreated",e.TabSwitched="TabSwitched",e.TabClosed="TabClosed",e.TabCreated="TabCreated"}(o||(o={})),function(e){e.After="After",e.Before="Before"}(r||(r={}))},WKLO:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var o=n("mMyr"),r=n("/to1"),s=n("Y7HL"),i=n("j+uO"),a=n("Afz2"),l=n("N2HV"),c=n("nInZ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function u(e){const t=e.icon;if(!t)return null;switch(t.type){case l.b:return o.createElement(l.b,{type:Number(t.value),style:e.styles,title:e.title,role:a.v});case s.a:return o.createElement(i.a,{source:t.value,style:e.styles,title:e.title,altText:e.title,highContrast:e.isHighContrast,role:a.v,useImgInIE:!0,onError:e.handleIconRenderFailure});case c.a:return o.createElement(c.a,{entityReference:t.entityReference,hasPrimaryImageField:t.hasPrimaryImageField,imageSrc:t.imageSrc,accessibilityHidden:!0,entityPrimaryField:t.entityPrimaryField,customEntityIcon:t.customEntityIcon,style:e.customStyles&&e.customStyles.entryImageStyle,title:e.title,role:a.v});case"CssIcon":const n=Object.assign(Object.assign({},t.value),e.styles);return o.createElement(r.a,{style:n,title:e.title}," ","role=",a.v);case null:return t.value}}},YcFo:function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return s}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const o="Recent_1A318AE1-712D-4D32-9E91-E936327E3256",r="Pinned_25F78F30-46FC-42CC-B7E6-DED04C375F62",s="Query_CD974DD2-2E43-406E-BFD7-A93FF8498E62"},eytu:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var o=n("mMyr"),r=n("u+q+"),s=n("Eqw3"),i=n("/to1"),a=n("unFF"),l=n("tJ+6"),c=n("GSS1"),u=n("Afz2"),p=n("xqqo"),d=n("IqkD"),h=n("sclX"),b=n("LzVy"),y=n("b8TU");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function m(e){const t=e.designLanguage,n=Object(c.a)(e.theme,t,e.needMarginBottom,e.showTopBorder,e.showBottomBother),r=e.groupTitle.replace(" ",""),a=e.isTablet?Object(c.d)():Object(c.c)();return o.createElement(s.a,{key:"SitemapGroupWrapper-item",style:n,accessibilityLabel:r,role:u.C},e.showTitle&&o.createElement(i.a,{key:"labelId",testhooks:{id:"sitemap-sitemapAreaGroup-"+r},style:Object(c.b)(e.theme,t,e.isRTL),role:u.v,semanticTag:"h3"}," ",e.groupTitle),e.narratorTitle&&o.createElement(i.a,{key:"descriptionId",id:e.descriptionId,style:{display:"none"},accessibilityLabel:e.narratorTitle||""}," ",e.narratorTitle||""," "),o.createElement(p.a,{key:"sitemap-sitemapAreaGroup-groupList",accessibilityLabel:e.groupTitle,style:a,role:u.i},e.children))}m.displayName="SitemapGroupWrapper";const f=Object(r.a)((function(){return e=>{const t=Object(a.a)(e),n=Object(l.b)(e)?Object(l.a)(e):null,o=Object(b.a)(e),r=Object(y.c)(e);return{theme:t,designLanguage:n,isRTL:Object(d.g)(e),isTablet:o===h.b.Native&&r>t.sizes.Breakpoints.DimensionS}}}))(m)},fTeK:function(e,t,n){"use strict";n.d(t,"a",(function(){return Te}));var o=n("mMyr"),r=n("u+q+"),s=n("/to1"),i=n("kXuq"),a=n("Eqw3"),l=n("Y7HL"),c=n("3rse"),u=n("unFF"),p=n("d6Hx"),d=n("N2HV"),h=n("D+Bz"),b=n("fWyz"),y=n("sZ+8"),m=n("RiHV"),f=n("q43A"),g=n("xqqo"),S=n("n/MI"),v=n("huli");const w={Disabled:"",Enabled:""};var I=n("j+uO"),C=n("q441"),O=n("nInZ"),_=n("YxC/"),R=n("oLPm"),A=n("IqkD"),M=n("2SCk"),E=n("d8rx");function j(e){const t=Object(u.a)(e);return{entryWrap:{flexGrow:1,overflowX:"hidden",alignItems:"center",alignSelf:"stretch"},entryIconStyle:{width:t.sizes.Measures.Measure150},entryImageStyle:{textAlign:"center",fontWeight:"bold",fontSize:t.sizes.Measures.Measure075,lineHeight:t.sizes.Measures.Measure150,fontFamily:t.fontFamilies.Normal,width:t.sizes.Measures.Measure150,height:t.sizes.Measures.Measure150,borderRadius:"50%",color:t.colors.BaseColor.White},entryTitleStyle:{width:"inherit",overflow:"hidden"},entrySubActionWrapStyle:{position:"relative",left:"0px",right:"0px",flexGrow:0,flexShrink:0},entrySubActionIconStyles:{fontSize:t.fontSizes.Font125},entrySubActionButtonStyle:{borderStyle:"none",backgroundColor:"transparent",color:t.colors.SiteMap.RefreshedBarItemIcon,alignItems:"center"}}}function F(e,t,n,o,r){const s=t?t.Components.Navigation.Rest.Hover.BackgroundColor:e.colors.SiteMap.RefreshedRow.Fill,i=t?t.Components.Navigation.Rest.Hover.TextColor:e.colors.SiteMap.RefreshedRow.Text,a=t?t.Components.CommandBar.Command.Hover.BackgroundColor:e.colors.BaseColor.Grey.Grey3;return{display:"flex",width:"100%",height:e.sizes.Measures.Measure250,justifyContent:"space-between",[Object(E.i)(o)]:8,[Object(E.e)(o)]:e.sizes.Measures.Measure100,boxSizing:"border-box",":hover":{backgroundColor:r?a:s,color:i,position:"relative",transition:"background-color 200ms",zIndex:1}}}function x(e,t,n,o){const r={width:"100%",display:"flex",alignItems:"center",cursor:"pointer",color:t?t.Components.Navigation.Rest.TextColor:e.colors.SiteMap.RefreshedRow.Text,backgroundColor:"transparent",flexDirection:"column",":focus":{outline:"initial"},":focus > :first-child":{outline:"1px dotted "+(t?t.Components.Navigation.Rest.Focus.BorderColor:"white")},":focus > :first-child > :first-child":{visibility:"visible"},":hover > :first-child > :first-child":{visibility:"visible"}};if(o&&o.isMouseOnRow){const n={":hover":{backgroundColor:t?t.Components.Navigation.Rest.Hover.BackgroundColor:e.colors.SiteMap.RefreshedRow.Fill,color:t?t.Components.Navigation.Rest.Hover.TextColor:e.colors.SiteMap.RefreshedRow.Text,position:"relative",transition:"background-color 200ms",zIndex:1}};return Object.assign(Object.assign({},r),n)}return r}function k(e,t){return{display:"inline-block",alignItems:"center",fontSize:"1rem",marginLeft:t?0:"8px",marginRight:t?"8px":0,fontFamily:e.fontFamilies.Regular,whiteSpace:"nowrap",overflowX:"hidden",textOverflow:"ellipsis"}}function B(e,t){const n=t.colors.SiteMap.EntityOfflineStatusIcon;return{fontFamily:"Dyn CRM Symbol, Segoe MDL2 Assets",textAlign:"center",lineHeight:"16px",marginLeft:"auto",width:t.sizes.SiteMap.EntityOfflineStatusIconWidth,color:e===y.a.Enabled?n.Enabled:n.Disabled,fontSize:t.fontSizes.SiteMapOfflineStatusIcon,flexShrink:0}}function L(e,t){return{display:"flex",paddingLeft:0,justifyContent:"space-between",height:e.sizes.Measures.Measure250,alignItems:"center",overflowX:"hidden",flex:"auto"}}var T=n("ws6F"),P=n("QBtP"),D=n("cz9j"),H=n("H4dV"),N=n("3cEW"),z=n("AVDU"),G=n("tJ+6"),W=n("ju1h");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class K extends o.Component{constructor(e,t){if(super(e),this._onSubActionClickHandler=this._onSubActionClickHandler.bind(this),this._onClickHandler=this._onClickHandler.bind(this),this._onMouseEnter=this._onMouseEnter.bind(this),this._onMouseLeave=this._onMouseLeave.bind(this),this._onSubActionButtonMouseEnter=this._onSubActionButtonMouseEnter.bind(this),this._onSubActionButtonMouseLeave=this._onSubActionButtonMouseLeave.bind(this),this.onKeyDownHandler=this.onKeyDownHandler.bind(this),this.onSubAtionKeyDownHandler=this.onSubAtionKeyDownHandler.bind(this),this._onFocus=this._onFocus.bind(this),this._onBlur=this._onBlur.bind(this),this._toggleSitemap=this._toggleSitemap.bind(this),this.state={isMouseOnRow:!1,isMouseOnButton:!1,isKeyboardFocused:!1},this._traceManager=t.TraceManager,!this._traceManager)throw new Error("TraceManager is null")}_toggleSitemap(){this.props.isSitemapInFlyout&&this.props.toggleSitemap()}_onClickHandler(e=null){e&&e.stopPropagation(),this.props.execute(this.props.entry.onClickHandler(!0,this._toggleSitemap,h.b.SiteMap,b.c))}_onMouseEnter(e=null){this.setState((e,t)=>Object.assign(Object.assign({},e),{isMouseOnRow:!0}))}_onMouseLeave(e=null){this.setState((e,t)=>Object.assign(Object.assign({},e),{isMouseOnRow:!1}))}_onFocus(e){this.setState({isKeyboardFocused:!0}),this.props.onKeyboardFocus&&this.props.onKeyboardFocus(this.props.sitemapRowId),e.preventDefault(),e.stopPropagation()}_onBlur(e){e.target!==v.findDOMNode(this._subButtonRef)&&this.setState({isKeyboardFocused:!1})}_onSubActionButtonMouseEnter(e=null){this.setState((e,t)=>Object.assign(Object.assign({},e),{isMouseOnButton:!0}))}_onSubActionButtonMouseLeave(e=null){this.setState((e,t)=>Object.assign(Object.assign({},e),{isMouseOnButton:!1}))}onKeyDownHandler(e){switch(Object(D.e)(e.nativeEvent)){case c.a.Space:e.stopPropagation(),e.preventDefault(),this._onSubActionClickHandler();break;case c.a.LeftArrow:case c.a.RightArrow:e.stopPropagation(),e.preventDefault();const t=v.findDOMNode(this._subButtonRef);t&&t.focus()}}onSubAtionKeyDownHandler(e){switch(Object(D.e)(e.nativeEvent)){case c.a.Enter:case c.a.Space:e.stopPropagation(),e.preventDefault(),this._onSubActionClickHandler();break;case c.a.LeftArrow:case c.a.RightArrow:e.stopPropagation(),e.preventDefault();const t=v.findDOMNode(this._itemRef);t&&t.focus()}}_onSubActionClickHandler(e=null){e&&e.stopPropagation();const t=this.props.entry.subActionDescriptor.onClickHandler;t&&(this.props.onSubActionClicked(),this.props.execute(t()))}render(){const{entry:e,theme:t,customStyles:n}=this.props;if(!e)return this._traceManager.getTracer(p.o).error("SubAreaDescriptor passed in to SitemapPinnableRow is null"),null;const r=n.entryWrap;let l,c=k(t,this.props.isRTL),u=!1;e instanceof S.a&&(c=Object.assign(Object.assign({},k(t,this.props.isRTL)),n.entryTitleStyle),u=!0,l=e.pinStatus);let d=e.title;const{subActionDescriptor:h}=e;if(void 0===l)d=h&&h.narratorTitle&&String.format(h.narratorTitle,e.title);else{const t=Object(_.c)(this.props.resourceStrings,l?T.p:T.A);d=String.format(t,e.title)}h&&h.subactionAccessibilityLabel&&(d=String.format(Object(_.c)(this.props.resourceStrings,T.c)||"{0}. {1}",d,h.subactionAccessibilityLabel));let b=null;h&&h.dropdownInfo&&(b=h.dropdownInfo.isOpened);const y=!H.a.getInstance().get_IsIOS()&&!H.a.getInstance().get_IsMacSafari(),f=this.props.designLanguage;return o.createElement(a.a,{key:"sitemap-sitemapAreaEntry-listItem",style:x(this.props.theme,f,0,this.state),onClick:this._onClickHandler,title:e.title,accessibilityLabel:d,role:this.props.role,dataText:e.title,tabIndex:-1,onKeyDown:this.onKeyDownHandler,onFocus:this._onFocus,onBlur:this._onBlur,id:this.props.sitemapRowId,testhooks:{id:this.props.sitemapRowId,[m.a.LearningPathDOMAttributeSuffix]:"sitemap-entity-"+e.id,[W.l]:!0},accessibilityExpanded:b,ref:e=>this._itemRef=e},o.createElement(i.a,{key:"sitemap-sitemapAreaEntry-flexBox",role:"presentation",onMouseEnter:this._onMouseEnter,onMouseLeave:this._onMouseLeave,style:this._addContrastRule(F(this.props.theme,f,this.state,this.props.isRTL,this.props.isFlyoutDropdown),e,this.props.theme,!0)},this._renderSubAction(this.props.theme,f,this.state),o.createElement(i.a,{key:"sitemap-sitemapAreaEntry-flexBox",style:L(this.props.theme,this.props.isRTL),accessibilityHidden:y},o.createElement(i.a,{key:"sitemap-sitemapAreaEntry-wrapIcon",style:r},o.createElement(s.a,{key:"sitemap-sitemapAreaEntry-text",style:c},e.title)),this._renderOfflineStatusIcon(u,e.title))))}_getIcon(e,t){if(e)switch(e.type){case d.b:return o.createElement(d.b,{type:Number(e.value),style:t});case l.a:return o.createElement(I.a,{source:e.value,style:t,highContrast:this.props.isHighContrast,useImgInIE:!0});case O.a:return o.createElement(O.a,{entityReference:e.entityReference,hasPrimaryImageField:e.hasPrimaryImageField,imageSrc:e.imageSrc,accessibilityHidden:!0,entityPrimaryField:e.entityPrimaryField,customEntityIcon:e.customEntityIcon,style:this.props.customStyles.entryImageStyle});case"CssIcon":const n=Object.assign(Object.assign({},e.value),t);return o.createElement(s.a,{style:n});case null:return e.value}}_renderOfflineStatusIcon(e,t){const n=this.props.entityOfflineStatus;if(n===y.a.NotAvailable||e)return null;let r="",i="";return n===y.a.Enabled?(r=Object(_.c)(this.props.resourceStrings,R.a),i=t+"-"+R.a):(r=Object(_.c)(this.props.resourceStrings,R.c),i=t+"-"+R.c),o.createElement(s.a,{key:"sitemap-offlineStatus-icon",style:B(n,this.props.theme),accessibilityLabel:r,testhooks:{id:i}},w[y.a[n]])}_renderSubAction(e,t,n){const r=this.props,{entry:a}=r;let l=null;const c=n&&n.isMouseOnButton,u=r.customStyles.entrySubActionIconStyles;let p=r.customStyles.entrySubActionButtonStyle;if(c){const n={":hover":{backgroundColor:t?t.Components.Navigation.Rest.BackgroundColor:e.colors.SiteMap.RefreshedPinUnpinFill}};p=Object.assign(Object.assign({},r.customStyles.entrySubActionButtonStyle),n)}return l=Object.assign(Object.assign({},r.customStyles.entrySubActionWrapStyle),{visibility:this.state.isKeyboardFocused?"visible":"hidden"}),a.subActionDescriptor?o.createElement(i.a,{style:l},o.createElement(C.a,{onClick:this._onSubActionClickHandler,style:p,onMouseEnter:this._onSubActionButtonMouseEnter,onMouseLeave:this._onSubActionButtonMouseLeave,onKeyDown:this.onSubAtionKeyDownHandler,ref:e=>this._subButtonRef=e,tabIndex:-1,testhooks:{id:"sitemap-area-entry-subaction-btn",[W.o]:!0,[W.m]:!1},accessibilityLabel:a.subActionDescriptor.narratorTitle,title:a.subActionDescriptor.narratorTitle},o.createElement(s.a,{style:u},this._renderSubActionIcon()))):o.createElement(i.a,{style:l},o.createElement(C.a,{style:p,onMouseEnter:this._onSubActionButtonMouseEnter,onMouseLeave:this._onSubActionButtonMouseLeave,tabIndex:-1},o.createElement(s.a,{style:u},this._renderSubActionIcon())))}_renderSubActionIcon(){const e=this.props,{entry:t}=e,n=function(e){let t="16px";return e.subActionDescriptor&&!e.subActionDescriptor.dropdownInfo||(t="12px"),{width:t,height:t,fontSize:t,paddingRight:"0px"}}(t);if(!t.subActionDescriptor){const e={type:d.b,value:"200"};return this._getIcon(e,n)}return this._getIcon(t.subActionDescriptor.icon,n)}_addContrastRule(e,t,n,o){const r=t.icon.type;if(!r||r!==l.a||this.props.isHighContrast)return e;const s=o?n.colors.NavBar.NavBar1.Fill.toString():n.colors.QuickLaunchBar;return Object(f.b)(e,s,o,n.colors.SiteMap.RefreshedGroupText)}}K.contextType=P.a;const q=Object(r.a)(()=>{let e=null,t=null;return(n,o)=>{const r=o?o.entry:null,s=r?Object(y.e)(n,r.entityTypeName):y.a.NotAvailable,i=!e||null===t,a=s===t,l=Object(z.m)(n),c=Object(G.b)(n)?Object(G.a)(n):null;return!i&&a||(t=s,e={theme:Object(u.a)(n),designLanguage:c,customStyles:j(n),entityOfflineStatus:s,resourceStrings:Object(_.e)(n,[R.a,R.c,T.o,T.p,T.A,T.c]),isRTL:Object(A.g)(n),isHighContrast:Object(M.n)(),isSitemapInFlyout:l}),e}},(function(e){return{execute:t=>{e(t)},toggleSitemap:()=>{e(Object(N.b)())}}}))(K);var U=n("Afz2"),Q=n("YcFo"),V=n("HCHE"),Y=n("Xi8U"),X=n("QfU7");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function Z(e,t,n=!1){const o=Object(Y.c)(e),r=o&&(o.isOpened||n)&&o.relativeToEntryId===t;if(r){let t=null;return o.relativeToEntryId===Q.c?t=Object(X.a)(e):o.relativeToEntryId===Q.a&&(t=Object(Y.e)(e)),{dropdownOpened:r,childItems:t}}return{dropdownOpened:r}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function J(e,t,n){const o=t&&t.length?t.length:null;let r=n?"auto":"0px";return n&&o&&(r=`calc(${o} * ${e.sizes.Measures.Measure250})`),{overflow:"hidden",height:r,width:"100%",paddingTop:1,paddingBottom:1,transitionProperty:"height",transitionDuration:"200ms",transitionTimingFunction:"cubic-bezier(0.16,0.67,0.12,0.99)",transitionDelay:"0ms"}}function $(e=!1){return{overflow:"hidden",listStyleType:"none",display:"block",width:"100%",paddingBottom:e&&"0.5rem","> li > *":{boxSizing:"border-box"}}}function ee(e=!1){return{width:"100%",display:"flex",cursor:"pointer",backgroundColor:"transparent",flexDirection:"column",paddingBottom:e&&"0.5rem",":focus":{outline:"initial"},":focus > :first-child":{outline:"1px dotted white"}}}function te(e){return{display:"inline-block",fontSize:"1rem",color:e.colors.BaseColor.Grey.Grey5,marginLeft:e.sizes.Measures.Measure100,marginRight:e.sizes.Measures.Measure100,marginTop:e.sizes.Measures.Measure050,fontFamily:e.fontFamilies.Regular}}var ne=n("GSS1"),oe=n("rhTL"),re=n("KOTC");function se(e,t,n,...r){return t instanceof Promise?o.createElement(re.a,{key:e,loader:()=>t,props:n,children:r}):(n.key=e,o.createElement(t,n,r))}var ie=n("hGVc");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class ae extends o.Component{constructor(e){super(e),this._listRef=o.createRef(),this._onItemSubActionClicked=this._onItemSubActionClicked.bind(this),this._onKeyboardBlur=this._onKeyboardBlur.bind(this),this._onKeyDownHandler=this._onKeyDownHandler.bind(this)}_renderSitemapDropdown(e){if(!e)return null;const{theme:t,accessibilityLabel:n,dropdownRecents:r}=this.props;if(!r||0===r.length){const e=this.props.relativeToEntryId===Q.c?Object(_.c)(this.props.resourceStrings,T.l):String.format(Object(_.c)(this.props.resourceStrings,T.k),Object(_.c)(this.props.resourceStrings,T.v));return o.createElement(o.Fragment,null,this.props.isFlyoutDropdown&&this._renderTitle(),o.createElement(a.a,{key:"noitemlist",style:ee(this.props.isFlyoutDropdown),role:U.v},o.createElement(s.a,{key:this.props.noItemsId,id:this.props.noItemsId,testhooks:{id:this.props.noItemsId},style:te(t),role:U.v},e)))}return o.createElement(o.Fragment,null,this.props.isFlyoutDropdown&&this._renderTitle(),
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t,n,o,r,...s){return se(e,t?n:o,r,s)}("sitemap-sitemapDropDown-"+this.props.parentEntryId,this.props.isFlyoutDropdown,Object(oe.c)().then(e=>e.FocusZone),g.a,{style:$(this.props.isFlyoutDropdown),role:this.props.listRole,onKeyDown:this.props.isFlyoutDropdown?this._onKeyDownHandler:void 0,onBlur:this.props.isFlyoutDropdown?this._onKeyboardBlur:void 0,shouldFocusOnMount:!0,direction:0,isCircularNavigation:!0,accessibilityLabel:n,componentRef:this._listRef,[ie.m]:n},this._renderRecentItems(r)))}_onKeyboardBlur(e){e.currentTarget.contains(e.relatedTarget)||this.props.onRequestCloseFlyout&&this.props.onRequestCloseFlyout()}_onKeyDownHandler(e){e.keyCode===c.a.Escape&&this.props.onRequestFocusToRoot&&this.props.onRequestFocusToRoot(!1),e.keyCode===c.a.Tab&&e.preventDefault()}_renderTitle(){const e=this.props.designLanguage;return o.createElement(s.a,{key:"labelId",style:Object(ne.b)(this.props.theme,e,this.props.isRTL,!0),role:U.v},this.props.accessibilityLabel)}_renderRecentItems(e){return e.map((e,t)=>{const n=Object(V.a)(e);return o.createElement(q,{key:t,entry:e,sitemapRowId:n,onKeyboardFocus:this.props.onKeyboardFocus,onSubActionClicked:this._onItemSubActionClicked,role:this.props.listItemRole,isFlyoutDropdown:this.props.isFlyoutDropdown})})}_onItemSubActionClicked(){const e=this.props.dropdownRecents&&this.props.dropdownRecents.length;this.props.isFlyoutDropdown&&(this.props.parentEntryId!==Q.a||e>1)?this._listRef.current.focus(!0):this.props.onRequestFocusToRoot&&this.props.onRequestFocusToRoot(!0)}render(){const e=this.props.dropdownOpened&&this.props.parentEntryId===this.props.relativeToEntryId;return this._renderSitemapDropdown(e)}}ae.displayName="SitemapRecentsDropdown";const le=Object(r.a)((function(){let e=null;return(t,n)=>{const{dropdownOpened:o,childItems:r}=Z(t,n.parentEntryId,n.isFlyoutDropdown),s=o&&n.parentEntryId,i=o&&r?r.map(e=>S.a.FromStateItem(e,!0,t)):[];if(e){if(!o&&!e.dropdownOpened)return e;if(s===e.relativeToEntryId&&i.length===e.dropdownRecents.length){if(i.every((t,n)=>t.title===e.dropdownRecents[n].title&&t.pinStatus===e.dropdownRecents[n].pinStatus))return e}}return e={theme:Object(u.a)(t),designLanguage:Object(G.b)(t)?Object(G.a)(t):null,isRTL:Object(A.g)(t),dropdownOpened:o,relativeToEntryId:s,dropdownRecents:i,resourceStrings:Object(_.e)(t,[T.v,T.l,T.k])},e}}))(ae);var ce=n("zVFX");function ue(e,t){const n=e?e.Components.Navigation.Rest.IconColor:t.colors.SiteMap.RefreshedBarItemIcon;return{entryWrap:{flexGrow:1,overflow:"hidden",alignItems:"center",alignSelf:"stretch"},entryIconStyle:{width:t.sizes.Measures.Measure150},entryImageStyle:{textAlign:"center",fontWeight:"bold",fontSize:t.sizes.Measures.Measure075,lineHeight:t.sizes.Measures.Measure150,fontFamily:t.fontFamilies.Normal,width:t.sizes.Measures.Measure150,height:t.sizes.Measures.Measure150,borderRadius:"50%",color:t.colors.BaseColor.White},entryTitleStyle:{width:"inherit",overflow:"hidden"},entrySubActionIconStyles:{fontSize:t.fontSizes.Font150},entrySubActionButtonStyle:{borderStyle:"none",backgroundColor:"transparent",color:n,alignItems:"center",paddingLeft:"0px",paddingRight:"0px"}}}function pe(e,t,n,o,r){let s=null;if(r||(s=o?t.sizes.Measures.Measure300:t.sizes.Measures.Measure250),n){return{display:"flex",width:"100%",height:s,minHeight:s,color:e?e.Components.Navigation.Selected.TextColor:t.colors.SiteMap.RefreshedGroupText,backgroundColor:e?e.Components.Navigation.Selected.BackgroundColor:t.colors.SiteMap.RefreshedRow.Fill,justifyContent:"space-between",":hover":{boxShadow:t.shadows.Shadow02,position:"relative",transition:"background-color 200ms"}}}const i=e?e.Components.Navigation.Rest.TextColor:t.colors.SiteMap.RefreshedGroupText,a=e?e.Components.Navigation.Rest.Hover.BackgroundColor:t.colors.SiteMap.RefreshedRow.Fill;return{display:"flex",width:"100%",height:s,minHeight:s,color:i,justifyContent:"space-between",":hover":{color:e?e.Components.Navigation.Rest.Hover.TextColor:i,backgroundColor:a,boxShadow:t.shadows.Shadow02,position:"relative",transition:"background-color 200ms"}}}function de(e,t){const n=e?e.Components.Navigation.Rest.Hover.TextColor:t.colors.SiteMap.RefreshedRow.Text,o=e?e.Components.Navigation.Rest.Hover.BackgroundColor:t.colors.BaseColor.White,r=e?e.Components.Navigation.Rest.Focus.BorderColor:t.colors.BaseColor.Grey.Grey5;return{width:"16rem",minHeight:"35px",display:"flex",alignItems:"flex-start",cursor:"pointer",color:n,backgroundColor:o,boxShadow:ce.a.shadows.Shadow01,flexDirection:"column",":focus":{outline:"none !important"},":focus > :first-child":{outline:"1px dotted "+r,outlineOffset:"-1px"}}}function he(e,t,n){const o={display:"flex",[Object(E.i)(t)]:e.sizes.Measures.Measure025,[Object(E.e)(t)]:0,justifyContent:"space-between",height:"100%",alignItems:"center",overflowX:"hidden",flex:"auto"};return n?Object.assign(Object.assign({},o),{[Object(E.d)(t)]:e.sizes.SmallMargin}):Object.assign(Object.assign({},o),{paddingLeft:t?0:e.sizes.Measures.Measure025,paddingRight:t?e.sizes.Measures.Measure025:0})}function be(e,t,n,o){const r=e?e.Components.Navigation.Selected.PivotColor:"#0066FF",s=e?"2px solid "+r:t.borders.Border06;return{display:"inline-block",height:t.sizes.Measures.Measure150,[Object(E.h)(n)]:"none",[Object(E.d)(n)]:"6.5px",borderLeft:s,borderRight:s,borderRadius:t.borders.Border06Radius,opacity:o?1:0,transition:"opacity 200ms;",backgroundColor:r}}function ye(e,t,n){if(n){const n=e?e.Components.Navigation.Selected.TextColor:t.colors.SiteMap.RefreshedGroupText,o=e?e.Components.Navigation.Selected.BackgroundColor:t.colors.SiteMap.RefreshedRow.Fill.toString();return{width:t.sizes.SiteMap.RefreshedWidthCollapsed,height:t.sizes.Measures.Measure250,cursor:"pointer",display:"flex",justifyContent:"center",alignItems:"center",color:n,backgroundColor:o,":hover":{boxShadow:t.shadows.Shadow02,position:"relative",transition:"background-color 200ms"}}}const o=e?e.Components.Navigation.Rest.TextColor:t.colors.SiteMap.RefreshedGroupText,r=e?e.Components.Navigation.Rest.Hover.BackgroundColor:t.colors.SiteMap.RefreshedRow.Fill.toString(),s=e?e.Components.Navigation.Rest.Hover.TextColor:t.colors.SiteMap.RefreshedGroupText;return{width:t.sizes.SiteMap.RefreshedWidthCollapsed,height:t.sizes.Measures.Measure250,cursor:"pointer",display:"flex",justifyContent:"center",alignItems:"center",color:o,backgroundColor:"transparent",":hover":{color:s,backgroundColor:r,boxShadow:t.shadows.Shadow02,position:"relative",transition:"background-color 200ms"}}}const me={display:"flex",width:"100%",justifyContent:"space-between"},fe={flexGrow:0,overflowX:"hidden",alignItems:"center",alignSelf:"stretch"};var ge=n("InN9"),Se=n("WKLO"),ve=n("9KYq"),we=n("GEbX"),Ie=n("Knfm"),Ce=n("SAYH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Oe=e=>{const t=o.useContext(P.b),n=o.useRef("");return o.useEffect(()=>{const e=Ce.a.newGuid().guid;n.current=`sitemap-sitemapDropDown-group-content${e.toString()}-narrator`},[]),o.createElement(i.a,{style:J(e.theme,e.sitemapGroupChildren,e.dropdownOpened)},e.dropdownOpened&&o.createElement(g.a,{key:"sitemap-sitemapGroupDropDownContent-"+e.sitemapGroup.title,style:$(),accessibilityLabel:e.accessibilityLabel,role:U.i},e.sitemapGroupChildren.map((r,s)=>{const i=Object(V.a)(r);return o.createElement(Te,{key:s,entry:r,toggleSiteMap:t.toggleSiteMap,describedByElementId:n.current,panelState:e.panelState,accessibilityRole:U.C,sitemapRowId:i,onPointerEnter:e.onRowPointerEnter,onPointerLeave:e.onRowPointerLeave,onKeyboardFocus:e.onKeyboardFocus})})))};Oe.displayName="SitemapGroupDropdownContent";const _e=Object(r.a)((function(){return(e,t)=>{const n=t.sitemapGroup,o=n.subActionDescriptor.dropdownInfo.isOpened,r=n.children;return{theme:Object(u.a)(e),dropdownOpened:o,sitemapGroupChildren:r}}}))(Oe);var Re=n("y2up"),Ae=n("TjDw"),Me=n("4TZ9"),Ee=n("/QjR"),je=n("JK2E"),Fe=n("wL2W"),xe=n("SFgX"),ke=n("rQPN"),Be=n("pulT");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class Le extends o.Component{constructor(e,t){super(e),this._tracer=null,this._subActionButtonRef=o.createRef(),this._flyoutRef=o.createRef(),this._tracer=t.TraceManager.getTracer(p.o),this.state={isKeyboardFocused:!1,forceHideTooltip:!1,childListFlyoutOpen:!1,icon:e.entry.icon},this._onKeyboardFocus=this._onKeyboardFocus.bind(this),this._onKeyboardBlur=this._onKeyboardBlur.bind(this),this._onPointerEnter=this._onPointerEnter.bind(this),this._onPointerLeave=this._onPointerLeave.bind(this),this._onKeyDownHandler=this._onKeyDownHandler.bind(this),this._onClickHandler=this._onClickHandler.bind(this),this._closeSitemapDuringNavigation=this._closeSitemapDuringNavigation.bind(this),this._onRequestFocusToRoot=this._onRequestFocusToRoot.bind(this),this._onRequestCloseFlyout=this._onRequestCloseFlyout.bind(this),this._onSubActionOnClickHanler=this._onSubActionOnClickHanler.bind(this),this._onSubActionOnKeydownHanler=this._onSubActionOnKeydownHanler.bind(this),this._handleClickEvent=this._handleClickEvent.bind(this)}_resetIcon(){this.setState({icon:this.props.entry.icon})}componentDidUpdate(e){e.entry.icon!==this.props.entry.icon&&this._resetIcon()}render(){return 0===this.props.panelState?this.props.oct2021CollapseMode?this._renderRowForCollapsedSitemapOct2021():this._renderRowForCollapsedSitemap():this._renderRowForExtendedSitemap()}_closeSitemapDuringNavigation(){(this.props.isSitemapInFlyout||this.props.shouldApplyModernMultiSessionLayout)&&this.props.toggleSiteMap()}_onClickHandler(e=null){e&&e.stopPropagation();const t=this._handleClickEvent();this.props.renderChildListInFyout?this.setState({childListFlyoutOpen:!this.state.childListFlyoutOpen},()=>{this.props.execute(t)}):this.props.execute(t)}_handleClickEvent(){return this.props.shouldApplyModernMultiSessionLayout&&this.props.focusedSessionId?this.props.entry.onClickHandler(this.props.focusedSessionId,()=>this._closeSitemapDuringNavigation(),h.b.SiteMapSubArea,ke.b):this.props.entry.onClickHandler(!0,()=>this._closeSitemapDuringNavigation(),h.b.SiteMapSubArea,b.b)}_onPointerEnter(){this.setState({forceHideTooltip:!1}),this.props.onPointerEnter&&this.props.onPointerEnter(this.props.entry.id)}_onPointerLeave(){this.props.onPointerLeave&&this.props.onPointerLeave(this.props.entry.id)}_onKeyboardFocus(e){this.setState({isKeyboardFocused:!0}),this.props.onKeyboardFocus&&this.props.onKeyboardFocus(this.props.sitemapRowId),e.stopPropagation()}_onKeyboardBlur(e){let t=!1;if(this.props.renderChildListInFyout){const n=v.findDOMNode(this._flyoutRef.current);t=n&&n.contains(e.relatedTarget)}this.setState({forceHideTooltip:!1,isKeyboardFocused:!1,childListFlyoutOpen:t})}_onRequestFocusToRoot(e){const t=document.getElementById(this.props.sitemapRowId);t&&t.focus(),this.setState({childListFlyoutOpen:e})}_onRequestCloseFlyout(){this.setState({childListFlyoutOpen:!1})}_onKeyDownHandler(e){var t;const n=e.target;switch(Object(D.e)(e.nativeEvent)){case c.a.Escape:this.setState({forceHideTooltip:!0}),this._onRequestFocusToRoot(!1);break;case c.a.RightArrow:case c.a.LeftArrow:e.stopPropagation()}if((this.props.renderAppsButton||(null===(t=this.props.entry.subActionDescriptor)||void 0===t?void 0:t.onClickHandler))&&(e.keyCode===c.a.RightArrow||e.keyCode===c.a.LeftArrow)){const t=v.findDOMNode(this._wrapperRef),n=v.findDOMNode(this._subActionButtonRef.current);if(t&&n){(e.target===t?n:t).focus()}}(this.props.hasChildList||this.props.entry.isSitemapGroup&&this.props.entry.children&&this.props.entry.children.length>0)&&(Object(E.g)(this.props.isRTL,e.keyCode)?this.props.entry.subActionDescriptor.dropdownInfo.isOpened?this._focusToFirstChild(n):this._onClickHandler():Object(E.f)(this.props.isRTL,e.keyCode)&&this.props.entry.subActionDescriptor.dropdownInfo.isOpened&&this._onClickHandler())}_focusToFirstChild(e){if(e){const t=e.querySelector(Ee.a);t&&t.focus()}}_renderRowForExtendedSitemap(){const{entry:e,describedByElementId:t,accessibilityRole:n}=this.props;if(!e)return this._tracer.error("SubAreaDescriptor passed in to SitemapRow is null",[{name:"panelState",value:this.props.panelState},{name:"describedByElementId",value:t}]),null;let r=e.title;const{subActionDescriptor:s}=e;s&&s.narratorTitle&&(r=String.format(s.narratorTitle,e.title));let i=null;return s&&s.dropdownInfo&&(i=s.dropdownInfo.isOpened),o.createElement(a.a,{key:"sitemap-sitemapAreaEntry-listItem",style:(l=this.props.designLanguage,c=this.props.theme,{width:"100%",display:"flex",alignItems:"center",cursor:"pointer",color:l?l.Components.Navigation.Selected.PivotColor:c.colors.SiteMap.RefreshedRow.Text,backgroundColor:"transparent",flexDirection:"column",":focus":{outline:"none !important"},":focus > :first-child":{outline:"1px dotted "+(l?l.Components.Navigation.Selected.Focus.BorderColor:c.colors.BaseColor.Grey.Grey5),outlineOffset:"-1px"}}),onClick:this._onClickHandler,accessibilityLabel:r,dataText:e.title,tabIndex:-1,title:e.tooltip||e.title,onKeyDown:this._onKeyDownHandler,onFocus:this._onKeyboardFocus,onBlur:this._onKeyboardBlur,id:this.props.sitemapRowId,testhooks:{id:this._getSitemapTestId(!1),[m.a.LearningPathDOMAttributeSuffix]:this._getSitemapLarningPatchAttribute(!1)},describedByElementId:e.subActionDescriptor&&e.subActionDescriptor.dropdownInfo&&this.props.dropDownMessageId,accessibilityExpanded:i,role:n,isSelected:this.props.entry.isSelected,ref:e=>this._wrapperRef=e},this._renderRowContent(),this._renderDropdown());var l,c}_renderRowContent(){const{entry:e,designLanguage:t,theme:n,customStyles:r}=this.props,a=r.entryWrap,l={color:(c=t)?c.Components.Navigation.Rest.IconColor:void 0,width:"16px",minWidth:"16px",fontFamily:"Dyn CRM Symbol, Segoe MDL2 Assets",textAlign:"center",fontSize:"16px",display:"flex",alignItems:"center",justifyContent:"center"};var c;const u=Object.assign({},l);let p=function(e,t){return{display:"inline-block",alignItems:"center",fontSize:"1rem",marginLeft:t.sizes.Measures.Measure100,marginRight:t.sizes.Measures.Measure100,fontFamily:t.fontFamilies.Regular,whiteSpace:"nowrap",overflowX:"hidden",textOverflow:"ellipsis"}}(0,n);e.isSitemapGroup&&(p=Object(ne.b)(n,this.props.designLanguage,this.props.isRTL));const d=!H.a.getInstance().get_IsIOS()&&!H.a.getInstance().get_IsMacSafari();return o.createElement(i.a,{key:"sitemap-sitemapAreaEntry-flexBox",role:"presentation",title:e.tooltip||e.title,style:this._addContrastRule(pe(this.props.designLanguage,this.props.theme,e.isSelected,this.props.isMultisessionApp,e.isSitemapGroup),this.props.theme,!0)},o.createElement(i.a,{key:"sitemap-sitemapAreaEntry-flexBoxInner",style:he(this.props.theme,this.props.isRTL,e.isSitemapGroup),accessibilityHidden:d},!e.isSitemapGroup&&o.createElement(i.a,{key:"sitemap-sitemapAreaEntry-inlineBlock",style:be(this.props.designLanguage,this.props.theme,this.props.isRTL,e.isSelected),accessibilityHidden:!0}),o.createElement(i.a,{key:"sitemap-sitemapAreaEntry-wrapIcon",style:a},!e.isSitemapGroup&&o.createElement(s.a,{key:"sitemap-sitemapAreaEntry-icon",className:"svgIcon",style:this._addContrastRule(u,this.props.theme),accessibilityHidden:!0},this._renderIcon()),o.createElement(s.a,{key:"sitemap-sitemapAreaEntry-text",style:p},e.title))),this._renderAppsButton(),this._renderSubAction())}_renderIcon(e=!0){const t={width:this.props.theme.sizes.Icon.MinWidth,height:this.props.theme.sizes.Icon.MinHeight,verticalAlign:"middle"};return this._getIcon(this.state.icon,t,e)}_getIcon(e,t,n=!0){if(!e)return;const o=n&&(this.props.entry.tooltip||this.props.entry.title);return Object(Se.a)({title:o,icon:e,styles:t,isHighContrast:this.props.isHighContrast,customStyles:this.props.customStyles,handleIconRenderFailure:()=>{this.setState({icon:{type:null,value:xe.b}}),this.props.handleIconRenderFailure(e,o,this.props.entry.id)}})}_renderSubAction(){var e;const{entry:t}=this.props;let n=null;const r=this.props.customStyles.entrySubActionIconStyles,a=this.props.customStyles.entrySubActionButtonStyle;if(!t.subActionDescriptor)return null;var l,c;n=Object.assign(Object.assign({},(this.props.designLanguage,l=this.props.theme,{marginLeft:(c=this.props.isRTL)?l.sizes.Measures.Measure100:"0px",marginRight:c?"0px":l.sizes.Measures.Measure100,position:"relative",flexGrow:0,flexShrink:0})),t.subActionDescriptor.icon.dynamicStyles);const u=o.createElement(i.a,{style:a,testhooks:{id:"sitemap-area-entry-subaction-btn"},title:t.subActionDescriptor.toolTip},o.createElement(s.a,{style:r},this._renderSubActionIcon()));return(null===(e=this.props.entry.subActionDescriptor)||void 0===e?void 0:e.onClickHandler)?o.createElement(i.a,{style:n,ref:this._subActionButtonRef,tabIndex:-1,role:je.b,accessibilityLabel:t.subActionDescriptor.toolTip,onClick:this._onSubActionOnClickHanler,onKeyDown:this._onSubActionOnKeydownHanler},u):o.createElement(i.a,{style:n,accessibilityHidden:!0},u)}_onSubActionOnClickHanler(e){e.preventDefault(),e.stopPropagation(),this.props.execute(this.props.entry.subActionDescriptor.onClickHandler())}_onSubActionOnKeydownHanler(e){e.keyCode!==c.a.Enter&&e.keyCode!==c.a.Space||this._onSubActionOnClickHanler(e)}_renderAppsButton(){return this.props.renderAppsButton?o.createElement(ve.a,{key:"sitemap-apps",overwriteStyle:{height:"100%",padding:0},ref:this._subActionButtonRef,isInFlyoutMode:this.props.isSitemapInFlyout}):null}_renderSubActionIcon(){const{entry:e}=this.props;let t=null;const n={width:"16px",height:"16px",fontSize:"16px"};if(!e.subActionDescriptor){const e={type:d.b,value:"200"};return this._getIcon(e,n)}return t=e.subActionDescriptor.icon,this._getIcon(t,n)}_renderDropdown(){const{entry:e}=this.props;return this.props.hasChildList?o.createElement(le,{key:"sitemap-sitemapAreaEntry-recentsDropdown",parentEntryId:e.id,accessibilityLabel:e.title.toString(),onKeyboardFocus:this.props.renderChildListInFyout?void 0:this.props.onKeyboardFocus,noItemsId:this.props.dropDownMessageId,onRequestFocusToRoot:this._onRequestFocusToRoot,onRequestCloseFlyout:this.props.renderChildListInFyout?this._onRequestCloseFlyout:void 0,isFlyoutDropdown:this.props.renderChildListInFyout,listRole:this.props.renderChildListInFyout?U.l:U.i,listItemRole:this.props.renderChildListInFyout?U.n:U.C}):e.isSitemapGroup&&e.children&&e.children.length>0?o.createElement(_e,{key:"sitemap-sitemapAreaEntry-recentsDropdown",accessibilityLabel:e.title.toString(),onKeyboardFocus:this.props.onKeyboardFocus,noItemsId:this.props.dropDownMessageId,sitemapGroup:e,panelState:this.props.panelState,onRowPointerEnter:this.props.onPointerEnter,onRowPointerLeave:this.props.onPointerLeave}):null}_renderRowForCollapsedSitemapOct2021(){const{entry:e,accessibilityRole:t}=this.props,n={root:{width:44,height:35,display:"flex",[Object(E.i)(this.props.isRTL)]:this.props.theme.sizes.Measures.Measure025,borderWidth:0},flexContainer:{justifyContent:"center"}},r={[W.i]:e.title,[W.e]:this._getSitemapTestId(!0),[m.a.LearningPathDOMAttributeName]:this._getSitemapLarningPatchAttribute(!0)};return o.createElement(o.Fragment,null,o.createElement(Re.a,{"aria-hidden":!0,content:!this.state.childListFlyoutOpen&&(e.tooltip||e.title),calloutProps:{gapSpace:0},directionalHint:Ae.a.leftCenter},o.createElement(Me.a,Object.assign({id:this.props.sitemapRowId,role:t,"aria-selected":this.props.entry.isSelected,"aria-label":e.title,tabIndex:-1,styles:n,onClick:this._onClickHandler,onKeyDown:this._onKeyDownHandler,onFocus:this._onKeyboardFocus,onBlur:this._onKeyboardBlur},r),this._renderCollapsedSitemapRowContent(e,!1))),this.state.childListFlyoutOpen&&this._renderItemFlyout())}_renderRowForCollapsedSitemap(){const{entry:e,accessibilityRole:t}=this.props;return o.createElement(a.a,{ref:e=>this._wrapperRef=e,key:"sitemap-sitemapAreaEntry-listItem",style:this._addContrastRule(ye(this.props.designLanguage,this.props.theme,this.props.entry.isSelected),this.props.theme,!0),onClick:this._onClickHandler,accessibilityLabel:e.title,dataText:e.title,testhooks:{id:this._getSitemapTestId(!0),[m.a.LearningPathDOMAttributeSuffix]:this._getSitemapLarningPatchAttribute(!0)},id:this.props.sitemapRowId,tabIndex:-1,onKeyDown:this._onKeyDownHandler,onFocus:this._onKeyboardFocus,onBlur:this._onKeyboardBlur,title:e.title,role:t,onPointerEnter:this._onPointerEnter,isSelected:this.props.entry.isSelected},o.createElement(i.a,{key:"quick-launch-flyout-anchor-"+this.props.entry.id,id:"quick-launch-flyout-anchor-"+this.props.entry.id,style:{width:0,height:"100%"}}),o.createElement(i.a,{key:"sitemap-sitemapAreaEntry-inlineBlock",style:me,accessibilityHidden:!0},o.createElement(i.a,{key:"sitemap-sitemapAreaEntry-flexBox",style:(this.props.designLanguage,n=this.props.theme,r=this.props.isRTL,{display:"flex",[Object(E.i)(r)]:n.sizes.Measures.Measure025,[Object(E.e)(r)]:0,justifyContent:"flex-start",height:"100%",alignItems:"center",overflowX:"hidden",flex:"auto"}),accessibilityHidden:!0},this._renderCollapsedSitemapRowContent(e,!0))),(this.props.isHovered||this.state.isKeyboardFocused)&&!this.state.forceHideTooltip&&this._renderItemFlyout());var n,r}_renderCollapsedSitemapRowContent(e,t){return o.createElement(o.Fragment,null,o.createElement(i.a,{key:"sitemap-sitemapAreaEntry-inlineBlock",style:be(this.props.designLanguage,this.props.theme,this.props.isRTL,this.props.entry.isSelected),accessibilityHidden:!0}),o.createElement(i.a,{key:"sitemap-sitemapAreaEntry-flexBox",style:fe,title:t&&(e.tooltip||e.title)},o.createElement(s.a,{key:"sitemap-sitemapAreaEntry-icon",className:"svgIcon",style:this._addContrastRule((n=this.props.designLanguage,this.props.theme,{color:n?n.Components.Navigation.Rest.IconColor:void 0,fontFamily:"Dyn CRM Symbol",textAlign:"center",width:"100%",fontSize:"16px",flexShrink:0,display:"flex",justifyContent:"center"}),this.props.theme)},this._renderIcon(t))));var n}_getSitemapTestId(e){return e?"quick-launch-entity-"+this.props.entry.id:this.props.sitemapRowId}_getSitemapLarningPatchAttribute(e){return e?"sitemap-ql-entity-"+this.props.entry.id:"sitemap-entity-"+this.props.entry.id}_renderItemFlyout(){const e={onPointerLeave:this.props.oct2021CollapseMode?void 0:this._onPointerLeave,onClick:this._onClickHandler};return o.createElement(ge.b,Object.assign({positionType:"relative",relativeToElementId:this.props.renderChildListInFyout?this.props.sitemapRowId:"quick-launch-flyout-anchor-"+this.props.entry.id,id:"quick-launch-flyout-"+this.props.entry.id,key:"quick-launch-flyout-"+this.props.entry.id,flyoutDirection:this.props.isRTL?ge.c.left:ge.c.right,onOutsideClick:this._onPointerLeave,flyoutStyle:de(this.props.designLanguage,this.props.theme),ref:this._flyoutRef},e),this.props.renderChildListInFyout?this._renderDropdown():this._renderRowContent())}_addContrastRule(e,t,n){if(!this.state.icon)return e;const o=this.state.icon.type;if(!o||o!==l.a||this.props.isHighContrast)return e;const r=n?t.colors.SiteMap.RefreshedRow.Fill.toString():t.colors.SiteMap.RefreshedDefault;return Object(f.b)(e,r,n,t.colors.SiteMap.RefreshedGroupText)}}Le.contextType=P.a;const Te=Object(r.a)(()=>{let e=null,t=null;return(n,o)=>{const r=o?o.entry:null,s=r?Object(y.e)(n,r.entityTypeName):y.a.NotAvailable,i=!e||null===t,a=s===t,l=Object(z.m)(n),c=Object(z.p)(n),p=!o.entry.children&&o.entry.subActionDescriptor&&!!o.entry.subActionDescriptor.dropdownInfo,d=p&&0===o.panelState&&c;let h;if(r.subActionDescriptor&&r.subActionDescriptor.dropdownInfo){const{dropdownOpened:e,childItems:t}=Z(n,r.id,d);h=e&&t&&!t.length&&"sitemap-sitemapdropdown-noitems-"+r.id}const b=e&&(h!==e.dropDownMessageId||l!==e.isSitemapInFlyout||p!==e.hasChildList||d!==e.renderChildListInFyout);if(i||!a||b){t=s;const o=Object(Ie.a)(n)===we.a.MultiSession,r=Object(z.d)(n),i=Object(u.a)(n),a=Object(G.b)(n)?Object(G.a)(n):null,b=Object(Be.b)(n)||{};e={theme:i,designLanguage:a,customStyles:ue(a,i),entityOfflineStatus:s,resourceStrings:Object(_.e)(n,[R.a,R.c]),isRTL:Object(A.g)(n),isHighContrast:Object(M.n)(),isSitemapInFlyout:l,isMultisessionApp:o,dropDownMessageId:h,oct2021CollapseMode:c,hasChildList:p,renderChildListInFyout:d,shouldApplyModernMultiSessionLayout:r,focusedSessionId:b.id}}return e}},(function(e){return{execute:t=>{t&&e(t)},handleIconRenderFailure:async(t,o,r)=>{if(Object(Fe.a)()){const{handleSitemapIconRenderingError:s}=await n.e(166).then(n.bind(null,"Kn/H"));e(s(t,o,r))}}}}))(Le)},"j+uO":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var o=n("mMyr"),r=n("H4dV"),s=n("7Xh3");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function i(e){const{source:t,style:n}=e;if(r.a.getInstance().get_IsBrowserIE()&&!e.useImgInIE||e.highContrast){const r=Object.assign(Object.assign(Object.assign({},n),e.invert?{fill:"white"}:{}),e.highContrast?{fill:"windowText"}:{});return o.createElement(s.b,{source:t,style:r,fallbackToImage:!0,title:e.title,role:e.role,altText:e.altText,onParsingError:e.onError})}const i=Object.assign(Object.assign({},n),e.invert?{filter:"invert(100%)"}:{});return o.createElement(s.a,{source:t,style:i,title:e.title,role:e.role,altText:e.altText,onError:e.onError})}},kn9b:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var o;n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return s})),function(e){e.LS_PUBLISHED_APPS="AppModuleLandingPage.PublishedAppsFilterText",e.LS_SEARCH_MY_APPS="AppModuleLandingPage.SearchMyApps",e.LS_NO_APPS="AppModuleLandingPage.NoApps",e.LS_MISSING_APPS_CHANGE_CRITERIA="AppModuleLandingPage.NoAppsFoundChangeSearchCriteriaText",e.LS_NO_OFFLINE_APPS="AppModuleLandingPage.NoOfflineApps",e.LS_NO_MATCHING_SEARCH="AppModuleLandingPage.NoMatchingSearch",e.LS_MY_APPS="App_Modules_SubArea_Title"}(o||(o={}));const r=[o.LS_PUBLISHED_APPS,o.LS_SEARCH_MY_APPS,o.LS_NO_APPS,o.LS_MISSING_APPS_CHANGE_CRITERIA,o.LS_NO_OFFLINE_APPS,o.LS_NO_MATCHING_SEARCH,o.LS_MY_APPS];function s(e,t){return e&&e[t]?e[t]:t}},m38G:function(e,t,n){"use strict";n.d(t,"b",(function(){return Ye})),n.d(t,"a",(function(){return Je})),n.d(t,"d",(function(){return Ze})),n.d(t,"c",(function(){return Xe}));var o=n("mMyr"),r=n("huli"),s=n("kXuq"),i=n("/to1"),a=n("u+q+"),l=n("2FbK"),c=n("Afz2"),u=n("nJrx"),p=n("q441"),d=n("7HpW"),h=n("Fn63"),b=n("N2HV"),y=n("3rse"),m=n("3mNF"),f=n("RiHV"),g=n("InN9"),S=n("Eqw3"),v=n("xqqo"),w=n("q43A"),I=n("IqkD"),C=n("unFF"),O=n("SocB"),_=n("ws6F"),R=n("YxC/"),A=n("tJ+6"),M=n("d6Hx");function E(e,t){const n=e?e.Components.Navigation.Rest.BackgroundColor:t.colors.BaseColor.Grey.Grey3,o=e?e.Components.Navigation.Rest.TextColor:t.colors.BaseColor.Grey.Grey1;return Object(w.d)({color:Object(O.e)(o),cursor:"pointer",display:"flex",flexDirection:"row"},n)}function j(e,t,n){return{cursor:"default",marginLeft:n?"0px":t.sizes.Measures.Measure300,marginRight:n?t.sizes.Measures.Measure300:"0px",fontFamily:t.fontFamilies.Weighted,fontWeight:t.sizes.FontWeights.Semibold,color:e?e.Components.Navigation.Selected.TextColor:t.colors.BaseColor.Grey.Grey7,height:t.sizes.Measures.Measure250,lineHeight:t.sizes.Measures.Measure250,display:"flex",flexDirection:"row"}}function F(e,t){return{color:e?e.Components.Navigation.Selected.TextColor:void 0,whiteSpace:"nowrap",textOverflow:"ellipsis",overflowX:"hidden",marginLeft:t.sizes.Measures.Measure100,marginRight:t.sizes.Measures.Measure100,fontSize:t.fontSizes.Font100,fontFamily:t.fontFamilies.Normal,height:t.sizes.Measures.Measure250,lineHeight:t.sizes.Measures.Measure250,display:"inline-block",alignItems:"center"}}const x=Object(a.a)((function(){return function(e,t){const n=Object(C.a)(e),o=Object(I.g)(e);return{theme:n,designLanguage:Object(A.b)(e)?Object(A.a)(e):null,isRTL:o}}}))((function(e){return o.createElement(g.b,{key:"flyout",positionType:"relative",relativeToElementId:e.relativeToElementId,flyoutDirection:e.flyoutDirection,flyoutStyle:(t=e.designLanguage,n=e.theme,r=e.flyoutWidth,{backgroundColor:t?t.Components.Navigation.Selected.BackgroundColor:n.colors.BaseColor.White,boxShadow:"0px 8px 10px rgba(0,0,0,0.1)",maxHeight:"23.75em",overFlowY:"auto",width:r,display:"flex",flexDirection:"column"}),onOutsideClick:t=>function(e,t){const n=t.target,o=document.getElementById("areaSwitcherId");n&&!o.contains(n)&&o!==n&&e.closeFlyout()}(e,t),id:e.id,testhooks:{[f.a.LearningPathDOMAttributeSuffix]:"sitemap-area-switcher-flyout"}},o.createElement(s.a,{key:"text-info"},o.createElement(i.a,{style:j(e.designLanguage,e.theme,e.isRTL),role:c.v},Object(R.c)(e.resourceStrings,_.i))),o.createElement(v.a,{key:"menu",onKeyDown:e.keyDownHandler,ref:m.b,role:c.p,accessibilityLabel:Object(R.c)(e.resourceStrings,_.i)},function(e,t,n){return(t=t.filter(e=>e.Id!==M.c))&&t.length?t.map((t,r)=>{return o.createElement(S.a,{key:r,style:E(e.designLanguage,e.theme),tabIndex:-1,title:t.Titles[0].Title,accessibilityChecked:n===t.Id,role:c.s,testhooks:{id:"areaswitcherflyout-"+t.Id,[f.a.LearningPathDOMAttributeSuffix]:"sitemap-areaswitcherflyout-"+t.Id},onClick:n=>{e.selectArea(t.Id),e.closeFlyout(n)}},o.createElement(i.a,{style:(s=e.designLanguage,a=e.theme,{color:s?s.Components.Navigation.Selected.IconColor:void 0,fontFamily:"CRM MDL2",fontSize:"16px",width:"16px",minWidth:"16px",height:a.sizes.Measures.Measure250,lineHeight:a.sizes.Measures.Measure250,marginLeft:a.sizes.Measures.Measure100,display:"flex",alignItems:"center"}),key:"icon"},n===t.Id?o.createElement(b.b,{type:h.a.CheckMark}):null),o.createElement(i.a,{style:F(e.designLanguage,e.theme),key:"title"},t.Titles[0].Title));var s,a}):[]}(e,e.siteMapItems,e.selectedAreaId)));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var t,n,r}));var k=n("0U+K");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function B(e,t){return{textAlign:"center",justifyContent:"center",textTransform:"uppercase",fontFamily:t.fontFamilies.Weighted,fontWeight:t.sizes.FontWeights.Semibold,fontSize:"12px",lineHeight:t.sizes.Measures.Measure175,width:t.sizes.Measures.Measure200,height:t.sizes.Measures.Measure200,borderRadius:"2px",border:"none",color:e?e.Components.Navigation.Rest.Hover.IconColor:t.colors.BaseColor.White}}function L(e,t,n){return{height:t.sizes.Measures.Measure200,fontFamily:t.fontFamilies.Weighted,fontWeight:t.sizes.FontWeights.Semibold,fontSize:t.sizes.Measures.Measure100,lineHeight:t.sizes.Measures.Measure200,color:e?e.Components.Navigation.Rest.TextColor:t.colors.BaseColor.Grey.Grey7,textAlign:n?"right":"left",marginLeft:n?"0px":t.sizes.Measures.Measure050,marginRight:n?t.sizes.Measures.Measure050:"0px",whiteSpace:"nowrap",textOverflow:"ellipsis",overflowX:"hidden",flexGrow:1}}function T(e,t,n){return{fontSize:"16px",lineSize:"19px",alignContent:"flex-end",width:"16px",height:t.sizes.Measures.Measure200,lineHeight:t.sizes.Measures.Measure200,color:e?e.Components.Navigation.Rest.IconColor:t.colors.BaseColor.Grey.Grey7,marginRight:n?"0px":"6px",marginLeft:n?"6px":"0px"}}const P={flexShrink:0};class D extends o.Component{constructor(e){super(e),this._areaSwitcherFlyoutId=Object(u.a)(),this._areaSwitcherButtonRef=null,this._getAreaSwitcherButtonRef=this._getAreaSwitcherButtonRef.bind(this),this._toggleAreaSwitcherFlyout=this._toggleAreaSwitcherFlyout.bind(this),this.keyDownHandler=this.keyDownHandler.bind(this),this.state={}}_toggleAreaSwitcherFlyout(){this.setState({isAreaSwitcherFlyoutVisible:!this.state.isAreaSwitcherFlyoutVisible})}_getAreaSwitcherButtonRef(e){this._areaSwitcherButtonRef=e}keyDownHandler(e){Object(m.a)(e)||this.setState({isAreaSwitcherFlyoutVisible:!1}),e.keyCode!==y.a.Enter&&e.keyCode!==y.a.Escape||(requestAnimationFrame(()=>{this._areaSwitcherButtonRef&&this._focusOnAreaSwitcher()}),e.stopPropagation())}_focusOnAreaSwitcher(){const e=r.findDOMNode(this._areaSwitcherButtonRef);e&&e.focus()}_renderAreaSwitcher(){if(!this.props.selectedAreaId)return null;const e=Object(d.a)(this.props.siteMap),t=o.createElement(x,{id:this._areaSwitcherFlyoutId,siteMapItems:e,flyoutDirection:0===this.props.panelState?this.props.isRTL?g.c.left:g.c.right:g.c.up,selectArea:this.props.selectArea,selectedAreaId:this.props.selectedAreaId,relativeToElementId:"areaSwitcherContainer",closeFlyout:this._toggleAreaSwitcherFlyout,keyDownHandler:this.keyDownHandler,resourceStrings:this.props.resourceStrings,flyoutWidth:this.props.flyoutWidth});let n,r;const a=this.props.designLanguage;for(let t=0;t<e.length;t++)this.props.selectedAreaId===e[t].Id&&(n=e[t].Titles[0].Title,r=Object.assign(Object.assign({},B(a,this.props.theme)),{backgroundColor:Object(k.a)(t,this.props.theme)}));const l=Object.assign(Object.assign({},{backgroundColor:"transparent",borderStyle:"none",cursor:"pointer",display:"flex",alignItems:"center",margin:(u=this.props.theme).sizes.Measures.Measure050+" 8px",flexDirection:"row",justifyContent:"flex-start",height:u.sizes.Measures.Measure200,padding:0,borderRadius:"3px",width:"100%",overflow:"hidden"}),{":hover":this.state.isAreaSwitcherFlyoutVisible?null:{backgroundColor:a?a.Components.Navigation.Rest.Hover.BackgroundColor:this.props.theme.colors.BaseColor.White,boxShadow:"0px 4px 8px rgba(0,0,0,0.1)"}});var u;const y=String.format(Object(R.c)(this.props.resourceStrings,_.j),n);return o.createElement(s.a,{key:"expand-options",style:P,id:"areaSwitcherContainer",role:c.v},o.createElement(p.a,{key:"expand-options-button",title:y,accessibilityLabel:y,onClick:this._toggleAreaSwitcherFlyout,style:l,id:"areaSwitcherId",accessibilityExpanded:!!this.state.isAreaSwitcherFlyoutVisible,accessibilityHasPopup:!0,ref:this._getAreaSwitcherButtonRef,testhooks:{id:"sitemap-areaSwitcher-expand-btn",[f.a.LearningPathDOMAttributeSuffix]:"sitemap-areaSwitcher-expand-btn"}},o.createElement(s.a,{style:{display:"flex"},key:"icon"},o.createElement(s.a,{semanticTag:"span",style:r},Object(k.b)(n))),0===this.props.panelState?null:o.createElement(i.a,{key:"title",style:L(a,this.props.theme,this.props.isRTL)},n),0===this.props.panelState?null:o.createElement(i.a,{key:"down-chevron",style:T(a,this.props.theme,this.props.isRTL)},o.createElement(b.b,{type:h.a.ScrollUpDown}))),this.state.isAreaSwitcherFlyoutVisible?t:null)}render(){if(this.props.siteMap&&this.props.siteMap.AreaIds.length<2)return null;const e=this.props.designLanguage,t=e?e.Components.Navigation.Selected.BackgroundColor:this.props.theme.colors.BaseColor.White,n=e?e.Components.Navigation.Rest.BackgroundColor:this.props.theme.colors.BaseColor.Grey.Grey1,r=Object.assign(Object.assign({},function(e,t){const n=e?e.Components.Navigation.Rest.Focus.BorderColor:t.colors.BaseColor.Grey.Grey3;return{width:"100%",height:t.sizes.Measures.Measure100,display:"block",minHeight:t.sizes.NavButtonHeight,borderTop:"1px solid "+n}}(e,this.props.theme)),{backgroundColor:this.state.isAreaSwitcherFlyoutVisible?t:n});return o.createElement(s.a,{style:r,role:c.v},this._renderAreaSwitcher())}}var H=n("b8TU"),N=n("sclX"),z=n("LzVy"),G=n("69Qu"),W=n("GWSs"),K=n("3UxG"),q=n("AVDU"),U=n("fTeK"),Q=n("SAYH"),V=n("QBtP"),Y=n("HCHE"),X=n("eytu");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class Z extends o.Component{constructor(e){super(e),this._uniqueId=Q.a.newGuid().guid,this._labelId="sitemap-sitemapAreaGroup-group-"+this._uniqueId,this._describeAreaId=this._labelId+"-narrator"}_renderSitemapAreaEntries(){const{sitemapGroup:e}=this.props;let t=!1;const{toggleSiteMap:n}=this.context;return e.entries.map((e,r)=>{let s;e.subActionDescriptor&&!t&&(t=!0,s=this._describeAreaId);const i=Object(Y.a)(e);return o.createElement(U.a,{key:r,entry:e,toggleSiteMap:n,describedByElementId:s,panelState:this.props.panelState,accessibilityRole:c.C,isHovered:this.props.hoveredRowId===e.id,sitemapRowId:i,onPointerEnter:this.props.onRowPointerEnter,onPointerLeave:this.props.onRowPointerLeave,onKeyboardFocus:this.props.onKeyboardFocus})})}render(){const{sitemapGroup:e,isLastGroup:t}=this.props,n=0===this.props.panelState;return o.createElement(X.a,{key:"group-"+e.title,groupTitle:e.title,showTitle:!n,showTopBorder:0===this.props.index&&n,showBottomBother:n,needMarginBottom:!t&&!n,narratorTitle:e.narratorTitle,labelId:this._labelId,descriptionId:this._describeAreaId},this._renderSitemapAreaEntries())}}Z.contextType=V.b;var J=n("uZvv"),$=n("Kxpb");const ee=Object(a.a)((function(){return(e,t)=>{const n=t.sitemapGroup,o=Object(J.d)(e),r=Object($.a)(t.areaId,n.title),s=Object(K.e)(r,o),i=o.collapsedGroupState,a=Object(K.c)(i),l=Object(K.d)(a,i);return{isExpanded:s,totalGroups:a.length,expandedGroupsCount:l}}}),(function(e){return{setGroupCollapsedState:(t,n,o)=>e(Object(K.h)(t,n,o))}}))(e=>{const t=o.useContext(V.b),n=o.useRef(""),r=o.useContext(V.a),{setGroupCollapsedState:s,sitemapGroup:i,areaId:a,expandedGroupsCount:l,totalGroups:u}=e,p=i.title,d=i.entries.some(e=>e.isSelected);o.useEffect(()=>{const e=Q.a.newGuid().guid;n.current=`sitemap-sitemapDropDown-group-${e.toString()}-narrator`},[]),o.useEffect(()=>{d&&s(a,p,!0)},[d,p,a,s]);const y={id:i.title,entityTypeName:null,title:i.title,tooltip:e.sitemapGroup.narratorTitle,isSitemapGroup:!0,children:e.sitemapGroup.entries,subActionDescriptor:{icon:{type:b.b,value:(e.isExpanded?h.a.ChevronUp:h.a.ChevronDown).toString()},onClickHandler:null,dropdownInfo:{isOpened:e.isExpanded}},onClickHandler:()=>{const t=!e.isExpanded;e.setGroupCollapsedState(a,i.title,t);const n=t?l+1:l-1;((e,t,n,o)=>{e.ReportComponentSuccess(M.m,[{name:"ExpandedGroupsCount",value:t},{name:"TotalGroups",value:n},{name:"IsGroupExpanded",value:o},{name:"IsMobileApp",value:!1}])})(r.EventManager,n,u,t)}},m=Object(Y.a)(y);return o.createElement(U.a,{entry:y,toggleSiteMap:t.toggleSiteMap,describedByElementId:n.current,panelState:e.panelState,accessibilityRole:c.C,isHovered:e.hoveredRowId===y.id,sitemapRowId:m,onPointerEnter:e.onRowPointerEnter,onPointerLeave:e.onRowPointerLeave,onKeyboardFocus:e.onKeyboardFocus})});
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class te extends o.Component{componentDidMount(){this.props.loadPrevSitemapGroupCollapsedState()}_renderGroups(){const e=this.props,{entryGroups:t,isRTL:n,isTablet:r}=e;if(!t)return null;const s=t.length;return 0!==this.props.panelState&&this.props.areCollapsibleSitemapGroupsEnabled?t.map((t,r)=>o.createElement(ee,{key:"groupDropdown"+r,sitemapGroup:t,areaId:this.props.areaId,index:r,theme:e.theme,designLanguage:e.designLanguage,isRTL:n,isLastGroup:r===s-1,panelState:this.props.panelState,hoveredRowId:this.props.hoveredRowId,onRowPointerEnter:this.props.onRowPointerEnter,onRowPointerLeave:this.props.onRowPointerLeave,onKeyboardFocus:this.props.onKeyboardFocus})):t.map((t,i)=>o.createElement(Z,{key:"group"+i,sitemapGroup:t,index:i,theme:e.theme,designLanguage:e.designLanguage,isRTL:n,isLastGroup:i===s-1,isTablet:r,panelState:this.props.panelState,hoveredRowId:this.props.hoveredRowId,onRowPointerEnter:this.props.onRowPointerEnter,onRowPointerLeave:this.props.onRowPointerLeave,onKeyboardFocus:this.props.onKeyboardFocus}))}render(){return this._renderGroups()}}function ne(e,t){if(e===t)return!0;if(!e||!t)return!1;if(e.title===t.title){const n=e.subActionDescriptor||null,o=t.subActionDescriptor||null;return e.isSelected===t.isSelected&&JSON.stringify(n)===JSON.stringify(o)}return!1}const oe=Object(a.a)(()=>{let e=null,t=null,n=null;return(o,r)=>{const s=Object(G.c)(o),i=Object(z.a)(o),a=Object(H.c)(o),l=Object(C.a)(o),c=Object(q.c)(o);if(!t||!e||n!==s)return t=r.areaId,n=s,e={entryGroups:Object(W.g)(o,r.areaId),isRTL:Object(I.g)(o),isTablet:i===N.b.Native&&a>l.sizes.Breakpoints.DimensionS,areCollapsibleSitemapGroupsEnabled:c},e;let u;if(r.areaId===t){u=Object(W.g)(o,r.areaId);if(!(function(e,t){if(e.length!==t.length)return!0;for(let n=0;n<e.length;n++){if(e[n].title!==t[n].title)return!0;if(e[n].entries.length!==t.entries.length)return!0;for(let o=0;o<e[n].entries.length;o++)if(!ne(e[n].entries[o],t[n].entries[o]))return!0}return!1}(e.entryGroups,u)||e.areCollapsibleSitemapGroupsEnabled!==c))return e}return t=r.areaId,n=s,e={entryGroups:u||Object(W.g)(o,r.areaId),isRTL:Object(I.g)(o),isTablet:i===N.b.Native&&a>l.sizes.Breakpoints.DimensionS,areCollapsibleSitemapGroupsEnabled:c},e}},(function(e){return{loadPrevSitemapGroupCollapsedState:()=>e(Object(K.f)())}}))(te);var re=n("EY5k"),se=n("1S8a"),ie=n("jzeE"),ae=n("gxvI"),le=n("Xi8U"),ce=n("kn9b"),ue=n("2bwe"),pe=n("QbIY"),de=n("46jN"),he=n("YcFo"),be=n("PZ34"),ye=n("pF61"),me=n("arV0"),fe=n("baQL");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const ge="Home_8E2112DC-AD90-40F5-BEBE-0A8D80785D75",Se={type:b.b,value:h.a.Home.toString()},ve={type:b.b,value:h.a.Recent.toString()},we={type:b.b,value:h.a.Pinned.toString()},Ie={type:b.b,value:h.a.RunQuery.toString()};function Ce(e){return o.createElement(o.Fragment,null,function(e){const t=o.useMemo(()=>({id:ge,entityTypeName:null,title:Object(ce.c)(e.resourceStrings,de.g),tooltip:Object(ce.c)(e.resourceStrings,de.f),icon:e.homeIcon,onClickHandler:()=>Object(pe.b)()}),[e.homeIcon,e.resourceStrings]);if(e.renderHome){const n=Object(Y.a)(t);return o.createElement(U.a,{key:ge,entry:t,panelState:e.panelState,accessibilityRole:c.C,isHovered:e.hoveredRowId===t.id,sitemapRowId:n,onPointerEnter:e.onRowPointerEnter,onPointerLeave:e.onRowPointerLeave,onKeyboardFocus:e.onKeyboardFocus,renderAppsButton:e.shouldRenderAppsButton})}return null}(e),function(e){const t=o.useMemo(()=>({id:he.c,entityTypeName:null,title:Object(ce.c)(e.resourceStrings,_.v),tooltip:Object(ce.c)(e.resourceStrings,_.y),icon:e.recentIcon,children:null,subActionDescriptor:e.recentSubAction,onClickHandler:()=>Object(ue.b)(e.recentSubAction.dropdownInfo)}),[e.recentIcon,e.recentSubAction,e.resourceStrings]);if(0===e.panelState&&!e.oct2021CollapseMode)return null;if(e.renderRecent){const n=Object(Y.a)(t);return o.createElement(U.a,{key:he.c,entry:t,panelState:e.panelState,sitemapRowId:n,accessibilityRole:c.C,onKeyboardFocus:e.onKeyboardFocus})}return null}(e),function(e){const t=o.useMemo(()=>({id:he.a,entityTypeName:null,title:Object(ce.c)(e.resourceStrings,_.o),tooltip:Object(ce.c)(e.resourceStrings,_.s),icon:e.pinnedIcon,children:null,subActionDescriptor:e.pinnedSubAction,onClickHandler:()=>Object(ue.b)(e.pinnedSubAction.dropdownInfo)}),[e.pinnedIcon,e.pinnedSubAction,e.resourceStrings]);if(0===e.panelState&&!e.oct2021CollapseMode)return null;if(e.renderPinned){const n=Object(Y.a)(t);return o.createElement(U.a,{key:he.a,entry:t,panelState:e.panelState,sitemapRowId:n,accessibilityRole:c.C,onKeyboardFocus:e.onKeyboardFocus})}return null}(e),function(e){const t=o.useMemo(()=>({id:he.b,entityTypeName:null,title:"Query",tooltip:"Query tooltip",icon:e.queryIcon,isSelected:e.isQuerySelected,onClickHandler:()=>Object(be.a)()}),[e.queryIcon,e.isQuerySelected]);if(e.renderQueryPage){const n=Object(Y.a)(t);return o.createElement(U.a,{key:he.b,entry:t,panelState:e.panelState,accessibilityRole:c.C,isHovered:e.hoveredRowId===t.id,sitemapRowId:n,onPointerEnter:e.onRowPointerEnter,onPointerLeave:e.onRowPointerLeave,onKeyboardFocus:e.onKeyboardFocus})}return null}(e))}function Oe(e,t,n){const o=t===he.c,r={isOpened:!1,entityTypeName:o?"Recent_C66859D8-C5F1-4C29-AB31-D1F1F522C6B8":"Pinned_0F52083C-5DA1-41B2-88A7-937955C71021",relativeToEntryId:t},s=Object(le.c)(e);let i;s&&s.entityTypeName===r.entityTypeName&&s.relativeToEntryId===r.relativeToEntryId&&(r.isOpened=s.isOpened),i=o?r.isOpened?_.w:_.x:r.isOpened?_.q:_.r;const a=Object(ce.c)(n,i);return{icon:{type:b.b,value:(r.isOpened?h.a.ChevronUp:h.a.ChevronDown).toString()},dropdownInfo:r,toolTip:a}}Ce.displayName="SitemapHomePane";const _e=Object(a.a)((function(){const e=Object(R.h)();let t,n;return(o,r)=>{const s=e(o,[de.g,de.f,_.o,W.a,_.v,_.y,_.s,_.x,_.w,_.r,_.q]),i=Oe(o,he.c,s),a=Oe(o,he.a,s);t&&i.dropdownInfo.isOpened===t.dropdownInfo.isOpened||(t=i),n&&a.dropdownInfo.isOpened===n.dropdownInfo.isOpened||(n=a);const l=Object(ye.c)(o),c=Object(me.p)(o,l),u=Object(me.j)(o,l),p=c===fe.a||u&&u.isQueryMode,d=Object(q.g)(o);return{homeIcon:Se,recentIcon:ve,recentSubAction:t,pinnedIcon:we,pinnedSubAction:n,queryIcon:Ie,isQuerySelected:p,resourceStrings:s,shouldRenderAppsButton:d,oct2021CollapseMode:Object(q.p)(o)}}}))(Ce);var Re=n("0FMG"),Ae=n("uMsf"),Me=n("D+Bz"),Ee=n("Knfm"),je=n("cz9j"),Fe=n("PsCI"),xe=n("FhVi"),ke=n("3cEW"),Be=n("CXmn"),Le=n("/QjR"),Te=n("4leG"),Pe=n("B9ov");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const De=Object(u.a)(),He={type:b.b,value:h.a.OfficeWaffle.toString()};class Ne extends o.Component{constructor(e,t){super(e),_.D.some(t=>!e.resourceStrings[t])&&e.retrieveResourceStrings(_.D)}render(){const e={id:De,entityTypeName:null,title:Object(ce.c)(this.props.resourceStrings,_.m),tooltip:Object(ce.c)(this.props.resourceStrings,_.n),icon:this.props.waffleIcon,onClickHandler:this.props.navigateToOfficePortal},t=Object(Y.a)(e);return o.createElement(U.a,{key:De,entry:e,panelState:this.props.panelState,accessibilityRole:c.C,sitemapRowId:t,onKeyboardFocus:this.props.onKeyboardFocus,renderAppsButton:!0})}}Ne.contextType=V.b;const ze=Object(a.a)((function(){const e=Object(R.h)();return t=>{const n=e(t,_.D);return{waffleIcon:He,resourceStrings:n}}}),(function(e){return{retrieveResourceStrings:t=>e(Object(re.e)(t)),navigateToOfficePortal:()=>{e(Object(Pe.a)())}}}))(Ne);var Ge=n("Oxat"),We=n("DCyf"),Ke=n("9KYq"),qe=n("eIIO"),Ue=n("d8rx");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Qe=Object(u.a)(),Ve=Object(u.a)();class Ye extends o.Component{constructor(e){super(e),this._isEnableFocusableSitemapItem=!1,this.updateSitemapBodyPanelContainerRef=this.updateSitemapBodyPanelContainerRef.bind(this),this.onRowPointerEnter=this.onRowPointerEnter.bind(this),this.onRowPointerLeave=this.onRowPointerLeave.bind(this),this.onKeyboardFocus=this.onKeyboardFocus.bind(this),this._globalKeyboadHandler=this._globalKeyboadHandler.bind(this),this._onOutsideClickHandler=this._onOutsideClickHandler.bind(this),this.onKeyDownHandler=this.onKeyDownHandler.bind(this),this.selectArea=this.selectArea.bind(this),this._sitemapHeaderId=Object(u.a)(),this.state={hoveredRowId:void 0,focusedRowId:void 0,panelState:this.props.shouldApplyModernMultiSessionLayout?0:1},_.z.some(t=>!e.resourceStrings[t])&&e.retrieveResourceStrings(_.z)}componentDidMount(){document.addEventListener("keydown",this._globalKeyboadHandler),this._logHomeRecentsPinnedState()}componentWillUnmount(){document.removeEventListener("keydown",this._globalKeyboadHandler)}onKeyDownHandler(e){const t=e.target,n=new Le.b(this.getPanelBodyId()),o=document.getElementById("siteMapPanelBodyDiv");switch(Object(je.e)(e.nativeEvent)){case Fe.a.DownArrow:o&&o.contains(t)&&(this._focusNotNull(n.getNextSibling(t)),e.preventDefault());break;case Fe.a.UpArrow:o.contains(t)&&(this._focusNotNull(n.getPrevSibling(t)),e.preventDefault());break;case Fe.a.Home:o.contains(t)&&this._focusNotNull(n.getFirstItemOfEntityNavBar());break;case Fe.a.End:o.contains(t)&&this._focusNotNull(n.getLastItemofEntityNavBar());break;case Fe.a.Space:case Fe.a.Enter:t&&"BUTTON"!==t.tagName&&(t.click(),e.stopPropagation())}}_focusNotNull(e){e&&e.focus()}_globalKeyboadHandler(e){switch(Object(je.e)(e)){case Fe.a.Escape:this.setState({hoveredRowId:void 0})}}selectArea(e){this.props.selectedAreaId!==e&&(this.props.selectArea(e,this.props.siteMap),this.props.navigateToArea(e))}componentDidUpdate(e,t){if(e.selectedAreaId!==this.props.selectedAreaId){const e=r.findDOMNode(this._sitemapBodyContainer);e&&(e.scrollTop=0,this._setDefaultFocus())}else e.panelState===this.props.panelState&&e.isInFlyoutMode===this.props.isInFlyoutMode&&this._isEnableFocusableSitemapItem||this._setDefaultFocus()}_setDefaultFocus(){const e=r.findDOMNode(this._sitemapBodyContainer);if(!(e&&e.querySelector("[tabindex='0']"))){const t=e&&e.querySelector(Le.a);this._setSitemapItemFocusable(t)}}_logHomeRecentsPinnedState(){this.context.EventManager.ReportComponentSuccess(M.o,[{name:"HomeEnabled",value:this.props.renderHome},{name:"RecentsEnabled",value:this.props.renderRecent},{name:"PinnedEnabled",value:this.props.renderPinned},{name:"IsMobileApp",value:!1}])}_renderSiteMap(){return this.props.shouldApplyModernMultiSessionLayout&&1!==this.state.panelState?null:o.createElement(s.a,{key:"navigationLandmark",id:Qe,testhooks:{id:"navbar-container"},role:c.t,labelledByElementId:this._sitemapHeaderId,className:this.props.oct2021CollapseMode&&qe.c,style:this._getContainerStyle()},this.renderPanelHeader(),this.renderPanelBody(),this.renderPanelFooter())}renderPanelHeader(){return o.createElement(o.Fragment,null,this.props.renderToggleButton?o.createElement(s.a,{key:"sitemap-button",style:{display:"flex",width:"100%",justifyContent:"space-between"}},o.createElement(ae.a,{key:"sitemap-toogle",forceCollapsed:!this.props.shouldApplyModernMultiSessionLayout&&this.props.forceCollapsed})):null,this.props.renderAppsButtonAboveHome?this._renderAppsButtonAboveHome():null,o.createElement(i.a,{id:this._sitemapHeaderId,semanticTag:"h2",style:{position:"absolute",[Object(Ue.b)(this.props.isRTL)]:"-1000em"},key:"sitemap-header"},Object(R.c)(this.props.resourceStrings,_.h)))}_renderAppsButtonAboveHome(){const e=this.props.theme,t={display:"flex",width:"100%",height:e.sizes.Measures.Measure250,minHeight:e.sizes.Measures.Measure250,justifyContent:"flex-end"};return o.createElement(s.a,{style:t},o.createElement(Ke.a,{key:"sitemap-apps",overwriteStyle:{height:"100%",padding:0},isInFlyoutMode:this.props.isInFlyoutMode}))}renderOfficeWaffle(){return o.createElement(ze,{key:"sitemap-waffle-button",onKeyboardFocus:this.onKeyboardFocus,hoveredRowId:this.state.hoveredRowId,onRowPointerEnter:this.onRowPointerEnter,onRowPointerLeave:this.onRowPointerLeave,panelState:this.state.panelState,theme:this.props.theme,enableWCAG21FeaturesInFlyout:this.props.enableWCAG21FeaturesInFlyout})}renderSitemapItems(){const e=this.props.designLanguage,t=this.props.renderHome||this.props.renderPinned||this.props.renderRecent||this.props.renderQueryPage;return o.createElement(o.Fragment,null,this.props.renderPanesSwicher&&o.createElement(Ge.a,{key:"sitemap-app-side-panes",renderCurrentPage:!0,showBorder:!0,onKeyboardFocus:this.onKeyboardFocus,hoveredRowId:this.state.hoveredRowId,onRowPointerEnter:this.onRowPointerEnter,onRowPointerLeave:this.onRowPointerLeave,panelState:this.state.panelState,theme:this.props.theme,enableWCAG21FeaturesInFlyout:this.props.enableWCAG21FeaturesInFlyout}),this._renderHomePaneGroup(),this.props.selectedAreaId&&o.createElement(oe,{key:"sitemap-navBar-areaPaneNavBar",areaId:this.props.selectedAreaId,theme:this.props.theme,designLanguage:e,resourceStrings:this.props.resourceStrings,panelState:this.props.panelState,hoveredRowId:this.state.hoveredRowId,onKeyboardFocus:this.onKeyboardFocus,onRowPointerEnter:this.onRowPointerEnter,onRowPointerLeave:this.onRowPointerLeave,isHomePaneGroupRendered:t}))}_renderHomePaneGroup(){const{renderHome:e,renderPinned:t,renderRecent:n,renderQueryPage:r}=this.props;return e||t||n||r?o.createElement(_e,{key:"sitemap-navBar-areaPaneStaticNavBar",theme:this.props.theme,panelState:this.props.panelState,renderHome:e,renderPinned:t,renderRecent:n,renderQueryPage:r,hoveredRowId:this.state.hoveredRowId,onKeyboardFocus:this.onKeyboardFocus,onRowPointerEnter:this.onRowPointerEnter,onRowPointerLeave:this.onRowPointerLeave,enableWCAG21FeaturesInFlyout:this.props.enableWCAG21FeaturesInFlyout}):null}getPanelBodyId(){return M.l}renderPanelBody(){return o.createElement(s.a,{key:"sitemap-panel-body",style:this.getSitemapPanelBodyDivStyle(),ref:this.updateSitemapBodyPanelContainerRef,id:"siteMapPanelBodyDiv"},o.createElement(v.a,{key:"sitemap-group-list",id:this.getPanelBodyId(),labelledByElementId:this._sitemapHeaderId,role:c.B,style:{flexDirection:"column",listStyleType:"none",width:"100%"},onKeyDown:this.onKeyDownHandler},this.props.renderWaffleInFlyout&&this.renderOfficeWaffle(),this.renderSitemapItems()))}renderPanelFooter(){const{siteMap:e}=this.props;return o.createElement(D,{key:"AreaSwitcher",siteMap:e,theme:this.props.theme,designLanguage:this.props.designLanguage,selectedAreaId:this.props.selectedAreaId,selectArea:this.selectArea,resourceStrings:this.props.resourceStrings,panelState:this.props.panelState,isRTL:this.props.isRTL,flyoutWidth:this.props.isInFlyoutMode?this.props.sitemapWidth:this.props.theme.sizes.SiteMap.RefreshedWidth})}render(){if(this.props.isSitemapPanelHidden)return null;if(this.props.isInFlyoutMode)return 1!==this.props.panelState?null:o.createElement(g.b,{id:Ve,accessibilityModal:!0,positionType:"absolute",flyoutStyle:{width:this.props.sitemapWidth,minWidth:this.props.sitemapMinWidth},position:this._getFlyoutPosition(),onOutsideClick:this._onOutsideClickHandler},this._renderSiteMap(),o.createElement(xe.a,{key:"accessibilityComponent",rootElementId:Ve,shouldManageFocus:!0,isModal:!0}));const e=document.getElementById(ie.a);return e&&r.createPortal(this._renderSiteMap(),e)}_onOutsideClickHandler(e){const t=e.target,n=document.getElementById(M.g);t&&!n.contains(t)&&n!==t&&this.props.toggleSitemap()}onRowPointerEnter(e){this.setState({hoveredRowId:e})}onRowPointerLeave(e){this.state.hoveredRowId===e&&this.setState({hoveredRowId:void 0})}_getFlyoutPosition(){const e={bottom:0,top:this.props.headerHeight,left:0};return this.props.isRTL&&(e.left=void 0,e.right=0),e}onKeyboardFocus(e){this.state.focusedRowId!==e&&this.setState({focusedRowId:e}),this._setSitemapItemFocusable(document.getElementById(e))}_setSitemapItemFocusable(e){const t=document.getElementById("siteMapPanelBodyDiv");if(t&&e){const n=t.querySelector("[tabindex='0']");n&&e===n||(n&&n.setAttribute("tabindex","-1"),e.setAttribute("tabindex","0"),this._isEnableFocusableSitemapItem=!0)}}getSitemapPanelBodyDivStyle(){return{overflowY:0===this.props.panelState?"hidden":"auto",overflowX:"hidden",flexGrow:1,":hover":this.props.oct2021CollapseMode&&{overflowY:"overlay"}}}_getContainerStyle(){const{theme:e,isRTL:t,isEmbedded:n}=this.props,o=this.props.designLanguage,r=n||t,s=n||!t;return{height:"100%",width:this.props.isInFlyoutMode?"100%":this.props.sitemapWidth,minWidth:this.props.sitemapMinWidth,boxSizing:"border-box",flexDirection:"column",backgroundColor:o?o.Components.Navigation.Rest.BackgroundColor:e.colors.SiteMap.RefreshedDefault,borderLeft:r?e.borders.Border02:"none",borderRight:s?e.borders.Border02:"none",position:"relative",display:"flex"}}updateSitemapBodyPanelContainerRef(e){this._sitemapBodyContainer=e,this._setDefaultFocus()}}function Xe(){const e=Object(R.h)(),t=Object(We.a)();return(n,o)=>{const r=Object(l.b)(n),s=Object(C.a)(n),i=Object(A.b)(n)?Object(A.a)(n):null,a=e(n,_.z),c=Object(I.g)(n),u=Object(se.a)(n),p=Object(J.a)(n),d=Object(Ee.a)(n),h=Object(q.n)(n),b=Object(q.o)(n),y=Object(q.e)(n),m=y&&t(n).length>0,f=Object(q.d)(n),g=f||Object(q.m)(n),S=o.forceCollapsed&&!g?0:Object(J.e)(n),v=Object(q.b)(s,g,S,f),w=Object(q.a)(g,f),O=Object(Be.b)(n),R=Object(Te.c)(n),M=0===S&&Object(q.p)(n),E=Object(q.f)(n),j=Object(q.i)(n),F=Object(q.l)(n);return{siteMap:r,theme:s,designLanguage:i,resourceStrings:a,isRTL:c,isSitemapPanelHidden:u,selectedAreaId:p,navigationType:d,renderAppsButtonAboveHome:E,renderHome:j,renderPinned:Object(q.j)(n),renderRecent:F,renderQueryPage:Object(q.k)(n),renderToggleButton:h,renderWaffleInFlyout:b,enableWCAG21FeaturesInFlyout:y,renderPanesSwicher:m,panelState:S,isInFlyoutMode:g,sitemapWidth:v,sitemapMinWidth:w,headerHeight:O,isEmbedded:R,oct2021CollapseMode:M,shouldApplyModernMultiSessionLayout:f}}}function Ze(e){return{retrieveResourceStrings:t=>e(Object(re.e)(t)),navigateToArea:t=>{e(Object(Ae.a)(t,Me.b.SiteMapSubArea))},selectArea:(t,n)=>{e(Object(Re.e)(t,n))},toggleSitemap:()=>{e(Object(ke.b)(!0))}}}Ye.getDerivedStateFromProps=(e,t)=>e.panelState!==t.panelState?{panelState:e.panelState}:null,Ye.displayName="SitemapPanel",Ye.contextType=V.a;const Je=Object(a.a)(Xe,Ze)(Ye)},oLPm:function(e,t,n){"use strict";n.d(t,"d",(function(){return o})),n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return i}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const o="Web.NavBar.Navigate_Dynamics365",r="Available_Offline",s="Not_Available_Offline",i="Web.NavBar.Back_Caption"},rQPN:function(e,t,n){"use strict";n.d(t,"a",(function(){return S})),n.d(t,"b",(function(){return g}));var o=n("txA/"),r=n("7VeL"),s=n("zsAz"),i=n("D+Bz"),a=n("ruPX"),l=n("fWyz"),c=n("2qKp"),u=n("31Vn"),p=n("FoFY"),d=n("xPbo"),h=n("Fgw8"),b=n("TnQP"),y=n("jhff"),m=n("x6/I"),f=n("hO7G");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function g(e,t,n){const r=[{name:"sessionId",value:t},{name:"url",value:Object(u.a)(e.Url)},{name:"entity",value:e.Entity}];return{type:o.r,execute({dispatch:o,getState:s},a){const c={source:i.b.SiteMap};null==n||n();const u=Object(l.b)(e,!1,void 0,c);return o(v({sessionId:t},u,c,r))},getInitialParameters:e=>Object(c.b)(e,r,t),getFailureParameters:(e,n,o)=>Object(c.b)(o,r,t),getSuccessParameters:(e,n)=>Object(c.b)(n,r,t)}}function S(e,t,n){const r=[{name:"pageType",value:e},{name:"sessionId",value:n.sessionId},{name:"canBeClosed",value:!!n.canBeClosed},{name:"hasTitle",value:!!n.title},{name:"isTitleStatic",value:!!n.isTitleStatic},{name:"isFocused",value:n.isFocused}];return{type:o.q,execute({dispatch:o,getState:s},l){const c={source:i.b.Unknown},u=Object(a.a)(e,t,void 0,c);return o(v(n,u,c,r))},getInitialParameters:e=>Object(c.b)(e,r,n.sessionId),getFailureParameters:(e,t,o,s)=>Object(c.b)(o,r,n.sessionId),getSuccessParameters:(e,t,o)=>Object(c.b)(t,r,n.sessionId)}}function v(e,t,n,i){return{type:o.o,execute({dispatch:a,getState:l},c){const u=l();if(!Object(r.a)(u,e.sessionId)){const t=Object(p.a)(u,e.sessionId).tabs.length;throw Object(s.d)("Cannot create tab",o.E===t?2415919112:2415919107,[{name:"numberTab",value:t}])}const g=a(Object(m.b)(f.a.tab,1)),S=function(e,t){return{type:o.p,payload:{tabId:t,sessionId:e.sessionId,canBeClosed:e.canBeClosed,title:e.title,isTitleStatic:e.isTitleStatic,isFocused:e.isFocused}}}(e,g),v=Object(y.b)(u);return i.push({name:"tabId",value:g}),a(Object(d.b)(g,0)),a(S),n.targetBrowsingContext=g,a(w(e,g,v,b.a.Before)).then(()=>a(t)).then(t=>{!1!==e.isFocused&&0===t.status&&Object(h.d)(c.Router,[])}).then(()=>a(w(e,g,v,b.a.After))).then(()=>g)}}}function w(e,t,n,r){return{type:o.t,execute:({dispatch:o,getState:s},i)=>i.SessionTabEventManager.executeHandlersAsync(b.b.TabCreated,r,{sessionId:e.sessionId,tabId:t}).then(()=>{if(!1!==e.isFocused)return i.SessionTabEventManager.executeHandlersAsync(b.b.TabSwitched,r,{sessionId:e.sessionId,tabId:t,previousSessionId:e.sessionId,previousTabId:n})})}}},uMsf:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var o=n("fWyz"),r=n("2FbK"),s=n("RiEM");function i(e,t){return{type:"Navigate to sitemap area",execute(n,i){const l=Object(r.b)(n.getState()),c=e&&function(e,t){if(!t||!e||!e.AreaIds)return null;const n=e.Areas[t];for(const e of n.GroupIds){const t=n.Groups[e];for(const e of t.SubAreaIds){const n=t.SubAreas[e];if(!Object(s.d)(n)&&a(n))return n}}return null}(l,e);if(c)return n.dispatch(Object(o.b)(c,!1,null,t))}}}function a(e){return!e.Url||!e.Url.toLowerCase().endsWith("msdyn_launchdesigner.html")}},vYkK:function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return S}));var o=n("fILV"),r=n("cfbi"),s=n("OKVy"),i=n("baQL"),a=n("fA3V"),l=n("Nk+G"),c=n("2FbK"),u=n("iZ7K"),p=n("uZvv"),d=n("FdB0"),h=n("UZFl"),b=n("gw2m"),y=n("fWyz"),m=n("NjDY");function f(e,t,n){var p;if(!n||!t)return null;const y=Object(c.b)(e);if(!y)return null;let m;if(n.isQueryMode)return null;switch(t){case o.a:const t=n;m=v(e,y,t.entityTypeName,null===(p=t.viewId)||void 0===p?void 0:p.guid);break;case r.b:m=function(e,t,n){const o=Object(u.r)(e,n.entityTypeName),r=n.entityTypeName,s=[A(r),R(r)];n.formId&&s.unshift(function(e,t){const n=new RegExp(`[&\\?]formId=${t}\\b`,"i");return t=>F(t.Url)&&t.Url.search(`[&\\?]etn=${e}\\b`)>=0&&t.Url.search(n)>=0}(r,n.formId.guid));return I(e,t,s)||o&&I(e,t,[R("activitypointer")])}(e,y,n);break;case s.a:m=function(e,t,n){const o=n.dashboardId;if(n.etn)return v(e,t,n.etn);const r=g(e,t),s=S(e,t),i=s&&j(s);return function(e,t,n,o){let r=null,s=n;if(n){r=o;for(const e of n.GroupIds){const o=n.Groups[e];for(const e of o.SubAreaIds){const s=o.SubAreas[e];if(j(s)&&(r||(r=s),t&&(s.DefaultDashboard===t||s.Url&&s.Url.toLowerCase().includes(t))))return{subArea:s,area:n}}}if(r)return{subArea:r,area:n}}for(const n of e.AreaIds){const o=e.Areas[n];for(const e of o.GroupIds){const n=o.Groups[e];for(const e of n.SubAreaIds){const i=n.SubAreas[e];if(j(i)){if(t&&(i.DefaultDashboard===t||i.Url&&i.Url.toLowerCase().includes(t)))return{area:o,subArea:i};r||(r=i,s=o)}}}}return{subArea:r,area:s}}(t,o?o.guid:null,r,i&&s)}(e,y,n);break;case i.a:m={subArea:null,area:g(e,y)};break;case l.a:m=function(e,t,n){const o=n.customControlId;return I(e,t,[_(o)])}(e,y,n);break;case a.a:m=w(e,y,n.webresourceName);break;case d.a:m=function(e,t,n){const o=n&&n.uniqueName;return I(e,t,[M(o)])}(e,y,n);break;case h.a:m=w(e,y,"msdyn_appmanagementcontrol");break;case b.a:m=function(e,t,n){const o=null==n?void 0:n.name;return o&&I(e,t,[E(o)])}(e,y,n)}return m}function g(e,t){const n=Object(p.a)(e);return n&&t&&t.Areas&&t.Areas[n]}function S(e,t){const n=g(e,t),o=Object(p.c)(e);if(n)for(const e of n.GroupIds){const t=n.Groups[e];for(const e of t.SubAreaIds){const n=t.SubAreas[e];if(n.Id===o)return n}}return null}function v(e,t,n,o){const r=[A(n),R(n)];return o&&r.unshift(function(e,t){const n=new RegExp(`[&\\?]viewId=${t}\\b`,"i");return t=>F(t.Url)&&t.Url.search(`[&\\?]etn=${e}\\b`)>=0&&t.Url.search(n)>=0}(n,o)),I(e,t,r)}function w(e,t,n){return I(e,t,[O(Object(m.x)(e),n)])}function I(e,t,n){const o=g(e,t),r=S(e,t);for(const e of n)if(o&&r&&e(r))return{area:o,subArea:r};for(const e of n){let n=C(o,e);if(n)return n;for(const o of t.AreaIds)if(n=C(t.Areas[o],e),n)return n}return null}function C(e,t){if(!e||!e.GroupIds)return null;for(const n of e.GroupIds){const o=e.Groups[n];for(const n of o.SubAreaIds){const r=o.SubAreas[n];if(t(r))return{area:e,subArea:r}}}return null}function O(e,t){const n=e.toLowerCase(),o=t.toLowerCase();return e=>{const t=e.Url.toLowerCase();if(t.includes(n)){if(t.substring(n.length)===o)return!0}return!1}}function _(e){const t="controlname="+e.toLowerCase(),n=new RegExp("\\b"+t+"\\b");return e=>{const t=e.Url.toLowerCase();return n.test(t)}}function R(e){return t=>t.Entity===e||F(t.Url)&&t.Url.search(`[&\\?]etn=${e}\\b`)>=0}function A(e){return t=>t.Entity===e||F(t.Url)&&t.Url.search(`[&\\?]etn=${e}\\b`)>=0&&-1===t.Url.search(/[&\\?]viewId=/i)&&-1===t.Url.search(/[&\\?]formId=/i)}function M(e){return t=>t.DynamicPage===e}function E(e){return t=>t.Page===e}function j(e){return Object(y.a)(e)||e.Url&&e.Url.toLowerCase().includes("pagetype=dashboard")}function F(e){return e&&/^\/([0-9a-zA-Z_]+\/)?main.aspx/.test(e)}},viw0:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var o=n("D+Bz"),r=n("vYkK"),s=n("0FMG"),i=n("uZvv"),a=n("arV0"),l=n("rcL5");function c(e,t){var n;if("page.initialize"===t.type){const c=t;if(c.meta.source!==o.b.SiteMapSubArea){const t=null===(n=c.meta)||void 0===n?void 0:n.pageId;if(t&&(Object(a.h)(e.getState(),t)||Object(l.a)(e.getState(),t)))return;e.dispatch(Object(s.d)(t));const o=e.getState(),u=Object(r.a)(o,c.payload.__pageName,c.payload.input);u&&u.area&&u.subArea?(e.dispatch(Object(s.e)(u.area.Id)),e.dispatch(Object(s.f)(u.subArea.Id,t))):(!Object(i.a)(o)&&e.dispatch(Object(s.e)(Object(i.b)(o))),e.dispatch(Object(s.f)(null,t)))}}}}}]),window.bundleExecutionMarkers["scripts/58.js?v=1.4.3886-master"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();