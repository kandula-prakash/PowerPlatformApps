(window.webpackJsonp=window.webpackJsonp||[]).push([[258],{7980:function(e,t,o){"use strict";o.r(t),o.d(t,"mapStateToProps",(function(){return S})),o.d(t,"mapDispatchToProps",(function(){return b})),o.d(t,"SolutionLayersListPageContainer",(function(){return h}));var n=o(5583),r=o(922),i=o(5699),a=o(5810),s=o(7981),l=o(5690),u=o(5686),c=o(5689),m=o(5437),d=o(5691),p=o(5746),y=o(5787),g=o(5487),S=(e,t)=>{var o,n,{rootProps:r,fetchBreadcrumbError:s}=t,l=r.currentEnvironment&&r.currentEnvironment.id,u=Object(i.getSolutionId)(t),c=null!==(o=t.componentId)&&void 0!==o?o:Object(i.getSolutionComponentId)(t),m=Object(d.normalizedSolutionsSelector)(e),g=Object(i.getSolutionBySolutionId)(m,u),S=Object(a.solutionComponents)(e),b=Object(i.getEntityComponentType)(t),h=Object(d.isSolutionListLoading)(e),C=null===(n=p.solutionsSelectors.solutionsListError(e,l))||void 0===n?void 0:n.errorMessage,f=Object(a.isFetchingSolutionComponent)(e,u,l),O=y.solutionComponentSelectors.solutionComponentListErrorsSelector(e,u,l);return t.openPanelActions||(t.openPanelActions={}),{currentSolution:g,solutionComponentId:c,solutionId:u,solutionComponents:S,solutions:m,openPanelActions:t.openPanelActions,overrideBreadcrumbItems:t.overrideBreadcrumbItems,fetchSolutionLoading:h,fetchSolutionError:C,fetchSolutionComponentLoading:f,fetchSolutionComponentError:O,fetchBreadcrumbError:s,componentType:b}},b=e=>({fetchSolutionComponentsRequest:(t,o,n)=>{e(Object(u.fetchSolutionComponentsRequest)({solutionId:t,solutionName:o,componentId:n}))},fetchSolutionByIdRequest:t=>{e(Object(l.fetchSolutionByIdRequest)({solutionID:t}))},getRowClickActionForComponent:(t,o,n)=>{e(Object(c.getRowClickActionForComponent)(t,o,n))}}),h=Object(r.translateService)("PowerappsPortal")(Object(g.withRootProps)(Object(n.withNavigation)(Object(m.connect)(S,b)(s.SolutionLayersListPage))))},7981:function(e,t,o){"use strict";o.r(t),o.d(t,"SolutionLayersListPage",(function(){return x}));var n=o(245),r=o.n(n),i=o(4792),a=o(7982),s=o(5583),l=o(5623),u=o(5700),c=o(5699),m=o(5487),d=o(2886),p=o(5607),y=o(5808),g=o(5609),S=o(6488),b=o(5593),h=o(3076),C=o(7983),f=o(4795),O=o(1697),v=o(7984),L=o(5689),j=o(7987),E=o(2871),w=o(5611),P=o(860),M=o(3829);function T(){return(T=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e}).apply(this,arguments)}function B(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function D(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?B(Object(o),!0).forEach((function(t){I(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):B(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function I(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var x=e=>{var t,{t:o,tReady:B}=e,{rootProps:{currentEnvironment:I}}=Object(n.useContext)(m.RootPropsContext),{navigate:x}=Object(n.useContext)(s.NavigationContext),{overrideBreadcrumbItems:R}=e,{environmentClient:N}=Object(n.useContext)(h.ApolloClientContext),{enableSolutionTreeView:k}=Object(M.useSolutionPageSelectorProvider)(),[A,F]=Object(n.useState)(!1),[W,U]=Object(n.useState)(null),[H,q]=Object(n.useState)(!1),[z,G]=Object(n.useState)("StaticKey"),[K,J]=Object(n.useState)(0),[Q,V]=r.a.useState(""),[X,Y]=Object(n.useState)(!1),[Z,$]=Object(n.useState)(!1),[_,ee]=Object(n.useState)(!1),te=Object(y.getSolutionComponentMappingKey)(I.id,e.solutionId,void 0),{data:oe,status:ne,error:re}=Object(S.useGetSubComponent)(I.id,e.solutionComponentId,e.componentType,{enabled:!!e.componentType&&(null===(t=e.componentType)||void 0===t?void 0:t.toLowerCase())==w.StandardSolutionComponentTypes.SystemForm.logicalName});Object(n.useEffect)(()=>{var t;(Z||e.currentSolution||!e.solutionId||(e.fetchSolutionByIdRequest(e.solutionId),$(!0)),X)||e.fetchSolutionComponentsRequest(e.solutionId,null===(t=e.currentSolution)||void 0===t?void 0:t.uniquename)},[e.solutionId,e.currentSolution]);var ie=Object(n.useMemo)(()=>{var t,o=oe||Object(c.getSolutionComponentById)(e.solutionComponents,te,e.solutionComponentId);o||!e.solutionComponentId||X||(e.fetchSolutionComponentsRequest(e.solutionId,null===(t=e.currentSolution)||void 0===t?void 0:t.uniquename,e.solutionComponentId),Y(!0));return o},[oe,e.solutionComponents,te,e.solutionComponentId]),ae=e.solutionComponentId,se=Object(d.getSolutionDisplayName)(e.currentSolution),le=Object(p.getSolutionComponentDisplayName)(ie)||"-",ue=Object(p.getSolutionComponentsType)(ie),ce=Object(p.getTypeFromSolutionComponent)(ie),me=Object(g.getSolutionComponentTypeName)(ce,ue,ie)||"",{errorMessage:de,loading:pe,setErrorMessage:ye,solutionLayerList:ge,refetch:Se=(()=>{})}=Object(S.useSolutionLayersQuery)(N,{solutionComponentTypeName:me,solutionComponentId:ae},b.PortalScope,o("Common.Request.Failed")),be=Object(v.useDeleteConfirmationModal)({t:o,solutionComponentId:ae,solutionComponentTypeName:me,solutionComponentName:le}),he=(null==R?void 0:R.map(e=>{var t=e.text;return"subResource"===e.key&&(t=le||"-"),D(D({},e),{},{text:t})}))||Object(c.initializeBreadcrumbItem)(e.solutionId,se,ae,le,()=>{x(l.solutionLayersListRoute.canvas,!0)},()=>{x(Object(l.getSolutionComponentsUrlForMode)(e.solutionId),!0)},!Object(g.areSameSolutionComponentType)(ce,w.StandardSolutionComponentTypes.Dialog)||E.featureGates.enableDialogEdit?()=>{switch(Object(c.actionOnSolutionComponentsClick)(ie)){case c.ActionOnSolutionComponentsClick.Dispatch:e.getRowClickActionForComponent(e.currentSolution,ie,x);break;case c.ActionOnSolutionComponentsClick.Navigate:x(Object(l.getSolutionComponentsUrlForMode)(e.solutionId),!0);break;case c.ActionOnSolutionComponentsClick.NavigateAndDispatch:x(Object(l.getSolutionComponentsUrlForMode)(e.solutionId),!0),e.getRowClickActionForComponent(e.currentSolution,ie,x);break;case c.ActionOnSolutionComponentsClick.ProcessComponentClickEvent:Object(L.processComponentClickEvent)(I.name,e.currentSolution,ie,x)}}:void 0,o);Object(n.useEffect)(()=>{Object(P.getResponsiveMode)(window)<=P.ResponsiveMode.large&&ee(!!A)},[A]);var Ce;ge&&(Ce=ge.map(e=>{var t=e;return t.filterOn=[t.publisherName,t.solutionName,t.layerOrder.toString()],t}));Object(n.useEffect)(()=>{be.waitingForResponse||""!==be.errorMessage||(ge&&Ce&&Ce.find(e=>e.solutionName!==o("Model.SolutionLayers.LayerStatus.active"))&&(F(!1),G("StaticKey"+J(K+1))),Se())},[be.waitingForResponse,be.errorMessage]);var fe=r.a.createElement(a.SolutionLayersList,T({t:o,tReady:B,listItems:Ce||[],loading:pe,onSelection:e=>{var t,o=null;e.getSelectedCount()>0&&(t="Active"===(o=e.getSelection()[0]).solutionName),F(void 0!==t),q(!!t),t&&be.setErrorMessage(""),U(o)},setKey:z,searchBy:Q},e)),{headerText:Oe,selectedPivot:ve}=Object(C.useSolutionLayersDetailsHeader)({showRemoveLayerButton:H});e.openPanelActions&&(e.openPanelActions.onRemoveUnmangedLayerClick=()=>{be.setDeleteModalState({showModal:!0})});var Le=o("Model.Solutions.SolutionLayersPage.loadingOverlayText");be.waitingForResponse&&(Le=o("Model.Solutions.SolutionLayersPage.removingActiveLayerOverlayText"));var je=[];return be.errorMessage&&je.push(r.a.createElement(O.MessageBar,{messageBarType:O.MessageBarType.error,isMultiline:!1,onDismiss:()=>be.setErrorMessage(""),dismissButtonAriaLabel:o("Common.close")},be.errorMessage)),de&&je.push(r.a.createElement(O.MessageBar,{messageBarType:O.MessageBarType.error,onDismiss:()=>ye(""),dismissButtonAriaLabel:o("Common.close")},de)),e.fetchBreadcrumbError&&je.push(r.a.createElement(O.MessageBar,{messageBarType:O.MessageBarType.error},e.fetchBreadcrumbError)),e.fetchSolutionComponentError&&je.push(r.a.createElement(O.MessageBar,{messageBarType:O.MessageBarType.error},e.fetchSolutionComponentError)),e.fetchSolutionError&&je.push(r.a.createElement(O.MessageBar,{messageBarType:O.MessageBarType.error},e.fetchSolutionError)),r.a.useEffect(()=>{"error"===ne&&re&&je.push(r.a.createElement(O.MessageBar,{messageBarType:O.MessageBarType.error},re))},[ne,re]),r.a.createElement(i.Page,{renderHeader:()=>!_&&r.a.createElement(j.SolutionLayersListCommandBarContainer,{selectedLayer:W,solutionComponentId:e.solutionComponentId,solutionComponentName:le,solutionComponentType:ue,solutionComponentTypeName:me,showRemoveLayerButton:H,solutionId:e.solutionId,t:o,tReady:B,openPanelActions:e.openPanelActions,onSearchFilterUpdate:V,searchBy:Q,enableSolutionTreeView:k}),renderTitle:()=>r.a.createElement(c.SolutionLayersListPageHeader,{t:o,tReady:B,onSearchFilterUpdate:V,searchBy:Q,breadCrumbItems:he,messageBarContentList:je}),renderBody:()=>r.a.createElement("div",{className:u.solutionLayersListPageStyleClasses.solutionLayersListPageListcontainer},be.deleteDialog(),fe),paneProps:{isOpen:A,onRenderHeader:()=>Oe,hasCloseButton:!0,closeButtonAriaLabel:o("Model.Solutions.SolutionLayersPage.close"),onDismiss:()=>{F(!1)},type:f.PaneSize.medium,onRenderBody:()=>r.a.createElement(C.SolutionLayersDetails,{selectedItem:W,selectedPivot:ve}),className:_?u.solutionLayersListPageStyleClasses.paneInSmallScreen:void 0},spinnerProps:{label:Le},showOverlay:be.waitingForResponse||e.fetchSolutionLoading||e.fetchSolutionComponentLoading||e.isLoading||pe,styles:u.solutionLayersListPageStyle})}},7982:function(e,t,o){"use strict";o.r(t),o.d(t,"getSolution",(function(){return h})),o.d(t,"getLayerStatus",(function(){return C})),o.d(t,"SolutionLayersList",(function(){return f}));var n=o(719),r=o(545),i=o(3064),a=o(5633),s=o(245),l=o.n(s),u=o(2882),c=o(5492),m=o(3161),d=o(2844);function p(){return(p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e}).apply(this,arguments)}function y(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function g(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?y(Object(o),!0).forEach((function(t){S(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):y(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function S(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var b=Object(n.mergeStyleSets)({listRoot:{selectors:{".displayName":{color:u.fabricColors.bokaraGrey,fontFamily:c.fonts.segoeUi,fontSize:"14px",lineHeight:"20px"},".is-selected":{selectors:{".displayName":{fontFamily:c.fonts.segoeUiSemibold,color:u.fabricColors.neutralTuatara}}}}}}),h=(e,t)=>e==t("Model.SolutionLayers.LayerStatus.active")?t("Model.SolutionLayers.SolutionName.unmanagedLayer"):e,C=(e,t)=>e==t("Model.SolutionLayers.LayerStatus.active")?t("Model.SolutionLayers.LayerStatus.active"):t(""),f=e=>{var{listItems:t,loading:o,setKey:n,tReady:u,t:c,searchBy:y}=e,S=(e.lng,new r.Selection({onSelectionChanged:()=>{e.onSelection(S)}})),f=Object(s.useMemo)(()=>((e,t,o,n)=>{if(!t)return[];var r={minWidth:40,maxWidth:80,isResizable:!0,isCollapsable:!0,isMultiline:!1,isPadded:!0,isSorted:!1,isSortedDescending:!1,sortAscendingAriaLabel:o("Common.Sorting.ascending"),sortDescendingAriaLabel:o("Common.Sorting.descending")};return[g(g({},r),{},{key:"order",minWidth:100,maxWidth:218,name:o("Model.SolutionLayers.List.Header.order"),fieldName:"layerOrder",onRender:e=>e.layerOrder}),g(g({},r),{},{key:"solution",minWidth:100,maxWidth:269,name:o("Model.SolutionLayers.List.Header.solutionName"),fieldName:"solutionName",onRender:e=>h(e.solutionName,o)}),g(g({},r),{},{key:"publisherName",minWidth:100,maxWidth:269,name:o("Model.SolutionLayers.List.Header.publisherName"),fieldName:"publisherName",onRender:e=>e.publisherName}),g(g({},r),{},{key:"layerStatus",minWidth:100,maxWidth:276,name:o("Model.SolutionLayers.List.Header.layerStatus"),fieldName:"layerStatus",onRender:e=>C(e.solutionName,o)})]})(0,u,c),[u]);return t.length||o?l.a.createElement(i.DetailsList,p({},Object(a.getDetailsListProps)(c("Common.rowSelectionAriaLabel")),{items:t,columns:f,setKey:n,selectionMode:r.SelectionMode.single,className:b.listRoot,selection:S,filter:y})):l.a.createElement(m.EmptyState,{styles:{root:{padding:"20px"}},icon:d.fabricIcons.DocumentSet,primaryMessage:c("Model.Solutions.SolutionLayersPage.noSolutionLayersFound")})}},7984:function(e,t,o){"use strict";o.r(t),o.d(t,"useDeleteConfirmationModal",(function(){return c}));var n=o(245),r=o.n(n),i=o(7985),a=o(6502),s=o(3076),l=o(2880);function u(e,t,o,n,r,i,a){try{var s=e[i](a),l=s.value}catch(u){return void o(u)}s.done?t(l):Promise.resolve(l).then(n,r)}function c(e){var{t:t,solutionComponentId:o,solutionComponentTypeName:c,solutionComponentName:m}=e,[d,p]=Object(n.useState)({showModal:!1}),[y,g]=Object(n.useState)(""),[S,b]=Object(n.useState)(!1),{environmentClient:h}=Object(n.useContext)(s.ApolloClientContext),C=function(){var e,t=(e=function*(e,t){yield Object(a.solutionLayersRemoveQuery)(h,{solutionComponentTypeName:e,solutionComponentId:t}).then(()=>{b(!1),g("")}).catch(e=>{b(!1),g(JSON.parse(e.graphQLErrors[0].message).data.error.message)})},function(){var t=this,o=arguments;return new Promise((function(n,r){var i=e.apply(t,o);function a(e){u(i,n,r,a,s,"next",e)}function s(e){u(i,n,r,a,s,"throw",e)}a(void 0)}))});return function(e,o){return t.apply(this,arguments)}}();return{setDeleteModalState:p,deleteDialog:()=>r.a.createElement(i.ConfirmDialog,{showCloseButton:!0,title:t("Model.Solutions.LayerListPage.deleteUnmanagedLayer"),subText:Object(l.formatResourceString)(t("Model.Solutions.LayerListPage.deleteUnmanagedLayerBody"),m,c),cancelButtonText:t("Model.Solutions.LayerListPage.cancel"),confirmButtonText:t("Model.Solutions.LayerListPage.delete"),onCancel:()=>p({showModal:!1}),onConfirm:()=>{b(!0),C(c,o),p({showModal:!1})},hidden:!d.showModal}),waitingForResponse:S,errorMessage:y,setErrorMessage:g}}},7985:function(e,t,o){"use strict";o.r(t),o.d(t,"ConfirmDialog",(function(){return u}));var n=o(890),r=o(684),i=o(1755),a=o(1201),s=o(245),l=o(7986);function u(e){var[t,o]=s.useState(!1);s.useEffect(()=>{e.hidden||o(!1)},[e.hidden]);var u=s.useCallback(()=>{o(!0),e.onConfirm()},[e]);if(e.hidden)return null;var c=e.isDestructive?r.DefaultButton:r.PrimaryButton,m=e.isDestructive?r.PrimaryButton:r.DefaultButton,d=null;return d=void 0!==e.linkUri&&""!==e.linkUri?s.createElement(m,{onClick:()=>e.onClick(e.linkUri),text:e.linkText}):!e.hideCancelButton&&s.createElement(m,{onClick:e.onCancel,text:e.cancelButtonText}),s.createElement(n.Dialog,{hidden:e.hidden,dialogContentProps:{type:n.DialogType.normal,title:e.title,subText:e.subText,showCloseButton:e.showCloseButton,styles:l.getDialogContentStyles},onDismiss:e.onCancel,maxWidth:e.maxWidth?e.maxWidth:400,isBlocking:!0},e.isComponentLoading&&s.createElement("div",{className:l.confirmDialogStyleClasses.wrapperClass},s.createElement(i.Shimmer,{customElementsGroup:s.createElement("div",null,s.createElement(i.ShimmerElementsGroup,{width:"100%",flexWrap:!0,shimmerElements:[{type:i.ShimmerElementType.line,width:"50%",height:16},{type:i.ShimmerElementType.gap,width:"50%"},{type:i.ShimmerElementType.gap,width:"100%",height:16},{type:i.ShimmerElementType.line,width:"70%",height:12},{type:i.ShimmerElementType.gap,width:"30%"},{type:i.ShimmerElementType.gap,width:"100%",height:16},{type:i.ShimmerElementType.line,width:"80%",height:12},{type:i.ShimmerElementType.gap,width:"20%"},{type:i.ShimmerElementType.gap,width:"100%",height:16},{type:i.ShimmerElementType.line,width:"70%",height:12},{type:i.ShimmerElementType.gap,width:"30%"}]}))})),!e.isComponentLoading&&s.createElement(n.DialogFooter,null,s.createElement(c,{onClick:u,text:e.confirmButtonText,onRenderIcon:()=>t&&s.createElement(a.Spinner,{size:a.SpinnerSize.small,labelPosition:"right"}),disabled:t}),d))}},7986:function(e,t,o){"use strict";o.r(t),o.d(t,"confirmDialogStyleClasses",(function(){return r})),o.d(t,"getDialogContentStyles",(function(){return a}));var n=o(719),r=Object(n.mergeStyleSets)({wrapperClass:{height:"140px",width:"426px"}}),i={contentLgHeader:"ms-Dialog-lgHeader",close:"ms-Dialog--close",subText:"ms-Dialog-subText",header:"ms-Dialog-header",headerLg:"ms-Dialog--lgHeader",button:"ms-Dialog-button ms-Dialog-button--close",inner:"ms-Dialog-inner",content:"ms-Dialog-content",title:"ms-Dialog-title"},a=e=>{var{theme:t}=e,o=Object(n.getGlobalClassNames)(i,t);return{title:{fontWeight:"inherit",fontSize:"20px",overflowWrap:"break-word"},content:o.content,subText:[o.subText,{fontSize:"14px"}],header:o.header,button:o.button,inner:o.inner,innerContent:{},topButton:{}}}}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/258.30ee688b.chunk.js.map