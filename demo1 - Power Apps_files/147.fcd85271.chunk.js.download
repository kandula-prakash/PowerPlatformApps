/*! For license information please see 147.fcd85271.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[147],{5589:function(e,t,r){"use strict";r.r(t),r.d(t,"useQueryWithTelemetryScenario",(function(){return s}));var n=r(3152),o=r(217),i=r(245),a=r(3192);function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach((function(t){l(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function s(e){var{query:t,queryOptions:r,telemetryScope:u,scenarioName:l,defaultErrorMessage:s,getScenarioCompletionData:p}=e,[f,d]=Object(i.useState)(),g=Object(n.useQuery)(t,c(c({},r),{},{onCompleted:e=>{var t;null==f||f.complete(p(e)),null===(t=r.onCompleted)||void 0===t||t.call(r,e)},onError:e=>{var t,n=Object(a.getResponseMessageFromApolloError)(e,s);null==f||f.failure({error:n,clientError:e.message}),null===(t=r.onError)||void 0===t||t.call(r,e)}})),O=g.loading;return Object(i.useEffect)(()=>{O&&d(Object(o.trackLoadScenario)(u,l))},[O]),g}},5893:function(e,t,r){"use strict";r.r(t),r.d(t,"usePowerSettings",(function(){return h})),r.d(t,"usePowerSetting",(function(){return P})),r.d(t,"convertAppIdToUniqueName",(function(){return E})),r.d(t,"useAppSettingOverrides",(function(){return D})),r.d(t,"useSaveOrgSetting",(function(){return L})),r.d(t,"useSaveAppSetting",(function(){return A})),r.d(t,"useDeleteAppSetting",(function(){return M})),r.d(t,"useUpdateSettingDefinition",(function(){return N})),r.d(t,"useCreateSettingDefinition",(function(){return F}));var n,o=r(245),i=r(3128),a=r.n(i),u=r(3152),c=r(3144),l=r(217),s=r(3193),p=r(5894),f=r(5895),d=["data"],g=["data"],O=["data"],b=["mutate"],m=["mutate"],v=["mutate"];function y(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function j(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?y(Object(r),!0).forEach((function(t){S(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function S(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function C(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var h=(e,t)=>{var{environmentClient:r,genericClient:n}=Object(o.useContext)(c.ApolloClientContext);e=E(null!=r?r:n,e,t,e.telemetryScope);var i=Object(f.useQueryWithClient)(j(j({},e),{},{query:p.fetchPowerSettingsQuery,scenarioName:s.TelemetryScenarioNames.powerSettingsFetch,getScenarioCompletionData:e=>{var t,r;return{length:null!==(t=null==e||null===(r=e.fetchPowerSettings)||void 0===r?void 0:r.length)&&void 0!==t?t:0}}})),{data:a}=i;return j(j({},C(i,d)),{},{powerSettings:null==a?void 0:a.fetchPowerSettings})},P=e=>{var t=Object(f.useQueryWithClient)(j(j({},e),{},{query:p.fetchPowerSettingQuery,scenarioName:s.TelemetryScenarioNames.powerSettingsFetch,getScenarioCompletionData:e=>({exists:!(null==e||!e.fetchPowerSetting)})})),{data:r}=t;return j(j({},C(t,g)),{},{powerSetting:null==r?void 0:r.fetchPowerSetting})},w=(e,t,r)=>{try{return e.readFragment({id:"AppModuleCds:".concat(t),fragment:a()(n||(o=["\n        fragment fetchAppDisplayName on AppModuleCds {\n          uniqueName\n          displayName\n        }\n      "],i||(i=o.slice(0)),n=Object.freeze(Object.defineProperties(o,{raw:{value:Object.freeze(i)}}))))})}catch(u){return Object(l.trackErrorTrace)(r,{eventName:"getCachedAppFields/Error",eventData:{error:u}}),null}var o,i},E=(e,t,r,n)=>{var o=t;if(null!=t&&t.variables&&!t.variables.appUniqueName&&null!=r){var i=w(e,r,n);i&&(o=j(j({},t),{},{variables:j(j({},t.variables),{},{appUniqueName:null==i?void 0:i.uniqueName})}))}return o},D=e=>{var t,{environmentClient:r,genericClient:n}=Object(o.useContext)(c.ApolloClientContext),i=null!=r?r:n,a=Object(f.useQueryWithClient)(j(j({},e),{},{query:p.fetchAppSettingOverridesQuery,scenarioName:s.TelemetryScenarioNames.appOverrideFetch,getScenarioCompletionData:e=>({exists:!(null==e||!e.fetchAppSettingOverrides)})})),{data:u}=a,l=C(a,O),d=null==u||null===(t=u.fetchAppSettingOverrides)||void 0===t?void 0:t.map(t=>{if(null==t||!t.appDisplayName){var r=w(i,e.variables.appId,e.telemetryScope);return j(j({},t),{},{appDisplayName:null==r?void 0:r.displayName})}return t});return j(j({},l),{},{appOverrides:d})},L=()=>{var e=Object(f.useMutationWithClient)(p.saveOrgSettingQuery),{mutate:t}=e;return j(j({},C(e,b)),{},{saveOrgSetting:t})},A=e=>{var{environmentClient:t,genericClient:r}=Object(o.useContext)(c.ApolloClientContext),n=t||r,[i,a]=Object(u.useMutation)(p.saveAppSettingQuery,{client:n});return j(j({},a),{},{saveAppSetting:t=>{var r,o,a,u,c=t;n&&(c=E(n,t,null==t||null===(a=t.variables)||void 0===a?void 0:a.appId,e));null!==(r=c)&&void 0!==r&&null!==(o=r.variables)&&void 0!==o&&o.appUniqueName||Object(l.trackErrorTrace)(e,{eventName:"saveAppSetting/Error",eventData:{error:"appUniqueName missing for appId ".concat(null==t||null===(u=t.variables)||void 0===u?void 0:u.appId)}});return i(c)}})},M=()=>{var{environmentClient:e,genericClient:t}=Object(o.useContext)(c.ApolloClientContext),r=null!=e?e:t,[n,i]=Object(u.useMutation)(p.deleteAppSettingOverrideMutation,{client:r,onCompleted:e=>{null!=e&&e.deleteAppSettingOverride&&r.resetStore()}});return j(j({},i),{},{deleteAppSetting:n})},N=()=>{var e=Object(f.useMutationWithClient)(p.updateSettingDefinitionQuery),{mutate:t}=e;return j(j({},C(e,m)),{},{updateSettingDefinition:t})},F=()=>{var e=Object(f.useMutationWithClient)(p.createSettingDefinitionQuery),{mutate:t}=e;return j(j({},C(e,v)),{},{createSettingDefinition:t})}},5895:function(e,t,r){"use strict";r.r(t),r.d(t,"useQueryWithClient",(function(){return d})),r.d(t,"useMutationWithClient",(function(){return g}));var n=r(245),o=r(3152),i=r(3076),a=r(5589),u=r(3192),c=["getScenarioCompletionData","scenarioName","query","telemetryScope","defaultErrorMessage"];function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){p(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function p(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function f(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function d(e){var t,r,{environmentClient:o,genericClient:l}=Object(n.useContext)(i.ApolloClientContext),[p,d]=Object(n.useState)(""),{getScenarioCompletionData:g,scenarioName:O,query:b,telemetryScope:m,defaultErrorMessage:v}=e,y=f(e,c),j=Object(a.useQueryWithTelemetryScenario)({getScenarioCompletionData:g,scenarioName:O,query:b,telemetryScope:m,defaultErrorMessage:v,queryOptions:s(s({},y),{},{client:null!==(t=null!==(r=e.client)&&void 0!==r?r:o)&&void 0!==t?t:l})});return Object(n.useEffect)(()=>{j.error&&d(Object(u.getResponseMessageFromApolloError)(j.error,v))},[j.error,j.data,j.loading]),Object(n.useEffect)(()=>{p&&j.data&&!j.loading&&!j.error&&d("")},[j.data,j.loading]),s(s({},j),{},{errorMessage:p})}function g(e,t){var{environmentClient:r,genericClient:a}=Object(n.useContext)(i.ApolloClientContext),[u,c]=Object(o.useMutation)(e,s({client:r||a},t));return s(s({},c),{},{mutate:u})}},5898:function(e,t,r){"use strict";r.r(t);var n=r(5899);r.d(t,"ComponentLoadState",(function(){return n.ComponentLoadState})),r.d(t,"getTotalLoadingState",(function(){return n.getTotalLoadingState})),r.d(t,"hasFailureWithUnexpectedError",(function(){return n.hasFailureWithUnexpectedError})),r.d(t,"hasError",(function(){return n.hasError})),r.d(t,"hasACompletion",(function(){return n.hasACompletion})),r.d(t,"hasErrorMessage",(function(){return n.hasErrorMessage})),r.d(t,"getErrorMessages",(function(){return n.getErrorMessages})),r.d(t,"getStoppedLoadingCount",(function(){return n.getStoppedLoadingCount})),r.d(t,"isLoading",(function(){return n.isLoading})),r.d(t,"toLoadingState",(function(){return n.toLoadingState})),r.d(t,"findLoadingDifferences",(function(){return n.findLoadingDifferences})),r.d(t,"findInitialLoadingDifferences",(function(){return n.findInitialLoadingDifferences}));var o=r(5900);r.d(t,"useLoadProgressTelemetry",(function(){return o.useLoadProgressTelemetry}))},5899:function(e,t,r){"use strict";r.r(t),r.d(t,"ComponentLoadState",(function(){return n})),r.d(t,"getTotalLoadingState",(function(){return c})),r.d(t,"hasFailureWithUnexpectedError",(function(){return l})),r.d(t,"hasError",(function(){return s})),r.d(t,"hasACompletion",(function(){return p})),r.d(t,"hasErrorMessage",(function(){return f})),r.d(t,"getErrorMessages",(function(){return d})),r.d(t,"getStoppedLoadingCount",(function(){return g})),r.d(t,"isLoading",(function(){return O})),r.d(t,"toLoadingState",(function(){return b})),r.d(t,"findLoadingDifferences",(function(){return m})),r.d(t,"findInitialLoadingDifferences",(function(){return v}));var n,o=r(2812);function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){u(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function u(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function c(e){return e&&0!==e.length?e.some(e=>(null==e?void 0:e.state)===n.Fail)?n.Fail:e.some(e=>!e||e.state===n.Loading)?n.Loading:n.Complete:n.Complete}function l(e){return e.some(e=>e.state===n.Fail&&!e.isExpectedError)}function s(e){return e.some(e=>e.state===n.Fail)}function p(e){return e.some(e=>e.state===n.Complete)}function f(e){return e.some(e=>e.state===n.Fail&&!!e.info)}function d(e){return e.filter(e=>e.state===n.Fail&&!!e.info).map(e=>"string"==typeof e.info?e.info:JSON.stringify(e.info))}function g(e){return e?e.filter(e=>e.state!==n.Loading).length:0}function O(e){return e.some(e=>e.state===n.Loading)}function b(e){var{isComplete:t,errorMessage:r,name:o,info:i,needed:u=!0}=e;return u?r?{state:n.Fail,info:a({errorMessage:r},i),name:o}:t?{state:n.Complete,name:o,info:i}:{state:n.Loading,name:o,info:i}:{state:n.Canceled,name:o,info:i}}!function(e){e[e.Loading=0]="Loading",e[e.Complete=1]="Complete",e[e.Fail=2]="Fail",e[e.Canceled=3]="Canceled"}(n||(n={}));var m=(e,t,r)=>{var i={},a=[],u=0;if(t&&e)for(var c=0;c<t.length;c++){var l=t[c],s=e[c];if(void 0!==l&&void 0!==s){var p="";l.state===n.Fail&&s.state!==n.Fail?(p="Failed",a.push("".concat(l.name," failed"))):l.state===n.Complete&&s.state!==n.Complete?(p="Completed",a.push("".concat(l.name," completed"))):l.state===n.Canceled&&s.state!==n.Canceled?(p="Canceled",a.push("".concat(l.name," canceled"))):l.state===n.Loading&&l.subState!==s.subState&&(p="".concat(l.subState),a.push("".concat(l.name," : ").concat(l.subState))),p&&(i["".concat(l.name)]=l.info?"".concat(p," : ").concat(l.info):p)}void 0===l||l.state!==n.Complete&&l.state!==n.Canceled||(u+=1)}return Object(o.isEmpty)(a)||(r.push(a.join("; ")),i.CurrentStep=u,i.TotalSteps=t?t.length:0),i},v=(e,t)=>{var r=[];if(e)for(var i of e){var a=i.name;a||1!==e.length||(a="The only step");var u="";void 0!==i&&(i.state===n.Complete?u="".concat(a," completed"):i.state===n.Canceled?u="".concat(a," not needed"):i.state===n.Fail&&(u="".concat(a," failed")),u&&r.push(i.info?"".concat(u," : ").concat(i.info):u))}Object(o.isEmpty)(r)||t.push(r.join("; "))}},5900:function(e,t,r){"use strict";r.r(t),r.d(t,"useLoadProgressTelemetry",(function(){return p}));var n=r(245),o=r(2812),i=r(217),a=r(5899);function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach((function(t){l(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var s=(e,t,r)=>{var n,o=Object(a.getTotalLoadingState)(r);if(o===a.ComponentLoadState.Complete)null===(n=t.current)||void 0===n||n.complete(e);else if(o===a.ComponentLoadState.Fail){var i,u;if(Object(a.hasFailureWithUnexpectedError)(r))null===(i=t.current)||void 0===i||i.failure(e);else null===(u=t.current)||void 0===u||u.completeWithError(e)}t.current=void 0},p=e=>{var{eventScope:t,scenarioName:r,loadProgress:u,generalInfo:l,skip:p}=e,[f,d]=Object(n.useState)(u),g=Object(n.useRef)(),O=Object(n.useRef)([]);Object(n.useEffect)(()=>{if(!p){g.current=Object(i.trackLoadScenario)(t,r,l);var e=Object(a.getTotalLoadingState)(u);Object(a.findInitialLoadingDifferences)(u,O.current),e===a.ComponentLoadState.Complete?s(c(c({},l),{},{Summary:"Everything already finished. ".concat(O.current.join("; "))}),g,u):e===a.ComponentLoadState.Fail&&(g.current=void 0)}},[p]);var b=u.map(e=>e.state);Object(n.useEffect)(()=>{if(void 0!==(null==g?void 0:g.current))if(d(u),u.length>1){var e=Object(a.findLoadingDifferences)(f,u,O.current);Object(o.isEmpty)(e)||(g.current.progress(e),Object(a.isLoading)(u)||s(c(c({},l),{},{Summary:O.current.join("; ")}),g,u))}else if(1===u.length){u[0].state!==a.ComponentLoadState.Loading&&s(c({},l),g,u)}},b)}},6630:function(e,t,r){"use strict";r.r(t),r.d(t,"PowerPlatformSettingsName",(function(){return n})),r.d(t,"SettingsLearnMoreLink",(function(){return o}));var n="PowerPlatformSettings",o="https://go.microsoft.com/fwlink/?linkid=2180391"},6631:function(e,t,r){"use strict";r.r(t),r.d(t,"useAppModuleForOverrides",(function(){return l})),r.d(t,"getAllowedOverrides",(function(){return s})),r.d(t,"getDataType",(function(){return p})),r.d(t,"getOverrideDefault",(function(){return f}));var n=r(245),o=r(3185),i=r(3076),a=r(6499),u=r(6632),c=r(6630);function l(e,t){var{environmentClient:r,genericClient:a}=Object(n.useContext)(i.ApolloClientContext);Object(o.useAppModuleQuery)(null!=r?r:a,{appModuleId:null!=e?e:""},c.PowerPlatformSettingsName,"","",t)}var s=e=>{var t,r;return Object(u.getAllowedOverrides)(null!==(t=null==e?void 0:e.isOverridable)&&void 0!==t&&t,null!==(r=null==e?void 0:e.overridableLevel)&&void 0!==r?r:0)},p=e=>{switch(e){case a.PowerSettingTypeCode.Boolean:return"boolean";case a.PowerSettingTypeCode.Integer:return"number";case a.PowerSettingTypeCode.String:default:return"string"}},f=e=>{if(void 0!==e.defaultValue)return e.defaultValue;switch(e.dataType){case a.PowerSettingTypeCode.Boolean:return!1;case a.PowerSettingTypeCode.Integer:return 0;case a.PowerSettingTypeCode.String:default:return""}}}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/147.fcd85271.chunk.js.map