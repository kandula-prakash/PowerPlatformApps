/*! For license information please see app-module-designer.40af5c82.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[209],{10579:function(e,t,n){"use strict";n.r(t),n.d(t,"SolutionByIdQuery",(function(){return s}));var r,a=n(3128);var o,i,s=n.n(a)()(r||(o=["\n  query solutionById($id: String!) {\n    solution(id: $id) {\n      id\n      uniqueName\n      friendlyName\n      patchAvailable\n      isManaged\n      publisher {\n        id\n        customizationPrefix\n        customizationOptionValuePrefix\n      }\n    }\n  }\n"],i||(i=o.slice(0)),r=Object.freeze(Object.defineProperties(o,{raw:{value:Object.freeze(i)}}))))},11982:function(e,t,n){"use strict";n.r(t);var r=n(3152),a=n(3076),o=n(1105),i=n(1071),s=n(4135),c=n(922),l=n(217),u=n(245),d=n.n(u),p=n(10443),f=n(303),m=n(11983),b=n(12113),v=n(12157),g=n(12163),y=n(12164),h=n(12166),S=n(12185),O=n(12222),A=n(12223),P=n(12231),j=n(12232),E=n(12225),C=n(12233),T=n(12234),M=n(12281),w=n(12302),I=n(12342),N=n(12365),D=n(12366),x=n(12376),k=n(12200),R=n(12029),L=n(12377),U=n(12167),B=n(12380),F=n(12340),V=n(12381),q=n(12384),W=n(12034),H=n(12032),G=n(11984),z=n(12018),K=n(12385),X=n(12386),Q=n(12387),_=n(4163),Y=n(11990),Z=n(12388),J=n(12183),$=d.a.memo(e=>{var{t:t}=e,n=Object(p.useSelector)(H.appModuleTitle),r=n?t("designer.titleWithName",[n]):t("designer.title");return d.a.createElement(s.Designer.Title,null,r)}),ee=d.a.memo(e=>{var t,{t:n}=e,r=null!==(t=Object(p.useSelector)(H.appModuleTitle))&&void 0!==t?t:n("designer.header");return d.a.createElement(s.Designer.Header,null,r)}),te=()=>Object(p.useSelector)(H.getAppModule).loadState!==z.LoadStates.NotStarted?d.a.createElement(s.Designer.Canvas,null,d.a.createElement(E.ErrorNotificationBar,{styles:C.messageBarOverlayStyles,truncated:!0,isMultiline:!1}),d.a.createElement(w.PreviewCanvas,null)):null;var ne=Object(i.withServices)(e=>{var{t:t}=e,[n,a]=d.a.useState(T.enablePowerAppsFirstRunTour?"tour":"pages");Object(Z.useLogFirstRenderLoad)(Y.default.AppModuleDesignerLoad),Object(u.useEffect)(()=>{R.featureGates.consoleLogTelemetry&&Object(l.registerTelemetryClient)(new l.ConsoleTelemetryClient)},[]);var o=function(e){var{environmentClient:t,currentEnvironment:n,history:r,match:a,t:o}=e,i=d.a.useRef();return d.a.useMemo(()=>{if(i.current)return i.current;var e=null==n?void 0:n.properties.linkedEnvironmentMetadata;if(t&&e){var s=Object(B.makeUCISyncService)(e),c=new L.PackagerMonitor(t),l=Object(Q.default)(),u=Object(K.default)({apolloClient:t,routingProps:a.params,environmentProps:n,history:r,packagerMonitor:c,t:o,uciSyncService:s}),d=Object(X.default)(),p=Object(V.default)([d,l,...u]);return a.path===_.createRoute&&(Object(q.loadCreateAppDependencies)(p),p.dispatch(G.Actions.openCreateAppUI())),a.path===_.editRoute&&a.params.appModuleId&&Object(W.loadEditAppDependencies)(p,{appModuleId:a.params.appModuleId}),i.current={store:p,packagerMonitor:c,uciSyncService:s}}},[t,n,a,r,i])}(e);if(!o)return d.a.createElement(s.Designer,null,d.a.createElement(s.Designer.Title,null,t("designer.title")),d.a.createElement(s.Designer.Header,null,t("designer.header")),d.a.createElement(s.Designer.Toolbox,null));var{store:i,packagerMonitor:c,uciSyncService:f}=o;return d.a.createElement(j.default,null,d.a.createElement(p.Provider,{store:i},d.a.createElement(J.PresenceContextProvider,null,d.a.createElement(r.ApolloProvider,{client:e.environmentClient},d.a.createElement(U.PackagerMonitorContext.Provider,{value:c},d.a.createElement(F.UCISyncServiceContext.Provider,{value:f},d.a.createElement(s.Designer,null,d.a.createElement($,{t:t}),d.a.createElement(ee,{t:t}),d.a.createElement(s.Designer.Toolbox,{selectedKey:n,onSelectedItemChanged:e=>a(e)},d.a.createElement(s.Designer.ToolboxItem,{key:"pages",itemKey:"pages",itemIcon:"Page",headerText:t("pagesPane.header")},d.a.createElement(M.PagesPane,null)),d.a.createElement(s.Designer.ToolboxItem,{key:"navigation",itemKey:"navigation",itemIcon:"BulletedTreeList",headerText:t("navigation.header")},d.a.createElement(k.SiteMapPane,null)),d.a.createElement(s.Designer.ToolboxItem,{key:"data",itemKey:"data",itemIcon:"Database",headerText:t("data.header")},d.a.createElement(P.DataPane,null)),R.featureGates.automationPaneEnabled&&d.a.createElement(s.Designer.ToolboxItem,{key:"automation",itemKey:"automation",itemIcon:"FlowChart",headerText:t("automationPane.header")},d.a.createElement(v.AutomationPane,null)),T.enablePowerAppsFirstRunTour&&d.a.createElement(s.Designer.ToolboxItem,{key:"tour",itemKey:"tour",itemIcon:"D365TalentLearn",headerText:t("missionUIPane.header")},d.a.createElement(T.FirstRunTourProgressTrackerPane,null))),d.a.createElement(te,null),d.a.createElement(h.default,null),R.featureGates.enableCommentsPane&&d.a.createElement(S.CommentsPane,null),T.enablePowerAppsFirstRunTour&&d.a.createElement(T.FirstRunTour,null),d.a.createElement(I.PropertiesPane,null),d.a.createElement(D.default,null),d.a.createElement(A.CreateAppModal,null),d.a.createElement(m.AddPageModal,null),d.a.createElement(b.AddSubAreaModal,null),d.a.createElement(y.CanvasAuthoring,null),d.a.createElement(N.SaveConfirmationDialog,null),d.a.createElement(x.RemoveSiteMapNodeDialog,null),d.a.createElement(O.ConsoleCommands,null),d.a.createElement(g.BeforeUnload,null))))))))},[d.a.memo,Object(c.translateService)("AppModuleDesigner"),a.withApolloClient,o.withEnvironment,e=>Object(f.withRouter)(e)]);t.default=ne},11983:function(e,t,n){"use strict";n.r(t),n.d(t,"UnconnectedAddPageModal",(function(){return p})),n.d(t,"AddPageModal",(function(){return f}));var r=n(1071),a=n(922),o=n(895),i=n(245),s=n(10443),c=n(11984),l=n(12065),u=n(12068);function d(){return(d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var p=e=>{var t=Object(s.useSelector)(c.Selectors.isAddPageUIOpen),n=Object(s.useDispatch)(),r=()=>n(c.Actions.closeAddPageUI()),a=Object(l.useModalLayoutStyles)();return i.createElement(o.Modal,{isOpen:t,onDismiss:r,styles:{root:[a.root]},scrollableContentClassName:a.container},i.createElement(u.AddPageModalBody,d({},e,{onClickDismiss:r})))},f=Object(r.withServices)(p,[i.memo,Object(a.translateService)("AppModuleDesigner")])},11984:function(e,t,n){"use strict";n.r(t);var r=n(11985);n.d(t,"Actions",(function(){return r}));var a=n(11991);n.d(t,"makeMiddleware",(function(){return a.default}));var o=n(12064);n.d(t,"initialState",(function(){return o.initialState})),n.d(t,"reducer",(function(){return o.default}));var i=n(12060);n.d(t,"Selectors",(function(){return i}))},11985:function(e,t,n){"use strict";n.r(t),n.d(t,"clearSuccessfulSave",(function(){return c})),n.d(t,"clearSuccessfulPublish",(function(){return l})),n.d(t,"openCreateAppUI",(function(){return u})),n.d(t,"openAddPageUI",(function(){return d})),n.d(t,"closeAddPageUI",(function(){return p})),n.d(t,"openAddSubAreaUI",(function(){return f})),n.d(t,"closeAddSubAreaUI",(function(){return m})),n.d(t,"openAddBpfUI",(function(){return b})),n.d(t,"closeAddBpfUI",(function(){return v})),n.d(t,"openAppPreview",(function(){return g})),n.d(t,"openSwitchToClassic",(function(){return y})),n.d(t,"createAndAddCustomPage",(function(){return h})),n.d(t,"editEntityFormPage",(function(){return S})),n.d(t,"editEntityViewPage",(function(){return O})),n.d(t,"editEntityChartPage",(function(){return A})),n.d(t,"editDashboardPage",(function(){return P})),n.d(t,"editCustomPage",(function(){return j})),n.d(t,"editDataEntity",(function(){return E})),n.d(t,"dismissCreatingCustomPageDialog",(function(){return C})),n.d(t,"saveConfirmationDialog",(function(){return T})),n.d(t,"removeSiteMapNodeDialog",(function(){return M})),n.d(t,"selectPagesNode",(function(){return w})),n.d(t,"selectSiteMapNode",(function(){return I})),n.d(t,"updatePagesPaneExpandedItemKeys",(function(){return N})),n.d(t,"updateSiteMapPaneExpandedItemKeys",(function(){return D})),n.d(t,"updateDataPaneExpandedItemKeys",(function(){return x})),n.d(t,"editCommandBarFromEntity",(function(){return k})),n.d(t,"updateEnableWebResourceSubAreas",(function(){return R}));var r=n(11986),a=n(11987),o=n(11989),i=n(11988),s=n(11990),c=Object(r.createAction)("ui/CLEAR_SUCCESSFUL_SAVE")(),l=Object(r.createAction)("ui/CLEAR_SUCCESSFUL_PUBLISH")(),u=Object(r.createAction)("ui/OPEN_CREATE_APP")(),d=Object(r.createAction)("ui/OPEN_ADD_PAGE",a.noPayload,()=>Object(i.withTelemetryEventMeta)({eventName:o.default.AddPageOpen}))(),p=Object(r.createAction)("ui/CLOSE_ADD_PAGE")(),f=Object(r.createAction)("ui/OPEN_ADD_SUBAREA",a.noPayload,()=>Object(i.withTelemetryEventMeta)({eventName:o.default.AddSubAreaOpen}))(),m=Object(r.createAction)("ui/CLOSE_ADD_SUBAREA")(),b=Object(r.createAction)("ui/OPEN_ADD_BPF",a.noPayload,()=>Object(i.withTelemetryEventMeta)({eventName:o.default.AddBpfOpen}))(),v=Object(r.createAction)("ui/CLOSE_ADD_BPF")(),g=Object(r.createAction)("ui/PREVIEW",a.noPayload,()=>Object(i.withTelemetryEventMeta)({eventName:o.default.PlayOpen}))(),y=Object(r.createAction)("ui/SWITCH_TO_CLASSIC")(),h={requestCreate:Object(r.createAction)("ui/CREATE_AND_ADD_CUSTOM_PAGE/REQUEST_CREATE",Object(a.payload)(),Object(a.requestMeta)(s.default.CustomPagesCreate))(),requestAdd:Object(r.createAction)("ui/CREATE_AND_ADD_CUSTOM_PAGE/REQUEST_ADD",Object(a.payload)(),Object(a.progressMeta)(s.default.CustomPagesCreate))(),success:Object(r.createAction)("ui/CREATE_AND_ADD_CUSTOM_PAGE/SUCCESS",a.noPayload,Object(a.successMeta)(s.default.CustomPagesCreate))(),failure:Object(r.createAction)("ui/CREATE_AND_ADD_CUSTOM_PAGE/FAILURE",Object(a.payload)(),Object(a.failureMeta)(s.default.CustomPagesCreate))()},S={open:Object(r.createAction)("ui/ENTITY_FORM/EDIT",Object(a.payload)(),e=>Object(i.withTelemetryEventMeta)({eventName:o.default.EditFormOpen,eventData:{formId:e.formId}}))()},O={open:Object(r.createAction)("ui/ENTITY_VIEW/EDIT",Object(a.payload)(),e=>Object(i.withTelemetryEventMeta)({eventName:o.default.EditViewOpen,eventData:{viewId:e.viewId}}))()},A={open:Object(r.createAction)("ui/ENTITY_CHART/EDIT",Object(a.payload)(),e=>Object(i.withTelemetryEventMeta)({eventName:o.default.EditChartOpen,eventData:{chartId:e.chartId,entityTypeCode:e.entityTypeCode}}))()},P={open:Object(r.createAction)("ui/DASHBOARD/EDIT",Object(a.payload)(),e=>Object(i.withTelemetryEventMeta)({eventName:o.default.EditDashboardOpen,eventData:{dashboardId:e.dashboardId}}))()},j={open:Object(r.createAction)("ui/CUSTOM_PAGE/EDIT",Object(a.payload)(),e=>Object(i.withTelemetryEventMeta)({eventName:o.default.EditCustomPageOpen,eventData:{customPageId:e.customPage.id}}))()},E={open:Object(r.createAction)("ui/DATA_ENTITY/EDIT",Object(a.payload)(),e=>Object(i.withTelemetryEventMeta)({eventName:o.default.EditDataEntityOpen,eventData:{id:e.id}}))()},C=Object(r.createAction)("ui/DISMISS_CREATING_CUSTOM_PAGE_DIALOG")(),T={open:Object(r.createAction)("ui/SAVE_CONFIRMATION_DIALOG/OPEN",Object(a.payload)())(),saveAndContinue:Object(r.createAction)("ui/SAVE_CONFIRMATION_DIALOG/SAVE_AND_CONTINUE")(),dismiss:Object(r.createAction)("ui/SAVE_CONFIRMATION_DIALOG/DISMISS")()},M={open:Object(r.createAction)("ui/REMOVE_SITEMAP_NODE_DIALOG/OPEN",Object(a.payload)(),e=>Object(i.withTelemetryEventMeta)({eventName:o.default.OpenRemoveSiteMapNodeDialog,eventData:{nodePathType:e.path.pathType,areaIndex:e.path.areaIndex,groupIndex:e.path.groupIndex,subAreaIndex:e.path.subAreaIndex}}))(),dismiss:Object(r.createAction)("ui/REMOVE_SITEMAP_NODE_DIALOG/DISMISS")()},w=Object(r.createAction)("ui/SELECT_PAGES_NODE",Object(a.payload)())(),I=Object(r.createAction)("ui/SELECT_SITEMAP_NODE",Object(a.payload)())(),N=Object(r.createAction)("ui/UPDATE_PAGES_PANE_EXPANDED_ITEM_KEYS",Object(a.payload)())(),D=Object(r.createAction)("ui/UPDATE_SITEMAP_PANE_EXPANDED_ITEM_KEYS",Object(a.payload)())(),x=Object(r.createAction)("ui/UPDATE_DATA_PANE_EXPANDED_ITEM_KEYS",Object(a.payload)())(),k=Object(r.createAction)("ui/EDIT_COMMAND_BAR_FROM_ENTITY",Object(a.payload)(),()=>Object(i.withTelemetryEventMeta)({eventName:o.default.EditCommandBarFromEntity}))(),R=Object(r.createAction)("ui/UPDATE_ENABLE_WEBRESOURCE_SUBAREAS",Object(a.payload)(),e=>Object(i.withTelemetryEventMeta)({eventName:o.default.UpdateEnableWebResourceSubAreas,eventData:{enableWebResourceSubAreas:e}}))()},11987:function(e,t,n){"use strict";n.r(t),n.d(t,"noPayload",(function(){return o})),n.d(t,"payload",(function(){return i})),n.d(t,"requestMeta",(function(){return s})),n.d(t,"progressMeta",(function(){return c})),n.d(t,"successMeta",(function(){return l})),n.d(t,"failureMeta",(function(){return u}));var r=n(217),a=n(11988),o=()=>{},i=()=>e=>e,s=e=>()=>Object(a.withTelemetryScenarioMeta)(e,r.ScenarioModifier.Start),c=e=>()=>Object(a.withTelemetryScenarioMeta)(e,r.ScenarioModifier.Progress),l=e=>()=>Object(a.withTelemetryScenarioMeta)(e,r.ScenarioModifier.Complete),u=e=>t=>Object(a.withTelemetryScenarioMeta)(e,r.ScenarioModifier.Failure,t)},11988:function(e,t,n){"use strict";function r(e){return{telemetry:e}}function a(e,t,n){return{scenarioName:e,modifier:t,eventData:n}}function o(e){return!(!e||!e.telemetry)}function i(e){return!(!e||!e.scenarioName)}n.r(t),n.d(t,"withTelemetryEventMeta",(function(){return r})),n.d(t,"withTelemetryScenarioMeta",(function(){return a})),n.d(t,"hasTelemetryEventMeta",(function(){return o})),n.d(t,"hasTelemetryScenarioMeta",(function(){return i}))},11989:function(e,t,n){"use strict";var r;n.r(t),function(e){e.SettingsOpen="AppModuleDesigner/CommandBar/Settings/Open",e.SwitchToClassicCreate="AppModuleDesigner/SwitchToClassic/Create",e.SwitchToClassicEdit="AppModuleDesigner/SwitchToClassic/Edit",e.PlayOpen="AppModuleDesigner/CommandBar/Play/Open",e.InsertArea="AppModuleDesigner/SiteMap/InsertArea",e.InsertGroup="AppModuleDesigner/SiteMap/InsertGroup",e.InsertSubArea="AppModuleDesigner/SiteMap/InsertSubArea",e.InsertCustomPage="AppModuleDesigner/SiteMap/InsertCustomPage",e.UpdateNodeId="AppModuleDesigner/SiteMap/UpdateNodeId",e.UpdateNodeTitle="AppModuleDesigner/SiteMap/UpdateNodeTitle",e.UpdateSubAreaEntity="AppModuleDesigner/SiteMap/UpdateSubAreaEntity",e.UpdateSubAreaDashboard="AppModuleDesigner/SiteMap/UpdateSubAreaDashboard",e.UpdateSubAreaCustomPage="AppModuleDesigner/SiteMap/UpdateSubAreaCustomPage",e.UpdateSubAreaUrl="AppModuleDesigner/SiteMap/UpdateSubAreaUrl",e.UpdateSubAreaIcon="AppModuleDesigner/SiteMap/UpdateSubAreaIcon",e.InsertSiteMapNode="AppModuleDesigner/SiteMap/InsertSiteMapNode",e.DeleteSiteMapNode="AppModuleDesigner/SiteMap/DeleteSiteMapNode",e.AddEntity="AppModuleDesigner/AppModule/AddEntity",e.RemoveEntity="AppModuleDesigner/AppModule/RemoveEntity",e.AddDashboard="AppModuleDesigner/AppModule/AddDashboard",e.RemoveDashboard="AppModuleDesigner/AppModule/RemoveDashboard",e.AddCustomPage="AppModuleDesigner/AppModule/AddCustomPage",e.RemoveCustomPage="AppModuleDesigner/AppModule/RemoveCustomPage",e.AddPageOpen="AppModuleDesigner/AppModule/AddPage/Open",e.AddSubAreaOpen="AppModuleDesigner/AppModule/AddSubArea/Open",e.AddBpfOpen="AppModuleDesigner/AppModule/AddBpf/Open",e.UpdateAppDisplayName="AppModuleDesigner/AppModule/UpdateDisplayName",e.UpdateAppDescription="AppModuleDesigner/AppModule/UpdateDescription",e.UpdateViewsForEntity="AppModuleDesigner/AppModule/UpdateViewsForEntity",e.RemoveViewsFromEntity="AppModuleDesigner/AppModule/RemoveViewsFromEntity",e.UpdateChartsForEntity="AppModuleDesigner/AppModule/UpdateChartsForEntity",e.RemoveChartsFromEntity="AppModuleDesigner/AppModule/RemoveChartsFromEntity",e.UpdateFormsForEntity="AppModuleDesigner/AppModule/UpdateFormsForEntity",e.RemoveFormsFromEntity="AppModuleDesigner/AppModule/RemoveFormsFromEntity",e.EditFormOpen="AppModuleDesigner/AppModule/EditForm/Open",e.EditViewOpen="AppModuleDesigner/AppModule/EditView/Open",e.EditChartOpen="AppModuleDesigner/AppModule/EditChart/Open",e.EditDashboardOpen="AppModuleDesigner/AppModule/EditDashboard/Open",e.EditCustomPageOpen="AppModuleDesigner/AppModule/EditCustomPage/Open",e.EditDataEntityOpen="AppModuleDesigner/AppModule/EditDataEntity/Open",e.UpdateAppMobileOfflineProfiles="AppModuleDesigner/AppModule/UpdateMobileOfflineProfiles",e.ToggleMobileOffline="AppModuleDesigner/MobileOfflineSettings/ToggleOffline",e.MobileOfflineEditInClassic="AppModuleDesigner/MobileOfflineSettings/EditInClassic",e.ReactCrash="AppModuleDesigner/ReactCrash",e.ReduxCrash="AppModuleDesigner/ReduxCrash",e.EditCommandBarFromEntity="AppModuleDesigner/AppModule/EditCommandBarFromEntity",e.LeaveWithPendingChanges="AppModuleDesigner/LeaveWithPendingChanges",e.PreviewSourceNavigationReported="AppModuleDesigner/Preview/PreviewSourceNavigationReported",e.PreviewSourceNavigationFailed="AppModuleDesigner/Preview/PreviewSourceNavigationFailed",e.SentSiteMapNodeNavigation="AppModuleDesigner/Preview/SentSiteMapNodeNavigation",e.SentPagesNodeNavigation="AppModuleDesigner/Preview/SentPagesNodeNavigation",e.MoveSiteMapNodeUp="AppModuleDesigner/SiteMap/MoveNodeUp",e.MoveSiteMapNodeDown="AppModuleDesigner/SiteMap/MoveNodeDown",e.OpenRemoveSiteMapNodeDialog="AppModuleDesigner/SiteMap/RemoveSiteMapNodeDialog/Open",e.UpdateShowHome="AppModuleDesigner/SiteMapSettings/UpdateShowHome",e.UpdateShowRecents="AppModuleDesigner/SiteMapSettings/UpdateShowRecents",e.UpdateShowPinned="AppModuleDesigner/SiteMapSettings/UpdateShowPinned",e.UpdateEnableCollapsibleGroups="AppModuleDesigner/SiteMapSettings/UpdateEnableCollapsibleGroups",e.UpdateEnableAreas="AppModuleDesigner/SiteMapSettings/UpdateEnableAreas",e.UpdateEnableWebResourceSubAreas="AppModuleDesigner/SiteMapSettings/UpdateEnableWebResourceSubAreas",e.UpdateEnableUrlSubAreas="AppModuleDesigner/SiteMapSettings/UpdateEnableUrlSubAreas",e.RefreshPreview="AppModuleDesigner/CommentsPane/RefreshPreview",e.ManuallyReassociatedSiteMap="AppModuleDesigner/SiteMap/ManuallyReassociatedSiteMap",e.CommentsPaneOpen="AppModuleDesigner/CommentsPane/Open",e.CommentsPaneClose="AppModuleDesigner/CommentsPane/Close",e.CommentsPaneNewThread="AppModuleDesigner/CommentsPane/NewThread",e.CommentsPaneLoaded="AppModuleDesigner/CommentsPane/Loaded",e.CommentSolutionPresent="AppModuleDesigner/CommentsPane/SolutionPresent",e.WebResourcesByNames="AppModuleDesigner/WebResources/GetWebResourcesByNames",e.SiteMapTreeItemsIcon="AppModuleDesigner/SiteMap/TreeItemsIcon",e.ImageCreateBase64SvgSrc="AppModuleDesigner/Image/CreateBase64SvgSrc"}(r||(r={})),t.default=r},11990:function(e,t,n){"use strict";var r;n.r(t),function(e){e.AppModuleDesignerLoad="AppModuleDesigner/InitialRender",e.AppCreate="AppModuleDesigner/App/Create",e.AppLoad="AppModuleDesigner/App/Load",e.AppModuleLoad="AppModuleDesigner/AppModule/Load",e.SiteMapLoad="AppModuleDesigner/SiteMap/Load",e.SiteMapDeserialize="AppModuleDesigner/SiteMap/Deserialize",e.SiteMapSerialize="AppModuleDesigner/SiteMap/Serialize",e.AppSave="AppModuleDesigner/App/Save",e.AppModuleDesignerPublish="AppModuleDesigner/App/Publish",e.EntitiesLoad="AppModuleDesigner/Entities/LoadList",e.DashboardsLoad="AppModuleDesigner/Dashboards/LoadList",e.ViewsLoad="AppModuleDesigner/Views/LoadList",e.ChartsLoad="AppModuleDesigner/Charts/LoadList",e.FormsLoad="AppModuleDesigner/Forms/LoadList",e.BusinessProcessFlowsLoad="AppModuleDesigner/BusinessProcessFlows/LoadList",e.CustomPagesLoad="AppModuleDesigner/CustomPages/LoadList",e.CustomPagesCreate="AppModuleDesigner/CustomPages/Create",e.SolutionInfoLoad="AppModuleDesigner/SolutionInfo/Load",e.MobileOfflineProfilesLoad="AppModuleDesigner/MobileOfflineProfile/LoadList",e.MobileOfflineProfilePublish="AppModuleDesigner/MobileOfflineProfile/Publish",e.EnableRoleBasedOfflineProfileAccessSetting="AppModuleDesigner/EnableRoleBasedOfflineProfileAccessSetting/Load",e.PreviewMetadataSend="AppModuleDesigner/Preview/SendMetadata",e.RetrieveAppUnpublished="AppModuleDesigner/App/RetrieveAppUnpublished",e.CheckIfAppModuleEverBeenPublished="AppModuleDesigner/App/CheckIfAppModuleEverBeenPublished",e.FirstRunTour="AppModuleDesigner/FirstRunTour",e.AppPackaging="AppModuleDesigner/App/Packaging"}(r||(r={})),t.default=r},11991:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return C})),n.d(t,"parseAppIdFromAppTokenString",(function(){return T})),n.d(t,"initializeSettings",(function(){return M}));var r=n(1105),a=n(11986),o=n(11992),i=n(11996),s=n(11997),c=n(11998),l=n(11999),u=n(12e3),d=n(12001),p=n(12002),f=n(10299),m=n(12004),b=n(11995),v=n(10297),g=n(12005),y=n(11985),h=n(12057),S=n(12061),O=n(12062),A=n(12060),P=n(10309),j=n(12063);function E(e,t,n,r,a,o,i){try{var s=e[o](i),c=s.value}catch(l){return void n(l)}s.done?t(c):Promise.resolve(c).then(r,a)}function C(e){return t=>n=>function(){var v,P=(v=function*(v){var P=n(v);if(Object(a.isActionOf)(g.Actions.loadApp.success,v)&&M(t,v.payload),Object(a.isActionOf)(g.Actions.saveApp.success,v)&&Object(m.delayedPromise)(3e3).then(()=>t.dispatch(y.clearSuccessfulSave())),Object(a.isActionOf)(g.Actions.publishApp.success,v)&&Object(m.delayedPromise)(3e3).then(()=>t.dispatch(y.clearSuccessfulPublish())),Object(h.runPendingUnsavedChanges)(t,v,{saveConfirmationDialogType:h.SaveConfirmationDialogType.Preview,signalActionCreator:y.openAppPreview,onRun:()=>{var n,r,a=null===(n=e.environmentProps)||void 0===n||null===(r=n.properties.linkedEnvironmentMetadata)||void 0===r?void 0:r.instanceUrl,o=g.Selectors.getAppModuleId(t.getState());if(!a||!o)throw new Error("Cannot open app preview because xrmInstanceUri (".concat(a,") or appModuleId (").concat(o,") are missing"));Object(d.default)(a,o)}}),Object(h.runPendingUnsavedChanges)(t,v,{saveConfirmationDialogType:h.SaveConfirmationDialogType.SwitchToClassic,signalActionCreator:y.openSwitchToClassic,onRun:()=>{var n,r,a=null===(n=e.environmentProps)||void 0===n||null===(r=n.properties.linkedEnvironmentMetadata)||void 0===r?void 0:r.instanceUrl,o=g.Selectors.getAppModuleId(t.getState());if(!a||!o)throw new Error("Cannot open classic designer because xrmInstanceUri (".concat(a,") or appModuleId (").concat(o,") are missing"));Object(p.switchToClassicEdit)(a,o)}}),Object(a.isActionOf)(y.createAndAddCustomPage.requestCreate,v)){var{environmentId:E,solutionId:C}=e.routingProps;C&&"undefined"!==C||(C=r.crmBapSolutionId);var w=v.payload;Object(b.openInNewTab)(Object(o.getCreateCanvasAppUri)(w,E,C),"_blank",!0)}if(Object(a.isActionOf)(y.createAndAddCustomPage.requestAdd,v)&&(yield Object(m.delayedPromise)(3e3),t.dispatch(g.Actions.loadCustomPages.request({bypassCache:!0}))),Object(a.isActionOf)(g.Actions.loadCustomPages.success,v)){var I,N=t.getState().ui.pendingAppToken;if(!N)return;try{I=T(N)}catch(_){t.dispatch(y.createAndAddCustomPage.failure(new f.CodedError({code:f.ErrorCodes.CustomPagesCreate,innerError:_})))}var D=v.payload.find(e=>I&&e.id===I);if(!D)return void t.dispatch(y.createAndAddCustomPage.failure(new f.CodedError({code:f.ErrorCodes.CustomPagesCreate,message:"No app with id '".concat(I,"' could be found in list of canvas apps fetched from CDS")})));t.dispatch(g.App.Actions.addAppModuleCustomPages({customPages:[D],addToNavigation:!0})),t.dispatch(y.createAndAddCustomPage.success())}if(Object(h.runPendingUnsavedChanges)(t,v,{saveConfirmationDialogType:h.SaveConfirmationDialogType.EditCommandBar,signalActionCreator:y.editCommandBarFromEntity,onRun:()=>{var n=t.getState(),r=Object(A.selectedEntityLogicalName)(n),a=g.Selectors.getAppModuleId(t.getState());if(!r||!a)throw new Error("Cannot open command bar editor because selectedEntityLogicalName (".concat(r,") or appModuleId (").concat(a,") are missing"));var{environmentId:o,solutionId:i}=e.routingProps,s="/e/".concat(o,"/s/").concat(i,"/n/").concat(r,"/a/").concat(a,"/command");Object(b.openInNewTab)(s,"CommandDesigner")}}),Object(a.isActionOf)(y.editEntityFormPage.open,v)){var{environmentId:x,solutionId:k}=e.routingProps;Object(l.openEditForm)(x,k,v.payload.entityLogicalName,v.payload.formId)}if(Object(a.isActionOf)(y.editEntityViewPage.open,v)){var{environmentId:R,solutionId:L}=e.routingProps;Object(u.openEditView)(R,L,v.payload.viewId)}if(Object(a.isActionOf)(y.editEntityChartPage.open,v)){var U,B,{solutionId:F}=e.routingProps,V=null===(U=e.environmentProps)||void 0===U||null===(B=U.properties.linkedEnvironmentMetadata)||void 0===B?void 0:B.instanceUrl;if(!V)throw new Error("Cannot open edit chart page because xrmInstanceUri (".concat(V,") is missing"));Object(j.openEditChart)(V,F,v.payload.chartId,v.payload.entityTypeCode)}if(Object(a.isActionOf)(y.editDashboardPage.open,v)){var q,W,{solutionId:H}=e.routingProps,G=null===(q=e.environmentProps)||void 0===q||null===(W=q.properties.linkedEnvironmentMetadata)||void 0===W?void 0:W.instanceUrl;if(!G)throw new Error("Cannot open edit dashboard page because xrmInstanceUri (".concat(G,") is missing"));Object(s.openEditDashboard)(G,H,v.payload.dashboardId)}if(Object(a.isActionOf)(y.editCustomPage.open,v)){var{environmentId:z,solutionId:K}=e.routingProps;Object(i.openEditCustomPage)(z,K,v.payload.customPage.id)}if(Object(a.isActionOf)(y.editDataEntity.open,v)){var{environmentId:X,solutionId:Q}=e.routingProps;Object(c.openEditDataEntity)(X,Q,v.payload.id,v.payload.logicalName)}return Object(a.isActionOf)(g.App.Actions.removeAppModuleEntities,v)&&Object(S.adjustEntityPageSelectionAfterRemoval)(t,v),Object(a.isActionOf)(g.App.Actions.removeAppModuleDashboards,v)&&Object(S.adjustDashboardPageSelectionAfterRemoval)(t,v),Object(a.isActionOf)(g.App.Actions.removeAppModuleCustomPages,v)&&Object(S.adjustCustomPageSelectionAfterRemoval)(t,v),Object(a.isActionOf)(g.App.Actions.deleteNode,v)&&Object(O.adjustSiteMapSelectionAfterRemoval)(t,v),Promise.resolve(P)},function(){var e=this,t=arguments;return new Promise((function(n,r){var a=v.apply(e,t);function o(e){E(a,n,r,o,i,"next",e)}function i(e){E(a,n,r,o,i,"throw",e)}o(void 0)}))});return function(e){return P.apply(this,arguments)}}()}function T(e){var t,n=null==e||null===(t=e.split("/"))||void 0===t?void 0:t[4];if(!n)throw new Error('An app ID could not be parsed from given app token "'.concat(e,'"'));if(!Object(v.isUuid)(n))throw new Error('The app ID parsed from the given app token "'.concat(e,'" was not well-formed'));return n}function M(e,t){var n=Object(P.siteMapHasWebResourceSubAreas)(t.siteMap);e.dispatch(y.updateEnableWebResourceSubAreas(n))}},11992:function(e,t,n){"use strict";n.r(t),n.d(t,"getCreateCanvasAppUri",(function(){return i}));var r=n(11993),a=n(11994),o=n(11995);function i(e,t,n){var i=Object(a.filterUndefinedEntries)({action:"new-model-app-page",source:"app-designer","environment-name":t,"solution-id":n,"powerapps-webauth-settings.useLocalCanvasEndpoint":r.settings.useLocalCanvasEndpoint?"true":void 0,name:e}),s=Object(o.mergeWithExistingSearchParams)(i);return"/e/".concat(t,"/canvas/?").concat(s.toString())}},11993:function(e,t,n){"use strict";n.r(t),n.d(t,"settings",(function(){return a}));var r=n(250),a=Object(r.createSettingsConfig)({packageName:"cds-app-module-designer",settings:{useLocalPreview:{description:"If provided, will pass its value to `useLocal=<value>` on the app live preview",allowOverrides:!0,values:{default:""}},useLocalCanvasEndpoint:{description:"If provided, will pass powerapps-webauth-settings.useLocalCanvasEndpoint=true to the Embedded Studio instance",allowOverrides:!0,values:{default:!1}},flagsPreview:{description:"If provided, will pass its value to `flags=<value>` on the app live preview",allowOverrides:!0,values:{default:""}}}})},11994:function(e,t,n){"use strict";function r(e){return Object.keys(e).reduce((t,n)=>(void 0!==e[n]&&(t[n]=e[n]),t),{})}n.r(t),n.d(t,"filterUndefinedEntries",(function(){return r}))},11995:function(e,t,n){"use strict";function r(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=window.open(e,t);r&&n&&(r.parent=window)}function a(e){var t;window.open(e),null===(t=window.history)||void 0===t||t.back()}function o(){var e;null===(e=window.history)||void 0===e||e.back()}function i(e){window.location.href=e}function s(e){window.history.replaceState(null,"",e)}function c(){return window.location.href}function l(e){var t=new URLSearchParams(window.location.search);for(var[n,r]of Object.entries(e))t.set(n,r);return t}n.r(t),n.d(t,"openInNewTab",(function(){return r})),n.d(t,"openInNewTabAndGoBack",(function(){return a})),n.d(t,"goBack",(function(){return o})),n.d(t,"openInSameTab",(function(){return i})),n.d(t,"replaceLocation",(function(){return s})),n.d(t,"getCurrentUrl",(function(){return c})),n.d(t,"mergeWithExistingSearchParams",(function(){return l}))},11996:function(e,t,n){"use strict";n.r(t),n.d(t,"openEditCustomPage",(function(){return i}));var r=n(11993),a=n(11994),o=n(11995);function i(e,t,n){var i=Object(a.filterUndefinedEntries)({action:"edit",source:"app-designer","environment-name":e,"solution-id":t,"app-id":n?"/providers/Microsoft.PowerApps/apps/".concat(n):void 0,"powerapps-webauth-settings.useLocalCanvasEndpoint":r.settings.useLocalCanvasEndpoint?"true":void 0}),s=Object(o.mergeWithExistingSearchParams)(i),c="/e/".concat(e,"/canvas/?").concat(s.toString());Object(o.openInNewTab)(c,"_blank")}},11997:function(e,t,n){"use strict";n.r(t),n.d(t,"openEditDashboard",(function(){return o}));var r=n(1086),a=n(11995);function o(e,t,n){Object(a.openInNewTab)(Object(r.getDashboardDesignerUrl)(e,n,t),"_blank")}},11998:function(e,t,n){"use strict";n.r(t),n.d(t,"openEditDataEntity",(function(){return a}));var r=n(11995);function a(e,t,n,a){var o="/environments/".concat(e,"/solutions/").concat(t,"/entities/").concat(n,"/").concat(a,"?source=modernAppDesigner");Object(r.openInNewTab)(o,"_blank")}},11999:function(e,t,n){"use strict";n.r(t),n.d(t,"openEditForm",(function(){return a}));var r=n(11995);function a(e,t,n,a){var o="/e/".concat(e,"/s/").concat(t,"/entity/").concat(n,"/form/edit/").concat(a,"?source=modernAppDesigner");Object(r.openInNewTab)(o,"_blank")}},12e3:function(e,t,n){"use strict";n.r(t),n.d(t,"openEditView",(function(){return a}));var r=n(11995);function a(e,t,n){var a="/e/".concat(e,"/s/").concat(t,"/view/").concat(n,"?source=modernAppDesigner");Object(r.openInNewTab)(a,"_blank")}},12001:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return o}));var r=n(1086),a=n(11995);function o(e,t){Object(a.openInNewTab)(Object(r.getPlayAppModuleUrl)(e,t),"_blank")}},12002:function(e,t,n){"use strict";n.r(t),n.d(t,"switchToClassicCreate",(function(){return l})),n.d(t,"switchToClassicEdit",(function(){return u}));var r=n(1086),a=n(1105),o=n(217),i=n(11995),s=n(12003),c=n(11989);function l(e,t){Object(o.trackCustomEvent)(s.default,{eventName:c.default.SwitchToClassicCreate}),Object(i.openInNewTabAndGoBack)(r.getCrmAppDesignerUrl(e,t))}function u(e,t){Object(o.trackCustomEvent)(s.default,{eventName:c.default.SwitchToClassicEdit}),Object(i.openInNewTab)(r.getAppModuleDesignerUrl(e,t,a.crmBapSolutionId),"_appDesignerClassic")}},12003:function(e,t,n){"use strict";n.r(t);t.default="cds-app-module-designer"},12004:function(e,t,n){"use strict";function r(e){return new Promise(t=>setTimeout(t,e))}function a(){var e,t=new Promise(t=>{e={isSettled:!1,resolve:n=>{e.isSettled=!0,t(n)}}});return Object.assign(t,e)}n.r(t),n.d(t,"delayedPromise",(function(){return r})),n.d(t,"getDeferredPromise",(function(){return a}))},12005:function(e,t,n){"use strict";n.r(t);var r=n(12006);n.d(t,"Actions",(function(){return r}));var a=n(12007);n.d(t,"App",(function(){return a}));var o=n(12025);n.d(t,"makeMiddleware",(function(){return o.default}));var i=n(12056);n.d(t,"initialState",(function(){return i.initialState})),n.d(t,"reducer",(function(){return i.default}));var s=n(12032);n.d(t,"Selectors",(function(){return s}))},12006:function(e,t,n){"use strict";n.r(t),n.d(t,"createApp",(function(){return l})),n.d(t,"loadApp",(function(){return u})),n.d(t,"loadEntities",(function(){return d})),n.d(t,"loadDashboards",(function(){return p})),n.d(t,"loadBusinessProcessFlows",(function(){return f})),n.d(t,"loadViewsByEntityName",(function(){return m})),n.d(t,"loadChartsByEntityName",(function(){return b})),n.d(t,"loadFormsByEntityName",(function(){return v})),n.d(t,"loadCustomPages",(function(){return g})),n.d(t,"loadSolutionInfo",(function(){return y})),n.d(t,"loadMobileOfflineProfiles",(function(){return h})),n.d(t,"publishMobileOfflineProfile",(function(){return S})),n.d(t,"loadEnableRoleBasedOfflineProfileAccessSetting",(function(){return O})),n.d(t,"saveApp",(function(){return A})),n.d(t,"publishApp",(function(){return P})),n.d(t,"retrieveAppUnpublished",(function(){return j}));var r=n(10302),a=n(217),o=n(11986),i=n(11987),s=n(11988),c=n(11990),l={request:Object(o.createAction)("app/CREATE/REQUEST",Object(i.payload)(),Object(i.requestMeta)(c.default.AppCreate))(),success:Object(o.createAction)("app/CREATE/SUCCESS",i.noPayload,Object(i.successMeta)(c.default.AppCreate))(),failure:Object(o.createAction)("app/CREATE/FAILURE",Object(i.payload)(),Object(i.failureMeta)(c.default.AppCreate))()},u={request:Object(o.createAction)("app/LOAD/REQUEST",Object(i.payload)(),Object(i.requestMeta)(c.default.AppLoad))(),success:Object(o.createAction)("app/LOAD/SUCCESS",Object(i.payload)(),e=>Object(s.withTelemetryScenarioMeta)(c.default.AppLoad,a.ScenarioModifier.Complete,{appComponents:Object(r.buildAppElementsList)(e.appModule),mobileOfflineProfileIds:e.appModule.appInfo.mobileOfflineProfileIds}))(),failure:Object(o.createAction)("app/LOAD/FAILURE",Object(i.payload)(),Object(i.failureMeta)(c.default.AppLoad))()},d={request:Object(o.createAction)("entities/LOAD/REQUEST",Object(i.payload)(),Object(i.requestMeta)(c.default.EntitiesLoad))(),success:Object(o.createAction)("entities/LOAD/SUCCESS",Object(i.payload)(),Object(i.successMeta)(c.default.EntitiesLoad))(),failure:Object(o.createAction)("entities/LOAD/FAILURE",Object(i.payload)(),Object(i.failureMeta)(c.default.EntitiesLoad))()},p={request:Object(o.createAction)("dashboards/LOAD/REQUEST",Object(i.payload)(),Object(i.requestMeta)(c.default.DashboardsLoad))(),success:Object(o.createAction)("dashboards/LOAD/SUCCESS",Object(i.payload)(),Object(i.successMeta)(c.default.DashboardsLoad))(),failure:Object(o.createAction)("dashboards/LOAD/FAILURE",Object(i.payload)(),Object(i.failureMeta)(c.default.DashboardsLoad))()},f={request:Object(o.createAction)("businessProcessFlows/LOAD/REQUEST",Object(i.payload)(),Object(i.requestMeta)(c.default.BusinessProcessFlowsLoad))(),success:Object(o.createAction)("businessProcessFlows/LOAD/SUCCESS",Object(i.payload)(),Object(i.successMeta)(c.default.BusinessProcessFlowsLoad))(),failure:Object(o.createAction)("businessProcessFlows/LOAD/FAILURE",Object(i.payload)(),Object(i.failureMeta)(c.default.BusinessProcessFlowsLoad))()},m={request:Object(o.createAction)("views/LOAD/REQUEST",Object(i.payload)(),Object(i.requestMeta)(c.default.ViewsLoad))(),success:Object(o.createAction)("views/LOAD/SUCCESS",Object(i.payload)(),Object(i.successMeta)(c.default.ViewsLoad))(),failure:Object(o.createAction)("views/LOAD/FAILURE",Object(i.payload)(),e=>Object(i.failureMeta)(c.default.ViewsLoad)(e.error))()},b={request:Object(o.createAction)("charts/LOAD/REQUEST",Object(i.payload)(),Object(i.requestMeta)(c.default.ChartsLoad))(),success:Object(o.createAction)("charts/LOAD/SUCCESS",Object(i.payload)(),Object(i.successMeta)(c.default.ChartsLoad))(),failure:Object(o.createAction)("charts/LOAD/FAILURE",Object(i.payload)(),e=>Object(i.failureMeta)(c.default.ChartsLoad)(e.error))()},v={request:Object(o.createAction)("forms/LOAD/REQUEST",Object(i.payload)(),Object(i.requestMeta)(c.default.FormsLoad))(),success:Object(o.createAction)("forms/LOAD/SUCCESS",Object(i.payload)(),Object(i.successMeta)(c.default.FormsLoad))(),failure:Object(o.createAction)("forms/LOAD/FAILURE",Object(i.payload)(),e=>Object(i.failureMeta)(c.default.FormsLoad)(e.error))()},g={request:Object(o.createAction)("customPages/LOAD/REQUEST",Object(i.payload)(),Object(i.requestMeta)(c.default.CustomPagesLoad))(),success:Object(o.createAction)("customPages/LOAD/SUCCESS",Object(i.payload)(),Object(i.successMeta)(c.default.CustomPagesLoad))(),failure:Object(o.createAction)("customPages/LOAD/FAILURE",Object(i.payload)(),Object(i.failureMeta)(c.default.CustomPagesLoad))()},y={request:Object(o.createAction)("solutionInfo/LOAD/REQUEST",i.noPayload,Object(i.requestMeta)(c.default.SolutionInfoLoad))(),success:Object(o.createAction)("solutionInfo/LOAD/SUCCESS",Object(i.payload)(),Object(i.successMeta)(c.default.SolutionInfoLoad))(),failure:Object(o.createAction)("solutionInfo/LOAD/FAILURE",Object(i.payload)(),Object(i.failureMeta)(c.default.SolutionInfoLoad))()},h={request:Object(o.createAction)("mobileOfflineProfiles/LOAD/REQUEST",Object(i.payload)(),Object(i.requestMeta)(c.default.MobileOfflineProfilesLoad))(),success:Object(o.createAction)("mobileOfflineProfiles/LOAD/SUCCESS",Object(i.payload)(),e=>Object(s.withTelemetryScenarioMeta)(c.default.MobileOfflineProfilesLoad,a.ScenarioModifier.Complete,{mobileOfflineProfiles:e.map(e=>({id:e.id,solutionId:e.solutionId,isValidated:e.isValidated}))}))(),failure:Object(o.createAction)("mobileOfflineProfiles/LOAD/FAILURE",Object(i.payload)(),Object(i.failureMeta)(c.default.MobileOfflineProfilesLoad))()},S={request:Object(o.createAction)("mobileOfflineProfile/PUBLISH/REQUEST",Object(i.payload)(),Object(i.requestMeta)(c.default.MobileOfflineProfilePublish))(),success:Object(o.createAction)("mobileOfflineProfile/PUBLISH/SUCCESS",i.noPayload,Object(i.successMeta)(c.default.MobileOfflineProfilePublish))(),failure:Object(o.createAction)("mobileOfflineProfile/PUBLISH/FAILURE",Object(i.payload)(),Object(i.failureMeta)(c.default.MobileOfflineProfilePublish))()},O={request:Object(o.createAction)("enableRoleBasedOfflineProfileAccessSetting/LOAD/REQUEST",Object(i.payload)(),Object(i.requestMeta)(c.default.EnableRoleBasedOfflineProfileAccessSetting))(),success:Object(o.createAction)("enableRoleBasedOfflineProfileAccessSetting/LOAD/SUCCESS",Object(i.payload)(),e=>Object(s.withTelemetryScenarioMeta)(c.default.EnableRoleBasedOfflineProfileAccessSetting,a.ScenarioModifier.Complete,{enableRoleBasedOfflineProfileAccessSetting:e}))(),failure:Object(o.createAction)("enableRoleBasedOfflineProfileAccessSetting/LOAD/FAILURE",Object(i.payload)(),Object(i.failureMeta)(c.default.EnableRoleBasedOfflineProfileAccessSetting))()},A={request:Object(o.createAction)("app/SAVE/REQUEST",i.noPayload,Object(i.requestMeta)(c.default.AppSave))(),success:Object(o.createAction)("app/SAVE/SUCCESS",Object(i.payload)(),Object(i.successMeta)(c.default.AppSave))(),failure:Object(o.createAction)("app/SAVE/FAILURE",Object(i.payload)(),Object(i.failureMeta)(c.default.AppSave))()},P={request:Object(o.createAction)("app/PUBLISH/REQUEST",i.noPayload,Object(i.requestMeta)(c.default.AppModuleDesignerPublish))(),success:Object(o.createAction)("app/PUBLISH/SUCCESS",i.noPayload,Object(i.successMeta)(c.default.AppModuleDesignerPublish))(),failure:Object(o.createAction)("app/PUBLISH/FAILURE",Object(i.payload)(),Object(i.failureMeta)(c.default.AppModuleDesignerPublish))()},j={request:Object(o.createAction)("app/retrieveAppUnpublished/REQUEST",Object(i.payload)(),Object(i.requestMeta)(c.default.RetrieveAppUnpublished))(),success:Object(o.createAction)("app/retrieveAppUnpublished/SUCCESS",Object(i.payload)(),Object(i.successMeta)(c.default.RetrieveAppUnpublished))(),failure:Object(o.createAction)("app/retrieveAppUnpublished/FAILURE",Object(i.payload)(),Object(i.failureMeta)(c.default.RetrieveAppUnpublished))()}},12007:function(e,t,n){"use strict";n.r(t);var r=n(12008);n.d(t,"Actions",(function(){return r}));var a=n(12012);n.d(t,"initialState",(function(){return a.initialState})),n.d(t,"reducer",(function(){return a.reducer}))},12008:function(e,t,n){"use strict";n.r(t);var r=n(12009);n.d(t,"addAppModuleEntities",(function(){return r.addAppModuleEntities})),n.d(t,"addAppModuleDashboards",(function(){return r.addAppModuleDashboards})),n.d(t,"addAppModuleCustomPages",(function(){return r.addAppModuleCustomPages})),n.d(t,"removeAppModuleEntities",(function(){return r.removeAppModuleEntities})),n.d(t,"removeAppModuleDashboards",(function(){return r.removeAppModuleDashboards})),n.d(t,"removeAppModuleCustomPages",(function(){return r.removeAppModuleCustomPages})),n.d(t,"updateAppModuleDisplayName",(function(){return r.updateAppModuleDisplayName})),n.d(t,"updateAppModuleDescription",(function(){return r.updateAppModuleDescription})),n.d(t,"updateAppModuleMobileOfflineProfiles",(function(){return r.updateAppModuleMobileOfflineProfiles})),n.d(t,"updateViewsForEntityComponent",(function(){return r.updateViewsForEntityComponent})),n.d(t,"removeViewsFromEntityComponent",(function(){return r.removeViewsFromEntityComponent})),n.d(t,"updateChartsForEntityComponent",(function(){return r.updateChartsForEntityComponent})),n.d(t,"removeChartsFromEntityComponent",(function(){return r.removeChartsFromEntityComponent})),n.d(t,"updateFormsForEntityComponent",(function(){return r.updateFormsForEntityComponent})),n.d(t,"removeFormsFromEntityComponent",(function(){return r.removeFormsFromEntityComponent})),n.d(t,"isAppModuleChangeAction",(function(){return r.isAppModuleChangeAction}));var a=n(12011);n.d(t,"updateNodeId",(function(){return a.updateNodeId})),n.d(t,"updateSiteMapNodeTitle",(function(){return a.updateSiteMapNodeTitle})),n.d(t,"updateSubAreaEntity",(function(){return a.updateSubAreaEntity})),n.d(t,"updateSubAreaDashboard",(function(){return a.updateSubAreaDashboard})),n.d(t,"updateSubAreaCustomPage",(function(){return a.updateSubAreaCustomPage})),n.d(t,"updateSubAreaUrl",(function(){return a.updateSubAreaUrl})),n.d(t,"updateSubAreaIcon",(function(){return a.updateSubAreaIcon})),n.d(t,"insertSiteMapNode",(function(){return a.insertSiteMapNode})),n.d(t,"updateShowHome",(function(){return a.updateShowHome})),n.d(t,"updateShowPinned",(function(){return a.updateShowPinned})),n.d(t,"updateShowRecents",(function(){return a.updateShowRecents})),n.d(t,"updateEnableCollapsibleGroups",(function(){return a.updateEnableCollapsibleGroups})),n.d(t,"updateEnableAreas",(function(){return a.updateEnableAreas})),n.d(t,"updateEnableUrlSubAreas",(function(){return a.updateEnableUrlSubAreas})),n.d(t,"deleteNode",(function(){return a.deleteNode})),n.d(t,"moveNodeUp",(function(){return a.moveNodeUp})),n.d(t,"moveNodeDown",(function(){return a.moveNodeDown})),n.d(t,"isSiteMapChangeAction",(function(){return a.isSiteMapChangeAction}))},12009:function(e,t,n){"use strict";n.r(t),n.d(t,"addAppModuleEntities",(function(){return s})),n.d(t,"addAppModuleDashboards",(function(){return c})),n.d(t,"addAppModuleCustomPages",(function(){return l})),n.d(t,"removeAppModuleEntities",(function(){return u})),n.d(t,"removeAppModuleDashboards",(function(){return d})),n.d(t,"removeAppModuleCustomPages",(function(){return p})),n.d(t,"updateAppModuleDisplayName",(function(){return f})),n.d(t,"updateAppModuleDescription",(function(){return m})),n.d(t,"updateAppModuleMobileOfflineProfiles",(function(){return b})),n.d(t,"updateViewsForEntityComponent",(function(){return v})),n.d(t,"removeViewsFromEntityComponent",(function(){return g})),n.d(t,"updateChartsForEntityComponent",(function(){return y})),n.d(t,"removeChartsFromEntityComponent",(function(){return h})),n.d(t,"updateFormsForEntityComponent",(function(){return S})),n.d(t,"removeFormsFromEntityComponent",(function(){return O})),n.d(t,"isAppModuleChangeAction",(function(){return A}));var r=n(12010),a=n(11987),o=n(11989),i=n(11988),s=Object(r.createChangeAction)("appModule/ADD_ENTITIES",e=>{var{entities:t,addToNavigation:n=!1}=e;return{entities:t,addToNavigation:n}},e=>Object(i.withTelemetryEventMeta)({eventName:o.default.AddEntity,eventData:{componentIds:e.entities.map(e=>e.id)}})),c=Object(r.createChangeAction)("appModule/ADD_DASHBOARDS",e=>{var{dashboards:t,addToNavigation:n=!1}=e;return{dashboards:t,addToNavigation:n}},e=>Object(i.withTelemetryEventMeta)({eventName:o.default.AddDashboard,eventData:{componentIds:e.dashboards.map(e=>e.id)}})),l=Object(r.createChangeAction)("appModule/ADD_CUSTOM_PAGES",e=>{var{customPages:t,addToNavigation:n=!1}=e;return{customPages:t,addToNavigation:n}},e=>Object(i.withTelemetryEventMeta)({eventName:o.default.AddCustomPage,eventData:{componentIds:e.customPages.map(e=>e.id)}})),u=Object(r.createChangeAction)("appModule/REMOVE_ENTITIES",Object(a.payload)(),e=>Object(i.withTelemetryEventMeta)({eventName:o.default.RemoveEntity,eventData:{componentIds:e.map(e=>e.id)}})),d=Object(r.createChangeAction)("appModule/REMOVE_DASHBOARDS",Object(a.payload)(),e=>Object(i.withTelemetryEventMeta)({eventName:o.default.RemoveDashboard,eventData:{dashboardIds:e}})),p=Object(r.createChangeAction)("appModule/REMOVE_CUSTOM_PAGES",Object(a.payload)(),e=>Object(i.withTelemetryEventMeta)({eventName:o.default.RemoveCustomPage,eventData:{customPageIds:e.map(e=>e.id)}})),f=Object(r.createChangeAction)("appModule/UPDATE_DISPLAY_NAME",Object(a.payload)(),()=>Object(i.withTelemetryEventMeta)({eventName:o.default.UpdateAppDisplayName})),m=Object(r.createChangeAction)("appModule/UPDATE_DESCRIPTION",Object(a.payload)(),()=>Object(i.withTelemetryEventMeta)({eventName:o.default.UpdateAppDescription})),b=Object(r.createChangeAction)("appModule/UPDATE_MOBILE_OFFLINE_PROFILES",Object(a.payload)(),e=>Object(i.withTelemetryEventMeta)({eventName:o.default.UpdateAppMobileOfflineProfiles,eventData:{mobileOfflineProfileIds:e}})),v=Object(r.createChangeAction)("appModule/UPDATE_VIEWS_FOR_ENTITY_COMPONENT",Object(a.payload)(),e=>Object(i.withTelemetryEventMeta)({eventName:o.default.UpdateViewsForEntity,eventData:{entityId:e.entity.id,viewIds:e.views.map(e=>e.id)}})),g=Object(r.createChangeAction)("appModule/REMOVE_VIEWS_FROM_ENTITY_COMPONENT",Object(a.payload)(),e=>Object(i.withTelemetryEventMeta)({eventName:o.default.RemoveViewsFromEntity,eventData:{entityId:e.entity.id,viewIds:e.views.map(e=>e.id)}})),y=Object(r.createChangeAction)("appModule/UPDATE_CHARTS_FOR_ENTITY_COMPONENT",Object(a.payload)(),e=>Object(i.withTelemetryEventMeta)({eventName:o.default.UpdateChartsForEntity,eventData:{entityId:e.entity.id,chartIds:e.charts.map(e=>e.id)}})),h=Object(r.createChangeAction)("appModule/REMOVE_CHARTS_FROM_ENTITY_COMPONENT",Object(a.payload)(),e=>Object(i.withTelemetryEventMeta)({eventName:o.default.RemoveChartsFromEntity,eventData:{entityId:e.entity.id,chartIds:e.charts.map(e=>e.id)}})),S=Object(r.createChangeAction)("appModule/UPDATE_FORMS_FOR_ENTITY_COMPONENT",Object(a.payload)(),e=>Object(i.withTelemetryEventMeta)({eventName:o.default.UpdateFormsForEntity,eventData:{entityId:e.entity.id,formIds:e.forms.map(e=>e.id)}})),O=Object(r.createChangeAction)("appModule/REMOVE_FORMS_FROM_ENTITY_COMPONENT",Object(a.payload)(),e=>Object(i.withTelemetryEventMeta)({eventName:o.default.RemoveFormsFromEntity,eventData:{entityId:e.entity.id,formIds:e.forms.map(e=>e.id)}}));function A(e){var t;return Object(r.isDocumentChangeAction)(e)&&0===(null===(t=e.type)||void 0===t?void 0:t.indexOf("appModule"))}},12010:function(e,t,n){"use strict";n.r(t),n.d(t,"withDocumentChangeMeta",(function(){return a})),n.d(t,"isDocumentChangeAction",(function(){return o})),n.d(t,"createChangeAction",(function(){return i}));var r=n(11986);function a(){return{isDocumentChange:!0}}function o(e){var t;return!0===(null===(t=e.meta)||void 0===t?void 0:t.isDocumentChange)}function i(e,t,n){return Object(r.createAction)(e,t,n?function(){return Object.assign({isDocumentChange:!0},n(...arguments))}:a)()}},12011:function(e,t,n){"use strict";n.r(t),n.d(t,"updateNodeId",(function(){return s})),n.d(t,"updateSiteMapNodeTitle",(function(){return c})),n.d(t,"updateSubAreaEntity",(function(){return l})),n.d(t,"updateSubAreaDashboard",(function(){return u})),n.d(t,"updateSubAreaCustomPage",(function(){return d})),n.d(t,"updateSubAreaUrl",(function(){return p})),n.d(t,"updateSubAreaIcon",(function(){return f})),n.d(t,"insertSiteMapNode",(function(){return m})),n.d(t,"updateShowHome",(function(){return b})),n.d(t,"updateShowPinned",(function(){return v})),n.d(t,"updateShowRecents",(function(){return g})),n.d(t,"updateEnableCollapsibleGroups",(function(){return y})),n.d(t,"updateEnableAreas",(function(){return h})),n.d(t,"updateEnableUrlSubAreas",(function(){return S})),n.d(t,"deleteNode",(function(){return O})),n.d(t,"moveNodeUp",(function(){return A})),n.d(t,"moveNodeDown",(function(){return P})),n.d(t,"isSiteMapChangeAction",(function(){return j}));var r=n(12010),a=n(11987),o=n(11989),i=n(11988),s=Object(r.createChangeAction)("siteMap/UPDATE_NODE_ID",Object(a.payload)(),e=>Object(i.withTelemetryEventMeta)({eventName:o.default.UpdateNodeId,eventData:{nodePathType:e.nodePath.pathType}})),c=Object(r.createChangeAction)("siteMap/UPDATE_NODE_TITLE",Object(a.payload)(),e=>Object(i.withTelemetryEventMeta)({eventName:o.default.UpdateNodeTitle,eventData:{nodePathType:e.nodePath.pathType}})),l=Object(r.createChangeAction)("siteMap/UPDATE_SUBAREA_ENTITY",Object(a.payload)(),()=>Object(i.withTelemetryEventMeta)({eventName:o.default.UpdateSubAreaEntity})),u=Object(r.createChangeAction)("siteMap/UPDATE_SUBAREA_DASHBOARD",Object(a.payload)(),()=>Object(i.withTelemetryEventMeta)({eventName:o.default.UpdateSubAreaDashboard})),d=Object(r.createChangeAction)("siteMap/UPDATE_SUBAREA_CUSTOM_PAGE",Object(a.payload)(),()=>Object(i.withTelemetryEventMeta)({eventName:o.default.UpdateSubAreaCustomPage})),p=Object(r.createChangeAction)("siteMap/UPDATE_SUBAREA_URL",Object(a.payload)(),e=>Object(i.withTelemetryEventMeta)({eventName:o.default.UpdateSubAreaUrl,eventData:{newUrlType:e.newUrlType}})),f=Object(r.createChangeAction)("siteMap/UPDATE_SUBAREA_ICON",Object(a.payload)(),()=>Object(i.withTelemetryEventMeta)({eventName:o.default.UpdateSubAreaIcon})),m=Object(r.createChangeAction)("siteMap/INSERT_SITE_MAP_NODE",Object(a.payload)(),e=>Object(i.withTelemetryEventMeta)({eventName:o.default.InsertSiteMapNode,eventData:{nodePathType:e.targetPath.pathType}})),b=Object(r.createChangeAction)("siteMap/UPDATE_SHOW_HOME",Object(a.payload)(),e=>Object(i.withTelemetryEventMeta)({eventName:o.default.UpdateShowHome,eventData:{showHome:e}})),v=Object(r.createChangeAction)("siteMap/UPDATE_SHOW_PINNED",Object(a.payload)(),e=>Object(i.withTelemetryEventMeta)({eventName:o.default.UpdateShowPinned,eventData:{showPinned:e}})),g=Object(r.createChangeAction)("siteMap/UPDATE_SHOW_RECENTS",Object(a.payload)(),e=>Object(i.withTelemetryEventMeta)({eventName:o.default.UpdateShowRecents,eventData:{showRecents:e}})),y=Object(r.createChangeAction)("siteMap/UPDATE_ENABLE_COLLAPSIBLE_GROUPS",Object(a.payload)(),e=>Object(i.withTelemetryEventMeta)({eventName:o.default.UpdateEnableCollapsibleGroups,eventData:{enableCollapsibleGroups:e}})),h=Object(r.createChangeAction)("siteMap/UPDATE_ENABLE_AREAS",Object(a.payload)(),e=>Object(i.withTelemetryEventMeta)({eventName:o.default.UpdateEnableAreas,eventData:{enableAreas:e}})),S=Object(r.createChangeAction)("siteMap/UPDATE_ENABLE_URL_SUBAREAS",Object(a.payload)(),e=>Object(i.withTelemetryEventMeta)({eventName:o.default.UpdateEnableUrlSubAreas,eventData:{enableUrlSubAreas:e}})),O=Object(r.createChangeAction)("siteMap/DELETE_NODE",Object(a.payload)(),e=>Object(i.withTelemetryEventMeta)({eventName:o.default.DeleteSiteMapNode,eventData:{nodePathType:e.pathType}})),A=Object(r.createChangeAction)("siteMap/MOVE_NODE_UP",Object(a.payload)(),e=>Object(i.withTelemetryEventMeta)({eventName:o.default.MoveSiteMapNodeUp,eventData:{nodePathType:e.path.pathType}})),P=Object(r.createChangeAction)("siteMap/MOVE_NODE_DOWN",Object(a.payload)(),e=>Object(i.withTelemetryEventMeta)({eventName:o.default.MoveSiteMapNodeDown,eventData:{nodePathType:e.path.pathType}}));function j(e){var t;return Object(r.isDocumentChangeAction)(e)&&0===(null===(t=e.type)||void 0===t?void 0:t.indexOf("siteMap"))}},12012:function(e,t,n){"use strict";n.r(t),n.d(t,"initialState",(function(){return m})),n.d(t,"topLevelReducer",(function(){return b})),n.d(t,"baseReducer",(function(){return v})),n.d(t,"reducer",(function(){return g}));var r=n(12013),a=n.n(r),o=n(11986),i=n(12018),s=n(12010),c=n(12006),l=n(12019),u=n(12022);function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){f(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,"appModuleReducer",(function(){return l.appModuleReducer})),n.d(t,"siteMapReducer",(function(){return u.siteMapReducer}));var m={appModule:Object(i.notStarted)(),siteMap:Object(i.notStarted)()},b=Object(o.createReducer)(m).handleAction(c.loadApp.request,e=>p(p({},e),{},{appModule:Object(i.loading)(),siteMap:Object(i.loading)()})).handleAction(c.loadApp.success,(e,t)=>p(p({},e),{},{appModule:Object(i.loaded)(t.payload.appModule),siteMap:Object(i.loaded)(t.payload.siteMap)})).handleAction(c.loadApp.failure,(e,t)=>p(p({},e),{},{appModule:Object(i.loadFailed)(t.payload),siteMap:Object(i.loadFailed)(t.payload)})),v=(e,t)=>{if(!e)return m;var n=b(e,t),r=n.appModule,a=n.siteMap,o=Object(i.mapLoaded)(r,e=>Object(l.appModuleReducer)(e,t)),s=Object(i.mapLoaded)(a,e=>Object(u.siteMapReducer)(e,t));return p(p(p({},e),n),{},{appModule:o.value!==r.value?o:r,siteMap:s.value!==a.value?s:a})},g=a()(v,{filter:e=>Object(s.isDocumentChangeAction)(e)})},12018:function(e,t,n){"use strict";var r;function a(){return{loadState:r.NotStarted}}function o(){return{loadState:r.Loading}}function i(e){return{loadState:r.Loaded,value:e}}function s(e){if(e.loadState!==r.Loaded)throw new Error("Provided Loadable was not actually loaded");return e.value}function c(e,t){return e.loadState!==r.Loaded?t:e.value}function l(e,t){return e.loadState!==r.Loaded?e:i(t(e.value))}function u(e){return{loadState:r.LoadFailed,error:e}}n.r(t),n.d(t,"LoadStates",(function(){return r})),n.d(t,"notStarted",(function(){return a})),n.d(t,"loading",(function(){return o})),n.d(t,"loaded",(function(){return i})),n.d(t,"unwrap",(function(){return s})),n.d(t,"tryUnwrap",(function(){return c})),n.d(t,"mapLoaded",(function(){return l})),n.d(t,"loadFailed",(function(){return u})),function(e){e.NotStarted="notStarted",e.Loading="loading",e.Loaded="loaded",e.LoadFailed="loadFailed"}(r||(r={}))},12019:function(e,t,n){"use strict";n.r(t),n.d(t,"appModuleReducer",(function(){return d}));var r=n(10552),a=n(11986),o=n(12020),i=n(12021),s=n(12008);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var d=Object(a.createReducer)(Object(o.makeAppModule)()).handleAction(s.addAppModuleEntities,(e,t)=>{var n=t.payload.entities.map(e=>Object(o.makeAppModuleComponent)({entityId:e.id})),r=e.appEntityInfo.concat(n.filter(t=>!e.appEntityInfo.find(e=>e.entityId===t.entityId)));return l(l({},e),{},{appEntityInfo:r})}).handleAction(s.addAppModuleDashboards,(e,t)=>{var n=t.payload.dashboards.map(e=>e.id),r=e.dashboardIds.concat(n.filter(t=>!e.dashboardIds.find(e=>e===t)));return l(l({},e),{},{dashboardIds:r})}).handleAction(s.removeAppModuleEntities,(e,t)=>l(l({},e),{},{appEntityInfo:e.appEntityInfo.filter(e=>{var{entityId:n}=e;return!t.payload.find(e=>e.id===n)})})).handleAction(s.removeAppModuleDashboards,(e,t)=>l(l({},e),{},{dashboardIds:e.dashboardIds.filter(e=>!t.payload.find(t=>t===e))})).handleAction(s.addAppModuleCustomPages,(e,t)=>{var n=e.canvasApps.concat(t.payload.customPages.filter(t=>!e.canvasApps.find(e=>e.id===t.id)).map(e=>({id:e.id,type:i.customPageComponentType})));return l(l({},e),{},{canvasApps:n})}).handleAction(s.removeAppModuleCustomPages,(e,t)=>l(l({},e),{},{canvasApps:e.canvasApps.filter(e=>!t.payload.find(t=>t.id===e.id))})).handleAction(s.updateAppModuleDisplayName,(e,t)=>l(l({},e),{},{appInfo:l(l({},e.appInfo),{},{title:t.payload})})).handleAction(s.updateAppModuleDescription,(e,t)=>l(l({},e),{},{appInfo:l(l({},e.appInfo),{},{description:t.payload})})).handleAction(s.updateAppModuleMobileOfflineProfiles,(e,t)=>l(l({},e),{},{appInfo:l(l({},e.appInfo),{},{mobileOfflineProfileIds:t.payload})})).handleAction(s.updateViewsForEntityComponent,(e,t)=>{var{payload:{entity:n,views:a}}=t;return Object(r.produce)(e=>{var t=e.appEntityInfo.findIndex(e=>e.entityId===n.id);-1!==t&&(e.appEntityInfo[t].views=a.map(e=>({id:e.id,type:e.queryType})))})(e)}).handleAction(s.removeViewsFromEntityComponent,(e,t)=>{var{payload:{entity:n,views:a}}=t;return Object(r.produce)(e=>{var t=e.appEntityInfo.findIndex(e=>e.entityId===n.id);-1!==t&&(e.appEntityInfo[t].views=e.appEntityInfo[t].views.filter(e=>!a.find(t=>t.id===e.id)))})(e)}).handleAction(s.updateChartsForEntityComponent,(e,t)=>{var{payload:{entity:n,charts:a}}=t;return Object(r.produce)(e=>{var t=e.appEntityInfo.findIndex(e=>e.entityId===n.id);-1!==t&&(e.appEntityInfo[t].chartIds=a.map(e=>e.id))})(e)}).handleAction(s.removeChartsFromEntityComponent,(e,t)=>{var{payload:{entity:n,charts:a}}=t;return Object(r.produce)(e=>{var t=e.appEntityInfo.findIndex(e=>e.entityId===n.id);-1!==t&&(e.appEntityInfo[t].chartIds=e.appEntityInfo[t].chartIds.filter(e=>!a.find(t=>t.id===e)))})(e)}).handleAction(s.updateFormsForEntityComponent,(e,t)=>{var{payload:{entity:n,forms:a}}=t;return Object(r.produce)(e=>{var t=e.appEntityInfo.findIndex(e=>e.entityId===n.id);-1!==t&&(e.appEntityInfo[t].forms=a.map(e=>({id:e.id,type:e.formType})))})(e)}).handleAction(s.removeFormsFromEntityComponent,(e,t)=>{var{payload:{entity:n,forms:a}}=t;return Object(r.produce)(e=>{var t=e.appEntityInfo.findIndex(e=>e.entityId===n.id);-1!==t&&(e.appEntityInfo[t].forms=e.appEntityInfo[t].forms.filter(e=>!a.find(t=>t.id===e.id)))})(e)})},12020:function(e,t,n){"use strict";function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.r(t),n.d(t,"makeAppModule",(function(){return i})),n.d(t,"makeAppModuleComponent",(function(){return s}));var i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return a(a({sitemapId:"",appEntityInfo:[],businessProcessFlowIds:[],dashboardIds:[],canvasApps:[]},e),{},{appInfo:a({appId:"",uniqueName:"",title:"",description:"",mobileOfflineProfileIds:[]},null==e?void 0:e.appInfo)})},s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return a({entityId:"",chartIds:[],dashboards:[],forms:[],views:[]},e)}},12021:function(e,t,n){"use strict";n.r(t),n.d(t,"customPageComponentType",(function(){return r}));var r=2},12022:function(e,t,n){"use strict";n.r(t),n.d(t,"siteMapReducer",(function(){return f}));var r=n(10552),a=n(11986),o=n(10303),i=n(10313),s=n(12023),c=n(10304),l=n(10302),u=n(10308),d=n(12008),p=n(12024),f=Object(a.createReducer)(s.initialSiteMap).handleAction(d.updateNodeId,(e,t)=>Object(r.produce)(e=>{var n=Object(l.getSiteMapNodeViaPath)(e,t.payload.nodePath);n&&(Object(c.writeable)(n).Id=t.payload.newId)})(e)).handleAction(d.updateSiteMapNodeTitle,(e,t)=>Object(r.produce)(e=>{var n=Object(l.getSiteMapNodeViaPath)(e,t.payload.nodePath);n&&Object(o.setOrClearTitle)(n,t.payload.newTitle,t.payload.languageCode)})(e)).handleAction(d.updateSubAreaEntity,(e,t)=>Object(r.produce)(e=>{var n=Object(l.getSiteMapNodeViaPath)(e,t.payload.nodePath);n&&Object(u.isSubAreaNode)(n)&&Object(i.updateSubAreaEntity)(n,t.payload.newEntityLogicalName)})(e)).handleAction(d.updateSubAreaDashboard,(e,t)=>Object(r.produce)(e=>{var n=Object(l.getSiteMapNodeViaPath)(e,t.payload.nodePath);n&&Object(u.isSubAreaNode)(n)&&Object(i.updateSubAreaDashboard)(n,t.payload.newDashboardId)})(e)).handleAction(d.updateSubAreaCustomPage,(e,t)=>Object(r.produce)(e=>{var n=Object(l.getSiteMapNodeViaPath)(e,t.payload.nodePath);n&&Object(u.isSubAreaNode)(n)&&Object(i.updateSubAreaCustomPage)(n,t.payload.newPageName)})(e)).handleAction(d.updateSubAreaUrl,(e,t)=>Object(r.produce)(e=>{var n=Object(l.getSiteMapNodeViaPath)(e,t.payload.nodePath);n&&Object(u.isSubAreaNode)(n)&&Object(i.updateSubAreaUrl)(n,t.payload.newUrl)})(e)).handleAction(d.updateSubAreaIcon,(e,t)=>Object(r.produce)(e=>{var n=Object(l.getSiteMapNodeViaPath)(e,t.payload.nodePath);n&&Object(u.isSubAreaNode)(n)&&Object(i.updateSubAreaIcon)(n,t.payload.icon,t.payload.vectorIcon)})(e)).handleAction(d.insertSiteMapNode,(e,t)=>Object(r.produce)(e=>{var n=e.siteMapXml,{node:r,targetPath:a}=t.payload;Object(l.insertNodeIntoSiteMap)(n,r,a)})(e)).handleAction(d.updateShowHome,(e,t)=>Object(r.produce)(e=>{e.showHome=t.payload})(e)).handleAction(d.updateShowPinned,(e,t)=>Object(r.produce)(e=>{e.showPinned=t.payload})(e)).handleAction(d.updateShowRecents,(e,t)=>Object(r.produce)(e=>{e.showRecents=t.payload})(e)).handleAction(d.updateEnableCollapsibleGroups,(e,t)=>Object(r.produce)(e=>{e.enableCollapsibleGroups=t.payload})(e)).handleAction(d.updateEnableAreas,(e,t)=>Object(r.produce)(e=>{e.enableAreas=t.payload})(e)).handleAction(d.updateEnableUrlSubAreas,(e,t)=>Object(r.produce)(e=>{e.enableUrlSubAreas=t.payload})(e)).handleAction(d.deleteNode,(e,t)=>Object(r.produce)(e=>{Object(l.deleteNodeAtPath)(e,t.payload)})(e)).handleAction(d.moveNodeUp,(e,t)=>Object(r.produce)(e=>{var n=t.payload.path,r=Object(l.getSiteMapNodeViaPath)(e,n);r&&(n.pathType===l.NodePathType.Area?Object(p.moveAreaUp)(e,n,r):n.pathType===l.NodePathType.Group?Object(p.moveGroupUp)(e,n,r):n.pathType===l.NodePathType.SubArea&&Object(p.moveSubAreaUp)(e,n,r))})(e)).handleAction(d.moveNodeDown,(e,t)=>Object(r.produce)(e=>{var n=t.payload.path,r=t.payload.node;r&&(n.pathType===l.NodePathType.Area?Object(p.moveAreaDown)(e,n,r):n.pathType===l.NodePathType.Group?Object(p.moveGroupDown)(e,n,r):n.pathType===l.NodePathType.SubArea&&Object(p.moveSubAreaDown)(e,n,r))})(e))},12023:function(e,t,n){"use strict";n.r(t),n.d(t,"initialSiteMap",(function(){return c})),n.d(t,"dashboardSubArea",(function(){return l})),n.d(t,"webResourceSubArea",(function(){return u})),n.d(t,"urlSubArea",(function(){return d})),n.d(t,"area1",(function(){return p})),n.d(t,"area2",(function(){return f})),n.d(t,"areaWithWebResourceSubArea",(function(){return m})),n.d(t,"areaWithUrlSubArea",(function(){return b})),n.d(t,"areaWithGroupWithNoSubareas",(function(){return v})),n.d(t,"getMockSiteMap",(function(){return g})),n.d(t,"siteMapXml",(function(){return y})),n.d(t,"siteMapObject",(function(){return h})),n.d(t,"siteMapXmlWithPageAttribute",(function(){return S})),n.d(t,"siteMapXmlWithUnknownAttrributes",(function(){return O}));var r=n(10305),a=n(10298);function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var c={id:"",name:"",siteMapXml:{IntroducedVersion:"",Area:[]},showHome:!0,showRecents:!0,showPinned:!0,enableCollapsibleGroups:!1},l={Type:a.default.SubArea,Id:"DashboardsSubArea_b9d785c5",ResourceId:"Homepage_Dashboards",DescriptionResourceId:"Dashboards_Description",Icon:"/_imgs/imagestrips/transparent_spacer.gif",Url:"/workplace/home_dashboards.aspx",DefaultDashboard:"d201a642-6283-4f1d-81b7-da4b1685e698",Client:"All,Outlook,OutlookLaptopClient,OutlookWorkstationClient,Web",AvailableOffline:"true",PassParams:"false",Sku:"All,OnPremise,Live,SPLA",ToolTipResourseId:"Dashboards_ToolTip",Titles:[{Title:[{LCID:"1033",Title:"Dashboards"}]}]},u={Type:a.default.SubArea,Titles:Object(r.makeTitles)("web resource","1033"),AvailableOffline:"false",Client:"client",Icon:"icon.ico",Id:"webresource_123",PassParams:"false",Sku:"sku",Url:"$webresource:msdyn_microsoft"},d={Type:a.default.SubArea,Titles:Object(r.makeTitles)("SubArea211","1033"),AvailableOffline:"false",Client:"client",Icon:"icon.ico",Id:"subArea211Id",PassParams:"false",Sku:"sku",Url:"http://microsoft.com/"},p={Titles:Object(r.makeTitles)("Area1","1033"),Id:"area1Id",ResourceId:"area1Resource",Icon:"icon.ico",ShowGroups:"false",Group:[{Type:a.default.Group,Titles:Object(r.makeTitles)("Group11","1033"),Id:"group11Id",ResourceId:"group11Resource",IsProfile:"false",ToolTipResourseId:"group11ToolTip",SubArea:[{Titles:Object(r.makeTitles)("SubArea111","1033"),AvailableOffline:"false",Client:"client",Icon:"icon.ico",Id:"subArea111Id",PassParams:"false",Sku:"sku"}]},{Type:a.default.Group,Titles:Object(r.makeTitles)("Group12","1033"),Id:"group12Id",ResourceId:"group12Resource",IsProfile:"false",ToolTipResourseId:"group12ToolTip",SubArea:[{Titles:Object(r.makeTitles)("SubArea121","1033"),AvailableOffline:"false",Client:"client",Icon:"icon.ico",Id:"subArea121Id",PassParams:"false",Sku:"sku"}]}]},f={Titles:Object(r.makeTitles)("Area2","1033"),Id:"area2Id",ResourceId:"area2Resource",Icon:"icon.ico",ShowGroups:"false",Group:[{Type:a.default.Group,Titles:Object(r.makeTitles)("Group21","1033"),Id:"group21Id",ResourceId:"group21Resource",IsProfile:"false",ToolTipResourseId:"group21ToolTip",SubArea:[{Titles:Object(r.makeTitles)("SubArea211","1033"),AvailableOffline:"false",Client:"client",Icon:"icon.ico",Id:"subArea211Id",PassParams:"false",Sku:"sku"}]},{Type:a.default.Group,Titles:Object(r.makeTitles)("Group22","1033"),Id:"group22Id",ResourceId:"group22Resource",IsProfile:"false",ToolTipResourseId:"group22ToolTip",SubArea:[{Titles:Object(r.makeTitles)("SubArea221","1033"),AvailableOffline:"false",Client:"client",Icon:"icon.ico",Id:"subArea221Id",PassParams:"false",Sku:"sku"}]}]},m={Titles:Object(r.makeTitles)("areaWithWebResourceSubArea","1033"),Id:"areaWithWebResourceSubAreaId",ResourceId:"areaWithWebResourceSubAreaResource",Icon:"icon.ico",ShowGroups:"false",Group:[{Type:a.default.Group,Titles:Object(r.makeTitles)("Group1","1033"),Id:"group1Id",ResourceId:"group1Resource",IsProfile:"false",ToolTipResourseId:"group1ToolTip",SubArea:[i({},u)]}]},b={Titles:Object(r.makeTitles)("areaWithUrlSubArea","1033"),Id:"areaWithUrlSubAreaId",ResourceId:"areaWithUrlSubAreaResource",Icon:"icon.ico",ShowGroups:"false",Group:[{Type:a.default.Group,Titles:Object(r.makeTitles)("Group21","1033"),Id:"group21Id",ResourceId:"group21Resource",IsProfile:"false",ToolTipResourseId:"group21ToolTip",SubArea:[i({},d)]}]},v={Titles:Object(r.makeTitles)("areaWithWebResourceSubArea","1033"),Id:"areaWithWebResourceSubAreaId",ResourceId:"areaWithWebResourceSubAreaResource",Icon:"icon.ico",ShowGroups:"false",Group:[{Type:a.default.Group,Titles:Object(r.makeTitles)("Group1","1033"),Id:"group1Id",ResourceId:"group1Resource",IsProfile:"false",ToolTipResourseId:"group1ToolTip",SubArea:[i({},u)]},{Type:a.default.Group,Titles:Object(r.makeTitles)("Group21","1033"),Id:"group21Id",ResourceId:"group21Resource",IsProfile:"false",ToolTipResourseId:"group21ToolTip",SubArea:void 0}]},g=e=>{var t,n,r,a;return i(i({},c),{},{id:"123",name:"SiteMap",siteMapXml:i(i({},c.siteMapXml),{},{Area:null==e?void 0:e.areas}),showHome:null===(t=null==e?void 0:e.showHome)||void 0===t||t,showRecents:null===(n=null==e?void 0:e.showRecents)||void 0===n||n,showPinned:null===(r=null==e?void 0:e.showPinned)||void 0===r||r,enableCollapsibleGroups:null!==(a=null==e?void 0:e.enableCollapsibleGroups)&&void 0!==a&&a,enableAreas:null==e?void 0:e.enableAreas,enableUrlSubAreas:null==e?void 0:e.enableUrlSubAreas})},y='<SiteMap IntroducedVersion="7.0.0.0"><Area Id="Service_Area" ResourceId="SiteMapDesigner.ServiceArea" Icon="/WebResources/msdyn_/Images/Area_Default_Icon.png" ShowGroups="false"><Titles><Title LCID="1033" Title="Service"/></Titles><Group Id="MyWorkGroup_b000e815" ResourceId="SiteMapDesigner.MyWorkGroup" IsProfile="false" ToolTipResourseId="SiteMapDesigner.Unknown"><Titles><Title LCID="1033" Title="My Work"/></Titles><SubArea Id="DashboardsSubArea_b9d785c5" ResourceId="Homepage_Dashboards" DescriptionResourceId="Dashboards_Description" Icon="/_imgs/imagestrips/transparent_spacer.gif" Url="/workplace/home_dashboards.aspx" DefaultDashboard="d201a642-6283-4f1d-81b7-da4b1685e698" Client="All,Outlook,OutlookLaptopClient,OutlookWorkstationClient,Web" AvailableOffline="true" PassParams="false" Sku="All,OnPremise,Live,SPLA" ToolTipResourseId="Dashboards_ToolTip"><Titles><Title LCID="1033" Title="Dashboards"/></Titles></SubArea><SubArea Id="ActivitiesSubArea_51b88024" Icon="/_imgs/imagestrips/transparent_spacer.gif" Entity="activitypointer" Client="All,Outlook,OutlookLaptopClient,OutlookWorkstationClient,Web" AvailableOffline="true" PassParams="false" Sku="All,OnPremise,Live,SPLA"><Titles><Title LCID="1033" Title="Activities"/></Titles></SubArea></Group></Area></SiteMap>',h={IntroducedVersion:"7.0.0.0",Area:[{Type:a.default.Area,Id:"Service_Area",ResourceId:"SiteMapDesigner.ServiceArea",Icon:"/WebResources/msdyn_/Images/Area_Default_Icon.png",ShowGroups:"false",Titles:[{Title:[{LCID:"1033",Title:"Service"}]}],Group:[{Type:a.default.Group,Id:"MyWorkGroup_b000e815",ResourceId:"SiteMapDesigner.MyWorkGroup",IsProfile:"false",ToolTipResourseId:"SiteMapDesigner.Unknown",Titles:[{Title:[{LCID:"1033",Title:"My Work"}]}],SubArea:[i({},l),{Type:a.default.SubArea,Id:"ActivitiesSubArea_51b88024",Icon:"/_imgs/imagestrips/transparent_spacer.gif",Entity:"activitypointer",Client:"All,Outlook,OutlookLaptopClient,OutlookWorkstationClient,Web",AvailableOffline:"true",PassParams:"false",Sku:"All,OnPremise,Live,SPLA",Titles:[{Title:[{LCID:"1033",Title:"Activities"}]}]}]}]}]},S='<SiteMap IntroducedVersion="7.0.0.0"><Area Id="Service_Area" ResourceId="SiteMapDesigner.ServiceArea" Icon="/WebResources/msdyn_/Images/Area_Default_Icon.png" ShowGroups="false"><Titles><Title LCID="1033" Title="Service"/></Titles><Group Id="MyWorkGroup_b000e815" ResourceId="SiteMapDesigner.MyWorkGroup" IsProfile="false" ToolTipResourseId="SiteMapDesigner.Unknown"><Titles><Title LCID="1033" Title="My Work"/></Titles><SubArea Id="DashboardsSubArea_b9d785c5" ResourceId="Homepage_Dashboards" DescriptionResourceId="Dashboards_Description" Icon="/_imgs/imagestrips/transparent_spacer.gif" Url="/workplace/home_dashboards.aspx" DefaultDashboard="d201a642-6283-4f1d-81b7-da4b1685e698" Client="All,Outlook,OutlookLaptopClient,OutlookWorkstationClient,Web" AvailableOffline="true" PassParams="false" Sku="All,OnPremise,Live,SPLA" ToolTipResourseId="Dashboards_ToolTip" Page="new_PageEntity"><Titles><Title LCID="1033" Title="Dashboards"/></Titles></SubArea><SubArea Id="ActivitiesSubArea_51b88024" Icon="/_imgs/imagestrips/transparent_spacer.gif" Entity="activitypointer" Client="All,Outlook,OutlookLaptopClient,OutlookWorkstationClient,Web" AvailableOffline="true" PassParams="false" Sku="All,OnPremise,Live,SPLA"><Titles><Title LCID="1033" Title="Activities"/></Titles></SubArea></Group></Area></SiteMap>',O='<SiteMap IntroducedVersion="7.0.0.0"><Area Id="Service_Area" ResourceId="SiteMapDesigner.ServiceArea" Icon="/WebResources/msdyn_/Images/Area_Default_Icon.png" ShowGroups="false"><Titles><Title LCID="1033" Title="Service"/></Titles><Group Id="MyWorkGroup_b000e815" ResourceId="SiteMapDesigner.MyWorkGroup" IsProfile="false" ToolTipResourseId="SiteMapDesigner.Unknown"><Titles><Title LCID="1033" Title="My Work"/></Titles><SubArea MadeUpProp="123" Id="DashboardsSubArea_b9d785c5" ResourceId="Homepage_Dashboards" DescriptionResourceId="Dashboards_Description" Icon="/_imgs/imagestrips/transparent_spacer.gif" Url="/workplace/home_dashboards.aspx" DefaultDashboard="d201a642-6283-4f1d-81b7-da4b1685e698" Client="All,Outlook,OutlookLaptopClient,OutlookWorkstationClient,Web" AvailableOffline="true" PassParams="false" Sku="All,OnPremise,Live,SPLA" ToolTipResourseId="Dashboards_ToolTip"><Titles><Title LCID="1033" Title="Dashboards"/></Titles></SubArea><SubArea OtherMadeUpProp="123" Id="ActivitiesSubArea_51b88024" Icon="/_imgs/imagestrips/transparent_spacer.gif" Entity="activitypointer" Client="All,Outlook,OutlookLaptopClient,OutlookWorkstationClient,Web" AvailableOffline="true" PassParams="false" Sku="All,OnPremise,Live,SPLA"><Titles><Title LCID="1033" Title="Activities"/></Titles></SubArea></Group></Area></SiteMap>'},12024:function(e,t,n){"use strict";n.r(t),n.d(t,"moveAreaUp",(function(){return a})),n.d(t,"moveGroupUp",(function(){return o})),n.d(t,"moveSubAreaUp",(function(){return i})),n.d(t,"moveAreaDown",(function(){return s})),n.d(t,"moveGroupDown",(function(){return c})),n.d(t,"moveSubAreaDown",(function(){return l}));var r=n(10302);function a(e,t,n){var a=Object(r.nodePath)(Math.max(0,t.areaIndex-1));Object(r.deleteNodeAtPath)(e,t),Object(r.insertNodeIntoSiteMap)(e.siteMapXml,n,a)}function o(e,t,n){var a=t.areaIndex,o=t.groupIndex-1,i=Object(r.nodePath)(a,o);if(o<0){var s,c,l=Math.max(0,a-1),u=Object(r.getSiteMapNodeViaPath)(e,Object(r.nodePath)(l));i=Object(r.nodePath)(l,null!==(s=null==u||null===(c=u.Group)||void 0===c?void 0:c.length)&&void 0!==s?s:0)}Object(r.deleteNodeAtPath)(e,t),Object(r.insertNodeIntoSiteMap)(e.siteMapXml,n,i)}function i(e,t,n){var a,o=t.areaIndex,i=t.groupIndex,s=t.subAreaIndex-1;if(s>=0)a=Object(r.nodePath)(o,i,s);else if(a=Object(r.nodePath)(o,i,t.subAreaIndex),i>0){var c,l,u=i-1,d=Object(r.getSiteMapNodeViaPath)(e,Object(r.nodePath)(o,u));a=Object(r.nodePath)(o,u,null!==(c=null==d||null===(l=d.SubArea)||void 0===l?void 0:l.length)&&void 0!==c?c:0)}else for(var p=o-1;p>=0;p--){var f=Object(r.getSiteMapNodeViaPath)(e,Object(r.nodePath)(p));if(null!=f&&f.Group&&f.Group.length>0){var m,b,v=f.Group.length-1,g=Object(r.getSiteMapNodeViaPath)(e,Object(r.nodePath)(p,v));a=Object(r.nodePath)(p,v,null!==(m=null==g||null===(b=g.SubArea)||void 0===b?void 0:b.length)&&void 0!==m?m:0);break}}Object(r.deleteNodeAtPath)(e,t),Object(r.insertNodeIntoSiteMap)(e.siteMapXml,n,a)}function s(e,t,n){var a,o,i=null!==(a=null===(o=e.siteMapXml.Area)||void 0===o?void 0:o.length)&&void 0!==a?a:0,s=Object(r.nodePath)(Math.min(i,t.areaIndex+1));Object(r.deleteNodeAtPath)(e,t),Object(r.insertNodeIntoSiteMap)(e.siteMapXml,n,s)}function c(e,t,n){var a,o,i,s,c,l=t.areaIndex,u=t.groupIndex+1,d=null!==(a=null===(o=e.siteMapXml.Area)||void 0===o?void 0:o.length)&&void 0!==a?a:0,p=null!==(i=null===(s=Object(r.getSiteMapNodeViaPath)(e,Object(r.nodePath)(l)))||void 0===s||null===(c=s.Group)||void 0===c?void 0:c.length)&&void 0!==i?i:0,f=Object(r.nodePath)(l,u);if(u>=p)if(l+1<d){var m=Math.min(d-1,l+1);f=Object(r.nodePath)(m,0)}else f=Object(r.nodePath)(t.areaIndex,t.groupIndex);Object(r.deleteNodeAtPath)(e,t),Object(r.insertNodeIntoSiteMap)(e.siteMapXml,n,f)}function l(e,t,n){var a,o,i,s,c,l,u,d=t.areaIndex,p=t.groupIndex,f=t.subAreaIndex+1,m=null!==(a=null===(o=Object(r.getSiteMapNodeViaPath)(e,Object(r.nodePath)(d)))||void 0===o||null===(i=o.Group)||void 0===i?void 0:i.length)&&void 0!==a?a:0;if(f<(null!==(s=null===(c=Object(r.getSiteMapNodeViaPath)(e,Object(r.nodePath)(d,p)))||void 0===c||null===(l=c.SubArea)||void 0===l?void 0:l.length)&&void 0!==s?s:0))u=Object(r.nodePath)(d,p,f);else if(u=Object(r.nodePath)(d,p,t.subAreaIndex),p+1<m){var b=p+1;u=Object(r.nodePath)(d,b,0)}else for(var v,g,y=null!==(v=null===(g=e.siteMapXml.Area)||void 0===g?void 0:g.length)&&void 0!==v?v:0,h=d+1;h<y;h++){var S=Object(r.getSiteMapNodeViaPath)(e,Object(r.nodePath)(h));if(null!=S&&S.Group&&S.Group.length>0){u=Object(r.nodePath)(h,0,0);break}}Object(r.deleteNodeAtPath)(e,t),Object(r.insertNodeIntoSiteMap)(e.siteMapXml,n,u)}},12025:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return x})),n.d(t,"saveAppModule",(function(){return R}));var r=n(10302),a=n(10293),o=n(10314),i=n(10299),s=n(12026),c=n(10291),l=n(10316),u=n(12027),d=n(12028),p=n(217),f=n(11986),m=n(12029),b=n(12018),v=n(12003),g=n(11990),y=n(12006),h=n(12030),S=n(12035),O=n(12039),A=n(12041),P=n(12043),j=n(12045),E=n(12047),C=n(12048),T=n(12049),M=n(12051),w=n(12054),I=n(12032);function N(e,t,n,r,a,o,i){try{var s=e[o](i),c=s.value}catch(l){return void n(l)}s.done?t(c):Promise.resolve(c).then(r,a)}function D(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){N(o,r,a,i,s,"next",e)}function s(e){N(o,r,a,i,s,"throw",e)}i(void 0)}))}}function x(e){return t=>n=>function(){var r=D((function*(r){var a=n(r);if(Object(f.isActionOf)(y.createApp.request,r)&&(yield Object(h.createApp)(t,e,r.payload)),Object(f.isActionOf)(y.loadApp.request,r)&&(yield Object(S.loadApp)(t,e,r.payload.appModuleId)),Object(f.isActionOf)(y.loadEntities.request,r)){var o=e.apolloClient;try{var c=(yield o.query({query:s.AppModuleEntitiesQuery})).data.entityTypes;t.dispatch(y.loadEntities.success(c))}catch(p){t.dispatch(y.loadEntities.failure(new i.CodedError({code:i.ErrorCodes.EntitiesLoad,innerError:p})))}}if(Object(f.isActionOf)(y.loadViewsByEntityName.request,r)&&(yield Object(T.loadViewsByEntityName)(t,e,r.payload)),Object(f.isActionOf)(y.loadChartsByEntityName.request,r)&&(yield Object(A.loadChartsByEntityName)(t,e,r.payload)),Object(f.isActionOf)(y.loadFormsByEntityName.request,r)&&(yield Object(j.loadFormsByEntityName)(t,e,r.payload)),Object(f.isActionOf)(y.loadDashboards.request,r)&&(yield Object(P.loadDashboards)(t,e,r.payload)),Object(f.isActionOf)(y.loadBusinessProcessFlows.request,r)&&(yield Object(O.loadBusinessProcessFlows)(t,e,r.payload)),Object(f.isActionOf)(y.loadCustomPages.request,r)){var l=e.apolloClient;try{var d=(yield l.query({query:u.CustomPagesQuery,fetchPolicy:r.payload.bypassCache?"no-cache":void 0})).data.cdsCanvasApps;t.dispatch(y.loadCustomPages.success(d))}catch(p){t.dispatch(y.loadCustomPages.failure(new i.CodedError({code:i.ErrorCodes.CustomPagesLoad,innerError:p})))}}return Object(f.isActionOf)(y.loadSolutionInfo.request,r)&&(yield Object(C.loadSolutionInfo)(t,e)),Object(f.isActionOf)(y.loadMobileOfflineProfiles.request,r)&&(yield Object(M.loadMobileOfflineProfiles)(t,e,r.payload)),Object(f.isActionOf)(y.loadEnableRoleBasedOfflineProfileAccessSetting.request,r)&&(yield Object(E.loadEnableRoleBasedOfflineProfileAccessSetting)(t,e,r.payload)),Object(f.isActionOf)(y.loadApp.success,r)&&Object(E.dispatchLoadEnableRoleBasedOfflineProfileAccessSettingAfterLoadApp)(t,r.payload),Object(f.isActionOf)(y.saveApp.request,r)&&(yield function(e,t){return k.apply(this,arguments)}(t,e)),Object(f.isActionOf)(y.publishApp.request,r)&&(yield function(e,t){return F.apply(this,arguments)}(t,e)),Object(f.isActionOf)(y.retrieveAppUnpublished.request,r)&&(yield Object(w.retrieveAppUnpublished)(t,e,r.payload.appModuleId,r.payload.siteMapComponentState)),Promise.resolve(a)}));return function(e){return r.apply(this,arguments)}}()}function k(){return(k=D((function*(e,t){try{yield R(e.getState(),t);var n=yield U(e.getState(),t);e.dispatch(y.saveApp.success({siteMap:n}))}catch(r){e.dispatch(y.saveApp.failure(r))}}))).apply(this,arguments)}function R(e,t){return L.apply(this,arguments)}function L(){return(L=D((function*(e,t){var n,a=I.getAppModule(e);if(a.loadState!==b.LoadStates.Loaded)throw new i.CodedError({code:i.ErrorCodes.AppModuleSaveNotLoaded,message:"Cannot save app module that is not in loaded state"});if(!I.appModuleHasChanges(e))return"";try{var o,s=Object(r.buildAppElementsList)(a.value),l=t.apolloClient;n=null===(o=(yield l.mutate({mutation:c.AppModuleSaveMutation,variables:{info:{appModuleId:a.value.appInfo.appId,uniqueName:a.value.appInfo.uniqueName,displayName:a.value.appInfo.title,description:a.value.appInfo.description},components:s,solutionId:t.routingProps.solutionId}})).data)||void 0===o?void 0:o.appModuleSave}catch(u){throw new i.CodedError({code:i.ErrorCodes.AppModuleSave,innerError:u})}if(!n)throw new i.CodedError({code:i.ErrorCodes.AppModuleSaveNoResponse,message:"App module successfully saved but no response was received"});return n}))).apply(this,arguments)}function U(e,t){return B.apply(this,arguments)}function B(){return(B=D((function*(e,t){var n,r,s=I.getSiteMap(e);if(s.loadState!==b.LoadStates.Loaded)throw new i.CodedError({code:i.ErrorCodes.SiteMapSaveNotLoaded,message:"Cannot save site map that is not in loaded state"});if(!I.siteMapHasChanges(e))return s.value;var c=Object(p.trackOtherScenario)(v.default,g.default.SiteMapSerialize);try{r=Object(o.default)(s.value.siteMapXml,c)}catch(P){throw new i.CodedError({code:i.ErrorCodes.SiteMapSaveSerializationError,innerError:P})}try{var l,u,f,m,y,h=t.apolloClient,S=yield h.mutate({mutation:d.UpdateSiteMapMutation,variables:{siteMapId:s.value.id,solutionId:t.routingProps.solutionId,inputSiteMap:{name:s.value.name,siteMapXml:r,showHome:s.value.showHome,showPinned:s.value.showPinned,showRecents:s.value.showRecents,enableCollapsibleGroups:s.value.enableCollapsibleGroups}}}),O=Object(p.trackOtherScenario)(v.default,g.default.SiteMapDeserialize),A=null===(l=S.data)||void 0===l?void 0:l.updateSiteMap;n=A&&{id:A.id,name:A.name,siteMapXml:Object(a.deserializeSiteMapXml)(A.siteMapXml,[],O),showHome:null!==(u=A.showHome)&&void 0!==u?u:void 0,showPinned:null!==(f=A.showPinned)&&void 0!==f?f:void 0,showRecents:null!==(m=A.showRecents)&&void 0!==m?m:void 0,enableCollapsibleGroups:null!==(y=A.enableCollapsibleGroups)&&void 0!==y?y:void 0}}catch(P){throw new i.CodedError({code:i.ErrorCodes.SiteMapSave,innerError:P})}if(!n)throw new i.CodedError({code:i.ErrorCodes.SiteMapSaveNoResponse,message:"Site map successfully saved but no response was received"});return n}))).apply(this,arguments)}function F(){return(F=D((function*(e,t){try{yield R(e.getState(),t),yield U(e.getState(),t)}catch(o){return void e.dispatch(y.publishApp.failure(new i.CodedError({code:i.ErrorCodes.AppModulePublishSaveFailed,innerError:o})))}var n=I.getAppModule(e.getState());if(n.loadState===b.LoadStates.Loaded){try{var r=t.apolloClient;yield r.mutate({mutation:l.PublishAppModuleMutation,variables:{id:n.value.appInfo.appId}})}catch(o){return void e.dispatch(y.publishApp.failure(new i.CodedError({code:i.ErrorCodes.AppModulePublish,innerError:o})))}var a=I.getEnableRoleBasedOfflineProfileAccessSetting(e.getState());if(m.featureGates.isMobileOfflineConfigurationEnabled&&null!=a&&a.value)try{yield Object(M.publishMobileOfflineProfileOnAppSave)(e,t)}catch(o){return void e.dispatch(y.publishApp.failure(new i.CodedError({code:i.ErrorCodes.MobileOfflineProfilePublish,innerError:o})))}e.dispatch(y.publishApp.success())}else e.dispatch(y.publishApp.failure(new i.CodedError({code:i.ErrorCodes.AppModulePublishNotLoaded,message:"Cannot publish app module that is not in loaded state"})))}))).apply(this,arguments)}},12026:function(e,t,n){"use strict";n.r(t),n.d(t,"AppModuleEntitiesQuery",(function(){return s}));var r,a=n(3128);var o,i,s=n.n(a)()(r||(o=["\n  query appModuleEntities {\n    entityTypes(entityTypeNames: [], solutionId: null, filterEntities: true) {\n      id\n      logicalName\n      logicalCollectionName\n      displayName\n      primaryIdAttribute\n      primaryNameAttribute\n      objectTypeCode\n      isActivity\n      isCustomEntity\n      isChildEntity\n      isValidForAdvancedFind\n      displayCollectionName\n      isVisibleInMobileClient\n      canModifyMobileClientVisibility\n    }\n  }\n"],i||(i=o.slice(0)),r=Object.freeze(Object.defineProperties(o,{raw:{value:Object.freeze(i)}}))))},12027:function(e,t,n){"use strict";n.r(t),n.d(t,"CustomPagesQuery",(function(){return s}));var r,a=n(3128);var o,i,s=n.n(a)()(r||(o=["\n  query cdsCustomPages($solutionId: String) {\n    cdsCanvasApps(solutionId: $solutionId, canvasAppType: 2) {\n      id\n      name\n      displayName\n    }\n  }\n"],i||(i=o.slice(0)),r=Object.freeze(Object.defineProperties(o,{raw:{value:Object.freeze(i)}}))))},12028:function(e,t,n){"use strict";n.r(t),n.d(t,"UpdateSiteMapMutation",(function(){return s}));var r,a=n(3128);var o,i,s=n.n(a)()(r||(o=["\n  mutation updateSiteMap(\n    $solutionId: String!\n    $siteMapId: String!\n    $inputSiteMap: InputSiteMap!\n    $solutionUniqueName: String\n  ) {\n    updateSiteMap(\n      solutionId: $solutionId\n      siteMapId: $siteMapId\n      inputSiteMap: $inputSiteMap\n      solutionUniqueName: $solutionUniqueName\n    ) {\n      id\n      name\n      siteMapXml\n      showHome\n      showRecents\n      showPinned\n      enableCollapsibleGroups\n    }\n  }\n"],i||(i=o.slice(0)),r=Object.freeze(Object.defineProperties(o,{raw:{value:Object.freeze(i)}}))))},12029:function(e,t,n){"use strict";n.r(t),n.d(t,"featureGates",(function(){return a}));var r=n(250),a=Object(r.createFeatureGatesConfig)({packageName:"cds-app-module-designer",features:{isMobileOfflineConfigurationEnabled:{owner:"guerb",description:"enables the UI to setup mobile offline",enabledFor:{test:!0,preprod:!0,preview:!0,prod:!0,gov:!0,high:!0,dod:!0,mooncake:!0,ex:!0,rx:!0}},enablePowerSettings:{owner:"dsteffee",description:'Controls the visibility of released PowerPlatform Settings (the "Features" tab)',enabledFor:{test:!0,preprod:!0,preview:!0,prod:!0,gov:!0,high:!0,dod:!0,mooncake:!0,ex:!0,rx:!0}},enableUpcomingPowerSettings:{owner:"dsteffee",description:'Controls the visibility of upcoming PowerPlatform Settings (the "Upcoming" tabs)',enabledFor:{test:!0,preprod:!0,preview:!0,prod:!0,gov:!0,high:!0,dod:!0,mooncake:!0,ex:!0,rx:!0}},enableCommandDesigner:{owner:"wzh",description:"Enable Command designer entry point",createdDate:"March 23, 2021",enabledFor:{test:!0,preprod:!0,preview:!0,prod:!0,gov:!0,high:!0,dod:!0,mooncake:!0,ex:!1,rx:!1}},enableCommentsPane:{owner:"takharch",description:"Enables commenting feature",createdDate:"May 17, 2021",enabledFor:{test:!0,preprod:!0,preview:!0,prod:!0,gov:!0,high:!0,dod:!0,mooncake:!0,ex:!0,rx:!0}},enableCommentsPaneAtMentions:{owner:"takharch",description:"Enables commenting pane at mentions functionality",createdDate:"May 17, 2021",enabledFor:{test:!0,preprod:!0,preview:!0,prod:!0,gov:!0,high:!0,dod:!0,mooncake:!0,ex:!0,rx:!0}},consoleLogTelemetry:{owner:"dsteffee",description:"Turns on console logs for shell-telemetry",createdDate:"08/19/2021",enabledFor:{}},siteMapIconsEnabled:{owner:"allenkim",description:"Enables setting the icon for sitemap subareas in the properties pane",enabledFor:{test:!0,preprod:!0,preview:!0,prod:!0,gov:!0,high:!0,dod:!0,mooncake:!0,ex:!0,rx:!0}},webResourceSubAreasEnabled:{owner:"allenkim",description:"Enables the ability to add and edit web resource subareas",enabledFor:{test:!0,preprod:!0,preview:!0,prod:!0,gov:!0,high:!0,dod:!0,mooncake:!0,ex:!0,rx:!0}},enableCoPresence:{owner:"takharch",description:"Enables co-presence feature",createdDate:"Aug 25, 2021",enabledFor:{test:!0,preprod:!1,preview:!1,prod:!1,gov:!1,high:!1,dod:!1,mooncake:!1,ex:!1,rx:!1}},urlSubAreasEnabled:{owner:"allenkim",description:"Enables the ability to add and edit url subareas",enabledFor:{test:!0,preprod:!0,preview:!0,prod:!0,gov:!0,high:!0,dod:!0,mooncake:!0,ex:!0,rx:!0}},automationPaneEnabled:{owner:"sanjeewj",description:"Enables the automation pane that allows adding business process flows.",enabledFor:{test:!0,preprod:!1,preview:!1,prod:!1,gov:!1,high:!1,dod:!1,mooncake:!1,ex:!1,rx:!1}},interactiveAndPowerBIDashboardsEnabled:{owner:"allenkim",description:"Enables the use of interactive and Power BI dashboards",enabledFor:{test:!0,preprod:!1,preview:!1,prod:!1,gov:!1,high:!1,dod:!1,mooncake:!1,ex:!1,rx:!1}},chartOptionsEnabled:{owner:"dennyho",description:"Enables the charts options section in the View Properties Pane that allows adding charts to the entity.",enabledFor:{test:!0,preprod:!1,preview:!1,prod:!1,gov:!1,high:!1,dod:!1,mooncake:!1,ex:!1,rx:!1}}}})},12030:function(e,t,n){"use strict";n.r(t),n.d(t,"createApp",(function(){return S})),n.d(t,"createNewSiteMap",(function(){return A})),n.d(t,"createNewSiteMapWithUniqueName",(function(){return j}));var r=n(10312),a=n(10305),o=n(10311),i=n(10314),s=n(10299),c=n(11995),l=n(12031),u=n(10290),d=n(4163),p=n(12006),f=n(12032),m=n(12034),b=n(12003),v=n(11990),g=n(217);function y(e,t,n,r,a,o,i){try{var s=e[o](i),c=s.value}catch(l){return void n(l)}s.done?t(c):Promise.resolve(c).then(r,a)}function h(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){y(o,r,a,i,s,"next",e)}function s(e){y(o,r,a,i,s,"throw",e)}i(void 0)}))}}function S(e,t,n){return O.apply(this,arguments)}function O(){return(O=h((function*(e,t,n){try{var r,a=null!==(r=Object(f.publisherPrefix)(e.getState()))&&void 0!==r?r:"new",o=yield A(n.appDisplayName,a,t),i=yield C(o,n,a,t);e.dispatch(p.createApp.success()),Object(c.replaceLocation)(d.editRoute.replace(":environmentId",t.routingProps.environmentId).replace(":solutionId",t.routingProps.solutionId).replace(":appModuleId",i)),Object(m.loadEditAppDependencies)(e,{appModuleId:i})}catch(s){e.dispatch(p.createApp.failure(s))}}))).apply(this,arguments)}function A(e,t,n){return P.apply(this,arguments)}function P(){return(P=h((function*(e,t,n){var a=Object(r.makeSchemaSpecificAppName)(t,e);return yield j(a,e,n)}))).apply(this,arguments)}function j(e,t,n){return E.apply(this,arguments)}function E(){return(E=h((function*(e,t,n){var r,c=Object(l.getLanguageCodeFromEnvironment)(n.environmentProps),d=Object(a.makeSiteMap)({name:t,id:e,siteMapXml:{IntroducedVersion:o.defaultSiteMapXmlVersion,Area:[Object(a.makeArea)({Titles:Object(a.makeTitles)(n.t("siteMap.initialArea"),c),Group:[Object(a.makeGroup)({Titles:Object(a.makeTitles)(n.t("siteMap.initialGroup"),c),SubArea:[Object(a.makeSubArea)({Titles:Object(a.makeTitles)(n.t("siteMap.initialSubArea"),c)})]})]})]}}),p=Object(g.trackOtherScenario)(b.default,v.default.SiteMapSerialize);try{r=Object(i.default)(d.siteMapXml,p)}catch(m){throw new s.CodedError({code:s.ErrorCodes.SiteMapCreateSerialization,innerError:m})}var f=Object(g.trackOtherScenario)(b.default,v.default.SiteMapDeserialize);return yield u.saveSiteMap(d,r,n.apolloClient,n.routingProps.solutionId,f)}))).apply(this,arguments)}function C(e,t,n,r){return T.apply(this,arguments)}function T(){return(T=h((function*(e,t,n,a){var o={sitemapId:e.id,appInfo:{title:t.appDisplayName,uniqueName:Object(r.makeSchemaSpecificAppName)(n,t.appDisplayName),description:t.appDescription,mobileOfflineProfileIds:[],appId:""},appEntityInfo:[],businessProcessFlowIds:[],canvasApps:[],dashboardIds:[]};return yield u.saveAppModule(o,a.apolloClient,a.routingProps.solutionId)}))).apply(this,arguments)}},12031:function(e,t,n){"use strict";n.r(t),n.d(t,"useEnvironment",(function(){return o})),n.d(t,"useEnvironmentLanguageCode",(function(){return i})),n.d(t,"getLanguageCodeFromEnvironment",(function(){return s}));var r=n(245),a=n(1105),o=()=>r.useContext(a.EnvironmentContext).currentEnvironment,i=()=>{var e=r.useContext(a.EnvironmentContext);return s(null==e?void 0:e.currentEnvironment)};function s(e){var t,n,r=null==e?void 0:e.properties.linkedEnvironmentMetadata;return null!==(t=null==r||null===(n=r.baseLanguage)||void 0===n?void 0:n.toString())&&void 0!==t?t:"1033"}},12032:function(e,t,n){"use strict";n.r(t),n.d(t,"getAppStateHistory",(function(){return c})),n.d(t,"getAppModule",(function(){return l})),n.d(t,"getSiteMap",(function(){return u})),n.d(t,"getOriginalAppModule",(function(){return d})),n.d(t,"getOriginalSiteMap",(function(){return p})),n.d(t,"entitiesInEnvironment",(function(){return f})),n.d(t,"getSolutionInfo",(function(){return m})),n.d(t,"getMobileOfflineProfiles",(function(){return b})),n.d(t,"getEnableRoleBasedOfflineProfileAccessSetting",(function(){return v})),n.d(t,"getLastSavePoint",(function(){return g})),n.d(t,"getViewsByEntityNameMap",(function(){return y})),n.d(t,"getChartsByEntityNameMap",(function(){return h})),n.d(t,"getFormsByEntityNameMap",(function(){return S})),n.d(t,"documentHasChanges",(function(){return O})),n.d(t,"getAppModuleAsOfLastSavePoint",(function(){return A})),n.d(t,"getAppModuleId",(function(){return P})),n.d(t,"appModuleHasChanges",(function(){return j})),n.d(t,"siteMapHasChanges",(function(){return E})),n.d(t,"getFirstVisibleSubArea",(function(){return C})),n.d(t,"appEntityInfo",(function(){return T})),n.d(t,"appModuleTitle",(function(){return M})),n.d(t,"appModuleUniqueName",(function(){return w})),n.d(t,"appModuleDescription",(function(){return I})),n.d(t,"appModuleMobileOfflineProfileIds",(function(){return N})),n.d(t,"appModuleEntityComponentById",(function(){return D})),n.d(t,"entityExistsInAppModule",(function(){return x})),n.d(t,"canvasPageComponentById",(function(){return L})),n.d(t,"appModuleHasCustomPages",(function(){return U})),n.d(t,"entitiesPartitionedBasedOnPresenceInApp",(function(){return B})),n.d(t,"entitiesNotInAppSorted",(function(){return F})),n.d(t,"entitiesInApp",(function(){return V})),n.d(t,"entitiesInAppSorted",(function(){return q})),n.d(t,"dashboardsInEnvironment",(function(){return W})),n.d(t,"dashboardsNotInAppSorted",(function(){return G})),n.d(t,"dashboardsInApp",(function(){return z})),n.d(t,"dashboardsInAppSorted",(function(){return K})),n.d(t,"systemDashboardsInEnvironmentSorted",(function(){return X})),n.d(t,"systemDashboardsNotInAppSorted",(function(){return Q})),n.d(t,"interactiveDashboardsInEnvironmentSorted",(function(){return _})),n.d(t,"interactiveDashboardsNotInAppSorted",(function(){return Y})),n.d(t,"powerBIDashboardsInEnvironmentSorted",(function(){return Z})),n.d(t,"powerBIDashboardsNotInAppSorted",(function(){return J})),n.d(t,"customPagesInEnvironment",(function(){return $})),n.d(t,"customPagesNotInAppSorted",(function(){return te})),n.d(t,"customPagesInApp",(function(){return ne})),n.d(t,"customPagesInAppSorted",(function(){return re})),n.d(t,"publisherPrefix",(function(){return ae})),n.d(t,"solutionUniqueName",(function(){return oe})),n.d(t,"solutionId",(function(){return ie})),n.d(t,"appHasUnpublishedChanges",(function(){return se}));var r=n(10303),a=n(2831),o=n(5625),i=n(12018),s=n(12033),c=e=>e.document.app,l=e=>e.document.app.present.appModule,u=e=>e.document.app.present.siteMap,d=Object(o.createSelector)(l,c,(e,t)=>{var n,r;return null!==(n=null===(r=t.past.find(e=>e.appModule.loadState===i.LoadStates.Loaded))||void 0===r?void 0:r.appModule)&&void 0!==n?n:e}),p=Object(o.createSelector)(u,c,(e,t)=>{var n,r;return null!==(n=null===(r=t.past.find(e=>e.siteMap.loadState===i.LoadStates.Loaded))||void 0===r?void 0:r.siteMap)&&void 0!==n?n:e}),f=e=>e.document.entities,m=e=>e.document.solutionInfo,b=e=>e.document.mobileOfflineProfiles,v=e=>e.document.enableRoleBasedOfflineProfileAccessSetting,g=e=>e.document.lastSavePoint,y=e=>e.document.viewsByEntityName,h=e=>e.document.chartsByEntityName,S=e=>e.document.formsByEntityName,O=Object(o.createSelector)(c,g,(e,t)=>e.past.length>t),A=Object(o.createSelector)(c,g,(e,t)=>{var n,r;return null!==(n=null===(r=e.past[t])||void 0===r?void 0:r.appModule)&&void 0!==n?n:e.present.appModule}),P=Object(o.createSelector)(l,e=>{var t;return null===(t=e.value)||void 0===t?void 0:t.appInfo.appId}),j=Object(o.createSelector)(d,l,(e,t)=>e.value!==t.value),E=Object(o.createSelector)(p,u,(e,t)=>e.value!==t.value),C=Object(o.createSelector)(u,e=>{var t,n;return null===(t=Object(r.getFirstVisibleSubAreaWithAncestors)(null===(n=e.value)||void 0===n?void 0:n.siteMapXml))||void 0===t?void 0:t.subArea}),T=Object(o.createSelector)(l,e=>{var t,n;return null!==(t=null===(n=e.value)||void 0===n?void 0:n.appEntityInfo)&&void 0!==t?t:[]}),M=Object(o.createSelector)(l,e=>{var t,n;return null!==(t=null===(n=e.value)||void 0===n?void 0:n.appInfo.title)&&void 0!==t?t:void 0}),w=Object(o.createSelector)(l,e=>{var t,n;return null!==(t=null===(n=e.value)||void 0===n?void 0:n.appInfo.uniqueName)&&void 0!==t?t:void 0}),I=Object(o.createSelector)(l,e=>{var t,n;return null!==(t=null===(n=e.value)||void 0===n?void 0:n.appInfo.description)&&void 0!==t?t:void 0}),N=Object(o.createSelector)(l,e=>{var t,n;return null!==(t=null===(n=e.value)||void 0===n?void 0:n.appInfo.mobileOfflineProfileIds)&&void 0!==t?t:[]}),D=Object(o.createSelector)(l,e=>{if(e.loadState!==i.LoadStates.Loaded)return()=>{};var t={};for(var n of e.value.appEntityInfo)t[n.entityId]=n;return e=>t[e]}),x=Object(o.createSelector)(D,e=>t=>!!e(t)),k=Object(o.createSelector)(l,e=>{if(e.loadState!==i.LoadStates.Loaded)return()=>!1;var t={};for(var n of e.value.dashboardIds)t[n]=n;return e=>!!t[e]}),R=Object(o.createSelector)(l,e=>{if(e.loadState!==i.LoadStates.Loaded)return()=>!1;var t={};for(var n of e.value.canvasApps)t[n.id]=n;return e=>!!t[e]}),L=Object(o.createSelector)(l,e=>{if(e.loadState!==i.LoadStates.Loaded)return()=>{};var t={};for(var n of e.value.canvasApps)t[n.id]=n;return e=>t[e]}),U=Object(o.createSelector)(l,e=>e.loadState===i.LoadStates.Loaded&&e.value.canvasApps.length>0),B=Object(o.createSelector)(f,x,s.partitionAppModuleComponents),F=Object(o.createSelector)(B,e=>{var{notInApp:t}=e;return Object(i.mapLoaded)(t,e=>e.slice().sort(s.compareEntityInfoNames))}),V=Object(o.createSelector)(B,e=>{var{inApp:t}=e;return t}),q=Object(o.createSelector)(B,e=>{var{inApp:t}=e;return Object(i.mapLoaded)(t,e=>e.slice().sort(s.compareEntityInfoNames))}),W=e=>e.document.dashboards,H=Object(o.createSelector)(W,k,s.partitionAppModuleComponents),G=Object(o.createSelector)(H,e=>{var{notInApp:t}=e;return Object(i.mapLoaded)(t,e=>e.slice().sort(s.compareDashboardInfoNames))}),z=Object(o.createSelector)(H,e=>{var{inApp:t}=e;return t}),K=Object(o.createSelector)(z,e=>Object(i.mapLoaded)(e,e=>e.slice().sort(s.compareDashboardInfoNames))),X=Object(o.createSelector)(W,e=>Object(i.mapLoaded)(e,e=>e.filter(e=>e.type===a.FormType.Dashboard).sort(s.compareDashboardInfoNames))),Q=Object(o.createSelector)(G,e=>Object(i.mapLoaded)(e,e=>e.filter(e=>e.type===a.FormType.Dashboard))),_=Object(o.createSelector)(W,e=>Object(i.mapLoaded)(e,e=>e.filter(e=>e.type===a.FormType.InteractionCentricDashboard).sort(s.compareDashboardInfoNames))),Y=Object(o.createSelector)(G,e=>Object(i.mapLoaded)(e,e=>e.filter(e=>e.type===a.FormType.InteractionCentricDashboard))),Z=Object(o.createSelector)(W,e=>Object(i.mapLoaded)(e,e=>e.filter(e=>e.type===a.FormType.PowerBIDashboard).sort(s.compareDashboardInfoNames))),J=Object(o.createSelector)(G,e=>Object(i.mapLoaded)(e,e=>e.filter(e=>e.type===a.FormType.PowerBIDashboard))),$=e=>e.document.customPages,ee=Object(o.createSelector)($,R,s.partitionAppModuleComponents),te=Object(o.createSelector)(ee,e=>{var{notInApp:t}=e;return Object(i.mapLoaded)(t,e=>e.slice().sort(s.compareCustomPageInfoNames))}),ne=Object(o.createSelector)(ee,e=>{var{inApp:t}=e;return t}),re=Object(o.createSelector)(ne,e=>Object(i.mapLoaded)(e,e=>e.slice().sort(s.compareCustomPageInfoNames))),ae=Object(o.createSelector)(m,e=>{var t,n;return null===(t=e.value)||void 0===t||null===(n=t.publisher)||void 0===n?void 0:n.customizationPrefix}),oe=Object(o.createSelector)(m,e=>{var t;return null===(t=e.value)||void 0===t?void 0:t.uniqueName}),ie=Object(o.createSelector)(m,e=>{var t;return null===(t=e.value)||void 0===t?void 0:t.id}),se=e=>e.document.appHasUnpublishedChanges},12033:function(e,t,n){"use strict";n.r(t),n.d(t,"getEntityByLogicalName",(function(){return a})),n.d(t,"getDashboardById",(function(){return o})),n.d(t,"getCustomPageByName",(function(){return i})),n.d(t,"partitionAppModuleComponents",(function(){return s})),n.d(t,"filterEntityInfoList",(function(){return c})),n.d(t,"compareEntityInfoNames",(function(){return l})),n.d(t,"compareDashboardInfoNames",(function(){return u})),n.d(t,"compareCustomPageInfoNames",(function(){return d}));var r=n(12018);function a(e,t){return e.find(e=>e.logicalName.toLowerCase()===t.toLowerCase())}function o(e,t){return e.find(e=>e.id.toLowerCase()===t.toLowerCase())}function i(e,t){return e.find(e=>e.name.toLowerCase()===t.toLowerCase())}function s(e,t){if(e.loadState!==r.LoadStates.Loaded)return{inApp:e,notInApp:e};var n=[],a=[];for(var o of e.value)t(o.id)?a.push(o):n.push(o);return{inApp:Object(r.loaded)(a),notInApp:Object(r.loaded)(n)}}function c(e,t){return t?e.filter(e=>{var n;return!t||(null===(n=e.displayName)||void 0===n?void 0:n.toLowerCase().includes(t.toLowerCase()))||e.logicalName.toLowerCase().includes(t.toLowerCase())}):e}function l(e,t){return e.displayName&&t.displayName?e.displayName.localeCompare(t.displayName):e.logicalName.localeCompare(t.logicalName)}function u(e,t){return e.displayName&&t.displayName?e.displayName.localeCompare(t.displayName):e.id.localeCompare(t.id)}function d(e,t){return e.displayName&&t.displayName?e.displayName.localeCompare(t.displayName):e.name.localeCompare(t.name)}},12034:function(e,t,n){"use strict";n.r(t),n.d(t,"loadEditAppDependencies",(function(){return a}));var r=n(12006);function a(e,t){e.dispatch(r.loadApp.request({appModuleId:t.appModuleId})),e.dispatch(r.loadEntities.request({})),e.dispatch(r.loadDashboards.request({solutionId:""})),e.dispatch(r.loadCustomPages.request({})),e.dispatch(r.loadSolutionInfo.request())}},12035:function(e,t,n){"use strict";n.r(t),n.d(t,"loadApp",(function(){return y}));var r=n(10293),a=n(10299),o=n(10304),i=n(12036),s=n(12037),c=n(12038),l=n(217),u=n(12013),d=n(12003),p=n(11989),f=n(11990),m=n(12006),b=n(12030);function v(e,t,n,r,a,o,i){try{var s=e[o](i),c=s.value}catch(l){return void n(l)}s.done?t(c):Promise.resolve(c).then(r,a)}function g(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){v(o,r,a,i,s,"next",e)}function s(e){v(o,r,a,i,s,"throw",e)}i(void 0)}))}}function y(e,t,n){return h.apply(this,arguments)}function h(){return(h=g((function*(e,t,n){try{var r=yield S(t,n),a=yield A(e,t,r);r.sitemapId||(Object(l.trackCustomEvent)(d.default,{eventName:p.default.ManuallyReassociatedSiteMap,eventData:{associatedSiteMapId:a.id}}),Object(o.writeable)(r).sitemapId=a.id),e.dispatch(m.retrieveAppUnpublished.request({appModuleId:n,siteMapComponentState:a.componentState})),e.dispatch(m.loadApp.success({appModule:r,siteMap:a})),e.dispatch(u.ActionCreators.clearHistory())}catch(s){var i=s;e.dispatch(m.loadApp.failure(i))}}))).apply(this,arguments)}function S(e,t){return O.apply(this,arguments)}function O(){return(O=g((function*(e,t){var n=e.apolloClient,r=Object(l.trackLoadScenario)(d.default,f.default.AppModuleLoad);try{var o,s=(yield n.query({query:i.AppContextQuery,variables:{id:t},fetchPolicy:"network-only"})).data.appContext;return r.complete({appModuleId:null==s||null===(o=s.appInfo)||void 0===o?void 0:o.appId}),s}catch(u){var c=u;throw r.failure(c),new a.CodedError({code:a.ErrorCodes.AppModuleLoad,innerError:c})}}))).apply(this,arguments)}function A(e,t,n){return P.apply(this,arguments)}function P(){return(P=g((function*(e,t,n){var o=n.sitemapId,i=n.appInfo.uniqueName,s=t.apolloClient,c=Object(l.trackLoadScenario)(d.default,f.default.SiteMapLoad);try{var u,p,m,v,g;if(o)g=yield j(s,o);else if(!(g=yield C(s,i))){var y=yield Object(b.createNewSiteMapWithUniqueName)(n.appInfo.uniqueName,n.appInfo.title,t);g=yield j(s,y.id)}var h=Object(l.trackOtherScenario)(d.default,f.default.SiteMapDeserialize),S=Object(r.deserializeSiteMapXml)(g.siteMapXml,[],h),O={id:g.id,name:g.name,siteMapXml:S,componentState:"number"==typeof g.componentState?g.componentState:void 0,showHome:null!==(u=g.showHome)&&void 0!==u?u:void 0,showRecents:null!==(p=g.showRecents)&&void 0!==p?p:void 0,showPinned:null!==(m=g.showPinned)&&void 0!==m?m:void 0,enableCollapsibleGroups:null!==(v=g.enableCollapsibleGroups)&&void 0!==v?v:void 0};return c.complete({siteMapId:null==O?void 0:O.id}),O}catch(P){var A=P;throw c.failure(A),new a.CodedError({code:a.ErrorCodes.SiteMapLoad,innerError:A})}}))).apply(this,arguments)}function j(e,t){return E.apply(this,arguments)}function E(){return(E=g((function*(e,t){var n=(yield e.query({query:s.SiteMapQuery,variables:{id:t},fetchPolicy:"network-only"})).data.siteMap;if(!n)throw new Error("Could not find associated sitemap by id even though an id was provided");return n}))).apply(this,arguments)}function C(e,t){return T.apply(this,arguments)}function T(){return(T=g((function*(e,t){return(yield e.query({query:c.SiteMapByUniqueNameQuery,variables:{uniqueName:t},fetchPolicy:"network-only"})).data.siteMapByUniqueName}))).apply(this,arguments)}},12037:function(e,t,n){"use strict";n.r(t),n.d(t,"SiteMapQuery",(function(){return s}));var r,a=n(3128);var o,i,s=n.n(a)()(r||(o=["\n  query siteMap($id: String!) {\n    siteMap(id: $id) {\n      id\n      name\n      siteMapXml\n      componentState\n      showHome\n      showRecents\n      showPinned\n      enableCollapsibleGroups\n    }\n  }\n"],i||(i=o.slice(0)),r=Object.freeze(Object.defineProperties(o,{raw:{value:Object.freeze(i)}}))))},12038:function(e,t,n){"use strict";n.r(t),n.d(t,"SiteMapByUniqueNameQuery",(function(){return s}));var r,a=n(3128);var o,i,s=n.n(a)()(r||(o=["\n  query siteMapByUniqueName($uniqueName: String!) {\n    siteMapByUniqueName(uniqueName: $uniqueName) {\n      id\n      name\n      siteMapXml\n      componentState\n      showHome\n      showRecents\n      showPinned\n      enableCollapsibleGroups\n    }\n  }\n"],i||(i=o.slice(0)),r=Object.freeze(Object.defineProperties(o,{raw:{value:Object.freeze(i)}}))))},12039:function(e,t,n){"use strict";n.r(t),n.d(t,"loadBusinessProcessFlows",(function(){return c}));var r=n(10299),a=n(12040),o=n(12006);function i(e,t,n,r,a,o,i){try{var s=e[o](i),c=s.value}catch(l){return void n(l)}s.done?t(c):Promise.resolve(c).then(r,a)}function s(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function s(e){i(o,r,a,s,c,"next",e)}function c(e){i(o,r,a,s,c,"throw",e)}s(void 0)}))}}function c(e,t,n){return l.apply(this,arguments)}function l(){return(l=s((function*(e,t,n){var i=t.apolloClient;try{var s=yield i.query({query:a.BusinessProcessFlowsBySolutionIdQuery,variables:{solutionId:n.solutionId},fetchPolicy:n.bypassCache?"no-cache":void 0});e.dispatch(o.loadBusinessProcessFlows.success(s.data.getBusinessProcessFlowsBySolutionId))}catch(c){e.dispatch(o.loadBusinessProcessFlows.failure(new r.CodedError({code:r.ErrorCodes.BusinessProcessFlowsLoad,innerError:c})))}}))).apply(this,arguments)}},12040:function(e,t,n){"use strict";n.r(t),n.d(t,"BusinessProcessFlowsBySolutionIdQuery",(function(){return s}));var r,a=n(3128);var o,i,s=n.n(a)()(r||(o=["\n  query businessProcessFlowsBySolutionId($solutionId: String) {\n    getBusinessProcessFlowsBySolutionId(solutionId: $solutionId) {\n      id: workflowId\n      name\n      primaryEntity\n    }\n  }\n"],i||(i=o.slice(0)),r=Object.freeze(Object.defineProperties(o,{raw:{value:Object.freeze(i)}}))))},12041:function(e,t,n){"use strict";n.r(t),n.d(t,"loadChartsByEntityName",(function(){return c}));var r=n(10299),a=n(12042),o=n(12006);function i(e,t,n,r,a,o,i){try{var s=e[o](i),c=s.value}catch(l){return void n(l)}s.done?t(c):Promise.resolve(c).then(r,a)}function s(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function s(e){i(o,r,a,s,c,"next",e)}function c(e){i(o,r,a,s,c,"throw",e)}s(void 0)}))}}function c(e,t,n){return l.apply(this,arguments)}function l(){return(l=s((function*(e,t,n){var i=t.apolloClient;try{var s=(yield i.query({query:a.ChartsByEntityTypeNameQuery,variables:{entityTypeName:n.entityName}})).data.chartsByEntityType;e.dispatch(o.loadChartsByEntityName.success({entityName:n.entityName,charts:s}))}catch(c){e.dispatch(o.loadChartsByEntityName.failure({entityName:n.entityName,error:new r.CodedError({code:r.ErrorCodes.ChartsLoad,innerError:c})}))}}))).apply(this,arguments)}},12042:function(e,t,n){"use strict";n.r(t),n.d(t,"ChartsByEntityTypeNameQuery",(function(){return s}));var r,a=n(3128);var o,i,s=n.n(a)()(r||(o=["\n  query chartsByEntityType($entityTypeName: String!) {\n    chartsByEntityType(entityTypeName: $entityTypeName) {\n      name\n      description\n      id\n    }\n  }\n"],i||(i=o.slice(0)),r=Object.freeze(Object.defineProperties(o,{raw:{value:Object.freeze(i)}}))))},12043:function(e,t,n){"use strict";n.r(t),n.d(t,"loadDashboards",(function(){return l}));var r=n(10299),a=n(12044),o=n(12006),i=n(2831);function s(e,t,n,r,a,o,i){try{var s=e[o](i),c=s.value}catch(l){return void n(l)}s.done?t(c):Promise.resolve(c).then(r,a)}function c(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){s(o,r,a,i,c,"next",e)}function c(e){s(o,r,a,i,c,"throw",e)}i(void 0)}))}}function l(e,t,n){return u.apply(this,arguments)}function u(){return(u=c((function*(e,t,n){try{var s=(yield t.apolloClient.query({query:a.SolutionFormComponentSummariesQuery,variables:{formSubTypes:[i.FormType.Dashboard,i.FormType.InteractionCentricDashboard,i.FormType.PowerBIDashboard],solutionId:n.solutionId}})).data.solutionFormComponentSummaries.map(e=>({id:e.objectId,displayName:e.displayName,type:e.subType}));e.dispatch(o.loadDashboards.success(s))}catch(c){e.dispatch(o.loadDashboards.failure(new r.CodedError({code:r.ErrorCodes.DashboardsLoad,innerError:c})))}}))).apply(this,arguments)}},12044:function(e,t,n){"use strict";n.r(t),n.d(t,"SolutionFormComponentSummariesQuery",(function(){return s}));var r,a=n(3128);var o,i,s=n.n(a)()(r||(o=["\n  query solutionFormComponentSummaries($formSubTypes: [Int!]!, $solutionId: String) {\n    solutionFormComponentSummaries(formSubTypes: $formSubTypes, solutionId: $solutionId) {\n      name\n      displayName\n      objectId\n      componentType\n      subType\n    }\n  }\n"],i||(i=o.slice(0)),r=Object.freeze(Object.defineProperties(o,{raw:{value:Object.freeze(i)}}))))},12045:function(e,t,n){"use strict";n.r(t),n.d(t,"loadFormsByEntityName",(function(){return c}));var r=n(12046),a=n(10299),o=n(12006);function i(e,t,n,r,a,o,i){try{var s=e[o](i),c=s.value}catch(l){return void n(l)}s.done?t(c):Promise.resolve(c).then(r,a)}function s(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function s(e){i(o,r,a,s,c,"next",e)}function c(e){i(o,r,a,s,c,"throw",e)}s(void 0)}))}}function c(e,t,n){return l.apply(this,arguments)}function l(){return(l=s((function*(e,t,n){var i=t.apolloClient;try{var s=(yield i.query({query:r.FormsByEntityTypeNameQuery,variables:{entityTypeName:n.entityName}})).data.formsByEntityType;e.dispatch(o.loadFormsByEntityName.success({entityName:n.entityName,forms:s}))}catch(c){e.dispatch(o.loadFormsByEntityName.failure({entityName:n.entityName,error:new a.CodedError({code:a.ErrorCodes.FormsLoad,innerError:c})}))}}))).apply(this,arguments)}},12046:function(e,t,n){"use strict";n.r(t),n.d(t,"FormsByEntityTypeNameQuery",(function(){return s}));var r,a=n(3128);var o,i,s=n.n(a)()(r||(o=["\n  query formsByEntityTypeName($entityTypeName: String!, $formType: Float) {\n    formsByEntityType(entityTypeName: $entityTypeName, formType: $formType) {\n      id\n      name\n      formType\n      formXml\n    }\n  }\n"],i||(i=o.slice(0)),r=Object.freeze(Object.defineProperties(o,{raw:{value:Object.freeze(i)}}))))},12047:function(e,t,n){"use strict";n.r(t),n.d(t,"loadEnableRoleBasedOfflineProfileAccessSetting",(function(){return u})),n.d(t,"dispatchLoadEnableRoleBasedOfflineProfileAccessSettingAfterLoadApp",(function(){return p}));var r=n(5894),a=n(10299),o=n(12006),i=n(6632),s=n(12029);function c(e,t,n,r,a,o,i){try{var s=e[o](i),c=s.value}catch(l){return void n(l)}s.done?t(c):Promise.resolve(c).then(r,a)}function l(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){c(o,r,a,i,s,"next",e)}function s(e){c(o,r,a,i,s,"throw",e)}i(void 0)}))}}function u(e,t,n){return d.apply(this,arguments)}function d(){return(d=l((function*(e,t,n){try{var s,c=t.apolloClient,l=(yield c.query({query:r.fetchPowerSettingsQuery,variables:{appUniqueName:n.appModuleUniqueName,retrievePlatform:1},fetchPolicy:"no-cache"})).data.fetchPowerSettings.find(e=>"EnableRoleBasedOfflineProfileAccess"===e.name),u=null==l||null===(s=l.appOverrides.find(e=>e.appUniqueName===n.appModuleUniqueName))||void 0===s?void 0:s.value,d=void 0===l?"false":Object(i.getSettingValue)(l,u);e.dispatch(o.loadEnableRoleBasedOfflineProfileAccessSetting.success("true"===d.toLowerCase()))}catch(p){e.dispatch(o.loadEnableRoleBasedOfflineProfileAccessSetting.failure(new a.CodedError({code:a.ErrorCodes.LoadEnableRoleBasedOfflineProfileAccessSetting,innerError:p})))}}))).apply(this,arguments)}function p(e,t){s.featureGates.isMobileOfflineConfigurationEnabled&&e.dispatch(o.loadEnableRoleBasedOfflineProfileAccessSetting.request({appModuleUniqueName:t.appModule.appInfo.uniqueName}))}},12048:function(e,t,n){"use strict";n.r(t),n.d(t,"loadSolutionInfo",(function(){return c}));var r=n(10579),a=n(10299),o=n(12006);function i(e,t,n,r,a,o,i){try{var s=e[o](i),c=s.value}catch(l){return void n(l)}s.done?t(c):Promise.resolve(c).then(r,a)}function s(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function s(e){i(o,r,a,s,c,"next",e)}function c(e){i(o,r,a,s,c,"throw",e)}s(void 0)}))}}function c(e,t){return l.apply(this,arguments)}function l(){return(l=s((function*(e,t){try{var n=t.apolloClient,i=(yield n.query({query:r.SolutionByIdQuery,variables:{id:t.routingProps.solutionId}})).data.solution;if(!i)throw new a.CodedError({code:a.ErrorCodes.SolutionLoadMissingInfo,message:"No solution information was found for the solution id '".concat(t.routingProps.solutionId,"'")});e.dispatch(o.loadSolutionInfo.success(i))}catch(s){e.dispatch(o.loadSolutionInfo.failure(Object(a.wrapCoded)(s,{code:a.ErrorCodes.SolutionLoad})))}}))).apply(this,arguments)}},12049:function(e,t,n){"use strict";n.r(t),n.d(t,"loadViewsByEntityName",(function(){return c}));var r=n(12050),a=n(10299),o=n(12006);function i(e,t,n,r,a,o,i){try{var s=e[o](i),c=s.value}catch(l){return void n(l)}s.done?t(c):Promise.resolve(c).then(r,a)}function s(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function s(e){i(o,r,a,s,c,"next",e)}function c(e){i(o,r,a,s,c,"throw",e)}s(void 0)}))}}function c(e,t,n){return l.apply(this,arguments)}function l(){return(l=s((function*(e,t,n){var i=t.apolloClient;try{var s=(yield i.query({query:r.ViewsByEntityTypeNameQuery,variables:{entityTypeName:n.entityName}})).data.viewsByEntityType;e.dispatch(o.loadViewsByEntityName.success({entityName:n.entityName,views:s}))}catch(c){e.dispatch(o.loadViewsByEntityName.failure({entityName:n.entityName,error:new a.CodedError({code:a.ErrorCodes.ViewsLoad,innerError:c})}))}}))).apply(this,arguments)}},12050:function(e,t,n){"use strict";n.r(t),n.d(t,"ViewsByEntityTypeNameQuery",(function(){return s}));var r,a=n(3128);var o,i,s=n.n(a)()(r||(o=["\n  query viewsByEntityType($entityTypeName: String!) {\n    viewsByEntityType(entityTypeName: $entityTypeName) {\n      name\n      description\n      fetchXml\n      layoutXml\n      id\n      isDefault\n      queryType\n    }\n  }\n"],i||(i=o.slice(0)),r=Object.freeze(Object.defineProperties(o,{raw:{value:Object.freeze(i)}}))))},12051:function(e,t,n){"use strict";n.r(t),n.d(t,"loadMobileOfflineProfiles",(function(){return u})),n.d(t,"publishMobileOfflineProfile",(function(){return p})),n.d(t,"publishMobileOfflineProfileInternal",(function(){return m})),n.d(t,"publishMobileOfflineProfileOnAppSave",(function(){return v}));var r=n(12052),a=n(12053),o=n(10299),i=n(12006),s=n(12032);function c(e,t,n,r,a,o,i){try{var s=e[o](i),c=s.value}catch(l){return void n(l)}s.done?t(c):Promise.resolve(c).then(r,a)}function l(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){c(o,r,a,i,s,"next",e)}function s(e){c(o,r,a,i,s,"throw",e)}i(void 0)}))}}function u(e,t,n){return d.apply(this,arguments)}function d(){return(d=l((function*(e,t,n){var a=t.apolloClient;try{var s=(yield a.query({query:r.MobileOfflineProfilesQuery,fetchPolicy:n.bypassCache?"no-cache":void 0})).data.mobileOfflineProfiles;e.dispatch(i.loadMobileOfflineProfiles.success(s))}catch(c){e.dispatch(i.loadMobileOfflineProfiles.failure(new o.CodedError({code:o.ErrorCodes.MobileOfflineProfilesLoad,innerError:c})))}}))).apply(this,arguments)}function p(e,t,n){return f.apply(this,arguments)}function f(){return(f=l((function*(e,t,n){try{m(t,n),e.dispatch(i.publishMobileOfflineProfile.success())}catch(r){e.dispatch(i.publishMobileOfflineProfile.failure(new o.CodedError({code:o.ErrorCodes.MobileOfflineProfilePublish,innerError:r})))}}))).apply(this,arguments)}function m(e,t){return b.apply(this,arguments)}function b(){return(b=l((function*(e,t){var n=e.apolloClient;yield n.mutate({mutation:a.PublishMobileOfflineProfileMutation,variables:{id:t.mobileOfflineProfileId}})}))).apply(this,arguments)}function v(e,t){return g.apply(this,arguments)}function g(){return(g=l((function*(e,t){var n,r,a,o=e.getState(),i=null!==(n=null===(r=s.getAppModule(o).value)||void 0===r||null===(a=r.appInfo)||void 0===a?void 0:a.mobileOfflineProfileIds)&&void 0!==n?n:[];if(1===i.length){var c=i[0];yield m(t,{mobileOfflineProfileId:c})}}))).apply(this,arguments)}},12052:function(e,t,n){"use strict";n.r(t),n.d(t,"MobileOfflineProfilesQuery",(function(){return s}));var r,a=n(3128);var o,i,s=n.n(a)()(r||(o=["\n  query MobileOfflineProfiles($solutionId: String) {\n    mobileOfflineProfiles(solutionId: $solutionId) {\n      id\n      solutionId\n      name\n      isValidated\n    }\n  }\n"],i||(i=o.slice(0)),r=Object.freeze(Object.defineProperties(o,{raw:{value:Object.freeze(i)}}))))},12053:function(e,t,n){"use strict";n.r(t),n.d(t,"PublishMobileOfflineProfileMutation",(function(){return s}));var r,a=n(3128);var o,i,s=n.n(a)()(r||(o=["\n  mutation publishMobileOfflineProfile($id: String!) {\n    publishMobileOfflineProfile(id: $id)\n  }\n"],i||(i=o.slice(0)),r=Object.freeze(Object.defineProperties(o,{raw:{value:Object.freeze(i)}}))))},12054:function(e,t,n){"use strict";n.r(t),n.d(t,"retrieveAppUnpublished",(function(){return d}));var r=n(12055),a=n(217),o=n(10299),i=n(12003),s=n(11990),c=n(12006);function l(e,t,n,r,a,o,i){try{var s=e[o](i),c=s.value}catch(l){return void n(l)}s.done?t(c):Promise.resolve(c).then(r,a)}function u(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){l(o,r,a,i,s,"next",e)}function s(e){l(o,r,a,i,s,"throw",e)}i(void 0)}))}}function d(e,t,n,r){return p.apply(this,arguments)}function p(){return(p=u((function*(e,t,n,r){var l=t.apolloClient,u=!0,d=0!==r;try{u=yield f(l,n)}catch(p){Object(a.trackErrorTrace)(i.default,{eventName:s.default.RetrieveAppUnpublished},new o.CodedError({code:o.ErrorCodes.AppModuleRetrieveUnpublished,innerError:p}))}e.dispatch(c.retrieveAppUnpublished.success(u||d))}))).apply(this,arguments)}function f(e,t){return m.apply(this,arguments)}function m(){return(m=u((function*(e,t){var n=(yield e.query({query:r.AppModuleUnpublishedDetailsQuery,variables:{id:t}})).data.appModuleUnpublishedDetails;if(!n||n.length<1)throw new Error("Response returned no app modules.");var a=n.find(e=>e.appModuleId===t);if(!a)throw new Error("Matching app module not found.");return 0!==a.componentState}))).apply(this,arguments)}},12055:function(e,t,n){"use strict";n.r(t),n.d(t,"AppModuleUnpublishedDetailsQuery",(function(){return s}));var r,a=n(3128);var o,i,s=n.n(a)()(r||(o=["\n  query appModuleUnpublishedDetails($id: String!) {\n    appModuleUnpublishedDetails(appModuleId: $id) {\n      appModuleId\n      appModuleIdUnique\n      name\n      componentState\n    }\n  }\n"],i||(i=o.slice(0)),r=Object.freeze(Object.defineProperties(o,{raw:{value:Object.freeze(i)}}))))},12056:function(e,t,n){"use strict";n.r(t),n.d(t,"initialState",(function(){return d}));var r=n(10552),a=n(11986),o=n(12018),i=n(12006),s=n(12007);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var d={entities:Object(o.notStarted)(),dashboards:Object(o.notStarted)(),businessProcessFlows:Object(o.notStarted)(),customPages:Object(o.notStarted)(),solutionInfo:Object(o.notStarted)(),mobileOfflineProfiles:Object(o.notStarted)(),enableRoleBasedOfflineProfileAccessSetting:Object(o.notStarted)(),viewsByEntityName:{},chartsByEntityName:{},formsByEntityName:{},lastSavePoint:0,appHasUnpublishedChanges:!0,app:s.reducer(void 0,{type:""})},p=Object(a.createReducer)(d).handleAction(i.loadEntities.request,e=>l(l({},e),{},{entities:Object(o.loading)()})).handleAction(i.loadEntities.success,(e,t)=>l(l({},e),{},{entities:Object(o.loaded)(t.payload)})).handleAction(i.loadEntities.failure,(e,t)=>l(l({},e),{},{entities:Object(o.loadFailed)(t.payload)})).handleAction(i.loadDashboards.request,e=>l(l({},e),{},{dashboards:Object(o.loading)()})).handleAction(i.loadDashboards.success,(e,t)=>l(l({},e),{},{dashboards:Object(o.loaded)(t.payload)})).handleAction(i.loadDashboards.failure,(e,t)=>l(l({},e),{},{dashboards:Object(o.loadFailed)(t.payload)})).handleAction(i.loadBusinessProcessFlows.request,e=>l(l({},e),{},{businessProcessFlows:Object(o.loading)()})).handleAction(i.loadBusinessProcessFlows.success,(e,t)=>l(l({},e),{},{businessProcessFlows:Object(o.loaded)(t.payload)})).handleAction(i.loadBusinessProcessFlows.failure,(e,t)=>l(l({},e),{},{businessProcessFlows:Object(o.loadFailed)(t.payload)})).handleAction(i.loadViewsByEntityName.request,(e,t)=>Object(r.produce)(e=>{e.viewsByEntityName[t.payload.entityName]=Object(o.loading)()})(e)).handleAction(i.loadViewsByEntityName.success,(e,t)=>Object(r.produce)(e=>{e.viewsByEntityName[t.payload.entityName]=Object(o.loaded)(t.payload.views)})(e)).handleAction(i.loadViewsByEntityName.failure,(e,t)=>Object(r.produce)(e=>{e.viewsByEntityName[t.payload.entityName]=Object(o.loadFailed)(t.payload.error)})(e)).handleAction(i.loadChartsByEntityName.request,(e,t)=>Object(r.produce)(e=>{e.chartsByEntityName[t.payload.entityName]=Object(o.loading)()})(e)).handleAction(i.loadChartsByEntityName.success,(e,t)=>Object(r.produce)(e=>{e.chartsByEntityName[t.payload.entityName]=Object(o.loaded)(t.payload.charts)})(e)).handleAction(i.loadChartsByEntityName.failure,(e,t)=>Object(r.produce)(e=>{e.chartsByEntityName[t.payload.entityName]=Object(o.loadFailed)(t.payload.error)})(e)).handleAction(i.loadFormsByEntityName.request,(e,t)=>Object(r.produce)(e=>{e.formsByEntityName[t.payload.entityName]=Object(o.loading)()})(e)).handleAction(i.loadFormsByEntityName.success,(e,t)=>Object(r.produce)(e=>{e.formsByEntityName[t.payload.entityName]=Object(o.loaded)(t.payload.forms)})(e)).handleAction(i.loadFormsByEntityName.failure,(e,t)=>Object(r.produce)(e=>{e.formsByEntityName[t.payload.entityName]=Object(o.loadFailed)(t.payload.error)})(e)).handleAction(i.loadCustomPages.request,e=>l(l({},e),{},{customPages:Object(o.loading)()})).handleAction(i.loadCustomPages.success,(e,t)=>l(l({},e),{},{customPages:Object(o.loaded)(t.payload)})).handleAction(i.loadCustomPages.failure,(e,t)=>l(l({},e),{},{customPages:Object(o.loadFailed)(t.payload)})).handleAction(i.loadSolutionInfo.request,e=>l(l({},e),{},{solutionInfo:Object(o.loading)()})).handleAction(i.loadSolutionInfo.success,(e,t)=>l(l({},e),{},{solutionInfo:Object(o.loaded)(t.payload)})).handleAction(i.loadSolutionInfo.failure,(e,t)=>l(l({},e),{},{solutionInfo:Object(o.loadFailed)(t.payload)})).handleAction(i.loadMobileOfflineProfiles.request,e=>l(l({},e),{},{mobileOfflineProfiles:Object(o.loading)()})).handleAction(i.loadMobileOfflineProfiles.success,(e,t)=>l(l({},e),{},{mobileOfflineProfiles:Object(o.loaded)(t.payload)})).handleAction(i.loadMobileOfflineProfiles.failure,(e,t)=>l(l({},e),{},{mobileOfflineProfiles:Object(o.loadFailed)(t.payload)})).handleAction(i.loadEnableRoleBasedOfflineProfileAccessSetting.request,e=>l(l({},e),{},{enableRoleBasedOfflineProfileAccessSetting:Object(o.loading)()})).handleAction(i.loadEnableRoleBasedOfflineProfileAccessSetting.success,(e,t)=>l(l({},e),{},{enableRoleBasedOfflineProfileAccessSetting:Object(o.loaded)(t.payload)})).handleAction(i.loadEnableRoleBasedOfflineProfileAccessSetting.failure,(e,t)=>l(l({},e),{},{enableRoleBasedOfflineProfileAccessSetting:Object(o.loadFailed)(t.payload)})).handleAction(i.saveApp.success,e=>l(l({},e),{},{lastSavePoint:e.app.past.length,appHasUnpublishedChanges:!0})).handleAction(i.publishApp.success,e=>l(l({},e),{},{lastSavePoint:e.app.past.length,appHasUnpublishedChanges:!1})).handleAction(i.retrieveAppUnpublished.success,(e,t)=>l(l({},e),{},{appHasUnpublishedChanges:t.payload}));t.default=(e,t)=>{if(!e)return d;var n=p(e,t),r=s.reducer(n.app,t);return l(l(l({},e),n),{},{app:r})}},12057:function(e,t,n){"use strict";n.r(t),n.d(t,"SaveConfirmationDialogType",(function(){return r})),n.d(t,"runPendingUnsavedChanges",(function(){return u})),n.d(t,"expandPageSelectionParentKeys",(function(){return d}));var r,a=n(11986),o=n(12058),i=n(12059),s=n(12005),c=n(11985),l=n(12060);function u(e,t,n){var r=e.getState();Object(a.isActionOf)(n.signalActionCreator,t)&&(s.Selectors.documentHasChanges(r)||s.Selectors.appHasUnpublishedChanges(r)?e.dispatch(c.saveConfirmationDialog.open(n.saveConfirmationDialogType)):n.onRun()),Object(a.isActionOf)(c.saveConfirmationDialog.saveAndContinue,t)&&l.saveConfirmationDialogType(r)===n.saveConfirmationDialogType&&e.dispatch(s.Actions.publishApp.request()),Object(a.isActionOf)(s.Actions.publishApp.success,t)&&l.saveConfirmationDialogType(r)===n.saveConfirmationDialogType&&(e.dispatch(c.saveConfirmationDialog.dismiss()),n.onRun()),Object(a.isActionOf)(s.Actions.publishApp.failure,t)&&l.saveConfirmationDialogType(r)===n.saveConfirmationDialogType&&e.dispatch(c.saveConfirmationDialog.dismiss())}function d(e,t){var n=new Set(t);switch(n.add(e.nodeKey),e.nodeType){case o.PagesPaneNodeType.EntityView:n.add(Object(i.stripEntityViewSuffix)(e.nodeKey));break;case o.PagesPaneNodeType.EntityForm:n.add(Object(i.stripEntityFormSuffix)(e.nodeKey));break;case o.PagesPaneNodeType.Dashboard:n.add(i.dashboardsHeaderKey)}return n}!function(e){e[e.SwitchToClassic=0]="SwitchToClassic",e[e.Preview=1]="Preview",e[e.EditCommandBar=2]="EditCommandBar"}(r||(r={}))},12058:function(e,t,n){"use strict";function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var i,s,c;function l(e){return a({target:i.Pages},e)}function u(e){return(null==e?void 0:e.target)===i.Pages}function d(e){return a({target:i.SiteMap},e)}function p(e){return(null==e?void 0:e.target)===i.SiteMap}n.r(t),n.d(t,"NodeSelectionTarget",(function(){return i})),n.d(t,"PagesPaneNodeType",(function(){return s})),n.d(t,"pagesPaneSelection",(function(){return l})),n.d(t,"isPagesPaneSelection",(function(){return u})),n.d(t,"SiteMapPaneNodeType",(function(){return c})),n.d(t,"siteMapPaneSelection",(function(){return d})),n.d(t,"isSiteMapPaneSelection",(function(){return p})),function(e){e[e.Pages=0]="Pages",e[e.SiteMap=1]="SiteMap"}(i||(i={})),function(e){e[e.App=0]="App",e[e.Entity=1]="Entity",e[e.EntityView=2]="EntityView",e[e.EntityForm=3]="EntityForm",e[e.DashboardHeader=4]="DashboardHeader",e[e.Dashboard=5]="Dashboard",e[e.CustomPage=6]="CustomPage"}(s||(s={})),function(e){e[e.SiteMapNode=0]="SiteMapNode",e[e.Navigation=1]="Navigation"}(c||(c={}))},12059:function(e,t,n){"use strict";n.r(t),n.d(t,"appNodeKey",(function(){return r})),n.d(t,"dashboardsHeaderKey",(function(){return a})),n.d(t,"entityFormSuffix",(function(){return o})),n.d(t,"entityViewSuffix",(function(){return i})),n.d(t,"makeEntityFormKey",(function(){return s})),n.d(t,"makeEntityViewKey",(function(){return c})),n.d(t,"stripEntityFormSuffix",(function(){return u})),n.d(t,"stripEntityViewSuffix",(function(){return p}));var r="appNode",a="dashboards",o="-form",i="-view";function s(e){return"".concat(e).concat(o)}function c(e){return"".concat(e).concat(i)}var l=new RegExp("".concat(o,"$"));function u(e){return e.replace(l,"")}var d=new RegExp("".concat(i,"$"));function p(e){return e.replace(d,"")}},12060:function(e,t,n){"use strict";n.r(t),n.d(t,"getSelection",(function(){return i})),n.d(t,"dataPaneExpandedItems",(function(){return s})),n.d(t,"isCreateAppUIOpen",(function(){return c})),n.d(t,"isAppCreating",(function(){return l})),n.d(t,"isAppSaving",(function(){return u})),n.d(t,"isAppPublishing",(function(){return d})),n.d(t,"isAppSavingOrPublishing",(function(){return p})),n.d(t,"appJustSuccessfullySaved",(function(){return f})),n.d(t,"appJustSuccessfullyPublished",(function(){return m})),n.d(t,"isSaveEnabled",(function(){return b})),n.d(t,"isPublishEnabled",(function(){return v})),n.d(t,"isPlayEnabled",(function(){return g})),n.d(t,"saveConfirmationDialogType",(function(){return y})),n.d(t,"siteMapNodeToRemove",(function(){return h})),n.d(t,"isAddPageUIOpen",(function(){return S})),n.d(t,"isAddSubAreaUIOpen",(function(){return O})),n.d(t,"isAddBpfUIOpen",(function(){return A})),n.d(t,"selectedEntityLogicalName",(function(){return P})),n.d(t,"enableWebResourceSubAreas",(function(){return j})),n.d(t,"previewActionCount",(function(){return E}));var r=n(5625),a=n(12018),o=n(12005),i=e=>e.ui.selection,s=e=>e.ui.dataPaneExpandedItemKeys,c=e=>e.ui.isCreateAppUIOpen,l=e=>e.ui.isCreating,u=e=>e.ui.isSaving,d=e=>e.ui.isPublishing,p=Object(r.createSelector)(u,d,(e,t)=>e||t),f=e=>e.ui.justSuccessfullySaved,m=e=>e.ui.justSuccessfullyPublished,b=Object(r.createSelector)(o.Selectors.documentHasChanges,u,d,(e,t,n)=>e&&!t&&!n),v=Object(r.createSelector)(o.Selectors.getAppModule,o.Selectors.getSiteMap,u,d,(e,t,n,r)=>e.loadState===a.LoadStates.Loaded&&t.loadState===a.LoadStates.Loaded&&!n&&!r),g=Object(r.createSelector)(o.Selectors.getAppModule,u,d,(e,t,n)=>e.loadState===a.LoadStates.Loaded&&!t&&!n),y=e=>e.ui.saveConfirmationDialogType,h=e=>e.ui.siteMapNodeToRemove,S=e=>e.ui.isAddPageUIOpen,O=e=>e.ui.isAddSubAreaUIOpen,A=e=>e.ui.isAddBpfUIOpen,P=e=>e.ui.selectedEntityLogicalName,j=e=>e.ui.enableWebResourceSubAreas,E=e=>e.ui.previewActionCount},12061:function(e,t,n){"use strict";n.r(t),n.d(t,"adjustEntityPageSelectionAfterRemoval",(function(){return u})),n.d(t,"adjustDashboardPageSelectionAfterRemoval",(function(){return d})),n.d(t,"adjustCustomPageSelectionAfterRemoval",(function(){return p}));var r=n(12058),a=n(12059),o=n(12018),i=n(12005),s=n(12033),c=n(11985),l=n(12060);function u(e,t){var n=Object(l.getSelection)(e.getState());if(Object(r.isPagesPaneSelection)(n)){var u=n.relatedEntity;if(u)if(t.payload.some(e=>e.id===u.id)){var d=f(Object(o.tryUnwrap)(i.Selectors.entitiesInAppSorted(e.getState()),[]),u,s.compareEntityInfoNames);d?e.dispatch(c.selectPagesNode({nodeKey:Object(a.makeEntityViewKey)(d.id),nodeType:r.PagesPaneNodeType.EntityView,relatedEntity:d})):e.dispatch(c.selectPagesNode({nodeKey:a.appNodeKey,nodeType:r.PagesPaneNodeType.App}))}}}function d(e,t){var n=Object(l.getSelection)(e.getState());if(Object(r.isPagesPaneSelection)(n)){var u=n.relatedDashboard;if(u)if(t.payload.some(e=>e===u.id)){var d=f(Object(o.tryUnwrap)(i.Selectors.dashboardsInAppSorted(e.getState()),[]),u,s.compareDashboardInfoNames);return d?e.dispatch(c.selectPagesNode({nodeKey:d.id,nodeType:r.PagesPaneNodeType.Dashboard,relatedDashboard:d})):e.dispatch(c.selectPagesNode({nodeKey:a.appNodeKey,nodeType:r.PagesPaneNodeType.App}))}}}function p(e,t){var n=Object(l.getSelection)(e.getState());if(Object(r.isPagesPaneSelection)(n)){var u=n.relatedCustomPage;if(u)if(t.payload.some(e=>e.id===u.id)){var d=f(Object(o.tryUnwrap)(i.Selectors.customPagesInAppSorted(e.getState()),[]),u,s.compareCustomPageInfoNames);return d?e.dispatch(c.selectPagesNode({nodeKey:d.id,nodeType:r.PagesPaneNodeType.CustomPage,relatedCustomPage:d})):e.dispatch(c.selectPagesNode({nodeKey:a.appNodeKey,nodeType:r.PagesPaneNodeType.App}))}}}function f(e,t,n){if(e.length<=0)return null;for(var r=0,a=1;a<e.length;a++){var o=e[r],i=e[a];if(n(o,t)<=0&&n(t,i)<=0)return i;r++}return e[r]}},12062:function(e,t,n){"use strict";n.r(t),n.d(t,"adjustSiteMapSelectionAfterRemoval",(function(){return l}));var r=n(12058),a=n(12018),o=n(12005),i=n(10302),s=n(11985),c=n(12060);function l(e,t){var n=Object(a.tryUnwrap)(o.Selectors.getSiteMap(e.getState()),void 0),l=function(e,t){if(!Object(r.isSiteMapPaneSelection)(e))return!1;var{selectedNodePath:n}=e;if(!n||!Object(i.areNodePathsEqual)(n,t))return!1;return n}(Object(c.getSelection)(e.getState()),t.payload);if(n&&l){var u=l;if(void 0===Object(i.getSiteMapNodeViaPath)(n,u)){var d=Object(i.getNodePathPredecessor)(l);if(void 0===Object(i.getSiteMapNodeViaPath)(n,d)){var p=Object(i.getNodePathParent)(l);p&&void 0!==Object(i.getSiteMapNodeViaPath)(n,p)?e.dispatch(s.selectSiteMapNode({nodeType:r.SiteMapPaneNodeType.SiteMapNode,selectedNodePath:p})):e.dispatch(s.selectSiteMapNode({nodeType:r.SiteMapPaneNodeType.Navigation}))}else e.dispatch(s.selectSiteMapNode({nodeType:r.SiteMapPaneNodeType.SiteMapNode,selectedNodePath:d}))}else e.dispatch(s.selectSiteMapNode({nodeType:r.SiteMapPaneNodeType.SiteMapNode,selectedNodePath:u}))}}},12063:function(e,t,n){"use strict";n.r(t),n.d(t,"openEditChart",(function(){return o}));var r=n(1086),a=n(11995);function o(e,t,n,o){Object(a.openInNewTab)(Object(r.getChartDesignerUrl)(e,t,o,n),"_blank")}},12064:function(e,t,n){"use strict";n.r(t),n.d(t,"initialState",(function(){return m}));var r=n(11986),a=n(12058),o=n(12005),i=n(11985),s=n(12057),c=["originatedFromPreview"],l=["originatedFromPreview"];function u(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){f(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var m={isCreateAppUIOpen:!1,isCreating:!1,createError:void 0,isSaving:!1,isPublishing:!1,justSuccessfullySaved:!1,justSuccessfullyPublished:!1,saveError:void 0,publishError:void 0,isCreatingCustomPageDialogOpen:!1,pendingAppToken:void 0,canvasPageError:void 0,saveConfirmationDialogType:void 0,siteMapNodeToRemove:void 0,isAddPageUIOpen:!1,isAddSubAreaUIOpen:!1,isAddBpfUIOpen:!1,selection:Object(a.pagesPaneSelection)({nodeKey:"appNode",nodeType:a.PagesPaneNodeType.App}),siteMapPaneExpandedItemKeys:new Set,pagesPaneExpandedItemKeys:new Set,dataPaneExpandedItemKeys:new Set,selectedEntityLogicalName:void 0,enableWebResourceSubAreas:!1,previewActionCount:0},b=Object(r.createReducer)(m).handleAction(o.Actions.saveApp.request,e=>p(p({},e),{},{isSaving:!0,justSuccessfullySaved:!1})).handleAction(o.Actions.saveApp.success,e=>p(p({},e),{},{isSaving:!1,justSuccessfullySaved:!0})).handleAction(o.Actions.saveApp.failure,(e,t)=>p(p({},e),{},{isSaving:!1,saveError:t.payload})).handleAction(o.Actions.publishApp.request,e=>p(p({},e),{},{isPublishing:!0,justSuccessfullyPublished:!1})).handleAction(o.Actions.publishApp.success,e=>p(p({},e),{},{isPublishing:!1,justSuccessfullyPublished:!0})).handleAction(o.Actions.publishApp.failure,(e,t)=>p(p({},e),{},{isPublishing:!1,publishError:t.payload})).handleAction(o.Actions.createApp.request,e=>p(p({},e),{},{isCreating:!0})).handleAction(o.Actions.createApp.success,e=>p(p({},e),{},{isCreateAppUIOpen:!1,isCreating:!1})).handleAction(o.Actions.createApp.failure,e=>p(p({},e),{},{isCreating:!1})).handleAction(i.clearSuccessfulSave,e=>p(p({},e),{},{justSuccessfullySaved:!1})).handleAction(i.clearSuccessfulPublish,e=>p(p({},e),{},{justSuccessfullyPublished:!1})).handleAction(i.openCreateAppUI,e=>p(p({},e),{},{isCreateAppUIOpen:!0})).handleAction(i.createAndAddCustomPage.requestCreate,(e,t)=>p(p({},e),{},{isCreatingCustomPageDialogOpen:!0})).handleAction(i.createAndAddCustomPage.requestAdd,(e,t)=>p(p({},e),{},{isCreatingCustomPageDialogOpen:!1,pendingAppToken:t.payload})).handleAction(i.createAndAddCustomPage.failure,(e,t)=>p(p({},e),{},{isCreatingCustomPageDialogOpen:!1,canvasPageError:t.payload})).handleAction(i.dismissCreatingCustomPageDialog,(e,t)=>p(p({},e),{},{isCreatingCustomPageDialogOpen:!1})).handleAction(i.saveConfirmationDialog.open,(e,t)=>p(p({},e),{},{saveConfirmationDialogType:t.payload})).handleAction(i.saveConfirmationDialog.dismiss,(e,t)=>p(p({},e),{},{saveConfirmationDialogType:void 0})).handleAction(i.removeSiteMapNodeDialog.open,(e,t)=>p(p({},e),{},{siteMapNodeToRemove:t.payload})).handleAction(i.removeSiteMapNodeDialog.dismiss,e=>p(p({},e),{},{siteMapNodeToRemove:void 0})).handleAction(i.openAddPageUI,e=>p(p({},e),{},{isAddPageUIOpen:!0})).handleAction(i.closeAddPageUI,e=>p(p({},e),{},{isAddPageUIOpen:!1})).handleAction(i.openAddSubAreaUI,e=>p(p({},e),{},{isAddSubAreaUIOpen:!0})).handleAction(i.closeAddSubAreaUI,e=>p(p({},e),{},{isAddSubAreaUIOpen:!1})).handleAction(i.openAddBpfUI,e=>p(p({},e),{},{isAddBpfUIOpen:!0})).handleAction(i.closeAddBpfUI,e=>p(p({},e),{},{isAddBpfUIOpen:!1})).handleAction(i.selectPagesNode,(e,t)=>{var n=t.payload,{originatedFromPreview:r}=n,o=u(n,c),i=Object(a.pagesPaneSelection)(o);return p(p({},e),{},{selection:i,pagesPaneExpandedItemKeys:Object(s.expandPageSelectionParentKeys)(i,e.pagesPaneExpandedItemKeys)})}).handleAction(i.editCommandBarFromEntity,(e,t)=>p(p({},e),{},{selectedEntityLogicalName:t.payload})).handleAction(i.selectSiteMapNode,(e,t)=>{var n=t.payload,{originatedFromPreview:r}=n,o=u(n,l);return p(p({},e),{},{selection:Object(a.siteMapPaneSelection)(o)})}).handleAction(i.updateSiteMapPaneExpandedItemKeys,(e,t)=>p(p({},e),{},{siteMapPaneExpandedItemKeys:t.payload})).handleAction(i.updatePagesPaneExpandedItemKeys,(e,t)=>p(p({},e),{},{pagesPaneExpandedItemKeys:t.payload})).handleAction(i.updateDataPaneExpandedItemKeys,(e,t)=>p(p({},e),{},{dataPaneExpandedItemKeys:t.payload})).handleAction(i.updateEnableWebResourceSubAreas,(e,t)=>p(p({},e),{},{enableWebResourceSubAreas:t.payload})).handleAction(i.openAppPreview,e=>p(p({},e),{},{previewActionCount:e.previewActionCount+1}));t.default=b},12065:function(e,t,n){"use strict";n.r(t),n.d(t,"useModalLayoutStyles",(function(){return i})),n.d(t,"callToActionTextStyles",(function(){return c}));var r=n(719),a=n(245),o=n(12066),i=()=>{var e=Object(o.default)();return a.useMemo(()=>s(e),[s,e])},s=e=>Object(r.mergeStyleSets)({root:["ModalLayout"],container:{display:"flex",flexDirection:"column",width:900,height:572},header:{display:"flex",alignItems:"center",height:60,padding:"12px 12px 12px 24px"},body:{flex:"auto",display:"flex",padding:"0 24px 24px 24px",overflowY:"hidden"},left:{flex:1},right:{flex:1,padding:"0 0 0 16px"},footer:{display:"flex",height:60,borderTop:"1px solid ".concat(e.palette.neutralQuaternary)},footerLeft:{flex:"auto",padding:"12px 24px 14px 24px"},footerRight:{flex:"auto",display:"flex",justifyContent:"flex-end",padding:"12px 24px 14px 12px",alignItems:"center",selectors:{"& > button":{marginLeft:8}}}}),c={root:{fontWeight:"600"}}},12066:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return i}));var r=n(245),a=n(545),o=n(12067);function i(){var e=Object(o.default)(),t=r.useRef(!1);r.useEffect(()=>(t.current||a.Customizations.observe(e),()=>{t.current||a.Customizations.unobserve(e)}),[e,t]);var n=r.useContext(a.CustomizerContext);return t.current=!!n.customizations.inCustomizerContext,a.Customizations.getSettings(["theme"],"",n.customizations).theme}},12067:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return a}));var r=n(245);function a(){var[,e]=r.useState();return r.useCallback(()=>e({}),[])}},12068:function(e,t,n){"use strict";n.r(t),n.d(t,"AddPageModalBody",(function(){return u}));var r=n(245),a=n(12069),o=n(12100),i=n(12103),s=n(12111),c=n(12112);function l(){return(l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var u=e=>{var{onClickDismiss:t}=e,[n,u]=r.useState(s.AddPageWizardSteps.SelectPageType.toString());function d(){var e=s.AddPageWizardSteps.SelectPageType.toString();u(e)}return r.createElement(r.Fragment,null,n===s.AddPageWizardSteps.SelectPageType.toString()&&r.createElement(c.PageTypeSelectionStep,l({},e,{onClickDismiss:t,setNextStep:u})),n===s.AddPageWizardSteps.AddEntityPage.toString()&&r.createElement(i.AddEntityPageStep,l({},e,{onClickDismiss:t,onClickBack:d})),n===s.AddPageWizardSteps.AddDashboardPage.toString()&&r.createElement(o.AddDashboardPageStep,l({},e,{onClickDismiss:t,onClickBack:d})),n===s.AddPageWizardSteps.AddCustomPage.toString()&&r.createElement(a.AddCustomPageStep,l({},e,{onClickDismiss:t,onClickBack:d})))}},12069:function(e,t,n){"use strict";n.r(t),n.d(t,"AddCustomPageStep",(function(){return j}));var r,a=n(684),o=n(1368),i=n(1795),s=n(1837),c=n(12070),l=n(923),u=n(245),d=n(10443),p=n(12083),f=n(12005),m=n(11984),b=n(12018),v=n(12084),g=n(12086),y=n(12088),h=n(12065),S=n(12089),O=n(12094),A=n(12099);function P(){return(P=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}!function(e){e.NewPage="new-page",e.ExistingPage="existing-page"}(r||(r={}));var j=u.memo(e=>{var{onClickDismiss:t,onClickBack:n}=e;if(!n)throw new Error("onClickBack should be defined in AddCustomPageStepProps.");var{t:j}=Object(l.useTranslation)("AppModuleDesigner"),[E,C]=u.useState({}),[T,M]=u.useState(r.NewPage),w=j("addCustomPage.defaultNewPageName"),[I,N]=u.useState(w),[D,x]=u.useState(!0),k=[{key:r.NewPage,text:j("addCustomPage.addNewPageOption")},{key:r.ExistingPage,text:j("addCustomPage.addExistingPageOption")}],R=Object(d.useSelector)(f.Selectors.customPagesNotInAppSorted),L=Object.keys(E).filter(e=>!!E[e]).length,U=Object(h.useModalLayoutStyles)(),B=Object(d.useDispatch)(),F={key:"custom-page-name",inputType:"text",label:j("addCustomPage.newPageNameInputTitle"),required:!0,value:w,onChanged:e=>{N(e)}},V={key:"new-custom-page-section",properties:[]};V.properties.push(F);return u.createElement(u.Fragment,null,u.createElement("div",{className:U.header},u.createElement(g.BackModalIconButton,P({},e,{onClick:n})),u.createElement(s.Text,{variant:"xLarge"},j("addCustomPage.header")),u.createElement(y.CloseModalIconButton,P({},e,{onClick:t}))),u.createElement("div",{className:U.body},u.createElement(i.Stack,{className:U.left},u.createElement(O.PageTypeBannerImageWithCaption,P({},e,{pageType:p.PageTypes.Custom}))),u.createElement(i.Stack,{className:U.right,tokens:{childrenGap:12}},u.createElement(s.Text,{variant:"medium",styles:h.callToActionTextStyles},j("addCustomPage.callToAction")),u.createElement(o.ChoiceGroup,{defaultSelectedKey:r.NewPage,options:k,onChange:(e,t)=>{M(null==t?void 0:t.key),(null==t?void 0:t.key)===r.NewPage&&x(!0)},required:!0}),T===r.ExistingPage?R.value?u.createElement(S.CustomPageSelector,{customPageSelections:E,setCustomPageSelections:C,allCustomPages:R.value}):u.createElement(v.BulletedListShimmer,null):u.createElement(c.PropertySheet,{sections:[V],allowInvalidOnChange:!0}),u.createElement(A.ShowInNavigationCheckbox,{disabled:T===r.NewPage,showInNavigation:D,setShowInNavigation:x}))),u.createElement("div",{className:U.footer},u.createElement("div",{className:U.footerRight},u.createElement(a.PrimaryButton,{text:j("buttons.add"),disabled:T===r.ExistingPage&&!L||T===r.NewPage&&(!I||0===I.trim().length),onClick:()=>{if(T===r.NewPage)B(m.Actions.createAndAddCustomPage.requestCreate(I));else{var e=Object(b.tryUnwrap)(R,[]).filter(e=>!!E[e.id]);B(f.App.Actions.addAppModuleCustomPages({customPages:e,addToNavigation:D}))}t()}}),u.createElement(a.DefaultButton,{text:j("buttons.cancel"),onClick:t}))))})},12083:function(e,t,n){"use strict";var r;n.r(t),n.d(t,"PageTypes",(function(){return r})),function(e){e.Entity="Entity",e.Dashboard="Dashboard",e.Custom="Custom"}(r||(r={}))},12084:function(e,t,n){"use strict";n.r(t),n.d(t,"BulletedListShimmer",(function(){return l}));var r=n(1755),a=n(1795),o=n(245),i=n(12066),s=n(12085),c=[{type:r.ShimmerElementType.line}],l=()=>{var e=Object(i.default)(),t={background:e.palette.neutralLighter,shimmer:e.palette.neutralLight,shimmerWave:e.palette.neutralQuaternaryAlt};return o.createElement(a.Stack,{styles:s.shimmerContainerStyles},o.createElement(r.Shimmer,{styles:s.shimmerStyles,shimmerColors:t,shimmerElements:c}),o.createElement(r.Shimmer,{styles:s.shimmerStyles,shimmerColors:t,shimmerElements:c}),o.createElement(r.Shimmer,{styles:s.shimmerStyles,shimmerColors:t,shimmerElements:c}))}},12085:function(e,t,n){"use strict";n.r(t),n.d(t,"shimmerContainerStyles",(function(){return r})),n.d(t,"shimmerStyles",(function(){return a}));var r=(e,t)=>({root:{flex:"1 1 0"}}),a=e=>{var{theme:t}=e;return{root:["BulletedListShimmer",{background:"transparent",padding:"8px 16px 0"}]}}},12086:function(e,t,n){"use strict";n.r(t),n.d(t,"backButtonStyles",(function(){return i})),n.d(t,"BackModalIconButton",(function(){return s}));var r=n(923),a=n(245),o=n(12087),i={root:{marginLeft:"0",marginTop:"4px",marginRight:"4px"}},s=e=>{var{onClick:t}=e,{t:n}=Object(r.useTranslation)("AppModuleDesigner");return a.createElement(o.ModalIconButton,{iconName:"Back",ariaLabelText:n("buttons.back"),styles:i,onClick:t})}},12087:function(e,t,n){"use strict";n.r(t),n.d(t,"ModalIconButton",(function(){return o}));var r=n(684),a=n(245),o=e=>{var{iconName:t,ariaLabelText:n,styles:o,onClick:i}=e;return a.createElement(r.IconButton,{styles:o,iconProps:{iconName:t},ariaLabel:n,onClick:i})}},12088:function(e,t,n){"use strict";n.r(t),n.d(t,"CloseModalIconButton",(function(){return s}));var r=n(923),a=n(245),o=n(12087),i={root:{marginLeft:"auto",marginTop:"4px",marginRight:"2px"}},s=e=>{var{onClick:t}=e,{t:n}=Object(r.useTranslation)("AppModuleDesigner");return a.createElement(o.ModalIconButton,{iconName:"Cancel",ariaLabelText:n("buttons.close"),styles:i,onClick:t})}},12089:function(e,t,n){"use strict";n.r(t),n.d(t,"CustomPageSelector",(function(){return i}));var r=n(923),a=n(245),o=n(12090),i=e=>{var{allCustomPages:t,customPageSelections:n,setCustomPageSelections:i}=e,{t:s}=Object(r.useTranslation)("AppModuleDesigner"),c=a.useMemo(()=>t.map(e=>{var t;return{key:e.id,title:null!==(t=e.displayName)&&void 0!==t?t:""}}).sort((e,t)=>e.title.localeCompare(t.title)),[t,n]);return a.createElement(o.ItemCheckboxList,{items:c,selections:n,onSelectionsChanged:i,maxHeight:284,noItemsMessage:s("addCustomPage.noItemsFound")})}},12090:function(e,t,n){"use strict";n.r(t),n.d(t,"ItemCheckboxList",(function(){return m}));var r=n(3161),a=n(782),o=n(1459),i=n(245),s=n.n(i),c=n(12091),l=n(12092),u=n(12093);function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){f(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var m=e=>{var{items:t,noItemsMessage:n,selections:i,onSelectionsChanged:d}=e,f=Object(u.useItemCheckboxListStyles)(),m=s.a.useMemo(()=>t.map(e=>({item:e,checked:!!i[e.key],disabled:!!e.disabled,onChecked:t=>{d(p(p({},i),{},{[e.key]:t}))}})),[t,i,d]);return s.a.createElement(s.a.Fragment,null,m.length?s.a.createElement(a.FocusZone,null,s.a.createElement(o.List,{className:f.list,style:{maxHeight:e.maxHeight},items:m,getPageSpecification:()=>({itemCount:1e3,height:1e3*(l.itemHeight+l.itemSpacing)}),onRenderCell:e=>s.a.createElement(c.ItemCheckbox,e)})):s.a.createElement(r.EmptyState,{primaryMessage:n,styles:u.emptyStateStyles}))}},12091:function(e,t,n){"use strict";n.r(t),n.d(t,"ItemCheckbox",(function(){return c}));var r=n(245),a=n.n(r),o=n(1362),i=n(12092);function s(){return(s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var c=e=>a.a.createElement(o.Checkbox,s({label:(null==e?void 0:e.item.title)||"",onChange:(t,n)=>{var r;return null==e||null===(r=e.onChecked)||void 0===r?void 0:r.call(e,!!n)},styles:i.checkboxStyles},e))},12092:function(e,t,n){"use strict";n.r(t),n.d(t,"itemHeight",(function(){return r})),n.d(t,"itemSpacing",(function(){return a})),n.d(t,"checkboxStyles",(function(){return o}));var r=20,a=8,o={root:{height:r,width:100,marginBottom:a},text:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}}},12093:function(e,t,n){"use strict";n.r(t),n.d(t,"useItemCheckboxListStyles",(function(){return i})),n.d(t,"emptyStateStyles",(function(){return c}));var r=n(245),a=n(719),o=n(12066),i=()=>{var e=Object(o.default)();return Object(r.useMemo)(()=>s(e),[s,e])},s=e=>Object(a.mergeStyleSets)({list:{overflowX:"hidden",overflowY:"auto",padding:"8px 0 0 8px",margin:"-4px 0 0 0",border:"1px solid ".concat(e.palette.neutralQuaternary),borderRadius:"2px"}}),c={root:["EmptyItemList",{marginBottom:0}],button:{display:"none"},primaryMessage:{fontWeight:"normal",marginBottom:0}}},12094:function(e,t,n){"use strict";n.r(t),n.d(t,"PageTypeBannerImageWithCaption",(function(){return f}));var r=n(923),a=n(245),o=n(12095),i=n.n(o),s=n(12096),c=n.n(s),l=n(12097),u=n.n(l),d=n(12083),p=n(12098),f=e=>{var{pageType:t}=e,n="addPage.".concat(t.toLowerCase(),"PageTypeSelectHelpText"),{t:o}=Object(r.useTranslation)("AppModuleDesigner");return a.createElement(p.BannerImageWithCaption,{caption:o(n),imageUrl:t===d.PageTypes.Entity?u.a:t===d.PageTypes.Dashboard?c.a:t===d.PageTypes.Custom?i.a:""})}},12095:function(e,t){e.exports="data:image/png;base64,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"},12096:function(e,t,n){e.exports=n.p+"static/media/ModalBanner-AddDashboard.15eb6de8.png"},12097:function(e,t,n){e.exports=n.p+"static/media/ModalBanner-AddEntity.f6e28c59.png"},12098:function(e,t,n){"use strict";n.r(t),n.d(t,"BannerImageWithCaption",(function(){return c}));var r=n(245),a=n(1795),o=n(719),i=n(1837),s=n(12066),c=e=>{var{caption:t,imageUrl:n}=e,c=e=>Object(o.mergeStyleSets)({root:["BannerImageWithCaption"],banner:{width:412,height:280,backgroundColor:e.palette.neutralLight}}),l=Object(s.default)(),u=r.useMemo(()=>c(l),[c,l]);return r.createElement(a.Stack,{tokens:{childrenGap:16}},r.createElement("img",{src:n,className:u.banner,title:t}),r.createElement(i.Text,{className:"banner-caption",variant:"medium"},t))}},12099:function(e,t,n){"use strict";n.r(t),n.d(t,"ShowInNavigationCheckbox",(function(){return c}));var r=n(923),a=n(1362),o=n(719),i=n(245),s=Object(o.mergeStyles)({paddingTop:"8px"}),c=e=>{var{showInNavigation:t,setShowInNavigation:n,disabled:o}=e,{t:c}=Object(r.useTranslation)("AppModuleDesigner");return i.createElement(a.Checkbox,{id:"showInNavigationCheckbox",className:s,label:c("addPage.showInNavigation"),checked:!!t,disabled:o,onChange:(e,t)=>n(!!t)})}},12100:function(e,t,n){"use strict";n.r(t),n.d(t,"AddDashboardPageStep",(function(){return O}));var r=n(684),a=n(1795),o=n(1837),i=n(923),s=n(245),c=n(10443),l=n(12083),u=n(12005),d=n(12018),p=n(12084),f=n(12086),m=n(12088),b=n(12065),v=n(12101),g=n(12094),y=n(12099),h=n(12102);function S(){return(S=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var O=s.memo(e=>{var{onClickDismiss:t,onClickBack:n}=e,{t:O}=Object(i.useTranslation)("AppModuleDesigner");if(!n)throw new Error("onClickBack should be defined in AddDashboardPageStepProps.");var A=Object(c.useSelector)(u.Selectors.dashboardsNotInAppSorted),P=Object(c.useSelector)(u.Selectors.systemDashboardsNotInAppSorted),j=Object(c.useSelector)(u.Selectors.interactiveDashboardsNotInAppSorted),E=Object(c.useSelector)(u.Selectors.powerBIDashboardsNotInAppSorted),[C,T]=s.useState({}),M=Object.keys(C).filter(e=>!!C[e]).length,[w,I]=s.useState(!0),N=Object(b.useModalLayoutStyles)(),D=Object(h.useAddDashboardPageStepStyles)(),x=Object(c.useDispatch)();return s.createElement(s.Fragment,null,s.createElement("div",{className:N.header},s.createElement(f.BackModalIconButton,S({},e,{onClick:n})),s.createElement(o.Text,{variant:"xLarge"},O("addDashboardPage.header")),s.createElement(m.CloseModalIconButton,S({},e,{onClick:t}))),s.createElement("div",{className:N.body},s.createElement(a.Stack,{className:N.left},s.createElement(g.PageTypeBannerImageWithCaption,S({},e,{pageType:l.PageTypes.Dashboard}))),s.createElement(a.Stack,{className:N.right,tokens:{childrenGap:12}},P.value&&j.value&&E.value?s.createElement(s.Fragment,null,s.createElement(o.Text,{variant:"medium",styles:b.callToActionTextStyles},O("addDashboardPage.callToAction")),s.createElement("div",{className:D.list},s.createElement(v.DashboardSelector,{systemDashboards:P.value,interactiveDashboards:j.value,powerBIDashboards:E.value,dashboardSelections:C,setDashboardSelections:e=>T(e)})),s.createElement(y.ShowInNavigationCheckbox,{showInNavigation:w,setShowInNavigation:I})):s.createElement(p.BulletedListShimmer,null))),s.createElement("div",{className:N.footer},s.createElement("div",{className:N.footerRight},s.createElement(r.PrimaryButton,{text:O("buttons.add"),disabled:!M,onClick:()=>{var e=Object(d.tryUnwrap)(A,[]).filter(e=>!!C[e.id]);x(u.App.Actions.addAppModuleDashboards({dashboards:e,addToNavigation:w})),t()}}),s.createElement(r.DefaultButton,{text:O("buttons.cancel"),onClick:t}))))})},12101:function(e,t,n){"use strict";n.r(t),n.d(t,"DashboardSelector",(function(){return d}));var r=n(1471),a=n(923),o=n(245),i=n(12029),s=n(12091);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var d=e=>{var{systemDashboards:t,interactiveDashboards:n,powerBIDashboards:c,dashboardSelections:u,setDashboardSelections:d}=e,{t:p}=Object(a.useTranslation)("AppModuleDesigner"),{listItems:f,groups:m}=o.useMemo(()=>{var e=[...t.map(e=>{var t;return{key:e.id,title:null!==(t=e.displayName)&&void 0!==t?t:e.id}}),...n.map(e=>{var t;return{key:e.id,title:null!==(t=e.displayName)&&void 0!==t?t:e.id}}),...c.map(e=>{var t;return{key:e.id,title:null!==(t=e.displayName)&&void 0!==t?t:e.id}})],r=[];return t.length>0&&r.push({key:"SystemDashboards_GroupHeader",name:p("dashboardTypes.systemDashboardsGroupHeader"),startIndex:0,count:t.length,level:0}),i.featureGates.interactiveAndPowerBIDashboardsEnabled&&r.push({key:"InteractiveDashboards_GroupHeader",name:p("dashboardTypes.interactiveDashboardsGroupHeader"),startIndex:t.length,count:n.length,level:0}),i.featureGates.interactiveAndPowerBIDashboardsEnabled&&r.push({key:"PowerBIDashboards_GroupHeader",name:p("dashboardTypes.powerBIDashboardsGroupHeader"),startIndex:t.length+n.length,count:c.length,level:0}),{listItems:e,groups:r}},[t,n,c]);return o.createElement(r.DetailsList,{setKey:"set",items:f,columns:(e=>{var t=Object(r.buildColumns)(e);if(t.length>0){var n=t.find(e=>"title"===e.key);return n?(n.name="Title",[n]):[]}return[]})(f),groups:m,groupProps:{showEmptyGroups:!0},selectionMode:r.SelectionMode.none,selectionPreservedOnEmptyClick:!0,compact:!0,onShouldVirtualize:()=>!1,isHeaderVisible:!1,onRenderRow:e=>{if(!(e&&e.item&&e.item.key&&e.item.title))return null;var t=l({},e.item),n={item:t,checked:!!u[t.key],onChecked:e=>((e,t)=>{var n=l(l({},u),{},{[e.key]:t});d(n)})(t,e)};return o.createElement("div",{style:{paddingLeft:"48px"}},o.createElement(s.ItemCheckbox,n))}})}},12102:function(e,t,n){"use strict";n.r(t),n.d(t,"useAddDashboardPageStepStyles",(function(){return i}));var r=n(719),a=n(245),o=n(12066),i=()=>{var e=Object(o.default)();return a.useMemo(()=>s(e),[s,e])},s=e=>Object(r.mergeStyleSets)({list:{flex:"auto",display:"flex",width:"418px",height:"355px",overflowY:"auto",selectors:{"& > div":{flex:"1 1 auto"}},border:"1px solid ".concat(e.palette.neutralQuaternary),borderRadius:"2px"}})},12103:function(e,t,n){"use strict";n.r(t),n.d(t,"AddEntityPageStep",(function(){return O}));var r=n(684),a=n(1795),o=n(1837),i=n(923),s=n(245),c=n(10443),l=n(12083),u=n(12005),d=n(12018),p=n(12084),f=n(12086),m=n(12088),b=n(12065),v=n(12104),g=n(12094),y=n(12099),h=n(12106);function S(){return(S=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var O=s.memo(e=>{var{onClickDismiss:t,onClickBack:n}=e;if(!n)throw new Error("onClickBack should be defined in AddEntityPageStepProps.");var{t:O}=Object(i.useTranslation)("AppModuleDesigner"),[A,P]=s.useState({}),j=Object(c.useSelector)(u.Selectors.entitiesNotInAppSorted),E=Object.keys(A).filter(e=>!!A[e]).length,[C,T]=s.useState(!0),M=Object(b.useModalLayoutStyles)(),w=Object(c.useDispatch)();return s.createElement(s.Fragment,null,s.createElement("div",{className:M.header},s.createElement(f.BackModalIconButton,S({},e,{onClick:n})),s.createElement(o.Text,{variant:"xLarge"},O("addEntityPage.header")),s.createElement(m.CloseModalIconButton,S({},e,{onClick:t}))),s.createElement("div",{className:M.body},s.createElement(a.Stack,{className:M.left},s.createElement(g.PageTypeBannerImageWithCaption,S({},e,{pageType:l.PageTypes.Entity}))),s.createElement(a.Stack,{className:M.right,tokens:{childrenGap:12}},j.value?s.createElement(s.Fragment,null,s.createElement(o.Text,{variant:"medium",styles:b.callToActionTextStyles},O("addEntityPage.callToAction")),s.createElement(v.EntitySelector,{entitySelections:A,setEntitySelections:P,allEntities:j.value}),s.createElement(y.ShowInNavigationCheckbox,{showInNavigation:C,setShowInNavigation:T,disabled:!!h.enablePowerAppsFirstRunTour})):s.createElement(p.BulletedListShimmer,null))),s.createElement("div",{className:M.footer},s.createElement("div",{className:M.footerRight},s.createElement(r.PrimaryButton,{text:O("buttons.add"),disabled:!E,onClick:()=>{var e=Object(d.tryUnwrap)(j,[]).filter(e=>!!A[e.logicalName]);w(u.App.Actions.addAppModuleEntities({entities:e,addToNavigation:C})),t()}}),s.createElement(r.DefaultButton,{text:O("buttons.cancel"),onClick:t}))))})},12104:function(e,t,n){"use strict";n.r(t),n.d(t,"EntitySelector",(function(){return p}));var r=n(4102),a=n(923),o=n(245),i=n(10443),s=n(12033),c=n(12090),l=n(12105),u=n(12106),d=n(12107),p=e=>{var{allEntities:t,entitySelections:n,setEntitySelections:p}=e,[f,m]=o.useState(void 0),{t:b}=Object(a.useTranslation)("AppModuleDesigner"),v=Object(i.useSelector)(d.Selectors.firstRunTourSampleTableLogicalName),[g,y]=o.useState(!1),h=o.useMemo(()=>Object(s.filterEntityInfoList)(t,f).map(e=>({key:e.logicalName,title:(null==e?void 0:e.displayName)||(null==e?void 0:e.logicalName)||"",disabled:g})),[t,f,n,g]);o.useEffect(()=>{if(u.enablePowerAppsFirstRunTour&&v&&Object(s.filterEntityInfoList)(t,v).length){y(!0);var e={};e[v]=!0,p(e)}},[v,t]);var S=Object(l.useEntitySelectorStyles)();return o.createElement(o.Fragment,null,o.createElement(r.SearchBox,{className:S.searchBox,onChangeDelay:250,ariaLabel:b("addEntityPage.searchAriaLabel"),placeholder:b("common.search"),value:f,onChange:(e,t)=>m(t),onSearch:e=>m(e),disabled:g}),o.createElement(c.ItemCheckboxList,{items:h,selections:n,onSelectionsChanged:p,maxHeight:312,noItemsMessage:b("addEntityPage.noEntitiesFound")}))}},12105:function(e,t,n){"use strict";n.r(t),n.d(t,"useEntitySelectorStyles",(function(){return i}));var r=n(245),a=n(719),o=n(12066),i=()=>{var e=Object(o.default)();return Object(r.useMemo)(()=>s(e),[s,e])},s=e=>Object(a.mergeStyleSets)({searchBox:{marginBottom:"8px",lineHeight:"30px"}})},12106:function(e,t,n){"use strict";n.r(t),n.d(t,"enablePowerAppsFirstRunTour",(function(){return i})),n.d(t,"firstRunTourSteps",(function(){return s}));var r,a=n(1194),o=null===(r=new URLSearchParams(window.location.search))||void 0===r?void 0:r.get("tour"),i=a.featureGates.enablePowerAppsFirstRunTour&&"first-run"===o,s=[{stepName:"nameTheAppStep",targetElement:'[data-cy="createAppModalNameInput"]'},{stepName:"createPageStep",targetElement:'[data-cy="canvasPlaceholderNewPage"]',showInProgressTracker:!0},{stepName:"addTableStep",targetElement:".cds-app-module-designer-addpage-entity"},{stepName:"hookUpDataStep",targetElement:".ms-Modal .ms-List"},{stepName:"sayHelloToYourApp"},{stepName:"testItOutStep",targetElement:"".concat("body:not(.css-0)"," button:not(.is-disabled).cds-app-module-designer-commandbar-publish"),showInProgressTracker:!0},{stepName:"publishedStep"},{stepName:"tryItOutStep",targetElement:"button:not(.is-disabled).cds-app-module-designer-commandbar-play",showInProgressTracker:!0},{stepName:"completeDialog"}]},12107:function(e,t,n){"use strict";n.r(t);var r=n(12108);n.d(t,"Actions",(function(){return r}));var a=n(12109);n.d(t,"initialState",(function(){return a.initialState})),n.d(t,"reducer",(function(){return a.default}));var o=n(12110);n.d(t,"Selectors",(function(){return o}))},12108:function(e,t,n){"use strict";n.r(t),n.d(t,"updateFirstRunTourCurrentStepIndex",(function(){return o})),n.d(t,"updateFirstRunTourCompletedState",(function(){return i})),n.d(t,"updateFirstRunTourSampleTableLogicalName",(function(){return s})),n.d(t,"updateFirstRunTourSampleDataLoading",(function(){return c})),n.d(t,"showCurrentTourStepCallout",(function(){return l}));var r=n(11986),a=n(11987),o=Object(r.createAction)("MISSION/FIRST_RUN_TOUR/UPDATE_PROGRESS",Object(a.payload)())(),i=Object(r.createAction)("MISSION/FIRST_RUN_TOUR/TOUR_COMPLETED",Object(a.payload)())(),s=Object(r.createAction)("MISSION/FIRST_RUN_TOUR/SAMPLE_TABLE_LOGICAL_NAME_UPDATED",Object(a.payload)())(),c=Object(r.createAction)("MISSION/FIRST_RUN_TOUR/SAMPLE_DATA_LOADING",Object(a.payload)())(),l=Object(r.createAction)("MISSION/FIRST_RUN_TOUR/SHOW_CURRENT_STEP",a.noPayload)()},12109:function(e,t,n){"use strict";n.r(t),n.d(t,"initialState",(function(){return c}));var r=n(11986),a=n(12108);function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var c={firstRunTourCurrentStepIndex:0,firstRunTourCompleted:!1,firstRunPowerSampleDataLoading:!1,showCurrentTourStepCalloutCount:0,firstRunTourSampleTableLogicalName:void 0},l=Object(r.createReducer)(c).handleAction(a.updateFirstRunTourCurrentStepIndex,(e,t)=>{var n=t.payload;return i(i({},e),{},{firstRunTourCurrentStepIndex:n})}).handleAction(a.updateFirstRunTourCompletedState,(e,t)=>i(i({},e),{},{firstRunTourCompleted:t.payload})).handleAction(a.updateFirstRunTourSampleDataLoading,(e,t)=>i(i({},e),{},{firstRunPowerSampleDataLoading:t.payload})).handleAction(a.updateFirstRunTourSampleTableLogicalName,(e,t)=>i(i({},e),{},{firstRunTourSampleTableLogicalName:t.payload})).handleAction(a.showCurrentTourStepCallout,e=>i(i({},e),{},{showCurrentTourStepCalloutCount:e.showCurrentTourStepCalloutCount+1}));t.default=l},12110:function(e,t,n){"use strict";n.r(t),n.d(t,"firstRunTourCurrentStepIndex",(function(){return r})),n.d(t,"firstRunTourComplete",(function(){return a})),n.d(t,"firstRunTourSampleDataLoading",(function(){return o})),n.d(t,"showCurrentTourStepCalloutCount",(function(){return i})),n.d(t,"firstRunTourSampleTableLogicalName",(function(){return s}));var r=e=>e.missionUI.firstRunTourCurrentStepIndex,a=e=>e.missionUI.firstRunTourCompleted,o=e=>e.missionUI.firstRunPowerSampleDataLoading,i=e=>e.missionUI.showCurrentTourStepCalloutCount,s=e=>e.missionUI.firstRunTourSampleTableLogicalName},12111:function(e,t,n){"use strict";var r;n.r(t),n.d(t,"AddPageWizardSteps",(function(){return r})),function(e){e.SelectPageType="SelectPageType",e.AddEntityPage="AddEntityPage",e.AddDashboardPage="AddDashboardPage",e.AddCustomPage="AddCustomPage"}(r||(r={}))},12112:function(e,t,n){"use strict";n.r(t),n.d(t,"PageTypeSelectionStep",(function(){return b}));var r=n(684),a=n(1368),o=n(1795),i=n(1837),s=n(245),c=n(12083),l=n(12088),u=n(12065),d=n(12111),p=n(12094),f=n(12106);function m(){return(m=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var b=e=>{var{onClickDismiss:t,setNextStep:n,t:b}=e;if(!n)throw new Error("setNextStep should be defined in PageTypeSelectionStepProps.");var[v,g]=s.useState(c.PageTypes.Entity),y=[{key:c.PageTypes.Entity,text:b("addPage.entityPageTypeSelectionTitle"),className:"cds-app-module-designer-addpage-entity"},{key:c.PageTypes.Dashboard,text:b("addPage.dashboardPageTypeSelectionTitle"),disabled:!!f.enablePowerAppsFirstRunTour},{key:c.PageTypes.Custom,text:b("addPage.customPageTypeSelectionTitle"),disabled:!!f.enablePowerAppsFirstRunTour}];var h=Object(u.useModalLayoutStyles)();return s.createElement(s.Fragment,null,s.createElement("div",{className:h.header},s.createElement(i.Text,{variant:"xLarge"},b("addPage.header")),s.createElement(l.CloseModalIconButton,m({},e,{onClick:t}))),s.createElement("div",{className:h.body},s.createElement(o.Stack,{className:h.left},s.createElement(p.PageTypeBannerImageWithCaption,m({},e,{pageType:v}))),s.createElement(o.Stack,{className:h.right},s.createElement(i.Text,{variant:"medium",styles:u.callToActionTextStyles},b("addPage.typeSelectCallToAction")),s.createElement(a.ChoiceGroup,{defaultSelectedKey:c.PageTypes.Entity,options:y,onChange:(e,t)=>{g(t?c.PageTypes[t.key]:c.PageTypes.Entity)},required:!0}))),s.createElement("div",{className:h.footer},s.createElement("div",{className:h.footerRight},s.createElement(r.PrimaryButton,{text:b("buttons.next"),onClick:function(){v===c.PageTypes.Entity?n(d.AddPageWizardSteps.AddEntityPage.toString()):v===c.PageTypes.Dashboard?n(d.AddPageWizardSteps.AddDashboardPage.toString()):v===c.PageTypes.Custom&&n(d.AddPageWizardSteps.AddCustomPage.toString())}}),s.createElement(r.DefaultButton,{text:b("buttons.cancel"),onClick:t}))))}},12113:function(e,t,n){"use strict";n.r(t),n.d(t,"UnconnectedAddSubAreaModal",(function(){return p})),n.d(t,"AddSubAreaModal",(function(){return f}));var r=n(1071),a=n(922),o=n(895),i=n(245),s=n(10443),c=n(11984),l=n(12065),u=n(12114);function d(){return(d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var p=e=>{var t=Object(s.useSelector)(c.Selectors.isAddSubAreaUIOpen),n=Object(s.useDispatch)(),r=()=>n(c.Actions.closeAddSubAreaUI()),a=Object(l.useModalLayoutStyles)();return i.createElement(o.Modal,{isOpen:t,onDismiss:r,styles:{root:[a.root]},scrollableContentClassName:a.container},i.createElement(u.AddSubAreaModalBody,d({},e,{onClickDismiss:r})))},f=Object(r.withServices)(p,[i.memo,Object(a.translateService)("AppModuleDesigner")])},12114:function(e,t,n){"use strict";n.r(t),n.d(t,"AddSubAreaModalBody",(function(){return j}));var r=n(684),a=n(1795),o=n(1837),i=n(245),s=n(10443),c=n(12115),l=n.n(c),u=n(10305),d=n(10303),p=n(10313),f=n(12116),m=n(12031),b=n(12098),v=n(12088),g=n(12065),y=n(12122),h=n(12156);function S(){return(S=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function A(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach((function(t){P(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function P(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var j=e=>{var{onClickDismiss:t,t:n}=e,c=Object(g.useModalLayoutStyles)(),O=Object(u.makeSubArea)(),[P,j]=i.useState(O),E=Object(s.useDispatch)(),C=Object(m.useEnvironmentLanguageCode)(),T=i.useMemo(()=>!Object(d.isVisibleSubArea)(P),[P]);function M(e,t){switch(e){case h.SubAreaNodeFieldName.Id:return A(A({},P),{},{Id:t});case h.SubAreaNodeFieldName.Title:return Object(d.setOrClearTitle)(A({},P),t,C);case h.SubAreaNodeFieldName.Entity:return Object(p.updateSubAreaEntity)(A({},P),t);case h.SubAreaNodeFieldName.Dashboard:return Object(p.updateSubAreaDashboard)(A({},P),t);case h.SubAreaNodeFieldName.CustomPage:return Object(p.updateSubAreaCustomPage)(A({},P),t);case h.SubAreaNodeFieldName.Url:return Object(p.updateSubAreaUrl)(A({},P),t);default:return P}}return i.createElement(i.Fragment,null,i.createElement("div",{className:c.header},i.createElement(o.Text,{variant:"xLarge"},n("addSubArea.header")),i.createElement(v.CloseModalIconButton,S({},e,{onClick:t}))),i.createElement("div",{className:c.body},i.createElement(a.Stack,{className:c.left},i.createElement(b.BannerImageWithCaption,{caption:n("addSubArea.helpText"),imageUrl:l.a})),i.createElement(a.Stack,{className:c.right,tokens:{childrenGap:12}},i.createElement(y.SiteMapNodeInputForm,S({key:"addSiteMapNodeInputForm"},e,{siteMapNode:P,onlyShowRequiredInput:!0,selectedEntityLogicalName:P.Entity,selectedDashboardId:P.DefaultDashboard,selectedCustomPageName:P.Page,selectedUrl:P.Url,onTitleChanged:function(e){j(M(h.SubAreaNodeFieldName.Title,e))},onIdChanged:function(e){j(M(h.SubAreaNodeFieldName.Id,e))},onEntityChanged:function(e){j(M(h.SubAreaNodeFieldName.Entity,e))},onDashboardChanged:function(e){j(M(h.SubAreaNodeFieldName.Dashboard,e))},onCustomPageChanged:function(e){j(M(h.SubAreaNodeFieldName.CustomPage,e))},onUrlChanged:function(e,t){j(M(h.SubAreaNodeFieldName.Url,t))}})))),i.createElement("div",{className:c.footer},i.createElement("div",{className:c.footerRight},i.createElement(r.PrimaryButton,{text:n("buttons.add"),disabled:T,onClick:function(){E(f.Actions.insertSubAreaNode(P)),t()}}),i.createElement(r.DefaultButton,{text:n("buttons.cancel"),onClick:t}))))}},12115:function(e,t){e.exports="data:image/png;base64,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"},12116:function(e,t,n){"use strict";n.r(t);var r=n(12117);n.d(t,"Actions",(function(){return r}));var a=n(12118);n.d(t,"makeMiddleware",(function(){return a.default}));var o=n(12121);n.d(t,"Selectors",(function(){return o}))},12117:function(e,t,n){"use strict";n.r(t),n.d(t,"updateSelectedNodeTitle",(function(){return s})),n.d(t,"updateSelectedNodeId",(function(){return c})),n.d(t,"updateSelectedSubAreaEntity",(function(){return l})),n.d(t,"updateSelectedSubAreaDashboard",(function(){return u})),n.d(t,"updateSelectedSubAreaCustomPage",(function(){return d})),n.d(t,"updateSelectedSubAreaUrl",(function(){return p})),n.d(t,"updateSelectedSubAreaIcon",(function(){return f})),n.d(t,"insertAreaNode",(function(){return m})),n.d(t,"insertGroupNode",(function(){return b})),n.d(t,"insertSubAreaNode",(function(){return v}));var r=n(11986),a=n(11987),o=n(11989),i=n(11988),s=Object(r.createAction)("siteMap/UPDATE_SELECTED_NODE_TITLE",Object(a.payload)())(),c=Object(r.createAction)("siteMap/UPDATE_SELECTED_NODE_ID",Object(a.payload)())(),l=Object(r.createAction)("siteMap/UPDATE_SELECTED_SUBAREA_ENTITY",Object(a.payload)())(),u=Object(r.createAction)("siteMap/UPDATE_SELECTED_SUBAREA_DASHBOARD",Object(a.payload)())(),d=Object(r.createAction)("siteMap/UPDATE_SELECTED_SUBAREA_CUSTOM_PAGE",Object(a.payload)())(),p=Object(r.createAction)("siteMap/UPDATE_SELECTED_SUBAREA_URL",Object(a.payload)())(),f=Object(r.createAction)("siteMap/UPDATE_SELECTED_SUBAREA_ICON",Object(a.payload)())(),m=Object(r.createAction)("siteMap/INSERT_AREA_NODE",a.noPayload,()=>Object(i.withTelemetryEventMeta)({eventName:o.default.InsertArea}))(),b=Object(r.createAction)("siteMap/INSERT_GROUP_NODE",a.noPayload,()=>Object(i.withTelemetryEventMeta)({eventName:o.default.InsertGroup}))(),v=Object(r.createAction)("siteMap/INSERT_SUBAREA_NODE",Object(a.payload)(),()=>Object(i.withTelemetryEventMeta)({eventName:o.default.InsertSubArea}))()},12118:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return O}));var r=n(10302),a=n(10305),o=n(10303),i=n(10308),s=n(10297),c=n(11986),l=n(12058),u=n(12119),d=n(12031),p=n(12005),f=n(12033),m=n(11984),b=n(12117),v=n(12120),g=n(12121);function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){S(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function S(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function O(e){return t=>n=>y=>{var S=n(y);if(Object(c.isActionOf)(b.updateSelectedNodeTitle,y)){var O=g.selectedSiteMapNodePath(t.getState());O&&t.dispatch(p.App.Actions.updateSiteMapNodeTitle(h(h({},y.payload),{},{nodePath:O})))}if(Object(c.isActionOf)(b.updateSelectedNodeId,y)){var C=g.selectedSiteMapNodePath(t.getState());C&&t.dispatch(p.App.Actions.updateNodeId({newId:y.payload,nodePath:C}))}if(Object(c.isActionOf)(b.updateSelectedSubAreaEntity,y)){var T=y.payload;P(t,T);var M=g.selectedSiteMapNodePath(t.getState());M&&t.dispatch(p.App.Actions.updateSubAreaEntity({newEntityLogicalName:y.payload,nodePath:M}))}if(Object(c.isActionOf)(b.updateSelectedSubAreaDashboard,y)){var w=y.payload;j(t,w);var I=g.selectedSiteMapNodePath(t.getState());I&&t.dispatch(p.App.Actions.updateSubAreaDashboard({newDashboardId:y.payload,nodePath:I}))}if(Object(c.isActionOf)(b.updateSelectedSubAreaCustomPage,y)){var N=y.payload;E(t,N);var D=g.selectedSiteMapNodePath(t.getState());if(D){var x=Object(d.getLanguageCodeFromEnvironment)(e.environmentProps);!function(e,t,n,a){var c,l=p.Selectors.getSiteMap(e.getState()).value,d=p.Selectors.customPagesInEnvironment(e.getState()).value;if(!n||!l||!d)return;var m=Object(f.getCustomPageByName)(d,n);if(!m)return;var b=Object(r.getSiteMapNodeViaPath)(l,t);if(!b||!Object(i.isSubAreaNode)(b))return;var v=Object(o.getTitle)(b,a),g=Object(f.getCustomPageByName)(d,null!==(c=b.Page)&&void 0!==c?c:"");if(Object(s.isBlank)(v)||b.Page&&g&&Object(u.getCustomPageDefaultTitle)(g)===v){var y=Object(u.getCustomPageDefaultTitle)(m);e.dispatch(p.App.Actions.updateSiteMapNodeTitle({nodePath:t,newTitle:y,languageCode:a}))}}(t,D,N,x),t.dispatch(p.App.Actions.updateSubAreaCustomPage({newPageName:N,nodePath:D}))}}if(Object(c.isActionOf)(b.updateSelectedSubAreaUrl,y)){var{urlType:k,url:R}=y.payload,L=g.selectedSiteMapNodePath(t.getState());L&&t.dispatch(p.App.Actions.updateSubAreaUrl({newUrlType:k,newUrl:R,nodePath:L}))}if(Object(c.isActionOf)(b.updateSelectedSubAreaIcon,y)){var{icon:U,vectorIcon:B}=y.payload,F=g.selectedSiteMapNodePath(t.getState());F&&t.dispatch(p.App.Actions.updateSubAreaIcon({nodePath:F,icon:U,vectorIcon:B}))}if(Object(c.isActionOf)(b.insertAreaNode,y)){var V,q=null===(V=p.Selectors.getSiteMap(t.getState()).value)||void 0===V?void 0:V.siteMapXml,W=g.selectedSiteMapNodePath(t.getState()),H=Object(v.areaInsertionPath)(q,W);t.dispatch(p.App.Actions.insertSiteMapNode({targetPath:H,node:Object(a.makeArea)()}))}if(Object(c.isActionOf)(b.insertGroupNode,y)){var G,z=null===(G=p.Selectors.getSiteMap(t.getState()).value)||void 0===G?void 0:G.siteMapXml,K=g.selectedSiteMapNodePath(t.getState()),X=Object(v.groupInsertionPath)(z,K);t.dispatch(p.App.Actions.insertSiteMapNode({targetPath:X,node:Object(a.makeGroup)()}))}if(Object(c.isActionOf)(b.insertSubAreaNode,y)){var Q,_=null===(Q=p.Selectors.getSiteMap(t.getState()).value)||void 0===Q?void 0:Q.siteMapXml,Y=g.selectedSiteMapNodePath(t.getState()),Z=Object(v.subAreaInsertionPath)(_,Y);t.dispatch(p.App.Actions.insertSiteMapNode({targetPath:Z,node:y.payload})),y.payload.Entity&&P(t,y.payload.Entity),y.payload.DefaultDashboard&&j(t,y.payload.DefaultDashboard),y.payload.Page&&E(t,y.payload.Page)}if(Object(c.isActionOf)(p.App.Actions.insertSiteMapNode,y)&&!y.payload.bypassAutoSelection&&t.dispatch(m.Actions.selectSiteMapNode({nodeType:l.SiteMapPaneNodeType.SiteMapNode,selectedNodePath:y.payload.targetPath})),Object(c.isActionOf)(p.App.Actions.addAppModuleEntities,y)&&y.payload.addToNavigation){var J,$=null===(J=p.Selectors.getSiteMap(t.getState()).value)||void 0===J?void 0:J.siteMapXml,ee=g.selectedSiteMapNodePath(t.getState()),te=Object(v.subAreaInsertionPath)($,ee);for(var[ne,re]of y.payload.entities.entries()){var ae=y.payload.entities.length-1;t.dispatch(p.App.Actions.insertSiteMapNode({targetPath:h(h({},te),{},{subAreaIndex:te.subAreaIndex+ne}),node:Object(v.makeEntitySubArea)(re),bypassAutoSelection:ne!==ae}))}}if(Object(c.isActionOf)(p.App.Actions.removeAppModuleEntities,y)&&A(t,e=>Object(i.isSubAreaNode)(e)&&!!y.payload.find(t=>t.logicalName===e.Entity)),Object(c.isActionOf)(p.App.Actions.addAppModuleDashboards,y)&&y.payload.addToNavigation){var oe,ie=null===(oe=p.Selectors.getSiteMap(t.getState()).value)||void 0===oe?void 0:oe.siteMapXml,se=g.selectedSiteMapNodePath(t.getState()),ce=Object(v.subAreaInsertionPath)(ie,se);for(var[le,ue]of y.payload.dashboards.entries()){var de=y.payload.dashboards.length-1;t.dispatch(p.App.Actions.insertSiteMapNode({targetPath:h(h({},ce),{},{subAreaIndex:ce.subAreaIndex+le}),node:Object(v.makeDashboardSubArea)(ue),bypassAutoSelection:le!==de}))}}if(Object(c.isActionOf)(p.App.Actions.removeAppModuleDashboards,y)&&A(t,e=>Object(i.isSubAreaNode)(e)&&!!y.payload.find(t=>t===e.DefaultDashboard)),Object(c.isActionOf)(p.App.Actions.addAppModuleCustomPages,y)&&y.payload.addToNavigation){var pe,fe=null===(pe=p.Selectors.getSiteMap(t.getState()).value)||void 0===pe?void 0:pe.siteMapXml,me=g.selectedSiteMapNodePath(t.getState()),be=Object(v.subAreaInsertionPath)(fe,me),ve=Object(d.getLanguageCodeFromEnvironment)(e.environmentProps);for(var[ge,ye]of y.payload.customPages.entries()){var he=y.payload.customPages.length-1;t.dispatch(p.App.Actions.insertSiteMapNode({targetPath:h(h({},be),{},{subAreaIndex:be.subAreaIndex+ge}),node:Object(v.makeCustomPageSubArea)(ye,ve),bypassAutoSelection:ge!==he}))}}if(Object(c.isActionOf)(p.App.Actions.removeAppModuleCustomPages,y)&&A(t,e=>Object(i.isSubAreaNode)(e)&&!!y.payload.find(t=>t.name===e.Page)),Object(c.isActionOf)(p.App.Actions.moveNodeUp,y)||Object(c.isActionOf)(p.App.Actions.moveNodeDown,y)){var{nodeIdMap:Se}=g.siteMapNodeAssociationMaps(t.getState()),Oe=Se[y.payload.node.Id];Oe&&t.dispatch(m.Actions.selectSiteMapNode({nodeType:l.SiteMapPaneNodeType.SiteMapNode,selectedNodePath:Oe.path}))}return Promise.resolve(S)}}function A(e,t){for(var n,r=e.getState(),a=null===(n=p.Selectors.getSiteMap(r).value)||void 0===n?void 0:n.siteMapXml,o=Object(v.findNodesWhere)(a,t),i=o.length-1;i>=0;i--){var s=o[i][1];e.dispatch(p.App.Actions.deleteNode(s))}}function P(e,t){var n,r=e.getState(),a=p.Selectors.entitiesInEnvironment(r),o=t&&(null===(n=a.value)||void 0===n?void 0:n.find(e=>e.logicalName.toLowerCase()===t.toLowerCase()));o&&e.dispatch(p.App.Actions.addAppModuleEntities({entities:[o],addToNavigation:!1}))}function j(e,t){var n,r=e.getState(),a=p.Selectors.dashboardsInEnvironment(r),o=t&&(null===(n=a.value)||void 0===n?void 0:n.find(e=>e.id.toLowerCase()===t.toLowerCase()));o&&e.dispatch(p.App.Actions.addAppModuleDashboards({dashboards:[o],addToNavigation:!1}))}function E(e,t){var n,r=e.getState(),a=p.Selectors.customPagesInEnvironment(r),o=t&&(null===(n=a.value)||void 0===n?void 0:n.find(e=>e.name.toLowerCase()===t.toLowerCase()));o&&e.dispatch(p.App.Actions.addAppModuleCustomPages({customPages:[o],addToNavigation:!1}))}},12119:function(e,t,n){"use strict";function r(e){return e.displayName||e.name}n.r(t),n.d(t,"getCustomPageDefaultTitle",(function(){return r}))},12120:function(e,t,n){"use strict";n.r(t),n.d(t,"areaInsertionPath",(function(){return l})),n.d(t,"groupInsertionPath",(function(){return u})),n.d(t,"subAreaInsertionPath",(function(){return d})),n.d(t,"findNodesWhere",(function(){return p})),n.d(t,"makeEntitySubArea",(function(){return f})),n.d(t,"makeDashboardSubArea",(function(){return m})),n.d(t,"makeCustomPageSubArea",(function(){return b}));var r=n(10302),a=n(10305),o=n(10313);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n,a,o;void 0!==(null==t?void 0:t.areaIndex)?n=t.areaIndex+1:n=null!==(a=null==e||null===(o=e.Area)||void 0===o?void 0:o.length)&&void 0!==a?a:0;return{pathType:r.NodePathType.Area,areaIndex:n}}function u(e,t){var n,a,o=null!==(n=null==t?void 0:t.areaIndex)&&void 0!==n?n:0;if(void 0!==(null==t?void 0:t.groupIndex))a=t.groupIndex+1;else{var i,s,c,l=null==e||null===(i=e.Area)||void 0===i?void 0:i[o];a=null!==(s=null==l||null===(c=l.Group)||void 0===c?void 0:c.length)&&void 0!==s?s:0}return{pathType:r.NodePathType.Group,areaIndex:o,groupIndex:a}}function d(e,t){var n,a,o,i=null!==(n=null==t?void 0:t.areaIndex)&&void 0!==n?n:0,s=null!==(a=null==t?void 0:t.groupIndex)&&void 0!==a?a:0;if(void 0!==(null==t?void 0:t.subAreaIndex))o=t.subAreaIndex+1;else{var c,l,u,d,p,f=null==e||null===(c=e.Area)||void 0===c||null===(l=c[i])||void 0===l||null===(u=l.Group)||void 0===u?void 0:u[s];o=null!==(d=null==f||null===(p=f.SubArea)||void 0===p?void 0:p.length)&&void 0!==d?d:0}return{pathType:r.NodePathType.SubArea,areaIndex:i,groupIndex:s,subAreaIndex:o}}function p(e,t){if(null==e||!e.Area)return[];for(var n=[],a=0;a<e.Area.length;a++){var o=e.Area[a];if(t(o)&&n.push([o,Object(r.nodePath)(a)]),o.Group)for(var i=0;i<o.Group.length;i++){var s=o.Group[i];if(t(s)&&n.push([s,Object(r.nodePath)(a,i)]),s.SubArea)for(var c=0;c<s.SubArea.length;c++){var l=s.SubArea[c];t(l)&&n.push([l,Object(r.nodePath)(a,i,c)])}}}return n}function f(e,t){return Object(o.updateSubAreaEntity)(Object(a.makeSubArea)(t),e.logicalName)}function m(e,t){return Object(o.updateSubAreaDashboard)(Object(a.makeSubArea)(t),e.id)}function b(e,t,n){return Object(o.updateSubAreaCustomPage)(s(s({},Object(a.makeSubArea)(n)),{},{Titles:Object(a.makeTitles)(e.displayName,t)}),e.name)}},12121:function(e,t,n){"use strict";n.r(t),n.d(t,"selectedSiteMapNodePath",(function(){return p})),n.d(t,"siteMapPaneExpandedItems",(function(){return f})),n.d(t,"selectedSiteMapNodeType",(function(){return m})),n.d(t,"selectedSiteMapNode",(function(){return b})),n.d(t,"selectedEntity",(function(){return v})),n.d(t,"selectedDashboard",(function(){return g})),n.d(t,"selectedCustomPage",(function(){return y})),n.d(t,"selectedUrl",(function(){return h})),n.d(t,"getNodeSoftTitleHelper",(function(){return S})),n.d(t,"siteMapNodeAssociationMaps",(function(){return O})),n.d(t,"siteMapHasWebResourceSubAreas",(function(){return A}));var r=n(10302),a=n(10303),o=n(10308),i=n(10309),s=n(5625),c=n(12058),l=n(12018),u=n(12033),d=n(12032),p=e=>Object(c.isSiteMapPaneSelection)(e.ui.selection)?e.ui.selection.selectedNodePath:void 0,f=e=>e.ui.siteMapPaneExpandedItemKeys,m=e=>Object(c.isSiteMapPaneSelection)(e.ui.selection)?e.ui.selection.nodeType:void 0,b=Object(s.createSelector)(d.getSiteMap,p,(e,t)=>{if(e.loadState===l.LoadStates.Loaded&&t)return Object(r.getSiteMapNodeViaPath)(e.value,t)}),v=Object(s.createSelector)(d.entitiesInEnvironment,b,(e,t)=>{if(e.loadState===l.LoadStates.Loaded&&t){var n=t.Entity;if(n)return Object(u.getEntityByLogicalName)(e.value,n)}}),g=Object(s.createSelector)(d.dashboardsInEnvironment,b,(e,t)=>{if(e.loadState===l.LoadStates.Loaded&&t){var n=t.DefaultDashboard;if(n)return Object(u.getDashboardById)(e.value,n)}}),y=Object(s.createSelector)(d.customPagesInEnvironment,b,(e,t)=>{if(e.loadState===l.LoadStates.Loaded&&t){var n=t.Page;if(n)return Object(u.getCustomPageByName)(e.value,n)}}),h=Object(s.createSelector)(b,e=>{if(e){var t=e.Url;if("string"==typeof t)return t}}),S=Object(s.createSelector)(d.entitiesInEnvironment,d.customPagesInEnvironment,(e,t)=>{var n={},r={};if(e.value)for(var i of e.value){var s,c;n[i.logicalName]=null!==(s=null!==(c=i.displayCollectionName)&&void 0!==c?c:i.displayName)&&void 0!==s?s:void 0}if(t.value)for(var l of t.value){var u;r[l.name]=null!==(u=l.displayName)&&void 0!==u?u:l.name}return(e,t,i)=>{var s,c=Object(a.getTitle)(e,i);return c||(Object(o.isSubAreaNode)(e)?e.Entity?null!==(s=n[e.Entity])&&void 0!==s?s:t("navigation.newSubArea"):e.DefaultDashboard?t("navigation.dashboards"):e.Page?r[e.Page]:t("navigation.newSubArea"):Object(o.isGroupNode)(e)?t("navigation.newGroup"):t("navigation.newArea"))}}),O=Object(s.createSelector)(d.getSiteMap,e=>{var t,n=Object.create(null),a=Object.create(null),o=Object.create(null),i=Object.create(null),s=null===(t=e.value)||void 0===t?void 0:t.siteMapXml.Area;return null==s||s.forEach((e,t)=>{var s;n[e.Id]={node:e,path:Object(r.nodePath)(t)},null===(s=e.Group)||void 0===s||s.forEach((e,s)=>{var c;n[e.Id]={node:e,path:Object(r.nodePath)(t,s)},null===(c=e.SubArea)||void 0===c||c.forEach((e,c)=>{var l,u,d,p={node:e,path:Object(r.nodePath)(t,s,c)};(n[e.Id]=p,e.Entity)&&(a[e.Entity]=null!==(l=a[e.Entity])&&void 0!==l?l:[],a[e.Entity].push(p));e.DefaultDashboard&&(o[e.DefaultDashboard]=null!==(u=o[e.DefaultDashboard])&&void 0!==u?u:[],o[e.DefaultDashboard].push(p));e.Page&&(i[e.Page]=null!==(d=i[e.Page])&&void 0!==d?d:[],i[e.Page].push(p))})})}),{nodeIdMap:n,entityNameMultiMap:a,dashboardIdMultiMap:o,customPageNameMultiMap:i}}),A=Object(s.createSelector)(d.getSiteMap,e=>e.loadState===l.LoadStates.Loaded&&Object(i.siteMapHasWebResourceSubAreas)(e.value))},12122:function(e,t,n){"use strict";n.r(t),n.d(t,"SiteMapNodeInputForm",(function(){return y}));var r=n(10302),a=n(10308),o=n(12070),i=n(245),s=n(10443),c=n(12116),l=n(12031),u=n(12123),d=n(12137),p=n(12138),f=n(12140),m=n(12141),b=n(12142),v=n(12154),g=n(12155),y=e=>{var{onlyShowRequiredInput:t,siteMapNode:n,selectedEntityLogicalName:y,selectedDashboardId:h,selectedCustomPageName:S,selectedUrl:O,onTitleChanged:A,onIdChanged:P,onEntityChanged:j,onDashboardChanged:E,onCustomPageChanged:C,onUrlChanged:T,t:M}=e,w=Object(l.useEnvironmentLanguageCode)(),I=Object(s.useSelector)(c.Selectors.getNodeSoftTitleHelper),[N,D]=i.useState(Object(r.getSubAreaContentType)(n)),[x,k]=i.useState(O);i.useEffect(()=>{k(O)},[O]);var R={key:"title",inputType:"text",label:M("propertiesPane.title"),textFieldProps:{placeholder:M("propertiesPane.titlePlaceholder")},value:I(n,M,w),onChanged:e=>{A(e,w)}},L={key:"id",inputType:"text",label:M("propertiesPane.id"),textFieldProps:{placeholder:M("propertiesPane.idPlaceholder")},value:n.Id,onChanged:e=>{P(e)},required:!0},U=Object(d.useSubAreaContentTypeProperty)({selectedSubAreaContentType:N,onContentTypeChanged:e=>{D(e),Object(r.getSubAreaContentType)(n)===e?k(O):k(void 0)}}),B=Object(m.useSubAreaEntityProperty)({t:M,selectedEntityLogicalName:y,onEntityChanged:j}),F=Object(f.useSubAreaDashboardProperty)({selectedDashboardId:h,onDashboardChanged:E}),V=Object(p.useSubAreaCustomPageProperty)({t:M,selectedCustomPageName:S,onCustomPageChanged:C}),q=Object(g.useSubAreaWebResourceProperty)({url:x,onUrlChanged:T}),W=Object(v.useSubAreaUrlProperty)({url:x,onUrlChanged:T}),H=Object(u.useSiteMapNodeTitleLocalizationsProperty)({siteMapNode:n}),G=Object(b.useSubAreaIconProperties)(n),z={key:"main",properties:[]};return Object(a.isSubAreaNode)(n)&&(z.properties.push(U),N===r.SubAreaContentType.Entity?z.properties.push(B):N===r.SubAreaContentType.Dashboard?z.properties.push(F):N===r.SubAreaContentType.CustomPage?z.properties.push(V):N===r.SubAreaContentType.WebResource?z.properties.push(q):N===r.SubAreaContentType.Url&&z.properties.push(W)),z.properties.push(R),t||(z.properties.push(...G),z.properties.push(L),z.properties.push(H)),i.createElement(o.PropertySheet,{sections:[z]})}},12123:function(e,t,n){"use strict";n.r(t),n.d(t,"useSiteMapNodeTitleLocalizationsProperty",(function(){return o}));var r=n(245),a=n(12124);function o(e){return{key:"locales",inputType:"custom",onRender:t=>r.createElement(a.SiteMapNodeTitleLocalizationManager,{siteMapNode:e.siteMapNode})}}},12124:function(e,t,n){"use strict";n.r(t),n.d(t,"SiteMapNodeTitleLocalizationManager",(function(){return h}));var r=n(684),a=n(1372),o=n(1795),i=n(12125),s=n(923),c=n(245),l=n(924),u=n(10443),d=n(10303),p=n(12116),f=n(12126),m=n(12127),b=n(12129),v=n(12130),g=n(12133),y=n(12136),h=e=>{var t=Object(u.useDispatch)(),{t:n}=Object(s.useTranslation)("AppModuleDesigner"),[h,S]=c.useState(!1),[O,A]=c.useState(g.UserInputMode.Add),[P,j]=c.useState({localeId:"",text:""}),[E,C]=c.useState("add-sitemap-node-locale-button"),T=Object(i.useLocaleIdToTitleMap)(),M=Object(d.getTitles)(e.siteMapNode),w=(e=>{var t=Object(i.useSupportedLocaleIds)(),n=t;if(e&&e.length>0){var r=new Set(e);n=t.filter(e=>!r.has(e))}return n})(M.map(e=>e.LCID)),I=M.map(e=>{var t;return{key:e.LCID,text:null!==(t=T.get(e.LCID))&&void 0!==t?t:e.LCID,localization:{localeId:e.LCID,text:e.Title}}}),N=()=>{j({localeId:"",text:""})},D={availableLocaleIds:w};return c.createElement(y.SiteMapNodeTitleLocalizationContext.Provider,{value:D},c.createElement(a.Label,{styles:{root:{padding:"0 0 8px"}}},n("propertiesPane.localizedTitles.header")),c.createElement(o.Stack,{tokens:{childrenGap:8},role:"list"},I.map(e=>c.createElement("div",{key:e.key},c.createElement(m.ListItemPill,{id:"nodeLocalization"+e.key,moreButtonProps:{title:n("propertiesPane.moreOptions"),menuProps:{items:[{key:"edit",text:n("buttons.edit"),iconProps:{iconName:"Edit"},onClick:()=>{var t;t=e.localization,j({localeId:t.localeId,text:t.text}),C("nodeLocalization".concat(t.localeId)),A(g.UserInputMode.Edit),S(!0)}},{key:"remove",text:n("buttons.remove"),iconProps:{iconName:"Trash"},onClick:()=>{var n;n=e.localization.localeId,t(p.Actions.updateSelectedNodeTitle({newTitle:"",languageCode:n}))}}]}}},c.createElement(l.Trans,{i18nKey:"propertiesPane.localizedTitles.siteMapNodeTitleAndLocaleTitle"},c.createElement("p",{title:n("propertiesPane.localizedTitles.siteMapNodeTitleAndLocaleTitle",{nodeTitle:e.localization.text,localeTitle:e.text}),className:f.textStyles.singleLineWithEllipsis},c.createElement("strong",null,{nodeTitle:e.localization.text},", "),{localeTitle:e.text})))))),c.createElement(r.ActionButton,{id:"add-sitemap-node-locale-button",disabled:!w||0===w.length,iconProps:{iconName:"Add"},styles:b.propertyActionButtonStyles,onClick:()=>{N(),C("add-sitemap-node-locale-button"),A(g.UserInputMode.Add),S(!0)}},n("propertiesPane.localizedTitles.addLocale")),c.createElement(v.SiteMapNodeTitleLocalizationCallout,{key:"title-loc-callout",currentLocalization:P,userInputMode:O,isCalloutOpen:h,calloutTargetControlId:E,dismissCallout:()=>{S(!1),N()}}))}},12125:function(e,t,n){"use strict";n.r(t),n.d(t,"useSupportedLocaleIds",(function(){return a})),n.d(t,"useSupportedLocales",(function(){return o})),n.d(t,"useLocaleIdToTitleMap",(function(){return i}));var r=n(923),a=()=>["1025","1026","1027","1028","1029","1030","1031","1032","1033","1035","1036","1037","1038","1040","1041","1042","1043","1044","1045","1046","1048","1049","1050","1051","1053","1054","1055","1057","1058","1060","1061","1062","1063","1066","1069","1081","1086","1087","1110","2052","2070","2074","3076","3082","3098"],o=()=>{var{t:e}=Object(r.useTranslation)("CdsCommonUx");return a().map(t=>({localeId:t,title:e("locales.locale".concat(t))}))};function i(){var e=o();return new Map(e.map(e=>[e.localeId,e.title]))}},12126:function(e,t,n){"use strict";n.r(t),n.d(t,"textStyles",(function(){return a}));var r=n(719),a=Object(r.mergeStyleSets)({singleLineWithEllipsis:{textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"}})},12127:function(e,t,n){"use strict";n.r(t),n.d(t,"ListItemPill",(function(){return s}));var r=n(684),a=n(245),o=n(12128);function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var s=e=>{var t=Object(o.usePillStyles)();return a.createElement("div",{id:e.id,className:t.container,role:"listitem"},a.createElement("div",{className:t.contents},e.children),e.moreButtonProps&&a.createElement(r.IconButton,i({menuIconProps:{iconName:"MoreVertical"},className:t.moreButton},e.moreButtonProps)))}},12128:function(e,t,n){"use strict";n.r(t),n.d(t,"usePillStyles",(function(){return o}));var r=n(719),a=n(12066),o=()=>{var e=Object(a.default)();return Object(r.mergeStyleSets)({container:["ListItemPill",{width:"100%",minHeight:32,padding:"5px 8px 7px",border:"1px solid ".concat(e.palette.neutralSecondary),borderRadius:4,backgroundColor:e.palette.white,fontWeight:"600",color:e.palette.themePrimary,display:"flex",justifyContent:"center",alignItems:"center"}],contents:{float:"left",width:"92%"},moreButton:{float:"right",height:18,width:16,marginTop:2,paddingTop:3,paddingBottom:3,marginRight:-3}})}},12129:function(e,t,n){"use strict";n.r(t),n.d(t,"rightPaneStyles",(function(){return r})),n.d(t,"propertyActionButtonStyles",(function(){return a}));var r={root:["PropertiesPane"],contentContainer:{width:"100%",overflow:"auto",flexGrow:1,padding:16}},a={root:{padding:0,marginLeft:-5}}},12130:function(e,t,n){"use strict";n.r(t),n.d(t,"SiteMapNodeTitleLocalizationCallout",(function(){return v}));var r=n(1259),a=n(684),o=n(923),i=n(245),s=n(10443),c=n(12116),l=n(12131),u=n(12133),d=n(12134);function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){m(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var b=e=>!!e.localeId&&!!e.text,v=e=>{var{userInputMode:t,currentLocalization:n,calloutTargetControlId:p,dismissCallout:m,isCalloutOpen:v}=e,{t:g}=Object(o.useTranslation)("AppModuleDesigner"),y=Object(s.useDispatch)(),[h,S]=i.useState({localeId:n.localeId,text:n.text,isValid:b(n)});i.useEffect(()=>{var e,t;S({localeId:null!==(e=n.localeId)&&void 0!==e?e:"",text:null!==(t=n.text)&&void 0!==t?t:"",isValid:b(n)})},[n,n.localeId,n.text]);var O=t===u.UserInputMode.Add?"propertiesPane.localizedTitles.callout.addLocaleCalloutTitle":"propertiesPane.localizedTitles.callout.editLocaleCalloutTitle";return i.createElement(l.CalloutLayout,{calloutTitleStringKey:O,calloutProps:{ariaLabelledBy:p,hidden:!v,target:"#".concat(p),onDismiss:m,directionalHint:r.DirectionalHint.leftCenter},footerButtons:i.createElement(i.Fragment,null,i.createElement(a.PrimaryButton,{disabled:!h.isValid,onClick:()=>{y(c.Actions.updateSelectedNodeTitle({newTitle:h.text,languageCode:h.localeId})),m()}},g("buttons.save")),i.createElement(a.DefaultButton,{onClick:m},g("buttons.cancel")))},i.createElement(d.SiteMapNodeTitleLocalizationInputForm,{validatedLocalization:h,userInputMode:t,onLocaleIdChanged:e=>{S(t=>f(f({},t),{},{localeId:e,isValid:b(f(f({},t),{},{localeId:e}))}))},onTitleTextChanged:e=>{S(t=>f(f({},t),{},{text:e,isValid:b(f(f({},t),{},{text:e}))}))}}))}},12131:function(e,t,n){"use strict";n.r(t),n.d(t,"CalloutLayout",(function(){return d}));var r=n(684),a=n(790),o=n(1795),i=n(923),s=n(245),c=n.n(s),l=n(12132);function u(){return(u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var d=e=>{var t,n,s=Object(l.useCalloutLayoutStyles)(),{t:d}=Object(i.useTranslation)("AppModuleDesigner"),{onDismiss:p}=null!==(t=e.calloutProps)&&void 0!==t?t:{};return c.a.createElement(a.Callout,u({},e.calloutProps,{role:"dialog",setInitialFocus:!0,calloutWidth:330,calloutMaxHeight:null!==(n=e.maxHeight)&&void 0!==n?n:380}),c.a.createElement(o.Stack,{className:s.container},c.a.createElement("div",{className:s.header},c.a.createElement("div",{className:s.titleRow},c.a.createElement("h2",{className:s.title},d(e.calloutTitleStringKey)),c.a.createElement(r.IconButton,{iconProps:{iconName:"Cancel"},className:s.closeButton,ariaLabel:d("buttons.close"),title:d("buttons.close"),onClick:()=>{null==p||p()}}))),c.a.createElement("div",{role:"presentation",className:s.body},e.children),e.footerButtons&&c.a.createElement("div",{className:s.footer},e.footerButtons)))}},12132:function(e,t,n){"use strict";n.r(t),n.d(t,"useCalloutLayoutStyles",(function(){return o}));var r=n(719),a=n(12066),o=()=>{var e=Object(a.default)();return Object(r.mergeStyleSets)({container:["CalloutLayout-Container"],header:{display:"flex",flexDirection:"column",overflow:"hidden",padding:"10px 16px 0"},titleRow:{display:"flex",flexDirection:"row",alignItems:"top",justifyContent:"center",marginBottom:8},title:{flex:"1",wordWrap:"break-word",color:e.palette.neutralDark,fontSize:20,fontWeight:600},helpText:{marginBottom:8},closeButton:{color:e.palette.neutralDark,width:32,height:32,fontSize:16,marginRight:-6},body:{padding:"8px 16px 16px 16px"},footer:{flex:"auto",display:"flex",justifyContent:"flex-end",padding:"8px 16px",alignItems:"center",selectors:{"& > button":{marginLeft:8}}}})}},12133:function(e,t,n){"use strict";var r;n.r(t),n.d(t,"UserInputMode",(function(){return r})),function(e){e[e.Add=0]="Add",e[e.Edit=1]="Edit"}(r||(r={}))},12134:function(e,t,n){"use strict";n.r(t),n.d(t,"SiteMapNodeTitleLocalizationInputForm",(function(){return f}));var r=n(1447),a=n(719),o=n(545),i=n(12125),s=n(12070),c=n(923),l=n(245),u=n(12135),d=n(12133),p=n(12136),f=e=>{var{t:t}=Object(c.useTranslation)("AppModuleDesigner"),n={key:"node-localization-section",properties:[function(e,t,n){var a,{t:o}=Object(c.useTranslation)("AppModuleDesigner"),s=l.useContext(p.SiteMapNodeTitleLocalizationContext),f=Object(i.useLocaleIdToTitleMap)(),m=s.availableLocaleIds,b=l.useMemo(()=>m.map((e,t)=>{var n;return{key:e,text:null!==(n=f.get(e))&&void 0!==n?n:e,data:t}}),[m]);return n===d.UserInputMode.Edit?{key:"current-locale",inputType:"readonly",label:o("propertiesPane.localizedTitles.callout.localePropertyTitle"),value:null!==(a=f.get(e))&&void 0!==a?a:e}:{key:"available-locales",inputType:"custom",required:!0,info:{tooltipId:"available-locales",content:[o("propertiesPane.localizedTitles.callout.localePropertyToolTip")],infoIconAriaLabel:o("propertiesPane.localizedTitles.callout.localePropertyTitle")},onChanged:e=>{t(e.key)},onRender:t=>l.createElement(r.VirtualizedComboBox,{label:o("propertiesPane.localizedTitles.callout.localePropertyTitle"),placeholder:o("propertiesPane.localizedTitles.callout.availableLocaleListPlaceholder"),styles:u.comboBoxStyles,calloutProps:u.comboBoxCalloutProps,options:b,selectedKey:e,onChange:(e,n)=>t.onChanged(n)})}}(e.validatedLocalization.localeId,e.onLocaleIdChanged,e.userInputMode),function(e,t){var{t:n}=Object(c.useTranslation)("AppModuleDesigner"),r=l.useRef(new o.Async).current.debounce(e=>{t(e)},300);return{key:"node-title-text",inputType:"text",label:n("propertiesPane.localizedTitles.callout.localizedTitlePropertyTitle"),required:!0,textFieldProps:{placeholder:n("propertiesPane.localizedTitles.callout.titleTranslationPlaceholder"),validateOnLoad:!1,onChange:(e,t)=>{r(null!=t?t:"")}},value:e}}(e.validatedLocalization.text,e.onTitleTextChanged)]},f=Object(a.mergeStyleSets)({helpText:{margin:"0 0 20px 0"}});return l.createElement(l.Fragment,null,e.userInputMode===d.UserInputMode.Add&&l.createElement("div",{className:f.helpText},t("propertiesPane.localizedTitles.callout.addLocaleHelpText")," ",l.createElement("a",{target:"_blank",href:"https://go.microsoft.com/fwlink/?linkid=2175176"},t("propertiesPane.localizedTitles.callout.addLocaleLearnMoreLinkTitle"))),l.createElement(s.PropertySheet,{sections:[n],allowInvalidOnChange:!0}))}},12135:function(e,t,n){"use strict";n.r(t),n.d(t,"comboBoxStyles",(function(){return s})),n.d(t,"comboBoxCalloutProps",(function(){return c})),n.d(t,"useComboBoxOptionStyles",(function(){return l}));var r=n(1259),a=n(719),o=n(245),i=n(12066),s={container:{paddingBottom:16},label:{paddingTop:0}},c={directionalHint:r.DirectionalHint.bottomAutoEdge,calloutMaxHeight:420,styles:{calloutMain:{width:320}}},l=()=>{var e=Object(i.default)();return Object(o.useMemo)(()=>u(e),[u,e])},u=e=>Object(a.mergeStyleSets)({clearOption:{overflow:"hidden",color:e.palette.neutralTertiary},option:{overflow:"hidden"}})},12136:function(e,t,n){"use strict";n.r(t),n.d(t,"SiteMapNodeTitleLocalizationContext",(function(){return a}));var r=n(245),a=r.createContext({availableLocaleIds:[]})},12137:function(e,t,n){"use strict";n.r(t),n.d(t,"useSubAreaContentTypeProperty",(function(){return f}));var r=n(1447),a=n(10302),o=n(10309),i=n(923),s=n(245),c=n(10443),l=n(12029),u=n(12005),d=n(11984),p=n(12135);function f(e){var{selectedSubAreaContentType:t,onContentTypeChanged:n}=e,{t:f}=Object(i.useTranslation)("AppModuleDesigner"),m=Object(c.useSelector)(u.Selectors.getSiteMap),b=Object(c.useSelector)(d.Selectors.enableWebResourceSubAreas),v=Object(o.siteMapUrlSubAreasEnabled)(m.value),g=[{contentTypeName:a.SubAreaContentType.Entity,title:f("subAreaContentType.entity")},{contentTypeName:a.SubAreaContentType.Dashboard,title:f("subAreaContentType.dashboard")},{contentTypeName:a.SubAreaContentType.CustomPage,title:f("subAreaContentType.customPage")},...l.featureGates.webResourceSubAreasEnabled&&b?[{contentTypeName:a.SubAreaContentType.WebResource,title:f("subAreaContentType.webResource")}]:[],...l.featureGates.urlSubAreasEnabled&&v?[{contentTypeName:a.SubAreaContentType.Url,title:f("subAreaContentType.url")}]:[]],y=s.useMemo(()=>g.map((e,t)=>({key:e.contentTypeName,text:e.title,data:t})),[g]);return{key:"contentType",inputType:"custom",value:t,onChanged:e=>{n(null==e?void 0:e.key)},onRender:e=>s.createElement(r.VirtualizedComboBox,{label:f("propertiesPane.subAreaContentType"),placeholder:f("propertiesPane.subAreaContentTypePlaceholder"),styles:p.comboBoxStyles,calloutProps:p.comboBoxCalloutProps,options:y,selectedKey:e.value,onChange:(t,n)=>e.onChanged(n)})}}},12138:function(e,t,n){"use strict";n.r(t),n.d(t,"useSubAreaCustomPageProperty",(function(){return u}));var r=n(245),a=n(10443),o=n(12119),i=n(12005),s=n(12018),c=n(12139),l=n(12135);function u(e){var{t:t,selectedCustomPageName:n,onCustomPageChanged:u}=e,d=Object(a.useSelector)(i.Selectors.customPagesInEnvironment),p=r.useMemo(()=>Object(s.tryUnwrap)(d,[]).map((e,t)=>({key:e.name,text:Object(o.getCustomPageDefaultTitle)(e),data:t})).sort((e,t)=>e.text.localeCompare(t.text)),[d]);return{key:"customPage",inputType:"custom",value:n,onChanged:e=>{u(null==e?void 0:e.key)},onRender:e=>r.createElement(c.ClearableVirtualizedComboBox,{label:t("propertiesPane.customPage"),placeholder:t("propertiesPane.customPagePlaceholder"),clearOptionText:t("common.none"),styles:l.comboBoxStyles,calloutProps:l.comboBoxCalloutProps,options:p,selectedKey:e.value,onChange:(t,n)=>e.onChanged(n)})}}},12139:function(e,t,n){"use strict";n.r(t),n.d(t,"clearOptionKey",(function(){return s})),n.d(t,"ClearableVirtualizedComboBox",(function(){return c}));var r=n(1447),a=n(245),o=n(12135);function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var s="@CVCB/CLEAR__",c=e=>{var t=e.options;e.selectedKey&&(t=[{key:s,data:s,text:e.clearOptionText},...t]);return a.createElement(r.VirtualizedComboBox,i({},e,{options:t,onChange:(t,n)=>{var r,a;n&&n.data!==s?null===(r=e.onChange)||void 0===r||r.call(e,t,n):null===(a=e.onChange)||void 0===a||a.call(e,t,void 0)},onRenderOption:e=>a.createElement(l,e),selectedKey:e.selectedKey||s}))},l=e=>{var t=Object(o.useComboBoxOptionStyles)();return(null==e?void 0:e.data)===s?a.createElement("span",{className:t.clearOption},null==e?void 0:e.text):a.createElement("span",{className:t.option},null==e?void 0:e.text)}},12140:function(e,t,n){"use strict";n.r(t),n.d(t,"useSubAreaDashboardProperty",(function(){return p}));var r=n(1259),a=n(923),o=n(245),i=n(10443),s=n(12029),c=n(12005),l=n(12018),u=n(12139),d=n(12135);function p(e){var{selectedDashboardId:t,onDashboardChanged:n}=e,{t:p}=Object(a.useTranslation)("AppModuleDesigner"),f=Object(i.useSelector)(c.Selectors.systemDashboardsInEnvironmentSorted),m=Object(i.useSelector)(c.Selectors.interactiveDashboardsInEnvironmentSorted),b=Object(i.useSelector)(c.Selectors.powerBIDashboardsInEnvironmentSorted),v=o.useMemo(()=>{var e=Object(l.tryUnwrap)(f,[]).map((e,t)=>({key:e.id,text:e.displayName||e.id}));e.length<1&&(e=[{key:"noSystemDashboardsFound",text:p("propertiesPane.dashboardNoItemsFound"),disabled:!0}]);var t=Object(l.tryUnwrap)(m,[]).map((e,t)=>({key:e.id,text:e.displayName||e.id}));t.length<1&&(t=[{key:"noInteractiveDashboardsFound",text:p("propertiesPane.dashboardNoItemsFound"),disabled:!0}]);var n=Object(l.tryUnwrap)(b,[]).map((e,t)=>({key:e.id,text:e.displayName||e.id}));n.length<1&&(n=[{key:"noPowerBIDashboardsFound",text:p("propertiesPane.dashboardNoItemsFound"),disabled:!0}]);var a=[{key:"SystemDashboards_Divider",text:"-",itemType:r.SelectableOptionMenuItemType.Divider},{key:"SystemDashboards_Header",text:p("dashboardTypes.systemDashboardsGroupHeader"),itemType:r.SelectableOptionMenuItemType.Header},...e];return s.featureGates.interactiveAndPowerBIDashboardsEnabled&&(a.push({key:"InteractiveDashboards_Divider",text:"-",itemType:r.SelectableOptionMenuItemType.Divider}),a.push({key:"InteractiveDashboards_Header",text:p("dashboardTypes.interactiveDashboardsGroupHeader"),itemType:r.SelectableOptionMenuItemType.Header}),a.push(...t)),s.featureGates.interactiveAndPowerBIDashboardsEnabled&&(a.push({key:"PowerBIDashboards_Divider",text:"-",itemType:r.SelectableOptionMenuItemType.Divider}),a.push({key:"PowerBIDashboards_Header",text:p("dashboardTypes.powerBIDashboardsGroupHeader"),itemType:r.SelectableOptionMenuItemType.Header}),a.push(...n)),a},[f,m,b]);return{key:"dashboard",inputType:"custom",value:t,onChanged:e=>{n(null==e?void 0:e.key)},onRender:e=>o.createElement(u.ClearableVirtualizedComboBox,{label:p("propertiesPane.dashboard"),placeholder:p("propertiesPane.dashboardPlaceholder"),clearOptionText:p("common.none"),styles:d.comboBoxStyles,calloutProps:d.comboBoxCalloutProps,options:v,selectedKey:e.value,onChange:(t,n)=>e.onChanged(n)})}}},12141:function(e,t,n){"use strict";n.r(t),n.d(t,"useSubAreaEntityProperty",(function(){return l}));var r=n(245),a=n(10443),o=n(12005),i=n(12018),s=n(12139),c=n(12135);function l(e){var{t:t,selectedEntityLogicalName:n,onEntityChanged:l}=e,u=Object(a.useSelector)(o.Selectors.entitiesInEnvironment),d=r.useMemo(()=>Object(i.tryUnwrap)(u,[]).map((e,t)=>({key:e.logicalName,text:e.displayName||e.logicalName,data:t})).sort((e,t)=>e.text.localeCompare(t.text)),[u]);return{key:"entity",inputType:"custom",value:n,onChanged:e=>{l(null==e?void 0:e.key)},onRender:e=>r.createElement(s.ClearableVirtualizedComboBox,{label:t("propertiesPane.entity"),placeholder:t("propertiesPane.entityPlaceholder"),clearOptionText:t("common.none"),styles:c.comboBoxStyles,calloutProps:c.comboBoxCalloutProps,options:d,selectedKey:e.value,onChange:(t,n)=>e.onChanged(n)})}}},12142:function(e,t,n){"use strict";n.r(t),n.d(t,"IconType",(function(){return r})),n.d(t,"useSubAreaIconProperties",(function(){return m}));var r,a=n(684),o=n(1372),i=n(10308),s=n(923),c=n(245),l=n(10443),u=n(12029),d=n(12116),p=n(12143),f=n(12144);function m(e){var{t:t}=Object(s.useTranslation)("AppModuleDesigner"),[n,m]=c.useState(Object(i.isSubAreaNode)(e)&&e.VectorIcon?r.UseWebResource:r.Default),[b,v]=c.useState({image:"",displayName:""}),[g,y]=c.useState(!1),h=Object(l.useDispatch)(),S={inputType:"dropdown",key:"iconType",label:t("propertiesPane.subAreaIconTypeLabel"),value:n,options:[{key:r.Default,text:t("propertiesPane.defaultIconType")},{key:r.UseWebResource,text:t("propertiesPane.subAreaUseWebResourceIconType")}],onChanged:e=>{m(e),(()=>{v({image:"",displayName:""});h(d.Actions.updateSelectedSubAreaIcon({icon:"/_imgs/imagestrips/transparent_spacer.gif",vectorIcon:void 0}))})(),e===r.UseWebResource&&y(!0)}},O=Object(f.useWebResourceIconPicker)({siteMapNode:e,updateWebResourceIconCallback:(e,t)=>{v({image:e,displayName:t})},onDismiss:()=>y(!1)}),A={inputType:"custom",key:"webResourceIconLabel",value:b.displayName||t("propertiesPane.noSelectedWebResourceIcon"),onRender:e=>c.createElement("div",{style:p.selectedWebResourceContainerStyles},g&&O,b.image&&c.createElement("img",{src:b.image,style:p.selectedWebResourceIconStyles}),c.createElement(o.Label,{style:p.selectedWebResourceLabelStyles,title:e.value},e.value))},P={inputType:"custom",key:"webResourceIconButton",onRender:e=>c.createElement("div",{style:p.selectWebResourceIconButtonContainerStyles},c.createElement(a.DefaultButton,{text:t("propertiesPane.selectWebResourceIcon"),onClick:()=>y(!0)}))},j=[];return u.featureGates.siteMapIconsEnabled&&Object(i.isSubAreaNode)(e)&&(j.push(S),n===r.UseWebResource&&(j.push(A),j.push(P))),j}!function(e){e[e.Default=0]="Default",e[e.UseWebResource=1]="UseWebResource"}(r||(r={}))},12143:function(e,t,n){"use strict";n.r(t),n.d(t,"selectedWebResourceContainerStyles",(function(){return r})),n.d(t,"selectedWebResourceIconStyles",(function(){return a})),n.d(t,"selectedWebResourceLabelStyles",(function(){return o})),n.d(t,"selectWebResourceIconButtonContainerStyles",(function(){return i}));var r={display:"flex",height:"100%",width:"100%",marginBottom:"4px"},a={height:"22px",width:"22px",margin:"auto",marginRight:"8px"},o={flex:"1",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",fontWeight:400},i={paddingBottom:"16px"}},12144:function(e,t,n){"use strict";n.r(t),n.d(t,"useWebResourceIconPicker",(function(){return y}));var r=n(12145),a=n(923),o=n(245),i=n(10443),s=n(303),c=n(10308),l=n(12150),u=n(12151),d=n(12116),p=n(12152),f=n(12153),m=n(12031),b=n(12003),v=n(11989);function g(e,t,n,r,a,o,i){try{var s=e[o](i),c=s.value}catch(l){return void n(l)}s.done?t(c):Promise.resolve(c).then(r,a)}function y(e){var t,{siteMapNode:n,updateWebResourceIconCallback:y,onDismiss:h}=e,S=Object(f.useApolloClient)(),O=Object(m.useEnvironment)(),A=Object(s.useParams)(),{t:P}=Object(a.useTranslation)("AppModuleDesigner"),j=Object(i.useDispatch)(),E=Object(l.getNewWebResourceUrl)(null==O||null===(t=O.properties.linkedEnvironmentMetadata)||void 0===t?void 0:t.instanceUrl,A.solutionId),C=function(){var e,t=(e=function*(e){var t={eventScope:b.default,eventName:v.default.WebResourcesByNames},n=yield Object(u.getWebResourcesByNames)(S,[e],t);if(Array.isArray(n)&&n.length>0){var r=n[0],a=Object(p.createBase64SvgSrc)(r.content),o=r.displayname||r.name;y(a,o)}},function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){g(o,r,a,i,s,"next",e)}function s(e){g(o,r,a,i,s,"throw",e)}i(void 0)}))});return function(e){return t.apply(this,arguments)}}();return o.useEffect(()=>{if(Object(c.isSubAreaNode)(n)&&n.VectorIcon){var e=Object(u.getWebResourceIconNameFromFullPath)(n.VectorIcon);C(e)}},[n]),o.createElement(r.WebResourcePicker,{strings:{showMore:P("propertiesPane.webResourcePicker.showMore"),addLibrary:P("propertiesPane.webResourcePicker.title"),add:P("buttons.select"),new:P("buttons.new"),close:P("buttons.cancel"),name:P("propertiesPane.webResourcePicker.name"),displayName:P("propertiesPane.webResourcePicker.displayName"),description:P("propertiesPane.webResourcePicker.description"),searchBoxPlaceholder:P("common.search"),noSearchResults:P("propertiesPane.webResourcePicker.noSearchResults")},hiddenLibraries:[],getFirstPage:e=>Object(r.getWebResourcesByType)(S,u.webResourceSvgType,e),getNextPage:e=>Object(r.getWebResourcesByNextLink)(S,e),addLibrary:e=>{return t=e.name,n=Object(u.getWebResourceIconFullPathFromName)(t),void j(d.Actions.updateSelectedSubAreaIcon({icon:n,vectorIcon:n}));var t,n},newResourceUrl:E,onDismiss:h,setShouldFireKeyboardShortcuts:e=>{}})}},12150:function(e,t,n){"use strict";function r(e,t){if(e&&t)return"".concat(e,"main.aspx?appSolutionId=").concat(encodeURIComponent("{".concat(t,"}")),"&etc=1&pagetype=webresourceedit")}n.r(t),n.d(t,"getNewWebResourceUrl",(function(){return r}))},12151:function(e,t,n){"use strict";n.r(t),n.d(t,"webResourceHtmlType",(function(){return s})),n.d(t,"webResourceSvgType",(function(){return c})),n.d(t,"webResourcePathPrefix",(function(){return l})),n.d(t,"getWebResourceIconFullPathFromName",(function(){return u})),n.d(t,"getWebResourceIconNameFromFullPath",(function(){return d})),n.d(t,"getWebResourcesByNames",(function(){return p}));var r=n(5591),a=n(217);function o(e,t,n,r,a,o,i){try{var s=e[o](i),c=s.value}catch(l){return void n(l)}s.done?t(c):Promise.resolve(c).then(r,a)}function i(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function s(e){o(i,r,a,s,c,"next",e)}function c(e){o(i,r,a,s,c,"throw",e)}s(void 0)}))}}var s=1,c=11,l="/WebResources/";function u(e){return l+e}function d(e){return 0===e.indexOf(l)?e.slice(l.length):e}function p(e,t,n){return f.apply(this,arguments)}function f(){return(f=i((function*(e,t,n){try{var o,i=yield e.query({query:r.webResourcesByNamesQuery,variables:{names:t}});if(null===(o=i.data)||void 0===o||!o.webResourcesByNames)throw new Error("Null or undefined response.");return i.data.webResourcesByNames}catch(s){Object(a.trackErrorTrace)(n.eventScope,{eventName:n.eventName},s)}return[]}))).apply(this,arguments)}},12152:function(e,t,n){"use strict";n.r(t),n.d(t,"createBase64SvgSrc",(function(){return i}));var r=n(217),a=n(12003),o=n(11989);function i(e){if(!e)return"";if(void 0===window.atob)return Object(r.trackErrorTrace)(a.default,{eventName:o.default.ImageCreateBase64SvgSrc,eventData:{message:"atob() is not defined in the browser"}}),"";try{window.atob(e)}catch(t){return Object(r.trackWarningTrace)(a.default,{eventName:o.default.ImageCreateBase64SvgSrc,eventData:{message:"input string is not base64 encoded"}}),""}return"data:image/svg+xml;base64,".concat(e)}},12153:function(e,t,n){"use strict";n.r(t),n.d(t,"useApolloClient",(function(){return o}));var r=n(245),a=n(3144),o=()=>r.useContext(a.ApolloClientContext).environmentClient},12154:function(e,t,n){"use strict";n.r(t),n.d(t,"useSubAreaUrlProperty",(function(){return a}));var r=n(923);function a(e){var{url:t,onUrlChanged:n}=e,{t:a}=Object(r.useTranslation)("AppModuleDesigner");return{key:"subAreaUrl",inputType:"text",label:a("propertiesPane.url"),value:t,onChanged:e=>n("URL",e)}}},12155:function(e,t,n){"use strict";n.r(t),n.d(t,"useSubAreaWebResourceProperty",(function(){return p}));var r=n(5590),a=n(923),o=n(245),i=n(10309),s=n(12151),c=n(12153),l=n(12003),u=n(12139),d=n(12135);function p(e){var{url:t,onUrlChanged:n}=e,{t:p}=Object(a.useTranslation)("AppModuleDesigner"),f=Object(c.useApolloClient)(),[m,b]=o.useState([]),{loading:v,webResources:g}=Object(r.useGetWebResourcesByTypeQuery)(f,{resourceType:s.webResourceHtmlType,pageSize:0},l.default,!1),y=t?Object(i.getSubAreaWebResourceNameFromFullPath)(t):void 0;return o.useEffect(()=>{if(!v){var e=null==g?void 0:g.map(e=>({key:e.name,text:e.displayname||e.name,title:e.name}));null==e||e.sort((e,t)=>e.text.localeCompare(t.text)),b(e||[])}},[v,g]),{key:"subAreaWebResource",inputType:"custom",label:p("propertiesPane.url"),value:y,required:!0,onChanged:e=>{var t,r=null==e||null===(t=e.key)||void 0===t?void 0:t.toString(),a=r?Object(i.getSubAreaWebResourceFullPathFromName)(r):void 0;n("WebResource",a)},onRender:e=>o.createElement(u.ClearableVirtualizedComboBox,{label:p("propertiesPane.webResource"),placeholder:p("propertiesPane.webResourcePlaceholder"),clearOptionText:p("common.none"),selectedKey:e.value,options:m,allowFreeform:!1,autoComplete:"on",onChange:(t,n)=>e.onChanged(n),styles:d.comboBoxStyles,calloutProps:d.comboBoxCalloutProps})}}},12156:function(e,t,n){"use strict";var r;n.r(t),n.d(t,"SubAreaNodeFieldName",(function(){return r})),function(e){e.Id="Id",e.Title="Title",e.Entity="Entity",e.Dashboard="Dashboard",e.CustomPage="CustomPage",e.Url="Url"}(r||(r={}))},12157:function(e,t,n){"use strict";n.r(t),n.d(t,"AutomationPane",(function(){return l}));var r=n(245),a=n(10443),o=n(12158),i=n(12159),s=n(12162),c=n(11984),l=e=>{var t=Object(a.useDispatch)();return r.createElement(o.LeftPaneContainer,null,r.createElement(i.AddBpfButton,null),r.createElement(s.AddBpfCallout,{calloutTargetControlId:i.ADD_BPF_BUTTON_ID,dismissCallout:()=>{t(c.Actions.closeAddBpfUI())}}))}},12158:function(e,t,n){"use strict";n.r(t),n.d(t,"LeftPaneContainer",(function(){return s}));var r=n(1795),a=n(245),o=n.n(a),i=e=>({root:{flex:"1 1 0"}}),s=e=>o.a.createElement(r.Stack,{styles:i},e.children)},12159:function(e,t,n){"use strict";n.r(t),n.d(t,"ADD_BPF_BUTTON_ID",(function(){return u})),n.d(t,"AddBpfButton",(function(){return d}));var r=n(923),a=n(245),o=n(10443),i=n(12160),s=n.n(i),c=n(11984),l=n(12161),u="add-business-process-flow-button",d=()=>{var{t:e}=Object(r.useTranslation)("AppModuleDesigner"),t=Object(o.useDispatch)();return a.createElement(l.LeftPaneButton,{id:u,text:e("automationPane.addBpfButton"),iconProps:{imageProps:{src:s.a}},onClick:()=>{t(c.Actions.openAddBpfUI())}})}},12160:function(e,t,n){e.exports=n.p+"static/media/AddBpfIcon.ea568d21.svg"},12161:function(e,t,n){"use strict";n.r(t),n.d(t,"LeftPaneButton",(function(){return s}));var r=n(684),a=n(245),o=n.n(a),i={root:{height:32,textAlign:"left",margin:"8px 16px 8px 16px",padding:0,border:"none",backgroundColor:"transparent"}},s=e=>o.a.createElement(r.CommandBarButton,{id:e.id,text:e.text,title:e.text,iconProps:e.iconProps,menuProps:e.menuProps,onClick:e.onClick,styles:i})},12162:function(e,t,n){"use strict";n.r(t),n.d(t,"AddBpfCallout",(function(){return c}));var r=n(1259),a=n(245),o=n(10443),i=n(11984),s=n(12131),c=e=>{var{calloutTargetControlId:t,dismissCallout:n}=e,c=Object(o.useSelector)(i.Selectors.isAddBpfUIOpen);return a.createElement(s.CalloutLayout,{calloutTitleStringKey:"automationPane.addBpfCallout.title",calloutProps:{ariaLabelledBy:t,hidden:!c,target:"#".concat(t),onDismiss:n,directionalHint:r.DirectionalHint.leftCenter}})}},12163:function(e,t,n){"use strict";n.r(t),n.d(t,"BeforeUnload",(function(){return d}));var r=n(923),a=n(217),o=n(245),i=n(10443),s=n(303),c=n(12005),l=n(12003),u=n(11989),d=()=>{!function(){var e=Object(i.useSelector)(c.Selectors.documentHasChanges),t=o.useCallback(t=>{e&&(Object(a.trackInfoTrace)(l.default,{eventName:u.default.LeaveWithPendingChanges}),t.preventDefault(),t.returnValue="")},[e]);o.useEffect(()=>(window.addEventListener("beforeunload",t),()=>window.removeEventListener("beforeunload",t)),[t])}();var{t:e}=Object(r.useTranslation)("AppModuleDesigner"),t=Object(i.useSelector)(c.Selectors.documentHasChanges);return o.createElement(s.Prompt,{when:t,message:e("designer.leaveUnsavedChanges")})}},12164:function(e,t,n){"use strict";n.r(t),n.d(t,"CanvasAuthoring",(function(){return d}));var r=n(1071),a=n(922),o=n(684),i=n(890),s=n(245),c=n(10443),l=n(11984),u=n(12165),d=Object(r.withServices)(e=>{var{t:t}=e;Object(u.useCanvasAuthoringEventMonitor)();var n=Object(c.useSelector)(e=>e.ui.isCreatingCustomPageDialogOpen),r=Object(c.useDispatch)(),a=()=>r(l.Actions.dismissCreatingCustomPageDialog());return s.createElement(s.Fragment,null,s.createElement(i.Dialog,{hidden:!n,dialogContentProps:{title:t("canvasAuthoring.pendingAuthoringTitle"),subText:t("canvasAuthoring.pendingAuthoringBody"),closeButtonAriaLabel:t("addEntities.closeDialogButtonTitle"),showCloseButton:!0},onDismiss:a},s.createElement(i.DialogFooter,null,s.createElement(o.PrimaryButton,{text:t("canvasAuthoring.dismiss"),onClick:a}))))},[s.memo,Object(a.translateService)("AppModuleDesigner")])},12165:function(e,t,n){"use strict";n.r(t),n.d(t,"AuthoringPostMessageTypes",(function(){return r})),n.d(t,"useCanvasAuthoringEventMonitor",(function(){return s}));var r,a=n(245),o=n(10443),i=n(11984);function s(){var e=Object(o.useDispatch)(),t=a.useCallback(t=>{if(t.origin===location.origin){var n;try{n=JSON.parse(t.data)}catch(a){return}if(n)switch(n.type){case r.AppSaved:n.isNewApp&&e(i.Actions.createAndAddCustomPage.requestAdd(n.appToken))}}},[e]);a.useEffect(()=>(window.addEventListener("message",t),()=>window.removeEventListener("message",t)),[t])}!function(e){e.AppSaved="AppSaved",e.AppPublished="AppPublished"}(r||(r={}))},12166:function(e,t,n){"use strict";n.r(t);var r=n(3851),a=n(684),o=n(1105),i=n(1071),s=n(4135),c=n(922),l=n(245),u=n(10443),d=n(303),p=n(12167),f=n(12005),m=n(12169),b=n(11984),v=n(12173),g=n(12174),y=n(12175),h=n(12181),S=n(12184);function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function A(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach((function(t){P(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function P(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var j=Object(r.loadingButton)(a.CommandBarButton),E=Object(g.default)({appModuleId:f.Selectors.getAppModuleId,isAppSaving:b.Selectors.isAppSaving,isAppPublishing:b.Selectors.isAppPublishing,isSaveEnabled:b.Selectors.isSaveEnabled,isPublishEnabled:b.Selectors.isPublishEnabled,isPlayEnabled:b.Selectors.isPlayEnabled,appJustSuccessfullySaved:b.Selectors.appJustSuccessfullySaved,appJustSuccessfullyPublished:b.Selectors.appJustSuccessfullyPublished}),C=Object(v.default)({onAddNewPage:b.Actions.openAddPageUI,onSettings:m.Actions.showSettings,onSave:f.Actions.saveApp.request,onSwitchToClassic:b.Actions.openSwitchToClassic,onPublish:f.Actions.publishApp.request,onPreview:b.Actions.openAppPreview}),T=Object(i.withServices)(e=>{var t,n,r,a,o=A(A({},e),{},{xrmInstanceUrl:null===(t=e.currentEnvironment)||void 0===t||null===(n=t.properties)||void 0===n||null===(r=n.linkedEnvironmentMetadata)||void 0===r?void 0:r.instanceUrl,appModuleId:e.appModuleId,environmentId:null===(a=e.currentEnvironment)||void 0===a?void 0:a.name,packagingInProgress:Object(p.useIsPackagingInProgress)()}),i=Object(S.useCommands)(o),c=[...Object(h.useFrontFarPresenceCommands)(o),...Object(y.useFrontFarCommentsCommands)(o),...Object(S.useFarCommands)(o)];return l.createElement(s.Designer.CommandBar,{items:i,farItems:c,buttonAs:j})},[l.memo,Object(c.translateService)("AppModuleDesigner"),e=>Object(d.withRouter)(e),o.withEnvironment,Object(u.connect)(E,C)]);t.default=T},12167:function(e,t,n){"use strict";n.r(t),n.d(t,"PackagerMonitorContext",(function(){return o})),n.d(t,"usePackagerMonitor",(function(){return i})),n.d(t,"usePackagerMonitorStateMachine",(function(){return s})),n.d(t,"usePackagerMonitorState",(function(){return c})),n.d(t,"useIsPackagingInProgress",(function(){return l}));var r=n(245),a=n(12168),o=r.createContext(void 0);function i(){return r.useContext(o)}function s(){return i().stateMachine}function c(){var e=s(),[t,n]=r.useState(a.PackagerMonitorState.Paused);return r.useEffect(()=>{var t=e.listenForTransition(e=>n(e));return()=>t()},[e]),t}function l(){return c()===a.PackagerMonitorState.Monitoring}},12168:function(e,t,n){"use strict";var r,a;n.r(t),n.d(t,"PackagerMonitorState",(function(){return r})),n.d(t,"PackagerMonitorEvent",(function(){return a})),n.d(t,"stateTransitionMap",(function(){return s})),n.d(t,"PackagerMonitorStateMachine",(function(){return l})),function(e){e.Paused="Paused",e.Discovery="Discovery",e.Monitoring="Monitoring"}(r||(r={})),function(e){e.PublishRequested="PublishRequested",e.JobDetected="JobDetected",e.JobSucceeded="JobSucceeded",e.JobFailed="JobFailed",e.Interrupted="Interrupted"}(a||(a={}));var o=r,i=a,s={[c(o.Paused,i.PublishRequested)]:o.Discovery,[c(o.Discovery,i.JobDetected)]:o.Monitoring,[c(o.Discovery,i.JobSucceeded)]:o.Paused,[c(o.Discovery,i.JobFailed)]:o.Paused,[c(o.Discovery,i.Interrupted)]:o.Paused,[c(o.Monitoring,i.JobSucceeded)]:o.Paused,[c(o.Monitoring,i.JobFailed)]:o.Paused,[c(o.Monitoring,i.Interrupted)]:o.Paused};function c(e,t){return"".concat(e,":").concat(t)}class l{constructor(){this.currentState=void 0,this.catchAllListeners=void 0,this.stateListeners=void 0,this.currentState=o.Paused,this.catchAllListeners=[],this.stateListeners=new Map([[o.Paused,[]],[o.Discovery,[]],[o.Monitoring,[]]])}listenForState(e,t){var n;return null===(n=this.stateListeners.get(e))||void 0===n||n.push(t),()=>{var n;this.stateListeners.set(e,null===(n=this.stateListeners.get(e))||void 0===n?void 0:n.filter(e=>e!==t))}}listenForTransition(e){return this.catchAllListeners.push(e),()=>{this.catchAllListeners=this.catchAllListeners.filter(t=>t!==e)}}notify(e){var t,n,r=null!==(t=s[c(this.currentState,e)])&&void 0!==t?t:this.currentState;this.currentState!==r&&(this.currentState=r,this.catchAllListeners.forEach(t=>t(r,e)),null===(n=this.stateListeners.get(r))||void 0===n||n.forEach(e=>e()));return this.currentState}}},12169:function(e,t,n){"use strict";n.r(t);var r=n(12170);n.d(t,"Actions",(function(){return r}));var a=n(12171);n.d(t,"initialState",(function(){return a.initialState})),n.d(t,"reducer",(function(){return a.default}));var o=n(12172);n.d(t,"Selectors",(function(){return o}))},12170:function(e,t,n){"use strict";n.r(t),n.d(t,"showSettings",(function(){return i})),n.d(t,"hideSettings",(function(){return s}));var r=n(11986),a=n(11989),o=n(11988),i=Object(r.createAction)("settings/SHOW",void 0,()=>Object(o.withTelemetryEventMeta)({eventName:a.default.SettingsOpen}))(),s=Object(r.createAction)("settings/HIDE")()},12171:function(e,t,n){"use strict";n.r(t),n.d(t,"initialState",(function(){return c}));var r=n(11986),a=n(12170);function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var c={isVisible:!1},l=Object(r.createReducer)(c).handleAction(a.showSettings,e=>i(i({},e),{},{isVisible:!0})).handleAction(a.hideSettings,e=>i(i({},e),{},{isVisible:!1}));t.default=l},12172:function(e,t,n){"use strict";n.r(t),n.d(t,"isSettingsModalVisible",(function(){return r}));var r=e=>e.settings.isVisible},12173:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return a}));var r=n(9342);function a(e){return t=>Object(r.bindActionCreators)(e,t)}},12174:function(e,t,n){"use strict";function r(e){return t=>{var n=Object.keys(e),r={};for(var a of n)r[a]=e[a](t);return r}}n.r(t),n.d(t,"default",(function(){return r}))},12175:function(e,t,n){"use strict";n.r(t),n.d(t,"useFrontFarCommentsCommands",(function(){return c}));var r=n(245),a=n(10443),o=n(12029),i=n(12066),s=n(12176),c=e=>{var t=Object(a.useDispatch)(),n=Object(i.default)(),c=Object(a.useSelector)(s.Selectors.isCommentsPaneOpen),l=Object(a.useSelector)(s.Selectors.isSolutionPresent);return r.useMemo(()=>[o.featureGates.enableCommentsPane&&l&&{key:"comments",onClick:()=>{t(c?s.Actions.hideCommentsPane():s.Actions.showCommentsPane())},iconProps:{iconName:"Message"},text:e.t("commentsPane.commentsButtonTitle"),buttonStyles:{root:{"&.ms-Button.is-checked":{background:n.palette.neutralQuaternaryAlt}}},disabled:!e.appModuleId,checked:c,title:c?e.t("commentsPane.hideCommentsButtonTooltip"):e.t("commentsPane.showCommentsButtonTooltip")}].filter(e=>!!e),[e.t,e.appModuleId,c,l,n,t])}},12176:function(e,t,n){"use strict";n.r(t);var r=n(12177);n.d(t,"Actions",(function(){return r}));var a=n(12178);n.d(t,"initialState",(function(){return a.initialState})),n.d(t,"reducer",(function(){return a.default}));var o=n(12179);n.d(t,"Selectors",(function(){return o}))},12177:function(e,t,n){"use strict";n.r(t),n.d(t,"showCommentsPane",(function(){return s})),n.d(t,"hideCommentsPane",(function(){return c})),n.d(t,"setAnchorThreadCountsMap",(function(){return l})),n.d(t,"createThread",(function(){return u})),n.d(t,"paneLoaded",(function(){return d})),n.d(t,"setSolutionPresent",(function(){return p}));var r=n(11986),a=n(11987),o=n(11989),i=n(11988),s=Object(r.createAction)("app/COMMENTS_PANE/SHOW",void 0,()=>Object(i.withTelemetryEventMeta)({eventName:o.default.CommentsPaneOpen}))(),c=Object(r.createAction)("app/COMMENTS_PANE/HIDE",void 0,()=>Object(i.withTelemetryEventMeta)({eventName:o.default.CommentsPaneClose}))(),l=Object(r.createAction)("app/COMMENTS_PANE/SET_ANCHOR_THREAD_COUNT_MAP",Object(a.payload)(),void 0)(),u=Object(r.createAction)("app/COMMENTS_PANE/NEW_THREAD",void 0,()=>Object(i.withTelemetryEventMeta)({eventName:o.default.CommentsPaneNewThread}))(),d=Object(r.createAction)("app/COMMENTS_PANE/Loaded",Object(a.payload)(),e=>Object(i.withTelemetryEventMeta)({eventName:o.default.CommentsPaneLoaded,eventData:{isLoadFailed:e.isLoadFailed}}))(),p=Object(r.createAction)("app/COMMENTS_PANE/SET_SOLUTION_PRESENCE",void 0,()=>Object(i.withTelemetryEventMeta)({eventName:o.default.CommentSolutionPresent}))()},12178:function(e,t,n){"use strict";n.r(t),n.d(t,"initialState",(function(){return c}));var r=n(11986),a=n(12177);function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var c={isCommentsPaneOpen:!1,isSolutionPresent:!1,createdThreadsCount:0},l=Object(r.createReducer)(c).handleAction(a.hideCommentsPane,e=>i(i({},e),{},{isCommentsPaneOpen:!1})).handleAction(a.showCommentsPane,e=>i(i({},e),{},{isCommentsPaneOpen:!0})).handleAction(a.setAnchorThreadCountsMap,(e,t)=>i(i({},e),{},{anchorThreadCountsMap:t.payload})).handleAction(a.createThread,e=>i(i({},e),{},{createdThreadsCount:e.createdThreadsCount+1})).handleAction(a.setSolutionPresent,(e,t)=>i(i({},e),{},{isSolutionPresent:!0}));t.default=l},12179:function(e,t,n){"use strict";n.r(t),n.d(t,"commentsState",(function(){return u})),n.d(t,"isCommentsPaneOpen",(function(){return d})),n.d(t,"isSolutionPresent",(function(){return p})),n.d(t,"createdThreadsCount",(function(){return f})),n.d(t,"getAnchorThreadCountsMap",(function(){return m})),n.d(t,"selectedNodeFullPath",(function(){return b})),n.d(t,"getAllContexts",(function(){return v})),n.d(t,"isContextsLoaded",(function(){return g}));var r=n(5625),a=n(12058),o=n(10302),i=n(12005),s=n(12060),c=n(12180),l=n(12018),u=e=>e.comments,d=Object(r.createSelector)(u,e=>e.isCommentsPaneOpen),p=Object(r.createSelector)(u,e=>e.isSolutionPresent),f=Object(r.createSelector)(u,e=>e.createdThreadsCount),m=Object(r.createSelector)(u,e=>e.anchorThreadCountsMap),b=Object(r.createSelector)(s.getSelection,i.Selectors.getSiteMap,(e,t)=>{if(e){var n,r;if(Object(a.isPagesPaneSelection)(e))return Object(c.serializePageNodePath)(e.nodeType,null!==(n=null!==(r=e.relatedDashboard)&&void 0!==r?r:e.relatedEntity)&&void 0!==n?n:e.relatedCustomPage);if(Object(a.isSiteMapPaneSelection)(e)){if("loaded"!==t.loadState)return"UnknownContext";if(e.selectedNodePath&&Object(o.isNodePath)(e.selectedNodePath))return Object(c.serializeSiteMapNodePath)(e.selectedNodePath,t.value.siteMapXml);if(e.nodeType===a.SiteMapPaneNodeType.Navigation)return c.navigationItemNodePath}}return"UnknownContext"}),v=Object(r.createSelector)(i.Selectors.entitiesInApp,i.Selectors.dashboardsInApp,i.Selectors.getSiteMap,i.Selectors.customPagesInApp,(e,t,n,r)=>{var i=[c.navigationItemNodePath];if(i.push(Object(c.serializePageNodePath)(a.PagesPaneNodeType.App,void 0)),"loaded"===e.loadState&&e.value.forEach(e=>{i.push(Object(c.serializePageNodePath)(a.PagesPaneNodeType.EntityForm,e)),i.push(Object(c.serializePageNodePath)(a.PagesPaneNodeType.EntityView,e))}),"loaded"===t.loadState&&t.value.forEach(e=>{i.push(Object(c.serializePageNodePath)(a.PagesPaneNodeType.Dashboard,e))}),"loaded"===n.loadState){var s,l=null===(s=n.value)||void 0===s?void 0:s.siteMapXml,u=l.Area;null==u||u.forEach((e,t)=>{var n;i.push(Object(c.serializeSiteMapNodePath)(Object(o.nodePath)(t),l)),null===(n=e.Group)||void 0===n||n.forEach((e,n)=>{var r;i.push(Object(c.serializeSiteMapNodePath)(Object(o.nodePath)(t,n),l)),null===(r=e.SubArea)||void 0===r||r.forEach((e,r)=>{i.push(Object(c.serializeSiteMapNodePath)(Object(o.nodePath)(t,n,r),l))})})})}return"loaded"===r.loadState&&r.value.forEach(e=>{i.push(Object(c.serializePageNodePath)(a.PagesPaneNodeType.CustomPage,e))}),new Map(i.map(e=>[e,[]]))}),g=Object(r.createSelector)(i.Selectors.getAppModule,i.Selectors.entitiesInApp,i.Selectors.dashboardsInApp,i.Selectors.getSiteMap,i.Selectors.customPagesInApp,(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.every(e=>e.loadState===l.LoadStates.Loaded)}))},12180:function(e,t,n){"use strict";n.r(t),n.d(t,"serializeSiteMapNodePath",(function(){return a})),n.d(t,"serializePageNodePath",(function(){return o})),n.d(t,"navigationItemNodePath",(function(){return i})),n.d(t,"deserializePath",(function(){return s})),n.d(t,"findNavigationNode",(function(){return c}));var r=n(12058),a=(e,t)=>{var n,a=null===(n=t.Area)||void 0===n?void 0:n[e.areaIndex],o=null==a?void 0:a.Id;if(void 0!==e.groupIndex){var i,s=null==a||null===(i=a.Group)||void 0===i?void 0:i[e.groupIndex];if(o="".concat(null==s?void 0:s.Id),void 0!==e.subAreaIndex){var c,l=null==s||null===(c=s.SubArea)||void 0===c?void 0:c[e.subAreaIndex];o="".concat(null==l?void 0:l.Id)}}return"".concat(r.NodeSelectionTarget[r.NodeSelectionTarget.SiteMap],"/").concat(e.pathType,"(").concat(o,")")},o=(e,t)=>{var n=null==t?void 0:t.id,a="".concat(r.PagesPaneNodeType[e]);return n&&(a+="(".concat(n,")")),"".concat(r.NodeSelectionTarget[r.NodeSelectionTarget.Pages],"/").concat(a)},i="".concat(r.NodeSelectionTarget[r.NodeSelectionTarget.SiteMap],"/").concat(r.SiteMapPaneNodeType[r.SiteMapPaneNodeType.Navigation]),s=e=>{var t,n,a=e.split("/"),o=a[1].split("(")[1];return o=o&&o.slice(0,-1),a[0]===r.NodeSelectionTarget[0]?(t=r.NodeSelectionTarget.Pages,n=r.PagesPaneNodeType[a[1].split("(")[0]]):t=r.NodeSelectionTarget.SiteMap,{selectionTarget:t,pagesPaneNodeType:n,nodeId:o}},c=(e,t)=>{if(e&&t){var n=e.find(e=>"node"in e&&e.node.Id===t);return n||e.forEach(e=>{e.children&&(n=n||c(e.children,t))}),n}}},12181:function(e,t,n){"use strict";n.r(t),n.d(t,"useFrontFarPresenceCommands",(function(){return u}));var r=n(12182),a=n(245),o=n(10443),i=n(12029),s=n(12176),c=n(12005),l=n(12183),u=e=>{var t=Object(o.useSelector)(c.Selectors.appModuleUniqueName),n=Object(o.useSelector)(s.Selectors.selectedNodeFullPath),u=Object(l.usePresenceContext)();return a.useMemo(()=>[t&&i.featureGates.enableCoPresence&&{key:"presence",onRender:()=>a.createElement(r.PresenceIndicatorLoader,{resourceId:t,resourceType:"apps",selectedNode:n,onPresentUsersUpdated:e=>u.setPresentUsers(e)})}].filter(e=>!!e),[e.t,t,n])}},12182:function(e,t,n){"use strict";n.r(t),n.d(t,"PresenceIndicatorLoader",(function(){return i}));var r=n(1074);function a(e,t,n,r,a,o,i){try{var s=e[o](i),c=s.value}catch(l){return void n(l)}s.done?t(c):Promise.resolve(c).then(r,a)}function o(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function s(e){a(i,r,o,s,c,"next",e)}function c(e){a(i,r,o,s,c,"throw",e)}s(void 0)}))}}var i=Object(r.default)(o((function*(){var[e]=yield Promise.all([Promise.all([n.e(439),n.e(210),n.e(437),n.e(477)]).then(n.bind(null,29963))]);return e.PresenceIndicatorWrapper})))},12183:function(e,t,n){"use strict";n.r(t),n.d(t,"usePresenceContext",(function(){return a})),n.d(t,"PresenceContext",(function(){return o})),n.d(t,"PresenceContextProvider",(function(){return i}));var r=n(245);function a(){return r.useContext(o)}var o=r.createContext({presentUsers:{},setPresentUsers:e=>{}}),i=e=>{var[t,n]=r.useState({});return r.createElement(o.Provider,{value:{presentUsers:t,setPresentUsers:n}},e.children)}},12184:function(e,t,n){"use strict";n.r(t),n.d(t,"addPageButtonClassName",(function(){return a})),n.d(t,"useCommands",(function(){return o})),n.d(t,"useFarCommands",(function(){return i}));var r=n(245),a="CommandBar-AddPageButton";function o(e){var{appModuleId:t,onAddNewPage:n,onSettings:o,onSwitchToClassic:i,t:s,tReady:c,xrmInstanceUrl:l}=e;return r.useMemo(()=>[{key:"add-new-page",text:s("commands.addNewPage"),iconProps:{iconName:"Add"},onClick:n,disabled:!t,className:a},{key:"settings",text:s("commands.settings"),iconProps:{iconName:"Settings"},onClick:o},{key:"switch-to-classic",text:s("commands.switchToClassic"),iconProps:{iconName:"OpenInNewWindow"},disabled:!l||!t,onClick:i}].filter(e=>!!e),[t,n,o,i,s,c,l])}function i(e){var{isAppSaving:t,isAppPublishing:n,isSaveEnabled:a,isPlayEnabled:o,isPublishEnabled:i,appJustSuccessfullySaved:s,appJustSuccessfullyPublished:c,packagingInProgress:l,onSave:u,onPublish:d,onPreview:p,t:f,tReady:m}=e;return r.useMemo(()=>[{key:"save",text:f(s?"commands.saved":"commands.save"),iconProps:{iconName:s?"CheckMark":"Save"},disabled:!a,loading:t,onClick:u},{key:"publish",text:f(c?"commands.published":"commands.publish"),title:f("commands.saveAndPublish"),iconProps:{iconName:c?"CheckMark":"WebPublish"},disabled:!i||!!l,loading:n||!!l,onClick:d,className:"cds-app-module-designer-commandbar-publish"},{key:"play",text:f("commands.play"),iconProps:{iconName:"Play"},disabled:!o,onClick:p,className:"cds-app-module-designer-commandbar-play"}],[t,n,a,o,i,s,c,l,u,d,p,f,m])}},12185:function(e,t,n){"use strict";n.r(t),n.d(t,"CommentsPane",(function(){return T}));var r=n(12186),a=n(4154),o=n(923),i=n(245),s=n(10443),c=n(1878),l=n(12029),u=n(12058),d=n(12176),p=n(12180),f=n(12005),m=n(12190),b=n(11984),v=n(12004),g=n(11995),y=n(12195),h=n(12198),S=n(12220),O=n(12221);function A(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function P(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?A(Object(n),!0).forEach((function(t){j(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):A(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function j(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function E(e,t,n,r,a,o,i){try{var s=e[o](i),c=s.value}catch(l){return void n(l)}s.done?t(c):Promise.resolve(c).then(r,a)}function C(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){E(o,r,a,i,s,"next",e)}function s(e){E(o,r,a,i,s,"throw",e)}i(void 0)}))}}var T=()=>{var{t:e}=Object(o.useTranslation)("AppModuleDesigner"),t=Object(s.useSelector)(f.Selectors.getAppModuleId),n=Object(s.useSelector)(d.Selectors.isContextsLoaded),A=Object(s.useSelector)(d.Selectors.selectedNodeFullPath),j=Object(s.useSelector)(d.Selectors.isCommentsPaneOpen),E=Object(s.useSelector)(d.Selectors.getAllContexts),T=Object(s.useSelector)(d.Selectors.createdThreadsCount),M=Object(s.useSelector)(b.Selectors.isSaveEnabled),w=Object(s.useSelector)(b.Selectors.isAppSaving),I=Object(s.useDispatch)(),N=i.useRef(),D=i.useRef(),[x,k]=i.useState(),[R,L]=i.useState();i.useEffect(()=>{var e;null===(e=N.current)||void 0===e||e.call(N,r.EventName.CreateThread)},[T]),i.useEffect(()=>{if(!w){var e,t;if(null===(e=D.current)||void 0===e||!e.isSettled)null===(t=D.current)||void 0===t||t.resolve();D.current=void 0}},[w]);var[U]=Object(y.usePagesPaneTreeItems)(""),B=Object(s.useSelector)(f.Selectors.getSiteMap),[F]=Object(h.useSiteMapTreeItems)(B,"",void 0,e);return n?i.createElement(i.Fragment,null,i.createElement(S.GrantUserAccessDialog,{deferred:x}),i.createElement(c.Fill,{name:a.RightPaneSlotName},i.createElement(r.CommentsPaneLoader,{getCommentDeepLinkTemplate:l.featureGates.enableCommentsPaneAtMentions?(e,t)=>{var n=new URL(Object(g.getCurrentUrl)());return n.hash="commentId=".concat(e,"&anchorId=").concat(t),n.href}:void 0,isCommentsPaneOpen:j,onDismiss:()=>{I(d.Actions.hideCommentsPane())},onPaneLoaded:e=>{I(d.Actions.paneLoaded({isLoadFailed:e})),e||(()=>{var e,t=new URL(Object(g.getCurrentUrl)());if(t.hash){var n=new URLSearchParams(t.hash.substring(1)),r=n.get("commentId"),a=n.get("anchorId");if(!a||!r)return;L(r);var{selectionTarget:o,pagesPaneNodeType:i,nodeId:s}=Object(p.deserializePath)(a);if(o===u.NodeSelectionTarget.Pages&&void 0!==i){var c,l,f,m=U.find(e=>e.key===s);if(!m)return;switch(m.nodeType){case u.PagesPaneNodeType.Entity:(m=null===(e=m.children)||void 0===e?void 0:e.find(e=>e.nodeType===i))&&m.entity&&(c=m.entity);break;case u.PagesPaneNodeType.Dashboard:m.dashboard&&(l=m.dashboard);break;case u.PagesPaneNodeType.CustomPage:m.customPage&&(f=m.customPage)}m&&(I(b.Actions.selectPagesNode({nodeKey:m.key,nodeType:i,relatedEntity:c,relatedDashboard:l,relatedCustomPage:f})),!j&&I(d.Actions.showCommentsPane()))}else if(o===u.NodeSelectionTarget.SiteMap){if(s){var v=Object(p.findNavigationNode)(F,s);v&&"path"in v&&I(b.Actions.selectSiteMapNode({nodeType:u.SiteMapPaneNodeType.SiteMapNode,selectedNodePath:v.path}))}else I(b.Actions.selectSiteMapNode({nodeType:u.SiteMapPaneNodeType.Navigation}));!j&&I(d.Actions.showCommentsPane())}}})()},artifactId:t,artifactType:r.ArtifactType.ModernAppDesigner,isArtifactInDataVerse:!0,selectedAnchor:A,selectedCommentId:R,onAnchorThreadCountsMapUpdated:e=>{I(d.Actions.setAnchorThreadCountsMap(e))},activeContextId:A,contexts:E,eventDispatcherProvider:e=>N.current=e,onCommentCreated:C((function*(){if(M)return I(f.Actions.saveApp.request()),D.current&&!D.current.isSettled||(D.current=Object(v.getDeferredPromise)()),D.current})),onSolutionPresent:()=>{I(d.Actions.setSolutionPresent())},localizedStrings:e("commentsPane.sharedPaneOverrides",{returnObjects:!0}),onError:t=>{if(!r.HostErrorCode.MentionedUserWithoutAccess){var n=e("commentsPane.genericError");-1!==[r.HostErrorCode.MissingCreatePermission,r.HostErrorCode.MissingDeletePermission,r.HostErrorCode.MissingReadPermission,r.HostErrorCode.MissingWritePermission].indexOf(t.errorCode)&&(n=e("commentsPane.missingPrivilegeToUseComments")),I(m.Actions.addError({error:P(P({},t),{},{message:n}),sourceActionType:"comment error"}))}},isAtMentionsEnabled:l.featureGates.enableCommentsPaneAtMentions,grantUsersAccess:e=>{if(e.length>0){var t=Object(v.getDeferredPromise)();return k(t),t.then(t=>(k(void 0),e.map(e=>P(P({},e),{},{status:t===S.GrantUsersAccessResult.Cancel?r.UserAccessResponseStatus.Failed:r.UserAccessResponseStatus.Success}))))}return Promise.resolve([])}}),i.createElement(O.ScrollbarFix,null))):i.createElement(i.Fragment,null)}},12186:function(e,t,n){"use strict";n.r(t),n.d(t,"CommentsPaneLoader",(function(){return u}));var r=n(1074),a=n(922),o=n(12187);n.d(t,"ArtifactType",(function(){return o.ArtifactType})),n.d(t,"EventName",(function(){return o.EventName})),n.d(t,"LokiDomain",(function(){return o.LokiDomain}));var i=n(12188);n.d(t,"HostErrorCode",(function(){return i.HostErrorCode}));var s=n(12189);function c(e,t,n,r,a,o,i){try{var s=e[o](i),c=s.value}catch(l){return void n(l)}s.done?t(c):Promise.resolve(c).then(r,a)}function l(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){c(o,r,a,i,s,"next",e)}function s(e){c(o,r,a,i,s,"throw",e)}i(void 0)}))}}n.d(t,"UserAccessResponseStatus",(function(){return s.UserAccessResponseStatus}));var u=Object(r.default)(l((function*(){var[e]=yield Promise.all([Promise.all([n.e(400),n.e(211),n.e(438)]).then(n.bind(null,29982)),Object(a.loadNamespaces)(["DataVerseCommentsPane"])]);return e.CommentsPaneWrapper})))},12187:function(e,t,n){"use strict";var r,a,o,i,s,c,l,u;n.r(t),n.d(t,"CommentKind",(function(){return r})),n.d(t,"CommentState",(function(){return a})),n.d(t,"EventName",(function(){return o})),n.d(t,"PaneLoadErrorCodes",(function(){return i})),n.d(t,"ArtifactType",(function(){return s})),n.d(t,"StatusCode",(function(){return c})),n.d(t,"StateCode",(function(){return l})),n.d(t,"LokiDomain",(function(){return u})),function(e){e[e.Container=0]="Container",e[e.Thread=1]="Thread",e[e.Reply=2]="Reply"}(r||(r={})),function(e){e[e.Open=0]="Open",e[e.Resolved=1]="Resolved"}(a||(a={})),function(e){e.CreateThread="CreateThread",e.DeselectThread="DeselectThread"}(o||(o={})),function(e){e[e.SolutionNotInstalled=0]="SolutionNotInstalled"}(i||(i={})),function(e){e[e.Flow=0]="Flow",e[e.CanvasApp=1]="CanvasApp",e[e.BotComponent=2]="BotComponent",e[e.ModernAppDesigner=3]="ModernAppDesigner",e[e.Bot=4]="Bot",e[e.Undefined=99]="Undefined"}(s||(s={})),function(e){e[e.Active=1]="Active",e[e.Inactive=2]="Inactive"}(c||(c={})),function(e){e[e.Active=0]="Active",e[e.Inactive=1]="Inactive"}(l||(l={})),function(e){e.Dogfood="Df",e.MSIT="Msit",e.Blackforest="Blackforest",e.GccModerate="GccModerate",e.GccHigh="GccHigh",e.DOD="DoD",e.Gallatin="Gallatin",e.TopLevel="Prod",e.AG08="AG08",e.AG09="AG09"}(u||(u={}))},12188:function(e,t,n){"use strict";var r;n.r(t),n.d(t,"HostErrorCode",(function(){return r})),function(e){e.MissingWritePermission="MissingWritePermission",e.MissingReadPermission="MissingReadPermission",e.MissingDeletePermission="MissingDeletePermission",e.MissingCreatePermission="MissingCreatePermission",e.MentionedUserWithoutAccess="MentionedUserWithoutAccess",e.FeatureNotEnabled="FeatureNotEnabled"}(r||(r={}))},12189:function(e,t,n){"use strict";var r;n.r(t),n.d(t,"UserAccessResponseStatus",(function(){return r})),function(e){e.Success="Success",e.CannotGrantPermission="CannotGrantPermission",e.UserDoesNotExist="UserDoesNotExist",e.Failed="Failed"}(r||(r={}))},12190:function(e,t,n){"use strict";n.r(t);var r=n(12191);n.d(t,"Actions",(function(){return r}));var a=n(12192);n.d(t,"makeMiddleware",(function(){return a.default}));var o=n(12193);n.d(t,"initialState",(function(){return o.initialState})),n.d(t,"reducer",(function(){return o.default}));var i=n(12194);n.d(t,"Selectors",(function(){return i}))},12191:function(e,t,n){"use strict";n.r(t),n.d(t,"addError",(function(){return o})),n.d(t,"clearLatestError",(function(){return i}));var r=n(11986),a=n(11987),o=Object(r.createAction)("error/ADD",Object(a.payload)())(),i=Object(r.createAction)("error/CLEAR_LATEST")()},12192:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return a}));var r=n(12191);function a(e){return e=>t=>n=>{var a=t(n),o=null==n?void 0:n.payload;return o instanceof Error&&e.dispatch(r.addError({error:o,sourceActionType:n.type})),Promise.resolve(a)}}},12193:function(e,t,n){"use strict";n.r(t),n.d(t,"initialState",(function(){return l}));var r=n(11986),a=n(12191),o=n(12005);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var l={actionErrors:[]},u=Object(r.createReducer)(l).handleAction(a.addError,(e,t)=>s(s({},e),{},{actionErrors:e.actionErrors.concat(t.payload)})).handleAction(a.clearLatestError,e=>s(s({},e),{},{actionErrors:e.actionErrors.slice(0,e.actionErrors.length-1)})).handleAction(o.Actions.createApp.success,e=>s(s({},e),{},{actionErrors:[]}));t.default=u},12194:function(e,t,n){"use strict";n.r(t),n.d(t,"getActionErrors",(function(){return r}));var r=e=>e.errors.actionErrors},12195:function(e,t,n){"use strict";n.r(t),n.d(t,"usePagesPaneTreeItems",(function(){return p}));var r=n(12059),a=n(10297),o=n(923),i=n(245),s=n(10443),c=n(12058),l=n(12005),u=n(12196),d=n(12018);function p(e){var{t:t}=Object(o.useTranslation)("AppModuleDesigner"),n=Object(s.useSelector)(l.Selectors.entitiesInAppSorted),p=Object(s.useSelector)(l.Selectors.dashboardsInAppSorted),f=Object(s.useSelector)(l.Selectors.customPagesInAppSorted),m=Object(s.useSelector)(u.Selectors.pagesPaneExpandedItems);e=e.toLowerCase();var b=i.useCallback(t=>{if(!Object(a.isBlank)(e)){var n=t.toLowerCase().indexOf(e);return n>=0?{startIndex:n,length:e.length}:void 0}},[e]),v=i.useMemo(()=>{var a=Object(d.tryUnwrap)(n,[]),o=[];for(var i of a){var s=i.displayName||i.logicalName,l=b(s);(!e||l)&&o.push({key:i.id,label:s,nodeType:c.PagesPaneNodeType.Entity,entity:i,highlight:l,children:[{key:Object(r.makeEntityFormKey)(i.id),label:t("pagesPane.entityFormLinkTitle",{entity:s}),nodeType:c.PagesPaneNodeType.EntityForm,entity:i,highlight:l,iconProps:{iconName:"TextDocument"},children:void 0},{key:Object(r.makeEntityViewKey)(i.id),label:t("pagesPane.entityViewLinkTitle",{entity:s}),nodeType:c.PagesPaneNodeType.EntityView,entity:i,highlight:l,iconProps:{iconName:"Table"},children:void 0}]})}return o},[n,e,t]),[g,y]=i.useMemo(()=>{var n=Object(d.tryUnwrap)(p,[]),a=[];for(var o of n){var i=o.displayName||o.id,s=b(i);(!e||s)&&a.push({key:o.id,label:i,dashboard:o,highlight:s,nodeType:c.PagesPaneNodeType.Dashboard,iconProps:{iconName:"ViewDashboard"},children:void 0})}if(a.length<=0)return[[],m];var l={key:r.dashboardsHeaderKey,iconProps:{iconName:"ViewDashboard"},label:t("pagesPane.dashboardsGroup"),nodeType:c.PagesPaneNodeType.DashboardHeader,children:a},u=new Set(m);return e&&u.add(l.key),[l,u]},[p,m,e,t]),h=i.useMemo(()=>{var t=Object(d.tryUnwrap)(f,[]),n=[];for(var r of t){var a=r.displayName||r.name,o=b(a);(!e||o)&&n.push({key:r.id,label:a,customPage:r,highlight:o,nodeType:c.PagesPaneNodeType.CustomPage,iconProps:{iconName:"Page"},children:void 0})}return n.length<=0?[]:n},[f,m,e,t]);return[[{key:r.appNodeKey,label:t("pagesPane.appNode"),iconProps:{iconName:"AppIconDefault"},nodeType:c.PagesPaneNodeType.App}].concat(v).concat(g).concat(h),y]}},12196:function(e,t,n){"use strict";n.r(t);var r=n(12197);n.d(t,"Selectors",(function(){return r}))},12197:function(e,t,n){"use strict";n.r(t),n.d(t,"selectedPagesNode",(function(){return i})),n.d(t,"pagesPaneExpandedItems",(function(){return s})),n.d(t,"enabledViewComponentsForSelectedEntityPageNode",(function(){return c})),n.d(t,"enabledChartComponentsForSelectedEntityPageNode",(function(){return l})),n.d(t,"enabledFormComponentsForSelectedEntityPageNode",(function(){return u}));var r=n(5625),a=n(12058),o=n(12005),i=e=>Object(a.isPagesPaneSelection)(e.ui.selection)?e.ui.selection:void 0,s=e=>e.ui.pagesPaneExpandedItemKeys,c=Object(r.createSelector)(i,o.Selectors.appModuleEntityComponentById,(e,t)=>{if(null==e||!e.relatedEntity)return[];var n=t(e.relatedEntity.id);return n?n.views:[]}),l=Object(r.createSelector)(i,o.Selectors.appModuleEntityComponentById,(e,t)=>{if(null==e||!e.relatedEntity)return[];var n=t(e.relatedEntity.id);return n?n.chartIds:[]}),u=Object(r.createSelector)(i,o.Selectors.appModuleEntityComponentById,(e,t)=>{if(null==e||!e.relatedEntity)return[];var n=t(e.relatedEntity.id);return n?n.forms:[]})},12198:function(e,t,n){"use strict";n.r(t),n.d(t,"useSiteMapTreeItems",(function(){return b}));var r=n(245),a=n(10443),o=n(12199),i=n(12151),s=n(10302),c=n(12116),l=n(12018),u=n(12152),d=n(12031),p=n(10297),f=n(12200),m={image:{height:"100%",width:"100%"}};function b(e,t,n,b){var v=Object(a.useSelector)(c.Selectors.siteMapPaneExpandedItems),g=Object(a.useSelector)(c.Selectors.getNodeSoftTitleHelper),y=Object(o.areSiteMapAreasEnabled)(e.value),h=Object(d.useEnvironmentLanguageCode)();t=t.toLowerCase();var S=r.useCallback(e=>{if(!Object(p.isBlank)(t)){var n=e.toLowerCase().indexOf(t);return n>=0?{startIndex:n,length:t.length}:void 0}},[t]);return r.useMemo(()=>{var r;if(e.loadState!==l.LoadStates.Loaded)return[[],v];var a=new Set(v),o=[];(null!==(r=e.value.siteMapXml.Area)&&void 0!==r?r:[]).forEach((e,r)=>{var c,l=[];(null!==(c=e.Group)&&void 0!==c?c:[]).forEach((e,o)=>{var c,d=[];(null!==(c=e.SubArea)&&void 0!==c?c:[]).forEach((e,a)=>{var c=g(e,b,h),l=S(c),p=!t||l,v=e.VectorIcon&&Object(i.getWebResourceIconNameFromFullPath)(e.VectorIcon),y=v&&n&&n.get(v),O=Object(u.createBase64SvgSrc)(y&&y.content),A={node:e,path:Object(s.nodePath)(r,o,a),key:Object(f.makeItemKey)(r,o,a),label:c,highlight:l,iconProps:{imageProps:{src:O,styles:m}}};p&&d.push(A)});var p=g(e,b,h),v=S(p),y=!t||v,O={node:e,path:Object(s.nodePath)(r,o),key:Object(f.makeItemKey)(r,o),label:p,highlight:v,children:d};(d.length>0||y)&&l.push(O),d.length>0&&t&&a.add(O.key)});var d=g(e,b,h),p=S(d),v=!t||p,y={node:e,path:Object(s.nodePath)(r),key:Object(f.makeItemKey)(r),label:d,highlight:p,children:l};(l.length>0||v)&&o.push(y),l.length>0&&t&&a.add(y.key)});var c=o;return y||(c=c.length>0?c[0].children:[]),c.unshift({key:f.NAVIGATION_KEY,label:b("navigation.navigationBar"),iconProps:{iconName:"BulletedList"},isNavigation:!0}),[c,a]},[v,g,h,S,e,t,n,b])}},12199:function(e,t,n){"use strict";n.r(t),n.d(t,"haveMultipleAreasInSiteMap",(function(){return r})),n.d(t,"areSiteMapAreasEnabled",(function(){return a}));var r=e=>!!e&&(void 0!==e.siteMapXml.Area&&e.siteMapXml.Area.length>1),a=e=>!!e&&(r(e)||!!e.enableAreas)},12200:function(e,t,n){"use strict";n.r(t),n.d(t,"NAVIGATION_KEY",(function(){return E})),n.d(t,"SiteMapPane",(function(){return C})),n.d(t,"makeItemKey",(function(){return M}));var r=n(10298),a=n(923),o=n(245),i=n(10443),s=n(12029),c=n(12058),l=n(12005),u=n(12116),d=n(11984),p=n(12018),f=n(12084),m=n(12201),b=n(12158),v=n(12205),g=n(12206),y=n(12208),h=n(12209),S=n(12211),O=n(12202),A=n(12212),P=n(12198),j=n(12213),E="navigation",C=()=>{var[e,t]=o.useState("");return o.createElement(b.LeftPaneContainer,null,o.createElement(g.NavSearchBox,{searchText:e,onSearchTextChange:(e,n)=>t(null!=n?n:"")}),o.createElement(v.LeftPaneItemWithSeparator,null,o.createElement(S.AddSiteMapNodeButton,null)),o.createElement(T,{search:e}))},T=e=>{var{search:t}=e,{t:n}=Object(a.useTranslation)("AppModuleDesigner"),b=Object(i.useSelector)(l.Selectors.getSiteMap),v=Object(i.useSelector)(u.Selectors.selectedSiteMapNodePath),g=Object(i.useSelector)(u.Selectors.selectedSiteMapNodeType),S=Object(i.useSelector)(u.Selectors.siteMapPaneExpandedItems),C=Object(i.useDispatch)(),[T,w]=o.useState(void 0);function I(e){C(d.Actions.selectSiteMapNode({nodeType:c.SiteMapPaneNodeType.SiteMapNode,selectedNodePath:e}))}function N(e){var t,n,a=e.node,o=e.path,i=a.Type===r.default.Area&&(null===(t=a.Group)||void 0===t?void 0:t.length),s=a.Type===r.default.Group&&(null===(n=a.SubArea)||void 0===n?void 0:n.length);C(i||s?d.Actions.removeSiteMapNodeDialog.open(e):l.App.Actions.deleteNode(o))}var D=o.useCallback(e=>{var t=e;Object(O.isNavigationItem)(t)?C(d.Actions.selectSiteMapNode({nodeType:c.SiteMapPaneNodeType.Navigation})):I(t.path)},[I]);function x(e){C(d.Actions.updateSiteMapPaneExpandedItemKeys(e))}var k=o.useMemo(()=>{var e=new Set;v?(e.add(M(v.areaIndex,v.groupIndex,v.subAreaIndex)),x(function(e){var t=new Set(S);return t.add(M(e.areaIndex)),void 0!==e.groupIndex&&t.add(M(e.areaIndex,e.groupIndex)),void 0!==e.subAreaIndex&&t.add(M(e.areaIndex,e.groupIndex,e.subAreaIndex)),t}(v))):g===c.SiteMapPaneNodeType.Navigation&&e.add(E);return e},[v,g]),R=o.useCallback(e=>!Object(O.isNavigationItem)(e),[]),L=o.useCallback(e=>Object(O.isNodeInfo)(e)?[{key:"moveUp",text:n("navigation.moveUp"),iconProps:{iconName:"up"},onClick:()=>{return t=e.node,n=e.path,void C(l.App.Actions.moveNodeUp({node:t,path:n}));var t,n}},{key:"moveDown",text:n("navigation.moveDown"),iconProps:{iconName:"down"},onClick:()=>{return t=e.node,n=e.path,void C(l.App.Actions.moveNodeDown({node:t,path:n}));var t,n}},{key:"delete",text:n("commands.removeItemWithTitle",{title:e.label}),iconProps:{iconName:"delete"},onClick:()=>N(e)}]:[],[N,n]);Object(A.useSiteMapIconsMap)(b,e=>w(e));var[U,B]=Object(P.useSiteMapTreeItems)(b,t,T,n),F=Object(m.useRenderSiteMapCommentsThreadCount)(),V=Object(j.useRenderSiteMapPanePresenceIndicator)();return b.loadState!==p.LoadStates.Loaded?o.createElement(f.BulletedListShimmer,null):o.createElement(h.NavTreeView,{navTreeViewKey:"siteMapPaneTreeView",selectedItemKeys:k,items:U,getItemHasCommands:R,getItemCommands:L,onItemSelected:D,onRenderItemLabelContent:y.renderHighlightTreeLabel,onRenderItemLabel:s.featureGates.enableCommentsPane||s.featureGates.enableCoPresence?(e,t,n,r,a)=>o.createElement(o.Fragment,null,a(),s.featureGates.enableCoPresence&&V(e),s.featureGates.enableCommentsPane&&F(e)):void 0,expandedItemKeys:B,onExpandedItemsChanged:x})};function M(e,t,n){var r="".concat(e);return void 0!==t&&(r+=".".concat(t),void 0!==n&&(r+=".".concat(n))),r}},12201:function(e,t,n){"use strict";n.r(t),n.d(t,"useRenderSiteMapCommentsThreadCount",(function(){return d}));var r=n(245),a=n.n(r),o=n(10443),i=n(12176),s=n(12180),c=n(12005),l=n(12202),u=n(12203);function d(){var e=Object(o.useSelector)(i.Selectors.getAnchorThreadCountsMap),t=Object(o.useSelector)(c.Selectors.getSiteMap);return n=>{var r,o,i=null===(r=t.value)||void 0===r?void 0:r.siteMapXml;if(i){var c=n;Object(l.isNodeInfo)(c)?o=Object(s.serializeSiteMapNodePath)(c.path,i):Object(l.isNavigationItem)(n)&&(o=s.navigationItemNodePath)}var d=void 0!==o?null==e?void 0:e.get(o):0;return void 0!==d&&d>0?a.a.createElement(u.CommentsIndicator,{commentsCount:d}):a.a.createElement(a.a.Fragment,null)}}},12202:function(e,t,n){"use strict";function r(e){return!!e.isNavigation}function a(e){return!!e.node}n.r(t),n.d(t,"isNavigationItem",(function(){return r})),n.d(t,"isNodeInfo",(function(){return a}))},12203:function(e,t,n){"use strict";n.r(t),n.d(t,"CommentsIndicator",(function(){return u}));var r=n(1259),a=n(245),o=n(12204),i=n(1837),s=n(10443),c=n(12176),l=n(923),u=e=>{var{commentsCount:t}=e,{t:n}=Object(l.useTranslation)("AppModuleDesigner"),u=Object(s.useDispatch)();return a.createElement(r.TooltipHost,{content:"".concat(n("commentsPane.commentsCountTooltip",{count:t}))},a.createElement(r.ActionButton,{onClick:()=>u(c.Actions.showCommentsPane()),styles:o.actionButtonStyles,iconProps:{iconName:"ChatSolid"}},a.createElement(r.Stack,{styles:o.commentCountStackStyles},a.createElement(i.Text,{styles:o.commentCountTextStyles},t>99?"99+":t))))}},12204:function(e,t,n){"use strict";n.r(t),n.d(t,"actionButtonStyles",(function(){return o})),n.d(t,"commentCountStackStyles",(function(){return i})),n.d(t,"commentCountTextStyles",(function(){return s}));var r=n(719),a={color:Object(r.getTheme)().palette.neutralSecondary},o={root:{cursor:"pointer"},icon:a,iconHovered:a,iconPressed:a},i=(e,t)=>({root:{position:"absolute",top:10,width:16,height:16,margin:"0 4px"}}),s=(e,t)=>({root:{margin:"auto",paddingBottom:"2px",fontSize:8,color:t.palette.neutralLight,fontWeight:r.FontWeights.semibold}})},12205:function(e,t,n){"use strict";n.r(t),n.d(t,"LeftPaneItemWithSeparator",(function(){return s}));var r=n(1795),a=n(245),o=n.n(a),i=(e,t)=>({root:{borderBottom:"1px solid ".concat(t.palette.neutralQuaternary)}}),s=e=>o.a.createElement(r.Stack.Item,{styles:i},e.children)},12206:function(e,t,n){"use strict";n.r(t),n.d(t,"NavSearchBox",(function(){return l}));var r=n(5117),a=n(12207),o=n(245),i=n.n(o),s=n(923);function c(){return(c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var l=e=>{var{t:t}=Object(s.useTranslation)("AppModuleDesigner");return i.a.createElement(r.FilterSearchBox,c({strings:{searchBoxPlaceholder:t("searchBox.placeholder")},filterCalloutMatchComponentWidth:!1,styles:a.searchBoxStyles},e))}},12207:function(e,t,n){"use strict";n.r(t),n.d(t,"searchBoxStyles",(function(){return r}));var r=e=>{var{theme:t}=e;return{root:{margin:"8px 16px 0",width:"calc(100% - 32px)",background:t.palette.white},searchBox:{width:"164px"},filterButtonRoot:{backgroundColor:"transparent",minWidth:"64px"}}}},12208:function(e,t,n){"use strict";n.r(t),n.d(t,"renderHighlightTreeLabel",(function(){return o})),n.d(t,"HighlightTreeLabel",(function(){return i}));var r=n(9670),a=n(245);function o(e){var{label:t,highlight:n}=e;return a.createElement(i,{label:t,highlight:n})}var i=e=>{var{label:t,highlight:n}=e;return n?a.createElement(r.HighlightedText,{text:t,highlights:[n],labels:{beginHighlightedText:"",endHighlightedText:""}}):a.createElement(a.Fragment,null,t)}},12209:function(e,t,n){"use strict";n.r(t),n.d(t,"NavTreeView",(function(){return u}));var r=n(5185),a=n(245),o=n.n(a),i=n(12210),s=["navTreeViewKey","items","expandedItemKeys","onExpandedItemsChanged"];function c(){return(c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function l(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var u=e=>{var{navTreeViewKey:t,items:n,expandedItemKeys:a,onExpandedItemsChanged:u}=e,d=l(e,s);return o.a.createElement(r.TreeView,c({key:t},d,{items:n,nodeHeight:36,strings:{listAriaLabel:"list",moreCommandsAriaLabel:"more"},styles:i.treeViewStyles,expandedItemKeys:a,onItemExpand:e=>{var t=new Set(a);t.add(e.key),u(t)},onItemCollapse:e=>{var t=new Set(a);t.delete(e.key),u(t)}}))}},12210:function(e,t,n){"use strict";n.r(t),n.d(t,"treeViewStyles",(function(){return r}));var r={noExpandIcon:{width:0},scrollView:{overflowX:"hidden"},list:{width:"100%"},item:["NavTreeViewItem",{paddingLeft:"12px"}],itemLabel:{overflow:"hidden",textOverflow:"ellipsis"}}},12211:function(e,t,n){"use strict";n.r(t),n.d(t,"AddSiteMapNodeButton",(function(){return d}));var r=n(12199),a=n(923),o=n(245),i=n(10443),s=n(12005),c=n(12116),l=n(11984),u=n(12161),d=()=>{var e=Object(i.useSelector)(s.Selectors.getSiteMap),t=Object(r.areSiteMapAreasEnabled)(e.value),{t:n}=Object(a.useTranslation)("AppModuleDesigner"),d=Object(i.useDispatch)();var p=[{key:"group",text:n("navigation.group"),iconProps:{iconName:"RowsGroup"},onClick:function(){d(c.Actions.insertGroupNode())}},{key:"subArea",text:n("navigation.subArea"),iconProps:{iconName:"Globe"},onClick:function(){d(l.Actions.openAddSubAreaUI())}}];return t&&p.unshift({key:"area",text:n("navigation.area"),iconProps:{iconName:"ArrangeBringForward"},onClick:function(){d(c.Actions.insertAreaNode())}}),o.createElement(u.LeftPaneButton,{text:n("navigation.add"),iconProps:{iconName:"Add"},menuProps:{items:p}})}},12212:function(e,t,n){"use strict";n.r(t),n.d(t,"useSiteMapIconsMap",(function(){return l}));var r=n(245),a=n(12151),o=n(12018),i=n(12153),s=n(12003),c=n(11989);function l(e,t){var n=Object(i.useApolloClient)();r.useEffect(()=>{var r;if(e.loadState===o.LoadStates.Loaded){var i=[];if((null!==(r=e.value.siteMapXml.Area)&&void 0!==r?r:[]).forEach(e=>{var t;(null!==(t=e.Group)&&void 0!==t?t:[]).forEach(e=>{var t;(null!==(t=e.SubArea)&&void 0!==t?t:[]).forEach(e=>{e.VectorIcon&&i.push(Object(a.getWebResourceIconNameFromFullPath)(e.VectorIcon))})})}),i.length<1)t(void 0);else{var l={eventScope:s.default,eventName:c.default.WebResourcesByNames};Object(a.getWebResourcesByNames)(n,i,l).then(e=>{var n=e.reduce((e,t)=>(e.set(t.name,t),e),new Map);t(n)})}}else t(void 0)},[e])}},12213:function(e,t,n){"use strict";n.r(t),n.d(t,"useRenderPagesPanePresenceIndicator",(function(){return v})),n.d(t,"useRenderSiteMapPanePresenceIndicator",(function(){return g}));var r=n(12214),a=n(1259),o=n(245),i=n(10443),s=n(12058),c=n(12180),l=n(12005),u=n(12202),d=n(12183),p=n(923);function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){b(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function b(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function v(){var e,t=null===(e=Object(d.usePresenceContext)())||void 0===e?void 0:e.presentUsers;return e=>{var n=e;if(void 0!==n.nodeType&&[s.PagesPaneNodeType.App,s.PagesPaneNodeType.CustomPage,s.PagesPaneNodeType.Dashboard,s.PagesPaneNodeType.EntityForm,s.PagesPaneNodeType.EntityView].includes(n.nodeType)){var r=n.entity||n.dashboard||n.customPage,a=Object(c.serializePageNodePath)(n.nodeType,r),i=void 0!==a?t[a]:void 0;return void 0!==i?o.createElement(y,{location:a,users:i}):null}}}function g(){var e,t=null===(e=Object(d.usePresenceContext)())||void 0===e?void 0:e.presentUsers,n=Object(i.useSelector)(l.Selectors.getSiteMap);return e=>{var r,a,i=null===(r=n.value)||void 0===r?void 0:r.siteMapXml;if(i){var s=e;Object(u.isNodeInfo)(s)?a=Object(c.serializeSiteMapNodePath)(s.path,i):Object(u.isNavigationItem)(e)&&(a=c.navigationItemNodePath)}var l=void 0!==a?t[a]:void 0;return void 0!==l?o.createElement(y,{location:a,users:l}):null}}var y=e=>{var{t:t}=Object(p.useTranslation)("PresenceIndicator");return o.createElement(r.Presence,{presentUsers:e.users.map(t=>m(m({},t),{},{location:e.location})),strings:{presenceOverflowListTitle:t("presenceIndicatorResources.presenceOverflowListTitle"),chatInTeamsTitle:t("presenceIndicatorResources.chatInTeamsTitle"),sendEmailTitle:t("presenceIndicatorResources.sendEmailTitle"),goToLocationTitle:t("presenceIndicatorResources.goToLocationTitle"),openContactCard:t("presenceIndicatorResources.openContactCard")},size:a.PersonaSize.size16,maxDisplayableUsers:2})}},12214:function(e,t,n){"use strict";n.r(t),n.d(t,"Presence",(function(){return b}));var r=n(1259),a=n(245),o=n(8969),i=n(12215),s=n(12216),c=n(12219),l=n(12217),u=n(12218);function d(){return(d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){m(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var b=e=>{var t,[n,p]=a.useState(!1),[m,b]=a.useState(void 0),v=a.useMemo(()=>e.presentUsers.map(e=>({personaName:e.displayName,imageUrl:e.imageUrl,data:e})),[e.presentUsers]),g=e.maxDisplayableUsers||3,y=Object(c.getPresenceIndicatorStyles)(e.styles),h=v.slice(g),[S,O]=a.useState(!1),A=e=>{p(e),O(e)},P=a.useMemo(()=>v.slice(0,g).map(e=>f(f({},e),{},{onClick:i.passThroughClickToFacepilePersonaCoin})),[v]),j=P.some(e=>e.data.userStatus===l.PresentUserStatus.Active),E=h.some(e=>e.data.userStatus===l.PresentUserStatus.Active),C=f(f({},Object(u.extractInnerComponentSharedProps)(f(f({},e),{},{styles:y}))),{},{styles:y}),T=(t,n)=>Object(i.onRenderFacepilePersona)(f(f({},C),{},{sizeInOverflow:e.sizeInOverflow,anyCallOutVisible:S,setCallOutVisible:O,persona:t}),n);return a.createElement(a.Fragment,null,a.createElement(r.FocusZone,{handleTabKey:r.FocusZoneTabbableElements.all,className:y.focusZone},a.createElement(r.Facepile,{styles:Object(c.getFacepileCircleStyles)(j,e.size),className:y.root,personas:P,overflowPersonas:h,personaSize:null!==(t=e.size)&&void 0!==t?t:r.PersonaSize.size24,maxDisplayablePersonas:g,onRenderPersona:T,onRenderPersonaCoin:T,overflowButtonProps:{title:"More users","aria-haspopup":!0,onClick:e=>{null==e||e.stopPropagation(),b(null==e?void 0:e.currentTarget),A(!n)}},overflowButtonType:r.OverflowButtonType.descriptive}),h.length>0&&n&&a.createElement(r.Callout,{role:"dialog",isBeakVisible:!0,target:m,onDismiss:()=>A(!1),directionalHint:r.DirectionalHint.bottomCenter,setInitialFocus:!0},a.createElement(r.Label,{className:y.overflowListHeader},Object(o.formatString)(e.strings.presenceOverflowListTitle,h.length.toString())),a.createElement(r.FocusZone,{direction:r.FocusZoneDirection.vertical,handleTabKey:r.FocusZoneTabbableElements.all,className:y.overFlowListContent,allowFocusRoot:!0},a.createElement(r.List,{items:h,onRenderCell:t=>{var n;return a.createElement(r.Stack.Item,{className:y.overFlowListItem,styles:{root:E&&c.circleStyles}},a.createElement(s.PersonaCard,d({},C,{renderUserStatusCircle:!0,user:t.data,size:null!==(n=e.sizeInOverflow)&&void 0!==n?n:r.PersonaSize.size24})))}})))))}},12215:function(e,t,n){"use strict";n.r(t),n.d(t,"onRenderFacepilePersona",(function(){return f})),n.d(t,"passThroughClickToFacepilePersonaCoin",(function(){return m})),n.d(t,"FacepilePersonaCoin",(function(){return b}));var r=n(1259),a=n(3328),o=n(245),i=n(12216),s=n(12217),c=n(12218);function l(){return(l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){p(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var f=(e,t)=>{var{onRenderFacepileCoin:n}=e,r=e=>o.createElement(b,e,null==t?void 0:t(e.persona));return n?n(e,r):r(e)};function m(e){if(e.currentTarget){var t=e.currentTarget.querySelector(".".concat("baf-persona-outer-circle"));null==t||t.click()}}var b=e=>{var[t,n]=o.useState(!1),[u,p]=o.useState(!1),f=t=>{n(t),e.setCallOutVisible(t)},m=o.useRef(null),b=d(d({},Object(c.extractInnerComponentSharedProps)(e)),{},{renderUserStatusCircle:!1,size:r.PersonaSize.size32,user:e.persona.data}),v=t||e.anyCallOutVisible?t:u;return o.createElement(o.Fragment,null,o.createElement("div",{ref:m,onClick:e=>{f(!t),null==e||e.preventDefault(),null==e||e.stopPropagation()},onMouseOver:()=>p(!0),onMouseOut:()=>p(!1),onMouseEnter:()=>p(!0),onMouseLeave:()=>p(!1),className:Object(a.mergeStyles)(e.styles.facepilePersonaCoinContainer,"baf-persona-outer-circle",{borderColor:b.user.userStatus===s.PresentUserStatus.Active?Object(r.getPersonaInitialsColor)({text:e.persona.personaName}):"transparent"})},o.createElement(r.Stack.Item,{className:Object(a.mergeStyles)(e.styles.facepilePersonaCoin,"baf-persona-inner-circle")},e.children)),v&&o.createElement(r.Callout,{onDismiss:()=>{f(!1)},hidden:!v,role:"dialog",target:m,isBeakVisible:!0,directionalHint:r.DirectionalHint.bottomCenter,className:e.styles.facepilePersonaCoinTooltip,onMouseOver:()=>!u&&p(!0),onMouseLeave:()=>u&&p(!1),setInitialFocus:!0},o.createElement(r.FocusZone,null,o.createElement(i.PersonaCard,l({},b,{expandPersonaActions:b.personaActionsExpandedByDefault})))))}},12216:function(e,t,n){"use strict";n.r(t),n.d(t,"PersonaCard",(function(){return u}));var r=n(1259),a=n(245),o=n(12217);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var l=(e,t,n,o)=>{var i=e=>t?(e=>a.createElement(r.Stack.Item,{className:Object(r.mergeStyles)("baf-persona-outer-circle",{borderColor:Object(r.getPersonaInitialsColor)({text:null==e?void 0:e.text})})},a.createElement(r.Stack.Item,{className:"baf-persona-inner-circle"},a.createElement(r.PersonaCoin,e))))(e):a.createElement(r.PersonaCoin,e);return o?o(s(s({},e),{},{user:n}),i):i(e)},u=e=>{var t,n=!!e.expandPersonaActions,[i,s]=a.useState(n),c=!!e.user.location&&!!e.onGoToLocation,u=!!e.user.emailAddress,d=!!e.user.alias,p=!!e.onOpenContactCard,f=!e.hidePersonaActions&&(c||u||d),m=e.renderUserStatusCircle&&e.user.userStatus===o.PresentUserStatus.Active;return a.createElement(r.Stack,null,a.createElement(r.Stack,{"data-is-focusable":!0,tabIndex:0,horizontal:!0,className:"baf-tooltip-personCard-container",style:{justifyContent:"center",alignItems:"center"},onClick:()=>s(!i)},a.createElement(r.Stack.Item,{grow:1},a.createElement(r.Persona,{styles:{primaryText:{fontWeight:r.FontWeights.semibold},root:{cursor:"pointer"}},presence:e.user.personaPresence,imageUrl:e.user.imageUrl,text:e.user.displayName,showSecondaryText:!!e.user.userContext||!!e.user.userContextIcon,size:null!==(t=e.size)&&void 0!==t?t:r.PersonaSize.size24,hidePersonaDetails:!1,onRenderPersonaCoin:t=>l(t,m,e.user,e.onRenderPersonaCardCoin),onRenderSecondaryText:()=>a.createElement(a.Fragment,null,a.createElement(r.Stack,{className:"baf-tooltip-personCard-secondaryText",tokens:{childrenGap:6},horizontal:!0},e.user.userContextIcon&&a.createElement(r.FontIcon,{iconName:e.user.userContextIcon}),e.user.userContext&&a.createElement(r.Text,null,e.user.userContext)))})),f&&!n&&a.createElement(r.Stack.Item,{className:"baf-expand-button-container"},a.createElement(r.ActionButton,{"data-is-focusable":!1,iconProps:{iconName:i?"ChevronDown":"ChevronRight"},ariaLabel:"".concat(i?"close":"expand"," persona actions")}))),i&&c&&a.createElement(r.ActionButton,{iconProps:{iconName:e.hidePersonaActionIcons?"":"Go"},onClick:()=>{var t;return null===(t=e.onGoToLocation)||void 0===t?void 0:t.call(e,e.user.location)}},e.strings.goToLocationTitle),i&&u&&a.createElement(r.ActionButton,{iconProps:{iconName:e.hidePersonaActionIcons?"":"Mail"},onClick:()=>{var t;"function"==typeof e.onSendEmail?e.onSendEmail(e.user):location.href=null!==(t="mailto:".concat(e.user.emailAddress))&&void 0!==t?t:""}},e.strings.sendEmailTitle),i&&d&&a.createElement(r.ActionButton,{iconProps:{iconName:e.hidePersonaActionIcons?"":"Chat"},onClick:()=>{"function"==typeof e.onOpenTeamsChat?e.onOpenTeamsChat(e.user):window.open("".concat("https://teams.microsoft.com/l/chat/0/0?users=").concat(e.user.alias))}},e.strings.chatInTeamsTitle),i&&p&&a.createElement(r.ActionButton,{iconProps:{iconName:e.hidePersonaActionIcons?"":"ContactCard"},onClick:()=>{var t;null===(t=e.onOpenContactCard)||void 0===t||t.call(e,e.user)}},e.strings.openContactCard))}},12217:function(e,t,n){"use strict";n.r(t),n.d(t,"PresentUserStatus",(function(){return r}));var r,a=n(1259);n.d(t,"PersonaPresence",(function(){return a.PersonaPresence})),function(e){e.Active="Active",e.Inactive="Inactive"}(r||(r={}))},12218:function(e,t,n){"use strict";n.r(t),n.d(t,"extractInnerComponentSharedProps",(function(){return r}));var r=e=>({onGoToLocation:e.onGoToLocation,onOpenContactCard:e.onOpenContactCard,onOpenTeamsChat:e.onOpenTeamsChat,onSendEmail:e.onSendEmail,onRenderFacepileCoin:e.onRenderFacepileCoin,onRenderPersonaCardCoin:e.onRenderPersonaCardCoin,strings:e.strings,hidePersonaActions:!!e.hidePersonaActions,hidePersonaActionIcons:!!e.hidePersonaActionIcons,personaActionsExpandedByDefault:!!e.personaActionsExpandedByDefault,styles:e.styles})},12219:function(e,t,n){"use strict";n.r(t),n.d(t,"getPresenceIndicatorStyles",(function(){return i})),n.d(t,"circleStyles",(function(){return s})),n.d(t,"getFacepileCircleStyles",(function(){return c}));var r=n(1259),a=n(719),o=n(3328),i=e=>{var t=Object(o.getTheme)();return Object(a.mergeStyleSets)({root:[{margin:"auto",paddingRight:10,paddingLeft:10},null==e?void 0:e.root],facepilePersonaCoin:[{cursor:"pointer",".ms-Persona-details":{display:"none"}},null==e?void 0:e.facepilePersonaCoin],facepilePersonaCoinContainer:[null==e?void 0:e.facepilePersonaCoinContainer],facepilePersonaCoinTooltip:[{padding:8,width:300,".baf-tooltip-personCard-container":{padding:"12px 0 12px 18px",".ms-Persona-secondaryText":{color:t.palette.neutralSecondary},".ms-Persona-secondaryText span":{color:t.palette.neutralSecondary}},".baf-expand-button-container":{textAlign:"center",width:44}},null==e?void 0:e.facepilePersonaCoinTooltip],overFlowListContent:[{height:"100%",maxHeight:350,overflowY:"auto",overflowX:"hidden",width:300},null==e?void 0:e.overFlowListContent],overflowListHeader:[{padding:"12px 12px 12px 16px"},null==e?void 0:e.overFlowListContent],overFlowListItem:[{cursor:"default",padding:"6px 12px 6px 16px",boxSizing:"border-box",minHeight:42},null==e?void 0:e.overFlowListItem],focusZone:[{display:"flex"}]})},s={".baf-persona-outer-circle":{borderRadius:"50%",borderWidth:2,borderStyle:"solid",".baf-persona-inner-circle":{borderRadius:"50%",border:"2px solid transparent"}}},c=(e,t)=>e?{member:s,descriptiveOverflowButton:{width:r.sizeToPixels[null!=t?t:r.PersonaSize.size24]+8}}:void 0},12220:function(e,t,n){"use strict";n.r(t),n.d(t,"GrantUsersAccessResult",(function(){return r})),n.d(t,"GrantUserAccessDialog",(function(){return s}));var r,a=n(1259),o=n(923),i=n(245);!function(e){e[e.Share=0]="Share",e[e.Cancel=1]="Cancel"}(r||(r={}));var s=e=>{var{t:t}=Object(o.useTranslation)("AppModuleDesigner");return i.createElement(a.Dialog,{hidden:!e.deferred,onDismiss:()=>{var t;null===(t=e.deferred)||void 0===t||t.resolve(r.Cancel)},dialogContentProps:{type:a.DialogType.normal,title:t("commentsPane.atMentionsConfirmationDialog.Title")},modalProps:{isBlocking:!0,styles:{main:{maxWidth:450}}}},i.createElement(a.Text,null,t("commentsPane.atMentionsConfirmationDialog.Text")),i.createElement(a.Link,{href:"https://go.microsoft.com/fwlink/?linkid=2178507",target:"_blank"},i.createElement("span",null," ",t("commentsPane.atMentionsConfirmationDialog.learnMore"))),i.createElement(a.DialogFooter,null,i.createElement(a.PrimaryButton,{onClick:()=>{var t;null===(t=e.deferred)||void 0===t||t.resolve(r.Share)},text:t("commentsPane.atMentionsConfirmationDialog.PostButton")}),i.createElement(a.DefaultButton,{onClick:()=>{var t;null===(t=e.deferred)||void 0===t||t.resolve(r.Cancel)},text:t("buttons.cancel")})))}},12221:function(e,t,n){"use strict";n.r(t),n.d(t,"ScrollbarFix",(function(){return o}));var r=n(1259),a=n(245),o=()=>a.createElement("span",{className:i}),i=Object(r.mergeStyles)({':global(body > div > span[role="region"][aria-atomic="true"][aria-relevant="additions"])':{margin:-1}})},12222:function(e,t,n){"use strict";n.r(t),n.d(t,"ConsoleCommands",(function(){return v}));var r=n(245),a=n(10443),o=n(12167),i=n(10314),s=n(12005),c=n(10302),l=n(12031),u=n(217),d=n(12003),p=n(11990);function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){b(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function b(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var v=r.memo(()=>{var e,t,n,f,b,v,h;return e=r.useRef(!1),(t={commands:()=>{},help:g,getAppModuleComponents:(h=Object(a.useSelector)(s.Selectors.getAppModule),r.useCallback(()=>{if(h.value){var e=Object(c.buildAppElementsList)(h.value);return console.table(e),y(e)}console.error("No AppModule is currently loaded")},[h])),getEnvironmentDetails:(v=Object(l.useEnvironment)(),r.useCallback(()=>{if(v){var e=m(m({},v),{},{properties:void 0});return delete e.properties,console.table(e),console.table(v.properties.linkedEnvironmentMetadata),y(v)}console.error("No environment info is currently present")},[v])),getSiteMapXml:(b=Object(a.useSelector)(s.Selectors.getSiteMap),r.useCallback(()=>{if(b.value){var e=Object(u.trackOtherScenario)(d.default,p.default.SiteMapSerialize),t=Object(i.default)(b.value.siteMapXml,e,new XMLSerializer);return console.log(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"  ",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"\n",r="",a="",o=e.slice(1,-1).split(/>\s*</);"?"===o[0][0]&&(r+="<"+o.shift()+">"+n);for(var i=0;i<o.length;i++){var s=o[i];"/"===s[0]&&(a=a.slice(t.length)),r+=a+"<"+s+">"+n,"/"!==s[0]&&"/"!==s[s.length-1]&&-1===s.indexOf("</")&&(a+=t)}return r}(t)),y(b.value)}console.error("No SiteMap is currently loaded")},[b])),getStore:(f=Object(a.useStore)(),r.useCallback(()=>f,[f])),getPackagerMonitor:(n=Object(o.usePackagerMonitorStateMachine)(),r.useCallback(()=>n,[n]))}).commands=function(e){return r.useCallback(()=>{console.log("Here is a list of currently available commands:"),Object.keys(e).forEach(e=>{console.log("• %cAppDesigner.%c".concat(e,"()"),"font-style:italic; color: #AAA","")})},[e])}(t),r.useEffect(()=>(Object.defineProperty(window,"AppDesigner",{get:()=>(e.current||(e.current=!0,t.help(),t.commands()),t),configurable:!0}),()=>{"AppDesigner"in window&&delete window.AppDesigner}),Object.values(t)),null});function g(){console.warn("\n#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#\n| Welcome to the App Designer Console Tools!    |\n|                                               |\n| Use these tools to help you debug your        |\n| current App Designer session.                 |\n|                                               |\n| Be careful though, as these tools enable      |\n| advanced functionality that is not accessible |\n| through the designer itself, and can lead to  |\n| adverse effects if not used properly.         |\n#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#")}function y(e){return JSON.parse(JSON.stringify(e))}},12223:function(e,t,n){"use strict";n.r(t),n.d(t,"CreateAppModal",(function(){return P}));var r=n(1105),a=n(1071),o=n(922),i=n(895),s=n(245),c=n(10443),l=n(303),u=n(12002),d=n(11984),p=n(12005),f=n(11995),m=n(12173),b=n(12174),v=n(12224),g=n(12226),y=n(12229),h=n(12230);function S(){return(S=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var O=Object(b.default)({isCreating:d.Selectors.isAppCreating,isOpen:d.Selectors.isCreateAppUIOpen}),A=Object(m.default)({onCreateApp:p.Actions.createApp.request}),P=Object(a.withServices)(e=>{var{currentEnvironment:t,isOpen:n,match:r}=e,a=Object(g.useCreateAppModalStyles)(),[o,c]=s.useState(y.CreateAppPages.AppDetailsPage),l=s.useCallback(e=>{if("modern"===e)c(y.CreateAppPages.AppDetailsPage);else{var n,a=null==t||null===(n=t.properties.linkedEnvironmentMetadata)||void 0===n?void 0:n.instanceUrl;if(!a)throw new Error("Could not switch to classic create because no environment metadata was found");Object(u.switchToClassicCreate)(a,r.params.solutionId)}},[c]);return s.createElement(i.Modal,{isOpen:n,styles:{root:a.root},scrollableContentClassName:a.container},0===o&&s.createElement(h.DesignerTargetStep,S({},e,{onNext:l,onCancel:()=>Object(f.goBack)()})),1===o&&s.createElement(v.AppDetailsStep,S({},e,{onBack:()=>c(y.CreateAppPages.DesignerTargetPage)})))},[s.memo,Object(o.translateService)("AppModuleDesigner"),r.withEnvironment,l.withRouter,Object(c.connect)(O,A)])},12224:function(e,t,n){"use strict";n.r(t),n.d(t,"AppDetailsStep",(function(){return v}));var r=n(3851),a=n(684),o=n(890),i=n(1795),s=n(1837),c=n(1429),l=n(10297),u=n(245),d=n(10443),p=n(12107),f=n(12225),m=n(12226),b=n(12227),v=e=>{var{isCreating:t,onCreateApp:n,onBack:v,t:g}=e,y=Object(m.useCreateAppModalStyles)(),h=Object(d.useSelector)(p.Selectors.firstRunTourSampleDataLoading),[S,O]=u.useState(!1),[A,P]=u.useState(""),[j,E]=u.useState(""),C=u.useCallback((e,t)=>void 0!==t&&P(t),[P]),{hasValidationError:T,onGetErrorMessage:M,onNotifyValidationResult:w}=Object(b.useDuplicateNameValidation)(),I=u.useCallback((e,t)=>void 0!==t&&E(t),[E]);u.useEffect(()=>{S&&!h&&(n({appDisplayName:A,appDescription:j}),O(!1))},[h,S]);var N=u.useCallback(()=>{h?O(!0):n({appDisplayName:A,appDescription:j})},[A,j,n]),D=t||S,x=u.useMemo(()=>!!t||(!!Object(l.isBlank)(A)||(!!T||!!S)),[t,A,T,S]);return u.createElement(u.Fragment,null,u.createElement(f.ErrorNotificationBar,{styles:m.errorNotificationBarStyles,truncated:!0,isMultiline:!1,hidePrefix:!0}),u.createElement("div",{className:y.header},u.createElement(s.Text,{variant:"xLarge"},g("createApp.header"))),u.createElement("div",{className:y.body},u.createElement(i.Stack,{className:y.right,tokens:{childrenGap:12}},u.createElement(c.TextField,{label:g("createApp.name"),required:!0,value:A,disabled:D,onChange:C,onGetErrorMessage:M,onNotifyValidationResult:w,deferredValidationTime:250,autoFocus:!0,"data-cy":"createAppModalNameInput"}),u.createElement(c.TextField,{label:g("createApp.description"),required:!1,value:j,multiline:!0,rows:3,maxLength:2e3,resizable:!1,disabled:D,onChange:I}))),u.createElement(o.DialogFooter,{className:y.footer},u.createElement(r.LoadingPrimaryButton,{text:g("createApp.create"),loading:D,disabled:x,onClick:N,"data-cy":"createAppModalCreateButton"}),u.createElement(a.DefaultButton,{text:g("createApp.back"),onClick:v,disabled:D})))}},12225:function(e,t,n){"use strict";n.r(t),n.d(t,"UnconnectedErrorNotificationBar",(function(){return f})),n.d(t,"ErrorNotificationBar",(function(){return m}));var r=n(1071),a=n(922),o=n(1697),i=n(245),s=n(10443),c=n(12190),l=n(10300),u=["hidePrefix","t"];function d(){return(d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function p(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var f=e=>{var{hidePrefix:t,t:n}=e,r=p(e,u),a=Object(s.useSelector)(c.Selectors.getActionErrors),f=Object(s.useDispatch)(),m=a[a.length-1];if(!m)return null;var b=Object(l.parseMessageFromError)(m.error,n),v=t?b.message:n("errorNotificationBar.errorPrompt",[b.message]);return i.createElement(o.MessageBar,d({messageBarType:o.MessageBarType.error,dismissButtonAriaLabel:n("buttons.close"),overflowButtonAriaLabel:n("errorNotificationBar.overflowButtonAriaLabel"),onDismiss:()=>f(c.Actions.clearLatestError()),truncated:!0},r),v)},m=Object(r.withServices)(f,[i.memo,Object(a.translateService)("AppModuleDesigner")])},12226:function(e,t,n){"use strict";n.r(t),n.d(t,"useCreateAppModalStyles",(function(){return i})),n.d(t,"CreateAppModalStyles",(function(){return s})),n.d(t,"errorNotificationBarStyles",(function(){return c}));var r=n(719),a=n(245),o=n(12066);function i(){var e=Object(o.default)();return a.useMemo(()=>s(e),[s,e])}var s=e=>Object(r.mergeStyleSets)({root:["CreateAppModal"],container:{display:"flex",flexDirection:"column",width:400,minHeight:300},header:{display:"flex",alignItems:"center",height:60,padding:"12px 12px 12px 24px"},body:{flex:"auto",padding:"0 24px 24px 24px",overflowY:"hidden"},box:{width:412,height:280,backgroundColor:e.palette.neutralLight},right:{flex:1},footer:{height:60,padding:"12px 24px 14px 12px",borderTop:"1px solid ".concat(e.palette.neutralQuaternary),selectors:{"& > button":{marginLeft:8},"& > .ms-Dialog-actionsRight":{display:"flex",justifyContent:"flex-end"}}}}),c={root:{maxHeight:240,overflowX:"auto"}}},12227:function(e,t,n){"use strict";n.r(t),n.d(t,"useDuplicateNameValidation",(function(){return u}));var r=n(3152),a=n(12228),o=n(923),i=n(245),s=n(10443),c=n(10312),l=n(12005);function u(){var e,t,{t:n}=Object(o.useTranslation)("AppModuleDesigner"),[u,d]=i.useState(!1),{data:p}=Object(r.useQuery)(a.AppModuleNamesQuery),f=null!==(e=null==p?void 0:p.appModulesCds)&&void 0!==e?e:[],m=null!==(t=Object(s.useSelector)(l.Selectors.publisherPrefix))&&void 0!==t?t:"new";return{hasValidationError:u,onGetErrorMessage:e=>{if(e){var t=Object(c.makeSchemaSpecificAppName)(m,e).toLowerCase();if(f.some(e=>e.uniqueName.toLowerCase()===t))return n("createApp.duplicateNameError")}},onNotifyValidationResult:e=>{d(!!e)}}}},12228:function(e,t,n){"use strict";n.r(t),n.d(t,"AppModuleNamesQuery",(function(){return s}));var r,a=n(3128);var o,i,s=n.n(a)()(r||(o=["\n  query appModuleNames {\n    appModulesCds {\n      id\n      name\n      uniqueName\n      displayName\n    }\n  }\n"],i||(i=o.slice(0)),r=Object.freeze(Object.defineProperties(o,{raw:{value:Object.freeze(i)}}))))},12229:function(e,t,n){"use strict";var r;n.r(t),n.d(t,"CreateAppPages",(function(){return r})),function(e){e[e.DesignerTargetPage=0]="DesignerTargetPage",e[e.AppDetailsPage=1]="AppDetailsPage"}(r||(r={}))},12230:function(e,t,n){"use strict";n.r(t),n.d(t,"DesignerTargetStep",(function(){return u}));var r=n(684),a=n(1368),o=n(890),i=n(1795),s=n(1837),c=n(245),l=n(12226),u=e=>{var{onNext:t,onCancel:n,t:u}=e,d=Object(l.useCreateAppModalStyles)(),p=c.useMemo(()=>[{key:"modern",text:u("createApp.modern")},{key:"classic",text:u("createApp.classic")}],[u]),[f,m]=c.useState("modern"),b=c.useCallback((e,t)=>t&&m(t.key),[m]),v=c.useCallback(()=>t(f),[f,t]);return c.createElement(c.Fragment,null,c.createElement("div",{className:d.header},c.createElement(s.Text,{variant:"xLarge"},u("createApp.header"))),c.createElement("div",{className:d.body},c.createElement(i.Stack,{className:d.right,tokens:{childrenGap:12}},c.createElement(a.ChoiceGroup,{autoFocus:!0,options:p,selectedKey:f,onChange:b}))),c.createElement(o.DialogFooter,{className:d.footer},c.createElement(r.PrimaryButton,{text:u("createApp.next"),onClick:v,"data-cy":"createAppModalNextButton"}),c.createElement(r.DefaultButton,{text:u("createApp.cancel"),onClick:n})))}},12231:function(e,t,n){"use strict";n.r(t),n.d(t,"DataPane",(function(){return f}));var r,a=n(923),o=n(245),i=n(10443),s=n(12032),c=n(11984),l=n(12018),u=n(12084),d=n(12158),p=n(12209),f=()=>{var{t:e}=Object(a.useTranslation)("AppModuleDesigner"),t=function(){var{t:e}=Object(a.useTranslation)("AppModuleDesigner"),{inApp:t,notInApp:n}=Object(i.useSelector)(s.entitiesPartitionedBasedOnPresenceInApp),c=b();return o.useMemo(()=>c?[{key:"inApp",label:e("data.inApp"),nodeType:r.InAppHeader,children:t.value.map(e=>({key:e.id,label:e.displayName||e.logicalName,nodeType:r.InAppEntity,entity:e,iconProps:{iconName:"FabricDataConnectionLibrary"},children:void 0}))},{key:"inEnvironment",label:e("data.inEnvironment"),nodeType:r.InEnvironmentHeader,children:n.value.map(e=>({key:e.id,label:e.displayName||e.logicalName,nodeType:r.InEnvironmentEntity,entity:e,iconProps:{iconName:"FabricDataConnectionLibrary"}}))}]:[],[t,n,e])}(),n=Object(i.useDispatch)(),l=Object(i.useSelector)(c.Selectors.dataPaneExpandedItems),f=b(),v=new Set,g=o.useCallback(e=>{if(m(e))return y(new Set(l).add(e.key))},[l,y]);if(!f)return o.createElement(u.BulletedListShimmer,null);function y(e){n(c.Actions.updateDataPaneExpandedItemKeys(e))}return o.createElement(d.LeftPaneContainer,null,o.createElement(p.NavTreeView,{navTreeViewKey:"dataPaneTreeView",items:t,getItemHasCommands:e=>!m(e),getItemCommands:t=>{if(m(t))return[];var r=[];return r.push({key:"edit-data-entity",text:e("commands.editItemWithTitle",{title:t.label}),iconProps:{iconName:"edit"},onClick:()=>{n(c.Actions.editDataEntity.open({id:t.entity.id,logicalName:t.entity.logicalName}))}}),r},selectedItemKeys:v,onItemSelected:g,expandedItemKeys:l,onExpandedItemsChanged:y}))};function m(e){return e.nodeType===r.InAppHeader||e.nodeType===r.InEnvironmentHeader}function b(){var{inApp:e,notInApp:t}=Object(i.useSelector)(s.entitiesPartitionedBasedOnPresenceInApp);return e.loadState===l.LoadStates.Loaded&&t.loadState===l.LoadStates.Loaded}!function(e){e[e.InAppHeader=0]="InAppHeader",e[e.InEnvironmentHeader=1]="InEnvironmentHeader",e[e.InAppEntity=2]="InAppEntity",e[e.InEnvironmentEntity=3]="InEnvironmentEntity"}(r||(r={}))},12232:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return s}));var r=n(217),a=n(245),o=n(12003),i=n(11989);class s extends a.PureComponent{render(){return a.Children.only(this.props.children)}componentDidCatch(e,t){throw Object(r.trackErrorTrace)(o.default,{eventName:i.default.ReactCrash,eventData:t},e),this.props.onError&&this.props.onError(e,t),e}}},12233:function(e,t,n){"use strict";n.r(t),n.d(t,"messageBarOverlayStyles",(function(){return r}));var r={root:{position:"absolute",zIndex:100}}},12234:function(e,t,n){"use strict";n.r(t);var r=n(12235);n.d(t,"FirstRunTour",(function(){return r.FirstRunTour}));var a=n(12106);n.d(t,"enablePowerAppsFirstRunTour",(function(){return a.enablePowerAppsFirstRunTour})),n.d(t,"firstRunTourSteps",(function(){return a.firstRunTourSteps}));var o=n(12279);n.d(t,"FirstRunTourProgressTrackerPane",(function(){return o.FirstRunTourProgressTrackerPane}))},12235:function(e,t,n){"use strict";n.r(t),n.d(t,"FirstRunTour",(function(){return E}));var r=n(245),a=n(10443),o=n(12236),i=n(12240),s=n(12256),c=n(12267),l=n(12269),u=n(12271),d=n(12272),p=n(12106),f=n(923),m=n(217),b=n(12003),v=n(11990),g=n(12107),y=n(11984),h=n(12005),S=n(12273),O=n(12274),A=Object(s.withErrorBoundary)(Object(i.withBalloonSteps)(o.Tour)),P=Object(c.withMarkdownContent)(i.BalloonStep),j=p.firstRunTourSteps.findIndex(e=>"createPageStep"===e.stepName),E=()=>{var{t:e}=Object(f.useTranslation)("AppModuleDesignerMissionUI"),t=r.useRef(null),[n,o]=r.useState(!1),[i,s]=r.useState(!1),[c,E]=r.useState(void 0),C=Object(a.useDispatch)(),T=Object(a.useSelector)(g.Selectors.firstRunTourCurrentStepIndex),M=Object(a.useSelector)(g.Selectors.showCurrentTourStepCalloutCount),w=Object(a.useSelector)(y.Selectors.isAddPageUIOpen),I=Object(a.useSelector)(y.Selectors.previewActionCount),N=Object(a.useSelector)(y.Selectors.appJustSuccessfullyPublished),D=Object(a.useSelector)(h.Selectors.appEntityInfo),x=Object(S.useFirstRunTourSteps)(),{loading:k,tableName:R}=Object(O.useCreateSampleData)();r.useEffect(()=>(E(Object(m.trackOtherScenario)(b.default,"".concat(v.default.FirstRunTour))),()=>{E(void 0)}),[]),r.useEffect(()=>{var e;I&&(null===(e=t.current)||void 0===e?void 0:e.currentStepIndex)===l.completeDialogStepIndex&&s(!0)},[I]),r.useEffect(()=>{(e=>{C(g.Actions.updateFirstRunTourSampleDataLoading(e))})(k),R&&(e=>{C(g.Actions.updateFirstRunTourSampleTableLogicalName(e))})(R.toLowerCase())},[k,R]),r.useEffect(()=>{var e;"number"==typeof T&&(null===(e=t.current)||void 0===e||e.navigateToStep(T))},[M]),r.useEffect(()=>{var e,n;w||null!=D&&D.length||!((null===(e=t.current)||void 0===e?void 0:e.currentStepIndex)>j)||(null===(n=t.current)||void 0===n||n.navigateToStep(j))},[w,D]),r.useEffect(()=>{N&&o(!0)},[N]);var L=r.useCallback(e=>w||e.stepIndex!==u.sayHelloToYourAppIndex?n&&e.stepIndex===d.publishedStepIndex?r.createElement(d.PublishedStep,{tourRef:t,scenario:c}):i&&e.stepIndex===l.completeDialogStepIndex?r.createElement(l.CompleteDialog,{tourRef:t,scenario:c}):r.createElement(P,e):r.createElement(u.SayHelloToYourAppStep,{tourRef:t,scenario:c}),[i,n,w]);return r.createElement(r.Fragment,null,x.length&&r.createElement(r.Fragment,null,r.createElement(A,{onError:e=>{null==c||c.failure({errorType:"Tour",error:e})},tourKey:"cds-app-module-designer-first-run-tour",componentRef:t,strings:{subComponentStrings:{balloonStep:()=>({footerText:"",nextStepButtonText:e("firstRunTour.nextButton",{})})}},balloonStepProps:{showBackButton:!1,teachingBubbleProps:{calloutProps:{onLayerMounted:()=>{var e,n=null===(e=t.current)||void 0===e?void 0:e.currentStepIndex;null==c||c.progress({step:n,title:p.firstRunTourSteps[n].stepName}),(e=>{C(g.Actions.updateFirstRunTourCurrentStepIndex(e))})(n)}}}},balloonStepAs:L,onComplete:()=>{var e;null==c||c.complete(),e=!0,C(g.Actions.updateFirstRunTourCompletedState(e))},steps:x})))}},12267:function(e,t,n){"use strict";n.r(t),n.d(t,"withMarkdownContent",(function(){return d}));var r=n(245),a=n(12268),o=["stepInfo","disableHtmlInMarkdown"];function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function d(e){return t=>{var{stepInfo:n,disableHtmlInMarkdown:s}=t,l=u(t,o);return r.createElement(e,i({},l,{stepInfo:c(c({},n),{},{content:"string"==typeof n.content?r.createElement(a.default,{options:{disableParsingRawHTML:s,overrides:l.slots}},n.content):n.content})}))}}},12269:function(e,t,n){"use strict";n.r(t),n.d(t,"completeDialogStepIndex",(function(){return b})),n.d(t,"CompleteDialog",(function(){return v}));var r=n(245),a=n(890),o=n(1277),i=n(1090),s=n(923),c=n(12106),l=n(10443),u=n(12107),d=n(12270),p=n.n(d);function f(){return(f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var m={main:{maxWidth:"609px !important",width:"609px !important"}},b=c.firstRunTourSteps.findIndex(e=>"completeDialog"===e.stepName),v=e=>{var{t:t}=Object(s.useTranslation)("AppModuleDesignerMissionUI"),{tourRef:n,scenario:d}=e,b=Object(l.useDispatch)();return r.useEffect(()=>{var e,t=null==n||null===(e=n.current)||void 0===e?void 0:e.currentStepIndex;null==d||d.progress({step:t,title:null===c.firstRunTourSteps||void 0===c.firstRunTourSteps?void 0:c.firstRunTourSteps[t].stepName}),(e=>{b(u.Actions.updateFirstRunTourCurrentStepIndex(e))})(t)},[]),r.createElement(a.Dialog,f({hidden:!1,onDismiss:()=>{var e;null==n||null===(e=n.current)||void 0===e||e.complete()},dialogContentProps:{type:a.DialogType.normal,title:t("firstRunTour.completeDialog.title"),closeButtonAriaLabel:t("firstRunTour.completeDialog.close"),showCloseButton:!0},styles:m},e),r.createElement(o.Image,{src:p.a,alt:t("firstRunTour.completeDialog.imgAlt"),styles:{image:{margin:"0 auto"}}}),r.createElement("span",null,"".concat(t("firstRunTour.completeDialog.content")," ")),r.createElement(i.Link,{href:"https://docs.microsoft.com/learn/powerplatform/power-apps"},t("firstRunTour.completeDialog.linkText")))}},12270:function(e,t,n){e.exports=n.p+"static/media/MissionUI-CompletedTour.0dae9879.gif"},12271:function(e,t,n){"use strict";n.r(t),n.d(t,"sayHelloToYourAppIndex",(function(){return d})),n.d(t,"SayHelloToYourAppStep",(function(){return p}));var r=n(245),a=n(12106),o=n(923),i=n(890),s=n(684),c=n(10443),l=n(12107),u=n(12066),d=a.firstRunTourSteps.findIndex(e=>"sayHelloToYourApp"===e.stepName),p=e=>{var t,n,p,{t:f}=Object(o.useTranslation)("AppModuleDesignerMissionUI"),{tourRef:m,scenario:b}=e,v=Object(u.default)(),g=Object(c.useDispatch)();return r.useEffect(()=>{var e,t=null==m||null===(e=m.current)||void 0===e?void 0:e.currentStepIndex;null==b||b.progress({step:t,title:a.firstRunTourSteps[t].stepName}),(e=>{g(l.Actions.updateFirstRunTourCurrentStepIndex(e))})(t)},[]),r.createElement(r.Fragment,null,r.createElement(i.Dialog,{hidden:!1,onDismiss:()=>{var e;null==m||null===(e=m.current)||void 0===e||e.navigateToStep(d+1)},dialogContentProps:{type:i.DialogType.normal,title:f("firstRunTour.".concat(null===(t=a.firstRunTourSteps[d])||void 0===t?void 0:t.stepName,".title")),closeButtonAriaLabel:f("firstRunTour.completeDialog.close"),subText:f("firstRunTour.".concat(null===(n=a.firstRunTourSteps[d])||void 0===n?void 0:n.stepName,".content")),showCloseButton:!0,styles:{button:{color:"".concat(v.palette.white," !important")},title:{color:v.palette.white},subText:{color:v.palette.white}}},modalProps:{isDarkOverlay:!1,styles:{main:{maxWidth:450,backgroundColor:v.palette.themePrimary}}}},r.createElement(i.DialogFooter,null,r.createElement(s.DefaultButton,{onClick:()=>{var e;null==m||null===(e=m.current)||void 0===e||e.navigateToStep(d+1)},text:f("firstRunTour.".concat(null===(p=a.firstRunTourSteps[d])||void 0===p?void 0:p.stepName,".button"))}))))}},12272:function(e,t,n){"use strict";n.r(t),n.d(t,"publishedStepIndex",(function(){return u})),n.d(t,"PublishedStep",(function(){return d}));var r=n(245),a=n(12106),o=n(923),i=n(5101),s=n(12066),c=n(10443),l=n(12107),u=a.firstRunTourSteps.findIndex(e=>"publishedStep"===e.stepName),d=e=>{var t,n,{t:d}=Object(o.useTranslation)("AppModuleDesignerMissionUI"),{tourRef:p,scenario:f}=e,m=Object(s.default)(),b=Object(c.useDispatch)();return r.useEffect(()=>{var e,t=null==p||null===(e=p.current)||void 0===e?void 0:e.currentStepIndex;null==f||f.progress({step:t,title:a.firstRunTourSteps[t].stepName}),(e=>{b(l.Actions.updateFirstRunTourCurrentStepIndex(e))})(t)},[]),r.createElement(r.Fragment,null,r.createElement(i.NotificationCard,{heading:d("firstRunTour.".concat(null===(t=a.firstRunTourSteps[u])||void 0===t?void 0:t.stepName,".title")),message:d("firstRunTour.".concat(null===(n=a.firstRunTourSteps[u])||void 0===n?void 0:n.stepName,".content")),iconProps:{iconName:"Completed",styles:{root:{color:m.palette.green}}},notificationType:"Status",hasCloseButton:!0,styles:{root:{top:100,right:20,position:"fixed",zIndex:1e3,backgroundColor:m.palette.white}},onDismiss:()=>{var e;null==p||null===(e=p.current)||void 0===e||e.navigateToStep(u+1)}}))}},12273:function(e,t,n){"use strict";n.r(t),n.d(t,"useFirstRunTourSteps",(function(){return s}));var r=n(245),a=n(790),o=n(923),i=n(12106);n(922);function s(){var{t:e}=Object(o.useTranslation)("AppModuleDesignerMissionUI");return r.useMemo(()=>{for(var t=[],n=0;n<i.firstRunTourSteps.length;n++){var r,o,s;t.push({targetElement:null===(r=i.firstRunTourSteps[n])||void 0===r?void 0:r.targetElement,headline:e("firstRunTour.".concat(null===(o=i.firstRunTourSteps[n])||void 0===o?void 0:o.stepName,".title")),content:e("firstRunTour.".concat(null===(s=i.firstRunTourSteps[n])||void 0===s?void 0:s.stepName,".content")),isLightDismiss:!0,directionalHint:a.DirectionalHint.rightCenter,type:"balloon"})}return t},[])}},12274:function(e,t,n){"use strict";n.r(t),n.d(t,"useCreateSampleData",(function(){return S}));var r=n(245),a=n(10443),o=n(10400),i=n(12275),s=n(1083),c=n(2831),l=n(7398),u=n(1105),d=n(3076),p=n(923),f=n(217),m=n(12003),b=n(12005),v=n(12277),g=n(12278);function y(e,t,n,r,a,o,i){try{var s=e[o](i),c=s.value}catch(l){return void n(l)}s.done?t(c):Promise.resolve(c).then(r,a)}function h(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){y(o,r,a,i,s,"next",e)}function s(e){y(o,r,a,i,s,"throw",e)}i(void 0)}))}}var S=()=>{var{t:e}=Object(p.useTranslation)("AppModuleDesignerMissionUI"),{environmentClient:t}=r.useContext(d.ApolloClientContext),{currentEnvironment:n}=r.useContext(u.EnvironmentContext),y=Object(a.useSelector)(b.Selectors.publisherPrefix),S=Object(a.useSelector)(b.Selectors.solutionUniqueName),O=Object(a.useSelector)(b.Selectors.solutionId),[A,P]=r.useState(void 0),[j,E]=r.useState(!1),[C,T]=r.useState(),[M,w]=r.useState(!1),[I,N]=r.useState(),D=n?Object(s.getEnvironmentLanguageCode)(n):0,x=y?"".concat(y,"_firstRunTourTable"):void 0,k=y?"".concat(y,"_ColumnName"):void 0;r.useEffect(()=>(P(Object(f.trackLoadScenario)(m.default,"FirstRunTour/CreateData")),T(performance.now()),()=>{P(void 0)}),[]);var{createTable:R,tableCreated:L,errorMessage:U,errorCode:B}=Object(o.useCreateTableQuery)(t,m.default,e("firstRunTour.request.failed")),{addTableRowData:F,errorMessage:V}=Object(i.useCreateRowQuery)(t,m.default,e("firstRunTour.request.failed"));r.useEffect(()=>{if(O&&S&&x){var t={solutionUniqueName:S||"",solutionId:O||"",table:{schemaName:x,displayName:e("firstRunTour.sampleData.table.displayName"),pluralName:e("firstRunTour.sampleData.table.displayNamePlural"),duplicateDetectionRules:!0,entityColor:"",isMailMergeEnabled:!0,ownershipType:c.OwnershipTypes.UserOwned,primaryField:{columnRequirement:l.AttributeRequiredLevel.ApplicationRequired,description:e("firstRunTour.sampleData.columnName.description"),displayName:e("firstRunTour.sampleData.columnName.displayName"),externalName:"",maxLength:100,schemaName:k}},localeId:0!==D?D:1033};L||(null==R||R({variables:t}),null==A||A.progress({action:"CreateTable/Initiated"}))}},[O,S,y]);var q=r.useCallback(h((function*(){v.sampleData.forEach(function(){var e=h((function*(e){yield F({variables:{logicalCollectionName:(null==x?void 0:x.toLowerCase())+"s",rowData:[{columnName:null==k?void 0:k.toLowerCase(),value:e.name}]}})}));return function(t){return e.apply(this,arguments)}}()),E(!0)})),[F,k,x]);return r.useEffect(()=>{L&&(q(),null==A||A.progress({action:"CreateRows/Initiated"}))},[L]),r.useEffect(()=>{var e=U||V;U&&B?"0x80044363"===B?(E(!0),w(!0)):N({errorType:g.ErrorTypes.Table,errorMessage:e,errorCode:B}):V&&N({errorType:g.ErrorTypes.Row,errorMessage:e,errorCode:B})},[U,V,B]),r.useEffect(()=>{I&&(null==A||A.failure(I))},[I]),r.useEffect(()=>{j&&(null==A||A.complete({totalTime:performance.now()-C,tableAlreadyExists:M}))},[j]),{loading:!(j||I),dataCreated:j&&(!I||M),error:I,tableName:x}}},12275:function(e,t,n){"use strict";n.r(t),n.d(t,"useCreateRowQuery",(function(){return d}));var r=n(245),a=n(217),o=n(3192),i=n(3193),s=n(12276),c=n(3152);function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e,t,n){var d=i.TelemetryScenarioNames.createRow,[p,f]=Object(r.useState)(),[m,b]=Object(r.useState)(""),[v,{loading:g,data:y}]=Object(c.useMutation)(s.CreateRowMutationQuery,{client:e||void 0,onCompleted:()=>{p&&p.complete(),b("")},onError:e=>{var t=e.message,r=Object(o.getResponseMessageFromApolloError)(e,n);b(r),p&&p.failure({error:r,clientError:t})}});return Object(r.useEffect)(()=>{g&&f(Object(a.trackLoadScenario)(t,d))},[g]),function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({addTableRowData:v},{rowCreated:null==y?void 0:y.addTableRowData,loading:g,errorMessage:m})}},12276:function(e,t,n){"use strict";n.r(t),n.d(t,"CreateRowMutationQuery",(function(){return s}));var r,a=n(3128);var o,i,s=n.n(a)()(r||(o=["\n  mutation addTableRowData($logicalCollectionName: String!, $rowData: [RowInput!]!) {\n    addTableRowData(logicalCollectionName: $logicalCollectionName, rowData: $rowData)\n  }\n"],i||(i=o.slice(0)),r=Object.freeze(Object.defineProperties(o,{raw:{value:Object.freeze(i)}}))))},12277:function(e,t,n){"use strict";n.r(t),n.d(t,"sampleData",(function(){return r}));var r=[{name:"Jim Glynn (sample)",phone:"555-0109",location:"Coho Winery (sample)"},{name:"Maria Campbell (sample)",phone:"555-0103",location:"Fabrikam, Inc. (sample)"},{name:"Nancy Anderson (sample)",phone:"555-0102",location:"Adventure Works (sample)"}]},12278:function(e,t,n){"use strict";var r;n.r(t),n.d(t,"ErrorTypes",(function(){return r})),function(e){e.Table="Table",e.Column="Column",e.Row="Row"}(r||(r={}))},12279:function(e,t,n){"use strict";n.r(t),n.d(t,"FirstRunTourProgressTrackerPane",(function(){return c}));var r=n(5165),a=n(245),o=n(12158),i=n(12280),s={root:{marginLeft:8}},c=()=>{var e=Object(i.useFirstRunTourProgressTrackerSteps)();return a.createElement(o.LeftPaneContainer,null,a.createElement(r.ProgressTracking,{styles:s,steps:e}))}},12280:function(e,t,n){"use strict";n.r(t),n.d(t,"getTourStepProgressTrackerState",(function(){return d})),n.d(t,"useFirstRunTourProgressTrackerSteps",(function(){return p}));var r=n(5165),a=n(923),o=n(10443),i=n(12107),s=n(12106);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var d=(e,t,n)=>n?{state:r.StepState.Completed,disabled:!0}:e===t?{state:r.StepState.Active}:e>t?{state:r.StepState.NotStarted,disabled:!0}:{state:r.StepState.Completed,disabled:!0};function p(){for(var{t:e}=Object(a.useTranslation)("AppModuleDesignerMissionUI"),t=Object(o.useSelector)(i.Selectors.firstRunTourCurrentStepIndex),n=Object(o.useSelector)(i.Selectors.firstRunTourComplete),r=Object(o.useDispatch)(),c=()=>r(i.Actions.showCurrentTourStepCallout()),u=[],p=0;p<s.firstRunTourSteps.length;p++){var f=s.firstRunTourSteps[p];null!=f&&f.showInProgressTracker&&u.push(l({name:e("firstRunTour.".concat(null==f?void 0:f.stepName,".progressTrackerTitle")),onClick:c,buttonProps:f.progressTrackingButtonProps},d(p,t,n)))}return u}},12281:function(e,t,n){"use strict";n.r(t),n.d(t,"PagesPane",(function(){return A}));var r=n(245),a=n(10443),o=n(12029),i=n(12058),s=n(12005),c=n(12196),l=n(11984),u=n(12018),d=n(12084),p=n(12282),f=n(12158),m=n(12205),b=n(12206),v=n(12208),g=n(12209),y=n(12283),h=n(12284),S=n(12195),O=n(12213),A=e=>{var t=Object(a.useSelector)(s.Selectors.entitiesInAppSorted),n=Object(a.useSelector)(s.Selectors.dashboardsInAppSorted),o=Object(a.useSelector)(s.Selectors.customPagesInAppSorted);return t.loadState!==u.LoadStates.Loaded||n.loadState!==u.LoadStates.Loaded||o.loadState!==u.LoadStates.Loaded?r.createElement(d.BulletedListShimmer,null):r.createElement(P,null)},P=()=>{var e=Object(a.useDispatch)(),t=Object(a.useSelector)(c.Selectors.selectedPagesNode),n=Object(a.useSelector)(c.Selectors.pagesPaneExpandedItems),[s,u]=r.useState(""),d=Object(h.usePagesPaneItemCommands)(),A=r.useMemo(()=>{var e=new Set;return t&&e.add(t.nodeKey),e},[t]),P=r.useCallback(t=>{var r=t;switch(r.nodeType){case i.PagesPaneNodeType.App:return e(l.Actions.selectPagesNode({nodeKey:t.key,nodeType:i.PagesPaneNodeType.App}));case i.PagesPaneNodeType.EntityView:return e(l.Actions.selectPagesNode({nodeKey:t.key,nodeType:i.PagesPaneNodeType.EntityView,relatedEntity:r.entity}));case i.PagesPaneNodeType.EntityForm:return e(l.Actions.selectPagesNode({nodeKey:t.key,nodeType:i.PagesPaneNodeType.EntityForm,relatedEntity:r.entity}));case i.PagesPaneNodeType.Dashboard:return e(l.Actions.selectPagesNode({nodeKey:t.key,nodeType:i.PagesPaneNodeType.Dashboard,relatedDashboard:r.dashboard}));case i.PagesPaneNodeType.CustomPage:return e(l.Actions.selectPagesNode({nodeKey:t.key,nodeType:i.PagesPaneNodeType.CustomPage,relatedCustomPage:r.customPage}));case i.PagesPaneNodeType.Entity:case i.PagesPaneNodeType.DashboardHeader:return j(new Set(n).add(t.key));default:return}},[n,j]);function j(t){e(l.Actions.updatePagesPaneExpandedItemKeys(t))}var[E,C]=Object(S.usePagesPaneTreeItems)(s),T=Object(p.useRenderPagesPaneCommentsThreadCount)(),M=Object(O.useRenderPagesPanePresenceIndicator)();return r.createElement(f.LeftPaneContainer,null,r.createElement(b.NavSearchBox,{searchText:s,onSearchTextChange:(e,t)=>u(null!=t?t:"")}),r.createElement(m.LeftPaneItemWithSeparator,null,r.createElement(y.AddPageButton,null)),r.createElement(g.NavTreeView,{navTreeViewKey:"pagesPaneTreeView",items:E,getItemHasCommands:e=>e.nodeType===i.PagesPaneNodeType.App||e.nodeType===i.PagesPaneNodeType.Entity&&!!e.entity||e.nodeType===i.PagesPaneNodeType.Dashboard&&!!e.dashboard||e.nodeType===i.PagesPaneNodeType.CustomPage&&!!e.customPage,getItemCommands:d,selectedItemKeys:A,onItemSelected:P,expandedItemKeys:C,onRenderItemLabelContent:v.renderHighlightTreeLabel,onRenderItemLabel:o.featureGates.enableCommentsPane||o.featureGates.enableCoPresence?(e,t,n,a,i)=>r.createElement(r.Fragment,null,i(),o.featureGates.enableCoPresence&&M(e),o.featureGates.enableCommentsPane&&T(e)):void 0,onExpandedItemsChanged:j}))}},12282:function(e,t,n){"use strict";n.r(t),n.d(t,"useRenderPagesPaneCommentsThreadCount",(function(){return u}));var r=n(245),a=n.n(r),o=n(10443),i=n(12058),s=n(12176),c=n(12180),l=n(12203);function u(){var e=Object(o.useSelector)(s.Selectors.getAnchorThreadCountsMap);return t=>{var n=t;if(void 0!==n.nodeType&&[i.PagesPaneNodeType.App,i.PagesPaneNodeType.CustomPage,i.PagesPaneNodeType.Dashboard,i.PagesPaneNodeType.EntityForm,i.PagesPaneNodeType.EntityView].includes(n.nodeType)){var r=n.entity||n.dashboard||n.customPage,o=Object(c.serializePageNodePath)(n.nodeType,r),s=void 0!==o?null==e?void 0:e.get(o):0;return void 0!==s&&s>0?a.a.createElement(l.CommentsIndicator,{commentsCount:s}):a.a.createElement(a.a.Fragment,null)}}}},12283:function(e,t,n){"use strict";n.r(t),n.d(t,"AddPageButton",(function(){return c}));var r=n(923),a=n(245),o=n(10443),i=n(11984),s=n(12161),c=()=>{var{t:e}=Object(r.useTranslation)("AppModuleDesigner"),t=Object(o.useDispatch)();return a.createElement(s.LeftPaneButton,{text:e("pagesPane.newPage"),iconProps:{iconName:"Add"},onClick:()=>t(i.Actions.openAddPageUI())})}},12284:function(e,t,n){"use strict";n.r(t),n.d(t,"usePagesPaneItemCommands",(function(){return u}));var r=n(923),a=n(10443),o=n(12029),i=n(12058),s=n(12005),c=n(12285),l=n(11984);function u(){var{t:e}=Object(r.useTranslation)("AppModuleDesigner"),t=Object(a.useDispatch)();return n=>{if(n.nodeType===i.PagesPaneNodeType.App)return[{key:"refreshPreview",text:e("pagesPane.refreshPreview"),iconProps:{iconName:"refresh"},onClick:()=>t(c.Actions.refreshPreview({trigger:c.Actions.RefreshPreviewTrigger.Manual}))}];if(n.nodeType===i.PagesPaneNodeType.Entity&&n.entity){var r=[];if(o.featureGates.enableCommandDesigner){var a=n.entity.logicalName;r.push({key:"editCommandBar",text:e("pagesPane.editCommandBar"),iconProps:{iconName:"edit"},onClick:()=>t(l.Actions.editCommandBarFromEntity(a))})}return r.push({key:"remove-entity",text:e("commands.removeItemWithTitle",{title:n.label}),iconProps:{iconName:"delete"},onClick:()=>{t(s.App.Actions.removeAppModuleEntities([n.entity]))}}),r}return n.nodeType===i.PagesPaneNodeType.Dashboard&&n.dashboard?[{key:"edit-dashboard",text:e("commands.edit"),iconProps:{iconName:"edit"},onClick:()=>{t(l.Actions.editDashboardPage.open({dashboardId:n.dashboard.id}))}},{key:"remove-dashboard",text:e("commands.removeItemWithTitle",{title:n.label}),iconProps:{iconName:"delete"},onClick:()=>{t(s.App.Actions.removeAppModuleDashboards([n.dashboard.id]))}}]:n.nodeType===i.PagesPaneNodeType.CustomPage&&n.customPage?[{key:"edit-custom-page",text:e("commands.edit"),iconProps:{iconName:"edit"},onClick:()=>{t(l.Actions.editCustomPage.open({customPage:n.customPage}))}},{key:"remove-custom-page",text:e("commands.removeItemWithTitle",{title:n.label}),iconProps:{iconName:"delete"},onClick:()=>{t(s.App.Actions.removeAppModuleCustomPages([n.customPage]))}}]:[]}}},12285:function(e,t,n){"use strict";n.r(t);var r=n(12286);n.d(t,"Actions",(function(){return r}));var a=n(12287);n.d(t,"makeMiddleware",(function(){return a.default}));var o=n(12300);n.d(t,"initialState",(function(){return o.initialState})),n.d(t,"reducer",(function(){return o.default}));var i=n(12301);n.d(t,"Selectors",(function(){return i}))},12286:function(e,t,n){"use strict";n.r(t),n.d(t,"previewInitialized",(function(){return c})),n.d(t,"previewPageChanged",(function(){return l})),n.d(t,"RefreshPreviewTrigger",(function(){return r})),n.d(t,"refreshPreview",(function(){return u}));var r,a=n(11986),o=n(11987),i=n(11989),s=n(11988),c=Object(a.createAction)("preview/INITIALIZED")(),l=Object(a.createAction)("preview/PAGE_CHANGED",Object(o.payload)())();!function(e){e.Manual="Manual",e.Publish="Publish",e.SyncService="SyncService",e.PackagingCompleted="PackagingCompleted"}(r||(r={}));var u=Object(a.createAction)("preview/REFRESH",Object(o.payload)(),e=>Object(s.withTelemetryEventMeta)({eventName:i.default.RefreshPreview,eventData:{trigger:e.trigger}}))()},12287:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return p}));var r=n(11986),a=n(12005),o=n(11984),i=n(12286),s=n(12288),c=n(12294),l=n(12295),u=n(12296),d=n(12297);function p(e){return t=>n=>p=>{var f=n(p);return Object(r.isActionOf)(i.previewInitialized,p)&&Object(d.sendPreviewMetadata)(t,e),a.App.Actions.isSiteMapChangeAction(p)&&Object(d.sendSiteMapDescriptor)(t,e),Object(r.isActionOf)(o.Actions.selectPagesNode,p)&&Object(s.onPagesNodeSelected)(e,p.payload),Object(r.isActionOf)(o.Actions.selectSiteMapNode,p)&&Object(l.onSiteMapNodeSelected)(t,e,p.payload),Object(r.isActionOf)(i.previewPageChanged,p)&&Object(c.onPreviewPageChanged)(t,p.payload),Object(r.isActionOf)(a.Actions.publishApp.success,p)&&Object(u.refreshPreviewOnPublish)(t,e),f}}},12288:function(e,t,n){"use strict";n.r(t),n.d(t,"onPagesNodeSelected",(function(){return c}));var r=n(12058),a=n(12289),o=n(12293),i=n(12031),s=n(12120);function c(e,t){if(!t.originatedFromPreview){if(t.relatedEntity){var n=t.relatedEntity;if(t.nodeType===r.PagesPaneNodeType.EntityView)return Object(a.sendNavigateToAppComponentMessage)(e.uciSyncService,{componentType:"EntityView",subAreaDescriptor:Object(o.convertSubAreaToPreviewFormat)(Object(s.makeEntitySubArea)(n))}),!0;if(t.nodeType===r.PagesPaneNodeType.EntityForm)return Object(a.sendNavigateToAppComponentMessage)(e.uciSyncService,{componentType:"EntityForm",entityLogicalName:n.logicalName}),!0}if(t.relatedDashboard){var c=t.relatedDashboard;if(t.nodeType===r.PagesPaneNodeType.Dashboard)return Object(a.sendNavigateToAppComponentMessage)(e.uciSyncService,{componentType:"Dashboard",subAreaDescriptor:Object(o.convertSubAreaToPreviewFormat)(Object(s.makeDashboardSubArea)(c))}),!0}if(t.relatedCustomPage){var l=t.relatedCustomPage,u=Object(i.getLanguageCodeFromEnvironment)(e.environmentProps);if(t.nodeType===r.PagesPaneNodeType.CustomPage)return Object(a.sendNavigateToAppComponentMessage)(e.uciSyncService,{componentType:"Page",subAreaDescriptor:Object(o.convertSubAreaToPreviewFormat)(Object(s.makeCustomPageSubArea)(l,u))}),!0}}return!1}},12289:function(e,t,n){"use strict";n.r(t),n.d(t,"sendNavigateToAppComponentMessage",(function(){return s})),n.d(t,"sendNavigateToSiteMapSubAreaMessage",(function(){return c}));var r=n(12290),a=n(217),o=n(12003),i=n(11989);function s(e,t){return Object(a.trackInfoTrace)(o.default,{eventName:i.default.SentPagesNodeNavigation,eventData:{componentType:t.componentType}}),e.sendMessageToUCI({type:r.UCISyncMessageType.UCISyncMessage,actionName:"NavigateToAppComponent",actionData:t,success:!0})}function c(e,t){return Object(a.trackInfoTrace)(o.default,{eventName:i.default.SentSiteMapNodeNavigation,eventData:{containingAreaId:t.containingAreaId,subAreaId:t.subAreaDescriptor.Id,hasEntity:!!t.subAreaDescriptor.Entity,hasUrl:!!t.subAreaDescriptor.Url,hasDefaultDashboard:!!t.subAreaDescriptor.DefaultDashboard,hasCustomPage:!!t.subAreaDescriptor.Page}}),e.sendMessageToUCI({type:r.UCISyncMessageType.UCISyncMessage,actionName:"NavigateToSiteMapSubArea",actionData:t,success:!0})}},12290:function(e,t,n){"use strict";n.r(t),n.d(t,"UCISyncMessageType",(function(){return r})),n.d(t,"compatibilityVersions",(function(){return p})),n.d(t,"UCISyncService",(function(){return f}));var r,a=n(12291),o=n(217),i=n(222);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e,t,n,r,a,o,i){try{var s=e[o](i),c=s.value}catch(l){return void n(l)}s.done?t(c):Promise.resolve(c).then(r,a)}function d(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){u(o,r,a,i,s,"next",e)}function s(e){u(o,r,a,i,s,"throw",e)}i(void 0)}))}}!function(e){e[e.UCISyncMessage=0]="UCISyncMessage"}(r||(r={}));var p={};class f{constructor(e){this.settings=e,this.syncChannel=void 0,this.dimensionUpdatedListeners=[],this.requestHandlers=new Map,this.metadataChangeSubscription=void 0,this.handleRequest=e=>{if((null==e?void 0:e.type)===r.UCISyncMessage&&e.actionName){var t=this.requestHandlers.get(e.actionName);if(t)return Promise.race(t.map(t=>t(e)));switch(e.actionName){case"DimensionsUpdated":var n,a=null!==(n=e.actionData)&&void 0!==n?n:{};return this.updateDimensions(a),Promise.resolve({actionName:e.actionName,actionData:{},success:!0,type:r.UCISyncMessage});default:return Promise.resolve({actionName:e.actionName,actionData:void 0,success:!1,error:"unknown request",type:r.UCISyncMessage})}}return Promise.reject()},this.createSyncChannel()}initialize(){var e=this;return d((function*(){var t,n,r=Object(o.trackLoadScenario)(e.settings.telemetryScope,"UCISyncService/initialize");e.syncChannel||e.createSyncChannel();var a=yield null===(t=e.syncChannel)||void 0===t?void 0:t.Ready;if(""!==a){var i=new Error("UCI handshake not received due to error: "+a);throw Object(o.trackErrorTrace)(e.settings.telemetryScope,{eventName:"UCISyncService/initialize"},i),r.failure(i),i}r.complete({UCIStatusMessage:"Success"}),null===(n=e.syncChannel)||void 0===n||n.onReceive(e.handleRequest)}))()}dispose(){this.dimensionUpdatedListeners=[],this.requestHandlers.clear(),this.syncChannel&&(this.syncChannel.teardown(),this.syncChannel=void 0),this.metadataChangeSubscription&&this.metadataChangeSubscription.dispose()}getPreviewUrl(){var e=this.settings.previewBaseURL;return e=e.replace("{channelId}",this.syncChannel.ChannelId())}sendMessageToUCI(e){var t=this;return d((function*(){if(t.syncChannel){var n=yield t.syncChannel.send(e);return n&&n.success?n.actionData:Promise.reject(n&&n.error)}throw new Error("Channel has not been initialized")}))()}addRequestHandler(e,t){var n;this.requestHandlers.has(e)||this.requestHandlers.set(e,[]),null===(n=this.requestHandlers.get(e))||void 0===n||n.push(t)}registerToDimensionUpdatedEvent(e){this.dimensionUpdatedListeners.push({callback:e})}createSyncChannel(){var e=Object(i.v4)(),t=this.settings.orgUrl.split("/"),n=t[0]+"//"+t[2];this.syncChannel=new a.default(e,n,"Designer_channel")}updateDimensions(e){if(e){for(var t of Object.keys(e))e[t]&&!e[t].dimensions&&(e[t]=c(c({},e[t]),{},{dimensions:e[t]}));this.onDimensionsUpdated(e)}}onDimensionsUpdated(e){if(this.dimensionUpdatedListeners)for(var t=0;t<this.dimensionUpdatedListeners.length;t++)this.dimensionUpdatedListeners[t].callback(e)}}},12293:function(e,t,n){"use strict";n.r(t),n.d(t,"getSiteMapDescriptorGeneratorInstance",(function(){return g})),n.d(t,"makeSiteMapDescriptorGenerator",(function(){return h})),n.d(t,"convertSubAreaToPreviewFormat",(function(){return A}));var r,a=n(12005),o=n(12116),i=n(12031),s=n(12151),c=n(10303),l=n(10309),u=["Title","Group"],d=["Title","SubArea"],p=["Title"];function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){b(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function b(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function v(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function g(){var e;return r=null!==(e=r)&&void 0!==e?e:h()}var y=e=>[{LCID:"1033",Title:Object(c.getTitle)(e,"1033")}];function h(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e5,t=e;return(n,r)=>{var s,c=n.getState(),l=a.Selectors.getSiteMap(c).value;if(!l)throw new Error("Cannot create sitemap descriptor because sitemap has not been loaded");var u=o.Selectors.getNodeSoftTitleHelper(c),d=Object(i.getLanguageCodeFromEnvironment)(r.environmentProps),p=e=>[{LCID:d,Title:u(e,r.t,d)}];return{VersionNumber:t++,OverallVersionNumber:e,Areas:(null!==(s=l.siteMapXml.Area)&&void 0!==s?s:[]).map(e=>S(e,p)),ShowHome:l.showHome,ShowRecents:l.showRecents,ShowPinned:l.showPinned,EnableCollapsibleGroups:l.enableCollapsibleGroups}}}function S(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:y,{Title:r,Group:a}=e,o=v(e,u);return m(m(m({},o),P(e)),{},{Titles:n(e),Groups:(null!==(t=e.Group)&&void 0!==t?t:[]).map(e=>O(e,n))})}function O(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:y,{Title:r,SubArea:a}=e,o=v(e,d);return m(m(m({},o),P(e)),{},{Titles:n(e),SubAreas:(null!==(t=e.SubArea)&&void 0!==t?t:[]).map(e=>A(e,n))})}function A(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:y,{Title:n}=e,r=v(e,p);return m(m(m(m({},r),P(e)),j(e)),{},{Titles:t(e)})}function P(e){var t,n,r;return{Descriptions:null!==(t=null===(n=e.Descriptions)||void 0===n||null===(r=n[0])||void 0===r?void 0:r.Description)&&void 0!==t?t:[],Description:void 0}}function j(e){if(Object(l.isWebResourceSubArea)(e)&&e.Url){var t=e.Url.slice(l.subAreaWebResourcePrefix.length);return{Url:"".concat(s.webResourcePathPrefix).concat(t)}}return{}}},12294:function(e,t,n){"use strict";n.r(t),n.d(t,"onPreviewPageChanged",(function(){return l}));var r=n(12058),a=n(12005),o=n(10308),i=n(12196),s=n(12116),c=n(11984);function l(e,t){(function(e,t){var n=e.getState(),a=i.Selectors.selectedPagesNode(n),c=s.Selectors.selectedSiteMapNode(n);if(a){var l,u,d,p;if("EntityView"===t.type&&a.nodeType===r.PagesPaneNodeType.EntityView&&t.entityLogicalName===(null===(l=a.relatedEntity)||void 0===l?void 0:l.logicalName))return!0;if("EntityForm"===t.type&&a.nodeType===r.PagesPaneNodeType.EntityForm&&t.entityLogicalName===(null===(u=a.relatedEntity)||void 0===u?void 0:u.logicalName))return!0;if("Dashboard"===t.type&&a.nodeType===r.PagesPaneNodeType.Dashboard&&t.dashboardId===(null===(d=a.relatedDashboard)||void 0===d?void 0:d.id))return!0;if("CustomPage"===t.type&&a.nodeType===r.PagesPaneNodeType.CustomPage&&t.customPageName===(null===(p=a.relatedCustomPage)||void 0===p?void 0:p.name))return!0}else if(c&&Object(o.isSubAreaNode)(c)){if("EntityView"===t.type&&c.Entity===t.entityLogicalName)return!0;if("Dashboard"===t.type&&c.DefaultDashboard===t.dashboardId)return!0;if("CustomPage"===t.type&&c.Page===t.customPageName)return!0}return!1})(e,t)||function(e,t){var n=e.getState(),o=a.Selectors.entitiesInEnvironment(n),{entityNameMultiMap:i,dashboardIdMultiMap:l,customPageNameMultiMap:u}=s.Selectors.siteMapNodeAssociationMaps(n);switch(t.type){case"EntityView":var d=i[t.entityLogicalName];null!=d&&d[0]&&e.dispatch(c.Actions.selectSiteMapNode({nodeType:r.SiteMapPaneNodeType.SiteMapNode,selectedNodePath:d[0].path,originatedFromPreview:!0}));break;case"EntityForm":var p,f=null===(p=o.value)||void 0===p?void 0:p.find(e=>e.logicalName===t.entityLogicalName);f&&e.dispatch(c.Actions.selectPagesNode({nodeKey:"".concat(f.id,"-form"),nodeType:r.PagesPaneNodeType.EntityForm,originatedFromPreview:!0,relatedEntity:f}));break;case"Dashboard":var m=l[t.dashboardId];null!=m&&m[0]&&e.dispatch(c.Actions.selectSiteMapNode({nodeType:r.SiteMapPaneNodeType.SiteMapNode,selectedNodePath:m[0].path,originatedFromPreview:!0}));break;case"CustomPage":var b=u[t.customPageName];null!=b&&b[0]&&e.dispatch(c.Actions.selectSiteMapNode({nodeType:r.SiteMapPaneNodeType.SiteMapNode,selectedNodePath:b[0].path,originatedFromPreview:!0}))}}(e,t)}},12295:function(e,t,n){"use strict";n.r(t),n.d(t,"onSiteMapNodeSelected",(function(){return l}));var r=n(12289),a=n(12293),o=n(10303),i=n(10308),s=n(12005),c=n(10302);function l(e,t,n){if(!n.originatedFromPreview&&n.selectedNodePath){var l,u=s.Selectors.getSiteMap(e.getState()),d=u.value&&Object(c.getSiteMapNodeViaPath)(u.value,n.selectedNodePath),p=Object(c.nodePath)(n.selectedNodePath.areaIndex),f=u.value&&(null===(l=Object(c.getSiteMapNodeViaPath)(u.value,p))||void 0===l?void 0:l.Id);if(f&&d&&Object(i.isSubAreaNode)(d)&&Object(o.isVisibleSubArea)(d))return Object(r.sendNavigateToSiteMapSubAreaMessage)(t.uciSyncService,{containingAreaId:f,subAreaDescriptor:Object(a.convertSubAreaToPreviewFormat)(d)}),!0}return!1}},12296:function(e,t,n){"use strict";n.r(t),n.d(t,"refreshPreviewOnPublish",(function(){return o}));var r=n(12005),a=n(12286);function o(e,t){var n=e.getState();if(r.Selectors.appModuleHasCustomPages(n)){var o=r.Selectors.getAppModuleId(n),i=r.Selectors.appModuleUniqueName(n);if(o&&i){t.packagerMonitor.updateContext(o,i);var s=()=>e.dispatch(a.refreshPreview({trigger:a.RefreshPreviewTrigger.PackagingCompleted}));t.packagerMonitor.onPublish({onSuccess:s,onFailure:s,onTimeout:s})}}else e.dispatch(a.refreshPreview({trigger:a.RefreshPreviewTrigger.Publish})),t.packagerMonitor.unsubscribe()}},12297:function(e,t,n){"use strict";n.r(t),n.d(t,"sendPreviewMetadata",(function(){return y})),n.d(t,"sendAppModuleDescriptor",(function(){return S})),n.d(t,"sendSiteMapDescriptor",(function(){return A})),n.d(t,"sendInitialNavigation",(function(){return j}));var r=n(12290),a=n(217),o=n(12058),i=n(12298),s=n(12289),c=n(12293),l=n(10303),u=n(12003),d=n(11990),p=n(12005),f=n(11984),m=n(12288),b=n(12295);function v(e,t,n,r,a,o,i){try{var s=e[o](i),c=s.value}catch(l){return void n(l)}s.done?t(c):Promise.resolve(c).then(r,a)}function g(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){v(o,r,a,i,s,"next",e)}function s(e){v(o,r,a,i,s,"throw",e)}i(void 0)}))}}function y(e,t){return h.apply(this,arguments)}function h(){return(h=g((function*(e,t){var n=Object(a.trackOtherScenario)(u.default,d.default.PreviewMetadataSend);try{yield S(e,t),yield A(e,t),yield j(e,t),n.complete()}catch(r){n.failure(r)}}))).apply(this,arguments)}function S(e,t){return O.apply(this,arguments)}function O(){return(O=g((function*(e,t){var n=yield Object(i.generateAppModuleDescriptor)(e,t);yield t.uciSyncService.sendMessageToUCI({type:r.UCISyncMessageType.UCISyncMessage,actionName:"AppModuleMetadataUpdated",actionData:n,success:!0})}))).apply(this,arguments)}function A(e,t){return P.apply(this,arguments)}function P(){return(P=g((function*(e,t){var n=Object(c.getSiteMapDescriptorGeneratorInstance)()(e,t);yield t.uciSyncService.sendMessageToUCI({type:r.UCISyncMessageType.UCISyncMessage,actionName:"SiteMapMetadataUpdated",actionData:n,success:!0})}))).apply(this,arguments)}function j(e,t){return E.apply(this,arguments)}function E(){return(E=g((function*(e,t){var n=f.Selectors.getSelection(e.getState());Object(o.isPagesPaneSelection)(n)&&Object(m.onPagesNodeSelected)(t,n)||Object(o.isSiteMapPaneSelection)(n)&&Object(b.onSiteMapNodeSelected)(e,t,n)||(yield C(e,t))}))).apply(this,arguments)}function C(e,t){return T.apply(this,arguments)}function T(){return(T=g((function*(e,t){var n,r=p.Selectors.getSiteMap(e.getState()).value;if(!r)throw new Error("Cannot navigate via siteMap because siteMap has not been loaded yet");var{area:a,subArea:o}=null!==(n=Object(l.getFirstVisibleSubAreaWithAncestors)(r.siteMapXml))&&void 0!==n?n:{};if(!a||!o)throw new Error("Cannot navigate via siteMap because there was no visible subArea in the current siteMap");return yield Object(s.sendNavigateToSiteMapSubAreaMessage)(t.uciSyncService,{containingAreaId:a.Id,subAreaDescriptor:Object(c.convertSubAreaToPreviewFormat)(o)})}))).apply(this,arguments)}},12298:function(e,t,n){"use strict";n.r(t),n.d(t,"generateAppModuleDescriptor",(function(){return d}));var r=n(12299),a=n(217),o=n(12005),i=n(10299),s=n(12003),c=n(11990);function l(e,t,n,r,a,o,i){try{var s=e[o](i),c=s.value}catch(l){return void n(l)}s.done?t(c):Promise.resolve(c).then(r,a)}function u(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){l(o,r,a,i,s,"next",e)}function s(e){l(o,r,a,i,s,"throw",e)}i(void 0)}))}}function d(e,t){return p.apply(this,arguments)}function p(){return(p=u((function*(e,t){var n=e.getState(),r=o.Selectors.getAppModule(n).value,a=o.Selectors.getSolutionInfo(n).value;if(!r)throw new Error("Cannot create app module descriptor because app module has not been loaded");if(!a)throw new Error("Cannot create app module descriptor because solution info has not been loaded");var i;return i=(yield f(t,r.appInfo.appId))?r.appInfo.appId:null,{SolutionId:a.id,UniqueName:r.appInfo.uniqueName,Title:r.appInfo.title,Description:r.appInfo.description,AppId:i,Status:0,ClientType:4,IsFeatured:0,NavigationType:0,Components:[],AppComponents:{Entities:[]},AppSettings:[]}}))).apply(this,arguments)}function f(e,t){return m.apply(this,arguments)}function m(){return(m=u((function*(e,t){var n=e.apolloClient,o=!0,l=Object(a.trackLoadScenario)(s.default,c.default.CheckIfAppModuleEverBeenPublished,{appModuleId:t});try{o=!!(yield n.query({query:r.isAppModulePublishedQuery,variables:{id:t},fetchPolicy:"network-only"})).data.isAppModulePublished,l.complete({appModuleId:t,appModuleHasEverBeenPublished:o})}catch(u){l.completeWithError(new i.CodedError({code:i.ErrorCodes.AppModuleHasBeenPublished,innerError:u}))}return o}))).apply(this,arguments)}},12299:function(e,t,n){"use strict";n.r(t),n.d(t,"isAppModulePublishedQuery",(function(){return s}));var r,a=n(3128);var o,i,s=n.n(a)()(r||(o=["\n  query isAppModulePublished($id: String!) {\n    isAppModulePublished(appModuleId: $id)\n  }\n"],i||(i=o.slice(0)),r=Object.freeze(Object.defineProperties(o,{raw:{value:Object.freeze(i)}}))))},12300:function(e,t,n){"use strict";n.r(t),n.d(t,"initialState",(function(){return c}));var r=n(11986),a=n(12286);function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var c={previewSessionInstance:0},l=Object(r.createReducer)(c).handleAction(a.refreshPreview,e=>i(i({},e),{},{previewSessionInstance:e.previewSessionInstance+1}));t.default=l},12301:function(e,t,n){"use strict";n.r(t),n.d(t,"getPreviewSessionInstance",(function(){return r}));var r=e=>e.preview.previewSessionInstance},12302:function(e,t,n){"use strict";n.r(t),n.d(t,"previewDisplayName",(function(){return N})),n.d(t,"UnconnectedPreviewCanvas",(function(){return D})),n.d(t,"PreviewCanvas",(function(){return B}));var r=n(1697),a=n(1201),o=n(719),i=n(545),s=n(12303),c=n(12290),l=n(1105),u=n(1071),d=n(922),p=n(217),f=n(245),m=n(10443),b=n(11993),v=n(12005),g=n(12285),y=n(12286),h=n(12004),S=n(12305),O=n(12003),A=n(12306),P=n(12334),j=n(12337),E=n(12338),C=n(12339);function T(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function M(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?T(Object(n),!0).forEach((function(t){w(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):T(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function w(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function I(){return(I=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var N="AppPreview",D=e=>{var t,n,{syncServiceOverride:a,t:o}=e,i=Object(m.useDispatch)(),l=f.useRef(Object(h.getDeferredPromise)()),{uciDimensionsUpdatedHandler:u,clearDimensionsUpdatedHandlers:d,registerToDimensionUpdatedEvent:S}=Object(E.useDimensionHandlers)(),{isPreviewDataReady:T,uciSyncService:M}=Object(C.useUCISyncService)({syncServiceOverride:a,onInitialized(e){e.registerToDimensionUpdatedEvent(u),l.current.resolve()},onDisposed(){d()}}),w=Object(m.useSelector)(v.Selectors.getAppModule);if(!w.value)return f.createElement(x,{key:"previewSpinner",label:o("preview.loadApp")});var N=M.getPreviewUrl().replace("{appId}",w.value.appInfo.appId),D=null!==(t=e.currentEnvironment)&&void 0!==t&&null!==(n=t.properties.linkedEnvironmentMetadata)&&void 0!==n&&n.instanceUrl?f.createElement(s.UCIPreview,{orgUrl:e.currentEnvironment.properties.linkedEnvironmentMetadata.instanceUrl,uciUrl:N,reinitializePreview:()=>(l.current=Object(h.getDeferredPromise)(),i(g.Actions.refreshPreview({trigger:y.RefreshPreviewTrigger.SyncService})),l.current),initializePreview:()=>l.current,surfaceScope:O.default,strings:{checkAccessTitle:o("UCIPreview.checkAccessTitle"),checkAccessContent:o("UCIPreview.checkAccessContent"),checkAccessButtonText:o("UCIPreview.checkAccessButtonText"),loadFailedTitle:o("UCIPreview.loadFailedTitle"),loadFailedContent:o("UCIPreview.loadFailedContentFormat",{sessionID:Object(p.getSessionId)()}),loadingSpinnerLabel:o("UCIPreview.loadingSpinnerLabel")}}):null;return f.createElement(f.Fragment,null,f.createElement("div",{className:k(T),"aria-hidden":!T},b.settings.useLocalPreview&&f.createElement(r.MessageBar,{styles:{root:{zIndex:12345}}},"Preview is currently in Local Mode"),f.createElement(j.PackagerMonitorNotification,null),f.createElement("div",{id:"previewInnerCanvas",className:R},f.createElement(A.CanvasContainer,I({},e,{onScrollHandler:(e,t,n)=>{M.sendMessageToUCI({type:c.UCISyncMessageType.UCISyncMessage,actionName:"ScrollUpdated",actionData:{id:e,scrollLeft:t,scrollTop:n}})},registerToInnerElementDimensionUpdatedEvent:S}),D))),f.createElement("div",{id:"previewPlaceholder","aria-hidden":T,className:L(!T)},f.createElement(P.CanvasPlaceholder,null)))},x=e=>{var{label:t}=e;return f.createElement("div",{id:"spinnersurface",className:U},f.createElement(a.Spinner,{label:t,styles:{root:{height:"100%"}}}))},k=Object(i.memoizeFunction)(e=>Object(o.mergeStyles)(M({height:"100%",width:"100%"},Object(S.fadeVisibility)(e)))),R=Object(o.mergeStyles)({display:"flex",height:"100%",width:"100%",position:"absolute",top:0,left:0}),L=Object(i.memoizeFunction)(e=>Object(o.mergeStyles)(M({height:"calc(100% - 28px)",width:"100%",position:"absolute",top:0,left:0},Object(S.fadeVisibility)(e)))),U=Object(o.mergeStyles)({width:"100%",height:"100%"}),B=Object(u.withServices)(D,[f.memo,l.withEnvironment,Object(d.translateService)("AppModuleDesigner")])},12305:function(e,t,n){"use strict";function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:300;return{visibility:e?"visible":"hidden",opacity:e?1:0,transition:e?"visibility 0s linear 0s, opacity ".concat(t,"ms ease"):"visibility 0s linear ".concat(t,"ms, opacity ").concat(t,"ms ease")}}n.r(t),n.d(t,"fadeVisibility",(function(){return r}))},12306:function(e,t,n){"use strict";n.r(t),n.d(t,"UnconnectedCanvasContainer",(function(){return y})),n.d(t,"CanvasContainer",(function(){return h}));var r=n(12307),a=n(12323),o=n(12324),i=n(12325),s=n(12326),c=n(12327),l=n(1071),u=n(4135),d=n(922),p=n(719),f=n(12330),m=n(245),b=n(12333),v=Object(p.mergeStyleSets)({canvasStyles:{overflow:"hidden",height:"100%",width:"100%",position:"relative"},canvasAreaStyles:b.canvasAreaStyles}),g={zIndex:99},y=e=>{var[t,n]=m.useState(1),[l,d]=m.useState(!1),[p,y]=m.useState(!1),[h,S]=m.useState(!1),[O,A]=m.useState(!1),P=m.useRef(void 0),j=m.useRef("responsive"),{canvasAreaRef:E,tryGetCanvasAreaSize:C}=Object(b.useCanvasArea)({onCanvasAreaInitialized:e=>{P.current=e,T(!1)}}),T=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=C();if(t){var{height:r,width:a}=t,{height:o,width:i}=I(),s=a/i,c=r/o,l=s;s*o>r&&(l=c);var u=!0===e?Math.min(1,l):l;n(u)}},M=()=>{T(!0)},w=()=>Object(o.getAvailableViewPorts)(e.t,P.current),I=()=>w()[j.current].size,N=e=>{e&&(S(!1),A(!1))};m.useEffect(()=>(window.addEventListener("resize",M),e.registerToInnerElementDimensionUpdatedEvent(N,void 0),()=>{window.removeEventListener("resize",M)}),[]);var D=m.createElement("div",{className:v.canvasStyles},m.createElement(r.Canvas,{rootCanvasElement:null,onScroll:(t,n,r)=>{e.onScrollHandler(t,n,r),S(!0)},scale:1.5,shouldShowAdorners:!h&&!O&&!l,shouldShowScrollbars:!O&&!l,allowInteractionWithChildren:!0,allowDrop:!1,allowDrag:!1},e.children)),x="responsive"===j.current,k=I(),R=m.createElement(f.Resizable,{size:k,onResize:(e,t,n,r)=>{P.current={width:n.offsetWidth,height:n.offsetHeight},A(!0)},onResizeStart:()=>{d(!0),A(!0)},onResizeStop:()=>{d(!1),A(!1)},enable:{top:x,right:x,bottom:x,left:x,topRight:x,bottomRight:x,bottomLeft:x,topLeft:x},handleStyles:{top:g,right:g,bottom:g,left:g,topRight:g,bottomRight:g,bottomLeft:g,topLeft:g}},D),L=m.createElement(c.Zoomable,{scale:t,elementDimensions:k},R),U=m.createElement(a.CanvasFooter,{onWidthChanged:e=>{e<400&&!p&&y(!0),e>=400&&p&&y(!1)},onRenderLeftContent:m.createElement(i.ViewPortSwitcher,{isSlimMode:p,selectedViewPortKey:j.current,availableViewPorts:w(),onViewPortChange:e=>{j.current=e,T(),A(!0)},isDisabled:1===Object.keys(w()).length,t:e.t}),onRenderRightContent:m.createElement(s.ZoomSlider,{isSlimMode:p,value:100*t,onChange:e=>{n(e/100)},onFitToWindowClicked:()=>T(),t:e.t})});return m.createElement(m.Fragment,null,m.createElement("div",{className:v.canvasAreaStyles,ref:E},L),!e.disableFooter&&m.createElement(u.Designer.Footer,null,U))},h=Object(l.withServices)(y,[m.memo,Object(d.translateService)("AppModuleDesigner")])},12313:function(e,t,n){"use strict";n.r(t),n.d(t,"DropHints",(function(){return i}));var r=n(545),a=n(12314),o=n(12315),i=Object(r.styled)(a.DropHintsBase,o.getStyles)},12314:function(e,t,n){"use strict";n.r(t),n.d(t,"DropHintsBase",(function(){return l}));var r=n(545),a=n(245);function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var s=Object(r.classNamesFunction)(),c=(e,t)=>{switch(e){case"up":return t.caretUp||"";case"down":return t.caretDown||"";case"right":return t.caretRight||"";case"left":return t.caretLeft||"";default:return""}},l=e=>{var t=s(e.styles,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e)),n=e.carets&&e.carets.topLeft?a.createElement("div",{className:"".concat(t.caret," ").concat(t.caretTopLeft," ").concat(c(e.carets.topLeft,t))}):a.createElement(a.Fragment,null),r=e.carets&&e.carets.topRight?a.createElement("div",{className:"".concat(t.caret," ").concat(t.caretTopRight," ").concat(c(e.carets.topRight,t))}):a.createElement(a.Fragment,null),l=e.carets&&e.carets.bottomLeft?a.createElement("div",{className:"".concat(t.caret," ").concat(t.caretBottomLeft," ").concat(c(e.carets.bottomLeft,t))}):a.createElement(a.Fragment,null),u=e.carets&&e.carets.bottomRight?a.createElement("div",{className:"".concat(t.caret," ").concat(t.caretBottomRight," ").concat(c(e.carets.bottomRight,t))}):a.createElement(a.Fragment,null),d=""+t.root;return d+=e.isInvalidTarget?" "+t.invalidTarget:"",d+=e.isClickThroughTarget?" "+t.clickThroughTarget:"",a.createElement("div",{className:d},e.children,n,l,r,u)}},12315:function(e,t,n){"use strict";n.r(t),n.d(t,"getStyles",(function(){return r}));var r=e=>{var{className:t}=e;return{root:[t,{position:"absolute",width:"100%",height:"100%",borderStyle:"solid",borderColor:e.theme?e.theme.palette.themePrimary:"black",borderTopWidth:e.borders&&e.borders.top?2:0,borderBottomWidth:e.borders&&e.borders.bottom?2:0,borderRightWidth:e.borders&&e.borders.right?2:0,borderLeftWidth:e.borders&&e.borders.left?2:0}],caret:{width:0,height:0,borderColor:e.theme?e.theme.palette.themePrimary:"black",position:"absolute",borderStyle:"solid",borderWidth:10},caretTopLeft:{top:0,left:0,transform:"translate(-50%, -50%)"},caretTopRight:{top:0,right:0,transform:"translate(50%, -50%)"},caretBottomLeft:{left:0,bottom:0,transform:"translate(-50%, 50%)"},caretBottomRight:{bottom:0,right:0,transform:"translate(50%, 50%)"},caretRight:{borderRightColor:"transparent",borderTopColor:"transparent",borderBottomColor:"transparent"},caretLeft:{borderLeftColor:"transparent",borderTopColor:"transparent",borderBottomColor:"transparent"},caretDown:{borderRightColor:"transparent",borderLeftColor:"transparent",borderBottomColor:"transparent"},caretUp:{borderRightColor:"transparent",borderLeftColor:"transparent",borderTopColor:"transparent"},invalidTarget:{cursor:"no-drop"},clickThroughTarget:{cursor:"pointer"}}}},12333:function(e,t,n){"use strict";n.r(t),n.d(t,"canvasAreaStyles",(function(){return a})),n.d(t,"useCanvasArea",(function(){return o}));var r=n(245),a={flexGrow:1,padding:20,overflow:"auto"};function o(e){var t,n,[a,o]=r.useState(!1),i=r.useRef(null),s=()=>{if(!(!i.current||i.current.offsetHeight<1||i.current.offsetWidth<1))return{height:Math.max(0,i.current.offsetHeight-40),width:Math.max(0,i.current.offsetWidth-40)}};return r.useLayoutEffect(()=>{if(!a){var t=s();t&&(e.onCanvasAreaInitialized(t),o(!0))}},[null===(t=i.current)||void 0===t?void 0:t.offsetHeight,null===(n=i.current)||void 0===n?void 0:n.offsetWidth]),{canvasAreaRef:i,tryGetCanvasAreaSize:s}}},12334:function(e,t,n){"use strict";n.r(t),n.d(t,"CanvasPlaceholder",(function(){return g}));var r=n(4053),a=n(684),o=n(1277),i=n(1795),s=n(1837),c=n(923),l=n(245),u=n(10443),d=n(12335),p=n.n(d),f=n(12005),m=n(11984),b=n(12066),v=n(12336),g=()=>{var e,t,n,d,g,y,h=Object(b.default)(),{t:S}=Object(c.useTranslation)("AppModuleDesigner"),O=Object(u.useDispatch)(),A=Object(u.useSelector)(f.Selectors.getSiteMap),P=[];return(void 0===(null===(e=A.value)||void 0===e?void 0:e.showHome)||null!==(t=A.value)&&void 0!==t&&t.showHome)&&P.push({key:"home",name:S("preview.home"),iconProps:{iconName:"home"},disabled:!0}),(void 0===(null===(n=A.value)||void 0===n?void 0:n.showRecents)||null!==(d=A.value)&&void 0!==d&&d.showRecents)&&P.push({key:"recent",name:S("preview.recent"),iconProps:{iconName:"recent"},disabled:!0}),(void 0===(null===(g=A.value)||void 0===g?void 0:g.showPinned)||null!==(y=A.value)&&void 0!==y&&y.showPinned)&&P.push({key:"pinned",name:S("preview.pinned"),iconProps:{iconName:"pinned"},disabled:!0}),l.createElement(i.Stack,{horizontal:!0,styles:v.containerStackStyles},l.createElement(r.Sidebar,{"aria-disabled":!0,theme:h,collapsible:!0,collapseButtonAriaLabel:S("preview.globalNavButtonAriaLabel"),items:P}),l.createElement(i.Stack.Item,{grow:1},l.createElement(i.Stack,{styles:Object(v.useCanvasStackStyles)(),tokens:{childrenGap:28}},l.createElement(o.Image,{src:p.a,alt:S("preview.callToAction"),styles:v.badgeStyles}),l.createElement(s.Text,{styles:v.messageStyles,variant:"mediumPlus"},S("preview.callToAction")),l.createElement(a.PrimaryButton,{"data-cy":"canvasPlaceholderNewPage",iconProps:{iconName:"add"},onClick:()=>O(m.Actions.openAddPageUI())},S("pagesPane.newPage")))))}},12335:function(e,t,n){e.exports=n.p+"static/media/CanvasPlaceholderBadge.5ca38d82.svg"},12336:function(e,t,n){"use strict";n.r(t),n.d(t,"containerStackStyles",(function(){return a})),n.d(t,"useCanvasStackStyles",(function(){return o})),n.d(t,"badgeStyles",(function(){return i})),n.d(t,"messageStyles",(function(){return s}));var r=n(12066),a={root:{height:"100%",margin:"16px"}};function o(){return{root:{height:"100%",background:Object(r.default)().palette.white,alignItems:"center",justifyContent:"center",overflow:"hidden"}}}var i={image:{width:"200px",height:"200px"}},s={root:{fontWeight:600}}},12337:function(e,t,n){"use strict";n.r(t),n.d(t,"PackagerMonitorNotification",(function(){return f}));var r=n(687),a=n(1090),o=n(1697),i=n(4135),s=n(923),c=n(245),l=n(10443),u=n(12167),d=n(12285),p=n(12286),f=()=>{var e=Object(u.useIsPackagingInProgress)(),t=Object(l.useDispatch)(),{t:n}=Object(s.useTranslation)("AppModuleDesigner");return e?c.createElement(i.Designer.MessageBar,{messageBarType:o.MessageBarType.info},n("preview.packagingInProgress"),c.createElement(a.Link,{onClick:()=>{t(d.Actions.refreshPreview({trigger:p.RefreshPreviewTrigger.Manual}))},styles:{root:{marginLeft:8}}},c.createElement(r.Icon,{styles:{root:{marginRight:4,transform:"translateY(2px)"}},iconName:"Refresh"}),n("preview.forceRefresh"))):null}},12338:function(e,t,n){"use strict";n.r(t),n.d(t,"useDimensionHandlers",(function(){return a}));var r=n(245);function a(){var e=r.useRef([]);return{uciDimensionsUpdatedHandler:t=>{e.current.forEach(e=>{e.callback.apply(e.context,[!!t])})},clearDimensionsUpdatedHandlers:()=>{e.current=[]},registerToDimensionUpdatedEvent:(t,n)=>{e.current.push({callback:t,context:n})}}}},12339:function(e,t,n){"use strict";n.r(t),n.d(t,"useUCISyncService",(function(){return l}));var r=n(245),a=n(10443),o=n(12340),i=n(12005),s=n(12285),c=n(12341);function l(e){var t=r.useContext(o.UCISyncServiceContext);e.syncServiceOverride&&(t=e.syncServiceOverride);var[n,l]=r.useState(!1),u=void 0!==Object(a.useSelector)(i.Selectors.getFirstVisibleSubArea),d=Object(a.useSelector)(s.Selectors.getPreviewSessionInstance),p=Object(c.useOnNavigationHandler)(),f=Object(a.useDispatch)();return r.useEffect(()=>(t.initialize().then(()=>{l(!0),e.onInitialized(t)}),t.addRequestHandler("OnNavigation",p),()=>{l(!1),t.dispose(),e.onDisposed()}),[d,t]),r.useEffect(()=>{n&&u&&f(s.Actions.previewInitialized())},[n,u]),{isPreviewDataReady:u,isSyncServiceInitialized:n,uciSyncService:t,previewSessionInstance:d}}},12340:function(e,t,n){"use strict";n.r(t),n.d(t,"UCISyncServiceContext",(function(){return a}));var r=n(245),a=r.createContext(void 0)},12341:function(e,t,n){"use strict";n.r(t),n.d(t,"useOnNavigationHandler",(function(){return p}));var r=n(12290),a=n(245),o=n(10443),i=n(12285),s=n(10297),c=n(217),l=n(12003),u=n(11989);function d(e,t,n,r,a,o,i){try{var s=e[o](i),c=s.value}catch(l){return void n(l)}s.done?t(c):Promise.resolve(c).then(r,a)}function p(){var e=Object(o.useDispatch)();return a.useCallback(function(){var t,n=(t=function*(t){var n,{pageName:r,inputOrSource:a}=null!==(n=t.actionData)&&void 0!==n?n:{};if("OnNavigation"!==t.actionName)return f(!1);if(!a||"string"==typeof a)return f(!1);switch(Object(c.trackInfoTrace)(l.default,{eventName:u.default.PreviewSourceNavigationReported,eventData:{pageName:r}}),r){case"entitylist":var{entityName:o}=a;o?e(i.Actions.previewPageChanged({type:"EntityView",entityLogicalName:o})):Object(c.trackErrorTrace)(l.default,{eventName:u.default.PreviewSourceNavigationFailed,eventData:{cause:"Preview provided an entitylist navigation, but provided inputOrSource did not contain entityName"}});break;case"entityrecord":var{entityName:d}=a;d?e(i.Actions.previewPageChanged({type:"EntityForm",entityLogicalName:d})):Object(c.trackErrorTrace)(l.default,{eventName:u.default.PreviewSourceNavigationFailed,eventData:{cause:"Preview provided an entityrecord navigation, but provided inputOrSource did not contain entityName"}});break;case"dashboard":var p,{dashboardId:m}=a;if(void 0===m)return Object(c.trackInfoTrace)(l.default,{eventName:u.default.PreviewSourceNavigationFailed,eventData:{message:"Preview provided a dashboard navigation, but provided inputOrSource contained an undefined dashboardId"}}),f(!1);var b=null===(p=Object(s.extractBracketedUuid)(m))||void 0===p?void 0:p.toLowerCase();b?e(i.Actions.previewPageChanged({type:"Dashboard",dashboardId:b})):Object(c.trackErrorTrace)(l.default,{eventName:u.default.PreviewSourceNavigationFailed,eventData:{cause:"Preview provided a dashboard navigation, but provided inputOrSource did not contain valid dashboardId, Here is what was provided: ".concat(m)}});break;case"custom":var{name:v}=a;v?e(i.Actions.previewPageChanged({type:"CustomPage",customPageName:v})):Object(c.trackErrorTrace)(l.default,{eventName:u.default.PreviewSourceNavigationFailed,eventData:{cause:"Preview provided a custom navigation, but provided inputOrSource did not contain page name"}});break;default:return f(!1)}return f(!0)},function(){var e=this,n=arguments;return new Promise((function(r,a){var o=t.apply(e,n);function i(e){d(o,r,a,i,s,"next",e)}function s(e){d(o,r,a,i,s,"throw",e)}i(void 0)}))});return function(e){return n.apply(this,arguments)}}(),[e])}function f(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return{type:r.UCISyncMessageType.UCISyncMessage,actionName:"OnNavigation",actionData:{},success:e}}},12342:function(e,t,n){"use strict";n.r(t),n.d(t,"PropertiesPane",(function(){return P}));var r=n(1071),a=n(4135),o=n(922),i=n(245),s=n(10443),c=n(12058),l=n(12196),u=n(12116),d=n(12031),p=n(12343),f=n(12344),m=n(12348),b=n(12350),v=n(12351),g=n(12361),y=n(12363),h=n(12129),S=n(12364);function O(){return(O=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var A=e=>{var t=Object(s.useSelector)(l.Selectors.selectedPagesNode),n=Object(s.useSelector)(u.Selectors.selectedSiteMapNode),r=Object(s.useSelector)(u.Selectors.selectedSiteMapNodeType);return(null==t?void 0:t.nodeType)===c.PagesPaneNodeType.App?i.createElement(f.AppNodePropertySheet,null):(null==t?void 0:t.nodeType)===c.PagesPaneNodeType.EntityView?i.createElement(v.EntityViewPropertySheet,null):(null==t?void 0:t.nodeType)===c.PagesPaneNodeType.EntityForm?i.createElement(g.EntityFormPropertySheet,null):(null==t?void 0:t.nodeType)===c.PagesPaneNodeType.CustomPage?i.createElement(m.CustomPagePropertySheet,O({},e,{customPage:t.relatedCustomPage})):(null==t?void 0:t.nodeType)===c.PagesPaneNodeType.Dashboard?i.createElement(b.DashboardPropertySheet,O({},e,{dashboard:t.relatedDashboard})):n?i.createElement(S.SiteMapPropertySheet,O({},e,{siteMapNode:n})):r===c.SiteMapPaneNodeType.Navigation?i.createElement(y.NavigationNodePropertySheet,null):i.createElement("sub",null,e.t("propertiesPane.empty"))},P=Object(r.withServices)(e=>{var t=Object(s.useSelector)(l.Selectors.selectedPagesNode),n=Object(s.useSelector)(u.Selectors.selectedSiteMapNode),r=Object(s.useSelector)(u.Selectors.selectedSiteMapNodeType),o=Object(s.useSelector)(u.Selectors.getNodeSoftTitleHelper),f=Object(d.useEnvironmentLanguageCode)(),m=Object(p.useAppDetailsTitle)(),b=e.t("propertiesPane.header");if((null==t?void 0:t.nodeType)===c.PagesPaneNodeType.App)b=m;else if((null==t?void 0:t.nodeType)===c.PagesPaneNodeType.EntityView){var v;b=e.t("pagesPane.entityViewLinkTitle",{entity:null===(v=t.relatedEntity)||void 0===v?void 0:v.displayName})}else if((null==t?void 0:t.nodeType)===c.PagesPaneNodeType.EntityForm){var g;b=e.t("pagesPane.entityFormLinkTitle",{entity:null===(g=t.relatedEntity)||void 0===g?void 0:g.displayName})}else if((null==t?void 0:t.nodeType)===c.PagesPaneNodeType.CustomPage){var y;b=null===(y=t.relatedCustomPage)||void 0===y?void 0:y.displayName}else if((null==t?void 0:t.nodeType)===c.PagesPaneNodeType.Dashboard){var S;b=null===(S=t.relatedDashboard)||void 0===S?void 0:S.displayName}else n?b=o(n,e.t,f):r===c.SiteMapPaneNodeType.Navigation&&(b=e.t("navigation.navigationBar"));return i.createElement(a.Designer.RightPane,{title:b,styles:h.rightPaneStyles},i.createElement(A,e))},[i.memo,Object(o.translateService)("AppModuleDesigner")])},12343:function(e,t,n){"use strict";n.r(t),n.d(t,"useAppDetailsTitle",(function(){return c}));var r=n(923),a=n(245),o=n.n(a),i=n(10443),s=n(12005);function c(){var{t:e}=Object(r.useTranslation)("AppModuleDesigner"),t=Object(i.useSelector)(s.Selectors.appModuleTitle);return o.a.useMemo(()=>t||e("pagesPane.appNode"),[t,e])}},12344:function(e,t,n){"use strict";n.r(t),n.d(t,"AppNodePropertySheet",(function(){return o}));var r=n(245),a=n(12345),o=()=>r.createElement(a.AppDetails,null)},12345:function(e,t,n){"use strict";n.r(t),n.d(t,"AppDetails",(function(){return f}));var r=n(1372),a=n(1795),o=n(1837),i=n(12070),s=n(923),c=n(245),l=n(10443),u=n(12005),d=n(12018),p=n(12346),f=()=>Object(l.useSelector)(u.Selectors.getAppModule).loadState===d.LoadStates.Loaded?c.createElement(c.Suspense,{fallback:c.createElement(p.AppDetailsShimmer,null)},c.createElement(m,null)):c.createElement(p.AppDetailsShimmer,null),m=()=>{var e,t,{t:n}=Object(s.useTranslation)("AppModuleDesigner"),d=Object(l.useSelector)(u.Selectors.getSolutionInfo),p=Object(l.useSelector)(u.Selectors.appModuleTitle),f=Object(l.useSelector)(u.Selectors.appModuleDescription),m=Object(l.useDispatch)(),g={key:"main",properties:[{key:"solutionInfo",inputType:"custom",label:n("settings.general.app.solutionInfo"),value:null===(e=d.value)||void 0===e?void 0:e.friendlyName,visible:!(null===(t=d.value)||void 0===t||!t.friendlyName),onRender:e=>{var t;return c.createElement(a.Stack,{styles:b},c.createElement(r.Label,{disabled:e.disabled,styles:v},null!==(t=e.label)&&void 0!==t?t:"&nbsp;"),c.createElement(o.Text,{variant:"medium"},e.value))}},{key:"title",inputType:"text",label:n("settings.general.app.name"),value:p,onChanged:e=>{e&&m(u.App.Actions.updateAppModuleDisplayName(e))}},{key:"description",inputType:"text",multiline:!0,textFieldProps:{rows:3,maxLength:2e3},label:n("settings.general.app.description"),value:f,onChanged:e=>{m(u.App.Actions.updateAppModuleDescription(e))}}]};return c.createElement(i.PropertySheet,{sections:[g]})},b={root:{paddingBottom:16}},v={root:{padding:"0 0 4px 0"}}},12346:function(e,t,n){"use strict";n.r(t),n.d(t,"AppDetailsShimmer",(function(){return p}));var r=n(923),a=n(1755),o=n(1795),i=n(245),s=n(12066),c=n(12347),l=[{type:a.ShimmerElementType.line}],u=[{type:a.ShimmerElementType.line}],d=[{type:a.ShimmerElementType.line,height:32}],p=()=>{var{t:e}=Object(r.useTranslation)("AppModuleDesigner"),t=Object(s.default)(),n={background:t.palette.neutralLighter,shimmer:t.palette.neutralLight,shimmerWave:t.palette.neutralQuaternaryAlt};return i.createElement(o.Stack,{styles:c.shimmerContainerStyles,"aria-busy":!0,"aria-live":"polite","aria-label":e("preview.loadApp")},i.createElement(a.Shimmer,{shimmerColors:n,styles:c.labelShimmerStyles,shimmerElements:l}),i.createElement(a.Shimmer,{shimmerColors:n,styles:c.shimmerStyles,shimmerElements:u}),i.createElement(a.Shimmer,{shimmerColors:n,styles:c.labelShimmerStyles,shimmerElements:l}),i.createElement(a.Shimmer,{shimmerColors:n,styles:c.shimmerStyles,shimmerElements:d}),i.createElement(a.Shimmer,{shimmerColors:n,styles:c.labelShimmerStyles,shimmerElements:l}),i.createElement(a.Shimmer,{shimmerColors:n,styles:c.shimmerStyles,shimmerElements:d}))}},12347:function(e,t,n){"use strict";n.r(t),n.d(t,"shimmerContainerStyles",(function(){return r})),n.d(t,"labelShimmerStyles",(function(){return a})),n.d(t,"shimmerStyles",(function(){return o}));var r=(e,t)=>({root:{flex:"1 1 0"}}),a=e=>{var{theme:t}=e;return{root:["AppDetailsShimmer",{background:"transparent",padding:"8px 0 0",width:"75%"}]}},o=e=>{var{theme:t}=e;return{root:["AppDetailsShimmer",{background:"transparent",padding:"8px 0 16px"}]}}},12348:function(e,t,n){"use strict";n.r(t),n.d(t,"CustomPagePropertySheet",(function(){return i}));var r=n(12070),a=n(245),o=n(12349),i=e=>{var{t:t,customPage:n}=e,i=[];i.push({key:"customPageNameProperty",inputType:"custom",label:t("propertiesPane.namePropertyTitle"),value:n.name,onRender:e=>a.createElement(o.ReadOnlyCustomProperty,{customProperty:e})});var s={key:"main",properties:i};return a.createElement(r.PropertySheet,{sections:[s]})}},12349:function(e,t,n){"use strict";n.r(t),n.d(t,"ReadOnlyCustomProperty",(function(){return u}));var r=n(1372),a=n(1795),o=n(1837),i=n(245),s=n.n(i),c={root:{paddingBottom:16}},l={root:{padding:"0 0 4px 0"}},u=e=>{var t,{customProperty:n}=e;return s.a.createElement(a.Stack,{styles:c},s.a.createElement(r.Label,{disabled:n.disabled,styles:l},null!==(t=n.label)&&void 0!==t?t:"&nbsp;"),s.a.createElement(o.Text,{variant:"medium"},n.value))}},12350:function(e,t,n){"use strict";n.r(t),n.d(t,"DashboardPropertySheet",(function(){return o}));var r=n(12070),a=n(245),o=e=>{var{t:t,dashboard:n}=e,o={key:"main",properties:[]};return a.createElement(r.PropertySheet,{sections:[o]})}},12351:function(e,t,n){"use strict";n.r(t),n.d(t,"EntityViewPropertySheet",(function(){return p}));var r=n(12070),a=n(245),o=n(10443),i=n(12029),s=n(12196),c=n(12352),l=n(12354),u=n(12355),d=n(12360),p=()=>{var e=Object(o.useSelector)(s.Selectors.selectedPagesNode),t=null==e?void 0:e.relatedEntity,n={key:"view",properties:[Object(d.useEntityViewsProperty)(t)]},p={key:"chart",properties:[Object(u.useEntityChartsProperty)(t)]};return t?a.createElement(a.Fragment,null,a.createElement("div",{className:l.entityViewsPropertyStyles.propertySheetContainer},a.createElement(r.PropertySheet,{sections:[n]})),i.featureGates.chartOptionsEnabled&&a.createElement(r.PropertySheet,{sections:[p]})):a.createElement(c.FormShimmer,null)}},12352:function(e,t,n){"use strict";n.r(t),n.d(t,"FormShimmer",(function(){return u}));var r=n(1755),a=n(1795),o=n(245),i=n(12066),s=n(12353),c=[{type:r.ShimmerElementType.line}],l=[{type:r.ShimmerElementType.line,height:32}],u=()=>{var e=Object(i.default)(),t={background:e.palette.neutralLighter,shimmer:e.palette.neutralLight,shimmerWave:e.palette.neutralQuaternaryAlt};return o.createElement(a.Stack,{styles:s.shimmerContainerStyles},o.createElement(r.Shimmer,{shimmerColors:t,styles:s.labelShimmerStyles,shimmerElements:c}),o.createElement(r.Shimmer,{shimmerColors:t,styles:s.shimmerStyles,shimmerElements:l}),o.createElement(r.Shimmer,{shimmerColors:t,styles:s.shimmerStyles,shimmerElements:l}))}},12353:function(e,t,n){"use strict";n.r(t),n.d(t,"shimmerContainerStyles",(function(){return r})),n.d(t,"labelShimmerStyles",(function(){return a})),n.d(t,"shimmerStyles",(function(){return o}));var r=(e,t)=>({root:{flex:"1 1 0"}}),a=e=>{var{theme:t}=e;return{root:["FormShimmer",{background:"transparent",padding:"8px 0 0",width:"75%"}]}},o=e=>{var{theme:t}=e;return{root:["FormShimmer",{background:"transparent",padding:"8px 0 0"}]}}},12354:function(e,t,n){"use strict";n.r(t),n.d(t,"entityViewsPropertyStyles",(function(){return a}));var r=n(719),a=Object(r.mergeStyleSets)({propertySheetContainer:{marginBottom:"20px"}})},12355:function(e,t,n){"use strict";n.r(t),n.d(t,"useEntityChartsProperty",(function(){return p}));var r=n(245),a=n(10443),o=n(12005),i=n(12196),s=n(11984),c=n(12018),l=n(12356),u=n(12352);function d(){return(d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function p(e){var t=Object(a.useSelector)(o.Selectors.getChartsByEntityNameMap),n=e?t[e.logicalName]:void 0,p=Object(a.useSelector)(i.Selectors.enabledChartComponentsForSelectedEntityPageNode),f=Object(a.useDispatch)();r.useEffect(()=>{e&&(n||f(o.Actions.loadChartsByEntityName.request({entityName:e.logicalName})))},[e,n]);var m=Object(c.mapLoaded)(null!=n?n:Object(c.notStarted)(),e=>e.map(e=>{var t;return{key:e.id,text:null!==(t=e.name)&&void 0!==t?t:e.id,componentOption:e}}).sort((e,t)=>e.text.localeCompare(t.text))),b={selectableComponentOptions:m.value,selectedOptionKeys:p,editText:"propertiesPane.charts.editChart",removeText:"propertiesPane.charts.removeChart",handleEdit:t=>{f(s.Actions.editEntityChartPage.open({chartId:t.componentOption.id,entityTypeCode:e.objectTypeCode}))},handleRemove:t=>{f(o.App.Actions.removeChartsFromEntityComponent({entity:e,charts:[t.componentOption]}))},calloutButtonId:"chart-edit-callout-button-id",titleText:"propertiesPane.charts.manageCharts",labelText:"propertiesPane.charts.charts",noOptionSelectedText:"propertiesPane.charts.noChartsSelected",newOptionText:"propertiesPane.charts.newChart",noOptionsText:"propertiesPane.charts.noChartsMatchingSearch",selectOptionText:"propertiesPane.charts.selectCharts"};return{key:"selectedCharts",inputType:"custom",value:p,onChanged:t=>{var n=m.value.filter(e=>t.includes(e.key)).map(e=>e.componentOption);f(o.App.Actions.updateChartsForEntityComponent({entity:e,charts:n}))},onRender:t=>e&&m.value?r.createElement(l.ComponentSelectionManager,d({onSelectionsChanged:t.onChanged},b)):r.createElement(u.FormShimmer,null)}}},12356:function(e,t,n){"use strict";n.r(t),n.d(t,"ComponentSelectionManager",(function(){return m}));var r=n(684),a=n(790),o=n(1372),i=n(1795),s=n(1837),c=n(923),l=n(245),u=n(12126),d=n(12127),p=n(12357),f=n(12129);function m(e){var{selectedOptionKeys:t,selectableComponentOptions:n}=e,[m,b]=l.useState(!1),{t:v}=Object(c.useTranslation)("AppModuleDesigner"),g=n.filter(e=>{var{key:n}=e;return null==t?void 0:t.includes(n)});return l.createElement(l.Fragment,null,l.createElement(o.Label,{styles:{root:{padding:"0 0 8px"}}},v(e.labelText)),l.createElement(i.Stack,{tokens:{childrenGap:8},role:"list"},g.length<=0&&l.createElement(s.Text,{block:!0,variant:"medium"},v(e.noOptionSelectedText)),g.map(t=>l.createElement(d.ListItemPill,{key:t.key,moreButtonProps:{title:v("propertiesPane.moreOptions"),menuProps:{items:[{key:"edit",text:v(e.editText),iconProps:{iconName:"Edit"},onClick:()=>e.handleEdit(t)},{key:"remove",text:v(e.removeText),iconProps:{iconName:"Trash"},onClick:()=>e.handleRemove(t)}]}}},l.createElement("p",{title:t.text,className:u.textStyles.singleLineWithEllipsis},t.text)))),l.createElement(r.ActionButton,{id:e.calloutButtonId,iconProps:{iconName:"Edit"},styles:f.propertyActionButtonStyles,onClick:()=>b(!0)},v(e.titleText)),l.createElement(p.SelectedComponentsCallout,{options:n,selectedKeys:e.selectedOptionKeys,calloutProps:{ariaLabelledBy:e.calloutButtonId,hidden:!m,target:"#".concat(e.calloutButtonId),onDismiss:()=>b(!1),directionalHint:a.DirectionalHint.leftCenter},strings:{calloutTitle:v(e.titleText),calloutHelpText:e.selectOptionText?v(e.selectOptionText):void 0,closeButtonAriaLabel:v("buttons.close"),dismissButtonText:v("buttons.cancel"),saveButtonText:v("buttons.save"),newComponentButtonText:v(e.newOptionText),searchPlaceholder:v("common.search"),noItemsMatchingSearch:v(e.noOptionsText)},onSave:t=>{var n;return null===(n=e.onSelectionsChanged)||void 0===n?void 0:n.call(e,t)}}))}},12357:function(e,t,n){"use strict";n.r(t),n.d(t,"SelectedComponentsCallout",(function(){return h}));var r=n(3161),a=n(684),o=n(790),i=n(1362),s=n(782),c=n(1459),l=n(1252),u=n(1795),d=n(245),p=n(12358),f=n(12132),m=n(12359);function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){g(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function y(){return(y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var h=e=>d.createElement(o.Callout,y({},e.calloutProps,{role:"dialog",setInitialFocus:!0,calloutWidth:330,calloutMaxHeight:380}),d.createElement(S,e)),S=e=>{var{calloutProps:t,onSave:n,options:o,selectedKeys:i,strings:b}=e,{onDismiss:g}=null!=t?t:{},y=Object(m.useSelectedComponentsCalloutStyles)(),h=Object(f.useCalloutLayoutStyles)(),[S,A]=d.useState({});d.useEffect(()=>{A((null!=i?i:[]).reduce((e,t)=>(e[t]=!0,e),{}))},[null==t?void 0:t.hidden]);var[P,j]=Object(p.useDebouncedState)(void 0,250),E=d.useMemo(()=>o.filter(e=>!P||e.text.toLowerCase().includes(P.toLowerCase())).map(e=>({title:e.text,label:e.text,checked:!!S[e.key],onChange:(t,n)=>A(v(v({},S),{},{[e.key]:!!n}))})),[o,S,P,A]);return d.createElement(u.Stack,{className:h.container},d.createElement("div",{className:h.header},d.createElement("div",{className:h.titleRow},d.createElement("h2",{className:h.title},b.calloutTitle),d.createElement(a.IconButton,{iconProps:{iconName:"Cancel"},className:h.closeButton,ariaLabel:b.closeButtonAriaLabel,title:b.closeButtonAriaLabel,onClick:()=>{null==g||g()}})),b.calloutHelpText&&d.createElement("div",{className:h.helpText},b.calloutHelpText),d.createElement(l.SearchBox,{placeholder:b.searchPlaceholder,value:P,onChange:(e,t)=>j(t),onSearch:e=>j(e)})),d.createElement("div",{role:"presentation",className:h.body},d.createElement(s.FocusZone,null,d.createElement(c.List,{className:y.list,items:E,onRenderCell:O})),E.length<=0&&d.createElement(r.EmptyState,{primaryMessage:b.noItemsMatchingSearch,styles:m.emptyStateStyles})),d.createElement("div",{className:h.footer},d.createElement(a.PrimaryButton,{onClick:()=>{n(Object.keys(S).filter(e=>!!S[e])),null==g||g()}},b.saveButtonText),d.createElement(a.DefaultButton,{onClick:()=>{null==g||g()}},b.dismissButtonText)))},O=e=>d.createElement(i.Checkbox,y({},e,{styles:m.checkBoxStyles}))},12358:function(e,t,n){"use strict";n.r(t),n.d(t,"useDebouncedState",(function(){return o}));var r=n(545),a=n(245);function o(e,t){var[n,o]=a.useState(e),i=a.useRef(new r.Async);return[n,a.useMemo(()=>i.current.debounce(o,t),[i.current,t])]}},12359:function(e,t,n){"use strict";n.r(t),n.d(t,"useSelectedComponentsCalloutStyles",(function(){return a})),n.d(t,"checkBoxStyles",(function(){return o})),n.d(t,"addButtonStyles",(function(){return i})),n.d(t,"emptyStateStyles",(function(){return s}));var r=n(719),a=()=>Object(r.mergeStyleSets)({list:{maxHeight:200,overflowX:"hidden",overflowY:"auto"}}),o={root:{paddingTop:8,paddingBottom:8,marginLeft:8},text:{maxWidth:230,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}},i={root:{padding:0},icon:{margin:0}},s={root:{margin:"24px 0 12px"}}},12360:function(e,t,n){"use strict";n.r(t),n.d(t,"useEntityViewsProperty",(function(){return p}));var r=n(245),a=n(10443),o=n(12005),i=n(12196),s=n(11985),c=n(12018),l=n(12356),u=n(12352);function d(){return(d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function p(e){var t=Object(a.useSelector)(o.Selectors.getViewsByEntityNameMap),n=e?t[e.logicalName]:void 0,p=Object(a.useSelector)(i.Selectors.enabledViewComponentsForSelectedEntityPageNode),f=Object(a.useDispatch)();r.useEffect(()=>{e&&(n||f(o.Actions.loadViewsByEntityName.request({entityName:e.logicalName})))},[e,n]);var m=Object(c.mapLoaded)(null!=n?n:Object(c.notStarted)(),e=>e.map(e=>{var t;return{key:e.id,text:null!==(t=e.name)&&void 0!==t?t:e.id,componentOption:e}})),b={selectableComponentOptions:m.value,selectedOptionKeys:p.map(e=>e.id),editText:"propertiesPane.editView",removeText:"propertiesPane.removeView",handleEdit:e=>{f(s.editEntityViewPage.open({viewId:e.componentOption.id}))},handleRemove:t=>{f(o.App.Actions.removeViewsFromEntityComponent({entity:e,views:[t.componentOption]}))},calloutButtonId:"view-edit-callout-button-id",titleText:"propertiesPane.manageViews",labelText:"propertiesPane.views",noOptionSelectedText:"propertiesPane.noViewsSelected",newOptionText:"propertiesPane.newView",noOptionsText:"propertiesPane.noViewsMatchingSearch",selectOptionText:void 0};return{key:"selectedViews",inputType:"custom",value:p.map(e=>e.id),onChanged:t=>{var n=m.value.filter(e=>t.includes(e.key)).map(e=>e.componentOption);f(o.App.Actions.updateViewsForEntityComponent({entity:e,views:n}))},onRender:t=>e&&m.value?r.createElement(l.ComponentSelectionManager,d({onSelectionsChanged:t.onChanged},b)):r.createElement(u.FormShimmer,null)}}},12361:function(e,t,n){"use strict";n.r(t),n.d(t,"EntityFormPropertySheet",(function(){return l}));var r=n(12070),a=n(245),o=n(10443),i=n(12196),s=n(12352),c=n(12362),l=()=>{var e=Object(o.useSelector)(i.Selectors.selectedPagesNode),t=null==e?void 0:e.relatedEntity,n={key:"main",properties:[Object(c.useEntityFormsProperty)(t)]};return t?a.createElement(r.PropertySheet,{sections:[n]}):a.createElement(s.FormShimmer,null)}},12362:function(e,t,n){"use strict";n.r(t),n.d(t,"useEntityFormsProperty",(function(){return p}));var r=n(245),a=n(10443),o=n(12005),i=n(12196),s=n(11985),c=n(12018),l=n(12356),u=n(12352);function d(){return(d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function p(e){var t=Object(a.useSelector)(o.Selectors.getFormsByEntityNameMap),n=e?t[e.logicalName]:void 0,p=Object(a.useSelector)(i.Selectors.enabledFormComponentsForSelectedEntityPageNode),f=Object(a.useDispatch)();r.useEffect(()=>{e&&(n||f(o.Actions.loadFormsByEntityName.request({entityName:e.logicalName})))},[e,n]);var m=Object(c.mapLoaded)(null!=n?n:Object(c.notStarted)(),e=>e.map(e=>{var t;return{key:e.id,text:null!==(t=e.name)&&void 0!==t?t:e.id,componentOption:e}})),b={selectableComponentOptions:m.value,selectedOptionKeys:p.map(e=>e.id),editText:"propertiesPane.editForm",removeText:"propertiesPane.removeForm",handleEdit:t=>{f(s.editEntityFormPage.open({entityLogicalName:e.logicalName,formId:t.componentOption.id}))},handleRemove:t=>{f(o.App.Actions.removeFormsFromEntityComponent({entity:e,forms:[t.componentOption]}))},calloutButtonId:"view-edit-callout-button-id",titleText:"propertiesPane.manageForms",labelText:"propertiesPane.forms",noOptionSelectedText:"propertiesPane.noFormsSelected",newOptionText:"propertiesPane.newForm",noOptionsText:"propertiesPane.noFormsMatchingSearch",selectOptionText:void 0};return{key:"selectedForms",inputType:"custom",value:p.map(e=>e.id),onChanged:t=>{var n=m.value.filter(e=>t.includes(e.key)).map(e=>e.componentOption);f(o.App.Actions.updateFormsForEntityComponent({entity:e,forms:n}))},onRender:t=>e&&m.value?r.createElement(l.ComponentSelectionManager,d({onSelectionsChanged:t.onChanged},b)):r.createElement(u.FormShimmer,null)}}},12363:function(e,t,n){"use strict";n.r(t),n.d(t,"NavigationNodePropertySheet",(function(){return f}));var r=n(12199),a=n(10309),o=n(12070),i=n(923),s=n(245),c=n(10443),l=n(12029),u=n(12005),d=n(12116),p=n(11984),f=()=>{var e,t,n,f,{t:m}=Object(i.useTranslation)("AppModuleDesigner"),b=Object(c.useSelector)(u.Selectors.getSiteMap),v=Object(r.areSiteMapAreasEnabled)(b.value),g=Object(r.haveMultipleAreasInSiteMap)(b.value),y=Object(c.useSelector)(p.Selectors.enableWebResourceSubAreas),h=Object(c.useSelector)(d.Selectors.siteMapHasWebResourceSubAreas),S=Object(a.siteMapUrlSubAreasEnabled)(b.value),O=Object(a.siteMapHasUrlSubAreas)(b.value),A=Object(c.useDispatch)(),P=[];void 0!==(null===(e=b.value)||void 0===e?void 0:e.showHome)&&P.push({key:"showHome",inputType:"checkbox",label:m("siteMapSettings.showHome"),value:b.value.showHome,onChanged:e=>{A(u.App.Actions.updateShowHome(e))}}),void 0!==(null===(t=b.value)||void 0===t?void 0:t.showRecents)&&P.push({key:"showRecents",inputType:"checkbox",label:m("siteMapSettings.showRecents"),value:b.value.showRecents,onChanged:e=>{A(u.App.Actions.updateShowRecents(e))}}),void 0!==(null===(n=b.value)||void 0===n?void 0:n.showPinned)&&P.push({key:"showPinned",inputType:"checkbox",label:m("siteMapSettings.showPinned"),value:b.value.showPinned,onChanged:e=>{A(u.App.Actions.updateShowPinned(e))}}),void 0!==(null===(f=b.value)||void 0===f?void 0:f.enableCollapsibleGroups)&&P.push({key:"enableCollapsibleGroups",inputType:"checkbox",label:m("siteMapSettings.enableCollapsibleGroups"),value:b.value.enableCollapsibleGroups,onChanged:e=>{A(u.App.Actions.updateEnableCollapsibleGroups(e))}}),P.push({key:"enableAreas",inputType:"checkbox",label:m("siteMapSettings.enableAreas"),value:v,disabled:g,onChanged:e=>{A(u.App.Actions.updateEnableAreas(e))}}),l.featureGates.webResourceSubAreasEnabled&&P.push({key:"enableWebResourceSubAreas",inputType:"checkbox",label:m("siteMapSettings.enableWebResourceSubAreas"),value:y,disabled:h,onChanged:e=>{A(p.Actions.updateEnableWebResourceSubAreas(e))}}),l.featureGates.urlSubAreasEnabled&&P.push({key:"enableUrlSubAreas",inputType:"checkbox",label:m("siteMapSettings.enableUrlSubAreas"),value:S,disabled:O,onChanged:e=>{A(u.App.Actions.updateEnableUrlSubAreas(e))}});var j={key:"main",properties:P};return s.createElement(o.PropertySheet,{sections:[j]})}},12364:function(e,t,n){"use strict";n.r(t),n.d(t,"SiteMapPropertySheet",(function(){return u}));var r=n(245),a=n(10443),o=n(12058),i=n(12116),s=n(11984),c=n(12122);function l(){return(l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var u=e=>{var t=Object(a.useDispatch)(),n=Object(a.useSelector)(i.Selectors.selectedEntity),u=Object(a.useSelector)(i.Selectors.selectedDashboard),d=Object(a.useSelector)(i.Selectors.selectedCustomPage),p=Object(a.useSelector)(i.Selectors.selectedUrl),f=Object(a.useSelector)(i.Selectors.selectedSiteMapNodePath);return r.createElement(c.SiteMapNodeInputForm,l({},e,{key:e.siteMapNode.Id,selectedEntityLogicalName:null==n?void 0:n.logicalName,selectedDashboardId:null==u?void 0:u.id,selectedCustomPageName:null==d?void 0:d.name,selectedUrl:p,onTitleChanged:function(e,n){t(i.Actions.updateSelectedNodeTitle({newTitle:e,languageCode:n}))},onIdChanged:function(e){t(i.Actions.updateSelectedNodeId(e))},onEntityChanged:function(e){t(i.Actions.updateSelectedSubAreaEntity(e)),t(s.Actions.selectSiteMapNode({nodeType:o.SiteMapPaneNodeType.SiteMapNode,selectedNodePath:f}))},onDashboardChanged:function(e){t(i.Actions.updateSelectedSubAreaDashboard(e)),t(s.Actions.selectSiteMapNode({nodeType:o.SiteMapPaneNodeType.SiteMapNode,selectedNodePath:f}))},onCustomPageChanged:function(e){t(i.Actions.updateSelectedSubAreaCustomPage(e)),t(s.Actions.selectSiteMapNode({nodeType:o.SiteMapPaneNodeType.SiteMapNode,selectedNodePath:f}))},onUrlChanged:function(e,n){t(i.Actions.updateSelectedSubAreaUrl({urlType:e,url:n})),t(s.Actions.selectSiteMapNode({nodeType:o.SiteMapPaneNodeType.SiteMapNode,selectedNodePath:f}))}}))}},12365:function(e,t,n){"use strict";n.r(t),n.d(t,"SaveConfirmationDialog",(function(){return m}));var r=n(3851),a=n(1071),o=n(922),i=n(684),s=n(890),c=n(245),l=n(10443),u=n(9342),d=n(11984);function p(e,t){return{title:t("saveConfirmationDialog.title"),subText:t("saveConfirmationDialog.subText"),showCloseButton:!1}}var f={root:{verticalAlign:"middle"}},m=Object(a.withServices)(e=>{var{t:t}=e,n=Object(l.useSelector)(d.Selectors.saveConfirmationDialogType),a=Object(l.useSelector)(d.Selectors.isAppSavingOrPublishing),o=Object(u.bindActionCreators)({saveAndContinue:d.Actions.saveConfirmationDialog.saveAndContinue,dismiss:d.Actions.saveConfirmationDialog.dismiss},Object(l.useDispatch)());return c.createElement(s.Dialog,{hidden:void 0===n,maxWidth:440,dialogContentProps:p(n,t),modalProps:{isBlocking:!0},onDismiss:o.dismiss},c.createElement(s.DialogFooter,null,c.createElement(r.LoadingPrimaryButton,{styles:f,text:t("saveConfirmationDialog.saveAndContinue"),onClick:o.saveAndContinue,loading:a,disabled:a}),c.createElement(i.DefaultButton,{styles:f,text:t("buttons.cancel"),onClick:o.dismiss,disabled:a})))},[c.memo,Object(o.translateService)("AppModuleDesigner")])},12366:function(e,t,n){"use strict";n.r(t);var r=n(6641),a=n(1201),o=n(4110),i=n(1071),s=n(922),c=n(245),l=n.n(c),u=n(10443),d=n(12029),p=n(12169),f=n(12005),m=n(12173),b=n(12174),v=n(12367),g=n(12375),y=n(12374),h=n(12066),S=n(12032);function O(){return(O=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function A(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function P(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?A(Object(n),!0).forEach((function(t){j(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):A(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function j(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var E=Object(b.default)({isVisible:p.Selectors.isSettingsModalVisible}),C=Object(m.default)({onClose:p.Actions.hideSettings,loadEnableRoleBasedOfflineProfileAccessSetting:f.Actions.loadEnableRoleBasedOfflineProfileAccessSetting.request}),T=Object(i.withServices)(e=>{var t,{isVisible:n,onClose:i,t:s}=e,[p,f]=Object(c.useState)(!1),[m,b]=Object(c.useState)(!1),A=Object(c.useRef)(!1),j=Object(h.default)(),E=l.a.useMemo(()=>Object(y.settingsModalStyles)(j),[y.settingsModalStyles,j]),C=Object(u.useSelector)(S.getAppModuleId),T=Object(u.useSelector)(S.appModuleUniqueName),M=Object(u.useSelector)(S.getSolutionInfo),w=null==M||null===(t=M.value)||void 0===t?void 0:t.uniqueName,I={onClick:i,onRenderIcon:m?()=>null:void 0},N={exitButtonProps:P(P({},I),{},{onClick:()=>{A.current&&d.featureGates.isMobileOfflineConfigurationEnabled&&T&&e.loadEnableRoleBasedOfflineProfileAccessSetting({appModuleUniqueName:T}),i()}}),appId:C,solutionUniqueName:w,setHasChanges:f,setIsChanging:e=>{b(e),e&&(A.current=!0)}};return l.a.createElement(r.CdsModal,{hasChanges:p,isOpen:n,onDismiss:i,styles:{root:[E.root]},loadingOverlay:m?{spinnerProps:{size:a.SpinnerSize.large},loadingText:s("settings.saving"),overlayProps:{style:{backgroundColor:"rgba(255, 255, 255, 0.9)"}}}:void 0},l.a.createElement(o.TwoTierSettingsExplorer,{name:s("settings.header")},l.a.createElement(o.SettingsPage,{name:s("settings.general.header"),exitButtonProps:I},l.a.createElement(v.default,null)),d.featureGates.enablePowerSettings&&l.a.createElement(g.FeaturesPage,O({name:s("settings.features.header")},N)),d.featureGates.enableUpcomingPowerSettings&&l.a.createElement(g.UpcomingFeaturesPage,O({name:s("settings.upcomingFeatures.header")},N))))},[l.a.memo,Object(s.translateService)("AppModuleDesigner"),Object(u.connect)(E,C)]);t.default=T},12367:function(e,t,n){"use strict";n.r(t);var r=n(245),a=n(12029),o=n(12066),i=n(12345),s=n(12368),c=n(12374);t.default=e=>{var t=Object(o.default)(),n=r.useMemo(()=>Object(c.settingsModalStyles)(t),[t]);return r.createElement(r.Fragment,null,r.createElement("div",{className:n.settingItem},r.createElement(i.AppDetails,null)),a.featureGates.isMobileOfflineConfigurationEnabled&&r.createElement(s.default,null))}},12368:function(e,t,n){"use strict";n.r(t),n.d(t,"UnconnectedMobileOfflineSettingSection",(function(){return C}));var r=n(1071),a=n(922),o=n(217),i=n(1090),s=n(687),c=n(1372),l=n(1864),u=n(1240),d=n(245),p=n(10443),f=n(12369),m=n(12005),b=n(12018),v=n(12173),g=n(12174),y=n(12066),h=n(12003),S=n(11989),O=n(12370),A=n(12373);function P(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?P(Object(n),!0).forEach((function(t){E(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function E(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var C=e=>{var{appModule:t,appModuleMobileOfflineProfileIds:n=[],enableRoleBasedOfflineProfileAccessSetting:r,updateAppModuleMobileOfflineProfiles:a,t:p}=e,[m,v]=d.useState({offlineEnabled:n.length>0});d.useEffect(()=>{!m.offlineEnabled&&n.length>0&&v(e=>j(j({},e),{},{offlineEnabled:!0}))},[n.length]);var g=Object(y.default)(),P=d.useMemo(()=>Object(A.mobileOfflineSettingSectionStyles)(g),[A.mobileOfflineSettingSectionStyles,g]);if((null==t?void 0:t.loadState)!==b.LoadStates.Loaded||r.loadState!==b.LoadStates.Loaded||!0!==r.value)return null;return d.createElement(d.Fragment,null,d.createElement("div",{className:P.settingItem},d.createElement("div",{className:P.container},d.createElement(c.Label,{styles:A.labelStyles},p("settings.general.mobileOffline.enable")),d.createElement("span",{className:P.beside},d.createElement(u.TooltipHost,{content:d.createElement(d.Fragment,null,d.createElement("div",null,p("settings.general.mobileOffline.enableTooltipMessage"))," ",d.createElement(i.Link,{target:"_blank",href:f.mobileOfflineLinks.generalDocumentation},d.createElement("br",null),d.createElement("div",null,p("settings.general.mobileOffline.enableTooltipLearnMore"))))},d.createElement(s.Icon,{iconName:"Info"})))),d.createElement(l.Toggle,{ariaLabel:p("settings.general.mobileOffline.enable"),checked:!!m.offlineEnabled,onChange:(e,t)=>{Object(o.trackCustomEvent)(h.default,{eventName:S.default.ToggleMobileOffline,eventData:{checked:t}}),t||a([]),v(j(j({},m),{},{offlineEnabled:null!=t&&t}))}})),m.offlineEnabled&&d.createElement("div",{className:P.settingItem},d.createElement(c.Label,{styles:A.labelStyles,required:!0},p("settings.general.mobileOffline.profile"),d.createElement("span",{className:P.beside},d.createElement(u.TooltipHost,{content:d.createElement(d.Fragment,null,d.createElement("div",null,p("settings.general.mobileOffline.profileTooltipMessage"))," ",d.createElement(i.Link,{target:"_blank",href:f.mobileOfflineLinks.profileGeneralDocumentation},d.createElement("br",null),d.createElement("div",null,p("settings.general.mobileOffline.profileTooltipLearnMore"))))},d.createElement(s.Icon,{iconName:"Info"})))),d.createElement(O.default,e)))},T=Object(g.default)({appModule:m.Selectors.getAppModule,appModuleMobileOfflineProfileIds:m.Selectors.appModuleMobileOfflineProfileIds,enableRoleBasedOfflineProfileAccessSetting:m.Selectors.getEnableRoleBasedOfflineProfileAccessSetting}),M=Object(v.default)({updateAppModuleMobileOfflineProfiles:m.App.Actions.updateAppModuleMobileOfflineProfiles}),w=Object(r.withServices)(C,[d.memo,Object(a.translateService)("AppModuleDesigner"),Object(p.connect)(T,M)]);t.default=w},12369:function(e,t,n){"use strict";n.r(t),n.d(t,"mobileOfflineLinks",(function(){return r}));var r={generalDocumentation:"https://go.microsoft.com/fwlink/?linkid=2152740",profileGeneralDocumentation:"https://go.microsoft.com/fwlink/?linkid=2152741",maxOneProfilePerAppDocumentation:"https://go.microsoft.com/fwlink/?linkid=2173848",offlineFirstDocumentation:"https://go.microsoft.com/fwlink/?linkid=2152915"}},12370:function(e,t,n){"use strict";n.r(t),n.d(t,"UnconnectedMobileOfflineProfileSelection",(function(){return j}));var r=n(684),a=n(1090),o=n(1201),i=n(12371),s=n(1105),c=n(1071),l=n(922),u=n(217),d=n(245),p=n(10443),f=n(12369),m=n(12005),b=n(11984),v=n(12018),g=n(12173),y=n(12174),h=n(12066),S=n(12003),O=n(11989),A=n(12372),P=n(12373),j=e=>{var t,n,{mobileOfflineProfiles:s,appModuleMobileOfflineProfileIds:c,appModuleTitle:l,loadMobileOfflineProfiles:u,updateAppModuleMobileOfflineProfiles:p,t:m}=e,[b,g]=d.useState(!1),y=()=>g(!0),[S,O]=d.useState(!1),j=Object(h.default)(),M=d.useMemo(()=>Object(P.mobileOfflineSettingSectionStyles)(j),[P.mobileOfflineSettingSectionStyles,j]);d.useEffect(()=>{(null==s?void 0:s.loadState)===v.LoadStates.NotStarted&&u({})},[(null==s?void 0:s.loadState)===v.LoadStates.NotStarted]);var w,I=()=>u({bypassCache:!0}),N=[];if(s.loadState===v.LoadStates.NotStarted||s.loadState===v.LoadStates.Loading)return d.createElement("div",{className:M.flexInputFieldsJustifiedCenter},d.createElement(o.Spinner,{size:o.SpinnerSize.medium}));if(s.loadState===v.LoadStates.Loaded&&(N=C(null!==(w=s.value)&&void 0!==w?w:[])),c.length>1){var D,x,k,{appModuleId:R}=e,L=void 0===(null===(D=e.currentEnvironment)||void 0===D||null===(x=D.properties)||void 0===x||null===(k=x.linkedEnvironmentMetadata)||void 0===k?void 0:k.instanceUrl)||void 0===R;return d.createElement(d.Fragment,null,d.createElement("div",{className:M.smallText},m("settings.general.mobileOffline.multipleProfilesMessage")," ",d.createElement(a.Link,{target:"_blank",href:f.mobileOfflineLinks.maxOneProfilePerAppDocumentation},d.createElement("span",null," ",m("settings.general.mobileOffline.multipleProfilesMessageLearnMore")))),d.createElement("div",{className:M.settingItem},d.createElement(r.DefaultButton,{text:m("settings.general.mobileOffline.editInClassic"),disabled:L,onClick:()=>T(e)})))}var U=()=>{var e=[{key:"Edit",text:m("settings.general.mobileOffline.editProfile"),iconProps:{iconName:"Edit"},onClick:y,disabled:!(null!=c&&c.length)},{key:"Refresh",text:m("settings.general.mobileOffline.refreshProfileList"),iconProps:{iconName:"Refresh"},onClick:I}];return d.createElement(r.IconButton,{ariaLabel:m("settings.general.mobileOffline.moreActionOfflineProfileAriaLabel"),menuIconProps:{iconName:"More",style:{fontSize:16}},menuProps:{items:e}})};return d.createElement(d.Fragment,null,d.createElement("div",{className:M.flexInputFields},d.createElement("div",{className:M.largeLeft},d.createElement(A.default,{loadedMobileOfflineProfiles:N,createMobileOfflineProfile:()=>O(!0)})),d.createElement(U,null)),(null===(t=e.currentEnvironment)||void 0===t?void 0:t.id)&&b&&d.createElement(i.LoadableMobileOfflineProfileConfigurationPanel,{mobileOfflineProfile:{mode:"Edition",mobileOfflineProfileId:c[0]},onClose:()=>g(!1),environment:e.currentEnvironment,preferredLanguageCode:null}),(null===(n=e.currentEnvironment)||void 0===n?void 0:n.id)&&S&&d.createElement(i.LoadableMobileOfflineProfileConfigurationPanel,{mobileOfflineProfile:{mode:"Creation",mobileOfflineProfileName:E(N,l),mobileOfflineProfileInitialEntitiesIds:e.appEntityInfo.map(e=>e.entityId),activeViewsIds:e.appEntityInfo.map(e=>e.views).reduce((e,t)=>e.concat(t),[]).map(e=>e.id),entitiesIdsWithNoSelectedViews:e.appEntityInfo.filter(e=>0===e.views.length).map(e=>e.entityId)},onClose:e=>{void 0!==e&&(e=>{I(),p([e])})(e),O(!1)},environment:e.currentEnvironment,preferredLanguageCode:null}))},E=(e,t)=>{for(var n=0,r=t?"".concat(t," Profile"):"New Profile",a=function(){var t=0===n?r:"".concat(r," ").concat(n);if(!e.some(e=>e.name===t))return{v:t};n++};;){var o=a();if("object"==typeof o)return o.v}},C=e=>[...e].sort((e,t)=>e.name.localeCompare(t.name)),T=e=>{var{switchToClassic:t}=e;Object(u.trackCustomEvent)(S.default,{eventName:O.default.MobileOfflineEditInClassic}),t()},M=Object(y.default)({mobileOfflineProfiles:m.Selectors.getMobileOfflineProfiles,appModuleMobileOfflineProfileIds:m.Selectors.appModuleMobileOfflineProfileIds,appModuleId:m.Selectors.getAppModuleId,appModuleTitle:m.Selectors.appModuleTitle,appEntityInfo:m.Selectors.appEntityInfo}),w=Object(g.default)({loadMobileOfflineProfiles:m.Actions.loadMobileOfflineProfiles.request,updateAppModuleMobileOfflineProfiles:m.App.Actions.updateAppModuleMobileOfflineProfiles,switchToClassic:b.Actions.openSwitchToClassic}),I=Object(c.withServices)(j,[d.memo,Object(l.translateService)("AppModuleDesigner"),s.withEnvironment,Object(p.connect)(M,w)]);t.default=I},12371:function(e,t,n){"use strict";n.r(t),n.d(t,"LoadableMobileOfflineProfileConfigurationPanel",(function(){return a}));var r=n(1074),a=Object(r.default)(()=>Promise.all([n.e(191),n.e(194),n.e(278),n.e(193),n.e(190),n.e(353),n.e(361),n.e(478),n.e(135),n.e(479),n.e(111)]).then(n.bind(null,31491)))},12372:function(e,t,n){"use strict";n.r(t);var r=n(1105),a=n(1071),o=n(922),i=n(1567),s=n(245),c=n(10443),l=n(12005),u=n(12173),d=n(12174),p=n(684),f=Object(d.default)({appModuleMobileOfflineProfileIds:l.Selectors.appModuleMobileOfflineProfileIds}),m=Object(u.default)({updateAppModuleMobileOfflineProfiles:l.App.Actions.updateAppModuleMobileOfflineProfiles}),b=Object(a.withServices)(e=>{var{loadedMobileOfflineProfiles:t,appModuleMobileOfflineProfileIds:n,updateAppModuleMobileOfflineProfiles:r,createMobileOfflineProfile:a,t:o}=e,c=t.map(e=>({key:e.id,id:e.id,text:e.name})),l=[{key:"create-profile",id:"create-profile",text:o("settings.general.mobileOffline.newGeneratedProfile")},{key:"divider_1",text:"-",itemType:i.DropdownMenuItemType.Divider},...c],u=n.length>0?n[0]:void 0;return s.createElement(i.Dropdown,{ariaLabel:o("settings.general.mobileOffline.profileSelectionDropdownAriaLabel"),options:l,onRenderOption:(e,t)=>{return e?"create-profile"===e.id?s.createElement(p.IconButton,{iconProps:{iconName:"Add"},ariaLabel:e.text,title:e.text,styles:{root:{width:"100%"},flexContainer:{justifyContent:"left"}},onClick:a},s.createElement("div",{style:{color:"black",paddingLeft:"2px"}},e.text)):null!==(n=s.createElement("div",{style:{padding:"0px 8px"}},null==t?void 0:t(e)))&&void 0!==n?n:null:null;var n},onChange:(e,t)=>{t&&"create-profile"===t.id?a():t&&t.id&&r([t.id])},selectedKey:u,styles:{dropdownItem:{padding:0},dropdownItemSelected:{padding:0}},dropdownWidth:"auto"})},[s.memo,Object(o.translateService)("AppModuleDesigner"),r.withEnvironment,Object(c.connect)(f,m)]);t.default=b},12373:function(e,t,n){"use strict";n.r(t),n.d(t,"mobileOfflineSettingSectionStyles",(function(){return a})),n.d(t,"labelStyles",(function(){return o}));var r=n(719),a=e=>Object(r.mergeStyleSets)({root:["MobileOfflineSettingSection"],container:{display:"flex",alignItems:"center"},flexInputFields:{display:"flex",maxWidth:"400px"},flexInputFieldsJustifiedCenter:{display:"flex",maxWidth:"400px",justifyContent:"center",marginTop:"6px"},largeLeft:{flex:1},beside:{paddingLeft:e.spacing.s2},settingItem:{marginTop:"12px",maxWidth:"400px"},smallText:{fontSize:r.FontSizes.small}}),o={root:{fontWeight:"600",fontSize:14}}},12374:function(e,t,n){"use strict";n.r(t),n.d(t,"settingsModalStyles",(function(){return a})),n.d(t,"labelStyles",(function(){return o}));var r=n(719),a=e=>Object(r.mergeStyleSets)({root:["SettingsModal"],settingItem:{marginTop:"12px",maxWidth:"400px"}}),o={root:{fontWeight:"600",fontSize:14}}},12375:function(e,t,n){"use strict";n.r(t),n.d(t,"FeaturesPage",(function(){return o})),n.d(t,"UpcomingFeaturesPage",(function(){return i}));var r=n(245),a=n.n(r),o=a.a.lazy(()=>Promise.all([n.e(147),n.e(35),n.e(461),n.e(480)]).then(n.bind(null,31542)).then(e=>({default:e.GeneralSettingsExplorer}))),i=a.a.lazy(()=>Promise.all([n.e(147),n.e(35),n.e(461),n.e(481)]).then(n.bind(null,31552)).then(e=>({default:e.UpcomingSettingsExplorer})))},12376:function(e,t,n){"use strict";n.r(t),n.d(t,"RemoveSiteMapNodeDialog",(function(){return p}));var r=n(684),a=n(890),o=n(10303),i=n(10298),s=n(923),c=n(245),l=n(10443),u=n(12005),d=n(11984),p=()=>{var{t:e}=Object(s.useTranslation)("AppModuleDesigner"),t=Object(l.useSelector)(d.Selectors.siteMapNodeToRemove),n=Object(l.useDispatch)(),p=[i.default.Area,i.default.Group];if(void 0===t||!p.includes(t.node.Type))return null;var f=()=>{n(d.Actions.removeSiteMapNodeDialog.dismiss())},m=e("removeSiteMapNodeDialog.groupSubText"),b=e("removeSiteMapNodeDialog.groupTitle"),v=e("removeSiteMapNodeDialog.removeGroup"),g=e("navigation.newGroup");t.node.Type===i.default.Area&&(m=e("removeSiteMapNodeDialog.areaSubText"),b=e("removeSiteMapNodeDialog.areaTitle"),v=e("removeSiteMapNodeDialog.removeArea"),g=e("navigation.newArea"));var y={title:b,subText:(Object(o.getTitle)(t.node)||g)+"\n"+m,showCloseButton:!1},h={main:{whiteSpace:"pre-line"},root:void 0};return c.createElement(a.Dialog,{hidden:void 0===t,maxWidth:440,dialogContentProps:y,modalProps:{isBlocking:!0},onDismiss:f,styles:h},c.createElement(a.DialogFooter,null,c.createElement(r.PrimaryButton,{text:v,onClick:()=>{Object(l.batch)(()=>{n(u.App.Actions.deleteNode(t.path)),n(d.Actions.removeSiteMapNodeDialog.dismiss())})}}),c.createElement(r.DefaultButton,{text:e("buttons.cancel"),onClick:f})))}},12377:function(e,t,n){"use strict";n.r(t),n.d(t,"PackagerMonitor",(function(){return d}));var r=n(12378),a=n(12379),o=n(217),i=n(12003),s=n(11990),c=n(12168);function l(e,t,n,r,a,o,i){try{var s=e[o](i),c=s.value}catch(l){return void n(l)}s.done?t(c):Promise.resolve(c).then(r,a)}function u(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){l(o,r,a,i,s,"next",e)}function s(e){l(o,r,a,i,s,"throw",e)}i(void 0)}))}}class d{constructor(e){this._apolloClient=e,this.appModuleId=void 0,this.appModuleUniqueName=void 0,this.observablePublishQuery=void 0,this.observablePublishQuerySubscription=void 0,this.unsubscribeToFastDiscoveryListener=void 0,this.unsubscribeToPausedListener=void 0,this.timeoutId=void 0,this.stateMachine=void 0,this.stateMachine=new c.PackagerMonitorStateMachine}updateContext(e,t){e===this.appModuleId&&t===this.appModuleUniqueName||(this.unsubscribe(),this.appModuleId=e,this.appModuleUniqueName=t)}onPublish(e){this.appModuleId&&this.appModuleUniqueName&&(this.registerFastDiscoveryListener(e),this.registerPausedStateListener(),this.notifyOfPublish())}unsubscribe(){var e,t;null===(e=this.observablePublishQuery)||void 0===e||e.stopPolling(),this.observablePublishQuery=void 0,null===(t=this.observablePublishQuerySubscription)||void 0===t||t.unsubscribe(),this.observablePublishQuerySubscription=void 0,window.clearTimeout(this.timeoutId),this.timeoutId=void 0,this.stateMachine.notify(c.PackagerMonitorEvent.Interrupted)}notifyOfPublish(){this.stateMachine.notify(c.PackagerMonitorEvent.PublishRequested)}registerFastDiscoveryListener(e){this.unsubscribeToFastDiscoveryListener||(this.unsubscribeToFastDiscoveryListener=this.stateMachine.listenForState(c.PackagerMonitorState.Discovery,()=>this.onFastDiscovery(e)))}registerPausedStateListener(){this.unsubscribeToPausedListener||(this.unsubscribeToPausedListener=this.stateMachine.listenForState(c.PackagerMonitorState.Paused,()=>this.onPaused()))}onFastDiscovery(e){var t=this;return u((function*(){var n=yield t.getCurrentMetadataVersion(),r=Object(o.trackOtherScenario)(i.default,s.default.AppPackaging);t.timeoutId=window.setTimeout(()=>{t.stateMachine.notify(c.PackagerMonitorEvent.Interrupted),e.onTimeout(),r.completeWithWarning({message:"Packaging scenario timed out"})},d.PollTimeoutMs),t.observablePublishQuery=t.getPublishStateQuery(n),t.observablePublishQuerySubscription=t.observablePublishQuery.subscribe(n=>{var a=n.data.appModulePublishingState;switch(a){case"Packaging":return t.stateMachine.notify(c.PackagerMonitorEvent.JobDetected),void r.progress({state:a,message:"Packaging in progress"});case"ReadyNoPackagingNeeded":return t.stateMachine.notify(c.PackagerMonitorEvent.JobSucceeded),e.onSuccess(a),void r.complete({state:a,message:"Publish finished with no packaging needed"});case"Ready":return t.stateMachine.notify(c.PackagerMonitorEvent.JobSucceeded),e.onSuccess(a),void r.complete({state:a,message:"Publish finished with packaging success"});case"AppNotFound":case"Error":return t.stateMachine.notify(c.PackagerMonitorEvent.JobFailed),e.onFailure(a),void r.completeWithWarning({state:a,message:"Publish finished with packaging failure"});case"NotSpecified":case"AppMetadataVersionNotFound":default:return void r.progress({state:a,message:"Packaging status still unknown"})}})}))()}onPaused(){this.unsubscribe()}getCurrentMetadataVersion(){var e=this;return u((function*(){var t=(yield e._apolloClient.query({query:r.AppModuleMetadataVersionQuery,variables:{appModuleIds:[e.appModuleId]},fetchPolicy:"network-only"})).data.appModuleMetadataVersions.find(t=>t.id===e.appModuleId);if(!t)throw new Error('Could not find metadata version of app module with id "'.concat(e.appModuleId,'"'));return t.metadataVersion}))()}getPublishStateQuery(e){return this._apolloClient.watchQuery({query:a.AppPublishStateQuery,variables:{appModuleId:this.appModuleId,appModuleLogicalName:this.appModuleUniqueName,appModuleMetadataVersion:e},pollInterval:d.FastPollIntervalMs,fetchPolicy:"network-only"})}}d.FastPollIntervalMs=5e3,d.PollTimeoutMs=6e4},12378:function(e,t,n){"use strict";n.r(t),n.d(t,"AppModuleMetadataVersionQuery",(function(){return s}));var r,a=n(3128);var o,i,s=n.n(a)()(r||(o=["\n  query appModuleMetadataVersion($appModuleIds: [String!]!) {\n    appModuleMetadataVersions(appModuleIds: $appModuleIds) {\n      id\n      metadataVersion\n    }\n  }\n"],i||(i=o.slice(0)),r=Object.freeze(Object.defineProperties(o,{raw:{value:Object.freeze(i)}}))))},12379:function(e,t,n){"use strict";n.r(t),n.d(t,"AppPublishStateQuery",(function(){return s}));var r,a=n(3128);var o,i,s=n.n(a)()(r||(o=["\n  query appPublishState(\n    $appModuleLogicalName: String!\n    $appModuleId: String!\n    $appModuleMetadataVersion: Int!\n  ) {\n    appModulePublishingState(\n      appModuleLogicalName: $appModuleLogicalName\n      appModuleId: $appModuleId\n      appModuleMetadataVersion: $appModuleMetadataVersion\n    )\n  }\n"],i||(i=o.slice(0)),r=Object.freeze(Object.defineProperties(o,{raw:{value:Object.freeze(i)}}))))},12380:function(e,t,n){"use strict";n.r(t),n.d(t,"makeUCISyncService",(function(){return s})),n.d(t,"getFCBFlags",(function(){return c}));var r=n(12290),a=n(217),o=n(11993),i=n(12003);function s(e){var t,n=c();return new r.UCISyncService({langCode:parseInt(null!==(t=e.baseLanguage)&&void 0!==t?t:"1033",10),orgUrl:e.instanceUrl,previewBaseURL:"".concat(e.instanceUrl,"uclient/main.htm?")+"forceUCI=1&cmdbar=true&preview=true&preload=true"+"&hostCorrelationId=".concat(Object(a.getSessionId)())+"&channelId={channelId}"+(n?"&flags=".concat(encodeURIComponent(n)):"")+(o.settings.useLocalPreview?"&useLocal=".concat(o.settings.useLocalPreview):""),telemetryScope:i.default})}function c(){var e=[];e.push("FCB.PreLoadAppHostClient=false");var t=e.join(","),n=o.settings.flagsPreview||"";return t&&n?"".concat(t,",").concat(n):t||n||void 0}},12381:function(e,t,n){"use strict";n.r(t);var r=n(9342),a=n(12382),o=n(12383);t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(r.createStore)(o.default,t,Object(a.composeWithDevTools)(Object(r.applyMiddleware)(...e)))}},12383:function(e,t,n){"use strict";n.r(t);var r=n(9342),a=n(11984),o=n(12005),i=n(12190),s=n(12285),c=n(12169),l=n(12176),u=n(12107),d=Object(r.combineReducers)({ui:a.reducer,document:o.reducer,errors:i.reducer,preview:s.reducer,settings:c.reducer,comments:l.reducer,missionUI:u.reducer});t.default=d},12384:function(e,t,n){"use strict";n.r(t),n.d(t,"loadCreateAppDependencies",(function(){return a}));var r=n(12006);function a(e){e.dispatch(r.loadSolutionInfo.request())}},12385:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return c}));var r=n(12005),a=n(12190),o=n(12285),i=n(12116),s=n(11984);function c(e){return[s.makeMiddleware,r.makeMiddleware,a.makeMiddleware,o.makeMiddleware,i.makeMiddleware].map(t=>t(e))}},12386:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return c}));var r=n(217),a=n(12003),o=n(11989);function i(e,t,n,r,a,o,i){try{var s=e[o](i),c=s.value}catch(l){return void n(l)}s.done?t(c):Promise.resolve(c).then(r,a)}function s(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function s(e){i(o,r,a,s,c,"next",e)}function c(e){i(o,r,a,s,c,"throw",e)}s(void 0)}))}}function c(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t=>t=>function(){var n=s((function*(n){try{return yield t(n)}catch(i){throw Object(r.trackErrorTrace)(a.default,{eventName:o.default.ReduxCrash,eventData:{actionType:n.type}},i),e.onError&&e.onError(i,n),i}}));return function(e){return n.apply(this,arguments)}}()}},12387:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return s}));var r=n(217),a=n(10299),o=n(12003),i=n(11988);function s(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o.default,t={};return n=>n=>a=>{if(a.meta&&(Object(i.hasTelemetryEventMeta)(a.meta)&&Object(r.trackCustomEvent)(e,a.meta.telemetry),Object(i.hasTelemetryScenarioMeta)(a.meta))){var{scenarioName:s,modifier:l,eventData:u}=a.meta;switch(l){case r.ScenarioModifier.Start:t[s]&&(console.warn("Scenario ".concat(s," was abandoned because another instance was started while this instance was still occurring")),t[s].completeWithError({message:"Scenario was abandoned because another instance was started while this instance was still occurring"})),t[s]=Object(r.trackLoadScenario)(o.default,s,u);break;case r.ScenarioModifier.Progress:t[s]&&t[s].progress(u);break;case r.ScenarioModifier.Complete:t[s]&&(t[s].complete(u),delete t[s]);break;case r.ScenarioModifier.Failure:t[s]&&c(t,s,u)}}return n(a)}}function c(e,t,n){n instanceof a.CodedError&&n.severity===a.CodedErrorSeverity.Warning?e[t].completeWithWarning(n):e[t].failure(n),delete e[t]}},12388:function(e,t,n){"use strict";n.r(t),n.d(t,"useLogFirstRenderLoad",(function(){return s}));var r=n(217),a=n(245),o=n(12389),i=n(12003);function s(e){var t=Object(o.useSingletonRef)(()=>Object(r.trackLoadScenario)(i.default,e));a.useEffect(()=>{t.current&&(t.current.complete(),t.current=void 0)},[])}},12389:function(e,t,n){"use strict";n.r(t),n.d(t,"useSingletonRef",(function(){return a}));var r=n(245);function a(e){var t=r.useRef(!1),n=r.useRef();return t.current||(t.current=!0,n.current=e()),n}},6499:function(e,t,n){"use strict";var r,a,o,i;n.r(t),n.d(t,"PowerSettingTypeCode",(function(){return r})),n.d(t,"ReleaseLevel",(function(){return a})),n.d(t,"OverridableLevel",(function(){return o})),n.d(t,"SettingCombination",(function(){return i})),n.d(t,"MergedSettingName",(function(){return s})),function(e){e[e.Integer=0]="Integer",e[e.String=1]="String",e[e.Boolean=2]="Boolean"}(r||(r={})),function(e){e[e.GenerallyAvailable=0]="GenerallyAvailable",e[e.EarlyAccess=1]="EarlyAccess",e[e.Preview=2]="Preview",e[e.All=-1]="All",e[e.Upcoming=-2]="Upcoming",e[e.Experimental=-3]="Experimental"}(a||(a={})),function(e){e[e.None=-2]="None",e[e.All=-1]="All",e[e.OrgAndApp=0]="OrgAndApp",e[e.OrgOnly=1]="OrgOnly",e[e.AppOnly=2]="AppOnly"}(o||(o={})),function(e){e.JustDefinition="JustDefinition",e.JustOrgOverride="JustOrgOverride",e.Both="Both"}(i||(i={}));var s="MergedPowerPlatformSetting"},6626:function(e,t,n){"use strict";n.r(t),n.d(t,"CdsCommonUxName",(function(){return r}));var r="CdsCommonUx"},6632:function(e,t,n){"use strict";n.r(t),n.d(t,"getAllowedOverrides",(function(){return s})),n.d(t,"getSettingValue",(function(){return l})),n.d(t,"getMergedSettings",(function(){return u})),n.d(t,"getDistinctMergedSettings",(function(){return d}));var r=n(6499),a=n(6633),o=n.n(a),i=n(6637),s=(e,t)=>{var n=!1,a=!1;if(e)switch(t){case r.OverridableLevel.AppOnly:a=!0;break;case r.OverridableLevel.OrgOnly:n=!0;break;case r.OverridableLevel.OrgAndApp:n=!0,a=!0}return{allowAppOverrides:a,allowOrgOverrides:n}},c=(e,t,n,r,a)=>e&&null!=a?a:t&&null!=r?r:n;function l(e,t){if("isOverridable"in e){var{allowAppOverrides:n,allowOrgOverrides:r}=s(e.isOverridable,e.overridableLevel);return c(n,r,e.defaultValue,e.orgValue,t)}if("IsOverridable"in e){var{allowAppOverrides:a,allowOrgOverrides:o}=s(e.IsOverridable,e.OverridableLevel);return c(a,o,e.DefaultValue,e.OrgValue,t)}if("isoverridable"in e){var{allowAppOverrides:i,allowOrgOverrides:l}=s(e.isoverridable,e.overridablelevel);return c(i,l,e.defaultvalue,e.orgvalue,t)}throw new Error("Setting did not have an isOverridable field.")}function u(e){var t={},[n,a]=o()(e,e=>e.msdyn_componentlogicalname===i.SolutionComponentLogicalNames.SettingDefinition);for(var s of n){var c=s.msdyn_uniquename;s.msdyn_entitysetname="settingdefinitions",t[c]=[r.SettingCombination.JustDefinition,s,void 0]}for(var l of a){var u=l.msdyn_name;l.msdyn_entitysetname="organizationsettings",t.hasOwnProperty(u)?(t[u][0]=r.SettingCombination.Both,t[u][2]=l):t[u]=[r.SettingCombination.JustOrgOverride,l,void 0]}return Object.values(t)}function d(e){var t=u(e);return 0===t.length?[]:[{msdyn_componentlogicalname:r.MergedSettingName,msdyn_total:t.length,msdyn_componenttype:null,msdyn_subtype:null,msdyn_workflowcategory:null}]}},6637:function(e,t,n){"use strict";var r;n.r(t),n.d(t,"SolutionComponentLogicalNames",(function(){return r})),function(e){e.AppModule="appmodule",e.AiModel="msdyn_aimodel",e.OrganizationSetting="organizationsetting",e.SettingDefinition="settingdefinition",e.Workflow="workflow",e.Command="appaction"}(r||(r={}))},6645:function(e,t,n){"use strict";n.r(t),n.d(t,"TooltipButton",(function(){return i}));var r=n(545),a=n(6646),o=n(6647),i=Object(r.styled)(a.TooltipButtonBase,o.getStyles,void 0,{scope:"TooltipButton"})},6646:function(e,t,n){"use strict";n.r(t),n.d(t,"TooltipButtonBase",(function(){return m}));var r=n(2898),a=n(684),o=n(1837),i=n(545),s=n(790),c=n(245);function l(){return(l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){p(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var f=Object(i.classNamesFunction)(),m=e=>{var t,n,u,p,{calloutContent:m,tooltipId:b,iconButtonProps:v,infoIconLabel:g,infoIconButtonLabel:y,iconDistance:h,tooltipDistance:S,styles:O,theme:A,className:P}=e,[j,{toggle:E}]=Object(r.useBoolean)(!1),C=Object(r.useId)("callout-button"),T=null!=b?b:C,M=f(O,{theme:A,className:P,iconDistance:h,tooltipDistance:S});return m=c.createElement(i.DelayedRender,null,c.createElement(o.Text,null,m)),c.createElement(c.Fragment,null,c.createElement("div",{className:M.root},c.createElement(a.IconButton,l({},v,{ariaLabel:y,id:T,styles:null===(t=M.subComponentStyles)||void 0===t||null===(n=t.iconButton)||void 0===n?void 0:n.call(t,{}),onClick:E,iconProps:d({iconName:"Info",ariaLabel:g},null==v?void 0:v.iconProps)}))),j&&c.createElement(s.FocusTrapCallout,{focusTrapProps:{isClickableOutsideFocusTrap:!0},role:"alertdialog",styles:null===(u=M.subComponentStyles)||void 0===u||null===(p=u.callout)||void 0===p?void 0:p.call(u,{}),gapSpace:S||0,onDismiss:E,directionalHint:s.DirectionalHint.topCenter,target:"#".concat(T),"aria-live":"assertive",setInitialFocus:!0},m))}},6647:function(e,t,n){"use strict";function r(e){var{className:t,iconDistance:n,tooltipDistance:r}=e;return{root:[t],subComponentStyles:{iconButton:{root:{top:"".concat(n||r,"px")}},callout:{root:{padding:8,width:364}}}}}n.r(t),n.d(t,"getStyles",(function(){return r}))},7398:function(e,t,n){"use strict";var r;n.r(t),n.d(t,"AttributeRequiredLevel",(function(){return r})),function(e){e.None="None",e.SystemRequired="SystemRequired",e.ApplicationRequired="ApplicationRequired",e.Recommended="Recommended"}(r||(r={}))},8969:function(e,t,n){"use strict";function r(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.replace(/{(\d+)}/g,(e,t)=>void 0!==n[t]?n[t]:e)}function a(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var a=[],o=0;return e.replace(/{(\d+)}/g,(t,r,i)=>(r<n.length&&(o!==i&&a.push(e.slice(o,i)),a.push(n[r]),o=i+t.length),"")),0!==a.length&&o===e.length||a.push(e.slice(o)),a}n.r(t),n.d(t,"formatString",(function(){return r})),n.d(t,"formatStringWithNodes",(function(){return a}))},9670:function(e,t,n){"use strict";n.r(t);var r=n(9671);n.d(t,"calculateWordHighlights",(function(){return r.calculateWordHighlights}));var a=n(9672);n.d(t,"HighlightedText",(function(){return a.HighlightedText}));n(9675)},9671:function(e,t,n){"use strict";function r(e,t,n){var r=n?"gi":"g";return t.map(t=>{for(var n,a=[],o=t.length,i=new RegExp(t,r);n=i.exec(e);)a.push({startIndex:n.index,length:o}),i.lastIndex=n.index+1;return a}).reduce((e,t)=>e.concat(t),[])}n.r(t),n.d(t,"calculateWordHighlights",(function(){return r}))},9672:function(e,t,n){"use strict";n.r(t),n.d(t,"HighlightedText",(function(){return i}));var r=n(545),a=n(9673),o=n(9674),i=Object(r.styled)(a.HighlightedTextBase,o.getStyles)},9673:function(e,t,n){"use strict";n.r(t),n.d(t,"HighlightedTextBase",(function(){return c}));var r=n(3328),a=n(545),o=n(245),i=n(9674),s=Object(a.classNamesFunction)();class c extends o.PureComponent{get classNames(){var{styles:e,theme:t}=this.props;return s(e,{theme:t})}render(){return o.createElement(o.Fragment,null,this.mapTextToHighlights())}mapTextToHighlights(){var{text:e,highlights:t,labels:n}=this.props;if(0===t.length)return o.createElement(o.Fragment,null,e);var r=this.toStrings(e,t);return o.createElement(o.Fragment,null,this.renderStrings(r,n))}renderStrings(e,t){var n=Object(r.mergeStyles)(this.classNames.highlights,Object(i.getAccessibilityHighlightStyles)(t));return e.map((e,t)=>e.isHighlighted?o.createElement("span",{key:"".concat(e.str," ").concat(t),className:n},e.str):o.createElement(o.Fragment,null,e.str))}toStrings(e,t){for(var n,r=[...t].sort((e,t)=>{var n=Math.min(e.startIndex,e.startIndex+e.length)-Math.min(t.startIndex,t.startIndex+t.length);return 0===n?e.length-t.length:n}),a=[],o=0,i=r[0],s=0;s<e.length;s++){for(var c=i?Math.min(i.startIndex,i.startIndex+i.length):void 0,l=i?Math.max(i.startIndex,i.startIndex+i.length):void 0;i&&s>=l;)c=(i=r[++o])?Math.min(i.startIndex,i.startIndex+i.length):void 0,l=i?Math.max(i.startIndex,i.startIndex+i.length):void 0;var u=!1;i&&(u=s>=c&&s<l);var d=e[s];if(u!==n)a.push({str:d,isHighlighted:u});else{var p=a[a.length-1];a[a.length-1]={str:p.str+d,isHighlighted:p.isHighlighted}}n=u}return a}}},9674:function(e,t,n){"use strict";function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.r(t),n.d(t,"getStyles",(function(){return i})),n.d(t,"getAccessibilityHighlightStyles",(function(){return c}));var i=e=>({highlights:{backgroundColor:"#f3c3ea",outline:"1px solid transparent"}}),s={height:"0px",overflow:"hidden",position:"absolute",whiteSpace:"nowrap",width:"0px"},c=e=>({selectors:{"::before":a(a({},s),{},{content:'" ;'.concat(e.beginHighlightedText,'; "')}),"::after":a(a({},s),{},{content:'" ;'.concat(e.endHighlightedText,'; "')})}})},9675:function(e,t,n){"use strict";n.r(t)}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/app-module-designer.40af5c82.chunk.js.map