/*! For license information please see 198.e1ec71f4.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[198],{6370:function(e,n,o){"use strict";o.r(n),o.d(n,"ConnectionReferencePanel",(function(){return H}));var t=o(4013),i=o(5629),r=o(245),a=o(2869),s=o(6371),l=o(1201),c=o(5127),d=o(5148),u=o(6372),m=o(684),p=o(790),f=o(2879),C=o(1567),R=o(2880),g=o(1697),y=o(2812),S=o(1447),b=o(5481),v=o(6373),E=o(1086),x=o(5604),h=o(1106),P=o(1452),T=o(1090),F=o(687),O=o(217),D=o(6374),M=o(6375),I=o(6377),B=o(3076),N=o(2698),w=o(6379),k=o(5806),j=o(6381),L=o(6382),A=o(3760);function K(){return(K=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var o=arguments[n];for(var t in o)Object.prototype.hasOwnProperty.call(o,t)&&(e[t]=o[t])}return e}).apply(this,arguments)}function _(e,n){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),o.push.apply(o,t)}return o}function V(e){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{};n%2?_(Object(o),!0).forEach((function(n){q(e,n,o[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):_(Object(o)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(o,n))}))}return e}function q(e,n,o){return n in e?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o,e}var H=e=>{var n,o,_,q,H,U,W=r.useRef(),{currentEnvironment:z}=Object(r.useContext)(h.EnvironmentContext),G=Object(a.getResources)(),Y=r.createRef(),{connectionReference:Q}=e,[X,J]=Object(r.useState)(Q),[Z,$]=Object(r.useState)(!0),ee=Object(r.useRef)({}),[ne,oe]=Object(r.useState)(!1),[te,ie]=Object(r.useState)(null==X?void 0:X.connectionid),[re,ae]=Object(r.useState)(!1),[se,le]=Object(r.useState)([]),[ce,de]=Object(r.useState)({formResults:{}}),[ue,me]=Object(r.useState)({}),[pe,fe]=Object(r.useState)({isValidForm:{}}),[Ce,Re]=Object(r.useState)(void 0),[ge,ye]=Object(r.useState)([]),{environmentClient:Se}=r.useContext(B.ApolloClientContext),{dispatchAction:be}=r.useContext(A.DispatchContext),{loading:ve,datasets:Ee,errorMessage:xe,refetch:he}=Object(I.useConnectionsWithDetailsQuery)(Se,{},N.PortalScope,G.Common.StandardErrorMessages),{solution:Pe}=Object(w.useSolutionByUniqueName)(Se,j.ConnectionReferenceConstants.CONNECTION_REF_SOL_UNIQUE_KEY,N.PortalScope,G.Common.Request.Failed),Te=()=>{var n=!e.createConRefResponse.loading&&!e.createConRefResponse.failed;return e.createConRefResponse.success&&n},Fe=()=>{var n,o,t;return(null===(n=e.modifyConRefResponse)||void 0===n?void 0:n.success)&&!(null!==(o=e.modifyConRefResponse)&&void 0!==o&&o.failed)&&!(null!==(t=e.modifyConRefResponse)&&void 0!==t&&t.loading)},[Oe,De]=Object(r.useState)(!0);Object(r.useEffect)(()=>{e.fetchConnectorRequest(),e.isEdit&&e.fetchConnectionReferenceDataRequest()},[]),Object(r.useEffect)(()=>{var n=ce.formResults.connectionreferencedisplayname&&ce.formResults.connectionreferencedisplayname.replace(j.ConnectionReferenceConstants.NAME_FORMAT_REGEX,"");n&&Oe&&!e.isEdit&&W.current.setValue(n)},[ce.formResults.connectionreferencedisplayname]),Object(r.useEffect)(()=>{e.isEdit&&(J(V(V({},X),{},{connectorid:null==Q?void 0:Q.connectorid,connectionid:null==Q?void 0:Q.connectionid,connectionreferencedisplayname:null==Q?void 0:Q.connectionreferencedisplayname,connectionreferencelogicalname:null==Q?void 0:Q.connectionreferencelogicalname,"CustomConnectorId@odata.bind":null==Q?void 0:Q["CustomConnectorId@odata.bind"],description:null==Q?void 0:Q.description})),ie(null==Q?void 0:Q.connectionid))},[null===(n=e.fetchConRefDataResponse)||void 0===n?void 0:n.loading]),Object(r.useEffect)(()=>{e.isEdit&&Q&&Ce&&(void 0===Ce.find(e=>e.key===te)&&Ce.push({key:Q.connectionid,id:Q.connectorid,text:te}),le(null==Ce?void 0:Ce.filter(e=>e.id==(null==Q?void 0:Q.connectorid))),oe(!0))},[Ce]),Object(r.useEffect)(()=>{Object(i.isLoading)(e.loadProgress)?ye(void 0):!e.isApiLoaded||ge&&0!=ge.length||ye(Ue(e.apis))},[e.loadProgress]),Object(r.useEffect)(()=>{ve||Re(We(Ee))},[ve]),Object(r.useEffect)(()=>{!ve&&ce.formResults.connectorid&&le(Ce.filter(e=>e.id==ce.formResults.connectorid.toString()))},[Ce]);var Me,Ie,Be=xe;ve||Object(i.isLoading)(e.loadProgress)||e.isEdit&&null!==(o=e.fetchConRefDataResponse)&&void 0!==o&&o.loading?Me={spinnerProps:{size:l.SpinnerSize.large}}:!e.isEdit&&null!==(_=e.fetchConRefDataResponse)&&void 0!==_&&_.warning&&null!==(q=e.fetchConRefDataResponse)&&void 0!==q&&q.message?Ie={messageBarProps:{messageBarType:g.MessageBarType.warning,dismissButtonAriaLabel:G.Common.close,isMultiline:!1,truncated:!0},onRenderBody:()=>r.createElement(r.Fragment,null,e.fetchConRefDataResponse.message)}:!e.isEdit&&null!==(H=e.fetchConRefDataResponse)&&void 0!==H&&H.failed&&null!==(U=e.fetchConRefDataResponse)&&void 0!==U&&U.message?Ie={messageBarProps:{messageBarType:g.MessageBarType.error,dismissButtonAriaLabel:G.Common.close,isMultiline:!1,truncated:!0},onRenderBody:()=>r.createElement(r.Fragment,null,e.fetchConRefDataResponse.message)}:!e.isEdit&&e.createConRefResponse.loading?Me={spinnerProps:{size:l.SpinnerSize.large,label:G.Model.Solutions.Components.CreateConnectionReference.Panel.createInprogress}}:!e.isEdit&&e.createConRefResponse.failed&&e.createConRefResponse.message?Ie={messageBarProps:{messageBarType:g.MessageBarType.error,dismissButtonAriaLabel:G.Common.close,isMultiline:!1,truncated:!0},onRenderBody:()=>r.createElement(r.Fragment,null,e.createConRefResponse.message)}:!e.isEdit&&e.createConRefResponse.warning&&e.createConRefResponse.message?Ie={messageBarProps:{messageBarType:g.MessageBarType.warning,dismissButtonAriaLabel:G.Common.close,isMultiline:!1,truncated:!0},onRenderBody:()=>r.createElement(r.Fragment,null,e.createConRefResponse.message)}:e.isEdit&&e.modifyConRefResponse.loading?Me={spinnerProps:{size:l.SpinnerSize.large,label:G.Model.Solutions.Components.CreateConnectionReference.Panel.modifyInprogress}}:e.isEdit&&e.modifyConRefResponse.failed&&e.modifyConRefResponse.message?(re&&ae(!1),Ie={messageBarProps:{messageBarType:g.MessageBarType.error,dismissButtonAriaLabel:G.Common.close,isMultiline:!1,truncated:!0},onRenderBody:()=>r.createElement(r.Fragment,null,e.modifyConRefResponse.message)}):e.isEdit&&e.modifyConRefResponse.warning&&e.modifyConRefResponse.message?(re&&ae(!1),Ie={messageBarProps:{messageBarType:g.MessageBarType.warning,dismissButtonAriaLabel:G.Common.close,isMultiline:!1,truncated:!0},onRenderBody:()=>r.createElement(r.Fragment,null,e.modifyConRefResponse.message)}):Be?(Ie={messageBarProps:{messageBarType:g.MessageBarType.error,dismissButtonAriaLabel:G.Common.close},onRenderBody:()=>r.createElement(r.Fragment,null,Be)},ve&&(Me={spinnerProps:{size:l.SpinnerSize.large,label:"loading",ariaLabel:"loading",ariaLive:"polite",role:"alert"}})):(e.isEdit?Fe():Te())&&(e.isEdit&&e.updatedConnectionReference&&be({type:"maker/resources/MODIFY_CONNECTION_REFERENCE_SUCCEEDED",payload:{connectionReference:e.updatedConnectionReference}}),e.beforePanelClose(),e.onPanelClose());var Ne,we,ke={title:G.Model.Solutions.Components.CreateConnectionReference.DiscardConfirmationDialog.title,subtext:G.Model.Solutions.Components.CreateConnectionReference.DiscardConfirmationDialog.subtext,confirmButtonText:G.Model.Solutions.Components.CreateConnectionReference.DiscardConfirmationDialog.confirmButtonText,cancelButtonText:G.Model.Solutions.Components.CreateConnectionReference.DiscardConfirmationDialog.cancelButtonText},je=()=>{if(e.isEdit)ae(!0);else{var n={connectionreferencelogicalname:Ae(e.solution)+ce.formResults.connectionreferencelogicalname,connectionreferencedisplayname:ce.formResults.connectionreferencedisplayname,solutionid:e.solution.solutionId,connectorid:ce.formResults.connectorid.toString(),connectionid:ce.formResults.connectionid.toString(),description:ce.formResults.description,ismanaged:e.solution.isManaged};ce.formResults.customconnectorid?Le(e.solution,V(V({},n),{},{"CustomConnectorId@odata.bind":Object(R.formatResourceString)("/connectors({0})",ce.formResults.customconnectorid)})):Le(e.solution,n)}},Le=(n,o)=>{e.onCreateSave(n,o)},Ae=e=>{var n=e.resourceNamePrefix;return(!n||n&&n.indexOf("_")<1)&&(n="new_"),n},Ke=()=>Pe&&Pe.version&&!Object(k.isCurrentOrMoreRecentVersion)(j.ConnectionReferenceConstants.CONNECTION_REF_SOL_VERSION,Pe.version),_e=(n,o)=>t=>{if(!Z||e.isEdit){var i=n(t);return fe({isValidForm:V(V({},pe.isValidForm),{},{[o]:void 0===i})}),i}},Ve=()=>e.isEdit?Object(y.isEmpty)(ce.formResults)||void 0!==pe.isValidForm.connectionreferencedisplayname&&!pe.isValidForm.connectionreferencedisplayname||void 0!==pe.isValidForm.connectionreferencelogicalname&&!pe.isValidForm.connectionreferencelogicalname||void 0!==pe.isValidForm.connectorid&&!pe.isValidForm.connectorid||void 0!==pe.isValidForm.connectionid&&!pe.isValidForm.connectionid:!(pe.isValidForm.connectionreferencedisplayname&&pe.isValidForm.connectionreferencelogicalname&&pe.isValidForm.connectorid&&pe.isValidForm.connectionid),qe=e=>{me(V(V({},ue),{},{[e]:!1}))},He=e=>{me(V(V({},ue),{},{[e]:!ue[e]}))},Ue=e=>{var n=[];return e&&(n=e.map(e=>({id:e.id,key:e.id,text:e.properties.displayName,data:{xrmConnnectorId:e.properties.metadata&&e.properties.metadata.xrmConnectorId?e.properties.metadata.xrmConnectorId:null}})).sort((e,n)=>e.text.localeCompare(n.text))),n},We=e=>{var n=[];return e&&(n=e.map(e=>({id:e.apiId,key:e.name,text:e.displayName})).sort((e,n)=>e.text.localeCompare(n.text))),n},ze=r.createElement(r.Fragment,null,r.createElement("div",null,r.createElement("p",null,r.createElement("span",{className:u.connectionReferenceStyleClasses.learnAboutLink,onClick:()=>{e.openNewTab(b.default.connectionReferenceLearnAboutLink)},role:"link"},G.Model.Solutions.Components.CreateConnectionReference.Panel.learnAbout),e.isEdit?G.Model.Solutions.Components.CreateConnectionReference.Panel.editSubTitle:G.Model.Solutions.Components.CreateConnectionReference.Panel.createSubTitle),r.createElement(c.Form,{onUpdated:(e,n)=>{e===L.CreateFormKeys.connectionreferencelogicalname&&n&&n!==(ce.formResults.connectionreferencedisplayname&&ce.formResults.connectionreferencedisplayname.replace(j.ConnectionReferenceConstants.NAME_FORMAT_REGEX,""))&&De(!1),$(!1),de({formResults:V(V({},ce.formResults),{},{[e]:n})})},showErrorsWhenPristine:!0},r.createElement(c.FormTextInput,{textFieldProps:{label:G.Model.Solutions.Components.CreateConnectionReference.Panel.displayName,ariaLabel:G.Model.Solutions.Components.CreateConnectionReference.Panel.displayName,required:!0,styles:u.connectionReferenceTextStyles},inputKey:L.CreateFormKeys.connectionreferencedisplayname,value:null==X?void 0:X.connectionreferencedisplayname,validators:[_e(d.maxLength(200,()=>G.Model.Solutions.Components.CreateConnectionReference.Error.LessThan200),L.CreateFormKeys.connectionreferencedisplayname),_e(d.required(G.Model.Solutions.Components.CreateConnectionReference.Error.Required),L.CreateFormKeys.connectionreferencedisplayname)],debounceInterval:10}),r.createElement("div",{className:u.connectionReferenceStyleClasses.fieldSection},r.createElement(c.FormTextInput,{textFieldProps:{label:G.Model.Solutions.Components.CreateConnectionReference.Panel.name,className:"newConnectionReferencePanel_name",prefix:e.isEdit?void 0:Ae(e.solution),required:!0,styles:u.connectionReferenceTextStyles,disabled:e.isEdit,onRenderLabel:()=>r.createElement("div",{className:u.connectionReferenceStyleClasses.fieldHeader},r.createElement("label",null,G.Model.Solutions.Components.CreateConnectionReference.Panel.name),r.createElement("span",{className:u.connectionReferenceStyleClasses.fieldRequired},"*"),r.createElement("span",{className:u.connectionReferenceStyleClasses.fieldIcon,ref:ee.current[L.CreateFormKeys.connectionreferencelogicalname]},r.createElement(m.IconButton,{iconProps:{iconName:f.fabricIcons.Info},onClick:()=>He(L.CreateFormKeys.connectionreferencelogicalname),title:G.Model.Solutions.Components.CreateConnectionReference.Panel.calloutTooltip,ariaLabel:G.Model.Solutions.Components.CreateConnectionReference.Panel.calloutTooltip})))},componentRef:W,inputKey:L.CreateFormKeys.connectionreferencelogicalname,value:null==X?void 0:X.connectionreferencelogicalname,validators:[_e(d.maxLength(200,()=>G.Model.Solutions.Components.CreateConnectionReference.Error.LessThan200),L.CreateFormKeys.connectionreferencelogicalname),_e(d.required(G.Model.Solutions.Components.CreateConnectionReference.Error.Required),L.CreateFormKeys.connectionreferencelogicalname)],debounceInterval:10})),r.createElement(c.FormTextInput,{textFieldProps:{label:G.Model.Solutions.Components.CreateConnectionReference.Panel.description,styles:u.connectionReferenceTextStyles},inputKey:L.CreateFormKeys.description,debounceInterval:10,componentRef:Y,value:null==X?void 0:X.description,validators:[_e(d.maxLength(2e3,()=>G.Model.Solutions.Components.CreateConnectionReference.Error.LessThan2000),L.CreateFormKeys.description)]}),r.createElement("div",{className:"newConnectionReferencePanel_comboBox"},r.createElement(S.ComboBox,{options:ge,label:G.Model.Solutions.Components.CreateConnectionReference.Panel.connector,required:!0,selectedKey:null==X?void 0:X.connectorid,placeholder:G.Model.Solutions.Components.CreateConnectionReference.DataType.placeholder,styles:u.connectionReferenceDropdownStyles,onChange:(e,n)=>{var o,t,i,r,a=Ce.filter(e=>e.id==n.id);de({formResults:V(V({},ce.formResults),{},{[L.CreateFormKeys.connectorid]:n.key,[L.CreateFormKeys.connectionid]:null===(o=a[0])||void 0===o?void 0:o.key,[L.CreateFormKeys.customconnectorid]:null===(t=n.data)||void 0===t?void 0:t.xrmConnnectorId})}),fe({isValidForm:V(V({},pe.isValidForm),{},{[L.CreateFormKeys.connectorid]:null!=n.id,[L.CreateFormKeys.connectionid]:null!=(null===(i=a[0])||void 0===i?void 0:i.id)})}),le(a),ie(null===(r=a[0])||void 0===r?void 0:r.key),oe(!0),$(!1)},disabled:e.isEdit,useComboBoxAsMenuWidth:!0,allowFreeform:!0})),r.createElement("div",{className:"newConnectionReferencePanel_connection"},r.createElement(C.Dropdown,{onChange:(e,n)=>{de({formResults:V(V({},ce.formResults),{},{[L.CreateFormKeys.connectionid]:n.key})}),fe({isValidForm:V(V({},pe.isValidForm),{},{[L.CreateFormKeys.connectionid]:null!=n.id})}),ie(n.key),$(!1)},options:[{key:j.ConnectionReferenceConstants.HEADER_OPTION_KEY,text:G.Model.Solutions.Components.CreateConnectionReference.Panel.newConnection,itemType:P.SelectableOptionMenuItemType.Header},{key:"divider",text:"-",itemType:P.SelectableOptionMenuItemType.Divider},...se]||[],required:!1,role:"listbox",placeholder:G.Model.Solutions.Components.CreateConnectionReference.DataType.placeholder,styles:u.connectionReferenceDropdownStyles,disabled:!ne,defaultSelectedKey:te,onRenderLabel:()=>r.createElement("div",{className:u.connectionReferenceStyleClasses.fieldHeader},r.createElement("label",null,G.Model.Solutions.Components.CreateConnectionReference.Panel.connection),r.createElement("span",{className:u.connectionReferenceStyleClasses.fieldRequired},"*"),r.createElement("span",{className:u.connectionReferenceStyleClasses.fieldIcon,ref:ee.current[L.CreateFormKeys.connectionid]},r.createElement(m.IconButton,{iconProps:{iconName:f.fabricIcons.Info},onClick:()=>He(L.CreateFormKeys.connectionid),title:G.Model.Solutions.Components.CreateConnectionReference.Panel.calloutTooltip,ariaLabel:G.Model.Solutions.Components.CreateConnectionReference.Panel.calloutTooltip})),r.createElement("span",{className:u.connectionReferenceStyleClasses.fieldRefreshIcon},r.createElement(m.ActionButton,{iconProps:{iconName:f.fabricIcons.Refresh},onClick:()=>{he()},title:G.Model.Solutions.Components.CreateConnectionReference.Panel.refresh,ariaLabel:G.Model.Solutions.Components.CreateConnectionReference.Panel.refresh},G.Model.Solutions.Components.CreateConnectionReference.Panel.refresh))),onRenderOption:(e,n)=>((e,n,o,t)=>{if(!e)return null;var i=e,a=Object(s.getApiName)(t);if(i&&i.key===j.ConnectionReferenceConstants.HEADER_OPTION_KEY){var l="/environments/".concat(o,"/connections/available?apiName=").concat(a);return r.createElement(T.Link,{className:u.connectionReferenceStyleClasses.connectionReferenceDropdownHeader,href:l,target:"_blank",onClick:()=>{Object(O.trackUserActionClickLink)(M.SolutionEventScope,D.RefreshConnections,{action:D.RefreshConnectionsActionNames.OpenDialog})}},r.createElement(F.Icon,{iconName:f.fabricIcons.Add}),n(i))}return r.createElement("div",null,r.createElement("div",{className:u.connectionReferenceStyleClasses.connectionReferenceDropdownText},r.createElement("span",{className:"primaryLabel"}),r.createElement("span",null,i.text)))})(e,n,z.name,ce.formResults.connectorid)}))),(ee.current[L.CreateFormKeys.connectionreferencelogicalname]||(ee.current[L.CreateFormKeys.connectionreferencelogicalname]=r.createRef()),r.createElement(p.Callout,{role:"alertdialog",className:u.connectionReferenceStyleClasses.fieldIconCallout,gapSpace:0,onDismiss:()=>qe(L.CreateFormKeys.connectionreferencelogicalname),setInitialFocus:!1,target:ee.current[L.CreateFormKeys.connectionreferencelogicalname].current,hidden:!ue[L.CreateFormKeys.connectionreferencelogicalname],directionalHint:p.DirectionalHint.topCenter,styles:u.connectionReferenceCalloutStyles},G.Model.Solutions.Components.CreateConnectionReference.Panel.Name.calloutText)),(ee.current[L.CreateFormKeys.connectionid]||(ee.current[L.CreateFormKeys.connectionid]=r.createRef()),r.createElement(p.Callout,{role:"alertdialog",className:u.connectionReferenceStyleClasses.fieldIconCallout,gapSpace:0,onDismiss:()=>qe(L.CreateFormKeys.connectionid),setInitialFocus:!1,target:ee.current[L.CreateFormKeys.connectionid].current,hidden:!ue[L.CreateFormKeys.connectionid],directionalHint:p.DirectionalHint.bottomCenter,styles:u.connectionReferenceCalloutStyles},Object(R.formatResourceStringToElement)(G.Model.Solutions.Components.CreateConnectionReference.Panel.Connections.calloutText,(e,n)=>0===n?r.createElement("b",null,"+",G.Model.Solutions.Components.CreateConnectionReference.Panel.newConnection):1===n?r.createElement("b",null,G.Model.Solutions.Components.CreateConnectionReference.Panel.refresh):null)))),r.createElement("div",null,r.createElement(v.ConnectionReferenceDialog,e.isEdit&&{dependencyLink:(Ne=x.getCrmInstanceUrl(z),E.getShowComponentDependenciesUrl(Ne,e.solution.solutionId,e.solutionComponentId,e.solutionComponentTypeCode)),onContinue:()=>{var n;n=V({connectionreferenceid:e.connectionReferenceId},ce.formResults),e.onEditSave(e.solution,n)},onDismiss:()=>{ae(!1)},visible:re,title:G.Model.Solutions.Components.CreateConnectionReference.ContinueConfirmationDialog.editConfirmationTitle,subText:G.Model.Solutions.Components.CreateConnectionReference.ContinueConfirmationDialog.editConfirmationSubTitle,info:G.Model.Solutions.Components.CreateConnectionReference.ContinueConfirmationDialog.editConfirmationInfo,note:Ke()?G.Model.Solutions.Components.CreateConnectionReference.ContinueConfirmationDialog.editConfirmationNote:void 0,dimissButtonText:G.Model.Solutions.Components.CreateConnectionReference.ContinueConfirmationDialog.cancelConfirmationButtonText,continueButtonText:G.Model.Solutions.Components.CreateConnectionReference.ContinueConfirmationDialog.editConfirmationButtonText})));return r.createElement(t.Panel,K({},e.defaultPanelProps,{headerText:e.isEdit?Object(R.formatResourceString)(G.Model.Solutions.Components.CreateConnectionReference.Panel.editTitle,null==Q?void 0:Q.connectionreferencedisplayname):G.Model.Solutions.Components.CreateConnectionReference.Panel.createTitle,onDismiss:e.onPanelClose,closeButtonType:t.PanelCloseButtonType.Back,closeButtonAriaLabel:G.Common.close,footerButtons:[{primary:!0,dismissableOnClick:()=>{je()},ariaLabel:e.isEdit?G.Model.Solutions.Components.CreateConnectionReference.save:G.Model.Solutions.Components.CreateConnectionReference.create,text:e.isEdit?G.Model.Solutions.Components.CreateConnectionReference.save:G.Model.Solutions.Components.CreateConnectionReference.create,disabled:Ve()},{primary:!1,ariaLabel:G.Common.close,text:G.Common.close,dismissableOnClick:e=>{e()}}],loadingOverlay:Me,messageBar:Ie,className:u.connectionReferenceStyleClasses.panelFooter,showDismissDialog:!Object(y.isEmpty)(ce.formResults),dismissDialog:ke}),!Object(i.isLoading)(e.loadProgress)||e.isEdit&&null!==(we=e.fetchConRefDataResponse)&&void 0!==we&&we.loading?ze:r.createElement("div",null))}},6371:function(e,n,o){"use strict";function t(e){var n=(e||"").split("/");return n[n.length-1]||""}o.r(n),o.d(n,"getApiName",(function(){return t}))},6372:function(e,n,o){"use strict";o.r(n),o.d(n,"connectionReferenceStyleClasses",(function(){return a})),o.d(n,"connectionReferenceTextStyles",(function(){return c})),o.d(n,"connectionReferenceDropdownStyles",(function(){return d})),o.d(n,"connectionReferenceCalloutStyles",(function(){return u}));var t=o(3328),i=o(2882),r=o(5617),a=Object(t.mergeStyleSets)({fieldSection:["Connection-reference-section",{display:"block"}],fieldHeader:["Connection-reference-section-header",{display:"block",selectors:{label:{fontWeight:"normal",display:"inline-block",marginBottom:"5px",maxWidth:"100%",paddingTop:"5px"}}}],fieldSubHeader:["Connection-reference-section-subheader",{display:"block",selectors:{span:{fontWeight:"normal",fontSize:"12px",display:"inline-block",marginBottom:"22px",maxWidth:"100%",paddingTop:"5px"}}}],fieldIconCallout:["Connection-reference-icon-callout",{width:"330px",height:"auto"}],fieldIcon:["Connection-reference-icon",{paddingLeft:"2px"}],fieldRefreshIcon:["Connection-reference-refresh-icon",{float:"right",selectors:{button:{height:"32px"}}}],fieldRequired:["Connection-reference-required",{color:i.fabricColors.brightRed,paddingLeft:"4px"}],currentValueFieldHeader:{marginTop:"20px",borderTop:"1px solid ".concat(i.fabricColors.neutralLight),paddingTop:"16px"},editCurrentValueFieldInputWrapper:{selectors:{"> *":{display:"inline-block"},"> div":{width:"calc(100% - 32px)"}}},dropdownOptionIcon:{color:r.fabricTheme.palette.themePrimary,margin:"7px 8px 7px 4px",lineHeight:"18px"},dropdownOptionText:{lineHeight:"32px",verticalAlign:"top"},panelFooter:{selectors:{"div[class^='ba-Panel-footer']":{float:"right"}}},learnAboutLink:{cursor:"pointer",fontFamily:"Segoe UI",marginLeft:"2px",color:r.fabricTheme.palette.themePrimary,fontSize:"14px",selectors:{"&:hover":{textDecoration:"underline"}}},moreButton:{width:"32px",maxWidth:"32px"},dialogBoxContentTitleText:{fontWeight:"500"},dialogBoxContentSubText:{display:"block",margin:"10px 0px 10px 0px",fontSize:"14px",fontWeight:"400"},connectionReferenceDropdownHeader:{display:"block",left:"0px",right:"0px",height:"100%",selectors:{i:{marginRight:8},span:{verticalAlign:"top"}}},connectionReferenceDropdownText:{display:"inline-block"},notification:{backgroundColor:"#FAF9F8",border:"1px solid #C8C6C4",borderRadius:"3px",marginBottom:"16px",selectors:{".ms-MessageBar-icon":{display:"none"}}}}),s={borderRadius:"2px",border:"1px solid ".concat(i.fabricColors.neutralTertiaryAlt),boxSizing:"border-box"},l={fontWeight:"normal"},c={fieldGroup:s,subComponentStyles:{label:{root:l}}},d={title:s,label:l},u={root:{borderRadius:"2px",padding:"5px"}}},6373:function(e,n,o){"use strict";o.r(n),o.d(n,"ConnectionReferenceDialog",(function(){return l}));var t=o(890),i=o(684),r=o(245),a=o(2880),s=o(6372);class l extends r.Component{constructor(e){super(e)}render(){return r.createElement(t.Dialog,{hidden:!this.props.visible,onDismiss:()=>{this.props.onDismiss()},dialogContentProps:{type:t.DialogType.normal,styles:{subText:s.connectionReferenceStyleClasses.dialogBoxContentSubText,title:s.connectionReferenceStyleClasses.dialogBoxContentTitleText},isMultiline:!0,title:this.props.title}},this.getDialogContent(),r.createElement(t.DialogFooter,null,r.createElement(i.DefaultButton,{"data-automation-id":"connectionReferenceDialogContinueButton",text:this.props.continueButtonText,onClick:this.props.onContinue}),r.createElement(i.PrimaryButton,{text:this.props.dimissButtonText,onClick:this.props.onDismiss})))}getDialogContent(){return r.createElement("div",null,Object(a.formatResourceStringAsLinks)(this.props.subText,[this.props.dependencyLink]),this.props.info&&r.createElement("span",{className:s.connectionReferenceStyleClasses.dialogBoxContentSubText},this.props.info),this.props.note&&r.createElement("span",{className:s.connectionReferenceStyleClasses.dialogBoxContentSubText},this.props.note))}}},6375:function(e,n,o){"use strict";o.r(n),o.d(n,"EventNames",(function(){return i})),o.d(n,"AdvancedSettingsActionNames",(function(){return r})),o.d(n,"SolutionEventScope",(function(){return a})),o.d(n,"FriendlySolutionImportPanelSteps",(function(){return s})),o.d(n,"getSolutionImportValidationResultsTelemetryData",(function(){return l})),o.d(n,"getConnectionReferencesTelemetryData",(function(){return c})),o.d(n,"getEnvironmentVariableTelemetryData",(function(){return d}));var t=o(6376),i={BrowseFile:"importPanel/browseFile",Dismiss:"importPanel/dismiss",FileSelected:"importPanel/fileSelected",GoBack:"importPanel/goBack",GoForward:"importPanel/GoForward",RefreshConnections:"importPanel/refreshConnections",SendImportRequest:"importPanel/sendImportRequest",AdvancedSettings:"importPanel/advancedSettings",TrackImportStatus:"importPanel/trackImportStatus",DownloadErrorLog:"importPanel/downloadErrorLog",StageSolution:"importPanel/stageSolution"},r={Show:"show",Hide:"hide"},a="powerappsportal/solution",s=new Map([[t.SolutionImportPanelSteps.fileSelection,"fileSelection"],[t.SolutionImportPanelSteps.validationResults,"validationResults"],[t.SolutionImportPanelSteps.connectionReferences,"connectionReferences"],[t.SolutionImportPanelSteps.environmentVariables,"environmentVariables"],[t.SolutionImportPanelSteps.import,"import"]]);function l(e,n,o,t,i){var r,a,s,l,c,d,u;return{solutionAction:t,enableSdkMessagesAndFlows:i,solutionDetails:{previous:null!=e&&null!==(r=e.SolutionDetails)&&void 0!==r&&r.PreviousSolutionUniqueName?{managed:null==e||null===(a=e.SolutionDetails)||void 0===a?void 0:a.PreviousIsManaged,version:null==e||null===(s=e.SolutionDetails)||void 0===s?void 0:s.PreviousSolutionVersion}:void 0,next:null!=e&&null!==(l=e.SolutionDetails)&&void 0!==l&&l.SolutionUniqueName?{managed:null==e||null===(c=e.SolutionDetails)||void 0===c?void 0:c.IsManaged,version:null==e||null===(d=e.SolutionDetails)||void 0===d?void 0:d.SolutionVersion,isPatch:null==e||null===(u=e.SolutionDetails)||void 0===u?void 0:u.IsPatchSolution}:void 0},validations:{hasError:!!n,hasWarning:!!o}}}function c(e,n){return{connectionReferences:null==e?void 0:e.map(e=>{var o;return{connectorId:e.connectorid,availableConnectionsLength:null==n||null===(o=n.get(e.connectorid))||void 0===o?void 0:o.length}})}}function d(e){return{environmentVariableDefinitionsLength:null==e?void 0:e.length}}},6376:function(e,n,o){"use strict";var t,i;o.r(n),o.d(n,"SolutionActionsKeys",(function(){return t})),o.d(n,"SolutionImportPanelSteps",(function(){return i})),o.d(n,"ComponentsListTableItem",(function(){return r})),function(e){e.upgrade="upgrade",e.stageForUpgrade="stageForUpgrade",e.update="update"}(t||(t={})),function(e){e[e.fileSelection=0]="fileSelection",e[e.validationResults=1]="validationResults",e[e.connectionReferences=2]="connectionReferences",e[e.environmentVariables=3]="environmentVariables",e[e.import=4]="import"}(i||(i={}));class r{constructor(){this.key=void 0,this.Items=void 0,this.Type=void 0,this.componentDetail=void 0}}},6381:function(e,n,o){"use strict";o.r(n),o.d(n,"ConnectionReferenceConstants",(function(){return t}));var t={NAME_FORMAT_REGEX:/[^A-Z0-9_]+/gi,HEADER_OPTION_KEY:"Header",CONNECTION_REF_SOL_VERSION:"1.2.0.0",CONNECTION_REF_SOL_UNIQUE_KEY:"PowerPlatformConnectionReferences"}},6382:function(e,n,o){"use strict";var t;o.r(n),o.d(n,"CreateFormKeys",(function(){return t})),function(e){e.connectionreferencelogicalname="connectionreferencelogicalname",e.connectionreferencedisplayname="connectionreferencedisplayname",e.description="description",e.connectionid="connectionid",e.connectorid="connectorid",e.customconnectorid="customconnectorid"}(t||(t={}))}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/198.e1ec71f4.chunk.js.map