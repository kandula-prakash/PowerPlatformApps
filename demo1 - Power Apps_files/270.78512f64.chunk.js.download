/*! For license information please see 270.78512f64.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[270],{8068:function(e,t,r){"use strict";r.r(t),r.d(t,"MetadataCache",(function(){return d}));var n=r(6229),a=r(8069),i=r(8073),o=r(8071),s=r(9041),u=r(2830),c=r(8070),l=r(217);class d{constructor(e){this.languageCode=e,this.expandedEntityCache=[]}static getInstance(e,t){if(this.instances.get(e))return this.instances.get(e);var r=new d(t);return this.instances.set(e,r),r}setFetchExpandedEntity(e,t,r){e.catch(e=>{this.expandedEntityCache.splice(this.expandedEntityCache.findIndex(e=>f(t,e[0][0])&&h(r,e[0][1])),1)});var n=this.expandedEntityCache.findIndex(e=>f(t,e[0][0])&&h(r,e[0][1]));if(-1!==n){var a=this.expandedEntityCache[n][0][0];this.expandedEntityCache.splice(n,1),t=a}this.expandedEntityCache.push([[t,r],e])}getFetchExpandedEntity(e,t){var r=this.expandedEntityCache.find(r=>f(e,r[0][0])&&h(t,r[0][1]));if(r)return r[1]}clearEntityCache(e){var t=[];this.expandedEntityCache.forEach((r,n)=>{p(r[0][0],e)&&t.push(n)});for(var r=t.length-1;r>=0;r--)this.expandedEntityCache.splice(t[r],1)}addOptimisticResponseField(e,t){var r,n=Object(s.getContext)(e),u=Object(s.getOptions)();if(t){var c=null===(r=this.getFetchExpandedEntity(n,u))||void 0===r?void 0:r.then(e=>{var r=Object(a.createAttributeFromOptimisticAttribute)(t,this.languageCode);return e.Attributes.push(r),e});if(c)this.setFetchExpandedEntity(c,n,u);else{var l=new Error("Could not find the promise for the requested entity/option. It should already exist in the cache. Optimistic Response");Object(o.sendErrorEvent)(i.CustomEventNames.metadataEntityNotFound,{context:{solutionId:n.solutionId,solutionName:n.solutionName,entityName:e,fieldLogicalName:t.logicalName},options:u},l)}}}removeOptimisticResponse(e,t){var r,n=Object(s.getContext)(e),a=Object(s.getOptions)();if(t){var u=null===(r=this.getFetchExpandedEntity(n,a))||void 0===r?void 0:r.then(r=>{var s=null==r?void 0:r.Attributes.findIndex(e=>e.LogicalName===t);if(void 0!==s&&s>=0)null==r||r.Attributes.splice(s,1);else{var u=new Error("Could not find the optimistic response. It should have already been added and the attribute logical Name should not have changed.");Object(o.sendErrorEvent)(i.CustomEventNames.removeOptimisticResponseAttributeNotFound,{message:"Optimistic response was not found in cache.",context:{solutionId:n.solutionId,solutionName:n.solutionName,entityName:e,fieldLogicalName:t},options:a},u)}return r});if(u)this.setFetchExpandedEntity(u,n,a);else{var c=new Error("Could not find the promise for the requested entity/options. It should be there as this is the remove function");Object(o.sendErrorEvent)(i.CustomEventNames.metadataEntityNotFound,{context:{solutionId:n.solutionId,solutionName:n.solutionName,entityName:e,fieldLogicalName:t},options:a},c)}}}replaceOptimisticResponseWithField(e,t){var r,d=Object(s.getContext)(e),p=Object(s.getOptions)();if(t){var f=null===(r=this.getFetchExpandedEntity(d,p))||void 0===r?void 0:r.then(r=>{var s=null==r?void 0:r.Attributes.findIndex(e=>e.LogicalName===t.logicalName);void 0!==s&&s>=0?null==r||r.Attributes.splice(s,1):Object(o.sendCustomEvent)(i.CustomEventNames.replaceOptimisticResponseAttributeNotFound,{message:"Optimistic response was not found in cache and it should have been there. Pushed new response instead",context:{solutionId:d.solutionId,solutionName:d.solutionName,entityName:e,fieldLogicalName:t.logicalName},options:p},l.SeverityLevel.Warning);var f,h,m=Object(a.createAttributeFromOptimisticAttribute)(t,this.languageCode);if(null==r||r.Attributes.push(m),Object(n.isLookup)(m)){var y=t.relationship;y&&r.ManyToOneRelationships.push({IsCustomRelationship:!0,IsManaged:!1,IsHierarchical:(f=y).isHierarchical,ReferencedAttribute:f.referencedAttribute,ReferencedEntity:f.referencedEntityTypeName,ReferencingAttribute:f.referencingAttribute,ReferencingEntity:f.referencingEntityTypeName,ReferencingEntityNavigationPropertyName:f.referencingEntityNavigationPropertyName,ReferencedEntityNavigationPropertyName:f.referencedEntityNavigationPropertyName,RelationshipType:null!==(h=f.relationshipType)&&void 0!==h?h:u.RelationshipType.OneToManyRelationship,AssociatedMenuConfiguration:{AvailableOffline:!0,Behavior:c.AssociatedMenuBehavior.UseCollectionName,ExtensionData:void 0,Group:c.AssociatedMenuGroup.Details,Icon:null,IsCustomizable:!0,Label:{},MenuId:null,Order:null,QueryApi:null,ViewId:""},IsCustomizable:!0,IsValidForAdvancedFind:!0,SecurityTypes:u.RelationshipSecurityTypes.None,SchemaName:f.relationshipSchemaName,MetadataId:f.relationshipId,CascadeConfiguration:{Assign:"NoCascade",Delete:"NoCascade",Merge:"NoCascade",Reparent:"NoCascade",RollupView:"NoCascade",Share:"NoCascade",Unshare:"NoCascade"}})}return r});if(f)this.setFetchExpandedEntity(f,d,p);else{var h=new Error("Could not find the promise for the requested entity/options. It should be there as this is the replace function");Object(o.sendErrorEvent)(i.CustomEventNames.metadataEntityNotFound,{context:{solutionId:d.solutionId,solutionName:d.solutionName},options:p},h)}}}}function p(e,t){var r=e.entityId,n=t.entityId,a=e.entityName,i=t.entityName;return!!r&&!!n&&r===n||!!a&&!!i&&a===i}function f(e,t){return p(e,t)&&e.solutionId===t.solutionId}function h(e,t){return!e&&!t||!(!e&&t||e&&!t)&&((null==e?void 0:e.fetchAutoNumberDetails)===(null==t?void 0:t.fetchAutoNumberDetails)&&(null==e?void 0:e.fetchLookupRelatedEntityLabels)===(null==t?void 0:t.fetchLookupRelatedEntityLabels)&&(null==e?void 0:e.fetchModelComponents)===(null==t?void 0:t.fetchModelComponents)&&(null==e?void 0:e.retryOnFailure)===(null==t?void 0:t.retryOnFailure)&&(null==e?void 0:e.solutionFilterMode)===(null==t?void 0:t.solutionFilterMode))}d.instances=new Map},8069:function(e,t,r){"use strict";r.r(t),r.d(t,"getAttributeTypeAndTypeCode",(function(){return l})),r.d(t,"createAttributeFromOptimisticAttribute",(function(){return d}));var n=r(2830),a=r(2831),i=r(6229),o=r(8070),s=r(8071),u=r(8073),c=r(8074);function l(e){switch(e){case"Lookup":return{type:n.AttributeTypeCode.Lookup,typeCode:"LookupType"};case"Integer":return{type:n.AttributeTypeCode.Integer,typeCode:"IntegerType"};case"Decimal":return{type:n.AttributeTypeCode.Decimal,typeCode:"DecimalType"};case"BigInt":return{type:n.AttributeTypeCode.BigInt,typeCode:"BigIntType"};case"DateTime":return{type:n.AttributeTypeCode.DateTime,typeCode:"DateTimeType"};case"Uniqueidentifier":return{type:n.AttributeTypeCode.Uniqueidentifier,typeCode:"UniqueidentifierType"};case"String":return{type:n.AttributeTypeCode.String,typeCode:"StringType"};case"BigInt":return{type:n.AttributeTypeCode.BigInt,typeCode:"BigIntType"};case"Owner":return{type:n.AttributeTypeCode.Owner,typeCode:"OwnerType"};case"Picklist":return{type:n.AttributeTypeCode.Picklist,typeCode:"PicklistType"};case"State":return{type:n.AttributeTypeCode.State,typeCode:"StateType"};case"Status":return{type:n.AttributeTypeCode.Status,typeCode:"StatusType"};case"EntityName":return{type:n.AttributeTypeCode.EntityName,typeCode:"EntityNameType"};case"Boolean":return{type:n.AttributeTypeCode.Boolean,typeCode:"BooleanType"};case"Double":return{type:n.AttributeTypeCode.Double,typeCode:"DoubleType"};case"Money":return{type:n.AttributeTypeCode.Money,typeCode:"MoneyType"};case"Customer":return{type:n.AttributeTypeCode.Customer,typeCode:"CustomerType"};case"Memo":return{type:n.AttributeTypeCode.Memo,typeCode:"MemoType"};default:return}}function d(e,t){var r,d,m,y=l(e.attributeType);y||(Object(s.sendCustomEvent)(u.CustomEventNames.optimisticFieldConversionWithoutDataType,{dataType:e.attributeType},c.SeverityLevel.Warning),y={type:n.AttributeTypeCode.String,typeCode:"StringType"});var v=function(e){switch(e){case"systemRequired":return o.AttributeRequiredLevel.SystemRequired;case"recommended":return o.AttributeRequiredLevel.Recommended;case"applicationRequired":return o.AttributeRequiredLevel.ApplicationRequired;case"none":default:return o.AttributeRequiredLevel.None}}(e.requiredLevel);return function(e,t,r){if(Object(i.isBoolean)(e)){var o,s=t;return e.DefaultValue=s.defaultValue,e.OptionSet={TrueOption:p(s.trueOption,r),FalseOption:p(s.falseOption,r),OptionSetType:a.OptionSetType.Boolean,Description:f(null!==(o=s.description)&&void 0!==o?o:"",r),DisplayName:f(s.displayName,r),ExternalTypeName:s.__typename,IsGlobal:!1,Name:s.displayName,IsCustomOptionSet:!0,IntroducedVersion:"",IsCustomizable:{Value:!0},IsManaged:!1,MetadataId:""},e}if(Object(i.isDateTime)(e)){var u=t;return e.DateTimeBehavior={Value:n.DateTimeBehavior.DateOnly},e.Format="DateOnly"===u.format?n.DateTimeFormat.DateOnly:n.DateTimeFormat.DateAndTime,e}if(Object(i.isDecimal)(e)){var c=t;return e.MinValue=c.minValue,e.MaxValue=c.maxValue,e.Precision=c.decimalPrecision,e}if(Object(i.isInteger)(e)){var l=t;return e.Format=l.formatName,e.MinValue=l.minValue,e.MaxValue=l.maxValue,e}if(Object(i.isPicklist)(e)){var d,m,y,v=t;return e.DefaultFormValue=v.defaultFormValue,e.OptionSet={OptionSetType:a.OptionSetType.Picklist,Options:null!==(d=null===(m=v.optionSet)||void 0===m?void 0:m.options.map(e=>p(e,r)))&&void 0!==d?d:[],DisplayName:f(v.displayName,r),Description:f(null!==(y=v.description)&&void 0!==y?y:"",r),ExternalTypeName:v.__typename,IsGlobal:!1,Name:v.displayName,IsCustomOptionSet:!0,IntroducedVersion:"",IsCustomizable:{Value:!0},IsManaged:!1,MetadataId:""},e}if(Object(i.isLookup)(e))return e.Targets=t.targets,e;if(Object(i.isString)(e)){var g=t;e.FormatName={Value:h(g.formatName)},e.AutoNumberFormat=g.autoNumberFormat,"Autonumber"===g.formatName&&(e[i.autoNumberSeedAnnotation]=g.autoNumberSeed,e[i.autoNumberNextValueAnnotation]=g.autoNumberNextValue),e.MaxLength=g.maxLength}return e}({AttributeOf:null,AttributeType:y.type,AttributeTypeName:{Value:null===(r=y)||void 0===r?void 0:r.typeCode},CanBeSecuredForCreate:!0,CanBeSecuredForRead:!0,CanBeSecuredForUpdate:!0,CanModifyAdditionalSettings:{Value:!0},Description:f(null!==(d=e.description)&&void 0!==d?d:"",t),DisplayName:f(e.displayName,t),FormulaDefinition:"",MetadataId:e.id,IsPrimaryName:!1,LogicalName:e.logicalName,RequiredLevel:{Value:v},SchemaName:e.logicalName,SourceType:null!==(m=e.sourceType)&&void 0!==m?m:a.SourceType.Simple,InheritsFrom:null,IsAuditEnabled:{Value:e.isAuditable},IsCustomAttribute:e.isCustom,IsCustomizable:{Value:e.isCustomizable},IsGlobalFilterEnabled:{Value:e.appearsInGlobalFilter},IsFilterable:!0,IsLogical:e.isLogical,IsManaged:e.isManaged,IsPrimaryId:!1,IsRenameable:{Value:e.isRenameable},IsRequiredForForm:e.isRequiredForForm,IsRetrievable:!0,IsSearchable:e.isSearchable,IsSecured:e.isSecured,IsSortableEnabled:{Value:e.isSortable},IsValidForAdvancedFind:{Value:e.isValidForAdvancedFind},IsValidForCreate:e.isValidForCreate,IsValidForForm:e.isValidForForm,IsValidForGrid:e.isValidForGrid,IsValidForRead:!0,IsValidForUpdate:e.isValidForUpdate},e,t)}function p(e,t){var r,n;return{Label:f(null!==(r=e.label)&&void 0!==r?r:e.displayName,t),Value:+e.value,Color:e.color,Description:f(null!==(n=e.description)&&void 0!==n?n:"",t)}}function f(e,t){return{LocalizedLabels:[{Label:e,LanguageCode:t}],UserLocalizedLabel:{Label:e,LanguageCode:t}}}function h(e){switch(e){case"Phone":return n.StringFormatName.Phone;case"Email":return n.StringFormatName.Email;case"Text":return n.StringFormatName.Text;case"TextArea":return n.StringFormatName.TextArea;case"Url":return n.StringFormatName.Url;case"VersionNumber":return n.StringFormatName.VersionNumber;default:return n.StringFormatName.Text}}},8071:function(e,t,r){"use strict";r.r(t),r.d(t,"sendTraceInfo",(function(){return s})),r.d(t,"sendErrorEvent",(function(){return u})),r.d(t,"sendCustomEvent",(function(){return c})),r.d(t,"getScenarioTracker",(function(){return l})),r.d(t,"getScenarioId",(function(){return p}));var n=r(217),a=r(218),i=r(222),o=r(8072);function s(e,t){Object(a.trackInfoTrace)(o.CdsPowerTableDesignerScope,{eventName:e,eventData:d(t)})}function u(e,t,r){Object(a.trackErrorTrace)(o.CdsPowerTableDesignerScope,{eventName:e,eventData:d(t)},r)}function c(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n.SeverityLevel.Information,i=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0;Object(a.trackCustomEvent)(o.CdsPowerTableDesignerScope,{eventName:e,eventData:d(t),eventSeverity:r,eventDuration:i,eventModifier:s})}function l(e,t){var r=Object(a.trackLoadScenario)(o.CdsPowerTableDesignerScope,e,d(t));return{complete:e=>r.complete(d(e)),progress:e=>r.progress(d(e)),failure:(e,t)=>r.failure(d(e,t)),completeWithError:(e,t)=>r.completeWithError(d(e,t))}}function d(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return{payload:e,error:t?Object(a.getErrorProperties)(t):void 0}}function p(){return Object(i.v4)()}},8072:function(e,t,r){"use strict";r.r(t),r.d(t,"CdsPowerTableDesignerScope",(function(){return n}));var n="cds-powertable-designer"},8073:function(e,t,r){"use strict";var n,a,i;r.r(t),r.d(t,"ScenarioEventNames",(function(){return n})),r.d(t,"EntityEditInitialLoadStates",(function(){return a})),r.d(t,"CustomEventNames",(function(){return i})),function(e){e.dataDelete="Data/Delete",e.metadataGetEntity="Metadata/Entity/Get",e.metadataCreateEntity="Metadata/Entity/Create",e.metadataUpdateEntity="Metadata/Entity/Update",e.metadataCreateField="Metadata/Field/Create",e.metadataUpdateField="Metadata/Field/Update",e.metadataDeleteField="Metadata/Field/Delete",e.metadataAsyncCreateField="Metadata/Async/Field/Create",e.fieldCreate="Async/Field/Create",e.manualRetryFieldCreate="Async/Field/Create/Retry/Manual",e.entityEditInitialLoad="EntityEdit/InitialLoad"}(n||(n={})),function(e){e.MetadataLoadStart="MetadataLoadStart",e.MetadataLoaded="MetadataLoaded",e.MetadataLoadFailed="MetadataLoadFailed",e.DataLoadStart="DataLoadStart",e.DataLoaded="DataLoaded",e.DataLoadFailed="DataLoadFailed",e.DataRendered="DataRendered"}(a||(a={})),function(e){e.addRow="Data/AddRow",e.insertRowAbove="Data/InsertAbove",e.insertRowBelow="Data/InsertBelow",e.refresh="Data/Refresh",e.mdlOutOfSync="Data/DataSetProvider/MDLOutOfSync",e.updateDataSetState="Data/UpdateDataSetState",e.metadataGetEntityColumnsWithoutNames="Metadata/Entity/Get/ColumnsWithoutNames",e.metadataCreateEntityContractGenerationFail="Metadata/Entity/Create/ContractGenerationError",e.metadataOptimisticResponseWithoutDataType="Async/Field/Create/OptimisticResponse/DataType",e.optimisticFieldConversionWithoutDataType="Async/Field/Create/OptimisticResponse/Metadata/DataType",e.replaceOptimisticResponseAttributeNotFound="Async/Field/Create/OptimisticResponse/Metadata/Replace",e.removeOptimisticResponseAttributeNotFound="Async/Field/Create/OptimisticResponse/Metadata/Remove",e.metadataEntityNotFound="Async/Field/Create/Entity/NotFound",e.reducerMetadataNotFound="Async/Field/Create/ReducerMetadata/NotFound",e.reducerMetadataUpdateNotFound="Async/Field/Update/ReducerMetadata/NotFound",e.reducerMetadataDeleteNotFound="Async/Field/Delete/ReducerMetadata/NotFound",e.userInterfaceCrash="UserInterface/Crash",e.userInterfaceSelectRecord="UserInterface/Select/Record",e.userInterfaceAddColumnOpen="UserInterface/AddColumn/Open",e.userInterfaceAddColumnClose="UserInterface/AddColumn/Close",e.userInterfaceColumnPanelOpen="UserInterface/ColumnPanel/Open",e.userInterfaceColumnPanelClose="UserInterface/ColumnPanel/Close",e.userInterfaceShowHideColumnsOpen="UserInterface/ShowHideColumns/Open",e.userInterfaceShowHideColumnsClose="UserInterface/ShowHideColumns/Close",e.userInterfaceUpdateRowHeight="UserInterface/RowDensity/Update",e.userInterfaceUpdateUserConfig="UserInterface/UserConfig/Update",e.userInterfaceDeleteColumnOpen="UserInterface/DeleteColumn/Open",e.userInterfaceDeleteColumnClose="UserInterface/DeleteColumn/Close",e.closeButtonClickEvent="closeButtonClickEvent",e.LSPRequestError="LSP/RequestError",e.localStorageReadError="LocalStorage/GetValue/Error",e.localStorageWriteError="LocalStorage/SetValue/Error",e.localStorageRetryError="LocalStorage/SetValue/MaxRetries",e.localStorageRemoveError="LocalStorage/RemoveValue/Error",e.localStorageReadTrackerError="LocalStorage/Tracker/GetValue/Error",e.localStorageWriteTrackerError="LocalStorage/Tracker/SetValue/Error",e.localStorageRemoveOldItem="LocalStorage/RemoveOld"}(i||(i={}))},8074:function(e,t,r){"use strict";r.r(t);var n=r(8075);r.d(t,"PowerAppsDataSetGrid",(function(){return n.PowerAppsDataSetGrid}));var a=r(9004);r.d(t,"defaultGridContainerProps",(function(){return a.defaultGridContainerProps})),r.d(t,"ShimmeredDataSetGrid",(function(){return a.ShimmeredDataSetGrid}));var i=r(9005);r.d(t,"DataSetGridHost",(function(){return i.DataSetGridHost}));var o=r(8985);r.d(t,"GridInitialLoadState",(function(){return o.GridInitialLoadState})),r.d(t,"UISortDirection",(function(){return o.UISortDirection})),r.d(t,"SeverityLevel",(function(){return o.SeverityLevel}));var s=r(8990);r.d(t,"PCFTypes",(function(){return s}))},8075:function(e,t,r){"use strict";r.r(t),r.d(t,"PowerAppsDataSetGrid",(function(){return O}));var n=r(8076),a=r(8448),i=r(1795),o=r(245),s=r.n(o),u=r(8984),c=r(8986),l=r(8985),d=r(8987),p=r(8999);function f(){return(f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function h(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function m(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){h(i,n,a,o,s,"next",e)}function s(e){h(i,n,a,o,s,"throw",e)}o(void 0)}))}}function y(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function v(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?y(Object(r),!0).forEach((function(t){g(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function g(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var O=e=>{var t,r,h,y,g,O,E,b,T,S,C,N,_,R,P,I,A,D,M,F,w,L,j,x,U,k,q,V,B,H,G,Q,z,X,[W,Y]=Object(o.useState)(),[K,J]=Object(o.useState)(void 0),Z=Object(o.useMemo)(()=>v(v({},e.callbacks),{},{recordsCountChanged:t=>{var r,n;null===(r=e.callbacks)||void 0===r||null===(n=r.recordsCountChanged)||void 0===n||n.call(r,t),0===t&&e.gridContainerClassName&&J(e.gridContainerClassName)}}),[e.callbacks,e.gridContainerClassName,J]),$=Object(o.useMemo)(()=>{var t,r,n,a,i,o,s,u,c,l,d,f,h,m,y;return{callbacks:Z,telemetryProvider:null===(t=e.configuration)||void 0===t?void 0:t.telemetryProvider,formatter:null===(r=e.configuration)||void 0===r?void 0:r.formatter,languageId:e.languageId,props:{pageSize:null!==(n=null===(a=e.configuration)||void 0===a?void 0:a.initialPageSize)&&void 0!==n?n:p.DEFAULT_CACHE_BLOCK_SIZE,userConfiguration:null===(i=e.configuration)||void 0===i?void 0:i.userConfiguration,localizedStrings:null===(o=e.configuration)||void 0===o?void 0:o.localizedStrings,enableColumnAdding:null!==(s=null===(u=e.configuration)||void 0===u?void 0:u.enableColumnAdding)&&void 0!==s&&s,enableRowAdding:null!==(c=null===(l=e.configuration)||void 0===l?void 0:l.enableRowAdding)&&void 0!==c&&c,enableLookupNavigation:null===(d=null===(f=e.configuration)||void 0===f?void 0:f.enableLookupNavigation)||void 0===d||d,enableFiltering:null===(h=null===(m=e.configuration)||void 0===m?void 0:m.enableFiltering)||void 0===h||h,totalRecordsLimit:null===(y=e.configuration)||void 0===y?void 0:y.totalRecordsLimit}}},[Z,e.languageId,null===(t=e.configuration)||void 0===t?void 0:t.enableColumnAdding,null===(r=e.configuration)||void 0===r?void 0:r.enableRowAdding,null===(h=e.configuration)||void 0===h?void 0:h.enableLookupNavigation,null===(y=e.configuration)||void 0===y?void 0:y.enableFiltering,null===(g=e.configuration)||void 0===g?void 0:g.formatter,null===(O=e.configuration)||void 0===O?void 0:O.initialPageSize,null===(E=e.configuration)||void 0===E?void 0:E.localizedStrings,null===(b=e.configuration)||void 0===b?void 0:b.telemetryProvider,null===(T=e.configuration)||void 0===T?void 0:T.userConfiguration,null===(S=e.configuration)||void 0===S?void 0:S.totalRecordsLimit]),ee=Object(o.useRef)();ee.current||(ee.current=new d.DataSetDataProvider(e.dataSet,$,e.asyncColumnsEnabled,e.escapeFilterValues)),Object(o.useMemo)(()=>ee.current.updateUserConfiguration($.props.userConfiguration),[$.props.userConfiguration]);var te=Object(o.useMemo)(()=>{return{onDataSetUpdated:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3?arguments[3]:void 0;ee.current.dataSetUpdated(e,t,r,n)},onNavigate:(o=m((function*(){yield ee.current.saveTable()})),function(){return o.apply(this,arguments)}),onAddRowClicked:(i=m((function*(){yield ee.current.insertRecordAsync("add")})),function(){return i.apply(this,arguments)}),onInsertRowAboveClicked:(a=m((function*(){yield ee.current.insertRecordAsync("insertAbove")})),function(){return a.apply(this,arguments)}),onInsertRowBelowClicked:(n=m((function*(){yield ee.current.insertRecordAsync("insertBelow")})),function(){return n.apply(this,arguments)}),onRefreshClicked:()=>{ee.current.refreshClicked()},onDeleteClicked:(r=m((function*(){yield ee.current.deleteSelectedRecords()})),function(){return r.apply(this,arguments)}),onSave:(t=m((function*(){try{yield ee.current.saveTable()}catch(n){var t,r;null===(t=e.configuration)||void 0===t||null===(r=t.telemetryProvider)||void 0===r||r.sendErrorEvent(c.telemetryKeys.saveRecordError,{},n)}return ee.current.getDataSetState()})),function(){return t.apply(this,arguments)}),onRetrieveRecordIds:()=>ee.current.getAllRecordIds()};var t,r,n,a,i,o},[ee,null===(C=e.configuration)||void 0===C?void 0:C.telemetryProvider]);Object(o.useEffect)(()=>{var t,r,n,a,i,o,s,u,c,l,d,p,f,h,m,y,v,g;return null===(t=e.events)||void 0===t||null===(r=t.onDataSetUpdated)||void 0===r||r.addListener(te.onDataSetUpdated),null===(n=e.events)||void 0===n||null===(a=n.onNavigate)||void 0===a||a.addListener(te.onNavigate),null===(i=e.events)||void 0===i||null===(o=i.onAddRowClicked)||void 0===o||o.addListener(te.onAddRowClicked),null===(s=e.events)||void 0===s||null===(u=s.onInsertRowAboveClicked)||void 0===u||u.addListener(te.onInsertRowAboveClicked),null===(c=e.events)||void 0===c||null===(l=c.onInsertRowBelowClicked)||void 0===l||l.addListener(te.onInsertRowBelowClicked),null===(d=e.events)||void 0===d||null===(p=d.onRefreshClicked)||void 0===p||p.addListener(te.onRefreshClicked),null===(f=e.events)||void 0===f||null===(h=f.onDeleteClicked)||void 0===h||h.addListener(te.onDeleteClicked),null===(m=e.events)||void 0===m||null===(y=m.onRetrieveRecordIds)||void 0===y||y.addListener(te.onRetrieveRecordIds),null===(v=e.events)||void 0===v||null===(g=v.onSave)||void 0===g||g.addListener(te.onSave),()=>{var t,r,n,a,i,o,s,u,c,l,d,p,f,h,m,y,v,g;null===(t=e.events)||void 0===t||null===(r=t.onDataSetUpdated)||void 0===r||r.removeListener(te.onDataSetUpdated),null===(n=e.events)||void 0===n||null===(a=n.onNavigate)||void 0===a||a.removeListener(te.onNavigate),null===(i=e.events)||void 0===i||null===(o=i.onAddRowClicked)||void 0===o||o.removeListener(te.onAddRowClicked),null===(s=e.events)||void 0===s||null===(u=s.onInsertRowAboveClicked)||void 0===u||u.removeListener(te.onInsertRowAboveClicked),null===(c=e.events)||void 0===c||null===(l=c.onInsertRowBelowClicked)||void 0===l||l.removeListener(te.onInsertRowBelowClicked),null===(d=e.events)||void 0===d||null===(p=d.onRefreshClicked)||void 0===p||p.removeListener(te.onRefreshClicked),null===(f=e.events)||void 0===f||null===(h=f.onDeleteClicked)||void 0===h||h.removeListener(te.onDeleteClicked),null===(m=e.events)||void 0===m||null===(y=m.onRetrieveRecordIds)||void 0===y||y.removeListener(te.onRetrieveRecordIds),null===(v=e.events)||void 0===v||null===(g=v.onSave)||void 0===g||g.removeListener(te.onSave)}},[e.events,te]),Object(o.useEffect)(()=>{ee.current.updateCallbacks($.callbacks)},[$.callbacks]);var re=s.a.useCallback(()=>{var e,t;return null===(e=(t=$.callbacks).onInitialLoad)||void 0===e?void 0:e.call(t,l.GridInitialLoadState.DataRendered)},[$.callbacks]),ne=e.cellCustomization||new a.Customizers(null===(N=e.configuration)||void 0===N||null===(_=N.localizedStrings)||void 0===_?void 0:_.customizerLocalizedStrings,(null===(R=e.configuration)||void 0===R?void 0:R.telemetryProvider)&&Object(u.getTelemetryClient)(e.configuration.telemetryProvider,"cellCustomizers"),null===(P=e.configuration)||void 0===P||null===(I=P.userConfiguration)||void 0===I?void 0:I.rowDensity,e.cellRendererOverrides,e.cellEditorOverrides,{getHeaderStyles:null===(A=e.configuration)||void 0===A||null===(D=A.gridConfiguration)||void 0===D||null===(M=D.styleOverrides)||void 0===M?void 0:M.headerCells},void 0,null===(F=e.configuration)||void 0===F?void 0:F.dateFormattingInfo);return s.a.createElement(i.Stack,{verticalFill:!0},s.a.createElement(i.Stack.Item,{grow:!0,verticalFill:!0,className:K},s.a.createElement(n.AgGridContainer,f({},null===(w=e.configuration)||void 0===w?void 0:w.gridConfiguration,{cellCustomization:ne,onColumnInsert:null===(L=e.callbacks)||void 0===L?void 0:L.onColumnInsert,onColumnEdit:null===(j=e.callbacks)||void 0===j?void 0:j.onColumnEdit,columns:null!==(x=null===(U=e.onBeforeRenderColumns)||void 0===U?void 0:U.call(e,ee.current.columns))&&void 0!==x?x:ee.current.columns,onSelectionChanged:ee.current.setSelectedRecords,onGridReady:ee.current.onGridLoad,onCellValueChanged:ee.current.cellValueChanged,infiniteScroll:!0,useEditableStyles:!e.forceReadonly,dataSource:ee.current.dataSource,onColumnPinned:ee.current.onColumnPinned,onColumnMoved:ee.current.onColumnMoved,onColumnSort:ee.current.sortColumn,onColumnResized:ee.current.onColumnResized,onPasteEnd:ee.current.onPasteEnded,columnsAutoFit:!1,onColumnFilter:ee.current.applyColumnFilter,onColumnClearFilter:ee.current.clearColumnFilter,onViewportChanged:ee.current.onViewportChanged},ee.current.hasError?{allowColumnMoving:!1,allowColumnResizing:!1}:{},{telemetryClient:(null===(k=e.configuration)||void 0===k?void 0:k.telemetryProvider)&&Object(u.getTelemetryClient)(e.configuration.telemetryProvider,"gridContainer"),onAccessibilityNotification:Y,localizedStrings:null===(q=e.configuration)||void 0===q||null===(V=q.localizedStrings)||void 0===V?void 0:V.gridBaseLocalizedString,isRowSelectable:ee.current.isRowSelectable,isRTLMode:e.isRTLMode,onFirstDataRendered:re,onCellEditStarted:ee.current.cellEditStarted,onCellEditEnded:ee.current.cellEditEnded,processDataFromClipboard:ee.current.onProcessDataFromClipboard,onRowNavigation:e.forceReadonly?ee.current.onRowNavigation:void 0,styleOverrides:{rows:null===(B=e.configuration)||void 0===B||null===(H=B.gridConfiguration)||void 0===H||null===(G=H.styleOverrides)||void 0===G?void 0:G.rows,headerRow:null===(Q=e.configuration)||void 0===Q||null===(z=Q.gridConfiguration)||void 0===z||null===(X=z.styleOverrides)||void 0===X?void 0:X.headerRow}}))),!ee.current.hasError&&e.footer,s.a.createElement(a.AccessibilityNotifier,{message:W}))}},8984:function(e,t,r){"use strict";r.r(t),r.d(t,"getTelemetryClient",(function(){return i}));var n=r(8985),a={gridContainer:"Grid/Container/",cellCustomizers:"Grid/CellCustomizers/"};function i(e,t){var r=a[t];return{trackEvent:t=>{t.severityLevel===n.SeverityLevel.Debug||t.severityLevel===n.SeverityLevel.Warning||t.severityLevel===n.SeverityLevel.Information?e.sendCustomEvent("".concat(r).concat(t.eventName),t.payload,t.severityLevel,t.eventDuration,t.eventModifier):e.sendErrorEvent("".concat(r).concat(name),t.payload,new Error("Unknown error"))},trackError:(t,n,a)=>{var i;e.sendErrorEvent("".concat(r).concat(t),a,(i=n)&&i.error?i.error:i||new Error(i))},trackScenario:e.getScenarioTracker}}},8985:function(e,t,r){"use strict";r.r(t),r.d(t,"GridInitialLoadState",(function(){return n})),r.d(t,"SeverityLevel",(function(){return a}));var n,a,i=r(8082);r.d(t,"UISortDirection",(function(){return i.SortDirection})),function(e){e.DataLoadStart="DataLoadStart",e.DataLoaded="DataLoaded",e.DataLoadFailed="DataLoadFailed",e.DataRendered="DataRendered"}(n||(n={})),function(e){e.Debug="Debug",e.Information="Information",e.Warning="Warning",e.Error="Error"}(a||(a={}))},8986:function(e,t,r){"use strict";var n;r.r(t),r.d(t,"telemetryKeys",(function(){return n})),function(e){e.initialFullLoad="DataSetGrid/Initial/Load",e.loadEntity="DataSetGrid/Entity/Load",e.loadData="DataSetGrid/Data/Load",e.pageRefresh="DataSetGrid/Data/Refresh",e.filterGridData="DataSetGrid/Filter",e.sortGridData="DataSetGrid/Sort",e.columnPinned="DataSetGrid/UserInterface/ColumnPinned",e.addRow="DataSetGrid/Data/Add",e.editRow="DataSetGrid/Data/Edit",e.editRowError="DataSetGrid/Data/Edit/Error",e.setFieldValueError="DataSetGrid/SetFieldValue/Error",e.saveRecord="DataSetGrid/SaveRecord",e.saveRecordError="DataSetGrid/SaveRecord/Error",e.deleteRecords="DataSetGrid/DeleteRecords",e.saveMultipleRecords="DataSetGrid/SaveMultipleRecords",e.dataSetError="DataSetGrid/DataSet/Error",e.extraGetDataCallError="DataSetGrid/GetRowData/Error",e.gridCacheError="DataSetGrid/GridCache/Error"}(n||(n={}))},8987:function(e,t,r){"use strict";r.r(t),r.d(t,"DEFAULT_MAX_RECORD_COUNT",(function(){return b})),r.d(t,"DataSetDataProvider",(function(){return T}));var n=r(8082),a=r(8986),i=r(8985),o=r(8988),s=r(8993),u=r(8990),c=r(8997),l=r(8998),d=r(8989),p=r(8999),f=r(9e3),h=r(9001),m=r(9003);function y(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function v(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?y(Object(r),!0).forEach((function(t){g(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function g(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function O(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function E(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){O(i,n,a,o,s,"next",e)}function s(e){O(i,n,a,o,s,"throw",e)}o(void 0)}))}}var b=5e3;class T{get totalRowsCount(){if(void 0!==this.recordsCount.dataSetTotalRecordsCount)return-1===this.recordsCount.dataSetTotalRecordsCount?b:this.recordsCount.dataSetTotalRecordsCount+this.recordsCount.addedRecords-this.recordsCount.deletedRecords-(this.lastDummyRow?1:0)}get columns(){return this.columnDefinitions}get primaryColumn(){return this.primaryColumnDefinition}get sortedColumnName(){return this.primarySortedColumnName}get rowHasPendingChanges(){return!!this.currentRowEditId}get hasNextPage(){return this.dataSet.paging.hasNextPage}get hasPreviousPage(){return this.dataSet.paging.hasPreviousPage}get isLoadDataPending(){return this.dataSet.loading}get hasError(){return this.dataSet.error&&!!this.dataSet.errorMessage}get dataSource(){return{getDataSourceConfig:()=>this.dataSourceConfig,getRows:this.getDataCall}}get pageSize(){var e;return null!==(e=this.config.props.pageSize)&&void 0!==e?e:p.DEFAULT_CACHE_BLOCK_SIZE}get params(){return this.baseGridGetRowsParams}resetParams(e){var t;e&&(null===(t=this.baseGridGetRowsParams)||void 0===t||t.failCallback());this.baseGridGetRowsParams=void 0}constructor(e,t){var r,o,u,c=this,l=arguments.length>2&&void 0!==arguments[2]&&arguments[2],d=arguments.length>3?arguments[3]:void 0;this.dataSet=e,this.config=t,this.asyncColumnsEnabled=l,this.escapeFilterValues=d,this.columnDefinitions=[],this.primaryColumnDefinition=void 0,this.primarySortedColumnName=void 0,this.dataSourceConfig=void 0,this.gridApi=void 0,this.initialLoadEntityScenario=void 0,this.initialLoadDataScenario=void 0,this.currentRowEditId=void 0,this.editRowScenario=void 0,this.insertRowScenario=void 0,this.recordsCache={},this.sortedRecordIds=[],this.baseGridGetRowsParams=void 0,this.getDataScenario=void 0,this.sortScenario=void 0,this.filterScenario=void 0,this.selectedRecordIds=[],this.recordsToBeCleanedFromCacheOnRefresh=[],this.currentRowIndex=0,this.recordsOperationsQueue=void 0,this.lastDummyRowPromise=void 0,this.lastDummyRow=void 0,this.tempRecords={},this.pendingRowToEdit={},this.editingCell=void 0,this.relatedDataSetsProvider=void 0,this.recordsCount={addedRecords:0,deletedRecords:0},this.getDataCall=function(){var e=E((function*(e){var t,r;if(c.params)return null===(r=c.config.telemetryProvider)||void 0===r||r.sendErrorEvent(a.telemetryKeys.extraGetDataCallError,{oldParamsEndRow:c.params.endRow,oldParamsStartRow:c.params.startRow,newParamsEndRow:e.endRow,newParamsStartRow:e.startRow},new Error("Another Params exists and GetDataCall was called")),void e.failCallback();c.getDataScenario=null===(t=c.config.telemetryProvider)||void 0===t?void 0:t.getScenarioTracker(a.telemetryKeys.loadData,{startRow:e.startRow,endRow:e.endRow,currentCacheSize:c.sortedRecordIds.length}),c.baseGridGetRowsParams=e,c.checkCacheForRows()}));return function(t){return e.apply(this,arguments)}}(),this.onNewRecordSaved=(e,t)=>{var r,n=this.sortedRecordIds.indexOf(e);-1!==n&&this.getRecordFromCache(e)||(null===(r=this.config.telemetryProvider)||void 0===r||r.sendErrorEvent(a.telemetryKeys.gridCacheError,{tempRecordId:e,recordId:t},new Error("Record is not on sorted record ids array")));this.recordsToBeCleanedFromCacheOnRefresh.push(e),this.recordsCache[t]=this.getRecordFromCache(e),this.sortedRecordIds[n]=t},this.onGridLoad=e=>{var t,r,n,a;null===(t=this.initialLoadEntityScenario)||void 0===t||t.complete({numberOfColumns:this.columnDefinitions.length,numberOfRecords:this.sortedRecordIds.length}),null===(r=this.initialLoadDataScenario)||void 0===r||r.progress({numberOfColumns:this.columnDefinitions.length,numberOfRecords:this.sortedRecordIds.length}),null===(n=(a=this.config.callbacks).onInitialLoad)||void 0===n||n.call(a,i.GridInitialLoadState.DataLoadStart),this.gridApi=e},this.dataSetStateChanged=()=>{this.config.callbacks.onDataSetStateChanged&&this.config.callbacks.onDataSetStateChanged(this.getDataSetState())},this.getDataSetState=()=>v(v({},this.recordsOperationsQueue.getRecordOperationsCount()),{},{isLoading:this.isLoadDataPending,selectedRecordsCount:this.getSelectedRecordIds().length,error:this.dataSet.error?new Error(this.dataSet.errorMessage):void 0}),this.setSelectedRecords=e=>{this.currentRowEditId&&(1===e.length&&this.currentRowEditId!==e[0][n.RECID]||e.length>1)&&this.rowEditEnded();var t=e.map(e=>e[n.RECID]);this.lastDummyRow&&(t=t.filter(e=>{var t;return e!==(null===(t=this.lastDummyRow)||void 0===t?void 0:t.getRecordId())})),this.selectedRecordIds=t,this.dataSet.setSelectedRecordIds(this.selectedRecordIds),this.dataSetStateChanged()},this.onPasteEnded=()=>{this.saveTable()},this.isRowSelectable=e=>!this.lastDummyRow||e[n.RECID]!==this.lastDummyRow.getRecordId(),this.onViewportChanged=e=>{this.currentRowIndex=e},this.applyColumnFilter=function(){var e=E((function*(e){var t;if(yield c.attemptToSaveTable()){c.filterScenario&&c.filterScenario.completeWithError({newFilter:!0}),c.filterScenario=null===(t=c.config.telemetryProvider)||void 0===t?void 0:t.getScenarioTracker(a.telemetryKeys.filterGridData,{filterOperator:e.operator});var r=e.column.name,n=c.columnDefinitions.find(e=>e.name===r);if(n){var i,o;n.filterExpression=e;var u=Object(s.createOrUpdateColumnFilterInDataSet)(e,c.getColumnAttributeMetadata(e.column.name),c.dataSet.filtering.getFilter(),n.filterExpression,c.escapeFilterValues);c.dataSet.filtering.setFilter(u),null===(i=(o=c.config.callbacks).onConfigurationUpdated)||void 0===i||i.call(o,{columns:{[r]:{updatedProps:["filter"],config:{filter:e}}}}),c.reloadData({hardRefresh:!0})}}}));return function(t){return e.apply(this,arguments)}}(),this.clearColumnFilter=function(){var e=E((function*(e){var t;if(yield c.attemptToSaveTable()){c.filterScenario&&c.filterScenario.completeWithError({newFilter:!0}),c.filterScenario=null===(t=c.config.telemetryProvider)||void 0===t?void 0:t.getScenarioTracker(a.telemetryKeys.filterGridData,{filterOperator:"clear"});var r,n,i=c.dataSet.filtering.getFilter(),o=c.columnDefinitions.find(t=>t.name===e);if(o&&(o.filterExpression=void 0),Object(s.removeColumnFilterInDataSet)(i,e,c.getColumnAttributeMetadata(e),null==o?void 0:o.filterExpression))Object(s.isFilterEmpty)(i)?c.dataSet.filtering.clearFilter():c.dataSet.filtering.setFilter(i),null===(r=(n=c.config.callbacks).onConfigurationUpdated)||void 0===r||r.call(n,{columns:{[e]:{config:{filter:void 0},updatedProps:["filter"]}}}),c.reloadData({hardRefresh:!0})}}));return function(t){return e.apply(this,arguments)}}(),this.onRowNavigation=e=>{var t=this.dataSet.records[e[n.RECID]];this.dataSet.openDatasetItem(t.getNamedReference())},this.sortColumn=function(){var e=E((function*(e,t){var r,i,o,s,u,l=arguments.length>2&&void 0!==arguments[2]&&arguments[2],d=yield c.attemptToSaveTable();if(d){var p=c.dataSet.sorting.findIndex(t=>t.name===e);if(!(p>=0&&c.dataSet.sorting[p].sortDirection===t)){if(c.sortScenario&&c.sortScenario.completeWithError({newSort:!0}),c.sortScenario=null===(r=c.config.telemetryProvider)||void 0===r?void 0:r.getScenarioTracker(a.telemetryKeys.sortGridData,{sortDirection:t}),l)p>=0?c.dataSet.sorting[p].sortDirection=t:c.dataSet.sorting.push({name:e,sortDirection:t});else{for(;c.dataSet.sorting.pop(););c.dataSet.sorting.push({name:e,sortDirection:t})}c.primarySortedColumnName=e;var f=Object.values(null!==(i=null===(o=c.config.props.userConfiguration)||void 0===o?void 0:o.columns)&&void 0!==i?i:{}).reduce((e,t)=>{var r=c.dataSet.sorting.find(e=>e.name===t.logicalName);return r?r.sortDirection!==t.sorting&&(e[t.logicalName]={config:{sorting:r.sortDirection!==n.SortDirection.None?r.sortDirection:void 0},updatedProps:["sorting"]}):t.sorting!==n.SortDirection.Asc&&t.sorting!==n.SortDirection.Desc||(e[t.logicalName]={config:{sorting:void 0},updatedProps:["sorting"]}),e},{});null===(s=(u=c.config.callbacks).onConfigurationUpdated)||void 0===s||s.call(u,{columns:f}),c.reloadData({hardRefresh:!0})}}}));return function(t,r){return e.apply(this,arguments)}}(),this.cellEditStarted=(e,t)=>{var r;this.editingCell={columnName:e.name,rowId:t[n.RECID]},this.currentRowEditId?this.currentRowEditId!==t[n.RECID]&&(this.rowEditEnded(),this.rowEditStarted(t[n.RECID])):this.rowEditStarted(t[n.RECID]),null===(r=this.editRowScenario)||void 0===r||r.progress({action:"cellEditStarted",column:e.name,dataType:e.dataType})},this.cellEditEnded=(e,t)=>{this.editingCell&&this.editingCell.columnName===e.name&&this.editingCell.rowId===t[n.RECID]&&(this.editingCell=void 0)},this.cellValueChanged=(e,t,r,a)=>{var i;this.editingCell&&this.editingCell.columnName===e.name&&this.editingCell.rowId===t[n.RECID]&&(this.editingCell=void 0),this.updateRecordColumnValueAsync(t[n.RECID],e.name,r),this.config.props.enableRowAdding&&this.lastDummyRow&&t[n.RECID]===this.lastDummyRow.getRecordId()&&this.generateLastDummyRowAsync(!0).then(()=>this.gridCleanupRefresh()),null===(i=this.editRowScenario)||void 0===i||i.progress({action:"cellValueChanged",column:e.name,dataType:e.dataType})},this.onColumnResized=(e,t,r)=>{var n,a;null===(n=(a=this.config.callbacks).onConfigurationUpdated)||void 0===n||n.call(a,{columns:{[e]:{config:{width:t},updatedProps:["width"]}}})},this.onColumnMoved=(e,t,r)=>{var n,a;null===(n=(a=this.config.callbacks).onConfigurationUpdated)||void 0===n||n.call(a,{visibleOrderedColumns:r})},this.onColumnPinned=(e,t,r)=>{var n,o,s;null===(n=(o=this.config.callbacks).onConfigurationUpdated)||void 0===n||n.call(o,{columns:{[e]:{config:{pinned:null===t?void 0:t},updatedProps:["pinned"]}},visibleOrderedColumns:r}),null===(s=this.config.telemetryProvider)||void 0===s||s.sendCustomEvent(a.telemetryKeys.columnPinned,{columnName:e,location:t},i.SeverityLevel.Information)},this.refreshClicked=()=>{this.reloadData({scrollToStart:!0,hardRefresh:!0})},this.deleteSelectedRecords=E((function*(){var e,t=c.selectedRecordIds;if(0!==t.length){var r=null===(e=c.config.telemetryProvider)||void 0===e?void 0:e.getScenarioTracker(a.telemetryKeys.deleteRecords,{selectedRecordIds:t});c.recordsCount.deletedRecords+=t.length,c.recordsCountChanged();var n=t.map(e=>{var t,n=c.getRecordFromCache(e),a=c.recordsOperationsQueue.getRecordQueue(e);return a&&"create"===(null===(t=a.saveOperation)||void 0===t?void 0:t.type)&&!c.recordsOperationsQueue.isOperationInProgress(a.saveOperation)&&(a.saveOperation.isCanceled=!0,null==r||r.progress({canceledCreationFor:e})),n});try{var i,o=c.recordsOperationsQueue.deleteRecordsAsync(c.dataSet,n);null===(i=c.gridApi)||void 0===i||i.deselectAll(),t.forEach(e=>{var t;null===(t=c.gridApi)||void 0===t||t.refreshCells(e,c.columnDefinitions.map(e=>e.name),c.generateRowData(c.getRecordFromCache(e),e))}),yield o,t.forEach(e=>{c.cleanUpNewRecord(e)}),c.gridCleanupRefresh(),null==r||r.complete(void 0)}catch(s){c.gridCleanupRefresh(),null==r||r.failure({error:s})}}})),this.initialLoadEntityScenario=null===(r=t.telemetryProvider)||void 0===r?void 0:r.getScenarioTracker(a.telemetryKeys.loadEntity,{numberOfColumns:e.columns.length,numberOfRecords:e.paging.totalResultCount}),this.initialLoadDataScenario=null===(o=t.telemetryProvider)||void 0===o?void 0:o.getScenarioTracker(a.telemetryKeys.initialFullLoad,{numberOfColumns:e.columns.length,numberOfRecords:e.paging.totalResultCount}),this.columnDefinitions=this.generateColumnDefinitions(this.dataSet),this.relatedDataSetsProvider=new h.RelatedDataSetsProvider(e),this.dataSourceConfig={maxConcurrentDatasourceRequests:1,cacheBlockSize:this.pageSize},e.sortedRecordIds.length&&this.appendDataToTheCache(e),this.recordsOperationsQueue=new f.RecordsOperationsQueue(t),this.recordsOperationsQueue.addNewRecordSavedListener(this.onNewRecordSaved),this.recordsOperationsQueue.onQueueChanged(this.dataSetStateChanged),null!=e&&null!==(u=e.filtering)&&void 0!==u&&u.getFilter()||this.clearAllFilterStates()}updateUserConfiguration(e){this.config.props.userConfiguration=e;var t=this.columnDefinitions;this.columnDefinitions=this.generateColumnDefinitions(this.dataSet),this.columnDefinitions.forEach(e=>{var r,n,a,i=null==t?void 0:t.find(t=>t.name===e.name);!(null!=i&&i.hide)!=!e.hide&&(null===(r=this.gridApi)||void 0===r||r.setColumnVisible(e.name,!e.hide));!i&&this.asyncColumnsEnabled&&(null===(n=(a=this.config.callbacks).onAsyncColumnAdd)||void 0===n||n.call(a,e.name,"Loading"))})}updateCallbacks(e){this.config.callbacks=e}checkCacheForRows(){var e;if(this.params){var t=this.sortedRecordIds.length;if(0!==t||!this.isLoadDataPending){var r=!!this.config.props.totalRecordsLimit&&t>=this.config.props.totalRecordsLimit;if(t>=(null!==(e=this.params.endRow)&&void 0!==e?e:0)||!this.dataSet.paging.hasNextPage||r){var n,a,o,s=this.params,u=()=>{var e,t=this.sortedRecordIds.slice(s.startRow,s.endRow),n={};t.forEach(e=>{n[e]=this.getRecordFromCache(e)});var a=!this.config.props.enableRowAdding||(this.totalRowsCount||0)>=(null!==(e=s.endRow)&&void 0!==e?e:0);null==s||s.successCallback(this.generateRowsData(n,t,a),r||!this.dataSet.paging.hasNextPage?this.sortedRecordIds.length:-1)};if(this.config.props.enableRowAdding&&!this.dataSet.paging.hasNextPage?this.generateLastDummyRowAsync().then(u):u(),this.initialLoadDataScenario)this.initialLoadDataScenario.complete({numberOfColumns:this.columnDefinitions.length,currentNumberOfRecords:this.sortedRecordIds.length,totalNumberOfRecords:this.dataSet.paging.totalResultCount,hasNextPage:this.dataSet.paging.hasNextPage}),this.initialLoadDataScenario=void 0,null===(a=(o=this.config.callbacks).onInitialLoad)||void 0===a||a.call(o,i.GridInitialLoadState.DataLoaded);null===(n=this.getDataScenario)||void 0===n||n.complete({startRowRequest:this.params.startRow,endRowRequest:this.params.endRow,numberOfColumns:this.columnDefinitions.length,currentNumberOfRecords:this.sortedRecordIds.length,totalNumberOfRecords:this.dataSet.paging.totalResultCount,hasNextPage:this.dataSet.paging.hasNextPage}),this.resetParams(!1),this.getDataScenario=void 0}else{var c;null===(c=this.getDataScenario)||void 0===c||c.progress({currentNumberOfRecords:this.sortedRecordIds.length}),this.dataSet.paging.loadNextPage(!0)}}}}dataSetUpdated(e,t,r,n){var o,s;(this.dataSet=e,r&&this.reloadData({hardRefresh:!0}),-1!==t.indexOf(u.DataSetUpdatePropertyNames.Columns))&&(this.relatedDataSetsProvider.updateDataSet(e),n&&-1===t.indexOf(u.DataSetUpdatePropertyNames.Records)?(this.columnDefinitions=this.generateColumnDefinitions(e),this.updateAsyncColumns(n),null===(o=(s=this.config.callbacks).onAsyncColumnAdd)||void 0===o||o.call(s,n,"Loaded")):this.asyncColumnsEnabled||this.resetDummyRow());if(t.some(e=>[u.DataSetUpdatePropertyNames.Columns,u.DataSetUpdatePropertyNames.Filter,u.DataSetUpdatePropertyNames.SortOrder].indexOf(e)>=0)||this.dataSet.error){var c,l;if(t.includes(u.DataSetUpdatePropertyNames.Filter))null===(c=this.filterScenario)||void 0===c||c.complete(void 0),this.filterScenario=void 0;if(t.includes(u.DataSetUpdatePropertyNames.SortOrder))null===(l=this.sortScenario)||void 0===l||l.complete(void 0),this.sortScenario=void 0}if(this.dataSet.error){var d,p,f,h,m,y,v;if(this.recordsCount.dataSetTotalRecordsCount=void 0,this.recordsCountChanged(),this.params)null===(h=this.config.telemetryProvider)||void 0===h||h.sendErrorEvent(a.telemetryKeys.dataSetError,{error:this.dataSet.errorMessage,endRowCount:this.params.endRow,cacheSize:this.sortedRecordIds.length},new Error(this.dataSet.errorMessage)),this.dataSet.sortedRecordIds.length>0?this.params.failCallback():this.params.successCallback([],0);if(this.initialLoadDataScenario)null===(m=this.initialLoadDataScenario)||void 0===m||m.failure({numberOfColumns:this.columnDefinitions.length,currentNumberOfRecords:this.sortedRecordIds.length,totalNumberOfRecords:this.dataSet.paging.totalResultCount,hasNextPage:this.dataSet.paging.hasNextPage},new Error(this.dataSet.errorMessage)),this.initialLoadDataScenario=void 0,null===(y=(v=this.config.callbacks).onInitialLoad)||void 0===y||y.call(v,i.GridInitialLoadState.DataLoadFailed);null===(d=this.getDataScenario)||void 0===d||d.failure({startRowRequest:null===(p=this.params)||void 0===p?void 0:p.startRow,endRowRequest:null===(f=this.params)||void 0===f?void 0:f.endRow,numberOfColumns:this.columnDefinitions.length,currentNumberOfRecords:this.sortedRecordIds.length,totalNumberOfRecords:this.dataSet.paging.totalResultCount,hasNextPage:this.dataSet.paging.hasNextPage},new Error(this.dataSet.errorMessage)),this.getDataScenario=void 0}else!this.isLoadDataPending&&t.includes(u.DataSetUpdatePropertyNames.Records)&&(void 0===this.recordsCount.dataSetTotalRecordsCount&&(this.recordsCount.dataSetTotalRecordsCount=this.dataSet.paging.totalResultCount,this.recordsCountChanged()),0===this.sortedRecordIds.length&&(this.recordsCache={}),this.appendDataToTheCache(this.dataSet),this.params&&this.checkCacheForRows());this.dataSetStateChanged()}updateAsyncColumns(e){this.sortedRecordIds.forEach(t=>{var r=this.getRecordFromCache(t);if(r){var n,a=this.recordsOperationsQueue.getRecordQueue(t);if(null!=a&&a.deleteOperation||null!=a&&a.saveOperation&&a.saveOperation.changes.length>0)return;var i=this.generateRowData(r,t);null===(n=this.gridApi)||void 0===n||n.refreshCells(t,[e],i)}}),this.gridCleanupRefresh()}getAllRecordIds(){return this.sortedRecordIds.filter(e=>!this.tempRecords[e])}onProcessDataFromClipboard(e){return f.RecordsOperationsQueue.processDataFromClipboard(e)}getSelectedRecordIds(){return this.selectedRecordIds}insertRecordAsync(e){var t=this;return E((function*(){var r=0;switch(e){case"add":r=t.currentRowIndex;break;case"insertBelow":r=t.selectedRecordIds.length>0?t.sortedRecordIds.indexOf(t.selectedRecordIds[0])+1:0;break;case"insertAbove":r=t.selectedRecordIds.length>0?t.sortedRecordIds.indexOf(t.selectedRecordIds[0]):0}r<0&&(r=0),t.rowInsertStarted(r,e);try{var n,a,i,o=yield t.createNewRecordAsync(r);t.recordsCount.addedRecords++,t.recordsCountChanged(),t.rowInsertGeneratedId(o.getRecordId());var s=t.findFirstEditableColumn();null===(n=t.gridApi)||void 0===n||n.deselectAll(),null===(a=t.gridApi)||void 0===a||a.setRowSelection([o.getRecordId()],!0),t.gridCleanupRefresh(),null===(i=t.gridApi)||void 0===i||i.scrollIntoView({rowIndex:r,columnName:s}),t.requestRowEditing(o.getRecordId(),s)}catch(u){t.rowInsertFailed(u)}}))()}createNewRecordAsync(e){var t=this;return E((function*(){var r=yield t.dataSet.newRecord();t.recordsOperationsQueue.registerNewRecord(r);var n=r.getNamedReference().id.guid;return t.tempRecords[n]=r,t.recordsCache[n]=r,t.sortedRecordIds.splice(e,0,n),r}))()}resetDummyRow(){this.lastDummyRow=void 0,this.lastDummyRowPromise=void 0}generateLastDummyRowAsync(){var e=arguments,t=this;return E((function*(){var r=!(e.length>1&&void 0!==e[1])||e[1];if(e.length>0&&void 0!==e[0]&&e[0]&&t.resetDummyRow(),!t.lastDummyRowPromise){t.lastDummyRowPromise=t.createNewRecordAsync(t.sortedRecordIds.length);try{t.lastDummyRow=yield t.lastDummyRowPromise,r&&(t.recordsCount.addedRecords++,t.recordsCountChanged())}catch(n){return t.resetDummyRow(),Promise.reject()}}return t.lastDummyRowPromise}))()}requestRowEditing(e,t){this.pendingRowToEdit.id!==e&&this.pendingRowToEdit.timerId&&clearTimeout(this.pendingRowToEdit.timerId);this.pendingRowToEdit.id=e;var r=n=>{var a,i=null===(a=this.gridApi)||void 0===a?void 0:a.startCellEditing(e,t);!i&&n<30?(n++,this.pendingRowToEdit.timerId=setTimeout(r,100,n)):(this.rowInsertEnded(!!i,i?void 0:"Reached max attempts to try to enable editing a row"),this.pendingRowToEdit.id=void 0,this.pendingRowToEdit.timerId=void 0)};r(0)}clearAllFilterStates(){this.dataSet.columns.forEach(e=>{var t,r,n=this.columnDefinitions.find(t=>t.name===e.name);n&&(n.filterExpression=void 0),null===(t=(r=this.config.callbacks).onConfigurationUpdated)||void 0===t||t.call(r,{columns:{[e.name]:{config:{filter:void 0},updatedProps:["filter"]}}})})}getColumnAttributeMetadata(e){var t;return null===(t=this.dataSet.columns.find(t=>t.name===e))||void 0===t?void 0:t.attributes}findFirstEditableColumn(){var e,t=this.columns.find(e=>"left"===e.pinned&&e.editable);return t||(t=this.columns.find(e=>e.editable)),null===(e=t)||void 0===e?void 0:e.name}getRecordFromCache(e){var t;return null!==(t=this.recordsCache[e])&&void 0!==t?t:this.tempRecords[e]}generateRowData(e,t){var r=this,a=this.dataSet.columns,i={[n.RECID]:t,params:{navigation:{},cellImageInfo:{}}},o=this.recordsOperationsQueue.getRecordQueue(t),s=function(t){var n,a;if(r.recordsOperationsQueue.isOperationInProgress(null==o?void 0:o.deleteOperation)||r.isColumnInLoadingState(t))return i[t.name]=void 0,"continue";if(i[t.name]=e.getValue(t.name),null!==(n=i.params)&&void 0!==n&&n.navigation){var s=i[t.name];s&&(i.params.navigation[t.name]=()=>r.dataSet.openDatasetItem(s))}null!==(a=i.params)&&void 0!==a&&a.cellImageInfo&&r.dataSet.getDataSetCapabilities().hasCellImageInfo&&(i.params.cellImageInfo[t.name]=()=>e.getCellImageInfo?e.getCellImageInfo(t.name,r.config.languageId):Promise.resolve(null))};for(var u of a)s(u);if(o){var d;if(o.error)i[n.ROW_STATUS]=v(v({},i[n.ROW_STATUS]),{},{error:Object(c.dataSetErrorToError)(o.error)});else if(o.saveOperation&&null!==(d=o.saveOperation)&&void 0!==d&&d.changes){var p=o.saveOperation.changes.filter(e=>e.error);p.length>0&&this.config.props.localizedStrings&&(i[n.ROW_STATUS]=i[n.ROW_STATUS]||{},i[n.ROW_STATUS].error=new Error(Object(l.pluralizeString)(this.config.props.localizedStrings.errors.rowErrors_plural,p.length)))}i.params.isSaving=!!o.saveOperation&&!!o.saveOperation.result&&void 0===o.saveOperation.success}return i}generateRowsData(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=this.dataSet.columns,i=[];if(a)for(var o=this.generateLastDummyRow(a),s=0;s<t.length;s++){var u=t[s];if(!r&&this.lastDummyRow&&s===t.length-1)o[n.RECID]=u,i.push(o);else{var c=e[u];c&&i.push(this.generateRowData(c,u))}}return i}generateLastDummyRow(e){var t={[n.RECID]:"",params:{navigation:{},cellImageInfo:{},isLastRow:!0}};for(var r of e)t[r.name]=null;return t}_getOnNavigationFunction(e){return(t,r)=>{null==r||r.preventDefault(),this._onNavigation(e,t)}}_onNavigation(e,t){if(e.isPrimary){var r,a=null===(r=this.dataSet.records)||void 0===r?void 0:r[null==t?void 0:t[n.RECID]];this.dataSet.openDatasetItem(null==a?void 0:a.getNamedReference())}else{var i,o,s;null===(i=t.params)||void 0===i||null===(o=i.navigation)||void 0===o||null===(s=o[e.name])||void 0===s||s.call(o)}}generateColumnDefinition(e){var t,r,a,i,s=null===(t=this.config.props.userConfiguration)||void 0===t||null===(r=t.columns)||void 0===r?void 0:r[e.name],u=e.attributes,c=Object(o.getDataTypeMap)(u),l=Object(o.getPlaceHolders)(c,this.config.props.localizedStrings),p=this.isColumnInLoadingState(e),f=this.hasError||p,h=this.dataSet.getDataSetCapabilities().hasRecordNavigation&&(!!e.isPrimary||this.config.props.enableLookupNavigation&&c.toLowerCase()===d.AttributeType.Lookup),m=u.HideHeaderMenu?{hideColumnHeaderMenuIcon:!0}:{hideColumnHeaderMenuIcon:!1,hideMenuItem:!this.canHideColumn(e)||f?"hide":"show",deleteMenuItem:e.isPrimary||f||!1===u.IsMetadataEditable?"hide":"show",filterMenuItem:f||u.DisableFilter||!1===this.config.props.enableFiltering?"disable":"show",moveMenuItem:f||u.HideMove?"hide":"show",pinMenuItem:f||u.HidePin?"hide":"show",sortMenuItem:f||u.DisableSort||e.disableSorting?"disable":"show",editMenuItem:Object(o.isEditMetadataSupported)(u,f)?"show":"hide",insertMenuItem:this.config.props.enableColumnAdding?"show":"hide"};return v({name:e.name,displayName:e.displayName,isPrimary:!!e.isPrimary,dataType:c,CustomRendererType:u.CustomRendererType,width:null!==(a=null==s?void 0:s.width)&&void 0!==a?a:Object(o.getColumnWidthFromDataType)(c),pinned:null==s?void 0:s.pinned,editable:!f&&u.IsEditable&&u.IsReadable,noAccess:!u.IsReadable,sortDirection:null!==(i=null==s?void 0:s.sorting)&&void 0!==i?i:n.SortDirection.None,customizerParams:this.getCustomizerParams(e,c),getFormattedValue:t=>{var r=this.getRecordFromCache(t);if(r){var n;if(null!==(n=this.config)&&void 0!==n&&n.formatter){var a=this.getControlAttributes(e);return this.config.formatter.formatUserInput(r.getValue(e.name),a)}return r.getFormattedValue(e.name)}return""},filterExpression:null==s?void 0:s.filter,hide:!!e.isHidden,showHeaderIcon:!0,onDelete:()=>{var t,r;return null===(t=(r=this.config.callbacks).onDeleteColumn)||void 0===t?void 0:t.call(r,e.name)},onHide:()=>{var t,r;return null===(t=(r=this.config.callbacks).onHideColumn)||void 0===t?void 0:t.call(r,e.name)},onNavigation:h?this._getOnNavigationFunction(e):void 0,defaultPlaceHolder:l,isRequired:this.isRequiredColumn(u.RequiredLevel),supportedFilterOperators:u.SupportedFilterOperators},m)}generateColumnDefinitions(e){var t,r=[];if(null!==(t=e.columns)&&void 0!==t&&t.length){var n,a=[];for(var i of e.columns){var o=this.generateColumnDefinition(i);a.push(o),i.isPrimary&&(this.primaryColumnDefinition=o)}var s=null===(n=this.config.props.userConfiguration)||void 0===n?void 0:n.visibleOrderedColumns;if(s){var u=function(e){var t=a.find(t=>t.name===e);t&&r.push(t)};for(var c of s)u(c)}else r=a;if(a.length!==r.length)for(var l of a)r.includes(l)||r.push(l)}return r}saveTable(){var e=this;return E((function*(){e.editingCell&&(yield e.stopEditingAsync());var t=e.rowEditEnded();if(t)try{yield t}catch(r){}yield e.recordsOperationsQueue.processAllOperations(e.dataSet)}))()}attemptToSaveTable(){var e=this;return E((function*(){var t,r;if(e.recordsSaved&&!e.editingCell)return!0;null===(t=(r=e.config.callbacks).onSaveStarted)||void 0===t||t.call(r),yield e.saveTable();try{var n,a;return yield null===(n=(a=e.config.callbacks).onSaveFinished)||void 0===n?void 0:n.call(a,!e.recordsSaved),!0}catch(i){return!1}}))()}get recordsSaved(){var e=this.getDataSetState();return 0===e.deletingRecordsCount&&0===e.dirtyRecordsCount&&0===e.recordsInErrorStateCount&&0===e.savingRecordsCount}stopEditingAsync(){var e=this;return E((function*(){var t;return null===(t=e.gridApi)||void 0===t||t.stopCellEditing(),new Promise(t=>{var r=n=>{n<10&&e.editingCell?(n++,setTimeout(r,100,n)):t()};r(0)})}))()}rowInsertStarted(e,t){var r;this.insertRowScenario&&this.rowInsertEnded(!1,"Another row insert initiated, aborting editing current row"),this.insertRowScenario=null===(r=this.config.telemetryProvider)||void 0===r?void 0:r.getScenarioTracker(a.telemetryKeys.addRow,{action:t,rowIndex:e})}rowInsertGeneratedId(e){var t;null===(t=this.insertRowScenario)||void 0===t||t.progress({recordId:e})}rowInsertEnded(e,t){var r;null===(r=this.insertRowScenario)||void 0===r||r.complete({editStarted:e,message:t})}rowInsertFailed(e){var t;null===(t=this.insertRowScenario)||void 0===t||t.failure({error:e})}rowEditStarted(e){var t;this.editRowScenario&&this.editRowScenario.failure(void 0,new Error("Row edit scenario did not reset")),this.editRowScenario=null===(t=this.config.telemetryProvider)||void 0===t?void 0:t.getScenarioTracker(a.telemetryKeys.editRow,{recordId:e}),this.currentRowEditId=e}rowEditEnded(){var e,t;return this.currentRowEditId&&(t=this.saveRecordAsync(this.currentRowEditId,this.getRecordFromCache(this.currentRowEditId))),null===(e=this.editRowScenario)||void 0===e||e.complete(void 0),this.currentRowEditId=void 0,this.editRowScenario=void 0,t}updateRecordColumnValueAsync(e,t,r){var o=this;return E((function*(){var s,u=o.getRecordFromCache(e);if(u){try{var c;null===(c=o.editRowScenario)||void 0===c||c.progress({message:"Set Value",columnName:t}),yield o.recordsOperationsQueue.setValue(u,t,r).result}catch(d){var l;null===(l=o.config.telemetryProvider)||void 0===l||l.sendCustomEvent(a.telemetryKeys.setFieldValueError,{recordId:e,columnName:t,error:d},i.SeverityLevel.Warning)}null===(s=o.gridApi)||void 0===s||s.refreshCells(e,[t,n.ROW_STATUS],o.generateRowData(u,e))}}))()}saveRecordAsync(e,t){var r=this;return E((function*(){var i,o=-1!==r.recordsOperationsQueue.getNewUnsavedRecords().indexOf(e),s=null===(i=r.config.telemetryProvider)||void 0===i?void 0:i.getScenarioTracker(a.telemetryKeys.saveRecord,{recordId:e,isNew:o}),u=v({},t);try{var l,d,p=r.dataSet.columns.filter(e=>!e.isHidden),f=Object(c.getRecordFieldsValues)(t,p),h=r.recordsOperationsQueue.save(u);if(yield null==h?void 0:h.result,null!=h&&h.validationErrors&&(null==h||null===(l=h.validationErrors)||void 0===l?void 0:l.length)>0)throw new Error("We did not attempt to save the record as it has validation errors");var m=Object(c.getRecordFieldsValues)(u,p),y=[n.ROW_STATUS,...Object(c.compareRecords)(p,f,m)];null===(d=r.gridApi)||void 0===d||d.refreshCells(e,y,r.generateRowData(u,e)),null==s||s.complete({changedColumns:y,recordId:e})}catch(O){var g;null===(g=r.gridApi)||void 0===g||g.refreshCells(e,[n.ROW_STATUS],r.generateRowData(u,e)),null==s||s.failure({id:e},O)}}))()}getColumnInfoAsync(e,t){var r=this;return E((function*(){if(r.getRecordFromCache(e))return r.getRecordFromCache(e).getColumnInfo(t);var n;null===(n=r.config.telemetryProvider)||void 0===n||n.sendErrorEvent(a.telemetryKeys.gridCacheError,{recordId:e},new Error("Received getColumnInfoAsync for record that is not in the cache"));var i=r.getColumnAttributeMetadata(t);return{error:!1,errorMessage:"",security:{editable:i.IsEditable,readable:i.IsReadable,secured:i.IsSecured},type:i.Type}}))()}getControlAttributes(e){switch(e.dataType){case d.AttributeType.Date:case d.AttributeType.DateTime:return{Type:e.dataType,Behavior:e.attributes.Behavior,Format:e.attributes.Format};case d.AttributeType.Decimal:case d.AttributeType.Double:case d.AttributeType.Money:return{Type:e.dataType,Precision:e.attributes.Precision};case d.AttributeType.Integer:return{Type:e.dataType,Format:e.attributes.Format};case d.AttributeType.PickList:case d.AttributeType.Boolean:case d.AttributeType.MultiSelectPickList:return{Type:e.dataType,OptionSet:e.attributes.Options};default:return{Type:e.dataType}}}getCustomizerParamsFormattedValue(e){var t=e.name,r=this.getControlAttributes(e);return(e,n)=>{var a,i;return null!==(a=this.config)&&void 0!==a&&a.formatter?this.config.formatter.formatUserInput(n,r):null===(i=this.getRecordFromCache(e))||void 0===i?void 0:i.getFormattedValue(t,n)}}getCustomizerParamsValidationError(e){var t=this;return function(){var r=E((function*(r){try{if(t.getRecordFromCache(r)){var n=t.recordsOperationsQueue.getRecordSetValue(t.getRecordFromCache(r),e.name);yield n}return null}catch(a){return Object(c.dataSetErrorToError)(a)}}));return function(e){return r.apply(this,arguments)}}()}getCustomizerParamsCellAttributes(e){var t=this,r=e.name;return function(){var e=E((function*(e){var n,a,i=yield t.getColumnInfoAsync(e,r),o={secured:null===(n=i.security)||void 0===n?void 0:n.secured,editable:null===(a=i.security)||void 0===a?void 0:a.editable};return Promise.resolve(o)}));return function(t){return e.apply(this,arguments)}}()}getCustomizerParams(e,t){var r,n,a,i={getFormattedValue:this.getCustomizerParamsFormattedValue(e),getValidationError:this.getCustomizerParamsValidationError(e),getCellAttributes:this.getCustomizerParamsCellAttributes(e)};switch(t){case"OptionSet":case"MultiSelectPicklist":var o=e.attributes,s=null==o?void 0:o.Options.map(e=>({key:e.Value.toString(),text:e.Label,data:{color:e.Color}}));return v({dropDownOptions:o.RequiredLevel===u.RequiredLevel.SystemRequired||o.RequiredLevel===u.RequiredLevel.ApplicationRequired||"MultiSelectPicklist"===t?s:[{key:void 0,text:"",data:{color:""}},...s]},i);case"TwoOptions":var c=e.attributes;return v({labels:{onText:(null==c||null===(r=c.Options.find(e=>1===e.Value))||void 0===r?void 0:r.Label)||"",offText:(null==c||null===(n=c.Options.find(e=>0===e.Value))||void 0===n?void 0:n.Label)||""},defaultValue:c.DefaultValue},i);case"Lookup":case"Owner":return v({targets:null===(a=this.getColumnAttributeMetadata(e.name))||void 0===a?void 0:a.Targets,getLookupColumns:()=>{var t=this.relatedDataSetsProvider.getProvider(e);return null==t?void 0:t.generateColumnDefinitions()},getLookupRows:t=>{var r=this.relatedDataSetsProvider.getProvider(e);return(null==r?void 0:r.loadData(t))||Promise.resolve([])}},i);case"DateOnly":case"DateAndTime":var l=e.attributes.Behavior,d=l===m.DateTimeFieldBehavior.TimeZoneIndependent||l===m.DateTimeFieldBehavior.DateOnly,p=this.getControlAttributes(e);return v({timeZoneIndependent:d,formatUTCDateTimeToUserDate:e=>{if(this.config.formatter)return this.config.formatter.formatUTCDateTimeToUserDate(e,l);var t=new Date(Date.parse(e));return d&&t.setTime(t.getTime()+6e4*t.getTimezoneOffset()),t},parseDateFromInput:e=>{if(this.config.formatter)return this.config.formatter.parseDateFromInput(e,p);var t=Date.parse(e);return isNaN(t)?void 0:new Date(t)}},i);case"TimeZone":return v({timeZoneByCode:e.attributes.TimeZoneByCode},i);case"Language":return v({languageByCode:e.attributes.LanguageByCode},i);default:return i}}reloadData(){var e,t,r,n,{scrollToStart:i,hardRefresh:o}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(this.currentRowEditId&&this.rowEditEnded(),this.initialLoadEntityScenario=null===(e=this.config.telemetryProvider)||void 0===e?void 0:e.getScenarioTracker(a.telemetryKeys.pageRefresh,void 0),null===(t=this.gridApi)||void 0===t||t.deselectAll(),i)&&(null===(n=this.gridApi)||void 0===n||n.scrollIntoView({rowIndex:0}));this.sortedRecordIds=[],this.tempRecords={},this.resetDummyRow(),this.resetParams(null!=o&&o),this.dataSet.paging.loadExactPage(1),this.recordsOperationsQueue.reset(),this.gridCleanupRefresh({hardRefresh:o}),null===(r=this.getDataScenario)||void 0===r||r.completeWithError(void 0,new Error("Refresh Data was called")),this.recordsCount.dataSetTotalRecordsCount=void 0,this.recordsCount.addedRecords=0,this.recordsCount.deletedRecords=0,this.recordsCountChanged(),this.dataSetStateChanged()}appendDataToTheCache(e){this.recordsCache=v(v({},e.records),this.recordsCache),e.sortedRecordIds.forEach(e=>{-1===this.sortedRecordIds.indexOf(e)&&this.sortedRecordIds.push(e)})}gridCleanupRefresh(){var e,t,{hardRefresh:r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(this.cleanupRecordsFromCache(),r)?null===(e=this.gridApi)||void 0===e||e.reloadData():null===(t=this.gridApi)||void 0===t||t.refreshData()}cleanupRecordsFromCache(){this.recordsToBeCleanedFromCacheOnRefresh.forEach(e=>{delete this.recordsCache[e];var t=this.sortedRecordIds.findIndex(t=>t===e);-1!==t&&this.sortedRecordIds.splice(t,1)}),this.recordsToBeCleanedFromCacheOnRefresh=[]}recordsCountChanged(){this.config.callbacks.recordsCountChanged(this.totalRowsCount)}cleanUpNewRecord(e){var t=this.sortedRecordIds.indexOf(e);if(-1===t&&this.recordsCache.hasOwnProperty(e)){var r=this.recordsCache[e].getRecordId();t=this.sortedRecordIds.indexOf(r),delete this.recordsCache[r]}else this.tempRecords[e]&&delete this.tempRecords[e];-1!==t&&this.sortedRecordIds.splice(t,1),delete this.recordsCache[e]}isColumnInLoadingState(e){return-1===e.visualSizeFactor}canHideColumn(e){var t=e.attributes;return!e.isPrimary&&!t.HideChangeVisibility&&(!this.isRequiredColumn(t.RequiredLevel)||"ownerid"===e.name)}isRequiredColumn(e){return e===u.RequiredLevel.SystemRequired||e===u.RequiredLevel.ApplicationRequired}}},8988:function(e,t,r){"use strict";r.r(t),r.d(t,"getDataTypeMap",(function(){return o})),r.d(t,"getPlaceHolders",(function(){return s})),r.d(t,"isEditMetadataSupported",(function(){return u})),r.d(t,"getColumnWidthFromDataType",(function(){return c}));var n,a=r(8989),i=r(8990);function o(e){switch(e.Type){case a.AttributeType.BigInt:case a.AttributeType.Decimal:return"Decimal";case a.AttributeType.Double:return"FloatingPoint";case a.AttributeType.Boolean:return"TwoOptions";case a.AttributeType.Customer:return"Lookup";case a.AttributeType.Date:case a.AttributeType.DateTime:switch(null==e?void 0:e.Format){case"DateOnly":case i.DateFormat.dateonly:return"DateOnly";case"DateAndTime":case i.DateFormat.dateandtime:return"DateAndTime";default:return"DateOnly"}case a.AttributeType.File:return"File";case a.AttributeType.Image:return"Image";case a.AttributeType.Integer:switch(null==e?void 0:e.Format){case"Duration":case i.Format.duration:case n.DURATION:return"Duration";case"Language":case i.Format.language:case n.LANGUAGE:return"Language";case"TimeZone":case i.Format.timeZone:case n.TIMEZONE:return"TimeZone";case"Locale":case"None":case n.NONE:default:return"Integer"}case a.AttributeType.Lookup:return"Lookup";case a.AttributeType.Memo:return"TextArea";case a.AttributeType.Money:return"Currency";case a.AttributeType.MultiSelectPickList:return"MultiSelectPicklist";case a.AttributeType.Owner:return"Owner";case a.AttributeType.PartyList:return"Text";case a.AttributeType.PickList:case a.AttributeType.State:case a.AttributeType.Status:return"OptionSet";case a.AttributeType.String:switch(null==e?void 0:e.Format){case"Email":return"Email";case"Phone":return"Phone";case"TextArea":return"TextArea";case"TickerSymbol":return"Ticker";case"Url":return"URL";case"PhoneticGuide":case"VersionNumber":default:return"Text"}case a.AttributeType.CalendarRules:case a.AttributeType.EntityName:case a.AttributeType.ManagedProperty:case a.AttributeType.UniqueIdentifier:case a.AttributeType.Virtual:default:return"Text"}}function s(e,t){var r=null==t?void 0:t.placeHolders;if(r)switch(e){case"Text":case"Ticker":case"TextArea":return r.text;case"Email":return r.email;case"Phone":return r.phone;case"URL":return r.url;case"Lookup":case"Customer":case"MultiSelectPicklist":return r.lookup;case"OptionSet":return r.optionSet;case"Duration":case"Currency":case"Integer":return r.number;case"Decimal":return r.decimal;case"FloatingPoint":return r.floatingNumber;case"DateOnly":case"DateAndTime":return r.dateTime;case"Image":return r.media;case"File":return r.file;case"Language":case"TimeZone":default:return}}function u(e,t){if(t||!1===e.IsMetadataEditable)return!1;switch(e.Type){case a.AttributeType.CalendarRules:case a.AttributeType.Customer:case a.AttributeType.EntityName:case a.AttributeType.File:case a.AttributeType.Image:case a.AttributeType.ManagedProperty:case a.AttributeType.Memo:case a.AttributeType.Money:case a.AttributeType.MultiSelectPickList:case a.AttributeType.PartyList:case a.AttributeType.State:case a.AttributeType.Status:case a.AttributeType.UniqueIdentifier:case a.AttributeType.Virtual:case a.AttributeType.Owner:return!1;case a.AttributeType.Date:case a.AttributeType.DateTime:switch(null==e?void 0:e.Format){case"DateAndTime":return!1;default:return!0}case a.AttributeType.Integer:switch(null==e?void 0:e.Format){case"Duration":case"Language":case"TimeZone":case"Locale":return!1;case"None":default:return!0}case a.AttributeType.String:switch(null==e?void 0:e.Format){case"PhoneticGuide":case"TextArea":case"TickerSymbol":case"VersionNumber":return!1;case"Email":case"Phone":case"Url":default:return!0}default:return!0}}function c(e){switch(e){case"Integer":case"Currency":case"Decimal":case"FloatingPoint":case"OptionSet":case"DateOnly":case"MultiSelectPicklist":case"Phone":case"TwoOptions":case"AutoNumber":return 144;case"DateAndTime":case"TextArea":case"Image":case"URL":case"Text":case"Lookup":case"File":case"Email":case"Ticker":case"Customer":case"Duration":case"Language":case"TimeZone":case"Owner":default:return 250}}!function(e){e.NONE="0",e.DURATION="1",e.TIMEZONE="2",e.LANGUAGE="3"}(n||(n={}))},8989:function(e,t,r){"use strict";var n;r.r(t),r.d(t,"AttributeType",(function(){return n})),function(e){e.Boolean="boolean",e.Unknown="unknown",e.Customer="customer",e.Date="date",e.DateTime="datetime",e.Decimal="decimal",e.Double="double",e.Image="image",e.Integer="integer",e.Lookup="lookup",e.ManagedProperty="managedproperty",e.Memo="memo",e.Money="money",e.Owner="owner",e.PartyList="partylist",e.PickList="picklist",e.State="state",e.Status="status",e.String="string",e.UniqueIdentifier="uniqueidentifier",e.CalendarRules="calendarrules",e.Virtual="virtual",e.BigInt="bigint",e.EntityName="entityname",e.EntityImage="entityimage",e.AliasedValue="aliasedvalue",e.Regarding="regarding",e.MultiSelectPickList="multiselectpicklist",e.File="file",e.NavigationProperty="navigationproperty"}(n||(n={}))},8990:function(e,t,r){"use strict";r.r(t);var n=r(8991);r.d(t,"ColumnSortDirection",(function(){return n.ColumnSortDirection})),r.d(t,"ConditionOperator",(function(){return n.ConditionOperator})),r.d(t,"DataSetUpdatePropertyNames",(function(){return n.DataSetUpdatePropertyNames})),r.d(t,"FilterOperator",(function(){return n.FilterOperator})),r.d(t,"RequiredLevel",(function(){return n.RequiredLevel}));var a=r(8992);r.d(t,"DateFormat",(function(){return a.DateFormat})),r.d(t,"Format",(function(){return a.Format}))},8991:function(e,t,r){"use strict";var n,a,i,o,s;r.r(t),r.d(t,"DataSetUpdatePropertyNames",(function(){return n})),r.d(t,"RequiredLevel",(function(){return a})),r.d(t,"ConditionOperator",(function(){return i})),r.d(t,"FilterOperator",(function(){return o})),r.d(t,"ColumnSortDirection",(function(){return s})),function(e){e.Records="records",e.Columns="columns",e.Page="page",e.Filter="filter",e.SortOrder="sortorder"}(n||(n={})),function(e){e[e.None=0]="None",e[e.SystemRequired=1]="SystemRequired",e[e.ApplicationRequired=2]="ApplicationRequired",e[e.Recommended=3]="Recommended"}(a||(a={})),function(e){e[e.None=-1]="None",e[e.Equal=0]="Equal",e[e.NotEqual=1]="NotEqual",e[e.GreaterThan=2]="GreaterThan",e[e.LessThan=3]="LessThan",e[e.GreaterEqual=4]="GreaterEqual",e[e.LessEqual=5]="LessEqual",e[e.Like=6]="Like",e[e.NotLike=7]="NotLike",e[e.In=8]="In",e[e.NotIn=9]="NotIn",e[e.Between=10]="Between",e[e.NotBetween=11]="NotBetween",e[e.Null=12]="Null",e[e.NotNull=13]="NotNull",e[e.Yesterday=14]="Yesterday",e[e.Today=15]="Today",e[e.Tomorrow=16]="Tomorrow",e[e.Last7Days=17]="Last7Days",e[e.Next7Days=18]="Next7Days",e[e.LastWeek=19]="LastWeek",e[e.ThisWeek=20]="ThisWeek",e[e.NextWeek=21]="NextWeek",e[e.LastMonth=22]="LastMonth",e[e.ThisMonth=23]="ThisMonth",e[e.NextMonth=24]="NextMonth",e[e.On=25]="On",e[e.OnOrBefore=26]="OnOrBefore",e[e.OnOrAfter=27]="OnOrAfter",e[e.LastYear=28]="LastYear",e[e.ThisYear=29]="ThisYear",e[e.NextYear=30]="NextYear",e[e.LastXHours=31]="LastXHours",e[e.NextXHours=32]="NextXHours",e[e.LastXDays=33]="LastXDays",e[e.NextXDays=34]="NextXDays",e[e.LastXWeeks=35]="LastXWeeks",e[e.NextXWeeks=36]="NextXWeeks",e[e.LastXMonths=37]="LastXMonths",e[e.NextXMonths=38]="NextXMonths",e[e.LastXYears=39]="LastXYears",e[e.NextXYears=40]="NextXYears",e[e.EqualUserId=41]="EqualUserId",e[e.NotEqualUserId=42]="NotEqualUserId",e[e.EqualBusinessId=43]="EqualBusinessId",e[e.NotEqualBusinessId=44]="NotEqualBusinessId",e[e.Contains=49]="Contains",e[e.EqualUserLanguage=51]="EqualUserLanguage",e[e.OlderThanXMonths=53]="OlderThanXMonths",e[e.BeginsWith=54]="BeginsWith",e[e.DoesNotBeginWith=55]="DoesNotBeginWith",e[e.EndsWith=56]="EndsWith",e[e.DoesNotEndWith=57]="DoesNotEndWith",e[e.ThisFiscalYear=58]="ThisFiscalYear",e[e.ThisFiscalPeriod=59]="ThisFiscalPeriod",e[e.NextFiscalYear=60]="NextFiscalYear",e[e.NextFiscalPeriod=61]="NextFiscalPeriod",e[e.LastFiscalYear=62]="LastFiscalYear",e[e.LastFiscalPeriod=63]="LastFiscalPeriod",e[e.LastXFiscalYears=64]="LastXFiscalYears",e[e.LastXFiscalPeriods=65]="LastXFiscalPeriods",e[e.NextXFiscalYears=66]="NextXFiscalYears",e[e.NextXFiscalPeriods=67]="NextXFiscalPeriods",e[e.InFiscalYear=68]="InFiscalYear",e[e.InFiscalPeriod=69]="InFiscalPeriod",e[e.InFiscalPeriodAndYear=70]="InFiscalPeriodAndYear",e[e.InOrBeforeFiscalPeriodAndYear=71]="InOrBeforeFiscalPeriodAndYear",e[e.InOrAfterFiscalPeriodAndYear=72]="InOrAfterFiscalPeriodAndYear",e[e.EqualUserTeams=73]="EqualUserTeams",e[e.EqualUserOrUserTeams=74]="EqualUserOrUserTeams",e[e.Above=75]="Above",e[e.Under=76]="Under",e[e.NotUnder=77]="NotUnder",e[e.AboveOrEqual=78]="AboveOrEqual",e[e.UnderOrEqual=79]="UnderOrEqual",e[e.EqualUserOrUserHierarchy=80]="EqualUserOrUserHierarchy",e[e.EqualUserOrUserHierarchyAndTeams=81]="EqualUserOrUserHierarchyAndTeams",e[e.OlderThanXYears=82]="OlderThanXYears",e[e.OlderThanXWeeks=83]="OlderThanXWeeks",e[e.OlderThanXDays=84]="OlderThanXDays",e[e.OlderThanXHours=85]="OlderThanXHours",e[e.OlderThanXMinutes=86]="OlderThanXMinutes",e[e.ContainValues=87]="ContainValues",e[e.DoesNotContainValues=88]="DoesNotContainValues"}(i||(i={})),function(e){e[e.And=0]="And",e[e.Or=1]="Or"}(o||(o={})),function(e){e[e.None=-1]="None",e[e.Ascending=0]="Ascending",e[e.Descending=1]="Descending"}(s||(s={}))},8993:function(e,t,r){"use strict";r.r(t),r.d(t,"createOrUpdateColumnFilterInDataSet",(function(){return s})),r.d(t,"removeColumnFilterInDataSet",(function(){return u})),r.d(t,"isFilterEmpty",(function(){return c}));var n=r(8989),a=r(8990),i=r(8994),o=["begins-with","not-begin-with","ends-with","not-end-with","like","not-like"];function s(e,t,r,n,s){var u=function(e,t,r){var n=e.column.name,a=r&&o.includes(e.operator)?r(e.rightHandSide):e.rightHandSide;return function(e,t,r,n){var a=i.converterConfigurations[e];if(!a)throw new Error("Unsupported operator '".concat(e,"'"));var o=a.conditionOperator;if(p(n)&&!a.supportedForDate)throw new Error("Unsupported operator '".concat(e,"' for Date data type"));if(!p(n)&&!a.supportedForString)throw new Error("Unsupported operator '".concat(e,"' for ").concat(n.Type," data type"));var s="";a.convertValueForDataSet?s=a.convertValueForDataSet(t):a.noValue||(s=t);return{attributeName:r,conditionOperator:o,value:s}}(e.operator,a,"".concat(n).concat(e.columnKeySuffix?e.columnKeySuffix:""),t)}(e,t,s);if(!r)return{conditions:[u],filterOperator:a.FilterOperator.And,filters:[]};var c=e.column.name,l=d(r,n?"".concat(c).concat(n.columnKeySuffix?n.columnKeySuffix:""):c,t);return-1!==l?r.conditions[l]=u:r.conditions.push(u),r}function u(e,t,r,n){if(e){var a=d(e,n?"".concat(t).concat(n.columnKeySuffix?n.columnKeySuffix:""):t,r);if(-1!==a)return e.conditions.splice(a,1),!0}return!1}function c(e){return!e||l(e.conditions)&&l(e.filters)}function l(e){return!e||0===e.length}function d(e,t,r){return e.conditions.findIndex(e=>e.attributeName===t)}function p(e){return e.Type===n.AttributeType.Date||e.Type===n.AttributeType.DateTime}},8994:function(e,t,r){"use strict";r.r(t),r.d(t,"converterConfigurations",(function(){return o}));var n=r(8990),a=r(8995),i=r(8996),o={[a.FetchFilterOperator.NotNull]:{supportedForDate:!0,supportedForString:!1,noValue:!0,conditionOperator:n.ConditionOperator.NotNull},[a.FetchFilterOperator.Null]:{supportedForDate:!0,supportedForString:!1,noValue:!0,conditionOperator:n.ConditionOperator.Null},[a.FetchFilterOperator.EQ]:{supportedForDate:!1,supportedForString:!0,conditionOperator:n.ConditionOperator.Equal},[a.FetchFilterOperator.NEQ]:{supportedForDate:!1,supportedForString:!1,conditionOperator:n.ConditionOperator.None},[a.FetchFilterOperator.NE]:{supportedForDate:!1,supportedForString:!0,conditionOperator:n.ConditionOperator.NotEqual},[a.FetchFilterOperator.GT]:{supportedForDate:!1,supportedForString:!0,conditionOperator:n.ConditionOperator.GreaterThan},[a.FetchFilterOperator.GE]:{supportedForDate:!1,supportedForString:!0,conditionOperator:n.ConditionOperator.GreaterEqual},[a.FetchFilterOperator.LT]:{supportedForDate:!1,supportedForString:!0,conditionOperator:n.ConditionOperator.LessThan},[a.FetchFilterOperator.LE]:{supportedForDate:!1,supportedForString:!0,conditionOperator:n.ConditionOperator.LessEqual},[a.FetchFilterOperator.Like]:{supportedForDate:!1,supportedForString:!0,convertValueForDataSet:i.like,conditionOperator:n.ConditionOperator.Like,shouldUseNameField:!0},[a.FetchFilterOperator.BeginsWith]:{supportedForDate:!1,supportedForString:!0,convertValueForDataSet:i.percentPostfix,conditionOperator:n.ConditionOperator.BeginsWith,shouldUseNameField:!0},[a.FetchFilterOperator.NotBeginsWith]:{supportedForDate:!1,supportedForString:!0,convertValueForDataSet:i.percentPostfix,conditionOperator:n.ConditionOperator.DoesNotBeginWith,shouldUseNameField:!0},[a.FetchFilterOperator.NotEndsWith]:{supportedForDate:!1,supportedForString:!0,convertValueForDataSet:i.percentPrefix,conditionOperator:n.ConditionOperator.DoesNotEndWith,shouldUseNameField:!0},[a.FetchFilterOperator.EndsWith]:{supportedForDate:!1,supportedForString:!0,convertValueForDataSet:i.percentPrefix,conditionOperator:n.ConditionOperator.EndsWith,shouldUseNameField:!0},[a.FetchFilterOperator.NotLike]:{supportedForDate:!1,supportedForString:!0,convertValueForDataSet:i.like,conditionOperator:n.ConditionOperator.NotLike,shouldUseNameField:!0},[a.FetchFilterOperator.Null]:{supportedForDate:!0,supportedForString:!0,noValue:!0,conditionOperator:n.ConditionOperator.Null},[a.FetchFilterOperator.NotNull]:{supportedForDate:!0,supportedForString:!0,noValue:!0,conditionOperator:n.ConditionOperator.NotNull},[a.FetchFilterOperator.IN]:{supportedForDate:!1,supportedForString:!0,conditionOperator:n.ConditionOperator.In},[a.FetchFilterOperator.NotIN]:{supportedForDate:!1,supportedForString:!0,conditionOperator:n.ConditionOperator.NotIn},[a.FetchFilterOperator.InFiscalPeriod]:{supportedForDate:!0,supportedForString:!1,conditionOperator:n.ConditionOperator.InFiscalPeriod},[a.FetchFilterOperator.InFiscalPeriodAndYear]:{supportedForDate:!0,supportedForString:!1,conditionOperator:n.ConditionOperator.InFiscalPeriodAndYear},[a.FetchFilterOperator.InFiscalYear]:{supportedForDate:!0,supportedForString:!1,conditionOperator:n.ConditionOperator.InFiscalYear},[a.FetchFilterOperator.InOrAfterFiscalPeriodAndYear]:{supportedForDate:!0,supportedForString:!1,conditionOperator:n.ConditionOperator.InOrAfterFiscalPeriodAndYear},[a.FetchFilterOperator.InOrBeforeFiscalPeriodAndYear]:{supportedForDate:!0,supportedForString:!1,conditionOperator:n.ConditionOperator.InOrBeforeFiscalPeriodAndYear},[a.FetchFilterOperator.LastFiscalPeriod]:{supportedForDate:!0,supportedForString:!1,noValue:!0,conditionOperator:n.ConditionOperator.LastFiscalPeriod},[a.FetchFilterOperator.LastFiscalYear]:{supportedForDate:!0,supportedForString:!1,noValue:!0,conditionOperator:n.ConditionOperator.LastFiscalYear},[a.FetchFilterOperator.LastMonth]:{supportedForDate:!0,supportedForString:!1,noValue:!0,conditionOperator:n.ConditionOperator.LastMonth},[a.FetchFilterOperator.Last7Days]:{supportedForDate:!0,supportedForString:!1,noValue:!0,conditionOperator:n.ConditionOperator.Last7Days},[a.FetchFilterOperator.LastWeek]:{supportedForDate:!0,supportedForString:!1,noValue:!0,conditionOperator:n.ConditionOperator.LastWeek},[a.FetchFilterOperator.LastXDays]:{supportedForDate:!0,supportedForString:!1,conditionOperator:n.ConditionOperator.LastXDays},[a.FetchFilterOperator.LastXFiscalPeriods]:{supportedForDate:!0,supportedForString:!1,conditionOperator:n.ConditionOperator.LastXFiscalPeriods},[a.FetchFilterOperator.LastXFiscalYears]:{supportedForDate:!0,supportedForString:!1,conditionOperator:n.ConditionOperator.LastXFiscalYears},[a.FetchFilterOperator.LastXHours]:{supportedForDate:!0,supportedForString:!1,conditionOperator:n.ConditionOperator.LastXHours},[a.FetchFilterOperator.LastXMonths]:{supportedForDate:!0,supportedForString:!1,conditionOperator:n.ConditionOperator.LastXMonths},[a.FetchFilterOperator.LastXWeeks]:{supportedForDate:!0,supportedForString:!1,conditionOperator:n.ConditionOperator.LastXWeeks},[a.FetchFilterOperator.LastXYears]:{supportedForDate:!0,supportedForString:!1,conditionOperator:n.ConditionOperator.LastXYears},[a.FetchFilterOperator.LastYear]:{supportedForDate:!0,supportedForString:!1,noValue:!0,conditionOperator:n.ConditionOperator.LastYear},[a.FetchFilterOperator.NextFiscalPeriod]:{supportedForDate:!0,supportedForString:!1,noValue:!0,conditionOperator:n.ConditionOperator.NextFiscalPeriod},[a.FetchFilterOperator.NextFiscalYear]:{supportedForDate:!0,supportedForString:!1,noValue:!0,conditionOperator:n.ConditionOperator.NextFiscalYear},[a.FetchFilterOperator.NextMonth]:{supportedForDate:!0,supportedForString:!1,noValue:!0,conditionOperator:n.ConditionOperator.NextMonth},[a.FetchFilterOperator.Next7Days]:{supportedForDate:!0,supportedForString:!1,noValue:!0,conditionOperator:n.ConditionOperator.Next7Days},[a.FetchFilterOperator.NextWeek]:{supportedForDate:!0,supportedForString:!1,noValue:!0,conditionOperator:n.ConditionOperator.NextWeek},[a.FetchFilterOperator.NextXDays]:{supportedForDate:!0,supportedForString:!1,conditionOperator:n.ConditionOperator.NextXDays},[a.FetchFilterOperator.NextXFiscalPeriods]:{supportedForDate:!0,supportedForString:!1,conditionOperator:n.ConditionOperator.NextXFiscalPeriods},[a.FetchFilterOperator.NextXFiscalYears]:{supportedForDate:!0,supportedForString:!1,conditionOperator:n.ConditionOperator.NextXFiscalYears},[a.FetchFilterOperator.NextXHours]:{supportedForDate:!0,supportedForString:!1,conditionOperator:n.ConditionOperator.NextXHours},[a.FetchFilterOperator.NextXMonths]:{supportedForDate:!0,supportedForString:!1,conditionOperator:n.ConditionOperator.NextXMonths},[a.FetchFilterOperator.NextXWeeks]:{supportedForDate:!0,supportedForString:!1,conditionOperator:n.ConditionOperator.NextXWeeks},[a.FetchFilterOperator.NextXYears]:{supportedForDate:!0,supportedForString:!1,conditionOperator:n.ConditionOperator.NextXYears},[a.FetchFilterOperator.NextYear]:{supportedForDate:!0,supportedForString:!1,noValue:!0,conditionOperator:n.ConditionOperator.NextYear},[a.FetchFilterOperator.OlderthanXDays]:{supportedForDate:!0,supportedForString:!1,conditionOperator:n.ConditionOperator.OlderThanXDays},[a.FetchFilterOperator.OlderthanXHours]:{supportedForDate:!0,supportedForString:!1,conditionOperator:n.ConditionOperator.OlderThanXHours},[a.FetchFilterOperator.OlderthanXMinutes]:{supportedForDate:!0,supportedForString:!1,conditionOperator:n.ConditionOperator.OlderThanXMinutes},[a.FetchFilterOperator.OlderthanXMonths]:{supportedForDate:!0,supportedForString:!1,conditionOperator:n.ConditionOperator.OlderThanXMonths},[a.FetchFilterOperator.OlderthanXWeeks]:{supportedForDate:!0,supportedForString:!1,conditionOperator:n.ConditionOperator.OlderThanXWeeks},[a.FetchFilterOperator.OlderthanXYears]:{supportedForDate:!0,supportedForString:!1,conditionOperator:n.ConditionOperator.OlderThanXYears},[a.FetchFilterOperator.On]:{supportedForDate:!0,supportedForString:!1,convertValueForDataSet:i.serializeDateOnly,conditionOperator:n.ConditionOperator.On},[a.FetchFilterOperator.OnOrAfter]:{supportedForDate:!0,supportedForString:!1,convertValueForDataSet:i.serializeDateOnly,conditionOperator:n.ConditionOperator.OnOrAfter},[a.FetchFilterOperator.OnOrBefore]:{supportedForDate:!0,supportedForString:!1,convertValueForDataSet:i.serializeDateOnly,conditionOperator:n.ConditionOperator.OnOrBefore},[a.FetchFilterOperator.ThisFiscalPeriod]:{supportedForDate:!0,supportedForString:!1,noValue:!0,conditionOperator:n.ConditionOperator.ThisFiscalPeriod},[a.FetchFilterOperator.ThisFiscalYear]:{supportedForDate:!0,supportedForString:!1,noValue:!0,conditionOperator:n.ConditionOperator.ThisFiscalYear},[a.FetchFilterOperator.ThisMonth]:{supportedForDate:!0,supportedForString:!1,noValue:!0,conditionOperator:n.ConditionOperator.ThisMonth},[a.FetchFilterOperator.ThisWeek]:{supportedForDate:!0,supportedForString:!1,noValue:!0,conditionOperator:n.ConditionOperator.ThisWeek},[a.FetchFilterOperator.ThisYear]:{supportedForDate:!0,supportedForString:!1,noValue:!0,conditionOperator:n.ConditionOperator.ThisYear},[a.FetchFilterOperator.Today]:{supportedForDate:!0,supportedForString:!1,noValue:!0,conditionOperator:n.ConditionOperator.Today},[a.FetchFilterOperator.Tomorrow]:{supportedForDate:!0,supportedForString:!1,noValue:!0,conditionOperator:n.ConditionOperator.Tomorrow},[a.FetchFilterOperator.Yesterday]:{supportedForDate:!0,supportedForString:!1,noValue:!0,conditionOperator:n.ConditionOperator.Yesterday},[a.FetchFilterOperator.EQBusinessId]:{supportedForDate:!1,supportedForString:!0,noValue:!0,conditionOperator:n.ConditionOperator.EqualBusinessId},[a.FetchFilterOperator.EQUserId]:{supportedForDate:!1,supportedForString:!0,noValue:!0,conditionOperator:n.ConditionOperator.EqualUserId},[a.FetchFilterOperator.EQUserLanguage]:{supportedForDate:!1,supportedForString:!0,noValue:!0,conditionOperator:n.ConditionOperator.None},[a.FetchFilterOperator.EQUserOrUserHierarchy]:{supportedForDate:!1,supportedForString:!0,noValue:!0,conditionOperator:n.ConditionOperator.EqualUserOrUserHierarchy},[a.FetchFilterOperator.EQUserOrUserHierarchyAndTeams]:{supportedForDate:!1,supportedForString:!0,noValue:!0,conditionOperator:n.ConditionOperator.EqualUserOrUserHierarchyAndTeams},[a.FetchFilterOperator.EQUserOrUserTeams]:{supportedForDate:!1,supportedForString:!0,noValue:!0,conditionOperator:n.ConditionOperator.EqualUserOrUserTeams},[a.FetchFilterOperator.EQUserTeams]:{supportedForDate:!1,supportedForString:!0,noValue:!0,conditionOperator:n.ConditionOperator.EqualUserTeams},[a.FetchFilterOperator.NEBusinessId]:{supportedForDate:!1,supportedForString:!0,noValue:!0,conditionOperator:n.ConditionOperator.NotEqualBusinessId},[a.FetchFilterOperator.NEUserId]:{supportedForDate:!1,supportedForString:!0,noValue:!0,conditionOperator:n.ConditionOperator.NotEqualUserId},[a.FetchFilterOperator.IntersectionIsNotEmptyExpressionTemplate]:{supportedForDate:!1,supportedForString:!0,conditionOperator:n.ConditionOperator.ContainValues}}},8995:function(e,t,r){"use strict";var n;r.r(t),r.d(t,"FetchFilterOperator",(function(){return n})),function(e){e.BeginsWith="begins-with",e.EndsWith="ends-with",e.EQ="eq",e.EQBusinessId="eq-businessid",e.EQUserId="eq-userid",e.EQUserLanguage="eq-userlanguage",e.EQUserOrUserHierarchy="eq-useroruserhierarchy",e.EQUserOrUserHierarchyAndTeams="eq-useroruserhierarchyandteams",e.EQUserOrUserTeams="eq-useroruserteams",e.EQUserTeams="eq-userteams",e.GE="ge",e.GT="gt",e.IN="in",e.NotIN="not-in",e.LE="le",e.Like="like",e.LT="lt",e.NE="ne",e.NEBusinessId="ne-businessid",e.NEUserId="ne-userid",e.NEQ="neq",e.NotBeginsWith="not-begin-with",e.NotEndsWith="not-end-with",e.NotLike="not-like",e.NotNull="not-null",e.Null="null",e.IntersectionIsNotEmptyExpressionTemplate="contain-values",e.InFiscalPeriod="in-fiscal-period",e.InFiscalPeriodAndYear="in-fiscal-period-and-year",e.InFiscalYear="in-fiscal-year",e.InOrAfterFiscalPeriodAndYear="in-or-after-fiscal-period-and-year",e.InOrBeforeFiscalPeriodAndYear="in-or-before-fiscal-period-and-year",e.Last7Days="last-seven-days",e.LastFiscalPeriod="last-fiscal-period",e.LastFiscalYear="last-fiscal-year",e.LastMonth="last-month",e.LastWeek="last-week",e.LastXDays="last-x-days",e.LastXFiscalPeriods="last-x-fiscal-periods",e.LastXFiscalYears="last-x-fiscal-years",e.LastXHours="last-x-hours",e.LastXMonths="last-x-months",e.LastXWeeks="last-x-weeks",e.LastXYears="last-x-years",e.LastYear="last-year",e.Next7Days="next-seven-days",e.NextFiscalPeriod="next-fiscal-period",e.NextFiscalYear="next-fiscal-year",e.NextMonth="next-month",e.NextWeek="next-week",e.NextXDays="next-x-days",e.NextXFiscalPeriods="next-x-fiscal-periods",e.NextXFiscalYears="next-x-fiscal-years",e.NextXHours="next-x-hours",e.NextXMonths="next-x-months",e.NextXWeeks="next-x-weeks",e.NextXYears="next-x-years",e.NextYear="next-year",e.OlderthanXDays="olderthan-x-days",e.OlderthanXHours="olderthan-x-hours",e.OlderthanXMinutes="olderthan-x-minutes",e.OlderthanXMonths="olderthan-x-months",e.OlderthanXWeeks="olderthan-x-weeks",e.OlderthanXYears="olderthan-x-years",e.On="on",e.OnOrAfter="on-or-after",e.OnOrBefore="on-or-before",e.ThisFiscalPeriod="this-fiscal-period",e.ThisFiscalYear="this-fiscal-year",e.ThisMonth="this-month",e.ThisWeek="this-week",e.ThisYear="this-year",e.Today="today",e.Tomorrow="tomorrow",e.Yesterday="yesterday"}(n||(n={}))},8996:function(e,t,r){"use strict";function n(e,t){return("0".repeat(t)+e).slice(-t)}function a(e){if(isNaN(Date.parse(e)))return e;var t=new Date(e);return"".concat(t.getFullYear(),"-").concat(n(t.getMonth()+1,2),"-").concat(n(t.getDate(),2))}function i(e){return"".concat(e,"%")}function o(e){return"%".concat(e)}function s(e){return e?"%".concat(e,"%"):"%"}r.r(t),r.d(t,"leftPad",(function(){return n})),r.d(t,"serializeDateOnly",(function(){return a})),r.d(t,"percentPostfix",(function(){return i})),r.d(t,"percentPrefix",(function(){return o})),r.d(t,"like",(function(){return s}))},8997:function(e,t,r){"use strict";r.r(t),r.d(t,"isArrayEquals",(function(){return n})),r.d(t,"isEntityReferenceEquals",(function(){return a})),r.d(t,"isValuesEqual",(function(){return i})),r.d(t,"getRecordFieldsValues",(function(){return o})),r.d(t,"compareRecords",(function(){return s})),r.d(t,"dataSetErrorToError",(function(){return u})),r.d(t,"isGUID",(function(){return c}));var n=(e,t)=>{if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(!i(e[r],t[r]))return!1;return!0},a=(e,t)=>e.etn===t.etn&&e.id===t.id,i=(e,t)=>{if(e===t)return!0;if(e&&t){if(e.toISOString&&t.toISOString)return e.toISOString()===t.toISOString();if(e.etn&&t.etn)return a(e,t);if(e.pop&&t.pop)return n(e,t)}return!1},o=(e,t)=>{var r={};for(var n of t)r[n.name]={formatted:e.getFormattedValue(n.name),raw:e.getValue(n.name)};return r},s=(e,t,r)=>{var n=[];for(var a of e)t[a.name].formatted===r[a.name].formatted&&i(t[a.name].raw,r[a.name].raw)||n.push(a.name);return n},u=e=>{var t=e;return new Error(t.errorMessage||t.errorTitle||"UNKNOWN ERROR FORMAT")},c=e=>!!e.match(/[0-9a-f]{8}\b-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-\b[0-9a-f]{12}/g)},8998:function(e,t,r){"use strict";function n(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return e.replace(/{(\d+)}/g,(e,t)=>void 0!==r[t]?r[t]:e)}function a(e,t){for(var r=i(e,t),a=arguments.length,o=new Array(a>2?a-2:0),s=2;s<a;s++)o[s-2]=arguments[s];if(o){var u=o.map(e=>e.toString());return u.unshift(t.toString()),n(r,...u)}return n(r,t.toString())}function i(e,t){for(var r=/\((.*?)\){(.*?)};/g,n=r.exec(e);n;){if(o(n[1],t))return n[2];n=r.exec(e)}return e}function o(e,t){var r=/^\d+$/g.exec(e);return r?t===parseInt(r[0],10):(r=/^(\d+)-(\d+)$/g.exec(e))?t>=parseInt(r[1],10)&&t<=parseInt(r[2],10):!!(r=/^(\d+)-inf$/g.exec(e))&&t>=parseInt(r[1],10)}r.r(t),r.d(t,"formatString",(function(){return n})),r.d(t,"pluralizeString",(function(){return a})),r.d(t,"getPluralizedFormat",(function(){return i}))},8999:function(e,t,r){"use strict";r.r(t),r.d(t,"DEFAULT_SHIMMER_ROWS",(function(){return n})),r.d(t,"DEFAULT_CACHE_BLOCK_SIZE",(function(){return a}));var n=5,a=100},9e3:function(e,t,r){"use strict";r.r(t),r.d(t,"RecordsOperationsQueue",(function(){return s}));var n=r(8997),a=r(8986);function i(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function o(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function s(e){i(o,n,a,s,u,"next",e)}function u(e){i(o,n,a,s,u,"throw",e)}s(void 0)}))}}class s{constructor(e){this.config=e,this.queue={},this.newRecords=[],this.newRecordsListeners=[],this.queueChangedListeners=[],this.reset=()=>{for(var e of Object.values(this.queue))e.saveOperation&&(e.saveOperation.isCanceled=!0),e.upcomingSaveOperation&&(e.upcomingSaveOperation.isCanceled=!0),e.deleteOperation&&(e.deleteOperation.isCanceled=!0);this.queue={},this.newRecords=[],this.dispatchOnQueueChanged()},this.dispatchOnQueueChanged=()=>{this.queueChangedListeners.map(e=>e.apply(void 0,[]))}}getNewUnsavedRecords(){return this.newRecords}addNewRecordSavedListener(e){this.newRecordsListeners.push(e)}onQueueChanged(e){this.queueChangedListeners.push(e)}setValue(e,t,r){var n,a=e.getRecordId(),i=this.getOrCreateQueueItem(a);i.saveOperation?i.saveOperation&&this.isUnfinishedOperation(i.saveOperation)?n=i.saveOperation:(i.upcomingSaveOperation||(i.upcomingSaveOperation={type:"update",changes:[],record:e}),n=i.upcomingSaveOperation):(i.saveOperation={type:"update",changes:[],record:e},n=i.saveOperation);var{change:o,hasSameValue:s}=this.findExistingChange(n,t,r);if(o&&s)return o;o&&(o.value=r,o.error=void 0,o.success=void 0);var u=null!=o?o:{columnName:t,value:r,type:"setValue"};return u.result=this.executeSetValueAsync(e,t,r,u),u.result.then(this.dispatchOnQueueChanged,this.dispatchOnQueueChanged),o||n.changes.push(u),this.dispatchOnQueueChanged(),u}deleteRecordsAsync(e,t){var r=this;return o((function*(){var n=[],a=function(e){var t=e.getRecordId(),a=r.getOrCreateQueueItem(t);a.deleteOperation||(a.deleteOperation={type:"delete",result:new Promise((e,r)=>n.push({resolve:e,reject:r,recordId:t,queueItem:a}))})};for(var i of t)a(i);for(var{queueItem:o}of(r.dispatchOnQueueChanged(),n))if(r.isOperationInProgress(o.saveOperation))try{yield o.saveOperation.result}catch(u){}var s=n.filter(e=>{var t,n=-1!==r.getNewUnsavedRecords().indexOf(e.recordId),a=null===(t=e.queueItem.deleteOperation)||void 0===t?void 0:t.isCanceled;return n&&(e.resolve(),delete r.queue[e.recordId]),!n&&!a});try{if(0===s.length)return;yield e.delete(s.map(e=>e.recordId)),s.forEach(e=>{e.resolve(),delete r.queue[e.recordId]}),r.dispatchOnQueueChanged()}catch(u){throw s.forEach(e=>{e.queueItem.error=u,e.queueItem.deleteOperation.success=!1,e.queueItem.deleteOperation.error=u,e.reject(u)}),r.dispatchOnQueueChanged(),u}}))()}registerNewRecord(e){var t=e.getRecordId();return this.queue[t]={saveOperation:{type:"create",changes:[],record:e}},this.newRecords.push(t),this.dispatchOnQueueChanged(),this.queue[t].saveOperation}save(e){var t=e.getRecordId();if(this.queue.hasOwnProperty(t)&&this.queue[t].saveOperation){var r=this.getOrCreateQueueItem(t);if(!this.isOperationInProgress(r.deleteOperation)&&!r.upcomingSaveOperation&&r.saveOperation&&0!==r.saveOperation.changes.length){if(this.isOperationInProgress(r.saveOperation))return r.saveOperation;r.saveOperation.error&&(r.saveOperation.error=void 0,r.saveOperation.success=void 0);var n=r.saveOperation.changes.filter(e=>!1===e.success);return n.length>0?r.saveOperation.validationErrors=n.map(e=>e.error):(r.saveOperation.validationErrors=[],r.saveOperation.result=this.executeSaveAsync(e,r,r.saveOperation),r.saveOperation.result.then(this.dispatchOnQueueChanged,this.dispatchOnQueueChanged)),this.dispatchOnQueueChanged(),r.saveOperation}}}saveMultiple(e,t){var r,n,a,i=[],o=[];for(var u of e){var c=u.getRecordId();if(this.queue.hasOwnProperty(c)){var l=this.queue[c];if(!this.isOperationInProgress(l.deleteOperation)&&!l.upcomingSaveOperation&&l.saveOperation&&0!==l.saveOperation.changes.length)if(this.isOperationInProgress(l.saveOperation)&&l.saveOperation.result)i.push(l.saveOperation.result);else{l.saveOperation.error&&(l.saveOperation.error=void 0,l.saveOperation.success=void 0);var d=l.saveOperation.changes.filter(e=>!1===e.success);d.length>0?(l.saveOperation.validationErrors=d.map(e=>e.error),l.saveOperation.result=void 0):o.push(u)}}}o.length>s.MAX_PASTE_ROWS&&(null===(r=this.config)||void 0===r||null===(n=(a=r.callbacks).onShowErrorMessage)||void 0===n||n.call(a,s.PASTE_ERROR,s.PASTE_ERROR_TOO_MANY_ROWS),o.splice(s.MAX_PASTE_ROWS));try{this.executeMultipleSaveAsync(o,t).then(()=>{for(var e of o){var t=e.getRecordId();if(this.queue.hasOwnProperty(t)){var r=this.queue[t];r.saveOperation.result=Promise.resolve(),r.saveOperation.validationErrors=[]}}})}catch(p){return i}finally{this.dispatchOnQueueChanged()}return i}getRecordQueue(e){return this.queue[e]}getRecordSetValue(e,t){var r,n,a=this.getRecordQueue(e.getRecordId());return a&&a.upcomingSaveOperation?null===(r=a.upcomingSaveOperation.changes.find(e=>e.columnName===t))||void 0===r?void 0:r.result:a&&a.saveOperation?null===(n=a.saveOperation.changes.find(e=>e.columnName===t))||void 0===n?void 0:n.result:void 0}isOperationInProgress(e){return e&&e.result&&void 0===e.success}static processDataFromClipboard(e){e.length>0&&(e[e.length-1].some(e=>""!==e)||e.pop());return s.totalPastedRecords=e.length,e}processAllOperations(e){var t,r,n,a=this,i=[],o=[],u=Object.values(this.queue).length;s.totalPastedRecords>0&&u>0&&s.totalPastedRecords>u&&(s.totalPastedRecords<s.MAX_PASTE_ROWS||u<s.MAX_PASTE_ROWS)&&(null===(t=this.config)||void 0===t||null===(r=(n=t.callbacks).onShowErrorMessage)||void 0===r||r.call(n,s.PASTE_ERROR,s.PASTE_ERROR_TOO_MANY_ROWS_FOR_VIEW,[u.toString()]));var c=function(e){var t;null!=e&&e.deleteOperation&&a.isOperationInProgress(null==e?void 0:e.deleteOperation)?i.push(null==e||null===(t=e.deleteOperation)||void 0===t?void 0:t.result.catch(e=>{})):null!=e&&e.saveOperation&&e.saveOperation.result&&a.isOperationInProgress(null==e?void 0:e.saveOperation)?null!=e&&e.upcomingSaveOperation?i.push(e.saveOperation.result.then(()=>{var t;return null==e||null===(t=e.saveOperation)||void 0===t?void 0:t.result}).catch(e=>{})):i.push(e.saveOperation.result.catch(e=>{})):null!=e&&e.saveOperation&&e.saveOperation.record&&a.isNotStartedOperation(e.saveOperation)&&o.push(e.saveOperation.record)};for(var l of Object.values(this.queue))c(l);if(1===o.length){var d=this.save(o[0]);d&&d.result&&i.push(d.result.catch(e=>{}))}else if(o.length>0){var p=this.saveMultiple(o,e);i.push(...p)}return i.length>0?Promise.all(i):Promise.resolve()}getRecordOperationsCount(){var e=0,t=0,r=0,n=0;for(var a of Object.values(this.queue))null!=a&&a.deleteOperation&&(this.isOperationInProgress(a.deleteOperation)?n++:this.isOperationInErrorState(a.deleteOperation)&&t++),null!=a&&a.saveOperation&&(this.isOperationInProgress(a.saveOperation)?r++:(this.isOperationInErrorState(a.saveOperation)||a.saveOperation.validationErrors&&a.saveOperation.validationErrors.length>0)&&t++),(null!=a&&a.upcomingSaveOperation||null!=a&&a.saveOperation&&this.isNotStartedOperation(a.saveOperation)&&a.saveOperation.changes.length>0)&&e++;return{dirtyRecordsCount:e,recordsInErrorStateCount:t,savingRecordsCount:r,deletingRecordsCount:n}}getOrCreateQueueItem(e){return this.queue.hasOwnProperty(e)||(this.queue[e]={}),this.queue[e]}dispatchNewRecordSavedListener(e,t){this.queue[t]=this.queue[e];var r=this.newRecords.indexOf(e);-1!==r&&this.newRecords.splice(r,1),delete this.queue[e],this.newRecordsListeners.map(r=>r.call(void 0,e,t))}moveUpcomingSaveChangesToCurrent(e){var t=!1;if(e.upcomingSaveOperation&&e.saveOperation){var r=e.upcomingSaveOperation.changes;r.length>0&&r.forEach(r=>{var{hasSameValue:n,change:a}=this.findExistingChange(e.saveOperation,r.columnName,r.value);if(a&&!n)e.saveOperation[e.saveOperation.changes.indexOf(a)]=r,t=!0;else if(!a){var i;null===(i=e.saveOperation)||void 0===i||i.changes.push(r),t=!0}})}return t}handlePendingChangeError(e,t){var r,n;t.result=void 0,t.success=void 0,t.error=void 0,t.validationErrors=t.changes.filter(e=>e.error).map(e=>e.error),null!==(r=e.saveOperation)&&void 0!==r&&r.isCanceled||null!==(n=e.upcomingSaveOperation)&&void 0!==n&&n.isCanceled||!this.moveUpcomingSaveChangesToCurrent(e)||this.save(t.record)}executeSaveAsync(e,t,r){var n=this;return o((function*(){var a=r.changes.filter(e=>void 0===e.success).map(e=>e.result);if(a.length>0)try{yield Promise.all(a)}catch(p){return void n.handlePendingChangeError(t,r)}try{var i;if(null!==(i=t.saveOperation)&&void 0!==i&&i.isCanceled)return;var o=e.getRecordId();yield e.save(),"create"===r.type&&n.dispatchNewRecordSavedListener(o,e.getRecordId()),t.upcomingSaveOperation||t.deleteOperation||delete n.queue[e.getRecordId()],t.upcomingSaveOperation&&(t.saveOperation=t.upcomingSaveOperation,delete t.upcomingSaveOperation,n.save(t.saveOperation.record))}catch(p){if(!n.moveUpcomingSaveChangesToCurrent(t)){var s,u,c,l,d={errorMessage:(null===(s=n.config)||void 0===s||null===(u=s.props)||void 0===u||null===(c=u.localizedStrings)||void 0===c||null===(l=c.errors)||void 0===l?void 0:l.rowSaveError)||"Error in saving this record.",errorCode:p.kind};throw r.success=!1,r.error=d,t.error=d,p}return void n.save(r.record)}}))()}executeMultipleSaveAsync(e,t){var r=this;return o((function*(){var n,i,o=[],u=null===(n=r.config)||void 0===n||null===(i=n.telemetryProvider)||void 0===i?void 0:i.getScenarioTracker(a.telemetryKeys.saveMultipleRecords,void 0);for(var c of e){var l=c.getRecordId();if(r.queue.hasOwnProperty(l)&&r.queue[l].saveOperation){var d=r.queue[l],p=d.saveOperation,f=p.changes.filter(e=>void 0===e.success).map(e=>e.result);if(f.length>0)try{yield Promise.all(f)}catch(R){r.handlePendingChangeError(d,p);continue}o.push(c)}}var h={numberOfRecordsRequested:e.length,numberOfRecordsToSave:o.length,numberOfRecordsSaved:0};try{var m=yield t.saveMultipleRecords(o);for(var y of(h.numberOfRecordsSaved=m.length,null==u||u.complete(h),e)){var v=y.getRecordId();if(r.queue.hasOwnProperty(v)&&r.queue[v].saveOperation){var g=r.queue[v];g.upcomingSaveOperation||g.deleteOperation||delete r.queue[v],g.upcomingSaveOperation&&(g.saveOperation=g.upcomingSaveOperation,delete g.upcomingSaveOperation,r.save(g.saveOperation.record))}}}catch(R){var O,E,b,T;for(var S of(null==u||u.failure(h,R),e)){var C=S.getRecordId();if(r.queue.hasOwnProperty(C)&&r.queue[C].saveOperation){var N=r.queue[C],_=N.saveOperation;r.moveUpcomingSaveChangesToCurrent(N)?r.save(_.record):(_.success=!1,_.error=R,N.error=R)}}if(!R.errorCode&&R.errorMessage)T=R.errorMessage;else switch(R.errorCode){case 2147746611:T=s.PASTE_ERROR_DUPLICATE_ROWS;break;default:T=s.PASTE_ERROR_SAVING_ROWS}null===(O=r.config)||void 0===O||null===(E=(b=O.callbacks).onShowErrorMessage)||void 0===E||E.call(b,s.PASTE_ERROR,T)}}))()}executeSetValueAsync(e,t,r,n){return o((function*(){try{yield e.setValue(t,r),n.success=!0}catch(a){throw n.success=!1,n.error=a,a}}))()}findExistingChange(e,t,r){var a=e.changes.find(e=>e.columnName===t);return a&&Object(n.isValuesEqual)(a.value,r)?{change:a,hasSameValue:!0}:{change:a,hasSameValue:!1}}isUnfinishedOperation(e){return!(!this.isNotStartedOperation(e)&&!this.isOperationInErrorState(e))}isNotStartedOperation(e){return!e.result}isOperationInErrorState(e){return!!e.error}}s.totalPastedRecords=0,s.PASTE_ERROR_TOO_MANY_ROWS="tooManyRowsToPasteError",s.PASTE_ERROR_DUPLICATE_ROWS="errorSavingDuplicateRows",s.PASTE_ERROR_SAVING_ROWS="errorSavingAllRows",s.PASTE_ERROR_TOO_MANY_ROWS_FOR_VIEW="errorPasteTooManyRecordsForCurrentView",s.PASTE_ERROR="PASTE_ERROR",s.MAX_PASTE_ROWS=1e3},9001:function(e,t,r){"use strict";r.r(t),r.d(t,"RelatedDataSetsProvider",(function(){return a}));var n=r(9002);class a{constructor(e){this.dataSet=e,this.cache={}}updateDataSet(e){this.dataSet=e}getProvider(e){return this.cache.hasOwnProperty(e.name)||(this.cache[e.name]=new n.RelatedDataSetProvider(this.dataSet,e)),this.cache[e.name]}}},9002:function(e,t,r){"use strict";r.r(t),r.d(t,"RelatedDataSetProvider",(function(){return d}));var n=r(8082),a=r(8783),i=r(8989),o=r(8988),s=r(8990),u=r(8997);function c(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function l(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){c(i,n,a,o,s,"next",e)}function s(e){c(i,n,a,o,s,"throw",e)}o(void 0)}))}}class d{constructor(e,t){this.mainDataSet=e,this.column=t,this.loadDataPromise=void 0,this.loadDataPromiseResolve=void 0,this.loadDataPromiseReject=void 0,this.relatedDataSet=void 0,this.onDataSetUpdatedCallback=(e,t,r)=>{var i=t.sortedRecordIds.map(e=>{var r,i=t.records[e],o=(null===(r=t.columns.find(e=>e.isPrimary))||void 0===r?void 0:r.name)||"";return{[n.RECID]:i.getRecordId(),[a.ENTITYNAME]:t.getTargetEntityType(),[o]:i.getFormattedValue(o)}});t.error?this.loadDataPromiseReject(new Error(t.errorMessage)):this.loadDataPromiseResolve(i)},this.generateColumnDefinition=e=>{var t=e.attributes,r=Object(o.getDataTypeMap)(t);return{name:e.name,displayName:e.displayName,isPrimary:!!e.isPrimary,dataType:r,width:Object(o.getColumnWidthFromDataType)(r)}},this.loadDataPromise=this.setLoadDataPromise()}reset(){this.setLoadDataPromise()}loadData(e){var t=this;return l((function*(){var r,n;if(t.reset(),yield t.setRelatedDataSet(),e)if(Object(u.isGUID)(e)){var a=e.split(",").filter(u.isGUID);t.relatedDataSet.filtering.setFilter({conditions:[{attributeName:t.getPrimaryColumnId().name,value:a.filter(e=>Object(u.isGUID)(e)),conditionOperator:s.ConditionOperator.In}],filterOperator:s.FilterOperator.Or})}else t.relatedDataSet.filtering.setFilter({conditions:[{attributeName:t.getPrimaryColumn().name,value:"%".concat(e,"%"),conditionOperator:s.ConditionOperator.Like}],filterOperator:s.FilterOperator.And});else null===(n=t.relatedDataSet)||void 0===n||n.filtering.clearFilter();return null===(r=t.relatedDataSet)||void 0===r||r.refresh(),t.loadDataPromise}))()}getPrimaryColumn(){return this.relatedDataSet.columns.find(e=>e.isPrimary)}getPrimaryColumnId(){return this.relatedDataSet.columns.find(e=>e.dataType===i.AttributeType.UniqueIdentifier)}setRelatedDataSet(){var e=this;return l((function*(){if(!e.relatedDataSet){var t=yield e.mainDataSet.getRelatedDataSet(e.column.name,(t,r)=>{e.onDataSetUpdatedCallback(e.column,t,r)});null!=t&&t.length&&(e.relatedDataSet=t[0])}}))()}generateColumnDefinitions(){var e=this;return l((function*(){var t;return yield e.setRelatedDataSet(),(null===(t=e.relatedDataSet)||void 0===t?void 0:t.columns.map(e.generateColumnDefinition))||[]}))()}setLoadDataPromise(){return this.loadDataPromise=new Promise((e,t)=>{this.loadDataPromiseResolve=e,this.loadDataPromiseReject=t}),this.loadDataPromise}}},9004:function(e,t,r){"use strict";r.r(t),r.d(t,"defaultGridContainerProps",(function(){return d})),r.d(t,"ShimmeredDataSetGrid",(function(){return p}));var n=r(8076),a=r(8448),i=r(1795),o=r(245),s=r.n(o),u=r(8988),c=r(8999);function l(){return(l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var d={rowSelection:void 0,useEditableStyles:!0},p=e=>{var t,r,o,p,f={getDataSourceConfig:()=>{var t,r,n,a;return{paginationPageSize:null!==(t=null===(r=e.configuration)||void 0===r?void 0:r.initialPageSize)&&void 0!==t?t:c.DEFAULT_CACHE_BLOCK_SIZE,maxConcurrentDatasourceRequests:1,cacheBlockSize:null!==(n=null===(a=e.configuration)||void 0===a?void 0:a.initialPageSize)&&void 0!==n?n:c.DEFAULT_CACHE_BLOCK_SIZE,infiniteInitialRowCount:c.DEFAULT_SHIMMER_ROWS}},getRows:()=>{}},h={dataType:"Text",displayName:"",logicalName:"",pinned:"left"},m=null===(t=e.configuration)||void 0===t?void 0:t.userConfiguration,y=null!=m&&m.columns&&Object.values(null==m?void 0:m.columns).length>0?null==m?void 0:m.columns:{Unknown:h},v=(null!=m&&null!==(r=m.visibleOrderedColumns)&&void 0!==r&&r.length?null==m?void 0:m.visibleOrderedColumns:Object.keys(y)).map(e=>{var t,r,n=null!==(t=y[e])&&void 0!==t?t:h;return{name:n.logicalName,displayName:n.displayName,dataType:n.dataType,width:null!==(r=n.width)&&void 0!==r?r:Object(u.getColumnWidthFromDataType)(n.dataType),pinned:n.pinned,filterExpression:n.filter,sortDirection:n.sorting,isPrimary:!1,editable:!1,disableSorting:!0,disableFiltering:!0,disableMoving:!0,disablePinning:!0,disableHideColumn:!0,disableDeleteColumn:!0,disableEditColumn:!0,showHeaderIcon:!0}});return s.a.createElement(i.Stack,{verticalFill:!0},s.a.createElement(i.Stack.Item,{grow:!0,verticalFill:!0},s.a.createElement(n.AgGridContainer,l({},d,{cellCustomization:new a.Customizers(void 0,void 0,null===(o=e.configuration)||void 0===o||null===(p=o.userConfiguration)||void 0===p?void 0:p.rowDensity),infiniteScroll:!0,statusColumn:"pinned",columnsAutoFit:!1,allowColumnMoving:!1,allowColumnResizing:!1,columns:v,dataSource:f}))))}},9005:function(e,t,r){"use strict";r.r(t);var n=r(9006);r.d(t,"DataSetGridHost",(function(){return n.DataSetGridHost}))},9006:function(e,t,r){"use strict";r.r(t),r.d(t,"DataSetGridHost",(function(){return T}));var n=r(245),a=r(1201),i=r(545),o=r(9007),s=r(687),u=r(1372),c=r(1795),l=r(9008),d=r(1654),p=r(8075),f=r(9009),h=r(9010),m=r(9011),y=r(9034);function v(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function g(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?v(Object(r),!0).forEach((function(t){O(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function O(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Object(d.initializeIcons)();var E=Object(i.classNamesFunction)();class b extends n.Component{constructor(e){super(e),this._dataSetUpdated=void 0,this._onNavigate=void 0,this._async=void 0,this._debouncedDispatchDataSetUpdate=void 0,this.state={datasetLoadState:"none",dataProvider:null,userConfigManager:null,totalRowsCount:null,selectedJumpBarButton:0},this._onJumpBarFilter=this._onJumpBarFilter.bind(this),this._onJumpBarShowAll=this._onJumpBarShowAll.bind(this),this._async=new i.Async(this),this._debouncedDispatchDataSetUpdate=this._async.debounce(this._dispatchDataSetUpdate,250),this._dataSetUpdated=new f.Signal,this._onNavigate=new f.Signal}static getDerivedStateFromProps(e,t){var r,n,a;if(!t.dataProvider){var i={setPreservedState:e.setPreservedState,getPreservedState:e.getPreservedState},s=new o.DataSetGridDataProvider(e),u=new h.UserConfigurationManager(e.dataSet,i);return{datasetLoadState:"loading",dataProvider:s,userConfigManager:u,selectedJumpBarButton:u.userConfiguration.jumpBarButton}}return null!==(r=e.updatedProperties)&&void 0!==r&&r.includes(e.datasetPropertyName||"Items")?(null===(n=t.dataProvider)||void 0===n||n.updateDataSet(e.dataSet),null===(a=t.userConfigManager)||void 0===a||a.updateDataSet(e.dataSet),{datasetLoadState:e.dataSet.loading?"loading":"loaded"}):{datasetLoadState:e.dataSet.loading?"loading":"loaded"}}componentDidUpdate(e){if(this.state.dataProvider){var t=this.props.updatedProperties;null!=t&&t.includes("columns")||null!=t&&t.includes("sortorder")||null!=t&&t.includes("filter")?this._dispatchDataSetUpdate(this._dataSetUpdated,this.state.dataProvider.dataSet,t,!0):(null!=t&&t.includes("page")||null!=t&&t.includes("records"))&&this._debouncedDispatchDataSetUpdate(this._dataSetUpdated,this.state.dataProvider.dataSet,t)}}componentWillUnmount(){var e;null===(e=this.state.userConfigManager)||void 0===e||e.save(),this.dispatchNavigateEvent(),this._async.dispose()}render(){var e,t,r,i,o,l,d,f,h,v,{cellCustomization:O,cellEditorOverrides:b,cellRendererOverrides:T,configuration:S,enableMoveMenu:C,events:N,forceReadonly:_,isRTLMode:R,styles:P,theme:I,renderAsList:A}=this.props,D=E(P,{theme:I}),M=g(g({},{userConfiguration:null===(e=this.state.userConfigManager)||void 0===e?void 0:e.userConfiguration}),S);M.gridConfiguration&&(M.gridConfiguration.allowColumnMoving=!!C);var F=null===(t=M.localizedStrings)||void 0===t?void 0:t.gridBaseLocalizedString,w=Object.assign({onNavigate:this._onNavigate},N,{onDataSetUpdated:this._dataSetUpdated}),L={strings:{rowsPlural:null!==(r=null===(i=M.localizedStrings)||void 0===i||null===(o=i.footerStrings)||void 0===o?void 0:o.rows_plural)&&void 0!==r?r:""},height:40,rowsCount:null===(l=this.state.dataProvider)||void 0===l?void 0:l.dataSet.getSelectedRecordIds().length,styles:this.props.styles,theme:this.props.theme},j={isMobileLayout:!!this.props.renderAsList,height:40,selectedButton:this.state.selectedJumpBarButton,onFilter:this._onJumpBarFilter,onShowAll:this._onJumpBarShowAll,localizedStrings:null===(d=M.localizedStrings)||void 0===d?void 0:d.jumpBarStrings,theme:this.props.theme};return this.state.dataProvider&&"none"!==this.state.datasetLoadState?"loading"===this.state.datasetLoadState?n.createElement("div",{className:"".concat(D.root," ").concat(D.statusContainer)},n.createElement(a.Spinner,{size:a.SpinnerSize.large,label:null!==(h=null==F?void 0:F.loading)&&void 0!==h?h:""})):n.createElement("div",{className:D.root},A?n.createElement(m.DataSetList,{dataSet:this.state.dataProvider.dataSet,configuration:M,events:w}):n.createElement(p.PowerAppsDataSetGrid,{dataSet:this.state.dataProvider.dataSet,cellCustomization:O,cellRendererOverrides:T,cellEditorOverrides:b,configuration:M,isRTLMode:R,forceReadonly:_,events:w,callbacks:{onConfigurationUpdated:null===(v=this.state.userConfigManager)||void 0===v?void 0:v.onConfigurationUpdated},asyncColumnsEnabled:!1,escapeFilterValues:this.props.escapeFilterValues,footer:n.createElement(y.Footer,{pagingProps:L,jumpBarProps:j,selectedRowsCount:this.state.dataProvider.dataSet.getSelectedRecordIds().length,isJumpBarEnabled:!!this.props.enableJumpBar})})):n.createElement("div",{className:"".concat(D.root," ").concat(D.statusContainer)},n.createElement(c.Stack,{className:D.statusContainer},n.createElement(s.Icon,{iconName:"Database",className:D.icon}),n.createElement(u.Label,{children:null!==(f=null==F?void 0:F.noRows)&&void 0!==f?f:""})))}_onJumpBarFilter(e,t){var r,n,a,i;null===(r=this.state.dataProvider)||void 0===r||r.applyJumpBarFilter(e,this.state.userConfigManager),this.setState({selectedJumpBarButton:t}),null===(n=this.state.userConfigManager)||void 0===n||null===(a=n.onConfigurationUpdated)||void 0===a||a.call(n,{jumpBarButton:t}),null!==(i=this.state.dataProvider)&&void 0!==i&&i.dataSet&&this._dispatchDataSetUpdate(this._dataSetUpdated,this.state.dataProvider.dataSet,[],!0)}_onJumpBarShowAll(){var e,t,r,n,a=null===(e=this.state.dataProvider)||void 0===e?void 0:e.clearJumpBarFilters(this.state.userConfigManager);this.setState({selectedJumpBarButton:0}),null===(t=this.state.userConfigManager)||void 0===t||null===(r=t.onConfigurationUpdated)||void 0===r||r.call(t,{jumpBarButton:0}),a&&null!==(n=this.state.dataProvider)&&void 0!==n&&n.dataSet&&this._dispatchDataSetUpdate(this._dataSetUpdated,this.state.dataProvider.dataSet,[],!0)}_dispatchDataSetUpdate(e,t,r,n){var a=r.filter(e=>["columns","records","page"].includes(e));e.dispatch(t,a,n)}dispatchNavigateEvent(){var e;null!==(e=this.props.events)&&void 0!==e&&e.onNavigate?this.props.events.onNavigate.dispatch():this._onNavigate.dispatch()}}var T=Object(i.styled)(b,l.getStyles)},9007:function(e,t,r){"use strict";r.r(t),r.d(t,"DataSetGridDataProvider",(function(){return u}));var n=r(8990),a=r(8989);function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){s(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class u{get dataSet(){return this._dataSet}constructor(e){this.gridHostProps=e,this._dataSet=void 0,this._dataSet=this.createDataSet(e.dataSet)}updateDataSet(e){this._dataSet=this.createDataSet(e)}applyJumpBarFilter(e,t){var r,a,i,o=this._getJumpBarFilterColumn();if(o){var s=this._getAttribute(o,e);e.attributeName=s;var u={conditions:[e],filterOperator:n.FilterOperator.And,filters:[]};this._clearJumpBarFilters(t);var c=this.dataSet.filtering.getFilter();if(c){var l=c.conditions.findIndex(t=>t.attributeName===e.attributeName);-1!==l?c.conditions[l]=e:c.conditions.push(e)}else c=u;this.dataSet.filtering.setFilter(c),null==t||null===(r=t.onConfigurationUpdated)||void 0===r||r.call(t,{columns:{[o.name]:{updatedProps:["jumpBarFilter"],config:{jumpBarFilter:u}}}}),null===(a=(i=this.dataSet).refresh)||void 0===a||a.call(i)}}clearJumpBarFilters(e){var t,r;return!!this._clearJumpBarFilters(e)&&(null===(t=(r=this.dataSet).refresh)||void 0===t||t.call(r),!0)}_clearJumpBarFilters(e){var t,r=this.dataSet.filtering.getFilter();if(null==r||null===(t=r.conditions)||void 0===t||!t.length)return!1;for(var n,a=!1,i={},o=r.conditions.length-1;o>=0;o--){var s=r.conditions[o];"JumpBar"===s.source&&(r.conditions.splice(o,1),a=!0,i[s.attributeName]={config:{jumpBarFilter:void 0},updatedProps:["jumpBarFilter"]})}a&&(null==e||null===(n=e.onConfigurationUpdated)||void 0===n||n.call(e,{columns:i}));return a}_getJumpBarFilterColumn(){for(var e,t,r=this.dataSet.columns,a=["customer","lookup","owner","string"],i=this.dataSet.sorting.find(e=>e.sortDirection===n.ColumnSortDirection.Ascending||e.sortDirection===n.ColumnSortDirection.Descending),o=0;o<r.length;o++){var s=r[o],u=a.includes(s.dataType);if(null!=i&&i.name&&s.name===(null==i?void 0:i.name)&&u)return s;!e&&s.isPrimary&&u&&(e=s),!t&&u&&(t=s)}return e||t}_getAttribute(e,t){return-1!==[a.AttributeType.Boolean,a.AttributeType.PickList,a.AttributeType.MultiSelectPickList,a.AttributeType.State,a.AttributeType.Status,a.AttributeType.EntityName,a.AttributeType.Customer,a.AttributeType.Owner,a.AttributeType.Lookup].indexOf(e.dataType)?"".concat(e.name,"name"):e.name}createDataSet(e){return o(o({},e),{},{columns:e.columns.filter(e=>this._isVisibleColumn(e)).map(e=>{var t,r,n,i,s,u,c,l,d,p,f,h,m,y,v,g,O,E=(e=>{var t,r,n=null===(t=e.dataType)||void 0===t?void 0:t.toLocaleLowerCase();switch(n){case"singleline.email":return{Type:a.AttributeType.String,Format:"Email"};case"singleline.phone":return{Type:a.AttributeType.String,Format:"Phone"};case"singleline.url":return{Type:a.AttributeType.String,Format:"Url"};case"singleline.textarea":return{Type:a.AttributeType.Memo};case"multiple":return{Type:a.AttributeType.MultiSelectPickList};case"optionset":return{Type:a.AttributeType.PickList};case"lookup.customer":return{Type:a.AttributeType.Customer};case"lookup.owner":case"lookup.simple":return{Type:a.AttributeType.Lookup};case"twooptions":return{Type:a.AttributeType.Boolean};case"fp":return{Type:a.AttributeType.Decimal};case"whole.none":return{Type:a.AttributeType.Integer};case"dateandtime.dateonly":return{Type:a.AttributeType.Date,Format:"DateOnly"};case"dateandtime.dateandtime":return{Type:a.AttributeType.DateTime,Format:"DateAndTime"};case"string":switch(null===(r=e.attributes)||void 0===r?void 0:r.Format){case"email":return{Type:a.AttributeType.String,Format:"Email"};case"phone":return{Type:a.AttributeType.String,Format:"Phone"};case"textarea":return{Type:a.AttributeType.String,Format:"TextArea"};case"url":return{Type:a.AttributeType.String,Format:"Url"};default:return{Type:"string"}}default:return Object.values(a.AttributeType).includes(n)?{Type:n}:{Type:"string"}}})(e);return o(o({},e),{},{attributes:o(o({},e.attributes),{},{DisplayName:null!==(t=null===(r=e.attributes)||void 0===r?void 0:r.DisplayName)&&void 0!==t?t:e.displayName,LogicalName:null!==(n=null===(i=e.attributes)||void 0===i?void 0:i.LogicalName)&&void 0!==n?n:e.name,RequiredLevel:null!==(s=null===(u=e.attributes)||void 0===u?void 0:u.RequiredLevel)&&void 0!==s?s:0,Description:null!==(c=null===(l=e.attributes)||void 0===l?void 0:l.Description)&&void 0!==c?c:"",IsSecured:null!==(d=null===(p=e.attributes)||void 0===p?void 0:p.IsSecured)&&void 0!==d&&d,SourceType:null!==(f=null===(h=e.attributes)||void 0===h?void 0:h.SourceType)&&void 0!==f?f:-1,IsReadable:null===(m=null===(y=e.attributes)||void 0===y?void 0:y.IsReadable)||void 0===m||m,IsEditable:!this.gridHostProps.forceReadonly&&(null!==(v=null===(g=e.attributes)||void 0===g?void 0:g.IsEditable)&&void 0!==v&&v),IsMetadataEditable:!1,HideMove:!this.gridHostProps.enableMoveMenu,HidePin:!this.gridHostProps.enablePinMenu,HideChangeVisibility:!this.gridHostProps.enableChangeVisibilityMenu,HideHeaderMenu:!this.gridHostProps.showColumnHeaderMenu},E),alias:e.displayName,order:e.order-1,isPrimary:null!==(O=e.isPrimary)&&void 0!==O?O:1===e.order,dataType:E.Type,isHidden:!1})})})}_isVisibleColumn(e){return!e.isHidden&&-1!==e.order}}},9008:function(e,t,r){"use strict";r.r(t),r.d(t,"getStyles",(function(){return n}));var n=()=>({root:{height:"100%",width:"100%"},statusContainer:{display:"flex",alignItems:"center",justifyContent:"center"},icon:{fontSize:"28px"}})},9009:function(e,t,r){"use strict";r.r(t),r.d(t,"Signal",(function(){return n}));class n extends class{constructor(){var e=this;this.listeners=[],this.dispatch=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return e.listeners.map(e=>e(...r))},this.addListener=e=>{this.listeners.push(e)},this.removeListener=e=>{var t=this.listeners.indexOf(e);-1!==t&&this.listeners.splice(t,1)}}}{}},9010:function(e,t,r){"use strict";r.r(t),r.d(t,"UserConfigurationManager",(function(){return s}));var n=r(8988);function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class s{constructor(e,t){this._dataSet=e,this._stateFunctions=t,this._userConfiguration={},this.onConfigurationUpdated=e=>{var t,r=!1;if(e.columns&&null!==(t=this._userConfiguration)&&void 0!==t&&t.columns)for(var n of Object.values(null===(a=this._userConfiguration)||void 0===a?void 0:a.columns)){var a;e.columns.hasOwnProperty(n.logicalName)&&(r=this.mergeColumnConfig(this._userConfiguration.columns[n.logicalName],e.columns[n.logicalName]))}else if(e.visibleOrderedColumns){this.visibleOrderedColumnsDifferent(this._userConfiguration.visibleOrderedColumns,e.visibleOrderedColumns)&&(this._userConfiguration.visibleOrderedColumns=Object.values(e.visibleOrderedColumns),r=!0)}else void 0!==e.jumpBarButton&&this._userConfiguration.jumpBarButton!==e.jumpBarButton&&(this._userConfiguration.jumpBarButton=e.jumpBarButton,r=!0);r&&this.generateNewObject()},this.load(),this.generateInitialColumnConfigs(),this.handleDataSetFilter()}get userConfiguration(){return this._userConfiguration}updateDataSet(e){this._dataSet=e,this.generateInitialColumnConfigs()&&this.generateNewObject()}save(){var e;this._stateFunctions.setPreservedState&&(this._stateFunctions.setPreservedState("UserConfiguration",this._userConfiguration),this._stateFunctions.setPreservedState("ActiveViewId",null===(e=this._dataSet)||void 0===e?void 0:e.getViewId()))}load(){if(this._stateFunctions.getPreservedState){var e=this._stateFunctions.getPreservedState("UserConfiguration"),t=this._dataSet.getViewId(),r=this._stateFunctions.getPreservedState("ActiveViewId");!e||t&&r&&t!==r||(this._userConfiguration=e)}}handleDataSetFilter(){var e;if(null===(e=this._dataSet.filtering)||void 0===e||!e.getFilter()){var t,r={jumpBarButton:0};this._dataSet.columns.forEach(e=>{r.columns||(r.columns={}),r.columns[e.name]={config:{filter:void 0},updatedProps:["jumpBarFilter"]}}),null===(t=this.onConfigurationUpdated)||void 0===t||t.call(this,r)}}generateInitialColumnConfigs(){var e,t,r=!1;for(var a of(this._userConfiguration.columns||(this._userConfiguration.columns={}),null!==(e=this._dataSet)&&void 0!==e&&null!==(t=e.columns)&&void 0!==t&&t.length&&this._dataSet.columns.forEach(e=>{var t={logicalName:e.name,dataType:e.attributes?Object(n.getDataTypeMap)(e.attributes):"Text",displayName:e.displayName};this._userConfiguration.columns[e.name]?this._userConfiguration.columns[e.name].logicalName===t.logicalName&&this._userConfiguration.columns[e.name].dataType===t.dataType&&this._userConfiguration.columns[e.name].displayName===t.displayName||(this._userConfiguration.columns[e.name]=i(i({},this._userConfiguration.columns[e.name]),t),r=!0):(this._userConfiguration.columns[e.name]=t,r=!0),void 0===this._userConfiguration.columns[e.name].width&&e.visualSizeFactor>1&&(this._userConfiguration.columns[e.name].width=e.visualSizeFactor,r=!0)}),this._dataSet.sorting)){var o=this._userConfiguration.columns[a.name];o&&o.sorting!==a.sortDirection&&(o.sorting=a.sortDirection,r=!0)}return r}mergeColumnConfig(e,t){var r=!1;if(t&&t.config&&t.updatedProps&&t.updatedProps.length>0)for(var n of t.updatedProps)void 0!==t.config[n]?t.config[n]!==e[n]&&(e[n]=t.config[n],r=!0):(delete e[n],r=!0);return r}visibleOrderedColumnsDifferent(e,t){if(e===t)return!1;if(!!e!=!!t)return!0;if(e.length!==t.length)return!0;for(var r=0;r<t.length;r++)if(e[r]!==t[r])return!0;return!1}generateNewObject(){this._userConfiguration=i({},this._userConfiguration)}}},9011:function(e,t,r){"use strict";r.r(t),r.d(t,"DataSetList",(function(){return v}));var n=r(245),a=r(8082),i=r(9012),o=r(9027),s=r(9029),u=r(9031),c=r(9033),l=r(8987);function d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function p(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?d(Object(r),!0).forEach((function(t){f(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function f(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var h=e=>{var{canExecute:t,commandId:r,execute:n,label:a}=e;return{disabled:!t,key:r,onClick:n,text:a}},m=e=>n.createElement(u.Initials,{text:null==e?void 0:e.details[0]}),y={cancelSelection:"Cancel selection",moreCommands:"More commands",noItems:"No data available",select:"Select"};class v extends n.Component{constructor(e){var t,r;super(e),this._dataProvider=void 0,this._strings=void 0,this._onDataSetUpdated=e=>{this._dataProvider.datasetUpdated(e),this._exitSelectionMode(),this._clearCommandCache()},this._onContextMenuOpened=e=>{var t=e.key;this.state.cachedItemCommands.get(t)||this._dataProvider.getRowCommands(t).then(e=>{var r=e.map(h),n=new Map(this.state.cachedItemCommands);n.set(t,r),this.setState({cachedItemCommands:n})})},this._onListItemClick=e=>{this._dataProvider.primaryRecordNavigation({[a.RECID]:e.key})},this._onSelectionChange=e=>{var t=e.map(e=>({[a.RECID]:e}));this._dataProvider.setSelectedRecords(t),this.setState({selectedRowsCount:t.length})},this._onSelectionModeChange=e=>{e||(this._dataProvider.clearSelectedRecords(),this.setState({selectedRowsCount:0})),this.setState({selectionMode:e})};var{dataSet:n,events:i,configuration:s}=this.props;this.state={cachedItemCommands:new Map,selectionMode:!1,selectedRowsCount:0},this._dataProvider=new o.DataSetListDataProvider(n,{telemetryProvider:s.telemetryProvider}),this._strings=p(p({},y),null===(t=s.localizedStrings)||void 0===t?void 0:t.selectableListStrings),null==i||null===(r=i.onDataSetUpdated)||void 0===r||r.addListener(this._onDataSetUpdated)}render(){var e,t,r=!this.props.disableFooter;return n.createElement("div",{"data-id":"grid-container","data-type":"list",style:c.listRootStyles},n.createElement(i.SelectableList,{items:this._getItems(),onSelectionChange:this._onSelectionChange,onSelectionModeChange:this._onSelectionModeChange,selectionMode:this.state.selectionMode,strings:this._strings,styles:c.selectableListStyles}),r&&n.createElement(s.PagingPanel,{currentPageNumber:this._dataProvider.currentPageNumber,gridTotalRecordCountLimit:this.props.totalRecordsLimit||l.DEFAULT_MAX_RECORD_COUNT,localizedStrings:null===(e=this.props.configuration)||void 0===e||null===(t=e.localizedStrings)||void 0===t?void 0:t.pagingPanelStrings,nextPageEnable:this._dataProvider.hasNextPage,onFirstPage:()=>this._dataProvider.loadExactPage(1),onNextPage:()=>this._dataProvider.nextPage(),onPreviousPage:()=>this._dataProvider.previousPage(),pageSize:this._dataProvider.pageSize,pagingPanelHeight:40,previousPageEnable:this._dataProvider.hasPreviousPage,selectedRowsCount:this.state.selectedRowsCount,styles:c.pagingPanelStyles,totalRowsCount:this._dataProvider.totalRowsCount}))}componentWillUnmount(){var e,t;this._dataProvider.clearSelectedRecords(),null===(e=this.props.events)||void 0===e||null===(t=e.onDataSetUpdated)||void 0===t||t.removeListener(this._onDataSetUpdated)}_clearCommandCache(){this.setState({cachedItemCommands:new Map})}_getItems(){var e=[];return this._dataProvider.columns.forEach(t=>{t.displayName&&(t.isPrimary?e.unshift(t.name):e.length<3&&e.push(t.name))}),e=e.slice(0,3),this._dataProvider.currentPage.map(t=>{var r=t[a.RECID];return{commands:this.state.cachedItemCommands.get(r),details:e.map(e=>t[e]),key:r,onClick:this._onListItemClick,onContextMenuOpened:this._onContextMenuOpened,onRenderImage:m,styles:c.itemStyles}})}_exitSelectionMode(){this.state.selectionMode&&(this._dataProvider.clearSelectedRecords(),this.setState({selectionMode:!1}))}}},9012:function(e,t,r){"use strict";r.r(t);var n=r(9013);r.d(t,"Pager",(function(){return n.Pager}));r(9014);var a=r(9015);r.d(t,"SelectableList",(function(){return a.SelectableList}));r(9026)},9013:function(e,t,r){"use strict";r.r(t),r.d(t,"Pager",(function(){return u}));var n=r(245),a=r(684),i=r(1837),o={flex:"0 0 auto"},s=e=>{var{currentPage:t,onRequestPage:r,strings:s,totalPages:u}=e,c=s.pageTemplate.replace("{0}",(t+1).toString());return n.createElement(n.Fragment,null,n.createElement(a.IconButton,{ariaLabel:s.firstPage,disabled:0===t,iconProps:{iconName:"Previous"},onClick:()=>r(0),styles:{root:o}}),n.createElement(a.IconButton,{ariaLabel:s.previousPage,disabled:0===t,iconProps:{iconName:"Back"},onClick:()=>r(t-1),styles:{root:o}}),n.createElement("div",{style:o},n.createElement(i.Text,null,c)),n.createElement(a.IconButton,{ariaLabel:s.nextPage,disabled:t+1===u,iconProps:{iconName:"Forward"},onClick:()=>r(t+1),styles:{root:o}}))},u=e=>{var t,{statusMessage:r,styles:a,totalPages:o=1}=e,u=Object.assign({display:"flex",alignItems:"center",padding:"4px 8px"},null!==(t=null==a?void 0:a.root)&&void 0!==t?t:{});return n.createElement("div",{style:u},n.createElement("div",{style:{flex:"1 1 auto"}},n.createElement(i.Text,null,r)),o>1&&n.createElement(s,e))}},9014:function(e,t,r){"use strict";r.r(t)},9015:function(e,t,r){"use strict";r.r(t),r.d(t,"SelectableList",(function(){return y}));var n=r(245),a=r(1259),i=r(9016),o=r(9017),s=r(9019),u=r(9023),c=r(9025);function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){p(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function p(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var f=Object(a.classNamesFunction)(),h=0;class m extends n.Component{constructor(e){super(e),this._id=void 0,this._focusTimeoutId=-1,this._fluentListRef=null,this._listOptionIndexToInitRovingFocus=-1,this._setFocusAfterChangingSelectionMode=!1,this._onListRendered=()=>{this._initListOptionTabIndexIfNeeded(),this._setFocusIfUserChangedSelectionMode()},this._onRenderCell=(e,t)=>{if(!e||void 0===t)return null;var{onSelectionChange:r,selectionMode:a,strings:i,total:o}=this.props,c=this.state.selectedItemKeys,l=this._getMainContentId(t);return a?n.createElement(u.ListOption,{index:t,item:e,mainContentId:l,onClick:()=>{var t=new Set(this.state.selectedItemKeys);t.has(e.key)?t.delete(e.key):t.add(e.key),this.setState({selectedItemKeys:t}),r([...t])},selected:c.has(e.key),strings:i,total:o}):n.createElement(s.ListItem,{index:t,item:d(d({},e),{},{commands:[this._createSelectCommand(t,e.key),...e.commands||[]]}),mainContentId:l,strings:i,total:o})},this._onKeyDown=e=>{var t,r=Object(i.findFluentListItemIndex)(e.currentTarget,e.target);if(-1!==r){var n=Object(i.nextListIndexToFocus)(r,e.key,this.props.items.length);-1!==n&&(e.preventDefault(),e.stopPropagation(),null===(t=this._fluentListRef)||void 0===t||t.scrollToIndex(n),window.clearTimeout(this._focusTimeoutId),this._focusTimeoutId=window.setTimeout(()=>{var e,t=null;if(this.props.selectionMode){var a;t=Object(i.findOptionElement)(this._id,n);var o=Object(i.findOptionElement)(this._id,r);null==o||o.removeAttribute("tabindex"),null===(a=t)||void 0===a||a.setAttribute("tabindex","0")}else t=Object(i.findFirstTabbableElementInListItem)(this._id,n);null===(e=t)||void 0===e||e.focus()},10))}},this._id="image-details-commands-list-".concat(++h),this.state={selectedItemKeys:new Set}}render(){var{items:e,onSelectionModeChange:t,selectionMode:r,strings:i,styles:s}=this.props,u=f(s);return n.createElement("div",{className:u.root},n.createElement(o.ListHeader,{onExitSelectionMode:()=>{t(!1),this._setFocusAfterChangingSelectionMode=!0},selectionMode:r,strings:i}),e.length?n.createElement(a.List,{getKey:e=>e.key,id:this._id,items:e,onKeyDown:this._onKeyDown,onPagesUpdated:this._onListRendered,onRenderCell:this._onRenderCell,ref:e=>this._fluentListRef=e,role:r?"listbox":"list"}):i.noItems&&n.createElement("div",{className:u.emptyContainer},i.noItems))}componentDidMount(){this.props.selectionMode&&(this._listOptionIndexToInitRovingFocus=0)}componentDidUpdate(e,t){var r,n=e.selectionMode!==this.props.selectionMode;(n&&(this.props.selectionMode?this._listOptionIndexToInitRovingFocus<0&&(this._listOptionIndexToInitRovingFocus=0):(this._listOptionIndexToInitRovingFocus=-1,this.setState({selectedItemKeys:new Set}))),n||t.selectedItemKeys!==this.state.selectedItemKeys)&&(null===(r=this._fluentListRef)||void 0===r||r.forceUpdate())}componentWillUnmount(){window.clearTimeout(this._focusTimeoutId)}_initListOptionTabIndexIfNeeded(){if(this.props.selectionMode&&this._listOptionIndexToInitRovingFocus>=0){var e=Object(i.findOptionElement)(this._id,this._listOptionIndexToInitRovingFocus);null==e||e.setAttribute("tabindex","0"),this._listOptionIndexToInitRovingFocus=-1}}_setFocusIfUserChangedSelectionMode(){var e;this._setFocusAfterChangingSelectionMode&&(null===(e=this.props.selectionMode?Object(i.findTabbableOptionElement)(this._id):Object(i.findFirstTabbableElementInListItem)(this._id,0))||void 0===e||e.focus(),this._setFocusAfterChangingSelectionMode=!1)}_getMainContentId(e){return"".concat(this._id,"-").concat(e)}_createSelectCommand(e,t){var{onSelectionChange:r,onSelectionModeChange:n,strings:a}=this.props;return{key:"select",iconProps:{"aria-hidden":!0,iconName:"MultiSelect"},text:a.select,onClick:()=>{this._listOptionIndexToInitRovingFocus=e,this._setFocusAfterChangingSelectionMode=!0,n(!0);var a=new Set(this.state.selectedItemKeys);a.add(t),this.setState({selectedItemKeys:a}),r([...a])}}}}var y=Object(a.styled)(m,c.getStyles)},9016:function(e,t,r){"use strict";r.r(t),r.d(t,"findFluentListItemIndex",(function(){return n})),r.d(t,"findOptionElement",(function(){return a})),r.d(t,"findTabbableOptionElement",(function(){return i})),r.d(t,"findFirstTabbableElementInListItem",(function(){return o})),r.d(t,"nextListIndexToFocus",(function(){return s}));var n=(e,t)=>{var r=-1;if(!e.contains(t))return-1;for(;t&&t!==e;){var n=t.getAttribute("data-list-index");n&&(r=parseInt(n,10)),t=t.parentElement}return r},a=(e,t)=>document.querySelector("#".concat(e,' [data-list-index="').concat(t,'"] [role="option"]')),i=e=>document.querySelector("#".concat(e,' [role="option"][tabindex="0"]')),o=(e,t)=>{var r=document.querySelector("#".concat(e,' [data-list-index="').concat(t,'"]'));return r?r.querySelector('button,a,input,textarea,select,[tabindex="0"]'):null},s=(e,t,r)=>{var n=null;switch(t){case"ArrowDown":n=e+1;break;case"ArrowUp":n=e-1;break;case"PageDown":n=e+10;break;case"PageUp":n=e-10;break;case"Home":n=0;break;case"End":n=r-1}return null===n||e===(n=Math.min(Math.max(0,n),r-1))?-1:n}},9017:function(e,t,r){"use strict";r.r(t),r.d(t,"ListHeader",(function(){return o}));var n=r(245),a=r(684),i=r(9018),o=e=>{var{onExitSelectionMode:t,selectionMode:r,strings:o}=e;return r?n.createElement("div",{className:i.rootClassName},n.createElement(a.DefaultButton,{text:o.cancelSelection,onClick:t,styles:i.buttonStyles})):null}},9018:function(e,t,r){"use strict";r.r(t),r.d(t,"rootClassName",(function(){return a})),r.d(t,"buttonStyles",(function(){return i}));var n=r(1259),a=Object(n.mergeStyles)({flex:"0 0 auto",display:"flex",justifyContent:"flex-end"}),i={root:{height:"auto",margin:"8px 22px",minHeight:32},rootFocused:{outlineOffset:"-4px",".ms-Fabric--isFocusVisible &:focus":{outline:"1px dotted #666"},"::after":{display:"none"},":active":{backgroundColor:"#d8d8d8"}},rootHovered:{backgroundColor:"#d8d8d8"}}},9019:function(e,t,r){"use strict";r.r(t),r.d(t,"ListItem",(function(){return d}));var n=r(245),a=r(1259),i=r(9020),o=r(9021);function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){c(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var l=e=>{var t,r=null!==(t=e.itemProps)&&void 0!==t&&t.styles?Object(a.concatStyleSets)(i.contextMenuItemStyles,e.itemProps.styles):i.contextMenuItemStyles;return u(u({},e),{},{itemProps:u(u({},e.itemProps),{},{styles:r})})},d=e=>{var{index:t,item:r,mainContentId:s,strings:c,total:d}=e,{commands:p=[],href:f,onClick:h,onContextMenuOpened:m,styles:y,virtualIndex:v}=r,g=null==y?void 0:y.contextMenu,O=g?u(u({},i.contextMenuStyles),{},{root:g}):i.contextMenuStyles;return n.createElement("div",{className:i.listItemClassName,role:"listitem","aria-posinset":v,"aria-setsize":d},n.createElement(a.Link,{href:f,onClick:()=>null==h?void 0:h(r),role:"link",styles:i.linkStyles},n.createElement(o.MainContent,{htmlId:s,index:t,item:r,styles:y})),n.createElement(a.IconButton,{"aria-describedby":s,ariaLabel:c.moreCommands,iconProps:{iconName:"More"},menuProps:{items:p.map(l),onMenuOpened:()=>null==m?void 0:m(r),styles:O},styles:i.iconButtonStyles}))}},9020:function(e,t,r){"use strict";r.r(t),r.d(t,"listItemClassName",(function(){return s})),r.d(t,"iconWidth",(function(){return u})),r.d(t,"iconStyle",(function(){return c})),r.d(t,"focusOutline",(function(){return l})),r.d(t,"iconButtonStyles",(function(){return d})),r.d(t,"linkStyles",(function(){return p})),r.d(t,"contextMenuItemStyles",(function(){return f})),r.d(t,"contextMenuStyles",(function(){return h}));var n=r(1259);function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var s=Object(n.mergeStyles)({position:"relative"}),u=32,c={color:"#323130",display:"block",position:"absolute",right:14,textAlign:"center",top:5,width:u},l="1px dotted #666",d={root:i(i({},c),{},{transform:"rotate(90deg)"}),rootExpanded:{color:"#323130",backgroundColor:"#d8d8d8"},rootFocused:{".ms-Fabric--isFocusVisible &:focus":{outline:l},"::after":{display:"none"},":active":{color:"#323130",backgroundColor:"#d8d8d8"}},rootHovered:{color:"#323130",backgroundColor:"#d8d8d8"},menuIcon:{display:"none"}},p={root:{borderBottom:0,color:"inherit",display:"block",width:"100%",":hover,:active,:hover:active":{textDecoration:"none"},".ms-Fabric--isFocusVisible &:focus":{outlineOffset:-2,outline:l,boxShadow:"none"}}},f={icon:{color:"inherit",fontSize:14,margin:0,paddingInlineEnd:10,width:14,"&.ms-ContextualMenu-icon":{fontSize:14,width:14}},label:{margin:0,whiteSpace:"normal",overflowWrap:"break-word"},root:{height:"auto",margin:"2px 0",padding:"0 10px",lineHeight:"2em",color:"#333",":hover,:active":{backgroundColor:"#d8d8d8"},".ms-Fabric--isFocusVisible &:focus":{outline:l},":focus::after":{display:"none"}}},h={container:null,header:{},list:{padding:"8px 0"},root:{},subComponentStyles:{callout:{},menuItem:{}},title:{}}},9021:function(e,t,r){"use strict";r.r(t),r.d(t,"MainContent",(function(){return s}));var n=r(245),a=r(1259),i=r(9022),o=Object(a.classNamesFunction)(),s=Object(a.styled)(e=>{var{htmlId:t,index:r,item:s,selected:u,styles:c}=e,{details:l,imageUrl:d,onRenderImage:p}=s,f=o(c,{index:r,selected:u}),h=p?p(s):n.createElement("img",{alt:"",className:i.imageClassName,src:d});return n.createElement("div",{className:f.mainContent,id:t},n.createElement("div",{className:f.imageContainer},h),n.createElement("div",{className:f.detailsContainer},n.createElement(a.Text,{block:!0,nowrap:!0},l[0]),n.createElement(a.Text,{block:!0,nowrap:!0},l[1]),n.createElement(a.Text,{block:!0,nowrap:!0},l[2])))},i.getStyles)},9022:function(e,t,r){"use strict";r.r(t),r.d(t,"getStyles",(function(){return i})),r.d(t,"imageClassName",(function(){return o}));var n=r(1259),a=r(9020),i=e=>({detailsContainer:{overflowX:"hidden"},imageContainer:{flex:"0 0 auto",width:"35px",paddingInlineEnd:"14px",position:"relative"},mainContent:{display:"flex",alignItems:"center",padding:"5px ".concat(14,"px"),paddingInlineEnd:"".concat(11+a.iconWidth+14,"px"),lineHeight:"".concat(1.5,"em"),minHeight:"".concat(4.5,"em"),borderTop:e.index>0?"1px solid #d8d8d8":void 0,cursor:"pointer",color:"#333",backgroundColor:e.selected?"#eaeaea":void 0,":hover":{backgroundColor:"#d8d8d8"}}}),o=Object(n.mergeStyles)({width:"100%",objectFit:"contain"})},9023:function(e,t,r){"use strict";r.r(t),r.d(t,"ListOption",(function(){return s}));var n=r(245),a=r(1259),i=r(9024),o=r(9021),s=e=>{var{index:t,item:r,mainContentId:s,onClick:u,selected:c,total:l}=e,{styles:d,virtualIndex:p}=r,f=c?"CheckboxComposite":"Checkbox";return n.createElement("div",{className:i.listOptionClassName,"aria-posinset":p,"aria-selected":c,"aria-setsize":l,role:"option",onClick:u,onKeyDown:e=>{var t=e.key;"Enter"!==t&&" "!==t||(e.preventDefault(),e.stopPropagation(),u())}},n.createElement(o.MainContent,{htmlId:s,index:t,item:r,selected:c,styles:d}),n.createElement(a.Icon,{"aria-hidden":!0,iconName:f,styles:i.inertIconStyles}))}},9024:function(e,t,r){"use strict";r.r(t),r.d(t,"inertIconStyles",(function(){return u})),r.d(t,"listOptionClassName",(function(){return c}));var n=r(1259),a=r(9020);function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){s(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var u={root:o(o({},a.iconStyle),{},{fontSize:14,marginTop:10,pointerEvents:"none"})},c=Object(n.mergeStyles)({position:"relative",".ms-Fabric--isFocusVisible &:focus":{outline:a.focusOutline,outlineOffset:-2}})},9025:function(e,t,r){"use strict";r.r(t),r.d(t,"getStyles",(function(){return n}));var n=()=>({emptyContainer:{alignItems:"center",display:"flex",flex:"1 0 auto",justifyContent:"center",padding:12,textAlign:"center","&:empty":{padding:0}},root:{display:"flex",flexDirection:"column"}})},9026:function(e,t,r){"use strict";r.r(t)},9027:function(e,t,r){"use strict";r.r(t),r.d(t,"DataSetListDataProvider",(function(){return u}));var n=r(8082),a=r(8988),i=r(9028),o=r(8986);function s(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}class u{get pageSize(){return this._pageSize}get currentPageNumber(){return this._dataSet.paging&&null!==this._dataSet.paging.pageNumber&&void 0!==this._dataSet.paging.pageNumber&&(this._currentPageNumber=this._dataSet.paging.pageNumber),this._currentPageNumber}get totalRowsCount(){return this._dataSet.paging.totalResultCount}get totalPageCount(){return Math.floor(this.totalRowsCount/this.pageSize)}get columns(){return this._columnDefs}get currentPage(){return this._generateRowData()}get hasNextPage(){return this._dataSet.paging.hasNextPage}get hasPreviousPage(){return this._dataSet.paging.hasPreviousPage}get isLoadDataPending(){return!(!this._dataSet.loading&&!this._pageLoadTimeoutId)}constructor(e,t){this._dataSet=e,this._config=t,this._pageSize=-1,this._pageLoadTimeoutId=null,this._completeFn=void 0,this._rejectFn=void 0,this._columnDefs=[],this._currentPageNumber=1,this._init(this._dataSet),this._pageSize=this._dataSet.paging.pageSize}nextPage(){var e=this._validatePageNavigation(this._dataSet.paging.hasNextPage);return e||this.loadExactPage(this.currentPageNumber+1)}previousPage(){var e=this._validatePageNavigation(this._dataSet.paging.hasPreviousPage);return e||this.loadExactPage(this.currentPageNumber-1)}loadExactPage(e){var t=this._validatePageNavigation(!0);if(t)return t;var r=this._createDataLoadPromise();return this._pageLoadTimeoutId=window.setTimeout(()=>{this._rejectPendingDataLoad(i.DataProviderError.loadTimeout,"Page load timeout.")},2e4),this._dataSet.paging.loadExactPage(e),r}datasetUpdated(e){this._init(e),this._dataSet.loading||(this._pageLoadTimeoutId&&(clearTimeout(this._pageLoadTimeoutId),this._pageLoadTimeoutId=null),this._completePendingDataLoad(this._generateRowData()))}clearSelectedRecords(){this._dataSet.clearSelectedRecordIds()}setSelectedRecords(e){var t=e.map(e=>e[n.RECID]);this._dataSet.setSelectedRecordIds(t)}getSelectedRecordIds(){return this._dataSet.getSelectedRecordIds()}primaryRecordNavigation(e){var t=this._dataSet.records[e[n.RECID]];this._dataSet.openDatasetItem(t.getNamedReference())}getRowCommands(e){var t,r=this;return(t=function*(){return r._dataSet.retrieveRecordCommand([e],void 0,void 0,!0).then(e=>e.filter(e=>e.shouldBeVisible&&("Button"===e.controlType||"SplitButton"===e.controlType)))},function(){var e=this,r=arguments;return new Promise((function(n,a){var i=t.apply(e,r);function o(e){s(i,n,a,o,u,"next",e)}function u(e){s(i,n,a,o,u,"throw",e)}o(void 0)}))})()}_validatePageNavigation(e){return this.isLoadDataPending?Promise.reject(i.DataProviderError.loadDataPending):e?null:Promise.reject(i.DataProviderError.noPage)}_completePendingDataLoad(e){this._completeFn&&(this._completeFn(e),this._completeFn=void 0,this._rejectFn=void 0)}_rejectPendingDataLoad(e,t){var r;this._rejectFn&&(null===(r=this._config.telemetryProvider)||void 0===r||r.sendErrorEvent(o.telemetryKeys.loadData,{}),this._completeFn=void 0,this._pageLoadTimeoutId=null,this._rejectFn(e),this._rejectFn=void 0)}_createDataLoadPromise(){return new Promise((e,t)=>{this._completeFn=e,this._rejectFn=t})}_generateRowData(){var{records:e,columns:t}=this._dataSet;if(!t)return[];for(var r=[],a=this._dataSet.sortedRecordIds,i=0;i<a.length;i++){var o=a[i],s={[n.RECID]:o,params:{navigation:{},cellImageInfo:{}}};for(var u of t){var c,l;s[u.name]=null===(c=(l=e[o]).getFormattedValue)||void 0===c?void 0:c.call(l,u.name)}r.push(s)}return r}_generateColumnDefs(e){var t;if(null==e||null===(t=e.columns)||void 0===t||!t.length)return[];var r=[],n=e.columns.filter(e=>this._isVisibleColumn(e)).sort(c);for(var i of n){var{name:o,displayName:s,isPrimary:u,attributes:l}=i,d={name:o,displayName:s,isPrimary:!!u,dataType:Object(a.getDataTypeMap)(l)};r.push(d)}return r}_isVisibleColumn(e){return!e.isHidden&&-1!==e.order}_init(e){this._dataSet=e,this._columnDefs=this._generateColumnDefs(e)}}var c=(e,t)=>e.order-t.order},9028:function(e,t,r){"use strict";var n;r.r(t),r.d(t,"DataProviderError",(function(){return n})),function(e){e[e.noPage=0]="noPage",e[e.loadDataPending=1]="loadDataPending",e[e.loadTimeout=2]="loadTimeout"}(n||(n={}))},9029:function(e,t,r){"use strict";r.r(t),r.d(t,"PagingPanel",(function(){return f}));var n=r(245),a=r(1259),i=r(9030),o=r(8998);function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){c(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var l=Object(a.classNamesFunction)(),d={firstPage:"Load first page",nextPage:"Next page",page:"Page {0}",prevPage:"Previous page",records:"{0} - {1} of {2}",selected:"{0} Selected"};class p extends n.PureComponent{constructor(e){super(e),this._localizedStrings=void 0,this.state={selectedRowsCount:0},this._localizedStrings=u(u({},d),this.props.localizedStrings)}render(){var{currentPageNumber:e,gridTotalRecordCountLimit:t,onFirstPage:r,onNextPage:i,onPreviousPage:s,pageSize:u,pagingPanelHeight:c,selectedRowsCount:d,styles:p,theme:f,totalRowsCount:h}=this.props,m=h<0,y=m?t:h,v=(e-1)*u,g=Math.min(v+u,y),O=Object(o.formatString)(this._localizedStrings.records,(y?v+1:0).toString(),g.toString(),"".concat(y).concat(m?"+":"")),E=Object(o.formatString)(this._localizedStrings.selected,d.toString()),b=d?"".concat(O," (").concat(E,")"):O,T=Object(o.formatString)(this._localizedStrings.page,e.toString()),S=l(p,{theme:f,pagingPanelHeight:c});return n.createElement("div",{className:S.pagingContainer},n.createElement(a.Text,{className:S.statusContainer},b),n.createElement("div",{className:S.pagingButtonsContainer},n.createElement(a.Link,{"aria-label":this._localizedStrings.firstPage,className:S.pagingButton,disabled:1===this.props.currentPageNumber,onClick:r},n.createElement(a.Icon,{iconName:"Previous"})),n.createElement(a.Link,{"aria-label":this._localizedStrings.prevPage,className:S.pagingButton,disabled:!this.props.previousPageEnable,onClick:s},n.createElement(a.Icon,{iconName:"Back"})),n.createElement(a.Text,{className:S.pageNumberLabel},T),n.createElement(a.Link,{"aria-label":this._localizedStrings.nextPage,className:S.pagingButton,disabled:!this.props.nextPageEnable,onClick:i},n.createElement(a.Icon,{iconName:"Forward"}))))}}var f=Object(a.styled)(p,i.getStyles,void 0,void 0,!0)},9030:function(e,t,r){"use strict";r.r(t),r.d(t,"getStyles",(function(){return n}));var n=e=>{var{pagingPanelHeight:t}=e;return{pagingContainer:{flex:"1 1 auto",display:"flex",flexDirection:"row",justifyContent:"space-between",alignContent:"stretch",alignItems:"center",height:t,textAlign:"center",paddingLeft:20,paddingRight:20,fontSize:12},pagingButtonsContainer:{display:"flex",flex:"0 1 auto",flexDirection:"row",alignItems:"center",alignContent:"stretch",justifyContent:"space-between",height:"100%"},statusContainer:{flex:"0 1 auto",marginLeft:8,marginRight:8,fontSize:"inherit"},pagingButton:{flex:"0 1 auto",fontWeight:400,marginLeft:8,marginRight:8,height:"100%",userSelect:"none",fontSize:"inherit"},pageNumberLabel:{flex:"0 1 auto",minWidth:20,marginLeft:8,marginRight:8,fontSize:"inherit"}}}},9031:function(e,t,r){"use strict";r.r(t),r.d(t,"getInitials",(function(){return s})),r.d(t,"Initials",(function(){return l}));var n=r(245),a=r(1259),i=r(9032),o=/[a-zA-Z]/,s=e=>{if(!e)return"";var t=e.split(" ").filter(e=>e.length);if(!t.length)return"";var r=t[0][0];return o.test(r)?1===t.length?t[0].slice(0,2):r+t[1][0]:r},u=["#005C62","#358717","#725A0D","#A42B1A","#652F4E","#6A1E7A","#315FA2"],c=Object(a.classNamesFunction)(),l=Object(a.styled)(e=>{var{styles:t,text:r}=e,a=s(r),i=(e=>{var t=u[0];if(e){for(var r=0,n=e.length-1;n>=0;n--){var a=e.charCodeAt(n),i=n%8;r^=(a<<i)+(a>>8-i)}t=u[r%u.length]}return t})(r),o=c(t,{backgroundColor:i});return n.createElement("div",{className:o.root,"aria-hidden":!0},a)},i.getStyles,void 0,void 0,!0)},9032:function(e,t,r){"use strict";r.r(t),r.d(t,"getStyles",(function(){return n}));var n=e=>{var{backgroundColor:t}=e;return{root:{backgroundColor:t,borderRadius:"50%",color:"#fff",fontSize:"16px",lineHeight:"35px",height:"35px",textAlign:"center",width:"35px"}}}},9033:function(e,t,r){"use strict";r.r(t),r.d(t,"itemStyles",(function(){return n})),r.d(t,"listRootStyles",(function(){return a})),r.d(t,"pagingPanelStyles",(function(){return i})),r.d(t,"selectableListStyles",(function(){return o}));var n={contextMenu:{"& .ms-ContextualMenu-icon":{display:"none"}}},a={display:"flex",flexDirection:"column",height:"100%",width:"100%"},i={pagingContainer:{borderTop:"2px solid #d8d8d8",flex:"0 0 auto"}},o={root:{flex:"1 1 auto",overflowY:"auto"}}},9034:function(e,t,r){"use strict";r.r(t),r.d(t,"Footer",(function(){return d}));var n=r(1259),a=r(245),i=r.n(a),o=r(9035),s=r(9036),u=r(9040),c=Object(n.classNamesFunction)();class l extends i.a.PureComponent{render(){var{styles:e,theme:t,isJumpBarEnabled:r,jumpBarProps:a,pagingProps:o}=this.props,l=c(e,{theme:t}),d="".concat(l.rootPanel," ").concat(a.isMobileLayout?l.mobileLayout:l.tabletLayout);return void 0===o.rowsCount?i.a.createElement(n.Shimmer,{className:d}):i.a.createElement("div",{className:d},r&&i.a.createElement(s.JumpBarContainer,a),i.a.createElement(u.PagingPanel,o))}}var d=Object(n.styled)(l,o.getStyles,void 0,void 0,!0)},9035:function(e,t,r){"use strict";r.r(t),r.d(t,"getStyles",(function(){return n}));var n=()=>({rootPanel:{display:"flex",width:"100%",fontSize:"1rem"},tabletLayout:{flexDirection:"column"},mobileLayout:{flexDirection:"row"}})},9036:function(e,t,r){"use strict";r.r(t),r.d(t,"JumpBarContainer",(function(){return s}));var n=r(245),a=r(8990),i=r(9037),o=r(9039);class s extends n.PureComponent{constructor(){super(...arguments),this._localizedStrings={labels:["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],abcLabel:"ABC",allLabel:"All",numberLabel:"#"},this._onButtonClicked=(e,t)=>{var r;e!==this._localizedStrings.allLabel?(r=e===this._localizedStrings.numberLabel?{attributeName:"",source:"JumpBar",value:"[0-9]%",conditionOperator:a.ConditionOperator.Like}:{attributeName:"",source:"JumpBar",value:"".concat(e,"%"),conditionOperator:a.ConditionOperator.Like},this.props.onFilter(r,t)):this.props.onShowAll()}}render(){var{isMobileLayout:e,height:t,selectedButton:r,onShowAll:a,styles:s,theme:u,localizedStrings:c}=this.props,l={height:t,selectedButton:r,onShowAll:a,localizedStrings:c||this._localizedStrings,onButtonClicked:this._onButtonClicked,styles:s,theme:u};return e?n.createElement(i.JumpBarCallout,l):n.createElement(o.JumpBarPanel,l)}}},9037:function(e,t,r){"use strict";r.r(t),r.d(t,"JumpBarCallout",(function(){return u}));var n=r(1259),a=r(245),i=r(9038),o=Object(n.classNamesFunction)();class s extends a.Component{constructor(e){super(e),this._menuButtonElement=a.createRef(),this._onLinkClicked=(e,t)=>{this.props.onButtonClicked(e,t),this._onCalloutDismiss()},this._onShowMenuClicked=()=>{this.setState({isCalloutVisible:!this.state.isCalloutVisible})},this._onCalloutDismiss=()=>{this.setState({isCalloutVisible:!1})},this.state={isCalloutVisible:!1}}render(){var{styles:e,theme:t,height:r,localizedStrings:i,selectedButton:s}=this.props,u=o(e,{theme:t,height:r}),c=a.createElement("ul",{className:u.buttonsCalloutContainer},i.labels.map((e,t)=>{var i=t===s;return a.createElement("li",{key:t,className:u.filterButtonOuter,"data-id":"".concat(e,"_listitem")},a.createElement(n.Link,{key:t,style:{width:r},className:"".concat(u.filterButtonInner," ").concat(i&&u.selectedButton),onClick:()=>this._onLinkClicked(e,t),"data-id":"".concat(e,"_link")},e))}));return a.createElement("div",{className:u.rootMobileLayout},a.createElement("div",{ref:this._menuButtonElement},a.createElement(n.Link,{onClick:this._onShowMenuClicked,className:u.filterButtonOuter},i.abcLabel)),this.state.isCalloutVisible&&a.createElement(n.Callout,{className:u.calloutContainer,role:"dialog",gapSpace:0,target:this._menuButtonElement.current,onDismiss:this._onCalloutDismiss,setInitialFocus:!0},c))}}var u=Object(n.styled)(s,i.getStyles,void 0,void 0,!0)},9038:function(e,t,r){"use strict";r.r(t),r.d(t,"getStyles",(function(){return n}));var n=e=>{var{theme:t,height:r}=e;return{rootTabletLayout:{flex:"1 1 auto"},rootMobileLayout:{flex:"0 0 auto",paddingLeft:10},buttonsBarContainer:{display:"flex",flexDirection:"row",justifyContent:"space-around",width:"%100",fontSize:"1rem",height:r,alignContent:"stretch",alignItems:"center",textAlign:"center",background:t.palette.neutralLighter,paddingLeft:20,paddingRight:20,margin:0,listStyleType:"none"},buttonsCalloutContainer:{display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"space-around",width:300,fontSize:"1rem",height:400,alignContent:"stretch",alignItems:"center",textAlign:"center",background:t.palette.neutralLighter,paddingLeft:10,paddingRight:10,margin:0,listStyleType:"none"},filterButtonOuter:{flex:"1 1 auto",height:r},selectedButton:{borderBottomColor:t.palette.themePrimary,borderBottomWidth:"0.3rem"},filterButtonInner:{height:r,width:"100%",textAlign:"center",color:t.palette.neutralPrimary}}}},9039:function(e,t,r){"use strict";r.r(t),r.d(t,"JumpBarPanel",(function(){return u}));var n=r(1259),a=r(245),i=r(9038),o=Object(n.classNamesFunction)();class s extends a.PureComponent{render(){var{styles:e,theme:t,height:r,localizedStrings:i,onButtonClicked:s,selectedButton:u}=this.props,c=o(e,{theme:t,height:r}),l=[i.allLabel,i.numberLabel];return l.push(...i.labels),null!=t&&t.rtl&&l.reverse(),a.createElement("ul",{className:"".concat(c.buttonsBarContainer," ").concat(c.rootTabletLayout)},l.map((e,t)=>{var r=t===u;return a.createElement("li",{key:t,className:c.filterButtonOuter,"data-id":"".concat(e,"_listitem")},a.createElement(n.Link,{key:t,className:"".concat(c.filterButtonInner," ").concat(r&&c.selectedButton),onClick:()=>s(e,t),"data-id":"".concat(e,"_link")},e))}))}}var u=Object(n.styled)(s,i.getStyles,void 0,void 0,!0)},9040:function(e,t,r){"use strict";r.r(t),r.d(t,"PagingPanel",(function(){return o})),r.d(t,"styles",(function(){return s}));var n=r(245),a=r(8998),i=r(1259);class o extends n.PureComponent{render(){return n.createElement("p",{className:s.paging},Object(a.pluralizeString)(this.props.strings.rowsPlural,this.props.rowsCount||0))}}var s=Object(i.mergeStyleSets)({paging:{paddingLeft:24,paddingTop:16,paddingBottom:28,fontSize:14,lineHeight:20}})},9043:function(e,t,r){"use strict";function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function s(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function s(e){o(i,n,a,s,u,"next",e)}function u(e){o(i,n,a,s,u,"throw",e)}s(void 0)}))}}r.r(t),r.d(t,"MDLMetadataProvider",(function(){return u}));class u{constructor(e,t,r){var n=this;this.metadataClientPromise=e,this.metadataCache=t,this.instanceUrl=r,this.fetchExpandedEntity=function(){var e=s((function*(e,t,r){var a=yield n.metadataClientPromise,i=n.metadataCache.getFetchExpandedEntity(e,t);if(i)return i;var o=a.fetchExpandedEntity(e,t,r);return n.metadataCache.setFetchExpandedEntity(o,e,t),o}));return function(t,r,n){return e.apply(this,arguments)}}(),this.fetchMinimalEntity=function(){var e=s((function*(e,t){var r=yield n.metadataClientPromise,i=yield r.fetch("Entity",e,{expand:{Attributes:{}}},t);return a(a({},i),{},{Attributes:i.Attributes.filter(e=>e.LogicalName===i.PrimaryIdAttribute||e.LogicalName===i.PrimaryNameAttribute)})}));return function(t,r){return e.apply(this,arguments)}}(),this.subscribe=(e,t)=>{var r=e.logicalName;if(r){var n=u.listeners.get(this.instanceUrl);n||(n=new Map,u.listeners.set(this.instanceUrl,n)),n.set(r,[...n.get(r)||[],t])}},this.notifyEntityUpdate=e=>{var t=u.listeners.get(this.instanceUrl),r=null==t?void 0:t.get(e.logicalName);null==r||r.forEach(e=>e())},this.getFCBValue=function(){var e=s((function*(e,t){var r=yield n.metadataClientPromise;return!!(yield r.executeOperation("GetFeatureEnabledState","POST",{},{FeatureName:e},t)).IsFeatureEnabled}));return function(t,r){return e.apply(this,arguments)}}()}}u.listeners=new Map},9044:function(e,t,r){"use strict";r.r(t),r.d(t,"ModelDataProvider",(function(){return I}));var n=r(9045),a=r(9046),i=r(9080),o=r(9084),s=r(9286),u=r(9179),c=r(9287),l=r(9298),d=r(9300),p=r(9215),f=r(9292),h=r(9295),m=r(9184),y=r(9087),v=r(9297),g=r(9306),O=r(9307),E=r(9308),b=r(9317),T=r(9319),S=r(9321),C=r(9047),N=r(9324),_=r(9320);function R(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function P(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){R(i,n,a,o,s,"next",e)}function s(e){R(i,n,a,o,s,"throw",e)}o(void 0)}))}}class I{static getInstance(e,t){var r=I.getEnvironmentUri(e),n=I._instances[r];return n||(n=new I(e,t),I._instances[r]=n),n}constructor(e,t){this._store=void 0,this._traceManager=void 0,this._EventManager=void 0,this._configuration=void 0,this._userContext=null;var r=I.getEnvironmentUri(e);this._traceManager=new S.ModelTraceManager,this._EventManager=new b.ModelEventManager;var n=new E.ModelMetadataProvider(t),a=new g.ModelAuthenticationProvider,i=new N.StateProvider,o=new O.GarbageCollectionProvider;this._configuration={baseUri:r,MetadataProvider:n,AuthenticationProvider:a,GarbageCollectionProvider:o,StateProvider:i,useConsistencyStrong:!0,addStateCodeToGridData:!1};var s={DataLayerConfiguration:this._configuration,TraceManager:this._traceManager,EventManager:this._EventManager};this._store=i.initialize(s),n.initialize(this._store,s),a.initialize(s),o.initialize(this._store),v.QueryBuilderTelemetryHelper.tracer=this._traceManager.getTracer(v.QUERYBUILDER_TRACE_CATEGORY_ID)}getModernQueryBuilder(e,t){this.setCurrentContext(t);var r="<fetch mapping='logical'>"+"<entity name='".concat(e,"'>")+"</entity></fetch>";return f.ModernQueryBuilder.fromXml(r)}retrieveUserContext(e,t){var r=this;return P((function*(){var a,i,o=[];o.push({name:T.OPERATION_NAME,value:T.RETRIEVE_USER_CONTEXT}),o.push({name:T.REFRESH_CONTEXT,value:e}),o.push({name:T.CONTEXT_ID,value:(null==t?void 0:t.contextId)||n.UNKNOWN});var s=null===(a=(i=r._EventManager).getScenarioTracker)||void 0===a?void 0:a.call(i,C.ScenarioType.Load,T.MDLDATAPROVIDER_COMPONENT_RETRIEVE_USER_CONTEXT,o);try{if(r.setCurrentContext(t),e||!r._userContext){var u=yield r._store.dispatch(Object(l.retrieveUserContext)(e));r._userContext=u,o.push({name:T.IS_CACHED_RESPONSE,value:!1})}else o.push({name:T.IS_CACHED_RESPONSE,value:!0});return null==s||s.complete(o),r._userContext}catch(c){throw r.reportError(c,s,o),c}}))()}retrieveGridData(e,t){var r=this;return P((function*(){var a,i,o=[];o.push({name:T.OPERATION_NAME,value:T.RETRIEVE_GRID_DATA}),o.push({name:T.ENTITY_LOGICAL_NAME,value:(null==e?void 0:e.entityLogicalName)||n.UNKNOWN}),o.push({name:T.CONTEXT_ID,value:(null==t?void 0:t.contextId)||n.UNKNOWN});var s=null===(a=(i=r._EventManager).getScenarioTracker)||void 0===a?void 0:a.call(i,C.ScenarioType.Load,T.MDLDATAPROVIDER_COMPONENT_RETRIEVE_GRID_DATA,o);try{if(e&&e.fetchXml&&e.entityLogicalName){r.setCurrentContext(t);var u=yield r._store.dispatch(Object(c.retrieveGridData)(e,!1));return null==s||s.complete(o),u}throw new m.ErrorStatus("Query is null or missing sufficient data to execute")}catch(l){throw r.reportError(l,s,o),l}}))()}retrieveRecordData(e,t,r){var i=this;return P((function*(){var o,s,u=[];u.push({name:T.OPERATION_NAME,value:T.RETRIEVE_RECORD_DATA}),u.push({name:T.ENTITY_LOGICAL_NAME,value:(null==e?void 0:e.etn)||n.UNKNOWN}),u.push({name:T.CONTEXT_ID,value:(null==r?void 0:r.contextId)||n.UNKNOWN});var c=null===(o=(s=i._EventManager).getScenarioTracker)||void 0===o?void 0:o.call(s,C.ScenarioType.Load,T.MDLDATAPROVIDER_COMPONENT_RETRIEVE_RECORD_DATA,u);try{if(i.setCurrentContext(r),!e||!e.etn||a.Guid.isNullOrEmpty(e.id))throw new m.ErrorStatus("Invalid identifier");if(!t||0===t.length)throw new m.ErrorStatus("Invalid column set");var l=yield i._store.dispatch(Object(y.retrieve)(e,t)),d=Object(h.serializeEntityRecord)(l);return null==c||c.complete(u),d}catch(p){throw i.reportError(p,c,u),p}}))()}retrieveMultipleRecords(e,t,r){var a=this;return P((function*(){var i,o,s=[];s.push({name:T.OPERATION_NAME,value:T.RETRIEVE_MULTIPLE_RECORD_DATA}),s.push({name:T.RETRIEVE_RECORDS_COUNT,value:e.length||n.UNKNOWN}),s.push({name:T.CONTEXT_ID,value:(null==r?void 0:r.contextId)||n.UNKNOWN});var u=null===(i=(o=a._EventManager).getScenarioTracker)||void 0===i?void 0:i.call(o,C.ScenarioType.Load,T.MDLDATAPROVIDER_COMPONENT_RETRIEVE_MULTIPLE_RECORDS_DATA,s);try{if(a.setCurrentContext(r),!e||0===e.length)throw new m.ErrorStatus("Invalid identifiers");if(!t||0===t.length)throw new m.ErrorStatus("Invalid column set");var c=yield a._store.dispatch(Object(y.retrieveMultipleRecords)(e,t)),l=[];return c.forEach(e=>{var t=Object(h.serializeEntityRecord)(e);l.push(t)}),null==u||u.complete(s),l}catch(d){throw a.reportError(d,u,s),d}}))()}retrieveEntity(e,t){var r=this;return P((function*(){var a,i,o=[];o.push({name:T.OPERATION_NAME,value:T.RETRIEVE_ENTITY}),o.push({name:T.ENTITY_LOGICAL_NAME,value:e}),o.push({name:T.CONTEXT_ID,value:(null==t?void 0:t.contextId)||n.UNKNOWN});var s=null===(a=(i=r._EventManager).getScenarioTracker)||void 0===a?void 0:a.call(i,C.ScenarioType.Load,T.MDLDATAPROVIDER_COMPONENT_RETRIEVE_ENTITY,o);try{r.setCurrentContext(t);var c=yield r._store.dispatch(Object(u.retrieveEntity)(e,!0,[]));return null==s||s.complete(o),c}catch(l){throw r.reportError(l,s,o),l}}))()}saveDataSnapshot(e,t,r){var a=this;return P((function*(){var i,o,s,u=[];u.push({name:T.OPERATION_NAME,value:T.SAVE_DATA_SNAPSHOT}),u.push({name:T.SUPPRESS_DUPLICATE_DETECTION,value:t}),u.push({name:T.ENTITY_LOGICAL_NAME,value:null==e||null===(i=e.identifier)||void 0===i?void 0:i.etn}),u.push({name:T.CONTEXT_ID,value:(null==r?void 0:r.contextId)||n.UNKNOWN});var c=null===(o=(s=a._EventManager).getScenarioTracker)||void 0===o?void 0:o.call(s,C.ScenarioType.Load,T.MDLDATAPROVIDER_COMPONENT_SAVE_DATA_SNAPSHOT,u);try{a.setCurrentContext(r);var l=yield a._store.dispatch(Object(d.saveDataSnapshotFromSnapshot)(e,t));return null==c||c.complete(u),l.id}catch(p){throw a.reportError(p,c,u),p}}))()}saveMultipleDataSnapshots(e,t,r){var a=this;return P((function*(){var i,o,s=[];s.push({name:T.OPERATION_NAME,value:T.SAVE_MULTIPLE_DATA_SNAPSHOTS}),s.push({name:T.MULTIPLE_SNAPSHOT_RECORD_COUNT,value:e.length}),s.push({name:T.CONTEXT_ID,value:(null==r?void 0:r.contextId)||n.UNKNOWN});var u=null===(i=(o=a._EventManager).getScenarioTracker)||void 0===i?void 0:i.call(o,C.ScenarioType.Load,T.MDLDATAPROVIDER_COMPONENT_SAVE_MULTIPLE_DATA_SNAPSHOTS,s);try{if(a.setCurrentContext(r),!e||0===e.length)throw new m.ErrorStatus("Invalid snapshots");var c=yield a._store.dispatch(Object(d.saveDataSnapshots)(e,t)),l=[];return c.forEach(e=>{l.push(e.id)}),null==u||u.complete(s),l}catch(p){throw a.reportError(p,u,s),p}}))()}deleteRecords(e,t){var r=this;return P((function*(){var a,i,o=[];o.push({name:T.OPERATION_NAME,value:T.DELETE_RECORDS}),o.push({name:T.DELETE_RECORDS_COUNT,value:e?e.length:0}),o.push({name:T.CONTEXT_ID,value:(null==t?void 0:t.contextId)||n.UNKNOWN});var u=r._traceManager.getTracer("ModelDataProvider"),c=null===(a=(i=r._EventManager).getScenarioTracker)||void 0===a?void 0:a.call(i,C.ScenarioType.Load,T.MDLDATAPROVIDER_COMPONENT_DELETE_RECORDS,o);try{if(!e||!e.length)throw new m.ErrorStatus("EntityReferences is null or empty");if(r.setCurrentContext(t),1===e.length)yield r._store.dispatch(Object(s.oDataDelete)(e[0]));else if(e.length<=5)yield r.executeMultipleDeleteRequestUtil(e);else for(var l=0;l<e.length;){var d=l+5<e.length?l+5:e.length,p=e.slice(l,d);yield r.executeMultipleDeleteRequestUtil(p),o.push({name:"RecordRange",value:l+"->"+d}),u.debug("Completed batch delete successfully for the range "+l+"->"+d,o),l=d}null==c||c.complete(o)}catch(f){throw r.reportError(f,c,o),f}}))()}executeMultipleDeleteRequestUtil(e){var t=this;return P((function*(){var r=e.map(e=>new p.ODataDeleteRequest(i.EntityReference.toExternalEntityReference(e))),n=new p.ODataExecuteMultipleRequest([r]);yield t._store.dispatch(Object(o.executeOData)(n))}))()}cleanUp(e){var t=this;return P((function*(){e.contextId&&t._configuration.GarbageCollectionProvider.runGarbageCollection(e.contextId)}))()}setCurrentContext(e){null!=e&&e.contextId&&this._configuration.GarbageCollectionProvider.setCurrentPage(e.contextId)}reportError(e,t,r){var n=this._traceManager.getTracer("ModelDataProvider");e&&Object(m.isErrorStatus)(e)||(n.error("Error thrown that is not of type ErrorStatus",r),e=Object(m.convertToErrorStatus)(e)),null==r||r.push({name:T.ERROR_CODE,value:e.errorCode}),null==r||r.push({name:T.MESSAGE,value:e.message}),null==r||r.push({name:T.STACK_TRACE,value:e.stack}),Object(_.isSLAImpactingError)(e.errorCode,e.message)?null==t||t.failure(r):(null==t||t.complete(r),n.error("Scenario failed with known error",r))}static getEnvironmentUri(e){if(!e.properties.linkedEnvironmentMetadata.instanceUrl)throw Error("Unable to get base URI of CDS org");return e.properties.linkedEnvironmentMetadata.instanceUrl}}I._instances={}},9045:function(e,t,r){"use strict";r.r(t),r.d(t,"OPERATION",(function(){return n})),r.d(t,"HTTP_REQUEST_METHOD",(function(){return a})),r.d(t,"SQLQuerySupportedList",(function(){return i})),r.d(t,"FileQuerySupportedList",(function(){return o})),r.d(t,"HTTP_STATUS_CODES",(function(){return s})),r.d(t,"HTTP_STATUS_TEXTS",(function(){return u})),r.d(t,"UNEXPECTED_STATUS_CODE",(function(){return c})),r.d(t,"ADDITIONAL_PARAMETERS",(function(){return l})),r.d(t,"HINT",(function(){return d})),r.d(t,"HEADER",(function(){return p})),r.d(t,"HEADER_VALUES",(function(){return f})),r.d(t,"ErrorCode",(function(){return h})),r.d(t,"APP_ENTITY",(function(){return m})),r.d(t,"WEB_API_URL_FRAGMENT",(function(){return y})),r.d(t,"STRING_CONSTANTS",(function(){return v})),r.d(t,"COMPOSITE_INDEX_DELIMITER",(function(){return g})),r.d(t,"UNKNOWN",(function(){return O})),r.d(t,"CLIENT_TYPE",(function(){return E})),r.d(t,"EXECUTION_HINTS",(function(){return b})),r.d(t,"EXPAND_VALUES",(function(){return T})),r.d(t,"EXPAND_PROPERTIES",(function(){return S})),r.d(t,"FILE_ATTACHMENT",(function(){return C})),r.d(t,"DEVICE_FILE_PATH",(function(){return N})),r.d(t,"DEVICE_THUMBNAIL_PATH",(function(){return _})),r.d(t,"IMAGE_DESCRIPTOR",(function(){return R})),r.d(t,"IMAGE_DESCRIPTOR_ID",(function(){return P})),r.d(t,"FILE_NAME",(function(){return I})),r.d(t,"FETCH_PREFIX",(function(){return A})),r.d(t,"norSyncMainLogTableName",(function(){return D})),r.d(t,"offlineOnlyTables",(function(){return M})),r.d(t,"offlineLogPrefix",(function(){return F}));var n={Create:"Create",Batch:"Batch",Retrieve:"Retrieve",RetrieveMultiple:"RetrieveMultiple",GetClientMetadata:"GetClientMetadata",Update:"Update",Delete:"Delete",Download:"Download",Upload:"Upload",FileDelete:"FileDelete"},a={Post:"POST",Get:"GET",Patch:"PATCH",Delete:"DELETE"},i=[n.Create,n.Delete,n.Batch,n.GetClientMetadata,n.Update,n.Retrieve,n.RetrieveMultiple],o=[n.Download,n.Upload,n.FileDelete],s={Ok:200,Accepted:202,NoContent:204,PartialContent:206,BadRequest:400,Unauthorized:401,NotFound:404,Unknown:420,InternalServerError:500,ServiceUnavailable:503},u={[s.Ok]:"OK",[s.Accepted]:"Accepted",[s.NoContent]:"No Content",[s.PartialContent]:"Partial Content",[s.BadRequest]:"Bad Request",[s.Unauthorized]:"Bad Request",[s.NotFound]:"Not Found",[s.Unknown]:"Unknown",[s.InternalServerError]:"Internal Server Error",[s.ServiceUnavailable]:"Service Unavailable"},c=[s.BadRequest,s.InternalServerError,s.NotFound,s.ServiceUnavailable],l={RecordId:"RecordId",PageSize:"PageSize",PageNumber:"PageNumber",MetadataTypes:"MetadataTypes",Top:"Top",Expand:"Expand",NavigationPropertyRelationshipName:"NavigationPropertyRelationshipName",NavigationPropertyEntity:"NavigationPropertyEntity",ODataQuery:"ODataQuery",FetchXmlQuery:"FetchXmlQuery",MaxPageSize:"MaxPageSize"},d={select:"x-ms-mdl-select",pageSize:"x-ms-mdl-pageSize",pageNumber:"x-ms-mdl-pageNumber",filter:"x-ms-mdl-filter",linkEntity:"x-ms-mdl-link",viewId:"x-ms-mdl-viewId",rawFetch:"x-ms-mdl-rawFetchXml",mergeQuickFind:"x-ms-mdl-mergeQuickFind",contextFilter:"x-ms-mdl-contextFilter",executionStrategy:"x-ms-mdl-execution-hints",search:"x-ms-mdl-search",orderBy:"x-ms-mdl-orderby",MIME_TYPE:"x-ms-mdl-mimeType",FILE_SIZE:"x-ms-mdl-fileSize",FILE_URL:"x-ms-mdl-fileUrl",SUPPRESS_TRIGGERS_HINT:"x-ms-mdl-suppress-triggers",UPSYNC_REQUEST_HINT:"x-ms-mdl-upsync-request",ETN_NAME:"x-ms-mdl-etn-name"},p={ACCEPT:"Accept",PREFER:"Prefer",AUTO_DISASSOCIATE:"AutoDisassociate",IF_MATCH:"If-match",MSCRM_SUPPRESS_DUPLICATION_DETECTION:"MSCRM.SuppressDuplicateDetection",MSCRM_RETURN_NOTIFICATIONS:"MSCRM.ReturnNotifications",APP_ENTITY:"appmodules",AUTHORIZATION:"Authorization",CONTENT_TYPE:"Content-Type",ODADTA_ENTITY_ID:"OData-EntityId",CONTENT_LENGTH:"Content-Length",CLIENT_REQUEST_ID:"x-ms-client-request-id",SERVER_REQUEST_ID:"x-ms-service-request-id",SESSION_ID:"x-ms-client-session-id",CORRELATION_ID:"x-ms-correlation-id",SOURCE_ID:"x-ms-source-id",USER_AGENT:"x-ms-user-agent",APP_ID:"x-ms-app-id",APP_NAME:"x-ms-app-name",OBJECT_ID:"x-ms-sw-objectid",TENANT_ID:"x-ms-sw-tenantid",CONTENT_ID:"Content-ID",CONTENT_TRANSFER_ENCODING:"Content-Transfer-Encoding",PREFERENCE_APPLIED:"Preference-Applied",LOCATION:"Location",REQ_ID:"REQ_ID"},f={APPLICATION_JSON:"application/json",APPLICATION_HTTP:"application/http",BINARY:"binary",ANNOTATIONS:'odata.include-annotations="*"',ANNOTATIONS_NOQUOTES:"odata.include-annotations=*",PREFER_REPRESENTATION:"return=representation"},h={CannotUpdateOnlineRecord:-2147093980,CannotDeleteOnlineRecord:-2147093944,DataSourceOfflineErrorCode:-2147093999,InvalidXml:-2147220991,UnknownUnexpectedGenericError:-2147015414,UnknownBadRequestError:-2147015424,DataStoreKeyNotFoundErrorCode:-2147093987,QueryBuilderNoEntity:-2147217150,NetworkIssue:-2147094268},m="appmodules",y="/api/data/v9.0/",v={ErrorCode:"code",Message:"message",StackTrace:"stacktrace",Stack:"stack",InnerError:"innererror"},g="_",O="Unknown",E={local:"local",remote:"remote"},b={ONLINE:"Online",OFFLINE:"Offline"},T={MULTI_VALUE:"MultiValue",SINGLE_VALUE:"SingleValue"},S="ExpandProperties",C="fileattachment",N="devicefilepath",_="devicethumbnailpath",R="imagedescriptor",P="imagedescriptorid",I="filename",A="fetchXml=",D="_NORSYNC_MAIN_LOG_TABLE",M=["businessprocessflowinstance","command","commandoperation"],F="_NORSYNC_LOG_"},9046:function(e,t,r){"use strict";r.r(t),r.d(t,"Guid",(function(){return u}));var n=r(9047),a=r(9048),i=r(9049),o=/^({?)((\d|[a-fA-F]){8}-(\d|[a-fA-F]){4}-(\d|[a-fA-F]){4}-(\d|[a-fA-F]){4}-(\d|[a-fA-F]){12})(}?)$/,s=/^([a-fA-F\d]{8})([a-fA-F\d]{4})([a-fA-F\d]{4})([a-fA-F\d]{4})([a-fA-F\d]{12})$/;class u{static externalGuid(e){return e&&e.guid?"{"+e.guid.toUpperCase()+"}":u.EMPTYSTRING}static fromExternalGuid(e,t){return typeof e===a.AttributeType.String&&e.trim().length>0?new u(e.replace(/[\{\}]/gi,"")):(t&&t.warn("".concat(n.FILE_PREFIX.Common," Empty string or invalid object used to form GUID. Returning empty GUID.")),u.EMPTY)}static validate(e){return null!=e&&null!==o.exec(e)}static toString(e){return e?e.guid:null}static tryParse(e){return u.tryParseOrNull(e)||u.EMPTY}static tryParseOrNull(e){var t=u._formatGuidString(e);return t?new u(t,!0):null}static parse(e){return new u(e)}static toLegacyGuid(e){return e?i.LegacyGuid.createFromFormattedGuidStringAndSkipParsing(e.guid):null}static fromLegacyGuid(e){if(e){var t=e.toString();if(t)return new u(t,!0)}return null}static equals(e,t){return null==e||null==t?e===t:u.toString(e)===u.toString(t)}static isNullOrEmpty(e){return!e||u.equals(e,u.EMPTY)}static newGuid(){for(var e="",t=0;t<36;t++)if(14===t)e+="4";else if(8===t||13===t||18===t||23===t)e+="-";else if(19===t){var r=Math.floor(16*Math.random());e+="0123456789abcdef".substr(3&r|8,1)}else e+="0123456789abcdef".substr(Math.floor(16*Math.random()),1);return new u(e,!0)}static _formatGuidString(e){if(!e||"string"!=typeof e)return null;e=e.toLowerCase();var t=o.exec(e);if(t)return t[1].length!==t[8].length?null:t[2];var r=s.exec(e);return r?r.filter((e,t)=>t>0).join("-"):null}constructor(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.guid=void 0,t)this.guid=e;else{var r=u._formatGuidString(e);if(!r)throw new Error("".concat(e," is not a valid Guid value."));this.guid=r}Object.freeze(this)}}u.EMPTYGUIDSTRING="00000000-0000-0000-0000-000000000000",u.EMPTY=new u(u.EMPTYGUIDSTRING,!0),u.EMPTYSTRING=""},9047:function(e,t,r){"use strict";r.r(t),r.d(t,"MDL_COMPONENT_NAME",(function(){return a})),r.d(t,"FILE_PREFIX",(function(){return i})),r.d(t,"COMPONENT_NAMES",(function(){return o})),r.d(t,"EVENT_PARAMETERS",(function(){return s})),r.d(t,"ScenarioType",(function(){return n}));var n,a="ModernDataLayer",i={GetSqlResults:"GetSqlResults",MetadataCache:"MetadataCache",MetadataStateAccessor:"MetadataStateAccessor",MetadataUtil:"MetadataUtil",SQLGenerator:"SQLGenerator",PolicyManager:"PolicyManager",PromiseCache:"PromiseCache",CreateResponseHandler:"CreateResponseHandler",DeleteResponseHandler:"DeleteResponseHandler",GetClientMetadataResponseHandler:"GetClientMetadataResponseHandler",UpdateResponseHandler:"UpdateResponseHandler",RetrieveResponseHandler:"RetrieveResponseHandler",BatchResponseHandler:"BatchResponseHandler",BPFResponseHandler:"BPFResponseHandler",RetrieveMultipleResponseHandler:"RetrieveMultipleResponseHandler",FileExecutor:"FileExecutor",QueryGenerator:"QueryGenerator",ResponseHandler:"ResponseHandler",SQLExecutor:"SQLExecutor",UrlParserHandler:"UrlParserHandler",LocalODataClientManager:"LocalODataClientManager",ODataClientManager:"ODataClientManager",ODataExecutor:"ODataExecutor",DeleteGenerator:"DeleteGenerator",RetrieveMultipleGenerator:"RetrieveMultipleGenerator",SQLModifier:"SQLModifier",UpdateGenerator:"UpdateGenerator",PolicyRetryInterceptor:"PolicyRetryInterceptor",TimeoutInterceptor:"TimeoutInterceptor",ExecuteRequestInterceptor:"ExecuteRequestInterceptor",RequestResponseInterceptor:"RequestResponseInterceptor",LongRequestInterceptor:"LongRequestInterceptor",FileRequestInterceptor:"FileRequestInterceptor",SQLRequestInterceptor:"SQLRequestInterceptor",HttpExecutorInterceptor:"HttpExecutorInterceptor",PromiseCacheInterceptor:"PromiseCacheInterceptor",GCMGenerator:"GCMGenerator",Common:"Common",BatchRequestParser:"BatchRequestParser",RootFinder:"RootFinder",MetadataSQLExecutor:"MetadataSQLExecutor",DataSQLExecutor:"DataSQLExecutor",CreateGenerator:"CreateGenerator",BatchGenerator:"BatchGenerator",QuickFindSQLGenerator:"QuickFindSQLGenerator",MergeQuickFindSQLGenerator:"MergeQuickFindSQLGenerator",RetrieveGenerator:"RetrieveGenerator",ApplyFilterSQLGenerator:"ApplyFilterSQLGenerator",ApplyFinalModifiedSQLGenerator:"ApplyFinalModifiedSQLGenerator",ApplySelectSQLGenerator:"ApplySelectSQLGenerator",ApplyOrderBySQLGenerator:"ApplyOrderBySQLGenerator",ApplyLinkEntitySQLGenerator:"ApplyLinkEntitySQLGenerator",ApplyContextFilterSQLGenerator:"ApplyContextFilterSQLGenerator",CloneRequest:"CloneRequest",FetchRequest:"FetchRequest",GenerateBaseSQL:"GenerateBaseSQL",DetermineHints:"DetermineHints",ODataQueryParser:"ODataQueryParser",ExpandParser:"ExpandParser",FetchXmlParser:"FetchXmlParser",DateTimeOperators:"DateTimeOperators",Validator:"Validator"},o={ODataExecutor:"".concat(a,".").concat(i.ODataExecutor),RemoteODataExecutor:"".concat(a,".RemoteODataExecutor"),LocalODataExecutor:"".concat(a,".LocalODataExecutor"),SQLExecutor:"".concat(a,".").concat(i.SQLExecutor),FileExecutor:"".concat(a,".").concat(i.FileExecutor),SQLGenerator:"".concat(a,".").concat(i.QueryGenerator),ResponseHandler:"".concat(a,".").concat(i.ResponseHandler),UrlParserHandler:"".concat(a,".").concat(i.UrlParserHandler),MetadataCache:"".concat(a,".").concat(i.MetadataCache)},s={HTTP_STATUS_CODE:"HTTP-Status-Code",HTTP_RESPONSE_TYPE:"HTTP-Response-Type",HTTP_RESPONSE_STATUS_TEXT:"HTTP-Response-Status-Text",RESPONSE_URL:"Response-Url",RESPONSE_SIZE_IN_BYTES:"Response-Size-In-Bytes",ERROR_CODE:"Error-Code",ERROR_MESSAGE:"Error-Message",ERROR_STACK:"Error-Stack",ERROR_COMPLETE_TEXT:"Error-Complete-Text",CLIENT_TYPE:"Client-Type",RESPONSE_TIME:"Response-Time",CLIENT_REQUEST_ID:"Client-Request-Id",SERVER_REQUEST_ID:"Server-Request-Id",OPERATION_TYPE:"Operation-Type",OPERATION_SUB_TYPE:"Operation-SubType",OPERATION_SOURCE:"Operation-Source",END_POINT:"EndPoint",METHOD:"Method",EMPTY_STRING:"",SQL_ERROR_CODE:"SqlErrorCode",SQL_ERROR_MESSAGE:"SqlErrorMessage",REQUEST_URL:"Request-Url",BASE_OFFLINE_SQL:"BaseOfflineSQL",ENTITY_NAME:"Entity-Name",IS_OFFLINE_BY_DEFAULT_REQUEST:"Is-Offline-By-Default-Request",EXECUTION_HINT:"Execution_Hint",SQL_QUERY:"SqlQuery",ERROR_DETAIL:"Error-Detail",METADATA_CACHE_OPERATION:"Metadata-Cache-Operation",STATE_TREE_ACCESS:"State-Tree-Access",METADATACACHE_BEFORESIZE:"MetadataCacheBeforeSize",METADATACACHE_AFTERSIZE:"MetadataCacheAfterSize"};!function(e){e.Create="Create",e.Delete="Delete",e.Load="Load",e.Update="Update"}(n||(n={}))},9048:function(e,t,r){"use strict";var n;r.r(t),r.d(t,"AttributeType",(function(){return n})),function(e){e.Boolean="boolean",e.Unknown="unknown",e.Customer="customer",e.Date="date",e.DateTime="datetime",e.Decimal="decimal",e.Double="double",e.Image="image",e.Integer="integer",e.Lookup="lookup",e.ManagedProperty="managedproperty",e.Memo="memo",e.Money="money",e.Owner="owner",e.PartyList="partylist",e.PickList="picklist",e.State="state",e.Status="status",e.String="string",e.UniqueIdentifier="uniqueidentifier",e.CalendarRules="calendarrules",e.Virtual="virtual",e.BigInt="bigint",e.EntityName="entityname",e.EntityImage="entityimage",e.AliasedValue="aliasedvalue",e.Regarding="regarding",e.MultiSelectPickList="multiselectpicklist",e.File="file",e.NavigationProperty="navigationproperty"}(n||(n={}))},9049:function(e,t,r){"use strict";r.r(t),r.d(t,"LegacyGuid",(function(){return i}));var n=r(9050),a=r(9048);class i{static get_empty(){return i._empty||(i._empty=new i("00000000000000000000000000000000",!0))}static createFromObjectData(e){return new i(e.rawguid)}static tryCreate(e){var t=i._GetParsedString(e);return Object(n.isNullOrUndefinedOrEmptyString)(t)?i.get_empty():new i(t)}static createFromFormattedGuidStringAndSkipParsing(e){return typeof e!==a.AttributeType.String||Object(n.isNullOrUndefinedOrEmptyString)(e)?i.get_empty():new i(e.replace(i._get_GuidStripperPattern(),""),!0)}static isNullOrEmpty(e){return!(!Object(n.isNullOrUndefined)(e)&&e.length)||!!new i(e).equals(i._empty)}static newGuid(){for(var e=0;e<36;e++)if(14!==e){if(8!==e&&13!==e&&18!==e&&23!==e){if(19===e){var t=Math.floor(16*Math.random());"0123456789abcdef".substr(3&t|8,1)}"".concat("0123456789abcdef".substr(Math.floor(16*Math.random()),1))}}else"".concat("4");return new i("".toString(),!0)}static _get_BraceAndHyphenGuidVerifierPattern(){return i._braceAndHyphenGuidVerifierPattern||(i._braceAndHyphenGuidVerifierPattern=new RegExp("^{(\\d|[a-f]){8}-(\\d|[a-f]){4}-(\\d|[a-f]){4}-(\\d|[a-f]){4}-(\\d|[a-f]){12}}$"))}static _get_GuidStripperPattern(){return i._guidStripperPattern||(i._guidStripperPattern=new RegExp("{|}|-","g"))}static _get_HyphenGuidVerifierPattern(){return i._hyphenGuidVerifierPattern||(i._hyphenGuidVerifierPattern=new RegExp("^(\\d|[a-f]){8}-(\\d|[a-f]){4}-(\\d|[a-f]){4}-(\\d|[a-f]){4}-(\\d|[a-f]){12}$"))}static _get_ContiguousGuidVerifierPattern(){return i._contiguousGuidVerifierPattern||(i._contiguousGuidVerifierPattern=new RegExp("^(\\d|[a-f]){32}$"))}static _GetParsedString(e){return Object(n.isNullOrUndefinedOrEmptyString)(e)?"":(e=e.toLowerCase(),i._get_HyphenGuidVerifierPattern().test(e)||i._get_BraceAndHyphenGuidVerifierPattern().test(e)?e.replace(i._get_GuidStripperPattern(),""):i._get_ContiguousGuidVerifierPattern().test(e)?e:"")}constructor(e,t){if(this._rawGuid=void 0,this._formattedGuid="",t)this._rawGuid=e;else if(this._rawGuid=i._GetParsedString(e),Object(n.isNullOrUndefinedOrEmptyString)(this._rawGuid))throw new Error("Not a valid guid")}getObjectData(){return{rawguid:this._rawGuid}}equals(e){if(e instanceof i)return e._rawGuid===this._rawGuid;if("string"==typeof e)try{return new i(e)._rawGuid===this._rawGuid}catch(t){return!1}return!1}toString(){return this._formattedGuid||(this._formattedGuid=this._rawGuid.substring(0,8)+"-"+this._rawGuid.substring(8,12)+"-"+this._rawGuid.substring(12,16)+"-"+this._rawGuid.substring(16,20)+"-"+this._rawGuid.substring(20,32)),this._formattedGuid}}i._empty=void 0,i._guidStripperPattern=void 0,i._hyphenGuidVerifierPattern=void 0,i._braceAndHyphenGuidVerifierPattern=void 0,i._contiguousGuidVerifierPattern=void 0,i.__typeName="Microsoft.Crm.Client.Core.Framework.Guid"},9050:function(e,t,r){"use strict";r.r(t),r.d(t,"mapToValues",(function(){return m})),r.d(t,"throwOnNullOrUndefinedArgument",(function(){return y})),r.d(t,"loadBehaviorFromCrmSoap",(function(){return v})),r.d(t,"behaviorToCrmSoap",(function(){return g})),r.d(t,"loadRequiredLevelFromCrmSoap",(function(){return O})),r.d(t,"getClientType",(function(){return D})),r.d(t,"getErrorMessage",(function(){return w})),r.d(t,"convertSearchStringToSQL",(function(){return L})),r.d(t,"handleEscapeCharacters",(function(){return j})),r.d(t,"trimWildCards",(function(){return x})),r.d(t,"getMaxPageSizeFromPrefer",(function(){return U})),r.d(t,"getEntitySetNameFromUrl",(function(){return k})),r.d(t,"isUpsyncRequest",(function(){return V})),r.d(t,"isInternalRequest",(function(){return B})),r.d(t,"isEntityLogTable",(function(){return G})),r.d(t,"getEntityNameForEntityLogTable",(function(){return Q})),r.d(t,"isOfflineOnlyEntity",(function(){return z})),r.d(t,"isOfflineLogTable",(function(){return X})),r.d(t,"getClientRequestId",(function(){return W})),r.d(t,"addClientRequestIdToSqlQueryRequests",(function(){return Y})),r.d(t,"encodeURIComponentForOData",(function(){return E})),r.d(t,"buildBatchRequest",(function(){return b})),r.d(t,"parseBatchResponse",(function(){return T})),r.d(t,"getHttpHeader",(function(){return C})),r.d(t,"isNullOrUndefined",(function(){return N})),r.d(t,"isNullOrUndefinedOrEmptyString",(function(){return R})),r.d(t,"buildODataResponseFromError",(function(){return I})),r.d(t,"isNullOrUndefinedOrEmpty",(function(){return _})),r.d(t,"getViewLocalStoreId",(function(){return P})),r.d(t,"isUserContextMetadataRequest",(function(){return A})),r.d(t,"convertErrorToLocalError",(function(){return M}));var n=r(9046),a=r(9048),i=r(9051),o=r(9052),s=r(9053),u=r(9045);r.d(t,"COMPOSITE_INDEX_DELIMITER",(function(){return u.COMPOSITE_INDEX_DELIMITER}));var c=r(9056),l=r(9077),d=r(9054),p=r(9073);function f(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function h(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){f(i,n,a,o,s,"next",e)}function s(e){f(i,n,a,o,s,"throw",e)}o(void 0)}))}}function m(e,t){return e?Object.keys(e).reduce((r,n)=>(r[n]=t(e[n]),r),{}):{}}function y(e,t){if(N(e))throw Error("Argument = ".concat(t," can't be null or undefined"))}function v(e){switch(e){case"None":return i.DateTimeFieldBehavior.None;case"UserLocal":return i.DateTimeFieldBehavior.UserLocal;case"DateOnly":return i.DateTimeFieldBehavior.DateOnly;case"TimeZoneIndependent":return i.DateTimeFieldBehavior.TimeZoneIndependent;default:return i.DateTimeFieldBehavior.UserLocal}}function g(e){switch(e){case i.DateTimeFieldBehavior.None:return"None";case i.DateTimeFieldBehavior.UserLocal:return"UserLocal";case i.DateTimeFieldBehavior.DateOnly:return"DateOnly";case i.DateTimeFieldBehavior.TimeZoneIndependent:return"TimeZoneIndependent";default:return"UserLocal"}}function O(e){switch(e){case"None":return o.RequiredLevel.none;case"ApplicationRequired":return o.RequiredLevel.applicationRequired;case"Recommended":return o.RequiredLevel.recommended;case"SystemRequired":return o.RequiredLevel.systemRequired;default:return o.RequiredLevel.unknown}}function E(e){return e}function b(e){return e[0]}function T(e){return S.apply(this,arguments)}function S(){return(S=h((function*(e){return[e]}))).apply(this,arguments)}function C(e,t){if(!e)return null;var r=e.get(t);return r||(r=e.get(t.toLowerCase())),r}function N(e){return null==e}function _(e){return!(e instanceof Promise)&&(N(e)||R(e)||0===Object.keys(e).length)}function R(e){return!!N(e)||typeof e===a.AttributeType.String&&""===e.trim()}function P(e){return l.MetadataType.savedView+u.COMPOSITE_INDEX_DELIMITER+e}function I(e,t,r,n){var a=r||0,i=e?e.message:"Unknown Error",o=e?e.stack:void 0,u=e?e.name:void 0;return Object(s.buildErrorResponse)(a,t,new c.LocalError(i,n,o,u))}function A(e){return!(N(e)||!N(e.MetadataType)||N(e.DependencyDepth)||"usercontext"!==e.DependencyDepth.toLowerCase())}function D(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=u.CLIENT_TYPE.remote;return e&&e.additionalHeaders&&e.additionalHeaders[u.HINT.executionStrategy]?[u.EXECUTION_HINTS.OFFLINE,u.EXECUTION_HINTS.ONLINE].includes(e.additionalHeaders[u.HINT.executionStrategy])?n=e.additionalHeaders[u.HINT.executionStrategy]===u.EXECUTION_HINTS.OFFLINE?u.CLIENT_TYPE.local:u.CLIENT_TYPE.remote:t&&t.warn("[Utils.getClientType] Unsupported execution strategy, default to remote client",r):t&&t.warn("[Utils.getClientType] No execution strategy provided, default to remote client",r),n}function M(e){var t=u.UNKNOWN,r=u.ErrorCode.UnknownUnexpectedGenericError,n=u.UNKNOWN;return N(e)||(F(e)?(t=R(e._message)?t:e._message,r=R(e._errorCode)?r:e._errorCode,n=R(e._stack)?n:e._stack):(t=R(e.message)?t:e.message,n=R(e.stack)?n:e.stack)),new c.LocalError(t,r,n)}function F(e){return!_(e)&&void 0!==e.get_Message}function w(e){return F(e)?e._message?e._message:null:e?e.message?e.message:e:null}function L(e){for(var t=[],r=0;r<e.length;r++)switch(e.charAt(r)){case"[":t.push("[[]");break;case"_":t.push("[_]");break;case"%":t.push("[%]");break;case"*":t.push("%");break;default:t.push(e.charAt(r))}return e.length&&e.endsWith("*")||t.push("%"),t.join("")}function j(e){return e.replace("'","''")}function x(e){var t=e;return t?("*"===t[0]&&(t=t.substring(1)),"*"===t[t.length-1]&&(t=t.substring(0,t.length-1)),t):t}function U(e){var t=null,r=new RegExp("odata.maxpagesize=(\\d+)"),n=e.additionalHeaders&&e.additionalHeaders.Prefer?e.additionalHeaders.Prefer.match(r):null;return n&&n.length>=2&&(t=Number(n[1])),t}function k(e,t){return q.apply(this,arguments)}function q(){return(q=h((function*(e,t){var r=t.url.split("/");return(yield Object(d.isFeatureEnabled)(e,p.CustomPageOffline))&&r[r.length-2].indexOf("(")>-1?r[r.length-2].split("(")[0]:r[r.length-1].split("(")[0].split("?")[0]}))).apply(this,arguments)}function V(e,t){var r;return"true"===(null===(r=e.additionalHeaders)||void 0===r?void 0:r[u.HINT.UPSYNC_REQUEST_HINT])}function B(e,t,r){return H.apply(this,arguments)}function H(){return(H=h((function*(e,t,r){var n=yield k(e,t);return r=r||n.slice(0,-1),V(t)&&(X(r)||z(r))}))).apply(this,arguments)}function G(e){return null==e?void 0:e.startsWith(u.offlineLogPrefix)}function Q(e){return e.substring(u.offlineLogPrefix.length)}function z(e){return u.offlineOnlyTables.indexOf(e)>-1||e===u.norSyncMainLogTableName}function X(e){return G(e)||e===u.norSyncMainLogTableName}function W(e){return e&&e.additionalHeaders?e.additionalHeaders[u.HEADER.CLIENT_REQUEST_ID]:void 0}function Y(e,t,r){var a=t.clientRequestId,i=t.commonEventParameters||[];return R(a)&&(a=n.Guid.toString(n.Guid.newGuid()),r.warn("No client request found in executionContext, generated local request id: ".concat(a),i)),e.additionalParameters?e.additionalParameters[u.HEADER.CLIENT_REQUEST_ID]=a:e.additionalParameters={[u.HEADER.CLIENT_REQUEST_ID]:a},e}},9051:function(e,t,r){"use strict";var n;r.r(t),r.d(t,"DateTimeFieldBehavior",(function(){return n})),function(e){e[e.None=0]="None",e[e.UserLocal=1]="UserLocal",e[e.DateOnly=2]="DateOnly",e[e.TimeZoneIndependent=3]="TimeZoneIndependent"}(n||(n={}))},9052:function(e,t,r){"use strict";var n;r.r(t),r.d(t,"RequiredLevel",(function(){return n})),function(e){e[e.unknown=-1]="unknown",e[e.none=0]="none",e[e.systemRequired=1]="systemRequired",e[e.applicationRequired=2]="applicationRequired",e[e.recommended=3]="recommended"}(n||(n={}))},9053:function(e,t,r){"use strict";r.r(t),r.d(t,"headerContainsPreferAnnotation",(function(){return p})),r.d(t,"headerContainsPreferReturnRepresentation",(function(){return f})),r.d(t,"buildOdataResponse",(function(){return m})),r.d(t,"buildErrorResponse",(function(){return y})),r.d(t,"getOptionSetMatchingValue",(function(){return E})),r.d(t,"getAliasedAttributeProperties",(function(){return b})),r.d(t,"getFormattedRecordData",(function(){return T}));var n=r(9045),a=r(9050),i=r(9047),o=r(9048),s=r(9054),u=r(9063),c=r(9058);function l(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function d(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){l(i,n,a,o,s,"next",e)}function s(e){l(i,n,a,o,s,"throw",e)}o(void 0)}))}}function p(e){return!(!(e&&e.additionalHeaders&&e.additionalHeaders.Prefer)||-1===e.additionalHeaders.Prefer.indexOf(n.HEADER_VALUES.ANNOTATIONS)&&-1===e.additionalHeaders.Prefer.indexOf(n.HEADER_VALUES.ANNOTATIONS_NOQUOTES))}function f(e){return!!(e&&e.additionalHeaders&&e.additionalHeaders.Prefer&&-1!==e.additionalHeaders.Prefer.indexOf(n.HEADER_VALUES.PREFER_REPRESENTATION))}function h(e){return e>=200&&e<=299}function m(e,t,r,i){return function(e,t,r){if(!Object(a.isNullOrUndefined)(r)&&h(r)){if(Object(a.isNullOrUndefined)(e)||Object(a.isNullOrUndefined)(t))return;Object(a.isNullOrUndefined)(e.get(n.HEADER.CONTENT_LENGTH))&&e.set(n.HEADER.CONTENT_LENGTH,"".concat(t.length))}}(r,i,e),{status:e,ok:h(e),statusText:n.HTTP_STATUS_TEXTS[e]||"",headers:r,url:t,clone(){return Object.assign({},this)},json:()=>Promise.resolve(i?JSON.parse(i):null),text:()=>Promise.resolve(i||"")}}function y(e,t,r,i){var o={},s={};s[n.STRING_CONSTANTS.ErrorCode]=r.code?r.code:n.ErrorCode.DataSourceOfflineErrorCode,s[n.STRING_CONSTANTS.Message]=r.message,s[n.STRING_CONSTANTS.StackTrace]=r.stack;var u={};u[n.STRING_CONSTANTS.ErrorCode]=r.code,u[n.STRING_CONSTANTS.Message]=r.message,u[n.STRING_CONSTANTS.StackTrace]=r.stack,s[n.STRING_CONSTANTS.InnerError]=u,o.error=s;var c=JSON.stringify(o);return Object(a.isNullOrUndefined)(i)&&(i=new Headers),m(e,t,i,c)}function v(e){return"".concat(e,"@OData.Community.Display.V1.FormattedValue")}function g(e){return"".concat(e,"@OData.Community.Display.V1.AttributeName")}function O(e){if(-1!==e.search("!")){var t=e.split("!"),r=t[0],n=t[1],a="";return a=-1!==r.search("\\.")?r:"_".concat(r,"_value"),"id"===n?a:"name"===n?v(a):"logicalname"===n?function(e){return"".concat(e,"@Microsoft.Dynamics.CRM.lookuplogicalname")}(a):e}return e}function E(e,t){return e.find(e=>e.Value===t)}function b(e){var t=e.split(u.Punctuation.dot);return{alias:t[0],attributeName:t[1]}}function T(e,t,r,n){return S.apply(this,arguments)}function S(){return(S=d((function*(e,t,r,n){var l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},d=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],p=arguments.length>6?arguments[6]:void 0,f=e.TraceManager.getTracer(i.COMPONENT_NAMES.ResponseHandler),h=yield Object(s.getAttributeTypes)(e,[],r),m=yield Object(s.getAttributesMetadata)(e,r,[]),y={},T=[];C(r,t,e,h);var S=0;for(var N in t)if(N){var _=t[N];if(!Object(a.isNullOrUndefined)(_)||p){var R=h[N],P=N,I=m;if(N.indexOf(u.Punctuation.dot)>-1){var A=b(N);if(y[g(N)]=A.attributeName,l[A.alias]){var D=l[A.alias];P=A.attributeName,I=yield Object(s.getAttributesMetadata)(e,D,[]);var M=yield Object(s.getAttributeTypes)(e,[],D);R=M[P]}}if(-1!==N.search("!")){var F=O(N);y[F]=_}else{var w=v(N);switch(R){case o.AttributeType.Decimal:case o.AttributeType.Integer:case o.AttributeType.BigInt:case o.AttributeType.DateTime:case o.AttributeType.Double:case o.AttributeType.Money:y[N]=_;var L=null;R===o.AttributeType.Money&&t["transactioncurrencyid!id"]&&(L=t["transactioncurrencyid!id"]),n&&!Object(a.isNullOrUndefined)(_)&&(e.Formatter?y[w]=e.Formatter.getFormattedvalue(r,N,R,_,L):(f.error("Formatter is not available when returnAnnotationsFormat = true",d),y[w]=_));break;case o.AttributeType.MultiSelectPickList:y[N]=_,!n||Object(a.isNullOrUndefined)(I[P])||Object(a.isNullOrUndefined)(I[P].OptionSet)||function(){var e=I[P].OptionSet,t=[];Object(a.isNullOrUndefined)(_)||_.split(",").forEach(r=>{var n=e.find(e=>String(e.Value)===r.trim());n&&n.Label&&t.push(n.Label)});var r=t.length>0?t.join("; "):void 0;y[w]=r}();break;case o.AttributeType.Status:case o.AttributeType.State:case o.AttributeType.Boolean:case o.AttributeType.PickList:if(Object(a.isNullOrUndefined)(_)||R!==o.AttributeType.Boolean?y[N]=_:y[N]=0!==_,!Object(a.isNullOrUndefined)(_)&&n&&!Object(a.isNullOrUndefined)(I[P])&&!Object(a.isNullOrUndefined)(I[P].OptionSet)){var j=I[P].OptionSet;if(!Object(a.isNullOrUndefined)(j)&&j.length>0){var x=E(j,_);Object(a.isNullOrUndefined)(x)||(y[w]=x.Label)}}break;case o.AttributeType.PartyList:y[N]=_;break;case o.AttributeType.String:case o.AttributeType.UniqueIdentifier:case o.AttributeType.Memo:y[N]=_;break;default:y[N]=_,S+=1,T.push({name:"key".concat(S,", attributeType").concat(S),value:"".concat(N,", ").concat(R)})}}}}return S>0&&f.warn("Default case for formatter values for ".concat(S," keys"),Object(c.addEventParameters)(d,T)),y}))).apply(this,arguments)}function C(e,t,r,n){return N.apply(this,arguments)}function N(){return(N=d((function*(e,t,r,n){var a,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},c=[];for(var l in t){var d=n[l];if(l.indexOf(u.Punctuation.dot)>-1){var p=b(l);if(i[p.alias]){var f=i[p.alias],h=p.attributeName,m=yield Object(s.getAttributeTypes)(r,[],f);d=m[h]}}switch(d){case o.AttributeType.Decimal:case o.AttributeType.Integer:case o.AttributeType.BigInt:case o.AttributeType.DateTime:case o.AttributeType.Double:case o.AttributeType.Money:c.push(l)}}yield null===(a=r.Formatter)||void 0===a?void 0:a.ensureMetadataPresent(e,c)}))).apply(this,arguments)}},9054:function(e,t,r){"use strict";r.r(t),r.d(t,"metadataCache",(function(){return R})),r.d(t,"getEntityLogicalName",(function(){return P})),r.d(t,"getEntityLogicalNameFromOtc",(function(){return A})),r.d(t,"getAttributeTypes",(function(){return M})),r.d(t,"getUserSettings",(function(){return w})),r.d(t,"getOrganizationSettings",(function(){return j})),r.d(t,"getfullnameconventioncode",(function(){return U})),r.d(t,"getLanguageCode",(function(){return q})),r.d(t,"getUserId",(function(){return B})),r.d(t,"getUserName",(function(){return G})),r.d(t,"isFeatureEnabled",(function(){return z})),r.d(t,"getViewMetadata",(function(){return W})),r.d(t,"getEntityMetadata",(function(){return K})),r.d(t,"populateAllEntityMetadata",(function(){return Z})),r.d(t,"getAttributesMetadata",(function(){return ee})),r.d(t,"getAttributesMetadataFromStateAndMetadataCache",(function(){return re})),r.d(t,"getOfflineAvailableEntities",(function(){return ne})),r.d(t,"fromNumberAttributeType",(function(){return ye})),r.d(t,"getViewSqlResults",(function(){return ut})),r.d(t,"getEntitySqlResults",(function(){return lt})),r.d(t,"getAttributesSqlResults",(function(){return pt})),r.d(t,"getUserContextResults",(function(){return ht})),r.d(t,"getBooleanValue",(function(){return vt})),r.d(t,"getAvailableOfflineValue",(function(){return gt})),r.d(t,"getViewIdValue",(function(){return Ot})),r.d(t,"getEntity1NavigationPropertyNameValue",(function(){return Et})),r.d(t,"getEntity2NavigationPropertyNameValue",(function(){return bt})),r.d(t,"getIntersectEntityNameValue",(function(){return Tt})),r.d(t,"getReferencedEntityNavigationPropertyNameValue",(function(){return St})),r.d(t,"getRelationShipTypeValue",(function(){return Ct}));var n=r(9055),a=r(9047),i=r(9056),o=r(9057),s=r(9064),u=r(9048),c=r(9051),l=r(9063),d=r(9065),p=r(9046),f=r(9067),h=r(9050),m=r(9058),y=r(9072),v=r(9045),g=r(9073),O=r(9074),E=r(9076),b=r(9075),T=r(9077),S=r(9078),C=r(9079);function N(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function _(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){N(i,n,a,o,s,"next",e)}function s(e){N(i,n,a,o,s,"throw",e)}o(void 0)}))}}var R={views:{},entities:{},attributes:{},userContext:{}};function P(e,t){return I.apply(this,arguments)}function I(){return(I=_((function*(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=performance.now(),s=e.TraceManager.getTracer(a.COMPONENT_NAMES.MetadataCache);if(r=O.getEntityLogicalName(e,t,n),Object(h.isNullOrUndefinedOrEmptyString)(r)){var u=R.entities;if(r=Object(E.searchEntityLogicalNameFromEntityMetadata)(u,t,s,n),Object(h.isNullOrUndefined)(r)&&(u=yield Z(e,s,n),r=Object(E.searchEntityLogicalNameFromEntityMetadata)(u,t,s,n),Object(h.isNullOrUndefined)(r))){var c="Entity with entity set name ".concat(t," not found in offline metadata");return s.error("".concat(yt()," ").concat(c),Object(m.addEventParameters)(n,n)),Promise.reject(new i.LocalError(c,v.ErrorCode.QueryBuilderNoEntity))}}return _t("getEntityLogicalName",o,e,n),r}))).apply(this,arguments)}function A(e,t){return D.apply(this,arguments)}function D(){return(D=_((function*(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=performance.now(),o=e.TraceManager.getTracer(a.COMPONENT_NAMES.MetadataCache),s=O.getEntityLogicalNameFromOtc(e,t,r);if(Object(h.isNullOrUndefinedOrEmptyString)(s)){var u=R.entities;if(s=Object(E.searchEntityLogicalNameFromObjectTypeCode)(u,t,o,r),Object(h.isNullOrUndefined)(s)&&(u=yield Z(e,o,r),s=Object(E.searchEntityLogicalNameFromObjectTypeCode)(u,t,o,r),Object(h.isNullOrUndefined)(s))){var c="Entity with object type code ".concat(t," not found in offline metadata");return o.error("".concat(yt()," ").concat(c),Object(m.addEventParameters)(r,r)),Promise.reject(new i.LocalError(c,v.ErrorCode.QueryBuilderNoEntity))}}return _t("getEntityLogicalNameFromOtc",n,e,r),s}))).apply(this,arguments)}function M(e,t,r){return F.apply(this,arguments)}function F(){return(F=_((function*(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=performance.now(),o=yield z(e,g.MDLMetadataCachePerfSizeCapture),s=new C.MemoryCalculator(R,o);s.calculateBefore();var u=e.TraceManager.getTracer(a.COMPONENT_NAMES.MetadataCache),c={},l=yield O.getAttributeTypes(e,t,r,n);if(null!==l)c=l;else{var d=yield ee(e,r,t,n);if(Object(h.isNullOrUndefined)(d))u.error("".concat(yt()," Retrieved null or undefined attribute metadata"),n);else if(d&&Object.keys(d).length>0)if(t.length>0){for(var p of t)if(d[p]){var f=d[p];c[p]=f.Type}}else{var m=Object.keys(d);for(var y of m)if(d[y]){var v=d[y];c[y]=v.Type}}}return s.calculateAfter(),Nt(s,n),_t("getAttributeTypes",i,e,n),c}))).apply(this,arguments)}function w(e){return L.apply(this,arguments)}function L(){return(L=_((function*(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=performance.now();try{var a=yield O.getUserSettings(e,r);if(null!==a)t=a;else{if(!R.userContext||!R.userContext.userSettings||!R.userContext.userSettings.languageid||Object(h.isNullOrUndefined)(R.userContext.userSettings.timezoneutcoffsetminutes)||Object(h.isNullOrUndefined)(R.userContext.userSettings.timezoneadjusters)||Object(h.isNullOrUndefined)(R.userContext.userSettings.datetimeformatinfo))return Le(e,r);t=R.userContext.userSettings}}catch(i){return Promise.reject(i)}return _t("getUserSettings",n,e,r),t}))).apply(this,arguments)}function j(e){return x.apply(this,arguments)}function x(){return(x=_((function*(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=performance.now();try{var a=yield O.getOrganizationSettings(e,r);t=a||(R.userContext&&R.userContext.organizationSettings&&R.userContext.organizationSettings.fullnameconventioncode&&R.userContext.organizationSettings.languageCode?R.userContext.organizationSettings:yield xe(e,r))}catch(i){return Promise.reject(i)}return _t("getOrganizationSettings",n,e,r),t}))).apply(this,arguments)}function U(e){return k.apply(this,arguments)}function k(){return(k=_((function*(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=performance.now();try{var a=yield O.getFullNameConventionCode(e,r);t=a||(R.userContext&&R.userContext.organizationSettings&&R.userContext.organizationSettings.fullnameconventioncode?R.userContext.organizationSettings.fullnameconventioncode:yield qe(e,r))}catch(i){return Promise.reject(i)}return _t("getfullnameconventioncode",n,e,r),t}))).apply(this,arguments)}function q(e){return V.apply(this,arguments)}function V(){return(V=_((function*(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=performance.now();try{var a=yield O.getLanguageCode(e,r);t=a||(R.userContext&&R.userContext.organizationSettings&&R.userContext.organizationSettings.languageCode?R.userContext.organizationSettings.languageCode:yield Be(e,r))}catch(i){return Promise.reject(i)}return _t("getLanguageCode",n,e,r),t}))).apply(this,arguments)}function B(e){return H.apply(this,arguments)}function H(){return(H=_((function*(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=performance.now();try{var a=yield O.getUserId(e,r);t=a?p.Guid.toString(a):R.userContext&&R.userContext.userid?p.Guid.toString(R.userContext.userid):yield Ge(e,r)}catch(i){return Promise.reject(i)}return _t("getUserId",n,e,r),t}))).apply(this,arguments)}function G(e){return Q.apply(this,arguments)}function Q(){return(Q=_((function*(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=performance.now();try{var a=yield O.getUserName(e,r);t=a||(R.userContext&&R.userContext.username?R.userContext.username:yield ze(e,r))}catch(i){return Promise.reject(i)}return _t("getUserName",n,e,r),t}))).apply(this,arguments)}function z(e,t){return X.apply(this,arguments)}function X(){return(X=_((function*(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=performance.now(),o=e.TraceManager.getTracer(a.COMPONENT_NAMES.MetadataCache),s=yield O.isFeatureEnabled(e,t,n);if(null!==s)r=s;else if(R.userContext&&R.userContext.fcbContext&&!Object(h.isNullOrUndefined)(R.userContext.fcbContext[t])){var u=R.userContext.fcbContext[t];r=void 0===u.value?u:u.value}else r=yield We(e,t,n);return o.info("".concat(yt()," The fcbContext for ").concat(t," return ").concat(r," value.")),_t("isFeatureEnabled",i,e,n),r}))).apply(this,arguments)}function W(e,t,r){return Y.apply(this,arguments)}function Y(){return(Y=_((function*(e,t,r){var n,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=performance.now();try{var o=yield O.getViewMetadata(e,t,r,a);n=o||(R.views&&R.views[t]?R.views[t]:yield Ke(e,t,a))}catch(s){return Promise.reject(s)}return _t("getViewMetadata",i,e,a),n}))).apply(this,arguments)}function K(e,t){return J.apply(this,arguments)}function J(){return(J=_((function*(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=performance.now(),o=new C.MemoryCalculator(R,!0);if(o.calculateBefore(),Object(h.isNullOrUndefinedOrEmpty)(e)||Object(h.isNullOrUndefinedOrEmptyString)(t))throw new i.LocalError("Invalid parameters",v.ErrorCode.UnknownBadRequestError);n.push({name:"entity",value:t});try{var s=yield O.getEntityMetadata(e,t,n);if(s)r=s;else if(R.entities&&R.entities[t])r=R.entities[t];else{if(r=yield Oe(e,t,n),!R.entities||!R.entities[t]){var u="Entity metadata is not available";return Promise.reject(new i.LocalError(u,v.ErrorCode.QueryBuilderNoEntity))}r=R.entities[t]}}catch(c){return Promise.reject(c)}return o.calculateAfter(),Nt(o,n),_t("entityMetadata",a,e,n),r}))).apply(this,arguments)}function Z(e,t){return $.apply(this,arguments)}function $(){return($=_((function*(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=yield et(e,r),a=[],s=0,u={sqlStatements:[],sqlParameters:new Array,additionalParameters:{}},c="SELECT id, json FROM [entitymetadata] WHERE [logicalname] = ?";if(!Object(h.isNullOrUndefined)(n)&&n.length>0){for(s=0;s<n.length;s++){var l=n.item(s),p=l.logicalname,f=[p];u.sqlStatements.push(c),u.sqlParameters.push(f)}a.push({name:"MetadataRequestedForEntityNames",value:u.sqlParameters.toString()}),a.push({name:"NoOfEntityMetadataRequested",value:u.sqlParameters.length});var y=yield Object(o.getBatchSqlResults)(e,u);if(!y||!y.length){var v="requested entity metadata not found";throw t.error("".concat(yt()," requested entity metadata was not returned from offline DB."),Object(m.addEventParameters)(r,a)),new Error(v)}var g=[],O=[],E=0;for(s=0;s<y.length;s++){var b=y[s].rows.item(0),T=JSON.parse(b.json),S=d.EntityMetadata.createFromObjectData(T),C=S.getODataObject();if(be(e,C,C.LogicalName),Object(h.isNullOrUndefined)(C.LogicalName)){var N,_;E++;var P=null===(N=u.sqlParameters)||void 0===N||null===(_=N[s])||void 0===_?void 0:_.toString();O.push(P);var I=Object(m.addEventParameters)(r,a);I.push({name:"ResultIndex",value:s}),I.push({name:"EntityNameRequested",value:P}),I.push({name:"RawDetails",value:C}),t.error("".concat(yt()," Entity LogicalName is null for requested metadata at index"),I)}else g.push(C.LogicalName)}return a.push({name:"NoOfEntityMetadataReturned",value:y.length}),a.push({name:"MetadataReturnedForEntityNames",value:g.toString()}),a.push({name:"ErroredEntityNames",value:O.toString()}),a.push({name:"NoOfErrors",value:E}),t.warn("".concat(yt()," All entity metadata populated."),Object(m.addEventParameters)(r,a)),R.entities}var A="No entities returned from entity metadata db when populating all entity metadata";return t.error("".concat(yt()," ").concat(A),Object(m.addEventParameters)(r,a)),Promise.reject(new i.LocalError(A))}))).apply(this,arguments)}function ee(e,t,r){return te.apply(this,arguments)}function te(){return(te=_((function*(e,t,r){var n,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=performance.now();try{var o=yield se(e,t,r,a),s=yield ce(e,t,o,a);if(R.attributes[t]=Object.assign({},R.attributes[t],s),n=(yield O.isFeatureEnabled(e,g.MDLUseStateOverMetadataCache))?re(e,t,r):R.attributes[t],r&&r.length>0){var u={};r.forEach(e=>{u[e]=n[e]}),n=u}}catch(c){return Promise.reject(c)}return _t("getAttributesMetadata",i,e,a),n}))).apply(this,arguments)}function re(e,t,r){var n,i,o,s=null===(n=e.TraceManager)||void 0===n?void 0:n.getTracer(a.COMPONENT_NAMES.MetadataCache),u=null===(i=e.ApplicationState)||void 0===i||null===(o=i.metadata)||void 0===o?void 0:o.attributes,c={},l=[];if(!r||!r.length)return Object.assign({},null!=u&&u[t]?Object(E.getInitializedStateAttributes)(u[t]):{},R.attributes[t]?R.attributes[t]:{});if(r.forEach(e=>{u&&u[t]&&u[t][e]&&u[t][e].Initialized===b.InitState.Initialized?c[e]=u[t][e]:R.attributes&&R.attributes[t]&&R.attributes[t][e]?c[e]=R.attributes[t][e]:l.push(e)}),l.length>=1){var d=[];d.push({name:"MissingAttributesInStateAndMetadataCache",value:l.join(",")}),s.warn("".concat(yt()," Did not find attribute metadata in neither the injected state nor the metadataCache for entity '").concat(t,"'. Check event context for the missing attributes."),d)}return c}function ne(e,t){return ae.apply(this,arguments)}function ae(){return(ae=_((function*(e,t){var r,n=performance.now();try{var a=yield O.getOfflineAvailableEntities(e,t);if(a)r=a;else if(R.userContext&&R.userContext.offlineProfile&&R.userContext.offlineProfile.offlineAvailableEntities){var i;r=null===(i=R.userContext.offlineProfile)||void 0===i?void 0:i.offlineAvailableEntities}else r=yield ie(e,t)}catch(o){return Promise.reject(o)}return _t("getOfflineAvailableEntities",n,e,t),r}))).apply(this,arguments)}function ie(e,t){return oe.apply(this,arguments)}function oe(){return(oe=_((function*(e,t){var r=e.TraceManager.getTracer(a.COMPONENT_NAMES.MetadataCache);return yield at(e,t),Object(h.isNullOrUndefined)(R.userContext)||Object(h.isNullOrUndefined)(R.userContext.offlineProfile)||Object(h.isNullOrUndefined)(R.userContext.offlineProfile.offlineAvailableEntities)?(r.warn("".concat(yt()," No offline available entities are found, return empty list"),t),[]):R.userContext.offlineProfile.offlineAvailableEntities}))).apply(this,arguments)}function se(e,t,r){return ue.apply(this,arguments)}function ue(){return(ue=_((function*(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=[...r],o=e.TraceManager.getTracer(a.COMPONENT_NAMES.MetadataCache),s=yield K(e,t),u=s.AttributeNames;if(r&&r.length||(i=u),u&&u.length>0?(u.indexOf("statecode")>=0&&i.indexOf("statecode")<0&&i.push("statecode"),u.indexOf("statuscode")>=0&&i.indexOf("statuscode")<0&&i.push("statuscode")):o.warn("".concat(yt()," No entity attributes are found for entity = ").concat(t,",\n      and requested attributes = ").concat(i.join(","),", return empty list"),n),yield O.isFeatureEnabled(e,g.MDLUseStateOverMetadataCache)){var c=O.getAttributesPresentInState(e,t),l=R.attributes&&R.attributes[t]?R.attributes[t]:{};return Object(E.computeRequestedAttrDiffWithStatePlusMetadataCache)(c,l,i)}for(var d=R.attributes&&R.attributes[t]?R.attributes[t]:{},p=[],f=0;f<i.length;f++)d[i[f]]||p.push(i[f]);return p}))).apply(this,arguments)}function ce(e,t,r){return le.apply(this,arguments)}function le(){return(le=_((function*(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a={};if(r.length){var i=yield Ze(e,t,r,n);if(i&&Object.keys(i).length>0)for(var o in i)if(i.hasOwnProperty(o)){var s=i[o],u=de(e,s);a[o]=u}}return a}))).apply(this,arguments)}function de(e,t){var r=t,n=c.DateTimeFieldBehavior.None;if(r.DateTimeBehavior)for(var a in r.DateTimeBehavior)if(r.DateTimeBehavior.hasOwnProperty(a))switch(r.DateTimeBehavior[a]){case"None":n=c.DateTimeFieldBehavior.None;break;case"DateOnly":n=c.DateTimeFieldBehavior.DateOnly;break;case"TimeZoneIndependent":n=c.DateTimeFieldBehavior.TimeZoneIndependent;break;case"UserLocal":n=c.DateTimeFieldBehavior.UserLocal;break;default:n=c.DateTimeFieldBehavior.None}var i=Object(y.isEntityPayloadReductionRequested)(e),o=Object(y.isSecondPhaseEntityPayloadReductionEnabled)(e);return{LogicalName:t.LogicalName,Id:p.Guid.tryParseOrNull(t.MetadataId),EntityLogicalName:r.EntityLogicalName,Type:ve(t),DisplayName:Object(y.getLabelString)(i,o,r.DisplayName),Description:Object(y.getLabelString)(i,o,r.Description),IsGlobalFilterEnabled:!!r.IsGlobalFilterEnabled&&r.IsGlobalFilterEnabled.Value,IsSecured:r.IsSecured,IsSortableEnabled:!!r.IsSortableEnabled&&r.IsSortableEnabled.Value,IsEntityReferenceStored:r.IsEntityReferenceStored,IsValidForAdvancedFind:!!r.IsValidForAdvancedFind&&r.IsValidForAdvancedFind.Value,IsValidForCreate:r.IsValidForCreate,IsValidForRead:r.IsValidForRead,IsValidForUpdate:r.IsValidForUpdate,IsRetrievable:Object(y.GetNullableBooleanValue)(i,o,r.IsRetrievable),IsCustomAttribute:Object(y.GetNullableBooleanValue)(i,o,r.IsCustomAttribute),ColumnNumber:r.ColumnNumber,MaxLength:r.MaxLength,MinValue:r.MinValue,MaxValue:r.MaxValue,Precision:r.Precision,PrecisionSource:r.PrecisionSource,Format:me(r),Behavior:n,DefaultFormValue:r.DefaultFormValue,DefaultValue:"number"==typeof r.DefaultFormValue?r.DefaultFormValue:Object(y.GetNullableBooleanValue)(i,o,r.DefaultValue),IsBaseCurrency:Object(y.GetNullableBooleanValue)(i,o,r.IsBaseCurrency),Targets:r.Targets,AttributeOf:r.AttributeOf,HasChanged:Object(y.GetNullableBooleanValue)(i,o,r.HasChanged),ImeMode:he(r.ImeMode),OptionSetId:r.OptionSet&&r.OptionSet.MetadataId?r.OptionSet.MetadataId:null,OptionSetName:r.OptionSet&&r.OptionSet.Name?r.OptionSet.Name:null,OptionSetType:r.OptionSet?Object(y.getOptionSetTypeValue)(i,o,r.OptionSet.OptionSetType):null,OptionSet:pe(e,r.OptionSet),ParentPicklistLogicalName:r.OptionSet&&r.ParentPicklistLogicalName?r.ParentPicklistLogicalName:null,ChildPicklistLogicalNames:r.OptionSet&&r.ChildPicklistLogicalNames?r.ChildPicklistLogicalNames:null,RequiredLevel:ge(r.RequiredLevel),SourceType:r.SourceType,SourceTypeMask:r.SourceTypeMask,InheritsFrom:r.InheritsFrom,CanBeSecuredForCreate:Object(y.GetNullableBooleanValue)(i,o,r.CanBeSecuredForCreate),CanBeSecuredForRead:Object(y.GetNullableBooleanValue)(i,o,r.CanBeSecuredForRead),CanBeSecuredForUpdate:Object(y.GetNullableBooleanValue)(i,o,r.CanBeSecuredForUpdate)}}function pe(e,t){var r=[];if(t&&(r=[],t.FalseOption&&r.push(fe(e,t.FalseOption)),t.TrueOption&&r.push(fe(e,t.TrueOption)),t.Options)){var n=t.Options;for(var a of n)r.push(fe(e,a))}return r}function fe(e,t){var r=Object(y.isEntityPayloadReductionRequested)(e),n=Object(y.isSecondPhaseEntityPayloadReductionEnabled)(e),a=t.TransitionData;return{Color:t.Color,Label:Object(y.getLabelString)(r,n,t.Label),Value:t.Value,DefaultStatus:t.DefaultStatus,State:t.State,TransitionData:a?[]:null,InvariantName:t.InvariantName,ParentValues:t.ParentValues}}function he(e){if("string"!=typeof e)return"number"==typeof e?e:null;switch(e){case"Auto":return 0;case"Inactive":return 1;case"Active":return 2;case"Disabled":return 3;default:return null}}function me(e){var t=e,r=t.FormatName?t.FormatName.Value:null;return function(e,t,r){if(t)return t;var n="";if(null==r)n=r;else if(e&&e===u.AttributeType.DateTime)switch(r){case l.DateTimeFormat.DateOnly:n=u.AttributeType.Date;break;case l.DateTimeFormat.DateAndTime:n=u.AttributeType.DateTime;break;default:n=r.toString()}else n=r.toString();return n}(ye(t.AttributeType),r,t.Format)}function ye(e){switch(e){case f.NumberAttributeType.Boolean:return u.AttributeType.Boolean;case f.NumberAttributeType.Customer:return u.AttributeType.Customer;case f.NumberAttributeType.DateTime:return u.AttributeType.DateTime;case f.NumberAttributeType.Decimal:return u.AttributeType.Decimal;case f.NumberAttributeType.Double:return u.AttributeType.Double;case f.NumberAttributeType.Integer:return u.AttributeType.Integer;case f.NumberAttributeType.Lookup:return u.AttributeType.Lookup;case f.NumberAttributeType.Memo:return u.AttributeType.Memo;case f.NumberAttributeType.Money:return u.AttributeType.Money;case f.NumberAttributeType.Owner:return u.AttributeType.Owner;case f.NumberAttributeType.PartyList:return u.AttributeType.PartyList;case f.NumberAttributeType.Picklist:return u.AttributeType.PickList;case f.NumberAttributeType.State:return u.AttributeType.State;case f.NumberAttributeType.Status:return u.AttributeType.Status;case f.NumberAttributeType.String:return u.AttributeType.String;case f.NumberAttributeType.UniqueIdentifier:return u.AttributeType.UniqueIdentifier;case f.NumberAttributeType.CalendarRules:return u.AttributeType.CalendarRules;case f.NumberAttributeType.Virtual:return u.AttributeType.Virtual;case f.NumberAttributeType.BigInt:return u.AttributeType.BigInt;case f.NumberAttributeType.ManagedProperty:return u.AttributeType.ManagedProperty;case f.NumberAttributeType.EntityName:return u.AttributeType.EntityName;case f.NumberAttributeType.AliasedValue:return u.AttributeType.AliasedValue;case f.NumberAttributeType.EntityImage:return u.AttributeType.EntityImage;case f.NumberAttributeType.MultiSelectPicklist:return u.AttributeType.MultiSelectPickList;case f.NumberAttributeType.File:return u.AttributeType.File;case f.NumberAttributeType.NavigationProperty:return u.AttributeType.NavigationProperty;default:return u.AttributeType.Unknown}}function ve(e){if(!e)return u.AttributeType.Unknown;var t=u.AttributeType.Unknown;return"AttributeTypeName"in e&&e.AttributeTypeName.Value?t=e.AttributeTypeName.Value.replace(/Type/g,""):"AttributeType"in e&&e.AttributeType&&"string"==typeof e.AttributeType&&(t=e.AttributeType),t?"Float"===t?u.AttributeType.Double:t.toLowerCase():u.AttributeType.Unknown}function ge(e){if(!Object(h.isNullOrUndefined)(e)){var t;if("string"==typeof(t=Object(h.isNullOrUndefined)(e.Value)?e:e.Value))switch(e){case"None":return n.AttributeRequiredLevel.None;case"SystemRequired":return n.AttributeRequiredLevel.SystemRequired;case"ApplicationRequired":return n.AttributeRequiredLevel.ApplicationRequired;case"Recommended":return n.AttributeRequiredLevel.Recommended;default:return n.AttributeRequiredLevel.Unknown}if("number"==typeof t)return t}return-1}function Oe(e,t){return Ee.apply(this,arguments)}function Ee(){return(Ee=_((function*(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=yield rt(e,t,n);return a&&(r=yield be(e,a,t)),r}))).apply(this,arguments)}function be(e,t,r){return Te.apply(this,arguments)}function Te(){return(Te=_((function*(e,t,r){var n=Object(y.isEntityPayloadReductionRequested)(e),a=Object(y.isSecondPhaseEntityPayloadReductionEnabled)(e),i={Id:p.Guid.tryParseOrNull(t.Id),EntityLogicalName:t.LogicalName,DisplayName:Object(y.getLabelString)(n,a,t.DisplayName),EntitySetName:t.EntitySetName,PrimaryKeyName:t.PrimaryIdAttribute,ObjectTypeCode:t.ObjectTypeCode,PrimaryIdAttribute:t.PrimaryIdAttribute,PrimaryNameAttribute:t.PrimaryNameAttribute,PrimaryImageAttribute:t.PrimaryImageAttribute,EntityColor:Object(y.getEntityColorValue)(n,a,t.EntityColor),ActivityTypeMask:t.ActivityTypeMask,AutoRouteToOwnerQueue:Object(y.GetNullableBooleanValue)(n,a,t.AutoRouteToOwnerQueue),DisplayCollectionName:Object(y.getLabelString)(n,a,t.DisplayCollectionName),CanTriggerWorkflow:Object(y.GetNullableBooleanValue)(n,a,t.CanTriggerWorkflow),Description:Object(y.getLabelString)(n,a,t.Description),IsDocumentManagementEnabled:Object(y.GetNullableBooleanValue)(n,a,t.IsDocumentManagementEnabled),IsOneNoteIntegrationEnabled:Object(y.GetNullableBooleanValue)(n,a,t.IsOneNoteIntegrationEnabled),IsMSTeamsIntegrationEnabled:Object(y.GetNullableBooleanValue)(n,a,t.IsMSTeamsIntegrationEnabled),IsDocumentRecommendationsEnabled:Object(y.GetNullableBooleanValue)(n,a,t.IsDocumentRecommendationsEnabled),IsInteractionCentricEnabled:Object(y.GetNullableBooleanValue)(n,a,t.IsInteractionCentricEnabled),IsKnowledgeManagementEnabled:Object(y.GetNullableBooleanValue)(n,a,t.IsKnowledgeManagementEnabled),IsActivity:Object(y.GetNullableBooleanValue)(n,a,t.IsActivity),IsActivityParty:Object(y.GetNullableBooleanValue)(n,a,t.IsActivityParty),IsChildEntity:Object(y.GetNullableBooleanValue)(n,a,t.IsChildEntity),IsCollaboration:ke(t.IsValidForQueue),IsConnectionsEnabled:ke(t.IsConnectionsEnabled),IsCustomEntity:Object(y.GetNullableBooleanValue)(n,a,t.IsCustomEntity),IsBusinessProcessEnabled:Object(y.GetNullableBooleanValue)(n,a,t.IsBusinessProcessEnabled),IsCustomizable:ke(t.IsCustomizable),IsOptimisticConcurrencyEnabled:Object(y.GetNullableBooleanValue)(n,a,t.IsOptimisticConcurrencyEnabled),IsImportable:Object(y.GetNullableBooleanValue)(n,a,t.IsImportable),IsIntersect:Object(y.GetNullableBooleanValue)(n,a,t.IsIntersect),IsMailMergeEnabled:ke(t.IsMailMergeEnabled),IsEnabledForCharts:Object(y.GetNullableBooleanValue)(n,a,t.IsEnabledForCharts),IsValidForAdvancedFind:Object(y.GetNullableBooleanValue)(n,a,t.IsValidForAdvancedFind),IsVisibleInMobileClient:ke(t.IsVisibleInMobileClient),IsReadOnlyInMobileClient:ke(t.IsReadOnlyInMobileClient),IsOfflineInMobileClient:ke(t.IsOfflineInMobileClient),IsQuickCreateEnabled:Object(y.GetNullableBooleanValue)(n,a,t.IsQuickCreateEnabled),EntityClientSetting:t.EntityClientSetting,OwnershipType:t.OwnershipType,HasChanged:Object(y.GetNullableBooleanValue)(n,a,t.HasChanged),HasStateCode:we(t),IsStateModelAware:Object(y.GetNullableBooleanValue)(n,a,t.IsStateModelAware),EnforceStateTransitions:Object(y.GetNullableBooleanValue)(n,a,t.EnforceStateTransitions),Privileges:t.Privileges||[],IconVectorName:t.IconVectorName,IsBPFEntity:Object(y.GetNullableBooleanValue)(n,a,t.IsBPFEntity),DataProviderId:p.Guid.tryParseOrNull(t.DataProviderId),IsEnabledInUnifiedInterface:!!Object(h.isNullOrUndefined)(t.IsVisibleInMobileClient)||(t.IsVisibleInMobileClient.Value||t.IsVisibleInMobileClient.CanBeChanged),VersionNumber:t.VersionNumber,OverallVersionNumber:t.OverallVersionNumber,AttributeNames:t.AttributeNames,IsAuditEnabled:t.IsAuditEnabled};return t.OneToManyRelationships&&(i.OneToManyRelationships=Fe(e,t.OneToManyRelationships,t,!1,De),i.HasActivities=Se(i.OneToManyRelationships,"activitypointer","regardingobjectid"),i.HasNotes=Se(i.OneToManyRelationships,"annotation","objectid")),t.ManyToOneRelationships&&(i.ManyToOneRelationships=Fe(e,t.ManyToOneRelationships,t,!1,De)),t.ManyToManyRelationships&&(i.ManyToManyRelationships=Fe(e,t.ManyToManyRelationships,t,!1,Me)),R.entities=Object.assign({},R.entities,{[r]:i}),i}))).apply(this,arguments)}function Se(e,t,r){if(null===e)return!1;for(var n in e)if(e[n].ReferencingEntity===t&&e[n].ReferencingAttribute===r)return!0;return!1}function Ce(e,t,r){if(Object(h.isNullOrUndefined)(t))return null;var n=Object(y.isEntityPayloadReductionRequested)(e),a=Object(y.isSecondPhaseEntityPayloadReductionEnabled)(e);return{Behavior:r?Ne(t.Behavior):Object(y.getAssociatedMenuBehaviorValue)(n,a,t.Behavior),Group:r?_e(t.Group):Object(y.getAssociatedMenuGroupValue)(n,a,t.Group),Label:Object(y.getLabelString)(n,a,t.Label),Order:t.Order,AvailableOffline:gt(n,t.AvailableOffline),Icon:t.Icon,IsCustomizable:vt(n,t.IsCustomizable),MenuId:t.MenuId,QueryApi:t.QueryApi,ViewId:Ot(n,p.Guid.tryParseOrNull(t.ViewId)),ExtensionData:t.ExtensionData}}function Ne(e){if("string"!=typeof e)return"number"==typeof e?e:0;switch(e){case"UseCollectionName":return 0;case"UseLabel":return 1;case"DoNotDisplay":return 2;default:return 0}}function _e(e){if("string"!=typeof e)return"number"==typeof e?e:0;switch(e){case"Details":return 0;case"Sales":return 1;case"Service":return 2;case"Marketing":return 3;default:return 0}}function Re(e){if("string"!=typeof e)return"number"==typeof e?e:0;switch(e){case"NoCascade":return 0;case"Cascade":return 1;case"Active":return 2;case"UserOwned":return 3;case"RemoveLink":return 4;case"Restrict":return 5;default:return 0}}function Pe(e){if("string"!=typeof e)return"number"==typeof e?e:0;switch(e){case"None":return 0;case"Append":return 1;case"ParentChild":return 2;case"Pointer":return 4;case"Inheritance":return 8;default:return 0}}function Ie(e){if("string"!=typeof e)return"number"==typeof e?e:-1;switch(e){case"OneToManyRelationship":return 0;case"ManyToManyRelationship":return 1;default:return-1}}function Ae(e,t,r){var n=Object(y.isEntityPayloadReductionRequested)(e),a=Object(y.isSecondPhaseEntityPayloadReductionEnabled)(e);return{IsCustomRelationship:t.IsCustomRelationship,IsCustomizable:ke(t.IsCustomizable),IsValidForAdvancedFind:t.IsValidForAdvancedFind,SchemaName:t.SchemaName,SecurityTypes:r?Pe(t.SecurityTypes):t.SecurityTypes,IsManaged:Object(y.getIsManagedValue)(n,a,t),RelationshipType:r?Ie(t.RelationshipType):Ct(n,t.RelationshipType),IntroducedVersion:t.IntroducedVersion}}function De(e,t,r,n){var a=Ce(e,t.AssociatedMenuConfiguration,n),i=function(e,t,r){var n=Object(y.isEntityPayloadReductionRequested)(e),a=Object(y.isSecondPhaseEntityPayloadReductionEnabled)(e);return r?{Assign:Re(t.Assign),Delete:Re(t.Delete),Merge:Re(t.Merge),Reparent:Re(t.Reparent),Share:Re(t.Share),Unshare:Re(t.Unshare),ExtensionData:t.ExtensionData}:{Assign:Object(y.getCascadeTypeValue)(n,a,null==t?void 0:t.Assign),Delete:Object(y.getCascadeTypeValue)(n,a,t.Delete),Merge:Object(y.getCascadeTypeValue)(n,a,t.Merge),Reparent:Object(y.getCascadeTypeValue)(n,a,t.Reparent),Share:Object(y.getCascadeTypeValue)(n,a,t.Share),Unshare:Object(y.getCascadeTypeValue)(n,a,t.Unshare),ExtensionData:t.ExtensionData}}(e,t.CascadeConfiguration,n),o=Object(y.isEntityPayloadReductionRequested)(e),s=Object(y.isSecondPhaseEntityPayloadReductionEnabled)(e);return Object.assign({AssociatedMenuConfiguration:a,CascadeConfiguration:i,ReferencedAttribute:t.ReferencedAttribute,ReferencedEntity:Object(y.getReferencedEntityValue)(o,s,t,r),ReferencingAttribute:t.ReferencingAttribute,ReferencingEntity:Object(y.getReferencingEntityValue)(o,s,t,r),IsHierarchical:Object(y.getIsHierarchicalValue)(o,s,t.IsHierarchical),ReferencedEntityNavigationPropertyName:St(o,t),ReferencingEntityNavigationPropertyName:Object(y.getReferencingEntityNavigationPropertyNameValue)(o,s,t)},Ae(e,t,n))}function Me(e,t,r,n){var a=Object(y.isEntityPayloadReductionRequested)(e);return Object.assign({Entity1AssociatedMenuConfiguration:Ce(e,t.Entity1AssociatedMenuConfiguration,n),Entity2AssociatedMenuConfiguration:Ce(e,t.Entity2AssociatedMenuConfiguration,n),Entity1LogicalName:t.Entity1LogicalName,Entity2LogicalName:t.Entity2LogicalName,IntersectEntityName:Tt(a,t),Entity1IntersectAttribute:t.Entity1IntersectAttribute,Entity2IntersectAttribute:t.Entity2IntersectAttribute,Entity1NavigationPropertyName:Et(a,t),Entity2NavigationPropertyName:bt(a,t)},Ae(e,t,n))}function Fe(e,t,r,n,a){if(!t)return null;var i={};for(var o of t){var s=a(e,o,r,n);i[o.SchemaName]=s}return i}function we(e){if(!e||!e.AttributeNames)return!1;for(var t of e.AttributeNames)if("statecode"===t.toLowerCase())return!0;return!1}function Le(e){return je.apply(this,arguments)}function je(){return(je=_((function*(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(yield at(e,t),R.userContext&&R.userContext.userSettings&&R.userContext.userSettings.languageid&&!Object(h.isNullOrUndefined)(R.userContext.userSettings.timezoneutcoffsetminutes)&&!Object(h.isNullOrUndefined)(R.userContext.userSettings.timezoneadjusters)&&!Object(h.isNullOrUndefined)(R.userContext.userSettings.datetimeformatinfo))return R.userContext.userSettings;var r="UserSettings is empty or does not contains all required dependencies";return Promise.reject(new i.LocalError(r))}))).apply(this,arguments)}function xe(e){return Ue.apply(this,arguments)}function Ue(){return(Ue=_((function*(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(yield at(e,t),Object(h.isNullOrUndefined)(R.userContext.organizationSettings)||Object(h.isNullOrUndefined)(R.userContext.organizationSettings.fullnameconventioncode)||Object(h.isNullOrUndefined)(R.userContext.organizationSettings.languageCode)){var r="OrganizationSettings is empty or does not contains all required dependencies";return Promise.reject(new i.LocalError(r))}return R.userContext.organizationSettings}))).apply(this,arguments)}function ke(e){return e?e.Value:null}function qe(e){return Ve.apply(this,arguments)}function Ve(){return(Ve=_((function*(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(yield at(e,t),Object(h.isNullOrUndefined)(R.userContext.organizationSettings)||Object(h.isNullOrUndefined)(R.userContext.organizationSettings.fullnameconventioncode)){var r="fullnameconventioncode is empty";return Promise.reject(new i.LocalError(r))}return R.userContext.organizationSettings.fullnameconventioncode}))).apply(this,arguments)}function Be(e){return He.apply(this,arguments)}function He(){return(He=_((function*(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(yield at(e,t),Object(h.isNullOrUndefined)(R.userContext.organizationSettings)||Object(h.isNullOrUndefined)(R.userContext.organizationSettings.languageCode)){var r="languageCode is empty";return Promise.reject(new i.LocalError(r))}return R.userContext.organizationSettings.languageCode}))).apply(this,arguments)}function Ge(e){return Qe.apply(this,arguments)}function Qe(){return(Qe=_((function*(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(yield at(e,t),Object(h.isNullOrUndefined)(R.userContext.userid)){var r="userid is empty";return Promise.reject(new i.LocalError(r))}return p.Guid.toString(R.userContext.userid)}))).apply(this,arguments)}function ze(e){return Xe.apply(this,arguments)}function Xe(){return(Xe=_((function*(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(yield at(e,t),Object(h.isNullOrUndefined)(R.userContext.username)){var r="username is empty";return Promise.reject(new i.LocalError(r))}return R.userContext.username}))).apply(this,arguments)}function We(e,t){return Ye.apply(this,arguments)}function Ye(){return(Ye=_((function*(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(yield at(e,r),Object(h.isNullOrUndefined)(R.userContext.fcbContext)||Object(h.isNullOrUndefined)(R.userContext.fcbContext[t]))return!1;var n=R.userContext.fcbContext[t];return void 0===n.value?n:n.value}))).apply(this,arguments)}function Ke(e,t){return Je.apply(this,arguments)}function Je(){return(Je=_((function*(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=yield ot(e,t,r),a={viewId:new p.Guid(n.ViewId),fetchXML:n.FetchXml,entityLogicalName:n.EntityLogicalName,queryApi:n.QueryApi,columnXML:n.ColumnXml,title:n.Title,idColumName:n.IdColumnName,queryType:n.QueryType,layoutXML:n.LayoutXml,offlineSqlQuery:n.OfflineSqlQuery?n.OfflineSqlQuery:null,versionNumber:n.VersionNumber,OverallVersionNumber:n.OverallVersionNumber,OverallUserVersionNumber:n.OverallUserVersionNumber,isUserView:n.IsUserView};return R.views=Object.assign({},R.views,{[t]:a}),a}))).apply(this,arguments)}function Ze(e,t,r){return $e.apply(this,arguments)}function $e(){return($e=_((function*(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=e.TraceManager.getTracer(a.COMPONENT_NAMES.MetadataCache),o=yield pt(e,t,r,n);if(!o||!o.length){var u="requested attributes metadata not found for entity = ".concat(t,", attributes = ").concat(r.join());throw new Error(u)}if(o.length>1){var c="Results[] returned from getAttributesSqlResults() has length = ".concat(o.length);i.warn("".concat(yt()," ").concat(c),n)}for(var l={},d=o[0],p=0;p<d.rows.length;p++){var f=d.rows.item(p),h=JSON.parse(f.json);try{var m=s.AttributeMetadata.createFromObjectData(h);l[m.get_logicalName()]=m.getODataObject()}catch(y){throw y}}return l}))).apply(this,arguments)}function et(e){return tt.apply(this,arguments)}function tt(){return(tt=_((function*(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r="select logicalname from entitymetadata",n=[],a=yield Object(o.getSqlResults)(e,r,n,t);if(!a||!a.length){var i="requested  metadata not found for entity";throw new Error(i)}var s=a[0].rows;return s}))).apply(this,arguments)}function rt(e,t){return nt.apply(this,arguments)}function nt(){return(nt=_((function*(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=null==e?void 0:e.TraceManager.getTracer(a.COMPONENT_NAMES.MetadataCache),s=yield lt(e,t,n);if(!s||!s.length){var u="requested entity metadata not found for entity = ".concat(t);throw new i.LocalError(u,v.ErrorCode.QueryBuilderNoEntity)}if(s[0].rows&&s[0].rows.length>0){var c=s[0].rows.item(0),l=JSON.parse(c.json),p=d.EntityMetadata.createFromObjectData(l);r=p.getODataObject()}else o.warn("".concat(yt()," Got 0 result rows for entity metadata ").concat(t),n);return r}))).apply(this,arguments)}function at(e){return it.apply(this,arguments)}function it(){return(it=_((function*(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=yield ht(e,t);if(Object(h.isNullOrUndefined)(r)||Object(h.isNullOrUndefined)(r[0])||Object(h.isNullOrUndefined)(r[0].rows)||Object(h.isNullOrUndefined)(r[0].rows.item(0))){var n="user context returned from Database is empty";return Promise.reject(new i.LocalError(n))}var a=r[0].rows.item(0),o=JSON.parse(a.json);return R.userContext=Object.assign({},R.userContext,{userid:new p.Guid(o.userid.rawguid),username:o.username,fcbContext:o.fcbcontext,userSettings:o.usersettings,organizationSettings:o.organizationsettings?{languageCode:o.organizationsettings.languagecode,fullnameconventioncode:o.organizationsettings.fullnameconventioncode}:o.organizationsettings,offlineProfile:o.offlineprofile?{offlineAvailableEntities:o.offlineprofile.offlineavailableentities,profileId:o.offlineprofile.profileid,profileVersion:o.offlineprofile.profileversion}:o.offlineprofile}),o}))).apply(this,arguments)}function ot(e,t){return st.apply(this,arguments)}function st(){return(st=_((function*(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=yield ut(e,t,r),a=n&&n.length&&n[0].rows&&n[0].rows.item(0);if(!a){var i="requested view metadata not found, ViewId = ".concat(t);throw new Error(i)}var o=JSON.parse(a.json),s=o.data;return s}))).apply(this,arguments)}function ut(e,t){return ct.apply(this,arguments)}function ct(){return(ct=_((function*(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n="select * from applicationmetadata where id = ?",a=[Object(h.getViewLocalStoreId)(t)],i=yield Object(o.getSqlResults)(e,n,a,r);return i}))).apply(this,arguments)}function lt(e,t){return dt.apply(this,arguments)}function dt(){return(dt=_((function*(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n="SELECT id, json FROM [entitymetadata] WHERE [logicalname] = ?",a=[t],i=yield Object(o.getSqlResults)(e,n,a,r);return i}))).apply(this,arguments)}function pt(e,t,r){return ft.apply(this,arguments)}function ft(){return(ft=_((function*(e,t,r){for(var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a="select * from attributemetadata where entitylogicalname = ? and logicalname in (",i=0;i<r.length-1;i++)a+="?,";a+="?)";var s=[t,...r],u=yield Object(o.getSqlResults)(e,a,s,n);return u}))).apply(this,arguments)}function ht(e,t){return mt.apply(this,arguments)}function mt(){return(mt=_((function*(e,t){var r={};return r[S.MetadataFields.METADATA_TYPE]=[T.MetadataType.userContext],yield Object(o.getSqlResults)(e,"select * from usercontext",[],t,void 0,r)}))).apply(this,arguments)}function yt(e){return"[".concat(e||a.FILE_PREFIX.MetadataCache,"]")}function vt(e,t){return(!e||!Object(h.isNullOrUndefined)(t))&&t}function gt(e,t){return!(!e||!Object(h.isNullOrUndefined)(t))||t}function Ot(e,t){return e&&Object(h.isNullOrUndefined)(t)?p.Guid.EMPTY:t}function Et(e,t){return e&&Object(h.isNullOrUndefined)(t.Entity1NavigationPropertyName)?t.SchemaName:t.Entity1NavigationPropertyName}function bt(e,t){return e&&Object(h.isNullOrUndefined)(t.Entity2NavigationPropertyName)?t.SchemaName:t.Entity2NavigationPropertyName}function Tt(e,t){return e&&Object(h.isNullOrUndefined)(t.IntersectEntityName)?t.SchemaName:t.IntersectEntityName}function St(e,t){return e&&Object(h.isNullOrUndefined)(t.ReferencedEntityNavigationPropertyName)?t.SchemaName:t.ReferencedEntityNavigationPropertyName}function Ct(e,t){return e&&Object(h.isNullOrUndefined)(t)?n.RelationshipType.OneToManyRelationship:t}function Nt(e,t){var r=t.find(e=>e.name===a.EVENT_PARAMETERS.METADATACACHE_BEFORESIZE);Object(h.isNullOrUndefined)(r)?t.push({name:a.EVENT_PARAMETERS.METADATACACHE_BEFORESIZE,value:e.getBeforeSize()}):r.value=e.getBeforeSize();var n=t.find(e=>e.name===a.EVENT_PARAMETERS.METADATACACHE_AFTERSIZE);Object(h.isNullOrUndefined)(n)?t.push({name:a.EVENT_PARAMETERS.METADATACACHE_AFTERSIZE,value:e.getAfterSize()}):n.value=e.getAfterSize()}function _t(e,t,r){var n,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],o=performance.now()-t,s=[];s.push({name:a.EVENT_PARAMETERS.RESPONSE_TIME,value:o}),s.push({name:a.EVENT_PARAMETERS.METADATA_CACHE_OPERATION,value:e}),null==r||null===(n=r.EventManager)||void 0===n||n.ReportComponentSuccess(yt(),Object(m.addEventParameters)(i,s))}},9055:function(e,t,r){"use strict";var n,a,i,o,s,u,c,l,d,p,f,h,m,y,v;r.r(t),r.d(t,"OptionSetType",(function(){return n})),r.d(t,"DateTimeFormat",(function(){return a})),r.d(t,"ImeMode",(function(){return i})),r.d(t,"StringFormat",(function(){return o})),r.d(t,"AttributeTypeCode",(function(){return s})),r.d(t,"AttributeRequiredLevel",(function(){return u})),r.d(t,"SecurityTypes",(function(){return c})),r.d(t,"RelationshipType",(function(){return l})),r.d(t,"AssociatedMenuBehavior",(function(){return d})),r.d(t,"AssociatedMenuGroup",(function(){return p})),r.d(t,"OwnershipTypes",(function(){return f})),r.d(t,"CascadeType",(function(){return h})),r.d(t,"PrivilegeType",(function(){return m})),r.d(t,"EntityKeyIndexStatus",(function(){return y})),r.d(t,"AttributeType",(function(){return v})),function(e){e[e.Picklist=0]="Picklist",e[e.State=1]="State",e[e.Status=2]="Status",e[e.Boolean=3]="Boolean"}(n||(n={})),function(e){e[e.DateOnly=0]="DateOnly",e[e.DateAndTime=1]="DateAndTime"}(a||(a={})),function(e){e[e.Auto=0]="Auto",e[e.Inactive=1]="Inactive",e[e.Active=2]="Active",e[e.Disabled=3]="Disabled"}(i||(i={})),function(e){e[e.Email=0]="Email",e[e.Text=1]="Text",e[e.TextArea=2]="TextArea",e[e.Url=3]="Url",e[e.TickerSymbol=4]="TickerSymbol",e[e.PhoneticGuide=5]="PhoneticGuide",e[e.VersionNumber=6]="VersionNumber",e[e.Phone=7]="Phone"}(o||(o={})),function(e){e[e.Boolean=0]="Boolean",e[e.Customer=1]="Customer",e[e.DateTime=2]="DateTime",e[e.Decimal=3]="Decimal",e[e.Double=4]="Double",e[e.Integer=5]="Integer",e[e.Lookup=6]="Lookup",e[e.Memo=7]="Memo",e[e.Money=8]="Money",e[e.Owner=9]="Owner",e[e.PartyList=10]="PartyList",e[e.Picklist=11]="Picklist",e[e.State=12]="State",e[e.Status=13]="Status",e[e.String=14]="String",e[e.Uniqueidentifier=15]="Uniqueidentifier",e[e.CalendarRules=16]="CalendarRules",e[e.Virtual=17]="Virtual",e[e.BigInt=18]="BigInt",e[e.ManagedProperty=19]="ManagedProperty",e[e.EntityName=20]="EntityName",e[e.AliasedValue=21]="AliasedValue",e[e.ArrayOfString=22]="ArrayOfString",e[e.EntityImage=23]="EntityImage",e[e.MultiSelectPicklist=24]="MultiSelectPicklist",e[e.File=25]="File",e[e.NavigationProperty=26]="NavigationProperty"}(s||(s={})),function(e){e[e.None=0]="None",e[e.SystemRequired=1]="SystemRequired",e[e.ApplicationRequired=2]="ApplicationRequired",e[e.Recommended=3]="Recommended",e[e.Unknown=-1]="Unknown"}(u||(u={})),function(e){e[e.None=0]="None",e[e.Append=1]="Append",e[e.ParentChild=2]="ParentChild",e[e.Pointer=4]="Pointer",e[e.Inheritance=8]="Inheritance"}(c||(c={})),function(e){e[e.OneToManyRelationship=0]="OneToManyRelationship",e[e.ManyToManyRelationship=1]="ManyToManyRelationship",e[e.ManyToOneRelationship=2]="ManyToOneRelationship",e[e.None=-1]="None"}(l||(l={})),function(e){e[e.UseCollectionName=0]="UseCollectionName",e[e.UseLabel=1]="UseLabel",e[e.DoNotDisplay=2]="DoNotDisplay"}(d||(d={})),function(e){e[e.Details=0]="Details",e[e.Sales=1]="Sales",e[e.Service=2]="Service",e[e.Marketing=3]="Marketing"}(p||(p={})),function(e){e[e.None=0]="None",e[e.UserOwned=1]="UserOwned",e[e.TeamOwned=2]="TeamOwned",e[e.BusinessOwned=4]="BusinessOwned",e[e.OrganizationOwned=8]="OrganizationOwned",e[e.BusinessParented=16]="BusinessParented"}(f||(f={})),function(e){e[e.NoCascade=0]="NoCascade",e[e.Cascade=1]="Cascade",e[e.Active=2]="Active",e[e.UserOwned=3]="UserOwned",e[e.RemoveLink=4]="RemoveLink",e[e.Restrict=5]="Restrict"}(h||(h={})),function(e){e[e.None=0]="None",e[e.Create=1]="Create",e[e.Read=2]="Read",e[e.Write=3]="Write",e[e.Delete=4]="Delete",e[e.Assign=5]="Assign",e[e.Share=6]="Share",e[e.Append=7]="Append",e[e.AppendTo=8]="AppendTo"}(m||(m={})),function(e){e[e.Pending=0]="Pending",e[e.InProgress=1]="InProgress",e[e.Active=2]="Active",e[e.Failed=3]="Failed"}(y||(y={})),function(e){e.Boolean="boolean",e.Unknown="unknown",e.Customer="customer",e.Date="date",e.DateTime="datetime",e.Decimal="decimal",e.Double="double",e.Image="image",e.Integer="integer",e.Lookup="lookup",e.ManagedProperty="managedproperty",e.Memo="memo",e.Money="money",e.OptionSet="optionset",e.Owner="owner",e.PartyList="partylist",e.PickList="picklist",e.State="state",e.Status="status",e.String="string",e.UniqueIdentifier="uniqueidentifier",e.CalendarRules="calendarrules",e.Virtual="virtual",e.BigInt="bigint",e.EntityName="entityname",e.EntityImage="entityimage",e.AliasedValue="aliasedvalue",e.Regarding="regarding",e.MultiSelectPickList="multiselectpicklist",e.File="file",e.NavigationProperty="navigationproperty"}(v||(v={}))},9056:function(e,t,r){"use strict";r.r(t),r.d(t,"LocalError",(function(){return n}));class n{constructor(e,t,r,n){this.message=void 0,this.code=void 0,this.stack=void 0,this.name=void 0,this.message=e,this.code=t,this.stack=r,this.name=n}}},9057:function(e,t,r){"use strict";r.r(t),r.d(t,"getSqlResults",(function(){return c})),r.d(t,"getBatchSqlResults",(function(){return d}));var n=r(9058),a=r(9045),i=r(9050),o=r(9047);function s(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function u(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){s(i,n,a,o,u,"next",e)}function u(e){s(i,n,a,o,u,"throw",e)}o(void 0)}))}}function c(e,t,r){return l.apply(this,arguments)}function l(){return(l=u((function*(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},c=e.TraceManager.getTracer(o.COMPONENT_NAMES.MetadataCache),l=[...n];c.info("".concat(f()," Starting getSqlResults"),l);var d={sqlStatements:[],sqlParameters:new Array,additionalParameters:u};d.sqlStatements.push(t),d.sqlParameters.push(r),d=Object(i.addClientRequestIdToSqlQueryRequests)(d,s,c);try{var p,h,m,y,v,g=yield null===(p=e.SqlExecutor)||void 0===p?void 0:p.executeSqlStatementsOnMetadataDB(d);return c.info("".concat(f()," Completed getSqlResults")),(Object(i.isNullOrUndefinedOrEmpty)(g)||g&&(null===(h=g[0])||void 0===h||!h.rows||(null===(m=g[0])||void 0===m?void 0:m.rows.length)<=0))&&l.push({name:"ExecuteSQLQuery",value:d.sqlStatements.toString()}),Object(i.isNullOrUndefinedOrEmpty)(g)?c.warn("".concat(f()," executeSqlStatementOnMetadataDB returned no result in getSqlResults."),l):g&&(null===(y=g[0])||void 0===y||!y.rows||(null===(v=g[0])||void 0===v?void 0:v.rows.length)<=0)&&c.warn("".concat(f()," executeSqlStatementOnMetadataDB returned 0 rows getSqlResults."),l),g}catch(E){var O=Object(i.convertErrorToLocalError)(E);return l.push({name:a.STRING_CONSTANTS.Message,value:O.message}),l.push({name:a.STRING_CONSTANTS.ErrorCode,value:O.code?O.code:a.UNKNOWN}),l.push({name:a.STRING_CONSTANTS.StackTrace,value:O.stack?O.stack:a.UNKNOWN}),c.error("".concat(f()," Exception in getSqlResults. Error message = ").concat(E.message),l),Promise.reject(O)}}))).apply(this,arguments)}function d(e,t){return p.apply(this,arguments)}function p(){return(p=u((function*(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=e.TraceManager.getTracer(o.COMPONENT_NAMES.MetadataCache),u=r.commonEventParameters||[],c=[];t=Object(i.addClientRequestIdToSqlQueryRequests)(t,r,s),c.push({name:"NoOfSQLStatements",value:t&&t.sqlStatements?t.sqlStatements.length:0}),s.info("".concat(f()," Starting getBatchSqlResults. "),Object(n.addEventParameters)(u,c));try{var l,d=yield null===(l=e.SqlExecutor)||void 0===l?void 0:l.executeSqlStatementsOnMetadataDB(t);return s.info("".concat(f()," Completed getBatchSqlResults"),Object(n.addEventParameters)(u,c)),Object(i.isNullOrUndefinedOrEmpty)(d)&&s.warn("".concat(f()," getBatchSqlResults return empty result"),Object(n.addEventParameters)(u,c)),d}catch(h){var p=Object(i.convertErrorToLocalError)(h);return c.push({name:a.STRING_CONSTANTS.Message,value:p.message}),c.push({name:a.STRING_CONSTANTS.ErrorCode,value:p.code?p.code:a.UNKNOWN}),c.push({name:a.STRING_CONSTANTS.StackTrace,value:p.stack?p.stack:a.UNKNOWN}),s.error("".concat(f()," Exception in getBatchSqlResults. Error message = ").concat(h.message),Object(n.addEventParameters)(u,c)),Promise.reject(p)}}))).apply(this,arguments)}function f(e){return"[".concat(e||o.FILE_PREFIX.GetSqlResults,"]")}},9058:function(e,t,r){"use strict";r.r(t),r.d(t,"addEventParameters",(function(){return d})),r.d(t,"addRequestDetailsToEventParameters",(function(){return p})),r.d(t,"addResponseDetailsToEventParameters",(function(){return f})),r.d(t,"addErrorInformationToEventParameters",(function(){return h})),r.d(t,"addSqlQueriesToEventParameters",(function(){return m})),r.d(t,"addResponseErrorInformationToEventParameters",(function(){return y})),r.d(t,"retrieveExecutionTimeDetails",(function(){return E})),r.d(t,"extractSqlErrorMessage",(function(){return b}));var n=r(9059),a=r(9061),i=r(9045),o=r(9047),s=r(9062),u=r(9050);function c(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function l(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){c(i,n,a,o,s,"next",e)}function s(e){c(i,n,a,o,s,"throw",e)}o(void 0)}))}}function d(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return t.concat(e)}function p(e,t,r){t.push({name:i.HEADER.CLIENT_REQUEST_ID,value:Object(u.getClientRequestId)(e)||o.EVENT_PARAMETERS.EMPTY_STRING}),t.push({name:o.EVENT_PARAMETERS.CLIENT_REQUEST_ID,value:Object(u.getClientRequestId)(e)||o.EVENT_PARAMETERS.EMPTY_STRING}),t.push({name:o.EVENT_PARAMETERS.END_POINT,value:e.endpoint||i.UNKNOWN}),t.push({name:o.EVENT_PARAMETERS.METHOD,value:e.method||i.UNKNOWN}),t.push({name:o.EVENT_PARAMETERS.REQUEST_URL,value:Object(s.trimUrl)(e.url||"")});var n=Object(u.getClientType)(e);t.push({name:o.EVENT_PARAMETERS.CLIENT_TYPE,value:n}),r=r||Object(a.getRequestType)(e),t.push({name:o.EVENT_PARAMETERS.OPERATION_TYPE,value:"".concat(r)})}function f(e,t){var r=e.status||o.EVENT_PARAMETERS.EMPTY_STRING,n=e.statusText||o.EVENT_PARAMETERS.EMPTY_STRING,a=Object(s.trimUrl)(e.url)||o.EVENT_PARAMETERS.EMPTY_STRING;if(!Object(u.isNullOrUndefined)(e.headers)){var c=e.headers,l=Object(u.getHttpHeader)(c,i.HEADER.SERVER_REQUEST_ID)||o.EVENT_PARAMETERS.EMPTY_STRING;t.push({name:o.EVENT_PARAMETERS.SERVER_REQUEST_ID,value:l});var d=Object(u.getHttpHeader)(c,i.HEADER.CONTENT_LENGTH)||o.EVENT_PARAMETERS.EMPTY_STRING;t.push({name:o.EVENT_PARAMETERS.RESPONSE_SIZE_IN_BYTES,value:d})}t.push({name:o.EVENT_PARAMETERS.HTTP_STATUS_CODE,value:r}),t.push({name:o.EVENT_PARAMETERS.HTTP_RESPONSE_STATUS_TEXT,value:n}),t.push({name:o.EVENT_PARAMETERS.RESPONSE_URL,value:a})}function h(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Object(u.isNullOrUndefined)(e)||(t.push({name:o.EVENT_PARAMETERS.ERROR_CODE,value:e[i.STRING_CONSTANTS.ErrorCode]||o.EVENT_PARAMETERS.EMPTY_STRING}),t.push({name:o.EVENT_PARAMETERS.ERROR_STACK,value:e[i.STRING_CONSTANTS.StackTrace]||e[i.STRING_CONSTANTS.Stack]||o.EVENT_PARAMETERS.EMPTY_STRING}),t.push({name:o.EVENT_PARAMETERS.ERROR_MESSAGE,value:e[i.STRING_CONSTANTS.Message]||o.EVENT_PARAMETERS.EMPTY_STRING}),r&&t.push({name:o.EVENT_PARAMETERS.ERROR_COMPLETE_TEXT,value:JSON.stringify(e)}))}function m(e,t){if(!Object(u.isNullOrUndefined)(e)&&!Object(u.isNullOrUndefined)(e.sqlStatements))for(var r=/'\w+.*?\'/g,n=0;n<e.sqlStatements.length;n++){var a=Object(u.isNullOrUndefined)(e.sqlStatements[n])?"":e.sqlStatements[n].replace(r,"'X'");t.push({name:o.EVENT_PARAMETERS.SQL_QUERY+n,value:a})}}function y(e,t,r){return v.apply(this,arguments)}function v(){return(v=l((function*(e,t,r){try{if(r===i.OPERATION.Batch){var a=yield Object(n.extractIndividualResponsesFromBatchResponse)(e);for(var o of a)if(!o.ok){g(o,t),f(e,t);break}}else g(e,t),f(e,t);return t}catch(s){return t}}))).apply(this,arguments)}function g(e,t){return O.apply(this,arguments)}function O(){return(O=l((function*(e,t){var r=yield e.text(),n={},a=!1;try{n=JSON.parse(r).error||{},a=Object(s.canLogDetailsOfRequest)(e.url)}catch(o){n[i.STRING_CONSTANTS.Message]=r}h(n,t,a)}))).apply(this,arguments)}function E(e,t){var r=[];for(var n in t){var a=e.getPerformanceEntry(t[n]);a&&a.performanceMeasure&&a.performanceStatistic&&(1===a.performanceStatistic.count?(r.push({name:"".concat(t[n],"-startTime"),value:a.performanceMeasure.startTime||0}),r.push({name:"".concat(t[n],"-endTime"),value:a.performanceMeasure.endTime||0})):a.performanceStatistic.count>1&&(r.push({name:"".concat(t[n],"-totalDuration"),value:a.performanceStatistic.totalDuration||0}),r.push({name:"".concat(t[n],"-averageDuration"),value:a.performanceStatistic.averageDuration||0}),r.push({name:"".concat(t[n],"-executionCount"),value:a.performanceStatistic.count||0})))}return r}function b(e){var t="";try{if(!Object(u.isNullOrUndefinedOrEmptyString)(e)){var r=JSON.parse(e);if(!Object(u.isNullOrUndefinedOrEmpty)(r.results))for(var n of r.results)n.result&&(Array.isArray(n.result)&&n.result.length>0&&!Object(u.isNullOrUndefinedOrEmptyString)(n.result[0].message)?t=t+n.result[0].message+";\n":Object(u.isNullOrUndefinedOrEmptyString)(n.result.message)||(t=t+n.result.message+";\n"))}}catch(a){t=e}return t}},9059:function(e,t,r){"use strict";r.r(t),r.d(t,"extractIndividualResponsesFromBatchResponse",(function(){return s})),r.d(t,"FetchLikeHeaders",(function(){return d}));var n=r(9050),a=r(9060);function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function s(e){return e.text().then(t=>{var r=[],i="";if(e.headers){var o=Object(n.getHttpHeader)(e.headers,"Content-Type");if(o){var s=o.match(/boundary=(.*)/);i=s?s[1]:""}}else i=t.substr(t.indexOf("batchresponse"),t.indexOf("\r\n")-2);var c=Object(a.splitByBoundary)(i,t);for(var d of c){var p=/^\s*Content-Type: .*boundary=(.*)\r?\n/gi.exec(d);if(p){var f=p[1],h=d.indexOf("--"+f),m=d.slice(h),y=Object(a.splitByBoundary)(f,m).map(u);r.push(...y)}else{var v=u(d);r.push(v)}}if(0===r.length){var g=l(e.status,e.statusText,e.headers,t);r.push(g)}return r})}function u(e){var t=-1!==e.indexOf("\r\n\r\n"),r=e.trim().split(t?"\r\n\r\n":"\n\n"),n=0,a=new d({}),i=null,o="",s="";if(r.length>0){var u=null;r.length>1&&(u=r[1].split(t?"\r\n":"\n"));var p=[];null!=u&&(p=u.slice(1),i=/(HTTP\/\d\.\d) (\d+) (.*)/gi.exec(u[0]));var f=r[0].split(t?"\r\n":"\n");if(null!=f)for(var h of f)0===h.toLowerCase().indexOf("content-id:")&&p.push(h);n=i&&i.length>=3?Number(i[2]):0,a=new d(p.reduce(c,{})),r.length>1&&(s=r[2]),null!=i&&i.length>2&&(o=i[3])}return l(n,o,a,s)}function c(e,t){var r=t.indexOf(":");if(r>=0){var n=t.substring(0,r),a=t.substring(r+1).trim();e[n]=a}return e}function l(e,t,r,n){return{status:e,ok:e>=200&&e<=299,statusText:t,headers:r,clone(){return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},this)},json:()=>Promise.resolve(n?JSON.parse(n):null),text:()=>Promise.resolve(n)}}class d{constructor(e){this._headers=void 0,this._headers=e}append(e,t){this._headers[e]=t}get(e){return this._headers[e]}has(e){return this._headers.hasOwnProperty(e)}delete(e){delete this._headers[e]}set(e,t){this._headers[e]=t}forEach(e){for(var t in this._headers)e(this._headers[t],t,this)}}},9060:function(e,t,r){"use strict";r.r(t),r.d(t,"extractIndividualRequests",(function(){return s})),r.d(t,"splitByBoundary",(function(){return c}));var n=r(9058),a=r(9050),i=r(9047),o=/--batch_.*/;function s(e,t,r){var n=e.body,i=[];if(Object(a.isNullOrUndefinedOrEmptyString)(n))return i;var s=n.split(o);for(var l of s){var d=/^\s*Content-Type: .*boundary=(.*)\r?\n/gi.exec(l);if(d){if(d.length<=1||!d[1].trim())throw new Error("Error when parsing batch requests. Expected Changeset boundary is missing.");var p=d[1].trim(),f=l.indexOf("--"+p),h=c(p,l.slice(f));for(var m of h)if(0!==m.trim().length){var y=u(m,t,r);Object(a.isNullOrUndefined)(y)||i.push(y)}}else{if(0===l.trim().replace(/\0+$/,"").length)continue;var v=u(l,t,r);Object(a.isNullOrUndefined)(v)||i.push(v)}}return i}function u(e,t,r){var a,o="",s="",u={},c=e.split(/[\r\n]\s*[\r\n]/g),l=c.length>0?c[0].trim():"",d=c.length>1?c[1].trim():"";a=c.length>2?c[2].trim():"";var p=[...d.split("\n"),...l.split("\n")];for(var f of p)if(0!==f.trim().length&&/\S/.test(f.trim()))if((f=f.trim()).startsWith("GET")||f.startsWith("PUT")||f.startsWith("PATCH")||f.startsWith("POST")||f.startsWith("DELETE")){var h=f.split(/\s+/);o=h[0],s=h[1]}else{var m=f.split(":");if(!m||m.length<2)continue;u[m[0].trim()]=m[1].trim()}if(s&&o)return{url:s,method:o,additionalHeaders:u,body:a};var y,v=[];return v.push({name:"url",value:s}),v.push({name:"method",value:o}),v.push({name:"urlPart",value:d}),t.error("".concat("[".concat(y||i.FILE_PREFIX.BatchRequestParser,"]")," could not parse an individual request. Skipping"),Object(n.addEventParameters)(r,v)),null}function c(e,t){if(!t)return[];var r="--"+e+"\r\n";0===t.indexOf(r)||(r="--"+e+"\n");var n=t.split(r);if(n.splice(0,1),n.length>0){var a=n[n.length-1],i=a.indexOf("--"+e);n[n.length-1]=a.substring(0,i)}return n}},9061:function(e,t,r){"use strict";r.r(t),r.d(t,"getRequestType",(function(){return s}));var n=r(9045),a=r(9058),i=r(9047),o={};function s(e,t){var r=t?t.TraceManager.getTracer(i.COMPONENT_NAMES.UrlParserHandler):null,s=[];Object(a.addRequestDetailsToEventParameters)(e,s,n.UNKNOWN);var u,c="";switch(e.method){case n.HTTP_REQUEST_METHOD.Post:c=-1!==e.url.indexOf("/$batch")?o[e.method].Batch:-1!==e.url.indexOf("/$ref")?o[e.method].Update:o[e.method].Create;break;case n.HTTP_REQUEST_METHOD.Get:if(e.url.match("/GetClientMetadata"))c=o[e.method].GetClientMetadata;else{var l=e.url.indexOf("("),d=e.url.indexOf("?");-1===l&&-1===d&&(c=o[e.method].RetrieveMultiple);var p=e.url.lastIndexOf("/");c=-1!==l&&-1!==d?l<d?p>l?o[e.method].RetrieveMultiple:o[e.method].Retrieve:o[e.method].RetrieveMultiple:-1===l||p>l?o[e.method].RetrieveMultiple:o[e.method].Retrieve}break;case n.HTTP_REQUEST_METHOD.Patch:c=e.additionalHeaders&&"application/octet-stream"===e.additionalHeaders["Content-Type"]?o[e.method].Upload:o[e.method].Patch;break;case n.HTTP_REQUEST_METHOD.Delete:c=e.url.lastIndexOf(")")+1>=e.url.length||e.url.indexOf("$filter")>=0||-1!==e.url.indexOf("/$ref")?o[e.method].Delete:o[e.method].FileDelete;break;default:if(r)throw r.error("".concat("[".concat(u||i.FILE_PREFIX.UrlParserHandler,"]")," ").concat("Request type is not supported"),s),new Error("Request type is not supported");c=n.UNKNOWN}return c}o[n.HTTP_REQUEST_METHOD.Post]={Batch:n.OPERATION.Batch,Create:n.OPERATION.Create,Update:n.OPERATION.Update},o[n.HTTP_REQUEST_METHOD.Get]={GetClientMetadata:n.OPERATION.GetClientMetadata,RetrieveMultiple:n.OPERATION.RetrieveMultiple,Retrieve:n.OPERATION.Retrieve},o[n.HTTP_REQUEST_METHOD.Patch]={Patch:n.OPERATION.Update,Upload:n.OPERATION.Upload},o[n.HTTP_REQUEST_METHOD.Delete]={Delete:n.OPERATION.Delete,FileDelete:n.OPERATION.FileDelete}},9062:function(e,t,r){"use strict";r.r(t),r.d(t,"trimUrl",(function(){return o})),r.d(t,"canLogDetailsOfRequest",(function(){return s}));var n=r(9050),a=r(9063),i=r(9045);function o(e){if(Object(n.isNullOrUndefinedOrEmptyString)(e))return e;if(s(e))return e;if(-1!==e.indexOf(i.FETCH_PREFIX)){var t=e.indexOf(i.FETCH_PREFIX),r=decodeURIComponent(e.substring(e.indexOf(i.FETCH_PREFIX)+i.FETCH_PREFIX.length,e.length));return"".concat(e.substring(0,t+i.FETCH_PREFIX.length)).concat(function(e){var t=new DOMParser,r=new XMLSerializer;if(e){var n=t.parseFromString(e,"text/xml");if(n){var a=Array.prototype.slice.call(n.getElementsByTagName("condition"));return a&&a.forEach(e=>{e.getAttribute("value")&&e.setAttribute("value","X"),e.getAttribute("uiname")&&e.setAttribute("uiname","X");var t=Array.prototype.slice.call(e.getElementsByTagName("value"));t&&t.forEach(e=>{e.getAttribute("uiname")&&e.setAttribute("uiname","X"),e.textContent="X"})}),r.serializeToString(n)}return null}return null}(r))}var o=e.indexOf(a.Punctuation.question);if(-1===o){var u=e.indexOf(a.Punctuation.equal);return-1===u?e:e.substring(0,u)}return e.substring(0,o)}function s(e){return!Object(n.isNullOrUndefinedOrEmptyString)(e)&&(-1!==e.indexOf("GetClientMetadata")||-1!==e.indexOf("EntityDefinitions")||-1!==e.indexOf("SyncClientMetadata"))}},9063:function(e,t,r){"use strict";var n,a;r.r(t),r.d(t,"FieldFormatValue",(function(){return n})),r.d(t,"NumberAttributeType",(function(){return a})),r.d(t,"AnnotationEntityLogicalName",(function(){return u})),r.d(t,"FullNameConventionCode",(function(){return i})),r.d(t,"SqlOperation",(function(){return o})),r.d(t,"DateTimeFormat",(function(){return s})),r.d(t,"BulkOperation",(function(){return l})),r.d(t,"IncidentResolution",(function(){return d})),r.d(t,"OpportunityClose",(function(){return p})),r.d(t,"OrderClose",(function(){return f})),r.d(t,"QuoteClose",(function(){return h})),r.d(t,"RecurringAppointmentMaster",(function(){return m})),r.d(t,"SORT",(function(){return y})),r.d(t,"Punctuation",(function(){return v})),r.d(t,"OFFLINE_SQL_TOKEN",(function(){return g})),r.d(t,"DEFAULT",(function(){return O})),r.d(t,"FCB_CONSTANTS",(function(){return E})),r.d(t,"ERROR_STRING",(function(){return b})),r.d(t,"CLAUSE",(function(){return T})),r.d(t,"DateTimeConstants",(function(){return c})),r.d(t,"USER_ID_PLACE_HOLDER",(function(){return S})),r.d(t,"LANGUAGE_PLACE_HOLDER",(function(){return C})),r.d(t,"OPERATOR_PLACE_HOLDERS",(function(){return N})),r.d(t,"WHITE_SPACE_REGEX",(function(){return _})),r.d(t,"SUPPRESS_TRIGGERS_INSERT",(function(){return R})),r.d(t,"SUPPRESS_TRIGGERS_DELETE",(function(){return P})),function(e){e[e.Raw=0]="Raw",e[e.Numeric=1]="Numeric",e[e.Label=2]="Label",e[e.Value=3]="Value",e[e.State=4]="State",e[e.Id=5]="Id",e[e.Name=6]="Name",e[e.LogicalName=7]="LogicalName",e[e.AllowedStatusTransitions=8]="AllowedStatusTransitions",e[e.DefaultStatus=9]="DefaultStatus",e[e.Color=10]="Color"}(n||(n={})),function(e){e[e.Unknown=-1]="Unknown",e[e.Boolean=0]="Boolean",e[e.Customer=1]="Customer",e[e.DateTime=2]="DateTime",e[e.Decimal=3]="Decimal",e[e.Double=4]="Double",e[e.Integer=5]="Integer",e[e.Lookup=6]="Lookup",e[e.Memo=7]="Memo",e[e.Money=8]="Money",e[e.Owner=9]="Owner",e[e.PartyList=10]="PartyList",e[e.Picklist=11]="Picklist",e[e.State=12]="State",e[e.Status=13]="Status",e[e.String=14]="String",e[e.UniqueIdentifier=15]="UniqueIdentifier",e[e.CalendarRules=16]="CalendarRules",e[e.Virtual=17]="Virtual",e[e.BigInt=18]="BigInt",e[e.ManagedProperty=19]="ManagedProperty",e[e.EntityName=20]="EntityName",e[e.AliasedValue=21]="AliasedValue",e[e.EntityImage=23]="EntityImage",e[e.MultiSelectPicklist=24]="MultiSelectPicklist",e[e.File=25]="File",e[e.NavigationProperty=26]="NavigationProperty"}(a||(a={}));var i,o,s,u="annotation";!function(e){e[e.lastFirst=0]="lastFirst",e[e.firstLast=1]="firstLast",e[e.lastFirstMiddleInitial=2]="lastFirstMiddleInitial",e[e.firstMiddleInitialLast=3]="firstMiddleInitialLast",e[e.lastFirstMiddle=4]="lastFirstMiddle",e[e.firstMiddleLast=5]="firstMiddleLast",e[e.lastSpaceFirst=6]="lastSpaceFirst",e[e.lastNoSpaceFirst=7]="lastNoSpaceFirst"}(i||(i={})),function(e){e[e.create=0]="create",e[e.update=1]="update",e[e.delete=3]="delete"}(o||(o={})),function(e){e[e.DateOnly=0]="DateOnly",e[e.DateAndTime=1]="DateAndTime"}(s||(s={}));var c,l=4406,d=4206,p=4208,f=4209,h=4211,m=4251,y={ASC:"asc",DESC:"desc"},v={dot:".",closeSQBracket:"]",comma:",",doubleQuote:'"',openSQBracket:"[",singleQuote:"'",space:" ",exclamation:"!",equal:"=",question:"?",openParenthesis:"(",closeParenthesis:")",asterisk:"*",dollar:"$",plus:"+",forwardSlash:"/"},g={QUICKFIND_START:"/*QuickFindStart*/",QUICKFIND_END:"/*QuickFindEnd*/",SELECT_START:"/*SelectStart*/",SELECT_END:"/*SelectEnd*/",FROM_START:"/*FromStart*/",FROM_END:"/*FromEnd*/",CTE_START:"/*CTEStart*/",CTE_END:"/*CTEEnd*/",WHERE_START:"/*WhereStart*/",WHERE_END:"/*WhereEnd*/",ORDERBY_START:"/*OrderByStart*/",ORDERBY_END:"/*OrderByEnd*/",JOIN_START:"/*JoinStart*/",JOIN_END:"/*JoinEnd*/"},O={PageSize:"25",PageNumber:"1",EmptyString:""},E={SqlTokensAvailable:"UseOfflineSqlTokens",MdlUsesDependencyInformation:"MDLUsesDependencyInformation",ModernDataLayerMatchServerGCM:"ModernDataLayerMatchServerGCM",ModernDataLayerRMValidations:"ModernDataLayerRMValidations",CustomPageOffline:"CustomPageOffline"},b={primaryIdAttribute:"Entity metadata does not have primary id attribute",referencedId:"Missing ID of the referenced entity record.",invalidParameter:"Invalid parameters",invalidHints:"Invalid hint"},T={insert:"INSERT",select:"SELECT",update:"UPDATE",set:"SET",where:"WHERE",delete:"DELETE",orderBy:"ORDER BY",collateNoCase:"COLLATE NOCASE",limit:"LIMIT",offset:"OFFSET",from:"FROM",as:"AS",in:"IN",and:"AND",into:"INTO",values:"VALUES",placeholder:"?"};!function(e){e.on="on",e.onOrAfter="on-or-after",e.onOrBefore="on-or-before",e.yesterday="yesterday",e.today="today",e.tomorrow="tomorrow",e.last7Days="last-seven-days",e.next7Days="next-seven-days",e.lastWeek="last-week",e.thisWeek="this-week",e.nextWeek="next-week",e.lastMonth="last-month",e.thisMonth="this-month",e.nextMonth="next-month",e.lastYear="last-year",e.thisYear="this-year",e.nextYear="next-year",e.lastXDays="last-x-days",e.nextXDays="next-x-days",e.lastXWeeks="last-x-weeks",e.nextXWeeks="next-x-weeks",e.lastXMonths="last-x-months",e.nextXMonths="next-x-months",e.lastXYears="last-x-years",e.nextXYears="next-x-years",e.anyTime="not-null",e.startOfCurrentHourUTC="'!start-of-current-hour-utc!'",e.startOfTodayUTC="'!start-of-today-utc!'",e.startOfWorkWeekUTC="'!start-of-work-week-utc!'",e.startOfMonthUTC="'!start-of-month-utc!'",e.startOfYearUTC="'!start-of-year-utc!'",e.userTimezoneHourOffset="!user-timezone-hour-offset!",e.userTimezoneMinuteOffset="!user-timezone-minute-offset!",e.UTCHourOffset="!utc-hour-offset!",e.UTCMinuteOffset="!utc-minute-offset!"}(c||(c={}));var S='"!eq-userid!"',C={userLanguage:"@LanguageId0",basedLanguage:"@LanguageId1",columnName0:"@ObjectColumnName0",columnName1:"@ObjectColumnName1"},N=[S,C.userLanguage,C.basedLanguage,C.columnName0,C.columnName1,c.startOfCurrentHourUTC,c.startOfTodayUTC,c.startOfYearUTC,c.startOfMonthUTC,c.startOfWorkWeekUTC,c.userTimezoneHourOffset,c.userTimezoneMinuteOffset,c.UTCHourOffset,c.UTCMinuteOffset],_=new RegExp("\\s+","g"),R="INSERT INTO _NORSYNC_SUPPRESS_TRIGGERS(value) VALUES(1)",P="DELETE FROM _NORSYNC_SUPPRESS_TRIGGERS"},9064:function(e,t,r){"use strict";r.r(t),r.d(t,"AttributeMetadata",(function(){return c}));var n=r(9050),a=r(9048),i=r(9065),o=r(9049),s=r(9067),u=r(9068);class c{static extractKey(e){return o.LegacyGuid.createFromObjectData(e.id).toString()}static addValueWrapper(e){var t={};return t.Value=e,t}static removeValueWrapper(e){return e?e.Value:null}static createFromObjectData(e){Object(n.isNullOrUndefinedOrEmptyString)(e.MetadataId)||(e=c.createFromODataResponse(e).getObjectData());var t=new c(e.logicalname,o.LegacyGuid.createFromObjectData(e.id),e.entitylogicalname,Object(s.fromNumberAttributeType)(e.type),e.displayname,e.issecured,e.isvalidforcreate,e.isvalidforread,e.isvalidforupdate,e.requiredlevel,e.maxlength,e.minvalue,e.maxvalue,e.precision,e.precisionsource,e.format,e.behavior,e.defaultformvalue,e.defaultvalue,u.OptionSetMetadata.createFromObjectData(e.optionset),e.isbasecurrency,e.targets,e.attributeof,e.haschanged,e.imemode,e.issortableenabled,e.inheritsfrom,e.sourcetype,e.islocalizable,e.IsCustomAttribute,e.columnNumber);return t._formatName=e.formatName,t._description=e.description,t._sourceTypeMask=e.sourceTypeMask,t._attributeTypeName=e.attributeTypeName,t}static createFromODataResponse(e){var t=e.LogicalName,r=o.LegacyGuid.tryCreate(e.MetadataId),a=e.EntityLogicalName,l=Object(s.fromNumberAttributeType)(e.AttributeType),d=c.removeValueWrapper(e.AttributeTypeName),p=new RegExp("Type","g");if(Object(n.isNullOrUndefinedOrEmptyString)(d))throw new Error("Null or empty attribute type name in attribute metadata for entity ".concat(a," attribute type ").concat(l));"float"===(d=d.replace(p,"").toLowerCase())&&(d="double");var f,h=e.SourceType,m=i.EntityMetadata.getLabelString(e.Description),y=i.EntityMetadata.getLabelString(e.DisplayName),v=c.removeValueWrapper(e.RequiredLevel);f="string"==typeof v?Object(n.loadRequiredLevelFromCrmSoap)(v):v;var g=e.IsSecured,O=e.IsValidForCreate,E=e.IsValidForUpdate,b=e.IsValidForRead,T=e.ColumnNumber,S=e.SourceTypeMask,C=e.MaxLength,N=e.MinValue,_=e.MaxValue,R=e.Precision,P=e.PrecisionSource,I=e.Format,A=null;Object(n.isNullOrUndefined)(I)||(A=I.toString());var D=c.removeValueWrapper(e.FormatName),M=c.removeValueWrapper(e.DateTimeBehavior),F=0;Object(n.isNullOrUndefined)(M)||(F=Object(n.loadBehaviorFromCrmSoap)(M));var w=e.DefaultFormValue,L=e.DefaultValue,j=e.IsBaseCurrency,x=e.AttributeOf,U=e.HasChanged,k=c.removeValueWrapper(e.IsSortableEnabled),q=e.ImeMode,V=e.InheritsFrom,B=e.IsLocalizable,H=e.IsCustomAttribute,G=null,Q=e.OptionSet;if(!Object(n.isNullOrUndefined)(Q)){var z=Q.Options;if(Object(n.isNullOrUndefined)(z)){var X=Q.TrueOption,W=[Q.FalseOption,X];G=u.OptionSetMetadata.createFromOData(W)}else G=u.OptionSetMetadata.createFromOData(z)}var Y=e.Targets,K=new c(t,r,a,l,y,g,O,b,E,f,C,N,_,R,P,A,F,w,L,G,j,Y,x,U,q,k,V,h,B,H,T);return K._formatName=D,K._description=m,K._sourceTypeMask=S,K._attributeTypeName=d,K}constructor(e,t,r,i,o,s,u,c,l,d,p,f,h,m,y,v,g,O,E,b,T,S,C,N,_,R,P,I,A,D,M){this._id=void 0,this._logicalName=void 0,this._type=a.AttributeType.Boolean,this._sourceType=0,this._entityLogicalName=void 0,this._displayName=void 0,this._formatName="",this._attributeTypeName="",this._description="",this._columnNumber=0,this._sourceTypeMask=0,this._isSecured=!1,this._isValidForCreate=!1,this._isValidForRead=!1,this._isValidForUpdate=!1,this._requiredLevel=0,this._maxLength=0,this._minValue=0,this._maxValue=0,this._precision=0,this._precisionSource=0,this._format=void 0,this._behavior=0,this._defaultFormValue=0,this._defaultValue=!1,this._isBaseCurrency=!1,this._optionSet=void 0,this._targets=void 0,this._attributeOf=void 0,this._hasChanged=!1,this._isSortableEnabled=!1,this._imeMode=0,this._inheritsFrom=void 0,this._isLocalizable=!1,this._isCustomAttribute=!1,Object(n.throwOnNullOrUndefinedArgument)(e,"logicalName"),Object(n.throwOnNullOrUndefinedArgument)(t,"id"),Object(n.throwOnNullOrUndefinedArgument)(i,"type"),Object(n.throwOnNullOrUndefinedArgument)(d,"requiredLevel"),Object(n.throwOnNullOrUndefinedArgument)(s,"isSecured"),Object(n.throwOnNullOrUndefinedArgument)(u,"isValidForCreate"),Object(n.throwOnNullOrUndefinedArgument)(c,"isValidForRead"),Object(n.throwOnNullOrUndefinedArgument)(l,"isValidForUpdate"),this._logicalName=e,this._id=t,this._entityLogicalName=r,this._type=i,this._sourceType=I||0,this._displayName=o,this._isSecured=s,this._isValidForCreate=u,this._isValidForRead=c,this._isValidForUpdate=l,this._requiredLevel=d,this._maxLength=p,this._minValue=f,this._maxValue=h,this._precision=m,this._precisionSource=y,this._format=v,this._behavior=g,this._defaultFormValue=O,this._defaultValue=E,this._optionSet=b,this._targets=S,this._isBaseCurrency=T,this._attributeOf=C,this._hasChanged=N,this._isSortableEnabled=R||!1,this._imeMode=_||0,this._inheritsFrom=P||"",this._isLocalizable=A||!1,this._isCustomAttribute=D||!1,this._columnNumber=M||0}get_id(){return this._id}get_logicalName(){return this._logicalName}get_entityLogicalName(){return this._entityLogicalName}get_type(){return this._type}get_sourceType(){return this._sourceType}get_displayName(){return this._displayName}get_isValidForCreate(){return this._isValidForCreate}get_isSecured(){return this._isSecured}get_isValidForUpdate(){return this._isValidForUpdate}get_isValidForRead(){return this._isValidForRead}get_requiredLevel(){return this._requiredLevel}get_maxLength(){return this._maxLength}get_minValue(){return this._minValue}get_maxValue(){return this._maxValue}get_precision(){return this._precision}get_precisionSource(){return this._precisionSource}get_format(){return this._format}get_formatName(){return this._formatName}get_behavior(){return this._behavior}get_isBaseCurrency(){return this._isBaseCurrency}get_defaultFormValue(){return this._defaultFormValue}get_defaultValue(){return this._defaultValue}get_optionSet(){return this._optionSet}get_targets(){return this._targets}get_attributeOf(){return this._attributeOf}get_hasChanged(){return this._hasChanged}get_isSortableEnabled(){return this._isSortableEnabled}get_imeMode(){return this._imeMode}get_inheritsFrom(){return this._inheritsFrom}get_isLocalizable(){return this._isLocalizable}get_isCustomAttribute(){return this._isCustomAttribute}get_columnNumber(){return this._columnNumber}getObjectData(){return{[c.logicalNamePath]:this._logicalName,id:this._id.getObjectData(),[c.entityLogicalNamePath]:this._entityLogicalName,[c.entityAttributeLogicalNamesPath]:this._entityLogicalName+n.COMPOSITE_INDEX_DELIMITER+this._logicalName,type:Object(s.toNumberAttributeType)(this._type),sourcetype:this._sourceType,displayname:this._displayName,issecured:this._isSecured,issortableenabled:this._isSortableEnabled,isvalidforcreate:this._isValidForCreate,isvalidforupdate:this._isValidForUpdate,isvalidforread:this._isValidForRead,requiredlevel:this._requiredLevel,maxlength:this._maxLength,minvalue:this._minValue,maxvalue:this._maxValue,precision:this._precision,precisionsource:this._precisionSource,defaultformvalue:this._defaultFormValue,defaultvalue:this._defaultValue,format:this._format,behavior:this._behavior,isbasecurrency:this._isBaseCurrency,attributeof:this._attributeOf,haschanged:this._hasChanged,imemode:this._imeMode,inheritsfrom:this._inheritsFrom,islocalizable:this._isLocalizable,formatName:this._formatName,description:this._description,columnNumber:this._columnNumber,sourceTypeMask:this._sourceTypeMask,attributeTypeName:this._attributeTypeName,IsCustomAttribute:this._isCustomAttribute,optionset:Object(n.isNullOrUndefined)(this._optionSet)?void 0:this._optionSet.getObjectData(),targets:Object(n.isNullOrUndefined)(this._targets)?void 0:this._targets}}getODataObject(){return{LogicalName:this._logicalName,MetadataId:this._id.toString(),EntityLogicalName:this._entityLogicalName,EntityAttributeLogicalNames:this._entityLogicalName+n.COMPOSITE_INDEX_DELIMITER+this._logicalName,AttributeType:Object(s.toNumberAttributeType)(this._type),AttributeTypeName:c.addValueWrapper(("double"===this._attributeTypeName?"Float":this._attributeTypeName)+"Type"),Description:i.EntityMetadata.convertToLabel(this._description),ColumnNumber:this._columnNumber,FormatName:c.addValueWrapper(this._formatName),SourceTypeMask:this._sourceTypeMask,OptionSet:!Object(n.isNullOrUndefined)(this._optionSet)&&this._optionSet.getODataObject(),SourceType:this._sourceType,DisplayName:i.EntityMetadata.convertToLabel(this._displayName),IsSecured:this._isSecured,IsSortableEnabled:c.addValueWrapper(this._isSortableEnabled),IsValidForCreate:this._isValidForCreate,IsValidForUpdate:this._isValidForUpdate,IsValidForRead:this._isValidForRead,RequiredLevel:c.addValueWrapper(this._requiredLevel),MaxLength:this._maxLength,MinValue:this._minValue,MaxValue:this._maxValue,Precision:this._precision,PrecisionSource:this._precisionSource,DefaultFormValue:this._defaultFormValue,DefaultValue:this._defaultValue,Format:!Object(n.isNullOrUndefined)(this._format)&&parseInt(this._format,10),DateTimeBehavior:c.addValueWrapper(Object(n.behaviorToCrmSoap)(this._behavior)),IsBaseCurrency:this._isBaseCurrency,AttributeOf:this._attributeOf,HasChanged:this._hasChanged,ImeMode:this._imeMode,InheritsFrom:this._inheritsFrom,IsLocalizable:this._isLocalizable,IsCustomAttribute:this._isCustomAttribute,Targets:!Object(n.isNullOrUndefined)(this._targets)&&this._targets}}}c.entityLogicalNamePath="entitylogicalname",c.logicalNamePath="logicalname",c.entityAttributeLogicalNamesPath="entitylogicalname_logicalname"},9065:function(e,t,r){"use strict";r.r(t),r.d(t,"EntityMetadata",(function(){return o}));var n=r(9050),a=r(9049),i=r(9066);class o{static extractKey(e){return a.LegacyGuid.createFromObjectData(e[o._idPath]).toString()}static createFromObjectData(e){Object(n.isNullOrUndefinedOrEmptyString)(e.MetadataId)||(e=o.createFromOData(e).getObjectData());var t=a.LegacyGuid.createFromObjectData(e[o._idPath]),r=e[o.logicalNamePath],s=e.displayname,u=e.entitysetname,c=e.objecttypecode,l=e.primaryidattribute,d=e.primarynameattribute,p=e.primaryimageattribute,f=e.isreadonlyformobileclient,h=e.isvisibleinmobileclient,m=e.isofflineinmobileclient,y=e.isoptimisticconcurrencyenabled,v=e.haschanged,g=e.isactivity,O=e.ischildentity,E=e.parententitylogicalname,b=e.parententityreferencingattribute,T=e.isvalidforadvancedfind,S=e.ismailmergeenabled,C=e.isconnectionsenabled,N=e.iscustomizable,_=e.isactivityparty,R=e.isimportable,P=e.isenabledforcharts,I=e.iscustomentity,A=e.isstatemodelaware,D=e.enforcestatetransitions,M=e.iscollaboration,F=e.activitytypemask,w=e.ownershiptype,L=e.hassecuredattributes,j=e.hasstatecode,x=e.isbusinessprocessenabled,U=e.isdocumentmanagementenabled,k=e.isonenoteintegrationenabled,q=e.ismsteamsintegrationenabled,V=e.hasactivities,B=e.entitycolor,H=e.isinteractioncentricenabled,G=e.isQuickCreateEnabled,Q=e.entityClientSetting,z=e.isKnowledgeManagementEnabled,X=e.IsDocumentRecommendationsEnabled,W=e.isIntersect,Y=e.hasnotes,K=e.usesBusinessDataLabelTable,J=e.iconVectorName,Z=e.isbpfentity,$=Object(n.isNullOrUndefinedOrEmptyString)(e.dataProviderId)?a.LegacyGuid.get_empty():a.LegacyGuid.tryCreate(e.dataProviderId),ee=e.primaryKeyName,te=e.autoRouteToOwnerQueue,re=e.canTriggerWorkflow,ne=e.displayCollectionName,ae=e.description,ie=e.oneToManyRelationships,oe=e.manyToOneRelationships,se=e.manyToManyRelationships,ue=-1,ce=-1;e.VersionNumber&&(ue=e.VersionNumber),e.OverallVersionNumber&&(ce=e.OverallVersionNumber);var le=e.AttributeNames,de=e.privileges.map(e=>i.SecurityPrivilegeMetadata.createFromObjectData(e)),pe=new o(t,r,s,u,c,l,d,p,de,f,h,m,y,v,g,O,E,b,T,S,C,N,_,R,P,I,A,D,M,F,w,L,j,x,U,k,q,V,B,H,G,Q,z,X,W,Y,K,J,Z,ue,ce,le);return pe._primaryKeyName=ee,pe._autoRouteToOwnerQueue=te,pe._canTriggerWorkflow=re,pe._displayCollectionName=ne,pe._description=ae,pe._dataProviderId=$,pe._oneToManyRelationships=ie,pe._manyToManyRelationships=se,pe._manyToOneRelationships=oe,pe}static getLabelString(e){return Object(n.isNullOrUndefined)(e.UserLocalizedLabel)?"":e.UserLocalizedLabel.Label}static convertToLabel(e){var t={UserLocalizedLabel:{}};return t.UserLocalizedLabel.Label=e,t}static createFromOData(e){var t=a.LegacyGuid.tryCreate(e.MetadataId),r=e.LogicalName,s=o.getLabelString(e.DisplayName),u=e.EntitySetName,c=e.ObjectTypeCode,l=e.PrimaryIdAttribute,d=e.IconVectorName,p=e.PrimaryKeyName,f=e.AutoRouteToOwnerQueue,h=e.CanTriggerWorkflow,m=e.PrimaryNameAttribute,y=e.PrimaryImageAttribute,v=e.IsReadOnlyInMobileClient,g=e.IsVisibleInMobileClient,O=e.IsOfflineInMobileClient,E=e.IsOptimisticConcurrencyEnabled,b=e.HasChanged,T=e.IsActivity,S=e.IsChildEntity,C=e.ParentEntityLogicalName,N=e.ParentEntityReferencingAttribute,_=e.IsValidForAdvancedFind,R=e.IsMailMergeEnabled,P=e.IsConnectionsEnabled,I=e.IsCustomizable,A=e.IsActivityParty,D=e.IsImportable,M=e.IsEnabledForCharts,F=e.IsCustomEntity,w=e.IsStateModelAware,L=e.EnforceStateTransitions,j=e.IsValidForQueue,x=e.ActivityTypeMask,U=e.OwnershipType,k=e.IsBusinessProcessEnabled,q=e.IsDocumentManagementEnabled,V=e.IsOneNoteIntegrationEnabled,B=e.IsMSTeamsIntegrationEnabled,H=e.EntityColor,G=e.IsInteractionCentricEnabled,Q=e.IsQuickCreateEnabled,z=e.entityClientSetting,X=e.IsKnowledgeManagementEnabled,W=e.IsDocumentManagementEnabled,Y=e.IsBPFEntity,K=e.OneToManyRelationships,J=e.ManyToOneRelationships,Z=e.ManyToManyRelationships,$=o.getLabelString(e.DisplayCollectionName),ee=o.getLabelString(e.Description),te=Object(n.isNullOrUndefinedOrEmptyString)(e.DataProviderId)?a.LegacyGuid.get_empty():a.LegacyGuid.tryCreate(e.DataProviderId),re=-1,ne=-1;e.VersionNumber&&(re=e.VersionNumber),e.OverallVersionNumber&&(ne=e.OverallVersionNumber);for(var ae=!1,ie=e.AttributeNames,oe=0;oe<ie.length;oe++)if("statecode"===ie[oe]){ae=!0;break}var se=e.IsIntersect,ue=e.Privileges.map(e=>i.SecurityPrivilegeMetadata.createFromOData(e)),ce=new o(t,r,s,u,c,l,m,y,ue,v,g,O,E,b,T,S,C,N,_,R,P,I,A,D,M,F,w,L,j,x,U,!1,ae,k,q,V,B,!1,H,G,Q,z,X,W,se,!1,!1,d,Y,re,ne,ie);return ce._primaryKeyName=p,ce._autoRouteToOwnerQueue=f,ce._canTriggerWorkflow=h,ce._displayCollectionName=$,ce._description=ee,ce._dataProviderId=te,ce._oneToManyRelationships=K,ce._manyToOneRelationships=J,ce._manyToManyRelationships=Z,ce}constructor(e,t,r,i,o,s,u,c,l,d,p,f,h,m,y,v,g,O,E,b,T,S,C,N,_,R,P,I,A,D,M,F,w,L,j,x,U,k,q,V,B,H,G,Q,z,X,W,Y,K,J,Z,$){for(var ee of(this._id=void 0,this._logicalName=void 0,this._objectTypeCode=0,this._primaryIdAttribute=void 0,this._primaryNameAttribute=void 0,this._primaryImageAttribute=void 0,this._privilegesByType=void 0,this._hasChanged=!1,this._isActivity=!1,this._isReadOnlyForMobileClient=!1,this._isVisibleInMobileClient=!1,this._isOfflineInMobileClient=!1,this._isOptimisticConcurrencyEnabled=!1,this._isChildEntity=!1,this._parentEntityLogicalName=void 0,this._parentEntityReferencingAttribute=void 0,this._displayName=void 0,this._primaryKeyName="",this._autoRouteToOwnerQueue=!1,this._canTriggerWorkflow=!1,this._displayCollectionName="",this._description="",this._entitySetName=void 0,this._isValidForAdvancedFind=!1,this._isMailMergeEnabled=!1,this._isConnectionsEnabled=!1,this._isCustomizable=!1,this._isActivityParty=!1,this._isImportable=!1,this._isEnabledForCharts=!1,this._isCustomEntity=!1,this._isStateModelAware=!1,this._enforceStateTransitions=!1,this._activityTypeMask=0,this._ownershipType=0,this._isCollaboration=!1,this._hasSecuredAttributes=!1,this._hasStateCode=!1,this._isBusinessProcessEnabled=!1,this._isDocumentManagementEnabled=!1,this._isOneNoteIntegrationEnabled=!1,this._isMSTeamsIntegrationEnabled=!1,this._isIntersect=!1,this._hasActivities=!1,this._entityColor=void 0,this._isInteractionCentricEnabled=!1,this._isQuickCreateEnabled=!1,this._entityClientSetting={AllowMainFormDialogForCreate:!1,AllowMainFormDialogForEdit:!1},this._isKnowledgeManagementEnabled=!1,this._isDocumentRecommendationsEnabled=!1,this._hasNotes=!1,this._usesBusinessDataLabelTable=!1,this._isBPFEntity=!1,this._oneToManyRelationships=[],this._manyToOneRelationships=[],this._manyToManyRelationships=[],this._iconVectorName=void 0,this._dataProviderId=a.LegacyGuid.get_empty(),this._versionNumber=0,this._overallVersionNumber=0,this._attributeNames=void 0,Object(n.throwOnNullOrUndefinedArgument)(e,"id"),Object(n.throwOnNullOrUndefinedArgument)(t,"logicalName"),this._id=e,this._logicalName=t,this._displayName=r,this._entitySetName=i,this._objectTypeCode=o,this._primaryIdAttribute=s,this._primaryNameAttribute=u,this._primaryImageAttribute=c,this._isReadOnlyForMobileClient=d,this._isVisibleInMobileClient=p,this._isOfflineInMobileClient=f,this._isOptimisticConcurrencyEnabled=h,this._hasChanged=m,this._isActivity=y,this._isChildEntity=v,this._parentEntityLogicalName=g,this._parentEntityReferencingAttribute=O,this._isValidForAdvancedFind=E,this._isMailMergeEnabled=b,this._isConnectionsEnabled=T,this._isCustomizable=S,this._isActivityParty=C,this._isImportable=N,this._isEnabledForCharts=_,this._isCustomEntity=R,this._isStateModelAware=P,this._enforceStateTransitions=I,this._isCollaboration=A,this._activityTypeMask=D,this._ownershipType=M,this._hasSecuredAttributes=F,this._hasStateCode=w,this._isBusinessProcessEnabled=L,this._isDocumentManagementEnabled=j,this._isOneNoteIntegrationEnabled=x,this._isMSTeamsIntegrationEnabled=U,this._hasActivities=k,this._entityColor=q,this._isInteractionCentricEnabled=V,this._isQuickCreateEnabled=B,this._entityClientSetting=H,this._isKnowledgeManagementEnabled=G,this._isDocumentRecommendationsEnabled=Q,this._isIntersect=z,this._hasNotes=X,this._usesBusinessDataLabelTable=W,this._iconVectorName=Y,this._isBPFEntity=K,this._versionNumber=J,this._overallVersionNumber=Z,this._attributeNames=$,this._privilegesByType={},l))this._privilegesByType[ee.get_privilegeTypeKey()]=ee}get_attributeNames(){return this._attributeNames}get_id(){return this._id}get_logicalName(){return this._logicalName}get_displayName(){return this._displayName}set_entitySetName(e){return this._entitySetName=e,e}get_objectTypeCode(){return this._objectTypeCode}get_primaryIdAttribute(){return this._primaryIdAttribute}get_primaryNameAttribute(){return this._primaryNameAttribute}get_isOptimisticConcurrencyEnabled(){return this._isOptimisticConcurrencyEnabled}get_isActivity(){switch(this._logicalName){case"phonecall":case"email":case"task":case"appointment":case"activitypointer":return!0;default:return this._isActivity}}get_isChildEntity(){return this._isChildEntity}get_parentEntityLogicalName(){return this._parentEntityLogicalName}get_parentEntityReferencingAttribute(){return this._parentEntityReferencingAttribute}get_isCustomEntity(){return this._isCustomEntity}get_activityTypeMask(){return this._activityTypeMask}get_ownershipType(){return this._ownershipType}get_hasSecuredAttributes(){return this._hasSecuredAttributes}get_hasStateCode(){return this._hasStateCode}get_isBusinessProcessEnabled(){return this._isBusinessProcessEnabled}get_isIntersect(){return this._isIntersect}get_usesBusinessDataLabelTable(){return this._usesBusinessDataLabelTable}get_isBPFEntity(){return this._isBPFEntity}getEntityCanBeUsedInBusinessProcess(){return this._isBusinessProcessEnabled||this._isBPFEntity}getODataObject(){var e={},t=this._id.toString();for(var r in e.Id=t,e.MetadataId=t,e.LogicalName=this._logicalName,e.DisplayName=o.convertToLabel(this._displayName),e.EntitySetName=this._entitySetName,e.ObjectTypeCode=this._objectTypeCode,e.PrimaryKeyName=this._primaryKeyName,e.AutoRouteToOwnerQueue=this._autoRouteToOwnerQueue,e.CanTriggerWorkflow=this._canTriggerWorkflow,e.Description=o.convertToLabel(this._description),e.DisplayCollectionName=o.convertToLabel(this._displayCollectionName),e.PrimaryIdAttribute=this._primaryIdAttribute,e.PrimaryNameAttribute=this._primaryNameAttribute,e.PrimaryImageAttribute=this._primaryImageAttribute,e.IsReadOnlyInMobileClient=this._isReadOnlyForMobileClient,e.IsVisibleInMobileClient=this._isVisibleInMobileClient,e.IsOfflineInMobileClient=this._isOfflineInMobileClient,e.IsOptimisticConcurrencyEnabled=this._isOptimisticConcurrencyEnabled,e.HasChanged=this._hasChanged,e.IsActivity=this._isActivity,e.IsChildEntity=this._isChildEntity,e.ParentEntityLogicalName=this._parentEntityLogicalName,e.ParentEntityReferencingAttribute=this._parentEntityReferencingAttribute,e.IsValidForAdvancedFind=this._isValidForAdvancedFind,e.IsMailMergeEnabled=this._isMailMergeEnabled,e.IsConnectionsEnabled=this._isConnectionsEnabled,e.IsCustomizable=this._isCustomizable,e.IsActivityParty=this._isActivityParty,e.IsImportable=this._isImportable,e.IsEnabledForCharts=this._isEnabledForCharts,e.IsCustomEntity=this._isCustomEntity,e.IsStateModelAware=this._isStateModelAware,e.EnforceStateTransitions=this._enforceStateTransitions,e.IsValidForQueue=this._isCollaboration,e.ActivityTypeMask=this._activityTypeMask,e.OwnershipType=this._ownershipType,e.HasStateCode=this._hasStateCode,e.IsBusinessProcessEnabled=this._isBusinessProcessEnabled,e.IsDocumentManagementEnabled=this._isDocumentManagementEnabled,e.EntityColor=this._entityColor,e.IsInteractionCentricEnabled=this._isInteractionCentricEnabled,e.isQuickCreateEnabled=this._isQuickCreateEnabled,e.entityClientSetting=this._entityClientSetting,e.IsKnowledgeManagementEnabled=this._isKnowledgeManagementEnabled,e.OneToManyRelationships=this._oneToManyRelationships,e.ManyToOneRelationships=this._manyToOneRelationships,e.ManyToManyRelationships=this._manyToManyRelationships,e.IconVectorName=this._iconVectorName,e.IsBPFEntity=this._isBPFEntity,e.DataProviderId=this._dataProviderId?this._dataProviderId.toString():"",e.IsDocumentRecommendationsEnabled=this._isDocumentRecommendationsEnabled,e.IsIntersect=this._isIntersect,e.IsMSTeamsIntegrationEnabled=this._isMSTeamsIntegrationEnabled,e.VersionNumber=this._versionNumber,e.OverallVersionNumber=this._overallVersionNumber,e.AttributeNames=this._attributeNames,e.Privileges=[],this._privilegesByType)this._privilegesByType.hasOwnProperty(r)&&e.Privileges.push(this._privilegesByType[r].getODataObject());return e}getObjectData(){var e={};e[o._idPath]=this._id.getObjectData(),e[o.logicalNamePath]=this._logicalName,e.displayname=this._displayName,e.entitysetname=this._entitySetName,e.objecttypecode=this._objectTypeCode,e.primaryidattribute=this._primaryIdAttribute,e.primarykeyname=this._primaryKeyName,e.displayCollectionName=this._displayCollectionName,e.autoRouteToOwnerQueue=this._autoRouteToOwnerQueue,e.canTriggerWorkflow=this._canTriggerWorkflow,e.primarynameattribute=this._primaryNameAttribute,e.primaryimageattribute=this._primaryImageAttribute,e.description=this._description,e.oneToManyRelationships=this._oneToManyRelationships,e.manyToOneRelationships=this._manyToOneRelationships,e.manyToManyRelationships=this._manyToManyRelationships,e.isreadonlyformobileclient=this._isReadOnlyForMobileClient,e.isvisibleinmobileclient=this._isVisibleInMobileClient,e.isofflineinmobileclient=this._isOfflineInMobileClient,e.isoptimisticconcurrencyenabled=this._isOptimisticConcurrencyEnabled,e.haschanged=this._hasChanged,e.isactivity=this._isActivity,e.ischildentity=this._isChildEntity,e.parententitylogicalname=this._parentEntityLogicalName,e.parententityreferencingattribute=this._parentEntityReferencingAttribute,e.isvalidforadvancedfind=this._isValidForAdvancedFind,e.ismailmergeenabled=this._isMailMergeEnabled,e.isconnectionsenabled=this._isConnectionsEnabled,e.iscustomizable=this._isCustomizable,e.isactivityparty=this._isActivityParty,e.isimportable=this._isImportable,e.isenabledforcharts=this._isEnabledForCharts,e.iscustomentity=this._isCustomEntity,e.isstatemodelaware=this._isStateModelAware,e.enforcestatetransitions=this._enforceStateTransitions,e.iscollaboration=this._isCollaboration,e.activitytypemask=this._activityTypeMask,e.ownershiptype=this._ownershipType,e.hassecuredattributes=this._hasSecuredAttributes,e.hasstatecode=this._hasStateCode,e.isbusinessprocessenabled=this._isBusinessProcessEnabled,e.isdocumentmanagementenabled=this._isDocumentManagementEnabled,e.isonenoteintegrationenabled=this._isOneNoteIntegrationEnabled,e.ismsteamsintegrationenabled=this._isMSTeamsIntegrationEnabled,e.hasactivities=this._hasActivities,e.entitycolor=this._entityColor,e.isinteractioncentricenabled=this._isInteractionCentricEnabled,e.isQuickCreateEnabled=this._isQuickCreateEnabled,e.entityClientSetting=this._entityClientSetting,e.isKnowledgeManagementEnabled=this._isKnowledgeManagementEnabled,e.isDocumentRecommendationsEnabled=this._isDocumentRecommendationsEnabled,e.isIntersect=this._isIntersect,e.hasnotes=this._hasNotes,e.iconVectorName=this._iconVectorName,e.usesBusinessDataLabelTable=this._usesBusinessDataLabelTable,e.isbpfentity=this._isBPFEntity,e.dataProviderId=this._dataProviderId?this._dataProviderId.toString():"",e.VersionNumber=this._versionNumber,e.OverallVersionNumber=this._overallVersionNumber,e.AttributeNames=this._attributeNames;var t=[],r=this._privilegesByType;for(var n in r)if(r.hasOwnProperty(n)){var a={key:n,value:r[n]};t.push(a.value.getObjectData())}return e.privileges=t,e}}o.logicalNamePath="logicalname",o._idPath="id"},9066:function(e,t,r){"use strict";r.r(t),r.d(t,"SecurityPrivilegeMetadata",(function(){return i}));var n=r(9050),a=r(9049);class i{static getPrivilegeTypeKey(e){return e.toString()}static createFromObjectData(e){var t=e.name,r=a.LegacyGuid.createFromObjectData(e.privilegeid),n=e.privilegetype,o=e.canbebasic,s=e.canbelocal,u=e.canbedeep,c=e.canbeglobal;return new i(t,r,n,o,s,u,c)}static createFromOData(e){var t=e.Name,r=a.LegacyGuid.tryCreate(e.PrivilegeId),n=e.PrivilegeType,o=e.CanBeBasic,s=e.CanBeLocal,u=e.CanBeDeep,c=e.CanBeGlobal;return new i(t,r,n,o,s,u,c)}constructor(e,t,r,a,i,o,s){this._name=void 0,this._privilegeId=void 0,this._privilegeType=0,this._canBeBasic=!1,this._canBeLocal=!1,this._canBeDeep=!1,this._canBeGlobal=!1,Object(n.throwOnNullOrUndefinedArgument)(e,"name"),Object(n.throwOnNullOrUndefinedArgument)(t,"privilegeId"),this._name=e,this._privilegeId=t,this._privilegeType=r,this._canBeBasic=a,this._canBeLocal=i,this._canBeDeep=o,this._canBeGlobal=s}get_privilegeId(){return this._privilegeId}get_privilegeType(){return this._privilegeType}get_privilegeTypeKey(){return i.getPrivilegeTypeKey(this.get_privilegeType())}get_canBeGlobal(){return this._canBeGlobal}getObjectData(){var e={};return e.name=this._name,e.privilegeid=this._privilegeId.getObjectData(),e.privilegetype=this._privilegeType,e.canbebasic=this._canBeBasic,e.canbelocal=this._canBeLocal,e.canbedeep=this._canBeDeep,e.canbeglobal=this.get_canBeGlobal(),e}getODataObject(){var e={};return e.Name=this._name,e.PrivilegeId=this._privilegeId.toString(),e.PrivilegeType=this._privilegeType,e.CanBeBasic=this._canBeBasic,e.CanBeLocal=this._canBeLocal,e.CanBeDeep=this._canBeDeep,e.CanBeGlobal=this.get_canBeGlobal(),e}}},9067:function(e,t,r){"use strict";r.r(t),r.d(t,"NumberAttributeType",(function(){return n})),r.d(t,"toDbAttributeTypes",(function(){return o})),r.d(t,"fromDbAttributeTypes",(function(){return s})),r.d(t,"fromNumberAttributeType",(function(){return u})),r.d(t,"toNumberAttributeType",(function(){return c}));var n,a=r(9050),i=r(9048);function o(e){return Object(a.mapToValues)(e,e=>c(e))}function s(e){return Object(a.mapToValues)(e,e=>u(e))}function u(e){switch(e){case n.Boolean:return i.AttributeType.Boolean;case n.Customer:return i.AttributeType.Customer;case n.DateTime:return i.AttributeType.DateTime;case n.Decimal:return i.AttributeType.Decimal;case n.Double:return i.AttributeType.Double;case n.Integer:return i.AttributeType.Integer;case n.Lookup:return i.AttributeType.Lookup;case n.Memo:return i.AttributeType.Memo;case n.Money:return i.AttributeType.Money;case n.Owner:return i.AttributeType.Owner;case n.PartyList:return i.AttributeType.PartyList;case n.Picklist:return i.AttributeType.PickList;case n.State:return i.AttributeType.State;case n.Status:return i.AttributeType.Status;case n.String:return i.AttributeType.String;case n.UniqueIdentifier:return i.AttributeType.UniqueIdentifier;case n.CalendarRules:return i.AttributeType.CalendarRules;case n.Virtual:return i.AttributeType.Virtual;case n.BigInt:return i.AttributeType.BigInt;case n.ManagedProperty:return i.AttributeType.ManagedProperty;case n.EntityName:return i.AttributeType.EntityName;case n.AliasedValue:return i.AttributeType.AliasedValue;case n.EntityImage:return i.AttributeType.EntityImage;case n.MultiSelectPicklist:return i.AttributeType.MultiSelectPickList;case n.File:return i.AttributeType.File;case n.NavigationProperty:return i.AttributeType.NavigationProperty;default:return i.AttributeType.Unknown}}function c(e){switch(e){case i.AttributeType.Boolean:return n.Boolean;case i.AttributeType.Customer:return n.Customer;case i.AttributeType.DateTime:return n.DateTime;case i.AttributeType.Decimal:return n.Decimal;case i.AttributeType.Double:return n.Double;case i.AttributeType.Integer:return n.Integer;case i.AttributeType.Lookup:return n.Lookup;case i.AttributeType.Memo:return n.Memo;case i.AttributeType.Money:return n.Money;case i.AttributeType.Owner:return n.Owner;case i.AttributeType.PartyList:return n.PartyList;case i.AttributeType.PickList:return n.Picklist;case i.AttributeType.State:return n.State;case i.AttributeType.Status:return n.Status;case i.AttributeType.String:return n.String;case i.AttributeType.UniqueIdentifier:return n.UniqueIdentifier;case i.AttributeType.CalendarRules:return n.CalendarRules;case i.AttributeType.Virtual:return n.Virtual;case i.AttributeType.BigInt:return n.BigInt;case i.AttributeType.ManagedProperty:return n.ManagedProperty;case i.AttributeType.EntityName:return n.EntityName;case i.AttributeType.AliasedValue:return n.AliasedValue;case i.AttributeType.EntityImage:return n.EntityImage;case i.AttributeType.MultiSelectPickList:return n.MultiSelectPicklist;case i.AttributeType.File:return n.File;case i.AttributeType.NavigationProperty:return n.NavigationProperty;default:return n.Unknown}}!function(e){e[e.Unknown=-1]="Unknown",e[e.Boolean=0]="Boolean",e[e.Customer=1]="Customer",e[e.DateTime=2]="DateTime",e[e.Decimal=3]="Decimal",e[e.Double=4]="Double",e[e.Integer=5]="Integer",e[e.Lookup=6]="Lookup",e[e.Memo=7]="Memo",e[e.Money=8]="Money",e[e.Owner=9]="Owner",e[e.PartyList=10]="PartyList",e[e.Picklist=11]="Picklist",e[e.State=12]="State",e[e.Status=13]="Status",e[e.String=14]="String",e[e.UniqueIdentifier=15]="UniqueIdentifier",e[e.CalendarRules=16]="CalendarRules",e[e.Virtual=17]="Virtual",e[e.BigInt=18]="BigInt",e[e.ManagedProperty=19]="ManagedProperty",e[e.EntityName=20]="EntityName",e[e.AliasedValue=21]="AliasedValue",e[e.EntityImage=23]="EntityImage",e[e.MultiSelectPicklist=24]="MultiSelectPicklist",e[e.File=25]="File",e[e.NavigationProperty=26]="NavigationProperty"}(n||(n={}))},9068:function(e,t,r){"use strict";r.r(t),r.d(t,"OptionSetMetadata",(function(){return i}));var n=r(9050),a=r(9069);class i{static createFromObjectData(e){var t=e&&e.optionsindisplayorder?e.optionsindisplayorder:{};return new i(Object(n.mapToValues)(t,e=>a.OptionMetadata.createFromObjectData(e)))}static createFromOData(e){for(var t={},r=0;r<e.length;++r){var n=a.OptionMetadata.createFromOData(e[r]);t[r.toString()]=n}return new i(t)}static _CreateDictionaryFromOptionsInDisplayOrder(e){var t={};for(var r in e)if(e.hasOwnProperty(r)){var n={key:r,value:e[r]}.value;t[n.get_ValueString()]=n}return t}constructor(e){this._options=void 0,this._optionsInDisplayOrder=void 0,this._optionsInDisplayOrder=e,this._options=i._CreateDictionaryFromOptionsInDisplayOrder(e)}get_options(){return this._options}get_optionsInDisplayOrder(){return this._optionsInDisplayOrder}getObjectData(){return Object(n.isNullOrUndefined)(this._optionsInDisplayOrder)?{}:{optionsindisplayorder:Object(n.mapToValues)(this._optionsInDisplayOrder,e=>e.getObjectData())}}getODataObject(){if(Object(n.isNullOrUndefined)(this.get_optionsInDisplayOrder()))return{};var e={},t=[],r=this.get_optionsInDisplayOrder();for(var a in r)if(r.hasOwnProperty(a)){var i={key:a,value:r[a]};t.push(i.value.getODataObject())}return e.Options=t,e}}},9069:function(e,t,r){"use strict";r.r(t),r.d(t,"OptionMetadata",(function(){return a}));var n=r(9070);class a{static createFromPicklistItem(e){if(e instanceof a)return e;var t=e.get_Label(),r=Number(e.get_ValueString());return new a(t,r,-1,-1,[],"","")}static createFromObjectData(e){var t=e.label,r=e.value,n="state"in e?e.state:-1,i="defaultstatus"in e?e.defaultstatus:-1,o="allowedstatustransitions"in e?e.allowedstatustransitions:[],s="color"in e?e.color:"",u=e.invariantname;return new a(t,r,n,i,o,s,u)}static createFromOData(e){var t=e.Label,r=e.Value,n="State"in e?e.State:-1,i="DefaultStatus"in e?e.DefaultStatus:-1,o="TransitionData"in e?e.TransitionData:[],s="Color"in e?e.Color:"",u=e.Description;return new a(t,r,n,i,o,s,u)}constructor(e,t,r,n,a,i,o){this._label=void 0,this._val=0,this._state=0,this._defaultStatus=0,this._allowedStatusTransitions=void 0,this._color=void 0,this._invariantName=void 0,this._label=e,this._val=t,this._state=r,this._defaultStatus=n,this._allowedStatusTransitions=a,this._color=i,this._invariantName=o}get_Label(){return this._label}set_Label(e){return this._label=e,e}get_ValueString(){return this._val.toString()}get_allowedStatusTransitions(){return this._allowedStatusTransitions}get_color(){return this._color}get_value(){return this._val}get_state(){return this._state}get_defaultStatus(){return this._defaultStatus}get_invariantName(){return this._invariantName}getObjectData(){return{label:this._label,value:this._val,state:this._state,defaultstatus:this._defaultStatus,allowedstatustransitions:this._allowedStatusTransitions,color:this._color,invariantname:this._invariantName}}getODataObject(){return{Value:this._val,Color:this._color,Label:this._label,DefaultStatus:this._defaultStatus,State:this._state,TransitionData:this._allowedStatusTransitions,InvariantName:this._invariantName}}getValue(e){if(e===n.label||"label"===e)return this.get_Label();if(e===n.value||"value"===e)return this.get_value();if(e===n.state||"state"===e)return this.get_state();if(e===n.defaultStatus||"defaultstatus"===e)return this._defaultStatus;if(e===n.allowedStatusTransitions||"allowedstatustransitions"===e)return this.get_allowedStatusTransitions();if(e===n.color||"color"===e)return this.get_color();throw new Error("fieldName = ${fieldName} is out of range")}}a.__typeName="Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.OptionMetadata"},9070:function(e,t,r){"use strict";r.r(t),r.d(t,"delimiter",(function(){return a})),r.d(t,"label",(function(){return i})),r.d(t,"value",(function(){return o})),r.d(t,"state",(function(){return s})),r.d(t,"defaultStatus",(function(){return u})),r.d(t,"allowedStatusTransitions",(function(){return c})),r.d(t,"color",(function(){return l}));var n=r(9071),a="!",i=d(n.FieldFormatValue.Label),o=d(n.FieldFormatValue.Value),s=d(n.FieldFormatValue.State),u=d(n.FieldFormatValue.DefaultStatus),c=d(n.FieldFormatValue.AllowedStatusTransitions),l=d(n.FieldFormatValue.Color);function d(e){return a+n.FieldFormatValue[e]}},9071:function(e,t,r){"use strict";var n;r.r(t),r.d(t,"FieldFormatValue",(function(){return n})),function(e){e[e.Raw=0]="Raw",e[e.Numeric=1]="Numeric",e[e.Label=2]="Label",e[e.Value=3]="Value",e[e.State=4]="State",e[e.Id=5]="Id",e[e.Name=6]="Name",e[e.LogicalName=7]="LogicalName",e[e.AllowedStatusTransitions=8]="AllowedStatusTransitions",e[e.DefaultStatus=9]="DefaultStatus",e[e.Color=10]="Color"}(n||(n={}))},9072:function(e,t,r){"use strict";r.r(t),r.d(t,"GetNullableBooleanValue",(function(){return i})),r.d(t,"getAssociatedMenuBehaviorValue",(function(){return o})),r.d(t,"getAssociatedMenuGroupValue",(function(){return s})),r.d(t,"getEntityColorValue",(function(){return u})),r.d(t,"getCascadeTypeValue",(function(){return c})),r.d(t,"getIsManagedValue",(function(){return l})),r.d(t,"getReferencedEntityValue",(function(){return d})),r.d(t,"getReferencingEntityValue",(function(){return p})),r.d(t,"getReferencingEntityNavigationPropertyNameValue",(function(){return f})),r.d(t,"getIsHierarchicalValue",(function(){return h})),r.d(t,"getLabelString",(function(){return m})),r.d(t,"getOptionSetTypeValue",(function(){return y})),r.d(t,"isEntityPayloadReductionRequested",(function(){return v})),r.d(t,"isSecondPhaseEntityPayloadReductionEnabled",(function(){return g}));var n=r(9055),a=r(9050);function i(e,t,r){return r}function o(e,t,r){return e&&t&&Object(a.isNullOrUndefined)(r)?n.AssociatedMenuBehavior.DoNotDisplay:r}function s(e,t,r){return e&&t&&Object(a.isNullOrUndefined)(r)?n.AssociatedMenuGroup.Details:r}function u(e,t,r){return e&&t&&Object(a.isNullOrUndefined)(r)?"":r}function c(e,t,r){return e&&t&&Object(a.isNullOrUndefined)(r)?n.CascadeType.NoCascade:r}function l(e,t,r){return!!(e&&t&&Object(a.isNullOrUndefined)(r.IsManaged))||r.IsManaged}function d(e,t,r,n){return e&&t&&Object(a.isNullOrUndefined)(r.ReferencedEntity)?n.LogicalName:r.ReferencedEntity}function p(e,t,r,n){return e&&t&&Object(a.isNullOrUndefined)(r.ReferencingEntity)?n.LogicalName:r.ReferencingEntity}function f(e,t,r){return e&&t&&Object(a.isNullOrUndefined)(r.ReferencingEntityNavigationPropertyName)?r.ReferencingAttribute:r.ReferencingEntityNavigationPropertyName}function h(e,t,r){return!(e&&t&&Object(a.isNullOrUndefined)(r))&&r}function m(e,t,r){var n;return r&&r.UserLocalizedLabel?e&&t&&Object(a.isNullOrUndefined)(r.UserLocalizedLabel.Label)?"":null!==(n=r.UserLocalizedLabel.Label)&&void 0!==n?n:null:null}function y(e,t,r){return e&&t&&Object(a.isNullOrUndefined)(r)?n.OptionSetType.Picklist:r}function v(e){return e&&e.AdditionalParameters&&e.AdditionalParameters.isEntityPayloadReductionRequested}function g(e){return e&&e.AdditionalParameters&&e.AdditionalParameters.isSecondPhasePayloadReductionEnabled}},9073:function(e,t,r){"use strict";r.r(t),r.d(t,"MDLUseStateOverMetadataCache",(function(){return n})),r.d(t,"RetryMdlCacheTimeout",(function(){return a})),r.d(t,"MDLUseStateOverMetadataCachePhase2",(function(){return i})),r.d(t,"CustomPageOffline",(function(){return o})),r.d(t,"MDLMetadataCachePerfSizeCapture",(function(){return s}));var n="MDLUseStateOverMetadataCache",a="RetryMdlCacheTimeout",i="MDLUseStateOverMetadataCachePhase2",o="CustomPageOffline",s="MDLMetadataCachePerfSizeCapture"},9074:function(e,t,r){"use strict";r.r(t),r.d(t,"getEntityLogicalName",(function(){return d})),r.d(t,"getAttributesPresentInState",(function(){return U})),r.d(t,"getAttributeTypes",(function(){return p})),r.d(t,"getEntityLogical",(function(){return w})),r.d(t,"getEntityLogicalNameFromOtc",(function(){return x})),r.d(t,"getEntityMetadata",(function(){return M})),r.d(t,"getFullNameConventionCode",(function(){return O})),r.d(t,"getLanguageCode",(function(){return b})),r.d(t,"getOfflineAvailableEntities",(function(){return L})),r.d(t,"getOrganizationSettings",(function(){return v})),r.d(t,"getUserId",(function(){return S})),r.d(t,"getUserName",(function(){return N})),r.d(t,"getUserSettings",(function(){return h})),r.d(t,"getViewMetadata",(function(){return A})),r.d(t,"isFeatureEnabled",(function(){return R}));var n=r(9075),a=r(9073),i=r(9050),o=r(9047),s=r(9046),u=r(9076);function c(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function l(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){c(i,n,a,o,s,"next",e)}function s(e){c(i,n,a,o,s,"throw",e)}o(void 0)}))}}function d(e,t){var r,n,i,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(!I(e.ApplicationState,a.MDLUseStateOverMetadataCache))return null;var c=null===(r=e.TraceManager)||void 0===r?void 0:r.getTracer(o.COMPONENT_NAMES.MetadataCache),l=null===(n=e.ApplicationState)||void 0===n||null===(i=n.metadata)||void 0===i?void 0:i.entities;if(l){var d=Object(u.searchEntityLogicalNameFromEntityMetadata)(l,t,c,s);if(d)return d}return c.info("".concat(Q()," entity metadata not found on state")),null}function p(e,t,r){return f.apply(this,arguments)}function f(){return(f=l((function*(e,t,r){var n,s,u,c,l,d,p,f,h,m,y=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];if(!I(e.ApplicationState,a.MDLUseStateOverMetadataCache))return null;var v=null===(n=e.TraceManager)||void 0===n?void 0:n.getTracer(o.COMPONENT_NAMES.MetadataCache),g=null===(s=e.ApplicationState)||void 0===s||null===(u=s.metadata)||void 0===u||null===(c=u.attributes)||void 0===c?void 0:c[r];if(Object(i.isNullOrUndefined)(g)&&(yield V(e,r,t,y)),g=null===(l=e.ApplicationState)||void 0===l||null===(d=l.metadata)||void 0===d||null===(p=d.attributes)||void 0===p?void 0:p[r],Object(i.isNullOrUndefined)(g))return v.warn("".concat(Q()," state does not contain entity metadata even after refresh ").concat(r)),null;var O=Object.keys(g),E={};if(0===t.length){for(var b of O)E[b]=g[b].Type;return E}if(!t.every(e=>O.includes(e))){var T=t.filter(e=>O.indexOf(e)<0);y.push({name:"MissingAttributesInState",value:T.join(",")}),v.warn("".concat(Q()," Not all attributes requested have metadata present in the injected state."),y),yield V(e,r,t,y)}if(g=null===(f=e.ApplicationState)||void 0===f||null===(h=f.metadata)||void 0===h||null===(m=h.attributes)||void 0===m?void 0:m[r],Object(i.isNullOrUndefined)(g))return v.warn("".concat(Q()," state does not contain entity metadata even after refresh ").concat(r)),null;for(var S of t)g[S]&&(E[S]=g[S].Type);return E}))).apply(this,arguments)}function h(e){return m.apply(this,arguments)}function m(){return(m=l((function*(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!I(e.ApplicationState,a.MDLUseStateOverMetadataCache))return null;var r=y(e);return r||(yield k(e,t),y(e))}))).apply(this,arguments)}function y(e){var t,r,n,a,o,s,u,c,l,d,p,f;if(null!==(t=e.ApplicationState)&&void 0!==t&&null!==(r=t.user)&&void 0!==r&&null!==(n=r.userSettings)&&void 0!==n&&n.languageId&&!Object(i.isNullOrUndefined)(null===(a=e.ApplicationState)||void 0===a||null===(o=a.user)||void 0===o||null===(s=o.userSettings)||void 0===s?void 0:s.timeZoneUtcOffsetMinutes)&&!Object(i.isNullOrUndefined)(null===(u=e.ApplicationState)||void 0===u||null===(c=u.user)||void 0===c||null===(l=c.userSettings)||void 0===l?void 0:l.timeZoneAdjusters)&&!Object(i.isNullOrUndefined)(null===(d=e.ApplicationState)||void 0===d||null===(p=d.user)||void 0===p||null===(f=p.userSettings)||void 0===f?void 0:f.dateFormatInfo)){var h,m=e.ApplicationState.user.userSettings,y={timezoneutcoffsetminutes:m.timeZoneUtcOffsetMinutes,timezoneadjusters:[],datetimeformatinfo:m.dateFormatInfo,languageid:m.languageId};return y.timezoneadjusters=null===(h=m.timeZoneAdjusters)||void 0===h?void 0:h.map(e=>({dateend:e.dateEnd,datestart:e.dateStart,daylightend:{day:e.daylightEnd.day,dayofweek:e.daylightEnd.dayOfWeek,month:e.daylightEnd.month,week:e.daylightEnd.week,timeofday:e.daylightEnd.timeOfDay,isfixeddaterule:e.daylightEnd.isFixedDateRule},daylightstart:{day:e.daylightStart.day,dayofweek:e.daylightStart.dayOfWeek,month:e.daylightStart.month,week:e.daylightStart.week,timeofday:e.daylightStart.timeOfDay,isfixeddaterule:e.daylightStart.isFixedDateRule},delta:e.delta})),y}return null}function v(e){return g.apply(this,arguments)}function g(){return(g=l((function*(e){var t,r,n,i,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!I(e.ApplicationState,a.MDLUseStateOverMetadataCache))return null;var s=null===(t=e.ApplicationState)||void 0===t||null===(r=t.organization)||void 0===r?void 0:r.organizationSettings;if(s&&s.fullNameConventionCode&&s.languageCode){var u={fullnameconventioncode:s.fullNameConventionCode,languageCode:s.languageCode};return u}if(yield k(e,o),(s=null===(n=e.ApplicationState)||void 0===n||null===(i=n.organization)||void 0===i?void 0:i.organizationSettings)&&s.fullNameConventionCode&&s.languageCode){var c={fullnameconventioncode:s.fullNameConventionCode,languageCode:s.languageCode};return c}return null}))).apply(this,arguments)}function O(e){return E.apply(this,arguments)}function E(){return(E=l((function*(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!I(e.ApplicationState,a.MDLUseStateOverMetadataCache))return null;var r=yield v(e,t);return r&&!Object(i.isNullOrUndefined)(r.fullnameconventioncode)?r.fullnameconventioncode:null}))).apply(this,arguments)}function b(e){return T.apply(this,arguments)}function T(){return(T=l((function*(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!I(e.ApplicationState,a.MDLUseStateOverMetadataCache))return null;var r=yield v(e,t);return r&&!Object(i.isNullOrUndefined)(r.languageCode)?r.languageCode:null}))).apply(this,arguments)}function S(e){return C.apply(this,arguments)}function C(){return(C=l((function*(e){var t,r,n,o,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!I(e.ApplicationState,a.MDLUseStateOverMetadataCache))return null;var u=null===(t=e.ApplicationState)||void 0===t||null===(r=t.user)||void 0===r?void 0:r.userId;return Object(i.isNullOrUndefined)(u)?(yield k(e,s),u=null===(n=e.ApplicationState)||void 0===n||null===(o=n.user)||void 0===o?void 0:o.userId,Object(i.isNullOrUndefined)(u)?null:u):u}))).apply(this,arguments)}function N(e){return _.apply(this,arguments)}function _(){return(_=l((function*(e){var t,r,n,o,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!I(e.ApplicationState,a.MDLUseStateOverMetadataCache))return null;var u=null===(t=e.ApplicationState)||void 0===t||null===(r=t.user)||void 0===r?void 0:r.userDisplayName;return Object(i.isNullOrUndefined)(u)?(yield k(e,s),u=null===(n=e.ApplicationState)||void 0===n||null===(o=n.user)||void 0===o?void 0:o.userDisplayName,Object(i.isNullOrUndefined)(u)?null:u):u}))).apply(this,arguments)}function R(e,t){return P.apply(this,arguments)}function P(){return(P=l((function*(e,t){var r,n,i,o,s,u,c,l,d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(!I(e.ApplicationState,a.MDLUseStateOverMetadataCache))return null;var p=null===(r=e.ApplicationState)||void 0===r||null===(n=r.fcbs)||void 0===n?void 0:n.clientFCBs,f=null===(i=e.ApplicationState)||void 0===i||null===(o=i.fcbs)||void 0===o?void 0:o.nativeFCBContext;return p&&void 0!==p[t]?p[t]:f&&void 0!==f[t]?f[t]:(yield k(e,d),p=null===(s=e.ApplicationState)||void 0===s||null===(u=s.fcbs)||void 0===u?void 0:u.clientFCBs,f=null===(c=e.ApplicationState)||void 0===c||null===(l=c.fcbs)||void 0===l?void 0:l.nativeFCBContext,p&&void 0!==p[t]?p[t]:f&&void 0!==f[t]?f[t]:null)}))).apply(this,arguments)}function I(e,t){var r=e?e.fcbs:void 0;if(r){var n=r.clientFCBs;if(n)return t in n&&(n[t]||function(e,t){var r=e?e.fcbs:void 0;if(r){var n=r.nativeFCBContext;if(n&&t in n)return n[t]}return!1}(e,t))}return!1}function A(e,t,r){return D.apply(this,arguments)}function D(){return(D=l((function*(e,t,r){var i,o,s,u,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];if(!I(e.ApplicationState,a.MDLUseStateOverMetadataCache))return null;var l=null===(i=e.ApplicationState)||void 0===i||null===(o=i.metadata)||void 0===o?void 0:o.views;return l&&l[t]&&l[t].initialized===n.InitState.Initialized?l[t]:(yield H(e,r,t,c),(l=null===(s=e.ApplicationState)||void 0===s||null===(u=s.metadata)||void 0===u?void 0:u.views)&&l[t]&&l[t].initialized===n.InitState.Initialized?l[t]:null)}))).apply(this,arguments)}function M(e,t){return F.apply(this,arguments)}function F(){return(F=l((function*(e,t){var r,i,o,s,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(!I(e.ApplicationState,a.MDLUseStateOverMetadataCache))return null;var c=null===(r=e.ApplicationState)||void 0===r||null===(i=r.metadata)||void 0===i?void 0:i.entities;return c&&c[t]&&c[t].Initialized===n.InitState.Initialized?c[t]:(yield V(e,t,[],u),(c=null===(o=e.ApplicationState)||void 0===o||null===(s=o.metadata)||void 0===s?void 0:s.entities)&&c[t]&&c[t].Initialized===n.InitState.Initialized?c[t]:null)}))).apply(this,arguments)}function w(e,t){var r,n,i,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(!I(e.ApplicationState,a.MDLUseStateOverMetadataCache))return null;var c=null===(r=e.TraceManager)||void 0===r?void 0:r.getTracer(o.COMPONENT_NAMES.MetadataCache),l=null===(n=e.ApplicationState)||void 0===n||null===(i=n.metadata)||void 0===i?void 0:i.entities;if(l){var d=Object(u.searchEntityLogicalNameFromEntityMetadata)(l,t,c,s);if(d)return d}return null}function L(e){return j.apply(this,arguments)}function j(){return(j=l((function*(e){var t,r,n,o,s,u,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!I(e.ApplicationState,a.MDLUseStateOverMetadataCache))return null;var l=null===(t=e.ApplicationState)||void 0===t||null===(r=t.user)||void 0===r||null===(n=r.userSettings)||void 0===n?void 0:n.offlineProfileAvailableEntities;return Object(i.isNullOrUndefined)(l)?(yield k(e,c),l=null===(o=e.ApplicationState)||void 0===o||null===(s=o.user)||void 0===s||null===(u=s.userSettings)||void 0===u?void 0:u.offlineProfileAvailableEntities,Object(i.isNullOrUndefined)(l)?null:l):l}))).apply(this,arguments)}function x(e,t){var r,n;if(!I(e.ApplicationState,a.MDLUseStateOverMetadataCache))return null;var i=null===(r=e.ApplicationState)||void 0===r||null===(n=r.metadata)||void 0===n?void 0:n.entitiesByTypeCode;return i&&i[t]?i[t]:null}function U(e,t){var r,n,a=null===(r=e.ApplicationState)||void 0===r||null===(n=r.metadata)||void 0===n?void 0:n.attributes;return a&&a[t]?a[t]:{}}function k(e){return q.apply(this,arguments)}function q(){return(q=l((function*(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=null===(t=e.TraceManager)||void 0===t?void 0:t.getTracer(o.COMPONENT_NAMES.MetadataCache);if(I(e.ApplicationState,a.MDLUseStateOverMetadataCachePhase2)){var i,s,u=null===(i=e.StateProvider)||void 0===i?void 0:i.getStore(),c=null===(s=e.StateProvider)||void 0===s?void 0:s.getActions().retrieveUserContext;u&&c?yield u.dispatch(c()):null==n||n.warn("".concat(Q()," Unable to refresh user context metadata, no store or retrieve user context action"),r)}}))).apply(this,arguments)}function V(e,t,r){return B.apply(this,arguments)}function B(){return(B=l((function*(e,t,r){var n,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],s=null===(n=e.TraceManager)||void 0===n?void 0:n.getTracer(o.COMPONENT_NAMES.MetadataCache);if(I(e.ApplicationState,a.MDLUseStateOverMetadataCachePhase2)){var u,c,l=null===(u=e.StateProvider)||void 0===u?void 0:u.getStore(),d=null===(c=e.StateProvider)||void 0===c?void 0:c.getActions().retrieveEntity;l&&d?yield l.dispatch(d(t,!r||0===r.length,r)):s.warn("".concat(Q()," Unable to refresh entity metadata, no store or retrieve entity action"),i)}}))).apply(this,arguments)}function H(e,t,r){return G.apply(this,arguments)}function G(){return(G=l((function*(e,t,r){var n,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],u=null===(n=e.TraceManager)||void 0===n?void 0:n.getTracer(o.COMPONENT_NAMES.MetadataCache),c=s.Guid.tryParseOrNull(r);if(I(e.ApplicationState,a.MDLUseStateOverMetadataCachePhase2)&&t&&c){var l,d,p=null===(l=e.StateProvider)||void 0===l?void 0:l.getStore(),f=null===(d=e.StateProvider)||void 0===d?void 0:d.getActions().retrieveView;p&&f?yield p.dispatch(f(t,void 0,void 0,c)):u.warn("".concat(Q()," Unable to view descriptor metadata, no store or retrieve view action"),i)}}))).apply(this,arguments)}function Q(){return"[".concat(o.FILE_PREFIX.MetadataStateAccessor,"]")}},9075:function(e,t,r){"use strict";var n;r.r(t),r.d(t,"InitState",(function(){return n})),function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized",e[e.Refreshing=3]="Refreshing",e[e.Error=4]="Error",e[e.Partial=5]="Partial"}(n||(n={}))},9076:function(e,t,r){"use strict";r.r(t),r.d(t,"searchEntityLogicalNameFromEntityMetadata",(function(){return o})),r.d(t,"searchEntityLogicalNameFromObjectTypeCode",(function(){return s})),r.d(t,"computeRequestedAttrDiffWithStatePlusMetadataCache",(function(){return u})),r.d(t,"getInitializedStateAttributes",(function(){return c}));var n=r(9075),a=r(9050),i=r(9047);function o(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];if(!Object(a.isNullOrUndefined)(e))for(var i in e)if(i){var o=e[i];if(o&&o.EntitySetName===t){var s=o.EntityLogicalName;return Object(a.isNullOrUndefined)(s)&&r.error("".concat(l()," entity set name ").concat(t," exists in the state but its entityLogicalName is null or undefined."),n),s}}return null}function s(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];if(!Object(a.isNullOrUndefined)(e))for(var i in e)if(i){var o=e[i];if(o&&o.ObjectTypeCode===t){var s=o.EntityLogicalName;return Object(a.isNullOrUndefined)(s)&&r.error("".concat(l()," entity with object type code ").concat(t," exits in the state but its entityLogicalName is null or undefined."),n),s}}return null}function u(e,t,r){for(var a=[],i=0;i<r.length;i++)t[r[i]]||e[r[i]]&&e[r[i]].Initialized===n.InitState.Initialized||a.push(r[i]);return a}function c(e){var t={};for(var r of Object.keys(e))e[r].Initialized===n.InitState.Initialized&&(t[r]=e[r]);return t}function l(){return"[".concat(i.FILE_PREFIX.MetadataUtil,"]")}},9077:function(e,t,r){"use strict";var n,a,i,o;r.r(t),r.d(t,"ApplicationMetadataType",(function(){return n})),r.d(t,"MetadataType",(function(){return a})),r.d(t,"MetadataSubtype",(function(){return o})),r.d(t,"QueriedMetadataType",(function(){return i})),function(e){e[e.all=0]="all",e[e.systemApplicationMetadata=1]="systemApplicationMetadata",e[e.userApplicationMetadata=2]="userApplicationMetadata"}(n||(n={})),function(e){e[e.none=0]="none",e[e.workspace=1]="workspace",e[e.form=2]="form",e[e.component=3]="component",e[e.entityCard=4]="entityCard",e[e.quickCreateForm=5]="quickCreateForm",e[e.customization=6]="customization",e[e.listQuery=7]="listQuery",e[e.grid=8]="grid",e[e.command=9]="command",e[e.siteMap=10]="siteMap",e[e.list=11]="list",e[e.dialog=12]="dialog",e[e.gridForm=13]="gridForm",e[e.inlineCreateForm=14]="inlineCreateForm",e[e.processControl=15]="processControl",e[e.fetchXml=16]="fetchXml",e[e.chartDrilldownForm=17]="chartDrilldownForm",e[e.entity=18]="entity",e[e.attribute=19]="attribute",e[e.webResource=20]="webResource",e[e.applicationMetadata=21]="applicationMetadata",e[e.mainFormDialog=22]="mainFormDialog",e[e.chart=23]="chart",e[e.uiStrings=24]="uiStrings",e[e.businessLogic=25]="businessLogic",e[e.searchPage=26]="searchPage",e[e.globalApplicationMetadata=27]="globalApplicationMetadata",e[e.applicationMetadataUserContext=28]="applicationMetadataUserContext",e[e.staticJSFile=29]="staticJSFile",e[e.layoutXml=30]="layoutXml",e[e.draftsPage=31]="draftsPage",e[e.duplicateRecordsPage=32]="duplicateRecordsPage",e[e.applicationMetadataSettings=33]="applicationMetadataSettings",e[e.senderFormPage=34]="senderFormPage",e[e.setRegarding=35]="setRegarding",e[e.senderCreateFormPage=36]="senderCreateFormPage",e[e.interactionCentricWorkspace=37]="interactionCentricWorkspace",e[e.taskBasedFlowGlobalMenu=38]="taskBasedFlowGlobalMenu",e[e.taskBasedFlow=39]="taskBasedFlow",e[e.interactionCentricForm=40]="interactionCentricForm",e[e.cardForm=41]="cardForm",e[e.controlConfiguration=42]="controlConfiguration",e[e.commandXaml=43]="commandXaml",e[e.documentTemplate=44]="documentTemplate",e[e.viewSelector=45]="viewSelector",e[e.customControl=46]="customControl",e[e.formSelector=47]="formSelector",e[e.resourceString=48]="resourceString",e[e.savedQueryVisualization=49]="savedQueryVisualization",e[e.label=50]="label",e[e.userView=51]="userView",e[e.savedView=52]="savedView",e[e.viewDefault=53]="viewDefault",e[e.homePageConfiguration=54]="homePageConfiguration",e[e.optionSet=56]="optionSet",e[e.quickCreateMenu=57]="quickCreateMenu",e[e.userContext=58]="userContext",e[e.businessProcessFlow=59]="businessProcessFlow",e[e.searchConfiguration=60]="searchConfiguration",e[e.userQueryVisualization=61]="userQueryVisualization",e[e.visualizationSelector=62]="visualizationSelector",e[e.dashboardSelector=63]="dashboardSelector",e[e.overallMetadataVersion=64]="overallMetadataVersion",e[e.appModule=65]="appModule",e[e.complexControl=66]="complexControl",e[e.displayString=67]="displayString",e[e.webResourceDescriptor=68]="webResourceDescriptor",e[e.isActivityFlags=69]="isActivityFlags",e[e.appModuleOfflineMetadata=70]="appModuleOfflineMetadata",e[e.appModuleSelector=71]="appModuleSelector",e[e.bpfSelector=72]="bpfSelector",e[e.dependencies=73]="dependencies"}(a||(a={})),function(e){e.entity="entity",e.savedView="savedview",e.form="form",e.workspace="workspace",e.systemWorkspace="systemworkspace",e.userWorkspace="userworkspace",e.savedVisualization="savedvisualization",e.dialog="dialog",e.taskBasedFlow="taskbasedflow",e.customControl="customcontrol",e.complexControl="complexcontrol",e.formSelector="formselector",e.viewSelector="viewselector",e.ribbon="ribbon"}(i||(i={})),function(e){e[e.none=0]="none",e[e.main=1]="main",e[e.appointment=2]="appointment",e[e.hardcoded=3]="hardcoded",e[e.miniCampaignBO=4]="miniCampaignBO",e[e.preview=5]="preview",e[e.dashboard=6]="dashboard",e[e.quick=7]="quick",e[e.quickCreate=8]="quickCreate",e[e.mobile=9]="mobile",e[e.read=10]="read",e[e.card=11]="card",e[e.dialog=12]="dialog",e[e.taskBased=14]="taskBased",e[e.interactionCentricDashboard=15]="interactionCentricDashboard",e[e.advancedSearch=16]="advancedSearch",e[e.subGrid=17]="subGrid",e[e.quickFindSearch=18]="quickFindSearch",e[e.reporting=19]="reporting",e[e.offlineFilters=20]="offlineFilters",e[e.maSearch=21]="maSearch",e[e.lookup=22]="lookup",e[e.smAppointmentBook=23]="smAppointmentBook",e[e.outlookFilters=24]="outlookFilters",e[e.addressbookFilters=25]="addressbookFilters",e[e.savedQueryTypeOther=26]="savedQueryTypeOther",e[e.interactiveWorkFlow=27]="interactiveWorkFlow",e[e.offlineTemplate=28]="offlineTemplate",e[e.outlookTemplate=29]="outlookTemplate",e[e.customDefined=30]="customDefined",e[e.jScript=31]="jScript",e[e.css=32]="css",e[e.png=33]="png",e[e.jpg=34]="jpg",e[e.gif=35]="gif",e[e.advancedFind=36]="advancedFind"}(o||(o={}))},9078:function(e,t,r){"use strict";r.r(t),r.d(t,"METADATA_TYPE_TO_KEYS",(function(){return o})),r.d(t,"LegacyDependencyDepth",(function(){return n})),r.d(t,"FormFactor",(function(){return a})),r.d(t,"APPLICATION_METADATA_VERSION_STAMP_KEY",(function(){return u})),r.d(t,"MetadataFields",(function(){return s})),r.d(t,"APPLICATION_METADATA_STORE",(function(){return c})),r.d(t,"ENTITY_METADATA_STORE",(function(){return d})),r.d(t,"ENTITY_DEFINITIONS_TYPE",(function(){return h})),r.d(t,"APPLICATION_METADATA_DEPENDENCY_VIEW",(function(){return l})),r.d(t,"USER_CONTEXT_STORE",(function(){return p})),r.d(t,"USER_CONTEXT_KEY",(function(){return f}));var n,a,i=r(9077),o={};o.form=[{metadataType:i.MetadataType.formSelector,uniqueKey:"Id",payloadKey:"FormSelectors"},{metadataType:i.MetadataType.form,uniqueKey:"FormId",payloadKey:"Forms"}],o.savedview=[{metadataType:i.MetadataType.viewSelector,uniqueKey:"ViewId",payloadKey:"ViewSelectors"},{metadataType:i.MetadataType.savedView,uniqueKey:"ViewId",payloadKey:"Views"}],o.workspace=[{metadataType:i.MetadataType.dashboardSelector,uniqueKey:"Id",payloadKey:"DashboardSelectors"},{metadataType:i.MetadataType.form,uniqueKey:"FormId",payloadKey:"Forms"},{metadataType:i.MetadataType.workspace,uniqueKey:"FormId",payloadKey:"Dashboards"},{metadataType:i.MetadataType.interactionCentricWorkspace,uniqueKey:"FormId",payloadKey:"Dashboards"}],o.systemworkspace=[{metadataType:i.MetadataType.dashboardSelector,uniqueKey:"Id",payloadKey:"DashboardSelectors"},{metadataType:i.MetadataType.form,uniqueKey:"FormId",payloadKey:"Forms"},{metadataType:i.MetadataType.workspace,uniqueKey:"FormId",payloadKey:"Dashboards"},{metadataType:i.MetadataType.interactionCentricWorkspace,uniqueKey:"FormId",payloadKey:"Dashboards"}],o.userworkspace=[{metadataType:i.MetadataType.dashboardSelector,uniqueKey:"Id",payloadKey:"DashboardSelectors"},{metadataType:i.MetadataType.form,uniqueKey:"FormId",payloadKey:"Forms"},{metadataType:i.MetadataType.workspace,uniqueKey:"FormId",payloadKey:"Dashboards"},{metadataType:i.MetadataType.interactionCentricWorkspace,uniqueKey:"FormId",payloadKey:"Dashboards"}],o.savedvisualization=[{metadataType:i.MetadataType.visualizationSelector,uniqueKey:"Id",payloadKey:"VisualizationSelectors"},{metadataType:i.MetadataType.savedQueryVisualization,uniqueKey:"Id",payloadKey:"SavedQueryVisualizations"}],function(e){e[e.Unknown=0]="Unknown",e[e.OnDemandWithContext=1]="OnDemandWithContext",e[e.OnDemandWithoutContext=2]="OnDemandWithoutContext",e[e.OnDemandContextOnly=3]="OnDemandContextOnly",e[e.Offline=4]="Offline",e[e.Mobile=5]="Mobile",e[e.UserContext=6]="UserContext"}(n||(n={})),function(e){e[e.None=0]="None",e[e.Slate=1]="Slate",e[e.Phone=2]="Phone",e[e.Desktop=3]="Desktop",e[e.MailApp=4]="MailApp"}(a||(a={}));var s,u="applicationmetadataversionstamp";!function(e){e.METADATA_TYPE="metadatatype",e.SOURCE_ID="sourceid",e.ASSOCIATED_ENTITY_LOGICAL_NAME="associatedentitylogicalname",e.METADATA_SUBTYPE="metadatasubtype",e.DISPLAY_NAME="displayname",e.JSON="json"}(s||(s={}));var c="applicationmetadata",l="metadatadependency",d="entitymetadata",p="usercontext",f="contextkey",h="entitydefinitionstype"},9079:function(e,t,r){"use strict";r.r(t),r.d(t,"MemoryCalculator",(function(){return n}));class n{constructor(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._object=void 0,this._before=void 0,this._after=void 0,this._isEnabled=void 0,this._object=e,this._before=-1,this._after=-1,this._isEnabled=t}calculateBefore(){this._isEnabled&&null!==this._object&&void 0!==this._object&&(this._before=this.calcObjectSize(this._object))}calculateAfter(){this._isEnabled&&null!==this._object&&void 0!==this._object&&(this._after=this.calcObjectSize(this._object))}getBeforeSize(){if(this._isEnabled){if(-1===this._before)throw new Error("You have not called 'calculateBefore()'.");return this._before}return-1}getAfterSize(){if(this._isEnabled){if(-1===this._before)throw new Error("You have not called 'calculateAfter()'.");return this._after}return-1}calcObjectSize(e){for(var t=[e],r=0;t.length;){var n=t.pop();if(null!=n)switch(typeof e){case"number":r+=8;break;case"string":r+=2*n.length;break;case"boolean":r+=4;break;case"object":var a=Object.prototype.toString.call(n).slice(8,-1);if("Object"===a||"Array"===a)for(var i in n)n.hasOwnProperty(i)&&t.push(n[i]);else r+=2*n.toString().length;break;default:r+=0}}return r}}},9080:function(e,t,r){"use strict";r.r(t),r.d(t,"EntityReference",(function(){return i}));var n=r(9046),a=r(9081);class i{constructor(e,t,r){this.etn=void 0,this.id=void 0,this.name=void 0,this.etn=e,this.id=t||n.Guid.EMPTY,this.name=r,Object.freeze(this)}static toString(e){return"".concat(e.etn,":").concat(n.Guid.toString(e.id))}static equals(e,t){var r=i.equalsIgnoreName(e,t);return e&&t?(e.name&&t.name&&(r=r&&e.name===t.name),r):r}static equalsIgnoreName(e,t){return!e&&!t||!(!e||!t)&&(e.etn===t.etn&&n.Guid.equals(e.id,t.id))}static toLegacyEntityReference(e){return new a.LegacyEntityReference(e.etn,n.Guid.toLegacyGuid(e.id),e.name)}static fromLegacyEntityReference(e){return new i(e.LogicalName,n.Guid.fromLegacyGuid(e.Id),e.Name)}static fromExternalEntityReference(e){return new i(e.entityType,n.Guid.fromExternalGuid(e.id))}static legacyToExternalEntityReference(e){return{id:n.Guid.externalGuid(n.Guid.fromLegacyGuid(e.Id)),entityType:e.LogicalName}}static toExternalEntityReference(e){return{id:n.Guid.externalGuid(e.id),entityType:e.etn}}}i.EMPTY=new i("")},9081:function(e,t,r){"use strict";r.r(t),r.d(t,"LegacyEntityReference",(function(){return o}));var n=r(9082),a=r(9083),i=r(9049);class o{constructor(e,t,r,i){this.Id=void 0,this.LogicalName=void 0,this.Name=void 0,this.TypeCode=0,this.TypeDisplayName=void 0,this.TypeName=void 0,this.__RowVersion=void 0,Object(n.throwOnNullOrUndefinedArgument)(e,"logicalName"),Object(n.throwOnNullOrUndefinedArgument)(t,"id"),this.LogicalName=e,t&&(this.Id=t),Object(a.IsNullOrUndefined)(r)||(this.Name=r),Object(a.IsNullOrUndefined)(i)||this.set_rowVersion(i),this.TypeName=e,this.TypeDisplayName=e}get_key(){return this.Id.toString()}get_identifier(){return this.Id.toString()}get_modelType(){return this.LogicalName}get_rowVersion(){return this.__RowVersion}set_rowVersion(e){return this.__RowVersion=e,e}getObjectData(){return{logicalname:this.LogicalName,id:this.Id.getObjectData(),name:this.Name,rowversion:!Object(a.IsNullOrUndefined)(this.get_rowVersion())&&this.get_rowVersion()}}equals(e){if(e instanceof o){var t=e;return t.LogicalName===this.LogicalName&&this.Id.equals(t.Id)&&this.Name===t.Name}return!1}toString(){return this.LogicalName+this.Id.toString()}getValue(e){return this[o._UppercaseFirstCharacter(e)]}setValue(e,t){this[o._UppercaseFirstCharacter(e)]=t}static get_empty(){return o._empty||(o._empty=new o("",i.LegacyGuid.get_empty(),""))}static createFromObjectData(e){var t=e.logicalname,r=i.LegacyGuid.createFromObjectData(e.id),n=e.name;if(e.rowversion){var a=e.rowversion;return new o(t,r,n,a)}return new o(t,r,n)}static _UppercaseFirstCharacter(e){return e.substr(0,1).toUpperCase()+e.substr(1)}}o._empty=void 0},9082:function(e,t,r){"use strict";r.r(t),r.d(t,"throwOnNullArgument",(function(){return a})),r.d(t,"throwOnNullOrUndefinedArgument",(function(){return i})),r.d(t,"throwOnUndefinedArgument",(function(){return o})),r.d(t,"throwOnNullOrEmptyArgument",(function(){return s})),r.d(t,"throwOnNotEquals",(function(){return u})),r.d(t,"throwOnOutOfRange",(function(){return c})),r.d(t,"throwOnAssert",(function(){return l}));var n=r(9083);function a(e,t){if(null===e)throw Error(t+"Argument can't be null")}function i(e,t){if(Object(n.IsNullOrUndefined)(e))throw Error(t+"Argument can't be null or undefined")}function o(e,t){if(void 0===e)throw Error(t+"Argument can't be undefined")}function s(e,t){if(!e||!e.length)throw Error(t+"Argument can't be null or empty")}function u(e,t,r){if(e!==t)throw Error(r+"Argument is "+e+"but should be equal to "+t)}function c(e,t,r,n){if(e<t||e>r)throw Error(n)}function l(e,t){if(!e)throw Error("ExceptionHelpers.ThrowOnAssert("+t+")")}},9083:function(e,t,r){"use strict";r.r(t),r.d(t,"IsNullOrUndefined",(function(){return o})),r.d(t,"IsNullOrUndefinedOrEmptyString",(function(){return s})),r.d(t,"isUrl",(function(){return u}));var n=/(http|https):\/\/(\w+:{0,1}\w*)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%!\-\/]))?/,a=/(dynamicsxrm):\/\/(\w+:{0,1}\w*)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%!\-\/]))?/,i=/^\/([0-9a-zA-Z_]+\/)?main.aspx/;function o(e){return null==e}function s(e){return!!o(e)||"string"==typeof e&&""===e.trim()}function u(e){return n.test(e)||a.test(e)||i.test(e)}},9084:function(e,t,r){"use strict";r.r(t),r.d(t,"EXECUTE_ODATA_OPERATION",(function(){return m})),r.d(t,"executeOData",(function(){return y})),r.d(t,"requestAdditionalMetadataForRequest",(function(){return v})),r.d(t,"addAttributes",(function(){return g}));var n=r(9047),a=r(9046),i=r(9085),o=r(9087),s=r(9214),u=r(9228),c=r(9227),l=r(9184),d=r(9196),p=r(9179);function f(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function h(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){f(i,n,a,o,s,"next",e)}function s(e){f(i,n,a,o,s,"throw",e)}o(void 0)}))}}var m="executeOData.execute";function y(e,t){var r=[];return{type:m,execute:s=>h((function*(){var{dispatch:u}=s,c=new i.UCIContext(a.Guid.newGuid().guid);return r.push({name:n.EVENT_PARAMETERS.CLIENT_REQUEST_ID,value:c.RequestId()}),t&&t.push({name:n.EVENT_PARAMETERS.CLIENT_REQUEST_ID,value:c.RequestId()}),u(Object(o.execute)(e,r))}))(),getFailureParameters:()=>r}}function v(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return{type:"executeOData.requestAdditionalMetadata.async",execute:(e,r)=>h((function*(){var{dispatch:r,getState:n}=e;if(t){var a=t.reduce(O,{});yield r(Object(p.retrieveEntities)(a))}}))()}}function g(e,t,r){e.hasOwnProperty(t)?e[t]&&(e[t]=r?Array.from(new Set(e[t].concat(r))):null):e[t]=r}function O(e,t){if(Object(d.isChangeSet)(t))return t.reduce(O,{});if(Object(d.isODataContract)(t)){var r=null;if(!t||"function"!=typeof t.getMetadata||!(r=t.getMetadata()))return e;if("ExecuteMultiple"===r.operationName)return t.requests.reduce(O,{});if("Create"===r.operationName){var n=t,a=Object(u.determineReturnedColumns)(n.payload);g(e,n.etn,a)}else if("Update"===r.operationName){var i=t,o=Object(u.determineReturnedColumns)(i.payload);g(e,i.etn,o)}else if("Delete"===r.operationName){g(e,t.entityReference.entityType,[])}else{var p=function e(t){var r=null,n=null;if(!t||"function"!=typeof t.getMetadata||!(r=t.getMetadata())||!(n=r.parameterTypes))return[];var a=new Set;for(var i of Object.keys(t)){var o=t[i];if(null!=o)if(r.boundParameter===i)n[i].structuralProperty===s.ODataStructuralProperty.Collection?a.add(o):a.add(o.entityType);else if(n[i])switch(n[i].structuralProperty){case s.ODataStructuralProperty.Collection:if(o&&o.length)if(o[0].getMetadata){var u=o;for(var l of u)e(l).forEach(e=>a.add(e))}else if(-1===c.ODataPrimitives.indexOf(n[i].typeName)){var d=o;for(var p of d)"object"==typeof p&&"entityType"in p&&"id"in p&&a.add(p.entityType)}break;case s.ODataStructuralProperty.EntityType:"object"==typeof o&&"entityType"in o&&"id"in o&&a.add(o.entityType);break;case s.ODataStructuralProperty.ComplexType:e(o).forEach(e=>a.add(e))}}return Array.from(a)}(t);for(var f of p)g(e,f,[])}return e}throw new l.ErrorStatus("unsupported request")}},9085:function(e,t,r){"use strict";r.r(t),r.d(t,"UCIContext",(function(){return a}));var n=r(9086);class a extends n.CallingContext{constructor(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super(e),this._isPreloadCall=!1,this.requestId=e,this._isPreloadCall=t}RequestId(){return this.requestId}IsPreloadCall(){return this._isPreloadCall}toString(){return"["+this.RequestId()+"]"}}},9086:function(e,t,r){"use strict";r.r(t),r.d(t,"CallingContext",(function(){return a}));var n=r(9083);class a{constructor(e,t,r){this.requestId=void 0,this._callerName=void 0,this._callerPriority=0,this._stack=void 0,this._callerName=Object(n.IsNullOrUndefinedOrEmptyString)(t)?a.unknown:t,this._callerPriority=r}get_callerName(){return this._callerName}get_Stack(){return this._stack}AppendCallStack(e){Object(n.IsNullOrUndefined)(e)||(Object(n.IsNullOrUndefined)(this._stack)?this._stack=e:this._stack=this._stack+":"+e)}get_callerPriority(){return this._callerPriority}IsPreloadCall(){return!1}}a.unknown="unknown"},9087:function(e,t,r){"use strict";r.r(t),r.d(t,"MDS_EVENT_PARAMETERS",(function(){return H})),r.d(t,"initializeExpressionRuntime",(function(){return G})),r.d(t,"execute",(function(){return z})),r.d(t,"retrieveMultiple",(function(){return X})),r.d(t,"retrieve",(function(){return W})),r.d(t,"retrieveMultipleRecords",(function(){return Y})),r.d(t,"_sendRequest",(function(){return Z})),r.d(t,"parseJsonResponse",(function(){return he}));var n=r(9045),a=r(9047),i=r(9061),o=r(9088),s=r(9084),u=r(9179),c=r(9193),l=r(9194),d=r(9254),p=r(9216),f=r(9258),h=r(9219),m=r(9228),y=r(9273),v=r(9184),g=r(9268),O=r(9218),E=r(9255),b=r(9195),T=r(9227),S=r(9196),C=r(9206),N=r(9186),_=r(9187),R=r(9274),P=r(9238),I=r(9257),A=r(9275),D=r(9246),M=r(9240),F=r(9239),w=r(9050),L=r(9241),j=r(9230),x=r(9242);function U(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function k(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?U(Object(r),!0).forEach((function(t){q(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):U(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function q(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function V(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function B(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){V(i,n,a,o,s,"next",e)}function s(e){V(i,n,a,o,s,"throw",e)}o(void 0)}))}}var H={CRM_ERROR_CODE:"Crm-Error-Code",CRM_ERROR_MESSAGE:"Crm-Error-Message",CRM_CALL_STACK:"Crm-Call-Stack",IS_BATCH_REQUEST:"IsBatchRequest",IS_EXPRESSION_RUNTIME_REQUEST:"IS_EXPRESSION_RUNTIME_REQUEST",IS_ERROR_IN_OFFLINE:"ErrorInOffline",ODATA_ERROR_RESPONSE_IS_HTML_TYPE:"Odata-Error-Response-Is-Html-Type"};function G(e,t,r){return Q.apply(this,arguments)}function Q(){return(Q=B((function*(e,t,r){return null}))).apply(this,arguments)}function z(e,t,r){return{type:"modernDataSource.execute.odata.async",execute:(t,r)=>B((function*(){var{getState:n,dispatch:a}=t,i=r.TraceManager.getTracer(b.MDL_COMPONENT_NAMES.ModernDataSource);return i.info("".concat(ye()," Execute legacy request.")),yield a(Object(s.requestAdditionalMetadataForRequest)(e)),Z(yield a(Object(l.fromODataContract)(e)),n,i,C.RetrievalStrategy.Default,r)}))()}}function X(e){return{type:"moderndatasource.retrievemultiple.async",execute:(t,r)=>B((function*(){var{getState:n,dispatch:a}=t,i=r.TraceManager.getTracer(b.MDL_COMPONENT_NAMES.ModernDataSource);i.info("".concat(ye()," Retrieve multiple is executing"));var o=Object(g.getAttributesMapFromFetch)(null==e?void 0:e.fetchXml);yield a(Object(u.retrieveEntities)(o));var s=yield a(Object(l.fromQueryState)(e)),c=Object(f.parseFetchXmlForAliasedValues)(null==e?void 0:e.fetchXml),d=yield Z(s,n,i,C.RetrievalStrategy.Default,r),p=yield he(d,i);return Object(f.deserializeEntityCollection)(n(),e,c,p)}))()}}function W(e,t){return{type:"moderndatasource.retrieve.async",execute:(r,n)=>B((function*(){var{getState:a,dispatch:i}=r,o=n.TraceManager.getTracer(b.MDL_COMPONENT_NAMES.ModernDataSource);o.info("".concat(ye()," Retrieve is executing")),yield i(Object(u.retrieveEntity)(e.etn,!0));var s=yield i(Object(l.fromODataContract)(Object(h.buildRetrieveContract)(a(),e,t))),c=yield Z(s,a,o,C.RetrievalStrategy.Default,n),d=yield he(c,o);return yield i(Object(m.createEntityRecordFromResponseAsync)(d,e.etn,t,void 0,void 0,void 0,o))}))()}}function Y(e,t){return{type:"moderndatasource.retrieve.records.async",execute:(r,n)=>B((function*(){var{getState:a,dispatch:i}=r,o=n.TraceManager.getTracer(b.MDL_COMPONENT_NAMES.ModernDataSource);if(o.info("".concat(ye()," Retrieve records is executing")),!e||0===e.length)throw new v.ErrorStatus("Invalid identifiers");yield i(Object(u.retrieveEntity)(e[0].etn,!0));var s=[];for(var c of e){var l=Object(h.buildRetrieveContract)(a(),c,t);s.push(l)}for(var d=yield i(Object(S.executeMultiple)(s)),p=[],f=0;f<d.length;f++){var y=yield he(d[f],o),g=yield i(Object(m.createEntityRecordFromResponseAsync)(y,e[f].etn,t,void 0,void 0,void 0,o));p.push(g)}return p}))()}}function K(e,t,r){return J.apply(this,arguments)}function J(){return(J=B((function*(e,t,r){var n={TraceManager:r.TraceManager,EventManager:r.EventManager,SqlExecutor:{},ApplicationState:{}},a=fe(e);null==t||t.info("".concat(ye()," Execute the request in Modern Data Layer Component"));var i=new o.ODataExecutor({},n);return yield i.execute(a)}))).apply(this,arguments)}function Z(e,t,r){return $.apply(this,arguments)}function $(){return($=B((function*(e,t,r){var n,i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:C.RetrievalStrategy.Default,s=arguments.length>4?arguments[4]:void 0,u=arguments.length>5&&void 0!==arguments[5]&&arguments[5],c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:[],d=arguments.length>7&&void 0!==arguments[7]&&arguments[7],p=performance.now(),f=null===(n=(i=s.EventManager).getScenarioTracker)||void 0===n?void 0:n.call(i,a.ScenarioType.Load,"Storage:ModernDataLayer");ee(t(),e,o,u,s);var h=Object(M.isFeatureEnabledByFCBName)(t(),F.ModernDataLayerDev);if(h&&e.expressionRuntimeSupportedRequest){var m=[];ce(e,m);var y=void 0;if(y)return se(t,y,e,o,p,s,r,!0,f,m);r.warn("".concat(ye()," No Data Component handled this request - Response is Null"),m)}var v=e;(d=d||ae(e)||ne(t,e))&&(c.push({name:"isConvertToBatchRequestNeeded",value:d}),v=Object(l.convertToBatchRequest)(s,e)),ce(e,c);var g=yield K(v,r,s);return d&&(g=yield ie(g,r,c)),se(t,g,e,o,p,s,r,!1,f,c)}))).apply(this,arguments)}function ee(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:C.RetrievalStrategy.Default,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4?arguments[4]:void 0;try{var o;if(t.additionalHeaders||(t.additionalHeaders={}),e&&e.serverStatus)switch(r){case C.RetrievalStrategy.Local:if(!a&&!re(e,t)){var s=te(e);throw N.LegacyErrorStatus.fromErrorCodeAndMessage(_.CrmErrorCodes.DataSourceOfflineErrorCode,"Can't execute 'Offline' request as ".concat(s))}o=c.EXECUTION_HINTS.OFFLINE;break;case C.RetrievalStrategy.Remote:if(!a&&!Object(R.isServerAvailableInternal)(e))throw N.LegacyErrorStatus.FromMessage("Can't execute 'Online' request as server is NOT available");o=c.EXECUTION_HINTS.ONLINE;break;case C.RetrievalStrategy.Default:if(t.additionalHeaders[c.HEADER.EXECUTION_HINT])return;if(Object(P.isOfflineByDefaultEnabledForApp)(e)&&Object(R.isServerAvailableInternal)(e)&&re(e,t)){t.additionalHeaders.clientType=n.CLIENT_TYPE.local;var u={[I.IS_OFFLINE_BY_DEFAULT_REQUEST]:!0};t.additionalParameters=t.additionalParameters?k(k({},t.additionalParameters),u):u,o=c.EXECUTION_HINTS.OFFLINE}else if(Object(R.isServerAvailableInternal)(e))o=c.EXECUTION_HINTS.ONLINE;else{if(!re(e,t)){var l=te(e);throw N.LegacyErrorStatus.fromErrorCodeAndMessage(_.CrmErrorCodes.DataSourceOfflineErrorCode,"Can't execute 'Default' request as the server is NOT available and ".concat(l))}o=c.EXECUTION_HINTS.OFFLINE}break;default:throw N.LegacyErrorStatus.FromMessage("Currently MDL does not support the strategy: "+r)}else o=r===C.RetrievalStrategy.Local?c.EXECUTION_HINTS.OFFLINE:c.EXECUTION_HINTS.ONLINE;t.additionalHeaders[c.HEADER.EXECUTION_HINT]=o}catch(f){var d=[];ce(t,d);var p=v.ErrorStatus.toLegacyErrorStatus(Object(v.convertToErrorStatus)(f));throw Object(A._reportMDSFailure)(i,d,p,e,b.MDL_COMPONENT_NAMES.ModernDataSource),f}}function te(e){return Object(D.getIsOfflineEnabled)(e)?Object(D.isOfflineAvailableForUse)(e)?"related entity is not enabled for offline":"offline is not yet available":"the app is not offline enabled"}function re(e,t){return Object(D.getIsOfflineEnabled)(e)&&Object(D.isOfflineAvailableForUse)(e)&&Object(l.isSerializedRequestSupportedOffline)(e,t)}function ne(e,t){return Object(M.isFeatureEnabledByFCBName)(e(),F.BatchRequestForLongFetchXml)&&"GET"===t.method&&"remote"===Object(w.getClientType)(fe(t))&&t.additionalParameters&&t.additionalParameters[j.OPERATION.TYPE]===j.OPERATION_TYPE.RETRIEVE_MULTIPLE&&Object(L.getClientHost)(e())===x.ClientHost.MobileApplication&&Object(T.encodeURIComponentForOData)(t.urlParameters).length>1500}function ae(e){return"GET"===e.method&&Object(T.encodeURIComponentForOData)(e.urlParameters).length>16300}function ie(e,t,r){return oe.apply(this,arguments)}function oe(){return(oe=B((function*(e,t,r){var n=yield Object(p.parseBatchResponse)(e);return n&&n.length>0?n[0]:(t.warn("".concat(ye()," Invalid response list returned from parseBatchResponse"),r),e)}))).apply(this,arguments)}function se(e,t,r){return ue.apply(this,arguments)}function ue(){return(ue=B((function*(e,t,r){arguments.length>3&&void 0!==arguments[3]||C.RetrievalStrategy.Default;var n=arguments.length>4?arguments[4]:void 0,i=arguments.length>5?arguments[5]:void 0,o=arguments.length>6?arguments[6]:void 0,s=arguments.length>7?arguments[7]:void 0,u=arguments.length>8?arguments[8]:void 0,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:[],d=performance.now()-n;if(c.push({name:a.EVENT_PARAMETERS.RESPONSE_TIME,value:d}),le(t,c,s,"$batch"===r.urlParameters),t.ok)return null==u||u.complete(c),i.EventManager.ReportComponentSuccess("Storage:ModernDataLayer",c),t;if(401!==t.status){if(t.url&&-1!==t.url.indexOf("$batch")||r&&r.urlParameters&&-1!==r.urlParameters.indexOf("$batch")){var f=yield Object(p.parseBatchResponse)(t);if(f.length>0){var h=f.find(e=>!e.ok);if(h)return de(h,i,c,o,u)}return o&&o.error("Batch response parsing has failed",c),de(t,i,c,o,u)}return null==o||o.error("".concat(ye()," Modern Data Layer component returns Error Response - Convert error to CRM Error."),c),de(t,i,c,o,u)}null==o||o.error("".concat(ye()," Modern Data Layer : 401 response from server."),c);var m=i.DataLayerConfiguration.RemoteRetryHandler;try{return m?(yield m.handleAuthError(r),null==o||o.error("".concat(ye()," Modern Data Layer : 401 response from server, handleAuthError() was successful, retrying the request."),c),yield Object(l.addAuthHeader)(e,r),K(r,e,i)):de(t,i,c,o,u)}catch(y){throw o&&o.error("".concat(ye()," Error in 401 error handling"),c),y}}))).apply(this,arguments)}function ce(e,t){t.push({name:a.EVENT_PARAMETERS.CLIENT_REQUEST_ID,value:ve(e)}),t.push({name:a.EVENT_PARAMETERS.CLIENT_TYPE,value:"remote"});var r=Object(i.getRequestType)(fe(e));t.push({name:a.EVENT_PARAMETERS.OPERATION_TYPE,value:r})}function le(e,t,r){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=e.headers?Object(O.getHttpHeader)(e.headers,c.HEADER.SERVER_REQUEST_ID):n.UNKNOWN,s=e.status?e.status:null,u=e.type?e.type:null,l=e.statusText?e.statusText:n.UNKNOWN,d=e.url?Object(y.trimUrl)(e.url):n.UNKNOWN,p=e.headers?Object(O.getHttpHeader)(e.headers,c.HEADER.CONTENT_LENGTH):n.UNKNOWN;Object(y.canLogDetailsOfRequest)(e.url)&&t.push({name:a.EVENT_PARAMETERS.RESPONSE_URL,value:d}),t.push({name:a.EVENT_PARAMETERS.HTTP_STATUS_CODE,value:s}),t.push({name:a.EVENT_PARAMETERS.HTTP_RESPONSE_TYPE,value:u}),t.push({name:a.EVENT_PARAMETERS.HTTP_RESPONSE_STATUS_TEXT,value:l}),t.push({name:a.EVENT_PARAMETERS.SERVER_REQUEST_ID,value:o||n.UNKNOWN}),t.push({name:a.EVENT_PARAMETERS.RESPONSE_SIZE_IN_BYTES,value:p||n.UNKNOWN}),t.push({name:H.IS_BATCH_REQUEST,value:i}),t.push({name:H.IS_EXPRESSION_RUNTIME_REQUEST,value:r})}function de(e,t,r,n,a){return pe.apply(this,arguments)}function pe(){return(pe=B((function*(e,t,r,a,i){var o;try{var s=yield e.text();o=Object(d.deserializeErrorResponse)(s,e,r,a),Object(y.canLogDetailsOfRequest)(e.url)&&(r.push({name:"Odata-Error-Response-Complete-text",value:s}),r.push({name:"Crm-Error-Response-From-OdataResponse",value:JSON.stringify(o)}));var u=o.message||"Request Failure";r.push({name:H.CRM_ERROR_CODE,value:o.errorCode}),o.stack&&r.push({name:H.CRM_CALL_STACK,value:o.stack}),r.push({name:H.CRM_ERROR_MESSAGE,value:u});var c=e?e.status:null;if([400,404,500,503].indexOf(c)>-1&&!Object(E.isNonReportableErrorCode)(o.errorCode)){var l=new v.ErrorStatus(u,o.errorCode,void 0,null,null,null,null,r,null,null,null,!1,-1,null,c,o.clientRequestId,o.serverResponseId);null==i||i.failure(r),t.EventManager.ReportComponentFailure("Storage:ModernDataLayer",l,void 0,r)}else null==a||a.error(u,r)}catch(l){null==a||a.error("".concat(ye()," Modern Data Layer component : Exception occurred while creating error response."),r);var p=E.ErrorCodes.unknownInternalServerError;throw new v.ErrorStatus(n.UNKNOWN,p)}throw o}))).apply(this,arguments)}function fe(e){return{url:e.urlParameters,method:e.method,additionalHeaders:e.additionalHeaders,body:e.body}}function he(e,t,r){return me.apply(this,arguments)}function me(){return(me=B((function*(e,t,r){if(null==r||r.AppendCallStack("WebAPIService.parseJsonResponse"),e){var n=Object(O.getHttpHeader)(e.headers,c.HEADER.CONTENT_TYPE);return n&&n.indexOf("text/html")>-1?(null==r||r.AppendCallStack("WebAPIService.response.text"),e.text().then(r=>{throw Object(d.deserializeErrorResponse)(r,e,[],t)})):(null==r||r.AppendCallStack("WebAPIService.response.json"),e.json())}throw new v.ErrorStatus("Null response from server")}))).apply(this,arguments)}function ye(e){return"[".concat(e||b.PREFIX.ModernDataSource,"]")}function ve(e){var t;return(null==e||null===(t=e.additionalHeaders)||void 0===t?void 0:t[c.HEADER.CLIENT_REQUEST_ID])||n.UNKNOWN}},9088:function(e,t,r){"use strict";r.r(t),r.d(t,"ODataExecutor",(function(){return d}));var n=r(9045),a=r(9058),i=r(9050),o=r(9089),s=r(9047),u=r(9061),c=r(9090);function l(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}class d{constructor(e,t){this._oDataClientManager=void 0,this._applicationContext=void 0,this._applicationContext=t,this._oDataClientManager=new c.ODataClientManager(e||{},this._applicationContext)}execute(e,t){var r,c=this;return(r=function*(){var r=new o.PerformanceControl;r.startMarker(s.FILE_PREFIX.ODataExecutor);var l=c._applicationContext.TraceManager.getTracer(s.COMPONENT_NAMES.ODataExecutor),d=[];Object(a.addRequestDetailsToEventParameters)(e,d);try{var p,f=c._oDataClientManager.getODataClient(e),h=Object(u.getRequestType)(e,c._applicationContext),m={requestType:h,commonEventParameters:d,performanceControl:r,clientRequestId:Object(i.getClientRequestId)(e)||""},y=yield f.execute(e,m);r.startMarker(s.FILE_PREFIX.CloneRequest);var v=y.clone();if(r.endMarker(s.FILE_PREFIX.CloneRequest),r.endMarker(s.FILE_PREFIX.ODataExecutor),y.ok){var g;Object(a.addResponseDetailsToEventParameters)(v,d);var O=Object(i.getClientType)(e,l,d),E=[s.FILE_PREFIX.ODataExecutor,s.FILE_PREFIX.ResponseHandler,s.FILE_PREFIX.CloneRequest];O===n.CLIENT_TYPE.local?E=E.concat([s.FILE_PREFIX.SQLGenerator,s.FILE_PREFIX.MetadataSQLExecutor,s.FILE_PREFIX.DataSQLExecutor]):E.push(s.FILE_PREFIX.FetchRequest);var b=Object(a.retrieveExecutionTimeDetails)(r,E);!Object(i.isNullOrUndefinedOrEmpty)(b)&&t&&(t.eventParameters=Object(a.addEventParameters)(t.eventParameters,b)),null!==(g=c._applicationContext.AdditionalParameters)&&void 0!==g&&g.EnabledODataExecutorTrace&&c._applicationContext.EventManager.ReportComponentSuccess(s.COMPONENT_NAMES.ODataExecutor,Object(a.addEventParameters)(d,b))}else if(null!==(p=c._applicationContext.AdditionalParameters)&&void 0!==p&&p.EnabledODataExecutorTrace){d=yield Object(a.addResponseErrorInformationToEventParameters)(v,d,h);var T=y.status;if(l.warn("[".concat(s.FILE_PREFIX.ODataExecutor,"] Request returns Error Response with status code: ").concat(T),d),n.UNEXPECTED_STATUS_CODE.includes(T)){for(var S="Request Failed",C=0;C<d.length;C++)if(d[C].name===s.EVENT_PARAMETERS.ERROR_MESSAGE&&d[C].value!==s.EVENT_PARAMETERS.EMPTY_STRING){S=d[C].value;break}l.warn("[".concat(s.FILE_PREFIX.ODataExecutor,"] ").concat(S),d)}}return y}catch(R){var N,_=R&&R.message?R.message:"OData Request Failed";return R&&(R.message=_),null!==(N=c._applicationContext.AdditionalParameters)&&void 0!==N&&N.EnabledODataExecutorTrace&&(Object(a.addErrorInformationToEventParameters)(R,d),l.error("[".concat(s.FILE_PREFIX.ODataExecutor,"] ").concat(_),d)),Object(i.buildODataResponseFromError)(R,e.url)}},function(){var e=this,t=arguments;return new Promise((function(n,a){var i=r.apply(e,t);function o(e){l(i,n,a,o,s,"next",e)}function s(e){l(i,n,a,o,s,"throw",e)}o(void 0)}))})()}}},9089:function(e,t,r){"use strict";r.r(t),r.d(t,"PerformanceControl",(function(){return n}));class n{constructor(){this._startMarker=void 0,this._perfMeasure=void 0,this._perfStatistic=void 0,this._startMarker=new Map,this._perfMeasure=new Map,this._perfStatistic=new Map}startMarker(e){this._startMarker.set(e,this.getTimeNow())}endMarker(e){var t=this.getTimeNow(),r=0;try{this._startMarker.has(e)&&(r=this._startMarker.get(e)||r);var n=t-r,a={name:e,startTime:r,endTime:t,duration:n};this.updatedStatistic(e,n),this._perfMeasure.set(e,a)}catch(i){return}}getTimeNow(){return performance.now()}getPerformanceEntry(e){try{if(this._perfMeasure.has(e)&&this._perfStatistic.has(e)){var t=this._perfMeasure.get(e),r=this._perfStatistic.get(e);if(t&&r)return{name:e,performanceMeasure:t,performanceStatistic:r}}}catch(n){return null}return null}updatedStatistic(e,t){var r=t,n=1,a=t,i={};try{if(this._perfStatistic.has(e)){var o=this._perfStatistic.get(e);n=o?o.count+n:n,a=(r=o?o.totalDuration+t:t)/n}i={name:e,count:n,totalDuration:r,averageDuration:a},this._perfStatistic.set(e,i)}catch(s){return}}}},9090:function(e,t,r){"use strict";r.r(t),r.d(t,"ODataClientManager",(function(){return c}));var n=r(9045),a=r(9058),i=r(9050),o=r(9047),s=r(9091),u=r(9175);class c{constructor(e,t){this._remoteODataClient=void 0,this._localODataClient=void 0,this._applicationContext=void 0,this._remoteODataClient=new u.RemoteODataClientManager(e,t),this._localODataClient=new s.LocalODataClientManager(e,t),this._applicationContext=t}getODataClient(e){var t=this._applicationContext.TraceManager.getTracer(o.COMPONENT_NAMES.ODataExecutor),r=[];return Object(a.addRequestDetailsToEventParameters)(e,r),Object(i.getClientType)(e,t,r)===n.CLIENT_TYPE.local?this._localODataClient.getLocalODataClient(e,r):this._remoteODataClient.getRemoteODataClient(e)}getODataClientManagerPrefix(e){return"[".concat(e||o.FILE_PREFIX.ODataClientManager,"]")}}},9091:function(e,t,r){"use strict";r.r(t),r.d(t,"LocalODataClientManager",(function(){return u}));var n=r(9045),a=r(9047),i=r(9061),o=r(9092),s=r(9174);class u{constructor(e,t){this._sqlLocalODataClient=void 0,this._fileLocalODataClient=void 0,this._applicationContext=void 0,this._applicationContext=t,this._sqlLocalODataClient=new s.SQLLocalODataClient(e,t),this._fileLocalODataClient=new o.FileLocalODataClient(e,t)}getLocalODataClient(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=this._applicationContext.TraceManager.getTracer(a.COMPONENT_NAMES.ODataExecutor);if(t=Object(i.getRequestType)(e,this._applicationContext),o.info("".concat(c()," URL Parser Handler returns ").concat(t," request type")),n.SQLQuerySupportedList.indexOf(t)>-1)return o.info("".concat(c()," Local OData Client Manager called SQL Local Client")),this._sqlLocalODataClient;if(n.FileQuerySupportedList.indexOf(t)>-1)return o.info("".concat(c()," Local OData Client Manager called File Local Client")),this._fileLocalODataClient;var s="No LocalODataClient type matched with request";throw o.error("".concat(c()," ").concat(s),r),new Error(s)}}function c(e){return"[".concat(e||a.FILE_PREFIX.LocalODataClientManager,"]")}},9092:function(e,t,r){"use strict";r.r(t),r.d(t,"FileLocalODataClient",(function(){return i}));var n=r(9093),a=r(9102);class i extends n.ODataClient{constructor(e,t){super(e,t),this.setExecuteRequestInterceptor(new a.FileRequestInterceptor(this.applicationContext)).build()}}},9093:function(e,t,r){"use strict";r.r(t),r.d(t,"ODataClient",(function(){return l}));var n=r(9094),a=r(9095),i=r(9096),o=r(9097),s=r(9098),u=r(9100),c=r(9101);class l{constructor(e,t){this.applicationContext=void 0,this.interceptors=void 0,this.executeRequestInterceptor=void 0,this._retryCount=void 0,this._promiseCache=void 0,this._policyManager=void 0,this._timeout=void 0,this._customizedInterceptors=void 0,this.applicationContext=t,this._timeout=e&&e.timeout||3e5,this._policyManager=e&&e.PolicyManager||this.getDefaultPolicyManager(this.applicationContext),this._retryCount=e&&e.RetryCount||3,this._promiseCache=new i.PromiseCache(this.applicationContext),this._customizedInterceptors=[],this.interceptors=[]}getDefaultPolicyManager(e){var t=new a.PolicyManager(e);return t.addRetryPolicy(Object(n.getConnectivityRetryPolicy)()),t}build(){return this.applicationContext&&this.applicationContext.AdditionalParameters&&this.applicationContext.AdditionalParameters.SingletonExecutor||(this.interceptors.push(new u.PromiseCacheInterceptor(this._promiseCache,this.applicationContext)),this.interceptors.push(new c.TimeoutInterceptor(this._timeout,this.applicationContext)),this.interceptors=this.interceptors.concat(this._customizedInterceptors),this.interceptors.push(new s.PolicyRetryInterceptor(this._policyManager,this._retryCount,this.applicationContext))),this.interceptors.push(this.executeRequestInterceptor),this}describe(){var e=[];return this.interceptors.forEach(t=>{e.push(t.constructor.name)}),e}setExecuteRequestInterceptor(e){return this.executeRequestInterceptor=e,this}addInterceptor(e){return this._customizedInterceptors.push(e),this}execute(e,t){return new o.Chain(this.applicationContext,this.interceptors,e,0,t).proceed()}}},9094:function(e,t,r){"use strict";r.r(t),r.d(t,"getConnectivityRetryPolicy",(function(){return a}));var n=r(9050);function a(){return{name:"ConnectivityRetry",condition:(e,t)=>function(e,t){return"GET"===e.method&&"remote"===Object(n.getClientType)(e)&&0===t.status}(e,t),retryCount:1}}},9095:function(e,t,r){"use strict";r.r(t),r.d(t,"PolicyManager",(function(){return i}));var n=r(9047);function a(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}class i{constructor(e,t){this._tracer=void 0,this._policyByName={},t&&this.addRetryPolicies(t),this._tracer=e.TraceManager.getTracer(n.COMPONENT_NAMES.ODataExecutor)}addRetryPolicy(e){e.name in this._policyByName&&this._tracer.warn("".concat(o()," Same retry policy name: ").concat(e.name," is provided again. Ignore adding this repeated policy name to retry policy list.")),e.action||(e.action=function(){var e,t=(e=function*(e){return e},function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function s(e){a(o,n,i,s,u,"next",e)}function u(e){a(o,n,i,s,u,"throw",e)}s(void 0)}))});return function(e){return t.apply(this,arguments)}}()),this._policyByName[e.name]=e}addRetryPolicies(e){e&&e.length>0&&e.forEach(e=>{this.addRetryPolicy(e)})}getRetryPolicy(e,t){for(var r in this._policyByName)if(Object.prototype.hasOwnProperty.call(this._policyByName,r)){var n=this._policyByName[r];if(n.condition(e,t))return this._tracer.info("".concat(o()," Fit Policy ").concat(n.name)),n}return null}}function o(e){return"[".concat(e||n.FILE_PREFIX.PolicyManager,"]")}},9096:function(e,t,r){"use strict";r.r(t),r.d(t,"PromiseCache",(function(){return a}));var n=r(9047);class a{constructor(e){this._promiseCache=void 0,this._tracer=void 0,this._promiseCache={},this._tracer=e.TraceManager.getTracer(n.COMPONENT_NAMES.ODataExecutor)}contains(e){return this._promiseCache[e]?(this._tracer.info("".concat(i()," Promise in cache")),!0):(this._tracer.info("".concat(i()," Promise not in cache")),!1)}get(e){return this._tracer.info("".concat(i()," --- Get Promise Key")),this._promiseCache[e]}put(e,t){this._tracer.info("".concat(i()," --- Put Promise key")),this._promiseCache[e]=t}remove(e){this._tracer.info("".concat(i()," --- Remove Promise key")),delete this._promiseCache[e]}}function i(e){return"[".concat(e||n.FILE_PREFIX.PromiseCache,"]")}},9097:function(e,t,r){"use strict";function n(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}r.r(t),r.d(t,"Chain",(function(){return a}));class a{constructor(e,t,r,n,a){this.request=void 0,this.executionContext=void 0,this._call=void 0,this._index=void 0,this._interceptors=void 0,this._applicationContext=void 0,this._applicationContext=e,this._interceptors=t,this._index=n||0,this._call=0,this.request=r,this.executionContext=a||{}}proceed(e){var t,r=this;return(t=function*(){if(r._index<r._interceptors.length){e||(e=r.request),r._call+=1;var t=new a(r._applicationContext,r._interceptors,e,r._index+1,r.executionContext),n=r._interceptors[r._index],i=yield n.intercept(t);return 1!==t._call&&r._index+1!==r._interceptors.length?Promise.reject(new Error("interceptor "+n.constructor.name+" must call proceed() at least once")):i}return Promise.reject(new Error("Interceptor out of range"))},function(){var e=this,r=arguments;return new Promise((function(a,i){var o=t.apply(e,r);function s(e){n(o,a,i,s,u,"next",e)}function u(e){n(o,a,i,s,u,"throw",e)}s(void 0)}))})()}clone(e){return new a(this._applicationContext,this._interceptors,e||this.request,this._index,this.executionContext)}terminate(){this._call+=1}}},9098:function(e,t,r){"use strict";r.r(t),r.d(t,"PolicyRetryInterceptor",(function(){return u}));var n=r(9050),a=r(9047),i=r(9099);function o(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function s(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function s(e){o(i,n,a,s,u,"next",e)}function u(e){o(i,n,a,s,u,"throw",e)}s(void 0)}))}}class u extends i.Interceptor{constructor(e,t,r){super(r),this._retryCount=void 0,this._policyManager=void 0,this._retryCount=t,this._policyManager=e}intercept(e){var t=this;return s((function*(){return yield t.executeWithPolicy(e)}))()}executeWithPolicy(e){var t=this;return s((function*(){for(var r=e,a=0,i=0,o={},s=t._retryCount,u=e.executionContext?e.executionContext.commonEventParameters:[];;){yield t.timeout(i);var c=r.request;try{var l=yield r.proceed(),d=t._policyManager.getRetryPolicy(c,l);if(null===d)return l;var p=d.name;if(p&&p in o?s=o[d.name]:(o[p]=d.retryCount,s=d.retryCount),!(a<t._retryCount&&s>0))return t.tracer.warn("".concat(t.getPolicyRetryInterceptorPrefix()," Retry the request for ").concat(a," time(s). Failed to retry with policy ").concat(p,"."),u),l;var f=d.action?yield d.action(c):c;r=e.clone(f),a++,o[p]=o[p]-1,i=d.delay||0,t.tracer.warn("".concat(t.getPolicyRetryInterceptorPrefix()," Retry the request with retry policy: ").concat(p," and current retry count is: ").concat(a,"."),u)}catch(m){var h="Retry with count "+a+" failed";return m.message=m&&m.message?"".concat(m.message,".").concat(h):h,t.tracer.warn("".concat(t.getPolicyRetryInterceptorPrefix()," ").concat(h),u),Object(n.buildODataResponseFromError)(m,c.url)}}}))()}getPolicyRetryInterceptorPrefix(e){return"[".concat(e||a.FILE_PREFIX.PolicyRetryInterceptor,"]")}timeout(e){return s((function*(){return new Promise(t=>{setTimeout(()=>{t()},e)})}))()}}},9099:function(e,t,r){"use strict";r.r(t),r.d(t,"Interceptor",(function(){return a}));var n=r(9047);class a{constructor(e){this.tracer=void 0,this.applicationContext=void 0,this.applicationContext=e,this.tracer=e.TraceManager.getTracer(n.COMPONENT_NAMES.ODataExecutor)}}},9100:function(e,t,r){"use strict";r.r(t),r.d(t,"PromiseCacheInterceptor",(function(){return i}));var n=r(9099);function a(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}class i extends n.Interceptor{constructor(e,t){super(t),this._promiseCache=void 0,this._promiseCache=e}intercept(e){var t,r=this;return(t=function*(){var t=e.request;if(r._promiseCache.contains(t.url))return e.terminate(),r._promiseCache.get(t.url);var n=e.proceed();return r._promiseCache.put(t.url,n),n.then(()=>{r._promiseCache.remove(t.url)},()=>{r._promiseCache.remove(t.url)}),n},function(){var e=this,r=arguments;return new Promise((function(n,i){var o=t.apply(e,r);function s(e){a(o,n,i,s,u,"next",e)}function u(e){a(o,n,i,s,u,"throw",e)}s(void 0)}))})()}}},9101:function(e,t,r){"use strict";r.r(t),r.d(t,"TimeoutInterceptor",(function(){return s}));var n=r(9073),a=r(9047),i=r(9074),o=r(9099);class s extends o.Interceptor{constructor(e,t){super(t),this._t=void 0,this._timeoutBuffer=void 0,this._timeout=void 0,this._eventParameters=void 0,this._t=e,this._timeout=0,this._eventParameters=[],this._timeoutBuffer=5e3}intercept(e){this._eventParameters=e.executionContext?e.executionContext.commonEventParameters:this._eventParameters;var t=Promise.race([this.timeOut(),e.proceed()]);return t.then(()=>{clearTimeout(this._timeout)},()=>{clearTimeout(this._timeout)}),t}timeOut(){return new Promise((e,t)=>{this.tracer.info("".concat(this.getTimeoutInterceptorPrefix()," Set time out with time ").concat(this._t));var r=Date.now();this._timeout=window.setTimeout(()=>{var e=Date.now();Object(i.isFeatureEnabled)(this.applicationContext,n.RetryMdlCacheTimeout)&&e-r>this._t+this._timeoutBuffer?(this.tracer.warn("".concat(this.getTimeoutInterceptorPrefix()," Retrying timeout to see if request can be completed"),this._eventParameters),clearTimeout(this._timeout),this._timeout=window.setTimeout(()=>{this._logErrorAndRejectPromise(t)},this._t)):this._logErrorAndRejectPromise(t)},this._t)})}_logErrorAndRejectPromise(e){this.tracer.error("".concat(this.getTimeoutInterceptorPrefix()," Timeout with time ").concat(this._t),this._eventParameters),e(new Error("request failed with timeout"))}getTimeoutInterceptorPrefix(e){return"[".concat(e||a.FILE_PREFIX.TimeoutInterceptor,"]")}setExtraTimeout(e){this._timeoutBuffer=e}}},9102:function(e,t,r){"use strict";r.r(t),r.d(t,"FileRequestInterceptor",(function(){return l}));var n=r(9045),a=r(9047),i=r(9061),o=r(9099),s=r(9103),u=r(9104);function c(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}class l extends o.Interceptor{intercept(e){var t,r=this;return(t=function*(){var t,o=e.executionContext||{},c=e.request,l=o.requestType||Object(i.getRequestType)(c,r.applicationContext),p=r.applicationContext.TraceManager.getTracer(a.COMPONENT_NAMES.FileExecutor),f=o.commonEventParameters||[];p.info("".concat(d()," File Executor is processing"));try{switch(l){case n.OPERATION.Upload:yield Object(s.ExecuteFileUploadRequest)(c,r.applicationContext,o);break;case n.OPERATION.FileDelete:yield Object(s.ExecuteFileDeleteRequest)(c,r.applicationContext,o);break;default:throw new Error("Request type is not supported")}}catch(m){var h={name:m.name?m.name:"File Executor",message:m.message?m.message:JSON.stringify(m)};return t=yield Object(u.responseHandler)(c,l,r.applicationContext,void 0,h,void 0,o),p.error("".concat(d()," File Local OData Client return back error response \n status code: ").concat(t.status,"\n error message: ").concat(t.statusText),f),t}return p.info("".concat(d()," Response Handler is processing")),t=yield Object(u.responseHandler)(c,l,r.applicationContext,void 0,void 0,void 0,o),p.info("".concat(d()," File Local OData Client return back response\n status code: ").concat(t.status,"\n url: ").concat(t.url)),t},function(){var e=this,r=arguments;return new Promise((function(n,a){var i=t.apply(e,r);function o(e){c(i,n,a,o,s,"next",e)}function s(e){c(i,n,a,o,s,"throw",e)}o(void 0)}))})()}}function d(e){return"[".concat(e||a.FILE_PREFIX.FileRequestInterceptor,"]")}},9103:function(e,t,r){"use strict";r.r(t),r.d(t,"FILE_NAME_URL_PARAM",(function(){return d})),r.d(t,"ExecuteFileUploadRequest",(function(){return p})),r.d(t,"ExecuteFileDeleteRequest",(function(){return h}));var n=r(9056),a=r(9047),i=r(9050),o=r(9054),s=r(9045),u=r(9048);function c(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function l(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){c(i,n,a,o,s,"next",e)}function s(e){c(i,n,a,o,s,"throw",e)}o(void 0)}))}}var d="x-ms-file-name=";function p(e,t){return f.apply(this,arguments)}function f(){return(f=l((function*(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},c=t.TraceManager.getTracer(a.COMPONENT_NAMES.FileExecutor);c.info("".concat(y()," ExecuteFileUploadRequest - File Executor Started"));var l=r.commonEventParameters||[];if(!e.url)throw c.error("".concat(y()," url is invalid"),l),new Error("Empty url is not valid");if(!e.additionalHeaders)throw c.error("".concat(y()," additionalHeaders is invalid"),l),new Error("additionalHeaders not valid");var p=e.url.split("/"),f=p[p.length-1].split("(")[0],h=f.split("?")[0],m=e.url.indexOf(d),v=e.url.substring(m+d.length),g=p[p.length-2],O=g.split("(")[0],E=yield Object(o.getEntityLogicalName)(t,O,l),b=g.substring(g.lastIndexOf("(")+1,g.lastIndexOf(")")),T=e.additionalHeaders[s.HINT.MIME_TYPE],S=+e.additionalHeaders[s.HINT.FILE_SIZE],C=e.additionalHeaders[s.HINT.FILE_URL];try{var N=yield Object(o.getAttributeTypes)(t,[h],E);if(l.push({name:"EntityName",value:E}),l.push({name:"EntityId",value:b}),l.push({name:"FileSize",value:S}),l.push({name:"AttributeName",value:h}),!N||!N[h]||N[h]!==u.AttributeType.File&&N[h]!==u.AttributeType.Image){var _=N&&N[h]?N[h]:"Unknown",R=N&&N[h]?"Attribute type is not valid for file or image upload":"Attribute metadata not found for given attribute type";l.push({name:"MetadataType",value:_});var P=new n.LocalError(R);throw c.error(R,l),P}var I=N[h];if(I===u.AttributeType.File){var A,D={entityId:b,entityLogicalName:E,entityFieldName:h,canMove:!0,fileUrl:{filename:v,resourceUrl:C,mimeType:T,size:S}},M=JSON.stringify(D);yield null===(A=t.SqlExecutor)||void 0===A?void 0:A.attachFileToEntity(M)}else{var F=yield Object(o.getAttributesMetadata)(t,E,[h],l);if(!F){var w="Unable to get attribute metadata descriptor that associated to entity: ".concat(E);return c.warn("".concat(y()," ").concat(w),l),Promise.reject(w)}var L,j=F[h].AttributeOf,x={entityId:b,entityLogicalName:E,entityFieldName:j,canMove:!0,fileUrl:{filename:v,resourceUrl:C,mimeType:T,size:S},imageMetadata:{}},U=JSON.stringify(x);yield null===(L=t.SqlExecutor)||void 0===L?void 0:L.attachImageToEntity(U)}}catch(q){var k=Object(i.convertErrorToLocalError)(q);throw c.error("Offline File upload failed",l),k}}))).apply(this,arguments)}function h(e,t){return m.apply(this,arguments)}function m(){return(m=l((function*(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=t.TraceManager.getTracer(a.COMPONENT_NAMES.FileExecutor);s.info("".concat(y()," ExecuteFileDeleteRequest - File Executor Started"));var c=r.commonEventParameters||[];if(!e.url)throw s.error("".concat(y()," url is invalid"),c),new Error("Empty url is not valid");var l=e.url.split("/"),d=l[l.length-1],p=l[l.length-2],f=p.split("(")[0],h=yield Object(o.getEntityLogicalName)(t,f,c),m=p.substring(p.lastIndexOf("(")+1,p.lastIndexOf(")"));try{var v=yield Object(o.getAttributeTypes)(t,[d],h);if(c.push({name:"EntityName",value:h}),c.push({name:"EntityId",value:m}),c.push({name:"AttributeName",value:d}),!v||!v[d]||v[d]!==u.AttributeType.File&&v[d]!==u.AttributeType.Image){var g=v&&v[d]?v[d]:"Unknown",O=v&&v[d]?"Attribute type is not valid for file or image upload":"Attribute metadata not found for given attribute type";c.push({name:"MetadataType",value:g});var E=new n.LocalError(O);throw s.error("".concat(y()," ").concat(O),c),E}var b=v[d],T=b===u.AttributeType.File?"File":"Image",S=yield Object(o.getAttributesMetadata)(t,h,[d],c);if(!S||!S[d]){var C="Unable to get attribute metadata descriptor that associated to entity: ".concat(h);return s.warn("".concat(y()," ").concat(C),c),Promise.reject(C)}var N,_=S[d].AttributeOf,R={entityId:m,entityLogicalName:h,entityFieldName:b===u.AttributeType.File?d:_,attachmentType:T},P=JSON.stringify(R);yield null===(N=t.SqlExecutor)||void 0===N?void 0:N.deleteAttachment(P)}catch(A){var I=Object(i.convertErrorToLocalError)(A);throw s.error("Offline File delete failed",c),I}}))).apply(this,arguments)}function y(e){return"[".concat(e||a.FILE_PREFIX.FileExecutor,"]")}},9104:function(e,t,r){"use strict";r.r(t),r.d(t,"responseHandler",(function(){return y})),r.d(t,"generateEmptyResponse",(function(){return g}));var n=r(9045),a=r(9047),i=r(9105),o=r(9167),s=r(9168),u=r(9169),c=r(9053),l=r(9170),d=r(9108),p=r(9172),f=r(9173);function h(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function m(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){h(i,n,a,o,s,"next",e)}function s(e){h(i,n,a,o,s,"throw",e)}o(void 0)}))}}function y(e,t,r,n,a,i){return v.apply(this,arguments)}function v(){return(v=m((function*(e,t,r,h,m,y){var v,g=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{};g.performanceControl&&g.performanceControl.startMarker(a.FILE_PREFIX.ResponseHandler);var O=r.TraceManager.getTracer(a.COMPONENT_NAMES.ResponseHandler),b=g.commonEventParameters||[];if(m)O.info("".concat(E()," Executing error response handler"),b),v=Object(c.buildErrorResponse)(n.HTTP_STATUS_CODES.InternalServerError,e.url,m);else switch(t){case n.OPERATION.Create:v=yield Object(o.createResponseHandler)(e,r,O,h,y,b);break;case n.OPERATION.Batch:v=yield Object(i.batchResponseHandler)(e,r,O,h,b,y,g);break;case n.OPERATION.Update:v=Object(p.updateResponseHandler)(e,r,O,h,b);break;case n.OPERATION.Retrieve:v=yield Object(d.retrieveResponseHandler)(e,r,O,h,b,y);break;case n.OPERATION.RetrieveMultiple:v=yield Object(l.retrieveMultipleResponseHandler)(e,r,O,h,y,g);break;case n.OPERATION.GetClientMetadata:v=yield Object(u.getClientMetadataResponseHandler)(e,r,O,h,b,y);break;case n.OPERATION.Delete:case n.OPERATION.FileDelete:v=Object(s.deleteResponseHandler)(e,r,O,h,b);break;case n.OPERATION.Upload:v=Object(f.uploadResponseHandler)(e,r,O,h);break;default:v=Object(c.buildOdataResponse)(n.HTTP_STATUS_CODES.BadRequest,e.url)}return g.performanceControl&&g.performanceControl.endMarker(a.FILE_PREFIX.ResponseHandler),v}))).apply(this,arguments)}function g(e,t,r,n){return O.apply(this,arguments)}function O(){return(O=m((function*(e,t,r,n){return yield y(e,t,r,void 0,void 0,void 0,n)}))).apply(this,arguments)}function E(e){return"[".concat(e||a.FILE_PREFIX.ResponseHandler,"]")}},9105:function(e,t,r){"use strict";r.r(t),r.d(t,"batchResponseHandler",(function(){return m}));var n=r(9045),a=r(9104),i=r(9053),o=r(9061),s=r(9106),u=r(9107),c=r(9108),l=r(9060),d=r(9047),p=r(9058);function f(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function h(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){f(i,n,a,o,s,"next",e)}function s(e){f(i,n,a,o,s,"throw",e)}o(void 0)}))}}function m(e,t,r,n){return y.apply(this,arguments)}function y(){return(y=h((function*(e,t,r,a){var o,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],u=arguments.length>5?arguments[5]:void 0,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{},d=e.url,f=[];try{var h=Object(l.extractIndividualRequests)(e,r,s);a?b(h,t)?!a||a.length<1?(f.push({name:"BatchResponseStatus",value:"Batch retrieve request returning empty response"}),o=Object(i.buildOdataResponse)(n.HTTP_STATUS_CODES.NoContent,d)):(f.push({name:"BatchResponseStatus",value:"Batch retrieve request returning proper response"}),o=yield O(h,t,r,a[0],s,u&&u.length>=1?u[0]:[])):(f.push({name:"BatchResponseStatus",value:"Generating valid batch response"}),o=yield v(d,h,t,a,u,c)):(f.push({name:"BatchResponseStatus",value:"RawResponse is null or empty"}),o=Object(i.buildOdataResponse)(n.HTTP_STATUS_CODES.NoContent,d))}catch(y){var m=y&&y.message?y.message:"Unknown";throw Object(p.addErrorInformationToEventParameters)(y,f),r.error("".concat(T()," Exception in batchResponseHandler - ").concat(m),Object(p.addEventParameters)(s,f)),y}return o}))).apply(this,arguments)}function v(e,t,r,n,a){return g.apply(this,arguments)}function g(){return(g=h((function*(e,t,r,u,c){var l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};if(!u||!t)return Object(i.buildOdataResponse)(n.HTTP_STATUS_CODES.NoContent,e);for(var d=[],p=0;p<t.length;p++){var f=t[p],h=u.length>p&&u[p]?u[p]:null,m=c?c[p]:[];if(h){var y=Object(o.getRequestType)(f);y?d.push(yield Object(a.responseHandler)(f,y,r,h,void 0,m,l)):d.push(Object(i.buildOdataResponse)(n.HTTP_STATUS_CODES.BadRequest,f.url))}else d.push(Object(i.buildOdataResponse)(n.HTTP_STATUS_CODES.InternalServerError,f.url))}return yield Object(s.buildBatchResponse)(d)}))).apply(this,arguments)}function O(e,t,r,n){return E.apply(this,arguments)}function E(){return(E=h((function*(e,t,r,n){var a,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],o=arguments.length>5?arguments[5]:void 0,l=e&&e.length>0?e[0]:void 0;if(o&&o.BPFEntityLogicalName){var d=o&&o.BPFQueryIndex?o.BPFQueryIndex:1;a=e&&e.length>1?e[d]:void 0}if(!l)throw new Error("Unsupported offline batch request");var p=yield Object(c.getEntityResponseData)(l,t,r,n,i,o),f=yield Object(c.retrieveResponseHandler)(l,t,r,n,i,o);if(a){var h=o&&o.BPFQueryIndex?o.BPFQueryIndex:1,m=yield Object(u.bpfResponseHandler)(a,t,r,n&&n.length>h?n.slice(h,h+1):[],p,i,o);return yield Object(s.buildBatchResponse)([f,m])}return yield Object(s.buildBatchResponse)([f])}))).apply(this,arguments)}function b(e,t){for(var r of e){if(Object(o.getRequestType)(r,t)===n.OPERATION.Retrieve)return!0}return!1}function T(e){return"[".concat(e||d.FILE_PREFIX.BatchResponseHandler,"]")}},9106:function(e,t,r){"use strict";r.r(t),r.d(t,"buildBatchResponse",(function(){return o}));var n=r(9045);function a(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function i(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function s(e){a(o,n,i,s,u,"next",e)}function u(e){a(o,n,i,s,u,"throw",e)}s(void 0)}))}}function o(e,t){return s.apply(this,arguments)}function s(){return(s=i((function*(e,t){var r="";t||(t="batch_".concat((new Date).getTime()));for(var a=0;a<e.length;a++){var i=e[a];r+="--"+t+"\n";var o="";if(Array.isArray(i)){var s=i,c="changeset_".concat(t,"-").concat(a);o=yield u(c,s),r+="".concat(n.HEADER.CONTENT_TYPE,": multipart/mixed;boundary=").concat(c,"\n")}else{var d=i;o=yield l(d),r+="".concat(n.HEADER.CONTENT_TYPE,": ").concat(n.HEADER_VALUES.APPLICATION_HTTP,"\n").concat(n.HEADER.CONTENT_TRANSFER_ENCODING,": ").concat(n.HEADER_VALUES.BINARY,"\n")}r+="\n",r+=o,r+="\n"}var f="--".concat(t,"--\r\n\0");return r.endsWith(f+"\n")?r=r.substr(0,r.length-1):r+=f,p(e,r,t)}))).apply(this,arguments)}function u(e,t){return c.apply(this,arguments)}function c(){return(c=i((function*(e,t){var r="",a=1;for(var i of t)r+="--"+e+"\n",r+="".concat(n.HEADER.CONTENT_TYPE,": ").concat(n.HEADER_VALUES.APPLICATION_HTTP,"\n").concat(n.HEADER.CONTENT_TRANSFER_ENCODING,": ").concat(n.HEADER_VALUES.BINARY,"\n"),i.ok?r+="".concat(n.HEADER.CONTENT_ID,": ").concat(a,"\n"):r+="".concat(n.HEADER.CONTENT_ID,": ").concat(i.headers.get(n.HEADER.CONTENT_ID)),a++,r+="\n",r+=(yield l(i)),r+="\n";return r+="--"+e+"--\n"}))).apply(this,arguments)}function l(e){return d.apply(this,arguments)}function d(){return(d=i((function*(e){var t="HTTP/1.1 ".concat(e.status," ").concat(e.statusText,"\n");if([n.HEADER.REQ_ID,n.HEADER.CONTENT_TYPE,n.HEADER.PREFERENCE_APPLIED,n.HEADER.ODADTA_ENTITY_ID,n.HEADER.LOCATION].forEach(r=>{e.headers.has(r)&&(t+="".concat(r,": ").concat(e.headers.get(r),"\n"))}),e.headers.get(n.HEADER.CONTENT_TYPE)===n.HEADER_VALUES.APPLICATION_JSON){var r=yield e.json();t+="\n"+JSON.stringify(r)}return t}))).apply(this,arguments)}function p(e,t,r){var a=!0,i=200,o="OK";for(var s of e)if(Array.isArray(s)){var u=s.filter(e=>!e.ok);if(u.length>0){a=!1,i=u[0].status,o=u[0].statusText;break}}else if(!s.ok){a=!1,i=s.status,o=s.statusText;break}return{ok:a,status:i,statusText:o,clone(){return Object.assign({},this)},json:()=>Promise.resolve(t||{}),text:()=>Promise.resolve(t||""),headers:new Headers({[n.HEADER.CONTENT_TYPE]:"multipart/mixed;boundary=".concat(r)}),url:"$batch"}}},9107:function(e,t,r){"use strict";r.r(t),r.d(t,"bpfResponseHandler",(function(){return d})),r.d(t,"getBPFResponseData",(function(){return f}));var n=r(9045),a=r(9058),i=r(9050),o=r(9056),s=r(9047),u=r(9053);function c(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function l(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){c(i,n,a,o,s,"next",e)}function s(e){c(i,n,a,o,s,"throw",e)}o(void 0)}))}}function d(e,t,r,n,a){return p.apply(this,arguments)}function p(){return(p=l((function*(e,t,r,a,s){var c,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],d=arguments.length>6?arguments[6]:void 0,p=new Headers;r.info("".concat(m()," Processing the retrieve response"),l),p.set(n.HEADER.CONTENT_TYPE,n.HEADER_VALUES.APPLICATION_JSON);var h=a;if(h&&h.length>0){var y=yield f(e,t,r,h,s,l,d);Object(i.isNullOrUndefinedOrEmptyString)(y)?(r.error("".concat(m()," No response retrieved from offline DB for this request"),l),c=Object(u.buildErrorResponse)(n.HTTP_STATUS_CODES.Unknown,e.url,new o.LocalError("No response retrieved from offline DB for this request"),p)):c=Object(u.buildOdataResponse)(n.HTTP_STATUS_CODES.Ok,e.url,p,y)}else r.error("".concat(m()," No response retrieved from offline DB for this request"),l),c=Object(u.buildErrorResponse)(n.HTTP_STATUS_CODES.Unknown,e.url,new o.LocalError("No response retrieved from offline DB for this request"),p);return c}))).apply(this,arguments)}function f(e,t,r,n,a){return h.apply(this,arguments)}function h(){return(h=l((function*(e,t,r,n,i){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],s=arguments.length>6?arguments[6]:void 0,c="",l={},d=[],p=s?s.BPFEntityLogicalName:"";if(!p||0===p.length)return"";d.push({name:"EntityLogicalName",value:p});var f=n[0].rows.item(0);if(f){var h=!1;Object(u.headerContainsPreferAnnotation)(e)&&(h=!0),l=yield Object(u.getFormattedRecordData)(t,f,p,h),t.EventManager.ReportComponentSuccess(m(),Object(a.addEventParameters)(o,d));var y={};l["@odata.type"]=p,y.GlobalNavigationData=l,i&&(y.Entity=i),y["@odata.context"]=e.url,c=JSON.stringify(y)}return c}))).apply(this,arguments)}function m(e){return"[".concat(e||s.FILE_PREFIX.BPFResponseHandler,"]")}},9108:function(e,t,r){"use strict";r.r(t),r.d(t,"retrieveResponseHandler",(function(){return p})),r.d(t,"getEntityResponseData",(function(){return y}));var n=r(9045),a=r(9058),i=r(9056),o=r(9047),s=r(9109),u=r(9112),c=r(9053);function l(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function d(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){l(i,n,a,o,s,"next",e)}function s(e){l(i,n,a,o,s,"throw",e)}o(void 0)}))}}function p(e,t,r,n){return f.apply(this,arguments)}function f(){return(f=d((function*(e,t,r,a){var o,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],u=arguments.length>5?arguments[5]:void 0,l=new Headers;l.set(n.HEADER.CONTENT_TYPE,n.HEADER_VALUES.APPLICATION_JSON),r.info("".concat(T()," Processing the retrieve response"),s);var d=a;if(d&&d.length>0){var p=yield h(e,t,r,d,s,u);o=Object(c.buildOdataResponse)(n.HTTP_STATUS_CODES.Ok,e.url,l,p)}else r.error("".concat(T()," No response retrieved from offline DB for this request"),s),o=Object(c.buildErrorResponse)(n.HTTP_STATUS_CODES.Unknown,e.url,new i.LocalError("No response retrieved from offline DB for this request",n.ErrorCode.DataStoreKeyNotFoundErrorCode));return o}))).apply(this,arguments)}function h(e,t,r,n){return m.apply(this,arguments)}function m(){return(m=d((function*(e,t,r,n){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],i=arguments.length>5?arguments[5]:void 0,o=yield y(e,t,r,n,a,i);return o["@odata.context"]=e.url,JSON.stringify(o)}))).apply(this,arguments)}function y(e,t,r,n){return v.apply(this,arguments)}function v(){return(v=d((function*(e,t,r,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],u=arguments.length>5?arguments[5]:void 0,l={},d=[],p=yield Object(s.getEntityNameFromRequest)(e,t,r,o);d.push({name:"EntityLogicalName",value:p});var f=i[0].rows.item(0);if(f){var h=!1;Object(c.headerContainsPreferAnnotation)(e)&&(h=!0),(l=yield Object(c.getFormattedRecordData)(t,f,p,h))["@odata.type"]=p,u&&u.ContainsActivityPartyQuery&&E(l,i[u.ActivityPartyQueryIndex].rows,u.ParticipationMasks,h,t),u&&u[n.EXPAND_PROPERTIES]&&(yield g(l,i,h,t,u,r)),t.EventManager.ReportComponentSuccess(T(),Object(a.addEventParameters)(o,d))}else r.error("".concat(T()," No response retrieved from offline DB for this request"),o);return l}))).apply(this,arguments)}function g(e,t,r,n,a,i){return O.apply(this,arguments)}function O(){return(O=d((function*(e,t,r,a,i,o){for(var s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:[],u=0;u<i[n.EXPAND_PROPERTIES].length;){var l=i[n.EXPAND_PROPERTIES][u],d=l.ExpandPropertyName,p=l.ExpandValueType,f=l.ExpandQueryIndex,h=l.ReferencedOrReferencingEntityName,m=t[f].rows;if(m)if(p===n.EXPAND_VALUES.MULTI_VALUE){for(var y=0,v=[];y<m.length;){var g=m.item(y),O=yield Object(c.getFormattedRecordData)(a,g,h,r);v.push(O),y++}e[d]=v}else{var E=m.item(0);if(E){var b=yield Object(c.getFormattedRecordData)(a,E,h,r);e[d]=b}else o.warn("".concat(T()," data for expand property ").concat(d," is null."),s)}u++}}))).apply(this,arguments)}function E(e,t,r,n,a){return b.apply(this,arguments)}function b(){return(b=d((function*(e,t,r,n,a){if(t.length>0){for(var i={},o=0;o<t.length;o++){var s=yield Object(c.getFormattedRecordData)(a,t.item(o),u.activityParty,n);i[s[u.participationMasks]]?i[s[u.participationMasks]].push(s):i[s[u.participationMasks]]=[s]}for(var l in i)if(i[l]&&r[+l]){var d=i[l];e[r[+l]]={entities:d,morerecords:!1,totalrecordcount:d.length,totalRecordCountLimitExceeded:!1}}}return e}))).apply(this,arguments)}function T(e){return"[".concat(e||o.FILE_PREFIX.BPFResponseHandler,"]")}},9109:function(e,t,r){"use strict";r.r(t),r.d(t,"getAttributeName",(function(){return C})),r.d(t,"isSpecialAttribute",(function(){return J})),r.d(t,"getLinkEntityAttribute",(function(){return $})),r.d(t,"getAttributePicklistMetadata",(function(){return te})),r.d(t,"addPicklistCaseStatement",(function(){return ne})),r.d(t,"convertConditionOperatorToSQLFormat",(function(){return ae})),r.d(t,"convertJoinTypeToSQLFormat",(function(){return ie})),r.d(t,"createEntityRecord",(function(){return E})),r.d(t,"isRegularActivityObject",(function(){return j})),r.d(t,"getFieldSQLRepresentation",(function(){return x})),r.d(t,"extractAdditionalColumnNames",(function(){return U})),r.d(t,"getEntityNameFromRequest",(function(){return k})),r.d(t,"getEntityIdFromUrl",(function(){return V})),r.d(t,"getColumnsFromRequestJSON",(function(){return B})),r.d(t,"appendRetrieveQuery",(function(){return X})),r.d(t,"getInsertActivityPartySQLQueryRequests",(function(){return W})),r.d(t,"populateRecordWithData",(function(){return T})),r.d(t,"populateDefaultFieldsForOperation",(function(){return D}));var n=r(9045),a=r(9050),i=r(9056),o=r(9047),s=r(9048),u=r(9046),c=r(9054),l=r(9110),d=r(9111),p=r(9112),f=r(9063),h=r(9113),m=r(9165),y=r(9166),v=r(9140);function g(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function O(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){g(i,n,a,o,s,"next",e)}function s(e){g(i,n,a,o,s,"throw",e)}o(void 0)}))}}function E(e,t,r,n,a,i){return b.apply(this,arguments)}function b(){return(b=O((function*(e,t,r,n,i,o){var s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{},l=yield Object(c.getAttributeTypes)(n,[],e,o),d=yield N(e,[],n,o),h={id:u.Guid.EMPTY,entityLogicalName:e,attributeTypes:l,values:d};h=yield T(h,t,l,r,n,i,o,s);var m=yield Object(c.getEntityMetadata)(n,e);if(h=yield D(n,h,m,r,o,s),e===f.AnnotationEntityLogicalName&&r===f.SqlOperation.create&&Object.keys(h.values).indexOf(p.objectId)>=0){var y=h.values[p.objectId];Object(a.isNullOrUndefined)(y)||(h.values[p.objectTypeCode]=y)}if(h.values[p.versionNumber]="0",r===f.SqlOperation.create){if(!m.PrimaryIdAttribute){var v="entity metadata does not have primary id attribute";throw i.error("".concat(K()," ").concat(v),o),new Error(v)}m.PrimaryIdAttribute in h.values||(h.values[m.PrimaryIdAttribute]=u.Guid.newGuid().guid),h.id=new u.Guid(h.values[m.PrimaryIdAttribute]),!Object(a.isNullOrUndefined)(m)&&m.IsActivity&&(Object(a.isNullOrUndefined)(h.activityParties)&&(h.activityParties=[]),h.activityParties.push({partyId:yield Object(c.getUserId)(n,o),partyName:yield Object(c.getUserName)(n,o),partyLogicalName:p.systemUser,participationType:p.participationTypeValue.owner}))}return h}))).apply(this,arguments)}function T(e,t,r,n,a,i,o){return S.apply(this,arguments)}function S(){return(S=O((function*(e,t,r,u,l,d,m){var v=arguments.length>7&&void 0!==arguments[7]?arguments[7]:{};null==m||m.push({name:o.EVENT_PARAMETERS.ENTITY_NAME,value:null==e?void 0:e.entityLogicalName});for(var g=0;g<t.columnNames.length;g++){var O=C(t.columnNames[g]);if(r[O]===s.AttributeType.PartyList){Object(a.isNullOrUndefined)(e.activityParties)&&(e.activityParties=[]);var E=t.columnValues[g].match(/(\w+)\(([0-9a-fA-F]{8}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{12})\)/);if(null===E){var b="Parsing a party list attribute ".concat(t.columnNames[g]," failed: ").concat(t.columnValues[g]);throw d.error("".concat(K()," ").concat(b),m),new i.LocalError(b,n.ErrorCode.UnknownBadRequestError)}var T=yield Object(c.getEntityLogicalName)(l,E[1],m);e.activityParties.push({partyId:E[2],partyName:yield Object(h.getPrimaryName)(l,T,E[2],d,v),partyLogicalName:T,participationType:p.participationTypeValue[O]})}else if(r[O]===s.AttributeType.Owner||r[O]===s.AttributeType.Lookup||r[O]===s.AttributeType.Customer)if(t.columnValues[g]&&""!==t.columnValues[g].trim()){var S=t.columnValues[g].match(/(\w+)\(([0-9a-fA-F]{8}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{12})\)(\/(.*)):?/);if(null===S){var N="Parsing a lookup or customer reference attribute ".concat(t.columnNames[g]," failed: ").concat(t.columnValues[g]);throw d.error("".concat(K()," ").concat(N),m),new i.LocalError(N,n.ErrorCode.UnknownBadRequestError)}var _=x(s.AttributeType.UniqueIdentifier,S[2]);Object(y.setFieldValue)(e,O+p.columnDelimiter+p.id,_,s.AttributeType.UniqueIdentifier);var R=yield Object(c.getEntityLogicalName)(l,S[1],m);Object(y.setFieldValue)(e,O+p.columnDelimiter+p.logicalName,R,s.AttributeType.String);var P=f.DEFAULT.EmptyString;P=5!==S.length||Object(a.isNullOrUndefinedOrEmptyString)(S[4])?yield Object(h.getPrimaryName)(l,R,_,d):S[4],Object(y.setFieldValue)(e,O+p.columnDelimiter+p.name,P,s.AttributeType.String)}else Object(y.setFieldValue)(e,O+p.columnDelimiter+p.id,null,s.AttributeType.UniqueIdentifier),Object(y.setFieldValue)(e,O+p.columnDelimiter+p.logicalName,null,s.AttributeType.String),Object(y.setFieldValue)(e,O+p.columnDelimiter+p.name,null,s.AttributeType.String);else Object(y.setFieldValue)(e,O,x(r[O],t.columnValues[g]),r[O])}return e}))).apply(this,arguments)}function C(e){var t=e;return e.startsWith("_")&&e.endsWith("_value")&&(t=e.substr(1,e.length-7)),t}function N(e,t,r){return _.apply(this,arguments)}function _(){return(_=O((function*(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i={},o=yield Object(c.getAttributesMetadata)(r,e,t,n);for(var u in o)if(!Object(a.isNullOrUndefined)(o[u])){var l=o[u];if(l.Type!==s.AttributeType.Boolean||Object(a.isNullOrUndefined)(l.DefaultValue)){if(l.Type===s.AttributeType.PickList&&!Object(a.isNullOrUndefined)(l.DefaultFormValue)){var d=l.DefaultFormValue;-1!==d&&(i[l.LogicalName]=d)}}else l.DefaultValue?i[l.LogicalName]=1:i[l.LogicalName]=0}return i}))).apply(this,arguments)}function R(e,t,r,n){return P.apply(this,arguments)}function P(){return(P=O((function*(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},u=[];if(t===f.SqlOperation.create){var d=[...p.defaultFieldsForCreate];d.push(...p.stateAndStatusFields);var h=d.indexOf(p.ownerId);for(var v of(h>=0&&!Object(a.isNullOrUndefined)(r)&&!Object(a.isNullOrUndefined)(r.OwnershipType)&&r.OwnershipType.valueOf()===l.OwnershipTypes.OrganizationOwned&&d.splice(h,1),d))e.values[v]||u.push(v);!Object(a.isNullOrUndefined)(r)&&r.IsActivity&&(e.values[p.activityTypeCode]||Object(y.setFieldValue)(e,p.activityTypeCode,r.EntityLogicalName,s.AttributeType.String),e.values[p.isRegularActivity]||Object(y.setFieldValue)(e,p.isRegularActivity,j(r.ObjectTypeCode,r.ActivityTypeMask)?"1":"0",s.AttributeType.Boolean))}if(t===f.SqlOperation.create||t===f.SqlOperation.update){for(var g of p.defaultFields)e.values[g]||-1!==u.indexOf(g)||(u[u.length]=g);var O=yield Object(c.getAttributesMetadata)(n,e.entityLogicalName,[],i);if(!Object(a.isNullOrUndefined)(O)&&L(O,p.fullName))for(var E in e.values)if(p.fullNameComponents.indexOf(E)>=0&&!e.values[p.fullName]){var b={};t===f.SqlOperation.update&&(b=yield I(n,e,r,o,i)),b[p.firstName]=Object(a.isNullOrUndefinedOrEmptyString)(e.values[p.firstName])?b[p.firstName]:e.values[p.firstName],b[p.middleName]=Object(a.isNullOrUndefinedOrEmptyString)(e.values[p.middleName])?b[p.middleName]:e.values[p.middleName],b[p.lastName]=Object(a.isNullOrUndefinedOrEmptyString)(e.values[p.lastName])?b[p.lastName]:e.values[p.lastName],Object(y.setFieldValue)(e,p.fullName,Object(m.generateFullName)(yield Object(c.getfullnameconventioncode)(n,i),b[p.firstName],b[p.middleName],b[p.lastName]),s.AttributeType.String);break}if(t===f.SqlOperation.create){var T=Object.keys(O);for(var S of T)if(O[S]){var C=O[S];(!Object(a.isNullOrUndefined)(C.DefaultValue)||!Object(a.isNullOrUndefined)(C.DefaultFormValue))&&Object(a.isNullOrUndefined)(e.values[C.LogicalName])&&u.indexOf(C.LogicalName)<0&&(u[u.length]=C.LogicalName)}}return u}return u}))).apply(this,arguments)}function I(e,t,r){return A.apply(this,arguments)}function A(){return(A=O((function*(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],s=e.TraceManager.getTracer(o.COMPONENT_NAMES.SQLGenerator),u={sqlStatements:[f.CLAUSE.select+f.Punctuation.space+p.firstName+f.Punctuation.comma+p.middleName+f.Punctuation.comma+p.lastName+f.Punctuation.space+f.CLAUSE.from+f.Punctuation.space+t.entityLogicalName+f.Punctuation.space+f.CLAUSE.where+f.Punctuation.space+r.PrimaryIdAttribute+f.Punctuation.equal+f.CLAUSE.placeholder],sqlParameters:[[t.id.guid]]};try{var c=yield Object(d.ExecuteSQLBatch)(u,e,void 0,n);if(!Object(a.isNullOrUndefined)(c)&&1===c.length)return c[0].rows.item(0)}catch(l){s.error("".concat(K()," Unable to get name parts for ").concat(t.entityLogicalName," from DB. Error: ").concat(l.errorMessage),i)}return{}}))).apply(this,arguments)}function D(e,t,r,n){return M.apply(this,arguments)}function M(){return(M=O((function*(e,t,r,n){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},o=yield R(t,n,r,e,a,i);return t=yield F(t,o,r,e,a)}))).apply(this,arguments)}function F(e,t,r,n){return w.apply(this,arguments)}function w(){return(w=O((function*(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],o=yield Object(c.getAttributesMetadata)(n,e.entityLogicalName,t,i);for(var u in o)if(!Object(a.isNullOrUndefined)(o[u])){var d=o[u];if(!Object(a.isNullOrUndefined)(d))switch(d.LogicalName){case p.stateCode:r.HasStateCode&&Object(y.setFieldValue)(e,d.LogicalName,Object(a.isNullOrUndefined)(d.DefaultFormValue)?0:d.DefaultFormValue,s.AttributeType.State),-1===t.indexOf(p.statusCode)||Object(a.isNullOrUndefined)(e.values[p.stateCode])||function(){var t=e.values[p.stateCode],r=0;if(d&&d.OptionSet&&Object.keys(d.OptionSet).length>0){var n=d.OptionSet.find(e=>e.Value===t);r=n?n.DefaultStatus:0}Object(y.setFieldValue)(e,p.statusCode,r,s.AttributeType.Status)}();break;case p.statusCode:break;case p.createdOn:case p.modifiedOn:Object(y.setFieldValue)(e,d.LogicalName,new Date(Date.now()),s.AttributeType.DateTime);break;case p.createdBy:case p.modifiedBy:case p.ownerId:if(d.LogicalName!==p.ownerId||!Object(a.isNullOrUndefined)(r.OwnershipType)&&r.OwnershipType.valueOf()===l.OwnershipTypes.UserOwned){var f=yield Object(c.getUserId)(n,i),h=yield Object(c.getUserName)(n,i);if(Object(a.isNullOrUndefinedOrEmpty)(f))throw new Error("User ID fetched from metadata cache was empty");if(Object(a.isNullOrUndefinedOrEmpty)(h))throw new Error("User Name fetched from metadata cache was empty");Object(y.setFieldValue)(e,d.LogicalName+p.columnDelimiter+p.id,Object(a.isNullOrUndefinedOrEmpty)(f)?null:f,s.AttributeType.UniqueIdentifier),Object(y.setFieldValue)(e,d.LogicalName+p.columnDelimiter+p.logicalName,p.systemUser,s.AttributeType.String),Object(y.setFieldValue)(e,d.LogicalName+p.columnDelimiter+p.name,Object(a.isNullOrUndefinedOrEmpty)(h)?null:h,s.AttributeType.String)}break;default:d.Type!==s.AttributeType.PickList||Object(a.isNullOrUndefined)(d.DefaultFormValue)||Object(y.setFieldValue)(e,d.LogicalName,d.DefaultFormValue,d.Type),d.Type||!d.DefaultFormValue&&!d.DefaultValue||Object(y.setFieldValue)(e,d.LogicalName,Object(a.isNullOrUndefined)(d.DefaultFormValue)?d.DefaultValue?1:0:d.DefaultFormValue,d.Type)}}return e}))).apply(this,arguments)}function L(e,t){return!!e[t]}function j(e,t){switch(e){case f.OpportunityClose:case f.OrderClose:case f.QuoteClose:case f.IncidentResolution:case f.BulkOperation:case f.RecurringAppointmentMaster:return!1;default:return!!t}}function x(e,t){switch(e){case s.AttributeType.UniqueIdentifier:return u.Guid.parse(t).guid;case s.AttributeType.PickList:case s.AttributeType.State:case s.AttributeType.Status:return t;case s.AttributeType.Boolean:return!0===t?"1":"0";case s.AttributeType.DateTime:return t;case s.AttributeType.PartyList:throw Error("No SQL representation for party list");case s.AttributeType.Owner:case s.AttributeType.Lookup:case s.AttributeType.Customer:throw Error("No SQL representation for complex types");default:return t}}function U(e){return e.split(",").map(e=>e.trim())}function k(e,t,r){return q.apply(this,arguments)}function q(){return(q=O((function*(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};if(!e.url)throw r.error("".concat(K()," Error when attempting to extract entity name from URL"),n),new Error("Empty url is not valid");var o=yield Object(a.getEntitySetNameFromUrl)(t,e),s=yield Object(a.isInternalRequest)(t,e,o.substring(0,o.length-1));return s?(i.internalRequest=!0,o.substring(0,o.length-1)):(i.internalRequest=!1,yield Object(c.getEntityLogicalName)(t,o,n))}))).apply(this,arguments)}function V(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(!e)throw t.error("".concat(K()," Error when attempting to extract entity name from URL"),r),new Error("Empty url is not valid");var n=e.split("/"),i=n[n.length-1].split("(")[1];if(Object(a.isNullOrUndefinedOrEmptyString)(i))return null;var o=i.split(")")[0];return u.Guid.parse(o)}function B(e,t,r,n,a){return H.apply(this,arguments)}function H(){return(H=O((function*(e,t,r,n,i){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[];if(Object(a.isNullOrUndefinedOrEmptyString)(e)||Object(a.isNullOrUndefinedOrEmpty)(t)){var s="Invalid request. Empty request body";throw i.error("".concat(K()," ").concat(s),o),new Error(s)}var u=JSON.parse(e),l=[],d=[],p=yield Object(c.getEntityMetadata)(n,r);for(var f in u)if(f.indexOf("@odata.bind")>0)z(f,u,p,t,l,d,i,o);else if(f.indexOf("activity_parties")>0)Q(f,u,l,d,i,o);else if(-1===f.toLowerCase().indexOf("@odata")){l.push(f);var h=C(f);if(!t[h]){var m="Unknown attribute ".concat(h);i.warn("".concat(K()," ").concat(m),o)}d.push(Object(a.isNullOrUndefined)(u[f])?G(t[h],h,i):u[f])}return{columnNames:l,columnValues:d}}))).apply(this,arguments)}function G(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];switch(e){case s.AttributeType.PickList:case s.AttributeType.State:case s.AttributeType.Status:case s.AttributeType.Lookup:case s.AttributeType.Owner:case s.AttributeType.Customer:case s.AttributeType.BigInt:case s.AttributeType.Decimal:case s.AttributeType.Double:case s.AttributeType.Integer:case s.AttributeType.Money:return r.warn("".concat(K()," Column value cleared, setting default value to null for attribute type ")+t,n),null;default:return r.warn("".concat(K()," Column value cleared, setting default value to empty string for attribute type ")+t,n),f.DEFAULT.EmptyString}}function Q(e,t,r,n,a,i){var o=t[e];for(var s of(a.info("".concat(K," Found ").concat(o.length," activity parties"),i),o))for(var u in s)u.indexOf("@odata.bind")>0?n.push(s[u]):"participationtypemask"===u&&r.push(p.participationTypeNames[s[u]])}function z(e,t,r,o,s,u,c,l){var d=e.split("@odata.bind")[0],p=Object(a.isNullOrUndefinedOrEmptyString)(t[e])?t[e]:t[e]+"/"+(t[d+"@OData.Community.Display.V1.FormattedValue"]||f.DEFAULT.EmptyString),h=!1;if(r&&r.ManyToOneRelationships)for(var m in r.ManyToOneRelationships){var y=r.ManyToOneRelationships[m];if(y.ReferencingEntityNavigationPropertyName===d&&y.ReferencingAttribute){s.push(y.ReferencingAttribute),u.push(p),h=!0;break}}if(!h){var v=new i.LocalError("".concat(K()," No navigation properties found for attribute ").concat(d," in entity ").concat(r.EntityLogicalName),n.ErrorCode.UnknownBadRequestError,(new Error).stack);throw c.error(v.message,l),v}}function X(e,t,r,i,s){var c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],l=e.TraceManager.getTracer(o.COMPONENT_NAMES.SQLGenerator);if(Object(a.isNullOrUndefinedOrEmptyString)(s)||u.Guid.equals(i,u.Guid.EMPTY))return l.error("".concat(K()," Invalid parameters when creating query for ").concat(n.HEADER_VALUES.PREFER_REPRESENTATION),c),t;var d="select * from ".concat(r," where ").concat(s,"=?");t.sqlStatements.push(d);var p=[];return p.push(i.guid.toString()),t.sqlParameters.push(p),t}function W(e,t,r){return Y.apply(this,arguments)}function Y(){return(Y=O((function*(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];if(!Object(a.isNullOrUndefined)(t.activityParties)){var i=yield Object(c.getAttributesMetadata)(e,p.activityParty,[p.isPartyDeleted],n),o=Object(a.isNullOrUndefined)(i)||Object(a.isNullOrUndefined)(i[p.isPartyDeleted])?"0":i[p.isPartyDeleted].DefaultValue?"1":"0";for(var s of t.activityParties)r.sqlStatements.push(f.CLAUSE.insert+f.Punctuation.space+f.CLAUSE.into+f.Punctuation.space+f.Punctuation.openSQBracket+p.activityParty+f.Punctuation.closeSQBracket+f.Punctuation.space+f.Punctuation.openParenthesis+f.Punctuation.openSQBracket+p.activityPartyId+f.Punctuation.closeSQBracket+f.Punctuation.comma+f.Punctuation.openSQBracket+p.activityId+f.Punctuation.exclamation+p.id+f.Punctuation.closeSQBracket+f.Punctuation.comma+f.Punctuation.openSQBracket+p.activityId+f.Punctuation.exclamation+p.name+f.Punctuation.closeSQBracket+f.Punctuation.comma+f.Punctuation.openSQBracket+p.activityId+f.Punctuation.exclamation+p.logicalName+f.Punctuation.closeSQBracket+f.Punctuation.comma+f.Punctuation.openSQBracket+p.participationMasks+f.Punctuation.closeSQBracket+f.Punctuation.comma+f.Punctuation.openSQBracket+p.partyId+f.Punctuation.exclamation+p.id+f.Punctuation.closeSQBracket+f.Punctuation.comma+f.Punctuation.openSQBracket+p.partyId+f.Punctuation.exclamation+p.name+f.Punctuation.closeSQBracket+f.Punctuation.comma+f.Punctuation.openSQBracket+p.partyId+f.Punctuation.exclamation+p.logicalName+f.Punctuation.closeSQBracket+f.Punctuation.comma+f.Punctuation.openSQBracket+p.isPartyDeleted+f.Punctuation.closeSQBracket+f.Punctuation.closeParenthesis+f.Punctuation.space+f.CLAUSE.values+f.Punctuation.space+f.Punctuation.openParenthesis+f.Punctuation.question+f.Punctuation.comma+f.Punctuation.question+f.Punctuation.comma+f.Punctuation.question+f.Punctuation.comma+f.Punctuation.question+f.Punctuation.comma+f.Punctuation.question+f.Punctuation.comma+f.Punctuation.question+f.Punctuation.comma+f.Punctuation.question+f.Punctuation.comma+f.Punctuation.question+f.Punctuation.comma+f.Punctuation.question+f.Punctuation.closeParenthesis),r.sqlParameters.push([u.Guid.newGuid().guid,t.id.guid,Object(a.isNullOrUndefinedOrEmptyString)(t.values[p.name])?"":t.values[p.name],t.entityLogicalName,s.participationType,s.partyId,s.partyName,s.partyLogicalName,o])}return r}))).apply(this,arguments)}function K(e){return"[".concat(e||o.FILE_PREFIX.Common,"]")}function J(e,t,r,n){return Z.apply(this,arguments)}function Z(){return(Z=O((function*(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],o=yield Object(c.getAttributesMetadata)(e,t,[],i);if(Object(a.isNullOrUndefinedOrEmpty)(o)){var u="Unable to get attribute metadata descriptor that associated to entity: ".concat(t);return n.warn("".concat(K()," ").concat(u),i),Promise.reject(u)}return!(!o[r]||o[r].Type!==s.AttributeType.Lookup&&o[r].Type!==s.AttributeType.Customer&&o[r].Type!==s.AttributeType.Owner)}))).apply(this,arguments)}function $(e,t,r,n,a){return ee.apply(this,arguments)}function ee(){return(ee=O((function*(e,t,r,n,i){if(i.internalRequest)return e;var o=yield Object(c.getAttributesMetadata)(r,t,[],i.commonEventParameters);if(Object(a.isNullOrUndefinedOrEmpty)(o)||Object(a.isNullOrUndefinedOrEmpty)(o[e])){var u="Unable to get attribute metadata descriptor that associated to entity: ".concat(t,". Return the given attributeName: ").concat(e);n.warn("".concat(K()," ").concat(u),i.commonEventParameters)}else{var l=o[e];if(l.Type===s.AttributeType.Lookup||l.Type===s.AttributeType.Customer||l.Type===s.AttributeType.Owner)e="[".concat(e).concat(f.Punctuation.exclamation,"id]");else if(l.AttributeOf){var d=o[l.AttributeOf];Object(a.isNullOrUndefinedOrEmpty)(d)||d.Type!==s.AttributeType.Lookup&&d.Type!==s.AttributeType.Customer&&d.Type!==s.AttributeType.Owner||(e=l.Type===s.AttributeType.EntityName?"[".concat(l.AttributeOf).concat(f.Punctuation.exclamation,"logicalname]"):"[".concat(l.AttributeOf).concat(f.Punctuation.exclamation,"name]"))}}return e.endsWith("]")&&e.startsWith("[")&&(e=e.substring(1,e.length-1)),e}))).apply(this,arguments)}function te(e,t,r,n){return re.apply(this,arguments)}function re(){return(re=O((function*(e,t,r,n){var a=yield Object(c.getAttributesMetadata)(r,t,[],n);if(a&&a[e]){var i=a[e];if(i.AttributeOf){var o=a[i.AttributeOf];switch(o.Type){case s.AttributeType.Boolean:case s.AttributeType.PickList:case s.AttributeType.State:case s.AttributeType.Status:return o}}}return null}))).apply(this,arguments)}function ne(e,t,r){var n=e.OptionSet;if(n&&0!==n.length){t.push("case [".concat(r,"].[").concat(e.LogicalName,"]"));for(var a=0;a<n.length;a++)t.push(" when ".concat(n[a].Value," then '").concat(n[a].Label,"'"));t.push(" else null"),t.push(" end ")}else t.push(" null ")}function ae(e){switch(e.toLowerCase()){case v.ConditionalOperator.equal:case v.ConditionalOperator.equalsUserId:return"=";case v.ConditionalOperator.notEqual:case v.ConditionalOperator.notEqualsUserId:return"!=";case v.ConditionalOperator.greaterThan:return">";case v.ConditionalOperator.greaterThanEqual:return">=";case v.ConditionalOperator.lessThan:return"<";case v.ConditionalOperator.lessThanEqual:return"<=";case v.ConditionalOperator.like:case v.ConditionalOperator.beginsWith:case v.ConditionalOperator.endsWith:return"like";case v.ConditionalOperator.notLike:case v.ConditionalOperator.notBeginWith:case v.ConditionalOperator.notEndWith:return"not like";case v.ConditionalOperator.in:case v.ConditionalOperator.equalsUserTeams:case v.ConditionalOperator.equalsUserOrUserTeams:return"in";case v.ConditionalOperator.notIn:return"not in";case v.ConditionalOperator.between:return"between";case v.ConditionalOperator.notBetween:return"not between";case v.ConditionalOperator.notNull:return"is not null";case v.ConditionalOperator.null:return"is null";default:var t="Invalid condition operator type ".concat(e);throw new i.LocalError(t)}}function ie(e,t,r){switch(e){case v.JoinType[v.JoinType.inner]:return v.JoinTypeSQL.inner;case v.JoinType[v.JoinType.outer]:return v.JoinTypeSQL.leftouter;default:var n="Invalid join operator type ".concat(e);throw t.error("".concat(K()," ").concat(n),r),new i.LocalError(n)}}},9110:function(e,t,r){"use strict";var n;r.r(t),r.d(t,"OwnershipTypes",(function(){return n})),function(e){e[e.None=0]="None",e[e.UserOwned=1]="UserOwned",e[e.TeamOwned=2]="TeamOwned",e[e.BusinessOwned=4]="BusinessOwned",e[e.OrganizationOwned=8]="OrganizationOwned",e[e.BusinessParented=16]="BusinessParented"}(n||(n={}))},9111:function(e,t,r){"use strict";r.r(t),r.d(t,"DefaultSqlExecutor",(function(){return l})),r.d(t,"ExecuteSQLBatch",(function(){return d}));var n=r(9045),a=r(9058),i=r(9050),o=r(9047),s=r(9063);function u(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function c(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){u(i,n,a,o,s,"next",e)}function s(e){u(i,n,a,o,s,"throw",e)}o(void 0)}))}}class l{attachFileToEntity(e){return new Promise((e,t)=>{})}attachImageToEntity(e){return new Promise((e,t)=>{})}deleteAttachment(e){return new Promise((e,t)=>{})}executeSqlStatementsOnOfflineDB(e){return new Promise((e,t)=>{})}executeSqlStatementsOnMetadataDB(e){return new Promise((e,t)=>{})}}function d(e,t,r){return p.apply(this,arguments)}function p(){return(p=c((function*(e,t,r){var u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},c=arguments.length>4&&void 0!==arguments[4]&&arguments[4],l=t.TraceManager.getTracer(o.COMPONENT_NAMES.SQLExecutor),d=u.commonEventParameters||[],p=[];e=Object(i.addClientRequestIdToSqlQueryRequests)(e,u,l),p.push({name:"NoOfSQLStatements",value:e&&e.sqlStatements?e.sqlStatements.length:0}),l.info("".concat(f()," ExecuteSQLBatch - starting ExecuteSQLBatch"),Object(a.addEventParameters)(d,p));try{var h,m,y,v;if(r===n.OPERATION.GetClientMetadata)u.performanceControl&&u.performanceControl.startMarker(o.FILE_PREFIX.MetadataSQLExecutor),m=yield null===(y=t.SqlExecutor)||void 0===y?void 0:y.executeSqlStatementsOnMetadataDB(e);else u.performanceControl&&u.performanceControl.startMarker(o.FILE_PREFIX.DataSQLExecutor),c&&(e.sqlStatements.unshift(s.SUPPRESS_TRIGGERS_INSERT),e.sqlParameters.unshift([]),e.sqlStatements.push(s.SUPPRESS_TRIGGERS_DELETE),e.sqlParameters.push([])),m=yield null===(v=t.SqlExecutor)||void 0===v?void 0:v.executeSqlStatementsOnOfflineDB(e);return(Object(i.isNullOrUndefinedOrEmpty)(m)||0===(null===(h=m)||void 0===h?void 0:h.length))&&(p.push({name:o.EVENT_PARAMETERS.SQL_QUERY,value:e.sqlStatements.toString()}),l.warn("".concat(f()," ExecuteSQLBatch did not return a result"),Object(a.addEventParameters)(d,p))),l.info("".concat(f()," SQL Executor successfully completed"),Object(a.addEventParameters)(d,p)),u.performanceControl&&(r===n.OPERATION.GetClientMetadata?u.performanceControl.endMarker(o.FILE_PREFIX.MetadataSQLExecutor):u.performanceControl.endMarker(o.FILE_PREFIX.DataSQLExecutor)),Promise.resolve(m)}catch(E){var g=Object(i.convertErrorToLocalError)(E),O=g.message;return g.message=Object(a.extractSqlErrorMessage)(O),Object(a.addErrorInformationToEventParameters)(E,p),p.push({name:o.EVENT_PARAMETERS.SQL_ERROR_CODE,value:g.code||n.ErrorCode.UnknownUnexpectedGenericError}),p.push({name:o.EVENT_PARAMETERS.SQL_ERROR_MESSAGE,value:O}),Object(a.addSqlQueriesToEventParameters)(e,p),l.error("".concat(f()," Error on SQL Executor rejecting with data source offline error code"),Object(a.addEventParameters)(d,p)),Promise.reject(g)}}))).apply(this,arguments)}function f(e){return"[".concat(e||o.FILE_PREFIX.SQLExecutor,"]")}},9112:function(e,t,r){"use strict";r.r(t),r.d(t,"columnDelimiter",(function(){return n})),r.d(t,"systemUser",(function(){return a})),r.d(t,"modifiedOn",(function(){return i})),r.d(t,"modifiedBy",(function(){return o})),r.d(t,"activityId",(function(){return s})),r.d(t,"activityTypeCode",(function(){return u})),r.d(t,"activityPartyId",(function(){return c})),r.d(t,"partyId",(function(){return l})),r.d(t,"versionNumber",(function(){return d})),r.d(t,"stateCode",(function(){return p})),r.d(t,"statusCode",(function(){return f})),r.d(t,"createdOn",(function(){return h})),r.d(t,"createdBy",(function(){return m})),r.d(t,"ownerId",(function(){return y})),r.d(t,"firstName",(function(){return v})),r.d(t,"lastName",(function(){return g})),r.d(t,"middleName",(function(){return O})),r.d(t,"fullName",(function(){return E})),r.d(t,"fullNameComponents",(function(){return b})),r.d(t,"id",(function(){return T})),r.d(t,"logicalName",(function(){return S})),r.d(t,"name",(function(){return C})),r.d(t,"objectId",(function(){return N})),r.d(t,"objectTypeCode",(function(){return _})),r.d(t,"value",(function(){return R})),r.d(t,"ownerParty",(function(){return P})),r.d(t,"isPartyDeleted",(function(){return I})),r.d(t,"partyObjectTypeCode",(function(){return A})),r.d(t,"addressUsed",(function(){return D})),r.d(t,"activityParty",(function(){return M})),r.d(t,"isRegularActivity",(function(){return F})),r.d(t,"participationMasks",(function(){return w})),r.d(t,"participationTypeValue",(function(){return L})),r.d(t,"participationTypeNames",(function(){return j})),r.d(t,"defaultFieldsForCreate",(function(){return x})),r.d(t,"stateAndStatusFields",(function(){return U})),r.d(t,"defaultFields",(function(){return k}));var n="!",a="systemuser",i="modifiedon",o="modifiedby",s="activityid",u="activitytypecode",c="activitypartyid",l="partyid",d="versionnumber",p="statecode",f="statuscode",h="createdon",m="createdby",y="ownerid",v="firstname",g="lastname",O="middlename",E="fullname",b=[v,O,g],T="id",S="logicalname",C="name",N="objectid",_="objecttypecode",R="value",P="owner",I="ispartydeleted",A="partyobjecttypecode",D="addressused",M="activityparty",F="isregularactivity",w="participationtypemask",L={from:"1",to:"2",cc:"3",bcc:"4",requiredattendees:"5",optionalattendees:"6",organizer:"7",regarding:"8",owner:"9",resources:"10",customer:"11",partner:"12"},j={1:"from",2:"to",3:"cc",4:"bcc",5:"requiredattendees",6:"optionalattendees",7:"organizer",8:"regarding",9:"owner",10:"resources",11:"customer",12:"partner"},x=[h,m,y,i,o],U=[p,f],k=[i,o]},9113:function(e,t,r){"use strict";r.r(t),r.d(t,"isTableOrViewPopulated",(function(){return g})),r.d(t,"retrieveMultipleApplicationMetadata",(function(){return E})),r.d(t,"retrieveApplicationMetadata",(function(){return T})),r.d(t,"retrieveMultipleApplicationMetadataByQuery",(function(){return C})),r.d(t,"retrieveMultipleApplicationMetadataByKeys",(function(){return _})),r.d(t,"getPrimaryName",(function(){return y}));var n=r(9045),a=r(9050),i=r(9047),o=r(9057),s=r(9054),u=r(9111),c=r(9114),l=r(9063),d=r(9078),p=r(9120);function f(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function h(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){f(i,n,a,o,s,"next",e)}function s(e){f(i,n,a,o,s,"throw",e)}o(void 0)}))}}function m(e,t,r){var n="SELECT ".concat(d.MetadataFields.METADATA_TYPE,", ").concat(d.MetadataFields.JSON," from ").concat(d.APPLICATION_METADATA_STORE," where ").concat(t," = ?");e.sqlStatements.push(n),e.sqlParameters.push([r])}function y(e,t,r,n){return v.apply(this,arguments)}function v(){return(v=h((function*(e,t,r,a){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},o=yield Object(s.getEntityMetadata)(e,t),c=o.PrimaryNameAttribute,d=o.PrimaryIdAttribute;if(!c||!d)return"";var p={sqlStatements:["SELECT ".concat(c," FROM ").concat(t," WHERE ").concat(d," = ?")],sqlParameters:[[r]]};try{var f=yield Object(u.ExecuteSQLBatch)(p,e,n.OPERATION.Retrieve,i);if(!f||f.length<=0||!f[0].rows||!f[0].rows.item||f[0].rows.item.length<=0||!c)return"";var h=f[0].rows.item(0)[c];return h}catch(m){return a.error("".concat(I()," error when retrieving activity party name. Setting as empty ").concat(m),i.commonEventParameters),l.DEFAULT.EmptyString}}))).apply(this,arguments)}function g(e,t){return O.apply(this,arguments)}function O(){return(O=h((function*(e,t){var r,a,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o={sqlStatements:[],sqlParameters:[]};o.sqlStatements.push("SELECT ".concat(d.MetadataFields.METADATA_TYPE," FROM ").concat(t," LIMIT 1")),o.sqlParameters.push([]);var s=yield Object(u.ExecuteSQLBatch)(o,e,n.OPERATION.GetClientMetadata,i);return s&&(null===(r=s[0])||void 0===r||null===(a=r.rows)||void 0===a?void 0:a.length)>0}))).apply(this,arguments)}function E(e,t,r){return b.apply(this,arguments)}function b(){return(b=h((function*(e,t,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o={sqlStatements:[],sqlParameters:[]},s=[],c=Object(a.isNullOrUndefinedOrEmptyString)(r)?p.KeyPath.get_id().get_path():r;for(var l of t)m(o,c,l);var f=yield Object(u.ExecuteSQLBatch)(o,e,n.OPERATION.GetClientMetadata,i);if(f)for(var h of(P(e,f),f))h.rows.length>0&&s.push(JSON.parse(h.rows.item(0)[d.MetadataFields.JSON]));return s}))).apply(this,arguments)}function T(e,t,r){return S.apply(this,arguments)}function S(){return(S=h((function*(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i="SELECT ".concat(d.MetadataFields.METADATA_TYPE,", ").concat(d.MetadataFields.JSON," FROM ").concat(d.APPLICATION_METADATA_STORE," WHERE ").concat(Object(a.isNullOrUndefinedOrEmptyString)(r)?p.KeyPath.get_id().get_path():r," = ?"),s=yield Object(o.getSqlResults)(e,i,[t],n.commonEventParameters,n);for(var u of(P(e,s),s))if(u.rows.length>0)return JSON.parse(u.rows.item(0)[d.MetadataFields.JSON]);return{}}))).apply(this,arguments)}function C(e,t,r){return N.apply(this,arguments)}function N(){return(N=h((function*(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i={sqlStatements:[],sqlParameters:[]},s=n.commonEventParameters||[];m(i,t.get_keyPath().get_path(),t.get_keyValue().toString());var u=yield Object(o.getBatchSqlResults)(e,i,n);(Object(a.isNullOrUndefined)(u)||u.length<1)&&r.warn("".concat(I()," result returned form getBatchSQLResult is empty in retrieveMultipleApplicationMetadataByKeys}"),s),P(e,u);for(var c=[],l=0;l<u.length;l++)if(u[l].rows.length>0)for(var p=0;p<u[l].rows.length;p++){var f=JSON.parse(u[l].rows.item(p)[d.MetadataFields.JSON]);t.checkApplicationMetadata(f)&&c.push(f)}return c}))).apply(this,arguments)}function _(e,t,r,n){return R.apply(this,arguments)}function R(){return(R=h((function*(e,t,r,n){for(var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},s=i.commonEventParameters||[],u=[],c="",l=0;l<r.length;l++)c+=" ?,";c.length>0&&(c=c.substr(0,c.length-1));var p={sqlStatements:[],sqlParameters:[]},f="SELECT ".concat(d.MetadataFields.JSON," FROM ").concat(d.APPLICATION_METADATA_STORE," WHERE ").concat(t.get_path()," IN (").concat(c,")");p.sqlStatements.push(f),p.sqlParameters.push([...r]);var h=yield Object(o.getBatchSqlResults)(e,p,i);if(P(e,h),!Object(a.isNullOrUndefined)(h)&&h.length>0)for(var m=0;m<h[0].rows.length;m++){var y=JSON.parse(h[0].rows.item(m)[d.MetadataFields.JSON]);u.push(y)}else n.warn("".concat(I()," result returned form getBatchSQLResult is empty in retrieveMultipleApplicationMetadataByKeys}"),s);return u}))).apply(this,arguments)}function P(e,t){Object(c.shouldCacheMetadataRows)(e)&&!Object(a.isNullOrUndefined)(t)&&Array.isArray(t)&&t.length>0&&(Object(a.isNullOrUndefined)(e.AdditionalParameters)&&(e.AdditionalParameters={}),!Object(a.isNullOrUndefined)(e.AdditionalParameters.response)&&Array.isArray(e.AdditionalParameters.response)?e.AdditionalParameters.response=e.AdditionalParameters.response.push(...t):e.AdditionalParameters.response=t)}function I(e){return"[".concat(e||i.FILE_PREFIX.DataSQLExecutor,"]")}},9114:function(e,t,r){"use strict";r.r(t),r.d(t,"getSQLResponsesForSingleRequest",(function(){return T})),r.d(t,"getSQLResponsesForBatchRequest",(function(){return C})),r.d(t,"SQLRequestInterceptor",(function(){return g})),r.d(t,"shouldCacheMetadataRows",(function(){return b}));var n=r(9045),a=r(9058),i=r(9050),o=r(9056),s=r(9077),u=r(9047),c=r(9061),l=r(9060),d=r(9115),p=r(9099),f=r(9122),h=r(9104),m=r(9111);function y(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function v(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){y(i,n,a,o,s,"next",e)}function s(e){y(i,n,a,o,s,"throw",e)}o(void 0)}))}}class g extends p.Interceptor{intercept(e){var t=this;return v((function*(){var r,n,i,s=e.executionContext||{},l=e.request,d=s.requestType||Object(c.getRequestType)(l,t.applicationContext),p=t.applicationContext.TraceManager.getTracer(u.COMPONENT_NAMES.LocalODataExecutor),m=[],y="Query Generator",v="",g=s.commonEventParameters||[],E=[];try{if(s.performanceControl&&s.performanceControl.startMarker(u.FILE_PREFIX.SQLGenerator),r=yield Object(f.ExecuteOfflineSqlGenerator)(l,t.applicationContext,s),s.performanceControl&&s.performanceControl.endMarker(u.FILE_PREFIX.SQLGenerator),r){if(Array.isArray(r)){var b=r;if(0===b.length)return Object(h.generateEmptyResponse)(l,d,t.applicationContext,s);y="SQL Executor",p.info("".concat(O()," Query Generator Completed. SQL Executor is processing"),Object(a.addEventParameters)(g,E)),m=yield C(l,b,s,t.applicationContext,p,Object(a.addEventParameters)(g,E)),i=function(e){for(var t=[],r=0;r<e.length;r++){var n,a=e[r];(n=a.additionalParameters)?t.push(n):t.push(void 0)}return t}(b)}else{var S=r;if(!S.sqlStatements||0===S.sqlStatements.length)return Object(h.generateEmptyResponse)(l,d,t.applicationContext,s);y="SQL Executor",p.info("".concat(O()," Query Generator Completed. SQL Executor is processing"),Object(a.addEventParameters)(g,E)),i=S.additionalParameters,m=yield T(l,d,S,s,t.applicationContext,p,Object(a.addEventParameters)(g,E))}m?(y="Response Handler",p.info("".concat(O()," SQL Executor Completed.Response Handler is processing"),E),n=yield Object(h.responseHandler)(l,d,t.applicationContext,m,void 0,i,s)):(v="ExecuteSQLBatch returned empty sql response",p.warn("".concat(O()," ").concat(v),Object(a.addEventParameters)(g,E)),n=yield Object(h.responseHandler)(l,d,t.applicationContext,void 0,void 0,void 0,s))}else p.warn("".concat(O()," ExecuteOfflineSqlGenerator returned empty query, So will return empty response"),Object(a.addEventParameters)(g,E)),n=yield Object(h.responseHandler)(l,d,t.applicationContext,void 0,void 0,void 0,s)}catch(_){v=_&&_.message?_.message:"Unknown";var N=_.code;E.push({name:"OperationStep",value:y}),Object(a.addErrorInformationToEventParameters)(_,E),p.error("".concat(O()," Exception in SQLRequestInterceptor at OperationStep['").concat(y,"'] - ").concat(v),Object(a.addEventParameters)(g,E)),n=yield Object(h.responseHandler)(l,d,t.applicationContext,void 0,new o.LocalError(v,N,_.stack,y),void 0,s)}return p.info("".concat(O()," Exiting SQLRequestInterceptor and returning local OData response"),Object(a.addEventParameters)(g,E)),n}))()}}function O(e){return"[".concat(e||u.FILE_PREFIX.SQLRequestInterceptor,"]")}function E(e,t,r){if(Object(i.isNullOrUndefinedOrEmptyString)(r)||Object(i.isNullOrUndefinedOrEmpty)(e)||Object(i.isNullOrUndefinedOrEmptyString)(t))return!1;var a=s.QueriedMetadataType[r.toLowerCase()],o=[s.QueriedMetadataType.customControl,s.QueriedMetadataType.complexControl,s.QueriedMetadataType.formSelector,s.QueriedMetadataType.viewSelector,s.QueriedMetadataType.ribbon];return t===n.OPERATION.GetClientMetadata&&b(e)&&!Object(i.isNullOrUndefined)(e.AdditionalParameters)&&e.AdditionalParameters.response&&-1!==o.indexOf(a)}function b(e){return!Object(i.isNullOrUndefined)(e.AdditionalParameters)&&!0!==e.AdditionalParameters.EnableOptimizedDependency}function T(e,t,r,n,a,i,o){return S.apply(this,arguments)}function S(){return(S=v((function*(e,t,r,a,o,s,u){var c,l,p;t===n.OPERATION.GetClientMetadata&&(l=Object(d.extractClientMetadataQuery)(e,s,u).MetadataType,u.push({name:"MetadataType",value:l}));var f="true"===(null===(c=e.additionalHeaders)||void 0===c?void 0:c[n.HINT.SUPPRESS_TRIGGERS_HINT]);return E(o,t,l)&&!Object(i.isNullOrUndefined)(o.AdditionalParameters)?p=o.AdditionalParameters.response:(p=yield Object(m.ExecuteSQLBatch)(r,o,t,a,f),f&&p.length>r.sqlStatements.length&&(p.shift(),p.pop())),p}))).apply(this,arguments)}function C(e,t,r,n,a,i){return N.apply(this,arguments)}function N(){return(N=v((function*(e,t,r,i,o,s){var u,d=Object(l.extractIndividualRequests)(e,o,s),p="true"===(null===(u=e.additionalHeaders)||void 0===u?void 0:u[n.HINT.SUPPRESS_TRIGGERS_HINT]),f=r.commonEventParameters||[];if(p){for(var h={sqlStatements:[],sqlParameters:[]},y=0;y<t.length;y++){for(var v=t[y].sqlParameters,g=t[y].sqlParameters.length;g<t[y].sqlStatements.length;g++)v.push([]);h.sqlStatements.push(...t[y].sqlStatements),h.sqlParameters.push(...v)}var E=yield Object(m.ExecuteSQLBatch)(h,i,"CRUD",r,!0),b=[];if(E)for(var T=1,S=0;S<t.length;S++){b.push([]);for(var C=0;C<t[S].sqlStatements.length;C++)E[T]?b[S].push(E[T]):o.error("".concat(O()," No SQL results response for child query ").concat(Object(c.getRequestType)(d[S])," of batch"),Object(a.addEventParameters)(f,s)),T++}return b}for(var N=[],_=0;_<t.length;_++){var R=t[_],P=d[_],I=Object(c.getRequestType)(P);if(R&&R.sqlStatements&&0!==R.sqlStatements.length){var A=Object(m.ExecuteSQLBatch)(R,i,I,r);A?N.push(A):o.error("".concat(O()," No SQL results response for child query ").concat(Object(c.getRequestType)(P)," of batch"),Object(a.addEventParameters)(f,s))}else o.error("".concat(O()," No SQL queries generated for child query ").concat(I," of batch"),Object(a.addEventParameters)(f,s)),N.push(Promise.resolve([]))}return yield Promise.all(N)}))).apply(this,arguments)}},9115:function(e,t,r){"use strict";r.r(t),r.d(t,"generateGCMRequests",(function(){return y})),r.d(t,"extractClientMetadataQuery",(function(){return g})),r.d(t,"appendDependenciesAsCandidates",(function(){return O})),r.d(t,"generateMetadataQueries",(function(){return T}));var n=r(9058),a=r(9050),i=r(9077),o=r(9047),s=r(9112),u=r(9078),c=r(9113),l=r(9116),d=r(9121);function p(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function f(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){p(i,n,a,o,s,"next",e)}function s(e){p(i,n,a,o,s,"throw",e)}o(void 0)}))}}var h=!0,m=[i.QueriedMetadataType.form.toString()];function y(e,t,r){return v.apply(this,arguments)}function v(){return(v=f((function*(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=n.commonEventParameters||[],o=g(e,r,i),s=yield Object(l.findRootNodes)(t,r,o,n);if(r.info("".concat(N()," found root nodes ").concat(Object.keys(s)," for ").concat(o.MetadataType)),h=h&&t.AdditionalParameters&&t.AdditionalParameters.EnableOptimizedDependency,-1!==m.indexOf(o.MetadataType)){if(h)try{var d=yield Object(c.isTableOrViewPopulated)(t,u.APPLICATION_METADATA_DEPENDENCY_VIEW,n);d||(h=!1,r.warn("".concat(N()," Dependency view is empty, continuing without optimizing dependencies")))}catch(p){h=!1,r.warn("".concat(N()," Error validating the dependency view, continuing without optimizing dependencies: ").concat(Object(a.getErrorMessage)(p)))}if(h&&b(s))try{yield O(t,s,o.EntityLogicalName,r,n)}catch(p){h=!1,r.warn("".concat(N()," Error retrieving dependencies, continuing without optimizing dependencies: ").concat(Object(a.getErrorMessage)(p)))}}return Object(a.isNullOrUndefinedOrEmpty)(s)?{sqlStatements:[],sqlParameters:[]}:yield T(s,r,i,h&&-1!==m.indexOf(o.MetadataType))}))).apply(this,arguments)}function g(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=[],o=e.url.match(/@ClientMetadataQuery=(.*\})/i);if(i.push({name:"url",value:e.url}),Object(a.isNullOrUndefined)(o)){var s="URL does not have a ClientMetadataQuery param";throw t.error("".concat(N()," ").concat(s),Object(n.addEventParameters)(r,i)),new Error(s)}var u=JSON.parse(decodeURIComponent(o[1]));return u}function O(e,t,r,n){return E.apply(this,arguments)}function E(){return(E=f((function*(e,t,r,n){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},s=Object.keys(t).filter(e=>!t[e].dependenciesFetched),u=s.map(e=>Object(d.createLocalStoreId)(r,i.MetadataType.dependencies,t[e].sourceId,"")),l=yield Object(c.retrieveMultipleApplicationMetadata)(e,u,void 0,o);if(l.length<u.length){var p=l.map(e=>e.id),f=u.filter(e=>-1===p.indexOf(e));n.warn("".concat(N()," Requested ").concat(u.length," dependency records, found ").concat(l.length," dependency records: ").concat(f))}for(var h of s)t[h].dependenciesFetched=!0;for(var m in l)if(!Object(a.isNullOrUndefinedOrEmpty)(l[m])&&!Object(a.isNullOrUndefinedOrEmpty)(l[m].data)){var y=l[m];for(var v of y.data.children)t.hasOwnProperty(v)||(t[v]={dependenciesFetched:!0,queryGenerated:!1,sourceId:v,metadataType:i.MetadataType.none})}}))).apply(this,arguments)}function b(e){return Object.keys(e).some(t=>!e[t].dependenciesFetched)}function T(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=arguments.length>3?arguments[3]:void 0,i={sqlStatements:[],sqlParameters:[]},o=[];if(n)C(e,i,t,r);else for(var s in e)if(!Object(a.isNullOrUndefined)(e[s])){var c=e[s];S(c,i,o,t,r)}return t.info("".concat(N()," Returning ").concat(i.sqlStatements.length," queries")),Object(a.isNullOrUndefined)(i.additionalParameters)&&(i.additionalParameters={}),i.additionalParameters[u.MetadataFields.METADATA_TYPE]=o,i}function S(e,t,r,n){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];e.metadataType===i.MetadataType.userContext?(r.push(e.metadataType),t.sqlStatements.push("SELECT ".concat(u.MetadataFields.JSON," FROM ").concat(u.USER_CONTEXT_STORE," WHERE ").concat(s.id," = ?")),t.sqlParameters.push([e.id?e.id:u.USER_CONTEXT_KEY])):e.metadataType===i.MetadataType.entity?Object(a.isNullOrUndefinedOrEmptyString)(e.id)?n.warn("".concat(N()," No ID found for candidate of type entity metadata. Skipping query generation"),o):(r.push(e.metadataType),t.sqlStatements.push("SELECT ".concat(s.id,", ").concat(u.MetadataFields.JSON," FROM [").concat(u.ENTITY_METADATA_STORE,"] WHERE [").concat(s.logicalName,"] = ?")),t.sqlParameters.push([e.id])):Object(a.isNullOrUndefinedOrEmptyString)(e.id)?n.warn("".concat(N()," Invalid candidate - no ID found for candidate ").concat(e.metadataType,". Skipping query generation"),o):(r.push(e.metadataType),t.sqlStatements.push("SELECT ".concat(u.MetadataFields.METADATA_TYPE,", ").concat(u.MetadataFields.JSON," FROM ").concat(u.APPLICATION_METADATA_STORE," WHERE ").concat(s.id," = ?")),t.sqlParameters.push([e.id]))}function C(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],o="SELECT ".concat(u.MetadataFields.METADATA_TYPE,", ").concat(u.MetadataFields.JSON," FROM ").concat(u.APPLICATION_METADATA_DEPENDENCY_VIEW," WHERE ").concat(s.id," IN ("),c=")",l=new Set;for(var d in e)if(!Object(a.isNullOrUndefined)(e[d])){var p=e[d];p.metadataType===i.MetadataType.userContext?(t.sqlStatements.push("SELECT ".concat(u.MetadataFields.JSON," FROM ").concat(u.USER_CONTEXT_STORE," WHERE ").concat(s.id," = ?")),t.sqlParameters.push([p.id?p.id:u.USER_CONTEXT_KEY])):Object(a.isNullOrUndefinedOrEmptyString)(p.sourceId)?Object(a.isNullOrUndefinedOrEmptyString)(p.id)?r.error("".concat(N()," Invalid candidate - no ID or source ID for candidate ").concat(p.metadataType,". Skipping query generation"),n):(o+=l.size>0?",?":"?",l.add(p.id)):(o+=l.size>0?",?":"?",l.add(p.sourceId))}l.size>0&&(o+=c,t.sqlStatements.push(o),t.sqlParameters.push([...l]))}function N(e){return"[".concat(e||o.FILE_PREFIX.GCMGenerator,"]")}},9116:function(e,t,r){"use strict";r.r(t),r.d(t,"findRootNodes",(function(){return S}));var n=r(9045),a=r(9058),i=r(9050),o=r(9056),s=r(9077),u=r(9047),c=r(9065),l=r(9057),d=r(9046),p=r(9049),f=r(9054),h=r(9063),m=r(9078),y=r(9113),v=r(9117),g=r(9118),O=r(9120),E=r(9121);function b(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function T(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){b(i,n,a,o,s,"next",e)}function s(e){b(i,n,a,o,s,"throw",e)}o(void 0)}))}}function S(e,t,r){return C.apply(this,arguments)}function C(){return(C=T((function*(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=n.commonEventParameters||[],s=[];s.push({name:"ClientMetadataQuery",value:JSON.stringify(r)});try{var u=yield I(e,t,r,n);return N(t,u,r,o)}catch(c){if(Object(a.addErrorInformationToEventParameters)(c,s),t.error("".concat(me()," Error when attempting to find root nodes."),Object(a.addEventParameters)(o,s)),(yield Object(f.isFeatureEnabled)(e,h.FCB_CONSTANTS.ModernDataLayerMatchServerGCM))&&!Object(i.isNullOrUndefined)(c.code))throw c}return{}}))).apply(this,arguments)}function N(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a={};for(var i of t)if(Array.isArray(i))for(var o of i)_(e,o,a,n);else _(e,i,a,n);return e.info("".concat(me()," found ").concat(Object.keys(a).length," root nodes for ").concat(r.MetadataType,":").concat(r.MetadataSubtype)),a}function _(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a="",o="",u=s.MetadataType.none,c=!0;if(R(t))u=(t=t).metadatatype,o=t.id,Object(i.isNullOrUndefinedOrEmptyString)(t.sourceid)||(c=!1,a=t.sourceid);else if(P(t))o=m.USER_CONTEXT_KEY,u=s.MetadataType.userContext;else{if(!(t=t).get_id||Object(i.isNullOrUndefined)(t.get_id()))return void e.error("".concat(me()," Entity Descriptor with missing ID found"),n);o=t.get_logicalName&&!Object(i.isNullOrUndefined)(t.get_logicalName())?t.get_logicalName():"",u=s.MetadataType.entity}r[o]={dependenciesFetched:c,queryGenerated:!1,sourceId:a,id:o,metadataType:u}}function R(e){return Object.keys(e).indexOf("metadatatype")>=0}function P(e){return Object.keys(e).indexOf("userid")>=0}function I(e,t,r,n){return A.apply(this,arguments)}function A(){return(A=T((function*(e,t,r,n){var a=Object(v.getLegacyMetadataTypeForQuery)(r.MetadataType,r.MetadataSubtype),o=a.subtype,u=a.type,c="";return r.MetadataId&&(c=r.MetadataId.toString()),r.MetadataType===s.QueriedMetadataType.entity?F(e,r,t,n.commonEventParameters):r.MetadataType===s.QueriedMetadataType.savedView||r.MetadataType===s.QueriedMetadataType.form||r.MetadataType===s.QueriedMetadataType.workspace||r.MetadataType===s.QueriedMetadataType.systemWorkspace||r.MetadataType===s.QueriedMetadataType.userWorkspace||r.MetadataType===s.QueriedMetadataType.savedVisualization?ie(e,t,r,n):r.MetadataType===s.QueriedMetadataType.dialog||r.MetadataType===s.QueriedMetadataType.taskBasedFlow?D(e,u,r,t,n):(u===s.MetadataType.resourceString||u===s.MetadataType.label)&&r.MetadataNames&&r.MetadataNames.length>0?k(e,u,r,t,n):(u===s.MetadataType.optionSet||u===s.MetadataType.webResource||u===s.MetadataType.webResourceDescriptor||u===s.MetadataType.complexControl)&&r.MetadataNames&&r.MetadataNames.length>0?H(e,u,r,t,n):u===s.MetadataType.command&&r.MetadataNames&&r.MetadataNames.length>0?Q(e,r,t,n):u!==s.MetadataType.appModule||Object(i.isNullOrUndefinedOrEmptyString)(c)?u===s.MetadataType.appModuleOfflineMetadata?V(e,t,n):!Object(i.isNullOrUndefinedOrEmptyString)(c)||u!==s.MetadataType.resourceString&&r.MetadataNames&&r.MetadataNames.length>0||u===s.MetadataType.taskBasedFlowGlobalMenu||u===s.MetadataType.quickCreateMenu||u===s.MetadataType.searchConfiguration||u===s.MetadataType.siteMap?J(e,u,r,t,n):u===s.MetadataType.isActivityFlags?Y(e,t,n):u===s.MetadataType.viewSelector?$(e,u,o,r,t,n):u===s.MetadataType.homePageConfiguration?te(e,r,t,n):u===s.MetadataType.none&&o===s.MetadataSubtype.none&&Object(i.isNullOrUndefinedOrEmptyString)(r.EntityLogicalName)&&m.LegacyDependencyDepth[r.DependencyDepth]===m.LegacyDependencyDepth.UserContext?[{userid:d.Guid.EMPTY}]:ne(e,u,o,r,t,n):X(e,r,t,n)}))).apply(this,arguments)}function D(e,t,r,n,a){return M.apply(this,arguments)}function M(){return(M=T((function*(e,t,r,n,o){var u=o.commonEventParameters||[],c=[],l=[];if(!Object(i.isNullOrUndefined)(r.MetadataNames)&&r.MetadataNames.length>0)for(var d=r.MetadataNames,p=0;p<d.length;++p){var f=Object(E.createLocalStoreId)("",t,"",d[p]),h=yield Object(y.retrieveApplicationMetadata)(e,f,void 0,o);if((l=[]).push({name:"MetadataType",value:s.MetadataType[t]}),l.push({name:"DialogKey",value:f}),h){c.push(h);var m=h.data.FormId,v=Object(E.createLocalStoreId)("",s.MetadataType.form,m,""),g=yield Object(y.retrieveApplicationMetadata)(e,v,void 0,o);g?c.push(g):(l.push({name:"FormKey",value:v}),n.warn("".concat(me()," Unable to find dependent form metadata for dialog: ").concat(f," form: ").concat(v," for type ").concat(s.MetadataType[t]),Object(a.addEventParameters)(u,l)))}else n.error("".concat(me()," Unable to find the dialog root ").concat(f," for type ").concat(s.MetadataType[t]),Object(a.addEventParameters)(u,l))}else n.error("".concat(me()," Dialog metadata requested without MetadataNames"),Object(a.addEventParameters)(u,l));return c}))).apply(this,arguments)}function F(e,t,r){return w.apply(this,arguments)}function w(){return(w=T((function*(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],o=[],s=t.MetadataSubtype.replace(/\\\"/g,'"'),u=JSON.parse(s),c=[],l=Object.keys(u);for(var d of(o.push({name:"Entities",value:null==l?void 0:l.join(",")}),l))c.push(L(e,d,r,n));for(var p=[],f={},h=0;h<(null==l?void 0:l.length);h++)try{var m=yield c[h];if(void 0===m)throw new Error;p.push(m)}catch(y){f[l.push[h]]=Object(i.getErrorMessage)(y)}return Object.keys(f).length>0&&(o.push({name:"MissingEntities",value:JSON.stringify(f)}),r.warn("".concat(me()," Could not fetch metadata for ").concat(Object.keys(f).length," entities. Other entities in the query may return results"),Object(a.addEventParameters)(n,o))),p}))).apply(this,arguments)}function L(e,t,r){return j.apply(this,arguments)}function j(){return(j=T((function*(e,t,r){var n,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=yield x(e,t,a);if(!i||!i.length){var o="requested entity metadata not found for entity = ".concat(t);throw new Error(o)}if(i[0].rows&&i[0].rows.length>0){var s=i[0].rows.item(0),u=JSON.parse(s.json),l=c.EntityMetadata.createFromObjectData(u);n=l}else r.warn("".concat(me()," Got 0 result rows for entity metadata ").concat(t),a);return n}))).apply(this,arguments)}function x(e,t){return U.apply(this,arguments)}function U(){return(U=T((function*(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n="SELECT id, json FROM [entitymetadata] WHERE [logicalname] = ?",a=[t],i=yield Object(l.getSqlResults)(e,n,a,r);return i}))).apply(this,arguments)}function k(e,t,r,n,a){return q.apply(this,arguments)}function q(){return(q=T((function*(e,t,r,n,i){var o=i.commonEventParameters||[],u=[];r.MetadataNames=se(r.MetadataNames);var c=[];for(var l of r.MetadataNames)if(u=[],t===s.MetadataType.label){var d=l.split(":");d&&2===d.length?c.push(Object(E.createLocalStoreId)("",t,d[0],d[1])):(u.push({name:"MetadataName",value:l}),n.error("".concat(me()," Invalid label name ").concat(l),Object(a.addEventParameters)(o,u)))}else c.push(Object(E.createLocalStoreId)("",t,"",l));var p=t===s.MetadataType.resourceString;if(0===c.length)return[];var f=yield Object(y.retrieveMultipleApplicationMetadataByKeys)(e,O.KeyPath.get_id(),c,n,i);if(p&&f.length!==c.length){var h=ue(r,f);u.push({name:"MissingKeys",value:h}),n.info("".concat(me()," Not able to find ").concat(c.length-f.length," keys out of ").concat(c.length," of type ").concat(s.MetadataType[t],", Missing Keys ").concat(h),Object(a.addEventParameters)(o,u))}return f}))).apply(this,arguments)}function V(e,t,r){return B.apply(this,arguments)}function B(){return(B=T((function*(e,t,r){var n=r.commonEventParameters||[],a=Object(E.createLocalStoreId)("",s.MetadataType.appModuleOfflineMetadata,"","",0);try{var i=yield Object(y.retrieveApplicationMetadata)(e,a,void 0,r);return i?[i]:[]}catch(o){throw t.error("".concat(me()," Error when attempting to retrieve application metadata for type ").concat(s.MetadataType[s.MetadataType.appModuleOfflineMetadata]," ").concat(a," ").concat(o.message),n),o}}))).apply(this,arguments)}function H(e,t,r,n,a){return G.apply(this,arguments)}function G(){return(G=T((function*(e,t,r,n,o){var u=o.commonEventParameters||[],c=[];for(var l of r.MetadataNames){var d=Object(E.createLocalStoreId)(r.EntityLogicalName,t,"",l),p=[];p.push({name:"MetadataIdString",value:d});try{var f=yield Object(y.retrieveApplicationMetadata)(e,d,void 0,o);p.push({name:"MetadataType",value:s.MetadataType[t]}),Object(i.isNullOrUndefinedOrEmpty)(f)?n.error("".concat(me()," Not able to find some of the keys for type ").concat(s.MetadataType[t]," ").concat(d),Object(a.addEventParameters)(u,p)):c.push(f)}catch(h){throw n.error("".concat(me()," ").concat(h.message||"Failed to Retrieve resource metadata"),Object(a.addEventParameters)(u,p)),h}}return c}))).apply(this,arguments)}function Q(e,t,r,n){return z.apply(this,arguments)}function z(){return(z=T((function*(e,t,r,n){var o=n.commonEventParameters||[],u=Object(E.createLocalStoreId)(t.EntityLogicalName,s.MetadataType.command,"",t.MetadataNames[0]),c=[];c.push({name:"MetadataIdString",value:u});try{var l=yield Object(y.retrieveApplicationMetadata)(e,u,void 0,n);return Object(i.isNullOrUndefinedOrEmpty)(l)?(r.error("".concat(me()," Not able to find the key ").concat(u," for type ").concat(s.MetadataType[s.MetadataType.command]),Object(a.addEventParameters)(o,c)),[]):[l]}catch(d){throw r.error("".concat(me()," Error when retrieving command metadata ").concat(t.MetadataNames[0]),Object(a.addEventParameters)(o,c)),d}}))).apply(this,arguments)}function X(e,t,r,n){return W.apply(this,arguments)}function W(){return(W=T((function*(e,t,r,n){var o=n.commonEventParameters||[],u=t.AppId&&t.AppId!==p.LegacyGuid.get_empty().toString()?t.AppId.toString():t.MetadataId.toString(),c=Object(E.createLocalStoreId)(t.EntityLogicalName,s.MetadataType.appModule,Object(i.isNullOrUndefinedOrEmptyString)(t.MetadataId)?"":t.MetadataId.toString(),Object(i.isNullOrUndefined)(t.MetadataNames)?"":t.MetadataNames[0],0,u),l=[];l.push({name:"MetadataIdString",value:c});try{var d=yield Object(y.retrieveApplicationMetadata)(e,c,void 0,n);return Object(i.isNullOrUndefinedOrEmpty)(d)?(r.error("".concat(me()," Not able to find the key ").concat(c," for type ").concat(s.MetadataType[s.MetadataType.appModule]),Object(a.addEventParameters)(o,l)),[]):[d]}catch(f){throw r.error("".concat(me()," Error when retrieving app module metadata for appID: ").concat(u,". ").concat(f.message),Object(a.addEventParameters)(o,l)),f}}))).apply(this,arguments)}function Y(e,t,r){return K.apply(this,arguments)}function K(){return(K=T((function*(e,t,r){var n=r.commonEventParameters||[],o=Object(E.createLocalStoreId)("",s.MetadataType.isActivityFlags,"",m.ENTITY_DEFINITIONS_TYPE),u=[];u.push({name:"MetadataIdString",value:o});try{var c=yield Object(y.retrieveApplicationMetadata)(e,o,void 0,r);if(Object(i.isNullOrUndefinedOrEmpty)(c)){var l="GetClientMetadata: Not able to find the key ".concat(o," for type ").concat(s.MetadataType[s.MetadataType.isActivityFlags]);throw t.error("".concat(me()," ").concat(l),Object(a.addEventParameters)(n,u)),new Error(l)}return[c]}catch(d){throw t.error("".concat(me()," Error when retrieving activity flag metadata. ").concat(d.message),Object(a.addEventParameters)(n,u)),d}}))).apply(this,arguments)}function J(e,t,r,n,a){return Z.apply(this,arguments)}function Z(){return(Z=T((function*(e,t,r,u,c){var l=c.commonEventParameters||[],d="",f=[];r.MetadataId&&(d=r.MetadataId.toString());var h=r.AppId&&r.AppId!==p.LegacyGuid.get_empty().toString()?r.AppId.toString():void 0;d=Object(E.createLocalStoreId)(r.EntityLogicalName,t,d,Object(i.isNullOrUndefined)(r.MetadataNames)?"":r.MetadataNames[0],0,h),f.push({name:"MetadataIdString",value:d}),f.push({name:"AppId",value:h||""});try{var m=yield Object(y.retrieveApplicationMetadata)(e,d,void 0,c);if(Object(i.isNullOrUndefinedOrEmpty)(m)){var v=new o.LocalError("Not able to find the key ".concat(d," for type ").concat(s.MetadataType[t]),n.ErrorCode.DataStoreKeyNotFoundErrorCode);return u.error("".concat(me()," ").concat(v.message),Object(a.addEventParameters)(l,f)),[]}return[m]}catch(v){throw u.error("".concat(me()," Error when attempting to retrieve application metadata for type ").concat(s.MetadataType[t]," ").concat(d," ").concat(v.message),Object(a.addEventParameters)(l,f)),v}}))).apply(this,arguments)}function $(e,t,r,n,a,i){return ee.apply(this,arguments)}function ee(){return(ee=T((function*(e,t,r,n,o,u){var c=u.commonEventParameters||[],l=[],d=n.AppId&&n.AppId!==p.LegacyGuid.get_empty().toString()?n.AppId.toString():n.MetadataId?n.MetadataId.toString():void 0,f=Object(E.createLocalStoreId)(n.EntityLogicalName,s.MetadataType.viewSelector,"","",r,d);l.push({name:"MetadataIdString",value:f}),l.push({name:"AppId",value:d||""});try{var h=yield Object(y.retrieveApplicationMetadata)(e,f,void 0,u);return Object(i.isNullOrUndefinedOrEmpty)(h)?(o.error("".concat(me()," Not able to find the key ").concat(f," for type ").concat(s.MetadataType[t]),Object(a.addEventParameters)(c,l)),[]):[h]}catch(m){throw o.error("".concat(me()," Error when retrieving view selector metadata for entity ").concat(n.EntityLogicalName," and appid ").concat(d,". ").concat(m.message),Object(a.addEventParameters)(c,l)),m}}))).apply(this,arguments)}function te(e,t,r,n){return re.apply(this,arguments)}function re(){return(re=T((function*(e,t,r,n){var o=n.commonEventParameters||[],u=Object(E.createLocalStoreId)(t.EntityLogicalName,s.MetadataType.homePageConfiguration,"","",0,""),c=[];c.push({name:"MetadataIdString",value:u});try{var l=yield Object(y.retrieveApplicationMetadata)(e,u,void 0,n);return Object(i.isNullOrUndefinedOrEmpty)(l)?(r.error("".concat(me()," Not able to find the key ").concat(u," for type ").concat(s.MetadataType[s.MetadataType.homePageConfiguration]),Object(a.addEventParameters)(o,c)),[]):[l]}catch(d){throw r.error("".concat(me()," Error when retrieving home page configuration metadata. ").concat(d.message),Object(a.addEventParameters)(o,c)),d}}))).apply(this,arguments)}function ne(e,t,r,n,a,i){return ae.apply(this,arguments)}function ae(){return(ae=T((function*(e,t,r,n,a,i){var o=i.commonEventParameters||[],u="";n.MetadataId&&(u=n.MetadataId.toString());var c=new g.ApplicationMetadataQuery(t,m.FormFactor.Desktop,n.EntityLogicalName,0,n.GetDefault,u,r,void 0);try{var l=yield Object(y.retrieveMultipleApplicationMetadataByQuery)(e,c,a,i);return l&&l.length?l:(a.warn("".concat(me()," Not able to find the key ").concat(u," for type ").concat(s.MetadataType[t]),o),[])}catch(d){throw a.error("".concat(me()," error retrieving metadata by query for ").concat(u,". ").concat(d.message),o),d}}))).apply(this,arguments)}function ie(e,t,r,n){return oe.apply(this,arguments)}function oe(){return(oe=T((function*(e,t,r,n){var a=n.commonEventParameters||[],o=m.METADATA_TYPE_TO_KEYS[r.MetadataType];if(!Object(i.isNullOrUndefined)(r.MetadataId)||r.MetadataNames&&r.MetadataNames.length){if(m.LegacyDependencyDepth[r.DependencyDepth]===m.LegacyDependencyDepth.OnDemandWithContext){var u=yield Promise.all(ce(e,t,r,o,n));return yield fe(e,t,u,o,a)}var c=o.slice(1,o.length),l=de(e,r,c,t,n),d=yield Promise.all(l);return yield fe(e,t,d,c,a)}if(Object(i.isNullOrUndefined)(r.GetDefault)||!r.GetDefault)throw new Error("A query with empty MetadataId and non-true GetDefault parameters is considered invalid.");if(Object(i.isNullOrUndefined)(r.EntityLogicalName)&&r.MetadataType!==s.QueriedMetadataType.workspace&&r.MetadataType!==s.QueriedMetadataType.systemWorkspace&&r.MetadataType!==s.QueriedMetadataType.userWorkspace)throw new Error("This query requests defaults and/or selectors, but does not specify the context. This query is considered invalid.");return Promise.all(ce(e,t,r,o,n)).then(e=>{if(Object(i.isNullOrUndefined)(e)||e.length<2)throw new Error("The local store does not contain metadata fragments or selectors for the specified query.");var t=e[0][0],n=o[0],a=pe(t);if(Object(i.isNullOrUndefined)(a))throw new Error("The default selector item cannot be found.");for(var s=[],u=1;u<e.length;++u)for(var c=e[u],l=o[u],d=0;d<c.length;d++){var p=c[d];a[n.uniqueKey]===p.data[l.uniqueKey]&&s.push(p)}return m.LegacyDependencyDepth[r.DependencyDepth]===m.LegacyDependencyDepth.OnDemandWithContext&&s.push(t),s})}))).apply(this,arguments)}function se(e){e.sort();var t=[],r="";for(var n of e)n!==r&&(r=n,t.push(n));return t}function ue(e,t){var r=t.filter(e=>e).map(e=>e.data.Key),n="";for(var a of e.MetadataNames){var o=!1;for(var s of r)if(a===s){o=!0;break}o||(n=Object(i.isNullOrUndefinedOrEmptyString)(n)?a:n+", "+a)}return n}function ce(e,t,r,n,a){var o=Object(v.getLegacySubtype)(r.MetadataType,r.MetadataSubtype),u=n[0],c=[];if(Object(i.isNullOrUndefined)(r.EntityLogicalName)&&r.MetadataType!==s.QueriedMetadataType.workspace&&r.MetadataType!==s.QueriedMetadataType.systemWorkspace&&r.MetadataType!==s.QueriedMetadataType.userWorkspace){var l=new g.ApplicationMetadataQuery(u.metadataType,m.FormFactor.Desktop,"",0,!1,"",o),d=Object(y.retrieveMultipleApplicationMetadataByQuery)(e,l,t,a);c.push(d)}else{var f=Object(E.createLocalStoreId)(r.EntityLogicalName,u.metadataType,"","",o,r.AppId&&r.AppId!==p.LegacyGuid.get_empty().toString()?r.AppId.toString():void 0);c.push(function(e,t,r,n,a){return le.apply(this,arguments)}(e,t,f,u.metadataType,a))}return c=de(e,r,n.slice(1,n.length),t,a,c)}function le(){return(le=T((function*(e,t,r,n,a){var o=a.commonEventParameters||[];try{var u=yield Object(y.retrieveApplicationMetadata)(e,r,void 0,a);return Object(i.isNullOrUndefinedOrEmpty)(u)?(t.error("".concat(me()," Not able to find the key ").concat(r," for type ").concat(s.MetadataType[n]),o),[]):[u]}catch(c){throw t.error("".concat(me()," Error when retrieving application metadata for id ").concat(r,". ").concat(c.message),o),c}}))).apply(this,arguments)}function de(e,t,r,n,a,o){Object(i.isNullOrUndefined)(o)&&(o=[]);for(var s=Object(v.getLegacySubtype)(t.MetadataType,t.MetadataSubtype),u=0;u<r.length;++u){var c=r[u].metadataType,l=t.MetadataId?new g.ApplicationMetadataQuery(c,m.FormFactor.Desktop,t.EntityLogicalName,0,!1,t.MetadataId.toString()):new g.ApplicationMetadataQuery(c,m.FormFactor.Desktop,t.EntityLogicalName,0,!1,void 0,s);o.push(Object(y.retrieveMultipleApplicationMetadataByQuery)(e,l,n,a))}return o}function pe(e){var t=e.data.SelectorItems;if(!Object(i.isNullOrUndefined)(t)&&t.length>0){for(var r=0;r<t.length;r++){var n=t[r];if(n.IsDefault)return n}return t[0]}return{}}function fe(e,t,r,n){return he.apply(this,arguments)}function he(){return(he=T((function*(e,t,r,s){var u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],c=[];if(Object(i.isNullOrUndefined)(r)||!r.length){var l=new o.LocalError("The local store does not contain metadata fragments or selectors for the specified query.",n.ErrorCode.DataStoreKeyNotFoundErrorCode);if(t.error("".concat(me()," ").concat(l.message),Object(a.addEventParameters)(u,c)),yield Object(f.isFeatureEnabled)(e,h.FCB_CONSTANTS.ModernDataLayerMatchServerGCM))throw l;return[]}for(var d=[],p=[],m=0;m<r.length;++m)for(var y=r[m],v=s[m],g=0;g<y.length;g++){var O=y[g];d.push(O),p.push(v.payloadKey)}for(var E=0;E<s.length;++E){var b=s[E];if((c=[]).push({name:"PayLoadKey",value:b.payloadKey}),-1===p.indexOf(b.payloadKey)){var T=new o.LocalError("The local store does not contain ".concat(b.payloadKey," requested metadata."),n.ErrorCode.DataStoreKeyNotFoundErrorCode);if(t.warn("".concat(me()," ").concat(T.message),Object(a.addEventParameters)(u,c)),yield Object(f.isFeatureEnabled)(e,h.FCB_CONSTANTS.ModernDataLayerMatchServerGCM))return t.info("".concat(me()," Returning empty array to match server response for selectable metadata"),Object(a.addEventParameters)(u,c)),[];throw T}}return d}))).apply(this,arguments)}function me(e){return"[".concat(e||u.FILE_PREFIX.RootFinder,"]")}},9117:function(e,t,r){"use strict";r.r(t),r.d(t,"getLegacyMetadataTypeForQuery",(function(){return i})),r.d(t,"getLegacySubtype",(function(){return o}));var n=r(9050),a=r(9077);function i(e,t){switch(e){case"form":return{type:a.MetadataType.form,subtype:o("form",t)};case"workspace":case"systemworkspace":case"userworkspace":return{type:a.MetadataType.workspace,subtype:o(e,"dashboard")};case"formselector":return{type:a.MetadataType.formSelector,subtype:o(e,t)};case"bpfselector":return{type:a.MetadataType.bpfSelector,subtype:a.MetadataSubtype.none};case"dashboardselector":return{type:a.MetadataType.dashboardSelector,subtype:o(e,"dashboard")};case"search":return{type:a.MetadataType.searchConfiguration,subtype:a.MetadataSubtype.none};case"customcontrol":return{type:a.MetadataType.customControl,subtype:a.MetadataSubtype.none};case"resourcestring":return{type:a.MetadataType.resourceString,subtype:a.MetadataSubtype.none};case"visualizationselector":return{type:a.MetadataType.visualizationSelector,subtype:a.MetadataSubtype.none};case"savedvisualization":return{type:a.MetadataType.savedQueryVisualization,subtype:a.MetadataSubtype.none};case"uservisualization":return{type:a.MetadataType.userQueryVisualization,subtype:a.MetadataSubtype.none};case"label":return{type:a.MetadataType.label,subtype:a.MetadataSubtype.none};case"displaystring":return{type:a.MetadataType.displayString,subtype:a.MetadataSubtype.none};case"webresource":return{type:a.MetadataType.webResource,subtype:o(e,t)};case"webresourcedescriptor":return{type:a.MetadataType.webResourceDescriptor,subtype:a.MetadataSubtype.none};case"customcontroldefaultconfig":return{type:a.MetadataType.homePageConfiguration,subtype:a.MetadataSubtype.none};case"optionset":return{type:a.MetadataType.optionSet,subtype:a.MetadataSubtype.none};case"quickcreatemenu":return{type:a.MetadataType.quickCreateMenu,subtype:a.MetadataSubtype.none};case"businessprocessflow":return{type:a.MetadataType.businessProcessFlow,subtype:a.MetadataSubtype.none};case"dialog":return{type:a.MetadataType.dialog,subtype:a.MetadataSubtype.none};case"taskbasedflow":return{type:a.MetadataType.taskBasedFlow,subtype:a.MetadataSubtype.none};case"taskbasedflowglobalmenu":return{type:a.MetadataType.taskBasedFlowGlobalMenu,subtype:a.MetadataSubtype.none};case"sitemap":return{type:a.MetadataType.siteMap,subtype:a.MetadataSubtype.none};case"viewselector":return{type:a.MetadataType.viewSelector,subtype:o(e,t)};case"savedview":return{type:a.MetadataType.savedView,subtype:o(e,t)};case"userview":return{type:a.MetadataType.userView,subtype:o(e,t)};case"ribbon":return{type:a.MetadataType.command,subtype:a.MetadataSubtype.none};case"appmodules":return{type:a.MetadataType.appModule,subtype:a.MetadataSubtype.none};case"appmoduleselector":return{type:a.MetadataType.appModuleSelector,subtype:a.MetadataSubtype.none};case"metadataversion":return{type:a.MetadataType.overallMetadataVersion,subtype:a.MetadataSubtype.none};case"complexcontrol":return{type:a.MetadataType.complexControl,subtype:a.MetadataSubtype.none};case"isactivityflags":return{type:a.MetadataType.isActivityFlags,subtype:a.MetadataSubtype.none};case"appmoduleofflinemetadata":return{type:a.MetadataType.appModuleOfflineMetadata,subtype:a.MetadataSubtype.none};case"dependencies":return{type:a.MetadataType.dependencies,subtype:a.MetadataSubtype.none};default:return{type:a.MetadataType.none,subtype:a.MetadataSubtype.none}}}function o(e,t){var r;switch(e){case"form":case"formselector":case"dashboardselector":r=function(e){var t=a.MetadataSubtype.none;if(!Object(n.isNullOrUndefined)(e))switch(e.toLowerCase()){case"appointmentbook":t=a.MetadataSubtype.appointment;break;case"hardcoded":t=a.MetadataSubtype.hardcoded;break;case"main":t=a.MetadataSubtype.main;break;case"minicampaignbo":t=a.MetadataSubtype.miniCampaignBO;break;case"preview":t=a.MetadataSubtype.preview;break;case"dashboard":t=a.MetadataSubtype.dashboard;break;case"quick":t=a.MetadataSubtype.quick;break;case"mobile":t=a.MetadataSubtype.mobile;break;case"read":t=a.MetadataSubtype.read;break;case"quickcreate":t=a.MetadataSubtype.quickCreate;break;case"dialog":t=a.MetadataSubtype.dialog;break;case"card":t=a.MetadataSubtype.card;break;case"taskbasedform":t=a.MetadataSubtype.taskBased;break;case"interactioncentricdashboard":t=a.MetadataSubtype.interactionCentricDashboard;break;default:t=a.MetadataSubtype.none}return t}(t);break;case"viewselector":case"savedview":case"userview":r=function(e){var t=a.MetadataSubtype.none;if(!Object(n.isNullOrUndefined)(e))switch(e.toUpperCase()){case"MAIN_APPLICATION_VIEW":t=a.MetadataSubtype.main;break;case"ADVANCED_SEARCH":t=a.MetadataSubtype.advancedSearch;break;case"SUB_GRID":t=a.MetadataSubtype.subGrid;break;case"QUICKFIND_SEARCH":t=a.MetadataSubtype.quickFindSearch;break;case"REPORTING":t=a.MetadataSubtype.reporting;break;case"OFFLINE_FILTERS":t=a.MetadataSubtype.offlineFilters;break;case"MA_SEARCH":t=a.MetadataSubtype.maSearch;break;case"LOOKUP_VIEW":t=a.MetadataSubtype.lookup;break;case"SM_APPOINTMENTBOOK_VIEW":t=a.MetadataSubtype.smAppointmentBook;break;case"OUTLOOK_FILTERS":t=a.MetadataSubtype.outlookFilters;break;case"ADDRESSBOOK_FILTERS":t=a.MetadataSubtype.addressbookFilters;break;case"SAVEDQUERYTYPE_OTHER":t=a.MetadataSubtype.savedQueryTypeOther;break;case"INTERACTIVE_WORKFLOW_VIEW":t=a.MetadataSubtype.interactiveWorkFlow;break;case"OFFLINE_TEMPLATE":t=a.MetadataSubtype.offlineTemplate;break;case"OUTLOOK_TEMPLATE":t=a.MetadataSubtype.outlookTemplate;break;case"CUSTOM_DEFINED_VIEW":t=a.MetadataSubtype.customDefined;break;default:t=a.MetadataSubtype.none}return t}(t);break;case"workspace":case"systemworkspace":case"userworkspace":r=a.MetadataSubtype.dashboard;break;case"webresource":r=function(e){var t=0;if(!Object(n.isNullOrUndefined)(e))switch(e.toUpperCase()){case"HTML":t=10;break;case"CSS":t=6;break;case"JSCRIPT":t=5;break;case"XML":t=11;break;case"PNG":t=7;break;case"JPG":t=8;break;case"RESX":t=12;break;case"GIF":case"SILVERLIGHT":case"XSL":case"ICO":default:t=0}return t}(t);break;default:r=a.MetadataSubtype.none}return r}},9118:function(e,t,r){"use strict";r.r(t),r.d(t,"ApplicationMetadataQuery",(function(){return o}));var n=r(9050),a=r(9077),i=r(9119);class o{constructor(e,t,r,i,o,s,u,c){if(this._metadataType=0,this._metadataSubtype=0,this._formFactor=0,this._associatedEntityLogicalName=void 0,this._isDefault=!1,this._sourceId=void 0,this._normalizedDisplayName=void 0,this._applicationMetadataType=0,this._isDefaultSpecified=!1,!e)throw new Error("Invalid application metadata type");this._metadataType=e,this._formFactor=t,this._associatedEntityLogicalName=r,this._applicationMetadataType=Object(n.isNullOrUndefined)(i)?a.ApplicationMetadataType.systemApplicationMetadata:i,this._isDefaultSpecified=!Object(n.isNullOrUndefined)(o),this._isDefault=!!this._isDefaultSpecified&&o,this._sourceId=s||"",this._metadataSubtype=u||0,this._normalizedDisplayName=c||""}checkApplicationMetadata(e){return(!this.get_metadataType()||e.metadatatype===this.get_metadataType())&&(!(!Object(n.isNullOrUndefined)(this.get_metadataSubtype())&&this.get_metadataSubtype()!==a.MetadataSubtype.none&&e.metadatasubtype!==this.get_metadataSubtype())&&(!(!Object(n.isNullOrUndefinedOrEmptyString)(this.get_sourceId())&&e.sourceid!==this.get_sourceId())&&(!(!Object(n.isNullOrUndefinedOrEmptyString)(this.get_associatedEntityLogicalName())&&e.associatedentitylogicalname!==this.get_associatedEntityLogicalName())&&(!(this.get_formFactor()>0&&e.formfactor!==this.get_formFactor())&&(!(this._isDefaultSpecified&&this._isDefault&&Object(n.isNullOrUndefined)(e.isdefault||!e.isdefault))&&(!(this._applicationMetadataType===a.ApplicationMetadataType.userApplicationMetadata&&!e.isuserrecord)&&!(!Object(n.isNullOrUndefinedOrEmptyString)(this.get_normalizedDisplayName())&&this.get_normalizedDisplayName()!==e.displayname.toUpperCase())))))))}get_keyPath(){return Object(n.isNullOrUndefinedOrEmptyString)(this.get_sourceId())?Object(n.isNullOrUndefinedOrEmptyString)(this.get_normalizedDisplayName())?Object(n.isNullOrUndefinedOrEmptyString)(this.get_associatedEntityLogicalName())||Object(n.isNullOrUndefined)(this.get_metadataSubtype())?Object(n.isNullOrUndefinedOrEmptyString)(this.get_associatedEntityLogicalName())?i.metadataTypeKeyPath:i.metadataTypeAssociatedEntityLogicalNameKeyPath:i.metadataTypeMetadataSubtypeAssociatedEntityLogicalNameKeyPath:i.metadataTypeNormalizedDisplayNameKeyPath:i.metadataTypeSourceIdKeyPath}get_keyValue(){var e=this.get_metadataType().toString(),t=this.get_keyPath();if(t===i.metadataTypeSourceIdKeyPath)return e+n.COMPOSITE_INDEX_DELIMITER+this.get_sourceId();if(t===i.metadataTypeAssociatedEntityLogicalNameKeyPath)return e+n.COMPOSITE_INDEX_DELIMITER+this.get_associatedEntityLogicalName();if(t===i.metadataTypeMetadataSubtypeAssociatedEntityLogicalNameKeyPath){var r=this.get_metadataSubtype().toString();return e+n.COMPOSITE_INDEX_DELIMITER+r+n.COMPOSITE_INDEX_DELIMITER+this.get_associatedEntityLogicalName()}return t===i.metadataTypeNormalizedDisplayNameKeyPath?e+n.COMPOSITE_INDEX_DELIMITER+this.get_normalizedDisplayName():this.get_metadataType()}get_metadataType(){return this._metadataType}get_metadataSubtype(){return this._metadataSubtype}get_formFactor(){return this._formFactor}get_associatedEntityLogicalName(){return this._associatedEntityLogicalName}get_sourceId(){return this._sourceId}get_normalizedDisplayName(){return this._normalizedDisplayName}}},9119:function(e,t,r){"use strict";r.r(t),r.d(t,"metadataTypeKeyPath",(function(){return o})),r.d(t,"sourceIdKeyPath",(function(){return s})),r.d(t,"metadataTypeSourceIdKeyPath",(function(){return u})),r.d(t,"metadataTypeAssociatedEntityLogicalNameKeyPath",(function(){return c})),r.d(t,"metadataTypeNormalizedDisplayNameKeyPath",(function(){return d})),r.d(t,"metadataTypeMetadataSubtypeAssociatedEntityLogicalNameKeyPath",(function(){return l}));var n=r(9050),a=r(9078),i=r(9120),o=new i.KeyPath(a.MetadataFields.METADATA_TYPE),s=new i.KeyPath(a.MetadataFields.SOURCE_ID),u=new i.KeyPath(a.MetadataFields.METADATA_TYPE+n.COMPOSITE_INDEX_DELIMITER+a.MetadataFields.SOURCE_ID),c=new i.KeyPath(a.MetadataFields.METADATA_TYPE+n.COMPOSITE_INDEX_DELIMITER+a.MetadataFields.ASSOCIATED_ENTITY_LOGICAL_NAME),l=new i.KeyPath(a.MetadataFields.METADATA_TYPE+n.COMPOSITE_INDEX_DELIMITER+a.MetadataFields.METADATA_SUBTYPE+n.COMPOSITE_INDEX_DELIMITER+a.MetadataFields.ASSOCIATED_ENTITY_LOGICAL_NAME),d=new i.KeyPath(a.MetadataFields.METADATA_TYPE+n.COMPOSITE_INDEX_DELIMITER+a.MetadataFields.DISPLAY_NAME)},9120:function(e,t,r){"use strict";r.r(t),r.d(t,"KeyPath",(function(){return a}));var n=r(9050);class a{static get_id(){return a._id}constructor(e){if(this._path=void 0,Object(n.isNullOrUndefinedOrEmptyString)(e))throw new Error("Undefined path parameter to KeyPath");this._path=e}get_path(){return this._path}}a._id=new a("id")},9121:function(e,t,r){"use strict";r.r(t),r.d(t,"createLocalStoreId",(function(){return o}));var n=r(9050),a=r(9077),i=r(9078);function o(e,t,r,o,s,u){var c="";e=Object(n.isNullOrUndefined)(e)?"":e,r=Object(n.isNullOrUndefined)(r)?"":r,o=Object(n.isNullOrUndefined)(o)?"":o,u=Object(n.isNullOrUndefined)(u)?"":u;var l=Object(n.isNullOrUndefined)(s)?"":s.toString();switch(t){case a.MetadataType.overallMetadataVersion:c="".concat(i.APPLICATION_METADATA_VERSION_STAMP_KEY);break;case a.MetadataType.quickCreateMenu:c="".concat(t,"_quickcreatemenu_").concat(u);break;case a.MetadataType.searchConfiguration:c="".concat(t,"_searchconfiguration");break;case a.MetadataType.taskBasedFlowGlobalMenu:c="".concat(t,"_taskbasedflowglobalmenu");break;case a.MetadataType.siteMap:c="".concat(t,"_sitemap_").concat(u);break;case a.MetadataType.appModule:c="".concat(t,"_appmodules_").concat(u);break;case a.MetadataType.appModuleOfflineMetadata:c="".concat(t,"_appmoduleofflinemetadata");break;case a.MetadataType.taskBasedFlow:case a.MetadataType.customControl:case a.MetadataType.resourceString:case a.MetadataType.complexControl:c="".concat(t,"_").concat(o);break;case a.MetadataType.dialog:c="".concat(t,"_").concat(o.toLowerCase());break;case a.MetadataType.label:c="".concat(t,"_").concat(r,"_").concat(o);break;case a.MetadataType.homePageConfiguration:c="".concat(t,"_").concat(e);break;case a.MetadataType.optionSet:c="".concat(t,"_").concat(Object(n.isNullOrUndefinedOrEmptyString)(r)?o:r);break;case a.MetadataType.appModuleSelector:c="".concat(t,"_").concat(l);break;case a.MetadataType.viewSelector:case a.MetadataType.formSelector:case a.MetadataType.dashboardSelector:case a.MetadataType.visualizationSelector:c="".concat(t,"_").concat(e,"_").concat(l,"_").concat(u);break;case a.MetadataType.bpfSelector:c="".concat(t,"_").concat(e,"_").concat(u);break;case a.MetadataType.command:c="".concat(t,"_").concat(o,"_").concat(e);break;case a.MetadataType.isActivityFlags:case a.MetadataType.webResource:case a.MetadataType.webResourceDescriptor:c="".concat(t,"_").concat(o);break;case a.MetadataType.businessProcessFlow:case a.MetadataType.form:case a.MetadataType.savedQueryVisualization:case a.MetadataType.displayString:default:c="".concat(t,"_").concat(r)}return c}},9122:function(e,t,r){"use strict";r.r(t),r.d(t,"ExecuteOfflineSqlGenerator",(function(){return a}));var n=r(9123);function a(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return Object(n.generateSQL)(e,t,r)}},9123:function(e,t,r){"use strict";r.r(t),r.d(t,"generateSQL",(function(){return m}));var n=r(9045),a=r(9047),i=r(9061),o=r(9124),s=r(9130),u=r(9131),c=r(9115),l=r(9125),d=r(9151),p=r(9164);function f(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function h(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){f(i,n,a,o,s,"next",e)}function s(e){f(i,n,a,o,s,"throw",e)}o(void 0)}))}}function m(e,t){return y.apply(this,arguments)}function y(){return(y=h((function*(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},f=t.TraceManager.getTracer(a.COMPONENT_NAMES.SQLGenerator),h=r.commonEventParameters||[];switch(f.info("".concat(v()," Query Generator start processing."),h),Object(i.getRequestType)(e,t)){case n.OPERATION.Create:return Object(s.generateCreateRequests)(e,t,f,r);case n.OPERATION.RetrieveMultiple:return Object(d.generateRetrieveMultipleRequests)(e,t,f,r);case n.OPERATION.Update:return Object(p.generateUpdateRequests)(e,t,f,r);case n.OPERATION.Delete:return Object(u.generateDeleteRequests)(e,t,f,r);case n.OPERATION.GetClientMetadata:return Object(c.generateGCMRequests)(e,t,f,r);case n.OPERATION.Retrieve:return Object(l.generateRetrieveRequest)(e,t,f,r);case n.OPERATION.Batch:return Object(o.generateBatchRequests)(e,t,f,r);default:var m="Query Generator Failed with Unsupported request type";throw new Error(m)}}))).apply(this,arguments)}function v(e){return"[".concat(e||a.FILE_PREFIX.SQLGenerator,"]")}},9124:function(e,t,r){"use strict";r.r(t),r.d(t,"generateBatchRequests",(function(){return d}));var n=r(9045),a=r(9047),i=r(9061),o=r(9060),s=r(9125),u=r(9123);function c(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function l(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){c(i,n,a,o,s,"next",e)}function s(e){c(i,n,a,o,s,"throw",e)}o(void 0)}))}}function d(e,t,r){return p.apply(this,arguments)}function p(){return(p=l((function*(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=Object(o.extractIndividualRequests)(e,r,n.commonEventParameters);return f(a,t)?(r.info("".concat(g," found batch retrieve request")),[yield h(a,r,t,n)]):yield y(a,r,t,n)}))).apply(this,arguments)}function f(e,t){for(var r of e){if(Object(i.getRequestType)(r,t)===n.OPERATION.Retrieve)return!0}return!1}function h(e,t,r,n){return m.apply(this,arguments)}function m(){return(m=l((function*(e,t,r,n){var a=e&&e.length>0?e[0]:void 0,i=e&&e.length>1?e[1]:void 0;if(!a)throw t.error("".concat(g," Unsupported Retrieve request. MDL offline only supports retrieve+bpf request")),new Error("Unsupported offline batch request");return Object(s.generateRetrieveRequest)(a,r,t,n,i)}))).apply(this,arguments)}function y(e,t,r,n){return v.apply(this,arguments)}function v(){return(v=l((function*(e,t,r,n){for(var a=[],i=0;i<e.length;i++){var o={requestType:n.requestType,commonEventParameters:n.commonEventParameters,performanceControl:n.performanceControl,internalRequest:n.internalRequest,clientRequestId:n.clientRequestId||""};a.push(Object(u.generateSQL)(e[i],r,o))}return Promise.all(a)}))).apply(this,arguments)}function g(e){return"[".concat(e||a.FILE_PREFIX.BatchGenerator,"]")}},9125:function(e,t,r){"use strict";r.r(t),r.d(t,"generateRetrieveRequest",(function(){return m})),r.d(t,"retrieveLookupRecords",(function(){return w}));var n=r(9050),a=r(9047),i=r(9048),o=r(9054),s=r(9109),u=r(9063),c=r(9112),l=r(9126),d=r(9129),p=r(9045);function f(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function h(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){f(i,n,a,o,s,"next",e)}function s(e){f(i,n,a,o,s,"throw",e)}o(void 0)}))}}function m(e,t,r){return y.apply(this,arguments)}function y(){return(y=h((function*(e,t,r){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=arguments.length>4?arguments[4]:void 0,u=a.commonEventParameters||[],c=yield Object(s.getEntityNameFromRequest)(e,t,r,u),p=Object(s.getEntityIdFromUrl)(e.url,r,u);if(Object(n.isNullOrUndefined)(p)){var f=new Error("Retrieve Generator was unable to extract GUID from url");throw r.error("".concat(L()," ").concat(f.message),u),f}var h=yield Object(o.getEntityMetadata)(t,c),m=yield Object(o.getAttributeTypes)(t,[],c,u),y=yield Object(d.getRequestedColumns)(e.url,m,r,u);yield v(h,y);var O=null;Object(n.isNullOrUndefined)(i)||(O=yield Object(l.addBPFColumns)(c,y,i,h,t,r,a));var E=yield M(c,h,p,y,r,u,t);Object(n.isNullOrUndefined)(O)||(E=yield R(O,E)),h.IsActivity&&(E=yield I(p,m,E,r,a));var b=yield Object(d.getExpandTermTokens)(e.url,r,u);return Object.keys(b).length>0&&(E=yield g(p,h,b,E,r,u,t)),E}))).apply(this,arguments)}function v(e,t){if(Object(n.isNullOrUndefined)(t)||0===t.length)return t;var r=[e.PrimaryIdAttribute,e.PrimaryNameAttribute];for(var a of r)Object(n.isNullOrUndefined)(a)||-1!==t.indexOf(a)||t.push(a);return t}function g(e,t,r,n,a,i,o){return O.apply(this,arguments)}function O(){return(O=h((function*(e,t,r,a,i,o,s){if(Object.keys(r).length>0)for(var u in Object(n.isNullOrUndefined)(a.additionalParameters)&&(a.additionalParameters={}),a.additionalParameters[p.EXPAND_PROPERTIES]=[],i.info("".concat(L()," Requested for expansions"),o),r)a=yield E(e,u,r[u],t,a,s);return a}))).apply(this,arguments)}function E(e,t,r,n,a,i){return b.apply(this,arguments)}function b(){return(b=h((function*(e,t,r,a,i,o){Object(n.isNullOrUndefined)(i.additionalParameters)&&(i.additionalParameters={});var s=!1;if(a.OneToManyRelationships)for(var u in a.OneToManyRelationships){var c=a.OneToManyRelationships[u];c.ReferencedEntityNavigationPropertyName===t&&(s=!0,yield T(c,e,t,r,a,i,o))}if(!s&&a.ManyToOneRelationships)for(var l in a.ManyToOneRelationships){var d=a.ManyToOneRelationships[l];d.ReferencingEntityNavigationPropertyName===t&&(yield C(d,e,t,r,a,i,o))}return i}))).apply(this,arguments)}function T(e,t,r,n,a,i,o){return S.apply(this,arguments)}function S(){return(S=h((function*(e,t,r,a,i,s,c){Object(n.isNullOrUndefined)(s.additionalParameters)&&(s.additionalParameters={}),Object(n.isNullOrUndefined)(s.additionalParameters[p.EXPAND_PROPERTIES])&&(s.additionalParameters[p.EXPAND_PROPERTIES]=[]);var l=e.ReferencedAttribute,d=e.ReferencingAttribute,f=e.ReferencingEntity,h=yield Object(o.getAttributeTypes)(c,[],f),m=_(h,d),y={ExpandValueType:p.EXPAND_VALUES.MULTI_VALUE,ExpandPropertyName:r,ExpandQueryIndex:s.sqlStatements.length,ReferencedOrReferencingEntityName:f};if(s.additionalParameters[p.EXPAND_PROPERTIES].push(y),a.clause===u.CLAUSE.select){var v="*";if(a.values.length>0){var g=(yield Object(o.getEntityMetadata)(c,f)).PrimaryIdAttribute;g&&a.values.push(g),f===p.FILE_ATTACHMENT&&a.values.push(p.DEVICE_FILE_PATH),v=a.values.map(e=>"[".concat(_(h,e),"]")).join(",")}s.sqlStatements.push("SELECT ".concat(v," FROM [").concat(f,"] WHERE [").concat(m,"] = (SELECT [").concat(l,"] FROM [").concat(i.EntityLogicalName,"] WHERE [").concat(i.PrimaryIdAttribute,"]=?)")),s.sqlParameters.push([t.guid])}else if(a.clause===u.CLAUSE.in){var O="?,".repeat(a.values.length);O=O.substring(0,O.length-1),s.sqlStatements.push("SELECT * FROM [".concat(f,"] WHERE [").concat(a.propertyName,"] IN (").concat(O,") AND [").concat(m,"]=(SELECT [").concat(l,"] FROM [").concat(i.EntityLogicalName,"] WHERE [").concat(i.PrimaryIdAttribute,"]=?)")),s.sqlParameters.push([...a.values,t.guid])}}))).apply(this,arguments)}function C(e,t,r,n,a,i,o){return N.apply(this,arguments)}function N(){return(N=h((function*(e,t,r,a,i,s,c){Object(n.isNullOrUndefined)(s.additionalParameters)&&(s.additionalParameters={}),Object(n.isNullOrUndefined)(s.additionalParameters[p.EXPAND_PROPERTIES])&&(s.additionalParameters[p.EXPAND_PROPERTIES]=[]);var l=e.ReferencedAttribute,d=e.ReferencingAttribute,f=e.ReferencedEntity,h=e.ReferencingEntity,m=yield Object(o.getAttributeTypes)(c,[],f),y=yield Object(o.getAttributeTypes)(c,[],h),v=_(m,l),g=_(y,d),O={ExpandValueType:p.EXPAND_VALUES.SINGLE_VALUE,ExpandPropertyName:r,ExpandQueryIndex:s.sqlStatements.length,ReferencedOrReferencingEntityName:f};if(s.additionalParameters[p.EXPAND_PROPERTIES].push(O),a.clause===u.CLAUSE.select){var E="*";if(a.values.length>0){var b=(yield Object(o.getEntityMetadata)(c,f)).PrimaryIdAttribute;b&&a.values.push(b),f===p.IMAGE_DESCRIPTOR?(a.values.push(p.DEVICE_FILE_PATH),a.values.push(p.DEVICE_THUMBNAIL_PATH),E=a.values.map(e=>"".concat(p.IMAGE_DESCRIPTOR,".[").concat(_(m,e),"]")).join(","),E="".concat(E,",").concat(p.FILE_ATTACHMENT,".[").concat(p.FILE_NAME,"]")):E=a.values.map(e=>"[".concat(_(m,e),"]")).join(",")}f===p.IMAGE_DESCRIPTOR?s.sqlStatements.push("SELECT ".concat(E," FROM [").concat(f,"] JOIN [").concat(p.FILE_ATTACHMENT,"] on ").concat(p.IMAGE_DESCRIPTOR,".").concat(p.IMAGE_DESCRIPTOR_ID," = ").concat(p.FILE_ATTACHMENT,".[objectid!id] WHERE [").concat(v,"] = (SELECT [").concat(d,"] FROM [").concat(i.EntityLogicalName,"] WHERE [").concat(i.PrimaryIdAttribute,"]=?)")):s.sqlStatements.push("SELECT ".concat(E," FROM [").concat(f,"] WHERE [").concat(v,"] = (SELECT [").concat(g,"] FROM [").concat(i.EntityLogicalName,"] WHERE [").concat(i.PrimaryIdAttribute,"]=?)")),s.sqlParameters.push([t.guid])}else if(a.clause===u.CLAUSE.in){var T="?,".repeat(a.values.length);T=T.substring(0,T.length-1),s.sqlStatements.push("SELECT * FROM [".concat(f,"] WHERE [").concat(v,"] = (SELECT [").concat(g,"] FROM [").concat(i.EntityLogicalName,"] WHERE [").concat(i.PrimaryIdAttribute,"]=?) AND [").concat(a.propertyName,"] IN (").concat(T,")")),s.sqlParameters.push([t.guid,...a.values])}}))).apply(this,arguments)}function _(e,t){var r=Object(s.getAttributeName)(t),n=e[r];return n===i.AttributeType.Owner||n===i.AttributeType.Lookup||n===i.AttributeType.Customer?"".concat(r).concat(c.columnDelimiter).concat(c.id):r}function R(e,t){return P.apply(this,arguments)}function P(){return(P=h((function*(e,t){if(!Object(n.isNullOrUndefinedOrEmptyString)(e.entityLogicalName)){var r="".concat(u.CLAUSE.select," ").concat(u.Punctuation.asterisk," ").concat(u.CLAUSE.from," [").concat(e.entityLogicalName,"] ").concat(u.CLAUSE.where," [").concat(e.primaryIdAttribute,"]").concat(u.Punctuation.equal).concat(u.CLAUSE.placeholder);t.sqlStatements.push(r),t.sqlParameters.push([e.primaryIdValue.guid]),Object(n.isNullOrUndefined)(t.additionalParameters)&&(t.additionalParameters={}),t.additionalParameters.BPFEntityLogicalName=e.entityLogicalName,t.additionalParameters.BPFQueryIndex=t.sqlStatements.length-1}return t}))).apply(this,arguments)}function I(e,t,r,n,a){return A.apply(this,arguments)}function A(){return(A=h((function*(e,t,r,n,a){var o=!1,s={};for(var l in t)t[l]===i.AttributeType.PartyList&&(s[c.participationTypeValue[l]]=l,o=!0);return o?(n.info("".concat(L()," Attempting to retrieve ").concat(s.length," activity parties"),a.commonEventParameters),D(e,[c.participationMasks,c.activityId+u.Punctuation.exclamation+c.id,c.activityId+u.Punctuation.exclamation+c.name,c.activityId+u.Punctuation.exclamation+c.logicalName,c.activityPartyId,c.partyId+u.Punctuation.exclamation+c.id,c.partyId+u.Punctuation.exclamation+c.name,c.partyId+u.Punctuation.exclamation+c.logicalName,c.isPartyDeleted,c.partyObjectTypeCode,c.addressUsed],s,r,n,a)):(n.warn("".concat(L()," Activity entity does not have party type attributes"),a.commonEventParameters),r)}))).apply(this,arguments)}function D(e,t,r,a,i,o){if(Object(n.isNullOrUndefined)(t)||0===t.length)return i.error("".concat(L()," Empty list of columns received. Not generating activity party query"),o.commonEventParameters),a;for(var s="",l=0;l<t.length;l++)s+=u.Punctuation.openSQBracket+t[l]+u.Punctuation.closeSQBracket+u.Punctuation.comma;s=s.substr(0,s.length-1);var d="".concat(u.CLAUSE.placeholder).concat(u.Punctuation.comma).repeat(Object.keys(r).length);d=d.substr(0,d.length-1);var p=u.Punctuation.openSQBracket+c.activityId+c.columnDelimiter+c.id+u.Punctuation.closeSQBracket+u.Punctuation.equal+u.Punctuation.question+u.Punctuation.space+u.CLAUSE.and+u.Punctuation.space+u.Punctuation.openSQBracket+c.participationMasks+u.Punctuation.closeSQBracket+u.Punctuation.space+u.CLAUSE.in+u.Punctuation.space+u.Punctuation.openParenthesis+d+u.Punctuation.closeParenthesis,f=u.CLAUSE.select+u.Punctuation.space+s+u.Punctuation.space+u.CLAUSE.from+u.Punctuation.space+u.Punctuation.openSQBracket+c.activityParty+u.Punctuation.closeSQBracket+u.Punctuation.space+u.CLAUSE.where+u.Punctuation.space+p+u.CLAUSE.collateNoCase+u.Punctuation.space+u.CLAUSE.orderBy+u.Punctuation.space+u.Punctuation.openSQBracket+c.participationMasks+u.Punctuation.closeSQBracket;return a.sqlStatements.push(f),a.sqlParameters.push([e.guid.toString(),...Object.keys(r)]),Object(n.isNullOrUndefined)(a.additionalParameters)&&(a.additionalParameters={}),a.additionalParameters.ContainsActivityPartyQuery=!0,a.additionalParameters.ParticipationMasks=r,a.additionalParameters.ActivityPartyQueryIndex=a.sqlStatements.length-1,a}function M(e,t,r,n,a,i,o){return F.apply(this,arguments)}function F(){return(F=h((function*(e,t,r,a,i,s,c){var l={sqlStatements:[],sqlParameters:new Array,additionalParameters:{}},d=t.PrimaryIdAttribute,p=yield Object(o.getAttributeTypes)(c,[],e,s);if(Object(n.isNullOrUndefinedOrEmptyString)(d))throw i.error("".concat(L()," Invalid parameters when generating RETRIEVE query"),s),new Error("Invalid primary id attribute");var f="";return f=Object(n.isNullOrUndefined)(a)||0===a.length?u.Punctuation.asterisk:a.map(e=>"[".concat(_(p,e),"]")).join("".concat(u.Punctuation.comma).concat(u.Punctuation.space)),l.sqlStatements.push(u.CLAUSE.select+u.Punctuation.space+f+u.Punctuation.space+u.CLAUSE.from+u.Punctuation.space+u.Punctuation.openSQBracket+e+u.Punctuation.closeSQBracket+u.Punctuation.space+u.CLAUSE.where+u.Punctuation.space+u.Punctuation.openSQBracket+d+u.Punctuation.closeSQBracket+u.Punctuation.equal+u.Punctuation.space+u.Punctuation.question+u.Punctuation.space+u.CLAUSE.collateNoCase),l.sqlParameters.push([r.guid]),l}))).apply(this,arguments)}function w(e,t,r,n,a,i){var o={sqlStatements:[],sqlParameters:new Array(e),additionalParameters:{}};try{var s=[r,n];o.sqlStatements.push(function(e,t,r,n){for(var a="",i="",o=0;o<t.length;o++){var s=o>0?u.Punctuation.comma:"";a+="".concat(s,"[").concat(t[o],"]")}for(var c=0;c<e;c++){i+="".concat(c>0?" OR":"","[").concat(n,"] = ? COLLATE NOCASE")}return"SELECT ".concat(a," FROM ").concat(r," WHERE ").concat(i)}(e.length,s,t,r))}catch(c){a.warn("".concat(L()," Unable to retrieve lookup data with error ").concat(c," for entity ").concat(t," with ids: \n ").concat(e),i)}return o}function L(e){return"[".concat(e||a.FILE_PREFIX.RetrieveGenerator,"]")}},9126:function(e,t,r){"use strict";r.r(t),r.d(t,"addBPFColumns",(function(){return p}));var n=r(9050),a=r(9047),i=r(9046),o=r(9054),s=r(9127),u=r(9128);function c(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function l(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){c(i,n,a,o,s,"next",e)}function s(e){c(i,n,a,o,s,"throw",e)}o(void 0)}))}}function d(e){return Object(n.isNullOrUndefined)(e.AdditionalParameters)||Object(n.isNullOrUndefined)(e.AdditionalParameters.AppId)?i.Guid.EMPTY:i.Guid.tryParse(e.AdditionalParameters.AppId)}function p(e,t,r,n,a,i,o){return f.apply(this,arguments)}function f(){return(f=l((function*(e,t,r,a,o,s,u){var c=u.commonEventParameters||[];try{var l=yield h(r,!!a.IsBusinessProcessEnabled&&a.IsBusinessProcessEnabled,o,s,u),d=Object(n.isNullOrUndefined)(l)||i.Guid.isNullOrEmpty(l.id)?null:l.id,p=yield g(d,e,s,o,u);if(!Object(n.isNullOrUndefined)(p)&&p.length)for(var f of p)-1===t.indexOf(f)&&t.push(f);return l}catch(m){return s.error("".concat(A()," something went wrong when adding BPF columns ").concat(m.message),c),null}}))).apply(this,arguments)}function h(e,t,r,n,a){return m.apply(this,arguments)}function m(){return(m=l((function*(e,t,r,a,c){var l=c.commonEventParameters||[];if(!(yield Object(o.isFeatureEnabled)(r,"EnableBPFOffline"))||!t||Object(n.isNullOrUndefined)(e))return null;var d=yield Object(s.parseBPFRequest)(e,r,l),p=yield y(d,a,r,c);if(Object(n.isNullOrUndefined)(p)||!p.length)return null;var f=[];null===d.processId||i.Guid.isNullOrEmpty(d.processId)||null===d.processInstanceId||i.Guid.isNullOrEmpty(d.processInstanceId)?p.forEach(e=>{f.push(Object(u.retrieveBPFRecordByProcess)(d.target,e,r,a,c)),a.info("".concat(A(),"  'Retriev multiple BPF instances ").concat(JSON.stringify(d)),l)}):(f.push(Object(u.retrieveBPFRecordById)(d.processInstanceId,p[0],a,r,c)),a.info("".concat(A()," Retrieve BPF instance from ").concat(p[0]," ").concat(JSON.stringify(d)),l));try{var h=yield Promise.all(f),m=new Date("1700-01-01T00:00:00Z"),v={entityLogicalName:"",id:i.Guid.EMPTY,modifiedon:m,primaryIdAttribute:"",primaryIdValue:i.Guid.EMPTY};return h.forEach(e=>{if(null!==e){var t=e.modifiedon;(null===m||t>m)&&(v=e,m=t)}}),a.error("".concat(A()," Successfully retrieved multiple BPF instances"),l),v}catch(g){throw a.error("".concat(A()," Error when attempting to retrieve global navigation data"),l),g}}))).apply(this,arguments)}function y(e,t,r,n){return v.apply(this,arguments)}function v(){return(v=l((function*(e,t,r,a){var o=a.commonEventParameters||[];if(Object(n.isNullOrUndefined)(e))return[];if(null!==e.processId&&!i.Guid.isNullOrEmpty(e.processId))try{var s=yield E(e.processId,r,t,a);return Object(n.isNullOrUndefinedOrEmptyString)(s)?(t.warn("".concat(A()," Unique name not found for ").concat(e.processId),o),[]):[s]}catch(y){t.warn("".concat(A()," Error while retriving bpf unique names by process id ").concat(e.processId),o)}if(Object(n.isNullOrUndefined)(e.target)||Object(n.isNullOrUndefinedOrEmptyString)(e.target))return t.warn("".concat(A()," BPF request must have participating entity logical name"),o),[];var c=d(r),l={MetadataType:"bpfselector",MetadataSubtype:null,EntityLogicalName:e.target.entityLogicalName,MetadataId:null,MetadataNames:[],GetDefault:!1,DependencyDepth:"OnDemandWithContext",ChangedAfter:null,Exclude:[],AppId:c.guid,IsPreloadCall:!1},p=yield Object(u.retrieveMetadataByQuery)(r,l,t,a);if(Object(n.isNullOrUndefined)(p)||0===p.length)return[];var f=p[0].data;if(!Object(n.isNullOrUndefined)(f)&&f.SelectorItems){var h=f.SelectorItems;if(!Object(n.isNullOrUndefined)(h)&&h.length>0){var m=h.map(e=>e.UniqueName);return t.info("".concat(A()," Successfully retrieve all BPF uniquenames for participating entity ").concat(e.target)),m}}return[]}))).apply(this,arguments)}function g(e,t,r,n,a){return O.apply(this,arguments)}function O(){return(O=l((function*(e,t,r,a,o){var s=[];if(!e)return r.info("".concat(A()," processID is null in get business process flow control data")),s;var u=yield T(e,t,i.Guid.EMPTY,r,a,o);if(Object(n.isNullOrUndefined)(u)||Object(n.isNullOrUndefined)(u.data))throw new Error("Retrieved empty BPF metadata for");var c=u.data;for(var l of c.BusinessProcessFlowEntities)if(l.EntityLogicalName===t)for(var d of l.Stage.Steps)Object(n.isNullOrUndefinedOrEmptyString)(d.Name)||s.push(d.Name);return s}))).apply(this,arguments)}function E(e,t,r,n){return b.apply(this,arguments)}function b(){return(b=l((function*(e,t,r,a){var i={MetadataType:"businessprocessflow",MetadataSubtype:null,EntityLogicalName:"workflow",MetadataId:e.guid,MetadataNames:[],GetDefault:!1,DependencyDepth:"OnDemandWithContext",ChangedAfter:null,Exclude:[],AppId:null,IsPreloadCall:!1};try{var o=yield Object(u.retrieveMetadataByQuery)(t,i,r,a)[0],s=null,c=o.data;return Object(n.isNullOrUndefined)(c)||Object(n.isNullOrUndefined)(c.BusinessProcessFlowUniqueName)||(s=c.BusinessProcessFlowUniqueName),r.info("".concat(A()," Successfully retrieve uniquename for BPF  ").concat(e.guid)),s}catch(l){return null}}))).apply(this,arguments)}function T(e,t,r,n,a,i){return S.apply(this,arguments)}function S(){return(S=l((function*(e,t,r,n,a,s){var u;if(i.Guid.isNullOrEmpty(e)){if(t&&r||n.error("".concat(A()," The entityLogicalName must be either Workflow or participating entity name.")),!(yield Object(o.isFeatureEnabled)(a,"EnableBPFOffline")))return Promise.resolve(null);u=C(t,n,a,s)}else u=P(t="workflow",e,n,a,s);return yield u}))).apply(this,arguments)}function C(e,t,r,n){return N.apply(this,arguments)}function N(){return(N=l((function*(e,t,r,n){var a=n.commonEventParameters||[],o=(yield _(t,r,n)).data;if(!o||!o.SelectorItems||!o.SelectorItems[0]||i.Guid.isNullOrEmpty(o.SelectorItems[0].Id))throw t.error("".concat(A()," unable to find default BPF step for ").concat(e),a),new Error("Unable to find default bpf step for ".concat(e));return P("workflow",o.SelectorItems[0].Id,t,r,n)}))).apply(this,arguments)}function _(e,t,r){return R.apply(this,arguments)}function R(){return(R=l((function*(e,t,r){var a=r.commonEventParameters||[],i=yield Object(u.retrieveMetadataByQuery)(t,{MetadataType:"bpfselector",MetadataSubtype:null,EntityLogicalName:null,MetadataId:null,GetDefault:!1,DependencyDepth:"OnDemandWithoutContext",ChangedAfter:null,Exclude:[],MetadataNames:[],AppId:null,IsPreloadCall:!1},e,r);if(Object(n.isNullOrUndefined)(i)||0===i.length)throw e.error("".concat(A()," error when fetching bpf selector"),a),new Error("error when fetching bpf selector");return i[0]}))).apply(this,arguments)}function P(e,t,r,n,a){return I.apply(this,arguments)}function I(){return(I=l((function*(e,t,r,a,i){var o=i.commonEventParameters||[],s={MetadataType:"businessprocessflow",MetadataSubtype:null,EntityLogicalName:null,MetadataId:t.guid,GetDefault:!1,DependencyDepth:"OnDemandWithoutContext",ChangedAfter:null,Exclude:[],MetadataNames:[],AppId:null,IsPreloadCall:!1},c=yield Object(u.retrieveMetadataByQuery)(a,s,r,i);if(Object(n.isNullOrUndefined)(c)||0===c.length)throw r.error("".concat(A()," error when fetching bpf"),o),new Error("error when fetching bpf");return c[0]}))).apply(this,arguments)}function A(e){return"[".concat(e||a.FILE_PREFIX.RetrieveGenerator,"]")}},9127:function(e,t,r){"use strict";r.r(t),r.d(t,"parseBPFRequest",(function(){return u}));var n=r(9046),a=r(9054),i=r(9050);function o(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function s(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function s(e){o(i,n,a,s,u,"next",e)}function u(e){o(i,n,a,s,u,"throw",e)}s(void 0)}))}}function u(e,t,r){return c.apply(this,arguments)}function c(){return(c=s((function*(e,t,r){var o={target:{entityLogicalName:"",id:n.Guid.EMPTY},processId:n.Guid.EMPTY,processInstanceId:n.Guid.EMPTY};if(Object(i.isNullOrUndefined)(e.url.match("/api/data/(.*)/RetrieveProcessControlData"))||-1===e.url.indexOf("?"))throw new Error("Incorrect BPF request url");var s=e.url.split(/\?(.+)/),u=s[0].match(/\/api\/data\/.*\/RetrieveProcessControlData\((.*)\)/);if(!u||u.length<2)throw new Error("Incorrect BPF request url");var c=u[1].split(","),l={};for(var d of c){var p=d.split("=");l[p[0]]=p[1]}var f=new URLSearchParams(s[1]),h=f.get(l.ProcessId);h&&(o.processId=n.Guid.tryParse(h));var m=f.get(l.ProcessInstanceId);m&&(o.processInstanceId=n.Guid.tryParse(m));var y=f.get(l.Target);if(y){var v=y.split(":")[1].match(/\"(.*)\((.*)\)\"/);v&&3===v.length&&(o.target.entityLogicalName=yield Object(a.getEntityLogicalName)(t,v[1],r),o.target.id=n.Guid.tryParse(v[2]))}return o}))).apply(this,arguments)}},9128:function(e,t,r){"use strict";r.r(t),r.d(t,"constructBPFRecord",(function(){return N})),r.d(t,"retrieveLocalEntities",(function(){return S})),r.d(t,"retrieveMetadataByQuery",(function(){return R})),r.d(t,"retrieveBPFRecordById",(function(){return I})),r.d(t,"retrieveBPFRecordByProcess",(function(){return O}));var n=r(9045),a=r(9050),i=r(9077),o=r(9047),s=r(9048),u=r(9046),c=r(9054),l=r(9111),d=r(9112),p=r(9063),f=r(9078),h=r(9113),m=r(9117),y=r(9118);function v(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function g(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){v(i,n,a,o,s,"next",e)}function s(e){v(i,n,a,o,s,"throw",e)}o(void 0)}))}}function O(e,t,r,n,a){return E.apply(this,arguments)}function E(){return(E=g((function*(e,t,r,n,i){var o=i.commonEventParameters||[],s=yield b(t,e.entityLogicalName,r),u="".concat(p.CLAUSE.where," ").concat(p.Punctuation.openSQBracket).concat(s+d.columnDelimiter+d.id).concat(p.Punctuation.closeSQBracket," ").concat(p.Punctuation.equal," ").concat(p.Punctuation.question," ").concat(p.CLAUSE.orderBy," ").concat(d.modifiedOn," ").concat(p.SORT.DESC),c=yield S(t,u,[e.id.guid],r,i);return!Object(a.isNullOrUndefined)(c.rows)&&c.rows.length>0?(n.info("".concat(D()," BPF data present for ").concat(t),o),N(t,c.rows.item(0),r,o)):(n.info("".concat(D()," No BPF instance found for ").concat(t),o),null)}))).apply(this,arguments)}function b(e,t,r){return T.apply(this,arguments)}function T(){return(T=g((function*(e,t,r){var n=yield Object(c.getAttributesMetadata)(r,e,[]),i=null,o=[];for(var u of(o.push("createdby"),o.push("modifiedby"),o.push("createdonbehalfbyname"),o.push("modifiedonbehalfbyname"),Object.keys(n))){var l=n[u];if(!(o.indexOf(l.LogicalName)>=0)&&(l.Type===s.AttributeType.Lookup&&!Object(a.isNullOrUndefined)(l.Targets)&&1===l.Targets.length&&l.Targets[0]===t)){if(!l.IsCustomAttribute){i=l;break}l.LogicalName.startsWith("bpf_")&&(Object(a.isNullOrUndefined)(i)||i.ColumnNumber&&l.ColumnNumber&&i.ColumnNumber>l.ColumnNumber)&&(i=l)}}if(Object(a.isNullOrUndefined)(i))throw Error("OfflineDataStore.getEntityIdAttributeFromBpfEntity.Fail : Cannot find an attribute that matches the lookup target in the entity ");return i.LogicalName}))).apply(this,arguments)}function S(e,t,r,n,a){return C.apply(this,arguments)}function C(){return(C=g((function*(e,t,r,i,o){var s="".concat(p.CLAUSE.select," ").concat(p.Punctuation.asterisk," ").concat(p.CLAUSE.from," ").concat(e," ").concat(t),u={sqlStatements:[],sqlParameters:[]};u.sqlStatements.push(s),u.sqlParameters.push(r);var c=yield Object(l.ExecuteSQLBatch)(u,i,n.OPERATION.Retrieve,o);if(!Object(a.isNullOrUndefined)(c)&&c.length>0)return c[0];throw new Error("results is null")}))).apply(this,arguments)}function N(e,t,r,n){return _.apply(this,arguments)}function _(){return(_=g((function*(e,t,r,n){if(!Object(a.isNullOrUndefined)(t))try{var i=yield Object(c.getEntityMetadata)(r,e,n),o=i.PrimaryIdAttribute?i.PrimaryIdAttribute:"";return{entityLogicalName:e,id:u.Guid.tryParse(t["processid!id"]),modifiedon:new Date(t.modifiedon),primaryIdAttribute:o,primaryIdValue:u.Guid.tryParse(t[o])}}catch(s){throw new Error("Error when forming a BPF record")}throw new Error("Error when forming a BPF record")}))).apply(this,arguments)}function R(e,t,r,n){return P.apply(this,arguments)}function P(){return(P=g((function*(e,t,r,n){var a=n.commonEventParameters||[],o=Object(m.getLegacyMetadataTypeForQuery)(t.MetadataType,t.MetadataSubtype),s=o.subtype,u=o.type,c="";t.MetadataId&&(c=t.MetadataId.toString());var l=new y.ApplicationMetadataQuery(u,f.FormFactor.Desktop,t.EntityLogicalName,0,t.GetDefault,c,s,void 0);try{var d=yield Object(h.retrieveMultipleApplicationMetadataByQuery)(e,l,r,n);return d&&d.length?d:(r.warn("".concat(D()," Not able to find the key ").concat(c," for type ").concat(i.MetadataType[u]),a),[])}catch(p){throw r.error("".concat(D()," error retrieving metadata by query for ").concat(c,". ").concat(p.message),a),p}}))).apply(this,arguments)}function I(e,t,r,n,a){return A.apply(this,arguments)}function A(){return(A=g((function*(e,t,r,n,i){var o=i.commonEventParameters||[],s="WHERE [businessprocessflowinstanceid]=".concat(p.Punctuation.question),u=yield S(t,s,[e.guid],n,i);return!Object(a.isNullOrUndefined)(u.rows)&&u.rows.length>0?(r.info("".concat(D()," data present for ").concat(t),o),yield N(t,u.rows.item(0),n,o)):(r.info("".concat(D()," No BPF instance found for ").concat(t),o),null)}))).apply(this,arguments)}function D(e){return"[".concat(e||o.FILE_PREFIX.RetrieveGenerator,"]")}},9129:function(e,t,r){"use strict";r.r(t),r.d(t,"getRequestedColumns",(function(){return d})),r.d(t,"getExpandTermTokens",(function(){return f}));var n=r(9050),a=r(9047),i=r(9048),o=r(9109),s=r(9063),u=r(9112);function c(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function l(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){c(i,n,a,o,s,"next",e)}function s(e){c(i,n,a,o,s,"throw",e)}o(void 0)}))}}function d(e,t,r,n){return p.apply(this,arguments)}function p(){return(p=l((function*(e,t,r,a){var s=[],c=[];if(Object(n.isNullOrUndefinedOrEmptyString)(e))throw r.error("".concat(m()," Empty URL for retrieve request"),a),new Error("Empty url for retrieve request");if(-1===e.indexOf("?"))r.info("".concat(m()," No $select parameter. Returning all columns for entity"),a);else{var l=new URLSearchParams(e.split(/\?(.+)/)[1]).get("$select");Object(n.isNullOrUndefinedOrEmptyString)(l)?r.info("".concat(m()," No $select parameter. Returning all columns for entity"),a):c=l.split(",")}for(var d of(c&&0!==c.length||r.info("".concat(m()," No $select parameter. Returning all columns for entity"),a),c)){var p=Object(o.getAttributeName)(d.trim());t[p]===i.AttributeType.Owner||t[p]===i.AttributeType.Lookup||t[p]===i.AttributeType.Customer?(s.push(p+u.columnDelimiter+u.id),s.push(p+u.columnDelimiter+u.name),s.push(p+u.columnDelimiter+u.logicalName)):s.push(p)}return r.info("".concat(m()," requested for ").concat(s.length," columns"),a),s}))).apply(this,arguments)}function f(e,t,r){return h.apply(this,arguments)}function h(){return(h=l((function*(e,t,r){var a={};if(!e||-1===e.indexOf("?")||-1===e.indexOf("$expand"))return t.info("".concat(m()," Url is empty or does not contain $expand parameter"),r),a;var i=new URLSearchParams(e.split(/\?(.+)/)[1]).get("$expand");if(Object(n.isNullOrUndefinedOrEmptyString)(i))return a;var o=/([a-zA-Z0-9_]+)\(\$filter=Microsoft\.Dynamics\.CRM\.In\(PropertyName='([a-z0-9_,]+)',PropertyValues=\[(.*)\]\)\)?/,u=/([a-zA-Z0-9_\s]+)(\(\$select=([a-z0-9_,\s]+)\)?)/,c=/([a-zA-Z0-9_\s]+)/,l=i.split(/\)\s*,/gi).map(e=>e.trim());for(var d of l){var p=d.match(o);Object(n.isNullOrUndefined)(p)?(p=d.match(u)||d.match(c),Object(n.isNullOrUndefined)(p)||(p.length<3||Object(n.isNullOrUndefinedOrEmptyString)(p[3])?a[p[1]]={values:[],clause:s.CLAUSE.select}:a[p[1]]={values:p[3].split(",").map(e=>e.trim()),clause:s.CLAUSE.select})):a[p[1]]={values:p[3].split(",").map(e=>e.replace(/['"]+/g,"")),clause:s.CLAUSE.in,propertyName:p[2]}}return a}))).apply(this,arguments)}function m(e){return"[".concat(e||a.FILE_PREFIX.RetrieveGenerator,"]")}},9130:function(e,t,r){"use strict";r.r(t),r.d(t,"generateCreateRequests",(function(){return c})),r.d(t,"getCreateOperationSqlQueryRequest",(function(){return d}));var n=r(9045),a=r(9054),i=r(9109),o=r(9063);function s(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function u(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){s(i,n,a,o,u,"next",e)}function u(e){s(i,n,a,o,u,"throw",e)}o(void 0)}))}}function c(e,t,r){return l.apply(this,arguments)}function l(){return(l=u((function*(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},s=n.commonEventParameters||[],u=yield Object(i.getEntityNameFromRequest)(e,t,r,s),c=yield Object(a.getAttributeTypes)(t,[],u,s),l=yield Object(i.getColumnsFromRequestJSON)(e.body,c,u,t,r,s),p=yield Object(i.createEntityRecord)(u,l,o.SqlOperation.create,t,r,s,n);return d(e,t,p,u,s)}))).apply(this,arguments)}function d(e,t,r,n){return p.apply(this,arguments)}function p(){return(p=u((function*(e,t,r,o){var s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],u=f(r),c=yield Object(a.getEntityMetadata)(t,o);return c.IsActivity&&(u=yield Object(i.getInsertActivityPartySQLQueryRequests)(t,r,u,s)),c&&e&&e.additionalHeaders&&e.additionalHeaders.Prefer&&-1!==e.additionalHeaders.Prefer.indexOf(n.HEADER_VALUES.PREFER_REPRESENTATION)&&(u=Object(i.appendRetrieveQuery)(t,u,o,r.id,c.PrimaryIdAttribute,s)),u}))).apply(this,arguments)}function f(e){var t={sqlStatements:[],sqlParameters:new Array,additionalParameters:{[n.ADDITIONAL_PARAMETERS.RecordId]:e.id.guid.toString()}},r="",a="",i=[],s=0;for(var u in e.values)if(u){var c=s>0?",":"";r+=c+"["+u+"]",a+=c+"?",i.push(e.values[u]),s+=1}return t.sqlStatements.push(o.CLAUSE.insert+o.Punctuation.space+o.CLAUSE.into+o.Punctuation.space+o.Punctuation.openSQBracket+e.entityLogicalName+o.Punctuation.closeSQBracket+o.Punctuation.space+o.Punctuation.openParenthesis+r+o.Punctuation.closeParenthesis+o.Punctuation.space+o.CLAUSE.values+o.Punctuation.space+o.Punctuation.openParenthesis+a+o.Punctuation.closeParenthesis),t.sqlParameters.push(i),t}},9131:function(e,t,r){"use strict";r.r(t),r.d(t,"generateDeleteRequests",(function(){return m})),r.d(t,"extractDeleteIdFromURL",(function(){return v})),r.d(t,"generateBaseDeleteSQL",(function(){return g}));var n=r(9058),a=r(9050),i=r(9047),o=r(9054),s=r(9109),u=r(9063),c=r(9112),l=r(9132),d=r(9133),p=r(9144);function f(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function h(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){f(i,n,a,o,s,"next",e)}function s(e){f(i,n,a,o,s,"throw",e)}o(void 0)}))}}function m(e,t,r){return y.apply(this,arguments)}function y(){return(y=h((function*(e,t,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},f=i.commonEventParameters||[],h=[],m=yield Object(s.getEntityNameFromRequest)(e,t,r,f,i),y={sqlStatements:[],sqlParameters:[]},E=g(m,r,f);if(i.internalRequest){var b=Object(d.determineHintsFromODataQueryUrl)(e.url,r,h,Object(a.isUpsyncRequest)(e));if(null==b||!b.filter)throw r.error("".concat(O()," ").concat(u.ERROR_STRING.invalidHints),Object(n.addEventParameters)(f,h)),new Error(u.ERROR_STRING.invalidHints);E=yield Object(p.addFilter)(m,E,b.filter,t,r,i,!0),y.sqlStatements.push(E)}else{var T=v(e.url),S=yield Object(o.getEntityMetadata)(t,m);if(!S||Object(a.isNullOrUndefinedOrEmptyString)(S.PrimaryIdAttribute))throw r.error("".concat(O()," ").concat(u.ERROR_STRING.primaryIdAttribute),f),new Error(u.ERROR_STRING.primaryIdAttribute);if(Object(a.isNullOrUndefinedOrEmptyString)(T))throw r.error("".concat(O()," ").concat(u.ERROR_STRING.referencedId),Object(n.addEventParameters)(f,h)),new Error(u.ERROR_STRING.referencedId);if(y.sqlStatements.push(Object(l.generateSimpleSelectStatement)(m,S.PrimaryIdAttribute,t,r,f)),y.sqlParameters.push([T]),E=Object(p.addAttributeFilter)(E,S.PrimaryIdAttribute),y.sqlStatements.push(E),y.sqlParameters.push([T]),S.IsActivity){var C=c.activityId+u.Punctuation.exclamation+"id",N=g(c.activityParty,r,f);N=Object(p.addAttributeFilter)(N,C),y.sqlStatements.push(N),y.sqlParameters.push([T])}}return r.info("".concat(O()," SQL Query Request: \n  SQL Statement: ").concat(y.sqlStatements)),Promise.resolve(y)}))).apply(this,arguments)}function v(e){var t="";return Object(a.isNullOrUndefinedOrEmptyString)(e)||(t=e.substring(e.lastIndexOf("(")+1,e.length-1)),t}function g(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=[];if(i.push({name:"logicalName",value:e}),Object(a.isNullOrUndefinedOrEmptyString)(e))throw t.error("".concat(O()," ").concat(u.ERROR_STRING.invalidParameter),Object(n.addEventParameters)(r,i)),new Error(u.ERROR_STRING.invalidParameter);return u.CLAUSE.delete+u.Punctuation.space+u.CLAUSE.from+u.Punctuation.space+u.Punctuation.openSQBracket+e+u.Punctuation.closeSQBracket+u.Punctuation.space}function O(e){return"[".concat(e||i.FILE_PREFIX.DeleteGenerator,"]")}},9132:function(e,t,r){"use strict";r.r(t),r.d(t,"generateSimpleSelectStatement",(function(){return s}));var n=r(9058),a=r(9050),i=r(9047),o=r(9063);function s(e,t,r,i){var s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],c=[];if(c.push({name:"logicalName",value:e}),c.push({name:"attribute",value:t}),Object(a.isNullOrUndefinedOrEmptyString)(e)||Object(a.isNullOrUndefinedOrEmptyString)(t))throw i.error("".concat(u()," ").concat(o.ERROR_STRING.invalidParameter),Object(n.addEventParameters)(s,c)),new Error(o.ERROR_STRING.invalidParameter);return o.CLAUSE.select+o.Punctuation.space+o.Punctuation.openSQBracket+t+o.Punctuation.closeSQBracket+o.Punctuation.space+o.CLAUSE.from+o.Punctuation.space+o.Punctuation.openSQBracket+e+o.Punctuation.closeSQBracket+o.Punctuation.space+o.CLAUSE.where+o.Punctuation.space+o.Punctuation.openSQBracket+t+o.Punctuation.closeSQBracket+o.Punctuation.space+o.Punctuation.equal+o.Punctuation.space+o.Punctuation.question+o.Punctuation.space+o.CLAUSE.collateNoCase}function u(e){return"[".concat(e||i.FILE_PREFIX.SQLModifier,"]")}},9133:function(e,t,r){"use strict";r.r(t),r.d(t,"determineHintsFromQuery",(function(){return O})),r.d(t,"determineHintsFromODataQueryUrl",(function(){return b})),r.d(t,"createEntityQueryExpressionFromFetchXml",(function(){return R})),r.d(t,"getHintFromCondition",(function(){return P})),r.d(t,"getHintFromConditions",(function(){return I})),r.d(t,"getHintFromExpression",(function(){return A})),r.d(t,"convertEntityQueryToHintOptions",(function(){return D}));var n=r(9045),a=r(9063),i=r(9047),o=r(9134),s=r(9050),u=r(9056),c=r(9137),l=r(9138),d=r(9139),p=r(9140),f=r(9142),h=r(9054),m=r(9109),y=r(9143);function v(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function g(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){v(i,n,a,o,s,"next",e)}function s(e){v(i,n,a,o,s,"throw",e)}o(void 0)}))}}function O(e,t,r,n,a,i){return E.apply(this,arguments)}function E(){return(E=g((function*(e,t,r,i,u,c){var l,d,p,f=c?c.commonEventParameters:[],m=e.url;(-1===m.indexOf(a.Punctuation.question)&&u.warn("".concat(G()," Request URL does not contain FetchXML nor ODataQuery"),f),-1!==e.url.indexOf(n.FETCH_PREFIX))?(p=R(decodeURIComponent(m.substring(m.indexOf(n.FETCH_PREFIX)+n.FETCH_PREFIX.length,m.length)),t,i,u,f),l=yield D(p,i,u,f)):(d=a.Punctuation.question,-1!==m.indexOf(a.Punctuation.question)?d=(yield Object(h.isFeatureEnabled)(i,a.FCB_CONSTANTS.CustomPageOffline))?(d=m.substring(m.indexOf(a.Punctuation.question),m.length)).indexOf(a.Punctuation.plus)>-1&&d.indexOf(encodeURIComponent(a.Punctuation.dollar))>-1?decodeURIComponent(d.replace(/\+/g," ")):decodeURIComponent(d):decodeURIComponent(m.substring(m.indexOf(a.Punctuation.question),m.length)):u.warn("".concat(G()," No ODataQuery part found in client api retrieve multiple request for OData query, Default query to '?'"),f),r[n.ADDITIONAL_PARAMETERS.ODataQuery]=d,l=Object(o.convertODataQueryToHints)(d,u,f,Object(s.isUpsyncRequest)(e)),yield C(l,i,m,t,u,f));_(l,e,!!d),T(l,e,u,f),S(l,r)}))).apply(this,arguments)}function b(e,t,r,n){if(-1!==e.indexOf(a.Punctuation.question)){var i=decodeURIComponent(e.substring(e.indexOf(a.Punctuation.question),e.length));return Object(o.convertODataQueryToHints)(i,t,r,n)}return{}}function T(e,t,r,a){t&&t.additionalHeaders?(e.select&&(t.additionalHeaders[n.HINT.select]=e.select),e.orderBy&&(t.additionalHeaders[n.HINT.orderBy]=e.orderBy),e.filter&&(t.additionalHeaders[n.HINT.filter]=e.filter),e.linkEntity&&(t.additionalHeaders[n.HINT.linkEntity]=e.linkEntity,t.additionalHeaders[n.HINT.contextFilter]&&delete t.additionalHeaders[n.HINT.contextFilter]),e.pageNumber&&(t.additionalHeaders[n.HINT.pageNumber]=e.pageNumber.toString()),e.pageSize&&(t.additionalHeaders[n.HINT.pageSize]=e.pageSize.toString()),e.viewId&&(t.additionalHeaders[n.HINT.viewId]=e.viewId)):r.warn("".concat(G()," Unable to add hints to client api request with null header "),a)}function S(e,t){e.top&&(t[n.ADDITIONAL_PARAMETERS.Top]=e.top),e.expand&&(t[n.ADDITIONAL_PARAMETERS.Expand]=e.expand),e.maxPageSize&&(t[n.ADDITIONAL_PARAMETERS.MaxPageSize]=e.maxPageSize),e.navigationPropertyRelationshipName&&(t[n.ADDITIONAL_PARAMETERS.NavigationPropertyRelationshipName]=e.navigationPropertyRelationshipName),e.referencedEntity&&(t[n.ADDITIONAL_PARAMETERS.NavigationPropertyEntity]=e.referencedEntity),e.referencedEntityId&&(t[n.ADDITIONAL_PARAMETERS.RecordId]=e.referencedEntityId)}function C(e,t,r,n,a,i){return N.apply(this,arguments)}function N(){return(N=g((function*(e,t,r,n,i,o){var s=r.indexOf(a.Punctuation.question),u=r.indexOf(a.Punctuation.openParenthesis),c=r.indexOf(a.Punctuation.closeParenthesis),l=r.lastIndexOf(a.Punctuation.forwardSlash);if((yield Object(h.isFeatureEnabled)(t,a.FCB_CONSTANTS.CustomPageOffline))&&u<c&&c<l){var d=r.substring(u+1,c),p=-1===s?r.substring(l+1):r.substring(l+1,s),m=yield Object(f.getOnetoManyRelationshipByNavigationProperty)(t,n,p,i,o);m&&(e.navigationPropertyRelationshipName=m.SchemaName,e.referencedEntityId=d,e.referencedEntity=m.ReferencingEntity)}}))).apply(this,arguments)}function _(e,t,r){var n,a=Object(s.getMaxPageSizeFromPrefer)(t);if(a?(e.maxPageSize=a,n=a<5e3?a:5e3):n=5e3,r&&e.top&&e.top<n)n=e.top;else if(!r&&Object(s.isNullOrUndefined)(a)){var i=e.count&&e.count<5e3?e.count:5e3;n=e.top&&i>e.top?e.top:i}e.pageSize=n}function R(e,t,r,n){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];if(Object(s.isNullOrUndefinedOrEmptyString)(e)){var i="FetchXml string is empty or null";throw n.error("".concat(G()," ").concat(i),a),new u.LocalError(i)}var o=Object(c.initializeEntityQueryExpression)(r);try{Object(l.parseFetchXmlIntoQueryExpression)(e,o,n,a)}catch(f){var d="Exception in creating the entity query expression from fetchXml";throw n.error("".concat(G()," ").concat(d,": ").concat(Object(s.getErrorMessage)(f)),a),new u.LocalError(null!=f&&f.message?f.message:d,null==f?void 0:f.code,null==f?void 0:f.stack,null==f?void 0:f.name)}if(t!==o.entityName){var p="Request URL entity name does not match fetchXml entity name";throw n.error("".concat(G()," ").concat(p),a),new u.LocalError(p)}return o}function P(e){return e.value?"".concat(e.attributeName," ").concat(e.operator," '").concat(e.value,"'"):"".concat(e.attributeName," ").concat(e.operator)}function I(e,t,r,n){var a="";if(1===e.length)return a=P(e[0]),t===p.LogicalOperator.not&&(a="".concat(p.LogicalOperator[p.LogicalOperator.not]," (").concat(a,")")),a;if(e.length>1){a=P(e[0]);for(var i=1;i<e.length;i++){var o=P(e[i]);a="".concat(a," ").concat(p.LogicalOperator[t]," ").concat(o)}return a}if(0===e.length){var s="No values for condition";throw r.error("".concat(G()," ").concat(s),n),new u.LocalError(s)}return a}function A(e,t,r){var n="";if(!e)return"";var a=e.getConditions();(null==a?void 0:a.length)>0&&(n=I(a,e.getFilterOperator(),t,r));var i,o=e.getFilterExpressions(),c=p.LogicalOperator[e.getFilterOperator()];if(!o||0===o.length)return n;if(Object(s.isNullOrUndefinedOrEmptyString)(n)||(n="".concat(n," ").concat(c," ")),1===o.length)switch(i=A(o[0],t,r),c){case p.LogicalOperatorString.and:case p.LogicalOperatorString.or:return"".concat(n,"(").concat(i,")");case p.LogicalOperatorString.not:return"".concat(n).concat(c," (").concat(i,")");default:var l="Invalid logical operator ".concat(c,".");throw t.error("".concat(G()," ").concat(l),r),new u.LocalError(l)}else{i=A(o[0],t,r),n=Object(d.isSimpleCondition)(o[0]||o[0].getConditions().length>1)?"".concat(n).concat(i):"".concat(n,"(").concat(i,")");for(var f=1;f<o.length;f++)i=A(o[f],t,r),(!Object(d.isSimpleCondition)(o[f])||o[f].getConditions().length>1)&&(i="(".concat(i,")")),n="".concat(n," ").concat(c," ").concat(i)}return n}function D(e,t,r,n){return M.apply(this,arguments)}function M(){return(M=g((function*(e,t,r,n){var i,o,s,u;if((yield Object(h.isFeatureEnabled)(t,a.FCB_CONSTANTS.ModernDataLayerRMValidations))&&!(yield F(e,t,r,n))){var c=new Error("One or more requested attributes is invalid. Check event context for more details");throw r.error("".concat(G()," ").concat(c.message),n),c}o=e.allAttributesRequested||!e.attributes||0===e.attributes.length?a.Punctuation.asterisk:e.attributes.map(e=>e.name).toString(),(null===(i=e.orderByAttributes)||void 0===i?void 0:i.length)>0&&(s=e.orderByAttributes.map(e=>"".concat(e.name," ").concat(e.descending?a.SORT.DESC:a.SORT.ASC)).toString()),e.filterExpression&&(u=A(e.filterExpression,r,n));var l={select:o,orderBy:s,filter:u,pageNumber:e.pageNumber,top:e.top,count:e.count},d=[];return yield q(e,l,d,t,r,n),d.length>0&&(l.linkEntity=d.join(";")),l}))).apply(this,arguments)}function F(e,t,r,n){return w.apply(this,arguments)}function w(){return(w=g((function*(e,t,r,n){var a=yield Object(y.entityHasAttributes)(e.entityName,x(e),t,r,n),i=yield L(e,t,r,n);return a&&i}))).apply(this,arguments)}function L(e,t,r,n){return j.apply(this,arguments)}function j(){return(j=g((function*(e,t,r,n){var a;if(!e||!e.linkedEntities||0===e.linkedEntities.length)return!0;if((null===(a=e.linkedEntities)||void 0===a?void 0:a.length)>0)for(var i=0;i<e.linkedEntities.length;i++){var o=e.linkedEntities[i];if((yield B(t,e.entityName||"",o.entityName||"",o.linkFromAttribute||"",o.linkToAttribute||"",r,n)).isManyToManyRelationship){if(!F(o.linkedEntities[0],t,r,n))return!1}else{var s=x(o);if(o.linkFromAttribute&&s.push(o.linkFromAttribute),!(yield Object(y.entityHasAttributes)(o.entityName,s,t,r,n))||!L(o,t,r,n))return!1}}return!0}))).apply(this,arguments)}function x(e){var t,r;return e?[...null===(t=e.attributes)||void 0===t?void 0:t.map(e=>e.name),...null===(r=e.orderByAttributes)||void 0===r?void 0:r.map(e=>e.name),...U(e.filterExpression),...k(e)]:[]}function U(e){var t;if(!e)return[];var r=[];if(e.getConditions()&&r.push(...e.getConditions().map(e=>e.attributeName)),(null===(t=e.getFilterExpressions())||void 0===t?void 0:t.length)>0)for(var n of e.getFilterExpressions())r.push(...U(n));return r}function k(e){var t;if(!e||!e.linkedEntities||0===e.linkedEntities.length)return[];var r=[];if((null===(t=e.linkedEntities)||void 0===t?void 0:t.length)>0)for(var n=0;n<e.linkedEntities.length;n++){var a=e.linkedEntities[n];Object(s.isNullOrUndefinedOrEmptyString)(a.linkToAttribute)||r.push[a.linkToAttribute]}return r}function q(e,t,r,n,a,i){return V.apply(this,arguments)}function V(){return(V=g((function*(e,t,r,n,i,o){var u,c=(null==e?void 0:e.alias)||"".concat(e.entityName,"0");if((null===(u=e.linkedEntities)||void 0===u?void 0:u.length)>0)for(var l=0;l<e.linkedEntities.length;l++){var d=e.linkedEntities[l],{relationshipName:f,roleOrdinal:h,entityNameForHint:y}=yield B(n,e.entityName||"",d.entityName||"",d.linkFromAttribute||"",d.linkToAttribute||"",i,o);Object(s.isNullOrUndefinedOrEmptyString)(d.alias)&&(d.alias="".concat(d.entityName).concat(r.length+1));var v=[];for(var g of d.attributes){!!d.entityName&&(yield Object(m.isSpecialAttribute)(n,d.entityName,g.name,i,o))||v.push("".concat(d.alias,".").concat(g.name))}v.length>0&&(t.select="".concat(t.select,",").concat(v.toString()));var O=[];for(var E of d.orderByAttributes){!!d.entityName&&(yield Object(m.isSpecialAttribute)(n,d.entityName,E.name,i,o))||O.push("".concat(d.alias,".").concat(E.name," ").concat(E.descending?a.SORT.DESC:a.SORT.ASC))}O.length>0&&(t.orderBy="".concat(t.orderBy,",").concat(O.toString()));var b="";d.filterExpression&&(b=A(d.filterExpression,i,o)),b?r.push("".concat(y," ").concat(c," ").concat(f," ").concat(h," ").concat(d.alias," ").concat(p.JoinType[d.joinType]," (").concat(b,")")):r.push("".concat(y," ").concat(c," ").concat(f," ").concat(h," ").concat(d.alias," ").concat(p.JoinType[d.joinType])),yield q(d,t,r,n,i,o)}}))).apply(this,arguments)}function B(e,t,r,n,a,i,o){return H.apply(this,arguments)}function H(){return(H=g((function*(e,t,r,n,a,i,o){var s=yield Object(h.getEntityMetadata)(e,t);if(s){if(s.OneToManyRelationships)for(var c in s.OneToManyRelationships){var l=s.OneToManyRelationships[c];if(l.ReferencingEntity===r&&l.ReferencingAttribute===n&&l.ReferencedAttribute===a)return{entityNameForHint:t,relationshipName:c,roleOrdinal:f.RelationshipRoleOrdinalString.Referencing}}if(s.ManyToOneRelationships)for(var d in s.ManyToOneRelationships){var p=s.ManyToOneRelationships[d];if(p.ReferencedEntity===r&&p.ReferencedAttribute===n&&p.ReferencingAttribute===a)return{entityNameForHint:t,relationshipName:d,roleOrdinal:f.RelationshipRoleOrdinalString.Referencing}}if(s.ManyToManyRelationships)for(var m in s.ManyToManyRelationships){var y=s.ManyToManyRelationships[m];if(y.IntersectEntityName===r&&y.Entity2IntersectAttribute===n&&y.Entity2IntersectAttribute===a)return{entityNameForHint:t,relationshipName:m,roleOrdinal:f.RelationshipRoleOrdinalString.Referencing,isManyToManyRelationship:!0};if(y.IntersectEntityName===t&&y.Entity1IntersectAttribute===n&&y.Entity1IntersectAttribute===a)return{entityNameForHint:y.Entity1LogicalName,relationshipName:m,roleOrdinal:f.RelationshipRoleOrdinalString.AssociationEntity,isManyToManyRelationship:!0}}}var v="Relationship not found for entity ".concat(t," to link entity ").concat(r," with from=").concat(n," and to=").concat(a,".");throw i.error("".concat(G()," ").concat(v),o),new u.LocalError(v)}))).apply(this,arguments)}function G(e){return"[".concat(e||i.FILE_PREFIX.DetermineHints,"]")}},9134:function(e,t,r){"use strict";r.r(t),r.d(t,"QUERY_TOKENS",(function(){return s})),r.d(t,"parseODataQuery",(function(){return u})),r.d(t,"convertODataQueryToHints",(function(){return c}));var n=r(9050),a=r(9047),i=r(9135),o=r(9109),s={skipToken:"$skiptoken",orderBy:"$orderby",top:"$top",select:"$select",expand:"$expand",filter:"$filter",oDataNextLink:"@odata.nextLink",getOnlyRelatedEntity:"$getOnlyRelatedEntity",savedQuery:"savedQuery"};function u(e,t,r,a){var i={};if(Object(n.isNullOrUndefinedOrEmptyString)(e)){return t.warn("".concat(l()," ").concat("Unable to process OData query to hint with undefined or empty query"),r),i}for(var o,s,u=1;u<e.length;){if(-1===(o=a?e.indexOf("&$",u):e.indexOf("&",u))&&(o=e.length),(s=e.indexOf("=",u))>o&&(s=-1),-1!==s&&s<o){var c=e.substr(u,s-u),d=e.substr(s+1,o-s-1);c in i?t.warn("".concat(l()," Multiple occurrence of ").concat(c," option found in uri input, therefore skip adding duplication key"),r):i[c]=d}u=o+1}return i}function c(e,t,r,n){var a=u(e,t,r,n),c={};if(a)a[s.expand]&&(c.expand=Object(i.expandParser)(a[s.expand],t,r,n)),a[s.select]&&(c.select=Object(o.extractAdditionalColumnNames)(a[s.select]).join(",")),a[s.orderBy]&&(c.orderBy=Object(o.extractAdditionalColumnNames)(a[s.orderBy]).join(",")),a[s.top]&&(c.top=a[s.top]),a[s.filter]&&(c.filter=a[s.filter]),a[s.skipToken]&&(c.pageNumber=a[s.skipToken]),a[s.savedQuery]&&(c.viewId=a[s.savedQuery]);else{t.warn("".concat(l()," ").concat("No odata query tokens passed via ODataURI"),r)}return c.select||(c.select="*"),c}function l(e){return"[".concat(e||a.FILE_PREFIX.ODataQueryParser,"]")}},9135:function(e,t,r){"use strict";r.r(t),r.d(t,"ExpressionTokenKind",(function(){return n})),r.d(t,"ExpandTermParser",(function(){return l})),r.d(t,"expandParser",(function(){return d})),r.d(t,"generateExpandTermString",(function(){return m}));var n,a=r(9136),i=r(9050),o=r(9063),s=r(9134),u=r(9109),c=r(9047);!function(e){e[e.unknown=0]="unknown",e[e.end=1]="end",e[e.equal=2]="equal",e[e.openParenthesis=3]="openParenthesis",e[e.closeParenthesis=4]="closeParenthesis",e[e.comma=5]="comma",e[e.question=6]="question",e[e.identifier=7]="identifier"}(n||(n={}));class l{constructor(e){this.lexer=void 0,this.lexer=e}parseTerm(){var e=this.lexer.getToken().text;return this.lexer.nextToken(),e}}function d(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3?arguments[3]:void 0,o=[],s=new a.ExpressionLexer(e);if(s.nextToken(),s.getToken().kind===n.end){var u="'Invalid Expand Expression passed";throw new Error(u)}for(o.push(h(s,t,r,i));s.getToken().kind===n.comma&&(s.nextToken(),s.getToken().kind!==n.end);)o.push(h(s,t,r,i));if(s.getToken().kind!==n.end){var c="Improper Expand string provided";throw new Error(c)}return o}function p(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4?arguments[4]:void 0;Object(i.isNullOrUndefinedOrEmptyString)(t)||(t=(t=f(t=t.replace(o.WHITE_SPACE_REGEX,""))).startsWith(o.Punctuation.question)?t:"".concat(o.Punctuation.question).concat(t));var c=Object(s.parseODataQuery)(t,r,n,a),l={navigationProperty:e};for(var d in c)if(d===s.QUERY_TOKENS.select)l.selectOption=Object(u.extractAdditionalColumnNames)(c[s.QUERY_TOKENS.select]);else{var p="Query option ".concat(c[d]," is not supported within $expand of Client API OData Query request");r.warn("".concat(y()," ").concat(p),n)}return l}function f(e){var t=e.startsWith("("),r=e.endsWith(")");return t&&(e=e.substring(1,e.length)),r&&(e=e.substring(0,e.length-1)),e.trim()}function h(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=arguments.length>3?arguments[3]:void 0,o=new l(e),s=o.parseTerm();if(Object(i.isNullOrUndefinedOrEmpty)(s)){var u="property ".concat(s," with value Relationship name is undefined");throw t.error("".concat(y()," ").concat(u),r),new Error(u)}var c=null;return e.getToken().kind===n.openParenthesis&&(c=e.advanceThroughBalancedParentheticalExpression(),e.nextToken()),p(s,c,t,r,a)}function m(e){var t="$expand=".concat(e.navigationProperty);return e.selectOption&&!Object(i.isNullOrUndefinedOrEmpty)(e.selectOption)&&(t+="($select=".concat(e.selectOption.join(","),")")),t}function y(e){return"[".concat(e||c.FILE_PREFIX.ExpandParser,"]")}},9136:function(e,t,r){"use strict";r.r(t),r.d(t,"ExpressionLexer",(function(){return o}));var n=r(9050),a=r(9135),i=r(9063);class o{constructor(e){this.text=void 0,this.textLength=void 0,this.currentchar=void 0,this.textPosition=void 0,this.token=void 0,this.alphaNumericRegex=void 0,this.whiteSpaceRegex=void 0,this.alphaNumericRegex=new RegExp("[a-zA-Z1-9]","g"),this.whiteSpaceRegex=i.WHITE_SPACE_REGEX,this.text=e,this.textLength=e.length,this.textPosition=0,this.currentchar=this.textPosition<this.textLength?this.text.charAt(this.textPosition):"\0",this.token={text:"",position:0,kind:0}}nextToken(){return this.NextTokenImplementation()}NextTokenImplementation(){this.skipWhiteSpace();var e=this.textPosition;return this.token.kind=this.getExpressionTokenKind(),this.token.text=this.text.substr(e,this.textPosition-e),this.token.position=e,this.token}isValidWhiteSpace(){var e=this.currentchar.toString().match(this.whiteSpaceRegex);return!("\0"===this.currentchar||!e||e.length<0)}getPosition(){return this.token.position}getToken(){return this.token}isValidCharForIdentifier(){var e=this.currentchar.toString().match(this.alphaNumericRegex);return"\0"!==this.currentchar&&(!Object(n.isNullOrUndefinedOrEmptyString)(e)&&1===e.length||"_"===this.currentchar||"$"===this.currentchar)}skipWhiteSpace(){for(;this.isValidWhiteSpace();)this.nextChar()}getExpressionTokenKind(){var e=0;switch(this.currentchar){case i.Punctuation.openParenthesis:this.nextChar(),e=a.ExpressionTokenKind.openParenthesis;break;case i.Punctuation.closeParenthesis:this.nextChar(),e=a.ExpressionTokenKind.closeParenthesis;break;case i.Punctuation.comma:this.nextChar(),e=a.ExpressionTokenKind.comma;break;default:if(this.isValidWhiteSpace()){this.skipWhiteSpace(),e=0;break}if(this.isValidCharForIdentifier()){this.parseIdentifier(),e=a.ExpressionTokenKind.identifier;break}if(this.textPosition===this.textLength){e=a.ExpressionTokenKind.end;break}throw new Error("Unknown CharacterType Received")}return e}nextChar(){this.textPosition<this.textLength&&this.textPosition++,this.currentchar=this.textPosition===this.textLength?"\0":this.text.charAt(this.textPosition)}parseIdentifier(){do{this.nextChar()}while(this.isValidCharForIdentifier())}advanceThroughBalancedParentheticalExpression(){var e=this.getPosition();return this.advanceThroughBalancedExpression(i.Punctuation.openParenthesis,i.Punctuation.closeParenthesis),this.text.substr(e,this.textPosition-e)}advanceThroughBalancedExpression(e,t){for(var r=1;r>0;)this.currentchar===e?r++:this.currentchar===t&&r--,this.nextChar()}}},9137:function(e,t,r){"use strict";r.r(t),r.d(t,"initializeEntityQueryExpression",(function(){return o}));var n=r(9050),a=r(9138),i=r(9140);function o(e,t,r,o){var s={pageNumber:1,entityName:null!=t?t:"",tableAliasCount:0,tableAliases:[],attributes:new Array(0),attributesByName:{},allAttributesRequested:!1,orderByAttributes:new Array(0),groupByAttributes:new Array(0),aggregateAttributes:new Array(0),linkedEntities:new Array(0),alias:"",parentEntity:r,applicationContext:e,useLimitStatement:!0};return s.tableAlias=Object(a.generateTableAlias)(s,null!=t?t:""),r?(s.baseEntity=r.baseEntity,s.joinType=Object(n.isNullOrUndefined)(o)?i.JoinType.inner:o):s.baseEntity=s,s}},9138:function(e,t,r){"use strict";r.r(t),r.d(t,"parseFetchXmlFromString",(function(){return p})),r.d(t,"getAttributeValue",(function(){return f})),r.d(t,"parseLinkEntityNode",(function(){return h})),r.d(t,"getLinkType",(function(){return m})),r.d(t,"filterParser",(function(){return y})),r.d(t,"initialize",(function(){return v})),r.d(t,"parseFetchXmlIntoQueryExpression",(function(){return g})),r.d(t,"generateTableAlias",(function(){return O}));var n,a,i=r(9050),o=r(9139),s=r(9140),u=r(9141),c=r(9056),l=r(9047),d=r(9045);function p(e){return(new DOMParser).parseFromString(e,"text/xml")}function f(e,t){if(!Object(i.isNullOrUndefined)(e)&&!Object(i.isNullOrUndefined)(e.attributes)){var r,n=e.attributes.getNamedItem(t);if(!Object(i.isNullOrUndefined)(n))return null!==(r=null==n?void 0:n.nodeValue)&&void 0!==r?r:""}return""}function h(e,t,r,n,i){var o=f(e,a.name),c=f(e,a.from),l=f(e,a.to),d=f(e,a.alias),p=Object(u.initializeLinkEntityQueryExpression)(r,o,t);return Object(u.setLinkProperties)(p,c,l,s.ConditionalOperator.equal,m(e,n,i),d),v(e,p,r,n,i),p}function m(e,t,r){var n=f(e,a.linkType);if(!n)return s.JoinType.inner;switch(n){case s.JoinType[s.JoinType.natural]:return s.JoinType.natural;case s.JoinType[s.JoinType.inner]:return s.JoinType.inner;case s.JoinType[s.JoinType.outer]:return s.JoinType.outer;case s.JoinType[s.JoinType.matchfirstrowusingcrossapply]:return s.JoinType.matchfirstrowusingcrossapply;case s.JoinType[s.JoinType.exists]:return s.JoinType.exists;case s.JoinType[s.JoinType.in]:return s.JoinType.in;default:var i="Invalid join type";throw t.error("".concat(E()," ").concat(i),r),new c.LocalError(i)}}function y(e,t,r,u){for(var l=e.childNodes,d=0;d<l.length;d++){var p=l[d];if(!Object(i.isNullOrUndefined)(p.tagName)){var h=p.tagName.toLocaleLowerCase();switch(h){case n.filter:var m=f(p,a.type),v=void 0;switch(m&&m.toLowerCase()){case s.LogicalOperatorString.and:v=s.LogicalOperator.and;break;case s.LogicalOperatorString.or:v=s.LogicalOperator.or;break;case s.LogicalOperatorString.not:v=s.LogicalOperator.not;break;default:var g="Unsupported filter operator: ".concat(m);throw r.error("".concat(E()," ").concat(g),u),new c.LocalError(g)}var O=new o.FilterExpression(v,"tempValue");O=y(p,O,r,u),t.addFilterExpression(O);break;case n.condition:var b=f(p,a.attribute),T=f(p,a.operator),S=f(p,a.value),C=f(p,a.uitype);if(Object(i.isNullOrUndefinedOrEmptyString)(S)){var N=p.childNodes;if(N.length>0){for(var _=[],R=0;R<N.length;R++){var P,I,A=N[R];Object(i.isNullOrUndefined)(null==A||null===(P=A.firstChild)||void 0===P?void 0:P.nodeValue)||_.push(null==A||null===(I=A.firstChild)||void 0===I?void 0:I.nodeValue)}t.addCondition(b,T,_,C)}else t.addCondition(b,T,void 0,C)}else t.addCondition(b,T,S);break;default:var D="Unsupported filter node name: ".concat(h);throw r.error("".concat(E()," ").concat(D),u),new c.LocalError(D)}}}return t}function v(e,t,r,u,l){t.hasAggregate="true"===f(e,a.aggregate);var d=f(e,a.count);d&&r.Formatter&&(t.count=r.Formatter.parseIntegerValue(d));var p,m=f(e,a.page);m&&r.Formatter&&(t.pageNumber=null!==(p=r.Formatter.parseIntegerValue(m))&&void 0!==p?p:t.pageNumber);var v=f(e,a.top);if(v&&r.Formatter&&(t.top=r.Formatter.parseIntegerValue(v)),t.top&&t.count){var g="Providing both count and top in the fetchXml is invalid";throw u.error("".concat(E()," ").concat(g),l),new c.LocalError(g)}var b=null==e?void 0:e.getElementsByTagName(n.entity),T=b&&b[0];if(Object(i.isNullOrUndefined)(T)&&e.tagName===n.linkEntity&&(T=e),Object(i.isNullOrUndefined)(t.parentEntity)){var S=f(b[0],a.name);t.tableAliasCount=0,t.tableAliases=[],t.tableAlias=O(t,S),t.baseEntity=t}!function(e,t,r,u){t.entityName=f(e,a.name);for(var l=e.childNodes,d=0;d<l.length;d++){var p=l[d];if(!Object(i.isNullOrUndefined)(p.tagName)){var m=p.tagName.toLocaleLowerCase();switch(m){case n.attribute:var v=f(p,a.name),g=f(p,a.alias),O={name:v,entity:t};t.attributesByName[g||v]=O,t.attributes.push(O),f(p,a.aggregate)&&(t.aggregateAttributes[t.aggregateAttributes.length]=O);var b=f(p,a.groupby);b&&"true"===b&&(t.groupByAttributes[t.groupByAttributes.length]=O);break;case n.allAttributes:t.allAttributesRequested=!0;break;case n.order:var T=f(p,a.attribute),S=f(p,a.descending),C={name:T,descending:!!S&&"true"===S,entity:t};t.orderByAttributes.push(C);break;case n.linkEntity:t.linkedEntities.push(h(p,t,t.applicationContext,r,u));break;case n.filter:var N=f(p,a.type),_=N&&N.toLowerCase()===s.LogicalOperatorString.or?s.LogicalOperator.or:s.LogicalOperator.and;t.filterExpression=new o.FilterExpression(_,t.entityName),t.filterExpression=y(p,t.filterExpression,r,u);break;default:var R="Unsupported node type for fetch xml: ".concat(m);throw r.error("".concat(E()," ").concat(R),u),new c.LocalError(R)}}}}(T,t,u,l)}function g(e,t,r,a){var i=p(e);if(!i)throw r.error("".concat(E()," ").concat("Invalid fetch XML"),a),new c.LocalError("Invalid fetch XML");var o=i.getElementsByTagName(n.parsererror);if(o&&o.length>0){var s="".concat("Invalid fetch XML"," - XML parsing error.");throw r.error("".concat(E()," ").concat(s),a),new c.LocalError(s,d.ErrorCode.InvalidXml)}var u=i.getElementsByTagName(n.fetch);if(u&&u.length>1){var l="".concat("Invalid fetch XML"," - more than one fetch node.");throw r.error("".concat(E()," ").concat(l),a),new c.LocalError(l)}if(!u||0===u.length){var f="".concat("Invalid fetch XML"," - no fetch node.");throw r.error("".concat(E()," ").concat(f),a),new c.LocalError(f)}t.fetchXmlDoc=u[0],v(t.fetchXmlDoc,t,t.applicationContext,r,a)}function O(e,t){if(!Object(i.isNullOrUndefinedOrEmptyString)(t)){var r="".concat(t).concat(e.tableAliasCount++);return e.tableAliases.push(r),r}return""}function E(e){return"[".concat(e||l.FILE_PREFIX.FetchXmlParser,"]")}!function(e){e.fetch="fetch",e.entity="entity",e.linkEntity="link-entity",e.attribute="attribute",e.allAttributes="all-attributes",e.order="order",e.filter="filter",e.condition="condition",e.parsererror="parsererror"}(n||(n={})),function(e){e.aggregate="aggregate",e.name="name",e.attribute="attribute",e.alias="alias",e.count="count",e.page="page",e.top="top",e.from="from",e.to="to",e.linkType="link-type",e.groupby="groupby",e.descending="descending",e.type="type",e.operator="operator",e.value="value",e.uitype="uitype"}(a||(a={}))},9139:function(e,t,r){"use strict";r.r(t),r.d(t,"FilterExpression",(function(){return a})),r.d(t,"isSimpleCondition",(function(){return i}));var n=r(9050);class a{constructor(e,t){this._filterExpressionId="",this._filterOperator=0,this._conditions=[],this._filterExpressions=[],this.setFilterOperator(e),this.setFilterExpressionId(t),this.setFilterExpressions([])}getFilterExpressionId(){return this._filterExpressionId}setFilterExpressionId(e){return this._filterExpressionId=e,e}getFilterOperator(){return this._filterOperator}setFilterOperator(e){return this._filterOperator=e,e}getConditions(){return this._conditions}setConditions(e){return this._conditions=e,e}getFilterExpressions(){return this._filterExpressions}setFilterExpressions(e){return this._filterExpressions=e,e}addCondition(e,t,r,a){var i={attributeName:e,operator:t,value:r=Object(n.isNullOrUndefined)(r)?null:r,entityName:a};return this.getConditions()||this.setConditions([]),this.getConditions().push(i),this}addFilterExpression(e){return e?(this.getFilterExpressions().push(e),this):this}}function i(e){return 0===e.getFilterExpressions().length}},9140:function(e,t,r){"use strict";r.r(t),r.d(t,"TokenType",(function(){return n})),r.d(t,"LogicalOperator",(function(){return a})),r.d(t,"LogicalOperatorString",(function(){return i})),r.d(t,"LogicalOperatorPriority",(function(){return o})),r.d(t,"FunctionOperator",(function(){return s})),r.d(t,"ConditionalOperator",(function(){return u})),r.d(t,"JoinType",(function(){return c})),r.d(t,"JoinTypeSQL",(function(){return l})),r.d(t,"getTokenType",(function(){return p}));var n,a,i,o,s,u,c,l,d=r(9063);function p(e){switch(e.toLowerCase()){case d.Punctuation.openParenthesis:return n.openBracket;case d.Punctuation.closeParenthesis:return n.closeBracket;case i.and:case i.or:case i.not:return n.logicalOperator;default:return n.operand}}!function(e){e[e.openBracket=0]="openBracket",e[e.closeBracket=1]="closeBracket",e[e.logicalOperator=2]="logicalOperator",e[e.operand=3]="operand"}(n||(n={})),function(e){e[e.and=0]="and",e[e.or=1]="or",e[e.not=2]="not"}(a||(a={})),function(e){e.and="and",e.or="or",e.not="not"}(i||(i={})),function(e){e[e.not=1]="not",e[e.and=2]="and",e[e.or=3]="or"}(o||(o={})),function(e){e.functionIn="Microsoft.Dynamics.CRM.In",e.contains="contains",e.functionContains="Microsoft.Dynamics.CRM.Contains"}(s||(s={})),function(e){e.equal="eq",e.notEqual="ne",e.in="in",e.like="like",e.greaterThan="gt",e.greaterThanEqual="ge",e.lessThan="lt",e.lessThanEqual="le",e.equalsUserId="eq-userid",e.notIn="not-in",e.null="null",e.notNull="not-null",e.notLike="not-like",e.beginsWith="begins-with",e.notBeginWith="not-begin-with",e.endsWith="ends-with",e.notEndWith="not-end-with",e.notEqualsUserId="ne-userid",e.equalsUserTeams="eq-userteams",e.equalsUserOrUserTeams="eq-useroruserteams",e.between="between",e.notBetween="not between"}(u||(u={})),function(e){e[e.inner=0]="inner",e[e.outer=1]="outer",e[e.natural=2]="natural",e[e.matchfirstrowusingcrossapply=3]="matchfirstrowusingcrossapply",e[e.in=4]="in",e[e.exists=5]="exists"}(c||(c={})),function(e){e.inner="inner",e.leftouter="left outer"}(l||(l={}))},9141:function(e,t,r){"use strict";r.r(t),r.d(t,"initializeLinkEntityQueryExpression",(function(){return s})),r.d(t,"setLinkProperties",(function(){return u}));var n=r(9137),a=r(9050),i=r(9138),o=r(9140);function s(e,t,r,s){var u=Object(n.initializeEntityQueryExpression)(e);return u.linkToAttribute="",u.linkFromAttribute="",u.conditionOperator="",u.entityName=t,u.attributes=new Array(0),u.attributesByName={},u.orderByAttributes=new Array(0),u.groupByAttributes=new Array(0),u.aggregateAttributes=new Array(0),u.linkedEntities=new Array(0),u.parentEntity=r,r&&(u.baseEntity=r.baseEntity,u.tableAlias=Object(i.generateTableAlias)(u,u.entityName),u.joinType=Object(a.isNullOrUndefined)(s)?o.JoinType.inner:s),u}function u(e,t,r,n,a,i){e.linkFromAttribute=t,e.linkToAttribute=r,e.conditionOperator=n,e.joinType=a,e.alias=i}},9142:function(e,t,r){"use strict";r.r(t),r.d(t,"RelationshipRoleOrdinal",(function(){return n})),r.d(t,"RelationshipRoleOrdinalString",(function(){return a})),r.d(t,"getManyToManyRelationship",(function(){return u})),r.d(t,"getOneToManyRelationship",(function(){return l})),r.d(t,"getManyToOneRelationship",(function(){return h})),r.d(t,"getManyToOneRelationships",(function(){return y})),r.d(t,"getOnetoManyRelationshipByNavigationProperty",(function(){return g}));var n,a,i=r(9054);function o(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function s(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function s(e){o(i,n,a,s,u,"next",e)}function u(e){o(i,n,a,s,u,"throw",e)}s(void 0)}))}}function u(e,t,r,n){return c.apply(this,arguments)}function c(){return(c=s((function*(e,t,r,n){var a=yield Object(i.getEntityMetadata)(e,t);return a&&a.ManyToManyRelationships&&a.ManyToManyRelationships[r]?a.ManyToManyRelationships[r]:null}))).apply(this,arguments)}function l(e,t,r,n){return d.apply(this,arguments)}function d(){return(d=s((function*(e,t,r,n){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],i=yield p(e,t,n,a);return i&&i[r]?i[r]:null}))).apply(this,arguments)}function p(e,t,r){return f.apply(this,arguments)}function f(){return(f=s((function*(e,t,r){var n=yield Object(i.getEntityMetadata)(e,t);return n&&n.OneToManyRelationships?n.OneToManyRelationships:null}))).apply(this,arguments)}function h(e,t,r,n){return m.apply(this,arguments)}function m(){return(m=s((function*(e,t,r,n){var a=yield Object(i.getEntityMetadata)(e,t);return a&&a.ManyToOneRelationships&&a.ManyToOneRelationships[r]?a.ManyToOneRelationships[r]:null}))).apply(this,arguments)}function y(e,t,r){return v.apply(this,arguments)}function v(){return(v=s((function*(e,t,r){var n=yield Object(i.getEntityMetadata)(e,t);return n&&n.ManyToOneRelationships?n.ManyToOneRelationships:null}))).apply(this,arguments)}function g(e,t,r,n){return O.apply(this,arguments)}function O(){return(O=s((function*(e,t,r,n){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],i=yield p(e,t,n,a);if(i)for(var o of Object.keys(i)){var s=i[o];if(s.ReferencedEntityNavigationPropertyName===r)return s}return null}))).apply(this,arguments)}!function(e){e[e.Referencing=1]="Referencing",e[e.AssociationEntity=2]="AssociationEntity"}(n||(n={})),function(e){e.Referencing="referencing",e.AssociationEntity="associationentity"}(a||(a={}))},9143:function(e,t,r){"use strict";r.r(t),r.d(t,"entityHasAttributes",(function(){return s}));var n=r(9047),a=r(9054);function i(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function o(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function s(e){i(o,n,a,s,u,"next",e)}function u(e){i(o,n,a,s,u,"throw",e)}s(void 0)}))}}function s(e,t,r,n,a){return u.apply(this,arguments)}function u(){return(u=o((function*(e,t,r,i,o){try{if(!e)return null==i||i.warn("".concat(c()," Entity logical name is empty. Can not check for attributes"),o),!1;var s=(yield Object(a.getEntityMetadata)(r,e)).AttributeNames,u=t.filter(e=>!s.includes(e));if((null==u?void 0:u.length)>0){var l="Requested attributes ".concat(u.join(",")," not present on entity ").concat(e);return null==i||i.warn("".concat(c()," ").concat(l),o),o.push({name:n.EVENT_PARAMETERS.ERROR_DETAIL,value:l}),!1}}catch(d){null==i||i.warn("".concat(c()," Error when checking for attribute validity. Returning true"),o)}return!0}))).apply(this,arguments)}function c(e){return"[".concat(e||n.FILE_PREFIX.Validator,"]")}},9144:function(e,t,r){"use strict";r.r(t),r.d(t,"addFilter",(function(){return O})),r.d(t,"addAttributeFilter",(function(){return T})),r.d(t,"generateFilterClause",(function(){return S})),r.d(t,"isConditionWithNoValue",(function(){return I})),r.d(t,"isNullConditionNeeded",(function(){return x})),r.d(t,"getApplyFilterGeneratorPrefix",(function(){return q}));var n=r(9063),a=r(9050),i=r(9056),o=r(9047),s=r(9145),u=r(9048),c=r(9046),l=r(9109),d=r(9054),p=r(9146),f=r(9140),h=r(9148),m=r(9149),y=r(9150);function v(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function g(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){v(i,n,a,o,s,"next",e)}function s(e){v(i,n,a,o,s,"throw",e)}o(void 0)}))}}function O(e,t,r,n,a,i){return E.apply(this,arguments)}function E(){return(E=g((function*(e,t,r,i,o,s){var u=arguments.length>6&&void 0!==arguments[6]&&arguments[6];try{var c=u?e:"".concat(e,"0"),l=yield S(e,c,r,i,o,s);if(Object(a.isNullOrUndefinedOrEmptyString)(l))return t;var d="".concat(n.CLAUSE.where," ").concat(l," ").concat(n.CLAUSE.collateNoCase," ");return b(t,d)}catch(p){return o.error("".concat(q()," Failed to apply filter clause: ").concat(Object(a.getErrorMessage)(p)),s.commonEventParameters),t}}))).apply(this,arguments)}function b(e,t){var r=e.split(n.OFFLINE_SQL_TOKEN.WHERE_START);if(2===r.length){var a=r[1].replace(/where/i,"".concat(t," ").concat(f.LogicalOperatorString.and));e="".concat(r[0]," ").concat(n.OFFLINE_SQL_TOKEN.WHERE_START).concat(a)}else if(1===r.length){var i=e.split(n.OFFLINE_SQL_TOKEN.ORDERBY_START);e=2===i.length?"".concat(i[0]," ").concat(n.OFFLINE_SQL_TOKEN.WHERE_START).concat(t).concat(n.OFFLINE_SQL_TOKEN.WHERE_END," ").concat(n.OFFLINE_SQL_TOKEN.ORDERBY_START).concat(i[1]):"".concat(e," ").concat(n.OFFLINE_SQL_TOKEN.WHERE_START).concat(t).concat(n.OFFLINE_SQL_TOKEN.WHERE_END)}return e}function T(e,t){return b(e,n.CLAUSE.where+n.Punctuation.space+n.Punctuation.openSQBracket+t+n.Punctuation.closeSQBracket+n.Punctuation.space+n.Punctuation.equal+n.Punctuation.space+n.Punctuation.question+n.Punctuation.space+n.CLAUSE.collateNoCase)}function S(e,t,r,n,a,i){return C.apply(this,arguments)}function C(){return(C=g((function*(e,t,r,n,i,o){var u=o.commonEventParameters,c=new s.FilterParser(o,i).parse(r);if(Object(a.isNullOrUndefined)(c))return i.error("".concat(q()," Failed to apply filter clause: Empty FilterExpression"),u),"";var l=new p.PredicateBuilder;return(l=yield N(c,t,e,l,n,i,o)).getWhereClause().join("").length<1?(i.error("".concat(q()," Failed to generate filter clause: Empty WhereClause"),u),""):l.getWhereClause().join("")}))).apply(this,arguments)}function N(e,t,r,n,a,i,o){return _.apply(this,arguments)}function _(){return(_=g((function*(e,t,r,n,o,s,u){if(Object(a.isNullOrUndefined)(e))return n;try{if(n.beginWritingFilter(e.getFilterOperator()),!Object(a.isNullOrUndefined)(e.getConditions()))for(var c of e.getConditions())if(x(c.operator)){n.beginWritingFilter(f.LogicalOperator.or),n=yield R(c,n,r,t,o,s,u);var l={attributeName:c.attributeName,operator:f.ConditionalOperator.null,value:c.value};(n=yield R(l,n,r,t,o,s,u)).endWritingFilter()}else n=yield R(c,n,r,t,o,s,u);if(!Object(a.isNullOrUndefined)(e.getFilterExpressions()))for(var d of e.getFilterExpressions())n=yield N(d,t,r,n,o,s,u);return n.endWritingFilter(),n}catch(h){var p="Failed to visitFilterExpression: ".concat(Object(a.getErrorMessage)(h));return s.error("".concat(q()," ").concat(p),u.commonEventParameters),Promise.reject(new i.LocalError(p))}}))).apply(this,arguments)}function R(e,t,r,n,a,i,o){return P.apply(this,arguments)}function P(){return(P=g((function*(e,t,r,o,s,u,c){var p,h=[],y="",v=c.commonEventParameters;if(Object(a.isNullOrUndefined)(e.value)&&!I(e.operator)){var g="This conditional operator is not support null/undefined compared value";return u.warn("".concat(q()," ").concat(g),v),Promise.reject(new i.LocalError(g))}var O=e.operator,E=e.attributeName,b=yield Object(l.getLinkEntityAttribute)(E,r,s,u,c);switch(yield U(E,r,O,s,u,c),O){case f.ConditionalOperator.in:case f.ConditionalOperator.notIn:var T=[];p=e.value.split(",");for(var S=0;S<p.length;S++)T.join("").length>0&&T.push(", "),T.push("'".concat(yield A(E,r,p[S],s,u,c),"'"));y="(".concat(T.join(""),")"),h.push(yield F(o,E,b,r,O,y,s,u,c));break;case f.ConditionalOperator.between:case f.ConditionalOperator.notBetween:p=e.value.split(","),y="'".concat(yield A(E,r,p[0],s,u,c),"' and\n        '").concat(yield A(E,r,p[1],s,u,c),"'"),h.push(yield F(o,E,b,r,O,y,s,u,c));break;case f.ConditionalOperator.beginsWith:case f.ConditionalOperator.endsWith:case f.ConditionalOperator.notBeginWith:case f.ConditionalOperator.notEndWith:O===f.ConditionalOperator.beginsWith||O===f.ConditionalOperator.notBeginWith?y="'".concat(yield A(E,r,e.value,s,u,c),"%'"):O!==f.ConditionalOperator.endsWith&&O!==f.ConditionalOperator.notEndWith||(y="'%".concat(yield A(E,r,e.value,s,u,c),"'")),h.push(yield F(o,E,b,r,O,y,s,u,c));break;case f.ConditionalOperator.equalsUserId:case f.ConditionalOperator.notEqualsUserId:y="'".concat(yield Object(d.getUserId)(s,v),"'"),h.push(yield F(o,E,b,r,O,y,s,u,c));break;case f.ConditionalOperator.equalsUserTeams:case f.ConditionalOperator.equalsUserOrUserTeams:y=yield L(O,o,b,s,v),h.push(yield F(o,E,b,r,O,y,s,u,c));break;case n.DateTimeConstants.on:case n.DateTimeConstants.onOrBefore:case n.DateTimeConstants.onOrAfter:case n.DateTimeConstants.today:case n.DateTimeConstants.yesterday:case n.DateTimeConstants.tomorrow:case n.DateTimeConstants.lastWeek:case n.DateTimeConstants.thisWeek:case n.DateTimeConstants.nextWeek:case n.DateTimeConstants.lastMonth:case n.DateTimeConstants.thisMonth:case n.DateTimeConstants.nextMonth:case n.DateTimeConstants.lastYear:case n.DateTimeConstants.thisYear:case n.DateTimeConstants.nextYear:case n.DateTimeConstants.last7Days:case n.DateTimeConstants.next7Days:case n.DateTimeConstants.lastXDays:case n.DateTimeConstants.nextXDays:case n.DateTimeConstants.lastXWeeks:case n.DateTimeConstants.nextXWeeks:case n.DateTimeConstants.lastXMonths:case n.DateTimeConstants.nextXMonths:case n.DateTimeConstants.lastXYears:case n.DateTimeConstants.nextXYears:h.push(yield Object(m.generateDateTimeQueryString)(b,o,r,e.value,O,s,u,v));break;case f.ConditionalOperator.null:h.push("[".concat(o,"].[").concat(b,"] is null "));break;case f.ConditionalOperator.notNull:h.push("[".concat(o,"].[").concat(b,"] is not null "));break;default:y="'".concat(yield A(E,r,e.value,s,u,c),"'"),h.push(yield F(o,E,b,r,O,y,s,u,c))}return t.appendCondition(h.join("")),t}))).apply(this,arguments)}function I(e){return function(e){switch(e){case f.ConditionalOperator.equalsUserId:case f.ConditionalOperator.notEqualsUserId:case f.ConditionalOperator.equalsUserTeams:case f.ConditionalOperator.equalsUserOrUserTeams:return!0;default:return!1}}(e)||Object(h.isDateTimeCondition)(e)||function(e){switch(e){case f.ConditionalOperator.null:case f.ConditionalOperator.notNull:return!0;default:return!1}}(e)}function A(e,t,r,n,a,i){return D.apply(this,arguments)}function D(){return(D=g((function*(e,t,r,n,i,o){if(o.internalRequest)return r;var s=yield Object(d.getAttributesMetadata)(n,t,[],o.commonEventParameters);if(Object(a.isNullOrUndefinedOrEmpty)(s)){var c="Unable to get attribute metadata descriptor that associated to entity: ".concat(t);return i.warn("".concat(q()," ").concat(c),o.commonEventParameters),Promise.reject(c)}var l=s[e];if(Object(a.isNullOrUndefinedOrEmpty)(l)){var p="Attribute metadata descriptor that is associated to entity: ".concat(t," does not exist in DB");return i.warn("".concat(q()," ").concat(p),o.commonEventParameters),Promise.reject(p)}var f=r;return l.Type===u.AttributeType.EntityName&&(i.warn("".concat(q()," Encountered attribute for entity type with value ").concat(r,", ignore\n          entity logical name of ").concat(l.EntityLogicalName," and get logical name from entity type instead"),o.commonEventParameters),f=yield Object(d.getEntityLogicalNameFromOtc)(n,parseInt(r,10),o.commonEventParameters)),M(f,l.Type)}))).apply(this,arguments)}function M(e,t){if(!Object(a.isNullOrUndefined)(e))switch(t){case u.AttributeType.Lookup:case u.AttributeType.Customer:case u.AttributeType.Owner:case u.AttributeType.UniqueIdentifier:var r=new c.Guid(e.toString());e=r.guid;break;case u.AttributeType.DateTime:e=Object(h.toISOFormat)(e)}return e}function F(e,t,r,n,a,i,o,s,u){return w.apply(this,arguments)}function w(){return(w=g((function*(e,t,r,n,o,s,u,c,d){try{var p;if(p=d.internalRequest?null:yield Object(l.getAttributePicklistMetadata)(t,n,u,d.commonEventParameters)){var f=[];return Object(l.addPicklistCaseStatement)(p,f,e),f.join("")}return"[".concat(e,"].[").concat(r,"] ").concat(Object(l.convertConditionOperatorToSQLFormat)(o)," ").concat(s)}catch(h){return c.error("".concat(q()," Failed to getQueryForCondition for attribute: ").concat(t," and entity ").concat(n," with  ").concat(Object(a.getErrorMessage)(h))),Promise.reject(new i.LocalError(h))}}))).apply(this,arguments)}function L(e,t,r,n,a){return j.apply(this,arguments)}function j(){return(j=g((function*(e,t,r,n,a){var i=yield Object(d.getUserId)(n,a),o="(SELECT TeamId FROM TeamMembership WHERE SystemUserId = '".concat(i,"')");return"eq-useroruserteams"===e&&(o+=" or ".concat(t,".[").concat(r,"] = '").concat(i,"'")),o}))).apply(this,arguments)}function x(e){switch(e){case"ne":case"not-in":case"not-like":case"not-begin-with":case"not-end-with":return!0;default:return!1}}function U(e,t,r,n,a,i){return k.apply(this,arguments)}function k(){return(k=g((function*(e,t,r,n,i,o){if(!o.internalRequest){var s=yield Object(d.getAttributesMetadata)(n,t,[],o.commonEventParameters);if(Object(a.isNullOrUndefinedOrEmpty)(s)||Object(a.isNullOrUndefinedOrEmpty)(s[e])){var u="Unable to get attribute metadata descriptor that associated to entity: ".concat(t,". Return the given attributeName: ").concat(e);return i.error("".concat(q()," ").concat(u),o.commonEventParameters),Promise.reject(new Error(u))}var c=s[e].Type;if(c in y.AttributeOperationMap)if(y.AttributeOperationMap[c].indexOf(r)<0){var l="Condition Operation: ".concat(r," is not supported on Attribute Type: ").concat(c," of Attribute: ").concat(e);return i.error("".concat(q()," ").concat(l),o.commonEventParameters),Promise.reject(new Error(l))}}}))).apply(this,arguments)}function q(e){return"[".concat(e||o.FILE_PREFIX.ApplyFilterSQLGenerator,"]")}},9145:function(e,t,r){"use strict";r.r(t),r.d(t,"FilterParser",(function(){return l}));var n=r(9140),a=r(9056),i=r(9144),o=r(9139),s=r(9046),u=r(9050),c=r(9063);class l{constructor(e,t){this.operatorStack=void 0,this.operandStack=void 0,this.executionContext=void 0,this.commonEventParameters=void 0,this.tracer=void 0,this.executionContext=e,this.commonEventParameters=this.executionContext.commonEventParameters,this.tracer=t,this.operatorStack=[],this.operandStack=[]}parse(e){for(var t=new RegExp("'.*?'|[^()\\s]+|[()]","g"),r=e.match(t)||[],u=0;u<r.length;u++){var c=r[u],l={type:Object(n.getTokenType)(c),value:c.toLowerCase()};switch(l.type){case n.TokenType.openBracket:this.operatorStack.push(l);break;case n.TokenType.closeBracket:this.evaluateStack(!0);break;case n.TokenType.logicalOperator:this.checkPrecendenceWithLastOperator(l.value)&&this.evaluateStack(!1),this.operatorStack.push(l);break;case n.TokenType.operand:try{u+=this.extractOperand(u,c,r)}catch(y){var d="Improper Input string with ".concat(null==y?void 0:y.message,", exception raised after '").concat(l.value,"'");throw this.tracer.error("".concat(Object(i.getApplyFilterGeneratorPrefix)()," ").concat(d),this.commonEventParameters),new a.LocalError(d)}break;default:var p="Unsupported token type '".concat(l.type,"'");throw this.tracer.error("".concat(Object(i.getApplyFilterGeneratorPrefix)()," ").concat(p),this.commonEventParameters),new a.LocalError(p)}}if(this.evaluateStack(!0),1!==this.operandStack.length){var f="FilterParser: Error while evaluating expression : Input Expression seems to have improper construct";throw this.tracer.error("".concat(Object(i.getApplyFilterGeneratorPrefix)()," ").concat(f),this.commonEventParameters),new a.LocalError(f)}var h=this.operandStack.pop(),m=new o.FilterExpression(0,s.Guid.newGuid().guid);return this.addToFilterExpression(m,h),m}evaluateStack(e){for(;this.operatorStack.length>0;){var t=this.operatorStack.pop();if(Object(u.isNullOrUndefined)(t)){var r="FilterParser:EvaluateExpression Error While Evaluating Stack";throw this.tracer.error("".concat(Object(i.getApplyFilterGeneratorPrefix)()," ").concat(r),this.commonEventParameters),new a.LocalError(r)}var o=t;if(!o.type){e||this.operatorStack.push(o);break}if(o.type===n.TokenType.logicalOperator){var s=this.getLogicalOperator(o.value),c=void 0;c=s===n.LogicalOperator.not?this.createFilterExpressionWithOperands(s,1):this.createFilterExpressionWithOperands(s,2),this.operandStack.push(c)}}}extractOperand(e,t,r){return"("===r[e+1]?r[e+2].indexOf("=")>0?this.extractOperandForFunctionWithParams(e,r):this.extractOperandForFunction(e,r):this.extractOperandForOperator(e,t,r)}extractOperandForOperator(e,t,r){var n=r[e+1]&&Object(i.isConditionWithNoValue)(r[e+1]),o=n?1:2;if(e+o>=r.length)throw new a.LocalError("Invalid filter with operator");var s=r[e+1],u=n?null:this.trimSingleQuotes(r[e+2]),c={attributeName:t,operator:this.getConditionalOperator(s),value:u};return this.operandStack.push(c),o}extractOperandForFunction(e,t){if(e+3>=t.length)throw new a.LocalError("Invalid filter with function");var r=t[e],n=t[e+2],i=n.split(",")[0],o=n.split(",")[1],s={attributeName:i,operator:this.getConditionalOperatorFromFunction(r),value:this.trimSingleQuotes(o)};return this.operandStack.push(s),3}extractOperandForFunctionWithParams(e,t){if(e+4>=t.length)throw new a.LocalError("Invalid filter with function");var r,n=t[e],i=this.parseParameters(t[e+2],","),o=this.parseParameters(t[e+4],"&","@"),s=this.trimSingleQuotes(o[i.PropertyName]);i.PropertyValues?r=(r=o[i.PropertyValues]).substring(1,r.length-1).split(",").map(e=>this.trimSingleQuotes(e)).join(","):i.PropertyValue&&(r=o[i.PropertyValue],r=this.trimSingleQuotes(r));var u={attributeName:s,operator:this.getConditionalOperatorFromFunction(n),value:r};return this.operandStack.push(u),4}parseParameters(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=e.split(t+r).filter(e=>""!==e).map(e=>{var t=e.indexOf("=");return{["".concat(r).concat(e.substr(0,t))]:e.substr(t+1)}});return Object.assign({},...n)}createFilterExpressionWithOperands(e,t){if(this.operandStack.length<t){var r="FilterParser:EvaluateExpression Error While Evaluating Stack :  Input Expression seems to have improper construct";throw this.tracer.error("".concat(Object(i.getApplyFilterGeneratorPrefix)()," ").concat(r),this.commonEventParameters),new a.LocalError(r)}for(var n=new o.FilterExpression(e,s.Guid.newGuid().guid),u=0;u<t;u++){var c=this.operandStack.pop();this.addToFilterExpression(n,c)}return n}addToFilterExpression(e,t){void 0!==t&&(t instanceof o.FilterExpression?e.addFilterExpression(t):e.addCondition(t.attributeName,t.operator,t.value))}trimSingleQuotes(e){return e.startsWith("'")&&e.endsWith("'")&&(e=(e=e.substring(1,e.length)).substring(0,e.length-1)),e}checkPrecendenceWithLastOperator(e){var t=!1;if(!this.operatorStack.length)return t;var r=this.peek(this.operatorStack);if(!Object(u.isNullOrUndefined)(r)){var a=r;if(a.type){if(a.type===n.TokenType.logicalOperator){var i=this.getLogicalOperatorPriority(a.value.toLowerCase());this.getLogicalOperatorPriority(e.toLowerCase())>i&&(t=!0)}}else t=!1}return t}getLogicalOperatorPriority(e){switch(e.toLowerCase()){case n.LogicalOperatorString.not:return n.LogicalOperatorPriority.not;case n.LogicalOperatorString.and:return n.LogicalOperatorPriority.and;case n.LogicalOperatorString.or:return n.LogicalOperatorPriority.or;default:var t="An invalid logical operator ".concat(e," passed as input parameter.");throw this.tracer.error("".concat(Object(i.getApplyFilterGeneratorPrefix)()," ").concat(t),this.commonEventParameters),new a.LocalError(t)}}getConditionalOperator(e){switch(e.toLowerCase()){case n.ConditionalOperator.equal:case n.ConditionalOperator.notEqual:case n.ConditionalOperator.greaterThan:case n.ConditionalOperator.lessThan:case n.ConditionalOperator.like:case n.ConditionalOperator.notLike:case n.ConditionalOperator.in:case n.ConditionalOperator.notIn:case n.ConditionalOperator.greaterThanEqual:case n.ConditionalOperator.lessThanEqual:case n.ConditionalOperator.beginsWith:case n.ConditionalOperator.endsWith:case n.ConditionalOperator.notBeginWith:case n.ConditionalOperator.notEndWith:case n.ConditionalOperator.equalsUserId:case n.ConditionalOperator.notEqualsUserId:case n.ConditionalOperator.equalsUserTeams:case n.ConditionalOperator.equalsUserOrUserTeams:case n.ConditionalOperator.null:case n.ConditionalOperator.notNull:case n.ConditionalOperator.between:case n.ConditionalOperator.notBetween:case c.DateTimeConstants.on:case c.DateTimeConstants.onOrBefore:case c.DateTimeConstants.onOrAfter:case c.DateTimeConstants.today:case c.DateTimeConstants.yesterday:case c.DateTimeConstants.tomorrow:case c.DateTimeConstants.lastWeek:case c.DateTimeConstants.thisWeek:case c.DateTimeConstants.nextWeek:case c.DateTimeConstants.lastMonth:case c.DateTimeConstants.thisMonth:case c.DateTimeConstants.nextMonth:case c.DateTimeConstants.lastYear:case c.DateTimeConstants.thisYear:case c.DateTimeConstants.nextYear:case c.DateTimeConstants.last7Days:case c.DateTimeConstants.next7Days:case c.DateTimeConstants.lastXDays:case c.DateTimeConstants.nextXDays:case c.DateTimeConstants.lastXWeeks:case c.DateTimeConstants.nextXWeeks:case c.DateTimeConstants.lastXMonths:case c.DateTimeConstants.nextXMonths:case c.DateTimeConstants.lastXYears:case c.DateTimeConstants.nextXYears:return e.toLowerCase();default:var t="FilterParser: An invalid conditional operator ".concat(e," passed as input parameter.");throw this.tracer.error("".concat(Object(i.getApplyFilterGeneratorPrefix)()," ").concat(t),this.commonEventParameters),new a.LocalError(t)}}getConditionalOperatorFromFunction(e){switch(e){case n.FunctionOperator.contains:case n.FunctionOperator.functionContains:return n.ConditionalOperator.like;case n.FunctionOperator.functionIn:return n.ConditionalOperator.in;default:var t="FilterParser: An invalid conditional operator ".concat(e," passed as input parameter.");throw this.tracer.error("".concat(Object(i.getApplyFilterGeneratorPrefix)()," ").concat(t),this.commonEventParameters),new a.LocalError(t)}}getLogicalOperator(e){switch(e.toLowerCase()){case n.LogicalOperatorString.and:return n.LogicalOperator.and;case n.LogicalOperatorString.or:return n.LogicalOperator.or;case n.LogicalOperatorString.not:return n.LogicalOperator.not;default:var t="An invalid logical operator ".concat(e," passed as input parameter.");throw this.tracer.error("".concat(Object(i.getApplyFilterGeneratorPrefix)()," ").concat(t),this.commonEventParameters),new a.LocalError(t)}}peek(e){var t=e.pop();return Object(u.isNullOrUndefined)(t)||e.push(t),t}}},9146:function(e,t,r){"use strict";r.r(t),r.d(t,"PredicateBuilder",(function(){return o}));var n=r(9147),a=r(9140),i=r(9063);class o{constructor(){this.conditionBuilders=[],this.whereClause=[],this.conditionBuilders=[]}beginWritingFilter(e){this.conditionBuilders.push(this.createConditionBuilder(e))}endWritingFilter(){var e=this.conditionBuilders[this.conditionBuilders.length-1];if(this.conditionBuilders.splice(this.conditionBuilders.length-1,1),this.conditionBuilders.length>0)this.conditionBuilders[this.conditionBuilders.length-1].appendCondition(e.getSql());else{var t=e.getSql();this.getWhereClause().join("").length>0&&t.length>0&&this.getWhereClause().push("".concat(i.Punctuation.space).concat(a.LogicalOperatorString.and).concat(i.Punctuation.space)),this.getWhereClause().push(t)}}createConditionBuilder(e){if(!(e in[a.LogicalOperator.and,a.LogicalOperator.or,a.LogicalOperator.not]))throw new Error("This logical operator for ".concat(e," is not supported"));return new n.ConditionBuilder(a.LogicalOperator[e])}appendCondition(e){this.conditionBuilders[this.conditionBuilders.length-1].appendCondition(e)}getWhereClause(){return this.whereClause}}},9147:function(e,t,r){"use strict";r.r(t),r.d(t,"ConditionBuilder",(function(){return i}));var n=r(9050),a=r(9140);class i{constructor(e){this._sqlClause=[],this._logicalOperator=null,this._conditionCount=0,this._logicalOperator=e,this._sqlClause=[],this._conditionCount=0}appendCondition(e){Object(n.isNullOrUndefinedOrEmptyString)(e)||(this._conditionCount>0&&this._sqlClause.push(" ".concat(this._logicalOperator," ")),this._logicalOperator===a.LogicalOperatorString.not?this._sqlClause.push("".concat(this._logicalOperator," ").concat(e)):this._sqlClause.push(e),this._conditionCount++)}getSql(){return this._sqlClause.join("").length>0?"("+this._sqlClause.join("")+")":""}}},9148:function(e,t,r){"use strict";r.r(t),r.d(t,"MILLISECONDS_IN_MINUTE",(function(){return d})),r.d(t,"getUserDateTimeNowFromUserSettings",(function(){return p})),r.d(t,"getUserCurrentDateTimeFromUserSettings",(function(){return f})),r.d(t,"getDSTAdjustment",(function(){return h})),r.d(t,"getLocalAdjustmentFromDate",(function(){return m})),r.d(t,"getConstraintByYear",(function(){return y})),r.d(t,"getDateTimeFormat",(function(){return v})),r.d(t,"getUTCTimeForUserLocal",(function(){return g})),r.d(t,"convertLocalTimeToUTCTimeForUserLocalFromUserSettings",(function(){return O})),r.d(t,"convertTimeZoneAjusterDateValue",(function(){return E})),r.d(t,"getStartOfHour",(function(){return b})),r.d(t,"getStartOfDay",(function(){return T})),r.d(t,"getStartOfMonth",(function(){return S})),r.d(t,"getStartOfYear",(function(){return C})),r.d(t,"getUserTimeZoneHourOffset",(function(){return N})),r.d(t,"getUserTimeZoneMinuteOffset",(function(){return _})),r.d(t,"getUtcHourOffset",(function(){return R})),r.d(t,"getUtcMinuteOffset",(function(){return P})),r.d(t,"getWorkWeekStartDateFromUserSettings",(function(){return I})),r.d(t,"addWeeks",(function(){return A})),r.d(t,"addMonths",(function(){return D})),r.d(t,"addYears",(function(){return M})),r.d(t,"addDays",(function(){return F})),r.d(t,"convertLocalTimeToUTCTime",(function(){return j})),r.d(t,"createQueryForDateTimeOperators",(function(){return U})),r.d(t,"createQueryForLastXOperators",(function(){return k})),r.d(t,"createQueryForOnOrXOperators",(function(){return q})),r.d(t,"convertToDateTime",(function(){return V})),r.d(t,"getDatePart",(function(){return B})),r.d(t,"getWorkWeekStartDate",(function(){return H})),r.d(t,"getUserDateTimeNow",(function(){return Q})),r.d(t,"isDateTimeCondition",(function(){return X})),r.d(t,"toISOFormat",(function(){return W}));var n,a=r(9063),i=r(9054),o=r(9050),s=r(9051),u=r(9056);function c(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function l(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){c(i,n,a,o,s,"next",e)}function s(e){c(i,n,a,o,s,"throw",e)}o(void 0)}))}}var d=6e4;function p(e){var t=f(e),r=h(t,E(e.timezoneadjusters));return new Date(t.getTime()+r)}function f(e){var t=new Date(Date.now()),r=t.getTimezoneOffset()*d,n=e.timezoneutcoffsetminutes*d;return new Date(t.getTime()+r+n)}function h(e,t){if(!t)return 0;var r=null,n=new Date(e.getTime());n.setHours(0),n.setMinutes(0),n.setSeconds(0),n.setMilliseconds(0);for(var a=0;a<t.length;a++){var i=t[a].datestart,o=t[a].dateend;if(n>=i&&n<=o){r=t[a];break}}return r?m(r,e):0}function m(e,t){var r=t.getFullYear(),n=y(e.daylightstart,r),a=y(e.daylightend,r);if(a<n){if(t>n||t<a)return e.delta}else if(t>n&&t<a)return e.delta;return 0}function y(e,t){if(e.isfixeddaterule)return new Date(t,e.month,e.day,e.timeofday.getHours(),e.timeofday.getMinutes(),e.timeofday.getSeconds());var r,n=7*e.week-6,a=new Date(t,e.month,1).getDay();return(r=a>e.dayofweek?n+(7-a+e.dayofweek):n+(e.dayofweek-a))>function(e,t){if(/8|3|5|10/.test(e.toString()))return 30;if(1!==e)return 31;return function(e){return e%4==0&&e%100!=0||e%400==0}(t)?29:28}(e.month,t)&&(r-=7),new Date(t,e.month,r,e.timeofday.getHours(),e.timeofday.getMinutes(),e.timeofday.getSeconds())}function v(e){return t=e.getFullYear(),r=e.getMonth()+1,n=e.getDate(),a=e.getHours(),i=e.getMinutes(),o=e.getSeconds(),s=e.getMilliseconds(),u=r<10?"0".concat(r):r,c=n<10?"0".concat(n):n,l=a<10?"0".concat(a):a,d=i<10?"0".concat(i):i,p=o<10?"0".concat(o):o,f=s<100?s<10?"00".concat(s):"0".concat(s):s,"'".concat(t,"-").concat(u,"-").concat(c," ").concat(l,":").concat(d,":").concat(p,".").concat(f,"'");var t,r,n,a,i,o,s,u,c,l,d,p,f}function g(e,t){return v(O(e,t))}function O(e,t){var r=e.timezoneutcoffsetminutes*d;return r+=h(t,E(e.timezoneadjusters)),new Date(t.getTime()-r)}function E(e){return e.map(e=>({datestart:new Date(e.datestart),dateend:new Date(e.dateend),daylightstart:{day:e.daylightstart.day,month:e.daylightstart.month,dayofweek:e.daylightstart.dayofweek,week:e.daylightstart.week,timeofday:new Date(e.daylightstart.timeofday),isfixeddaterule:e.daylightstart.isfixeddaterule},delta:e.delta,daylightend:{day:e.daylightend.day,month:e.daylightend.month,dayofweek:e.daylightend.dayofweek,week:e.daylightend.week,timeofday:new Date(e.daylightend.timeofday),isfixeddaterule:e.daylightend.isfixeddaterule}}))}function b(e){return e.setMinutes(0,0,0),e}function T(e){return e.setHours(0,0,0,0),e}function S(e){var t=T(e);return t.setDate(1),t}function C(e){var t=S(e);return t.setMonth(0),t}function N(e){return Math.trunc(e.timezoneutcoffsetminutes/60)}function _(e){return e.timezoneutcoffsetminutes%60}function R(e){return-1*N(e)}function P(e){return-1*_(e)}function I(e,t){try{var r=e.datetimeformatinfo.FirstDayOfWeek;return(t=new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0)).getDay()<r?F(t,r-t.getDay()-7):F(t,r-t.getDay())}catch(n){throw new Error("Failed to getWorkWeekStartDateFromUserSettings ".concat(n))}}function A(e,t){return F(e,7*t)}function D(e,t){var r=new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds());return r.setMonth(e.getMonth()+t),r}function M(e,t){var r=new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds());return r.setFullYear(e.getFullYear()+t),r}function F(e,t){var r=new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds());return r.setDate(e.getDate()+t),r}function w(e,t,r){return L.apply(this,arguments)}function L(){return(L=l((function*(e,t,r){try{return O(yield Object(i.getUserSettings)(t,r),e)}catch(a){var n=Object(o.getErrorMessage)(a)||"Failed to substitute date time placeholder";throw new u.LocalError(n)}}))).apply(this,arguments)}function j(e,t,r){return x.apply(this,arguments)}function x(){return(x=l((function*(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];switch(t){case s.DateTimeFieldBehavior.DateOnly:return B(e);case s.DateTimeFieldBehavior.TimeZoneIndependent:return e;case s.DateTimeFieldBehavior.UserLocal:return yield w(e,r,n);default:return Promise.reject(new u.LocalError("The Attribute's DateTime Behavior is Undefined!"))}}))).apply(this,arguments)}function U(e,t,r,n){var a="rtrim([{".concat(e,"}].[{").concat(t,"}])"),i=v(r),o=v(n);return" ".concat(a," >= ").concat(i," and ").concat(i," < ").concat(o," ")}function k(e,t,r,n){var a="rtrim([{".concat(e,"}].[{").concat(t,"}])"),i=v(r),o=v(n);return" ".concat(a," >= ").concat(i," and ").concat(i," <= ").concat(o," ")}function q(e,t,r,n){var i="rtrim([".concat(e,"].[").concat(t,"])"),o=v(r),s="";return n===a.DateTimeConstants.onOrBefore?s="<":a.DateTimeConstants.onOrAfter&&(s=">=")," ".concat(i," ").concat(s," ").concat(o," ")}function V(e){if(Object(o.isNullOrUndefinedOrEmpty)(e))throw new u.LocalError("DateTime input value is null");if(e instanceof Date)return e;var t=e,r=new RegExp("[-]","ig");return t=t.replace(r,"/"),t=(t=t.replace(n||(n=new RegExp("[Z,T]","ig"))," ")).lastIndexOf(".")>-1?t.substr(0,t.lastIndexOf(".")):t,new Date(Date.parse(t))}function B(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate())}function H(e){return G.apply(this,arguments)}function G(){return(G=l((function*(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];try{var r=yield Object(i.getUserSettings)(e,t),n=p(r);return I(r,n)}catch(s){var a=Object(o.getErrorMessage)(s)||"Failed to substitute date time placeholder";throw new Error(a)}}))).apply(this,arguments)}function Q(e){return z.apply(this,arguments)}function z(){return(z=l((function*(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];try{var r=yield Object(i.getUserSettings)(e,t);return p(r)}catch(a){var n=Object(o.getErrorMessage)(a)||"Failed to substitute date time placeholder";throw new Error(n)}}))).apply(this,arguments)}function X(e){switch(e){case a.DateTimeConstants.lastXDays:case a.DateTimeConstants.nextXDays:case a.DateTimeConstants.last7Days:case a.DateTimeConstants.next7Days:case a.DateTimeConstants.yesterday:case a.DateTimeConstants.today:case a.DateTimeConstants.tomorrow:case a.DateTimeConstants.on:case a.DateTimeConstants.onOrAfter:case a.DateTimeConstants.onOrBefore:case a.DateTimeConstants.nextWeek:case a.DateTimeConstants.lastWeek:case a.DateTimeConstants.thisWeek:case a.DateTimeConstants.lastXWeeks:case a.DateTimeConstants.nextXWeeks:case a.DateTimeConstants.lastXMonths:case a.DateTimeConstants.nextXMonths:case a.DateTimeConstants.lastMonth:case a.DateTimeConstants.nextMonth:case a.DateTimeConstants.thisMonth:case a.DateTimeConstants.lastXYears:case a.DateTimeConstants.nextXYears:case a.DateTimeConstants.lastYear:case a.DateTimeConstants.nextYear:case a.DateTimeConstants.thisYear:case a.DateTimeConstants.anyTime:return!0;default:return!1}}function W(e){var t=e.trim(),r=(t=t.replace(/[/]/gi,"-")).match(/[Z,T]/gi);if(r&&!Object(o.isNullOrUndefinedOrEmptyString)(r)&&2===r.length&&r.indexOf("Z")>0&&r.indexOf("T")>0&&!isNaN(Date.parse(t)))return t;var n,a,i,s=(t=t.replace(/[Z,T]/gi," ").trim()).split(" ");return s.length>1?t="".concat(Y(s[0],e),"T").concat((n=s[1],a=e,i="",n.split(":").forEach(e=>{i+="".concat(K(e,a),":")}),i=i.substring(0,i.length-1)),"Z"):1===s.length&&(t="".concat(Y(s[0],e),"T00:00:00.000Z")),isNaN(Date.parse(t))&&J(e),t}function Y(e,t){var r="";return e.split("-").forEach(e=>{r+=4!==e.length?"".concat(K(e,t),"-"):"".concat(e,"-")}),r=r.substring(0,r.length-1)}function K(e,t){return-1===e.indexOf(".")?(e.length>2&&J(t),e.length<2?"0".concat(e):e):(e.length>10&&J(t),e.split(".")[0].length<2?"0".concat(e):e)}function J(e){throw new Error("Incorrect datetime string format".concat(e?": ".concat(e):""))}},9149:function(e,t,r){"use strict";r.r(t),r.d(t,"generateDateTimeQueryString",(function(){return m})),r.d(t,"generateSQLiteQueryForOnOrXOperator",(function(){return T})),r.d(t,"generateSQLiteQueryForLastXOperator",(function(){return C})),r.d(t,"generateSQLiteQueryForNextXOperator",(function(){return _})),r.d(t,"getUtcDateTime",(function(){return U}));var n=r(9054),a=r(9048),i=r(9050),o=r(9047),s=r(9051),u=r(9056),c=r(9148),l=r(9063);function d(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function p(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){d(i,n,a,o,s,"next",e)}function s(e){d(i,n,a,o,s,"throw",e)}o(void 0)}))}}function f(e,t,r,n){return h.apply(this,arguments)}function h(){return(h=p((function*(e,t,r,o){var u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],c=yield Object(n.getAttributesMetadata)(r,t,[],u);if(Object(i.isNullOrUndefinedOrEmpty)(c)){var l="Unable to get attribute metadata descriptor that associated to entity: ".concat(t);return o.warn("".concat(q()," ").concat(l),u),Promise.reject(l)}var d=c[e];if(Object(i.isNullOrUndefinedOrEmpty)(d)){var p="Attribute metadata descriptor that is associated to entity: ".concat(t," does not exist in DB");return o.warn("".concat(q()," ").concat(p),u),Promise.reject(p)}if(!d.Type||d.Type!==a.AttributeType.DateTime){var f="Attribute Type is not DateTime though the given condition operator is of DateTime type.";return o.warn("".concat(q()," ").concat(f),u),Promise.reject(f)}return d.Behavior?d.Behavior:s.DateTimeFieldBehavior.None}))).apply(this,arguments)}function m(e,t,r,n,a,i,o){return y.apply(this,arguments)}function y(){return(y=p((function*(e,t,r,n,a,i,o){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:[];try{var c=yield f(e,r,i,o,s);switch(a){case l.DateTimeConstants.onOrBefore:case l.DateTimeConstants.onOrAfter:return yield T(e,t,n,c,a,i,o,s);case l.DateTimeConstants.lastXDays:case l.DateTimeConstants.lastXWeeks:case l.DateTimeConstants.lastXMonths:case l.DateTimeConstants.lastXYears:case l.DateTimeConstants.last7Days:return yield C(e,t,n,c,a,i,o,s);case l.DateTimeConstants.nextXDays:case l.DateTimeConstants.nextXWeeks:case l.DateTimeConstants.nextXMonths:case l.DateTimeConstants.nextXYears:case l.DateTimeConstants.next7Days:return yield _(e,t,n,c,a,i,o,s);case l.DateTimeConstants.on:case l.DateTimeConstants.today:case l.DateTimeConstants.yesterday:case l.DateTimeConstants.tomorrow:case l.DateTimeConstants.lastWeek:case l.DateTimeConstants.thisWeek:case l.DateTimeConstants.nextWeek:case l.DateTimeConstants.lastMonth:case l.DateTimeConstants.thisMonth:case l.DateTimeConstants.nextMonth:case l.DateTimeConstants.lastYear:case l.DateTimeConstants.thisYear:case l.DateTimeConstants.nextYear:return yield P(e,t,n,c,a,i,s);default:var d="GenerateDateTimeQueryString does not support DateTimeType of ".concat(a);return o.error("".concat(q()," ").concat(d)),Promise.reject(new u.LocalError(d))}}catch(d){return o.error("".concat(q()," ").concat(d.message||d)),Promise.reject(new u.LocalError(d))}}))).apply(this,arguments)}function v(e){if(Object(i.isNullOrUndefinedOrEmpty)(e))throw new u.LocalError("X input Value is null or undefined");var t=Number(e);if(t<1)throw new u.LocalError("X input Value cannot be negative");return t}function g(e,t){return O.apply(this,arguments)}function O(){return(O=p((function*(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=yield Object(c.getUserDateTimeNow)(t,r),a=yield Object(c.convertLocalTimeToUTCTime)(n,e,t,r);n=new Date(n.getFullYear(),n.getMonth(),n.getDate(),0,0,0);var i=yield Object(c.convertLocalTimeToUTCTime)(n,e,t,r);return{endUTCDate:a,currentUTCDateMidnight:i}}))).apply(this,arguments)}function E(e,t){return b.apply(this,arguments)}function b(){return(b=p((function*(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=yield Object(c.getUserDateTimeNow)(t,r),a=yield Object(c.convertLocalTimeToUTCTime)(n,e,t,r);(n.getHours()||n.getMinutes()||n.getSeconds()||n.getMilliseconds())&&(n=Object(c.addDays)(n,1)),n=new Date(n.getFullYear(),n.getMonth(),n.getDate(),0,0,0);var i=yield Object(c.convertLocalTimeToUTCTime)(n,e,t,r);return{startUTCDate:a,currentUTCDateMidnight:i}}))).apply(this,arguments)}function T(e,t,r,n,a,i,o){return S.apply(this,arguments)}function S(){return(S=p((function*(e,t,r,n,a,i,o){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:[];try{var l=yield U(r,n,a,i,s);return Object(c.createQueryForOnOrXOperators)(t,e,l,a)}catch(d){return o.error("".concat(q()," Failed to generate query for DateTimeType: ").concat(a," with ").concat(d.message||d)),Promise.reject(new u.LocalError(d))}}))).apply(this,arguments)}function C(e,t,r,n,a,i,o){return N.apply(this,arguments)}function N(){return(N=p((function*(e,t,r,n,a,i,o){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:[];l.DateTimeConstants.last7Days&&(r="7");var u,d=v(r),p=yield g(n,i,s);if(!p.currentUTCDateMidnight||!p.endUTCDate)return o.warn("".concat(q()," skip generated sqlite query string for DateTimeLastXOperator with currUTCDateMidnight: ").concat(p.currentUTCDateMidnight," and endUTCDate: ").concat(p.endUTCDate,"..")),"";switch(a){case l.DateTimeConstants.lastXDays:case l.DateTimeConstants.last7Days:u=Object(c.addDays)(p.currentUTCDateMidnight,-1*d);break;case l.DateTimeConstants.lastXWeeks:u=Object(c.addWeeks)(p.currentUTCDateMidnight,-1*d);break;case l.DateTimeConstants.lastXMonths:u=Object(c.addMonths)(p.currentUTCDateMidnight,-1*d);break;case l.DateTimeConstants.lastXYears:u=Object(c.addYears)(p.currentUTCDateMidnight,-1*d);break;default:return""}return Object(c.createQueryForLastXOperators)(t,e,u,p.endUTCDate)}))).apply(this,arguments)}function _(e,t,r,n,a,i,o){return R.apply(this,arguments)}function R(){return(R=p((function*(e,t,r,n,a,i,o){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:[];l.DateTimeConstants.next7Days&&(r="7");var u,d=v(r),p=yield E(n,i,s);if(!p.currentUTCDateMidnight||!p.startUTCDate)return o.warn("".concat(q()," skip generated sqlite query string for DateTimeNextXOperator with currUTCDateMidnight: ").concat(p.currentUTCDateMidnight," and startUTCDate: ").concat(p.startUTCDate,"..")),"";switch(a){case l.DateTimeConstants.nextXDays:case l.DateTimeConstants.next7Days:u=Object(c.addDays)(p.currentUTCDateMidnight,d);break;case l.DateTimeConstants.nextXWeeks:u=Object(c.addWeeks)(p.currentUTCDateMidnight,d);break;case l.DateTimeConstants.nextXMonths:u=Object(c.addMonths)(p.currentUTCDateMidnight,d);break;case l.DateTimeConstants.nextXYears:u=Object(c.addYears)(p.currentUTCDateMidnight,d);break;default:return""}return Object(c.createQueryForDateTimeOperators)(t,e,p.startUTCDate,u)}))).apply(this,arguments)}function P(e,t,r,n,a,i){return I.apply(this,arguments)}function I(){return(I=p((function*(e,t,r,n,a,i){var o,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:[];switch(a){case l.DateTimeConstants.today:case l.DateTimeConstants.yesterday:case l.DateTimeConstants.tomorrow:case l.DateTimeConstants.on:o=yield A(a,r,i,s);break;case l.DateTimeConstants.thisWeek:case l.DateTimeConstants.lastWeek:case l.DateTimeConstants.nextWeek:o=yield M(a,i,s);break;case l.DateTimeConstants.thisMonth:case l.DateTimeConstants.lastMonth:case l.DateTimeConstants.nextMonth:o=yield w(a,i,s);break;case l.DateTimeConstants.thisYear:case l.DateTimeConstants.lastYear:case l.DateTimeConstants.nextYear:o=yield j(a,i,s);break;default:throw new u.LocalError("generateSQLiteQueryForDateOperator does not support DateTimeType: ".concat(a))}var d=yield Object(c.convertLocalTimeToUTCTime)(o.startDate,n,i,s),p=yield Object(c.convertLocalTimeToUTCTime)(o.endDate,n,i,s);return Object(c.createQueryForDateTimeOperators)(t,e,d,p)}))).apply(this,arguments)}function A(e,t,r){return D.apply(this,arguments)}function D(){return(D=p((function*(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=yield Object(c.getUserDateTimeNow)(r,n),o=null;switch(e){case l.DateTimeConstants.today:o=0;break;case l.DateTimeConstants.yesterday:o=-1;break;case l.DateTimeConstants.tomorrow:o=1;break;case l.DateTimeConstants.on:break;default:throw new u.LocalError("getStartTimeAndEndTimeForDayOperator does not support DateTimeType: ".concat(e))}Object(i.isNullOrUndefined)(o)||(t=Object(c.addDays)(a,o));var s=Object(c.convertToDateTime)(t);s=Object(c.getDatePart)(s);var d=Object(c.addDays)(s,1);return{startDate:s,endDate:d}}))).apply(this,arguments)}function M(e,t){return F.apply(this,arguments)}function F(){return(F=p((function*(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=yield Object(c.getWorkWeekStartDate)(t,n);switch(e){case l.DateTimeConstants.thisWeek:r=1;break;case l.DateTimeConstants.lastWeek:r=-1;break;case l.DateTimeConstants.nextWeek:a=Object(c.addWeeks)(a,1),r=1;break;default:throw new u.LocalError("getStartTimeAndEndTimeForWeekOperator does not support DateTimeType: ".concat(e))}var i=Object(c.addWeeks)(a,r);return{startDate:a,endDate:i}}))).apply(this,arguments)}function w(e,t){return L.apply(this,arguments)}function L(){return(L=p((function*(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=yield Object(c.getUserDateTimeNow)(t,n),i=new Date(a.getFullYear(),a.getMonth(),1);switch(e){case l.DateTimeConstants.thisMonth:r=1;break;case l.DateTimeConstants.lastMonth:r=-1;break;case l.DateTimeConstants.nextMonth:i=Object(c.addMonths)(i,1),r=1;break;default:throw new u.LocalError("getStartTimeAndEndTimeForMonthOperator does not support DateTimeType: ".concat(e))}var o=Object(c.addMonths)(i,r);return{startDate:i,endDate:o}}))).apply(this,arguments)}function j(e,t){return x.apply(this,arguments)}function x(){return(x=p((function*(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=yield Object(c.getUserDateTimeNow)(t,n),i=new Date(a.getFullYear(),0,1);switch(e){case l.DateTimeConstants.thisYear:r=1;break;case l.DateTimeConstants.lastYear:r=-1;break;case l.DateTimeConstants.nextYear:i=Object(c.addYears)(i,1),r=1;break;default:throw new u.LocalError("getStartTimeAndEndTimeForYearOperator does not support DateTimeType: ".concat(e))}var o=Object(c.addYears)(i,r);return{startDate:i,endDate:o}}))).apply(this,arguments)}function U(e,t,r,n){return k.apply(this,arguments)}function k(){return(k=p((function*(e,t,r,n){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],i=Object(c.convertToDateTime)(e);i=Object(c.getDatePart)(i),r===l.DateTimeConstants.onOrBefore&&(i=Object(c.addDays)(i,1));var o=yield Object(c.convertLocalTimeToUTCTime)(i,t,n,a);return o}))).apply(this,arguments)}function q(e){return"[".concat(e||o.FILE_PREFIX.DateTimeOperators,"]")}},9150:function(e,t,r){"use strict";r.r(t),r.d(t,"AttributeOperationMap",(function(){return o}));var n=r(9048),a=r(9063),i=r(9140),o={[n.AttributeType.UniqueIdentifier]:[i.ConditionalOperator.null,i.ConditionalOperator.notNull,i.ConditionalOperator.in,i.ConditionalOperator.notIn,i.ConditionalOperator.equal,i.ConditionalOperator.notEqual,i.ConditionalOperator.greaterThan,i.ConditionalOperator.greaterThanEqual,i.ConditionalOperator.lessThan,i.ConditionalOperator.lessThanEqual,i.ConditionalOperator.equalsUserId,i.ConditionalOperator.notEqualsUserId],[n.AttributeType.Boolean]:[i.ConditionalOperator.null,i.ConditionalOperator.notNull,i.ConditionalOperator.equal,i.ConditionalOperator.notEqual,i.ConditionalOperator.like,i.ConditionalOperator.notLike,i.ConditionalOperator.beginsWith,i.ConditionalOperator.notBeginWith,i.ConditionalOperator.endsWith,i.ConditionalOperator.notEndWith,i.ConditionalOperator.in,i.ConditionalOperator.notIn],[n.AttributeType.String]:[i.ConditionalOperator.null,i.ConditionalOperator.notNull,i.ConditionalOperator.equal,i.ConditionalOperator.notEqual,i.ConditionalOperator.like,i.ConditionalOperator.notLike,i.ConditionalOperator.beginsWith,i.ConditionalOperator.notBeginWith,i.ConditionalOperator.endsWith,i.ConditionalOperator.notEndWith],[n.AttributeType.PickList]:[i.ConditionalOperator.null,i.ConditionalOperator.notNull,i.ConditionalOperator.equal,i.ConditionalOperator.notEqual,i.ConditionalOperator.like,i.ConditionalOperator.notLike,i.ConditionalOperator.beginsWith,i.ConditionalOperator.notBeginWith,i.ConditionalOperator.endsWith,i.ConditionalOperator.notEndWith,i.ConditionalOperator.in,i.ConditionalOperator.notIn],[n.AttributeType.State]:[i.ConditionalOperator.null,i.ConditionalOperator.notNull,i.ConditionalOperator.equal,i.ConditionalOperator.notEqual,i.ConditionalOperator.like,i.ConditionalOperator.notLike,i.ConditionalOperator.beginsWith,i.ConditionalOperator.notBeginWith,i.ConditionalOperator.endsWith,i.ConditionalOperator.notEndWith,i.ConditionalOperator.in,i.ConditionalOperator.notIn],[n.AttributeType.Status]:[i.ConditionalOperator.null,i.ConditionalOperator.notNull,i.ConditionalOperator.equal,i.ConditionalOperator.notEqual,i.ConditionalOperator.like,i.ConditionalOperator.notLike,i.ConditionalOperator.beginsWith,i.ConditionalOperator.notBeginWith,i.ConditionalOperator.endsWith,i.ConditionalOperator.notEndWith,i.ConditionalOperator.in,i.ConditionalOperator.notIn],[n.AttributeType.EntityName]:[i.ConditionalOperator.null,i.ConditionalOperator.notNull,i.ConditionalOperator.equal,i.ConditionalOperator.notEqual,i.ConditionalOperator.like,i.ConditionalOperator.notLike,i.ConditionalOperator.beginsWith,i.ConditionalOperator.notBeginWith,i.ConditionalOperator.endsWith,i.ConditionalOperator.notEndWith,i.ConditionalOperator.in,i.ConditionalOperator.notIn],[n.AttributeType.Customer]:[i.ConditionalOperator.null,i.ConditionalOperator.notNull,i.ConditionalOperator.equal,i.ConditionalOperator.notEqual,i.ConditionalOperator.in,i.ConditionalOperator.notIn],[n.AttributeType.Lookup]:[i.ConditionalOperator.null,i.ConditionalOperator.notNull,i.ConditionalOperator.in,i.ConditionalOperator.notIn,i.ConditionalOperator.equal,i.ConditionalOperator.notEqual,i.ConditionalOperator.equalsUserId,i.ConditionalOperator.notEqualsUserId],[n.AttributeType.Owner]:[i.ConditionalOperator.null,i.ConditionalOperator.notNull,i.ConditionalOperator.in,i.ConditionalOperator.notIn,i.ConditionalOperator.equal,i.ConditionalOperator.notEqual,i.ConditionalOperator.equalsUserId,i.ConditionalOperator.notEqualsUserId,i.ConditionalOperator.equalsUserTeams,i.ConditionalOperator.equalsUserOrUserTeams],[n.AttributeType.Integer]:[i.ConditionalOperator.equal,i.ConditionalOperator.notEqual,i.ConditionalOperator.null,i.ConditionalOperator.notNull,i.ConditionalOperator.greaterThan,i.ConditionalOperator.greaterThanEqual,i.ConditionalOperator.lessThan,i.ConditionalOperator.lessThanEqual],[n.AttributeType.BigInt]:[i.ConditionalOperator.equal,i.ConditionalOperator.notEqual,i.ConditionalOperator.null,i.ConditionalOperator.notNull,i.ConditionalOperator.greaterThan,i.ConditionalOperator.greaterThanEqual,i.ConditionalOperator.lessThan,i.ConditionalOperator.lessThanEqual],[n.AttributeType.Double]:[i.ConditionalOperator.equal,i.ConditionalOperator.notEqual,i.ConditionalOperator.null,i.ConditionalOperator.notNull,i.ConditionalOperator.greaterThan,i.ConditionalOperator.greaterThanEqual,i.ConditionalOperator.lessThan,i.ConditionalOperator.lessThanEqual],[n.AttributeType.Decimal]:[i.ConditionalOperator.equal,i.ConditionalOperator.notEqual,i.ConditionalOperator.null,i.ConditionalOperator.notNull,i.ConditionalOperator.greaterThan,i.ConditionalOperator.greaterThanEqual,i.ConditionalOperator.lessThan,i.ConditionalOperator.lessThanEqual],[n.AttributeType.Money]:[i.ConditionalOperator.equal,i.ConditionalOperator.notEqual,i.ConditionalOperator.null,i.ConditionalOperator.notNull,i.ConditionalOperator.greaterThan,i.ConditionalOperator.greaterThanEqual,i.ConditionalOperator.lessThan,i.ConditionalOperator.lessThanEqual,i.ConditionalOperator.in,i.ConditionalOperator.notIn],[n.AttributeType.DateTime]:[a.DateTimeConstants.onOrAfter,a.DateTimeConstants.on,a.DateTimeConstants.onOrBefore,a.DateTimeConstants.today,a.DateTimeConstants.tomorrow,a.DateTimeConstants.yesterday,a.DateTimeConstants.next7Days,a.DateTimeConstants.last7Days,a.DateTimeConstants.nextWeek,a.DateTimeConstants.lastWeek,a.DateTimeConstants.thisWeek,a.DateTimeConstants.nextMonth,a.DateTimeConstants.lastMonth,a.DateTimeConstants.thisMonth,a.DateTimeConstants.nextYear,a.DateTimeConstants.lastYear,a.DateTimeConstants.thisYear,a.DateTimeConstants.lastXDays,a.DateTimeConstants.nextXDays,a.DateTimeConstants.lastXWeeks,a.DateTimeConstants.nextXWeeks,a.DateTimeConstants.lastXMonths,a.DateTimeConstants.nextXMonths,a.DateTimeConstants.lastXYears,a.DateTimeConstants.nextXYears,a.DateTimeConstants.anyTime,i.ConditionalOperator.null,i.ConditionalOperator.notNull,i.ConditionalOperator.equal,i.ConditionalOperator.notEqual,i.ConditionalOperator.greaterThan,i.ConditionalOperator.greaterThanEqual,i.ConditionalOperator.lessThan,i.ConditionalOperator.lessThanEqual]}},9151:function(e,t,r){"use strict";r.r(t),r.d(t,"generateRetrieveMultipleRequests",(function(){return C}));var n=r(9045),a=r(9058),i=r(9050),o=r(9056),s=r(9047),u=r(9054),c=r(9109),l=r(9063),d=r(9152),p=r(9154),f=r(9144),h=r(9155),m=r(9156),y=r(9157),v=r(9158),g=r(9133),O=r(9161),E=r(9162),b=r(9163);function T(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function S(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){T(i,n,a,o,s,"next",e)}function s(e){T(i,n,a,o,s,"throw",e)}o(void 0)}))}}function C(e,t,r){return N.apply(this,arguments)}function N(){return(N=S((function*(e,t,r){var h=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},T=h.commonEventParameters||[],S=[];r.info("".concat(D()," Building SQL Query For RetrieveMultipleRecords is processing"),Object(a.addEventParameters)(T,S));var C=yield Object(c.getEntityNameFromRequest)(e,t,r,T,h),N=yield Object(u.isFeatureEnabled)(t,l.FCB_CONSTANTS.SqlTokensAvailable,T);if(S.push({name:"sqlTokensSwitch",value:N}),!N){var R="Offline SQL Token Switch is OFF - Legacy SQL generator is not supported in Modern Data Layer";return r.error("".concat(D()," ").concat(R),Object(a.addEventParameters)(T,S)),Promise.reject(new o.LocalError(R))}var A={};if(e.additionalHeaders){var M,F=yield Object(u.isFeatureEnabled)(t,l.FCB_CONSTANTS.CustomPageOffline);if(e.additionalHeaders[n.HINT.viewId]){var w=e.additionalHeaders[n.HINT.viewId];if(M=yield _(w,C,t,T),Object(i.isNullOrUndefinedOrEmptyString)(M)){S.push({name:"ViewId",value:w});var L="Raw offline sql from metadata cache is null";return r.error("".concat(D()," ").concat(L),Object(a.addEventParameters)(T,S)),{sqlStatements:[],sqlParameters:[]}}}else{S.push({name:"IsClientApiRequest",value:!0});try{if(yield Object(g.determineHintsFromQuery)(e,C,A,t,r,h),F&&A[n.ADDITIONAL_PARAMETERS.NavigationPropertyRelationshipName]&&(C=A[n.ADDITIONAL_PARAMETERS.NavigationPropertyEntity]),e.additionalHeaders[n.HINT.viewId]){var j=e.additionalHeaders[n.HINT.viewId];M=yield _(j,C,t,T),S.push({name:"SavedQuery",value:j})}else M=yield Object(O.generateBaseSQL)(e,C,t,r,h);if(Object(i.isNullOrUndefinedOrEmptyString)(M)){var x="Unable to modify the base sql since it is empty.";return r.error("".concat(D()," ").concat(x),Object(a.addEventParameters)(T,S)),Promise.reject(new o.LocalError(x))}}catch(z){var U="Failed to execute client api for retrieve multiple";return r.error("".concat(D()," ").concat(U,": ").concat(Object(i.getErrorMessage)(z)),Object(a.addEventParameters)(T,S)),Promise.reject(new o.LocalError(null!=z&&z.message?z.message:U,null==z?void 0:z.code,null==z?void 0:z.stack,null==z?void 0:z.name))}}if(T.push({name:s.EVENT_PARAMETERS.BASE_OFFLINE_SQL,value:M}),e.additionalHeaders[n.HINT.mergeQuickFind]){var k=e.additionalHeaders[n.HINT.mergeQuickFind],q=yield Object(u.getViewMetadata)(t,k,C,T),V=q.offlineSqlQuery;if(!V){S.push({name:"mergeQuickFindViewId",value:k});var B="Failed to merge offline lookup since quick find sql from metadata cache is null for this view id ".concat(k);return r.error("".concat(D()," ").concat(B),Object(a.addEventParameters)(T,S)),Promise.reject(new o.LocalError(B))}M=yield Object(p.mergeQueries)(M,V,t,r,h)}if(e.additionalHeaders[n.HINT.search]){var H=e.additionalHeaders[n.HINT.search];M=yield Object(d.populateQuickFindSql)(M,H,C,t,r,h)}e.additionalHeaders[n.HINT.select]&&(M=yield Object(y.select)(t,M,Object(c.extractAdditionalColumnNames)(e.additionalHeaders[n.HINT.select]),C,r,T)),e.additionalHeaders[n.HINT.orderBy]&&(M=yield Object(m.sort)(t,M,Object(c.extractAdditionalColumnNames)(e.additionalHeaders[n.HINT.orderBy]),C,r,T)),e.additionalHeaders[n.HINT.contextFilter]&&(M=yield Object(v.addContextFilter)(C,M,e.additionalHeaders[n.HINT.contextFilter],t,r,h)),e.additionalHeaders[n.HINT.filter]&&(M=yield Object(f.addFilter)(C,M,e.additionalHeaders[n.HINT.filter],t,r,h)),e.additionalHeaders[n.HINT.linkEntity]&&(M=yield Object(E.addLinkEntity)(C,M,e.additionalHeaders[n.HINT.linkEntity],t,r,h)),F&&A[n.ADDITIONAL_PARAMETERS.NavigationPropertyRelationshipName]&&(M=yield Object(b.addNavigationProperty)(C,M,A,t,r,h,T)),M=yield I(M,C,t,e.additionalHeaders,r,T),A[n.ADDITIONAL_PARAMETERS.PageSize]=e.additionalHeaders[n.HINT.pageSize]||l.DEFAULT.PageSize,A[n.ADDITIONAL_PARAMETERS.PageNumber]=e.additionalHeaders[n.HINT.pageNumber]||l.DEFAULT.PageNumber,P(M,r,S,T);var G={sqlStatements:[M],sqlParameters:[],additionalParameters:A};return G}var Q="Failed to build the SQL Query For RetrieveMultiple - Cannot find request additional headers";return r.error("".concat(D()," ").concat(Q),Object(a.addEventParameters)(T,S)),Promise.reject(new o.LocalError(Q))}))).apply(this,arguments)}function _(e,t,r,n){return R.apply(this,arguments)}function R(){return(R=S((function*(e,t,r,n){var a=yield Object(u.getViewMetadata)(r,e,t,n);return a?a.offlineSqlQuery:void 0}))).apply(this,arguments)}function P(e,t,r,n){for(var i of l.OPERATOR_PLACE_HOLDERS)if(e.includes(i))return r.push({name:"Final-Offline-SQL",value:e}),void t.error("".concat(D()," Final offline sql still contain place holders: ").concat(i),Object(a.addEventParameters)(n,r))}function I(e,t,r,n,a){return A.apply(this,arguments)}function A(){return(A=S((function*(e,t,r,o,s){var c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],d=[];e=Object(h.addLimitClause)(e,Number(o[n.HINT.pageSize]||l.DEFAULT.PageSize),Number(o[n.HINT.pageNumber]||l.DEFAULT.PageNumber));var p=yield Object(u.getUserId)(r,c);d.push({name:"UserId",value:p}),Object(i.isNullOrUndefinedOrEmptyString)(p)?s.warn("".concat(D()," userId is null or empty"),Object(a.addEventParameters)(c,d)):e=Object(h.substituteUserIdPlaceHolder)(p,e,s,c);try{e=yield Object(h.substituteDateTimePlaceholders)(r,e,s,c)}catch(m){var f=Object(i.getErrorMessage)(m)||"Failed to substitute date time placeholder";s.warn("".concat(D()," ").concat(f),Object(a.addEventParameters)(c,d))}return e=yield Object(h.substituteUserLanguage)(r,e,s,c)}))).apply(this,arguments)}function D(e){return"[".concat(e||s.FILE_PREFIX.RetrieveMultipleGenerator,"]")}},9152:function(e,t,r){"use strict";r.r(t),r.d(t,"SearchCriteria",(function(){return n})),r.d(t,"leftToRightMark",(function(){return d})),r.d(t,"rightToLeftMark",(function(){return p})),r.d(t,"populateQuickFindSql",(function(){return f}));var n,a=r(9050),i=r(9054),o=r(9063),s=r(9153),u=r(9047);function c(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function l(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){c(i,n,a,o,s,"next",e)}function s(e){c(i,n,a,o,s,"throw",e)}o(void 0)}))}}!function(e){e[e.string=0]="string",e[e.integer=1]="integer",e[e.currency=2]="currency",e[e.dateTime=3]="dateTime",e[e.float=4]="float"}(n||(n={}));var d="",p="";function f(e,t,r,n,a,i){return h.apply(this,arguments)}function h(){return(h=l((function*(e,t,r,n,a,o){var s=o.commonEventParameters,u=b(e,n,a,o);if(!u){var c="No internal QuickFind query found:\n".concat(e);return a.error("".concat(T()," ").concat(c),s),Promise.reject(c)}var l=yield Object(i.getEntityMetadata)(n,r,s),d=u.split("UNION"),p=v(d),f=p.lookup?p.lookup:[],h=p.other?p.other:[];if(!f.length&&!h.length){if(!l.PrimaryNameAttribute)return a.warn("".concat(T()," Could not extract search conditions from the QuickFind query:\n").concat(e),s),e;u="SELECT ".concat(l.PrimaryNameAttribute," FROM ").concat(r," WHERE ").concat(l.PrimaryNameAttribute," LIKE {0}")}return"*"===t?(d.splice(0,f.length),f.length=0,h.length=0,y(e,d,h,n,a,s)):(m(t,d,f,h,n,a,s),y(e,d,h,n,a,s))}))).apply(this,arguments)}function m(e,t,r,i,o,s,u){var c=Object(a.trimWildCards)(e);e=Object(a.convertSearchStringToSQL)(e),e=Object(a.handleEscapeCharacters)(e);var l={};if(l[n[0]]="'".concat(e,"'"),!o.Formatter){var d="Formatter is not available";throw s.error("".concat(T()," ").concat(d),u),new Error(d)}var p=o.Formatter.parseIntegerValue(c);!isNaN(p)&&isFinite(p)&&p.toString()===c&&(l[n[n.integer]]=p.toString());var f=o.Formatter.parseDecimalValue(c);!isNaN(f)&&isFinite(f)&&(l[n[n.float]]=l[n[n.currency]]=f.toString());var h=o.Formatter?o.Formatter.parseInvariant(c):new Date(c);h&&(l[n[n.dateTime]]="'".concat(h.toString(),"'")),g(t,!0,r,l),g(t,!1,i,l)}function y(e,t,r,n,a,i){if(0===t.length){var o="Could not locate the QuickFInd tokens in SQL query";throw a.error("".concat(T()," ").concat(o),i),new Error(o)}S(t),S(r);var s=t[t.length-1].split("where");if(0===s.length){var u="The QuickFind query does not contain 'WHERE' clause";throw a.error("".concat(T()," ").concat(u),i),new Error(u)}var c=s[0]+(r.length>0?" where "+r.join(" OR "):"");return e.replace(t[t.length-1],c)}function v(e){var t=new RegExp("SELECT [\\S\\s]* FROM [\\S\\s]* WHERE [\\S\\s]* IN \\(SELECT [\\S\\s]* FROM [\\S\\s]* WHERE ([\\S\\s]*)\\)","i"),r=new RegExp("SELECT [\\S\\s]* FROM [\\S\\s]* WHERE ([\\S\\s]*)","i"),n=[],a=[],i={},o=e[e.length-1].match(r);o&&a.push(...o[1].split("OR"));for(var s=0;s<e.length-1;s++)(o=e[s].match(t))||(o=e[s].match(r)),o?n.push(o[1]):n.push("");return i.lookup=n,i.other=a,i}function g(e,t,r,n){for(var a=0;a<r.length;a++){var i=r[a].match(new RegExp("({\\d})"));if(i){var o=O(i[1]);E(t,r,e,a,i[1],o in n,o in n?n[o].toString():null)}}}function O(e){var t="";switch(e){case"{4}":t=n[n.float];break;case"{3}":t=n[n.dateTime];break;case"{2}":t=n[n.currency];break;case"{1}":t=n[n.integer];break;case"{0}":t=n[0]}return t}function E(e,t,r,n,a,i,o){if(i){var s=a?a.replace("}","\\}").replace("{","\\{"):a,u=new RegExp(s,"g"),c=t[n].replace(u,o);e&&(r[n]=r[n].replace(t[n],c)),t[n]=c}else t[n]="",e&&(r[n]="")}function b(e,t,r,n){var a=Object(s.getQueryTokenRegex)(o.OFFLINE_SQL_TOKEN.QUICKFIND_START,o.OFFLINE_SQL_TOKEN.QUICKFIND_END),i=e.match(a);if(i&&i.length>0)return i[1];var u="Could not locate the QuickFind tokens in SQL query";throw r.error("".concat(T()," ").concat(u),n.commonEventParameters),new Error(u)}function T(e){return"[".concat(e||u.FILE_PREFIX.QuickFindSQLGenerator,"]")}function S(e){for(var t=0;t<e.length;t++)Object(a.isNullOrUndefinedOrEmptyString)(e[t])&&(e.splice(t,1),t--)}},9153:function(e,t,r){"use strict";function n(e,t){if(!t||0===t.length)return e;var r=e;return t.forEach(e=>{var t=new RegExp("\\".concat(e),"g");r=r.replace(t,"\\".concat(e))}),r}function a(e,t){var r=n(e,["/","*"])+"([\\S\\s]*)"+n(t,["/","*"]);return new RegExp(r,"i")}r.r(t),r.d(t,"regexEscapeQueryTokens",(function(){return n})),r.d(t,"getQueryTokenRegex",(function(){return a}))},9154:function(e,t,r){"use strict";r.r(t),r.d(t,"mergeQueries",(function(){return c}));var n=r(9063),a=r(9153),i=r(9047),o=r(9056);function s(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function u(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){s(i,n,a,o,u,"next",e)}function u(e){s(i,n,a,o,u,"throw",e)}o(void 0)}))}}function c(e,t,r,n,a){return l.apply(this,arguments)}function l(){return(l=u((function*(e,t,r,a,i){var s,u=i.commonEventParameters||[];if(!e||!t){var c="Lookup view sql query or quick find sql query is empty";return a.error("".concat(p()," ").concat(c),u),Promise.reject(new o.LocalError(c))}var l=d(e,n.OFFLINE_SQL_TOKEN.SELECT_START,n.OFFLINE_SQL_TOKEN.FROM_END);if(!l){var f="Failed to merge lookup query:\n".concat(e,"\nwith quick find query:\n").concat(t,"\nsince no viewQuerySelectPart found");return a.error("".concat(p()," ").concat(f),u),Promise.reject(new o.LocalError(f))}var h=d(t,n.OFFLINE_SQL_TOKEN.CTE_START,n.OFFLINE_SQL_TOKEN.CTE_END),m=d(t,n.OFFLINE_SQL_TOKEN.WHERE_START,n.OFFLINE_SQL_TOKEN.WHERE_END,!1),y=d(e,n.OFFLINE_SQL_TOKEN.WHERE_START,n.OFFLINE_SQL_TOKEN.WHERE_END,!1);y?(y=y.toLowerCase().replace("where",""),m="".concat(n.OFFLINE_SQL_TOKEN.WHERE_START).concat(m)):m="".concat(n.OFFLINE_SQL_TOKEN.WHERE_START).concat(m).concat(n.OFFLINE_SQL_TOKEN.WHERE_END);var v=d(t,n.OFFLINE_SQL_TOKEN.ORDERBY_START,n.OFFLINE_SQL_TOKEN.ORDERBY_END);return s=h?"".concat(h," ").concat(l," ").concat(m):"".concat(l," ").concat(m),y&&(s+=" and (".concat(y,")").concat(n.OFFLINE_SQL_TOKEN.WHERE_END)),v&&(s+=" ".concat(v)),s}))).apply(this,arguments)}function d(e,t,r){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=Object(a.getQueryTokenRegex)(t,r),o=e.match(i);return o&&o.length>0?n?"".concat(t).concat(o[1]).concat(r):o[1]:null}function p(e){return"[".concat(e||i.FILE_PREFIX.MergeQuickFindSQLGenerator,"]")}},9155:function(e,t,r){"use strict";r.r(t),r.d(t,"addLimitClause",(function(){return d})),r.d(t,"substituteUserIdPlaceHolder",(function(){return p})),r.d(t,"substituteUserLanguage",(function(){return f})),r.d(t,"substituteDateTimePlaceholders",(function(){return m}));var n=r(9050),a=r(9047),i=r(9048),o=r(9063),s=r(9054),u=r(9148);function c(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function l(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){c(i,n,a,o,s,"next",e)}function s(e){c(i,n,a,o,s,"throw",e)}o(void 0)}))}}function d(e,t,r){var n=1+t,a=t*(r-1);return e=e+o.Punctuation.space+o.CLAUSE.limit+o.Punctuation.space+n+o.Punctuation.space+o.CLAUSE.offset+o.Punctuation.space+a}function p(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];if(typeof t===i.AttributeType.String&&t.trim().length>0)return t=t.replace(new RegExp(o.USER_ID_PLACE_HOLDER,"g"),o.Punctuation.singleQuote+e+o.Punctuation.singleQuote+o.Punctuation.space+o.CLAUSE.collateNoCase);var a="".concat(v()," attempted to substitute user id placeholder in empty sql statement");throw r.error(a,n),new Error(a)}function f(e,t,r){return h.apply(this,arguments)}function h(){return(h=l((function*(e,t,r){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i="6";try{var u=yield Object(s.getUserSettings)(e,a),c=yield Object(s.getLanguageCode)(e,a);t=(t=(t=(t=t.replace(new RegExp(o.LANGUAGE_PLACE_HOLDER.userLanguage,"g"),u.languageid.toString())).replace(new RegExp(o.LANGUAGE_PLACE_HOLDER.basedLanguage,"g"),c.toString())).replace(new RegExp(o.LANGUAGE_PLACE_HOLDER.columnName0,"g"),i)).replace(new RegExp(o.LANGUAGE_PLACE_HOLDER.columnName1,"g"),i)}catch(d){var l="Failed to substitueUserLanguage with ".concat(Object(n.getErrorMessage)(d)||"Unknown");r.warn("".concat(v()," ").concat(l),a)}return t}))).apply(this,arguments)}function m(e,t,r){return y.apply(this,arguments)}function y(){return(y=l((function*(e,t,r){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];try{var i=yield Object(s.getUserSettings)(e,a),c=Object(u.getUserDateTimeNowFromUserSettings)(i);return t=(t=(t=(t=(t=(t=(t=(t=(t=t.replace(new RegExp(o.DateTimeConstants.startOfCurrentHourUTC,"g"),Object(u.getUTCTimeForUserLocal)(i,Object(u.getStartOfHour)(c)))).replace(new RegExp(o.DateTimeConstants.startOfTodayUTC,"g"),Object(u.getUTCTimeForUserLocal)(i,Object(u.getStartOfDay)(c)))).replace(new RegExp(o.DateTimeConstants.startOfWorkWeekUTC,"g"),Object(u.getUTCTimeForUserLocal)(i,Object(u.getWorkWeekStartDateFromUserSettings)(i,c)))).replace(new RegExp(o.DateTimeConstants.startOfMonthUTC,"g"),Object(u.getUTCTimeForUserLocal)(i,Object(u.getStartOfMonth)(c)))).replace(new RegExp(o.DateTimeConstants.startOfYearUTC,"g"),Object(u.getUTCTimeForUserLocal)(i,Object(u.getStartOfYear)(c)))).replace(new RegExp(o.DateTimeConstants.userTimezoneHourOffset,"g"),Object(u.getUserTimeZoneHourOffset)(i).toString())).replace(new RegExp(o.DateTimeConstants.userTimezoneMinuteOffset,"g"),Object(u.getUserTimeZoneMinuteOffset)(i).toString())).replace(new RegExp(o.DateTimeConstants.UTCHourOffset,"g"),Object(u.getUtcHourOffset)(i).toString())).replace(new RegExp(o.DateTimeConstants.UTCMinuteOffset,"g"),Object(u.getUtcMinuteOffset)(i).toString())}catch(d){var l=Object(n.getErrorMessage)(d)||"Failed to substitute date time placeholder";throw r.warn("".concat(v()," ").concat(l),a),new Error(l)}}))).apply(this,arguments)}function v(e){return"[".concat(e||a.FILE_PREFIX.ApplyFinalModifiedSQLGenerator,"]")}},9156:function(e,t,r){"use strict";r.r(t),r.d(t,"sort",(function(){return l}));var n=r(9058),a=r(9050),i=r(9047),o=r(9109),s=r(9063);function u(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function c(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){u(i,n,a,o,s,"next",e)}function s(e){u(i,n,a,o,s,"throw",e)}o(void 0)}))}}function l(e,t,r,n,a){return d.apply(this,arguments)}function d(){return(d=c((function*(e,t,r,i,o){var u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],c=[];if(c.push({name:"SQLStatement",value:t}),c.push({name:"columnNames",value:r?r.toString():""}),Object(a.isNullOrUndefinedOrEmptyString)(t)||!r||0===r.length)throw o.error("".concat(h()," ").concat(s.ERROR_STRING.invalidParameter),Object(n.addEventParameters)(u,c)),new Error(s.ERROR_STRING.invalidParameter);var l,d=t.lastIndexOf(s.OFFLINE_SQL_TOKEN.ORDERBY_START),f=t.lastIndexOf(s.OFFLINE_SQL_TOKEN.ORDERBY_END);if(-1===d&&-1===f)l=t;else{if(-1===d||-1===f){var m="Cannot find matching sort start and end token - return base offline sql";return o.warn("".concat(h()," ").concat(m),Object(n.addEventParameters)(u,c)),t}l=t.substr(0,d)}try{var y=yield p(e,r,i,o,u);t=l+s.OFFLINE_SQL_TOKEN.ORDERBY_START+s.CLAUSE.orderBy+s.Punctuation.space+s.Punctuation.doubleQuote+y+s.OFFLINE_SQL_TOKEN.ORDERBY_END,o.info("".concat(h()," SQL Query with Modified SORT Clause:\n ").concat(t))}catch(g){var v="Failed to createOrderByQuery because of ".concat(g);o.warn("".concat(h," ").concat(v),Object(n.addEventParameters)(u,c))}return t}))).apply(this,arguments)}function p(e,t,r,n){return f.apply(this,arguments)}function f(){return(f=c((function*(e,t,r,a){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],u="",c="",l="";for(var d of t){var p=[];p.push({name:"ColumnSortPair",value:d}),u.length>0&&(u+=s.Punctuation.comma+s.Punctuation.space+s.Punctuation.doubleQuote);var f=d.trim().split(s.Punctuation.space),m=r+"0";if(2===f.length){if(![s.SORT.ASC,s.SORT.DESC].includes(f[1])){var y="Invalid sort direction. The provided sort direction is not support, only 'asc' and 'desc' type are support.";throw a.error("".concat(h()," ").concat(y),Object(n.addEventParameters)(i,p)),new Error(y)}l=f[1].toUpperCase()}else{if(1!==f.length){var v="OrderBy hint contains invalid format";throw a.error("".concat(h()," ").concat(v),Object(n.addEventParameters)(i,p)),new Error(v)}l=s.SORT.ASC.toUpperCase()}var g=(c=f[0]).split(s.Punctuation.dot);2===g.length&&(m=g[0],c=g[1]);var O=yield Object(o.isSpecialAttribute)(e,r,c,a,i);c=O?s.Punctuation.openSQBracket+c+s.Punctuation.exclamation+"name"+s.Punctuation.closeSQBracket:c,u+=m+s.Punctuation.doubleQuote+s.Punctuation.dot+c+s.Punctuation.space+l}return u}))).apply(this,arguments)}function h(e){return"[".concat(e||i.FILE_PREFIX.ApplyOrderBySQLGenerator,"]")}},9157:function(e,t,r){"use strict";r.r(t),r.d(t,"select",(function(){return l}));var n=r(9058),a=r(9050),i=r(9047),o=r(9109),s=r(9063);function u(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function c(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){u(i,n,a,o,s,"next",e)}function s(e){u(i,n,a,o,s,"throw",e)}o(void 0)}))}}function l(e,t,r,n,a){return d.apply(this,arguments)}function d(){return(d=c((function*(e,t,r,i,o){var u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],c=[];if(c.push({name:"SQLStatement",value:t}),c.push({name:"columnNames",value:r?r.toString():""}),Object(a.isNullOrUndefinedOrEmptyString)(t)||!r||0===r.length)return o.error("".concat(m()," Failed to add select due to ").concat(s.ERROR_STRING.invalidParameter),Object(n.addEventParameters)(u,c)),t;var l=t.lastIndexOf(s.OFFLINE_SQL_TOKEN.SELECT_START),d=t.lastIndexOf(s.OFFLINE_SQL_TOKEN.SELECT_END);if(-1===l||-1===d){var f="Cannot find select SQL Token or mismatch select start/end tokens - Return input SQL: \n ".concat(t);return o.warn("".concat(m()," ").concat(f),Object(n.addEventParameters)(u,c)),t}var h=t.substr(0,l),y=t.substr(l,d-l),v=t.lastIndexOf(s.OFFLINE_SQL_TOKEN.FROM_START),g="";return-1!==v&&(g=t.substr(v)),t=h+(1===r.length&&"*"===r[0].trim()?"".concat(s.OFFLINE_SQL_TOKEN.SELECT_START).concat(s.CLAUSE.select," *"):yield p(e,y,r,i,o,u))+s.OFFLINE_SQL_TOKEN.SELECT_END+s.Punctuation.space+s.Punctuation.space+g,o.info("".concat(m()," SQL Query with SELECT Clause:\n ").concat(t)),t}))).apply(this,arguments)}function p(e,t,r,n,a){return f.apply(this,arguments)}function f(){return(f=c((function*(e,t,r,n,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[];for(var u of r){t.length>0&&(t+=s.Punctuation.comma+s.Punctuation.space+s.Punctuation.doubleQuote);var c=Object(o.getAttributeName)(u),l=n+"0",d=c,p=d.split(s.Punctuation.dot);2===p.length&&(l=p[0],d=p[1]);var f=yield Object(o.isSpecialAttribute)(e,n,c,a,i);f?t=h(t,l,d,c):t+=l+s.Punctuation.doubleQuote+s.Punctuation.dot+s.Punctuation.openSQBracket+d+s.Punctuation.closeSQBracket+s.Punctuation.space+s.CLAUSE.as+s.Punctuation.space+s.Punctuation.doubleQuote+c+s.Punctuation.doubleQuote}return t}))).apply(this,arguments)}function h(e,t,r,n){for(var a=["id","logicalname","name"],i=0;i<a.length;i++){var o="".concat(r).concat(s.Punctuation.exclamation).concat(a[i]),u="".concat(n).concat(s.Punctuation.exclamation).concat(a[i]);e+=t+s.Punctuation.doubleQuote+s.Punctuation.dot+s.Punctuation.openSQBracket+o+s.Punctuation.closeSQBracket+s.Punctuation.space+s.CLAUSE.as+s.Punctuation.space+s.Punctuation.doubleQuote+u+s.Punctuation.doubleQuote,i<a.length-1&&(e+=s.Punctuation.comma+s.Punctuation.space+s.Punctuation.doubleQuote)}return e}function m(e){return"[".concat(e||i.FILE_PREFIX.ApplySelectSQLGenerator,"]")}},9158:function(e,t,r){"use strict";r.r(t),r.d(t,"addContextFilter",(function(){return d}));var n=r(9063),a=r(9109),i=r(9047),o=r(9159),s=r(9140),u=r(9160);function c(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function l(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){c(i,n,a,o,s,"next",e)}function s(e){c(i,n,a,o,s,"throw",e)}o(void 0)}))}}function d(e,t,r,n,a,i){return p.apply(this,arguments)}function p(){return(p=l((function*(e,t,r,n,i,s){var c=s.commonEventParameters,l=Object(a.extractAdditionalColumnNames)(r);if(l.length<1)return i.warn("".concat(y()," Failed to apply context Filter - No apply context filter hint found"),c),t;try{var d=yield Object(o.buildContextFilters)(l,e,n,i,c),p=yield f(d,e,n,i,s);t=Object(u.updateSqlWithJoinClauseFromJoinClauses)(e,t,p)}catch(h){i.warn("".concat(y()," Failed to apply context Filter - ").concat(h),c)}return t}))).apply(this,arguments)}function f(e,t,r,n,a){return h.apply(this,arguments)}function h(){return(h=l((function*(e,t,r,a,i){var o,c,l='"'.concat(t,'0"'),d=s.LogicalOperatorString.and,p=s.ConditionalOperator.equal,f=[];for(var h of e){var y="",v=h.id;if(h.ManyToMany){c={attributeName:h.ManyToMany.fromEntityAttribute,operator:p,value:v},o={name:h.ManyToMany.intersectName,from:h.ManyToMany.fromIntersectAttribute,to:h.ManyToMany.targetEntityPrimaryKey,alias:"bb"},y=yield Object(u.generateJoinClause)(t,"",d,o,l,!0,r,a,i),t=o.name;var g=m(o={name:h.ManyToMany.fromEntity,from:h.ManyToMany.fromEntityAttribute,to:h.ManyToMany.toIntersectAttribute,alias:"bb"},c);y=y+n.Punctuation.space+(yield Object(u.generateJoinClause)(t,g,d,o,"".concat(t,"2"),!1,r,a,i))}else{if(!h.OneToMany)return Promise.reject(new Error("Context filter type is not supported"));c={attributeName:h.OneToMany.primaryAttribute||h.OneToMany.fromAttribute,operator:p,value:v};var O=m(o={name:h.OneToMany.fromEntity,from:h.OneToMany.fromAttribute,to:h.OneToMany.toAttribute,alias:"bb"},c);y=yield Object(u.generateJoinClause)(t,O,d,o,l,!1,r,a,i)}f.push(y)}return f}))).apply(this,arguments)}function m(e,t){var r=e.alias;return"(( ".concat(r,".").concat(t.attributeName," ").concat(Object(a.convertConditionOperatorToSQLFormat)(t.operator)," '").concat(t.value,"' ").concat(n.CLAUSE.collateNoCase).concat(n.Punctuation.space,"))")}function y(e){return"[".concat(e||i.FILE_PREFIX.ApplyContextFilterSQLGenerator,"]")}},9159:function(e,t,r){"use strict";r.r(t),r.d(t,"buildContextFilters",(function(){return c})),r.d(t,"buildContextFilter",(function(){return d})),r.d(t,"getRoleOrdinal",(function(){return f}));var n=r(9063),a=r(9142),i=r(9054),o=r(9056);function s(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function u(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){s(i,n,a,o,u,"next",e)}function u(e){s(i,n,a,o,u,"throw",e)}o(void 0)}))}}function c(e,t,r,n,a){return l.apply(this,arguments)}function l(){return(l=u((function*(e,t,r,a,i){var s=[];try{for(var u of e){var c=u.trim().split(n.Punctuation.space);if(3!==c.length)throw new o.LocalError("Context Filter item in the hint is not in correct format.");var l=c[1],p=c[0],h=f(c[2]);s.push(yield d(l,p,t,h,r,a,i))}return s.length<1?Promise.reject(new o.LocalError("Failed to apply context filter - No Context Filter item is being generated")):s}catch(m){throw new o.LocalError("Failed to buildContextFilters - ".concat(m))}}))).apply(this,arguments)}function d(e,t,r,n,a,i,o){return p.apply(this,arguments)}function p(){return(p=u((function*(e,t,r,n,o,s,u){var c,l;if(c=yield Object(a.getManyToOneRelationship)(o,r,t,s,u)){var d=c;l={id:e,OneToMany:{fromEntity:d.ReferencedEntity,fromAttribute:d.ReferencedAttribute,toAttribute:d.ReferencingAttribute}}}else if(yield Object(a.getOneToManyRelationship)(o,r,t,s,u)){var p=yield Object(a.getOneToManyRelationship)(o,r,t,s,u),f=yield Object(i.getEntityMetadata)(o,p.ReferencingEntity);l={id:e,OneToMany:{fromEntity:p.ReferencedEntity,fromAttribute:p.ReferencingAttribute,toAttribute:p.ReferencedAttribute,primaryAttribute:f.PrimaryIdAttribute}}}else{if(!(c=yield Object(a.getManyToManyRelationship)(o,r,t,s,u)))throw new Error("Cannot identify type of relationship of request context filter hint");var m,y,v,g=c,O=g.IntersectEntityName;(g.Entity1LogicalName===g.Entity2LogicalName?n:g.Entity1LogicalName===r?a.RelationshipRoleOrdinal.AssociationEntity:a.RelationshipRoleOrdinal.Referencing)===a.RelationshipRoleOrdinal.Referencing?(m=g.Entity1LogicalName,v=g.Entity1IntersectAttribute,y=g.Entity2IntersectAttribute):(m=g.Entity2LogicalName,v=g.Entity2IntersectAttribute,y=g.Entity1IntersectAttribute),l={id:e,ManyToMany:{intersectName:O,targetEntityPrimaryKey:yield h(o,r,s,u),toIntersectAttribute:v,fromEntity:m,fromEntityAttribute:yield h(o,m,s,u),fromIntersectAttribute:y}}}return l}))).apply(this,arguments)}function f(e){switch(e){case a.RelationshipRoleOrdinalString.Referencing:return a.RelationshipRoleOrdinal.Referencing;case a.RelationshipRoleOrdinalString.AssociationEntity:return a.RelationshipRoleOrdinal.AssociationEntity;default:throw new Error("Unsupported apply context filter hint for roleOrdinal: ".concat(e))}}function h(e,t,r,n){return m.apply(this,arguments)}function m(){return(m=u((function*(e,t,r,n){var a=yield Object(i.getEntityMetadata)(e,t);if(!a)throw new Error("Cannot apply context filter because the metadata cache has no metadata for the ".concat(t," entity."));var o=a.PrimaryIdAttribute;if(!o)throw new Error("Cannot apply context filter because the primary key for the ".concat(t," entity is missing from the metadata cache."));return o}))).apply(this,arguments)}},9160:function(e,t,r){"use strict";r.r(t),r.d(t,"generateJoinClause",(function(){return s})),r.d(t,"updateSqlWithJoinClauseFromJoinClauses",(function(){return c}));var n=r(9109),a=r(9063);function i(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function o(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function s(e){i(o,n,a,s,u,"next",e)}function u(e){i(o,n,a,s,u,"throw",e)}s(void 0)}))}}function s(e,t,r,n,a,i,o,s,c){return u.apply(this,arguments)}function u(){return(u=o((function*(e,t,r,i,o,s,u,c,l){var d,p=i.name;d=s?p+"2":i.alias;var f,h=yield Object(n.getLinkEntityAttribute)(i.to,e,u,c,l),m=yield Object(n.getLinkEntityAttribute)(i.from,p,u,c,l),y=p+" AS "+d+" ON ("+o+a.Punctuation.dot+"".concat(h===i.to?h:"[".concat(h,"]"))+" = "+d+a.Punctuation.dot+"".concat(m===i.from?m:"[".concat(m,"]"));return f=i.type?"".concat(i.type.toUpperCase()," JOIN"):"JOIN",!s&&t?" ".concat(a.OFFLINE_SQL_TOKEN.JOIN_START).concat(f," ").concat(y," ").concat(a.CLAUSE.collateNoCase," ").concat(r," ").concat(t,")").concat(a.OFFLINE_SQL_TOKEN.JOIN_END," "):" ".concat(a.OFFLINE_SQL_TOKEN.JOIN_START).concat(f," ").concat(y," ").concat(a.CLAUSE.collateNoCase," )").concat(a.OFFLINE_SQL_TOKEN.JOIN_END)}))).apply(this,arguments)}function c(e,t,r){var n='"'.concat(e,'0"'),i="".concat(n).concat(a.Punctuation.space),o=t.lastIndexOf(i),s=t.lastIndexOf(a.OFFLINE_SQL_TOKEN.FROM_END);if(s>0){var u=t.substring(0,s),c=t.substring(s+a.OFFLINE_SQL_TOKEN.FROM_END.length,t.length);t="".concat(u," ").concat(r.join("".concat(a.Punctuation.space))).concat(a.OFFLINE_SQL_TOKEN.FROM_END," ").concat(c)}else if(o>0){var l=t.substring(0,o),d=t.substring(o+i.length,t.length);t="".concat(l).concat(n).concat(r.join("".concat(a.Punctuation.space))).concat(a.OFFLINE_SQL_TOKEN.FROM_END).concat(d)}else t+=r.join("".concat(a.Punctuation.space));return t}},9161:function(e,t,r){"use strict";r.r(t),r.d(t,"generateBaseSQL",(function(){return c}));var n=r(9063),a=r(9047),i=r(9054),o=r(9050);function s(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function u(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){s(i,n,a,o,u,"next",e)}function u(e){s(i,n,a,o,u,"throw",e)}o(void 0)}))}}function c(e,t,r,n,a){return l.apply(this,arguments)}function l(){return(l=u((function*(e,t,r,a,s){var u,c="".concat(t,"0");if(Object(o.isOfflineLogTable)(t))u="".concat(t,"id");else{var l=yield Object(i.getEntityMetadata)(r,t);u=l&&l.PrimaryIdAttribute?l.PrimaryIdAttribute:"".concat(t,"id")}var p="".concat(n.OFFLINE_SQL_TOKEN.SELECT_START,"select  [").concat(c,"].[").concat(u,"] as [").concat(u,"]").concat(n.OFFLINE_SQL_TOKEN.SELECT_END).concat(n.OFFLINE_SQL_TOKEN.FROM_START,"from  [").concat(t,"] as [").concat(c,"]").concat(n.OFFLINE_SQL_TOKEN.FROM_END);return a.info("".concat(d()," Generated base SQL ").concat(p,"}")),p}))).apply(this,arguments)}function d(e){return"[".concat(e||a.FILE_PREFIX.GenerateBaseSQL,"]")}},9162:function(e,t,r){"use strict";r.r(t),r.d(t,"addLinkEntity",(function(){return m})),r.d(t,"buildLinkEntity",(function(){return O})),r.d(t,"parseSingleHint",(function(){return b})),r.d(t,"getLinkEntityInfoFromRelationship",(function(){return T}));var n=r(9056),a=r(9047),i=r(9140),o=r(9109),s=r(9144),u=r(9063),c=r(9142),l=r(9159),d=r(9054),p=r(9160);function f(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function h(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){f(i,n,a,o,s,"next",e)}function s(e){f(i,n,a,o,s,"throw",e)}o(void 0)}))}}function m(e,t,r,n,a,i){return y.apply(this,arguments)}function y(){return(y=h((function*(e,t,r,n,a,i){var o=i.commonEventParameters||[],s=r.split(";").map(e=>e.trim());if(s.length<1)return a.warn("".concat(S()," Failed to apply link entity - No link entity hint found"),o),t;try{var u=yield v(s,e,n,a,o,i);t=Object(p.updateSqlWithJoinClauseFromJoinClauses)(e,t,u)}catch(c){a.warn("".concat(S()," Failed to apply link entity - ").concat(null==c?void 0:c.message),o)}return t}))).apply(this,arguments)}function v(e,t,r,n,a,i){return g.apply(this,arguments)}function g(){return(g=h((function*(e,t,r,n,a,o){"[".concat(t,"0]");for(var u=i.LogicalOperatorString.and,c=yield O(e,r,n,a),l="",d=[],f=0;f<c.length;f++){var h=c[f],m="";h.filter&&(m=yield Object(s.generateFilterClause)(h.name,h.alias,h.filter,r,n,o)),h.alias="[".concat(h.alias,"]"),l=yield Object(p.generateJoinClause)(h.parentEntity||t,m,u,h,"[".concat(h.parentEntityTableAlias,"]")||!1,!1,r,n,o),d.push(l)}return d}))).apply(this,arguments)}function O(e,t,r,n){return E.apply(this,arguments)}function E(){return(E=h((function*(e,t,r,n){var a=[];for(var i of e){var{entityLogicalName:o,entityAlias:s,relationshipName:c,roleOrdinal:l,alias:p,joinType:f}=b(i,r,n),h=yield Object(d.getEntityMetadata)(t,o),{linkEntityName:m,from:y,to:v}=T(h,c,l,r,n),g={name:m,from:y,to:v,alias:p,parentEntity:o,parentEntityTableAlias:s};f&&(g.type=f);var O=i.indexOf(u.Punctuation.openParenthesis);if(O>-1&&i.charAt(i.length-1)===u.Punctuation.closeParenthesis){var E=i.substring(O+1,i.length-1);g.filter=E}a.push(g)}return a}))).apply(this,arguments)}function b(e,t,r){var a=e.trim().split(u.Punctuation.space,6);if(6!==a.length){var i="Incorrect link entity format";throw t.error("".concat(S()," ").concat(i),r),new n.LocalError(i)}return{entityLogicalName:a[0],entityAlias:a[1],relationshipName:a[2],roleOrdinal:Object(l.getRoleOrdinal)(a[3]),alias:a[4],joinType:Object(o.convertJoinTypeToSQLFormat)(a[5],t,r)}}function T(e,t,r,a,i){var o,s,u,l="",d="",p="";if(null!==(o=e.OneToManyRelationships)&&void 0!==o&&o[t])p=e.OneToManyRelationships[t].ReferencingEntity,l=e.OneToManyRelationships[t].ReferencingAttribute,d=e.OneToManyRelationships[t].ReferencedAttribute;else if(null!==(s=e.ManyToOneRelationships)&&void 0!==s&&s[t])p=e.ManyToOneRelationships[t].ReferencedEntity,l=e.ManyToOneRelationships[t].ReferencedAttribute,d=e.ManyToOneRelationships[t].ReferencingAttribute;else{if(null===(u=e.ManyToManyRelationships)||void 0===u||!u[t]){var f="Relationship name not found: ".concat(t,".");throw a.error("".concat(S()," ").concat(f),i),new n.LocalError(f)}r===c.RelationshipRoleOrdinal.Referencing?(p=e.ManyToManyRelationships[t].IntersectEntityName,l=e.ManyToManyRelationships[t].Entity2IntersectAttribute,d=e.ManyToManyRelationships[t].Entity2IntersectAttribute):(p=e.ManyToManyRelationships[t].Entity2LogicalName,l=e.ManyToManyRelationships[t].Entity1IntersectAttribute,d=e.ManyToManyRelationships[t].Entity1IntersectAttribute)}return{linkEntityName:p,from:l,to:d}}function S(e){return"[".concat(e||a.FILE_PREFIX.ApplyLinkEntitySQLGenerator,"]")}},9163:function(e,t,r){"use strict";r.r(t),r.d(t,"addNavigationProperty",(function(){return l}));var n=r(9045),a=r(9144),i=r(9160),o=r(9142),s=r(9140);function u(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function c(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){u(i,n,a,o,s,"next",e)}function s(e){u(i,n,a,o,s,"throw",e)}o(void 0)}))}}function l(e,t,r,n,a,i,o){return d.apply(this,arguments)}function d(){return(d=c((function*(e,t,r,u,c,l,d){var p=r[n.ADDITIONAL_PARAMETERS.NavigationPropertyRelationshipName],f=yield Object(o.getManyToOneRelationship)(u,e,p,c,d);if(f){var h='"'.concat(e,'0"'),m=r[n.ADDITIONAL_PARAMETERS.RecordId],y={name:f.ReferencedEntity,from:f.ReferencedAttribute,to:f.ReferencingAttribute,alias:"bb"},v="".concat(y.from," eq '").concat(m,"'"),g=yield Object(a.generateFilterClause)(y.name,"bb",v,u,c,l),O=yield Object(i.generateJoinClause)(e,g,s.LogicalOperatorString.and,y,h,!1,u,c,l);t=Object(i.updateSqlWithJoinClauseFromJoinClauses)(e,t,[O])}return t}))).apply(this,arguments)}},9164:function(e,t,r){"use strict";r.r(t),r.d(t,"generateUpdateRequests",(function(){return y})),r.d(t,"getUpdateRequestWithoutMetadata",(function(){return g})),r.d(t,"getUpdateOperationSqlQueryRequest",(function(){return E})),r.d(t,"getBaseUpdateRequest",(function(){return T}));var n=r(9045),a=r(9050),i=r(9047),o=r(9054),s=r(9109),u=r(9063),c=r(9112),l=r(9132),d=r(9133),p=r(9144),f=r(9046);function h(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function m(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){h(i,n,a,o,s,"next",e)}function s(e){h(i,n,a,o,s,"throw",e)}o(void 0)}))}}function y(e,t,r){return v.apply(this,arguments)}function v(){return(v=m((function*(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=n.commonEventParameters||[],c=yield Object(s.getEntityNameFromRequest)(e,t,r,i,n);if(n.internalRequest)return g(e,c,t,r,n,i);var l=yield Object(o.getAttributeTypes)(t,[],c,i),d=yield Object(s.getColumnsFromRequestJSON)(e.body,l,c,t,r,i),p=Object(s.getEntityIdFromUrl)(e.url,r,i);if(Object(a.isNullOrUndefined)(p)){var f=new Error("Update Generator was unable to extract GUID from url");throw r.error("".concat(R()," ").concat(f.message),i),f}var h={id:p,entityLogicalName:c,attributeTypes:l,values:{}},m=yield Object(o.getEntityMetadata)(t,c);return h=yield Object(s.populateRecordWithData)(h,d,l,u.SqlOperation.update,t,r,i,n),E(e,t,h=yield Object(s.populateDefaultFieldsForOperation)(t,h,m,u.SqlOperation.update,i,n),m,c,r,i)}))).apply(this,arguments)}function g(e,t,r,n){return O.apply(this,arguments)}function O(){return(O=m((function*(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[];if(Object(a.isNullOrUndefinedOrEmptyString)(e.body)){var s="Invalid request. Empty request body";throw n.error("".concat(R()," ").concat(s),o),new Error(s)}var c={id:f.Guid.newGuid(),entityLogicalName:t,values:JSON.parse(e.body)},l=Object(d.determineHintsFromODataQueryUrl)(e.url,n,o,Object(a.isUpsyncRequest)(e));if(null!=l&&l.filter){var h=T(c,n,o),m=yield Object(p.addFilter)(t,h.sqlStatements[0],l.filter,r,n,i,!0),y={sqlStatements:[m],sqlParameters:[h.sqlParameters[0]]};return y}throw n.error("".concat(R()," ","Failure in upsync pipeline-").concat(u.ERROR_STRING.invalidParameter),o),new Error(u.ERROR_STRING.invalidParameter)}))).apply(this,arguments)}function E(e,t,r,n,a,i){return b.apply(this,arguments)}function b(){return(b=m((function*(e,t,r,a,i,o){var c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:[];if(!a||!a.PrimaryIdAttribute)throw new Error(u.ERROR_STRING.primaryIdAttribute);var d={sqlStatements:[],sqlParameters:[],additionalParameters:{[n.ADDITIONAL_PARAMETERS.RecordId]:r.id.guid.toString()}};return d.sqlStatements.push(Object(l.generateSimpleSelectStatement)(i,a.PrimaryIdAttribute,t,o,c)),d.sqlParameters.push([r.id.guid]),d=S(d,r,t,o,a.PrimaryIdAttribute,c),a.IsActivity&&(d=yield C(t,r,d,c)),a&&e&&e.additionalHeaders&&e.additionalHeaders.Prefer&&-1!==e.additionalHeaders.Prefer.indexOf(n.HEADER_VALUES.PREFER_REPRESENTATION)&&(d=Object(s.appendRetrieveQuery)(t,d,i,r.id,a.PrimaryIdAttribute,c)),d}))).apply(this,arguments)}function T(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(Object(a.isNullOrUndefined)(e))throw t.error("".concat(R()," Invalid parameters when creating update query"),r),new Error("Invalid parameters for update query generation");var n="",i=[],o=0;for(var s in e.values)if(!Object(a.isNullOrUndefinedOrEmptyString)(s)){var c=o>0?",":"";n+="".concat(c,"[").concat(s,"] = ?"),i.push(e.values[s]),o+=1}if(!Object(a.isNullOrUndefinedOrEmptyString)(n)&&i.length>0){var l=u.CLAUSE.update+u.Punctuation.space+e.entityLogicalName+u.Punctuation.space+u.CLAUSE.set+u.Punctuation.space+n+u.Punctuation.space;return{sqlStatements:[l],sqlParameters:[i]}}return{sqlStatements:[],sqlParameters:[]}}function S(e,t,r,n,i){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[];if(Object(a.isNullOrUndefined)(i))throw n.error("".concat(R()," Invalid parameters when creating update query"),o),new Error("Invalid parameters for update query generation");var s=T(t,n,o);if(s.sqlStatements.length>0){var u=Object(p.addAttributeFilter)(s.sqlStatements[0],i),c=s.sqlParameters[0];c.push(t.id.guid),e.sqlStatements.push(u),e.sqlParameters.push(c)}return e}function C(e,t,r){return N.apply(this,arguments)}function N(){return(N=m((function*(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];return Object(a.isNullOrUndefined)(t.activityParties)||(r=_(t,r),r=yield Object(s.getInsertActivityPartySQLQueryRequests)(e,t,r,n)),r}))).apply(this,arguments)}function _(e,t){return Object(a.isNullOrUndefined)(e.activityParties)||(t.sqlStatements.push(u.CLAUSE.delete+u.Punctuation.space+u.CLAUSE.from+u.Punctuation.space+u.Punctuation.openSQBracket+c.activityParty+u.Punctuation.closeSQBracket+u.Punctuation.space+u.CLAUSE.where+u.Punctuation.space+u.Punctuation.openSQBracket+c.activityId+c.columnDelimiter+c.id+u.Punctuation.closeSQBracket+u.Punctuation.space+u.Punctuation.equal+u.Punctuation.space+u.Punctuation.question+u.Punctuation.space+u.CLAUSE.collateNoCase),t.sqlParameters.push([e.id.guid])),t}function R(e){return"[".concat(e||i.FILE_PREFIX.UpdateGenerator,"]")}},9165:function(e,t,r){"use strict";r.r(t),r.d(t,"generateFullName",(function(){return a}));var n=r(9063);function a(e,t,r,a){t=t?t.trim():"",r=r?r.trim():"",a=a?a.trim():"";var i="";r.length>0&&(i=r.substring(0,1));var o="";switch(e){case 0:o=a.length>0&&t.length>0?a+", "+t:a+" "+t;break;case n.FullNameConventionCode.firstLast:o=t+" "+a;break;case n.FullNameConventionCode.lastFirstMiddleInitial:o=function(e,t,r){var n="";t.length>0&&(n=t);t.length>0&&(e.length>0||r.length>0)&&(n+=",");e.length>0&&(n=n+" "+e);r.length>0&&(n=n+" "+r+".");return n.toString().trim()}(t,a,i);break;case n.FullNameConventionCode.firstMiddleInitialLast:o=t,r.length>0&&(o=o+" "+i+"."),o=o+" "+a;break;case n.FullNameConventionCode.lastFirstMiddle:a.length>0&&(o=a),a.length>0&&(t.length>0||r.length>0)&&(o+=","),t.length>0&&(o=o+" "+t),r.length>0&&(o=o+" "+r);break;case n.FullNameConventionCode.firstMiddleLast:o=t,r.length>0&&(o=o+" "+r),o=o+" "+a;break;case n.FullNameConventionCode.lastSpaceFirst:o=a+" "+t;break;case n.FullNameConventionCode.lastNoSpaceFirst:o=a+t;break;default:o=a}return o.toString().trim()}},9166:function(e,t,r){"use strict";function n(e,t,r,n){e.values[t]=r,e.attributeTypes&&!(t in e.attributeTypes)&&(e.attributeTypes[t]=n)}r.r(t),r.d(t,"setFieldValue",(function(){return n}))},9167:function(e,t,r){"use strict";r.r(t),r.d(t,"createResponseHandler",(function(){return l})),r.d(t,"getCreateOperationResponseData",(function(){return p}));var n=r(9045),a=r(9056),i=r(9047),o=r(9109),s=r(9053);function u(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function c(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){u(i,n,a,o,s,"next",e)}function s(e){u(i,n,a,o,s,"throw",e)}o(void 0)}))}}function l(e,t,r,n,a){return d.apply(this,arguments)}function d(){return(d=c((function*(e,t,r,i,o){var u,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],l=e.url,d="",f=null;o&&o[n.ADDITIONAL_PARAMETERS.RecordId]&&(f=o[n.ADDITIONAL_PARAMETERS.RecordId]);var m=new Headers;if(null!=f){var y=e.url+"("+f+")";m.append(n.HEADER.ODADTA_ENTITY_ID,y),r.info("".concat(h()," Processing the create response")),d=yield p(e,t,r,i,c),u=Object(s.buildOdataResponse)(n.HTTP_STATUS_CODES.NoContent,l,m,d)}else r.error("".concat(h()," Guid returned from sql executor is null"),c),u=Object(s.buildErrorResponse)(n.HTTP_STATUS_CODES.Unknown,l,new a.LocalError("Guid returned from sql executor is null"));return u}))).apply(this,arguments)}function p(e,t,r,n){return f.apply(this,arguments)}function f(){return(f=c((function*(e,t,r,n){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],i="",u=n,c={};if(Object(s.headerContainsPreferReturnRepresentation)(e)&&u&&u.length>1&&u[1].rows.length>0){var l=u[1].rows.item(0);if(l){var d=yield Object(o.getEntityNameFromRequest)(e,t,r,a),p=!1;Object(s.headerContainsPreferAnnotation)(e)&&(p=!0),c=yield Object(s.getFormattedRecordData)(t,l,d,p),i=JSON.stringify(c)}}return i}))).apply(this,arguments)}function h(e){return"[".concat(e||i.FILE_PREFIX.CreateResponseHandler,"]")}},9168:function(e,t,r){"use strict";r.r(t),r.d(t,"deleteResponseHandler",(function(){return l}));var n=r(9045),a=r(9058),i=r(9050),o=r(9056),s=r(9047),u=r(9053),c="You cannot delete this record because it doesn't exist in the offline mode";function l(e,t,r,s){var l,p=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],f=e.url,h=[];if(Object(i.isUpsyncRequest)(e)||Object(i.isNullOrUndefined)(s)||!Object(i.isNullOrUndefined)(s[0])&&s[0].rows.length)l=Object(u.buildOdataResponse)(n.HTTP_STATUS_CODES.NoContent,f,new Headers);else{var m=new o.LocalError(c,n.ErrorCode.CannotDeleteOnlineRecord);Object(a.addErrorInformationToEventParameters)(m,h),r.error("".concat(d()," ").concat(c),Object(a.addEventParameters)(p,h)),l=Object(u.buildErrorResponse)(n.HTTP_STATUS_CODES.BadRequest,e.url,m)}return l}function d(e){return"[".concat(e||s.FILE_PREFIX.DeleteResponseHandler,"]")}},9169:function(e,t,r){"use strict";r.r(t),r.d(t,"getClientMetadataResponseHandler",(function(){return f})),r.d(t,"getGCMOperationResponseData",(function(){return g}));var n=r(9045),a=r(9058),i=r(9050),o=r(9077),s=r(9047),u=r(9078),c=r(9115),l=r(9053);function d(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function p(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){d(i,n,a,o,s,"next",e)}function s(e){d(i,n,a,o,s,"throw",e)}o(void 0)}))}}function f(e,t,r,n){return h.apply(this,arguments)}function h(){return(h=p((function*(e,t,r,a){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],o=arguments.length>5?arguments[5]:void 0,s=e.url;r.info("".concat(b()," Executing getClientMetadataResponseHandler."));var u=yield g(t,e,r,a,i,o),c=Object(l.buildOdataResponse)(n.HTTP_STATUS_CODES.Ok,s,new Headers,u);return c}))).apply(this,arguments)}function m(e,t){var r;if(Object(i.isUserContextMetadataRequest)(t))r="UserContext";else switch(e){case o.MetadataType.none:r="none";break;case o.MetadataType.workspace:r="Dashboards";break;case o.MetadataType.form:r="Forms";break;case o.MetadataType.component:r="Component";break;case o.MetadataType.entityCard:r="EntityCard";break;case o.MetadataType.quickCreateForm:r="QuickCreateForm";break;case o.MetadataType.customization:r="Customization";break;case o.MetadataType.listQuery:r="ListQuery";break;case o.MetadataType.grid:r="Grid";break;case o.MetadataType.command:r="Ribbons";break;case o.MetadataType.siteMap:r="Sitemap";break;case o.MetadataType.list:r="List";break;case o.MetadataType.dialog:r="Dialogs";break;case o.MetadataType.gridForm:r="GridForm";break;case o.MetadataType.inlineCreateForm:r="InlineCreateForm";break;case o.MetadataType.processControl:r="ProcessControl";break;case o.MetadataType.fetchXml:r="FetchXml";break;case o.MetadataType.chartDrilldownForm:r="ChartDrilldownForm";break;case o.MetadataType.entity:r="Entities";break;case o.MetadataType.attribute:r="Attributes";break;case o.MetadataType.webResource:r="WebResourcesContent";break;case o.MetadataType.applicationMetadata:r="ApplicationMetadata";break;case o.MetadataType.mainFormDialog:r="QuickEditForm";break;case o.MetadataType.chart:r="Chart";break;case o.MetadataType.uiStrings:r="UIStrings";break;case o.MetadataType.businessLogic:r="BusinessLogic";break;case o.MetadataType.searchPage:r="SearchPage";break;case o.MetadataType.globalApplicationMetadata:r="GlobalApplicationMetadata";break;case o.MetadataType.applicationMetadataUserContext:r="ApplicationMetadataUserContext";break;case o.MetadataType.staticJSFile:r="StaticJSFile";break;case o.MetadataType.layoutXml:r="LayoutXml";break;case o.MetadataType.draftsPage:r="DraftsPage";break;case o.MetadataType.duplicateRecordsPage:r="DuplicateRecordsPage";break;case o.MetadataType.applicationMetadataSettings:r="ApplicationMetadataSettings";break;case o.MetadataType.senderFormPage:r="SenderFormPage";break;case o.MetadataType.setRegarding:r="SetRegarding";break;case o.MetadataType.senderCreateFormPage:r="SenderCreateFormPage";break;case o.MetadataType.interactionCentricWorkspace:r="Dashboards";break;case o.MetadataType.taskBasedFlowGlobalMenu:r="TaskBasedFlowGlobalMenu";break;case o.MetadataType.taskBasedFlow:r="TaskBasedFlows";break;case o.MetadataType.interactionCentricForm:r="InteractionCentricForm";break;case o.MetadataType.cardForm:r="CardForm";break;case o.MetadataType.controlConfiguration:r="ControlConfiguration";break;case o.MetadataType.commandXaml:r="CommandXaml";break;case o.MetadataType.documentTemplate:r="DocumentTemplate";break;case o.MetadataType.viewSelector:r="ViewSelectors";break;case o.MetadataType.customControl:r="CustomControls";break;case o.MetadataType.formSelector:r="FormSelectors";break;case o.MetadataType.resourceString:r="ResourceStrings";break;case o.MetadataType.savedQueryVisualization:r="SavedQueryVisualizations";break;case o.MetadataType.label:r="Labels";break;case o.MetadataType.userView:case o.MetadataType.savedView:r="Views";break;case o.MetadataType.viewDefault:r="ViewDefault";break;case o.MetadataType.homePageConfiguration:r="CustomControlConfigurations";break;case o.MetadataType.optionSet:r="OptionSets";break;case o.MetadataType.quickCreateMenu:r="QuickCreateMenu";break;case o.MetadataType.userContext:r="UserContext";break;case o.MetadataType.businessProcessFlow:r="BusinessProcessFlowMetadata";break;case o.MetadataType.searchConfiguration:r="Search";break;case o.MetadataType.userQueryVisualization:r="UserQueryVisualizations";break;case o.MetadataType.visualizationSelector:r="VisualizationSelectors";break;case o.MetadataType.dashboardSelector:r="DashboardSelectors";break;case o.MetadataType.overallMetadataVersion:r="MetadataVersion";break;case o.MetadataType.appModule:r="AppModulePublished";break;case o.MetadataType.complexControl:r="ComplexControls";break;case o.MetadataType.displayString:r="DisplayStrings";break;case o.MetadataType.webResourceDescriptor:r="WebResources";break;case o.MetadataType.isActivityFlags:r="IsActivityFlags";break;case o.MetadataType.appModuleOfflineMetadata:r="AppModules";break;case o.MetadataType.appModuleSelector:r="AppModuleSelector";break;case o.MetadataType.bpfSelector:r="BPFSelectors";break;case o.MetadataType.dependencies:r="dependencies"}return r}function y(e,t,r){var n,a=JSON.parse(e);if(Object(i.isUserContextMetadataRequest)(r))n=a;else switch(t){case o.MetadataType.attribute:case o.MetadataType.entity:n=a;break;case o.MetadataType.searchConfiguration:n=a.data.Search;break;case o.MetadataType.quickCreateMenu:n=a.data.QuickCreateMenu;break;default:n=a.data}return n}function v(e){switch(e){case o.MetadataType.quickCreateMenu:case o.MetadataType.searchConfiguration:return!0;default:return!1}}function g(e,t,r,n){return O.apply(this,arguments)}function O(){return(O=p((function*(e,t,r,n){var s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],u=arguments.length>5?arguments[5]:void 0,l=n,d={},p={},f=[],h=Object(c.extractClientMetadataQuery)(t,r);if(f.push({name:"RequestUrl",value:t.url}),f.push({name:"MetadataType",value:h.MetadataType}),f.push({name:"DependencyDepth",value:h.DependencyDepth}),f.push({name:"MetadataSubtype",value:h.MetadataSubtype}),r.info("".concat(b()," Executing getGCMOperationResponseData"),Object(a.addEventParameters)(s,f)),l&&l.length>0)for(var g=0;g<l.length;g++)if((f=[]).push({name:"NoOfResponsesReturnedFromDb",value:l.length}),f.push({name:"Index",value:g}),f.push({name:"RequestUrl",value:t.url}),l[g]&&l[g].rows.length>0)for(var O=0;O<l[g].rows.length;O++){var T=l[g].rows.item(O);if(T&&T.json){var S=T.json,C=JSON.parse(S),N=void 0,_=E(T,C,g,u);if(N=m(_,h),f.push({name:"MetadataType",value:_}),Object(i.isNullOrUndefined)(N))r.error("".concat(b()," MetadataTypeKey evaluated to be null or empty"),Object(a.addEventParameters)(s,f));else{f.push({name:"MetadataTypeKey",value:N});var R=y(S,_,h);if(v(_))r.info("".concat(b()," Creating response node for current MetaDataType.")+N+". Taking response as it is as the response is already in required format",Object(a.addEventParameters)(s,f)),p[N]=R;else if(p[N]){if(_===o.MetadataType.resourceString){var P=p[N][0];P.push(R),p[N]=[P]}else p[N].push(R);f.push({name:"NoOfMetadataForThisMetadataTypeKey",value:p[N].length}),r.info("".concat(b()," Adding response for current MetaDataType.")+N,Object(a.addEventParameters)(s,f))}else p[N]=[R],_===o.MetadataType.resourceString&&(p[N]=[p[N]]),f.push({name:"NoOfMetadataForThisMetadataTypeKey",value:1}),r.info("".concat(b()," Creating new response node for current MetaDataType.")+N,Object(a.addEventParameters)(s,f))}}else r.warn("".concat(b()," Response returned from offline db has empty json."),Object(a.addEventParameters)(s,f))}else r.warn("".concat(b()," Response returned from offline db is empty at current index."),Object(a.addEventParameters)(s,f));else r.warn("".concat(b()," Response returned from offline db is empty"),Object(a.addEventParameters)(s,f));return d.Metadata=JSON.stringify(p),JSON.stringify(d)}))).apply(this,arguments)}function E(e,t,r,n){o.MetadataType.none;return e.metadatatype?e.metadatatype:t.metadatatype?t.metadatatype:n&&n[u.MetadataFields.METADATA_TYPE]&&Array.isArray(n[u.MetadataFields.METADATA_TYPE])&&r<n[u.MetadataFields.METADATA_TYPE].length?n[u.MetadataFields.METADATA_TYPE][r]:o.MetadataType.entity}function b(e){return"[".concat(e||s.FILE_PREFIX.GetClientMetadataResponseHandler,"]")}},9170:function(e,t,r){"use strict";r.r(t),r.d(t,"retrieveMultipleResponseHandler",(function(){return v}));var n=r(9045),a=r(9058),i=r(9047),o=r(9109),s=r(9063),u=r(9050),c=r(9054),l=r(9135),d=r(9053),p=r(9134),f=r(9171),h=r(9162);function m(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function y(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){m(i,n,a,o,s,"next",e)}function s(e){m(i,n,a,o,s,"throw",e)}o(void 0)}))}}function v(e,t,r,n,a){return g.apply(this,arguments)}function g(){return(g=y((function*(e,t,r,i,l){var p=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},h=p.commonEventParameters||[],m=e.url,y=[],v="",g=yield Object(o.getEntityNameFromRequest)(e,t,r,h,p),N=!1;if(p.internalRequest&&(Object(u.isEntityLogTable)(g)&&(g=Object(u.getEntityNameForEntityLogTable)(g),N=!0),Object(u.isOfflineOnlyEntity)(g)))return O(e,t,i,h);var R=0,P=0,I=!1,A=!1,D=Number(s.DEFAULT.PageNumber),M=-1,F=[],w=i,L={},j=[];if(w&&w.length>0){var x=yield Object(c.getEntityMetadata)(t,g),U=x&&x.PrimaryIdAttribute?x.PrimaryIdAttribute:"".concat(g,"id");l&&!Object(u.isNullOrUndefined)(l[n.ADDITIONAL_PARAMETERS.PageSize])?R=Number(l[n.ADDITIONAL_PARAMETERS.PageSize]):r.warn("".concat(_()," Paging size is not passed in additional parameters"),Object(a.addEventParameters)(h,y)),l&&l[n.ADDITIONAL_PARAMETERS.PageNumber]&&(D=Number(l[n.ADDITIONAL_PARAMETERS.PageNumber])),l&&l[n.ADDITIONAL_PARAMETERS.Expand]&&(F=l[n.ADDITIONAL_PARAMETERS.Expand]),l&&l[n.ADDITIONAL_PARAMETERS.Top]&&(M=l[n.ADDITIONAL_PARAMETERS.Top]),w[0].rows.length>R?(I=!0,A=!0,P=R):P=w[0].rows.length,b(e)&&M>0&&R<M&&M-R*D<0&&(P=M-(D-1)*R);for(var k=[],q=0;q<P;q++)k.push(w[0].rows.item(q));yield Object(f.refreshRetrieveMultipleLookupData)(k,g,P,t,r,_(),p);var V={};e.additionalHeaders&&e.additionalHeaders[n.HINT.linkEntity]&&(V=yield C(e.additionalHeaders[n.HINT.linkEntity],t,r,h));for(var B=0;B<P;B++){var H=k[B],G={},Q=!1;Object(d.headerContainsPreferAnnotation)(e)&&(Q=!0),H&&(G=yield Object(d.getFormattedRecordData)(t,H,g,Q,V,[],N),!Object(u.isNullOrUndefined)(F)&&F.length>0&&S(G,F,g,U),j.push(G))}}return L["@Microsoft.Dynamics.CRM.totalrecordcount"]=P,L["@Microsoft.Dynamics.CRM.totalrecordcountlimitexceeded"]=A,L["@Microsoft.Dynamics.CRM.morerecords"]=I,L.value=j,l&&E(e,l)&&I&&T(L,g,R,D,M,l,r,h,Object(u.isUpsyncRequest)(e)),v=JSON.stringify(L),y.push({name:"NoOfRecordsReturned",value:P}),y.push({name:"TotalRecordCountLimitExceeded",value:A}),y.push({name:"MoreRecords",value:I}),y.push({name:"PageSize",value:R}),t.EventManager.ReportComponentSuccess(_(),Object(a.addEventParameters)(h,y)),Object(d.buildOdataResponse)(n.HTTP_STATUS_CODES.Ok,m,new Headers,v)}))).apply(this,arguments)}function O(e,t,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],o=e.url,s=[],u="",c=0,l=r,p=[],f={};if(l&&l.length>0){c=l[0].rows.length;for(var h=0;h<c;h++)p.push(l[0].rows.item(h))}return f["@Microsoft.Dynamics.CRM.totalrecordcount"]=c,f.value=p,u=JSON.stringify(f),s.push({name:"NoOfRecordsReturned",value:c}),t.EventManager.ReportComponentSuccess(_(),Object(a.addEventParameters)(i,s)),Object(d.buildOdataResponse)(n.HTTP_STATUS_CODES.Ok,o,new Headers,u)}function E(e,t){return!(!b(e)||!t[n.ADDITIONAL_PARAMETERS.ODataQuery])}function b(e){return!(!e.additionalHeaders||e.additionalHeaders[n.HINT.viewId])}function T(e,t,r,a,i,o,c){var l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:[],d=arguments.length>8?arguments[8]:void 0;if(o[n.ADDITIONAL_PARAMETERS.MaxPageSize]){var f=o[n.ADDITIONAL_PARAMETERS.MaxPageSize],h=o[n.ADDITIONAL_PARAMETERS.ODataQuery];if(i<0||a*r<i){var m;if(-1===h.indexOf(p.QUERY_TOKENS.skipToken))m="".concat(h,"&").concat(p.QUERY_TOKENS.skipToken,"=").concat(a+1);else{var y=Object(p.parseODataQuery)(h,c,l,d);for(var v in y)Object(u.isNullOrUndefinedOrEmptyString)(m)?m=s.Punctuation.question:m+="&",v===p.QUERY_TOKENS.skipToken&&(y[v]=a+1),m+="".concat(v,"=").concat(y[v])}e[p.QUERY_TOKENS.oDataNextLink]={API:"{Xrm.Mobile.offline}.{retrieveRecord}",entityType:t,options:m,maxPageSize:f}}}}function S(e,t,r,n){if(!Object(u.isNullOrUndefined)(t)&&t.length>0)for(var a=0;a<t.length;a++)e["".concat(t[a].navigationProperty).concat(p.QUERY_TOKENS.oDataNextLink)]={API:"{Xrm.Mobile.offline}.{retrieveRecord}",id:e["".concat(n)].toString(),entityType:r,option:"?$select=".concat(n,"&").concat(Object(l.generateExpandTermString)(t[a]),"&$getOnlyRelatedEntity=true")},e[t[a].navigationProperty]={}}function C(e,t,r){return N.apply(this,arguments)}function N(){return(N=y((function*(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a={};if(!Object(u.isNullOrUndefinedOrEmptyString)(e)){var i=e.split(";").map(e=>e.trim());if(i)for(var o of i)try{var s=Object(h.parseSingleHint)(o,r,n),l=yield Object(c.getEntityMetadata)(t,s.entityLogicalName),{linkEntityName:d}=Object(h.getLinkEntityInfoFromRelationship)(l,s.relationshipName,s.roleOrdinal,r,n);a[s.alias]=d}catch(p){r.warn("".concat(_()," Link entities map cannot be built from the link entities hint"),n)}}return a}))).apply(this,arguments)}function _(e){return"[".concat(e||i.FILE_PREFIX.RetrieveMultipleResponseHandler,"]")}},9171:function(e,t,r){"use strict";r.r(t),r.d(t,"refreshRetrieveMultipleLookupData",(function(){return f}));var n=r(9045),a=r(9063),i=r(9050),o=r(9054),s=r(9048),u=r(9112),c=r(9125),l=r(9111);function d(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function p(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){d(i,n,a,o,s,"next",e)}function s(e){d(i,n,a,o,s,"throw",e)}o(void 0)}))}}function f(e,t,r,n,a,i,o){return h.apply(this,arguments)}function h(){return(h=p((function*(e,t,r,n,s,c,l){var d=l.commonEventParameters||[];if(!(r<=0)){var p={},f=[];try{for(var h=0;h<r;h++){var v=m(e[h]);if(!Object(i.isNullOrUndefinedOrEmpty)(v)){var O=yield Object(o.getAttributeTypes)(n,Object.keys(v),t,d);yield y(n,f,p,O,v,d)}}if(0===f.length)return;var E={},b={};yield g(p,E,b,n,s,l);var T={};for(var S in E)for(var C=E[S],N=0;N<C[0].rows.length;N++){var _=C[0].rows.item(N),R=Object.keys(_);_&&b[S]&&R.includes(b[S].id)&&R.includes(b[S].name)&&(T[_[b[S].id].toUpperCase()]=_[b[S].name])}if(Object(i.isNullOrUndefinedOrEmpty)(T))return void s.warn("".concat(c," Unable to map refresh lookup data to the existing record. Skip refreshing lookup data."),d);for(var P=0;P<r;P++){var I=e[P],A=Object.keys(I);for(var D of f){var M="".concat(D).concat(a.Punctuation.exclamation).concat(u.id);A.includes(M)&&I[M]&&!Object(i.isNullOrUndefinedOrEmpty)(T[I[M].toUpperCase()])&&(e[P]["".concat(D).concat(a.Punctuation.exclamation).concat(u.name)]=T[I[M].toUpperCase()])}}}catch(F){s.warn("".concat(c," Failed to refreshRetrieveMultipleLookupData with ").concat(F),d)}}}))).apply(this,arguments)}function m(e){var t={},r=Object.keys(e);for(var n of r){var a=n.split(u.columnDelimiter),o=Object(i.isNullOrUndefined)(a[0])?"":a[0];2===a.length&&a[1]&&[u.id,u.logicalName,u.name].includes(a[1])&&(t[o]?t[o][a[1]]=e[n]:t[o]={["".concat(a[1])]:e[n]})}return t}function y(e,t,r,n,a){return v.apply(this,arguments)}function v(){return(v=p((function*(e,t,r,n,a){var u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],c=yield Object(o.getOfflineAvailableEntities)(e,u);for(var l in n){var d=n[l];if(d===s.AttributeType.Lookup||d===s.AttributeType.Customer||d===s.AttributeType.Owner&&l in a){var p=a[l];if(Object(i.isNullOrUndefinedOrEmpty)(p))continue;if(c.includes(p.logicalname)){t.indexOf(l)<0&&t.push(l);var f=p.logicalname in r?r[p.logicalname]:[];f.indexOf(p.id.toUpperCase())<0&&(f.push(p.id.toUpperCase()),r[p.logicalname]=f)}}}}))).apply(this,arguments)}function g(e,t,r,n,a,i){return O.apply(this,arguments)}function O(){return(O=p((function*(e,t,r,a,i,s){var d=s.commonEventParameters||[];for(var p in e){var f,h,m=yield Object(o.getEntityMetadata)(a,p),y=m&&m.PrimaryIdAttribute?m.PrimaryIdAttribute:"".concat(p).concat(u.id),v=m&&m.PrimaryNameAttribute?m.PrimaryNameAttribute:u.name,g=yield Object(c.retrieveLookupRecords)(e[p],p,y,v,i,d),O=[];g.sqlStatements&&g.sqlStatements.length>0&&(O=yield Object(l.ExecuteSQLBatch)(g,a,n.OPERATION.Retrieve,s)),(null===(f=O)||void 0===f?void 0:f.length)>0&&(null===(h=O)||void 0===h?void 0:h[0].rows.length)>0&&(t[p]=O,r[p]={id:y,name:v})}}))).apply(this,arguments)}},9172:function(e,t,r){"use strict";r.r(t),r.d(t,"updateResponseHandler",(function(){return c}));var n=r(9045),a=r(9050),i=r(9056),o=r(9047),s=r(9053),u="You cannot update this record because it doesn't exist in the offline mode";function c(e,t,r,o){var c,d=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];if(Object(a.isUpsyncRequest)(e)||Object(a.isNullOrUndefined)(o)||!Object(a.isNullOrUndefined)(o[0])&&o[0].rows.length){var p=new Headers;p.append(n.HEADER.ODADTA_ENTITY_ID,e.url),c=Object(s.buildOdataResponse)(n.HTTP_STATUS_CODES.NoContent,e.url,p)}else r.error("".concat(l()," ").concat(u),d),c=Object(s.buildErrorResponse)(n.HTTP_STATUS_CODES.BadRequest,e.url,new i.LocalError(u,n.ErrorCode.CannotUpdateOnlineRecord));return c}function l(e){return"[".concat(e||o.FILE_PREFIX.UpdateResponseHandler,"]")}},9173:function(e,t,r){"use strict";r.r(t),r.d(t,"uploadResponseHandler",(function(){return i}));var n=r(9045),a=r(9053);function i(e,t,r,i,o){var s=e.url;return Object(a.buildOdataResponse)(n.HTTP_STATUS_CODES.NoContent,s)}},9174:function(e,t,r){"use strict";r.r(t),r.d(t,"SQLLocalODataClient",(function(){return i}));var n=r(9093),a=r(9114);class i extends n.ODataClient{constructor(e,t){super(e,t),this.setExecuteRequestInterceptor(new a.SQLRequestInterceptor(this.applicationContext)).build()}}},9175:function(e,t,r){"use strict";r.r(t),r.d(t,"RemoteODataClientManager",(function(){return o}));var n=r(9093),a=r(9176),i=r(9178);class o{constructor(e,t){this._HttpODataClient=void 0,this._applicationContext=void 0,this._applicationContext=t,this._HttpODataClient=new n.ODataClient(e,this._applicationContext).addInterceptor(new i.LongRequestInterceptor(this._applicationContext)).setExecuteRequestInterceptor(new a.HttpExecuteInterceptor(this._applicationContext)).build()}getRemoteODataClient(e){return this._HttpODataClient}}},9176:function(e,t,r){"use strict";r.r(t),r.d(t,"HttpExecuteInterceptor",(function(){return l}));var n=r(9045),a=r(9058),i=r(9050),o=r(9047),s=r(9177),u=r(9062);function c(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}class l extends s.ExecuteRequestInterceptor{execute(e,t){var r,s=this;return(r=function*(){var r=new Headers,c=s.applicationContext.TraceManager.getTracer(o.COMPONENT_NAMES.RemoteODataExecutor),l=s._stripHintsFromHeader(e,c),d=l.additionalHeaders,p=[];if(Object(a.addRequestDetailsToEventParameters)(l,p),d)for(var f in d)Object(i.getHttpHeader)(r,f)&&r.delete(f),r.append(f,d[f]);var h=new Request(l.url,{method:l.method,credentials:"same-origin",headers:r,body:l.body});try{t&&t.performanceControl&&t.performanceControl.startMarker(o.FILE_PREFIX.FetchRequest);var m=yield fetch(h);return t&&t.performanceControl&&t.performanceControl.endMarker(o.FILE_PREFIX.FetchRequest),m}catch(g){var y=g&&g.message?g.message:"Failed to fetch",v="Failed to fetch"===y?n.ErrorCode.NetworkIssue:g.code;return g.message=y,g.code=v,p.push({name:o.EVENT_PARAMETERS.REQUEST_URL,value:Object(u.trimUrl)(l.url)}),Object(a.addErrorInformationToEventParameters)(g,p),c.error("".concat(s.getHttpExecutorInterceptorPrefix()," ").concat(y),p),Object(i.buildODataResponseFromError)(g,l.url,void 0,v)}},function(){var e=this,t=arguments;return new Promise((function(n,a){var i=r.apply(e,t);function o(e){c(i,n,a,o,s,"next",e)}function s(e){c(i,n,a,o,s,"throw",e)}o(void 0)}))})()}getHttpExecutorInterceptorPrefix(e){return"[".concat(e||o.FILE_PREFIX.HttpExecutorInterceptor,"]")}_stripHintsFromHeader(e,t){try{if(e.additionalHeaders)for(var r in n.HINT)delete e.additionalHeaders[n.HINT[r]]}catch(i){var a="Exception in _stripHintsFromHeader";i.message=a,t.error("".concat(this.getHttpExecutorInterceptorPrefix()," ").concat(a))}return e}}},9177:function(e,t,r){"use strict";r.r(t),r.d(t,"ExecuteRequestInterceptor",(function(){return s}));var n=r(9047),a=r(9099);function i(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function o(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function s(e){i(o,n,a,s,u,"next",e)}function u(e){i(o,n,a,s,u,"throw",e)}s(void 0)}))}}class s extends a.Interceptor{execute(e,t){return o((function*(){throw new Error("execute function is not implemented")}))()}preprocessing(e){return o((function*(){return e}))()}postprocessing(e,t){return o((function*(){return e}))()}intercept(e){var t=this;return o((function*(){var r=e.executionContext,n=e.request,a=yield t.preprocessing(n);t.tracer.info("".concat(t.getExecuteRequestInterceptorPrefix()," Execute request start ").concat(a.url));var i=yield t.execute(a,r);return t.tracer.info("".concat(t.getExecuteRequestInterceptorPrefix()," Execute request finish ").concat(i.status)),yield t.postprocessing(i,n)}))()}getExecuteRequestInterceptorPrefix(e){return"[".concat(e||n.FILE_PREFIX.ExecuteRequestInterceptor,"]")}}},9178:function(e,t,r){"use strict";r.r(t),r.d(t,"LongRequestInterceptor",(function(){return u}));var n=r(9058),a=r(9050),i=r(9047),o=r(9099);function s(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}class u extends o.Interceptor{intercept(e){var t,r=this;return(t=function*(){var t=e.request,o=Object(a.encodeURIComponentForOData)(t.url),s="GET"===t.method&&o.length>1800,u=r.applicationContext.TraceManager.getTracer(i.COMPONENT_NAMES.RemoteODataExecutor),c=e.executionContext?e.executionContext.commonEventParameters:[],l=[];l.push({name:"UrlRequestLength",value:o.length}),u.info("".concat(r.getLongRequestInterceptorPrefix()," Start Execute Remote Request "),Object(n.addEventParameters)(c,l)),s&&(t=Object(a.buildBatchRequest)([t]),u.warn("".concat(r.getLongRequestInterceptorPrefix()," Built batch request for long request"),Object(n.addEventParameters)(c,l)));var d=yield e.proceed(t);return s&&(d=(yield Object(a.parseBatchResponse)(d))[0],u.warn("".concat(r.getLongRequestInterceptorPrefix()," Parsed batch request for long request"),Object(n.addEventParameters)(c,l))),u.info("".concat(r.getLongRequestInterceptorPrefix()," Finish Execute Remote Request"),Object(n.addEventParameters)(c,l)),d},function(){var e=this,r=arguments;return new Promise((function(n,a){var i=t.apply(e,r);function o(e){s(i,n,a,o,u,"next",e)}function u(e){s(i,n,a,o,u,"throw",e)}o(void 0)}))})()}getLongRequestInterceptorPrefix(e){return"[".concat(e||i.FILE_PREFIX.LongRequestInterceptor,"]")}}},9179:function(e,t,r){"use strict";r.r(t),r.d(t,"RETRIEVE_ENTITY_ASYNC",(function(){return h})),r.d(t,"ENTITY_TYPE",(function(){return E})),r.d(t,"RETRIEVE_ENTITY_ACTION",(function(){return b})),r.d(t,"getUpdatedEntityRefCount",(function(){return T})),r.d(t,"retrieveEntity",(function(){return S})),r.d(t,"retrieveEntities",(function(){return C})),r.d(t,"retrieveEntityMetadataErrorEnd",(function(){return R}));var n=r(9180),a=r(9181),i=r(9182),o=r(9183),s=r(9184),u=r(9189),c=r(9190),l=r(9191),d=r(9192);function p(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function f(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){p(i,n,a,o,s,"next",e)}function s(e){p(i,n,a,o,s,"throw",e)}o(void 0)}))}}var h="entity.retrieve.async",m=["activityparty"];function y(e,t,r){return v.apply(this,arguments)}function v(){return(v=f((function*(e,t,r){var n=t.DataLayerConfiguration.MetadataProvider;if(!n)throw new s.ErrorStatus("No metadata provider, GCM scenario is not yet supported");try{var a=yield n.retrieveEntities(r);return e(N(a)),a}catch(i){throw e(R(Object.keys(r))),i}}))).apply(this,arguments)}function g(e,t,r,a,s){var c={},l={};for(var d in r){var p,f=void 0,h=r[d],m=Object(o.getEntityDescriptor)(e,d);if(O(d)){var y,v=T(e,d,a,s,null===(y=a.DataLayerConfiguration.GarbageCollectionProvider)||void 0===y?void 0:y.getCurrentPage());v&&(l[d]=v)}m&&m.Initialized!==n.InitState.Uninitialized&&m.Initialized!==n.InitState.Partial?(f=Object(i.getMissingAttributes)(e,d,null!==(p=null!=h?h:m.AttributeNames)&&void 0!==p?p:[])).length>0&&(c[d]=f&&f.sort().filter((e,t,r)=>r.indexOf(e)===t)):c[d]=h&&h.sort().filter((e,t,r)=>r.indexOf(e)===t)}return Object.keys(l).length>0&&t(Object(u.updateGCMetadataRefCount)(l)),c}function O(e){return-1===m.indexOf(e)}var E="entity",b="entity.retrieve";function T(e,t,r,n,a){if(!e)return null;var i;if(!a&&(a=null===(i=r.DataLayerConfiguration.GarbageCollectionProvider)||void 0===i?void 0:i.getCurrentPage(),n)){var o=r.TraceManager.getTracer("RetrieveEntity"),s="getUpdatedEntityRefCount() called without pageId, action stack is : ".concat(n.stack);o.info(s);var u=[];u.push({name:"errorString",value:s}),r.EventManager.ReportComponentSuccess("RetrieveEntity",u)}if(a&&""!==a){var d,p=Object(l.getGCEntityMetadataRefCount)(e,t),f=null==p?void 0:p.slice();return null!==(d=Object(c.addReference)(f,a))&&void 0!==d?d:null}return null}function S(e,t,r){return{type:h,execute:(n,a,i)=>f((function*(){var{dispatch:o,getState:s}=n,u={[e]:t?null:null!=r?r:[]},c=g(s(),o,u,a,i);return 0===Object.keys(c).length?_(s(),[e]):y(o,a,c)}))()}}function C(e){return{type:h,execute:(t,r,n)=>f((function*(){var{dispatch:a,getState:i}=t;try{if(!e||0===Object.keys(e).length)return Promise.resolve({});var o=g(i(),a,e,r,n);return 0===Object.keys(o).length?_(i(),Object.keys(e)):y(a,r,o)}catch(u){Object(s.convertErrorAndRethrow)(u)}}))()}}function N(e){return{type:a.GET_CLIENT_METADATA,payload:e}}function _(e,t){var r={entities:{},attributes:{}};for(var n of t)r.entities&&(r.entities[n]=Object(o.getEntityDescriptor)(e,n)),r.attributes&&(r.attributes[n]=Object(i.getAttributesForEntity)(e,n));return r}function R(e){var t={};e.forEach(e=>{t[e]={Initialized:n.InitState.Error}});var r={entities:t};return Object(d.retrieveEntityMetadata)(r)}},9180:function(e,t,r){"use strict";var n;function a(e){return e===n.Initialized||e===n.Refreshing}r.r(t),r.d(t,"InitState",(function(){return n})),r.d(t,"isDataUsable",(function(){return a})),function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized",e[e.Refreshing=3]="Refreshing",e[e.Error=4]="Error",e[e.Partial=5]="Partial"}(n||(n={}))},9181:function(e,t,r){"use strict";r.r(t),r.d(t,"RETRIEVE_GRID_DATA_ACTION",(function(){return n})),r.d(t,"RETRIEVE_ENTITY_METADATA",(function(){return a})),r.d(t,"GC_REMOVE_DATA_ACTION",(function(){return i})),r.d(t,"GET_CLIENT_METADATA",(function(){return o})),r.d(t,"RETRIEVE_LOOKUP_DATA_ACTION",(function(){return s})),r.d(t,"RETRIEVE_RECORD_DATA_ACTION",(function(){return u})),r.d(t,"REFRESH_RECORD_DATA_ACTION",(function(){return c})),r.d(t,"REMOVE_ENTITY_RECORD_ACTION",(function(){return l}));var n="retrieve.grid.data.action",a="retrieve.entity.metadata",i="gc.remove.data.action",o="get.client.metadata",s="retrieve.lookup.data.action",u="retrieve.record.data.action",c="refresh.record.data.action",l="remove.entity.record.action"},9182:function(e,t,r){"use strict";r.r(t),r.d(t,"getAttributesForEntity",(function(){return i})),r.d(t,"getUnboundAttributes",(function(){return u})),r.d(t,"getAttributeDescriptor",(function(){return c})),r.d(t,"getMissingAttributes",(function(){return o})),r.d(t,"getAttributeTypes",(function(){return l})),r.d(t,"getSelectedAttributesForEntity",(function(){return s})),r.d(t,"getPrimaryAttributeName",(function(){return p})),r.d(t,"getDependentOptionSetAttributes",(function(){return f})),r.d(t,"getEntityAttributesByType",(function(){return h})),r.d(t,"isDependentOptionSetAttribute",(function(){return m})),r.d(t,"getAttributeType",(function(){return d}));var n=r(9048),a=r(9183);function i(e,t){var r,n;return e&&null!=e&&e.metadata&&null!=e&&null!==(r=e.metadata)&&void 0!==r&&r.attributes?null==e||null===(n=e.metadata)||void 0===n?void 0:n.attributes[t]:null}function o(e,t,r){if(!r||!r.length)return[];var n=i(e,t);if(!n)return r;for(var a=[],o=0;o<r.length;o++)n[r[o]]||a.push(r[o]);return a}function s(e,t,r){var n=i(e,t);if(!n)return null;if(0===r.length)return n;var a={};return r.forEach(e=>{n.hasOwnProperty(e)&&(a[e]=n[e])}),a}function u(e,t){return i(e,t)}function c(e,t,r){var n=i(e,t);return n&&n.hasOwnProperty(r)?n[r]:null}function l(e,t,r){var n={},a=i(r,t);return a&&(e&&e.length?e.forEach(e=>{a[e]&&(n[e]=a[e].Type)}):Object.keys(a).forEach(e=>{n[e]=a[e].Type})),n}function d(e,t,r){var n=i(r,t);return n&&n[e]?n[e].Type:null}function p(e,t){var r=Object(a.getEntityDescriptor)(e,t);return r&&r.PrimaryNameAttribute?r.PrimaryNameAttribute:null}function f(e,t,r){if(!r||0===r.length)return null;var a=s(e,t,r);if(!a)return null;var i={};for(var o in a){var u=a[o];u.Type!==n.AttributeType.PickList&&u.Type!==n.AttributeType.MultiSelectPickList||!(u.ParentPicklistLogicalName||u.ChildPicklistLogicalNames&&u.ChildPicklistLogicalNames.length>0)||(i[o]=u)}return i}function h(e,t,r){var n,a={};if(null!=e&&e.metadata&&null!=e&&null!==(n=e.metadata)&&void 0!==n&&n.attributes){var i,o=null==e||null===(i=e.metadata)||void 0===i?void 0:i.attributes[t];for(var s in o)o[s].Type===r&&(a[s]=o[s])}return a}function m(e,t,r){var n=c(e,t,r);return!(!n||!(n.ParentPicklistLogicalName||n.ChildPicklistLogicalNames&&n.ChildPicklistLogicalNames.length>0))}},9183:function(e,t,r){"use strict";r.r(t),r.d(t,"getEntityLogicalNameFromSetName",(function(){return u})),r.d(t,"getEntityInitState",(function(){return s})),r.d(t,"getEntityTypeCode",(function(){return c})),r.d(t,"getEntityDescriptor",(function(){return o})),r.d(t,"getEntitiesDescriptors",(function(){return m})),r.d(t,"getEntitySetName",(function(){return l})),r.d(t,"getActivities",(function(){return d})),r.d(t,"getIsActivityFlag",(function(){return p})),r.d(t,"getIsIntersectFlag",(function(){return h})),r.d(t,"getDisplayCollectionName",(function(){return y})),r.d(t,"getDisplayName",(function(){return v})),r.d(t,"getOneToManyRelationships",(function(){return g})),r.d(t,"getManyToOneRelationships",(function(){return O})),r.d(t,"getHasStateCode",(function(){return f})),r.d(t,"getOneToManyRelationship",(function(){return E})),r.d(t,"getActivityPartyNavigationPropertyRelationship",(function(){return N})),r.d(t,"getManyToOneRelationShipByNavigationProperty",(function(){return A})),r.d(t,"getAllOneToManyRelationshipByReferencingEntity",(function(){return b})),r.d(t,"getOnetoManyRelationShipByNavigationProperty",(function(){return I})),r.d(t,"getManyToOneRelationshipByReferencedEntity",(function(){return C})),r.d(t,"getManyToOneRelationshipByNavigationProperty",(function(){return _})),r.d(t,"getManyToOneRelationship",(function(){return T})),r.d(t,"getManyToManyRelationship",(function(){return R})),r.d(t,"getRelationshipType",(function(){return P})),r.d(t,"getPrimaryIdAttribute",(function(){return F})),r.d(t,"getAttributeNamesFromEntityMetadata",(function(){return w})),r.d(t,"getPrimaryNameAttribute",(function(){return L})),r.d(t,"getManyToManyRelationships",(function(){return j})),r.d(t,"getEntityIconVectorName",(function(){return x})),r.d(t,"getRelationshipTypeByNavigationProperty",(function(){return M})),r.d(t,"getRelationShipByNavigationProperty",(function(){return D}));var n=r(9180),a=r(9055),i={systemuser:"systemusers",team:"teams"};function o(e,t){return e&&null!=e&&e.metadata&&null!=e&&e.metadata.entities?null==e?void 0:e.metadata.entities[t]:null}function s(e,t){var r=o(e,t);return r?r.Initialized:n.InitState.Uninitialized}function u(e,t){if(!e||null==e||!e.metadata||null==e||!e.metadata.entities)return null;var r=null==e?void 0:e.metadata.entities;for(var n in r)if(r[n].EntitySetName===t)return r[n].EntityLogicalName;return null}function c(e,t){var r;return null==o(e,t)?null:null===(r=o(e,t))||void 0===r?void 0:r.ObjectTypeCode}function l(e,t){var r=o(e,t);if(r&&r.EntitySetName)return r.EntitySetName;var n=i[t];return n||null}function d(e){var t=m(e),r={};for(var n in t)p(e,n)&&(r[n]=t[n]);return r}function p(e,t){var r=o(e,t);return!(!r||!r.hasOwnProperty("IsActivity"))&&r.IsActivity}function f(e,t){var r=o(e,t);return!(!r||!r.hasOwnProperty("HasStateCode"))&&r.HasStateCode}function h(e,t){var r=o(e,t);return!(!r||!r.hasOwnProperty("IsIntersect"))&&r.IsIntersect}function m(e){return e&&null!=e&&e.metadata?null==e?void 0:e.metadata.entities:null}function y(e,t){var r=o(e,t);return r&&r.DisplayCollectionName?r.DisplayCollectionName:null}function v(e,t){var r=o(e,t);return r&&r.DisplayName?r.DisplayName:null}function g(e,t){var r=o(e,t);return r&&r.OneToManyRelationships?r.OneToManyRelationships:null}function O(e,t){var r=o(e,t);return r?r.ManyToOneRelationships:null}function E(e,t,r){var n=g(e,t);return n&&n.hasOwnProperty(r)?n[r]:null}function b(e,t,r){var n=g(e,t);if(!n)return null;var a=[];for(var i in n){var o=n[i];o.ReferencedEntity===t&&o.ReferencingEntity===r&&a.push(o)}return a}function T(e,t,r){var n=o(e,t);return n&&n.ManyToOneRelationships&&n.ManyToOneRelationships.hasOwnProperty(r)?n.ManyToOneRelationships[r]:null}function S(e,t,r,n){var a=o(e,t);if(a&&a.ManyToOneRelationships)for(var i in a.ManyToOneRelationships){var s=a.ManyToOneRelationships[i];if(s.ReferencedEntity===r&&s.ReferencingAttribute===n)return s}return null}function C(e,t,r,n){var a=S(e,t,r,n);if(!a){var i=o(e,t);i&&i.ManyToOneRelationships&&i.IsActivity&&(a=S(e,"activitypointer",r,n))}return a}function N(e,t){var r=g(e,t);if(!r)return null;var n=[];for(var a in r){var i=r[a];if(i.ReferencedEntity===t&&"activityparty"===i.ReferencingEntity){if("campaignactivity"===t&&"campaignactivity_activity_parties"!==a||"bulkoperation"===t&&"bulkoperation_activity_parties"!==a)continue;n.push(i)}}return 1===n.length?n[0]:null}function _(e,t,r){var n=o(e,t);if(n&&n.ManyToOneRelationships)for(var a in n.ManyToOneRelationships){var i=n.ManyToOneRelationships[a];if(i.ReferencingEntityNavigationPropertyName===r)return i}return null}function R(e,t,r){var n=o(e,t);return n&&n.ManyToManyRelationships&&n.ManyToManyRelationships.hasOwnProperty(r)?n.ManyToManyRelationships[r]:null}function P(e,t,r){return E(e,t,r)?a.RelationshipType.OneToManyRelationship:R(e,t,r)?a.RelationshipType.ManyToManyRelationship:T(e,t,r)?a.RelationshipType.None:null}function I(e,t,r){var n=g(e,t);if(n)for(var a of Object.keys(n)){var i=n[a];if(i.ReferencedEntityNavigationPropertyName===r)return i}return null}function A(e,t,r){var n=O(e,t);if(n)for(var a of Object.keys(n)){var i=n[a];if(i.ReferencingEntityNavigationPropertyName===r)return i}return null}function D(e,t,r){var n=A(e,t,r);return n||I(e,t,r)}function M(e,t,r){return I(e,t,r)?a.RelationshipType.OneToManyRelationship:A(e,t,r)?a.RelationshipType.ManyToOneRelationship:a.RelationshipType.None}function F(e,t){return e&&null!=e&&e.metadata&&null!=e&&e.metadata.entities&&t&&null!=e&&e.metadata.entities[t]?null==e?void 0:e.metadata.entities[t].PrimaryIdAttribute:null}function w(e,t){var r=o(e,t);return r?new Set(r.AttributeNames):null}function L(e,t){var r=t?o(e,t):null;return r&&r.PrimaryNameAttribute?r.PrimaryNameAttribute:null}function j(e,t){var r=o(e,t);return r&&r.ManyToManyRelationships?r.ManyToManyRelationships:null}function x(e,t){var r=o(e,t);return r&&r.IconVectorName?r.IconVectorName:null}},9184:function(e,t,r){"use strict";r.r(t),r.d(t,"ErrorStatus",(function(){return o})),r.d(t,"convertToErrorStatus",(function(){return l})),r.d(t,"convertErrorAndRethrow",(function(){return c})),r.d(t,"isErrorStatus",(function(){return d})),r.d(t,"getNegativeErrorCodeFromErrorCode",(function(){return s})),r.d(t,"getPositiveErrorCodeFromErrorCode",(function(){return u}));var n=r(9185),a=r(9186),i=r(9083);class o{constructor(e,t,r,a,i,s,u,c,l,d,p){var f=arguments.length>11&&void 0!==arguments[11]&&arguments[11],h=arguments.length>12&&void 0!==arguments[12]?arguments[12]:-1,m=arguments.length>13&&void 0!==arguments[13]?arguments[13]:null,y=arguments.length>14?arguments[14]:void 0,v=arguments.length>15?arguments[15]:void 0,g=arguments.length>16?arguments[16]:void 0,O=arguments.length>17?arguments[17]:void 0;this.name=void 0,this.message=void 0,this.stack=void 0,this.errorCode=void 0,this.errorParameters=void 0,this.displayTitle=void 0,this.displayMessage=void 0,this.date=void 0,this._errorFault=void 0,this._details=void 0,this._exception=void 0,this._innerError=void 0,this._errorSource=void 0,this._isRequestTooLong=void 0,this.blockErrorReporting=void 0,this.faultedRequestIndex=void 0,this.faultedSnapshotId=void 0,this.clientRequestId=void 0,this.serverResponseId=void 0,this.httpStatusCode=void 0,this.retryAfter=void 0,this.errorRegion=void 0;var E=t||o.DEFAULT_ERROR_CODE,b=d,T=Object(n.createUciError)(e,E,c,l,b,p,f);return T.message||(T.message=E.toString()),T.errorParameters||(T.errorParameters=[]),u&&T.errorParameters.push({name:"ErrorDetails",value:u}),s&&T.errorParameters.push({name:"ErrorFault",value:s}),i&&T.errorParameters.push({name:"ErrorSource",value:i}),r&&T.errorParameters.push({name:"Exception",value:r.message}),p&&T.errorParameters.push({name:"ErrorStack",value:p}),T._errorSource=i,T._exception=r,T._innerError=a,T._errorFault=s,T._details=u,T.blockErrorReporting=f,T.faultedRequestIndex=h,T.faultedSnapshotId=m,T.httpStatusCode=y,T.clientRequestId=v,T.serverResponseId=g,T.retryAfter=O,o._addErrorStatusProps(T),T}static fromErrorCode(e,t){for(var r=arguments.length,n=new Array(r>2?r-2:0),a=2;a<r;a++)n[a-2]=arguments[a];var i=o._getErrorMessage(e,t,n);return new o(i,t)}static fromExistingError(e){var t=e;return t.name||(t.name=n.UCI_ERROR_NAME),void 0===t.errorCode&&(t.errorCode=o.DEFAULT_ERROR_CODE),void 0===t.blockErrorReporting&&(t.blockErrorReporting=!1),void 0===t.faultedRequestIndex&&(t.faultedRequestIndex=-1),o._addErrorStatusProps(t),t}static _addErrorStatusProps(e){var t=Object.getOwnPropertyNames(o.prototype);for(var r of t){var n=Object.getOwnPropertyDescriptor(o.prototype,r);Object.defineProperty(e,r,n)}}static createEmpty(){return new o("ErrorStatus created with no information",this.DEFAULT_ERROR_CODE)}static _getErrorMessageResourceId(e){var t=e;t<0&&(t=t+4294967295+1);var r=t.toString(16);return"Error_Message_0x".concat(r)}static _getErrorMessage(e,t){return o._getErrorMessageResourceId(t)}static toLegacyErrorStatus(e){if(!e)return null;var t=a.LegacyErrorStatus.FromMessage(e.message,null);return t.set_ErrorCode(e.errorCode),t.set_ErrorFault(e.errorFault),t.set_Exception(e.exception),t.set_Stack(e.stack),t.set_InnerError(o.toLegacyErrorStatus(e.innerError)),t.set_BlockErrorReporting(e.blockErrorReporting),t.set_isRequestTooLong(e._isRequestTooLong),t}static fromLegacyErrorStatus(e,t){if(!e)return null;var r=e.get_Stack();if(!r){var n=e.get_ErrorFault();n&&n.get_innerFault()&&(r=n.get_innerFault().get_callStack())}var a=e.get_ErrorCode(),s=e.get_Message();Object(i.IsNullOrUndefinedOrEmptyString)(s)&&null!=t&&(s=o._getErrorMessage(t,a));var u=-1;void 0!==e.get_FaultedRequestIndex&&(u=e.get_FaultedRequestIndex());var c=new o(s,a,e.get_Exception(),o.fromLegacyErrorStatus(e.get_InnerError()),e.get_ErrorSource(),e.get_ErrorFault(),r,null,null,null,r,e.get_BlockErrorReporting(),u,null,e.get_HttpStatusCode(),e.get_ClientRequestId(),e.get_ServerResponseId(),e.get_RetryAfter(),e.get_ErrorFault()?e.get_ErrorFault().get_annotations():null);return c._isRequestTooLong=e.get_isRequestTooLong(),c}get errorFault(){return this._errorFault}get details(){return this._details}get exception(){return this._exception}get innerError(){return this._innerError}get errorSource(){return this._errorSource}get localizedMessage(){if(this.message){var e=/, Error details: (.*)$/gi.exec(this.message);if(e&&e.length>1){var t=e[1];return"'"===t[0]&&"'"===t[t.length-1]?t.substring(1,t.length-1):t}}return null}containsErrorCode(e){return this.getNegativeErrorCode()===e||!!this._innerError&&this._innerError.containsErrorCode(e)}getNegativeErrorCode(){return s(this.errorCode)}}function s(e){var t=e;return e>0&&(t=~~e),t}function u(e){var t=e;return e<0&&(t=1+~e),t}function c(e){throw l(e)}function l(e){return e?e instanceof Error?o.fromExistingError(e):e:o.createEmpty()}function d(e){return e instanceof Error&&e.name===n.UCI_ERROR_NAME}o.DEFAULT_ERROR_MESSAGE_ID="Error_Message_Generic_Mobile_Client",o.DEFAULT_ERROR_CODE=0},9185:function(e,t,r){"use strict";r.r(t),r.d(t,"UCI_ERROR_NAME",(function(){return n})),r.d(t,"createUciError",(function(){return a})),r.d(t,"cloneUciError",(function(){return i})),r.d(t,"addErrorParameters",(function(){return o})),r.d(t,"isINavigationErrorStatus",(function(){return s}));var n="UciError";function a(e,t,r,a,i,o){var s=arguments.length>6&&void 0!==arguments[6]&&arguments[6],u=new Error(e);return u.name=n,u.errorCode=t,u.errorParameters=r,u.displayTitle=a,u.displayMessage=i,u.blockErrorReporting=s,o&&(u.stack=o),u}function i(e){if(!e){var t=new Error("Received blank error object");return t.name=n,t.errorCode=2147746581,t}var r=new Error(e.message);return r.name=n,r.errorCode=e.errorCode||2147746581,r.errorParameters=e.errorParameters,r.displayTitle=e.displayTitle,r.displayMessage=e.displayMessage,r.blockErrorReporting=e.blockErrorReporting,r.innerError=e.innerError,e.stack&&(r.stack=e.stack),r}function o(e,t){e&&t&&(e.errorParameters?e.errorParameters=e.errorParameters.concat(t):e.errorParameters=t)}function s(e){return e&&e.errorCode}},9186:function(e,t,r){"use strict";r.r(t),r.d(t,"LegacyErrorStatus",(function(){return s}));var n=r(9083),a=r(9187),i=r(9188),o=r(9050);class s{constructor(e){this._errorCode=0,this._errorFault=null,this._message=void 0,this._exception=void 0,this._innerError=void 0,this._errorSource=0,this._blockErrorReporting=!1,this._stack=void 0,this._faultedRequestIndex=0,this._clientRequestId=void 0,this._serverResponseId=void 0,this._httpStatusCode=0,this._retryAfter=void 0,this._isRequestTooLong=void 0,this._message=e,this._errorSource=0,this._blockErrorReporting=!1,this._isRequestTooLong=!1}get_ErrorCode(){return this._errorCode}set_ErrorCode(e){return this._errorCode=e,e}get_Message(){return this._message}set_Message(e){return this._message=e,e}get_Exception(){return this._exception}set_Exception(e){return this._exception=e,e}get_InnerError(){return this._innerError}set_InnerError(e){return this._innerError=e,e}get_ErrorFault(){return this._errorFault}set_ErrorFault(e){return this._errorFault=e,e}get_ErrorSource(){return this._errorSource}get_BlockErrorReporting(){return this._blockErrorReporting}set_BlockErrorReporting(e){return this._blockErrorReporting=e,e}get_Stack(){return this._stack}set_Stack(e){return this._stack=e,e}get_FaultedRequestIndex(){return this._faultedRequestIndex}set_FaultedRequestIndex(e){return this._faultedRequestIndex=e,e}get_ServerResponseId(){return this._serverResponseId}set_ServerResponseId(e){return this._serverResponseId=e,e}get_ClientRequestId(){return this._clientRequestId}set_ClientRequestId(e){return this._clientRequestId=e,e}get_HttpStatusCode(){return this._httpStatusCode}set_HttpStatusCode(e){return this._httpStatusCode=e,e}get_RetryAfter(){return this._retryAfter}set_RetryAfter(e){return this._retryAfter=e,e}get_isRequestTooLong(){return this._isRequestTooLong}set_isRequestTooLong(e){return this._isRequestTooLong=e,e}chainError(e){this.set_Message(this.get_Message()+"\nInner Error Message:\n"+e.get_Message()),this.set_InnerError(e)}getObjectData(){var e={};return e.errorcode=this.get_ErrorCode(),e.message=this.get_Message(),Object(n.IsNullOrUndefined)(this.get_InnerError())||(e.innererror=this.get_InnerError().getObjectData()),e}static FromMessage(e){var t="";if(!Object(n.IsNullOrUndefinedOrEmptyString)(e)){for(var r=arguments.length,a=new Array(r>1?r-1:0),o=1;o<r;o++)a[o-1]=arguments[o];t=!Object(n.IsNullOrUndefined)(a)&&a.length>0?i.String.Format(e,...a):e}return new s(t)}static fromGenericError(e){var t=Object(n.IsNullOrUndefined)(e)?s.fromErrorCode(1):s.FromMessage(e.message);return t._blockErrorReporting=e.blockErrorReporting,Object(n.IsNullOrUndefined)(e.errorCode)||(t._errorCode=e.errorCode),Object(n.IsNullOrUndefined)(e.stack)||(t._stack=e.stack),t}static fromErrorCode(e){var t=new s(Object(o.getErrorMessage)(e));return t.set_ErrorCode(e),t}static fromErrorCodeAndMessage(e,t){var r=new s("");return r.set_ErrorCode(e),r.set_Message(t),r}static fromLocalStoreError(e,t){for(var r=arguments.length,n=new Array(r>2?r-2:0),a=2;a<r;a++)n[a-2]=arguments[a];var o=new s(i.String.Format(t,...n));return o._errorCode=e,o}static isAuthenticationErrorCode(e){return e===a.CrmErrorCodes.UserWithoutRoles||e===a.CrmErrorCodes.UserWithoutPrivileges||e===a.CrmErrorCodes.BusinessUnitDisabled||e===a.CrmErrorCodes.GeneralAuthorizationErrorCode||e===a.CrmErrorCodes.PrivilegeDenied||e===a.CrmErrorCodes.NoUserPrivilege||e===a.CrmErrorCodes.UserDisabled}}},9187:function(e,t,r){"use strict";var n;function a(e){return e===n.retrieveRecordOfflineErrorCode||e===n.DataSourceOfflineErrorCode}r.r(t),r.d(t,"CrmErrorCodes",(function(){return n})),r.d(t,"isOfflineError",(function(){return a})),function(e){e[e.InvalidEntity=-2147098612]="InvalidEntity",e[e.NoUserPrivilege=-2146088112]="NoUserPrivilege",e[e.NoMinimumRequiredPrivilegesForTabletApp=-2147094001]="NoMinimumRequiredPrivilegesForTabletApp",e[e.dataSourceInitializeFailedErrorCode=-2147094e3]="dataSourceInitializeFailedErrorCode",e[e.DataSourceOfflineErrorCode=-2147093999]="DataSourceOfflineErrorCode",e[e.retrieveRecordOfflineErrorCode=-2147093997]="retrieveRecordOfflineErrorCode",e[e.cannotSaveRecordInOfflineErrorCode=-2147093996]="cannotSaveRecordInOfflineErrorCode",e[e.GeneralAuthorizationErrorCode=-2147093995]="GeneralAuthorizationErrorCode",e[e.SignOutFailed=-2147093993]="SignOutFailed",e[e.viewNotAvailableForMobileOffline=-2147093989]="viewNotAvailableForMobileOffline",e[e.DataStoreKeyNotFoundErrorCode=-2147093987]="DataStoreKeyNotFoundErrorCode",e[e.cantUpdateOnlineRecord=-2147093980]="cantUpdateOnlineRecord",e[e.cannotDeleteOnlineRecord=-2147093944]="cannotDeleteOnlineRecord",e[e.LocalDataSourceError=-2147015599]="LocalDataSourceError",e[e.unknownBadRequestError=-2147015424]="unknownBadRequestError",e[e.UnknownUnauthorizedError=-2147015423]="UnknownUnauthorizedError",e[e.unknownForbiddenError=-2147015422]="unknownForbiddenError",e[e.unknownNotFoundError=-2147015421]="unknownNotFoundError",e[e.UnknownTooManyRequestsError=-2147015420]="UnknownTooManyRequestsError",e[e.unknownInternalServerError=-2147015419]="unknownInternalServerError",e[e.unknownNotImplementedServerError=-2147015418]="unknownNotImplementedServerError",e[e.unknownBadGatewayError=-2147015417]="unknownBadGatewayError",e[e.unknownServiceUnavailableError=-2147015416]="unknownServiceUnavailableError",e[e.unknownGatewayTimeoutError=-2147015415]="unknownGatewayTimeoutError",e[e.UnknownUnexpectedGenericError=-2147015414]="UnknownUnexpectedGenericError",e[e.concurrencyVersionMismatch=-2147088254]="concurrencyVersionMismatch",e[e.concurrencyVersionNotProvided=-2147088253]="concurrencyVersionNotProvided",e[e.duplicateRecordDetected=-2147220685]="duplicateRecordDetected",e[e.ObjectDoesNotExist=-2147220969]="ObjectDoesNotExist",e[e.PrivilegeDenied=-2147220960]="PrivilegeDenied",e[e.UserDisabled=-2147220955]="UserDisabled",e[e.duplicateRecord=-2147220937]="duplicateRecord",e[e.isvAborted=-2147220891]="isvAborted",e[e.isvUnexpected=-2147220956]="isvUnexpected",e[e.BusinessUnitDisabled=-2147220692]="BusinessUnitDisabled",e[e.OrganizationDisabled=-2147180284]="OrganizationDisabled",e[e.MetadataNoMapping=-2147217919]="MetadataNoMapping",e[e.UserWithoutRoles=-2147209463]="UserWithoutRoles",e[e.UserWithoutPrivileges=-2147209460]="UserWithoutPrivileges",e[e.UserNotAssignedLicense=-2147167669]="UserNotAssignedLicense",e[e.UserDoesNotHaveAdminOnlyModePermissions=-2147180269]="UserDoesNotHaveAdminOnlyModePermissions",e[e.UserNotMemberOfOrg=-2147015328]="UserNotMemberOfOrg",e[e.crmSqlGovernorDatabaseRequestDenied=-2147180543]="crmSqlGovernorDatabaseRequestDenied",e[e.AggregateQueryRecordLimitExceeded=-2147164125]="AggregateQueryRecordLimitExceeded",e[e.InvalidFilterCriteriaForVisualization=-2147164130]="InvalidFilterCriteriaForVisualization",e[e.InsufficientColumnsInSubQuery=-2147164126]="InsufficientColumnsInSubQuery",e[e.InvalidAppModuleSiteMap=-2147155696]="InvalidAppModuleSiteMap",e[e.QueryBuilderNoAttribute=-2147217149]="QueryBuilderNoAttribute",e[e.SqlArithmeticOverflowError=-2147217098]="SqlArithmeticOverflowError",e[e.unManagedIdsAccessDenied=-2147187962]="unManagedIdsAccessDenied",e[e.invalidFetchXml=-2147220733]="invalidFetchXml",e[e.requiredFieldMissing=-2147220992]="requiredFieldMissing"}(n||(n={}))},9189:function(e,t,r){"use strict";r.r(t),r.d(t,"garbageCollectMetadata",(function(){return l})),r.d(t,"gcRemoveMetadata",(function(){return p})),r.d(t,"replaceEntityWithPlaceholder",(function(){return d})),r.d(t,"GC_REMOVE_METADATA",(function(){return u})),r.d(t,"updateGCMetadataRefCount",(function(){return f})),r.d(t,"UPDATE_GC_METADATA_REFCOUNT_ACTION",(function(){return c})),r.d(t,"GARBAGE_COLLECT_METADATA_ACTION_SYNC",(function(){return s}));var n=r(9190),a=r(9180),i=r(9183),o=r(9191),s="garbage.collect.metadata.sync",u="gc.metadata.remove",c="gc.metadata.update.refcount";function l(e){return{type:s,sync:!0,execute(t,r){var{dispatch:a,getState:i}=t,s=i(),u={},c={},l={},h=Object(o.getGCEntitiesMetadata)(s);for(var m in h){var y,v=null===(y=h[m])||void 0===y?void 0:y.slice(),g=v&&Object(n.removeReference)(v,e);g&&(0===g.length?d(s,m,u,c):l[m]=g)}var O={};((Object.keys(O).length>0||Object.keys(l).length>0)&&a(f(l,O)),Object.keys(u).length>0)&&a(p({entities:u,attributes:c}))}}}function d(e,t,r,n){var o=Object(i.getEntityDescriptor)(e,t);if(o){var s={Initialized:a.InitState.Uninitialized,EntityLogicalName:o.EntityLogicalName,IsActivity:o.IsActivity};r[t]=s,n[t]=null}}function p(e){return{type:u,payload:e}}function f(e,t){return{type:c,payload:{entities:e,ribbons:t}}}},9190:function(e,t,r){"use strict";function n(e,t){if(e||(e=[]),-1===e.indexOf(t))return e.push(t),e}function a(e,t){if(e){var r=e.indexOf(t);return-1!==r?1===e.length?[]:(e.splice(r,1),e):void 0}}r.r(t),r.d(t,"addReference",(function(){return n})),r.d(t,"removeReference",(function(){return a}))},9191:function(e,t,r){"use strict";function n(e){return e&&e.garbageCollector?e.garbageCollector.metadata:null}function a(e){var t,r=n(e);return r&&null!==(t=r.ribbons)&&void 0!==t?t:null}function i(e,t){var r=n(e);return r&&r.ribbons?r.ribbons[t]:null}function o(e){var t,r=n(e);return r&&null!==(t=r.entities)&&void 0!==t?t:null}function s(e,t){var r=n(e);return r&&r.entities?r.entities[t]:null}function u(e){return e&&e.garbageCollector?e.garbageCollector.data:null}function c(e){var t=u(e);return t&&t.entities?t.entities:null}function l(e,t,r){var n=u(e);return n&&n.entities&&n.entities[t]?n.entities[t][r]:null}function d(e){var t=u(e);return t&&t.charts?t.charts:null}function p(e){var t=u(e);return t&&t.chartData?t.chartData:null}function f(e,t,r){var n=u(e);return n&&n.charts&&n.charts[t]?n.charts[t][r]:null}function h(e,t){var r=u(e);return r&&r.chartData&&r.chartData[t]?r.chartData[t]:null}function m(e){var t=u(e);return t&&t.lists?t.lists:null}function y(e,t){var r=u(e);return r&&r.lists&&r.lists[t]?r.lists[t]:null}r.r(t),r.d(t,"getGCRibbonsMetadata",(function(){return a})),r.d(t,"getGCRibbonMetadataRefCount",(function(){return i})),r.d(t,"getGCEntitiesMetadata",(function(){return o})),r.d(t,"getGCEntityMetadataRefCount",(function(){return s})),r.d(t,"getGCEntitiesData",(function(){return c})),r.d(t,"getGCEntityRecordDataRefCount",(function(){return l})),r.d(t,"getGCChartsData",(function(){return d})),r.d(t,"getGCChartDataByStorageKey",(function(){return p})),r.d(t,"getGCChartVisualizationViewRefCount",(function(){return f})),r.d(t,"getGCChartStorageKeyRefCount",(function(){return h})),r.d(t,"getGCListsData",(function(){return m})),r.d(t,"getGCListQueryDataRefCount",(function(){return y}))},9192:function(e,t,r){"use strict";r.r(t),r.d(t,"RETRIEVE_ENTITY_METADATA",(function(){return n})),r.d(t,"retrieveEntityMetadata",(function(){return a}));var n="entityMetadata.retrieve";function a(e){return{type:n,payload:e}}},9193:function(e,t,r){"use strict";r.r(t),r.d(t,"HEADER",(function(){return n})),r.d(t,"HEADER_VALUES",(function(){return a})),r.d(t,"EXECUTION_HINTS",(function(){return i})),r.d(t,"WEB_API_URL_FRAGMENT",(function(){return o})),r.d(t,"APP_ENTITY",(function(){return s})),r.d(t,"UPLOAD_FILENAME_URL_FRAGMENT",(function(){return u}));var n={ACCEPT:"Accept",PREFER:"Prefer",AUTO_DISASSOCIATE:"AutoDisassociate",IF_MATCH:"If-match",AUTHORIZATION_HEADER:"Authorization",CONSISTENCY:"Consistency",CONTENT_LENGTH:"Content-Length",CONTENT_TYPE:"Content-Type",CONTENT_ID:"Content-Id",RETRY_AFTER:"Retry-After",MSCRM_SUPPRESS_DUPLICATION_DETECTION:"MSCRM.SuppressDuplicateDetection",MSCRM_RETURN_NOTIFICATIONS:"MSCRM.ReturnNotifications",CLIENT_REQUEST_ID:"x-ms-client-request-id",SERVER_REQUEST_ID:"x-ms-service-request-id",SESSION_ID:"x-ms-client-session-id",SOURCE_ID:"x-ms-source-id",CORRELATION_ID:"x-ms-correlation-id",MS_USER_AGENT:"x-ms-user-agent",APP_ID:"x-ms-app-id",APP_NAME:"x-ms-app-name",OBJECT_ID:"x-ms-sw-objectid",TENANT_ID:"x-ms-sw-tenantid",CLIENT_HOST:"ClientHost",MSCRM_SOLUTION_UNIQUE_NAME:"MSCRM.SolutionUniqueName",VIEW_ID_HINT:"x-ms-mdl-viewId",PAGESIZE_HINT:"x-ms-mdl-pageSize",PAGE_NUMBER_HINT:"x-ms-mdl-pageNumber",SEARCH_HINT:"x-ms-mdl-search",FILTER_HINT:"x-ms-mdl-filter",ORDERBY_HINT:"x-ms-mdl-orderby",SELECT_HINT:"x-ms-mdl-select",LINK_HINT:"x-ms-mdl-link",EXECUTION_HINT:"x-ms-mdl-execution-hints",CONTEXT_FILTER:"x-ms-mdl-contextFilter",MERGE_QUICKFIND:"x-ms-mdl-mergeQuickFind",OPERATION_INFO:"x-ms-mdl-operation-info",FILE_URL:"x-ms-mdl-fileUrl",FILE_SIZE:"x-ms-mdl-fileSize",MIME_TYPE:"x-ms-mdl-mimeType",UPSYNC_REQUEST_HINT:"x-ms-mdl-upsync-request",SUPPRESS_TRIGGERS_HINT:"x-ms-mdl-suppress-triggers"},a={APPLICATION_JSON:"application/json",TEXT_HTML:"text/html",ANNOTATIONS:'odata.include-annotations="*"',STRONG:"Strong"},i={OFFLINE:"Offline",ONLINE:"Online",OFFLINE_THEN_ONLINE:"OfflineThenOnline"},o="/api/data/v9.0/",s="appmodules",u="?x-ms-file-name="},9194:function(e,t,r){"use strict";r.r(t),r.d(t,"fromQueryState",(function(){return P})),r.d(t,"convertQueryStateToODataRequest",(function(){return I})),r.d(t,"convertToBatchRequest",(function(){return A})),r.d(t,"fromODataContract",(function(){return D})),r.d(t,"fromFunctionalOdataContract",(function(){return M})),r.d(t,"addRequestId",(function(){return F})),r.d(t,"getClientRequestId",(function(){return w})),r.d(t,"addAuthHeader",(function(){return k})),r.d(t,"isSerializedRequestSupportedOffline",(function(){return V})),r.d(t,"addAnnotationsHeader",(function(){return B})),r.d(t,"toGCMResponse",(function(){return H}));var n=r(9045),a=r(9046),i=r(9083),o=r(9195),s=r(9196),u=r(9183),c=r(9193),l=r(9231),d=r(9215),p=r(9184),f=r(9232),h=r(9224),m=r(9238),y=r(9241),v=r(9242),g=r(9087),O=r(9244),E=r(9253),b=["OtherMetadata"];function T(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function S(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function C(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?S(Object(r),!0).forEach((function(t){N(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):S(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function N(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function R(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){_(i,n,a,o,s,"next",e)}function s(e){_(i,n,a,o,s,"throw",e)}o(void 0)}))}}function P(e){return{type:"odatabuilder.fromquerystate.async",execute:(t,r)=>R((function*(){var{getState:i}=t,s=r.TraceManager.getTracer(o.MDL_COMPONENT_NAMES.ODataBuilder);s.info("".concat(G()," Create a SerializedRequest from Query State."));var l=e.viewId&&a.Guid.toString(e.viewId),d=Object(u.getEntitySetName)(i(),e.entityLogicalName);if(!d)throw new p.ErrorStatus("unable to send query without entity set name. Key: ".concat(e.key));var f=e.fetchXml?encodeURIComponent(e.fetchXml):"",h={urlParameters:"".concat(d,"?fetchXml=").concat(f),additionalHeaders:{[c.HEADER.PREFER]:c.HEADER_VALUES.ANNOTATIONS,[c.HEADER.ACCEPT]:c.HEADER_VALUES.APPLICATION_JSON,[c.HEADER.SOURCE_ID]:null!=l?l:n.UNKNOWN},method:"GET"};return function(e,t,r){e&&e.additionalHeaders&&(t.viewId&&(e.additionalHeaders[c.HEADER.VIEW_ID_HINT]=a.Guid.toString(t.viewId)),t.pageSize&&(e.additionalHeaders[c.HEADER.PAGESIZE_HINT]=t.pageSize.toFixed()),t.pageNumber&&(e.additionalHeaders[c.HEADER.PAGE_NUMBER_HINT]=t.pageNumber.toFixed()),t.searchString&&(e.additionalHeaders[c.HEADER.SEARCH_HINT]=t.searchString),t.wheres&&t.wheres.length>0&&(e.additionalHeaders[c.HEADER.FILTER_HINT]=t.wheres.toString()),t.sorts&&t.sorts.length>0&&(e.additionalHeaders[c.HEADER.ORDERBY_HINT]=t.sorts.toString()),t.selects&&t.selects.length>0&&(e.additionalHeaders[c.HEADER.SELECT_HINT]=t.selects.toString()),t.linkEntities&&t.linkEntities.length>0&&(e.additionalHeaders[c.HEADER.LINK_HINT]=t.linkEntities.toString()))}(h,e),L(i(),r,h)}))()}}function I(e,t,r){var n=t.entityLogicalName,a=function(e,t,r){var n={};e===o.ODataRequestType.RetrieveWithUrlParams&&t.selects&&t.selects.length>0&&!t.isAllColumns&&(n.select=t.selects.toString());e===o.ODataRequestType.RetrieveWithUrlParams&&t.sorts&&t.sorts.length>0&&(n.orderby=t.sorts.toString());if(t.expression)try{n.filter=f.Expression.getHintFromExpression(t.expression,f.QueryOptionsFormat.ODataUri)}catch(i){null==r||r.error("".concat(G()," Failed to add Filter hint with error: ").concat(null==i?void 0:i.message,"."))}var a=Object.keys(n).map(e=>"$".concat(e,"=").concat(n[e])).join("&");return"?".concat(a)}(e,t);if(e===o.ODataRequestType.RetrieveWithUrlParams)return new d.ODataRetrieveWithUrlParamsRequest(n,void 0,a);if(e===o.ODataRequestType.Update)return new d.ODataUpdateRequest(n,void 0,r,a);if(e===o.ODataRequestType.DeleteWithUrlParams)return new d.ODataDeleteWithUrlParamsRequest(n,void 0,a);throw new Error("ConvertQueryStateToODataRequest cannot handle request type ".concat(e))}function A(e,t){var r=Object(l.buildBatchRequest)([t],e);return r.additionalHeaders=C(C({},t.additionalHeaders),r.additionalHeaders),U(e,r),r}function D(e){return{type:"odatabuilder.fromodatacontract.async",execute:(t,r)=>R((function*(){var{getState:n,dispatch:a}=t;r.TraceManager.getTracer(o.MDL_COMPONENT_NAMES.ODataBuilder).info("".concat(G()," Create a SerializedRequest from OData Contract."));var i,u,c=n();return i="ExecuteMultiple"===e.getMetadata().operationName?yield a((u=e,{type:"odatabuilder.fromexecutemutipleodatacontract.async",execute:(e,t)=>R((function*(){var{dispatch:r}=e,n=u.requests.map(function(){var e=R((function*(e){if(Object(s.isODataContract)(e))return yield r(D(e));if(Object(s.isChangeSet)(e))return yield Promise.all(e.map(function(){var e=R((function*(e){return yield r(D(e))}));return function(t){return e.apply(this,arguments)}}()));throw Error("value should be of type OData contract or Changeset")}));return function(t){return e.apply(this,arguments)}}()),a=yield Promise.all(n);return Object(l.buildBatchRequest)(a,t)}))()})):Object(s.buildRequest)(c,e),L(c,r,i)}))()}}function M(e,t){return{type:"odatabuilder.fromfunctionalodatacontract.async",execute(r,n){var{getState:a}=r;n.TraceManager.getTracer(o.MDL_COMPONENT_NAMES.ODataBuilder).info("".concat(G()," Create a SerializedRequest from a functional OData Contract."));var i=Object(h.buildFunctionRequest)(a(),e);return Promise.resolve(L(a(),n,i,t))}}}function F(e,t){null!=e&&null!=t&&(null==e.additionalHeaders||e.additionalHeaders.hasOwnProperty(c.HEADER.CLIENT_REQUEST_ID)||(e.additionalHeaders[c.HEADER.CLIENT_REQUEST_ID]=t))}function w(e){var t;return(null==e||null===(t=e.additionalHeaders)||void 0===t?void 0:t[c.HEADER.CLIENT_REQUEST_ID])||n.UNKNOWN}function L(e,t,r,n){return j.apply(this,arguments)}function j(){return(j=R((function*(e,t,r,o){var s,u;Object(i.IsNullOrUndefined)(r.additionalHeaders)&&(r.additionalHeaders={}),yield k(t,r),r&&r.additionalHeaders&&!r.additionalHeaders.hasOwnProperty(c.HEADER.CONTENT_TYPE)&&(r.additionalHeaders[c.HEADER.CONTENT_TYPE]=c.HEADER_VALUES.APPLICATION_JSON),B(r);var l=Object(m.getCurrentAppId)(e);r&&r.additionalHeaders&&!r.additionalHeaders.hasOwnProperty(c.HEADER.APP_ID)&&(r.additionalHeaders[c.HEADER.APP_ID]=null!=l?l:"");var d=Object(m.getCurrentAppUniqueNameOrDefault)(e);if(r&&r.additionalHeaders&&!r.additionalHeaders.hasOwnProperty(c.HEADER.APP_NAME)&&(r.additionalHeaders[c.HEADER.APP_NAME]=null!=d?d:""),t.DataLayerConfiguration.useConsistencyStrong&&(r.additionalHeaders[c.HEADER.CONSISTENCY]=c.HEADER_VALUES.STRONG),r&&r.additionalHeaders&&!r.additionalHeaders.hasOwnProperty(c.HEADER.CLIENT_REQUEST_ID)){var p=n.UNKNOWN;p=o&&o.RequestId()?o.RequestId():a.Guid.newGuid().guid,r.additionalHeaders[c.HEADER.CLIENT_REQUEST_ID]=p}var f={[c.HEADER.SESSION_ID]:t.EventManager.getCurrentSessionId(),[c.HEADER.CORRELATION_ID]:t.EventManager.getActivityId()};Object.assign(r.additionalHeaders,f);var h=null==t||null===(s=t.DataLayerConfiguration.AuthenticationProvider)||void 0===s?void 0:s.getUserObjectId();r&&r.additionalHeaders&&!r.additionalHeaders.hasOwnProperty(c.HEADER.OBJECT_ID)&&(r.additionalHeaders[c.HEADER.OBJECT_ID]=null!=h?h:"");var y=null==t||null===(u=t.DataLayerConfiguration.AuthenticationProvider)||void 0===u?void 0:u.getTenantId();r&&r.additionalHeaders&&!r.additionalHeaders.hasOwnProperty(c.HEADER.OBJECT_ID)&&(r.additionalHeaders[c.HEADER.TENANT_ID]=null!=y?y:"");var v=x(e,d);return r&&r.additionalHeaders&&!r.additionalHeaders.hasOwnProperty(c.HEADER.MS_USER_AGENT)&&(r.additionalHeaders[c.HEADER.MS_USER_AGENT]=v),U(t,r),r}))).apply(this,arguments)}function x(e,t){var r=Object(y.getClientHost)(e),n=Object(y.getClientHostName)(e),a=r===v.ClientHost.Browser?n:"".concat(n," - ").concat(Object(y.getClientHostSubtypeNameForTelemetry)(e)," - ").concat(Object(y.getClientHostVersionString)(e));return"PowerApps-UCI/".concat(window.VERSION_NUMERIC_VALUE," (").concat(a,"; AppName=").concat(t,")")}function U(e,t){if(!Object(i.IsNullOrUndefined)(t.urlParameters)){var r=t.endpoint||c.WEB_API_URL_FRAGMENT,n=e.DataLayerConfiguration.baseUri.replace(/\/$/,"");t.urlParameters="".concat(n).concat(r).concat(t.urlParameters),t.urlParameters=t.urlParameters.replace(/\t|\r|\n/g,"")}return t}function k(e,t){return q.apply(this,arguments)}function q(){return(q=R((function*(e,t){var r,n,a=yield null===(r=e.DataLayerConfiguration)||void 0===r||null===(n=r.AuthenticationProvider)||void 0===n?void 0:n.getAuthToken();if(a&&t&&t.additionalHeaders){var i="Bearer "+a;t.additionalHeaders[c.HEADER.AUTHORIZATION_HEADER]=i}return t}))).apply(this,arguments)}function V(e,t){if(t.urlParameters&&t.urlParameters.includes("$batch"))return!0;var r=Object(E.getEntityNameFromRequest)(e,t);return r&&Object(O.isEntityAvailableForOfflineUsage)(e,r)}function B(e){void 0!==e.additionalHeaders&&null!==e.additionalHeaders||(e.additionalHeaders={}),e.additionalHeaders.hasOwnProperty(c.HEADER.PREFER)?e.additionalHeaders[c.HEADER.PREFER].indexOf("odata.include-annotations=")<0?e.additionalHeaders[c.HEADER.PREFER]="".concat(e.additionalHeaders[c.HEADER.PREFER],",").concat(c.HEADER_VALUES.ANNOTATIONS):e.additionalHeaders[c.HEADER.PREFER]=e.additionalHeaders[c.HEADER.PREFER].replace(/odata\.include-annotations="[^"]+"/,c.HEADER_VALUES.ANNOTATIONS):e.additionalHeaders[c.HEADER.PREFER]=c.HEADER_VALUES.ANNOTATIONS}function H(e,t,r,n){return{type:"odatabuilder.togcmresponse.async",execute:(a,i)=>R((function*(){var{getState:i}=a,o=yield Object(g.parseJsonResponse)(e,n,r);return o.Metadata?function(e,t,r){if(r&&r.AppendCallStack("OdataBuilder.parseGetClientMetadataResponse"),t)return e&&e.OtherMetadata?function(e,t){t&&t.AppendCallStack("OdataBuilder.parseGetClientMetadataExResponse");var{OtherMetadata:r}=e,n=T(e,b),a=JSON.parse(e.OtherMetadata);if(Object.assign(n,a),n.Entities){var i=[];n.Entities.forEach(e=>{var t=C(C({},e.EntityMetadata),e.AttributeNames);i.push(t)}),n.Entities=i}if(n.RelationshipNavigationEntities){var o=[];n.RelationshipNavigationEntities.forEach(e=>{var t=C(C({},e.EntityMetadata),e.AttributeNames);o.push(t)}),n.RelationshipNavigationEntities=o}return n}(e,r):[];return JSON.parse(e)}(o.Metadata,t,r):o}))()}}function G(e){return"[".concat(e||o.PREFIX.ODataBuilder,"]")}},9195:function(e,t,r){"use strict";r.r(t),r.d(t,"MDL_ID",(function(){return a})),r.d(t,"MDL_COMPONENT_NAMES",(function(){return i})),r.d(t,"PREFIX",(function(){return o})),r.d(t,"RETRIEVE_GRID_DATA",(function(){return s})),r.d(t,"ODataRequestType",(function(){return n}));var n,a="ModernDataLayer",i={ODataBuilder:"".concat(a,".ODataBuilder"),ModernDataSource:"".concat(a,".ModernDataSource"),ExpressionRuntime:"".concat(a,".ExpressionRuntime"),QueryBuilder:"".concat(a,".QueryBuilder"),UserContext:"".concat(a,".UserContext"),AuthenticationProvider:"".concat(a,".AuthenticationProvider"),ModernDataSourceGCM:"".concat(a,".ModernDataSourceGCM")},o={ODataBuilder:"ODataBuilder",ModernDataSource:"ModernDataSource",ExpressionRuntimeHost:"ExpressionRuntimeHost",ModernQueryBuilder:"ModernQueryBuilder"},s="RetrieveGridData";!function(e){e.Create="Create",e.Update="Update",e.Delete="Delete",e.DeleteWithUrlParams="DeleteWithUrlParams",e.Retrieve="Retrieve",e.RetrieveWithUrlParams="RetrieveWithUrlParams"}(n||(n={}))},9196:function(e,t,r){"use strict";r.r(t),r.d(t,"executeMultiple",(function(){return h})),r.d(t,"buildRequest",(function(){return m})),r.d(t,"isChangeSet",(function(){return v})),r.d(t,"isODataContract",(function(){return y}));var n=r(9080),a=r(9087),i=r(9197),o=r(9213),s=r(9214),u=r(9215),c=r(9216),l=r(9219),d=r(9222),p=r(9224);function f(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function h(e){return{type:"executeOData.batch.async",execute(t){return(r=function*(){var{dispatch:r}=t,n=new u.ODataExecuteMultipleRequest(e),i=yield r(Object(a.execute)(n));return Object(c.parseBatchResponse)(i)},function(){var e=this,t=arguments;return new Promise((function(n,a){var i=r.apply(e,t);function o(e){f(i,n,a,o,s,"next",e)}function s(e){f(i,n,a,o,s,"throw",e)}o(void 0)}))})();var r}}}function m(e,t){if(!t)return{serializationFailure:"Cannot build the serialized request: the request object is empty"};if(!t.getMetadata())return{serializationFailure:"Cannot build the serialized request: the request object does not contain metadata definition"};switch(t.getMetadata().operationType){case s.ODataOperationType.Function:return Object(p.buildFunctionRequest)(e,t);case s.ODataOperationType.CRUD:return function(e,t){switch(t.getMetadata().operationName){case"Create":var r=t;return Object(i.buildCreateRequest)(e,r.etn,r.payload,r.suppressDupeDetection,r.returnRowVersion,r.solutionUniqueName);case"RetrieveWithUrlParams":var a=t;return Object(l.buildRetrieveRequestWithURLParams)(e,a.etn,a.id,a.urlParams,a.maxPageSize,a.headers);case"Update":var s=t;return Object(d.buildUpdateRequest)(e,s.etn,s.id,s.payload,s.suppressDupeDetection,null,!1,s.urlParams,s.headers,s.isBinaryPayload);case"Delete":var u=t,c=n.EntityReference.fromExternalEntityReference(u.entityReference);return Object(o.buildDeleteRequest)(e,c,null,u.attributeName);default:return{serializationFailure:"Cannot convert ODataContract with ".concat(t.getMetadata().operationName," operation into a serialized request")}}}(e,t);default:return{serializationFailure:"Cannot build the serialized request: the operation type is not supported"}}}function y(e){return e&&e.getMetadata}function v(e){return e&&Array.isArray(e)&&e.length>0&&e[0].getMetadata}},9197:function(e,t,r){"use strict";r.r(t),r.d(t,"buildCreateRequest",(function(){return c})),r.d(t,"requestAdditionalMetadataForEntityRecord",(function(){return l})),r.d(t,"RETRIEVE_ROW_VERSION_HEADER",(function(){return u}));var n=r(9179),a=r(9198),i=r(9183),o=r(9193);function s(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}var u="ReturnRowVersion";function c(e,t,r){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=arguments.length>4?arguments[4]:void 0,s=arguments.length>5?arguments[5]:void 0,c=Object(i.getEntitySetName)(e,t),l={urlParameters:"".concat(c),body:JSON.stringify(r),additionalHeaders:{[o.HEADER.ACCEPT]:o.HEADER_VALUES.APPLICATION_JSON,[o.HEADER.MSCRM_SUPPRESS_DUPLICATION_DETECTION]:n.toString()},method:"POST"};return l&&l.additionalHeaders&&a&&(l.additionalHeaders[u]="true"),l&&l.additionalHeaders&&s&&(l.additionalHeaders[o.HEADER.MSCRM_SOLUTION_UNIQUE_NAME]=s),l}function l(e){return{type:"REQUEST_ADDITIONAL_METADATA_FOR_ENTITY_RECORD",execute(t,r){return(i=function*(){var{dispatch:r,getState:i}=t,o=Object(a.getRelatedEntityLogicalNames)(i(),e).reduce((e,t)=>(e[t]=[],e),{});o[e.get_identifier().LogicalName]=Object(a.getAttributeNamesWithNoMetadata)(i(),e),yield r(Object(n.retrieveEntities)(o))},function(){var e=this,t=arguments;return new Promise((function(r,n){var a=i.apply(e,t);function o(e){s(a,r,n,o,u,"next",e)}function u(e){s(a,r,n,o,u,"throw",e)}o(void 0)}))})();var i}}}},9198:function(e,t,r){"use strict";r.r(t),r.d(t,"getData",(function(){return g})),r.d(t,"getEntityRecords",(function(){return O})),r.d(t,"getEntityRecordById",(function(){return E})),r.d(t,"getListPageRecordIds",(function(){return D})),r.d(t,"createRecordSelector",(function(){return S})),r.d(t,"getCurrentBusinessProcessFlowId",(function(){return R})),r.d(t,"getCurrentBusinessProcessFlowInstanceId",(function(){return P})),r.d(t,"getRecordInitState",(function(){return C})),r.d(t,"getFieldValue",(function(){return N})),r.d(t,"getListPageRecords",(function(){return F})),r.d(t,"getList",(function(){return I})),r.d(t,"getListInitializedState",(function(){return A})),r.d(t,"getPagingCookie",(function(){return L})),r.d(t,"getListTotalRecordsCount",(function(){return w})),r.d(t,"getLegacyValueForField",(function(){return q})),r.d(t,"getListPageSize",(function(){return V})),r.d(t,"getAttributeNamesWithNoMetadata",(function(){return B})),r.d(t,"getRelatedEntityLogicalNames",(function(){return H})),r.d(t,"isEmptyField",(function(){return U})),r.d(t,"getRelatedEntityRecordsByNavigationProperty",(function(){return b})),r.d(t,"getRelatedEntityRecordByNavigationProperty",(function(){return T})),r.d(t,"getFormattedFieldValue",(function(){return _})),r.d(t,"FieldValueRetrievalBehavior",(function(){return n}));var n,a=r(9048),i=r(9055),o=r(9046),s=r(9069),u=r(9080),c=r(9180),l=r(9083),d=r(9199),p=r(9200),f=r(9207),h=r(9209),m=r(9211),y=r(9182),v=r(9183);function g(e){return e?e.data:null}function O(e,t){var r=g(e);return r&&r.entities&&r.entities.hasOwnProperty(t)?r.entities[t]:null}function E(e,t,r){var n=O(e,t);return n?n[r]:null}function b(e,t,r){var n=E(e,t.etn,o.Guid.toString(t.id));if(n&&n.fields&&n.fields.hasOwnProperty(r)){var a=n.fields[r];if(a)return a.list}return null}function T(e,t,r,n){var a=b(e,t,r);if(a){var o=Object(v.getRelationshipTypeByNavigationProperty)(e,t.etn,r);if(o===i.RelationshipType.OneToManyRelationship){for(var s of a)if(s&&s.fields){var u=s.fields.hasOwnProperty("regardingfieldname")?s.fields.regardingfieldname:null;if(n===Object(m.getFormattedValueFromField)(u))return s}}else if(o===i.RelationshipType.ManyToOneRelationship)return a[0]}return null}function S(e){return t=>{var r=O(t,e.etn);if(r){var n=o.Guid.toString(e.id);if(r.hasOwnProperty(n))return r[n]}return null}}function C(e,t){if(S(t)){var r,n=null===(r=S(t))||void 0===r?void 0:r(e,t.etn);return n&&n.hasOwnProperty("initialized")?n.initialized:null}return null}function N(e,t,r){if(t&&S(t)){var n,a=null===(n=S(t))||void 0===n?void 0:n(e,t.etn);if(a&&a.fields){if(a.fields.hasOwnProperty(r))return a.fields[r];if("productidname"===r&&-1!==["opportunityproduct","quotedetail","salesorderdetail","invoicedetail"].indexOf(t.etn)){var i=a.fields.productid;if(i){var o=i.reference;if(o&&o.hasOwnProperty("name"))return o.name}}}}return null}function _(e,t,r){return{value:e,timestamp:t||new Date,validationResult:r||{isValueValid:!0,errorMessage:null,errorId:null,userInput:""}}}function R(e,t){if(S(t)){var r,n=null===(r=S(t))||void 0===r?void 0:r(e,t.etn);if(n&&n.businessProcessFlowId)return n.businessProcessFlowId}return null}function P(e,t){if(S(t)){var r,n=null===(r=S(t))||void 0===r?void 0:r(e,t.etn);if(n&&n.businessProcessFlowInstanceId)return n.businessProcessFlowInstanceId}return null}function I(e,t){var r=g(e);return r&&r.lists&&r.lists.hasOwnProperty(t)?r.lists[t]:null}function A(e,t){var r=I(e,t);return r?r.initialized:c.InitState.Uninitialized}function D(e,t,r,n){var a=I(e,t);if(a){if(n)return a.records;if(a.pages&&r&&r>0){var i=a.pages[r];if(i&&a.records)return a.records.slice(i.startIndex,i.startIndex+a.pageSize)}}return null}function M(e,t,r,n){var a={initialized:t.initialized,identifier:r,fields:{}};if(t&&a&&a.fields)if(n&&n.length)for(var i of n){var o;a.fields[i]=null===(o=t.fields)||void 0===o?void 0:o[i]}else a.fields=t.fields;return a}function F(e,t,r,n,a){var i=D(e,t,r,a),o=[];if(!i)return null;for(var s of i){var u=S(s);if(u){var c=u(e,s.etn);if(c){var l=M(0,c,s,n);o.push(l)}}}return o}function w(e,t){var r=I(e,t);return r?r.totalRecordCount:null}function L(e,t,r){var n=I(e,t);return n&&n.pages&&n.pages[r]&&n.pages[r].pagingCookie?n.pages[r].pagingCookie:null}function j(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.LatestEntered;return t===n.LastValid?e.value:e.validationResult.userInput||e.value}function x(e){return Object(m.isPicklistValue)(e)?!e.valueString:Object(m.isGuidValue)(e)?o.Guid.isNullOrEmpty(e.id):Object(m.isReferenceValue)(e)?!e.reference:Object(m.isPlainValue)(e)?!e.value:Object(m.isAliasedValue)(e)?x(e.innerValue):!!Object(m.isPartylistValue)(e)&&!e.list}function U(e,t,r,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:n.LatestEntered;if(!e)return!0;if(Object(m.isAliasedValue)(e))return U(e.innerValue,t,r,i,o);var s=Object(y.getAttributeDescriptor)(t,r,i);if(!s||!s.Type)return x(e);var u=!1,c=s.Type;switch(c){case a.AttributeType.PartyList:var d=e;d&&d.list&&d.list.length>0&&(u=!0);break;case a.AttributeType.Boolean:var p=e;!p||"1"!==p.valueString&&"0"!==p.valueString||(u=!0);break;case a.AttributeType.PickList:case a.AttributeType.State:case a.AttributeType.Status:var f=e;f&&"-1"!==f.valueString&&!Object(l.IsNullOrUndefinedOrEmptyString)(f.valueString)&&(u=!0);break;case a.AttributeType.MultiSelectPickList:var h=j(e,o);-1===h||Object(l.IsNullOrUndefinedOrEmptyString)(h)||(u=!0);break;case a.AttributeType.Customer:case a.AttributeType.Lookup:case a.AttributeType.Owner:var v=e;v&&!Object(l.IsNullOrUndefinedOrEmptyString)(v.reference)&&(u=!0);break;case a.AttributeType.UniqueIdentifier:var g=e;g&&!Object(l.IsNullOrUndefinedOrEmptyString)(g.id)&&(u=!0);break;case a.AttributeType.Date:case a.AttributeType.DateTime:case a.AttributeType.Decimal:case a.AttributeType.Double:case a.AttributeType.Integer:case a.AttributeType.String:case a.AttributeType.BigInt:case a.AttributeType.Unknown:case a.AttributeType.Memo:case a.AttributeType.Money:case a.AttributeType.CalendarRules:case a.AttributeType.Virtual:default:var O=j(e,o);Object(l.IsNullOrUndefinedOrEmptyString)(O)||(u=!0)}return!u}function k(e,t,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n.LatestEntered;switch(r){case a.AttributeType.PartyList:var c=[],l=t;for(var f of l.list){var v={},g={},O={},E={};for(var b in f.fields){var T=f.fields[b],S=q(e,"activityparty",b,T);if(S){v[b]=S;var C=Object(y.getAttributeDescriptor)(e,"activityparty",b);if(C&&(g[b]=C.Type,Object(m.isPlainValue)(T))){var N=T;O[b]=N.formatted||null,E[b]=N.formatted||null}}}var _=new p.EntityRecord(u.EntityReference.toLegacyEntityReference(f.identifier),v,g,O,E,new h.RelatedEntityCollection([]));c.push(_)}return new d.EntityCollection(c,!1,c.length,!1,null,null);case a.AttributeType.Date:case a.AttributeType.DateTime:var R=j(t,i),P=Date.parse(R);return isNaN(P)?R:new Date(P);case a.AttributeType.PickList:case a.AttributeType.Boolean:case a.AttributeType.State:case a.AttributeType.Status:var I=t,A=I?I.label:null,D=I?parseInt(I.valueString,10):null;return D&&isNaN(D)&&(D=null),new s.OptionMetadata(A,D,-1,-1,[],null,null);case a.AttributeType.Customer:case a.AttributeType.Lookup:case a.AttributeType.Owner:var M=t;return M&&M.reference?u.EntityReference.toLegacyEntityReference(M.reference):null;case a.AttributeType.UniqueIdentifier:var F=t;return o.Guid.toLegacyGuid(F.id);case a.AttributeType.MultiSelectPickList:var w=j(t,i);return-1===w||null===w||!Array.isArray(w)&&"string"!=typeof w?null:Array.isArray(w)?w:w.split(",").map(e=>parseInt(e,10));case a.AttributeType.Decimal:case a.AttributeType.Double:case a.AttributeType.Integer:case a.AttributeType.String:case a.AttributeType.BigInt:case a.AttributeType.Unknown:case a.AttributeType.Memo:case a.AttributeType.Money:case a.AttributeType.CalendarRules:case a.AttributeType.Virtual:default:return j(t,i)}}function q(e,t,r,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:n.LatestEntered;if(Object(m.isAliasedValue)(i)){var s=new f.LegacyAliasedValue(i.entityLogicalName,i.attributeLogicalName,a.AttributeType.AliasedValue);return i.innerType===a.AttributeType.Integer?s.set_value(k(e,i.innerValue,a.AttributeType.Integer,o)):s.set_value(q(e,i.entityLogicalName,i.attributeLogicalName,i.innerValue)),s}var u=Object(y.getAttributeDescriptor)(e,t,r);if(!u||!u.Type)return null;var c=u.Type;return i?k(e,i,c,o):c===a.AttributeType.PartyList?new d.EntityCollection([],!1,0,!1):null}function V(e,t){var r=I(e,t);return r&&r.pageSize?r.pageSize:null}function B(e,t){var r=t.get_identifier(),n=Object(y.getAttributesForEntity)(e,r.LogicalName);if(n){var a=Object.keys(n);return t.get_fieldNames().filter(e=>a&&-1===a.indexOf(e))}return t.get_fieldNames()}function H(e,t){var r=t.get_identifier(),n=t.get_fieldNames(),i=Object(y.getAttributesForEntity)(e,r.LogicalName),o=new Set;for(var s of n){var u=i[s];if(!u)throw new Error("The metadata for ".concat(s," attribute is missing in the state tree."));if(u.Type===a.AttributeType.PartyList){var c=t.getValue(s).get_entities();for(var l of c)o.add(l.get_identifier().LogicalName)}if(u.Type===a.AttributeType.Lookup||u.Type===a.AttributeType.Customer||u.Type===a.AttributeType.Owner){var d=t.getValue(s);d&&d.LogicalName&&o.add(d.LogicalName)}}return Array.from(o)}!function(e){e[e.LatestEntered=0]="LatestEntered",e[e.LastValid=1]="LastValid"}(n||(n={}))},9199:function(e,t,r){"use strict";r.r(t),r.d(t,"EntityCollection",(function(){return s}));var n=r(9200),a=r(9083),i=r(9204),o=r(9082);class s{constructor(e,t,r,n,a,i){if(this._entities=void 0,this._moreRecords=!1,this._totalRecordCount=0,this._totalRecordCountLimitExceeded=!1,this._query=void 0,this._clientRetrieveOptions=void 0,Object(o.throwOnNullOrUndefinedArgument)(e,"entities"),this._moreRecords=t,this._totalRecordCount=r,this._totalRecordCountLimitExceeded=n,this._entities=e,this._query=a,i){var s,u,c=null===(s=this._entities)||void 0===s||null===(u=s[0])||void 0===u?void 0:u.get_clientRetrieveOptions();c&&this.set_clientRetrieveOptions(c)}}get_entities(){return this._entities}get_moreRecords(){return this._moreRecords}get_totalRecordCountLimitExceeded(){return this._totalRecordCountLimitExceeded}get_totalRecordCount(){return this._totalRecordCount}get_count(){return this.get_entities().length}get_query(){return this._query}set_query(e){this._query=e}get_key(){return!Object(a.IsNullOrUndefined)(this._query)&&this._query.get_key?this._query.get_key():""}get_clientRetrieveOptions(){return this._clientRetrieveOptions}set_clientRetrieveOptions(e){if(this._clientRetrieveOptions=e,!Object(a.IsNullOrUndefined)(this._clientRetrieveOptions))for(var t=0;t<this._entities.length;t++)Object(a.IsNullOrUndefined)(this._entities[t].get_clientRetrieveOptions())&&this._entities[t].set_clientRetrieveOptions(this._clientRetrieveOptions)}get_item(e){return this.get_entities()[e]}getObjectData(){for(var e={},t=new Array(this.get_entities().length),r=0;r<this.get_entities().length;r++)t[r]=this.get_entities()[r].getObjectData();return e.entities=t,e.morerecords=this._moreRecords,e.totalrecordcount=this._totalRecordCount,e.totalRecordCountLimitExceeded=this._totalRecordCountLimitExceeded,Object(a.IsNullOrUndefined)(this._clientRetrieveOptions)||(e.clientretrieveoptions=this._clientRetrieveOptions.getObjectData()),e}add(e){this._entities.push(e)}static createFromObjectData(e){for(var t=new Array(0),r=e.entities,a=0;a<r.length;a++)t[a]=n.EntityRecord.createFromObjectData(r[a]);var o=e.morerecords,u=e.totalrecordcount,c="totalRecordCountLimitExceeded"in e&&e.totalRecordCountLimitExceeded,l="clientretrieveoptions"in e?i.ClientRetrieveOptions.createFromObjectData(e.clientretrieveoptions):null;return new s(t,o,u,c,null,l)}}s.__typeName="Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.EntityCollection"},9200:function(e,t,r){"use strict";r.r(t),r.d(t,"EntityRecord",(function(){return O}));var n=r(9048),a=r(9049),i=r(9080),o=r(9083),s=r(9182),u=r(9198),c=r(9201),l=r(9082),d=r(9202),p=r(9203),f=r(9204),h=r(9199),m=r(9207),y=r(9081),v=r(9208),g=r(9209);class O{constructor(e,t,r,n,a,i,s,u){this._identifier=void 0,this._actionableIdentifier=void 0,this._fields=void 0,this._formattedValues=void 0,this._numericFormattedValues=void 0,this._relatedEntities=void 0,this._changedFieldNames=void 0,this._cleanFields=void 0,this._fieldTypes=void 0,this._columnSet=void 0,this._clientRetrieveOptions=void 0,this._accessRights=0,this._userSharedAttributePrivileges=void 0,this._entityRecordForProcess=void 0,this._globalNavigationData=void 0,e instanceof O?(t=e._fields,r=e._fieldTypes,n=e._formattedValues,a=e._numericFormattedValues,i=e._relatedEntities,u=e._clientRetrieveOptions,this._identifier=e._identifier):this._identifier=e,Object(l.throwOnNullOrUndefinedArgument)(this._identifier,"identifier"),Object(l.throwOnNullOrUndefinedArgument)(t,"fields"),Object(l.throwOnNullOrUndefinedArgument)(r,"fieldTypes"),Object(l.throwOnNullOrUndefinedArgument)(n,"formattedValues"),Object(l.throwOnNullOrUndefinedArgument)(a,"numericFormattedValues"),Object(l.throwOnNullOrUndefinedArgument)(i,"relatedEntities"),this._fields=t,this._fieldTypes=r,this._formattedValues=n,this._numericFormattedValues=a,this._relatedEntities=i,this._columnSet=Object(o.IsNullOrUndefined)(s)?new p.LegacyColumnSet(new Array(0)):s,this.updateColumnSet(this.get_fieldNames()),this._changedFieldNames=[],this._cleanFields={},this._clientRetrieveOptions=u,this._accessRights=0;var c=this.getValue("activitytypecode");"activitypointer"===this._identifier.LogicalName&&c?this._actionableIdentifier=new y.LegacyEntityReference(c,this._identifier.Id):this._actionableIdentifier=this._identifier,this._userSharedAttributePrivileges={}}get fields(){return this._fields}get_identifier(){return this._identifier}get_actionableIdentifier(){return this._actionableIdentifier}get_fieldTypes(){return this._fieldTypes}get_formattedValues(){return this._formattedValues}get_numericFormattedValues(){return this._numericFormattedValues}get_relatedEntities(){return this._relatedEntities}get_fieldNames(){var e=[],t=this._fields;for(var r in t){var n={key:r,value:t[r]};e.push(n.key)}return e}get_changedFieldNames(){return this._changedFieldNames}get_columnSet(){return this._columnSet}get_key(){return this.get_identifier().get_key()}get_clientRetrieveOptions(){return this._clientRetrieveOptions}set_clientRetrieveOptions(e){for(var t of(this._clientRetrieveOptions=e,this._relatedEntities.get_entityCollections()))t.get_value().set_clientRetrieveOptions(e)}get_accessRights(){return this._accessRights}set_accessRights(e){this._accessRights=e}get_userSharedAttributePrivileges(){return this._userSharedAttributePrivileges}set_userSharedAttributePrivileges(e){this._userSharedAttributePrivileges=e}get_entityRecordForProcess(){return this._entityRecordForProcess}set_entityRecordForProcess(e){return this._entityRecordForProcess=e,e}get_globalNavigationData(){return this._globalNavigationData}set_globalNavigationData(e){this._globalNavigationData=e}isDirty(){return this.get_changedFieldNames().length>0}clone(){var e=this.getObjectData(),t=e.columnset;Object(o.IsNullOrUndefined)(t)||(t.columns=t.columns.slice());var r=e.formattedfields,n={};for(var a in r){var i={key:a,value:r[a]};n[i.key]=i.value}var s=e.numericformattedfields,u={};for(var c in s){var l={key:c,value:s[c]};u[l.key]=l.value}return e.formattedfields=n,e.numericformattedfields=u,O.createFromObjectData(e)}getObjectData(){var e=this._columnSet instanceof d.AllColumns;return{identifier:this._identifier.getObjectData(),fields:this._GetFieldsObjectData(),fieldtypes:{},formattedfields:this._formattedValues,numericformattedfields:this._numericFormattedValues,allcolumns:e,columnset:e?void 0:this._columnSet.getObjectData(),clientretrieveoptions:Object(o.IsNullOrUndefined)(this._clientRetrieveOptions)?void 0:this._clientRetrieveOptions.getObjectData(),accessrights:this._accessRights,sharedattributeprivileges:{},entityrecordforprocess:Object(o.IsNullOrUndefined)(this.get_entityRecordForProcess())?void 0:this.get_entityRecordForProcess().getObjectData(),globalnavigationdata:Object(o.IsNullOrUndefined)(this.get_globalNavigationData())?void 0:this.get_globalNavigationData().getObjectData()}}_GetFieldsObjectData(){return Object.keys(this._fields).reduce((e,t)=>(e[t]=this.getFieldObjectData(t),e),{})}getFieldObjectData(e){return O.InternalGetFieldObjectData(this.getValue(e),this._fieldTypes[e])}getFields(){return this._GetFieldsObjectData()}hasValue(e){return e in this._fields}hasField(e){return e in this._fieldTypes}getValue(e){return this._fields[e]}getFormattedValue(e){return Object(o.IsNullOrUndefined)(this.get_formattedValues()[e])?this.get_fieldTypes()[e]===n.AttributeType.AliasedValue?this.getValue(e).get_value():this.getValue(e):this.get_formattedValues()[e]}getNumericFormattedValue(e){return this._numericFormattedValues[e]||this.getFormattedValue(e)}setValue(e,t){if(!(e in this.get_fieldTypes()))throw Error(e);t&&t.get_Label&&t.get_ValueString?this._fields[e]=v.OptionMetadata.createFromPicklistItem(t):this._fields[e]=t,this.updateColumnSet([e])}markFieldChanged(e){if(this.get_changedFieldNames().indexOf(e)<0&&(this._cleanFields[e]=this._fields[e],this.get_changedFieldNames().push(e),this._fields[e]instanceof h.EntityCollection))for(var t of this._fields[e].get_entities())t._MarkAllFieldsChanged()}_MarkAllFieldsChanged(){for(var e of this.get_fieldNames())this.markFieldChanged(e)}resetChanges(){this._changedFieldNames=[],this._cleanFields={}}mergeChanges(e){Object(o.IsNullOrUndefined)(this._clientRetrieveOptions)?this._clientRetrieveOptions=e._clientRetrieveOptions:this._clientRetrieveOptions.update(e._clientRetrieveOptions),this.set_accessRights(e.get_accessRights()),this.mergeEntityRecordFields(e),this._entityRecordForProcess=e._entityRecordForProcess,this._globalNavigationData=e._globalNavigationData}mergeEntityRecordFields(e){var t=e._fields;for(var r in t){var n={key:r,value:t[r]};n.key in this._fields&&Object(c.areValuesEqual)(this._fields[n.key],n.value)||(this._fields[n.key]=n.value)}var a=e._fieldTypes;for(var i in a){var o={key:i,value:a[i]}.key;o in this._fieldTypes||(this._fieldTypes[o]=e._fieldTypes[o]),o in this._fields&&!(o in e._fields)&&(delete this._fields[o],delete this._formattedValues[o],delete this._numericFormattedValues[o])}var s=e._formattedValues;for(var u in s){var l={key:u,value:s[u]};l.key in this._formattedValues&&Object(c.areValuesEqual)(this._formattedValues[l.key],l.value)||(this._formattedValues[l.key]=l.value)}e.get_columnSet()instanceof d.AllColumns?this.updateColumnSet(e.get_columnSet()):this.updateColumnSet(this.get_fieldNames())}initializeValue(e,t,r){this._fields[e]=t,e in this._fieldTypes||(this._fieldTypes[e]=r),this.updateColumnSet([e])}updateColumnSet(e,t){if(e=e,!(this.get_columnSet()instanceof d.AllColumns)){if(e instanceof d.AllColumns)this._columnSet=d.AllColumns.get_instance();else{var r;r=e instanceof p.LegacyColumnSet?e.get_Columns():e;var n=this._columnSet;for(var a of r)n.get_Columns().indexOf(a)<0&&n.get_Columns().push(a)}if(!Object(o.IsNullOrUndefined)(t)&&t&&(null==t?void 0:t.length)>0)for(var i of t){var s=this.get_relatedEntities().getByRelationship(i.get_relationship());if(s)for(var u of s.get_entities())u.updateColumnSet(i.get_ColumnSet())}}}static createFromObjectData(e){var t,r,n={},a=e.identifier&&y.LegacyEntityReference.createFromObjectData(e.identifier),i=O.createFieldsFromObjectData(e.fields,n);t=e.allcolumns?d.AllColumns.get_instance():p.LegacyColumnSet.createFromObjectData(e.columnset),e.clientretrieveoptions&&(r=f.ClientRetrieveOptions.createFromObjectData(e.clientretrieveoptions));var s=new O(a,i,n,e.formattedfields,e.numericformattedfields,new g.RelatedEntityCollection(new Array(0)),t,r);s.set_accessRights(e.accessrights);var u=e.entityrecordforprocess;Object(o.IsNullOrUndefined)(u)||s.set_entityRecordForProcess(O.createFromObjectData(u));var c=e.globalnavigationdata;return Object(o.IsNullOrUndefined)(c)||s.set_globalNavigationData(O.createFromObjectData(c)),s}static createSingleFieldFromObjectData(e,t){return O.InternalCreateFieldFromObjectData(e,t)}static createFieldsFromObjectData(e,t){var r={};for(var n in e){var a={key:n,value:e[n]};r[a.key]=O.InternalCreateFieldFromObjectData(a.value,t[a.key])}return r}static InternalCreateFieldFromObjectData(e,t){if(Object(o.IsNullOrUndefined)(e))return null;switch(t){case n.AttributeType.AliasedValue:return m.LegacyAliasedValue.createFromObjectData(e);case n.AttributeType.Customer:case n.AttributeType.Lookup:case n.AttributeType.Owner:return y.LegacyEntityReference.createFromObjectData(e);case n.AttributeType.UniqueIdentifier:return a.LegacyGuid.createFromObjectData(e);case n.AttributeType.DateTime:return new Date(Date.parse(e));case n.AttributeType.Status:case n.AttributeType.State:case n.AttributeType.Boolean:case n.AttributeType.PickList:return v.OptionMetadata.createFromObjectData(e);case n.AttributeType.PartyList:return h.EntityCollection.createFromObjectData(e);default:return e}}static InternalGetFieldObjectData(e,t){if(Object(o.IsNullOrUndefined)(e))return null;switch(t){case n.AttributeType.AliasedValue:return e.getObjectData();case n.AttributeType.Customer:case n.AttributeType.Lookup:case n.AttributeType.Owner:case n.AttributeType.UniqueIdentifier:return e.getObjectData();case n.AttributeType.DateTime:return e.toString();case n.AttributeType.Status:case n.AttributeType.State:case n.AttributeType.Boolean:case n.AttributeType.PickList:case n.AttributeType.PartyList:return e.getObjectData();default:return e}}static recordDataToLegacyEntityRecord(e,t,r,n,a){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:u.FieldValueRetrievalBehavior.LatestEntered,c=i.EntityReference.toLegacyEntityReference(t),l=new O(c,{},{},{},{},new g.RelatedEntityCollection([]));for(var d in r){var p=Object(s.getAttributeDescriptor)(e,t.etn,d);if(p){var f=Object(u.getLegacyValueForField)(e,t.etn,d,r[d],o);l.initializeValue(d,f,p.Type),l.markFieldChanged(d)}else{var h="Attribute "+d+" for entity "+t.etn+" could not be found.";a.warn("EntityRecord ".concat(h))}}return l}}},9201:function(e,t,r){"use strict";r.r(t),r.d(t,"areValuesEqual",(function(){return a}));var n=r(9049);function a(e,t){return!e&&!t||!(!e&&t||e&&!t)&&(e instanceof n.LegacyGuid&&t instanceof n.LegacyGuid||e.equals&&t.equals?e.equals(t):e.get_ValueString&&e.get_Label&&t.get_ValueString&&t.get_Label?e.get_ValueString()===t.get_ValueString()&&e.get_Label()===t.get_Label():e.get_value&&t.get_value?a(e.get_value(),t.get_value()):(e instanceof Date&&t instanceof Date&&(e=e.valueOf(),t=t.valueOf()),e===t))}},9202:function(e,t,r){"use strict";r.r(t),r.d(t,"AllColumns",(function(){return a}));var n=r(9203);class a{get_isEmpty(){return!1}getDifference(e){return new n.LegacyColumnSet(new Array(0))}static get_instance(){return a._instance||(a._instance=new a)}}a._instance=null},9203:function(e,t,r){"use strict";r.r(t),r.d(t,"LegacyColumnSet",(function(){return a}));var n=r(9202);class a{constructor(e){this._columns=void 0,this._columns=e}get_Columns(){return this._columns}get_isEmpty(){return!(this._columns.length>0)}getObjectData(){var e={};return e.columns=this._columns,e}getDifference(e){if(e instanceof n.AllColumns)return e;var t=e.get_Columns().filter(e=>this.get_Columns().indexOf(e)<0);return new a(t)}static createFromObjectData(e){return new a(e.columns)}}},9204:function(e,t,r){"use strict";r.r(t),r.d(t,"ClientRetrieveOptions",(function(){return o}));var n=r(9205),a=r(9206),i=r(9083);class o{constructor(e,t,r){this._timestamp=void 0,this._cachePriority=0,this._retrievalStrategy=0,this._cachePriority=e,this._retrievalStrategy=t,this._timestamp=r||new Date}get_timestamp(){return this._timestamp}get_cachePriority(){return this._cachePriority}set_cachePriority(e){return this._cachePriority=e,e}get_retrievalStrategy(){return this._retrievalStrategy}set_retrievalStrategy(e){return this._retrievalStrategy=e,e}get_sortableTimestamp(){return o.getSortableString(this._timestamp)}getObjectData(){var e={};return e[o.timestampPath]=this.get_sortableTimestamp(),e.priority_timestamp=o.priorityTimestampKey(this._cachePriority,this._timestamp),e}update(e){Object(i.IsNullOrUndefined)(e)||(this._timestamp=e._timestamp,e._cachePriority<this._cachePriority&&(this._cachePriority=e._cachePriority))}static shouldBeCached(e){return!Object(i.IsNullOrUndefined)(e)&&e.get_cachePriority()!==n.CachePriority.NotCached}static getSortableString(e){return e.toDateString()}static priorityTimestampKey(e,t){return e+"|"+o.getSortableString(t)}static createFromObjectData(e){var t=new Date(e[o.timestampPath]),r=+e.priority_timestamp.substr(0,1);return new o(r,a.RetrievalStrategy.LocalAndRemote,t)}}o.timestampPath="timestamp",o.embeddedPriorityTimestampPath="clientretrieveoptions.priority_timestamp"},9205:function(e,t,r){"use strict";var n;r.r(t),r.d(t,"CachePriority",(function(){return n})),function(e){e[e.Workspace=0]="Workspace",e[e.Medium=1]="Medium",e[e.NotCached=2]="NotCached"}(n||(n={}))},9206:function(e,t,r){"use strict";var n;r.r(t),r.d(t,"RetrievalStrategy",(function(){return n})),function(e){e[e.Local=0]="Local",e[e.Remote=1]="Remote",e[e.LocalAndRemote=2]="LocalAndRemote",e[e.Default=3]="Default"}(n||(n={}))},9207:function(e,t,r){"use strict";r.r(t),r.d(t,"LegacyAliasedValue",(function(){return a}));var n=r(9200);class a{constructor(e,t,r){this._entityLogicalName=void 0,this._attributeLogicalName=void 0,this._attributeType=void 0,this._innerValue=void 0,this._entityLogicalName=e,this._attributeLogicalName=t,this._attributeType=r}get_entityLogicalName(){return this._entityLogicalName}get_attributeLogicalName(){return this._attributeLogicalName}get_attributeType(){return this._attributeType}get_value(){return this._innerValue}set_value(e){return this._innerValue=e,e}getObjectData(){return{entityLogicalName:this._entityLogicalName,attributeLogicalName:this._attributeLogicalName,attributeType:this._attributeType,value:n.EntityRecord.InternalGetFieldObjectData(this._innerValue,this._attributeType)}}static createFromObjectData(e){var{attributeLogicalName:t,entityLogicalName:r,attributeType:i,value:o}=e,s=i,u=new a(r,t,s);return u.set_value(n.EntityRecord.InternalCreateFieldFromObjectData(o,s)),u}}a.__typeName="Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.AliasedValue"},9208:function(e,t,r){"use strict";r.r(t),r.d(t,"OptionMetadata",(function(){return n}));class n{constructor(e,t,r,n,a,i,o){this._label=void 0,this._val=0,this._state=0,this._defaultStatus=0,this._allowedStatusTransitions=null,this._color=null,this._invariantName=null,this._label=e,this._val=t,this._state=r,this._defaultStatus=n,this._allowedStatusTransitions=a,this._color=i,this._invariantName=o}get_Label(){return this._label}set_Label(e){return this._label=e,e}get_ValueString(){return this._val.toString()}get_allowedStatusTransitions(){return this._allowedStatusTransitions}get_color(){return this._color}get_value(){return this._val}get_state(){return this._state}get_defaultStatus(){return this._defaultStatus}get_invariantName(){return this._invariantName}getObjectData(){return{label:this._label,value:this._val,state:this._state,defaultstatus:this._defaultStatus,allowedstatustransitions:this._allowedStatusTransitions,color:this._color,invariantname:this._invariantName}}getODataObject(){return{Value:this._val,Color:this._color,Label:this._label,DefaultStatus:this._defaultStatus,State:this._state,TransitionData:this._allowedStatusTransitions,InvariantName:this._invariantName}}static createFromPicklistItem(e){if(e instanceof n)return e;var t=e.get_Label();return new n(t,+e,-1,-1,null,null,null)}static createFromObjectData(e){var t=e.label,r=e.value,a="state"in e?e.state:-1,i="defaultstatus"in e?e.defaultstatus:-1,o="allowedstatustransitions"in e?e.allowedstatustransitions:null,s="color"in e?e.color:null,u=e.invariantname;return new n(t,r,a,i,o,s,u)}static createFromOData(e){var t=e.Label,r=e.Value,a="State"in e?e.State:-1,i="DefaultStatus"in e?e.DefaultStatus:-1,o="TransitionData"in e?e.TransitionData:null,s="Color"in e?e.Color:null,u=e.Description;return new n(t,r,a,i,o,s,u)}}n.__typeName="Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.OptionMetadata"},9209:function(e,t,r){"use strict";r.r(t),r.d(t,"RelatedEntityCollection",(function(){return i}));var n=r(9210),a=r(9082);class i{constructor(e){this._entityCollections=void 0,this._relatedEntityQueries=void 0,Object(a.throwOnNullOrUndefinedArgument)(e,"entityCollections"),this._entityCollections=e,this._relatedEntityQueries=this._entityCollections.map(e=>e.get_value().get_query())}get_entityCollections(){return this._entityCollections}get_relatedEntityQueries(){return this._relatedEntityQueries}getObjectData(){var e={},t=[];for(var r of this._entityCollections){var n={};n.key=r.get_key().getObjectData(),n.value=r.get_value().getObjectData(),t.push(n)}return e.entitycollections=t,e}getByRelationship(e){for(var t of this._entityCollections)if(t.get_key().equals(e))return t.get_value();return null}addRelationship(e,t){for(var r=0;r<this._entityCollections.length;r++)if(this._entityCollections[r].get_key().equals(e))return void(this._entityCollections[r]=new n.KeyValuePair(e,t));this._entityCollections.push(new n.KeyValuePair(e,t))}}},9210:function(e,t,r){"use strict";r.r(t),r.d(t,"KeyValuePair",(function(){return n}));class n{constructor(e,t){this._key=void 0,this._value=void 0,this._key=e,this._value=t}get_key(){return this._key}get_value(){return this._value}}},9211:function(e,t,r){"use strict";r.r(t),r.d(t,"isPicklistValue",(function(){return o})),r.d(t,"isGuidValue",(function(){return s})),r.d(t,"isReferenceValue",(function(){return u})),r.d(t,"isPlainValue",(function(){return c})),r.d(t,"isAliasedValue",(function(){return l})),r.d(t,"isPartylistValue",(function(){return d})),r.d(t,"getFormattedValueFromField",(function(){return a})),r.d(t,"getPickListValueFromField",(function(){return f})),r.d(t,"getRawValueFromField",(function(){return i})),r.d(t,"getEntityReferenceIdFromField",(function(){return h})),r.d(t,"getEntityReferenceFromField",(function(){return m}));var n=r(9046);r(9212);function a(e){if(e){if(c(e)){if(e.validationResult&&!e.validationResult.isValueValid){var t=e.validationResult.userInput;return t&&(null==t?void 0:t.toString())}return e.formatted||e.value&&e.value.toString()}if(o(e))return e.label;if(s(e))return n.Guid.toString(e.id);if(u(e))return e.reference&&e.reference.name||null;if(l(e))return a(e.innerValue);if(d(e)){var r="";for(var i of e.list){var f=void 0;i.fields&&(f=i.fields.partyid?i.fields.partyid:i.fields.addressused?i.fields.addressused:null)&&(r=""!==r?"".concat(r,", ").concat(a(f)):a(f))}return r}return p(e)}return null}function i(e){return e?c(e)?e.value:o(e)?f(e):s(e)?e.id:u(e)?e.reference:l(e)?i(e.innerValue):d(e)?e.list:p(e):null}function o(e){return!!e&&e.hasOwnProperty("label")}function s(e){return!!e&&e.hasOwnProperty("id")}function u(e){return!!e&&e.hasOwnProperty("reference")}function c(e){return!!e&&e.hasOwnProperty("value")}function l(e){return!!e&&e.hasOwnProperty("innerValue")}function d(e){return!!e&&e.hasOwnProperty("list")}function p(e){return e?e.toString():null}function f(e){return e&&o(e)?e.valueString:null}function h(e){return e&&u(e)&&e.reference&&e.reference.id||null}function m(e){return u(e)&&e.reference||null}},9212:function(e,t,r){"use strict";r.r(t)},9213:function(e,t,r){"use strict";r.r(t),r.d(t,"buildDeleteRequest",(function(){return i}));var n=r(9183),a=r(9193);function i(e,t,r,i){var o=Object(n.getEntitySetName)(e,t.etn),s="".concat(o,"(").concat(t.id.guid,")");i&&(s=s+"/"+i);var u={urlParameters:s,method:"DELETE"};return i||(void 0!==u.additionalHeaders&&null!==u.additionalHeaders||(u.additionalHeaders={}),u.additionalHeaders[a.HEADER.IF_MATCH]=r||"*"),u}},9214:function(e,t,r){"use strict";var n,a;r.r(t),r.d(t,"ODataStructuralProperty",(function(){return n})),r.d(t,"ODataOperationType",(function(){return a})),function(e){e[e.Unknown=0]="Unknown",e[e.PrimitiveType=1]="PrimitiveType",e[e.ComplexType=2]="ComplexType",e[e.EnumerationType=3]="EnumerationType",e[e.Collection=4]="Collection",e[e.EntityType=5]="EntityType"}(n||(n={})),function(e){e[e.Action=0]="Action",e[e.Function=1]="Function",e[e.CRUD=2]="CRUD",e[e.ExecuteMultiple=3]="ExecuteMultiple"}(a||(a={}))},9215:function(e,t,r){"use strict";r.r(t),r.d(t,"ODataCreateRequest",(function(){return a})),r.d(t,"ODataUpdateRequest",(function(){return i})),r.d(t,"ODataDeleteRequest",(function(){return o})),r.d(t,"ODataRetrieveRequest",(function(){return s})),r.d(t,"ODataRetrieveWithUrlParamsRequest",(function(){return u})),r.d(t,"ODataExecuteMultipleRequest",(function(){return c})),r.d(t,"ODataDeleteWithUrlParamsRequest",(function(){return l}));var n=r(9214);class a{constructor(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4?arguments[4]:void 0,i=arguments.length>5?arguments[5]:void 0;this.etn=void 0,this.payload=void 0,this.suppressDupeDetection=void 0,this.returnRowVersion=void 0,this.offlineData=void 0,this.solutionUniqueName=void 0,this.etn=e,this.payload=t,this.suppressDupeDetection=r,this.returnRowVersion=n,this.offlineData=a,this.solutionUniqueName=i}getMetadata(){return{boundParameter:void 0,parameterTypes:{},operationName:"Create",operationType:n.ODataOperationType.CRUD}}}class i{constructor(e,t,r,n,a,i,o,s,u,c,l){this.etn=void 0,this.id=void 0,this.payload=void 0,this.urlParams=void 0,this.headers=void 0,this.isBinaryPayload=void 0,this.suppressDupeDetection=void 0,this.ifMatch=void 0,this.returnRowVersion=void 0,this.offlineData=void 0,this.solutionUniqueName=void 0,this.etn=e,this.id=t,this.payload=r,this.urlParams=n,this.headers=a,this.isBinaryPayload=i,this.suppressDupeDetection=o,this.ifMatch=s,this.returnRowVersion=u,this.offlineData=c,this.solutionUniqueName=l}getMetadata(){return{boundParameter:void 0,parameterTypes:{},operationName:"Update",operationType:n.ODataOperationType.CRUD}}}class o{constructor(e,t,r,n){this.entityReference=void 0,this.attributeName=void 0,this.ifMatch=void 0,this.offlineData=void 0,this.entityReference=e,this.attributeName=t,this.ifMatch=r,this.offlineData=n}getMetadata(){return{boundParameter:void 0,parameterTypes:{entityReference:{typeName:"mscrm.crmbaseentity",structuralProperty:n.ODataStructuralProperty.EntityType}},operationName:"Delete",operationType:n.ODataOperationType.CRUD}}}class s{constructor(e,t,r){this.entityReference=void 0,this.columns=void 0,this.navigationPropertyDetails=void 0,this.entityReference=e,this.columns=t,this.navigationPropertyDetails=r}getMetadata(){return{boundParameter:void 0,parameterTypes:{},operationName:"Retrieve",operationType:n.ODataOperationType.CRUD}}}class u{constructor(e,t,r,n,a){this.etn=void 0,this.id=void 0,this.urlParams=void 0,this.headers=void 0,this.maxPageSize=void 0,this.etn=e,this.id=t,this.urlParams=r,this.headers=n,this.maxPageSize=a}getMetadata(){return{boundParameter:void 0,parameterTypes:{},operationName:"RetrieveWithUrlParams",operationType:n.ODataOperationType.CRUD}}}class c{constructor(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.requests=void 0,this.continueOnError=void 0,this.requests=e,this.continueOnError=t}getMetadata(){return{boundParameter:void 0,parameterTypes:{},operationName:"ExecuteMultiple",operationType:n.ODataOperationType.ExecuteMultiple}}}class l{constructor(e,t,r,n,a){this.etn=void 0,this.id=void 0,this.urlParams=void 0,this.ifMatch=void 0,this.offlineData=void 0,this.etn=e,this.id=t,this.urlParams=r,this.ifMatch=n}getMetadata(){return{boundParameter:void 0,parameterTypes:{},operationName:"DeleteWithUrlParams",operationType:n.ODataOperationType.CRUD}}}},9216:function(e,t,r){"use strict";r.r(t),r.d(t,"getEntityReferenceFromResponse",(function(){return l})),r.d(t,"parseResponseAsGuid",(function(){return c})),r.d(t,"getEntityIdFromResponse",(function(){return d})),r.d(t,"parseBatchResponse",(function(){return v})),r.d(t,"_splitByBoundary",(function(){return f})),r.d(t,"parseResponseForRowVersion",(function(){return O}));var n=r(9046),a=r(9217),i=r(9218),o=r(9081);function s(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function u(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){s(i,n,a,o,u,"next",e)}function u(e){s(i,n,a,o,u,"throw",e)}o(void 0)}))}}function c(e){var t=Object(i.getHttpHeader)(e.headers,"OData-EntityId");if(t){var r=t.indexOf("(")+1,a=t.substring(r,t.length-1);return n.Guid.tryParse(a)}return null}function l(e,t){var r=c(e),a=O(e);return new o.LegacyEntityReference(t,n.Guid.toLegacyGuid(r),void 0,a)}function d(e,t){return p.apply(this,arguments)}function p(){return(p=u((function*(e,t){var r=c(t);if(!r){var a=yield t.json();return n.Guid.tryParse(a[e])}return r}))).apply(this,arguments)}function f(e,t){if(!t)return[];var r="--"+e+"\r\n";0===t.indexOf(r)||(r="--"+e+"\n");var n=t.split(r);if(n.splice(0,1),n.length>0){var a=n[n.length-1],i=a.indexOf("--"+e);n[n.length-1]=a.substring(0,i)}return n}function h(e,t){var r=t.indexOf(":");if(r>=0){var n=t.substring(0,r),a=t.substring(r+1).trim();e[n]=a}return e}function m(e){var t=-1!==e.indexOf("\r\n\r\n"),r=e.trim().split(t?"\r\n\r\n":"\n\n"),n=-1,i=null,o=null,s="",u="";if(r.length>0){var c=null;r.length>1&&(c=r[1].split(t?"\r\n":"\n"));var l=null;null!=c&&(l=c.slice(1),o=/(HTTP\/\d\.\d) (\d+) (.*)/gi.exec(c[0]));var d=r[0].split(t?"\r\n":"\n");if(null!=d)for(var p of d){var f;if(0===p.toLowerCase().indexOf("content-id:"))null===(f=l)||void 0===f||f.push(p)}if(n=o&&o.length>=3?Number(o[2]):0,l){var m=l.reduce(h,{});i=new a.FetchLikeHeaders(m)}r.length>1&&(u=r[2]),null!=o&&o.length>2&&(s=o[3])}return y(n,s,i,u)}function y(e,t,r,n){return{status:e,ok:200<=e&&299>=e,statusText:t,headers:r,clone(){return Object.assign({},this)},json:()=>Promise.resolve(n?JSON.parse(n):null),text:()=>Promise.resolve(n)}}function v(e,t){return g.apply(this,arguments)}function g(){return(g=u((function*(e,t){null==t||t.AppendCallStack("Parsers.parseBatchResponse");var r,n=yield e.text(),a=[];if(e.headers){var o=/boundary=(.*)/,s=Object(i.getHttpHeader)(e.headers,"Content-Type"),u=s&&o.test(s)&&o&&s.match(o);r=u&&u.length>1?u[1]:""}else r=n.substr(n.indexOf("batchresponse"),n.indexOf("\r\n")-2);var c=f(r,n);for(var l of c){var d=/^\s*Content-Type: .*boundary=(.*)\r?\n/gi.exec(l);if(d){var p=d[1],h=l.indexOf("--"+p),v=f(p,l.slice(h)).map(m);a.push(...v)}else{var g=m(l);a.push(g)}}if(0===a.length){var O=y(e.status,e.statusText,e.headers,n);a.push(O)}return a}))).apply(this,arguments)}function O(e){var t=Object(i.getHttpHeader)(e.headers,"ETag");if(!t)return null;var r=t.indexOf('"')+1;return t.substring(r,t.length-1)}},9217:function(e,t,r){"use strict";var n;r.r(t),r.d(t,"FetchLikeHeaders",(function(){return a})),n=Symbol.iterator;class a{constructor(e){this._headers=void 0,this._headers=e}[n](){throw new Error("Method not implemented.")}entries(){throw new Error("Method not implemented.")}keys(){throw new Error("Method not implemented.")}values(){throw new Error("Method not implemented.")}append(e,t){this._headers[e]=t}get(e){return this._headers[e]}has(e){return this._headers.hasOwnProperty(e)}delete(e){delete this._headers[e]}set(e,t){this._headers[e]=t}forEach(e){for(var t in this._headers)e(this._headers[t],t,this)}}},9218:function(e,t,r){"use strict";function n(e,t){if(!e)return null;var r=e.get(t);return r||(r=e.get(t.toLowerCase())),r}r.r(t),r.d(t,"getHttpHeader",(function(){return n}))},9219:function(e,t,r){"use strict";r.r(t),r.d(t,"buildRetrieveContract",(function(){return h})),r.d(t,"buildRetrieveRequestWithURLParams",(function(){return m}));var n=r(9048),a=r(9055),i=r(9046),o=r(9083),s=r(9220),u=r(9183),c=r(9184),l=r(9221),d=r(9193),p=r(9215),f=r(9182);function h(e,t,r,h,m){var y,v,g=[],O=[];for(var E of r){var b=Object(f.getAttributeDescriptor)(e,t.etn,E);if(!b)throw new c.ErrorStatus("Cannot serialize a request with no attribute metadata for ".concat(t.etn,".").concat(E));if(b.Type===n.AttributeType.PartyList){if(!(v=Object(u.getActivityPartyNavigationPropertyRelationship)(e,t.etn))){y="The relationship for the partylist attribute ".concat(E," is not found in the state tree or is invalid");break}var T=Object(s.getParticipationTypeMask)(t.etn,E);if(void 0===T)throw new c.ErrorStatus("Unknown participation type mask for attribute ".concat(E));O.push(T)}else b&&-1!==l.SupportedLookupProperties.indexOf(b.Type)?g.push("_".concat(E,"_value")):g.push(E)}var S="";if(O.length){var C=O.map(e=>"'".concat(e,"'")),N="$filter=Microsoft.Dynamics.CRM.In(PropertyName='participationtypemask',PropertyValues=[".concat(C,"])");S="&$expand=".concat(v.ReferencedEntityNavigationPropertyName,"(").concat(N,")")}var _=function(e,t,r,i){var c,d="",p=[];if(i){var h="";for(var m of i){var y=m.get_relationShipName(),v=m.get_columnNames(),g=[],O=Object(u.getRelationShipByNavigationProperty)(e,t.etn,y);if(O){var E=Object(u.getRelationshipTypeByNavigationProperty)(e,t.etn,y)===a.RelationshipType.OneToManyRelationship?O.ReferencingEntity:O.ReferencedEntity;for(var b of v){var T=Object(f.getAttributeDescriptor)(e,E,b);if(!T){c="Cannot serialize a request with no attribute metadata for ".concat(E,".").concat(b);break}if(T.Type===n.AttributeType.PartyList){if(!Object(u.getActivityPartyNavigationPropertyRelationship)(e,E)){c="The relationship for the partylist attribute ".concat(b," is not found in the state tree or is invalid");break}var S=Object(s.getParticipationTypeMask)(E,b);if(void 0===S){c="Unknown participation type mask for attribute ".concat(b);break}p.push(S)}else T&&-1!==l.SupportedLookupProperties.indexOf(T.Type)?g.push("_".concat(b,"_value")):g.push(b)}}g&&g.length>0&&(h=Object(o.IsNullOrUndefinedOrEmptyString)(h)?"".concat(y,"($select=").concat(g.join(","),")"):h+","+"".concat(y,"($select=").concat(g.join(","),")"))}d="&$expand="+h}if(c&&r){r.TraceManager.getTracer("RetrieveRequestSerializer").error(c)}return d}(e,t,h,m),R=new p.ODataRetrieveWithUrlParamsRequest(t.etn,i.Guid.toString(t.id),"?$select=".concat(g.join(",")).concat(S).concat(_),{[d.HEADER.PREFER]:d.HEADER_VALUES.ANNOTATIONS,[d.HEADER.ACCEPT]:d.HEADER_VALUES.APPLICATION_JSON,[d.HEADER.MSCRM_RETURN_NOTIFICATIONS]:"true"});y&&h&&h.TraceManager.getTracer("RetrieveRequestSerializer").error(y);return R}function m(e,t,r,n,a,o){var s=Object(u.getEntitySetName)(e,t),c=r&&i.Guid.isNullOrEmpty(i.Guid.tryParse(r))?"":"(".concat(r,")"),l=a&&"number"==typeof a?",odata.maxpagesize=".concat(a):"",p={urlParameters:"".concat(s).concat(c).concat(n||""),additionalHeaders:{[d.HEADER.PREFER]:"".concat(d.HEADER_VALUES.ANNOTATIONS).concat(l),[d.HEADER.ACCEPT]:d.HEADER_VALUES.APPLICATION_JSON,[d.HEADER.MSCRM_RETURN_NOTIFICATIONS]:"true"},method:"GET"};return o&&"object"==typeof o&&Object.assign(p.additionalHeaders,o),p}},9220:function(e,t,r){"use strict";var n;function a(e){switch(e){case"campaignactivity":return["partners","from"];case"fax":return["from","to"];case"email":case"letter":return["from","to","cc","bcc"];case"phonecall":return["from","to"];case"appointment":return["optionalattendees","organizer","requiredattendees"];case"campaignresponse":return["customer","partner","from"];case"recurringappointmentmaster":return["optionalattendees","organizer","requiredattendees"];case"serviceappointment":return["customers","resources"];default:return["bcc","cc","customers","optionalattendees","organizer","requiredattendees","resources","sendermailboxid","to","from"]}}function i(e,t){switch("".concat(e,".").concat(t).toLowerCase()){case"campaignactivity.from":case"campaignresponse.from":case"fax.from":case"email.from":case"letter.from":case"phonecall.from":return n.Sender;case"email.to":case"fax.to":case"letter.to":case"phonecall.to":return n.ToRecipient;case"email.cc":return n.CCRecipient;case"email.bcc":case"letter.bcc":return n.BccRecipient;case"appointment.optionalattendees":case"recurringappointmentmaster.optionalattendees":return n.OptionalAttendee;case"appointment.organizer":case"recurringappointmentmaster.organizer":return n.Organizer;case"appointment.requiredattendees":case"recurringappointmentmaster.requiredattendees":return n.RequiredAttendee;case"campaignresponse.customer":case"serviceappointment.customer":return n.Customer;case"serviceappointment.resources":return n.Resource;case"campaignactivity.partners":case"campaignresponse.partner":return n.Partner;default:return function(e){switch(e){case"bcc":return n.BccRecipient;case"cc":return n.CCRecipient;case"customers":return n.Customer;case"partners":return n.Partner;case"optionalattendees":return n.OptionalAttendee;case"organizer":return n.Organizer;case"requiredattendees":return n.RequiredAttendee;case"resources":return n.Resource;case"sendermailboxid":case"from":return n.Sender;case"to":return n.ToRecipient;case"regarding":return n.Regarding;case"owner":return n.Owner;default:return}}(t)}}r.r(t),r.d(t,"ParticipationTypeMask",(function(){return n})),r.d(t,"getParticipationTypeMask",(function(){return i})),r.d(t,"getPartyListAttributeNames",(function(){return a})),function(e){e[e.Sender=1]="Sender",e[e.ToRecipient=2]="ToRecipient",e[e.CCRecipient=3]="CCRecipient",e[e.BccRecipient=4]="BccRecipient",e[e.RequiredAttendee=5]="RequiredAttendee",e[e.OptionalAttendee=6]="OptionalAttendee",e[e.Organizer=7]="Organizer",e[e.Regarding=8]="Regarding",e[e.Owner=9]="Owner",e[e.Resource=10]="Resource",e[e.Customer=11]="Customer",e[e.Partner=12]="Partner"}(n||(n={}))},9221:function(e,t,r){"use strict";r.r(t),r.d(t,"SupportedLookupProperties",(function(){return a}));var n=r(9048),a=[n.AttributeType.Owner,n.AttributeType.Customer,n.AttributeType.Lookup]},9222:function(e,t,r){"use strict";r.r(t),r.d(t,"buildUpdateRequest",(function(){return u})),r.d(t,"extractIfMatchHeaderForConcurrency",(function(){return s}));var n=r(9183),a=r(9193),i=r(9223),o=r(9197);function s(e,t){return e===i.ConcurrencyBehavior.IfRowVersionMatches&&t?'W/"'+t+'"':"*"}function u(e,t,r,i){var s,u=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],c=arguments.length>5?arguments[5]:void 0,l=arguments.length>6?arguments[6]:void 0,d=arguments.length>7?arguments[7]:void 0,p=arguments.length>8?arguments[8]:void 0,f=arguments.length>9?arguments[9]:void 0,h=arguments.length>10?arguments[10]:void 0,m=Object(n.getEntitySetName)(e,t);s=r?"".concat(m,"(").concat(r,")"):"".concat(m),d&&(s+=d);var y={urlParameters:s,method:"PATCH",additionalHeaders:{[a.HEADER.MSCRM_SUPPRESS_DUPLICATION_DETECTION]:u.toString(),[a.HEADER.IF_MATCH]:c||"*",[a.HEADER.AUTO_DISASSOCIATE]:"true"},body:f?i:JSON.stringify(i)};return p&&Object.assign(y.additionalHeaders,p),l&&y.additionalHeaders&&(y.additionalHeaders[o.RETRIEVE_ROW_VERSION_HEADER]="true"),y&&y.additionalHeaders&&h&&(y.additionalHeaders[a.HEADER.MSCRM_SOLUTION_UNIQUE_NAME]=h),y}},9223:function(e,t,r){"use strict";var n;r.r(t),r.d(t,"ConcurrencyBehavior",(function(){return n})),function(e){e[e.Default=0]="Default",e[e.IfRowVersionMatches=1]="IfRowVersionMatches",e[e.AlwaysOverwrite=2]="AlwaysOverwrite"}(n||(n={}))},9224:function(e,t,r){"use strict";r.r(t),r.d(t,"buildFunctionRequest",(function(){return o}));var n=r(9193),a=r(9225),i=r(9230);function o(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{var o=Object(a.getODataUrlForFunction)(e,t),s=i.OPERATION_TYPE.FUNCTION,u=t.getMetadata().operationName||i.UNKNOWN_TYPE;u===i.OPERATION_TYPE.GCM&&(s=i.OPERATION_TYPE.GCM);var c=Object(i.getRequestSource)(r),l={urlParameters:o,additionalHeaders:{[n.HEADER.ACCEPT]:n.HEADER_VALUES.APPLICATION_JSON,[n.HEADER.PREFER]:n.HEADER_VALUES.ANNOTATIONS},method:"GET",additionalParameters:{[i.OPERATION.TYPE]:s,[i.OPERATION.SUB_TYPE]:u,[i.OPERATION.SOURCE]:c}};return l}catch(d){return{serializationFailure:d.message}}}},9225:function(e,t,r){"use strict";r.r(t),r.d(t,"serializeContract",(function(){return f})),r.d(t,"getODataUrlForFunction",(function(){return v})),r.d(t,"serializeIntoURLFragment",(function(){return l})),r.d(t,"serializeComplexTypeParameter",(function(){return y}));var n=r(9214),a=r(9046),i=r(9183),o=r(9226),s=r(9227),u=r(9229),c={COLON:encodeURIComponent(":"),OPEN_BRACKET:encodeURIComponent("{"),CLOSED_BRACKET:encodeURIComponent("}"),COMMA:encodeURIComponent(","),EQUAL:encodeURIComponent("=")};function l(e,t){var r=t.getMetadata().boundParameter,a=[],i=Object.keys(t).filter(e=>e!==r).map(r=>{var i=t.getMetadata().parameterTypes[r],o=y(e,t,r,!1,!0);return void 0!==i&&n.ODataStructuralProperty.EnumerationType===i.structuralProperty?"".concat(r,"=").concat(o):(a.push("@".concat(r,"=").concat(o)),"".concat(r,"=@").concat(r))});return a.length?"(".concat(i.join(","),")?").concat(a.join("&")):"(".concat(i.join(","),")")}function d(e,t,r,n){switch(e){case"Edm.String":return p(e,t,r,n);case"Edm.Guid":return p(e,t.guid,r,n);case"Edm.DateTimeOffset":if("object"==typeof t&&"function"==typeof t.toISOString)return p(e,t.toISOString(),r,n);default:return p("Edm.UndefinedType",t,r,n)}}function p(e,t,r,n){switch(function(e,t,r){var n=r?t?o.EncodeRule.DoubleQuotesURL:o.EncodeRule.NoQuotesURL:o.EncodeRule.Contract;return n===o.EncodeRule.Contract?"Edm.UndefinedType"===e?n=o.EncodeRule.None:"Edm.String"===e&&(n=o.EncodeRule.JsonifyURL):n===o.EncodeRule.NoQuotesURL&&"Edm.String"===e?n=o.EncodeRule.SingleQuotesURL:n===o.EncodeRule.DoubleQuotesURL&&"Edm.UndefinedType"===e&&(n=o.EncodeRule.NoQuotesURL),n}(e,r,n)){case o.EncodeRule.JsonifyURL:return JSON.stringify(t);case o.EncodeRule.SingleQuotesURL:return"'".concat(Object(s.encodeURIComponentForOData)(t),"'");case o.EncodeRule.DoubleQuotesURL:return'"'.concat(Object(s.encodeURIComponentForOData)(t),'"');case o.EncodeRule.NoQuotesURL:return Object(s.encodeURIComponentForOData)(t);case o.EncodeRule.Contract:return'"'.concat(t,'"');default:return t}}function f(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(t){var a="{",i="",o=n?c.COLON:":";if(r){var s=t.getMetadata().typeName;s&&r.typeName!==s&&(a+='"@odata.type"'.concat(o,'"').concat(s,'"'),i=",")}for(var u in t)if("function"!=typeof t[u]){var l=y(e,t,u,!0,n);if(h(t,u,l))continue;a+="".concat(i,'"').concat(u,'"').concat(o).concat(l),i||(i=",")}return a+"}"}return"null"}function h(e,t,r){if(e instanceof u.MetadataQuery){if([null,"null","[]",""].indexOf(r)>=0)return!0;if("DependencyDepth"===t&&e[t]===o.DependencyDepth.OnDemandWithoutContext)return!0}return!1}function m(e,t,r,n){var a=Object(s.getEnumValueMetadata)(e,t);return null==a?"":r?p(t.typeName,a.name,r,n):"".concat(t.typeName,"'").concat(a.name,"'")}function y(e,t,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=t.getMetadata(),u=t[r];if(r&&0===r.indexOf("@odata."))return'"'.concat(u,'"');var c=o.parameterTypes[r];if(void 0===c)return null;switch(c.structuralProperty){case n.ODataStructuralProperty.PrimitiveType:if(null==u)return null;var l="MetadataSubtype"===r&&"Edm.String"===c.typeName?'"'.concat(u,'"'):d(c.typeName,u,a,i);return l;case n.ODataStructuralProperty.EntityType:return Object(s.serializeEntityType)(e,u,a,i);case n.ODataStructuralProperty.ComplexType:var p=u;return f(e,p,c,i);case n.ODataStructuralProperty.EnumerationType:return m(u,c,a,i);case n.ODataStructuralProperty.Collection:if(u){if(u.length){if(u[0].getMetadata){var h=u;return"["+h.map(t=>f(e,t,void 0,i)).join(",")+"]"}return-1!==s.ODataPrimitives.indexOf(c.typeName)?"["+u.map(e=>d(c.typeName,e,a,i)).join(",")+"]":c.enumProperties?"["+u.map(e=>m(e,c,a,i)).join(",")+"]":"number"==typeof u[0]?"["+u.map(e=>d("Edm.String",e,a,i)).join(",")+"]":"["+u.map(t=>Object(s.serializeEntityType)(e,t,a,i)).join(",")+"]"}return"[]"}return"null";default:return null}}function v(e,t){var r=function(e,t,r){if(!t)throw new Error("Cannot generate base URL for the OData call: the routine name is empty.");if(!r)throw new Error("Cannot generate base URL for the OData call: the request is empty.");if(!r.getMetadata())throw new Error("Cannot generate base URL for the OData call: the request metadata is empty.");var o=r.getMetadata().boundParameter;if(o){var s=r.getMetadata();if(!s||!s.parameterTypes||!s.parameterTypes[o])return null;if(s.parameterTypes[o].structuralProperty===n.ODataStructuralProperty.Collection){var u=s.parameterTypes[o].typeName&&s.parameterTypes[o].typeName.split(".").pop();if(!u)return null;var c=Object(i.getEntitySetName)(e,u);return c?"".concat(c,"/Microsoft.Dynamics.CRM.").concat(t):null}var l=r[o],d=Object(i.getEntitySetName)(e,l.entityType);return"".concat(d,"(").concat(a.Guid.fromExternalGuid(l.id).guid,")/Microsoft.Dynamics.CRM.").concat(t)}return"".concat(t)}(e,t.getMetadata().operationName,t),o=l(e,t);return"".concat(r).concat(o)}},9226:function(e,t,r){"use strict";var n,a,i,o,s,u,c,l,d;r.r(t),r.d(t,"ConditionOperator",(function(){return n})),r.d(t,"DependencyDepth",(function(){return a})),r.d(t,"JoinOperator",(function(){return i})),r.d(t,"LogicalOperator",(function(){return o})),r.d(t,"OrderType",(function(){return s})),r.d(t,"TargetFieldType",(function(){return u})),r.d(t,"RollupType",(function(){return c})),r.d(t,"EncodeRule",(function(){return l})),r.d(t,"DependencyType",(function(){return d})),function(e){e[e.Equal=0]="Equal",e[e.NotEqual=1]="NotEqual",e[e.GreaterThan=2]="GreaterThan",e[e.LessThan=3]="LessThan",e[e.GreaterEqual=4]="GreaterEqual",e[e.LessEqual=5]="LessEqual",e[e.Like=6]="Like",e[e.NotLike=7]="NotLike",e[e.In=8]="In",e[e.NotIn=9]="NotIn",e[e.Between=10]="Between",e[e.NotBetween=11]="NotBetween",e[e.Null=12]="Null",e[e.NotNull=13]="NotNull",e[e.Yesterday=14]="Yesterday",e[e.Today=15]="Today",e[e.Tomorrow=16]="Tomorrow",e[e.Last7Days=17]="Last7Days",e[e.Next7Days=18]="Next7Days",e[e.LastWeek=19]="LastWeek",e[e.ThisWeek=20]="ThisWeek",e[e.NextWeek=21]="NextWeek",e[e.LastMonth=22]="LastMonth",e[e.ThisMonth=23]="ThisMonth",e[e.NextMonth=24]="NextMonth",e[e.On=25]="On",e[e.OnOrBefore=26]="OnOrBefore",e[e.OnOrAfter=27]="OnOrAfter",e[e.LastYear=28]="LastYear",e[e.ThisYear=29]="ThisYear",e[e.NextYear=30]="NextYear",e[e.LastXHours=31]="LastXHours",e[e.NextXHours=32]="NextXHours",e[e.LastXDays=33]="LastXDays",e[e.NextXDays=34]="NextXDays",e[e.LastXWeeks=35]="LastXWeeks",e[e.NextXWeeks=36]="NextXWeeks",e[e.LastXMonths=37]="LastXMonths",e[e.NextXMonths=38]="NextXMonths",e[e.LastXYears=39]="LastXYears",e[e.NextXYears=40]="NextXYears",e[e.EqualUserId=41]="EqualUserId",e[e.NotEqualUserId=42]="NotEqualUserId",e[e.EqualBusinessId=43]="EqualBusinessId",e[e.NotEqualBusinessId=44]="NotEqualBusinessId",e[e.ChildOf=45]="ChildOf",e[e.Mask=46]="Mask",e[e.NotMask=47]="NotMask",e[e.MasksSelect=48]="MasksSelect",e[e.Contains=49]="Contains",e[e.DoesNotContain=50]="DoesNotContain",e[e.EqualUserLanguage=51]="EqualUserLanguage",e[e.NotOn=52]="NotOn",e[e.OlderThanXMonths=53]="OlderThanXMonths",e[e.BeginsWith=54]="BeginsWith",e[e.DoesNotBeginWith=55]="DoesNotBeginWith",e[e.EndsWith=56]="EndsWith",e[e.DoesNotEndWith=57]="DoesNotEndWith",e[e.ThisFiscalYear=58]="ThisFiscalYear",e[e.ThisFiscalPeriod=59]="ThisFiscalPeriod",e[e.NextFiscalYear=60]="NextFiscalYear",e[e.NextFiscalPeriod=61]="NextFiscalPeriod",e[e.LastFiscalYear=62]="LastFiscalYear",e[e.LastFiscalPeriod=63]="LastFiscalPeriod",e[e.LastXFiscalYears=64]="LastXFiscalYears",e[e.LastXFiscalPeriods=65]="LastXFiscalPeriods",e[e.NextXFiscalYears=66]="NextXFiscalYears",e[e.NextXFiscalPeriods=67]="NextXFiscalPeriods",e[e.InFiscalYear=68]="InFiscalYear",e[e.InFiscalPeriod=69]="InFiscalPeriod",e[e.InFiscalPeriodAndYear=70]="InFiscalPeriodAndYear",e[e.InOrBeforeFiscalPeriodAndYear=71]="InOrBeforeFiscalPeriodAndYear",e[e.InOrAfterFiscalPeriodAndYear=72]="InOrAfterFiscalPeriodAndYear",e[e.EqualUserTeams=73]="EqualUserTeams",e[e.EqualUserOrUserTeams=74]="EqualUserOrUserTeams",e[e.Under=75]="Under",e[e.NotUnder=76]="NotUnder",e[e.UnderOrEqual=77]="UnderOrEqual",e[e.Above=78]="Above",e[e.AboveOrEqual=79]="AboveOrEqual",e[e.EqualUserOrUserHierarchy=80]="EqualUserOrUserHierarchy",e[e.EqualUserOrUserHierarchyAndTeams=81]="EqualUserOrUserHierarchyAndTeams",e[e.OlderThanXYears=82]="OlderThanXYears",e[e.OlderThanXWeeks=83]="OlderThanXWeeks",e[e.OlderThanXDays=84]="OlderThanXDays",e[e.OlderThanXHours=85]="OlderThanXHours",e[e.OlderThanXMinutes=86]="OlderThanXMinutes"}(n||(n={})),function(e){e[e.Unknown=0]="Unknown",e[e.OnDemandWithContext=1]="OnDemandWithContext",e[e.OnDemandWithoutContext=2]="OnDemandWithoutContext",e[e.OnDemandContextOnly=3]="OnDemandContextOnly",e[e.Offline=4]="Offline",e[e.Mobile=5]="Mobile",e[e.UserContext=6]="UserContext"}(a||(a={})),function(e){e[e.Inner=0]="Inner",e[e.LeftOuter=1]="LeftOuter",e[e.Natural=2]="Natural",e[e.MatchFirstRowUsingCrossApply=3]="MatchFirstRowUsingCrossApply",e[e.In=4]="In",e[e.Exists=5]="Exists"}(i||(i={})),function(e){e[e.And=0]="And",e[e.Or=1]="Or",e[e.Not=2]="Not"}(o||(o={})),function(e){e[e.Ascending=0]="Ascending",e[e.Descending=1]="Descending"}(s||(s={})),function(e){e[e.All=0]="All",e[e.ValidForCreate=1]="ValidForCreate",e[e.ValidForUpdate=2]="ValidForUpdate",e[e.ValidForRead=3]="ValidForRead"}(u||(u={})),function(e){e[e.None=0]="None",e[e.Related=1]="Related",e[e.Extended=2]="Extended"}(c||(c={})),function(e){e[e.None=0]="None",e[e.SingleQuotesURL=1]="SingleQuotesURL",e[e.DoubleQuotesURL=2]="DoubleQuotesURL",e[e.NoQuotesURL=3]="NoQuotesURL",e[e.Contract=4]="Contract",e[e.JsonifyURL=5]="JsonifyURL"}(l||(l={})),function(e){e[e.NewData=1]="NewData",e[e.ExistingData=2]="ExistingData"}(d||(d={}))},9227:function(e,t,r){"use strict";r.r(t),r.d(t,"ODataPrimitives",(function(){return h})),r.d(t,"OutputFormat",(function(){return n})),r.d(t,"buildEntityPayload",(function(){return O})),r.d(t,"transformToODataValue",(function(){return b})),r.d(t,"serializeEntityType",(function(){return y})),r.d(t,"getEnumValueMetadata",(function(){return g})),r.d(t,"encodeURIComponentForOData",(function(){return v})),r.d(t,"getAttributeBindForOData",(function(){return T}));var n,a=r(9048),i=r(9051),o=r(9046),s=r(9080),u=r(9083),c=r(9228),l=r(9220),d=r(9182),p=r(9198),f=r(9183),h=["Edm.Boolean","Edm.String","Edm.Byte","Edm.Decimal","Edm.Double","Edm.Int16","Edm.Int32","Edm.Int64","Edm.SByte","Edm.Single","Edm.Date","Edm.Guid","Edm.DateTimeOffset","Edm.Duration","Edm.Stream","Edm.Binary","Edm.TimeOfDay","Edm.Geography","Edm.GeographyPoint","Edm.GeographyLineString","Edm.GeographyPolygon","Edm.GeographyMultiPoint","Edm.GeographyMultiLineString","Edm.GeographyMultiPolygon","Edm.GeographyCollection","Edm.Geometry","Edm.GeometryPoint","Edm.GeometryLineString","Edm.GeometryPolygon","Edm.GeometryMultiPoint","Edm.GeometryMultiLineString","Edm.GeometryMultiPolygon","Edm.GeometryCollection"];function m(e,t,r){if(r){var n=Object(f.getEntityDescriptor)(e,t.entityType);return{"@odata.type":"Microsoft.Dynamics.CRM.".concat(t.entityType),[n.PrimaryKeyName]:o.Guid.fromExternalGuid(t.id).guid}}var a=Object(f.getEntitySetName)(e,t.entityType);return{"@odata.id":"".concat(a,"(").concat(o.Guid.fromExternalGuid(t.id).guid,")")}}function y(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(Object(u.IsNullOrUndefined)(t))return"null";if("object"==typeof t&&"entityType"in t&&"id"in t){var a=t,i=m(e,a,r),o=JSON.stringify(i);return n?v(o):o}var s=JSON.stringify(t);return n?v(s):s}function v(e){var t=encodeURIComponent(e);if(-1!==t.indexOf("'")){return t.replace(/\'/g,"''")}return t}function g(e,t){return null!=e&&t&&t.enumProperties&&t.enumProperties.length?t.enumProperties.filter(t=>t.value===e)[0]:null}function O(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n.Server,a=t.get_identifier(),i=a.LogicalName,u=[];if(t)if(r===n.Server){var c=t.get_changedFieldNames();c&&(u=c)}else u=t.get_fieldNames();var d=u.reduce((n,a)=>{var o=b(e,i,a,t,r),s=Object.keys(n),u=Object.keys(o)[0];return s&&-1!==s.indexOf(u)&&o[u]&&o[u].length?(n[u]=n[u].concat(o[u]),n):Object.assign(o,n)},{}),h=Object(f.getEntityDescriptor)(e,i);if(h&&h.IsActivity){var m=Object(l.getPartyListAttributeNames)(i),y=u.filter(e=>m.indexOf(e)>-1),v=m.filter(e=>-1===y.indexOf(e));if(y.length&&v.length){var g,T=[],C=null===(g=Object(p.createRecordSelector)(s.EntityReference.fromLegacyEntityReference(a)))||void 0===g?void 0:g(e,i);C&&C.fields&&function(){for(var t of v)if(t in C.fields){var r=C.fields[t].list.map(t=>{var r,n,a,i,u,c=null!==(r=t.fields)&&void 0!==r&&r.participationtypemask?Number((null===(n=t.fields)||void 0===n?void 0:n.participationtypemask).valueString):0,l=null===(a=t.fields)||void 0===a?void 0:a.partyid,d=null===(i=t.fields)||void 0===i?void 0:i.activitypartyid,p=d&&!o.Guid.isNullOrEmpty(d.id)?o.Guid.toString(d.id):void 0,f=l?l.reference:new s.EntityReference("unresolvedaddress",o.Guid.EMPTY,(null===(u=t.fields)||void 0===u?void 0:u.addressused).value);return S(e,c,f,p)});T.push(...r)}}();var N=E(e,i);N&&(d[N]?d[N].push(...T):0!==T.length&&(d[N]=T))}}var _=t.get_relatedEntities();return r===n.Client&&_&&_.get_entityCollections()&&_.get_entityCollections().forEach(t=>{var n=t.get_value().get_entities().map(t=>O(e,t,r)),a=n&&1===n.length&&Object(f.getManyToOneRelationshipByNavigationProperty)(e,i,t.get_key().get_schemaName())?n[0]:n;d[t.get_key().get_schemaName()]=a}),d}function E(e,t){var r=Object(f.getActivityPartyNavigationPropertyRelationship)(e,t);if(r&&r.ReferencedEntityNavigationPropertyName)return r.ReferencedEntityNavigationPropertyName}function b(e,t,r,p){var h=arguments.length>4&&void 0!==arguments[4]?arguments[4]:n.Server,m=p.getValue(r);if(!e||!t||!r||void 0===m||h===n.Client&&null===m)return{};var y=null,v={},g=p.get_fieldTypes(),O=null;if(g[r]===a.AttributeType.AliasedValue){var b=m;y=b.get_attributeType(),v["".concat(r,"@OData.Community.Display.V1.AttributeName")]=b.get_attributeLogicalName(),O=Object(d.getAttributeDescriptor)(e,b.get_entityLogicalName(),b.get_attributeLogicalName()),m=b.get_value()}else{if(!(O=Object(d.getAttributeDescriptor)(e,t,r)))return{};y=O.Type}switch(y){case a.AttributeType.MultiSelectPickList:if(Object(u.IsNullOrUndefined)(m))return{};var C=m.length>0?Array.isArray(m)?m.join(","):m:null;if(C&&h===n.Client){var N,_=O.OptionSet?null===(N=O)||void 0===N?void 0:N.OptionSet.length:0;v[Object(c.getFormattedValueAnnotation)(r)]=m.map(e=>{for(var t=0;t<_;t++){var r,n,a,i,o,s;if(e===(null===(r=O)||void 0===r||null===(n=r.OptionSet)||void 0===n||null===(a=n[t])||void 0===a?void 0:a.Value))return null===(i=O)||void 0===i||null===(o=i.OptionSet)||void 0===o||null===(s=o[t])||void 0===s?void 0:s.Label}return""}).join(";")}return v[r]=C,v;case a.AttributeType.PartyList:if(Object(u.IsNullOrUndefined)(m))return{};var R=m,P=R.get_entities(),I=E(e,t);if(!I)return{};var A=Object(l.getParticipationTypeMask)(t,r),D=P.map(t=>{var r=t.getValue("partyid"),n=t.getValue("activitypartyid"),a=n?n.toString():null,i=s.EntityReference.fromLegacyEntityReference(r);return S(e,A,i,a)});return v[I]=D,v;case a.AttributeType.Boolean:if(Object(u.IsNullOrUndefined)(m))return{};var M=m.get_ValueString();return h===n.Client&&(v[Object(c.getFormattedValueAnnotation)(r)]=m.get_Label()),v[r]="0"===M||"1"===M?"1"===M:null,v;case a.AttributeType.PickList:case a.AttributeType.State:case a.AttributeType.Status:return Object(u.IsNullOrUndefined)(m)?{}:(h===n.Client&&(v[Object(c.getFormattedValueAnnotation)(r)]=m.get_Label()),v[r]=m.getValue("value"),v);case a.AttributeType.Customer:case a.AttributeType.Lookup:case a.AttributeType.Owner:var F,w=Object(c.getLookupPropertyName)(r);if(Object(u.IsNullOrUndefined)(m))return{[w]:null};var L=m,j=Object(f.getEntitySetName)(e,L.LogicalName),x=null===(F=o.Guid.fromLegacyGuid(L.Id))||void 0===F?void 0:F.guid,U=null;if(y===a.AttributeType.Owner&&(U=Object(f.getManyToOneRelationshipByReferencedEntity)(e,t,"owner",r)),Object(u.IsNullOrUndefined)(U)&&(U=Object(f.getManyToOneRelationshipByReferencedEntity)(e,t,L.LogicalName,r)),y===a.AttributeType.Owner&&Object(u.IsNullOrUndefined)(U))return{};if(Object(u.IsNullOrUndefined)(U))throw new Error("Unable to find many-to-one relationship, entity: ".concat(t,", referenced entity: ").concat(L.LogicalName,", field: ").concat(r));return h===n.Server?v[T(U.ReferencingEntityNavigationPropertyName)]="/".concat(j,"(").concat(x,")"):(v[Object(c.getFormattedValueAnnotation)(w)]=L.Name,v[Object(c.getLookupLogicalNameAnnotation)(w)]=L.LogicalName,v[w]=x),v;case a.AttributeType.UniqueIdentifier:var k;return Object(u.IsNullOrUndefined)(m)?{}:(v[r]=null===(k=o.Guid.fromLegacyGuid(m))||void 0===k?void 0:k.guid,v);case a.AttributeType.Date:case a.AttributeType.DateTime:if(Object(u.IsNullOrUndefined)(m))return{[r]:null};if(O.Behavior===i.DateTimeFieldBehavior.DateOnly&&"function"==typeof m.toISOString){var q=m.toISOString().match(/(\d{4}-\d{2}-\d{2})T\d{2}\:\d{2}\:\d{2}\.\d{3}[+-Z]/i);q[1]&&(h===n.Client&&(v[Object(c.getFormattedValueAnnotation)(r)]=p.getFormattedValue(r)),v[r]=q[1])}else h===n.Client?(v[Object(c.getFormattedValueAnnotation)(r)]=p.getFormattedValue(r),v[r]=m.toISOString().replace(/.\d{3}Z/,"Z")):v[r]=m;return v;case a.AttributeType.Money:case a.AttributeType.Decimal:case a.AttributeType.Double:case a.AttributeType.Integer:case a.AttributeType.BigInt:if(h===n.Client){if(Object(u.IsNullOrUndefined)(m))return{};v[Object(c.getFormattedValueAnnotation)(r)]=p.getNumericFormattedValue(r)}return v[r]=m,v;default:return v[r]=m,v}}function T(e){return"".concat(e,"@odata.bind")}function S(e,t,r,n){var a=r.id.guid,i=r.etn;if("unresolvedaddress"===i){var o={addressused:r.name,participationtypemask:t};return Object(u.IsNullOrUndefined)(n)||(o.activitypartyid=n),o}var s=Object(f.getEntitySetName)(e,i),c=Object(f.getActivityPartyNavigationPropertyRelationship)(e,i);if(Object(u.IsNullOrUndefined)(c))throw new Error("Unable to find one-to-many relationship, entity: ".concat(i,", referencing entity: ").concat("activityparty"));var l={["".concat(c.ReferencingEntityNavigationPropertyName,"@odata.bind")]:"/".concat(s,"(").concat(a,")"),participationtypemask:t};return Object(u.IsNullOrUndefined)(n)||(l.activitypartyid=n),l}!function(e){e[e.Server=0]="Server",e[e.Client=1]="Client"}(n||(n={}))},9228:function(e,t,r){"use strict";r.r(t),r.d(t,"ADD_NOTIFICATIONS",(function(){return P})),r.d(t,"REMOVE_NOTIFICATIONS",(function(){return I})),r.d(t,"createEntityRecordFromResponse",(function(){return T})),r.d(t,"createEntityRecordFromResponseAsync",(function(){return S})),r.d(t,"determineReturnedColumns",(function(){return _})),r.d(t,"determineReturnedColumn",(function(){return R})),r.d(t,"getLookupPropertyName",(function(){return F})),r.d(t,"getLookupLogicalNameAnnotation",(function(){return w})),r.d(t,"getFormattedValueAnnotation",(function(){return L})),r.d(t,"PayloadFormat",(function(){return b})),r.d(t,"uniqueMerge",(function(){return N}));var n=r(9048),a=r(9055),i=r(9046),o=r(9084),s=r(9179),u=r(9080),c=r(9083),l=r(9199),d=r(9200),p=r(9207),f=r(9208),h=r(9209),m=r(9220),y=r(9182),v=r(9183),g=r(9051);function O(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function E(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){O(i,n,a,o,s,"next",e)}function s(e){O(i,n,a,o,s,"throw",e)}o(void 0)}))}}var b;function T(e,t,r,n,a,o,s,l,p){var f=arguments.length>9&&void 0!==arguments[9]?arguments[9]:b.OData,m=arguments.length>10?arguments[10]:void 0,y=s||r?r.PrimaryIdAttribute:void 0;a||(a=_(t,f)),-1===a.indexOf("versionnumber")&&t.hasOwnProperty("@odata.etag")&&a.push("versionnumber");var v=y&&"string"==typeof t[y]?new i.Guid(t[y]):i.Guid.EMPTY,g=new u.EntityReference(r.EntityLogicalName,v),O=u.EntityReference.toLegacyEntityReference(g),E=null;l&&!Object(c.IsNullOrUndefined)(l)&&(E=l.aliasedValueDescriptors);var T=A(e,a,r,n,t,E,p,m,f);return new d.EntityRecord(O,T.fields,T.fieldTypes,T.formattedValues,T.numericFormattedValues,new h.RelatedEntityCollection([]),o)}function S(e,t,r,n,a,i,o){var u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:b.OData,c=arguments.length>8?arguments[8]:void 0;return{type:"CREATE_ENTITY_RECORD_FROM_RESPONSE_ASYNC",execute:(l,d)=>E((function*(){var{getState:d,dispatch:p}=l,f=_(e,u),h=C(d(),t,r,f,i,c);yield p(Object(s.retrieveEntities)(h));var m=Object(y.getAttributesForEntity)(d(),t),g=Object(v.getEntityDescriptor)(d(),t),O=(r||[]).concat(h[t]?h[t].filter(e=>m.hasOwnProperty(e)):[]);return T(d(),e,g,m,O,n,a,i,o,u,c)}))()}}function C(e,t,r,n,i,s){var u,c=N(r,n).filter(e=>-1===e.indexOf("."));if(c&&c.length>0?i?(u=i.entity2AttributesMap?i.entity2AttributesMap:{},Object(o.addAttributes)(u,t,c)):u={[t]:c}:u={},s)for(var l of s){var d=l.get_relationShipName(),p=Object(v.getRelationShipByNavigationProperty)(e,t,d);if(p){var f=Object(v.getRelationshipTypeByNavigationProperty)(e,t,d)===a.RelationshipType.OneToManyRelationship?p.ReferencingEntity:p.ReferencedEntity,h=l.get_columnNames();Object(o.addAttributes)(u,f,h)}}return u}function N(e,t){var r=new Set(e||[]),n=e&&e.slice(0)?e.slice(0):[];if(t)for(var a of t)r.has(a)||n.push(a);return n}function _(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:b.OData,r=Object.keys(e).reduce((e,r)=>(-1===r.indexOf("@")&&e.add(R(r,t)),e),new Set);return Array.from(r)}function R(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:b.OData,r=null;return(r=t===b.OData?e.match(/_(\w+)_value/i):e.match(/(\w+\.?\w+)!(id|name|logicalname)$/i))&&r[1]?r[1]:e}!function(e){e[e.OData=0]="OData",e[e.SQL=1]="SQL"}(b||(b={}));var P="notifications.add",I="notification.remove";function A(e,t,r,a,i,o,s,u){var l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:b.OData,d={fieldTypes:{},formattedValues:{},numericFormattedValues:{},fields:{}},p=function(t){if(Object(c.IsNullOrUndefinedOrEmptyString)(t)){var p=[{name:"EntityLogicalName",value:null!=r?r.EntityLogicalName:"null"}];return s&&s.warn("Empty field name encountered while trying to construct entity record",p),"continue"}if("versionnumber"===t){var f=n.AttributeType.BigInt;d.fields[t]=j(e,i,t,f,r,a,!1,o,s,l),d.fieldTypes[t]=f}else if(u&&i&&i.hasOwnProperty(t)&&i[t]&&u.filter(e=>e.get_relationShipName()===t).length>0)D(e,t,r,i,d,s,u);else{var h=!1,y=!!o&&o.hasOwnProperty(t);if(!y&&null==a[t])return"continue";var v=i.hasOwnProperty(x(t,i,o,y));if(v||(v=i.hasOwnProperty(k(t,l,y))),!v){var g=U(e,t,r,i,o,y);h=v=g&&i.hasOwnProperty(g)&&i[g].filter(e=>e.participationtypemask===Object(m.getParticipationTypeMask)(y&&o?o[t].aliasedValueEtn:r.EntityLogicalName,y&&o?o[t].aliasedValueFieldName:t)).length>0}if(v){var O,E=y?n.AttributeType.AliasedValue:a[t].Type,b=!(!o||null===(O=o[t])||void 0===O||!O.isAttributeAlias),T=x(t,i,o,y&&b),S=!!(y&&o&&o[t]&&o[t].oDataAlias.length>1),C=x(t,i,o,S);d.fields[T]=j(e,i,C,E,r,a,h,y?o:null,s,l),d.fieldTypes[T]=E,M(e,C,d,i,l,a,E)}}};for(var f of t)p(f);return d}function D(e,t,r,o,s,c,l){if(l)for(var p of l){var f=void 0,m=p.get_relationShipName();if(m===t){var g=Object(v.getRelationShipByNavigationProperty)(e,r.EntityLogicalName,m);if(g){var O=Object(v.getRelationshipTypeByNavigationProperty)(e,r.EntityLogicalName,m),E=O===a.RelationshipType.OneToManyRelationship?g.ReferencingEntity:g.ReferencedEntity,b=p.get_columnNames(),T=Object(y.getAttributesForEntity)(e,E);if(T){var S=[],C=Object(v.getEntityDescriptor)(e,E),N=null==C?void 0:C.PrimaryKeyName;if(O===a.RelationshipType.OneToManyRelationship){var _=o[m];for(var R of _){var P={fieldTypes:{},formattedValues:{},numericFormattedValues:{},fields:{}},I=new i.Guid(R[N]),A=new u.EntityReference(null==C?void 0:C.EntityLogicalName,I),D=u.EntityReference.toLegacyEntityReference(A);if(b)for(var M of b)if(T.hasOwnProperty(M)){var F=j(e,R,M,f=T[M].Type,C,T,!1,null,c);P.fields[M]=F,P.fieldTypes[M]=f}var w=new d.EntityRecord(D,P.fields,P.fieldTypes,P.formattedValues,P.numericFormattedValues,new h.RelatedEntityCollection([]));S.push(w)}}else if(O===a.RelationshipType.ManyToOneRelationship){var L=o[m],x={fieldTypes:{},formattedValues:{},numericFormattedValues:{},fields:{}},U=new i.Guid(L[N]),k=new u.EntityReference(null==C?void 0:C.EntityLogicalName,U),q=u.EntityReference.toLegacyEntityReference(k);if(b)for(var V of b)if(T.hasOwnProperty(V)){f=T[V].Type;var B=j(e,o[t],V,f,C,T,!1,null,c);x.fields[V]=B,x.fieldTypes[V]=f}var H=new d.EntityRecord(q,x.fields,x.fieldTypes,x.formattedValues,x.numericFormattedValues,new h.RelatedEntityCollection([]));S.push(H)}s.fields[m]=S,s.fieldTypes[m]=n.AttributeType.NavigationProperty}}}}}function M(e,t,r,n,a,i,o){if(a===b.OData){var s=L(t);n.hasOwnProperty(s)&&(r.formattedValues[t]=n[s])}}function F(e){return"_".concat(e,"_value")}function w(e){return"".concat(e,"@Microsoft.Dynamics.CRM.lookuplogicalname")}function L(e){return"".concat(e,"@OData.Community.Display.V1.FormattedValue")}function j(e,t,r,a,o,s,l,d,h){var m,O=arguments.length>9&&void 0!==arguments[9]?arguments[9]:b.OData,E=k(r,O);if("versionnumber"===r&&O===b.OData&&t["@odata.etag"]){var T=t["@odata.etag"].match(/W\/\"([0-9a-zA-Z]+)\"/);if(T&&T[1])return T[1]}if(!(l||t.hasOwnProperty(r)||t.hasOwnProperty(E)||d))return null;var S=null;if(s&&s[r]&&-1!==[n.AttributeType.Lookup,n.AttributeType.Customer,n.AttributeType.Owner].indexOf(s[r].Type))d&&d.hasOwnProperty(r)&&(E=k(r,O,!0)),m=t[E];else if(s&&s[r]){var C=B(d,t,r),N=d&&d[r]&&d[r].oDataAlias&&d[r].oDataAlias[C]||r;if(S=d&&d[r]&&d[r].rowaggregate||null,m=t[N],d&&d[r]&&d[r].isAttributeAlias&&Object(c.IsNullOrUndefined)(S))return m}else m=t[r];if(!l&&null===m)return null;switch(a){case n.AttributeType.AliasedValue:if(d){var _,{aliasedValueEtn:R,aliasedValueFieldName:P}=d[r],I=Object(v.getEntityDescriptor)(e,R),A=Object(y.getAttributeDescriptor)(e,R,P);_=S&&"CountChildren"===S?n.AttributeType.Integer:null==A?void 0:A.Type;var D=new p.LegacyAliasedValue(R,P,_);return null==(m=j(e,t,r,_,I,{[r]:A},l,d,h,O))?null:(D.set_value(m),D)}return null;case n.AttributeType.Customer:case n.AttributeType.Lookup:case n.AttributeType.Owner:var M=t[q(r,E,O)],F=t[V(r,E,O)];if(M&&m)return u.EntityReference.toLegacyEntityReference(new u.EntityReference(M,new i.Guid(m),F));var w=[];return w.push({name:"EntityLogicalName",value:null==s[r]?"null":s[r].EntityLogicalName}),w.push({name:"Attribute Name",value:null==s[r]?"null":s[r].LogicalName}),w.push({name:"Lookup Field EntityLogicalName",value:null==M?"null":M}),w.push({name:"FieldValue",value:null==m?"null":m}),w.push({name:"lookupFormattedValue",value:null==F?"null":F}),G("_constructFieldValue: Lookup Field EntityLogicalName or FieldValue is null",w),null;case n.AttributeType.UniqueIdentifier:var x=i.Guid.tryParseOrNull(m);return x?i.Guid.toLegacyGuid(x):null;case n.AttributeType.DateTime:var U;return O===b.OData&&(U=s&&s[r]&&s[r].Behavior===g.DateTimeFieldBehavior.TimeZoneIndependent?m.replace(/-\d{2}:\d{2}$/,"Z"):m),Object(c.IsNullOrUndefinedOrEmptyString)(m)?null:new Date(Date.parse(U));case n.AttributeType.Status:case n.AttributeType.State:case n.AttributeType.Boolean:case n.AttributeType.PickList:var Q,z=t[L(r)],X=s[r].OptionSet;return X&&(null==m&&X.DefaultValue&&-1!==X.DefaultValue&&(m=X.DefaultValue),null!=m&&(Q=X.find(e=>Number(e.Value)===Number(m)))),Q?new f.OptionMetadata(z||Q.Label,Q.Value,null,null,null,Q.Color,null):new f.OptionMetadata(z,m,null,null,null,null,null);case n.AttributeType.PartyList:return H(e,r,t,o,d,null!=d&&null!=d[r]);default:return m}}function x(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(n&&r&&r[e]){var a=B(r,t,e);return r[e].oDataAlias[a]}return e}function U(e,t,r,n,a){var i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=i?a[t].aliasedValueEtn:r.EntityLogicalName,s=Object(v.getActivityPartyNavigationPropertyRelationship)(e,o);if(!s)return null;if(i){var u=B(a,n,t),c=a[t].alias,l=a[t].oDataSeparator[u];return"".concat(c).concat(l).concat(s.ReferencedEntityNavigationPropertyName)}return"".concat(s.ReferencedEntityNavigationPropertyName)}function k(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:b.OData,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return t===b.OData?r?e:F(e):"".concat(e,"!id")}function q(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:b.OData;return r===b.OData?w(t):"".concat(e,"!logicalname")}function V(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:b.OData;return r===b.OData?L(t):"".concat(e,"!name")}function B(e,t,r){if(e&&e.hasOwnProperty(r)&&e[r].oDataAlias.length>0)for(var n=0;n<e[r].oDataAlias.length;n++)if(t.hasOwnProperty(e[r].oDataAlias[n]))return n;return 0}function H(e,t,r,n,a){var i=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(n&&n.OneToManyRelationships){var o=U(e,t,n,r,a,i);if(!o)return null;var s=r[o];if(!s)return null;var u=Object(v.getEntityDescriptor)(e,"activityparty"),c=Object(y.getAttributesForEntity)(e,"activityparty"),d=Object.keys(c),p=s.filter(e=>e.participationtypemask===Object(m.getParticipationTypeMask)(i?a[t].aliasedValueEtn:n.EntityLogicalName,i?a[t].aliasedValueFieldName:t)).map(t=>T(e,t,u,c,d));return new l.EntityCollection(p,!1,p.length,!1,null,null)}return new l.EntityCollection([],!1,0,!1,null,null)}function G(e,t,r){null==r||r.error(e,t)}},9229:function(e,t,r){"use strict";r.r(t),r.d(t,"MetadataQuery",(function(){return a}));var n=r(9214);class a{constructor(){this.MetadataType=void 0,this.MetadataSubtype=void 0,this.EntityLogicalName=void 0,this.MetadataId=void 0,this.MetadataNames=void 0,this.GetDefault=void 0,this.DependencyDepth=void 0,this.ChangedAfter=void 0,this.Exclude=void 0,this.AppId=void 0}getMetadata(){return{boundParameter:null,operationName:null,operationType:null,parameterTypes:{MetadataType:{typeName:"Edm.String",structuralProperty:n.ODataStructuralProperty.PrimitiveType},MetadataSubtype:{typeName:"Edm.String",structuralProperty:n.ODataStructuralProperty.PrimitiveType},EntityLogicalName:{typeName:"Edm.String",structuralProperty:n.ODataStructuralProperty.PrimitiveType},MetadataId:{typeName:"Edm.Guid",structuralProperty:n.ODataStructuralProperty.PrimitiveType},MetadataName:{typeName:"Edm.String",structuralProperty:n.ODataStructuralProperty.PrimitiveType},MetadataNames:{typeName:"Edm.String",structuralProperty:n.ODataStructuralProperty.Collection},GetDefault:{typeName:"Edm.Boolean",structuralProperty:n.ODataStructuralProperty.PrimitiveType},DependencyDepth:{typeName:"Microsoft.Dynamics.CRM.DependencyDepth",structuralProperty:n.ODataStructuralProperty.EnumerationType,enumProperties:[,{name:"Unknown",value:0},{name:"OnDemandWithContext",value:1},{name:"OnDemandWithoutContext",value:2},{name:"OnDemandContextOnly",value:3},{name:"Offline",value:4},{name:"Mobile",value:5},{name:"UserContext",value:6}]},ChangedAfter:{typeName:"Edm.String",structuralProperty:n.ODataStructuralProperty.PrimitiveType},Exclude:{typeName:"Edm.Guid",structuralProperty:n.ODataStructuralProperty.Collection},AppId:{typeName:"Edm.Guid",structuralProperty:n.ODataStructuralProperty.PrimitiveType}}}}}},9230:function(e,t,r){"use strict";r.r(t),r.d(t,"OPERATION",(function(){return a})),r.d(t,"UNKNOWN_TYPE",(function(){return i})),r.d(t,"OPERATION_SOURCE",(function(){return o})),r.d(t,"OPERATION_TYPE",(function(){return s})),r.d(t,"getRequestSource",(function(){return u}));var n=r(9047),a={TYPE:n.EVENT_PARAMETERS.OPERATION_TYPE,SUB_TYPE:n.EVENT_PARAMETERS.OPERATION_SUB_TYPE,SOURCE:n.EVENT_PARAMETERS.OPERATION_SOURCE},i="Unknown",o={Default:"Default"},s={UPDATE:"Update",CREATE:"Create",DELETE:"Delete",RETRIEVE:"Retrieve",RETRIEVE_MULTIPLE:"RetrieveMultiple",Execution_Multiple:"ExecutionMultiple",ACTION:"Action",FUNCTION:"Function",GCM:"GetClientMetadata",SCM:"SyncClientMetadata",ENTITY_DEFINITION:"EntityDefinition",EXTERNAL_SEARCH:"ExternalSearch"};function u(e){var t=o.Default;return e.OperationSource&&(t=e.OperationSource),t}},9231:function(e,t,r){"use strict";r.r(t),r.d(t,"buildBatchRequest",(function(){return s}));var n=r(9045),a=r(9193);function i(e,t){var r="",n=1;for(var a of t){if(a.serializationFailure)throw a.serializationFailure;r+="--"+e+"\n",r+="Content-Type: application/http\nContent-Transfer-Encoding: binary\n",r+="Content-ID: "+n+++"\n",r+="\n",r+=o(a)}return r+="--"+e+"--\n"}function o(e){var t="".concat(e.method," ").concat(e.urlParameters," HTTP/1.1\n");for(var r in e.additionalHeaders)r!==n.HEADER.CONTENT_TYPE&&"GET"!==e.method&&(t+="".concat(r,": ").concat(e.additionalHeaders[r],"\n"));return"GET"!==e.method&&(t+="".concat(n.HEADER.CONTENT_TYPE,": application/json;type=entry\n")),t+="\n",e.body&&(t+=e.body,t+="\n"),t}function s(e,t,r){if(!e||!e.length)return{serializationFailure:"Attempted to create an OData batch with empty list of requests"};var s="";for(var c of(r||(r=u("batch")),e)){s+="--"+r+"\n";var l="";if(Array.isArray(c)){var d=c,p=u("changeset");l=i(p,d),s+="Content-Type: multipart/mixed;boundary=".concat(p,"\n")}else{var f=c;if(f.serializationFailure)return f;l=o(f),s+="Content-Type: application/http\nContent-Transfer-Encoding: binary\n"}s+="\n",s+=l,s+="\n"}var h="--".concat(r,"--\r\n\0");return s.endsWith(h+"\n")?s=s.substr(0,s.length-1):s+=h,{urlParameters:"$batch",additionalHeaders:{[n.HEADER.CONTENT_TYPE]:"multipart/mixed;boundary=".concat(r),Accept:a.HEADER_VALUES.APPLICATION_JSON},body:s,method:"POST"}}function u(e){return"".concat(e,"_").concat(new Date(Date.now()).getTime())}},9232:function(e,t,r){"use strict";r.r(t),r.d(t,"Expression",(function(){return c})),r.d(t,"QueryOptionsFormat",(function(){return n}));var n,a=r(9233),i=r(9234),o=r(9235),s=r(9046),u=r(9140);class c{constructor(e){this._operator=void 0,this._terms=void 0,this._hint="",this._operator=e;for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];this._terms=r}get operator(){return this._operator}set operator(e){this._operator=e}get hint(){return this._hint}set hint(e){this._hint=e}get terms(){return this._terms}set terms(e){this._terms=e}static _isSimpleCondition(e){return e.terms.every(e=>!Object(a.isExpression)(e))}static _toLegacyConditionParameters(e){var t,r="",n="";for(var i of e.terms)Object(a.isAttributeTerm)(i)?r=i.attributeName:Object(a.isValueTerm)(i)?t=i.value:Object(a.isEntityNameTerm)(i)&&(n=i.entityName);return{attributeName:r,operator:e.operator,value:t,entityName:n}}static toLegacyFilterExpression(e,t){var r="or"===e.operator?i.LogicalOperator.Or:i.LogicalOperator.And,n=s.Guid.newGuid().guid,a=new o.FilterExpression(r,n,null,t?null:e.hint);if(c._isSimpleCondition(e)){var{attributeName:u,operator:l,value:d,entityName:p}=c._toLegacyConditionParameters(e);a.addCondition(u,l,d,p)}else{var f=t;for(var h of e.terms)a.addFilterExpression(c.toLegacyFilterExpression(h,f)),f=f||!!h.hint}return a}static isSimpleCondition(e){return e.terms.every(e=>!Object(a.isExpression)(e))}static getHintFromExpression(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.Hints,r="";if(null==e||!e.terms||0===e.terms.length)return"";if(this.isSimpleCondition(e))return this.getODataUriForSimpleCondition(e,t);if(1===e.terms.length){var a,i=null===(a=e.operator)||void 0===a?void 0:a.toLowerCase();switch(i){case u.LogicalOperatorString.and:case u.LogicalOperatorString.or:return this.getHintFromExpression(e.terms[0],t);case u.LogicalOperatorString.not:return r="".concat(this.getHintFromExpression(e.terms[0],t)),this.isSimpleCondition(e.terms[0])||(r="(".concat(r,")")),r;default:throw new Error("Invalid logical operator ".concat(i,"."))}}else{r=this.getHintFromExpression(e.terms[0],t),this.isSimpleCondition(e.terms[0])||(r="(".concat(r,")"));for(var o=1;o<e.terms.length;o++){var s=this.getHintFromExpression(e.terms[o],t);this.isSimpleCondition(e.terms[o])||(s="(".concat(s,")")),r="".concat(r," ").concat(e.operator," ").concat(s)}}return r}static getODataUriForSimpleCondition(e,t){var r,i=e.terms.find(e=>Object(a.isAttributeTerm)(e)),o=e.terms.find(e=>Object(a.isValueTerm)(e));if(t===n.Hints)return this.getHintsForSimpleCondition(e);switch(e.operator){case"like":r="Contains";break;case"in":r="In";break;case"equalsUserId":r="EqualUserId"}switch(e.operator){case"eq":case"ne":case"gt":case"ge":case"lt":case"le":var s="number"==typeof(null==o?void 0:o.value)?o.value:"'".concat(null==o?void 0:o.value,"'");return"".concat(i.attributeName," ").concat(e.operator," ").concat(s);case"like":case"in":case"equalsUserId":var u,c=["PropertyName=@p1"],l=["&@p1='".concat(i.attributeName,"'")];if(o)Array.isArray(o.value)?(c.push("PropertyValues=@p2"),u="&@p2=["+o.value.map(e=>"'".concat(e,"'")).join(",")+"]"):(c.push("PropertyValue=@p2"),u="&@p2='".concat(o.value,"'")),l.push(u);return"Microsoft.Dynamics.CRM.".concat(r,"(").concat(c.join(","),")").concat(l.join(""));default:throw Error("Unsupported expression operation type ".concat(e.operator))}}static getHintsForSimpleCondition(e){var t=e.terms.find(e=>Object(a.isAttributeTerm)(e)),r=e.terms.find(e=>Object(a.isValueTerm)(e));return null!=r&&r.value?"".concat(t.attributeName," ").concat(e.operator," '").concat(r.value,"'"):"".concat(t.attributeName," ").concat(e.operator)}}!function(e){e[e.Hints=0]="Hints",e[e.ODataUri=1]="ODataUri"}(n||(n={}))},9233:function(e,t,r){"use strict";function n(e){return!!e.attributeName}function a(e){return null!==e.value&&void 0!==e.value}function i(e){return!!e.entityName}function o(e){return!!e.terms}r.r(t),r.d(t,"isAttributeTerm",(function(){return n})),r.d(t,"isValueTerm",(function(){return a})),r.d(t,"isEntityNameTerm",(function(){return i})),r.d(t,"isExpression",(function(){return o}))},9234:function(e,t,r){"use strict";var n;r.r(t),r.d(t,"LogicalOperator",(function(){return n})),function(e){e[e.And=0]="And",e[e.Or=1]="Or",e[e.Not=2]="Not"}(n||(n={}))},9235:function(e,t,r){"use strict";r.r(t),r.d(t,"FilterExpression",(function(){return s}));var n=r(9236),a=r(9234),i=r(9237),o=r(9083);class s{constructor(e,t,r,n){this._FilterExpressionId=void 0,this._FilterOperator=0,this._IsQuickFindFields=!1,this._Hint=void 0,this._Conditions=void 0,this._FilterExpressions=void 0,this._set_filterOperator(e),this.set_filterExpressionId(t),this._set_filterExpressions([]),Object(o.IsNullOrUndefined)(r)?this._set_isQuickFindFields(!1):this._set_isQuickFindFields(r),Object(o.IsNullOrUndefined)(n)?this._set_hint(null):this._set_hint(n)}get_filterExpressionId(){return this._FilterExpressionId}set_filterExpressionId(e){this._FilterExpressionId=e}get_filterOperator(){return this._FilterOperator}_set_filterOperator(e){return this._FilterOperator=e,e}get_isQuickFindFields(){return this._IsQuickFindFields}_set_isQuickFindFields(e){return this._IsQuickFindFields=e,e}get_hint(){return this._Hint}_set_hint(e){this._Hint=e}get_conditions(){return this._Conditions}_set_conditions(e){return this._Conditions=e,e}get_filterExpressions(){return this._FilterExpressions}_set_filterExpressions(e){return this._FilterExpressions=e,e}addCondition(e,t,r,a,i){r=r,i=Object(o.IsNullOrUndefined)(i)?"":i;var s=new n.Condition(e,t,r);return s.set_entityName(a),s.set_conditionName(i),this.get_conditions()||this._set_conditions([]),this.get_conditions().push(s),this}addFilterExpression(e){return e?(this.get_filterExpressions()||this._set_filterExpressions([]),this.get_filterExpressions().push(e),this):this}clone(){var e=new s(this.get_filterOperator(),this.get_filterExpressionId());if(this.get_conditions()){e._set_conditions([]);for(var t=0;t<this.get_conditions().length;t++)e.get_conditions().push(this.get_conditions()[t].clone())}else e._set_conditions(null);if(this.get_filterExpressions()){e._set_filterExpressions([]);for(var r=0;r<this.get_filterExpressions().length;r++)e.get_filterExpressions().push(this.get_filterExpressions()[r].clone())}else e._set_filterExpressions(null);return e}toFetchXml(){return s._CreateXmlFilter(this)}static _CreateXmlFilter(e){var t="";if(!e||!(e.get_filterExpressions()&&e.get_filterExpressions().length||e.get_conditions()&&e.get_conditions().length))return t;if(e.get_conditions()){e.get_conditions().length>0&&(t+='<filter type="'+a.LogicalOperator[e.get_filterOperator()].toLowerCase()+'"',e.get_isQuickFindFields()&&(t+=' isquickfindfields="1"'),t+=">",Object(o.IsNullOrUndefinedOrEmptyString)(e.get_hint())||(t+=' hint="'+e.get_hint().toLowerCase()+'"'));for(var r=0;r<e.get_conditions().length;r++){var n=e.get_conditions()[r];if(t+="<condition ",Object(o.IsNullOrUndefinedOrEmptyString)(n.get_entityName())||(t+='entityname="'+n.get_entityName()+'" '),n.get_value())if("string"==typeof n.get_value())t+='attribute="'+n.get_attributeName()+'" operator="'+n.get_operator()+'" value="'+Object(i.xmlAttributeEncode)(n.get_value())+'" />';else{var u=n.get_value();t+='attribute="'+n.get_attributeName()+'" operator="'+n.get_operator()+'">';for(var c=0;c<u.length;c++)t+="<value>"+Object(i.xmlEncode)(u[c])+"</value>";t+="</condition>"}else t+='attribute="'+n.get_attributeName()+'" operator="'+n.get_operator()+'"/>'}e.get_conditions().length>0&&(t+="</filter>")}else{e.get_filterExpressions().length>1&&(t+='<filter type="'+a.LogicalOperator[e.get_filterOperator()].toLowerCase()+'"',e.get_hint()&&(t+=' hint="'+e.get_hint().toLowerCase()+'"'),t+=">");for(var l=0;l<e.get_filterExpressions().length;l++)t+=s._CreateXmlFilter(e.get_filterExpressions()[l]);e.get_filterExpressions().length>1&&(t+="</filter>")}return t}}},9236:function(e,t,r){"use strict";r.r(t),r.d(t,"Condition",(function(){return a}));var n=r(9083);class a{constructor(e,t,r){this._entityName=void 0,this._AttributeName=void 0,this._Operator=void 0,this._Value=void 0,this._ConditionName=void 0,this._set_attributeName(e),this.set_operator(t),this.set_value(r)}get_entityName(){return Object(n.IsNullOrUndefined)(this._entityName)&&(this._entityName=""),this._entityName}set_entityName(e){return this._entityName=e,e}get_attributeName(){return this._AttributeName}_set_attributeName(e){return this._AttributeName=e,e}get_operator(){return this._Operator}set_operator(e){return this._Operator=e,e}get_value(){return this._Value}set_value(e){this._Value=e}_get_conditionName(){return this._ConditionName}set_conditionName(e){return this._ConditionName=e,e}clone(){var e=new a(this.get_attributeName(),this.get_operator(),this.get_value());return e.set_entityName(this.get_entityName()),e.set_conditionName(this._get_conditionName()),e}}},9237:function(e,t,r){"use strict";r.r(t),r.d(t,"xmlAttributeEncode",(function(){return a})),r.d(t,"xmlEncode",(function(){return i})),r.d(t,"urlEncode",(function(){return o}));var n=r(9083);function a(e){return Object(n.IsNullOrUndefined)(e)?"":u(e)}function i(e){return Object(n.IsNullOrUndefined)(e)?"":u(e)}function o(e){return""}function s(e){return"CRMEntityReferenceOpen"+(1024*(e.charCodeAt(0)-55296)+(1023&e.charCodeAt(1))+65536).toString(16)+"CRMEntityReferenceClose"}function u(e,t){if(Object(n.IsNullOrUndefinedOrEmptyString)(e))return e;if("string"!=typeof e&&(e=e),null!=t){t.length>1&&(t=t.charAt(0));var r=c(t),a=new RegExp(t,"g");return e.replace(a,r)}return function(e,t){return e=(e=(e=t(e=(e=e.replace(new RegExp("([\\uD800-\\uDBFF][\\uDC00-\\uDFFF])","g"),s)).replace(new RegExp("[\\uD800-\\uDFFF]","g"),""))).replace(/CRMEntityReferenceOpen/g,"&#x")).replace(/CRMEntityReferenceClose/g,";")}(e,c)}function c(e){return function(e){var t,r="",n="",a=0;if(null===e)return null;if(""===e)return"";for(var i=0;i<e.length;i++)n+=(t=e.charCodeAt(i))>96&&t<123||t>64&&t<91||32===t||t>47&&t<58||46===t||44===t||45===t||95===t?String.fromCharCode(t):"&#"+t+";",500==++a&&(r+=n,n="",a=0);return n.length&&(r+=n),r}(e)}},9238:function(e,t,r){"use strict";r.r(t),r.d(t,"getAppDescriptor",(function(){return i})),r.d(t,"getAppContext",(function(){return o})),r.d(t,"getCurrentAppId",(function(){return s})),r.d(t,"getCurrentAppUniqueNameOrDefault",(function(){return u})),r.d(t,"getCurrentAppAppSetting",(function(){return c})),r.d(t,"isOfflineByDefaultEnabledForApp",(function(){return l}));var n=r(9239),a=r(9240);function i(e){return e&&e.metadata&&e.metadata.appContext?e.metadata.appContext:null}function o(e){var t=i(e);return t&&t.app?t.app:null}function s(e){var t=o(e);return t&&t.appId?t.appId:null}function u(e){var t=o(e);return t&&t.uniqueName?t.uniqueName:e&&e.configuration&&e.configuration.isD365DefaultApp?"d365custom":"__ unavailable__"}function c(e,t){var r,n,a=o(t);return void 0===(null==a||null===(r=a.appSettings)||void 0===r||null===(n=r[e])||void 0===n?void 0:n.value)?null:a.appSettings[e].value}function l(e){return!1===c("ServerMode",e)&&Object(a.isFeatureEnabledByFCBName)(e,n.OfflineByDefault)}},9239:function(e,t,r){"use strict";r.r(t),r.d(t,"IsGetClientMetadataExEnabled",(function(){return n})),r.d(t,"GCMOptimizationByEntityMetadataReduction",(function(){return a})),r.d(t,"BrowserOfflineEnabledForTest",(function(){return i})),r.d(t,"MDLBrowserOfflineEnabledForTest",(function(){return o})),r.d(t,"OfflineByDefault",(function(){return s})),r.d(t,"ModernDataLayerDev",(function(){return u})),r.d(t,"BatchRequestForLongFetchXml",(function(){return c}));var n="IsGetClientMetadataExEnabled",a="GCMOptimizationByEntityMetadataReduction",i="BrowserOfflineEnabledForTest",o="MDLBrowserOfflineEnabledForTest",s="OfflineByDefault",u="ModernDataLayerDev",c="BatchRequestForLongFetchXml"},9240:function(e,t,r){"use strict";function n(e,t){var r=e?e.fcbs:void 0;if(r){var n=r.clientFCBs;if(n)return t in n&&(n[t]||function(e,t){var r=e.fcbs;if(r){var n=r.nativeFCBContext;if(n&&t in n)return n[t]}return!1}(e,t))}return!1}r.r(t),r.d(t,"isFeatureEnabledByFCBName",(function(){return n}))},9241:function(e,t,r){"use strict";r.r(t),r.d(t,"getClientHost",(function(){return o})),r.d(t,"getClientHostName",(function(){return s})),r.d(t,"getClientHostVersionString",(function(){return u})),r.d(t,"getClientHostSubtypeNameForTelemetry",(function(){return l}));var n=r(9045),a=r(9242),i=r(9243);function o(e){return e&&e.clientHost?e.clientHost.type:a.ClientHost.Unknown}function s(e){return function(e){switch(e){case a.ClientHost.Browser:return"Browser";case a.ClientHost.MobileApplication:return"MobileApplication";case a.ClientHost.MailApp:return"MailApp";default:return n.UNKNOWN}return n.UNKNOWN}(o(e))}function u(e){var t=function(e){return e&&e.clientHost?e.clientHost.version:null}(e);return t&&t.version?t.version+"."+t.build+" ("+t.revision+","+t.nativeRevision+")":""}function c(e){switch(function(e){return e&&e.clientHost?e.clientHost.subtype:i.ClientHostSubtype.Unknown}(e)){case i.ClientHostSubtype.Phone:return"Phone";case i.ClientHostSubtype.Tablet:return"Tablet";default:return n.UNKNOWN}return""}function l(e){var t,r=null==e||null===(t=e.session)||void 0===t?void 0:t.hostSubtype;return r||c(e)}},9242:function(e,t,r){"use strict";var n;r.r(t),r.d(t,"ClientHost",(function(){return n})),function(e){e[e.Browser=1]="Browser",e[e.MobileApplication=2]="MobileApplication",e[e.MailApp=3]="MailApp",e[e.Unknown=4]="Unknown"}(n||(n={}))},9243:function(e,t,r){"use strict";var n;r.r(t),r.d(t,"ClientHostSubtype",(function(){return n})),function(e){e[e.Phone=1]="Phone",e[e.Tablet=2]="Tablet",e[e.Unknown=3]="Unknown"}(n||(n={}))},9244:function(e,t,r){"use strict";r.r(t),r.d(t,"getOfflineDisabledEntities",(function(){return i})),r.d(t,"getOfflineEnabledEntities",(function(){return o})),r.d(t,"isEntityAvailableForOfflineUsage",(function(){return s}));var n=r(9245),a=r(9246);function i(e){return e&&e.offline&&e.offline.client&&e.offline.client.offlineDisabledEntities?e.offline.client.offlineDisabledEntities:null}function o(e){var t=Object(n.getOfflineProfileAvailableEntities)(e)||[],r=i(e)||[];return t.filter(e=>-1===r.indexOf(e))}function s(e,t){return Object(a.isOfflineAvailableForUse)(e)&&-1!==o(e).indexOf(t)}},9245:function(e,t,r){"use strict";function n(e){return e&&e.offline&&e.offline.server&&e.offline.server.profileAvailableEntities?e.offline.server.profileAvailableEntities:null}r.r(t),r.d(t,"getOfflineProfileAvailableEntities",(function(){return n}))},9246:function(e,t,r){"use strict";r.r(t),r.d(t,"getOfflineClient",(function(){return c})),r.d(t,"getOfflineFeatureStatus",(function(){return l})),r.d(t,"getOfflineStatus",(function(){return d})),r.d(t,"isOfflineAvailableForUse",(function(){return p})),r.d(t,"getIsOfflineEnabled",(function(){return f})),r.d(t,"isOfflineByDefaultAvailableForUse",(function(){return h}));var n=r(9083),a=r(9247),i=r(9248),o=r(9238),s=r(9249),u=r(9252);function c(e){var t;return null==e||null===(t=e.offline)||void 0===t?void 0:t.client}function l(e){var t=c(e);return t&&!Object(n.IsNullOrUndefined)(t.offlineFeatureStatus)?t.offlineFeatureStatus:null}function d(e){var t=c(e);return t&&!Object(n.IsNullOrUndefined)(t.status)?t.status:null}function p(e){return l(e)===a.MobileOfflineFeatureStatus.Enabled&&d(e)===i.OfflineStatus.Available&&Object(s.getIsCodeCacheReady)(e)}function f(e){return l(e)!==a.MobileOfflineFeatureStatus.Disabled&&Object(u.getIsMocaOfflineFeatureEnabled)(e)}function h(e){return Object(o.isOfflineByDefaultEnabledForApp)(e)&&p(e)}},9247:function(e,t,r){"use strict";var n;r.r(t),r.d(t,"MobileOfflineFeatureStatus",(function(){return n})),function(e){e[e.Default=0]="Default",e[e.Enabled=1]="Enabled",e[e.Disabled=2]="Disabled"}(n||(n={}))},9248:function(e,t,r){"use strict";var n;r.r(t),r.d(t,"OfflineStatus",(function(){return n})),function(e){e[e.NotAvailable=0]="NotAvailable",e[e.Initializing=1]="Initializing",e[e.Available=2]="Available"}(n||(n={}))},9249:function(e,t,r){"use strict";r.r(t),r.d(t,"getIsCacheModeEnabled",(function(){return i})),r.d(t,"getIsCodeCacheReady",(function(){return o}));var n=r(9250),a=r(9251);function i(e){var t;return!(null===(t=e.cache)||void 0===t||!t.isCacheEnabled)}function o(e){var t;return!!Object(n.isBrowserOfflineEnabled)(e)||(null===(t=e.cache)||void 0===t?void 0:t.codeCacheState)===a.CodeCacheState.Ready}},9250:function(e,t,r){"use strict";r.r(t),r.d(t,"isBrowserOfflineEnabled",(function(){return u})),r.d(t,"getOperationType",(function(){return c}));var n=r(9242),a=r(9241),i=r(9240),o=r(9239),s=r(9230);function u(e){return(Object(i.isFeatureEnabledByFCBName)(e,o.BrowserOfflineEnabledForTest)||Object(i.isFeatureEnabledByFCBName)(e,o.MDLBrowserOfflineEnabledForTest))&&(t="openDatabase",void 0!==window.self[t])&&Object(a.getClientHost)(e)===n.ClientHost.Browser&&-1!==window.navigator.userAgent.indexOf("Chrome");var t}function c(e){var t,r,n;return{type:(null===(t=e.additionalParameters)||void 0===t?void 0:t[s.OPERATION.TYPE])||s.UNKNOWN_TYPE,subType:(null===(r=e.additionalParameters)||void 0===r?void 0:r[s.OPERATION.SUB_TYPE])||s.UNKNOWN_TYPE,source:(null===(n=e.additionalParameters)||void 0===n?void 0:n[s.OPERATION.SOURCE])||s.OPERATION_SOURCE.Default}}},9251:function(e,t,r){"use strict";var n;r.r(t),r.d(t,"CodeCacheState",(function(){return n})),function(e){e[e.Waiting=1]="Waiting",e[e.Initializing=2]="Initializing",e[e.Ready=3]="Ready",e[e.Error=4]="Error"}(n||(n={}))},9252:function(e,t,r){"use strict";r.r(t),r.d(t,"getIsMocaOfflineFeatureEnabled",(function(){return i}));var n=r(9083),a=r(9250);function i(e){return e&&e.offline&&e.offline.server&&!Object(n.IsNullOrUndefined)(e.offline.server.isMocaOfflineFeatureEnabled)?e.offline.server.isMocaOfflineFeatureEnabled||Object(a.isBrowserOfflineEnabled)(e):!!Object(a.isBrowserOfflineEnabled)(e)}},9253:function(e,t,r){"use strict";r.r(t),r.d(t,"getEntitySetNameFromRequest",(function(){return i})),r.d(t,"getEntityNameFromRequest",(function(){return o}));var n=r(9183),a=r(9193);function i(e){var t=e.urlParameters;if(!t)return null;"PATCH"===e.method&&t.indexOf(a.UPLOAD_FILENAME_URL_FRAGMENT)>0&&(t=t.substring(0,t.lastIndexOf("/")));var r=t.substring(t.lastIndexOf("/")+1),n=r.indexOf("("),i=r.indexOf("?"),o=-1;return n>0&&i>0?o=Math.min(n,i):n>0?o=n:i>0?o=i:n<0&&"DELETE"===e.method&&(o=(r=(t=t.substr(0,t.lastIndexOf("/"))).substring(t.lastIndexOf("/")+1)).indexOf("(")),o>0?r.substring(0,o):r}function o(e,t){var r=i(t);return r&&Object(n.getEntityLogicalNameFromSetName)(e,r)}},9254:function(e,t,r){"use strict";r.r(t),r.d(t,"deserializeErrorResponse",(function(){return p}));var n=r(9045),a=r(9047),i=r(9083),o=r(9184),s=r(9218),u=r(9193),c=r(9087),l=r(9255),d=r(9187);function p(e,t,r,l){var p,m=(null==e?void 0:e.toLowerCase().indexOf("<!doctype html"))>-1;(p=401===t.status?new o.ErrorStatus(e,d.CrmErrorCodes.UnknownUnauthorizedError):m?function(e,t,r){var n=h(0,t.status);return new o.ErrorStatus(e,n)}(e,t):function(e,t,r,n){try{var s,u=JSON.parse(e),c=u.error;return Object(i.IsNullOrUndefined)(c)?(r.error("Unexpected server error response - no error at top level",n),s=f(u,t,r)):s=f(c,t,r),s}catch(c){return n.push({name:a.EVENT_PARAMETERS.ERROR_COMPLETE_TEXT,value:e}),r.error("Failure during error parsing: ".concat(c.message),n),new o.ErrorStatus(e,h(0,t.status))}}(e,t,l,r)).httpStatusCode=t.status;var y=t.headers?Object(s.getHttpHeader)(t.headers,u.HEADER.RETRY_AFTER):null;p.retryAfter=y;var v=t.headers?Object(s.getHttpHeader)(t.headers,u.HEADER.CONTENT_ID):null;if(v){var g=Number.parseInt(v,10);g>-1&&(p.faultedRequestIndex=g)}var O=t.headers?Object(s.getHttpHeader)(t.headers,u.HEADER.SERVER_REQUEST_ID):n.UNKNOWN,E=t.headers?Object(s.getHttpHeader)(t.headers,u.HEADER.CLIENT_REQUEST_ID):n.UNKNOWN;p.serverResponseId=O,p.clientRequestId=E;var b=t&&0===t.status;return r.push({name:c.MDS_EVENT_PARAMETERS.ODATA_ERROR_RESPONSE_IS_HTML_TYPE,value:m}),r.push({name:c.MDS_EVENT_PARAMETERS.IS_ERROR_IN_OFFLINE,value:b}),p}function f(e,t,r){var n,a,s,u,c,l=null===(n=e.code)||void 0===n?void 0:n.toString();Object(i.IsNullOrUndefinedOrEmptyString)(l)&&(l=null===(u=e.ErrorCode)||void 0===u?void 0:u.toString(),Object(i.IsNullOrUndefinedOrEmptyString)(l)?r.error("Unexpected server error response - no error code"):r.error("Unexpected server error response - error code provided as ErrorCode"));if(!Object(i.IsNullOrUndefinedOrEmptyString)(l)){var d=l.toLowerCase().startsWith("0x")?16:10;c=parseInt(l.toString(),d)}var p,m=null===(a=e.message)||void 0===a?void 0:a.toString();Object(i.IsNullOrUndefinedOrEmptyString)(m)&&(m=null===(p=e.Message)||void 0===p?void 0:p.toString(),Object(i.IsNullOrUndefinedOrEmptyString)(m)?r.error("Unexpected server error response - no message"):r.error("Unexpected server error response - message provided as Message"));var y,v=null===(s=e.stacktrace)||void 0===s?void 0:s.toString();Object(i.IsNullOrUndefinedOrEmptyString)(v)&&(v=null===(y=e.StackTrace)||void 0===y?void 0:y.toString(),Object(i.IsNullOrUndefinedOrEmptyString)(v)||r.error("Unexpected server error response - message provided as Message"));var g=e.innererror,O=null;Object(i.IsNullOrUndefined)(g)||(O=f(g,t,r));var E=h(c,t.status);return new o.ErrorStatus(m,E,null,O,null,null,null,null,null,null,v)}function h(e,t){if(0!==e)return e;switch(t){case 400:return l.ErrorCodes.unknownBadRequestError;case 401:return l.ErrorCodes.UnknownUnauthorizedError;case 403:return l.ErrorCodes.unknownForbiddenError;case 404:return l.ErrorCodes.unknownNotFoundError;case 429:return l.ErrorCodes.UnknownTooManyRequestsError;case 500:return l.ErrorCodes.unknownInternalServerError;case 501:return l.ErrorCodes.unknownNotImplementedServerError;case 502:return l.ErrorCodes.unknownBadGatewayError;case 503:return l.ErrorCodes.unknownServiceUnavailableError;case 504:return l.ErrorCodes.unknownGatewayTimeoutError;default:return l.ErrorCodes.UnknownUnexpectedGenericError}}},9255:function(e,t,r){"use strict";r.r(t),r.d(t,"ErrorCodes",(function(){return a})),r.d(t,"isNonReportableErrorCode",(function(){return l})),r.d(t,"isSLAImpactingError",(function(){return d}));var n,a,i=r(9187),o=r(9256),s=r(9195),u=r(9257),c=r(9184);function l(e){e<0&&(e=4294967295+e+1);var t=[n.MetadataNoMapping,n.ObjectDoesNotExist];return null!=e&&t.indexOf(e)>-1}function d(e,t,r){return function(e,t,r){switch(e){case s.MDL_COMPONENT_NAMES.ModernDataSource:case s.MDL_COMPONENT_NAMES.ModernDataSourceGCM:case u.WEB_API_SERVICE_COMPONENT:return function(e){var t=Object(c.getNegativeErrorCodeFromErrorCode)(e),r=[i.CrmErrorCodes.MetadataNoMapping,i.CrmErrorCodes.ObjectDoesNotExist,i.CrmErrorCodes.isvAborted,i.CrmErrorCodes.isvUnexpected];if(null!=t&&r.indexOf(t)>-1)return!1;return!0}(t);case u.OfflineDatSyncComponent:return function(e,t){var r=Object(c.getNegativeErrorCodeFromErrorCode)(e),n=[o.DataSyncServiceErrorCodes.InvalidSubscription,o.DataSyncServiceErrorCodes.InvalidMetadata,o.DataSyncServiceErrorCodes.AuthenticationError,o.DataSyncServiceErrorCodes.InvalidSubscriptionInLoop,o.DataSyncServiceErrorCodes.SyncHandlerNotAvailable,i.CrmErrorCodes.DataSourceOfflineErrorCode],a=["Synchronization interrupted by the user!"];if(null!=r&&n.indexOf(r)>-1||a.indexOf(t)>-1)return!1;return!0}(t,r);default:return!0}}(e,t,r)}!function(e){e[e.MetadataNoMapping=2147749377]="MetadataNoMapping",e[e.ObjectDoesNotExist=2147746327]="ObjectDoesNotExist"}(n||(n={})),function(e){e[e.InvalidEntity=2147868684]="InvalidEntity",e[e.unknownBadRequestError=2147951697]="unknownBadRequestError",e[e.UnknownUnauthorizedError=2147951872]="UnknownUnauthorizedError",e[e.unknownForbiddenError=2147951873]="unknownForbiddenError",e[e.unknownNotFoundError=2147951874]="unknownNotFoundError",e[e.UnknownTooManyRequestsError=2147951875]="UnknownTooManyRequestsError",e[e.unknownInternalServerError=2147951876]="unknownInternalServerError",e[e.unknownNotImplementedServerError=2147951877]="unknownNotImplementedServerError",e[e.unknownBadGatewayError=2147951878]="unknownBadGatewayError",e[e.unknownServiceUnavailableError=2147951879]="unknownServiceUnavailableError",e[e.unknownGatewayTimeoutError=2147951880]="unknownGatewayTimeoutError",e[e.UnknownUnexpectedGenericError=2147951881]="UnknownUnexpectedGenericError"}(a||(a={}))},9256:function(e,t,r){"use strict";var n;r.r(t),r.d(t,"DataSyncServiceErrorCodes",(function(){return n})),function(e){e[e.InvalidSubscription=-2147220969]="InvalidSubscription",e[e.InvalidMetadata=-2147015408]="InvalidMetadata",e[e.AuthenticationError=-2147093995]="AuthenticationError",e[e.InvalidSubscriptionInLoop=-2147015405]="InvalidSubscriptionInLoop",e[e.SyncHandlerNotAvailable=-6]="SyncHandlerNotAvailable"}(n||(n={}))},9257:function(e,t,r){"use strict";r.r(t),r.d(t,"API_FRAGMENT_9_1",(function(){return n})),r.d(t,"UNKNOWN",(function(){return a})),r.d(t,"REQUEST_DETAILS",(function(){return i})),r.d(t,"REQUEST_URL",(function(){return o})),r.d(t,"REQUEST_METHOD",(function(){return s})),r.d(t,"ENTITY_NAME",(function(){return u})),r.d(t,"IS_OFFLINE_BY_DEFAULT_REQUEST",(function(){return c})),r.d(t,"CLIENT_REQUEST_ID",(function(){return l})),r.d(t,"CRM_ERROR_CODE",(function(){return d})),r.d(t,"WEB_API_SERVICE_COMPONENT",(function(){return p})),r.d(t,"OfflineDatSyncComponent",(function(){return f}));var n="&api-version=9.1",a="Unknown",i="Request-Details",o="Request-Url",s="Method",u="Entity-Name",c="Is-Offline-By-Default-Request",l="Client-Request-Id",d="Crm-Error-Code",p="Storage:WebAPIService",f="OfflineDataSync"},9258:function(e,t,r){"use strict";r.r(t),r.d(t,"parseQueryForAliasedValues",(function(){return m})),r.d(t,"deserializeEntityCollection",(function(){return p})),r.d(t,"parseFetchXmlForAliasedValues",(function(){return y}));var n=r(9083),a=r(9199),i=r(9259),o=r(9269),s=r(9084),u=r(9182),c=r(9183),l=r(9268),d=r(9228);function p(e,t,r,n,a,s,p){var m=arguments.length>7&&void 0!==arguments[7]?arguments[7]:d.PayloadFormat.OData,y=arguments.length>8?arguments[8]:void 0,v=arguments.length>9?arguments[9]:void 0,g=t instanceof o.LegacyQuery?null==t?void 0:t.get_EntityLogicalName():null==t?void 0:t.entityLogicalName,O=Object(c.getEntityDescriptor)(e,g),E=Object(u.getAttributesForEntity)(e,g),b=Object(i.parseXmlDocument)(t instanceof o.LegacyQuery?null==t?void 0:t.get_FetchXml():null==t?void 0:t.fetchXml),T=t instanceof o.LegacyQuery?null==t?void 0:t.GetColumnNamesFromFetch():Object(l.getColumnNamesFromFetch)(b),S=f(n,m),C=S.map(n=>Object(d.createEntityRecordFromResponse)(e,n,O,E,T,t instanceof o.LegacyQuery?null==t?void 0:t.get_ColumnSet():Object(l.getColumnSetFromFetch)(b),null,r,p,m));return h(n,t,C,a,s,y,v)}function f(e,t){var r=[];if(t===d.PayloadFormat.SQL&&e.rows&&e.rows.length){r=[];for(var n=0;n<e.rows.length;n++)r.push(e.rows.item(n))}else r=t===d.PayloadFormat.OData&&e&&e.value&&e.value.length?e.value:[];return r}function h(e,t,r,i,s,u,c){return Object(n.IsNullOrUndefined)(c)&&(c=e["@Microsoft.Dynamics.CRM.totalrecordcountlimitexceeded"]||!1),c?i=-1:Object(n.IsNullOrUndefined)(i)&&(i=e["@Microsoft.Dynamics.CRM.totalrecordcount"]||r.length),Object(n.IsNullOrUndefined)(u)&&(u=e["@Microsoft.Dynamics.CRM.morerecords"]),s&&t instanceof o.LegacyQuery&&(null==t||t.set_PagingCookie(s)),new a.EntityCollection(r,u,i,c,t instanceof o.LegacyQuery?t:null)}function m(e){return y(null==e?void 0:e.get_FetchXml())}function y(e){for(var t={},r={},n=(new DOMParser).parseFromString(e,"text/xml"),a=n.getElementsByTagName("link-entity"),i=0;i<a.length;++i){var o=a[i],u=o.getAttribute("alias"),c=o.getAttribute("name"),l=o.getElementsByTagName("attribute");if(l.length)for(var d=0;d<l.length;++d){var p=l.item(d),f=p?p.getAttribute("name"):null,h="".concat(u).concat(".").concat(f),m="".concat(u).concat("_x002e_").concat(f);t[h]={alias:u,aliasedEtn:c,aliasedValueFieldName:f,oDataAlias:[h,m],oDataSeparator:[".","_x002e_"]},t[m]={alias:u,aliasedEtn:c,aliasedValueFieldName:f,oDataAlias:[m,h],oDataSeparator:["_x002e_","."]},Object(s.addAttributes)(r,c,[f])}}for(var y=n.querySelectorAll("entity > attribute[alias]"),v=n.getElementsByTagName("entity"),g=v&&v[0]?v[0].getAttribute("name"):"",O=0;O<y.length;++O){var E=y[O],b=E.getAttribute("alias"),T=E.getAttribute("name"),S=E.getAttribute("rowaggregate");t["".concat(T)]={alias:b,aliasedValueEtn:g,aliasedValueFieldName:T,oDataAlias:["".concat(b)],oDataSeparator:[""],isAttributeAlias:!0,rowaggregate:S}}return{aliasedValueDescriptors:t,entity2AttributesMap:r}}},9259:function(e,t,r){"use strict";r.r(t),r.d(t,"create",(function(){return p})),r.d(t,"parseXmlDocument",(function(){return f}));var n=r(9082),a=r(9260),i=r(9264),o=r(9267),s=r(9083),u=r(9268),c=o.XmlEvaluatorType.undefined;function l(){return c}function d(e){return c=e,e}function p(e){return Object(s.IsNullOrUndefined)(e)?null:(l()===o.XmlEvaluatorType.undefined&&function(e){if(function(e){var t=document.evaluate,r=document.createNSResolver&&document.createNSResolver(e);return!Object(s.IsNullOrUndefined)(t)&&r&&!0}(e)){var t=new i.XPathEvaluatorWrapper(e);try{t.selectSingleNode("/root"),d(0)}catch(a){}}l()===o.XmlEvaluatorType.undefined&&(r=window.DOMParser,Object(s.IsNullOrUndefined)(r)||d(o.XmlEvaluatorType.domParser));var r;l()===o.XmlEvaluatorType.undefined&&Object(n.throwOnNullOrUndefinedArgument)(l(),"PreferredXmlEvaluator")}(e),l()?new a.DOMParserNodeWrapper(e):new i.XPathEvaluatorWrapper(e))}function f(e){var t=Object(u.ParseXml)(e);if(null!=t){var r=t.getElementsByTagName("parsererror");!Object(s.IsNullOrUndefined)(r)&&r.length>0&&(t=null)}return t}},9260:function(e,t,r){"use strict";r.r(t),r.d(t,"DOMParserNodeWrapper",(function(){return s}));var n=r(9261),a=r(9262),i=r(9263),o=r(9083);class s extends n.XmlNode{constructor(e,t){super(),this._element=void 0,this._namespaces=void 0,Object(a.assert)(!Object(o.IsNullOrUndefined)(e),"The element should not be null"),this._element=e,this._namespaces=Object(o.IsNullOrUndefined)(t)?{}:t}get_innerText(){return this._element.hasChildNodes()?this._element.firstChild.nodeValue:null}get_outerXml(){return(new XMLSerializer).serializeToString(this._element)}get_tagName(){return this._element.nodeName}get_domParserElement(){return this._element}getAttribute(e){return this._element.getAttribute(e)}addNamespace(e,t){this._namespaces[e]=t}selectSingleNode(e){var t=this._SelectDOMParserElements(e,!0);if(t.get_count())return t.get_item(0)}selectNodes(e){return this._SelectDOMParserElements(e,!1)}getElementsByTagName(e){var t;t=Object(o.IsNullOrUndefined)(this._element.ownerDocument)?this._element.getElementsByTagName(e):this._element.ownerDocument.getElementsByTagName(e);for(var r=[],n=0;n<t.length;n++)r.push(t[n]);var a=this._GetElementsByTagNameWithDefaultNamespace(e);r.push(...a);var u=r.map(e=>new s(e,this._namespaces));return new i.DOMParserNodeListWrapper(u)}childNodes(){for(var e=[],t=0,r=this._element.childNodes.length;t<r;t++)e.push(new s(this._element.childNodes[t],this._namespaces));return new i.DOMParserNodeListWrapper(e)}hasChildNodes(){return this._element.hasChildNodes()}_SelectDOMParserElements(e,t){var r=[];if(e.startsWith("// ")||e.startsWith(".// ")){var n=2,a=!1;e.startsWith(".")&&(n++,a=!0);var u,c,l,d,p,f=(e=e.substr(n)).indexOf("/");f<0?(u=e,c=null):(u=e.substr(0,f),c=e.substr(f+1)),(f=u.indexOf("["))<0?(l=u,d=null):(l=u.substr(0,f),f=(d=u.substr(f+1)).indexOf("]"),d=d.substr(0,f)),p=a||Object(o.IsNullOrUndefined)(this._element.ownerDocument)?this._element.getElementsByTagName(l):this._element.ownerDocument.getElementsByTagName(l);for(var h=[],m=0;m<p.length;m++)h.push(p[m]);var y=this._GetElementsByTagNameWithDefaultNamespace(l);h.push(...y);var v=h;h.length>0&&null!==d&&(v=this._FilterDOMParserElementList(h,d)),r=v.length&&null!==c?this._SearchDOMParserElementList(v,c,t):v}else e.startsWith("/")?(Object(o.IsNullOrUndefined)(this._element.ownerDocument)?r.push(this._element):r.push(this._element.ownerDocument),r=this._SearchDOMParserElementList(r,e.substr(1),t)):(r.push(this._element),r=this._SearchDOMParserElementList(r,e,t));var g=r.map(e=>new s(e,this._namespaces));return new i.DOMParserNodeListWrapper(g)}_SearchDOMParserElementList(e,t,r){return r?this._SearchSingleNodeDOMParserElementList(e,t):this._SearchNodesDOMParserElementList(e,t)}_SearchSingleNodeDOMParserElementList(e,t){if(Object(o.IsNullOrUndefined)(t)||t.length<1)return e;for(var r=[],n=0;n<e.length;n++){var a=this._SearchSingleNodeDOMParserElement(e[n],t);if(a){r.push(a);break}}return r}_SearchSingleNodeDOMParserElement(e,t){if(Object(o.IsNullOrUndefined)(t)||t.length<1)return e;var r,n,a,i,s=t.indexOf("/");s<0?(r=t,n=null):(r=t.substr(0,s),n=t.substr(s+1)),(s=r.indexOf("["))<0?(a=r,i=null):(a=r.substr(0,s),s=(i=r.substr(s+1)).indexOf("]"),i=i.substr(0,s));for(var u=null,c=0,l=e.childNodes.length;c<l;c++)if(this._IsNodeNameEqual(e.childNodes[c],a)){var d=[e.childNodes[c]],p=d;if(null!==i&&(p=this._FilterDOMParserElementList(d,i)),p.length>0){if(null===n){u=p[0];break}if(u=this._SearchSingleNodeDOMParserElement(p[0],n))break}}return u}_SearchNodesDOMParserElementList(e,t){if(Object(o.IsNullOrUndefined)(t)||t.length<1)return e;var r,n,a=t.indexOf("/");a<0?(r=t,n=null):(r=t.substr(0,a),n=t.substr(a+1));for(var i,s=[],u=0;u<e.length;u++)(i=this._SearchDOMParserElement(e[u],r)).length>0&&s.push(...i);return s.length&&null!==n?this._SearchNodesDOMParserElementList(s,n):s}_SearchDOMParserElement(e,t){var r,n,a=t.indexOf("[");a<0?(r=t,n=null):(r=t.substr(0,a),a=(n=t.substr(a+1)).indexOf("]"),n=n.substr(0,a));for(var i=[],o=0,s=e.childNodes.length;o<s;o++)this._IsNodeNameEqual(e.childNodes[o],r)&&i.push(e.childNodes[o]);var u=i;return i.length>0&&null!==n&&(u=this._FilterDOMParserElementList(i,n)),u}_FilterDOMParserElementList(e,t){var r=t.startsWith("@");r&&(t=t.substr(1));var n,a,i=t.indexOf("=");i<0?(n=t,a=null):(n=t.substr(0,i),a=(a=(a=t.substr(i+1)).substr(1)).substr(0,a.length-1));for(var o=[],s=0;s<e.length;s++){var u=e[s];(r&&this._FilterDOMParserElementAttribute(u,n,a)||this._FilterDOMParserElementChildElement(u,n,a))&&o.push(u)}return o}_FilterDOMParserElementAttribute(e,t,r){return null===r?e.hasAttribute(t):r===e.getAttribute(t)}_FilterDOMParserElementChildElement(e,t,r){for(var n=0,a=null==e||null===(i=e.childNodes)||void 0===i?void 0:i.length;n<a;n++){var i;if(this._IsNodeNameEqual(e.childNodes[n],t)){var o,s;if(null===r)return!0;if((null===(o=e.childNodes[n])||void 0===o||null===(s=o.firstChild)||void 0===s?void 0:s.nodeValue)===r)return!0}}return!1}_GetElementsByTagNameWithDefaultNamespace(e){var t=[],r=this._GetNamespaceForFullName(e);if(Object(o.IsNullOrUndefined)(r)||r.length<1)return t;var n,a=this._GetLocalNameForFullName(e);n=Object(o.IsNullOrUndefined)(this._element.ownerDocument)?this._element.getElementsByTagName(a):this._element.ownerDocument.getElementsByTagName(a);for(var i=0;i<n.length;i++)n[i].namespaceURI===r&&t.push(n[i]);return t}_GetNamespaceForFullName(e){var t=e.indexOf(":");if(t<0)return"";var r=e.substr(0,t);return this._namespaces[r]}_GetLocalNameForFullName(e){var t=e.indexOf(":");return t<0?e:e.substr(t+1)}_IsNodeNameEqual(e,t){if(e.nodeName===t||"*"===t)return!0;var r=this._GetNamespaceForFullName(t);if(Object(o.IsNullOrUndefined)(r)||r.length<1)return!1;var n=this._GetLocalNameForFullName(t);return e.namespaceURI===r&&e.localName===n}}},9261:function(e,t,r){"use strict";r.r(t),r.d(t,"XmlNode",(function(){return n}));class n{static createAttribute(e,t,r){if(e){var n=e.createAttribute(t);return n.value=r,n}return null}}},9262:function(e,t,r){"use strict";function n(e,t){}r.r(t),r.d(t,"assert",(function(){return n}))},9263:function(e,t,r){"use strict";r.r(t),r.d(t,"DOMParserNodeListWrapper",(function(){return i}));var n=r(9262),a=r(9083);class i{constructor(e){this._list=void 0,Object(n.assert)(!Object(a.IsNullOrUndefined)(e),"Node list obj should not be null"),this._list=e}get_count(){return this._list.length}get_item(e){return this._list[e]}}},9264:function(e,t,r){"use strict";r.r(t),r.d(t,"XPathEvaluatorWrapper",(function(){return u}));var n=r(9261),a=r(9262),i=r(9265),o=r(9266),s=r(9083);class u extends n.XmlNode{constructor(e,t,r){super(),this._namespaces=void 0,this._evaluator=void 0,this._element=void 0,this._namespaces=null,this._evaluator=null,this._element=null,Object(a.assert)(!Object(s.IsNullOrUndefined)(e),"The XPathEvaluator should not be null"),this._evaluator=e,this._element=Object(s.IsNullOrUndefined)(t)?e:t,this._namespaces=Object(s.IsNullOrUndefined)(r)?{}:r}get_innerText(){var e,t,r;return null!==(e=this._element)&&void 0!==e&&e.hasChildNodes()?null===(t=this._element)||void 0===t||null===(r=t.firstChild)||void 0===r?void 0:r.nodeValue:null}get_outerXml(){return(new XMLSerializer).serializeToString(this._element)}get_tagName(){var e;return null===(e=this._element)||void 0===e?void 0:e.tagName}get_domParserElement(){return this._element}addNamespace(e,t){this._namespaces&&(this._namespaces[e]=t)}selectSingleNode(e){var t,r=null===(t=this._evaluator)||void 0===t?void 0:t.evaluate(e,this._element,null,i.XPathResultType.FIRST_ORDERED_NODE_TYPE,null);return Object(s.IsNullOrUndefined)(null==r?void 0:r.singleNodeValue)?null:new u(this._evaluator,null==r?void 0:r.singleNodeValue,this._namespaces)}selectNodes(e){var t;return new o.NodeSnapshotWrapper(this._evaluator,null===(t=this._evaluator)||void 0===t?void 0:t.evaluate(e,this._element,null,i.XPathResultType.ORDERED_NODE_SNAPSHOT_TYPE,null),this._namespaces)}getAttribute(e){var t;return null===(t=this._element)||void 0===t?void 0:t.getAttribute(e)}getElementsByTagName(e){var t;return new o.NodeSnapshotWrapper(this._evaluator,null===(t=this._element)||void 0===t?void 0:t.getElementsByTagName(e),this._namespaces)}childNodes(){var e;return new o.NodeSnapshotWrapper(this._evaluator,null===(e=this._element)||void 0===e?void 0:e.childNodes,this._namespaces)}hasChildNodes(){var e;return null===(e=this._element)||void 0===e?void 0:e.hasChildNodes()}}},9265:function(e,t,r){"use strict";var n;r.r(t),r.d(t,"XPathResultType",(function(){return n})),function(e){e[e.ANY_TYPE=0]="ANY_TYPE",e[e.NUMBER_TYPE=1]="NUMBER_TYPE",e[e.STRING_TYPE=2]="STRING_TYPE",e[e.BOOLEAN_TYPE=3]="BOOLEAN_TYPE",e[e.UNORDERED_NODE_ITERATOR_TYPE=4]="UNORDERED_NODE_ITERATOR_TYPE",e[e.ORDERED_NODE_ITERATOR_TYPE=5]="ORDERED_NODE_ITERATOR_TYPE",e[e.UNORDERED_NODE_SNAPSHOT_TYPE=6]="UNORDERED_NODE_SNAPSHOT_TYPE",e[e.ORDERED_NODE_SNAPSHOT_TYPE=7]="ORDERED_NODE_SNAPSHOT_TYPE",e[e.ANY_UNORDERED_NODE_TYPE=8]="ANY_UNORDERED_NODE_TYPE",e[e.FIRST_ORDERED_NODE_TYPE=9]="FIRST_ORDERED_NODE_TYPE"}(n||(n={}))},9266:function(e,t,r){"use strict";r.r(t),r.d(t,"NodeSnapshotWrapper",(function(){return o}));var n=r(9262),a=r(9264),i=r(9083);class o{constructor(e,t,r){if(this._list=void 0,Object(n.assert)(!Object(i.IsNullOrUndefined)(e),"XPathEvaluator should not be null"),Object(n.assert)(!Object(i.IsNullOrUndefined)(t),"Node list obj should not be null"),this._list=[],t instanceof XPathResult)for(var o=t,s=0;s<o.snapshotLength;s++)this._list.push(new a.XPathEvaluatorWrapper(e,o.snapshotItem(s),r));else for(var u=t,c=0;c<u.length;c++)this._list.push(new a.XPathEvaluatorWrapper(e,u[c],r))}get_count(){return this._list.length}get_item(e){return this._list[e]}}},9267:function(e,t,r){"use strict";var n;r.r(t),r.d(t,"XmlEvaluatorType",(function(){return n})),function(e){e[e[void 0]=-1]="undefined",e[e.xPath=0]="xPath",e[e.domParser=1]="domParser"}(n||(n={}))},9268:function(e,t,r){"use strict";r.r(t),r.d(t,"compress",(function(){return u})),r.d(t,"parseFetchXmlFromString",(function(){return c})),r.d(t,"getNodeAttributeValueByName",(function(){return l})),r.d(t,"getColumnNamesFromFetch",(function(){return h})),r.d(t,"getEntityFromFetch",(function(){return m})),r.d(t,"isFetchAll",(function(){return y})),r.d(t,"addColumns",(function(){return v})),r.d(t,"addLinkedEntity",(function(){return O})),r.d(t,"buildLinkedEntityNode",(function(){return g})),r.d(t,"addChildCountAttribute",(function(){return E})),r.d(t,"addSort",(function(){return T})),r.d(t,"findLinkEntitySort",(function(){return S})),r.d(t,"createOrderElement",(function(){return C})),r.d(t,"removeOrderElements",(function(){return N})),r.d(t,"createOneToManyContextFilter",(function(){return _})),r.d(t,"createManyToManyContextFilter",(function(){return R})),r.d(t,"addContextFilter",(function(){return P})),r.d(t,"setFetchXmlParameters",(function(){return I})),r.d(t,"getColumnSetFromFetch",(function(){return A})),r.d(t,"getAttributesMapFromFetch",(function(){return f})),r.d(t,"ParseXml",(function(){return D})),r.d(t,"addFilters",(function(){return b}));var n=r(9083),a=r(9202),i=r(9203),o=r(9259),s=r(9084);function u(e){return e.replace(/[\r\n\t]/g,"").replace(/ \/>/g,"/>")}function c(e){return(new DOMParser).parseFromString(e,"text/xml")}function l(e,t){if(!Object(n.IsNullOrUndefined)(e)&&!Object(n.IsNullOrUndefined)(e.attributes)){var r=e.attributes.getNamedItem(t);if(!Object(n.IsNullOrUndefined)(r))return null==r?void 0:r.nodeValue}return null}function d(e,t,r){var n=e.createAttribute(t);return n.value=r,n}function p(e,t,r){return l(e,r)===l(t,r)}function f(e){var t=Object(o.parseXmlDocument)(e);if(!t)return{};for(var r=t.getElementsByTagName("entity")[0].getAttribute("name"),a={[r]:[]},i=t.getElementsByTagName("attribute"),u=0;u<i.length;u++){var c,l=i[u],d=null===(c=l.attributes.getNamedItem("name"))||void 0===c?void 0:c.nodeValue;if(l&&l.parentNode&&"link-entity"===l.parentNode.nodeName&&!Object(n.IsNullOrUndefined)(l.parentNode.getAttribute("name"))){var p=l.parentNode.getAttribute("name"),f=l.getAttribute("name");p&&f&&Object(s.addAttributes)(a,p,[f])}else r&&Object(s.addAttributes)(a,r,[d])}return a}function h(e){if(Object(n.IsNullOrUndefined)(e)||null==e)return null;if(y(e))return null;for(var t=[],r=e.getElementsByTagName("attribute"),a=0;a<r.length;a++){var i,o,s=r[a],u=null===(i=s.attributes.getNamedItem("name"))||void 0===i?void 0:i.nodeValue;if("link-entity"!==(null===(o=s.parentNode)||void 0===o?void 0:o.nodeName)||Object(n.IsNullOrUndefined)(s.parentNode.attributes.getNamedItem("alias")))t[a]=u;else{var c,l=null===(c=s.parentNode.attributes.getNamedItem("alias"))||void 0===c?void 0:c.nodeValue;t[a]=l+"."+u}}return t}function m(e){var t=e.getElementsByTagName("entity");return Object(n.IsNullOrUndefined)(t)||Object(n.IsNullOrUndefined)(t[0])?null:t[0].getAttribute("name")}function y(e){return!!e&&e.getElementsByTagName("all-attributes").length>0}function v(e,t){if(!Object(n.IsNullOrUndefined)(t)&&t.length&&!Object(n.IsNullOrUndefined)(e)){var r=h(e),a=e.getElementsByTagName("entity");if(a&&a[0])for(var i=a[0].firstChild,o=0;o<t.length;o++)if(-1===(null==r?void 0:r.indexOf(t[o]))){var s=e.createElement("attribute");s.attributes.setNamedItem(d(e,"name",t[o])),a[0].insertBefore(s,i)}}}function g(e,t){var r='<link-entity name="'+e.name+'" from="'+e.from+'" to="'+e.to+'"';if(r+=e.linkType?' link-type="'+e.linkType+'"':"",r+=e.alias?' alias="'+e.alias+'"':"",0===t.length)return r+=" />";r+=">";for(var n=0;n<t.length;n++)r+='<attribute name="'+t[n]+'" />';return r+="</link-entity>"}function O(e,t){Object(n.IsNullOrUndefinedOrEmptyString)(t)||function(){var r=e.getElementsByTagName("entity")[0],a=!1,i=c(t),o=e.getElementsByTagName("link-entity");if(!Object(n.IsNullOrUndefined)(o))for(var s=["alias","name","from","to","link-type"],u=function(e){if(s.every(t=>p(o[e],i.documentElement,t))){for(var t=0;t<i.documentElement.childNodes.length;t++)o[e].appendChild(i.documentElement.childNodes[t].cloneNode());a=!0}},l=0;l<o.length;l++)u(l);a||Object(n.IsNullOrUndefined)(r)||r.appendChild(i.documentElement)}()}function E(e,t){var r=e.createElement("attribute");r.attributes.setNamedItem(d(e,"name",t)),r.attributes.setNamedItem(d(e,"rowaggregate","CountChildren")),r.attributes.setNamedItem(d(e,"alias","HierarchyDataChildCount6dcd9e4c001441b09237d51a34853d55")),e.getElementsByTagName("entity")[0].appendChild(r)}function b(e,t){if(!e)throw new Error("Invalid fetch xml document is passed");var r=Object(o.parseXmlDocument)(t),n=e.getElementsByTagName("entity")[0];r&&n.appendChild(r.firstChild)}function T(e,t,r){var n;if(-1===t.indexOf("."))n=e.getElementsByTagName("entity")[0];else{var a=t.split(".");if(2===a.length)n=S(e,a[0],t=a[1])}if(n){for(var i=n.getElementsByTagName("order"),o=C(e,t,r),s=!1,u=0;u<i.length;u++)if(p(i[u],o,"attribute")){s=!0,i[u].setAttribute("descending",r?"true":"false");break}s||n.appendChild(o)}}function S(e,t,r){for(var n=e.getElementsByTagName("link-entity"),a=0;a<n.length;a++){var i,o=n[a];if(o.attributes.getNamedItem("alias")&&(null===(i=o.attributes.getNamedItem("alias"))||void 0===i?void 0:i.nodeValue)===t)for(var s=o.childNodes,u=0;u<s.length;u++){var c,l=s[u];if("attribute"===l.nodeName&&(null===(c=l.attributes.getNamedItem("name"))||void 0===c?void 0:c.nodeValue)===r)return o}}return null}function C(e,t,r){var n=e.createElement("order");return n.attributes.setNamedItem(d(e,"attribute",t)),n.attributes.setNamedItem(d(e,"descending",r.toString())),n}function N(e){for(var t=e.getElementsByTagName("order");t.length;){var r,n=t[0];null===(r=n.parentNode)||void 0===r||r.removeChild(n)}}function _(e,t,r,n){return'<link-entity name="'.concat(e,'" from="').concat(t,'" to="').concat(r,'" alias="bb">\n\t<filter type="and">\n\t\t<condition attribute="').concat(n||t,'" operator="eq" uitype="').concat(e,'" />\n\t</filter>\n\t</link-entity>')}function R(e,t,r,n,a,i){return'<link-entity name="'.concat(e,'" intersect="true" visible="false" to="').concat(t,'" from="').concat(i,'">\n\t').concat(_(n,a,r),"\n</link-entity>")}function P(e,t,r){if(!Object(n.IsNullOrUndefinedOrEmptyString)(r)&&!Object(n.IsNullOrUndefinedOrEmptyString)(t)){var a=e.getElementsByTagName("entity")[0],i=c(t),o=i.getElementsByTagName("condition")[0];Object(n.IsNullOrUndefined)(o)||o.attributes.setNamedItem(d(i,"value",r)),Object(n.IsNullOrUndefined)(a)||a.appendChild(i.firstChild)}}function I(e,t,r,a,i){if(e){if(e&&e.firstChild&&"fetch"!==e.firstChild.nodeName)return;Object(n.IsNullOrUndefined)(e.firstChild.attributes.getNamedItem("returntotalrecordcount"))&&e.firstChild.attributes.setNamedItem(d(e,"returntotalrecordcount",a.toString())),e.firstChild.attributes.setNamedItem(d(e,"page",r.toString())),e.firstChild.attributes.setNamedItem(d(e,"count",t.toString())),e.firstChild.attributes.setNamedItem(d(e,"no-lock",i.toString()))}}function A(e){if(y(e))return a.AllColumns.get_instance();var t=Object(o.create)(e),r=[],n=null==t?void 0:t.selectNodes("/fetch/entity/attribute");if(n&&n.get_count())for(var s=0;s<n.get_count();s++){var u=n.get_item(s);u&&r.push(u.getAttribute("name"))}return new i.LegacyColumnSet(r)}function D(e){if(window.hasOwnProperty("DOMParser"))return(new DOMParser).parseFromString(e,"text/xml");if(window.hasOwnProperty("ActiveXObject")){var t=new window.ActiveXObject("Microsoft.XMLDOM");return t.async=!1,t.loadXML(e),t}return null}},9269:function(e,t,r){"use strict";r.r(t),r.d(t,"LegacyQuery",(function(){return p}));var n=r(9259),a=r(9202),i=r(9203),o=r(9270),s=r(9271),u=r(9261),c=r(9272),l=r(9083),d=r(9268);class p{constructor(e){this._columnSet=null,this._descriptorSet=null,this._pagingCookie=void 0,this._noLock=!1,this._pageNumber=1,this._pageSize=1,this._entityLogicalName=null,this._returnTotalRecordCount=!1,this._columnNames=void 0,this._fetchXmlForAliasedValues=void 0,this._status=[],this.rawFetchXmlDoc=void 0,this._pagingCookie="",Object(l.IsNullOrUndefined)(e)||this._CreateQuery(e)}get_ColumnSet(){return this._columnSet}set_ColumnSet(e){return this._columnSet=e,e}set_ColumnNames(e){return this._columnNames=e,e}get_DescriptorSet(){return this._descriptorSet}get queryStatus(){return this._status}_set_DescriptorSet(e){return this._descriptorSet=e,e}get_FetchXml(){var e,t,r,a=this.rawFetchXmlDoc;return a&&a.firstChild&&null!==(e=a.firstChild)&&void 0!==e&&e.nodeName&&(null===(t=a.firstChild)||void 0===t?void 0:t.nodeName)!==p._FetchXmlNodeName?this.get_rawFetchXml():(Object(d.setFetchXmlParameters)(this.rawFetchXmlDoc,this.get_PageSize(),this.get_PageNumber(),!0,this._get_NoLock()),a&&!Object(l.IsNullOrUndefinedOrEmptyString)(this.get_PagingCookie())&&a.firstChild.attributes.setNamedItem(u.XmlNode.createAttribute(a,p._PagingCookieXmlAttributeName,this.get_PagingCookie())),null===(r=Object(n.create)(a))||void 0===r?void 0:r.get_outerXml())}set_FetchXml(e){if(Object(l.IsNullOrUndefinedOrEmptyString)(e)||"<"!==e.substr(0,1))this.set_ColumnSet(new i.LegacyColumnSet(new Array(0)));else{var t=Object(n.parseXmlDocument)(e);if(this.rawFetchXmlDoc=t,!Object(l.IsNullOrUndefined)(t)){var r=Object(n.create)(t),o=null==r?void 0:r.selectSingleNode("/"+p._FetchXmlNodeName);if(o&&!Object(l.IsNullOrUndefined)(o)){var s=o.getAttribute(p._PageNumberXmlAttributeName);Object(l.IsNullOrUndefined)(s)||this.set_PageNumber(+s),s=o.getAttribute(p._PageSizeXmlAttributeName),Object(l.IsNullOrUndefined)(s)||this.set_PageSize(+s),s=o.getAttribute(p._PagingCookieXmlAttributeName),Object(l.IsNullOrUndefined)(s)||this.set_PagingCookie(s);var u=null==r?void 0:r.selectSingleNode("/fetch/entity");if(u&&!Object(l.IsNullOrUndefined)(u)&&this.set_EntityLogicalName(u.getAttribute("name")),r&&!Object(l.IsNullOrUndefined)(r.selectSingleNode("/fetch/entity/all-attributes")))this.set_ColumnSet(a.AllColumns.get_instance());else{var c=[],d=null==r?void 0:r.selectNodes("/fetch/entity/attribute");if(d)for(var f=0;f<d.get_count();f++){var h=d.get_item(f);if(h&&h.getAttribute("name")){var m=h.getAttribute("name");c.push(m)}}this.set_ColumnSet(new i.LegacyColumnSet(c))}var y=!!t&&t.firstChild.attributes.getNamedItem(p._ReturnTotalRecordCountAttributeName);this._returnTotalRecordCount=Object(l.IsNullOrUndefined)(y)?p._DefaultReturnTotalRecordCountValue:"true"===y}}}return e}get_PageNumber(){return this._pageNumber}set_PageNumber(e){if(e<1)throw Error("PageNumber cannot be less than 1");return this._pageNumber=e,e}_get_NoLock(){return this._noLock}set_NoLock(e){return this._noLock=e,e}get_PageSize(){return this._pageSize}set_PageSize(e){return this._pageSize=e,e}get_PagingCookie(){return this._pagingCookie}set_PagingCookie(e){return Object(l.IsNullOrUndefinedOrEmptyString)(e)&&(this._pagingCookie=""),this._pagingCookie=e,e}get_EntityLogicalName(){return this._entityLogicalName}set_EntityLogicalName(e){return this._entityLogicalName=e,e}get_returnTotalRecordCount(){return this._returnTotalRecordCount}get_id(){return this.get_rawFetchXml()}get_RawSql(){var e;return null===(e=this.get_DescriptorSet())||void 0===e?void 0:e.tryGetDescriptor(o.DescriptorFormat.Sql)}set_RawSql(e){var t;Object(l.IsNullOrUndefined)(this._descriptorSet)||(null===(t=this._descriptorSet)||void 0===t||t.updateDescriptorSet(o.DescriptorFormat.Sql,e));return e}get_rawFetchXml(){var e;return this.rawFetchXmlDoc?null===(e=Object(n.create)(this.rawFetchXmlDoc))||void 0===e?void 0:e.get_outerXml():""}get_FetchXmlForAliasedValues(){return this._fetchXmlForAliasedValues}set_FetchXmlForAliasedValues(e){this._fetchXmlForAliasedValues=e}_CreateQuery(e){if(e instanceof c.DescriptorSet)for(var t in this._descriptorSet=new c.DescriptorSet,e.get_descriptors()){var r=e.get_descriptors()[t];this._descriptorSet.get_descriptors()[o.DescriptorFormat[r.Format]]=new s.DescriptorData(r.Format,r.Data),r.Format===o.DescriptorFormat.FetchXml&&this.set_FetchXml(r.Data)}else this.set_FetchXml(e.toString()),this._set_DescriptorSet(c.DescriptorSet.createFromFetchXml(e.toString()))}toString(){return"Query: "+this.get_rawFetchXml()}GetColumnNamesFromFetch(){return Object(l.IsNullOrUndefined)(this._columnNames)?Object(d.getColumnNamesFromFetch)(this.rawFetchXmlDoc):this._columnNames}generateOfflineAttributeName(e,t,r){return t}static get_empty(){return new p("")}}p._PageNumberXmlAttributeName="page",p._PageSizeXmlAttributeName="count",p._PagingCookieXmlAttributeName="paging-cookie",p._ReturnTotalRecordCountAttributeName="returntotalrecordcount",p._FetchXmlNodeName="fetch",p._DefaultReturnTotalRecordCountValue=!0},9270:function(e,t,r){"use strict";var n;r.r(t),r.d(t,"DescriptorFormat",(function(){return n})),function(e){e[e.Json=0]="Json",e[e.FetchXml=1]="FetchXml",e[e.Sql=2]="Sql",e[e.LayoutXml=3]="LayoutXml"}(n||(n={}))},9271:function(e,t,r){"use strict";r.r(t),r.d(t,"DescriptorData",(function(){return n}));class n{constructor(e,t){this.Format=0,this.Data=void 0,this.Format=e,this.Data=t}}},9272:function(e,t,r){"use strict";r.r(t),r.d(t,"DescriptorSet",(function(){return s}));var n=r(9077),a=r(9083),i=r(9271),o=r(9270);class s{constructor(){this._descriptors=void 0,this._descriptors={}}get_descriptors(){return this._descriptors}tryGetDescriptor(e){return Object(a.IsNullOrUndefined)(this._descriptors[o.DescriptorFormat[e]])?"":this._descriptors[o.DescriptorFormat[e]].Data}updateDescriptorSet(e,t){o.DescriptorFormat[e]in this.get_descriptors()?this._descriptors[o.DescriptorFormat[e]].Data=t:this._descriptors[o.DescriptorFormat[e]]=new i.DescriptorData(e,t)}static createFromFetchXml(e){var t=new s;return t._descriptors[o.DescriptorFormat[o.DescriptorFormat.FetchXml]]=new i.DescriptorData(o.DescriptorFormat.FetchXml,e),t}static createDescriptorSet(e,t,r){var a=new s;if(t===n.MetadataType.fetchXml)if(e instanceof Array)for(var u=0;u<e.length;u++){var c=e[u];(c.Format!==o.DescriptorFormat.Sql||r)&&(a.get_descriptors()[o.DescriptorFormat[c.Format]]=new i.DescriptorData(c.Format,c.Data))}else"string"==typeof e&&(a.get_descriptors()[o.DescriptorFormat[o.DescriptorFormat.FetchXml]]=new i.DescriptorData(o.DescriptorFormat.FetchXml,e));else a.get_descriptors()[o.DescriptorFormat[0]]=new i.DescriptorData(0,e);return a}}},9273:function(e,t,r){"use strict";r.r(t),r.d(t,"trimUrl",(function(){return a})),r.d(t,"canLogDetailsOfRequest",(function(){return i}));var n=r(9083);function a(e){if(Object(n.IsNullOrUndefined)(e))return e;if(i(e))return e;if(-1!==e.indexOf("fetchXml=")){var t=e.indexOf("fetchXml="),r=decodeURIComponent(e.substring(e.indexOf("fetchXml=")+"fetchXml=".length,e.length));return e.substring(0,t+"fetchXml=".length)+function(e){var t=new DOMParser,r=new XMLSerializer;if(e){var n=t.parseFromString(e,"text/xml");if(n){var a=Array.prototype.slice.call(n.getElementsByTagName("condition"));return a&&a.forEach(e=>{e.getAttribute("value")&&e.setAttribute("value","X"),e.getAttribute("uiname")&&e.setAttribute("uiname","X");var t=Array.prototype.slice.call(e.getElementsByTagName("value"));t&&t.forEach(e=>{e.getAttribute("uiname")&&e.setAttribute("uiname","X"),e.textContent="X"})}),r.serializeToString(n)}return null}return null}(r)}var a=e.indexOf("?");if(-1===a){var o=e.indexOf("=");return-1===o?e:e.substring(0,o)}return e.substring(0,a)}function i(e){return!Object(n.IsNullOrUndefined)(e)&&(-1!==e.indexOf("GetClientMetadata")||-1!==e.indexOf("EntityDefinitions")||-1!==e.indexOf("SyncClientMetadata"))}},9274:function(e,t,r){"use strict";function n(e){var t;return!!e.serverStatus&&(null===(t=e.serverStatus.isAvailable)||void 0===t||t)}r.r(t),r.d(t,"isServerAvailableInternal",(function(){return n}))},9275:function(e,t,r){"use strict";r.r(t),r.d(t,"GET_CLIENT_METADATA_ACTION_ASYNC",(function(){return V})),r.d(t,"getClientMetadata",(function(){return B})),r.d(t,"_reportMDSFailure",(function(){return Q}));var n=r(9206),a=r(9195),i=r(9276),o=r(9046),s=r(9238),u=r(9193),c=r(9240),l=r(9239),d=r(9277),p=r(9278),f=r(9085),h=r(9226),m=r(9083),y=r(9050),v=r(9194),g=r(9279),O=r(9281),E=r(9282),b=r(9257),T=r(9283),S=r(9284),C=r(9274),N=r(9246),_=r(9047),R=r(9273),P=r(9250),I=r(9179),A=r(9186),D=r(9187),M=r(9184),F=r(9244),w=r(9285),L=r(9255),j=r(9087),x=r(9249);function U(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function k(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){U(i,n,a,o,s,"next",e)}function s(e){U(i,n,a,o,s,"throw",e)}o(void 0)}))}}var q,V="moderndatasource.getclientmetadata.async";function B(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n.RetrievalStrategy.LocalAndRemote;return{type:V,execute:(_,R)=>k((function*(){var P,{dispatch:M,getState:L}=_,j=R.TraceManager.getTracer(a.MDL_COMPONENT_NAMES.ModernDataSource);j.info("".concat(W()," Get Client Metadata is executing")),null===(P=t)||void 0===P||P.AppendCallStack("".concat(W(),".getClientMetadata"));var U=Object(i.toMetadataQuery)(e),k=L();!k&&e.MetadataType&&j.warn("".concat(W()," Trying to execute a ").concat(e.MetadataType," GCM call with depth ").concat(e.DependencyDepth," when state is null")),null===o.Guid.tryParseOrNull(Object(s.getCurrentAppId)(k))&&e.MetadataType===u.APP_ENTITY&&(U.AppId=o.Guid.fromLegacyGuid(e.MetadataId));var V=Object(c.isFeatureEnabledByFCBName)(k,l.IsGetClientMetadataExEnabled),B=V?new p.GetClientMetadataExRequest:new d.GetClientMetadataRequest;B.ClientMetadataQuery=U;var G=yield M(Object(v.fromFunctionalOdataContract)(B,t));if(G.urlParameters&&Object(g.shouldCacheMetadataRequest)(e.MetadataType,e.DependencyDepth)){var z=Object(O.getUserMetadataVersion)(k),Y=Object(E.getMetadataVersion)(k),K=null!=z&&z.currentVersion?z.currentVersion:-1,J=null!=Y&&Y.currentVersion?Y.currentVersion:-1;G.urlParameters=G.urlParameters+"&umv=".concat(K.toString(),"&mv=").concat(J.toString())}G.urlParameters=G.urlParameters+b.API_FRAGMENT_9_1,Object(T.getConsistencyStrong)(k)&&(G.additionalHeaders.Consistency="Strong",M(Object(S.setConsistencyStrong)(!1))),Object(c.isFeatureEnabledByFCBName)(k,l.GCMOptimizationByEntityMetadataReduction)&&(G.additionalHeaders["x-ms-metadatareductionlevel"]=q.EntityMetadataReduction.toString());var Z=Object(x.getIsCacheModeEnabled)(k),$=Object(C.isServerAvailableInternal)(k),ee=[];if(Object(m.IsNullOrUndefined)(t)){var te=Object(v.getClientRequestId)(G);t=new f.UCIContext(te,!1)}ee.push({name:"InputRetrievalStrategy",value:n.RetrievalStrategy[r]}),ee.push({name:b.REQUEST_DETAILS,value:JSON.stringify(e)}),ee.push({name:"LocalDSAvailable",value:Z}),ee.push({name:"RemoteDSAvailable",value:$}),X(G,ee);var re=e.DependencyDepth===h.DependencyDepth.UserContext;re&&(G.additionalHeaders["x-ms-metadatareductionlevel"]=q.UserContextMetadataReduction.toString());var ne=(e,r)=>H(e,L,r,V,M,j,R,t,ee,re);try{r===n.RetrievalStrategy.LocalAndRemote&&Object(N.isOfflineByDefaultAvailableForUse)(k)&&Object(C.isServerAvailableInternal)(k)&&(e.EntityLogicalName?r=Object(F.isEntityAvailableForOfflineUsage)(k,e.EntityLogicalName)?n.RetrievalStrategy.Local:n.RetrievalStrategy.Remote:e.MetadataType===I.ENTITY_TYPE&&(r=0===Object.keys(JSON.parse(Object(w.unescapeClientMetadataQueryValue)(e.MetadataSubtype))).filter(e=>!Object(F.isEntityAvailableForOfflineUsage)(k,e)).length?n.RetrievalStrategy.Local:n.RetrievalStrategy.Remote))}catch(le){var ae=A.LegacyErrorStatus.fromGenericError(le);throw Q(R,ee,ae,L(),a.MDL_COMPONENT_NAMES.ModernDataSourceGCM,"getClientMetadata failed (known allowed error)"),ae}if(r!==n.RetrievalStrategy.LocalAndRemote){if(r===n.RetrievalStrategy.Local){if(Z){var ie=yield ne(G,n.RetrievalStrategy.Local);return!Object(m.IsNullOrUndefined)(ie)&&0!==Object.keys(ie).length||re?ie:(A.LegacyErrorStatus.fromErrorCode(D.CrmErrorCodes.DataStoreKeyNotFoundErrorCode).set_Stack(t.get_Stack()),j.error("".concat(W()," Not in local store ").concat(e.MetadataType," ").concat(e.MetadataSubtype),ee),{})}return j.warn("".concat(W()," local data source is not available and retrieval strategy is Local."),ee),{}}if(r===n.RetrievalStrategy.Remote&&$)return ne(G,n.RetrievalStrategy.Remote);var oe=A.LegacyErrorStatus.fromErrorCode(D.CrmErrorCodes.DataSourceOfflineErrorCode);throw oe.set_Stack(t.get_Stack()),j.error("".concat(W()," Remote data source is not available and retrieval strategy is remote, so error in GCM"),ee),Q(R,ee,oe,L(),a.MDL_COMPONENT_NAMES.ModernDataSourceGCM,"getClientMetadata failed (known allowed error)"),oe}if(!Z){if($)return ne(G,n.RetrievalStrategy.Remote);var se=A.LegacyErrorStatus.fromErrorCode(D.CrmErrorCodes.DataSourceOfflineErrorCode);throw se.set_Stack(t.get_Stack()),j.error("".concat(W()," remote and local data sources are not available so error in GCM"),ee),Q(R,ee,se,L(),a.MDL_COMPONENT_NAMES.ModernDataSourceGCM,"getClientMetadata failed (known allowed error)"),se}try{var ue=yield ne(G,n.RetrievalStrategy.Local);if((Object(m.IsNullOrUndefined)(ue)||0===Object.keys(ue).length)&&!re)throw A.LegacyErrorStatus.fromErrorCode(D.CrmErrorCodes.DataStoreKeyNotFoundErrorCode);return ue}catch(de){if(j.warn("".concat(W()," error in local data source GCM, retrying with remote data source. Error is: ").concat(Object(y.getErrorMessage)(de)),ee),$)return ne(G,n.RetrievalStrategy.Remote);var ce=A.LegacyErrorStatus.fromErrorCode(D.CrmErrorCodes.DataSourceOfflineErrorCode);throw ce.set_InnerError(de),ce.set_Stack(t.get_Stack()),j.error("".concat(W()," remote data source is not available and error in local data source GCM"),ee),Q(R,ee,ce,L(),a.MDL_COMPONENT_NAMES.ModernDataSourceGCM,"getClientMetadata failed (known allowed error)"),ce}}))()}}function H(e,t,r,n,a,i,o,s,u,c){return G.apply(this,arguments)}function G(){return(G=k((function*(e,t,r,i,o,s,u,c,l,d){l.push({name:"FinalRetrievalStrategy",value:n.RetrievalStrategy[r]});try{null==c||c.AppendCallStack("".concat(W(),"._sendGCMRequestInternal"));var p=yield Object(j._sendRequest)(e,t,s,r,u,!0,l),f=yield o(Object(v.toGCMResponse)(p,i,c,s));return!Object(m.IsNullOrUndefined)(f)&&Object.keys(f).length>0&&!d&&(f.finalRetrievalStrategy=r),f}catch(y){var h=M.ErrorStatus.toLegacyErrorStatus(Object(M.convertToErrorStatus)(y));return s.error("".concat(W()," Get Client Metadata failed with error: ").concat(h.get_Message()),l),Q(u,l,h,t(),a.MDL_COMPONENT_NAMES.ModernDataSourceGCM,"getClientMetadata failed (known allowed error)"),Promise.reject(h)}}))).apply(this,arguments)}function Q(e,t,r,n,a,i){var o=M.ErrorStatus.fromLegacyErrorStatus(r,n);(t.push({name:b.CRM_ERROR_CODE,value:o.errorCode}),Object(L.isSLAImpactingError)(a,o.errorCode))?e.EventManager.ReportComponentFailure(a,o,"",t):e.TraceManager.getTracer(a).error("".concat(W()," ").concat(i||r.get_Message()),t)}function z(e){return{url:e.urlParameters,method:e.method,additionalHeaders:e.additionalHeaders,body:e.body}}function X(e,t){var r,n,a,i=Object(P.getOperationType)(e);t.push({name:b.CLIENT_REQUEST_ID,value:Object(v.getClientRequestId)(e)}),t.push({name:_.EVENT_PARAMETERS.CLIENT_TYPE,value:Object(y.getClientType)(z(e))}),t.push({name:_.EVENT_PARAMETERS.OPERATION_TYPE,value:i.type}),t.push({name:_.EVENT_PARAMETERS.OPERATION_TYPE,value:i.type,forceOwnColumn:!0}),t.push({name:_.EVENT_PARAMETERS.OPERATION_SUB_TYPE,value:i.subType}),t.push({name:_.EVENT_PARAMETERS.OPERATION_SOURCE,value:i.source}),t.push({name:_.EVENT_PARAMETERS.IS_OFFLINE_BY_DEFAULT_REQUEST,value:(null===(r=e.additionalParameters)||void 0===r?void 0:r[b.IS_OFFLINE_BY_DEFAULT_REQUEST])||!1}),t.push({name:_.EVENT_PARAMETERS.ENTITY_NAME,value:(null===(n=e.additionalParameters)||void 0===n?void 0:n[b.ENTITY_NAME])||"Unknown"}),t.push({name:_.EVENT_PARAMETERS.EXECUTION_HINT,value:(null===(a=e.additionalHeaders)||void 0===a?void 0:a[u.HEADER.EXECUTION_HINT])||"Unknown"});var o=e.urlParameters?Object(R.trimUrl)(e.urlParameters):null;t.push({name:b.REQUEST_URL,value:o}),t.push({name:b.REQUEST_METHOD,value:e.method||"Unknown"})}function W(e){return"[".concat(e||a.PREFIX.ModernDataSource,"]")}!function(e){e[e.None=0]="None",e[e.EntityMetadataReduction=1]="EntityMetadataReduction",e[e.UserContextMetadataReduction=2]="UserContextMetadataReduction"}(q||(q={}))},9276:function(e,t,r){"use strict";r.r(t),r.d(t,"MetadataType",(function(){return n})),r.d(t,"toMetadataQuery",(function(){return o}));var n,a=r(9046),i=r(9229);function o(e){var t,r=e&&Array.isArray(e.Exclude)&&e.Exclude.map(a.Guid.fromLegacyGuid)||[],n=new i.MetadataQuery;return n.MetadataType=(t=e.MetadataType)&&s[t]?s[t]:t,n.MetadataSubtype=e.MetadataSubtype,n.EntityLogicalName=e.EntityLogicalName,n.MetadataId=a.Guid.fromLegacyGuid(e.MetadataId),n.MetadataNames=e.MetadataNames,n.GetDefault=e.GetDefault,n.DependencyDepth=e.DependencyDepth,n.ChangedAfter=e.ChangedAfter,n.Exclude=r,n.AppId=e.AppId&&a.Guid.fromLegacyGuid(e.AppId)||null,n}!function(e){e.BusinessProcessFlow="businessprocessflow",e.MetadataVersion="metadataversion",e.UserMetadataVersion="usermetadataversion",e.BPFSelector="bpfselector"}(n||(n={}));var s={webresourcedescriptor:"webresource"}},9277:function(e,t,r){"use strict";r.r(t),r.d(t,"GetClientMetadataRequest",(function(){return a}));var n=r(9214);class a{constructor(){this.ClientMetadataQuery=void 0}getMetadata(){return{boundParameter:null,operationName:"GetClientMetadata",operationType:n.ODataOperationType.Function,parameterTypes:{ClientMetadataQuery:{typeName:"Microsoft.Dynamics.CRM.MetadataQuery",structuralProperty:n.ODataStructuralProperty.ComplexType}}}}}},9278:function(e,t,r){"use strict";r.r(t),r.d(t,"GetClientMetadataExRequest",(function(){return a}));var n=r(9214);class a{constructor(){this.ClientMetadataQuery=void 0}getMetadata(){return{boundParameter:null,operationName:"GetClientMetadataEx",operationType:n.ODataOperationType.Function,parameterTypes:{ClientMetadataQuery:{typeName:"Microsoft.Dynamics.CRM.MetadataQuery",structuralProperty:n.ODataStructuralProperty.ComplexType}}}}}},9279:function(e,t,r){"use strict";r.r(t),r.d(t,"shouldCacheMetadataRequest",(function(){return i}));var n=r(9276),a=r(9280);function i(e,t){return e!==n.MetadataType.BusinessProcessFlow&&e!==n.MetadataType.MetadataVersion&&e!==n.MetadataType.UserMetadataVersion&&t!==a.LegacyDependencyDepth.UserContext}},9280:function(e,t,r){"use strict";var n;r.r(t),r.d(t,"LegacyDependencyDepth",(function(){return n})),function(e){e[e.Unknown=0]="Unknown",e[e.OnDemandWithContext=1]="OnDemandWithContext",e[e.OnDemandWithoutContext=2]="OnDemandWithoutContext",e[e.OnDemandContextOnly=3]="OnDemandContextOnly",e[e.Offline=4]="Offline",e[e.Mobile=5]="Mobile",e[e.UserContext=6]="UserContext"}(n||(n={}))},9281:function(e,t,r){"use strict";r.r(t),r.d(t,"getUserMetadataVersion",(function(){return a})),r.d(t,"getUserMetadataVersionState",(function(){return i}));var n=r(9180);function a(e){return e&&e.metadata&&e.metadata.userMetadataVersion?e.metadata.userMetadataVersion:null}function i(e){var t=a(e);return t?t.initialized:n.InitState.Uninitialized}},9282:function(e,t,r){"use strict";r.r(t),r.d(t,"getMetadataVersion",(function(){return a})),r.d(t,"getMetadataVersionState",(function(){return i}));var n=r(9180);function a(e){return e&&e.metadata&&e.metadata.metadataVersion?e.metadata.metadataVersion:null}function i(e){var t=a(e);return t?t.initialized:n.InitState.Uninitialized}},9283:function(e,t,r){"use strict";function n(e){return!!(e&&e.metadata&&e.metadata.consistencyStrong)&&e.metadata.consistencyStrong}r.r(t),r.d(t,"getConsistencyStrong",(function(){return n}))},9284:function(e,t,r){"use strict";r.r(t),r.d(t,"PREVIEW_SET_CONSISTENCY_STRONG_ACTION",(function(){return n})),r.d(t,"setConsistencyStrong",(function(){return a}));var n="preview.form.setConsistencyStrong";function a(e){return{type:n,payload:e}}},9285:function(e,t,r){"use strict";function n(e){return null==e?void 0:e.replace(/\\"/gi,'"')}r.r(t),r.d(t,"unescapeClientMetadataQueryValue",(function(){return n}))},9286:function(e,t,r){"use strict";r.r(t),r.d(t,"ODATA_DELETE_ASYNC",(function(){return y})),r.d(t,"oDataDelete",(function(){return v}));var n=r(9045),a=r(9047),i=r(9046),o=r(9080),s=r(9085),u=r(9087),c=r(9195),l=r(9215),d=r(9183),p=r(9184),f=r(9255),h=r(9179);function m(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}var y="oData.delete.async";function v(e,t){var r=[],v=y;return{type:v,execute(y,g){return(O=function*(){var{getState:m,dispatch:O}=y;try{var E=new s.UCIContext(i.Guid.newGuid().guid);!function(e,t){e.push({name:a.EVENT_PARAMETERS.CLIENT_REQUEST_ID,value:t&&t.RequestId?t.RequestId():n.UNKNOWN})}(r,E),yield O(Object(h.retrieveEntity)(e.etn,!1,[]));var b=function(e,t,r,n){if(r&&e&&t&&r.length){for(var a of r)if(!Object(d.getEntitySetName)(e,a)){var i=t.TraceManager.getTracer(c.MDL_COMPONENT_NAMES.ODataBuilder),o=new p.ErrorStatus(n+": Entity "+a+" metadata does not exist on the server",f.ErrorCodes.InvalidEntity,null,null,null,null,null,[{name:"EntityLogicalName",value:a}]);return i.warn(o.message),o}return null}return null}(m(),g,[e.etn],v);if(b)throw b;var T=o.EntityReference.toExternalEntityReference(e),S=new l.ODataDeleteRequest(T,t);yield O(Object(u.execute)(S))}finally{}},function(){var e=this,t=arguments;return new Promise((function(r,n){var a=O.apply(e,t);function i(e){m(a,r,n,i,o,"next",e)}function o(e){m(a,r,n,i,o,"throw",e)}i(void 0)}))})();var O},getFailureParameters:()=>r}}},9287:function(e,t,r){"use strict";r.r(t),r.d(t,"retrieveGridData",(function(){return C})),r.d(t,"GRID_CLASS_ID",(function(){return S})),r.d(t,"getUpdatedRefCount",(function(){return I})),r.d(t,"retrieveGridDataSucceeded",(function(){return _}));var n=r(9047),a=r(9046),i=r(9181);r.d(t,"RETRIEVE_GRID_DATA_ACTION",(function(){return i.RETRIEVE_GRID_DATA_ACTION}));var o=r(9288),s=r(9190),u=r(9180),c=r(9083),l=r(9085),d=r(9087),p=r(9292),f=r(9294),h=r(9183),m=r(9191),y=r(9195),v=r(9297),g=r(9184),O=r(9268),E=r(9179);function b(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function T(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){b(i,n,a,o,s,"next",e)}function s(e){b(i,n,a,o,s,"throw",e)}o(void 0)}))}}var S="E7A81278-8635-4D9E-8D4D-59480B391C5B";function C(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=[];return{type:"gridData.retrieve.async",execute:(i,o,s)=>T((function*(){var{getState:u,dispatch:c}=i;try{var f,m=new l.UCIContext(a.Guid.newGuid().guid,null==s?void 0:s.isPreloadCall);r.push({name:n.EVENT_PARAMETERS.CLIENT_REQUEST_ID,value:m.RequestId()}),r.push({name:"isRefresh",value:t});var b=e.key||"query";if(!e.entityLogicalName&&e.fetchXml&&(e.entityLogicalName=Object(O.getEntityFromFetch)(Object(O.parseFetchXmlFromString)(e.fetchXml))),!e.entityLogicalName)throw new g.ErrorStatus("Unable to execute query without entity logical name");var T=p.ModernQueryBuilder.fromState(e);yield c(Object(E.retrieveEntity)(e.entityLogicalName,!1));var S=u(),C=Object(h.getPrimaryIdAttribute)(S,e.entityLogicalName);if(!C)throw new g.ErrorStatus("Unable to identify primary id of entity ".concat(e.entityLogicalName));o.DataLayerConfiguration.addStateCodeToGridData&&Object(h.getHasStateCode)(S,e.entityLogicalName)&&T.selectInternal("statecode",!1),T.selectInternal(C,!1);var _=T.getQueryState(!1,u);r.push({name:v.QUERYBUILDER_TRACE_CATEGORY_ID,value:Object(v.queryStateToTelemetryParameters)(e)}),c(N(b,_,t));var I=yield c(Object(d.retrieveMultiple)(_)),A=P(S,c,b,_,I,null===(f=o.DataLayerConfiguration.GarbageCollectionProvider)||void 0===f?void 0:f.getCurrentPage());return c(R(A)),o.EventManager.ReportComponentSuccess(y.RETRIEVE_GRID_DATA,r),A}catch(D){o.EventManager.ReportComponentFailure(y.RETRIEVE_GRID_DATA,r),Object(g.convertErrorAndRethrow)(D)}}))(),getFailureParameters:()=>r,getSuccessParameters:()=>r}}function N(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n={lists:{[e]:{initialized:r?u.InitState.Refreshing:u.InitState.Initializing,pageSize:t.pageSize}}};return{type:i.RETRIEVE_GRID_DATA_ACTION,payload:n}}function _(e,t,r,n,a,i){return R(P(e,t,n,a,i,r))}function R(e){return{type:i.RETRIEVE_GRID_DATA_ACTION,payload:e}}function P(e,t,r,n,i,s){for(var l=Object(f.serializeEntityCollection)(i),d={},p=[],h={},m=0;m<l.length;m++){var y,v=null===(y=l[m].identifier)||void 0===y?void 0:y.etn;if(v){var g,O,E=a.Guid.toString(null===(g=l[m].identifier)||void 0===g?void 0:g.id);if(Object(c.IsNullOrUndefined)(v)||Object(c.IsNullOrUndefined)(E)||d[v]||(d[v]={}),d[v][E]=l[m],p.push(null===(O=l[m])||void 0===O?void 0:O.identifier),e){var b=I(e,v,s,E);if(v&&b)if(h[v])h[v][E]=b;else{var T={[E]:b};h[v]=T}}}}var S={entities:d,lists:{[r]:{initialized:u.InitState.Initialized,lastRetrieved:new Date,records:p,pages:{[n.pageNumber]:{pagingCookie:null==n?void 0:n.pagingCookie,startGuid:p&&p.length&&p[0].id,startIndex:0,moreRecords:i.get_moreRecords()}},pageSize:null==n?void 0:n.pageSize,totalRecordCount:i.get_totalRecordCount(),totalRecordCountLimitExceeded:i.get_totalRecordCountLimitExceeded()}}};return function(e,t,r,n,a,i,s){var u={},c=I(e,r,n,a,i);a&&c&&(u[a]=c);if(s&&Object.keys(s).length>0||u&&Object.keys(u).length>0){var l={entities:s,lists:u};t(Object(o.gcUpdateData)(l))}}(e,t,s,null,null,r,h),S}function I(e,t,r,n,a){if(!e)return null;if(n&&""!==n)if(a){var i,o=Object(m.getGCListQueryDataRefCount)(e,a),u=null==o?void 0:o.slice();if(u)return null!==(i=Object(s.addReference)(u,n))&&void 0!==i?i:null}else if(t&&r){var c,l=Object(m.getGCEntityRecordDataRefCount)(e,t,r),d=null==l?void 0:l.slice();if(d)return null!==(c=Object(s.addReference)(d,n))&&void 0!==c?c:null}return null}},9288:function(e,t,r){"use strict";r.r(t),r.d(t,"garbageCollectDataNode",(function(){return c})),r.d(t,"gcUpdateData",(function(){return d})),r.d(t,"gcUpdateDataEntities",(function(){return l}));var n=r(9046),a=r(9190),i=r(9181),o=r(9289),s=r(9191),u=r(9287);function c(e){return{type:"garbage.collect.data.sync",sync:!0,execute(t,r){var{dispatch:n,getState:o}=t,u=o(),c={},l={},p=Object(s.getGCEntitiesData)(u);for(var f in p){var h=p[f];for(var m in h){var y,v=null===(y=h[m])||void 0===y?void 0:y.slice(),g=v&&Object(a.removeReference)(v,e);if(g)if(0===g.length)if(l[f])l[f][m]=null;else{var O={[m]:null};l[f]=O}else c[f]||(c[f]={}),c[f][m]=g}}var E={},b={},T=Object(s.getGCListsData)(u);for(var S in T){var C,N=null===(C=T[S])||void 0===C?void 0:C.slice(),_=N&&Object(a.removeReference)(N,e);_&&(0===_.length?b[S]=null:E[S]=_)}var R,P={},I={},A={},D={};(Object.keys(c).length>0||Object.keys(E).length>0||Object.keys(P).length>0||Object.keys(A).length>0)&&n(d({entities:c,lists:E,charts:P,chartData:A}));(Object.keys(l).length>0||Object.keys(b).length>0||Object.keys(I).length>0||Object.keys(D).length>0)&&n((R={entities:l,lists:b,charts:I,chartData:D},{type:i.GC_REMOVE_DATA_ACTION,payload:R}))}}}function l(e){return{type:"garbage.collector.update.data.entities.sync",sync:!0,execute(t,r){for(var a,{dispatch:i,getState:o}=t,s=null===(a=r.DataLayerConfiguration.GarbageCollectionProvider)||void 0===a?void 0:a.getCurrentPage(),c={},l=0;l<e.length;l++){var p=n.Guid.toString(e[l].id),f=e[l].etn,h=Object(u.getUpdatedRefCount)(o(),f,p,s);if(h)if(c[f])c[f][p]=h;else{var m={[p]:h};c[f]=m}}Object.keys(c).length>0&&i(d({entities:c}))}}}function d(e){return{type:o.GC_UPDATE_DATA_ACTION,payload:e}}},9289:function(e,t,r){"use strict";r.r(t),r.d(t,"garbageCollectorDataReducer",(function(){return m})),r.d(t,"GC_REMOVE_DATA_ACTION",(function(){return i})),r.d(t,"GC_UPDATE_DATA_ACTION",(function(){return o}));var n=r(9290),a=r(9291),i="gc.data.remove",o="gc.data.update",s={},u=[o,i],c=[o,i],l={};function d(e,t){if(0===Object.keys(t).length)return e;var r=Object.assign({},e);for(var n in t){var a=t[n];for(var i in a)r[n]||(r[n]=t[n]),r[n][i]=t[n][i]}return Object.freeze(r)}function p(e,t){if(0===Object.keys(t).length)return e;var r={};for(var n in e){var a=e[n];if(void 0===t[n])r[n]=e[n];else for(var i in a)void 0===t[n][i]&&(r[n]||(r[n]={}),r[n][i]=t[n][i])}return Object.freeze(r)}var f=[o,i];var h={entities:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,t=arguments.length>1?arguments[1]:void 0;return-1!==u.indexOf(t.type)&&t&&t.payload&&t.payload.entities?t.type===i?p(e,t.payload.entities):d(e,t.payload.entities):e},lists:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s,t=arguments.length>1?arguments[1]:void 0;return-1!==f.indexOf(t.type)&&t&&t.payload&&t.payload.lists?t.type===i?Object(a.gcGenericRemoveItems)(e,t.payload.lists):Object(a.gcGenericAddItems)(e,t.payload.lists):e},charts:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,t=arguments.length>1?arguments[1]:void 0;return-1!==c.indexOf(t.type)&&t&&t.payload&&t.payload.charts?t.type===i?p(e,t.payload.charts):d(e,t.payload.charts):e},chartData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s,t=arguments.length>1?arguments[1]:void 0;return-1!==c.indexOf(t.type)&&t&&t.payload&&t.payload.chartData?t.type===i?Object(a.gcGenericRemoveItems)(e,t.payload.chartData):Object(a.gcGenericAddItems)(e,t.payload.chartData):e}},m=Object(n.combineReducers)(h)},9290:function(e,t,r){"use strict";function n(e){return function(e){return(t,r)=>{var n=void 0===t?{}:t,a={},i=!1,o=Object.keys(e);for(var s of o){var u=e[s],c=n[s],l=u(c,r);a[s]=l,i=i||l!==c}var d=i?a:n;return Object.freeze(d)}}(function(e){var t={},r=Object.keys(e);for(var n of r)t[n]=e[n];return t}(e))}r.r(t),r.d(t,"combineReducers",(function(){return n}))},9291:function(e,t,r){"use strict";r.r(t),r.d(t,"gcMetadataEntitiesReducer",(function(){return o})),r.d(t,"gcMetadataRibbonsReducer",(function(){return s})),r.d(t,"gcGenericAddItems",(function(){return u})),r.d(t,"gcGenericRemoveItems",(function(){return c}));var n=r(9189),a=[n.UPDATE_GC_METADATA_REFCOUNT_ACTION,n.GC_REMOVE_METADATA],i={};function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i,t=arguments.length>1?arguments[1]:void 0;return-1!==a.indexOf(t.type)&&t&&t.payload&&t.payload.entities?t.type===n.GC_REMOVE_METADATA?c(e,t.payload.entities):u(e,t.payload.entities):e}function s(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i,t=arguments.length>1?arguments[1]:void 0;return-1!==a.indexOf(t.type)&&t&&t.payload&&t.payload.ribbons?t.type===n.GC_REMOVE_METADATA?c(e,t.payload.ribbons):u(e,t.payload.ribbons):e}function u(e,t){if(0===Object.keys(t).length)return e;var r=Object.assign({},e);for(var n in t)r[n]=Object.freeze(t[n]);return Object.freeze(r)}function c(e,t){if(0===Object.keys(t).length)return e;var r={};for(var n in e)void 0===t[n]&&(r[n]=e[n]);return Object.freeze(r)}},9292:function(e,t,r){"use strict";r.r(t),r.d(t,"ModernQueryBuilder",(function(){return c})),r.d(t,"buildContextFilter",(function(){return l}));var n=r(9268),a=r(9046),i=r(9293),o=r(9185),s=r(9232),u=r(9140);class c{constructor(e){this._query=void 0,this._fetchDocument=void 0,this._isFetchXmlParsed=void 0,this._selectsInKey=void 0,this._childCountAttributes=void 0,this._resetSort=void 0,this._query=e?Object.assign({},e):{},this._query.selects=this._query.selects||[],this._selectsInKey=this._query.selects?this._query.selects.map(e=>!0):[],this._query.linkEntities=this._query.linkEntities||[],this._query.sorts=this._query.sorts||[],this._query.wheres=this._query.wheres||[],this._query.contextFiltersAndIds=this._query.contextFiltersAndIds||[],this._query.searchString=this._query.searchString||"",this._query.isQuickFindSearch=this._query.isQuickFindSearch||!1,this._childCountAttributes=[],this._isFetchXmlParsed=!1,this._query.isFetchXmlModified=this._query.isFetchXmlModified||!1,this._resetSort=!1}get fetchDocument(){return this._isFetchXmlParsed||this._parseFetchXmlFromString(this._query.fetchXml),this._fetchDocument}_parseFetchXmlFromString(e){e&&(this._fetchDocument=Object(n.parseFetchXmlFromString)(e),this._isFetchXmlParsed=!0)}static fromView(e,t){var r=new c;return r._query.viewId=e,r._query.searchString=t||"",r}static fromXml(e,t,r){var n=new c;return n._query.fetchXml=e,n._query.viewId=t,n._query.searchString=r,n}static fromState(e){return new c(e)}select(){for(var e=[],t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];for(var a=0;a<r.length;a++)this._query.selects&&-1===this._query.selects.indexOf(r[a])&&e.push(r[a]);return this._query.selects&&this._query.selects.push(...e),this._selectsInKey.push(...e.map(e=>!0)),this}selectAll(){return this._query.isAllColumns=!0,this}from(e){return this._query.entityLogicalName=e,this}selectInternal(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this._query.selects&&-1===this._query.selects.indexOf(e)&&(this._query.selects.push(e),this._selectsInKey.push(t)),this}addLinkedEntity(e,t){var r=Object(n.buildLinkedEntityNode)(e,t);return this._query.linkEntities&&this._query.linkEntities.push(r),this}orderBy(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return this._query.sorts&&this._query.sorts.push(e+(t?" desc":" asc")),this._resetSort=r,this}addChildCountAttribute(e){return this._childCountAttributes.push(e),this}applyContextFilter(e,t,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:i.RelationshipRoleOrdinal.Referencing,s=l(e,this._query.entityLogicalName||Object(n.getEntityFromFetch)(this.fetchDocument),o,r),u=a.Guid.toString(t);return this._query.contextFiltersAndIds&&this._query.contextFiltersAndIds.push("".concat(u,"=").concat(s)),this}toFetchXml(e){if(function(e){e&&!e.pageNumber&&(e.pageNumber=1);e&&!e.pageSize&&(e.pageSize=25);e&&(e.useModernQueryBuilder=!0)}(this._query),!this.fetchDocument){if(!e)throw Object(o.createUciError)("ModernQueryBuilder: getState function not provided");if(!this._query.viewId)throw Error("ModernQueryBuilder: view id not provided to retrieve fetch xml for the view")}if(!this.fetchDocument)throw Error("ModernQueryBuilder: fetch xml not provided");return this._query.isFetchXmlModified||this._applyModificationsToFetchXml(),Object(n.setFetchXmlParameters)(this.fetchDocument,this._query.pageSize,this._query.pageNumber,!0,!1),(new XMLSerializer).serializeToString(this.fetchDocument)}getQueryState(){var e=arguments.length>1?arguments[1]:void 0;return arguments.length>0&&void 0!==arguments[0]&&arguments[0]||(this._query.fetchXml=this.toFetchXml(e),this._query.entityLogicalName||(this._query.entityLogicalName=Object(n.getEntityFromFetch)(this.fetchDocument)),this._query.key=this.getKey()),this._query}get pageSize(){return this._query.pageSize}set pageSize(e){this._query.pageSize=e}set pageNumber(e){this._query.pageNumber=e}get pageNumber(){return this._query.pageNumber}getKey(){return this._query.selects?"".concat(this._getBaseKey(),": ").concat(this._query.selects.filter((e,t)=>this._selectsInKey[t]),": ").concat(this._query.wheres,": ").concat(this._query.sorts,": ").concat(this._query.contextFiltersAndIds,": ").concat(this._query.linkEntities,": ").concat(this._query.isQuickFindSearch,": ").concat(this._query.searchString,": ").concat(this._query.pageSize):null}getPublicKey(){return this._query.selects?"".concat(this._getBaseKey(),": ").concat(this._query.selects.filter((e,t)=>this._selectsInKey[t]),": ").concat(this._query.sorts,": ").concat(this._query.contextFiltersAndIds,": ").concat(this._query.linkEntities,": ").concat(this._query.pageSize):null}_getBaseKey(){return this._query.viewId?"".concat(this._query.entityLogicalName,"-").concat(a.Guid.toString(this._query.viewId)):a.Guid.toString(this._query.viewId)}_applyModificationsToFetchXml(){this._query.selects&&this._query.selects.length>0&&(Object(n.isFetchAll)(this.fetchDocument)||Object(n.addColumns)(this.fetchDocument,this._query.selects)),this._query.linkEntities&&this._query.linkEntities.length>0&&this._query.linkEntities.forEach(e=>Object(n.addLinkedEntity)(this.fetchDocument,e)),this._query.wheres&&this._query.wheres.length>0&&this._query.wheres.forEach(e=>Object(n.addFilters)(this.fetchDocument,e)),this._resetSort&&Object(n.removeOrderElements)(this.fetchDocument),this._query.sorts&&this._query.sorts.length>0&&this._query.sorts.forEach(e=>{var t=e.split(" ");Object(n.addSort)(this.fetchDocument,t[0],"desc"===t[1])}),this._childCountAttributes.length>0&&this._childCountAttributes.forEach(e=>Object(n.addChildCountAttribute)(this.fetchDocument,e)),this._query.contextFiltersAndIds&&this._query.contextFiltersAndIds.length>0&&this._query.contextFiltersAndIds.forEach(e=>{var t=e.indexOf("="),r=e.substring(0,t),a=e.substring(t+1,e.length);Object(n.addContextFilter)(this.fetchDocument,a,r)}),this._query.isFetchXmlModified=!0}applyRollupContextFilter(){throw new Error("Not implemented")}where(e,t,r){var n=s.Expression.toLegacyFilterExpression(e,r).toFetchXml();return this._query&&(t?this._query.wheres=[n]:this._query.wheres&&this._query.wheres.push(n)),this._query.expression?this._query.expression.terms.push(e):this._query.expression=new s.Expression(u.LogicalOperatorString.and,e),this}setDefaultPageSize(){throw new Error("Not implemented")}getFirstError(){throw new Error("Not implemented")}addExistingContextFilterToKey(){throw new Error("Not implemented")}validateLinkedEntity(){throw new Error("Not implemented")}get fetchXml(){throw new Error("Not implemented")}}function l(e,t,r,n){return null}},9293:function(e,t,r){"use strict";var n;r.r(t),r.d(t,"RelationshipRoleOrdinal",(function(){return n})),function(e){e[e.Referencing=1]="Referencing",e[e.AssociationEntity=2]="AssociationEntity"}(n||(n={}))},9294:function(e,t,r){"use strict";r.r(t),r.d(t,"serializeEntityCollection",(function(){return a}));var n=r(9295);function a(e){var t=e.get_entities(),r=e.get_query(),a=[];r&&null!=r&&r.GetColumnNamesFromFetch&&(a=null==r?void 0:r.GetColumnNamesFromFetch());for(var i=[],o=0;o<t.length;o++){var s=Object(n.serializeEntityRecord)(t[o]);s.queryColumnNames=a,delete s.accessRights,i.push(s)}return i}},9295:function(e,t,r){"use strict";r.r(t),r.d(t,"serializeEntityRecord",(function(){return u}));var n=r(9048),a=r(9046),i=r(9080),o=r(9180),s=r(9296);function u(e){if(!e)throw new Error("Legacy entity record is null");var t=e.get_fieldNames(),r=e.get_fieldTypes(),n={},a=new Date;if(t)for(var u of t){var l=r[u],d=e.getValue(u);null!==d?n[u]=c(u,l,d,e,a):n[u]=null}var p,f,h=e.get_globalNavigationData();if(h){var m=i.EntityReference.fromLegacyEntityReference(h.get_identifier());m&&(f=m.id);var y=h.getValue("processid");if(y)p=i.EntityReference.fromLegacyEntityReference(y).id}return{initialized:o.InitState.Initialized,identifier:i.EntityReference.fromLegacyEntityReference(e.get_identifier()),accessRights:Object(s.serializeAccessRights)(e),fields:n,businessProcessFlowId:p,businessProcessFlowInstanceId:f}}function c(e,t,r,o,s){var l={errorId:null,errorMessage:null,isValueValid:!0,userInput:null,isOfflineSyncError:!1};switch(t){case n.AttributeType.Boolean:case n.AttributeType.PickList:case n.AttributeType.State:case n.AttributeType.Status:var d=r;return{label:d.get_Label(),valueString:d.get_ValueString(),timestamp:s,validationResult:l};case n.AttributeType.UniqueIdentifier:var p=r;return{id:a.Guid.fromLegacyGuid(p),timestamp:s,validationResult:l};case n.AttributeType.Customer:case n.AttributeType.Lookup:case n.AttributeType.Owner:var f=r;return{reference:i.EntityReference.fromLegacyEntityReference(f),timestamp:s,validationResult:l};case n.AttributeType.AliasedValue:var h=r,m=h.get_entityLogicalName(),y=h.get_attributeLogicalName(),v=h.get_attributeType();return{attributeLogicalName:y,entityLogicalName:m,innerValue:c(e,v,h.get_value(),o,s),timestamp:s,validationResult:l,innerType:v};case n.AttributeType.PartyList:var g=r,O=[];for(var E of g.get_entities())O.push(u(E));return{list:O,timestamp:s,validationResult:l};case n.AttributeType.NavigationProperty:var b=r,T=[];for(var S of b)T.push(u(S));return{list:T,timestamp:s,validationResult:l};default:t===n.AttributeType.DateTime&&(r=r&&r.toISOString());var C=o.get_formattedValues();if(C.hasOwnProperty(e))return{value:r,formatted:C[e],timestamp:s,validationResult:l};var N=o.get_numericFormattedValues();return N.hasOwnProperty(e)?{value:r,formatted:N[e],timestamp:s,validationResult:l}:{value:r,timestamp:s,validationResult:l}}}},9296:function(e,t,r){"use strict";r.r(t),r.d(t,"serializeAccessRights",(function(){return a}));var n=r(9046);function a(e){var t={recordPrivileges:e.get_accessRights()},r=e.get_userSharedAttributePrivileges();if(r){var a={};for(var i in r){var o=r[i];a[i]={accessRightsMask:o.get_AccessRightsMask(),attributeId:n.Guid.fromLegacyGuid(o.get_AttributeId()),canCreate:o.get_CanCreate(),canRead:o.get_CanRead(),canUpdate:o.get_CanUpdate()}}t.attributePrivileges=a}return t}},9297:function(e,t,r){"use strict";r.r(t),r.d(t,"QueryBuilderTelemetryHelper",(function(){return i})),r.d(t,"queryStateToTelemetryParameters",(function(){return o})),r.d(t,"QUERYBUILDER_TRACE_CATEGORY_ID",(function(){return a}));var n=r(9046),a="QueryBuilder";class i{constructor(){this._telemetryMessage=void 0,this._telemetryParameters=void 0,this._operations=void 0,this._telemetryMessage="",this._telemetryParameters=[],this._operations=[]}addOperation(e,t){this._telemetryMessage="to"===e||"from"===e?this._telemetryMessage?"".concat(this._telemetryMessage,", ").concat(t):t:this._telemetryMessage?"".concat(this._telemetryMessage,", ").concat(e):e,t&&this._operations.push({name:e,value:t})}addQueryInfoAndSendLog(e,t){i.tracer&&(this._addTelemetryParameter("viewId",e),this._addTelemetryParameter("entityLogicalName",t),this._addTelemetryParameter("operations",this._operations),i.tracer.info("[".concat(a,"] ").concat(t,"-").concat(e,": ")+this._telemetryMessage,this._telemetryParameters))}_addTelemetryParameter(e,t){t&&this._telemetryParameters.push({name:e,value:t})}}function o(e){var t=[];if(e){var r,a,i,o,s,u,c;null!=e&&e.viewId&&t.push({name:"viewId",value:n.Guid.toString(null==e?void 0:e.viewId)}),null!=e&&e.entityLogicalName&&t.push({name:"entityLogicalName",value:null==e?void 0:e.entityLogicalName}),null!=e&&e.useModernQueryBuilder&&t.push({name:"useModernQueryBuilder",value:null==e?void 0:e.useModernQueryBuilder});var l,d,p=[];if(p.push({name:"isQuickFindSearch",value:null==e?void 0:e.isQuickFindSearch}),null==e||null===(r=e.sorts)||void 0===r||r.forEach(e=>{p.push({name:"orderBy",value:e})}),null!=e&&null!==(a=e.wheres)&&void 0!==a&&a.length&&(null==e||null===(i=e.wheres)||void 0===i?void 0:i.length)>0)p.push({name:"where",value:null==e||null===(l=e.wheres)||void 0===l?void 0:l.length});if(null!=e&&null!==(o=e.selects)&&void 0!==o&&o.length&&(null==e||null===(s=e.selects)||void 0===s?void 0:s.length)>0)p.push({name:"select",value:null==e||null===(d=e.selects)||void 0===d?void 0:d.toString()});null==e||null===(u=e.linkEntities)||void 0===u||u.forEach(e=>{p.push({name:"addLinkedEntity",value:e})}),null==e||null===(c=e.contextFiltersAndIds)||void 0===c||c.forEach(e=>{p.push({name:"applyContextFilter",value:e})}),null!=e&&e.rollupType&&p.push({name:"applyRollupContextFilter",value:null==e?void 0:e.rollupType.toString()}),t.push({name:"operations",value:p})}return t}i.tracer=void 0},9298:function(e,t,r){"use strict";r.r(t),r.d(t,"RETRIEVE_USER_CONTEXT_ASYNC",(function(){return f})),r.d(t,"retrieveUserContext",(function(){return h}));var n=r(9046),a=r(9299),i=r(9277),o=r(9229),s=r(9280),u=r(9087),c=r(9195),l=r(9184);function d(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function p(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){d(i,n,a,o,s,"next",e)}function s(e){d(i,n,a,o,s,"throw",e)}o(void 0)}))}}var f="user.retrieve.async";function h(){return{type:f,execute:(e,t)=>p((function*(){var{dispatch:r}=e,n=t.TraceManager.getTracer(c.MDL_COMPONENT_NAMES.UserContext);try{var o=new a.ClientMetadataQuery(null,null,null,null,[],!1,s.LegacyDependencyDepth.UserContext,null,[],null),d={cultureInfo:{},timeZoneDefinitions:[],name:"",id:""},p=new i.GetClientMetadataRequest;p.ClientMetadataQuery=m(o);var f=yield r(Object(u.execute)(p)),h=yield Object(u.parseJsonResponse)(f,n);if(h.Metadata){var y=JSON.parse(h.Metadata);if(y&&y.UserContext&&y.UserContext[0]){var v=JSON.parse(y.UserContext[0].UserSettings.ClientCultureInfo);return d.cultureInfo=v,d.timeZoneDefinitions=y.UserContext[0].TimeZoneDefinitions,d.name=y.UserContext[0].UserName||"",d.id=y.UserContext[0].UserId||"",d}var g="UserContext response is empty or null";throw n.error(g),new Error(g)}var O="UserContext response.Metadata is empty or null";throw n.error(O),new Error(O)}catch(E){Object(l.convertErrorAndRethrow)(E)}}))()}}function m(e){var t=e&&Array.isArray(e.Exclude)&&e.Exclude.map(n.Guid.fromLegacyGuid)||[],r=new o.MetadataQuery;return r.MetadataType=e.MetadataType,r.MetadataSubtype=e.MetadataSubtype,r.EntityLogicalName=e.EntityLogicalName,r.MetadataId=n.Guid.fromLegacyGuid(e.MetadataId),r.MetadataNames=e.MetadataNames,r.GetDefault=e.GetDefault,r.DependencyDepth=e.DependencyDepth,r.ChangedAfter=e.ChangedAfter,r.Exclude=t,r.AppId=e.AppId&&n.Guid.fromLegacyGuid(e.AppId)||null,r}},9299:function(e,t,r){"use strict";r.r(t),r.d(t,"ClientMetadataQuery",(function(){return n}));class n{constructor(e,t,r,n,a,i,o,s,u,c){this.MetadataType=void 0,this.MetadataSubtype=void 0,this.EntityLogicalName=void 0,this.MetadataId=void 0,this.MetadataNames=void 0,this.GetDefault=!1,this.DependencyDepth=0,this.ChangedAfter=void 0,this.Exclude=null,this.AppId=null,this.IsPreloadCall=!1,this.MetadataType=e,this.MetadataSubtype=t,this.EntityLogicalName=r,this.MetadataId=n,this.MetadataNames=a,this.GetDefault=i,this.DependencyDepth=o,this.ChangedAfter=s,this.Exclude=u,this.AppId=c}}},9300:function(e,t,r){"use strict";r.r(t),r.d(t,"saveDataSnapshot",(function(){return A})),r.d(t,"saveDataSnapshotFromSnapshot",(function(){return D})),r.d(t,"saveDataSnapshots",(function(){return F})),r.d(t,"REMOVE_LOCKED_CHANGES",(function(){return S})),r.d(t,"SAVE_DATA_SNAPSHOT_ASYNC",(function(){return C})),r.d(t,"SAVE_MULTIPLE_DATA_SNAPSHOTS",(function(){return N})),r.d(t,"saveMultipleDataSnapshots",(function(){return _}));var n=r(9046),a=r(9080),i=r(9215),o=r(9216),s=r(9200),u=r(9087),c=r(9211),l=r(9301),d=r(9183),p=r(9227),f=r(9302),h=r(9184),m=r(9084),y=r(9179),v=r(9303),g=r(9304),O=r(9305),E=r(9196);function b(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function T(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){b(i,n,a,o,s,"next",e)}function s(e){b(i,n,a,o,s,"throw",e)}o(void 0)}))}}var S="dataSnapshot.removeLockedChanges",C="dataSnapshot.save.async",N="dataSnapshot.saveMultiple.async";function _(e,t,r,n){return{type:N,execute:(a,i)=>T((function*(){var{dispatch:o,getState:s}=a,u=i.TraceManager.getTracer("Forms.SaveForm"),c=s(),l=[];for(var d of(c=s(),e)){var p=Object(f.getSnapshot)(c,d);if(!p)throw u.error("Invalid snapshot"),L(d);l.push(p)}return o(R(l,t,r,n))}))()}}function R(e,t,r,n){return{type:"multipledataSnapshot.savefromMultipleSnapshot.async",execute:(a,i)=>T((function*(){var{getState:o,dispatch:s}=a,u=[],c=new Map,l=i.TraceManager.getTracer("Forms.SaveForms"),d=0;for(var p of e)yield s(Object(y.retrieveEntities)(w({},p)));for(var f of e){var m=P(o(),f,l,t);u.push(m),c.set(d++,f);var g=f.snapshotId;g&&s(Object(v.setDataSnapshotLock)(g,!0))}try{for(var O=[u],b=yield s(Object(E.executeMultiple)(O)),T=[],S=0;S<b.length;S++){var C=u[S].getMetadata().operationName;if("Update"===C||"Create"===C){var N=c.get(S);if(N){var _=r&&r[N.identifier.etn];T.push(s(I(N,b[S],N.snapshotId,_,n)))}}}return Promise.all(T)}catch(L){var R=Object(h.convertToErrorStatus)(L),A=R.faultedRequestIndex;if(A>-1&&c.size>A){var D=c.get(A);D&&(R.faultedSnapshotId=D.snapshotId),R.snapshot=D}for(var M of e){var F=M.snapshotId;F&&s(Object(v.setDataSnapshotLock)(F,!1))}throw R}}))()}}function P(e,t,r,a){if(t&&t.identifier){var o=function(e,t,r){return s.EntityRecord.recordDataToLegacyEntityRecord(e,t.identifier,t.activeChanges,t.snapshotId,r)}(e,t,r),u=Object(p.buildEntityPayload)(e,o);if(t.mode===l.SnapshotMode.Create){if(!n.Guid.isNullOrEmpty(t.identifier.id)){var c=t.identifier.etn,f=Object(d.getEntityDescriptor)(e,c);if(f){var h=f.PrimaryIdAttribute;h&&!u.hasOwnProperty(h)&&(u[h]=n.Guid.toString(t.identifier.id))}}return new i.ODataCreateRequest(t.identifier.etn,u,a)}return new i.ODataUpdateRequest(t.identifier.etn,n.Guid.toString(t.identifier.id),u,null,null,!1,a)}throw L()}function I(e,t,r,i,s){return{type:"dataSnapshot.refreshRecordAndUpdateSnapshot.async",execute:(u,c)=>T((function*(){var{dispatch:p,getState:f}=u,h=e.mode===l.SnapshotMode.Create,m=Object(d.getPrimaryIdAttribute)(f(),e.identifier.etn),y=yield Object(o.getEntityIdFromResponse)(m,t),v=new a.EntityReference(e.identifier.etn,y);return r&&h&&p(Object(O.updateDataSnapshotMode)(r,l.SnapshotMode.Update)),r&&n.Guid.isNullOrEmpty(e.identifier.id)&&p(Object(g.updateDataSnapshotIdentifier)(r,v)),i&&c.DataLayerConfiguration.DataProvider&&(yield c.DataLayerConfiguration.DataProvider.refreshRecordData(v,h,i,s)),r&&p(function(e){return{type:S,payload:null,meta:e}}(r)),v}))()}}function A(e,t,r,n){return{type:C,execute(a){var{dispatch:i,getState:o}=a,s=o(),u=Object(f.getSnapshot)(s,e);if(!u)throw L(e);return i(M(u,t,e,r,n))}}}function D(e,t,r,n){return{type:"dataSnapshot.savefromSnapshot.async",execute:a=>T((function*(){var{dispatch:i}=a;return i(M(e,t,null,r,n))}))()}}function M(e,t,r,n,a){return{type:C,execute:(i,o)=>T((function*(){var{getState:s,dispatch:c}=i;null!=e&&e.identifier||L(),yield c(Object(y.retrieveEntities)(w({},e,n)));var l=o.TraceManager.getTracer("Forms.SaveForm"),d=P(s(),e,l,t);r&&c(Object(v.setDataSnapshotLock)(r,!0));try{var p=yield c(Object(u.execute)(d));return c(I(e,p,r,n,a))}catch(f){r&&c(Object(v.setDataSnapshotLock)(r,!1)),Object(h.convertErrorAndRethrow)(f)}}))()}}function F(e,t){return{type:"multipledataSnapshot.savefromMultipleSnapshot.async",execute:r=>T((function*(){var{dispatch:n}=r;return n(R(e,t))}))()}}function w(e,t,r){var n=r?r.slice(0):[];for(var a in Object(m.addAttributes)(e,t.identifier.etn,n),t.activeChanges){n.push(a);var i=t.activeChanges[a];if(Object(c.isPartylistValue)(i)){var o=i;if(o.list)for(var s of o.list){var u,l=null===(u=s.identifier)||void 0===u?void 0:u.etn;l&&Object(m.addAttributes)(e,l,s.fields?Object.keys(s.fields):[])}}else if(Object(c.isReferenceValue)(i)){var d,p=i;(null===(d=p.reference)||void 0===d?void 0:d.etn)&&Object(m.addAttributes)(e,p.reference.etn,[])}}return e}function L(e){var t=new h.ErrorStatus("Invalid snapshot");throw e&&(t.errorParameters=[{name:"SnapshotId",value:e}]),t}},9301:function(e,t,r){"use strict";var n;r.r(t),r.d(t,"SnapshotMode",(function(){return n})),function(e){e[e.Create=2]="Create",e[e.Update=3]="Update"}(n||(n={}))},9302:function(e,t,r){"use strict";r.r(t),r.d(t,"getLastSnapshotNumber",(function(){return i})),r.d(t,"getNextSnapshotNumber",(function(){return o})),r.d(t,"getSnapshot",(function(){return s})),r.d(t,"getSnapshotByEntityReference",(function(){return u})),r.d(t,"getUpdatedFieldValue",(function(){return c})),r.d(t,"isFieldDirty",(function(){return d})),r.d(t,"isFormDirty",(function(){return p})),r.d(t,"toUpdatedListPageRecord",(function(){return f})),r.d(t,"isFieldNameActiveInSnapshot",(function(){return l}));var n=r(9080),a=r(9198);function i(e){return e&&e.data&&void 0!==e.data.lastSnapshotNumber?e.data.lastSnapshotNumber:null}function o(e){var t=i(e);return null===t?0:t+1}function s(e,t){return e&&e.data&&e.data.snapshots&&t&&e.data.snapshots.hasOwnProperty(t)?e.data.snapshots[t]:null}function u(e,t){if(!e||!e.data||!e.data.snapshots)return null;var r=Object.keys(e.data.snapshots).filter(r=>n.EntityReference.equals(e.data.snapshots[r].identifier,t));return r&&r.length>0?e.data.snapshots[r[r.length-1]]:null}function c(e,t,r,n){var i=s(e,t);if(i){var o=i.activeChanges?i.activeChanges[n]:i.lockedChanges?i.lockedChanges[n]:null;if(o)return o}return Object(a.getFieldValue)(e,r,n)}function l(e,t,r){return d(e,t,r)}function d(e,t,r){var n=s(e,t);return!(!n||!n.activeChanges)&&n.activeChanges.hasOwnProperty(r)}function p(e,t){var r=s(e,t);return!(!r||!r.activeChanges)}function f(e,t,r,n,a){var i={initialized:r.initialized,identifier:n,fields:{}};if(r)for(var o of a)i.fields[o]=c(e,t,n,o);return i}},9303:function(e,t,r){"use strict";r.r(t),r.d(t,"SET_DATA_SNAPSHOT_LOCK",(function(){return n})),r.d(t,"setDataSnapshotLock",(function(){return a}));var n="dataSnapshot.setLock";function a(e,t,r){return{type:n,payload:t,meta:{snapshotId:e,selectedFields:r}}}},9304:function(e,t,r){"use strict";r.r(t),r.d(t,"updateDataSnapshotIdentifier",(function(){return a})),r.d(t,"UPDATE_DATA_SNAPSHOT_IDENTIFIER",(function(){return n}));var n="dataSnapshot.updateIdentifier";function a(e,t){return{type:n,payload:t,meta:e}}},9305:function(e,t,r){"use strict";r.r(t),r.d(t,"updateDataSnapshotMode",(function(){return a})),r.d(t,"UPDATE_DATA_SNAPSHOT_MODE",(function(){return n}));var n="dataSnapshot.updateMode";function a(e,t){return{type:n,payload:t,meta:e}}},9306:function(e,t,r){"use strict";r.r(t),r.d(t,"ModelAuthenticationProvider",(function(){return s}));var n=r(479),a=r(9195),i=r(9083);function o(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}class s{constructor(){this._context=void 0}initialize(e){this._context=e}getAuthToken(){var e,t=this;return(e=function*(){var e,r=null===(e=t._context)||void 0===e?void 0:e.TraceManager.getTracer(a.MDL_COMPONENT_NAMES.AuthenticationProvider);try{var o,s=yield Object(n.acquireTokenSilentAsync)(null===(o=t._context)||void 0===o?void 0:o.DataLayerConfiguration.baseUri);if(Object(i.IsNullOrUndefined)(s)||Object(i.IsNullOrUndefined)(s.accessToken))throw null==r||r.error("getAuthToken failed to acquire token"),new Error("getAuthToken failed to acquire token");return s.accessToken}catch(u){throw null==r||r.error(u.message),u}},function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function s(e){o(i,n,a,s,u,"next",e)}function u(e){o(i,n,a,s,u,"throw",e)}s(void 0)}))})()}getUserObjectId(){return"00000000-0000-0000-0000-000000000000"}getTenantId(){return"00000000-0000-0000-0000-000000000000"}}},9307:function(e,t,r){"use strict";r.r(t),r.d(t,"GarbageCollectionProvider",(function(){return a}));var n=r(9189);class a{constructor(){this._currentPage=void 0,this._store=void 0}initialize(e){this._store=e}getCurrentPage(){return this._currentPage}setCurrentPage(e){this._currentPage=e}runGarbageCollection(e){this._store&&this._store.dispatch(Object(n.garbageCollectMetadata)(e))}}},9308:function(e,t,r){"use strict";r.r(t),r.d(t,"ModelMetadataProvider",(function(){return f}));var n=r(6030),a=r(9309),i=r(9310),o=r(9195),s=r(9312),u=r(9316);function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){d(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function d(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function p(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}class f{constructor(e){this.metadataChangeListenerList=void 0,this._innerMetadataProvider=void 0,this._store=void 0,this._context=void 0,this.metadataChangeListenerList=[],this._innerMetadataProvider=e}initialize(e,t){this._store=e,this._context=t}get metadataProvider(){return this._innerMetadataProvider}retrieveEntities(e){var t,r=this;return(t=function*(){var t,a=yield r._innerMetadataProvider,i=e&&Object.keys(e).sort(),s={},c=null===(t=r._context)||void 0===t?void 0:t.TraceManager.getTracer("RetrieveEntity");for(var l of i){Object(u.subscribeToMetadataChange)(l,r,r._store.getState,r._store.dispatch,r._context);var d={solutionId:"",solutionName:"",entityName:l,entityId:""},p={fetchModelComponents:!1,retryOnFailure:!1,solutionFilterMode:n.SolutionFilterMode.RemoveOtherSolutions,fetchAutoNumberDetails:!1,fetchLookupRelatedEntityLabels:!1},f={scenarioName:"".concat(o.MDL_ID).concat("RetrieveEntity")},h=yield a.fetchExpandedEntity(d,p,f),m=r._convertMclEntityToMetadataState(h,c);Object.assign(s,m)}return s},function(){var e=this,r=arguments;return new Promise((function(n,a){var i=t.apply(e,r);function o(e){p(i,n,a,o,s,"next",e)}function s(e){p(i,n,a,o,s,"throw",e)}o(void 0)}))})()}_convertMclEntityToMetadataState(e,t){var r=[],n={};for(var o of e.Attributes){r.push(o.LogicalName);var u=l(l({},o),{},{EntityLogicalName:e.LogicalName,ColumnNumber:0,IntroducedVersion:"",DeprecatedVersion:"",HasChanged:!1,IsEntityReferenceStored:!1,LinkedAttributeId:null,ExtensionData:null,AttributeOf:o||""});n[o.LogicalName]=Object(a.serializeAttributeDescriptor)(u,t)}var c=l(l({},e),{},{AttributeNames:r}),d=Object(i.serializeEntityDescriptors)([c],0,0,null,s.InitState.Initialized,t);return d.attributes&&(d.attributes[null==e?void 0:e.LogicalName]=n),d}}},9309:function(e,t,r){"use strict";r.r(t),r.d(t,"serializeRequiredLevel",(function(){return d})),r.d(t,"serializeAttributeDescriptor",(function(){return p})),r.d(t,"serializeAttributeDescriptorsFromEntity",(function(){return c})),r.d(t,"getOptionDescriptorsFromOptionSet",(function(){return f})),r.d(t,"getLabelString",(function(){return m})),r.d(t,"getAttributeFormatString",(function(){return v}));var n=r(9048),a=r(9055),i=r(9046),o=r(9083),s=r(9051),u=r(9180);function c(e,t){var r=e.Attributes,n={};if(r)for(var a of r){var i=p(a,t);n[i.LogicalName]=i}return n}function l(e){if("string"!=typeof e)return"number"==typeof e?e:null;switch(e){case"Auto":return 0;case"Inactive":return 1;case"Active":return 2;case"Disabled":return 3;default:return null}}function d(e,t,r){if(Object(o.IsNullOrUndefined)(e))null==t||t.warn("RequiredLevel is set to Unknown with null or undefined value",r);else{var n;if("string"==typeof(n=Object(o.IsNullOrUndefined)(e.Value)?e:e.Value))switch(n){case"None":return a.AttributeRequiredLevel.None;case"SystemRequired":return a.AttributeRequiredLevel.SystemRequired;case"ApplicationRequired":return a.AttributeRequiredLevel.ApplicationRequired;case"Recommended":return a.AttributeRequiredLevel.Recommended;default:return null==t||t.warn("RequiredLevel is set to Unknown with value "+n,r),a.AttributeRequiredLevel.Unknown}if("number"==typeof n)return n}return a.AttributeRequiredLevel.Unknown}function p(e,t){var r,a,o=e,c=function(e){var t=n.AttributeType.Unknown;return e?("AttributeTypeName"in e&&e.AttributeTypeName.Value?t=e.AttributeTypeName.Value.replace(/Type/g,""):"AttributeType"in e&&e.AttributeType&&"string"==typeof e.AttributeType&&(t=e.AttributeType),t?"Float"===t?n.AttributeType.Double:t.toLowerCase():t):t}(e),p=null;if(o.DateTimeBehavior)for(var h in o.DateTimeBehavior)switch(o.DateTimeBehavior[h]){case"None":p=s.DateTimeFieldBehavior.None;break;case"DateOnly":p=s.DateTimeFieldBehavior.DateOnly;break;case"TimeZoneIndependent":p=s.DateTimeFieldBehavior.TimeZoneIndependent;break;case"UserLocal":p=s.DateTimeFieldBehavior.UserLocal;break;default:p=s.DateTimeFieldBehavior.None}var v=[{name:"EntityName",value:e.EntityLogicalName},{name:"AttributeName",value:e.LogicalName}];return{Initialized:u.InitState.Initialized,LogicalName:e.LogicalName,Id:null!==(r=i.Guid.tryParseOrNull(e.MetadataId))&&void 0!==r?r:i.Guid.EMPTY,EntityLogicalName:o.EntityLogicalName,Type:c,DisplayName:m(o.DisplayName),Description:m(o.Description),IsGlobalFilterEnabled:!!o.IsGlobalFilterEnabled&&o.IsGlobalFilterEnabled.Value,IsSecured:o.IsSecured,IsSortableEnabled:!!o.IsSortableEnabled&&o.IsSortableEnabled.Value,IsEntityReferenceStored:o.IsEntityReferenceStored,IsValidForAdvancedFind:!!o.IsValidForAdvancedFind&&o.IsValidForAdvancedFind.Value,IsValidForCreate:o.IsValidForCreate,IsValidForRead:o.IsValidForRead,IsValidForUpdate:o.IsValidForUpdate,IsRetrievable:o.IsRetrievable,IsCustomAttribute:o.IsCustomAttribute,ColumnNumber:o.ColumnNumber,MaxLength:o.MaxLength,MinValue:o.MinValue,MaxValue:o.MaxValue,Precision:o.Precision,PrecisionSource:o.PrecisionSource,Format:y(o,c),AutoNumberFormat:o.AutoNumberFormat,Behavior:p,DefaultFormValue:o.DefaultFormValue,DefaultValue:"boolean"==typeof o.DefaultValue?o.DefaultValue:o.DefaultFormValue,IsBaseCurrency:o.IsBaseCurrency,Targets:o.Targets,AttributeOf:o.AttributeOf,HasChanged:o.HasChanged,ImeMode:l(o.ImeMode),OptionSetId:o.OptionSet&&o.OptionSet.MetadataId?o.OptionSet.MetadataId:void 0,OptionSetName:o.OptionSet&&o.OptionSet.Name?o.OptionSet.Name:void 0,OptionSetType:o.OptionSet?o.OptionSet.OptionSetType:void 0,OptionSet:f(o.OptionSet)||void 0,IsGlobalOptionSet:null===(a=o.OptionSet)||void 0===a?void 0:a.IsGlobal,ParentPicklistLogicalName:o.OptionSet&&o.ParentPicklistLogicalName?o.ParentPicklistLogicalName:void 0,ChildPicklistLogicalNames:o.OptionSet&&o.ChildPicklistLogicalNames?o.ChildPicklistLogicalNames:void 0,RequiredLevel:d(o.RequiredLevel,t,v),SourceType:o.SourceType,SourceTypeMask:o.SourceTypeMask,InheritsFrom:o.InheritsFrom,CanBeSecuredForCreate:o.CanBeSecuredForCreate,CanBeSecuredForRead:o.CanBeSecuredForRead,CanBeSecuredForUpdate:o.CanBeSecuredForUpdate}}function f(e){var t=void 0;if(e&&(t=[],e.FalseOption&&t.push(h(e.FalseOption)),e.TrueOption&&t.push(h(e.TrueOption)),e.Options)){var r=e.Options;for(var n of r)t.push(h(n))}return t}function h(e){var t=[],r=e.TransitionData;if(r){var n=(new DOMParser).parseFromString(r,"text/xml");if("parsererror"!==n.documentElement.nodeName)for(var a=0;a<n.documentElement.childNodes.length;a++){var i=n.documentElement.childNodes[a];if("allowedtransition"===i.nodeName)for(var o in i.attributes){"tostatusid"===i.attributes[o].name&&t.push(Number(i.attributes[o].value))}}}return{Color:e.Color,Label:m(e.Label),Value:e.Value,DefaultStatus:e.DefaultStatus,State:e.State,TransitionData:r?t:void 0,InvariantName:e.InvariantName,ParentValues:e.ParentValues}}function m(e){return e&&e.UserLocalizedLabel?e.UserLocalizedLabel.Label:null}function y(e,t){var r=e;return v(t,r.FormatName?r.FormatName.Value:null,r.Format)}function v(e,t,r){if(t)return t;var i="";if(null==r)i=r;else if(e&&e===n.AttributeType.DateTime)switch(r){case a.DateTimeFormat.DateOnly:i=n.AttributeType.Date;break;case a.DateTimeFormat.DateAndTime:i=n.AttributeType.DateTime;break;default:i=r.toString()}else i=r.toString();return i}},9310:function(e,t,r){"use strict";r.r(t),r.d(t,"serializeEntityDescriptors",(function(){return f})),r.d(t,"mergeEntityDescriptors",(function(){return N}));var n=r(9180),a=r(9046),i=r(9309),o=r(9083),s=r(9311);function u(e,t,r,u){var f=arguments.length>4&&void 0!==arguments[4]?arguments[4]:n.InitState.Initialized,h=s.NAVIGATION_ICONS.defaulticon;e.LogicalName&&s.NAVIGATION_ICONS[e.LogicalName]&&(h=s.NAVIGATION_ICONS[e.LogicalName]);var m={Initialized:f,Id:a.Guid.tryParseOrNull(e.MetadataId),EntityLogicalName:e.LogicalName,EntityIcon:h,DisplayName:Object(i.getLabelString)(e.DisplayName),EntitySetName:e.EntitySetName,PrimaryKeyName:e.PrimaryIdAttribute,ObjectTypeCode:e.ObjectTypeCode,PrimaryIdAttribute:e.PrimaryIdAttribute,PrimaryNameAttribute:e.PrimaryNameAttribute,PrimaryImageAttribute:e.PrimaryImageAttribute,EntityColor:e.EntityColor,ActivityTypeMask:e.ActivityTypeMask,AutoRouteToOwnerQueue:e.AutoRouteToOwnerQueue,DisplayCollectionName:Object(i.getLabelString)(e.DisplayCollectionName),CanTriggerWorkflow:e.CanTriggerWorkflow,Description:Object(i.getLabelString)(e.Description),IsDocumentManagementEnabled:e.IsDocumentManagementEnabled,IsOneNoteIntegrationEnabled:e.IsOneNoteIntegrationEnabled,IsMSTeamsIntegrationEnabled:e.IsMSTeamsIntegrationEnabled,IsDocumentRecommendationsEnabled:e.IsDocumentRecommendationsEnabled,IsInteractionCentricEnabled:e.IsInteractionCentricEnabled,IsKnowledgeManagementEnabled:e.IsKnowledgeManagementEnabled,IsActivity:e.IsActivity,IsActivityParty:e.IsActivityParty,IsChildEntity:e.IsChildEntity,IsCollaboration:l(e.IsValidForQueue),IsConnectionsEnabled:l(e.IsConnectionsEnabled),IsCustomEntity:e.IsCustomEntity,IsBusinessProcessEnabled:e.IsBusinessProcessEnabled,IsCustomizable:l(e.IsCustomizable),IsOptimisticConcurrencyEnabled:e.IsOptimisticConcurrencyEnabled,IsImportable:e.IsImportable,IsIntersect:e.IsIntersect,IsMailMergeEnabled:l(e.IsMailMergeEnabled),IsEnabledForCharts:e.IsEnabledForCharts,IsValidForAdvancedFind:e.IsValidForAdvancedFind,IsVisibleInMobileClient:l(e.IsVisibleInMobileClient),IsReadOnlyInMobileClient:l(e.IsReadOnlyInMobileClient),IsOfflineInMobileClient:l(e.IsOfflineInMobileClient),IsQuickCreateEnabled:e.IsQuickCreateEnabled,EntityClientSetting:e.EntityClientSetting,OwnershipType:u?d(e.OwnershipType):e.OwnershipType,HasChanged:e.HasChanged,HasStateCode:C(e),IsStateModelAware:e.IsStateModelAware,EnforceStateTransitions:e.EnforceStateTransitions,Privileges:u?p(e.Privileges):e.Privileges||[],IconVectorName:e.IconVectorName,IsBPFEntity:e.IsBPFEntity,DataProviderId:a.Guid.tryParseOrNull(e.DataProviderId),IsEnabledInUnifiedInterface:!!Object(o.IsNullOrUndefined)(e.IsVisibleInMobileClient)||(e.IsVisibleInMobileClient.Value||e.IsVisibleInMobileClient.CanBeChanged),VersionNumber:t||e.VersionNumber,OverallVersionNumber:r||e.OverallVersionNumber,AttributeNames:e.AttributeNames,IsAuditEnabled:e.IsAuditEnabled};return e.OneToManyRelationships&&(m.OneToManyRelationships=S(e.OneToManyRelationships,u,b),m.HasActivities=c(e.OneToManyRelationships,"activitypointer","regardingobjectid"),m.HasNotes=c(e.OneToManyRelationships,"annotation","objectid")),e.ManyToOneRelationships&&(m.ManyToOneRelationships=S(e.ManyToOneRelationships,u,b)),e.ManyToManyRelationships&&(m.ManyToManyRelationships=S(e.ManyToManyRelationships,u,T)),m}function c(e,t,r){for(var n of e)if(n.ReferencingEntity===t&&n.ReferencingAttribute===r)return!0;return!1}function l(e){return e?e.Value:null}function d(e){if("string"!=typeof e)return"number"==typeof e?e:void 0;switch(e){case"None":return 0;case"UserOwned":return 1;case"TeamOwned":return 2;case"BusinessOwned":return 3;case"OrganizationOwned":return 4;case"BusinessParented":return 5;default:return 0}}function p(e){if(null===e)return[];for(var t of e)if(null!==t&&"string"==typeof t.PrivilegeType)switch(t.PrivilegeType){case"None":t.PrivilegeType=0;continue;case"Create":t.PrivilegeType=1;continue;case"Read":t.PrivilegeType=2;continue;case"Write":t.PrivilegeType=3;continue;case"Delete":t.PrivilegeType=4;continue;case"Assign":t.PrivilegeType=5;continue;case"Share":t.PrivilegeType=6;continue;case"Append":t.PrivilegeType=7;continue;case"AppendTo":t.PrivilegeType=8;continue;default:t.PrivilegeType=0;continue}return e}function f(e,t,r,a){var o,s,c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:n.InitState.Initialized,l=arguments.length>5?arguments[5]:void 0,d=!1;if(e)for(var p of(o={},s={},e)){var f=u(p,t,r,d,c),h=Object(i.serializeAttributeDescriptorsFromEntity)(p,l);f.EntityLogicalName&&(o[f.EntityLogicalName]=f,s[f.EntityLogicalName]=h)}var m={entities:o,attributes:s};return m}function h(e,t){return Object(o.IsNullOrUndefined)(e)?null:{Behavior:t?m(e.Behavior):e.Behavior,Group:t?y(e.Group):e.Group,Label:Object(i.getLabelString)(e.Label),Order:e.Order,AvailableOffline:e.AvailableOffline,Icon:e.Icon,IsCustomizable:e.IsCustomizable,MenuId:e.MenuId,QueryApi:e.QueryApi,ViewId:a.Guid.tryParseOrNull(e.ViewId),ExtensionData:e.ExtensionData}}function m(e){if("string"!=typeof e)return"number"==typeof e?e:0;switch(e){case"UseCollectionName":return 0;case"UseLabel":return 1;case"DoNotDisplay":return 2;default:return 0}}function y(e){if("string"!=typeof e)return"number"==typeof e?e:0;switch(e){case"Details":return 0;case"Sales":return 1;case"Service":return 2;case"Marketing":return 3;default:return 0}}function v(e){if("string"!=typeof e)return"number"==typeof e?e:0;switch(e){case"NoCascade":return 0;case"Cascade":return 1;case"Active":return 2;case"UserOwned":return 3;case"RemoveLink":return 4;case"Restrict":return 5;default:return 0}}function g(e,t){return{IsCustomRelationship:e.IsCustomRelationship,IsCustomizable:l(e.IsCustomizable),IsValidForAdvancedFind:e.IsValidForAdvancedFind,SchemaName:e.SchemaName,SecurityTypes:t?O(e.SecurityTypes):e.SecurityTypes,IsManaged:e.IsManaged,RelationshipType:t?E(e.RelationshipType):e.RelationshipType,IntroducedVersion:e.IntroducedVersion}}function O(e){if("string"!=typeof e)return"number"==typeof e?e:0;switch(e){case"None":return 0;case"Append":return 1;case"ParentChild":return 2;case"Pointer":return 4;case"Inheritance":return 8;default:return 0}}function E(e){if("string"!=typeof e)return"number"==typeof e?e:-1;switch(e){case"OneToManyRelationship":return 0;case"ManyToManyRelationship":return 1;default:return-1}}function b(e,t){var r=h(e.AssociatedMenuConfiguration,t),n=function(e,t){return t?{Assign:v(e.Assign),Delete:v(e.Delete),Merge:v(e.Merge),Reparent:v(e.Reparent),Share:v(e.Share),Unshare:v(e.Unshare),ExtensionData:v(e.ExtensionData)}:{Assign:e.Assign,Delete:e.Delete,Merge:e.Merge,Reparent:e.Reparent,Share:e.Share,Unshare:e.Unshare,ExtensionData:e.ExtensionData}}(e.CascadeConfiguration,t);return Object.assign({AssociatedMenuConfiguration:r,CascadeConfiguration:n,ReferencedAttribute:e.ReferencedAttribute,ReferencedEntity:e.ReferencedEntity,ReferencingAttribute:e.ReferencingAttribute,ReferencingEntity:e.ReferencingEntity,IsHierarchical:e.IsHierarchical,ReferencedEntityNavigationPropertyName:e.ReferencedEntityNavigationPropertyName,ReferencingEntityNavigationPropertyName:e.ReferencingEntityNavigationPropertyName},g(e,t))}function T(e,t){return Object.assign({Entity1AssociatedMenuConfiguration:h(e.Entity1AssociatedMenuConfiguration,t),Entity2AssociatedMenuConfiguration:h(e.Entity2AssociatedMenuConfiguration,t),Entity1LogicalName:e.Entity1LogicalName,Entity2LogicalName:e.Entity2LogicalName,IntersectEntityName:e.IntersectEntityName,Entity1IntersectAttribute:e.Entity1IntersectAttribute,Entity2IntersectAttribute:e.Entity2IntersectAttribute,Entity1NavigationPropertyName:e.Entity1NavigationPropertyName,Entity2NavigationPropertyName:e.Entity2NavigationPropertyName},g(e,t))}function S(e,t,r){if(!e)return null;var n={};for(var a of e){var i=r(a,t);n[a.SchemaName]=i}return n}function C(e){if(!e||!e.AttributeNames)return!1;for(var t of e.AttributeNames)if("statecode"===t.toLowerCase())return!0;return!1}function N(e,t){return{Initialized:_(e.Initialized,t.Initialized),EntityLogicalName:_(e.EntityLogicalName,t.EntityLogicalName),DisplayName:_(e.DisplayName,t.DisplayName),EntitySetName:_(e.EntitySetName,t.EntitySetName),PrimaryKeyName:_(e.PrimaryKeyName,t.PrimaryKeyName),ObjectTypeCode:_(e.ObjectTypeCode,t.ObjectTypeCode),Id:_(e.Id,t.Id),DisplayCollectionName:_(e.DisplayCollectionName,t.DisplayCollectionName),PluralName:_(e.PluralName,t.PluralName),PrimaryIdAttribute:_(e.PrimaryIdAttribute,t.PrimaryIdAttribute),PrimaryNameAttribute:_(e.PrimaryNameAttribute,t.PrimaryNameAttribute),PrimaryImageAttribute:_(e.PrimaryImageAttribute,t.PrimaryImageAttribute),EntityColor:_(e.EntityColor,t.EntityColor),ActivityTypeMask:_(e.ActivityTypeMask,t.ActivityTypeMask),HasChanged:_(e.HasChanged,t.HasChanged),HasNotes:_(e.HasNotes,t.HasNotes),HasActivities:_(e.HasActivities,t.HasActivities),HasStateCode:e.HasStateCode,CanTriggerWorkflow:_(e.CanTriggerWorkflow,t.CanTriggerWorkflow),AutoRouteToOwnerQueue:_(e.AutoRouteToOwnerQueue,t.AutoRouteToOwnerQueue),Description:_(e.Description,t.Description),IsDocumentManagementEnabled:_(e.IsDocumentManagementEnabled,t.IsDocumentManagementEnabled),IsOneNoteIntegrationEnabled:_(e.IsOneNoteIntegrationEnabled,t.IsOneNoteIntegrationEnabled),IsMSTeamsIntegrationEnabled:_(e.IsMSTeamsIntegrationEnabled,t.IsMSTeamsIntegrationEnabled),IsInteractionCentricEnabled:_(e.IsInteractionCentricEnabled,t.IsInteractionCentricEnabled),IsKnowledgeManagementEnabled:_(e.IsKnowledgeManagementEnabled,t.IsKnowledgeManagementEnabled),IsDocumentRecommendationsEnabled:_(e.IsDocumentRecommendationsEnabled,t.IsDocumentRecommendationsEnabled),IsActivity:_(e.IsActivity,t.IsActivity),IsEnabledForCharts:_(e.IsEnabledForCharts,t.IsEnabledForCharts),IsActivityParty:_(e.IsActivityParty,t.IsActivityParty),IsChildEntity:_(e.IsChildEntity,t.IsChildEntity),IsCollaboration:_(e.IsCollaboration,t.IsCollaboration),IsConnectionsEnabled:_(e.IsConnectionsEnabled,t.IsConnectionsEnabled),IsCustomEntity:_(e.IsCustomEntity,t.IsCustomEntity),IsCustomizable:_(e.IsCustomizable,t.IsCustomizable),IsIntersect:_(e.IsIntersect,t.IsIntersect),ParentEntityLogicalName:_(e.ParentEntityLogicalName,t.ParentEntityLogicalName),ParentEntityReferencingAttribute:_(e.ParentEntityReferencingAttribute,t.ParentEntityReferencingAttribute),IsBusinessProcessEnabled:_(e.IsBusinessProcessEnabled,t.IsBusinessProcessEnabled),IsBPFEntity:_(e.IsBPFEntity,t.IsBPFEntity),IsDuplicateDetectionEnabled:_(e.IsDuplicateDetectionEnabled,t.IsDuplicateDetectionEnabled),CanEnableSyncToExternalSearchIndex:_(e.CanEnableSyncToExternalSearchIndex,t.CanEnableSyncToExternalSearchIndex),IsOptimisticConcurrencyEnabled:_(e.IsOptimisticConcurrencyEnabled,t.IsOptimisticConcurrencyEnabled),IsImportable:_(e.IsImportable,t.IsImportable),IsMailMergeEnabled:_(e.IsMailMergeEnabled,t.IsMailMergeEnabled),IsManaged:_(e.IsManaged,t.IsManaged),IsStateModelAware:_(e.IsStateModelAware,t.IsStateModelAware),EnforceStateTransitions:_(e.EnforceStateTransitions,t.EnforceStateTransitions),IsValidForAdvancedFind:_(e.IsValidForAdvancedFind,t.IsValidForAdvancedFind),IsVisibleInMobileClient:_(e.IsVisibleInMobileClient,t.IsVisibleInMobileClient),IsReadOnlyInMobileClient:_(e.IsReadOnlyInMobileClient,t.IsReadOnlyInMobileClient),IsOfflineInMobileClient:_(e.IsOfflineInMobileClient,t.IsOfflineInMobileClient),IsQuickCreateEnabled:_(e.IsQuickCreateEnabled,t.IsQuickCreateEnabled),EntityClientSetting:_(e.EntityClientSetting,t.EntityClientSetting),OwnershipType:_(e.OwnershipType,t.OwnershipType),Privileges:_(e.Privileges,t.Privileges),DataProviderId:_(e.DataProviderId,t.DataProviderId),OneToManyRelationships:Object.assign({},e.OneToManyRelationships,t.OneToManyRelationships),ManyToOneRelationships:Object.assign({},e.ManyToOneRelationships,t.ManyToOneRelationships),ManyToManyRelationships:Object.assign({},e.ManyToManyRelationships,t.ManyToManyRelationships)}}function _(e,t){if(null==e)return t;if(null==t)return e;if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)throw new Error("Descriptor field arrays with the same key have conflicting values");return e}if(e instanceof Object&&t instanceof Object){if(Object.keys(e).length!==Object.keys(t).length)throw new Error("Descriptor field objects with the same key have conflicting values");return e}if(e!==t)throw new Error("Descriptor fields with the same key have conflicting values");return e}},9311:function(e,t,r){"use strict";r.r(t),r.d(t,"NAVIGATION_ICONS",(function(){return n})),r.d(t,"getNavigationIconForEntity",(function(){return a}));var n={activitypointer:"",account:"",audit:"",contact:"",connection:"",customeraddress:"",lead:"",opportunity:"",position:"",competitor:"",quote:"",salesorder:"",invoice:"",product:"",salesliterature:"",list:"",bulkoperation:"",goal:"",metric:"",goalrollupquery:"",report:"",task:"",appointment:"",email:"",phonecall:"",incident:"",queueitem:"",knowledgearticle:"",opportunityproduct:"",systemform:"",team:"",transactioncurrency:"",userform:"",defaulticon:"",defaultrecenticon:"",sharepointdocument:"",service:"",serviceappointment:"",equipment:"",routingrule:"",routingruleitem:"",msdyn_knowledgearticletemplate:"",msdyn_servicelevelagreement:"",msdyn_servicelevelagreementkpi:"",msdyn_servicelevelagreementinstance:"",site:""};function a(e,t){var r=n[e]||"";return t&&-1!==t.indexOf("/workplace/home_dashboards.aspx")&&(r=""),r}},9312:function(e,t,r){"use strict";r.r(t);var n=r(9313);r.d(t,"MetadataProvider",(function(){return n}));var a=r(9048);r.d(t,"AttributeType",(function(){return a.AttributeType}));var i=r(9046);r.d(t,"Guid",(function(){return i.Guid}));var o=r(9080);r.d(t,"EntityReference",(function(){return o.EntityReference}));var s=r(9180);r.d(t,"InitState",(function(){return s.InitState}));var u=r(9314);r.d(t,"AttributeTerm",(function(){return u.AttributeTerm}));var c=r(9232);r.d(t,"Expression",(function(){return c.Expression}));var l=r(9292);r.d(t,"ModernQueryBuilder",(function(){return l.ModernQueryBuilder}));var d=r(9315);r.d(t,"ValueTerm",(function(){return d.ValueTerm}));var p=r(9211);r.d(t,"isPicklistValue",(function(){return p.isPicklistValue})),r.d(t,"isGuidValue",(function(){return p.isGuidValue})),r.d(t,"isReferenceValue",(function(){return p.isReferenceValue})),r.d(t,"isPlainValue",(function(){return p.isPlainValue})),r.d(t,"isAliasedValue",(function(){return p.isAliasedValue})),r.d(t,"isPartylistValue",(function(){return p.isPartylistValue})),r.d(t,"getFormattedValueFromField",(function(){return p.getFormattedValueFromField})),r.d(t,"getPickListValueFromField",(function(){return p.getPickListValueFromField})),r.d(t,"getRawValueFromField",(function(){return p.getRawValueFromField})),r.d(t,"getEntityReferenceIdFromField",(function(){return p.getEntityReferenceIdFromField})),r.d(t,"getEntityReferenceFromField",(function(){return p.getEntityReferenceFromField}));var f=r(9301);r.d(t,"SnapshotMode",(function(){return f.SnapshotMode}))},9313:function(e,t,r){"use strict";r.r(t)},9314:function(e,t,r){"use strict";r.r(t),r.d(t,"AttributeTerm",(function(){return n}));class n{constructor(e,t){this._etn=void 0,this._attributeName=void 0,this._etn=e,this._attributeName=t}get etn(){return this._etn}set etn(e){this._etn=e}get attributeName(){return this._attributeName}set attributeName(e){this._attributeName=e}}},9315:function(e,t,r){"use strict";r.r(t),r.d(t,"ValueTerm",(function(){return n}));class n{constructor(e){this._value=void 0,this._value=e}get value(){return this._value}set value(e){this._value=e}}},9316:function(e,t,r){"use strict";r.r(t),r.d(t,"subscribeToMetadataChange",(function(){return s}));var n=r(9189);function a(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function i(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function s(e){a(o,n,i,s,u,"next",e)}function u(e){a(o,n,i,s,u,"throw",e)}s(void 0)}))}}function o(e,t,r,a){return i((function*(){var i;(null===(i=a.TraceManager)||void 0===i?void 0:i.getTracer("MetadataChangeHandler")).info("metadata change listener was invoked for entity : "+e),r(function(e,t){var r={},a={};return Object(n.replaceEntityWithPlaceholder)(e,t,r,a),Object(n.gcRemoveMetadata)({entities:r,attributes:a})}(t(),e))}))}function s(e,t,r,n,a){return u.apply(this,arguments)}function u(){return(u=i((function*(e,t,r,n,a){-1===t.metadataChangeListenerList.indexOf(e)&&(t.metadataChangeListenerList.push(e),(yield t.metadataProvider).subscribe({logicalName:e},o(e,r,n,a)))}))).apply(this,arguments)}},9317:function(e,t,r){"use strict";r.r(t),r.d(t,"ModelEventManager",(function(){return u}));var n=r(217),a=r(9318),i=r(9319),o=r(9320),s=r(9047);class u{getCurrentSessionId(){return Object(n.getSessionId)()}getActivityId(){return""}ReportComponentPerformance(e,t,r,a,s){var u=Object(o.getEventDataFromEventParams)(a);t&&(u[i.METRIC]=t),s&&(u[i.START_TIME]=s),Object(o.sendEventToShellTelemetry)(i.MDL_COMPONENT_PERFORMANCE+e,u,n.ScenarioModifier.Complete,n.SeverityLevel.Information,r)}ReportComponentSuccess(e,t){var r=Object(o.getEventDataFromEventParams)(t);Object(o.sendEventToShellTelemetry)(i.MDL_COMPONENT_SUCCESS+e,r,n.ScenarioModifier.Complete,n.SeverityLevel.Information)}ReportComponentFailure(e,t,r,s){if(!t||!t.blockErrorReporting){var u=Object(a.ensureErrorObject)(t),c=Object(o.getEventDataFromEventParams)(s);u&&u.message&&(c[i.MESSAGE]=u.message),u&&u.stack&&(c[i.STACK_TRACE]=u.stack),r&&(c[i.SUGGESTED_MITIGATION]=r),this._addUciErrorParameters(c,t),Object(o.sendEventToShellTelemetry)(i.MDL_COMPONENT_FAILURE+e,c,n.ScenarioModifier.Failure,n.SeverityLevel.Error)}}getScenarioTracker(e,t,r){var a;switch(e){case s.ScenarioType.Create:a=Object(n.trackCreateScenario)(i.MDL_SCOPE,t,Object(o.getEventDataFromEventParams)(r));break;case s.ScenarioType.Delete:a=Object(n.trackDeleteScenario)(i.MDL_SCOPE,t,Object(o.getEventDataFromEventParams)(r));break;case s.ScenarioType.Update:a=Object(n.trackUpdateScenario)(i.MDL_SCOPE,t,Object(o.getEventDataFromEventParams)(r));break;case s.ScenarioType.Load:a=Object(n.trackLoadScenario)(i.MDL_SCOPE,t,Object(o.getEventDataFromEventParams)(r))}return{complete:e=>{var r,n=Object(o.getEventDataFromEventParams)(e);null===(r=a)||void 0===r||r.complete(n),t&&this.ReportComponentSuccess(t,e)},progress:e=>{var t,r=Object(o.getEventDataFromEventParams)(e);null===(t=a)||void 0===t||t.progress(r)},failure:e=>{var r,n=Object(o.getEventDataFromEventParams)(e);null===(r=a)||void 0===r||r.failure(n),t&&this.ReportComponentFailure(t,e)},completeWithError:e=>{var r,n=Object(o.getEventDataFromEventParams)(e);null===(r=a)||void 0===r||r.completeWithError(n),t&&this.ReportComponentFailure(t,e)}}}_addUciErrorParameters(e,t){if(e&&t){if(t.errorParameters)for(var r of t.errorParameters)e[r.name]=r.value;var n;if(t.innerError)n="string"==typeof t.innerError||t.innerError instanceof String?t.innerError.valueOf():JSON.stringify(t.innerError),e[i.INNER_ERROR]=n;t.errorCode&&(e[i.ERROR_CODE]=t.errorCode)}}ReportEvent(e,t){}}},9318:function(e,t,r){"use strict";r.r(t),r.d(t,"ensureErrorObject",(function(){return o})),r.d(t,"errorToString",(function(){return s})),r.d(t,"isAppPermissionError",(function(){return u})),r.d(t,"isUnsupportedBrowser",(function(){return c})),r.d(t,"UNSUPPORTED_BROWSER_ERROR_CODE",(function(){return n})),r.d(t,"UNSUPPORTED_BROWSER_MULTISESSION_APP_ERROR_CODE",(function(){return a})),r.d(t,"INVALID_URL_ERROR_CODE",(function(){return i}));var n=2147500038,a=2147500039,i=-2147098623;function o(e,t){if(e instanceof Error)return e;if(!e){return null==t||t.info("No error data provided."),Error("No error data provided.")}var r=function(e,t){var r,n=Error("blank"),a="";e.source&&(e.source.actionType&&(a+="\nactionType: "+e.source.actionType),e.source.contextId&&(a+="\ncontextId: "+e.source.contextId));e.reason&&(e=e.reason);if(e.errorFault&&(e.errorFault.get_Message||e.errorFault.get_message)&&e.errorFault.get_responseText)return n.message=(e.errorFault.get_message?e.errorFault.get_message():e.errorFault.get_Message())+a,n.stack=e.errorFault.get_responseText(),r=[{name:"ErrorMessage",value:n.message}],null==t||t.warn("Unsupported codepath: Error object for telemetry being created from ErrorFault.",r),n;if(e.get_organizationServiceFault){var i=e.get_organizationServiceFault().get_innerFault();if(i&&i.get_message&&i.get_callStack)n.message=i.get_message()+a,n.stack=i.get_callStack();else{if(!e.get_error)return r=[{name:"OrganizationServiceFault",value:JSON.stringify(e.get_organizationServiceFault())}],null==t||t.warn("Unsupported codepath: Error object for telemetry being created from OrganizationServiceFault. Unable to get errordetails.",r),null;n.message=e.get_error()+a,n.stack="No stack available."}return r=[{name:"ErrorMessage",value:n.message}],null==t||t.warn("Unsupported codepath: Error object for telemetry being created from OrganizationServiceFault.",r),n}if(e.get_Message)return n.message=e.get_Message()+a,n.stack="No stack available.",r=[{name:"ErrorMessage",value:n.message}],null==t||t.warn("Unsupported codepath: Error object for telemetry being created from CrmErrorStatus.",r),n;if(e.message)return n.message=e.message+a,n.stack=e.stack||"No stack available.",n;return null}(e,t);if(r)return r;var n=Error("blank");if("string"==typeof e||e instanceof String)n.message=e.valueOf();else if(e.message)n.message=e.message;else{var a="";try{a=JSON.stringify(e)}catch(o){a="Error provided failed to be stringified: "+o.message}n.message=a;var i="Error provided lacks error message: "+a;null==t||t.info(i)}return e.stack?n.stack=e.stack:n.stack="No stack available.",n}function s(e,t){var r=o(e),n="Message: "+(r.message?r.message:t);return r.stack&&(n+="\nStack: "+r.stack),n}function u(e){return 2147811606===e}function c(e){return e===n}},9319:function(e,t,r){"use strict";r.r(t),r.d(t,"MDL_COMPONENT_NAME",(function(){return n})),r.d(t,"MDL_COMPONENT_SUCCESS",(function(){return a})),r.d(t,"MDL_COMPONENT_FAILURE",(function(){return i})),r.d(t,"MDL_COMPONENT_PERFORMANCE",(function(){return o})),r.d(t,"START_TIME",(function(){return s})),r.d(t,"MESSAGE",(function(){return u})),r.d(t,"METRIC",(function(){return c})),r.d(t,"STACK_TRACE",(function(){return l})),r.d(t,"SUGGESTED_MITIGATION",(function(){return d})),r.d(t,"INNER_ERROR",(function(){return p})),r.d(t,"ERROR_CODE",(function(){return f})),r.d(t,"MDL_SCOPE",(function(){return h})),r.d(t,"MDLDATAPROVIDER_COMPONENT_RETRIEVE_USER_CONTEXT",(function(){return m})),r.d(t,"MDLDATAPROVIDER_COMPONENT_RETRIEVE_GRID_DATA",(function(){return y})),r.d(t,"MDLDATAPROVIDER_COMPONENT_RETRIEVE_RECORD_DATA",(function(){return v})),r.d(t,"MDLDATAPROVIDER_COMPONENT_RETRIEVE_MULTIPLE_RECORDS_DATA",(function(){return g})),r.d(t,"MDLDATAPROVIDER_COMPONENT_RETRIEVE_ENTITY",(function(){return O})),r.d(t,"MDLDATAPROVIDER_COMPONENT_SAVE_DATA_SNAPSHOT",(function(){return E})),r.d(t,"MDLDATAPROVIDER_COMPONENT_SAVE_MULTIPLE_DATA_SNAPSHOTS",(function(){return b})),r.d(t,"MDLDATAPROVIDER_COMPONENT_DELETE_RECORDS",(function(){return T})),r.d(t,"RETRIEVE_USER_CONTEXT",(function(){return S})),r.d(t,"RETRIEVE_GRID_DATA",(function(){return C})),r.d(t,"RETRIEVE_RECORD_DATA",(function(){return N})),r.d(t,"RETRIEVE_MULTIPLE_RECORD_DATA",(function(){return _})),r.d(t,"RETRIEVE_ENTITY",(function(){return R})),r.d(t,"SAVE_DATA_SNAPSHOT",(function(){return P})),r.d(t,"SAVE_MULTIPLE_DATA_SNAPSHOTS",(function(){return I})),r.d(t,"DELETE_RECORDS",(function(){return A})),r.d(t,"DELETE_RECORDS_COUNT",(function(){return D})),r.d(t,"OPERATION_NAME",(function(){return M})),r.d(t,"SUPPRESS_DUPLICATE_DETECTION",(function(){return F})),r.d(t,"CONTEXT_ID",(function(){return w})),r.d(t,"ENTITY_LOGICAL_NAME",(function(){return L})),r.d(t,"REFRESH_CONTEXT",(function(){return j})),r.d(t,"IS_CACHED_RESPONSE",(function(){return x})),r.d(t,"MULTIPLE_SNAPSHOT_RECORD_COUNT",(function(){return U})),r.d(t,"RETRIEVE_RECORDS_COUNT",(function(){return k}));var n="ModernDataLayer",a="ComponentSuccess/",i="ComponentFailure/",o="ModernDataLayer.ComponentPerformance/",s="StartTime",u="Message",c="metric",l="StackTrace",d="SuggestedMitigation",p="InnerError",f="ErrorCode",h="ModernDataLayer",m="MDLDataProvider.RetrieveUserContext",y="MDLDataProvider.RetrieveGridData",v="MDLDataProvider.RetrieveRecordData",g="MDLDataProvider.RetrieveMultipleRecordsData",O="MDLDataProvider.RetrieveEntity",E="MDLDataProvider.SaveDataSnapshot",b="MDLDataProvider.SaveMultipleDataSnapshots",T="MDLDataProvider.DeleteRecords",S="RetrieveUserContext",C="RetrieveGridData",N="RetrieveRecordData",_="RetrieveMultipleRecordsData",R="RetrieveEntity",P="SaveDataSnapshot",I="SaveMultipleDataSnapshots",A="DeleteRecords",D="DeleteRecordsCount",M="OperationName",F="SuppressDuplicateDetection",w="ContextId",L="EntityLogicalName",j="RefreshContext",x="IsCachedResponse",U="MultipleDataSnapshotsRecordCount",k="RetrieveRecordsCount"},9320:function(e,t,r){"use strict";r.r(t),r.d(t,"getEventDataFromEventParams",(function(){return u})),r.d(t,"sendEventToShellTelemetry",(function(){return c})),r.d(t,"isSLAImpactingError",(function(){return l}));var n,a=r(217),i=r(9083),o=r(9184),s=r(9319);function u(e){var t={};return Object(i.IsNullOrUndefined)(e)||null==e||e.forEach(e=>{t[null==e?void 0:e.name]=null==e?void 0:e.value}),t}function c(e,t,r,n,i){var o={eventName:e,eventData:t,eventDuration:i,eventModifier:r,eventSeverity:n};Object(a.trackCustomEvent)(s.MDL_SCOPE,o)}function l(e,t){var r=Object(o.getPositiveErrorCodeFromErrorCode)(e),a=[n.PrivilegeDenied,n.IntegerValueOutOfRange,n.InvalidDateTime,n.InvalidCharactersInField,n.StringLengthTooLong,n.DecimalValueOutOfRange,n.ObjectDoesNotExist,n.SdkEntityDoesNotSupportMessage,n.InvalidArgument,n.CrmSecurityError,n.UserNotAssignedRoles,n.CannotDeleteDefaultTeam,n.CannotDeleteDueToAssociation,n.CannotDeleteSystemForm,n.FallbackQuickFormDeactivation,n.CascadeOperationConcurrentRequested,n.CannotUpdateNameDefaultTeam];return!(null!=r&&a.indexOf(r)>-1)&&(!(t&&r===n.ProcessImageFailure&&(null==t?void 0:t.indexOf("We don't allow uploading of non-primary image attribute during Create operation."))>-1)&&(!t||r!==n.CrmHttpError||null==t||!t.startsWith("Resource not found for the segment")))}!function(e){e[e.PrivilegeDenied=2147746336]="PrivilegeDenied",e[e.IntegerValueOutOfRange=2147762991]="IntegerValueOutOfRange",e[e.InvalidDateTime=2147746361]="InvalidDateTime",e[e.InvalidCharactersInField=2147746424]="InvalidCharactersInField",e[e.StringLengthTooLong=2147762993]="StringLengthTooLong",e[e.DecimalValueOutOfRange=2147762992]="DecimalValueOutOfRange",e[e.ObjectDoesNotExist=2147746327]="ObjectDoesNotExist",e[e.SdkEntityDoesNotSupportMessage=2147747840]="SdkEntityDoesNotSupportMessage",e[e.InvalidArgument=2147746307]="InvalidArgument",e[e.CrmSecurityError=2147746390]="CrmSecurityError",e[e.ProcessImageFailure=2147951955]="ProcessImageFailure",e[e.CrmHttpError=2147879050]="CrmHttpError",e[e.CannotUpdateNameDefaultTeam=2147779338]="CannotUpdateNameDefaultTeam",e[e.CannotDeleteDefaultTeam=2147779335]="CannotDeleteDefaultTeam",e[e.CannotDeleteDueToAssociation=2147746343]="CannotDeleteDueToAssociation",e[e.CannotDeleteSystemForm=2147808850]="CannotDeleteSystemForm",e[e.FallbackQuickFormDeactivation=2147808869]="FallbackQuickFormDeactivation",e[e.CascadeOperationConcurrentRequested=2147778821]="CascadeOperationConcurrentRequested",e[e.UserNotAssignedRoles=2147757833]="UserNotAssignedRoles"}(n||(n={}))},9321:function(e,t,r){"use strict";r.r(t),r.d(t,"ModelTraceManager",(function(){return o}));var n=r(9322),a=r(9319),i=r(9323);class o{getTracer(e){return new i.ModelTracer(null!=e?e:a.MDL_COMPONENT_NAME)}getLogLevel(e){return n.TracerLogLevel.Info}setLogLevel(e,t){}addDefaultTransport(e){}setTraceAreas(e){}}},9322:function(e,t,r){"use strict";var n,a;r.r(t),r.d(t,"TracerLogLevel",(function(){return n})),r.d(t,"SendPriority",(function(){return a})),function(e){e[e.Off=0]="Off",e[e.Error=1]="Error",e[e.Warning=2]="Warning",e[e.Info=3]="Info",e[e.Verbose=4]="Verbose"}(n||(n={})),function(e){e[e.High=0]="High",e[e.Low=1]="Low"}(a||(a={}))},9323:function(e,t,r){"use strict";r.r(t),r.d(t,"ModelTracer",(function(){return s}));var n=r(217),a=r(9322),i=r(9319),o=r(9320);class s{constructor(e){this.componentName=void 0,this.componentName=e}getLogLevel(){return a.TracerLogLevel.Warning}error(e,t){var r=this.getTraceEvent(e,t),a=new Error(JSON.stringify(e));Object(n.trackErrorTrace)(i.MDL_SCOPE,r,a)}warn(e,t){var r=this.getTraceEvent(e,t);Object(n.trackWarningTrace)(i.MDL_SCOPE,r)}info(e,t){var r=this.getTraceEvent(e,t);Object(n.trackInfoTrace)(i.MDL_SCOPE,r)}debug(e,t){var r=this.getTraceEvent(e,t);Object(n.trackDebugTrace)(i.MDL_SCOPE,r)}getTraceEvent(e,t){var r=Object(o.getEventDataFromEventParams)(t);return r[i.MESSAGE]=e,{eventName:this.componentName,eventData:r}}}},9324:function(e,t,r){"use strict";r.r(t),r.d(t,"StateProvider",(function(){return a}));var n=r(9325);class a{constructor(){this._store=void 0}getStore(){return this._store}initialize(e){return this._store=Object(n.initializeState)(e),this._store}getActions(){return{}}}},9325:function(e,t,r){"use strict";r.r(t),r.d(t,"initializeState",(function(){return u}));var n=r(9326),a=r(9327),i=r(9328),o=r(9331),s=r(9334);function u(e){var t={metadata:o.metadataReducer,data:i.dataReducer,garbageCollector:n.garbageCollectorReducer},r=Object(a.combineReducers)(t),u=Object(s.createStore)(r,e);u.currentReducerMap=t;var c=Math.random().toString(36).slice(2);return window["__storeMDL$".concat(c)]=u,u}},9326:function(e,t,r){"use strict";r.r(t),r.d(t,"garbageCollectorReducer",(function(){return u}));var n=r(9290),a=r(9289),i=r(9291),o={ribbons:i.gcMetadataRibbonsReducer,entities:i.gcMetadataEntitiesReducer},s={metadata:Object(n.combineReducers)(o),data:a.garbageCollectorDataReducer},u=Object(n.combineReducers)(s)},9327:function(e,t,r){"use strict";function n(e){return function(e){return(t,r)=>{var n=void 0===t?{}:t,a={},i=!1,o=Object.keys(e);for(var s of o){var u=e[s],c=n[s],l=u(c,r);a[s]=l,i=i||l!==c}var d=i?a:n;return Object.freeze(d)}}(a(e))}function a(e){var t={},r=Object.keys(e);for(var n of r)t[n]=e[n];return t}function i(e,t,r){var n=Object.assign({},t);return Object.freeze(n),function(e,t,r){return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t,a=arguments.length>1?arguments[1]:void 0;if(-1===e.indexOf(a.type))return n;var i=r?r(a.payload):a.payload,o=i?Object.assign({},n,i):n;return Object.freeze(o)}}(e,n,r)}function o(e,t){return function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object.freeze({}),n=arguments.length>1?arguments[1]:void 0,a=n.meta&&n.meta[e];if(a){var i=r[a],o=t(i,n);return o===i?r:Object.freeze(Object.assign({},r,{[a]:o}))}return r}}function s(e,t){var r=a(e),n=t;return"object"==typeof t&&(n=Object.assign({},t),Object.freeze(n)),function(e,t){return function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t,n=arguments.length>1?arguments[1]:void 0,a=e[n.type];return a?Object.freeze(a(r,n)):r}}(r,n)}function u(e,t){if(null===e&&null===t||void 0===e&&void 0===t)return!0;if(!e&&t||e&&!t)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(var a=Object.prototype.hasOwnProperty,i=0;i<r.length;i++)if("function"!=typeof e[r[i]]&&(!a.call(t,r[i])||e[r[i]]!==t[r[i]]))return!1;return!0}r.r(t),r.d(t,"combineReducers",(function(){return n})),r.d(t,"createPartialUpdateReducer",(function(){return i})),r.d(t,"createCollectionReducer",(function(){return o})),r.d(t,"handleActions",(function(){return s})),r.d(t,"shallowEquals",(function(){return u}))},9328:function(e,t,r){"use strict";r.r(t),r.d(t,"dataReducerMap",(function(){return o})),r.d(t,"dataReducer",(function(){return s}));var n=r(9329),a=r(9330),i=r(9327),o={entities:n.entityDataReducer,lists:a.listsReducer},s=Object(i.combineReducers)(o)},9329:function(e,t,r){"use strict";r.r(t),r.d(t,"entityDataReducer",(function(){return d}));var n=r(9180),a=r(9181),i=[a.REFRESH_RECORD_DATA_ACTION,a.RETRIEVE_RECORD_DATA_ACTION,a.RETRIEVE_GRID_DATA_ACTION,a.GC_REMOVE_DATA_ACTION,a.REMOVE_ENTITY_RECORD_ACTION],o={};function s(e,t){var r=Object.assign({},e.fields,t.fields),n=null;for(var a in e.accessRights?n=t.accessRights?{recordPrivileges:t.accessRights.recordPrivileges,attributePrivileges:Object.assign({},e.accessRights.attributePrivileges,t.accessRights.attributePrivileges)}:e.accessRights:t.accessRights&&(n=t.accessRights),r){var i;(null===r[a]||t.queryColumnNames&&-1!==t.queryColumnNames.indexOf(a)&&(null===(i=t.fields)||void 0===i||!i.hasOwnProperty(a))&&r.hasOwnProperty(a))&&delete r[a]}var o={initialized:t.initialized,fields:r};return e.businessProcessFlowId&&(o.businessProcessFlowId=e.businessProcessFlowId),e.businessProcessFlowInstanceId&&(o.businessProcessFlowInstanceId=e.businessProcessFlowInstanceId),e.processInstanceModifiedTimestamp&&(o.processInstanceModifiedTimestamp=e.processInstanceModifiedTimestamp),n&&(o.accessRights=n),t.identifier&&(o.identifier=t.identifier),o}function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o,t=arguments.length>1?arguments[1]:void 0,r={};for(var n in e){var a,i,s=e[n],u=null==t||null===(a=t.payload)||void 0===a||null===(i=a.entities)||void 0===i?void 0:i[n];if(u)for(var c in s)void 0===u[c]&&(r[n]||(r[n]={}),r[n][c]=s[c]);else r[n]=s}return Object.freeze(r)}function c(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o,t=arguments.length>1?arguments[1]:void 0,r=e;return t&&t.payload&&t.payload.entities&&Object.keys(t.payload.entities).forEach(e=>{var n,a,i=null==t||null===(n=t.payload)||void 0===n||null===(a=n.entities)||void 0===a?void 0:a[e];i&&Object.keys(i).forEach(t=>{r&&r[e]&&r[e][t]&&delete r[e][t]})}),Object.freeze(r)}function l(e,t,r,a){var i,o,u=null==a||null===(i=a.payload)||void 0===i||null===(o=i.entities)||void 0===o?void 0:o[t];if(u)if(r.hasOwnProperty(t))for(var c of(r[t]=Object.assign({},e[t]),Object.keys(u)))if(r[t].hasOwnProperty(c)){var l=r[t][c];u[c].initialized!==n.InitState.Initialized?(r[t][c]=Object.assign({},e[t][c]),r[t][c].initialized=u[c].initialized):(a.type,r[t][c]=s(l,u[c]))}else r[t][c]=u[c];else r[t]=u}function d(){var e,t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o,n=arguments.length>1?arguments[1]:void 0;if(-1===i.indexOf(n.type)||!n.payload||null==n||null===(e=n.payload)||void 0===e||!e.entities||0===Object.keys(null==n||null===(t=n.payload)||void 0===t?void 0:t.entities).length)return r;if(n.type===a.GC_REMOVE_DATA_ACTION)return u(r,n);if(n.type===a.REMOVE_ENTITY_RECORD_ACTION)return c(r,n);var s=Object.assign({},r);for(var d of Object.keys(null==n||null===(p=n.payload)||void 0===p?void 0:p.entities)){var p;l(r,d,s,n)}return Object.freeze(s)}},9330:function(e,t,r){"use strict";r.r(t),r.d(t,"listsReducer",(function(){return u}));var n=r(9180),a=r(9181),i=[a.RETRIEVE_GRID_DATA_ACTION,a.GC_REMOVE_DATA_ACTION],o={};function s(e,t){if(t&&t.payload&&t.payload.lists&&Object.keys(t.payload.lists)&&0===Object.keys(t.payload.lists).length)return e;var r={};for(var n in e){var a;void 0===(null===(a=t.payload.lists)||void 0===a?void 0:a[n])&&(r[n]=e[n])}return Object.freeze(r)}function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o,t=arguments.length>1?arguments[1]:void 0;if(-1===i.indexOf(t.type)||!t||!t.payload||!t.payload.lists)return e;if(t.type===a.GC_REMOVE_DATA_ACTION)return s(e,t);var r=null,u=Object.keys(t.payload.lists);if(!u||!u.length)return e;for(var c=0;c<u.length;c++){var l=u[c];if(e.hasOwnProperty(l)){r=Object.assign({},e);var d=t.payload.lists[l];if(d.initialized===n.InitState.Initialized&&d.pages){var p,f,h=0,m=Number(Object.keys(d.pages)[0]),y=e[l];if(y&&y.pages&&y.pages[m])if(h=y.pages[m].startIndex,0!==d.totalRecordCount)null===(p=r[l])||void 0===p||null===(f=p.records)||void 0===f||f.splice(h,y.pageSize,...d.records);else r[l].records=[];else y&&y.records?(h=y.records.length,d&&d.records&&(r[l].records=y.records.concat(d.records))):r[l].records=d.records;var v=d.pages[m];r[l].pages=Object.assign({},r[l].pages,{[m]:{startIndex:h,startGuid:v.startGuid,pagingCookie:v.pagingCookie,moreRecords:v.moreRecords}})}r[l].initialized=d.initialized,r[l].lastRetrieved=d.lastRetrieved,r[l].totalRecordCount=d.totalRecordCount,r[l].totalRecordCountLimitExceeded=d.totalRecordCountLimitExceeded}else r=Object.assign({},e,t.payload.lists)}return Object.freeze(r)}},9331:function(e,t,r){"use strict";r.r(t),r.d(t,"metadataReducer",(function(){return u}));var n=r(9332),a=r(9333),i=r(9327),o={attributes:a.attributeReducer,entities:n.entityMetadataReducer,entitiesByTypeCode:n.entityLogicalNamesByTypeCodeReducer},s=Object(i.combineReducers)(o);function u(e,t){if(t&&"purge.app.related.metadata"===t.type){var r=Object.freeze(Object.assign({},e,t.payload));return s(r,t)}return s(e,t)}},9332:function(e,t,r){"use strict";r.r(t),r.d(t,"entityMetadataReducer",(function(){return u})),r.d(t,"entityLogicalNamesByTypeCodeReducer",(function(){return c}));var n=r(9180),a=r(9181),i=r(9189),o=[a.GET_CLIENT_METADATA,i.GC_REMOVE_METADATA,a.RETRIEVE_LOOKUP_DATA_ACTION],s={1030:"systemform",1031:"userform"};function u(){var e,t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1?arguments[1]:void 0;if(!(n&&n.payload&&null!=n&&null!==(e=n.payload)&&void 0!==e&&e.entities&&0!==Object.keys(null==n||null===(t=n.payload)||void 0===t?void 0:t.entities).length&&n.type&&-1!==o.indexOf(n.type)))return r;var a=Object.assign({},r),s=!1;if(n.type===i.GC_REMOVE_METADATA)for(var u in s=!0,null==n||null===(c=n.payload)||void 0===c?void 0:c.entities){var c,d,p;a[u]=null==n||null===(d=n.payload)||void 0===d||null===(p=d.entities)||void 0===p?void 0:p[u]}else for(var f in null==n||null===(h=n.payload)||void 0===h?void 0:h.entities){var h,m,y,v,g,O,E,b,T;if(!a.hasOwnProperty(f)||null!=n&&null!==(m=n.payload)&&void 0!==m&&null!==(y=m.entities)&&void 0!==y&&y[f].VersionNumber&&a[f].VersionNumber!==(null==n||null===(v=n.payload)||void 0===v||null===(g=v.entities)||void 0===g?void 0:g[f].VersionNumber)||l(a[f],null==n||null===(O=n.payload)||void 0===O||null===(E=O.entities)||void 0===E?void 0:E[f]))s=!0,a[f]=Object.assign({},a[f],null==n||null===(b=n.payload)||void 0===b||null===(T=b.entities)||void 0===T?void 0:T[f])}return s?Object.freeze(a):r}function c(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s,r=arguments.length>1?arguments[1]:void 0;if(!(r&&r.payload&&null!=r&&null!==(e=r.payload)&&void 0!==e&&e.entities&&r.type&&-1!==o.indexOf(r.type)))return t;var n=Object.assign({},t);for(var a in null==r||null===(i=r.payload)||void 0===i?void 0:i.entities){var i,u,c,l=null==r||null===(u=r.payload)||void 0===u||null===(c=u.entities)||void 0===c?void 0:c[a].ObjectTypeCode;null!=l&&(n[l]=a)}return Object.freeze(n)}function l(e,t){return(e.Initialized===n.InitState.Uninitialized||e.Initialized===n.InitState.Partial)&&t.Initialized===n.InitState.Initialized}},9333:function(e,t,r){"use strict";r.r(t),r.d(t,"attributeReducer",(function(){return o}));var n=r(9181),a=r(9189),i=[n.GET_CLIENT_METADATA,n.RETRIEVE_LOOKUP_DATA_ACTION,a.GC_REMOVE_METADATA];function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;if(-1===i.indexOf(t.type)||!t||!t.payload||!t.payload.attributes)return e;if(t.type===a.GC_REMOVE_METADATA)return s(e,t);var r=Object.assign({},e);for(var o in t.payload.attributes)if(r[o])if(t.type===n.RETRIEVE_LOOKUP_DATA_ACTION)for(var u in r[o]=Object.assign({},r[o]),t.payload.attributes[o])r[o].hasOwnProperty(u)||(r[o][u]=Object.assign({},t.payload.attributes[o][u]));else r[o]=Object.assign({},r[o],t.payload.attributes[o]);else r[o]=t.payload.attributes[o];return Object.freeze(r)}function s(e,t){if(!t.payload.attributes||0===Object.keys(t.payload.attributes).length)return e;var r={};for(var n in e){var a=!1;for(var i in t.payload.attributes)if(n===i){a=!0;break}a||(r[n]=e[n])}return r}},9334:function(e,t,r){"use strict";r.r(t),r.d(t,"createStore",(function(){return u}));var n=r(9335),a=r(9340),i=r(9341),o=r(9342),s=r(9343);function u(e,t,r,u){var c=[];if(r){var l=Object(i.actionInspector)(r);c.push(l)}c.push(Object(n.contextBoundAsyncDispatch)(t),a.selectorBasedSubscription,s.renderingSchedulerEnhancer);var d=Object(o.compose)(...c);return Object(o.createStore)(e,u,d)}},9335:function(e,t,r){"use strict";r.r(t),r.d(t,"contextBoundAsyncDispatch",(function(){return i}));var n=r(9336),a=r(9046);function i(e){return t=>(r,i)=>{var o=t(r,i);return function(e,t){var r={subscribe:t.subscribe,getState:t.getState,dispatch:function(e,r){return t.dispatch(e,r)}},i=e.TraceManager.getTracer("ActionLogging"),o=new n.ActionExecutor(r,t.dispatch,e,i);return t.dispatch=function(e,t){return t=t?{entryStack:t.entryStack,stack:(t.stack||"")+" :"+e.type,correlationId:t.correlationId||a.Guid.toString(a.Guid.newGuid()),contextId:a.Guid.toString(a.Guid.newGuid()),parentContextId:t.contextId||"",isPreloadCall:t.isPreloadCall}:{entryStack:void 0,stack:e.type,correlationId:a.Guid.toString(a.Guid.newGuid()),contextId:a.Guid.toString(a.Guid.newGuid()),parentContextId:""},o.executeAction(e,t)},t}(e,o)}}},9336:function(e,t,r){"use strict";r.r(t),r.d(t,"ActionExecutor",(function(){return c}));var n=r(9337),a=r(9338),i=r(9339),o=r(9318),s=r(9185),u=r(9083);class c{constructor(e,t,r,n){this._store=void 0,this._dispatch=void 0,this._applicationContext=void 0,this._tracer=void 0,this._pendingActionCache={},this._store=e,this._dispatch=t,this._applicationContext=r,this._tracer=n}executeAction(e,t){return Object(n.isAsyncAction)(e)?this._executeAsync(e,t):this._executeSync(e,t)}_executeSync(e,t){try{return this._beginExecution(e,this._store,this._applicationContext,t),Object(n.isPlainAction)(e)?void this._executePlainAction(e,t):this._executeSyncAction(e,t)}catch(r){this._handleFailure(r,e,this._store,this._applicationContext,t,!0)}}_executePlainAction(e,t){this._dispatch(e),this._handleSuccess(e,void 0,this._store,this._applicationContext,t)}_executeSyncAction(e,t){var r=this._store,n=e.execute(r,this._applicationContext,t);return this._handleSuccess(e,n,this._store,this._applicationContext,t),n}_executeAsync(e,t){var r=e.cacheKey;return r&&this._pendingActionCache[r]?this._pendingActionCache[r]:this._executeAsyncAction(e,t)}_executeAsyncAction(e,t){var r=new Promise(r=>{this._beginExecution(e,this._store,this._applicationContext,t);var n=function(e,t,r){var n={getState:e.getState,dispatch:r=>e.dispatch(r,t)};r&&(n.subscribe=e.subscribe);return n}(this._store,t,Object(i.isFullStoreAware)(e));try{var a=e.execute(n,this._applicationContext,t);a||this._tracer.warn("No promise returned from execute method, ActionType: ".concat(e.type,".")),r(a)}finally{}}).then(r=>(this._handleSuccess(e,r,this._store,this._applicationContext,t),r)).catch(r=>this._handleFailure(r,e,this._store,this._applicationContext,t)),n=e.cacheKey;if(n){this._pendingActionCache[n]=r;var a=()=>delete this._pendingActionCache[n];r.then(a,a)}return r}_beginExecution(e,t,r,n){var a=this._getExecutionParameters(e,n);if("function"==typeof e.getInitialParameters){var i=r.EventManager;try{Array.prototype.push.apply(a,e.getInitialParameters(t,r))}catch(o){this._tracer.error("AsyncActionExecutor.getInitialParameters failed, message : ".concat(o.message),a)}i.ReportComponentSuccess("AsyncActionExecutor.BeginExecute",a)}else this._tracer.info("Begin executing action",this._getExecutionParameters(e,n))}_handleSuccess(e,t,r,n,a){var i=this._getExecutionParameters(e,a);if("function"==typeof e.getSuccessParameters){var o=n.EventManager;try{Array.prototype.push.apply(i,e.getSuccessParameters(t,r,n))}catch(s){this._tracer.error("AsyncActionExecutor.getSuccessParameters failed, message : ".concat(s.message),i)}o.ReportComponentSuccess("AsyncActionExecutor.EndExecute",i)}else this._tracer.info("Finished executing action successfully",this._getExecutionParameters(e,a))}_handleFailure(e,t,r,n,i){var c,l=arguments.length>5&&void 0!==arguments[5]&&arguments[5],d=n.EventManager,p={actionType:t.type,actionStack:i.stack,contextId:i.contextId},f="";if(e){var h=Object(o.ensureErrorObject)(e);if("object"==typeof e){if(Object.isFrozen(e)){var m=Object(s.createUciError)(h.message);m.innerError=e,c=m}else c=e;try{c.message=h.message,c.name=c.name||h.name,c.stack=h.stack}catch(E){E&&E.message&&this._tracer.error("Copying ensuredError properties to error object failed, message : ".concat(E.message)),f=JSON.stringify(h,Object.getOwnPropertyNames(h))}}else c=h;Object(a.hasActionFailureDetails)(e)||(c.__action={source:p})}else(c=new Error("Action Executor detected an error, but the action (".concat(t.type,") failed to supply an error object."))).__action={source:p};var y=c.__action,v=this._getExecutionFailureParameters(t,y,i);Object(u.IsNullOrUndefinedOrEmptyString)(f)||v.push({name:"ReadOnlyErrorObjectString",value:f});var g=!i.parentContextId;if("function"==typeof t.getFailureParameters)try{Array.prototype.push.apply(v,t.getFailureParameters(c,y,r,n)),g=!0}catch(b){this._tracer.error("AsyncActionExecutor.getFailureParameters failed, message : ".concat(b.message),v)}if(g){var O="This is a failure that ".concat(i.parentContextId?"is yet to reach":"reached uncaught to"," the entry level dispatch. For additional information, query for all events with the same CorrelationId.");d.ReportComponentFailure("AsyncActionExecutor.EndExecute",c,O,v)}if(y.child=p,l)throw c;return Promise.reject(c)}_getExecutionParameters(e,t){var r=[{name:"ActionType",value:e.type},{name:"CorrelationId",value:t.correlationId},{name:"ContextId",value:t.contextId},{name:"EntryStack",value:t.entryStack},{name:"ActionStack",value:t.stack}];return t.parentContextId&&r.push({name:"ParentContextId",value:t.parentContextId}),r}_getExecutionFailureParameters(e,t,r){var n=[{name:"ActionType",value:e.type},{name:"CorrelationId",value:r.correlationId},{name:"ContextId",value:r.contextId},{name:"EntryStack",value:r.entryStack},{name:"ActionStack",value:t.source.actionStack},{name:"SourceContextId",value:t.source.contextId}];return r.parentContextId&&n.push({name:"ParentContextId",value:r.parentContextId}),n}}},9337:function(e,t,r){"use strict";function n(e){return void 0===e.execute}function a(e){return!n(e)&&!e.sync}r.r(t),r.d(t,"isAsyncAction",(function(){return a})),r.d(t,"isPlainAction",(function(){return n}))},9338:function(e,t,r){"use strict";function n(e){return"object"==typeof e&&null!==e&&"object"==typeof e.__action}r.r(t),r.d(t,"hasActionFailureDetails",(function(){return n}))},9339:function(e,t,r){"use strict";function n(e){return!!e.shouldReceiveFullStore}r.r(t),r.d(t,"isFullStoreAware",(function(){return n}))},9340:function(e,t,r){"use strict";function n(e){return(t,r)=>{var n=e(t,r);return n.subscribe=function(e){var t=e.subscribe;return function(r,n){var a;if(void 0===n)return t(a=r);var i=r;return a=function(e,t,r){var n;return function(){var a=t(e());a!==n&&(n=a,r(a))}}(e.getState,i,n),t(a)}}(n),n}}r.r(t),r.d(t,"selectorBasedSubscription",(function(){return n}))},9341:function(e,t,r){"use strict";function n(e){return t=>(r,n)=>{var a=t(r,n);return a.dispatch=function(e,t,r){return function(n){return r(e,n),t.apply(void 0,arguments)}}(a,a.dispatch,e),a}}r.r(t),r.d(t,"actionInspector",(function(){return n}))},9343:function(e,t,r){"use strict";r.r(t),r.d(t,"flushRendering",(function(){return p})),r.d(t,"scheduleControlUpdate",(function(){return y})),r.d(t,"scheduleMeasurementUpdate",(function(){return v})),r.d(t,"renderingSchedulerEnhancer",(function(){return O}));var n=r(808),a=r(9337),i=[],o=!1,s=[],u=s,c=[],l=!1,d=!1;function p(){!function(){o=!1;var e=i.length>0;i=[],l=!0;try{n.unstable_batchedUpdates(()=>{var t;if(d&&(d=!1),t=c.slice(),c=[],t.forEach(e=>e()),e)for(var r=s=u,n=0;n<r.length;n++)r[n]()})}finally{l=!1}}()}function f(){o||(o=!0)}function h(){u===s&&(u=s.slice())}function m(e){if("function"!=typeof e)throw new Error("Expected listener to be a function.");var t=!0;return h(),u.push(e),function(){if(t){t=!1,h();var r=u.indexOf(e);u.splice(r,1)}}}function y(e){l?e():(c.push(e),f())}function v(){d=!0,f()}function g(e,t){var r=e(t);return Object(a.isPlainAction)(t)&&(i.push(t.type),f()),r}function O(e){return(t,r)=>{var n=e(t,r),a=g.bind(null,n.dispatch);return n.dispatch=a,n.subscribeImmediate=n.subscribe,n.subscribe=m,n}}}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/270.78512f64.chunk.js.map