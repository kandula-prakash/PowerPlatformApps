/*! For license information please see 154.2cae8060.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[154],{5904:function(e,t,n){"use strict";n.r(t),n.d(t,"convertCDSResponseToGroupItems",(function(){return x})),n.d(t,"getRoleErrors",(function(){return P})),n.d(t,"getUserNameById",(function(){return I})),n.d(t,"AppModuleSharePanelInternal",(function(){return U})),n.d(t,"AppModuleSharePanel",(function(){return T}));var r=n(5058),o=n(3076),i=n(1089),s=n(5905),a=n(3193),l=n(5909),c=n(1144),u=n(923),d=n(2867),p=n(2812),m=n(245),f=n.n(m),v=n(5913),y=n(5915),S=n(5922),b=n(5914);function g(){return(g=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){R(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function R(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function j(e,t,n,r,o,i,s){try{var a=e[i](s),l=a.value}catch(c){return void n(c)}a.done?t(l):Promise.resolve(l).then(r,o)}function C(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function s(e){j(i,r,o,s,a,"next",e)}function a(e){j(i,r,o,s,a,"throw",e)}s(void 0)}))}}function A(e,t){return M.apply(this,arguments)}function M(){return(M=C((function*(e,t){var n=yield e.get("https://ms-graph/v1.0/users/".concat(t,"/photo/$value"),{responseType:"arraybuffer"});return n?Object(r.getBase64ImageUri)(n.data):""}))).apply(this,arguments)}var E=Object(p.memoize)(e=>{if(e&&e.length>0){var t={};return e.forEach(e=>{t[e.systemUserId]={fullName:e.fullName,objectId:e.systemUserId,email:e.internalEmailAddress||"",principalType:l.PrincipalType.User,azureactivedirectoryobjectid:e.azureactivedirectoryobjectid,businessUnitId:e.businessUnitId,groupType:void 0}}),t}return{}}),x=Object(p.memoize)(e=>e.map(e=>({fullName:e.name,objectId:e.teamId,email:e.emailAddress||"",principalType:l.PrincipalType.Group,businessUnitId:e.businessUnitId,groupType:e.teamType})));function P(e,t,n){if(!e||Object(p.isEmpty)(t))return"";var r=e.reduce((e,t)=>(e[t.roleid]=t.name,e),{});return t.map(e=>"Role: '".concat(r[e.id],"' - Error: '").concat(function(e,t){if(t[w[(null==e?void 0:e.code)||""]])return t[w[(null==e?void 0:e.code)||""]];if(null!=e&&e.message)return e.message;return t.unknownError}(e.error,n),"'")).join(", ")}var w={"0x80041409":"differentBusinessUnit"};function I(e,t,n,r){for(var o of n)if(void 0!==o.objectId&&(o.objectId===e||o.objectId===t))return o.fullName;for(var i of r)if(void 0!==i.objectId&&(i.objectId===e||i.objectId===t))return i.fullName;return null}var U=e=>{var t,n,{httpClient:r}=e,{environmentRoles:o,lifeCycleStep:l,onSubmitErrors:c,refetchData:u}=Object(m.useContext)(y.AppModuleSharingStageContext),{clearNewUserSelectionSet:p}=f.a.useContext(b.AppModuleSharingSelectionContext),[v,h]=Object(m.useState)(Object(d.Map)()),[R,j]=Object(m.useState)({}),[C,M]=Object(m.useState)({}),{cdsUsersAndTeamsList:w,loading:U,refetch:T,errorMessage:k}=Object(s.useCdsUsersAndTeamsQuery)(e.environmentClient,{appId:e.appModule.id},a.PortalTelemetryScope,e.t("Common.Request.Failed")),D=null!==(t=null==w?void 0:w.cdsUsers)&&void 0!==t?t:[];Object(m.useEffect)(()=>{D.length>0&&j(E(D))},[D.length]);var L=[...x(null!==(n=null==w?void 0:w.cdsTeams)&&void 0!==n?n:[]),...Object.keys(R).map(e=>R[e])].sort((e,t)=>e.fullName>t.fullName?1:-1);Object(m.useEffect)(()=>{u()},[]),Object(m.useEffect)(()=>{l===y.SharingLifeCycle.refetch&&(h(Object(d.Map)()),p(),T())},[l]);var N={unknownError:e.t("ModelDrivenApps.Share.unexpectedErrorMessage"),differentBusinessUnit:e.t("ModelDrivenApps.Share.knownErrors.differentBusinessUnit")},G=k;if(!G&&c)if("string"==typeof c)G=c;else if("SubmitRoleAssignmentError"===c.errorType){var F,z,q;G=Object(i.formatResourceString)(e.t("ModelDrivenApps.Share.partialFailureMessage"),I(null!==(F=c.systemId)&&void 0!==F?F:void 0,null!==(z=c.aadId)&&void 0!==z?z:void 0,L,v.valueSeq().toArray())||e.t("Common.unknown")),G+=" ".concat(P(o,null!==(q=c.failedRoles)&&void 0!==q?q:[],N))}else"DisabledAadEntryError"===c.errorType&&(G=Object(i.formatResourceString)(e.t("ModelDrivenApps.Share.userNotEnabledInAadFailure"),I(void 0,c.objectId,L,v.valueSeq().toArray())||e.t("Common.unknown")));return f.a.createElement(S.AppModuleSharePanelPresentational,g({},e,{newUsers:v.valueSeq().toArray(),existingUsers:L,isExistingUsersLoading:U,addNewUser:t=>{h(v.set(t.objectId,t)),A(e.httpClient,t.objectId).then(e=>h(v.set(t.objectId,O(O({},t),{},{imageUrl:e}))))},removeNewUser:e=>{v.has(e)&&h(v.remove(e))},thumbnails:C,errorMessage:G,onRenderPersona:e=>{e.azureactivedirectoryobjectid&&void 0===C[e.objectId]&&(M(t=>(t[e.objectId]="",t)),A(r,e.azureactivedirectoryobjectid).then(t=>{M(n=>(n[e.objectId]=t,n))}))}}))},T=Object(u.translateService)("PowerAppsPortalSharing")(Object(c.withHttpClient)(Object(o.withApolloClient)(e=>f.a.createElement(v.AppModuleSharingProvider,{appModule:e.appModule},f.a.createElement(U,e)))))},5913:function(e,t,n){"use strict";n.r(t),n.d(t,"AppModuleSharingProvider",(function(){return a}));var r=n(245),o=n.n(r),i=n(5914),s=n(5915),a=e=>o.a.createElement(i.AppModuleSharingAppProvider,{appModule:e.appModule},o.a.createElement(i.AppModuleSharingSelectionProvider,null,o.a.createElement(s.AppModuleSharingStageProvider,null,e.children)))},5914:function(e,t,n){"use strict";n.r(t),n.d(t,"AppModuleSharingAppContext",(function(){return a})),n.d(t,"SelectedEntityType",(function(){return r})),n.d(t,"AppModuleSharingSelectionContext",(function(){return l})),n.d(t,"AppModuleSharingAppProvider",(function(){return c})),n.d(t,"AppModuleSharingSelectionProvider",(function(){return u}));var r,o=n(245),i=n.n(o),s=()=>{},a=i.a.createContext({appId:void 0,appModule:void 0});!function(e){e[e.newUser=0]="newUser",e[e.existingUser=1]="existingUser",e[e.app=2]="app"}(r||(r={}));var l=i.a.createContext({selectedEntity:void 0,selectedEntityType:void 0,setExistingUserSelection:s,clearExistingUserSelectionSet:s,setNewUserSelection:s,clearNewUserSelectionSet:s,setAppRolesSelection:s,clearAppRolesSelectionSet:s}),c=e=>i.a.createElement(a.Provider,{value:{appId:e.appModule.id,appModule:e.appModule}},e.children),u=e=>{var{appModule:t}=Object(o.useContext)(a),[n,s]=Object(o.useState)(void 0),[c,u]=Object(o.useState)(void 0),d=()=>{s(void 0),u(void 0)};return i.a.createElement(l.Provider,{value:{selectedEntity:n,selectedEntityType:c,setExistingUserSelection:e=>{s(e),u(r.existingUser)},clearExistingUserSelectionSet:d,setNewUserSelection:e=>{s(e),u(r.newUser)},clearNewUserSelectionSet:d,setAppRolesSelection:()=>{s({key:t.id,appModule:t}),u(r.app)},clearAppRolesSelectionSet:d}},e.children)}},5915:function(e,t,n){"use strict";n.r(t),n.d(t,"SharingLifeCycle",(function(){return r})),n.d(t,"AppModuleShareTelemetry",(function(){return o})),n.d(t,"AppModuleSharingStageContext",(function(){return P})),n.d(t,"convertCDSEnvironmentRoles",(function(){return I})),n.d(t,"convertCDSResponseToUserRoles",(function(){return U})),n.d(t,"convertCDSResponseToAppRoles",(function(){return T})),n.d(t,"getAppCDSRoles",(function(){return k})),n.d(t,"AppModuleSharingStageProviderInternal",(function(){return D})),n.d(t,"AppModuleSharingStageProvider",(function(){return ee}));var r,o,i=n(5916),s=n(3076),a=n(5917),l=n(5910),c=n(5919),u=n(3185),d=n(5920),p=n(5905),m=n(3192),f=n(3193),v=n(923),y=n(217),S=n(3145),b=n(2867),g=n(2812),h=n(245),O=n.n(h),R=n(5914);function j(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function C(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?j(Object(n),!0).forEach((function(t){A(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function A(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function M(e,t,n,r,o,i,s){try{var a=e[i](s),l=a.value}catch(c){return void n(c)}a.done?t(l):Promise.resolve(l).then(r,o)}function E(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function s(e){M(i,r,o,s,a,"next",e)}function a(e){M(i,r,o,s,a,"throw",e)}s(void 0)}))}}!function(e){e[e.initial=0]="initial",e[e.submitting=1]="submitting",e[e.refetch=2]="refetch",e[e.success=3]="success"}(r||(r={})),function(e){e.AppModuleShareSubmitCompleted="appModuleShareSubmitCompleted",e.AppModuleShareSubmitFailed="appModuleShareSubmitFailed"}(o||(o={}));var x=()=>{},P=O.a.createContext({environmentRoles:Object(b.List)(),appRoles:Object(b.List)(),currentEntityBusinessUnitId:void 0,currentEntityRoles:{addedRoles:Object(b.Map)(),removedRoles:Object(b.Map)()},currentEntityRolesLoading:!0,currentEntityRolesLoadingErrors:void 0,toggleRole:x,removeNewUser:x,addNewPrincipal:x,isDirty:!1,onSubmit:x,onSubmitErrors:void 0,lifeCycleStep:r.initial,refetchData:x}),w=(e,t)=>(e&&e.addedRoles.has(t)?e={addedRoles:e.addedRoles.remove(t),removedRoles:e.removedRoles.set(t,!1)}:e&&(e={addedRoles:e.addedRoles.set(t,!1),removedRoles:e.removedRoles.remove(t)}),e),I=Object(g.memoize)(e=>{if(e)return Object(b.List)(e.map(e=>({name:e.name,roleid:e.roleId,_roletemplateid_value:e.roleTemplateIdValue,_parentroleid_value:e.parentRoleIdValue,_parentrootroleid_value:e.parentRootRoleIdValue,_businessunitid_value:e.businessUnitId})))}),U=Object(g.memoize)(e=>{if(e)return Object(b.Map)().withMutations(t=>{for(var n of e.cdsUsers){var r=n.systemUserId,o=Object(b.Map)((n.cdsRoles||[]).map(e=>[e.roleId,!0]));t.set(r,{principalType:l.PrincipalType.User,roles:{addedRoles:o,removedRoles:Object(b.Map)()},name:n.fullName,teamtype:void 0})}for(var i of e.cdsTeams){var s,a=i.teamId,c=Object(b.Map)((i.cdsRoles||[]).map(e=>[e.roleId,!0]));t.set(a,{principalType:l.PrincipalType.Group,roles:{addedRoles:c,removedRoles:Object(b.Map)()},name:i.name,teamtype:null!==(s=i.teamType)&&void 0!==s?s:void 0})}})}),T=Object(g.memoize)(e=>{if(e)return{addedRoles:Object(b.Map)(e.map(e=>[e.roleId,!0])),removedRoles:Object(b.Map)()}}),k=Object(g.memoize)((e,t)=>{if(e&&t)return Object(b.List)(t.filter(t=>e.addedRoles.has(t.roleid)))}),D=e=>{var{appId:t}=Object(h.useContext)(R.AppModuleSharingAppContext),{selectedEntity:n,selectedEntityType:o}=Object(h.useContext)(R.AppModuleSharingSelectionContext),[s,c]=Object(h.useState)(!0),[m,v]=Object(h.useState)(!1),[y,S]=Object(h.useState)(r.initial),[j,C]=Object(h.useState)(),[A,M]=Object(h.useState)(),[x,D]=Object(h.useState)(!1),[z,q]=Object(h.useState)(),[B,_]=Object(h.useState)(Object(b.Map)()),[H,Q]=Object(h.useState)(""),{cdsRoles:$,loading:W,refetch:V}=Object(d.useCdsEnvironmentRolesQuery)(e.environmentClient,{},f.PortalTelemetryScope,e.t("Common.Request.Failed")),{cdsUsersAndTeamsList:J,loading:K,refetch:X,errorMessage:Y}=Object(p.useCdsUsersAndTeamsQuery)(e.environmentClient,{appId:t},f.PortalTelemetryScope,e.t("Common.Request.Failed")),{roles:Z,loading:ee,refetch:te,errorMessage:ne}=Object(u.useAppModuleRolesQuery)(e.environmentClient,{appModuleId:t},f.PortalTelemetryScope,e.t("Common.Request.AppModuleNotFound"),e.t("Common.Request.Failed"));Object(h.useEffect)(()=>{W||C(I($))},[W]),Object(h.useEffect)(()=>{K||q(U(J))},[K]),Object(h.useEffect)(()=>{ee||M(T(Z))},[ee]);var re,oe=()=>{var e=N(B),t=L(z);return{users:[...e.users,...t.users],groups:[...e.groups,...t.groups]}},{currentEntityBusinessUnitId:ie,currentEntityRoles:se,currentEntityRolesLoading:ae,currentEntityRolesLoadingErrors:le}=function(e,t,n,r,o,s,a,l,c){var u,{selectedEntity:d,selectedEntityType:p}=Object(h.useContext)(R.AppModuleSharingSelectionContext),m={addedRoles:Object(b.Map)(),removedRoles:Object(b.Map)()},f=!1,v="";if(void 0===p)return{currentEntityBusinessUnitId:void 0,currentEntityRoles:m,currentEntityRolesLoading:!1,currentEntityRolesLoadingErrors:""};var y=d.key;switch(p){case R.SelectedEntityType.app:!a&&s&&(m=s),f=a||c,v=l;break;case R.SelectedEntityType.existingUser:!r&&n&&(m=n.get(y).roles,v=o),f=r||a||c;break;case R.SelectedEntityType.newUser:!t&&e&&e.get(y)&&(u=e.get(y).businessUnitId,m=e.get(y).roles,v=e.get(y).errors),f=t||a||c;break;default:throw new Error("[Share Panel] Unexpected entity type")}var S=v&&!Object(g.isEmpty)(v)?Object(i.parseMessageFromError)(JSON.parse(v)):void 0;return{currentEntityBusinessUnitId:u,currentEntityRoles:m,currentEntityRolesLoading:f,currentEntityRolesLoadingErrors:S}}(B,x,z,K,Y,A,ee,ne,W),ce=W||ee?void 0:k(A,j);return O.a.createElement(P.Provider,{value:{appRoles:ce,environmentRoles:j,currentEntityBusinessUnitId:ie,currentEntityRoles:se,currentEntityRolesLoading:ae,currentEntityRolesLoadingErrors:le,toggleRole:e=>{if(void 0!==o)switch(o){case R.SelectedEntityType.app:M(w(A,e)),v(!0);break;case R.SelectedEntityType.existingUser:q(((e,t,n)=>{var{principalType:r,roles:o,name:i,teamtype:s}=e.get(t),a={principalType:r,roles:w(o||null,n),name:i,teamtype:s};return e.set(t,a)})(z,n.key,e)),v(!0);break;case R.SelectedEntityType.newUser:_(((e,t,n)=>{var r=e.get(t);return r.roles=w(r.roles,n),e.set(t,r)})(B,n.key,e)),v(!0);break;default:throw new Error("[Share Panel] Unexpected entity type")}},removeNewUser:e=>{_(B.remove(e)),v(!0)},addNewPrincipal:(re=E((function*(t,n,r,o){_(B.set(t,{name:r,systemId:void 0,businessUnitId:void 0,principalType:n,roles:{addedRoles:Object(b.Map)(),removedRoles:Object(b.Map)()},errors:void 0,teamtype:o})),v(!0),D(!0);var{systemId:i,businessUnitId:s,roles:a,errors:c}=yield Object(l.getPrincipalDataAndRoles)(t,e.environmentClient,n);D(!1),_(B.set(t,{name:r,systemId:i,businessUnitId:s,principalType:n,roles:a,errors:c,teamtype:o})),v(!0)})),function(e,t,n,r){return re.apply(this,arguments)}),isDirty:m,lifeCycleStep:y,onSubmit:()=>{!function(e,t,n,r,o,i,s,a,l,c,u,d,p){F.apply(this,arguments)}(e.environmentClient,t,A,S,v,_,c,Q,V,X,te,oe,e.t)},onSubmitErrors:H,refetchData:()=>{!function(e,t,n,r){G.apply(this,arguments)}(S,V,X,te)}}},O.a.createElement(a.ConfirmDialog,{hidden:s,hideCancelButton:!0,shouldKeepButtonEnabledOnConfirm:!0,subText:e.t("ModelDrivenApps.NoChangeConfirmationDialog.subtext"),confirmButtonText:e.t("ModelDrivenApps.ConfirmationDialog.cancelButtonText"),onConfirm:()=>{c(!0)}}),e.children)};var L=e=>{var t=[],n=[];return e.forEach((e,r)=>{if(e){var o=e.roles.addedRoles.filter((e,t)=>!e).keySeq().toArray(),i=e.roles.removedRoles.filter((e,t)=>!e).keySeq().toArray();(o.length>0||i.length>0)&&(e.principalType===l.PrincipalType.User?t.unshift({systemId:r,addedRoles:o,removedRoles:i}):n.push({name:e.name,type:e.teamtype,teamId:r,addedRoles:o,removedRoles:i}))}}),{users:t,groups:n}},N=e=>{var t=[],n=[];return e.forEach((e,r)=>{if(e){var o=e.roles.addedRoles.filter((e,t)=>!e).keySeq().toArray(),i=e.roles.removedRoles.filter((e,t)=>!e).keySeq().toArray();(o.length>0||i.length>0)&&(e.principalType===l.PrincipalType.User?t.push({aadId:r,addedRoles:o,removedRoles:i}):n.push({name:e.name,type:e.teamtype,aadId:r,addedRoles:o,removedRoles:i}))}}),{users:t,groups:n}};function G(){return(G=E((function*(e,t,n,o){e(r.refetch),yield Promise.all([t(),n(),o()]),e(r.initial)}))).apply(this,arguments)}function F(){return(F=E((function*(e,t,n,i,s,a,l,c,u,d,p,m,v){i(r.submitting);var S=Object(y.trackUpdateScenario)(f.PortalTelemetryScope,"SubmitModelAppSharing"),g=!1,h=!1;try{if(!n)throw new Error("The roles for this app cannot be undefined");var O=z(t,n);g=yield q(O,e,S,c);var R=m();h=yield _(R,e,S,c),S&&S.progress({message:"Model driven app sharing entity roles diff submitted"}),S&&S.complete(),Object(y.trackInfoTrace)(f.PortalTelemetryScope,{eventName:o.AppModuleShareSubmitCompleted})}catch(j){Q(j,c,v,S,i)}if(!g&&!h)return l(!1),s(!1),void i(r.initial);i(r.refetch),s(!1),yield Promise.all([u(),d(),p()]),a(Object(b.Map)()),i(r.success)}))).apply(this,arguments)}function z(e,t){return{appModuleId:e,addedRoles:t.addedRoles.filter((e,t)=>!e).keySeq().toArray(),removedRoles:t.removedRoles.filter((e,t)=>!e).keySeq().toArray()}}function q(e,t,n,r){return B.apply(this,arguments)}function B(){return(B=E((function*(e,t,n,r){return!Object(g.isEmpty)(e)&&(n&&n.progress({message:"Model driven app sharing app roles diff calculated",appsListDiffData:e}),yield $(e,t,n,r),yield V(e,t,n,r),!0)}))).apply(this,arguments)}function _(e,t,n,r){return H.apply(this,arguments)}function H(){return(H=E((function*(e,t,n,r){return!(Object(g.isEmpty)(e)||Object(g.isEmpty)(e.users)&&Object(g.isEmpty)(e.groups))&&(n&&n.progress({message:"Model driven app sharing user roles diff calculated",entityRolesDiffData:e}),yield K(e,t,n,r),yield Y(e,t,n,r),!0)}))).apply(this,arguments)}function Q(e,t,n,s,a){if(e instanceof S.ApolloError){var l="",c=Object(m.getResponseObjectFromApolloError)(e);if(403===(null==c?void 0:c.statusCode))l=n("ModelDrivenApps.Share.permissionErrorMessage");else{var u=Object(m.getResponseMessageFromApolloError)(e);l=Object(i.parseMessageFromBatchResponse)(u)}void 0===l&&(l=n("ModelDrivenApps.Share.unexpectedErrorMessage")),t(l)}else if(e instanceof Error){t(Object(i.parseMessageFromError)(e))}else"string"==typeof e&&t(e);s&&s.failure({error:e}),a(r.initial),Object(y.trackErrorTrace)(f.PortalTelemetryScope,{eventData:e,eventName:o.AppModuleShareSubmitFailed})}function $(e,t,n,r){return W.apply(this,arguments)}function W(){return(W=E((function*(e,t,n,r){if(e.addedRoles.length>0){var o=yield t.mutate({mutation:c.AppModuleShareAddAppRolesMutation,variables:{input:e}});if(o.errors)throw n&&n.failure({message:"Model driven app sharing app roles diff submit failed",appListDiffSubmitError:o.errors}),o.errors;var{failedRoles:i}=o.data.addAppModuleRole;!!i.length&&i.length?r("SubmitRoleAssignmentError: "+i):r("")}}))).apply(this,arguments)}function V(e,t,n,r){return J.apply(this,arguments)}function J(){return(J=E((function*(e,t,n,r){if(e.removedRoles.length>0){var o=yield t.mutate({mutation:c.AppModuleShareRemoveAppRolesMutation,variables:{input:e}});if(o.errors)throw n&&n.failure({message:"Model driven app sharing app roles diff submit failed",appListDiffSubmitError:o.errors}),o.errors;var{failedRoles:i}=o.data.removeAppModuleRole;!!i.length&&i.length?r("SubmitRoleAssignmentError: "+i):r("")}}))).apply(this,arguments)}function K(e,t,n,r){return X.apply(this,arguments)}function X(){return(X=E((function*(e,t,n,r){if(e.users.some(e=>e.addedRoles.length>0)||e.groups.some(e=>e.addedRoles.length>0)){var o=yield t.mutate({mutation:c.AppModuleShareAddUserRolesMutation,variables:{input:e}});if(null!=o&&o.errors)throw n&&n.failure({message:"Model driven app sharing user roles diff submit failed",entityRolesDiffSubmitError:o.errors}),o.errors;var{failedUsers:i,failedGroups:s}=o.data.submitAppModuleShare;if(!!i.length||!!s.length)r(C(C({},!!i.length&&i[0]||s[0]),{},{errorType:"SubmitRoleAssignmentError"}));else r("")}}))).apply(this,arguments)}function Y(e,t,n,r){return Z.apply(this,arguments)}function Z(){return(Z=E((function*(e,t,n,r){if(e.users.some(e=>e.removedRoles.length>0)||e.groups.some(e=>e.removedRoles.length>0)){var o=yield t.mutate({mutation:c.AppModuleShareAddUserRolesMutation,variables:{input:e}});if(null!=o&&o.errors)throw n&&n.failure({message:"Model driven app sharing user roles diff submit failed",entityRolesDiffSubmitError:o.errors}),o.errors;var{failedUsers:i,failedGroups:s}=o.data.submitAppModuleShare;if(!!i.length||!!s.length)r(C(C({},!!i.length&&i[0]||s[0]),{},{errorType:"SubmitRoleAssignmentError"}));else r("")}}))).apply(this,arguments)}var ee=Object(v.translateService)("PowerAppsPortalSharing")(Object(s.withApolloClient)(D))},5919:function(e,t,n){"use strict";n.r(t),n.d(t,"AppModuleShareAddAppRolesMutation",(function(){return u})),n.d(t,"AppModuleShareRemoveAppRolesMutation",(function(){return d})),n.d(t,"AppModuleShareAddUserRolesMutation",(function(){return p})),n.d(t,"AppModuleShareRemoveUserRolesMutation",(function(){return m}));var r,o,i,s,a=n(3128),l=n.n(a);function c(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var u=l()(r||(r=c(["\n  mutation addAppRoles($input: AppModuleShareAppRoles!) {\n    addAppModuleRole(input: $input) {\n      appModuleId\n      failedRoles {\n        id\n        error {\n          code\n          message\n        }\n      }\n    }\n  }\n"]))),d=l()(o||(o=c(["\n  mutation removeAppRoles($input: AppModuleShareAppRoles!) {\n    removeAppModuleRole(input: $input) {\n      appModuleId\n      failedRoles {\n        id\n        error {\n          code\n          message\n        }\n      }\n    }\n  }\n"]))),p=l()(i||(i=c(["\n  mutation addUserRoles($input: AppModuleShareMutationInput!) {\n    submitAppModuleShare(input: $input) {\n      users {\n        aadId\n        systemId\n      }\n      failedUsers {\n        aadId\n        systemId\n        failedRoles {\n          id\n          error {\n            code\n            message\n          }\n        }\n      }\n      groups {\n        aadId\n        teamId\n      }\n      failedGroups {\n        aadId\n        teamId\n        failedRoles {\n          id\n          error {\n            code\n            message\n          }\n        }\n      }\n    }\n  }\n"]))),m=l()(s||(s=c(["\n  mutation removeUserRoles($input: AppModuleShareMutationInput!) {\n    submitAppModuleShare(input: $input) {\n      users {\n        aadId\n        systemId\n      }\n      failedUsers {\n        aadId\n        systemId\n        failedRoles {\n          id\n          error {\n            code\n            message\n          }\n        }\n      }\n      groups {\n        aadId\n        teamId\n      }\n      failedGroups {\n        aadId\n        teamId\n        failedRoles {\n          id\n          error {\n            code\n            message\n          }\n        }\n      }\n    }\n  }\n"])))},5920:function(e,t,n){"use strict";n.r(t),n.d(t,"useCdsEnvironmentRolesQuery",(function(){return u}));var r=n(217),o=n(245),i=n(3186),s=n(3192),a=n(3193),l=n(5921);function c(e,t,n,r,o,i,s){try{var a=e[i](s),l=a.value}catch(c){return void n(c)}a.done?t(l):Promise.resolve(l).then(r,o)}function u(e,t,n,u){var d,p,m=a.TelemetryScenarioNames.cdsEnvironementRolesGraphQl,[f,v]=Object(o.useState)(),[y,S]=Object(o.useState)(""),{loading:b,data:g,refetch:h}=Object(i.useQuery)(l.cdsEnvironmentRoles,{client:e||void 0,onCompleted:e=>{f&&(f.complete({cdsUsersLength:e&&e.environmentRole&&e.environmentRole.length}),v(void 0)),S("")},onError:e=>{var t=Object(s.getResponseMessageFromApolloError)(e,u);S(t),f&&(f.failure({error:t,clientError:e&&e.message}),v(void 0))},variables:t,notifyOnNetworkStatusChange:!0});return Object(o.useEffect)(()=>{b&&v(Object(r.trackLoadScenario)(n,m))},[b]),{loading:b,errorMessage:y,cdsRoles:g&&g.environmentRole,refetch:(d=function*(){yield h(t)},p=function(){var e=this,t=arguments;return new Promise((function(n,r){var o=d.apply(e,t);function i(e){c(o,n,r,i,s,"next",e)}function s(e){c(o,n,r,i,s,"throw",e)}i(void 0)}))},function(){return p.apply(this,arguments)})}}},5921:function(e,t,n){"use strict";n.r(t),n.d(t,"cdsEnvironmentRoles",(function(){return a}));var r,o=n(3128);var i,s,a=n.n(o)()(r||(i=["\n  query environmentRoles {\n    environmentRole {\n      name\n      roleId\n      roleTemplateIdValue\n      parentRoleIdValue\n      parentRootRoleIdValue\n      businessUnitId\n    }\n  }\n"],s||(s=i.slice(0)),r=Object.freeze(Object.defineProperties(i,{raw:{value:Object.freeze(s)}}))))},5922:function(e,t,n){"use strict";n.r(t),n.d(t,"AppModuleSharePanelPresentational",(function(){return g}));var r=n(4013),o=n(1089),i=n(5923),s=n(5924),a=n(5925),l=n(5926),c=n(2812),u=n(1697),d=n(1573),p=n(245),m=n.n(p),f=n(5914),v=n(5915),y=n(5928),S=n(5929),b=n(5941),g=e=>{var t,{appId:n,appModule:c}=Object(p.useContext)(f.AppModuleSharingAppContext),{addNewPrincipal:g,removeNewUser:R,isDirty:j,lifeCycleStep:C,onSubmit:A}=Object(p.useContext)(v.AppModuleSharingStageContext),M=c,E={title:e.t("ModelDrivenApps.ConfirmationDialog.title"),subtext:e.t("ModelDrivenApps.ConfirmationDialog.subtext"),confirmButtonText:e.t("ModelDrivenApps.ConfirmationDialog.confirmButtonText"),cancelButtonText:e.t("ModelDrivenApps.ConfirmationDialog.cancelButtonText")};return e.errorMessage?t=O(e.errorMessage,u.MessageBarType.error):C===v.SharingLifeCycle.success&&(t=O(e.t("ModelDrivenApps.Share.successMessage"),u.MessageBarType.success)),m.a.createElement(l.SharePanel,{isLightDismiss:e.isLightDismiss,onOuterClick:e.onOuterClick,isOpen:e.isOpen,headerText:Object(o.formatResourceString)(e.t("ModelDrivenApps.Share.title"),M.name),panelSubtitle:e.t("ModelDrivenApps.Share.subtitle"),onDismiss:()=>{e.onDismiss()},showDismissDialog:j,dismissDialog:E,closeButtonType:r.PanelCloseButtonType.Back,closeButtonAriaLabel:e.t("Common.close"),type:d.PanelType.largeFixed,footerButtons:h(e,j,C,A),headerClassName:"panel-header",isLoading:C===v.SharingLifeCycle.submitting||C===v.SharingLifeCycle.refetch,messageBar:t},m.a.createElement(s.PanelSections,null,m.a.createElement(i.LeftPanelSection,null,m.a.createElement("div",{className:y.commonSharePanelClasses.userSelectionSection,"data-is-scrollable":"true"},m.a.createElement(b.SelectionSection,{appName:M.name,appImageUrl:"",appId:n,existingUsers:e.existingUsers,isExistingUsersLoading:e.isExistingUsersLoading,newUsers:e.newUsers,onRenderPersona:e.onRenderPersona,thumbnails:e.thumbnails,onUserRemoved:t=>{e.removeNewUser(t.objectId),R(t.objectId)},onNewUserAdded:t=>{var n;e.addNewUser(t),g(t.objectId,t.principalType,t.fullName,null!==(n=t.groupType)&&void 0!==n?n:void 0)},fetchUsersAndGroupsBasedOnFilterTextAsync:(e,t)=>new Promise((e,t)=>{e()}),isUserPickerDisabled:!1}))),m.a.createElement(a.RightPanelSection,null,m.a.createElement("div",{className:y.commonSharePanelClasses.permissionSection},m.a.createElement(S.CdsRolesSection,{appLoadingError:""})))))};function h(e,t,n,r){return[{primary:!0,ariaLabel:e.t("Common.share"),text:e.t("Common.share"),dismissableOnClick:r,disabled:!t||n===v.SharingLifeCycle.submitting||n===v.SharingLifeCycle.refetch},{ariaLabel:e.t("Common.cancel"),text:e.t("Common.cancel"),disabled:!1,dismissableOnClick:t=>{e.onDismiss()}}]}function O(e,t){if(!Object(c.isEmpty)(e))return{messageBarProps:{messageBarType:t,truncated:!0,isMultiline:!1},onRenderBody:()=>m.a.createElement("span",null,e)}}},5923:function(e,t,n){"use strict";n.r(t),n.d(t,"LeftPanelSection",(function(){return s}));var r=n(719),o=n(245),i=n.n(o);class s extends i.a.Component{render(){return i.a.createElement("div",{className:a.leftPanelSection},this.props.children)}}var a=Object(r.mergeStyleSets)({leftPanelSection:["LeftPanelSection",{flex:"1 0 340px",display:"flex",flexDirection:"column"}]})},5924:function(e,t,n){"use strict";n.r(t),n.d(t,"PanelSections",(function(){return a}));var r=n(719),o=n(245),i=n.n(o),s=n(860);class a extends i.a.Component{constructor(){super(...arguments),this.styles=Object(r.mergeStyleSets)({shareSection:["PanelSections",{display:Object(s.getResponsiveMode)(window)<=s.ResponsiveMode.large?null:"flex",justifyContent:"stretch",flex:"1 1 100%",minHeight:"0"},this.props.className]})}render(){return i.a.createElement("div",{className:this.styles.shareSection},this.props.children)}}},5925:function(e,t,n){"use strict";n.r(t),n.d(t,"RightPanelSection",(function(){return s}));var r=n(719),o=n(245),i=n.n(o);class s extends i.a.Component{constructor(){super(...arguments),this.theme=Object(r.getTheme)(),this.styles=Object(r.mergeStyleSets)({rightPanelSection:["RightPanelSection",{flex:"1 1 100%",display:"flex",flexDirection:"column",borderLeft:"1px solid ".concat(this.theme.semanticColors.bodyDivider)}]})}render(){return i.a.createElement("div",{className:this.styles.rightPanelSection,"data-testid":this.props.testId||"right-panel-section"},this.props.children)}}},5926:function(e,t,n){"use strict";n.r(t),n.d(t,"SharePanel",(function(){return m}));var r=n(4013),o=n(1573),i=n(1201),s=n(719),a=n(1397),l=n(245),c=n.n(l),u=n(5927);function d(){return(d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}class p extends c.a.Component{constructor(){super(...arguments),this.theme=Object(s.getTheme)(),this.onRenderSubHeader=()=>c.a.createElement("div",{className:this.styles.sharePanelSubHeader},this.props.panelSubtitle),this.onRenderBody=()=>c.a.createElement("div",{className:this.styles.sharePanelBody},this.props.children,this.props.isLoading&&c.a.createElement("div",{className:this.styles.sharePanelLoading},c.a.createElement(i.Spinner,{label:this.props.loadingMessage,size:i.SpinnerSize.large,"data-testid":this.props.loadingSpinnerTestId||"SharePanelLoadingSpinner",ariaLabel:this.props.loadingMessage}))),this.styles=Object(s.mergeStyleSets)({sharePanel:["SharePanel",{selectors:{'div[class^="ms-Panel-scrollableContent"]':{display:"flex",flexDirection:"column"},'div[class^="ba-Panel-headerContainer"]':{borderBottom:"1px solid ".concat(this.theme.semanticColors.bodyDivider)},'div[class^="ba-Panel-content"]':{display:"flex",minHeight:"100%"},'div[class^="ba-Panel-footer"]':{display:"flex",justifyContent:"flex-end"},'div[class^="ms-Panel-content"]':{padding:0}}}],sharePanelSubHeader:["SharePanel-sub-header",{marginTop:12,marginBottom:16}],sharePanelBody:["SharePanel-body",{display:"flex",flexDirection:"column",position:"relative",margin:0,flex:"1 1 100%",minHeight:"0",selectors:{".ms-Panel-content, .ba-Panel-content":{display:"flex",flex:"1 1 100%",minHeight:0,margin:0,padding:0}}}],sharePanelLoading:["SharePanel-loading",{position:"absolute",display:"flex",alignItems:"center",justifyContent:"center",top:0,left:0,width:"100%",height:"100%",backgroundColor:Object(a.updateA)(Object(a.getColorFromString)(this.theme.palette.white)||Object(a.getColorFromRGBA)({r:255,g:255,b:255}),90).str}]})}render(){return c.a.createElement(r.Panel,d({closeButtonAriaLabel:this.props.closeButtonAriaLabel||this.props.strings.common.close,type:o.PanelType.largeFixed,onRenderSubHeader:this.onRenderSubHeader,dismissOnEscape:!0},this.props,{className:Object(s.mergeStyles)(this.styles.sharePanel,this.props.className),isFooterAtBottom:!0}),this.onRenderBody())}}var m=Object(u.withLocalizedStrings)(p)},5928:function(e,t,n){"use strict";n.r(t),n.d(t,"commonSharePanelClasses",(function(){return o}));var r=n(719),o=Object(r.mergeStyleSets)({userSelectionSection:["user-selection-section section",{minWidth:"340px",overflowX:"hidden",selectors:{"div[class^='email-checkbox']":{position:"absolute",bottom:0,left:0,width:"339px",borderTop:"1px solid rgb(234, 234, 234)",paddingTop:"16px",paddingLeft:"16px",paddingBottom:"16px",backgroundColor:"rgb(255, 255, 255)"}}}],emailCheckbox:["email-checkbox",{selectors:{button:{width:"100%"},span:{fontWeight:"400"}}}],permissionSection:["permissions-section section",{flex:"1 1 100%",display:"flex",padding:"16px"}]})},5929:function(e,t,n){"use strict";n.r(t),n.d(t,"CdsRolesSection",(function(){return f}));var r=n(4065),o=n(1105),i=n(5910),s=n(923),a=n(245),l=n(5914),c=n(5915),u=n(5930),d=n(5933),p=n(860),m=n(2752);var f=Object(o.withEnvironment)(Object(s.translateService)("PowerAppsPortalSharing")(e=>{var t,n,o=d.cdsRolesSectionStyleClasses["cds-roles-section"],{appRoles:s,environmentRoles:f,currentEntityBusinessUnitId:v,currentEntityRoles:y,currentEntityRolesLoadingErrors:S,toggleRole:b}=a.useContext(c.AppModuleSharingStageContext),{selectedEntity:g,selectedEntityType:h}=a.useContext(l.AppModuleSharingSelectionContext);g?(n=e.appLoadingError?a.createElement("span",null):function(e,t,n,o,s,c,d,f,v){var y=void 0!==f&&""!==f||!e.currentEnvironment?a.createElement("div",null,a.createElement("span",null,f)):function(e,t,n,r,o,s,c,d){var p=[];if(t===l.SelectedEntityType.app)p=r?r.toArray().filter(e=>!e._parentroleid_value):[];else if(t===l.SelectedEntityType.existingUser||t===l.SelectedEntityType.newUser){var m,f=(null===(m=e.user)||void 0===m?void 0:m.businessUnitId)||o;if(f){var v=null==n?void 0:n.map(e=>null==e?void 0:e.name);p=r?r.toArray().filter(e=>e._businessunitid_value===f&&(null==v?void 0:v.includes(e.name))):[]}else p=n?n.toArray():[]}var y=e.user?e.user.objectId:e.appModule?e.appModule.id:"",S=e.user?i.PrincipalType.User:i.PrincipalType.App;return a.createElement(u.CdsRolesDropdown,{key:e.key,userObjectId:y,isLoggedinUserCDSAdmin:!0,cdsRolesAvailable:p,isUserRoleLoading:!1,entityRole:{id:e.key,rolesAndSaveStatus:s,aadId:y,principleType:S},currentEnvironment:d,userRoleLoadingError:"",onSecurityRoleToggled:e=>{c(e)}})}(t,n,o,s,c,d,v,e.currentEnvironment);return a.createElement(r.ExpandableResourceItem,{titles:[],subtitle:e.t("ModelDrivenApps.DataverseSecurityRoles.Section.dataSourceTitle"),showTitlesToggle:!1,showTitlesLabel:"",hideTitlesLabel:"",imageProps:{height:40,width:40,src:m.default.getPaths().DataverseConnector},rightContent:()=>y,styles:Object(p.getResponsiveMode)(window)<=p.ResponsiveMode.large?{sectionRight:{position:"relative",display:"inline-block"}}:{}})}(e,g,h,s,f,v,y,S,b),t=a.createElement("div",{className:"users-permission-panel"},a.createElement("div",{className:"users-permission-section"},a.createElement("div",{className:"users-permission-header"},function(e,t,n){var r,o,i;t===l.SelectedEntityType.app?(r=n.t("ModelDrivenApps.DataverseSecurityRoles.Section.appSelectedTitle"),o=n.t("ModelDrivenApps.DataverseSecurityRoles.Section.appSelectedSubtitle"),i=n.t("Common.learnMore")):(r=e.user.fullName,o=n.t("ModelDrivenApps.DataverseSecurityRoles.Section.userSelectedSubtitle"),i=n.t("Common.learnMore"));return a.createElement("div",null,a.createElement("p",{className:"cds-roles-section-title"},r),a.createElement("p",{className:"cds-roles-section-subtitle"},o,a.createElement("span",{className:"learn-more-link",onClick:()=>{window.open("https://docs.microsoft.com/powerapps/maker/model-driven-apps/share-model-driven-app","_blank","")},role:"link"},i)))}(g,h,e))),a.createElement("hr",null),a.createElement("div",{className:"data-permission-section"},a.createElement("div",{className:"permissions-section-resources"},n)))):(o+=" ".concat(d.cdsRolesSectionStyleClasses["cds-roles-section-centered"]),t=a.createElement("div",null,a.createElement("p",null,e.t("ModelDrivenApps.DataverseSecurityRoles.Section.noApp")),a.createElement("p",null,e.t("ModelDrivenApps.DataverseSecurityRoles.Section.noUsers"))));return a.createElement("div",{className:o},t)}))},5930:function(e,t,n){"use strict";n.r(t),n.d(t,"_CdsRolesDropdownInternal",(function(){return f})),n.d(t,"CdsRolesDropdown",(function(){return v}));var r=n(1083),o=n(5910),i=n(923),s=n(2812),a=n(1447),l=n(687),c=n(1090),u=n(1452),d=n(245),p=n.n(d),m=n(5931);var f=e=>{var t=[],n=[],i=Object(d.useRef)(null),f=Object(d.useRef)(null),v=e.isLoggedinUserCDSAdmin&&!Object(s.isEmpty)(e.cdsRolesAvailable)&&!e.isUserRoleLoading;if(v){var y=t=>t.map((t,n)=>{var r=e.entityRole&&e.entityRole.rolesAndSaveStatus.addedRoles.has(t.roleid);return{key:n+t.roleid,text:t.name,selected:r,data:{role:t}}});t=y(e.cdsRolesAvailable.filter(e=>e._roletemplateid_value)),n=y(e.cdsRolesAvailable.filter(e=>!e._roletemplateid_value))}var S=Object(d.useMemo)(()=>[{key:"Header",text:e.t("ModelDrivenApps.DataverseSecurityRoles.Dropdown.openManageRoles"),itemType:u.SelectableOptionMenuItemType.Header},{key:"divider",text:"-",itemType:u.SelectableOptionMenuItemType.Divider},{key:"SubHeader",text:e.t("ModelDrivenApps.DataverseSecurityRoles.Dropdown.subheader"),itemType:u.SelectableOptionMenuItemType.Header,styles:{optionText:m.cdsRoleDropdownStyleClasses.cdsRolesSubheaderOptionText}},...n.length>0?[{key:"HeaderSection1",text:e.t("ModelDrivenApps.DataverseSecurityRoles.Dropdown.customRoles"),itemType:u.SelectableOptionMenuItemType.Header}]:[],...n,{key:"HeaderSection2",text:e.t("ModelDrivenApps.DataverseSecurityRoles.Dropdown.standardRoles"),itemType:u.SelectableOptionMenuItemType.Header},...t],[n,t]);return p.a.createElement(a.ComboBox,{options:S,multiSelect:!0,placeholder:e.t("ModelDrivenApps.DataverseSecurityRoles.Dropdown.placeholder"),disabled:e.isUserRoleLoading||!e.isLoggedinUserCDSAdmin||!!e.userRoleLoadingError||e.entityRole.principleType===o.PrincipalType.Tenant||!v,ariaLabel:e.t("ModelDrivenApps.DataverseSecurityRoles.Dropdown.placeholder"),className:"user-permission-section-cds-roles",onRenderOption:(t,n)=>function(e,t,n,o,i){return e&&"Header"===e.key?p.a.createElement(c.Link,{className:m.cdsRoleDropdownStyleClasses.cdsRolesHeader,href:Object(r.getSecurityUsersUrl)(n),target:"_blank",tabIndex:0,onBlur:()=>function(e){e&&e.current.focus()}(i),componentRef:o},t&&t(e),p.a.createElement(l.Icon,{iconName:"OpenInNewWindow"})):e&&"SubHeader"===e.key?p.a.createElement("div",{className:m.cdsRoleDropdownStyleClasses.cdsRolesSubheader},t&&t(e)):t?t(e):p.a.createElement(p.a.Fragment,null)}(t,n,e.currentEnvironment,f,i),onItemClick:(t,n)=>function(e,t){var n=t.data;e.onSecurityRoleToggled(n.role.roleid)}(e,n),styles:{container:m.cdsRoleDropdownStyleClasses.cdsRolesComboBoxContainer,header:m.cdsRoleDropdownStyleClasses.cdsRolesHeaderCommon},onMenuOpen:()=>function(e){window.requestAnimationFrame(()=>{e.current&&e.current.focus()})}(f),componentRef:i})},v=Object(i.translateService)("PowerAppsPortalSharing")(f)},5931:function(e,t,n){"use strict";n.r(t),n.d(t,"cdsRoleDropdownStyleClasses",(function(){return s}));var r=n(3176),o=n(5932),i=n(719),s=Object(i.mergeStyleSets)({cdsRolesComboBoxContainer:{width:"270px"},cdsRolesHeader:{color:r.fabricTheme.palette.themeSecondary,display:"flex",alignItems:"center",fontSize:o.fontSizes.listFontSizeMedium,lineHeight:"20px",height:"100%",selectors:{"& i":{marginLeft:"4px",lineHeight:"18px"}}},cdsRolesSubheader:{color:"#605E5C",fontSize:o.fontSizes.listFontSizeSmall,lineHeight:"16px",maxWidth:"252px",marginTop:"8px"},cdsRolesHeaderCommon:{color:"#323130"},cdsRolesSubheaderOptionText:{whiteSpace:"unset"}})},5932:function(e,t,n){"use strict";n.r(t),n.d(t,"fonts",(function(){return r})),n.d(t,"fontSizes",(function(){return o}));var r={segoeUiSemibold:"wf_segoe-ui_semibold, 'Segoe UI Semibold', 'Segoe WP Semibold', 'Segoe UI', 'Segoe WP', Tahoma, Arial, sans-serif",segoeUiSemilight:"wf_segoe-ui_semilight,'Segoe UI Light','Segoe WP Light','Segoe UI','Segoe WP',Tahoma,Arial,sans-serif",segoeUi:"wf_segoe-ui, 'Segoe UI', Frutiger, 'Frutiger Linotype', 'Dejavu Sans', 'Helvetica Neue', 'Arial', sans-serif",sergoeUiBold:"wf_segoe-ui_bold, 'Segoe UI Bold', 'Segoe WP Bold', 'Segoe UI', 'Segoe WP', Tahoma, Arial, sans-serif"},o={listFontSizeXlarge:"18px",listFontSizeLarge:"15px",listFontSizeMedium:"14px",listFontSizeSmall:"12px",listIconSizeLarge:"36px",listIconSizeMedium:"30px",listIconSizeSmall:"16px"}},5933:function(e,t,n){"use strict";n.r(t),n.d(t,"cdsRolesSectionStyleClasses",(function(){return a}));var r=n(3176),o=n(5932),i=n(5934),s=n(719),a=Object(s.mergeStyleSets)({"cds-roles-section-centered":{width:"100%",display:"flex",justifyContent:"center",flexDirection:"column",textAlign:"center",selectors:{p:{marginBottom:"14px",fontFamily:o.fonts.segoeUi,fontSize:"14px",color:r.fabricTheme.palette.neutralSecondary}}},"cds-roles-section":{width:"100%",selectors:{".users-permission-header":{marginBottom:"16px"},".cds-roles-section-title":{fontFamily:o.fonts.segoeUiSemibold,color:r.fabricTheme.palette.neutralPrimary,marginTop:"8px",fontSize:"16px"},".cds-roles-section-subtitle":{fontFamily:o.fonts.segoeUi,color:r.fabricTheme.palette.neutralSecondary,marginTop:"8px",fontSize:"14px",selectors:{".learn-more-link":{cursor:"pointer",fontFamily:"Segoe UI",marginLeft:"2px",color:r.fabricTheme.palette.themeSecondary,fontSize:"14px"},".learn-more-link:hover":{textDecoration:"underline"}}},".permissions-section-resource .ba-ExpandableResourceItem":{display:"flex"},".ba-ExpandableResourceItem":{marginTop:"23px"},".ba-ExpandableResourceItem-value":{marginTop:"-10px",fontFamily:o.fonts.segoeUi,fontSize:"14px"},".ba-ExpandableResourceItem-icon":{borderRadius:"3px"},".cdsroles-error-prompt":{color:r.fabricTheme.palette.red},".ba-ExpandableResourceItem-section-right":{marginTop:"3px"},".cdsroles-generic-error":{marginTop:"8px",fontSize:o.fontSizes.listFontSizeSmall},hr:{borderWidth:"1px",borderColor:i.NeutralColors.gray20}}}})},5941:function(e,t,n){"use strict";n.r(t),n.d(t,"SelectionSection",(function(){return A}));var r=n(5910),o=n(5942),i=n(5945),s=n(923),a=n(1473),l=n(245),c=n(3076),u=n(3193),d=n(1071),p=n(217),m=n(5914),f=n(3830),v=n(5947),y=n(5948),S=n(5946);function b(e,t,n,r,o,i,s){try{var a=e[i](s),l=a.value}catch(c){return void n(c)}a.done?t(l):Promise.resolve(l).then(r,o)}function g(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function s(e){b(i,r,o,s,a,"next",e)}function a(e){b(i,r,o,s,a,"throw",e)}s(void 0)}))}}var h,O=Object(i.userSelectionPickerWithUserItemType)(),R=Object(o.userListWithUserItemType)();function j(e,t,n,r,o,i,s,a,l,c,u){if(t.length>0)switch(e){case h.App:r.setAllSelected(!1),o.setAllSelected(!1),c({key:t[0].user.objectId,user:t[0].user});break;case h.NewUsers:n.setAllSelected(!1),o.setAllSelected(!1),a({key:t[0].user.objectId,user:t[0].user});break;case h.ExistingUsers:r.setAllSelected(!1),n.setAllSelected(!1),i({key:t[0].user.objectId,user:t[0].user})}else e===h.App?u():e===h.NewUsers?l():e===h.ExistingUsers&&s()}function C(){return(C=g((function*(e,t,n,o,i){if(t){if(e.length>=120)throw new S.NormalizedUserSelectionError(S.NormalizedUserSelectionErrorType.InputTooLong,i("ModelDrivenApps.Share.knownErrors.FilterTextExceedsLimit"));o(Object(p.trackLoadScenario)(u.PortalTelemetryScope,"GetUsersAndGroups"));var s={searchTerm:e},{data:a,loading:l,errors:c}=yield t.query({query:v.AadUserAndGroupQuery,variables:s,fetchPolicy:"no-cache"});if(!l&&!c){var d=a&&a.searchUserAndGroup.length>0?a.searchUserAndGroup.map(e=>({fullName:e.displayName,objectId:e.oid,email:e.email,principalType:e.userType,groupType:e.groupType})):[];return f.featureGates.includeAppModelSharingGroups||(d=d.filter(e=>e.principalType===r.PrincipalType.User)),n&&n.complete(),d}!l&&c&&n&&n.failure({errors:c})}return[]}))).apply(this,arguments)}!function(e){e[e.App=0]="App",e[e.NewUsers=1]="NewUsers",e[e.ExistingUsers=2]="ExistingUsers"}(h||(h={}));var A=Object(d.withServices)(e=>{var{setExistingUserSelection:t,clearExistingUserSelectionSet:n,setNewUserSelection:o,clearNewUserSelectionSet:i,setAppRolesSelection:s,clearAppRolesSelectionSet:c}=l.useContext(m.AppModuleSharingSelectionContext),[u]=l.useState(new a.Selection({canSelectItem:e=>!0,onSelectionChanged:()=>{var e=u.getSelection();j(h.App,e,u,d,p,t,n,o,i,s,c)},selectionMode:a.SelectionMode.single})),[d]=l.useState(new a.Selection({canSelectItem:e=>!0,onSelectionChanged:()=>{var e=d.getSelection();j(h.NewUsers,e,u,d,p,t,n,o,i,s,c)},selectionMode:a.SelectionMode.single})),[p]=l.useState(new a.Selection({canSelectItem:e=>!0,onSelectionChanged:()=>{var e=p.getSelection();j(h.ExistingUsers,e,u,d,p,t,n,o,i,s,c)},selectionMode:a.SelectionMode.single})),[f,v]=l.useState();return l.createElement("div",{className:y.selectionSectionStyles.selectionSections},l.createElement("div",{className:y.selectionSectionStyles.userListSectionsContainer},l.createElement("div",{className:y.selectionSectionStyles.selectionSectionAppTitle},e.t("ModelDrivenApps.SelectionSection.app")),function(e,t){return e.appName?l.createElement(R,{title:"",users:[{fullName:e.appName,objectId:e.appId,azureactivedirectoryobjectid:"",email:"",principalType:r.PrincipalType.App,groupType:void 0}],shouldShowSorter:!1,automationId:e.newUsersSectionAutomationId,selectionMode:a.SelectionMode.single,ariaLabelForSelectionColumn:e.t("ModelDrivenApps.SelectionSection.ariaLabelForSelectionColumn"),ariaLabelRowCheckbox:e.t("ModelDrivenApps.SelectionSection.ariaLabelRowCheckbox"),setKey:"appList",selection:t}):l.createElement(l.Fragment,null)}(e,u)),l.createElement("div",{className:y.selectionSectionStyles.selectionSectionPeopleTitle},e.t("ModelDrivenApps.SelectionSection.people")),l.createElement("div",{className:y.selectionSectionStyles.userSelectionPickerContainer},l.createElement(O,{currentUsers:e.newUsers.concat(e.existingUsers),fetchUsersAndGroupsBasedOnFilterTextAsync:(t,n)=>function(e,t,n,r,o){return C.apply(this,arguments)}(t,e.environmentClient,f,v,e.t),onNewUserAdded:e.onNewUserAdded,isDisabled:e.isUserPickerDisabled,placeholderText:e.t("ModelDrivenApps.UserPicker.placeholderText"),selectionMode:a.SelectionMode.single})),l.createElement("div",{className:y.selectionSectionStyles.userListSectionsContainer},function(e,t){return e.newUsers&&e.newUsers.length>0?l.createElement(R,{title:e.t("ModelDrivenApps.SelectionSection.newUsers"),users:e.newUsers,shouldShowSorter:!1,automationId:e.newUsersSectionAutomationId,selectionMode:a.SelectionMode.single,ariaLabelForSelectionColumn:e.t("ModelDrivenApps.SelectionSection.ariaLabelForSelectionColumn"),ariaLabelRowCheckbox:e.t("ModelDrivenApps.SelectionSection.ariaLabelRowCheckbox"),setKey:"newUserList",selection:t,onRenderPersona:e.onRenderPersona,thumbnails:e.thumbnails}):l.createElement(l.Fragment,null)}(e,d),function(e,t){return l.createElement(R,{title:e.t("ModelDrivenApps.SelectionSection.existingUsers"),users:e.existingUsers,shouldShowSorter:!1,automationId:e.existingUsersSectionAutomationId,selectionMode:a.SelectionMode.single,ariaLabelForSelectionColumn:e.t("ModelDrivenApps.SelectionSection.ariaLabelForSelectionColumn"),ariaLabelRowCheckbox:e.t("ModelDrivenApps.SelectionSection.ariaLabelRowCheckbox"),setKey:"existingUserList",selection:t,isLoading:e.isExistingUsersLoading,onRenderPersona:e.onRenderPersona,thumbnails:e.thumbnails})}(e,p)))},[c.withApolloClient,Object(s.translateService)("PowerAppsPortalSharing")])},5947:function(e,t,n){"use strict";n.r(t),n.d(t,"AadUserAndGroupQuery",(function(){return a}));var r,o=n(3128);var i,s,a=n.n(o)()(r||(i=["\n  query AadUsersAndGroups($searchTerm: String!) {\n    searchUserAndGroup(searchTerm: $searchTerm) {\n      displayName\n      email\n      oid\n      userType\n      groupType\n    }\n  }\n"],s||(s=i.slice(0)),r=Object.freeze(Object.defineProperties(i,{raw:{value:Object.freeze(s)}}))))},5948:function(e,t,n){"use strict";n.r(t),n.d(t,"selectionSectionStyles",(function(){return s}));var r=n(3176),o=n(5932),i=n(719),s=Object(i.mergeStyleSets)({selectionSectionAppTitle:["SelectionSectionAppTitle",{paddingLeft:"16px",paddingRight:"16px",marginTop:"16px",marginBottom:"16px",fontFamily:o.fonts.segoeUiSemibold,fontSize:o.fontSizes.listFontSizeLarge,color:r.fabricTheme.palette.neutralPrimary}],selectionSectionPeopleTitle:["SelectionSectionPeopleTitle",{paddingLeft:"16px",paddingRight:"16px",marginBottom:"16px",fontFamily:o.fonts.segoeUiSemibold,fontSize:o.fontSizes.listFontSizeLarge,color:r.fabricTheme.palette.neutralPrimary}],selectionSections:["SelectionSection",{flex:"1 1 100%",display:"flex",flexDirection:"column",overflowY:"hidden"}],userSelectionPickerContainer:["SelectionSection-picker-container",{paddingLeft:"16px",paddingRight:"16px",paddingBottom:"16px"}],userListSectionsContainer:["SelectionSection-list-container",{overflowY:"auto",paddingBottom:"28px"}],userList:["SelectionSection-userList",{}]})},6487:function(e,t,n){"use strict";n.r(t);var r=n(6488);n.d(t,"RunObjectCheckerForComponentsGql",(function(){return r.RunObjectCheckerForComponentsGql})),n.d(t,"useRunObjectCheckerForComponents",(function(){return r.useRunObjectCheckerForComponents})),n.d(t,"getSolutionComponents",(function(){return r.getSolutionComponents})),n.d(t,"GetUseFixAllObjectCheckerProblemsGql",(function(){return r.GetUseFixAllObjectCheckerProblemsGql})),n.d(t,"GetUseFixObjectCheckerProblemGql",(function(){return r.GetUseFixObjectCheckerProblemGql})),n.d(t,"GetSolutionObjectCheckerResultsGql",(function(){return r.GetSolutionObjectCheckerResultsGql})),n.d(t,"useGetSolutionObjectCheckerResults",(function(){return r.useGetSolutionObjectCheckerResults})),n.d(t,"boolSettingMock",(function(){return r.boolSettingMock})),n.d(t,"stringSettingMock",(function(){return r.stringSettingMock})),n.d(t,"intSettingMock",(function(){return r.intSettingMock})),n.d(t,"booleanNotPresentAppOverrideMock",(function(){return r.booleanNotPresentAppOverrideMock})),n.d(t,"booleanAppOverrideMock",(function(){return r.booleanAppOverrideMock})),n.d(t,"GetSubComponentsGql",(function(){return r.GetSubComponentsGql})),n.d(t,"useGetSubComponent",(function(){return r.useGetSubComponent})),n.d(t,"useSolutionLayersQuery",(function(){return r.useSolutionLayersQuery})),n.d(t,"RemoveActiveLayer",(function(){return r.RemoveActiveLayer})),n.d(t,"solutionLayersRemoveQuery",(function(){return r.solutionLayersRemoveQuery})),n.d(t,"useSolutionSmartDiffQuery",(function(){return r.useSolutionSmartDiffQuery}));var o=n(6504);n.d(t,"StatusCodes",(function(){return o.StatusCodes})),n.d(t,"getComponentResultFromSolutionResults",(function(){return o.getComponentResultFromSolutionResults}))},6488:function(e,t,n){"use strict";n.r(t);var r=n(6489);n.d(t,"RunObjectCheckerForComponentsGql",(function(){return r.RunObjectCheckerForComponentsGql}));var o=n(6490);n.d(t,"useRunObjectCheckerForComponents",(function(){return o.useRunObjectCheckerForComponents})),n.d(t,"getSolutionComponents",(function(){return o.getSolutionComponents}));var i=n(6493);n.d(t,"GetUseFixAllObjectCheckerProblemsGql",(function(){return i.GetUseFixAllObjectCheckerProblemsGql}));var s=n(6494);n.d(t,"GetUseFixObjectCheckerProblemGql",(function(){return s.GetUseFixObjectCheckerProblemGql}));var a=n(6495);n.d(t,"GetSolutionObjectCheckerResultsGql",(function(){return a.GetSolutionObjectCheckerResultsGql}));var l=n(6496);n.d(t,"useGetSolutionObjectCheckerResults",(function(){return l.useGetSolutionObjectCheckerResults}));var c=n(6497);n.d(t,"boolSettingMock",(function(){return c.boolSettingMock})),n.d(t,"stringSettingMock",(function(){return c.stringSettingMock})),n.d(t,"intSettingMock",(function(){return c.intSettingMock})),n.d(t,"booleanNotPresentAppOverrideMock",(function(){return c.booleanNotPresentAppOverrideMock})),n.d(t,"booleanAppOverrideMock",(function(){return c.booleanAppOverrideMock}));var u=n(6500);n.d(t,"GetSubComponentsGql",(function(){return u.GetSubComponentsGql}));var d=n(6501);n.d(t,"useGetSubComponent",(function(){return d.useGetSubComponent}));var p=n(6502);n.d(t,"useSolutionLayersQuery",(function(){return p.useSolutionLayersQuery})),n.d(t,"RemoveActiveLayer",(function(){return p.RemoveActiveLayer})),n.d(t,"solutionLayersRemoveQuery",(function(){return p.solutionLayersRemoveQuery})),n.d(t,"useSolutionSmartDiffQuery",(function(){return p.useSolutionSmartDiffQuery}))},6489:function(e,t,n){"use strict";n.r(t),n.d(t,"RunObjectCheckerForComponentsGql",(function(){return a}));var r,o=n(3128);var i,s,a=n.n(o)()(r||(i=["\n  mutation runObjectCheckerForComponents($input: [ISolutionComponentInput!]!) {\n    runObjectCheckerForComponents(input: $input) {\n      msdyn_analysisjobid\n    }\n  }\n"],s||(s=i.slice(0)),r=Object.freeze(Object.defineProperties(i,{raw:{value:Object.freeze(s)}}))))},6490:function(e,t,n){"use strict";n.r(t),n.d(t,"useRunObjectCheckerForComponents",(function(){return c})),n.d(t,"getSolutionComponents",(function(){return u}));var r=n(3916),o=n(1146),i=n(6488),s=n(6491);function a(e,t,n,r,o,i,s){try{var a=e[i](s),l=a.value}catch(c){return void n(c)}a.done?t(l):Promise.resolve(l).then(r,o)}function l(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function s(e){a(i,r,o,s,l,"next",e)}function l(e){a(i,r,o,s,l,"throw",e)}s(void 0)}))}}function c(e,t){var n=null==t?void 0:t.split("/").pop(),a="https://graphql/graphql/environment/".concat(n),c=u(e),d=JSON.stringify({query:Object(s.print)(i.RunObjectCheckerForComponentsGql),variables:{input:c}}),{mutate:p,data:m,status:f,error:v}=Object(r.useMutation)(["useRunObjectCheckerForComponentsKey"],l((function*(){var e,t,n,r=yield o.default.post(a,d,{headers:{"Content-Type":"application/json"}});return(null==r||null===(e=r.data)||void 0===e||null===(t=e.data)||void 0===t||null===(n=t.runObjectCheckerForComponents)||void 0===n?void 0:n.msdyn_analysisjobid)||""})),{onError:e=>{console.log(e)}});return{mutate:()=>!(null==c||!c.length)&&p(),data:m,status:f,error:v}}function u(e){return(null==e?void 0:e.map(e=>null!=e&&e.component?{msdyn_componenttype:e.component.msdyn_componenttype,msdyn_primaryidattribute:e.component.msdyn_primaryidattribute,msdyn_componentlogicalname:e.component.msdyn_componentlogicalname,msdyn_objectid:e.component.msdyn_objectid}:null).filter(e=>!!e))||[]}},6493:function(e,t,n){"use strict";n.r(t),n.d(t,"GetUseFixAllObjectCheckerProblemsGql",(function(){return a}));var r,o=n(3128);var i,s,a=n.n(o)()(r||(i=["\n  mutation resolveAllObjectCheckerIssues($analysisResultIds: [String!]!) {\n    resolveAllObjectCheckerIssues(analysisResultIds: $analysisResultIds)\n  }\n"],s||(s=i.slice(0)),r=Object.freeze(Object.defineProperties(i,{raw:{value:Object.freeze(s)}}))))},6494:function(e,t,n){"use strict";n.r(t),n.d(t,"GetUseFixObjectCheckerProblemGql",(function(){return a}));var r,o=n(3128);var i,s,a=n.n(o)()(r||(i=["\n  mutation resolveObjectCheckerIssue($analysisResultId: String!) {\n    resolveObjectCheckerIssue(analysisResultId: $analysisResultId)\n  }\n"],s||(s=i.slice(0)),r=Object.freeze(Object.defineProperties(i,{raw:{value:Object.freeze(s)}}))))},6495:function(e,t,n){"use strict";n.r(t),n.d(t,"GetSolutionObjectCheckerResultsGql",(function(){return a}));var r,o=n(3128);var i,s,a=n.n(o)()(r||(i=["\n  query getSolutionObjectCheckerResults($solutionId: String!) {\n    getSolutionObjectCheckerResults(solutionId: $solutionId) {\n      componentId\n      enableRun\n      enableViewResults\n      result {\n        lastRun {\n          analysisComponentCreatedOn\n          analysisComponentId\n          analysisResultId\n          componentId\n          componentName\n          createdOn\n          customDetails\n          hasResolution\n          helpLink\n          message\n          messageArguments\n          modifiedOn\n          name\n          requestedByAadId\n          returnStatus\n          ruleReferenceUri\n          severity\n          solutionHealthMessage\n          stateCode\n          statusCode\n          jobId\n        }\n        lastSuccessfulRun {\n          analysisComponentCreatedOn\n          analysisComponentId\n          analysisResultId\n          componentId\n          componentName\n          createdOn\n          customDetails\n          hasResolution\n          helpLink\n          message\n          messageArguments\n          modifiedOn\n          name\n          requestedByAadId\n          returnStatus\n          ruleReferenceUri\n          severity\n          solutionHealthMessage\n          stateCode\n          statusCode\n          jobId\n        }\n      }\n      groupedResult {\n        analysisComponentCreatedOn\n        analysisComponentId\n        analysisResultId\n        componentId\n        componentName\n        createdOn\n        customDetails\n        hasResolution\n        helpLink\n        message\n        messageArguments\n        modifiedOn\n        name\n        requestedByAadId\n        returnStatus\n        ruleReferenceUri\n        severity\n        solutionHealthMessage\n        stateCode\n        statusCode\n        jobId\n      }\n    }\n  }\n"],s||(s=i.slice(0)),r=Object.freeze(Object.defineProperties(i,{raw:{value:Object.freeze(s)}}))))},6496:function(e,t,n){"use strict";n.r(t),n.d(t,"useGetSolutionObjectCheckerResults",(function(){return c}));var r=n(3916),o=n(1146),i=n(6488),s=n(6491);function a(e,t,n,r,o,i,s){try{var a=e[i](s),l=a.value}catch(c){return void n(c)}a.done?t(l):Promise.resolve(l).then(r,o)}function l(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function s(e){a(i,r,o,s,l,"next",e)}function l(e){a(i,r,o,s,l,"throw",e)}s(void 0)}))}}function c(e,t,n){var a=null==t?void 0:t.split("/").pop(),c="https://graphql/graphql/environment/".concat(a),u=JSON.stringify({query:Object(s.print)(i.GetSolutionObjectCheckerResultsGql),variables:{solutionId:e}});return Object(r.useQuery)(["useGetSolutionObjectCheckerResults",e,t],l((function*(){var e,t,n=yield o.default.post(c,u,{headers:{"Content-Type":"application/json"}});return(null==n||null===(e=n.data)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.getSolutionObjectCheckerResults)||[]})),n)}},6497:function(e,t,n){"use strict";n.r(t);var r=n(6498);n.d(t,"boolSettingMock",(function(){return r.boolSettingMock})),n.d(t,"stringSettingMock",(function(){return r.stringSettingMock})),n.d(t,"intSettingMock",(function(){return r.intSettingMock})),n.d(t,"booleanNotPresentAppOverrideMock",(function(){return r.booleanNotPresentAppOverrideMock})),n.d(t,"booleanAppOverrideMock",(function(){return r.booleanAppOverrideMock}))},6498:function(e,t,n){"use strict";n.r(t),n.d(t,"boolSettingMock",(function(){return a})),n.d(t,"stringSettingMock",(function(){return l})),n.d(t,"intSettingMock",(function(){return c})),n.d(t,"booleanNotPresentAppOverrideMock",(function(){return u})),n.d(t,"booleanAppOverrideMock",(function(){return d}));var r=n(6499);function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var a={id:"1",name:"AsynchronousSaveEvents",displayName:"Asynchronous save events",description:"Improves end-user experience by executing all save events in the app asynchronously",dataType:r.PowerSettingTypeCode.Boolean,defaultValue:"true",orgValue:"true",releaseLevel:r.ReleaseLevel.GenerallyAvailable,overridableLevel:r.OverridableLevel.OrgAndApp,isOverridable:!0,isDefinitionCustomizable:!0,isDefinitionPresentInSolution:!0,isHidden:!1,isManaged:!1,appOverrides:[],hasActiveCustomizations:!0,isPlatform:!0,informationUrl:"aka.ms/fakeUrl"},l={id:"2",name:"HighDensity",displayName:"App high density page header",description:"With high density page header, important information will always be visible when navigating on the page.",dataType:r.PowerSettingTypeCode.String,defaultValue:"Hello world",orgValue:"Hello world",releaseLevel:r.ReleaseLevel.Preview,overridableLevel:r.OverridableLevel.OrgOnly,isOverridable:!0,isDefinitionCustomizable:!0,isDefinitionPresentInSolution:!0,isHidden:!1,isManaged:!1,appOverrides:[],hasActiveCustomizations:!0,isPlatform:!0,informationUrl:"aka.ms/fakeUrl"},c={id:"2",name:"HighDensity",displayName:"App high density page header",description:"With high density page header, important information will always be visible when navigating on the page.",dataType:r.PowerSettingTypeCode.Integer,defaultValue:"0",orgValue:"1",releaseLevel:r.ReleaseLevel.Preview,overridableLevel:r.OverridableLevel.OrgOnly,isOverridable:!0,isDefinitionCustomizable:!0,isDefinitionPresentInSolution:!0,isHidden:!1,isManaged:!1,appOverrides:[],hasActiveCustomizations:!0,isPlatform:!0,informationUrl:"aka.ms/fakeUrl"},u={settingDefinitionId:"1",appId:"1",appDisplayName:"My App",appUniqueName:"MyApp",graphQLOnlyID:"Ignore this",areAllFieldsPresent:!0},d=i(i({},u),{},{appOverrideId:"appSetting-1",graphQLOnlyID:"appSetting-1",value:"true",publishedValue:"true",isCustomizable:!0})},6500:function(e,t,n){"use strict";n.r(t),n.d(t,"GetSubComponentsGql",(function(){return a}));var r,o=n(3128);var i,s,a=n.n(o)()(r||(i=["\n  query getSolutionSubComponents($subComponentId: String!, $componentType: String!) {\n    getSolutionSubComponents(subComponentId: $subComponentId, componentType: $componentType) {\n      msdyn_name\n      msdyn_displayname\n      msdyn_objectid\n      msdyn_componenttype\n      msdyn_componenttypename\n      msdyn_componentlogicalname\n      msdyn_solutionid\n      msdyn_ismanaged\n      msdyn_subtype\n      msdyn_objecttypecode\n      msdyn_version\n      msdyn_description\n    }\n  }\n"],s||(s=i.slice(0)),r=Object.freeze(Object.defineProperties(i,{raw:{value:Object.freeze(s)}}))))},6501:function(e,t,n){"use strict";n.r(t),n.d(t,"useGetSubComponent",(function(){return c}));var r=n(3916),o=n(1146),i=n(6488),s=n(6491);function a(e,t,n,r,o,i,s){try{var a=e[i](s),l=a.value}catch(c){return void n(c)}a.done?t(l):Promise.resolve(l).then(r,o)}function l(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function s(e){a(i,r,o,s,l,"next",e)}function l(e){a(i,r,o,s,l,"throw",e)}s(void 0)}))}}function c(e,t,n,a){var c=null==e?void 0:e.split("/").pop(),u="https://graphql/graphql/environment/".concat(c),d=JSON.stringify({query:Object(s.print)(i.GetSubComponentsGql),variables:{subComponentId:t,componentType:n}});return Object(r.useQuery)(["useGetSubComponent",e,t,n],l((function*(){var e,t,n=yield o.default.post(u,d,{headers:{"Content-Type":"application/json"}});return(null==n||null===(e=n.data)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.getSolutionSubComponents)||[]})),a)}},6502:function(e,t,n){"use strict";n.r(t),n.d(t,"useSolutionLayersQuery",(function(){return d})),n.d(t,"RemoveActiveLayer",(function(){return p})),n.d(t,"solutionLayersRemoveQuery",(function(){return m})),n.d(t,"useSolutionSmartDiffQuery",(function(){return v}));var r=n(217),o=n(245),i=n(3186),s=n(3192),a=n(3193),l=n(6503);function c(e,t,n,r,o,i,s){try{var a=e[i](s),l=a.value}catch(c){return void n(c)}a.done?t(l):Promise.resolve(l).then(r,o)}function u(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function s(e){c(i,r,o,s,a,"next",e)}function a(e){c(i,r,o,s,a,"throw",e)}s(void 0)}))}}function d(e,t,n,c){var d,p=a.TelemetryScenarioNames.solutionLayersGraphQl,[m,f]=Object(o.useState)(),[v,y]=Object(o.useState)(""),{loading:S,data:b,refetch:g}=Object(i.useQuery)(l.solutionLayersQuery,{client:e||void 0,fetchPolicy:"no-cache",onCompleted:e=>{m&&(m.complete({solutionLayersLength:e&&e.solutionComponentLayers&&e.solutionComponentLayers.length}),f(void 0)),y("")},onError:e=>{var t=Object(s.getResponseMessageFromApolloError)(e,c);y(t),m&&(m.failure({error:t,clientError:e&&e.message}),f(void 0))},variables:t});return Object(o.useEffect)(()=>{g&&g(t)},[]),Object(o.useEffect)(()=>{S&&f(Object(r.trackLoadScenario)(n,p))},[S]),{loading:S,errorMessage:v,setErrorMessage:y,solutionLayerList:b&&b.solutionComponentLayers,refetch:(d=u((function*(){yield g(t)})),function(){return d.apply(this,arguments)})}}var p="Remove Active Layer";function m(e,t){return f.apply(this,arguments)}function f(){return(f=u((function*(e,t){try{if(!e)throw new Error("Apollo client is undefined");var n=yield e.mutate({mutation:l.solutionLayersRemoveMutation,variables:t});if(n.errors)throw new Error(n.errors.join("\n"));if(n&&!n.data)throw new Error("form data not found.");return Object(r.trackInfoTrace)(p,{eventName:"removeActiveLayer",eventData:{success:"remove Active Layer"}}),{removeActiveCustomization:n.data.removeActiveCustomization}}catch(o){throw Object(r.trackErrorTrace)(p,{eventName:"removeActiveLayer",eventData:{error:o.message}}),o}}))).apply(this,arguments)}function v(e,t,n,c){var d,p=a.TelemetryScenarioNames.solutionSmartDiffGraphQl,[m,f]=Object(o.useState)(),[v,y]=Object(o.useState)(""),{loading:S,data:b,refetch:g}=Object(i.useQuery)(l.solutionComponentLayersDifferences,{client:e||void 0,fetchPolicy:"no-cache",onCompleted:e=>{m&&(m.complete({isOneLayer:e.solutionComponentLayersDifferences.isOneLayer}),f(void 0)),y("")},onError:e=>{var t=Object(s.getResponseMessageFromApolloError)(e,c);y(t),m&&(m.failure({error:t,clientError:e&&e.message}),f(void 0))},variables:t});return Object(o.useEffect)(()=>{g&&g(t)},[]),Object(o.useEffect)(()=>{S&&f(Object(r.trackLoadScenario)(n,p))},[S]),{loading:S,errorMessage:v,SolutionComponentLayersDiffResult:b&&b.solutionComponentLayersDifferences,refetch:(d=u((function*(){yield g(t)})),function(){return d.apply(this,arguments)})}}},6504:function(e,t,n){"use strict";n.r(t),n.d(t,"StatusCodes",(function(){return r})),n.d(t,"getComponentResultFromSolutionResults",(function(){return s}));var r,o=n(6505),i=n.n(o);!function(e){e[e.Pending=1]="Pending",e[e.Canceled=2]="Canceled",e[e.Running=19235e4]="Running",e[e.Complete=192350001]="Complete",e[e.Exception=192350002]="Exception",e[e.CompletedWithExceptions=192350003]="CompletedWithExceptions"}(r||(r={}));var s=(e,t,n)=>{var r,o,s,a,l=[],c=[],u={},d=[],p=!0;if(!t)return null;var m=t[0];!m||n&&0!==n.length||l.push(m.component.msdyn_objectid),n.forEach(e=>{var t,n;null!==(t=e.component)&&void 0!==t&&t.hasOwnProperty("msdyn_objectid")&&l.push(e.component.msdyn_objectid),null!==(n=e.component)&&void 0!==n&&n.hasOwnProperty("msdyn_componentlogicalname")&&c.push(e.component.msdyn_componentlogicalname)}),c.find(e=>{var t=["sitemap","appmodule"].includes(e);!0===p&&!1===t&&(p=!1)}),l.forEach(t=>{var n=i()(e,e=>e.componentId===t);n&&(d.push(n),n.componentId===(null==m?void 0:m.component.msdyn_objectid)&&(u=n),!0===p&&!1===n.enableRun&&(p=!1))});var f=1===(null==l?void 0:l.length)&&(null===(r=u)||void 0===r?void 0:r.enableViewResults);return{componentId:(null===(o=u)||void 0===o?void 0:o.componentId)||(null==m?void 0:m.component.msdyn_objectid),result:null===(s=u)||void 0===s?void 0:s.result,enableRun:p,enableViewResults:f,groupedResult:(null===(a=u)||void 0===a?void 0:a.groupedResult)||[]}}}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/154.2cae8060.chunk.js.map