/*! For license information please see 203.44c8f143.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[203],{6446:function(e,n,r){"use strict";r.r(n),r.d(n,"EnvironmentVariablePanelCommandEvents",(function(){return t}));var t={LearnEnvironmentVariableClicked:{eventName:"Solutions.Components.EnvironmentVariablePanel.LearnEnvironmentVariableClicked"},Load:{eventName:"Solutions.Components.EnvironmentVariablePanel.Load"}}},6519:function(e,n,r){"use strict";r.r(n),r.d(n,"PowerBIDashboardPanel",(function(){return f}));var t=r(4013),o=r(790),a=r(1201),i=r(245),l=r.n(i),s=r(6520),c=r(6521),u=r(6522),d=r(6523),p=r(6524),m=r(6537);function b(){return(b=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=r[t])}return e}).apply(this,arguments)}var f=Object(u.withTranslationService)(e=>{var{defaultPanelProps:n,solution:r,dashboardId:u,environmentVariablesLearnMoreLink:f,resources:{common:v,environmentVariable:P},getCDSClient:w,dispatch:y,environment:I,t:h}=e,[O,g]=Object(i.useState)(s.PowerBIPanelMode.Loading),[B,D]=Object(i.useState)(),[E,C]=Object(i.useState)(),[j,S]=Object(i.useState)(!0),[V,T]=Object(i.useState)(v.Loading.ellipses),[N,x]=Object(i.useState)(),[R,k]=Object(i.useState)(),[L,M]=Object(i.useState)(()=>()=>S(!1)),[G,U]=Object(i.useState)(),[A,F]=Object(i.useState)(),[_,q]=Object(i.useState)(()=>()=>S(!1)),[K,W]=Object(i.useState)(),[H,Q]=Object(i.useState)(s.PowerBIComponentType.Report),[X,z]=Object(i.useState)(),J={setOnNewEnvironmentVariable:q,setEnvironmentVariableToEdit:W,setComponentType:Q,setDefaultEnvironmentVariableName:z},Y="",$="";G&&G.field&&(G.type===s.PowerBIPanelMode.PowerBIDesigner?(Y=h("PowerBIDashboard.Panel.Callout.".concat(G.field)),$=s.CalloutLearnMoreLinks[G.field]):G.type===s.PowerBIPanelMode.EnvironmentVariableDesigner&&(Y=P.Panel[G.field].calloutText));var Z=Object(i.useMemo)(()=>({title:h("PowerBIDashboard.Panel.ConfirmationDialog.title"),subtext:h("PowerBIDashboard.Panel.ConfirmationDialog.subtext"),confirmButtonText:h("PowerBIDashboard.Panel.ConfirmationDialog.confirmButtonText"),cancelButtonText:h("PowerBIDashboard.Panel.ConfirmationDialog.cancelButtonText")}),[]),ee={panelMode:O,setPanelMode:g,setHeaderLeftButtonProps:D,setHeaderText:C,isLoading:j,setIsLoading:S,setLoadingOverlayLabel:T,setShowDismissDialog:x,setSaveEnabled:k,setOnSave:M,setMessageBar:F},ne=Object(d.makeRenderLabel)(h("PowerBIDashboard.Panel.Callout.tooltip"),U);return O===s.PowerBIPanelMode.Loading&&g(s.PowerBIPanelMode.PowerBIDesigner),l.a.createElement(t.Panel,b({},n,{headerText:E},B&&{headerLeftButtonProps:B},V&&{loadingOverlay:{spinnerProps:{size:a.SpinnerSize.large,label:V}}},{onDismiss:y.panelClose,showDismissDialog:N,dismissDialog:Z,messageBar:A,footerButtons:[{primary:!0,ariaLabel:v.Save.save,text:v.Save.save,disabled:!R,dismissableOnClick:L},{ariaLabel:v.Save.cancel,text:v.Save.cancel,dismissableOnClick:()=>{O===s.PowerBIPanelMode.EnvironmentVariableDesigner?g(s.PowerBIPanelMode.PowerBIDesigner):y.panelClose()}}]}),l.a.createElement(p.PowerBIDashboardDesigner,{solution:r,dashboardId:u,panelMaintenance:ee,renderLabel:ne,setEnvironmentVariablePanelInput:J,getCDSClient:w,dispatch:y,environment:I,environmentVariablePanelResources:P}),l.a.createElement(m.PowerBIEnvironmentVariableDesigner,{solution:r,environmentVariableToEdit:K,environmentVariablesLearnMoreLink:f,componentType:H,defaultName:X,panelMaintenance:ee,renderLabel:ne,environmentVariablePanelResources:P,onNewEnvironmentVariable:_,dispatch:y,environment:I}),l.a.createElement(o.Callout,{className:c.powerbiPanelStyleClasses.fieldIconCallout,styles:c.powerbiPanelCalloutStyles,gapSpace:0,onDismiss:()=>U(void 0),role:"alertdialog",hidden:!G,setInitialFocus:!1,directionalHint:o.DirectionalHint.topCenter,target:G&&G.element&&G.element.current},Y,$&&l.a.createElement("span",{className:c.powerbiPanelStyleClasses.link,onClick:()=>{y.openNewTab($,s.PowerBIDashboardPanelCommandEvents.PowerBICalloutLearnMoreClicked.eventName+(G&&G.field))},role:"link"},h("PowerBIDashboard.Panel.Callout.learnMore"))))})},6520:function(e,n,r){"use strict";var t,o;r.r(n),r.d(n,"PowerBIPanelMode",(function(){return t})),r.d(n,"PowerBIComponentType",(function(){return o})),r.d(n,"DEBOUNCE_INTERVAL",(function(){return a})),r.d(n,"DISPLAY_NAME_MAX_LENGTH",(function(){return i})),r.d(n,"ENVIRONMENT_VARIABLE_NAME_FORMAT",(function(){return l})),r.d(n,"CREATE_IN_POWER_BI_DESKTOP_KEY",(function(){return s})),r.d(n,"PowerBIDashboardPanelCommandEvents",(function(){return c})),r.d(n,"CalloutLearnMoreLinks",(function(){return u})),function(e){e[e.Loading=0]="Loading",e[e.PowerBIDesigner=1]="PowerBIDesigner",e[e.EnvironmentVariableDesigner=2]="EnvironmentVariableDesigner"}(t||(t={})),function(e){e.Report="Report",e.Dashboard="Dashboard"}(o||(o={}));var a=10,i=100,l=/[^A-Z0-9_]+/gi,s="meow",c={PowerBIOpenGroupClicked:{eventName:"Solutions.Components.PowerBIDashboardPanel.PowerBIOpenGroupClicked"},PowerBIOpenComponentClicked:{eventName:"Solutions.Components.PowerBIDashboardPanel.PowerBIOpenComponentClicked"},PowerBICalloutLearnMoreClicked:{eventName:"Solutions.Components.PowerBIDashboardPanel.PowerBICalloutLearnMoreClicked."}},u={ComponentType:"https://docs.microsoft.com/powerapps/maker/model-driven-apps/create-edit-powerbi-embedded-page",UseEnvironmentVariable:"https://docs.microsoft.com/powerapps/maker/model-driven-apps/create-edit-powerbi-embedded-page#create-power-bi-embedded-page-with-an-environment-variable"}},6521:function(e,n,r){"use strict";r.r(n),r.d(n,"powerbiPanelStyleClasses",(function(){return a})),r.d(n,"powerbiPanelCalloutStyles",(function(){return i})),r.d(n,"powerbiPanelDropdownStyles",(function(){return l})),r.d(n,"currentValueMessageBarStyle",(function(){return s}));var t=r(3176),o=r(3328),a=Object(o.mergeStyleSets)({fieldHeader:["powerbi-dashboard-section-header",{display:"inline-block",marginTop:"8px",selectors:{label:{fontWeight:"600",display:"inline-block",marginBottom:"5px",maxWidth:"100%",paddingTop:"5px"}}}],fieldCheckBox:["poewrbi-dashboard-checkbox",{selectors:{"label div:first-of-type":{marginTop:"6px"}}}],fieldIcon:["powerbi-dashboard-icon",{paddingLeft:"2px"}],fieldIconCallout:["environment-variable-icon-callout",{width:"330px",minHeight:"50px"}],fieldRequired:["powerbi-dashboard-required",{color:"#A8262C",paddingLeft:"4px"}],currentValueFieldHeader:{marginTop:"20px",borderTop:"1px solid ".concat(t.fabricTheme&&t.fabricTheme.palette&&t.fabricTheme.palette.neutralLight||"#f4f4f4")},dropdownContainer:["powerbi-dashboard-dropdown-container",{display:"flex",flexDirection:"row",selectors:{div:{minWidth:"0px"}}}],dropdownContainerButton:{flex:"0 0 auto",alignSelf:"flex-end"},dropdownOptionIcon:{color:t.fabricTheme&&t.fabricTheme.palette&&t.fabricTheme.palette.themePrimary||"#742774",margin:"7px 8px 7px 4px",lineHeight:"18px"},dropdownOptionText:{lineHeight:"32px",verticalAlign:"top",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipse"},dropdownOptionNewEnvironmentVariableText:{lineHeight:"32px",verticalAlign:"top"},link:{cursor:"pointer",fontFamily:"Segoe UI",marginLeft:"2px",color:t.fabricTheme&&t.fabricTheme.palette&&t.fabricTheme.palette.themePrimary||"#742774",fontSize:"14px",selectors:{"&:hover":{textDecoration:"underline"}}}}),i={root:{borderRadius:"2px",padding:"5px"}},l={title:{borderRadius:"2px",border:"1px solid #c8c8c8",boxSizing:"border-box"},label:{fontWeight:"normal"},root:{flex:"1 1 auto"}},s={root:{marginTop:"8px"}}},6522:function(e,n,r){"use strict";r.r(n),r.d(n,"withTranslationService",(function(){return o}));var t=r(922);function o(e){return Object(t.translateService)("PowerAppsPowerBIDashboardPanel")(e)}},6523:function(e,n,r){"use strict";r.r(n),r.d(n,"makeRenderLabel",(function(){return c})),r.d(n,"renderDropdownOptionWithIcon",(function(){return u}));var t=r(684),o=r(687),a=r(245),i=r.n(a),l=r(2844),s=r(6521);function c(e,n){return(r,o,a,c)=>({ariaLabel:r,onRenderLabel:()=>i.a.createElement("div",{className:s.powerbiPanelStyleClasses.fieldHeader},i.a.createElement("label",{id:c},r),o&&i.a.createElement("span",{className:s.powerbiPanelStyleClasses.fieldRequired},"*"),a&&i.a.createElement("span",{className:s.powerbiPanelStyleClasses.fieldIcon,ref:a.element},i.a.createElement(t.IconButton,{iconProps:{iconName:l.fabricIcons.Info},title:e,ariaLabel:e,onClick:()=>n(a)})))})}function u(e){if(!e)return i.a.createElement("div",null);var n=e.data&&e.data.className||s.powerbiPanelStyleClasses.dropdownOptionText;return i.a.createElement("div",null,e.data&&e.data.icon&&i.a.createElement(o.Icon,{className:s.powerbiPanelStyleClasses.dropdownOptionIcon,iconName:e.data.icon,"aria-hidden":"true",title:e.data.icon}),i.a.createElement("span",{className:n},e.text))}},6524:function(e,n,r){"use strict";r.r(n),r.d(n,"PowerBIDashboardDesigner",(function(){return N}));var t,o=r(1368),a=r(1697),i=r(545),l=r(245),s=r.n(l),c=r(5127),u=r(5148),d=r(3076),p=r(2844),m=r(6525),b=r(5916),f=r(6527),v=r(6531),P=r(6520),w=r(6521),y=r(6532),I=r(6528),h=r(6522),O=r(6523),g=r(6533),B=r(6534),D=r(6535),E=r(6536);function C(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,t)}return r}function j(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?C(Object(r),!0).forEach((function(n){S(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):C(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function S(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function V(e,n,r,t,o,a,i){try{var l=e[a](i),s=l.value}catch(c){return void r(c)}l.done?n(s):Promise.resolve(s).then(t,o)}function T(e){return function(){var n=this,r=arguments;return new Promise((function(t,o){var a=e.apply(n,r);function i(e){V(a,t,o,i,l,"next",e)}function l(e){V(a,t,o,i,l,"throw",e)}i(void 0)}))}}!function(e){e.DisplayName="DisplayName",e.Group="Group",e.UseEnvironmentVariable="UseEnvironmentVariable",e.EnvironmentVariable="EnvironmentVariable",e.ComponentType="ComponentType",e.Component="Component"}(t||(t={}));var N=Object(h.withTranslationService)(Object(d.withApolloClient)(e=>{var{environmentClient:n,genericClient:r,solution:d,dashboardId:h,panelMaintenance:{panelMode:C,setPanelMode:S,setHeaderText:V,setHeaderLeftButtonProps:N,setOnSave:x,setSaveEnabled:R,setLoadingOverlayLabel:k,setShowDismissDialog:L,setMessageBar:M},renderLabel:G,setEnvironmentVariablePanelInput:{setOnNewEnvironmentVariable:U,setEnvironmentVariableToEdit:A,setComponentType:F,setDefaultEnvironmentVariableName:_},getCDSClient:q,dispatch:K,environment:W,environmentVariablePanelResources:H,t:Q}=e,[X,z]=Object(l.useState)(),[J,Y]=Object(l.useState)(),[$,Z]=Object(l.useState)(),[ee,ne]=Object(l.useState)(P.PowerBIComponentType.Report),[re,te]=Object(l.useState)(),oe=Object(l.useMemo)(()=>Object(i.getId)(t.ComponentType),[]),{groups:ae,dashboards:ie,reports:le,errorMessage:se}=Object(m.usePowerBIMetadataQuery)(n||r,$,ee!==P.PowerBIComponentType.Dashboard,ee!==P.PowerBIComponentType.Report,Q("PowerBIDashboard.Request.Failed"),Q("PowerBIDashboard.Request.GroupsNotEnabled")),ce=ee===P.PowerBIComponentType.Report?le:ie,ue=Object(y.getEmbedUrl)($,ce,re),[de,pe]=Object(l.useState)(),[me,be]=Object(l.useState)(),[fe,ve]=Object(l.useState)({[P.PowerBIComponentType.Dashboard]:[],[P.PowerBIComponentType.Report]:[]}),Pe=fe[ee],[we,ye]=Object(l.useState)(),Ie=me&&we&&we[me],he=function(){var e=T((function*(e){if(pe(e),e&&!we){var{reportOptions:n,dashboardOptions:r,descriptors:t}=yield Object(v.retrieveEnvironmentVariables)(q),o={key:"",text:Q("PowerBIDashboard.Panel.newEnvironmentVariable"),data:{icon:p.fabricIcons.Add,className:w.powerbiPanelStyleClasses.dropdownOptionNewEnvironmentVariableText}};ve({[P.PowerBIComponentType.Dashboard]:[o,...Object(y.sortDropdownOptions)(r)],[P.PowerBIComponentType.Report]:[o,...Object(y.sortDropdownOptions)(n)]}),ye(t)}}));return function(n){return e.apply(this,arguments)}}(),Oe=e=>{F(e),be(void 0),te(void 0),ne(e)},[ge,Be]=Object(l.useState)(!!h),[De,Ee]=Object(l.useState)(),[Ce,je]=Object(l.useState)();Object(l.useMemo)(T((function*(){if(h){var e=yield Object(f.retrievePowerBIDashboard)(h,Object(I.getSolutionId)(d),q);e&&(z(e.name),Oe(e.componentType),Ee(e.formXml),je(e.embedUrl),e.environmentVariable?(yield he(!0),be(e.environmentVariable)):(Z(e.groupId),te(e.componentId))),Be(!1)}})),[h]);var Se,[Ve,Te,Ne]=Object(l.useMemo)(()=>Object(y.makeCallouts)(P.PowerBIPanelMode.PowerBIDesigner,t.ComponentType,t.UseEnvironmentVariable,t.Group),[]);if(Object(l.useMemo)(()=>{C===P.PowerBIPanelMode.PowerBIDesigner&&(V(Q(h?"PowerBIDashboard.Panel.editTitle":"PowerBIDashboard.Panel.createTitle")),N(()=>{}),U(()=>e=>{var{name:n,displayName:r}=e,t=fe,o=!1;for(var a of t[e.defaultValue.component.type])if(a.key===n){o=!0,a.text=r;break}if(!o){t={[P.PowerBIComponentType.Dashboard]:[...fe[P.PowerBIComponentType.Dashboard]],[P.PowerBIComponentType.Report]:[...fe[P.PowerBIComponentType.Report]]};var i=e.defaultValue.component.type;t[i].push({key:n,text:r}),t[i]=Object(y.sortDropdownOptions)(t[i],"")}ve(t),ye(j(j({},we),{},{[n]:e})),be(n)}))},[C,fe]),Object(l.useMemo)(()=>C===P.PowerBIPanelMode.PowerBIDesigner&&x(()=>T((function*(){k(Q(h?"PowerBIDashboard.Panel.editInProgress":"PowerBIDashboard.Panel.createInProgress"));var e={name:X,groupId:de?void 0:$,componentId:de?void 0:re,environmentVariable:de?me:void 0,componentType:ee,embedUrl:de?Ie&&Ie.defaultValue&&Ie.defaultValue.component.embedUrl:ue||Ce};try{h?(e.formXml=De,yield Object(f.editPowerBIDashboard)(d,h,e,q)):yield Object(f.createPowerBIDashboard)(d,e,q),K.fetchSolutionComponentsRequest({solutionId:Object(I.getSolutionId)(d)}),K.panelClose()}catch(n){k(void 0),M({messageBarProps:{messageBarType:a.MessageBarType.error},onRenderBody:()=>Object(b.parseMessageFromError)(n)||Q("PowerBIDashboard.Request.Failed")})}}))),[X,$,re,me,ee,ue,C]),Object(l.useMemo)(()=>{ae&&!ge&&k(void 0),se&&se.length>0&&!ge?(k(void 0),M({messageBarProps:{messageBarType:a.MessageBarType.error},onRenderBody:()=>s.a.createElement("div",{dangerouslySetInnerHTML:{__html:se}})})):M(void 0)},[ge,!!ae,se]),!ge&&C===P.PowerBIPanelMode.PowerBIDesigner){var xe=h&&!ge,Re=!!re,ke=!!me,Le=!!(de?Ie&&Ie.defaultValue.component.embedUrl:ue||Ce);R(!!((J||xe&&void 0===J)&&Le&&(!de&&Re||de&&ke)));var Me=(e,n)=>{if(L(!0),function(e,n){return e===t.UseEnvironmentVariable}(e))he(n);else switch(e){case t.DisplayName:z(n);break;case t.Group:Z(n),te(void 0);break;case t.Component:Object(y.handleCreateInPowerBIDesktopOption)(W,n,te);break;case t.ComponentType:Oe(n);break;case t.EnvironmentVariable:""===n?(A(void 0),_(X),S(P.PowerBIPanelMode.EnvironmentVariableDesigner)):be(n)}},Ge=Object(y.makeMakeValidators)(Q("PowerBIDashboard.Error.required"),(e,n)=>{e===t.DisplayName&&Y(!n)});return s.a.createElement(c.Form,{key:"PowerBI",onUpdated:Me,showErrorsWhenPristine:!1},s.a.createElement(c.FormTextInput,{inputKey:t.DisplayName,textFieldProps:j({},G(Q("PowerBIDashboard.Panel.displayName"),!0)),validators:Ge(t.DisplayName,u.maxLength(P.DISPLAY_NAME_MAX_LENGTH,()=>Q("PowerBIDashboard.Error.maxLength"))),debounceInterval:P.DEBOUNCE_INTERVAL,value:X}),G(Q("PowerBIDashboard.Panel.componentType"),!0,Ve,oe).onRenderLabel(),s.a.createElement(o.ChoiceGroup,{ariaLabelledBy:oe,options:[{key:P.PowerBIComponentType.Report,text:Q("PowerBIDashboard.Panel.report")},{key:P.PowerBIComponentType.Dashboard,text:Q("PowerBIDashboard.Panel.dashboard")}],onChange:(e,n)=>Me(t.ComponentType,n&&n.key),defaultSelectedKey:ee}),s.a.createElement(c.FormCheckBox,{inputKey:t.UseEnvironmentVariable,checkboxProps:j({className:w.powerbiPanelStyleClasses.fieldCheckBox},G(Q("PowerBIDashboard.Panel.useEnvironmentVariable"),!1,Te)),value:de}),de&&s.a.createElement("div",null,s.a.createElement(B.FormDropdownWithIconButtons,{inputKey:t.EnvironmentVariable,dropdownProps:j(j({placeholder:Q("PowerBIDashboard.Panel.placeholder"),options:Pe,selectedKey:me,defaultSelectedKey:me},G(Q("PowerBIDashboard.Panel.environmentVariable"),!1)),{},{onRenderOption:O.renderDropdownOptionWithIcon,styles:w.powerbiPanelDropdownStyles}),buttonProps:[{disabled:!Ie,iconProps:{iconName:p.fabricIcons.Edit},onClick:(Se=T((function*(){var e=Ie,{id:n,currentValue:r,currentValueId:t,name:o}=e;if(!n||r&&!t){var a=yield Object(v.retrieveEnvironmentVariable)(o,q);a&&(e=a,ye(j(j({},we),{},{[o]:a})))}A(e),S(P.PowerBIPanelMode.EnvironmentVariableDesigner)})),function(){return Se.apply(this,arguments)})}]}),Ie&&s.a.createElement("div",null,G(Q("PowerBIDashboard.Panel.defaultGroupValue"),!1).onRenderLabel(),s.a.createElement("div",null,s.a.createElement("span",null,Ie.defaultValue.group.name)),G(Q("PowerBIDashboard.Panel.default".concat(ee,"Value")),!1).onRenderLabel(),s.a.createElement("div",null,s.a.createElement("span",null,Ie.defaultValue.component.name)),Ie.currentValue&&Ie.currentValue.group&&Ie.currentValue.group.id&&Ie.currentValue.component&&Ie.currentValue.component.id&&s.a.createElement("div",{className:w.powerbiPanelStyleClasses.currentValueFieldHeader},G(Q("PowerBIDashboard.Panel.currentGroupValue"),!1).onRenderLabel(),s.a.createElement("div",null,s.a.createElement("span",null,Ie.currentValue.group.name)),G(Q("PowerBIDashboard.Panel.current".concat(ee,"Value")),!1).onRenderLabel(),s.a.createElement("div",null,s.a.createElement("span",null,Ie.currentValue.component.name)),s.a.createElement(g.CurrentValueMessageBar,{environmentVariablePanelResources:H})))),!de&&s.a.createElement("div",null,s.a.createElement(E.PowerBIGroupDropdown,{field:t.Group,label:Q("PowerBIDashboard.Panel.group"),groupId:$,embedUrl:ue,options:ae,callout:Ne,renderLabel:G,dispatch:K}),s.a.createElement(D.PowerBIComponentDropdown,{field:t.Component,label:Q("PowerBIDashboard.Panel.".concat(ee.toLowerCase())),groupId:$,componentType:ee,componentId:re,options:ce,validators:Ge(t.Component),renderLabel:G,dispatch:K})))}return null}))},6525:function(e,n,r){"use strict";r.r(n),r.d(n,"usePowerBIMetadataQuery",(function(){return l}));var t=r(245),o=r(3152),a=r(6526),i=r(3192);function l(e,n,r,l,u,d){var[p,m]=Object(t.useState)(),[b,f]=Object(t.useState)(),[v,P]=Object(t.useState)({}),[w,y]=Object(t.useState)({}),{loading:I}=Object(o.useQuery)(a.GetGroupQuery,{client:e,onCompleted:e=>{if(e&&e.getWorkspaces){var n=c(e.getWorkspaces.map(e=>({key:e.id,text:e.name})));f(n),m(void 0)}},onError:e=>{var n=Object(i.getResponseMessageFromApolloError)(e,u);m(n)}});return Object(o.useQuery)(a.GetDashboardQuery,{skip:!n||r,variables:{groupId:n},client:e,onCompleted:e=>{if(e&&e.getDashboardInGroups){var r=s(n,v,e.getDashboardInGroups,e=>e.displayName);P(r),m(void 0)}},onError:e=>{var r=s(n,{groupId:{embedUrls:{},options:[]}},[],e=>e.displayName);P(r),m(Object(i.getResponseMessageFromApolloError)(e,u))}}),Object(o.useQuery)(a.GetReportQuery,{skip:!n||l,variables:{groupId:n},client:e,onCompleted:e=>{if(e&&e.getReportsInGroup){var r=s(n,w,e.getReportsInGroup,e=>e.name);y(r),m(void 0)}},onError:e=>{"GroupsNotEnabled"===e.graphQLErrors[0].message?m(d):m(u);var r=s(n,{groupId:{embedUrls:{},options:[]}},[],e=>e.name);y(r)}}),{groups:b,dashboards:v,reports:w,errorMessage:p,loading:I}}function s(e,n,r,t){var o=Object.assign({},n,{[e]:{options:[],embedUrls:{}}});for(var a of r)a.embedUrl&&(o[e].options.push({key:a.id,text:t(a)}),o[e].embedUrls[a.id]=a.embedUrl);return o[e].options=c(o[e].options),o}function c(e){return e.sort((e,n)=>{var r=(e.text||"").toLowerCase(),t=(n.text||"").toLowerCase();return r>t?1:r<t?-1:0})}},6526:function(e,n,r){"use strict";r.r(n),r.d(n,"PowerBIGroupFragment",(function(){return p})),r.d(n,"GetGroupQuery",(function(){return m})),r.d(n,"PowerBIDashboardFragment",(function(){return b})),r.d(n,"GetDashboardQuery",(function(){return f})),r.d(n,"PowerBIReportFragment",(function(){return v})),r.d(n,"GetReportQuery",(function(){return P}));var t,o,a,i,l,s,c=r(3128),u=r.n(c);function d(e,n){return n||(n=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(n)}}))}var p=u()(t||(t=d(["\n  fragment PowerBIGroupDataFields on PowerBIGroup {\n    id\n    isReadOnly\n    isOnDedicatedCapacity\n    name\n    dataflowStorageId\n  }\n"]))),m=u()(o||(o=d(["\n  query GetPowerBIGroups {\n    getWorkspaces {\n      ...PowerBIGroupDataFields\n    }\n  }\n  ","\n"])),p),b=u()(a||(a=d(["\n  fragment PowerBIDashboardDataFields on PowerBIDashboard {\n    id\n    displayName\n    embedUrl\n    isReadOnly\n  }\n"]))),f=u()(i||(i=d(["\n  query GetPowerBIDashboards($groupId: String!) {\n    getDashboardInGroups(groupId: $groupId) {\n      ...PowerBIDashboardDataFields\n    }\n  }\n  ","\n"])),b),v=u()(l||(l=d(["\n  fragment PowerBIReportDataFields on PowerBIReportsInGroup {\n    datasetId\n    id\n    name\n    webUrl\n    embedUrl\n  }\n"]))),P=u()(s||(s=d(["\n  query GetPowerBIReports($groupId: String!) {\n    getReportsInGroup(groupId: $groupId) {\n      ...PowerBIReportDataFields\n    }\n  }\n  ","\n"])),v)},6527:function(e,n,r){"use strict";r.r(n),r.d(n,"retrievePowerBIDashboard",(function(){return u})),r.d(n,"createPowerBIDashboard",(function(){return m})),r.d(n,"editPowerBIDashboard",(function(){return f}));var t=r(2830),o=r(6033),a=r(6216),i=r(6520),l=r(6528);function s(e,n,r,t,o,a,i){try{var l=e[a](i),s=l.value}catch(c){return void r(c)}l.done?n(s):Promise.resolve(s).then(t,o)}function c(e){return function(){var n=this,r=arguments;return new Promise((function(t,o){var a=e.apply(n,r);function i(e){s(a,t,o,i,l,"next",e)}function l(e){s(a,t,o,i,l,"throw",e)}i(void 0)}))}}function u(e,n,r){return d.apply(this,arguments)}function d(){return(d=c((function*(e,n,r){var t=r(),o=yield t.fetchView("Form",a.StdViews.Get,{id:e,solutionId:n});return o&&o.name&&o.formxml&&p(o.name,o.formxml)||null}))).apply(this,arguments)}function p(e,n){var r=(new DOMParser).parseFromString(n,"text/xml").querySelector("form tabs tab columns column sections section rows row cell control parameters");if(r){for(var t={name:e,formXml:n},o=0;o<r.childNodes.length;o++){var a=r.childNodes[o],l=a.textContent||"";switch(a.nodeName){case"PowerBIGroupId":Object.assign(t,O(l,"groupId"));break;case"PowerBIDashboardId":t.componentType=i.PowerBIComponentType.Dashboard,Object.assign(t,O(l,"componentId"));break;case"PowerBIReportId":t.componentType=i.PowerBIComponentType.Report,Object.assign(t,O(l,"componentId"));break;case"TileUrl":t.embedUrl=l}}return t}return null}function m(e,n,r){return b.apply(this,arguments)}function b(){return(b=c((function*(e,n,r){return n.formXml='<form>\n  <tabs>\n  <tab showlabel="false" verticallayout="true" id="{'.concat(Object(o.getNewGuid)(),'}">\n    <columns>\n    <column width="100%">\n      <sections>\n      <section showlabel="false" showbar="false" columns="111" id="{').concat(Object(o.getNewGuid)(),'}">\n        <rows>\n        <row>\n          <cell colspan="3" rowspan="24" showlabel="false" id="{').concat(Object(o.getNewGuid)(),'}" availableforphone="false">\n          <labels />\n          <control id="').concat(Object(o.getNewGuid)(),'" classid="{8C54228C-1B25-4909-A12A-F2B968BB0D62}">\n            <parameters>\n            </parameters>\n          </control>\n          </cell>\n        </row>\n        </rows>\n      </section>\n      </sections>\n    </column>\n    </columns>\n  </tab>\n  </tabs>\n  </form>'),P("Create",e,void 0,n,r)}))).apply(this,arguments)}function f(e,n,r,t){return v.apply(this,arguments)}function v(){return(v=c((function*(e,n,r,t){return P("Update",e,n,r,t)}))).apply(this,arguments)}function P(e,n,r,t,o){return w.apply(this,arguments)}function w(){return(w=c((function*(e,n,r,o,a){for(var s="PowerBI".concat(o.componentType,"Id"),c=o.componentType===i.PowerBIComponentType.Report?"2":"1",u=o.groupId||h(o.environmentVariable,"group.id"),d=o.componentId||h(o.environmentVariable,"component.id"),p=I(o.embedUrl,u,o.componentType,d),m=(new DOMParser).parseFromString(o.formXml,"text/xml"),b=m.querySelector("form tabs tab columns column sections section rows row cell control parameters");b.hasChildNodes&&b.lastChild;)b.lastChild.remove();y(m,b,["PowerBIGroupId",u],[s,d],["TileUrl",p],["Type",c]);var f=(new XMLSerializer).serializeToString(m),v=a();return yield v.executeAction("Form",e,{solutionName:Object(l.getSolutionName)(n)},{formid:r,name:o.name,type:t.FormType.PowerBIDashboard,formxml:f})}))).apply(this,arguments)}function y(e,n){for(var r=arguments.length,t=new Array(r>2?r-2:0),o=2;o<r;o++)t[o-2]=arguments[o];for(var[a,i]of t){var l=e.createElement(a);l.textContent=i,n.appendChild(l)}}function I(e,n,r,t){var o="".concat(r.toLowerCase(),"Id"),a=new URL(e);a.searchParams.delete("groupId"),a.searchParams.delete(o);var i=a.searchParams.toString()?"&":"?";return"".concat(a.toString()).concat(i,"groupId=").concat(n,"&").concat(o,"=").concat(t)}function h(e,n){return"{EV:".concat(e,".").concat(n,"}")}function O(e,n){var r=e.indexOf("{EV:");if(-1!==r){var t=e.indexOf("}",r);if(-1!==t){var o=e.indexOf(".",r);return-1!==o&&o<t&&(t=o),{environmentVariable:e.substring(r+"{EV:".length,t)}}}return{[n]:e}}},6528:function(e,n,r){"use strict";r.r(n),r.d(n,"getSolutionId",(function(){return o})),r.d(n,"getSolutionName",(function(){return a})),r.d(n,"getSolutionResourceNamePrefix",(function(){return i})),r.d(n,"downloadPBIDS",(function(){return l})),r.d(n,"toEnvironmentVariablePanelSolution",(function(){return s}));var t=r(6529);function o(e){return e&&e.id||""}function a(e){return e&&e.uniquename||""}function i(e){return(e&&e.publisherid&&e.publisherid.customizationprefix)+"_"||!1}function l(e){var n=new URL(e.instanceUrl).hostname;Object(t.triggerDirectQueryPBIDSFileDownload)(e.uniqueName,n)}function s(e){return e&&{id:e.id,resourceNamePrefix:i(e),name:e.uniquename}}},6531:function(e,n,r){"use strict";r.r(n),r.d(n,"retrieveEnvironmentVariable",(function(){return l})),r.d(n,"retrieveEnvironmentVariables",(function(){return c}));var t=r(2830),o=r(6520);function a(e,n,r,t,o,a,i){try{var l=e[a](i),s=l.value}catch(c){return void r(c)}l.done?n(s):Promise.resolve(s).then(t,o)}function i(e){return function(){var n=this,r=arguments;return new Promise((function(t,o){var i=e.apply(n,r);function l(e){a(i,t,o,l,s,"next",e)}function s(e){a(i,t,o,l,s,"throw",e)}l(void 0)}))}}function l(e,n){return s.apply(this,arguments)}function s(){return(s=i((function*(e,n){var{descriptors:r}=yield d(n,'<condition attribute="schemaname" operator="eq" value="'.concat(e,'" />'));return r&&r[e]}))).apply(this,arguments)}function c(e){return u.apply(this,arguments)}function u(){return(u=i((function*(e){return yield d(e)}))).apply(this,arguments)}function d(e){return p.apply(this,arguments)}function p(){return(p=i((function*(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=e(),a=yield r.retrieveFetchXmlResults({EntitySetName:"environmentvariabledefinitions",fetchXml:'<fetch version="1.0" output-format="xml-platform" mapping="logical">\n<entity name="environmentvariabledefinition">\n    <attribute name="schemaname" />\n    <attribute name="displayname" />\n    <attribute name="defaultvalue" />\n    <attribute name="description" />\n    <attribute name="environmentvariabledefinitionid" />\n    <filter type="and">\n        <condition attribute="type" operator="eq" value="'.concat(t.EnvironmentVariableDefinitionTypeEnum.JSON,'" />\n        ').concat(n,"\n    </filter>\n</entity>\n</fetch>")}),i={},l=[],s=[];if(a&&a.value&&a.value.length>0){var c=yield m(r,a.value);for(var{schemaname:u,displayname:d,description:p,defaultvalue:b,environmentvariabledefinitionid:f}of a.value){var v=null;try{v=b&&JSON.parse(b)}catch(y){v=null}if(v&&v.group&&v.group.id&&v.group.name&&v.component&&v.component.id&&v.component.type&&v.component.embedUrl&&v.component.name){var P=c[f];i[u]={displayName:d,name:u,id:f,description:p,defaultValue:v,currentValue:P&&P.value,currentValueId:P&&P.id};var w=v.component.type===o.PowerBIComponentType.Report?l:s;w.push({key:u,text:d})}}}return{descriptors:i,reportOptions:l,dashboardOptions:s}}))).apply(this,arguments)}function m(e,n){return b.apply(this,arguments)}function b(){return(b=i((function*(e,n){var r=yield e.retrieveFetchXmlResults({EntitySetName:"environmentvariablevalues",fetchXml:'<fetch version="1.0" output-format="xml-platform" mapping="logical">\n<entity name="environmentvariablevalue">\n    <attribute name="environmentvariabledefinitionid" />\n    <attribute name="value" />\n    <attribute name="environmentvariablevalueid" />\n    <filter type="and">\n        <condition attribute="environmentvariabledefinitionid" operator="in">\n          '.concat(n.map(e=>{var{environmentvariabledefinitionid:n}=e;return"<value>".concat(n,"</value>")}).join(""),"\n        </condition>\n    </filter>\n</entity>\n</fetch>")}),t={};if(r&&r.value)for(var{_environmentvariabledefinitionid_value:o,value:a,environmentvariablevalueid:i}of r.value)try{t[o]={id:i,value:JSON.parse(a)}}catch(l){t.hasOwnProperty(o)&&delete t[o]}return t}))).apply(this,arguments)}},6532:function(e,n,r){"use strict";r.r(n),r.d(n,"getEmbedUrl",(function(){return l})),r.d(n,"getOpenInPowerBIUrl",(function(){return s})),r.d(n,"sortDropdownOptions",(function(){return c})),r.d(n,"makeMakeValidators",(function(){return u})),r.d(n,"makeCallouts",(function(){return d})),r.d(n,"handleCreateInPowerBIDesktopOption",(function(){return p}));var t=r(245),o=r(5148),a=r(6520),i=r(6528);function l(e,n,r){var t;if(n){if(t=e&&r&&n[e]&&n[e].embedUrls[r])return t;for(var o in n)if(n.hasOwnProperty(o)){var a=n[o].embedUrls;for(var i in a)if(a.hasOwnProperty(i)){var l=(t=a[i]).indexOf("?");return-1===l?t:t.substring(0,l)}}}return""}function s(e,n,r,t){var o=new URL(t||"https://app.powerbi.com").hostname,a=new URL("https://".concat(o,"/MobileRedirect.html"));return a.searchParams.set("action","Open".concat(n)),e&&a.searchParams.set("groupObjectId",e),r&&a.searchParams.set("".concat(n.toLowerCase(),"ObjectId"),r),a.toString()}function c(e,n){return e.sort((e,r)=>{if(void 0!==n){if(e.key===n)return-1;if(r.key===n)return 1}var t=(e.text||"").toLowerCase(),o=(r.text||"").toLowerCase();return t>o?1:t<o?-1:0})}function u(e,n){return function(r){for(var t=arguments.length,a=new Array(t>1?t-1:0),i=1;i<t;i++)a[i-1]=arguments[i];return[o.required(e),...a].map(e=>t=>{var o=e(t);return n(r,!!o),o})}}function d(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return r.map(n=>({type:e,element:Object(t.createRef)(),field:n}))}function p(e,n,r){n===a.CREATE_IN_POWER_BI_DESKTOP_KEY?Object(i.downloadPBIDS)(e):r(n)}},6533:function(e,n,r){"use strict";r.r(n),r.d(n,"CurrentValueMessageBar",(function(){return l}));var t=r(1697),o=r(245),a=r.n(o),i=r(6521),l=e=>{var{environmentVariablePanelResources:n}=e;return a.a.createElement(t.MessageBar,{messageBarType:t.MessageBarType.info,styles:i.currentValueMessageBarStyle},n.Panel.CurrentValue.warning)}},6534:function(e,n,r){"use strict";r.r(n),r.d(n,"FormDropdownWithIconButtons",(function(){return c}));var t=r(684),o=r(245),a=r.n(o),i=r(5127),l=r(6521);function s(){return(s=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=r[t])}return e}).apply(this,arguments)}var c=e=>{var{inputKey:n,dropdownProps:r,validators:o,buttonProps:c}=e;return a.a.createElement("div",{className:l.powerbiPanelStyleClasses.dropdownContainer},a.a.createElement(i.FormDropdown,{inputKey:n,dropdownProps:r,validators:o}),c.map(e=>a.a.createElement(t.IconButton,s({},e,{className:l.powerbiPanelStyleClasses.dropdownContainerButton}))))}},6535:function(e,n,r){"use strict";r.r(n),r.d(n,"PowerBIComponentDropdown",(function(){return v}));var t=r(1201),o=r(245),a=r.n(o),i=r(2844),l=r(6520),s=r(6521),c=r(6532),u=r(6522),d=r(6523),p=r(6534);function m(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,t)}return r}function b(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?m(Object(r),!0).forEach((function(n){f(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function f(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}var v=Object(u.withTranslationService)(e=>{var{label:n,validators:r,field:o,isRequired:u,options:m,groupId:f,componentType:v,componentId:P,extraButtonProps:w,renderLabel:y,dispatch:I,t:h}=e,O=y(n,!1!==u),g=f&&m&&m[f]&&m[f].options;return f&&!g?a.a.createElement("div",null,O.onRenderLabel(),a.a.createElement(t.Spinner,{size:t.SpinnerSize.medium})):(v===l.PowerBIComponentType.Report&&(g=[{key:l.CREATE_IN_POWER_BI_DESKTOP_KEY,text:h("PowerBIDashboard.Panel.createInPowerBIDesktop"),data:{icon:i.fabricIcons.Add}},...g||[]]),a.a.createElement(p.FormDropdownWithIconButtons,{inputKey:o,dropdownProps:b(b({},O),{},{options:g||[],onRenderOption:d.renderDropdownOptionWithIcon,placeholder:h("PowerBIDashboard.Panel.placeholder"),selectedKey:P,defaultSelectedKey:P,styles:s.powerbiPanelDropdownStyles,disabled:!f||!g||0===g.length}),validators:r,buttonProps:[{disabled:!P,iconProps:{iconName:i.fabricIcons.OpenInNewWindow},onClick:()=>{var e=Object(c.getEmbedUrl)(f,m,P),n=Object(c.getOpenInPowerBIUrl)(f,v,P,e);I.openNewTab(n,l.PowerBIDashboardPanelCommandEvents.PowerBIOpenComponentClicked.eventName)}},...w||[]]}))})},6536:function(e,n,r){"use strict";r.r(n),r.d(n,"PowerBIGroupDropdown",(function(){return f}));var t=r(245),o=r.n(t),a=r(2844),i=r(6520),l=r(6521),s=r(6532),c=r(6522),u=r(6523),d=r(6534);function p(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,t)}return r}function m(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?p(Object(r),!0).forEach((function(n){b(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function b(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}var f=Object(c.withTranslationService)(e=>{var{label:n,callout:r,validators:t,field:c,isRequired:p,options:b,groupId:f,embedUrl:v,extraButtonProps:P,renderLabel:w,dispatch:y,t:I}=e;return o.a.createElement(d.FormDropdownWithIconButtons,{inputKey:c,validators:t,dropdownProps:m(m({options:b},w(n,!1!==p,r)),{},{onRenderOption:u.renderDropdownOptionWithIcon,placeholder:I("PowerBIDashboard.Panel.placeholder"),selectedKey:f,defaultSelectedKey:f,styles:l.powerbiPanelDropdownStyles}),buttonProps:[{disabled:!f,iconProps:{iconName:a.fabricIcons.OpenInNewWindow},onClick:()=>{var e=Object(s.getOpenInPowerBIUrl)(f,"Group",void 0,v);y.openNewTab(e,i.PowerBIDashboardPanelCommandEvents.PowerBIOpenGroupClicked.eventName)}},...P||[]]})})},6537:function(e,n,r){"use strict";r.r(n),r.d(n,"PowerBIEnvironmentVariableDesigner",(function(){return C}));var t,o=r(684),a=r(245),i=r.n(a),l=r(5127),s=r(5148),c=r(2830),u=r(3076),d=r(2844),p=r(6525),m=r(6520),b=r(6521),f=r(6532),v=r(6528),P=r(6522),w=r(6523),y=r(6533),I=r(6535),h=r(6536);function O(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,t)}return r}function g(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?O(Object(r),!0).forEach((function(n){B(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function B(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function D(e,n,r,t,o,a,i){try{var l=e[a](i),s=l.value}catch(c){return void r(c)}l.done?n(s):Promise.resolve(s).then(t,o)}function E(e){return function(){var n=this,r=arguments;return new Promise((function(t,o){var a=e.apply(n,r);function i(e){D(a,t,o,i,l,"next",e)}function l(e){D(a,t,o,i,l,"throw",e)}i(void 0)}))}}!function(e){e.DisplayName="DisplayName",e.Name="Name",e.Description="Description",e.DataType="DataType",e.Group="Group",e.Component="Component",e.CurrentGroupValue="CurrentGroupValue",e.CurrentComponentValue="CurrentComponentValue"}(t||(t={}));var C=Object(P.withTranslationService)(Object(u.withApolloClient)(e=>{var{environmentClient:n,genericClient:r,solution:u,componentType:P,defaultName:O,environmentVariableToEdit:B,environmentVariablesLearnMoreLink:D,panelMaintenance:{panelMode:C,setPanelMode:T,setHeaderText:N,setHeaderLeftButtonProps:x,setSaveEnabled:R,setOnSave:k,setLoadingOverlayLabel:L,setShowDismissDialog:M},renderLabel:G,environmentVariablePanelResources:U,onNewEnvironmentVariable:A,dispatch:F,environment:_,t:q}=e,[K,W]=Object(a.useState)(),[H,Q]=Object(a.useState)(),[X,z]=Object(a.useState)(),[J,Y]=Object(a.useState)(),[$,Z]=Object(a.useState)(!0),[ee,ne]=Object(a.useState)(),[re,te]=Object(a.useState)(),oe=Object(a.useMemo)(()=>Object(a.createRef)(),[]),[ae,ie]=Object(a.useState)(),[le,se]=Object(a.useState)(),[ce,ue]=Object(a.useState)(),[de,pe]=Object(a.useState)(),{groups:me,dashboards:be,reports:fe}=Object(p.usePowerBIMetadataQuery)(n||r,ae,P!==m.PowerBIComponentType.Dashboard,P!==m.PowerBIComponentType.Report,q("PowerBIDashboard.Request.Failed"),q("PowerBIDashboard.Request.GroupsNotEnabled")),ve=P===m.PowerBIComponentType.Report?fe:be,{groups:Pe,dashboards:we,reports:ye}=Object(p.usePowerBIMetadataQuery)(n||r,ce,P!==m.PowerBIComponentType.Dashboard,P!==m.PowerBIComponentType.Report,q("PowerBIDashboard.Request.Failed"),q("PowerBIDashboard.Request.GroupsNotEnabled")),Ie=P===m.PowerBIComponentType.Report?ye:we,he=Object(f.getEmbedUrl)(ae,ve,le),Oe=Object(f.getEmbedUrl)(ce,Ie,de);Object(a.useMemo)(()=>{if(V(B)){var{displayName:e,name:n,description:r,defaultValue:t,currentValue:o}=B;W(e);var a=Object(v.getSolutionResourceNamePrefix)(u),i=0===n.indexOf(a)?n.substr(a.length):n;z(i),Z(!1),ne(r),ie(t.group.id),se(t.component.id),o&&(o.group&&o.group.id&&(te(!0),ue(o.group.id)),o.component&&o.component.id&&(te(!0),pe(o.component.id)))}},[V(B)]);var ge,Be=()=>{W(void 0),Q(void 0),z(void 0),Y(void 0),Z(!0),ne(void 0),te(!1)},[De]=Object(a.useMemo)(()=>Object(f.makeCallouts)(m.PowerBIPanelMode.EnvironmentVariableDesigner,t.Name),[]);if(Object(a.useMemo)(()=>{if(C===m.PowerBIPanelMode.EnvironmentVariableDesigner&&(N(B?U.Panel.editTitle.replace(/\{0\}/g,B.displayName):U.Panel.createTitle),x({onClick:()=>{Be(),T(m.PowerBIPanelMode.PowerBIDesigner)}}),O&&!B)){W(O);var e=O.replace(m.ENVIRONMENT_VARIABLE_NAME_FORMAT,"");z(e),oe.current&&oe.current.setValue(e)}},[C]),Object(a.useMemo)(()=>C===m.PowerBIPanelMode.EnvironmentVariableDesigner&&k(()=>E((function*(){L(U.Panel.creating);var e=he.indexOf("?"),n=-1===e?he:he.substring(0,e),r={id:le,name:j(ae,le,ve),type:P,embedUrl:n},t=Object(v.getSolutionResourceNamePrefix)(u)+X,o={displayname:K,schemaname:t,description:ee,defaultvalue:JSON.stringify({group:{id:ae,name:S(ae,me)},component:r}),type:c.EnvironmentVariableDefinitionTypeEnum.JSON},a={};re&&ce&&(a=g(g({},a),{},{group:{id:ce,name:S(ce,Pe)}})),re&&de&&(a=g(g({},a),{},{component:{id:de,name:j(ce,de,Ie),type:P,embedUrl:n}}));var i=a&&JSON.stringify(a);V(B)?(yield F.modifyEnvironmentVariable({solution:Object(v.toEnvironmentVariablePanelSolution)(u),defModificationContract:g(g({},o),{},{environmentvariabledefinitionid:B.id})}),B.currentValueId?yield F.modifyCurrentValue({solution:Object(v.toEnvironmentVariablePanelSolution)(u),value:i||"",valueId:B.currentValueId}):yield F.createCurrentValue({solution:Object(v.toEnvironmentVariablePanelSolution)(u),value:i,definitionId:B.id})):yield F.createEnvironmentVariable({solution:Object(v.toEnvironmentVariablePanelSolution)(u),toCreate:o,currentValue:i}),A({displayName:K,name:t,id:V(B)?B.id:void 0,description:ee,defaultValue:{group:{id:ae,name:S(ae,me)},component:r},currentValue:a,currentValueId:V(B)?B.currentValueId:void 0}),Be(),L(void 0),T(m.PowerBIPanelMode.PowerBIDesigner)}))),[ae,le,he,K,X,ce,de,C]),C===m.PowerBIPanelMode.EnvironmentVariableDesigner){var Ee=!(!ae||!S(ae,me)),Ce=!(!le||!j(ae,le,ve)),je=!!he,Se=!V(B)||!!B.id,Ve=!re||!!(ce&&S(ce,Pe)&&de&&j(ce,de,Ie));R((H||V(B)&&void 0===H)&&(J||V(B)&&void 0===J)&&Ee&&Ce&&je&&Se&&Ve);var Te=Object(f.makeMakeValidators)(U.Error.required,(e,n)=>{switch(e){case t.DisplayName:Q(!n);break;case t.Name:Y(!n)}});return i.a.createElement(l.Form,{key:"EnvironmentVariable",onUpdated:(e,n)=>{switch(M(!0),e){case t.DisplayName:if(W(n),$){var r=n.replace(m.ENVIRONMENT_VARIABLE_NAME_FORMAT,"");z(r),oe&&oe.current&&oe.current.setValue(r)}break;case t.Name:var o=(K||"").replace(m.ENVIRONMENT_VARIABLE_NAME_FORMAT,"");$&&n!==o&&Z(!1),z(n);break;case t.Description:ne(n);break;case t.Group:ie(n),se(void 0);break;case t.Component:Object(f.handleCreateInPowerBIDesktopOption)(_,n,se);break;case t.CurrentGroupValue:ue(n),pe(void 0);break;case t.CurrentComponentValue:Object(f.handleCreateInPowerBIDesktopOption)(_,n,pe)}},showErrorsWhenPristine:!1},i.a.createElement("p",null,U.Panel.editSubTitle,i.a.createElement("span",{className:b.powerbiPanelStyleClasses.link,onClick:()=>F.openNewTab(D.url,D.eventName),role:"link"},U.Panel.learnMore)),i.a.createElement(l.FormTextInput,{inputKey:t.DisplayName,textFieldProps:g({},G(U.Panel.displayName,!0)),validators:Te(t.DisplayName,s.maxLength(m.DISPLAY_NAME_MAX_LENGTH,()=>U.Error.displayNameLength)),debounceInterval:m.DEBOUNCE_INTERVAL,value:K}),i.a.createElement(l.FormTextInput,{inputKey:t.Name,textFieldProps:g(g({},G(U.Panel.name,!0,De)),{},{prefix:Object(v.getSolutionResourceNamePrefix)(u),disabled:V(B)}),validators:Te(t.Name),debounceInterval:m.DEBOUNCE_INTERVAL,value:X,componentRef:oe}),i.a.createElement(l.FormTextInput,{inputKey:t.Description,textFieldProps:g({},G(U.Panel.description,!1)),debounceInterval:m.DEBOUNCE_INTERVAL,value:ee}),i.a.createElement(l.FormDropdown,{inputKey:t.DataType,dropdownProps:g(g({},G(U.Panel.DataType.label,!0)),{},{placeholder:U.Panel.DataType.placeholder,options:[{key:c.EnvironmentVariableDefinitionTypeEnum.JSON,text:U.Panel.DataType.json,data:{icon:d.fabricIcons.Code}}],defaultSelectedKey:c.EnvironmentVariableDefinitionTypeEnum.JSON,onRenderOption:w.renderDropdownOptionWithIcon,onRenderTitle:e=>Object(w.renderDropdownOptionWithIcon)(e&&e[0]),role:"listbox",disabled:!0,styles:b.powerbiPanelDropdownStyles})}),i.a.createElement(h.PowerBIGroupDropdown,{field:t.Group,label:q("PowerBIDashboard.Panel.defaultGroupValue"),groupId:ae,embedUrl:he,options:me,renderLabel:G,dispatch:F}),i.a.createElement(I.PowerBIComponentDropdown,{field:t.Component,label:q("PowerBIDashboard.Panel.default".concat(P,"Value")),groupId:ae,componentType:P,componentId:le,options:ve,renderLabel:G,dispatch:F}),i.a.createElement("div",{className:b.powerbiPanelStyleClasses.currentValueFieldHeader},G(U.Panel.CurrentValue.label,!1).onRenderLabel(),i.a.createElement("div",null,i.a.createElement("span",null,U.Panel.CurrentValue.subheader)),re&&i.a.createElement("div",null,i.a.createElement(h.PowerBIGroupDropdown,{field:t.CurrentGroupValue,label:q("PowerBIDashboard.Panel.currentGroupValue"),isRequired:!1,groupId:ce,embedUrl:Oe,options:Pe,extraButtonProps:[(ge=te,{iconProps:{iconName:d.fabricIcons.Cancel},styles:{icon:{paddingLeft:"8px",margin:"0"},menuIcon:{width:"0",padding:"0"}},onClick:()=>ge(!1)})],renderLabel:G,dispatch:F}),i.a.createElement(I.PowerBIComponentDropdown,{field:t.CurrentComponentValue,label:q("PowerBIDashboard.Panel.current".concat(P,"Value")),isRequired:!1,groupId:ce,componentType:P,componentId:de,options:Ie,renderLabel:G,dispatch:F}),B&&i.a.createElement(y.CurrentValueMessageBar,{environmentVariablePanelResources:U})),!re&&i.a.createElement(o.ActionButton,{iconProps:{iconName:d.fabricIcons.Add},onClick:()=>te(!0)},U.Panel.CurrentValue.newValue)))}return null}));function j(e,n,r){return S(n,e&&r&&r[e]&&r[e].options)}function S(e,n){if(n)for(var{key:r,text:t}of n)if(e===r)return t;return""}function V(e){return!!e}}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/203.44c8f143.chunk.js.map