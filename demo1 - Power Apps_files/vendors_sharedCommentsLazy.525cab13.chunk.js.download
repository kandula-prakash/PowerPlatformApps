/*! For license information please see vendors~sharedCommentsLazy.525cab13.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[602],{32936:function(e,t,n){"use strict";n.r(t),n.d(t,"ExtensionAwareCommentPane",(function(){return d}));var r=n(245),o=n(31069),i=n(30997),a=n(32937),s=n(31350),l=n(31305),c=n(32938),u=n(33162),d=r.memo((function(e){var t=Object(a.useCommentStateSelector)((function(t){return Object(s.isExtensionEnabled)(t,e.extensionRenderMode)})),n=Object(a.useCommentStateSelector)(l.getPaneVisibility)!==o.ViewContainerVisibilityState.Visible;if(t||n)return null;var d=r.createElement(c.default,{commentAPI:e.commentAPI,peopleAPI:e.peopleAPI,localizationAPI:e.localizationAPI,focusManager:e.focusManager,selectionManager:e.selectionManager,initializationReason:e.initializationReason,registerComponentUIActionListener:e.registerComponentUIActionListener,unregisterComponentUIActionListener:e.unregisterComponentUIActionListener,registerComponentInterruptableCommandListener:e.registerComponentInterruptableCommandListener,unregisterComponentInterruptableCommandListener:e.unregisterComponentInterruptableCommandListener,resource:e.resource,telemetryVisitor:e.telemetryVisitor,correlationId:e.correlationId,onInitialRender:e.onInitialRender,lppManager:e.lppManager,componentRef:e.componentRef,componentInstanceId:e.componentInstanceId});return i.isWebThemeIntegrationEnabled()&&(d=r.createElement(u.ThemeProviderWrapper,{api:e.themeAPI},d)),d}))},32937:function(e,t,n){"use strict";n.r(t),n.d(t,"useCommentStateSelector",(function(){return o})),n.d(t,"useCommentDispatch",(function(){return i}));var r=n(25301),o=r.useSelector,i=function(){return Object(r.useDispatch)()}},32938:function(e,t,n){"use strict";n.r(t),n.d(t,"makeMapStateToProps",(function(){return d})),n.d(t,"commentPaneConnector",(function(){return p})),n.d(t,"CommentPaneContainer",(function(){return f}));var r=n(25301),o=n(31140),i=n(31300),a=n(31305),s=n(31304),l=n(31281),c=n(31394),u=n(32939);function d(){var e=i.makeGetRenderableItems();return function(t){var n=i.getContextState(t),r=a.getPaneComponentTree(t),c={cardViewStates:i.getCardViewStates(t),dataItems:e(t),tasks:s.getTasks(t),personaIconPropertiesMap:i.getPersonaIconPropertiesMap(t),createdCommentLie:i.getCreatedCommentLie(t,!0,r.componentTreeId.renderContextType),nextPopulatedContextDetails:n.nextPopulatedContextDetails,pendingCommentLoad:i.getPendingCommentLoad(t),postViewStates:i.getPostViewStates(t),historyRecordViewStates:s.getHistoryRecordViewStates(t),componentTree:r,commentThreadCountsContextDetails:n.commentThreadCounts,virtualized_deprecated:i.getVirtualized_deprecated(t),selectedThreadIdBeforeCommentSession:i.getSelectedThreadIdBeforeCommentSession(t),readOnly:i.getIsReadOnly(t),highlightedCommentId:i.getHighlightedCommentId(t),lastContextChangeIncrement:n.lastContextChangeIncrement,initializationStatus:t.paneState.initializationStatus,atMentionState_deprecated:i.getAtMentionState_deprecated(t),draftState:i.getDraftState(t),capabilities_deprecated:i.getCapabilities_deprecated(t),modelCapabilities:i.getModelCapabilities(t),selectedComment:i.getSelectedComment(t),expandedComments:i.getExpandedComments(t),suggestionsDetails:i.getSuggestionsDetails(t),foldableLayoutState:a.getPaneViewContainer(t).foldableLayoutState,displayConfigurationState:t.paneState.viewContainerDisplayConfiguration},u=i.getTopVisibleThreadId(t);if(u){var d=i.getCommentThreadData(t),p=Object(l.isThreadIdArray)(d)?d.findIndex((function(e){return e===u})):d.filter(o.asThread).findIndex((function(e){return e.commentId===u}));p>-1&&(c.topVisibleThread={cardId:u,index:p})}return c}}var p=Object(r.connect)(d,c.getPaneDispatchProps,void 0,{forwardRef:!0}),f=p(u.default);t.default=f},32939:function(e,t,n){"use strict";n.r(t),n.d(t,"SinglePostCardScrollHeight",(function(){return R})),n.d(t,"CollapsedCardScrollHeight",(function(){return j})),n.d(t,"SingleReplyCardScrollHeight",(function(){return D}));var r=n(562),o=n(3e4),i=n(30010),a=n(31370),s=n(30061),l=n(30123),c=n(31159),u=n(245),d=n(8061),p=n(31260),f=n(31124),h=n(31125),m=n(32926),y=n(30997),g=n(31259),b=n(31290),v=n(32940),C=n(33155),T=n(33156),O=n(33160),S=n(32947),P=n(31285),x=n(31038),I=n(32933),E=n(31413),A=n(31302),k=n(30994),w=n(32934),_=n(31303),R=160,j=235,D=206,M={cardTabbingMode:S.CardTabbingMode.ExpandedCardOrFirstCardTabbable,postTabbingMode:S.PostTabbingMode.ExpandedCardRootPostTabbable},B=function(e){function t(t){var n=e.call(this,t)||this;return n.paneRootRef=null,n.onPaneResize=function(e){Object(s.getTelemetryAPI)().assertConditionTag(e.length<=1,"Unexpected number of elements: ".concat(e.length),592232640),e.forEach((function(e){e.target===n.paneRootRef&&(n.props.selectedComment&&n.prevContentRect&&n.prevContentRect.height!==e.contentRect.height&&n.scrollToThreadById(n.props.selectedComment.selectedCardId),n.prevContentRect=e.contentRect)}))},n.onRenderCell=function(e,t){if(e)return n.renderCommentThread(t||0,e);Object(s.getTelemetryAPI)().assertConditionTag(!1,"Trying to render non-existent item",577066524)},n.onCardLayout=void 0,n.renderWithContexts=function(e){var t=n.paneContainerKeyDownHandler.onKeyDown;n.styles=Object(C.getStyles)(null==e?void 0:e.colors);var o=null;o=n.isReadyToRender()?n.isPaneEmpty()?n.renderEmptyPaneMessage():u.createElement("div",{"data-is-scrollable":"true",id:x.getCommentsListID(),className:n.styles.listContainer,onKeyDown:n.commentContentsKeyDownHandler.onKeyDown},u.createElement(l.List,{ref:n.onReceiveListRef,className:n.styles.commentList,items:n.state.allRenderableItemThreads,role:"tree",onRenderPage:n.onRenderPage,onRenderCell:n.onRenderCell,"aria-label":n.props.localizationAPI.getString(32),getKey:n.getListItemKey}),n.shouldShowGhostComment()?u.createElement(T.GhostComment,Object(r.__assign)({},n.getGhostCommentProps())):void 0):u.createElement(l.DelayedRender,{delay:k.SPINNER_DELAY_MS},u.createElement(l.Spinner,{size:l.SpinnerSize.large,className:n.styles.spinnerStyles}));var i={ref:n.setPaneRootDivRef,id:x.getFirstPaneElementId(),"aria-label":n.props.localizationAPI.getString(31),className:n.styles.paneContainer,onKeyDown:t,tabIndex:-1,onFocus:n.paneFocusHandler,onContextMenu:E.onBrowserContextMenu};return y.isTaskPaneWithNewInfrastructureEnabled()?u.createElement("div",Object(r.__assign)({},i),n.renderNewCommentButtonWrapper(),o):u.createElement(l.FocusTrapZone,{className:n.styles.focusTrapZone,isClickableOutsideFocusTrap:!0,ignoreExternalFocusing:!0,forceFocusInsideTrap:!1,disableFirstFocus:!0},u.createElement("div",Object(r.__assign)({},i),n.renderCommentPaneHeader_deprecated(),n.renderNewCommentButtonWrapper(),o))},n.onRenderPage=n.onRenderPage.bind(n),n.scrollToThreadById=n.scrollToThreadById.bind(n),n.closePaneButtonClickHandler_deprecated=n.closePaneButtonClickHandler_deprecated.bind(n),n.closePaneButtonKeyDownHandler_deprecated=n.closePaneButtonKeyDownHandler_deprecated.bind(n),n.onReceiveListRef=n.onReceiveListRef.bind(n),n.paneFocusHandler=n.paneFocusHandler.bind(n),n.setPaneRootDivRef=n.setPaneRootDivRef.bind(n),n.newCommentButtonClickHandler=n.newCommentButtonClickHandler.bind(n),n.newCommentButtonKeyDownHandler=n.newCommentButtonKeyDownHandler.bind(n),n.getMentionableCommentEditorProps=Object(i.memoizeOnce)(n.getMentionableCommentEditorProps.bind(n)),n.getAuthToken=n.getAuthToken.bind(n),n.state=n.getInitialState(t),n.resizeObserver=new d.default(n.onPaneResize),n}return Object(r.__extends)(t,e),t.prototype.onReceiveListRef=function(e){this.listRef=e},t.prototype.isPaneEmpty=function(){var e=this.props.nextPopulatedContextDetails===h.NextPopulatedContextDetails.NoComments;return e&&Object(s.getTelemetryAPI)().assertConditionTag(!this.props.dataItems.length,"CommentData length should be 0 if NextPopulatedContextDetails is NoComments.",595182560),e&&!this.props.dataItems.length&&!this.props.createdCommentLie},t.prototype.scrollToThreadById=function(e){var t=this;if(!this.listRef)return!1;var n=this.state.allRenderableItemThreads,r=Math.max(n.findIndex((function(t){return A.getRootComment(t).commentId===e})),0);return this.listRef.scrollToIndex(r,(function(e){return t.getCardScrollHeight(e,n)})),!0},t.prototype.paneFocusHandler=function(e){e.target===this.paneRootRef&&this.props.focusManager.focusCommentPaneCommand(this.props.componentTree)},t.prototype.setPaneRootDivRef=function(e){this.paneRootRef=e},t.prototype.closePaneButtonClickHandler_deprecated=function(e){this.closePane(),e.stopPropagation()},t.prototype.closePaneButtonKeyDownHandler_deprecated=function(e){Object(c.normalizeKey)(e.key)===c.KeyboardKey.Enter&&(this.closePane(),e.preventDefault(),e.stopPropagation())},t.prototype.newCommentButtonClickHandler=function(e){this.startNewCommentSession(),e.stopPropagation()},t.prototype.newCommentButtonKeyDownHandler=function(e){Object(c.normalizeKey)(e.key)===c.KeyboardKey.Enter&&(this.startNewCommentSession(),e.stopPropagation(),e.preventDefault())},t.prototype.getGhostCommentProps=function(){var e=P.getGhostFunctionString(this.props.localizationAPI,this.props.nextPopulatedContextDetails);return{onClick:this.onGhostCommentClicked,ghostCommentString:e,accessibilityLabel:e}},t.prototype.onContextChanged=function(){},t.prototype.getAuthToken=function(){return this.props.peopleAPI.getAuthToken(a.PeopleServiceId.Loki)},t.prototype.renderCommentPaneHeader_deprecated=function(){return u.createElement("div",{className:this.styles.paneHeader},y.isA11yFastPastFixesEnabed()?u.createElement("h2",{className:this.styles.paneTitle},this.props.localizationAPI.getString(18)):u.createElement("div",{className:this.styles.paneTitle},this.props.localizationAPI.getString(18)),u.createElement(l.TooltipHost,{content:this.props.localizationAPI.getString(19),directionalHint:l.DirectionalHint.leftCenter,tooltipProps:w.commentTooltipProps},this.renderCloseButton_deprecated()))},t.prototype.renderCloseButton_deprecated=function(){return u.createElement(l.IconButton,{id:x.getClosePaneButtonId(),styles:this.styles.iconClosePane,onClick:this.closePaneButtonClickHandler_deprecated,onKeyDown:this.closePaneButtonKeyDownHandler_deprecated,iconProps:{iconName:"CancelGlyph_TaskPane"},title:void 0,ariaLabel:this.props.localizationAPI.getString(20),tabIndex:0})},t.prototype.isNewCommentButtonDisabled=function(){return y.isNewModelStateEnabled()&&!this.props.modelCapabilities.newThread||this.props.readOnly},t.prototype.renderNewCommentButtonWrapper=function(){return y.isNewCommentButtonEnabled()?u.createElement(O.NewCommentButton,{disabled:this.isNewCommentButtonDisabled(),localizationAPI:this.props.localizationAPI,onClick:this.newCommentButtonClickHandler,onKeyDown:this.newCommentButtonKeyDownHandler}):null},t.prototype.renderEmptyPaneMessage=function(){return u.createElement("div",{className:this.styles.emptyPaneMessage,"aria-label":this.props.localizationAPI.getString(13),tabIndex:y.isA11yFastPastFixesEnabed()?void 0:0},this.props.localizationAPI.getString(13))},t.prototype.onRenderPage=function(e,t){if((null==e?void 0:e.page.items)&&Object(g.getVirtualizedState)(this.props.modelCapabilities,this.props.virtualized_deprecated)){var n=e.page.items,r=Object(i.mapFilter)(n,(function(e){if(Object(_.hasRenderableCommentItem)(e[0]))return Object(p.getThreadId)(e[0].commentModel);Object(s.getTelemetryAPI)().assertConditionTag(!1,"First item in thread is not a comment model!",595632604)}));r.length&&this.onRequestLoadThreads(r)}return Object(s.getTelemetryAPI)().assertConditionTag(!!e,"Trying to render with non-existent pageProps!",577066525),t?t(e):null},t.prototype.getCreateCommentInitialHeight=function(){return 0},t.prototype.getKeyboardingOptions=function(){return M},t.prototype.componentDidUpdate=function(t,n){var r,o,i=null===(r=t.selectedComment)||void 0===r?void 0:r.selectedCardId,a=null===(o=this.props.selectedComment)||void 0===o?void 0:o.selectedCardId,s=i!==a,l=Object(v.getTopAlignId)(t),c=Object(v.getTopAlignId)(this.props);s?a&&this.scrollToThreadById(a):!this.props.selectedComment&&l!==c&&c&&this.scrollToThreadById(c),!this.listRef||this.props.selectedComment===t.selectedComment&&this.props.expandedComments===t.expandedComments&&this.props.cardViewStates===t.cardViewStates&&this.props.postViewStates===t.postViewStates&&this.props.highlightedCommentId===t.highlightedCommentId&&this.props.atMentionState_deprecated===t.atMentionState_deprecated&&this.props.modelCapabilities===t.modelCapabilities&&this.props.readOnly===t.readOnly&&this.props.draftState===t.draftState||this.listRef.forceUpdate(),e.prototype.componentDidUpdate.call(this,t,n)},t.prototype.componentDidMount=function(){e.prototype.componentDidMount.call(this),this.paneRootRef&&this.resizeObserver.observe(this.paneRootRef)},t.prototype.componentWillUnmount=function(){e.prototype.componentWillUnmount.call(this),this.resizeObserver&&this.resizeObserver.disconnect(),this.prevContentRect=void 0},t.prototype.UNSAFE_componentWillReceiveProps=function(e){var t=this.getUpdatedItemThreads(e);this.setState({allRenderableItemThreads:t})},t.prototype.getCardScrollHeight=function(e,t){return Object(s.getTelemetryAPI)().assertConditionTag(void 0!==t[e],"No comment thread in the given index: '".concat(e,"'. Thread length: '").concat(t.length,"'"),595182561),t[e]&&1===t[e].length?R:t[e]&&2===t[e].length?D:j},t.prototype.invokeModalDialog=function(e,t,n){var r=Object(s.getTelemetryAPI)().createActivityObject("InvokeModalDialog",this.props.telemetryVisitor,s.ActivityAggregationMode.None,s.ActivityDiagnosticLevel.NecessaryServiceDataEvent);switch(r.addDataField("ModalDialogMode",e,s.DataFieldClassification.SystemMetadata),e){case b.default.ClosePaneDraft:var i,a=P.getDiscardDialogStrings(this.props.localizationAPI),l=new Promise((function(e){i=e}));return this.props.requestModalConfirmation({renderContextType:this.props.componentTree.componentTreeId.renderContextType,trackback:o.TelemetryTag.reserveTag(595928218),telemetryVisitor:this.props.telemetryVisitor},(function(){return i(t())}),(function(){return i(n())}),a),r.successTag(595182562),l;default:return Object(s.getTelemetryAPI)().assertConditionTag(!1,"ModalDialogMode ".concat(e," not implemented for web"),595182563),r.failTag(595182592,-2130957557),Promise.resolve(f.InterruptableCommandResult.Unhandled)}},t.prototype.getMentionableCommentEditorProps=function(e,t){if(e===p.AtMentionCapabilityState.Enabled)return{onMentionCreated:this.onMentionCreated,onMentioneesStillInDraftUpdated:this.onMentioneesStillInDraftUpdated,getAuthToken:this.getAuthToken,correlationId:this.props.correlationId,lppManager:this.props.lppManager,suggestionsDetails:t}},t.prototype.getContentsPreventDefaultKeyDownBehavior=function(){},t.prototype.getContentExtraPaddingLeft=function(){},t.prototype.getContentExtraPaddingRight=function(){},t.prototype.getAvailableScreenHeight=function(){},t.prototype.getMaxDraftHeight=function(){},t.prototype.getCommentCardStyle=function(){},t.prototype.getContentBackgroundColor=function(e,t){},t.prototype.getPinnedCardIndex_deprecated=function(){},t.prototype.renderInner=function(){return y.isWebThemeIntegrationEnabled()?Object(I.consumeContexts)(this.renderWithContexts,m.SemanticStylesProviderContext):this.renderWithContexts()},t}(v.default);t.default=B},32940:function(e,t,n){"use strict";n.r(t),n.d(t,"getTopAlignId",(function(){return W}));var r=n(562),o=n(3e4),i=n(30010),a=n(30061),s=n(31018),l=n(31044),c=n(245),u=n(31260),d=n(31123),p=n(31427),f=n(31124),h=n(31125),m=n(31132),y=n(31041),g=n(30997),b=n(31103),v=n(31187),C=n(31257),T=n(31299),O=n(31258),S=n(31259),P=n(31295),x=n(31283),I=n(32941),E=n(32946),A=n(31343),k=n(31284),w=n(31040),_=n(31308),R=n(31385),j=n(31408),D=n(31412),M=n(31301),B=n(32948),N=n(31038),L=n(31411),F=n(32961),H=n(33151),U=n(31110),z=n(31302),K=n(33153);function W(e){if(e.topVisibleThread&&e.componentTree.componentTreeId.renderContextType!==w.default.HalfPane&&!e.selectedComment)return e.topVisibleThread.cardId}var V=function(e){function t(t){var n,s=e.call(this,t)||this;s.memoGetActionBarItems=Object(i.memoize)(K.getActionBarItems,20,(function(){Object(a.getTelemetryAPI)().assertConditionTag(!1,"Cache invalidated, memoization or parameters configured incorrectly?",557875362)})),s.memoGetCardContextualMenuItems=Object(i.memoize)(K.getCardContextualMenuItems,20,(function(){Object(a.getTelemetryAPI)().assertConditionTag(!1,"Cache invalidated, memoization or parameters configured incorrectly?",557875363)})),s.initialAtMentionCapability=new i.DeferredResult,s.onCommentInterruptableCommand=function(e){switch(e.type){case"DiscardDraft":var t=void 0;if(e.mode===p.DiscardDraftMode.Dialog){var n=Object(D.getCancelModalDialogMode)(s.props.draftState,s.props.componentTree.componentTreeId.renderContextType);t=s.getOnWillDiscardCallback(n);var r=Object(L.shouldClosePaneAfterDiscardDraft)(!0,s.props.componentTree.componentTreeId.renderContextType,s.props.draftState,s.props.selectedComment,s.props.selectedThreadIdBeforeCommentSession);return s.props.discardDraftAsync({renderContextType:s.props.componentTree.componentTreeId.renderContextType,telemetryVisitor:s.props.telemetryVisitor,trackback:o.TelemetryTag.reserveTag(587605836)},C.default.Canvas,r,t)}return Promise.resolve(f.InterruptableCommandResult.Unhandled);case"BringThreadIntoView":return s.props.componentTree.componentTreeId.renderContextType!==w.default.FullPane?Promise.resolve(f.InterruptableCommandResult.Unhandled):s.scrollToThreadById(e.threadId)?Promise.resolve(f.InterruptableCommandResult.Handled):Promise.resolve(f.InterruptableCommandResult.Failed);default:return Object(a.getTelemetryAPI)().assertConditionTag(!1,"Unknown type of CommentInterruptableCommand",593826210),Promise.resolve(f.InterruptableCommandResult.Unhandled)}},s.onCardPost=function(e,t){var n=e.getId(),r=s.props.draftState.cardIdToDraftIdMap[n],i=s.props.draftState.drafts[r],a=Object(S.getSingleCreateDraftId)(s.props.draftState,!0,s.props.componentTree.componentTreeId.renderContextType)===e.getId()?{type:"CREATE"}:{type:"REPLY",parentId:n};j.cardOnCommit({trackback:o.TelemetryTag.reserveTag(593622435),commentCardRef:e,draftState:s.props.draftState,areMentionsEnabled:Object(S.getAtMentionCapabilityState)(s.props.modelCapabilities,s.props.atMentionState_deprecated)===u.AtMentionCapabilityState.Enabled,session:a,componentTree:s.props.componentTree,dispatchProps:s.props,telemetryVisitor:s.props.telemetryVisitor,localizationAPI:s.props.localizationAPI,commitSource:t,selectedTaskAssignee:i&&i.selectedTaskAssignee}).catch(Object(y.makeAssertErrorHandler)(o.TelemetryTag.reserveTag(593622464)))},s.cardOnCollapseCallback=function(e){j.cardOnCollapseCallback({trackback:o.TelemetryTag.reserveTag(562918286),commentCardRef:e,renderContextType:s.props.componentTree.componentTreeId.renderContextType,dispatchProps:s.props,telemetryVisitor:s.props.telemetryVisitor})},s.cardOnSelectCallback=function(e){j.cardOnSelectCallback({trackback:o.TelemetryTag.reserveTag(571281794),commentCardRef:e,dispatchProps:s.props,telemetryVisitor:s.props.telemetryVisitor,componentTree:s.props.componentTree,options:{selectActionType:v.SelectActionType.SelectCard}})},s.cardOnSelectExpandCallback=function(e,t,n){var r=Object(R.getCardRelativeDraftingState)(e.getId(),s.props.componentTree.componentTreeId.renderContextType,s.props.draftState);j.cardOnSelectCallback({trackback:o.TelemetryTag.reserveTag(571281793),commentCardRef:e,dispatchProps:s.props,telemetryVisitor:s.props.telemetryVisitor,componentTree:s.props.componentTree,options:{selectActionType:v.SelectActionType.ExpandCard,relativeDraftingState:r,draftState:s.props.draftState,shouldFocusAfter:n,selectRootPost:t}})},s.cardOnFocusCallback=function(e){j.cardOnFocusCallback({trackback:o.TelemetryTag.reserveTag(571340119),commentCardRef:e,dispatchProps:s.props,telemetryVisitor:s.props.telemetryVisitor,componentTree:s.props.componentTree,options:{selectActionType:v.SelectActionType.Polite},focusManager:s.props.focusManager,isDraftThread:Object(S.getSingleCreateDraftId)(s.props.draftState,!0,s.props.componentTree.componentTreeId.renderContextType)===e.getId()})},s.cardOnBeginReplyCallback=function(e){j.cardOnBeginReply({trackback:o.TelemetryTag.reserveTag(593826249),threadId:e.getId(),renderContextType:s.props.componentTree.componentTreeId.renderContextType,dispatchProps:s.props,telemetryVisitor:s.props.telemetryVisitor})},s.cardOnResolveThread=function(e){j.cardOnResolveThread({componentTree:s.props.componentTree,focusManager:s.props.focusManager,trackback:o.TelemetryTag.reserveTag(593826250),id:e,renderContextType:s.props.componentTree.componentTreeId.renderContextType,dispatchProps:s.props,telemetryVisitor:s.props.telemetryVisitor,localizationAPI:s.props.localizationAPI,isTask:!!s.props.tasks[e]})},s.cardOnReopenThread=function(e){j.cardOnReopenThread({trackback:o.TelemetryTag.reserveTag(593826251),id:e,renderContextType:s.props.componentTree.componentTreeId.renderContextType,dispatchProps:s.props,telemetryVisitor:s.props.telemetryVisitor,localizationAPI:s.props.localizationAPI,isTask:!!s.props.tasks[e]})},s.cardOnDelete=function(e){j.cardOnDelete({trackback:o.TelemetryTag.reserveTag(593826252),id:e,data:s.props.dataItems,selectedComment:s.props.selectedComment,componentTree:s.props.componentTree,invokeModalDialog:s.invokeModalDialog,dispatchProps:s.props,telemetryVisitor:s.props.telemetryVisitor,localizationAPI:s.props.localizationAPI,focusManager:s.props.focusManager,isTask:!!s.props.tasks[e],threadIndex:z.getIndexOfThreadById(s.state.allRenderableItemThreads,e),shouldCheckForLowFidelity:s.shouldCheckForLowFidelityOnCardDelete()})},s.cardOnDraftingInputSizeChange=function(e,t){var n=Object(S.getSingleCreateDraftId)(s.props.draftState,!0,s.props.componentTree.componentTreeId.renderContextType);j.cardOnDraftingInputSizeChange({trackback:o.TelemetryTag.reserveTag(593826253),focusManager:s.props.focusManager,componentTree:s.props.componentTree,cardId:e.getId(),isCardLie:e.getId()===n,newHeight:t,renderContextType:s.props.componentTree.componentTreeId.renderContextType,selectedComment:s.props.selectedComment,dispatchProps:s.props,telemetryVisitor:s.props.telemetryVisitor})},s.cardOnDraftEmptinessChanged=function(e,t){j.onDraftEmptinessChanged({trackback:o.TelemetryTag.reserveTag(592213848),contentId:e.getId(),isEmpty:t,renderContextType:s.props.componentTree.componentTreeId.renderContextType,draftIdMap:s.props.draftState.cardIdToDraftIdMap,actionDispatchers:s.props,telemetryVisitor:s.props.telemetryVisitor})},s.cardOnEditorFocusLost=function(e){j.cardOnEditorFocusLost({trackback:o.TelemetryTag.reserveTag(592065735),id:e.getId(),draftState:s.props.draftState,renderContextType:s.props.componentTree.componentTreeId.renderContextType,dispatchProps:s.props,telemetryVisitor:s.props.telemetryVisitor})},s.cardOnSaveDraft=function(e,t){j.onSaveDraft({trackback:o.TelemetryTag.reserveTag(593826255),id:e,editor:t,renderContextType:s.props.componentTree.componentTreeId.renderContextType,draftIdMap:s.props.draftState.cardIdToDraftIdMap,draftMap:s.props.draftState.drafts,actionDispatchers:s.props,telemetryVisitor:s.props.telemetryVisitor})},s.onCardCancel=function(e){var t=Object(L.shouldClosePaneAfterDiscardDraft)(!0,s.props.componentTree.componentTreeId.renderContextType,s.props.draftState,s.props.selectedComment,s.props.selectedThreadIdBeforeCommentSession);j.cardOnDraftingCancel({trackback:o.TelemetryTag.reserveTag(592840780),showDiscardDialog:!1,invokeModalDialog:s.invokeModalDialog,componentTree:s.props.componentTree,dispatchProps:s.props,closeOnDiscard:t,cardId:e.getId(),draftState:s.props.draftState,telemetryVisitor:s.props.telemetryVisitor,localizationAPI:s.props.localizationAPI,focusManager:s.props.focusManager,lieIndex:z.getIndexOfThreadById(s.state.allRenderableItemThreads,e.getId())})},s.onTaskTopperCheckboxPressed=function(e){if(g.areCommentTasksEnabled()){var t=s.props.tasks[e];t&&j.cardOnTaskTopperCheckboxPressed({componentTree:s.props.componentTree,focusManager:s.props.focusManager,trackback:o.TelemetryTag.reserveTag(593826258),id:t.commentId,renderContextType:s.props.componentTree.componentTreeId.renderContextType,dispatchProps:s.props,telemetryVisitor:s.props.telemetryVisitor,localizationAPI:s.props.localizationAPI})}},s.cardOnHighlight=function(e,t){j.cardOnHighlight({trackback:o.TelemetryTag.reserveTag(593826259),commentCardRef:e,renderContextType:s.props.componentTree.componentTreeId.renderContextType,dispatchProps:s.props,telemetryVisitor:s.props.telemetryVisitor,shouldHighlightCard:t})},s.onPostDelete=function(e){j.postOnDelete({trackback:o.TelemetryTag.reserveTag(593826312),id:e,data:s.props.dataItems,selectedComment:s.props.selectedComment,renderContextType:s.props.componentTree.componentTreeId.renderContextType,actionDispatchers:s.props,telemetryVisitor:s.props.telemetryVisitor,localizationAPI:s.props.localizationAPI})},s.onPostEdit=function(e){j.postOnEdit({trackback:o.TelemetryTag.reserveTag(593826316),id:e,data:s.props.dataItems,selectedComment:s.props.selectedComment,renderContextType:s.props.componentTree.componentTreeId.renderContextType,actionDispatchers:s.props,telemetryVisitor:s.props.telemetryVisitor})},s.onPostReactionUpdated=function(e,t,n){j.onReactionsUpdated(o.TelemetryTag.reserveTag(587994051),e,t,s.props.componentTree.componentTreeId.renderContextType,s.props,s.props.telemetryVisitor,n)},s.onPostCommit=function(e,t){j.postOnCommit({trackback:o.TelemetryTag.reserveTag(593826260),id:e.getId(),data:s.props.dataItems,draftState:s.props.draftState,contentPromise:e.getContentsAsync(),atMentionsEnabled:Object(S.getAtMentionCapabilityState)(s.props.modelCapabilities,s.props.atMentionState_deprecated)===u.AtMentionCapabilityState.Enabled,componentTree:s.props.componentTree,actionDispatchers:s.props,telemetryVisitor:s.props.telemetryVisitor,localizationAPI:s.props.localizationAPI,commitSource:t}).catch(Object(y.makeAssertErrorHandler)(o.TelemetryTag.reserveTag(593826261)))},s.onPostCancel=function(e){var t=Object(L.shouldClosePaneAfterDiscardDraft)(!0,s.props.componentTree.componentTreeId.renderContextType,s.props.draftState,s.props.selectedComment,s.props.selectedThreadIdBeforeCommentSession);j.postOnCancel({trackback:o.TelemetryTag.reserveTag(593826263),commentId:e.getId(),setContents:e.setContents.bind(e),data:s.props.dataItems,draftState:s.props.draftState,shouldClosePaneAfterDiscardDraft:t,onWillDiscardCallback:void 0,renderContextType:s.props.componentTree.componentTreeId.renderContextType,dispatchProps:s.props,telemetryVisitor:s.props.telemetryVisitor,localizationAPI:s.props.localizationAPI})},s.onPostDraftEmptinessChanged=function(e,t){j.onDraftEmptinessChanged({trackback:o.TelemetryTag.reserveTag(592041678),contentId:e.getId(),isEmpty:t,renderContextType:s.props.componentTree.componentTreeId.renderContextType,draftIdMap:s.props.draftState.postIdToDraftIdMap,actionDispatchers:s.props,telemetryVisitor:s.props.telemetryVisitor})},s.onPostSaveDraft=function(e,t){j.onSaveDraft({trackback:o.TelemetryTag.reserveTag(592720405),id:e,editor:t,renderContextType:s.props.componentTree.componentTreeId.renderContextType,draftIdMap:s.props.draftState.postIdToDraftIdMap,draftMap:s.props.draftState.drafts,actionDispatchers:s.props,telemetryVisitor:s.props.telemetryVisitor})},s.onPresentLinkToComment=function(e){j.onPresentLinkToComment(o.TelemetryTag.reserveTag(578852484),e,s.props.componentTree.componentTreeId.renderContextType,s.props,s.props.telemetryVisitor)},s.onRenderableItemSelect=function(e,t){var n=s.getRenderableItemFromRef(e);n?j.renderableItemOnSelect({trackback:o.TelemetryTag.reserveTag(593826266),renderableItem:n,selectedComment:s.props.selectedComment,cardCollapsedState:Object(_.getCardCollapsedState)(z.getThreadIdForItem(n),s.props.expandedComments,s.props.componentTree.componentTreeId.renderContextType),dispatchProps:s.props,telemetryVisitor:s.props.telemetryVisitor,componentTree:s.props.componentTree,shouldFocusAfter:t,draftState_deprecated:s.props.draftState}).catch(Object(y.makeAssertErrorHandler)(o.TelemetryTag.reserveTag(590123737))):Object(a.getTelemetryAPI)().assertConditionTag(!1,"Selection coming from an unknown post?",593826265)},s.onPostCollapseParent=function(e){var t=s.getRenderableItemFromRef(e);t?j.postOnCollapse(o.TelemetryTag.reserveTag(589940445),t,s.props,s.props.telemetryVisitor,s.props.componentTree):Object(a.getTelemetryAPI)().assertConditionTag(!1,"Collapse from an unknown post?",589940444)},s.onPostFocusParent=function(e){var t=s.getRenderableItemFromRef(e);t?j.postOnFocusParent(t,s.props.componentTree,s.props.focusManager,s.props.draftState):Object(a.getTelemetryAPI)().assertConditionTag(!1,"Focus parent from unknown post?",545867681)},s.getThreadedRenderableIds=Object(i.memoizeOnceWithParams)((function(e){return e.map((function(e){return e.map(z.getId)}))}),(function(){return[s.state.allRenderableItemThreads]})),s.getThreadPostOrHistoryRecordStates=(n=Object(i.makeMemoizedMapLookup)(),function(){return n(s.getThreadedRenderableIds(),Object(r.__assign)(Object(r.__assign)({},s.props.postViewStates),s.props.historyRecordViewStates))}),s.getListItemKey=function(e){var t=z.getRootComment(e).commentId,n=s.props.cardViewStates[t];return n&&n.alternateId||t},s.getHostableComponentInstanceId=function(e,t,n){return"cardInPane_".concat(Object(N.getCardRootId)({id:e,renderContextType:t},n))},s.onSelectedTaskAssigneeUpdated=function(e){g.areCommentTasksEnabled()?j.onUpdateSelectedTaskAssignee({trackback:o.TelemetryTag.reserveTag(593826304),renderContextType:s.props.componentTree.componentTreeId.renderContextType,dispatchProps:s.props,telemetryVisitor:s.props.telemetryVisitor,selectedAssignee:e}):Object(a.getTelemetryAPI)().assertConditionTag(!1,"Selected Task Assignee Updated action type is not supported",593826305)},s.getRenderableItemActionBarItems=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!s.renderableItemActionBarItems||void 0===s.memoGetActionBarItems)throw new o.StructuredError("Function should not be called when DeleteRestricted gate is off.",o.TelemetryTag.reserveTag(557601691));return s.memoGetActionBarItems.apply(s,Object(r.__spreadArray)([s.renderableItemActionBarItems],Object(r.__read)(e),!1))},s.getCardContextualMenuItems=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!s.cardContextMenuItems||void 0===s.memoGetCardContextualMenuItems)throw new o.StructuredError("Function should not be called when DeleteRestricted gate is off.",o.TelemetryTag.reserveTag(557601692));return s.memoGetCardContextualMenuItems.apply(s,Object(r.__spreadArray)([s.cardContextMenuItems],Object(r.__read)(e),!1))},s.onCardMounted=function(e){j.cardOnMount({cardProps:e,componentTree:s.props.componentTree,focusManager:s.props.focusManager})},s.onCardEditorMounted=function(e){j.cardOnEditorMount({cardId:e,componentTree:s.props.componentTree,focusManager:s.props.focusManager})},s.onPostMounted=function(e){j.postOnMount({postId:e,componentTree:s.props.componentTree,focusManager:s.props.focusManager})},s.onPostEditorMounted=function(e){j.postOnEditorMount({postId:e,componentTree:s.props.componentTree,focusManager:s.props.focusManager})},s.notifyRenderedOnce=Object(i.once)((function(){s.props.onInitialRender({renderContextType:s.props.componentTree.componentTreeId.renderContextType})})),s.onPostError=function(e){j.postOnError({trackback:o.TelemetryTag.reserveTag(593764372),id:e.getId(),data:s.props.dataItems,renderContextType:s.props.componentTree.componentTreeId.renderContextType,actionDispatchers:s.props,telemetryVisitor:s.props.telemetryVisitor})},s.onClearPostError=function(e){j.postOnClearError({trackback:o.TelemetryTag.reserveTag(593764373),id:e.getId(),data:s.props.dataItems,renderContextType:s.props.componentTree.componentTreeId.renderContextType,actionDispatchers:s.props,telemetryVisitor:s.props.telemetryVisitor})},s.onLowFidelityWarningCancel=function(){j.onLowFidelityWarningCancel({selectedState:s.props.selectedComment,renderContextType:s.props.componentTree.componentTreeId.renderContextType,dispatchProps:s.props,telemetryVisitor:s.props.telemetryVisitor})},s.onLowFidelityWarningConfirm=function(){j.onLowFidelityWarningConfirm({selectedState:s.props.selectedComment,onCardDelete:s.cardOnDelete,onPostDelete:s.onPostDelete,onPostEdit:s.onPostEdit})},s.commentEditorOnKeyDown=function(e){s.commentEditorKeyDownHandler.onKeyDown(e)},s.startNewCommentSession=function(){s.props.discardDraftAndStartNewCommentSession({renderContextType:s.props.componentTree.componentTreeId.renderContextType,trackback:o.TelemetryTag.reserveTag(593826323),telemetryVisitor:s.props.telemetryVisitor})},s.closePane=s.closePane.bind(s),s.onCommentUIAction=s.onCommentUIAction.bind(s),s.onMentionCreated=s.onMentionCreated.bind(s),s.onMentioneesStillInDraftUpdated=s.onMentioneesStillInDraftUpdated.bind(s),s.renderCommentThread=s.renderCommentThread.bind(s),s.onGhostCommentClicked=s.onGhostCommentClicked.bind(s),s.invokeModalDialog=s.invokeModalDialog.bind(s),s.deleteThreadConfirmCallback=s.deleteThreadConfirmCallback.bind(s),s.getOnWillDiscardCallback=s.getOnWillDiscardCallback.bind(s),s.isReadyToRender=s.isReadyToRender.bind(s),s.commentPostCallbackProps={onDelete:s.onPostDelete,onEdit:s.onPostEdit,onCommit:s.onPostCommit,onCancel:s.onPostCancel,onSelect:s.onRenderableItemSelect,onDraftEmptinessChanged:s.onPostDraftEmptinessChanged,onSaveDraft:s.onPostSaveDraft,onLowFidelityWarningConfirm:s.onLowFidelityWarningConfirm,onLowFidelityWarningCancel:s.onLowFidelityWarningCancel,onPostMounted:s.onPostMounted,onPostEditorMounted:s.onPostEditorMounted,onError:s.onPostError,onClearError:s.onClearPostError,commentEditorAdditionalKeyDownHandler:s.commentEditorOnKeyDown,onCollapseParent:s.onPostCollapseParent,onFocusParent:s.onPostFocusParent,onReactionUpdated:s.onPostReactionUpdated,onPresentLinkToComment:s.onPresentLinkToComment},s.commentCardCallbackProps={onEditorPress:s.cardOnBeginReplyCallback,onCardCollapse:s.cardOnCollapseCallback,onCardSelect:s.cardOnSelectCallback,onCardSelectExpand:s.cardOnSelectExpandCallback,onCardFocus:s.cardOnFocusCallback,onCardHighlightChange:s.cardOnHighlight,onDraftingInputSizeChange:s.cardOnDraftingInputSizeChange,onDraftEmptinessChanged:s.cardOnDraftEmptinessChanged,onEditorBlur:s.cardOnEditorFocusLost,onCancel:s.onCardCancel,onPost:s.onCardPost,onSaveDraft:s.cardOnSaveDraft,onSelectedTaskAssigneeUpdated:s.onSelectedTaskAssigneeUpdated,onCardMounted:s.onCardMounted,onCardEditorMounted:s.onCardEditorMounted,onCardRendered:s.notifyRenderedOnce,onLowFidelityWarningCancel:s.onLowFidelityWarningCancel,onLowFidelityWarningConfirm:s.onLowFidelityWarningConfirm,onTaskTopperCheckboxPressed:s.onTaskTopperCheckboxPressed,commentEditorAdditionalKeyDownHandler:s.commentEditorOnKeyDown,onReactionUpdated:s.onPostReactionUpdated,onEditRootPost:s.onPostEdit},s.cardContextualMenuCallbackProps={onReopenThread:s.cardOnReopenThread,onResolveThread:s.cardOnResolveThread,onDeleteThread:s.cardOnDelete,onEditRootPost:s.onPostEdit,onPresentLinkToComment:s.onPresentLinkToComment},s.renderableItemActionBarItems=K.getRenderableItemActionBarItems(s.props.localizationAPI,s.commentPostCallbackProps),s.cardContextMenuItems=K.getCardContextMenuItems(s.props.localizationAPI,s.cardContextualMenuCallbackProps),s.paneContainerKeyDownHandler=s.props.focusManager.paneContainerKeyDown((function(){return s.props.componentTree})),s.commentContentsKeyDownHandler=s.props.focusManager.commentContentsKeyDown((function(){return s.props.componentTree}),(function(){return s.props.dataItems})),s.commentEditorKeyDownHandler=s.props.focusManager.commentEditorKeyDown((function(){return s.props.componentTree}));var l=Object(a.getTelemetryAPI)().createActivityObject("BaseCommentPaneConstruction",s.props.telemetryVisitor,a.ActivityAggregationMode.None,a.ActivityDiagnosticLevel.NecessaryServiceDataEvent);return l.addDataField("PaneCorrelationId",s.props.correlationId,a.DataFieldClassification.SystemMetadata),l.addDataField("SharedCommentsVersion",b.default,a.DataFieldClassification.SystemMetadata),l.addDataField("RenderContextType",s.props.componentTree.componentTreeId.renderContextType,a.DataFieldClassification.SystemMetadata),l.successTag(593826206),s}return Object(r.__extends)(t,e),t.prototype.onCommentUIAction=function(e){return e.actionType===d.CommentUIAction.BackKeyPressed?(Object(a.getTelemetryAPI)().assertConditionTag(Object(m.isExecuteAction)(e.actionBehavior),"This action type does not support toggled/enabled status",593826207),Object(m.isExecuteAction)(e.actionBehavior)&&this.onBackKeyPressed(),m.CommentActionCallbackResult.Success):m.CommentActionCallbackResult.NotHandled},t.prototype.getOnWillDiscardCallback=function(e){var t=this;return Object(T.getDiscardDraftBehavior)(this.props.draftState)===k.DraftDiscardBehavior.CannotAutoDiscard?function(n,r){return t.invokeModalDialog(e,n,r)}:void 0},t.prototype.updateDraftRenderLocks=function(e){0!==Object(P.getDraftCount)(this.props.draftState)&&this.props.updateRenderLocksForAllDrafts({renderContextType:this.props.componentTree.componentTreeId.renderContextType,trackback:o.TelemetryTag.reserveTag(593826211),telemetryVisitor:this.props.telemetryVisitor},e)},t.prototype.componentDidMount=function(){var e,t;null===(t=(e=this.props).componentRef)||void 0===t||t.call(e,this),this.props.registerComponentUIActionListener(this.onCommentUIAction),this.props.registerComponentInterruptableCommandListener(this.onCommentInterruptableCommand),Object(S.getAtMentionCapabilityState)(this.props.modelCapabilities,this.props.atMentionState_deprecated)!==u.AtMentionCapabilityState.Unknown&&this.processAtMentionCapabilityState(),this.updateDraftRenderLocks(!0),g.isHeadlessBootEnabled()&&this.props.lastContextChangeIncrement>0&&this.onContextChanged()},t.prototype.componentWillUnmount=function(){this.props.unregisterComponentUIActionListener(this.onCommentUIAction),this.props.unregisterComponentInterruptableCommandListener(this.onCommentInterruptableCommand)},t.prototype.componentDidUpdate=function(e,t){var n,o;if(this.props.lastContextChangeIncrement!==e.lastContextChangeIncrement&&this.onContextChanged(),Object(S.getAtMentionCapabilityState)(this.props.modelCapabilities,this.props.atMentionState_deprecated)!==Object(S.getAtMentionCapabilityState)(e.modelCapabilities,e.atMentionState_deprecated)&&this.processAtMentionCapabilityState(),this.sendReadyToRenderNotification(e),this.props.draftState!==e.draftState)try{for(var i=Object(r.__values)(Object(P.getDraftIds)(this.props.draftState)),a=i.next();!a.done;a=i.next()){var s=a.value;if(this.props.draftState.drafts[s].renderContextType!==this.props.componentTree.componentTreeId.renderContextType&&(void 0===e.draftState.drafts[s]||e.draftState.drafts[s].renderContextType!==this.props.draftState.drafts[s].renderContextType)){this.updateDraftRenderLocks(!0);break}}}catch(l){n={error:l}}finally{try{a&&!a.done&&(o=i.return)&&o.call(i)}finally{if(n)throw n.error}}this.props.focusManager.commentPanePropsUpdated(this.props.componentTree,e,this.props)},t.prototype.focus=function(){this.props.focusManager.focusCommentPaneCommand(this.props.componentTree)},t.prototype.getInstanceId=function(){var e;return null!==(e=this.props.componentInstanceId)&&void 0!==e?e:"CommentPane"},t.prototype.getRenderableItemFromRef=function(e){var t=Object(S.getSingleCreateDraftId)(this.props.draftState,!0,this.props.componentTree.componentTreeId.renderContextType),n=e.getId();return n===t?this.props.createdCommentLie&&{commentModel:this.props.createdCommentLie.newComment}:this.props.dataItems.find((function(e){return z.getId(e)===n}))},t.prototype.closePane=function(){j.closePane({ownProps:this.props,dispatchProps:this.props,componentTree:this.props.componentTree,draftState:this.props.draftState,invokeModalDialog:this.invokeModalDialog})},t.prototype.renderCommentThread=function(e,t,n){var r,o;void 0===n&&(n=B.renderCommentThread);var i=z.getRootComment(t),a=i.commentId===Object(S.getSingleCreateDraftId)(this.props.draftState,!0,this.props.componentTree.componentTreeId.renderContextType);if(g.shouldRenderDHCInPane())return c.createElement(I.DiscreteCommentCardContainer,{commentAPI:this.props.commentAPI,componentTree:this.props.componentTree,focusManager:this.props.focusManager,localizationAPI:this.props.localizationAPI,peopleAPI:this.props.peopleAPI,resource:{id:i.commentId},getDiscardDraftCallback:this.getOnWillDiscardCallback,telemetryVisitor:this.props.telemetryVisitor,accessibilityPositionInSet:e+1,accessibilitySetSize:this.state.allRenderableItemThreads.length,onInitialRender:this.props.onInitialRender,correlationId:this.props.correlationId,lppManager:this.props.lppManager,componentInstanceId:this.getHostableComponentInstanceId(i.commentId,this.props.componentTree.componentTreeId.renderContextType,a)});var l=0===this.props.dataItems.length||z.getRootComment(this.props.dataItems).commentId===i.commentId,u=this.getMentionableCommentEditorProps(Object(S.getAtMentionCapabilityState)(this.props.modelCapabilities,this.props.atMentionState_deprecated),this.props.suggestionsDetails),d=i.commentId,p=Object(P.draftsExistOrPending)(this.props.draftState),f=p||this.props.readOnly?E.AllowedDraftingSession.None:E.AllowedDraftingSession.Any,h=null===(r=this.props.tasks[d])||void 0===r?void 0:r.currentState,m=this.props.componentTree.componentTreeId.renderContextType===w.default.HalfPane&&!!Object(S.getSingleDraftPostId)(this.props.draftState),y=this.props.highlightedCommentId||W(this.props),b=this.getPinnedCardIndex_deprecated(),v=this.getThreadPostOrHistoryRecordStates()[b&&!g.isMobileFocusFixEnabled()?b:e],C=(null===(o=this.props.selectedComment)||void 0===o?void 0:o.selectedCardId)===d?this.props.selectedComment:void 0,T=Object(_.getCardCollapsedState)(i.commentId,this.props.expandedComments,this.props.componentTree.componentTreeId.renderContextType);return n({thread:t,renderContextType:this.props.componentTree.componentTreeId.renderContextType,cardState:this.props.cardViewStates[d],postCallbacks:this.commentPostCallbackProps,mentionableEditorProps:u,cardCallbacks:this.commentCardCallbackProps,localizationAPI:this.props.localizationAPI,getActionBarItems:this.getRenderableItemActionBarItems,selectedState:C,isolationEdit:m,isAtMentionEnabled:!!u,areTasksEnabled:Object(S.checkTasksEnablement)(this.props.modelCapabilities),isDraftThread:a,foldableLayoutState:this.props.foldableLayoutState,isCommentsContextReadOnly:this.props.readOnly,keyboardingOptions:this.getKeyboardingOptions(),personaIconPropertiesMap:this.props.personaIconPropertiesMap,draftState:this.props.draftState,cardCollapsedState:T,cardRelativeDraftingState:Object(R.getCardRelativeDraftingState)(i.commentId,this.props.componentTree.componentTreeId.renderContextType,this.props.draftState),accessibilityPositionInSet:e+1,accessibilitySetSize:this.state.allRenderableItemThreads.length,maximumDimensions:void 0,getCardContextualMenuItems:this.getCardContextualMenuItems,mentionEditorProps:u,availableScreenHeight:this.getAvailableScreenHeight(),extraPaddingLeft:this.getContentExtraPaddingLeft(),extraPaddingRight:this.getContentExtraPaddingRight(),preventDefaultKeyDownBehavior:this.getContentsPreventDefaultKeyDownBehavior(),isCardHighlighted:y===d,contentBackgroundColor:this.getContentBackgroundColor(t.length>1,m),maxDraftHeight:this.getMaxDraftHeight(),restrictActionControls_deprecated:p,allowedDraftingSession:f,taskState:h,cardStyle:this.getCommentCardStyle(),onCardLayout:this.onCardLayout,isCardTabbable:B.getCardIsTabbable(this.getKeyboardingOptions().cardTabbingMode,d,l,T,this.props.selectedComment),postOrHistoryRecordStates:v,richTextCapabilities:this.props.modelCapabilities.richTextCapabilities,isUIAAnnotationPatternEnabled:this.props.modelCapabilities.UIAAnnotationPattern,isResolveSupported:Object(S.getResolveSupported)(this.props.modelCapabilities,this.props.capabilities_deprecated.resolve),tabFocusTrapBehavior:s.TabFocusTrapBehavior.Unspecified})},t.prototype.onMentionCreated=function(e){j.onMentionCreated({failTag:o.TelemetryTag.reserveTag(593826271),successTag:o.TelemetryTag.reserveTag(593826272),person:e,dispatchProps:this.props,telemetryVisitor:this.props.telemetryVisitor,renderContextType:this.props.componentTree.componentTreeId.renderContextType,trackback:o.TelemetryTag.reserveTag(593826273)})},t.prototype.onMentioneesStillInDraftUpdated=function(e){j.onMentioneesStillInDraftUpdated({trackback:o.TelemetryTag.reserveTag(593826275),emailsStillInDraft:e,renderContextType:this.props.componentTree.componentTreeId.renderContextType,dispatchProps:this.props,telemetryVisitor:this.props.telemetryVisitor})},t.prototype.onBackKeyPressed=function(){if(Object(P.draftsExist)(this.props.draftState)){var e=Object(D.getCancelModalDialogMode)(this.props.draftState,this.props.componentTree.componentTreeId.renderContextType),t=Object(L.shouldClosePaneAfterDiscardDraft)(!0,this.props.componentTree.componentTreeId.renderContextType,this.props.draftState,this.props.selectedComment,this.props.selectedThreadIdBeforeCommentSession),n=Object(S.getSingleDraftCardId)(this.props.draftState),r=Object(S.getSingleDraftPostId)(this.props.draftState);if(n){var i=Object(T.getDiscardDraftBehavior)(this.props.draftState)===k.DraftDiscardBehavior.CannotAutoDiscard;j.cardOnDraftingCancel({trackback:o.TelemetryTag.reserveTag(592840781),showDiscardDialog:i,invokeModalDialog:this.invokeModalDialog,componentTree:this.props.componentTree,dispatchProps:this.props,closeOnDiscard:t,cardId:n,draftState:this.props.draftState,telemetryVisitor:this.props.telemetryVisitor,localizationAPI:this.props.localizationAPI,focusManager:this.props.focusManager,lieIndex:z.getIndexOfThreadById(this.state.allRenderableItemThreads,n)})}else r&&j.postOnCancel({trackback:o.TelemetryTag.reserveTag(592487364),commentId:r,setContents:void 0,data:this.props.dataItems,draftState:this.props.draftState,shouldClosePaneAfterDiscardDraft:t,onWillDiscardCallback:this.getOnWillDiscardCallback(e),renderContextType:this.props.componentTree.componentTreeId.renderContextType,dispatchProps:this.props,telemetryVisitor:this.props.telemetryVisitor,localizationAPI:this.props.localizationAPI})}else this.props.componentTree.componentTreeId.renderContextType===w.default.HalfPane&&j.closePane({ownProps:this.props,dispatchProps:this.props,componentTree:this.props.componentTree,draftState:this.props.draftState,invokeModalDialog:this.invokeModalDialog})},t.prototype.sendReadyToRenderNotification=function(e){this.props.initializationStatus===A.default.Initialized&&(this.props.componentTree.componentTreeId.renderContextType===e.componentTree.componentTreeId.renderContextType&&this.props.initializationStatus===e.initializationStatus||this.props.readyToRender({renderContextType:this.props.componentTree.componentTreeId.renderContextType,telemetryVisitor:this.props.telemetryVisitor,trackback:o.TelemetryTag.reserveTag(593826313)}))},t.prototype.deleteThreadConfirmCallback=function(){return this.props.selectedComment?(this.props.requestDeleteThread({renderContextType:this.props.componentTree.componentTreeId.renderContextType,telemetryVisitor:this.props.telemetryVisitor,trackback:o.TelemetryTag.reserveTag(593826314)},this.props.selectedComment.selectedCardId),f.InterruptableCommandResult.Handled):(Object(a.getTelemetryAPI)().assertConditionTag(!1,"Selected Comment should not be undefined for DeleteThread",593826315),f.InterruptableCommandResult.Unhandled)},t.prototype.processAtMentionCapabilityState=function(){var e=Object(S.getAtMentionCapabilityState)(this.props.modelCapabilities,this.props.atMentionState_deprecated);e!==u.AtMentionCapabilityState.Unknown&&this.initialAtMentionCapability.set(e)},t.prototype.getUpdatedItemThreads=function(e){var t=Object(M.isThreadLieInAnotherRenderContextType)(this.props.draftState,this.props.componentTree.componentTreeId.renderContextType),n=Object(M.isThreadLieInAnotherRenderContextType)(e.draftState,e.componentTree.componentTreeId.renderContextType);return this.props.dataItems!==e.dataItems||this.props.createdCommentLie!==e.createdCommentLie||this.props.cardViewStates!==e.cardViewStates||this.props.componentTree.componentTreeId.renderContextType!==e.componentTree.componentTreeId.renderContextType||this.props.personaIconPropertiesMap!==e.personaIconPropertiesMap||t!==n?z.getAllRenderableItemThreads(e.dataItems,e.cardViewStates,e.createdCommentLie,e.componentTree.componentTreeId.renderContextType!==w.default.HalfPane,n):this.state.allRenderableItemThreads},t.prototype.getInitialState=function(e){return{allRenderableItemThreads:z.getAllRenderableItemThreads(e.dataItems,e.cardViewStates,e.createdCommentLie,e.componentTree.componentTreeId.renderContextType!==w.default.HalfPane,Object(M.isThreadLieInAnotherRenderContextType)(e.draftState,e.componentTree.componentTreeId.renderContextType)),atMentionState:void 0}},t.prototype.onRequestLoadThreads=function(e){Object(S.getVirtualizedState)(this.props.modelCapabilities,this.props.virtualized_deprecated)?this.props.queueLoadThreads({renderContextType:this.props.componentTree.componentTreeId.renderContextType,telemetryVisitor:this.props.telemetryVisitor,trackback:o.TelemetryTag.reserveTag(593826320)},e):Object(a.getTelemetryAPI)().assertConditionTag(!1,"onRequestLoadThreads called for non-virtualized store",593826321)},t.prototype.shouldShowGhostComment=function(){return this.props.componentTree.componentTreeId.renderContextType===w.default.FullPane&&this.props.nextPopulatedContextDetails!==h.NextPopulatedContextDetails.Unknown&&this.props.nextPopulatedContextDetails!==h.NextPopulatedContextDetails.NoComments&&this.props.nextPopulatedContextDetails!==h.NextPopulatedContextDetails.OnlyCommentsInCurrent},t.prototype.onGhostCommentClicked=function(){var e=this,t=g.isExtendedDraftingEnabled(),n=t&&!g.shouldUseNewSelectionInteractions()||!t&&"web"!==Object(U.getPlatform)();this.props.discardDraftIfEmpty({renderContextType:this.props.componentTree.componentTreeId.renderContextType,telemetryVisitor:this.props.telemetryVisitor,trackback:o.TelemetryTag.reserveTag(590955266)},C.default.SharedComments,n?x.DraftWarningReason.GhostCard:void 0).then((function(t){n&&t.draftDiscardBehavior!==k.DraftDiscardBehavior.NoDraft&&t.draftDiscardResult!==f.InterruptableCommandResult.Handled||e.props.selectionManager.selectAcrossContexts(l.SelectDirection.Next,e.props.componentTree.componentTreeId.renderContextType)})).catch(Object(y.makeAssertErrorHandler)(o.TelemetryTag.reserveTag(590955267)))},t.prototype.isReadyToRender=function(){var e=Object(S.getVirtualizedState)(this.props.modelCapabilities,this.props.virtualized_deprecated);return Object(O.readyToRender)({commentData:z.getCommentModelsFromRenderableItems(this.props.dataItems),pendingCommentLoad:this.props.pendingCommentLoad,virtualized:e})},t.prototype.canCardDelete=function(e){return!0},t.prototype.shouldCheckForLowFidelityOnCardDelete=function(){return!1},t.prototype.render=function(){return g.isLPPManagerContextEnabled()?c.createElement(H.LPPManagerContext.Provider,{value:this.props.lppManager},c.createElement(F.ComponentTreeIdContext.Provider,{value:this.props.componentTree.componentTreeId},this.renderInner())):c.createElement(F.ComponentTreeIdContext.Provider,{value:this.props.componentTree.componentTreeId},this.renderInner())},t}(c.Component);t.default=V},32941:function(e,t,n){"use strict";n.r(t),n.d(t,"makeMapStateToProps",(function(){return u})),n.d(t,"DiscreteCommentCardContainer",(function(){return d}));var r=n(25301),o=n(30997),i=n(31300),a=n(32942),s=n(32944),l=n(31308),c=n(31394),u=function(){var e,t=a.makeGetDraftThreadCommentDraftState(),n=a.makeGetCommittedThreadIdFromResourceId(),r=a.makeGetThreadWithCommentDraft((function(e){return i.getCreatedCommentLie(e,!0)}),(function(e){return i.getDraftThreadId(e,!0)}),t,n),s=a.makeGetIsFirstCardInCurrentContext(r),c=a.makeGetThreadPostStates(r),u=a.makeGetSelectedState(),d=a.makeGetIsHighlighted(),p=a.makeGetCardState(),f=a.makeGetCardRelativeDraftingState(),h=a.makeGetTaskItemForThread(),m=a.makeGetRenderableItems(r,h),y=a.makeGetHistoryRecordStates(h);return function(t,n){if(n.isVirtualized&&e)return e;var a=r(t,n),g=o.areCommentTasksEnabled()?h(t,n):void 0,b=a.thread[0].commentId;return e={threadId:b,dataItems:m(t,n),threadTaskState:g&&g.currentState,threadPostStates:c(t,n),historyRecordViewStates:y(t,n),selectedState:u(t,n),cardCollapsedState:Object(l.getCardCollapsedState)(b,i.getExpandedComments(t),n.componentTree.componentTreeId.renderContextType),readOnly:i.getIsReadOnly(t),cardState:p(t,n),isHighlighted:d(t,n),personaIconPropertiesMap:i.getPersonaIconPropertiesMap(t),isDraftThread:a.isDraftThread,atMentionState_deprecated:i.getAtMentionState_deprecated(t),draftState:i.getDraftState(t),firstCardInCurrentContext:s(t,n),cardRelativeDraftingState:f(t,n),capabilities_deprecated:i.getCapabilities_deprecated(t),modelCapabilities:i.getModelCapabilities(t),suggestionsDetails:i.getSuggestionsDetails(t),virtualized_deprecated:i.getVirtualized_deprecated(t)}}},d=Object(r.connect)(u,c.getDiscreteCommentCardDispatchProps)(s.default)},32942:function(e,t,n){"use strict";n.r(t),n.d(t,"makeGetCardState",(function(){return y})),n.d(t,"makeGetIsHighlighted",(function(){return g})),n.d(t,"makeGetSelectedState",(function(){return b})),n.d(t,"makeGetCardRelativeDraftingState",(function(){return v})),n.d(t,"makeGetCommittedThreadIdFromResourceId",(function(){return C})),n.d(t,"makeGetDraftThreadCommentDraftState",(function(){return T})),n.d(t,"makeGetThreadWithCommentDraft",(function(){return O})),n.d(t,"makeGetThreadPostStates",(function(){return S})),n.d(t,"makeGetHistoryRecordStates",(function(){return P})),n.d(t,"makeGetIsFirstCardInCurrentContext",(function(){return I})),n.d(t,"makeGetContentState",(function(){return E})),n.d(t,"makeIsResourceAvailable",(function(){return A})),n.d(t,"getContentExtensions",(function(){return k})),n.d(t,"makeGetTaskItemForThread",(function(){return w})),n.d(t,"makeGetRenderableItems",(function(){return _})),n.d(t,"makeGetIsDraftThread",(function(){return R}));var r=n(30888),o=n(32943),i=n(10553),a=n(31385),s=n(31386),l=n(31302),c=n(31281),u=n(31300),d=n(31304);function p(){return f||(f=Object(i.createSelectorCreator)(i.defaultMemoize,o.default)),f}var f=void 0,h=function(e,t){var n,r;return null!==(r=null===(n=t.resource)||void 0===n?void 0:n.id)&&void 0!==r?r:""},m=function(e,t){return t.componentTree.componentTreeId.renderContextType},y=function(){return Object(i.createSelector)([h,u.getCardViewStates],(function(e,t){return t[e]}))},g=function(){return Object(i.createSelector)([h,u.getHighlightedCommentId],(function(e,t){return t===e}))},b=function(){return p()([h,u.getSelectedComment],(function(e,t){return(null==t?void 0:t.selectedCardId)===e?t:void 0}))},v=function(){return Object(i.createSelector)([h,m,u.getDraftState],(function(e,t,n){return Object(a.getCardRelativeDraftingState)(e,t,n)}))},C=function(){return Object(i.createSelector)([h,u.getCommentThreadData,u.getCardViewStates],(function(e,t,n){return Object(s.tryGetCommittedThreadId)(e,t,n)}))},T=function(){return Object(i.createSelector)([h,u.getDraftState],(function(e,t){return t.drafts[e]}))},O=function(e,t,n,r){return Object(i.createSelector)([h,u.getCommentData,u.getCardPostIds,r,e,n,t],(function(e,t,n,r,o,i,a){return Object(s.getThreadWithCommentDraft)(e,t,n,r,o,i,a)}))},S=function(e){return p()([e,u.getPostViewStates],(function(e,t){return e.thread.reduce((function(e,n){return e[n.commentId]=t[n.commentId],e}),{})}))},P=function(e){return p()([e,d.getHistoryRecordViewStates],(function(e,t){var n={};return e&&e.history.forEach((function(r){r.records.forEach((function(r){var o=l.createRenderableHistoryItemId(e.id,r.recordId);n[o]=t[o]}))})),n}))},x=function(e){var t;return Object(c.isMapBasedStoreState)(e.commentState)?e.commentState.commentThreadIds[0]:null===(t=e.commentState.commentData[0])||void 0===t?void 0:t.commentId},I=function(e){return Object(i.createSelector)([h,x,u.getHasComments,e],(function(e,t,n,r){return n?e===t:!!r.draftThreadState}))},E=function(e,t){return Object(i.createSelector)([h,e,u.getDraftState,m,t],(function(e,t,n,r,o){return Object(s.getContentState)(e,t,n,r,o)}))},A=function(e){return Object(i.createSelector)([e],(function(e){return Object(r.isEnabledContentState)(e)}))},k=function(e){return e.contentExtensions},w=function(){return Object(i.createSelector)([h,d.getTasks],(function(e,t){return t[e]}))},_=function(e,t){return p()([e,t],(function(e,t){return Object(l.mergeThreadWithTaskItem)(e.thread,t)}))},R=function(){return Object(i.createSelector)([h,u.getDraftState],(function(e,t){return t.cardIdToDraftIdMap[e]===e}))}},32943:function(e,t,n){"use strict";n.r(t);var r=n(4604);t.default=function(e,t){return Object(r.default)(e,t)}},32944:function(e,t,n){"use strict";n.r(t);var r=n(562),o=n(245),i=n(32945),a=n(33154),s=function(e){function t(t){var n=e.call(this,t)||this;return n.rootRef=o.createRef(),n.componentTree=n.props.componentTree,n}return Object(r.__extends)(t,e),t.prototype.componentDidMount=function(){this.props.focusManager.discreteCommentCardRootRefMounted(this.rootRef),e.prototype.componentDidMount.call(this)},t.prototype.getContentsPreventDefaultKeyDownBehavior=function(){},t.prototype.renderThread=function(e){var t=Object(a.getStyles)(e.props.id,this.props.selectedState).cardContainer;return o.createElement("div",{ref:this.rootRef,className:t,onKeyDown:this.commentContentsKeyDownHandler.onKeyDown},e)},t}(i.BaseDiscreteCommentCard);t.default=s},32945:function(e,t,n){"use strict";n.r(t),n.d(t,"BaseDiscreteCommentCard",(function(){return A}));var r=n(562),o=n(3e4),i=n(30010),a=n(31370),s=n(30061),l=n(245),c=n(31260),u=n(31041),d=n(30997),p=n(31187),f=n(31257),h=n(31259),m=n(32946),y=n(31289),g=n(31040),b=n(32947),v=n(31408),C=n(32948),T=n(32961),O=n(33151),S=n(33152),P=n(31110),x=n(31302),I=n(33153),E=n(31303),A=function(e){function t(t){var n=e.call(this,t)||this;return n.memoGetActionBarItems=Object(i.memoize)(I.getActionBarItems,20,(function(){Object(s.getTelemetryAPI)().assertConditionTag(!1,"Cache invalidated, memoization or parameters configured incorrectly?",557875360)})),n.memoGetCardContextualMenuItems=Object(i.memoize)(I.getCardContextualMenuItems,20,(function(){Object(s.getTelemetryAPI)().assertConditionTag(!1,"Cache invalidated, memoization or parameters configured incorrectly?",557875361)})),n.getMentionableCommentEditorProps=Object(i.memoizeOnce)((function(e,t){if(e===c.AtMentionCapabilityState.Enabled)return{onMentionCreated:n.onMentionCreated,onMentioneesStillInDraftUpdated:n.onMentioneesStillInDraftUpdated,getAuthToken:n.getAuthToken,correlationId:n.props.correlationId,lppManager:n.props.lppManager,suggestionsDetails:t}})),n.getRenderableItemActionBarItems=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!n.renderableItemActionBarItems||void 0===n.memoGetActionBarItems)throw new o.StructuredError("Function should not be called when DeleteRestricted gate is off.",o.TelemetryTag.reserveTag(557601689));return n.memoGetActionBarItems.apply(n,Object(r.__spreadArray)([n.renderableItemActionBarItems],Object(r.__read)(e),!1))},n.getCardContextualMenuItems=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!n.cardContextMenuItems||void 0===n.memoGetCardContextualMenuItems)throw new o.StructuredError("Function should not be called when DeleteRestricted gate is off.",o.TelemetryTag.reserveTag(557601690));return n.memoGetCardContextualMenuItems.apply(n,Object(r.__spreadArray)([n.cardContextMenuItems],Object(r.__read)(e),!1))},n.onPostDelete=function(e){v.postOnDelete({trackback:o.TelemetryTag.reserveTag(593826139),id:e,data:n.props.dataItems,selectedComment:n.props.selectedState,renderContextType:n.props.componentTree.componentTreeId.renderContextType,actionDispatchers:n.props,telemetryVisitor:n.props.telemetryVisitor,localizationAPI:n.props.localizationAPI})},n.onPostEdit=function(e){v.postOnEdit({trackback:o.TelemetryTag.reserveTag(593801875),id:e,data:n.props.dataItems,selectedComment:n.props.selectedState,renderContextType:n.props.componentTree.componentTreeId.renderContextType,actionDispatchers:n.props,telemetryVisitor:n.props.telemetryVisitor})},n.onPostCommit=function(e,t){v.postOnCommit({trackback:o.TelemetryTag.reserveTag(593826141),id:e.getId(),data:n.props.dataItems,draftState:n.props.draftState,contentPromise:e.getContentsAsync(),atMentionsEnabled:Object(h.getAtMentionCapabilityState)(n.props.modelCapabilities,n.props.atMentionState_deprecated)===c.AtMentionCapabilityState.Enabled,componentTree:n.props.componentTree,actionDispatchers:n.props,telemetryVisitor:n.props.telemetryVisitor,commitSource:t,localizationAPI:n.props.localizationAPI}).catch(Object(u.makeAssertErrorHandler)(o.TelemetryTag.reserveTag(593826142)))},n.onPostDraftEmptinessChanged=function(e,t){v.onDraftEmptinessChanged({trackback:o.TelemetryTag.reserveTag(592041679),contentId:e.getId(),isEmpty:t,renderContextType:n.props.componentTree.componentTreeId.renderContextType,draftIdMap:n.props.draftState.postIdToDraftIdMap,actionDispatchers:n.props,telemetryVisitor:n.props.telemetryVisitor})},n.onPostSaveDraft=function(e,t){v.onSaveDraft({trackback:o.TelemetryTag.reserveTag(592720402),id:e,editor:t,renderContextType:n.props.componentTree.componentTreeId.renderContextType,draftIdMap:n.props.draftState.postIdToDraftIdMap,draftMap:n.props.draftState.drafts,actionDispatchers:n.props,telemetryVisitor:n.props.telemetryVisitor})},n.onPostCancel=function(e){v.postOnCancel({trackback:o.TelemetryTag.reserveTag(593826145),commentId:e.getId(),setContents:e.setContents.bind(e),data:n.props.dataItems,draftState:n.props.draftState,shouldClosePaneAfterDiscardDraft:!1,onWillDiscardCallback:void 0,renderContextType:n.props.componentTree.componentTreeId.renderContextType,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor,localizationAPI:n.props.localizationAPI})},n.onLowFidelityWarningCancel=function(){v.onLowFidelityWarningCancel({selectedState:n.props.selectedState,renderContextType:n.props.componentTree.componentTreeId.renderContextType,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor})},n.onLowFidelityWarningConfirm=function(){v.onLowFidelityWarningConfirm({selectedState:n.props.selectedState,onCardDelete:n.cardOnDelete,onPostDelete:n.onPostDelete,onPostEdit:n.onPostEdit})},n.onPostReactionUpdated=function(e,t,r){v.onReactionsUpdated(o.TelemetryTag.reserveTag(587994052),e,t,n.props.componentTree.componentTreeId.renderContextType,n.props,n.props.telemetryVisitor,r)},n.onPresentLinkToComment=function(e){v.onPresentLinkToComment(o.TelemetryTag.reserveTag(578852485),e,n.props.componentTree.componentTreeId.renderContextType,n.props,n.props.telemetryVisitor)},n.onRenderableItemSelect=function(e,t){var r=n.getRenderableItemFromRef(e);r?v.renderableItemOnSelect({trackback:o.TelemetryTag.reserveTag(593826147),renderableItem:r,selectedComment:n.props.selectedState,cardCollapsedState:n.props.cardCollapsedState,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor,componentTree:n.props.componentTree,shouldFocusAfter:t,draftState_deprecated:n.props.draftState}).catch(Object(u.makeAssertErrorHandler)(o.TelemetryTag.reserveTag(590123736))):Object(s.getTelemetryAPI)().assertConditionTag(!1,"Comment not rendered within Card. Is something incorrect in the tree?",593826146)},n.onPostCollapse=function(e){var t=n.getRenderableItemFromRef(e);t?v.postOnCollapse(o.TelemetryTag.reserveTag(589940442),t,n.props,n.props.telemetryVisitor,n.props.componentTree):Object(s.getTelemetryAPI)().assertConditionTag(!1,"Collapse from an unknown post?",589940441)},n.onPostFocusParent=function(e){var t=n.getRenderableItemFromRef(e);t?v.postOnFocusParent(t,n.props.componentTree,n.props.focusManager,n.props.draftState):Object(s.getTelemetryAPI)().assertConditionTag(!1,"Focus parent from unknown post?",545867680)},n.cardOnResolveThread=function(e){v.cardOnResolveThread({componentTree:n.props.componentTree,focusManager:n.props.focusManager,trackback:o.TelemetryTag.reserveTag(593826176),id:e,renderContextType:n.props.componentTree.componentTreeId.renderContextType,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor,localizationAPI:n.props.localizationAPI,isTask:!!n.props.threadTaskState})},n.cardOnReopenThread=function(e){v.cardOnReopenThread({trackback:o.TelemetryTag.reserveTag(593826177),id:e,renderContextType:n.props.componentTree.componentTreeId.renderContextType,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor,localizationAPI:n.props.localizationAPI,isTask:!!n.props.threadTaskState})},n.cardOnDelete=function(e){Object(s.getTelemetryAPI)().assertConditionTag(n.props.componentTree.componentTreeId.renderContextType!==g.default.HalfPane,"Discard not yet fully supported for HalfPane in DHC",593826178),v.cardOnDelete({trackback:o.TelemetryTag.reserveTag(592840777),id:e,data:n.props.dataItems,selectedComment:n.props.selectedState,componentTree:n.props.componentTree,invokeModalDialog:void 0,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor,localizationAPI:n.props.localizationAPI,focusManager:n.props.focusManager,isTask:!!n.props.threadTaskState,threadIndex:0,shouldCheckForLowFidelity:n.shouldCheckForLowFidelityOnCardDelete()})},n.cardOnPost=function(e,t){var r=n.props.isDraftThread?{type:"CREATE"}:{type:"REPLY",parentId:e.getId()},i=n.props.draftState.drafts[n.props.draftState.cardIdToDraftIdMap[n.props.threadId]];v.cardOnCommit({trackback:o.TelemetryTag.reserveTag(593622431),commentCardRef:e,draftState:n.props.draftState,areMentionsEnabled:Object(h.getAtMentionCapabilityState)(n.props.modelCapabilities,n.props.atMentionState_deprecated)===c.AtMentionCapabilityState.Enabled,session:r,componentTree:n.props.componentTree,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor,localizationAPI:n.props.localizationAPI,commitSource:t,selectedTaskAssignee:i&&i.selectedTaskAssignee}).catch(Object(u.makeAssertErrorHandler)(o.TelemetryTag.reserveTag(593622432)))},n.cardOnCollapseCallback=function(e){v.cardOnCollapseCallback({trackback:o.TelemetryTag.reserveTag(562918285),commentCardRef:e,renderContextType:n.props.componentTree.componentTreeId.renderContextType,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor})},n.cardOnSelectCallback=function(e){v.cardOnSelectCallback({trackback:o.TelemetryTag.reserveTag(571281792),commentCardRef:e,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor,componentTree:n.props.componentTree,options:{selectActionType:p.SelectActionType.SelectCard}})},n.cardOnSelectExpandCallback=function(e,t,r){v.cardOnSelectCallback({trackback:o.TelemetryTag.reserveTag(571281763),commentCardRef:e,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor,componentTree:n.props.componentTree,options:{selectActionType:p.SelectActionType.ExpandCard,relativeDraftingState:n.props.cardRelativeDraftingState,draftState:n.props.draftState,shouldFocusAfter:r,selectRootPost:t}})},n.cardOnFocusCallback=function(e){v.cardOnFocusCallback({trackback:o.TelemetryTag.reserveTag(571340120),commentCardRef:e,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor,componentTree:n.props.componentTree,options:{selectActionType:p.SelectActionType.Polite},focusManager:n.props.focusManager,isDraftThread:n.props.isDraftThread})},n.cardOnBeginReplyCallback=function(e){v.cardOnBeginReply({trackback:o.TelemetryTag.reserveTag(593826189),threadId:e.getId(),renderContextType:n.props.componentTree.componentTreeId.renderContextType,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor})},n.cardOnHighlight=function(e,t){v.cardOnHighlight({trackback:o.TelemetryTag.reserveTag(593826190),commentCardRef:e,renderContextType:n.props.componentTree.componentTreeId.renderContextType,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor,shouldHighlightCard:t})},n.cardOnDraftingInputSizeChange=function(e,t){v.cardOnDraftingInputSizeChange({trackback:o.TelemetryTag.reserveTag(593826191),focusManager:n.props.focusManager,componentTree:n.props.componentTree,cardId:e.getId(),isCardLie:n.props.isDraftThread,newHeight:t,renderContextType:n.props.componentTree.componentTreeId.renderContextType,selectedComment:n.props.selectedState,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor})},n.cardOnDraftEmptinessChanged=function(e,t){v.onDraftEmptinessChanged({trackback:o.TelemetryTag.reserveTag(592213847),contentId:e.getId(),isEmpty:t,renderContextType:n.props.componentTree.componentTreeId.renderContextType,draftIdMap:n.props.draftState.cardIdToDraftIdMap,actionDispatchers:n.props,telemetryVisitor:n.props.telemetryVisitor})},n.cardOnEditorFocusLost=function(e){v.cardOnEditorFocusLost({trackback:o.TelemetryTag.reserveTag(592065734),id:e.getId(),draftState:n.props.draftState,renderContextType:n.props.componentTree.componentTreeId.renderContextType,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor})},n.cardOnTaskTopperCheckboxPressed=function(){d.areCommentTasksEnabled()&&(n.props.threadTaskState?v.cardOnTaskTopperCheckboxPressed({componentTree:n.props.componentTree,focusManager:n.props.focusManager,trackback:o.TelemetryTag.reserveTag(593826194),id:n.props.threadId,renderContextType:n.props.componentTree.componentTreeId.renderContextType,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor,localizationAPI:n.props.localizationAPI}):Object(s.getTelemetryAPI)().assertConditionTag(!1,"props.threadTaskState is undefined",593826193))},n.cardOnSaveDraft=function(e,t){v.onSaveDraft({trackback:o.TelemetryTag.reserveTag(592720403),id:e,editor:t,renderContextType:n.props.componentTree.componentTreeId.renderContextType,draftIdMap:n.props.draftState.cardIdToDraftIdMap,draftMap:n.props.draftState.drafts,actionDispatchers:n.props,telemetryVisitor:n.props.telemetryVisitor})},n.cardOnCancel=function(e){Object(s.getTelemetryAPI)().assertConditionTag(n.props.isDraftThread||n.props.cardRelativeDraftingState===y.CardRelativeDraftingState.InCard,"Mismatch between selectedComment state and cancel reply callback.",593826196),v.cardOnDraftingCancel({trackback:o.TelemetryTag.reserveTag(592840778),showDiscardDialog:!1,invokeModalDialog:void 0,componentTree:n.props.componentTree,dispatchProps:n.props,closeOnDiscard:!1,cardId:n.props.threadId,draftState:n.props.draftState,telemetryVisitor:n.props.telemetryVisitor,localizationAPI:n.props.localizationAPI,focusManager:n.props.focusManager,lieIndex:0})},n.commentEditorOnKeyDown=function(e){n.commentEditorKeyDownHandler.onKeyDown(e)},n.onPostError=function(e){v.postOnError({trackback:o.TelemetryTag.reserveTag(593764370),id:e.getId(),data:n.props.dataItems,renderContextType:n.props.componentTree.componentTreeId.renderContextType,actionDispatchers:n.props,telemetryVisitor:n.props.telemetryVisitor})},n.onClearPostError=function(e){v.postOnClearError({trackback:o.TelemetryTag.reserveTag(593764371),id:e.getId(),data:n.props.dataItems,renderContextType:n.props.componentTree.componentTreeId.renderContextType,actionDispatchers:n.props,telemetryVisitor:n.props.telemetryVisitor})},n.onCardMounted=function(e){v.cardOnMount({cardProps:e,componentTree:n.props.componentTree,focusManager:n.props.focusManager})},n.onCardEditorMounted=function(e){v.cardOnEditorMount({cardId:e,componentTree:n.props.componentTree,focusManager:n.props.focusManager})},n.onPostMounted=function(e){v.postOnMount({postId:e,componentTree:n.props.componentTree,focusManager:n.props.focusManager})},n.onPostEditorMounted=function(e){v.postOnEditorMount({postId:e,componentTree:n.props.componentTree,focusManager:n.props.focusManager})},n.onCardRendered=Object(i.once)((function(e){n.props.onInitialRender({commentId:e.id,renderContextType:n.props.componentTree.componentTreeId.renderContextType})})),n.onSelectedTaskAssigneeUpdated=function(e){d.areCommentTasksEnabled()?v.onUpdateSelectedTaskAssignee({trackback:o.TelemetryTag.reserveTag(593826204),renderContextType:n.props.componentTree.componentTreeId.renderContextType,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor,selectedAssignee:e}):Object(s.getTelemetryAPI)().assertConditionTag(!1,"Selected Task Assignee Updated action type is not supported",593826205)},n.getPostOrHistoryRecordStates=Object(i.memoizeOnceWithParams)(C.getPostOrHistoryRecordStates,(function(){return[n.props.dataItems,n.props.threadPostStates,n.props.historyRecordViewStates]})),n.onMentionCreated=n.onMentionCreated.bind(n),n.onMentioneesStillInDraftUpdated=n.onMentioneesStillInDraftUpdated.bind(n),n.getAuthToken=n.getAuthToken.bind(n),n.commentPostCallbackProps={onDelete:n.onPostDelete,onEdit:n.onPostEdit,onCommit:n.onPostCommit,onCancel:n.onPostCancel,onSelect:n.onRenderableItemSelect,onDraftEmptinessChanged:n.onPostDraftEmptinessChanged,onSaveDraft:n.onPostSaveDraft,onLowFidelityWarningConfirm:n.onLowFidelityWarningConfirm,onLowFidelityWarningCancel:n.onLowFidelityWarningCancel,onPostMounted:n.onPostMounted,onPostEditorMounted:n.onPostEditorMounted,onError:n.onPostError,onClearError:n.onClearPostError,commentEditorAdditionalKeyDownHandler:n.commentEditorOnKeyDown,onCollapseParent:n.onPostCollapse,onFocusParent:n.onPostFocusParent,onReactionUpdated:n.onPostReactionUpdated,onPresentLinkToComment:n.onPresentLinkToComment},n.commentCardCallbackProps={onEditorPress:n.cardOnBeginReplyCallback,onCardCollapse:n.cardOnCollapseCallback,onCardSelect:n.cardOnSelectCallback,onCardSelectExpand:n.cardOnSelectExpandCallback,onCardFocus:n.cardOnFocusCallback,onCardHighlightChange:n.cardOnHighlight,onDraftingInputSizeChange:n.cardOnDraftingInputSizeChange,onDraftEmptinessChanged:n.cardOnDraftEmptinessChanged,onEditorBlur:n.cardOnEditorFocusLost,onCancel:n.cardOnCancel,onPost:n.cardOnPost,onSaveDraft:n.cardOnSaveDraft,onSelectedTaskAssigneeUpdated:n.onSelectedTaskAssigneeUpdated,onCardMounted:n.onCardMounted,onCardEditorMounted:n.onCardEditorMounted,onCardRendered:n.onCardRendered,onLowFidelityWarningConfirm:n.onLowFidelityWarningConfirm,onLowFidelityWarningCancel:n.onLowFidelityWarningCancel,onTaskTopperCheckboxPressed:n.cardOnTaskTopperCheckboxPressed,commentEditorAdditionalKeyDownHandler:n.commentEditorOnKeyDown,onReactionUpdated:n.onPostReactionUpdated,onEditRootPost:n.onPostEdit},n.contextualMenuCallbackProps={onReopenThread:n.cardOnReopenThread,onResolveThread:n.cardOnResolveThread,onDeleteThread:n.cardOnDelete,onEditRootPost:n.onPostEdit,onPresentLinkToComment:n.onPresentLinkToComment},n.renderableItemActionBarItems=I.getRenderableItemActionBarItems(n.props.localizationAPI,n.commentPostCallbackProps),n.cardContextMenuItems=I.getCardContextMenuItems(n.props.localizationAPI,n.contextualMenuCallbackProps),n.commentContentsKeyDownHandler=n.props.focusManager.commentContentsKeyDown((function(){return n.props.componentTree}),d.areCommentTasksEnabled()?function(){return n.props.dataItems}:void 0),n.commentEditorKeyDownHandler=n.props.focusManager.commentEditorKeyDown((function(){return n.props.componentTree})),n}return Object(r.__extends)(t,e),t.prototype.focus=function(){this.props.focusManager.focusCommentCardCommand(this.props.componentTree,this.props.threadId),this.props.selectComment(this.props.componentTree,{renderContextType:this.props.componentTree.componentTreeId.renderContextType,trackback:o.TelemetryTag.reserveTag(590205772),telemetryVisitor:this.props.telemetryVisitor},{selectedCard:this.props.threadId,selectType:p.SelectActionType.ExpandCard,source:f.default.Canvas},!1).catch(Object(u.makeAssertErrorHandler)(o.TelemetryTag.reserveTag(590104656)))},t.prototype.getInstanceId=function(){return this.props.componentInstanceId},t.prototype.shouldComponentUpdate=function(e,n){return t.havePropsMeaningfullyChanged(e,this.props)},t.prototype.updateDraftRenderLockIfApplicable=function(e){var t=Object(h.getSingleDraftWithContext)(this.props.draftState);t&&t.threadId===this.props.threadId&&this.props.updateRenderLockForDraft({renderContextType:this.props.componentTree.componentTreeId.renderContextType,trackback:o.TelemetryTag.reserveTag(593826137),telemetryVisitor:this.props.telemetryVisitor},e,t.commentDraft.sessionConfiguration.draftId)},t.prototype.componentDidMount=function(){var e,t,n,r;null===(t=(e=this.props).componentRef)||void 0===t||t.call(e,this),null===(r=(n=this.props).setComponentRef)||void 0===r||r.call(n,this.props.componentInstanceId,this),this.updateDraftRenderLockIfApplicable(!0)},t.prototype.componentWillUnmount=function(){var e,t;null===(t=(e=this.props).setComponentRef)||void 0===t||t.call(e,this.props.componentInstanceId,null)},t.prototype.componentDidUpdate=function(e,t){if(this.props.draftState!==e.draftState){var n=Object(h.getSingleDraftWithContext)(e.draftState),r=Object(h.getSingleDraftWithContext)(this.props.draftState);!r||r.renderContextType===this.props.componentTree.componentTreeId.renderContextType||void 0!==n&&n.renderContextType===r.renderContextType||this.updateDraftRenderLockIfApplicable(!0)}this.props.focusManager.discreteCommentCardPropsUpdated(this.props.componentTree,e,this.props)},t.havePropsMeaningfullyChanged=function(e,t){var n=Object.keys(e),r=Object.keys(t);return n.length!==r.length||n.some((function(n){if(t[n]===e[n])return!1;if("dataItems"===n){if(t.dataItems.length!==e.dataItems.length)return!0;for(var r=0;r<t.dataItems.length;r++){var o=t.dataItems[r],i=e.dataItems[r];if(Object(E.hasRenderableCommentItem)(o)&&Object(E.hasRenderableCommentItem)(i)&&o.commentModel!==i.commentModel||!!o.historyItem!=!!i.historyItem)return!0}return!1}return"object"!=typeof t[n]||!Object(S.areObjectsShallowEqual)(t[n],e[n])}))},t.prototype.getAuthToken=function(){return this.props.peopleAPI.getAuthToken(a.PeopleServiceId.Loki)},t.prototype.getRenderableItemFromRef=function(e){var t=e.getId();return this.props.dataItems.find((function(e){return x.getId(e)===t}))},t.prototype.shouldCheckForLowFidelityOnCardDelete=function(){return!1},t.prototype.getKeyboardingOptions=function(){return{cardTabbingMode:b.CardTabbingMode.ExpandedCardOrFirstCardTabbable,postTabbingMode:b.PostTabbingMode.ExpandedCardRootPostTabbable}},t.prototype.onMentionCreated=function(e){v.onMentionCreated({failTag:o.TelemetryTag.reserveTag(593826199),successTag:o.TelemetryTag.reserveTag(593826200),person:e,dispatchProps:this.props,telemetryVisitor:this.props.telemetryVisitor,renderContextType:this.props.componentTree.componentTreeId.renderContextType,trackback:o.TelemetryTag.reserveTag(593826201)})},t.prototype.onMentioneesStillInDraftUpdated=function(e){v.onMentioneesStillInDraftUpdated({trackback:o.TelemetryTag.reserveTag(593826203),emailsStillInDraft:e,renderContextType:this.props.componentTree.componentTreeId.renderContextType,dispatchProps:this.props,telemetryVisitor:this.props.telemetryVisitor})},t.prototype.renderThread=function(e){return e},t.prototype.onQueueLoadThread=function(){Object(h.getVirtualizedState)(this.props.modelCapabilities,this.props.virtualized_deprecated)&&!this.props.isDraftThread&&this.props.queueLoadThread({renderContextType:this.props.componentTree.componentTreeId.renderContextType,telemetryVisitor:this.props.telemetryVisitor,trackback:o.TelemetryTag.reserveTag(573145492)})},t.prototype.render=function(){var e,t;this.onQueueLoadThread();var n=this.getMentionableCommentEditorProps(Object(h.getAtMentionCapabilityState)(this.props.modelCapabilities,this.props.atMentionState_deprecated),this.props.suggestionsDetails),r=void 0!==this.props.cardRelativeDraftingState,o=r||this.props.readOnly?m.AllowedDraftingSession.None:m.AllowedDraftingSession.Any,i=this.props.dataItems.length>1,a=C.renderCommentThread({thread:this.props.dataItems,renderContextType:this.props.componentTree.componentTreeId.renderContextType,cardState:this.props.cardState,postCallbacks:this.commentPostCallbackProps,mentionableEditorProps:n,cardCallbacks:this.commentCardCallbackProps,localizationAPI:this.props.localizationAPI,getActionBarItems:this.getRenderableItemActionBarItems,selectedState:this.props.selectedState,isolationEdit:this.props.componentTree.componentTreeId.renderContextType===g.default.HalfPane,isAtMentionEnabled:Object(h.getAtMentionCapabilityState)(this.props.modelCapabilities,this.props.atMentionState_deprecated)===c.AtMentionCapabilityState.Enabled,areTasksEnabled:Object(h.checkTasksEnablement)(this.props.modelCapabilities),isDraftThread:this.props.isDraftThread,isCommentsContextReadOnly:this.props.readOnly,keyboardingOptions:this.getKeyboardingOptions(),personaIconPropertiesMap:this.props.personaIconPropertiesMap,draftState:this.props.draftState,cardCollapsedState:this.props.cardCollapsedState,cardRelativeDraftingState:this.props.cardRelativeDraftingState,accessibilitySetSize:this.props.accessibilitySetSize,accessibilityPositionInSet:this.props.accessibilityPositionInSet,accessibilitySetLevel:this.props.accessibilitySetLevel,maximumDimensions:this.props.maximumDimensions,getCardContextualMenuItems:this.getCardContextualMenuItems,mentionEditorProps:n,restrictActionControls_deprecated:r,allowedDraftingSession:o,availableScreenHeight:void 0,contentBackgroundColor:i&&"ios"!==Object(P.getPlatform)()?"CardReplyBackground":"CardBackground",extraPaddingLeft:void 0,extraPaddingRight:void 0,preventDefaultKeyDownBehavior:this.getContentsPreventDefaultKeyDownBehavior(),isCardHighlighted:this.props.isHighlighted,maxDraftHeight:void 0,taskState:this.props.threadTaskState,cardStyle:void 0,onCardLayout:void 0,isCardTabbable:C.getCardIsTabbable(this.getKeyboardingOptions().cardTabbingMode,this.props.threadId,this.props.firstCardInCurrentContext,this.props.cardCollapsedState,this.props.selectedState),postOrHistoryRecordStates:this.getPostOrHistoryRecordStates(),richTextCapabilities:this.props.modelCapabilities.richTextCapabilities,isUIAAnnotationPatternEnabled:this.props.modelCapabilities.UIAAnnotationPattern,isResolveSupported:Object(h.getResolveSupported)(this.props.modelCapabilities,this.props.capabilities_deprecated.resolve),tabFocusTrapBehavior:null===(t=null===(e=this.props)||void 0===e?void 0:e.accessibilityMetadata)||void 0===t?void 0:t.tabFocusTrapBehavior});return d.isLPPManagerContextEnabled()?l.createElement(O.LPPManagerContext.Provider,{value:this.props.lppManager},l.createElement(T.ComponentTreeIdContext.Provider,{value:this.props.componentTree.componentTreeId},this.renderThread(a))):l.createElement(T.ComponentTreeIdContext.Provider,{value:this.props.componentTree.componentTreeId},this.renderThread(a))},t}(l.Component)},32946:function(e,t,n){"use strict";var r;n.r(t),n.d(t,"AllowedDraftingSession",(function(){return r})),function(e){e[e.None=0]="None",e[e.MetadataOnly=1]="MetadataOnly",e[e.Any=2]="Any"}(r||(r={}))},32947:function(e,t,n){"use strict";var r,o;n.r(t),n.d(t,"CardTabbingMode",(function(){return r})),n.d(t,"PostTabbingMode",(function(){return o})),function(e){e[e.AllCardsTabbable=0]="AllCardsTabbable",e[e.ExpandedCardTabbable=1]="ExpandedCardTabbable",e[e.ExpandedCardOrFirstCardTabbable=2]="ExpandedCardOrFirstCardTabbable",e[e.SelectedCardTabbable=3]="SelectedCardTabbable"}(r||(r={})),function(e){e[e.AllPostsTabbable=0]="AllPostsTabbable",e[e.ExpandedCardPostsTabbable=1]="ExpandedCardPostsTabbable",e[e.ExpandedCardRootPostTabbable=2]="ExpandedCardRootPostTabbable",e[e.SelectedPostTabbable=3]="SelectedPostTabbable"}(o||(o={}))},32948:function(e,t,n){"use strict";n.r(t),n.d(t,"areRenderableItemThreadsEqual",(function(){return L})),n.d(t,"isCardSelected",(function(){return F})),n.d(t,"getCardHasPostSelected",(function(){return H})),n.d(t,"isPostSelected",(function(){return U})),n.d(t,"getCardIsTabbable",(function(){return z})),n.d(t,"getPostIsTabbable",(function(){return K})),n.d(t,"getPostRestrictActionControls_deprecated",(function(){return W})),n.d(t,"renderCommentPost",(function(){return V})),n.d(t,"renderHistoryItem",(function(){return G})),n.d(t,"renderCommentCard",(function(){return q})),n.d(t,"renderCommentThread",(function(){return Y})),n.d(t,"getPostDisplayMode",(function(){return X})),n.d(t,"getCardDisplayMode",(function(){return J})),n.d(t,"getRenderableSelectedCommentId",(function(){return $})),n.d(t,"getCommentCardTaskTopperProps",(function(){return Z})),n.d(t,"getPostOrHistoryRecordStates",(function(){return ee}));var r=n(562),o=n(3e4),i=n(30061),a=n(245),s=n(31121),l=n(31109),c=n(30988),u=n(30997),d=n(31399),p=n(31259),f=n(31294),h=n(31295),m=n(31297),y=n(31287),g=n(32946),b=n(31306),v=n(31288),C=n(31289),T=n(32949),O=n(31040),S=n(32950),P=n(32951),x=n(33132),I=n(33146),E=n(32947),A=n(31303),k=n(31293),w=n(33149),_=n(31285),R=n(31038),j=n(31110),D=n(31113),M=n(31302),B=n(31111),N=n(32963);function L(e,t){return e===t||e.length===t.length&&e.every((function(e,n){return M.getId(e[0])===M.getId(t[n][0])}))}function F(e,t){return!!t&&t.selectedCardId===e&&!Object(y.isSelectedPostDetail)(t.selectionDetails)}function H(e,t){return!!t&&t.selectedCardId===e&&Object(y.isSelectedPostDetail)(t.selectionDetails)}function U(e,t){return!!t&&Object(y.isSelectedPostDetail)(t.selectionDetails)&&t.selectionDetails.selectedPostId===e}function z(e,t,n,r,o){switch(e){case E.CardTabbingMode.AllCardsTabbable:return!0;case E.CardTabbingMode.ExpandedCardOrFirstCardTabbable:if(o){var i=F(t,o),a=H(t,o);return i||r===b.default.Expanded&&a}return n;case E.CardTabbingMode.ExpandedCardTabbable:return!!o&&r===b.default.Expanded;case E.CardTabbingMode.SelectedCardTabbable:return!!o&&o.selectedCardId===t}}function K(e,t,n,r,o,i){if(r===T.default.PendingEdit||r===T.default.PendingDraft)return U(t,i);switch(e){case E.PostTabbingMode.AllPostsTabbable:return!0;case E.PostTabbingMode.ExpandedCardPostsTabbable:return o===b.default.Expanded;case E.PostTabbingMode.ExpandedCardRootPostTabbable:var a=U(t,i),s=F(n||t,i);return r!==T.default.New_nonFluent&&(a||s&&o===b.default.Expanded&&!n);case E.PostTabbingMode.SelectedPostTabbable:return U(t,i)}}function W(e,t,n){return b.default.Collapsed===e||void 0!==n&&(n!==C.CardRelativeDraftingState.InChildPost||!t)}function V(e,t,n,o,i,c,d,p,f,m,b,v,C,T,O,S,P,I){var E=e.localizationAPI,A=e.selectedState,k=e.isDraftThread,R=e.isCommentsContextReadOnly,j=e.draftState,D=e.cardCollapsedState,M=!1;A&&Object(y.isSelectedPostDetail)(A.selectionDetails)&&(M=A.selectionDetails.selectedPostId===t.commentId);var B=X(t,n,j,A,o,f,k),N=!!(t.commentFlags&s.CommentFlags.ReadOnly||R),L=n.displayDate||"",F=j.postIdToDraftIdMap[t.commentId],H=F?j.drafts[F]:void 0,U=!!H&&H.renderContextType!==e.renderContextType,z=f&&H?Object(r.__assign)({draftId:F},Object(h.getDraftViewStateFromDraftState)(H)):{};return a.createElement(x.default,Object(r.__assign)({},e.postCallbacks,z,{postDisplayMode:B,isReadOnly:N,id:t.commentId,author:t.author,authorColor:null==c?void 0:c.authorColor,authorImageURL:null==c?void 0:c.authorImageURL,timestamp:L,commentBody:t.commentBody,parent:""===t.parentId,lowFidelityWarningString:M?_.getLowFidelityWarningForPost(E,A):"",selected:M,isTabbable:K(i,t.commentId,t.parentId,B,D,A),supportsAtMentions:e.isAtMentionEnabled,localizationAPI:E,actionBarItems:e.getActionBarItems(B,null==A?void 0:A.selectionDetails.lowFidelityWarningType,O,""===t.parentId,N,t.commentFlags,u.isLinkToCommentEnabled(),u.isCommentsFluentUIEnabled()),accessibilityLabel:w.AccessibilityStringHelpers.getPostA11yLabel(0===t.parentId.length,B,N,E,{author:Object(l.getUsername)(t.author),timestamp:L,repliesCount:d,commentBody:t.commentBody,isReplyPending:p,isUnread:u.isCommentsFluentUIEnabled()&&!!(t.commentFlags&s.CommentFlags.IsNew),anchorHintText:t.anchorHintText}),key:t.commentId,mentionableEditorProps:e.mentionableEditorProps,taskHistoryProps:b,accessibilityPositionInSet:m.accessibilityPositionInSet,accessibilitySetSize:m.accessibilitySetSize,isNew:!!(t.commentFlags&s.CommentFlags.IsNew),scrollingContainerId:v,isCardHovered:e.isCardHighlighted,availableScreenHeight:e.availableScreenHeight,extraPaddingLeft:e.extraPaddingLeft,extraPaddingRight:e.extraPaddingRight,preventDefaultKeyDownBehavior:e.preventDefaultKeyDownBehavior,collapsed:C,restrictActionControls_deprecated:T,preventReacting:N||O===g.AllowedDraftingSession.None,richTextCapabilities:e.richTextCapabilities,usersByReactionType:u.areCommentReactionsEnabled()?t.usersByReactionType:void 0,truncationOverlayColor:u.isWebThemeIntegrationEnabled()?void 0:S,dulledAtMentions:P,isUIAAnnotationPatternEnabled:e.isUIAAnnotationPatternEnabled,isEditable:!(t.commentFlags&s.CommentFlags.EditRestricted||u.shouldFixReadOnlyEditingButtons()&&t.commentFlags&s.CommentFlags.ReadOnly||O!==g.AllowedDraftingSession.Any),cardSelected:I,hasDraftInOtherRenderContext:U}))}function G(e,t,n,o,i,s,l,c,u,d,p){var f=M.getHistoryItemContentProps(t,e),h=M.createRenderableHistoryItemId(t.taskId,t.records[0].recordId),m=!1;s&&Object(y.isSelectedPostDetail)(s.selectionDetails)&&(m=s.selectionDetails.selectedPostId===h);var g=p.displayDate;return a.createElement(I.TaskHistoryItem,Object(r.__assign)({},f,{onSelect:n.onSelect,id:h,key:h,author:t.records[0].user,timestamp:g,selected:m,authorColor:null==o?void 0:o.authorColor,authorImageURL:null==o?void 0:o.authorImageURL,resolved:i,collapsed:l,restrictActionControls_deprecated:c,accessibilitySetSize:u.accessibilitySetSize,accessibilityPositionInSet:u.accessibilityPositionInSet,accessibilityLabel:w.AccessibilityStringHelpers.getTaskHistoryItemA11yLabel(e,t.records[0].user.DisplayName,g),preventDefaultKeyDownBehavior:d}))}function q(e,t,n,o,i,c,d,f,m,b,v,T,O){var S=e.cardState,x=e.cardCallbacks,I=e.localizationAPI,E=e.selectedState,A=e.isAtMentionEnabled,_=e.areTasksEnabled,R=e.draftState,D=e.cardCollapsedState,B=e.cardRelativeDraftingState,N=e.maximumDimensions,L=e.isolationEdit,F=e.richTextCapabilities,H=e.thread,U=Object(p.isPendingCardLoadState)(S.loadState)?S.loadState.initialItemCount:o.length,z=R.cardIdToDraftIdMap[t.commentId],K=z?R.drafts[z]:void 0,W=(!u.isDiscreteHostedCommentsEnabled()||B===C.CardRelativeDraftingState.InCard)&&K?Object(r.__assign)({draftId:z},Object(h.getDraftViewStateFromDraftState)(K)):{};return a.createElement(P.default,Object(r.__assign)({},x,W,{cardCollapsedState:D,selected:m,isReadOnly:T,hasSelectedChild:b,hasLowFidelityChild:v,displayMode:i,id:t.commentId,supportsAtMentions:A,isTabbable:e.isCardTabbable,localizationAPI:I,accessibilityLabel:w.AccessibilityStringHelpers.getCardA11yLabel(I,i,Object(l.getUsername)(t.author),t.anchorHintText,U-1,n,B,v&&"win32"===Object(j.getPlatform)(),f,t.commentBody),accessibilityDescription:"win32"===Object(j.getPlatform)()?Object(k.getPlainTextFromODelta)(M.getRootComment(H).commentBody):void 0,anchorText:t.anchorHintText,author:t.author,authorColor:c?c.authorColor:"",authorImageURL:c?c.authorImageURL:"",cardRelativeDraftingState:B,supportsTasks:_,taskTopperProps:n,isNewThread:e.isDraftThread,foldableLayoutState:e.foldableLayoutState,accessibilityPositionInSet:e.accessibilityPositionInSet,accessibilitySetSize:e.accessibilitySetSize,accessibilitySetLevel:e.accessibilitySetLevel,maximumDimensions:N,scrollingContainerId:d,itemCount:U,menuItems:e.getCardContextualMenuItems(t.commentFlags,e.allowedDraftingSession,e.isResolveSupported,Object(y.isRootPostInLowFidelityWarning)(t,E),!!e.taskState,u.isLinkToCommentEnabled(),u.isCommentsFluentUIEnabled()),allowRootEditButton:!(t.commentFlags&s.CommentFlags.EditRestricted||u.shouldFixReadOnlyEditingButtons()&&t.commentFlags&s.CommentFlags.ReadOnly||Object(y.isRootPostInLowFidelityWarning)(t,E))&&e.allowedDraftingSession===g.AllowedDraftingSession.Any,mentionEditorProps:e.mentionEditorProps,onCardLayout:e.onCardLayout,timestamp:f,restrictActionControls_deprecated:e.restrictActionControls_deprecated,preventReacting:T||e.allowedDraftingSession===g.AllowedDraftingSession.None,contentBackgroundColor:e.contentBackgroundColor,maxDraftHeight:e.maxDraftHeight,availableScreenHeight:e.availableScreenHeight,extraPaddingLeft:e.extraPaddingLeft,extraPaddingRight:e.extraPaddingRight,preventDefaultKeyDownBehavior:e.preventDefaultKeyDownBehavior,highlightCard:e.isCardHighlighted,hideDraftBox:L||e.isCommentsContextReadOnly,hideHeader:L,disableScroll:L,style:e.cardStyle,richTextCapabilities:F,usersByReactionType:u.areCommentReactionsEnabled()?t.usersByReactionType:void 0,isUIAAnnotationPatternEnabled:e.isUIAAnnotationPatternEnabled,tabFocusTrapBehavior:O}),o)}var Q=a.memo((function(e){var t=e.thread,n=e.renderContextType,r=e.cardState,i=e.postOrHistoryRecordStates,a=e.postCallbacks,l=e.cardCallbacks,h=e.localizationAPI,y=e.selectedState,T=e.isolationEdit,P=e.isDraftThread,x=e.isCommentsContextReadOnly,I=e.keyboardingOptions,E=e.personaIconPropertiesMap,k=e.draftState,w=e.cardCollapsedState,_=e.cardRelativeDraftingState,j=e.maximumDimensions,N=e.preventDefaultKeyDownBehavior,L=e.restrictActionControls_deprecated,U=e.allowedDraftingSession,z=e.taskState,K=e.isCardTabbable,Q=e.tabFocusTrapBehavior,Y=M.getRootComment(t),X=Y.commentId,$=_===C.CardRelativeDraftingState.InChildPost,ee=!!(Y.commentFlags&s.CommentFlags.Resolved),te=i[0].displayDate||"",ne=[],re=J(Y,r,k,y,!u.isDiscreteHostedCommentsEnabled()||_===C.CardRelativeDraftingState.InCard,P),oe=F(Y.commentId,y),ie=x||!!(Y.commentFlags&s.CommentFlags.ReadOnly),ae=H(Y.commentId,y),se=Object(B.getTruncationTextOverlayColor_deprecated)(re===v.default.Resolved,oe||ae),le=Object(B.shouldUseDulledAtMentions)(re===v.default.Resolved,w===b.default.Collapsed,oe||ae),ce=t.length-1,ue=!1,de=!Object(p.isPendingCardLoadState)(r.loadState),pe=n!==O.default.HalfPane&&!u.isCommentsFluentUIEnabled();if(de&&(!P||pe))for(var fe=0;fe<t.length;fe++){var he=t[fe],me=i[fe];if(Object(A.hasRenderableCommentItem)(he)){he.commentModel.commentFlags&s.CommentFlags.LowFidelity&&(ue=!0);var ye=he.commentModel.commentId,ge=Object(p.getSingleDraftPostId)(k)===ye,be=!!k.postIdToDraftIdMap[ye];if(!me)throw new c.CommentError("Post Or History Record state undefined for comment ".concat(ye),o.TelemetryTag.reserveTag(589103624),-2130957493);if((!T||!$||be)&&Object(m.isPostState)(me)&&me.pending!==m.PostPendingType.Delete){var ve=Object(A.hasRenderableHistoryItem)(he)?M.getHistoryItemContentProps(he.historyItem,h):void 0,Ce=W(w,ge,_);ne.push(V(e,he.commentModel,me,ee,I.postTabbingMode,u.isPersonaIconEnabled()?Object(d.getPersonaIconPropertiesEntry)(E,he.commentModel.author):void 0,ce,r.pending===f.CardPendingType.Editor,!u.isDiscreteHostedCommentsEnabled()||$||P,{accessibilitySetSize:t.length,accessibilityPositionInSet:fe+1},ve,j&&j.height?Object(R.getRenderableItemListId)({id:X,renderContextType:n}):Object(D.isPane)(n)?Object(R.getCommentsListID)():void 0,w===b.default.Collapsed,Ce,U,se,le,oe))}}else u.areCommentTasksEnabled()&&ne.push(G(h,he.historyItem,a,u.isPersonaIconEnabled()?Object(d.getPersonaIconPropertiesEntry)(E,he.historyItem.records[0].user):void 0,ee,y,w===b.default.Collapsed,L,{accessibilitySetSize:t.length,accessibilityPositionInSet:fe+1},N,me))}var Te=U===g.AllowedDraftingSession.None;return q(e,Y,z?Z(X,z,h,!!(Y.commentFlags&s.CommentFlags.Resolved),ie?S.default.ReadOnly:Te?S.default.Disabled:S.default.Default,l.onTaskTopperCheckboxPressed,N,K&&!Te):void 0,ne,re,u.isPersonaIconEnabled()?Object(d.getPersonaIconPropertiesEntry)(E,Y.author):void 0,Object(D.isPane)(n)?Object(R.getCommentsListID)():void 0,te,oe,ae,ue,ie,Q)}));function Y(e){return a.createElement(Q,Object(r.__assign)({},e))}function X(e,t,n,r,a,s,l){if(t.pending!==m.PostPendingType.None)return Object(i.getTelemetryAPI)().assertConditionTag(t.pending!==m.PostPendingType.Delete,"Post with PostPendingType.Delete should not attempt to be rendered. Falling back to PendingEdit display mode.",595153811),l?T.default.PendingDraft:T.default.PendingEdit;if(s){if(l)return Object(i.getTelemetryAPI)().assertConditionTag(!u.isCommentsFluentUIEnabled(),"New post should not be rendered while drafting in fluent.",574755652),T.default.New_nonFluent;if(n.postIdToDraftIdMap[e.commentId])return Object(h.isCommitPending)(n)?T.default.EditPreCommitPending:T.default.Editing}if(r&&Object(y.getSelectedCommentId)(r)===e.commentId)switch(r.selectionDetails.lowFidelityWarningType){case void 0:break;case y.LowFidelityWarningType.DeleteReply:return T.default.LowFidelityWarningDelete;case y.LowFidelityWarningType.Edit:return T.default.LowFidelityWarningEdit;case y.LowFidelityWarningType.DeleteThread:return u.isCommentsFluentUIEnabled()?T.default.LowFidelityWarningDelete:T.default.Normal;default:Object(o.unreachable)(r.selectionDetails)}return t.displayingErrorUI?T.default.Error:a?T.default.Resolved:T.default.Normal}function J(e,t,n,r,i,a){if(Object(p.isPendingCardLoadState)(t.loadState))return v.default.Loading;switch(t.pending){case f.CardPendingType.Card:case f.CardPendingType.Delete:return v.default.CardPostCommitPending;case f.CardPendingType.Editor:return v.default.ReplyPostCommitPending;case f.CardPendingType.None:break;default:Object(o.unreachable)(t.pending)}if(a)return Object(h.isCommitPending)(n)?v.default.DraftPreCommitPending:v.default.Draft;if(r&&r.selectedCardId===e.commentId&&Object(y.isLowFidelityDeleteThreadWarningOnSelectedComment)(r)&&!u.isCommentsFluentUIEnabled())return v.default.LowFidelityWarningOnDeleteThread;if(i){if(n.cardIdToDraftIdMap[e.commentId])return Object(h.isCommitPending)(n)?v.default.ReplyPreCommitPending:v.default.Reply;if(n.pendingDraft&&"REPLY"===n.pendingDraft.sessionType&&n.pendingDraft.threadId===e.commentId)return v.default.ReplySessionRequestPending}return e.commentFlags&s.CommentFlags.Resolved?v.default.Resolved:v.default.Normal}function $(e,t,n,r){if(e&&n[e.selectedCardId]&&n[e.selectedCardId].pending!==f.CardPendingType.Delete){var o=Object(p.getSingleCreateDraftId)(t);return o!==e.selectedCardId?e.selectedCardId:t.pendingDraft||t.drafts[o]&&(!t.drafts[o].isInCurrentContext||t.drafts[o].renderContextType!==r)?void 0:e.selectedCardId}}function Z(e,t,n,r,o,a,s,l){if(u.areCommentTasksEnabled()){var c=t.completion;return r!==(c===N.TaskCompletionResolveThreshold)&&(Object(i.getTelemetryAPI)().assertConditionTag(!1,"Comment and task resolve state don't match",570826896),c=r?N.TaskCompletionResolveThreshold:0),{id:e,title:t.title,assignees:t.assignees,completion:c,onResolveTaskCheckboxPressed:a,localizationAPI:n,displayMode:o,preventDefaultKeyDownBehavior:s,isTabbable:l}}}function ee(e,t,n){return e.map((function(e){var r=M.getId(e);return t[r]||n&&n[r]}))}},32949:function(e,t,n){"use strict";var r;n.r(t),function(e){e[e.New_nonFluent=0]="New_nonFluent",e[e.Normal=1]="Normal",e[e.Editing=2]="Editing",e[e.PendingDraft=3]="PendingDraft",e[e.PendingEdit=4]="PendingEdit",e[e.EditPreCommitPending=5]="EditPreCommitPending",e[e.Resolved=6]="Resolved",e[e.LowFidelityWarningEdit=7]="LowFidelityWarningEdit",e[e.LowFidelityWarningDelete=8]="LowFidelityWarningDelete",e[e.Error=9]="Error"}(r||(r={})),t.default=r},32950:function(e,t,n){"use strict";var r;n.r(t),function(e){e[e.Default=0]="Default",e[e.Disabled=1]="Disabled",e[e.ReadOnly=2]="ReadOnly"}(r||(r={})),t.default=r},32951:function(e,t,n){"use strict";n.r(t);var r=n(562),o=n(3e4),i=n(30061),a=n(30123),s=n(31018),l=n(31159),c=n(245),u=n(32926),d=n(30988),p=n(30989),f=n(30997),h=n(31415),m=n(32952),y=n(31306),g=n(31288),b=n(31289),v=n(32953),C=n(31040),T=n(32954),O=n(32955),S=n(32927),P=n(33067),x=n(33080),I=n(32972),E=n(33083),A=n(33088),k=n(33131),w=n(31285),_=n(31038),R=n(32933),j=n(32961),D=n(31413),M=n(31113),B=n(30994),N=n(33112),L=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.getStyles=function(e){return f.isWebThemeIntegrationEnabled()?Object(S.getCommentCardStyles)({id:r.props.id,renderContextType:r.props.componentTreeId.renderContextType},!!r.props.taskTopperProps,r.getMaxHeight(),null==e?void 0:e.colors):Object(S.getCommentCardStyles)({id:r.props.id,renderContextType:r.props.componentTreeId.renderContextType},!!r.props.taskTopperProps,r.getMaxHeight(),void 0)},r.rootTabIndexValue=-1,r.cardRef=null,r.replyBoxRef=null,r.taskTopperCheckboxRef=null,r.onDraftEmptinessChanged=function(e){r.props.onDraftEmptinessChanged(r,e)},r.contextMenuProps=Object(a.memoizeFunction)((function(e,t,n,o){return{id:_.getCardContextMenuId({id:e,renderContextType:t}),parentId:r.props.id,title:r.props.localizationAPI.getString(45),ariaLabel:r.props.localizationAPI.getString(45),onMenuClick:r.onContextMenuInteractionHandler,menuItems:n,itemType:T.ContextMenuItemType.CardContextMenuItem,tabIndex:o,renderContextType:t}}),5),r.reactionButtonProps=Object(a.memoizeFunction)((function(e,t,n,r,o,i){return f.areCommentReactionsEnabled()?{commentId:e,isTabbable:n,onReactionPressed:r.onReactionPressed,renderContextType:t,usersByReactionType:o,buttonStrings:i}:void 0}),5),r.reactionButtonStrings=Object(a.memoizeFunction)((function(){return{buttonLabel:r.props.localizationAPI.getString(231),buttonLabelPlural:r.props.localizationAPI.getString(239),buttonA11yDropdownText:r.props.localizationAPI.getString(240)}})),r.fetchReplyButton=Object(a.memoizeFunction)((function(e,t,n,o,i,a,s,l){var c=w.getCommitButtonTooltip(l,e,!!a,s);switch(e){case g.default.Reply:case g.default.ReplyPreCommitPending:return{id:_.getReplyBoxSendButtonId({id:t,renderContextType:n}),icon:2,isTabbable:i,disabled:o,onClick:r.sendReplyButtonClickHandler,onKeyDown:r.sendCommentButtonKeyDownHandler,text:r.props.localizationAPI.getString(48),accessibilityLabel:r.props.localizationAPI.getString(49),tooltipText:c,usePrimaryButtonStyling:!0};case g.default.ReplyPostCommitPending:return{disabled:!0,icon:2,onClick:function(){},text:r.props.localizationAPI.getString(48),accessibilityLabel:r.props.localizationAPI.getString(49),showDelayedSpinner:!0,tooltipText:c,usePrimaryButtonStyling:!0};case g.default.Draft:case g.default.DraftPreCommitPending:return{id:_.getReplyBoxSendButtonId({id:t,renderContextType:n}),icon:2,isTabbable:i,disabled:r.shouldDisableSendButton(),onClick:r.sendReplyButtonClickHandler,onKeyDown:r.sendCommentButtonKeyDownHandler,text:r.props.localizationAPI.getString(48),accessibilityLabel:r.props.localizationAPI.getString(83),tooltipText:c,usePrimaryButtonStyling:!0};default:return}})),r.fetchCancelButton=Object(a.memoizeFunction)((function(e,t,n,o){switch(e){case g.default.Reply:case g.default.ReplyPreCommitPending:return{id:_.getReplyBoxCancelButtonId({id:t,renderContextType:n}),icon:1,isTabbable:o,disabled:!1,onClick:r.cancelReplyButtonClickHandler,onKeyDown:r.cancelReplyButtonKeyDownHandler,text:r.props.localizationAPI.getString(15),accessibilityLabel:r.props.localizationAPI.getString(47),tooltipText:r.props.localizationAPI.getString(175),usePrimaryButtonStyling:!1};case g.default.ReplyPostCommitPending:return{disabled:!0,icon:1,onClick:function(){},text:r.props.localizationAPI.getString(15),accessibilityLabel:r.props.localizationAPI.getString(47),tooltipText:r.props.localizationAPI.getString(175),usePrimaryButtonStyling:!1};default:return}})),r.getMemoizedCommitButtons=Object(a.memoizeFunction)((function(e,t,n,o,i,a,s,l){var c=[],u=r.fetchReplyButton(e,t,n,o,i,a,s,l);if(!u)return c;c.push(u);var d=r.fetchCancelButton(e,t,r.props.componentTreeId.renderContextType,i);return d?(c.push(d),c):c})),r.onEditorMount=function(){r.props.onCardEditorMounted(r.props.id)},r.onEditorUnmount=function(){r.onCardSaveDraft(r.textEditorRef)},r.renderWithContexts=function(e){return r.styles=r.getStyles(e),c.createElement(a.FocusTrapZone,{className:r.getStyles(e).commentCardFocusTrapZone,disabled:r.shouldDisableFocusTrapZone(),disableFirstFocus:!0,forceFocusInsideTrap:!1,ignoreExternalFocusing:!0,isClickableOutsideFocusTrap:!0},r.renderCard(e))},r.renderPosts=r.renderPosts.bind(r),r.expandButtonHandler=r.expandButtonHandler.bind(r),r.onPost=r.onPost.bind(r),r.onCancel=r.onCancel.bind(r),r.onEditorClick=r.onEditorClick.bind(r),r.shouldDisableSendButton=r.shouldDisableSendButton.bind(r),r.cardKeyDownHandler=r.cardKeyDownHandler.bind(r),r.cardClickHandler=r.cardClickHandler.bind(r),r.renderCommitRegion=r.renderCommitRegion.bind(r),r.replyBoxKeyDownHandler=r.replyBoxKeyDownHandler.bind(r),r.cancelReplyThenFocus=r.cancelReplyThenFocus.bind(r),r.cancelReplyButtonKeyDownHandler=r.cancelReplyButtonKeyDownHandler.bind(r),r.sendCommentButtonKeyDownHandler=r.sendCommentButtonKeyDownHandler.bind(r),r.cancelReplyButtonClickHandler=r.cancelReplyButtonClickHandler.bind(r),r.sendReplyButtonClickHandler=r.sendReplyButtonClickHandler.bind(r),r.expandButtonClickHandler=r.expandButtonClickHandler.bind(r),r.expandButtonKeyDownHandler=r.expandButtonKeyDownHandler.bind(r),r.renderableItemListScrollHandler=r.renderableItemListScrollHandler.bind(r),r.clearDraft=r.clearDraft.bind(r),r.onCardMouseEnter=r.onCardMouseEnter.bind(r),r.onCardMouseLeave=r.onCardMouseLeave.bind(r),r.setCardRef=r.setCardRef.bind(r),r.setReplyBoxRef=r.setReplyBoxRef.bind(r),r.setTaskTopperCheckboxRef=r.setTaskTopperCheckboxRef.bind(r),r.onContextMenuInteractionHandler=r.onContextMenuInteractionHandler.bind(r),r.editorBlurHandler=r.editorBlurHandler.bind(r),r.editorComponentRef=r.editorComponentRef.bind(r),r.onContextMenuItemMounted=r.onContextMenuItemMounted.bind(r),r.onEditorCommitRequested=r.onEditorCommitRequested.bind(r),r.onEditorEscapeRequested=r.onEditorEscapeRequested.bind(r),r.getContentsAsync=r.getContentsAsync.bind(r),r.getCursorPositionAsync=r.getCursorPositionAsync.bind(r),r.renderResolvedOrTaskTopper=r.renderResolvedOrTaskTopper.bind(r),r.getPostArray=r.getPostArray.bind(r),r.hideCardHeader=r.hideCardHeader.bind(r),r.state={rootAuthorOpacity:1,headerHidden:!1,shouldShowAtMentionHintMessage:!1},r.setTabIndex(t),r}return Object(r.__extends)(t,e),t.prototype.getCommentEditorCallbackProps=function(){return{componentRef:this.editorComponentRef,onDraftEmptinessChanged:this.onDraftEmptinessChanged,onEditorBlur:this.editorBlurHandler,onFocus:this.onEditorFocus,onUnmount:this.onEditorUnmount}},t.prototype.setCardRef=function(e){this.cardRef=e},t.prototype.setReplyBoxRef=function(e){this.replyBoxRef=e},t.prototype.setTaskTopperCheckboxRef=function(){this.taskTopperCheckboxRef=document.getElementById(_.getCardTaskTopperCheckboxID({id:this.props.id,renderContextType:this.props.componentTreeId.renderContextType})),this.taskTopperCheckboxRef&&this.setTabIndex(this.props)},t.prototype.setTabIndex=function(e){e.selected||e.isTabbable?(this.rootTabIndexValue=0,this.taskTopperCheckboxRef&&(this.taskTopperCheckboxRef.tabIndex=0)):(this.rootTabIndexValue=-1,this.taskTopperCheckboxRef&&(this.taskTopperCheckboxRef.tabIndex=-1))},t.prototype.getInnerElementsTabIndex=function(){return this.props.displayMode===g.default.CardPostCommitPending?-1:this.rootTabIndexValue},t.prototype.getRootTabIndex=function(){return this.rootTabIndexValue},t.prototype.getMaxHeight=function(){return this.props.maximumDimensions&&this.props.maximumDimensions.height?Math.max(this.props.maximumDimensions.height,S.DISCRETE_CARD_CONTAINER_MAX_HEIGHT_LOWER_BOUND):void 0},t.prototype.onCardMouseEnter=function(){this.props.onCardHighlightChange(this,!0)},t.prototype.onCardMouseLeave=function(){this.props.onCardHighlightChange(this,!1)},t.prototype.componentDidMount=function(){e.prototype.componentDidMount.call(this),this.notifyRenderedOnce()},t.prototype.UNSAFE_componentWillUpdate=function(e,t){this.setTabIndex(e)},t.prototype.componentDidUpdate=function(e,t){var n=this.isActiveReply()||this.isActiveDraft();if(this.props.draftId&&!n&&Object(i.getTelemetryAPI)().assertConditionTag(!1,"CardDisplayMode inconsistent with draft warning state",593799004),f.isAtMentionHintMessageEnabled()&&(this.props.draftId!==e.draftId&&this.setState({shouldShowAtMentionHintMessage:!1}),(void 0===e.currentMentionees||0===Object.keys(e.currentMentionees).length)&&this.props.currentMentionees!==e.currentMentionees)){var r=localStorage.getItem("SharedComments_NumberOfAtMentionHintMessageShown"),o=r?parseInt(r,10):0;o>=3?this.setState({shouldShowAtMentionHintMessage:!1}):(localStorage.setItem("SharedComments_NumberOfAtMentionHintMessageShown",(o+1).toString()),this.setState({shouldShowAtMentionHintMessage:!0}))}this.textEditorRef&&e.cardRelativeDraftingState===b.CardRelativeDraftingState.InCard&&this.props.cardRelativeDraftingState===b.CardRelativeDraftingState.InOtherContextOfThisCard&&this.props.onSaveDraft(this.getId(),this.textEditorRef)},t.prototype.focus=function(){this.props.displayMode!==g.default.ReplySessionRequestPending&&this.cardRef&&this.cardRef.focus({preventScroll:!0})},t.prototype.blur=function(){this.cardRef&&this.cardRef.blur()},t.prototype.getContentsAsync=function(){return this.textEditorRef?this.textEditorRef.getContentsAsync():new Promise((function(e,t){t(new d.CommentError(p.InvalidEditorReference,o.TelemetryTag.reserveTag(589103744),-2130957550))}))},t.prototype.getCursorPositionAsync=function(){return this.textEditorRef?this.textEditorRef.getCursorPositionAsync():new Promise((function(e,t){e(void 0)}))},t.prototype.cardKeyDownHandler=function(e){var t=this.props.componentTreeId.renderContextType;switch(Object(l.normalizeKey)(e.key)){case l.KeyboardKey.Tab:if(this.props.isTabbable){if(f.isWebEmptyDraftThreadReverseTabLoopFixEnabled()&&this.isActiveDraft()&&e.shiftKey&&this.shouldDisableSendButton()&&!this.shouldDisableFocusTrapZone()&&this.textEditorRef&&e.target===document.getElementById(_.getCardRootId({id:this.props.id,renderContextType:t},this.props.isNewThread)))this.textEditorRef.focus(),e.preventDefault();else if(!f.shouldUseNewSelectionInteractions()&&this.isActiveDraft()){var n=document.getElementById(_.getReplyBoxSendButtonId({id:this.props.id,renderContextType:t})),r=document.getElementById(_.getDraftCancelButtonId({id:this.props.id,renderContextType:t})),o=void 0;e.target!==n||e.shiftKey?e.target===r&&(o=e.shiftKey&&!this.shouldDisableSendButton()?n:this.textEditorRef):o=r,o&&(o.focus(),e.preventDefault())}e.stopPropagation()}break;case l.KeyboardKey.Enter:case l.KeyboardKey.Space:e.currentTarget===e.target&&(this.toggleExpansion(),e.stopPropagation(),e.preventDefault())}},t.prototype.shouldClickTargetExpandCard=function(e){var t=this.props.componentTreeId.renderContextType,n=e.target,r=document.getElementById(_.getCardTaskTopperCheckboxID({id:this.props.id,renderContextType:t}));if(r&&r.parentElement&&r.parentElement.contains(n))return!1;var o=document.getElementById(_.getTaskAssignerDivID({id:this.props.id,renderContextType:t}));return!o||!o.contains(n)},t.prototype.cardClickHandler=function(e){this.props.hasSelectedChild||this.shouldClickTargetExpandCard(e)&&(this.props.onCardSelectExpand(this,!1,!1),e.stopPropagation())},t.prototype.contextMenuClickHandler=function(e,t){e.onClick(this.props.id,!!this.props.taskTopperProps),t&&t.stopPropagation()},t.prototype.expandButtonClickHandler=function(e){this.expandButtonHandler(),null==e||e.stopPropagation()},t.prototype.expandButtonKeyDownHandler=function(e){Object(l.normalizeKey)(e.key)===l.KeyboardKey.Enter&&(this.expandButtonHandler(),e.stopPropagation())},t.prototype.renderableItemListScrollHandler=function(e){var t=e.target;if(t.id===_.getRenderableItemListId({id:this.props.id,renderContextType:this.props.componentTreeId.renderContextType})){var n=t.scrollTop;this.setState({rootAuthorOpacity:n>S.POST_LIST_SCROLL_THRESHOLD_FOR_FULL_HEADER?0:(S.POST_LIST_SCROLL_THRESHOLD_FOR_FULL_HEADER-n)/S.POST_LIST_SCROLL_THRESHOLD_FOR_FULL_HEADER})}},t.prototype.expandButtonHandler=function(){this.focus(),this.props.onCardSelectExpand(this,!0,!1)},t.prototype.onPost=function(e){this.props.onPost(this,e)},t.prototype.onCancel=function(){this.props.onCancel(this)},t.prototype.onEditorClick=function(e){this.props.displayMode===g.default.Normal&&this.props.onEditorPress(this),e.stopPropagation()},t.prototype.shouldDisableSendButton=function(){return!1!==this.props.isDraftEmpty},t.prototype.generateCardActionItems=function(e){var t=this,n=[];return e&&e.length>0&&(n=e.map((function(e){return{id:_.getCardCommandBarButtonId({id:t.props.id,renderContextType:t.props.componentTreeId.renderContextType},e.text),text:e.text,accessibilityLabel:e.text,onClick:t.contextMenuClickHandler.bind(t,e),icon:e.icon,tooltipText:e.tooltipText,tooltipDirection:a.DirectionalHint.topCenter,isTabbable:t.props.isTabbable}}))),n},t.prototype.renderCardFooter=function(){return c.createElement("div",{className:this.styles.cardFooter})},t.prototype.onContextMenuItemMounted=function(e){e&&e.focus()},t.prototype.onContextMenuInteractionHandler=function(e){e&&Object(T.isContextMenuOnKeyboardClick)(e)&&Object(l.normalizeKey)(e.key)===l.KeyboardKey.ArrowDown&&e.preventDefault()},t.prototype.renderCardHeader=function(){var e=this.props.componentTreeId.renderContextType;if(!this.state.headerHidden){var t=this.props.menuItems.length>0&&this.props.displayMode!==g.default.Resolved,n={id:this.props.id,author:this.props.author,authorColor:this.props.authorColor,authorImageURL:this.props.authorImageURL,anchorText:this.props.anchorText,contextMenuProps:t?this.contextMenuProps(this.props.id,e,this.props.menuItems,this.getInnerElementsTabIndex()):void 0,isResolvedCard:this.props.displayMode===g.default.Resolved,hideActions:t?this.props.displayMode===g.default.CardPostCommitPending:void 0,preventReacting:this.props.preventReacting,localizationAPI:this.props.localizationAPI,onCancelDraft:this.onCancel,rootAuthorOpacity:this.state.rootAuthorOpacity,displayMode:this.props.displayMode,cardCollapsedState:this.props.cardCollapsedState,menuItems:this.props.menuItems,preventDefaultKeyDownBehavior:this.props.preventDefaultKeyDownBehavior,isTabbable:this.props.isTabbable,reactionButtonProps:this.reactionButtonProps(this.props.id,e,this.props.isTabbable,{onReactionPressed:this.props.onReactionUpdated},this.props.usersByReactionType,this.reactionButtonStrings()),onEditRootPost:this.props.onEditRootPost,allowRootEditButton:this.props.allowRootEditButton};return c.createElement(P.default,Object(r.__assign)({},n))}},t.prototype.renderViewMoreRepliesButtonBlueDot=function(){return c.createElement(I.BlueDot,{dotType:m.default.ViewMoreRepliesButton,hasTaskTopper:!1,renderContextType:this.props.componentTreeId.renderContextType})},t.prototype.injectHideCommentHeaderCallback=function(e){if(e){var t=e.constructor===Array?e[0]:e;return c.cloneElement(t,{onHideCardHeader:this.hideCardHeader})}},t.prototype.getPostArray=function(){var e=this.props.children;return e?e.constructor===Array?e:[e]:[]},t.prototype.renderPosts=function(){var e=this.getPostArray(),t=e.length,n=this.props.displayMode===g.default.Resolved,r=t>2||n&&t>1,o=this.props.componentTreeId.renderContextType,i=t?e[0]:void 0;i=this.injectHideCommentHeaderCallback(i);var a=t>1?e[t-1]:void 0,s=[],l=!1;if(this.props.children&&r)for(var u=1;u<t-1;++u){var d=this.props.children[u];if(s.push(d),!l&&d.props.postDisplayMode){var p=d.props;l=Object(k.shouldRenderBlueDot)(p)}}var f=this.props.cardCollapsedState===y.default.Collapsed,h=f&&r,m=f&&n;return c.createElement("div",{id:_.getRenderableItemListId({id:this.props.id,renderContextType:o}),onClick:h?this.expandButtonClickHandler:void 0,className:this.styles.renderableItemList,role:"group","aria-expanded":r?!f:void 0,onKeyDown:h?this.expandButtonKeyDownHandler:void 0,onScroll:this.renderableItemListScrollHandler},i,this.renderExpandButton({onPress:this.expandButtonHandler,unreadPostHidden:l}),h?void 0:s,m?void 0:a,o===C.default.DiscreteIsolated?c.createElement("div",{className:this.styles.spacingAfterLastPost}):void 0)},t.prototype.clearDraft=function(){this.textEditorRef&&this.textEditorRef.clear()},t.prototype.replyBoxKeyDownHandler=function(e){var t=this.props.componentTreeId.renderContextType;if(Object(l.normalizeKey)(e.key)===l.KeyboardKey.Enter||e.which===l.KeyboardKeyCode.Space)this.props.displayMode!==g.default.Normal&&this.props.displayMode!==g.default.ReplySessionRequestPending||this.props.onEditorPress(this),e.target===this.replyBoxRef&&e.preventDefault(),e.stopPropagation();else if(!f.shouldUseNewSelectionInteractions()&&Object(l.normalizeKey)(e.key)===l.KeyboardKey.Tab){var n=this.isActiveReply();if(this.isActiveDraft()||n){var r=document.getElementById(_.getReplyBoxSendButtonId({id:this.props.id,renderContextType:t})),o=n?document.getElementById(_.getReplyBoxCancelButtonId({id:this.props.id,renderContextType:t})):document.getElementById(_.getDraftCancelButtonId({id:this.props.id,renderContextType:t})),i=document.getElementById(_.getTaskAssignerCheckboxID({id:this.props.id,renderContextType:t}));e.shiftKey||!e.shiftKey&&this.shouldDisableSendButton()?o&&o.focus():f.areCommentTasksEnabled()&&i?i.focus():r&&r.focus(),e.preventDefault(),e.stopPropagation()}}},t.prototype.sendCommentButtonKeyDownHandler=function(e){Object(l.normalizeKey)(e.key)===l.KeyboardKey.Enter&&this.onPost(h.default.CommitButton)},t.prototype.cancelReplyButtonKeyDownHandler=function(e){Object(l.normalizeKey)(e.key)===l.KeyboardKey.Enter&&this.cancelReplyThenFocus(),f.shouldUseNewSelectionInteractions()||Object(l.normalizeKey)(e.key)!==l.KeyboardKey.Tab||e.shiftKey||this.textEditorRef&&(this.textEditorRef.focus(),e.preventDefault(),e.stopPropagation())},t.prototype.sendReplyButtonClickHandler=function(e){this.onPost(h.default.CommitButton),null==e||e.stopPropagation()},t.prototype.cancelReplyButtonClickHandler=function(e){this.cancelReplyThenFocus(),null==e||e.stopPropagation()},t.prototype.cancelReplyThenFocus=function(){this.onCancel();var e=document.getElementById(_.getCardRootId({id:this.props.id,renderContextType:this.props.componentTreeId.renderContextType},!1));e&&e.focus()},t.prototype.onEditorCommitRequested=function(){this.onPost(h.default.KeyboardShortcut)},t.prototype.onEditorEscapeRequested=function(){f.shouldUseNewSelectionInteractions()&&this.focus()},t.prototype.editorBlurHandler=function(){this.props.onEditorBlur(this)},t.prototype.editorComponentRef=function(e){this.textEditorRef=e},t.prototype.renderCommentEditor=function(e){var t=w.getCardEditorA11yLabel(this.props.displayMode,this.props.localizationAPI),n=this.props.componentTreeId.renderContextType,o=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({id:_.getCardEditorId({id:this.props.id,renderContextType:n}),isDraftEmpty:void 0,isTabbable:this.props.isTabbable,accessibilityLabel:t,accessibilityDescribedBy:_.getReplyBoxDescriptionId({id:this.props.id,renderContextType:n})},this.getCommentEditorCallbackProps()),{displayMode:v.default.Disabled,useReplyBoxStyling:!0,isHeightBounded:!!this.getMaxHeight(),placeholder:w.getEditorPlaceholderString(this.props.localizationAPI,this.props.supportsAtMentions,this.isActiveDraft(),this.props.cardRelativeDraftingState),scrollingContainerId:this.props.scrollingContainerId,supportsAtMentions:this.props.supportsAtMentions,localizationAPI:this.props.localizationAPI}),this.props.mentionEditorProps),{onMount:this.onEditorMount,focusManagerKeyDownHandler:this.props.commentEditorAdditionalKeyDownHandler,commentId:this.props.id}),i=this.props.smartReplies?{pickerTitle:this.props.localizationAPI.getString(203),smartReplies:this.props.smartReplies}:void 0;return e||(o=Object(r.__assign)(Object(r.__assign)({},o),{displayMode:v.default.Editing,onCommitRequested:this.onEditorCommitRequested,onEscapeRequested:this.onEditorEscapeRequested,initialDraftContent:this.props.savedDraftContent,isDraftEmpty:this.props.isDraftEmpty,richTextCapabilities:this.props.richTextCapabilities,smartReplyProps:i})),c.createElement(A.default,Object(r.__assign)({},o))},t.prototype.hideCardHeader=function(e){this.setState({headerHidden:e})},t.prototype.renderCommitRegion=function(){var e=this.props.componentTreeId.renderContextType,t=this.getMemoizedCommitButtons(this.props.displayMode,this.props.id,e,this.shouldDisableSendButton(),this.props.isTabbable,this.props.taskTopperProps,this.props.selectedTaskAssignee,this.props.localizationAPI);if(t.length)return c.createElement(E.CommitBar,{taskAssigner:this.getTaskAssignerProps(),buttons:t,tooltipDirection:a.DirectionalHint.bottomCenter})},t.prototype.renderReplyBox=function(){if(!this.props.isReadOnly){var e=this.props.componentTreeId.renderContextType,t=this.isActiveDraft(),n=this.isActiveReply(),r=this.props.displayMode===g.default.ReplyPostCommitPending||this.props.displayMode===g.default.CardPostCommitPending,o=n||t||r,i=!n&&!t&&!r,a=!n&&!t,s=f.isAtMentionHintMessageEnabled()&&!r&&!this.props.isDraftEmpty&&(n||t)&&this.props.currentMentionees&&Object.keys(this.props.currentMentionees).length>0&&this.state.shouldShowAtMentionHintMessage,l=f.isCtrlEnterTipEnabled();return c.createElement("div",{className:this.styles.replyBoxContainer,style:{position:"relative"}},c.createElement("div",{id:_.getCardReplyOrDraftBoxId({id:this.props.id,renderContextType:e}),ref:this.setReplyBoxRef,role:i?"button":void 0,"aria-disabled":!(f.isNewDraftingUIEnabled()||!i||void 0===this.props.cardRelativeDraftingState)||void 0,"aria-label":i?w.getEditorPlaceholderString(this.props.localizationAPI,this.props.supportsAtMentions,t,this.props.cardRelativeDraftingState):void 0,className:!f.shouldUseNewSelectionInteractions()&&this.props.restrictActionControls_deprecated?this.styles.replyBoxRestrictFocus:this.styles.replyBoxDefault,onClick:this.onEditorClick,onKeyDown:this.replyBoxKeyDownHandler,tabIndex:i?this.props.displayMode===g.default.ReplyPostCommitPending?-1:this.getInnerElementsTabIndex():void 0},this.renderCommentEditor(a),c.createElement("div",{className:this.styles.cardOverlay,style:this.props.displayMode===g.default.ReplyPostCommitPending?{display:"inline"}:{display:"none"}})),l?this.renderDraftBoxMessage(!r&&!this.props.isDraftEmpty&&(n||t)):void 0,o?this.renderCommitRegion():void 0,s?c.createElement(x.AtMentionInfoBar,{currentMentionees:this.props.currentMentionees,commentId:this.props.id,localizationAPI:this.props.localizationAPI}):void 0,c.createElement("div",{id:_.getReplyBoxDescriptionId({id:this.props.id,renderContextType:e}),style:{display:"none"}},this.props.localizationAPI.getString(55)))}},t.prototype.renderResolvedOrTaskTopper=function(){var e=this,t=Object(a.memoizeFunction)((function(t,n){return{cardTopperContainerProps:{},resolvedButtonsProps:t===g.default.Resolved?e.generateCardActionItems(n):void 0,taskTopperCheckboxRef:e.setTaskTopperCheckboxRef}}));return this.renderResolvedOrTaskTopperHelper(t(this.props.displayMode,this.props.menuItems))},t.prototype.shouldDisableFocusTrapZone=function(){var e;if(null===(e=this.props)||void 0===e?void 0:e.tabFocusTrapBehavior)switch(this.props.tabFocusTrapBehavior){case s.TabFocusTrapBehavior.Trap:return!1;case s.TabFocusTrapBehavior.DoNotTrap:return!0;default:Object(o.unreachable)(this.props.tabFocusTrapBehavior)}return!Object(M.isDiscrete)(this.props.componentTreeId.renderContextType)&&(f.shouldUseNewSelectionInteractions()||!this.isActiveReply()&&!this.isActiveDraft())},t.prototype.renderCard=function(e){var t=this.props.componentTreeId.renderContextType,n=this.styles.cardInnerContainer,o=this.props.isReadOnly?this.styles.cardBodyReadOnly:this.styles.cardBody,i=Object(S.getCardContainerStyles)({id:this.props.id,renderContextType:t},this.props.highlightCard,this.isSelectionWithinCard(),this.props.displayMode===g.default.Resolved&&this.props.cardCollapsedState===y.default.Collapsed,null==e?void 0:e.colors,null==e?void 0:e.styles),s={id:this.props.id,renderContextType:t},l={id:_.getCardRootId(s,this.props.isNewThread),role:"treeitem",className:i,tabIndex:this.getRootTabIndex(),onContextMenu:D.onBrowserContextMenu,onKeyDown:this.cardKeyDownHandler,ref:this.setCardRef,onFocus:this.onCardFocus},u={"aria-label":this.props.accessibilityLabel,"aria-expanded":this.props.cardCollapsedState===y.default.Expanded,"aria-selected":this.isSelectionWithinCard(),"aria-level":1,"aria-owns":_.getRenderableItemListId({id:this.props.id,renderContextType:t}),"aria-describedby":f.isThreadDescribedByEnabled()?_.getPostEditorId({id:this.props.id,renderContextType:t}):void 0,"aria-setsize":this.props.accessibilitySetSize,"aria-posinset":this.props.accessibilityPositionInSet};return this.props.displayMode===g.default.Loading?c.createElement("div",Object(r.__assign)({"aria-label":this.props.accessibilityLabel},l),c.createElement("div",{className:this.styles.cardPlaceholder},c.createElement("div",{id:_.getCardLoadingPlaceholderID(s),className:this.styles.cardOverlay},c.createElement(a.DelayedRender,{delay:B.SPINNER_DELAY_MS},c.createElement(a.Spinner,{className:this.styles.cardSpinner,size:a.SpinnerSize.large}))))):!f.shouldUseNewSelectionInteractions()&&this.isActiveDraft()?c.createElement("div",Object(r.__assign)({onClick:this.cardClickHandler},l,u),this.renderResolvedOrTaskTopper(),this.renderCardHeader(),c.createElement("div",{className:n},c.createElement("div",{className:o},this.renderPosts(),this.renderReplyBox(),f.isCtrlEnterTipEnabled()?void 0:this.renderDraftBoxMessage(!1)))):this.props.displayMode===g.default.Resolved?c.createElement("div",Object(r.__assign)({onMouseEnter:this.onCardMouseEnter,onMouseLeave:this.onCardMouseLeave,onClick:this.cardClickHandler},l,u),this.renderResolvedOrTaskTopper(),this.renderCardHeader(),c.createElement("div",{className:n},c.createElement("div",{className:o},this.renderPosts(),this.renderCardFooter()))):this.props.displayMode===g.default.CardPostCommitPending?c.createElement("div",Object(r.__assign)({onMouseEnter:this.onCardMouseEnter,onMouseLeave:this.onCardMouseLeave,onClick:this.cardClickHandler},l,u),this.renderResolvedOrTaskTopper(),this.renderCardHeader(),c.createElement("div",{className:n},c.createElement("div",{className:this.styles.cardBody},this.renderPosts(),this.renderReplyBox(),c.createElement("div",{className:this.styles.cardOverlay},c.createElement(a.DelayedRender,{delay:B.SPINNER_DELAY_MS},c.createElement(a.Spinner,{className:this.styles.cardSpinner,size:a.SpinnerSize.large})))))):c.createElement("div",Object(r.__assign)({onMouseEnter:this.onCardMouseEnter,onMouseLeave:this.onCardMouseLeave,onClick:this.cardClickHandler},l,u),this.renderResolvedOrTaskTopper(),this.renderCardHeader(),c.createElement("div",{className:n},c.createElement("div",{className:o},this.renderPosts(),this.renderReplyBox(),f.isCtrlEnterTipEnabled()?void 0:this.renderDraftBoxMessage(!1))))},t.prototype.render=function(){return f.isWebThemeIntegrationEnabled()?Object(R.consumeContexts)(this.renderWithContexts,u.SemanticStylesProviderContext):this.renderWithContexts()},t}(O.BaseCommentCard),F=Object(N.wrapContextualizedComponent)(L,{componentTreeId:j.ComponentTreeIdContext},O.BaseCommentCard.DisplayName);t.default=F},32952:function(e,t,n){"use strict";var r;n.r(t),function(e){e[e.RootPost=1]="RootPost",e[e.ReplyPost=2]="ReplyPost",e[e.ViewMoreRepliesButton=3]="ViewMoreRepliesButton"}(r||(r={})),t.default=r},32953:function(e,t,n){"use strict";var r;n.r(t),function(e){e[e.Editing=0]="Editing",e[e.Disabled=1]="Disabled",e[e.ReadOnly=2]="ReadOnly"}(r||(r={})),t.default=r},32954:function(e,t,n){"use strict";var r;function o(e){return void 0!==e.key}n.r(t),n.d(t,"ContextMenuItemType",(function(){return r})),n.d(t,"isContextMenuOnKeyboardClick",(function(){return o})),function(e){e[e.CardContextMenuItem=0]="CardContextMenuItem",e[e.ActionBarItem=1]="ActionBarItem"}(r||(r={}))},32955:function(e,t,n){"use strict";n.r(t),n.d(t,"BaseCommentCard",(function(){return x}));var r,o,i=n(562),a=n(3e4),s=n(30010),l=n(30061),c=n(245),u=n(31109),d=n(30997),p=n(31306),f=n(31288),h=n(32956),m=n(32957),y=n(32958),g=n(32960),b=n(32964),v=n(32967),C=n(32970),T=n(32977),O=n(32982),S=n(31285),P=n(31038),x=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.getNewCandidateTaskAssignees=Object(s.memoizeOnce)((function(e,t){var n=Object(u.createMapOfMentioneesStillInDraft)(e);return t?Object(u.removeCurrentAssignees)(n,t):n})),r.onEditorFocus=function(){!r.isActiveDraft()&&!r.isActiveReply()||r.isSelectionWithinCard()||(Object(l.getTelemetryAPI)().assertConditionTag(d.shouldUseNewSelectionInteractions(),"Should have selection in card with draft if NewSelectionInteractions off",572844239),r.props.onCardSelect(r))},r.notifyRenderedOnce=Object(s.once)((function(){r.props.onCardRendered&&r.props.onCardRendered(r.props)})),r.toggleExpansion=function(){r.props.cardCollapsedState===p.default.Collapsed?r.props.onCardSelectExpand(r,!0,!1):r.props.onCardCollapse(r)},r.renderExpandButton=function(e){var t=c.Children.count(r.props.children),n=r.props.displayMode===f.default.Resolved,o=r.props.componentTreeId.renderContextType;if(!(r.props.cardCollapsedState===p.default.Expanded||t<=1||(!n||!d.isCommentsFluentUIEnabled())&&t<=2))return c.createElement(C.ExpandCardButton,Object(i.__assign)({id:Object(P.getViewMoreReplyButtonId)({id:r.props.id,renderContextType:o}),innerText:S.getViewMoreRepliesString(r.props.localizationAPI,t,n)||"",isCardResolved:n,isTabbable:r.props.isTabbable,preventDefaultKeyDownBehavior:r.props.preventDefaultKeyDownBehavior,renderContextType:o,restrictControl_deprecated:!!r.props.restrictActionControls_deprecated,key:"expandButton"},e))},r.getId=r.getId.bind(r),r.onTaskAssigneeUpdated=r.onTaskAssigneeUpdated.bind(r),r.onCardFocus=r.onCardFocus.bind(r),r}return Object(i.__extends)(t,e),t.prototype.componentDidMount=function(){var e,t;this.props.onCardMounted(this.props),this.isActiveDraft()&&(null===(t=(e=Object(l.getTelemetryAPI)()).logDiagnosticTrace)||void 0===t||t.call(e,Object(s.strLiteral)(r||(r=Object(i.__makeTemplateObject)(["DraftCardMount"],["DraftCardMount"]))),a.TelemetryTag.reserveTag(556827602),l.Severity.Info,l.DataCategories.ProductServiceUsage,Object(l.globalTelemetryVisitor)(l.GlobalTelemetryReason.ReviewedAsNotNecessary),Object(l.makeDataField)("CommentId",this.props.id,l.DataFieldClassification.SystemMetadata),Object(l.makeDataField)("RenderContextType",this.props.componentTreeId.renderContextType,l.DataFieldClassification.SystemMetadata),Object(l.makeDataField)("CardDisplayMode",this.props.displayMode,l.DataFieldClassification.SystemMetadata)))},t.prototype.componentWillUnmount=function(){var e,t;this.isActiveDraft()&&(null===(t=(e=Object(l.getTelemetryAPI)()).logDiagnosticTrace)||void 0===t||t.call(e,Object(s.strLiteral)(o||(o=Object(i.__makeTemplateObject)(["DraftCardUnmount"],["DraftCardUnmount"]))),a.TelemetryTag.reserveTag(556827603),l.Severity.Info,l.DataCategories.ProductServiceUsage,Object(l.globalTelemetryVisitor)(l.GlobalTelemetryReason.ReviewedAsNotNecessary),Object(l.makeDataField)("CommentId",this.props.id,l.DataFieldClassification.SystemMetadata),Object(l.makeDataField)("RenderContextType",this.props.componentTreeId.renderContextType,l.DataFieldClassification.SystemMetadata),Object(l.makeDataField)("CardDisplayMode",this.props.displayMode,l.DataFieldClassification.SystemMetadata)))},t.prototype.getId=function(){return this.props.id},t.prototype.isActiveReply=function(){return this.props.displayMode===f.default.Reply||this.props.displayMode===f.default.ReplyPreCommitPending},t.prototype.isActiveDraft=function(){return this.props.displayMode===f.default.Draft||this.props.displayMode===f.default.DraftPreCommitPending},t.prototype.onTaskAssigneeUpdated=function(e){this.props.onSelectedTaskAssigneeUpdated(e)},t.prototype.getTaskAssignerProps=function(){var e;if(d.areCommentTasksEnabled()&&this.props.supportsTasks){var t=this.isActiveReply()&&!this.props.taskTopperProps;if((!t||d.areCommentTasksFromReplyEnabled())&&this.props.currentMentionees){var n=t||this.isActiveDraft(),r=S.getTaskFooterAssignTextString(this.props.localizationAPI,n),o=this.getNewCandidateTaskAssignees(this.props.currentMentionees,null===(e=this.props.taskTopperProps)||void 0===e?void 0:e.assignees),i=this.props.localizationAPI.getString(128);if(o&&0!==Object.keys(o).length)return{renderContextType:this.props.componentTreeId.renderContextType,id:this.props.id,label:r,candidateAssignees:o,isNewThread:this.isActiveDraft(),selectedAssignee:this.props.selectedTaskAssignee,onSelectedTaskAssigneeUpdated:this.onTaskAssigneeUpdated,pickerAriaLabel:i,assignerTooltip:this.props.localizationAPI.getString(182),preventDefaultKeyDownBehavior:this.props.preventDefaultKeyDownBehavior,isTabbable:this.props.isTabbable,localizationAPI:this.props.localizationAPI,displayMode:this.props.displayMode,isTaskThread:!!this.props.taskTopperProps}}}},t.prototype.isSelectionWithinCard=function(){return this.props.selected||this.props.hasSelectedChild},t.prototype.renderDraftBoxMessage=function(e){if(!d.isNewDraftingUIEnabled())return null;var t=this.props.draftWarningState;return d.isUseDraftBoxMessageEnabled()?t||e?c.createElement(b.DraftBoxMessage,{key:"draftBoxMessage",draftWarningState:t,localizationAPI:this.props.localizationAPI,target:h.DraftBoxMessageTarget.Card,id:t?Object(P.getDraftWarningId)({id:this.props.id,renderContextType:this.props.componentTreeId.renderContextType}):Object(P.getPostingTipId)({id:this.props.id,renderContextType:this.props.componentTreeId.renderContextType}),defaultToPostingTip:e}):null:t?c.createElement(v.DraftWarning,{key:"draftWarning",draftWarningState:t,localizationAPI:this.props.localizationAPI,target:m.DraftWarningTarget.Card,id:Object(P.getDraftWarningId)({id:this.props.id,renderContextType:this.props.componentTreeId.renderContextType})}):null},t.prototype.onCardSaveDraft=function(e){var t=this.isActiveDraft()||this.isActiveReply();e&&t&&this.props.onSaveDraft(this.getId(),e)},t.prototype.renderResolvedOrTaskTopperHelper=function(e){var t=this.props.taskTopperProps,n=e.resolvedButtonsProps,r=e.preventDefaultKeyDownBehavior,o=d.areCommentTasksEnabled();if(n||o&&t){var a=this.props.componentTreeId.renderContextType,s=n&&n.length>0?c.createElement(T.ResolvedCardButtons,{actions:n,renderContextType:a,preventDefaultKeyDownBehavior:r}):void 0,l=t&&!s?c.createElement(g.CommentCardTaskTopper,Object(i.__assign)({},t,{taskTopperCheckboxRef:e.taskTopperCheckboxRef})):c.createElement(O.ResolvedCardLabel,{localizationAPI:this.props.localizationAPI,renderContextType:a,taskCompleter:(null==t?void 0:t.assignees)&&t.assignees.length>0?t.assignees[0]:void 0});return c.createElement(y.CardTopperContainer,Object(i.__assign)({leftElement:l,rightElement:s,preventDefaultKeyDownBehavior:e.preventDefaultKeyDownBehavior},e.cardTopperContainerProps))}},t.prototype.onCardFocus=function(e){(d.isEnsureCardSelectionOnReverseTabLoopEnabled()||e.target===e.currentTarget)&&this.props.onCardFocus(this)},t.DisplayName="CommentCard",t}(c.PureComponent)},32956:function(e,t,n){"use strict";var r;n.r(t),n.d(t,"DraftBoxMessageTarget",(function(){return r})),function(e){e[e.Post=0]="Post",e[e.Card=1]="Card"}(r||(r={}))},32957:function(e,t,n){"use strict";var r;n.r(t),n.d(t,"DraftWarningTarget",(function(){return r})),function(e){e[e.Post=0]="Post",e[e.Card=1]="Card"}(r||(r={}))},32958:function(e,t,n){"use strict";n.r(t),n.d(t,"CardTopperContainer",(function(){return s}));var r=n(245),o=n.n(r),i=n(32926),a=n(32959),s=o.a.memo((function(e){var t,n=null===(t=Object(i.useSemanticStylesProvider)())||void 0===t?void 0:t.colors,r=Object(a.getStyles)(n);return o.a.createElement("div",{onClick:e.onPress,className:r.cardTopperContainerRoot},o.a.createElement("div",{className:r.cardTopperContainerFlexWrapper},o.a.createElement("div",{className:r.cardTopperContainerLeftElement},e.leftElement),e.rightElement))}));s.displayName="CardTopperContainer"},32959:function(e,t,n){"use strict";n.r(t),n.d(t,"getStyles",(function(){return i}));var r=n(30123),o=n(30993),i=Object(r.memoizeFunction)((function(e){var t;return{cardTopperContainerRoot:Object(r.mergeStyles)({borderBottom:"1px solid",borderColor:null!==(t=null==e?void 0:e.CardTopperContainerBorder)&&void 0!==t?t:o.OfficeColors.GRAY_B}),cardTopperContainerFlexWrapper:Object(r.mergeStyles)({display:"flex",alignItems:"center"}),cardTopperContainerLeftElement:Object(r.mergeStyles)({flex:1})}}))},32960:function(e,t,n){"use strict";n.r(t),n.d(t,"CommentCardTaskTopper",(function(){return C}));var r=n(562),o=n(30061),i=n(30123),a=n(245),s=n(31109),l=n(32926),c=n(30997),u=n(32950),d=n(31285),p=n(31038),f=n(32933),h=n(32961),m=n(32962),y=n(30995),g=n(32934),b=n(32963),v=n(32929),C=function(e){function t(t){var n=e.call(this,t)||this;return n.renderWithContexts=function(e,t){if(!c.areCommentTasksEnabled())return null;Object(o.getTelemetryAPI)().assertConditionTag(1===n.props.assignees.length,"There should be exactly one assignee",587794504);var r,s,l=e.renderContextType,u=b.isResolvedTask(n.props.completion),f=p.getCardTaskTopperCheckboxID({id:n.props.id,renderContextType:l}),h=!1;n.props.assignees.length>0?(h=n.isAssignedToYou(),r=Object(d.getTaskTopperAssignToLabel)(n.props.assignees[0],n.props.localizationAPI),s=Object(d.getTaskTopperCheckboxA11yLabel)(n.props.assignees[0],u,n.props.localizationAPI)):(r=Object(d.getTaskTopperUnassignedLabel)(n.props.localizationAPI),s=Object(d.getTaskTopperUnassignedCheckboxA11yLabel)(u,n.props.localizationAPI));var m=Object(v.getStyles)(h,n.hasNonInteractiveDisplayMode(),null==t?void 0:t.colors);return a.createElement("div",{className:m.taskTopperContainer,id:p.getCardTaskTopperDivID({id:n.props.id,renderContextType:l})},a.createElement(i.TooltipHost,{content:Object(d.getTaskCircleTooltip)(b.isResolvedTask(n.props.completion),n.props.localizationAPI),tooltipProps:g.commentTooltipProps},n.renderTaskTopper(f,m,u,s)),n.getStyledHeaderText(r,m))},n.onClick=n.onClick.bind(n),n}return Object(r.__extends)(t,e),t.prototype.hasNonInteractiveDisplayMode=function(){return this.props.displayMode===u.default.ReadOnly||this.props.displayMode===u.default.Disabled},t.prototype.hasReadOnlyDisplayMode=function(){return this.props.displayMode===u.default.ReadOnly},t.prototype.onClick=function(){this.props.onResolveTaskCheckboxPressed&&this.props.onResolveTaskCheckboxPressed(this.props.id)},t.prototype.getStyledHeaderText=function(e,t){var n=this.isAssignedToYou(),r=Object(v.getStyles)(n,this.hasNonInteractiveDisplayMode()),o=n||!this.props.assignees||0===this.props.assignees.length?this.renderAssignedToYouLabel(c.isWebThemeIntegrationEnabled()?t:r,e):this.renderAssignedToPersonLabel(c.isWebThemeIntegrationEnabled()?t:r);return a.createElement(i.TooltipHost,{content:Object(d.getTaskTopperTooltip)(n,this.props.assignees[0],this.props.localizationAPI),tooltipProps:g.commentTooltipProps},o)},t.prototype.renderAssignedToYouLabel=function(e,t){return a.createElement("div",{className:this.hasReadOnlyDisplayMode()?e.readOnlyTaskLabel:e.taskLabel},a.createElement("span",{className:e.taskTopperCheckbox.text},t))},t.prototype.renderAssignedToPersonLabel=function(e){var t=this,n=this.props.localizationAPI.getString(111);return a.createElement("div",{className:this.hasReadOnlyDisplayMode()?e.readOnlyTaskLabel:e.taskLabel},a.createElement("span",{className:e.taskTopperCheckbox.text},Object(m.buildComponentStreamFromPlaceholder)(n,(function(n,r){return t.renderAssigneeName(Object(s.getUsername)(t.props.assignees[0]),r,e)}))))},t.prototype.renderAssigneeName=function(e,t,n){var r=Object(v.getStyles)(!1,this.hasNonInteractiveDisplayMode());return a.createElement("span",{key:t,className:c.isWebThemeIntegrationEnabled()?n.taskAssignee:r.taskAssignee},e)},t.prototype.isAssignedToYou=function(){return!(!this.props.assignees||!this.props.assignees.length)&&!!this.props.assignees[0].IsCurrentUser},t.prototype.render=function(){return c.isWebThemeIntegrationEnabled()?Object(f.consumeContexts)(this.renderWithContexts,h.ComponentTreeIdContext,l.SemanticStylesProviderContext):Object(f.consumeContexts)(this.renderWithContexts,h.ComponentTreeIdContext)},t.prototype.renderTaskTopper=function(e,t,n,r){return this.hasReadOnlyDisplayMode()?null:a.createElement(i.Checkbox,{id:e,componentRef:this.props.taskTopperCheckboxRef,styles:t.taskTopperCheckbox,checked:n,"data-item-id":this.props.id,onChange:this.onClick,checkmarkIconProps:Object(y.getTaskIconProps)().CHECKMARK_ICON_TOPPER,disabled:this.hasNonInteractiveDisplayMode(),ariaLabel:r})},t}(a.PureComponent)},32961:function(e,t,n){"use strict";n.r(t),n.d(t,"ComponentTreeIdContextError",(function(){return o})),n.d(t,"ComponentTreeIdContext",(function(){return i})),n.d(t,"useComponentTreeIdContext",(function(){return a}));var r=n(245),o="ComponentTreeIdContext undefined. Did you forget to render a ComponentTreeIdContext context provider?",i=r.createContext(new Proxy({},{get:function(){throw new Error(o)}}));function a(){return r.useContext(i)}},32962:function(e,t,n){"use strict";n.r(t),n.d(t,"buildComponentStreamFromPlaceholder",(function(){return i})),n.d(t,"format",(function(){return a}));var r=/{([^{}]+)}|[^{}]+/g,o=/{([^{}]+)}/g;function i(e,t,n){var o=[];return e.replace(r,(function(r,i){var a,s=e+o.length;return(a=void 0!==i?t(i,s):n?n(r,s):r)&&o.push(a),""})),o}function a(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=function(e,n){try{return t[+n]}catch(r){return""}};return e.replace(o,r)}},32963:function(e,t,n){"use strict";n.r(t),n.d(t,"TaskCompletionResolveThreshold",(function(){return r})),n.d(t,"isResolvedTask",(function(){return o}));var r=100;function o(e){return e===r}},32964:function(e,t,n){"use strict";n.r(t);var r=n(32965);n.d(t,"DraftBoxMessage",(function(){return r.DraftBoxMessage}))},32965:function(e,t,n){"use strict";n.r(t),n.d(t,"DraftBoxMessage",(function(){return c}));var r=n(245),o=n(32926),i=n(30997),a=n(32956),s=n(31285),l=n(32966),c=r.memo((function(e){var t,n,c=null===(t=Object(o.useSemanticStylesProvider)())||void 0===t?void 0:t.colors,u=Object(l.getStyles)(c),d=i.isCtrlEnterTipEnabled(),p="";if(e.draftWarningState)p=s.getDraftWarningString(e.localizationAPI,e.draftWarningState.type),n=e.target===a.DraftBoxMessageTarget.Card?d?u.newcard:u.card:u.post;else{if(!d||!e.defaultToPostingTip)return null;p=e.localizationAPI.getString(233),n=u.postingtip}return r.createElement("div",{"aria-label":p,className:n,id:e.id},p)}))},32966:function(e,t,n){"use strict";n.r(t),n.d(t,"getStyles",(function(){return s}));var r=n(30123),o=n(32927),i=n(30993),a={display:"flex",overflow:"hidden",marginBottom:"5px",flexDirection:"row",flexShrink:0,fontSize:"11px",outline:"none",wordBreak:"break-word"},s=Object(r.memoizeFunction)((function(e){var t;return{card:Object(r.mergeStyles)(a,{marginLeft:o.REPLY_BOX_SIDE_MARGIN+10,marginRight:o.REPLY_BOX_SIDE_MARGIN+10,color:i.OfficeColors.WARNING_RED}),post:Object(r.mergeStyles)(a,{marginLeft:"3px",marginRight:"3px",color:i.OfficeColors.WARNING_RED}),newcard:Object(r.mergeStyles)(a,{marginLeft:"3px",marginRight:"3px",color:i.OfficeColors.WARNING_RED}),postingtip:Object(r.mergeStyles)(a,{marginLeft:"3px",marginRight:"3px",color:null!==(t=null==e?void 0:e.SubText)&&void 0!==t?t:i.OfficeColors.GRAY_E})}}))},32967:function(e,t,n){"use strict";n.r(t);var r=n(32968);n.d(t,"DraftWarning",(function(){return r.DraftWarning}))},32968:function(e,t,n){"use strict";n.r(t),n.d(t,"DraftWarning",(function(){return s}));var r=n(245),o=n(32957),i=n(31285),a=n(32969),s=r.memo((function(e){var t=i.getDraftWarningString(e.localizationAPI,e.draftWarningState.type),n=Object(a.getStyles)(),s=e.target===o.DraftWarningTarget.Card?n.card:n.post;return r.createElement("div",{"aria-label":t,className:s,id:e.id},t)}))},32969:function(e,t,n){"use strict";n.r(t),n.d(t,"getStyles",(function(){return a}));var r=n(30123),o=n(32927),i={display:"flex",overflow:"hidden",marginBottom:"5px",flexDirection:"row",flexShrink:0,color:n(30993).OfficeColors.WARNING_RED,fontSize:"11px",outline:"none",wordBreak:"break-word"},a=Object(r.memoizeFunction)((function(){return{card:Object(r.mergeStyles)(i,{marginLeft:o.REPLY_BOX_SIDE_MARGIN+10,marginRight:o.REPLY_BOX_SIDE_MARGIN+10}),post:Object(r.mergeStyles)(i,{marginLeft:"3px",marginRight:"3px"})}}))},32970:function(e,t,n){"use strict";n.r(t);var r=n(32971);n.d(t,"ExpandCardButton",(function(){return r.ExpandCardButton}))},32971:function(e,t,n){"use strict";n.r(t),n.d(t,"ExpandCardButton",(function(){return p}));var r=n(30123),o=n(31159),i=n(245),a=n(32926),s=n(30991),l=n(30997),c=n(32952),u=n(32972),d=n(32976);var p=i.memo((function(e){var t,n,p=null===(t=Object(a.useSemanticStylesProvider)())||void 0===t?void 0:t.colors,f=null!==(n=null==p?void 0:p.PrimaryButton)&&void 0!==n?n:Object(s.getWebAppColors)().primary,h=Object(d.getMoreRepliesStyles)(f,e.isCardResolved,p),m=i.useCallback((function(t){return function(e,t){t(),e.stopPropagation}(t,e.onPress)}),[e.onPress]),y=i.useCallback((function(t){return function(e,t){Object(o.normalizeKey)(e.key)===o.KeyboardKey.Enter&&(t(),e.stopPropagation())}(t,e.onPress)}),[e.onPress]);return i.createElement(r.DefaultButton,{"aria-label":e.innerText,styles:!l.shouldUseNewSelectionInteractions()&&e.restrictControl_deprecated?h.moreRepliesContainerRestrictFocus:h.moreRepliesContainer,tabIndex:e.isTabbable?0:-1,onClick:m,onKeyDown:y,id:e.id,text:e.innerText},e.unreadPostHidden?i.createElement(u.BlueDot,{dotType:c.default.ViewMoreRepliesButton,hasTaskTopper:!1,renderContextType:e.renderContextType}):null)}))},32972:function(e,t,n){"use strict";n.r(t);var r=n(32973);n.d(t,"BlueDot",(function(){return r.BlueDot}))},32973:function(e,t,n){"use strict";n.r(t),n.d(t,"BlueDot",(function(){return l}));var r=n(3e4),o=n(245),i=n(32926),a=n(32952),s=n(32974),l=o.memo((function(e){var t,n=null===(t=Object(i.useSemanticStylesProvider)())||void 0===t?void 0:t.colors,l=Object(s.getStyles)(e.hasTaskTopper,n),c="";switch(e.dotType){case a.default.RootPost:c=l.blueDotOnRoot;break;case a.default.ReplyPost:c=l.blueDotOnReply;break;case a.default.ViewMoreRepliesButton:c=l.blueDotOnViewMoreRepliesButton;break;default:Object(r.unreachable)(e.dotType)}return o.createElement("span",{className:c})}))},32974:function(e,t,n){"use strict";n.r(t),n.d(t,"getStyles",(function(){return l}));var r,o=n(30123),i=n(30994),a=n(32975),s=Object(o.mergeStyles)(i.commonHighContrastHoverStyles,{selectors:(r={},r[o.HighContrastSelector]={backgroundColor:"WindowText"},r)});var l=Object(o.memoizeFunction)((function(e,t){var n=function(e){var t,n;return Object(o.mergeStyles)({backgroundColor:null!==(t=null==e?void 0:e.BlueDot)&&void 0!==t?t:"#006BFF",borderRadius:"50%",borderWidth:2,borderColor:null!==(n=null==e?void 0:e.CardBackground)&&void 0!==n?n:"white",height:6,width:6,position:"absolute"},s)}(t);return{blueDotOnReply:Object(o.mergeStyles)(n,{left:27,top:36+(e?a.HISTORY_ITEM_HEIGHT:0)}),blueDotOnRoot:Object(o.mergeStyles)(n,{left:6,top:9+(e?a.HISTORY_ITEM_HEIGHT:0)}),blueDotOnViewMoreRepliesButton:Object(o.mergeStyles)(n,{left:5,top:11})}}))},32975:function(e,t,n){"use strict";n.r(t),n.d(t,"HISTORY_ITEM_HEIGHT",(function(){return a})),n.d(t,"TASK_ICON_WIDTH",(function(){return s})),n.d(t,"getStyles",(function(){return l}));var r=n(30123),o=n(30997),i=n(30995),a=16,s=12,l=Object(r.memoizeFunction)((function(e){var t,n,l;return{container:Object(r.mergeStyles)({display:"flex",direction:"inherit",overflow:"hidden",flexDirection:"row",flexWrap:"nowrap",margin:0,border:0,position:"relative"}),body:Object(r.mergeStyles)({fontFamily:"inherit",color:null!==(n=null==e?void 0:e.TaskBorder)&&void 0!==n?n:i.TaskColors.TASK_BORDER,fontWeight:"normal",fontSize:"12px",lineHeight:a,marginLeft:"3px",userSelect:"text",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"}),icon:Object(r.mergeStyles)((t={color:null!==(l=null==e?void 0:e.TaskBorder)&&void 0!==l?l:i.TaskColors.TASK_BORDER,fontSize:"12px",lineHeight:a,marginLeft:"3px",marginRight:"3px",height:a,width:s,minWidth:s},t[r.HighContrastSelector]=Object(o.isWebHistoryItemIconHighContrastFixEnabled)()?{color:"ButtonText"}:void 0,t))}}))},32976:function(e,t,n){"use strict";n.r(t),n.d(t,"getMoreRepliesStyles",(function(){return l}));var r=n(30123),o=n(30993),i=n(30994),a=function(e){var t;return Object(r.mergeStyleSets)({rootFocused:Object(r.mergeStyles)({color:null!==(t=null==e?void 0:e.Text)&&void 0!==t?t:o.OfficeColors.GRAY_H,outline:"none",border:"1px solid transparent",backgroundColor:"transparent"},i.commonHighContrastFocusStyles)})},s=Object(r.memoizeFunction)((function(e,t,n){var a,s,l,c,u=null!==(a=null==n?void 0:n.PrimaryButtonHovered)&&void 0!==a?a:o.OfficeColors.GRAY_H,d=null!==(s=null==n?void 0:n.PrimaryButtonPressed)&&void 0!==s?s:u;return t&&(u=null!==(l=null==n?void 0:n.ExpandButtonTextResolvedHovered)&&void 0!==l?l:o.OfficeColors.GRAY_H,d=null!==(c=null==n?void 0:n.ExpandButtonTextResolvedPressed)&&void 0!==c?c:u),Object(r.mergeStyleSets)({root:Object(r.mergeStyles)({overflow:"visible",position:"relative",height:"28px",margin:0,padding:0,border:"1px solid transparent",backgroundColor:"transparent",boxSizing:"border-box",color:e,cursor:"pointer",flexShrink:0,outline:"none",selectors:{".ms-Fabric--isFocusVisible &:focus::after":i.fabricFocusSelectorStyles}}),rootFocused:Object(r.mergeStyles)({color:e,outline:"none",border:"1px dotted",backgroundColor:"transparent"},i.commonHighContrastFocusStyles),flexContainer:Object(r.mergeStyles)({justifyContent:"flex-start"}),textContainer:Object(r.mergeStyles)({flexGrow:0,flexShrink:0,margin:0,padding:0,marginLeft:"16px"}),label:Object(r.mergeStyles)({margin:0,padding:0,fontWeight:t?void 0:"bold",fontSize:"12px",lineHeight:"16px",fontFamily:'"Segoe UI", "Segoe UI Web", Arial, Verdana, sans-serif'}),rootHovered:Object(r.mergeStyles)({color:u,backgroundColor:"transparent"},i.commonHighContrastHoverStyles),rootPressed:Object(r.mergeStyles)({color:d,backgroundColor:"transparent",outline:"none",border:"1px solid transparent"})})})),l=Object(r.memoizeFunction)((function(e,t,n){var i,l,c=null!==(i=null==n?void 0:n.PrimaryButton)&&void 0!==i?i:e;return t&&(c=null!==(l=null==n?void 0:n.ExpandButtonTextResolved)&&void 0!==l?l:o.OfficeColors.RESOLVED_CARD_TEXT),{moreRepliesContainer:s(c,t,n),moreRepliesContainerRestrictFocus:Object(r.mergeStyleSets)(s(c,t,n),a(n),{color:c})}}))},32977:function(e,t,n){"use strict";n.r(t),n.d(t,"ResolvedCardButtons",(function(){return c}));var r=n(245),o=n.n(r),i=n(32926),a=n(32932),s=n(32978),l=n(32981),c=o.a.memo((function(e){var t,n=e.actions,c=null===(t=Object(i.useSemanticStylesProvider)())||void 0===t?void 0:t.colors,u=Object(l.getStyles)(c),d=n.map((function(e,t){var r,i=t===n.length-1;return o.a.createElement("div",{key:"".concat(t+1,"-").concat(e.text),className:i?u.resolvedCardButtonsLastIconContainerStyles:u.resolvedCardButtonsDefaultIconContainerStyles},o.a.createElement(s.CommentIconButton,{accessibilityLabel:e.accessibilityLabel,disabled:e.disabled,icon:e.icon,iconStyles:null!==(r=u.resolvedCardButtonIconStyles[e.icon])&&void 0!==r?r:u.resolvedCardButtonIconDefaultStyles,id:e.id,isTabbable:e.isTabbable,onKeyDown:e.onKeyDown,onClick:e.onClick,text:"",tooltipDirection:e.tooltipDirection,tooltipText:Object(a.getButtonTooltipWithFallback)(e)}))}));return o.a.createElement(r.Fragment,null,d)}));c.displayName="ResolvedCardButtons"},32978:function(e,t,n){"use strict";n.r(t);var r=n(32979);n.d(t,"CommentIconButton",(function(){return r.CommentIconButton}))},32979:function(e,t,n){"use strict";n.r(t),n.d(t,"CommentIconButton",(function(){return p}));var r=n(562),o=n(30123),i=n(245),a=n(32926),s=n(30997),l=n(32932),c=n(32933),u=n(32934),d=n(32980),p=function(e){function t(t){var n=e.call(this,t)||this;return n.onClick=function(e){var t=n.props.onClick;if("function"==typeof t)return t(e)},n.renderWithContexts=function(e){var t=n.props.tooltipText;return t?i.createElement(o.TooltipHost,{content:t,directionalHint:n.props.tooltipDirection,tooltipProps:u.commentTooltipProps},n.renderIconButton(e)):n.renderIconButton(e)},n.styles_deprecated=Object(d.getStyles)(),n}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"disabled",{get:function(){return!!this.props.disabled},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tabIndex",{get:function(){return this.props.isTabbable&&!this.disabled?0:-1},enumerable:!1,configurable:!0}),t.prototype.renderIconButton=function(e){var t=Object(s.isWebThemeIntegrationEnabled)()?Object(d.getStyles)(null==e?void 0:e.colors):this.styles_deprecated;return i.createElement(o.IconButton,{styles:t.defaultButton,ariaLabel:this.props.accessibilityLabel,disabled:this.disabled,iconProps:{iconName:Object(l.getIconName)(this.props.icon),styles:this.props.iconStyles},id:this.props.id,onBlur:this.props.onBlur,onFocus:this.props.onFocus,onKeyDown:this.props.onKeyDown,onMouseEnter:this.props.onMouseEnter,onMouseLeave:this.props.onMouseLeave,onClick:this.onClick,tabIndex:this.tabIndex,text:this.props.text})},t.prototype.render=function(){return Object(s.isWebThemeIntegrationEnabled)()?Object(c.consumeContexts)(this.renderWithContexts,a.SemanticStylesProviderContext):this.renderWithContexts()},t}(i.PureComponent)},32980:function(e,t,n){"use strict";n.r(t),n.d(t,"getStyles",(function(){return l}));var r=n(30123),o=n(30997),i=n(30993),a=n(30994);function s(e){var t,n,a,s;return{icon:{color:null!==(a=null==e?void 0:e.DefaultButtonIcon)&&void 0!==a?a:i.OfficeColors.GRAY_200},iconHovered:(t={},t[r.HighContrastSelector]={color:"HighlightText"},t),rootFocused:(n={},n[r.HighContrastSelector]={" .ms-Button-icon":{color:"HighlightText"}},n),iconDisabled:{color:null!==(s=null==e?void 0:e.DefaultButtonIconDisabled)&&void 0!==s?s:i.OfficeColors.GRAY_100},rootDisabled:{backgroundColor:"transparent"},rootHovered:Object(o.isWebThemeIntegrationEnabled)()?{backgroundColor:null==e?void 0:e.DefaultButtonHovered}:void 0,rootPressed:Object(o.isWebThemeIntegrationEnabled)()?{backgroundColor:null==e?void 0:e.DefaultButtonPressed}:void 0}}var l=Object(r.memoizeFunction)((function(e){return{defaultButton:Object(a.setHighContrastButtonStyles)(s(e))}}))},32981:function(e,t,n){"use strict";n.r(t),n.d(t,"getStyles",(function(){return c}));var r=n(30123),o=n(30997),i=n(30994),a={root:{width:12,height:16,lineHeight:18}},s=Object(r.mergeStyleSets)(a,{root:{height:14,lineHeight:14}}),l=Object(r.mergeStyleSets)(a,{root:{width:16}}),c=Object(r.memoizeFunction)((function(e){var t,n=null==e?void 0:e.ResolvedCardTitle;return{resolvedCardButtonsDefaultIconContainerStyles:Object(r.mergeStyles)({margin:"1px 0px",selectors:Object(o.isWebThemeIntegrationEnabled)()?{".ms-Button-icon, .ms-font-m":{color:n}}:void 0}),resolvedCardButtonsLastIconContainerStyles:Object(r.mergeStyles)({margin:"1px 4px 1px 0px",selectors:Object(o.isWebThemeIntegrationEnabled)()?{".ms-Button-icon":{color:n}}:void 0}),resolvedCardButtonIconStyles:(t={},t[3]=Object(i.addHCBackgroundToIconStyles)(a),t[16]=Object(i.addHCBackgroundToIconStyles)(s),t[25]=Object(i.addHCBackgroundToIconStyles)(l),t),resolvedCardButtonIconDefaultStyles:a}}))},32982:function(e,t,n){"use strict";n.r(t),n.d(t,"ResolvedCardLabel",(function(){return u}));var r=n(30123),o=n(32983),i=n(245),a=n(32926),s=n(30997),l=n(32932),c=n(33066),u=i.memo((function(e){var t,n=Object(l.getIconName)(20),u=null===(t=Object(a.useSemanticStylesProvider)())||void 0===t?void 0:t.colors,d=Object(c.getStyles)(u),p=s.areCommentTasksEnabled()&&e.taskCompleter?e.localizationAPI.getStringOrUndefined(202):e.localizationAPI.getStringOrUndefined(197);return i.createElement("div",{className:d.resolvedCardContainer},n&&i.createElement(r.Icon,{iconName:n,className:d.resolvedCardIcon}),i.createElement("div",{className:d.resolvedCardLabel},s.isWebThemeIntegrationEnabled()?p:i.createElement(o.Text,{numberOfLines:c.NUMBER_OF_TEXT_LINES,acceptsKeyboardFocus:!1,accessible:!1},p)))}));u.displayName="ResolvedCardLabel"},32983:function(e,t,n){e.exports=n(32984)},32984:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(32985),t),o(n(32988),t),o(n(32989),t),o(n(32993),t),o(n(33003),t),o(n(33006),t),o(n(33009),t),o(n(33012),t),o(n(33016),t),o(n(33020),t),o(n(33022),t),o(n(33024),t),o(n(33028),t),o(n(33031),t),o(n(33032),t),o(n(33039),t),o(n(33044),t),o(n(33047),t),o(n(33051),t),o(n(33055),t),o(n(33058),t),o(n(33062),t),o(n(33034),t),o(n(33063),t),o(n(33059),t)},32985:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(32986);Object.defineProperty(t,"Alert",{enumerable:!0,get:function(){return i.Alert}}),o(n(32987),t)},32986:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Alert=void 0;var r=function(){function e(){}return e.alert=function(e,t,n,r){var o=e;t&&(o+="\n"+t),n?r?!0===window.confirm(o)?n.onClick():r.onClick():(window.alert(o),n.onClick()):window.alert(o)},e}();t.Alert=r},32987:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AlertButtonStyle=void 0,function(e){e.default="default",e.cancel="cancel",e.destructive="destructive"}(t.AlertButtonStyle||(t.AlertButtonStyle={}))},32988:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AppRegistry=void 0,t.AppRegistry=function(){function e(){}return e.registerComponent=function(e,t){console.error("This does not work in web currently, but will likely be needed once we have a web react bridge")},e}()},32989:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(32990);Object.defineProperty(t,"Checkbox",{enumerable:!0,get:function(){return i.Checkbox}}),o(n(32992),t)},32990:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),l=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.hasOwnProperty.call(e,n)&&a(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Checkbox=void 0;var c=n(30351),u=l(n(245)),d=n(32991),p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.render=function(){var e=this.props,t=e.label,n=e.disabled,r=e.defaultChecked,o=e.onValueChange,a={};return void 0!==t&&(a.label=t),void 0!==n&&(a.disabled=n),void 0!==r&&(a.defaultChecked=r),void 0!==o&&(a.onChange=o),u.createElement(c.Checkbox,i({},a))},t.prototype.setFocus=function(){},t.defaultProps=d.CheckboxDefaultProps,t}(u.Component);t.Checkbox=p,t.default=p},32991:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CheckboxDefaultProps=void 0,t.CheckboxDefaultProps={label:"",description:"",disabled:!1,defaultChecked:!1,checked:!1,onValueChange:void 0}},32992:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},32993:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(32994);Object.defineProperty(t,"CommandButton",{enumerable:!0,get:function(){return i.CommandButton}}),o(n(33002),t)},32994:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.CommandButton=void 0;var s=n(30233),l=n(32995),c=a(n(245)),u=n(32999),d=n(33001);t.CommandButton=function(e){var t=e.accessibilityDescription,n=e.accessibilityLabel,o=e.tooltip,i=e.disabled,a=e.icon,u=e.onClick,p=e.text,f=l.getIconProps(a),h=d.buildLeafStyle([{flexGrow:0},e.style]);return c.createElement(s.CommandButton,r({ariaDescription:t,ariaLabel:n,disabled:i,iconProps:f,onClick:u},h&&{style:h},{title:o,text:p}))},t.CommandButton.defaultProps=u.CommandButtonDefaultProps,t.CommandButton.displayName="CommandButton",t.default=t.CommandButton},32995:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.hasOwnProperty.call(e,n)&&i(t,e,n);return a(t,e),t},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Image=t.getIconProps=void 0;var c=s(n(245)),u=l(n(32996)),d=n(32998).StyleSheet.createViewStyle({position:"relative",flex:0,overflow:"visible"});t.getIconProps=function(e){var t;if(null!=e){if("string"==typeof e)t={src:e,style:{width:"16px",height:"16px"}};else{var n=e.width?e.width:"16px",r=e.height?e.height:"16px";t={src:e.uri,style:{width:n,height:r}}}return{imageProps:t}}return null};var p=function(e){function t(t){return e.call(this,t)||this}return o(t,e),t.prototype.render=function(){var e;return e="string"==typeof this.props.source?this.props.source:void 0===this.props.source||null===this.props.source?null:this.props.source.uri,c.createElement("div",{style:this._getStyles(e)},this.props.children)},t.prototype._getStyles=function(e){var t=u.default.combine(d,this.props.style);t.display="flex",t.backgroundColor="transparent",t.backgroundImage='url("'+e+'")';var n="contain";switch(this.props.resizeMode){case"cover":n="cover";break;case"stretch":n="100% 100%";break;case"repeat":n="auto"}return t.backgroundPosition="center center",t.backgroundSize=n,t.backgroundRepeat="repeat"===this.props.resizeMode?"repeat":"no-repeat",t},t}(c.Component);t.Image=p},32996:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),l=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.hasOwnProperty.call(e,n)&&a(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Styles=void 0;var c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.combine=function(e,t){if(e||t){var n=e?t?[e,t]:e:t;if(n instanceof Array){for(var r={},o=0;o<n.length;o++){var a=this.combine(n[o]);r=i(i({},r),a)}return void 0===r.marginLeft&&void 0===r.marginRight&&void 0===r.marginTop&&void 0===r.marginBottom||void 0===r.margin||(console.error("Conflicting rules for margin specified."),delete r.margin),void 0===r.paddingLeft&&void 0===r.paddingRight&&void 0===r.paddingTop&&void 0===r.paddingBottom||void 0===r.padding||(console.error("Conflicting rules for padding specified."),delete r.padding),(r.borderWidth||r.borderTopWidth||r.borderRightWidth||r.borderBottomWidth||r.borderLeftWidth)&&(void 0===r.boxSizing&&(r.boxSizing="border-box"),void 0===r.borderColor&&(r.borderColor="black"),void 0===r.borderStyle&&(r.borderStyle="solid")),(r.borderStyle||r.borderTopWidth||r.borderRightWidth||r.borderBottomWidth||r.borderLeftWidth)&&void 0===r.borderWidth&&(void 0===r.borderTopWidth&&(r.borderTopWidth=0),void 0===r.borderRightWidth&&(r.borderRightWidth=0),void 0===r.borderBottomWidth&&(r.borderBottomWidth=0),void 0===r.borderLeftWidth&&(r.borderLeftWidth=0)),r}return n}},t}(l(n(32997)).Styles);t.Styles=c,t.default=new c},32997:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.hasOwnProperty.call(e,n)&&i(t,e,n);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.View=t.ViewBase=t.Styles=t.Component=void 0;var l=s(n(245)),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t}(l.Component);t.Component=c;var u=function(){};t.Styles=u;var d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t}(l.Component);t.ViewBase=d;var p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t}(d);t.View=p},32998:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StyleSheet=void 0,t.StyleSheet=function(){function e(){}return e.createViewStyle=function(e){return this._adaptStyles(e)},e._adaptStyles=function(e){if(void 0!==e.flex){var t=e.flex;delete e.flex,t>0?(e.flexGrow=t,e.flexShrink=1):t<0?(e.flexGrow=0,e.flexShrink=-t):(e.flexGrow=0,e.flexShrink=0)}return void 0!==e.marginVertical&&(e.marginTop=e.marginVertical,e.marginBottom=e.marginVertical,delete e.marginVertical),void 0!==e.marginHorizontal&&(e.marginLeft=e.marginHorizontal,e.marginRight=e.marginHorizontal,delete e.marginHorizontal),void 0===e.marginHorizontal&&void 0===e.marginVertical&&void 0===e.marginLeft&&void 0===e.marginRight&&void 0===e.marginTop&&void 0===e.marginBottom||void 0===e.margin||(console.error("Conflicting rules for margin specified."),delete e.margin),void 0!==e.paddingVertical&&(e.paddingTop=e.paddingVertical,e.paddingBottom=e.paddingVertical,delete e.paddingVertical),void 0!==e.paddingHorizontal&&(e.paddingLeft=e.paddingHorizontal,e.paddingRight=e.paddingHorizontal,delete e.paddingHorizontal),void 0===e.paddingHorizontal&&void 0===e.paddingVertical&&void 0===e.paddingLeft&&void 0===e.paddingRight&&void 0===e.paddingTop&&void 0===e.paddingBottom||void 0===e.padding||(console.error("Conflicting rules for padding specified."),delete e.padding),e},e}()},32999:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.CommandButtonDefaultProps=void 0;var o=n(33e3);t.CommandButtonDefaultProps=r({},o.DefaultButtonDefaultProps)},33e3:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultButtonDefaultProps=void 0,t.DefaultButtonDefaultProps={text:null,onClick:null,disabled:!1}},33001:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.buildDivProps=t.buildFlexboxProps=t.buildFlexboxStyle=t.buildLeafStyle=void 0;var o=r(n(32996)),i=n(32998),a=i.StyleSheet.createViewStyle({}),s=i.StyleSheet.createViewStyle({position:"relative",flexDirection:"column",flexGrow:0,flexShrink:0,overflow:"hidden",alignItems:"stretch"});function l(e){return{style:o.default.combine([a,s,e.style])}}s.display="flex",t.buildLeafStyle=function(e){var t=o.default.combine([a,e]);if(!function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}(t))return t},t.buildFlexboxStyle=function(e){return o.default.combine([a,s,e])},t.buildFlexboxProps=l,t.buildDivProps=function(e){var t=l(e);return e.accessibilityLabel?t["aria-label"]=e.accessibilityLabel:t["aria-label"]&&(t["aria-label"]=void 0),t}},33002:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},33003:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(33004);Object.defineProperty(t,"ContextualMenu",{enumerable:!0,get:function(){return i.ContextualMenu}}),o(n(33005),t)},33004:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.hasOwnProperty.call(e,n)&&i(t,e,n);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.ContextualMenu=t.getContextualMenuItems=void 0;var l=n(32995),c=s(n(245));t.getContextualMenuItems=function(e){if(void 0!==e){var t=[];return e.items.forEach((function(e){var n=l.getIconProps(e.icon);t[t.length]={key:e.key,name:e.name,iconProps:n,onClick:e.onClick,ariaLabel:e.accessibilityTitle,disabled:e.disabled}})),{items:t,ariaLabel:e.accessibilityTitle}}return null};var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.showContextualMenu=function(e,t){console.warn("Contextmenu not implemented")},t}(c.Component);t.ContextualMenu=u},33005:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},33006:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(33007);Object.defineProperty(t,"DefaultButton",{enumerable:!0,get:function(){return i.DefaultButton}}),o(n(33008),t)},33007:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultButton=void 0;var s=n(30233),l=n(32995),c=n(33004),u=a(n(245)),d=n(33e3),p=n(33001);t.DefaultButton=function(e){var t=e.text,n=e.tooltip,o=e.onClick,i=e.disabled,a=e.accessibilityLabel,d=e.accessibilityDescription,f=e.icon,h=e.menuProps,m=l.getIconProps(f),y=c.getContextualMenuItems(h),g=p.buildLeafStyle(e.style);return u.createElement(s.DefaultButton,r({text:t,title:n,onClick:o,disabled:i,ariaLabel:a,ariaDescription:d,iconProps:m,menuProps:y},g&&{style:g}))},t.DefaultButton.defaultProps=d.DefaultButtonDefaultProps,t.DefaultButton.displayName="DefaultButton"},33008:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},33009:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(33010);Object.defineProperty(t,"Hyperlink",{enumerable:!0,get:function(){return i.Hyperlink}}),o(n(33011),t)},33010:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.hasOwnProperty.call(e,n)&&i(t,e,n);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Hyperlink=void 0;var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.render=function(){return null},t}(s(n(245)).Component);t.Hyperlink=l,t.default=l},33011:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},33012:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(33013);Object.defineProperty(t,"HyperlinkButton",{enumerable:!0,get:function(){return i.HyperlinkButton}}),o(n(33015),t)},33013:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.HyperlinkButton=void 0;var s=n(30226),l=a(n(245)),c=n(33014),u=n(33001);t.HyperlinkButton=function(e){c.validateHyperlinkButtonProps(e);var t=u.buildLeafStyle(e.style);return l.createElement(s.Link,r({children:e.text?e.text:e.url,disabled:e.disabled,href:e.url,onClick:e.url?void 0:e.onClick},t&&{style:t},{title:e.tooltip}))},t.HyperlinkButton.displayName="HyperlinkButton"},33014:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getTooltip=t.validateHyperlinkButtonProps=t.isHyperLinkShowingUrl=void 0,t.isHyperLinkShowingUrl=function(e){return!e.text||!!e.url&&e.text===e.url},t.validateHyperlinkButtonProps=function(e){e.url&&e.onClick&&console.error("onClick should not be specified on HyperlinkButton when a url is provided.  The onClick handler will be ignored"),e.url||e.onClick||console.error("You must specify either an onClick handler, or a url for a HyperlinkButton"),e.text||e.url||console.error("You must specify either the text or the url property")},t.getTooltip=function(e){return e.tooltip||e.text||e.url}},33015:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},33016:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(33017);Object.defineProperty(t,"IconButton",{enumerable:!0,get:function(){return i.IconButton}}),o(n(33019),t)},33017:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.IconButton=void 0;var s=n(30233),l=n(32995),c=n(33004),u=a(n(245)),d=n(33018),p=n(33001);t.IconButton=function(e){var t=e.accessibilityDescription,n=e.accessibilityLabel,o=e.tooltip,i=e.disabled,a=e.menuProps,d=e.onClick,f=e.icon,h=l.getIconProps(f),m=c.getContextualMenuItems(a),y=p.buildLeafStyle(e.style);return u.createElement(s.IconButton,r({ariaDescription:t,ariaLabel:n,disabled:i,iconProps:h,menuProps:m,onClick:d},y&&{style:y},{title:o}))},t.IconButton.displayName="IconButton",t.IconButton.defaultProps=d.IconButtonDefaultProps},33018:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IconButtonDefaultProps=void 0,t.IconButtonDefaultProps={icon:null,tooltip:null,onClick:null,disabled:!1}},33019:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},33020:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(32995);Object.defineProperty(t,"Image",{enumerable:!0,get:function(){return i.Image}}),o(n(33021),t)},33021:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},33022:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.hasOwnProperty.call(e,n)&&r(t,e,n);return o(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.PalettesContext=t.Palettes=void 0;var a=n(33023);Object.defineProperty(t,"Palettes",{enumerable:!0,get:function(){return a.Palettes}});var s=i(n(245)).createContext(a.Palettes.Default);t.PalettesContext=s},33023:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.hasOwnProperty.call(e,n)&&r(t,e,n);return o(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.PalettesContext=t.Palettes=t.PalettesCollection=void 0;var a=i(n(245)),s=function(){function e(){this._buildIn={ID:0,Bkg:"#FFFFFF",Text:"#262626",TextSecondary:"#666666",TextEmphasis:"#2B579A",TextDisabled:"#B1B1B1",AccentLight:"#E6E6E6",BkgCtl:"#FFFFFFFF",BkgHover:"#EDEBE9",BkgPressed:"#E1DFDD",BkgDisabled:"#D2D0CE",TextRest:"#262626FF",TextHover:"#262626FF",TextPressed:"#262626FF",TextLink:"357FCAFF"}}return Object.defineProperty(e.prototype,"Default",{get:function(){return this._buildIn},enumerable:!1,configurable:!0}),e.prototype.getPalette=function(e){return this._buildIn},e}();t.PalettesCollection=s,t.Palettes=new s,t.PalettesContext=a.createContext(t.Palettes.Default)},33024:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(33025);Object.defineProperty(t,"PersonaImage",{enumerable:!0,get:function(){return i.PersonaImage}}),o(n(33027),t)},33025:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.hasOwnProperty.call(e,n)&&i(t,e,n);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.PersonaImage=t.PersonaInitialsColor=void 0;var l,c=n(30132),u=n(30204),d=s(n(245)),p=n(33024),f=n(33026);function h(e){switch(e){case p.PersonaImageSize.extraSmall:return c.PersonaSize.size8;case p.PersonaImageSize.small:return c.PersonaSize.size24;case p.PersonaImageSize.normal:return c.PersonaSize.size32;case p.PersonaImageSize.large:return c.PersonaSize.size40;case p.PersonaImageSize.extraLarge:return c.PersonaSize.size48;case p.PersonaImageSize.extraExtraLarge:return c.PersonaSize.size72;default:return c.PersonaSize.size32}}!function(e){e[e.lightBlue=0]="lightBlue",e[e.blue=1]="blue",e[e.darkBlue=2]="darkBlue",e[e.teal=3]="teal",e[e.lightGreen=4]="lightGreen",e[e.green=5]="green",e[e.darkGreen=6]="darkGreen",e[e.lightPink=7]="lightPink",e[e.pink=8]="pink",e[e.magenta=9]="magenta",e[e.purple=10]="purple",e[e.black=11]="black",e[e.orange=12]="orange",e[e.red=13]="red",e[e.darkRed=14]="darkRed"}(l=t.PersonaInitialsColor||(t.PersonaInitialsColor={}));var m=Object.keys(l).length/2,y=function(e){function t(t){var n=e.call(this,t)||this;return n._isMounted=!1,n.state={imageBlobUrl:"string"==typeof n.props.source?n.props.source:n.props.source?n.props.source.uri:void 0,brandImageBlobUrl:"string"==typeof n.props.brandIconSource?n.props.brandIconSource:n.props.brandIconSource?n.props.brandIconSource.uri:void 0},n}return o(t,e),t.prototype.componentWillUnmount=function(){this._isMounted=!1},t.prototype.componentDidMount=function(){this._isMounted=!0,this._updateImageSourceUrl(),this._updateBrandImageSourceUrl()},t.prototype.componentDidUpdate=function(e,t){e.source!==this.props.source&&this._updateImageSourceUrl(),e.brandIconSource!==this.props.brandIconSource&&this._updateBrandImageSourceUrl()},t.prototype.render=function(){var e=this.props.displayName,t=this._getTextBoyColor(e),n=f.getInitials(e),r=f.getAccessibilityLabel(e,this.props.accessibilityLabel);if(this.props.brandIconSource){var o=f.getBrandIconSize(this.props.size);return d.createElement("div",{style:{position:"relative",display:"flex",alignSelf:"flex-start"}},d.createElement(c.Persona,{imageUrl:this.state.imageBlobUrl,size:h(this.props.size),hidePersonaDetails:!0,imageAlt:r,text:this.props.displayName,imageInitials:n,initialsColor:t,imageShouldFadeIn:!1}),d.createElement(u.Image,{style:{position:"absolute",right:0,bottom:0,width:o,height:o,zIndex:10},src:this.state.brandImageBlobUrl}))}return d.createElement(c.Persona,{imageUrl:this.state.imageBlobUrl,size:h(this.props.size),hidePersonaDetails:!0,imageAlt:r,text:this.props.displayName,imageInitials:n,initialsColor:t,imageShouldFadeIn:!1})},t.prototype._updateImageSourceUrl=function(){var e=this,t=this.props.source;t&&"string"!=typeof t?this._retrieveImage(t,!0).then((function(n){e._isMounted&&t===e.props.source&&e.setState({imageBlobUrl:n})})):this.setState({imageBlobUrl:t||void 0})},t.prototype._updateBrandImageSourceUrl=function(){var e=this,t=this.props.brandIconSource;t&&"string"!=typeof t?this._retrieveImage(t,!1).then((function(n){e._isMounted&&t===e.props.brandIconSource&&e.setState({brandImageBlobUrl:n})})):this.setState({brandImageBlobUrl:t||void 0})},t.prototype._retrieveImage=function(e,t){var n=this;return fetch(e.uri,{method:"GET",headers:new Headers(e.headers)}).then((function(e){if(200!==e.status)throw console.warn("Status ="+e.status),new Error("Network error:"+e.status);if(e.ok)return e.blob();throw new Error("Network response was not ok.")})).then((function(e){var r=URL.createObjectURL(e);return t&&n.props.onLoad&&n.props.onLoad(),r})).catch((function(e){console.warn("Error retrieving Picture  "+e.message),t&&n.props.onError&&n.props.onError()}))},t.prototype._getTextBoyColor=function(e){if(!e)return null;for(var t=0,n=e.length-1;n>=0;n--){var r=e.charCodeAt(n),o=n%8;t^=(r<<o)+(r>>8-o)}return t%m},t}(d.Component);t.PersonaImage=y,t.default=y},33026:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getBrandIconSize=t.getBackgroundColor=t.getInitialsColor=t.getInitials=t.getAccessibilityLabel=t.PHOTO_ANIMATION_DELAY=t.TEXTBOY_RENDER_DELAY=t.getHash=void 0;var r=n(33027);function o(e){for(var t=0,n=e.length-1;n>=0;n--){var r=e.charCodeAt(n),o=n%8;t^=(r<<o)+(r>>8-o)}return t}t.getHash=o;var i=["rgb(153, 180, 51)","rgb(107, 165, 231)","rgb(231, 115, 189)","rgb(0, 163, 0)","rgb(30, 113, 69)","rgb(255, 0, 151)","rgb(126, 56, 120)","rgb(96, 60, 186)","rgb(29, 29, 29)","rgb(0, 171, 169)","rgb(45, 137, 239)","rgb(43, 87, 151)","rgb(218, 83, 44)","rgb(185, 29, 71)","rgb(238, 17, 17)"];t.TEXTBOY_RENDER_DELAY=100,t.PHOTO_ANIMATION_DELAY=250;t.getAccessibilityLabel=function(e,t){return t||"Picture of "+e};var a=/\(([^)]*)\)/gi,s=/\([^)]*\)|[\0-\u001F\!-/:-@\[-`\{-\u00BF\u0250-\u036F\uD800-\uFFFF]/gi,l=/\s+/gi;t.getInitials=function(e){var t="";if(!e)return t;var n=(e=(e=(e=(e=e.replace(a,"")).replace(s,"")).replace(l," ")).trim()).split(" ");return n.length>=2?(t+=n[0].charAt(0).toUpperCase(),t+=n[n.length-1].charAt(0).toUpperCase()):0!==n.length&&(t+=n[0].charAt(0).toUpperCase()),t},t.getInitialsColor=function(e){return e?"white":"rgb(102,102,102)"},t.getBackgroundColor=function(e,t,n){if(!t)return"rgb(204,204,204)";if(n)return n;if(!e)return"rgb(234,234,234)";var r=o(e);return i[r%i.length]},t.getBrandIconSize=function(e){switch(e){case r.PersonaImageSize.extraSmall:return 8;case r.PersonaImageSize.small:return 12;case r.PersonaImageSize.normal:return 16;case r.PersonaImageSize.large:return 20;case r.PersonaImageSize.extraLarge:return 28;case r.PersonaImageSize.extraExtraLarge:return 36;default:return 0}}},33027:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PersonaImagePresence=t.PersonaImageSize=void 0,function(e){e[e.extraSmall=0]="extraSmall",e[e.small=1]="small",e[e.normal=2]="normal",e[e.large=3]="large",e[e.extraLarge=4]="extraLarge",e[e.extraExtraLarge=5]="extraExtraLarge"}(t.PersonaImageSize||(t.PersonaImageSize={})),function(e){e[e.none=0]="none",e[e.away=1]="away",e[e.online=2]="online",e[e.offline=3]="offline",e[e.doNotDisturb=4]="doNotDisturb",e[e.blocked=5]="blocked",e[e.busy=6]="busy",e[e.oof=7]="oof"}(t.PersonaImagePresence||(t.PersonaImagePresence={}))},33028:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(33029);Object.defineProperty(t,"Pivot",{enumerable:!0,get:function(){return i.Pivot}}),o(n(33030),t)},33029:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.hasOwnProperty.call(e,n)&&i(t,e,n);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Pivot=void 0;var l=n(30725),c=s(n(245)),u=function(e){function t(t){var n=e.call(this,t)||this;return n._onLinkClick=n._onLinkClick.bind(n),n}return o(t,e),t.prototype.render=function(){var e=void 0!==this.props.initialSelectedIndex?this.props.items[this.props.initialSelectedIndex].key:void 0;return c.createElement(l.Pivot,{defaultSelectedKey:e,onLinkClick:this._onLinkClick},this.props.items.map((function(e){return c.createElement(l.PivotItem,{key:e.key,itemKey:e.key,headerText:e.label},e.render())})))},t.prototype.switchToNextTab=function(e){console.warn("SwitchToNextTab not yet implemented")},t.prototype.setSelectedPivotItem=function(e){console.warn("SetTabIndex not yet implemented")},t.prototype._onLinkClick=function(e,t){this.props.onSelectedPivotChanged(e.props.itemKey)},t}(c.Component);t.Pivot=u,t.default=u},33030:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},33031:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Platform=void 0;var r=function(){function e(){}return e.select=function(e){return"web"in e?e.web:e.default},e.OS="web",e}();t.Platform=r},33032:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(33033),t),o(n(33038),t)},33033:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.hasOwnProperty.call(e,n)&&i(t,e,n);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.ReadOnlyDataField=void 0;var l=n(33034),c=s(n(245)),u=n(33037),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.render=function(){var e=this.props.text;return c.createElement(l.Text,{textStyle:this.props.textStyle,numberOfLines:this.props.numberOfLines}," ",e," ")},t.defaultProps=u.ReadOnlyDataFieldDefaultProps,t}(c.Component);t.ReadOnlyDataField=d,t.default=d},33034:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(33035);Object.defineProperty(t,"Text",{enumerable:!0,get:function(){return i.Text}}),o(n(33036),t)},33035:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),l=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.hasOwnProperty.call(e,n)&&a(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Text=void 0;var c=l(n(245)),u=n(33022),d={defaultStyle:{position:"relative",display:"inline",flex:"0 0 auto",overflow:"hidden",whiteSpace:"pre-wrap",overflowWrap:"break-word",msHyphens:"auto"},ellipsis:{position:"relative",display:"inline",flex:"0 0 auto",overflow:"hidden",whiteSpace:"pre",textOverflow:"ellipsis"}},p={SmallStandard:"ms-font-s",SmallSecondary:"ms-font-s",MediumStandard:"ms-font-m",MediumSecondary:"ms-font-m",MediumApp:"ms-font-m",MediumBold:"ms-font-m ms-fontWeight-semibold",MediumBoldApp:"ms-font-m ms-fontWeight-semibold",LargeStandard:"ms-font-m-plus",LargePlusStandard:"ms-font-l",ExtraLargeStandard:"ms-font-xl",HugeStandard:"ms-font-xxl"},f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.render=function(){var e=this;return"string"==typeof this.props.children&&"\n"===this.props.children?c.createElement("br",null):c.createElement(u.PalettesContext.Consumer,null,(function(t){return c.createElement("div",{style:e._getStyles(t),className:p[e.props.textStyle]||"ms-font-m"},e.props.children)}))},t.prototype._getStyles=function(e){var t=i({},1===this.props.numberOfLines?d.ellipsis:d.defaultStyle);if(this.props.disabled)t.color=e.TextDisabled;else switch(this.props.textStyle){case"SmallStandard":t.color=e.Text;break;case"SmallSecondary":t.color=e.TextSecondary;break;case"MediumStandard":t.color=e.Text;break;case"MediumSecondary":t.color=e.TextSecondary;break;case"MediumApp":t.color=e.TextEmphasis;break;case"MediumBold":t.color=e.Text;break;case"MediumBoldApp":t.color=e.TextEmphasis;break;case"LargeStandard":case"LargePlusStandard":case"ExtraLargeStandard":case"HugeStandard":t.color=e.Text;break;default:t.color=e.Text}return t},t}(c.Component);t.Text=f,t.default=f},33036:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},33037:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ReadOnlyDataFieldDefaultProps=void 0,t.ReadOnlyDataFieldDefaultProps={text:"",textStyle:"MediumStandard",numberOfLines:0}},33038:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},33039:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(33040);Object.defineProperty(t,"RichTextInput",{enumerable:!0,get:function(){return i.RichTextInput}}),o(n(33041),t),o(n(33042),t),o(n(33043),t)},33040:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.hasOwnProperty.call(e,n)&&i(t,e,n);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.RichTextInput=void 0;var l=s(n(245)),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.render=function(){return console.warn("RichTextInput not implemented in web"),l.createElement("div",null,"RichTextInput not implemented in web")},t.prototype.setFormattedText=function(e){},t.prototype.getFormattedText=function(){return null},t.prototype.replaceTextAtCurrentIndex=function(e,t){},t.prototype.replaceText=function(e,t,n){},t.prototype.getSelectionStart=function(){return null},t.prototype.getSelectionEnd=function(){return null},t.prototype.getCaretRect=function(){return null},t.prototype.clear=function(){},t.prototype.focus=function(){},t.prototype.blur=function(){},t.prototype.isFocused=function(){return!1},t.prototype.setTextSelection=function(e,t){console.warn("RTI: setTextSelection not implemented")},t}(l.Component);t.RichTextInput=c,t.default=c},33041:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DeltaFormattingType=void 0,function(e){e[e.None=0]="None",e[e.Text=1]="Text",e[e.Image=2]="Image",e[e.Table=4]="Table",e[e.Weight=8]="Weight",e[e.Underline=16]="Underline",e[e.Strikethrough=32]="Strikethrough",e[e.Italic=64]="Italic",e[e.Mention=128]="Mention",e[e.Hyperlink=256]="Hyperlink",e[e.Color=512]="Color",e[e.Highlight=1024]="Highlight",e[e.FontSize=2048]="FontSize",e[e.FontFamily=4096]="FontFamily",e[e.AltText=8192]="AltText",e[e.Optional=16384]="Optional",e[e.Paragraph=32768]="Paragraph",e[e.Language=65536]="Language",e[e.SubsscriptAndSuperscript=131072]="SubsscriptAndSuperscript",e[e.BadMentionFormat=134217728]="BadMentionFormat",e[e.UnknownAttribute=268435456]="UnknownAttribute",e[e.Unsupported=536870912]="Unsupported",e[e.Unknown=1073741824]="Unknown",e[e.TextAndMentions=129]="TextAndMentions",e[e.TextAndParagraph=32769]="TextAndParagraph",e[e.AllFormatting=262143]="AllFormatting",e[e.InvalidFormatting=2013265920]="InvalidFormatting"}(t.DeltaFormattingType||(t.DeltaFormattingType={}))},33042:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DeltaParaOperationAlign=t.DeltaListOperationEndType=t.DeltaListOperationType=void 0,function(e){e[e.None=0]="None",e[e.Bullet=1]="Bullet",e[e.NumberArabic=2]="NumberArabic",e[e.AlphabetLowerCase=3]="AlphabetLowerCase",e[e.AlphabetUpperCase=4]="AlphabetUpperCase",e[e.NumberRomanLowerCase=5]="NumberRomanLowerCase",e[e.NumberRomanUpperCase=6]="NumberRomanUpperCase"}(t.DeltaListOperationType||(t.DeltaListOperationType={})),function(e){e[e.Parenthesis=0]="Parenthesis",e[e.Period=1]="Period",e[e.Plain=2]="Plain",e[e.Minus=3]="Minus"}(t.DeltaListOperationEndType||(t.DeltaListOperationEndType={})),function(e){e[e.Left=0]="Left",e[e.Center=1]="Center",e[e.Right=2]="Right",e[e.Justify=3]="Justify"}(t.DeltaParaOperationAlign||(t.DeltaParaOperationAlign={}))},33043:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RichTextInputDefaultProps=t.CustomKeys=void 0,function(e){e.ESCAPE="ESC",e.ENTER="ENTER",e.UP="UP",e.DOWN="DOWN",e.TAB="TAB",e.BACKSPACE="BACKSPACE",e.DEL="DEL",e.LEFT="LEFT",e.RIGHT="RIGHT"}(t.CustomKeys||(t.CustomKeys={})),t.RichTextInputDefaultProps={listenForCustomKeyEvents:!1,customKeys:[],editable:!0,maximumNumberOfLines:0,scrollEnabled:!0,autoCorrect:!0}},33044:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(33045);Object.defineProperty(t,"Separator",{enumerable:!0,get:function(){return i.Separator}}),o(n(33046),t)},33045:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Separator=void 0;var s=a(n(245)),l=n(33022);t.Separator=function(e){var t=e.vertical,n=t?{width:1}:{height:1};return s.createElement(l.PalettesContext.Consumer,null,(function(o){return s.createElement("div",{style:r({alignSelf:"stretch",flexDirection:t?"column":"row",display:"flex",alignItems:"center"},e.style)},s.createElement("div",{style:r(r({},n),{backgroundColor:o.AccentLight,flexGrow:1})}))}))},t.Separator.displayName="Separator"},33046:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},33047:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(33048);Object.defineProperty(t,"ScrollView",{enumerable:!0,get:function(){return i.ScrollView}}),o(n(33050),t)},33048:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),l=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.hasOwnProperty.call(e,n)&&a(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.ScrollView=void 0;var c=l(n(245)),u=n(33049),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.render=function(){var e,t,n,r;switch(this.props.scrollDirection){case"horizontal":e="hidden",t="auto",n="flex",r="row";break;case"vertical":e="auto",t="hidden",n="block",r="column";break;case"both":e="auto",t="auto",n="block",r="row"}var o={overflowY:e,overflowX:t,display:n,flexDirection:r};return c.createElement("div",{style:i(i(i({},this.props.style),{position:"relative",overflow:"hidden",flexGrow:1,flexShrink:1,alignSelf:"stretch",flex:"1 1 auto"}),o),children:this.props.children})},t.defaultProps=u.ScrollViewDefaultProps,t}(c.Component);t.ScrollView=d,t.default=d},33049:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ScrollViewDefaultProps=void 0,t.ScrollViewDefaultProps={scrollDirection:"vertical"}},33050:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},33051:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(33052);Object.defineProperty(t,"SuggestionsCallout",{enumerable:!0,get:function(){return i.SuggestionsCallout}}),o(n(33054),t)},33052:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.hasOwnProperty.call(e,n)&&i(t,e,n);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.SuggestionsCallout=void 0;var l=s(n(245)),c=n(33053),u=function(e){function t(t){var n=e.call(this,t)||this;return n.state={dismiss:!1},n}return o(t,e),t.prototype.render=function(){return null},t.defaultProps=c.SuggestionsCalloutDefaultProps,t}(l.Component);t.SuggestionsCallout=u,t.default=u},33053:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SuggestionsCalloutDefaultProps=void 0,t.SuggestionsCalloutDefaultProps={target:void 0,anchorPos:void 0,onDismiss:void 0}},33054:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},33055:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(33056);Object.defineProperty(t,"Spinner",{enumerable:!0,get:function(){return i.Spinner}}),o(n(33057),t)},33056:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.hasOwnProperty.call(e,n)&&i(t,e,n);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Spinner=void 0;var l=n(30497),c=s(n(245)),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.render=function(){var e=this.props,t=e.size,n=e.label;return c.createElement(l.Spinner,{label:n,size:this._convertSize(t)})},t.prototype._convertSize=function(e){switch(e){case"xsmall":return l.SpinnerSize.xSmall;case"small":return l.SpinnerSize.small;case"medium":return l.SpinnerSize.medium;case"large":return l.SpinnerSize.large;default:return}},t}(c.Component);t.Spinner=u,t.default=u},33057:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},33058:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.hasOwnProperty.call(e,n)&&i(t,e,n);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.StackView=void 0;var l=s(n(245)),c=n(33059),u=function(){},d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={highlighted:-1},t.isHighlighted=function(e){var n=t.state.highlighted;return n===e||n===e+1},t.separators=function(e){return{highlight:function(){return t.setState({highlighted:e})},unhighlight:function(){return t.setState({highlighted:-1})},updateProps:u}},t.shouldDrawSeparator=function(e,t){return t<e.length-1},t}return o(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.ItemSeparatorComponent,r=t.horizontal,o=t.data,i=t.keyExtractor,a=t.renderItem;return o&&0!==o.length?l.createElement(c.View,{style:r?{flexDirection:"row"}:{flexDirection:"column"}},o.map((function(t,s){var u=a({item:t,index:s,separators:e.separators(s)});return u?l.createElement(c.View,{key:i(t,s),style:r?{flexDirection:"row"}:{flexDirection:"column"}},u,n&&e.shouldDrawSeparator(o,s)?l.createElement(n,{highlighted:e.isHighlighted(s),vertical:r}):null):null}))):null},t}(l.PureComponent);t.StackView=d},33059:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(33060);Object.defineProperty(t,"View",{enumerable:!0,get:function(){return i.View}}),o(n(33061),t)},33060:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),l=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.hasOwnProperty.call(e,n)&&a(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.View=void 0;var c=l(n(245)),u=n(33001),d=function(e){function t(t){return e.call(this,t)||this}return o(t,e),t.prototype.render=function(){return c.createElement("div",i({},u.buildDivProps(this.props)),this.props.children)},t}(c.Component);t.View=d,t.default=d},33061:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EventPhase=void 0,function(e){e[e.None=0]="None",e[e.Capturing=1]="Capturing",e[e.AtTarget=2]="AtTarget",e[e.Bubbling=3]="Bubbling"}(t.EventPhase||(t.EventPhase={}))},33062:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(32998);Object.defineProperty(t,"StyleSheet",{enumerable:!0,get:function(){return r.StyleSheet}})},33063:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(33064),t),o(n(33065),t)},33064:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.hasOwnProperty.call(e,n)&&i(t,e,n);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.TouchableNative=void 0;var l=s(n(245)),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.render=function(){return console.warn("TouchableNative not implemented in web"),l.createElement("div",null,"TouchableNative not implemented in web")},t}(l.Component);t.TouchableNative=c,t.default=c},33065:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},33066:function(e,t,n){"use strict";n.r(t),n.d(t,"NUMBER_OF_TEXT_LINES",(function(){return a})),n.d(t,"getStyles",(function(){return s}));var r=n(30123),o=n(30993),i=n(30994),a=1,s=Object(r.memoizeFunction)((function(e){var t,n,a;return{resolvedCardContainer:Object(r.mergeStyles)({display:"flex",flexDirection:"row",alignItems:"center"}),resolvedCardIcon:Object(r.mergeStyles)((t={width:8,height:8,color:null!==(n=null==e?void 0:e.ResolvedCardTitle)&&void 0!==n?n:o.OfficeColors.GRAY_160,lineHeight:8,margin:"10px 10px 10px 14px"},t[i.MSHighContrastEdgeChromiumSelector]={color:"ButtonText"},t)),resolvedCardLabel:Object(r.mergeStyles)({fontFamily:'"Segoe UI", "Segoe UI Web", Arial, Verdana, sans-serif',fontWeight:r.FontWeights.semibold,color:null!==(a=null==e?void 0:e.ResolvedCardTitle)&&void 0!==a?a:o.OfficeColors.GRAY_160,lineHeight:14})}}))},33067:function(e,t,n){"use strict";n.r(t);var r=n(562),o=n(30123),i=n(31159),a=n(245),s=n(31265),l=n(31109),c=n(32926),u=n(30997),d=n(31288),p=n(32928),f=n(33068),h=n(33072),m=n(31038),y=n(32933),g=n(32961),b=n(32934),v=n(33076),C=n(33078),T=function(e){function t(t,n){var o=e.call(this,t,n)||this;return o.getStyles=function(e){return Object(p.getCommentCardHeaderStyles)(null==e?void 0:e.colors,null==e?void 0:e.styles)},o.renderWithContexts=function(e,t){o.styles=o.getStyles(t);var n=[],i=o.props.displayMode===d.default.Draft||o.props.displayMode===d.default.DraftPreCommitPending,l=e.renderContextType;if(o.props.anchorText){var c=m.getAnchorHintTextId({id:o.props.id,renderContextType:l});n.push({element:a.createElement("div",{id:c,className:o.styles.anchor},o.props.anchorText),visibility:!0,key:c})}if(i){var u=m.getDraftCancelButtonId({id:o.props.id,renderContextType:l});n.push({element:o.renderDraftCancelButton(l),visibility:!0,key:u})}else if(o.props.contextMenuProps&&o.props.contextMenuProps.menuItems.length>0&&n.push({element:a.createElement(h.default,Object(r.__assign)({},o.props.contextMenuProps)),visibility:!o.props.hideActions,key:o.props.contextMenuProps.id}),o.props.reactionButtonProps&&1===o.props.rootAuthorOpacity){var p=m.getCommentLikeButtonID({id:o.props.id,renderContextType:l}),y=o.props.reactionButtonProps.usersByReactionType&&o.props.reactionButtonProps.usersByReactionType[s.ReactionType.Like]?o.props.reactionButtonProps.usersByReactionType[s.ReactionType.Like]:[];n.push({element:a.createElement(f.default,Object(r.__assign)({},o.props.reactionButtonProps)),visibility:y.length>0||!o.props.preventReacting&&!o.props.hideActions,key:p})}var g=n.map((function(e){return a.createElement("div",{key:e.key,className:e.visibility?o.styles.headerItem:o.styles.hiddenHeaderItem},e.element)})),b=1===o.props.rootAuthorOpacity?void 0:{boxShadow:"0px 2px 4px 0px rgba(0, 0, 0, ".concat(.13*(1-o.props.rootAuthorOpacity),")")};return a.createElement("div",{className:o.styles.headerContainer,style:b},o.renderRootPersona(),o.renderRootLabel(l),g.length?a.createElement("div",{className:i?o.styles.headerRightCornerDraft:o.styles.headerRightCorner},g):void 0)},o.render=function(){return u.isWebThemeIntegrationEnabled()||Object(y.consumeContexts)(o.renderWithContexts,g.ComponentTreeIdContext),Object(y.consumeContexts)(o.renderWithContexts,g.ComponentTreeIdContext,c.SemanticStylesProviderContext)},o.cancelDraftButtonKeyDownHandler=o.cancelDraftButtonKeyDownHandler.bind(o),o.cancelDraftButtonClickHandler=o.cancelDraftButtonClickHandler.bind(o),o}return Object(r.__extends)(t,e),t.prototype.cancelDraftButtonClickHandler=function(e){this.props.onCancelDraft(),e.stopPropagation()},t.prototype.cancelDraftButtonKeyDownHandler=function(e){Object(i.normalizeKey)(e.key)===i.KeyboardKey.Enter&&(this.props.onCancelDraft(),e.stopPropagation(),e.preventDefault())},t.prototype.renderDraftCancelButton=function(e){return a.createElement(o.TooltipHost,{content:this.props.localizationAPI.getString(175),tooltipProps:b.commentTooltipProps},this.renderDraftCancelButtonInternal(e))},t.prototype.renderDraftCancelButtonInternal=function(e){return a.createElement("div",{className:this.styles.cancelDraftContainer},a.createElement(o.IconButton,{id:m.getDraftCancelButtonId({id:this.props.id,renderContextType:e}),styles:this.styles.cancelDraftButton,disabled:!1,onClick:this.cancelDraftButtonClickHandler,onKeyDown:this.cancelDraftButtonKeyDownHandler,iconProps:{iconName:"CancelGlyph"},tabIndex:u.shouldUseNewSelectionInteractions()&&!this.props.isTabbable?-1:void 0,ariaLabel:this.props.localizationAPI.getString(46)}))},t.prototype.renderRootPersona=function(){if(0===this.props.rootAuthorOpacity)return null;var e={authorName:Object(l.getUsername)(this.props.author),resolved:this.props.isResolvedCard,isParent:!0,authorColor:this.props.authorColor,authorImageURL:this.props.authorImageURL,opacity:this.props.rootAuthorOpacity};return a.createElement(C.default,Object(r.__assign)({},e))},t.prototype.renderRootLabel=function(e){if(0===this.props.rootAuthorOpacity)return null;var t={authorLine:Object(l.getUsername)(this.props.author),renderContextType:e};return a.createElement("div",{className:this.styles.headerAuthorContainer,style:{opacity:this.props.rootAuthorOpacity}},a.createElement(v.default,Object(r.__assign)({},t)))},t}(a.PureComponent);t.default=T},33068:function(e,t,n){"use strict";n.r(t);var r=n(562),o=n(31176),i=n(30123),a=n(31169),s=n(31172),l=n(245),c=n.n(l),u=n(31126),d=n(32926),p=n(30997),f=n(33069),h=n(33070),m=n(32932),y=n(33071),g=n(31038),b=n(32934),v=function(e){var t,n,o=Object(r.__read)(Object(l.useState)(!1),2),v=o[0],C=o[1],T=c.a.useCallback((function(){C(!0)}),[]),O=c.a.useCallback((function(){C(!1)}),[]),S=Object(d.useSemanticStylesProvider)(),P=Object(f.getStyles)(null==S?void 0:S.colors),x=Object(y.getReactionCount)(e.usersByReactionType,u.ReactionType.Like),I=Object(g.getCommentLikeButtonID)({id:e.commentId,renderContextType:e.renderContextType}),E=Object(g.getCommentLikeUserListContainerId)(I),A=Object(g.getLikeButtonDescriptionId)(I),k=Object(m.getIconName)(Object(y.isReactionTypeSetByCurrentUser)(e.usersByReactionType,u.ReactionType.Like)?23:22),w=c.a.useCallback((function(t){var n=k===Object(m.getIconName)(23);e.onReactionPressed(e.commentId,!n,u.ReactionType.Like),t.stopPropagation(),t.preventDefault()}),[e,k]),_=c.a.useCallback((function(e){if(Object(s.normalizeKey)(e.key)===a.KeyboardKey.ArrowDown&&e.altKey){if(p.isNewCommentLikeUserListEnabled()){var t=document.getElementById(Object(g.getCommentCalloutItemID)(E,0));t&&t.focus()}else{var n=document.getElementById(E);n&&n.focus()}e.stopPropagation(),e.preventDefault()}}),[E]),R=c.a.useCallback((function(e){if(Object(s.normalizeKey)(e.key)===a.KeyboardKey.Escape||Object(s.normalizeKey)(e.key)===a.KeyboardKey.Tab){var t=document.getElementById(I);t&&t.focus(),e.stopPropagation(),e.preventDefault()}}),[I]);return c.a.createElement(i.TooltipHost,{content:null===(t=e.buttonStrings)||void 0===t?void 0:t.buttonLabel,directionalHint:i.DirectionalHint.topCenter,tooltipProps:b.commentTooltipProps},c.a.createElement("span",{id:A,hidden:!0},function(t){var n,r,o;if(t){var i=parseInt(t,10);if(0!==i&&!isNaN(i))return"".concat(t," ").concat(i>1?null===(n=e.buttonStrings)||void 0===n?void 0:n.buttonLabelPlural:null===(r=e.buttonStrings)||void 0===r?void 0:r.buttonLabel,". ").concat(null===(o=e.buttonStrings)||void 0===o?void 0:o.buttonA11yDropdownText)}}(x)),c.a.createElement(i.ActionButton,{toggle:!0,id:I,ariaLabel:null===(n=e.buttonStrings)||void 0===n?void 0:n.buttonLabel,role:"button",styles:P.likeButton,onClick:w,tabIndex:e.isTabbable?0:-1,onFocus:T,onBlur:O,iconProps:{iconName:k},checked:k===Object(m.getIconName)(23),onMouseEnter:T,onMouseLeave:O,onKeyDown:_,"aria-describedby":A},x,function(t){var n;if(!v)return null;var o=Object(y.getPersonaPropsListForReactionType)(e.usersByReactionType,u.ReactionType.Like);if(0===o.length)return null;if(p.isNewCommentLikeUserListEnabled()){var a={userList:o,reactionButtonId:t,reactionLabel:null===(n=e.buttonStrings)||void 0===n?void 0:n.buttonLabel};return c.a.createElement(h.default,Object(r.__assign)({},a))}var s=P.likerItem;return c.a.createElement(i.Callout,{id:E,target:"#".concat(t),isBeakVisible:!1,styles:P.dropdown,onKeyDown:R,role:"list"},o.map((function(e){return c.a.createElement(i.Persona,Object(r.__assign)({role:"listitem"},e,{key:e.itemID,size:i.PersonaSize.size24,styles:s}))})))}(I)))},C=c.a.memo((function(e){return o.useGate(p.areCommentReactionsEnabled,e,v)}));t.default=C},33069:function(e,t,n){"use strict";n.r(t),n.d(t,"LIKE_LIST_MAX_WIDTH",(function(){return s})),n.d(t,"LIKE_LIST_MAX_HEIGHT",(function(){return l})),n.d(t,"getStyles",(function(){return c}));var r=n(30123),o=n(766),i=n(30993),a=n(30994),s=172,l=200,c=Object(r.memoizeFunction)((function(e){var t,n,c,u,d,p,f;return{likeButton:Object(r.mergeStyleSets)({rootPressed:(t={color:null!==(d=null==e?void 0:e.MenuIcon)&&void 0!==d?d:i.OfficeColors.GRAY_H,outline:"none",border:"1px solid",borderColor:null!==(p=null==e?void 0:e.CommonControlBorder)&&void 0!==p?p:o.NeutralColors.gray110,".ms-Fabric--isFocusVisible &:focus::after":a.fabricFocusSelectorStyles,":focus":{outline:"none",borderRadius:"1px",boxShadow:"0px 0px 0px 1px ".concat(i.OfficeColors.FOCUS_BOX)}},t[r.HighContrastSelector]={border:"1px solid"},t),root:(n={backgroundColor:"transparent",color:null!==(f=null==e?void 0:e.SubText)&&void 0!==f?f:i.OfficeColors.GRAY_E,height:"16px",maxHeight:"16px",margin:1,padding:0,border:"1px solid transparent",position:"relative",fontSize:"11px",".ms-Fabric--isFocusVisible &:focus::after":a.fabricFocusSelectorStyles,":focus":{outline:"none",borderRadius:"1px",boxShadow:"0px 0px 0px 1px ".concat(i.OfficeColors.FOCUS_BOX)}},n[r.HighContrastSelector]={border:"1px solid"},n)}),dropdown:Object(r.mergeStyleSets)({root:(c={zIndex:"1",maxWidth:s,maxHeight:l,overflow:"auto",":focus":{outline:"none",borderRadius:"1px",boxShadow:"0px 0px 0px 1px ".concat(i.OfficeColors.FOCUS_BOX)}},c[r.HighContrastSelector]={":focus":{boxShadow:"none",outline:"1px solid ".concat(i.OfficeColors.FOCUS_BOX)}},c),calloutMain:{},beak:{},beakCurtain:{},container:{}}),likerItem:Object(r.mergeStyleSets)({root:(u={margin:"6px",":focus":{outline:"none",borderRadius:"1px",boxShadow:"0px 0px 0px 1px ".concat(i.OfficeColors.FOCUS_BOX)}},u[r.HighContrastSelector]={":focus":{boxShadow:"none",outline:"1px solid ".concat(i.OfficeColors.FOCUS_BOX)}},u),details:{},primaryText:{},secondaryText:{},tertiaryText:{},optionalText:{},textContent:{}})}}))},33070:function(e,t,n){"use strict";n.r(t);var r=n(562),o=n(30123),i=n(31159),a=n(245),s=n.n(a),l=n(33069),c=n(32932),u=n(31038),d=s.a.memo((function(e){return function(e){var t=e.userList,n=Object(l.getStyles)(),a=n.likerItem,d=Object(u.getCommentLikeUserListContainerId)(e.reactionButtonId),p=s.a.useCallback((function(n){if(Object(i.normalizeKey)(n.key)===i.KeyboardKey.ArrowDown){var r=(o=f(n.target))>=t.length-1?0:o+1;(a=document.getElementById(Object(u.getCommentCalloutItemID)(d,r)))&&a.focus()}else if(Object(i.normalizeKey)(n.key)===i.KeyboardKey.ArrowUp){var o,a,s=(o=f(n.target))<=0?t.length-1:o-1;(a=document.getElementById(Object(u.getCommentCalloutItemID)(d,s)))&&a.focus()}else if(Object(i.normalizeKey)(n.key)===i.KeyboardKey.Escape){var l=document.getElementById(e.reactionButtonId);l&&l.focus()}n.stopPropagation(),n.preventDefault()}),[t,d,e.reactionButtonId]);function f(e){if(!e)return 0;var t=e.dataset.index;return t?parseInt(t,10):0}var h=s.a.useCallback((function(t){if(Object(i.normalizeKey)(t.key)===i.KeyboardKey.Escape||Object(i.normalizeKey)(t.key)===i.KeyboardKey.Tab){var n=document.getElementById(e.reactionButtonId);n&&n.focus(),t.stopPropagation(),t.preventDefault()}}),[e.reactionButtonId]);return s.a.createElement(o.Callout,{id:d,target:"#".concat(e.reactionButtonId),isBeakVisible:!1,styles:n.dropdown,onKeyDown:h,role:"application"},s.a.createElement("div",{style:{display:"flex",padding:"6px",gap:"9px"}},s.a.createElement(o.FontIcon,{iconName:Object(c.getIconName)(23)}),s.a.createElement("span",null,e.reactionLabel)),s.a.createElement("div",{role:"list"},t.map((function(e,t){return s.a.createElement(o.Persona,Object(r.__assign)({},e,{id:Object(u.getCommentCalloutItemID)(d,t),"data-index":t,key:e.itemID,size:o.PersonaSize.size24,styles:a,tabIndex:0,role:"listitem",onKeyDown:p}))}))))}(e)}));t.default=d},33071:function(e,t,n){"use strict";n.r(t),n.d(t,"isReactionTypeSetByCurrentUser",(function(){return o})),n.d(t,"getPersonaPropsListForReactionType",(function(){return i})),n.d(t,"getReactionCount",(function(){return a}));var r=n(31109);function o(e,t){if(!e)return!1;var n=e[t];return!!n&&n.some((function(e){return e.IsCurrentUser}))}function i(e,t){if(!e)return[];var n=e[t];return n&&n.length>0?n.map((function(e,t){return{text:Object(r.getUsername)(e),secondaryText:e.UserId,itemID:t.toString()}})):[]}function a(e,t){if(e){var n=e[t];return n&&n.length>0?n.length.toString():void 0}}},33072:function(e,t,n){"use strict";n.r(t);var r=n(562),o=n(31176),i=n(30123),a=n(31169),s=n(31172),l=n(245),c=n(32926),u=n(30997),d=n(32954),p=n(32932),f=n(31038),h=n(32934),m=n(33073),y=n(33074);function g(e,t,n,r,o,i,a){e>0&&i(C(t,Object(m.getContextMenuStyles)(null==a?void 0:a.colors,null==a?void 0:a.styles),n,r,o))}var b=l.memo((function(e){var t=Object(r.__read)(l.useState([]),2),n=t[0],a=t[1],s=Object(c.useSemanticStylesProvider)(),d=Object(m.getContextMenuStyles)(null==s?void 0:s.colors,null==s?void 0:s.styles);return o.useEffect(g,n.length,e.parentId,e.renderContextType,e.itemType,e.menuItems,a,s),l.createElement(i.TooltipHost,{content:e.title,tooltipProps:h.commentTooltipProps},function(e,t,n,r,o){var a=l.useCallback((function(t,i){return function(e,t,n,r,o,i){var a;r.length<1&&o(C(n.parentId,Object(m.getContextMenuStyles)(null==i?void 0:i.colors,null==i?void 0:i.styles),n.renderContextType,n.itemType,n.menuItems));null===(a=n.onMenuClick)||void 0===a||a.apply(void 0)}(0,0,e,n,r,o)}),[e,n,r,o]),s=l.useCallback((function(e){e.stopPropagation()}),[]);return l.createElement(i.IconButton,{id:e.id,ariaLabel:e.ariaLabel,styles:t.iconContextMenuAnchor,onMenuClick:a,onFocus:Object(u.isEnsureCardSelectionOnReverseTabLoopEnabled)()?s:void 0,menuProps:{ariaLabel:e.ariaLabel,className:t.contextMenu,directionalHint:i.DirectionalHint.bottomRightEdge,gapSpace:2,isBeakVisible:!1,shouldFocusOnMount:!1,calloutProps:{styles:t.calloutStyle,finalHeight:1},items:n},menuIconProps:{iconName:Object(p.getIconName)(7),style:{width:16}},tabIndex:e.tabIndex})}(e,d,n,a,s))}));function v(e,t,n){t.onClick(e),n&&n.stopPropagation()}function C(e,t,n,r,o){return r===d.ContextMenuItemType.CardContextMenuItem&&o&&o.length>0?o.map((function(r,i){return{id:f.getContextMenuItemId({id:e,renderContextType:n},r.id||r.text),key:r.id||r.text,iconName:Object(p.getIconName)(r.icon),name:r.text,data:0===i,className:t.menuItem,onClick:function(t){return v(e,r,t)},onKeyDown:function(t){return function(e,t,n,r,o,i){if(Object(s.normalizeKey)(i.key)===a.KeyboardKey.ArrowDown&&0===o){var l=n.id||n.text||"MissingKey",c=document.getElementById(f.getContextMenuItemId({id:e,renderContextType:r},l));if(i.target===c&&t&&t.length>1){var u=t[1].id||t[1].text,d=document.getElementById(f.getContextMenuItemId({id:e,renderContextType:r},u));d&&(d.focus(),i.preventDefault(),i.stopPropagation())}}else Object(s.normalizeKey)(i.key)===a.KeyboardKey.Tab&&(i.preventDefault(),i.stopPropagation())}(e,o,r,n,i,t)},onRender:T}})):r===d.ContextMenuItemType.ActionBarItem&&o&&o.length>0?o.map((function(r,i){return{id:f.getActionBarButtonId({id:e,renderContextType:n},i),key:r.text,iconName:Object(p.getIconName)(r.icon),name:r.text,data:0===i,className:t.menuItem,onClick:function(t){return v(e,r,t)},onKeyDown:function(t){return function(e,t,n,r){if(Object(s.normalizeKey)(r.key)===a.KeyboardKey.ArrowDown){var o=document.getElementById(f.getActionBarButtonId({id:e,renderContextType:n},0));if(r.target===o&&t&&t.length>1){var i=document.getElementById(f.getActionBarButtonId({id:e,renderContextType:n},1));i&&(i.focus(),r.preventDefault(),r.stopPropagation())}}else Object(s.normalizeKey)(r.key)===a.KeyboardKey.Tab&&(r.preventDefault(),r.stopPropagation())}(e,o,n,t)},onRender:T}})):[]}var T=Object(i.memoizeFunction)((function(e,t){var n=Object(r.__assign)(Object(r.__assign)({},e),{dismissMenu:t});return l.createElement(y.default,Object(r.__assign)({},n))}));t.default=b},33073:function(e,t,n){"use strict";n.r(t),n.d(t,"CONTEXT_MENU_MIN_WIDTH",(function(){return l})),n.d(t,"CONTEXT_MENU_MAX_WIDTH",(function(){return c})),n.d(t,"getContextMenuStyles",(function(){return u}));var r=n(30123),o=n(766),i=n(30997),a=n(30993),s=n(30994),l=30,c=172,u=Object(r.memoizeFunction)((function(e,t){var n,u,d,p,f,h,m,y,g;return{iconContextMenuAnchor:{menuIconDisabled:{color:null!==(d=null==e?void 0:e.MenuIconDisabled)&&void 0!==d?d:a.OfficeColors.GRAY_C},menuIcon:(n={color:null!==(p=null==e?void 0:e.MenuIcon)&&void 0!==p?p:a.OfficeColors.GRAY_F,margin:0,width:"16px"},n[r.HighContrastSelector]={color:"ButtonText"},n),menuIconPressed:{color:null!==(f=null==e?void 0:e.MenuIconHoveredPressed)&&void 0!==f?f:a.OfficeColors.GRAY_J},menuIconHovered:Object(r.mergeStyles)({color:null!==(h=null==e?void 0:e.MenuIconHoveredPressed)&&void 0!==h?h:a.OfficeColors.GRAY_J},s.commonHighContrastHoverStyles),rootPressed:{color:i.isWebThemeIntegrationEnabled()?void 0:a.OfficeColors.GRAY_J,backgroundColor:null==e?void 0:e.DefaultButtonPressed},rootHovered:Object(r.mergeStyles)({color:i.isWebThemeIntegrationEnabled()?void 0:s.ButtonColors.BUTTON_HOVER,backgroundColor:null==e?void 0:e.DefaultButtonHovered},s.commonHighContrastHoverStyles),rootFocused:Object(r.mergeStyles)({color:i.isWebThemeIntegrationEnabled()?void 0:a.OfficeColors.GRAY_H,backgroundColor:null==e?void 0:e.DefaultButton,outline:"none",border:"1px solid",borderColor:null!==(m=null==e?void 0:e.CommonControlBorder)&&void 0!==m?m:o.NeutralColors.gray110},s.commonHighContrastFocusStyles),root:{flexShrink:0,height:"10px",width:"20px",minWidth:"20px",border:"1px solid transparent",padding:0,margin:0,color:i.isWebThemeIntegrationEnabled()?void 0:a.OfficeColors.GRAY_E,backgroundColor:null==e?void 0:e.DefaultButton,selectors:{".ms-Fabric--isFocusVisible &:focus::after":s.fabricFocusSelectorStyles,".ms-Button-flexContainer":{position:"relative"}}}},menuItem:Object(r.mergeStyles)({overflow:"hidden",margin:0,padding:0,selectors:i.isWebThemeIntegrationEnabled()?(u={".ms-Button":{color:i.isContextMenuHighContrastFixWebEnabled()?null==e?void 0:e.Text:void 0,selectors:{":hover":{backgroundColor:null==e?void 0:e.DefaultButtonHovered},":active":{backgroundColor:null==e?void 0:e.DefaultButtonPressed}}}},u[r.HighContrastSelector]={".ms-Button:hover":{color:"HighlightText",backgroundColor:"Highlight"},".ms-Button:active":{color:"Field",backgroundColor:"FieldText"},".ms-Button":{color:"ButtonText",backgroundColor:"ButtonFace"}},u):void 0}),contextMenu:Object(r.mergeStyles)({backgroundColor:null==e?void 0:e.CardBackground,minWidth:l,maxWidth:c,paddingTop:"6px",paddingBottom:"6px",margin:0,overflow:"hidden",selectors:{".ms-FocusZone.ms-ContextualMenu.is-open":Object(r.mergeStyles)({display:"flex",alignContent:"flex-end",alignItems:"flex-end",justifyContent:"flex-end",minWidth:l})}}),calloutStyle:{root:{borderColor:null!==(y=null==e?void 0:e.CardBorder)&&void 0!==y?y:a.OfficeColors.COMMENTS_GRAY,boxShadow:null!==(g=null==t?void 0:t.BoxShadowLevel2)&&void 0!==g?g:s.BoxShadowStyles.LEVEL2}}}}))},33074:function(e,t,n){"use strict";n.r(t);var r=n(30123),o=n(245),i=n(33075),a=o.memo((function(e){var t=Object(i.getFluentContextMenuItemButtonStyles)();return o.createElement(r.DefaultButton,{componentRef:e.data?s:void 0,id:e.id,iconProps:{iconName:e.iconName,style:{width:12,height:12,marginTop:"-4px"}},key:e.key,role:"menuitem",ariaLabel:"".concat(e.name),styles:t,"data-is-focusable":!0,onKeyDown:e.onKeyDown,onClick:function(t){e.onClick&&e.onClick(t),e.dismissMenu(t)}},e.name)}));function s(e){e&&e.focus()}t.default=a},33075:function(e,t,n){"use strict";n.r(t),n.d(t,"getFluentContextMenuItemButtonStyles",(function(){return s}));var r=n(30123),o=n(30993),i=n(30994),a=n(33073),s=Object(r.memoizeFunction)((function(){var e;return{root:(e={margin:"3px",padding:0,paddingLeft:"7px",paddingRight:"7px",border:"1px transparent",color:o.OfficeColors.GRAY_E,backgroundColor:"transparent",cursor:"pointer",height:"unset",boxSizing:"border-box",textAlign:"left",minWidth:"30px",maxWidth:a.CONTEXT_MENU_MAX_WIDTH-6,width:"95%"},e[r.HighContrastSelector]={color:"ButtonText"},e),rootHovered:i.commonHighContrastHoverStyles,rootFocused:i.commonHighContrastFocusStyles,textContainer:{flexGrow:0,flexShrink:0},flexContainer:{justifyContent:"flex-start"},label:{fontSize:"12px",fontWeight:"600",textAlign:"left",fontFamily:"inherit",lineHeight:"20px",maxWidth:a.CONTEXT_MENU_MAX_WIDTH-50,margin:0,marginLeft:"5px",marginRight:"10px",padding:0,border:0}}}))},33076:function(e,t,n){"use strict";n.r(t);var r=n(562),o=n(30061),i=n(30123),a=n(31159),s=n(245),l=n(32954),c=n(33068),u=n(33072),d=n(31038),p=n(33077);var f=Object(i.memoizeFunction)((function(e,t){return Object(o.getTelemetryAPI)().assertConditionTag(!!e.localizationAPI,"LocalizationAPI must be present when rendering context menu",595710280),{id:d.getPostLevelContextMenuId({id:e.parentId,renderContextType:t}),parentId:e.parentId,title:e.localizationAPI?e.localizationAPI.getString(123):"",ariaLabel:e.localizationAPI?e.localizationAPI.getString(123):"",onMenuClick:h(e),tabIndex:e.isTabbable?0:-1,renderContextType:t,menuItems:e.actionBarItems,itemType:l.ContextMenuItemType.ActionBarItem}}),5),h=Object(i.memoizeFunction)((function(e){return function(t){e.trySelectPost(),t&&Object(a.normalizeKey)(t.key)===a.KeyboardKey.ArrowDown&&t.preventDefault()}})),m=s.memo((function(e){var t=Object(p.getStyles)();return s.createElement("div",{className:t.header},s.createElement("div",{className:t.author},e.authorLine),function(e){return!e.contextMenuProps||0===e.contextMenuProps.menuItems.length&&0===e.contextMenuProps.actionBarItems.length?null:s.createElement(u.default,Object(r.__assign)({},f(e.contextMenuProps,e.renderContextType)))}(e),e.likeButtonProps?s.createElement(c.default,Object(r.__assign)({},e.likeButtonProps)):void 0)}));t.default=m},33077:function(e,t,n){"use strict";n.r(t),n.d(t,"getStyles",(function(){return a}));var r=n(30123),o=n(30994),i={fontWeight:"600",alignSelf:"baseline",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",marginLeft:"3px",userSelect:"text",fontFamily:"".concat(o.Segoe,", ").concat(o.SegoeSemibold,", ").concat(o.SegoeWeb,", Arial, Verdana, sans-serif"),marginBottom:"1px",fontSize:"14px",lineHeight:"19px",flex:"4 1 auto"},a=Object(r.memoizeFunction)((function(){return{author:Object(r.mergeStyles)(i),header:Object(r.mergeStyles)({display:"flex",direction:"inherit",overflow:"hidden",flexDirection:"row",flexWrap:"nowrap"})}}))},33078:function(e,t,n){"use strict";n.r(t);var r=n(562),o=n(30061),i=n(30123),a=n(245),s=n(32926),l=n(30993),c=n(33079),u=a.memo((function(e){var t,n,u,d=null===(t=Object(s.useSemanticStylesProvider)())||void 0===t?void 0:t.colors,p=null!==(n=null==d?void 0:d.PersonaColorResolved)&&void 0!==n?n:l.OfficeColors.GRAY_70,f=null!==(u=null==d?void 0:d.PersonaInitialsTextColorResolved)&&void 0!==u?u:l.OfficeColors.GRAY_140,h={text:e.authorName,coinSize:20,initialsColor:e.resolved?p:e.authorColor||i.PersonaInitialsColor.purple,initialsTextColor:e.resolved?f:void 0,hidePersonaDetails:!0},m=Object(o.getTelemetryAPI)().getMetadata(),y="-4"===m.ring&&"DC2"===m.dataCenter?h:Object(r.__assign)(Object(r.__assign)({},h),{imageShouldStartVisible:!0,imageUrl:e.authorImageURL,showInitialsUntilImageLoads:!0}),g=Object(c.getStyles)(d);return a.createElement("div",{className:e.isParent?g.personaRootContainer:g.personaContainer,style:e.opacity?{opacity:e.opacity}:void 0},a.createElement(i.PersonaCoin,Object(r.__assign)({},y,{className:e.resolved?g.personaResolved:g.persona})))}));t.default=u},33079:function(e,t,n){"use strict";n.r(t),n.d(t,"PERSONA_ROOT_CONTAINER_MARGIN",(function(){return s})),n.d(t,"PERSONA_CONTAINER_MARGIN",(function(){return l})),n.d(t,"getStyles",(function(){return u}));var r,o,i=n(30123),a=n(30997),s=8,l=6,c={fontFamily:"inherit",justifyContent:"center",selectors:Object(a.isWebThemeIntegrationEnabled)()?(r={},r[".ms-Persona-initials"]={selectors:(o={},o[i.HighContrastSelector]={color:"WindowText"},o)},r):void 0},u=Object(i.memoizeFunction)((function(e){var t,n;return{persona:Object(i.mergeStyles)(c,{selectors:Object(a.isWebThemeIntegrationEnabled)()?(t={},t[".ms-Persona-initials"]={color:null==e?void 0:e.PersonaInitialsTextColor},t):void 0}),personaResolved:Object(i.mergeStyles)(c,{selectors:Object(a.isWebThemeIntegrationEnabled)()?{selectors:(n={},n[".ms-Persona-initials"]={color:null==e?void 0:e.PersonaInitialsTextColorResolved},n)}:void 0}),personaRootContainer:Object(i.mergeStyles)({margin:s,marginLeft:s-2,position:"absolute",left:"-15px"}),personaContainer:Object(i.mergeStyles)({margin:l-2,marginLeft:l+3,marginRight:l-3})}}))},33080:function(e,t,n){"use strict";n.r(t),n.d(t,"AtMentionInfoBar",(function(){return d}));var r=n(245),o=n.n(r),i=n(31109),a=n(32926),s=n(33081),l=n(31038),c=n(32961),u=n(33082),d=o.a.memo((function(e){var t=Object(a.useSemanticStylesProvider)(),n=Object(c.useComponentTreeIdContext)().renderContextType,r=Object(u.getStyles)(null==t?void 0:t.colors),d=[];for(var p in e.currentMentionees){var f=e.currentMentionees[p];if(f&&f.stillInDraft){var h=Object(i.getMentioneeName)(f.mentionee);h&&d.push(h)}}var m=Object(l.getAtMentionExtraInfoContainerID)({id:e.commentId,renderContextType:n});if(0===d.length)return null;var y=Object(s.createFriendlyMentionedUserString)(e.localizationAPI,d);return o.a.createElement("div",{className:r.atMentionMessageContainer,id:m},o.a.createElement("div",{className:r.separator}),o.a.createElement("div",{className:r.atMentionUberMessageContainer},o.a.createElement("span",{className:r.atMentionMessage,"aria-label":y},y)))}))},33081:function(e,t,n){"use strict";function r(e,t){if(0===t.length)return"";var n="";if(1===t.length)n=t[0];else if(2===t.length)n=e.formatString(242,t[0],t[1]);else if(3===t.length)n=e.formatString(243,t[0],t[1],t[2]);else{var r=t.length-1;n=e.formatString(244,t[0],r.toString())}return e.formatString(241,n)}n.r(t),n.d(t,"createFriendlyMentionedUserString",(function(){return r}))},33082:function(e,t,n){"use strict";n.r(t),n.d(t,"getStyles",(function(){return a}));var r=n(30123),o=n(766),i=n(30993),a=Object(r.memoizeFunction)((function(e){var t,n;return{atMentionMessageContainer:Object(r.mergeStyles)({marginTop:7,marginLeft:"2px",marginRight:"2px"}),atMentionMessage:Object(r.mergeStyles)({fontSize:o.FontSizes.size12,lineHeight:"14px",color:null!==(t=null==e?void 0:e.SubText)&&void 0!==t?t:i.OfficeColors.GRAY_E}),atMentionUberMessageContainer:Object(r.mergeStyles)({margin:"".concat(12,"px 0"),display:"flex",gap:"2px"}),separator:Object(r.mergeStyles)({height:"1px",backgroundColor:null!==(n=null==e?void 0:e.SubText)&&void 0!==n?n:i.OfficeColors.GRAY_E})}}))},33083:function(e,t,n){"use strict";n.r(t);var r=n(33084);n.d(t,"CommitBar",(function(){return r.CommitBar}))},33084:function(e,t,n){"use strict";n.r(t),n.d(t,"CommitBar",(function(){return b}));var r=n(562),o=n(3e4),i=n(30061),a=n(30123),s=n(245),l=n(32926),c=n(31396),u=n(31041),d=n(30997),p=n(32932),f=n(32933),h=n(30994),m=n(32934),y=n(33085),g=n(33087),b=function(e){function t(t){var n=e.call(this,t)||this;return n.getStyles=function(e){return d.isWebThemeIntegrationEnabled()?g.getStyles(Object(a.getRTL)(),null==e?void 0:e.colors):g.getStyles(Object(a.getRTL)())},n.renderWithContexts=function(e){return n.styles=n.getStyles(e),s.createElement("div",{className:n.styles.commitBar},n.renderTaskAssigner(),n.renderCommitButtons(n.props.buttons,n.props.tooltipDirection))},n.renderCommitButtons=Object(a.memoizeFunction)((function(e,t){return void 0===e&&(e=[]),e.map((function(e,o){return s.createElement(a.TooltipHost,{key:o,content:e.disabled?void 0:Object(p.getButtonTooltipWithFallback)(e),directionalHint:t,tooltipProps:m.commentTooltipProps},s.createElement(y.DelayedLoadRenderer,{delay:h.SPINNER_DELAY_MS,isLoading:!!e.showDelayedSpinner,key:o,loadingUI:s.createElement(a.Spinner,{size:a.SpinnerSize.small,className:g.replySpinnerStyle})},e.usePrimaryButtonStyling?s.createElement(a.PrimaryButton,Object(r.__assign)({},n.getCommitButtonProps(e))):s.createElement(a.DefaultButton,Object(r.__assign)({},n.getCommitButtonProps(e)))))}))}),5),n.getCommitButtonProps=Object(a.memoizeFunction)((function(e){return{id:e.id,disabled:e.disabled,onClick:e.onClick,onKeyDown:e.onKeyDown,ariaLabel:e.accessibilityLabel,tabIndex:e.isTabbable?void 0:-1,iconProps:{iconName:Object(p.getIconName)(e.icon),style:n.styles.icon},styles:n.getCommitButtonStyles(!!e.usePrimaryButtonStyling)}}),5),n.getCommitButtonStyles=function(e){return e?n.styles.primaryButton:n.styles.defaultButton},n.getCommitButtonProps=n.getCommitButtonProps.bind(n),n.renderCommitButtons=n.renderCommitButtons.bind(n),n.state={},n}return Object(r.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this;d.areCommentTasksEnabled()&&Object(c.delayLoadAtMentionComponents)().then((function(t){t?e.setState({taskAssigner:t.TaskAssigner}):Object(i.getTelemetryAPI)().assertConditionTag(!1,"Unable to load lazy at mention components.",577066527)})).catch(Object(u.makeAssertErrorHandler)(o.TelemetryTag.reserveTag(595632141)))},t.prototype.render=function(){return Object(f.consumeContexts)(this.renderWithContexts,l.SemanticStylesProviderContext)},t.prototype.renderTaskAssigner=function(){return this.props.taskAssigner&&this.state.taskAssigner?s.createElement(this.state.taskAssigner,Object(r.__assign)({},this.props.taskAssigner)):null},t}(s.PureComponent)},33085:function(e,t,n){"use strict";n.r(t);var r=n(33086);n.d(t,"DelayedLoadRenderer",(function(){return r.DelayedLoadRenderer}))},33086:function(e,t,n){"use strict";n.r(t),n.d(t,"DelayedLoadRenderer",(function(){return i}));var r=n(562),o=n(245),i=function(e){function t(t){var n=e.call(this,t)||this;return n.state={showLoadingUI:!1},n}return Object(r.__extends)(t,e),t.prototype.setTimer=function(){var e=this;this.timeoutId||(this.timeoutId=setTimeout((function(){e.setState({showLoadingUI:!0}),e.timeoutId=void 0}),this.props.delay))},t.prototype.clearTimer=function(){this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=void 0)},t.prototype.componentDidMount=function(){this.props.isLoading&&this.setTimer()},t.prototype.componentWillUnmount=function(){this.clearTimer()},t.prototype.componentDidUpdate=function(e){!e.isLoading&&this.props.isLoading?this.setTimer():e.isLoading&&!this.props.isLoading&&(this.clearTimer(),this.setState({showLoadingUI:!1}))},t.prototype.render=function(){return this.state.showLoadingUI?this.props.loadingUI:o.Children.only(this.props.children)},t}(o.Component)},33087:function(e,t,n){"use strict";n.r(t),n.d(t,"replySpinnerStyle",(function(){return c})),n.d(t,"getStyles",(function(){return d}));var r=n(30123),o=n(766),i=n(30991),a=n(30997),s=n(32931),l=n(30994),c={marginTop:"8px",zIndex:20,width:"32px",maxHeight:"30px",selectors:{"& .ms-Spinner-circle":{borderColor:s.spinnerBackgroundColor,borderTopColor:s.spinnerPrimaryColor}}},u={maxHeight:"24px",width:"37px",minWidth:"37px",padding:0,margin:1,marginRight:2,marginLeft:3},d=Object(r.memoizeFunction)((function(e,t){var n,s,c,d,p,f,h,m,y;return{commitBar:Object(r.mergeStyles)({marginBottom:"5px",marginTop:"1px",maxHeight:"30px",display:"flex",flexDirection:"row",flexWrap:"nowrap",justifyContent:"flex-end"}),primaryButton:Object(l.setHighContrastButtonStyles)({root:Object(r.mergeStyles)(u,{backgroundColor:null!==(n=null==t?void 0:t.PrimaryButton)&&void 0!==n?n:Object(i.getWebAppColors)().primary,borderColor:null!==(s=null==t?void 0:t.PrimaryButton)&&void 0!==s?s:Object(i.getWebAppColors)().primary},e&&{transform:"scaleX(-1)"}),rootPressed:{backgroundColor:null!==(c=null==t?void 0:t.PrimaryButtonPressed)&&void 0!==c?c:Object(i.getWebAppColors)().shade20,borderColor:null!==(d=null==t?void 0:t.PrimaryButtonPressed)&&void 0!==d?d:Object(i.getWebAppColors)().shade20},rootHovered:Object(r.mergeStyles)({backgroundColor:null!==(p=null==t?void 0:t.PrimaryButtonHovered)&&void 0!==p?p:Object(i.getWebAppColors)().shade10,borderColor:null!==(f=null==t?void 0:t.PrimaryButtonHovered)&&void 0!==f?f:Object(i.getWebAppColors)().shade10}),rootFocused:Object(r.mergeStyles)({backgroundColor:null!==(h=null==t?void 0:t.PrimaryButton)&&void 0!==h?h:Object(i.getWebAppColors)().shade10,borderColor:null!==(m=null==t?void 0:t.PrimaryButton)&&void 0!==m?m:Object(i.getWebAppColors)().shade10}),icon:{width:16,color:null==t?void 0:t.PrimaryButtonIcon}}),defaultButton:Object(l.setHighContrastButtonStyles)({root:Object(r.mergeStyles)(u,{borderColor:null!==(y=null==t?void 0:t.CommonControlBorder)&&void 0!==y?y:o.NeutralColors.gray110,backgroundColor:null==t?void 0:t.DefaultButton}),rootPressed:Object(a.isWebThemeIntegrationEnabled)()?{backgroundColor:null==t?void 0:t.DefaultButtonPressed}:void 0,rootHovered:Object(a.isWebThemeIntegrationEnabled)()?{backgroundColor:null==t?void 0:t.DefaultButtonHovered}:void 0,icon:{color:null==t?void 0:t.DefaultButtonIcon,height:"12px",marginBottom:"1px",width:"16px",lineHeight:"12px"}}),icon:{fontFamily:"inherit"}}}))},33088:function(e,t,n){"use strict";n.r(t),n.d(t,"CommentEditorInner",(function(){return f}));var r=n(562),o=n(245),i=n(32953),a=n(33089),s=n(33090),l=n(33091),c=n(32961),u=n(33112),d=n(33113),p=n(33120),f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.render=function(){if(this.props.displayMode!==i.default.Editing){var e={id:this.props.id,accessibilityLabel:this.props.accessibilityLabel,showFullContent:this.props.showFullComment,content:this.props.defaultValue,placeholder:this.props.placeholder,truncationOverlayColor:this.props.truncationOverlayColor,dulledAtMentions:this.props.dulledAtMentions,viewerMode:this.props.useReplyBoxStyling?a.CommentViewerMode.DisabledEditor:this.props.displayMode===i.default.Disabled?a.CommentViewerMode.DisabledComment:a.CommentViewerMode.ReadOnlyComment,truncationUIText:this.props.localizationAPI.getString(229)};return o.createElement(l.default,Object(r.__assign)({},e))}var t=this.props.componentTreeId.renderContextType;return this.props.supportsAtMentions&&Object(s.hasMentionableEditorProps)(this.props)?o.createElement(p.default,Object(r.__assign)({},this.props,{renderContextType:t})):o.createElement(d.default,Object(r.__assign)({},this.props,{renderContextType:t}))},t}(o.PureComponent),h=Object(u.wrapContextualizedComponent)(f,{componentTreeId:c.ComponentTreeIdContext},"CommentEditor");t.default=h},33089:function(e,t,n){"use strict";var r;n.r(t),n.d(t,"CommentViewerMode",(function(){return r})),function(e){e[e.ReadOnlyComment=0]="ReadOnlyComment",e[e.DisabledComment=1]="DisabledComment",e[e.DisabledEditor=2]="DisabledEditor"}(r||(r={}))},33090:function(e,t,n){"use strict";function r(e){var t=e;return void 0!==t.onMentionCreated&&void 0!==t.onMentioneesStillInDraftUpdated&&void 0!==t.correlationId}n.r(t),n.d(t,"hasMentionableEditorProps",(function(){return r}))},33091:function(e,t,n){"use strict";n.r(t),n.d(t,"CommentViewer",(function(){return m}));var r=n(562),o=n(3e4),i=n(30061),a=n(245),s=n(32926),l=n(30997),c=n(33089),u=n(33092),d=n(31038),p=n(32933),f=n(33107),h=n(31293),m=function(e){function t(t){var n=e.call(this,t)||this;return n.contentRef=null,n.truncationRef=null,n.getStyles=function(e){return l.isWebThemeIntegrationEnabled()||u.getStyles(l.isTruncationUIWithReadMoreTextEnabled(),!1,!1,n.props.truncationOverlayColor,n.props.dulledAtMentions),u.getStyles(l.isTruncationUIWithReadMoreTextEnabled(),!1,!1,n.props.truncationOverlayColor,n.props.dulledAtMentions,!1,null==e?void 0:e.colors,null==e?void 0:e.styles)},n.renderWithContexts=function(e){if(n.state.error)throw n.state.error;n.styles=n.getStyles(e);var t=n.getEditorStyle();return a.createElement("div",{className:t,id:Object(d.getEditorRootDivId)(n.props.id)},a.createElement("div",{ref:n.setContentRef,className:n.styles.InnerEditorDisableFocusOutline,id:Object(d.getEditorFocusContainerId)(n.props.id)}),n.renderTruncationOverlay(n.props.id,n.styles))},n.state={error:null},n.setContentRef=n.setContentRef.bind(n),n.setTruncationRef=n.setTruncationRef.bind(n),n}return Object(r.__extends)(t,e),t.prototype.componentDidMount=function(){this.tryUpdateComponent()},t.prototype.componentDidUpdate=function(e,t){this.tryUpdateComponent(e)},t.prototype.shouldTruncate=function(){return!this.props.showFullContent&&(this.props.content&&Object(h.getPlainTextFromODelta)(this.props.content).length>100||!!this.contentRef&&this.contentRef.offsetHeight>u.truncateStyle.maxHeight)},t.prototype.tryUpdateComponent=function(e){var t=this;requestAnimationFrame((function(){try{t.updateComponent(e)}catch(n){t.setState({error:n instanceof Error?n:new Error(Object(o.stringifyError)(n))})}}))},t.prototype.updateComponent=function(e){this.contentRef&&(e&&this.props.content===e.content?this.props.showFullContent!==e.showFullContent&&this.updateTruncationUI():(Object(f.updateCommentViewerContent)(this.props.id,this.contentRef,this.props.content),this.updateTruncationUI()),!this.props.placeholder||e&&e.placeholder===this.props.placeholder||Object(f.setPlaceholderText)(this.props.id,this.props.placeholder))},t.prototype.setContentRef=function(e){this.contentRef=e},t.prototype.setTruncationRef=function(e){this.truncationRef=e},t.prototype.updateTruncationUI=function(){if(this.props.viewerMode!==c.CommentViewerMode.DisabledEditor)if(this.contentRef){var e=this.shouldTruncate(),t=l.isTruncationUIWithReadMoreTextEnabled()?u.truncateStyle.maxHeight-2*u.EDITOR_PADDING:u.truncateStyle.maxHeight-.75*u.truncateStyle.lineHeight;this.contentRef.style.maxHeight=e?"".concat(t,"px"):"none",this.truncationRef&&(this.truncationRef.style.visibility=e?"visible":"hidden")}else Object(i.getTelemetryAPI)().assertConditionTag(!1,"contentRef should be defined",595658961)},t.prototype.getEditorStyle=function(){switch(this.props.viewerMode){case c.CommentViewerMode.DisabledEditor:return this.styles.EditorPlaceholder;case c.CommentViewerMode.DisabledComment:return this.shouldTruncate()?this.styles.EditorContainerTruncated:this.styles.EditorDisabled;case c.CommentViewerMode.ReadOnlyComment:return this.shouldTruncate()?this.styles.EditorContainerTruncated:this.styles.EditorContainerFullContent;default:return Object(o.unreachable)(this.props.viewerMode),{}}},t.prototype.renderTruncationOverlay=function(e,t){if(this.props.viewerMode===c.CommentViewerMode.DisabledEditor||!1!==this.props.showFullContent)return null;var n=t.EditorTruncationOverlay,r=l.isTruncationUIWithReadMoreTextEnabled()?"".concat(this.props.truncationUIText):"";return a.createElement("div",{id:Object(d.getTruncationOverlayID)(e),className:n,ref:this.setTruncationRef},r)},t.prototype.render=function(){return l.isWebThemeIntegrationEnabled()?Object(p.consumeContexts)(this.renderWithContexts,s.SemanticStylesProviderContext):this.renderWithContexts()},t}(a.PureComponent);t.default=m},33092:function(e,t,n){"use strict";n.r(t),n.d(t,"EDITOR_MIN_HEIGHT",(function(){return d})),n.d(t,"EDITOR_MAX_HEIGHT",(function(){return p})),n.d(t,"EDITOR_REPLYBOX_OR_PLACEHOLDER_PADDING",(function(){return f})),n.d(t,"EDITOR_PADDING",(function(){return h})),n.d(t,"truncateStyle",(function(){return v})),n.d(t,"GetAtMentionStyles",(function(){return _})),n.d(t,"GetHyperlinkStyles",(function(){return R})),n.d(t,"getStyles",(function(){return D}));var r=n(562),o=n(30123),i=n(766),a=n(30991),s=n(30997),l=n(30993),c=n(30994),u=n(33093),d=22,p=96,f=10,h=2;function m(e){var t,n={width:"100%",textAlign:"left",padding:"4px 0px 4px 8px",height:"16px",color:null!==(t=null==e?void 0:e.SmartRepliesText)&&void 0!==t?t:i.NeutralColors.gray140,backgroundColor:null==e?void 0:e.CardBackground,fontFamily:"Segoe UI",fontSize:i.FontSizes.size12,fontWeight:"400",lineHeight:"16px"};return Object(o.mergeStyles)(n)}function y(e){var t,n;return Object(o.mergeStyles)(m(e),{backgroundColor:null!==(t=null==e?void 0:e.SuggestedItem)&&void 0!==t?t:l.OfficeColors.SUGGESTED_PICKER_ITEM,":hover":{backgroundColor:null!==(n=null==e?void 0:e.SuggestedItemHovered)&&void 0!==n?n:l.OfficeColors.SUGGESTED_PICKER_ITEM_HOVER}})}function g(e){var t;return Object(o.mergeStyles)({padding:"5px 0px 5px 8px",height:"16px",color:null!==(t=null==e?void 0:e.ResolvedCardText)&&void 0!==t?t:i.NeutralColors.gray130,backgroundColor:null==e?void 0:e.CardBackground,fontFamily:"Segoe UI",fontSize:"11px",fontWeight:"400",lineHeight:"16px"})}function b(e,t){var n,r;return Object(o.mergeStyles)({boxShadow:null==t?void 0:t.CalloutBoxShadow,selectors:{".ms-Button":{backgroundColor:null==e?void 0:e.CardBackground,color:null==e?void 0:e.Text,selectors:{span:{color:null==e?void 0:e.Text,selectors:{":hover":{backgroundColor:null==e?void 0:e.DefaultButtonHovered},":active":{backgroundColor:null==e?void 0:e.DefaultButtonPressed}}}}},".is-suggested":{selectors:{".ms-Button":{backgroundColor:null!==(n=null==e?void 0:e.SuggestedItem)&&void 0!==n?n:l.OfficeColors.SUGGESTED_PICKER_ITEM,selectors:{":hover, span:hover":{backgroundColor:null!==(r=null==e?void 0:e.SuggestedItemHovered)&&void 0!==r?r:l.OfficeColors.SUGGESTED_PICKER_ITEM_HOVER},":active, span:active":{backgroundColor:null==e?void 0:e.DefaultButtonPressed}}}}}}})}var v,C=Object(o.memoizeFunction)((function(e){var t,n,r;return{selectors:{":focus":{outline:"none"},"& .ql-editor":{boxSizing:"border-box",whiteSpace:"pre-wrap",height:"100%",outline:"none",overflow:"hidden",padding:"0",tabSize:"4",wordWrap:"break-word",userSelect:"text"},"& .ql-clipboard":{left:"-100000px",position:"absolute",top:"50%",height:"1px",userSelect:"text",overflowY:"hidden"},"& .ql-editor p":{margin:0,padding:0,userSelect:"text"},"& .ql-editor em, u, strong, span, a, s":{userSelect:"text"},"& .ql-editor.ql-blank::before":(t={color:null!==(r=null==e?void 0:e.SubText)&&void 0!==r?r:l.OfficeColors.GRAY_E,content:"attr(data-placeholder)",fontStyle:"normal",fontFamily:"inherit",fontSize:"12px",marginLeft:"1px",pointerEvents:"none",position:"absolute"},t[o.HighContrastSelector]={color:"ButtonText",backgroundColor:"ButtonFace"},t),"& .ql-color-blue":{color:"blue",textDecoration:"none",selectors:(n={},n[o.HighContrastSelector]={textDecoration:"underline"},n)}}}})),T={boxSizing:"border-box",flexGrow:"1",position:"relative",overflowY:"hidden"},O={boxSizing:"border-box",flexGrow:"1",overflowY:"hidden",position:"relative",margin:0,padding:h,paddingTop:"1px",fontFamily:"inherit",fontSize:12,fontWeight:"normal",lineHeight:1.5.toString(),cursor:"text"},S={maxHeight:p,overflowY:"auto",selectors:{"::-webkit-scrollbar":{width:0}}},P=Object(o.mergeStyles)(O,S,{"-ms-overflow-style":"none","scrollbar-width":"none"}),x={paddingBottom:"5px"},I={minHeight:d,padding:f,paddingTop:"2px",paddingBottom:"4px",borderRadius:c.DEFAULT_BORDER_RADIUS},E={pointerEvents:"none",cursor:"default"};!function(e){e[e.lineHeight=18]="lineHeight",e[e.maxHeight=4*e.lineHeight+2*h]="maxHeight",e[e.verticalOffset=e.maxHeight-e.lineHeight-h]="verticalOffset"}(v||(v={}));var A={},k={maxHeight:v.maxHeight},w=Object(o.memoizeFunction)((function(e,t,n){var i,s,c,u,d=t?{background:null!==(s=null!=e?e:null==n?void 0:n.CardBackground)&&void 0!==s?s:l.OfficeColors.WHITE,cursor:"pointer",color:null!==(c=null==n?void 0:n.PrimaryButton)&&void 0!==c?c:Object(a.getWebAppColors)().primary,fontWeight:"bold"}:{backgroundImage:"linear-gradient(".concat("rgba(255,255,255,0) 0%",", ").concat(null!==(u=null!=e?e:null==n?void 0:n.CardBackground)&&void 0!==u?u:l.OfficeColors.WHITE,")"),selectors:(i={},i[o.HighContrastSelector]={visibility:"hidden !important"},i)};return Object(o.mergeStyles)(Object(r.__assign)({position:"absolute",left:0,top:v.verticalOffset,right:0,bottom:0,visibility:"hidden"},d),j)})),_=Object(o.memoizeFunction)((function(e,t,n){var r,s,l,c,u,d;void 0===e&&(e=!1),void 0===t&&(t=!1);var p={backgroundColor:t?void 0:null!==(s=null==n?void 0:n.AtMentionHighlight)&&void 0!==s?s:i.NeutralColors.gray20,borderRadius:"2px",boxDecorationBreak:"clone",color:e||t?void 0:null!==(l=null==n?void 0:n.AtMentionText)&&void 0!==l?l:i.NeutralColors.gray180,cursor:"default",fontFamily:'"Segoe UI", "Segoe UI Web", Arial, Verdana, sans-serif',fontSize:"12px",fontWeight:"500",padding:"1px 3px",pointerEvents:"none",textDecoration:"none",selectors:(r={},r[o.HighContrastSelector]={textDecoration:"underline"},r)},f=Object(o.mergeStyles)(p,{"-webkit-box-decoration-break":"clone"}),h=null!==(c=null==n?void 0:n.AtMentionToMeHighlight)&&void 0!==c?c:Object(a.getWebAppColors)().tint40,m=null!==(u=null==n?void 0:n.ResolvedCardBackground)&&void 0!==u?u:i.NeutralColors.gray20;return{selectors:{"& .atmention":f,"& .current-user > .atmention":t?f:Object(o.mergeStyles)(f,{color:e?void 0:null!==(d=null==n?void 0:n.AtMentionToMeText)&&void 0!==d?d:Object(a.getWebAppColors)().shade10,backgroundColor:e?m:h,fontWeight:"600"}),"& office-optional":{userSelect:"text"}}}})),R=Object(o.memoizeFunction)((function(e){var t;return{selectors:(t={},t["& ".concat(u.HyperLink.className)]={wordBreak:"break-all"},t),a:Object(s.isWebHyperlinkStylingFixEnabled)()&&void 0!==e?{":not(.atmention)":{color:e.Hyperlink,":visited":{color:e.Hyperlink},":active":{color:e.HyperlinkActive}}}:void 0}})),j={selectors:{":focus":{outline:"none"}}},D=Object(o.memoizeFunction)((function(e,t,n,i,a,s,l,c){var u={};u=t?I:x;var d=n?P:O,p=[C(l),_(a,s,l),R(l)];return{EditorWrapper:Object(o.mergeStyles)(T),EditorContainerEditing:o.mergeStyles.apply(void 0,Object(r.__spreadArray)([d,u],Object(r.__read)(p),!1)),EditorContainerFullContent:o.mergeStyles.apply(void 0,Object(r.__spreadArray)([d,A],Object(r.__read)(p),!1)),EditorContainerTruncated:o.mergeStyles.apply(void 0,Object(r.__spreadArray)([d,A,k,{marginBottom:e?void 0:"6px"}],Object(r.__read)(p),!1)),EditorDisabled:o.mergeStyles.apply(void 0,Object(r.__spreadArray)([d],Object(r.__read)(p),!1)),EditorPlaceholder:o.mergeStyles.apply(void 0,Object(r.__spreadArray)([d,E,I],Object(r.__read)(p),!1)),InnerEditorDisableFocusOutline:Object(o.mergeStyles)(j),EditorTruncationOverlay:Object(o.mergeStyles)(w(i,e,l),j),SmartReplyHeader:g(l),SmartReplyItem:m(l),SuggestedSmartReplyItem:y(l),SmartReplyCallout:b(l,c)}}))},33093:function(e,t,n){"use strict";n.r(t);var r=n(33094);n.d(t,"shouldNavigateOnHyperlinkClick",(function(){return r.shouldNavigateOnHyperlinkClick})),n.d(t,"HyperLink",(function(){return r.HyperLink}));var o=n(33105);n.d(t,"Delta",(function(){return o.Delta})),n.d(t,"Parchment",(function(){return o.Parchment})),n.d(t,"QuillInlineBlot",(function(){return o.QuillInlineBlot})),n.d(t,"QuillLinkBlot",(function(){return o.QuillLinkBlot})),n.d(t,"QuillClipBoard",(function(){return o.QuillClipBoard}))},33094:function(e,t,n){"use strict";n.r(t),n.d(t,"shouldNavigateOnHyperlinkClick",(function(){return a})),n.d(t,"HyperLink",(function(){return s}));var r=n(562),o=n(30061),i=n(33095);function a(e){return!!e&&e.tagName===s.tagName&&e.className===s.className&&"false"===e.contentEditable&&void 0!==e.href}var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.create=function(n){var r=JSON.parse(n),o=!!r.editable;delete r.editable;var i=JSON.stringify(r),a=e.create.call(this,i);return a.setAttribute(t.getDataAttributeName(),i),a.setAttribute("href",this.addURLProtocolIfNeeded(r.url)),a.setAttribute("contenteditable",o.toString()),a.setAttribute("class",t.className),a.setAttribute("className",t.className),a.setAttribute("rel","noreferrer"),a.setAttribute("target","_blank"),a.setAttribute("title",r.url),a.setAttribute("tabindex","-1"),a.addEventListener("click",t.onHyperlinkClicked),a},t.onHyperlinkClicked=function(e){var t=e.target;if(a(t)){Object(o.getTelemetryAPI)().createActivityObject("DraftHyperlinkClicked",Object(o.globalTelemetryVisitor)(o.GlobalTelemetryReason.GlobalAPI),o.ActivityAggregationMode.OnSuccess,o.ActivityDiagnosticLevel.NecessaryServiceDataEvent).successTag(562438278);var n=t.href;Object(i.getRichContentEditAPIInstance)().onHyperlinkClick(n)&&e.preventDefault()}},t.formats=function(e){var t=e.getAttribute(this.getDataAttributeName());return t||(e.href?JSON.stringify({url:this.addURLProtocolIfNeeded(e.href),editable:!0}):void 0)},t.prototype.format=function(n,r){n===t.blotName&&r?this.domNode.setAttribute(t.getDataAttributeName(),r):e.prototype.format.call(this,n,r)},t.prototype.formats=function(){var n=e.prototype.formats.call(this);return n[t.blotName]=t.formats(this.domNode),n},t.getDataAttributeName=function(){return"data-hyperlink"},t.addURLProtocolIfNeeded=function(e){return e.toLowerCase().startsWith("www.")?"https://".concat(e):e},t.blotName="hyperlink",t.tagName="a",t.className="sharedcomments-hyperlink",t}(n(33105).QuillInlineBlot)},33095:function(e,t,n){"use strict";n.r(t);var r=n(33096);n.d(t,"RichContentActionBehavior",(function(){return r.RichContentActionBehavior})),n.d(t,"RichContentCommandsGenMapping",(function(){return r.RichContentCommandsGenMapping})),n.d(t,"RichContentActionBehaviorGenMapping",(function(){return r.RichContentActionBehaviorGenMapping})),n.d(t,"ActionResponseGenMapping",(function(){return r.ActionResponseGenMapping})),n.d(t,"RichContentCommandToDeltaFormattingType",(function(){return r.RichContentCommandToDeltaFormattingType}));var o=n(33099);n.d(t,"getRichContentEditAPIInstance",(function(){return o.getRichContentEditAPIInstance})),n.d(t,"clearRichContentEditAPIInstance",(function(){return o.clearRichContentEditAPIInstance}));n(33102);var i=n(33103);n.d(t,"RichContentEditAPIFactoryGlobal",(function(){return i.RichContentEditAPIFactoryGlobal}))},33096:function(e,t,n){"use strict";n.r(t);var r=n(33097);n.d(t,"RichContentActionBehavior",(function(){return r.RichContentActionBehavior})),n.d(t,"RichContentCommandsGenMapping",(function(){return r.RichContentCommandsGenMapping})),n.d(t,"RichContentActionBehaviorGenMapping",(function(){return r.RichContentActionBehaviorGenMapping})),n.d(t,"ActionResponseGenMapping",(function(){return r.ActionResponseGenMapping})),n.d(t,"RichContentCommandToDeltaFormattingType",(function(){return r.RichContentCommandToDeltaFormattingType}));n(33098)},33097:function(e,t,n){"use strict";n.r(t),n.d(t,"RichContentActionBehavior",(function(){return o})),n.d(t,"RichContentCommandsGenMapping",(function(){return a})),n.d(t,"RichContentActionBehaviorGenMapping",(function(){return s})),n.d(t,"ActionResponseGenMapping",(function(){return l})),n.d(t,"RichContentCommandToDeltaFormattingType",(function(){return c}));var r,o,i=n(33041);!function(e){e[e.Enabled=0]="Enabled",e[e.Execute=1]="Execute",e[e.Query=2]="Query"}(o||(o={}));var a={Bold:0,Highlight:1,InsertHyperlink:2,Italic:3,Strikethrough:4,Underline:5,Color:6},s={Enabled:0,Execute:1,Query:2},l={Fail:0,NotHandled:1,Success:2},c=((r={})[0]=i.DeltaFormattingType.Weight,r[1]=i.DeltaFormattingType.Highlight,r[2]=i.DeltaFormattingType.Hyperlink,r[3]=i.DeltaFormattingType.Italic,r[4]=i.DeltaFormattingType.Strikethrough,r[5]=i.DeltaFormattingType.Underline,r[6]=i.DeltaFormattingType.Color,r)},33098:function(e,t,n){"use strict";n.r(t)},33099:function(e,t,n){"use strict";n.r(t);var r=n(33100);n.d(t,"getRichContentEditAPIInstance",(function(){return r.getRichContentEditAPIInstance})),n.d(t,"clearRichContentEditAPIInstance",(function(){return r.clearRichContentEditAPIInstance}))},33100:function(e,t,n){"use strict";n.r(t),n.d(t,"getRichContentEditAPIInstance",(function(){return i})),n.d(t,"clearRichContentEditAPIInstance",(function(){return a}));var r,o=n(33101);function i(){return void 0===r&&(r=new o.RichContentEditAPIImpl),r}function a(){r=void 0}},33101:function(e,t,n){"use strict";n.r(t),n.d(t,"RichContentEditAPIImpl",(function(){return a}));var r=n(30061),o=n(33041),i=n(33097),a=function(){function e(){var e=this;this.selectionChangedHandlers=[],this.keypressHandlers=[],this.onHyperlinkClick=function(t){return!!e.hyperlinkNavigator&&e.hyperlinkNavigator(t)},this.onSelectionChangeHandler=function(){e.invokeHandlers(e.selectionChangedHandlers)},this.onKeypressHandler=function(t){e.invokeHandlers(e.keypressHandlers,t)}}return e.prototype.executeCommand=function(e,t,n){var r,i,a,s;if(!this.richContentEditorActor)return 1;if(0===t)return this.isRootCommandEnabled(e)?2:0;if(this.isRootCommandEnabled(e)){if(2===t&&n){var l=this.richContentEditorActor.getFormattingAtCurrentSelection();switch(e){case 0:n.bold=l.bold;break;case 3:n.italic=l.italic;break;case 5:n.underline=l.underline;break;case 4:n.strikethrough=l.strikethrough;break;case 1:n.highlight=l.highlight;break;case 6:n.fontColor=l.fontColor}return 2}var c=void 0,u=void 0;switch(e){case 0:c={type:o.DeltaFormattingType.Weight};break;case 3:c={type:o.DeltaFormattingType.Italic};break;case 5:c={type:o.DeltaFormattingType.Underline};break;case 4:c={type:o.DeltaFormattingType.Strikethrough};break;case 2:if(null===(r=null==n?void 0:n.hyperlinkData)||void 0===r?void 0:r.link){var d=null===(i=null==n?void 0:n.hyperlinkData)||void 0===i?void 0:i.link,p=null!==(s=null===(a=null==n?void 0:n.hyperlinkData)||void 0===a?void 0:a.text)&&void 0!==s?s:d;u={type:o.DeltaFormattingType.Hyperlink,data:{text:p,link:d}}}break;case 1:(null==n?void 0:n.highlight)&&(c={type:o.DeltaFormattingType.Highlight,data:{color:n.highlight.color}});break;case 6:(null==n?void 0:n.fontColor)&&(c={type:o.DeltaFormattingType.Color,data:{fontColor:n.fontColor.color}})}return c&&this.richContentEditorActor.applyFormattingToCurrentSelection(c),u&&this.richContentEditorActor.addContent(u),2}return 0},e.prototype.getSelection=function(){return this.richContentEditorActor?{text:this.richContentEditorActor.getSelection().text}:{text:""}},e.prototype.initRichContentEditor=function(e){Object(r.getTelemetryAPI)().assertConditionTag(!this.richContentEditorActor,"[initRichContentEditor] RichContentEditor already set",590141192),this.richContentEditorActor=e,this.richContentEditorActor.registerSelectionChangeHandler(this.onSelectionChangeHandler),this.richContentEditorActor.registerKeypressHandler(this.onKeypressHandler)},e.prototype.registerSelectionChangeHandler=function(e){e&&this.selectionChangedHandlers.push(e)},e.prototype.registerKeypressHandler=function(e){e&&this.keypressHandlers.push(e)},e.prototype.registerSafelinksNavigator=function(e){e&&(this.hyperlinkNavigator=e)},e.prototype.setFocus=function(){this.richContentEditorActor&&this.richContentEditorActor.setFocus()},e.prototype.isRootCommandEnabled=function(e){return!!this.richContentEditorActor&&this.richContentEditorActor.isFormatEnabled(i.RichContentCommandToDeltaFormattingType[e])},e.prototype.invokeHandlers=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(e)for(var r=0;r<e.length;r++)e[r].apply(e,t)},e}()},33102:function(e,t,n){"use strict";n.r(t)},33103:function(e,t,n){"use strict";n.r(t),n.d(t,"RichContentEditAPIFactoryGlobal",(function(){return r}));var r=new(n(33104).RichContentEditAPIFactory)},33104:function(e,t,n){"use strict";n.r(t),n.d(t,"RichContentEditAPIFactory",(function(){return o}));var r=n(33099),o=function(){function e(){}return e.prototype.getRichContentEditAPI=function(){return Object(r.getRichContentEditAPIInstance)()},e}()},33105:function(e,t,n){"use strict";n.r(t),n.d(t,"Delta",(function(){return i})),n.d(t,"Parchment",(function(){return a})),n.d(t,"QuillInlineBlot",(function(){return s})),n.d(t,"QuillLinkBlot",(function(){return l})),n.d(t,"QuillClipBoard",(function(){return c}));var r=n(33106),o=n.n(r),i=o.a.import("delta"),a=o.a.import("parchment"),s=o.a.import("blots/inline"),l=o.a.import("formats/link"),c=o.a.import("modules/clipboard");t.default=o.a},33106:function(e,t,n){var r;window,r=function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=57)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(9),o=n(10),i=n(11),a=n(32),s=n(33),l=n(34),c=n(35),u=n(36),d=n(7),p=n(17),f=n(18),h=n(16),m=n(3),y={Scope:m.Scope,create:m.create,find:m.find,query:m.query,register:m.register,Container:r.default,Format:o.default,Leaf:i.default,Embed:c.default,Scroll:a.default,Block:l.default,Inline:s.default,Text:u.default,Attributor:{Attribute:d.default,Class:p.default,Style:f.default,Store:h.default}};t.default=y},function(e,t,n){function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o=n(38),i=n(5),a=n(2),s=n(6),l=String.fromCharCode(0),c=function(e){Array.isArray(e)?this.ops=e:null!=e&&Array.isArray(e.ops)?this.ops=e.ops:this.ops=[]};c.prototype.insert=function(e,t){var n={};return 0===e.length?this:(n.insert=e,null!=t&&"object"===r(t)&&Object.keys(t).length>0&&(n.attributes=t),this.push(n))},c.prototype.delete=function(e){return e<=0?this:this.push({delete:e})},c.prototype.retain=function(e,t){if(e<=0)return this;var n={retain:e};return null!=t&&"object"===r(t)&&Object.keys(t).length>0&&(n.attributes=t),this.push(n)},c.prototype.push=function(e){var t=this.ops.length,n=this.ops[t-1];if(e=a(!0,{},e),"object"===r(n)){if("number"==typeof e.delete&&"number"==typeof n.delete)return this.ops[t-1]={delete:n.delete+e.delete},this;if("number"==typeof n.delete&&null!=e.insert&&(t-=1,"object"!==r(n=this.ops[t-1])))return this.ops.unshift(e),this;if(i(e.attributes,n.attributes)){if("string"==typeof e.insert&&"string"==typeof n.insert)return this.ops[t-1]={insert:n.insert+e.insert},"object"===r(e.attributes)&&(this.ops[t-1].attributes=e.attributes),this;if("number"==typeof e.retain&&"number"==typeof n.retain)return this.ops[t-1]={retain:n.retain+e.retain},"object"===r(e.attributes)&&(this.ops[t-1].attributes=e.attributes),this}}return t===this.ops.length?this.ops.push(e):this.ops.splice(t,0,e),this},c.prototype.chop=function(){var e=this.ops[this.ops.length-1];return e&&e.retain&&!e.attributes&&this.ops.pop(),this},c.prototype.filter=function(e){return this.ops.filter(e)},c.prototype.forEach=function(e){this.ops.forEach(e)},c.prototype.map=function(e){return this.ops.map(e)},c.prototype.partition=function(e){var t=[],n=[];return this.forEach((function(r){(e(r)?t:n).push(r)})),[t,n]},c.prototype.reduce=function(e,t){return this.ops.reduce(e,t)},c.prototype.changeLength=function(){return this.reduce((function(e,t){return t.insert?e+s.length(t):t.delete?e-t.delete:e}),0)},c.prototype.length=function(){return this.reduce((function(e,t){return e+s.length(t)}),0)},c.prototype.slice=function(e,t){e=e||0,"number"!=typeof t&&(t=1/0);for(var n=[],r=s.iterator(this.ops),o=0;o<t&&r.hasNext();){var i;o<e?i=r.next(e-o):(i=r.next(t-o),n.push(i)),o+=s.length(i)}return new c(n)},c.prototype.compose=function(e){var t=s.iterator(this.ops),n=s.iterator(e.ops),r=[],o=n.peek();if(null!=o&&"number"==typeof o.retain&&null==o.attributes){for(var a=o.retain;"insert"===t.peekType()&&t.peekLength()<=a;)a-=t.peekLength(),r.push(t.next());o.retain-a>0&&n.next(o.retain-a)}for(var l=new c(r);t.hasNext()||n.hasNext();)if("insert"===n.peekType())l.push(n.next());else if("delete"===t.peekType())l.push(t.next());else{var u=Math.min(t.peekLength(),n.peekLength()),d=t.next(u),p=n.next(u);if("number"==typeof p.retain){var f={};"number"==typeof d.retain?f.retain=u:f.insert=d.insert;var h=s.attributes.compose(d.attributes,p.attributes,"number"==typeof d.retain);if(h&&(f.attributes=h),l.push(f),!n.hasNext()&&i(l.ops[l.ops.length-1],f)){var m=new c(t.rest());return l.concat(m).chop()}}else"number"==typeof p.delete&&"number"==typeof d.retain&&l.push(p)}return l.chop()},c.prototype.concat=function(e){var t=new c(this.ops.slice());return e.ops.length>0&&(t.push(e.ops[0]),t.ops=t.ops.concat(e.ops.slice(1))),t},c.prototype.diff=function(e,t){if(this.ops===e.ops)return new c;var n=[this,e].map((function(t){return t.map((function(n){if(null!=n.insert)return"string"==typeof n.insert?n.insert:l;throw new Error("diff() called "+(t===e?"on":"with")+" non-document")})).join("")})),r=new c,a=o(n[0],n[1],t),u=s.iterator(this.ops),d=s.iterator(e.ops);return a.forEach((function(e){for(var t=e[1].length;t>0;){var n=0;switch(e[0]){case o.INSERT:n=Math.min(d.peekLength(),t),r.push(d.next(n));break;case o.DELETE:n=Math.min(t,u.peekLength()),u.next(n),r.delete(n);break;case o.EQUAL:n=Math.min(u.peekLength(),d.peekLength(),t);var a=u.next(n),l=d.next(n);i(a.insert,l.insert)?r.retain(n,s.attributes.diff(a.attributes,l.attributes)):r.push(l).delete(n)}t-=n}})),r.chop()},c.prototype.eachLine=function(e,t){t=t||"\n";for(var n=s.iterator(this.ops),r=new c,o=0;n.hasNext();){if("insert"!==n.peekType())return;var i=n.peek(),a=s.length(i)-n.peekLength(),l="string"==typeof i.insert?i.insert.indexOf(t,a)-a:-1;if(l<0)r.push(n.next());else if(l>0)r.push(n.next(l));else{if(!1===e(r,n.next(1).attributes||{},o))return;o+=1,r=new c}}r.length()>0&&e(r,{},o)},c.prototype.transform=function(e,t){if(t=!!t,"number"==typeof e)return this.transformPosition(e,t);for(var n=s.iterator(this.ops),r=s.iterator(e.ops),o=new c;n.hasNext()||r.hasNext();)if("insert"!==n.peekType()||!t&&"insert"===r.peekType())if("insert"===r.peekType())o.push(r.next());else{var i=Math.min(n.peekLength(),r.peekLength()),a=n.next(i),l=r.next(i);if(a.delete)continue;l.delete?o.push(l):o.retain(i,s.attributes.transform(a.attributes,l.attributes,t))}else o.retain(s.length(n.next()));return o.chop()},c.prototype.transformPosition=function(e,t){t=!!t;for(var n=s.iterator(this.ops),r=0;n.hasNext()&&r<=e;){var o=n.peekLength(),i=n.peekType();n.next(),"delete"!==i?("insert"===i&&(r<e||!t)&&(e+=o),r+=o):e-=Math.min(o,e-r)}return e},e.exports=c},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o=Object.prototype.hasOwnProperty,i=Object.prototype.toString,a=Object.defineProperty,s=Object.getOwnPropertyDescriptor,l=function(e){return"function"==typeof Array.isArray?Array.isArray(e):"[object Array]"===i.call(e)},c=function(e){if(!e||"[object Object]"!==i.call(e))return!1;var t,n=o.call(e,"constructor"),r=e.constructor&&e.constructor.prototype&&o.call(e.constructor.prototype,"isPrototypeOf");if(e.constructor&&!n&&!r)return!1;for(t in e);return void 0===t||o.call(e,t)},u=function(e,t){a&&"__proto__"===t.name?a(e,t.name,{enumerable:!0,configurable:!0,value:t.newValue,writable:!0}):e[t.name]=t.newValue},d=function(e,t){if("__proto__"===t){if(!o.call(e,t))return;if(s)return s(e,t).value}return e[t]};e.exports=function e(){var t,n,o,i,a,s,p=arguments[0],f=1,h=arguments.length,m=!1;for("boolean"==typeof p&&(m=p,p=arguments[1]||{},f=2),(null==p||"object"!==r(p)&&"function"!=typeof p)&&(p={});f<h;++f)if(null!=(t=arguments[f]))for(n in t)o=d(p,n),p!==(i=d(t,n))&&(m&&i&&(c(i)||(a=l(i)))?(a?(a=!1,s=o&&l(o)?o:[]):s=o&&c(o)?o:{},u(p,{name:n,newValue:e(m,s,i)})):void 0!==i&&u(p,{name:n,newValue:i}));return p}},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.register=t.query=t.find=t.create=t.Scope=t.DATA_KEY=t.ParchmentError=void 0;var i=function(e){function t(t){var n=this;return t="[Parchment] "+t,(n=e.call(this,t)||this).message=t,n.name=n.constructor.name,n}return o(t,e),t}(Error);t.ParchmentError=i;var a,s={},l={},c={},u={};function d(e,t){var n;if(void 0===t&&(t=a.ANY),"string"==typeof e)n=u[e]||s[e];else if(e instanceof Text||e.nodeType===Node.TEXT_NODE)n=u.text;else if("number"==typeof e)e&a.LEVEL&a.BLOCK?n=u.block:e&a.LEVEL&a.INLINE&&(n=u.inline);else if(e instanceof HTMLElement){var r=(e.getAttribute("class")||"").split(/\s+/);for(var o in r)if(n=l[r[o]])break;n=n||c[e.tagName]}return null==n?null:t&a.LEVEL&n.scope&&t&a.TYPE&n.scope?n:null}t.DATA_KEY="__blot",function(e){e[e.TYPE=3]="TYPE",e[e.LEVEL=12]="LEVEL",e[e.ATTRIBUTE=13]="ATTRIBUTE",e[e.BLOT=14]="BLOT",e[e.INLINE=7]="INLINE",e[e.BLOCK=11]="BLOCK",e[e.BLOCK_BLOT=10]="BLOCK_BLOT",e[e.INLINE_BLOT=6]="INLINE_BLOT",e[e.BLOCK_ATTRIBUTE=9]="BLOCK_ATTRIBUTE",e[e.INLINE_ATTRIBUTE=5]="INLINE_ATTRIBUTE",e[e.ANY=15]="ANY"}(a=t.Scope||(t.Scope={})),t.create=function(e,t){var n=d(e);if(null==n)throw new i("Unable to create ".concat(e," blot"));var r=n,o=e instanceof Node||e.nodeType===Node.TEXT_NODE?e:r.create(t);return new r(o,t)},t.find=function e(n,r){return void 0===r&&(r=!1),null==n?null:null!=n[t.DATA_KEY]?n[t.DATA_KEY].blot:r?e(n.parentNode,r):null},t.query=d,t.register=function e(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(t.length>1)return t.map((function(t){return e(t)}));var r=t[0];if("string"!=typeof r.blotName&&"string"!=typeof r.attrName)throw new i("Invalid definition");if("abstract"===r.blotName)throw new i("Cannot register abstract class");if(u[r.blotName||r.attrName]=r,"string"==typeof r.keyName)s[r.keyName]=r;else if(null!=r.className&&(l[r.className]=r),null!=r.tagName){Array.isArray(r.tagName)?r.tagName=r.tagName.map((function(e){return e.toUpperCase()})):r.tagName=r.tagName.toUpperCase();var o=Array.isArray(r.tagName)?r.tagName:[r.tagName];o.forEach((function(e){null!=c[e]&&null!=r.className||(c[e]=r)}))}return r}},function(e,t,n){(function(e,t){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var r=function(){"use strict";function t(e,t){return null!=t&&e instanceof t}var r,o,i;try{r=Map}catch(c){r=function(){}}try{o=Set}catch(c){o=function(){}}try{i=Promise}catch(c){i=function(){}}function a(s,c,u,d,p){"object"===n(c)&&(u=c.depth,d=c.prototype,p=c.includeNonEnumerable,c=c.circular);var f=[],h=[],m=void 0!==e;return void 0===c&&(c=!0),void 0===u&&(u=1/0),function s(u,y){if(null===u)return null;if(0===y)return u;var g,b;if("object"!=n(u))return u;if(t(u,r))g=new r;else if(t(u,o))g=new o;else if(t(u,i))g=new i((function(e,t){u.then((function(t){e(s(t,y-1))}),(function(e){t(s(e,y-1))}))}));else if(a.__isArray(u))g=[];else if(a.__isRegExp(u))g=new RegExp(u.source,l(u)),u.lastIndex&&(g.lastIndex=u.lastIndex);else if(a.__isDate(u))g=new Date(u.getTime());else{if(m&&e.isBuffer(u))return g=e.allocUnsafe?e.allocUnsafe(u.length):new e(u.length),u.copy(g),g;t(u,Error)?g=Object.create(u):void 0===d?(b=Object.getPrototypeOf(u),g=Object.create(b)):(g=Object.create(d),b=d)}if(c){var v=f.indexOf(u);if(-1!=v)return h[v];f.push(u),h.push(g)}for(var C in t(u,r)&&u.forEach((function(e,t){var n=s(t,y-1),r=s(e,y-1);g.set(n,r)})),t(u,o)&&u.forEach((function(e){var t=s(e,y-1);g.add(t)})),u){var T;b&&(T=Object.getOwnPropertyDescriptor(b,C)),T&&null==T.set||(g[C]=s(u[C],y-1))}if(Object.getOwnPropertySymbols){var O=Object.getOwnPropertySymbols(u);for(C=0;C<O.length;C++){var S=O[C];(!(x=Object.getOwnPropertyDescriptor(u,S))||x.enumerable||p)&&(g[S]=s(u[S],y-1),x.enumerable||Object.defineProperty(g,S,{enumerable:!1}))}}if(p){var P=Object.getOwnPropertyNames(u);for(C=0;C<P.length;C++){var x,I=P[C];(x=Object.getOwnPropertyDescriptor(u,I))&&x.enumerable||(g[I]=s(u[I],y-1),Object.defineProperty(g,I,{enumerable:!1}))}}return g}(s,u)}function s(e){return Object.prototype.toString.call(e)}function l(e){var t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),t}return a.clonePrototype=function(e){if(null===e)return null;var t=function(){};return t.prototype=e,new t},a.__objToStr=s,a.__isDate=function(e){return"object"===n(e)&&"[object Date]"===s(e)},a.__isArray=function(e){return"object"===n(e)&&"[object Array]"===s(e)},a.__isRegExp=function(e){return"object"===n(e)&&"[object RegExp]"===s(e)},a.__getRegExpFlags=l,a}();"object"===n(t)&&t.exports&&(t.exports=r)}).call(this,n(50).Buffer,n(55)(e))},function(e,t,n){function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o=n(19),i=n(40),a=n(44),s=n(46),l=n(47),c=n(49),u=Date.prototype.getTime;function d(e,t,n){var h=n||{};return!!(h.strict?a(e,t):e===t)||(!e||!t||"object"!==r(e)&&"object"!==r(t)?h.strict?a(e,t):e==t:function(e,t,n){var a,h;if(r(e)!==r(t))return!1;if(p(e)||p(t))return!1;if(e.prototype!==t.prototype)return!1;if(i(e)!==i(t))return!1;var m=s(e),y=s(t);if(m!==y)return!1;if(m||y)return e.source===t.source&&l(e)===l(t);if(c(e)&&c(t))return u.call(e)===u.call(t);var g=f(e),b=f(t);if(g!==b)return!1;if(g||b){if(e.length!==t.length)return!1;for(a=0;a<e.length;a++)if(e[a]!==t[a])return!1;return!0}if(r(e)!==r(t))return!1;try{var v=o(e),C=o(t)}catch(T){return!1}if(v.length!==C.length)return!1;for(v.sort(),C.sort(),a=v.length-1;a>=0;a--)if(v[a]!=C[a])return!1;for(a=v.length-1;a>=0;a--)if(h=v[a],!d(e[h],t[h],n))return!1;return!0}(e,t,h))}function p(e){return null==e}function f(e){return!(!e||"object"!==r(e)||"number"!=typeof e.length||"function"!=typeof e.copy||"function"!=typeof e.slice||e.length>0&&"number"!=typeof e[0])}e.exports=d},function(e,t,n){function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o=n(5),i=n(2),a={attributes:{compose:function(e,t,n){"object"!==r(e)&&(e={}),"object"!==r(t)&&(t={});var o=i(!0,{},t);for(var a in n||(o=Object.keys(o).reduce((function(e,t){return null!=o[t]&&(e[t]=o[t]),e}),{})),e)void 0!==e[a]&&void 0===t[a]&&(o[a]=e[a]);return Object.keys(o).length>0?o:void 0},diff:function(e,t){"object"!==r(e)&&(e={}),"object"!==r(t)&&(t={});var n=Object.keys(e).concat(Object.keys(t)).reduce((function(n,r){return o(e[r],t[r])||(n[r]=void 0===t[r]?null:t[r]),n}),{});return Object.keys(n).length>0?n:void 0},transform:function(e,t,n){if("object"!==r(e))return t;if("object"===r(t)){if(!n)return t;var o=Object.keys(t).reduce((function(n,r){return void 0===e[r]&&(n[r]=t[r]),n}),{});return Object.keys(o).length>0?o:void 0}}},iterator:function(e){return new s(e)},length:function(e){return"number"==typeof e.delete?e.delete:"number"==typeof e.retain?e.retain:"string"==typeof e.insert?e.insert.length:1}};function s(e){this.ops=e,this.index=0,this.offset=0}s.prototype.hasNext=function(){return this.peekLength()<1/0},s.prototype.next=function(e){e||(e=1/0);var t=this.ops[this.index];if(t){var n=this.offset,r=a.length(t);if(e>=r-n?(e=r-n,this.index+=1,this.offset=0):this.offset+=e,"number"==typeof t.delete)return{delete:e};var o={};return t.attributes&&(o.attributes=t.attributes),"number"==typeof t.retain?o.retain=e:"string"==typeof t.insert?o.insert=t.insert.substr(n,e):o.insert=t.insert,o}return{retain:1/0}},s.prototype.peek=function(){return this.ops[this.index]},s.prototype.peekLength=function(){return this.ops[this.index]?a.length(this.ops[this.index])-this.offset:1/0},s.prototype.peekType=function(){return this.ops[this.index]?"number"==typeof this.ops[this.index].delete?"delete":"number"==typeof this.ops[this.index].retain?"retain":"insert":"retain"},s.prototype.rest=function(){if(this.hasNext()){if(0===this.offset)return this.ops.slice(this.index);var e=this.offset,t=this.index,n=this.next(),r=this.ops.slice(this.index);return this.offset=e,this.index=t,[n].concat(r)}return[]},e.exports=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),o=function(){function e(e,t,n){void 0===n&&(n={}),this.attrName=e,this.keyName=t;var o=r.Scope.TYPE&r.Scope.ATTRIBUTE;null!=n.scope?this.scope=n.scope&r.Scope.LEVEL|o:this.scope=r.Scope.ATTRIBUTE,null!=n.whitelist&&(this.whitelist=n.whitelist)}return e.keys=function(e){return[].map.call(e.attributes,(function(e){return e.name}))},e.prototype.add=function(e,t){return!!this.canAdd(e,t)&&(e.setAttribute(this.keyName,t),!0)},e.prototype.canAdd=function(e,t){return null!=r.query(e,r.Scope.BLOT&(this.scope|r.Scope.TYPE))&&(null==this.whitelist||("string"==typeof t?this.whitelist.indexOf(t.replace(/["']/g,""))>-1:this.whitelist.indexOf(t)>-1))},e.prototype.remove=function(e){e.removeAttribute(this.keyName)},e.prototype.value=function(e){var t=e.getAttribute(this.keyName);return this.canAdd(e,t)&&t?t:""},e}();t.default=o},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o=n(19),i="function"==typeof Symbol&&"symbol"===r(Symbol("foo")),a=Object.prototype.toString,s=Array.prototype.concat,l=Object.defineProperty,c=l&&function(){var e={};try{for(var t in l(e,"x",{enumerable:!1,value:e}),e)return!1;return e.x===e}catch(n){return!1}}(),u=function(e,t,n,r){var o;(!(t in e)||"function"==typeof(o=r)&&"[object Function]"===a.call(o)&&r())&&(c?l(e,t,{configurable:!0,enumerable:!1,value:n,writable:!0}):e[t]=n)},d=function(e,t){var n=arguments.length>2?arguments[2]:{},r=o(t);i&&(r=s.call(r,Object.getOwnPropertySymbols(t)));for(var a=0;a<r.length;a+=1)u(e,r[a],t[r[a]],n[r[a]])};d.supportsDescriptors=!!c,e.exports=d},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(31),a=n(15),s=n(3),l=function(e){function t(t){var n=e.call(this,t)||this;return n.build(),n}return o(t,e),t.prototype.appendChild=function(e){this.insertBefore(e)},t.prototype.attach=function(){e.prototype.attach.call(this),this.children.forEach((function(e){e.attach()}))},t.prototype.build=function(){var e=this;this.children=new i.default,[].slice.call(this.domNode.childNodes).reverse().forEach((function(t){try{var n=c(t);e.insertBefore(n,e.children.head||void 0)}catch(r){if(r instanceof s.ParchmentError)return;throw r}}))},t.prototype.deleteAt=function(e,t){if(0===e&&t===this.length())return this.remove();this.children.forEachAt(e,t,(function(e,t,n){e.deleteAt(t,n)}))},t.prototype.descendant=function(e,n){var r=this.children.find(n),o=r[0],i=r[1];return null==e.blotName&&e(o)||null!=e.blotName&&o instanceof e?[o,i]:o instanceof t?o.descendant(e,i):[null,-1]},t.prototype.descendants=function(e,n,r){void 0===n&&(n=0),void 0===r&&(r=Number.MAX_VALUE);var o=[],i=r;return this.children.forEachAt(n,r,(function(n,r,a){(null==e.blotName&&e(n)||null!=e.blotName&&n instanceof e)&&o.push(n),n instanceof t&&(o=o.concat(n.descendants(e,r,i))),i-=a})),o},t.prototype.detach=function(){this.children.forEach((function(e){e.detach()})),e.prototype.detach.call(this)},t.prototype.formatAt=function(e,t,n,r){this.children.forEachAt(e,t,(function(e,t,o){e.formatAt(t,o,n,r)}))},t.prototype.insertAt=function(e,t,n){var r=this.children.find(e),o=r[0],i=r[1];if(o)o.insertAt(i,t,n);else{var a=null==n?s.create("text",t):s.create(t,n);this.appendChild(a)}},t.prototype.insertBefore=function(e,t){if(null!=this.statics.allowedChildren&&!this.statics.allowedChildren.some((function(t){return e instanceof t})))throw new s.ParchmentError("Cannot insert ".concat(e.statics.blotName," into ").concat(this.statics.blotName));e.insertInto(this,t)},t.prototype.length=function(){return this.children.reduce((function(e,t){return e+t.length()}),0)},t.prototype.moveChildren=function(e,t){this.children.forEach((function(n){e.insertBefore(n,t)}))},t.prototype.optimize=function(t){if(e.prototype.optimize.call(this,t),0===this.children.length)if(null!=this.statics.defaultChild){var n=s.create(this.statics.defaultChild);this.appendChild(n),n.optimize(t)}else this.remove()},t.prototype.path=function(e,n){void 0===n&&(n=!1);var r=this.children.find(e,n),o=r[0],i=r[1],a=[[this,e]];return o instanceof t?a.concat(o.path(i,n)):(null!=o&&a.push([o,i]),a)},t.prototype.removeChild=function(e){this.children.remove(e)},t.prototype.replace=function(n){n instanceof t&&n.moveChildren(this),e.prototype.replace.call(this,n)},t.prototype.split=function(e,t){if(void 0===t&&(t=!1),!t){if(0===e)return this;if(e===this.length())return this.next}var n=this.clone();return this.parent.insertBefore(n,this.next),this.children.forEachAt(e,this.length(),(function(e,r,o){e=e.split(r,t),n.appendChild(e)})),n},t.prototype.unwrap=function(){this.moveChildren(this.parent,this.next),this.remove()},t.prototype.update=function(e,t){var n=this,r=[],o=[];e.forEach((function(e){e.target===n.domNode&&"childList"===e.type&&(r.push.apply(r,e.addedNodes),o.push.apply(o,e.removedNodes))})),o.forEach((function(e){if(!(null!=e.parentNode&&"IFRAME"!==e.tagName&&document.body.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY)){var t=s.find(e);null!=t&&(null!=t.domNode.parentNode&&t.domNode.parentNode!==n.domNode||t.detach())}})),r.filter((function(e){return e.parentNode==n.domNode})).sort((function(e,t){return e===t?0:e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_FOLLOWING?1:-1})).forEach((function(e){var t=null;null!=e.nextSibling&&(t=s.find(e.nextSibling));var r=c(e);r.next==t&&null!=r.next||(null!=r.parent&&r.parent.removeChild(n),n.insertBefore(r,t||void 0))}))},t}(a.default);function c(e){var t=s.find(e);if(null==t)try{t=s.create(e)}catch(n){t=s.create(s.Scope.INLINE),[].slice.call(e.childNodes).forEach((function(e){t.domNode.appendChild(e)})),e.parentNode&&e.parentNode.replaceChild(t.domNode,e),t.attach()}return t}t.default=l},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(7),a=n(16),s=n(9),l=n(3),c=function(e){function t(t){var n=e.call(this,t)||this;return n.attributes=new a.default(n.domNode),n}return o(t,e),t.formats=function(e){return"string"==typeof this.tagName||(Array.isArray(this.tagName)?e.tagName.toLowerCase():void 0)},t.prototype.format=function(e,t){var n=l.query(e);n instanceof i.default?this.attributes.attribute(n,t):t&&(null==n||e===this.statics.blotName&&this.formats()[e]===t||this.replaceWith(e,t))},t.prototype.formats=function(){var e=this.attributes.values(),t=this.statics.formats(this.domNode);return null!=t&&(e[this.statics.blotName]=t),e},t.prototype.replaceWith=function(t,n){var r=e.prototype.replaceWith.call(this,t,n);return this.attributes.copy(r),r},t.prototype.update=function(t,n){var r=this;e.prototype.update.call(this,t,n),t.some((function(e){return e.target===r.domNode&&"attributes"===e.type}))&&this.attributes.build()},t.prototype.wrap=function(n,r){var o=e.prototype.wrap.call(this,n,r);return o instanceof t&&o.statics.scope===this.statics.scope&&this.attributes.move(o),o},t}(s.default);t.default=c},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(15),a=n(3),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.value=function(e){return!0},t.prototype.index=function(e,t){return this.domNode===e||this.domNode.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY?Math.min(t,1):-1},t.prototype.position=function(e,t){var n=[].indexOf.call(this.parent.domNode.childNodes,this.domNode);return e>0&&(n+=1),[this.parent.domNode,n]},t.prototype.value=function(){var e;return(e={})[this.statics.blotName]=this.statics.value(this.domNode)||!0,e},t.scope=a.Scope.INLINE_BLOT,t}(i.default);t.default=s},function(e,t,n){"use strict";var r=n(21);e.exports=function(){return r()&&!!Symbol.toStringTag}},function(e,t,n){"use strict";var r=n(42);e.exports=Function.prototype.bind||r},function(e,t,n){"use strict";var r=n(13),o=n(23),i=o("%Function.prototype.apply%"),a=o("%Function.prototype.call%"),s=o("%Reflect.apply%",!0)||r.call(a,i),l=o("%Object.getOwnPropertyDescriptor%",!0),c=o("%Object.defineProperty%",!0),u=o("%Math.max%");if(c)try{c({},"a",{value:1})}catch(p){c=null}e.exports=function(e){var t=s(r,a,arguments);if(l&&c){var n=l(t,"length");n.configurable&&c(t,"length",{value:1+u(0,e.length-(arguments.length-1))})}return t};var d=function(){return s(r,i,arguments)};c?c(e.exports,"apply",{value:d}):e.exports.apply=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),o=function(){function e(e){this.domNode=e,this.domNode[r.DATA_KEY]={blot:this}}return Object.defineProperty(e.prototype,"statics",{get:function(){return this.constructor},enumerable:!1,configurable:!0}),e.create=function(e){if(null==this.tagName)throw new r.ParchmentError("Blot definition missing tagName");var t;return Array.isArray(this.tagName)?("string"==typeof e&&(e=e.toUpperCase(),parseInt(e).toString()===e&&(e=parseInt(e))),t="number"==typeof e?document.createElement(this.tagName[e-1]):this.tagName.indexOf(e)>-1?document.createElement(e):document.createElement(this.tagName[0])):t=document.createElement(this.tagName),this.className&&t.classList.add(this.className),t},e.prototype.attach=function(){null!=this.parent&&(this.scroll=this.parent.scroll)},e.prototype.clone=function(){var e=this.domNode.cloneNode(!1);return r.create(e)},e.prototype.detach=function(){null!=this.parent&&this.parent.removeChild(this),delete this.domNode[r.DATA_KEY]},e.prototype.deleteAt=function(e,t){this.isolate(e,t).remove()},e.prototype.formatAt=function(e,t,n,o){var i=this.isolate(e,t);if(null!=r.query(n,r.Scope.BLOT)&&o)i.wrap(n,o);else if(null!=r.query(n,r.Scope.ATTRIBUTE)){var a=r.create(this.statics.scope);i.wrap(a),a.format(n,o)}},e.prototype.insertAt=function(e,t,n){var o=null==n?r.create("text",t):r.create(t,n),i=this.split(e);this.parent.insertBefore(o,i)},e.prototype.insertInto=function(e,t){void 0===t&&(t=null),null!=this.parent&&this.parent.children.remove(this);var n=null;e.children.insertBefore(this,t),null!=t&&(n=t.domNode),this.domNode.parentNode==e.domNode&&this.domNode.nextSibling==n||e.domNode.insertBefore(this.domNode,n),this.parent=e,this.attach()},e.prototype.isolate=function(e,t){var n=this.split(e);return n.split(t),n},e.prototype.length=function(){return 1},e.prototype.offset=function(e){return void 0===e&&(e=this.parent),null==this.parent||this==e?0:this.parent.children.offset(this)+this.parent.offset(e)},e.prototype.optimize=function(e){null!=this.domNode[r.DATA_KEY]&&delete this.domNode[r.DATA_KEY].mutations},e.prototype.remove=function(){null!=this.domNode.parentNode&&this.domNode.parentNode.removeChild(this.domNode),this.detach()},e.prototype.replace=function(e){null!=e.parent&&(e.parent.insertBefore(this,e.next),e.remove())},e.prototype.replaceWith=function(e,t){var n="string"==typeof e?r.create(e,t):e;return n.replace(this),n},e.prototype.split=function(e,t){return 0===e?this:this.next},e.prototype.update=function(e,t){},e.prototype.wrap=function(e,t){var n="string"==typeof e?r.create(e,t):e;return null!=this.parent&&this.parent.insertBefore(n,this.next),n.appendChild(this),n},e.blotName="abstract",e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7),o=n(17),i=n(18),a=n(3),s=function(){function e(e){this.attributes={},this.domNode=e,this.build()}return e.prototype.attribute=function(e,t){t?e.add(this.domNode,t)&&(null!=e.value(this.domNode)?this.attributes[e.attrName]=e:delete this.attributes[e.attrName]):(e.remove(this.domNode),delete this.attributes[e.attrName])},e.prototype.build=function(){var e=this;this.attributes={};var t=r.default.keys(this.domNode),n=o.default.keys(this.domNode),s=i.default.keys(this.domNode);t.concat(n).concat(s).forEach((function(t){var n=a.query(t,a.Scope.ATTRIBUTE);n instanceof r.default&&(e.attributes[n.attrName]=n)}))},e.prototype.copy=function(e){var t=this;Object.keys(this.attributes).forEach((function(n){var r=t.attributes[n].value(t.domNode);e.format(n,r)}))},e.prototype.move=function(e){var t=this;this.copy(e),Object.keys(this.attributes).forEach((function(e){t.attributes[e].remove(t.domNode)})),this.attributes={}},e.prototype.values=function(){var e=this;return Object.keys(this.attributes).reduce((function(t,n){return t[n]=e.attributes[n].value(e.domNode),t}),{})},e}();t.default=s},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});function i(e,t){return(e.getAttribute("class")||"").split(/\s+/).filter((function(e){return 0===e.indexOf("".concat(t,"-"))}))}Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.keys=function(e){return(e.getAttribute("class")||"").split(/\s+/).map((function(e){return e.split("-").slice(0,-1).join("-")}))},t.prototype.add=function(e,t){return!!this.canAdd(e,t)&&(this.remove(e),e.classList.add("".concat(this.keyName,"-").concat(t)),!0)},t.prototype.remove=function(e){i(e,this.keyName).forEach((function(t){e.classList.remove(t)})),0===e.classList.length&&e.removeAttribute("class")},t.prototype.value=function(e){var t=(i(e,this.keyName)[0]||"").slice(this.keyName.length+1);return this.canAdd(e,t)?t:""},t}(n(7).default);t.default=a},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});function i(e){var t=e.split("-"),n=t.slice(1).map((function(e){return e[0].toUpperCase()+e.slice(1)})).join("");return t[0]+n}Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.keys=function(e){return(e.getAttribute("style")||"").split(";").map((function(e){return e.split(":")[0].trim()}))},t.prototype.add=function(e,t){return!!this.canAdd(e,t)&&(e.style[i(this.keyName)]=t,!0)},t.prototype.remove=function(e){e.style[i(this.keyName)]="",e.getAttribute("style")||e.removeAttribute("style")},t.prototype.value=function(e){var t=e.style[i(this.keyName)];return this.canAdd(e,t)?t:""},t}(n(7).default);t.default=a},function(e,t,n){"use strict";var r=Array.prototype.slice,o=n(20),i=Object.keys,a=i?function(e){return i(e)}:n(39),s=Object.keys;a.shim=function(){return Object.keys?function(){var e=Object.keys(arguments);return e&&e.length===arguments.length}(1,2)||(Object.keys=function(e){return o(e)?s(r.call(e)):s(e)}):Object.keys=a,Object.keys||a},e.exports=a},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o=Object.prototype.toString;e.exports=function(e){var t=o.call(e),n="[object Arguments]"===t;return n||(n="[object Array]"!==t&&null!==e&&"object"===r(e)&&"number"==typeof e.length&&e.length>=0&&"[object Function]"===o.call(e.callee)),n}},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}e.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"===r(Symbol.iterator))return!0;var e={},t=Symbol("test"),n=Object(t);if("string"==typeof t)return!1;if("[object Symbol]"!==Object.prototype.toString.call(t))return!1;if("[object Symbol]"!==Object.prototype.toString.call(n))return!1;for(t in e[t]=42,e)return!1;if("function"==typeof Object.keys&&0!==Object.keys(e).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;var o=Object.getOwnPropertySymbols(e);if(1!==o.length||o[0]!==t)return!1;if(!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var i=Object.getOwnPropertyDescriptor(e,t);if(42!==i.value||!0!==i.enumerable)return!1}return!0}},function(e,t,n){"use strict";var r=n(23),o=n(14),i=o(r("String.prototype.indexOf"));e.exports=function(e,t){var n=r(e,!!t);return"function"==typeof n&&i(e,".prototype.")>-1?o(n):n}},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o=SyntaxError,i=Function,a=TypeError,s=function(e){try{return i('"use strict"; return ('+e+").constructor;")()}catch(t){}},l=Object.getOwnPropertyDescriptor;if(l)try{l({},"")}catch(E){l=null}var c=function(){throw new a},u=l?function(){try{return c}catch(e){try{return l(arguments,"callee").get}catch(t){return c}}}():c,d=n(41)(),p=Object.getPrototypeOf||function(e){return e.__proto__},f={},h="undefined"==typeof Uint8Array?void 0:p(Uint8Array),m={"%AggregateError%":"undefined"==typeof AggregateError?void 0:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?void 0:ArrayBuffer,"%ArrayIteratorPrototype%":d?p([][Symbol.iterator]()):void 0,"%AsyncFromSyncIteratorPrototype%":void 0,"%AsyncFunction%":f,"%AsyncGenerator%":f,"%AsyncGeneratorFunction%":f,"%AsyncIteratorPrototype%":f,"%Atomics%":"undefined"==typeof Atomics?void 0:Atomics,"%BigInt%":"undefined"==typeof BigInt?void 0:BigInt,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?void 0:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":"undefined"==typeof Float32Array?void 0:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?void 0:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?void 0:FinalizationRegistry,"%Function%":i,"%GeneratorFunction%":f,"%Int8Array%":"undefined"==typeof Int8Array?void 0:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?void 0:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?void 0:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":d?p(p([][Symbol.iterator]())):void 0,"%JSON%":"object"===("undefined"==typeof JSON?"undefined":r(JSON))?JSON:void 0,"%Map%":"undefined"==typeof Map?void 0:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&d?p((new Map)[Symbol.iterator]()):void 0,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?void 0:Promise,"%Proxy%":"undefined"==typeof Proxy?void 0:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":"undefined"==typeof Reflect?void 0:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?void 0:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&d?p((new Set)[Symbol.iterator]()):void 0,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?void 0:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":d?p(""[Symbol.iterator]()):void 0,"%Symbol%":d?Symbol:void 0,"%SyntaxError%":o,"%ThrowTypeError%":u,"%TypedArray%":h,"%TypeError%":a,"%Uint8Array%":"undefined"==typeof Uint8Array?void 0:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?void 0:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?void 0:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?void 0:Uint32Array,"%URIError%":URIError,"%WeakMap%":"undefined"==typeof WeakMap?void 0:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?void 0:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?void 0:WeakSet},y={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},g=n(13),b=n(43),v=g.call(Function.call,Array.prototype.concat),C=g.call(Function.apply,Array.prototype.splice),T=g.call(Function.call,String.prototype.replace),O=g.call(Function.call,String.prototype.slice),S=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,P=/\\(\\)?/g,x=function(e){var t=O(e,0,1),n=O(e,-1);if("%"===t&&"%"!==n)throw new o("invalid intrinsic syntax, expected closing `%`");if("%"===n&&"%"!==t)throw new o("invalid intrinsic syntax, expected opening `%`");var r=[];return T(e,S,(function(e,t,n,o){r[r.length]=n?T(o,P,"$1"):t||e})),r},I=function(e,t){var n,r=e;if(b(y,r)&&(r="%"+(n=y[r])[0]+"%"),b(m,r)){var i=m[r];if(i===f&&(i=function e(t){var n;if("%AsyncFunction%"===t)n=s("async function () {}");else if("%GeneratorFunction%"===t)n=s("function* () {}");else if("%AsyncGeneratorFunction%"===t)n=s("async function* () {}");else if("%AsyncGenerator%"===t){var r=e("%AsyncGeneratorFunction%");r&&(n=r.prototype)}else if("%AsyncIteratorPrototype%"===t){var o=e("%AsyncGenerator%");o&&(n=p(o.prototype))}return m[t]=n,n}(r)),void 0===i&&!t)throw new a("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:n,name:r,value:i}}throw new o("intrinsic "+e+" does not exist!")};e.exports=function(e,t){if("string"!=typeof e||0===e.length)throw new a("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof t)throw new a('"allowMissing" argument must be a boolean');var n=x(e),r=n.length>0?n[0]:"",i=I("%"+r+"%",t),s=i.name,c=i.value,u=!1,d=i.alias;d&&(r=d[0],C(n,v([0,1],d)));for(var p=1,f=!0;p<n.length;p+=1){var h=n[p],y=O(h,0,1),g=O(h,-1);if(('"'===y||"'"===y||"`"===y||'"'===g||"'"===g||"`"===g)&&y!==g)throw new o("property names with quotes must have matching quotes");if("constructor"!==h&&f||(u=!0),b(m,s="%"+(r+="."+h)+"%"))c=m[s];else if(null!=c){if(!(h in c)){if(!t)throw new a("base intrinsic for "+e+" exists, but the property is not available.");return}if(l&&p+1>=n.length){var T=l(c,h);c=(f=!!T)&&"get"in T&&!("originalValue"in T.get)?T.get:c[h]}else f=b(c,h),c=c[h];f&&!u&&(m[s]=c)}}return c}},function(e,t,n){"use strict";var r=function(e){return e!=e};e.exports=function(e,t){return 0===e&&0===t?1/e==1/t:e===t||!(!r(e)||!r(t))}},function(e,t,n){"use strict";var r=n(24);e.exports=function(){return"function"==typeof Object.is?Object.is:r}},function(e,t,n){"use strict";var r=Object,o=TypeError;e.exports=function(){if(null!=this&&this!==r(this))throw new o("RegExp.prototype.flags getter called on non-object");var e="";return this.hasIndices&&(e+="d"),this.global&&(e+="g"),this.ignoreCase&&(e+="i"),this.multiline&&(e+="m"),this.dotAll&&(e+="s"),this.unicode&&(e+="u"),this.sticky&&(e+="y"),e}},function(e,t,n){"use strict";var r=n(26),o=n(8).supportsDescriptors,i=Object.getOwnPropertyDescriptor;e.exports=function(){if(o&&"gim"===/a/gim.flags){var e=i(RegExp.prototype,"flags");if(e&&"function"==typeof e.get&&"boolean"==typeof/a/.dotAll)return e.get}return r}},function(e,t,n){"use strict";(function(e){}).call(this,n(56))},function(e,t,n){"use strict";var r=Object.prototype.hasOwnProperty,o="~";function i(){}function a(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function s(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(o=!1)),s.prototype.eventNames=function(){var e,t,n=[];if(0===this._eventsCount)return n;for(t in e=this._events)r.call(e,t)&&n.push(o?t.slice(1):t);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(e)):n},s.prototype.listeners=function(e,t){var n=o?o+e:e,r=this._events[n];if(t)return!!r;if(!r)return[];if(r.fn)return[r.fn];for(var i=0,a=r.length,s=new Array(a);i<a;i++)s[i]=r[i].fn;return s},s.prototype.emit=function(e,t,n,r,i,a){var s=o?o+e:e;if(!this._events[s])return!1;var l,c,u=this._events[s],d=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),d){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,n),!0;case 4:return u.fn.call(u.context,t,n,r),!0;case 5:return u.fn.call(u.context,t,n,r,i),!0;case 6:return u.fn.call(u.context,t,n,r,i,a),!0}for(c=1,l=new Array(d-1);c<d;c++)l[c-1]=arguments[c];u.fn.apply(u.context,l)}else{var p,f=u.length;for(c=0;c<f;c++)switch(u[c].once&&this.removeListener(e,u[c].fn,void 0,!0),d){case 1:u[c].fn.call(u[c].context);break;case 2:u[c].fn.call(u[c].context,t);break;case 3:u[c].fn.call(u[c].context,t,n);break;case 4:u[c].fn.call(u[c].context,t,n,r);break;default:if(!l)for(p=1,l=new Array(d-1);p<d;p++)l[p-1]=arguments[p];u[c].fn.apply(u[c].context,l)}}return!0},s.prototype.on=function(e,t,n){var r=new a(t,n||this),i=o?o+e:e;return this._events[i]?this._events[i].fn?this._events[i]=[this._events[i],r]:this._events[i].push(r):(this._events[i]=r,this._eventsCount++),this},s.prototype.once=function(e,t,n){var r=new a(t,n||this,!0),i=o?o+e:e;return this._events[i]?this._events[i].fn?this._events[i]=[this._events[i],r]:this._events[i].push(r):(this._events[i]=r,this._eventsCount++),this},s.prototype.removeListener=function(e,t,n,r){var a=o?o+e:e;if(!this._events[a])return this;if(!t)return 0==--this._eventsCount?this._events=new i:delete this._events[a],this;var s=this._events[a];if(s.fn)s.fn!==t||r&&!s.once||n&&s.context!==n||(0==--this._eventsCount?this._events=new i:delete this._events[a]);else{for(var l=0,c=[],u=s.length;l<u;l++)(s[l].fn!==t||r&&!s[l].once||n&&s[l].context!==n)&&c.push(s[l]);c.length?this._events[a]=1===c.length?c[0]:c:0==--this._eventsCount?this._events=new i:delete this._events[a]}return this},s.prototype.removeAllListeners=function(e){var t;return e?(t=o?o+e:e,this._events[t]&&(0==--this._eventsCount?this._events=new i:delete this._events[t])):(this._events=new i,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prototype.setMaxListeners=function(){return this},s.prefixed=o,s.EventEmitter=s,e.exports=s},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this.head=this.tail=null,this.length=0}return e.prototype.append=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.insertBefore(e[0],null),e.length>1&&this.append.apply(this,e.slice(1))},e.prototype.contains=function(e){for(var t,n=this.iterator();t=n();)if(t===e)return!0;return!1},e.prototype.insertBefore=function(e,t){e&&(e.next=t,null!=t?(e.prev=t.prev,null!=t.prev&&(t.prev.next=e),t.prev=e,t===this.head&&(this.head=e)):null!=this.tail?(this.tail.next=e,e.prev=this.tail,this.tail=e):(e.prev=null,this.head=this.tail=e),this.length+=1)},e.prototype.offset=function(e){for(var t=0,n=this.head;null!=n;){if(n===e)return t;t+=n.length(),n=n.next}return-1},e.prototype.remove=function(e){this.contains(e)&&(null!=e.prev&&(e.prev.next=e.next),null!=e.next&&(e.next.prev=e.prev),e===this.head&&(this.head=e.next),e===this.tail&&(this.tail=e.prev),this.length-=1)},e.prototype.iterator=function(e){return void 0===e&&(e=this.head),function(){var t=e;return null!=e&&(e=e.next),t}},e.prototype.find=function(e,t){void 0===t&&(t=!1);for(var n,r=this.iterator();n=r();){var o=n.length();if(e<o||t&&e===o&&(null==n.next||0!==n.next.length()))return[n,e];e-=o}return[null,0]},e.prototype.forEach=function(e){for(var t,n=this.iterator();t=n();)e(t)},e.prototype.forEachAt=function(e,t,n){if(!(t<=0))for(var r,o=this.find(e),i=o[0],a=e-o[1],s=this.iterator(i);(r=s())&&a<e+t;){var l=r.length();e>a?n(r,e-a,Math.min(t,a+l-e)):n(r,0,Math.min(l,e+t-a)),a+=l}},e.prototype.map=function(e){return this.reduce((function(t,n){return t.push(e(n)),t}),[])},e.prototype.reduce=function(e,t){for(var n,r=this.iterator();n=r();)t=e(t,n);return t},e}();t.default=r},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(9),a=n(3),s={attributes:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0},l=function(e){function t(t){var n=e.call(this,t)||this;return n.scroll=n,n.observer=new MutationObserver((function(e){n.update(e)})),n.observer.observe(n.domNode,s),n.attach(),n}return o(t,e),t.prototype.detach=function(){e.prototype.detach.call(this),this.observer.disconnect()},t.prototype.deleteAt=function(t,n){this.update(),0===t&&n===this.length()?this.children.forEach((function(e){e.remove()})):e.prototype.deleteAt.call(this,t,n)},t.prototype.formatAt=function(t,n,r,o){this.update(),e.prototype.formatAt.call(this,t,n,r,o)},t.prototype.insertAt=function(t,n,r){this.update(),e.prototype.insertAt.call(this,t,n,r)},t.prototype.optimize=function(t,n){var r=this;void 0===t&&(t=[]),void 0===n&&(n={}),e.prototype.optimize.call(this,n);for(var o=[].slice.call(this.observer.takeRecords());o.length>0;)t.push(o.pop());for(var s=function(e,t){void 0===t&&(t=!0),null!=e&&e!==r&&null!=e.domNode.parentNode&&(null==e.domNode[a.DATA_KEY].mutations&&(e.domNode[a.DATA_KEY].mutations=[]),t&&s(e.parent))},l=function(e){null!=e.domNode[a.DATA_KEY]&&null!=e.domNode[a.DATA_KEY].mutations&&(e instanceof i.default&&e.children.forEach(l),e.optimize(n))},c=t,u=0;c.length>0;u+=1){if(u>=100)throw new Error("[Parchment] Maximum optimize iterations reached");for(c.forEach((function(e){var t=a.find(e.target,!0);null!=t&&(t.domNode===e.target&&("childList"===e.type?(s(a.find(e.previousSibling,!1)),[].forEach.call(e.addedNodes,(function(e){var t=a.find(e,!1);s(t,!1),t instanceof i.default&&t.children.forEach((function(e){s(e,!1)}))}))):"attributes"===e.type&&s(t.prev)),s(t))})),this.children.forEach(l),o=(c=[].slice.call(this.observer.takeRecords())).slice();o.length>0;)t.push(o.pop())}},t.prototype.update=function(t,n){var r=this;void 0===n&&(n={}),(t=t||this.observer.takeRecords()).map((function(e){var t=a.find(e.target,!0);return null==t?null:null==t.domNode[a.DATA_KEY].mutations?(t.domNode[a.DATA_KEY].mutations=[e],t):(t.domNode[a.DATA_KEY].mutations.push(e),null)})).forEach((function(e){null!=e&&e!==r&&null!=e.domNode[a.DATA_KEY]&&e.update(e.domNode[a.DATA_KEY].mutations||[],n)})),null!=this.domNode[a.DATA_KEY].mutations&&e.prototype.update.call(this,this.domNode[a.DATA_KEY].mutations,n),this.optimize(t,n)},t.blotName="scroll",t.defaultChild="block",t.scope=a.Scope.BLOCK_BLOT,t.tagName="DIV",t}(i.default);t.default=l},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(10),a=n(3),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.formats=function(n){if(n.tagName!==t.tagName)return e.formats.call(this,n)},t.prototype.format=function(n,r){var o=this;n!==this.statics.blotName||r?e.prototype.format.call(this,n,r):(this.children.forEach((function(e){e instanceof i.default||(e=e.wrap(t.blotName,!0)),o.attributes.copy(e)})),this.unwrap())},t.prototype.formatAt=function(t,n,r,o){null!=this.formats()[r]||a.query(r,a.Scope.ATTRIBUTE)?this.isolate(t,n).format(r,o):e.prototype.formatAt.call(this,t,n,r,o)},t.prototype.optimize=function(n){e.prototype.optimize.call(this,n);var r=this.formats();if(0===Object.keys(r).length)return this.unwrap();var o=this.next;o instanceof t&&o.prev===this&&function(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(var n in e)if(e[n]!==t[n])return!1;return!0}(r,o.formats())&&(o.moveChildren(this),o.remove())},t.blotName="inline",t.scope=a.Scope.INLINE_BLOT,t.tagName="SPAN",t}(i.default);t.default=s},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(10),a=n(3),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.formats=function(n){var r=a.query(t.blotName).tagName;if(n.tagName!==r)return e.formats.call(this,n)},t.prototype.format=function(n,r){null!=a.query(n,a.Scope.BLOCK)&&(n!==this.statics.blotName||r?e.prototype.format.call(this,n,r):this.replaceWith(t.blotName))},t.prototype.formatAt=function(t,n,r,o){null!=a.query(r,a.Scope.BLOCK)?this.format(r,o):e.prototype.formatAt.call(this,t,n,r,o)},t.prototype.insertAt=function(t,n,r){if(null==r||null!=a.query(n,a.Scope.INLINE))e.prototype.insertAt.call(this,t,n,r);else{var o=this.split(t),i=a.create(n,r);o.parent.insertBefore(i,o)}},t.prototype.update=function(t,n){navigator.userAgent.match(/Trident/)?this.build():e.prototype.update.call(this,t,n)},t.blotName="block",t.scope=a.Scope.BLOCK_BLOT,t.tagName="P",t}(i.default);t.default=s},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.formats=function(e){},t.prototype.format=function(t,n){e.prototype.formatAt.call(this,0,this.length(),t,n)},t.prototype.formatAt=function(t,n,r,o){0===t&&n===this.length()?this.format(r,o):e.prototype.formatAt.call(this,t,n,r,o)},t.prototype.formats=function(){return this.statics.formats(this.domNode)},t}(n(11).default);t.default=i},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(11),a=n(3),s=function(e){function t(t){var n=e.call(this,t)||this;return n.text=n.statics.value(n.domNode),n}return o(t,e),t.create=function(e){return document.createTextNode(e)},t.value=function(e){var t=e.data;return t.normalize&&(t=t.normalize()),t},t.prototype.deleteAt=function(e,t){this.domNode.data=this.text=this.text.slice(0,e)+this.text.slice(e+t)},t.prototype.index=function(e,t){return this.domNode===e?t:-1},t.prototype.insertAt=function(t,n,r){null==r?(this.text=this.text.slice(0,t)+n+this.text.slice(t),this.domNode.data=this.text):e.prototype.insertAt.call(this,t,n,r)},t.prototype.length=function(){return this.text.length},t.prototype.optimize=function(n){e.prototype.optimize.call(this,n),this.text=this.statics.value(this.domNode),0===this.text.length?this.remove():this.next instanceof t&&this.next.prev===this&&(this.insertAt(this.length(),this.next.value()),this.next.remove())},t.prototype.position=function(e,t){return void 0===t&&(t=!1),[this.domNode,e]},t.prototype.split=function(e,t){if(void 0===t&&(t=!1),!t){if(0===e)return this;if(e===this.length())return this.next}var n=a.create(this.domNode.splitText(e));return this.parent.insertBefore(n,this.next),this.text=this.statics.value(this.domNode),n},t.prototype.update=function(e,t){var n=this;e.some((function(e){return"characterData"===e.type&&e.target===n.domNode}))&&(this.text=this.statics.value(this.domNode))},t.prototype.value=function(){return this.text},t.blotName="text",t.scope=a.Scope.INLINE_BLOT,t}(i.default);t.default=s},function(e,t){var n=document.createElement("div");if(n.classList.toggle("test-class",!1),n.classList.contains("test-class")){var r=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(e,t){return arguments.length>1&&!this.contains(e)==!t?t:r.call(this,e)}}String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return t=t||0,this.substr(t,e.length)===e}),String.prototype.endsWith||(String.prototype.endsWith=function(e,t){var n=this.toString();("number"!=typeof t||!isFinite(t)||Math.floor(t)!==t||t>n.length)&&(t=n.length),t-=e.length;var r=n.indexOf(e,t);return-1!==r&&r===t}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(e){if(null===this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var t,n=Object(this),r=n.length>>>0,o=arguments[1],i=0;i<r;i++)if(t=n[i],e.call(o,t,i,n))return t}}),document.addEventListener("DOMContentLoaded",(function(){document.execCommand("enableObjectResizing",!1,!1),document.execCommand("autoUrlDetect",!1,!1)}))},function(e,t){function n(e,t,a){if(e==t)return e?[[0,e]]:[];(a<0||e.length<a)&&(a=null);var l=o(e,t),c=e.substring(0,l);l=i(e=e.substring(l),t=t.substring(l));var u=e.substring(e.length-l),d=function(e,t){var a;if(!e)return[[1,t]];if(!t)return[[-1,e]];var s=e.length>t.length?e:t,l=e.length>t.length?t:e,c=s.indexOf(l);if(-1!=c)return a=[[1,s.substring(0,c)],[0,l],[1,s.substring(c+l.length)]],e.length>t.length&&(a[0][0]=a[2][0]=-1),a;if(1==l.length)return[[-1,e],[1,t]];var u=function(e,t){var n=e.length>t.length?e:t,r=e.length>t.length?t:e;if(n.length<4||2*r.length<n.length)return null;function a(e,t,n){for(var r,a,s,l,c=e.substring(n,n+Math.floor(e.length/4)),u=-1,d="";-1!=(u=t.indexOf(c,u+1));){var p=o(e.substring(n),t.substring(u)),f=i(e.substring(0,n),t.substring(0,u));d.length<f+p&&(d=t.substring(u-f,u)+t.substring(u,u+p),r=e.substring(0,n-f),a=e.substring(n+p),s=t.substring(0,u-f),l=t.substring(u+p))}return 2*d.length>=e.length?[r,a,s,l,d]:null}var s,l,c,u,d,p=a(n,r,Math.ceil(n.length/4)),f=a(n,r,Math.ceil(n.length/2));if(!p&&!f)return null;s=f?p&&p[4].length>f[4].length?p:f:p,e.length>t.length?(l=s[0],c=s[1],u=s[2],d=s[3]):(u=s[0],d=s[1],l=s[2],c=s[3]);var h=s[4];return[l,c,u,d,h]}(e,t);if(u){var d=u[0],p=u[1],f=u[2],h=u[3],m=u[4],y=n(d,f),g=n(p,h);return y.concat([[0,m]],g)}return function(e,t){for(var n=e.length,o=t.length,i=Math.ceil((n+o)/2),a=i,s=2*i,l=new Array(s),c=new Array(s),u=0;u<s;u++)l[u]=-1,c[u]=-1;l[a+1]=0,c[a+1]=0;for(var d=n-o,p=d%2!=0,f=0,h=0,m=0,y=0,g=0;g<i;g++){for(var b=-g+f;b<=g-h;b+=2){for(var v=a+b,C=(x=b==-g||b!=g&&l[v-1]<l[v+1]?l[v+1]:l[v-1]+1)-b;x<n&&C<o&&e.charAt(x)==t.charAt(C);)x++,C++;if(l[v]=x,x>n)h+=2;else if(C>o)f+=2;else if(p&&(S=a+d-b)>=0&&S<s&&-1!=c[S]){var T=n-c[S];if(x>=T)return r(e,t,x,C)}}for(var O=-g+m;O<=g-y;O+=2){for(var S=a+O,P=(T=O==-g||O!=g&&c[S-1]<c[S+1]?c[S+1]:c[S-1]+1)-O;T<n&&P<o&&e.charAt(n-T-1)==t.charAt(o-P-1);)T++,P++;if(c[S]=T,T>n)y+=2;else if(P>o)m+=2;else if(!p&&(v=a+d-O)>=0&&v<s&&-1!=l[v]){var x=l[v];if(C=a+x-v,x>=(T=n-T))return r(e,t,x,C)}}}return[[-1,e],[1,t]]}(e,t)}(e=e.substring(0,e.length-l),t=t.substring(0,t.length-l));return c&&d.unshift([0,c]),u&&d.push([0,u]),function e(t){t.push([0,""]);for(var n,r=0,a=0,s=0,l="",c="";r<t.length;)switch(t[r][0]){case 1:s++,c+=t[r][1],r++;break;case-1:a++,l+=t[r][1],r++;break;case 0:a+s>1?(0!==a&&0!==s&&(0!==(n=o(c,l))&&(r-a-s>0&&0==t[r-a-s-1][0]?t[r-a-s-1][1]+=c.substring(0,n):(t.splice(0,0,[0,c.substring(0,n)]),r++),c=c.substring(n),l=l.substring(n)),0!==(n=i(c,l))&&(t[r][1]=c.substring(c.length-n)+t[r][1],c=c.substring(0,c.length-n),l=l.substring(0,l.length-n))),0===a?t.splice(r-s,a+s,[1,c]):0===s?t.splice(r-a,a+s,[-1,l]):t.splice(r-a-s,a+s,[-1,l],[1,c]),r=r-a-s+(a?1:0)+(s?1:0)+1):0!==r&&0==t[r-1][0]?(t[r-1][1]+=t[r][1],t.splice(r,1)):r++,s=0,a=0,l="",c=""}""===t[t.length-1][1]&&t.pop();var u=!1;for(r=1;r<t.length-1;)0==t[r-1][0]&&0==t[r+1][0]&&(t[r][1].substring(t[r][1].length-t[r-1][1].length)==t[r-1][1]?(t[r][1]=t[r-1][1]+t[r][1].substring(0,t[r][1].length-t[r-1][1].length),t[r+1][1]=t[r-1][1]+t[r+1][1],t.splice(r-1,1),u=!0):t[r][1].substring(0,t[r+1][1].length)==t[r+1][1]&&(t[r-1][1]+=t[r+1][1],t[r][1]=t[r][1].substring(t[r+1][1].length)+t[r+1][1],t.splice(r+1,1),u=!0)),r++;u&&e(t)}(d),null!=a&&(d=function(e,t){var n=function(e,t){if(0===t)return[0,e];for(var n=0,r=0;r<e.length;r++){var o=e[r];if(-1===o[0]||0===o[0]){var i=n+o[1].length;if(t===i)return[r+1,e];if(t<i){e=e.slice();var a=t-n,s=[o[0],o[1].slice(0,a)],l=[o[0],o[1].slice(a)];return e.splice(r,1,s,l),[r+1,e]}n=i}}throw new Error("cursor_pos is out of bounds!")}(e,t),r=n[1],o=n[0],i=r[o],a=r[o+1];if(null==i)return e;if(0!==i[0])return e;if(null!=a&&i[1]+a[1]===a[1]+i[1])return r.splice(o,2,a,i),s(r,o,2);if(null!=a&&0===a[1].indexOf(i[1])){r.splice(o,2,[a[0],i[1]],[0,i[1]]);var l=a[1].slice(i[1].length);return l.length>0&&r.splice(o+2,0,[a[0],l]),s(r,o,3)}return e}(d,a)),d=function(e){for(var t=!1,n=function(e){return e.charCodeAt(0)>=56320&&e.charCodeAt(0)<=57343},r=2;r<e.length;r+=1)0===e[r-2][0]&&(o=e[r-2][1]).charCodeAt(o.length-1)>=55296&&o.charCodeAt(o.length-1)<=56319&&-1===e[r-1][0]&&n(e[r-1][1])&&1===e[r][0]&&n(e[r][1])&&(t=!0,e[r-1][1]=e[r-2][1].slice(-1)+e[r-1][1],e[r][1]=e[r-2][1].slice(-1)+e[r][1],e[r-2][1]=e[r-2][1].slice(0,-1));var o;if(!t)return e;var i=[];for(r=0;r<e.length;r+=1)e[r][1].length>0&&i.push(e[r]);return i}(d)}function r(e,t,r,o){var i=e.substring(0,r),a=t.substring(0,o),s=e.substring(r),l=t.substring(o),c=n(i,a),u=n(s,l);return c.concat(u)}function o(e,t){if(!e||!t||e.charAt(0)!=t.charAt(0))return 0;for(var n=0,r=Math.min(e.length,t.length),o=r,i=0;n<o;)e.substring(i,o)==t.substring(i,o)?i=n=o:r=o,o=Math.floor((r-n)/2+n);return o}function i(e,t){if(!e||!t||e.charAt(e.length-1)!=t.charAt(t.length-1))return 0;for(var n=0,r=Math.min(e.length,t.length),o=r,i=0;n<o;)e.substring(e.length-o,e.length-i)==t.substring(t.length-o,t.length-i)?i=n=o:r=o,o=Math.floor((r-n)/2+n);return o}var a=n;function s(e,t,n){for(var r=t+n-1;r>=0&&r>=t-1;r--)if(r+1<e.length){var o=e[r],i=e[r+1];o[0]===i[1]&&e.splice(r,2,[o[0],o[1]+i[1]])}return e}a.INSERT=1,a.DELETE=-1,a.EQUAL=0,e.exports=a},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o;if(!Object.keys){var i=Object.prototype.hasOwnProperty,a=Object.prototype.toString,s=n(20),l=Object.prototype.propertyIsEnumerable,c=!l.call({toString:null},"toString"),u=l.call((function(){}),"prototype"),d=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],p=function(e){var t=e.constructor;return t&&t.prototype===e},f={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},h=function(){if("undefined"==typeof window)return!1;for(var e in window)try{if(!f["$"+e]&&i.call(window,e)&&null!==window[e]&&"object"===r(window[e]))try{p(window[e])}catch(t){return!0}}catch(t){return!0}return!1}();o=function(e){var t=null!==e&&"object"===r(e),n="[object Function]"===a.call(e),o=s(e),l=t&&"[object String]"===a.call(e),f=[];if(!t&&!n&&!o)throw new TypeError("Object.keys called on a non-object");var m=u&&n;if(l&&e.length>0&&!i.call(e,0))for(var y=0;y<e.length;++y)f.push(String(y));if(o&&e.length>0)for(var g=0;g<e.length;++g)f.push(String(g));else for(var b in e)m&&"prototype"===b||!i.call(e,b)||f.push(String(b));if(c)for(var v=function(e){if("undefined"==typeof window||!h)return p(e);try{return p(e)}catch(t){return!1}}(e),C=0;C<d.length;++C)v&&"constructor"===d[C]||!i.call(e,d[C])||f.push(d[C]);return f}}e.exports=o},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o=n(12)(),i=n(22)("Object.prototype.toString"),a=function(e){return!(o&&e&&"object"===r(e)&&Symbol.toStringTag in e)&&"[object Arguments]"===i(e)},s=function(e){return!!a(e)||null!==e&&"object"===r(e)&&"number"==typeof e.length&&e.length>=0&&"[object Array]"!==i(e)&&"[object Function]"===i(e.callee)},l=function(){return a(arguments)}();a.isLegacyArguments=s,e.exports=l?a:s},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o="undefined"!=typeof Symbol&&Symbol,i=n(21);e.exports=function(){return"function"==typeof o&&"function"==typeof Symbol&&"symbol"===r(o("foo"))&&"symbol"===r(Symbol("bar"))&&i()}},function(e,t,n){"use strict";var r="Function.prototype.bind called on incompatible ",o=Array.prototype.slice,i=Object.prototype.toString;e.exports=function(e){var t=this;if("function"!=typeof t||"[object Function]"!==i.call(t))throw new TypeError(r+t);for(var n,a=o.call(arguments,1),s=function(){if(this instanceof n){var r=t.apply(this,a.concat(o.call(arguments)));return Object(r)===r?r:this}return t.apply(e,a.concat(o.call(arguments)))},l=Math.max(0,t.length-a.length),c=[],u=0;u<l;u++)c.push("$"+u);if(n=Function("binder","return function ("+c.join(",")+"){ return binder.apply(this,arguments); }")(s),t.prototype){var d=function(){};d.prototype=t.prototype,n.prototype=new d,d.prototype=null}return n}},function(e,t,n){"use strict";var r=n(13);e.exports=r.call(Function.call,Object.prototype.hasOwnProperty)},function(e,t,n){"use strict";var r=n(8),o=n(14),i=n(24),a=n(25),s=n(45),l=o(a(),Object);r(l,{getPolyfill:a,implementation:i,shim:s}),e.exports=l},function(e,t,n){"use strict";var r=n(25),o=n(8);e.exports=function(){var e=r();return o(Object,{is:e},{is:function(){return Object.is!==e}}),e}},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o,i,a,s,l=n(22),c=n(12)();if(c){o=l("Object.prototype.hasOwnProperty"),i=l("RegExp.prototype.exec"),a={};var u=function(){throw a};s={toString:u,valueOf:u},"symbol"===r(Symbol.toPrimitive)&&(s[Symbol.toPrimitive]=u)}var d=l("Object.prototype.toString"),p=Object.getOwnPropertyDescriptor;e.exports=c?function(e){if(!e||"object"!==r(e))return!1;var t=p(e,"lastIndex");if(!t||!o(t,"value"))return!1;try{i(e,s)}catch(n){return n===a}}:function(e){return!(!e||"object"!==r(e)&&"function"!=typeof e)&&"[object RegExp]"===d(e)}},function(e,t,n){"use strict";var r=n(8),o=n(14),i=n(26),a=n(27),s=n(48),l=o(a());r(l,{getPolyfill:a,implementation:i,shim:s}),e.exports=l},function(e,t,n){"use strict";var r=n(8).supportsDescriptors,o=n(27),i=Object.getOwnPropertyDescriptor,a=Object.defineProperty,s=TypeError,l=Object.getPrototypeOf,c=/a/;e.exports=function(){if(!r||!l)throw new s("RegExp.prototype.flags requires a true ES5 environment that supports property descriptors");var e=o(),t=l(c),n=i(t,"flags");return n&&n.get===e||a(t,"flags",{configurable:!0,enumerable:!1,get:e}),e}},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o=Date.prototype.getDay,i=Object.prototype.toString,a=n(12)();e.exports=function(e){return"object"===r(e)&&null!==e&&(a?function(e){try{return o.call(e),!0}catch(t){return!1}}(e):"[object Date]"===i.call(e))}},function(e,t,n){"use strict";(function(e){var r=n(52),o=n(53),i=n(54);function a(){return l.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(e,t){if(a()<t)throw new RangeError("Invalid typed array length");return l.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=l.prototype:(null===e&&(e=new l(t)),e.length=t),e}function l(e,t,n){if(!(l.TYPED_ARRAY_SUPPORT||this instanceof l))return new l(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return d(this,e)}return c(this,e,t,n)}function c(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");return t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r),l.TYPED_ARRAY_SUPPORT?(e=t).__proto__=l.prototype:e=p(e,t),e}(e,t,n,r):"string"==typeof t?function(e,t,n){if("string"==typeof n&&""!==n||(n="utf8"),!l.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|h(t,n),o=(e=s(e,r)).write(t,n);return o!==r&&(e=e.slice(0,o)),e}(e,t,n):function(e,t){if(l.isBuffer(t)){var n=0|f(t.length);return 0===(e=s(e,n)).length||t.copy(e,0,0,n),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(r=t.length)!=r?s(e,0):p(e,t);if("Buffer"===t.type&&i(t.data))return p(e,t.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function u(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function d(e,t){if(u(t),e=s(e,t<0?0:0|f(t)),!l.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function p(e,t){var n=t.length<0?0:0|f(t.length);e=s(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function f(e){if(e>=a())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a().toString(16)+" bytes");return 0|e}function h(e,t){if(l.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return F(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return H(e).length;default:if(r)return F(e).length;t=(""+t).toLowerCase(),r=!0}}function m(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return k(this,t,n);case"utf8":case"utf-8":return I(this,t,n);case"ascii":return E(this,t,n);case"latin1":case"binary":return A(this,t,n);case"base64":return x(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return w(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function y(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function g(e,t,n,r,o){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=o?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(o)return-1;n=e.length-1}else if(n<0){if(!o)return-1;n=0}if("string"==typeof t&&(t=l.from(t,r)),l.isBuffer(t))return 0===t.length?-1:b(e,t,n,r,o);if("number"==typeof t)return t&=255,l.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):b(e,[t],n,r,o);throw new TypeError("val must be string, number or Buffer")}function b(e,t,n,r,o){var i,a=1,s=e.length,l=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;a=2,s/=2,l/=2,n/=2}function c(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(o){var u=-1;for(i=n;i<s;i++)if(c(e,i)===c(t,-1===u?0:i-u)){if(-1===u&&(u=i),i-u+1===l)return u*a}else-1!==u&&(i-=i-u),u=-1}else for(n+l>s&&(n=s-l),i=n;i>=0;i--){for(var d=!0,p=0;p<l;p++)if(c(e,i+p)!==c(t,p)){d=!1;break}if(d)return i}return-1}function v(e,t,n,r){n=Number(n)||0;var o=e.length-n;r?(r=Number(r))>o&&(r=o):r=o;var i=t.length;if(i%2!=0)throw new TypeError("Invalid hex string");r>i/2&&(r=i/2);for(var a=0;a<r;++a){var s=parseInt(t.substr(2*a,2),16);if(isNaN(s))return a;e[n+a]=s}return a}function C(e,t,n,r){return U(F(t,e.length-n),e,n,r)}function T(e,t,n,r){return U(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function O(e,t,n,r){return T(e,t,n,r)}function S(e,t,n,r){return U(H(t),e,n,r)}function P(e,t,n,r){return U(function(e,t){for(var n,r,o,i=[],a=0;a<e.length&&!((t-=2)<0);++a)n=e.charCodeAt(a),r=n>>8,o=n%256,i.push(o),i.push(r);return i}(t,e.length-n),e,n,r)}function x(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function I(e,t,n){n=Math.min(e.length,n);for(var r=[],o=t;o<n;){var i,a,s,l,c=e[o],u=null,d=c>239?4:c>223?3:c>191?2:1;if(o+d<=n)switch(d){case 1:c<128&&(u=c);break;case 2:128==(192&(i=e[o+1]))&&(l=(31&c)<<6|63&i)>127&&(u=l);break;case 3:i=e[o+1],a=e[o+2],128==(192&i)&&128==(192&a)&&(l=(15&c)<<12|(63&i)<<6|63&a)>2047&&(l<55296||l>57343)&&(u=l);break;case 4:i=e[o+1],a=e[o+2],s=e[o+3],128==(192&i)&&128==(192&a)&&128==(192&s)&&(l=(15&c)<<18|(63&i)<<12|(63&a)<<6|63&s)>65535&&l<1114112&&(u=l)}null===u?(u=65533,d=1):u>65535&&(u-=65536,r.push(u>>>10&1023|55296),u=56320|1023&u),r.push(u),o+=d}return function(e){var t=e.length;if(t<=4096)return String.fromCharCode.apply(String,e);for(var n="",r=0;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=4096));return n}(r)}function E(e,t,n){var r="";n=Math.min(e.length,n);for(var o=t;o<n;++o)r+=String.fromCharCode(127&e[o]);return r}function A(e,t,n){var r="";n=Math.min(e.length,n);for(var o=t;o<n;++o)r+=String.fromCharCode(e[o]);return r}function k(e,t,n){var r,o=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>o)&&(n=o);for(var i="",a=t;a<n;++a)i+=(r=e[a])<16?"0"+r.toString(16):r.toString(16);return i}function w(e,t,n){for(var r=e.slice(t,n),o="",i=0;i<r.length;i+=2)o+=String.fromCharCode(r[i]+256*r[i+1]);return o}function _(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function R(e,t,n,r,o,i){if(!l.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>o||t<i)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function j(e,t,n,r){t<0&&(t=65535+t+1);for(var o=0,i=Math.min(e.length-n,2);o<i;++o)e[n+o]=(t&255<<8*(r?o:1-o))>>>8*(r?o:1-o)}function D(e,t,n,r){t<0&&(t=4294967295+t+1);for(var o=0,i=Math.min(e.length-n,4);o<i;++o)e[n+o]=t>>>8*(r?o:3-o)&255}function M(e,t,n,r,o,i){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function B(e,t,n,r,i){return i||M(e,0,n,4),o.write(e,t,n,r,23,4),n+4}function N(e,t,n,r,i){return i||M(e,0,n,8),o.write(e,t,n,r,52,8),n+8}t.Buffer=l,t.SlowBuffer=function(e){return+e!=e&&(e=0),l.alloc(+e)},t.INSPECT_MAX_BYTES=50,l.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(t){return!1}}(),t.kMaxLength=a(),l.poolSize=8192,l._augment=function(e){return e.__proto__=l.prototype,e},l.from=function(e,t,n){return c(null,e,t,n)},l.TYPED_ARRAY_SUPPORT&&(l.prototype.__proto__=Uint8Array.prototype,l.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&l[Symbol.species]===l&&Object.defineProperty(l,Symbol.species,{value:null,configurable:!0})),l.alloc=function(e,t,n){return function(e,t,n,r){return u(t),t<=0?s(e,t):void 0!==n?"string"==typeof r?s(e,t).fill(n,r):s(e,t).fill(n):s(e,t)}(null,e,t,n)},l.allocUnsafe=function(e){return d(null,e)},l.allocUnsafeSlow=function(e){return d(null,e)},l.isBuffer=function(e){return!(null==e||!e._isBuffer)},l.compare=function(e,t){if(!l.isBuffer(e)||!l.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,o=0,i=Math.min(n,r);o<i;++o)if(e[o]!==t[o]){n=e[o],r=t[o];break}return n<r?-1:r<n?1:0},l.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(e,t){if(!i(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return l.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=l.allocUnsafe(t),o=0;for(n=0;n<e.length;++n){var a=e[n];if(!l.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(r,o),o+=a.length}return r},l.byteLength=h,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)y(this,t,t+1);return this},l.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)y(this,t,t+3),y(this,t+1,t+2);return this},l.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)y(this,t,t+7),y(this,t+1,t+6),y(this,t+2,t+5),y(this,t+3,t+4);return this},l.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?I(this,0,e):m.apply(this,arguments)},l.prototype.equals=function(e){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===l.compare(this,e)},l.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},l.prototype.compare=function(e,t,n,r,o){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===o&&(o=this.length),t<0||n>e.length||r<0||o>this.length)throw new RangeError("out of range index");if(r>=o&&t>=n)return 0;if(r>=o)return-1;if(t>=n)return 1;if(this===e)return 0;for(var i=(o>>>=0)-(r>>>=0),a=(n>>>=0)-(t>>>=0),s=Math.min(i,a),c=this.slice(r,o),u=e.slice(t,n),d=0;d<s;++d)if(c[d]!==u[d]){i=c[d],a=u[d];break}return i<a?-1:a<i?1:0},l.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},l.prototype.indexOf=function(e,t,n){return g(this,e,t,n,!0)},l.prototype.lastIndexOf=function(e,t,n){return g(this,e,t,n,!1)},l.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var o=this.length-t;if((void 0===n||n>o)&&(n=o),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var i=!1;;)switch(r){case"hex":return v(this,e,t,n);case"utf8":case"utf-8":return C(this,e,t,n);case"ascii":return T(this,e,t,n);case"latin1":case"binary":return O(this,e,t,n);case"base64":return S(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,e,t,n);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),i=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},l.prototype.slice=function(e,t){var n,r=this.length;if((e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e),l.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=l.prototype;else{var o=t-e;n=new l(o,void 0);for(var i=0;i<o;++i)n[i]=this[i+e]}return n},l.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||_(e,t,this.length);for(var r=this[e],o=1,i=0;++i<t&&(o*=256);)r+=this[e+i]*o;return r},l.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||_(e,t,this.length);for(var r=this[e+--t],o=1;t>0&&(o*=256);)r+=this[e+--t]*o;return r},l.prototype.readUInt8=function(e,t){return t||_(e,1,this.length),this[e]},l.prototype.readUInt16LE=function(e,t){return t||_(e,2,this.length),this[e]|this[e+1]<<8},l.prototype.readUInt16BE=function(e,t){return t||_(e,2,this.length),this[e]<<8|this[e+1]},l.prototype.readUInt32LE=function(e,t){return t||_(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},l.prototype.readUInt32BE=function(e,t){return t||_(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},l.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||_(e,t,this.length);for(var r=this[e],o=1,i=0;++i<t&&(o*=256);)r+=this[e+i]*o;return r>=(o*=128)&&(r-=Math.pow(2,8*t)),r},l.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||_(e,t,this.length);for(var r=t,o=1,i=this[e+--r];r>0&&(o*=256);)i+=this[e+--r]*o;return i>=(o*=128)&&(i-=Math.pow(2,8*t)),i},l.prototype.readInt8=function(e,t){return t||_(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},l.prototype.readInt16LE=function(e,t){t||_(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt16BE=function(e,t){t||_(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt32LE=function(e,t){return t||_(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},l.prototype.readInt32BE=function(e,t){return t||_(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},l.prototype.readFloatLE=function(e,t){return t||_(e,4,this.length),o.read(this,e,!0,23,4)},l.prototype.readFloatBE=function(e,t){return t||_(e,4,this.length),o.read(this,e,!1,23,4)},l.prototype.readDoubleLE=function(e,t){return t||_(e,8,this.length),o.read(this,e,!0,52,8)},l.prototype.readDoubleBE=function(e,t){return t||_(e,8,this.length),o.read(this,e,!1,52,8)},l.prototype.writeUIntLE=function(e,t,n,r){e=+e,t|=0,n|=0,r||R(this,e,t,n,Math.pow(2,8*n)-1,0);var o=1,i=0;for(this[t]=255&e;++i<n&&(o*=256);)this[t+i]=e/o&255;return t+n},l.prototype.writeUIntBE=function(e,t,n,r){e=+e,t|=0,n|=0,r||R(this,e,t,n,Math.pow(2,8*n)-1,0);var o=n-1,i=1;for(this[t+o]=255&e;--o>=0&&(i*=256);)this[t+o]=e/i&255;return t+n},l.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,1,255,0),l.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},l.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):j(this,e,t,!0),t+2},l.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):j(this,e,t,!1),t+2},l.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):D(this,e,t,!0),t+4},l.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):D(this,e,t,!1),t+4},l.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var o=Math.pow(2,8*n-1);R(this,e,t,n,o-1,-o)}var i=0,a=1,s=0;for(this[t]=255&e;++i<n&&(a*=256);)e<0&&0===s&&0!==this[t+i-1]&&(s=1),this[t+i]=(e/a>>0)-s&255;return t+n},l.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var o=Math.pow(2,8*n-1);R(this,e,t,n,o-1,-o)}var i=n-1,a=1,s=0;for(this[t+i]=255&e;--i>=0&&(a*=256);)e<0&&0===s&&0!==this[t+i+1]&&(s=1),this[t+i]=(e/a>>0)-s&255;return t+n},l.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,1,127,-128),l.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},l.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):j(this,e,t,!0),t+2},l.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):j(this,e,t,!1),t+2},l.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,4,2147483647,-2147483648),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):D(this,e,t,!0),t+4},l.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):D(this,e,t,!1),t+4},l.prototype.writeFloatLE=function(e,t,n){return B(this,e,t,!0,n)},l.prototype.writeFloatBE=function(e,t,n){return B(this,e,t,!1,n)},l.prototype.writeDoubleLE=function(e,t,n){return N(this,e,t,!0,n)},l.prototype.writeDoubleBE=function(e,t,n){return N(this,e,t,!1,n)},l.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var o,i=r-n;if(this===e&&n<t&&t<r)for(o=i-1;o>=0;--o)e[o+t]=this[o+n];else if(i<1e3||!l.TYPED_ARRAY_SUPPORT)for(o=0;o<i;++o)e[o+t]=this[o+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+i),t);return i},l.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===e.length){var o=e.charCodeAt(0);o<256&&(e=o)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!l.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var i;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(i=t;i<n;++i)this[i]=e;else{var a=l.isBuffer(e)?e:F(new l(e,r).toString()),s=a.length;for(i=0;i<n-t;++i)this[i+t]=a[i%s]}return this};var L=/[^+\/0-9A-Za-z-_]/g;function F(e,t){var n;t=t||1/0;for(var r=e.length,o=null,i=[],a=0;a<r;++a){if((n=e.charCodeAt(a))>55295&&n<57344){if(!o){if(n>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(a+1===r){(t-=3)>-1&&i.push(239,191,189);continue}o=n;continue}if(n<56320){(t-=3)>-1&&i.push(239,191,189),o=n;continue}n=65536+(o-55296<<10|n-56320)}else o&&(t-=3)>-1&&i.push(239,191,189);if(o=null,n<128){if((t-=1)<0)break;i.push(n)}else if(n<2048){if((t-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function H(e){return r.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(L,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function U(e,t,n,r){for(var o=0;o<r&&!(o+n>=t.length||o>=e.length);++o)t[o+n]=e[o];return o}}).call(this,n(51))},function(e,t){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(o){"object"===("undefined"==typeof window?"undefined":n(window))&&(r=window)}e.exports=r},function(e,t,n){"use strict";t.byteLength=function(e){var t=c(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){var t,n,r=c(e),a=r[0],s=r[1],l=new i(function(e,t,n){return 3*(t+n)/4-n}(0,a,s)),u=0,d=s>0?a-4:a;for(n=0;n<d;n+=4)t=o[e.charCodeAt(n)]<<18|o[e.charCodeAt(n+1)]<<12|o[e.charCodeAt(n+2)]<<6|o[e.charCodeAt(n+3)],l[u++]=t>>16&255,l[u++]=t>>8&255,l[u++]=255&t;return 2===s&&(t=o[e.charCodeAt(n)]<<2|o[e.charCodeAt(n+1)]>>4,l[u++]=255&t),1===s&&(t=o[e.charCodeAt(n)]<<10|o[e.charCodeAt(n+1)]<<4|o[e.charCodeAt(n+2)]>>2,l[u++]=t>>8&255,l[u++]=255&t),l},t.fromByteArray=function(e){for(var t,n=e.length,o=n%3,i=[],a=0,s=n-o;a<s;a+=16383)i.push(u(e,a,a+16383>s?s:a+16383));return 1===o?(t=e[n-1],i.push(r[t>>2]+r[t<<4&63]+"==")):2===o&&(t=(e[n-2]<<8)+e[n-1],i.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"=")),i.join("")};for(var r=[],o=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,l=a.length;s<l;++s)r[s]=a[s],o[a.charCodeAt(s)]=s;function c(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function u(e,t,n){for(var o,i,a=[],s=t;s<n;s+=3)o=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),a.push(r[(i=o)>>18&63]+r[i>>12&63]+r[i>>6&63]+r[63&i]);return a.join("")}o["-".charCodeAt(0)]=62,o["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,n,r,o){var i,a,s=8*o-r-1,l=(1<<s)-1,c=l>>1,u=-7,d=n?o-1:0,p=n?-1:1,f=e[t+d];for(d+=p,i=f&(1<<-u)-1,f>>=-u,u+=s;u>0;i=256*i+e[t+d],d+=p,u-=8);for(a=i&(1<<-u)-1,i>>=-u,u+=r;u>0;a=256*a+e[t+d],d+=p,u-=8);if(0===i)i=1-c;else{if(i===l)return a?NaN:1/0*(f?-1:1);a+=Math.pow(2,r),i-=c}return(f?-1:1)*a*Math.pow(2,i-r)},t.write=function(e,t,n,r,o,i){var a,s,l,c=8*i-o-1,u=(1<<c)-1,d=u>>1,p=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:i-1,h=r?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=u):(a=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-a))<1&&(a--,l*=2),(t+=a+d>=1?p/l:p*Math.pow(2,1-d))*l>=2&&(a++,l/=2),a+d>=u?(s=0,a=u):a+d>=1?(s=(t*l-1)*Math.pow(2,o),a+=d):(s=t*Math.pow(2,d-1)*Math.pow(2,o),a=0));o>=8;e[n+f]=255&s,f+=h,s/=256,o-=8);for(a=a<<o|s,c+=o;c>0;e[n+f]=255&a,f+=h,a/=256,c-=8);e[n+f-h]|=128*m}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t){var n,r,o=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:i}catch(e){n=i}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(e){r=a}}();var l,c=[],u=!1,d=-1;function p(){u&&l&&(u=!1,l.length?c=l.concat(c):d=-1,c.length&&f())}function f(){if(!u){var e=s(p);u=!0;for(var t=c.length;t;){for(l=c,c=[];++d<t;)l&&l[d].run();d=-1,t=c.length}l=null,u=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function m(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new h(e,t)),1!==c.length||u||s(f)},h.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=m,o.addListener=m,o.once=m,o.off=m,o.removeListener=m,o.removeAllListeners=m,o.emit=m,o.prependListener=m,o.prependOnceListener=m,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(e,t,n){"use strict";n.r(t);var r=n(0),o=n.n(r),i=(n(37),n(1)),a=n.n(i),s=n(6),l=n.n(s),c=n(2),u=n.n(c);function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function h(){return(h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=m(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}}).apply(this,arguments)}function m(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=v(e)););return e}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v(e);if(t){var o=v(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return b(this,n)}}function b(e,t){if(t&&("object"===d(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var C=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&y(e,t)}(i,e);var t,n,r,o=g(i);function i(){return p(this,i),o.apply(this,arguments)}return t=i,r=[{key:"value",value:function(){}}],(n=[{key:"insertInto",value:function(e,t){0===e.children.length?h(v(i.prototype),"insertInto",this).call(this,e,t):this.remove()}},{key:"length",value:function(){return 0}},{key:"value",value:function(){return""}}])&&f(t.prototype,n),r&&f(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(o.a.Embed);C.blotName="break",C.tagName="BR";var T=C;function O(e){return(O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function S(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function P(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function x(e,t){return(x=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function I(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=A(e);if(t){var o=A(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return E(this,n)}}function E(e,t){if(t&&("object"===O(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function A(e){return(A=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var k=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&x(e,t)}(i,e);var t,n,r,o=I(i);function i(){return P(this,i),o.apply(this,arguments)}return t=i,n&&S(t.prototype,n),r&&S(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}(o.a.Text);function w(e){return(w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function R(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function j(){return(j="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=D(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}}).apply(this,arguments)}function D(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=L(e)););return e}function M(e,t){return(M=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function B(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=L(e);if(t){var o=L(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return N(this,n)}}function N(e,t){if(t&&("object"===w(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function L(e){return(L=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var F=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&M(e,t)}(a,e);var t,n,r,i=B(a);function a(){return _(this,a),i.apply(this,arguments)}return t=a,r=[{key:"compare",value:function(e,t){var n=a.order.indexOf(e),r=a.order.indexOf(t);return n>=0||r>=0?n-r:e===t?0:e<t?-1:1}}],(n=[{key:"formatAt",value:function(e,t,n,r){if(a.compare(this.statics.blotName,n)<0&&o.a.query(n,o.a.Scope.BLOT)){var i=this.isolate(e,t);r&&i.wrap(n,r)}else j(L(a.prototype),"formatAt",this).call(this,e,t,n,r)}},{key:"optimize",value:function(e){if(j(L(a.prototype),"optimize",this).call(this,e),this.parent instanceof a&&a.compare(this.statics.blotName,this.parent.statics.blotName)>0){var t=this.parent.isolate(this.offset(),this.length());this.moveChildren(t),t.wrap(this)}}}])&&R(t.prototype,n),r&&R(t,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(o.a.Inline);F.allowedChildren=[F,o.a.Embed,k],F.order=["cursor","inline","underline","strike","italic","bold","script","link","code"];var H=F;function U(e){return(U="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function z(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function K(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function W(e,t,n){return t&&K(e.prototype,t),n&&K(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function V(){return(V="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=G(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}}).apply(this,arguments)}function G(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=J(e)););return e}function q(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Q(e,t)}function Q(e,t){return(Q=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=J(e);if(t){var o=J(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return X(this,n)}}function X(e,t){if(t&&("object"===U(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function J(e){return(J=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var $=function(e){q(n,e);var t=Y(n);function n(){return z(this,n),t.apply(this,arguments)}return W(n,[{key:"attach",value:function(){V(J(n.prototype),"attach",this).call(this),this.attributes=new o.a.Attributor.Store(this.domNode)}},{key:"delta",value:function(){return(new a.a).insert(this.value(),u()(this.formats(),this.attributes.values()))}},{key:"format",value:function(e,t){var n=o.a.query(e,o.a.Scope.BLOCK_ATTRIBUTE);null!=n&&this.attributes.attribute(n,t)}},{key:"formatAt",value:function(e,t,n,r){this.format(n,r)}},{key:"insertAt",value:function(e,t,r){if("string"==typeof t&&t.endsWith("\n")){var i=o.a.create(Z.blotName);this.parent.insertBefore(i,0===e?this:this.next),i.insertAt(0,t.slice(0,-1))}else V(J(n.prototype),"insertAt",this).call(this,e,t,r)}}]),n}(o.a.Embed);$.scope=o.a.Scope.BLOCK_BLOT;var Z=function(e){q(n,e);var t=Y(n);function n(e){var r;return z(this,n),(r=t.call(this,e)).cache={},r}return W(n,[{key:"delta",value:function(){return null==this.cache.delta&&(this.cache.delta=this.descendants(o.a.Leaf).reduce((function(e,t){return 0===t.length()?e:e.insert(t.value(),ee(t))}),new a.a).insert("\n",ee(this))),this.cache.delta}},{key:"deleteAt",value:function(e,t){V(J(n.prototype),"deleteAt",this).call(this,e,t),this.cache={}}},{key:"formatAt",value:function(e,t,r,i){t<=0||(o.a.query(r,o.a.Scope.BLOCK)?e+t===this.length()&&this.format(r,i):V(J(n.prototype),"formatAt",this).call(this,e,Math.min(t,this.length()-e-1),r,i),this.cache={})}},{key:"insertAt",value:function(e,t,r){if(null!=r)return V(J(n.prototype),"insertAt",this).call(this,e,t,r);if(0!==t.length){var o=t.split("\n"),i=o.shift();i.length>0&&(e<this.length()-1||null==this.children.tail?V(J(n.prototype),"insertAt",this).call(this,Math.min(e,this.length()-1),i):this.children.tail.insertAt(this.children.tail.length(),i),this.cache={});var a=this;o.reduce((function(e,t){return(a=a.split(e,!0)).insertAt(0,t),t.length}),e+i.length)}}},{key:"insertBefore",value:function(e,t){var r=this.children.head;V(J(n.prototype),"insertBefore",this).call(this,e,t),r instanceof T&&r.remove(),this.cache={}}},{key:"length",value:function(){return null==this.cache.length&&(this.cache.length=V(J(n.prototype),"length",this).call(this)+1),this.cache.length}},{key:"moveChildren",value:function(e,t){V(J(n.prototype),"moveChildren",this).call(this,e,t),this.cache={}}},{key:"optimize",value:function(e){V(J(n.prototype),"optimize",this).call(this,e),this.cache={}}},{key:"path",value:function(e){return V(J(n.prototype),"path",this).call(this,e,!0)}},{key:"removeChild",value:function(e){V(J(n.prototype),"removeChild",this).call(this,e),this.cache={}}},{key:"split",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t&&(0===e||e>=this.length()-1)){var r=this.clone();return 0===e?(this.parent.insertBefore(r,this),this):(this.parent.insertBefore(r,this.next),r)}var o=V(J(n.prototype),"split",this).call(this,e,t);return this.cache={},o}}]),n}(o.a.Block);function ee(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return null==e?t:("function"==typeof e.formats&&(t=u()(t,e.formats())),null==e.parent||"scroll"==e.parent.blotName||e.parent.statics.scope!==e.statics.scope?t:ee(e.parent,t))}function te(e){return(te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ne(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(l){s=!0,o=l}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return re(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?re(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function re(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function oe(){return(oe="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=ie(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}}).apply(this,arguments)}function ie(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=fe(e)););return e}function ae(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function se(e,t,n){return t&&ae(e.prototype,t),n&&ae(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function le(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ce(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ue(e,t)}function ue(e,t){return(ue=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function de(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=fe(e);if(t){var o=fe(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return pe(this,n)}}function pe(e,t){if(t&&("object"===te(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function fe(e){return(fe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Z.blotName="block",Z.tagName="P",Z.defaultChild="break",Z.allowedChildren=[H,o.a.Embed,k];var he=function(e){ce(n,e);var t=de(n);function n(){return le(this,n),t.apply(this,arguments)}return se(n)}(H);he.blotName="code",he.tagName="CODE";var me=function(e){ce(n,e);var t=de(n);function n(){return le(this,n),t.apply(this,arguments)}return se(n,[{key:"delta",value:function(){var e=this,t=this.domNode.textContent;return t.endsWith("\n")&&(t=t.slice(0,-1)),t.split("\n").reduce((function(t,n){return t.insert(n).insert("\n",e.formats())}),new a.a)}},{key:"format",value:function(e,t){if(e!==this.statics.blotName||!t){var r=ne(this.descendant(k,this.length()-1),1)[0];null!=r&&r.deleteAt(r.length()-1,1),oe(fe(n.prototype),"format",this).call(this,e,t)}}},{key:"formatAt",value:function(e,t,r,i){if(0!==t&&null!=o.a.query(r,o.a.Scope.BLOCK)&&(r!==this.statics.blotName||i!==this.statics.formats(this.domNode))){var a=this.newlineIndex(e);if(!(a<0||a>=e+t)){var s=this.newlineIndex(e,!0)+1,l=a-s+1,c=this.isolate(s,l),u=c.next;c.format(r,i),u instanceof n&&u.formatAt(0,e-s+t-l,r,i)}}}},{key:"insertAt",value:function(e,t,n){if(null==n){var r=ne(this.descendant(k,e),2),o=r[0],i=r[1];o.insertAt(i,t)}}},{key:"length",value:function(){var e=this.domNode.textContent.length;return this.domNode.textContent.endsWith("\n")?e:e+1}},{key:"newlineIndex",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t)return this.domNode.textContent.slice(0,e).lastIndexOf("\n");var n=this.domNode.textContent.slice(e).indexOf("\n");return n>-1?e+n:-1}},{key:"optimize",value:function(e){this.domNode.textContent.endsWith("\n")||this.appendChild(o.a.create("text","\n")),oe(fe(n.prototype),"optimize",this).call(this,e);var t=this.next;null!=t&&t.prev===this&&t.statics.blotName===this.statics.blotName&&this.statics.formats(this.domNode)===t.statics.formats(t.domNode)&&(t.optimize(e),t.moveChildren(this),t.remove())}},{key:"replace",value:function(e){oe(fe(n.prototype),"replace",this).call(this,e),[].slice.call(this.domNode.querySelectorAll("*")).forEach((function(e){var t=o.a.find(e);null==t?e.parentNode.removeChild(e):t instanceof o.a.Embed?t.remove():t.unwrap()}))}}],[{key:"create",value:function(e){var t=oe(fe(n),"create",this).call(this,e);return t.setAttribute("spellcheck",!1),t}},{key:"formats",value:function(){return!0}}]),n}(Z);function ye(e){return(ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ge(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(l){s=!0,o=l}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return be(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?be(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function be(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ve(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ce(){return(Ce="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=Te(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}}).apply(this,arguments)}function Te(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=xe(e)););return e}function Oe(e,t){return(Oe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Se(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=xe(e);if(t){var o=xe(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Pe(this,n)}}function Pe(e,t){if(t&&("object"===ye(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function xe(e){return(xe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}me.blotName="code-block",me.tagName="PRE",me.TAB="  ";var Ie=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Oe(e,t)}(a,e);var t,n,r,i=Se(a);function a(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=i.call(this,e)).selection=t,n.textNode=document.createTextNode(a.CONTENTS),n.domNode.appendChild(n.textNode),n._length=0,n}return t=a,r=[{key:"value",value:function(){}}],(n=[{key:"detach",value:function(){null!=this.parent&&this.parent.removeChild(this)}},{key:"format",value:function(e,t){if(0!==this._length)return Ce(xe(a.prototype),"format",this).call(this,e,t);for(var n=this,r=0;null!=n&&n.statics.scope!==o.a.Scope.BLOCK_BLOT;)r+=n.offset(n.parent),n=n.parent;null!=n&&(this._length=a.CONTENTS.length,n.optimize(),n.formatAt(r,a.CONTENTS.length,e,t),this._length=0)}},{key:"index",value:function(e,t){return e===this.textNode?0:Ce(xe(a.prototype),"index",this).call(this,e,t)}},{key:"length",value:function(){return this._length}},{key:"position",value:function(){return[this.textNode,this.textNode.data.length]}},{key:"remove",value:function(){Ce(xe(a.prototype),"remove",this).call(this),this.parent=null}},{key:"restore",value:function(){if(!this.selection.composing&&null!=this.parent){var e,t,n,r=this.textNode,i=this.selection.getNativeRange();if(null!=i&&i.start.node===r&&i.end.node===r){var s=[r,i.start.offset,i.end.offset];e=s[0],t=s[1],n=s[2]}for(;null!=this.domNode.lastChild&&this.domNode.lastChild!==this.textNode;)this.domNode.parentNode.insertBefore(this.domNode.lastChild,this.domNode);if(this.textNode.data!==a.CONTENTS){var l=this.textNode.data.split(a.CONTENTS).join("");this.next instanceof k?(e=this.next.domNode,this.next.insertAt(0,l),this.textNode.data=a.CONTENTS):(this.textNode.data=l,this.parent.insertBefore(o.a.create(this.textNode),this),this.textNode=document.createTextNode(a.CONTENTS),this.domNode.appendChild(this.textNode))}if(this.remove(),null!=t){var c=ge([t,n].map((function(t){return Math.max(0,Math.min(e.data.length,t-1))})),2);return t=c[0],n=c[1],{startNode:e,startOffset:t,endNode:e,endOffset:n}}}}},{key:"update",value:function(e,t){var n=this;if(e.some((function(e){return"characterData"===e.type&&e.target===n.textNode}))){var r=this.restore();r&&(t.range=r)}}},{key:"value",value:function(){return""}}])&&ve(t.prototype,n),r&&ve(t,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(o.a.Embed);Ie.blotName="cursor",Ie.className="ql-cursor",Ie.tagName="span",Ie.CONTENTS="\ufeff";var Ee=Ie,Ae=n(4),ke=n.n(Ae),we=n(5),_e=n.n(we);function Re(e){return(Re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function je(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(l){s=!0,o=l}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return De(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?De(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function De(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Me(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Be=/^[ -~]*$/;function Ne(e,t){return Object.keys(t).reduce((function(n,r){return null==e[r]||(t[r]===e[r]?n[r]=t[r]:Array.isArray(t[r])?t[r].indexOf(e[r])<0&&(n[r]=t[r].concat([e[r]])):n[r]=[t[r],e[r]]),n}),{})}var Le=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.scroll=t,this.delta=this.getDelta()}var t,n,r;return t=e,(n=[{key:"applyDelta",value:function(e){var t=this,n=!1;this.scroll.update();var r=this.scroll.length();return this.scroll.batchStart(),(e=function(e){return e.reduce((function(e,t){if(1===t.insert){var n=ke()(t.attributes);return delete n.image,e.insert({image:t.attributes.image},n)}if(null==t.attributes||!0!==t.attributes.list&&!0!==t.attributes.bullet||((t=ke()(t)).attributes.list?t.attributes.list="ordered":(t.attributes.list="bullet",delete t.attributes.bullet)),"string"==typeof t.insert){var r=t.insert.replace(/\r\n/g,"\n").replace(/\r/g,"\n");return e.insert(r,t.attributes)}return e.push(t)}),new a.a)}(e)).reduce((function(e,i){var a=i.retain||i.delete||i.insert.length||1,s=i.attributes||{};if(null!=i.insert){if("string"==typeof i.insert){var c=i.insert;c.endsWith("\n")&&n&&(n=!1,c=c.slice(0,-1)),e>=r&&!c.endsWith("\n")&&(n=!0),t.scroll.insertAt(e,c);var d=je(t.scroll.line(e),2),p=d[0],f=d[1],h=u()({},ee(p));if(p instanceof Z){var m=je(p.descendant(o.a.Leaf,f),1)[0];h=u()(h,ee(m))}s=l.a.attributes.diff(h,s)||{}}else if("object"===Re(i.insert)){var y=Object.keys(i.insert)[0];if(null==y)return e;t.scroll.insertAt(e,y,i.insert[y])}r+=a}return Object.keys(s).forEach((function(n){t.scroll.formatAt(e,a,n,s[n])})),e+a}),0),e.reduce((function(e,n){return"number"==typeof n.delete?(t.scroll.deleteAt(e,n.delete),e):e+(n.retain||n.insert.length||1)}),0),this.scroll.batchEnd(),this.update(e)}},{key:"deleteText",value:function(e,t){return this.scroll.deleteAt(e,t),this.update((new a.a).retain(e).delete(t))}},{key:"formatLine",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.scroll.update(),Object.keys(r).forEach((function(o){if(null==n.scroll.whitelist||n.scroll.whitelist[o]){var i=n.scroll.lines(e,Math.max(t,1)),a=t;i.forEach((function(t){var i=t.length();if(t instanceof me){var s=e-t.offset(n.scroll),l=t.newlineIndex(s+a)-s+1;t.formatAt(s,l,o,r[o])}else t.format(o,r[o]);a-=i}))}})),this.scroll.optimize(),this.update((new a.a).retain(e).retain(t,ke()(r)))}},{key:"formatText",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return Object.keys(r).forEach((function(o){n.scroll.formatAt(e,t,o,r[o])})),this.update((new a.a).retain(e).retain(t,ke()(r)))}},{key:"getContents",value:function(e,t){return this.delta.slice(e,e+t)}},{key:"getDelta",value:function(){return this.scroll.lines().reduce((function(e,t){return e.concat(t.delta())}),new a.a)}},{key:"getFormat",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=[],r=[];0===t?this.scroll.path(e).forEach((function(e){var t=je(e,1)[0];t instanceof Z?n.push(t):t instanceof o.a.Leaf&&r.push(t)})):(n=this.scroll.lines(e,t),r=this.scroll.descendants(o.a.Leaf,e,t));var i=[n,r].map((function(e){if(0===e.length)return{};for(var t=ee(e.shift());Object.keys(t).length>0;){var n=e.shift();if(null==n)return t;t=Ne(ee(n),t)}return t}));return u.a.apply(u.a,i)}},{key:"getText",value:function(e,t){return this.getContents(e,t).filter((function(e){return"string"==typeof e.insert})).map((function(e){return e.insert})).join("")}},{key:"insertEmbed",value:function(e,t,n){return this.scroll.insertAt(e,t,n),this.update((new a.a).retain(e).insert(function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},t,n)))}},{key:"insertText",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t=t.replace(/\r\n/g,"\n").replace(/\r/g,"\n"),this.scroll.insertAt(e,t),Object.keys(r).forEach((function(o){n.scroll.formatAt(e,t.length,o,r[o])})),this.update((new a.a).retain(e).insert(t,ke()(r)))}},{key:"isBlank",value:function(){if(0==this.scroll.children.length)return!0;if(this.scroll.children.length>1)return!1;var e=this.scroll.children.head;return e.statics.blotName===Z.blotName&&!(e.children.length>1)&&e.children.head instanceof T}},{key:"removeFormat",value:function(e,t){var n=this.getText(e,t),r=je(this.scroll.line(e+t),2),o=r[0],i=r[1],s=0,l=new a.a;null!=o&&(s=o instanceof me?o.newlineIndex(i)-i+1:o.length()-i,l=o.delta().slice(i,i+s-1).insert("\n"));var c=this.getContents(e,t+s).diff((new a.a).insert(n).concat(l)),u=(new a.a).retain(e).concat(c);return this.applyDelta(u)}},{key:"update",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,r=this.delta;if(1===t.length&&"characterData"===t[0].type&&t[0].target.data.match(Be)&&o.a.find(t[0].target)){var i=o.a.find(t[0].target),s=ee(i),l=i.offset(this.scroll),c=t[0].oldValue.replace(Ee.CONTENTS,""),u=(new a.a).insert(c),d=(new a.a).insert(i.value()),p=(new a.a).retain(l).concat(u.diff(d,n));e=p.reduce((function(e,t){return t.insert?e.insert(t.insert,s):e.push(t)}),new a.a),this.delta=r.compose(e)}else this.delta=this.getDelta(),e&&_e()(r.compose(e),this.delta)||(e=r.diff(this.delta,n));return e}}])&&Me(t.prototype,n),r&&Me(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),Fe=n(29),He=n.n(Fe),Ue=["error","warn","log","info"],ze="warn";function Ke(e){if(Ue.indexOf(e)<=Ue.indexOf(ze)){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];(t=console)[e].apply(t,r)}}function We(e){return Ue.reduce((function(t,n){return t[n]=Ke.bind(console,n,e),t}),{})}Ke.level=We.level=function(e){ze=e};var Ve=We;function Ge(e){return(Ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Qe(){return(Qe="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=Ye(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}}).apply(this,arguments)}function Ye(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Ze(e)););return e}function Xe(e,t){return(Xe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Je(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ze(e);if(t){var o=Ze(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return $e(this,n)}}function $e(e,t){if(t&&("object"===Ge(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Ze(e){return(Ze=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var et=Ve("quill:events");["selectionchange","mousedown","mouseup","click"].forEach((function(e){document.addEventListener(e,(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];[].slice.call(document.querySelectorAll(".ql-container")).forEach((function(e){var n;e.__quill&&e.__quill.emitter&&(n=e.__quill.emitter).handleDOM.apply(n,t)}))}))}));var tt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Xe(e,t)}(i,e);var t,n,r,o=Je(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).listeners={},e.on("error",et.error),e}return t=i,(n=[{key:"emit",value:function(){et.log.apply(et,arguments),Qe(Ze(i.prototype),"emit",this).apply(this,arguments)}},{key:"handleDOM",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];(this.listeners[e.type]||[]).forEach((function(t){var r=t.node,o=t.handler;(e.target===r||r.contains(e.target))&&o.apply(void 0,[e].concat(n))}))}},{key:"listenDOM",value:function(e,t,n){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push({node:t,handler:n})}}])&&qe(t.prototype,n),r&&qe(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(He.a);tt.events={EDITOR_CHANGE:"editor-change",SCROLL_BEFORE_UPDATE:"scroll-before-update",SCROLL_OPTIMIZE:"scroll-optimize",SCROLL_UPDATE:"scroll-update",SELECTION_CHANGE:"selection-change",TEXT_CHANGE:"text-change"},tt.sources={API:"api",SILENT:"silent",USER:"user"};var nt=tt;function rt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ot(e,t,n){return t&&rt(e.prototype,t),n&&rt(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function it(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var at=ot((function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};it(this,e),this.quill=t,this.options=n}));at.DEFAULTS={};var st=at;function lt(e){return function(e){if(Array.isArray(e))return dt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||ut(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ct(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(l){s=!0,o=l}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||ut(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ut(e,t){if(e){if("string"==typeof e)return dt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?dt(e,t):void 0}}function dt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function pt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ft(e,t,n){return t&&pt(e.prototype,t),n&&pt(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function ht(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var mt=Ve("quill:selection"),yt=ft((function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;ht(this,e),this.index=t,this.length=n})),gt=function(){function e(t,n){var r=this;ht(this,e),this.emitter=n,this.scroll=t,this.composing=!1,this.mouseDown=!1,this.root=this.scroll.domNode,this.cursor=o.a.create("cursor",this),this.lastRange=this.savedRange=new yt(0,0),this.handleComposition(),this.handleDragging(),this.emitter.listenDOM("selectionchange",document,(function(){r.mouseDown||setTimeout(r.update.bind(r,nt.sources.USER),1)})),this.emitter.on(nt.events.EDITOR_CHANGE,(function(e,t){e===nt.events.TEXT_CHANGE&&t.length()>0&&r.update(nt.sources.SILENT)})),this.emitter.on(nt.events.SCROLL_BEFORE_UPDATE,(function(){if(r.hasFocus()){var e=r.getNativeRange();null!=e&&e.start.node!==r.cursor.textNode&&r.emitter.once(nt.events.SCROLL_UPDATE,(function(){try{r.setNativeRange(e.start.node,e.start.offset,e.end.node,e.end.offset)}catch(t){}}))}})),this.emitter.on(nt.events.SCROLL_OPTIMIZE,(function(e,t){if(t.range){var n=t.range,o=n.startNode,i=n.startOffset,a=n.endNode,s=n.endOffset;r.setNativeRange(o,i,a,s)}})),this.update(nt.sources.SILENT)}return ft(e,[{key:"handleComposition",value:function(){var e=this;this.root.addEventListener("compositionstart",(function(){e.composing=!0})),this.root.addEventListener("compositionend",(function(){if(e.composing=!1,e.cursor.parent){var t=e.cursor.restore();if(!t)return;setTimeout((function(){e.setNativeRange(t.startNode,t.startOffset,t.endNode,t.endOffset)}),1)}}))}},{key:"handleDragging",value:function(){var e=this;this.emitter.listenDOM("mousedown",document.body,(function(){e.mouseDown=!0})),this.emitter.listenDOM("mouseup",document.body,(function(){e.mouseDown=!1,e.update(nt.sources.USER)}))}},{key:"focus",value:function(){this.hasFocus()||(this.root.focus(),this.setRange(this.savedRange))}},{key:"format",value:function(e,t){if(null==this.scroll.whitelist||this.scroll.whitelist[e]){this.scroll.update();var n=this.getNativeRange();if(null!=n&&n.native.collapsed&&!o.a.query(e,o.a.Scope.BLOCK)){if(n.start.node!==this.cursor.textNode){var r=o.a.find(n.start.node,!1);if(null==r)return;if(r instanceof o.a.Leaf){var i=r.split(n.start.offset);r.parent.insertBefore(this.cursor,i)}else r.insertBefore(this.cursor,n.start.node);this.cursor.attach()}this.cursor.format(e,t),this.scroll.optimize(),this.setNativeRange(this.cursor.textNode,this.cursor.textNode.data.length),this.update()}}}},{key:"getBounds",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.scroll.length();e=Math.min(e,n-1),t=Math.min(e+t,n-1)-e;var r,o=this.scroll.leaf(e),i=ct(o,2),a=i[0],s=i[1];if(null==a)return null;var l=a.position(s,!0),c=ct(l,2);r=c[0],s=c[1];var u=document.createRange();if(t>0){u.setStart(r,s);var d=this.scroll.leaf(e+t),p=ct(d,2);if(a=p[0],s=p[1],null==a)return null;var f=a.position(s,!0),h=ct(f,2);return r=h[0],s=h[1],u.setEnd(r,s),u.getBoundingClientRect()}var m,y="left";return r instanceof Text?(s<r.data.length?(u.setStart(r,s),u.setEnd(r,s+1)):(u.setStart(r,s-1),u.setEnd(r,s),y="right"),m=u.getBoundingClientRect()):(m=a.domNode.getBoundingClientRect(),s>0&&(y="right")),{bottom:m.top+m.height,height:m.height,left:m[y],right:m[y],top:m.top,width:0}}},{key:"getNativeRange",value:function(){var e=document.getSelection();if(null==e||e.rangeCount<=0)return null;var t=e.getRangeAt(0);if(null==t)return null;var n=this.normalizeNative(t);return mt.info("getNativeRange",n),n}},{key:"getRange",value:function(){var e=this.getNativeRange();return null==e?[null,null]:[this.normalizedToRange(e),e]}},{key:"hasFocus",value:function(){return document.activeElement===this.root}},{key:"normalizedToRange",value:function(e){var t=this,n=[[e.start.node,e.start.offset]];e.native.collapsed||n.push([e.end.node,e.end.offset]);var r=n.map((function(e){var n=ct(e,2),r=n[0],i=n[1],a=o.a.find(r,!0),s=a.offset(t.scroll);return 0===i?s:a instanceof o.a.Container?s+a.length():s+a.index(r,i)})),i=Math.min(Math.max.apply(Math,lt(r)),this.scroll.length()-1),a=Math.min.apply(Math,[i].concat(lt(r)));return new yt(a,i-a)}},{key:"normalizeNative",value:function(e){if(!bt(this.root,e.startContainer)||!e.collapsed&&!bt(this.root,e.endContainer))return null;var t={start:{node:e.startContainer,offset:e.startOffset},end:{node:e.endContainer,offset:e.endOffset},native:e};return[t.start,t.end].forEach((function(e){for(var t=e.node,n=e.offset;!(t instanceof Text)&&t.childNodes.length>0;)if(t.childNodes.length>n)t=t.childNodes[n],n=0;else{if(t.childNodes.length!==n)break;n=(t=t.lastChild)instanceof Text?t.data.length:t.childNodes.length+1}e.node=t,e.offset=n})),t}},{key:"rangeToNative",value:function(e){var t=this,n=e.collapsed?[e.index]:[e.index,e.index+e.length],r=[],o=this.scroll.length();return n.forEach((function(e,n){e=Math.min(o-1,e);var i,a=ct(t.scroll.leaf(e),2),s=a[0],l=a[1],c=ct(s.position(l,0!==n),2);i=c[0],l=c[1],r.push(i,l)})),r.length<2&&(r=r.concat(r)),r}},{key:"scrollIntoView",value:function(e){var t=this.lastRange;if(null!=t){var n=this.getBounds(t.index,t.length);if(null!=n){var r=this.scroll.length()-1,o=ct(this.scroll.line(Math.min(t.index,r)),1)[0],i=o;if(t.length>0&&(i=ct(this.scroll.line(Math.min(t.index+t.length,r)),1)[0]),null!=o&&null!=i){var a=e.getBoundingClientRect();n.top<a.top?e.scrollTop-=a.top-n.top:n.bottom>a.bottom&&(e.scrollTop+=n.bottom-a.bottom)}}}}},{key:"setNativeRange",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t,o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(mt.info("setNativeRange",e,t,n,r),null==e||null!=this.root.parentNode&&null!=e.parentNode&&null!=n.parentNode){var i=document.getSelection();if(null!=i)if(null!=e){this.hasFocus()||this.root.focus();var a=(this.getNativeRange()||{}).native;if(null==a||o||e!==a.startContainer||t!==a.startOffset||n!==a.endContainer||r!==a.endOffset){"BR"==e.tagName&&(t=[].indexOf.call(e.parentNode.childNodes,e),e=e.parentNode),"BR"==n.tagName&&(r=[].indexOf.call(n.parentNode.childNodes,n),n=n.parentNode);var s=document.createRange();s.setStart(e,t),s.setEnd(n,r),i.removeAllRanges(),i.addRange(s)}}else i.removeAllRanges(),this.root.blur(),document.body.focus()}}},{key:"setRange",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:nt.sources.API;if("string"==typeof t&&(n=t,t=!1),mt.info("setRange",e),null!=e){var r=this.rangeToNative(e);this.setNativeRange.apply(this,lt(r).concat([t]))}else this.setNativeRange(null);this.update(n)}},{key:"update",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:nt.sources.USER,t=this.lastRange,n=this.getRange(),r=ct(n,2),o=r[0],i=r[1];if(this.lastRange=o,null!=this.lastRange&&(this.savedRange=this.lastRange),!_e()(t,this.lastRange)){var a;!this.composing&&null!=i&&i.native.collapsed&&i.start.node!==this.cursor.textNode&&this.cursor.restore();var s,l=[nt.events.SELECTION_CHANGE,ke()(this.lastRange),ke()(t),e];(a=this.emitter).emit.apply(a,[nt.events.EDITOR_CHANGE].concat(l)),e!==nt.sources.SILENT&&(s=this.emitter).emit.apply(s,l)}}}]),e}();function bt(e,t){try{t.parentNode}catch(n){return!1}return t instanceof Text&&(t=t.parentNode),e.contains(t)}function vt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ct=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.quill=t,this.options=n,this.modules={}}var t,n,r;return t=e,(n=[{key:"init",value:function(){var e=this;Object.keys(this.options.modules).forEach((function(t){null==e.modules[t]&&e.addModule(t)}))}},{key:"addModule",value:function(e){var t=this.quill.constructor.import("modules/".concat(e));return this.modules[e]=new t(this.quill,this.options.modules[e]||{}),this.modules[e]}}])&&vt(t.prototype,n),r&&vt(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();Ct.DEFAULTS={modules:{}},Ct.themes={default:Ct};var Tt=Ct;function Ot(e){return(Ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function St(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Pt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(l){s=!0,o=l}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return xt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?xt(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function xt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function It(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Et(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var At=Ve("quill"),kt=function(){function e(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(It(this,e),this.options=wt(t,r),this.container=this.options.container,null==this.container)return At.error("Invalid Quill container",t);this.options.debug&&e.debug(this.options.debug);var i=this.container.innerHTML.trim();this.container.classList.add("ql-container"),this.container.innerHTML="",this.container.__quill=this,this.root=this.addContainer("ql-editor"),this.root.classList.add("ql-blank"),this.root.setAttribute("data-gramm",!1),this.scrollingContainer=this.options.scrollingContainer||this.root,this.emitter=new nt,this.scroll=o.a.create(this.root,{emitter:this.emitter,whitelist:this.options.formats}),this.editor=new Le(this.scroll),this.selection=new gt(this.scroll,this.emitter),this.theme=new this.options.theme(this,this.options),this.keyboard=this.theme.addModule("keyboard"),this.clipboard=this.theme.addModule("clipboard"),this.history=this.theme.addModule("history"),this.theme.init(),this.emitter.on(nt.events.EDITOR_CHANGE,(function(e){e===nt.events.TEXT_CHANGE&&n.root.classList.toggle("ql-blank",n.editor.isBlank())})),this.emitter.on(nt.events.SCROLL_UPDATE,(function(e,t){var r=n.selection.lastRange,o=r&&0===r.length?r.index:void 0;_t.call(n,(function(){return n.editor.update(null,t,o)}),e)}));var a=this.clipboard.convert("<div class='ql-editor' style=\"white-space: normal;\">".concat(i,"<p><br></p></div>"));this.setContents(a),this.history.clear(),this.options.placeholder&&this.root.setAttribute("data-placeholder",this.options.placeholder),this.options.readOnly&&this.disable()}var t,n,r;return t=e,r=[{key:"debug",value:function(e){!0===e&&(e="log"),Ve.level(e)}},{key:"find",value:function(e){return e.__quill||o.a.find(e)}},{key:"import",value:function(e){return null==this.imports[e]&&At.error("Cannot import ".concat(e,". Are you sure it was registered?")),this.imports[e]}},{key:"register",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if("string"!=typeof e){var i=e.attrName||e.blotName;"string"==typeof i?this.register("formats/"+i,e,t):Object.keys(e).forEach((function(r){n.register(r,e[r],t)}))}else null==this.imports[e]||r||At.warn("Overwriting ".concat(e," with"),t),this.imports[e]=t,(e.startsWith("blots/")||e.startsWith("formats/"))&&"abstract"!==t.blotName?o.a.register(t):e.startsWith("modules")&&"function"==typeof t.register&&t.register()}}],(n=[{key:"addContainer",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if("string"==typeof e){var n=e;(e=document.createElement("div")).classList.add(n)}return this.container.insertBefore(e,t),e}},{key:"blur",value:function(){this.selection.setRange(null)}},{key:"deleteText",value:function(e,t,n){var r=this,o=Pt(Rt(e,t,n),4);return e=o[0],t=o[1],n=o[3],_t.call(this,(function(){return r.editor.deleteText(e,t)}),n,e,-1*t)}},{key:"disable",value:function(){this.enable(!1)}},{key:"enable",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.scroll.enable(e),this.container.classList.toggle("ql-disabled",!e)}},{key:"focus",value:function(){var e=this.scrollingContainer.scrollTop;this.selection.focus(),this.scrollingContainer.scrollTop=e,this.scrollIntoView()}},{key:"format",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:nt.sources.API;return _t.call(this,(function(){var r=n.getSelection(!0),i=new a.a;if(null==r)return i;if(o.a.query(e,o.a.Scope.BLOCK))i=n.editor.formatLine(r.index,r.length,St({},e,t));else{if(0===r.length)return n.selection.format(e,t),i;i=n.editor.formatText(r.index,r.length,St({},e,t))}return n.setSelection(r,nt.sources.SILENT),i}),r)}},{key:"formatLine",value:function(e,t,n,r,o){var i,a=this,s=Pt(Rt(e,t,n,r,o),4);return e=s[0],t=s[1],i=s[2],o=s[3],_t.call(this,(function(){return a.editor.formatLine(e,t,i)}),o,e,0)}},{key:"formatText",value:function(e,t,n,r,o){var i,a=this,s=Pt(Rt(e,t,n,r,o),4);return e=s[0],t=s[1],i=s[2],o=s[3],_t.call(this,(function(){return a.editor.formatText(e,t,i)}),o,e,0)}},{key:"getBounds",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;t="number"==typeof e?this.selection.getBounds(e,n):this.selection.getBounds(e.index,e.length);var r=this.container.getBoundingClientRect();return{bottom:t.bottom-r.top,height:t.height,left:t.left-r.left,right:t.right-r.left,top:t.top-r.top,width:t.width}}},{key:"getContents",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getLength()-e,n=Rt(e,t),r=Pt(n,2);return e=r[0],t=r[1],this.editor.getContents(e,t)}},{key:"getFormat",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getSelection(!0),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return"number"==typeof e?this.editor.getFormat(e,t):this.editor.getFormat(e.index,e.length)}},{key:"getIndex",value:function(e){return e.offset(this.scroll)}},{key:"getLength",value:function(){return this.scroll.length()}},{key:"getLeaf",value:function(e){return this.scroll.leaf(e)}},{key:"getLine",value:function(e){return this.scroll.line(e)}},{key:"getLines",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.MAX_VALUE;return"number"!=typeof e?this.scroll.lines(e.index,e.length):this.scroll.lines(e,t)}},{key:"getModule",value:function(e){return this.theme.modules[e]}},{key:"getSelection",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return e&&this.focus(),this.update(),this.selection.getRange()[0]}},{key:"getText",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getLength()-e,n=Rt(e,t),r=Pt(n,2);return e=r[0],t=r[1],this.editor.getText(e,t)}},{key:"hasFocus",value:function(){return this.selection.hasFocus()}},{key:"insertEmbed",value:function(t,n,r){var o=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.sources.API;return _t.call(this,(function(){return o.editor.insertEmbed(t,n,r)}),i,t)}},{key:"insertText",value:function(e,t,n,r,o){var i,a=this,s=Pt(Rt(e,0,n,r,o),4);return e=s[0],i=s[2],o=s[3],_t.call(this,(function(){return a.editor.insertText(e,t,i)}),o,e,t.length)}},{key:"isEnabled",value:function(){return!this.container.classList.contains("ql-disabled")}},{key:"off",value:function(){return this.emitter.off.apply(this.emitter,arguments)}},{key:"on",value:function(){return this.emitter.on.apply(this.emitter,arguments)}},{key:"once",value:function(){return this.emitter.once.apply(this.emitter,arguments)}},{key:"pasteHTML",value:function(e,t,n){this.clipboard.dangerouslyPasteHTML(e,t,n)}},{key:"removeFormat",value:function(e,t,n){var r=this,o=Pt(Rt(e,t,n),4);return e=o[0],t=o[1],n=o[3],_t.call(this,(function(){return r.editor.removeFormat(e,t)}),n,e)}},{key:"scrollIntoView",value:function(){this.selection.scrollIntoView(this.scrollingContainer)}},{key:"setContents",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:nt.sources.API;return _t.call(this,(function(){e=new a.a(e);var n=t.getLength(),r=t.editor.deleteText(0,n),o=t.editor.applyDelta(e),i=o.ops[o.ops.length-1];return null!=i&&"string"==typeof i.insert&&"\n"===i.insert[i.insert.length-1]&&(t.editor.deleteText(t.getLength()-1,1),o.delete(1)),r.compose(o)}),n)}},{key:"setSelection",value:function(t,n,r){if(null==t)this.selection.setRange(null,n||e.sources.API);else{var o=Pt(Rt(t,n,r),4);t=o[0],n=o[1],r=o[3],this.selection.setRange(new yt(t,n),r),r!==nt.sources.SILENT&&this.selection.scrollIntoView(this.scrollingContainer)}}},{key:"setText",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:nt.sources.API,n=(new a.a).insert(e);return this.setContents(n,t)}},{key:"update",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:nt.sources.USER,t=this.scroll.update(e);return this.selection.update(e),t}},{key:"updateContents",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:nt.sources.API;return _t.call(this,(function(){return e=new a.a(e),t.editor.applyDelta(e,n)}),n,!0)}}])&&Et(t.prototype,n),r&&Et(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function wt(e,t){if((t=u()(!0,{container:e,modules:{clipboard:!0,keyboard:!0,history:!0}},t)).theme&&t.theme!==kt.DEFAULTS.theme){if(t.theme=kt.import("themes/".concat(t.theme)),null==t.theme)throw new Error("Invalid theme ".concat(t.theme,". Did you register it?"))}else t.theme=Tt;var n=u()(!0,{},t.theme.DEFAULTS);[n,t].forEach((function(e){e.modules=e.modules||{},Object.keys(e.modules).forEach((function(t){!0===e.modules[t]&&(e.modules[t]={})}))}));var r=Object.keys(n.modules).concat(Object.keys(t.modules)).reduce((function(e,t){var n=kt.import("modules/".concat(t));return null==n?At.error("Cannot load ".concat(t," module. Are you sure you registered it?")):e[t]=n.DEFAULTS||{},e}),{});return null!=t.modules&&t.modules.toolbar&&t.modules.toolbar.constructor!==Object&&(t.modules.toolbar={container:t.modules.toolbar}),t=u()(!0,{},kt.DEFAULTS,{modules:r},n,t),["bounds","container","scrollingContainer"].forEach((function(e){"string"==typeof t[e]&&(t[e]=document.querySelector(t[e]))})),t.modules=Object.keys(t.modules).reduce((function(e,n){return t.modules[n]&&(e[n]=t.modules[n]),e}),{}),t}function _t(e,t,n,r){if(this.options.strict&&!this.isEnabled()&&t===nt.sources.USER)return new a.a;var o=null==n?null:this.getSelection(),i=this.editor.delta,s=e();if(null!=o&&(!0===n&&(n=o.index),null==r?o=jt(o,s,t):0!==r&&(o=jt(o,n,r,t)),this.setSelection(o,nt.sources.SILENT)),s.length()>0){var l,c,u=[nt.events.TEXT_CHANGE,s,i,t];(l=this.emitter).emit.apply(l,[nt.events.EDITOR_CHANGE].concat(u)),t!==nt.sources.SILENT&&(c=this.emitter).emit.apply(c,u)}return s}function Rt(e,t,n,r,o){var i={};return"number"==typeof e.index&&"number"==typeof e.length?"number"!=typeof t?(o=r,r=n,n=t,t=e.length,e=e.index):(t=e.length,e=e.index):"number"!=typeof t&&(o=r,r=n,n=t,t=0),"object"===Ot(n)?(i=n,o=r):"string"==typeof n&&(null!=r?i[n]=r:o=n),[e,t,i,o=o||nt.sources.API]}function jt(e,t,n,r){if(null==e)return null;var o,i;if(t instanceof a.a){var s=Pt([e.index,e.index+e.length].map((function(e){return t.transformPosition(e,r!==nt.sources.USER)})),2);o=s[0],i=s[1]}else{var l=Pt([e.index,e.index+e.length].map((function(e){return e<t||e===t&&r===nt.sources.USER?e:n>=0?e+n:Math.max(t,e+n)})),2);o=l[0],i=l[1]}return new yt(o,i-o)}function Dt(e){return(Dt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Mt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Bt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Nt(e,t){return(Nt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Lt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ht(e);if(t){var o=Ht(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ft(this,n)}}function Ft(e,t){if(t&&("object"===Dt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Ht(e){return(Ht=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}kt.DEFAULTS={bounds:null,formats:null,modules:{},placeholder:"",readOnly:!1,scrollingContainer:null,strict:!0,theme:"default"},kt.events=nt.events,kt.sources=nt.sources,kt.version="undefined"==typeof QUILL_VERSION?"dev":QUILL_VERSION,kt.imports={delta:a.a,parchment:o.a,"core/module":st,"core/theme":Tt};var Ut=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Nt(e,t)}(i,e);var t,n,r,o=Lt(i);function i(){return Bt(this,i),o.apply(this,arguments)}return t=i,n&&Mt(t.prototype,n),r&&Mt(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}(o.a.Container);Ut.allowedChildren=[Z,$,Ut];var zt=Ut;function Kt(e){return(Kt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Wt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Vt(){return(Vt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=Gt(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}}).apply(this,arguments)}function Gt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Xt(e)););return e}function qt(e,t){return(qt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Qt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Xt(e);if(t){var o=Xt(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Yt(this,n)}}function Yt(e,t){if(t&&("object"===Kt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Xt(e){return(Xt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Jt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qt(e,t)}(a,e);var t,n,r,i=Qt(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,e)).contentNode=document.createElement("span"),t.contentNode.setAttribute("contenteditable",!1),[].slice.call(t.domNode.childNodes).forEach((function(e){t.contentNode.appendChild(e)})),t.leftGuard=document.createTextNode("\ufeff"),t.rightGuard=document.createTextNode("\ufeff"),t.domNode.appendChild(t.leftGuard),t.domNode.appendChild(t.contentNode),t.domNode.appendChild(t.rightGuard),t}return t=a,(n=[{key:"index",value:function(e,t){return e===this.leftGuard?0:e===this.rightGuard?1:Vt(Xt(a.prototype),"index",this).call(this,e,t)}},{key:"restore",value:function(e){var t,n,r=e.data.split("\ufeff").join("");if(e===this.leftGuard)if(this.prev instanceof k){var i=this.prev.length();this.prev.insertAt(i,r),t={startNode:this.prev.domNode,startOffset:i+r.length}}else n=document.createTextNode(r),this.parent.insertBefore(o.a.create(n),this),t={startNode:n,startOffset:r.length};else e===this.rightGuard&&(this.next instanceof k?(this.next.insertAt(0,r),t={startNode:this.next.domNode,startOffset:r.length}):(n=document.createTextNode(r),this.parent.insertBefore(o.a.create(n),this.next),t={startNode:n,startOffset:r.length}));return e.data="\ufeff",t}},{key:"update",value:function(e,t){var n=this;e.forEach((function(e){if("characterData"===e.type&&(e.target===n.leftGuard||e.target===n.rightGuard)){var r=n.restore(e.target);r&&(t.range=r)}}))}}])&&Wt(t.prototype,n),r&&Wt(t,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(o.a.Embed);function $t(e){return($t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Zt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function en(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function tn(){return(tn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=nn(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}}).apply(this,arguments)}function nn(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=sn(e)););return e}function rn(e,t){return(rn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function on(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=sn(e);if(t){var o=sn(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return an(this,n)}}function an(e,t){if(t&&("object"===$t(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function sn(e){return(sn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ln=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&rn(e,t)}(i,e);var t,n,r,o=on(i);function i(){return Zt(this,i),o.apply(this,arguments)}return t=i,(n=[{key:"value",value:function(e){var t=tn(sn(i.prototype),"value",this).call(this,e);return t.startsWith("rgb(")?(t=t.replace(/^[^\d]+/,"").replace(/[^\d]+$/,""),"#"+t.split(",").map((function(e){return("00"+parseInt(e).toString(16)).slice(-2)})).join("")):t}}])&&en(t.prototype,n),r&&en(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(o.a.Attributor.Style),cn=(new o.a.Attributor.Class("color","ql-color",{scope:o.a.Scope.INLINE}),new ln("color","color",{scope:o.a.Scope.INLINE})),un=(new o.a.Attributor.Class("background","ql-bg",{scope:o.a.Scope.INLINE}),new ln("background","background-color",{scope:o.a.Scope.INLINE}));function dn(e){return(dn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function hn(){return(hn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=mn(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}}).apply(this,arguments)}function mn(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=vn(e)););return e}function yn(e,t){return(yn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function gn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=vn(e);if(t){var o=vn(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return bn(this,n)}}function bn(e,t){if(t&&("object"===dn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function vn(e){return(vn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Cn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&yn(e,t)}(i,e);var t,n,r,o=gn(i);function i(){return pn(this,i),o.apply(this,arguments)}return t=i,r=[{key:"create",value:function(){return hn(vn(i),"create",this).call(this)}},{key:"formats",value:function(){return!0}}],(n=[{key:"optimize",value:function(e){hn(vn(i.prototype),"optimize",this).call(this,e),this.domNode.tagName!==this.statics.tagName[0]&&this.replaceWith(this.statics.blotName)}}])&&fn(t.prototype,n),r&&fn(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(H);Cn.blotName="bold",Cn.tagName=["STRONG","B"];var Tn=Cn;function On(e){return(On="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Sn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Pn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function xn(){return(xn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=In(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}}).apply(this,arguments)}function In(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=wn(e)););return e}function En(e,t){return(En=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function An(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=wn(e);if(t){var o=wn(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return kn(this,n)}}function kn(e,t){if(t&&("object"===On(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function wn(e){return(wn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var _n={scope:o.a.Scope.INLINE,whitelist:["serif","monospace"]},Rn=(new o.a.Attributor.Class("font","ql-font",_n),new(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&En(e,t)}(i,e);var t,n,r,o=An(i);function i(){return Sn(this,i),o.apply(this,arguments)}return t=i,(n=[{key:"value",value:function(e){return xn(wn(i.prototype),"value",this).call(this,e).replace(/["']/g,"")}}])&&Pn(t.prototype,n),r&&Pn(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(o.a.Attributor.Style))("font","font-family",_n));function jn(e){return(jn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Dn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Mn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Bn(e,t){return(Bn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Nn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Fn(e);if(t){var o=Fn(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ln(this,n)}}function Ln(e,t){if(t&&("object"===jn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Fn(e){return(Fn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Hn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Bn(e,t)}(i,e);var t,n,r,o=Nn(i);function i(){return Mn(this,i),o.apply(this,arguments)}return t=i,n&&Dn(t.prototype,n),r&&Dn(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}(Tn);Hn.blotName="italic",Hn.tagName=["EM","I"];var Un=Hn;function zn(e){return(zn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Kn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Wn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Vn(){return(Vn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=Gn(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}}).apply(this,arguments)}function Gn(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Xn(e)););return e}function qn(e,t){return(qn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Qn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Xn(e);if(t){var o=Xn(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Yn(this,n)}}function Yn(e,t){if(t&&("object"===zn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Xn(e){return(Xn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Jn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qn(e,t)}(i,e);var t,n,r,o=Qn(i);function i(){return Kn(this,i),o.apply(this,arguments)}return t=i,r=[{key:"create",value:function(e){var t=Vn(Xn(i),"create",this).call(this,e);return e=this.sanitize(e),t.setAttribute("href",e),t.setAttribute("rel","noopener noreferrer"),t.setAttribute("target","_blank"),t}},{key:"formats",value:function(e){return e.getAttribute("href")}},{key:"sanitize",value:function(e){return function(e,t){var n=document.createElement("a");n.href=e;var r=n.href.slice(0,n.href.indexOf(":"));return t.indexOf(r)>-1}(e,this.PROTOCOL_WHITELIST)?e:this.SANITIZED_URL}}],(n=[{key:"format",value:function(e,t){if(e!==this.statics.blotName||!t)return Vn(Xn(i.prototype),"format",this).call(this,e,t);t=this.constructor.sanitize(t),this.domNode.setAttribute("href",t)}}])&&Wn(t.prototype,n),r&&Wn(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(H);function $n(e){return($n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Zn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function er(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function tr(){return(tr="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=nr(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}}).apply(this,arguments)}function nr(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ar(e)););return e}function rr(e,t){return(rr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function or(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ar(e);if(t){var o=ar(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ir(this,n)}}function ir(e,t){if(t&&("object"===$n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ar(e){return(ar=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Jn.blotName="link",Jn.tagName="A",Jn.SANITIZED_URL="about:blank",Jn.PROTOCOL_WHITELIST=["http","https","mailto","tel"];var sr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&rr(e,t)}(i,e);var t,n,r,o=or(i);function i(){return Zn(this,i),o.apply(this,arguments)}return t=i,r=[{key:"create",value:function(e){return"super"===e?document.createElement("sup"):"sub"===e?document.createElement("sub"):tr(ar(i),"create",this).call(this,e)}},{key:"formats",value:function(e){return"SUB"===e.tagName?"sub":"SUP"===e.tagName?"super":void 0}}],(n=null)&&er(t.prototype,n),r&&er(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(H);sr.blotName="script",sr.tagName=["SUB","SUP"];var lr=sr,cr=(new o.a.Attributor.Class("size","ql-size",{scope:o.a.Scope.INLINE,whitelist:["small","large","huge"]}),new o.a.Attributor.Style("size","font-size",{scope:o.a.Scope.INLINE,whitelist:["10px","18px","32px"]}));function ur(e){return(ur="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function dr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function pr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fr(e,t){return(fr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function hr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=yr(e);if(t){var o=yr(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return mr(this,n)}}function mr(e,t){if(t&&("object"===ur(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function yr(e){return(yr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var gr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fr(e,t)}(i,e);var t,n,r,o=hr(i);function i(){return pr(this,i),o.apply(this,arguments)}return t=i,n&&dr(t.prototype,n),r&&dr(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}(H);gr.blotName="strike",gr.tagName="S";var br=gr;function vr(e){return(vr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Cr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Tr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Or(e,t){return(Or=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Sr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=xr(e);if(t){var o=xr(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Pr(this,n)}}function Pr(e,t){if(t&&("object"===vr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function xr(e){return(xr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ir=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Or(e,t)}(i,e);var t,n,r,o=Sr(i);function i(){return Tr(this,i),o.apply(this,arguments)}return t=i,n&&Cr(t.prototype,n),r&&Cr(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}(H);Ir.blotName="underline",Ir.tagName="U";var Er=Ir,Ar={scope:o.a.Scope.BLOCK,whitelist:["right","center","justify"]},kr=new o.a.Attributor.Attribute("align","align",Ar),wr=(new o.a.Attributor.Class("align","ql-align",Ar),new o.a.Attributor.Style("align","text-align",Ar)),_r={scope:o.a.Scope.BLOCK,whitelist:["rtl"]},Rr=new o.a.Attributor.Attribute("direction","dir",_r),jr=(new o.a.Attributor.Class("direction","ql-direction",_r),new o.a.Attributor.Style("direction","direction",_r));function Dr(e){return(Dr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Mr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Br(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(l){s=!0,o=l}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Nr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Nr(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Nr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Lr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Fr(e,t){return(Fr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Hr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Kr(e);if(t){var o=Kr(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ur(this,n)}}function Ur(e,t){if(t&&("object"===Dr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return zr(e)}function zr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Kr(e){return(Kr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Wr=Ve("quill:clipboard"),Vr="__ql-matcher",Gr=[[Node.TEXT_NODE,function(e,t){var n=e.data;if("O:P"===e.parentNode.tagName)return t.insert(n.trim());if(0===n.trim().length&&e.parentNode.classList.contains("ql-clipboard"))return t;if(!Jr(e.parentNode).whiteSpace.startsWith("pre")){var r=function(e,t){return(t=t.replace(/[^\u00a0]/g,"")).length<1&&e?" ":t};n=(n=n.replace(/\r\n/g," ").replace(/\n/g," ")).replace(/\s\s+/g,r.bind(r,!0)),(null==e.previousSibling&&Zr(e.parentNode)||null!=e.previousSibling&&Zr(e.previousSibling))&&(n=n.replace(/^\s+/,r.bind(r,!1))),(null==e.nextSibling&&Zr(e.parentNode)||null!=e.nextSibling&&Zr(e.nextSibling))&&(n=n.replace(/\s+$/,r.bind(r,!1)))}return t.insert(n)}],[Node.TEXT_NODE,to],["br",function(e,t){return $r(t,"\n")||t.insert("\n"),t}],[Node.ELEMENT_NODE,to],[Node.ELEMENT_NODE,function(e,t){var n=o.a.query(e);if(null==n)return t;if(n.prototype instanceof o.a.Embed){var r={},i=n.value(e);null!=i&&(r[n.blotName]=i,t=(new a.a).insert(r,n.formats(e)))}else"function"==typeof n.formats&&(t=Xr(t,n.blotName,n.formats(e)));return t}],[Node.ELEMENT_NODE,no],[Node.ELEMENT_NODE,function(e,t){var n=o.a.Attributor.Attribute.keys(e),r=o.a.Attributor.Class.keys(e),i=o.a.Attributor.Style.keys(e),a={};return n.concat(r).concat(i).forEach((function(t){var n=o.a.query(t,o.a.Scope.ATTRIBUTE);null!=n&&(a[n.attrName]=n.value(e),a[n.attrName])||(null==(n=qr[t])||n.attrName!==t&&n.keyName!==t||(a[n.attrName]=n.value(e)||void 0),null==(n=Qr[t])||n.attrName!==t&&n.keyName!==t||(n=Qr[t],a[n.attrName]=n.value(e)||void 0))})),Object.keys(a).length>0&&(t=Xr(t,a)),t}],[Node.ELEMENT_NODE,function(e,t){var n={},r=e.style||{};return r.fontStyle&&"italic"===Jr(e).fontStyle&&(n.italic=!0),r.fontWeight&&(Jr(e).fontWeight.startsWith("bold")||parseInt(Jr(e).fontWeight)>=700)&&(n.bold=!0),Object.keys(n).length>0&&(t=Xr(t,n)),parseFloat(r.textIndent||0)>0&&(t=(new a.a).insert("\t").concat(t)),t}],["li",function(e,t){var n=o.a.query(e);if(null==n||"list-item"!==n.blotName||!$r(t,"\n"))return t;for(var r=-1,i=e.parentNode;!i.classList.contains("ql-clipboard");)"list"===(o.a.query(i)||{}).blotName&&(r+=1),i=i.parentNode;return r<=0?t:t.compose((new a.a).retain(t.length()-1).retain(1,{indent:r}))}],["b",eo.bind(eo,"bold")],["i",eo.bind(eo,"italic")],["style",function(){return new a.a}]],qr=[kr,Rr].reduce((function(e,t){return e[t.keyName]=t,e}),{}),Qr=[wr,un,cn,jr,Rn,cr].reduce((function(e,t){return e[t.keyName]=t,e}),{}),Yr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Fr(e,t)}(i,e);var t,n,r,o=Hr(i);function i(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(n=o.call(this,e,t)).quill.root.addEventListener("paste",n.onPaste.bind(zr(n))),n.container=n.quill.addContainer("ql-clipboard"),n.container.setAttribute("contenteditable",!0),n.container.setAttribute("tabindex",-1),n.matchers=[],Gr.concat(n.options.matchers).forEach((function(e){var r=Br(e,2),o=r[0],i=r[1];(t.matchVisual||i!==no)&&n.addMatcher(o,i)})),n}return t=i,(n=[{key:"addMatcher",value:function(e,t){this.matchers.push([e,t])}},{key:"convert",value:function(e){if("string"==typeof e)return this.container.innerHTML=e.replace(/\>\r?\n +\</g,"><"),this.convert();var t=this.quill.getFormat(this.quill.selection.savedRange.index);if(t[me.blotName]){var n=this.container.innerText;return this.container.innerHTML="",(new a.a).insert(n,Mr({},me.blotName,t[me.blotName]))}var r=Br(this.prepareMatching(),2),o=r[0],i=r[1],s=function e(t,n,r){return t.nodeType===t.TEXT_NODE?r.reduce((function(e,n){return n(t,e)}),new a.a):t.nodeType===t.ELEMENT_NODE?[].reduce.call(t.childNodes||[],(function(o,i){var a=e(i,n,r);return i.nodeType===t.ELEMENT_NODE&&(a=n.reduce((function(e,t){return t(i,e)}),a),a=(i[Vr]||[]).reduce((function(e,t){return t(i,e)}),a)),o.concat(a)}),new a.a):new a.a}(this.container,o,i);return $r(s,"\n")&&null==s.ops[s.ops.length-1].attributes&&(s=s.compose((new a.a).retain(s.length()-1).delete(1))),Wr.log("convert",this.container.innerHTML,s),this.container.innerHTML="",s}},{key:"dangerouslyPasteHTML",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:kt.sources.API;if("string"==typeof e)this.quill.setContents(this.convert(e),t),this.quill.setSelection(0,kt.sources.SILENT);else{var r=this.convert(t);this.quill.updateContents((new a.a).retain(e).concat(r),n),this.quill.setSelection(e+r.length(),kt.sources.SILENT)}}},{key:"onPaste",value:function(e){var t=this;if(!e.defaultPrevented&&this.quill.isEnabled()){var n=this.quill.getSelection(),r=(new a.a).retain(n.index),o=this.quill.scrollingContainer.scrollTop;this.container.focus(),this.quill.selection.update(kt.sources.SILENT),setTimeout((function(){r=r.concat(t.convert()).delete(n.length),t.quill.updateContents(r,kt.sources.USER),t.quill.setSelection(r.length()-n.length,kt.sources.SILENT),t.quill.scrollingContainer.scrollTop=o,t.quill.focus()}),1)}}},{key:"prepareMatching",value:function(){var e=this,t=[],n=[];return this.matchers.forEach((function(r){var o=Br(r,2),i=o[0],a=o[1];switch(i){case Node.TEXT_NODE:n.push(a);break;case Node.ELEMENT_NODE:t.push(a);break;default:[].forEach.call(e.container.querySelectorAll(i),(function(e){e[Vr]=e[Vr]||[],e[Vr].push(a)}))}})),[t,n]}}])&&Lr(t.prototype,n),r&&Lr(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(st);function Xr(e,t,n){return"object"===Dr(t)?Object.keys(t).reduce((function(e,n){return Xr(e,n,t[n])}),e):e.reduce((function(e,r){return r.attributes&&r.attributes[t]?e.push(r):e.insert(r.insert,u()({},Mr({},t,n),r.attributes))}),new a.a)}function Jr(e){return e.nodeType!==Node.ELEMENT_NODE?{}:e["__ql-computed-style"]||(e["__ql-computed-style"]=window.getComputedStyle(e))}function $r(e,t){for(var n="",r=e.ops.length-1;r>=0&&n.length<t.length;--r){var o=e.ops[r];if("string"!=typeof o.insert)break;n=o.insert+n}return n.slice(-1*t.length)===t}function Zr(e){if(0===e.childNodes.length)return!1;var t=Jr(e);return["block","list-item"].indexOf(t.display)>-1}function eo(e,t,n){return Xr(n,e,!0)}function to(e,t){return $r(t,"\n")||(Zr(e)||t.length()>0&&e.nextSibling&&Zr(e.nextSibling))&&t.insert("\n"),t}function no(e,t){if(Zr(e)&&null!=e.nextElementSibling&&!$r(t,"\n\n")){var n=e.offsetHeight+parseFloat(Jr(e).marginTop)+parseFloat(Jr(e).marginBottom);e.nextElementSibling.offsetTop>e.offsetTop+1.5*n&&t.insert("\n")}return t}function ro(e){return(ro="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function oo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function io(e,t){return(io=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ao(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=co(e);if(t){var o=co(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return so(this,n)}}function so(e,t){if(t&&("object"===ro(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return lo(e)}function lo(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function co(e){return(co=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Yr.DEFAULTS={matchers:[],matchVisual:!0};var uo=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&io(e,t)}(a,e);var t,n,r,i=ao(a);function a(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=i.call(this,e,t)).lastRecorded=0,n.ignoreChange=!1,n.clear(),n.quill.on(kt.events.EDITOR_CHANGE,(function(e,t,r,o){e!==kt.events.TEXT_CHANGE||n.ignoreChange||(n.options.userOnly&&o!==kt.sources.USER?n.transform(t):n.record(t,r))})),n.quill.keyboard.addBinding({key:"Z",shortKey:!0},n.undo.bind(lo(n))),n.quill.keyboard.addBinding({key:"Z",shortKey:!0,shiftKey:!0},n.redo.bind(lo(n))),/Win/i.test(navigator.platform)&&n.quill.keyboard.addBinding({key:"Y",shortKey:!0},n.redo.bind(lo(n))),n}return t=a,(n=[{key:"change",value:function(e,t){if(0!==this.stack[e].length){var n=this.stack[e].pop();this.stack[t].push(n),this.lastRecorded=0,this.ignoreChange=!0,this.quill.updateContents(n[e],kt.sources.USER),this.ignoreChange=!1;var r=function(e){var t=e.reduce((function(e,t){return e+=t.delete||0}),0),n=e.length()-t;return function(e){var t=e.ops[e.ops.length-1];return null!=t&&(null!=t.insert?"string"==typeof t.insert&&t.insert.endsWith("\n"):null!=t.attributes&&Object.keys(t.attributes).some((function(e){return null!=o.a.query(e,o.a.Scope.BLOCK)})))}(e)&&(n-=1),n}(n[e]);this.quill.setSelection(r)}}},{key:"clear",value:function(){this.stack={undo:[],redo:[]}}},{key:"cutoff",value:function(){this.lastRecorded=0}},{key:"record",value:function(e,t){if(0!==e.ops.length){this.stack.redo=[];var n=this.quill.getContents().diff(t),r=Date.now();if(this.lastRecorded+this.options.delay>r&&this.stack.undo.length>0){var o=this.stack.undo.pop();n=n.compose(o.undo),e=o.redo.compose(e)}else this.lastRecorded=r;this.stack.undo.push({redo:e,undo:n}),this.stack.undo.length>this.options.maxStack&&this.stack.undo.shift()}}},{key:"redo",value:function(){this.change("redo","undo")}},{key:"transform",value:function(e){this.stack.undo.forEach((function(t){t.undo=e.transform(t.undo,!0),t.redo=e.transform(t.redo,!0)})),this.stack.redo.forEach((function(t){t.undo=e.transform(t.undo,!0),t.redo=e.transform(t.redo,!0)}))}},{key:"undo",value:function(){this.change("undo","redo")}}])&&oo(t.prototype,n),r&&oo(t,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(st);function po(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function fo(e){return(fo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ho(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(l){s=!0,o=l}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return mo(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?mo(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function mo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function yo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function go(e,t){return(go=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function bo(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Co(e);if(t){var o=Co(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return vo(this,n)}}function vo(e,t){if(t&&("object"===fo(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Co(e){return(Co=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}uo.DEFAULTS={delay:1e3,maxStack:100,userOnly:!1};var To=Ve("quill:keyboard"),Oo=/Mac/i.test(navigator.platform)?"metaKey":"ctrlKey",So=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&go(e,t)}(a,e);var t,n,r,i=bo(a);function a(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=i.call(this,e,t)).bindings={},Object.keys(n.options.bindings).forEach((function(t){("list autofill"!==t||null==e.scroll.whitelist||e.scroll.whitelist.list)&&n.options.bindings[t]&&n.addBinding(n.options.bindings[t])})),n.addBinding({key:a.keys.ENTER,shiftKey:null},Ao),n.addBinding({key:a.keys.ENTER,metaKey:null,ctrlKey:null,altKey:null},(function(){})),/Firefox/i.test(navigator.userAgent)?(n.addBinding({key:a.keys.BACKSPACE},{collapsed:!0},xo),n.addBinding({key:a.keys.DELETE},{collapsed:!0},Io)):(n.addBinding({key:a.keys.BACKSPACE},{collapsed:!0,prefix:/^.?$/},xo),n.addBinding({key:a.keys.DELETE},{collapsed:!0,suffix:/^.?$/},Io)),n.addBinding({key:a.keys.BACKSPACE},{collapsed:!1},Eo),n.addBinding({key:a.keys.DELETE},{collapsed:!1},Eo),n.addBinding({key:a.keys.BACKSPACE,altKey:null,ctrlKey:null,metaKey:null,shiftKey:null},{collapsed:!0,offset:0},xo),n.listen(),n}return t=a,r=[{key:"match",value:function(e,t){return t=_o(t),!["altKey","ctrlKey","metaKey","shiftKey"].some((function(n){return!!t[n]!==e[n]&&null!==t[n]}))&&t.key===(e.which||e.keyCode)}}],(n=[{key:"addBinding",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=_o(e);if(null==r||null==r.key)return To.warn("Attempted to add invalid keyboard binding",r);"function"==typeof t&&(t={handler:t}),"function"==typeof n&&(n={handler:n}),r=u()(r,t,n),this.bindings[r.key]=this.bindings[r.key]||[],this.bindings[r.key].push(r)}},{key:"listen",value:function(){var e=this;this.quill.root.addEventListener("keydown",(function(t){if(!t.defaultPrevented){var n=t.which||t.keyCode,r=(e.bindings[n]||[]).filter((function(e){return a.match(t,e)}));if(0!==r.length){var i=e.quill.getSelection();if(null!=i&&e.quill.hasFocus()){var s=ho(e.quill.getLine(i.index),2),l=s[0],c=s[1],u=ho(e.quill.getLeaf(i.index),2),d=u[0],p=u[1],f=ho(0===i.length?[d,p]:e.quill.getLeaf(i.index+i.length),2),h=f[0],m=f[1],y=d instanceof o.a.Text?d.value().slice(0,p):"",g=h instanceof o.a.Text?h.value().slice(m):"",b={collapsed:0===i.length,empty:0===i.length&&l.length()<=1,format:e.quill.getFormat(i),offset:c,prefix:y,suffix:g};r.some((function(t){if(null!=t.collapsed&&t.collapsed!==b.collapsed)return!1;if(null!=t.empty&&t.empty!==b.empty)return!1;if(null!=t.offset&&t.offset!==b.offset)return!1;if(Array.isArray(t.format)){if(t.format.every((function(e){return null==b.format[e]})))return!1}else if("object"===fo(t.format)&&!Object.keys(t.format).every((function(e){return!0===t.format[e]?null!=b.format[e]:!1===t.format[e]?null==b.format[e]:_e()(t.format[e],b.format[e])})))return!1;return!(null!=t.prefix&&!t.prefix.test(b.prefix)||null!=t.suffix&&!t.suffix.test(b.suffix)||!0===t.handler.call(e,i,b))}))&&t.preventDefault()}}}}))}}])&&yo(t.prototype,n),r&&yo(t,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(st);function Po(e,t){var n,r=e===So.keys.LEFT?"prefix":"suffix";return po(n={key:e,shiftKey:t,altKey:null},r,/^$/),po(n,"handler",(function(n){var r=n.index;return e===So.keys.RIGHT&&(r+=n.length+1),!(ho(this.quill.getLeaf(r),1)[0]instanceof o.a.Embed&&(e===So.keys.LEFT?t?this.quill.setSelection(n.index-1,n.length+1,kt.sources.USER):this.quill.setSelection(n.index-1,kt.sources.USER):t?this.quill.setSelection(n.index,n.length+1,kt.sources.USER):this.quill.setSelection(n.index+n.length+1,kt.sources.USER),1))})),n}function xo(e,t){if(!(0===e.index||this.quill.getLength()<=1)){var n=ho(this.quill.getLine(e.index),1)[0],r={};if(0===t.offset){var o=ho(this.quill.getLine(e.index-1),1)[0];if(null!=o&&o.length()>1){var i=n.formats(),a=this.quill.getFormat(e.index-1,1);r=l.a.attributes.diff(i,a)||{}}}var s=/[\uD800-\uDBFF][\uDC00-\uDFFF]$/.test(t.prefix)?2:1;this.quill.deleteText(e.index-s,s,kt.sources.USER),Object.keys(r).length>0&&this.quill.formatLine(e.index-s,s,r,kt.sources.USER),this.quill.focus()}}function Io(e,t){var n=/^[\uD800-\uDBFF][\uDC00-\uDFFF]/.test(t.suffix)?2:1;if(!(e.index>=this.quill.getLength()-n)){var r={},o=0,i=ho(this.quill.getLine(e.index),1)[0];if(t.offset>=i.length()-1){var a=ho(this.quill.getLine(e.index+1),1)[0];if(a){var s=i.formats(),c=this.quill.getFormat(e.index,1);r=l.a.attributes.diff(s,c)||{},o=a.length()}}this.quill.deleteText(e.index,n,kt.sources.USER),Object.keys(r).length>0&&this.quill.formatLine(e.index+o-1,n,r,kt.sources.USER)}}function Eo(e){var t=this.quill.getLines(e),n={};if(t.length>1){var r=t[0].formats(),o=t[t.length-1].formats();n=l.a.attributes.diff(o,r)||{}}this.quill.deleteText(e,kt.sources.USER),Object.keys(n).length>0&&this.quill.formatLine(e.index,1,n,kt.sources.USER),this.quill.setSelection(e.index,kt.sources.SILENT),this.quill.focus()}function Ao(e,t){var n=this;e.length>0&&this.quill.scroll.deleteAt(e.index,e.length);var r=Object.keys(t.format).reduce((function(e,n){return o.a.query(n,o.a.Scope.BLOCK)&&!Array.isArray(t.format[n])&&(e[n]=t.format[n]),e}),{});this.quill.insertText(e.index,"\n",r,kt.sources.USER),this.quill.setSelection(e.index+1,kt.sources.SILENT),this.quill.focus(),Object.keys(t.format).forEach((function(e){null==r[e]&&(Array.isArray(t.format[e])||"link"!==e&&n.quill.format(e,t.format[e],kt.sources.USER))}))}function ko(e){return{key:So.keys.TAB,shiftKey:!e,format:{"code-block":!0},handler:function(t){var n=o.a.query("code-block"),r=t.index,i=t.length,a=ho(this.quill.scroll.descendant(n,r),2),s=a[0],l=a[1];if(null!=s){var c=this.quill.getIndex(s),u=s.newlineIndex(l,!0)+1,d=s.newlineIndex(c+l+i),p=s.domNode.textContent.slice(u,d).split("\n");l=0,p.forEach((function(t,o){e?(s.insertAt(u+l,n.TAB),l+=n.TAB.length,0===o?r+=n.TAB.length:i+=n.TAB.length):t.startsWith(n.TAB)&&(s.deleteAt(u+l,n.TAB.length),l-=n.TAB.length,0===o?r-=n.TAB.length:i-=n.TAB.length),l+=t.length+1})),this.quill.update(kt.sources.USER),this.quill.setSelection(r,i,kt.sources.SILENT)}}}}function wo(e){return{key:e[0].toUpperCase(),shortKey:!0,handler:function(t,n){this.quill.format(e,!n.format[e],kt.sources.USER)}}}function _o(e){if("string"==typeof e||"number"==typeof e)return _o({key:e});if("object"===fo(e)&&(e=ke()(e,!1)),"string"==typeof e.key)if(null!=So.keys[e.key.toUpperCase()])e.key=So.keys[e.key.toUpperCase()];else{if(1!==e.key.length)return null;e.key=e.key.toUpperCase().charCodeAt(0)}return e.shortKey&&(e[Oo]=e.shortKey,delete e.shortKey),e}So.keys={BACKSPACE:8,TAB:9,ENTER:13,ESCAPE:27,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46},So.DEFAULTS={bindings:{bold:wo("bold"),italic:wo("italic"),underline:wo("underline"),indent:{key:So.keys.TAB,format:["blockquote","indent","list"],handler:function(e,t){if(t.collapsed&&0!==t.offset)return!0;this.quill.format("indent","+1",kt.sources.USER)}},outdent:{key:So.keys.TAB,shiftKey:!0,format:["blockquote","indent","list"],handler:function(e,t){if(t.collapsed&&0!==t.offset)return!0;this.quill.format("indent","-1",kt.sources.USER)}},"outdent backspace":{key:So.keys.BACKSPACE,collapsed:!0,shiftKey:null,metaKey:null,ctrlKey:null,altKey:null,format:["indent","list"],offset:0,handler:function(e,t){null!=t.format.indent?this.quill.format("indent","-1",kt.sources.USER):null!=t.format.list&&this.quill.format("list",!1,kt.sources.USER)}},"indent code-block":ko(!0),"outdent code-block":ko(!1),"remove tab":{key:So.keys.TAB,shiftKey:!0,collapsed:!0,prefix:/\t$/,handler:function(e){this.quill.deleteText(e.index-1,1,kt.sources.USER)}},tab:{key:So.keys.TAB,handler:function(e){this.quill.history.cutoff();var t=(new a.a).retain(e.index).delete(e.length).insert("\t");this.quill.updateContents(t,kt.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(e.index+1,kt.sources.SILENT)}},"list empty enter":{key:So.keys.ENTER,collapsed:!0,format:["list"],empty:!0,handler:function(e,t){this.quill.format("list",!1,kt.sources.USER),t.format.indent&&this.quill.format("indent",!1,kt.sources.USER)}},"checklist enter":{key:So.keys.ENTER,collapsed:!0,format:{list:"checked"},handler:function(e){var t=ho(this.quill.getLine(e.index),2),n=t[0],r=t[1],o=u()({},n.formats(),{list:"checked"}),i=(new a.a).retain(e.index).insert("\n",o).retain(n.length()-r-1).retain(1,{list:"unchecked"});this.quill.updateContents(i,kt.sources.USER),this.quill.setSelection(e.index+1,kt.sources.SILENT),this.quill.scrollIntoView()}},"header enter":{key:So.keys.ENTER,collapsed:!0,format:["header"],suffix:/^$/,handler:function(e,t){var n=ho(this.quill.getLine(e.index),2),r=n[0],o=n[1],i=(new a.a).retain(e.index).insert("\n",t.format).retain(r.length()-o-1).retain(1,{header:null});this.quill.updateContents(i,kt.sources.USER),this.quill.setSelection(e.index+1,kt.sources.SILENT),this.quill.scrollIntoView()}},"list autofill":{key:" ",collapsed:!0,format:{list:!1},prefix:/^\s*?(\d+\.|-|\*|\[ ?\]|\[x\])$/,handler:function(e,t){var n,r=t.prefix.length,o=ho(this.quill.getLine(e.index),2),i=o[0],s=o[1];if(s>r)return!0;switch(t.prefix.trim()){case"[]":case"[ ]":n="unchecked";break;case"[x]":n="checked";break;case"-":case"*":n="bullet";break;default:n="ordered"}this.quill.insertText(e.index," ",kt.sources.USER),this.quill.history.cutoff();var l=(new a.a).retain(e.index-s).delete(r+1).retain(i.length()-2-s).retain(1,{list:n});this.quill.updateContents(l,kt.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(e.index-r,kt.sources.SILENT)}},"code exit":{key:So.keys.ENTER,collapsed:!0,format:["code-block"],prefix:/\n\n$/,suffix:/^\s+$/,handler:function(e){var t=ho(this.quill.getLine(e.index),2),n=t[0],r=t[1],o=(new a.a).retain(e.index+n.length()-r-2).retain(1,{"code-block":null}).delete(1);this.quill.updateContents(o,kt.sources.USER)}},"embed left":Po(So.keys.LEFT,!1),"embed left shift":Po(So.keys.LEFT,!0),"embed right":Po(So.keys.RIGHT,!1),"embed right shift":Po(So.keys.RIGHT,!0)}};var Ro=function(e,t){return(Ro=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};Object.create,Object.create,n(28);var jo,Do=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]};function Mo(e,t){return void 0===t&&(t=0),e?e.split("\n").slice(1+t,2+t).join("\n"):"<unable to get stack>"}!function(e){e[e.None=0]="None",e[e.Redux=1]="Redux",e[e.Comments=2]="Comments"}(jo||(jo={}));var Bo=Boolean,No=function e(t,n,r){var o=function(e,t,n){return new Error(e)}(t);return o.name="StructuredError",o.innerException=r,o.tag=n,Object.setPrototypeOf(o,Object.getPrototypeOf(this)),Error.captureStackTrace&&Error.captureStackTrace(o,e),o};function Lo(e){if(function(e,t){return!(!e||!(e instanceof No||void 0!==e.isStructuredError)||t&&e.name!==t)}(e))return e.stringify();if(e instanceof Error){var t=No.enableUnknownMessageLogging&&e.message?" - ".concat(e.message):"";return"".concat(e.name).concat(t,":\n").concat(No.enableStackLogging?Mo(e.stack):"")}return No.enableUnknownMessageLogging&&"string"==typeof e?e:"Unknown error"}function Fo(e){return(Fo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ho(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(l){s=!0,o=l}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Uo(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Uo(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Uo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function zo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ko(){return(Ko="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=Wo(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}}).apply(this,arguments)}function Wo(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Qo(e)););return e}function Vo(e,t){return(Vo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Go(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Qo(e);if(t){var o=Qo(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return qo(this,n)}}function qo(e,t){if(t&&("object"===Fo(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Qo(e){return(Qo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Yo(e){return e instanceof Z||e instanceof $}No.enableStackLogging=!1,No.enableMessageLogging=!1,No.enableUnknownMessageLogging=!1,No.prototype=Object.create(Error.prototype,{constructor:{value:Error,enumerable:!1,writable:!0,configurable:!0},stringify:{value:function(){return e=this.tag,t=this.stack,n=void 0,r=this.innerException,[No.enableMessageLogging&&n?n:void 0,"Tag: ".concat(e),No.enableStackLogging?t:void 0,r?"----------\nInner exception: ".concat(Lo(r)):void 0].filter(Bo).join("\n");var e,t,n,r},enumerable:!1,writable:!0,configurable:!0},isStructuredError:{value:!0,enumerable:!1,writable:!1,configurable:!1}}),Object.setPrototypeOf?Object.setPrototypeOf(No,Error):No.__proto__=Error;var Xo=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Vo(e,t)}(a,e);var t,n,r,i=Go(a);function a(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=i.call(this,e)).emitter=t.emitter,Array.isArray(t.whitelist)&&(n.whitelist=t.whitelist.reduce((function(e,t){return e[t]=!0,e}),{})),n.domNode.addEventListener("DOMNodeInserted",(function(){})),n.optimize(),n.enable(),n}return t=a,(n=[{key:"batchStart",value:function(){this.batch=!0}},{key:"batchEnd",value:function(){this.batch=!1,this.optimize()}},{key:"deleteAt",value:function(e,t){var n=Ho(this.line(e),2),r=n[0],o=n[1],i=Ho(this.line(e+t),1)[0];if(Ko(Qo(a.prototype),"deleteAt",this).call(this,e,t),null!=i&&r!==i&&o>0){if(r instanceof $||i instanceof $)return void this.optimize();if(r instanceof me){var s=r.newlineIndex(r.length(),!0);if(s>-1&&(r=r.split(s+1))===i)return void this.optimize()}else if(i instanceof me){var l=i.newlineIndex(0);l>-1&&i.split(l+1)}var c=i.children.head instanceof T?null:i.children.head;r.moveChildren(i,c),r.remove()}this.optimize()}},{key:"enable",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.domNode.setAttribute("contenteditable",e)}},{key:"formatAt",value:function(e,t,n,r){(null==this.whitelist||this.whitelist[n])&&(Ko(Qo(a.prototype),"formatAt",this).call(this,e,t,n,r),this.optimize())}},{key:"insertAt",value:function(e,t,n){if(null==n||null==this.whitelist||this.whitelist[t]){if(e>=this.length())if(null==n||null==o.a.query(t,o.a.Scope.BLOCK)){var r=o.a.create(this.statics.defaultChild);this.appendChild(r),null==n&&t.endsWith("\n")&&(t=t.slice(0,-1)),r.insertAt(0,t,n)}else{var i=o.a.create(t,n);this.appendChild(i)}else Ko(Qo(a.prototype),"insertAt",this).call(this,e,t,n);this.optimize()}}},{key:"insertBefore",value:function(e,t){if(e.statics.scope===o.a.Scope.INLINE_BLOT){var n=o.a.create(this.statics.defaultChild);n.appendChild(e),e=n}Ko(Qo(a.prototype),"insertBefore",this).call(this,e,t)}},{key:"leaf",value:function(e){return this.path(e).pop()||[null,-1]}},{key:"line",value:function(e){return e===this.length()?this.line(e-1):this.descendant(Yo,e)}},{key:"lines",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.MAX_VALUE,n=function e(t,n,r){var i=[],a=r;return t.children.forEachAt(n,r,(function(t,n,r){Yo(t)?i.push(t):t instanceof o.a.Container&&(i=i.concat(e(t,n,a))),a-=r})),i};return n(this,e,t)}},{key:"optimize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!0!==this.batch&&(Ko(Qo(a.prototype),"optimize",this).call(this,e,t),e.length>0&&this.emitter.emit(nt.events.SCROLL_OPTIMIZE,e,t))}},{key:"path",value:function(e){return Ko(Qo(a.prototype),"path",this).call(this,e).slice(1)}},{key:"update",value:function(e){if(!0!==this.batch){var t=nt.sources.USER;"string"==typeof e&&(t=e),Array.isArray(e)||(e=this.observer.takeRecords()),e.length>0&&this.emitter.emit(nt.events.SCROLL_BEFORE_UPDATE,t,e),Ko(Qo(a.prototype),"update",this).call(this,e.concat([])),e.length>0&&this.emitter.emit(nt.events.SCROLL_UPDATE,t,e)}}}])&&zo(t.prototype,n),r&&zo(t,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(o.a.Scroll);Xo.blotName="scroll",Xo.className="ql-editor",Xo.tagName="DIV",Xo.defaultChild="block",Xo.allowedChildren=[Z,$,zt];var Jo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}Ro(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(t,e),t.create=function(t){e.create.call(this,t)},t.prototype.deleteAt=function(t,n){var r,o;try{e.prototype.deleteAt.call(this,t,n)}catch(i){Do(null!==(o=null===(r=i)||void 0===r?void 0:r.message)&&void 0!==o?o:Lo(i))}},t.prototype.formatAt=function(t,n,r,o){var i,a;try{e.prototype.formatAt.call(this,t,n,r,o)}catch(s){Do(null!==(a=null===(i=s)||void 0===i?void 0:i.message)&&void 0!==a?a:Lo(s))}},t.prototype.update=function(t,n){var r,o;try{e.prototype.update.call(this,t,n)}catch(i){Do(null!==(o=null===(r=i)||void 0===r?void 0:r.message)&&void 0!==o?o:Lo(i))}},t}(Xo);kt.register({"blots/block":Z,"blots/block/embed":$,"blots/break":T,"blots/container":zt,"blots/cursor":Ee,"blots/embed":Jt,"blots/inline":H,"blots/scroll":Jo,"blots/text":k,"formats/link":Jn,"formats/color":cn,"formats/font":Rn,"formats/size":cr,"formats/background":un,"formats/bold":Tn,"formats/italic":Un,"formats/underline":Er,"formats/strike":br,"formats/script":lr,"modules/clipboard":Yr,"modules/history":uo,"modules/keyboard":So}),o.a.register(Z,T,Ee,H,Jo,k),t.default=kt}])},e.exports=r()},33107:function(e,t,n){"use strict";n.r(t),n.d(t,"QUILL_HISTORY_DELAY",(function(){return b})),n.d(t,"HYPERLINK_REGEX",(function(){return v})),n.d(t,"fixDetachedHyperlinks",(function(){return O})),n.d(t,"getQuillFromOfficeDelta",(function(){return S})),n.d(t,"getOfficeDeltaFromQuill",(function(){return P})),n.d(t,"updateCommentViewerContent",(function(){return I})),n.d(t,"initializeQuillHelper",(function(){return A})),n.d(t,"setHyperlinksClickable",(function(){return k})),n.d(t,"removeHyperlinkFormat",(function(){return w})),n.d(t,"isValidMentionChunk",(function(){return _})),n.d(t,"deltaContainsMoreThan1CharacterDeleteOperation",(function(){return R})),n.d(t,"deltaContainsInsertsAtMentionOperation",(function(){return j})),n.d(t,"deltaContainsResetAtMentionOperation",(function(){return D})),n.d(t,"setPlaceholderText",(function(){return M})),n.d(t,"extractUniqueEmailsFromDelta",(function(){return B})),n.d(t,"setPickerAriaAttributes",(function(){return N})),n.d(t,"stripDisplayTextNewLine",(function(){return L}));var r=n(562),o=n(3e4),i=n(30010),a=n(30061),s=n(33095),l=n(31186),c=n(30997),u=n(33090),d=n(33108),p=n(33109),f=n(33094),h=n(33110),m=n(33105),y=n(31038),g=n(33111);c.areHyperlinksSupportedInComments()&&m.default.register(f.HyperLink),m.default.register(d.AtMention),m.default.register(h.OfficeOptional),m.default.register("modules/clipboard",p.CommentClipboard,!0);var b=500,v=/(?:https?:\/\/|www\.)[^\s]+[\s]*$/i,C=Object(i.memoizeOnce)((function(){var e=[];return c.areHyperlinksSupportedInComments()&&e.push("hyperlink"),e.push("atmention","optional"),c.isRichTextFormattingInWebEnabled()&&e.push("bold","italic","underline","strike"),c.isHighlightsAndFontColorInWebCommentsEnabled()&&e.push("background","color"),e})),T=function(){function e(e){var t=document.createElement("div");t.id=e,t.style.display="none",document.body.appendChild(t),this.quillInstance=new m.default("#".concat(e),{formats:C(),modules:{clipboard:{isAtmentionSupported:!0}}})}return e.prototype.getQuill=function(){return this.quillInstance},e}();function O(e){for(var t,n,o,i=void 0,a=e.ops.length-1;a>=0;a--){var s=e.ops[a];i&&(void 0===(null===(t=null==s?void 0:s.attributes)||void 0===t?void 0:t.link)&&(s.attributes=Object(r.__assign)(Object(r.__assign)({},s.attributes),{link:i})),i=void 0),0===s.insert.length&&(null===(n=null==s?void 0:s.attributes)||void 0===n?void 0:n.link)&&(i=null===(o=null==s?void 0:s.attributes)||void 0===o?void 0:o.link,e.ops.splice(a,1))}}function S(e){var t=l.IsDemo?Object(a.getTelemetryAPI)().createActivityObject("GetQuillFromOfficeDelta",Object(a.globalTelemetryVisitor)(a.GlobalTelemetryReason.GlobalAPI),a.ActivityAggregationMode.None,a.ActivityDiagnosticLevel.NecessaryServiceDataEvent):void 0,n=JSON.parse(e);c.isFixDetachedHyperlinksWebEnabled()&&O(n);var r={},i=c.isRichTextFormattingInWebEnabled(),s=n.ops.map((function(e){if(void 0!==e.insert){var n={};if(n.insert=e.insert,e.attributes){if(n.attributes=e.attributes,n.attributes.atmention&&(n.attributes.atmention=JSON.stringify(e.attributes.atmention)),n.attributes.link&&c.areHyperlinksSupportedInComments()&&(n.attributes.hyperlink=JSON.stringify({url:e.attributes.link}),delete n.attributes.link),c.areHyperlinksSupportedInComments()||delete n.attributes.link,n.attributes.weight){if(i&&!n.attributes.atmention){var r=parseInt(n.attributes.weight,10);Object(a.getTelemetryAPI)().assertConditionTag(r>=700,"weight attribute less than 700.",591192854),n.attributes.bold=r>=700}else Object(a.getTelemetryAPI)().assertConditionTag(i,"Weight attribute present when rich text feature gate is off",591192855);delete n.attributes.weight}n.attributes.strikethrough&&(i&&!n.attributes.atmention?n.attributes.strike=n.attributes.strikethrough:Object(a.getTelemetryAPI)().assertConditionTag(i,"strikethrough attribute present when rich text feature gate is off",591192856),delete n.attributes.strikethrough),n.attributes.italic&&n.attributes.atmention&&delete n.attributes.italic,n.attributes.underline&&n.attributes.atmention&&delete n.attributes.underline,n.attributes.highlight&&(c.isHighlightsAndFontColorInWebCommentsEnabled()&&!n.attributes.atmention&&(n.attributes.background=n.attributes.highlight),delete n.attributes.highlight),n.attributes.color&&n.attributes.atmention&&delete n.attributes.color}return e.optional&&(n.attributes||(n.attributes={}),n.attributes.optional=JSON.stringify(e.optional)),n}return t&&t.failTag(595194440,-2130957543),Object(a.getTelemetryAPI)().assertConditionTag(!1,"Translation Error: op in office delta is not insert. Inserting empty insert.",o.TelemetryTag.reserveTag(595194441)),{insert:""}}));return t&&t.successTag(595194442),s.length?(r.ops=s,JSON.stringify(r)):JSON.stringify(new m.Delta)}function P(e){var t=l.IsDemo?Object(a.getTelemetryAPI)().createActivityObject("GetOfficeDeltaFromQuill",Object(a.globalTelemetryVisitor)(a.GlobalTelemetryReason.GlobalAPI),a.ActivityAggregationMode.None,a.ActivityDiagnosticLevel.NecessaryServiceDataEvent):void 0,n=JSON.parse(e);Object(o.verifyElseThrow)(n.ops,"Quill operations must be defined.",o.TelemetryTag.reserveTag(562937944));var r={ops:[]},i=n.ops.map((function(e){if(void 0!==e.insert){var n={insert:e.insert};return e.attributes&&(e.attributes.optional&&("string"==typeof e.attributes.optional?n.optional=JSON.parse(e.attributes.optional):n.optional=e.attributes.optional),n.attributes={},e.attributes.atmention&&("string"==typeof e.attributes.atmention?n.attributes.atmention=JSON.parse(e.attributes.atmention):n.attributes.atmention=e.attributes.atmention),c.areHyperlinksSupportedInComments()&&e.attributes.hyperlink&&("string"==typeof e.attributes.hyperlink?n.attributes.link=JSON.parse(e.attributes.hyperlink).url:n.attributes.link=e.attributes.hyperlink.url),c.isRichTextFormattingInWebEnabled()&&!e.attributes.atmention&&(e.attributes.bold&&(n.attributes.weight=700),e.attributes.strike&&(n.attributes.strikethrough=e.attributes.strike),e.attributes.italic&&(n.attributes.italic=e.attributes.italic),e.attributes.underline&&(n.attributes.underline=e.attributes.underline)),c.isHighlightsAndFontColorInWebCommentsEnabled()&&!e.attributes.atmention&&(e.attributes.background&&(n.attributes.highlight=e.attributes.background),e.attributes.color&&(n.attributes.color=e.attributes.color))),n}return t&&t.failTag(595194443,-2130957544),Object(a.getTelemetryAPI)().assertConditionTag(!1,"Translation Error: op in quill delta is not insert. Inserting empty insert operation.",o.TelemetryTag.reserveTag(595194444)),{insert:""}}));return i.length?(r.ops=i,c.isFixDetachedHyperlinksWebEnabled()&&O(r),t&&t.successTag(595194445),JSON.stringify(r)):(t&&t.failTag(595194446,-2130957544),Object(a.getTelemetryAPI)().assertConditionTag(!1,"Translation Error: Quill Delta should never have an empty operation",o.TelemetryTag.reserveTag(595194447)),JSON.stringify(new m.Delta))}var x=void 0;function I(e,t,n){var r=(x||((x=new T("CommentsDisplayTextTranslationQuill").getQuill()).disable(),x.root.setAttribute("role","document"),c.isA11yFastPastFixesEnabed()||x.root.setAttribute("aria-readonly","true")),x);if(n){var o=S(n);r.setContents(JSON.parse(o),"api")}Object(a.getTelemetryAPI)().assertConditionTag(!!r.root,"root element on Quill is undefined",559491102);var i=r.root.cloneNode(!0);i.addEventListener("click",E),r.setText(""),i?(t.firstChild?t.replaceChild(i,t.firstChild):t.appendChild(i),t.firstElementChild&&t.firstElementChild.setAttribute("id",e)):Object(a.getTelemetryAPI)().assertConditionTag(!1,"Clone of Quill root node should be defined",595658959)}function E(e){var t=e.target;Object(f.shouldNavigateOnHyperlinkClick)(t)&&(Object(a.getTelemetryAPI)().createActivityObject("PostedHyperlinkClicked",Object(a.globalTelemetryVisitor)(a.GlobalTelemetryReason.GlobalAPI),a.ActivityAggregationMode.OnSuccess,a.ActivityDiagnosticLevel.NecessaryServiceDataEvent).successTag(562438279),Object(s.getRichContentEditAPIInstance)().onHyperlinkClick(t.href)&&e.preventDefault())}function A(e,t,n,i){var s="#".concat(Object(y.getEditorFocusContainerId)(e.id)),l=[];c.areHyperlinksSupportedInComments()&&l.push(Object(g.getAnchorTagMatcher)()),c.isRichTextFormattingInWebEnabled()&&l.push(Object(g.getTextDecorationCSSNodeMatcher)());var d={formats:C(),scrollingContainer:i,modules:Object(r.__assign)(Object(r.__assign)({},t),{clipboard:{isAtmentionSupported:Object(u.hasMentionableEditorProps)(e),matchers:l.length>0?l:void 0}})};e.placeholder&&(d.placeholder=e.placeholder);var p=new m.default(s,d);if(function(e,t,n,r,o){var i=e.root;if(!i)return void Object(a.getTelemetryAPI)().assertConditionTag(!1,"root element on Quill is undefined",595891799);i.spellcheck=!0,e.history.options.delay=b,i.id=t,i.setAttribute("aria-haspopup","true"),i.setAttribute("role","textbox"),c.isA11yFastPastFixesEnabed()||i.setAttribute("aria-readonly","false");n&&i.setAttribute("aria-describedby",n);c.shouldUseNewSelectionInteractions()&&!o&&i.setAttribute("tabindex","-1");c.isAriaPlaceholderForCommentEditorWebEnabled()&&r&&i.setAttribute("aria-placeholder",r);var s=e.clipboard&&e.clipboard.container;s&&s.setAttribute("aria-hidden","true")}(p,e.id,e.accessibilityDescribedBy,e.accessibilityLabel,e.isTabbable),e.defaultValue){var f=S(e.defaultValue);p.setContents(JSON.parse(f),"api")}return p.enable(),p.on("text-change",(function(e,t,r){if(Object(a.getTelemetryAPI)().assertConditionTag(!!p.root,"root element on Quill is undefined",559491103),p.root&&""===p.root.textContent&&j(t)){var i=window.getSelection(),s=i&&i.anchorNode?i.anchorNode.parentNode:null,l=m.Parchment.find(s);l&&"scroll"===l.statics.blotName&&Object(a.getTelemetryAPI)().assertConditionTag(!1,"Quill editor crash in Chrome/Edge/Safari, unable to complete replace operation",589084383)}n(e,t,r),c.areHyperlinksSupportedInComments()&&function(e,t){if(Object(o.verifyElseThrow)(t.ops,"ops should always be definied when parsing for hyperlinks.",o.TelemetryTag.reserveTag(562937945)),2===t.ops.length&&t.ops[1].insert&&t.ops[1].attributes&&t.ops[1].attributes.hyperlink){var n=window.getSelection(),r=n&&n.anchorNode?n.anchorNode.parentNode:null;if(!r)return;var i=m.Parchment.find(r);if(!i)return;w(e,i.offset(e.scroll),i.length())}if(2===t.ops.length&&t.ops[0].retain&&(d=t.ops[1].insert,/\s/.test(d))){var a=t.ops[0].retain,s=e.getText().substr(0,a).match(v);if(!s)return;var l=s[0],c=s[0].trimRight(),u=[];a>l.length&&u.push({retain:a-l.length}),u.push({retain:c.length,attributes:{hyperlink:JSON.stringify({url:c,editable:!0})}}),1===u.length&&u[0].retain?w(e,0,u[0].retain):2===u.length&&u[0].retain&&u[1].retain&&w(e,u[0].retain,u[1].retain),e.updateContents(new m.Delta(u))}var d}(p,e)})),p}function k(e,t){if(e&&c.areHyperlinksSupportedInComments())for(var n=e.getElementsByClassName(f.HyperLink.className),r=0;r<n.length;r++)n[r].setAttribute("contenteditable",t?"false":"true")}function w(e,t,n){e.formatText(t,n,f.HyperLink.blotName,!1)}function _(e,t){var n=t.trim().split(" "),r=e.trim().split(" ");return n.every((function(e){return r.indexOf(e)>=0}))}function R(e){var t=!1;return e.forEach((function(e){t=!!e.delete&&e.delete.valueOf()>1})),t}function j(e){var t=!1;return e.forEach((function(e){t||(t=e.insert&&e.attributes&&e.attributes.atmention)})),t}function D(e){var t=!1;return e.forEach((function(e){t||(t=!!e.retain&&!!e.attributes&&null===e.attributes.atmention)})),t}function M(e,t){var n=document.getElementById(e);n&&(n.setAttribute("data-placeholder",t),n.setAttribute("aria-placeholder",t))}function B(e){var t=new Set;return e&&e.ops&&e.ops.forEach((function(e){if(e.attributes){var n=void 0;if("string"==typeof e.attributes.atmention)try{n=JSON.parse(e.attributes.atmention)}catch(r){return void Object(a.getTelemetryAPI)().assertConditionTag(!1,"Failed to parse atmention attributes",594921041)}else n=e.attributes.atmention;n&&t.add(n.email)}})),t}function N(e,t){t?(e.setAttribute("aria-autocomplete",t["aria-autocomplete"]),e.setAttribute("aria-haspopup",t["aria-haspopup"]),e.setAttribute("aria-owns",t["aria-owns"]),e.setAttribute("aria-controls",t["aria-controls"]),c.isA11yFastPastFixesEnabed()||e.setAttribute("aria-expanded",t["aria-expanded"])):(e.removeAttribute("aria-autocomplete"),e.removeAttribute("aria-haspopup"),e.removeAttribute("aria-owns"),e.removeAttribute("aria-controls"),c.isA11yFastPastFixesEnabed()||e.removeAttribute("aria-expanded"))}function L(e){e.querySelectorAll("a").forEach((function(e){e.text=e.text.replace("\n"," ")}))}},33108:function(e,t,n){"use strict";n.r(t),n.d(t,"AtMention",(function(){return o}));var r=n(562),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.create=function(n){var r=e.create.call(this,n);return r.setAttribute("class","atmention"),r.setAttribute(t.getDataAttributeName(),n),r.setAttribute("tabIndex","-1"),r.setAttribute("disabled","disabled"),r.setAttribute("spellcheck","false"),r},t.formats=function(e){return e.getAttribute(t.getDataAttributeName())||void 0},t.prototype.format=function(n,r){"atmention"===n&&r?this.domNode.setAttribute(t.getDataAttributeName(),r):e.prototype.format.call(this,n,r)},t.prototype.formats=function(){var n=e.prototype.formats.call(this);return n.atmention=t.formats(this.domNode),n},t.getDataAttributeName=function(){return"data-".concat(t.blotName)},t.blotName="atmention",t.tagName="A",t}(n(33105).QuillInlineBlot)},33109:function(e,t,n){"use strict";n.r(t),n.d(t,"CommentClipboard",(function(){return l}));var r=n(562),o=n(30061),i=n(30997),a=n(33107),s=n(33105),l=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.getClipboardDataUsingOtherTextMIMETypes=function(e,t){return t||e.getData("text")||e.getData("text/plain")},r.isAtmentionSupported=n.isAtmentionSupported,r.removeAtFormat=r.removeAtFormat.bind(r),r.pasteMentionHandler=r.pasteMentionHandler.bind(r),r}return Object(r.__extends)(t,e),t.prototype.removeAtFormat=function(e,t){this.quill.formatText(e,t,"optional",!1),this.quill.formatText(e,t,"atmention",!1)},t.prototype.pasteMentionHandler=function(){var e=window.getSelection(),t=e&&e.anchorNode?e.anchorNode.parentNode:null,n=e&&e.focusNode?e.focusNode.parentNode:null,r=s.Parchment.find(t),o=t===n?void 0:s.Parchment.find(n);return r&&"atmention"===r.statics.blotName&&this.removeAtFormat(r.offset(this.quill.scroll),r.length()),o&&"atmention"===o.statics.blotName&&this.removeAtFormat(o.offset(this.quill.scroll),o.length()),!0},t.prototype.onPaste=function(e){var n,r=this,l=this.quill.getText(),c=e.clipboardData||window.clipboardData;if(c)try{n=this.getClipboardDataUsingOtherTextMIMETypes(c,c.getData("text/html"))}catch(m){n=this.getClipboardDataUsingOtherTextMIMETypes(c,"")}if(!e.defaultPrevented&&this.quill.isEnabled())try{t.pasteOperationInProgress=!0,this.pasteMentionHandler();var u=this.quill.getSelection(),d=(new s.Delta).retain(u.index),p=this.quill.scrollingContainer.scrollTop;this.container.focus();var f=document.createRange(),h=window.getSelection();f.setStart(this.container,0),f.collapse(!0),h&&(Object(o.getTelemetryAPI)().assertConditionTag(!!h,"Expected a selection!",595854800),h.removeAllRanges(),h.addRange(f)),this.quill.selection.update("silent"),setTimeout((function(){try{if(!(r.quill.getText()!==l)&&0===r.container.childNodes.length&&n){var e=f.createContextualFragment(n);i.isFixOutlookHyperlinkPastingEnabled()&&Object(a.stripDisplayTextNewLine)(e),r.container.appendChild(e)}d=d.concat(r.convert()).delete(u.length),d=r.isAtmentionSupported?new s.Delta(d.map((function(e){return e.insert&&(e.attributes&&e.attributes.optional&&delete e.attributes.optional,!e.attributes||!e.attributes.atmention||Object(a.isValidMentionChunk)(JSON.parse(e.attributes.atmention).fullName,e.insert.slice(1))&&"UnknownEmail"!==JSON.parse(e.attributes.atmention).email||delete e.attributes.atmention),e}))):new s.Delta(d.map((function(e){return e.insert&&e.attributes&&delete e.attributes.atmention,e}))),r.quill.updateContents(d,"user"),r.quill.setSelection(d.length()-u.length,i.isRichContentEditIntegrationInWebEnabled()?"api":"silent"),r.quill.scrollingContainer.scrollTop=p,r.quill.focus()}catch(m){Object(o.getTelemetryAPI)().assertConditionTag(!1,"CommentClipboard paste delta scrubbing failed.",593035297)}finally{t.pasteOperationInProgress=!1}}),1)}catch(m){Object(o.getTelemetryAPI)().assertConditionTag(!1,"CommentClipboard preparation for paste failed.",593035298),t.pasteOperationInProgress=!1}},t.pasteOperationInProgress=!1,t}(s.QuillClipBoard)},33110:function(e,t,n){"use strict";n.r(t),n.d(t,"OfficeOptional",(function(){return i}));var r=n(562),o=n(30997),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.create=function(n){var r=e.create.call(this,n);r.setAttribute(t.getDataAttributeName(),n);var o="string"==typeof n?JSON.parse(n):n;return(o&&o.atmention&&o.atmention.isCurrentUser||o.isCurrentUser)&&r.setAttribute("class","current-user"),r},t.formats=function(e){return e.getAttribute(t.getDataAttributeName())||void 0},t.prototype.format=function(n,r){n===t.blotName&&r?this.domNode.setAttribute(t.getDataAttributeName(),r):e.prototype.format.call(this,n,r)},t.prototype.formats=function(){var n=e.prototype.formats.call(this);return n[t.blotName]=t.formats(this.domNode),n},t.getDataAttributeName=function(){return"data-".concat(t.blotName)},t.blotName="optional",t.tagName=o.isRichTextFormattingInWebEnabled()?"OFFICE-OPTIONAL":"SPAN",t}(n(33105).QuillInlineBlot)},33111:function(e,t,n){"use strict";n.r(t),n.d(t,"getTextDecorationCSSNodeMatcher",(function(){return l})),n.d(t,"getAnchorTagMatcher",(function(){return c}));var r=n(562),o=n(30061),i=n(30997),a=n(33094),s=n(33105);function l(){return['[style*="text-decoration"]',u]}function c(){return["a",d]}function u(e,t){var n,o=null===(n=window.getComputedStyle(e))||void 0===n?void 0:n.textDecoration,i=void 0;return o&&(o.indexOf("underline")>-1&&(i={underline:!0}),o.indexOf("line-through")>-1&&(i=Object(r.__assign)(Object(r.__assign)({},i),{strike:!0})),i)?t.compose((new s.Delta).retain(t.length(),i)):t}function d(e,t){var n,r=e;if(t.ops&&(null===(n=t.ops[0].attributes)||void 0===n?void 0:n.atmention))return t;var l=a.HyperLink.formats(r);if(l&&r.text){if(Object(o.getTelemetryAPI)().createActivityObject("HyperlinkPasted",Object(o.globalTelemetryVisitor)(o.GlobalTelemetryReason.GlobalAPI),o.ActivityAggregationMode.OnSuccess,o.ActivityDiagnosticLevel.NecessaryServiceDataEvent).successTag(589894537),!i.isHyperlinksWithDisplayTextEnabled()){var c=JSON.parse(l),u=null==c?void 0:c.url;return u&&u===r.text?i.isRichTextFormattingInWebEnabled()?t.compose((new s.Delta).retain(t.length(),{hyperlink:l})):new s.Delta([{insert:r.text,attributes:{hyperlink:l}}]):u?new s.Delta([{insert:u,attributes:{hyperlink:l}}]):new s.Delta([{insert:r.text}])}return i.isRichTextFormattingInWebEnabled()?t.compose((new s.Delta).retain(t.length(),{hyperlink:l})):new s.Delta([{insert:r.text,attributes:{hyperlink:l}}])}return t}},33112:function(e,t,n){"use strict";n.r(t),n.d(t,"ContextualizedWrapperComponentKey",(function(){return a})),n.d(t,"wrapContextualizedComponent",(function(){return s}));var r=n(562),o=n(30061),i=n(245),a="ContextualizedWrapperComponent";function s(e,t,n){var s=function(n){function a(){var a=null!==n&&n.apply(this,arguments)||this;return a.allContextContents={},a.keys=Object.keys(t),a.renderFunction=a.keys.reduceRight((function(n,o){return function(s,l){var c=t[o];return i.createElement(c.Consumer,null,(function(t){return a.allContextContents[o]=t,null===n?i.createElement(e,Object(r.__assign)({ref:s},l,a.allContextContents)):n(s,l)}))}}),null),a.render=function(){var t=a.props,n=t.forwardedRef,s=Object(r.__rest)(t,["forwardedRef"]);return a.renderFunction?a.renderFunction(n,s):(Object(o.getTelemetryAPI)().assertConditionTag(!1,"Contexts failed to wrap, default to null.",558724946),i.createElement(e,Object(r.__assign)({},s,{ref:n},a.allContextContents)))},a}return Object(r.__extends)(a,n),a}(i.Component),l=i.forwardRef((function(e,t){return i.createElement(s,Object(r.__assign)({key:a,forwardedRef:t},e))}));return l.displayName=n,l}},33113:function(e,t,n){"use strict";n.r(t),n.d(t,"BasicCommentEditor",(function(){return _}));var r=n(562),o=n(3e4),i=n(30010),a=n(30061),s=n(30123),l=n(31159),c=n(32983),u=n(245),d=n(32926),p=n(31041),f=n(30988),h=n(30989),m=n(30997),y=n(31415),g=n(33114),b=n(31040),v=n(33115),C=n(32927),T=n(31038),O=n(32933),S=n(33116),P=n(33107),x=n(33117),I=n(33093),E=n(33109),A=n(33118),k=n(33092),w=n(33119),_=function(e){function t(t){var n=e.call(this,t)||this;return n.editorContainerRef=u.createRef(),n.editorRef=null,n.smartReplyPickerRef=u.createRef(),n.isRestoreInProgress=!1,n.selectedSmartReply=void 0,n.smartReplyEditHistory=v.default.NoEdits,n.isQuillCursorPositionSet=!1,n.lastKnownCursorIndex=void 0,n.getStyles=function(e){return m.isWebThemeIntegrationEnabled()?k.getStyles(m.isTruncationUIWithReadMoreTextEnabled(),n.props.useReplyBoxStyling,n.props.isHeightBounded,void 0,void 0,n.shouldHideMentionColors(),null==e?void 0:e.colors,null==e?void 0:e.styles):k.getStyles(m.isTruncationUIWithReadMoreTextEnabled())},n.setUpEditor=function(){var e,t;null===(t=(e=n.props).onMount)||void 0===t||t.call(e),n.initializeQuill(),n.restoreDraftIfExists(),n.props.componentRef(n),m.areSmartRepliesEnabled()&&n.handleShowSmartReplyPicker(),Object(P.setHyperlinksClickable)(n.editorRef,!1)},n.onEditorContainerMutation=function(e,t){if(n.getEditorFocusContainerDiv()){var r=Object(a.getTelemetryAPI)().createActivityObject("DelayedQuillInitialization",Object(a.globalTelemetryVisitor)(a.GlobalTelemetryReason.ReviewedAsNotNecessary),a.ActivityAggregationMode.None,a.ActivityDiagnosticLevel.NecessaryServiceDataEvent);try{n.setUpEditor()}catch(o){throw r.failTag(556127642,-2130957487),o}r.successTag(556127643),t.disconnect()}},n.logQuillInitializationFailure=function(e){var t;if(m.isQuillInitializationTelemetryEnabled()){var r=null!==(t=n.props.commentId)&&void 0!==t?t:"";if(r){var i=n.props.renderContextType;n.isCommentRootInDOM(r)?Object(a.getTelemetryAPI)().assertConditionTag(!1,"Quill initialization failed RenderContextType ".concat(i,". The post or card root is present. Callstack: ").concat(e.stack),556856596):(i!==b.default.FullPane||document.getElementById(Object(T.getFirstPaneElementId)())||Object(a.getTelemetryAPI)().assertConditionTag(!1,"Quill initialization failed. The pane root is expected to be visible but cannot be found.",556565443),Object(a.getTelemetryAPI)().assertConditionTag(!1,"Quill initialization failed with RenderContextType ".concat(i,". The post or card root cannot be found. Callstack: ").concat(e.stack),556856595))}else{Object(p.makeAssertErrorHandler)(o.TelemetryTag.reserveTag(556856594))(e)}}},n.isCommentRootInDOM=function(e){var t={id:e,renderContextType:n.props.renderContextType},r=document.getElementById(Object(T.getCardRootId)(t,!1)),o=document.getElementById(Object(T.getCardRootId)(t,!0)),i=document.getElementById(Object(T.getPostRootId)(t));return!!r||!!o||!!i},n.selectionChangeHandler=function(){n.myQuill&&(n.isQuillCursorPositionSet=n.myQuill.hasFocus(),n.isQuillCursorPositionSet&&m.isRichContentEditIntegrationInWebEnabled()&&Object(w.getCommentRichContentEditingActor)().onSelectionChange(n.myQuill))},n.selectionChangeHandler_deprecated=function(){var e;(null===(e=n.myQuill)||void 0===e?void 0:e.hasFocus())&&Object(w.getCommentRichContentEditingActor)().onSelectionChange(n.myQuill)},n.isInAtMentionMode=function(){return!1},n.getEditorFocusContainerDiv=function(){return document.getElementById(Object(T.getEditorFocusContainerId)(n.props.id))},n.isSmartReplyPickerDisplayed=function(){var e;return!!(null===(e=n.smartReplyPickerRef.current)||void 0===e?void 0:e.isSuggestionsShown)},n.renderWithContexts=function(e){n.styles=n.getStyles(e);var t=m.isWebThemeIntegrationEnabled()?n.styles.EditorContainerEditing:n.getEditorClass_deprecated(),r=n.props.smartReplyProps?n.renderSmartReplyPicker():null,o=m.areSmartRepliesEnabled()?n.editorContainerRef:void 0;return u.createElement("div",{className:t,id:Object(T.getEditorRootDivId)(n.props.id),ref:o},u.createElement("div",{tabIndex:-1,ref:n.setEditorRef,className:n.styles.InnerEditorDisableFocusOutline,id:Object(T.getEditorFocusContainerId)(n.props.id),onKeyDown:n.onKeyDownHandler,onKeyUp:n.onKeyUpHandler,onKeyPress:n.onKeyPressHandler,onFocus:n.onFocusHandler,onBlur:n.onBlurHandler}),n.renderAdditionalEditorContent(),r)},n.onFocusHandler=n.onFocusHandler.bind(n),n.onKeyDownHandler=n.onKeyDownHandler.bind(n),n.onKeyUpHandler=n.onKeyUpHandler.bind(n),n.onKeyPressHandler=n.onKeyPressHandler.bind(n),n.onTextChangedHandler=n.onTextChangedHandler.bind(n),n.deleteHandler=n.deleteHandler.bind(n),n.removeAtFormat=n.removeAtFormat.bind(n),n.tabKeyHandler=n.tabKeyHandler.bind(n),n.onBlurHandler=n.onBlurHandler.bind(n),n.setEditorRef=n.setEditorRef.bind(n),n.enterNewline=n.enterNewline.bind(n),n.handleEscapeKeys=n.handleEscapeKeys.bind(n),n.handleShowSmartReplyPicker=n.handleShowSmartReplyPicker.bind(n),n.handleSmartReplySelection=n.handleSmartReplySelection.bind(n),n.onSmartRepliesShown=n.onSmartRepliesShown.bind(n),n.onSmartRepliesHidden=n.onSmartRepliesHidden.bind(n),n.toggleSmartReplyAriaAttributes=n.toggleSmartReplyAriaAttributes.bind(n),n.onResolveSmartReplySuggestions=n.onResolveSmartReplySuggestions.bind(n),n.renderSmartReply=n.renderSmartReply.bind(n),n.renderSmartReplyPicker=n.renderSmartReplyPicker.bind(n),n.getKeyboardBindings=n.getKeyboardBindings.bind(n),n}return Object(r.__extends)(t,e),t.prototype.componentDidUpdate=function(e,t){var n,r,o,i=this.getEditorFocusContainerDiv();if(i){var s=this.getFirstQuillEditor(i);s?(this.props.accessibilityLabel&&s.setAttribute("aria-label",this.props.accessibilityLabel.toString()),this.props.accessibilityDescribedBy&&s.setAttribute("aria-describedby",this.props.accessibilityDescribedBy.toString()),s.setAttribute("aria-readonly","false"),m.shouldUseNewSelectionInteractions()&&(this.props.isTabbable?s.removeAttribute("tabindex"):s.setAttribute("tabindex","-1"))):Object(a.getTelemetryAPI)().assertConditionTag(!1,"quillEditorDiv missing in CommentEditor",588805504)}!e.initialDraftContent&&this.isEditorEmpty()&&this.restoreDraftIfExists();var l=this.props.placeholder;(l&&e.placeholder!==l&&Object(P.setPlaceholderText)(this.props.id,l),m.areSmartRepliesEnabled())&&((null!==(r=null===(n=this.props.smartReplyProps)||void 0===n?void 0:n.smartReplies)&&void 0!==r?r:[])!==(null===(o=e.smartReplyProps)||void 0===o?void 0:o.smartReplies)&&(this.selectedSmartReply=void 0,this.handleShowSmartReplyPicker()))},t.prototype.componentDidMount=function(){if(!this.getEditorFocusContainerDiv())return this.editorContainerMutationObserver=new MutationObserver(this.onEditorContainerMutation),void this.editorContainerMutationObserver.observe(document.body,{childList:!0,subtree:!0});this.setUpEditor()},t.prototype.componentWillUnmount=function(){var e,t;null===(t=(e=this.props).onUnmount)||void 0===t||t.call(e)},t.prototype.toggleSmartReplyAriaAttributes=function(e){if(!this.isInAtMentionMode()){var t=this.getQuillEditorFromFocusContainerDiv();t&&Object(P.setPickerAriaAttributes)(t,Object(S.getPickerAriaAttributes)(e,g.default.SmartReply))}},t.prototype.logSmartReplyPostEditActivity=function(){var e=Object(a.getTelemetryAPI)().createActivityObject("SmartReplyPosted",Object(a.globalTelemetryVisitor)(a.GlobalTelemetryReason.ReviewedAsNotNecessary),a.ActivityAggregationMode.None,a.ActivityDiagnosticLevel.BasicEvent);this.smartReplyEditHistory!==v.default.EditTypeUnknown&&(e.addDataField("PostEditedType",this.smartReplyEditHistory,a.DataFieldClassification.SystemMetadata),this.props.commentId&&e.addDataField("CommentId",this.props.commentId,a.DataFieldClassification.SystemMetadata),e.successTag(587818312))},t.prototype.onTextChangedHandler=function(e,t,n){var r,i,a,s=this;if(Object(o.verifyElseThrow)(this.myQuill,"Quill should always be defined on text changed handlers.",o.TelemetryTag.reserveTag(576583245)),m.areSmartRepliesEnabled()&&this.handleShowSmartReplyPicker(),"user"===n&&!this.myQuill.history.ignoreChange)if(Object(P.deltaContainsMoreThan1CharacterDeleteOperation)(e)){var l=this.myQuill.getContents(),c=0;l.forEach((function(e){e.attributes&&e.attributes.atmention&&(Object(P.isValidMentionChunk)(JSON.parse(e.attributes.atmention).fullName,e.insert.slice(1))||s.removeAtFormat(c,e.insert.length)),c+=e.insert.length}))}else{var u=window.getSelection(),d=u&&u.anchorNode?u.anchorNode.parentNode:null,p=I.Parchment.find(d);setTimeout((function(){if(s.myQuill){var t=s.myQuill.getSelection();if(p&&"atmention"===p.statics.blotName){var n=p.offset(s.myQuill.scroll);if(t.index===n+1)s.removeAtFormat(n,1);else if(t.index<n+p.length()&&t.index>n)s.removeAtFormat(n,p.length());else if(t.index===n+p.length()){e.filter((function(e){return"string"==typeof e.insert})).length&&s.removeAtFormat(t.index-1,1)}}}}),0)}var f=this.isEditorEmpty();this.props.isDraftEmpty!==f&&(null===(i=(r=this.props).onDraftEmptinessChanged)||void 0===i||i.call(r,f)),m.areSmartRepliesEnabled()&&this.selectedSmartReply&&(this.smartReplyEditHistory=Object(x.getSmartReplyPostEditType)(this.smartReplyEditHistory,e,null!==(a=this.selectedSmartReply)&&void 0!==a?a:"",this.myQuill.getContents()))},t.prototype.getFirstQuillEditor=function(e){var t=e.getElementsByClassName("ql-editor");return t.length>0?t[0]:void 0},t.prototype.getQuillEditorFromFocusContainerDiv=function(){var e=this.getEditorFocusContainerDiv();return e?this.getFirstQuillEditor(e):void 0},t.prototype.restoreDraftIfExists=function(){var e=this,t=this.props.initialDraftContent;if(t){this.isRestoreInProgress=!0;var n=t.editorCursorPosition,i=t.editorContent;n||(Object(a.getTelemetryAPI)().assertConditionTag(!1,"Cursor position promise should be defined on Web, defaulting to resolve(undefined).",588805505),n=Promise.resolve(void 0)),Promise.all([i,n]).then((function(t){var n=Object(r.__read)(t,2),o=n[0],i=n[1];o&&(e.setContents(o,i),e.isRestoreInProgress=!1)})).catch(Object(p.makeAssertErrorHandler)(o.TelemetryTag.reserveTag(588805506)))}},t.prototype.setEditorRef=function(e){this.editorRef=e,m.isRichContentEditIntegrationInWebEnabled()&&(this.editorRef?Object(w.getCommentRichContentEditingActor)().setActiveEditorInfo({editorContainer:e}):Object(w.getCommentRichContentEditingActor)().resetActiveEditorInfo())},t.prototype.removeAtFormat=function(e,t){Object(o.verifyElseThrow)(this.myQuill,"Quill should be defined when removing format.",o.TelemetryTag.reserveTag(576583246));try{this.myQuill.formatText(e,t,{optional:!1,atmention:!1})}catch(n){Object(a.getTelemetryAPI)().assertCondition(n instanceof Error,"Missing catch details due to unhandled error type?"),n instanceof Error&&("NotFoundError"===n.message?(Object(a.getTelemetryAPI)().assertConditionTag(!1,"Error removing At Format",588805508),this.clear()):n.message.indexOf("mutations")>-1&&(Object(a.getTelemetryAPI)().assertConditionTag(!1,"Threw error cannot find property mutations of undefined",588649689),0===e&&this.myQuill.formatText(e,1,{optional:!1,atmention:!1})))}},t.prototype.getChunkBoundaryForDelete=function(e,t,n,r){Object(o.verifyElseThrow)(this.myQuill,"Quill should be defined when processing blots.",o.TelemetryTag.reserveTag(576583247));var i=this.myQuill.getText(n.index,1),a=this.myQuill.getText(n.index-1,1),s=this.myQuill.getText(n.index,n.length),l=-1,c=-1,u=0===n.length,d=u&&" "===a,p=u&&" "===i||!this.myQuill.getFormat(n.index,1).atmention;if(""!==s&&n.index+n.length<=e+t.length||!p&&!d){if(""!==s&&s.indexOf(" ")>=0)return;return l=t.lastIndexOf(" ",n.index-e-1),c=t.indexOf(" ",n.index-e),{chunkStart:l<0?c<0?e:e+1:l+e,chunkEnd:c<0?e+t.length-1:l<0?c+e:c+e-1}}if(u){if(p)return r?(c=t.indexOf(" ",n.index-e+1),{chunkStart:n.index,chunkEnd:c<0?e+t.length-1:c+e}):(l=t.lastIndexOf(" ",n.index-e-1),c=t.indexOf(" ",n.index-e),{chunkStart:l<0?c<0?e:e+1:l+e,chunkEnd:l<0&&" "===i?n.index:n.index-1});if(d)return r?(c=t.indexOf(" ",n.index-e),{chunkStart:n.index-1,chunkEnd:c<0?e+t.length-1:c+e}):{chunkStart:(l=t.lastIndexOf(" ",n.index-e-2))<0?e+1:l+e+1,chunkEnd:n.index-1}}},t.prototype.deleteHandler=function(e){Object(o.verifyElseThrow)(this.myQuill,"Quill must be defined in delete handler",o.TelemetryTag.reserveTag(576583248));var t=window.getSelection(),n=t&&t.anchorNode?t.anchorNode.parentNode:null,r=t&&t.focusNode?t.focusNode.parentNode:null,i={startBlot:I.Parchment.find(n),endBlot:n===r?void 0:I.Parchment.find(r)},s=t&&t.anchorNode?I.Parchment.find(t.anchorNode.previousSibling):null;if(s&&"atmention"===s.statics.blotName&&t&&0===t.anchorOffset&&(i.startBlot=s),m.areHyperlinksSupportedInComments()&&i.startBlot&&i.startBlot.statics.blotName===I.HyperLink.blotName){if(t&&"Caret"===t.type&&t.anchorNode&&t.anchorNode.textContent&&t.anchorOffset===t.anchorNode.textContent.length){var l=this.myQuill.getSelection();if(!l)return!0;var c=t.anchorNode.textContent.length,u=l.index;return this.myQuill.formatText(u-c,c,{optional:!1,hyperlink:!1}),!1}Object(P.removeHyperlinkFormat)(this.myQuill,i.startBlot.offset(this.myQuill.scroll),i.startBlot.length()),i.endBlot&&i.endBlot.statics.blotName===I.HyperLink.blotName&&Object(P.removeHyperlinkFormat)(this.myQuill,i.endBlot.offset(this.myQuill.scroll),i.endBlot.length())}if(i.startBlot){if(i.endBlot)return"atmention"===i.startBlot.statics.blotName&&this.removeAtFormat(i.startBlot.offset(this.myQuill.scroll),i.startBlot.length()),"atmention"===i.endBlot.statics.blotName&&this.removeAtFormat(i.endBlot.offset(this.myQuill.scroll),i.endBlot.length()),!0;var d=i.startBlot.offset(this.myQuill.scroll),p=this.myQuill.getSelection(),f=this.myQuill.getText(d,i.startBlot.length());if(!p)return Object(a.getTelemetryAPI)().assertConditionTag(!1,"Unexpected empty selection in Quill",587495514),!0;if("atmention"!==i.startBlot.statics.blotName&&0===p.length&&e&&this.myQuill.getFormat(p.index,1).atmention){var h=this.myQuill.getFormat(p.index+1).atmention.fullName;h&&this.removeAtFormat(p.index,h.length+1)}if("atmention"===i.startBlot.statics.blotName){if(p.index===d)return 0===p.length&&!e||(this.removeAtFormat(i.startBlot.offset(this.myQuill.scroll),i.startBlot.length()),!0);var y=this.getChunkBoundaryForDelete(d,f,p,e);if(y)return y.chunkStart>y.chunkEnd||(this.myQuill.deleteText(y.chunkStart,y.chunkEnd-y.chunkStart+1),!1);this.removeAtFormat(d,i.startBlot.length())}}return!0},t.prototype.getKeyboardBindings=function(){var e=this;return{tab:{key:l.KeyboardKeyCode.Tab,handler:function(){return e.tabKeyHandler()}},shiftTab:{key:l.KeyboardKeyCode.Tab,shiftKey:!0,handler:function(){return e.tabKeyHandler()}},enter:{key:l.KeyboardKeyCode.Enter,handler:function(){return e.enterNewline(!1)}},back:{key:l.KeyboardKeyCode.Backspace,handler:function(){var t=e.deleteHandler(!1);return m.isRichTextFormattingInWebEnabled()&&m.isRichContentEditIntegrationInWebEnabled()&&Object(w.getCommentRichContentEditingActor)().onKeyPress({key:l.KeyboardKeyCode.Backspace}),t}},delete:{key:l.KeyboardKeyCode.Delete,handler:function(){var t=e.deleteHandler(!0);return m.isRichTextFormattingInWebEnabled()&&m.isRichContentEditIntegrationInWebEnabled()&&Object(w.getCommentRichContentEditingActor)().onKeyPress({key:l.KeyboardKeyCode.Delete}),t}},commitWithCtrl:{key:l.KeyboardKeyCode.Enter,shortKey:!0,handler:function(){return e.handleCommitKeys()}},newlineWithShift:{key:l.KeyboardKeyCode.Enter,shiftKey:!0,handler:function(){return e.enterNewline(!0)}},bold:{key:l.KeyboardKeyCode.b,shortKey:!0,handler:this.getRichTextKeypressHandler({key:l.KeyboardKeyCode.b,shortKey:!0},m.isRichTextFormattingInWebEnabled(),{type:c.DeltaFormattingType.Weight})},italic:{key:l.KeyboardKeyCode.i,shortKey:!0,handler:this.getRichTextKeypressHandler({key:l.KeyboardKeyCode.i,shortKey:!0},m.isRichTextFormattingInWebEnabled(),{type:c.DeltaFormattingType.Italic})},underline:{key:l.KeyboardKeyCode.u,shortKey:!0,handler:this.getRichTextKeypressHandler({key:l.KeyboardKeyCode.u,shortKey:!0},m.isRichTextFormattingInWebEnabled(),{type:c.DeltaFormattingType.Underline})},insertHyperlink:{key:l.KeyboardKeyCode.k,shortKey:!0,handler:this.getRichTextKeypressHandler({key:l.KeyboardKeyCode.k,shortKey:!0},m.isRichTextFormattingInWebEnabled())},highlight:{key:l.KeyboardKeyCode.h,shortKey:!0,altKey:!0,handler:this.getRichTextKeypressHandler({key:l.KeyboardKeyCode.h,shortKey:!0,altKey:!0},m.isHighlightsAndFontColorInWebCommentsEnabled())},undo:{key:l.KeyboardKeyCode.z,shortKey:!0,handler:function(){return m.isRichTextFormattingInWebEnabled()&&m.isRichContentEditIntegrationInWebEnabled()&&Object(w.getCommentRichContentEditingActor)().onKeyPress({key:l.KeyboardKeyCode.z,shortKey:!0}),!0}}}},t.prototype.getRichTextKeypressHandler=function(e,t,n){var r=this;return function(){var o;if(!t)return!1;var i=null===(o=r.myQuill)||void 0===o?void 0:o.getFormat();return!(null==i?void 0:i.atmention)&&(!m.isRichContentEditIntegrationInWebEnabled()||(n&&Object(w.getCommentRichContentEditingActor)().applyFormattingToCurrentSelection(n),Object(w.getCommentRichContentEditingActor)().onKeyPress(e),!1))}},t.prototype.tabKeyHandler=function(){return m.shouldUseNewSelectionInteractions()},t.prototype.getQuillScrollingContainer=function(){return this.props.isHeightBounded?"#".concat(Object(T.getEditorRootDivId)(this.props.id)):this.props.scrollingContainerId?"#".concat(this.props.scrollingContainerId):void 0},t.prototype.initializeQuill=function(){var e={keyboard:{bindings:this.getKeyboardBindings()}};try{this.myQuill=Object(P.initializeQuillHelper)(this.props,e,this.onTextChangedHandler,this.getQuillScrollingContainer()),this.myQuill.on("selection-change",this.selectionChangeHandler)}catch(t){throw t instanceof Error&&this.logQuillInitializationFailure(t),t}},t.prototype.onKeyUpHandler=function(e){Object(l.normalizeKey)(e.key)===l.KeyboardKey.Control&&Object(P.setHyperlinksClickable)(this.editorRef,!1)},t.prototype.onKeyDownHandler=function(e){Object(l.normalizeKey)(e.key)===l.KeyboardKey.Control&&Object(P.setHyperlinksClickable)(this.editorRef,!0),Object(l.normalizeKey)(e.key)===l.KeyboardKey.Escape&&this.handleEscapeKeys()&&e.stopPropagation(),this.props.onKeyDown&&this.props.onKeyDown(e)},t.prototype.onKeyPressHandler=function(e){},t.prototype.enterNewline=function(e){var t=this;if(!this.myQuill)return Object(a.getTelemetryAPI)().assertConditionTag(!1,"this.myQuill should always be defined if in keyboard handler",588805509),!1;var n=function(){return Object(o.verifyElseThrow)(t.myQuill,"Quill must be defined when processing new line.",o.TelemetryTag.reserveTag(576583249)),t.myQuill.insertText(t.myQuill.getSelection().index,"\n"),!1},r=window.getSelection(),i=r&&r.anchorNode?r.anchorNode.parentNode:null,s=I.Parchment.find(i);if(s&&"atmention"===s.statics.blotName){var l=s.offset(this.myQuill.scroll),c=this.myQuill.getSelection();return c.index===l||c.index===l+s.length()||this.removeAtFormat(s.offset(this.myQuill.scroll),s.length()),n()}return!e||n()},t.prototype.handleCommitKeys=function(){return!(!this.props.onCommitRequested||this.isEditorEmpty())&&(this.props.onCommitRequested(y.default.KeyboardShortcut),!0)},t.prototype.handleEscapeKeys=function(){return!!this.props.onEscapeRequested&&(this.props.onEscapeRequested(),!0)},t.prototype.onFocusHandler=function(e){if(this.editorRef){var t=document.activeElement;this.editorRef.contains(t)&&this.editorRef!==t&&this.isQuillCursorPositionSet||this.focus(),this.props.onFocus&&this.props.onFocus(),m.isRichContentEditIntegrationInWebEnabled()&&this.myQuill&&Object(w.getCommentRichContentEditingActor)().setActiveEditorInfo({editor:this.myQuill,richTextCapabilities:this.props.richTextCapabilities}),e.stopPropagation(),this.lastKnownCursorIndex=void 0}},t.prototype.onBlurHandler=function(e){var t,n,r=e.relatedTarget||document.activeElement;if(m.areSmartRepliesEnabled()){var o=document.getElementById(Object(T.getPickerSuggestionListId)());if(this.props.onEditorBlur&&!E.CommentClipboard.pasteOperationInProgress&&r!==this.editorRef&&e.target!==this.editorRef){var i=r;o&&(o.contains(i)||i.contains(o))||this.props.onEditorBlur()}}else this.props.onEditorBlur&&!E.CommentClipboard.pasteOperationInProgress&&r!==this.editorRef&&e.target!==this.editorRef&&this.props.onEditorBlur();this.lastKnownCursorIndex=null===(n=null===(t=this.myQuill)||void 0===t?void 0:t.getSelection())||void 0===n?void 0:n.index},t.prototype.getEditorClass_deprecated=function(){return k.getStyles(m.isTruncationUIWithReadMoreTextEnabled(),this.props.useReplyBoxStyling,this.props.isHeightBounded,void 0,void 0,this.shouldHideMentionColors()).EditorContainerEditing},t.prototype.isEditorEmpty=function(){return!(!this.myQuill||!this.myQuill.editor.isBlank())},t.prototype.setContents=function(e,t){if(this.myQuill){var n=Object(P.getQuillFromOfficeDelta)(e),r=JSON.parse(n);this.myQuill.setContents(r),this.isRestoreInProgress&&Object(P.setHyperlinksClickable)(this.editorRef,!1);var o=null!=t?t:this.myQuill.getLength();this.lastKnownCursorIndex=o,this.myQuill.hasFocus()&&this.setSelection(o)}},t.prototype.getContentsAsync=function(){var e=this;return this.isRestoreInProgress&&this.props.initialDraftContent?this.props.initialDraftContent.editorContent:new Promise((function(t,n){if(e.myQuill){var r=e.myQuill.getContents();t(Object(P.getOfficeDeltaFromQuill)(JSON.stringify(r))),m.areSmartRepliesEnabled()&&e.selectedSmartReply&&(e.logSmartReplyPostEditActivity(),e.selectedSmartReply=void 0,e.smartReplyEditHistory=v.default.NoEdits)}else n(new f.CommentError(h.InvalidEditorReference,o.TelemetryTag.reserveTag(588351390),-2130957550))}))},t.prototype.getCursorPositionAsync=function(){var e=this;return this.isRestoreInProgress&&this.props.initialDraftContent?this.props.initialDraftContent.editorCursorPosition||Promise.resolve(void 0):new Promise((function(t,n){var r=e.myQuill?e.myQuill.getSelection():void 0;t(r?r.index:e.lastKnownCursorIndex)}))},t.prototype.clear=function(){var e;null===(e=this.myQuill)||void 0===e||e.setText("")},t.prototype.blur=function(){var e;null===(e=this.myQuill)||void 0===e||e.blur()},t.prototype.focus=function(){var e;this.myQuill&&(this.isQuillCursorPositionSet?this.myQuill.focus():this.setSelection(null!==(e=this.lastKnownCursorIndex)&&void 0!==e?e:this.myQuill.getLength()))},t.prototype.setSelection=function(e){var t,n,r;try{null===(t=this.myQuill)||void 0===t||t.setSelection(Math.min(e,null===(n=this.myQuill)||void 0===n?void 0:n.getLength()),0)}catch(i){Object(a.getTelemetryAPI)().assertConditionTag(!1,Object(o.stringifyError)(i),556339362),null===(r=this.myQuill)||void 0===r||r.focus()}},t.prototype.getDisplayMode=function(){return this.props.displayMode},t.prototype.shouldHideMentionColors=function(){return!1},t.prototype.renderAdditionalEditorContent=function(){},t.prototype.handleShowSmartReplyPicker=function(){var e,t,n;if(this.smartReplyPickerRef.current){var r=!!((null!==(t=null===(e=this.props.smartReplyProps)||void 0===e?void 0:e.smartReplies)&&void 0!==t?t:[]).length>0&&this.isEditorEmpty()&&(null===(n=this.myQuill)||void 0===n?void 0:n.hasFocus()));if(r!==this.smartReplyPickerRef.current.isSuggestionsShown)if(r){var o=Object(a.getTelemetryAPI)().createActivityObject("SmartReplyRendered",Object(a.globalTelemetryVisitor)(a.GlobalTelemetryReason.ReviewedAsNotNecessary),a.ActivityAggregationMode.None,a.ActivityDiagnosticLevel.BasicEvent);this.smartReplyPickerRef.current.showPicker(!0),o.successTag(588292805)}else this.smartReplyPickerRef.current.hidePicker()}},t.prototype.onResolveSmartReplySuggestions=function(){var e;return(null===(e=this.props.smartReplyProps)||void 0===e?void 0:e.smartReplies)||null},t.prototype.renderSmartReply=function(e,t){var n=t.suggestionModel.selected?this.styles.SuggestedSmartReplyItem:this.styles.SmartReplyItem;return u.createElement("span",{className:n},e)},t.prototype.handleSmartReplySelection=function(e){var t,n=null!==(t=this.onResolveSmartReplySuggestions())&&void 0!==t?t:[];if(-1!==n.indexOf(e)){var r=n.indexOf(e)+1,i=Object(a.getTelemetryAPI)().createActivityObject("SmartReplyClicked",Object(a.globalTelemetryVisitor)(a.GlobalTelemetryReason.ReviewedAsNotNecessary),a.ActivityAggregationMode.None,a.ActivityDiagnosticLevel.BasicEvent);i.addDataField("ClickPosition",r,a.DataFieldClassification.SystemMetadata),i.addDataField("SmartReplyLength",e.length,a.DataFieldClassification.SystemMetadata),Object(o.verifyElseThrow)(this.myQuill,"Quill should be defined when processing smart reply selection.",o.TelemetryTag.reserveTag(576583250));var s=this.myQuill.getSelection();s&&this.myQuill.insertText(s.index,e,"api"),this.selectedSmartReply=e,i.successTag(588292807)}},t.prototype.onSmartRepliesShown=function(){this.toggleSmartReplyAriaAttributes(!0)},t.prototype.onSmartRepliesHidden=function(){this.toggleSmartReplyAriaAttributes(!1)},t.prototype.renderSmartReplyPicker=function(){var e;if(!m.areSmartRepliesEnabled()||!this.props.smartReplyProps||!this.editorContainerRef.current)return null;var t=Object(T.getSmartReplyHeaderId)(this.props.id),n=Object(i.memoizeOnce)((function(e,n){return{headerItemsProps:[{renderItem:function(){return u.createElement("div",{className:e,id:t},n)},shouldShow:function(){return!0}}]}}))(this.styles.SmartReplyHeader,null===(e=this.props.smartReplyProps)||void 0===e?void 0:e.pickerTitle);return u.createElement(A.SmartReplyFloatingPicker,{componentRef:this.smartReplyPickerRef,calloutWidth:Object(C.getPaneCardReplyBoxWidth)(),suggestionItems:this.onResolveSmartReplySuggestions()||[],suggestionsStore:new s.SuggestionsStore,onResolveSuggestions:this.onResolveSmartReplySuggestions,onChange:this.handleSmartReplySelection,pickerSuggestionsProps:n,onZeroQuerySuggestion:this.onResolveSmartReplySuggestions,pickerCalloutProps:{ariaLabelledBy:t,target:this.editorContainerRef.current,className:m.isWebThemeIntegrationEnabled()?this.styles.SmartReplyCallout:void 0},inputElement:this.getQuillEditorFromFocusContainerDiv(),onRenderSuggestionsItem:this.renderSmartReply,onSuggestionsShown:this.onSmartRepliesShown,onSuggestionsHidden:this.onSmartRepliesHidden})},t.prototype.render=function(){return m.isWebThemeIntegrationEnabled()?Object(O.consumeContexts)(this.renderWithContexts,d.SemanticStylesProviderContext):this.renderWithContexts()},t}(u.PureComponent);t.default=_},33114:function(e,t,n){"use strict";var r;n.r(t),function(e){e[e.SmartReply=0]="SmartReply",e[e.LPP=1]="LPP"}(r||(r={})),t.default=r},33115:function(e,t,n){"use strict";var r;n.r(t),function(e){e[e.EditTypeUnknown=-1]="EditTypeUnknown",e[e.NoEdits=0]="NoEdits",e[e.CharactersInserted=1]="CharactersInserted",e[e.CharactersDeleted=2]="CharactersDeleted",e[e.CharactersInsertedAndDeleted=3]="CharactersInsertedAndDeleted",e[e.EntireSuggestionDeleted=4]="EntireSuggestionDeleted"}(r||(r={})),t.default=r},33116:function(e,t,n){"use strict";n.r(t),n.d(t,"getPickerAriaAttributes",(function(){return s}));var r=n(562),o=n(3e4),i=n(33114),a=n(31038);function s(e,t){if(e){var n=Object(a.getLPPSuggestionListId)(),s=Object(a.getPickerSuggestionListId)(),l={"aria-autocomplete":"none","aria-expanded":"true"};switch(t){case i.default.LPP:return Object(r.__assign)(Object(r.__assign)({},l),{"aria-haspopup":"listbox","aria-owns":n,"aria-controls":n});case i.default.SmartReply:return Object(r.__assign)(Object(r.__assign)({},l),{"aria-haspopup":"true","aria-owns":s,"aria-controls":s});default:Object(o.unreachable)(t)}}}},33117:function(e,t,n){"use strict";n.r(t),n.d(t,"smartReplySuggestionHasNoEdits",(function(){return c})),n.d(t,"smartReplySuggestionHasCharactersInserted",(function(){return u})),n.d(t,"smartReplySuggestionHasSomeCharactersDeleted",(function(){return d})),n.d(t,"smartReplySuggestionWasDeletedCompletely",(function(){return p})),n.d(t,"determineNewReplyPostEditType",(function(){return f})),n.d(t,"getSmartReplyPostEditType",(function(){return h})),n.d(t,"getNewSmartReplyEditHistory",(function(){return m}));var r,o,i,a,s=n(33115),l=((r={})[s.default.CharactersInserted]=((o={})[s.default.CharactersInserted]=s.default.CharactersInserted,o[s.default.CharactersDeleted]=s.default.CharactersInsertedAndDeleted,o[s.default.CharactersInsertedAndDeleted]=s.default.CharactersInsertedAndDeleted,o),r[s.default.CharactersInsertedAndDeleted]=((i={})[s.default.CharactersInserted]=s.default.CharactersInsertedAndDeleted,i[s.default.CharactersDeleted]=s.default.CharactersInsertedAndDeleted,i[s.default.CharactersInsertedAndDeleted]=s.default.CharactersInsertedAndDeleted,i),r[s.default.CharactersDeleted]=((a={})[s.default.CharactersDeleted]=s.default.CharactersDeleted,a[s.default.CharactersInserted]=s.default.CharactersInsertedAndDeleted,a[s.default.CharactersInsertedAndDeleted]=s.default.CharactersInsertedAndDeleted,a),r);function c(e,t){var n=(null==e?void 0:e.ops)&&e.ops.length>0?e.ops[0].insert:"";return!(!(n=n&&"\n"===n[n.length-1]?null==n?void 0:n.slice(0,-1):n)||t!==n)}function u(e,t){return!!(t&&(null==e?void 0:e.ops)&&e.ops.some((function(e){return"string"==typeof e.insert})))}function d(e,t){var n=null==e?void 0:e.ops;if(void 0===n||!t)return!1;var r=n.some((function(e){return e.delete&&e.delete>0})),o=n.some((function(e){return e.retain&&e.retain>0}));return r&&o}function p(e,t){var n=null==e?void 0:e.ops;if(void 0===n||0===n.length||!t)return!1;var r=0,o=0,i=0;n.forEach((function(e){var t,n,a,s;r+=null!==(t=e.delete)&&void 0!==t?t:0,o+=null!==(n=e.retain)&&void 0!==n?n:0,i+=null!==(s=null===(a=e.insert)||void 0===a?void 0:a.length)&&void 0!==s?s:0}));var a=o+i;return!(i>0&&0===r)&&(!!(a<=1)||0===a)}function f(e,t,n){return c(n,t)?s.default.NoEdits:p(e,t)?s.default.EntireSuggestionDeleted:u(e,t)?d(e,t)?s.default.CharactersInsertedAndDeleted:s.default.CharactersInserted:d(e,t)?s.default.CharactersDeleted:s.default.EditTypeUnknown}function h(e,t,n,r){return m(e,f(t,n,r))}function m(e,t){switch(t){case s.default.NoEdits:case s.default.EditTypeUnknown:case s.default.EntireSuggestionDeleted:return t}switch(e){case s.default.EntireSuggestionDeleted:return e;case s.default.EditTypeUnknown:case s.default.NoEdits:return t}return l[e]?l[e][t]:s.default.EditTypeUnknown}},33118:function(e,t,n){"use strict";n.r(t),n.d(t,"SmartReplyFloatingPicker",(function(){return o}));var r=n(562),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t}(n(30123).BaseFloatingPicker)},33119:function(e,t,n){"use strict";n.r(t),n.d(t,"getCommentRichContentEditingActor",(function(){return u}));var r,o=n(33095),i=n(33041),a=n(30997),s=n(31293),l=n(33105).default.import("delta"),c=function(){function e(){this.disableSelectionChangeCallback=!1,Object(o.getRichContentEditAPIInstance)().initRichContentEditor(this)}return e.prototype.getFormattingAtCurrentSelection=function(){var e;if(!this.editor)return{};if(this.formattingCache)return this.formattingCache;var t,n=this.editor.getSelection(!1);return(t=n&&this.editor.getFormat(n))&&(this.formattingCache={bold:t.bold,italic:t.italic,underline:t.underline,strikethrough:t.strike}),null!==(e=this.formattingCache)&&void 0!==e?e:{}},e.prototype.getSelection=function(){var e=this.getSelectedContent();return{text:e?Object(s.getPlainTextFromOdeltaObject)(e):""}},e.prototype.applyFormattingToCurrentSelection=function(e){var t,n=this,r=this.richTextCapabilities&&!!(this.richTextCapabilities&e.type);if(this.editor&&r){var o=this.getSelectedContent();if(null==o?void 0:o.ops)for(var a=o.ops,s=0;s<a.length;s++)if(null===(t=a[s].attributes)||void 0===t?void 0:t.atmention)return;var l=!0,c=this.getFormattingAtCurrentSelection();this.executeWithSelectionChangeCallbackDisabled((function(){var t,r;if(n.editor)switch(e.type){case i.DeltaFormattingType.Weight:n.editor.format("bold",!c.bold,"api");break;case i.DeltaFormattingType.Italic:n.editor.format("italic",!c.italic,"api");break;case i.DeltaFormattingType.Underline:n.editor.format("underline",!c.underline,"api");break;case i.DeltaFormattingType.Strikethrough:n.editor.format("strike",!c.strikethrough,"api");break;case i.DeltaFormattingType.Highlight:n.editor.format("background",null===(t=e.data)||void 0===t?void 0:t.color,"api"),n.moveSelectionToEnd();break;case i.DeltaFormattingType.Color:n.editor.format("color",null===(r=e.data)||void 0===r?void 0:r.fontColor,"api"),n.moveSelectionToEnd();break;default:l=!1}})),l&&this.invalidateFormattingCache()}},e.prototype.addContent=function(e){var t=this.richTextCapabilities&&!!(this.richTextCapabilities&e.type);if(this.editor&&t)switch(e.type){case i.DeltaFormattingType.Hyperlink:if(e.data){var n=this.editor.getSelection(!1),r=(new l).retain(n.index).delete(n.length).insert(e.data.text,{hyperlink:JSON.stringify({url:e.data.link,editable:!0})}).insert(" ");this.editor.updateContents(r,"api"),this.editor.setSelection(n.index+e.data.text.length+2,0)}}},e.prototype.isFormatEnabled=function(e){return a.isRichContentEditIntegrationInWebEnabled()&&!!this.editor&&!!this.richTextCapabilities&&!!(this.richTextCapabilities&e)},e.prototype.registerSelectionChangeHandler=function(e){this.selectionChangeHandler=e},e.prototype.registerKeypressHandler=function(e){this.keypressHandler=e},e.prototype.setActiveEditorInfo=function(e){var t,n;this.editor=null!==(t=e.editor)&&void 0!==t?t:this.editor,this.editorContainerElement=null!==(n=e.editorContainer)&&void 0!==n?n:this.editorContainerElement,this.richTextCapabilities=e.richTextCapabilities,this.invokeSelectionChangeHandler()},e.prototype.resetActiveEditorInfo=function(){this.editor=void 0,this.editorContainerElement=void 0,this.richTextCapabilities=void 0},e.prototype.onSelectionChange=function(e){this.editor&&this.editor===e&&!this.disableSelectionChangeCallback&&this.invokeSelectionChangeHandler()},e.prototype.onKeyPress=function(e){var t;this.invalidateFormattingCache(),null===(t=this.keypressHandler)||void 0===t||t.call(this,e)},e.prototype.setFocus=function(){this.editorContainerElement&&this.editorContainerElement.focus()},e.prototype.invalidateFormattingCache=function(){this.formattingCache=void 0},e.prototype.invokeSelectionChangeHandler=function(){var e;this.invalidateFormattingCache(),null===(e=this.selectionChangeHandler)||void 0===e||e.call(this)},e.prototype.moveSelectionToEnd=function(){if(this.editor){var e=this.editor.getSelection(!1);this.editor.setSelection(e.index+e.length,0)}},e.prototype.executeWithSelectionChangeCallbackDisabled=function(e){this.disableSelectionChangeCallback=!0,e(),this.disableSelectionChangeCallback=!1},e.prototype.getSelectedContent=function(){if(this.editor){var e=this.editor.getSelection(!1);if(e)return this.editor.getContents(e.index,e.length)}},e}();function u(){return r||(r=new c),r}},33120:function(e,t,n){"use strict";n.r(t);var r=n(562),o=n(3e4),i=n(30061),a=n(31074),s=n(31159),l=n(245),c=n(31109),u=n(30997),d=n(32953),p=n(33114),f=n(33121),h=n(31403),m=n(33116),y=n(33107),g=n(31293),b=n(33105),v=n(33113),C=b.default.import("delta"),T=function(e){function t(t){var n=e.call(this,t)||this;return n.startIndexOfMention=0,n.onAtMentionSuggestionHighlighted=function(e){n.setState({activeDescendantId:e})},n.getActiveDescendantId=function(){return n.state.activeDescendantId},n.isInAtMentionMode=function(){return n.state.inAtMentionMode},n.exitAtMentionMode=n.exitAtMentionMode.bind(n),n.insertMentionText=n.insertMentionText.bind(n),n.onSuggestionSelected=n.onSuggestionSelected.bind(n),n.onKeyDownHandler=n.onKeyDownHandler.bind(n),n.onKeyPressHandler=n.onKeyPressHandler.bind(n),n.onTextChangedHandler=n.onTextChangedHandler.bind(n),n.onMentionHostRef=n.onMentionHostRef.bind(n),n.enterAtMentionMode=n.enterAtMentionMode.bind(n),n.onShowHandler=n.onShowHandler.bind(n),n.enterNewline=n.enterNewline.bind(n),n.getKeyboardBindings=n.getKeyboardBindings.bind(n),n.state={activeDescendantId:void 0,inAtMentionMode:!1,isReplacingContentAtBeginning:!1,mentionQueryString:"",hadWordSelectionShortcut:!1},n}return Object(r.__extends)(t,e),t.prototype.enterNewline=function(t){return!this.state.inAtMentionMode&&e.prototype.enterNewline.call(this,t)},t.prototype.handleEscapeKeys=function(){return this.state.inAtMentionMode||e.prototype.handleEscapeKeys.call(this)},t.prototype.componentWillUnmount=function(){var e,t;null===(t=(e=this.props).onUnmount)||void 0===t||t.call(e)},t.prototype.componentDidUpdate=function(t,n){n.inAtMentionMode&&!this.state.inAtMentionMode&&this.AtMentionRef&&this.AtMentionRef.onMentionsTextChanged("",!0);var r=this.state.inAtMentionMode,o=this.getQuillEditorFromFocusContainerDiv();if(o&&(r!==n.inAtMentionMode&&Object(y.setPickerAriaAttributes)(o,Object(m.getPickerAriaAttributes)(r,p.default.LPP)),!r&&this.isSmartReplyPickerDisplayed()&&(Object(y.setPickerAriaAttributes)(o,Object(m.getPickerAriaAttributes)(!0,p.default.SmartReply)),o.removeAttribute("aria-activedescendant")),r&&!this.isSmartReplyPickerDisplayed())){var i=this.getActiveDescendantId();i&&o&&o.setAttribute("aria-activedescendant",i)}e.prototype.componentDidUpdate.call(this,t,n)},t.prototype.onMentionHostRef=function(e){this.AtMentionRef=e},t.prototype.updateCurrentMentions=function(e,t){var n=Object(y.extractUniqueEmailsFromDelta)(t),r=t.compose(e),o=Object(y.extractUniqueEmailsFromDelta)(r);Object(c.wereMentioneesAltered)(n,o)&&this.props.onMentioneesStillInDraftUpdated(o)},t.prototype.onTextChangedHandler=function(t,n,r){if(this.state.isReplacingContentAtBeginning&&this.setState({isReplacingContentAtBeginning:!1}),this.state.inAtMentionMode&&this.AtMentionRef){var o=this.getMentionText();if(o&&o.length>0&&this.state.mentionQueryString!==o)if(o.split(" ").length>3)this.AtMentionRef.onMentionsTextChanged("",!0),this.setState({mentionQueryString:""});else{this.setState({mentionQueryString:o});var i=this.AtMentionRef.isTestEnvironment()?o.substr(1):o;this.AtMentionRef.onMentionsTextChanged(i,!1)}}this.props.displayMode===d.default.Editing&&u.areCommentTasksEnabled()&&(Object(y.deltaContainsInsertsAtMentionOperation)(t)||Object(y.deltaContainsMoreThan1CharacterDeleteOperation)(t)||Object(y.deltaContainsResetAtMentionOperation)(t))&&this.updateCurrentMentions(t,n),e.prototype.onTextChangedHandler.call(this,t,n,r)},t.prototype.onKeyPressHandler=function(e){if(this.myQuill){var t=this.myQuill.getSelection();if(t){if(this.setState({isReplacingContentAtBeginning:0===t.index&&t.length>0}),String.fromCharCode(e.which)!==h.AtMentionsCharacter)return;var n=this.myQuill.getText(t.index-1,1),r=/\s/.test(n),o=/\n/.test(n),a=""===n;(0===t.index||r||o||a)&&(this.enterAtMentionMode(),this.startIndexOfMention=t.index)}}else Object(i.getTelemetryAPI)().assertConditionTag(!1,"Quill should be defined for editor handlers!",577066520)},t.prototype.onKeyDownHandler=function(t){if(this.myQuill){var n=this.myQuill.getSelection();if(this.state.inAtMentionMode&&this.isEditorEmpty()&&this.exitAtMentionMode(),n&&this.state.inAtMentionMode){var r=Object(s.normalizeKey)(t.key),o=n.index,a=t.ctrlKey,l=t.shiftKey;switch(this.setState({hadWordSelectionShortcut:a&&l&&(r===s.KeyboardKey.ArrowLeft||r===s.KeyboardKey.ArrowRight)}),r){case s.KeyboardKey.Backspace:var c=o>0&&this.startIndexOfMention===o-1,u=this.startIndexOfMention===o,d=o<this.startIndexOfMention;(c||u||d)&&!this.state.hadWordSelectionShortcut&&this.exitAtMentionMode(),this.state.hadWordSelectionShortcut&&this.setState({hadWordSelectionShortcut:!1});break;case s.KeyboardKey.Delete:o===this.startIndexOfMention&&this.exitAtMentionMode();break;case s.KeyboardKey.Tab:t.stopPropagation(),t.preventDefault();break;case s.KeyboardKey.ArrowUp:case s.KeyboardKey.ArrowDown:t.preventDefault();break;default:0===o&&n.length>0&&this.exitAtMentionMode()}}this.AtMentionRef&&this.AtMentionRef.onMentionsKeyDownHandler(t),e.prototype.onKeyDownHandler.call(this,t)}else Object(i.getTelemetryAPI)().assertConditionTag(!1,"Quill should be defined for editor handlers!",577066521)},t.prototype.getMentionText=function(){if(this.myQuill){var e=0;this.myQuill.getSelection()&&(e=this.myQuill.getSelection().index),e<this.startIndexOfMention&&Object(o.logInfo)("selection moved before @ when inAtMentionMode: ".concat(this.state.inAtMentionMode,"\n      selectionIndex ").concat(e," startIndexOfMention ").concat(this.startIndexOfMention));var t=1;return t=e>this.startIndexOfMention?e-this.startIndexOfMention:e===this.startIndexOfMention?1:this.myQuill.getLength(),this.myQuill.getText(this.startIndexOfMention,t)}Object(i.getTelemetryAPI)().assertConditionTag(!1,"Quill should be defined for editor handlers!",577066522)},t.prototype.exitAtMentionMode=function(){this.setState({inAtMentionMode:!1,activeDescendantId:void 0,mentionQueryString:""}),this.updateAriaAttributes(!1)},t.prototype.enterAtMentionMode=function(){var e=this;this.setState({inAtMentionMode:!0}),setTimeout((function(){return e.updateAriaAttributes(!0)}))},t.prototype.onShowHandler=function(){this.enterAtMentionMode()},t.prototype.updateAriaAttributes=function(e){if(this.editorRef){var t=document.getElementById(this.props.id);if(t&&this.myQuill){if(t.hasAttribute("aria-controls")&&!e)t.removeAttribute("aria-controls");else if(e&&t.parentElement){var n=this.myQuill.getSelection();t.parentElement.focus(),n&&this.myQuill.setSelection(n.index,0)}}else Object(i.getTelemetryAPI)().assertConditionTag(!1,"Trying to use Quill div when not mounted in DOM",588805467)}},t.prototype.insertMentionText=function(e,t,n){if(this.myQuill){this.exitAtMentionMode(),this.props.onMentionCreated(n);var r=Object(c.getMentioneeName)(n),o=Object(c.getMentioneeUserPrincipalNameOrEmail)(n),s=g.ResolveState.Resolved,l=(new C).retain(this.startIndexOfMention).delete(e).insert("@".concat(t),{atmention:JSON.stringify(Object(g.getMentionMetaData)(r,o,s))}).insert(" ");this.myQuill.updateContents(l,"api");var u=this.startIndexOfMention+t.length+2;this.myQuill.setSelection(u,0),Object(a.announceToScreenReader)(this.props.localizationAPI.formatString(227,t))}else Object(i.getTelemetryAPI)().assertConditionTag(!1,"Quill should be defined for editor handlers!",577066523)},t.prototype.onSuggestionSelected=function(e){this.insertMentionText(this.state.mentionQueryString.length,e.Name,e)},t.prototype.shouldHideMentionColors=function(){return this.state.isReplacingContentAtBeginning},t.prototype.renderAdditionalEditorContent=function(){return this.props.displayMode===d.default.Editing?l.createElement(f.default,{ref:this.onMentionHostRef,onSuggestionSelected:this.onSuggestionSelected,target:this.props.id,onShow:this.onShowHandler,onDismiss:this.exitAtMentionMode,inAtMentionMode:this.state.inAtMentionMode,getAuthToken:this.props.getAuthToken,onSuggestionHighlighted:this.onAtMentionSuggestionHighlighted}):void 0},t.prototype.getKeyboardBindings=function(){var t=this;return Object(r.__assign)(Object(r.__assign)({},e.prototype.getKeyboardBindings.call(this)),{enter:{key:s.KeyboardKeyCode.Enter,handler:function(){var e;return(!u.areSmartRepliesEnabled()||!(null===(e=t.smartReplyPickerRef.current)||void 0===e?void 0:e.isSuggestionsShown))&&t.enterNewline(!1)}}})},t}(v.BasicCommentEditor);t.default=T},33121:function(e,t,n){"use strict";n.r(t);var r=n(562),o=n(3e4),i=n(31370),a=n(30061),s=n(245),l=n(31272),c=n(30987),u=n(31186),d=n(33122),p=n(31396),f=n(31041),h=n(33124),m=n(31038),y=n(33125),g=void 0,b=function(e){function t(t){var n=e.call(this,t)||this;return n.configureLPP=function(e){try{if(e&&!n.state.livePersonaPickerInstance)if(!Object(l.getLPPInitializationStatus)()){var t=Object(y.getPickerTelemetryMetadata)(Object(a.getTelemetryAPI)());e.initializeLivePersonaPicker(h.ACCOUNT_IDENTIFIER,Object(r.__assign)(Object(r.__assign)({},t),{complianceEnvironment:t.complianceEnvironment,clientCorrelationId:Object(a.getTelemetryAPI)().getMetadata().sessionId,refreshAuthToken:n.refreshAuthToken,getHostAppSuggestions:n.isTestEnvironment()?d.getMockHostAppSuggestions:void 0,offline:n.isTestEnvironment()})),Object(l.setLPPInitializationStatusAsInitialized)()}g=e.getLivePersonaPickerContainer(h.ACCOUNT_IDENTIFIER),n.state.livePersonaPickerInstance||n.setState({livePersonaPickerInstance:g})}catch(i){Object(a.getTelemetryAPI)().assertConditionTag(!1,"configureLPP: ".concat("string"==typeof i?i:Object(o.stringifyError)(i)),595637921)}},n.renderLivePersonaPicker=function(){return n.state.livePersonaPickerInstance?s.createElement(n.state.livePersonaPickerInstance,{inputId:n.props.target?n.props.target:"",strings:n.state.peoplePickerStrings,isOpen:n.props.inAtMentionMode,maxHeight:400,maxWidth:250,onSuggestionSelected:n.props.onSuggestionSelected,onShow:n.props.onShow,onDismiss:n.props.onDismiss,componentRef:n.onPeoplePickerRef,onSuggestionHighlighted:n.props.onSuggestionHighlighted,suggestionListId:m.getLPPSuggestionListId()}):null},n.onPeoplePickerRef=n.onPeoplePickerRef.bind(n),n.refreshAuthToken=n.refreshAuthToken.bind(n),n.state={livePersonaPickerInstance:g,peoplePickerStrings:{loading:"Loading...",error:"Can't search right now.",allResults:"No more results found.",limitedResults:"Top results",emptyResults:"No suggestions found for now.",useThisAddress:"Use this address",atMentionsModePlaceholderText:"Type @ to mention a person",pickerModePlaceholderText:"Enter a name or email address",suggestionsAnnouncement:"Number of suggestions found: ",selectedSuggestionAccessibilityLabel:"Suggestion",selectedSuggestionNumberAccessibilityLabel:"of",suggestionsAvailableAnnouncement:"Suggestions Available"}},n}return Object(r.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this;Object(p.delayLoadAtMentionComponents)().then((function(t){e.setState({peoplePicker:t})})).catch(Object(f.makeAssertErrorHandler)(o.TelemetryTag.reserveTag(595632143))),this.state.lppImports||Object(p.delayLoadLPP)().then((function(t){if(t){e.configureLPP(t);var n=Object(c.getLocalizationAPI)().getLocaleInfo().uiCulture;t.getLivePersonaPickerStrings(n).then((function(t){e.setState({peoplePickerStrings:t})})).catch((function(e){Object(a.getTelemetryAPI)().assertConditionTag(!1,"failed to fetch LPP strings for locale: ".concat(n,", error: ").concat(e.message),595637531)})),e.setState({lppImports:t})}else Object(a.getTelemetryAPI)().assertConditionTag(!1,"LPP was not able to load.",576582748)})).catch(Object(f.makeAssertErrorHandler)(o.TelemetryTag.reserveTag(591155841)))},t.prototype.isTestEnvironment=function(){var e=Object(a.getTelemetryAPI)().getMetadata(),t="-4"===e.ring&&"DC2"===e.dataCenter;return u.IsDemo||t},t.prototype.refreshAuthToken=function(e){return this.props.getAuthToken?this.props.getAuthToken(i.PeopleServiceId.Loki):(Object(a.getTelemetryAPI)().assertConditionTag(!1,"getAuthToken cannot be undefined",595637532),Promise.resolve(""))},t.prototype.onPeoplePickerRef=function(e){this.peoplePickerRef=e},t.prototype.onMentionsTextChanged=function(e,t){this.peoplePickerRef&&(t?this.props.onDismiss():this.peoplePickerRef.onQueryChanged(e))},t.prototype.onMentionsKeyDownHandler=function(e){if(this.peoplePickerRef&&(Object(a.getTelemetryAPI)().assertConditionTag(!!this.state.peoplePicker,"peoplepicker did not lazy-load correctly",595632416),e&&e.keyCode&&this.props.inAtMentionMode&&this.state.lppImports)){var t=this.state.lppImports.keyboardEventKeyCodeToCustomKey[e.keyCode];void 0!==t&&this.peoplePickerRef.onCustomKeyPressed(t)}},t.prototype.render=function(){return this.renderLivePersonaPicker()},t}(s.PureComponent);t.default=b},33122:function(e,t,n){"use strict";n.r(t),n.d(t,"LPPPeople",(function(){return o})),n.d(t,"getMockHostAppSuggestions",(function(){return i}));var r=n(33123);var o=r.people.map((function(e){var t,n,r=(t=e.UserId,3!==(n=t.split("::")).length?{UPN:"UnknownUPN",AadObjectId:"UnknownAadObjectId",SubstrateId:"UnknownSubstrateId"}:{UPN:n[1],AadObjectId:n[2],SubstrateId:"".concat(n[2],"@").concat("v0pt9p5w-fw09-7c24-k1r3-lpn9bjq978he")});return{AadObjectId:r.AadObjectId,Id:r.SubstrateId,Name:e.DisplayName,UserPrincipalName:r.UPN,EmailAddresses:[r.UPN],SuggestionType:"Person",SuggestionSubtype:"OrganizationUser",HostAppSuggestion:{},Source:"Loki",SuggestionOrigin:"Search"}}));function i(e){return new Promise((function(t,n){setTimeout((function(){if(""===e)t(o);else{var n=o.filter((function(t){return t.Name.toLocaleLowerCase().includes(e.toLocaleLowerCase())||t.EmailAddresses[0].toLocaleLowerCase().includes(e.toLocaleLowerCase())||t.UserPrincipalName.toLocaleLowerCase().includes(e.toLocaleLowerCase())}));t(n)}}),200)}))}},33123:function(e,t,n){"use strict";n.r(t),n.d(t,"ADProvider",(function(){return r})),n.d(t,"SAMPLE_AUTHOR_DISPLAYNAME",(function(){return o})),n.d(t,"SAMPLE_AUTHOR_ID",(function(){return i})),n.d(t,"SAMPLE_IMAGE_URL",(function(){return a})),n.d(t,"DEFAULT_USER",(function(){return s})),n.d(t,"NichoLundberg",(function(){return l})),n.d(t,"AnnieLindqvistRedmond",(function(){return c})),n.d(t,"ValentinaLovric",(function(){return u})),n.d(t,"BellirinaRosa",(function(){return d})),n.d(t,"people",(function(){return p}));var r="AD",o="Sample Author",i="S::test@identity.com::2js7ye2hy-2h3g-28hd-j2us-2h8dhbxvagsh",a="https://th.bing.com/th/id/OIP.gZXi6238_92bsflbtiFL4wHaHa?w=180&h=180&c=7&r=0&o=5&pid=1.7",s={UserId:i,DisplayName:o,Email:"test@identity.com",Provider:r},l={UserId:"S::nichoCanWrite@microsoft.com::89wmux1c-l2o8-zyv9-oj3q-w30p912pi1zf",DisplayName:"Nicho Lundberg",Email:"nichoCanWrite@microsoft.com",Provider:r},c={UserId:"S::mynameisannie@sharedComments.com::3od7ob07-08q8-0sjs-lob9-7p956l88b3rp",DisplayName:"Annie Lindqvist (Redmond)",Email:"mynameisannie@sharedComments.com",Provider:r},u={UserId:"S::ValentinaCanWrite@microsoft.com::87597fbh-6c1y-rdw6-zxf9-21m8o4s3w721",DisplayName:"Valentina Lovric",Email:"ValentinaCanWrite@microsoft.com",Provider:r},d={UserId:"S::BellirinaCanReview@microsoft.com::87597fbh-6c1y-rdw6-zxf9-32n9p5t4x832",DisplayName:"Bellirina Rosa",Email:"BellirinaCanReview@microsoft.com",Provider:r},p=[c,u,l,d,{UserId:"S::aaronReid@microsoft.com::iyy40m52-99h4-a8kc-9d56-j988s9j17755",DisplayName:"Aaron Reid (Asia Pacific Research & Development)",Email:"aaronReid@microsoft.com",Provider:r},{UserId:"S::Roko@microsoft.com::4zvf82t2-140h-3506-l8vm-zgg95407x3h0",DisplayName:"Roko Kolar (India Development Center)",Email:"Roko@microsoft.com",Provider:r},{UserId:"S::Christian@microsoft.com::5azgo6y8-1b38-d2ah-7t95-jqvg5r1nmvx1",DisplayName:"Christian Bergqvist (Israel Research & Development)",Email:"Christian@microsoft.com",Provider:r},{UserId:"S::Maor@microsoft.com::lqj9p96z-fe80-zx4v-a19n-2855t8yp0b80",DisplayName:"Maor Sharett (Vancouver)",Email:"Maor@microsoft.com",Provider:r},{UserId:"S::Anny@microsoft.com::27f75c64-w2kj-7rye-3823-6fs244j9553y",DisplayName:"Anny Lindqvist (New England Research & Development)",Email:"Anny@microsoft.com",Provider:r},{UserId:"S::Aron@microsoft.com::tkec2ao2-h3n4-asqv-lwcm-nuj74bc2501r",DisplayName:"Aron Reid (Silicon Valley & San Francisco)",Email:"Aron@microsoft.com",Provider:r},{UserId:"S::Alix@microsoft.com::9ooh72e8-0224-0tdi-8of3-vf01g64jt140",DisplayName:"Alix Lundberg",Email:"Alix@microsoft.com",Provider:r},{UserId:"S::Roko@microsoft.com::kj1i4m3e-2t48-48tb-54mh-xl5278i109lc",DisplayName:"Roko Kular",Email:"Roko@microsoft.com",Provider:r},{UserId:"S::Christian@microsoft.com::ef944246-30s0-qj56-87le-a4mz2b8k1337",DisplayName:"Christian Bergqvest",Email:"Christian@microsoft.com",Provider:r},{UserId:"S::Valintina@microsoft.com::fjo0bk47-y6q8-20wz-g4na-1d5u572q2pid",DisplayName:"Valintina Lovric",Email:"Valintina@microsoft.com",Provider:r},{UserId:"S::Maor@microsoft.com::zt3sdbse-e073-1562-1js5-v5x78of1p09r",DisplayName:"Maor Sharet",Email:"Maor@microsoft.com",Provider:r},{UserId:"S::Anny@microsoft.com::d4268h1x-6568-bh7s-k789-om88c1f90690",DisplayName:"Anny Lindqvest",Email:"Anny@microsoft.com",Provider:r},{UserId:"S::Alix@microsoft.com::qkxh95h2-22f5-u2z3-h2l2-j5i144rv6480",DisplayName:"Alix Lunberg",Email:"Alix@microsoft.com",Provider:r},{UserId:"S::Annie@microsoft.com::ujy2cg5t-1ya6-v7us-0eqt-0dw5r1p6p547",DisplayName:"Annie Lindqvest",Email:"Annie@microsoft.com",Provider:r},{UserId:"S::Alixander@microsoft.com::91e1zb0b-0321-7a9x-6xui-gwgn2brkup19",DisplayName:"Alixander Lundberg",Email:"Alixander@microsoft.com",Provider:r},{UserId:"S::Anny@microsoft.com::0s510228-n7b1-7u4d-6w13-2t2j8p70bhg4",DisplayName:"Anny Lundqvist",Email:"Anny@microsoft.com",Provider:r},{UserId:"S::Anny@microsoft.com::a560500t-4w06-1712-pgul-b9az2s18kv9g",DisplayName:"Anny Lundqvist (Redmond)",Email:"Anny@microsoft.com",Provider:r},{UserId:"S::Maor@microsoft.com::t2k8y26d-x1eo-qza4-52qr-wtkjr8f233r8",DisplayName:"Maor Shorett",Email:"Maor@microsoft.com",Provider:r},{UserId:"S::Valentina@microsoft.com::f480ks5p-fsd9-tk2u-9xui-1852ex3ve541",DisplayName:"Valentina Lovrics",Email:"Valentina@microsoft.com",Provider:r},{UserId:"S::Maor@microsoft.com::clt641r7-d5si-dd5d-d045-fxu1g97a7r9m",DisplayName:"Maor Sharet",Email:"Maor@microsoft.com",Provider:r},{UserId:"S::Valentina@microsoft.com::8s6j87ee-b7ic-ga48-ox0z-nm37syw7971k",DisplayName:"Valentina Lovrecs",Email:"Valentina@microsoft.com",Provider:r},{UserId:"S::Maor@microsoft.com::e9m0hlvc-cc89-edn9-o2ux-mqwn9m108md4",DisplayName:"Maor Sharitt",Email:"Maor@microsoft.com",Provider:r}]},33124:function(e,t,n){"use strict";n.r(t),n.d(t,"ACCOUNT_IDENTIFIER",(function(){return r})),n.d(t,"LPPAUTOMATION_ACTION_SEPARATOR",(function(){return o})),n.d(t,"LPPAUTOMATION_EXPECTED_TESTID_PREFIX",(function(){return i})),n.d(t,"LPPAUTOMATION_UNKNOWN_FIELD",(function(){return a}));var r="ACCOUNT_IDENTIFIER",o=",",i="selectedPerson",a="Unknown"},33125:function(e,t,n){"use strict";n.r(t),n.d(t,"getPickerTelemetryMetadata",(function(){return u}));var r,o,i=n(33126),a=n(33130),s=n(31110),l=((r={}).android="Android",r.macos="Mac",r.web="Web",r.win32="Win32",r.ios="iOS",r),c=((o={}).android="OfficeAndroid",o.macos=void 0,o.web="OfficeWebApps",o.win32="OfficeWin32",o.ios="OfficeiOS",o),u=function(e){var t=e.getMetadata();return{clientType:c[Object(s.getPlatform)()],hostAppName:t.appName,hostAppPlatform:l[Object(s.getPlatform)()],hostAppRing:t.releaseAudienceGroup||t.ring||t.releaseAudience,hostAppVersion:t.appVersion,complianceEnvironment:t.sovereignEnvironmentName?Object(i.validateComplianceEnvironment)(t.sovereignEnvironmentName):a.prodComplianceEnvironment}}},33126:function(e,t,n){"use strict";n.r(t),n.d(t,"validateComplianceEnvironment",(function(){return r})),n.d(t,"GET_AUTH_TOKEN_SCENARIO",(function(){return o})),n.d(t,"GET_AUTH_TOKEN_FAILED",(function(){return i})),n.d(t,"AUTH_TOKEN_RECEIVED_AFTER_TIMEOUT",(function(){return a}));n(33127),n(33128),n(33129);function r(e){return"Df"===e?"Df":"Msit"===e?"Msit":"Prod"===e?"Prod":"Blackforest"===e?"Blackforest":"GccModerate"===e?"GccModerate":"GccHigh"===e?"GccHigh":"DoD"===e?"DoD":"Gallatin"===e?"Gallatin":"AG08"===e?"AG08":"AG09"===e?"AG09":"Unknown"}var o="LokiGetAuthToken",i="LokiGetAuthTokenFailed",a="LokiAuthTokenReceivedAfterTimeout"},33127:function(e,t,n){"use strict";n.r(t)},33128:function(e,t,n){"use strict";n.r(t)},33129:function(e,t,n){"use strict";n.r(t)},33130:function(e,t,n){"use strict";n.r(t),n.d(t,"prodComplianceEnvironment",(function(){return r}));var r="Prod"},33131:function(e,t,n){"use strict";n.r(t),n.d(t,"shouldRenderBlueDot",(function(){return i}));var r=n(30997),o=n(32949);function i(e){return r.isCommentsFluentUIEnabled()&&(e.isReadOnly||e.postDisplayMode===o.default.Normal||e.postDisplayMode===o.default.Resolved)&&e.isNew}},33132:function(e,t,n){"use strict";n.r(t),n.d(t,"CommentPostInner",(function(){return N}));var r=n(562),o=n(3e4),i=n(30061),a=n(30123),s=n(31159),l=n(245),c=n(31126),u=n(31109),d=n(32926),p=n(31041),f=n(30988),h=n(30989),m=n(30997),y=n(31415),g=n(32952),b=n(32953),v=n(32949),C=n(33133),T=n(33138),O=n(32972),S=n(33083),P=n(33088),x=n(33131),I=n(31285),E=n(31038),A=n(32933),k=n(32961),w=n(33139),_=n(30994),R=n(33112),j=n(33140),D=n(33076),M=n(33078),B=n(33094),N=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.postRootKeyDownHandler=function(e){switch(Object(s.normalizeKey)(e.key)){case s.KeyboardKey.Enter:case s.KeyboardKey.Space:e.currentTarget===e.target&&r.props.parent&&(r.props.onCollapseParent(r),e.stopPropagation(),e.preventDefault())}},r.onDraftEmptinessChanged=function(e){r.props.onDraftEmptinessChanged(r,e)},r.onEditorMount=function(){r.props.onPostEditorMounted(r.props.id)},r.reactionButtonProps=Object(a.memoizeFunction)((function(e,t,n,r,o,i){return{commentId:e,isTabbable:n,onReactionPressed:r.onReactionPressed,renderContextType:t,usersByReactionType:o,buttonStrings:i}})),r.reactionButtonStrings=Object(a.memoizeFunction)((function(){return{buttonLabel:r.props.localizationAPI.getString(231),buttonLabelPlural:r.props.localizationAPI.getString(239),buttonA11yDropdownText:r.props.localizationAPI.getString(240)}})),r.getDisplayErrorProps=Object(a.memoizeFunction)((function(e,t,n){var o=r.props.localizationAPI.getString(183),i=E.getPostWarningId({id:t,renderContextType:n});return r.getPostWarningProps(e,o,i)})),r.getLowFidelityWarningProps=Object(a.memoizeFunction)((function(e,t,n,o){var i=E.getLowFidelityWarningId({id:n,renderContextType:o});return r.getPostWarningProps(e,t,i)})),r.renderWithContexts=function(e){switch(r.styles=Object(T.getStyles)(!!r.props.parent,r.shouldUseFocusStyle(),null==e?void 0:e.colors,null==e?void 0:e.styles),r.defaultEditorProps=r.getDefaultEditorProps(null==e?void 0:e.colors),r.props.postDisplayMode){case v.default.LowFidelityWarningDelete:case v.default.LowFidelityWarningEdit:return r.renderLowFidelityWarningState();case v.default.Editing:case v.default.EditPreCommitPending:return r.renderEditState();case v.default.Resolved:return r.renderResolvedState();case v.default.Normal:case v.default.PendingDraft:return r.renderNormalState();case v.default.PendingEdit:return r.renderPendingEditState();case v.default.Error:return r.renderPostErrorState();case v.default.New_nonFluent:throw new f.CommentError(h.UnrecognizedPostDisplayMode,o.TelemetryTag.reserveTag(589103702),-2130957558);default:return Object(o.unreachable)(r.props.postDisplayMode),null}},r.state={hover:!1,actionBarItems:[]},r.postFocusHandler=r.postFocusHandler.bind(r),r.postClickHandler=r.postClickHandler.bind(r),r.renderCommentEditor=r.renderCommentEditor.bind(r),r.commitHandler=r.commitHandler.bind(r),r.commentEditorKeyDownHandler_deprecated=r.commentEditorKeyDownHandler_deprecated.bind(r),r.editorComponentRef=r.editorComponentRef.bind(r),r.postEditingKeyDownHandler_deprecated=r.postEditingKeyDownHandler_deprecated.bind(r),r.onMouseLeavePost=r.onMouseLeavePost.bind(r),r.onMouseOverPost=r.onMouseOverPost.bind(r),r.onEditorCommitRequested=r.onEditorCommitRequested.bind(r),r.onContextMenuInteractionHandler=r.onContextMenuInteractionHandler.bind(r),r.trySelectPost=r.trySelectPost.bind(r),r.getDisplayErrorProps=r.getDisplayErrorProps.bind(r),r.onRetry=r.onRetry.bind(r),r.defaultEditorProps=r.getDefaultEditorProps(),r}return Object(r.__extends)(t,e),t.prototype.getDefaultEditorProps=function(e){var t=this.props.componentTreeId.renderContextType,n=Object(_.getTruncationTextOverlayColor)(this.props.postDisplayMode===v.default.Resolved,!!this.props.cardSelected,e);return Object(r.__assign)(Object(r.__assign)({id:E.getPostEditorId({id:this.props.id,renderContextType:t}),isDraftEmpty:void 0,componentRef:this.editorComponentRef},this.props.mentionableEditorProps),{accessibilityLabel:I.getPostEditorA11yLabel(this.props.localizationAPI),accessibilityDescribedBy:E.getEditorBoxDescriptionId({id:this.props.id,renderContextType:t}),displayMode:b.default.ReadOnly,defaultValue:this.props.commentBody,scrollingContainerId:this.props.scrollingContainerId,supportsAtMentions:this.props.supportsAtMentions,richTextCapabilities:this.props.richTextCapabilities,truncationOverlayColor:m.isWebThemeIntegrationEnabled()?n:this.props.truncationOverlayColor,dulledAtMentions:this.props.dulledAtMentions,localizationAPI:this.props.localizationAPI,commentId:this.props.id})},t.prototype.editorComponentRef=function(e){this._textEditorRef=e},t.prototype.onMouseOverPost=function(){this.props.collapsed||this.setState({hover:!0})},t.prototype.onMouseLeavePost=function(){this.props.collapsed||this.setState({hover:!1})},t.prototype.UNSAFE_componentWillMount=function(){this.setState({actionBarItems:this.getActionBarItemsAsButtonProps(this.props)})},t.prototype.onContextMenuInteractionHandler=function(e){this.trySelectPost(),e&&Object(s.normalizeKey)(e.key)===s.KeyboardKey.ArrowDown&&e.preventDefault()},t.prototype.componentDidCatch=function(e){this.onError(e)},t.prototype.UNSAFE_componentWillReceiveProps=function(e){this.props.actionBarItems===e.actionBarItems&&this.props.isTabbable===e.isTabbable||this.setState({actionBarItems:this.getActionBarItemsAsButtonProps(e)})},t.prototype.componentDidUpdate=function(e,t){var n=this.isEditingOrPending(this.props.postDisplayMode);if(this.props.draftId&&!n&&Object(i.getTelemetryAPI)().assertConditionTag(!1,"PostDisplayMode inconsistent with draft warning state",593802317),this.textEditorRef&&this.isEditingOrPending(e.postDisplayMode)&&this.props.hasDraftInOtherRenderContext&&this.props.onSaveDraft(this.getId(),this.textEditorRef),this.textEditorRef&&!n&&(e.commentBody!==this.props.commentBody||!this.props.collapsed&&e.collapsed))try{this.textEditorRef.setContents(this.props.commentBody)}catch(c){this.onError(c instanceof Error?c:new Error(Object(o.stringifyError)(c)))}if(e.isTabbable!==this.props.isTabbable&&m.areHyperlinksSupportedInComments()){var r=document.getElementById(E.getPostRootId({id:this.props.id,renderContextType:this.props.componentTreeId.renderContextType}));if(r)for(var a=r.getElementsByClassName(B.HyperLink.className),s=0;s<a.length;s++){var l=this.props.isTabbable?"0":"-1";a[s].setAttribute("tabIndex",l)}}Object(i.getTelemetryAPI)().assertConditionTag(void 0===this.props.draftId||this.isEditingOrPending(this.props.postDisplayMode),"post has draft state and is not in editing mode",593802318)},t.prototype.onRetry=function(){this.props.onClearError(this)},t.prototype.onError=function(e){Object(p.makeAssertErrorHandler)(o.TelemetryTag.reserveTag(594351964))(e),this.props.onError(this)},t.prototype.postFocusHandler=function(e){var t=document.getElementById(E.getPostRootId({id:this.props.id,renderContextType:this.props.componentTreeId.renderContextType}));t&&e.target===t&&(Object(w.isDisplayModeLowFidelity)(this.props.postDisplayMode)||this.props.selected||this.props.collapsed||this.props.onSelect(this,!1))},t.prototype.trySelectPost=function(){Object(w.isDisplayModeLowFidelity)(this.props.postDisplayMode)||this.props.selected||this.props.onSelect(this,!1)},t.prototype.postClickHandler=function(e){this.trySelectPost(),e.stopPropagation()},t.prototype.commitHandler=function(e){this.props.onCommit(this,e)},t.prototype.getBodyStyle=function(){return this.styles.body},t.prototype.renderCommitBar=function(){return l.createElement(S.CommitBar,{buttons:this.state.actionBarItems,tooltipDirection:a.DirectionalHint.bottomCenter})},t.prototype.postEditingKeyDownHandler_deprecated=function(e){if(Object(s.normalizeKey)(e.key)===s.KeyboardKey.Tab){var t=document.getElementById(E.getActionBarButtonId({id:this.props.id,renderContextType:this.props.componentTreeId.renderContextType},this.props.actionBarItems.length-1));e.target!==t||e.shiftKey||(this.textEditorRef&&this.textEditorRef.focus(),e.stopPropagation(),e.preventDefault())}},t.prototype.commentEditorKeyDownHandler_deprecated=function(e){if(Object(s.normalizeKey)(e.key)===s.KeyboardKey.Tab){var t=e.shiftKey?this.props.actionBarItems.length-1:0,n=document.getElementById(E.getActionBarButtonId({id:this.props.id,renderContextType:this.props.componentTreeId.renderContextType},t));n&&n.focus(),e.stopPropagation()}},t.prototype.onEditorCommitRequested=function(){this.commitHandler(y.default.KeyboardShortcut)},t.prototype.renderBlueDot=function(){return Object(x.shouldRenderBlueDot)(this.props)?l.createElement(O.BlueDot,{dotType:this.props.parent?g.default.RootPost:g.default.ReplyPost,hasTaskTopper:this.shouldShowHistoryItemTaskHeader(),renderContextType:this.props.componentTreeId.renderContextType}):null},t.prototype.renderCommentEditor=function(e){var t=this.styles.editorRestContainer,n=void 0;return e.displayMode===b.default.Editing&&(t=this.styles.editorEditingContainer,n=l.createElement("div",{id:E.getEditorBoxDescriptionId({id:this.props.id,renderContextType:this.props.componentTreeId.renderContextType}),style:{display:"none"}},this.props.localizationAPI.getString(56))),l.createElement("div",{className:t},l.createElement(P.default,Object(r.__assign)({onKeyDown:m.shouldUseNewSelectionInteractions()?void 0:this.commentEditorKeyDownHandler_deprecated},e,this.props.mentionableEditorProps)),n)},t.prototype.renderHeader=function(){return this.props.parent?null:l.createElement(D.default,Object(r.__assign)({},this.getRenderableItemHeaderProps()))},t.prototype.renderPersona=function(){return this.props.parent?null:l.createElement(M.default,Object(r.__assign)({},this.getRenderableItemPersonaProps()))},t.prototype.getRootDivProps=function(){return{className:Object(a.css)(this.styles.container),tabIndex:this.props.isTabbable?0:-1,onFocus:this.postFocusHandler,onClick:this.postClickHandler,id:E.getPostRootId({id:this.props.id,renderContextType:this.props.componentTreeId.renderContextType}),onKeyDown:this.postRootKeyDownHandler}},t.prototype.getRenderableItemPersonaProps=function(){return{authorName:Object(u.getUsername)(this.props.author),resolved:this.props.postDisplayMode===v.default.Resolved,isParent:!!this.props.parent,authorColor:this.props.authorColor,authorImageURL:this.props.authorImageURL}},t.prototype.getRenderableItemHeaderProps=function(){var e=this.props.parent||this.props.collapsed||this.props.postDisplayMode!==v.default.Normal&&this.props.postDisplayMode!==v.default.Resolved||!(this.state.hover||this.props.selected),t=this.props.usersByReactionType&&this.props.usersByReactionType[c.ReactionType.Like]?this.props.usersByReactionType[c.ReactionType.Like]:[],n=this.props.componentTreeId.renderContextType;return{authorLine:Object(u.getUsername)(this.props.author),renderContextType:n,contextMenuProps:e||0===this.props.actionBarItems.length?void 0:{menuItems:[],actionBarItems:this.props.actionBarItems,isTabbable:this.props.isTabbable,parentId:this.props.id,trySelectPost:this.trySelectPost,localizationAPI:this.props.localizationAPI},likeButtonProps:(e||this.props.preventReacting)&&0===t.length?void 0:this.reactionButtonProps(this.props.id,n,this.props.isTabbable,{onReactionPressed:this.props.onReactionUpdated},this.props.usersByReactionType,this.reactionButtonStrings())}},t.prototype.shouldUseFocusStyle=function(){return(m.shouldUseNewSelectionInteractions()||!this.isEditingOrPending(this.props.postDisplayMode)&&!this.props.restrictActionControls_deprecated)&&this.props.selected},t.prototype.getPostWarningProps=function(e,t,n){return{buttons:e,warningMessage:t,id:n,hideCardHeader:this.props.onHideCardHeader}},t.prototype.renderEditState=function(){var e=I.getPostEditorA11yLabel(this.props.localizationAPI),t=Object(r.__assign)(Object(r.__assign)({},this.defaultEditorProps),{defaultValue:this.props.commentBody,displayMode:b.default.Editing,initialDraftContent:this.props.savedDraftContent,isDraftEmpty:this.props.isDraftEmpty,isTabbable:this.props.isTabbable,onCommitRequested:this.onEditorCommitRequested,onEscapeRequested:this.onFocusParent,onDraftEmptinessChanged:this.onDraftEmptinessChanged,accessibilityLabel:e,onMount:this.onEditorMount});return l.createElement("div",Object(r.__assign)({role:"treeitem","aria-label":this.props.accessibilityLabel,"aria-describedby":t.id,"aria-selected":this.props.selected,"aria-level":2},this.getRootDivProps()),this.renderPersona(),this.renderBlueDot(),l.createElement("div",{className:this.getBodyStyle(),onKeyDown:m.shouldUseNewSelectionInteractions()?void 0:this.postEditingKeyDownHandler_deprecated},this.renderHeader(),this.renderHistoryItemContent(),this.renderCommentEditor(t),l.createElement("div",{className:this.styles.actionbarEdit},this.renderCommitBar()),this.renderDraftBoxMessage(!1)))},t.prototype.renderLowFidelityWarningState=function(){var e=this.getLowFidelityWarningProps(this.state.actionBarItems,this.props.lowFidelityWarningString,this.props.id,this.props.componentTreeId.renderContextType);return this.renderPostWarning(e,this.props.accessibilityLabel)},t.prototype.renderPostErrorState=function(){var e=this.getDisplayErrorProps(this.state.actionBarItems,this.props.id,this.props.componentTreeId.renderContextType);return this.renderPostWarning(e,this.props.localizationAPI.getString(183))},t.prototype.renderPostWarning=function(e,t){return l.createElement("div",Object(r.__assign)({role:"treeitem","aria-describedby":e.id,"aria-label":t,"aria-selected":this.props.selected,"aria-level":2},this.getRootDivProps()),l.createElement(j.PostWarning,Object(r.__assign)({},e)))},t.prototype.renderResolvedState=function(){var e=Object(r.__assign)(Object(r.__assign)({},this.defaultEditorProps),{displayMode:b.default.Disabled,showFullComment:!this.props.collapsed,defaultValue:this.props.commentBody,dulledAtMentions:this.props.dulledAtMentions});return l.createElement("div",Object(r.__assign)({role:"treeitem","aria-label":this.props.accessibilityLabel,"aria-describedby":e.id,"aria-selected":this.props.selected,"aria-level":2,onMouseOver:this.onMouseOverPost,onMouseLeave:this.onMouseLeavePost},this.getRootDivProps()),this.renderPersona(),this.renderBlueDot(),l.createElement("div",{className:this.getBodyStyle()},l.createElement("div",null," ",this.renderHeader()," "),this.renderHistoryItemContent(),this.renderCommentEditor(e),this.renderTimestamp()))},t.prototype.renderNormalState=function(){var e=Object(r.__assign)(Object(r.__assign)({},this.defaultEditorProps),{displayMode:b.default.ReadOnly,showFullComment:!this.props.collapsed,defaultValue:this.props.commentBody});return l.createElement("div",Object(r.__assign)({role:"treeitem","aria-label":this.props.accessibilityLabel,"aria-describedby":e.id,"aria-selected":this.props.selected,"aria-level":2},this.getRootDivProps(),{onMouseOver:this.onMouseOverPost,onMouseLeave:this.onMouseLeavePost}),this.renderPersona(),this.renderBlueDot(),l.createElement("div",{className:this.getBodyStyle()},this.renderHeader(),this.renderHistoryItemContent(),this.renderCommentEditor(e),this.renderTimestamp()))},t.prototype.renderPendingEditState=function(){var e=this,t={id:E.getPostEditorId({id:this.props.id,renderContextType:this.props.componentTreeId.renderContextType}),isDraftEmpty:void 0,componentRef:function(t){return e._textEditorRef=t},displayMode:b.default.ReadOnly,showFullComment:!this.props.collapsed,defaultValue:this.props.commentBody,accessibilityLabel:this.props.localizationAPI.getString(88),localizationAPI:this.props.localizationAPI};return l.createElement("div",Object(r.__assign)({style:{position:"relative"}},this.getRootDivProps()),this.renderPersona(),this.renderBlueDot(),l.createElement("div",{className:this.getBodyStyle()},this.renderHeader(),this.renderHistoryItemContent(),this.renderCommentEditor(t),this.renderTimestamp()),l.createElement("div",{className:this.styles.postOverlay},l.createElement(a.DelayedRender,{delay:_.SPINNER_DELAY_MS},l.createElement(a.Spinner,{className:this.styles.postSpinner,size:a.SpinnerSize.large}))))},t.prototype.render=function(){return m.isWebThemeIntegrationEnabled()?Object(A.consumeContexts)(this.renderWithContexts,d.SemanticStylesProviderContext):this.renderWithContexts()},t}(C.default),L=Object(R.wrapContextualizedComponent)(N,{componentTreeId:k.ComponentTreeIdContext},C.default.DisplayName);t.default=L},33133:function(e,t,n){"use strict";n.r(t);var r=n(562),o=n(245),i=n(30997),a=n(32949),s=n(32956),l=n(32957),c=n(32964),u=n(32967),d=n(33134),p=n(33135),f=n(31038),h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onFocusParent=function(){return t.props.onFocusParent(t)},t.saveDraftIfEditing=function(e){t.isEditingOrPending(t.props.postDisplayMode)&&t.props.onSaveDraft(t.getId(),e)},t}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"textEditorRef",{get:function(){return this._textEditorRef},enumerable:!1,configurable:!0}),t.prototype.componentDidMount=function(){this.props.onPostMounted(this.props.id)},t.prototype.componentWillUnmount=function(){this.textEditorRef&&this.saveDraftIfEditing(this.textEditorRef)},t.prototype.setContents=function(e){this.textEditorRef&&this.textEditorRef.setContents(e)},t.prototype.getContentsAsync=function(){return this.textEditorRef?this.textEditorRef.getContentsAsync():Promise.resolve("")},t.prototype.getCursorPositionAsync=function(){return this.textEditorRef?this.textEditorRef.getCursorPositionAsync():Promise.resolve(void 0)},t.prototype.getId=function(){return this.props.id},t.prototype.isEditingOrPending=function(e){return e===a.default.Editing||e===a.default.EditPreCommitPending},t.prototype.renderTimestamp=function(){if(!this.props.collapsed&&this.props.postDisplayMode!==a.default.New_nonFluent&&!this.isEditingOrPending(this.props.postDisplayMode)){var e=this.props.componentTreeId.renderContextType;return o.createElement(p.RenderableItemTimestamp,Object(r.__assign)({},{timestamp:this.props.timestamp,id:Object(f.getPostTimeStampId)({id:this.props.id,renderContextType:e}),renderContextType:e,resolved:this.props.postDisplayMode===a.default.Resolved}))}},t.prototype.getActionBarItemsAsButtonProps=function(e){var t=this;return e.actionBarItems.map((function(n,o){n.id,n.onClick;var i=Object(r.__rest)(n,["id","onClick"]);return Object(r.__assign)(Object(r.__assign)({},i),{id:Object(f.getActionBarButtonId)({id:e.id,renderContextType:t.props.componentTreeId.renderContextType},o),onClick:function(){return n.onClick(t)},onKeyDown:function(e){var r;return null===(r=n.onKeyDown)||void 0===r?void 0:r.call(n,e,t)},isTabbable:e.isTabbable})}))},t.prototype.shouldShowHistoryItemTaskHeader=function(){return!!this.props.taskHistoryProps&&!this.props.collapsed&&i.areCommentTasksEnabled()},t.prototype.getHistoryItemContentFullProps=function(e){return Object(r.__assign)(Object(r.__assign)({},e),{renderContextType:this.props.componentTreeId.renderContextType})},t.prototype.renderHistoryItemContent=function(){if(this.props.taskHistoryProps&&this.shouldShowHistoryItemTaskHeader())return o.createElement(d.default,Object(r.__assign)({},this.getHistoryItemContentFullProps(this.props.taskHistoryProps)))},t.prototype.renderDraftBoxMessage=function(e){if(!i.isNewDraftingUIEnabled())return null;var t=this.props.draftWarningState;return i.isUseDraftBoxMessageEnabled()?t||e?o.createElement(c.DraftBoxMessage,{key:"draftBoxMessage",draftWarningState:t,localizationAPI:this.props.localizationAPI,target:s.DraftBoxMessageTarget.Post,id:t?Object(f.getDraftWarningId)({id:this.props.id,renderContextType:this.props.componentTreeId.renderContextType}):Object(f.getPostingTipId)({id:this.props.id,renderContextType:this.props.componentTreeId.renderContextType}),defaultToPostingTip:e}):null:t?o.createElement(u.DraftWarning,{key:"draftWarning",draftWarningState:t,localizationAPI:this.props.localizationAPI,target:l.DraftWarningTarget.Post,id:Object(f.getDraftWarningId)({id:this.props.id,renderContextType:this.props.componentTreeId.renderContextType})}):null},t.DisplayName="CommentPost",t}(o.PureComponent);t.default=h},33134:function(e,t,n){"use strict";n.r(t);var r=n(30123),o=n(245),i=n(32926),a=n(32934),s=n(32975);var l=o.memo((function(e){var t,n=null===(t=Object(i.useSemanticStylesProvider)())||void 0===t?void 0:t.colors,l=function(e){switch(e){case 13:case 14:return"TaskAssign";case 15:return"TaskComplete";case 21:return"TaskReopen";case 17:return"TaskEdit";case 18:return"TaskDelete";default:return}}(e.icon),c=Object(s.getStyles)(n),u=o.createElement("div",null,o.createElement("div",{className:c.container},l&&o.createElement(r.Icon,{iconName:l,className:c.icon}),o.createElement("div",{className:c.body},e.description)));return o.createElement(r.TooltipHost,{content:e.description,directionalHint:r.DirectionalHint.bottomCenter,tooltipProps:a.commentTooltipProps},u)}));t.default=l},33135:function(e,t,n){"use strict";n.r(t);var r=n(33136);n.d(t,"RenderableItemTimestamp",(function(){return r.RenderableItemTimestamp}))},33136:function(e,t,n){"use strict";n.r(t),n.d(t,"RenderableItemTimestamp",(function(){return a}));var r=n(245),o=n(32926),i=n(33137),a=r.memo((function(e){var t,n=null===(t=Object(o.useSemanticStylesProvider)())||void 0===t?void 0:t.colors,a=Object(i.getStyles)(n);return r.createElement("div",{className:a.body,id:e.id},e.timestamp)}))},33137:function(e,t,n){"use strict";n.r(t),n.d(t,"getStyles",(function(){return i}));var r=n(30123),o=n(30993),i=Object(r.memoizeFunction)((function(e){var t;return{body:Object(r.mergeStyles)({fontFamily:"inherit",color:null!==(t=null==e?void 0:e.SubText)&&void 0!==t?t:o.OfficeColors.GRAY_E,fontWeight:"normal",fontSize:"11px",lineHeight:18,marginLeft:"3px",userSelect:"text"})}}))},33138:function(e,t,n){"use strict";n.r(t),n.d(t,"EDITOR_MARGIN_RIGHT",(function(){return l})),n.d(t,"getStyles",(function(){return c}));var r=n(30123),o=n(766),i=n(30993),a=n(32931),s=n(30994),l=6,c=Object(r.memoizeFunction)((function(e,t,n,c){var u,d,p,f;return{actionbarEdit:Object(r.mergeStyles)({maxHeight:"30px",marginTop:"5px",display:"flex",flexDirection:"row",flexWrap:"nowrap",overflow:"hidden",alignSelf:"flex-end"}),body:Object(r.mergeStyles)({display:"flex",direction:"inherit",flexDirection:"column",flexGrow:1,marginTop:"6px",marginBottom:"2px",marginRight:l,position:"relative",overflow:"hidden"},e?{marginLeft:"14px",marginRight:"14px",marginTop:"0px"}:{paddingLeft:"3px"}),container:Object(r.mergeStyles)({display:"flex",direction:"inherit",overflow:"hidden",flexGrow:1,flexDirection:"row",flexWrap:"nowrap",flexShrink:0,margin:0,marginLeft:"2px",marginRight:"2px",border:0,position:"relative",selectors:{":focus":t?{outline:"none",borderRadius:"1px",boxShadow:"0px 0px 0px 1px ".concat(i.OfficeColors.FOCUS_BOX),selectors:(u={},u[r.HighContrastSelector]={boxShadow:"none",outline:"1px solid ".concat(i.OfficeColors.FOCUS_BOX)},u)}:{outline:"none"}}},e?{marginTop:"2px",overflow:"visible",backgroundColor:"transparent"}:{}),postOverlay:Object(r.mergeStyles)({position:"absolute",zIndex:10,left:0,top:0,right:0,bottom:0,backgroundColor:null!==(d=null==c?void 0:c.PostOverlay)&&void 0!==d?d:"rgba(255,255,255,0.5)"}),postSpinner:Object(r.mergeStyles)({position:"absolute",zIndex:20,left:"50%",top:"50%",marginLeft:"-20px",marginTop:"-20px",selectors:{"& .ms-Spinner-circle":{borderColor:a.spinnerBackgroundColor,borderTopColor:a.spinnerPrimaryColor}}}),editorEditingContainer:Object(r.mergeStyles)({display:"flex",margin:"0px",marginBottom:"4px",backgroundColor:null!==(p=null==n?void 0:n.CardBackground)&&void 0!==p?p:"#FFFFFF",border:"1px solid",borderColor:null!==(f=null==n?void 0:n.CommonControlBorder)&&void 0!==f?f:o.NeutralColors.gray110,borderRadius:s.DEFAULT_BORDER_RADIUS,userSelect:"text",padding:0}),editorRestContainer:Object(r.mergeStyles)({display:"flex",marginRight:"2px",backgroundColor:"transparent",userSelect:"text",padding:"1px",paddingTop:e?"0px":"2px",border:0}),lowFidelityWarning:Object(r.mergeStyles)({display:"flex",marginLeft:"4px",fontFamily:"inherit",fontSize:"12px",fontWeight:"normal",fontStyle:"italic",borderStyle:"dotted",borderColor:"red",borderWidth:"2px",whiteSpace:"normal"})}}))},33139:function(e,t,n){"use strict";n.r(t),n.d(t,"isDisplayModeLowFidelity",(function(){return o}));var r=n(32949);function o(e){return e===r.default.LowFidelityWarningDelete||e===r.default.LowFidelityWarningEdit}},33140:function(e,t,n){"use strict";n.r(t),n.d(t,"PostWarning",(function(){return f}));var r=n(562),o=n(30010),i=n(30123),a=n(245),s=n(32926),l=n(30997),c=n(33141),u=n(32932),d=n(32933),p=n(33145),f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.getIconProps=Object(o.memoizeOnce)((function(e){return{iconName:Object(u.getIconName)(19),styles:e.errorIconStyles}})),t.renderWithContexts=function(e){return t.styles=Object(l.isWebThemeIntegrationEnabled)()?Object(p.getBoundaryStyles)(null==e?void 0:e.colors):Object(p.getBoundaryStyles)(void 0),a.createElement("div",{className:t.styles.errorWrapper},a.createElement(i.Icon,Object(r.__assign)({},t.getIconProps(t.styles),{tabIndex:-1})),a.createElement("div",{className:t.styles.errorMessageContainer},a.createElement("div",{id:t.props.id,className:t.styles.errorMessage},t.props.warningMessage),a.createElement(c.CommentActionBar,{isVisible:!0,actions:t.props.buttons})))},t}return Object(r.__extends)(t,e),t.prototype.componentDidMount=function(){this.props.hideCardHeader&&this.props.hideCardHeader(!0)},t.prototype.componentWillUnmount=function(){this.props.hideCardHeader&&this.props.hideCardHeader(!1)},t.prototype.render=function(){return Object(l.isWebThemeIntegrationEnabled)()?Object(d.consumeContexts)(this.renderWithContexts,s.SemanticStylesProviderContext):this.renderWithContexts()},t}(a.PureComponent)},33141:function(e,t,n){"use strict";n.r(t);var r=n(33142);n.d(t,"CommentActionBar",(function(){return r.CommentActionBar}))},33142:function(e,t,n){"use strict";n.r(t),n.d(t,"CommentActionBar",(function(){return a}));var r=n(562),o=n(245),i=n(33143),a=function(e){function t(t){var n=e.call(this,t)||this;return n.state={content:[]},n}return Object(r.__extends)(t,e),t.prototype.UNSAFE_componentWillMount=function(){this.setState({content:this.generateRenderedContent(this.props.actions)})},t.prototype.UNSAFE_componentWillReceiveProps=function(e){e.actions!==this.props.actions&&this.setState({content:this.generateRenderedContent(e.actions)})},t.prototype.generateRenderedContent=function(e){return e.map((function(e,t){return o.createElement(i.ActionBarButton,Object(r.__assign)({key:t},e))}))},t.prototype.render=function(){return this.props.isVisible?o.createElement("div",null,this.state.content):o.createElement("div",null)},t}(o.PureComponent)},33143:function(e,t,n){"use strict";n.r(t),n.d(t,"ActionBarButton",(function(){return u}));var r=n(562),o=n(30123),i=n(245),a=n(32926),s=n(30997),l=n(32933),c=n(33144),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.renderWithContexts=function(e){var n=Object(c.getActionBarButtonStyles)(null==e?void 0:e.colors),a={id:t.props.id,disabled:t.props.disabled,onClick:function(e){e.stopPropagation(),t.props.onClick&&t.props.onClick(e)},ariaLabel:t.props.accessibilityLabel,tabIndex:t.props.isTabbable?void 0:-1};return i.createElement(o.ActionButton,Object(r.__assign)({},a,{styles:n}),t.props.text)},t}return Object(r.__extends)(t,e),t.prototype.render=function(){return Object(s.isWebThemeIntegrationEnabled)()?Object(l.consumeContexts)(this.renderWithContexts,a.SemanticStylesProviderContext):this.renderWithContexts()},t}(i.PureComponent)},33144:function(e,t,n){"use strict";n.r(t),n.d(t,"getActionBarButtonStyles",(function(){return a}));var r=n(30123),o=n(30997),i=n(30994),a=Object(r.memoizeFunction)((function(e){var t,n,a,s;return{root:{maxHeight:"12px",marginRight:"6px",padding:0,color:null!==(n=null==e?void 0:e.PrimaryButton)&&void 0!==n?n:"#2B5C9C",fontSize:"11px",fontWeight:"600",fontFamily:"inherit",lineHeight:1.4,overflow:"visible",border:"1px solid transparent",selectors:(t={".ms-Fabric--isFocusVisible &:focus::after":i.fabricFocusSelectorStyles},t[r.HighContrastSelector]={outline:"auto"},t)},rootHovered:Object(r.mergeStyles)({color:null!==(a=null==e?void 0:e.PrimaryButtonHovered)&&void 0!==a?a:"#333333"},i.commonHighContrastHoverStyles),rootPressed:Object(o.isWebThemeIntegrationEnabled)()?Object(r.mergeStyles)({color:null==e?void 0:e.PrimaryButtonPressed}):void 0,rootFocused:Object(r.mergeStyles)({color:null!==(s=null==e?void 0:e.PrimaryButton)&&void 0!==s?s:"#333333",outline:"none",border:"1px dotted"},i.commonHighContrastFocusStyles),label:{margin:0}}}))},33145:function(e,t,n){"use strict";n.r(t),n.d(t,"getBoundaryStyles",(function(){return i}));var r=n(30123),o=n(30993),i=Object(r.memoizeFunction)((function(e){var t;return{errorWrapper:Object(r.mergeStyles)({display:"flex",direction:"inherit",flexDirection:"row",marginTop:"6px",marginRight:"8px",position:"relative",width:"100%"}),errorMessageContainer:Object(r.mergeStyles)({display:"flex",direction:"inherit",flexDirection:"column",marginLeft:"10px",marginRight:"8px",width:"100%"}),errorMessage:Object(r.mergeStyles)({fontSize:"12px",paddingLeft:"1px",color:null!==(t=null==e?void 0:e.Text)&&void 0!==t?t:o.OfficeColors.ACTIVE_COMMENT_TEXT,textAlign:"left",fontFamily:"inherit",marginRight:"8px",marginBottom:"3px",display:"flex",fontWeight:"normal",whiteSpace:"normal"}),errorIconStyles:{root:{width:"16px",fontSize:"16px",marginTop:"4px",marginLeft:"11px"}}}}))},33146:function(e,t,n){"use strict";n.r(t),n.d(t,"TaskHistoryItem",(function(){return p}));var r=n(30123),o=n(245),i=n(31109),a=n(30997),s=n(31038),l=n(33076),c=n(33078),u=n(33147),d=n(33148),p=o.memo(o.forwardRef((function(e,t){var n=e.accessibilityLabel,p=e.author,f=e.resolved,h=e.authorColor,m=e.authorImageURL,y=e.selected,g=e.onSelect,b=Object(u.useTaskHistoryItemRenderHooks)(e,t),v=b.componentTreeId,C=b.renderHistoryItemContent,T=b.renderTimestamp,O=b.imperativeHandle,S=v.renderContextType,P=o.useRef(null),x=o.useCallback((function(){return o.createElement(c.default,{authorName:Object(i.getUsername)(p),resolved:f,isParent:!1,authorColor:h,authorImageURL:m})}),[p,f,h,m]),I=o.useCallback((function(){return o.createElement(l.default,{authorLine:Object(i.getUsername)(p),renderContextType:v.renderContextType,contextMenuProps:{menuItems:[],actionBarItems:[],isTabbable:!1,parentId:"",trySelectPost:function(){},localizationAPI:void 0}})}),[v,p]),E=o.useCallback((function(e){var t=P.current;t&&e.target===t&&(y||g(O,!1))}),[P,y,g,O]),A=o.useCallback((function(e){y||g(O,!1),e.stopPropagation()}),[y,g,O]),k=Object(d.getStyles)(),w=function(e,t){return(a.shouldUseNewSelectionInteractions()||!t)&&e}(y,e.restrictActionControls_deprecated)?k.container:k.containerNoFocus;return o.createElement("div",{role:"treeitem","aria-label":n,"aria-level":2,"aria-selected":y,className:Object(r.css)(w),ref:P,tabIndex:y?0:-1,onFocus:E,onClick:A,id:Object(s.getPostRootId)({id:e.id,renderContextType:S})},x(),o.createElement("div",{className:k.body},I(),C(),e.collapsed?void 0:T()))})))},33147:function(e,t,n){"use strict";n.r(t),n.d(t,"useTaskHistoryItemRenderHooks",(function(){return l}));var r=n(245),o=n(31038),i=n(32961),a=n(33134),s=n(33135);function l(e,t){var n=e.id,l=e.timestamp,c=e.icon,u=e.description,d=Object(i.useComponentTreeIdContext)(),p=r.useCallback((function(){return n}),[n]),f=r.useCallback((function(){return r.createElement(s.RenderableItemTimestamp,{timestamp:l,id:Object(o.getPostTimeStampId)({id:n,renderContextType:d.renderContextType}),renderContextType:d.renderContextType})}),[n,l,d]),h=r.useCallback((function(){return r.createElement(a.default,{icon:c,description:u,renderContextType:d.renderContextType})}),[c,u,d]),m=r.useMemo((function(){return{getId:p}}),[p]);return Object(r.useImperativeHandle)(t,(function(){return m}),[m]),{getId:p,renderTimestamp:f,renderHistoryItemContent:h,componentTreeId:d,imperativeHandle:m}}},33148:function(e,t,n){"use strict";n.r(t),n.d(t,"getStyles",(function(){return l}));var r=n(30123),o=n(33138),i=n(30993),a=Object(r.memoizeFunction)((function(e){var t;return e?{outline:"none",borderRadius:"1px",boxShadow:"0px 0px 0px 1px ".concat(i.OfficeColors.FOCUS_BOX),selectors:(t={},t[r.HighContrastSelector]={boxShadow:"none",outline:"1px solid ".concat(i.OfficeColors.FOCUS_BOX)},t)}:{outline:"none"}})),s={display:"flex",direction:"inherit",overflow:"hidden",flexGrow:1,flexDirection:"row",flexWrap:"nowrap",flexShrink:0,marginLeft:"2px",marginRight:"2px",border:0,position:"relative"},l=Object(r.memoizeFunction)((function(){return{body:Object(r.mergeStyles)({display:"flex",direction:"inherit",flexDirection:"column",flexGrow:1,marginTop:"6px",marginBottom:"2px",marginRight:o.EDITOR_MARGIN_RIGHT,paddingLeft:"3px",position:"relative",overflow:"hidden"}),container:Object(r.mergeStyles)(s,{selectors:{":focus":a(!0)}}),containerNoFocus:Object(r.mergeStyles)(s,{selectors:{":focus":a(!1)}})}}))},33149:function(e,t,n){"use strict";n.r(t),n.d(t,"AccessibilityStringHelpers",(function(){return i}));var r=n(30061),o=n(32949),i={getCardA11yLabel:n(33150).getCardA11yLabel,getPostA11yLabel:function(e,t,n,r,i){var a=void 0,s=i.author,l=i.timestamp,c=i.isUnread;switch(a=c?145:21,n&&(a=c?137:25),t){case o.default.Editing:case o.default.EditPreCommitPending:a=23;break;case o.default.Resolved:a=c?136:22;break;case o.default.LowFidelityWarningDelete:case o.default.LowFidelityWarningEdit:return r.getStringOrUndefined(26);case o.default.Normal:break;case o.default.New_nonFluent:default:return}return r.formatString(a,s,l)},getTaskHistoryItemA11yLabel:function(e,t,n){return t&&n?e.formatString(232,t,n):(Object(r.getTelemetryAPI)().assertConditionTag(!1,"Task History Item accessibility label not resolving properly",557056852),e.getString(119))}}},33150:function(e,t,n){"use strict";n.r(t),n.d(t,"getCardA11yLabel",(function(){return s}));var r=n(31109),o=n(31288),i=n(31289),a=n(32963);function s(e,t,n,s,l,c,u,d,p,f){if(t===o.default.Draft||t===o.default.DraftPreCommitPending)return s?e.formatString(224,s):e.getString(223);if(t===o.default.Loading)return e.getString(225);var h=[],m=c?a.isResolvedTask(c.completion):t===o.default.Resolved;if(c){var y=null==c?void 0:c.assignees[0];y?h.push(e.formatString(m?215:214,Object(r.getUsername)(y))):h.push(e.getString(m?217:216)),h.push(e.formatString(212,n))}else h.push(e.formatString(m?213:211,n));return s&&h.push(e.formatString(218,s)),t!==o.default.Reply&&u!==i.CardRelativeDraftingState.InChildPost||h.push(e.getString(222)),1===l?h.push(e.getString(219)):l>1&&h.push(e.formatString(220,String(l))),t!==o.default.CardPostCommitPending&&t!==o.default.ReplyPostCommitPending||h.push(e.getString(221)),d&&(h.push(e.getString(237)),h.push(e.getString(238))),h.join(e.getString(226))}},33151:function(e,t,n){"use strict";n.r(t),n.d(t,"LPPManagerContextError",(function(){return o})),n.d(t,"LPPManagerContext",(function(){return i}));var r=n(245),o="LPPManagerContext undefined. Did you forget to render a LPPManagerContext context provider?",i=r.createContext(new Proxy({},{get:function(){throw new Error(o)}}))},33152:function(e,t,n){"use strict";function r(e,t){if(!e&&t||e&&!t)return!1;if(!e&&!t)return!0;var n=Object.keys(e),r=Object.keys(t);return n.length===r.length&&n.every((function(n){return e[n]===t[n]}))}n.r(t),n.d(t,"areObjectsShallowEqual",(function(){return r}))},33153:function(e,t,n){"use strict";n.r(t),n.d(t,"getActionBarItems",(function(){return m})),n.d(t,"getCardContextualMenuItems",(function(){return y})),n.d(t,"getCardContextMenuItems",(function(){return g})),n.d(t,"getRenderableItemActionBarItems",(function(){return b}));var r=n(562),o=n(30061),i=n(31159),a=n(31121),s=n(30997),l=n(31415),c=n(31287),u=n(32946),d=n(32949),p=n(31038),f=n(31110),h=n(33139),m=function(e,t,n,r,o,i,l,p,m){if(Object(h.isDisplayModeLowFidelity)(t)&&n===c.LowFidelityWarningType.Edit)return[e.proceedItemForLowFidelityWarningEdit,e.cancelLowFidelityWarningEditItem];if(Object(h.isDisplayModeLowFidelity)(t)&&n===c.LowFidelityWarningType.DeleteReply)return[e.deleteItemForLowFidelityWarningDelete,e.cancelLowFidelityWarningDeleteItem];if(t===d.default.Error)return[e.retry,o?e.deleteRootItem:e.deleteItem];if(t===d.default.Resolved)return[];if(s.shouldFixReadOnlyEditingButtons()||!i){if(m&&t===d.default.EditPreCommitPending)return i?[]:[e.saveItemPending,e.cancelEditItem];if(t===d.default.Editing||t===d.default.EditPreCommitPending)return i?[]:[e.saveItem,e.cancelEditItem]}var y=[];return p&&y.push(e.linkToCommentMenuItem),i||r===u.AllowedDraftingSession.None||(r!==u.AllowedDraftingSession.Any||s.isQuickEditEnabled()||l&a.CommentFlags.EditRestricted||y.push(e.editItem),l&a.CommentFlags.DeleteRestricted||o||y.push(e.deleteItem),"ios"===Object(f.getPlatform)()&&y.length>0&&y.push(e.cancelItem)),y};function y(e,t,n,r,i,l,c,d){var p=[];if(c&&p.push(e.linkToComment),n===u.AllowedDraftingSession.None||s.shouldHideCardContextMenuForRootReadOnly()&&t&a.CommentFlags.ReadOnly)return p;var h=(t&a.CommentFlags.Resolved)>0,m=l?e.resolveTask:e.resolveThread,y=l?e.deleteTask:e.deleteThread;return Object(o.getTelemetryAPI)().assertConditionTag(r||!h,"Card cannot be resolved when resolved is not supported",593764383),h&&r?(p.push(e.reopenThread),t&a.CommentFlags.DeleteRestricted||p.push(y),p):(n!==u.AllowedDraftingSession.Any||!d||s.isQuickEditEnabled()||t&a.CommentFlags.EditRestricted||!s.shouldHideCardContextMenuForRootReadOnly()&&s.shouldFixReadOnlyEditingButtons()&&t&a.CommentFlags.ReadOnly||i||p.push(e.editRootPost),c&&r&&p.push(m),t&a.CommentFlags.DeleteRestricted||p.push(y),!c&&r&&p.push(m),"ios"===Object(f.getPlatform)()&&p.length>0&&p.push(e.cancel),p)}function g(e,t){var n={text:e.getString(5),icon:3,onClick:t.onDeleteThread,isDestructive:!0,tooltipText:e.getString(5)},o={text:e.getString(3),icon:5,onClick:t.onResolveThread},i=e.getString(4);return{deleteThread:n,resolveThread:o,reopenThread:{id:Object(p.getReopenThreadIdPrefix)(),text:i,icon:s.isCommentsFluentUIEnabled()?16:4,onClick:t.onReopenThread,tooltipText:i},cancel:{text:e.getString(15),icon:0,onClick:function(){},isCancelItem:!0},editRootPost:{text:e.getString(120),onClick:t.onEditRootPost,icon:6,accessibilityLabel:e.getStringOrUndefined(40)},linkToComment:{text:e.getString(207),onClick:t.onPresentLinkToComment,icon:25,tooltipText:e.getString(207)},deleteTask:Object(r.__assign)(Object(r.__assign)({},n),{text:e.getString(206),tooltipText:e.getString(206)}),resolveTask:{text:e.getString(126),icon:5,onClick:t.onResolveThread}}}function b(e,t){var n={text:e.getString(184),onClick:t.onClearError,icon:19,accessibilityLabel:e.getStringOrUndefined(184)},a={text:e.getString(5),onClick:t.onDelete,icon:3,accessibilityLabel:e.getStringOrUndefined(5),isDestructive:!0},c={text:s.isCommentsFluentUIEnabled()?e.getString(121):e.getString(2),onClick:t.onDelete,icon:3,accessibilityLabel:e.getStringOrUndefined(41),isDestructive:!0},u={text:s.isCommentsFluentUIEnabled()?e.getString(120):e.getString(1),onClick:t.onEdit,icon:6,accessibilityLabel:e.getStringOrUndefined(40)},d={text:e.getString(15),icon:1,onClick:t.onCancel,onKeyDown:function(e,n){n?Object(i.normalizeKey)(e.key)===i.KeyboardKey.Enter&&t.onCancel(n):Object(o.getTelemetryAPI)().assertConditionTag(!1,"CommentPostInterface ref is undefined for cancelEditItem.",544477844)},accessibilityLabel:e.getStringOrUndefined(39),isCancelItem:!0,usePrimaryButtonStyling:!1,tooltipText:e.getString(15)},p={text:e.getString(15),onClick:function(){},icon:0,accessibilityLabel:e.getString(15),isCancelItem:!0,tooltipText:e.getString(15)},f={text:e.getString(14),icon:24,onClick:function(e){return t.onCommit(e,l.default.CommitButton)},onKeyDown:function(e,n){n?Object(i.normalizeKey)(e.key)===i.KeyboardKey.Enter&&t.onCommit(n,l.default.CommitButton):Object(o.getTelemetryAPI)().assertConditionTag(!1,"CommentPostInterface ref is undefined for saveItem.",544477845)},accessibilityLabel:e.getStringOrUndefined(38),usePrimaryButtonStyling:!0,tooltipText:e.getString(173)},h=Object(r.__assign)(Object(r.__assign)({},f),{showDelayedSpinner:!0}),m={text:s.isCommentsFluentUIEnabled()?e.getString(121):e.getString(2),onClick:t.onLowFidelityWarningConfirm,icon:3,accessibilityLabel:e.getStringOrUndefined(41),isDestructive:!0},y={text:e.getString(15),onClick:t.onLowFidelityWarningCancel,accessibilityLabel:e.getStringOrUndefined(43),icon:0,isCancelItem:!0},g={text:e.getString(37),onClick:t.onLowFidelityWarningConfirm,accessibilityLabel:e.getStringOrUndefined(42),icon:0};return{retry:n,deleteRootItem:a,cancelEditItem:d,cancelItem:p,cancelLowFidelityWarningDeleteItem:y,cancelLowFidelityWarningEditItem:{text:e.getString(15),icon:1,onClick:t.onLowFidelityWarningCancel,accessibilityLabel:e.getStringOrUndefined(39),isCancelItem:!0,tooltipText:e.getString(15)},deleteItem:c,deleteItemForLowFidelityWarningDelete:m,editItem:u,proceedItemForLowFidelityWarningEdit:g,saveItem:f,saveItemPending:h,linkToCommentMenuItem:{text:e.getString(207),onClick:t.onPresentLinkToComment,icon:25}}}},33154:function(e,t,n){"use strict";n.r(t),n.d(t,"getStyles",(function(){return i}));var r=n(30123),o=n(32948),i=Object(r.memoizeFunction)((function(e,t){return{cardContainer:Object(r.mergeStyles)({position:"relative",zIndex:Object(o.isCardSelected)(e,t)||Object(o.getCardHasPostSelected)(e,t)?1:0})}}))},33155:function(e,t,n){"use strict";n.r(t),n.d(t,"getStyles",(function(){return v}));var r=n(30010),o=n(30123),i=n(30997),a=n(32930),s=n(30993),l=n(32931),c=n(30994),u=Object(o.mergeStyles)({height:"100%"}),d=Object(o.memoizeFunction)((function(e,t){var n;return Object(o.mergeStyles)({fontFamily:'"Segoe UI", "Segoe UI Web", Arial, Verdana, sans-serif',width:"".concat(t+32,"px"),display:"flex",flexDirection:"column",alignItems:"stretch",height:"100%",overflowX:"hidden",overflowY:"hidden",backgroundColor:i.isTaskPaneWithNewInfrastructureEnabled()?void 0:null!==(n=null==e?void 0:e.PaneBackground)&&void 0!==n?n:s.OfficeColors.GRAY_30,selectors:{":focus":{color:"#333333",outline:"thin dotted"}}})})),p=Object(o.mergeStyles)({display:"flex",flexDirection:"column",flex:"1 1 auto",overflowY:"auto",overflowX:"hidden",justifyContent:"space-between",height:"100%",selectors:{":focus":{outline:"none"},"::-webkit-scrollbar-button:start:increment":{display:"none"},"::-webkit-scrollbar-button:end:decrement":{display:"none"}}}),f=Object(o.mergeStyles)({display:"flex",flex:"1 0 auto",marginTop:"3px"}),h=Object(o.mergeStyles)({padding:"16px",paddingLeft:"8px",height:"54px",boxSizing:"border-box",display:"flex",flexDirection:"row"});function m(e){var t;return Object(o.mergeStyles)({height:"22px",fontWeight:600,fontSize:"16px",fontFamily:"".concat(c.SegoeSemibold,",").concat(c.Segoe,",").concat(c.SegoeWeb,", Arial, Verdana, sans-serif"),color:null!==(t=null==e?void 0:e.NewCommentButtonLabel)&&void 0!==t?t:"#252423",display:"inline-block",textOverflow:"ellipsis",whiteSpace:"nowrap",flexGrow:1,overflow:"hidden",margin:i.isA11yFastPastFixesEnabed()?"0px !important":void 0})}var y=function(e){var t,n,r,a,l,u,d;return{root:{color:i.isWebCommentPaneCloseButtonStylingFixEnabled()?void 0:null!==(t=null==e?void 0:e.ClosePaneButton)&&void 0!==t?t:s.OfficeColors.GRAY_E,padding:0,border:"1px solid transparent",margin:0,width:"22px",minWidth:"22px",height:"22px",alignContent:"center",marginLeft:"0px",selectors:{".ms-Fabric--isFocusVisible &:focus::after":c.fabricFocusSelectorStyles,".ms-Button-flexContainer":{position:"relative"}}},icon:{color:null!==(n=null==e?void 0:e.ClosePaneButtonIcon)&&void 0!==n?n:s.OfficeColors.GRAY_F,margin:0,width:"20px",height:"20px"},iconHovered:{color:null!==(r=null==e?void 0:e.ClosePaneButtonIconHovered)&&void 0!==r?r:s.OfficeColors.GRAY_J},iconPressed:{color:null!==(a=null==e?void 0:e.ClosePaneButtonIconPressed)&&void 0!==a?a:s.OfficeColors.GRAY_J},rootPressed:{color:i.isWebCommentPaneCloseButtonStylingFixEnabled()?void 0:null!==(l=null==e?void 0:e.ClosePaneButtonPressed)&&void 0!==l?l:s.OfficeColors.GRAY_J,backgroundColor:null==e?void 0:e.ClosePaneButtonPressed},rootHovered:Object(o.mergeStyles)({color:i.isWebCommentPaneCloseButtonStylingFixEnabled()?void 0:null!==(u=null==e?void 0:e.ClosePaneButtonHovered)&&void 0!==u?u:s.OfficeColors.GRAY_J,backgroundColor:i.isWebCommentPaneCloseButtonStylingFixEnabled()?null==e?void 0:e.ClosePaneButtonHovered:void 0},c.commonHighContrastHoverStyles),rootFocused:Object(o.mergeStyles)({color:null!==(d=null==e?void 0:e.ClosePaneButtonFocused)&&void 0!==d?d:"#333333",outline:"none",border:"1px solid"},c.commonHighContrastFocusStyles)}},g=function(e){var t;return Object(o.mergeStyles)({color:null!==(t=null==e?void 0:e.Text)&&void 0!==t?t:s.OfficeColors.ACTIVE_COMMENT_TEXT,fontWeight:"normal",fontFamily:"inherit",fontSize:"12px",outline:"none",border:"1px solid transparent",marginLeft:"8px",marginRight:"9px",marginTop:"8px",selectors:{":focus":{color:"#333333",outline:"none",border:"1px dotted"}}})},b={selectors:{"& .ms-Spinner-circle":{borderColor:l.spinnerBackgroundColor,borderTopColor:l.spinnerPrimaryColor}}},v=Object(r.memoizeOnceWithPartialParams)({},(function(e,t){return{paneContainer:d(e,t),listContainer:p,commentList:f,paneHeader:h,paneTitle:m(e),iconClosePane:y(e),emptyPaneMessage:g(e),spinnerStyles:b,focusTrapZone:u}}),(function(){return[Object(a.getPaneContentWidth)()]}))},33156:function(e,t,n){"use strict";n.r(t);var r=n(33157);n.d(t,"GhostComment",(function(){return r.GhostComment}))},33157:function(e,t,n){"use strict";n.r(t),n.d(t,"GhostComment",(function(){return u}));var r=n(562),o=n(30123),i=n(31159),a=n(245),s=n(30997),l=n(31038),c=n(33158),u=function(e){function t(t){var n=e.call(this,t)||this;return n.invokeHandler=n.invokeHandler.bind(n),n.keyDownHandler=n.keyDownHandler.bind(n),n}return Object(r.__extends)(t,e),t.prototype.invokeHandler=function(e){var t,n;null===(n=(t=this.props).onClick)||void 0===n||n.call(t),e.stopPropagation()},t.prototype.keyDownHandler=function(e){(Object(i.normalizeKey)(e.key)===i.KeyboardKey.Enter||s.isSpaceKeyGhostCardEnabed()&&Object(i.normalizeKey)(e.key)===i.KeyboardKey.Space)&&this.invokeHandler(e)},t.prototype.render=function(){var e=n(33159),t=Object(o.getRTL)(),r=Object(c.getStyles)(t);return a.createElement("div",{"aria-label":this.props.accessibilityLabel,id:l.getGhostCardId(),className:r.cardContainer,role:"button",onClick:this.invokeHandler,onKeyDown:this.keyDownHandler,tabIndex:0},a.createElement("span",{className:r.labelContainer},this.props.ghostCommentString),a.createElement("span",{className:r.ghostCardContainer},a.createElement(e,{className:r.svgStyle})))},t}(a.PureComponent)},33158:function(e,t,n){"use strict";n.r(t),n.d(t,"getStyles",(function(){return l}));var r=n(30010),o=n(30123),i=n(32930),a=n(30993),s=n(30994),l=Object(r.memoizeOnceWithPartialParams)({},Object(o.memoizeFunction)((function(e,t){return{labelContainer:Object(o.mergeStyles)({display:"flex",color:a.OfficeColors.GRAY_E,opacity:"100%",fontFamily:"inherit",fontSize:"12px",lineHeight:"1.3",justifyContent:"center",width:t,marginTop:"7px",marginBottom:"10px",minHeight:"20px",forcedColorAdjust:"auto"}),cardContainer:Object(o.mergeStyles)({display:"flex",flexDirection:"column",width:t,cursor:"pointer",marginTop:"20px",marginRight:"8px",marginLeft:"8px",backgroundColor:"transparent",flexGrow:0,transition:"ease-in-out",transitionProperty:"margin-top,max-height,min-height",transitionDuration:"0.20s",minHeight:"70px",maxHeight:"70px",border:"1px solid transparent",selectors:{":hover":Object(o.mergeStyles)({marginTop:"5px",minHeight:"85px",maxHeight:"85px"},s.commonHighContrastHoverStyles),":focus":Object(o.mergeStyles)({color:"#333333",outline:"none",border:"1px dotted"},s.commonHighContrastFocusStyles)}}),ghostCardContainer:Object(o.mergeStyles)({width:t,overflow:"hidden"}),svgStyle:Object(o.mergeStyles)({width:t},e&&{transform:"scaleX(-1)"})}})),(function(){return[Object(i.getPaneContentWidth)()]}))},33159:function(e,t,n){var r=n(245);function o(e){return r.createElement("svg",e,[r.createElement("defs",{key:0},[r.createElement("rect",{id:"path-1",x:"2",y:"1",width:"270",height:"60",key:0}),r.createElement("filter",{x:"-1.3%",y:"-4.2%",width:"102.6%",height:"111.7%",filterUnits:"objectBoundingBox",id:"filter-2",key:1},[r.createElement("feOffset",{dx:"0",dy:"1",in:"SourceAlpha",result:"shadowOffsetOuter1",key:0}),r.createElement("feGaussianBlur",{stdDeviation:"1",in:"shadowOffsetOuter1",result:"shadowBlurOuter1",key:1}),r.createElement("feComposite",{in:"shadowBlurOuter1",in2:"SourceAlpha",operator:"out",result:"shadowBlurOuter1",key:2}),r.createElement("feColorMatrix",{values:"0 0 0 0 0   0 0 0 0 0   0 0 0 0 0  0 0 0 0.1 0",type:"matrix",in:"shadowBlurOuter1",key:3})])]),r.createElement("g",{id:"Redlines",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd",opacity:"0.718693388",key:1},r.createElement("g",{id:"GhostCard_52px"},[r.createElement("g",{id:"Rectangle-2",key:0},[r.createElement("use",{fill:"black",fillOpacity:"1",filter:"url(#filter-2)",xlinkHref:"#path-1",key:0}),r.createElement("use",{fill:"#FFFFFF",fillRule:"evenodd",xlinkHref:"#path-1",key:1}),r.createElement("rect",{stroke:"#EAEAEA",strokeWidth:"1",x:"2.5",y:"1.5",width:"269",height:"59",key:2})]),r.createElement("circle",{id:"Oval-8",fill:"#EAEAEA",cx:"27",cy:"28",r:"14",key:1}),r.createElement("rect",{id:"Rectangle1",fill:"#EAEAEA",x:"55",y:"16",width:"92",height:"11",rx:"5.5",key:2}),r.createElement("rect",{id:"Rectangle2",fill:"#EAEAEA",x:"55",y:"34",width:"204",height:"11",rx:"5.5",key:3})]))])}o.defaultProps={width:"274px",height:"52px",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 274 52",focusable:"false",version:"1.1"},e.exports=o,o.default=o},33160:function(e,t,n){"use strict";n.r(t),n.d(t,"NewCommentButton",(function(){return u}));var r=n(30123),o=n(245),i=n(32926),a=n(31038),s=n(32934),l=n(33161),c={iconName:"NewComment"},u=o.memo((function(e){var t=Object(i.useSemanticStylesProvider)(),n=Object(l.getNewCommentButtonStyles)(null==t?void 0:t.colors,null==t?void 0:t.styles);return o.createElement("div",{className:n.newCommentButtonContainer},o.createElement(r.TooltipHost,{content:e.localizationAPI.getString(177),directionalHint:r.DirectionalHint.leftCenter,tooltipProps:s.commentTooltipProps},o.createElement(r.DefaultButton,{id:Object(a.getNewCommentButtonElementID)(),styles:n.newCommentButton,text:e.localizationAPI.getString(91),ariaLabel:e.localizationAPI.getString(92),iconProps:c,onClick:e.onClick,onKeyDown:e.onKeyDown,disabled:e.disabled,allowDisabledFocus:!0,tabIndex:e.disabled?-1:0})))}))},33161:function(e,t,n){"use strict";n.r(t),n.d(t,"getNewCommentButtonStyles",(function(){return p}));var r=n(30010),o=n(30123),i=n(30991),a=n(30997),s=n(32930),l=n(30993),c=n(30994),u=function(e,t){var n,r,s,u,d,p,f,h,m,y,g,b,v,C;return Object(o.mergeStyleSets)({root:{margin:0,padding:0,backgroundColor:null!==(s=null==e?void 0:e.NewCommentButton)&&void 0!==s?s:l.OfficeColors.WHITE,border:"1px solid",borderRadius:c.DEFAULT_BORDER_RADIUS,borderColor:null!==(u=null==e?void 0:e.CommonControlBorder)&&void 0!==u?u:l.OfficeColors.GRAY_C,boxShadow:null!==(d=null==t?void 0:t.DefaultButtonBoxShadow)&&void 0!==d?d:"0 2px 4px -.75px rgba(0,0,0,0.1)",selectors:{".ms-Fabric--isFocusVisible &:focus::after":c.fabricFocusSelectorStyles,".ms-Button-flexContainer":{position:"relative"}}},icon:{width:"16px",padding:"8px",paddingLeft:"12px",margin:0,marginBottom:"16px",marginTop:"16px",color:null!==(p=null==e?void 0:e.PrimaryButton)&&void 0!==p?p:Object(i.getWebAppColors)().primary},label:{color:null==e?void 0:e.DefaultButtonIcon,fontSize:"14px",textAlign:"right",fontFamily:"inherit",padding:"8px",paddingRight:"12px",paddingLeft:0,margin:0,marginBottom:"16px",marginTop:"16px"},rootHovered:Object(o.mergeStyles)({color:Object(a.isWebThemeIntegrationEnabled)()?void 0:c.ButtonColors.BUTTON_HOVER,backgroundColor:null==e?void 0:e.NewCommentButtonHovered},c.commonHighContrastHoverStyles),rootPressed:{color:Object(a.isWebThemeIntegrationEnabled)()?void 0:c.ButtonColors.BUTTON_DOWN,backgroundColor:null==e?void 0:e.NewCommentButtonPressed},rootFocused:Object(o.mergeStyles)({boxShadow:null!==(f=null==t?void 0:t.FocusedButtonBoxShadow)&&void 0!==f?f:"inset 0px 0px 0px 1px white",backgroundColor:null!==(h=null==e?void 0:e.DefaultButton)&&void 0!==h?h:c.ButtonColors.BUTTON_SELECT,borderColor:null!==(m=null==e?void 0:e.NewCommentButtonBorderFocused)&&void 0!==m?m:l.OfficeColors.BLACK,selectors:(n={},n[o.HighContrastSelector]={" .ms-Button-label":{color:"HighlightText"}},n)},c.commonHighContrastFocusStyles),rootDisabled:{boxShadow:null!==(y=null==t?void 0:t.DisabledButtonBoxShadow)&&void 0!==y?y:"inset 0px 0px 0px 1px #F3F2F1",backgroundColor:null!==(g=null==e?void 0:e.NewCommentButtonDisabled)&&void 0!==g?g:c.ButtonColors.BUTTON_DISABLED},iconHovered:{color:null!==(b=null==e?void 0:e.NewCommentButtonIconHoveredPressed)&&void 0!==b?b:l.OfficeColors.GRAY_J},iconPressed:{color:null!==(v=null==e?void 0:e.NewCommentButtonIconHoveredPressed)&&void 0!==v?v:l.OfficeColors.GRAY_J},labelHovered:{color:null!==(C=null==e?void 0:e.DefaultButtonIcon)&&void 0!==C?C:l.OfficeColors.GRAY_J,selectors:(r={},r[o.HighContrastSelector]={color:"HighlightText"},r)}})},d=Object(o.memoizeFunction)((function(e,t,n){return{newCommentButtonContainer:(r=n,Object(o.mergeStyles)({display:"flex",flexDirection:"row-reverse",direction:"inherit",flexWrap:"nowrap",overflow:"hidden",width:r,minHeight:"41px",marginBottom:"5px",paddingLeft:"10px",paddingBottom:0,backgroundColor:"transparent",outline:"none"})),newCommentButton:u(e,t)};var r})),p=Object(r.memoizeOnceWithPartialParams)({},(function(e,t,n){return d(e,t,n)}),(function(){return[Object(s.getPaneContentWidth)()]}))},33162:function(e,t,n){"use strict";n.r(t),n.d(t,"ThemeProviderWrapper",(function(){return c}));var r=n(562),o=n(30123),i=n(245),a=n(32926),s=n(30992),l=n(30997),c=function(e){var t=Object(o.useTheme)(),n=Object(r.__read)(i.useState(matchMedia(o.HighContrastSelector).matches),2),c=n[0],u=n[1],d=i.useRef(matchMedia(o.HighContrastSelector)),p=function(e){u(e.matches)};l.isWebThemeIntegrationHighContrastFixesEnabled()&&i.useEffect((function(){var e=d.current;return e.addEventListener("change",p),function(){e.removeEventListener("change",p)}}),[d]);var f=i.useMemo((function(){return c&&l.isWebThemeIntegrationHighContrastFixesEnabled()||!l.isWebThemeIntegrationEnabled()?void 0:{colors:Object(s.getSemanticColors)(t),styles:Object(s.getSemanticStyles)(t)}}),[c,t]);return l.isWebThemeIntegrationEnabled()?i.createElement(o.ThemeProvider,{style:{background:"transparent"},as:i.Fragment,theme:t},i.createElement(a.SemanticStylesProviderContext.Provider,{value:f},e.children)):i.createElement(i.Fragment,null,e.children)}},33163:function(e,t,n){"use strict";n.r(t),n.d(t,"makeMapStateToProps",(function(){return p})),n.d(t,"HostableCommentCardRendererContainer",(function(){return f}));var r=n(3e4),o=n(30061),i=n(30888),a=n(25301),s=n(31300),l=n(31350),c=n(32942),u=n(31040),d=n(33164),p=function(){var e=c.makeGetDraftThreadCommentDraftState(),t=c.makeGetCommittedThreadIdFromResourceId(),n=c.makeGetThreadWithCommentDraft((function(e){return s.getCreatedCommentLie(e,!0)}),(function(e){return s.getDraftThreadId(e,!0)}),e,t),a=c.makeGetCardRelativeDraftingState(),d=c.makeGetIsDraftThread(),p=c.makeGetContentState(n,a),f=c.makeIsResourceAvailable(p);return function(e,t){var a,c=n(e,t),p=c.thread.length?c.thread[0].commentId:null===(a=t.resource)||void 0===a?void 0:a.id,h=t.componentTree.componentTreeId.renderContextType,m=void 0;switch(h){case u.default.FullPane:m={renderMode:i.RenderMode.TaskPaneItem};break;case u.default.DiscreteIntegrated:m={renderMode:i.RenderMode.Integrated};break;case u.default.DiscreteIsolated:p&&(m={renderMode:i.RenderMode.Isolated,threadId:p});break;case u.default.HalfPane:case u.default.None:Object(o.getTelemetryAPI)().assertConditionTag(!1,"Invalid RenderContextType for HostableComponent received.",593822914);break;default:Object(r.unreachable)(h)}var y=l.isExtensionForContentEnabled(e,m);return{isResourceAvailable:f(e,t),virtualized_deprecated:s.getVirtualized_deprecated(e),modelCapabilities:s.getModelCapabilities(e),isDraftThread:d(e,t),isExtensionEnabled:y,threadId:p}}},f=Object(a.connect)(p)(d.HostableCommentCardRenderer)},33164:function(e,t,n){"use strict";n.r(t),n.d(t,"HostableCommentCardRenderer",(function(){return m}));var r,o,i,a=n(562),s=n(3e4),l=n(30010),c=n(30061),u=n(245),d=n(32941),p=n(33165),f=n(33162),h=n(33166),m=function(e){function t(t){var n=e.call(this,t)||this;return n.getDiagnosticDataFields=function(){var e;return[Object(c.makeDataField)("IsResourceAvailable",n.props.isResourceAvailable,c.DataFieldClassification.SystemMetadata),Object(c.makeDataField)("IsContentExtensionEnabled",n.props.isExtensionEnabled,c.DataFieldClassification.SystemMetadata),Object(c.makeDataField)("RenderContextType",n.props.componentTree.componentTreeId.renderContextType,c.DataFieldClassification.SystemMetadata),Object(c.makeDataField)("CommentId",null!==(e=n.props.threadId)&&void 0!==e?e:"",c.DataFieldClassification.SystemMetadata)]},n.getUpdatedResource=Object(l.memoizeOnce)((function(e,t){return Object(a.__assign)(Object(a.__assign)({},e),{id:t})})),n.createTelemetryContext=Object(l.memoizeOnce)(h.createTelemetryContextData),n.getAccessibilitySetProperties=Object(l.memoizeOnceWithParams)((function(e){var t,n,r;return{accessibilityPositionInSet:null===(t=null==e?void 0:e.setItem)||void 0===t?void 0:t.positionInSet,accessibilitySetSize:null===(n=null==e?void 0:e.setItem)||void 0===n?void 0:n.setSize,accessibilitySetLevel:null===(r=null==e?void 0:e.setItem)||void 0===r?void 0:r.level}}),(function(){return[n.props.accessibilityMetadata]})),n.state={keyIter_deprecated:0},n}return Object(a.__extends)(t,e),t.prototype.componentDidUpdate=function(e){var t,n;e.isResourceAvailable!==this.props.isResourceAvailable&&(null===(n=(t=Object(c.getTelemetryAPI)()).logDiagnosticTrace)||void 0===n||n.call.apply(n,Object(a.__spreadArray)([t,Object(l.strLiteral)(r||(r=Object(a.__makeTemplateObject)(["HostableComponentResourceAvailabilityUpdated"],["HostableComponentResourceAvailabilityUpdated"]))),s.TelemetryTag.reserveTag(554717322),c.Severity.Info,c.DataCategories.ProductServiceUsage,this.props.telemetryVisitor],Object(a.__read)(this.getDiagnosticDataFields()),!1)))},t.prototype.componentDidMount=function(){var e,t;null===(t=(e=Object(c.getTelemetryAPI)()).logDiagnosticTrace)||void 0===t||t.call.apply(t,Object(a.__spreadArray)([e,Object(l.strLiteral)(o||(o=Object(a.__makeTemplateObject)(["HostableComponentMount"],["HostableComponentMount"]))),s.TelemetryTag.reserveTag(554717323),c.Severity.Info,c.DataCategories.ProductServiceUsage,this.props.telemetryVisitor],Object(a.__read)(this.getDiagnosticDataFields()),!1))},t.prototype.componentWillUnmount=function(){var e,t;null===(t=(e=Object(c.getTelemetryAPI)()).logDiagnosticTrace)||void 0===t||t.call.apply(t,Object(a.__spreadArray)([e,Object(l.strLiteral)(i||(i=Object(a.__makeTemplateObject)(["HostableComponentUnmount"],["HostableComponentUnmount"]))),s.TelemetryTag.reserveTag(554717324),c.Severity.Info,c.DataCategories.ProductServiceUsage,this.props.telemetryVisitor],Object(a.__read)(this.getDiagnosticDataFields()),!1))},t.prototype.render=function(){if(!this.props.isResourceAvailable||!this.props.resource||!this.props.threadId)return null;if(!this.props.isExtensionEnabled)return s.IsDebug?u.createElement(p.TextWrapper,{textStylePolyester:"MediumBold"},"Debug Error: This comment card's extension is disabled."):null;var e=this.getUpdatedResource(this.props.resource,this.props.threadId),t=this.getAccessibilitySetProperties(),n=u.createElement(f.ThemeProviderWrapper,{api:this.props.themeAPI},u.createElement(d.DiscreteCommentCardContainer,Object(a.__assign)({commentAPI:this.props.commentAPI,focusManager:this.props.focusManager,localizationAPI:this.props.localizationAPI,peopleAPI:this.props.peopleAPI,resource:e,telemetryVisitor:this.props.telemetryVisitor,componentRef:this.props.componentRef,componentTree:this.props.componentTree,maximumDimensions:this.props.maximumDimensions,onInitialRender:this.props.onInitialRender,setComponentRef:this.props.setComponentRef,isVirtualized:this.props.isVirtualized,componentInstanceId:this.props.componentInstanceId,correlationId:this.props.correlationId,lppManager:this.props.lppManager,accessibilityMetadata:this.props.accessibilityMetadata},t)));return u.createElement(h.TelemetryContext.Provider,{value:this.createTelemetryContext(this.props.telemetryVisitor)},n)},t}(u.PureComponent)},33165:function(e,t,n){"use strict";n.r(t),n.d(t,"TextWrapper",(function(){return a}));var r=n(562),o=n(32983),i=n(245),a=function(e){var t=e.textStylePolyester,n=(e.variantFluent,e.colorFluent,Object(r.__rest)(e,["textStylePolyester","variantFluent","colorFluent"]));return i.createElement(o.Text,Object(r.__assign)({},n,{textStyle:t}))};a.displayName="TextWrapper"},33166:function(e,t,n){"use strict";n.r(t),n.d(t,"createTelemetryContextData",(function(){return a})),n.d(t,"TelemetryContext",(function(){return s}));var r=n(30061),o=n(245),i={dataFieldVisitor:Object(r.globalTelemetryVisitor)(r.GlobalTelemetryReason.GlobalAPI)};function a(e){return{dataFieldVisitor:e}}var s=o.createContext(i)}}]);