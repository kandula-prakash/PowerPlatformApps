/*! For license information please see app-module-designer~c~adc26e85.cbbe2c7c.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[342],{12036:function(e,t,i){"use strict";i.r(t),i.d(t,"AppContextQuery",(function(){return a}));var n,r=i(3128);var s,o,a=i.n(r)()(n||(s=["\n  query appContext($id: String!) {\n    appContext(id: $id) {\n      sitemapId\n      appInfo {\n        appId\n        title\n        uniqueName\n        description\n        mobileOfflineProfileIds\n      }\n      appEntityInfo {\n        entityId\n        views {\n          id\n          type\n        }\n        forms {\n          id\n          type\n        }\n        dashboards {\n          id\n          type\n        }\n        chartIds\n      }\n      dashboardIds\n      businessProcessFlowIds\n      canvasApps {\n        id\n        type\n      }\n    }\n  }\n"],o||(o=s.slice(0)),n=Object.freeze(Object.defineProperties(s,{raw:{value:Object.freeze(o)}}))))},12145:function(e,t,i){"use strict";i.r(t);var n=i(12146);i.d(t,"WebResourcePicker",(function(){return n.WebResourcePicker}));i(12148);var r=i(12149);i.d(t,"getWebResourcesByType",(function(){return r.getWebResourcesByType})),i.d(t,"getWebResourcesByNextLink",(function(){return r.getWebResourcesByNextLink}))},12146:function(e,t,i){"use strict";i.r(t),i.d(t,"WebResourcePicker",(function(){return m}));var n=i(684),r=i(1471),s=i(890),o=i(1697),a=i(245),c=i(3064),l=i(4102),d=i(3161),u=i(12147);function p(e,t,i,n,r,s,o){try{var a=e[s](o),c=a.value}catch(l){return void i(l)}a.done?t(c):Promise.resolve(c).then(n,r)}function h(e){return function(){var t=this,i=arguments;return new Promise((function(n,r){var s=e.apply(t,i);function o(e){p(s,n,r,o,a,"next",e)}function a(e){p(s,n,r,o,a,"throw",e)}o(void 0)}))}}var g=Object(u.getStyles)();class m extends a.Component{constructor(e){var t;super(e),t=this,this.selection=void 0,this._renderSearchBox=()=>{var{searchBoxPlaceholder:e}=this.props.strings,t={styles:{root:g.searchBox},placeholder:e,onSearch:e=>this.getFirstPage(e),onClear:()=>this.getFirstPage()};return a.createElement(l.SearchBox,t)},this._renderList=e=>{var{strings:t}=this.props,i=this.getColumns(e),n=e.filter(e=>!this.props.hiddenLibraries.find(t=>e.name===t.name));return a.createElement(c.DetailsList,{items:n,columns:i,compact:!0,checkboxVisibility:r.CheckboxVisibility.onHover,setKey:"set",selection:this.selection,selectionPreservedOnEmptyClick:!0,selectionMode:r.SelectionMode.single,showLoadMoreButton:this.state.hasNext,loadMoreButtonProps:{text:t.showMore,onClick:this.getNextPage,disabled:this.state.gettingNext},styles:g.detailsListStyles,onShouldVirtualize:()=>!1,isLoading:this.state.loading,renderOnEmpty:()=>a.createElement(d.EmptyState,{icon:"FabricDocLibrary",primaryMessage:t.noSearchResults})})},this._renderFooter=()=>{var e,{strings:t,newResourceUrl:i}=this.props;return a.createElement(s.DialogFooter,{styles:g.dialogFooterStyles},i&&a.createElement(n.CommandButton,{styles:{root:{float:"left"}},text:t.new,onClick:()=>{window.open(i,"_blank","noreferrer noopener")},iconProps:{iconName:"Add"}}),a.createElement(n.PrimaryButton,{onClick:()=>{this.onAddLibraryClicked(this.state.selectedLibraries)},text:t.add,disabled:!(null!==(e=this.state.selectedLibraries)&&void 0!==e&&e.length)}),a.createElement(n.DefaultButton,{onClick:this.onDialogDismiss,text:t.close}))},this.onDialogDismiss=()=>{var{onDismiss:e}=this.props;e&&(this.setState({selectedLibraries:[]}),e())},this.getFirstPage=function(){var e=h((function*(e){t.setState({loading:!0,loadedLibraries:[]});var{getFirstPage:i}=t.props,n=yield i(e);t.handleQuery(n)}));return function(t){return e.apply(this,arguments)}}(),this.getNextPage=h((function*(){t.setState({gettingNext:!0});var{getNextPage:e}=t.props,{nextLink:i}=t.state,n=yield e(i);t.handleQuery(n)})),this.handleQuery=e=>{if(e.length>0){var t=this.state.loadedLibraries.slice();t.push(...this.mapResourcesToItems(e)),this.setState({loadedLibraries:t,hasNext:e[0].hasNext||!1,nextLink:e[0].nextLink||"",gettingNext:!1,loading:!1})}else this.setState({gettingNext:!1,loading:!1})},this.onAddLibraryClicked=e=>{e.forEach(e=>this.props.addLibrary(e));var t=this.state.hiddenLibraries.slice();this.mapResourcesToItems(e).forEach(e=>{t.push(e)}),this.setState({hiddenLibraries:t,selectedLibraries:[]}),this.selection.setItems([]),this.props.onDismiss()},this.mapResourceToItem=e=>{var{name:t,displayname:i,description:n,webresourceid:r,content:s}=e;return{name:t,displayname:i,description:n,webresourceid:r,content:s}},this.mapResourcesToItems=e=>e&&e.length?e.map(this.mapResourceToItem):[],this.state={errorMessage:null,hiddenLibraries:e.hiddenLibraries.map(e=>{var{name:t,description:i,displayName:n,webResourceId:r}=e;return{name:t,description:i,displayname:n,webresourceid:r}}),loadedLibraries:[],selectedLibraries:[],hasNext:!1,nextLink:"",gettingNext:!0,loading:!0},this.selection=new r.Selection({onSelectionChanged:()=>{var e=this.selection.getSelection();this.setState({selectedLibraries:e})}})}componentDidMount(){this.props.setShouldFireKeyboardShortcuts(!1),this.getFirstPage()}componentDidUpdate(e,t){!0===t.loading&&!1===this.state.loading?this.state.loadedLibraries.length>0&&this.selection.setIndexSelected(0,!0,!1):!1===t.loading&&!0===this.state.loading&&this.selection.setAllSelected(!1)}componentWillUnmount(){this.props.setShouldFireKeyboardShortcuts(!0)}render(){var{strings:e}=this.props,{errorMessage:t,loadedLibraries:i}=this.state;return a.createElement(s.Dialog,{hidden:!1,styles:g.dialogStyles,minWidth:g.dialogStyles.dialogWidth,maxWidth:g.dialogStyles.dialogWidth,dialogContentProps:{title:e.addLibrary,type:s.DialogType.normal,styles:g.dialogContentStyles},modalProps:{onDismissed:this.onDialogDismiss,isBlocking:!0},onDismiss:this.onDialogDismiss},t&&a.createElement(o.MessageBar,{messageBarType:o.MessageBarType.error,isMultiline:!1,styles:g.errorMessageBarStyles},t),this._renderSearchBox(),this._renderList(i),this._renderFooter())}convertItemToIconColumn(e){var t="";try{e.content&&atob(e.content)&&(t=e.content)}catch(i){}return{iconUri:t?"data:image/svg+xml;base64,".concat(t):t,iconAltText:e.displayname||e.name}}getColumns(e){var{strings:t}=this.props,i=Object(r.buildColumns)(e);if(i.length>0){var n=Object(c.buildIconColumn)(this.convertItemToIconColumn),s=i.find(e=>"name"===e.key);if(!s)return[];s.name=t.name,s.ariaLabel=t.name;var o=i.find(e=>"displayname"===e.key);if(!o)return[];o.name=t.displayName,o.ariaLabel=t.displayName;var a=i.find(e=>"description"===e.key);return a?(a.name=t.description,a.ariaLabel=t.description,[n,o,s,a]):[]}return[]}}},12147:function(e,t,i){"use strict";i.r(t),i.d(t,"getStyles",(function(){return c}));var n=i(719);function r(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function s(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?r(Object(i),!0).forEach((function(t){o(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):r(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function o(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var a=Object(n.getTheme)(),c=()=>s(s({},Object(n.mergeStyleSets)({searchBox:{minHeight:"32px",maxWidth:"240px",minWidth:"240px",background:a.palette.white}})),{},{dialogStyles:l,dialogContentStyles:d,detailsListStyles:u,dialogFooterStyles:p,errorMessageBarStyles:h}),l={root:{},main:{height:640,borderRadius:2},dialogWidth:"720px"},d={content:{},subText:{fontSize:"14px"},header:{height:"60px"},button:{padding:0,marginTop:"22px",marginRight:"22px",height:"16px",width:"16px",minWidth:"16px"},inner:{paddingBottom:0},innerContent:{maxHeight:"492px",overflowY:"hidden",marginBottom:"32px"},title:{fontSize:"20px",fontWeight:n.FontWeights.semibold,paddingBottom:"8px"},topButton:{padding:0,margin:0}},u={outerRoot:{minHeight:"448px",maxHeight:"448px",overflowY:"scroll",overflowX:"hidden"},root:{},focusZone:{},headerWrapper:{},contentWrapper:{},cellItem:{},spinner:{},subComponentStyles:{loadMoreButton:{}}},p={actions:{display:"flex",flexDirection:"column"},actionsRight:{},action:{alignContent:"center"}},h={}},12148:function(e,t,i){"use strict";i.r(t)},12149:function(e,t,i){"use strict";i.r(t),i.d(t,"getWebResourcesByType",(function(){return o})),i.d(t,"getWebResourcesByNextLink",(function(){return c}));var n=i(5591);function r(e,t,i,n,r,s,o){try{var a=e[s](o),c=a.value}catch(l){return void i(l)}a.done?t(c):Promise.resolve(c).then(n,r)}function s(e){return function(){var t=this,i=arguments;return new Promise((function(n,s){var o=e.apply(t,i);function a(e){r(o,n,s,a,c,"next",e)}function c(e){r(o,n,s,a,c,"throw",e)}a(void 0)}))}}function o(e,t,i){return a.apply(this,arguments)}function a(){return(a=s((function*(e,t,i){return(yield e.query({query:n.webResourcesByTypeQuery,variables:{resourceType:t,searchString:i}})).data.resourcesByType}))).apply(this,arguments)}function c(e,t){return l.apply(this,arguments)}function l(){return(l=s((function*(e,t){return(yield e.query({query:n.webResourcesByTypeWithNextLinkQuery,variables:{nextLink:t}})).data.resourcesByTypeWithNextLink}))).apply(this,arguments)}}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/app-module-designer~c~adc26e85.cbbe2c7c.chunk.js.map