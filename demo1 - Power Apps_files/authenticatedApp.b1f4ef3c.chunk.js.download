/*! For license information please see authenticatedApp.b1f4ef3c.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{2684:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return g}));var o=n(215),r=n(2685),a=n(2687),i=n(481),s=n(217),c=n(245),l=n(1074),d=n(303),u=n(2682),h=n(1075),p=n(2688),m=n(1080),w=n(2681),f=Object(l.default)(()=>Promise.all([n.e(95),n.e(44),n.e(80),n.e(83),n.e(68),n.e(81),n.e(108),n.e(27),n.e(73),n.e(9),n.e(79),n.e(94),n.e(10),n.e(62),n.e(64),n.e(93),n.e(60),n.e(77),n.e(100),n.e(102),n.e(89),n.e(90),n.e(101),n.e(67),n.e(104),n.e(59),n.e(78),n.e(99),n.e(88),n.e(75),n.e(69),n.e(85),n.e(41),n.e(106),n.e(71),n.e(72),n.e(105),n.e(5),n.e(74),n.e(84),n.e(4),n.e(87),n.e(42),n.e(91),n.e(61),n.e(86),n.e(58)]).then(n.bind(null,3579)),{fallback:c.createElement(c.Fragment,null)});class g extends c.Component{constructor(){super(...arguments),this.getOnBehalfOfAuthOptions=()=>({baseTokenResource:w.default.makeAadClientId,tokenExchangeEndPoint:"".concat(w.default.makerPortalUrl,"/api/exchangeToken"),isOBOAuthEnabled:this.shouldEnableOBOAuth()})}render(){var e=function(){var{thirdPartyCookiesBlocked:e}=p.knownStartupErrors;if(Object(i.isInWidgetMode)()){if(!Object(o.checkCookies)()||!Object(o.checkLocalStorage)()||!Object(o.checkSessionStorage)())return e}else h.featureGates.enableMsalPkceFlow||Object(r.checkThirdPartyCookiesEnabled)(()=>k(e,p.startupErrorDescriptions[e]));return null}();if(e)return k(e,p.startupErrorDescriptions[e]),null;var t=new URLSearchParams(window.location.search).get("tenant");return c.createElement(o.ConnectedAuthenticationProvider,{teamsRoutePaths:m.teamsRoutePaths,onBehalfOfAuthOptions:this.getOnBehalfOfAuthOptions(),enableMsalPkceFlow:h.featureGates.enableMsalPkceFlow,handleMultipleMatchingTokensError:h.featureGates.handleMultipleMatchingTokensError,onLoginSuccess:O,tenant:t||void 0},c.createElement(d.Switch,null,c.createElement(d.Route,{path:o.authRoute,render:()=>(f.preload(),null)}),c.createElement(d.Route,{path:"/",component:f})))}shouldEnableOBOAuth(){var e=m.teamsRoutePaths.some(e=>!!Object(d.matchPath)(this.props.location.pathname,{path:e,exact:!0,strict:!1}));return!(!Object(i.isInWidgetMode)()&&!e)&&(h.featureGates.enableOBOAuthForTeams&&e||h.featureGates.enableOBOAuthWhenEmbeddedInFlow&&Object(i.getHost)()===i.Host.PowerAutomate||Object(i.getHost)()===i.Host.SharePoint)}}function O(){if(h.featureGates.redirectToPreview&&window.location.pathname!==o.authRoute&&!Object(i.isInWidgetMode)()){var e="https://make.preview.powerapps.com";window.location.pathname&&(e+=window.location.pathname),window.location.search&&(e+=window.location.search),window.location.hash&&(e+=window.location.hash),window.location.replace(e)}}function k(e,t){Object(s.trackErrorTrace)(u.MakeScope,{eventName:"startupError",eventData:Object(a.getShellError)({name:e,message:t})});var n="".concat(window.location.origin,"/startuperror?errorKind=")+"".concat(encodeURIComponent(e),"&errorDescription=").concat(encodeURIComponent(t),"&retryPathname=").concat(encodeURIComponent(window.location.pathname));window.location.assign(n)}},2685:function(e,t,n){"use strict";n.r(t),n.d(t,"checkThirdPartyCookiesEnabled",(function(){return c}));var o=n(2686),r=n.n(o),a=n(540),i=!1,s=new URL(r.a,window.location.origin);s.hostname=a.authSettings.thirdPartyCDNAliasHostname;function c(e){if(!i){var t=document.createElement("iframe");t.style.display="none",t.id="THIRD_PARTY_COOKIE_CHECK",t.src=s.href;var n=!1;window.addEventListener("message",o=>{var r=s.origin,a=o;if(a.origin===r){var c=a.data;"THIRD_PARTY_COOKIE_CHECK"===c.eventName&&(n=c.isEnabled,document.body.removeChild(t),n||e(),i=!0)}}),document.getElementById("THIRD_PARTY_COOKIE_CHECK")||document.body.appendChild(t)}}},2686:function(e,t,n){e.exports=n.p+"static/thirdPartyCookiesCheck.4b2bf05a.html"},2687:function(e,t,n){"use strict";n.r(t),n.d(t,"ShellError",(function(){return o})),n.d(t,"getShellError",(function(){return r}));class o extends Error{constructor(e,t,n,o,r){super(),this._isCritical=void 0,this._description=void 0,new.target&&(Object.setPrototypeOf?Object.setPrototypeOf(this,new.target.prototype):this.__proto__=new.target.prototype),this._isCritical=!!e,this._description=t||"",this.message=n||"",this.name=o||"",this.stack=r||""}get isCritical(){return this._isCritical}get description(){return this._description}}function r(e){var t;if(e instanceof o)return e;var n={isCritical:!1,description:"",message:(null==e?void 0:e.message)||"",name:e instanceof Error?e.name:(null==e||null===(t=e.error)||void 0===t?void 0:t.toString())||""};return e&&Object.getOwnPropertyNames(e).forEach(t=>{n[t]=e[t]}),n}},2688:function(e,t,n){"use strict";n.r(t),n.d(t,"knownStartupErrors",(function(){return o})),n.d(t,"startupErrorDescriptions",(function(){return r}));var o={thirdPartyCookiesBlocked:"thirdPartyCookiesBlocked"},r={[o.thirdPartyCookiesBlocked]:'Please enable third party-cookies and site data in your browser settings. If you are using Chrome\'s Incognito mode, you can uncheck the "Block third-party cookies" option on the Incognito landing page.'}}},0,[95,44,80,83,68,81,108,27,73,9,79,94,10,62,64,93,60,77,100,102,89,90,101,67,104,59,78,99,88,75,69,85,41,106,71,72,105,5,74,84,4,87,42,91,61,86,58]]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/authenticatedApp.b1f4ef3c.chunk.js.map