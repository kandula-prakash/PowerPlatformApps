/*! For license information please see 265.efe249ee.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[265],{8008:function(t,e,o){"use strict";o.r(e),o.d(e,"SolutionTypeFilterOptions",(function(){return n})),o.d(e,"getFilterSolutionsItem",(function(){return P})),o.d(e,"SolutionsHistoryListPage",(function(){return O}));var n,r=o(245),i=o.n(r),s=o(4064),a=o(1222),l=o(4792),c=o(4795),u=o(1252),y=o(3176),m=o(2844),p=o(6608),d=o(2882),g=o(5583),b=o(5623),S=o(8009),f=o(8012),h=o(8014),x=o(2812);function v(){return(v=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])}return t}).apply(this,arguments)}function H(t,e){var o="";switch(t){case n.Custom:o=e("Model.SolutionsHistory.SolutiontypeFilter.custom");break;case n.Internal:o=e("Model.SolutionsHistory.SolutiontypeFilter.internal");break;default:o=e("Model.SolutionsHistory.SolutiontypeFilter.all")}return o}function C(t){var e="";switch(t){case n.Custom:e="(msdyn_publishername ne 'microsoftdynamics' and msdyn_publishername ne 'MicrosoftCorporation' and msdyn_name ne 'system')";break;case n.Internal:e="(msdyn_publishername eq 'microsoftdynamics' or msdyn_publishername eq 'MicrosoftCorporation' or msdyn_name eq 'system')"}return e}function P(t,e,o){var r=[{key:o("Model.SolutionsHistory.SolutiontypeFilter.all"),text:o("Model.SolutionsHistory.SolutiontypeFilter.all"),onClick:()=>e(n.All)},{key:o("Model.SolutionsHistory.SolutiontypeFilter.custom"),text:o("Model.SolutionsHistory.SolutiontypeFilter.custom"),onClick:()=>e(n.Custom)},{key:o("Model.SolutionsHistory.SolutiontypeFilter.internal"),text:o("Model.SolutionsHistory.SolutiontypeFilter.internal"),onClick:()=>e(n.Internal)}];return{key:"Filter",text:H(t,o),style:{backgroundColor:d.fabricColors.white},iconProps:{iconName:m.fabricIcons.Filter,style:{color:y.fabricTheme.palette.themePrimary}},subMenuProps:{items:r}}}!function(t){t[t.All=0]="All",t[t.Custom=1]="Custom",t[t.Internal=2]="Internal"}(n||(n={}));var O=t=>{var{currentSolutionType:e,t:o,tReady:n,onSolutionTypeFilterOptionsUpdate:y,onSearchFilterUpdate:m,searchBy:d}=t,{navigate:H}=Object(r.useContext)(g.NavigationContext),O=function(t,e,o){return[!o&&{text:e("Model.Solutions.ListPage.pageTitle"),key:e("Model.Solutions.ListPage.pageTitle"),onClick:t},{text:e("Model.Solutions.HistoryPage.pageTitle"),key:e("Model.Solutions.HistoryPage.pageTitle")}].filter(t=>!!t)}(()=>{H(b.solutionListRoute.canvas,!0)},o,t.currentSolutionName),B=Object(r.useMemo)(()=>i.a.createElement("div",{className:"solutions-history-list-page",style:{display:"flex"}},i.a.createElement(s.PageHeader,{wrapperClassName:h.solutionHistoryListPageStyleClasses.listPageBreadCrumbWrapper,titleBreadcrumbProps:{items:O,ariaLabel:o("Model.SolutionsHistory.Breadcrumbs.solutionsHistory"),className:h.solutionHistoryListPageStyleClasses.breadcrumbs}}),i.a.createElement("span",{className:h.solutionHistoryListPageStyleClasses.listPageCommandbarWrapper},i.a.createElement(a.CommandBarWithSearchBox,{isSearchBoxVisible:!1,items:[],className:h.solutionHistoryListPageStyleClasses.commandBar,farItems:[P(e,y,o)]}),i.a.createElement(u.SearchBox,v({},Object(p.getSearchBoxProps)(Object(x.debounce)(m,500),o("Common.SearchBox.arialabel"),o("Common.SearchBox.arialabel"),o("Common.SearchBox.ClearButton.arialabel"),o("Common.SearchBox.placeholder"),d,!0),{styles:h.searchBoxStyles})))),[O,e,o,n]),L=t.lng,[j,M]=Object(r.useState)(!1),[k,F]=Object(r.useState)(null),w=i.a.createElement(f.SolutionsHistoryListContainer,v({solutionTypeFilter:C(e),onSelection:t=>{var e=null;t.getSelectedCount()>0?(M(!0),e=t.getSelection()[0]):M(!1),F(e)}},t));return Object(r.useEffect)(()=>{M(!1)},[e,d]),i.a.createElement(l.Page,{renderTitle:()=>B,renderBody:()=>i.a.createElement("div",{className:h.solutionHistoryListPageStyleClasses.solutionsHistoryListPageListcontainer},w),paneProps:{isOpen:j,headerText:o("Model.Solutions.HistoryPage.information"),hasCloseButton:!0,closeButtonAriaLabel:o("Model.Solutions.HistoryPage.close"),onDismiss:()=>{M(!1)},onRenderBody:()=>i.a.createElement(S.SolutionHistoryDetails,{selectedItem:k,localeLanguage:L}),type:c.PaneSize.small,styles:h.solutionDetailsPanelStyle},styles:h.solutionsHistoryListPageStyle})}},8012:function(t,e,o){"use strict";o.r(e),o.d(e,"SolutionsHistoryListBehavior",(function(){return d})),o.d(e,"SolutionsHistoryListContainer",(function(){return b}));var n=o(245),r=o.n(n),i=o(3076),s=o(8013),a=o(5593),l=o(922),c=o(5629),u=o(8011),y=["environmentClient","t","searchBy","solutionTypeFilter"];function m(){return(m=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])}return t}).apply(this,arguments)}function p(t,e){if(null==t)return{};var o,n,r=function(t,e){if(null==t)return{};var o,n,r={},i=Object.keys(t);for(n=0;n<i.length;n++)o=i[n],e.indexOf(o)>=0||(r[o]=t[o]);return r}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)o=i[n],e.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(t,o)&&(r[o]=t[o])}return r}var d=t=>{var{environmentClient:e,t:o,searchBy:i,solutionTypeFilter:l}=t,d=p(t,y),[b,S]=Object(n.useState)("msdyn_starttime desc"),[f,h]=Object(n.useState)(l),[x,v]=Object(n.useState)(0);Object(n.useEffect)(()=>{h(l),v(0)},[l,i]);var{loading:H,errorMessage:C,solutionsHistoryList:P,hasNextLink:O}=Object(s.useSolutionHistoryQuery)(e,{orderBy:b,filterBy:f,searchBy:g(i,t.currentSolutionName),pageNumber:x},a.PortalScope,o("Common.Request.Failed")),B=null==P?void 0:P.map(e=>{var o=e;return o.isNavigatable=t.solutionIds.includes(o.solutionId),o.filterOn=[o.name,o.publisherName,o.version],o});return r.a.createElement(u.SolutionsHistoryList,m({},d,{t:o,listItems:B||[],hasNextLink:O,loadProgress:[Object(c.toLoadingState)(!H,C)],orderSolutionsHistoryList:t=>{var e="";void 0!==t.value&&(e="msdyn_operation"===t.column||"msdyn_suboperation"===t.column?"Microsoft.Dynamics.CRM.In(PropertyName='".concat(t.column,"',PropertyValues=['").concat(t.value,"'])"):"".concat(t.column," eq ").concat(t.value)),S("".concat(t.column," ").concat(t.order)),h("".concat(l||"").concat(e?l?" and ".concat(e):"".concat(e):"")),v(0)},onSelection:t.onSelection,orderBy:b,searchBy:i,solutionTypeFilter:l,errorMessage:C,loadMoreSolutionHistories:()=>{v(x+1)},currentSolutionName:t.currentSolutionName,pageNumber:x}))};function g(t,e){var o=encodeURI(t);if(e){var n="";return n="(msdyn_name eq '".concat(encodeURI(e),"')"),t&&(n+=" and (contains(msdyn_errorcode,'".concat(o,"') or contains(msdyn_exceptionmessage,'").concat(o,"') or contains(msdyn_activityid,'").concat(o,"') or contains(msdyn_solutionversion,'").concat(o,"'))")),n}return t?"(contains(msdyn_name,'".concat(o,"') or contains(msdyn_errorcode,'").concat(o,"') or contains(msdyn_exceptionmessage,'").concat(o,"') or contains(msdyn_activityid,'").concat(o,"') or contains(msdyn_solutionversion,'").concat(o,"'))"):t}var b=Object(l.translateService)("PowerappsPortal")(Object(i.withApolloClient)(d))},8013:function(t,e,o){"use strict";o.r(e),o.d(e,"useSolutionHistoryQuery",(function(){return c}));var n=o(217),r=o(245),i=o(3186),s=o(3192),a=o(3193),l=o(7461);function c(t,e,o,c){var u=a.TelemetryScenarioNames.solutionsHistoryGraphQl,[y,m]=Object(r.useState)(),[p,d]=Object(r.useState)(""),{loading:g,data:b}=Object(i.useQuery)(l.solutionsHistoryQuery,{client:t||void 0,fetchPolicy:"no-cache",onCompleted:t=>{y&&(y.complete({solutionsHistoriesLength:t&&t.solutionsHistory.solutionHistoryList&&t.solutionsHistory.solutionHistoryList.length}),m(void 0)),d("")},onError:t=>{var e=Object(s.getResponseMessageFromApolloError)(t,c);d(e),y&&(y.failure({error:e,clientError:t&&t.message}),m(void 0))},variables:e});return Object(r.useEffect)(()=>{g&&m(Object(n.trackLoadScenario)(o,u))},[g]),{loading:g,errorMessage:p,solutionsHistoryList:b&&b.solutionsHistory.solutionHistoryList,hasNextLink:b&&!!b.solutionsHistory.nextLink}}},8014:function(t,e,o){"use strict";o.r(e),o.d(e,"solutionHistoryListPageStyleClasses",(function(){return s})),o.d(e,"solutionsHistoryListPageStyle",(function(){return a})),o.d(e,"solutionDetailsPanelStyle",(function(){return l})),o.d(e,"searchBoxStyles",(function(){return c}));var n=o(719),r=o(2882),i=o(5492),s=Object(n.mergeStyleSets)({breadcrumbs:["solutions-history-breadcrumb-link-title",{selectors:{".ms-Breadcrumb-itemLink":{selectors:{".ms-TooltipHost":{height:"24px",left:"8px",right:"20px",fontFamily:i.fonts.segoeUi,fontSize:"18px",lineHeight:"24px",display:"flex",alignItems:"center",color:r.fabricColors.neutralChicago}}},".ms-Breadcrumb-item":{selectors:{".ms-TooltipHost":{height:"24px",left:"8px",right:"20px",fontFamily:i.fonts.segoeUi,fontSize:"18px",lineHeight:"24px",display:"flex",alignItems:"center",color:r.fabricColors.neutralTuatara}}}}}],commandBar:["solutions-history-commandBar",{selectors:{".ms-FocusZone":{backgroundColor:r.fabricColors.white}}}],listPageBreadCrumbWrapper:["solutions-history-list-page-breadcrumb",{width:"50%",height:"36px"}],listPageCommandbarWrapper:["solutions-history-list-page-commandbar",{width:"50%",height:"36px",display:"flex",justifyContent:"flex-end"}],solutionsHistoryListPageListcontainer:["solutions-history-list-page-listcontainer",{height:"100%",background:r.fabricColors.white,padding:"10px 0"}]}),a={content:{selectors:{".ba-Page-Body":{top:"40px"}}}},l={scrollableContent:{height:"99%"}},c={root:{top:"1px",position:"relative",border:"0px",borderBottom:"1px solid ".concat(r.fabricColors.neutralGray),width:"180px",height:"36px"},iconContainer:{selectors:{input:{height:"20px",fontSize:"14px",lineHeight:"20px",fontFamily:i.fonts.segoeUi,color:r.fabricColors.neutralTuatara,left:"32px",marginTop:"7px",marginBottom:"9px"}}},icon:{width:"16px",height:"16px",left:"8px",lineHeight:"19px",marginTop:"10px",marginBottom:"10px"}}}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/265.efe249ee.chunk.js.map