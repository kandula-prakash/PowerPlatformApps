(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/5.js?v=1.4.3886-master"]={begin:performance.now()},(window.__wpJsonpUci=window.__wpJsonpUci||[]).push([[5],{sra9:function(e,n,t){"use strict";t.d(n,"c",(function(){return I})),t.d(n,"b",(function(){return C})),t.d(n,"e",(function(){return w})),t.d(n,"f",(function(){return O})),t.d(n,"a",(function(){return j})),t.d(n,"d",(function(){return h})),t.d(n,"g",(function(){return P})),t.d(n,"h",(function(){return E}));var o=t("NjDY"),i=t("hAdb"),r=t("Lyxw"),a=t("3/02"),c=t("4S6y"),l=t("E5IU"),s=t("BDhr"),d=t("fMBw"),u=t.n(d),p=t("SZCI"),f=t("IqkD"),v=t("zI6t"),g=t.n(v),b=t("FdKt"),m=t("4leG");function I(e){return e.appHostClient.initialized}function C(e){return e.appHostClient.error}function w(e){const{geoName:n,isSovereignCloud:t}=Object(o.D)(e);if(Object(r.f)(e,a.De))return"Test";switch(null==n?void 0:n.toUpperCase()){case"TIP":const n=Object(i.c)(e,"canvashostenv");switch(null==n?void 0:n.toUpperCase()){case"LOCAL":return"Local";default:return"Test"}case"USG":return"GccHigh";case"NA":if(t)return"Gcc";default:const o=Object(i.c)(e,"canvashostenv");switch(null==o?void 0:o.toUpperCase()){case"PREVIEW":return"Preview";case"INT":return"Int";case"PREPROD":return"Preprod";default:return"Prod"}}}function O(e){switch(w(e)){case"Local":return c.Endpoint.Local;case"Test":return c.Endpoint.Test;case"Int":return c.Endpoint.Int;case"Preprod":return c.Endpoint.Preprod;case"Gcc":return c.Endpoint.Gcc;case"GccHigh":return c.Endpoint.GccHigh;case"Preview":return c.Endpoint.Preview;default:return c.Endpoint.Prod}}function j(e){return e.appHostClient.bundleLoaded}function h(e,n){var t,i;return{authMode:5,endpoint:O(e),hostConfig:{correlationId:n.EventManager.getCurrentSessionId(),locale:P(e),hostSettings:{renderAppInline:Object(r.f)(e,a.pg),serviceWorkerEnabled:A(e),enablePrebuiltContainers:Object(r.f)(e,a.Uf),resolveWithPartialAppHostClientInit:Object(r.f)(e,a.Df)},serviceWorkerConfig:y(e),hostServices:{executeWhenWorkEnded:b.b},reporting:{reportOperation:E},source:"UCI",isPreviewMode:Object(m.e)(e),skipLaunchAppCache:Object(m.e)(e)||Object(m.g)(e)},environmentConfig:{appMetadataVersion:null===(t=Object(s.a)(e))||void 0===t?void 0:t.toString(),id:Object(o.y)(e),orgId:null===(i=Object(o.A)(e))||void 0===i?void 0:i.guid,appModuleName:Object(l.n)(e)}}}function P(e){const n=function(e){const n=Object(f.x)(e);return n.userCultureName||n.formatInfoCultureName}(e);switch(n){case"sr-Cyrl-CS":return"sr-Cyrl-RS";case"sr-Latn-CS":return"sr-Latn-RS";case"zh-HK":return"zh-TW";default:return n}}function E(e,n){switch(e){case"Performance":u.a.createEvent(n.eventName,p.b).createRetroactiveStopwatch(n.startTime,n.duration,n.additionalParameters);break;case"KPI":g.a.addKeyPerformanceIndicator(n.eventName,n.additionalParameters)}}function A(e){var n;if(!Object(r.f)(e,a.mc)||Object(m.e)(e))return!1;const t=null===(n=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===n?void 0:n.controller;if(!t||"activated"!==t.state)return!1;const o=new URL(t.scriptURL,window.location.origin);return!!o.searchParams.has("customPage")&&"true"===o.searchParams.get("customPage")}function y(e){if(Object(r.f)(e,a.mc)&&Object(r.f)(e,a.pg))return{iframeSourceRelativePath:"",appInstallerServiceWorkerRelativePath:"./uclient/sw.js?gcm=false&uci=false&customPage=true&installCustomPageCacheOnly=true"}}},wge3:function(e,n,t){"use strict";t.r(n),t.d(n,"AppHostClientSDKPath",(function(){return h})),t.d(n,"initializeAppHostClient",(function(){return A})),t.d(n,"loadAppHostSdk",(function(){return y}));var o=t("7cfk"),i=t("P4TJ"),r=t("sra9"),a=t("eL04"),c=t("SAYH"),l=t("P+p9"),s=t("EY5k"),d=t("YxC/"),u=t("NjDY"),p=t("Lyxw"),f=t("3/02"),v=t("5UJb"),g=t.n(v),b=t("fMBw"),m=t.n(b),I=t("SZCI"),C=t("H4dV"),w=t("zI6t"),O=t.n(w),j=t("zsAz");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const h="/apphost/clientsdk?version=1";function P(e){switch(e){case"error":return 2;case"success":return 1;case"warning":return 3;case"info":default:return 4}}let E;function A(e,n,t){return{type:"apphostclient.initialize.async",execute(s,d){var v,b,w,h,A,z;if(!d.AppHostClient){if(E)return E;const A=s.getState();if(Object(r.c)(A)===o.a.Initialize_Failed){const e=Object(r.b)(A);return Promise.reject(Object(j.d)(null===(v=null==e?void 0:e.errorInfo)||void 0===v?void 0:v.code,2147873360,null,null===(b=null==e?void 0:e.errorInfo)||void 0===b?void 0:b.localizedMessage))}if(C.a.getInstance().get_IsBrowserIE()){S(s,"IE_Custom_Page_Navigation_Error","unknown","IE not supported");const e=Object(r.b)(A);return Promise.reject(Object(j.d)(null===(w=null==e?void 0:e.errorInfo)||void 0===w?void 0:w.code,2147873360,null,null===(h=null==e?void 0:e.errorInfo)||void 0===h?void 0:h.localizedMessage))}return E=(async()=>{var v,b,C;let w,h,z=[];try{await y(s,d,t);const v=n||(Object(p.f)(A,f.l)?Object(r.d)(A,d):function(e,n,t){var o;return{authMode:5,endpoint:Object(r.f)(e),_rootAppId:t,hostConfig:{correlationId:n.EventManager.getCurrentSessionId(),locale:Object(r.g)(e),reporting:{reportOperation:r.h},source:"UCI"},environmentConfig:{orgId:null===(o=Object(u.A)(e))||void 0===o?void 0:o.guid}}}(A,d,e));w=g.a.trackWork("AppHostClientInit");h=m.a.createEvent("AppHostClientInit",I.b).startStopwatch(),z=H(A,v),await function(e,n,t,o){let a;const c=new Promise((e,n)=>{a=setTimeout(()=>n({message:"PowerAppsHostingSdk.initializeAsync timed out"}),o)}),l=async()=>{const o=await PowerAppsHostingSdk.initializeAsync(t);clearTimeout(a),n.AppHostClient=o,function(e,n){if(!Object(p.f)(e,f.kb))return;try{const n=Object(r.f)(e),t=localStorage.getItem(i.a),o=t?JSON.parse(t):[];n&&-1===o.indexOf(n)&&(o.push(n),localStorage.setItem(i.a,JSON.stringify(o)))}catch(e){n.TraceManager.getTracer("APPHOSTCLIENT_TRACER").warn("Adding AppHostClient endpoint to local store failed",[{name:"errordetails",value:e}])}}(e,n)};return Promise.race([l(),c])}(A,d,v,9e4),d.AppHostClient.on("appHostClientInitErrorEvent",function(e,n,t){return function(o){var i,r,a,c;const l=(null==o?void 0:o.code)||(null===(i=null==o?void 0:o.errorInfo)||void 0===i?void 0:i.code)||2415919107,s=(null==o?void 0:o.description)||(null==o?void 0:o.message)||(null===(r=null==o?void 0:o.errorInfo)||void 0===r?void 0:r.description);S(e,"Crm.GenericErrorMessage",l,s,(null==o?void 0:o.localizedMessage)||(null===(a=null==o?void 0:o.errorInfo)||void 0===a?void 0:a.localizedMessage));let d=[];throw d=H(e.getState(),t),d=(null==o?void 0:o.errorParameters)||[],d.push({name:"exception",value:o}),n.EventManager.ReportComponentFailure("AppHostClient.InitializeAppHostClient",s,void 0,d),Object(j.d)(s,l||2415919107,d,(null==o?void 0:o.displayTitle)||(null==o?void 0:o.name),(null===(c=null==o?void 0:o.errorInfo)||void 0===c?void 0:c.localizedMessage)||(null==o?void 0:o.displayMessage),null==o?void 0:o.stack)}}(s,d,v)),d.AppHostClient.on("appHostClientErrorEvent",(k=s.dispatch,function(e){e&&e.errorInfo&&k(Object(a.b)({level:2,message:e.errorInfo.localizedMessage,id:c.a.newGuid().guid,type:2,showCloseButton:!0}))})),d.AppHostClient.on("appHostClientNotification",function(e){return function(n){if(n&&n.notificationInfo){const t=n.notificationInfo.timeoutInMilliSec,o=c.a.newGuid().guid;e(Object(a.b)({level:P(n.notificationInfo.notificationType),message:n.notificationInfo.message,id:o,type:2,showCloseButton:!0,onCloseHandler:n.notificationInfo.clickHandler})),t>0&&1e4!==t&&setTimeout(()=>{e(Object(l.b)(o))},t)}}}(s.dispatch)),d.EventManager.ReportComponentSuccess("AppHostClient.InitializeAppHostClient",z),s.dispatch({type:i.c,payload:{initialized:o.a.Initialized,error:void 0}}),O.a.addKeyPerformanceIndicator("AppHostClientReady")}catch(e){const n=(null===(v=null==e?void 0:e.errorInfo)||void 0===v?void 0:v.description)||(null==e?void 0:e.message)||(null==e?void 0:e.description),t=(null===(b=null==e?void 0:e.errorInfo)||void 0===b?void 0:b.code)||(null==e?void 0:e.code)||(null==e?void 0:e.errorCode);if(t)s.dispatch(M(e));else{const e="Crm.GenericErrorMessage";await S(s,e,"UnknownError",n)}throw z=(null==e?void 0:e.errorParameters)||[],z.push({name:"exception",value:e}),d.EventManager.ReportComponentFailure("AppHostClient.InitializeAppHostClient",n,void 0,z),E=void 0,Object(j.d)(n,t||2415919107,z,(null==e?void 0:e.displayTitle)||(null==e?void 0:e.name),(null==e?void 0:e.localizedMessage)||(null==e?void 0:e.displayMessage)||(null===(C=null==e?void 0:e.errorInfo)||void 0===C?void 0:C.localizedMessage),null==e?void 0:e.stack)}finally{null==w||w(),null==h||h()}var k})()}const k=s.getState();if(Object(r.c)(k)===o.a.Initialize_Failed){const e=Object(r.b)(k);return Promise.reject(Object(j.d)(null===(A=null==e?void 0:e.errorInfo)||void 0===A?void 0:A.description,2415919107,null,null===(z=null==e?void 0:e.errorInfo)||void 0===z?void 0:z.localizedMessage))}return Promise.resolve()}}}async function y(e,n,t){const o=e.getState();if(!Object(r.a)(o)){const a=t||function(e){return Object(r.f)(e)+h}(o);await n.AssetLoader.loadScript(a),e.dispatch({type:i.b,payload:!0}),O.a.addKeyPerformanceIndicator("AppHostClientBundleLoaded")}}async function S(e,n,t,o,i){const r=[n];await e.dispatch(Object(s.e)(r));const a=Object(d.e)(e.getState(),r);e.dispatch(M({errorInfo:{code:t,localizedMessage:i||Object(d.c)(a,n),timestamp:Date.now(),description:o}}))}function H(e,n){return[{name:"fcbs",value:JSON.stringify({rootAppEnabled:Object(p.f)(e,f.l),inlineRenderingEnabled:Object(p.f)(e,f.pg),serviceWorkerEnabled:Object(p.f)(e,f.mc),preloadEnabled:Object(p.f)(e,f.Tf),prebuiltContainersEnabled:Object(p.f)(e,f.Uf),isPartialInitEnabled:Object(p.f)(e,f.Df)})},{name:"environmentConfig",value:JSON.stringify(n.environmentConfig)},{name:"environmentName",value:Object(r.e)(e)}]}function M(e){return{type:i.d,payload:{initialized:o.a.Initialize_Failed,error:e}}}}}]),window.bundleExecutionMarkers["scripts/5.js?v=1.4.3886-master"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();