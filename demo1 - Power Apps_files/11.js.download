(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/11.js?v=1.4.3886-master"]={begin:performance.now()},(window.__wpJsonpUci=window.__wpJsonpUci||[]).push([[11],{"+hq9":function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return o}));var r=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="form.setIsAutoSaving";function o(e,t,n){const o=Object(r.w)(t);return{type:a,payload:{isAutoSaving:n},meta:{pageId:e,contextKey:o}}}},"/qEh":function(e,t,n){"use strict";n.d(t,"b",(function(){return g})),n.d(t,"a",(function(){return O}));var r=n("sX6v"),a=n("bT7G"),o=n("arV0"),i=n("odYE"),c=n("5Oca"),s=n("i1f0"),u=n("BvQu"),l=n("P+kM"),d=n("dHD5"),f=n("SAYH"),b=n("y60j"),p=n("7Sr4"),m=n("JP46");function g(e,t){const n=[];return{type:"snapshot.update.async",execute({dispatch:g,getState:O},v,j){const h=v.TraceManager.getTracer("Forms.UpdateSnapshot"),y=O(),w=Object(d.j)(y,e),I={},F={},{entityTypeName:S,id:E,processId:P}=Object(o.j)(y,e);n.push({name:"entityTypeName",value:S},{name:"id",value:f.a.toString(E)},{name:"processId",value:P}),h.info("updateSnapshotWithOptions started.",n);const C=Object(s.hc)(y,e,w);if(!C)return n.push({name:"CorrelationId",value:j.correlationId},{name:"ContextId",value:j.contextId},{name:"ActionStack",value:j.stack}),h.warn("Null/undefined snapshotId",n),Promise.resolve({unboundAttributes:I,attributesPendingUpdate:F});n.push({name:"snapshotId",value:C});const N=Object(s.Yc)(y,e,w);N.length>0&&n.push({name:"updateFieldNames",value:N.slice(0,15).toString()});const T=[],A={},M=new i.a(S,E),k=Object(s.Jc)(y,e,w);return function(e,t,n,r,o,i,s,l){if(null==i)s.warn("Null/undefined submitModesByFieldName",l);else if(0===Object.keys(i).length)s.warn("0 length submitModesByFieldName",l);else{l.push({name:"NumSubmitModesByFieldName",value:Object.keys(i).length});for(const s in i)if(i[s]===u.a.Always){if(Object(a.f)(e,t,s))continue;r[s]=Object(c.j)(e,n,s)}else i[s]===u.a.Never&&Object(a.f)(e,t,s)&&o.push(s)}}(y,C,M,A,T,k,h,n),function(e,t,n,r,o,i,c){let s=Object(b.j)(e,t);const u=new Set(Object(b.w)(e,t));s&&s.length>0&&u&&(s=s.filter(e=>!u.has(e)));if(s&&s.length>0){c.push({name:"NumUnboundAttributes",value:s.length});let t=0;for(let c=0;c<s.length;++c)if(Object(a.g)(e,n,s[c])){const u=Object(a.e)(e,n,r,s[c]);u&&(i[s[c]]=u),o.push(s[c]),++t}c.push({name:"NumUnboundAttributesProcessed",value:t})}}(y,t,C,M,T,I,n),function(e,t,n,r,o){const i=Array.from(p.a.getInstance().getAttributesPendingUpdate());if((null==i?void 0:i.length)>0)for(let c=0;c<i.length;++c)if(Object(a.g)(e,t,i[c])){const s=Object(a.e)(e,t,n,i[c]);s&&(o[i[c]]=s),r.push(i[c])}}(y,C,M,T,F),function(e,t,n,r){const o=Object(a.b)(e,t);if(o){const i=o.activeChanges&&Object.keys(o.activeChanges);if(null==i?void 0:i.length)for(const s of i){const i=Object(c.j)(e,o.identifier,s),l=Object(a.e)(e,t,o.identifier,s);Object(m.b)(i,l,e)||r[s]===u.a.Always||n.push(s)}}}(y,C,T,k),Object.keys(A).length&&g(Object(r.b)(y,C,A)),T.length&&g(Object(l.b)(C,!0,T)),v.EventManager.ReportComponentSuccess("Forms.UpdateSnapshot",n),Promise.resolve({unboundAttributes:I,attributesPendingUpdate:F})},getFailureParameters:(e,t)=>n}}function O(e,t,n){const i=t?Object.keys(t).length:0,c=n?Object.keys(n).length:0,u=[{name:"numUnboundAttributes",value:i}];return{type:"snapshot.update.addAttributesBack.async",execute({dispatch:l,getState:b},p,m){const g=b(),O=Object(d.j)(g,e),{entityTypeName:v,id:j,processId:h}=Object(o.j)(g,e);u.push({name:"entityTypeName",value:v},{name:"id",value:f.a.toString(j)},{name:"processId",value:h});const y=Object(s.hc)(g,e,O);if(u.push({name:"snapshotId",value:y}),y){if(i>0&&l(Object(r.b)(g,y,t)),c>0){const e=Object.keys(n).filter(e=>!Object(a.g)(g,y,e));if(e.length>0){const t={};e.forEach(e=>{t[e]=n[e]}),l(Object(r.b)(g,y,t))}}p.EventManager.ReportComponentSuccess("Forms.AddAttributesBackToSnapshot",u)}else u.push({name:"CorrelationId",value:m.correlationId},{name:"ContextId",value:m.contextId},{name:"ActionStack",value:m.stack}),p.EventManager.ReportComponentFailure("Forms.AddAttributesBackToSnapshot",new Error("Null/undefined snapshotId"),"Check Forms.UpdateSnapshot. If that succeeded, so should this.",u);return Promise.resolve()},getFailureParameters:(e,t)=>u}}},"1HWW":function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return l})),n.d(t,"b",(function(){return u}));var r=n("dHD5"),a=n("iF9X"),o=n("SAYH"),i=n("sZ+8"),c=n("69Qu");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const s="has.offline.changes";function u(e,t){const n=[{name:"entityLogicalName",value:e}];return{type:"has.offline.changes.async",async execute({dispatch:r,getState:s},u,l){const d=s(),f=Object(c.c)(d),b=Object(a.a)(d),p=Object(i.n)(d,e);if(n.push({name:"CorrelationId",value:l.correlationId},{name:"ContextId",value:l.contextId},{name:"ActionStack",value:l.stack},{name:"isServerAvailableFromState",value:f},{name:"isMocaOfflineEnabled",value:b},{name:"isEntityAvailableForOffline",value:p}),!f&&b&&p){const r=await u.OfflineProvider.hasOfflineChanges(e,o.a.toLegacyGuid(t));return u.EventManager.ReportComponentSuccess("Forms.SetHasOfflineChanges.HasOfflineChanges",n),r}return u.TraceManager.getTracer("Forms.SetHasOfflineChanges").warn("Not checking for offline changes.",n),!1},getFailureParameters:(e,t)=>n}}function l(e,t,n){const a=Object(r.w)(t);return{type:s,payload:{hasOfflineChanges:n},meta:{pageId:e,contextKey:a}}}},"1uZV":function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var r=n("SAYH"),a=n("zu1I"),o=n("i1f0"),i=n("bT7G"),c=n("dHD5"),s=n("YYhu"),u=n("uIhY"),l=n("iZ7K"),d=n("uNLT"),f=n("zmL5");function b(e,t,n){const b=[];return{type:"form.openManageDuplicatesDialog",execute({dispatch:p,getState:m},g,O){var v,j;const h=m(),y=n?Object(i.c)(h,n):Object(i.b)(h,Object(o.hc)(h,e,Object(c.j)(h,e)));if(y&&y.identifier){const n=g.TraceManager.getTracer(d.b),i=Object(s.b)(h,y,n);let c,m;const w=i.get_identifier(),I=w.LogicalName;try{c=Object(u.b)(h,i),m=Object.assign({"@odata.type":"#Microsoft.Dynamics.CRM."+I},c)}catch(e){const t=[{name:"CorrelationId",value:O.correlationId},{name:"ContextId",value:O.contextId},{name:"ActionStack",value:O.stack}];return g.EventManager.ReportComponentFailure("Forms.OpenManageDuplicatesDialog",Error(JSON.stringify(e)),void 0,t),Promise.resolve({status:1,error:e})}if(!Object(o.kd)(h,e)&&!r.a.isNullOrEmpty(r.a.fromLegacyGuid(w.Id))){m[Object(l.h)(h,I).PrimaryKeyName]=w.Id.toString()}const F=function(e){var t,n,r,a,o,i,c,s,u,l;const d=function(e){var t;const n=null===(t=null==e?void 0:e.errorFault)||void 0===t?void 0:t.get_innerFault();return null==n?void 0:n.get_message()}(e),f=d?null===(t=JSON.parse(d))||void 0===t?void 0:t.DuplicateAttributes:void 0,b=new DOMParser,p=f?b.parseFromString(f,"text/xml"):void 0;if((null===(a=null===(r=null===(n=null==p?void 0:p.getElementsByTagName("DuplicateValues"))||void 0===n?void 0:n[0])||void 0===r?void 0:r.children)||void 0===a?void 0:a.length)>0){const e={},t=p.getElementsByTagName("DuplicateValues")[0].children;for(let n=0;n<t.length;n++){const r=null===(i=null===(o=t[n])||void 0===o?void 0:o.getAttribute("key"))||void 0===i?void 0:i.toString(),a=null===(l=null===(u=null===(s=null===(c=t[n])||void 0===c?void 0:c.childNodes)||void 0===s?void 0:s[0])||void 0===u?void 0:u.nodeValue)||void 0===l?void 0:l.toString();r&&a&&(e[r]=a)}return e}return{}}(t),S={entity_record:Object.assign(Object.assign({},m),F)},E=Object(f.b)(h,e);b.push({name:"formId",value:null===(v=null==E?void 0:E.guid)||void 0===v?void 0:v.toString()},{name:"entityName",value:I},{name:"entityId",value:null===(j=null==w?void 0:w.Id)||void 0===j?void 0:j.toString()}),g.EventManager.ReportComponentSuccess("Forms.OpenManageDuplicatesDialog",b);const P={height:"600px",width:"800px"};return p(Object(a.b)("ManageDuplicates",P,S,e)).then(e=>(g.EventManager.ReportComponentSuccess("Forms.OpenManageDuplicatesDialog",b),e))}b.push({name:"SnapshotExists",value:null!=y}),g.TraceManager.getTracer("Forms.OpenManageDuplicatesDialog").warn("Null/undefined snapshot or snapshot.identifier.",b)},getFailureParameters:(e,t)=>b}}},"4UCL":function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return c}));var r=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const a="userUpdatedFields.add",o="userUpdatedFields.clear";function i(e,t,n){const o=Object(r.y)(t);return{type:a,payload:{fieldValues:n},meta:{pageId:e,contextKey:o}}}function c(e,t,n){const a=Object(r.y)(t);return{type:o,payload:{keepFields:n},meta:{pageId:e,contextKey:a}}}},"5R5s":function(e,t,n){"use strict";n.d(t,"a",(function(){return N}));var r=n("85o3"),a=n("YxC/");var o=n("w+N3"),i=n("EY5k");async function c({dispatch:e,getState:t},n){await e(Object(i.e)(o.c));const r=function(e,t,n){const r=Object(a.e)(e,t),o={};if(n)for(const e in n)o[e]=Object(a.c)(r,n[e].filterLabel);return o}(t(),o.c,o.b),c=[];for(const e in o.b){const t={value:o.b[e].filterValue,text:r[e]};"all"===e&&(t.isDefault=!0),c.push(t)}return c}var s=n("PVDM"),u=n("Xd5/"),l=n("BFlg"),d=n("Ae6N");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function f(e,t,n){let r,a,o=null;if(e)switch(e){default:case"All":break;case"Today":a=e,r="all";break;case"Overdue":case"Tomorrow":case"NextXDays;7":case"NextXDays;30":case"NextXDays;90":case"NextXMonths;6":case"NextXMonths;12":a=e,r="active"}if(a&&r){const i=function(e,t,n){if(!e||"All"===e)return null;let r=null;const a=[],o="scheduledend";if("inactive"!==t){const{formatInfoCultureName:t,numberFormatInfo:i,dateFormatInfo:c}=n,s=new Sys.CultureInfo(t,i,c),l=Object(u.s)(new Date,s,d.a.UserLocal,n.timeZoneUtcOffsetMinutes,n.timeZoneAdjusters);a.push({attributeName:o,conditionOperator:3,value:l}),"Overdue"!==e&&a.push(b(o,e)),"Tomorrow"===e&&a.push(b(o,"Today")),a&&a.length>0&&(r={conditions:a,filterOperator:1})}return r}(a,r,t),c=function(e,t,n){if("All"===e)return null;let r=null;const a=[],o={attributeName:"statecode",conditionOperator:0,value:"Open"},i={attributeName:"statecode",conditionOperator:0,value:"Completed"},c={attributeName:"statecode",conditionOperator:0,value:"Canceled"},s={attributeName:"statecode",conditionOperator:0,value:"Scheduled"};switch(t){default:case"active":switch(a.push(o),n){case"serviceappointment":case"appointment":case"recurringappointmentmaster":case l.a:a.push(s);break;case"email":a.push(i)}break;case"inactive":a.push(i),a.push(c);break;case"all":}a&&a.length>0&&(r={conditions:a,filterOperator:1});return r}(e,r,n),s=function(e,t){let n=null;if(t&&"All"!==t){const e=[b("actualend",t)];e&&e.length>0&&(n={conditions:e,filterOperator:0})}return n}(0,undefined),f=[];i&&f.push(i),c&&f.push(c),s&&f.push(s),o={filterOperator:0,conditions:null,filters:f}}else o={conditions:null,filterOperator:0,filters:[]};return o}function b(e,t){const n=t.split(";"),r=n.length>1?n[1]:"";return{attributeName:e,conditionOperator:p(n[0]),value:r}}function p(e){if(!e)return null;switch(e){case"Today":return 15;case"Tomorrow":return 16;case"Yesterday":return 14;case"NextXDays":return 34;case"NextXMonths":return 38;case"LastXDays":return 33;case"LastXMonths":return 37}}var m=n("lEp6"),g=n("uNu9"),O=n("FZDd"),v=n("LbMF"),j=n("jRy5"),h=n("jAuy");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const y="GridFilterOptionsKeyForValueAll";function w({dispatch:e,getState:t},n,r,c){if(c&&Object(h.h)(t(),c.relationshipName,c.contextTokenType===j.a.AssociatedGrid)){const n=e(Object(i.e)([o.a])),c=e(Object(O.f)(r,!1,["statecode"]));return Promise.all([n,c]).then(()=>{let e=[];const n=Object(v.a)(t(),r,"statecode");n&&n.OptionSet&&(e=n.OptionSet.map(e=>({value:e.Value.toString(),text:e.Label,isDefault:e.Value===n.DefaultValue})));const i=Object(a.e)(t(),[o.a]);return e.push({value:y,text:Object(a.c)(i,o.a)}),e})}return Promise.resolve([])}var I=n("XvLr");const F="queueid",S="statecode",E="scheduledend",P="statecode",C="msdyn_forecastdefinitionid";function N(e,t,n,a,o,i){if(!e)return null;let u=t&&t.guid;const d=(e,t=r.b)=>{const n=t.replace(/-/g,"");return e.concat(n)},b=()=>(u||(u=t&&t.guid),u),p=e=>({filterOperator:1,hint:"union",conditions:[{attributeName:"queueviewtype",conditionOperator:0,value:"0",entityAliasName:d("Q_Internal_",e)},{attributeName:"systemuserid",conditionOperator:0,value:b(),entityAliasName:d("M_Internal_",e)}]}),O=e=>{const t=[];return t.push({name:"queue",from:"queueid",to:"queueid",alias:d("Q_Internal_",e),linkType:"inner"}),t.push({name:"queuemembership",from:"queueid",to:"queueid",alias:d("M_Internal_",e),linkType:"outer"}),t},v=e=>{if(!e)return null;const t=e.split(":");t.length>1&&(e=t[1]);const n=e.toString();if(n===r.a)return p(n);if(n===r.e){return{filterOperator:1,conditions:[{attributeName:"queueviewtype",conditionOperator:0,value:"0",entityAliasName:d("Q_Internal_",n)}]}}if(n===r.d){return{filterOperator:0,conditions:[{attributeName:"queueviewtype",conditionOperator:0,value:"1",entityAliasName:d("Q_Internal_",n)},{attributeName:"systemuserid",conditionOperator:0,value:b(),entityAliasName:d("M_Internal_",n)}]}}const o=[],c={conditions:[],filterOperator:0},s=e.split(r.c);if(s.length){const e={attributeName:"queueid",conditionOperator:8,value:s};c.conditions.push(e)}if(o.push(c),i||!1===a){const e=p(r.a);o.push(e)}return{filterOperator:0,conditions:[],filters:o}};if(o||e.toLowerCase()===l.a)return{getAdditionalColumns:()=>[E,S],getFilterOptionsAction:()=>Object(r.i)(e,n,c),getFilterExpression:(e,t,n)=>{const r=f(e,t,n);return r?JSON.stringify(r):""},getFilterAndLinkedEntities:e=>null,getFilterLabelResourceKey:()=>I.ACTIVITY_DUE_DATE_FILTER_LABEL};switch(e.toLowerCase()){case"queueitem":return{getAdditionalColumns:()=>[F],getFilterOptionsAction:()=>Object(r.i)(e,n,r.j),getFilterExpression:e=>{const t=v(e);return t?Object(m.b)(t):null},getFilterAndLinkedEntities:(e,t)=>{if(null!=e){const n=e.split(":"),o=(e=n.length>1?n[1]:n[0]).toString();let c=null;if(t&&(c=v(o)),o===r.e){const e=[];return e.push({name:"queue",from:"queueid",to:"queueid",alias:d("Q_Internal_",o),linkType:"inner"}),{filter:c,linkEntities:e}}if(o===r.d){const e=[];return e.push({name:"queue",from:"queueid",to:"queueid",alias:d("Q_Internal_",o),linkType:"inner"}),e.push({name:"queuemembership",from:"queueid",to:"queueid",alias:d("M_Internal_",o),linkType:"inner"}),{filter:c,linkEntities:e}}return{filter:c,linkEntities:i||!1===a||o===r.a?O(r.a):null}}return null},getFilterLabelResourceKey:()=>I.QUEUE_FILTER_LABEL};case s.a:return{getAdditionalColumns:()=>[C],getFilterOptionsAction:()=>Object(r.i)(e,n,s.b),getFilterExpression:(e,t,n)=>{if(!e)return null;const r=e.indexOf(":");-1!==r&&(e=e.substring(r+1));const a=Object(s.c)(e,t,n);return a?JSON.stringify(a):""},getFilterAndLinkedEntities:()=>null,getFilterLabelResourceKey:()=>I.QUEUE_FILTER_LABEL};case g.mb:case g.Y:case g.Z:case g.Ib:case g.Ab:case g.B:return{getAdditionalColumns:()=>[P],getFilterOptionsAction:()=>Object(r.i)(e,n,w),getFilterExpression:(e,t,n)=>{if(!e)return null;const r=function(e,t,n){if(!e||e===y)return null;let r=null;const a=[];return a.push({attributeName:"statecode",conditionOperator:0,value:e}),a&&a.length>0&&(r={conditions:a,filterOperator:1}),r}(e);return r?JSON.stringify(r):""},getFilterAndLinkedEntities:()=>null,getFilterLabelResourceKey:()=>I.GRID_FILTER_LABEL};default:return{getAdditionalColumns:()=>null,getFilterOptionsAction:()=>Object(r.i)(e,n,r.g),getFilterExpression:()=>null,getFilterAndLinkedEntities:()=>null,getFilterLabelResourceKey:()=>null}}}},"5iTp":function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return s}));var r=n("i1f0"),a=n("Lyxw"),o=n("3/02"),i=n("dpM5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function c(e,t,n){const a=Object(r.fb)(e,t,n);return a?a.footer:null}function s(e){return Object(a.e)(e,i.j,o.kf)}},"5sJC":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("AULO"),a=n("pEXn"),o=n("+Qpx");function i(e){return{type:"formChecker.UnsavedChanges.async",execute({},t){var n;const i=null===(n=null==t?void 0:t.TraceManager)||void 0===n?void 0:n.getTracer(`${o.u}${o.I}`);if(!i)return Promise.resolve();const c=Object(r.e)(),s=Object(r.g)(),u=[{"Reported from":e},{"All attributes modified":s},{"Unsaved changes":c}];i.warn(o.B,[{name:a.l,value:o.I},{name:o.I,value:JSON.stringify(u)}])}}}},"7yvg":function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("SAYH"),a=n("504W"),o=n("+nNZ"),i=n("iZ7K");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function c(e,t,n){const c=[];if(e&&!r.a.isNullOrEmpty(t)&&n){const r=Object(o.a)(e,t);if(r&&r.businessProcessFlowStepEntityAttributeControls){const t=r.businessProcessFlowStepEntityAttributeControls[n];if(!Object(a.a)(t)){const r=Object(i.h)(e,n);if(!Object(a.a)(r)){const e=r.AttributeNames;Object(a.a)(e)||Object.keys(t).forEach(n=>{const r=t[n].DataFieldName;!Object(a.b)(r)&&e.indexOf(r)>-1&&c.push(r)})}}}}return c}},AULO:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return o})),n.d(t,"h",(function(){return s})),n.d(t,"f",(function(){return u})),n.d(t,"g",(function(){return l})),n.d(t,"e",(function(){return d})),n.d(t,"d",(function(){return f}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="Form footer",a="Unsaved changes dialog",o="SaveForm",i={},c={};function s(e,t){if(!i[e]){const n={[t]:[]};i[e]=n}return i[e][t]||(i[e][t]=[]),i[e][t]}function u(e,t){if(c[e])c[e][t]="";else{const n={[t]:""};c[e]=n}return c[e]}function l(){return c}function d(){return i}function f(){i&&(Object.keys(i).forEach(e=>{delete i[e]}),Object.keys(c).forEach(e=>{delete c[e]}))}},"Bj/n":function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return l}));var r=n("/Ikn"),a=n("dGG5"),o=n("YxC/"),i=n("xy1J"),c=n("zJiL");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const s="form.notification.set";function u(e,t,n,o,i,u,l,d){return{type:"form.notification.set.sync",sync:!0,execute(f,b){c.f.has(o)&&(o=c.b);const p=b.ScriptManager.getContainer(t).getEventManager();u=u||[],l=l||[],Object(r.a)(e,i,u,p);for(const t in u){const n=u[t],a=Object(r.b)(i,t);p.addOnClickEvent(e,a,n.Handler)}Object(a.a)(e,i,l,p);for(const t in l){const n=l[t],r=Object(a.b)(i,t);n.Handler&&p.addOnClickEvent(e,r,n.Handler)}return f.dispatch(function(e,t,n,r,a,o,i){return{type:s,payload:{uniqueId:r,message:t,level:n,buttons:a,placeholders:o,controlName:i,componentId:e},meta:{pageId:e}}}(t,n,o,i,u,l,d))}}}function l(e,t){return{type:"form.notification.label.sync",sync:!0,execute({dispatch:n,getState:r},a,c){const s=Object(o.b)(r(),i.k);return String.format(s,e,t)}}}},DBoP:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class r{constructor(e,t,n,r){this._isIgnorable=e,this._continueExecution=t,this._canNavigate=n,this._canForceNavigate=r}getIsIgnorable(){return this._isIgnorable}getContinueExecution(){return this._continueExecution}getCanNavigate(){return this._canNavigate}getCanForceNavigate(){return this._canForceNavigate}}},Fij2:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(){try{return window&&window.opener&&window.opener.parent&&window.opener.LOCID_BRANDNAME&&(window.opener.parent.IsUCI&&window.opener.auto||window.opener.parent.parent&&window.opener.parent.parent.refreshCurrentGrid&&window.opener.parent.parent.IsHybridAF)}catch(e){return!1}}function a(e){e&&r()&&window.opener.auto&&(window.opener.parent.IsUCI||window.opener.parent.parent.IsHybridAF)&&(window.opener.gridrefreshsource="child",window.opener.auto(Xrm.Internal.getEntityCode(e.getEntityName()),e.getPrimaryAttributeValue(),e.getId()))}function o(e){r()&&window.opener.parent.parent.refreshCurrentGrid&&window.opener.parent.parent.IsHybridAF&&window.opener.parent.parent.refreshCurrentGrid(e)}function i(e){return!(e||!r())&&(window.close(),!0)}n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return i}))},Izjb:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return b}));var r=n("fMBw"),a=n.n(r),o=n("SZCI"),i=n("SAYH"),c=n("i1f0"),s=n("WIoD"),u=n("zI6t"),l=n.n(u);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const d="FormOnloadCompleteEvent";class f{constructor(e,t,n,r,a,o,i){this._isSaveForm=o,this._callback=i,this._callbackCalled=!1,this._editReadyTime=0,this._controlsShouldRender=new Set,this._controlsRendered=new Set;const u=[s.a.guid,s.b.guid,s.g.guid],l=Object(c.J)(e,t,n,r,a);l&&Object.keys(l).forEach(e=>{const t=l[e];e&&t&&t.Visible&&u.indexOf(t.ClassId.guid)<0&&this._controlsShouldRender.add(e)})}writeMarker(e,t,n){this._receivedEvent(e,t,n)}writeRetroactiveTimespan(e,t,n,r){this._receivedEvent(e,t+n,r)}startTimespan(e,t,n){return(r,a)=>{this._receivedEvent(e,t+r,n)}}_receivedEvent(e,t,n){if(this._callbackCalled)return;const r=e.getName(),a=!this._isSaveForm&&r===o.r,i=this._isSaveForm&&r===o.t;if(a||i){const e=this._getControlName(n);this._controlsShouldRender.has(e)&&!this._controlsRendered.has(e)&&(this._controlsRendered.add(e),this._editReadyTime<t&&(this._editReadyTime=t))}else r===d?this._editReadyTime<t&&(this._editReadyTime=t):r!==o.m&&r!==o.x||(this._callbackCalled=!0,this._callback({timestamp:this._editReadyTime}))}_getControlName(e){const t=e[o.q];return t||null}}function b(e,t,n,r,c,s,d,b){const p=new f(e,t,n,s,d,b,e=>{a.a.removeTransport(p);const t=r&&r.id?r.id.guid:"null";!function(e,t,n,r,a){l.a.addKeyPerformanceIndicator(r,{formId:i.a.toString(e),recordId:t,etn:n},a)}(n,t,c,"RenderedEditReady",e.timestamp)});a.a.registerTransport(p,[u.KPI_ZONE,o.j,o.f])}},LAcd:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="form.SuppressDuplicateDetection.set";function a(e,t){return{type:r,payload:{suppressDuplicateDetection:t},meta:{pageId:e}}}},NDmk:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return r}));const r="form.output";function a(e,t){return{type:r,payload:{reason:"save",value:t},meta:{pageId:e}}}},NPZ3:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return l}));var r=n("LbMF"),a=n("iZ7K"),o=n("8nT0"),i=n("tJdb"),c=n("O7zD");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function s(e,t){const n=l(e,t,!0),r=u(e,t);return(null==r?void 0:r.length)&&n.push(...r),n}function u(e,t){const n=[],a=Object(r.d)(e,t);return a&&Object.keys(a).forEach(e=>{const t=a[e];if(t.SourceType===i.a.Rollup){let e=t.LogicalName;!0===t.IsBaseCurrency&&(e=e.substring(0,e.length-5)),n.push(e+"_date"),n.push(e+"_state")}}),n}function l(e,t,n){const r=[],i=Object(a.h)(e,t);return i&&(i.HasStateCode&&r.push(o.x),i.PrimaryIdAttribute&&r.push(i.PrimaryIdAttribute),i.PrimaryImageAttribute&&r.push(Object(c.a)(i.PrimaryImageAttribute,null,null)),i.PrimaryNameAttribute&&(n&&i.PrimaryNameAttribute===o.l?r.push(o.l):n||r.push(i.PrimaryNameAttribute)),i.IsBPFEntity&&(r.push(o.t),r.push(o.A),r.push(o.a))),r}},PUjk:function(e,t,n){"use strict";let r;function a(e){r=e}function o(e,t){return r?r.getProcessManager(e,t):null}function i(e){return r?r.getCurrentProcessManagerWithoutInit(e):null}n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i}))},PVDM:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return r}));const r="msdyn_forecastinstance";function a({dispatch:e,getState:t},n){return new Promise((e,t)=>{Xrm.WebApi.retrieveMultipleRecords(r,"?fetchXml=\n<fetch version='1.0' mapping='logical' distinct='true' >\n\t<entity name='msdyn_forecastinstance'>\n\n\t\t<attribute name='msdyn_forecastdefinitionid'/>\n\n\t\t<link-entity name='msdyn_forecastdefinition' from='msdyn_forecastdefinitionid' to='msdyn_forecastdefinitionid' alias='fd'>\n\t\t\t<attribute name='msdyn_forecastdefinitionname'/>\n\t\t\t<attribute name='modifiedon'/>\n\t\t</link-entity>\n\n\t\t<filter type='and'> \n\t\t\t<condition attribute='ownerid' operator='eq-userid'/> \n\t\t</filter>\n\t\t\n\t</entity>\n\n</fetch>\n").then(t=>{const n=[],r=t.entities,a=n.length;r.sort((e,t)=>new Date(t["fd.modifiedon"]).getTime()-new Date(e["fd.modifiedon"]).getTime());for(let e=0;e<r.length;e++){const t=`${a+e}:${r[e]._msdyn_forecastdefinitionid_value}`;n.push({value:t,text:r[e]["fd.msdyn_forecastdefinitionname"],isDefault:!1})}n.length>0&&(n[0].isDefault=!0),e(n)})})}function o(e,t,n){let r=null;const a=[];return a.push({attributeName:"msdyn_forecastdefinitionid",conditionOperator:0,value:e}),a&&a.length>0&&(r={conditions:a,filterOperator:1}),r}},SFvV:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}));var r=n("hAdb"),a=n("iB7y");function o(e,t,n,o,i,c){return{type:"dataSnapshotForSolution.save.async",execute({getState:s,dispatch:u},l){const d=s(),f=Object(r.i)(d);return u(Object(a.b)(e,t,n,o,f,i,c))}}}function i(e,t,n,o,i,c){return{type:"dataSnapshotForSolution.saveMultiple.async",execute({getState:s,dispatch:u},l){const d=s(),f=Object(r.i)(d);return u(Object(a.c)(e,t,n,o,f,i,c))}}}},UqQu:function(e,t,n){"use strict";n.d(t,"a",(function(){return O}));var r=n("SAYH"),a=n("5Oca"),o=n("pF61"),i=n("JP46"),c=n("bT7G"),s=n("i1f0"),u=n("nC8a"),l=n("odYE"),d=n("LbMF"),f=n("504W"),b=n("dHD5"),p=n("jq7Z"),m=n("gYxr"),g=n("g03H");function O(e,t,n,b,p){const m=[{name:"pageId",value:e}];return{type:"triggerdirtyonchangehandlers.async",execute({dispatch:O,getState:h},y,w){const I=h();if(!Object(o.m)(I,e)||Object(u.a)(h(),e)){const o=y.ScriptManager.getContainer(e).getEventManager();if(n||y.EventManager.ReportComponentFailure("Forms.TriggerDirtyOnChangeHandlers",new Error("Missing contextToken"),null,m),o){const u=function(e,t,n,o,u,b,p){var m,O;const h=[];if(e&&t&&!Object(f.b)(n)&&!Object(f.b)(o)){const f=Object(a.h)(t,n,o),y=Object(s.hc)(e,u,b),w=f&&f.fields,I=new l.a(n,new r.a(o)),F=Object(d.d)(t,I.etn),S={};for(const n in F){const r=F[n],a=Object(c.e)(e,y,I,r.LogicalName),o=w[r.LogicalName],s=j(t,u),l=null===(m=null==s?void 0:s[r.LogicalName])||void 0===m?void 0:m.previousOldValue,d=null===(O=null==s?void 0:s[r.LogicalName])||void 0===O?void 0:O.previousNewValue;let f=!0;if(Object(g.l)(null==s?void 0:s[r.LogicalName])||Object(i.b)(l,a,t)||Object(i.b)(d,o,t)||(f=!1),Object(i.b)(a,o,t)&&f){h.push(r.LogicalName),S[r.LogicalName]={previousOldValue:a,previousNewValue:o};p(v(u,b,Object.assign(Object.assign({},s),S)))}}}return h}(t,I,b,r.a.toString(p),e,n,O);if(u)for(const e of u)O(o.runOnChange(n,e));y.EventManager.ReportComponentSuccess("Forms.TriggerDirtyOnChangeHandlers",m)}else y.EventManager.ReportComponentFailure("Forms.TriggerDirtyOnChangeHandlers",new Error("Missing eventManager"),null,m)}else y.EventManager.ReportComponentSuccess("Forms.TriggerDirtyOnChangeHandlers",m);return Promise.resolve()},getFailureParameters:(e,t)=>m}}function v(e,t,n){const r=Object(b.w)(t);return{type:m.a,payload:n,meta:{pageId:e,contextKey:r}}}function j(e,t){var n;return null===(n=Object(p.a)(e,t))||void 0===n?void 0:n.previousAttributeChanges}},Yx7Y:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r=n("SAYH").a.EMPTY},Zzxs:function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"d",(function(){return a})),n.d(t,"b",(function(){return o})),n.d(t,"e",(function(){return i})),n.d(t,"a",(function(){return c}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="nf_serverValidationError",a="nf_formsyncerrornotificationId",o="nf_duplicateDetectionValidationError",i="unsavedchanges_monitor_notification",c="footerControls_monitor_notification"},g6bs:function(e,t,n){"use strict";n.d(t,"a",(function(){return T})),n.d(t,"b",(function(){return M})),n.d(t,"c",(function(){return _})),n.d(t,"f",(function(){return A}));var r=n("Lyxw"),a=n("SAYH"),o=n("i1f0"),i=n("bT7G"),c=n("sX6v"),s=n("dHD5"),u=n("WY/A"),l=n("Dea/"),d=n("odYE"),f=n("iZ7K"),b=n("5Oca"),p=n("xMtD"),m=n("CPoS"),g=n("arV0"),O=n("PUjk"),v=n("LbMF"),j=n("/A0C"),h=n("4Us1"),y=n("AFlp"),w=n("k1f1"),I=n("ycdb"),F=n("TBkx"),S=n("FZDd"),E=n("fh2P");n.d(t,"d",(function(){return E.f})),n.d(t,"e",(function(){return E.g}));var P=n("69Qu"),C=n("sZ+8"),N=n("3/02");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function T(e,t,n,j,h){if(!(e&&t&&n&&j&&h))return null;let y=null;try{const w=Object(g.j)(t,h);if(!w)return n.EventManager.ReportComponentFailure("ProcessManagerHelper.generateBPFInstanceSnapshotId","page input is null."),null;if(!Object(o.Qb)(t,h)){const e=Object(O.b)(h,w);return e&&e.generateBPFInstanceSnapshotId()}if(!Object(r.f)(t,N.Wg))return null;const I=Object(o.hc)(t,h,j),F=Object(i.b)(t,I);if(!F||!F.identifier||!F.identifier.etn)return n.EventManager.ReportComponentFailure("ProcessManagerHelper.generateBPFInstanceSnapshotId","primary entity snapshot is invalid."),null;const T=F.identifier.etn;let A=F.identifier.id;const k=Object(b.d)(t,T);if(a.a.isNullOrEmpty(k))return null;const _=Object(m.a)(t,k);if(!_)return n.EventManager.ReportComponentFailure("ProcessManagerHelper.generateBPFInstanceSnapshotId",`The BPF unique name is null for processId - ${k}.`),null;if(_===T)return n.EventManager.ReportComponentFailure("ProcessManagerHelper.generateBPFInstanceSnapshotId",`This is immersive BPF with processId - ${k}.`),null;if(!Object(P.c)(t)&&!Object(C.n)(t,_)&&!Object(C.r)(t,T))return null;const R={processid:{id:a.a.EMPTY}};if(Object(E.g)(w)||Object(E.f)(t,F.identifier,h))return e(Object(c.b)(t,I,R)),null;a.a.isNullOrEmpty(A)?A=a.a.newGuid():n.EventManager.ReportComponentSuccess("ProcessManagerHelper.AlreadyPopulatePrimaryEntityId"),e(Object(c.b)(t,I,R,A));const x=Object(p.d)(t,k);if(a.a.isNullOrEmpty(x))return n.EventManager.ReportComponentFailure("ProcessManagerHelper.generateBPFInstanceSnapshotId","The first stage id is null."),null;y=function(e,t,n,r,o,i,c,b,p){const m=function(e,t,n,r,a,o){if(!n||!r||!o)throw new Error("Primary entity and Active stage cannot be null or undefined.");const i={activestageid:{reference:new d.a("processstage",o),timestamp:new Date,validationResult:{isValueValid:!0,errorMessage:null,errorId:null,userInput:o.guid}},traversedpath:{value:o.guid.toString(),timestamp:new Date,validationResult:{isValueValid:!0,errorMessage:null,errorId:null,userInput:""}},processid:{reference:new d.a("workflow",r),timestamp:new Date,validationResult:{errorId:null,errorMessage:null,isValueValid:!0,userInput:null,isOfflineSyncError:!1}}};return function(e,t,n,r,a,o){if(!(e&&t&&n&&r&&a))return;const i=M(t,n,o);i&&(e[i.ReferencingAttribute]={reference:new d.a(n,r),timestamp:new Date,validationResult:{errorId:null,errorMessage:null,isValueValid:!0,userInput:null,isOfflineSyncError:!1}})}(i,e,t,n,r,a),i}(t,o,i,c,b,p);if(!function(e,t,n,r){if(!t||!n||!r)return!1;const a=Object(v.g)(e,n,Object.keys(r));if(a&&a.length>0)return t.EventManager.ReportComponentFailure("ProcessManagerHelper._validateBPFEntityAttributes",`BPF(${n}) - These attributes are missing metadata: ${a.join()}`),!1;return!0}(t,n,b,m))return b&&e(Object(S.f)(b,!0,[])).then(()=>{Object(f.h)(t,b)||n.EventManager.ReportComponentFailure("ProcessManagerHelper._createBPFEntitySnapshot",`Retrieve BPF(${b}) failed.`)}),null;const g=Object(s.y)(r),O=Object(u.b)(t,new d.a(b,a.a.EMPTY),m,g,l.a.Create),j=O.payload.snapshotId;return e(O),j}(e,t,n,j,T,A,k,_,x),y?n.EventManager.ReportComponentSuccess("ProcessManagerHelper.generateBPFInstanceSnapshotId"):n.EventManager.ReportComponentFailure("ProcessManagerHelper.generateBPFInstanceSnapshotId","The BPF entity snapshot id is null.")}catch(e){n.EventManager.ReportComponentFailure("ProcessManagerHelper.generateBPFInstanceSnapshotId",e)}return y}function A(e,t,n,r){if(e&&r&&t&&n){const o={processid:{id:a.a.EMPTY}};r(Object(c.b)(e,t,o,n))}}function M(e,t,n){var r,a,o;const i=Object(f.h)(e,n);if(!(null==i?void 0:i.AttributeNames))return null;if(!Object(f.h)(e,t))return null;const c=Object(f.E)(e,t);if(!c)return null;const s=[];for(const a of i.AttributeNames){const o=Object(v.a)(e,n,a);o&&(k(o)||(null===(r=o.Targets)||void 0===r?void 0:r.includes(t))&&s.push(o))}let u=null,l=null;if(0===s.length)return null;for(const e of s){if(!e.IsCustomAttribute){u=e.LogicalName;break}0===(null===(o=null===(a=e.LogicalName)||void 0===a?void 0:a.toLowerCase())||void 0===o?void 0:o.indexOf("bpf_"))&&(null==l||l.ColumnNumber>e.ColumnNumber)&&(l=e)}if(u=u||(null==l?void 0:l.LogicalName),!u)return null;for(const e in c){const r=c[e];if(r&&r.ReferencedEntity===t&&r.ReferencingEntity===n&&r.ReferencingAttribute===u)return r}return null}function k(e){var t;return(null==e?void 0:e.Type)===j.a.Lookup&&["createdby","modifiedby","createdonbehalfby","modifiedonbehalfby"].includes(null===(t=null==e?void 0:e.LogicalName)||void 0===t?void 0:t.toLowerCase())}function _(e,t,n,o,i,c){const s=new d.a(o,a.a.EMPTY),u=Object(b.d)(e,o);return Object(r.f)(e,N.Wg)&&!a.a.equals(u,a.a.EMPTY)?t(Object(h.a)(a.a.EMPTY,s)).then(r=>{let o="";if(r&&r.businessProcessFlows){const i=r.businessProcessFlows[a.a.toString(u)];if(i&&(t(Object(y.b)(i.businessProcessFlowId,s)),t(Object(w.b)(a.a.EMPTY,s)),t(Object(I.b)(!1,s)),o=i.businessProcessFlowUniqueName,o)){const r=Object(v.g)(e,o,["activestageid","traversedpath","processid"]);r&&r.length>0&&t(Object(S.f)(o,!0,[])).then(()=>{Object(f.h)(e,o)||n.EventManager.ReportComponentFailure("ProcessManagerHelper.retrieveBPFEntity",`Retrieve BPF(${o}) failed.`)})}}return i&&i.info("retrieveBusinessProcessFlow completed.",c),n.EventManager.ReportComponentSuccess(`ProcessManagerHelper.retrieveBusinessProcessFlow for ${a.a.toString(u)}(${o})`),r}).catch(e=>(c.push({name:"retrieveDefaultBPFForQuickCreateForm.Reason",value:Object(F.f)(e)}),n.EventManager.ReportComponentFailure("ProcessManagerHelper.retrieveBusinessProcessFlow",e,null,c),null)):Promise.resolve(null)}},gYxr:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="setattributepreviousvalues"},ofgb:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return d}));var r=n("dHD5"),a=n("Zn5P"),o=n("i1f0"),i=n("wL2W"),c=n("/t1C"),s=n("yHAP"),u=n("KXSk");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const l="form.SavingState.set";function d(e,t,n){return{type:"set.formSaving.sync",sync:!0,execute({dispatch:d,getState:f},b){const p=f(),m=Object(i.a)();if(2===n||1===n){const r=Object(o.pb)(p,{id:e},t),i=Object(o.Gb)(p,{id:e},t),c=Object(o.Hb)(p,e);!r||i||c||d(Object(a.c)(2===n?1:0))}if(d(function(e,t,n){const a=Object(r.w)(t);return{type:l,payload:{savingState:n},meta:{pageId:e,contextKey:a}}}(e,t,0===n)),m){const r=f();let a;switch(n){case 0:a="started";break;case 1:a="succeeded";break;case 2:a="failed";break;case 3:a="canceled"}const i=Object(u.c)(r,e);a=`Save operation ${a} ${Object(s.c)(r,e,t)}.`;if(Object(o.mb)(r,i)){Object(s.b)(i,c.b.onSave).push({message:a})}}}}}},tJdb:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e[e.Unknown=-1]="Unknown",e[e.Persistent=0]="Persistent",e[e.Calculated=1]="Calculated",e[e.Rollup=2]="Rollup"}(r||(r={}))},txdA:function(e,t,n){"use strict";n.d(t,"b",(function(){return F})),n.d(t,"d",(function(){return S})),n.d(t,"c",(function(){return E})),n.d(t,"a",(function(){return P})),n.d(t,"f",(function(){return A})),n.d(t,"e",(function(){return M})),n.d(t,"g",(function(){return C})),n.d(t,"i",(function(){return N})),n.d(t,"h",(function(){return k})),n.d(t,"j",(function(){return _}));var r=n("SAYH"),a=n("Yx7Y"),o=n("y60j"),i=n("5R5s"),c=n("9fGf"),s=n("Z/4N"),u=n("BzGi"),l=n("d0w6"),d=n("HfZT"),f=n("P6DH"),b=n("3/02"),p=n("69Qu"),m=n("Lyxw"),g=n("dHD5"),O=n("AF/G"),v=n("M0zh"),j=n("i1f0"),h=n("IqkD"),y=n("85o3"),w=n("zGWw"),I=n("BFlg");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function F(e,t,n,a,i){const c=Object(o.c)(e,n,t);if(!c)return{};const s=":"+r.a.toString(n),u={};for(const e in c){const t=c[e],n=a[t.ClassId.guid.toUpperCase()];if(n&&n(t))if(i){const e=i(t);if(Array.isArray(e))for(const t of e)u[t.name+s]=t.control;else u[t.Name+s]=e}else u[t.Name+s]=t}return u}function S(e,t,n,r,a,c=!1,s=!1,u=!1){const l=Object(o.h)(e,n),f=Object(m.f)(e,b.O)&&Object(p.c)(e),O=Object(m.f)(e,b.P)&&Object(p.c)(e),j=t=>(t=>f&&!c&&C(e,l,t,t.Parameters))(t)||(t=>O&&c&&C(e,l,t,t.Parameters))(t),I=e=>a&&e.ParentTabId===a&&(!c||c&&s),S=e=>!u||!(e.Parameters&&e.Parameters.RelationshipName),E={[w.d]:t=>S(t)&&I(t)&&k(e,l,t),[d.a]:e=>S(e)&&I(e)};return F(e,t,n,E,t=>{const n=t.Parameters,a=j(t),o=N(e,l,t,n)||(t=>!O&&c&&C(e,l,t,t.Parameters))(t),s=Object(h.q)(e),u=Object(m.f)(e,b.ag),d=Object(i.a)(n.TargetEntityType,s,r,u),f=null!==d?d.getFilterAndLinkedEntities(y.a,!0):null,p=o&&(()=>f);return{hasChart:a,chartType:a&&A(n),viewType:a&&M(n),getCustomFilter:o?p:null,hasGrid:o,gridType:0,ribbonContext:o&&v.u,recordsPerPage:o&&n.RecordsPerPage&&+n.RecordsPerPage,cardFormId:o&&P(e,l,t),contextToken:Object(g.q)(r,t.Name),control:t,controlParameters:n,entityLogicalName:n.TargetEntityType,viewId:n.ViewId}})}function E(e,t,n,r){const a=function(e,t,n){const r=Object(o.h)(e,n);return F(e,t,n,{[w.d]:t=>C(e,r,t,t.Parameters),[d.a]:t=>C(e,r,t,t.Parameters)})}(e,n,t),i={};for(const e in a){const t=a[e];i[e]=Object(g.q)(r,t.Name)}return i}function P(e,t,n){if(r.a.equals(n.ClassId,O.mb))return a.a;const o=Object(c.b)(e),i=t&&Object(s.a)(n,t,o);if(!(i&&i.Parameters&&i.Parameters[w.b]&&i.Parameters[w.b].Value))return;const[u]=i.Parameters[w.b].Value.split(":");return r.a.tryParseOrNull(u)}function C(e,t,n,r){if(r){const a=r.ChartGridMode;return r.VisualizationId&&("Chart"===a&&!k(e,t,n)||function(e,t,n){return T(e,t,n,w.c)}(e,t,n))}return!1}function N(e,t,n,r){if(r){return"Chart"!==r.ChartGridMode&&(!k(e,t,n)||function(e,t,n){return T(e,t,n,I.D,I.y,I.C,w.e,w.a)}(e,t,n))}return!1}function T(e,t,n,...r){const a=R(e,t,n);return a&&-1!==r.indexOf(a.Name)}function A(e){return e.IsUserChart&&"true"===e.IsUserChart?u.a.uservisualization:u.a.savedvisualization}function M(e){return e.IsUserView&&"true"===e.IsUserView?l.b.userview:l.b.savedview}function k(e,t,n){const r=R(e,t,n);if(!r)return!1;return!!Object(f.db)(e,r.CustomControlId)}function _(e,t,n,r,a){const o={};return n.forEach(n=>{const i=Object(j.Q)(e,n,t),c=S(e,t,n,r,i,!0,a);Object.assign(o,c)}),o}function R(e,t,n){const r=Object(c.b)(e);return Object(s.a)(n,t,r)}},uNLT:function(e,t,n){"use strict";n.d(t,"e",(function(){return rt})),n.d(t,"f",(function(){return Tt})),n.d(t,"c",(function(){return ft})),n.d(t,"d",(function(){return mt})),n.d(t,"b",(function(){return tt})),n.d(t,"g",(function(){return Pt})),n.d(t,"a",(function(){return et}));var r=n("arV0"),a=n("i1f0"),o=n("nC8a"),i=n("SAYH"),c=n("odYE"),s=n("ruPX"),u=n("y60j"),l=n("/qEh"),d=n("Uv1Y"),f=n("ofgb"),b=n("+hq9"),p=n("1uZV"),m=n("Tz6o"),g=n("bT7G"),O=n("Bj/n"),v=n("jTSi"),j=n("3tOH"),h=n("dHD5"),y=n("Dea/"),w=n("tICD"),I=n("EY5k"),F=n("YxC/"),S=n("LAcd"),E=n("xy1J"),P=n("iZ7K"),C=n("LbMF"),N=n("5Oca"),T=n("iF9X"),A=n("69Qu"),M=n("1HWW"),k=n("EBJu"),_=n("4UCL"),R=n("NDmk"),x=n("LJro"),D=n("84PK"),L=n("WRF3"),B=n("HYaY"),H=n("sdkC"),U=n("PF3G"),Y=n("IvgJ"),q=n("/A0C"),V=n("ybGo");function G(e){return{type:"offline.resolve.syncerror.record",execute({dispatch:t,getState:n},a){const o=1,i=Object(r.j)(n(),e);if(!i.data||!i.data._isSyncErrorRetryRequest)return Promise.resolve();const c=i.data._isSyncErrorRetryRequest;if(!Object(V.a)(n(),e)){const n="statecode",r=new Array(1),i={},s={};r[0]=n,i[n]=q.a.State,s[n]=new Y.a(null,o,0,-1,null,null,null);const u="syncerror",l=new L.a(u,D.a.tryCreate(c)),d=new B.a(l,s,i,{},{},new H.a(new Array(0)));d.get_changedFieldNames().push(...r);const f=new U.a(d,!1);a.DataSource.execute(f,null,void 0,void 0,void 0,void 0,e).then(()=>{t(Object(x.b)(e,!0))},n=>{t(Object(x.b)(e,!1))})}return Promise.resolve()}}}var Z=n("NPZ3"),J=n("uCpV"),Q=n("X37l"),z=n("Zzxs"),K=n("ZFRl"),X=n("O7zD"),W=n("D+Bz"),$=n("pEXn"),ee=n("zI6t"),te=n.n(ee),ne=n("NjDY"),re=n("E8F2"),ae=n("LAGg"),oe=n("BFlg"),ie=n("txdA"),ce=n("jRy5"),se=n("jq7Z");var ue=n("3mEc"),le=n("zmL5");var de=n("lY/Z");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var fe=n("UqQu"),be=n("Fij2"),pe=n("7yvg"),me=n("QHx/"),ge=n("rQHy"),Oe=n("+nNZ"),ve=n("Exmh"),je=n("pF61"),he=n("g6bs"),ye=n("9wSR"),we=n("SFvV"),Ie=n("504W"),Fe=n("7Sr4"),Se=n("Zpd/"),Ee=n("wL2W"),Pe=n("/t1C"),Ce=n("yHAP"),Ne=n("4aOd"),Te=n("RrRQ"),Ae=n("gQ5I"),Me=n("uWQm"),ke=n("TBkx"),_e=n("d4Lp"),Re=n("5sJC"),xe=n("AULO"),De=n("BvQu"),Le=n("PUjk"),Be=n("DBoP"),He=n("tT9w"),Ue=n("nzu+");let Ye,qe;function Ve(e,t){return Ge(e),Object(F.c)(qe,t)}function Ge(e){Ye||(Ye=Object(F.h)()),qe||(qe=Ye(e,E.p))}function Ze(e,t,n,r,a){if(r)return;if(n&&n.errorCode)return e(Object(He.b)(n,!1,a));if(n&&n.reason&&n.reason.errorCode)return e(Object(He.b)(n.reason,!1,a));const o=n.message,i=Ve(t,E.m);return e(Object(Ue.a)({title:i,text:o},{type:"error"},a))}var Je=n("5iTp"),Qe=n("SZCI"),ze=n("Izjb"),Ke=n("64CY"),Xe=n("Lyxw"),We=n("dpM5"),$e=n("v+zG");const et="ignore_save",tt="Forms.SaveForm",nt=new c.a("NO_ROOT_COMPONENT");function rt(e,t,n,i,c){const s=[{name:"saveMode",value:t},{name:"PageId",value:e}];return{type:"form.save.async",execute({dispatch:u,getState:l},d,f){if(!Object(o.a)(l(),e)&&Object(je.m)(l(),e))return;const b=Object(r.p)(l(),e);s.push({name:"CorrelationId",value:f.correlationId},{name:"pageType",value:b});const m=Object(a.Hb)(l(),e),g=Object(r.j)(l(),e),O=!m&&Object(a.Rb)(l(),null==g?void 0:g.entityTypeName,null==g?void 0:g.id),j=d.TraceManager.getTracer(tt);return Ot(d,f,u,l,e,t,m,s,O,i,c).then(n=>{let r=n;r===nt&&(r=kt(l(),e));const a=Et(r,s,j,"Null identifier after _saveForm within saveForm");return ut(u,l(),d,t,!m,e,a,s,O),a&&Object(be.c)(Object(P.p)(l(),r.etn)),r},r=>{r=at(r,e);const a=Object.keys(r),o=it(r);s.push({name:"originalError",value:o});const c=st(a,l,r,u,j,s,null==i?void 0:i.map(e=>null==e?void 0:e.ignorableResultCreator)),b=a[0],g=r[b],y=Object(h.j)(l(),b),I=c[0];if(I&&I.getIsIgnorable()){if(ut(u,l(),d,t,!m&&I.getContinueExecution(),b,!1,s,O),ct(l(),u,d,e,r),2200000006===g.errorCode){const t=kt(l(),e);if(t)return t}throw g}if(ct(l(),u,d,e,r,"Forms.SaveForm.SaveForm",s),!Object(re.e)(g))throw u(Object(v.b)(y,b,z.b)),Ze(u,l(),g,n,b),g;return j.info("Failed to save the form due to duplicate",s),u(Object(p.a)(b,g)).then(r=>{if(0===r.status)return u(Object(w.a)(r.pageId)).then(r=>{if("merge_done"!==r.value.param_lastButtonClicked){if(r.value.param_lastButtonClicked===et)return u(Object(v.b)(y,b,z.b)),u(Object(S.b)(b,!0)),Ot(d,f,u,l,b,t,!1,s).then(t=>{let n=t;return n===nt&&(n=kt(l(),e)),Et(t,s,j,"Null identifier after internal _saveForm within saveForm"),lt(u,l(),d,b,s),n},t=>{const r=t[b],a=dt(r,u,l(),y,b,j,s);if(a&&a.getIsIgnorable())return lt(u,l(),d,b,s),ct(l(),u,d,e,t),null;throw ct(l(),u,d,e,t),Ze(u,l(),r,n,b),Object(re.h)(l(),b,r,s,d,"Forms.SaveForm.SaveForm.Duplicate"),r})}else ot(l(),u,b,y,e)});throw r.error})})},getFailureParameters:(e,t)=>(Object(re.a)(e,s),s)}}function at(e,t){return e.message&&(e={[t]:e}),e}function ot(e,t,n,r,o){const i=Object(a.hc)(e,n,r);t(Object(Te.b)(i)),t(Object(Ae.e)(o))}function it(e){const t={};for(const n in e)Object(re.e)(e[n])||(t[n]=e[n]);return JSON.stringify(t)}function ct(e,t,n,r,o,i,c){const s=Object(le.a)(e,r);for(let r=0;r<s.length;r++){const u=s[r],l=Object(h.j)(e,u);t(Object(b.b)(u,l,!1)),o[u]&&i?(t(Object(f.b)(u,l,2)),Object(re.h)(e,u,o[u],c,n,i)):Object(a.pb)(e,{id:u},l)&&t(Object(f.b)(u,l,3))}}function st(e,t,n,r,a,o,i){const c=[];if(e)for(let s=0;s<e.length;s++){const u=e[s],l=Object(h.j)(t(),u),d=n[u];c.push(dt(d,r,t(),l,u,a,o,i))}return c}function ut(e,t,n,o,i,c,s,u,l){if(i){const n=Object(h.j)(t,c),i=!Object(A.c)(t),d=Object(T.a)(t);u.push({name:"isServerUnavailable",value:i},{name:"isMocaOfflineFeatureEnabled",value:d}),i&&d&&e(Object(M.c)(c,n,!0)),e(Object(v.b)(n,c,z.b)),e(G(c));const f=Object(a.hb)(t,c,n),b=Object(r.j)(t,c),p=Object(a.Rb)(t,null==b?void 0:b.entityTypeName,null==b?void 0:b.id);if((15===o||5===o||!Object(Ie.a)(l)&&p&&!l)&&f)for(const t in f)f[t]&&void 0!==f[t].disabledByClientApi&&null!==f[t].disabledByClientApi&&f[t].dataFieldName&&e(Object(Se.b)(c,f[t].dataFieldName,n,void 0));s&&mt(e,n,c),e(Object(ge.a)(c,null,!1))}n.EventManager.ReportComponentSuccess("Forms.SaveForm.SaveForm",u)}function lt(e,t,n,r,a){n.EventManager.ReportComponentSuccess("Forms.SaveForm.SaveForm.Duplicate",a)}function dt(e,t,n,r,o,i,c,s){if(null==s?void 0:s.length)for(let t=0;t<s.length;t++){const n=s[t];if(!n)continue;const r=n(e);if(r.handled)return r.result}const u=Object(re.g)(e);let l=!1,d=!0,f=!1;if(u)switch(e.errorCode){case 2200000004:f=!0;break;case 2200000005:d=!1;break;case 2200000006:l=!0,f=!0;break;case 2200000007:d=!1,function(e,t,n,r,o){if(o)n(Object(O.c)(t,r,o,j.a.error,z.c));else{const o=Object(a.Fb)(e,r,t);if(o)for(const i in o){const c=n(Object(O.b)(o[i].label,o[i].errorMessage)),s=Object(se.a)(e,r),u=Object(a.Eb)(s,t),l=Object(a.A)(e,r,t),d=u.concat(l),f=Object(a.Z)(e,t,r,i,d),b=Object(X.d)(r,i);n(Object(O.c)(t,r,c,j.a.error,b,null,null,f))}}}(n,r,t,o),i.info(Object(re.c)(2200000007),c);break;default:i.error("Unknown error code to ignore",c)}return c.push({name:"isIgnorable",value:u},{name:"continueExecution",value:l},{name:"canNavigate",value:d},{name:"canForceNavigate",value:f}),new Be.a(u,l,d,f)}function ft(e){const t=[{name:"PageId",value:e}];return{type:"form.autosave.async",execute({dispatch:n,getState:c},s,u){const l=c(),d=Object(r.j)(l,e),m=function(e,t){const n=Object(r.j)(e,t),a="_isSyncErrorRetryRequest";let o=!1;n.data&&(o=!!n.data[a]);return o!==Object(V.a)(e,t)}(l,e),y=!d,P=!d.id,C=i.a.isNullOrEmpty(d.id);if(!Object(A.c)(l)&&!Object(T.a)(l))return Promise.resolve(void 0);if(Object(o.a)(l,e))return Promise.resolve(void 0);const N=s.TraceManager.getTracer(tt);if(m||y||P||C)return t.push({name:"blockAutoSave",value:m},{name:"isPageInputNull",value:y},{name:"isPageInputIdNull",value:P},{name:"isPageInputIdBadGuid",value:C}),N.info("Not Autosaving due to bad inputs.",t),Promise.resolve(void 0);const M=Object(le.a)(c(),e);return M.some(e=>{const t=Object(h.j)(l,e),n=Object(a.hc)(l,e,t);return Object(g.h)(l,n)})?Ot(s,u,n,c,e,70,!0,t,null,null,"This save event is invoked by auto save.").then(r=>{let a=r;a===nt&&(a=kt(c(),e));const o=Et(a,t,N,"Null identifier after _saveForm within autoSaveForm"),i=Object(h.j)(l,e);return bt(n,c(),i,e,o),a},r=>{r=at(r,e);const a=Object.keys(r),o=it(r);t.push({name:"originalError",value:o});const i=st(a,c,r,n,N,t),d=a[0],m=r[d],g=Object(h.j)(c(),d),y=i[0];if(y&&y.getIsIgnorable()){const t=Object(h.j)(c(),e);return bt(n,c(),t,e,!1),ct(c(),n,s,e,r),null}return n(Object(I.e)(E.p)).then(()=>{if(ct(c(),n,s,e,r,"Forms.SaveForm.AutoSaveForm",t),!Object(re.e)(m))throw n(Object(v.b)(g,d,z.b)),m;N.info("Failed to autosave the form due to duplicate",t);const a=()=>{n(Object(v.b)(g,d,z.b)),n(Object(S.b)(d,!0));for(let e=0;e<M.length;e++){const t=M[e],r=Object(h.j)(c(),t);n(Object(f.b)(t,r,1)),n(Object(b.b)(t,r,!1))}return Ot(s,u,n,c,e,70,!0,t,!0).then(r=>{let a=r;return a===nt&&(a=kt(c(),e)),Et(a,t,N,"Null identifier after internal _saveForm within autoSaveForm"),pt(n,c(),s,e,t),a},r=>{r=at(r,e);const a=Object.keys(r)[0],o=r[a],i=Object(h.j)(c(),a),u=dt(o,n,c(),i,a,N,t);if(u&&u.getIsIgnorable())return pt(n,c(),s,e,t),null;Object(re.h)(c(),d,o,t,s,"Forms.SaveForm.AutoSaveForm.SaveAnyway"),Ze(n,l,o,null,d)})};Ge(c());const o={Label:Object(F.c)(qe,E.c),Handler:()=>{a()}},i={Label:Object(F.c)(qe,E.d),Handler:()=>{n(Object(p.a)(e,m)).then(t=>{if(0===t.status)return n(Object(w.a)(t.pageId)).then(t=>{"merge_done"!==t.value.param_lastButtonClicked?t.value.param_lastButtonClicked===et&&a():ot(c(),n,d,g,e)});throw t.error})}};for(let e=0;e<M.length;e++){const t=M[e],a=Object(h.j)(c(),t);n(Object(b.b)(t,a,!1)),r[t]?n(Object(f.b)(t,a,2)):n(Object(f.b)(t,a,3)),n(Object(v.b)(a,t,z.b))}return n(Object(O.c)(g,d,Object(F.c)(qe,E.b),j.a.warning,z.b,[o,i]))})}):Promise.resolve(void 0)},getFailureParameters:(e,n)=>(Object(re.a)(e,t),t)}}function bt(e,t,n,r,a){!Object(A.c)(t)&&Object(T.a)(t)&&e(Object(M.c)(r,n,!0)),e(Object(v.b)(n,r,z.b)),a&&mt(e,n,r),e(Object(ge.a)(r,null,!1))}function pt(e,t,n,r,a){n.EventManager.ReportComponentSuccess("Forms.SaveForm.AutoSaveForm.SaveAnyway",a)}function mt(e,t,n){e(function(e,t){return{type:"grids.page.refresh.dataset.asyn",execute({dispatch:n,getState:r},a){var o,i;const c=a.TraceManager.getTracer(oe.P),s=oe.N+".refreshPageDataSetsAction";try{const u=r(),l=Object(se.a)(u,e);if(t.contextTokenType===ce.a.QuickViewForm){c.info("Refreshing all of the quick view's grids for the quick view on page with ID "+e);const r=Object(h.w)(t),a=null===(i=null===(o=null==l?void 0:l.forms)||void 0===o?void 0:o[r])||void 0===i?void 0:i.formId;if(a){const r=Object(ie.j)(u,e,[a],t,!0);for(const t in r){const a=r[t].contextToken;n(Object(ae.b)(e,a))}}}else if(c.info("Refreshing all the grids for the page with ID "+e),null==l?void 0:l.datasets)for(const t in l.datasets)n(Object(ae.c)(e,t));return a.EventManager.ReportComponentSuccess(s),Promise.resolve()}catch(t){let n="Refreshing datasets for pageid "+e+"failed ";t&&t.message&&(n+="with the error message as : "+t.message),a.EventManager.ReportComponentFailure(s,Error(n));const r=new d.a(n);return Promise.reject(r)}}}}(n,t)),e(function(e,t){return{type:"form.page.chartdata.refresh.async",execute({dispatch:n,getState:r}){const a=r(),o=Object(le.b)(a,e),i=Object(ie.c)(a,o,e,t);for(const t in i){const r=i[t];n(Object(ae.b)(e,r))}return Promise.resolve()}}}(n,t)),e(function(e,t){return{type:"form.quickform.data.resfresh.async",execute({dispatch:n,getState:o}){const i=o(),s=Object(a.hc)(i,t,e),l=Object(r.j)(i,t),d=new c.a(l.entityTypeName,l.id),f=Object(a.mc)(i,t,e);for(const r in f){const o=Object(a.u)(i,{id:t,controlName:r},e),c=Object(g.e)(i,s,d,o.DataFieldName);if(!c||!c.reference)continue;const l=f[r][c.reference.etn],b=Object(u.w)(i,l);n(Object(de.d)(c.reference,b))}return Promise.resolve()}}}(t,n))}function gt(e,t,n,r){const o=[],i=[];for(let e=0;e<t.length;e++){const c=t[e];Object(a.jd)(r,c,n[e])?i.push(c):o.push(c)}return[o,i]}function Ot(e,t,n,o,s,u,p,m,O,v,j){const y=o();!function(e,t,n,o){const c=Object(le.b)(e,o),s=Object(a.Ob)(e,o),u=Object(r.p)(e,o),l={[$.a.CorrelationId]:t.correlationId,[$.b.SaveFormParameters.SaveMode]:n.toString(),[$.b.FormParameters.PageId]:o,[$.n.PageName]:u,[$.b.FormParameters.IsMainFormDialog]:s.toString(),[$.b.FormId]:i.a.toString(c)};te.a.tagWorkBlock(Qe.x),te.a.addKeyPerformanceIndicatorOnIdle(Qe.x,l)}(y,t,u,s);const w=Object(le.a)(y,s),I=w.map(e=>Object(h.j)(y,e));null==m&&(m=[{name:"nullTelemetryParameters",value:!0}]),m.push({name:"_saveMode",value:u}),m.push({name:"_isCreate",value:Object(a.kd)(y,s)});const[F,C]=gt(0,w,I,y),N=F.length>0;if(m.push({name:"readOnlyFormComponents",value:JSON.stringify(C)}),N){const t=function(e,t,n,o,s,u,p,m,O,v,j,y){const w=t(),I=Object(Ee.a)(),F=u.filter((e,t)=>{const n=s[t];return Object(a.pb)(w,{id:e},n)});if(F.length>0){if(I){const e=Object(Ce.b)(o,Pe.b.onSave);F.forEach((t,n)=>{const r=s[n],a=Object(Ce.c)(w,t,r),o=new Ne.a(new Error);e.push({message:`Save is called again while previous save operation is in progress ${a}. Make sure the previous save event handler code does not call client API to save the form.`,callstack:o.getStackTrace()})})}const e=Ve(w,E.a),t={[o]:Object(re.b)(w,o,2200000003,e)};return Promise.reject(t)}const C=Object(ne.D)(t());u.forEach((n,o)=>{("TaskBasedFlow"===Object(r.p)(t(),n)||C&&!1===C.isDuplicateDetectionEnabled||C&&!1===C.isDuplicateDetectionEnabledForOnlineCreateUpdate)&&e(Object(S.b)(n,!0));const i=s[o];!function(e,t,n){const o=Object(le.b)(e,t),i=Object(r.j)(e,t),s=new c.a(null==i?void 0:i.entityTypeName,null==i?void 0:i.id),u=Object(a.Cc)(e,t,n);Object(ze.b)(e,t,o,s,s.etn,u,n,!0)}(w,n,i),e(Object(f.b)(n,i,0)),e(Object(b.b)(n,i,70===p))});const N=70===p?Fe.a.getInstance().getAttributesPendingUpdate():new Set;return(70===p?Promise.resolve():Fe.a.getInstance().checkForOutstandingWork(t(),o)).then(()=>async function(e,t,n,o,s,u,p,m,O,v,j,y,w){let I=n();m||u.forEach((t,n)=>e(Object(_e.b)(t,s[n])));const F={};for(let t=0;t<u.length;t++){const n=u[t],r=s[t],o=Object(a.wc)(I,{id:n},r);if(o){const t=Ft(e,I,n,r,o,F);if(!Object(Ie.b)(t)){throw{[n]:new d.a(t)}}}}const S=t.TraceManager.getTracer(tt);let E=yt(I,u,s),C=E.map(e=>Object(h.j)(I,e));if(E.length>0)return _t(I,o,e,S,E,C,O);const N=Object(a.Hb)(I,o);if(!N)for(let n=0;n<u.length;n++){const r=u[n],a=s[n],i=t.ScriptManager.getContainer(r).getEventManager(),c=e(i.runOnSave(a,p,null,null,w));let l=!1;if(l="boolean"==typeof c?c:await c,l){let e;if(y)for(const t of y)if((null==t?void 0:t.preventDefaultErrorCreator)&&(e=t.preventDefaultErrorCreator(I),e)){S.info("Mixin preventDefault error used",O);break}S.info(Object(re.c)(2200000005),O);throw{[r]:null!=e?e:Object(re.b)(I,o,2200000005)}}}if(I=n(),E=yt(I,u,s),C=E.map(e=>Object(h.j)(I,e)),E.length>0)return _t(I,o,e,S,E,C,O);if(y)for(const e of y){if(!(null==e?void 0:e.preSaveValidator))continue;const t=e.preSaveValidator();if(!t.isValid){let e,n;t.value?(n=t.value.message,e=Object(d.c)(t.value)):(n=Object(re.c)(2200000007),e=Object(re.b)(I,o,2200000007)),S.info(n,O);throw{[o]:e}}}const T=u.map((e,t)=>Object(a.hc)(I,e,s[t])),M=T.map(e=>Object(g.b)(I,e));let k;if(!N)for(let r=0;r<u.length;r++){const a=u[r],i=s[r],c=St(e,n,t,a,i,T,F);a===o&&(k=c)}let _=!1,R=!1;const x=new Set,D=new Set;for(let t=0;t<M.length;t++){const n=M[t],r=u[t],a=s[t];(null==n?void 0:n.activeChanges)&&Object.keys(n.activeChanges).length?(R=!0,ht(n,I,r,a)?_=!0:x.add(r),Object(Xe.f)(I,We.w)&&jt(r,a,F,I,D)):(x.add(r),jt(r,a,F,I,D)),x.has(r)&&D.has(r)&&(e(Object(f.b)(r,a,3)),e(Object(b.b)(r,a,!1)))}const L=[];Object.keys(F).forEach(e=>{vt(F[e],L)});const B=0!==L.length,H=D.size===u.length;let U=!1;U=Object(Xe.f)(I,We.w)?!_&&H:R&&!_||H&&!B;if(U){S.info(Object(re.c)(2200000006),O);const e={};for(const t of u)e[t]=Object(re.b)(I,o,2200000006);throw e}return async function(e,t,n,o,s,u,d,f,b,p,m,g,O,v,j,h,y){var w;const I=[],F=[];for(let r=0;r<u.length;r++){const a=u[r];if(Object(Xe.f)(n(),We.w)){if(b.has(a)&&p.has(a))continue}else if(p.has(a))continue;const i=Object(le.b)(n(),a);F.push(a);const c=e(Object(l.b)(a,i)).then(({unboundAttributes:i,attributesPendingUpdate:c})=>wt(e,n,t,s[r],a,o,d[r],f,m,i,c,g,O,v,j,h,y));a===o?I.unshift(c):I.push(c)}try{const t=await Promise.allSettled(I);await async function(e,t,n,o,s){var u,l;if(Object(a.Hb)(t(),n)||o.length<2)return;const d=t(),f=new Map;for(const e of o){const t=Object(r.j)(d,e),n=null!==(u=Object(P.H)(d,null==t?void 0:t.entityTypeName))&&void 0!==u?u:"",a=Object(le.b)(d,e),o=null==t?void 0:t.entityTypeName,b=i.a.toString(null==t?void 0:t.id),p=null===(l=Pt(d,a,new c.a(o,null==t?void 0:t.id),n,s))||void 0===l?void 0:l[o],m=f.get(o);if(null==m?void 0:m.size){const e=m.get(b);(null==e?void 0:e.size)?p.forEach(e.add,e):m.set(b,new Set(p))}else{const e=new Map;e.set(b,new Set(p)),f.set(o,e)}}const b=[];f.forEach((t,n)=>{t.forEach((t,r)=>{const a=new c.a(n,new i.a(r));b.push(e(Object(de.d)(a,Array.from(t))))})}),await Promise.all(b)}(e,n,o,F,m);const s=t.find(e=>"rejected"===e.status);if(s)throw s.reason;if(t.length>0){const e=t[0];if(e.value.formComponentId===o)return e.value.entityReference}return nt}catch(t){const r={[t.saveFormPromiseComponentId]:t};if(t.saveFormPromiseComponentId=void 0,-2147220969===(null===(w=t.getNegativeErrorCode)||void 0===w?void 0:w.call(t))){const r=Object(ke.g)(t.message);r&&e(Object(Me.c)(r,Object(A.c)(n())))}throw r}}(e,t,n,o,s,u,T,B?F:null,x,D,p,O,v,j,y,k,w)}(e,n,t,o,s,u,p,m,O,v,N,j,y))}(n,o,e,s,F.map(e=>Object(h.j)(y,e)),F,u,p,m,!!O,v,j);return t.then(e=>{te.a.addCommonKpiParameters({[$.b.FormParameters.EntityId]:i.a.toString(null==e?void 0:e.id),[$.b.EntityName]:null==e?void 0:e.etn})}),t}e.TraceManager.getTracer(tt).info(Object(re.c)(2200000004),m);const T={};for(const e of C)T[e]=Object(re.b)(y,s,2200000004);return Promise.reject(T)}function vt(e,t){var n,r;t&&((null===(n=null==e?void 0:e.snapshotsToSaveBeforePrimaryEntity)||void 0===n?void 0:n.length)&&t.push(...e.snapshotsToSaveBeforePrimaryEntity),(null===(r=null==e?void 0:e.snapshotsToSaveAfterPrimaryEntity)||void 0===r?void 0:r.length)&&t.push(...e.snapshotsToSaveAfterPrimaryEntity))}function jt(e,t,n,r,a){let o=!1;const i=[];vt(null==n?void 0:n[e],i),(null==i?void 0:i.length)&&(o=i.some(n=>{const a=Object(g.b)(r,n);if((null==a?void 0:a.activeChanges)&&Object.keys(null==a?void 0:a.activeChanges).length>0)return ht(a,r,e,t)})),o||a.add(e)}function ht(e,t,n,r){const o=Object(a.Jc)(t,n,r)||{};return Object.keys(e.activeChanges).some(e=>!Object(a.Zc)(t,n,e)&&o[e]!==De.a.Never)}function yt(e,t,n){const r=[];for(let o=0;o<t.length;o++){const i=t[o],c=Object(se.a)(e,i);Object(a.Mb)(c,e,i,n[o])||r.push(i)}return r}async function wt(e,t,n,s,u,d,p,m,O,v,j,h,y,w,I,F,S){try{const E=t(),C=Object(r.j)(E,u);let N="";null!=C&&(h.push({name:"_entityTypeName",value:C.entityTypeName},{name:"_formId",value:i.a.toString(C.formId)}),N=Object(P.H)(E,C.entityTypeName));const T=function(e,t,n,r){if(!Object(Oe.f)(e,n.entityTypeName)||!Object(a.Jb)(e,t))return null;const o=Object(g.b)(e,r);let s=new c.a(n.entityTypeName,n.id);i.a.isNullOrEmpty(n.id)&&!o.identifier&&(s=new c.a(n.entityTypeName,o.identifier.id));const u=n.processId&&!i.a.equals(i.a.fromExternalGuid(n.processId),i.a.EMPTY)?c.a.toLegacyEntityReference(new c.a("businessprocessflowinstance",i.a.fromExternalGuid(n.processId))):null,l=n.processInstanceId&&!i.a.equals(i.a.fromExternalGuid(n.processInstanceId),i.a.EMPTY)?c.a.toLegacyEntityReference(new c.a("businessprocessflowinstance",i.a.fromExternalGuid(n.processInstanceId))):null;if(s&&u&&l)return new ve.a(c.a.toLegacyEntityReference(s),u,l);if(s&&u&&!l)return new ve.a(c.a.toLegacyEntityReference(s),u,null);if(s)return new ve.a(c.a.toLegacyEntityReference(s),null,null);return null}(E,u,C,p),A=Object(le.b)(E,u),M=Object(a.Hb)(E,d)?null:function(e,t){let n=Object.assign({},e);return null==t||t.forEach(e=>{n=Object.assign(Object.assign({},n),e.refreshColumnsByEntity)}),n}(Pt(E,A,new c.a(null==C?void 0:C.entityTypeName,C.id),N,O),I),k=Object(a.Kc)(E,u),_=n.ScriptManager.getContainer(u).getEventManager(),R=function(){return m?function(e,t,n,a,i,s,u,d,p,m,O,v,j,h,y,w,I,F,S,E,P,C){var N,T,A,M,k,_,R;const x=[],D=[];if(v){const e=Object(o.a)(t,a),n=Object.keys(v);for(const t of n)(null===(T=null===(N=v[t])||void 0===N?void 0:N.snapshotsToSaveBeforePrimaryEntity)||void 0===T?void 0:T.length)&&x.push(...v[t].snapshotsToSaveBeforePrimaryEntity),(null===(M=null===(A=v[t])||void 0===A?void 0:A.snapshotsToSaveAfterPrimaryEntity)||void 0===M?void 0:M.length)&&D.push(...v[t].snapshotsToSaveAfterPrimaryEntity.filter(t=>!(e&&t===E)))}const L=Object(g.b)(t,O);let B=(null==L?void 0:L.activeChanges)?x.concat(O):x;D&&(B=B.concat(...D));return w.push({name:"snapshotsToSaveBeforePrimaryEntity.length",value:x.length},{name:"snapshotsToSaveAfterPrimaryEntity.length",value:D.length},{name:"primaryEntitySnapshotId",value:O},{name:"allSnapshotIds",value:null==B?void 0:B.join(",")},{name:"Primary Entity Record Id",value:null===(R=null===(_=null===(k=Object(g.b)(t,O))||void 0===k?void 0:k.identifier)||void 0===_?void 0:_.id)||void 0===R?void 0:R.guid},{name:"Process Id",value:It(E,t)}),e(Object(we.b)(B,y,F,P,null,null!=C?C:"This save event is invoked by a manual or programatic save operation.")).then(o=>e(Object(l.a)(a,j,h)).then(()=>{var u,l;if(o&&o.length>0){let f=Promise.resolve(),b=null;if(O)b=o[B.indexOf(O)];else{const n=Object(r.j)(t,i);n&&(b=new c.a(n.entityTypeName,n.id),f=e(Object(de.d)(b,null==F?void 0:F[b.etn],P)))}const v=Object(g.b)(t,E),j=null===(u=null==v?void 0:v.identifier)||void 0===u?void 0:u.etn,h=null===(l=o.find(e=>e.etn===j))||void 0===l?void 0:l.id,y=Object(Ee.a)()?Object(Le.b)(i,d):null,w=null==y?void 0:y.getProcess();if(b)return f.then(()=>e(Ct(n,i,a,s,d,O,m,p,b,I,t,S,h,w,C)))}return e(Object(f.b)(a,m,1)),e(Object(b.b)(a,m,!1)),o&&o.length>0?o[0]:null}))}(e,E,_,u,d,O,0,C,N,s,p,m,v,j,k,h,y,M,w,F,T,S):function(e,t,n,a,o,i,c,s,u,d,f,b,p,m,g,O,v,j,h,y){const w=Object(r.j)(t,a),I=w&&b&&b[w.entityTypeName]?b[w.entityTypeName]:[];return e(Object(we.a)(f,g,I,h,null,null!=y?y:"This save event is invoked by a manual or programatic save operation.")).then(r=>e(Object(l.a)(a,p,m)).then(()=>e(Ct(n,o,a,i,s,f,d,u,r,v,t,j,null,null,y))))}(e,E,_,u,d,O,0,C,N,s,p,M,v,j,k,0,y,w,T,S)},x=await R();return{formComponentId:u,entityReference:x}}catch(e){throw e.saveFormPromiseComponentId=u,e}}function It(e,t){var n,r,a,o;let i=null;if(e){const c=Object(g.b)(t,e),s="processid";i=null===(o=null===(a=null===(r=null===(n=null==c?void 0:c.activeChanges)||void 0===n?void 0:n[s])||void 0===r?void 0:r.reference)||void 0===a?void 0:a.id)||void 0===o?void 0:o.guid}return i}function Ft(e,t,n,r,o,i){const c=Object(se.a)(t,n),s=[];for(const i in o){const o=Object(h.n)(r,i),u=Object(a.hc)(t,n,o);if(u&&(s.push(u),!Object(a.Mb)(c,t,n,o))){e(Object(f.b)(n,r,2)),e(Object(b.b)(n,r,!1));return Ve(t,E.e)}}s.length>0&&(i[n]||(i[n]={}),i[n].snapshotsToSaveBeforePrimaryEntity=s)}function St(e,t,n,r,a,o,i){const{otherSnapshotsToSave:c,bpfSnapshotId:s}=function(e,t,n,r,a,o){const i=new Array;let c=Object(he.a)(e,t(),n,r,a);if((null==o?void 0:o.includes(c))&&(c=null),c){const e=Object(g.b)(t(),c);(null==e?void 0:e.activeChanges)&&Object.keys(e.activeChanges).length>0&&i.push(c)}return{otherSnapshotsToSave:i,bpfSnapshotId:c}}(e,t,n,a,r,o);return c&&c.length>0&&(i[r]||(i[r]={}),i[r].snapshotsToSaveAfterPrimaryEntity=c),s}function Et(e,t,n,r){const a=!!e;return t.push({name:"isIdentifierValid",value:a},{name:"entityTypeName",value:a?e.etn:null}),a||n.error(r,t),a}function Pt(e,t,n,r,a){const o=Object(u.h)(e,t),c=n?Object(N.e)(e,n):null,s=Object(u.w)(e,t),l=[];l.push(...s);const d=Object(Z.a)(e,n.etn);if(d&&l.push(...d),o&&n.etn){const t=Object(ue.d)(e,o.FormLibraries,[n.etn]);t&&l.push(...t)}if(r&&-1===l.indexOf(r)){const t=Object(C.a)(e,n.etn,r);t&&t.IsRetrievable&&l.push(r)}if(c&&c!==i.a.EMPTY){const t=Object(pe.a)(e,c,n.etn);if(t){const e=t.filter(e=>-1===l.indexOf(e));l.push(...e)}}let f=l;if(70===a){const e=Fe.a.getInstance().getAttributesPendingUpdate();f=null==f?void 0:f.filter(t=>!e.has(t))}return{[n.etn]:f}}function Ct(e,t,r,i,s,u,l,d,p,O,j,h,w,I,F){return{type:"form.updateOnSaveSuccess",sync:!0,execute({dispatch:S,getState:E},C){var T;const A=E(),M=Object(a.Hb)(A,t),x=M?s:Object.assign(Object.assign({},s),{id:p.id,data:Nt(s)}),D=Object(g.b)(A,u),L=Object(N.j)(A,p,d),B=L?L.value:null,H=(null===(T=null==D?void 0:D.identifier)||void 0===T?void 0:T.name)?D.identifier.name:B||null,U=Object.assign(Object.assign({},p),{name:H});let Y;if(Object(a.ld)(j,t)){const t=c.a.toExternalEntityReference(p);S(e.runOnPostSave(l,!0,t,null,null,F))&&(Y=!0,S(Object(f.b)(r,l,1)))}M||S(Object(m.d)(x,r)),Object(se.a)(A,r).__pageName!==k.a&&S(Object(R.b)(r,U)),M||s.id||S(e.runOnProcessChange(l,2));const q=70===i?Array.from(Fe.a.getInstance().getAttributesPendingUpdate()).concat(Array.from(h)):void 0;if(M||S(Object(_.d)(r,l,q)),Y||S(Object(f.b)(r,l,1)),S(Object(b.b)(r,l,!1)),S(Object(ye.g)(r)),!M){S(Object(fe.a)(r,j,l,p.etn,p.id)),S(e.runOnDataLoad(l,2)),!O&&(s.id||Object(a.Qb)(A,r)||Object(a.Ob)(A,r))||S(e.runOnLoad(l,2,null,"This onload event is triggered again after saving a new record because the form is transitioned from create mode to edit mode. This behavior is by design.")),S(e.runBusinessRulesAfterSaveSuccess(l));const{entityTypeName:t}=x,n=Object(X.c)(r,t,E(),l);n&&S(Object(K.c)(r,n));const o=Object(g.b)(j,u);S(function(e,t){return{type:"recentitems.formsave.addrecentitem",sync:!0,execute({dispatch:n,getState:r}){var o;const i=r();if(!t||!e||void 0===t.mode)return;const c=Object(P.H)(i,e.etn);let s=c&&t.activeChanges&&t.activeChanges[c];if(!s&&Object(Ke.e)(e.etn)){const e=Object(Ke.d)(c);if(e)for(const n in e){const r=e[n];if(r&&(null===(o=null==t?void 0:t.activeChanges)||void 0===o?void 0:o[r])){s=t.activeChanges[r];break}}}if(t.mode===y.a.Update&&!s)return;const u={RecordType:Q.a.Entity,EntityTypeName:e.etn,LastAccessed:new Date,ObjectId:e.id,Title:Object(a.lc)(i,e.etn,e.id),IconPath:Object(P.j)(i,e.etn,e.id)};n(Object(J.b)(u))}}}(U,o))}return Object(Ee.a)()&&(S(Object(Re.a)(xe.c)),Object(xe.d)(),Object(Je.b)(A)&&S(Object(v.b)(l,r,z.e)),n.e(161).then(n.bind(null,"NErG")).then(e=>{S(e.runBpfChecker(r,l,p,w,I))})),M||!Object(Xe.f)(A,We.s)||Object(o.a)(A,r)||S(Object($e.a)(r,l,p)),U}}}function Nt(e){const t={};return null!=e&&null!=e.data&&(t.processId=e.data.processId,t.processInstanceId=e.data.processInstanceId,t.nextStageId=e.data.nextStageId,t.parentrecordtype=e.data.parentrecordtype,t.parentrecordid=e.data.parentrecordid,t.parentrecordname=e.data.parentrecordname),t}function Tt(e,t,n,c,s,u,l){const d=[{name:"PageId",value:e},{name:"saveMode",value:c},{name:"shouldNavigateToSavedEntity",value:n},{name:"performRefresh",value:!!s}];return{type:"form.saveNavigate.async",execute({dispatch:f,getState:b},m,g){const O=b();if(Object(o.a)(O,e))return Promise.reject(Object(re.b)(O,e,2200000016));const j=Object(r.p)(O,e);d.push({name:"CorrelationId",value:g.correlationId},{name:"pageType",value:j});if(!Object(a.ad)(O)&&s){const a=Object(r.j)(O,e);null!=a&&d.push({name:"entityTypeName",value:a.entityTypeName},{name:"formId",value:i.a.toString(a.formId)});const o=Object(h.j)(O,e);return Mt(O,f,m,e,o,t,n,a,s),m.EventManager.ReportComponentSuccess("Forms.SaveForm.SaveAndNavigateAway",d),null}const y=m.TraceManager.getTracer(tt);return Ot(m,g,f,b,e,c,!1,d,u).then(r=>{let a=r;a===nt&&(a=kt(b(),e));const o=Et(a,d,y,"Null identifier after _saveForm within saveFormAndNavigate"),i=Object(h.j)(O,e);return At(f,b,m,i,e,t,n,o,!!s,!0,!1,c,d),a},r=>{var o;r=at(r,e);const i=Object.keys(r),g=it(r);d.push({name:"originalError",value:g});const j=st(i,b,r,f,y,d),I=i[0],F=r[I],E=Object(h.j)(b(),I),P=j[0];if(P&&P.getIsIgnorable()){if(At(f,b,m,E,I,t,n,!1,!!s,P.getCanNavigate(),P.getCanForceNavigate(),c,d),ct(b(),f,m,e,r),2200000006===F.errorCode){const t=kt(b(),e);if(t)return t}throw F}if(ct(b(),f,m,e,r,"Forms.SaveForm.SaveAndNavigateAway",d),!Object(re.e)(F)){if(f(Object(v.b)(E,I,z.b)),Ze(f,b(),F,l,I),Object(a.ld)(O,e)){const t=Object(le.a)(O,e),n=t.map(e=>Object(h.j)(O,e)),[r]=gt(0,t,n,O),a=Object(h.j)(O,r[0]);for(let e=0;e<r.length;e++){const t=r[e],n=Object(h.j)(O,r[e]),i=m.ScriptManager.getContainer(t).getEventManager(),c={entityType:null==a?void 0:a.entityTypeName,id:null===(o=null==a?void 0:a.recordId)||void 0===o?void 0:o.toString()};f(i.runOnPostSave(n,!1,c,F))}}throw F}return f(Object(p.a)(I,F)).then(a=>{if(0===a.status)return f(Object(w.a)(a.pageId)).then(a=>{if("merge_done"!==a.value.param_lastButtonClicked){if(a.value.param_lastButtonClicked===et)return f(Object(v.b)(E,I,z.b)),f(Object(S.b)(I,!0)),f(Tt(I,t,n,c,s,u)).catch(t=>{t=at(t,e);const n=Object.keys(t)[0],a=null==r?void 0:r[n];throw d.push({name:"errorCode",value:null==a?void 0:a.errorCode}),y.warn("Ignorable error on duplicate record save",d),a})}else ot(b(),f,I,E,e)});throw a.error})})},getFailureParameters:(e,t)=>(Object(re.a)(e,d),d)}}function At(e,t,n,a,o,c,s,u,l,d,f,b,p){p.push({name:"performRefresh",value:l});const g=Object(r.j)(t(),o);g&&g.isOfflineSyncError&&e(Object(m.d)(Object.assign(Object.assign({},g),{isOfflineSyncError:!1}),o));const O=t(),v=Object(r.j)(O,o);null!=v&&p.push({name:"_entityTypeName",value:v.entityTypeName},{name:"_formId",value:i.a.toString(v.formId)}),d&&(u||l||f)&&(Mt(O,e,n,o,a,c,s,v,l),e(G(o))),n.EventManager.ReportComponentSuccess("Forms.SaveForm.SaveAndNavigateAway",p)}function Mt(e,t,n,r,o,i,c,u,l){if(c){const o=n.Router.createUrlForPage(i,u),c=o.match(/pagetype=([^&]+)/)[1];if(l||u.pageType!==c){const e=function(e){if(!e)return e;const t=["entityTypeName","id","formId","processId","processInstanceId","selectedStageId","isCrossEntityNavigate","isOfflineSyncError","navItemId","bodyOnly","recordSetQueryKey"],n={entityTypeName:e.entityTypeName};return t.reduce((t,n)=>(t[n]=e[n],t),n)}(u);t(Object(s.a)(i,e,r,W.b.Redirect))}else if(!l&&!Object(a.Ob)(e,r)){const t=n.Router.getHistoryManager(),a=Object(me.a)(e,r);t.ReplaceState(t.GetState(a),o,a)}}}function kt(e,t){const n=Object(r.j)(e,t);return n&&n.entityTypeName&&n.id?new c.a(n.entityTypeName,n.id):null}function _t(e,t,n,r,a,o,i){const c={};return null==a||a.forEach((r,a)=>{n(Object(f.b)(r,o[a],2)),n(Object(b.b)(r,o[a],!1)),c[r]=Object(re.b)(e,t,2200000007)}),r.info(Object(re.c)(2200000007),i),Promise.reject(c)}},"v+zG":function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("5Oca"),a=n("Jsfi"),o=n("ruPX"),i=n("3tOH"),c=n("I8bZ"),s=n("Bj/n");function u(e,t,n){return{type:"form.setServerNotification.sync",sync:!0,execute({dispatch:u,getState:l},d){const f=l(),b=Object(r.v)(f,n);if(b)for(let l=0;l<b.length;l++){const d=b[l],p=[];if(d.Parameters)for(let t=0;t<d.Parameters.length;t++){const i=d.Parameters[t];if(i.ParameterType===a.a.Attribute){const t=Object(r.j)(f,n,i.Data);if(t){const n=t.reference,r=()=>{const t={entityTypeName:n.etn,id:n.id};u(Object(o.a)("EditForm",t,e))};p.push({Label:n.name,Handler:r})}}else i.ParameterType===a.a.String&&p.push({Label:i.Data})}let m=i.a.information;switch(d.Severity){case c.a.Warning:m=i.a.warning;break;case c.a.Error:m=i.a.error}return u(Object(s.c)(t,e,d.Message,m,"serverNotification_"+l,void 0,p))}}}}},xMtD:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"e",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return s})),n.d(t,"f",(function(){return l})),n.d(t,"d",(function(){return d}));var r=n("SAYH"),a=n("504W"),o=n("CPoS");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function i(e,t,n){const a=Object(o.b)(e,t);if(!a||!a.businessProcessFlowEntities||0===a.businessProcessFlowEntities.length)return null;for(const e in a.businessProcessFlowEntities){const t=a.businessProcessFlowEntities[e];if(t.hasOwnProperty("stage")&&r.a.equals(t.stage.stageId,n))return t}return null}function c(e,t){const n=Object(o.b)(e,t);if(!n||!n.businessProcessFlowEntities||0===n.businessProcessFlowEntities.length)return null;const r=n.businessProcessFlowEntities[0];return r.relationships?r.relationships:null}function s(e,t,n){let r=null;if(Object(a.a)(e)||Object(a.a)(e.metadata)||Object(a.a)(e.metadata.forms))return r;const i=Object(o.b)(e,t);if(!i||!i.businessProcessFlowUniqueName){const e=[];return e.push({name:"ProcessId",value:t.guid}),n.error("BPF descriptor does not contain 'businessProcessFlowUniqueName'",e),r}return Object.keys(e.metadata.forms).forEach(t=>{e.metadata.forms[t].EntityLogicalName===i.businessProcessFlowUniqueName&&(r=e.metadata.forms[t])}),r}function u(e,t){const n={};if(Object(a.a)(e.Controls)){const r=[];return r.push({name:"BPF Entity FormId",value:e.Id.guid},{name:"BPF Entity Form Name",value:e.EntityLogicalName},{name:"BPF Entity Form Type",value:e.FormType}),t.info("BPF form descriptor does not contain any controls",r),n}const o=e.Controls;return Object.keys(o).forEach(e=>{Object(a.a)(o[e].UniqueId)||o[e].UniqueId===r.a.EMPTY.guid||(n[e]=o[e])}),n}function l(e,t,n,i){const c=Object(o.b)(e,t),s=n.Tabs,u=n.Sections,l=[];if(l.push({name:"BPF Entity FormId",value:n.Id.guid},{name:"BPF Entity Form Name",value:n.EntityLogicalName},{name:"BPF Entity Form Type",value:n.FormType}),Object(a.a)(s))return i.error("BPF form descriptor does not contain any tabs",l),!1;if(0===Object.keys(s).length)return i.error("BPF form descriptor contains an empty tab collection",l),!1;if(Object(a.a)(u))return i.error("BPF form descriptor does not contain any sections",l),!1;if(0===Object.keys(u).length)return i.error("BPF form descriptor contains an empty section collection",l),!1;const d=[],f=[],b=[],p=c.businessProcessFlowEntities;if(Object.keys(p).forEach(e=>{const t=p[e].stage;Object(a.a)(t)||Object(a.a)(t.stageId)||Object(a.a)(t.stageId.guid)||t.stageId.guid===r.a.EMPTY.guid||d.indexOf(t.stageId.guid)<0&&d.push(t.stageId.guid.toLowerCase())}),Object.keys(s).forEach(e=>{const t=s[e].RawTabId;!Object(a.a)(t)&&t!==r.a.EMPTY.guid&&f.indexOf(t.toLowerCase())<0&&f.push(new r.a(t).guid.toLowerCase())}),Object.keys(u).forEach(e=>{const t=u[e].Id;!Object(a.a)(t)&&t!==r.a.EMPTY&&b.indexOf(t.guid.toLowerCase())<0&&b.push(t.guid.toLowerCase())}),l.push({name:"BPF Stage Ids",value:d},{name:"BPF Entity Form Tab Ids ",value:f},{name:"BPF Entity Form Section Ids ",value:b}),d.length>f.length)return i.error("Number of stageIds in UIData is greater than the number of stageIds in the FormXML",l),!1;if(b.length!==f.length)return i.error("Number of tabs and sections do not match.",l),!1;for(let e=0;e<d.length;e++)if(f.indexOf(d[e])<0)return l.push({name:"Missing Stage Id in BPF Form descriptor",value:d[e]}),i.error("StageId missing from BPF form descriptor",l),!1;return!0}function d(e,t){const n=Object(o.b)(e,t);if(!n||!n.businessProcessFlowEntities||n.businessProcessFlowEntities.length<=1)return null;const r=n.businessProcessFlowEntities[0].relationships?n.businessProcessFlowEntities[1]:n.businessProcessFlowEntities[0];return r&&r.stage?r.stage.stageId:null}},zJiL:function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"e",(function(){return o})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return c})),n.d(t,"f",(function(){return s}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="SUCCESS",a="ERROR",o="WARNING",i="INFORMATION",c="LOCKED",s=new Set([c])}}]),window.bundleExecutionMarkers["scripts/11.js?v=1.4.3886-master"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();