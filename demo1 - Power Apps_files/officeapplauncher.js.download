(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/officeapplauncher.js?v=1.4.3886-master"]={begin:performance.now()},(window.__wpJsonpUci=window.__wpJsonpUci||[]).push([[148],{B9ov:function(e,a,t){"use strict";t.d(a,"a",(function(){return c}));var n=t("d4He"),r=t("NjDY");function c(){return{type:"sitemap.navigatetooffice.async",execute(e,a){const t=e.getState(),c=Object(r.J)(t),o=c?"OfficeWaffle.NavigateOfficePortal":"OfficeWaffle.NavigateOfficePortal.SiteWide";return a.EventManager.ReportComponentSuccess(o),e.dispatch(Object(n.a)(c||"https://go.microsoft.com/fwlink/?LinkID=246804"))}}}},Byjr:function(e,a,t){"use strict";t.r(a),t.d(a,"OfficeAppLauncherWrapper",(function(){return A}));var n=t("mMyr"),r=t("u+q+"),c=t("fM5k"),o=t("IqkD"),i=t("QBtP"),u=t("KOTC"),f=t("Lyxw"),s=t("3/02");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function l(e){const a=Object(o.x)(e);return Object(f.f)(e,s.l)&&a.isLive}var p=t("2c85"),d=t("wge3"),v=t("B9ov"),b=t("SEva"),O=t("pF61"),m=t("jsc8"),g=t("GdzE"),h=t("zsAz");const w=()=>{const e=Object(r.d)(e=>e.delayLoadingState.loadShellComponents),a=Object(r.d)(o.o),f=Object(r.d)(o.g),s=Object(r.d)(l),b=Object(r.d)(p.a),w=n.useContext(i.a),A=n.useRef(null),E=Object(r.d)(O.b),C={Primary:b.backgroundColor,WaffleIcon:b.textColor,HoverText:b.textColor,HoverBackground:b.buttonHover.backgroundColor,PressedText:b.buttonFocus.color,PressedBackground:b.buttonFocus.backgroundColor},[D,j]=n.useState(),[y,S]=n.useState(),[L,k]=n.useState(),[F,M]=n.useState(),N=Object(r.c)();if(n.useEffect(()=>{e&&s&&!D&&async function(e,a,t){try{const n=await e(Object(m.a)("OFFICEWAFFLE_NAVBARDATA"));if(n)t(JSON.parse(n)),a.EventManager.ReportComponentSuccess("OfficeAppLauncher.populateNavbarDataFromCache");else{a.TraceManager.getTracer("OfficeAppLauncher").warn("No navbar data found in session state")}}catch(e){a.EventManager.ReportComponentFailure("OfficeAppLauncher.populateNavbarDataFromCache",e)}}(N,w,j)},[w,e,s,D,N]),n.useEffect(()=>{s&&E&&F&&setTimeout(()=>{document.body.click()},1e3)},[s,E,F]),n.useEffect(()=>{L&&F&&!D&&N(Object(v.a)())},[N,F,L,D]),!e)return null;if(!s||L){const e=()=>N(Object(v.a)());return n.createElement(u.a,{key:"officewaffleplaceholder",loader:()=>t.e(149).then(t.bind(null,"yuAM")).then(e=>e.OfficeWafflePlaceholder),props:{onClickHandler:e}})}return n.createElement(c.SuiteAppLauncher,{ref:A,navBarData:D,culture:a,language:a.split("-")[0],isRTL:f,workloadID:"Dynamics365CRM",appBrandTheme:C,disableTheming:!0,onContextMenuPopup:async(e,a)=>{M(e);const t=[{name:"isShown",value:e},{name:"id",value:a},{name:"clientAuthEnabled",value:s},{name:"navbarDataAvailable",value:!!D},{name:"navbarDataFetchFailed",value:!!L},{name:"showingCachedNavbarData",value:!y&&!!D}];if(w.EventManager.ReportComponentSuccess("OfficeAppLauncher._OfficeAppLauncher",t),!y)try{S(!0),await async function(e,a,t){await e(Object(d.initializeAppHostClient)());const n=await a.AppHostClient.getPluginProvider().getPluginAsync("officeHeader");if(n){const r=await n.getNavBarData(a.EventManager.getCurrentSessionId());t(r);const c=a.TraceManager.getTracer("OfficeAppLauncher");try{c.warn("currentNavbarData different from incoming navbarData"),await e(Object(g.a)("OFFICEWAFFLE_NAVBARDATA",JSON.stringify(r),!1))}catch(e){c.warn("OfficeAppLauncher.saveNavbarDataInSessionStateFailed",e)}return}throw Object(h.d)("OfficeHeaderPlugin not available")}(N,w,j),w.EventManager.ReportComponentSuccess("OfficeAppLauncher.fetchOfficeNavBarDataOnDemand")}catch(e){k(!0);const a=[{name:"navbarDataAvailable",value:!!D}];w.EventManager.ReportComponentFailure("OfficeAppLauncher.fetchOfficeNavBarDataOnDemand",e,null,a)}},isDarkMode:!1})};const A=n.memo((function(){return n.createElement(b.a,{key:"OfficeWaffle",name:"OfficeAppLauncher"},n.createElement(w,null))}))}}]),window.bundleExecutionMarkers["scripts/officeapplauncher.js?v=1.4.3886-master"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();