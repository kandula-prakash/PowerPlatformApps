(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/12.js?v=1.4.3886-master"]={begin:performance.now()},(window.__wpJsonpUci=window.__wpJsonpUci||[]).push([[12],{"+HfF":function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var o=n("pgSX"),a=n("si7p"),r=n("ngeo"),i=n("YxC/"),s=n("EY5k"),l=n("tICD"),d=n("8MGk");function c(e,t){return{type:"commanding.script.error.dialog",execute(n,c,m){var u,p;const h=t.errorCode?t.errorCode:-2140991205,b=null===(u=t.errorFault)||void 0===u?void 0:u.message,y=null===(p=t.errorFault)||void 0===p?void 0:p.stack,C="0x"+r.a.getHexErrorCodeFromInt(h),g="Error_Title_"+C,I="Error_Message_"+C,f=[g,I,"SolutionWizard.Button.Export.Tooltip","Button_Label_OK","Web.Dialog.ErrorCode_Caption","Error_Title_0x8004b056","Error_Title_0x80700000","L_Show_Details_Text","L_Client_Session_Id","L_Current_Time","L_Correlation_Id"];return n.dispatch(Object(s.e)(f)).then(()=>{const t=Object(i.e)(n.getState(),f),r=Object(i.c)(t,g);let s=Object(i.c)(t,I);const u=Object(i.c)(t,"SolutionWizard.Button.Export.Tooltip"),p=Object(i.c)(t,"Button_Label_OK"),h=Object(i.c)(t,"L_Show_Details_Text"),C=Object(i.c)(t,"L_Client_Session_Id"),S=Object(i.c)(t,"L_Current_Time"),_=Object(i.c)(t,"L_Correlation_Id");s=s.replace("\\r\\n{0}","");const M=C.replace("{0}",c.EventManager.getCurrentSessionId()),v=S.replace("{0}",""+new Date),O=_.replace("{0}",m.correlationId);n.dispatch(Object(o.a)(a.d,b,{type:"error"},u,r,s,p,h,[b,M,O,v],void 0,e)).then(e=>{if(0===e.status)return n.dispatch(Object(l.a)(e.pageId)).then(e=>{if(e&&e.value&&e.value.confirmed){const e={mimeType:"text/plain",fileName:"ErrorDetails.txt",fileContent:btoa(y),fileSize:y.length},t={openMode:2};new d.a(c,n).openFile(e,t)}});c.EventManager.ReportComponentFailure("Commanding.Actions.OpenJavaScriptErrorDialog",e.error)})})}}}},"Es1/":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var o=n("M0zh");function a(e,t){const n={ruleContext:e};return{type:o.s,payload:n,meta:{commandManagerId:t}}}},GpAH:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var o=n("M0zh");function a(e,t){const n={ribbonId:e};return{type:o.r,payload:n,meta:{commandManagerId:t}}}},Ki7F:function(e,t,n){"use strict";n.d(t,"a",(function(){return ye}));var o=n("D4rv"),a=n("mMyr"),r=n("u+q+"),i=n("hAdb"),s=n("NvOS"),l=n("z0a7"),d=n("YxC/"),c=n("/to1"),m=n("kXuq"),u=n("odYE"),p=n("SAYH"),h=n("eXjw"),b=n("4leG"),y=n("P7gI"),C=n("6hHv"),g=n("ZdjS"),I=n("wNQP"),f=n("vZzn"),S=n("WTcq"),_=n("mpSO"),M=n("OiiO");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
let v=!1;var O=n("nmJf"),x=n("Me5Q"),B=n("s308"),L=n("nUyF");var j=n("GpAH"),E=n("Es1/"),w=n("Ij+U"),T=n("xqqo"),P=n("Afz2"),N=n("3rse"),F=n("huli"),R=n("o0iw"),A=n("RiHV"),D=n("iZ7K"),k=n("cUMa"),$=n("ILmX"),z=n("wgH2"),W=n("VZXL"),X=n("GAI+"),G=n("CfXY"),U=n("IqkD"),H=n("Lyxw"),q=n("3/02"),K=n("504W"),V=n("eD3A");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
let Z=!1;class Y extends a.Component{constructor(e){super(e),this._isGlobalComandBar=!1,this._selectedIndex=-1,this._selectedId="",this._allControls=[],this._allRenderingMenuItems=[],this._keyboardHandler=this._keyboardHandler.bind(this),this._keyboardFocusHandler=this._keyboardFocusHandler.bind(this),this._isGlobalComandBar=e.commandManagerId.startsWith(_.e),this._onCommandBarMeasure=this._onCommandBarMeasure.bind(this)}_init(){this._initialized||(this._initialized=!0,this._extractButtons(this.props))}_needResetIndex(){return!!F.findDOMNode(this._commandBarItems)&&(!this._selectedId||!document.getElementById(this._selectedId))}_moveIndex(e,t=!1,n=!0){var o;const a=F.findDOMNode(this._commandBarItems);if(!a)return;const r=a.querySelectorAll("[tabindex='0']");if(null==r?void 0:r.length)for(let e=0;e<r.length;e++)null===(o=r[e])||void 0===o||o.setAttribute("tabindex","-1");const i=t?Object(V.i)(a.childNodes[e]):Object(V.f)(a.childNodes[e]);i&&(this._selectedIndex=e,this._selectedId=i.id,(n||a.contains(document.activeElement))&&i.focus(),i.setAttribute("tabindex","0"))}_generateControl(e){let t=X.a,n=null;return e.Children&&e.Children.length>0&&(t=e.execute?X.c:X.b,n=e.Children.map(e=>this._generateControl(e))),{Command:e.Id,Id:e.Id,DataId:e.DataId,ControlType:t,DisplayText:e.DisplayText,execute:e.execute,balloonCountSelector:e.balloonCountSelector,executeInjectedPopulationQueryCommand:e.executeInjectedPopulationQueryCommand,Icon:e.Icon,isInjectedCommand:!0,WillOpenFlyout:e.WillOpenFlyout,IsInFlyout:e.IsInFlyout,ToolTipTitle:void 0!==e.Tooltip?e.Tooltip.title:"",ToolTipDescription:void 0!==e.Tooltip?e.Tooltip.description:"",ChildInjectedControls:n,dataLPId:e.dataLPId,accessibilityExpanded:e.accessibilityExpanded,controlsElementId:e.controlsElementId,ownsElementId:e.ownsElementId}}_getLearningPathId(e){let t="commandbar-";if(e.ribbonId)t+=e.ribbonId;else if(e.commandManagerId){t+=e.commandManagerId;const n=t.indexOf(":");n>-1&&(t=t.substring(n+1))}return t}componentWillReceiveProps(e){var t,n,o;if(!0===(null===(n=null===(t=this.props)||void 0===t?void 0:t.ribbonDescriptor)||void 0===n?void 0:n.Localized)&&!0!==(null===(o=null==e?void 0:e.ribbonDescriptor)||void 0===o?void 0:o.Localized))return;const a=this._areMenuLengthPropsChanged(e,this.props)||!this._areButtonsEqualInProps(e,this.props);this._extractButtons(e,a)}_areButtonsEqualInProps(e,t){return e.menuControlMapping===t.menuControlMapping&&this._areControlListsEqual(e.addedCommandList,t.addedCommandList)&&this._areControlListsEqual(e.appendedCommandList,t.appendedCommandList)}_areControlListsEqual(e,t){return null==e||null==t?null==e&&null==t:e.length===t.length&&e.every((e,n)=>e.Id===t[n].Id&&e.DisplayText===t[n].DisplayText)}_areMenuLengthPropsChanged(e,t){return e.width!==t.width||e.iconPosition!==t.iconPosition||e.commandbarDisplayMode!==t.commandbarDisplayMode||e.mainMenuLength!==t.mainMenuLength}_extractButtons(e,t=!0){this._updateAllControls(e),this._updateRenderingMenuItems(e),t&&(this._mainMenuLength=Object(G.c)(e.width,e.commandBarStyle,this._allControls,e.iconPosition,e.isRTL,e.commandbarDisplayMode,e.mainMenuLength,e.forceUseOfMainMenuLength,Z),this._selectedId=void 0)}_updateAllControls(e){if(this._allControls=[],e.addedCommandList&&e.addedCommandList.forEach(e=>{this._allControls.push(this._generateControl(e))}),e.ribbonDescriptor&&e.ribbonDescriptor.Layout){let t=new Array;e.ribbonDescriptor.Layout.Tabs.Tab&&(t=t.concat(e.ribbonDescriptor.Layout.Tabs.Tab)),e.ribbonDescriptor.Layout.ContextualTabs.Tab&&(t=t.concat(e.ribbonDescriptor.Layout.ContextualTabs.Tab)),t.forEach(t=>{t&&t.Groups&&t.Groups.Group&&t.Groups.Group.forEach(t=>{t.Controls.Items.forEach(t=>{const n=t?Object($.j)(t.Id,Object(z.a)(e.ribbonId)):null;t&&n&&e.menuControlMapping[n]&&this._allControls.push(t)})})})}e.appendedCommandList&&e.appendedCommandList.forEach(e=>{this._allControls.push(this._generateControl(e))})}_updateRenderingMenuItems(e){this._allRenderingMenuItems=[];const t=e.selectedRecords&&e.selectedRecords.length>0;this._allControls.forEach((n,o)=>{const a={RootButtonId:null,contextKey:e.contextKey,areRecordsSelected:t,isFlyoutControl:!1,commandManagerId:e.commandManagerId,control:n,iconPosition:e.iconPosition,flyoutDepth:0,commandBarStyle:e.commandBarStyle,isMainView:!0,executeCommand:e.executeCommand,ribbonId:e.ribbonId,pageId:e.pageId,commandbarDisplayMode:e.commandbarDisplayMode,updateMainViewKeyboardIndex:this._updateSelectedIndex(o),hideFlyoutButtonChevron:e.hideFlyoutButtonChevron,rootZIndex:e.rootZIndex},r=Object(R.f)(n,a,this._allRenderingMenuItems.length,e.entityDisplayName,e.entityDisplayCollectionName);this._allRenderingMenuItems.push(r)})}render(){this._init(),this._numberMainMenuControls=0,this._numberOverflowControls=0;const e=[],t=[];if(this._allRenderingMenuItems.forEach(e=>{t.length<this._mainMenuLength&&(t.push(e),this._numberMainMenuControls++)}),this._allControls.length>this._mainMenuLength)for(let t=this._mainMenuLength;t<this._allControls.length;t++)this._addControlToMoreMenu(this._allControls[t],e);const n=this.props.selectedRecords&&this.props.selectedRecords.length>0;if(this._numberOverflowControls>0){const o=Object(d.c)(this.props.resourceStrings,W.c),r=Object(d.c)(this.props.resourceStrings,W.b),i=this.props.entityDisplayName?String.format(r,this.props.entityDisplayName):o,s=Object(R.i)({ToolTipTitle:i,OverflowIcon:this.props.useVerticalMoreIcon?_.o:_.i},_.g),l=Object(R.e)(s,this.props.commandManagerId,this.props.contextKey),c=Object.assign({},this.props.commandBarStyle);c.listItemBody=Object.assign({},c.listItemBody),c.listItemBody.button=Object.assign(Object.assign({},c.listItemBody.button),{paddingLeft:0,paddingRight:0}),t.push(a.createElement(w.a,{contextKey:this.props.contextKey,areRecordsSelected:n,isOverflowFlyoutMoreButton:!0,commandbarDisplayMode:this.props.commandbarDisplayMode,isFlyoutControl:!1,flyoutDepth:0,commandManagerId:this.props.commandManagerId,pageId:this.props.pageId,accessibilityLabel:i,key:l,id:l,tabIndex:-1,ariaOwnsElementId:l+"_flyout",RootButtonId:l,menuItems:e,control:s,iconPosition:this.props.iconPosition,commandBarStyle:c,isMainView:!0,executeCommand:this.props.executeCommand,ribbonId:this.props.ribbonId,updateMainViewKeyboardIndex:this._updateSelectedIndex(this._numberMainMenuControls),rootZIndex:this.props.rootZIndex})),this._numberMainMenuControls++}return this._getMarkupOfCommandBar(t,this.props)}_onCommandBarMeasure(){const e=F.findDOMNode(this._commandBarItems);if(e){const t=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e){if(e){const t=getComputedStyle(e),n=parseInt(t.fontSize,10),o=parseFloat(t.letterSpacing),a=parseFloat(t.wordSpacing);return o>=.12*n&&a>=.16*n}}(e);Z!==t&&(Z=t,this._extractButtons(this.props),this.forceUpdate())}}_getMarkupOfCommandBar(e,t){const n="$commandBarInfo"+t.commandManagerId,o="$commandBarItemsList"+t.commandManagerId,r=this._getCommandBarAccessibilityLabel(t);return e.length>0?a.createElement(m.a,{style:this._transformContainerStyle(t),key:n,isRequestedMeasuring:!0,onMeasuring:this._onCommandBarMeasure},a.createElement(T.a,{ref:e=>{this._commandBarItems=e,this._needResetIndex()&&this._moveIndex(0,!1,!1)},testhooks:{id:_.d,[A.a.LearningPathDOMAttributeSuffix]:this._getLearningPathId(t)},accessibilityLabel:r,key:o,role:P.q,style:Object.assign(Object.assign({},t.commandBarStyle.list),{listStyleType:"none",flexShrink:"0"}),onKeyDown:this._keyboardHandler,onFocus:this._keyboardFocusHandler},e)):null}_getCommandBarAccessibilityLabel(e){return this._isGlobalComandBar?Object(d.c)(e.resourceStrings,W.f):""!==e.entityDisplayName&&void 0!==e.relationshipType?e.entityDisplayName+" "+Object(d.c)(e.resourceStrings,W.e):Object(d.c)(e.resourceStrings,W.e)}_transformContainerStyle(e){let t=e.commandBarStyle.container;return e.height&&(t=Object.assign(Object.assign({},t),{maxHeight:e.height+"px",overflowY:"auto"})),t}_addControlToMoreMenu(e,t){t.push(e),this._numberOverflowControls++}_updateSelectedIndex(e){return()=>{this._selectedIndex=e,this._moveIndex(e,!1,!1)}}_getBrightnessFromRGB(e,t,n){return Math.round((299*e+587*t+114*n)/1e3)}_keyboardFocusHandler(e){let t=e.target;const n=document.getElementById(t.id);if(n&&n.style){let e="";do{e=window.getComputedStyle(t).backgroundColor,t=t.parentElement}while(("rgba(0, 0, 0, 0)"===e||"transparent"===e)&&t);if(-1!==e.indexOf("rgb")){const t=e.split(/[()]+/)[1].split(",");n.style.outlineColor=this._getBrightnessFromRGB(parseInt(t[0],10),parseInt(t[1],10),parseInt(t[2],10))>125?"#666666":"#FFFFFF"}}const o=F.findDOMNode(this._commandBarItems),a=o&&o.children;if(a){const t=e.target.id;for(let e=0;e<a.length;e++)if(Object(V.u)(a[e],t)){this._selectedIndex=e;break}}}_keyboardHandler(e){if(e.keyCode===N.a.Enter)return e.stopPropagation(),e.preventDefault(),void e.target.click();const t=!this.props.isRTL&&e.keyCode===N.a.RightArrow||this.props.isRTL&&e.keyCode===N.a.LeftArrow;!this.props.isRTL&&e.keyCode===N.a.LeftArrow||this.props.isRTL&&e.keyCode===N.a.RightArrow?this._moveIndex(J(this._selectedIndex-1,this._numberMainMenuControls),!0):t&&this._moveIndex(J(this._selectedIndex+1,this._numberMainMenuControls),!1)}}function J(e,t){return(e%t+t)%t}Y.displayName=_.d;const Q=Object(r.a)((function(){const e=Object(k.g)(),t=Object(d.h)();return function(n,o){const a=e(n,o),r=o.ribbonId?o.ribbonId.split(":"):null,i=r&&r.length>1?r[r.length-1]:null,s=Object(D.h)(n,i);return{menuControlMapping:a,entityDisplayName:s&&s.DisplayName?s.DisplayName:"",entityDisplayCollectionName:s&&s.DisplayCollectionName?s.DisplayCollectionName:"",resourceStrings:t(n,W.g),isRTL:Object(U.g)(n),useVerticalMoreIcon:Object(K.a)(o.useVerticalMoreIcon)?Object(H.f)(n,q.Rh)&&Object(R.r)(_.o):o.useVerticalMoreIcon}}}))(Y);var ee=n("GYDS"),te=n("GT4X"),ne=n("P86a"),oe=n("jRy5"),ae=n("dHD5"),re=n("0kGT"),ie=n("GEbX"),se=n("Knfm"),le=n("tJ+6");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class de extends a.Component{constructor(){super(...arguments),this._startedInitializing=!1}componentWillUnmount(){this.props.destroyCommandBar(this.props.commandManagerId||this.props.id)}componentDidMount(){this._handleProps(this.props)}componentDidUpdate(e){this._handleProps(e)}render(){var e;if(this._isNativeCommandManager())return null;const t=this.props.customCommandManagerStyle?this.props.customCommandManagerStyle:{float:"right"};if(this.props.isRTL?t.paddingRight=0:t.paddingLeft=0,!this.props.commandBarEnabled&&(this.props.isDashboardCommandBar||this.props.ruleContext&&(this.props.contextToken&&this.props.contextToken.contextTokenType===oe.a.MainGrid&&1===this.props.ruleContext.ContextType||2===this.props.ruleContext.ContextType||5===this.props.ruleContext.ContextType)))return null;if(!Object(ee.c)(this.props.commandManagerId,!0)){if(this.props.initializeMetadataFailed){if(this._isLoadingStringDisabled())return null;let n=null;return-2147093999===(null===(e=this.props.ribbonDescriptor)||void 0===e?void 0:e.ErrorCode)&&(n=Object(d.c)(this.props.resourceStrings,W.d)),n&&""!==n||(n=Object(d.c)(this.props.resourceStrings,W.a)),a.createElement(m.a,{style:t},a.createElement(c.a,{style:Object(R.l)()},n))}if(!this.props.initializationCompleted)return this._isLoadingStringDisabled()?null:a.createElement(m.a,{style:t})}const n=this.props.contextToken?Object(ae.w)(this.props.contextToken):null;let o=null;return null!==this.props.selectedRecords&&void 0!==this.props.selectedRecords?o=this.props.selectedRecords:this.props.ruleContext&&null!==this.props.ruleContext.SelectedItems&&void 0!==this.props.ruleContext.SelectedItems&&(o=this.props.ruleContext.SelectedItems.map(e=>e.EntityReference)),a.createElement(m.a,{style:t},this.props.isHidden?null:a.createElement(Q,{commandbarDisplayMode:this.props.commandbarDisplayMode,addedCommandList:this.props.addedCommandList,appendedCommandList:this.props.appendedCommandList,width:this.props.width,mainMenuLength:this.props.mainMenuLength,forceUseOfMainMenuLength:this.props.forceUseOfMainMenuLength,iconPosition:this.props.iconPosition,commandManagerId:this.props.commandManagerId?this.props.commandManagerId:this.props.id,pageId:this.props.id,ribbonDescriptor:this.props.ribbonDescriptor,selectedRecords:o,executeCommand:this._executeCommand(this.props.ribbonDescriptor,this.props.ruleContext,this.props.id,this.props.commandManagerId?this.props.commandManagerId:this.props.id,n),commandBarStyle:this._autoPopulateCommandBarStyle(),ribbonId:this.props.ribbonId,height:this.props.height,hideFlyoutButtonChevron:this.props.hideFlyoutButtonChevron,contextKey:n,rootZIndex:this.props.rootZIndex,useVerticalMoreIcon:this.props.useVerticalMoreIcon,relationshipType:this.props.relationshipType}))}_isLoadingStringDisabled(){return this.props.width<170}_handleProps(e){var t,n;if(this.props.initializeMetadataFailed)return;Object(ee.c)(this.props.commandManagerId)&&this.props.initializeGlobalScriptContainer();const o=this.props;if(this._isNativeCommandManager()&&(this._didCommandListChange(o.addedCommandList,e.addedCommandList)&&o.storeAddedCommandList(o.commandManagerId,o.addedCommandList),this._didCommandListChange(o.appendedCommandList,e.appendedCommandList)&&o.storeAppendedCommandList(o.commandManagerId,o.appendedCommandList)),this.props.initializationCompleted){if(e.ruleContext&&o.ruleContext&&!e.ruleContext.IsServerAvailable&&o.ruleContext.IsServerAvailable&&o.retrieveRibbon(o.ribbonId),Object(k.a)(o.allowedControls,e.allowedControls,(e,t)=>e===t)||o.storeAllowListInState(o.allowedControls,o.commandManagerId),o.metaDataLoadedResolve&&o.metaDataLoadedResolve(!0),o.contextToken!==e.contextToken&&o.storeContextTokenInState(),o.ribbonId&&""!==o.ribbonId&&o.xrmInitialized&&o.ribbonDescriptor&&o.ribbonDescriptor.initialized===h.a.Initialized){const t=this._didFormChange(o,e),n=this._didRuleContextChange(o,e),a=this._didServerStatusChange(o,e),r=e.ribbonDescriptor!==o.ribbonDescriptor;if(t||n||a||r){const e=t||a||r;r&&o.setCommandManagerInitializationState(ne.a.Uninitialized,o.commandManagerId),o.storeRuleContextInState(o.ruleContext,o.commandManagerId||o.id),o.evaluateRules(o.ribbonDescriptor,o.ruleContext,e)}}this._isNativeCommandManager(!1)&&(this.props.storeAddedCommandList(this.props.commandManagerId,this.props.addedCommandList),this.props.storeAppendedCommandList(this.props.commandManagerId,this.props.appendedCommandList)),e.ribbonId!==o.ribbonId&&o.storeRibbonIdInState(o.ribbonId,o.commandManagerId||o.id),null===(n=(t=this.props).initializationCompletedCallback)||void 0===n||n.call(t)}else{const e=Object(z.a)(o.ribbonId);!this.props.xrmInitialized&&o.ribbonId&&e&&"undefined"!==e||this._startedInitializing||(this._startedInitializing=!0,this._isNativeCommandManager()&&(this.props.storeAddedCommandList(this.props.commandManagerId,this.props.addedCommandList),this.props.storeAppendedCommandList(this.props.commandManagerId,this.props.appendedCommandList)),this.props.initializeCommandBar())}}_isNativeCommandManager(e=!0){return e?this.props.isInMobileModeForOct2019&&!this.props.isMainFormDialog&&(this.props.isNativeMode||(t=this.props.id,n=this.props.commandManagerId,Object(ee.c)(n)||n===t)):this.props.isInMobileModeForOct2019&&this.props.isNativeMode;var t,n}_didCommandListChange(e,t){return!Object(k.a)(e,t,(e,t)=>e.Id===t.Id&&e.DisplayText===t.DisplayText&&e.execute===t.execute)}_didRuleContextChange(e,t){return t.ruleContext&&e.ruleContext&&!Object(k.a)(e.ruleContext.SelectedItems,t.ruleContext.SelectedItems,(e,t)=>u.a.equals(e.EntityReference,t.EntityReference))||!(t.ruleContext||!e.ruleContext)}_didServerStatusChange(e,t){return t.ruleContext&&e.ruleContext&&t.ruleContext.IsServerAvailable!==e.ruleContext.IsServerAvailable}_didFormChange(e,t){if(e.isMultiSessionMode&&Object(ee.c)(e.commandManagerId,!0))return!1;if(e.recordStateCode!==t.recordStateCode&&null!=e.recordStateCode||e.recordStatusCode!==t.recordStatusCode&&null!=e.recordStatusCode)return!0;const n=e.ruleContext.EntityId||p.a.EMPTY,o=t.ruleContext.EntityId||p.a.EMPTY;return!p.a.equals(n,o)}_autoPopulateCommandBarStyle(){const e=this.props.designLanguage;this._defaultCommandBarStyle||(this._defaultCommandBarStyle=Object(R.n)(this.props.isRTL,e)),this._memoizedCommandBarStyle||(this._memoizedCommandBarStyle=this._defaultCommandBarStyle);const t=this.props.commandBarStyle?Object(R.n)(this.props.isRTL,e):this._defaultCommandBarStyle;return this.props.commandBarStyle&&(this.props.commandBarStyle.container&&(t.container=this._autoPopulateContainerStyles(this.props.commandBarStyle.container,this._defaultCommandBarStyle.container,this._memoizedCommandBarStyle.container)),this.props.commandBarStyle.flyoutStyles&&(t.flyoutStyles=this._autoPopulateFlyoutStyles(this.props.commandBarStyle.flyoutStyles,this._defaultCommandBarStyle.flyoutStyles,this._memoizedCommandBarStyle.flyoutStyles)),this.props.commandBarStyle.list&&(t.list=this._autoPopulateListStyles(this.props.commandBarStyle.list,this._defaultCommandBarStyle.list,this._memoizedCommandBarStyle.list)),this.props.commandBarStyle.listItem&&(t.listItem=this._autoPopulateListStyles(this.props.commandBarStyle.listItem,this._defaultCommandBarStyle.listItem,this._memoizedCommandBarStyle.listItem)),this.props.commandBarStyle.listItemBody&&(t.listItemBody=this._autoPopulateButtonStyle(this.props.commandBarStyle.listItemBody,this._defaultCommandBarStyle.listItemBody,this._memoizedCommandBarStyle.listItemBody)),this.props.commandBarStyle.primaryOfSplitButton&&(t.primaryOfSplitButton=this._autoPopulateIButtonStyles(this.props.commandBarStyle.primaryOfSplitButton,this._defaultCommandBarStyle.primaryOfSplitButton,this._memoizedCommandBarStyle.primaryOfSplitButton)),this.props.commandBarStyle.moreIcon&&(t.moreIcon=this._autoPopulateIButtonStyles(this.props.commandBarStyle.moreIcon,this._defaultCommandBarStyle.moreIcon,this._memoizedCommandBarStyle.moreIcon)),this.props.commandBarStyle.splitbuttonicon&&(t.splitbuttonicon=this._autoPopulateIButtonStyles(this.props.commandBarStyle.splitbuttonicon,this._defaultCommandBarStyle.splitbuttonicon,this._memoizedCommandBarStyle.splitbuttonicon)),this.props.commandBarStyle.splitbuttonOverflowButton&&(t.splitbuttonOverflowButton=this._autoPopulateIButtonStyles(this.props.commandBarStyle.splitbuttonOverflowButton,this._defaultCommandBarStyle.splitbuttonOverflowButton,this._memoizedCommandBarStyle.splitbuttonOverflowButton)),this.props.commandBarStyle.list&&(t.list=this._autoPopulateListStyle(this.props.commandBarStyle.list,this._memoizedCommandBarStyle.list)),this.props.commandBarStyle.overflowFlyoutMoreButton&&(t.overflowFlyoutMoreButton=this._autoPopulateListStyle(this.props.commandBarStyle.overflowFlyoutMoreButton,this._memoizedCommandBarStyle.overflowFlyoutMoreButton)),this.props.commandBarStyle.commandBarRefreshProps&&(t.commandBarRefreshProps=this.props.commandBarStyle.commandBarRefreshProps)),this._isCommandBarStyleEqual(t,this._memoizedCommandBarStyle)||(this._memoizedCommandBarStyle=t),this._memoizedCommandBarStyle}_autoPopulateContainerStyles(e,t,n){const o=e||t;return o===n?n:o}_autoPopulateListStyles(e,t,n){const o=e||t;return o===n?n:o}_autoPopulateIButtonStyles(e,t,n){const o=e||t;return o===n?n:o}_autoPopulateFlyoutStyles(e,t,n){const o={flyoutContainerStyles:e.flyoutContainerStyles||t.flyoutContainerStyles,flyoutListItemBody:e.flyoutListItemBody||t.flyoutListItemBody,flyoutListItemStyles:e.flyoutListItemStyles||t.flyoutListItemStyles,flyoutListStyles:e.flyoutListStyles||t.flyoutListStyles,flyoutChevronStyle:e.flyoutChevronStyle||t.flyoutChevronStyle,flyoutPrimaryOfSplitButton:e.flyoutPrimaryOfSplitButton||t.flyoutPrimaryOfSplitButton,flyoutBackButtonStyle:e.flyoutBackButtonStyle||t.flyoutBackButtonStyle,flyoutBackButtonTextStyle:e.flyoutBackButtonTextStyle||t.flyoutBackButtonTextStyle};return this._isFlyoutButtonStyleEqual(o,n)?n:o}_autoPopulateButtonStyle(e,t,n){const o={button:e.button||t.button,icon:e.icon||t.icon,text:e.text||t.text,iconWrapperStyles:e.iconWrapperStyles||t.iconWrapperStyles,splitButtonChevronIconWrapper:e.splitButtonChevronIconWrapper||t.splitButtonChevronIconWrapper,flyoutButtonChevronIconWrapper:e.flyoutButtonChevronIconWrapper||t.flyoutButtonChevronIconWrapper,buttonContentWrapperStyle:e.buttonContentWrapperStyle||t.buttonContentWrapperStyle};return this._isButtonStyleEqual(o,n)?n:o}_autoPopulateListStyle(e,t){return t===e?t:e}_isCommandBarStyleEqual(e,t){return e.container===t.container&&e.flyoutStyles==e.flyoutStyles&&e.list===t.list&&e.listItem===t.listItem&&e.listItemBody===t.listItemBody&&e.moreIcon===t.moreIcon&&e.splitbuttonicon===t.splitbuttonicon}_isButtonStyleEqual(e,t){return e.button===t.button&&e.icon===t.icon&&e.text===t.text}_isFlyoutButtonStyleEqual(e,t){return e.flyoutContainerStyles===t.flyoutContainerStyles&&this._isButtonStyleEqual(e.flyoutListItemBody,t.flyoutListItemBody)&&e.flyoutListItemStyles===t.flyoutListItemStyles&&e.flyoutListStyles===t.flyoutListStyles&&e.flyoutPrimaryOfSplitButton===t.flyoutPrimaryOfSplitButton}_executeCommand(e,t,n,o,a){return function(r,i,s,l,d){return Object(g.a)(e,t,r,i,s,n,o,a,l,d)}}}de.displayName="CommandManager";const ce=Object(r.a)((function(){const e=Object(z.d)(),t=Object(d.h)();return function(n,o){const a=Object($.k)(n,o.ribbonId),r=a&&a.initialized===h.a.Error,i=Object(k.b)(n,o),s=Object(k.c)(n,o),l=Object(f.b)(n,o.commandManagerId,o.id,o.contextToken,o.skipPageXrmReady),d=e(n,o.id,o.ribbonId,o.relationshipType,o.contextToken,o.customControlType,o.selectedRecords,o.allRecords),c=Object(b.a)(n),m=t(n,W.g),u=Object(U.g)(n),p=Object(le.b)(n)?Object(le.a)(n):null,y=Object(te.a)(n,o.commandManagerId),C=Object(se.a)(n)===ie.a.MultiSession;return{commandBarEnabled:c,ribbonDescriptor:a,initializeMetadataFailed:r,ruleContext:d,xrmInitialized:l,recordStateCode:i,recordStatusCode:s,resourceStrings:m,isRTL:u,designLanguage:p,initializationCompleted:y,isMultiSessionMode:C,isInitialRuleEvaluationComplete:C&&Object(te.b)(n,o.commandManagerId),isInMobileModeForOct2019:Object(re.c)(n)}}}),(function(e,t){const n=t.contextToken?Object(ae.w)(t.contextToken):null;return{storeRuleContextInState:(t,n)=>e(Object(E.a)(t,n)),initializeCommandBar:()=>e(Object(I.a)(t.ribbonId,t.commandManagerId,t.id,t.contextToken,t.relationshipType,t.selectedRecords,t.allRecords,t.customControlType,t.allowedControls,t.metaDataLoadedResolve,t.skipPageXrmReady)),initializeGlobalScriptContainer:()=>{return e((n=t.commandManagerId,{type:"commanding.initGlobalScriptContainer",execute:({dispatch:e,getState:t},o)=>n!==_.e||Object(f.a)(t(),n)||v?Promise.resolve():(v=!0,e(Object(M.a)(S.a.GLOBAL_CONTAINER_KEY,!0)).then(()=>{e(Object(M.b)(!0,n)),v=!1}))}));var n},evaluateRules:(o,a,r)=>e(Object(C.c)(o,a,t.id,t.commandManagerId||t.id,n,r)),storeRibbonIdInState:(t,n)=>e(Object(j.a)(t,n)),storeContextTokenInState:()=>e(Object(L.a)(t.contextToken,t.commandManagerId)),storeAllowListInState:(t,n)=>e(Object(B.a)(t,n)),destroyCommandBar:t=>e(Object(y.a)([t])),retrieveRibbon:t=>e(Object(O.a)(t)),setCommandManagerInitializationState:(t,n)=>e(Object(x.a)(t,n)),storeAppendedCommandList:(t,n)=>e(function(e,t){return{type:_.n,payload:t,meta:{commandManagerId:e}}}(t,n)),storeAddedCommandList:(t,n)=>e(function(e,t){return{type:_.m,payload:t,meta:{commandManagerId:e}}}(t,n))}}))(de);var me=n("KOTC");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function ue(e){return a.createElement(me.a,{loader:()=>Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(7),n.e(18),n.e(20),n.e(21),n.e(24),n.e(22),n.e(25),n.e(30),n.e(27),n.e(29),n.e(31),n.e(32),n.e(33),n.e(38),n.e(39),n.e(42),n.e(179),n.e(103)]).then(n.bind(null,"ry8h")).then(e=>e.CommandCheckerInterfaceRoot),props:e})}ue.displayName="CommandCheckerInterfaceHook";var pe=n("RD1j"),he=n("SEva");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const be=["CommandChecker.CommandChecker.Label"];const ye=a.memo((function(e){const[t,n]=a.useState(!1),{appendedCommandList:c}=e,m=Object(o.d)(e,["appendedCommandList"]),u=e.ribbonId,p=e.commandManagerId;let h=null;const b=Object(r.d)(i.h),y=Object(r.d)(e=>Object($.k)(e,u)),C=Object(r.d)(e=>Object(pe.a)(e,p)),g=Object(l.a)(be),I=g&&Object(d.c)(g,"CommandChecker.CommandChecker.Label")||"Command checker",f=Object(r.d)(t=>Object($.n)(t,y,e.id,p,e.selectedRecords&&e.selectedRecords.length>0)),S=Object(r.d)(e=>Object(te.e)(e,p)),_=window.location.origin+Object(r.d)(e=>Object(s.a)(e,"")),{isAdmin:M,isCustomizer:v,isSupportUser:O}=Object(r.d)(U.x);if(b&&y){const e=[];c&&e.push(...c),e.push({Icon:"CommandChecker",DisplayText:I,Id:"CommandChecker",execute:()=>{n(!0)}}),h=a.createElement(a.Fragment,null,a.createElement(ce,Object.assign({appendedCommandList:e},m)),t&&a.createElement(ue,{ribbonDescriptor:y,context:Object(z.b)(u),entityLogicalName:Object(z.a)(u),closeCommandCheckerHandler:()=>{n(!1)},buttonVisibleMap:f,ribbonRuleEvaluationResults:S,orgUrl:_,injectedXML:C,isAdmin:M,isCustomizer:v,isSupportUser:O}))}else h=a.createElement(ce,Object.assign({},e));return a.createElement(he.a,{key:e.commandManagerId||e.ribbonId,name:"CommandManager"},h)}))},VZXL:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"d",(function(){return a})),n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"e",(function(){return s})),n.d(t,"f",(function(){return l})),n.d(t,"g",(function(){return d}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const o="Web.CommandBar.ErrorLoading_Message",a="Web.CommandBar.OfflineErrorLoading_Message",r="Web.CommandBar.MoreCommands_ToolTip",i="Web.CommandBar.MoreCommandsForEntity_ToolTip",s="Command_Bar_Label",l="Global_Command_Bar_Label",d=["Web.CommandBar.Loading_Message",o,a,r,i,s,l]},ZdjS:function(e,t,n){"use strict";n.d(t,"a",(function(){return N}));var o=n("2yvP"),a=n("TDVd"),r=n("NjDY"),i=n("IqkD"),s=n("iZ7K"),l=n("SAYH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class d{openUrl(e,t,n,o){var a,d;if(e&&e.Address){const c=Object(r.D)(n),m=Object(r.C)(n),u=Object(i.x)(n),p=new URL(e.Address,window.location.origin);if(t.forEach(e=>{e.name&&p.searchParams.set(e.name,e.value)}),e.PassParameters&&(p.searchParams.set("orgname",m),p.searchParams.set("userlcid",u.languageId.toString()),p.searchParams.set("orglcid",c.languageCode.toString()),2===o.ContextType||5===o.ContextType)){const e=Object(s.p)(n,o.ContextEntityLogicalName).toString();p.searchParams.set("typename",o.ContextEntityLogicalName),p.searchParams.set("type",e);const t=(null===(a=null==o?void 0:o.EntityId)||void 0===a?void 0:a.guid)?null===(d=null==o?void 0:o.EntityId)||void 0===d?void 0:d.guid.toString():l.a.EMPTYGUIDSTRING;p.searchParams.set("id",t)}return window.open(p.href," ",e.WinParameters)}return null}}var c=n("M0zh");function m(e,t,n){const o={injectedXML:n};return{type:c.p,payload:o,meta:{commandManagerId:e,flyoutControlId:t}}}var u=n("3mEc"),p=n("lY/Z"),h=n("WePp");class b extends h.a{constructor(e,t,n,o,a,r,i){super("uci_commanding_command_execution"),super.addEventParameter("TimeTaken",new Date),super.addEventParameter("CommandType",e),super.addEventParameter("CommandId",t),super.addEventParameter("ControlId",n),super.addEventParameter("CommandManagerId",o),super.addEventParameter("PageId",a),super.addEventParameter("EntityName",r),super.addEventParameter("SelectedItemsCount",i)}}var y=n("pEXn"),C=n("Uv1Y"),g=n("+HfF"),I=n("eD3A"),f=n("sZ+8"),S=n("V6aM"),_=n("zI6t"),M=n.n(_),v=n("mlvZ");class O{constructor(){this.Items=null}}class x{constructor(){this.Alt=null,this.ControlType=null,this.Command=null,this.LabelText=null,this.Id=null,this.ModernImage=null,this.Menu=null}}class B{constructor(){this.Item=null,this.Title=null}}class L{constructor(){this.MenuSection=null,this.Id=null}}var j=n("eruq");class E{constructor(e){this._parsedXml=null,this._parsedXml=this._parseXMLFromString(e)}_parseXMLFromString(e){const t=Object(j.b)(e),n=Object(j.a)(t);let o=null;return n.hasChildNodes()&&(o=this.parseMenuFromXML(n.childNodes().get_item(0))),o}getParsedXml(){return this._parsedXml}parseMenuFromXML(e){let t=new L;if("Menu"===e.get_tagName()){if(t.Id=e.getAttribute("Id"),t.MenuSection=new Array(0),e.hasChildNodes()){const n=e.childNodes();for(let e=0;e<n.get_count();e++)t.MenuSection.push(this.parseMenuSectionFromXML(n.get_item(e)))}}else t=null;return t}parseMenuSectionFromXML(e){let t=new B;return"MenuSection"===e.get_tagName()?(t.Title=e.getAttribute("Title"),e.hasChildNodes()?t.Item=this.parseItemFieldFromXML(e.childNodes().get_item(0)):t.Item=null):t=null,t}parseItemFieldFromXML(e){let t=new O;if("Controls"===e.get_tagName()){if(t.Items=new Array(0),e.hasChildNodes()){const n=e.childNodes();for(let e=0;e<n.get_count();e++)t.Items.push(this.parseItemFromXML(n.get_item(e)))}}else t=null;return t}parseItemFromXML(e){let t=new x;switch(t.Alt=e.getAttribute("Alt"),t.ControlType=e.get_tagName(),t.Command=e.getAttribute("Command"),t.LabelText=e.getAttribute("LabelText"),t.Id=e.getAttribute("Id"),t.ModernImage=e.getAttribute("ModernImage"),e.get_tagName()){case"Button":t.Menu=null;break;case"FlyoutAnchor":case"SplitButton":e.hasChildNodes()?t.Menu=this.parseMenuFromXML(e.childNodes().get_item(0)):t.Menu=null;break;default:t=null}return t}}var w=n("RvmO"),T=n("Er26"),P=n("tT9w");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function N(e,t,n,r,i,s,l,h,_,O){const x="Commanding.Actions.ExecuteCommand";return{type:"runCommand",async execute({dispatch:B,getState:L},j){var N;const F=[];F.push({name:y.b.CommandingParameters.CommandType,value:n}),F.push({name:y.b.CommandingParameters.CommandId,value:r}),F.push({name:y.b.CommandingParameters.ControlId,value:i}),F.push({name:y.b.CommandingParameters.CommandManagerId,value:l});let R=null,A=-1,D=!1;const k=j.TraceManager.getTracer("Commanding"),$=`commandId: ${r}, commandType: ${n}, controlId: ${i}, commandManagerId: ${l}, pageId: ${s}, entityName: ${R}, selectedItems: ${A}.`;try{if(R=t&&t.EntityLogicalName?t.EntityLogicalName:null,A=t&&t.SelectedItems?t.SelectedItems.length:-1,F.push({name:y.b.CommandingParameters.PageId,value:s}),s||k.warn("Can't detect PageId for "+$),F.push({name:y.b.CommandingParameters.ExecuteWarningEntityName,value:R}),R||_||k.warn("Can't detect EntityName for "+$),F.push({name:y.b.CommandingParameters.SelectedItemsCount,value:A}),A>=0||_||k.warn("Can't calculate selectedItemsCount for "+$),k.debug("Executing "+$),j.EventManager.ReportEvent(new b(n,r,i,l,s,R,A)),e&&e.Commands&&!_){const b=e.Commands;let _=b[n]?b[n][r]:null;if(!_&&b[c.c]&&(_=b[c.c][r]),_){const e=_.Actions,b=e.filter(e=>1===e.ActionType);k.debug(`Found ${b.length} Url Actions.`),F.push({name:y.b.CommandingParameters.UrlActionCount,value:b.length}),b.forEach(e=>{const n=e.Attributes;k.debug(`Opening Url: ${n.Address} for url action.`);const o=(new a.a).evaluateParameters(e.Parameters,e.ActionType,t,s,i,L(),j,h,l);(new d).openUrl(n,o,L(),t)});const O=e.filter(e=>3===e.ActionType);k.debug(`Found ${O.length} Javascript Actions.`),F.push({name:y.b.CommandingParameters.JavascriptActionCount,value:O.length});const z=/^\$webresource:/i;let W=O.map(e=>{const t=e.Attributes;if(t.Library&&-1!==t.Library.search(z))return k.debug(`Found JavaScript action: ${t.FunctionName} on library: ${t.Library}.`),t.Library;throw k.error(`JavaScript Action Library: ${t.Library} is not a web resource and is not supported.`),F.push({name:"IsCustomizationError",value:"true"}),F.push({name:"ScriptActionFunctionName",value:t.FunctionName}),F.push({name:"ScriptActionLibraryName",value:t.Library}),D=!0,new Error(`Invalid JavaScript Action Library: ${t.Library} is not a web resource and is not supported.`)});if(F.push({name:y.b.CommandingParameters.LibraryCount,value:W.length}),W.length>0){k.debug(`Getting dependent web resources for ${W.length} libraries.`),W=Object(u.e)(L(),W),k.debug(`Total ${W.length} libraries found including dependent web resources.`);for(let e=0;e<W.length;++e){const t=W[e];W[e]=W[e].replace(z,""),k.debug(`Resolved library: ${t} to url: ${W[e]}.`)}const e=B(Object(p.g)(W)),d=Object(I.j)(j,B,l,s);k.debug(`Loading libraries ${W.join(",")} for pageId: ${s}.`);const b=d.then(e=>e.loadWebResourcesForAllContexts(W,t.WebResourcePath,3,e=>B(Object(S.a)(e)),!t.IsServerAvailable).then(()=>{k.debug(`Finished loading ${W.length} libraries for pageId: ${s}.`)}));return M.a.addKeyPerformanceIndicatorOnIdle(x,Object(v.c)(F)),Promise.all([e,b,d]).then(e=>{const d=e[2],p=O.map(async e=>{var p;const b=e.Attributes;k.debug(`Beginning execution of action: ${b.FunctionName} of library: ${b.Library}.`);const I=e.Parameters;k.debug(`Evaluating ${I.length} parameters of action: ${b.FunctionName} of library: ${b.Library}.`),F.push({name:"ScriptActionFunctionName",value:b.FunctionName}),F.push({name:"ScriptActionLibraryName",value:b.Library});const S=new a.a,M=[];S.evaluateParameters(I,e.ActionType,t,s,i,L(),j,h,l).forEach(e=>M.push(e.value)),k.debug(`Executing action: ${b.FunctionName} of library: ${b.Library}.`);try{const e=Object(u.j)(L(),b.Library),t={sourceName:"ribbon.command"};t.eventParameters=[{name:y.b.CommandingParameters.ControlId,value:i},{name:y.b.WebResourceParameterNames.FunctionName,value:b.FunctionName},{name:y.b.WebResourceParameterNames.WebResourceName,value:null==e?void 0:e.name},{name:y.b.WebResourceParameterNames.SolutionName,value:null==e?void 0:e.solutionName},{name:y.b.WebResourceParameterNames.PublisherName,value:null==e?void 0:e.publisherName}],Object(o.b)(t,()=>{d.execute(b.FunctionName,M,!1,{webResourceName:e&&e.name,solutionName:e&&e.solutionName,solutionVersion:e&&e.solutionVersion,publisherName:e&&e.publisherName,type:"CommandExecution"}),F.push({name:"ScriptActionSolutionName",value:null==e?void 0:e.solutionName}),F.push({name:"ScriptActionPublisherName",value:null==e?void 0:e.publisherName})})}catch(e){F.push({name:"IsCustomizationError",value:"true"}),k.error(`Failed to execute action: ${b.FunctionName} of library: ${b.Library} for commandId: ${r}, commandType: ${n}, controlId: ${i}, commandManagerId: ${l}, pageId: ${s}, entityName: ${R}, selectedItems: ${A} with error: ${e.Message}.`,F);const t=new C.a("",null,null,null,null,e);throw B(Object(g.a)(s,t)),e}const v=I.findIndex(e=>17===e.ParameterType);if(v>=0){k.debug(`Found xml injection parameter for action: ${b.FunctionName} of library: ${b.Library} at index: ${v}.`);const e=M[v],t="PopulationXML";k.debug(`Injecting xml for action: ${b.FunctionName} of library: ${b.Library}.`);const n=e[t];B(m(l,i,{Status:1,MenuSection:null,MaxWidth:"",Id:"error"}));const o=await n;k.debug(`Processing injected xml for action: ${b.FunctionName} of library: ${b.Library}.`);const a={Status:3,MenuSection:null,MaxWidth:"",Id:"error"};let r=null;if("string"==typeof o)try{r=new E(o).getParsedXml()}catch(e){F.push({name:"IsCustomizationError",value:"true"}),k.error(`Unable to parse injected xml: ${o} for action: ${b.FunctionName} of library: ${b.Library} with error: ${e.Message}`,F),B(m(l,i,a))}else r=o;if(r)try{const e=await Object(c.v)(L,j,B,r,R,f.n,s);k.info(`Storing injected xml: ${o} for action: ${b.FunctionName} of library: ${b.Library}.`),e.Status=2,B(m(l,i,e))}catch(e){F.push({name:"IsCustomizationError",value:"true"}),k.error(`Unable to parse injected menu object for action: ${b.FunctionName} of library: ${b.Library} with error: ${e.Message}.`,F),B(m(l,i,a))}else k.warn(`Storing injected xml skipped as menu was empty for action: ${b.FunctionName} of library: ${b.Library}.`)}F.push({name:"IsAppActionJS",value:null!==(p=_.IsAppAction)&&void 0!==p&&p}),k.debug("Finished executing "+$),j.EventManager.ReportComponentSuccess(x,F)});return Promise.all(p).then(()=>{})})}const X=e.filter(e=>5===e.ActionType);if(1===X.length){const e=X[0].Attributes;k.debug(`Beginning execution of expression action: ${e.FunctionName} of component: ${e.ComponentName} of library: ${e.Library}.`);const o=Object(I.l)(j,l,s),d={sourceName:"ribbon.command"};d.eventParameters=[{name:y.b.CommandingParameters.ControlId,value:i},{name:T.g.LIBRARY_NAME,value:e.Library},{name:T.g.FUNCTIONAL_COMPONENT_NAME,value:e.ComponentName},{name:y.b.WebResourceParameterNames.FunctionName,value:e.FunctionName}];const c=(await Object(I.b)()).createExpressionContextProvider(t,new a.a,o,s,i,{dispatch:B,getState:L},j,h,l,d,k,F,!1);try{return await B(Object(w.a)(e.Library,e.ComponentName,e.FunctionName,c)),F.push({name:"IsAppActionFX",value:null!==(N=_.IsAppAction)&&void 0!==N&&N}),k.debug("Finished executing "+$),void j.EventManager.ReportComponentSuccess(x,F)}catch(t){throw F.push({name:"IsCustomizationError",value:"true"}),k.error(`Failed to execute action: ${e.FunctionName} of component: ${e.ComponentName} of library: ${e.Library} for commandId: ${r}, commandType: ${n}, controlId: ${i}, commandManagerId: ${l}, pageId: ${s}, entityName: ${R}, selectedItems: ${A} with error: ${Object(C.d)(t)}.`,F),B(Object(P.b)(t,!0,s)),t}}}throw new Error("Invalid RibbonCommandDefinition")}if(!_||!O)throw new Error("Invalid RibbonDescriptor or RibbonDescriptor.Commands or injected command");F.push({name:"IsInjectedCommand",value:"true"}),O.type&&O.execute?B(O):O()}catch(e){if(k.error("Command execution failed for "+$),D){const t=new C.a("",null,null,null,null,e);B(Object(g.a)(s,t)),j.EventManager.ReportComponentSuccess(x,F)}else j.EventManager.ReportComponentFailure(x,e,"Check error details to know why execution failed.",F);throw e}}}}},nUyF:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var o=n("M0zh");function a(e,t){const n={contextToken:e};return{type:o.n,payload:n,meta:{commandManagerId:t}}}},s308:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var o=n("M0zh");function a(e,t){let n=null;e&&(n={},e.forEach(e=>{n[e]=!0}));const a={controlAllowList:n};return{type:o.m,payload:a,meta:{commandManagerId:t}}}},"tR+E":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var o=n("ILmX"),a=n("Wgxh"),r=n("ddoO"),i=n("2jAf");function s(e,t){return{type:"ribbon.initialize.async",execute({dispatch:n,getState:s},l){if(e){const l=s();!function(e,t,n,s){const l=Object(o.h)();if(e!==l){const o={},l=function(e,t,n){if(!e)return null;if(n){const o=Object(r.k)(e,t),i=o&&o.slice();return Object(a.a)(i,n)}return null}(n,e,t);l&&(o[e]=l,s(Object(i.e)(null,o)))}}(e,t,l,n)}return Promise.resolve()}}}},vZzn:function(e,t,n){"use strict";n.d(t,"c",(function(){return m})),n.d(t,"b",(function(){return h})),n.d(t,"a",(function(){return u}));var o=n("dHD5"),a=n("arV0"),r=n("nlPs"),i=n("e8+c"),s=n("mpSO"),l=n("cfbi"),d=n("UIlN"),c=n("jq7Z");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function m(e,t,n){const r=Object(c.a)(e,t);if(r){const i=Object(a.p)(e,t);if(i!==l.b&&"QuickCreateForm"!==i&&"ModalDialog"!==i&&"Dialog"!==i&&"Dashboard"!==i&&"Control"!==i&&"TaskBasedFlow"!==i&&i!==l.c)return r.xrmReady;{const e=Object(o.w)(n);if(r.forms&&r.forms[e])return r.forms[e].xrmReady}}return!1}function u(e,t){const n=Object(d.a)(e,t);return n&&n.createdScriptContainer}function p(e,t,n,a,r){if(r)return!0;const i=m(e,t,a),s=function(e,t,n){if(n){const a=Object(o.w)(n),r=Object(c.a)(e,t);return r&&r.commandXrmCache&&r.commandXrmCache[a]}return!1}(e,t,n);return n?s&&i:i}function h(e,t,n,o,a=!1){if(t===s.e)return!!u(e,t);if(t&&t.startsWith(i.b))return!0;return!!p(e,n,o,Object(r.a)(e,n),a)}},wNQP:function(e,t,n){"use strict";n.d(t,"a",(function(){return O}));var o=n("eXjw"),a=n("fMBw"),r=n.n(a),i=n("pEXn"),s=n("dHD5"),l=n("6hHv"),d=n("nmJf"),c=n("tR+E"),m=n("s308"),u=n("Es1/"),p=n("nUyF"),h=n("GpAH"),b=n("GT4X"),y=n("ILmX"),C=n("wgH2"),g=n("mpSO"),I=n("P86a"),f=n("Me5Q"),S=n("vZzn"),_=n("yc+y"),M=n("uNu9");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const v=r.a.createEvent(g.b,g.a);function O(e,t,n,a,r,O,x,B,L,j,E=!1){return{type:"commanding.initCmdBar",execute({dispatch:w,getState:T},P){if(Object(b.d)(T(),t))return;if(Object(b.b)(T(),t))return void(j&&j(!0));w(Object(f.a)(I.a.Initializing,t));const N=Object(C.a)(e);if(e&&""!==e&&N&&"undefined"!==N){const b={};b[i.b.CommandingParameters.CommandManagerId]=t||n||"null",b[i.b.CommandingParameters.RibbonId]=e||"null",b[i.b.CommandingParameters.ContextKey]=a?Object(s.w)(a):"null";const I=v.startStopwatch(b);return function(e,t,n,o){const a=Object(y.k)(t,n);if(n&&(!a||!a.initialized||!a.Localized))return e(Object(d.a)(n,o));return Promise.resolve()}(w,T(),e,n).then(()=>{const i=Object(S.b)(T(),t,n,a,E),d=Object(C.d)()(T(),n,e,r,a,B,O,x),b=Object(y.k)(T(),e);if(i&&d&&b&&b.initialized!==o.a.Error&&b.Commands&&b.Localized){const o=a?Object(s.w)(a):null;return Object(_.c)(t)&&(d.ContextTypeMask=g.c.QuickActionCommand,d.ContextEntityLogicalName===M.b&&(d.ActivityEntityLogicalName=a.entityTypeName)),w(Object(c.a)(e,n)),w(Object(m.a)(L,t)),w(Object(u.a)(d,t||n)),w(Object(h.a)(e,t||n)),w(Object(p.a)(a,t)),w(Object(l.c)(b,d,n,t||n,o,!1)).then(()=>{j&&j(!0),I()})}})}w(Object(f.a)(I.a.SkippedRuleEvaluation,t))}}}}}]),window.bundleExecutionMarkers["scripts/12.js?v=1.4.3886-master"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();